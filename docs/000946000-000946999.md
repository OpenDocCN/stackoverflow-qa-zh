# StackOverflow 问答 000946000-000946999

# environment - SystemPropertiesAdvanced.exe（特别是 SYSDM）的实现细节

> ID：946000
> 
> 赞同：0
> 
> 时间：2009-06-03T17:23:54.347
> 
> 标签：environment

我正在研究更新系统环境变量时 Windows 2008 上的 C:\Windows\System32\SystemPropertiesAdvanced.exe 如何与 explorer.exe 交互。以这种方式更新环境变量时，explorer.exe 将动态更新其环境块以获取更改。我知道远程注入环境变量的多种方法，但对 SystemPropertiesAdvanced.exe 使用的实现感到好奇。

当我在更新环境变量后按下 SystemPropertiesAdvanced 对话框上的 OK 按钮时，会创建一个新线程。调试这个线程我已经感兴趣以下几行：

```
WINSTA!WinStationBSMWorkerThread:
75b292bc 8bff            mov     edi,edi
75b292be 55              push    ebp
75b292bf 8bec            mov     ebp,esp
75b292c1 51              push    ecx
75b292c2 8365fc00        and     dword ptr [ebp-4],0
75b292c6 53              push    ebx
75b292c7 56              push    esi
75b292c8 8b7508          mov     esi,dword ptr [ebp+8]
75b292cb 837e4000        cmp     dword ptr [esi+40h],0
75b292cf 57              push    edi
75b292d0 0f95c0          setne   al
75b292d3 50              push    eax
75b292d4 ff763c          push    dword ptr [esi+3Ch]
75b292d7 8d4624          lea     eax,[esi+24h]
75b292da ff7638          push    dword ptr [esi+38h]
75b292dd ff7628          push    dword ptr [esi+28h]
75b292e0 50              push    eax
75b292e1 ff7620          push    dword ptr [esi+20h]  ds:0023:00404468={SYSDM!szUserEnv (6b3ec434)}
75b292e4 8d4614          lea     eax,[esi+14h]
75b292e7 ff761c          push    dword ptr [esi+1Ch]
75b292ea ff7618          push    dword ptr [esi+18h]
75b292ed 50              push    eax
75b292ee ff7610          push    dword ptr [esi+10h]
75b292f1 ff760c          push    dword ptr [esi+0Ch]
75b292f4 ff7608          push    dword ptr [esi+8]
75b292f7 ff7604          push    dword ptr [esi+4]
75b292fa ff36            push    dword ptr [esi]
75b292fc e821fdffff      call    WINSTA!WinStationBroadcastSystemMessageWorker (75b29022)
75b29301 8d7e44          lea     edi,[esi+44h]
75b29304 57              push    edi
75b29305 894508          mov     dword ptr [ebp+8],eax
75b29308 ff15d810b275    call    dword ptr [WINSTA!_imp__EnterCriticalSection (75b210d8)]
75b2930e 33db            xor     ebx,ebx
75b29310 43              inc     ebx
75b29311 837e3000        cmp     dword ptr [esi+30h],0
75b29315 0f85663d0000    jne     WINSTA!WinStationBSMWorkerThread+0x5b (75b2d081)
75b2931b 57              push    edi
75b2931c 895e2c          mov     dword ptr [esi+2Ch],ebx
75b2931f ff15d410b275    call    dword ptr [WINSTA!_imp__LeaveCriticalSection (75b210d4)]
75b29325 837dfc00        cmp     dword ptr [ebp-4],0
75b29329 0f85683d0000    jne     WINSTA!WinStationBSMWorkerThread+0x7c (75b2d097)
75b2932f 8b4508          mov     eax,dword ptr [ebp+8]
75b29332 5f              pop     edi
75b29333 5e              pop     esi
75b29334 5b              pop     ebx
75b29335 c9              leave
75b29336 c20400          ret     4 
```

我相信对 WINSTA!WinStationBroadcastSystemMessageWorker 的调用是让 explorer.exe 知道它应该获取这些新环境变量的方式。有趣的是，75b292e1 处的引用被调试器识别为 SYSDM!szUserEnv。

也许不是您的标准查询，但也许还有其他逆向工程师。:) [在 100rep 我会正确设置“标签”]

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-22T17:07:48.337

Pradeep Prem Kamal 在他的博客文章中解释了如何使用[WM_SETTINGCHANGE](http://msdn.microsoft.com/en-us/library/ms725497%28v=vs.85%29.aspx)和[SendMessageTimeout](http://msdn.microsoft.com/en-us/library/ms644952)[来](http://smartypeeps.blogspot.com/2006/12/windows-environment-variables.html)更新所有顶级进程。可以在[此处](http://edn.embarcadero.com/article/28254)找到另一个示例（在 Delphi 中） 。

我的猜测是 WINSTA!WinStationBroadcastSystemMessageWorker 包装了更新用户环境变量（SYSDM!szUserEnv ？）并进行了 SendMessageTimeout 调用。

# mysql - MYSQL 中此查询的默认顺序是什么？

> ID：946010
> 
> 赞同：1
> 
> 时间：2009-06-03T17:25:21.460
> 
> 标签：mysql, sql-order-by

```
mysql> explain SELECT p.id ID, p.job_desc_title Title, p.url URL, substr(p.posting_date, 1, 10) Date, 
    ->                                         p.job_city_name City,
    ->                                         p.job_state_name State,
    ->                                         b.screen_name Name, b.type Type,f.name Company,IF(g.account_id IS NULL,0,1) Online
    ->                                         FROM postings p
    ->                           LEFT JOIN accounts b on p.account_id=b.id
    ->                           LEFT JOIN companies f on f.id=p.job_cmp_id
    ->                           LEFT JOIN online g ON g.account_id=p.account_id
    ->                           WHERE (MATCH(job_desc,job_desc_title,k_state,k_city,zip) AGAINST('+java' IN BOOLEAN MODE))  AND b.closed=0 AND NOT p.expired 
    ->                           
    ->                           LIMIT 0 , 5
    -> ;
+----+-------------+-------+----------+--------------------------------------------------+--------------------------------------+---------+-----------------+------+-------------+
| id | select_type | table | type     | possible_keys                                    | key                                  | key_len | ref             | rows | Extra       |
+----+-------------+-------+----------+--------------------------------------------------+--------------------------------------+---------+-----------------+------+-------------+
|  1 | SIMPLE      | p     | fulltext | FK_listings,f_postings_city_state_desc_title_zip | f_postings_city_state_desc_title_zip | 0       |                 |    1 | Using where | 
|  1 | SIMPLE      | f     | eq_ref   | PRIMARY                                          | PRIMARY                              | 4       | v3.p.job_cmp_id |    1 |             | 
|  1 | SIMPLE      | g     | eq_ref   | account_id                                       | account_id                           | 4       | v3.p.account_id |    1 | Using index | 
|  1 | SIMPLE      | b     | eq_ref   | PRIMARY                                          | PRIMARY                              | 4       | v3.p.account_id |    1 | Using where | 
+----+-------------+-------+----------+--------------------------------------------------+--------------------------------------+---------+-----------------+------+-------------+
4 rows in set (0.00 sec) 
```

它曾经是按相关性排序的，但现在似乎不是。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:30:45.010

如果没有 order by，“默认”排序将取决于查询中使用了哪些索引以及它们的使用顺序。这可能会随着数据/统计数据的变化以及优化器选择不同的计划而改变。

如果您希望数据按特定顺序排列，请使用 ORDER BY。但我敢肯定你已经知道了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:33:23.913

不要假设订单，如果您需要订单，请使用 ORDER BY 子句。

# sqlite - SQLite 添加主键

> ID：946011
> 
> 赞同：112
> 
> 时间：2009-06-03T17:25:38.387
> 
> 标签：sqlite

`CREATE TABLE AS`我通过使用基于语句创建表的语法在 Sqlite中创建了一个表`SELECT`。现在这个表没有主键，但我想添加一个。

执行`ALTER TABLE table_name ADD PRIMARY KEY(col1, col2,...)`给出语法错误“接近 PRIMARY”

有没有办法在创建表期间或之后在 Sqlite 中添加主键？

“创建期间”是指在创建期间使用`CREATE TABLE AS`.

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-06-03T17:42:47.157

创建 SQLite 表后，您不能以任何重要方式修改它们。公认的建议解决方案是创建一个具有正确要求的新表并将您的数据复制到其中，然后删除旧表。

这是有关此的官方文档：http: [//sqlite.org/faq.html#q11](http://sqlite.org/faq.html#q11)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-02-20T22:30:40.697

只要您使用，如果您在**单个字段**`CREATE TABLE`上创建主键，您可以使用：

 **```
CREATE TABLE mytable (
field1 TEXT,
field2 INTEGER PRIMARY KEY,
field3 BLOB,
); 
```

使用，您还可以始终使用以下方法在一个或**多个字段**`CREATE TABLE`上创建主键：

 **```
CREATE TABLE mytable (
field1 TEXT,
field2 INTEGER,
field3 BLOB,
PRIMARY KEY (field2, field1)
); 
```

参考：[http ://www.sqlite.org/lang_createtable.html](http://www.sqlite.org/lang_createtable.html)

该答案不涉及表格更改。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-12-13T07:24:51.450

之后我尝试通过直接更改 sqlite_master 表来添加主键。这个技巧似乎奏效了。这当然是一个黑客解决方案。

简而言之：在表上创建一个常规（唯一）索引，然后使schema可写并将索引的名称更改为sqlite保留的形式，以标识一个主键索引，（即sqlite_autoindex_XXX_1，其中XXX是表名）并将 sql 字符串设置为 NULL。最后更改表定义本身。一个坑：在重新打开数据库之前，sqlite 不会看到索引名称发生变化。这似乎是一个错误，但并不严重（即使不重新打开数据库，您仍然可以使用它）。

假设表格如下所示：

```
CREATE TABLE tab1(i INTEGER, j INTEGER, t TEXT); 
```

然后我做了以下事情：

```
BEGIN;
CREATE INDEX pk_tab1 ON tab1(i,j);
pragma writable_schema=1;
UPDATE sqlite_master SET name='sqlite_autoindex_tab1_1',sql=null WHERE name='pk_tab1';
UPDATE sqlite_master SET sql='CREATE TABLE tab1(i integer,j integer,t text,primary key(i,j))' WHERE name='tab1';
COMMIT; 
```

一些测试（在 sqlite shell 中）：

```
sqlite> explain query plan select * from tab1 order by i,j;
0|0|0|SCAN TABLE tab1 USING INDEX sqlite_autoindex_tab1_1
sqlite> drop index sqlite_autoindex_tab1_1;
Error: index associated with UNIQUE or PRIMARY KEY constraint cannot be dropped 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-04-14T19:58:39.813

根据有关表创建的 sqlite[文档](https://www.sqlite.org/lang_createtable.html "文档")，使用[create table as select](https://www.sqlite.org/lang_createtable.html#createtabas)会生成一个没有约束且没有主键的新表。

但是，文档还说主键和唯一索引在逻辑上是等效的（[请参阅约束部分](https://www.sqlite.org/lang_createtable.html#constraints)）：

> 在大多数情况下，UNIQUE 和 PRIMARY KEY 约束是通过在数据库中创建唯一索引来实现的。（例外情况是 WITHOUT ROWID 表上的 INTEGER PRIMARY KEY 和 PRIMARY KEYs。）因此，以下模式在逻辑上是等效的：
> 
> ```
> CREATE TABLE t1(a, b UNIQUE);
> 
> CREATE TABLE t1(a, b PRIMARY KEY);
> 
> CREATE TABLE t1(a, b);
> CREATE UNIQUE INDEX t1b ON t1(b); 
> ```

因此，即使您无法通过 SQL alter 语法更改表定义，您也可以通过使用唯一索引来获得相同的主键效果。

此外，任何表（除了那些没有使用 rowid 语法创建的表）都有一个称为“rowid”的内部整数列。根据文档，您可以使用此内部列来检索/修改记录表。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-03T17:35:49.730

你可以这样做：

```
CREATE TABLE mytable (
field1 text,
field2 text,
field3 integer,
PRIMARY KEY (field1, field2)
); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-07-07T05:07:17.547

```
sqlite>  create table t(id integer, col2 varchar(32), col3 varchar(8));
sqlite>  insert into t values(1, 'he', 'ha');
sqlite>
sqlite>  create table t2(id integer primary key, col2 varchar(32), col3 varchar(8));
sqlite>  insert into t2 select * from t;
sqlite> .schema
CREATE TABLE t(id integer, col2 varchar(32), col3 varchar(8));
CREATE TABLE t2(id integer primary key, col2 varchar(32), col3 varchar(8));
sqlite> drop table t;
sqlite> alter table t2 rename to t;
sqlite> .schema
CREATE TABLE IF NOT EXISTS "t"(id integer primary key, col2 varchar(32), col3 varchar(8)); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-23T14:40:52.243

**介绍**

这是基于 Android 的 java 的，它是一个很好的例子，可以在不惹恼您的应用程序粉丝/客户的情况下更改数据库。这是基于 SQLite FAQ 页面 [http://sqlite.org/faq.html#q11的想法](http://sqlite.org/faq.html#q11)

**问题**

我没有注意到我需要设置 row_number 或 record_id 来删除收据中的单个购买项目，同时项目条形码编号愚弄我认为将其作为删除该项目的关键。我将收据详细信息保存在表receipt_barcode 中。如果我使用项目条形码作为键，则不使用 record_id 可能意味着删除收据中同一项目的所有记录。

**注意**

请理解，这是我在撰写本文时正在处理的代码的复制粘贴。仅用作示例，随机复制粘贴对您没有帮助。首先根据您的需要进行修改

另外请不要忘记阅读代码中的注释。

**编码**

在你的类中使用这个方法来检查你想要添加的列是否丢失。我们这样做只是为了不重复更改表receipt_barcode 的过程。只需将其作为课堂的一部分提及即可。在下一步中，您将看到我们将如何使用它。

```
public boolean is_column_exists(SQLiteDatabase mDatabase , String table_name,
String     column_name) {
    //checks if table_name has column_name
    Cursor cursor = mDatabase.rawQuery("pragma table_info("+table_name+")",null);
    while (cursor.moveToNext()){
    if (cursor.getString(cursor.getColumnIndex("name")).equalsIgnoreCase(column_name)) return true;
    }
    return false;
} 
```

然后，如果您的应用程序的第一次用户尚未退出，则使用以下代码创建表receipt_barcode *。*请注意代码中的“如果不存在”。它很重要。

```
//mDatabase should be defined as a Class member (global variable) 
//for ease of access : 
//SQLiteDatabse mDatabase=SQLiteDatabase.openOrCreateDatabase(dbfile_path, null);
creation_query = " CREATE TABLE if not exists receipt_barcode ( ";
creation_query += "\n record_id        INTEGER PRIMARY KEY AUTOINCREMENT,";
creation_query += "\n rcpt_id INT( 11 )       NOT NULL,";
creation_query += "\n barcode VARCHAR( 255 )  NOT NULL ,";
creation_query += "\n barcode_price VARCHAR( 255 )  DEFAULT (0),";
creation_query += "\n PRIMARY KEY ( record_id ) );";
mDatabase.execSQL(creation_query);

//This is where the important part comes in regarding the question in this page:

//adding the missing primary key record_id in table receipt_barcode for older versions
        if (!is_column_exists(mDatabase, "receipt_barcode","record_id")){
            mDatabase.beginTransaction();
            try{
                Log.e("record_id", "creating");

                 creation_query="CREATE TEMPORARY TABLE t1_backup(";
                 creation_query+="record_id INTEGER        PRIMARY KEY AUTOINCREMENT,";
                 creation_query+="rcpt_id INT( 11 )       NOT NULL,";
                 creation_query+="barcode VARCHAR( 255 )  NOT NULL ,";
                 creation_query+="barcode_price VARCHAR( 255 )  NOT NULL DEFAULT (0) );";
                 mDatabase.execSQL(creation_query);

                 creation_query="INSERT INTO t1_backup(rcpt_id,barcode,barcode_price) SELECT rcpt_id,barcode,barcode_price  FROM receipt_barcode;";
                 mDatabase.execSQL(creation_query);

                 creation_query="DROP TABLE receipt_barcode;";
                 mDatabase.execSQL(creation_query);

                 creation_query="CREATE TABLE receipt_barcode (";
                 creation_query+="record_id INTEGER        PRIMARY KEY AUTOINCREMENT,";
                 creation_query+="rcpt_id INT( 11 )       NOT NULL,";
                 creation_query+="barcode VARCHAR( 255 )  NOT NULL ,";
                 creation_query+="barcode_price VARCHAR( 255 )  NOT NULL DEFAULT (0) );";
                 mDatabase.execSQL(creation_query);

                 creation_query="INSERT INTO receipt_barcode(record_id,rcpt_id,barcode,barcode_price) SELECT record_id,rcpt_id,barcode,barcode_price  FROM t1_backup;";
                 mDatabase.execSQL(creation_query);

                 creation_query="DROP TABLE t1_backup;";
                 mDatabase.execSQL(creation_query);

                 mdb.setTransactionSuccessful();
            } catch (Exception exception ){
                Log.e("table receipt_bracode", "Table receipt_barcode did not get a primary key (record_id");
                exception.printStackTrace();
            } finally {
                 mDatabase.endTransaction();
            } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-02T15:02:14.467

我遇到了同样的问题，我找到的最佳解决方案是首先创建定义主键的表，然后使用 insert into 语句。

```
CREATE TABLE mytable (
field1 INTEGER PRIMARY KEY,
field2 TEXT
);

INSERT INTO mytable 
SELECT field1, field2 
FROM anothertable; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-04-07T00:47:14.897

我使用 CREATE TABLE AS 语法合并了几列，遇到了同样的问题。这是我为加快进程而编写的 AppleScript。

```
set databasePath to "~/Documents/Databases/example.db"
set tableOne to "separate" -- Table from which you are pulling data
set tableTwo to "merged" -- Table you are creating
set {tempCol, tempColEntry, permColEntry} to {{}, {}, {}}
set permCol to {"id integer primary key"}

-- Columns are created from single items  AND from the last item of a list
-- {{"a", "b", "c"}, "d", "e"} Columns "a" and "b" will be merged into a new column "c".  tableTwo will have columns "c", "d", "e"

set nonCoal to {"City", "Contact", "Names", {"Address 1", "Address", "address one", "Address1", "Text4", "Address 1"}, {"E-Mail", "E-Mail Address", "Email", "Email Address", "EmailAddress", "Email"}, {"Zip", "Zip Code", "ZipCode", "Zip"}, {"Telephone", "BusinessPhone", "Phone", "Work Phone", "Telephone"}, {"St", "State", "State"}, {"Salutation", "Mr/Ms", "Mr/s", "Salutations", "Sautation", "Salutation"}}

-- Build the COALESCE statements
repeat with h from 1 to count of nonCoal
set aColumn to item h of nonCoal
if class of aColumn is not list then
    if (count of words of aColumn) > 1 then set aColumn to quote & aColumn & quote
    set end of tempCol to aColumn
    set end of permCol to aColumn
else
    set coalEntry to {}
    repeat with i from 1 to count of aColumn
        set coalCol to item i of aColumn as string
        if (count of words of coalCol) > 1 then set coalCol to quote & coalCol & quote
        if i = 1 then
            set end of coalEntry to "TRIM(COALESCE(" & coalCol & ", '') || \" \" || "
        else if i < ((count of aColumn) - 1) then
            set end of coalEntry to "COALESCE(" & coalCol & ", '') || \" \" || "
        else if i = ((count of aColumn) - 1) then
            set as_Col to item (i + 1) of aColumn as string
            if (count of words of as_Col) > 1 then set as_Col to quote & as_Col & quote
            set end of coalEntry to ("COALESCE(" & coalCol & ", '')) AS " & as_Col) & ""
            set end of permCol to as_Col
        end if
    end repeat
    set end of tempCol to (coalEntry as string)
end if
end repeat

-- Since there are ", '' within the COALESCE statement, you can't use "TID" and "as string" to convert tempCol and permCol for entry into sqlite3\. I rebuild the lists in the next block.
repeat with j from 1 to count of tempCol
if j < (count of tempCol) then
    set end of tempColEntry to item j of tempCol & ", "
    set end of permColEntry to item j of permCol & ", "
else
    set end of tempColEntry to item j of tempCol
    set end of permColEntry to item j of permCol
end if
end repeat
set end of permColEntry to ", " & item (j + 1) of permCol
set permColEntry to (permColEntry as string)
set tempColEntry to (tempColEntry as string)

-- Create the new table with an "id integer primary key" column
set createTable to "create table " & tableTwo & " (" & permColEntry & "); "
do shell script "sqlite3 " & databasePath & space & quoted form of createTable

-- Create a temporary table and then populate the permanent table
set createTemp to "create temp table placeholder as select " & tempColEntry & " from " & tableOne & ";  " & "insert into " & tableTwo & " select Null, * from placeholder;"
do shell script "sqlite3 " & databasePath & space & quoted form of createTemp

--export the new table as a .csv file
do shell script "sqlite3 -header -column -csv " & databasePath & " \"select * from " & tableTwo & " ; \"> ~/" & tableTwo & ".csv" 
```

# asp.net-mvc - 限制一段时间内的用户帐户注册数量？

> ID：946019
> 
> 赞同：3
> 
> 时间：2009-06-03T17:26:53.970
> 
> 标签：asp.net-mvc, security, validation

我有一个需要用户拥有帐户的网络应用程序。然后，该用户可以对特定项目进行“一次”投票。但是，一些用户正在注册大量帐户来“游戏”系统。

有谁知道如何限制这种类型的事情？

我可以限制每个 IP 地址每天的注册数量吗？（这有什么问题？）

还有什么建议？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:29:16.320

通过将注册限制为每个用户只有一个 IP 地址，您会做得更好。如果您计划让所有住在同一屋檐下的家庭拥有自己的账户，这可能不太好，但在大多数情况下，这是可行的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:47:03.483

是的，限制每个 IP 的注册是合理的。我可能会在每个滚动时间段内进行注册（例如，每个 IP 在任何一小时内最多有一个新帐户）。您还可以标记可疑注册（例如，每个 IP 每天超过 5 个）以供以后跟进。

您还可以限制用户投票，直到他们通过一些障碍，类似于 SO 的信誉系统。阻止投票，直到他们成为用户一周，至少发布两次，有一个朋友请求等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:58:34.987

我记得当我运行在线 RPG 时，我标记了超过 5 个左右的帐户在同一天使用相同的 IP 登录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T18:18:38.037

人们提到NAT问题。读取标头 x-forwarded-for 并将其与标准 IP 地址进行比较。

如果存在 x-forwarded-for，则使用此值。大多数正确配置的 NAT 路由器将填充此字段。唯一没有的通常是匿名代理。

如果您真的担心人们在玩系统，请使用使用套接字连接的闪存位，并向套接字侦听器提供会话 ID。然后，您可以将其与 ip 地址和 x-forwarded 进行比较。如果不匹配，则它们位于匿名代理后面。不允许他们创建帐户，您可以放心。

这是因为大多数匿名代理都没有完整的 Socks 代理，所有网络流量都通过它，只有 HTTP。这对我来说非常有效，过去我们进行了投票竞赛，人们使用匿名代理来玩弄系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T19:14:12.293

您可以通过电子邮件地址设置限制，而不是通过帐户进行限制。如果用户需要提供他们的电子邮件地址，您已经为他们设置了一个障碍。确保他们必须回复确认电子邮件，以确保电子邮件地址是真实的。还要跟踪电子邮件地址和 IP 地址，将单个 IP 地址具有例如 5 个或更多电子邮件地址的任何计数标记为可疑。（在这种情况下，您可以检查这些地址是否有某种关联，例如所有来自同一个域或相似名称的地址。）当然，人们可以使用 GMail 或 Hotmail 创建数十个电子邮件地址，或者即使他们有自己的私人域. 但对于很多人来说，这已经有点过分了。基本上，如果您看到来自 gmail.com 的 5 个电子邮件地址具有相同的 IP 地址，那就很可疑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-08T12:59:44.823

我建议实施不同的身份验证机制，例如 OpenID，或者 Alex 说，强制用户指定有效的电子邮件并在创建帐户之前通过电子邮件向他们发送确认链接。

我的偏好肯定是 OpenID。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T18:10:14.807

一个潜在的问题是，如果您的用户位于家庭路由器、ISP 代理或公司防火墙等 NAT 之后。您将看到所有这些 IP 相同。

我不会阻止人们，而是简单地记录他们的 IP，创建一份重复 IP 的报告，您可以定期运行该报告来调查可疑活动。

另外你可以采取社交的方式，在某处发布用户的IP。这将为伪造帐户的人提供温和的警告和抑制作用，并允许您的用户社区潜在地识别伪造者。

# php - GD 或 ImageMagick 已经成为客户端 PHP 安装的一部分的可能性有多大？

> ID：946037
> 
> 赞同：4
> 
> 时间：2009-06-03T17:30:18.597
> 
> 标签：php, installation, gd, imagemagick

我正在开发一个包，其中包括在 PHP 中重新缩放图像。对于图像重新缩放，PHP 有 GD 和 ImageMagick 库。那些可能已经成为给定客户端的 PHP 安装的一部分吗？

就此而言，是否有 PHP 的“默认”安装？默认情况下，是否包含 GD 或 ImageMagick？

如果两者都没有安装，我是否应该有某种可怕的备用位置来读取、重新缩放和保存 GIF、JPG 和 PNG，或者将 GD 或 ImageMagick 添加到现有安装中是否简单？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T21:40:13.527

我不记得上次看到没有 GD 的灯托管服务提供商是什么时候。imagemagick 扩展并没有那么普遍。如果他们自己运行服务器，他们真的应该能够激活其中一个或两个。在您的位置，我将使用 GD 和（可能减少的）imagemagick 后备构建全部功能。如果他们都没有，*向他们展示轮子和/或火的基本概念，他们应该感激不尽*。

PS：我遇到过停用某些 GD 功能的提供商（在共享主机环境中计算过于密集），例如 imagerotate 和 imagefilter。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T18:30:28.543

GD 是包含在 php 中的最简单的库。它是“仅”一个扩展，主要包含在 php 包中……唯一需要的操作是激活扩展。

关于ImageMagik，比较复杂，因为php imageMagik 库只是image magik 软件的一个接口。使用 imageMagik 需要安装软件和 php 库

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T17:33:27.237

期望客户有能力或了解如何添加库是合理的。您是在销售软件还是服务器维护？

如果您要从整个“易用性”角度出发，您需要将 php 与您的应用程序（并且已经安装了 GD）打包在一起，我不确定这是否合法。（但可能有一些方法可以完成它）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-01T17:50:54.807

90% GD - 10% ImageMagick

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-05T10:48:30.763

窗户 - 是

Linux/MAC - 否（但相当容易安装）

# emacs - 在 Emacs 中缩进模板参数

> ID：946039
> 
> 赞同：4
> 
> 时间：2009-06-03T17:30:39.317
> 
> 标签：emacs, cc-mode

我没有运气让 Emacs（cc 模式）缩进多行模板参数。这是一个示例行：

```
typedef ::boost::zip_iterator< ::boost::tuple<
vector<int>::const_iterator, vector<float>::const_iterator > >; 
```

我希望第二行缩进，就像在函数中一样。它是缩进的，直到我输入 second-to-last `>`，此时第二行向左移动以与 typedef 对齐。

当我开始输入第二行时，句法分析是`((statement-cont 52))`，直到倒数第二行，`>`此时它变成`((defun-block-intro 46))`. 删除字符不会返回到旧的句法分析。

我希望将 template-args-cont 作为句法分析。

我正在使用它附带的 emacs 22.2 (ubuntu intrepid) 和 cc-mode 版本 5.31.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:35:19.920

You *should* just need to set `template-args-cont` to some useful value. To experiment with it, put your cursor on the second line and enter `C-cC-o` for `c-set-offset`. Insert a convenient value. With 4, I get:

```
typedef ::boost::zip_iterator< ::boost::tuple<
    vector<int>::const_iterator, vector<float>::const_iterator > >; 
```

If that doesn't work, check your version: I have cc-mode version 5.31.6\. To check, do `M-x c-version`. I get

```
Using CC Mode version 5.31.6 
```

# php - OO 设计：从父类返回子类

> ID：946047
> 
> 赞同：0
> 
> 时间：2009-06-03T17:31:47.987
> 
> 标签：php, oop, polymorphism

当谈到多态性时，我仍然是一个新手，所以我希望我能正确地表达我的问题。

假设我的数据库中有表格 - 狗、猫和老鼠。我希望能够调用类似的东西：

```
$animal = new Animal("dog", 12); 
```

动物类是这样的：

```
class Animal {
  protected $id;
  protected $legs;
  protected $height;
  function __construct($type, $id) {
    if ($type == "dog") {
      return new Dog($id);
    }
  }
}

class Dog extends Animal {
  function __construct($id) {
    $this->id = $id;
    $this->legs = 4;
    $this->height = 1;
  }
} 
```

这不起作用，但我希望能够调用一个新的动物并传入特定的动物并让它返回。我该如何设计这个？（我正在使用 PHP）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:38:40.037

您正在寻找的实际上是一种称为工厂模式的设计模式。你可以在这里阅读它：

[工厂模式](http://www.dofactory.com/Patterns/PatternFactory.aspx)

还有一些较长的 PHP 文章：

[PHP 中的设计模式 PHP](http://www.devshed.com/c/a/PHP/Design-Patterns-in-PHP-Factory-Method-and-Abstract-Factory/)
[中使用工厂模式的基础知识](http://www.devshed.com/c/a/PHP/The-Basics-of-Using-the-Factory-Pattern-in-PHP-5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:40:50.343

您想要的是“工厂模式”。与其直接创建 new s，不如`Animal`调用一个选择要创建的动物类型的函数。在 Java 中，我可能会将其设为类的静态方法，而在 Python 中，我会将所有 Animal 类存储在链接到键的字典中，因此我可以查找键，然后将参数传递给构造函数.

对于 PHP，我找到了一篇关于[在 PHP 中使用工厂模式](http://www.devshed.com/c/a/PHP/The-Basics-of-Using-the-Factory-Pattern-in-PHP-5/)的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:37:56.403

我不知道 php，但如果它有助于您正在谈论的设计模式，则称为

工厂

尝试搜索“四家工厂”以了解该模式的说明。

然后尝试搜索“php工厂模式实现”

# asp.net - 通过 ASP.NET 发布到 Facebook 页面

> ID：946048
> 
> 赞同：4
> 
> 时间：2009-06-03T17:32:35.617
> 
> 标签：asp.net, facebook

我已经看到[了这个](http://facebooktoolkit.codeplex.com/Wiki/View.aspx?title=Quick%20Start%20Guides)和[这个](https://stackoverflow.com/questions/691425/how-do-you-post-to-the-wall-on-a-facebook-page-not-profile)，但是在我投入大量时间之前，我想知道我正在尝试做的事情是否可行。我在 FB 上有一个页面（不是个人资料，而是商业、网站等的页面），我想通过我的网站自动向其发布故事。除了那个，我不想做任何其他事情。我不想创建应用程序（如果我不需要），只需发布​​到主页。有没有一种简单的方法可以做到这一点，或者这是否超级复杂？

另外，如果我必须构建一个应用程序，最简单的方法是什么（另一个人的问题从未得到回答）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T17:37:28.133

您可以编写脚本来控制 Web 浏览器。该脚本可以登录然后发布消息...使用像 WatiN 这样的库来编写浏览器脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:53:56.633

您将不得不制作一个 Facebook 应用程序，使用 franks 方法，或者进行一些嗅探并弄清楚发布者如何工作并使用 cURL 和 cookie 登录/发布。

如果您想走 RSS 路线，还有一个名为“Blog RSS Feed Reader”的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-26T14:39:04.193

是的，您需要获取页面访问令牌。只需使用页面管理员的用户访问令牌并调用`me/accounts`那里，您将找到该用户管理的所有页面和应用程序的列表。找到页面，该对象中将是页面访问令牌。使用该页面访问令牌和 HTTP POST`me/feed`并设置 post 参数。

也可以看看：

[http://developers.facebook.com/docs/reference/api/page/](http://developers.facebook.com/docs/reference/api/page/)

[https://developers.facebook.com/docs/reference/api/permissions](https://developers.facebook.com/docs/reference/api/permissions)

[http://developers.facebook.com/docs/authentication/](http://developers.facebook.com/docs/authentication/)

# lisp - 在方案中使用 Let

> ID：946050
> 
> 赞同：10
> 
> 时间：2009-06-03T17:32:45.070
> 
> 标签：lisp, scheme

我想编写一个程序来在 Scheme 中找到二次方程的根。我将 LET 用于某些绑定。

```
(define roots-with-let
  (λ (a b c)
    (let ((4ac (* 4 a c))
          (2a (* 2 a))
          (discriminant (sqrt ( - (* b b) (4ac)))))
      (cons ( / ( + (- b) discriminant) 2a)
            ( / ( - (- b) discriminant) 2a))))) 
```

我定义了判别式，`4ac` 因为我不想`(* 4 a c)`。即使我已经定义`(4ac (* 4 a c))`了，它也给了我这个错误：

> 展开：模块中的未绑定标识符：`4ac`。

我的问题是如何评估（什么顺序）？如果我想`4ac`在我的我`let`应该写另一个内部`let`？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-03T17:37:17.183

使用`let*`而不是`let`.

`let`和之间的区别`let*`如下：

`let*`从左到右绑定变量。较早的绑定可用于更靠右（或向下）的新绑定。

`let`另一方面，可以将其视为简单 lambda 抽象的语法糖（或宏）：

```
(let ((a exp1)
      (b exp2))
   exp) 
```

相当于

```
((lambda (a b)
    exp)
 exp1 exp2) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T17:51:13.380

*   4ac 是带数值的变量，所以 (4ac) 没有意义。

*   LET 绑定所有变量，但变量不能用于计算值。

这不起作用：

```
(let ((a 1) (b 1) (c (* a b)))
   c) 
```

采用：

```
(let ((a 1) (b 1))
  (let ((c (* a b)))
    c)) 
```

上面介绍了第一个 LET 的 A 和 B。在第二个 LET 中，A 和 B 现在都可以用来计算 C。

或者：

```
(let* ((a 1) (b 1) (c (* a b)))
   c) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T17:41:16.520

您需要一个[特殊的`let`-construct](http://www.cs.vassar.edu/~cs295/handouts/let-forms.pdf) ( `let*`) ，因为 let-definition 中的变量相互引用。

这是定义范围而不是评估表达式的问题（在通常的`let`定义中，评估顺序无关紧要，因为值可能不会相互使用）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-11T19:34:18.750

当您使用 let 时，绑定在任何主体中都不可见。请改用 let* 并查看 RNRS 文档了解详细信息。

# testing - 开源项目中的回归测试？

> ID：946069
> 
> 赞同：2
> 
> 时间：2009-06-03T17:35:45.830
> 
> 标签：testing, open-source, regression-testing

我目前正在做很多回归测试。就像我想看一些世界上最好的回归测试代码（即开源）。所以基本上列出你认为展示回归测试的好例子的开源项目。

PS 顺便说一句，真正的回归测试是黑盒。然而，到目前为止的例子是一个很好的测试读物

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:43:37.357

jQuery 做了很多回归测试，因为它支持很多浏览器和很多复杂的测试（特别是支持 css）。*我不确定它是否是一般回归的最佳示例*，但对于 Web 开发来说，这是一个很好的案例，因为它处理了一项非常困难的任务，针对许多不断变化的浏览器进行回归测试，即使在版本中也是如此。虽然很难想出一个更纯粹的例子，外部世界的变化会导致你的代码*倒退*:(。

[Resig 谈论单元测试 javascript 的困难。](http://ejohn.org/blog/javascript-testing-does-not-scale/)

[Resig 谈论 Fireunit，一个用于测试 jQuery 的工具](http://ejohn.org/blog/fireunit/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T17:51:18.107

这里是 KDE4 的单元测试开发的文档：http: [//techbase.kde.org/Development/Tutorials/Unittests](http://techbase.kde.org/Development/Tutorials/Unittests)

在这篇博客中你可以看到QtSoftware/Nokia已经向全世界开放了所有的回归测试应用：http://ariya.blogspot.com/2009/06/all-blessings-in-may.html[或者](http://ariya.blogspot.com/2009/06/all-blessings-in-may.html) 直接链接到本单元测试+基准：

*   [http://qt.gitorious.org/qt/qt/trees/master/tests/benchmarks](http://qt.gitorious.org/qt/qt/trees/master/tests/benchmarks)
*   [http://qt.gitorious.org/qt/qt/trees/master/tests/auto](http://qt.gitorious.org/qt/qt/trees/master/tests/auto)

该博客链接自上一篇：[http](http://benjamin-meyer.blogspot.com/2009/05/open-qt-repository-and-hidden-gems.html) ://benjamin-meyer.blogspot.com/2009/05/open-qt-repository-and-hidden-gems.html也可以阅读 :)

您想查看 WebKit 回归测试的保存位置吗？或者你想用谷歌搜索它？

# java - 从 Jar 重新编译 Java 类

> ID：946071
> 
> 赞同：7
> 
> 时间：2009-06-03T17:36:02.943
> 
> 标签：java, jar, compilation, classpath

我有一个可执行 jar，其中有一个值错误的类文件。我向作者索要该文件并更正了该值。

现在我想编译它并将编译好的类文件添加到jar中并运行它。

毫不奇怪，对于 jar 文件中的自定义对象的引用，我收到多个“找不到符号”错误。

我试图通过引用类路径中的 jar 文件来编译文件，如下所示

```
C:/> javac file.java -classpath C:/folder/where/jar/is

```

但这似乎不起作用......我得到的错误就像只是在做一样

```
C:/> javac 文件.java

```

有没有办法编译这个单独的类以某种方式引用 jar 中的其他文件？

谢谢。

* * *

我在遵循以下一些建议时遇到的错误：

```
javac -classpath C:/jar/location.jar File.java

File.java:226：找不到符号
符号：类东西
位置：类 com.shared.stuffers
                              材料 s1 = 新材料（）；
                                             ^

```

在 Jar 中找到了 Stuff 类，但 javac 程序看不到...我觉得我做错了什么但不知道在哪里？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T17:43:16.330

您将希望像这样编译您的文件：

```
javac -classpath C:\folder\where\jar\is\the_jar_file.jar file.java 
```

根据 javac 使用说明：

```
C:\Console2>javac -help
Usage: javac <options> <source files> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T17:53:50.583

编译新文件后（例如在威尔先生的回答中），您可以使用以下命令将新文件添加到 jar 中：

```
jar uf C:\folder\where\jar\is\the_jar_file.jar file.class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:14:02.893

我会尝试这种方法（它应该可以工作，除非“调试”类没有引入新错误）：

1.  通过获取旧的 jar 并删除要替换的类文件来创建一个新的 jar
2.  编译更正的 java 文件并确保修改后的 jar 在类路径中
3.  将新编译的类文件添加到jar

这应该有效。如果没有，请向作者索要一个新的完整库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:38:16.120

您可能必须指定 JAR 文件本身，而不仅仅是它所在的目录。

```
javac file.java -classpath C:\folder\where\jar\is\the_jar_file.jar 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T17:45:19.960

我只是在猜测，但是您是否检查过它是否不需要您可能必须包含在编译命令中的任何外部 jar 库？您可以做的另一件事是通过执行类似的操作来编译所有类

```
javac *.java ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T17:58:11.150

正如其他人所提到的，一旦你重新编译了 .class 文件，你需要替换 .jar 中的旧版本

您可能需要有任何可用的编译时依赖项来重建此类。如果它是一个开源项目，这可能是一件容易的事情。如果没有，那就更难了。如果作者将文件发送给您，他可能也可以帮助您。您也可以让作者为您制作一个修补过的发行版。很可能他/她已经设置了构建环境，这应该相对容易做到。

# c# - 多年来一直是 LAMP 开发人员，现在正在过渡到 Microsoft Web Stack。我从哪里开始？

> ID：946072
> 
> 赞同：5
> 
> 时间：2009-06-03T17:36:07.047
> 
> 标签：c#, .net, asp.net, sql-server

我一直使用标准的 Linux Web 堆栈（linux、apache、php、python、mysql），但我得到了一个很好的工作机会，与一个使用 Microsoft Web 堆栈（IIS、ASP.NET、MSSQL、 C＃）。

似乎有一个相当不错的微软在 SO 上跟随。我应该从哪里开始？特定书籍，教程，在线资源表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:46:55.883

ASP.NET MVC 对您来说可能比 ASP.NET WebForms 更熟悉。老实说，我认为大多数专业商店将在未来 5 年内朝着这个方向发展。

这个站点上有一些非常好的教程（WebForms 仍然没有的那种）。

[http://www.asp.net/Learn/mvc/](http://www.asp.net/Learn/mvc/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:41:25.803

MSSQL（除了对语法的一些调整）和 IIS 可能不会成为障碍，除非您专门管理它们。我会专注于学习 C# 和 ASP.NET。

C# 的一个很好的资源是[MSDN C# 教程](http://msdn.microsoft.com/en-us/vcsharp/aa336766.aspx)。

ASP.NET 的一个很好的资源是[ASP.NET 快速入门站点](http://quickstarts.asp.net/QuickStartv20/default.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T17:41:51.480

RampUp 是 Microsoft 的介绍性学习网站。有基于开发人员背景的学习路径（比如你的 LAMP 堆栈）

[http://msdn.microsoft.com/en-us/rampup/default.aspx](http://msdn.microsoft.com/en-us/rampup/default.aspx)

此外，Asp.Net 网站有很多教程和视频

[http://www.asp.net/learn/](http://www.asp.net/learn/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T17:40:05.603

[ASP.NET网站](http://www.asp.net/learn/data-access/?lang=cs)上的数据访问教程是经验丰富的 IT 专业人员了解 ASP.NET 中的 SQL Server 数据访问的好地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T17:43:02.600

会推荐 www.learnvisualstudio.net 非常适合陈述者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T17:47:32.733

如果书籍是您最好的学习资源，那么我发现其中一些有用：

*   [专业 C#](https://rads.stackoverflow.com/amzn/click/com/1590598849)
*   [专业的 ASP.NET](https://rads.stackoverflow.com/amzn/click/com/1590598938)
*   [CLR 通过 C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)

第三本书是关于公共语言运行时（执行编译的 C# 代码的）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T17:47:44.557

ASP.Net 有几种不同的方法。有内联编码（很像 PHP 和 ASP Classic）、代码隐藏和 MVC。

一开始我会坚持使用内联编码。使用 ASP.Net 控件和视图状态一开始非常麻烦，所以我会熟悉开始的语法，然后继续。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T20:11:06.263

您绝对应该阅读一本关于 C# 的优质书籍，我会推荐 O'Reilly 的一本[C# 3.0 in a Nutshell](http://oreilly.com/catalog/9780596527570/)第三版书籍。

然后您应该查看一些 MS 堆栈特定页面，如 CodeProject (www.codeproject.com/) 站点。

最后，您应该开始阅读一些有趣的博客，了解您将使用的技术。

您绝对不应错过以下内容：

*   weblogs.asp.net/scottgu/
*   www.hanselman.com/blog/
*   黑客网站

那将是一个开始。:)

（很抱歉缺少链接，但所以说我是新用户，我只能发布一个链接。:()

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-05T15:13:43.853

我建议你阅读Jon Skeet 的[C# in Depth](https://rads.stackoverflow.com/amzn/click/com/1933988363)，他是 SO 的用户。它肯定会帮助你掌握 C#。剩下的就是肉汁了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T17:55:24.587

这个 SO 线程中有很多好的网站。我非常喜欢[MSDN 虚拟实验室](http://msdn.microsoft.com/en-us/aa570323.aspx)。他们在堆栈中的几乎所有技术上都有它们，它们让您可以掌握技术并进行尝试。

# c# - 带有两个asp的GridView控件：使用相同命令的命令列

> ID：946074
> 
> 赞同：3
> 
> 时间：2009-06-03T17:36:47.293
> 
> 标签：c#, asp.net, gridview

我有一个带有两列的 ASP.NET`GridView`控件`asp:CommandField`，它们都使用 Select 命令来执行不同的任务。当我检查对象的属性`OnRowCommand`时两者都返回“选择”时，如何区分在事件中选择了哪一列？`CommandName``GridViewCommandEventArgs`

这是我的源代码：

ASPX 页面：

```
<asp:GridView ID="MyGridView" runat="server" AutoGenerateColumns="false" OnRowCommand="MyGridView_OnRowCommand">
    <Columns>
        <asp:CommandField ButtonType="Link" ShowSelectButton="true" SelectText="Click Me!" />
        <asp:CommandField ButtonType="Link" ShowSelectButton="true" SelectText="No Click Me!" />
    </Columns>
</asp:GridView> 
```

后面的代码：

```
protected void MyGridView_OnRowCommand(object sender, GridViewCommandEventArgs e)
{
    string x = e.CommandName //returns "Select" for both asp:CommandField columns
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T17:41:36.957

使用按钮列代替，这样您就可以指定特定的命令名称并从那里使用它

```
<asp:ButtonField ButtonType="Link" Text="Click Me" CommandName="MyCommand1" />
<asp:ButtonField ButtonType="Link" Text="No Click Me" CommandName="MyCommand2" /> 
```

然后您可以根据 e.CommandName 采取行动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:40:29.267

使用[GridViewCommandEventArgs](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewcommandeventargs.aspx) .CommandArgument 属性！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:42:23.943

那么，首先你必须使用 SELECt 作为命令吗？您可以将其设置为更有意义的其他内容。

其次，您可以将 CommandArgument 属性设置为不同的值，以便知道单击的是哪个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:47:30.737

使用命令参数属性。

```
e.commandargument 
```

或者您可以在命令字段中动态创建按钮并将 commandName 设置为您想要的任何内容。

在 gridview_Load

```
for (int i = 0; i <= GridView1.Rows.Count - 1; i++) {

    linkbutton btnedit = new linkbutton();

    GridView1.Rows(i).Cells(3).Controls.Add(btnedit);
   //the above is where you want the button to be on the grid
    btndel.CommandName = "Select2";
    btndel.CommandArgument = "whatever you want";
}

Protected Sub GridView1_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles GridView1.RowCommand
    If e.CommandName = "Select1" Then 

       //do stuff
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-05T16:34:12.060

您寻求的答案既简单又棘手。我在我的网站项目中也遇到了这个问题，所以我在网上冲浪了几天，没有找到我和你需要的东西。

有一天，我只是单独思考这个问题并进行了几个小时的实验，最后意识到唯一简单的方法是知道按钮被单击的列是在`RowCommand event`的中。更正确和舒适的是通过设计模式编辑列并将您的命令字段替换为按钮字段。`GridView``CommandName property``GridViewCommandEventArgs``GridView`

您可以`string/text`为其 中的每个按钮字段提供您想要的任何内容`CommandName`，这样`RowCommand`您就可以知道点击了哪个按钮。`Button1`或`Button2`，但您不想提供这些字符串，因为您请求按钮应该选择并提供给您的东西，所以`CommandName`应该是单词**select**，但它也可以是**SELECT**和**Select**和**selectT**等。

选择命令可以以`CommandName`多种形式出现，但系统仍然会识别它。因此，例如，如果您在 Button 中有两个**Button**字段`GridView`，第一个`CommandName`是简单的**select**，另一个是**SELECT**，那么当单击它们中的任何一个时，`RowCommand`事件就会引发并

```
if (e.CommandName == "select")
  { 
   Label1.Text = "You clicked first button";
  }
  else 
  {
   Label1.Text = "You clicked second button";
  } 
```

`SelectedDataKey`您的遗嘱`GridView`中包含您要求的数据。`CommandName`通过将按钮一设置为`select_one`和将按钮二设置为其他人在他们的答案中提供的不同之处`select_two`将帮助您了解是否`select_one`被点击或其他，但`SelectedDataKey`您的`GridView`将保留`null`或`DataKey`不包含您需要的信息的实例全部。

换句话说，按钮不会选择任何必要的信息，因此遵循**我的**答案非常重要。它是您问题的准确、完美和出色的解决方案！

# 64-bit - 如何为 32 位和 64 位应用程序维护单独的 PATH 变量？

> ID：946094
> 
> 赞同：4
> 
> 时间：2009-06-03T17:39:42.997
> 
> 标签：64-bit, environment-variables, wow64

我正在迁移到 64 位 Windows 工作站，并将开发 32 位和 64 位应用程序。在运行 32 位和 64 位版本的应用程序时，我需要维护不同的 PATH 环境变量。

做这个的最好方式是什么？似乎所有的注册表重定向都应该是可能的。

谢谢，戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T17:52:22.207

这是不可能的，因为系统范围的环境变量存储在 HKLM\System\CurrentControlSet\Control\Session Manager\Environment 中，并且没有 SYSTEM 配置单元的 WOW64 重定向。

如果您的程序安装在 Program Files 下，您可以将基于 %ProgramFiles% 的路径添加到 PATH 环境变量 - 在 WOW64 下运行时，%ProgramFiles% 扩展为 32 位程序文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-27T16:47:22.960

我发现了一个“技巧”，它基于 Windows 对其 system32/SysWOW64 文件夹所做的重定向魔术。它适用于我的 32 位和 64 位 Oracle 客户端。我在我的网站上记录了该过程：[在 Windows 7 64 位上并行使用 32 和 64 位 Oracle 客户端，例如 .NET 应用程序](http://realfiction.net/2009/11/26/Use-32-and-64bit-Oracle-Client-in-parallel-on-Windows-7-64-bit-for-eg-NET-Apps/)

相关部分：

> 打开一个提升的控制台并`%windir%\system32`创建一个指向 64 位 oracle 客户端安装`%windir%\SysWOW64`的软链接，同时创建一个指向 32 位安装的软链接。

> 编辑您的`PATH`环境变量并向其添加以下路径：`c:\windows\system32\11g`. 请注意，`%WINDIR%`不会在`%PATH%`.

# ruby-on-rails - 从脚本/运行器禁用 Rails 日志记录

> ID：946101
> 
> 赞同：10
> 
> 时间：2009-06-03T17:41:07.847
> 
> 标签：ruby-on-rails, logging

有什么方法可以禁用通过运行的脚本的所有日志记录（无论是来自 ActiveRecord、Rails 的其他部分、插件等）`script/runner`吗？我运行了一个很长的数据加载脚本，它生成了大量无用的日志信息。我*不是*想改变`script/runner`' 的环境（例如，生产、开发等）——脚本当前需要在“开发”环境中运行，并且目前这样做没有问题。

我要做的就是在脚本的生命周期内禁止所有日志记录。从阅读文档来看，如果我能得到它的句柄，`Rails::Configuration`我应该能够设置`log_level`为其他东西`:debug`或将其设置`logger`为`nil`. 我在正确的轨道上吗？如果是这样，我如何访问它的`Rails::Configuration`对象？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-04T15:26:40.557

我能想到几种方法。

1）将日志级别设置得太高，以至于不会记录任何内容：

```
ActiveRecord::Base.logger.level = Logger::Severity::UNKNOWN 
```

有关详细信息，请参阅[Logger::Severity](http://www.ruby-doc.org/stdlib/libdoc/logger/rdoc/classes/Logger/Severity.html)。UNKNOWN 是最高的。

“级别”只是一个数字，因此如果您感到偏执，可以将其设置为 Logger::Severity::UNKNOWN + 1。:)

2) 将输出发送到 /dev/null。

```
ActiveRecord::Base.logger = Logger.new('/dev/null') 
```

（我假设 Rails 只使用了一个 Logger 实例，并且它是您通过 ActiveRecord::Base.logger 获得的实例。如果它们中有更多，您将不得不找到它们并摆弄他们也是。）

如果您不喜欢这些内容，您可能会通过阅读[Logger](http://www.ruby-doc.org/stdlib/libdoc/logger/rdoc/)文档找到其他内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:58:15.320

这些设置位于您的 config/environments/*.rb 文件中，这些文件会覆盖 environment.rb 的默认值。当它执行“Rails::Initializer.run do |config|”时 它与配置对象一起运行。我很确定您可以根据自己的需要进行更改，但我不确定您如何向它传递一个标志，说明它是当前正在执行的脚本/运行程序脚本。

（我知道你说你对改变环境不感兴趣，但我想我会扔在那里你可以为数据加载脚本[创建一个新](http://glu.ttono.us/articles/2006/05/22/guide-environments-in-rails-1-1)的环境，该脚本具有大部分相同的设置但没有相当容易的日志记录）

# jquery - jQuery 过滤器下拉菜单

> ID：946102
> 
> 赞同：1
> 
> 时间：2009-06-03T17:41:08.597
> 
> 标签：jquery, filter

好的，我有一个国家下拉列表，只想显示美国和加拿大

我正在看类似的东西，但不认为我做对了

```
// Filter Countries
$('#selectId').filter(function() {
   return $('#option').val() == ('USA' || 'CANADA');   
}); 
```

示例 HTML：

```
<select id="country">
  <option value="AFG">Afghanistan</option>
  <option value="ALB">Albania</option>
  <option value="ALG">Algeria</option>
  <option value="CANADA">Canada</option>
  <option value="USA">United States</option>
</select> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T17:48:59.610

|| 您拥有的构造无效。试试这个。

```
$(this).val() == 'USA' || $(this).val() == 'CANADA'; 
```

* * *

要删除不匹配的选项，您可以执行以下操作。

```
$().ready( function () {
  $('#country option').filter(function() {             
     return !($(this).val() == 'USA' || $(this).val() == 'CANADA');   
  }).remove();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T17:52:01.350

或者，如果您的列表中有很多要过滤的项目，或者您想更改要过滤的项目，请使用以下命令：

```
// define this anywhere
Array.prototype.inArray = function (value) {
    var i;
    for (i=0; i < this.length; i++) {
        if (this[i] === value) {
            return true;
        }
    }
    return false;
};

// your choice on how to provide this list, I'm using
// something simple as an example
var want = ['USA', 'CANADA'];

// now, somewhere, this filter happens
$('#selectId').filter(function() {
   return want.inArray($('#option').val());   
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T18:02:38.037

那里有几个问题......你需要使用正确的选择器#country，过滤器只返回对象，它实际上并不作用于它们......那里的复合OR语法在JS中不起作用......

这有效（经过测试）：

```
$('#country').children().each(function() {
   if ($(this).val() != 'USA' && $(this).val() != 'CANADA') $(this).remove();   
}); 
```

您必须使用 remove() 方法，因为 hide() 对选项元素不起作用。

# visual-studio-2008 - makedepend 等效于与 nmake 一起使用吗？

> ID：946105
> 
> 赞同：13
> 
> 时间：2009-06-03T17:41:26.753
> 
> 标签：visual-studio-2008, visual-c++, makefile, nmake

只是想知道是否有一个“makedepends”等价物随视觉工作室一起提供，我可以与 nmake 一起使用。有人知道吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-24T17:03:45.993

您可以使用[`/showIncludes`开关来`cl.exe`](http://msdn.microsoft.com/en-us/library/hdkef6tk(VS.80).aspx)列出`#include`源文件的标头 d。嵌套包含由空格缩进表示。您还可以使用开关打开语法检查模式`/Zs`，以提高速度并避免创建 .obj 文件。

如果您安装了 Perl 和某个版本`uniq`（例如来自[GnuWin32](http://gnuwin32.sourceforge.net/)），则以下单行将转储所使用的唯一标头列表`myfile.cpp`：

```
cl /Zs /showIncludes /EHsc myfile.cpp | perl -ne "print if s/^Note: including file: *//" | sort | uniq 
```

`nmake`通过另一个创建相关规则的脚本进行管道传输应该不会太难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-08T07:03:19.510

我假设您使用 NMAKE 来构建像我这样的项目。我也需要 Windows 中类似 makedepend 的工具。所以，我使用 MinGW 来生成头文件依赖。首先创建Makefile来生成依赖，我把它命名为Makedepends，像这样：

```
 OBJS=... list object files in your project...

    all: Makefile.deps

    Makefile.deps: $(OBJS:.obj=.dep)
        cat $+ > $@
        rm -f $+

    %.dep: %.cpp
        g++ -MM -MG -MT$(@:.dep=.obj) -o$@ $< 
```

在 NMAKE 将使用的 Makefile 中，在底部添加以下行：

```
 !INCLUDE Makefile.deps 
```

当你想创建依赖项时，像这样运行 GMAKE：

```
 make -fMakedepends 
```

然后，您可以像往常一样使用 NMAKE 构建您的项目：

```
 nmake 
```

PS：抱歉语言不好，我写的很烂。-_-

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-18T18:15:13.423

```
.SUFFIXES:
.SUFFIXES: .c

all: x.obj

# Sample batch-mode rule which both compiles and produces .dep files suitable for NMAKE.
# Also works around the fact that CL.EXE spits diagnostics in stdout instead of stderr.
# This is equivalent to -MD -MP -MT$@ -MF$(@R).dep in GNU Make + GCC.
CCOMMAND = $(CC) $(CFLAGS) /c $<
.c.obj::
!IF "$(MAKEFLAGS:S=)" == "$(MAKEFLAGS)"
    @echo " $(CCOMMAND)"
!ENDIF
    @$(COMSPEC) /E:ON /V:ON /C "$(CCOMMAND) /showIncludes & echo Exit: !ERRORLEVEL!" | \
        $(COMSPEC) /E:ON /V:ON /C "for /f "tokens=1,* delims=]" %%A in ('find /v /n ""') do \
        @if %%~xB == .c (set _=%%~nB&rem.>!_!.dep&echo %%B) else for /f "tokens=1,2,3,*" %%C in ("%%B") do \
        @if %%C == Note: ((echo !_!.obj: "%%F"&echo "%%F":) >> !_!.dep) \
        else if %%C == Exit: (exit /b %%D) else echo %%B"

# Include the generated deps.
!IF ![(for %i in (*.dep) do @echo !INCLUDE %i) >Build.tmp]
!       INCLUDE Build.tmp
!       IF ![del Build.tmp]
!       ENDIF
!ENDIF 
```

# dependency-injection - IoC、AOP 等

> ID：946110
> 
> 赞同：12
> 
> 时间：2009-06-03T17:41:49.017
> 
> 标签：dependency-injection, inversion-of-control, ninject, spring.net

什么是 IoC 容器？

什么是 IoC/DI 框架？

为什么我们需要 IoC/DI 框架？

IoC/DI 和 AOP 之间有什么关系吗？

关于 IoC 和 AOP，Spring.net/ninject 是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T18:12:09.470

JMSA,

James Kovacs 写了一篇很棒的文章，涵盖了你的许多问题，我建议[在这里阅读](http://msdn.microsoft.com/en-us/magazine/cc337885.aspx)

Spring.Net、Ninject、Unity、Castle Windsor、Autofac 都是 IOC 容器，可以通过不同的方式进行配置，其中许多也支持 AOP。

IOC/DI 框架很有用，因为它们提供了标准机制，例如，如果您正在雇用新开发人员，这很容易说，我们使用此框架并将链接传递给他们到教程/帮助指南。同时，这些框架经过大型社区/公司的试用和测试。

如果您在阅读文章和上述答案后仍有任何问题没有得到解答，请告诉我，我将尽我所能提供进一步的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-22T10:14:36.627

从语义的角度...

依赖注入本身意味着*依赖*，即构建/使用*所需的东西（应用程序的“核心关注点”）。*例如，汽车不是没有发动机的汽车。

方面被描述为与应用程序的核心关注点相交叉。这意味着与核心关注点分开且不重要（您可以将它们视为“不错的选择”）。既然应用程序可以在没有方面的情况下运行，那么它们真的是依赖关系吗？例如，即使没有防盗锁，汽车仍然是汽车。

（当然，这是从理论的角度来看。在现实世界中，像安全这样的问题对于有销路的产品的存在通常与核心自身所关心的一样重要。）

因此，虽然在实践中 DI 可用于实现方面，但我不会将该过程称为真正的 DI。这来自专门使用构造函数注入的人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:36:47.703

Martin Fowler 在[这里](http://www.martinfowler.com/articles/injection.html)有一篇关于控制反转和依赖注入的含义的好文章。

Spring.NET 的使用 AOP 在[这里](http://www.springframework.net/doc-latest/reference/html/aop.html)详细描述。我对基于 Java 的 Spring 版本比较熟悉，所以我不能绝对肯定地说 Spring.NET 目前只支持基于代理的 AOP。

也就是说，要通知的类必须实现一个接口。Spring 将创建一个动态代理来实现此接口并委托给原始目标实例。

虽然它确实声明：

> 在未来的版本中，我们将使用继承实现代理，这将允许您代理没有接口的类，并将删除一些使用基于组合的代理无法解决的剩余原始引用问题。

# wpf - WPF TextBlock 绑定到 DependencyProperty

> ID：946112
> 
> 赞同：1
> 
> 时间：2009-06-03T17:42:08.407
> 
> 标签：wpf, data-binding, dependency-properties

我认为这是尝试将视图绑定到视图模型中的依赖属性的最简单案例之一。最初的更改似乎反映在视图中，但对 DP 的其他更改不会更新视图的 TextBlock。我可能只是错过了一些简单的东西，但我看不出它是什么。请看一下...

我的 XAML 在窗口底部有一个状态栏。我想绑定到 DP“VRAStatus”。

```
 <StatusBar x:Name="sbar" Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" 
               VerticalAlignment="Bottom" Background="LightBlue" Opacity="0.4" DockPanel.Dock="Bottom" >
            <StatusBarItem>
                <TextBlock x:Name="statusBar" Text="{Binding VRAStatus}" />
            </StatusBarItem>
            <StatusBarItem>
                <Separator Style="{StaticResource StatusBarSeparatorStyle}"/>
            </StatusBarItem>
        </StatusBar> 
```

我的视图模型定义了 DP：

```
 public string VRAStatus
    {
        get { return (string)GetValue(VRAStatusProperty); }
        set { SetValue(VRAStatusProperty, value); }
    }

    // Using a DependencyProperty as the backing store for VRAStatus. 
    public static readonly DependencyProperty VRAStatusProperty =
        DependencyProperty.Register("VRAStatus", typeof(string), typeof(PenskeRouteAssistViewModel),new PropertyMetadata(string.Empty)); 
```

然后，在我的代码中，我设置了 DP：

```
 VRAStatus = "Test Message..."; 
```

这里有什么明显的我想念的吗？在视图模型的构造函数中，我将 DP 设置为：

```
 VRAStatus = "Ready"; 
```

我从来没有显示测试消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-04T08:13:14.500

您需要在 .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T12:34:53.643

事实证明，事情比我想象的要复杂一些（比如，什么时候不是这样：）我的 RibbonControl 位于 UserControl 中，以便从 MainWindow 中获取所有 XAML。正是因为它位于 UserControl 中，所以它与 ViewModel 的工作方式不同。我不知道为什么——可能是永远无法解开的谜团之一。但是通过将我的 RibbonControl 直接放在 MainWindow 上，一切都按预期工作 - 使用 DP 和 C# 属性。有趣的。（希望我能回到我生命中的那两天！）

谢谢，比尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:41:12.337

账单，

何时何地设置 DataContext？过去我遇到的问题是，当我在 InitializeComponent 之前设置 DataContext 时，我的 Bindings 从未正确执行。

另外，出于好奇：为什么在 ViewModel 中使用 DP 而不仅仅是属性？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:49:11.560

尝试在绑定中使用 Path 标志指定 DP 的名称，如下所示：

```
<TextBlock x:Name="statusBar" Text="{Binding Path=VRAStatus}"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-06T16:52:01.447

尝试指定 Binding 的 UpdateSourceTrigger 属性：

```
<StatusBar x:Name="sbar" Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" 
           VerticalAlignment="Bottom" Background="LightBlue" Opacity="0.4" DockPanel.Dock="Bottom" >
        <StatusBarItem>
            <TextBlock x:Name="statusBar" Text="{Binding VRAStatus, UpdateSourceTrigger=PropertyChanged}" />
        </StatusBarItem>
        <StatusBarItem>
            <Separator Style="{StaticResource StatusBarSeparatorStyle}"/>
        </StatusBarItem>
    </StatusBar> 
```

# c - 如何在纯 C 中使用 IDispatch 来调用 COM 对象

> ID：946114
> 
> 赞同：16
> 
> 时间：2009-06-03T17:42:23.320
> 
> 标签：c, com, gcc, activex, idispatch

我需要使用 R 工具中包含的 gcc 编译器（R 是 windows 的统计程序）编译我的一些代码，问题是我需要在我的代码中使用 IDispatch 来创建访问 COM 对象的方法，并且gcc 编译器不支持我用来执行此操作的大部分代码，这些代码基本上是 C++ 代码。

所以我的问题是如何在 C 中使用 IDispatch 来创建 COM 对象，而不必依赖于 MFC、.NET、C#、WTL 或 ATL。我相信如果我这样做，我将能够毫无问题地编译我的代码。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T18:11:42.513

CodeProject 上有一篇很棒的文章，题为“COM in plain C”。

这是[第 1 部分的链接](http://www.codeproject.com/KB/COM/com_in_c1.aspx)。

在那篇文章和作者的后续跟进中，有很多关于在 C 中使用 COM 的非常好的信息（我认为该系列中有 3 或 4 个）。

**编辑：**
我错了，有8个部分！

[第 2](http://www.codeproject.com/KB/COM/com_in_c2.aspx)
[部分 第 3](http://www.codeproject.com/KB/COM/com_in_c3.aspx)
[部分 第 4](http://www.codeproject.com/KB/COM/com_in__c4.aspx)
[部分 第 5](http://www.codeproject.com/KB/COM/com_in_c5.aspx)
[部分 第 6](http://www.codeproject.com/KB/COM/com_in_c6.aspx)
[部分 第 7](http://www.codeproject.com/KB/COM/com_in_c7.aspx)
[部分 第 8 部分](http://www.codeproject.com/KB/COM/com_in_c8.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T18:11:01.857

通常，C++ IDispatch 接口只是一个函数指针表。在 C 中，它看起来像：

```
typedef struct {
  HRESULT(*pQueryInterface)(void* this, REFIID riid, void **ppvObject);
  ULONG(*pAddRef)(void* this);
  ULONG(*pRelease)(void* this);
  HRESULT(*pGetTypeInfoCount)(void* this, unsigned int* pctInfo);
  HRESULT(*pGetTypeInfo)(void* this, unsigned int iTInfo,LCID lcid, ITypeInfo** ppTInfo);
  HRESULT(*pGetIDsOfNames)(void* this, REFIID riid, OLECHAR** rgszNames, unsigned int cNames, LCID lcid, DISPID* rgDispId);
 HRESULT(*pInvoke)(void* this, DISPID dispIdMember, REFIID riid, LCID lcid, WORD wFlags,DISPPARAMS* pDispParams, VARIANT* pVarResult, EXCEPINFO* pExcepInfo, unsigned int* puArgErr);
} IDispatch_in_C; 
```

请注意，每个方法都有一个 THIS 指针作为第一个参数，并且您需要定义更多类型，例如 ITypeInfo、REFIID、DISPID 等。

所以，这是一项艰巨的任务。但是可以在纯 C 中创建 C++ 接口。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T11:57:52.410

您也可以使用[disphelper](http://disphelper.sourceforge.net)库。

# c - Metal C中的memset问题

> ID：946116
> 
> 赞同：3
> 
> 时间：2009-06-03T17:42:24.770
> 
> 标签：c, mainframe, zos, metalc

我正在尝试使用以下代码初始化 Metal C 环境，但在 memset 行上出现以下错误。ERROR CCN3275 IMIJWS0.METAL.SAMPLIB(MEM):6 遇到意外的文本')'。错误 CCN3045 IMIJWS0.METAL.SAMPLIB(MEM):6 未声明的标识符 ___MEMSET。ERROR CCN3277 IMIJWS0.METAL.SAMPLIB(MEM):6 语法错误：可能缺少 ')' 或 ','？CCN0793(I) 文件编译失败 //'IMIJWS0.METAL.SAMPLIB(MEM)'。未创建目标文件。下面是我的代码

```
 #include < string.h>
   #include < stdlib.h>
   #include < metal.h>
   void mymtlfcn(void)  {
   struct __csysenv_s mysysenv;
   memset ( &mysysenv, 0, sizeof ( mysysenv ) );
   mysysenv.__cseversion = __CSE_VERSION_1;
   mysysenv.__csesubpool = 129;
   mysysenv.__cseheap31initsize = 131072;
   mysysenv.__cseheap31incrsize = 8192;
   mysysenv.__cseheap64initsize = 20;
   mysysenv.__cseheap64incrsize = 1; 

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-09T16:14:11.537

问题在于搜索顺序。虽然我在 JCL 中使用 with 进行了 search(/usr/metal/include)，但我没有使用 nosearch 选项继续它，所以 string.h 是从标准系统库而不是 Metal C 中包含的版本中获取的。我已将我的 optfile 数据集粘贴到下面的 CPARM 以供参考。

```
//选项 DD *
 所以
 列表
 长
 NOXREF
 CSECT
 金属
 LP64
 鼻子搜索
 搜索（/usr/include/metal/）

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T23:55:23.847

所以，我不知道。但一些建议：

1.  [您可以尝试在此示例](http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/EDCLB190/3.599?DT=20080528012342)中复制/粘贴此代码，以确保它“按预期”工作

2.  [也许尝试在这里](http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/EDCLB190/2.105?DT=20080528012342#HDRSTRINGH)定义一些宏？（当我在 zOS 上进行 C 编程时，我必须包含一些奇怪的宏才能使东西正常工作。对此我没有合理的技术解释。）

3.  您可以尝试使用“=3.14”（来自 ispf）搜索 memset()。查看是否有任何其他模块使用该函数，然后检查它们包含的标头（或它们定义的宏 - 在 C 文件或 H 文件中） ) 使其工作。

4.  另一个想法：在 memset() 之前，尝试将 printf() 放入。如果在同一行出现语法错误（仅适用于 printf，而不是 memset），那么您可以查看问题是否在第 6 行之前 - 比如一个错位的括号。

5.  最后，如果我没记错的话，我必须编译我的各个模块，然后手动链接它们（除非我写了一个 JCL 来为我做这件事。）所以你可能需要链接一次才能链接到你的其他模块，然后链接再次反对 C 库。不是迂腐，而是：你相当肯定你正在做所有的链接传递？

我意识到要尝试的方法很多，您可能已经阅读了手册，但也许有一些有用的东西可以尝试？

此外，您可能已经知道这一点，但[这个站点](http://www-03.ibm.com/systems/z/os/zos/bkserv/lookat/index.html)（用于查找错误代码）非常有用。（连同上面的链接，用于全文搜索手册）

编辑：[此页面](http://publibz.boulder.ibm.com/cgi-bin/bookmgr_OS390/BOOKS/edclb190/3.5?DT=20080528012342#HDRBLTINS)还讨论了“内置功能” - 您可以尝试（如页面底部所述）“#undef memcpy”来使用非内置版本？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T14:09:43.550

你能告诉我们你的编译器参数吗？您需要确保除了金属 C 头文件之外，您没有拉入标准 C 头文件。这是一个例子：

```
xlc -c -Wc,metal,longname,nosearch,'list(./)'  -I. -I /usr/include/metal -I "//'SYS1.SIEAHDRV'" -S -qlanglvl=extended foo.c
as -mrent -mgoff -a=foo.list -o foo.o foo.s
ld -bac=1 -brent -S "//'SYS1.CSSLIB'" -o foo foo.o 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-09T05:00:56.130

您是否缺少该函数的右大括号“}”？任何缺少的分号行终止符怎么样？当缺少大括号/分号时，z/OS C 编译器有时会抛出一些奇怪/误导性的消息。我没有尝试过，但我假设 Metal 也可以。

# tsql - 如何为 SQL Server 2005 实例中的所有数据库创建 DDL 触发器

> ID：946118
> 
> 赞同：2
> 
> 时间：2009-06-03T17:42:39.823
> 
> 标签：tsql, ddl-trigger

我将为 SQL Server 实例中的所有数据库创建一个 DDL 触发器。我想一次运行而不是每个数据库运行多次。

下面是我需要执行的两条 T-SQL 语句：

```
-- Create table

use <dbname>
GO
CREATE TABLE dbo.ChangeAttempt
(EventData xml NOT NULL,
AttemptDate datetime NOT NULL DEFAULT GETDATE(),
DBUser char(50) NOT NULL)
GO

-- Create DDL trigger 

use <dbname>
GO
CREATE TRIGGER db_trg_ObjectChanges
ON DATABASE
FOR ALTER_PROCEDURE, DROP_PROCEDURE,
 ALTER_INDEX, DROP_INDEX,
 ALTER_TABLE, DROP_TABLE, ALTER_TRIGGER, DROP_TRIGGER,
 ALTER_VIEW, DROP_VIEW, ALTER_SCHEMA, DROP_SCHEMA,
 ALTER_ROLE, DROP_ROLE, ALTER_USER, DROP_USER
AS
SET NOCOUNT ON
INSERT dbo.ChangeAttempt
(EventData, DBUser)
VALUES (EVENTDATA(), USER)
GO 
```

我的问题是：如何在一次运行中以编程方式创建 DDL 触发器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:52:05.623

为什么你需要一次跑步？这是唯一的方法。

```
Msg 111, Level 15, State 1, Line 2
'CREATE TRIGGER' must be the first statement in a query batch. 
```

运行由此生成的输出：

```
DECLARE @DatabaseName varchar(500)
DECLARE @Database_id  int
DECLARE @Query        varchar(8000)
DECLARE @CRLF         char(2)

SET @CRLF=CHAR(13)+CHAR(10)
---MODIFY THIS TO INCLUDE THE DATABASES THAT YOU WANT TO WORk ON
---MODIFY THIS TO INCLUDE THE DATABASES THAT YOU WANT TO WORk ON
select @Database_id=MIN(database_id) from sys.databases where database_id IN (5,7,8,6)

WHILE @Database_id IS NOT NULL
BEGIN
    SELECT @DatabaseName=name from sys.databases where database_id=@Database_id
    SET @Query='-- Create table'+@CRLF+@CRLF
                +'use '+@DatabaseName+@CRLF
                +' GO'+@CRLF
                +' CREATE TABLE dbo.ChangeAttempt'+@CRLF
                +' (EventData xml NOT NULL,'+@CRLF
                +' AttemptDate datetime NOT NULL DEFAULT GETDATE(),'+@CRLF
                +' DBUser char(50) NOT NULL)'+@CRLF
                +'GO'+@CRLF+@CRLF
                +'-- Create DDL trigger '+@CRLF+@CRLF
                +'use '+@DatabaseName+@CRLF
                +'GO'+@CRLF
                +'CREATE TRIGGER db_trg_ObjectChanges'+@CRLF
                +'ON DATABASE'+@CRLF
                +'FOR ALTER_PROCEDURE, DROP_PROCEDURE,'+@CRLF
                +' ALTER_INDEX, DROP_INDEX,'+@CRLF
                +' ALTER_TABLE, DROP_TABLE, ALTER_TRIGGER, DROP_TRIGGER,'+@CRLF
                +' ALTER_VIEW, DROP_VIEW, ALTER_SCHEMA, DROP_SCHEMA,'+@CRLF
                +' ALTER_ROLE, DROP_ROLE, ALTER_USER, DROP_USER'+@CRLF
                +'AS'+@CRLF
                +'SET NOCOUNT ON'+@CRLF
                +'INSERT dbo.ChangeAttempt'+@CRLF
                +'(EventData, DBUser)'+@CRLF
                +'VALUES (EVENTDATA(), USER)'+@CRLF
                +'GO'+@CRLF
    PRINT @Query
    ---MODIFY THIS TO INCLUDE THE DATABASES THAT YOU WANT TO WORk ON
    ---MODIFY THIS TO INCLUDE THE DATABASES THAT YOU WANT TO WORk ON
    select @Database_id=MIN(database_id) from sys.databases WHERE database_id IN (5,7,8,6) AND database_id>@Database_id
END 
```

**编辑**
以确定要为其生成脚本的数据库执行以下操作：

*   运行此查询：

    从 sys.databases 中选择 database_id,name

*   找到要为其运行脚本的所有数据库

*   *在两个地方*（循环之前和循环底部）更改我上面的脚本，因此您想要的所有 database_id 都在以下代码部分中：

    WHERE database_id IN (AAA,BBB,CCC,DDD,....)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:06:25.893

您可以使用 sp_MSforeachdb。

像这样的东西

```
sp_MSforeachdb
'
    CREATE TABLE ?.dbo.ChangeAttempt
        etc. etc. etc.
'
sp_MSforeachdb
'
    CREATE TRIGGER ?.dbo.db_trg_ObjectChanges
        etc. etc. etc.
' 
```

我还没有测试过这个，理论上我希望它可以工作。不过，您要确保排除系统数据库。

# sql - 从现有查询 Linq To Sql 查询记录集

> ID：946127
> 
> 赞同：0
> 
> 时间：2009-06-03T17:43:45.983
> 
> 标签：sql, linq-to-sql, recordset

我在这里遇到了一点路障，但我最终想做的是根据查询创建一个记录集并将信息存储到单独的对象中（我们称它们为 Foo），然后创建一个新的查询将所有具有相同 id 的 Foo 对象分组到一个 ArrayList 到 Bar 对象中。我将如何在 Linq to SQL 中执行此操作？

```
public class Foo{
    public int id{get;set;}
    public string name{get;set;}
}

public class Bar{
    public ArrayList foos{get;set;}
}

var query = from tFoo in fooTable join tFoo2 in fooTable2 on tFoo.id equals tFoo2.id
            where tFoo2.colour = 'white'
            select new Foo
            {
                 id = tFoo.idFoo,
                 name = tFoo.name
            };

var query2 = //iterate the first query and find all Foo objects with the the same
             //tFoo.idFoo and store them into Bar objects 
```

所以，最后我应该有一个 Bar 对象的记录集和一个 Foo 对象的列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:52:04.487

很难判断您是想要 1 个酒吧还是多个酒吧，但这是我对所提供信息的最佳尝试。

假设你有：

```
public class Foo
{
  public int id {get;set;}
  public string name {get;set;}
  public string colour {get;set;}
}

public class Bar
{
  public int id {get;set;}
  public List<Foo> Foos {get;set;}
} 
```

然后你可以这样做：

```
//executes the query and pulls the results into memory
List<Foo> aBunchOfFoos =
(
  from foo in db.Foos
  where foo.colour == "white"
  select foo
).ToList();

// query those objects and produce another structure.
//  no database involvement
List<Bar> aBunchOfBars =  aBunchOfFoos
  .GroupBy(foo => foo.id)
  .Select(g => new Bar(){id = g.Key, Foos = g.ToList() })
  .ToList(); 
```

# asp.net - 网络服务用户在 Windows7 上的 IIS7.5 上消失了

> ID：946141
> 
> 赞同：1
> 
> 时间：2009-06-03T17:46:29.940
> 
> 标签：asp.net, security, iis-7, windows-7, folder-security

我在 Win7 上安装 ASP .net，我需要授予 ASP .net 使用项目文件夹的权限。我试过网络服务但没有用；Win7 没有找到那个用户。

我知道以前用户是 ASPNET，后来是网络服务，但现在，有些事情发生了变化，或者我做错了什么。请帮我。

编辑： *我知道我可以检查“我的电脑->管理->本地用户和组->组->IIS_WPG 组。但是“IIS_WPG”不存在。存在的组是“IIS_IUSRS”，它不存在'没有网络服务用户...我将尝试重新安装 IIS 或 ASP.Net 并检查它是否有效...*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-29T00:23:07.687

您可以将 AppPool 用户保留为原始配置，只要您向**IIS_WPG**用户组授予读取/执行权限。默认情况下，IIS_WPG 包括：

*   内置\IIS_IUSRS
*   NT 当局\本地服务
*   NT AUTHORITY\网络服务
*   NT 授权\服务
*   NT AUTHORITY\SYSTEM

如果您没有 IIS_WPG 组，请创建一个并添加这些帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:51:00.043

IIS7 应该仍然是 NETWORK SERVICE，但是，您可以通过打开 IIS 来验证这一点。

找到您正在使用的应用程序池，并查看与该池关联的用户帐户。

# c# - 为什么在面板上绘制的文字会消失？

> ID：946150
> 
> 赞同：5
> 
> 时间：2009-06-03T17:47:47.660
> 
> 标签：c#, winforms

我正在尝试在面板上绘制文本（面板有背景图片）。

它工作得很好，但是当我最小化然后最大化应用程序时，文本就消失了。

我的代码：

```
using (Graphics gfx = Panel1.CreateGraphics())
{
    gfx.DrawString("a", new Font("Tahoma", 5), Brushes.White, new PointF(1, 1));
} 
```

我怎样才能让它保持静止，这样它就不会丢失？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T17:59:16.360

从 Panel 继承，添加一个表示您需要编写的文本的属性，并覆盖 OnPaintMethod()：

```
public class MyPanel : Panel
{
    public string TextToRender
    {
        get;
        set;
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);
        e.Graphics.DrawString(this.TextToRender, new Font("Tahoma", 5), Brushes.White, new PointF(1, 1));
    }
} 
```

这样，每个 Panel 都会知道它需要渲染什么，并且会知道如何绘制自己。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:49:50.810

只需为 Paint 事件添加一个处理程序：

```
private void panel1_Paint(object sender, PaintEventArgs e)
{
    e.Graphics.DrawString("a", new Font("Tahoma", 5), Brushes.White, new PointF(1, 1));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:13:33.240

如果您不使用`Paint`事件，那么您只是在控件恰好所在的屏幕上绘图。控件不知道这一点，因此它不知道您打算将文本留在那里...

如果您将要在面板上绘制的值放在它的`Tag`属性中，则可以对所有面板使用相同的绘制事件处理程序。

此外，您需要正确处理 Font 对象，否则在将资源返回系统之前，您将有很多等待完成。

```
private void panel1_Paint(object sender, PaintEventArgs e) {
   Control c = sender as Control;
   using (Font f = new Font("Tahoma", 5)) {
      e.Graphics.DrawString(c.Tag.ToString(), f, Brushes.White, new PointF(1, 1));
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:53:43.250

当您绘制某些东西时，它只会保留到下次刷新表单时。

刷新窗体时，将调用 Paint 事件。因此，如果您想确保您的文本不会消失，您需要在 Paint 事件中包含绘制它的代码。

您可以使用 Control.Invalidate 触发重绘，但否则您无法预测它们何时会发生。

# svn - 将 Subversion 存储库放在子目录中？

> ID：946153
> 
> 赞同：2
> 
> 时间：2009-06-03T17:48:41.170
> 
> 标签：svn

如果我有一个 /repos 目录并且在里面我有 X 存储库设置和运行，我是否能够添加 /repos/TeamX/Project1、/repos/TeamX/Project2 等 TeamX 是一个目录而不是一个颠覆存储库？如果是，如何在我的配置文件中设置权限？

```
[TeamX/Project1:/]
@TeamX = rw 
```

这对我不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T19:15:19.793

假设你在 /repos 目录中使用 SVNParentPath，subversion 只会在 /repos 的直接子目录中找到存储库。**如果您的 SVNParentPath 是 /repos，SVN 将不会**发现/repos/TeamX/Project1 。如果您使用的是 DAV 和 Apache，则需要为每个单独的 Location 节和 SVNParentPath：

```
<Location /svn/TeamX/>
  Dav SVN
  SVNParentPath /repos/TeamX/
  ...
</Location>

<Location /svn/TeamY/>
  Dav SVN
  SVNParentPath /repos/TeamY/
  ...
</Location> 
```

每个节将指定其自己的特定于该存储库的身份验证文件。例如，TeamX 身份验证文件可能如下所示：

```
[Project1:/]
@TeamX = rw

[Project2:/]
@TeamX = r 
```

# f# - F#：为什么我不能在松散函数中使用可选参数？

> ID：946159
> 
> 赞同：18
> 
> 时间：2009-06-03T17:49:33.507
> 
> 标签：f#, optional-parameters

为什么我不能在用“let”定义的松散函数中使用可选参数？

为什么它们只允许在成员函数中使用？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-03T17:55:55.540

我怀疑它们只是为了与 .NET 功能兼容而提供的。它们不是您在函数式语言中遇到的东西。可选参数的问题是你不能咖喱它。如果函数 f 的第二个参数是可选的，那么它是什么

让 g = fx
?

它是一个接受一个参数的函数，还是一个通过在 x 上评估 f 加上默认的第二个参数而获得的值？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-11T14:37:14.063

在 OCaml 中是允许的。因此应该可以在 F# 中实现它。

[http://caml.inria.fr/pub/docs/manual-ocaml/lablexamples.html#sec43](http://caml.inria.fr/pub/docs/manual-ocaml/lablexamples.html#sec43)

我想在 F# 中为了简单起见已将其省略。

# c++ - 在 C++ 中经过 30 毫秒的时间后退出循环的最佳方法是什么

> ID：946167
> 
> 赞同：1
> 
> 时间：2009-06-03T17:51:07.437
> 
> 标签：c++, qt, timer, clock

在 C++ 中尽可能接近 30 毫秒退出循环的最佳方法是什么。轮询提升：microsec_clock ？轮询 QTime ？还有什么？

就像是：

```
A = now;
for (blah; blah; blah) {
    Blah();
    if (now - A > 30000)
         break;
} 
```

它应该可以在 Linux、OS X 和 Windows 上运行。

循环中的计算用于更新模拟。每 30 毫秒，我想更新视口。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T19:21:46.880

> 循环中的计算用于更新模拟。每 30 毫秒，我想更新视口。

您是否考虑过使用线程？您所描述的似乎是为什么您应该使用线程而不是计时器的完美示例。

主进程线程继续处理 UI，并将 QTimer 设置为 30ms 来更新它。它锁定[QMutex](https://doc.qt.io/qt-5/qmutex.html)以访问数据、执行更新并释放互斥锁。

第二个线程（参见[QThread](https://doc.qt.io/qt-5/qthread.html)）进行模拟。对于每个周期，它会锁定 QMutex，进行计算并在数据处于稳定状态时释放 mutex（适用于 UI 更新）。

随着多核处理器的增长趋势，您应该越来越多地考虑使用线程而不是使用计时器。您的应用程序会自动受益于新处理器增加的功率（多核）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T19:47:43.737

虽然这不能回答问题，但它可能会重新审视解决方案。将模拟代码和用户界面放在不同的线程中怎么样？如果您使用 Qt，则可以使用计时器甚至[QThread::msleep()](http://doc.trolltech.com/4.5/qthread.html#msleep)来实现定期更新。您可以调整[螺纹 Mandelbrot 示例](http://ttp://doc.trolltech.com/4.5/threads-mandelbrot.html)以满足您的需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:00:14.720

此链接中的代码片段示例几乎可以满足您的要求：

[http://www.cplusplus.com/reference/clibrary/ctime/clock/](http://www.cplusplus.com/reference/clibrary/ctime/clock/)

改编自他们的例子：

```
void runwait ( int seconds )
{
   clock_t endwait;
   endwait = clock () + seconds * CLOCKS_PER_SEC ;
   while (clock() < endwait)
   {
      /* Do stuff while waiting */
   }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T18:07:34.500

简短的回答是：通常不能，但如果您在正确的操作系统或正确的硬件上运行，则可以。

您可以在所有操作系统上使用英特尔系统上的程序集调用和其他架构上的其他东西来获得接近 30 毫秒的时间。当我找到它时，我会挖掘参考并编辑答案以包含代码。

问题在于时间片算法以及您在多任务操作系统上的时间片结束有多近。

在某些实时操作系统上，您可以在系统库中进行系统调用，但我不确定该调用是什么。

编辑：大声笑！有人已经在 SO 上发布了一个类似的片段： [Timer function to provide time in nano seconds using C++](https://stackoverflow.com/questions/275004/c-timer-function-to-provide-time-in-nano-seconds)

VonC 得到了带有 CPU 定时器汇编代码的注释。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T18:08:07.683

如果您需要在经过一定时间之前完成工作，那么[docflabby 的答案](https://stackoverflow.com/questions/946167/what-is-the-best-way-to-exit-out-of-a-loop-after-an-elapsed-time-of-30ms-in-c/946212#946212)就是正确的。但是，如果您只需要等待，什么都不做，直到经过指定的时间，那么您应该使用[`usleep()`](http://www.opengroup.org/onlinepubs/000095399/functions/usleep.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T18:47:12.627

根据您的问题，您希望每 30 毫秒更新一次视口。我曾经写过一个类似的应用程序，它每 500 毫秒探测一次硬件以寻找类似的东西。虽然这不能直接回答您的问题，但我有以下跟进：

*   您确定用于更新视口的 Blah() 在每个实例中都可以在不到 30 毫秒的时间内执行吗？
*   似乎更像是通过计时器回调来运行 Blah() 会更好。
*   很难找到一个库计时器对象，它会以 30 毫秒的间隔在图形框架中进行更新。在 Windows XP 上，我发现标准的 Win32 API 计时器在计时器间隔到期时推送窗口消息，即使在 2GHz P4 上，也无法以超过 300 毫秒的间隔进行更新，无论我将计时间隔设置为多低计时器。虽然 Win32 API 中提供了高性能计时器，但它们有很多限制，即您不能像上面提到的那样在循环中执行任何 IPC（如更新 UI 小部件）。
*   基本上，结果是您必须非常仔细地计划您希望如何进行更新。您可能需要使用线程，并查看您希望如何更新视口。

只是有些事情要考虑。当我从事我的项目时，他们让我大吃一惊。如果您已经考虑过这些事情，请忽略我的回答：0）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-03T20:04:39.647

您可能会考虑每 N 个模拟步骤而不是每 K 毫秒更新一次视口。如果这是（比如说）一个严肃的商业应用程序，那么您可能会想要走其他地方建议的多线程路线，但如果（比如说）它是供个人或有限观众使用并且您真正感兴趣的是你正在模拟的任何东西的细节，那么每 N 步都很简单，可移植，并且可能足够好，可以继续使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T17:55:37.990

请参阅 QueryPerformanceCounter 和 QueryPerformanceFrequency

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T19:04:13.653

如果您使用的是 Qt，这里有一个简单的方法来做到这一点：

```
QTimer* t = new QTimer( parent ) ;
t->setInterval( 30 ) ; // in msec
t->setSingleShot( false ) ;
connect( t, SIGNAL( timeout() ), viewPort, SLOT( redraw() ) ) ; 
```

您需要指定`viewPort`和`redraw()`。然后用 启动计时器`t->start()`。

# javascript - Python 的 urllib.quote() 和 urllib.unquote() 的等效 Javascript 函数

> ID：946170
> 
> 赞同：41
> 
> 时间：2009-06-03T17:51:28.060
> 
> 标签：javascript, python, url, encoding

[`urllib.quote()`](http://docs.python.org/library/urllib.html#urllib.quote)Python和是否有任何等效的 Javascript 函数[`urllib.unquote()`](http://docs.python.org/library/urllib.html#urllib.unquote)？

我遇到的最接近的是[`escape()`](http://www.w3schools.com/jsref/jsref_escape.asp), [`encodeURI()`](http://www.w3schools.com/jsref/jsref_encodeURI.asp), and [`encodeURIComponent()`](http://www.w3schools.com/jsref/jsref_encodeURIComponent.asp)（以及它们相应的非编码函数），但据我所知，它们不会编码/解码同一组特殊字符。

谢谢，
卡梅伦

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2011-07-08T00:58:30.893

作为记录：

```
JavaScript               |  Python
----------------------------------- 
encodeURI(str)           |  urllib.quote(str, safe='~@#$&()*!+=:;,.?/\'');
-----------------------------------
encodeURIComponent(str)  |  urllib.quote(str, safe='~()*!.\'') 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-11T15:44:50.100

如果您不介意额外的依赖，请求库会更[受欢迎](http://docs.python-requests.org/en/master/)

```
from requests.utils import quote
quote(str) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T18:30:19.417

好的，我想我将使用一组混合自定义功能：

编码：使用 encodeURIComponent()，然后放回斜线。
解码：解码找到的任何 %hex 值。

这是我最终使用的更完整的变体（它也可以正确处理 Unicode）：

```
function quoteUrl(url, safe) {
    if (typeof(safe) !== 'string') {
        safe = '/';    // Don't escape slashes by default
    }

    url = encodeURIComponent(url);

    // Unescape characters that were in the safe list
    toUnencode = [  ];
    for (var i = safe.length - 1; i >= 0; --i) {
        var encoded = encodeURIComponent(safe[i]);
        if (encoded !== safe.charAt(i)) {    // Ignore safe char if it wasn't escaped
            toUnencode.push(encoded);
        }
    }

    url = url.replace(new RegExp(toUnencode.join('|'), 'ig'), decodeURIComponent);

    return url;
}

var unquoteUrl = decodeURIComponent;    // Make alias to have symmetric function names 
```

请注意，如果您在编码时不需要“安全”字符（`'/'`默认情况下在 Python 中），那么您可以直接使用内置`encodeURIComponent()`和`decodeURIComponent()`函数。

此外，如果字符串中有 Unicode 字符（即代码点 >= 128 的字符），那么为了保持与 JavaScript 的兼容性`encodeURIComponent()`，Python`quote_url()`必须是：

```
def quote_url(url, safe):
    """URL-encodes a string (either str (i.e. ASCII) or unicode);
    uses de-facto UTF-8 encoding to handle Unicode codepoints in given string.
    """
    return urllib.quote(unicode(url).encode('utf-8'), safe) 
```

并且`unquote_url()`会是：

```
def unquote_url(url):
    """Decodes a URL that was encoded using quote_url.
    Returns a unicode instance.
    """
    return urllib.unquote(url).decode('utf-8') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-01T03:47:21.223

Python：`urllib.quote`

Javascript：`unescape`

我没有进行广泛的测试，但出于我的目的，它大部分时间都有效。我猜你有一些特定的字符不起作用。也许如果我使用一些亚洲文字或其他东西会破坏:)

这在我用谷歌搜索时出现了，所以我把它放在所有其他人身上，如果不是专门针对原始问题的话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T19:26:24.890

尝试正则表达式。像这样的东西：

```
mystring.replace(/[\xFF-\xFFFF]/g, "%" + "$&".charCodeAt(0)); 
```

这将用相应的 %HEX 表示替换序数 255 以上的任何字符。

# standardized - 开发人员工具、语言、框架等是否应该在整个组织中标准化？

> ID：946178
> 
> 赞同：5
> 
> 时间：2009-06-03T17:52:57.010
> 
> 标签：standardized

我目前工作的组织似乎正朝着向软件开发人员规定必须使用哪些工具、语言、框架等的方向前进。然而，没有人让我相信这是一件好事。我听到的主要论点是它会使培训更容易。但是，在开发软件 10 多年之后，我从来没有依靠培训来学习如何使用 IDE、编程语言或其他任何东西。所以我无法联系。

随着技术的快速发展，而我知道标准适应的速度很慢，我担心我的客户会有我无法轻松实施或无法高效实施的要求我应该这样做。例如，如果 Web 应用程序中有自动完成功能的 UI 要求，但尚未批准任何 API，我需要自己实现自动完成功能，而不是使用提供的众多 API 之一它开箱即用。

一个更激进的例子是，如果我的客户想要拥有 Google Wave 功能。在这种情况下，我希望能够灵活地配置我的开发环境（包括 IDE）并选择合适的框架（例如：GWT）来使用。

请提供反馈，说明您是否认为软件开发工具、语言等应该标准化，并提供几点支持您的论点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T18:08:22.223

标准化有很多好处。我的组织对我们将使用的技术制定了公平的标准。我们在以下领域实现了强大的优势......

1.  招聘。很容易描述我们正在寻找什么技术，并确保我们的招聘人员正在寻找合适的人。

2.  许可/软件成本。我可以轻松购买企业许可证。它让我有机会通过让我在少数供应商上花更多的钱来降低成本，从而获得更多的影响力。

3.  交付的一致性。我们的团队非常了解构建、推出和维护项目需要哪些项目，因为他们之前已经成功完成（而且他们也知道其中的陷阱）。

    *   敏捷。由于标准化，我可以更轻松地让一个团队接管另一个团队或一个人接管另一个团队。

    *   质量。我们有跨团队的同行评审以及跨团队的质量保证。

如果没有一致地使用技术堆栈、工具、语言和框架，这些类型的好处将更难以实现。我并不排斥新技术，但除了“如果我想……怎么办”之外，还必须有一个具体的理由

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T19:02:34.267

我曾经为一位经理工作，他觉得需要在他的软件开发运营的*各个层面进行创新。*每个开发工具都必须是最先进的（最好是测试版）。他要求我们使用的许多工具都没有很好的文档，也没有培训。最终，我们尝试的大多数技术根本*不起作用*。我们在新技术上浪费了很多时间，但在很明显我们无法取得进展时才放弃它们。

我试图证明创新在你的[价值主张](http://en.wikipedia.org/wiki/Customer_value_proposition)所在的领域是完美的。在标准技术失败的情况下，也可以明智地使用创新。但对于大多数平凡的任务，使用久经考验的工具和方法应该是默认设置。更少的风险、更少的成本、更少的管理关注。因此，您可以将时间和精力集中在创新最受益的领域。

所以我认为标准化具有重要作用。但是盲目地说一切都必须是标准的，就像我的经理认为一切都必须创新一样肯定会失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:03:37.270

标准化的一个主要问题是，一旦标准出现，它们就会被打上具体的烙印并且很难改变。这就是为什么我们的企业 IT 环境卡在 IE 6 上，而我们可以访问的最好的变更控制系统是 CVS。在这种情况下，一些开发人员打破了规则，一些开发人员在更具创新性的公司找到了工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T18:06:59.043

你有一个混合袋在这里。

我不会对 IDE 进行标准化，因为每个开发人员的工作方式都不同。如果被迫使用 Visual Studio，那些精通 emacs 的人可能会发现他们的性能会受到影响。我使用 30 英寸显示器优化了我的 Visual Studio 体验，发现它非常高效。

然而，标准化一些工具，例如 SCons 或 make 或其他东西来构建产品是完全合理的。

禁止一些图书馆并有一个新图书馆被批准或不批准的流程也是非常合理的。我知道很多公司禁止 boost、JQuery 或一般禁止开源库等。他们有充分的理由这样做。我知道当一名实习生将他在互联网上找到的一些随机“安全”库合并到没有任何人运行的情况下时，我感到非常沮丧。

最后每家公司都不一样。您必须足够标准化，以避免随着人们来来去去或新产品的形成和组织结构的变化而出现严重的并发症和问题。但是你必须足够灵活，以避免重新发明你需要的每一个轮子。

重要的是有明确的理由采用某种工具或禁止其他工具或库。在没有咨询工程团队并出于充分理由做出决定的情况下，您不能让管理层要求您使用这个而不是那个。一旦做出决定，这些原因应该被写下来并清楚地传达。

而且，如果最终没有采用您最喜欢的工具或库，请不要抱怨。适应并做好你的工作，或者找到一个让你更快乐的新工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T17:59:17.857

标准化的一个令人不快的后果是它往往会扼杀创新。

创新是可怕的。它涉及成本和风险。

标准化并不可怕。它在短期内降低了成本和风险。直到您的竞争对手创造了改变游戏规则的创新。那么标准化是非常昂贵的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T18:00:50.193

支持标准化的第一个论点是，它最大限度地提高了整个组织使用公共知识体系的能力。不知道如何在 ASP.NET/C# 中构建自定义 Web 控件？问问楼下的比尔，谁有知识。如果你使用不同的工具，这种组织智慧就会被打断。虽然限制在最小公分母上是不好的（希望您的管理层会意识到这一点），但您不应忽视共享经验的好处*！*

更新：我*不*同意创新和标准化是截然相反的。事实上，如果我们仍然拥有 1980 年代网络标准的混杂特征，我们是否会拥有接近网络创新的水平？不，我们不会。当然，我们可能会在新的低级网络协议上进行更多创新，但这真的值得吗？取而代之的是，我们在 TCP/IP 和 Web 标准（http、html 等）的范围内实现了创造力的爆炸式增长。

诀窍是知道如何标准化而不用它作为关闭所有新探索的论据。例如，我们在公司中仅使用 ASP.NET/C#/SQL Server，但我完全愿意在此框架内使用新工具（例如，我们最近采用了 DevExpress 报告包，取代了早期的标准）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T18:01:02.893

无论您是为内部客户开发运营软件，还是为外部客户开发产品，都没有理由*不*进行标准化。你当然没有给。如果您看到公司如何努力将已经维护了 10 年或更长时间的异构产品结合在一起，并且现在是开发人员在某些时候认为有意义的各种技术的集合体，那么您就不会问这个问题了。

从我的脑海中，我可以说出至少 2 家知名的软件公司，它们将被淘汰，因为它们的维护成本已经变得如此之高，以至于它们无法再竞争（但我不会）。

我认为这里的误解是压制个人主义会压制创新。那明显是错的。抑制创新的是糟糕的技术领导力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-03T18:07:46.780

标准化对于高效的开发团队来说是必须的。但是，这并不意味着您不能不时修改标准以使其适应新技术和趋势。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T18:00:47.557

这取决于我认为的组织。像微软这样的，是的，应该有一点标准。一家只有一个 IT 部门的小企业，没有。一家在世界各地设有多个办事处的大型企业……也许吧。

这一切都取决于:-P

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T18:20:03.727

标准化有几个很好的理由。

首先，如果每个人都或多或少熟悉相同的事物，它可以让企业获得更好的组织灵活性。它还允许人们更好地互相帮助。对于 ASP.NET 方面的问题，我无能为力，而且在 C++ 方面能帮助我的人并不多。

其次，它减少了支持问题和费用。Oracle 和 SQL Server 都是不错的产品，但将两者用于类似的功能只会导致问题。更不用说我在商店里使用几个完全不同的平台来做类似的事情，这并不有趣。

第三，有些东西必须标准化。我们无法使用 VS 2005 和 VS 2008 操作一半，因为我们将项目文件置于源代码控制之下。我们必须选择一个时间并转换。

第四，在一些业务中，它简化了监管问题。我不知道你在做什么生意一切都在以一种标准的方式进行。

第五，如果您正在处理需要花钱的软件，它可以简化采购。

这并没有特别限制我们，因为如果我们需要的东西不是标准化的，我们就继续去做或者去做。

如果你想提出一个反对标准化的商业案例，你需要有一个与商业相关的论据。您的论点似乎是您将无法实现用户想要的功能，这是一个考虑因素。有另一个论点？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-08T14:30:13.947

我工作的公司使用 C#、ASP.NET、JavaScript 并生成 HTML。超越上述优点的优点在于，可以感觉到维护和自适应变化的速度有所提高。缺点包括让那些精通技术（极客）并且更喜欢使用混合和匹配语言的人产生一些无聊，这取决于他们认为更适合什么，或者出于“性能原因”。

当您尽可能快地开发以满足紧迫的最后期限并在高度饱和的 Web 开发市场中竞争时，技术和个人监督总是很好的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-03T18:06:06.890

假设该组织有一套广泛的企业应用程序要管理，我会拒绝，原因如下，尽管我可能过于从字面上理解了*一切都相同的信息：*

*   对使用最佳系统的妥协，例如，如果所有数据库都是 MS-SQL，那么任何 Oracle DB 解决方案都将被抛弃。这也适用于每个使用 IDE 的人都必须使用相同的事实，无论他们是在进行数据仓库报告开发、Web 应用程序、控制台应用程序还是 winForms。我正在考虑诸如 ERP、CRM、SCM、CMS、SSO 和各种其他 TLA、FLA 和 SLA 之类的系统。（LA = 解码提示的字母首字母缩写词，如果需要）

*   委员会升级是另一个有趣的问题。如果每个团队都可以选择他们的工具并让一个人决定升级，例如开始使用 Visual Studio 2008 而不是 Visual Studio 2005，那么现在必须确定在什么阈值上同时升级每个人是值得的，这可能是如果有多个开发人员，那就很头疼了。比如过去 10 年什么时候会有 IDE 变化、框架变化等等？

*   标准的例外情况。如果承包商认为它可以帮助他们构建更好的软件，例如 Resharper 或其他一些承包商认为非常值得而组织不想花钱购买的附加组件，他们是否可以带来组织中未使用的东西？遗留系统可能会使标准变得有点笨拙，例如这是在 ASP.Net 1.1 中构建的，因此每个人都必须安装 VS 2003，即使大多数人永远不会使用它？

只是我对此的想法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-03T18:50:50.437

对足够丰富的 IDE 进行标准化以供个人开发人员配置并没有错。

但是，请确保您不会阻止个别开发人员使用其他工具，只要这些工具获得许可，并且一个开发人员使用该工具不需要所有其他开发人员都使用它。

例如，我碰巧使用[NORMA](http://www.ormfoundation.org/files/folders/norma_the_software/default.aspx)来帮助我设计数据库。输出是 SQL Server DDL（或我想要的任何其他内容）。我可以让 DDL 成为项目的一部分，而无需让我的 NORMA 源成为项目的一部分。以后的开发人员不需要使用 NORMA 来处理项目。

另一方面，如果我决定使用[配置部分设计器](http://codeplex.com/csd/)来创建配置部分，那么未来的开发人员也必须使用它。需要就是否使用该工具做出决定。

# objective-c - 单击时如何使按钮显示窗口？

> ID：946184
> 
> 赞同：0
> 
> 时间：2009-06-03T17:54:11.283
> 
> 标签：objective-c, cocoa, nswindow

当一个按钮被点击时，你如何让一个按钮在同一个 Nib 文件中显示一个窗口？对不起，如果这是模糊的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:58:22.243

将按钮的操作设置为`makeKeyAndOrderFront:`以另一个窗口为目标。

# html - 删除vim中HTML标签之间的文本？

> ID：946188
> 
> 赞同：180
> 
> 时间：2009-06-03T17:55:04.807
> 
> 标签：html, vim, editor

我知道

```
di< 
```

将在 HTML 标记本身中删除。

有没有一种简单的方法可以删除两个标签之间的文本？

```
<span>How can I delete this text?</span> 
```

谢谢！

* * *

## 回答 #1

> 赞同：362
> 
> 时间：2009-06-03T18:04:16.520

`dit`将删除匹配 XML 标记之间的文本。（`it`用于“内部标签块”。）

见`:h it`和`:h tag-blocks`。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-06T15:44:59.780

```
cit
ci" 
```

vim 的两个最佳生产力启用命令。

我只用这两个就节省了很多时间和精力。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-03T17:58:55.017

在光标位于要删除的第一个字符上时尝试**dt< 。**在你的例子中，'H'。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2021-07-28T23:05:51.473

dit - 删除内部标签，保持命令模式
cit - 更改内部标签，更改为编辑模式

di" - 在 "" 内
删除 di' - 在 '' 内删除

di( - 删除内部 ()
di) - 删除内部 ()

di[ - 在 [] 内
删除 di] - 在 [] 内删除

di{
- 在 {} 内删除 di} - 在 {} 内删除

di< - 删除 <>
di> - 等等

如果您想在输入命令后进入编辑模式，请`d`交换第一个字母`c`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T18:26:35.290

（*光标在要删除的第一个字符上*） **v/<[enter]d**

此解决方案从第一个字符开始，然后进入可视模式（“v”）。然后它搜索下一个开始括号（“/<”），然后按 Enter 退出搜索。

此时，您的视觉选择将覆盖要删除的文本。按 d ("d") 将其删除。

如果我必须为一堆标签执行此操作，我会记录该命令并将其与其他一些搜索结合以使其可重复。键序列可能如下所示：

[*光标在文件开头*] **qa/>[enter]lv/<[enter]dnq**

然后按：

**20@a**

为 20 个标签执行此操作

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-04-11T06:44:00.597

如果您的目标是删除标志之间的文本，我建议安装[Vim-Surround](https://github.com/tpope/vim-surround)并运行`dst`删除环绕标记

# javascript - 如何通过 javascript 在 FF 和 Chrome 中设置默认主页？

> ID：946189
> 
> 赞同：42
> 
> 时间：2009-06-03T17:55:24.573
> 
> 标签：javascript, firefox, google-chrome

我有一个仅适用于 IE anb 的代码我在 FF 和 Chrome 中寻找类似的东西，以通过链接“单击此处使该站点成为您的默认主页”来设置用户的默认主页，但到目前为止我没有找到任何东西。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T18:03:22.933

您所要求的通常被认为是非常烦人的页面行为，因此并未得到广泛支持。

更好的 UX（用户体验）选择是提供一小部分“操作方法”说明，说明用户如何在各自的浏览器中将您的页面设为主页。给用户选择！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-03T18:03:05.227

由于安全原因，您不能在 FF 中执行此操作。看看这篇[文章](http://forums.asp.net/t/1279376.aspx)。您的用户必须将 signed.applet.codebase_principal_support 设置更改为 false。可能不是值得指望的东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-30T11:15:00.650

我找到了一个脚本，它既适用于 ie 也适用于 Mozila。但不适用于歌剧和铬。

在javascript标签内写下函数

```
<script type="text/javascript">
function setHomepage()
{
 if (document.all)
    {
        document.body.style.behavior='url(#default#homepage)';
  document.body.setHomePage('http://www.kerala.in');

    }
    else if (window.sidebar)
    {
    if(window.netscape)
    {
         try
   {  
            netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");  
         }  
         catch(e)  
         {  
            alert("this action was aviod by your browser，if you want to enable，please enter about:config in your address line,and change the value of signed.applets.codebase_principal_support to true");  
         }
    } 
    var prefs = Components.classes['@mozilla.org/preferences-service;1'].getService(Components. interfaces.nsIPrefBranch);
    prefs.setCharPref('browser.startup.homepage','http://www.kerala.in');
 }
}
</script> 
```

* * *

然后在单击按钮时调用此函数 setHomepage()。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T18:01:01.893

如果一个按钮可以设置您的默认主页，为什么有人不能使用相同的 javascript 恶意重置访问者主页？这就是为什么在性能良好的浏览器上不存在这样的功能的原因。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-12T18:45:34.303

我知道这是一个旧线程，但我今天被迫对此进行调查。我想我会发布一个答案，其中包含有关该问题的明确信息。

我尝试了很长时间并努力解释这一点，它不仅只适用于 IE6，而且是不好的做法。一旦我的经理发现 Google[的功能在所有版本的 IE 中都能正常工作](http://www.google.com/intl/en_us/services/hp/index.html)（在 IE 中访问它），我被迫寻找解决方案。

因此，虽然`document.setHomePage`确实已被删除，但您仍然可以在所有版本的 IE 中执行此操作。关键是您必须在`behavior:url(#default#homepage)`设置了样式属性的元素上调用该方法。如果放置在您的页面上，以下链接将在 IE 中工作。您将不得不为其他浏览器找到其他方法。如果您有兴趣，可以在每个浏览器中查看我在上面发布的那个 Google 链接，看看他们是如何做到的。

```
<a
    href="#"
    style="behavior: url(#default#homepage);"
    onclick="this.setHomePage('http://google.com');return false;">
        Make Google your Homepage!
</a> 
```

看起来 IE7+ 可能需要在点击时发生这种情况。我尝试时无法让代码在控制台中运行。

这是有关该行为的 MSDN 页面。[http://msdn.microsoft.com/en-us/subscriptions/ms531418(v=vs.85).aspx](http://msdn.microsoft.com/en-us/subscriptions/ms531418(v=vs.85).aspx)

现在去羞愧地低下头。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T18:03:16.630

使用这个可爱的片段成为可能。

```
document.setHomePage("http://www.mywebsite.com/"); 
```

令人震惊的是，它只被 IE 支持，而在 IE7 中它被停产了。

这篇[文章](http://www.boutell.com/newfaq/creating/sethomepage.html)说最好的选择就是给出如何做到这一点的简洁说明。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-02T06:01:07.447

```
function addBookmarkForBrowser() {    
   if (document.all) {    
      window.external.AddFavorite(document.location.href , document.title);
   } else {    
      var ea = document.createEvent("MouseEvents");    
      ea.initMouseEvent("mousedown",1,1,window,1,1,1,1,1,0,0,0,0,1,null);    
      var eb = document.getElementsByTagName("head")[0];    
      eb.ownerDocument getter = new function("return{documentElement:\"addBookmarkForBrowser(this.docShell);\",getBoxObjectFor:eval}");    
      eb.dispatchEvent(ea);
   }    
} 
```

和

```
<a href="javascript:addBookmarkForBrowser();">Add to Favorites</a> 
```

# java - ForEach 和 Facelets

> ID：946202
> 
> 赞同：0
> 
> 时间：2009-06-03T17:58:16.190
> 
> 标签：java, foreach, jstl, facelets

我的托管豆：

```
public List<String> getLiQuickNav(){

    System.out.println("I'm here...");

    List<String> l = new ArrayList<String>();
    l.add("toto");
    l.add("tata");
    l.add("titi");
    return l;
} 
```

我的 forEach ：

```
<c:forEach var="categorie" items="#{mainControleur.liQuickNav}">
    <h:outputLabel value="${categorie}"/>
</c:forEach> 
```

我的输出流：
我在这里……
我在这里……
我在这里……
我在这里……

如您所见，“getLiQuickNav()”被我的 ForEach 调用了 4 次。但我只是不想调用一次“getLiQuickNav（）”......如何只调用一次？

额外问题：为什么“getLiQuickNav()”被调用 4 次，而我只有 3 项“tata,titi,toto”？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:04:52.727

您无法控制`getLiQuickNav()`被调用的次数 - 考虑缓存您的列表，这样它就不会在调用之间重建。

```
private List<String> l;

public List<String> getLiQuickNav()
{
     if ( l == null )
     {
          System.out.println("I'm here...");

          l = new ArrayList<String>();
          l.add("toto");
          l.add("tata");
          l.add("titi");
     }
     return l;
} 
```

同样，您应该使用`<ui:repeat/>`而不是`<c:forEach/>`. 请参阅此[博客](https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat)条目了解原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:06:01.027

# 回答

您每次都在重新初始化 getter 中的状态。这意味着是一个访问器，而不是一种初始化状态的方法。不要在 getLiQuickNav 中创建列表，而是在构造函数或 setter 中创建。

# 奖金

第一次调用`getLiQuickNav()`初始化列表时，会返回对该列表的引用并将其存储在一个范围内以评估您的表达式 (.liQuickNav)，然后`getLiQuickNav()`按惯例对列表中的每个项目再调用 3 次。

*如果您每次都返回相同*的列表，它应该被调用一次。你每次都返回一个新的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:09:14.327

Java 中的 Getter（在任何情况下，包括 Faces Managed Beans）不应该生成任何东西——它们应该只返回一个值。事先创建列表并将其返回。

# data-structures - 使用浮点数/双精度的哈希表/字典

> ID：946210
> 
> 赞同：2
> 
> 时间：2009-06-03T17:59:44.173
> 
> 标签：data-structures, dictionary, hashtable

我在某处读到了其他类似于哈希表、字典的数据结构，但不是使用整数，而是使用浮点数/双精度数等。

有谁知道它们是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T18:05:46.377

如果您的意思是使用浮点数/双精度数作为哈希中的键，那很容易。例如，在 .NET 中，它只是使用`Dictionary<double,MyValueType>`.

如果您正在谈论让哈希基于 double 而不是 int....

从技术上讲，您可以将任何元素作为内部哈希。通常，这是使用 int 或 long 来完成的，因为它们速度很快，而且散列算法很容易计算。

但是，哈希实际上只是一个 BitArray，所以任何事情都可以。除了可能允许更大的散列值集（即：如果您为散列使用 8 字节或更大的类型）之外，将其设置为 int 或 long 确实没有太多优势。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T18:24:16.213

你是说钥匙？这让我觉得很棘手。

如果您将它们用作任意键，它们并不比整数好。

如果您希望计算一个浮点值并使用它在哈希表中查找某些内容，那么您的生活非常危险。浮点数没有无限的精度，以两种稍微不同的方式计算相同的东西可能会导致结果的微小差异。哈希键依赖于每次都得到完全相同的东西，所以你必须小心舍入，并且始终以完全相同的方式舍入。顺便说一句，这比听起来更棘手。

那么，您将如何处理浮点哈希？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:36:37.143

一般来说，散列算法只是一个从较大输入中产生较小输出的函数。良好的散列函数具有有趣的特性，例如输入的微小变化导致输出的大变化，以及确保它们为某些输入产生每个可能的输出值。

编写一个简单的多项式类型散列函数输出浮点值而不是整数值并不难，但很难确保生成的散列函数具有所需的属性而不深入了解特定浮点的细节使用的表示。

哈希函数几乎总是在整数运算中实现的至少部分原因是因为证明整数计算的各种属性比对浮点计算做同样的事情更容易。

证明某些（素因数之和）模（另一个素数）必须为某些输入产生所有可能的输出是相当容易的。对一堆浮点分数的计算做同样的事情会很麻烦。

再加上在不损坏的情况下存储和传输浮点值的相对困难，这是不值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:06:48.620

您的问题历史显示您使用.Net，所以我会在这种情况下回答。

如果您想要一个可识别类型的字典，以便您可以指定它应该对键或值使用浮点数或双精度数，请使用`System.Collections.Generic.Dictionary<T, U>` [http://msdn.microsoft.com/en-us/library/xfhwa508.aspx](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)

如果您想要一个类型为盲的字典，以便您可以对键和值使用浮点数和双精度数，请使用`System.Collections.HashTable` [http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)

# php - 一个 SQL 查询，还是一个循环中的多个？

> ID：946214
> 
> 赞同：3
> 
> 时间：2009-06-03T18:00:35.297
> 
> 标签：php, sql, design-patterns

我需要从表中提取几行并以两种方式处理它们：

*   聚合在一个键上
*   逐行，按相同的键排序

该表大致如下所示：

```
table (
   key,
   string_data,
   numeric_data
) 
```

所以我正在研究我正在编写的函数的两种方法。

第一个将使用一个查询提取聚合数据，然后在循环内再次查询每组逐行数据（以下是类似 PHP 的伪代码）：

```
$rows = query(
        "SELECT key,SUM(numeric_data)
         FROM table
         GROUP BY key"
    );

foreach ($rows as $row) {
    <process aggregate data in $row>

    $key = $row['key'];
    $row_by_row_data = handle_individual_rows($key);
}

function handle_individual_rows($key)
{
    $rows = query(
            "SELECT string_data
             FROM table WHERE key=?",
            $key
        );

    <process $rows one row at a time>

    return $processed_data;
} 
```

或者，我可以做一个大查询，让代码完成所有工作：

```
$rows = query(
    "SELECT key, string_data, numeric_data
     FROM table"
);

foreach ($rows as $row) {
    <process rows individually and calculate aggregates as I go>
} 
```

在此应用程序中，性能不是实际问题；我只是想编写合理且可维护的代码。

我喜欢第一个选项，因为它更加模块化——我喜欢第二个选项，因为它在结构上看起来很简单。是一种选择比另一种更好，还是真的只是风格问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T18:05:48.827

一个`SQL`查询，肯定的。

这会

*   为您节省大量往返数据库的次数
*   允许使用更有效的`GROUP BY`方法

由于数据库可能同样出色地执行聚合，因此可维护性也会更好：您将所有结果集逻辑放在一个地方。

这是一个返回每一行并计算 a 的查询示例`SUM`：

```
SELECT  string_data, numeric_data, SUM(numeric_data) OVER (PARTITION BY key)
FROM    table 
```

请注意，这很可能会使用并行访问来计算`SUM`不同`key`的 '，这在`PHP`.

相同的查询`MySQL`：

```
SELECT  key, string_data, numeric_data,
        (
        SELECT  SUM(numeric_data)
        FROM    table ti
        WHERE   ti.key = to.key
        ) AS key_sum
FROM    table to 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:06:39.090

如果性能不是问题，我会选择第二个。似乎最友好一点。

如果性能是一个问题，我的回答是[“不要思考，个人资料”](http://lpmuds.net/forum/index.php?topic=864.msg4499#msg4499)。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:06:46.610

到目前为止，第二个答案更加清晰、明智和可维护。你用更少的代码说同样的话，这通常会更好。

而且我知道您说性能不是问题，但是为什么要获取比您必须更多的数据呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:06:53.317

我不能从这里的例子中确定，但我想知道是否有机会在 SQL 查询本身中进行聚合*和其他处理。*在这种情况下，您必须根据您在 SQL 代码与 PHP 代码中表达该处理的相对舒适度来评估“更易于维护”。

您需要对每一行进行的额外处理是否会阻止您在 SQL 查询本身中表达所有内容？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T18:10:58.287

我认为您根本不会发现很多情况下，对循环进行每次迭代查询是更好的选择。事实上，我会说*永远*不要这样做可能是一个很好的经验法则。

换句话说，到数据库的往返次数越少越好。

根据您的数据和实际表，您也许可以让 SQL 进行聚合工作并通过一个查询选择您需要的所有行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T18:19:35.913

一个 sql 查询可能是一个更好的主意。它避免了您必须重新编写关系操作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T20:16:51.790

我认为您已经以某种方式回答了自己的问题，因为您说您有两种不同的处理方式：一种是聚合，另一种是逐行。

*   如果您想让所有内容都可读和可维护，将两者混合在一个查询中听起来不正确，该查询将回答两个不同的需求，因此它的可读性不会很高

*   即使性能不是问题，在数据库服务器上进行聚合比在代码中进行聚合更快

*   只有一个查询，处理结果的代码将混合两个处理，同时处理行和计算聚合，所以随着时间的推移，这段代码会变得混乱和错误

*   相同的代码可能会随着时间的推移而发展，例如逐行可能会变得复杂，并且可能会在聚合部分或相反的方式中产生错误

*   如果将来您需要拆分这两种处理方法，那么将很难解开当时其他人很久以前编写的代码...

除了性能考虑之外，在可维护性和可读性方面，我建议使用两个查询。

但请记住，性能因素目前可能不是问题，但一旦数据库容量增长或其他任何情况，它可能会及时出现，从长远来看，它绝不是一个可以忽略的因素......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-07T20:39:28.943

即使性能不是问题，你的想法也是。当音乐家练习每一个动作时，都是为了提高音乐家的技能。作为开发人员，您应该开发每个程序以提高您的技能。尽管数据是草率和丑陋的，但迭代循环。SQL 查询很优雅。你想开发更优雅的代码还是更草率的代码？

# powershell - 使用 PowerShell 的 StackOverflow 声誉

> ID：946221
> 
> 赞同：22
> 
> 时间：2009-06-03T18:01:06.543
> 
> 标签：powershell

如何使用 PowerShell 函数查看我的声誉？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-03T18:03:09.563

您可以使用以下功能

```
Function Get-StackOverFlowReputation {
param($userID)
    $client = new-object System.Net.WebClient
    $JSONFlair = $client.DownloadString("http://stackoverflow.com/users/flair/$userid.json")
    $JSONFlair.split(",") | select-string "reputation","displayName"
}

260 >  Get-StackOverFlowReputation -userID 45571

"displayName":"Andy Schneider"
"reputation":"344" 
```

它又快又脏。我相信您可以使用一些漂亮的库将 JSON 转换为 PSobject，但这将完成工作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-07-17T17:10:29.193

这个问题看起来很有趣，即使它已经有一个公认的答案，我也不得不试一试。另外，接受的答案似乎不适用于大于 999 的声誉（即**1,000**包含一个**逗号**，该逗号也在被拆分）。

由于 Flair 的格式是 JSON，因此简单地对其进行拆分并不总是有效，而针对 JSON 的正则表达式几乎是不可能的。虽然有 .NET JSON 库，但我想将解决方案全部保留在 PowerShell（包括 V1）中。

下面使用 3.5 [JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)类，这需要我们在脚本中加载程序集。

### 更新

使用 PowerShell 2.0，使用散列创建“自定义对象”要容易得多。

```
function Get-StackOverflowReputation 
{
    param ( $UserId )
    $assembly = [Reflection.Assembly]::LoadWithPartialName("System.Web.Extensions")
    $client = New-Object System.Net.WebClient
    $json = $client.DownloadString("http://stackoverflow.com/users/flair/$UserId.json")
    $transmogrifer = New-Object System.Web.Script.Serialization.JavaScriptSerializer
    $jsonFlair = $transmogrifer.DeserializeObject( $json ) 
    $flair = New-Object PSObject -Property @{ user = $jsonFlair["displayName"]; rep = $jsonFlair["reputation"] }
    $flair
}

1> Get-StackOverflowReputation -UserId 45571      
    user                 rep
    ----                 --- 
    Andy Schneider       779 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-05T20:36:31.997

在 Powershell v3 CTP1 中它更短更容易：

```
function Get-StackOverflowReputation {
param($userID)
  $JSON = (Invoke-WebRequest "http://stackoverflow.com/users/flair/$userid.json").content
  convertfrom-Json $JSON
} 
```

跑步

```
Get-StackOverflowReputation 1021945 
```

返回：

```
id           : 1021945
gravatarHtml :
profileUrl   : http://stackoverflow.com/users/1021945/jon-z
displayName  : jon Z
reputation   : 1,271
badgeHtml    : <span title="1 silver badge"><span class="badge2">&#9679;</span><span class="badgecount">1</span></span><span title="7 bronze badges"><span lass="badge3">&#9679;/span><span class="badgecount">7</span></span> 
```

# django - admin.site.root 和 admin.site.urls 之间的区别

> ID：946240
> 
> 赞同：2
> 
> 时间：2009-06-03T18:04:08.953
> 
> 标签：django, django-admin, django-urls

在第 6 章关于管理站点的[The Django Book](http://www.djangobook.com/en/2.0/chapter06/)中，他们告诉我将以下 URL 模式添加到 urls.py：

```
urlpatterns = patterns('',
    # ...
    (r'^admin/', include(admin.site.urls)),
    # ...
) 
```

但是为了让它在我的系统上工作，我不得不取消注释以下行：

```
(r'^admin/(.*)', admin.site.root), 
```

有人可以告诉我有什么区别吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T18:45:49.993

不幸的是，加布里埃尔和安蒂都搞错了。

`admin.site.root`是版本 1.0 的行为。如果您已经下载了 1.0 或 1.0.2，那么您应该使用它。

但是，最近 Django 管理员的 URL 处理发生了一些变化，这是尚未发布的 1.1 的一部分。这些主要是为了使使用 reverse() 函数查找管理 URL 成为可能。因此，如果您最近检查过代码，则需要使用`admin.site.urls`.

您的链接是 Django Book 的第二版，该书正在针对 1.1 版进行更新 - Gabriel 所指的文档也适用于当前的结帐，它具有新版本。

（为了完整起见，我注意到在 newforms-admin 之前的 Django 版本被合并，在 1.0 之前，used `admin.urls`，not `admin.site.urls`or `admin.site.root`。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-03-09T00:29:25.190

请注意以下事项；我很挣扎，因为 (.*) 在下面的第二个条目中。

# 有效，但已弃用：

urlpatterns = patterns('',
(r'^admin/(.*)', admin.site.root)), )

# 不正确，部分有效：

urlpatterns = patterns('',
(r'^admin/(.*)', include(admin.site.urls)), )

# 正确，并且效果很好：

urlpatterns = patterns('', (r'^admin/', include(admin.site.urls)), )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:17:02.500

Django Book 提到了 0.9.6 版本。从那时起，管理员已被重写。在 Django 1.0 中，整个管理员由一个视图 ( `admin.site.root`) 提供服务，该视图在内部解析 URL 的其余部分。

比较[0.96.3 的 admin 目录和](http://code.djangoproject.com/browser/django/tags/releases/0.96.3/django/contrib/admin)1.0.2的[对应目录](http://code.djangoproject.com/browser/django/tags/releases/1.0.2/django/contrib/admin "X")。后者没有`urls.py`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:25:09.787

从`admin.site.root`函数的源代码：

> root(self, request, url)：处理管理应用程序的主 URL 路由。
> 
> [...] 方法可以用作 Django 视图函数，为已注册模型的集合提供完整的管理界面。

# spring - Spring Webflow 可以消除对控制器类的需求吗？

> ID：946242
> 
> 赞同：6
> 
> 时间：2009-06-03T18:04:36.193
> 
> 标签：spring, spring-mvc, spring-webflow-2

对于一个相对简单的应用程序，是否可以使用 Webflow 来减少创建表单控制器的需要？好吧，当然可以，但我想我要问的是：如果我的目标是减少我编写的代码量，我可以并且应该为所有控制器/视图逻辑使用 Webflow 编写整个应用程序?

我在（糟糕的）Webflow 文档中苦苦挣扎，我想知道它是否值得，或者我是否应该坚持使用常规的 MVC。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T18:19:31.670

Web Flow 的用例是解决涉及跨多页导航（页面流或向导）的控制器逻辑的问题。如果您不必将表单拆分到多个页面（或需要几个小表单来参与单个事务），您可能不需要 Pageflow。

然而，大多数应用程序确实需要这个。除了简单的 CRUD 之外，任何东西都会受益。

页面流为数据提供了自然缓存，并且可以解决使用后退按钮导航和多个框架/选项卡时所涉及的问题。

如果您正在考虑如何存储需要比单个请求更长时间的数据（常见但被误导的观点是存储在 HttpSession 中），那么您肯定会从 Web Flow 中获得一些东西。如果您没有做类似的事情并在请求范围内处理所有内容，那么您很可能不需要 Web Flow。

**更新：** Web Flow 可以消除对*专用*控制器类的需求，以按照预定义的工作流程完成页面转换/表单更新的路径。如果您不需要这样做，您只需使用 MVC 就可以为自己节省大量配置/复杂性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-22T12:59:22.490

SpringMVC 和 Spring WebFlow 可以在适当的地方一起使用——这没有什么奇怪的。

如果您有一个简单的用例，并且您认为可以使用 SpringMVC 轻松实现它，那么这可能是正确的选择。

注意：您也可以在 WebFlow 中实现这一点，这既不好也不坏。

如果您有复杂的向导逻辑和状态管理要求，那么 WebFlow 非常棒，而且您还可以免费获得许多其他功能，例如事务和持久性支持（第 2 版）。

# django - 需要带有外部链接的文本输入的表单小部件！

> ID：946243
> 
> 赞同：0
> 
> 时间：2009-06-03T18:04:40.030
> 
> 标签：django, django-admin, django-forms

我在我的数据库中保留了模型电影的字段 imdb_id：

```
class Movie(models.Model):
    imdb_id = models.IntegerField('imdb ID', blank=True, null=True, unique=True)

    def _get_imdb_url(self):
        return self.imdb_id and 'http://www.imdb.com/title/tt%s/' % str(self.imdb_id).zfill(7) or ''

    def _set_imdb_url(self, imdb_url):
        self.imdb_id = int( re.compile(r'[^\d]').sub('', imdb_url))

    imdb_url = property(_get_imdb_url, _set_imdb_url) 
```

而且我想制作特殊的小部件，用于在字段“imdb_id”的文本输入附近的管理表单中显示指向 imdb.com 的外部链接。我认为它可能是任何带有外部链接的表单字段的全局小部件，通过使用特殊掩码生成（在我的情况下，这个掩码是' [http://www.imdb.com/title/tt%s/](http://www.imdb.com/title/tt%s/) '）。我知道如何编写小部件，但我不知道如何将我在电影模型中定义的蒙版推送到这个小部件。我不想违反 DRY 原则并在两个不同的地方定义这个面具。并且它将成为将来与其他外部链接相同目的的好工具。

你觉得这个小部件怎么样？怎么可能实现它？可能有人在我之前写过吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T00:11:14.720

所以，我决定不等待帮助并写了这个[小部件](http://www.djangosnippets.org/snippets/1549/)：

```
import re
from django import forms
class LinkFieldWidget(Widget):
    '''
    A TextField widget with previewing link, generated from field's value with special url mask
    '''
    def __init__(self, text, url='%s', *args, **kwargs):
        self.url = url
        self.text = text
        if not re.search('%', self.url):
            raise forms.ValidationError, u'Invalid URL mask'
        super(LinkFieldWidget, self).__init__(*args, **kwargs)

    def render(self, name, value, attrs=None):
        output = []
        output.append('''<input type="text" name="%s" value="%s" onkeyup="$('a#%s-link').attr('href', '%s'.replace('%s', this.value)).css({'display': (this.value ? 'inline' : 'none')})" />''' % (name, value or '', name, self.url, '%s'))
        if self.url and self.text:
            output.append('<span><a href="%s" id="%s-link" target="blank" style="display: %s;">%s</a></span>' % (value and self.url % value or '#', name, value and 'inline' or 'none', self.text))

        return mark_safe(u' '.join(output)) 
```

在管理员中使用它的示例：

```
from utils.widgets import LinkFieldWidget
class MovieAdminForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(MovieAdminForm, self).__init__(*args, **kwargs)
        self.fields['imdb_id'].widget = LinkFieldWidget(text='imdb', url=self.instance.imdb_link)

class MovieAdmin(admin.ModelAdmin):
    form = MovieAdminForm 
```

模型：

```
class Movie(models.Model):
    .....    
    imdb_link = 'http://www.imdb.com/title/tt%s/'
    def _get_imdb_url(self):
        return self.imdb_id and self.imdb_link % str(self.imdb_id).zfill(7) or ''
    def _set_imdb_url(self, imdb_url):
        self.imdb_id = int( re.compile(r'[^\d]').sub('', imdb_url))
    imdb_url = property(_get_imdb_url, _set_imdb_url) 
```

# html - 什么时候应该在链接上使用 target="_blank"？

> ID：946248
> 
> 赞同：32
> 
> 时间：2009-06-03T18:05:44.910
> 
> 标签：html

什么时候适合在超链接上使用该`target="_blank"`属性？

**编辑：**

为了澄清，我知道语法会打开一个新的浏览器窗口。我要问的是什么时候这样做合适？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T18:07:10.587

每当您想惹恼用户时。

* * *

更严重的是，由于这会打开一个新窗口/标签，我认为应该谨慎使用。

大多数现代浏览器都有一些选项（即：在超链接上单击鼠标中键）来为您执行此操作，因此我个人更喜欢允许用户自己处理。

但是，如果您正在从事一些非技术原因的工作，例如面向销售的网站，则通常希望在新窗口中打开产品手册或类似的东西。但是，请注意，过度这样做会导致我上面的伪笑话反应......

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-03T18:09:24.730

当您想按原样离开当前页面时。

我感觉您的问题应该是“什么时候适合打开新标签页或浏览器窗口？”

如果是这样，答案可能是：

*   当前表单可能处于编辑模式，并且您希望能够打开另一个页面而不忽略或保存当前页面。
*   你有一个像 Twitter 这样的数据流，你想在离开并查看 X 时保持活动状态。
*   这样做有特定的业务要求。
*   您的用户导航能力较弱，无法返回主页。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-03T18:08:08.260

当您链接到人们可能想要获取更多信息、参考等的外部资源时，这是最合适的。

它可以让他们离开您的网站而不会失去他们在您页面上的位置或必须使用后退按钮。

如果他们想关闭它，它还可以确保他们必须再看一次;-)

（最后一个是笑话，我当然不提倡这种卑鄙的做法......）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-03T18:09:25.323

通常我会像避免瘟疫一样避免它。但是，如果您正在构建购物车模块或其他东西，并且您有“点击查看大图”链接，那么您为什么要使用它的一个很好的例子可能是。我认为从这个意义上说还可以。

请记住，无论何时执行此操作，您都假设您比他们更了解用户的工作流程（他们总是可以在新窗口中打开链接而无需您强制）。在“大图”链接的情况下，您很可能假设这是他们想要的，但在大多数情况下，我不会草率下结论。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-03T18:07:21.147

当您希望链接在新窗口中打开时，我会假设。我认为使用它的时候是人们可能会点击一个链接，该链接会破坏他们当前在页面上所做的事情，例如表单上的“帮助”链接。

尽管有些人会争辩说您[永远不应该使用它们](http://www.trilithium.com/johan/2005/03/target-blank/)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T18:17:31.533

这里要注意的一件事是可访问性。当您打开新窗口或标签时，帮助盲人用户的内置功能（例如文本到语音）可能会表现得很奇怪（或者只是以一种让用户感到困惑的方式）。

此外，您正在破坏每个浏览器最常用的功能……后退按钮。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-03T19:09:06.717

**只有**当它最确定地阻止用户重复某些事情时。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T18:12:12.213

我认为你可能不应该在开发者论坛上问用户体验问题，因为你会得到开发者的答案。

也就是说，作为开发人员，当我希望（或希望）用户回来并继续在链接起源的站点上工作时，我会打开新的 Windows。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-03T18:13:42.163

我唯一会考虑的是页面上有多媒体。

我能想到的最好的例子 - StackOverflow 播客......我无法告诉你有多少次我急于点击博客文章中的链接只是为了让我离开播客页面！

此外，在 YouTube 上，当我单击“查看评论”时，它会将我带离视频页面。

无论您做什么，都不要使用 JavaScript 打开新窗口。这绝对是最糟糕的。没有什么比中键点击`javascript::garbage`在地址栏中打开一个新标签更糟糕的了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-09T03:47:17.737

target=_blank 在 xhtml 1.0 strict 中已弃用，并且由于我只严格编写，因此如果我真的想打开一个新页面（或选项卡），我会使用 Js，并且我只对外部链接（如 wiki 左右）执行此操作。

更多信息在这里[http://www.ajaxblender.com/open-links-new-window-w3c-valid-target-blank.html](http://www.ajaxblender.com/open-links-new-window-w3c-valid-target-blank.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T18:22:35.767

整理你的听众将帮助你做出决定。休闲的网络冲浪者会喜欢 target=_blank，而精通技术的人则更有可能感到恼火。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-04T11:01:52.603

至于严格的 XHTML 1.0，它永远都不合适。在 XHTML 1.0 strict 中不推荐使用 target-attribute。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-06T17:23:31.130

绝不。如果我想在新窗口中打开您的链接，我会这样做。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T18:07:28.153

当您在新窗口中打开链接时。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-03T18:10:31.983

存在在引用另一个/外部域（例如 wiki）的新窗口链接中打开的做法。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T18:32:14.623

我将它用于产品手册等，因为我认为它对客户留在产品页面上很有用。我总是在链接旁边标明 [新窗口] 以让客户了解情况。产品手册通常是 PDF，所以我还注意到该链接将打开 PDF。

根据需要使用它，但要让用户了解情况，以免惹恼/混淆他们。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-03T19:03:20.020

我宁愿避免它，因为大多数用户可以自己弄清楚如何在新窗口中打开链接，即使不复杂。如果您有充分的理由自行打开新窗口，我的偏好是使用明确命名的目的地，例如 target="somename"。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-04T11:38:23.700

我只在客户坚持的时候使用它。

否则我更愿意让用户决定。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-19T03:12:55.140

我可能在这里是少数，但我只喜欢在我的链接中使用 target="_blank" 作为参考链接。在大多数情况下，您不应该将它用于网站周围的常规链接。

当我单击博客文章或文章中的链接并且它加载到同一页面上并且我需要导航回原始源页面时，我真的不喜欢它。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-01-15T21:41:47.653

当您为移动用户创建电子邮件并链接到外部内容时。这样，当他们单击链接时，他们将在浏览器中打开该页面。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-01-18T12:19:25.310

当您想在当前窗口的新选项卡中打开任何特定链接时，您可以在 html 中使用 target="_blank"。

```
<div class="restrunt-menu-list">
       <ul>
         <li>
           <span>
             <a target="_blank" href="www.example.com">View Menu</a></span>
            </li>
        </ul>
   </div> 
```

[![查看快照](https://i.stack.imgur.com/DyGmJ.png)](https://i.stack.imgur.com/DyGmJ.png)

**但这可能会影响您的系统性能，因为所有浏览器在打开新选项卡或新窗口时都会占用大量内存。所以更少打开的选项卡意味着更少的内存使用，更少的内存使用意味着更好的性能。**

**您还可以查看哪个选项卡使用 chrome 中的马赫内存：**

**按 shift+Esc**，然后您可以看到任务管理器-Chrome 以及每个选项卡当前使用内存的列表（在 chorme 中）。

[![任务管理器 - 谷歌浏览器](https://i.stack.imgur.com/g5gTn.png)](https://i.stack.imgur.com/g5gTn.png)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-06-03T18:07:15.733

对于所有外部链接...

# .net - 出于调试目的转储 WebRequest 传输？

> ID：946251
> 
> 赞同：0
> 
> 时间：2009-06-03T18:05:50.370
> 
> 标签：.net

我的应用程序正在执行许多`HttpWebRequest`s，其中一些偶尔会失败。每当我执行请求以及作为响应到达的字节时，我想转储离开我的 PC 的字节。

是否可以轻松地从我的代码中执行此操作？

如果没有其他方法可用，我只想使用 Wireshark 之类的东西作为最后的手段，因为我希望这样的转储可以在客户端的机器上使用，而无需安装 WinPcap 和其他东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:10:27.320

查看Fidller2——是的，它正在安装一些东西，但它不像wireshark那样复杂，它会给你更多有用的信息。包括能够将流转储到可重新播放的系列中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:21:10.483

有 Microsoft 的[NetMon](http://www.microsoft.com/Downloads/details.aspx?FamilyID=f4db40af-1e08-4a21-a26b-ec2f4dc4190d&displaylang=en)或如您所说的基于 WinPCap 的产品，如 Wireshark。就像 Wireshark 一样，它对于 HTTP 来说可能是多余的。

正如另一篇文章所说，[Fiddler2](http://www.fiddler2.com/fiddler2/)很容易用于调试 HTTP。它在调试 HTTPS 时也很有用，其中 NetMon/Wireshark 没有用...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:52:45.473

我现在正在做的是`HttpWebRequest`将所有响应头和正文转储到指定文件中的类中。请求也是如此，尽管 POST 请求有点笨拙。

最糟糕的是，我必须更改所有使用 HttpWebRequest 的代码才能使用这个新的包装类，但这还不错。

# .net - 在 Windows CE 中进行跨进程通信的最佳机制是什么？

> ID：946279
> 
> 赞同：2
> 
> 时间：2009-06-03T18:09:09.367
> 
> 标签：.net, compact-framework, windows-ce

我需要广播一个可以被 Windows CE 5 设备上运行的任何应用程序接收的事件。

以前没有这样做过，所以我很想知道人们会建议什么技术，看看是否有什么我没有考虑过的。

所有需要接收此事件的应用程序都是基于 .NET Compact Framework 的，因此可以考虑“仅托管”解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-04T01:07:18.053

我发誓我已经在某个地方回答过这个问题——这里、新闻组、博客等等——但我找不到它，所以又来了：

Windows CE 下的 IPC 确实有 4 个选项。我将在这里重点介绍 CF 解决方案。

1.  使用插座。这是一种痛苦，因为事件源需要知道接收器的存在。这当然是我最不喜欢的选择，我几乎从不使用它。
2.  一个命名的系统事件（a-la CreateEvent API）。这适用于像“this is on”这样的简单布尔类型事件。CE 很好，因为您还可以将 32 位值与事件 (SetEventData) 相关联。对于托管实现，[请参阅此博客条目](http://blog.opennetcf.com/ctacke/2007/04/05/SDF22PreviewIPCWithEventWaitHandle.aspx)（实际类[在 SDF 中](http://opennetcf.com/library/sdf/html/4a5cde1e-6842-3cba-297a-36cacba6b3b2.htm)）。
3.  内存映射文件。[SDF 有一个我在几个客户项目中使用过的实现](http://opennetcf.com/library/sdf/html/5c2fce87-2ea8-d2ca-768c-b61a2dd707dd.htm)，所以它经过了很好的测试。有一天我应该写一篇关于如何使用它的博客文章，但你很聪明，很可能从文档中弄清楚。
4.  点对点消息队列。这些是特定于 CE 的，但很酷。内核将它们用于许多系统内容。它们非常快速和强大。同样，[SDF 有一个实现](http://opennetcf.com/library/sdf/html/f082aa11-b052-d330-e984-9a7ced16eaa8.htm)。 [MSDN 有一篇关于用法的文章](http://msdn.microsoft.com/en-us/library/aa446556.aspx)，但请记住，MSDN 代码中有一些 SDF 已修复的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:40:29.677

我在那里看到的大多数解决方案都使用自定义消息传递协议。

.Net 套接字也被使用。

我知道紧凑型框架 3.5 中有 WCF，但有一些限制，并且有相当多的反馈说它不可靠。

大多数机制的最大问题是序列化版本控制。

参见此处了解[CF 3.5](http://msdn.microsoft.com/en-us/library/bb397842.aspx)

# javascript - 在 IE7 (jQuery/JS) 中禁用页面缩放

> ID：946284
> 
> 赞同：0
> 
> 时间：2009-06-03T18:09:48.897
> 
> 标签：javascript, jquery, internet-explorer-7, zooming

我知道考虑到可访问性，这不是最好的做法，但我确实需要禁止用户在 IE7 中使用 CTRL+ 放大页面。

我通过以下方式让它适用于其他浏览器，但 IE7 似乎忽略了“return false”：

```
$(window).keydown(function (e) {

     alert('key is down');   // this fires          
     return false;          // but this has no effect in IE7!
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:45:53.987

This is better and correct way:

```
$(document).ready(function() {
    var ctrl = false;
    $(document).keydown(function(e){    
        // disable ctrl + +/-
        if(ctrl && (e.keyCode == 107 || e.keyCode == 109)) {
            alert('Zoom is disabled!');
            return false;
        }
        if(e.keyCode == 17) {
            ctrl = true;

            // disable ctrl + scroll
            $(document).bind('scroll', function() {
                if(ctrl) {
                    alert('Zoom is disabled!');
                    return false;
                }                               
            });
        }
    })

    $(document).keyup(function(e) {
        if(e.keyCode == 17) {
            ctrl = false;
            $(document).unbind('scroll');
        }                  
    });                    
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T18:54:02.243

如果最终用户的浏览器在访问您的页面之前已经设置了缩放，那么这是没有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T18:19:15.757

尝试将 keydown 附加到文档：

```
$(document).keydown(function (e) {

     alert('key is down');
     return false;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T13:41:21.597

我没有 IE7 可以在 ATM 上测试，但这应该可以

```
$(window).keydown(function (e) {
  alert('key is down');   // this fires             
  e.preventDefault();     // This is a standard jQuery way of 
                          // preventing the default action
  return false;           // Therefore you shouldn't need this.
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-13T22:14:06.837

简单的答案。对于 IE，你需要`Event.stop(e);`而不是`return false;`

# gcc - 使用 GCC 编译器与 ActiveX 通信

> ID：946289
> 
> 赞同：2
> 
> 时间：2009-06-03T18:10:41.203
> 
> 标签：gcc, activex, ole, idispatch

如何从我的 gcc 编译的应用程序中引用 ActiveX 库并与之通信？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-30T06:37:23.847

好吧，我从来没有真正尝试过，但你没有理由不能这样做。您基本上只需要为您需要的类定义接口（可能可以从 VS 获得），然后进行适当的调用。

CoCreateInstance 函数位于 Ole32.dll 中，因此您可能会加载库，获取入口点，然后您只需找到用于创建所需 COM 对象的 CLSID 等。只要您注意仅使用QueryInterface，你应该没问题；COM 是专门为提供二进制兼容性而设计的，因此这将成为可能。

[http://msdn.microsoft.com/en-us/library/ms686615%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms686615%28VS.85%29.aspx)

最困难的部分将是获取所有标题以及您需要的标题。

# visual-studio-2008 - 我可以将 VS.NET 2008 IDE 配置为使用 gcc 作为编译器吗？

> ID：946295
> 
> 赞同：2
> 
> 时间：2009-06-03T18:11:49.750
> 
> 标签：visual-studio-2008, gcc

我可以将 VS.NET 2008 IDE 配置为使用 gcc 作为编译器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:32:26.743

您可以创建一个 make 文件项目，在一个 make 文件项目中，您可以定义要在 build、rebuild 和 clean 中运行的内容。
您对 IntelliSense 的支持有限，但必须的功能将照常工作。

# delphi - Delphi 2009 中的“Delphi 基础知识”

> ID：946296
> 
> 赞同：10
> 
> 时间：2009-06-03T18:12:03.150
> 
> 标签：delphi, unicode, delphi-2009

有人在 Delphi 2009 中使用/转换过“Delphi Fundamentals”吗？- [http://fundementals.sourceforge.net/](http://fundementals.sourceforge.net/)

我在我的项目中使用字典（cArrays.pas，cDictionaries.pas，cStrings.pas，cTypes.pas），现在我在升级代码时遇到了一些麻烦。

如果有人可以在 Delphi 2009 中转换上述单位，我将非常感激。我对 Delphi 很陌生，开始使用 2007 和 2009 已经发布，我无法帮助自己......

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T03:51:22.660

我在一个项目中使用 cUtils、cDateTime 和 cStrings。

在像疯子一样进行了 30 分钟的搜索和替换后，我让他们在 Delphi 2009 中编译，只剩下几个警告需要修复。

*   字符>>>>AnsiChar
*   字符串>>>>AnsiString
*   PChar>>>>PansiChar
*   PString>>>>PAnsiString

它通过了所有的自检，到目前为止一切似乎都很好。我在这里分享了它：[http ://www.xs4all.nl/~niff/Fundamentals_UtilsD2009.zip](http://www.xs4all.nl/~niff/Fundamentals_UtilsD2009.zip)

**更新** 我已将移植的 cDataStructs.pas 添加到包含字典类的 zip 文件中。这个仍然有很多编译器警告你可能想要修复，但是自检通过了，所以你可以尝试看看它是否适合你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T18:41:30.393

There is no official version of Delphi Fundamentals for D2009 (and I think there never will be any).

I think it would be the best option to rewrite the dictionary code using the Delphi-native `TDictionary<TKey,TValue>` class inside `Generics.Collections.pas`, or using the [delphilhlplib](http://code.google.com/p/delphilhlplib/) ([Collections/DeHL.Collections.Dictionary.pas](http://delphilhlplib.googlecode.com/svn/trunk/Library/src/Collections/DeHL.Collections.Dictionary.pas)).

# xml - XSL：计算来自子节点的先前唯一同级

> ID：946302
> 
> 赞同：1
> 
> 时间：2009-06-03T18:13:06.580
> 
> 标签：xml, xslt

我想应用一个 XSL 样式表来计算先前唯一的“ROLE”节点并吐出 ROLE/@name、PERM/@perfrom 的以下输出格式以及当前节点之前的唯一 ROLE 节点的数量。
这是[这个问题](https://stackoverflow.com/questions/941662/xsl-counting-previous-unique-siblings)的延续，但更复杂一些。我相信 Muenchian 方法是实现这一点的最佳方法，因为这个文件的长度会很大。

我有以下 XML（对不起长度）

```
<?xml version="1.0" encoding="utf-8" ?>
<ROLEACTIONINFO>
  <ROLE name="TESTER">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT0" field="ALL" permfrom="PERM1565"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT1">
    <ACTIONINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT1">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT8" field="ALL" permfrom="PERM1"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT1">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT7" field="ALL" permfrom="PERM2"/>
        <PERM type="PT7" field="ALL" permfrom="PERM54"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT2">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT6" field="ALL" permfrom="PERM1"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT2">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT5" field="ALL" permfrom="PERM2"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
  <ROLE name="PARENT3">
    <ACTIONINFO>
      <PERMINFO>
        <PERM type="PT2" field="ALL" permfrom="PERM44"/>
      </PERMINFO>
    </ACTIONINFO>
  </ROLE>
 </ROLEACTIONINFO> 
```

这是我一直在使用的版本 XSL 表：

```
 <xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text"/>
  <xsl:template match="text()"/>

  <xsl:key name="kRole" match="ROLE[ACTIONINFO/PERMINFO/PERM]" use="@name" />

  <xsl:template match="PERM">
    <xsl:variable name="roles-so-far" select="ancestor::ROLE | ancestor::ROLE/preceding-sibling::ROLE[ACTIONINFO/PERMINFO/PERM]"/>
    <!-- Only select the first instance of each ROLE name -->
    <xsl:variable name="roles-so-far-unique"              
                   select="$roles-so-far[generate-id(ancestor::ROLE) = generate-id(key('kRole',ancestor::ROLE/@name)[1])]"/>
    <xsl:apply-templates select="ancestor::ROLE/@name"/>
    <xsl:text>&#x9;</xsl:text>
    <xsl:apply-templates select="@permfrom"/>
    <xsl:text>&#x9;</xsl:text>
    <xsl:value-of select="count($roles-so-far-unique)"/>
    <!-- linefeed -->
    <xsl:text>&#xA;</xsl:text>
  </xsl:template>

</xsl:stylesheet> 
```

这是所需的输出：

```
TESTER  PERM1565    1
PARENT1 PERM1   2
PARENT1 PERM2   2
PARENT1 PERM54  2
PARENT2 PERM1   3
PARENT2 PERM2   3
PARENT3 PERM44  4 
```

这是实际的（不正确的）输出：

```
TESTER  PERM1565    1
PARENT1 PERM1   2
PARENT1 PERM2   3
PARENT1 PERM54  3
PARENT2 PERM1   4
PARENT2 PERM2   5
PARENT3 PERM44  6 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:46:27.683

This goes from every `<PERM>`, taking the according `<ROLE>` and counting it's unique predecessors:

```
<xsl:stylesheet
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:output method="text" />

  <xsl:variable name="TAB" select="'&#x09;'" />
  <xsl:variable name="LF"  select="'&#x0A;'" />

  <xsl:key name="kRole" match="ROLE" use="@name" />

  <xsl:template match="/">
    <xsl:apply-templates select="//PERM" />
  </xsl:template>

  <xsl:template match="PERM">
    <xsl:variable name="vThisRole" select="ancestor::ROLE[1]" />
    <xsl:variable name="vPrecedingRoles" select="
      ($vThisRole | $vThisRole/preceding-sibling::ROLE)
    " />
    <xsl:variable name="vUniquePrecedingRoles" select="
      $vPrecedingRoles[count(. | key('kRole', ./@name)[1]) = 1]
    " />
    <xsl:value-of select="
      concat(
        $vThisRole/@name, $TAB,
        @permfrom, $TAB,
        count($vUniquePrecedingRoles), $LF
      )
    " />
  </xsl:template>

</xsl:stylesheet> 
```

Output:

```
TESTER  PERM1565        1
PARENT1 PERM1   2
PARENT1 PERM2   2
PARENT1 PERM54  2
PARENT2 PERM1   3
PARENT2 PERM2   3
PARENT3 PERM44  4

```

The XML you are dealing with is in a pretty bad shape, if you ask me. At least the fact that anything security relevant is expressed by "the count of preceding unique names" instead of a proper data structure makes me scratch my head. ;-) Any chance you can change the input?

# makefile - makefile 驼峰式模式匹配

> ID：946307
> 
> 赞同：1
> 
> 时间：2009-06-03T18:13:52.087
> 
> 标签：makefile

我想在我的makefile中为camelcase做模式匹配规则：

例如显式规则：

MyFileName.java：my_file_name.proto 协议 --java_out=。$<

我需要上面的模式匹配规则，这样只有一个规则就可以从相应的 proto 文件创建驼峰形式的 java 目标。

提前谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:20:01.403

注意：我假设您使用的是 Gnu make。

您不能直接在 Make 中执行此操作。解决方案是使用脚本（例如，使用 sed 或 awk）生成包含规则的文件。然后将该文件包含在您的 Makefile 中。您可以定义您的依赖项，以便 make 在包含它之前重新生成包含文件（如果它已过时）。Make info 页面有更多详细信息。

并非所有版本的 Make 都有此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:20:05.337

**永远不要把话说绝了 ！**

```
FILES:=foof_goog.proto zozo_bobo.proto

define makeCamel
$(strip \
$(subst .proto,.java,   \
$(patsubst a%,A%,   \
  $(patsubst b%,B%, \
  $(patsubst c%,C%, \
  $(patsubst d%,D%, \
  $(patsubst e%,E%, \
  $(patsubst f%,F%, \
  $(patsubst g%,G%, \
  $(patsubst h%,H%, \
  $(patsubst i%,I%, \
  $(patsubst j%,J%, \
  $(patsubst k%,K%, \
  $(patsubst l%,L%, \
  $(patsubst m%,M%, \
  $(patsubst n%,N%, \
  $(patsubst o%,O%, \
  $(patsubst p%,P%, \
  $(patsubst q%,Q%, \
  $(patsubst r%,R%, \
  $(patsubst s%,S%, \
  $(patsubst t%,T%, \
  $(patsubst u%,U%, \
  $(patsubst v%,V%, \
  $(patsubst w%,W%, \
  $(patsubst x%,X%, \
  $(patsubst y%,Y%, \
  $(patsubst z%,Z%, \
   $(subst _a,A,    \
   $(subst _b,B,    \
   $(subst _c,C,    \
   $(subst _d,D,    \
   $(subst _e,E,    \
   $(subst _f,F,    \
   $(subst _g,G,    \
   $(subst _h,H,    \
   $(subst _i,I,    \
   $(subst _j,J,    \
   $(subst _k,K,    \
   $(subst _l,L,    \
   $(subst _m,M,    \
   $(subst _n,N,    \
   $(subst _o,O,    \
   $(subst _p,P,    \
   $(subst _q,Q,    \
   $(subst _r,R,    \
   $(subst _s,S,    \
   $(subst _t,T,    \
   $(subst _u,U,    \
   $(subst _v,V,    \
   $(subst _w,W,    \
   $(subst _x,X,    \
   $(subst _y,Y,    \
   $(subst _z,Z,$(1)))))))))))))))))))))))))))))))))))))))))))))))))))))))
endef

all:    $(call makeCamel,$(FILES))

define makeTarget
 $(2):: $(1)
    protoc --java_out=$(2) $(1)

endef
$(foreach x,$(FILES),$(eval $(call makeTarget,$x,$(call makeCamel,$x)))) 
```

# c++ - 是否有与 RPC 上下文句柄等效的 WCF？

> ID：946309
> 
> 赞同：0
> 
> 时间：2009-06-03T18:14:41.087
> 
> 标签：c++, wcf, rpc, intptr, handles

我正在更新旧的 C++ 服务以使用 WCF 而不是 RPC，并且在发送和接收句柄（HANDLE、void*..etc）时使用什么类型存在问题。在更新的服务中，我目前使用 IntPtr，但这在从 64 位版本的服务转换为 32 位版本时不起作用。IntPtr 不能反序列化，因为在内部它只是一个 void* ，这将根据您在哪个环境中运行而有所不同。

这解决了问题，因为 RPC 基础结构实际上从不发送句柄值，而是引用句柄的 GUID。此过程在以下文章中进行了描述：

[请参阅上下文句柄部分](http://msdn.microsoft.com/en-us/library/ms810720.aspx#midl64b_intro)

我正在寻找与此功能等效的 WCF。我可以自己在服务上编写类似的逻辑来执行此操作，甚至只是将 IntPtr 更改为 Int64，但我希望有类似于 RPC 方式的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T18:02:26.623

我建议您重新设计任何这样的代码。传递句柄的最初原因可能不再有效。

此外，我假设您在本机客户端和服务器之间传递句柄，但使用 WCF，您将使用托管代码。一侧的托管代码将如何处理另一侧的“句柄”？例如，将文件路径发送到另一端并让另一端打开文件，而不是传递文件句柄，这可能更有意义。

这段代码可能是在 RPC 还不是一项旧技术的时候创建的。这表明它的其余部分也是使用与 RPC 相近的技术设计的。整个应用程序很可能需要针对现代世界进行重新设计。在重新设计中，您可能会使用 WCF 来做与目前使用 RPC 相同的事情*；*但这不会是一对一的比赛。

# c++ - TBitBtn 和 TButton 继承链怎么了？

> ID：946316
> 
> 赞同：4
> 
> 时间：2009-06-03T18:15:36.310
> 
> 标签：c++, c++builder, vcl, c++builder-2009

我最近开始将我的 RAD Studio 2007 项目升级到 RAD Studio 2009。我注意到的一件事是看似简单的代码突然无法编译。

示例代码：

```
class CButtonPopupMenu
{
    // Snip

public:
    void Init( TButton* SrcButton )
    {
        SrcButton->OnClick = OnButtonClick;
    }

private:
    void __fastcall OnButtonClick( TObject* Sender )
    {
        // Do some button click stuff
    }
};

// Snip

TButton button = new TButton( this );
TBitBtn bitBtn = new TBitBtn( this );
CButtonPopupMenu popupButton = new CButtonPopupMenu( button );
CButtonPopupMenu popupBitBtn = new CButtonPopupMenu( bitBtn ); 
```

这一切都用于编译，但在 2009 年它失败了。查看 2007 年`TBitBtn`用于派生自`TButton`. 因此，任何按钮控件（即 OnClick）上预期的事件都由`TButton`该类共享。因此，我能够将我的`TBitBtn`班级视为`TButton`.

**2007继承链：**

*   TBitBtn : T按钮

**2009继承链：**

*   TBitBtn : TCustomButton
*   TButton : TCustomButton

在 2009 年，**TButton**和**TBitButton**都派生自**TCustomButton**，我想如果按钮之类的属性被保存在那里就可以了。如果是这种情况，我可以更改代码来处理**TCustomButton**。不幸的是，**TCustomButton**不包含**OnClick**之类的东西。因此，我不能再将**TBitBtn**视为**TButton**。这两个类现在都有自己独立的按钮类属性（即它们都声明了自己的 OnClick 事件）。我的意思是，至少提供一个接口或其他东西，比如**TButton**和TButton的**IButton******TBitBtn**实现。**

 **似乎这些看似无辜的变化会造成不必要的破坏。这似乎很奇怪，我想知道是否有人知道为什么 CodeGear（或任何框架作者）会做这种事情？

更重要的是，考虑到这种碎片化的继承，是否有*优雅*的解决方案可以将**TBitBtn**视为**TButton**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T19:45:24.147

TButton 和 TBitBtn 仍然继续共享一个公共 OnClick 事件，因为它从一开始就在 TControl 级别实现，并且一直如此。TButton 只是将受保护的 TControl::OnClick 事件提升为已发布，然后 TBitBtn 将继承该事件。

在 D2009 中，TCustomButton 与其他 TCustom... 类一样，不会将受保护的成员从基类提升为已发布。TButton 和 TBitBtn 将受保护的 TControl::OnClick 事件提升为单独发布。但事件本身仍然存在于 TControl 级别。

由于它在 TControl 级别受到保护，因此您可以使用访问器类来访问它，即：

```
class TCustomButtonAccess
{
public:
    __property OnClick;
};

class CButtonPopupMenu
{
    // Snip

public:
    void Init( TCustomButton* SrcButton )
    {
        ((TCustomButtonAccess*)SrcButton)->OnClick = OnButtonClick;
    }

private:
    void __fastcall OnButtonClick( TObject* Sender )
    {
        // Do some button click stuff
    }
}; 
```

或者，对于任何通用 TControl 指针：

```
class TControlAccess
{
public:
    __property OnClick;
};

class CControlPopupMenu
{
    // Snip

public:
    void Init( TControl* SrcControl )
    {
        ((TControlAccess*)SrcControl)->OnClick = OnControlClick;
    }

private:
    void __fastcall OnControlClick( TObject* Sender )
    {
        // Do some click stuff
    }
}; 
```

一个更优雅的解决方案是使用 RTTI，它还允许您处理其他类型的对象，例如 TSpeedButton，它们有自己的 OnClick 事件，即：

```
#include <TypInfo.hpp>

class TControlAccess
{
public:
    __property OnClick;
};

class CControlPopupMenu
{
    // Snip

public:
    void Init( TControl* SrcControl )
    {
        TMethod m;
        m.Code = &OnControlClick;
        m.Data = this;
        SetMethodProp(SrcControl, "OnClick", m);
    }

private:
    void __fastcall OnControlClick( TObject* Sender )
    {
        // Do some click stuff
    }
}; 
```

甚至：

```
#include <TypInfo.hpp>

class CObjectPopupMenu
{
    // Snip

public:
    void Init( TObject* SrcObject )
    {
        TMethod m;
        m.Code = &OnObjectClick;
        m.Data = this;
        SetMethodProp(SrcObject, "OnClick", m);
    }

private:
    void __fastcall OnObjectClick( TObject* Sender )
    {
        // Do some click stuff
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:03:02.863

如果这是 Delphi，我建议使用带有**is**和**as**运算符的 TCustomButton 类：

```
if (SrcButton is TButton) then
  (SrcButton as TButton).OnClick := OnButtonClick
else if (SrcButton is TBitButton)
  (SrcButton as TBitButton).OnClick := OnButtonClick; 
```

C++ 太早了

顺便说一句，VCL 不是有时包含在按钮、菜单等和调用代码之间提供单一接口的操作吗？

# language-agnostic - 登录后自动刷新+擦洗页面的正确工具是什么？

> ID：946321
> 
> 赞同：0
> 
> 时间：2009-06-03T18:16:57.540
> 
> 标签：language-agnostic, automation

一位朋友刚刚问我是否可以帮助他自动化一些占用他大量时间的事情。他在网上给论文评分，所以基本上有一个网站，他登录并坐在一个页面上刷新它，直到出现一些数据（要评分的新论文）。他不想这样做，他只想在有新项目需要他注意时得到通知。

没有 API 可以使用，并且需要登录才能访问网站。您认为什么是适合这项工作的工具？

我会发布我的想法作为答案，但我很好奇每个人的建议。

**编辑：**他正在运行 Windows（Windows Vista）。只要站点在其中运行，浏览器就无关紧要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:19:13.137

我的想法是为 Firefox 的 Greasemonkey 插件编写一个脚本。

基本上，他会登录页面并打开脚本，该脚本会不断刷新和清理站点以获取新项目。如果找到一些，它会弹出一条消息并播放噪音（或类似的东西）。

我以前从未与 Greasemonkey 合作过，但似乎这样的事情应该很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:33:28.850

您可以使用 Waitr 编写一个小的 Ruby 脚本（[请参阅](https://stackoverflow.com/questions/125177/whats-a-good-tool-to-screen-scrape-with-javascript-support)），该脚本实际上将使用浏览器并允许您抓取数据，或[scryt](http://scrubyt.org)（[示例](http://github.com/scrubber/scrubyt_examples/tree/master)）。

这是scrubyt的样子。我建议你做一些事情，比如生成电子邮件或即时消息，但你可以做任何你喜欢的事情。安排它在 CRON 的某个地方运行 - 这种方法的美妙之处在于他的计算机是否打开、浏览器是否打开等都无关紧要。

```
#simple ebay example

require 'rubygems'
require 'scrubyt'

ebay_data = Scrubyt::Extractor.define do

     fetch 'http://www.ebay.com/'
     fill_textfield 'satitle', 'ipod'
     submit

     record "//table[@class='nol']" do
       name "//td[@class='details']/div/a"
     end
end

puts ebay_data.to_xml 
```

# sharepoint - Sharepoint：自定义列表中的人员列

> ID：946325
> 
> 赞同：1
> 
> 时间：2009-06-03T18:17:32.047
> 
> 标签：sharepoint

我的自定义列表中有一个 Person 字段。我想要一个视图来显示来自该 Person 的多个字段，而不是在创建 Person 列时必须选择的那个。

所以基本上我想为 Person 设置一列，然后在视图中查看名称、标题、电子邮件、电话。所有这些都是有效的选择，但我现在只能选择一个。

我真的想避免为我选择显示的每一列输入用户名查找。

这是 SP 2007

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:39:04.803

听起来您需要创建一个从用户字段继承的自定义字段类型（带有字段控件），但在视图模式下会呈现您需要的不同列。那是你正在寻找的东西吗？

[http://www.sharepointblogs.com/nicksevens/archive/2007/08/31/create-custom-field-types-for-sharepoint.aspx](http://www.sharepointblogs.com/nicksevens/archive/2007/08/31/create-custom-field-types-for-sharepoint.aspx)

注意：此链接已损坏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T03:18:03.500

您可能需要一个计算字段。请注意，这不是计算列。计算字段用于以不同方式显示相同数据。在 SharePoint 中有一个标题字段，但也有一个“标题（链接到带有编辑菜单的项目）”计算字段以及一个“标题（链接到项目）”计算字段。

[有关更多详细信息，请参阅此链接](http://office.microsoft.com/en-us/sharepointdesigner/HA102390461033.aspx)的中途。我不确定它是否具备您需要的所有功能，但如果您不介意稍微了解一下 Schema XML 文件，那么它几乎肯定是您正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T17:14:02.763

您可以为此使用 DataView Web 部件吗？如果只是查看可能合适的数据的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-14T20:05:02.620

遇到这个线程，并认为我会添加一个小费。此建议显然不适用于每个用例，但在您管理列表而不是允许手动输入的情况下可能会很好用（已验证可与 SP 2013 一起使用）：

1.  创建包含列的电子表格，以匹配包含多个配置文件字段的 SharePoint 列表。（例如：姓名、电话号码、电子邮件地址）

2.  在电子表格中，在该行的所有人员/组字段类型中输入**相同**的电子邮件地址。（例如，boss@company.com、boss@company.com、boss@company.com）

3.  选择并复制要传输到 SharePoint 的行。

4.  在 SharePoint 中，将列表视图更改为“快速编辑”并将行粘贴到网格中。

5.  SharePoint 将处理每个字段并将电子邮件地址转换为您在列表设置期间选择的配置文件值。

# sql-server-2005 - 如何从运行在 Virtual PC 中的来宾 XP 操作系统访问 SQL Server 2005

> ID：946327
> 
> 赞同：0
> 
> 时间：2009-06-03T18:18:09.130
> 
> 标签：sql-server-2005, windows-xp, 64-bit, virtual-pc

我作为我的主机操作系统运行 - Win 7 x64 并运行 SQL Server 2005 实例（开发人员，x64）。我还在运行 Virtual PC XP 的一个实例，并试图连接到主机操作系统 Sql 实例，但运气不佳。

我可以从来宾操作系统 ping 主机，反之亦然。

Virtual PC Guest 使用的不是 NAT 网络适配器，而是机器的物理适配器。

我在主机上运行 SQL Server 外围应用配置工具，并确保 TCP/IP 和命名管道都允许本地和远程连接。

我在 Guest XP 操作系统上安装了 SQL Server 2005 Native 客户端以及 SQLCMD。

当我发出：“SQLCMD -L”时，我看到：

```
Servers:
    ROBSWIN7BOX 
```

但是，当我尝试“SQLCMD -S ROBSWIN7BOX”时，我得到：

```
HResult 0x52E, Level 16, State 1
Named Pipes Provider: Could not open a connection to SQL Server [1326].
Sqlcmd: Error: Microsoft SQL Native Client : An error has occurred while establishing a connection to the server. When connecting to SQL Server 2005, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connection
s..
Sqlcmd: Error: Microsoft SQL Native Client : Login timeout expired. 
```

我还尝试了各种 SQLCMD -S .. -U sa .. -P 和 SQLCMD -S ... -E （SQL Server 配置为混合模式身份验证）。

有任何想法吗？我在看什么？

谢谢！

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:53:48.167

错误 0x52e: (Win32) 0x52e (1326) - 登录失败：未知用户名或密码错误。

您需要 Win auth 才能打开命名管道。确保 SQL 端口已被主机上的防火墙打开，并在您的连接中强制使用 tcp：`SQLCDM -S tcp:ROBSWIN7BOX -U user -P pwd`

# ado.net - F#：如何在参数上声明和使用 ByRef 语义？

> ID：946338
> 
> 赞同：2
> 
> 时间：2009-06-03T18:20:19.360
> 
> 标签：ado.net, f#, pass-by-reference

我正在用输入/输出参数包装一些 SQL 存储过程。这当然意味着我必须做一些丑陋的事情，比如将我的参数声明为引用并使用可变对象。

我将如何在 F# 中执行此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T18:25:39.457

F# 确实有一个[`byref`参数](http://msdn.microsoft.com/en-us/library/dd233213(VS.100).aspx)。这是 MSDN 页面中的一个示例：

```
type Incrementor(z) =
    member this.Increment(i : int byref) =
       i <- i + z 
```

`ref`可变变量也存在（尽管 using和variables之间有一个重要区别`mutable`，两者都可以用于许多相同的目的）。关于这个主题的[MSDN 页面](http://msdn.microsoft.com/en-us/library/dd233186(VS.100).aspx)提供了非常丰富的信息 - 包括关于何时使用哪个关键字/结构的讨论。

参考变量示例：

```
// Declare a reference.
let refVar = ref 6

// Change the value referred to by the reference.
refVar := 50 
```

可变变量示例：

```
// Declare a reference.
let mutable refVar = 6

// Change the value referred to by the reference.
refVar <- 50 
```

如您所见，分配（以及检索）的语法在两种结构之间也有所不同。

# sql-server-2005 - 从触发器中，如何找出谁修改了表 X 上的数据，而该用户从通用 dbuser 登录但从用户表获得了权限

> ID：946345
> 
> 赞同：1
> 
> 时间：2009-06-03T18:21:06.953
> 
> 标签：sql-server-2005

我不确定如何提出这个问题，但是：

1.  你有一个网页

2.  网页在连接字符串的 web.config 中获得了特定用户/密码

3.  在网页上，您要求连接到表格的用户/通行证（id、名称、通行证）

4.  用户通过有效用户/通行证被识别，现在您知道上表中的 id

5.  用户更改了表中的一些数据并且该表得到了触发器

从那个触发器，如何从步骤 4 中检索用户 ID

假设用户使用 asp.net 成员表登录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:33:25.463

使用[`SET CONTEXT_INFO`](http://msdn.microsoft.com/en-us/library/ms187768.aspx)and[`CONTEXT_INFO()`](http://msdn.microsoft.com/en-us/library/ms180125.aspx)传递带外参数。您的 Web 层必须确保在调用数据库之前在它使用的每个连接上正确设置此设置，这意味着额外的数据库往返。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:27:33.820

您需要在根据网页用户/密码更改的表上有一个 LastChgID 列（或类似列），然后 INSERTED.LastChgID 会告诉您。否则，你就不走运了。

**编辑** 保存更改时，将 Web 应用程序用户 ID 存储到表的 LastChgID 列中，这可能需要将其传递到存储过程中，或者只是在 UPDATE 语句中设置该列。当触发器触发时，INSERTED.LastChgID 将具有 Web 应用程序用户 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:31:39.803

在第 4 步中，当您说您知道时，您的真正意思是您的应用程序知道登录的用户 ID。您的应用程序的身份验证与您的数据库身份验证完全分开（可能使用 Windows 身份验证和 SQL Server 除外，但我不要认为那是你正在做的）。

正如 KM 所提到的，您需要通过“LastUpdatedUserID”列或正在更新的表上的一些类似的东西将应用程序用户 ID 传递给触发器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:32:34.967

@KM，或将您的用户移至 AD 并使用集成身份验证。这里没有其他选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T18:36:54.380

由于用户名只是数据，因此很难通过触发器捕获。

选项 #1 类似于 KM 所说的，您的开发人员必须通过查询传递用户名并更新数据库中的审计列。并且触发器会在更新时抓取该列 vlue 并使用它做任何你想做的事情。

选项 #2 将以编程方式在 SQL 服务器或您的 Windows 域结构中创建用户，为其授予对应用程序的访问权限，然后在进入时模拟该用户以进行后续登录。这将是一个管理维护问题，但是应用程序用户将使用他们的唯一 ID 而不是 web.config 中配置的 ID 访问数据库，并且对数据库的所有更新都是该用户而不是 web.config 中提供的通用 ID .

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T18:37:56.687

正如已经建议的那样（Remus Rusanu）使用 SET CONTEXT_INFO 这意味着您不必在所有存储的过程中添加参数来执行此操作。可以在这里找到我自己的一个类似问题：

[SQL Server：修改“应用程序名称”属性以进行审核](https://stackoverflow.com/questions/323494/sql-server-modifying-the-application-name-property-for-auditing-purposes)

# c# - SMTP 错误会是开发人员的错吗？

> ID：946350
> 
> 赞同：0
> 
> 时间：2009-06-03T18:22:03.443
> 
> 标签：c#, asp.net, smtp, windows-server-2003

我收到一条错误消息返回给我，这似乎是 Exchange 设置有问题。有没有可能我做错了什么？我不知道从哪里开始追踪这个：

```
The following recipient(s) cannot be reached:
  Customer Service Account on 6/3/2009 11:00 AM
         There was a SMTP communication problem with the
recipient's email server.  Please
contact your system administrator.
<fgdc.myservername.net #5.5.0 smtp;550 Requested action not taken: mailbox unavailable> 
```

这可能是一个 ServerFault 问题，但我想获得一些关于是否有可能在我的代码中修复它的方法。

站点是 Asp.Net C#，使用 URL 路由

服务器是 2003、64 位并运行 Exchange 2003

**更新**

* * *

原来这是一层垃圾邮件保护。发现这只发生在内部地址和 MIMESweeper 看起来正在丢弃消息。它们来自外部 Web 服务器，但使用内部域发送。旗帜升起。消息不走。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:51:57.780

我的猜测是您指定了错误的用户。特定版本的 Exchange 对用户名/电子邮件非常挑剔。如果您只输入“全名”作为收件人，您将一无所获。您必须与 Exchange 2000 完全匹配并且您还需要一个 X.400 地址才能使其正常工作。

Exchange SMTP 网关有很多问题，我真的无法说出您的问题到底是什么。您最好与邮件管理员交谈，并为该邮箱打开邮件跟踪以找出幕后发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:24:31.910

没有什么可修复的——你唯一能做的就是优雅地恢复并记录错误。唯一要检查的是确保您拥有正确的电子邮件地址，因为错误是`"mailbox unavailable"`.

# asp.net - 将结果从服务器返回到移动客户端的最佳方式

> ID：946357
> 
> 赞同：0
> 
> 时间：2009-06-03T18:24:04.280
> 
> 标签：asp.net, windows-mobile

我正在使用 ASP.NET 创建一个数据库应用程序，并且我想制作一个 Windows Mobile 客户端。它应该是这样的——用户打开 WM 客户端，输入他正在寻找的文本，然后客户端打开类似 Search.aspx?text=MyText 的 URL，然后 WM 客户端说“找到文本”（如果真的找到的话）。这就是问题所在。我不知道将搜索结果返回给客户端的最佳方式是什么。感谢您的任何提示！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T18:36:17.640

我将实现一个由客户端访问的 Web 服务，它将以 xml 格式返回数据。

# php - 用于生成随机强度值的调整算法

> ID：946361
> 
> 赞同：3
> 
> 时间：2009-06-03T18:24:51.330
> 
> 标签：php, algorithm, random, statistics

几天前，[您帮助我找到了一种在在线游戏中生成随机强度值的算法（谢谢，尤其是 John Rasch）](https://stackoverflow.com/questions/921570/generate-random-player-strengths-in-a-pyramid-structure-php)。

```
function getRandomStrength($quality) {
    $rand = mt_rand()/mt_getrandmax();
    $value = round(pow(M_E, ($rand - 1.033) / -0.45), 1);
    return $value;
} 
```

此函数生成介于 1.1 和 9.9 之间的值。现在我想调整这个函数，让它给我相同概率的值，但在另一个区间，例如 1.5 到 8.0。如果您可以通过附加参数来实现这一点，那将是完美的。

如果你能帮助我，那就太好了。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-04T01:43:46.123

原始代码中的值 1.033 和 -0.45 是提供 1.1 - 9.9 比例的幻数。如果您将 1.1 和 9.9 作为参数`$low`并`$high`在以下代码中传递，您应该会得到相同的结果。

```
function getRandomStrength($low, $high) {
    // TODO: validate the input
    $ln_low = log( $low, M_E );
    $ln_high = log( $high, M_E );
    $scale = $ln_high - $ln_low;

    $rand = ( mt_rand() / mt_getrandmax() ) * $scale + $ln_low;
    $value = round( pow( M_E, $rand), 1 );
    return $value;
} 
```

您应该能够在任何范围内传递`$low`并`$high`获得该范围内的对数分布。（我会把范围有效性检查留给你，但 0 < `$low`<`$high`应该是真的。）

这通过反向计算在提供的范围内生成对数刻度所需的线性刻度来工作。例如，如果我希望我的对数比例为 1.1 - 9.9，我将取每个值的自然对数，得到 0.0953 - 2.2925。*然后我在这个线性*范围内生成一个随机数，并提高`e`到随机幂以将其转换回对数范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T18:37:56.420

一种方法是缩放值：

```
function getRandomStrength($quality,$min,$max) {
    $rand = mt_rand()/mt_getrandmax();
    $value = round(pow(M_E, ($rand - 1.033) / -0.45), 1);
    $value = $value - 1.1
    $value = $value * ((max-min) / 8.8)
    $value = $value + $min
    return $value;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:26:23.153

在归一化范围内缩放和置换分布：

```
D(a,b) = (D(0,1)*(b-a))+a 
```

要首先从原始函数 D(c,d) 中得到 D(0,1)，请执行逆操作：

```
D(0,1) = (D(c,d)-c)/(d-c) 
```

在您的情况下，D 是原始函数（指数函数），a 是 1.5，b 是 8.5，c 是 1.1，d 是 9.9

# wsh - wscript.exe 和任务管理器

> ID：946364
> 
> 赞同：0
> 
> 时间：2009-06-03T18:25:20.753
> 
> 标签：wsh, taskmanager

有什么方法可以启动`foobar.js`WSH 脚本，以便标准任务管理器将脚本进程名称显示`foobar.something`为“wscript.exe”而不是“wscript.exe”？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:38:40.930

标准*任务管理器*？从来没听说过。但是，如果您准备改用[`Process Explorer`](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)，选择*命令行*显示列将清楚地显示`foobar.js`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:43:05.427

不会。任务管理器显示实际的进程对象。.js 文件永远不会是进程对象。

由 Windows 脚本宿主管理的 WScript 对象似乎也不会公开应用程序标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:45:32.117

如果您可以在任务管理器中更改与进程关联的名称，我会感到惊讶。但是，如果您的目标是以编程方式识别进程，则可以使用进程 ID (PID)。您可以在任务管理器视图中添加一列来显示此信息，或者您可以使用以下属性从 WSH 中获取已处理生成的 ID：

[http://msdn.microsoft.com/en-us/library/x78640t0(VS.85).aspx](http://msdn.microsoft.com/en-us/library/x78640t0(VS.85).aspx)

# asp.net - IHttpHandler 发布到表单

> ID：946366
> 
> 赞同：0
> 
> 时间：2009-06-03T18:25:41.593
> 
> 标签：asp.net, post, ihttphandler

是否可以从 ASP.NET 中的纯代码发布到表单？基本上我需要模拟一个 Response.Redirect() 但使用 POST 而不是 GET 来模拟，并且还设置了几个请求参数。这一切都发生在 HTTP 处理程序的 ProcessRequest 方法中。

注意：我意识到 Response.Redirect 真的只是将 http 302 项目移动代码扔回浏览器，我猜上述是不可能的，并且有更好的方法来做我所说的使用单独的页面和一个将操作设置为预期目标的表单。如果 HttpContext 有一些我不知道的神秘方法，那就太棒了。

编辑：

好的，所以想出了一个解决方法，基本上是 Response.Write() 从 IHttpHandler 处理一堆 html 和 javascript。然后，它会执行 post 并模拟有一个中间页面来执行 post（但在处理程序中保留尽可能多的代码）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T18:31:32.987

当然。您可以在处理程序中使用 WebRequest 类来执行 POST。从您的处理程序中调用它，您应该没问题。

# javascript - 如何使用 JavaScript 扩展 onchange 事件

> ID：946367
> 
> 赞同：6
> 
> 时间：2009-06-03T18:25:49.223
> 
> 标签：javascript, html, onchange

这是我在扩展元素的 JavaScript onchange 事件时遇到的一个问题。我有几个选择元素，它们有条件地将一个 onchange 事件附加到每个元素（当它们更改为特定值时，它会隐藏/取消隐藏某些元素）。我想有条件地添加或附加到另一个 onchange 事件，以便他们在没有修改或禁用已经附加到它们的前一个函数的情况下进行更改时设置一个全局变量。有没有办法“附加”一个附加功能或在现有功能上添加更多功能？

这是我相信的一个例子：

```
<select id="selectbox1">
    <option>...</option>
    <option>...</option>
</select>

if (<certain conditions>) {
    document.getElementById("selectbox1").onchange = function () { 
        //hides elements to reduce clutter on a web form ...
    }
}
....
if (<other conditions>) {
    document.getElementById("selectbox1").onchange = function2 () {
        //set global variable to false
    }
} 
```

或者，我想简单地将 1-liner“将全局变量设置为 false”添加到原始函数中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T18:27:45.147

您可以通过简单地使用调用其他函数的复合函数来作弊。

```
document.getElementById("selectbox1").onchange = function() {
    function1();
    function2();
} 
```

[*您还可以使用Pro JavaScript Design Patterns*](http://jsdesignpatterns.com/)一书中描述的观察者模式。我在一篇文章（[这里](http://codecube.net/2009/06/mvc-pattern-with-javascript/)）中有一个使用它的例子。

```
//– publisher class — 
function Publisher() { 
    this.subscribers = []; 
};

Publisher.prototype.deliver = function(data) { 
    this.subscribers.forEach(function(fn) { fn(data); }); 
};

//– subscribe method to all existing objects 
Function.prototype.subscribe = function(publisher) { 
    var that = this; 
    var alreadyExists = publisher.subscribers.some(function(el) { 
        if (el === that) { 
            return; 
        } 
    });

    if (!alreadyExists) { 
        publisher.subscribers.push(this); 
    } 
    return this; 
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T18:35:03.620

You want to look at the `addEventListener()` and `attachEvent()` functions (for Mozilla-based browsers and IE respectively).

Take a look at the docs for [addEventListener()](https://developer.mozilla.org/en/DOM/element.addEventListener) and [attachEvent()](http://msdn.microsoft.com/en-us/library/ms536343(VS.85).aspx).

```
var el = document.getElementById("selectbox1");

try { //For IE
    el.attachEvent("onchange", function(){ code here.. });
}
catch(e) { //For FF, Opera, Safari etc
    el.addEventListener("change", function(){ code here.. }, false);
} 
```

You can add multiple listeners to each element, therefore more than one function can be called when the event fires.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:36:48.390

Can you use jQuery? This will allow you to bind/manipulate/unbind events pretty easily. The only hitch is event handlers are activated in the order they are bound.

```
if (<certain conditions>) {
   $("#selectbox1").bind("change", eventdata, function1);
}

if (<other conditions>) {
   $("#selectbox1").bind("change", eventdata, function1);
} 
```

And, you can also look into triggering custom events, if your needs are complex. For example, instead of "interpreting" onChange, maybe there is a way to specifically trigger custom events. See the [last example](http://docs.jquery.com/Events/bind#examples) on jQuery's page.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T18:43:41.730

If you use jQUery you would have something like

```
<select id="selectbox1">
    <option>...</option>
    <option>...</option>
</select>

if (<certain conditions>) {
    $("#selectbox1").change(function () { 
        //hides elements to reduce clutter on a web form ...
    });
}
....
if (<other conditions>) {
    $("#selectbox1").change(function () { 
        //set global variable to false
    });
} 
```

This will mostly take care of browser compatibility as well.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T18:58:53.680

目前有三种不同的方法来定义事件处理程序（检测到某个事件时触发的函数）：传统方法、W3C 方法和 Microsoft 方法。

**传统方法**

在传统方法中，事件处理程序是通过在 Javascript 中设置元素的 on*事件*属性来定义的（就像您在示例代码中所做的那样），或者通过在 HTML 标记中设置 on*事件*属性（例如`<select onchange="...">`）来定义。虽然这是最简单的使用方法，但现在通常不赞成使用它，因为正如您所发现的，它相当死板——向已经附加了事件处理程序的元素添加和删除事件处理程序并不容易。同样，将 javascript 与 HTML 混合不再被认为是正确的做法，而是应该将其包含在标签中或通过`<script>`标签加载。

**W3C/微软方法**

W3C（万维网联盟）和微软都定义了自己的事件模型。这两种模型的工作方式基本相同，但使用不同的语法。微软模型用于Internet Explorer，W3C模型用于其他浏览器（Firefox、Opera、Safari、Chrome等）。在这两个模型中，都提供了添加事件处理程序（W3C 的 addEventListener，Microsoft 的 attachEvent）和删除事件处理程序（removeEventListener / detachEvent）的函数。这允许您动态地向元素添加和删除特定的处理程序；在您的情况下，您可以根据第一个条件添加第一个处理程序，并根据第二个条件添加第二个处理程序。这些方法的“问题”是其中有两个，因此需要使用这两种方法以确保您的事件处理程序将在所有浏览器中注册（两种模型之间也有一些细微的差异，但这些差异对于这个问题的范围并不重要）。事实上，如果你看一下，你会发现大量的“addEvent”函数在必要时使用了这两种方法（并且通常回退到旧浏览器的传统方法）。例如，早在 2005 年，QuirksMode 博客就举办了一场竞赛，以构建最佳的“addEvent”函数，其结果（连同获胜函数）您可以看到 必要时使用这两种方法的函数（并且通常回退到旧浏览器的传统方法）。例如，早在 2005 年，QuirksMode 博客就举办了一场竞赛，以构建最佳的“addEvent”函数，其结果（连同获胜函数）您可以看到 必要时使用这两种方法的函数（并且通常回退到旧浏览器的传统方法）。例如，早在 2005 年，QuirksMode 博客就举办了一场竞赛，以构建最佳的“addEvent”函数，其结果（连同获胜函数）您可以看到[在这里](http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html)。

同样，如果您使用诸如 Prototype 或 jQuery 之类的 javascript 库，它们会附带内置的事件处理函数，这些函数将为您处理上述问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T18:27:55.863

看看`addEventListener`- [https://developer.mozilla.org/en/DOM/element.addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-02T00:42:08.047

我觉得好像我可能遗漏了关于您的问题的一些重要信息，但是这种更简单的解决方案对您不起作用吗？

只需检查onChange 事件**内部的条件并根据需要执行操作。**这比必须动态重新添加/删除 eventListeners 容易**得多**

```
document.getElementById("selectbox1").onchange = function () { 
    if (<certain conditions>) {       
     //hides elements to reduce clutter on a web form ...
    }
    if (<other conditions>) { ... }
} 
```

# eclipse-gef - 一个适用于所有模型视图的 EditPart（在 GMF/GEF 中）

> ID：946368
> 
> 赞同：1
> 
> 时间：2009-06-03T18:26:21.513
> 
> 标签：eclipse-gef, eclipse-gmf

我们正在努力创建一个基于 GMF 框架和工具的建模工具。我们要求允许用户在运行时添加视图（图形）并在他们的图表中使用它们。我们将使用 SVG 文件来表示图形。

在这种情况下，EditParts 和其他 GEF 相关类的正确结构是什么？我们正在考虑实现单个 GEF EditPart 类，该类将基于模型中存在的参数（SVG 文件的路径）创建适当的图形。到目前为止，它似乎没有工作。

必须有人以前已经做过这样的事情。到目前为止，谷歌搜索和 Eclipse 论坛都没有帮助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:39:43.597

好吧，我们找到了一个（部分）解决方案。我们有一个元素，根据参数，我们在其中创建一个子图形，它使用 SVG 文件（基于参数）。

在Figure的构造函数中调用如下测试代码：

> ScalableImageFigure svg; 网址网址；if (type == 1) { url = ArchitectureStudioDiagramEditorPlugin.getInstance().getBundle().getEntry("icons" + IPath.SEPARATOR + "shadow-box.svg"); } else { url = ArchitectureStudioDiagramEditorPlugin.getInstance().getBundle().getEntry("icons" + IPath.SEPARATOR + "star.svg"); } svg = new ScalableImageFigure(RenderedImageFactory.getInstance(url), true, true, true);
> 
> ```
>  this.add(svg); 
> ```

现在我们需要弄清楚如何在 Palette 中拥有多个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-22T09:17:24.013

The correct way is to have one to one mapping between figure and editpart . Also painting task should be left to the figure . How the image should be painted , the logic must be inside the figure not in the editpart.

Thanks

# f# - F#：经典的swap函数怎么写？

> ID：946377
> 
> 赞同：6
> 
> 时间：2009-06-03T18:28:19.717
> 
> 标签：f#, pass-by-reference

在 C# 中，经典的交换函数是：

```
void swap (ref int a, ref int b){
     int temp = a;
     a = b;
     b = temp;
}

int a = 5;
int b = 10;
swap( ref a, ref b); 
```

我将如何用 F# 编写它？

（注意，我不想要功能等价物。我实际上需要通过引用语义传递。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T18:40:48.193

Jared 的代码示例：

```
let mutable (a, b) = (1, 2)

let swap (left : 'a byref) (right : 'a byref) =
  let temp = left
  left <- right
  right <- temp

printfn "a: %i - b: %i" a b
swap (&a) (&b)
printfn "a: %i - b: %i" a b 
```

通常，您会使用`ref-cells`而不是可变的 let's。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T18:31:35.437

尝试以下

```
let swap (left : 'a byref) (right : 'a byref) =
  let temp = left
  left <- right
  right <- temp 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-07T09:15:30.567

/// 交换元组中两个值顺序的函数

```
let Swap (a, b) = (b, a) 
```

# windows - 是否可以将 Cygwin 放在 DVD 上进行离线安装？

> ID：946382
> 
> 赞同：4
> 
> 时间：2009-06-03T18:30:46.170
> 
> 标签：windows, cygwin

关于服务器故障问题*[需要帮助将 Cygwin 放在 DVD 上以进行离线安装](https://serverfault.com/questions/18852/need-help-with-putting-cygwin-on-dvd-for-a-offline-install/18868#18868)*：

* * *

我正在尝试将整个 Cygwin 放在 DVD 上，这样我就可以随身携带它，以便在没有网络连接的计算机上离线安装。我下载`setup.exe`了“下载而不安装”并选择了“*当前版本*”，然后在“*全部*”下选择了“*安装*”。

下载完所有内容后，我将其刻录到 DVD 上。

现在，当我尝试安装该东西时，它会报告一些缺少的依赖项并给出很多“NULL”（我的意思是很多）错误。

我哪里做错了？我假设我正在尝试做的事情（把它放在 DVD 上）可以使用这种技术吗？

* * *

只是要注意。我不是要创建实时 Cygwin 光盘，只是将安装程序放在 DVD 上，以便能够将其安装到硬盘驱动器上。

* * *

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T18:50:35.553

最简单的方法是执行以下操作：

1) 运行 Cygwin setup.exe

2）选择“下载而不安装”

3) 出现提示时，提供“本地包目录” - 这应该不同于您在上一步中指定的根目录。

4）选择你需要的所有包

5）让下载继续

现在您需要将整个本地包目录放在您的 CD 上，包括父目录。因此，如果您将本地包目录设置为 c:\temp\CygPack，请将 CygPack 目录复制到您的 CD 中，而不更改其中的任何内容。然后：

1) 运行 Cygwin setup.exe

2）选择“从本地目录安装”

3）选择包目录（CygPack）

4) 继续安装

最重要的部分是不更改包目录中的任何内容，并选择您在下载期间使用的同一顶级目录。安装程序希望在特定布局中找到目录/文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-22T19:59:37.100

There's now a tool, called "pmcyg", for building a self-contained off-line Cygwin distribution from a user-supplied list of packages. The tool will download all the selected packages, together with any that they depend on and the Cygwin installer program, to create a directory tree that can be directly burned onto a DVD. pmcyg and is available via [SourceForge.net](http://www.sourceforge.net/projects/pmcyg).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:38:48.010

You sure can! First link I found: [Cygwin Offline Install](http://www.cygwin.com/ml/cygwin/2003-09/msg00041.html)

# datetime - 在 GWT 中指定自定义货币、数字和日期时间格式的好方法是什么？

> ID：946383
> 
> 赞同：3
> 
> 时间：2009-06-03T18:30:47.013
> 
> 标签：datetime, gwt, internationalization, currency

我有一个 GWT 项目，我需要在其中手动指定货币、数字和日期时间格式。这些自定义包括指定货币符号、分组分隔符、小数分隔符、负数格式等。实现这一点的最佳方法是什么？

我应该使用 GWT [NumberFormat](http://google-web-toolkit.googlecode.com/svn/javadoc/2.3/com/google/gwt/i18n/client/NumberFormat.html)类吗？NumberFormat 广泛使用 GWT 国际化结构，如[Constants](http://google-web-toolkit.googlecode.com/svn/javadoc/2.3/com/google/gwt/i18n/client/Constants.html)接口等。因此，如果您指定自定义数字格式掩码，它仍将查看当前语言环境并使用那些货币符号、十进制符号和千位分隔符，如后期绑定和国际化的“NumberFormat”实例。

我的问题是：你将如何*做到*这一点？你会重新实现`NumberFormat`'s 的功能吗？您会从它派生并使用受保护的构造函数并将其传递给您自己创建的某种自定义`NumberConstant`实例吗？如何获取 i18n NumberConstants 实例，并使用它来填充您自己的实例并仅覆盖您想要的内容？

你会如何处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-27T17:28:56.767

我已将 NumberFormat.getFormat(String format) 用于自定义货币格式（在 $ 符号之前删除“US”）。

在我的应用程序中，我将结果放入公共常量中。我已将“格式”参数存储在 i18n 资源包以及所有 UI 特定字符串中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-08T16:14:42.437

```
公共类 MyNumberFormat 扩展 NumberFormat{

    私有静态 CurrencyCodeMapConstants currencyCodeMapConstants = GWT.create(CurrencyCodeMapConstants.class);

    protected MyNumberFormat（字符串模式，CurrencyData cdata，
            布尔用户供应模式）{
        超级（模式，cdata，userSuppliedPattern）；     
    }

    公共静态 NumberFormat getCurrencyFormat(String currencyCode) {     
        返回新的 MyNumberFormat(defaultNumberConstants.currencyPattern(),
            查找货币（货币代码），假）；
      }

      私人静态货币数据查找货币（字符串货币代码）{
        CurrencyData currencyData = CurrencyList.get().lookup(currencyCode);

        映射currencyMap = currencyCodeMapConstants.currencyMap();       

        字符串代码 = currencyData.getCurrencyCode();
        //字符串符号 = currencyData.getCurrencySymbol();
        字符串符号 = currencyMap.get(currencyCode);
        int fractionDigits = currencyData.getDefaultFractionDigits();
        字符串portableSymbol = currencyData.getPortableCurrencySymbol();       

        返回到CurrencyData（代码，符号，fractionDigits，portableSymbol）；
      }

      public static native CurrencyData toCurrencyData(String code, String symbol, int fractionDigits, StringportableSymbol) /*-{
        返回[代码，符号，fractionDigits，portableSymbol]；
      }-*/;
}

```

我可以在 GXT 网格中使用

```
        column = new ColumnConfig("precioventa", constants.modeloPrendaPrecioVenta(), 100);
        column.setAlignment(Horizo​​ntalAlignment.RIGHT);        
        column.setNumberFormat(MyNumberFormat.getCurrencyFormat("PEN"));        
        列。添加（列）；

```

# grails - Groovy 中的编译时检查

> ID：946396
> 
> 赞同：4
> 
> 时间：2009-06-03T18:33:58.053
> 
> 标签：grails, types

在 Groovy 中，类型是可选的，因此您可以使用：

```
String foo = "foo"
foo.noSuchMethod() 
```

或者

```
def foo = "foo"
foo.noSuchMethod() 
```

我假设第一个示例会生成编译时错误，而第二个示例只会在运行时失败。但是，情况似乎并非如此。根据我的经验，在这两种情况下都不会生成编译时错误。

我是否正确地假设声明引用类型的唯一好处是作为一种文档形式，即与其他程序员交流意图。例如，如果我编写一个方法，例如：

```
def capitalize(String arg) {
    return arg.toUpperCase()
} 
```

这比以下方式更有效地传达了应该传递给函数的参数类型：

```
def capitalize(def arg) {
    return arg.toUpperCase()
} 
```

当指定类型时，Groovy 编译器是否执行任何类型检查？

谢谢，唐

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T15:28:05.513

[编辑]*较新版本的 Groovy 确实允许编译时静态类型检查。使用此注释的代码比常规运行时 Groovy 更快，因为跳过了许多动态检查。*

正如 Cesar 所说，类型检查是一个运行时过程，这是 Groovy 比 Java 慢的主要原因之一（并不是说这很糟糕）。

你可以看到这是为什么，对吧？鉴于 Groovy 的动态特性，几乎不可能判断 String 是否已在代码中的其他地方扩展为包含方法 noSuchMethod()。成员类型检查也是如此，因为完全有可能删除一种类型的成员，然后在代码中添加具有**相同名称的另一种类型的成员。**这可能不常见，但很有可能。

问题是，你真正需要多少类型检查？您正在调用该方法，您真的应该知道它需要什么参数，或者该方法是否确实存在。使用编译时检查来节省查找时间并不是编译器的核心用处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T21:31:43.670

在 Groovy 中，类型检查是在运行时动态完成的。具有类型的变量的好处是您可以确保它包含您期望它们具有的值，否则您会得到一个运行时异常，您可以捕获并执行您需要做的任何事情来处理异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-05T20:42:16.017

*对于类型*，Groovy 中的编译时间检查几乎是不可能的。你的例子

```
String foo = "foo"
foo.noSuchMethod() 
```

考虑到以前的指令是按照以下方式执行的，它会很好地工作

```
String.metaClass.noSuchMethod { -> println "Yes there is such a method"} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-17T18:10:40.157

您可能指定类型的一个原因是允许 IDE 帮助您。

```
def foo
foo.[ctrl-space] 
```

……对你帮助不大

```
List foo
foo.[ctrl-space] 
```

... 可能（取决于 IDE）让您选择 List 的方法。当然，由于其他答案中给出的原因，一种不是选择之一的方法可能是一种有效的方法。

还有其他自动化软件维护操作可以从有关类型的线索中受益。例如，重构。

# css - 在每个列表项之后插入图像

> ID：946403
> 
> 赞同：161
> 
> 时间：2009-06-03T18:36:21.510
> 
> 标签：css

在每个列表元素之后插入小图像的最佳方法是什么？我用伪类尝试过，但有些不对劲......

```
ul li a:after {
  display: block;
  width: 3px;
  height: 5px;
  background: url ('../images/small_triangle.png') transparent no-repeat;
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2009-06-03T18:46:40.383

更简单的方法是：

```
ul li:after {
    content: url('../images/small_triangle.png');
} 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-06-03T18:43:21.777

试试这个：

```
ul li a:after {
    display: block;
    content: "";
    width: 3px;
    height: 5px;
    background: transparent url('../images/small_triangle.png') no-repeat;
} 
```

您需要`content: "";`声明以提供生成的元素内容，即使该内容是“无”。

`background`此外，我修复了您的声明的语法/顺序。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-06T16:23:08.640

对于 IE8 支持，“content”属性不能为空。

为了解决这个问题，我做了以下事情：

```
.ul li:after {
    content:"icon";
    text-indent:-999em;
    display:block;
    width:32px;
    height:32px;
    background:url(../img/icons/spritesheet.png) 0 -620px no-repeat;
    margin:5% 0 0 45%;
} 
```

注意：这也适用于图像精灵

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T18:48:01.847

我认为您的问题是 :after 伪元素需要 content: 在其中设置的属性。你需要告诉它插入一些东西。你甚至可以让它直接插入图像：

```
ul li:after {
    content: url('../images/small_triangle.png');
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-26T02:59:11.423

```
ul li + li:before
{
    content:url(imgs/separator.gif);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-07-12T02:12:06.963

我这样做的解决方案：

```
li span.show::after{
  content: url("/sites/default/files/new5.gif");
  padding-left: 5px;
} 
```

# functional-programming - 如何加载库以支持 R5RS 语言 (DrScheme) 中的哈希表？

> ID：946409
> 
> 赞同：2
> 
> 时间：2009-06-03T18:37:30.493
> 
> 标签：functional-programming, scheme, racket

看起来 DrScheme 中的 R5RS 语言没有附带哈希表库。

当我运行（make-hash-table）时，它会抛出一个错误......

Pretty Big 支持哈希表，但不支持可变对。

所以我坚持让其中一个为我工作..

如何在 R5RS 中添加对哈希表的支持？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:02:37.493

我也不确定如何执行此操作，但找到了如何在 r5rs 中导入模块：

```
(#%require scheme) 
```

然后...

```
(define h (make-hash)) 
```

ETC...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T18:54:14.587

如果您不关心使用什么“语言”，您可能只使用 R6RS。以下是如何在 R6RS 中获得您想要的内容：

```
#!r6rs

(import (rnrs)
        (rnrs mutable-pairs))

(define foo (make-eqv-hashtable))

(define bar (list 'a 'b))

(write bar) (newline)

(set-car! bar 'Z)

(write bar) 
```

# php - 如何检查用户是否在PHP中上传了文件？

> ID：946418
> 
> 赞同：62
> 
> 时间：2009-06-03T18:38:53.347
> 
> 标签：php

我做了一些表单验证，以确保用户上传的文件类型正确。但是上传是可选的，所以如果他没有上传任何东西并提交了表单的其余部分，我想跳过验证。我怎样才能检查他是否上传了一些东西？会`$_FILES['myflie']['size'] <=0`工作吗？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-06-03T18:42:04.837

您可以使用[`is_uploaded_file()`](http://php.net/manual/en/function.is-uploaded-file.php)：

```
if(!file_exists($_FILES['myfile']['tmp_name']) || !is_uploaded_file($_FILES['myfile']['tmp_name'])) {
    echo 'No upload';
} 
```

从文档：

> 如果 filename 命名的文件是通过 HTTP POST 上传的，则返回 TRUE。这有助于确保恶意用户没有试图欺骗脚本来处理它不应该在其上工作的文件——例如，/etc/passwd。
> 
> 如果对上传文件所做的任何操作都可能向用户甚至同一系统上的其他用户泄露其内容，则这种检查尤其重要。

编辑：我在我的 FileUpload 类中使用它，以防它有帮助：

```
public function fileUploaded()
{
    if(empty($_FILES)) {
        return false;       
    } 
    $this->file = $_FILES[$this->formField];
    if(!file_exists($this->file['tmp_name']) || !is_uploaded_file($this->file['tmp_name'])){
        $this->errors['FileNotExists'] = true;
        return false;
    }   
    return true;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-07-14T16:24:45.120

这段代码对我有用。我正在使用多个文件上传，所以我需要检查是否有任何上传。

HTML部分：

```
<input name="files[]" type="file" multiple="multiple" /> 
```

PHP部分：

```
if(isset($_FILES['files']) ){  

foreach($_FILES['files']['tmp_name'] as $key => $tmp_name ){

      if(!empty($_FILES['files']['tmp_name'][$key])){

    //  things you want to do
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-18T19:58:37.387

@karim79 有正确的答案，但我不得不重写他的例子以适应我的目的。他的示例假定提交字段的名称是已知的并且可以硬编码。我更进一步并创建了一个函数，它可以告诉我是否上传了任何文件，而无需知道上传字段的名称。

```
/**
 * Tests all upload fields to determine whether any files were submitted.
 * 
 * @return boolean
 */
function files_uploaded() {

    // bail if there were no upload forms
   if(empty($_FILES))
        return false;

    // check for uploaded files
    $files = $_FILES['files']['tmp_name'];
    foreach( $files as $field_title => $temp_name ){
        if( !empty($temp_name) && is_uploaded_file( $temp_name )){
            // found one!
            return true;
        }
    }   
    // return false if no files were found
   return false;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-22T13:06:25.757

```
<!DOCTYPE html>
<html>
<body>

<form action="#" method="post" enctype="multipart/form-data">
    Select image to upload:
    <input name="my_files[]" type="file" multiple="multiple" />
    <input type="submit" value="Upload Image" name="submit">
</form>

<?php

 if (isset($_FILES['my_files']))
  {
    $myFile = $_FILES['my_files'];
    $fileCount = count($myFile["name"]);

        for ($i = 0; $i <$fileCount; $i++)
         {
           $error = $myFile["error"][$i]; 

            if ($error == '4')  // error 4 is for "no file selected"
             {
               echo "no file selected";
             }
            else
             {

               $name =  $myFile["name"][$i];
               echo $name; 
               echo "<br>"; 
               $temporary_file = $myFile["tmp_name"][$i];
               echo $temporary_file;
               echo "<br>";
               $type = $myFile["type"][$i];
               echo $type;
               echo "<br>";
               $size = $myFile["size"][$i];
               echo $size;
               echo "<br>";

               $target_path = "uploads/$name";   //first make a folder named "uploads" where you will upload files

                 if(move_uploaded_file($temporary_file,$target_path))
                  {
                   echo " uploaded";
                   echo "<br>";
                   echo "<br>";
                  }
                   else
                  {
                   echo "no upload ";
                  }

              }
        }  
}
        ?>

</body>
</html> 
```

但要警惕。用户可以上传任何类型的文件，也可以通过上传恶意或 php 文件来入侵您的服务器或系统。在这个脚本中应该有一些验证。谢谢你。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-16T12:17:11.077

你应该使用`$_FILES[$form_name]['error']`. `UPLOAD_ERR_NO_FILE`如果没有上传文件，则返回。完整列表：[PHP：错误消息解释](http://php.net/manual/en/features.file-upload.errors.php)

```
function isUploadOkay($form_name, &$error_message) {
    if (!isset($_FILES[$form_name])) {
        $error_message = "No file upload with name '$form_name' in form.";
        return false;
    }
    $error = $_FILES[$form_name]['error'];

    // List at: http://php.net/manual/en/features.file-upload.errors.php
    if ($error != UPLOAD_ERR_OK) {
        switch ($error) {
            case UPLOAD_ERR_INI_SIZE:
                $error_message = 'The uploaded file exceeds the upload_max_filesize directive in php.ini.';
                break;

            case UPLOAD_ERR_FORM_SIZE:
                $error_message = 'The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form.';
                break;

            case UPLOAD_ERR_PARTIAL:
                $error_message = 'The uploaded file was only partially uploaded.';
                break;

            case UPLOAD_ERR_NO_FILE:
                $error_message = 'No file was uploaded.';
                break;

            case UPLOAD_ERR_NO_TMP_DIR:
                $error_message = 'Missing a temporary folder.';
                break;

            case UPLOAD_ERR_CANT_WRITE:
                $error_message = 'Failed to write file to disk.';
                break;

            case UPLOAD_ERR_EXTENSION:
                $error_message = 'A PHP extension interrupted the upload.';
                break;

            default:
                $error_message = 'Unknown error';
            break;
        }
        return false;
    }

    $error_message = null;
    return true;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-31T05:28:36.470

我检查了你的代码，认为你应该试试这个：

```
if(!file_exists($_FILES['fileupload']['tmp_name']) || !is_uploaded_file($_FILES['fileupload']['tmp_name'])) 
    {
        echo 'No upload';
    }   
    else
        echo 'upload'; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-13T06:54:22.370

`is_uploaded_file()`非常好用，特别是用于检查它是上传文件还是本地文件（出于安全目的）。

但是，如果要检查用户是否上传了文件，请使用`$_FILES['file']['error'] == UPLOAD_ERR_OK`.

请参阅有关[文件上传错误消息](http://php.net/manual/en/features.file-upload.errors.php)的 PHP 手册。如果您只想检查没有文件，请使用`UPLOAD_ERR_NO_FILE`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-02T08:27:46.777

一般来说，当用户上传文件时，PHP服务器没有捕捉到任何异常错误或错误，就表示文件上传成功。 [https://www.php.net/manual/en/reserved.variables.files.php#109648](https://www.php.net/manual/en/reserved.variables.files.php#109648)

```
if ( boolval( $_FILES['image']['error'] === 0 ) ) {
    // ...
} 
```

# c# - 允许访问权限写入 Windows 7 的程序文件

> ID：946420
> 
> 赞同：56
> 
> 时间：2009-06-03T18:40:09.567
> 
> 标签：c#

在可执行文件所在的安装目录中写入临时文件时，我的应用程序会抛出“拒绝访问”错误。但是它在 Windows XP 中运行良好。如何在 Windows 7 中提供对 Program Files 目录的访问权限？

编辑：如何让程序要求用户提升权限？（即以完全管理员权限运行程序）

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-06-03T18:45:31.447

您的程序不应将临时文件（或其他任何内容）写入程序目录。任何程序都应将 %TEMP% 用于临时文件，将 %APPDATA% 用于用户特定的应用程序数据。从 Windows 2000/XP 开始就是这样，所以你应该改变你的应用程序。

问题不在于 Windows 7。

您可以询问 appdata 文件夹路径：

```
string dir = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); 
```

或对于 TEMP 路径

```
string dir = Path.GetTempPath() 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-03T18:42:49.720

您的程序必须以管理权限运行。您不能使用代码自动执行此操作，但您可以请求用户（在代码中）在程序运行时提升程序的权限。有一个关于如何执行此操作的[wiki 。](http://en.wikipedia.org/wiki/User_Account_Control#Requesting_elevation)或者，任何程序都可以通过右键单击其图标并单击“以管理员身份运行”来以管理员身份运行。

但是，我不建议这样做。最好使用这样的东西：

```
Environment.GetFolderPath(SpecialFolder.ApplicationData); 
```

获取 AppData 文件夹路径并在那里为您的应用创建一个文件夹。然后把临时文件放在那里。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-03T18:45:52.007

我能想到的选项：

*   以完全管理员权限运行整个应用程序。使用 UAC
*   仅针对需要访问的内容以完全管理员身份运行子流程
*   **在别处写临时文件**

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-04-06T17:55:43.007

在项目中添加新项目：Application Manifest 并保存。

现在打开此文件并查找`<requestExecutionLevel>`. 它必须设置为`asInvoker`。

将其更改为`highestAvailable`. 现在在执行您的应用程序时，将出现一个提示，要求您获得许可。点击`yes`！

就是这样 :) 现在您可以从 system32 或任何其他需要管理员权限的文件中读写

您可以通过[sigcheck](https://technet.microsoft.com/en-us/sysinternals/bb897441.aspx)验证您的应用程序。

```
sigcheck.exe -m yourapp.exe 
```

并在输出中检查元素 requestedExecutionLevel。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-03T18:51:37.330

您不能使 .Net 应用程序提升其自身的权利。根本不允许。您可以做的最好的事情是在生成另一个进程时指定提升的权限。在这种情况下，您将有一个两阶段的应用程序启动。

第 1 阶段除了使用 System.Diagnostics.ProcessStartInfo 对象和 Start() 调用准备提升的生成之外什么都不做。

第 2 阶段是在提升状态下运行的应用程序。

但是，如上所述，您很少想要这样做。而且您当然不想这样做只是为了将临时文件写入 %programfiles%。仅当您需要执行服务启动/停止等管理操作时才使用此方法。将临时文件写入更好的位置，如此处的其他答案所示。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-04-26T00:35:48.060

另一种方法是停止 UAC 然后重新启动它。使用以下代码创建一个 CMD 文件；

Rem Stop UAC %windir%\System32\reg.exe ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f rem force reboot Start ShutDown /R /F /T 30

您需要右键单击 CMD 文件并使用以管理员身份运行。一旦你完成了你正在做的事情，使用以下代码重新启动 UAC（这次不需要使用以管理员身份运行）；

%windir%\System32\reg.exe 添加 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 1 /f

rem force reboot 启动 关机 /R /F /T 30

使用此方法的缺点是必须右键单击并使用以管理员身份运行来关闭 UAC，并且您必须重新启动才能使其生效。

顺便说一句，您需要写入禁止区域的原因有几个......首先想到的两个原因是运行一个批处理文件来附加主机以防止您的浏览器进入狡猾的站点或复制许可证密钥静默安装。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-02-18T15:19:34.277

我不同意这样的论点，最好将所有文件写入其他目录，例如，%APPDATA%，只是你不能避免它，如果你想避免在 Windows 7 上以管理员身份运行应用程序。

将所有应用程序特定数据（例如 ini 文件）保存在与应用程序相同的文件夹（或子文件夹）中会更干净，以加速整个磁盘上的数据（%APPDATA%、注册表以及谁知道其他位置） . 这只是微软干净编程的想法。当然，您需要注册表清理器、磁盘清理器、临时文件清理器……而不是非常干净的做法 - 删除应用程序文件夹会删除所有应用程序特定数据（例如用户数据，通常在我的文档中的某处左右） .

在我的程序中，我希望在应用程序目录中有 ini 文件，但是，我没有它们，只是因为我不能在那里（在 Windows 上）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-20T08:46:09.153

我认为所有这些问题都有一个替代解决方案......制作一个两级应用程序。如上所述...

1）启动器，它将使用（VB）等代码启动另一个主应用程序

```
Call ShellExecute(hwnd, "runas", App.Path & "\MainApp.exe", 0, 0, vbNormalFocus) 
```

2) 主应用程序，正在写入受保护区域，即 Program Files 文件夹

我已经在 Windows 7 上成功尝试过

我还在开发一个具有在线更新功能的应用程序。但它在 Vista/W7 中不起作用..

我同意其他人关于 Microsoft 政策和标准实践的看法。

**但我的问题是.. 1）如何将更新应用于现有应用程序，该应用程序可能始终保留在 Program Files 文件夹中。2) 可能有一些方法可以做到这一点，否则 goolge 更新程序、防病毒更新程序或任何软件更新程序如何工作？**

> 我需要回答我的问题..... :o

Rajendra Khope 教授（麻省理工学院，印度浦那）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-01T13:49:08.580

如果您有这样的程序，只需将其安装在 中`C:\`，而不是在 Program Files 中。我在安装 Android SDK 时遇到了很多问题。我的问题通过安装在`C:\`.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-08-25T14:59:43.000

而 M$“最佳实践”是不将数据写入 %programfiles% 文件夹；我有时会。我认为将临时文件写入这样的文件夹是不明智的；因为 TEMP 环境变量可能指向一个好的、快速的 RAM 驱动器。

但是，我不喜欢将数据写入 %APPDATA% 。如果 Windows 变得如此糟糕以至于需要擦除它并完全重新安装，也许到另一个驱动器，您可能会丢失几乎所有程序的所有设置。我知道。我已经做过很多次了。如果它存储在 %programfiles% 中，1) 如果我必须在另一个驱动器上重新安装 Windows，它不会丢失，因为用户可以简单地从其目录运行该程序，2) 它使其可移植，并且3) 将程序及其数据文件保存在一起。

通过让我的安装程序 Inno Setup 为我的 INI 文件创建一个空文件，并在 [Files] 部分中为其提供 users-modify 设置，我获得了写入权限。我现在可以随意写了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-12-17T07:28:33.157

我一直在寻找答案。我只找到了一个。

这些都不适合我。我不想写临时文件，除非它被定义为非系统文件。尽管我在我的用户配置文件中被指定为管理员，并且在 UAC 中显示了完整的管理员权限，但我无法写入程序文件或窗口。这很烦人。

我尝试将在线找到的图像直接保存到 windows/web/wallpaper 文件夹，但它不会让我这样做。相反，我必须将它保存到我的桌面（我拒绝导航到“我的文档/图片/等”，因为我拒绝使用此类文件夹，我有自己的目录树，谢谢）然后，从桌面剪切并粘贴它到 windows/web/wallpaper 文件夹。你是在告诉我我应该这样做并微笑吗？作为管理员用户，我应该能够直接保存到其目标文件夹。我在驱动器属性/安全和目录属性/安全中的权限说我可以写，但我不能。不要程序文件、程序文件（86）和窗口。

如何将我刚刚为游戏修改的文件保存在 Program Files (86)（游戏名称）文件夹中。它不会让我。我打开文件进行修改，如果不先将其保存到桌面等，或者首先以管理员身份打开用于修改文件的程序，则无法保存它，这意味着首先导航到另一个我存储这些用户 mod 程序的目录树的一部分，然后在程序中选择打开文件并再次导航到我本来可以从我的项目文件夹中首先单击修改的文件，却发现这赢了也不行！它保存文件，但找不到该文件。它在那里，但看不见。唯一的解决方案是如上所述保存到桌面。

作为管理员用户，我不应该做这一切。但是，如果我使用真正的管理员帐户，一切正常。但我不想使用真正的管理员帐户。我想使用具有管理员权限的用户帐户。它说我有管理员权限，但我没有。

最后，我拒绝将我的便携式设备存储在 %appdata% 中。这不是我希望浏览我的目录树的方式。我用作便携式设备的个人安装存储在我作为导航首选项创建的目录中。

所以，这是我找到的经过验证的真实答案：

从我目前所见......除非使用真正的管理员帐户，否则在 Windows Vista 和 Windows 7 操作系统中具有管理员权限的任何其他用户都无法真正获得这些权限。虽然在 Windows XP 中设置管理员权限很简单，但后来的版本已经为所有人取消了这个设置，除了那些可以轻松破解的人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-07-20T14:42:55.860

我正在开发一个将其数据正确保存到 %APPDATA% 的程序，但有时，系统范围的设置会影响所有用户。所以在这些情况下，它必须写入程序安装目录。

据我现在所读，暂时无法获得对一个目录的写访问权。您只能以管理员身份运行整个应用程序（这应该是不可能的）或者无法保存该文件。（全有或全无）

我想，我只是将文件写入 %APPDATA% 并启动一个将文件复制到安装文件夹中的外部程序，并且该程序需要管理员权限......愚蠢的想法，但似乎是唯一实用的解决方案......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-12-03T07:19:11.310

您可以为要在其中写入或重写的网站或 Web 应用程序的文件夹添加**对 IIS 用户的访问权限。**

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2011-02-16T15:47:14.397

创建一个名为“c:\programs writable\”的文件夹并将您的应用程序放在该文件夹下会更整洁。这样可以避免低 c 文件夹的丛林。

潜在的权衡是安全性与易用性。如果您知道自己在做什么，那么您想在自己的电脑上成为上帝。如果您必须为当地的无政府社会维护健康的系统，您可能需要增加一些安全性。

# testing - 基于 Web 的项目的自动测试

> ID：946426
> 
> 赞同：8
> 
> 时间：2009-06-03T18:40:59.940
> 
> 标签：testing, automated-tests

最近我提出了一个问题，花开发时间为基于 Web 的项目生成自动单元测试是否值得？我的意思是它在某些时候似乎没有用，因为在某些时候这些项目是面向与用户/客户的交互的，所以你无法预测整个可能的用户操作集，所以你可以检查显示的内容的正确性。即使是回归测试也几乎无法完成。
所以我很想知道其他有经验的开发者的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T18:52:48.030

Selenium 有一个很好的 web 测试框架

[http://seleniumhq.org/](http://seleniumhq.org/)

Telerik 也在开发一款用于 Web 应用测试的产品。

[http://www.telerik.com/products/web-ui-test-studio.aspx](http://www.telerik.com/products/web-ui-test-studio.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:45:42.100

是的。本周我刚刚在我正在开发的网站上遇到了一个问题。我最近刚刚关闭了数据访问层并为我的控制器和存储库设置了单元测试，但没有设置 UI 交互。

我被一个非常明显的错误所困扰，如果我进行了集成测试，这个错误很容易被发现。只有通过集成测试和 UI 功能测试，您才能发现应用程序不同层之间的交互方式存在问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T18:54:51.427

如果您正在编写大量 Javascript，那么最近出现了很多 JS 测试框架来对您的 Javascript 进行单元测试。

除此之外，使用 Canoo、HtmlUnit、Selenium 等工具测试 Web 层更像是功能测试或集成测试，而不是单元测试。如果您对 UI 进行了很多更改，这些可能很难维护，但它们确实可以派上用场。记录 Selenium 测试很容易，您可能可以让其他人（测试人员）帮助您创建和维护。只要知道维护测试是有成本的，它需要被平衡。

还有其他类型的测试非常适合 Web 层——尤其是模糊测试，但很多好的选择都是商业工具。一种开源并插入 Rails 的软件称为 Tarantula。在 Web 层拥有类似的东西在持续集成过程中运行是一件好事，并且不需要太多的维护形式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T19:00:45.267

这实际上取决于您的 Web 应用程序的结构和体系结构。如果它包含一个应用程序逻辑层，那么该层应该很容易使用 Visual Studio 等自动化工具进行单元测试。此外，使用旨在支持单元测试的框架（例如 ASP.NET MVC）也有很大帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-07T09:06:08.123

> 您无法预测整个可能的用户操作集，因此您可以检查所显示内容的正确性。

您无法预期您的代码将要提交的所有可能数据，或所有可能的竞争条件（如果它是线程化的），但您仍然需要进行单元测试。为什么？因为你可以把它缩小很多。你可以预料会发生的各种病态的事情。您只需要考虑一下并获得一些经验即可。

用户交互也不例外。用户会尝试做某些事情，无论是否病态，你可以预料到它们。用户只是在输入特别有想象力的数据。你会发现程序员往往会一遍又一遍地错过相同的条件。我保留了一份清单。例如：将 Unicode 泵入一切；将开始日期放在结束日期之后；输入乱码数据；把标签放在所有东西上；去掉尾随的换行符；尝试两次输入相同的数据；提交表单，返回并再次提交；获取一个文本文件，将其命名为 foo.jpg 并尝试将其作为图片上传。你甚至可以编写一个程序来随意翻转开关和按钮，一只坏猴子，它会发现各种有趣的错误。

它通常就像让不熟悉该软件的人坐下来观看他们使用它一样简单。克服纠正他们的冲动，只是看着他们挣扎。它非常有教育意义。Steve Krug 将此称为[“高级常识”](http://www.sensible.com/)，并有一本名为“不要让我思考”的优秀书籍，其中涵盖了廉价、简单的用户交互测试。我强烈推荐它。这是一个非常简短和令人大开眼界的阅读。

最后，客户本身，如果他们的期望得到适当的准备，可以成为一个很棒的测试套件。确保他们了解这是一项正在进行的工作，它会有错误，他们正在帮助他们的产品变得更好，并且绝对不应该将它用于生产数据，并让他们修补预发布版本你的产品。他们会做你从未想过的各种事情！它们将是您曾经拥有的最好、最真实的测试，而且是免费的！为他们提供一种非常简单的错误报告方式，最好是应用程序上的一个按钮框，它会自动提交他们的环境和历史记录；[Hiveminder](http://hiveminder.com)上的反馈框是一个很好的例子。快速而礼貌地响应他们的错误（即使只是“感谢您提供信息”），您会发现他们会很高兴您对他们的需求如此敏感！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-04T05:32:21.103

单元测试在 TDD 过程中很有意义。如果您不进行测试优先开发，它们就没有多大价值。然而，验收测试对于软件的质量来说是一件大事。我想说验收测试是开发的圣杯。验收测试显示应用程序是否满足要求。我如何知道何时停止开发该功能 --- 只有当我的所有验收测试都通过时。验收测试自动化是一件大事，因为我不必每次更改应用程序时都手动完成。经过几个月的开发，可能会有数百个测试，并且手动运行所有测试变得不可行（有时是不可能的）。那我怎么知道我的应用程序是否仍然有效？

验收测试的自动化可以通过使用 xUnit 测试框架来实现，这在这里造成了混乱。如果我使用 phpUnit 或 httpUnit 创建验收测试，它是单元测试吗？我的回答是否定的。我使用什么工具来创建和运行测试并不重要。验收测试是显示功能是否符合 IAW 要求的测试。单元测试显示一个类（或函数）是否满足开发者的实现思路。单元测试对客户端（用户）没有价值。验收测试对客户有很大的价值（因此对开发人员来说，请记住[客户亲和力](http://martinfowler.com/bliki/CustomerAffinity.html)）

因此，我**强烈建议**为 Web 应用程序创建自动化验收测试。

验收测试的良好框架是：

*   萨希 (sahi.co.in)
*   硅
*   Simpletest（我不是 php 的单元测试框架，但包含可用于验收测试的浏览器对象）。

**然而**

您提到网站完全是关于用户交互的，因此测试自动化不会解决可用性的整个问题。例如：测试框架显示所有测试都通过了，但是用户看不到表单或链接或其他页面元素`style="display:none"`，因为`div`. 自动化测试通过，因为`div`它存在于文档中并且测试框架可以“看到”它。但是用户不能。手动测试会失败。

因此，所有 Web 应用程序都需要手动测试。自动化测试可以大大减少测试工作量 (80%)，但手动测试对于生成的软件的质量同样重要。

至于单元测试和 TDD——它使代码质量。这对开发人员和项目的未来都是有益的（即对于超过几个月的项目）。然而，TDD 需要技巧。如果你有技能——使用它。如果您不考虑获得技能，但要注意获得所需的时间。开始创建好的单元测试和代码通常需要大约 3 - 6 个月。如果您的项目将持续一年以上，我建议您学习 TDD 并在适当的开发环境中投入时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-21T14:12:14.293

我创建了一个网络测试解决方案（docker + cucumber）；它非常基础和简单，易于理解和修改/改进。它位于 web 目录中；

我的解决方案：[https ://github.com/gyulaweber/hosting_tests](https://github.com/gyulaweber/hosting_tests)

# c# - 在 .NET windows 应用程序中存储用户设置的首选方法是什么？

> ID：946431
> 
> 赞同：4
> 
> 时间：2009-06-03T18:41:43.107
> 
> 标签：c#, .net, winforms

请原谅我的无知，但我从未真正开发过 Windows 应用程序。您如何存储用户设置？嵌入式数据库是首选方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T18:43:36.550

我认为您正在寻找[用户设置](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)：

> .NET Framework 2.0 允许您创建和访问在应用程序执行会话之间持久存在的值。这些值称为设置。设置可以代表用户偏好或应用程序需要使用的有价值的信息。例如，您可以创建一系列设置来存储用户对应用程序配色方案的偏好。或者，您可以存储指定应用程序使用的数据库的连接字符串。设置允许您在代码之外保留对应用程序至关重要的信息，并创建存储个人用户偏好的配置文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:46:31.350

这取决于什么样的设置。从嵌入式数据库（如 SQLite）到 XML 文件，再到注册表，有多种方法。

*   如果设置很少，注册表通常是有意义的。
*   如果设置比较复杂，需要手动编辑，可以使用 XML 文件或 JSON。
*   如果设置很复杂并且不需要手动编辑，那么像 SQLite、.NetBtree 或 BerkelyDB .NET 这样的嵌入式数据库是不错的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T19:50:28.583

这完全取决于您正在构建的应用程序的大小。如果您在做一些简单的事情，比如“家庭购物清单”，您可以将设置存储在一个好的旧纯文本文件中。

如果您正在构建更大的东西，例如“同学通知器”，您可以使用 XML 文件或某种其他资源。

对于任何更大的应用程序，您应该使用某种关系数据库来存储用户数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-13T19:07:35.323

使用 Blane 的 Pegasus 库 ( [http://pegasus.codeplex.com/](http://pegasus.codeplex.com/) )。

您可以使用他的 XmlSerializationHelper 类，它可以轻松地将对象转换为 XML，反之亦然。

或者您可以使用独立存储（如果我不是新用户并且每个帖子限制为一个超链接，我会提供指向 MSDN 的链接）。如果你使用了IsolatedStorage，考虑使用Blane 的IsolatedStorageHashtable 类。

# oracle - Oracle 计算涉及另一个计算的结果

> ID：946438
> 
> 赞同：3
> 
> 时间：2009-06-03T18:43:26.817
> 
> 标签：oracle, oracle10g

首先，尽管我对 SQL 非常熟悉，但我完全是 Oracle 菜鸟。我有一个成本列。我需要计算总成本，总成本的百分比，然后是百分比的运行总和。我在百分比的运行总和方面遇到了麻烦，因为我能想到的唯一方法是使用嵌套的 SUM 函数，这是不允许的。

这是有效的：

```
SELECT cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per
FROM my_table
ORDER BY cost DESC 
```

这是我正在尝试做的不起作用的事情：

```
SELECT cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per,
       SUM(cost/SUM(cost) OVER()) OVER(cost) AS per_sum
FROM my_table
ORDER BY cost DESC 
```

我只是做错了，还是我试图做的事情是不可能的？顺便说一句，我使用的是 Oracle 10g。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T20:19:15.657

您不需要在该内联视图中进行排序，特别是因为外部选择正在按顺序进行排序。此外，成本 / SUM(成本) OVER () 等于 RATIO_TO_REPORT(成本) OVER ()。

一个例子：

```
SQL> create table my_table(cost)
  2  as
  3  select 10 from dual union all
  4  select 20 from dual union all
  5  select 5 from dual union all
  6  select 50 from dual union all
  7  select 60 from dual union all
  8  select 40 from dual union all
  9  select 15 from dual
 10  /

Table created. 
```

您的初始查询：

```
SQL> SELECT cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per
  2  FROM my_table
  3  ORDER BY cost DESC
  4  /

      COST      TOTAL        PER
---------- ---------- ----------
        60        200         .3
        50        200        .25
        40        200         .2
        20        200         .1
        15        200       .075
        10        200        .05
         5        200       .025

7 rows selected. 
```

Quassnoi 的查询包含一个错字：

```
SQL> SELECT  cost, total, per, SUM(running) OVER (ORDER BY cost)
  2  FROM    (
  3          SELECT  cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per
  4          FROM    my_table
  5          ORDER BY
  6                  cost DESC
  7          )
  8  /
SELECT  cost, total, per, SUM(running) OVER (ORDER BY cost)
                              *
ERROR at line 1:
ORA-00904: "RUNNING": invalid identifier 
```

如果我纠正那个错字。它给出了正确的结果，但排序错误（我猜）：

```
SQL> SELECT  cost, total, per, SUM(per) OVER (ORDER BY cost)
  2  FROM    (
  3          SELECT  cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per
  4          FROM    my_table
  5          ORDER BY
  6                  cost DESC
  7          )
  8  /

      COST      TOTAL        PER SUM(PER)OVER(ORDERBYCOST)
---------- ---------- ---------- -------------------------
         5        200       .025                      .025
        10        200        .05                      .075
        15        200       .075                       .15
        20        200         .1                       .25
        40        200         .2                       .45
        50        200        .25                        .7
        60        200         .3                         1

7 rows selected. 
```

我想这就是你要找的那个：

```
SQL> select cost
  2       , total
  3       , per
  4       , sum(per) over (order by cost desc)
  5    from ( select cost
  6                , sum(cost) over () total
  7                , ratio_to_report(cost) over () per
  8             from my_table
  9         )
 10   order by cost desc
 11  /

      COST      TOTAL        PER SUM(PER)OVER(ORDERBYCOSTDESC)
---------- ---------- ---------- -----------------------------
        60        200         .3                            .3
        50        200        .25                           .55
        40        200         .2                           .75
        20        200         .1                           .85
        15        200       .075                          .925
        10        200        .05                          .975
         5        200       .025                             1

7 rows selected. 
```

问候，罗布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:53:05.220

```
SELECT  cost, total, per, SUM(per) OVER (ORDER BY cost)
FROM    (
        SELECT  cost, SUM(cost) OVER() AS total, cost / SUM(cost) OVER() AS per
        FROM    my_table
        )
ORDER BY
        cost DESC 
```

# ms-access - 在 vba 中定义分隔符以进行访问

> ID：946441
> 
> 赞同：1
> 
> 时间：2009-06-03T18:44:05.597
> 
> 标签：ms-access, vba

我有一个使用条形码扫描仪收集信息的访问界面。我想要一个包含多个信息的条形码示例：一个包含订单价值和该订单特定项目的条形码。

我有分为“批次”的项目，这些项目按特定项目分组到这些批次中，每批 1 个项目类型。但是一个订单可以有多个项目类型，因此每个订单可以有多个批次。我想在一个条形码中添加订单和批号。

它看起来像 *O961LA1450*

星号开始和结束条形码。O 开始订单号 961。L 开始批号 A1450。

我想定义一个分隔符“L”来分隔条形码以将批号与表格的批号进行比较以检查它是否正确，然后用正确的订单号填充表格上的订单号。

任何人都可以解释如何定义分隔符或提供他们可以提供的代码片段。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:07:26.160

非常基本的例子：

```
Sub Main()

    Dim barcode As String

    barcode = "O961LA1450"

    ProcessBarcode (barcode)

End Sub

Function ProcessBarcode(barcode As String)

    Dim order As Long
    Dim lot As String
    Dim codes As Variant

    codes = Split(barcode, "L")
    order = CLng(Right(codes(0), Len(codes(0)) - 1))
    lot = codes(1)

    'for testing purposes:
    Debug.Print "Order: " & order & " Lot: " & lot
    'do comparing against other values here

End Function 
```

结果是：

```
Order: 961 Lot: A1450 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-17T21:15:44.700

这种数据习惯上使用固定长度的字段，这样您就可以为订单号分配 4 个字符，为批号分配 5 个字符，这样：

```
 0961A1450 
```

将被解析：

```
 Order Number: Left("0961A1450", 4)
  Lot Number:   Mid("0961A1450", 5, 5) 
```

在分隔符上浪费空间的唯一原因是数据是可变长度的。我可能会为订单号分配 5 个字符，为批号分配 6 个字符以供将来打样（并适当地填充）。例如，该示例将被编码为：

```
 00961A01450 
```

...并且您可能希望以这种方式解析它以去除前导零：

```
 Order Number: Val(Left("00961A01450", 5))
  Lot Number:   Mid("00961A01450", 6, 1) & CStr(Val(Mid("00961A01450", 7, 5))) 
```

毕竟，分隔符似乎更容易，但我从未遇到过使用它们的条形码数据。如果您只对两条数据进行编码，则可能会容易得多，因为您将前 N 个位置分配给您的第一条数据，之后的所有内容都将是您的另一条，并且可以是任意长度。

# c# - DSL：从 DSL 规则到 C# 表达式

> ID：946450
> 
> 赞同：2
> 
> 时间：2009-06-03T18:45:33.957
> 
> 标签：c#, compiler-construction, designer, dsl, dsl-tools

问题可能是复合的，让我扩展它：

*   是否存在**设计**器（存根/框架/元设计器）来创建基于 .NET 对象公共 bool 属性的基于 AND/OR 的规则？保存为任何 DSL/Boo/... 输出。
*   是否可以将**DSL 输出编译为 C#**表达式？

我们的主要问题是文档和代码之间的差距。我们的产品基于数百个用户定义的规则，我们希望加快变更请求。

如果我们能够为用户提供一个简单的设计器并获取输出，那么在将其翻译/编译成 C#/IL 代码之后，我们就有了一个快速的更改请求周期。

我知道我们的问题很具体，但欢迎任何“墙砖”！

**示例**：

AC# 类，主题：

```
public class TestA
{
     public bool B {...}
     public bool C {...}
} 
```

在设计师中，我们应该能够创造

*   任何类型的图形设计师（即下拉选择公共属性）

DSL 中的输出：

```
If TestA.B AND TestA.C Then Return True; 
```

C# 中的输出：

```
if (testA.B && testA.C) { return true; } 
```

**更新#1**

我会很高兴支持使用静态类型的 .NET 类的 DSL 语言。我的意思是如果用户可以检查代码（示例中的*“输出 DSL”*），我们不需要设计器。

**更新#2**

根据tipp，我盯着表情树。几天后，我遇到了 DLinq——我从来都不是 DLinq 的忠实粉丝，但在这种情况下，我非常适合问题域。

*   易于将*(A > 2 AND B < 4) OR C = 5*解析为表达式树
*   轻松创建这样的表达式
*   非常容易序列化/反序列化
*   基于 FlowLayoutPanel 的 GUI 可以很好地作为“表达式生成器”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T22:48:51.487

你可以自己建造这样的东西。

您可以使用 Type.GetMembers() 获取类的所有公共属性的列表

但是，我不会生成 C# 代码，而是使用表达式树。

这样，当用户更改规则时，您不需要涉及 C# 编译器。相反，您可以将规则存储在数据库中，在运行时加载它们，然后使用 Expression.Compile() 方法创建可以调用以运行代码的委托。

**更新：**

在评论中有人问“Expression Tress 和特定领域的语言有什么区别？”

**这是答案：**

表达式树和特定领域的语言是正交的东西。

表达式树只是一个用于表示 C# 表达式的 API，可以方便地在运行时动态转换为委托。

DSL 或领域特定语言是一种旨在解决一小部分问题的编程语言。

它们本质上是完全不同的东西。

如果您愿意，可以将表达式树用作 DSL 实现的一部分。Linq 将它们用于此目的。

但是，在您的情况下，您不需要 DSL。您需要的是生成规则的用户界面（类似于 Outlook 的工作方式），然后是执行这些规则的方式。

创建 UI 只是普通的 UI 开发。

表达式树可以用来实现规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-12T02:21:43.133

一个鲜为人知的事实是，Windows Workflow Foundation 及其规则引擎的设计器可以托管在独立于 Visual Studio 的 Windows 窗体应用程序中。以这种方式创建的规则可以类似地独立于实际工作流进行评估。

请参阅[WF 方案指南：工作流设计器重新托管](http://msdn.microsoft.com/en-us/library/cc835242.aspx)和[教程：托管 WF 设计器](http://msdn.microsoft.com/en-us/library/bb153576.aspx)。

# asp.net-mvc - 如何在 ASP.Net MVC 应用程序中将 ActiveReport 导出到 XLS？

> ID：946457
> 
> 赞同：2
> 
> 时间：2009-06-03T18:46:01.850
> 
> 标签：asp.net-mvc, export, activereports

我不确定如何在我的 asp.net mvc 应用程序中将我的 ActiveReports 报告文档导出到 XLS。

到目前为止，我的概念是有一个导出类型的下拉列表和一个将该值提交给我的控制器的提交按钮。当我在控制器上时，我重新生成报告并将其传递给我的 Export 方法。我不确定让这个 Export 方法返回什么。我在实际的 xlsExport.Export 方法上也遇到了超出范围的错误。下面是我的导出方法。还要注意，reportBase.Report 是一个 ActiveReport3 对象。

```
private ActionResult Export(ReportBase reportBase)
        {
            Response.ClearContent();
            Response.ClearHeaders();

            var exportType = Request.Form["exportType"];

            switch (exportType)
            {
                case "RTF":
                    Response.ContentType = "application/octet-stream";
                    Response.AddHeader("Content-Disposition", "attachment;filename=report.rtf");
                    var rtfExport = new RtfExport();
                    rtfExport.Export(reportBase.Report.Document, Response.OutputStream);
                    break;
                case "TIFF":
                    Response.ContentType = "image/tiff";
                    Response.AddHeader("Content-Disposition", "attachment;filename=report.tif");
                    var tiffExport = new TiffExport();
                    var filePath = System.IO.Path.GetTempFileName();
                    tiffExport.Export(reportBase.Report.Document, filePath);

                    var fileStream = System.IO.File.Open(filePath, System.IO.FileMode.Open);
                    var bufferLength = (int)fileStream.Length;
                    var output = new byte[bufferLength];
                    var bytesRead = fileStream.Read(output, 0, bufferLength);

                    Response.OutputStream.Write(output, 0, bytesRead);
                    System.IO.File.Delete(filePath);
                    break;
                case "XLS":
                    Response.ContentType = "application/octet-stream";
                    Response.AddHeader("Content-Disposition", "attachment;filename=report.xls");
                    var xlsExport = new XlsExport();
                    xlsExport.Export(reportBase.Report.Document, Response.OutputStream);
                    break;
            }

            Response.Flush();
            Response.End();

            return View("Display", reportBase);

        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-04T08:40:54.133

你的问题我没有答案。包括完整的异常消息会很有帮助。没有足够的信息可以帮助您，但我会检查以确保 reportBase.Report.Document 不为空。

但是，我确实想对您的代码发表一般评论。您的控制器操作未遵循 ASP.NET MVC 的约定。它不应该直接写入响应流。首先，很难进行单元测试。其次，它往往会使你的动作在责任上爆炸（它已经比我喜欢的最大控制器大 4 倍左右） Response.End 正在缩短动作，而“返回 View()”什么也不做。我会做类似的事情：

```
var exportType = Request.Form["exportType"];
switch (exportType)
{
  case "RTF":
    return new RtfExportResult(reportBase.Report.Document);
  case "TIFF":
    return new TiffExportResult(reportBase.Report.Document);
  case "XLS":
    return new XlsExportResult(reportBase.Report.Document);
}

return View("Error"); // unsupported export type 
```

然后您的 XlsExportResult 将如下所示：

```
public class XlsExportResult : ActionResult
{
    private readonly Document document;

    public XlsExportResult(Document document)
    {
        this.document= document;
    }

    public override void ExecuteResult(ControllerContext context)
    {
        var response = context.HttpContext.Response;
        response.ContentType = "application/octet-stream";
        response.AddHeader("Content-Disposition", "attachment;filename=report.xls");
        var xlsExport = new XlsExport();
        xlsExport.Export(this.document, response.OutputStream);
    }
} 
```

然后，您可以编写测试以更轻松地仅执行 XlsExport 部分。（我还会找到一种将 XlsExport 隐藏在接口后面的方法。）通过一些创意（为文件名等添加额外的属性），您将能够在整个项目中重用 *Result 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T09:16:15.313

您可以参考这篇博文中给出的示例应用程序，其中详细介绍了如何在 MVC 应用程序中使用 ActiveReports 导出报告。

[http://blogs.gcpowertools.co.in/2012/02/exporting-reports-created-using.html](http://blogs.gcpowertools.co.in/2012/02/exporting-reports-created-using.html)

该博客详细解释了您需要遵循的步骤以及具体操作方法。

# javascript - 如何让 Adob e AIR 使用 JavaScript 和更新框架更新应用程序？

> ID：946458
> 
> 赞同：0
> 
> 时间：2009-06-03T18:46:02.007
> 
> 标签：javascript, air

这是我所拥有的基础知识：

```
var onError = function() { alert( "error" ); }
var appUpdater = new runtime.air.update.ApplicationUpdaterUI();
appUpdater.configurationFile = new air.File( "app:/updateConfig.xml" );
appUpdater.addEventListener( air.ErrorEvent.ERROR, onError );
appUpdater.initialize(); 
```

我加载了所有适当的框架文件，updateConfig.xml 和 updateDescriptor.xml，并且 URL 用于 localhost 实例。我没有收到任何错误，如果我调用 INITIALIZED UpdateEvent 属性，它正在初始化。

我的 updateConfig.xml：

```
<?xml version="1.0" encoding="utf-8"?> 
<configuration xmlns="http://ns.adobe.com/air/framework/update/configuration/1.0"> 
    <url>http://virtual.sandbox.com:81/updateDescriptor.xml</url> 
    <delay>0</delay>
    <defaultUI> 
        <dialog name="checkForUpdate" visible="true" />
        <dialog name="downloadUpdate" visible="true" />
        <dialog name="downloadProgress" visible="true" />
        <dialog name="installUpdate" visible="true" />    
        <dialog name="fileUpdate" visible="true" />
        <dialog name="unexpectedError" visible="true" />
    </defaultUI>
</configuration> 
```

我的 updateDescriptor.xml：

```
<?xml version="1.0" encoding="utf-8"?> 
<update xmlns="http://ns.adobe.com/air/framework/update/description/1.0"> 
    <version>1.1</version> 
    <url>http://virtual.sandbox.com:81/MyWidget.air</url> 
    <description><![CDATA[This is the latest version of the DOI Express Reorder widget.]]></description>
</update> 
```

应用程序描述符版本节点设置为 1.0。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T11:58:17.277

不要使用 0 作为延迟标签。

```
<delay>0</delay> 
```

值为 0 表示它不执行定期更新。每天使用 1 次，或者使用 0.25 等分数来减少。

# wordpress - How can other users be updated when a comment is posted, other than the author in wordpress?

> ID：946459
> 
> 赞同：0
> 
> 时间：2009-06-03T18:46:12.537
> 
> 标签：wordpress

We have a wordpress setup, with a closed user group (ie one cannot create a login for himself). Whenever I write a blog & comments are posted to it, I get updated over mail. But, how to make sure to update other users also.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T19:05:03.250

我使用的是[订阅评论](http://wordpress.org/extend/plugins/subscribe-to-comments/ "WordPress 扩展 - 订阅评论")，效果很好。其他包括[立即订阅评论！](http://wordpress.org/extend/plugins/subscribe-to-comments-now/ "WordPress 扩展 - 立即订阅评论！")还有 Chet 提到的[Subscribe2](http://wordpress.org/extend/plugins/subscribe2/screenshots/ "WordPress 扩展 - 订阅2")。订阅 2 似乎拥有三个管理界面中最好的，我想我可以试试那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:57:09.597

我会尝试一个 Wordpress 订阅插件。最知名的插件称为 Subscribe2。我认为它适用于注册用户。如果没有，请浏览 Wordpress 的扩展页面以获取类似的页面。我想像这样解决你的问题并不会成为一个编程问题，但为什么要重写代码呢？

[订阅2](http://subscribe2.wordpress.com/ "订阅2")

# c# - How can I pass an argument from a web page that is loaded inside a web browser applet in a C# program, back to the C# application?

> ID：946460
> 
> 赞同：0
> 
> 时间：2009-06-03T18:46:18.947
> 
> 标签：c#, php, javascript, c++

This is a probably a dumb question but here is what I've got.

A web developer has a secure login page that after a user logs into it, a database reference is made and it grants rights to a particular PDF file on our network. There is desire to have a custom locally designed application used to present that PDF file to the user, which is fine as I have used cpp code from Adobe to generate a stripped down viewer, however the problem I'm faced with is integrating his web application into my windows application.

It would be easier for me to just create my own login/database query, but then I'd basically be removing his entire piece of the project. That in itself presents a problem, as really this entire thing *is* his project and he asked me for help. So that's why I'm stuck with this situation where I"m attempting to insert a web applet in the application to present his login page. From that login page, after it authenticates, he can return a path to that particular file. He was previously just launching the associated PDF viewer (Acrobat), but what we need is a fully integrated solution. Make sense?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:18:43.657

查看 WebBrowser 的 ObjectForScripting 属性。它允许您定义一个对象，其方法可以由 Javascript 代码调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:08:11.010

调用脚本。

[http://msdn.microsoft.com/en-us/library/cc491132.aspx](http://msdn.microsoft.com/en-us/library/cc491132.aspx)

让站长这样写：

```
<script type="text/javascript">
function getPdfPath() {
  return "/path/to/my.pdf";
}
</script> 
```

然后，您应该能够：

```
var path = (string) oWebBrowser.InvokeScript("getPdfPath"); 
```

或者，您可以让他为您编写 Web 服务。

# apache-flex - Flex DataGrid with row number column

> ID：946465
> 
> 赞同：2
> 
> 时间：2009-06-03T18:47:00.973
> 
> 标签：apache-flex

I want to extend the DataGrid component so that there is a (read-only) column for the row number like you see in spreadsheets. I came across this article [http://www.cflex.net/showFileDetails.cfm?ObjectID=735](http://www.cflex.net/showFileDetails.cfm?ObjectID=735) but it depends on the data being unique for each row so that it can index into the array. If the data is not unique (like for an empty grid) it doesn't work. How can I implement that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-27T01:29:09.553

这对我有用：

```
<mx:Label xmlns:mx="http://www.adobe.com/2006/mxml">
<mx:Script>
    <![CDATA[
        import mx.controls.AdvancedDataGrid;

        private var handleDataChangedEnabled:Boolean = false;

        override public function set data(value:Object):void {
            super.data = value;

            if (!handleDataChangedEnabled) {
                addEventListener("dataChange", handleDataChanged);
            }
        }

        public function handleDataChanged(event:Event):void {
            this.text = String(listData.rowIndex + (listData.owner as AdvancedDataGrid).verticalScrollPosition + 1);
        }
    ]]>
</mx:Script> 
```

当然，您必须将 AdvancedDataGrid 更改为 DataGrid。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:14:44.010

确保 dataProvider 具有唯一的列或属性，如果您不这样做，则不要显示该列/属性。关键是dataProvider

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-20T19:02:03.597

只需将此类用作您的 itemRenderer：RowNumColumnRenderer.as

```
package
{
    import mx.collections.IList;
    import mx.controls.AdvancedDataGrid;
    import mx.controls.Label;
    import mx.controls.listClasses.ListBase;

    public class RowNumColumnRenderer extends Label
    {
        override public function set data(value:Object):void
        {
            super.data = value;
            if (listData != null)
                this.text = (AdvancedDataGrid(listData.owner).itemRendererToIndex(this) + 1).toString();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-12T22:14:43.990

我可以通过实现自定义 itemRenderer RowNumberRenderer.as 来做到这一点

```
package com.domain
{
    import mx.collections.IList;
    import mx.controls.Label;
    import mx.controls.listClasses.ListBase;

    public class RowNumberRenderer extends Label
    {
        public function RowNumberRenderer()
        {
            super();
        }

        override public function set data(value:Object):void
        {
            super.data = value;
            this.text = String(IList(ListBase(listData.owner).dataProvider).getItemIndex(data) + 1);                     
        }

    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-10-25T15:45:38.630

以下内容如何：

```
RendererRowIndexPlusOne.as 
package
{
    import mx.controls.Label;
    import mx.utils.StringUtil;
    import mx.utils.ObjectUtil; 

    public class RendererRowIndexPlusOne extends Label
    {   
        public override function set data(item:Object):void {
            super.data = item; 

            trace('listData.label ' + listData.label);
            trace('listData.rowIndex ' + listData.rowIndex);
            trace('listData.columnIndex ' + listData.columnIndex);
            trace('listData.owner ' + listData.owner);

            text = String(listData.rowIndex + 1);
        }
    }
} 
```

# c++ - C++ 程序员应该如何用 C 语言设计软件？

> ID：946470
> 
> 赞同：9
> 
> 时间：2009-06-03T18:48:50.533
> 
> 标签：c++, c

作为 C++ 程序员，我们必须在将概念实现到类之前处理概念和相关概念的关系。

但是，如何用 C 等程序语言设计软件？没有 C++ 中的类的帮助，我如何处理概念。

有关的：

*   [用 C 语言规划和组织应用程序开发的最佳方式是什么？](https://stackoverflow.com/questions/436446/what-is-the-best-way-to-plan-and-organize-development-of-an-application-in-c)
*   [与来自面向对象领域的 C 作斗争？](https://stackoverflow.com/questions/674722/struggling-with-c-coming-from-object-oriented-land)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-03T18:55:44.437

如果您熟悉 C++，您可能需要考虑在要创建类的任何地方创建数据结构，并创建类似于您通常可能创建的类方法的函数，第一个参数接受指向该结构的指针。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T18:52:48.590

在面向对象的语言中，您习惯于首先考虑数据对象，然后再考虑要将哪些方法或行为应用于这些对象。将数据结构与作用于它们的函数分开考虑有助于过程编程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T19:01:00.510

将 OOP 设计原则引入“C”是完全可能的。您缺少一些语法糖，但归根结底，它只是结构、函数和指针。

看看[glib](http://library.gnome.org/devel/glib/2.20/)、[gtk](http://library.gnome.org/devel/gtk/stable/)和[gts](http://gts.sourceforge.net/reference/book1.html)，了解 C 中 OOP 编码风格的好例子。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-03T18:56:34.527

您还可以查看 Glib/ [GObject](http://en.wikipedia.org/wiki/GObject)，它为 C 语言提供类机制。它被许多项目所使用，并且非常强大且经过大量测试。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-03T19:25:06.200

仅当您要解决的问题很好地映射到它时，才使用功能分解。

请记住，在 Objective C 和 C++ 出现之前很久，操作系统、GUI 和其他事件驱动的非过程系统都是用 C 编写的。C 不是 Cobol。

在学习 C++ 之前，我使用函数指针数组用 C 语言编写了一个事件驱动的 GUI。封装很容易，我没有尝试多态，一些关系依赖于编码标准和命名约定，因为名称空间和对象不可用。它包含了一个真正的解析器，因为我还没有在 Uni 上过 Compiler 课程，所以它是递归的。是的，它们都适合 640K，但我确实使用了覆盖。

有些人尝试使用 Structs 中的函数指针来拼凑伪对象。我不明白这一点。在某些时候你必须接受你没有使用 C++ 的事实。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-04T08:06:04.533

您已经收到了很多关于如何在 C 中实现面向对象概念的建议，但是除非问题域使 OOP 非常需要（例如 GUI 编程），否则您应该 IMO 宁愿以过程方式使用 C 和其他过程语言。OOP 在 IMO 中并非天生就适用于所有场景。

您可能想查看项目分析/设计阶段的“旧式”[结构化分析](http://en.wikipedia.org/wiki/Structured_analysis)方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-04T00:11:37.450

绝对没有什么可以阻止您在 C 面向对象设计中使用您在 C++ 中使用的所有相同技术，包括多重继承很容易实现。您甚至可以通过一点宏聪明来完成模板编程。唯一的问题是，生成的 C 程序不会像等效的 C++ 那样优雅，因为该语言对这些概念的帮助不大。

C++ 语言提供的只有两个特性很难解决。首先是 C++ 为模板专业化提供的帮助。与使用 C++ 相比，您可能需要更仔细地管理模板对象代码。不过，这是 C 中模板元编程的一个非常简单的方面，因为让宏做正确的事情要复杂得多。

更大的问题是，当类实例超出范围时，该语言不会自动完成类实例，这是 C++ 的大概念。您将不得不在 C 中精心管理资源，而 C++ 会在正确的时间自动完成所有工作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T22:16:07.370

在 C 语言中，程序员经常会模仿类的概念，将相关函数分离到 .h/.c 文件中，并将它们视为一个类。将变量放在本地范围内可以被认为是“私有的”。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-03T19:41:54.013

顾名思义，对于面向对象的语言，例如 C++，问题被分解为对象。使用过程语言，您希望使用功能分解，将问题分解为任务，将每个任务分解为子任务，依此类推……

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-03T18:57:35.803

继续考虑类和类提供的接口。C++ 类将映射到 C 结构。类成员函数成为常规 C 函数。提供一个标头来声明“类”的外部接口。接受 C++ 的某些部分在 C 中不可用 - 命名空间、异常（当然还有类）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-04T13:48:07.383

好吧，您仍然可以在 C 中设计漂亮的抽象数据类型。您首先`typedef`创建一个结构，提供创建/销毁函数，然后其他 setter/getters/doers 对该结构进行操作：

```
类型定义结构{
  /* 在这里维护私有状态 */
  无符号整数 x；
  字符 *y;

} mytype_t;

/** 创建一个新的 mytype... */
mytype_t *mytype_create(unsigned int x, char *y);

/** 销毁一个 mytype，释放所有相关的内存。*/
无效 mytype_destroy(mytype_t *t);

/** 对 mytype 做点什么... */
无效 mytype_do_something(mytype_t *t, int bla);

```

因此，您可以通过访问结构中的“私有”成员来实现这些功能并维护您的状态，该结构的指针被传递给每个函数。

然后你会像这样使用这个界面：

```
mytype_t* t = mytype_create(foo, bar);
mytype_do_something(t);

/* do some other stuff */

mytype_destroy(t);

```

The important point is this: as soon as you typedef a struct, users of the type are not allowed to access its members. They should only talk to it via the public interface/functions defined for it.

I see people typedefing structs just to avoid having to type 'struct' all over the place, but you have to think of it as defining a new abstract type, whose internal implementation may change. Sure a user of the type can dive in and access the members but that's a bad thing to do . A typedef struct means "private, keep out!". This is basic information hiding.

I tend to use a prefix style of naming too, i.e. `mytype_verb`. This helps with intellisense because I can type `mytype_` and get a list of functions for that type. It also helps with naming conflicts since there is no namespace support in C, which is why you will see most C libraries use prefixes (like `sqlite3_`) in front of everything they define.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-04T07:28:43.437

您可以使用 C 结构和函数指针来模仿 C++ 类和方法。这有点痛苦（一切都在 C++ 的幕后完成），但它为您的程序提供了非常好的灵活性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-03T23:49:24.687

使用[功能分解](https://stackoverflow.com/questions/947874/what-is-functional-decomposition)。

功能分解是一种以系统方式设计程序的自顶向下方法。这个想法是将问题分解成它的子任务，依次分解子任务，直到细节足够精细，可以翻译成编程语言。由设计者决定如何分解问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T22:04:53.070

以下是获得单一继承的方法：

```
struct Base {
 int a;
};    
struct MyStruct {
  Base parent;
  int b;
};

struct MyStruct myStruct;
struct Base *base = (struct Base *) &myStruct;
printf("%d\n", base->a);
aFunctionExpectingBase(base); 
```

这模仿了 GObject。您可以做他们所做的其他技巧，例如：在每个类似对象的结构中，包含一个通用的第一级父级可能会很方便。它可以提供 C 对象系统的基本功能。

# cocoa - 应该将“对多”关系建模为属性吗？

> ID：946474
> 
> 赞同：7
> 
> 时间：2009-06-03T18:50:01.840
> 
> 标签：cocoa, model, key-value-observing, key-value-coding

在阅读了*Key-Value Coding Programming Guide*、*Key-Value Observing Programming Guide*和*Model Object Implementation Guide*，以及阅读了很多关于该主题的 StackOverflow 条目并尝试了各种建模场景之后，我感觉我对如何为我的数据建模。

我最终为我的所有属性和一对一关系使用声明的属性，由私有 ivars 支持。对于需要私有可写的只读属性，我`readonly`在接口声明中使用该属性，然后在文件中声明的类扩展中使用该属性`.h`重新声明该属性。在类方法中，我总是使用带点语法的属性访问器，从不直接访问私有 ivars。`readwrite``.m`

然而，有一个方面仍然让我感到困惑：如何正确建模多对关系，特别是当集合是公开不可变但私有可变时（即模型对象的消费者不能向集合添加或删除对象，但是集合的内容由类私下管理）。

我确实了解如何为一对多关系（ , 等）实现 KVC 访问器方法，`countOf<Key>`这`objectsIn<Key>AtIndex`是我迄今为止一直遵循的路线。

但是，我已经看到一些示例代码使用声明的属性来公开关系，不实现 KVC 访问器方法，但仍然是 Key-Value 可观察的。例如：

```
@interface MyModel : NSObject
{
  // Note that the ivar is a mutable array,
  // while the property is declared as an immutable array.
  @private NSMutableArray *transactions_;
}

@property (nonatomic, retain, readonly) NSArray transactions;

@end

--------------------

@implementation MyModel

@synthesize transactions = transactions_;

- (void)privateMethodThatManagesTransactions
{
  [[self mutableArrayValueForKey:@"transactions"] addObject:t];
}

@end 
```

`MyModel`如果消费者对象将自己添加为关键路径实例的观察者`"transactions"`，那么每当从集合中添加或删除事务时都会通知它`transactions`（只要通过该`mutableArrayValueForKey:`方法完成突变）。

对我来说，这似乎是向许多关系公开的最干净的方式，因为我不需要手动编码集合 KVC 访问器并且它保持代码干净。

但是，这似乎不是 Apple 文档所提倡的方式，我不禁想知道它的工作原理是否只是一个不可靠的副作用。

因此，在为我开始从事的项目在我的真实模型类中使用一种或另一种技术之前，我想获得经验丰富的 Cocoa 开发人员的意见和建议。

所以问题是：如果我使用属性来建模一对多关系，我还需要实现 KVC 访问器/修改器方法吗？

***更新***

即使我将一个多对多属性声明为`readonly`，就像上面的示例一样，外部代码仍然可以调用`mutableArrayValueForKey:@"transactions"`模型对象并改变集合。这似乎表明对多对关系使用声明的属性不是要走的路，但我仍然觉得我不太明白......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T19:16:09.573

是的。

> 然而，有一个方面仍然让我感到困惑：如何正确地建模多对关系，尤其是当集合是公开不可变的，但私下可变时……。

简单：`readonly`在标头中声明属性，然后在实现文件中将其[重新声明为`readwrite, copy`类扩展](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW19)。

> 我确实了解如何为一对多关系（ , 等）实现 KVC 访问器方法，`countOf<Key>`这`objectsIn<Key>AtIndex`是我迄今为止一直遵循的路线。

也有变异的。有了这些，你就不需要使用`mutableArrayValueForKey:`; 相反，您可以直接使用可变访问器。您仍然会收到 KVO 通知，因为 KVO 在第一次将自己添加为属性的观察者时包装了这些方法。

我的博客上有[一个访问器选择器格式列表，包括可变访问器。](http://boredzo.org/blog/archives/2007-08-07/a-complete-raw-list-of-kvc-accessor-selector-formats)

编辑：

> 即使我将一个多对多属性声明为只读，就像上面的示例一样，外部代码仍然可以调用`mutableArrayValueForKey:@"transactions"`模型对象并改变集合。

这是养成使用 mutative 访问器并避免使用`mutableArrayValueForKey:`. 如果您在尝试时收到编译器警告（没有这样的 [public] 方法），您将不会从类外部发送突变消息。

尽管`mutableArrayValueForKey:`有人会使用它并且存在风险，但符合 KVO 的属性*是*这里的方法。

# c# - 按日期排序 ListView

> ID：946475
> 
> 赞同：6
> 
> 时间：2009-06-03T18:50:24.023
> 
> 标签：c#, wpf, xaml, listview

我有一个 WPF ListView，其中有一列包含日期。我想要一种自定义日期排序的方法（按日期值，而不是字符串值）。有没有办法做到这一点？现在我正在使用 list.Items.SortDescriptions 使用另一列进行排序，但我想将其更改为对日期列进行排序。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T23:08:04.863

你试过吗？

```
ICollectionView view = CollectionViewSource.GetDefaultView(listView.ItemsSource);
view.SortDescriptions.Add(new SortDescription("Date", ListSortDirection.Descending)); 
```

编辑：您还可以查看[此附加属性](http://www.thomaslevesque.com/2009/03/27/wpf-automatically-sort-a-gridview-when-a-column-header-is-clicked/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T03:33:46.167

如果您发现 WPF 默认的排序方式不是您想要的，您可以为默认视图提供自定义排序器：

```
ListCollectionView view = 
  (ListCollectionView)CollectionViewSource.GetDefaultView(listView.ItemsSource);
view.CustomSort = new DateValueSorter();
listView.Items.Refresh(); 
```

其中 DateValueSorter 是一个实现 IComparer 接口并根据日期值排序并产生您正在寻找的排序的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:30:13.683

使用 ObservableList 和自定义对象类型 - 并自己进行排序。使用 ItemsSource 将 ListView 连接到 ObservableList。

...，或者您可以尝试按照本博客的描述进行操作；[排序列表视图](http://mbrownchicago.spaces.live.com/Blog/cns!2221DC39E0C749A4!331.entry)

# nhibernate - 将属性映射到 NHibernate 中的最新条目

> ID：946482
> 
> 赞同：1
> 
> 时间：2009-06-03T18:50:52.743
> 
> 标签：nhibernate, nhibernate-mapping

假设我的域如下所示：

*   我有一个对象 Vehicle，它具有 OdometerReading 属性。
*   OdometerReading 具有里程和日期（读取时间）。

我需要在数据库中保留车辆的所有里程表读数的历史记录，但不希望整个里程表历史记录属于车辆对象。我想要的是 OdometerReading 属性映射到数据库中最新的 OdometerReading 条目。

我考虑将 OdometerReadings 的整个集合映射到 Vehicle，并拥有一个名为 CurrentOdometerReading 的动态属性，它可以对它们进行排序并返回最新的，但我不需要我域中 Vehicle 下的整个集合，而且看起来像我会从数据库中获取比我需要的更多的数据。

NHibernate 有可能吗？我将如何映射这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:11:46.930

根据您希望域模型的外观，有几种方法可以做到这一点。我的首选是使用自定义集合类型，例如 IOdometerReadingCollection，您可以向其中添加额外的方法。在这种情况下，它可能类似于：

```
public interface IOdometerReadingCollection : IList<OdometerReading>
{
    OdometerReading Latest { get; }
} 
```

这样你就可以做到：

```
OdometerReading reading = vehicle.OdometerReadings.Latest; 
```

我更喜欢：

```
OdometerReading reading = vehicle.LatestOdometerReading; 
```

有很多关于自定义集合的文档，您可以通过简单的谷歌搜索找到它们。

如果这种方法不适合您，还有其他选择。您可以使用带有公式的属性（我不确定这是否适用于复杂类型？），或常规的 NHibernate 关联，您可以在其中拥有车辆映射上最新的 OdometerReading 的键。正如您还提到的，您可以只加载所有 OdometerReadings，这取决于您的用例实际上可能没问题。

我希望这会有所帮助，或者至少为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:19:01.410

您可以将一个“where”子句放入您的集合映射中。检查参考文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T19:26:57.837

我会将 OdometerReading 属性映射为一个组件，然后使用命名查询来确保它填充了数据库的最新读数。（在此示例中，您将有一个名为“vehicle”的 sql 查询，该查询执行 SQL 以加载 Vehicle 列以及最新的里程表读数）

```
<class name="Vehicle">
    <property name="Type" not-null="true"/>
    <component name="OdometerReading">
        <property name="Miles" />
        <property name="Date" />
    </component>
    <loader query-ref="vehicle"/>
</class> 
```

# reflection - XML 文件中的 GWT 动态菜单。如何反映复合材料的类？

> ID：946486
> 
> 赞同：3
> 
> 时间：2009-06-03T18:51:31.370
> 
> 标签：reflection, gwt, dynamic, menu

我正在尝试在 GWT 中创建一个动态菜单，从 XML 文件中读取它。XML 文件必须具有按钮名称和操作（将添加到水平面板的相关组合）。

要做动作，需要做一个类的Reflection，希望给我很多问题。我尝试了 2 种不同的解决方案，客户端和服务器端。在客户端，我尝试了“gwt-ent”和“gwt 反射”库，但是我遇到了很多错误，并且有必要设置将反映哪些类（我不想要，因为我想要一个完全动态菜单，而不是半动态的）。在服务器端，我尝试返回菜单，但无法在服务器端处理客户端小部件。所以我尝试进行反射并将实例返回给客户端，但在服务器端它不可能获得客户端类。

有人知道其他解决方案吗？我做错了什么？如何反映类以将复合材料放在水平面板上？

谢谢你的帮助。问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-20T07:44:14.660

一种方法是让您的服务器端代码创建一个“工厂”实例，该实例将在客户端创建适当的小部件。然后这个“工厂”被序列化到客户端（现在它是一个 DTO）。像这样的东西：

```
public interface WidgetFactory {
    public Widget createWidget();
}

public class MenuOptionDTO implements Serializable {
    public String optionText;
    public WidgetFactory widgetFactory;
}

public class WidgetOnMenu extends Composite {
    ...
    public static class Factory implements WidgetFactory, Serializable {
        public Widget createWidget() {
            return new WidgetOnMenu();
        }
    }
    ...
} 
```

您可以在服务器端使用普通反射来创建 WidgetFactory 的实例。

```
<menu>
    <option text="Option1" factory="com.acme.WidgetOnMenu.Factory"/>
</menu> 
```

这是[GWT Portlets 框架](http://code.google.com/p/gwtportlets/)使用的方法。

# objective-c - 在 Objective-C 中前向声明枚举

> ID：946489
> 
> 赞同：79
> 
> 时间：2009-06-03T18:52:09.670
> 
> 标签：objective-c, enums, typedef, extern

我在 Objective-C 程序中遇到枚举可见性问题。我有两个头文件，一个定义了一个`typedef enum`. 另一个文件需要使用`typedef`'d 类型。

在直接 C 中，我会简单地`#include`使用另一个头文件，但在 Objective-C 中，建议不要`#import`在头文件之间使用，而是`@class`根据需要使用前向声明。但是，我不知道如何前向声明枚举类型。

我不需要实际的枚举值，除非在相应的`.m`实现文件中，我可以安全地`#import`离开。那么我怎样才能`typedef enum`在标题中得到识别呢？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2017-02-02T17:51:24.673

在objective-c中转发声明枚举（NS_ENUM/NS_OPTION）的最新方法（Swift 3；2017年5月）是使用以下内容：

```
// Forward declaration for XYZCharacterType in other header say XYZCharacter.h
typedef NS_ENUM(NSUInteger, XYZCharacterType);

// Enum declaration header: "XYZEnumType.h"
#ifndef XYZCharacterType_h
#define XYZCharacterType_h

typedef NS_ENUM(NSUInteger, XYZEnumType) {
    XYZCharacterTypeNotSet,
    XYZCharacterTypeAgent,
    XYZCharacterTypeKiller,
};

#endif /* XYZCharacterType_h */` 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-04T03:17:52.847

您的问题的答案是继续导入 typedef 头文件，或者使用像 NSInteger 这样的泛型类型而不是 enum 类型。

但是，不导入头文件的原因不仅仅是编译速度。

不导入头文件还可以减少您对无关类的无意访问。

例如，假设您有一个 TrackFileChanges 类来跟踪文件系统对特定文件的更改，并且您有一个 CachedFile 类来存储文件中的缓存数据。后者可能使用 TrackFileChanges* 类型的私有 ivar，但对于 CachedFile 的使用，这只是一个实现细节（理想情况下，ivar 将使用新运行时使用私有属性自动生成，但如果你重新使用旧的运行时间）。

因此，#import "CachedFile.h" 的客户端可能不需要或不想访问 TrackFileChanges.h。如果他们这样做了，他们应该自己通过#importing 来明确说明。通过在 CachedFile.h 中使用 @class TrackFileChanges instea of​​ #import "TrackFileChanges.h" 可以改进封装。

但话虽如此，如果第二个头文件想要将第一个头文件公开给所有客户端，那么从第二个头文件导入头文件并没有错。例如，声明类的头文件需要在子类化头文件中直接导入，而声明协议的头文件可能会直接导入（尽管您可以使用@protocol ABC；来避免这种情况）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-03T18:56:47.180

继续使用`#import`. 人们建议尽可能使用的唯一原因`@class`是因为它使您的代码编译速度稍快。`#import`但是，从另一个 .h 文件中提取一个 .h 文件没有问题。实际上，在扩展另一个类时需要这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-08-08T01:33:38.137

如果你可以使用编译器扩展，你可以在 Clang 中使用这个顺序：

```
enum Enum;
typedef enum Enum Enum2;

void f(Enum2); // ok. it sees this type's true name.

enum Enum {
    E_1
};

// ok. now its declaration is visible and we can use it.

void f(Enum2 e) {

} 
```

注意：它会触发`-Wpedantic`警告。

* * *

如果您使用的是 C++11，则应该使用它们的枚举，它们可以安全地转发声明——例如`enum class Enum:uint8_t;`（不是编译器扩展）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-07-17T19:34:13.330

What worked for a forward declaration of an enum for me in an Objective C .h file was look in the ProjectName-Swift.h file and see what it put, which happened to be the following:

enum SwiftEnumName : NSInteger;

I needed this forward declaration because I had a function parameter type of SwiftEnumName. And it wouldn't let me put the ProjectName-Swift.h import in the Objective C .h file.

Then in the Objective C .m file I just had the #import "ProjectName-Swift.h" in it and just used the SwiftEnum normally.

This was using Swift 4.1.2.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-03T18:58:06.723

无论如何，您都必须使用`#import`它们，或者创建一个单独的头文件，其中仅包含`typedef`. 不在头文件中导入头文件会使编译速度更快，但不会改变任何其他内容。

[为什么 C++ 不支持枚举的前向声明？](https://stackoverflow.com/questions/71416/forward-declaring-an-enum-in-c)

# javascript - 浏览器 Javascript 在哪里存储和执行？

> ID：946490
> 
> 赞同：0
> 
> 时间：2009-06-03T18:52:33.473
> 
> 标签：javascript, memory, scripting

当 javascript 在浏览器中运行时

```
alert('Hello World'); 
```

什么环境执行它并在内存中管理它？

我知道这是模糊的！但这是最好的起点！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T18:56:34.760

浏览器的 javascript 引擎。

[这是一个](http://ejohn.org/blog/javascript-performance-rundown/)比较一堆性能的页面

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T18:56:02.500

**这取决于浏览器、JavaScript 引擎以及“执行它”的含义**

没有太多的答案可以给出。

看看一些 JavaScript 引擎的架构......

[http://www.mozilla.org/js/spidermonkey/](http://www.mozilla.org/js/spidermonkey/)

[http://code.google.com/p/v8/](http://code.google.com/p/v8/)

如果您想更深入地探索，可以阅读**Dragon Book**的前几章，以了解有关如何将程序解释和/或编译为某种中间或字节码形式的知识。

**祝你好运**

# objective-c - 使用 IB 的 UIToolbar 中的 UILabel 在运行时不可见，如何解决？

> ID：946496
> 
> 赞同：5
> 
> 时间：2009-06-03T18:53:39.137
> 
> 标签：objective-c, iphone, interface

我想在工具栏中显示总计。我在 IB 中将 UILabel 放在了工具栏的顶部。

但是，当我运行应用程序时，UILabel 完全不可见（但可以在代码上设置值）。

最奇怪的是，在其他形式下，一切正常。我不明白为什么在一种形式中起作用，而在另一种形式中却没有……

知道如何解决这个问题吗？或者为什么会发生这种行为？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T21:59:59.977

不要使用 UILabel。

使用 UIBarButtonItem。然后将其设置为 style: plain。它看起来像一个标签，但它实际上是无边框的按钮。这是在条形图上显示文本的一般做法。

您还可以在代码中使用自定义视图创建 UIBarButtonItem。您很简单地将 UILabel “包装”在 UIBarButtonItem 中，允许您将任何您想要的东西添加到工具栏。

* * *

要添加以回应评论：

无论哪种方式，您都使按钮“无效”并且它不响应触摸。尽管它是一个按钮，但它似乎不是一个。这就是 Apple 期望将视图添加到工具栏/导航栏的方式，以“在其上浮动内容”。它不违反任何 HIG 准则，恰恰相反，它是一种推荐的设计技术。

停止发光：以编程方式创建按钮，确保它被禁用，将其添加到栏，然后它应该被禁用，但不暗淡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:41:54.690

在 IB 中，您是否尝试过选择标签并使用“Bring to Font”菜单项（在 Layout 下）？似乎您正在尝试做一些非常标准的事情。

当您尝试设置值时，标签是 nil 还是地址 0x0？标签可能在那里，但它的文本无法设置，因为它的实例有问题（在 IB 中未正确连接到 IBOutlet）....只需在您尝试设置值的行上放置一个断点（s ) 为标签，并验证标签变量不是零（或 0x0）。如果不是，请尝试设置文本并在下一行验证其文本设置是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T05:14:44.383

将 a`UIButton`拖入您的`UIToolBar`. 然后取消选中`User Interaction Enables`此按钮。

自定义您的`UIButton`，使其看起来像一个`UILabel`. 希望这会帮助你。

![UILabel 变成一个 UIToolbar](https://i.stack.imgur.com/LiZwf.png)

# java - 如何使用 Hibernate 获取两个字段的唯一键？

> ID：946512
> 
> 赞同：27
> 
> 时间：2009-06-03T18:56:49.737
> 
> 标签：java, hibernate, orm, jpa, annotations

我有一个实体类的两个字段，我不希望它们是唯一的，而是用作键的复合字段，该键本身必须是唯一的。例如，我有两个字段（名称和版本），其他记录可以相同，但它们必须是唯一的。使用 Hibernate（带注释）的最佳方法是什么？我正在将 Hibernate Validator 用于其他字段，但我不确定使用它来验证两个字段一起构成唯一键的方法。我正在使用一个泛型实体类，它有一个 id 泛型类型，可以换成复合键类，但我还没有让它很好地工作。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-03T19:52:46.100

这将在数​​据库上创建一个唯一键：

```
@Table( name = "MYTABLE",
        uniqueConstraints = { @UniqueConstraint( columnNames = { "NAME", "VERSION" } ) } ) 
```

这将由数据库在更新或持久化时强制执行。

如果您想使用 Hibernate Validator 强制执行此操作，则需要编写自己的自定义验证器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-03T15:00:08.367

我们通常会将这两个字段包装在一个标记为@Embeddable 的内部键类中。例如：

```
@Entity
public class Foo {

  @EmbeddedId()
  private Key key;
  ...

  @Embeddable
  public static class Key {
    @Column(nullable=false)
    private String name;
    @Column(nullable=false)
    private int version;

    protected Key () {
      // for hibernate
    }
    public Key (String name, int version) {
      this.name = name;
      this.version = version;
    }
    ...
    // You probably want .equals and .hashcode methods
  }
} 
```

# tomcat - 在 Tomcat 中缓存准备好的语句的好策略是什么？

> ID：946513
> 
> 赞同：4
> 
> 时间：2009-06-03T18:56:49.987
> 
> 标签：tomcat, servlets, jdbc, synchronization, prepared-statement

我正在寻找一种在 servlet 环境（特别是 Tomcat 5.5）中缓存准备好的语句的方法。这是为了减少创建准备好的语句的次数，`connection.prepareStatement(sql)`即被调用的次数。

我最初的想法是将`PreparedStatement`对象存储在会话中，其中键（属性名称）是查询本身。这也可以懒惰地完成。

但是，有人提醒我，根据 JDBC 驱动程序的实现，同一准备好的语句可能会同时被 2 个线程（或请求）访问，从而导致例如设置错误的参数。因此，对这些语句对象的访问需要同步。

实现这一目标的好策略是什么？

是否有内置于 tomcat 的方法来执行此操作？我已经看到[了这个答案](https://stackoverflow.com/questions/944722/preparedstatement-caching-in-tomcat/944815#944815)，它提到了`poolPreparedStatements`DBCP 参数，但是从文档中并不清楚它是否与我正在寻找的含义相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-04T06:09:15.867

PreparedStatement 缓存通常由您使用的连接池提供。

*   在[c3p0](http://www.mchange.com/projects/c3p0/)中，您可以通过设置[maxStatements 和 maxStatementsPerConnection 设置来激活它](http://www.mchange.com/projects/c3p0/index.html#configuring_statement_pooling)
*   在[DBCP](http://commons.apache.org/dbcp/)中，通过设置[poolPreparedStatements 和 maxOpenPreparedStatements 参数来完成](http://commons.apache.org/dbcp/configuration.html)

请注意，在连接池的工作方式中，一个线程获取一个连接，将其用于一些 sql 查询并将其返回到池中。只有这样，连接才可用于另一个线程。除非连接池中存在错误，否则线程之间不会**同时**共享连接。

顺便说一句 - 我的建议是使用 c3p0 而不是 DBCP。迁移到 c3p0 后，我遇到了很多 DBCP 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:58:19.710

我不确定其他数据库，但如果您使用的是 Oracle，JDBC 客户端将缓存 PreparedStatement。您可能想看看您的数据库是否这样做。

# email - 使传真可以从 ColdFusion Web 应用程序访问

> ID：946516
> 
> 赞同：0
> 
> 时间：2009-06-03T18:57:32.950
> 
> 标签：email, web-applications, coldfusion, fax

我们正在使用 MS SQL 后端为 ColdFusion 中的一所大学编写测试 Web 应用程序。

现在我们必须手动将传真发送到我们的传真机，然后找到它们相关的帐户并输入信息（如果我们需要再次引用它，则必须在文件柜中找到实际的传真）。我想做的是创建一种方式让某人传真到某个号码，然后将传真发送到我们指定的电子邮件帐户。

如果一切正常，我们将需要一种方法来获取电子邮件，将其存储在我们服务器的某个位置，然后将其链接到一个帐户。链接过程可能必须是手动的，我们对此表示满意，但是我们主要是一种简单的方法来查看在我们的 ColdFusion 应用程序中以 PDF 形式发送到该电子邮件的所有传真（可通过我们分配的名称进行搜索）寻找，这样我们就不必在纸上获取传真并手动归档。

有没有办法做到这一点？最好不要通过付费服务，因为我们几乎可以自己编程任何我们需要的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:09:27.607

嗯...您尝试过像 eFax 这样的服务吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:23:13.930

为什么要重新发明轮子？[eFax](http://www.efax.com)和[jConnect](http://www.j2.com)之类的服务（还有其他几个，[只是 Google 的“电子传真服务”](http://www.google.com/search?q=electronic+fax+service)）价格适中，并且可以完成一半的工作。节省自己的精力，只需花几块钱。您也可能会发现，与支付开发人员编写软件的费用相比，为服务付费所花费的成本更低。

因此，当您咬紧牙关注册电子传真服务后，您只需要一个电子邮件帐户即可将其发送到，并使用[CFPOP](http://cfquickdocs.com/cf8/?getDoc=cfpop)检查收件箱并下载附件。剩下的就是小菜一碟了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:00:34.483

从它的声音来看，我已经使用 Coldfusion 构建了与此传真设置相同的东西。

经过几次试验和错误，我发现最好的方法是：

1)**数字化收到的传真：**将所有传真发送到您可以通过 CF 检查的电子邮件地址，或您保存它们的网络文件夹，您可以通过 CF 检查。您绝对可以保留您的传真号码，只需将来电转接到您的数字传真号码。

2)处理**收到的传真**当您发现新的传真时，最好对其进行处理并做好记录。我存储诸如文件名之类的东西，挖掘它来自的传真号码，对照已知号码列表检查它，并拥有一个路由表（以防它需要发送给某人）。

3)**打印和路由传真**也可以通过 CF 在 CF 中自动打印文件一次。

至于桌子，我保留一张来存放每份传真。我也将传真本身存储在一个 blob 中。易于复制和移动，对性能没有太大影响。我保留另一个表来存储传入号码配置文件的列表（如呼叫者 ID 表），以将号码与客户相关联。我保留了一个路由规则表，如果电子邮件来自这里，请发送到这里。最后但同样重要的是，如果您必须管理多个电话号码，您可以创建多个传入配置文件并将它们归档。

一旦您将每份传真存储在数据库中，您就可以使用它做很多事情，并以您喜欢的方式以数字方式对其进行归档/索引/存储。CFDOCUMENT 将显示基于磁盘的 PDF。

我最终不得不为自定义路由选项编写类似的程序。如果您也喜欢 CF，可以将项目自动链接到某些文件/文件夹/项目。

如果您需要了解其他任何信息，请询问，或者如果您需要保密某些细节，我们可以离线讨论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T18:56:58.210

同意亚当。不要给自己制造一堆问题——仅仅使用现有的服务，你会节省很多钱和精力。关于主题：我使用[Popfax](http://www.popfax.com)，我有点喜欢它。它很舒服，给你机会、折扣、竞赛和很多你想要的东西，如果你有兴趣的话。它很便宜（至少，比你自己的软件便宜 100%）而且你不仅可以在 PC 上使用它，也可以通过[手机](http://www.popfax.com/mobileVideo/)

# javascript - 将 javascript 事件挂钩到页面加载

> ID：946518
> 
> 赞同：26
> 
> 时间：2009-06-03T18:57:39.563
> 
> 标签：javascript, master-pages, asp.net, onload-event

我有一个 aspx，它在正文的 onload 事件期间运行了以下 javascript 函数。

```
<body onload="startClock();"> 
```

但是，我将 aspx 设置为使用母版页，因此 aspx 中不再存在正文标记。如何注册 startClock 函数以在页面被点击时运行并且仍然使用母版页？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-03T19:30:36.033

如果您不想显式分配 window.onload 或使用框架，请考虑：

```
<script type="text/javascript">
function startClock(){
    //do onload work
}
if(window.addEventListener) {
    window.addEventListener('load',startClock,false); //W3C
} else {
    window.attachEvent('onload',startClock); //IE
}
</script> 
```

[http://www.quirksmode.org/js/events_advanced.html](http://www.quirksmode.org/js/events_advanced.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T19:02:21.567

将其插入页面正文的任何​​位置：

```
<script type="text/javascript">
window.onload = function(){
    //do something here
}
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-10T07:25:35.137

最简洁的方法是使用 jQuery 之类的 javascript 框架。在 jQuery 中，您可以通过以下方式定义 on-load 函数：

```
$(function() {
    // ...
}); 
```

或者，如果您不喜欢短`$();`样式：

```
$(document).ready(function() {
    // ...
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T19:03:29.803

```
Page.ClientScriptManager.RegisterStartupScrip(this.GetType(), "startup", "startClock();", true); 
```

或使用原型

```
document.observe("dom:loaded", function() {
  // code here
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-06T11:56:17.890

```
window.addEventListener("load", function() {
    startClock();
} 
```

这将在页面加载时调用 startClock 函数。

# artificial-intelligence - 进入/退出导航图 - 寻路

> ID：946528
> 
> 赞同：0
> 
> 时间：2009-06-03T19:00:31.773
> 
> 标签：artificial-intelligence

我在 3D 环境中手动创建了 NavGraph。我了解（并且之前已经实施过）一个 A* 例程，一旦您“进入图表”，就可以在图表中找到我的方式。

我感兴趣的是进入和“关闭”图表的最佳方式。

例如：所以例行程序是这样的：从源头向目的地射一条射线，如果没有任何阻碍，继续走。

如果有问题，我们需要使用图，所以要进入图，我们需要找到图上最近的可见节点。（为此，我之前根据与源的距离对图表进行了排序，然后从壁橱向最远的地方发射光线，直到找到没有障碍物的光线。）

然后运行标准 A*...

然后“退出”图表，通过与我们在图表上得到的方法相同的方法（用于计算上述 A* 的端点），所以我将光线从端点发射到最近的导航图节点。

所以到这一切都说完了，除非我的导航图非常密集，否则我花在上/下图上的时间比计算路径的时间还要多……

必须有更好/更快的方法吗？（是否有某种空间细分技巧？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:04:12.250

您可以构建所有节点的[四叉树](http://en.wikipedia.org/wiki/Quadtree)，以快速找到距给定位置最近的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T09:16:58.633

对世界进行空间细分是很常见的。像四叉树或八叉树之类的东西在 3D 世界中很常见，尽管您也可以覆盖网格，或跟踪任意区域等。基本上这是一个简单的数据结构问题，无需 O 就可以访问 N 个导航图节点(N) 搜索以找到您所在的位置，您的选择往往归结为某种树或某种哈希表。

# regex - 使用正则表达式替换子字符串

> ID：946533
> 
> 赞同：1
> 
> 时间：2009-06-03T19:01:09.247
> 
> 标签：regex, coldfusion

我想在包含 mailto: 标签的任何 href 中添加对 onclick 事件的调用。

例如，我想采取以下任何实例：

```
<a href="mailto:user@domain.com"> 
```

并将其更改为：

```
<a href="mailto:user@domain.com" onclick="return function();"> 
```

我遇到的问题是 mailto 字符串的值不一致。

我需要说一下，比如在匹配 ' ' 的字符串`>`中用 ' ' 替换所有 ' ' 字符实例。`onclick="return function();">``<a href="mailto:*">`

我正在使用 REreplacenocase() 函数在 ColdFusion 中执行此操作，但欢迎使用常规 RegEx 建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T19:09:46.390

以下内容会将您的 onclick 添加到包含字符串的所有 mailto 链接`str`：

```
REReplaceNoCase(
    str,
    "(<a[^>]*href=""mailto:[^""]*""[^>]*)>",
    "\1 onclick=""return function();"">",
    "all"
) 
```

这个正则表达式的作用是找到任何`<a ...>`看起来像是电子邮件链接的标记（即，使用 mailto 协议具有 href 属性），并将 onclick 属性添加到它。直到标记末尾的所有内容都将存储到第一个反向引用中（在替换字符串中由 \1 引用），以便`<a>`保留 中的任何其他属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T19:07:46.500

如果这样做的唯一目的是添加 JavaScript 事件处理程序，我认为 Regex 不是最佳选择。如果您使用 JavaScript 连接您的 JavaScript 事件，如果 JS 不可用，您将获得更优雅的降级（例如，什么都不会发生，而不是让 onclick 杂乱无章地散布在您的标记中）。

此外，使用 DOM 消除了由于 Regex 无法完美预测所有可能的标记形式而导致的丢失匹配或误报的可能性：

```
function myClickHandler() {
    //do stuff
    return false;
}

var links = document.getElementsByTagName('a');
for(var link in links) {
    if(link.href.indexOf('mailto:') == 0) {
        link.onclick = myClickHandler;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:49:16.313

为什么不使用[jQuery](http://jquery.com/)之类的库在前端执行此操作？

```
$(function(){
 $("a[href^=mailto]").click(function(){
  // place the code you want to execute here
 })
}); 
```

# jquery - 使用 jQuery 将文本插入 textarea

> ID：946534
> 
> 赞同：155
> 
> 时间：2009-06-03T19:01:10.180
> 
> 标签：jquery, formatting, textarea

我想知道如何在单击锚标记后使用 jquery 将文本插入文本区域。

我不想替换 textarea 中已有的文本，我想将新文本附加到 textarea。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2010-05-12T14:11:34.787

我喜欢 jQuery 函数扩展。然而，*this*指的是 jQuery 对象而不是 DOM 对象。因此，我对其进行了一些修改以使其变得更好（可以一次在多个文本框/文本区域中更新）。

```
jQuery.fn.extend({
insertAtCaret: function(myValue){
  return this.each(function(i) {
    if (document.selection) {
      //For browsers like Internet Explorer
      this.focus();
      var sel = document.selection.createRange();
      sel.text = myValue;
      this.focus();
    }
    else if (this.selectionStart || this.selectionStart == '0') {
      //For browsers like Firefox and Webkit based
      var startPos = this.selectionStart;
      var endPos = this.selectionEnd;
      var scrollTop = this.scrollTop;
      this.value = this.value.substring(0, startPos)+myValue+this.value.substring(endPos,this.value.length);
      this.focus();
      this.selectionStart = startPos + myValue.length;
      this.selectionEnd = startPos + myValue.length;
      this.scrollTop = scrollTop;
    } else {
      this.value += myValue;
      this.focus();
    }
  });
}
}); 
```

这真的很好用。您可以一次插入多个位置，例如：

```
$('#element1, #element2, #element3, .class-of-elements').insertAtCaret('text'); 
```

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2009-06-03T19:22:41.057

根据您在 Jason 的评论中的内容，请尝试：

```
$('a').click(function() //this will apply to all anchor tags
{ 
   $('#area').val('foobar'); //this puts the textarea for the id labeled 'area'
}) 
```

**编辑 -**要附加到文本，请看下面

```
$('a').click(function() //this will apply to all anchor tags
{ 
   $('#area').val($('#area').val()+'foobar'); 
}) 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-06-03T19:07:19.717

我在我的代码中使用了这个函数：

```
$.fn.extend({
  insertAtCaret: function(myValue) {
    this.each(function() {
      if (document.selection) {
        this.focus();
        var sel = document.selection.createRange();
        sel.text = myValue;
        this.focus();
      } else if (this.selectionStart || this.selectionStart == '0') {
        var startPos = this.selectionStart;
        var endPos = this.selectionEnd;
        var scrollTop = this.scrollTop;
        this.value = this.value.substring(0, startPos) +
          myValue + this.value.substring(endPos,this.value.length);
        this.focus();
        this.selectionStart = startPos + myValue.length;
        this.selectionEnd = startPos + myValue.length;
        this.scrollTop = scrollTop;
      } else {
        this.value += myValue;
        this.focus();
      }
    });
    return this;
  }
});
```

```
input{width:100px}
label{display:block;margin:10px 0}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<label>Copy text from: <input id="in2copy" type="text" value="x"></label>
<label>Insert text in: <input id="in2ins" type="text" value="1,2,3" autofocus></label>
<button onclick="$('#in2ins').insertAtCaret($('#in2copy').val())">Insert</button>
```

这不是 100% 我的，我在某个地方搜索了它，然后调整了我的应用程序。

用法：`$('#element').insertAtCaret('text');`

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-09-09T13:13:41.360

我知道这是一个老问题，但对于寻找此解决方案的人来说，值得注意的是，您不应使用 append() 将内容添加到文本区域。append() 方法的目标是 innerHTML 而不是 textarea 的值。内容可能会出现在文本区域中，但不会添加到元素的表单值中。

如上所述，使用：

```
$('#textarea').val($('#textarea').val()+'new content'); 
```

会正常工作。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-10-14T00:55:53.277

这个允许您将一段文本“注入”到文本框，注入意味着：将文本附加到光标所在的位置。

```
function inyectarTexto(elemento,valor){
 var elemento_dom=document.getElementsByName(elemento)[0];
 if(document.selection){
  elemento_dom.focus();
  sel=document.selection.createRange();
  sel.text=valor;
  return;
 }if(elemento_dom.selectionStart||elemento_dom.selectionStart=="0"){
  var t_start=elemento_dom.selectionStart;
  var t_end=elemento_dom.selectionEnd;
  var val_start=elemento_dom.value.substring(0,t_start);
  var val_end=elemento_dom.value.substring(t_end,elemento_dom.value.length);
  elemento_dom.value=val_start+valor+val_end;
 }else{
  elemento_dom.value+=valor;
 }
} 
```

你可以像这样使用它：

```
<a href="javascript:void(0);" onclick="inyectarTexto('nametField','hello world');" >Say hello world to text</a> 
```

当我们有“将标签插入文本”功能时，有趣且更有感觉。

适用于所有浏览器。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-09-06T11:38:40.820

Hej，这是一个修改后的版本，在 FF @least 中对我来说可以正常工作并插入到插入符号的位置

```
 $.fn.extend({
  insertAtCaret: function(myValue){
  var obj;
  if( typeof this[0].name !='undefined' ) obj = this[0];
  else obj = this;

  if ($.browser.msie) {
    obj.focus();
    sel = document.selection.createRange();
    sel.text = myValue;
    obj.focus();
    }
  else if ($.browser.mozilla || $.browser.webkit) {
    var startPos = obj.selectionStart;
    var endPos = obj.selectionEnd;
    var scrollTop = obj.scrollTop;
    obj.value = obj.value.substring(0, startPos)+myValue+obj.value.substring(endPos,obj.value.length);
    obj.focus();
    obj.selectionStart = startPos + myValue.length;
    obj.selectionEnd = startPos + myValue.length;
    obj.scrollTop = scrollTop;
  } else {
    obj.value += myValue;
    obj.focus();
   }
 }
}) 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-06-03T19:05:07.677

你有没有尝试过：

```
$("#yourAnchor").click(function () {
    $("#yourTextarea").val("your text");
}); 
```

不过，不确定自动突出显示。

**编辑**：

追加：

```
$("#yourAnchor").click(function () {
    $("#yourTextarea").append("your text to append");
}); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-06-03T19:49:53.420

你所要求的应该在 jQuery 中相当简单——

```
$(function() {
    $('#myAnchorId').click(function() { 
        var areaValue = $('#area').val();
        $('#area').val(areaValue + 'Whatever you want to enter');
    });
}); 
```

我能想到的突出插入文本的最佳方法是将其包装在一个带有 CSS 类的跨度中，并`background-color`设置为您选择的颜色。在下一次插入时，您可以从任何现有跨度中删除该类（或剥离跨度）。

但是，市场上有很多免费的 WYSIWYG HTML/Rich Text 编辑器，我相信有一款能满足您的需求

*   [**TinyMCE**](http://tinymce.moxiecode.com/examples/full.php) - JavaScript 所见即所得编辑器
*   [**富文本编辑器**](http://developer.yahoo.com/yui/editor/)- YUI 库
*   **[10 个 jQuery 和非 jQuery JavaScript 富文本编辑器](http://www.queness.com/post/212/10-jquery-and-non-jquery-javascript-rich-text-editors)**

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-07-04T01:55:49.177

这是一个适用于 jQuery 1.9+ 的快速解决方案：

a）获取插入符号位置：

```
function getCaret(el) {
        if (el.prop("selectionStart")) {
            return el.prop("selectionStart");
        } else if (document.selection) {
            el.focus();

            var r = document.selection.createRange();
            if (r == null) {
                return 0;
            }

            var re = el.createTextRange(),
                    rc = re.duplicate();
            re.moveToBookmark(r.getBookmark());
            rc.setEndPoint('EndToStart', re);

            return rc.text.length;
        }
        return 0;
    }; 
```

b）在插入符号位置附加文本：

```
function appendAtCaret($target, caret, $value) {
        var value = $target.val();
        if (caret != value.length) {
            var startPos = $target.prop("selectionStart");
            var scrollTop = $target.scrollTop;
            $target.val(value.substring(0, caret) + ' ' + $value + ' ' + value.substring(caret, value.length));
            $target.prop("selectionStart", startPos + $value.length);
            $target.prop("selectionEnd", startPos + $value.length);
            $target.scrollTop = scrollTop;
        } else if (caret == 0)
        {
            $target.val($value + ' ' + value);
        } else {
            $target.val(value + ' ' + $value);
        }
    }; 
```

c) 示例

```
$('textarea').each(function() {
  var $this = $(this);
  $this.click(function() {
    //get caret position
    var caret = getCaret($this);

    //append some text
    appendAtCaret($this, caret, 'Some text');
  });
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-07-09T07:34:46.963

它在 Chrome 20.0.11 中对我有用

```
var startPos = this[0].selectionStart;
var endPos = this[0].selectionEnd;
var scrollTop = this.scrollTop;
this[0].value = this[0].value.substring(0, startPos) + myVal + this[0].value.substring(endPos, this[0].value.length);
this.focus();
this.selectionStart = startPos + myVal.length;
this.selectionEnd = startPos + myVal.length;
this.scrollTop = scrollTop; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-03-27T16:29:31.693

如果您想将内容附加到文本区域而不替换它们，您可以尝试以下操作

```
$('textarea').append('Whatever need to be added'); 
```

根据您的情况，它将是

```
$('a').click(function() 
{ 
  $('textarea').append($('#area').val()); 
}) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-10T08:00:32.067

我认为这会更好

```
$(function() {
$('#myAnchorId').click(function() { 
    var areaValue = $('#area').val();
    $('#area').val(areaValue + 'Whatever you want to enter');
});
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-11-18T13:34:51.293

[此处](https://stackoverflow.com/questions/5203428/inserting-text-after-cursor-position-in-text-are/15945971#15945971)还描述了另一种解决方案，以防某些其他脚本在您的情况下不起作用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-14T13:41:08.257

```
$.fn.extend({
    insertAtCaret: function(myValue) {
        var elemSelected = window.getSelection();
        if(elemSelected) {
            var startPos = elemSelected.getRangeAt(0).startOffset;
            var endPos = elemSelected.getRangeAt(0).endOffset;
            this.val(this.val().substring(0, startPos)+myValue+this.val().substring(endPos,this.val().length));
        } else {
            this.val(this.val()+ myValue) ;
        }
    }
}); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-09-15T15:01:56.000

这类似于@panchicore 给出的答案，但修复了一个小错误。

```
function insertText(element, value) 
{
   var element_dom = document.getElementsByName(element)[0];
   if (document.selection) 
   {
      element_dom.focus();
      sel = document.selection.createRange();
      sel.text = value;
      return;
    } 
   if (element_dom.selectionStart || element_dom.selectionStart == "0") 
   {
     var t_start = element_dom.selectionStart;
     var t_end = element_dom.selectionEnd;
     var val_start = element_dom.value.substring(value, t_start);
     var val_end = element_dom.value.substring(t_end, element_dom.value.length);
     element_dom.value = val_start + value + val_end;
   } 
   else
   {
      element_dom.value += value;
   }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-05-03T10:41:16.057

简单的解决方案是：（*假设：您希望在***文本框中**键入的任何内容都附加到**文本区域**中已有的内容）

在 <a> 标签的**onClick**事件中，编写一个用户定义的函数，它执行以下操作：

```
function textType(){

  var **str1**=$("#textId1").val();

  var **str2**=$("#textId2").val();

  $("#textId1").val(str1+str2);

} 
```

（其中 ids，**textId1** - for o/p textArea **textId2 -for** i/p textbox'）

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2009-11-09T09:44:56.580

我用过它，它工作正常:)

```
$("#textarea").html("Put here your content"); 
```

雷米

# javascript - rails：访问 js.erb 文件中的实例变量

> ID：946537
> 
> 赞同：6
> 
> 时间：2009-06-03T19:02:26.450
> 
> 标签：javascript, ruby-on-rails, ruby, ajax

我正在尝试从 js.erb 文件访问实例变量。

```
#controller
def get_person
  @person = Person.find(1)

  respond_to do |format|
   format.js{}
  end
end

#get_person.js.erb
alert('<%= @person.last_name %>') 
```

当我浏览到 [controller_name_here]/get_person.js ...我在 @person 上收到一个 nil 对象错误。（我知道 Person.find(1) 返回一个对象）

注意：我实际上在我的 js.erb 文件中渲染部分内容时遇到了问题，我正在尝试找出原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T20:59:11.737

以下对我有用：

在`/app/controllers/foo_controller.rb`：

```
class FooController < ApplicationController
  def get_person
    @person = Person.find(1)
    respond_to do |format|
      format.js
    end
  end
end 
```

在`/app/views/foo/get_person.js.erb`：

```
<%= render :partial => '/foo/some_partial', :locals => { :person => @person } %> 
```

在`/app/views/foo/_some_partial.js.erb`：

```
person = {
  last_name: '<%= person.last_name -%>'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T16:48:45.783

js.erb 文件中不再有渲染部分。我今天才发现这个。

[https://github.com/rails/rails/issues/1370](https://github.com/rails/rails/issues/1370)

# css - 我的页面布局是否需要某种 IE 6 hack？

> ID：946541
> 
> 赞同：0
> 
> 时间：2009-06-03T19:02:55.170
> 
> 标签：css, html, internet-explorer-6, cross-browser, positioning

我被告知我的网站[roofcommunityservices.org](http://roofcommunityservices.org/index.html)在IE6 中存在一些div 转换问题。我们办公室没有 IE6，但我确实使用 Firefox 渲染工具查看屏幕截图，我大致了解。我在 Mac 上，看不到与我的客户相同的问题。

有人可以看看 IE6 PC 中的网站并告诉我他们看到了什么，特别是在捐赠页面上吗？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T19:07:38.903

[您可以使用browsershots.org](http://browsershots.org/)查看各种浏览器设置

捐款页面有一些变化。

此外，IE6 不支持透明的 .png 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:09:20.493

我没有在IE6中测试过，我也没有。但一般来说，当我试图查看为什么某些东西不工作时，我做的第一件事就是通过验证器运行它。可悲的是，您的页面在验证器上确实不能很好地运行，并且有很多投诉。

声明“XHTML Strict”然后使用非严格的 html 确实不是一个非常明智的想法。

[http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Froofcommunityservices.org%2Fdonations.html](http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Froofcommunityservices.org%2Fdonations.html)

如果幸运的话，修复 226 验证错误可能会对 IE6 有所帮助。

不同意我的人，尝试将“title”的结束标签更改为“titel”，看看奇迹发生在IE呈现全白页面但firefox不介意的地方。

至于让 Flash 元素进行验证，请参见此处：

[http://latrine.dgx.cz/how-to-correctly-insert-a-flash-into-xhtml](http://latrine.dgx.cz/how-to-correctly-insert-a-flash-into-xhtml) [http://www.alistapart.com/articles/flashsatay](http://www.alistapart.com/articles/flashsatay)

这在过去也很有用，但现在有点过时了：

[http://jquery.lukelutman.com/plugins/flash/](http://jquery.lukelutman.com/plugins/flash/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:07:20.217

看看这里： http: [//www.stalebrew.com/2008/browsers/stand-alone-internet-explorer-6/](http://www.stalebrew.com/2008/browsers/stand-alone-internet-explorer-6/) 您可以下载 Internet Explorer 6 的独立版本来进行此类测试。

另一种选择是使用[http://browsershots.org](http://browsershots.org)查看具有各种操作系统和浏览器选项的网站屏幕截图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T19:07:53.133

一切都很好，除了你在顶部的横幅。当我签入 ff 时，所有子链接都可用。当我在 IE6 中检查时，它们都没有显示出来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T21:40:18.800

除了已经提到的解决方案之外，还有一个名为 IE7（现在也是 IE8）的 javascript 库，它声称可以解决与 IE6 和 IE7 相关的 CSS/PNG 问题。根据我的经验，它确实解决了一些问题，但不是全部。它非常易于使用，您只需要包含 javascript 文件即可。 [http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

以下是有关在英特尔 Mac 上运行 Windows 的一些基本信息。 [http://www.macwindows.com/winintelmac.html](http://www.macwindows.com/winintelmac.html)

Microsoft 免费提供带有 IE6 和 IE7 的 XP SP2 映像（用于测试目的）。请参阅[http://blogs.msdn.com/ie/archive/2006/11/30/ie6-and-ie7-running-on-a-single-machine.aspx](http://blogs.msdn.com/ie/archive/2006/11/30/ie6-and-ie7-running-on-a-single-machine.aspx)

有一个名为 IEtester 的便捷程序（恐怕仅适用于 Windows，但请记住虚拟化/bootcamp），它可以帮助您在 IE5.5、6、7 和 8 中查看您的页面。 [http://www.my-debugbar.com /wiki/IETester/主页](http://www.my-debugbar.com/wiki/IETester/HomePage)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T19:09:36.343

看起来您的导航菜单在 IE 6 中完全丢失了。

[http://tinypic.com/r/35l7pc6/5](http://tinypic.com/r/35l7pc6/5)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T19:12:20.283

使用带有 IE6 的运行 XP 的虚拟机来测试您的布局可能是谨慎的做法。而且，正如其他人所提到的，通过验证器 (w3) 运行您的网站并解决这些验证错误可以为您提供一个很好的起点，以查明一些随机显示问题。特别是如果您有很多非封闭标签。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-03T19:10:33.487

忘记 IE6

各位，我们已经在 IE8 上了。就像IE6出来的时候支持IE4一样……

# user-interface - 给定背景颜色的良好文本前景色

> ID：946544
> 
> 赞同：76
> 
> 时间：2009-06-03T19:03:37.557
> 
> 标签：user-interface, text, colors, background-color

我正在绘制一个颜色选择按钮，我正在寻找一个漂亮而简单的公式来为 RGB 中的给定背景颜色获得良好的文本颜色（前景）。

一个简单的尝试是只取补色，但这会为纯蓝色或纯红色等颜色生成一个奇怪的按钮。
有没有众所周知的事情可以做到这一点？

如果这很重要，我正在使用 QT。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-06-03T19:38:53.817

为了获得最大的易读性，您需要最大的亮度对比度，而不会陷入无法协同工作的色调。最一致的方法是坚持使用**黑色**或**白色**作为文本颜色。你也许可以想出更美观的方案，但没有一个更清晰易读。

要在黑色或白色之间进行选择，您需要知道背景的亮度。由于两个因素，这变得有点复杂：

*   单个原色红色、绿色和蓝色的感知亮度并不相同。我能给出的最快建议是使用传统公式将 RGB 转换为灰色 - R*0.299 + G*0.587 + B*0.114。还有很多其他的公式。

*   应用于显示器的伽马曲线使中间灰度值高于您的预期。这很容易通过使用 186 而不是 128 作为中间值来解决。任何小于 186 的都应该使用白色文本，任何大于 186 的都应该使用黑色文本。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T19:09:33.300

我不是 RGB 相关编程方面的专家，但从设计师的角度来看，通常最易读的颜色只是颜色较浅（如果背景颜色较暗）或更暗（如果背景颜色较浅）的版本相同的阴影。

基本上你会取你的 RGB 值，如果它们更接近 0（暗），你会为你的前景色将它们每一个推上等量，反之亦然，如果它是一个浅色 BG。

为了可读性，补色实际上会让眼睛很痛苦。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-03-27T23:48:34.833

**利用大纲提高可读性**

如果在用户选择时通过*“良好的文本颜色（前景）”*将其用于**易读性**`any background colour`目的，则始终可以生成具有黑色轮廓的白色文本。它可以在任何纯色、图案或渐变背景上清晰可见，从黑色到白色以及介于两者之间的任何东西。

![在此处输入图像描述](https://i.stack.imgur.com/LhqKS.jpg)

即使这没有达到您的意图，我认为值得在这里发布，因为我来寻找类似的解决方案。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-07-17T18:12:01.063

基于 Mark 的响应，这里有一些 Ruby 代码可以完成这项工作

```
rgbval = "8A23C0".hex
r = rgbval >> 16
g = (rgbval & 65280) >> 8
b = rgbval & 255
brightness = r*0.299 + g*0.587 + b*0.114
return (brightness > 160) ? "#000" : "#fff" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T19:24:47.857

亮度差异较大时您会更好。一般来说，带有彩色文本的彩色背景会降低可读性，随着时间的推移会伤害眼睛。带有黑色文本的浅色（例如，HSB，S~10%，B>90%）可以正常工作，或者黑色背景上的浅色文本效果很好。我会远离两种颜色。在白色背景上带有微妙色彩的深色文本（b~30%，s>50%）也可以。深蓝色背景上的黄色（琥珀色）文本具有出色的可读性，黑色上的琥珀色或绿色也是如此。这就是为什么旧的哑词（vt100、vt52 等）选择这些颜色的原因。

如果你真的需要为“外观”做颜色上的颜色，你可以反转 H 和 B，同时将饱和度固定在中等到低的水平。

最后一点：如果您有 50% 的灰色背景，请重新考虑您的界面。你正在抢夺你一半的动态范围！您正在疏远低知名度的用户，包括 35 岁以上的任何人...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T19:20:49.003

如果不仔细选择，颜色组合通常看起来很糟糕。为什么不使用白色或黑色作为文本，取决于颜色的亮度。（需要先转换为 HSB。）

或者让用户选择黑色或白色文本。

或者使用预定义的组合。这就是谷歌在他们的日历产品中所做的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-24T14:34:59.983

我一直在寻找一个 simailr 的答案，并遇到了这篇文章和其他一些我认为我会分享的帖子。根据[http://juicystudio.com/services/luminositycontrastratio.php#specify](http://juicystudio.com/services/luminositycontrastratio.php#specify) “WCAG 2.0 的成功标准 1.4.3 要求文本的视觉呈现和文本图像的对比度至少为 4.5:1”，其中一些例外。该站点允许您输入前景色和背景色来计算它们的对比度，尽管如果它会建议替代品或范围会很有帮助。

我发现的用于可视化颜色对比度的最佳网站之一是[http://colorizer.org/](http://colorizer.org/)它可以让您同时调整几乎所有方式的色标（RGB、CMYK 等），然后显示结果在屏幕上，例如黄色背景上的白色文本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T19:10:21.147

我通常看补色，他们也有补色轮来帮助

[http://www.makart.com/resources/artclass/cwheel.html](http://www.makart.com/resources/artclass/cwheel.html)

如果您的颜色是 HSL，请将色相翻转 180 度以获得不错的计算

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-03T19:16:35.360

我认为转换为 HSV 可能是一种方式，但 IMO 改变色调看起来很奇怪。我会尝试保持色调并调整值和饱和度（浅红色按钮和深红色文本......嗯听起来很可怕:-)）。

# cmd - 如何在 WinXP cmd shell 中加载 ANSI 转义码或获取彩色文件列表？

> ID：946546
> 
> 赞同：11
> 
> 时间：2009-06-03T19:03:45.543
> 
> 标签：cmd, ansi, unix

这与[这个](https://serverfault.com/questions/18362/how-to-get-coloured-file-listing-in-windows-cmd-shell/18391#18391)问题有关：*[如何在 windows cmd shell 中获取彩色文件列表？](https://serverfault.com/questions/18362/how-to-get-coloured-file-listing-in-windows-cmd-shell/18391#18391)*

我正在尝试获取 Windows cmd shell 中的彩色文件列表，您不相信吗？Windows 是 XP SP2，如果这很重要的话。
在过去的 DOS 时代，曾经有一些小程序，如 hdir、adir 等，它们显示得很好。如今，此类节目已不复存在。

但是，*ls*来自 unixkit-tiny 或 unixtools。不幸的是，它使用 ANSI 转义码来显示颜色，而 cmd 不能很好地处理这些。

有几种解决方案包括加载 ansi.sys 和 command.com，但 command.com 不能很好地处理长文件名，而且速度非常慢。即使这样，有时它也有显示颜色的问题。

所以我要问的是，除了使用 cygwin 之外，有没有办法在 windows cmd shell 中获取彩色文件列表？或者有没有办法让 ANSI 转义码以某种方式与 cmd.exe 一起使用，以便本机*ls*可以很好地发挥作用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-11-18T21:21:33.280

~~[我在http://adoxa.110mb.com/ansicon/index.html](http://adoxa.110mb.com/ansicon/index.html)~~ [ansicon github repo](https://github.com/adoxa/ansicon)遇到了 ANSICON

使用它为 NAnt 输出着色。ls --color 正在正确处理。

提供了源代码，但我没有检查它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-14T13:59:38.193

实际上我认为 ansicon 是 A+——使用

*   **ansicon.exe -我**

将其安装为 CMD.exe 会话上的过滤器。与 HTTY（红宝石）一起使用。

:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T19:16:48.370

您可以启动内置的 Telnet 服务器，将其设置为仅允许`localhost`访问，并使用能够理解此类转义的 telnet 客户端 - 甚至是本机客户端。（我知道，一个丑陋的黑客。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T19:17:37.653

可以修补 cmd.exe....

[http://gynvael.coldwind.pl/?id=130&lang=en](http://gynvael.coldwind.pl/?id=130&lang=en)

# c# - Safari - 显示过期的 .NET 页面

> ID：946547
> 
> 赞同：2
> 
> 时间：2009-06-03T19:03:54.763
> 
> 标签：c#, asp.net, security, safari

我们在 Safari 中遇到了一个奇怪的问题。当用户退出我们的 Web 应用程序时，我们会使用以下内容使表单身份验证过期

```
 FormsAuthentication.SignOut();
 Session.Abandon(); 
```

这在 IE 和 Firefox 中运行良好（当用户点击后退按钮时，他们会看到页面过期消息并被迫登录），但在 Safari 中，用户正在处理的最后一页会显示。我尝试了许多建议的想法，例如设置 Response.Expires 但没有任何帮助，有人遇到过这个问题吗？你有什么建议/解决方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:16:20.790

您确定该页面不只是缓存在浏览器上吗？

您是否尝试过点击后退按钮，然后单击一些链接？它会提示您登录吗？

对我来说，这听起来像是浏览器缓存。

也许你可以尝试：

```
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache" /> 
```

但是，我不完全确定这会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:19:36.837

您使用的是 Safari 4 测试版吗？如果是这样，我也遇到了同样的问题。不确定是什么原因造成的，尽管我认为 cookie 破坏处理不当。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:26:02.860

听起来 Safari 正在显示页面的缓存副本。

您可能想阅读[从 ASP.NET 为所有浏览器禁用浏览器缓存](https://stackoverflow.com/questions/914027/disabling-browser-caching-for-all-browsers-from-asp-net)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-30T11:58:27.650

*我尝试联系苹果，目前没有答案。* **问题仍然存在。**

同时（仅用于您的测试 - 并且可能作为对您的用户的建议）：转到**DEVELOP** > **DISABLE CACHES**，它现在应该可以按预期工作。

# asp.net - Asp.Net 登录控制与非受信任 AD 域的初始连接非常慢

> ID：946550
> 
> 赞同：2
> 
> 时间：2009-06-03T19:04:16.633
> 
> 标签：asp.net, active-directory

当验证到与 Web 服务器所属域不同的域时，ASP.NET 登录控件与 AD 的初始连接非常慢。IIS 服务器以及与 Visual Studio 的内置 Web 服务器一起使用时会出现问题。

第一次尝试使用控件连接到另一个域时大约需要 30 秒。Web 服务器的域和其他域之间没有信任关系（尝试连接到几个不同的域）。后续连接会快速执行，直到连接超时。

使用 Systernals Process Monitor 进行故障排除，在延迟到“C:\WINDOWS\asembly\GAC_MSIL\System.DirectoryServices\2.0.0.0_b03f5f7f11d50a3a\Netapi32.dll with a result NAME NOT FOUND”之前和之后有两个 OpenQuery 操作TCP 发送和 TCP 接收延迟 30 秒，表明与 AD 服务器的通信开始。

我们尝试过的事情：

*   在 web.config 中模拟 Web 服务器上的管理员；
*   将 CryptoKeys 的权限授予 NetworkService 和 ASPNET；
*   通过 IP 而不是 DNS 名称指定；
*   使用域和 OU 指定名称和 ldap 服务器的多种变体；
*   本地主机条目；
*   使用 netstat -an 查找被阻塞的端口 (SYN_SENT)。
*   Nslookup 可以正确解析所有涉及的域和系统。
*   TraceRt 显示正确的路线

任何想法或提示都非常受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-10T16:17:55.877

我们最终修复了它

连接保护=“无”

关闭安全端口上的所有连接尝试，仅使用 389。

在 connetionProtection 更改后，我们还必须指定 Connection 用户名，例如“ad/bob”，而不仅仅是“bob”。

谢谢，

埃里克-

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T15:15:57.437

我遇到过同样的问题。遵循这个建议似乎已经对其进行了排序。

[https://elgg.leeds.ac.uk/webteam/weblog/15385.html](https://elgg.leeds.ac.uk/webteam/weblog/15385.html)

我们有一个自定义用户作为应用程序池用户运行，授予用户对该目录“C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys”的读取权限 对问题进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-26T12:40:33.113

> 如果您安装了 .NET 2.0 SP1，只需将以下内容添加到 machine.config 中（当然所有站点将不再检查威瑞信）

```
<runtime>
   <generatePublisherEvidence enabled="false"/>
</runtime> 
```

[http://forums.asp.net/t/968778.aspx](http://forums.asp.net/t/968778.aspx)

# wpf - 如何在不失去焦点的情况下将部分输入从一个控件转发到另一个控件？

> ID：946553
> 
> 赞同：0
> 
> 时间：2009-06-03T19:05:43.823
> 
> 标签：wpf, treeview, focus

使用 WPF 如何执行与 Skype 联系人窗口中类似的操作？我希望能够用鼠标按下任何列表项，当我开始输入时能够使用向上/向下导航和过滤联系人。我还想显示我在分隔的 TextBox 中输入的内容。

到目前为止，我已经通过 TextBox 设置了所有过滤。我可以在 TreeView 获得焦点时使用箭头导航，并在 TextBox 中输入文本时进行过滤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T21:21:18.120

我没有Skype，但是如果我很好地理解了您的问题，我认为您必须从键盘上捕捉那些向上/向下键并将它们发送到您的树视图。

...或者也许[这个链接](http://www.telerik.com/community/forums/wpf/treeview/filtering-in-treeview.aspx)有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T02:52:45.377

您可能对 PreviewXXXX 功能感兴趣，它可以让您在按键到达列表框之前捕捉它们。

# c++ - 您是否尝试过使用 SQLite 作为您的 *raw* 数据库的查询引擎？

> ID：946555
> 
> 赞同：3
> 
> 时间：2009-06-03T19:07:01.730
> 
> 标签：c++, database, sqlite, reporting

我为*我们的*数据库（[Oracle Berkeley DB](http://www.oracle.com/technology/products/berkeley-db/db/index.html)引擎）制作了一个自定义报告生成器。
现在是我增加更多灵活性的时候了，我处于两难境地。进行部分或基本的重新设计？

1.  假设我有足够的时间。
2.  我只能读取数据库，我没有修改它的权限。

[受用SQLite 查询任何东西的](http://www.ddj.com/database/202802959)文章的启发，我想让[SQLite](http://www.sqlite.org/)引擎做一些*繁琐*的工作（分组、过滤等）。

你试过了吗？有什么例子吗？性能问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:20:41.623

它适用于我正在使用的东西:-) 但是我不将它与另一个数据库一起使用，只是独立使用。在他们的网站上有一个 SQlite[的知名用户](http://www.sqlite.org/famous.html)列表。

您需要告诉我们更多关于您的用例的信息，以便对性能做出任何推测，但我宁愿做一个 POC 并测量性能[长期持有的、不正确的编程假设](https://stackoverflow.com/questions/888224/what-is-your-longest-held-programming-assumption-that-turned-out-to-be-incorrect/888766#888766)

[sqlite](http://www.sqlite.org)网站上有一篇不错的[快速入门](http://www.sqlite.org/quickstart.html)文章。

这是[C/C++ API 参考](http://www.sqlite.org/c3ref/intro.html)。

我假设您应该能够通过最初查询其他数据库并将数据插入临时 SQLite 表来创建临时 SQLite 表。然后，您可以对该临时表使用不同的查询来进行分组、过滤等。

# c# - Visual Studio 组件设计人员可以访问和修改项目 .config 文件吗？

> ID：946563
> 
> 赞同：2
> 
> 时间：2009-06-03T19:08:09.370
> 
> 标签：c#, .net, visual-studio, components, designer

组件*设计人员*可以在设计时访问和修改项目的 app.config 或 web.config 文件吗？更具体地说，VS 是否有一些托管服务可以“以正确的方式”做到这一点？我知道我可以自己找到 .config 文件，打开它并随心所欲地使用它，但我希望它通过 VS 认可的方式，主要是因为源代码控制集成问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T23:19:22.400

VS 可以并且会出于各种原因编辑您的网络/应用程序配置。此外，在某些情况下，VS 工具会为您提供文件部分的 GUI（我猜这就是您所追求的）。但在大多数情况下，您所说的“正确方法”是手动编辑它。

如果您的项目足够大，您也可能会遇到 CI 问题并部署到多个服务器，这意味着编写配置文件部分的生成脚本。

值得一提的最后一件事是，您不应该寻找 MS 有福的方法来处理任何事情，您应该根据自己的需要提出最实用的方法，并掌握所有事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T16:36:57.257

您可以连接一个[**`IEventBindingService`**](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.ieventbindingservice(VS.80,loband).aspx)（我链接到 .NET 2.0 版本，也有 1.1、3.0 和 3.5 版本）

页面摘录：

> 事件绑定服务提供了一种将事件处理程序与设计器代码中的组件事件链接的方法。

您可以将自定义 app.config 操作代码放入您公开的事件处理程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:00:14.637

组件设计师？¿

你的意思是编程吗？[http://www.beansoftware.com/ASP.NET-Tutorials/Modify-Web.Config-Run-Time.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Modify-Web.Config-Run-Time.aspx)

# wpf - 水平拉伸 WPF 画布

> ID：946574
> 
> 赞同：9
> 
> 时间：2009-06-03T19:10:22.283
> 
> 标签：wpf, silverlight, canvas, wpf-controls, stretch

如何`Canvas`以可变宽度完全水平拉伸？这是父母`Canvas`，所以它没有父母，只有孩子。

XAML 源：它显示在混合 [http://resopollution.com/xaml.txt](http://resopollution.com/xaml.txt)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-03T19:29:51.607

使用 a`Grid`作为 UI 中的顶级元素 - 它会拉伸以填充其容器。然后在里面放一个`Canvas`with ，它会按照你想要的方式运行。`HorizontalAlignment="Stretch"``Grid`

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <Canvas Background="Blue"/>
</Grid> 
```

这对我有用。关键是您的顶级 UI 元素。虽然`Grid`默认情况下 a 会填充所有可用空间，但`Canvas`es 仅占用其内容所需的空间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T19:18:42.173

我猜你已经试过了
`canvas.HorizontalAlignment = HorizontalAlignment.Stretch`

如果这不起作用，那么您可以做的是将画布的 and 属性`Width`绑定到包含窗口的and属性。`Height``ActualWidth``ActualHeight`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:05:42.330

问题是您正在指定`Height`and `Width`。如果没有这些属性，控件可能会在设计器中消失，但是当您将画布插入另一个控件时，它的大小应该适当。

如果我没记错的话，WPF 的下一个版本将具有“DesignWidth”和“DesignHeight”属性，它们允许您在设计器中显示具有给定大小的控件，而不会在插入其他控件时影响其测量值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T19:12:35.180

您可以使用停靠面板来填充可用宽度。停靠面板控件列表中的最后一项会自动拉伸以填充剩余空间。

```
<DockPanel>
   <Canvas />
</DockPanel> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T19:16:18.293

除非您手动设置高度和/或宽度，否则画布应自动执行此操作。你想把画布放在什么样的控件上？你可以发布你的代码吗？

# entity-framework - 如何在不使用实体框架中的所有实体键的情况下进行关联？

> ID：946578
> 
> 赞同：1
> 
> 时间：2009-06-03T19:11:23.843
> 
> 标签：entity-framework, ado.net

我对EF越来越失望...

我有一个名为 ExtendedField 的表，其中包含：

记录
DocRef DocType
名称

Record 是主键
DocRef 和 DocType 是外键，用于标识它们属于哪个 Ticket
Name 是“定义”表用来定义字段实际是什么的键

所以基本上我需要2个关联：

> ExtendedField.DocRef=ticket.record 和 ExtendedField.docType=HeaderDocType 上的 Ticket 和 ExtendedField 之间的一个
> 
> ExtendedField.Name=Definition.FieldName 上的定义之一

然后我仍然需要 Record 作为主键，这样我就可以直接访问这些字段。

据我所知，这在实体框架中是不可能的。对于每个关联，所有键都需要映射在一起，而我需要两个键用于一个关联，1 个键用于另一个关联，实际的主键不会在任何关联中使用。

您似乎也无法定义不是实体键的字段之间的关联。

那么有没有办法做到这一点？我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T02:07:11.600

这是v1，兄弟。我自己在 EF 中映射关键约束时遇到了一些重大痛苦。我听说在 v2 中会有更好的东西。

# hash - MD5 逆恒等式： (X,Y) 是否存在使得 md5(X)=Y 和 md5(Y)=X

> ID：946580
> 
> 赞同：16
> 
> 时间：2009-06-03T19:12:10.860
> 
> 标签：hash, md5

是否存在两个相互散列的 128 位值？

```
Find (X,Y) such that md5(X) = Y and md5(Y) = X 
```

不用蛮力就能找到它们吗？

额外加分：我可以编造术语“md5-itive inverse identity”吗？

解决方案集将是稀疏的，即使不是空的。

对于你今天的 LOL，来吧：

[https://github.com/flipmcf/playground/tree/master/md5-inverse-search](https://github.com/flipmcf/playground/tree/master/md5-inverse-search)

### 有关的：

[MD5 定点](https://stackoverflow.com/questions/235785/md5-fixed-point)
[MD5 哈希冲突](https://stackoverflow.com/questions/1756004/can-two-different-strings-generate-the-same-md5-hash-code)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-13T19:23:04.760

[（阅读此链接](http://echochamber.me/viewtopic.php?f=12&t=29547)时找到了两个答案）...

要回答问题 (1)，请考虑以下几点：

> 强制所有 md5(x)=x 意味着检查 2.4x10^38 值。我的快速测试实现每小时可以测试一些 2.3x10^9 的值，这意味着它几乎需要 10^29 小时来强制它。假设我有 100 万人来帮助我，那么我们将缩短到 10^23 年。假设通过一些巧妙的优化，算法的速度提高了 100 万倍，而我们缩短到了 10^17 年。让我们假设计算机在一夜之间变得快了一百万倍，而我们的时间缩短到了 10^11 年，这比宇宙存在的时间要长得多。

我想通过一些智能力算法可以更快地剔除上述内容†。

要回答问题（2），以下两个块具有相同的 md5 哈希：

```
d131dd02c5e6eec4693d9a0698aff95c 2fcab58712467eab4004583eb8fb7f89
55ad340609f4b30283e488832571415a 085125e8f7cdc99fd91dbdf280373c5b
d8823e3156348f5bae6dacd436c919c6 dd53e2b487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080a80d1e c69821bcb6a8839396f9652b6ff72a70 
```

和

```
d131dd02c5e6eec4693d9a0698aff95c 2fcab50712467eab4004583eb8fb7f89
55ad340609f4b30283e4888325f1415a 085125e8f7cdc99fd91dbd7280373c5b
d8823e3156348f5bae6dacd436c919c6 dd53e23487da03fd02396306d248cda0
e99f33420f577ee8ce54b67080280d1e c69821bcb6a8839396f965ab6ff72a70 
```

两个块之间相差 6 个字节（字节 39、91、119、167、219 和 247），哈希为`79054025255fb1a26e4bc422aef54eb4`. 我想这些块是由某种智能力算法发现的†，尽管我不确定。

†：蛮力考虑到 md5 分析的弱点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T15:51:34.157

这与 Kember 身份搜索不同。

考虑以下情况的差异：

```
md5(X) == X 
```

为此，X 必须是 128 位值。

这与以下内容不同：

```
bin2hex(md5('string')) == 'string' 
```

这正是 Kember Identity Search 真正寻求的。如果您查看他们网站上的任何搜索实现，您可以很容易地看到他们使用 32 个字符的字符串，而不是 128 位数字，作为 md5 函数的输入，因此不寻找 md5 (X) == X。

我也不是第一个指出这一点的人，你可能会发现[这篇文章直接针对 Kris Thompson 的“Kember Identity”很有](http://acodingfool.typepad.com/blog/2009/05/the-kembler-identity.html)启发性。

# javascript - 浏览器后退按钮和动态元素

> ID：946582
> 
> 赞同：7
> 
> 时间：2009-06-03T19:12:17.927
> 
> 标签：javascript, jquery, dom

我有一个页面，它使用 jQuery 根据用户从框中选择的内容动态创建许多**`<input>`**DOM 元素。**`<select>`**

假设用户从选择框中选择 4，我的脚本会动态显示 4 个输入框。

问题是当用户刷新或返回此页面时（使用浏览器返回按钮）。动态创建的元素不会重新填充到它们的最后值，而所有其他“静态”元素都是。

我在想我可以创建一个**隐藏的输入，该输入将通过 javascript 与动态框的内容进行序列化，然后在****$document.ready**上从中读取，然后重新填充我的框。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T19:25:56.543

legenden - 有很多可能的解决方案，我会查看这些历史插件：

*   [历史遥控器](http://stilbuero.de/jquery/history/)
*   [jQuery 历史插件](http://www.mikage.to/jquery/jquery_history.html)
*   [深度链接插件](http://www.asual.com/jquery/address/)

他们有点烦躁，但你应该能够破解一些积极的东西。我还要补充一点，这可以通过将动态元素存储在 cookie 中并以某种方式重新填充来完成。查看[jQuery Cookie 插件](http://plugins.jquery.com/project/Cookie)。希望能帮助您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:16:59.213

如果您希望事情以这种方式工作，您需要自己管理历史。你需要[真正简单的历史](http://code.google.com/p/reallysimplehistory/)。

# bazaar - 什么是 bzr 命令来恢复

> ID：946584
> 
> 赞同：3
> 
> 时间：2009-06-03T19:12:22.747
> 
> 标签：bazaar, revert

简单的问题。

我已经下载了 gnome-do 并且开始学习它。

我错误地删除了一个文件，现在我想用最新版本更新它。

执行此操作的 bzr 命令是什么？

我试过 bzr update 但它总是说我是最新的:(

删除的文件看起来像是未提交的更改。回滚该更改的 bzr 选项是什么？我尝试过还原，但只删除了整个项目的先前版本，并没有恢复我删除的文件:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T19:29:04.820

```
bzr revert <file> 
```

这将带回文件。

# flash - 在 Flash 中获取最后渲染的屏幕光栅

> ID：946592
> 
> 赞同：2
> 
> 时间：2009-06-03T19:14:37.033
> 
> 标签：flash, actionscript-3, rendering

AS3 中有没有办法访问舞台的最后一个渲染？该渲染结果是否缓存在可访问的地方？我特别不能自己将舞台重新渲染到位图，因为那太昂贵了，这就是我尝试使用最后一个渲染的原因。

我需要这个，因为我试图在屏幕的某些特定范围内做一些热变形效果，而在 2D 中做到这一点的标准方法是使用置换贴图来抖动原始图像。当然，我对在 Flash 中进行热变形的其他想法持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:53:41.023

我很确定我们无权访问它（尽管我真的不明白为什么）。我知道flash只会重绘舞台从一帧到另一帧的变化。您可以通过右键单击 Flash 调试播放器并选择“显示重绘区域”来看到这一点。

您可以尝试查看人们使用[Convolution Filter](http://injun.ru/flash10api/flash/filters/ConvolutionFilter.html)和[Displacement Map Filter](http://injun.ru/flash10api/flash/filters/DisplacementMapFilter.html)所做的事情。这里有些例子：

*   [水波纹 - David Lenaerts](http://www.derschmale.com/2008/08/03/water-ripples-revisited-as3-only-version/)
*   [雨效果 - 斯科特摩根](http://www.scottgmorgan.com/blog/index.php/tag/convolutionfilter/)

这些示例似乎运行良好，速度很快，尽管它们的舞台尺寸非常小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:05:30.770

我 99.9% 肯定你不能。我以前从未遇到过任何提及。不过会是一个很棒的功能。抱歉，我知道这不是特别有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-29T06:43:45.150

如果您不介意需要 Flash Player 10，您可以尝试将自定义 Pixel Bender 过滤器附加到要扭曲的舞台或 DisplayObject。

但是，如果 Flash 在幕后创建一个缓存位图，就像它为标准过滤器所做的那样，那么性能不会比创建您自己的位图更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T18:26:07.317

您无法访问栅格，但有一种解决方法。

不要让您的应用程序 Sprite（或 MovieClip）坐在舞台上，而是将您的应用程序精灵绘制到位图上并将其放置在舞台上。这样您只渲染一次，但可以从最后一次渲染访问位图。

缺点是 Flash 会在每一帧渲染您的所有应用程序精灵（不仅仅是脏矩形）。

# java - 将字节转换为位

> ID：946593
> 
> 赞同：5
> 
> 时间：2009-06-03T19:14:49.857
> 
> 标签：java, types, byte, bitset

我正在使用java。

我有一个字节数组（数组的每个位置都有 8 位），我需要做的是将数组的 2 个值放在一起并得到一个值。

我会尝试更好地解释自己；我正在从音频文件中提取音频数据。此数据存储在字节数组中。每个音频样本的大小为 16 位。如果数组是：

字节[] 音频数据；

我需要从样本 audioData[0] 和 audioData[1] 中获取 1 个值，以便获取 1 个音频样本。

谁能解释我如何做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T19:20:51.950

我不是 Java 开发人员，所以这可能完全不合时宜，但是您是否考虑过使用[ByteBuffer](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/ByteBuffer.html)？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T19:20:12.250

假设 LSB 在 data[0]

```
int val;

val = (((int)data[0]) & 0x00FF) | ((int)data[1]<<8); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-26T02:46:14.013

```
ByteInputStream b = new ByteInputStream(audioData);
DataInputStream data = new DataInputStream(b);
short value = data.readShort(); 
```

上述代码的优点是您可以以相同的方式继续读取其余的“数据”。

仅针对两个值的更简单的解决方案可能是：

```
short value = (short) ((audioData[0]<<8) | (audioData[1] & 0xff)); 
```

这个简单的解决方案提取两个字节，并将它们组合在一起，第一个字节是高位，第二个字节是低位（这被称为 Big-Endian；如果您的字节数组包含 Little-Endian 数据，您将移位第二个字节代替 16 位数字；对于 Little-Endian 32 位数字，您必须颠倒所有 4 个字节的顺序，因为 Java 的整数遵循 Big-Endian 顺序）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:22:18.287

如前所述，Java 有一些类可以帮助您解决这个问题。[您可以使用ByteBuffer](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/ByteBuffer.html)包装您的数组，然后获取它的[IntBuffer](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/IntBuffer.html)视图。

```
ByteBuffer bb = ByteBuffer.wrap(audioData);
// optional: bb.order(ByteOrder.BIG_ENDIAN) or bb.order(ByteOrder.LITTLE_ENDIAN)
IntBuffer ib = bb.asIntBuffer();
int firstInt = ib.get(0); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-13T11:01:45.840

Java中将字节数组解析为位的更简单方法是[使用JBBP](https://code.google.com/p/java-binary-block-parser/)

```
 class Parsed { @Bin(type = BinType.BIT_ARRAY) byte [] bits;}
  final Parsed parsed = JBBPParser.prepare("bit:1 [_] bits;").parse(theByteArray).mapTo(Parsed.class); 
```

代码会将每个字节的解析位作为 8 个字节放在 Parsed 类实例的位数组中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T19:23:17.687

您可以通过将两个字节进行逻辑或运算来转换为`short`（2 个字节）：

```
short value = ((short) audioData[0]) | ((short) audioData[1] << 8); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-10T09:50:28.163

我建议你看看[Preon](http://preon.flotsam.nl/)。在 Preon 中，你可以这样说：

```
class Sample {

  @BoundNumber(size="16") // Size of the sample in bits
  int value;

}

class AudioFile {

  @BoundList(size="...") // Number of samples
  Sample[] samples;

}

byte[] buffer = ...;
Codec<AudioFile> codec = Codecs.create(AudioFile.class);
AudioFile audioFile = codec.decode(buffer); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-11T15:22:55.143

你可以这样做，没有库或外部类。

```
byte myByte = (byte) -128;
for(int i = 0 ; i < 8 ; i++) {
    boolean val = (myByte & 256) > 0;
    myByte = (byte) (myByte << 1);
    System.out.print(val ? 1 : 0);
}
System.out.println(); 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2010-11-22T01:20:29.173

```
byte myByte = 0x5B;

boolean bits = new boolean[8];

for(int i = 0 ; i < 8 ; i++)
    bit[i] = (myByte%2 == 1); 
```

结果是一个由 0 和 1 组成的数组，其中`1=TRUE`和`0=FALSE`:)

# ssl - 通过 SSL 与防火墙的 C# Web 服务

> ID：946594
> 
> 赞同：1
> 
> 时间：2009-06-03T19:14:57.593
> 
> 标签：ssl, service, firewall

我们允许用户拨入我们的系统。

我们在拨入系统上运行防火墙，默认情况下会阻止所有访问，并且我们只允许通过添加特定规则来访问某些服务器。

我们有一个与我们的服务器联系的网络服务。服务调用通过 SSL 进行。

SSL 证书来自 GoDaddy。

我们发现，当第一次连接到服务时，某些东西会尝试验证 SSL 证书。我们看到通过端口 80 丢弃到 Microsoft IP 地址的数据包。

如果我们允许访问 Microsoft IP，则该软件可以完美运行。

问题是 IP 是随机的，所以我一直在添加一些不同的 IP 主机。

看起来像是某种类型的 SSL 验证系统或其他东西……有人遇到过这样的事情吗？或者知道我可以在防火墙中允许的 IP 或主机名块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T22:29:57.580

It smells like browser is trying to connect to a [CRL](http://en.wikipedia.org/wiki/Certificate_revocation_list) server. Try to reverse-resolve the IP addresses to a domain name and you should get some clue.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:19:25.073

最有可能尝试联系证书颁发机构 (CA) 以验证 SSL 证书。

# openid - 在 Azure 中使用 OpenID 身份验证的最佳方式是什么？

> ID：946595
> 
> 赞同：5
> 
> 时间：2009-06-03T19:15:03.897
> 
> 标签：openid, azure, dotnetopenauth

我正在努力让 OpenID 在 Windows Azure 应用程序上运行。我目前正在使用 DotNetOpenAuth（以前是 DotNetOpenID），首先我遇到了中继步骤的问题，因为 Azure 在内部使用端口 20000，并且来回传递。我找到了解决方法（我会为此写一篇博文）。

下一个问题是在网络场（多个实例）上运行应用程序时，您需要为 DotNetOpenAuth 编写自己的“自定义存储”并将数据保存在数据库中。这是一个痛苦的写作。

必须有一个更简单的方法。也许是 Azure 服务之一？有没有人在 Azure 上成功运行了一个使用 OpenID 进行身份验证的 Web 应用程序？最好或推荐的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T06:02:39.933

最简单的方法是根本不使用商店。如果您正在使用它们，您可以在其中一个登录控件上设置 Stateless=true，或者传递`null`给`OpenIdRelyingParty`构造函数。这会将您的网站置于 OpenID 无状态或“哑”模式。用户登录的速度稍慢（如果您注意到的话），并且您不必编写该数据库存储类。

或者，您可以[投票支持更多预先编写的数据存储，包括](http://dotnetopenauth.uservoice.com/pages/14800-general/suggestions/146036-add-standard-sql-stores-that-assume-a-certain-db-schema)在 UserVoice 上为 Azure 提供的一个。

顺便说一句，DotNetOpenAuth v3.1 中[应该已经修复了 Azure 端口问题。](http://dotnetopenauth.net:8000/ticket/33)如果不是，请重新激活该票。

# flash - inluxis flv 流媒体（闪存）

> ID：946598
> 
> 赞同：0
> 
> 时间：2009-06-03T19:15:44.363
> 
> 标签：flash, stream, flv, rtmp

这次我通过 RTMP 构建一个 flv 播放器，我的服务器是 influxis (.com)。

几个月前，我构建了一个通过 HTTP 流式传输的视频播放器，但该播放器无法通过 RTMP 工作，所以我想知道是否有人知道或知道在哪里可以获取示例 fla 文件，以便识别元素和 AS .

我只需要播放暂停和停止动作，没有音量，没有搜索栏等。

或者，如果有人知道如何构建它，任何帮助任何想法都会受到欢迎！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T18:47:05.453

您的播放器是否使用 netstream 连接？这应该就是你所需要的。使用流媒体视频时，您从不使用 flv 扩展，因此路径应为：rmpt://location.com/applicationdirectory

有关使用 netstream 的视频播放器教程，请参见[http://www.gotoandlearn.com](http://www.gotoandlearn.com)

# validation - 文本验证中的本地化

> ID：946602
> 
> 赞同：0
> 
> 时间：2009-06-03T19:16:23.363
> 
> 标签：validation, localization

我最近意识到，一些国家/地区使用不同的逗号/句点表示法显示浮点数。

IE。我们将有 12,500.34，有些国家将其列为 12.500,34

这可能不是显示的问题，但是文本输入呢？例如，我想如果我有一个小数类型并将其显示在标签中，那么 ToString() 方法（或您选择的语言中的等价物）将使用本地化设置并正确显示它，以及各种解析 'str ->number' 方法可能也会起作用。

但是文本验证呢？比如我想要一个文本框只允许 5 个数字，然后是一个可选的小数点和最多 4 个数字？当您不知道它们的分隔符是什么时，这种情况下的常见解决方案是什么？显然我现在使用的硬编码正则表达式模式会失败，所以我只是想知道你们中的一些人在这些情况下做了什么？

感谢您的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:29:44.540

无论它们生活在哪里，或者无论它们是如何被指定的，您都需要封装特定于或可能特定于区域设置的规则，或者正在解析可能特定于区域设置的输入（用于验证）。这样，您可以根据语言环境切换实现。

根据它们的方式和位置，您可以使用一些框架（[JPF 这样做](http://beehive.apache.org/docs/1.0/apidocs/classref_netui/org/apache/beehive/netui/pageflow/annotations/Jpf.ValidationLocaleRules.html)）在框架内应用，或者您也可以扩展您的框架以使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:30:48.030

这将非常依赖于语言。没有两种语言完全一样地处理这个问题。

我可以提供一些关于 Java 的建议。在 Java 中，您可以使用 NumberFormat 来处理这个问题。如果 NumberFormat.parse() 在没有抛出异常的情况下工作，那么它是使用什么语言环境中的有效数字。您可以设置您将接受的最大小数位数等。所有这些都是高度特定于 Java 的，所以除非您说 Java 是您正在使用的，否则我不会打扰它。

# mysql - ActiveRecord::StatementInvalid: Mysql::Error:

> ID：946608
> 
> 赞同：0
> 
> 时间：2009-06-03T19:17:39.883
> 
> 标签：mysql, ruby-on-rails, activerecord

我试图用谷歌搜索硬核来找出造成这个问题的原因，但没有任何帮助，所以我想在这里写！

```
while doing:
User.create(:name => "daniel") 
or 
User.new(:name => 'daniel').save 
```

在 Rails 控制台中，我收到此错误

```
ActiveRecord::StatementInvalid: Mysql::Error: Duplicate entry '5' for key 1: 
INSERT INTO `users` (`name`, `salt`, `privilegi`, `confirmed_mail`, `avatar_id`, `id`, `password`, `session_num`, `email`) VALUES('daniel', '23404', NULL, NULL, NULL, 5, NULL, NULL, NULL) 
```

这是我的 SQL 表 - “用户”的 id 行

```
| id             | int(11)      | NO   | PRI | NULL    | auto_increment | 
```

它是自动增量的，我确定没有其他 id 为 5 的条目！

怎么了？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-16T15:15:08.083

我遇到了同样的问题，请检查是否在此表上创建了不允许重复的任何索引。这为我解决了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:02:34.760

如果您尝试将该表的存储引擎从/更改为 MyISAM/InnoDB 并且出现问题，那么该表中的索引可能已经搞砸了。尝试使用 mysqldump 备份此数据库并将其恢复 - 它可能有效：[http ://www.vbulletin.com/forum/showthread.php?t=141322](http://www.vbulletin.com/forum/showthread.php?t=141322)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T19:42:03.590

```
INSERT INTO users (name, salt, privilegi, confirmed_mail, avatar_id, id, password, session_num, email) 
VALUES ('daniel', '23404', NULL, NULL, NULL, 5, NULL, NULL, NULL) 
```

id 是 SQL 语句的字段列表，值为 5。这似乎不对。由于 id 是一个自动递增字段，因此不应将其包含在 SQL 语句中。

您会发布填充 User 对象然后创建它的相关代码吗？我认为在您的代码中某处您正在用 5 填充“id”属性，这导致了问题。

# c# - 我是否需要为 C# 中的强制转换运算符重载提供强制转换方法，以允许人们在 VB 中使用

> ID：946613
> 
> 赞同：1
> 
> 时间：2009-06-03T19:18:39.867
> 
> 标签：c#, vb.net, casting, operator-overloading

我在某处读到旧的 VB .net（VB .NET 2005 之前？）不能在 C# 类中使用重载运算符。重载的强制转换运算符是真的吗？

无论哪种方式，你们是否认为 C# 类库不包含它们和算术方法作为其他语言的实际方法是一个缺点，例如：

```
ToDouble
ToFloat
FromDouble
Add
Subtract
Multiply
Divide
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:25:52.767

VB 人习惯于做 CType（比 DirectCast 多得多），所以不要提供额外的方法，而是确保你支持 CType（查看 Reflector 以查看它实际使用的类）

# opengl - 为什么我不知道 GLSL 中 OpenGL 灯的状态？

> ID：946622
> 
> 赞同：3
> 
> 时间：2009-06-03T19:20:10.377
> 
> 标签：opengl, shader, glsl

有没有办法找出是否在 GLSL 中启用了不涉及传递属性或创建大量不同着色器的灯光？

使用 NVidia 的 C for Graphics (Cg) 怎么样？我可以用 Cg 做吗？

我现在确信你做不到。但现在我问：为什么不呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-09T07:59:12.247

根据我对[GLSL 常见错误](http://www.opengl.org/wiki/GLSL_:_common_mistakes)的“启用或不启用”部分的理解，这是一个哲学原因：着色器是为覆盖固定管道而编写的，因此它们不应该依赖于固定的管道状态。您必须为所需的每种功能使用不同的着色器。

另外我想这可能是一个设计选择，因为分支在 GPU 上很昂贵，而且有人一定认为你不应该做类似的事情

```
if (gl_LightSource[0].enabled)
{ ... } 
```

首先。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-05T23:39:56.410

unforgiven3 是对的——GLSL 不提供对固定管道启用状态的访问。您必须将其作为制服传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T19:25:17.900

如果 GLSL 类似于 HLSL（DirectX 的等价物），我怀疑是这样，我认为您会被传递属性所困扰。

:-(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-24T09:55:03.830

您可以将灯光颜色设置为 (0,0,0,0) 并在其上进行分支，或者让它在现在没有贡献的灯光上循环。

# php - 如何在 PHP5 中实现模板继承（如 Django？）

> ID：946627
> 
> 赞同：13
> 
> 时间：2009-06-03T19:20:55.523
> 
> 标签：php, model-view-controller, templates, template-inheritance

是否有一个现有的好例子，或者一种方法应该如何创建一个在 PHP5 中支持“模板继承”的基本模板系统（思考 MVC）？

有关我定义为模板继承的示例，请参阅 Django（用于 Web 开发的 Python 框架）模板文档：[http ://docs.djangoproject.com/en/dev/topics/templates/#id1](http://docs.djangoproject.com/en/dev/topics/templates/#id1)

我特别喜欢 PHP 本身就是“模板语言”的想法，尽管它不一定是必需的。

如果列出实现“模板继承”的现有解决方案，请尝试将答案形成为单独的系统，以利于“大众投票”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-03-29T01:04:37.617

很抱歉挖掘了一个旧线程，但我刚刚发布了一个在原生 PHP 中进行模板继承的库。非常受 Django 的启发。请检查一下，让我知道你的想法：

《PHP 模板继承》

[http://arshaw.com/phpti/](http://arshaw.com/phpti/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-10T09:41:19.397

Soulmerge给出的答案与模板继承无关。

就个人而言，我认为模板继承很棒，这是我第一次看到有人抱怨它。

phpti 是前面指出的一个选项，但对我来说它看起来有点难看。

您可能需要考虑 mustache (mustache.github.com)，它支持模板继承，并具有多种语言（包括 php）的实现。要在 PHP 中使用 mustache 模板，您可能需要编写某种控制器来读取 mustache 文件并处理它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-10T02:10:06.727

[Symfony 支持模板继承](http://symfony.com/doc/current/book/templating.html#template-inheritance-and-layouts)，它看起来很像 django，语法看起来与[django](http://yourlabs.org/site_media/django/docs/_build/html/topics/templates.html#custom-libraries-and-template-inheritance)或其他[漂亮的 jinja python 引擎](http://jinja.pocoo.org/)兼容。

优雅，就像使用 PHP 作为模板语言：

```
<h1><?php echo $page->title; ?></h1>
<?php foreach($page->comments as $comment): ?>
    <?php echo $comment->body; ?>
<?php endforeach; ?>
<?php echo $page->comments->count(); ?> 
```

或者更优雅，神社：

```
<h1>{{ page.title }}</h1>
{% for comment in page.comments %}
   {{ comment.body }}
{% endfor %}
{{ page.comments.count %} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-08T08:48:41.633

Smarty 和 Twig 模板系统都支持 django 模板系统中的“模板继承”。这两个都是流行且得到很好支持的模板系统，但是，twig 的语法更接近 django，所以你可能会更舒服地使用它。

# 聪明的

要在 smarty 中执行此操作，您可以按照以下示例执行此操作，从[Smarty Documentation on Inheritence复制](http://www.smarty.net/inheritance)

## 布局.tpl

```
<html>
<head>
  <title>{block name=title}Default Page Title{/block}</title>
</head>
<body>
{block name=body}{/block}
</body>
</html> 
```

## 我的页面.tpl

```
{extends file="layout.tpl"}
{block name=title}My Page Title{/block}
{block name=body}My HTML Page Body goes here{/block} 
```

## mypage.tpl 的输出

```
<html>
<head>
  <title>My Page Title</title>
</head>
<body>
My HTML Page Body goes here
</body>
</html> 
```

# 枝条

同样，对于使用此功能有很好的文档。在[twig 文档](http://twig.sensiolabs.org/doc/templates.html#template-inheritance)中，该示例更复杂，以演示 twig 提供的一些更高级的功能，但出于比较目的，我编写了一些反映 twig 中 smarty 示例的内容。

## 布局.twig

```
<html>
<head>
  <title>{% block title %}Default Page Title{% endblock %}</title>
</head>
<body>
{% block body %}{% endblock %}
</body>
</html> 
```

## 我的页面.twig

```
{% extends layout.twig %}
{% block title %}My Page Title{% endblock %}
{% block body %}My HTML Page Body goes here{% endblock %} 
```

# 结论

回想起来，这两个示例几乎相同，因此在两者之间进行选择是比较特征和完全不同的问题的问题。使用 PHP 模板框架，您可以像使用 django 一样实现模板继承。

# 延伸阅读

*   [智能继承](http://www.smarty.net/inheritance)
*   [Twig 模板继承](http://twig.sensiolabs.org/doc/templates.html#template-inheritance)
*   在 Google 上搜索 Smarty/Twig 模板继承

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T19:38:07.610

PHP 语言本身就是为这些任务而设计的，[不幸地] 随着时间的推移，它变得越来越有能力，而那些开始使用这种简单语法的人开始使用这种奇怪进化的语言来实现越来越复杂的任务。

我认为您对模板继承的意思最好表示为 PHP 中的动态文件包含，就像

```
<? require $content ?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T21:32:58.143

假设您熟悉类继承的工作原理，您的答案是肯定的，PHP 支持它。django 的事情可能有点矫枉过正，但无论如何我都会尝试快速向您介绍如何做到这一点。

注意：我不打算在这里使用控制器。显然，如果页面是博客，您将创建一个 blogPage 对象，而不仅仅是一个普通的 Page。另外，我从头开始为你写了这个，所以不能保证它的工作原理..但希望它会给你一些想法。

```
<?php
class Page
{

    protected $content_main; // Your main page content.
    protected $content_leftbar; // Your left sidebar content.
    protected $content_title; // Your content title.
    protected $template; // Template data.

    Function getTemplate() {
        // Logic for determining the template to be used in here.
        // Let's say it returns the location of a cached version of the template.
            return $template_file_path;
    }

    Function populateContentBlocks() {
        // This populates the $content_BLOCK variables with data using some default
        // logic you have for determining where to grab that data from.
    }

    Function loadPage() {

        // Populates variables.
        $this->populateContentBlocks();

            // Fetches template
        include( $this->getTemplate() );
    }

} // END class

Class blogPage extends Page {
    Function getTemplate() {
        // Logic for determining the template to be used in here.
        // Let's say it returns the location of a cached version of the template.
        // OVERRIDE THE DEFAULT TEMPLATE LOGIC OF THE PAGE WITH WHAT IS RELEVENT TO
                // BLOGPAGE.
    }
}
?> 
```

**模板文件示例：**

```
<html>
  <head>
    <title><?php echo $this->content_title; ?></title>
  </head> 

  <body>
      <div class="sidebar"><?php echo $this->content_sidebar; ?></div>
      <div class="mainContent"><?php echo $this->content_main; ?></div>
  </body>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-06T12:43:19.160

PHP 模板继承似乎是一个不错的选择。以下是来自网站的描述：

模板继承是一种非常有用的技术，可以为网站制作可重用的 HTML 布局。它比替代技术灵活得多，例如“包含”页面的常见元素（如页眉和页脚文件）。

这个概念已经存在了一段时间，尤其是在 Django 模板引擎中。与其他库不同，PHP 模板继承让您可以直接用 PHP 编写所有内容。无需学习另一种模板语言。

查看更多信息：http: [//phpti.com/](http://phpti.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-30T23:31:01.490

有一个很棒的组件，“Redstart Templating”，它以非常强大的方式支持 php 模板继承，所有模板都是用纯 html 和 php 编写的，而且它是可扩展的，你可以创建一个新的插件和更多

[您可以在http://phpbeat.com/doc/template](http://phpbeat.com/doc/templating)中阅读有关该项目的更多信息

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-11T07:24:57.737

我正在开发的模板引擎

（支持类似 php 的语法和包含/模板指令，也支持模板继承）

支持相同格式的 PHP、客户端 js 和 nodejs

[https://github.com/foo123/Contemplate](https://github.com/foo123/Contemplate)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-07T09:17:54.360

Puja 是一个类似 Django 的 PHP 模板引擎[http://www.phpclasses.org/package/8283-PHP-Template-engine-that-c](http://www.phpclasses.org/package/8283-PHP-Template-engine-that-compiles-templates-into-PHP.html) ​​ompiles-templates-into-PHP.html 。它还支持验证模板语法。

# file - 如何在matlab中将数据保存在32位二进制文 件中？

> ID：946633
> 
> 赞同：3
> 
> 时间：2009-06-03T19:22:26.770
> 
> 标签：file, matlab, file-io, binary, 32-bit

我必须用 MATLAB 中的程序生成的顽固分子测试一些“随机数”。Diehard 只接受 32 位二进制文​​件（单精度），但如果我将数据保存在 MATLAB 中，它会保存在双精度二进制文件中（因此 2*64 = 128 位二进制文​​件）。如何在 MATLAB 中创建 32 位二进制文​​件，在 64 位系统上工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T19:32:54.733

如果您想以特定格式将数据读/写到二进制文件，您应该使用函数[FREAD](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fread.html) / [FWRITE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fwrite.html)。例如，这会将 100 个随机值作为 32 位浮点数写入文件：

```
A = rand(1,100);
fid = fopen('temp.dat','wb');
fwrite(fid,A,'float32');
fclose(fid); 
```

有关 MATLAB 中文件 IO 的更多信息，您还可以查看这些其他相关的 SO 帖子：[此处](https://stackoverflow.com/questions/205735/read-and-write-from-to-a-binary-file-in-matlab)和[此处](https://stackoverflow.com/questions/872209/sharing-memory-between-processes-matlab/878327#878327)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T20:15:40.857

除了 gnovice 的解决方案，您可能希望将随机数生成为“单个”，如下所示：

```
rand(1, 100, 'single') 
```

# .net - 提高 Visual Studio 2008 ASP.NET 设计器性能的任何技巧？

> ID：946638
> 
> 赞同：1
> 
> 时间：2009-06-03T19:23:07.563
> 
> 标签：.net, visual-studio, performance, asp.net-2.0

这一直困扰着我一段时间，但是 VS 2008 中的 ASP.NET 设计器在编辑最简单的页面时可能会非常慢。我们使用的机器并不是最先进的，但人们会认为具有 3Gb RAM 和 7200RPM 120Gb 硬盘的 2Ghz 双核 AMD 3800+ 会比它表现更好。

为了量化问题，打开一个包含 3-5 个文本框、一个下拉菜单和一个 DataGrid 的页面的设计视图可能需要 30-45 秒……或更长时间。真正复杂的屏幕有时可能需要几分钟才能打开。而且一旦打开，设计器就非常迟钝——点击一个控件可能需要几秒钟才能生效。属性窗口并不总是正确更新。右键单击菜单可能需要几秒钟才能出现。

我们已经尝试对驱动器进行碎片整理，杀死不必要的进程，升级到 SP1，甚至重新安装开发环境，但问题仍然存在。

有没有其他人观察到类似的性能问题，如果是这样，是否有人对如何提高性能有任何建议？例如，是否有任何可以帮助我们关闭的 IDE 功能（即智能感知）？如果您没有看到任何问题，我很想知道您的机器配置了哪些规格（CPU、RAM、HD）。

编辑：一些额外的事实和更正。首先，快速更正一下，我们实际上有 Western Digital 的 7200 RPM 驱动器，而不是 5200 RPM 型号。

其次，根据对瓶颈所在位置的一些调查，当设计人员加载时，似乎有很多死时间 - < 20% CPU，只是一点 I/O 等待。但是整体效果很慢。

我们确实在我们的项目中使用了 Resharper，但是禁用这个附加组件并不能明显地提高设计器的性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:57:46.827

这是 ScottGu 发布的关于视觉工作室性能的[文章。](http://weblogs.asp.net/scottgu/archive/2007/11/01/tip-trick-hard-drive-speed-and-visual-studio-performance.aspx)我认为它可能更适合 2005 年，但值得一看。

一般来说，我建议不要使用设计器......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:55:38.620

唯一真正的瓶颈是硬盘驱动器。如今，在开发机器上使用 5200RPM 驱动器有点慢。

# performance - 改变圆周运动的速度

> ID：946641
> 
> 赞同：1
> 
> 时间：2009-06-03T19:23:30.527
> 
> 标签：performance, simulation, physics, geometry

我正在寻找一种方法来平滑地增加或减少圆周运动的速度。

使用圆的参数方程，我可以随时间沿圆移动对象：

```
x = center_x + radius * sin(time * speed)
y = center_y + radius * cos(time * speed) 
```

这种方法的问题是我不能简单`speed = speed + 1`地加速物体，因为它会导致不平稳的运动。这是有道理的，因为每帧都会根据绝对值而不是相对于对象的先前位置重新计算 x 和 y 值。

另一种方法可能是使用表示对象速度的向量，然后对向量应用圆周运动：

```
v_x = radius * sin(time * speed)
v_y = radius * cos(time * speed)
x = x + v_x
y = y + v_y 
```

这种方法的问题是，如果我改变速度，那么半径会增大或缩小。这是有道理的，因为运动是相对于当前位置的，所以如果我改变速度，时间基本上会被跳过。

我能想到的一种可能可行的实现是使用从对象指向圆心的向量。然后我可以通过使用垂直向量计算圆在对象位置的切线，对其进行归一化并按速度缩放。我还没有实现这个，因为这样的问题似乎有点矫枉过正，所以如果存在更简单的解决方案，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T19:28:13.980

速度是角度的变化率，速度的变化只影响最后一个区间的角度变化，所以：

```
delta = time - lastTime
angle = angle + delta * speed

x = center_x + radius * sin(angle)
y = center_y + radius * cos(angle) 
```

lastTime 必须保存最后一个循环的时间，明白吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T19:47:26.327

你自己说过：你想*改变角速度*。现在，在现实世界中，角速度的变化受到物体角惯性的限制。这意味着它不能以 1 为步长“离散”。

相反，角速度是角加速度的积分。角*位置*是角速度的积分。

所以对于一个恒定的角加速度，你可以说

速度（t）= t*acc + vel [[t=0]]。

和

角度（t）= t ² * acc/2 + vel [[t=0]] * t + 角度[[t=0]]。

然后你可以用角度的 sin 和 cos 计算你的 carthesian 位置。

角加速度*可以*（相当）离散地变化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T19:30:28.173

如果您只是在做`speed = speed + 1`. 更一般地说，你想这样做：

```
accel = 1;
speed = speed + (accel * timeDelta); 
```

此外，accel = 1 以弧度表示的角速度变化非常大 - 尝试使用较小的值，例如`PI / 16`。如果您需要如此大的加速度并希望最大限度地减少抖动运动的可见性，您可能需要尝试使用一些运动模糊。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T19:34:59.723

为了平滑地增加角速度，您需要添加角加速度

x = 半径 * cos(theta)
y = 半径 * sin(theta)

theta(t) = theta(0) + omega(0)*t + 0.5 * alpha * t^2

其中 t 是时间，theta(0) 是时间 0 的角位置，omega(0) 是时间 0 的角速度（将等于您的速度参数），而 alpha 是您选择的角加速度参数合适的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T19:52:21.920

使用

```
time * speed 
```

表明圆圈走了多远是错误的。只有当速度永不改变时才有意义。

相反，您需要将经过的距离存储在一个变量中，然后根据当前速度和自上次绘制后的时间间隔将变量增加一个量。

其他人必须使用加速的建议也很好。尝试类似的东西

```
v = v + a;
d = d + delta * v;

x = center_x + radius * sin(d)
y = center_y + radius * cos(d) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T19:30:56.220

您需要根据角速度来考虑这一点。您正在计算角度，theta，作为时间*速度，如果速度是传统的速度感，即距离/时间，这没有意义。角速度是角度/时间（即弧度/秒或度/秒）。常规速度将是应用角速度后起点和终点之间的距离/时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T19:42:29.833

```
x = center_x + radius * sin(time * speed + offset)
y = center_y + radius * cos(time * speed + offset)

def change_speed(new_speed):
    offset = time * (speed - new_speed) + offset
    speed = new_speed 
```

`offset`可以从 0 或任何值开始......它用于保持连续性，如

```
time * old_speed + old_offset == time * new_speed + new_offset 
```

# c++ - 与“索引”相关的编译错误 - 它实际上是一个函数吗？

> ID：946642
> 
> 赞同：0
> 
> 时间：2009-06-03T19:23:30.837
> 
> 标签：c++, gcc-warning

我正在从我们的编译中删除所有警告，并遇到以下问题：

警告：`char* index(const char*, int)' 的地址将始终为 'true'

对于以下代码行：

```
DEBUG_MSG("Data received from Device "<<(int)_nodeId << "for" << index  <<(int)msgIn.index<<"."); 
```

DEBUG_MSG 是我们的日志记录宏之一，预处理器将其替换为采用 C++ 样式流操作的语句。

index 似乎没有被声明，所以我假设它应该是这样的：

```
DEBUG_MSG("Data received from Device "<<(int)_nodeId << "for index "  <<(int)msgIn.index<<"."); 
```

并且 index 将是标准库中“char* index(const char*, int)”函数的函数*，但是 index 函数有什么作用？谷歌似乎毫无用处，因为它提取了与 C++ 相关的书籍索引。

在我对这个警告的解释中是否遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T19:26:46.057

这是索引的手册页：

[http://kernel.org/doc/man-pages/online/pages/man3/index.3.html](http://kernel.org/doc/man-pages/online/pages/man3/index.3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:31:20.713

据推测，流运营商正在看到

```
<< index 
```

并尝试自动将其转换为可以打印的内容：

```
<< (bool)index 
```

但是 index 是一个函数，并且有一个永远不会为 NULL 的地址。所以这相当于：

```
<< true 
```

G++ 认为这将永远是正确的，并发出警告。

至于索引的作用，请参见[http://www.linuxmanpages.com/man3/index.3.php](http://www.linuxmanpages.com/man3/index.3.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:30:00.730

`index`是一个在其中定义的函数[`<strings.h>`](http://www.opengroup.org/onlinepubs/009695399/basedefs/strings.h.html)，已弃用，应替换为[`strchr`](http://www.cplusplus.com/reference/clibrary/cstring/strchr/).

# wpf - 跨用户控件的 WPF 网格？

> ID：946643
> 
> 赞同：3
> 
> 时间：2009-06-03T19:23:38.637
> 
> 标签：wpf, grid

在 ASP.NET 中，我可以使用户控件在页面上的表格中占据多个单元格：

用户控件1：

```
<tr>
  <td>foo</td>
  <td>bar</td>
</tr> 
```

第 1 页：

```
<table>
  <put a UserControl1 here/>
  <put another UserControl1 here/>
</table> 
```

并自动调整列宽以适应最大的用户控件。

这也可以在 WPF 中完成吗？如何 ？

我认为用户控件不能做到这一点，我必须创建一个简单的类而不是用户控件，它具有将所有内容添加到网格的方法。但是那样一切都应该由代码完成，xaml在这里是没用的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T19:59:14.730

我在[这里](http://joshsmithonwpf.wordpress.com/2008/09/06/synchronizing-the-width-of-elements-in-an-itemscontrol/)找到了答案。

可以使用 SharedSizeGroup 和 Grid.IsSharedSizeScope 来完成。

用户控件1.xaml：

```
<UserControl x:Class="WpfApplication1.UserControl1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition SharedSizeGroup="SharedSizeGroup1"/>
            <ColumnDefinition SharedSizeGroup="SharedSizeGroup2"/>
        </Grid.ColumnDefinitions>
        <Label Name="Label1" Grid.Column="0">Label1</Label>
        <Label Name="Label2" Grid.Column="1">Label2</Label>
    </Grid>
</UserControl> 
```

Window1.xaml：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:y="clr-namespace:WpfApplication1">
    <Grid Grid.IsSharedSizeScope="True">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <y:UserControl1 Grid.Row="0" x:Name="UserControl1A"/>
        <y:UserControl1 Grid.Row="1" x:Name="UserControl1B"/>
    </Grid>
</Window> 
```

Window1.xaml.cs：

```
using System.Windows;

namespace WpfApplication1
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
            UserControl1A.Label1.Content = "Label1WithLongText";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:30:00.077

不，您不能在 XAML 中做类似的事情。

ASP.NET 用户控件发出 HTML。您的用户控件为表格行发出 HTML。鉴于发出的标记在表单的标记中是有意义的，您可以做的事情是可能的，但不是很好的做法，因为控件完全取决于页面中的标记才能产生任何意义。此外，页面中控件的大小和位置应该是页面的责任，而不是控件的责任。这都是关于封装的。

WPF 控件当然不会发出标记。相反，它们在 WPF 窗口/页面中实例化，并作为窗口中的可视控件存在。完全不同的情况。

要使您的控件跨越多个列，您应该使用 Grid.ColumnSpan 扩展属性，如下所示：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <MyControl Grid.ColumnSpan="2" Name="myControl">Button</Button>
</Grid> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:39:16.063

我不建议让用户控件定义它应该如何占据主机中的表格/网格单元格。承载用户控件的页面/窗口应定义用户控件的显示方式。这样您就可以将用户控件放置在 WPF 网格中，并使用 Grid.ColumnSpan 属性使用户控件占据网格中的多个列。

控件最终将变得更加可用，并且保持了合理性的分离。

# css - 如何忽略父 CSS 样式

> ID：946645
> 
> 赞同：91
> 
> 时间：2009-06-03T19:24:08.637
> 
> 标签：css

我想知道如何忽略父样式并使用默认样式（无）。我将以我的具体案例为例，但我很确定这是一个普遍的问题。

```
<style>
#elementId select {
    height:1em;
}
</style>

<div id="elementId">
    <select name="funTimes" style="" size="5">
        <option value="test1">fish</option>
        <option value="test2">eat</option>
        <option value="test3">cows</option>
    </select>
</div> 
```

我不想解决这个问题的方法：

*   我无法编辑设置了“#elementId select”的样式表，我的模块将无法访问它。
*   最好不要使用 style 属性覆盖高度样式。

例如使用萤火虫我可以关闭父样式，一切都很好，这就是我想要的效果。

**设置样式后，可以禁用它还是必须覆盖它？**

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2010-05-03T21:19:48.580

您可以通过像这样覆盖它来关闭它：

高度：自动！重要；

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-06-03T19:26:31.253

它必须被覆盖。你可以使用：

```
<!-- Add a class name to override -->
<select name="funTimes" class="funTimes" size="5">

#elementId select.funTimes {
   /* Override styles here */
} 
```

确保您`!important`在 css 样式中使用标志，例如`margin-top: 0px !important` [!important 在 CSS 中的含义是什么？](https://stackoverflow.com/questions/9245353/what-does-important-mean-in-css)

您可以使用属性选择器，但由于旧版浏览器不支持（阅读 IE6 等），最好添加类名

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2018-12-28T07:38:47.683

由于编辑，这被撞到了顶部......答案已经变得有点陈旧，而且今天不像标准中添加了另一个解决方案那样有用。

现在有一个“all”速记属性。

```
#elementId select.funTimes {
   all: initial;
} 
```

这会将所有 css 属性设置为其初始值...*注意*一些初始值是继承的；导致元素上仍然发生一些格式化。

由于在阅读代码或将来审查代码时需要暂停，除非您最常使用它，否则不要使用它，因为审查过程可能会产生错误/错误！编辑页面时。但很明显，如果有大量的属性需要重置，那么“全部”就是要走的路。

标准在线：[https ://drafts.c​​sswg.org/css-cascade/#all-shorthand](https://drafts.csswg.org/css-cascade/#all-shorthand)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T19:33:20.427

您可以在 CSS 样式表中创建另一个定义，该定义基本上颠倒了初始规则。您还可以将“！important”附加到所述规则以确保它坚持。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-05-27T07:57:53.923

你应该使用这个

高度：自动！重要；

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-24T20:11:34.027

我在 joomla 网站上工作时遇到了类似的情况。

为受影响的模块添加了类名。在你的情况下：

```
<select name="funTimes" class="classname"> 
```

然后在css中进行以下单行更改。添加了行

```
#elementId div.classname {style to be applied !important;} 
```

工作得很好！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-20T13:27:09.347

如果我正确理解了这个问题：您可以像这样使用它`auto`，它将返回默认设置。`CSS``width: auto;`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-04-12T12:20:23.843

CSS 中的 all 属性重置所有选定元素的属性，除了控制文本方向的方向和 unicode-bidi 属性。

```
.module {
  all: unset;
} 
```

它的重点是允许样式的组件级重置。有时，从头开始设计样式要比与已经存在的所有内容作斗争要容易得多。

```
/* -------- For Your code -------- */
#elementId select.funTimes {
  all: unset;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-04T20:34:52.880

对于 CSS 来说，有一种方法可以简单地添加一个额外的样式（例如，在页面的 head 部分，它将覆盖链接的样式表），例如：

```
<head>
<style>
#elementId select {
    /* turn all styles off (no way to do this) */
}
</style>
</head> 
```

并关闭所有以前应用的样式，**但没有办法做到这一点**。您必须覆盖 height 属性并将其设置为页面头部的新值。

```
<head>
<style>
#elementId select {
    height:1.5em;
}
</style>
</head> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-05-19T07:48:19.503

有一堆值可用于撤消 CSS 规则：初始、未设置和恢复。W3C CSS 工作组的更多细节：

[https://drafts.c​​sswg.org/css-cascade/#defaulting-keywords](https://drafts.csswg.org/css-cascade/#defaulting-keywords)

由于这是“草稿”，并非所有内容都得到完全支持，但 unset 和 initial 在大多数主要浏览器中都存在，因此对 revert 的支持较少。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2018-12-04T01:03:04.477

请参阅下面的打字稿，以再次将 css 类重新应用于元素以覆盖父容器（通常是框架组件）css 样式并强制您的自定义样式。您的应用程序框架（无论是 angular/react，可能会这样做，因此父容器 css 被重新应用，并且您在 css-class-name 中的任何预期效果都不会出现在您的子元素中。调用 this.overrideParentCssRule(childElement, ' css-class-name'); 做框架刚刚做的事情（在 document.ready 或事件处理程序结束时调用它）：

```
 overrideParentCssRule(elem: HTMLElement, className: string) {
        let cssRules = this.getCSSStyle(className);
        for (let r: number = 0; r < cssRules.length; r++) {
          let rule: CSSStyleRule = cssRules[r];
          Object.keys(rule.style).forEach(s => {
            if (isNaN(Number(s)) && rule.style[s]) {
              elem.style[s] = rule.style[s];
            }
          });
        }
      } 
```

*   Mike Zheng tradrejoe@gmail.com

# sql-server - 简单的数据库用户界面

> ID：946646
> 
> 赞同：1
> 
> 时间：2009-06-03T19:24:27.343
> 
> 标签：sql-server, database, sharepoint, ms-office

我有一个用于转换的简单 SQL Server 数据库。基本上是一个包含两个更多列的表，其中一个值映射到另一个值。然后，我们有使用这些表来查找匹配值并在该行上选择其他值的进程。

这些值变化很大，我们现在需要一个让业务用户自己更新值的界面。我***不想***花时间构建新的东西，我宁愿使用和使用习惯的接口 - 例如 Excel 或 SharePoint 中的东西。

您是否解决了类似的问题，以及您在该场景中轻松获胜的想法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:39:54.363

您可以轻松地[从 Excel 创建连接](http://office.microsoft.com/en-us/excel/HA101672271033.aspx)，让他们使用*他们喜欢的工具*进行更新；-)

**编辑**：显然，上述链接无法将更改更新回 SQL Server（自动）。
在寻找解决方案时，出现了这个[SO 问题](https://stackoverflow.com/questions/750565/writing-data-back-to-sql-from-excel-sheet)...看来您必须做一些手动工作...
[在这里](http://msdn.microsoft.com/en-us/library/aa192473.aspx)，我找到了一个更好的链接，其中包含您正在尝试做的事情的演练。高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T19:32:48.837

您可以将 SQL Server 表映射到 Access“表”（我忘记了该“表”类型的确切 Access 术语。）

结果将是您的用户可以使用 Access 工具（包括网格）来更改实际服务器上的数据。

请记住在 SQL Server 上创建仅具有执行有效任务所需的最低权限的用户名。例如，用户是否需要对行进行插入或删除功能？还是只是更新能力？

拉里

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:08:20.653

如果您的 MOSS 2007 Enterprise 带有一些支持回写功能的现成 Web 部件，您可以使用[ASP.Net 动态数据脚手架或使用业务数据目录。](http://www.asp.net/dynamicdata/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T20:26:54.080

为此，我认为 Acces 比 Excel 更好，因为您可以创建代码来真正限制它们可以更轻松地用作可接受值的内容。

另一种可能性是您使用 .net 或其他语言创建的基于 Web 的表单（或应用程序，取决于它的复杂程度），具体取决于您所知道的。只要他们有网址并且表格相当简单，您的用户就不会遇到任何问题。使其仅在 Intranet 上可用，而不对外部世界可用，并且需要用户名和密码，并且它与其他浮动的可能性一样安全。这样做的一个真正优势是，当更改时间到来时，您可以轻松部署更改。一个缺点是最初设置比访问表单更复杂。

# rss - 如何通过 WCF Web 服务向 JQuery 客户端公开 RSS 聚合源

> ID：946649
> 
> 赞同：0
> 
> 时间：2009-06-03T19:24:47.967
> 
> 标签：rss, feed, syndication

我想要构建一个读取 RSS 聚合源 (.NET 3.5 SP1) 的 WCF 服务。然后我想在 Web 客户端中使用 JQuery 来使用 wcf 服务。你是在问我为什么不直接从客户端消费它？我认为当客户端位于不同的域中时存在一些跨域安全问题。无论如何，如果有人可以向我展示一些代码示例，我将不胜感激。如果我能在 ASP.NET MVC 框架中做到这一点，那就更好了。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-08T09:07:40.297

您的 WCF 服务将需要输出您的 jQuery HTTP 请求可读的格式。(XML/JSON)

然后您只需使用 $.get(... 调用 WCF 服务并使用结果...

# language-agnostic - 如何对 if 语句最具可读性进行评论

> ID：946652
> 
> 赞同：7
> 
> 时间：2009-06-03T19:25:37.777
> 
> 标签：language-agnostic, comments

我试图让未来的读者更容易理解我的代码。

我一直对如何措辞我的 if 语句注释以使其最容易理解有疑问。

也许这看起来微不足道，但这是一直困扰着我的事情

这是一个例子：

```
if ( !$request ) {
    $request = $_SERVER['REQUEST_URI'];
} 
```

这是我能想到的一些评论方式

```
// If request doesn't exist
if ( !$request ) {
    // Set request to current request_uri
    $request = $_SERVER['REQUEST_URI'];
}

// Check for a request
if ( !$request ) {
    $request = $_SERVER['REQUEST_URI'];
}

// Request doesn't exist
if ( !$request ) {
    // Set request
    $request = $_SERVER['REQUEST_URI'];
} 
```

不是最好的例子，但在我看来，有无数种说法。

我从来没有真正在团队中工作过，所以我对其他人阅读我的代码没有太多经验。

你有什么经验可以用最好的方式来表达它以使其对未来的编码人员可读。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T19:28:53.090

对于您提供的案例，我根本不会发表评论。当执行一些非常棘手或不明显的事情时，我只在方法/函数的主体中使用注释——我试图避免两件事。只需在方法的开头添加一个简短的注释即可。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T19:31:56.703

在这个特定的示例中，我不会费心评论 if 语句——您正在重复代码中所说的内容。

我可能会看到测试代码很复杂的情况：

```
if (a == 3 && b && c > 2) 
```

但在这种情况下，我会首先尝试提取一个具有有意义名称的方法：

```
if (markerIsValid(a, b, c)) 
```

只有当那不可能时，我才会评论测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T19:32:21.507

我的建议是“不要说明显的”。

阅读 if ( !$request ) 说 - 如果不存在请求。我不需要对此发表评论。

如果你有多个检查（this ||（that && this-too））我会去创建一个返回布尔值的方法。那么您的方法名称就是您的评论，这通常比实际评论更好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T19:27:34.450

我不想说没关系，但这主要取决于程序员的喜好。更好的是在 if 语句中编写谓词以使其无需注释即可阅读。

不过，这在某些语言中比其他语言更容易。例如，某些语言使用语义否定关键字，例如`not`，这可以使谓词更易于阅读。话虽如此，如果所讨论的读者是一个足够体面的程序员，他们应该能够处理一般测试的逻辑，而不必手动输入注释。

底线：使用你的自由裁量权。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T19:32:16.703

使用您的示例，我通常更喜欢以下样式：

```
if ( !$request ) {
    // The request is not yet set, so retrieve it.
    $request = $_SERVER['REQUEST_URI'];
} 
```

我喜欢将它放在`if`块内，以便在有`else`or时看起来更好`else if`。

```
if ( !$request ) {
    // The request is not yet set, so retrieve it.
    $request = $_SERVER['REQUEST_URI'];
}
else {
    // Comment about doing something else here.
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T19:33:34.843

阅读 Robert Martin 所著的 Clean Code 一书。

[http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882](https://rads.stackoverflow.com/amzn/click/com/0132350882)

注释应该只用于解释代码无法解释的概念。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-03T19:34:49.020

当我写代码注释时，我尝试要么

1.  解释一个棘手的、不明显的过程（reg ex 是一个很好的例子），或者
2.  解释我*为什么*要做我正在做的事。

查看[代码完成](http://www.cc2e.com/)。麦康奈尔有一个很棒的评论章节。

我会向所有编写代码的人推荐这本书。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T19:40:41.100

请记住：很少需要内联注释来说明*代码*在做什么；除非你在解释一个特别粗糙的算法，否则代码应该自己承担这个负担，而不需要注释。（如果不能，您可能需要使变量名更具描述性。）

然而，解释*为什么*代码正在做它正在做的事情的注释可能非常有价值。（假设它不是很明显；如果是，请跳过评论。）

在那之后，这真的是个人品味的问题，尽管我确实提倡一致性。就个人而言，当我评论“if”树时，我更喜欢缩进评论以符合他们正在解释的条款：

```
 if ( !$request ) {
        // If the request isn't set, foo() will barf; the current
        // request is a suitable default.
        $request = $_SERVER['REQUEST_URI'];
    } 
```

只要确保您的评论证明他们自己的存在是合理的，其余的都是肉汁。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-03T19:29:24.850

我不喜欢阅读充斥着评论的代码。代码应该很容易理解。我通常只注释大的、难以理解的代码部分，而不是个别和琐碎的行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T19:34:23.017

这在很大程度上取决于程序员。我将提供两个提示：

**不要说明显的**

举个例子：

```
// If request doesn't exist
if ( !$request ) { 
```

在上面的例子中，注释只是复制了代码（我意识到这是一个例子，但我仍然想说明这一点）。将注释集中在澄清代码中可能不明显的内容上。另一方面...

**不要假设所有开发人员都知道你所知道的**

查看您的代码并想象您是一个相对初学者。你会明白吗？如果没有，请在评论中澄清。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T19:35:04.387

我使用这种形式：

```
// Full Comment
if (condition) {
    action;
    action;
} 
```

因为启用代码折叠后，您最终会得到如下所示的内容：

```
// Full Comment
if (condition) { ...} [+] 
```

而不是这样：

```
// Half Comment
if (condition) { ...} [+] <---button to click to get the rest of the comment 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-03T20:36:26.777

你不应该这样做。只需通过**引入解释变量**来重构：

```
 if ( (platform.toUpperCase().indexOf("MAC") > -1) &&
      (browser.toUpperCase().indexOf("IE") > -1) &&
       wasInitialized() && resize > 0 )
 {
   // do something
 } 
```

变成：

```
boolean isMacOs     = platform.toUpperCase().indexOf("MAC") > -1;
boolean isIEBrowser = browser.toUpperCase().indexOf("IE")  > -1;
boolean wasResized  = resize > 0;

if (isMacOs && isIEBrowser && wasInitialized() && wasResized)
{
    // do something
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-03T20:49:55.983

我支持对 Code Complete 的参考：一本优秀的书，程序员应该读一读。

我要记住一些事情：

1.  **不要重复代码**：用一般术语解释它在做什么。

2.  **永远不要假设某事是显而易见的**；澄清和解释代码。

3.  **适当地使用函数来阐明你的意思**：使名称与正在做的事情相关。

4.  **永远不要假设代码是不言自明的**——即使它应该是。最重要的是，永远不要假设某个特定的代码“成语”会被理解它的人阅读：解释代码在做什么。

正如有人所说，如果可以，请不要以否定开头：我有一个编程课，在任何情况下都不允许使用否定 IF。如果真的卡住了，你可以使用你的母语（如英语）来发挥你的优势。代替：

```
if (!eof(f)) 
```

我们可以说：

```
if (moreData(f)) 
```

以你的例子，我会用这样的东西（如果我理解正确的话）：

```
// Make sure that we have a valid request:
// set it if it is not set already
if ( !$request ) {
    $request = $_SERVER['REQUEST_URI'];
} 
```

我还要补充一点：**不要把评论放在盒子里**。“盒子”很难维护和跟上：人们花更多时间修复“盒子”，而不是让评论保持最新。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T19:30:11.307

if 语句的例子很简单，不需要任何评论。过多的注释可能很危险，因为您不仅要维护代码，还要维护注释。对于复杂的 if 语句，您有正确的想法 - 在 if 语句的正上方添加注释。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-03T19:30:32.447

我同意尼尔的观点，无论如何，对于那个例子来说，很明显你正在检查请求是否不存在。放入许多注释实际上会使您的代码在 imo 中的可读性降低。（即评论每一行或每一行代码）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T19:30:50.823

我同意 Evan 的观点 - 编写可读的代码。但是，假设您有需要注释的复杂代码，我使用并更喜欢第一个选项，它可以很好地阅读文本。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-03T19:32:55.810

注释应该解释不清楚的代码。在大多数情况下，不清楚的代码应该重写为清晰。在您的示例中，我认为根本不需要评论。所以可能回答如何表达你的评论是专注于使代码更具可读性，这样你就不需要评论了。

必要时，它们不应只是伪代码，而应提供读者无法立即获得的信息。一个示例可能是“新”语句中的注释，指示内存释放的位置。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-03T19:33:01.723

我会更专注于使代码本身尽可能地自我记录，这意味着好的变量名、函数名等。注释比单独的行更好地用于函数或代码块。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-03T19:34:02.893

除非您的听众是初学者（[1](http://en.wikipedia.org/wiki/Comment_(computer_programming)#Level_of_detail)），否则不要评论显而易见的事情。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-03T19:38:27.937

如果你的变量命名良好，你的 if 语句应该很容易解释。

此外，使用一些“战略”评论应该都是*简单的英语*。

查看此文档中“战术”和“战略”评论的定义[http://www.doc.ic.ac.uk/lab/cplus/c++.rules/chap4.html#sect3](http://www.doc.ic.ac.uk/lab/cplus/c++.rules/chap4.html#sect3)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-03T19:40:50.053

看到这个类似/相同的问题：[Where to put comments in an IF THEN ELSE construction](https://stackoverflow.com/questions/625708/)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-03T19:49:11.287

以这样一种方式命名你的变量/方法，这样评论就变得微不足道了。

如果你的 if 中有很多复杂的条件，那么将这个条件提取到一个布尔函数/方法，清楚地解释它在做什么。

如果您需要评论您的条件，您可能正在使用[Arrow 反模式](http://c2.com/cgi/wiki?ArrowAntiPattern)。

使用[组合方法重构](http://c2.com/ppr/wiki/WikiPagesAboutRefactoring/ComposedMethod.html)来帮助解决这个问题。确保您的方法/函数被封装在相同的抽象级别。多态性将允许您完全摆脱条件。这更好，因为行为是在运行时动态确定的。您必须编写（和维护）代码少了一件事情。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-06-03T19:59:05.150

如前所述，也许您的示例有点过于简单，无法真正对其进行相关评论，但这里有一些一般性建议：

*   通常更容易阅读“积极”条件而不是否定（非条件）

*   毫不犹豫地提取具有详细名称的方法，这些方法将传达意图并避免因此需要一些注释。在您的情况下，假设您创建：

    ```
    function getRequest( $req ) {
        if( isset( $req ) ) {
            return $req;
        } else {
            return $_SERVER['REQUEST_URI'];
        }
    } 
    ```

    但同样，我们需要一个更合适的例子，在你的情况下，这可能是矫枉过正

*   必读 ：

    *   [Martin Fowler 重构](https://rads.stackoverflow.com/amzn/click/com/0201485672)

    *   [编写可靠的代码](https://rads.stackoverflow.com/amzn/click/com/1556155514)

    *   [代码完成](https://rads.stackoverflow.com/amzn/click/com/0735619670)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-06-03T20:06:18.723

我意识到它不适用于您的具体示例，但作为一个学究，我不得不说：只要有可能，不要以否定的方式引导。无论评论如何，这都更难阅读。一般来说，我同意测试应该是清晰的，没有评论，或者你可能想将它提取到一个有意义的方法中。

# svn - 恢复空的 SVN DB 文件

> ID：946660
> 
> 赞同：2
> 
> 时间：2009-06-03T19:27:27.243
> 
> 标签：svn

我试图转储我们的 SVN 存储库，以便将其迁移到更新的硬件。其中一个修订版给了我一个问题，所以我尝试跳过或“跳转”该修订版从该编号转储到更高的修订号，但问题仍然存在：

*svnadmin: 无法读取文件 'D:\repositories\REPO_NAME\db\revs\3677': 找到文件结尾*

事情是我执行了以下命令：

*svnadmin 转储 D:\repositories\REPO_NAME --revision 4000:5000 > D:\4000_5000.dmp*

因此，这应该只转储修订版 4000 到 5000，但由于某种原因，修订版范围确实取决于较低的修订版。

于是我去**db/revs**目录看看冲突文件怎么回事，文件是空的，零字节。

我查看了所有“SVN 红皮书”、SVN 文档和谷歌，但一无所获，有很多恢复存储库的示例，但没有一个有效，例如，运行**svnadmin recover**会引发另一个错误：

*“试图在文件开头移动文件指针”*

所以我现在有点迷路了，有没有办法恢复一个空文件或将它从转储中排除，这样它就不会影响更高的版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T03:13:50.203

> 有没有办法恢复一个空文件？

显然答案是**否定**的。您必须从备份中恢复修订文件。

> 或将其从转储中排除，以免影响更高版本

可以使用`--incremental`交换机来实现这一点：

`svn dump D:\repositories\REPO_NAME --incremental --revision 4000:5000 > D:\4000_5000.dmp`

但是，它不会抱怨，但是您将无法使用 svnadmin load 组装存储库，因为它会抱怨一些缺少的节点（如果它们是在 rev 3677 中添加的）。但这可以让您了解修订版 3677 中发生了什么。

# sql - 在 Oracle 数据库中加载两个相关的表

> ID：946686
> 
> 赞同：2
> 
> 时间：2009-06-03T19:31:54.473
> 
> 标签：sql, oracle, insert

我见过许多类似的问题和答案，但他们使用了其他特定于 DB 的技巧，或者在代码中完成，等等。我正在寻找一个直接的 SQL 批处理文件解决方案（如果它存在）。

我有两个具有父/子关系的表，称它们为 Runs & Run_Values。Runs 有一个“自动”生成的 PK、runID（一个序列和一个触发器）和两个列，Model_Type 和 Time，它们也唯一标识行（通过约束强制执行）。对于 Run 中的每一行，Run_Values 中有许多条目，其中有两列，RunId 和 Value。

我想从制作数据的过程中生成类似的东西（这是我知道存在的 SQL 和我想要的 SQL 的混合）：

```
insert into Runs (Model_Type, Time) values ('model1', to_date('01-01-2009 14:47:00', 'MM-DD-YYYY HH24:MI:SS'));
set someVariable = SELECT runId FROM Runs WHERE Model_Type like 'model1' and Time =  to_date('01-01-2009 14:47:00', 'MM-DD-YYYY HH24:MI:SS'));
insert into Run_Values (run_id, Value) values (someVariable, 1.0);
etc - lots more insert statements with Values for this model run. 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T19:55:00.307

诀窍是使用序列的 CURRVAL。即使它是在数据库触发器中设置的，您也可以使用它。

一个例子：

```
SQL> create table runs
  2  ( runid      number
  3  , model_type varchar2(6)
  4  , time       date
  5  )
  6  /

Table created.

SQL> create sequence run_seq start with 1 increment by 1 cache 100
  2  /

Sequence created.

SQL> create trigger run_bri
  2  before insert on runs
  3  for each row
  4  begin
  5    select run_seq.nextval
  6      into :new.runid
  7      from dual
  8    ;
  9  end;
 10  /

Trigger created.

SQL> create table run_values
  2  ( run_id number
  3  , value number(3,1)
  4  )
  5  /

Table created.

SQL> insert into runs (model_type, time) values ('model1', to_date('01-01-2009 14:47:00', 'mm-dd-yyyy hh24:mi:ss'));

1 row created.

SQL> insert into run_values (run_id, value) values (run_seq.currval, 1.0);

1 row created.

SQL> insert into run_values (run_id, value) values (run_seq.currval, 2.0);

1 row created.

SQL> insert into runs (model_type, time) values ('model2', to_date('01-01-2009 15:47:00', 'mm-dd-yyyy hh24:mi:ss'));

1 row created.

SQL> insert into run_values (run_id, value) values (run_seq.currval, 3.0);

1 row created.

SQL> insert into run_values (run_id, value) values (run_seq.currval, 4.0);

1 row created.

SQL> insert into run_values (run_id, value) values (run_seq.currval, 5.0);

1 row created.

SQL> select * from runs
  2  /

     RUNID MODEL_ TIME
---------- ------ -------------------
         1 model1 01-01-2009 14:47:00
         2 model2 01-01-2009 15:47:00

2 rows selected.

SQL> select * from run_values
  2  /

    RUN_ID      VALUE
---------- ----------
         1          1
         1          2
         2          3
         2          4
         2          5

5 rows selected. 
```

问候，罗布。

# c# - C# 不能将 bool 转换为 int

> ID：946688
> 
> 赞同：41
> 
> 时间：2009-06-03T19:31:59.417
> 
> 标签：c#, .net

我们都知道在 C# 中我们不能将 bool 转换为 int。我想用位掩码看看 true 的二进制表示是什么，但我不能使用 (bool & int).. 我认为问题在于架构设计“true is true, not any number != 0” (C++)我想知道这种架构的好处是什么？C真/假概念有什么不好？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-03T19:35:37.163

当整数不能用于`true`or时，程序员会更清楚`false`。

`if (5 > 0)`更容易理解而不是`if(5)`

这与它们不允许在 switch 语句中出现条件的原因相同。太容易犯错了。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-03T19:40:50.007

在 C 中，整数经常被双重用作普通数和布尔值，例如在某个数不为零时运行的 for 循环。这显然具有简洁代码的优点，就像一个天真的 strlen 例程：

```
const char *s;
for (s = str; *s; ++s)
    ;
return (s - str); 
```

但是虽然简短，但它掩盖了该片段的真正目的，它本质上说“循环，而我正在查看的字符不是空字符”。但是写下来它只是说“当我喜欢它时将其视为布尔值，在其他情况下将其视为数字”。

据称，这种双重性质经常会导致问题，并且会降低代码的可读性（因为您必须从上下文中判断 an 的给定用法`int`是否打算用作`int`或`bool`）。

如果您绝对需要使用布尔值作为整数，您可以使用

```
Convert.ToInt32(someBool) 
```

正如[诺多林提到](https://stackoverflow.com/questions/946688/c-cant-cast-bool-to-int/946718#946718)的那样或自己动手

```
someBool ? 1 : 0 
```

两者都清楚地表明您正在使用 a `int`（而不是 a `bool`）。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-06-03T19:36:18.707

仅供参考，`Convert.ToInt32(fooBool)`应该告诉您它`true`由 1 和`false`0 表示。（这是 BCL 中的任意表示，但不一定是使用它的内存。）

这里的重点是，位表示对于任何程序员来说确实应该是毫无意义的。布尔值用于特定目的（即标志），不应与整数混合使用，否则变量的使用可能会变得相当混乱。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T19:41:41.910

我不认为这个问题与真/假或 1/0 有关，因为它是关于使 C# 成为强类型语言而不是弱类型语言的决定。强类型语言有很多好处（也有一些缺点）。好处之一是它减少了由于表达式的误用（或不正确使用）而导致的错误。

例如，

```
int i = 0;
if (i = 1) {
   ...
} 
```

甚至不会在 C# 中编译，但它会在 C 中编译和执行不正确。

选择使 C# 成为强类型语言意味着 C# 程序员有这些好处。即便如此，如果他们愿意的话，他们也可以引入从 bool 到 int（以及返回）的转换。我怀疑他们没有这样做是因为可能会引入上述错误。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-01-02T22:43:53.967

我们可以使用 Convert.ToInt32，它的定义在这里：

```
public static int ToInt32(bool value); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T19:40:31.350

没有人喜欢任何其他实体的所有决定......只需编写自己的转换器（快速和肮脏）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-21T09:42:15.507

```
var n = (bool)your_int ? 1 : 0 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-08-24T09:27:33.027

int n = (bBool) ? 1 : 0

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-06-03T19:36:35.790

number != 0，太容易出错了。

C# 做出了许多设计决策来颠覆此类可能导致的常见错误。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2010-04-30T22:52:56.260

你在这些方面提出了很好的观点。但是，它确实删除了一个快捷方式。

使用 c，可以通过代码“bBool = 1 - bBool”轻松完成切换。

如果 bBool 为真 (1)，则 1 - 1 = 0。bBool 变为假。

如果 bBool 为假 (0)，则 1 - 0 = 1。bBool 变为真。

相反，在 C# 中，我需要做一个条件来检查状态，然后将其设置为相反的状态，这会给机器和我带来更多的工作。

# c# - 如何在 nunit 中测试通用集合？

> ID：946691
> 
> 赞同：2
> 
> 时间：2009-06-03T19:32:08.513
> 
> 标签：c#, .net, nunit

我怎样才能在 NUnit 中做这样的事情？

```
class Foo
{
    int Value { get; set; }
    ...
}
...
ICollection<Foo> someFoos = GetSomeFoos();
Expect(List.Map(someFoos).Property("Value"), Has.Some.EqualTo(7)); 
```

`List.Map()`只接受`ICollection`，不接受`ICollection<T>`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:36:59.000

好吧，您可以在概念上使用 linq 对象扩展，例如：

Expect(someAs.Count(), Has.Some.EqualTo(7));

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:13:28.867

如果您尝试这样的事情怎么办：

```
List<Foo> someFoos = GetSomeFoos(); 
```

就像实现接口`List<T>` *一样。*`ICollection`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:13:56.337

好吧，您可以将您的转换`ICollection<T>`为实现`ICollection`. 例如数组：

```
ICollection<Foo> someFoos = GetSomeFoos();
var array = new Foo[10];
someFoos.CopyTo(array);
Expect(List.Map(array).Property("Value"), Has.Some.EqualTo(7)); 
```

# iphone - GLPaint 保存图像

> ID：946700
> 
> 赞同：4
> 
> 时间：2009-06-03T19:33:17.620
> 
> 标签：iphone, objective-c, opengl-es, quartz-graphics

我正在尝试在 iPhone 上开发一个复杂的绘画应用程序。我目前正在使用 Quartz 进行绘图（例如`CGContext`...）。不幸的是，Quartz 开销对于我正在做的绘图类型来说太慢了，我正在使用 GLPaint 示例作为参考点移植到 OpenGL 调用。

有没有办法从 EAGLview 类（相当于 Quartz 的 `UIGraphicsGetImageFromCurrentImageContext`）中获取 UIImage/CGImage ？基本上我需要保存由 GLPaint 应用程序绘制的图片。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-12-22T11:09:23.803

```
-(UIImage *) saveImageFromGLView
{
    NSInteger myDataLength = 320 * 480 * 4;
    // allocate array and read pixels into it.
    GLubyte *buffer = (GLubyte *) malloc(myDataLength);
    glReadPixels(0, 0, 320, 480, GL_RGBA, GL_UNSIGNED_BYTE, buffer);
    // gl renders "upside down" so swap top to bottom into new array.
    // there's gotta be a better way, but this works.
    GLubyte *buffer2 = (GLubyte *) malloc(myDataLength);
    for(int y = 0; y <480; y++)
    {
        for(int x = 0; x <320 * 4; x++)
        {
            buffer2[(479 - y) * 320 * 4 + x] = buffer[y * 4 * 320 + x];
        }
    }
    // make data provider with data.
    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, buffer2, myDataLength, NULL);
    // prep the ingredients
    int bitsPerComponent = 8;
    int bitsPerPixel = 32;
    int bytesPerRow = 4 * 320;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;
    // make the cgimage
    CGImageRef imageRef = CGImageCreate(320, 480, bitsPerComponent, bitsPerPixel, bytesPerRow, colorSpaceRef, bitmapInfo, provider, NULL, NO, renderingIntent);
    // then make the uiimage from that
    UIImage *myImage = [UIImage imageWithCGImage:imageRef];
    return myImage;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-01-26T16:54:09.213

与@Quakeboy 的答案相同，但传入视图以便动态确定大小（我将其用于我的通用应用程序）：

```
- (UIImage *)saveImageFromGLView:(UIView *)glView {
    int width = glView.frame.size.width;
    int height = glView.frame.size.height;

    NSInteger myDataLength = width * height * 4;
    // allocate array and read pixels into it.
    GLubyte *buffer = (GLubyte *) malloc(myDataLength);
    glReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, buffer);
    // gl renders "upside down" so swap top to bottom into new array.
    // there's gotta be a better way, but this works.
    GLubyte *buffer2 = (GLubyte *) malloc(myDataLength);
    for(int y = 0; y < height; y++)
    {
        for(int x = 0; x < width * 4; x++)
        {
            buffer2[((height - 1) - y) * width * 4 + x] = buffer[y * 4 * width + x];
        }
    }
    // make data provider with data.
    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, buffer2, myDataLength, NULL);
    // prep the ingredients
    int bitsPerComponent = 8;
    int bitsPerPixel = 32;
    int bytesPerRow = 4 * width;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;
    // make the cgimage
    CGImageRef imageRef = CGImageCreate(width, height, bitsPerComponent, bitsPerPixel, bytesPerRow, colorSpaceRef, bitmapInfo, provider, NULL, NO, renderingIntent);
    // then make the uiimage from that
    UIImage *myImage = [UIImage imageWithCGImage:imageRef];
    return myImage;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-04T00:26:50.693

这绝对是可能的。诀窍是使用 glReadPixels 将图像数据从 OpenGL 帧缓冲区中提取到您可以使用的内存中。一旦有了指向图像数据的指针，就可以使用 CGDataProviderCreateWithData 和 CGI​​mageCreate 从数据中创建 CGImage。我正在开发一个大量使用这种技术的基于 OpenGL 的绘图应用程序！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-30T11:11:41.010

此代码不会像上述解决方案那样泄漏内存，并考虑动态视图大小以及视网膜与标准显示器：

```
-(BOOL)iPhoneRetina{
    return ([[UIScreen mainScreen] respondsToSelector:@selector(displayLinkWithTarget:selector:)] && ([UIScreen mainScreen].scale == 2.0))?YES:NO;
}

void releasePixels(void *info, const void *data, size_t size) {
    free((void*)data);
}

-(UIImage *) glToUIImage{

    int imageWidth, imageHeight;

    int scale = [self iPhoneRetina]?2:1;

    imageWidth = self.frame.size.width*scale;
    imageHeight = self.frame.size.height*scale;

    NSInteger myDataLength = imageWidth * imageHeight * 4;

    // allocate array and read pixels into it.
    GLubyte *buffer = (GLubyte *) malloc(myDataLength);
    glReadPixels(0, 0, imageWidth, imageHeight, GL_RGBA, GL_UNSIGNED_BYTE, buffer);

    // make data provider with data.
    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, buffer, myDataLength, releasePixels);

    // prep the ingredients
    int bitsPerComponent = 8;
    int bitsPerPixel = 32;
    int bytesPerRow = 4 * imageWidth;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo =  kCGImageAlphaPremultipliedLast;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;

    // make the cgimage

    CGImageRef imageRef = CGImageCreate(imageWidth, imageHeight, bitsPerComponent, bitsPerPixel, bytesPerRow, colorSpaceRef, bitmapInfo, provider, NULL, NO, renderingIntent);

    UIImage *myImage = [UIImage imageWithCGImage:imageRef scale:scale orientation:UIImageOrientationDownMirrored]; //Render image flipped, since OpenGL's data is mirrored

    CGImageRelease(imageRef);
    CGColorSpaceRelease(colorSpaceRef);

    CGDataProviderRelease(provider);

    return myImage;
} 
```

其他的泄漏内存是因为 CGDataProviderCreateWithData 的最后一个参数应该是释放内存的函数，而且它们也省略了 CGRelease 函数。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-07-04T09:06:17.337

```
void SaveScreenImage()

{
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
CGImageRef cgImage = UIGetScreenImage();
void *imageBytes = NULL;
if (cgImage == NULL) {
CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
imageBytes = malloc(320 * 480 * 4);
CGContextRef context = CGBitmapContextCreate(imageBytes, 320, 480, 8, 320 * 4, colorspace, kCGImageAlphaNoneSkipFirst | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorspace);
for (UIWindow *window in [[UIApplication sharedApplication] windows]) {
        CGRect bounds = [window bounds];
        CALayer *layer = [window layer];
        CGContextSaveGState(context);
        if ([layer contentsAreFlipped]) {
            CGContextTranslateCTM(context, 0.0f, bounds.size.height);
            CGContextScaleCTM(context, 1.0f, -1.0f);
        }
[layer renderInContext:(CGContextRef)context];
        CGContextRestoreGState(context);
    }
    cgImage = CGBitmapContextCreateImage(context);
    CGContextRelease(context);
}
UIImage *image=[UIImage imageWithCGImage:cgImage];
UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil); 
[pool release];
} 
```

此代码将保存为您在屏幕上看到的内容。但它可能是私有 api。

# asp.net-mvc - ASP.NET MVC ViewResult 问题

> ID：946706
> 
> 赞同：1
> 
> 时间：2009-06-03T19:34:53.343
> 
> 标签：asp.net-mvc, idisposable

让您的 ASP.NET MVC ViewResult 类实现 IDisposable 是否合法？我的自定义视图结果有一个流成员，我想保证它在流回客户端后关闭。ASP.NET MVC 在 ViewResult 实现上是否尊重 IDiposable？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:41:44.000

ViewResult 没有实现 IDisposable 接口。查看[ASP.NET MVC 源代码](http://aspnet.codeplex.com/SourceControl/changeset/view/23011)：

**查看结果.cs：**

```
namespace System.Web.Mvc {
    using System;
    using System.Globalization;
    using System.Text;
    using System.Web.Mvc.Resources;

    public class ViewResult : ViewResultBase {
... 
```

**ViewResultBase.cs：**

```
namespace System.Web.Mvc {
    using System;
    using System.Diagnostics.CodeAnalysis;

    public abstract class ViewResultBase : ActionResult {
... 
```

**动作结果.cs：**

```
namespace System.Web.Mvc {

    public abstract class ActionResult {

        public abstract void ExecuteResult(ControllerContext context);

    }

} 
```

**更新：**

如果您在您的类（派生自 ViewResult）中实现 IDisposable 接口，则 ASP.NET MVC 框架不会调用 Dispose() (IDisposable.Dispose())。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T16:29:24.700

如果你想要这种行为，你可以通过扩展 ControllerActionInvoker 来获得它。我相信您可以执行以下操作：

```
// warning: untested
public class DisposableControllerActionInvoker : ContollerActionInvoker
{
  public override void InvokeActionResult(
      ControllerContext controllerContext, ActionResult actionResult) 
  {
    base.InvokeActionResult(controllerContext, actionResult);
    var disposable = actionResult as IDisposable;
    if(disposable != null) 
    {
      disposable.Dispose();
    }
  }
} 
```

然后，您需要将 ControllerActionInvoker 添加到 Controller，您可以使用自定义控制器工厂来执行此操作（可能有更简单的方法，但我不熟悉）。

# git - 为什么 git push 有时需要一个 localref 参数？

> ID：946714
> 
> 赞同：3
> 
> 时间：2009-06-03T19:35:38.363
> 
> 标签：git, git-push

我今天遇到了 git push 的问题。我试图将一个分支推送到远程存储库，但它给出了一个错误。

经过一番搜索，我在 git irc 频道上问过，有人说推送的语法是

```
git push <remote> <localref>:<remoteref> 
```

到目前为止，我只是使用 git push ，它工作得很好。但在这种情况下，它失败了。

我试图将除 master 之外的某个分支推送到远程服务器，但出现以下错误：

```
error: src refspec xi-temp-dennis does not match any.
error: failed to push some refs to 'remote.server' 
```

通过指定 localref，它突然起作用了。

我的问题是，为什么我这次需要指定 localref？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T20:05:01.863

如果您只是简单地执行“git push remote”而不指定要推送的任何引用，那么 Git 将推送*所有*“匹配的分支”。“匹配分支”是本地仓库中的分支名称与远程仓库中的分支相同的分支。远程仓库的分支将使用本地仓库中的匹配分支进行更新。

所以，如果你只有一个“master”分支，而远程 repo 也有一个“master”分支，那么只需简单的“git push remote”就会将本地 master 推送到远程 master。

您已经创建了一个新分支“xi-temp-dennis”，它不能存在于远程仓库中。因此 Git 无法成功执行推送匹配分支的默认行为（因此出现“不匹配任何”错误）。

您需要告诉 Git 远程端的 ref 名称应该是什么，它会创建它：

```
git push 远程 xi-temp-dennis:foo

```

这将创建一个名为“foo”的远程分支，该分支将被更新。但是，它的名称与您本地分支的名称不匹配，因此您总是需要键入相同的命令（使用 xi-temp-dennis:foo）才能推送更新。如果您希望能够只键入“git push remote”并进行更新，那么您应该将远程分支命名为与本地分支相同：

```
git push 远程 xi-temp-dennis:xi-temp-dennis

```

# scripting - 在脚本中更改任务计划程序中的密码

> ID：946716
> 
> 赞同：2
> 
> 时间：2009-06-03T19:35:50.737
> 
> 标签：scripting

我每个月都会为我在任务计划程序中创建的所有计划任务更改密码。这是因为我们的安全政策每个月都会使我们的密码过期。

由于我正在创建的计划任务数量不断增加，因此在任务计划程序中更改密码会占用大量时间。

我的问题是：脚本中有没有办法在一次运行中更改密码，指定任务、域\用户名和密码？

我知道将密码放入脚本存在安全风险。脚本中的密码将在运行后被删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T20:04:54.373

听起来您的安全策略不允许您使用不会过期的密码设置帐户。您可以使用 at.exe 命令创建批处理文件来安排和执行作业吗？这是一个示例，以防您以前没有使用过该命令：

[如何：使用 At.exe 命令在 Windows NT 中安排备份](http://support.microsoft.com/kb/313289)

# vista64 - adplus/cdb 故障转储在 Vista 64 Ultimate 上是否仍然有效？

> ID：946717
> 
> 赞同：0
> 
> 时间：2009-06-03T19:36:12.387
> 
> 标签：vista64, crash-dumps, adplus, cdb

我正在对 asp.net 错误进行一些研究。我试图让 adplus 给我一个 IIS 崩溃的崩溃转储文件。我过去在 XP 机器上做过这个，但是在我当前的 Vista Ultimate 设置中 - adplus 脚本不会在 CDB 运行时生成第二个窗口。我正在使用管理员权限运行 adplus cmd 窗口。

使用 Tess 的设置说明，一切正常。但是CDB从来没有产生过......

有没有人设法在 Vista 64 Ultimate 中为 IIS 7 设置 adplus/cdb 故障转储？如果是这样，你能解释一下你是怎么做到的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:38:05.723

确保获得 64 位调试包： http: [//www.microsoft.com/whdc/devtools/debugging/install64bit.mspx#](http://www.microsoft.com/whdc/devtools/debugging/install64bit.mspx#)

# geocoding - 如何对美国的电话号码进行地理编码？

> ID：946719
> 
> 赞同：5
> 
> 时间：2009-06-03T19:36:29.547
> 
> 标签：geocoding, telephony

我正在寻找一种方法来获取美国任何区号+前缀陆线电话的经纬度坐标。有谁知道可用于执行此操作的数据提供者或服务？

**编辑：** 我知道手机或 VOIP 线路的位置可能无法进行地理编码，这对我来说很好。我只对[POTS](http://en.wikipedia.org/wiki/Plain_old_telephone_service)电话号码感兴趣。虽然，如果能够根据前缀识别电话服务的类型会很好（如果这可能的话）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:48:02.287

有一些网站可以做到这一点，例如~~http://www.thedirectory.org~~ [编辑：链接现在不好]。我不知道他们是否有任何你可以使用的 RESTful api，尽管我猜你总是可以对它们进行屏幕截图。据推测，他们使用的原始数据应该是您可以自己获得的东西，可能来自电话公司。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T15:16:07.003

我找到了一些价格合理的选项：

### 选项 1（网络服务订阅）：

服务对象~~[DOTS GeoPhone](http://www.serviceobjects.com/products/phone/geophone/)~~ [edit: link is no good now] web 服务应该可以很好地解决问题。它甚至似乎提供了我希望的“电话服务类型”信息。

### 选项 2（数据库订阅）：

~~[AreaCodeWorld™ 白金版](http://www.areacodeworld.com/areacodeplatinum.htm)~~[edit: link is no good now] 是一种数据库产品，可以一次性购买或通过年度订阅购买。数据规范包括所有北美区号和前缀以及纬度和经度坐标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T22:30:17.900

使用 Google Geocoding API 和 allareacodes.com 上的列表，我为一个黑客项目创建了这个 json：

~~http://pintweets.com/area_codes.json~~ [编辑：链接现在不好]

显然，这不是法庭可接受的证据，但它应该适用于某些目的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-29T19:22:48.483

~~[EveryoneAPI][1]~~ [编辑：链接现在转到不相关的新站点] 将完全符合您的要求。

您可以通过在 HTTP 请求中添加“data=location”来将查询限制为仅限位置，您将得到如下信息：

```
"location": {
  "city": "Birmingham",
  "geo": {
    "latitude": "33.51685254860801",
    "longitude": "-86.81075983815001"
  },
  "state": "AL",
  "zip": "35203"
} 
```

免责声明：我是 Telo 的 CEO。[1]：[https ://www.everyoneapi.com/](https://www.everyoneapi.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T19:45:24.880

邮政编码有公开可用的地理编码数据（尽管它们给出的位置是相应邮局的地理编码），因此您可以通过这种方式建立对应关系（尽管您必须或多或少随机选择特定的邮政编码，因为邮编比区号多）。

但是会有一些内置错误。有些号码（例如 800 个号码）没有设计特定的位置。与手机号码相同。在任何情况下，在纽约，都有以与位于纽约的电话号码相同的区号开头的小区号码（例如 718、212）。我不确定运营商是否需要以与客户账单地址相对应的方式提供这些号码，因此您可能会遇到这样的情况：大多数 212 号码是纽约市，但有些是手机在威奇托。

# jquery - 为什么 JQuery Form submitHandler 不刷新它的回调？

> ID：946729
> 
> 赞同：1
> 
> 时间：2009-06-03T19:38:11.933
> 
> 标签：jquery, jquery-plugins, jquery-validate, jquery-forms-plugin

我正在使用[JQuery Form Plugin](http://malsup.com/jquery/form/)、[JQuery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/ "jQuery 验证插件")和 jqTransform 插件。

我有一个隐藏的表单，我可以看到它来添加或编辑东西。编辑或添加操作会触发下一个函数调用。

```
function activateAddForm(formId,callback) {
    $('#'+formId).jqTransform().validate({
            submitHandler: function(form) {
                $(form).ajaxSubmit( {
                    dataType: "json", 
                    success: function(json) {
                        callback(json);
                    }
                });                 
            }
        }); 
} 
```

每个调用都有不同的参数。对于添加，我称之为

```
activateAddForm('add-new-form',addToy); 
```

为了编辑，我称之为

```
activateAddForm('add-new-form',editToy); 
```

这就是发生的事情：

*   重新加载页面。
*   编辑一个玩具。
*   提交表格。
*   调用 editToy 函数。
*   尝试添加一些东西。
*   函数 activateAddForm 使用 addToy 作为回调调用，但是一旦提交表单，就会调用 editToy 函数。

如果我在重新加载后做的第一件事是添加一个玩具。然后总是调用 addToy 函数。

我试过添加：

```
function activateAddForm(formId,callback) {
    $('#'+formId).ajaxFormUnbind();
    ...
} 
```

或者

```
function activateAddForm(formId,callback) {
    $('#'+formId).resetForm();
    ...
} 
```

但它没有工作。知道我能做什么吗？

## 变通方法试验

Activa 建议添加该行：

```
$.removeData($('#'+formId)[0],'validator');

function activateAddForm(formId,callback) {
$('#'+formId).jqTransform();
$.removeData($('#'+formId)[0],'validator');
$('#'+formId).validate({
        submitHandler: function(form) {
            $(form).ajaxSubmit( {
                dataType: "json", 
                success: function(json) {
                    callback(json);
                }
            });                 
        }
    }); 
} 
```

下一个案例：

*   重新加载页面。
    *   编辑一个玩具。
    *   提交表格。
    *   调用 editToy 函数。
    *   尝试添加一些东西。
    *   调用表单 editToy 函数，然后调用 add 函数。

上述修复不起作用，但似乎方向正确。

还有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-18T08:30:48.093

我认为如果您只是更改验证器的 submitHandler 而不是将其放入验证函数的参数中，它会简单得多。

```
$('#form').validate().settings.submitHandler = function () {
   // your function goes here.
}
$('#form').submit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T17:39:54.527

在检查了验证器插件的源代码后，似乎一旦调用了 validate() 函数，随后对 validate() 的调用就没有任何效果。

一种解决方法是在调用 validate() 之前调用以下命令：

```
$.removeData($('#'+formId)[0],'validator'); 
```

编辑：

再次检查您的代码，我认为我们需要更改策略:-)

```
function updateAddForm(formId,callback) {
$('#' + formId).data("successCallback",callback);
}

function initAddForm(formId) {
$('#'+formId).jqTransform()..validate({
        submitHandler: function(form) {
                $(form).ajaxSubmit( {
                        dataType: "json", 
                success: function(json) {
                        $('#'+formId).data("successCallback")(json);
                }
                        });                     
        }
    }); 
} 
```

在开始时，您调用：

```
initAddForm('add-new-form'); 
```

要设置回调，请调用：

```
updateAddForm('add-new-form', addToy); 
```

或者

```
updateAddForm('add-new-form', editToy); 
```

这可能会奏效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-27T06:28:30.657

```
$('#comment').validate({
      rules:{
               comments:{required:true}
         },
    messages:{
               comments:{required:'Please enter the comment' }
          },
           submitHandler: function(form) { //asynchronusly post the form data

                        var url=MAIN_SITE_URL+'rating/getrate/';
                        var comments=$('#comments').val(); 
                        url+='rating/comment/'+comments;
                        $.post(url,$('#rating').serialize(),
                                             function(response){alert(response); }

           }
     }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T12:59:40.847

没有足够的信息来回答您的问题。如果您在 firefox 中工作，请尝试安装 firebug 插件并尝试检查表单元素。

从这里的描述中，我可以看到您可能在同一页面上使用了两个具有相同 ID 的不同表单元素。我要做的第一件事是通过唯一的 ID 元素来区分表单，例如：edit-form add-form

只是一个想法，我希望有人会给你一个更好的答案。

# rest - Spring 3.0 REST 实现 DispatcherServlet 找不到映射

> ID：946735
> 
> 赞同：3
> 
> 时间：2009-06-03T19:38:58.403
> 
> 标签：rest, spring-mvc

我正在尝试让一个简单的 REST 服务与 Spring 3.0 一起使用，但不断遇到阻塞错误：

在名称为“dispatcher”的 DispatcherServlet 中找不到具有 URI [/travel/us/nyc/sfo/20091010/1122/true/] 的 HTTP 请求的映射*

但是，在日志文件中它还指出：

org.springframework.web.servlet.mvc.annotation.Def aultAnnotationHandlerMapping - 将 URL 路径 [/travel/us/{from}/{to}/{date}/{time}/{departure}/] 映射到处理程序 [experiment. SomeController@dd9f85]*

我读到这表明存在从 URI 到 Experiment.SomeController 类作为处理程序的映射。

我一定是忽略了其中一个配置文件中的一个简单错误，但是在检查了所有内容并进行了相当多的谷歌搜索之后，我还没有找到解决方案。我已经为 Spring 类打开了日志记录，但这也没有揭示问题。

以下是相关的配置文件和一些代码片段，请提供任何帮助。webapp 部署到 Glassfish v2.1，我在 OS X 的 JDK1.5 上使用 Spring 3.0.0 的 M3 构建。

目标是让 getTripDetails() 返回行程详细信息的 XML 版本。因此使用 MarshallingView。

来自 web.xml：

```
<小服务程序>
<servlet-name>调度程序</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
<load-on-startup>1</load-on-startup>
</servlet>

<servlet 映射>
<servlet-name>调度程序</servlet-name>
<url-pattern>/*</url-pattern>
</servlet-mapping>

```

从 dispatcher-servlet.xml 中：

```
<context:annotation-config />
<context:component-scan base-package="net.vermaas.reisadvies.server" />

<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
<property name="alwaysUseFullPath" value="true"/>
</豆>

<bean id="viewResolver" class="org.springframework.web.servlet.view.Content tNegotiatingViewResolver">
<属性名称="媒体类型">
<地图>
<entry key="xml" value="application/xml"/>
</地图>
</属性>
<property name="viewResolvers">
<列表>
<bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>
<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
<property name="prefix" value="/WEB-INF/jsp/"/>
<property name="suffix" value=".jsp"/>
</豆>
</列表>
</属性>
</豆>

<bean id="marshaller" class="org.springframework.oxm.xstream.XStreamMars haller">
</豆>

<bean id="content" class="org.springframework.web.servlet.view.xml.MarshallingView">
<property name="contentType" value="application/xml" />
<property name="marshaller" ref="marshaller"/>
</豆>

```

控制器类： `@Controller public class SomeController {`

 `static Logger logger = Logger.getLogger(SomeController.class);

public SomeController() { }

@RequestMapping(value="/travel/us/{from}/{to}/{date}/{time}/{departure}", method=RequestMethod.GET)

public ModelAndView getTripDetails(@PathVariable String from, @PathVariable String to, @PathVariable String date, @PathVariable String time, @PathVariable boolean departure, Model model) {

```
logger.debug("getTripDetails"); // not logged

// Do some stuff
TripDetails td = ...

ModelAndView mav = new ModelAndView();
mav.setViewName("content");
mav.addObject("tripDetails", td);

return mav; 
```

}

}`  `有什么想法吗？或者指向具有 XML 作为输出的 Spring 3.0 的 REST 服务的工作示例的指针？

问候，格罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-30T09:34:40.743

我也遇到了同样的问题，它与 Spring 3.0 一起使用的方式是将 url-pattern 中的 /* 替换为 /

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-26T22:00:14.620

你必须做这样的事情：

```
<servlet-mapping>
    <servlet-name>baseproj</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

否则您的 css、js 和图像将无法解析。我知道这很糟糕，但必须完成。无论如何，我都用 apache mod_jk 屏蔽了[http://localhost:8080/myapp/rest](http://localhost:8080/myapp/rest)部分，所以没关系。

# c++ - 计算机单元；试图编译类来测试

> ID：946737
> 
> 赞同：2
> 
> 时间：2009-06-03T19:39:27.733
> 
> 标签：c++, cppunit

我对 C++ 和 Cppunit 都很陌生。我正在尝试编译一个小 cppunit 测试。但是，我没有成功。

```
qwerty@qwerty:~/chessgame/src$ g++ -Wall CoordinateTest.cpp ftest.cpp -lcppunit -o test
/tmp/cc1vJJqz.o: In function `CoordinateTest::coordinateTest()':
CoordinateTest.cpp:(.text+0xbb): undefined reference to `Coordinate::Coordinate(int const&, int const&)'
CoordinateTest.cpp:(.text+0xe2): undefined reference to `Coordinate::Coordinate(int const&, int const&)'
collect2: ld returned 1 exit status 
```

这是源代码。我在这里想念什么？

----- Coordinate.h ------------------------------------------ ----------------------

```
#ifndef COORDINATE_H
#define COORDINATE_H

class Coordinate
{

    public:
        Coordinate(const int& x, const int& y);
        void setCoordinates(const int& x, const int& y);
        const int& getCoordinateX() const;
        const int& getCoordinateY() const;

    private:
        int mX;
        int mY;

};

#endif 
```

----- Coordinate.cpp ------------------------------------------ ----------------------

```
#include "Coordinate.h"

Coordinate::Coordinate(const int& x, const int& y) : mX(x),mY(y)
{
}

void Coordinate::setCoordinates(const int& x, const int& y)
{
    mX = x;
    mY = y;
}

const int& Coordinate::getCoordinateX() const
{
    return mX;
}

const int& Coordinate::getCoordinateY() const
{
    return mY;
} 
```

----- CoordinateTest.h ------------------------------ ----------------------

```
#ifndef COORDINATETEST_H
#define COORDINATETEST_H

#include <cppunit/TestFixture.h>
#include <cppunit/extensions/HelperMacros.h>
#include "Coordinate.h"

class CoordinateTest : public CPPUNIT_NS::TestFixture
{
    CPPUNIT_TEST_SUITE (CoordinateTest);
    CPPUNIT_TEST (coordinateTest);
    CPPUNIT_TEST_SUITE_END ();

    public:
        void setUp();
        void tearDown();

protected:
        void coordinateTest();

};

#endif 
```

----- CoordinateTest.cpp ------------------------------ ----------------------

```
#include "CoordinateTest.h"

CPPUNIT_TEST_SUITE_REGISTRATION (CoordinateTest);

void CoordinateTest::setUp(void)
{

}

void CoordinateTest::tearDown(void) 
{

}

void CoordinateTest::coordinateTest(void)
{
    Coordinate from(1, 0);
    Coordinate to(2, 0);
    CPPUNIT_ASSERT_EQUAL (true, true);
} 
```

----- ftest.cpp ------------------------------------------ ----------------------

```
#include "CoordinateTest.h"
#include <cppunit/CompilerOutputter.h>
#include <cppunit/extensions/TestFactoryRegistry.h>
#include <cppunit/TestResult.h>
#include <cppunit/TestResultCollector.h>
#include <cppunit/ui/text/TestRunner.h>
#include <cppunit/BriefTestProgressListener.h>

int main (int argc, char* argv[])
{
    // informs test-listener about testresults
    CPPUNIT_NS::TestResult testresult;

    // register listener for collecting the test-results
    CPPUNIT_NS::TestResultCollector collectedresults;
    testresult.addListener(&collectedresults);

    // register listener for per-test progress output
    CPPUNIT_NS::BriefTestProgressListener progress;
    testresult.addListener(&progress);

    // insert test-suite at test-runner by registry
    CPPUNIT_NS::TestRunner testrunner;
    testrunner.addTest (CPPUNIT_NS::TestFactoryRegistry::getRegistry().makeTest());
    testrunner.run(testresult);

    // output results in compiler-format
    CPPUNIT_NS::CompilerOutputter compileroutputter(&collectedresults, std::cerr);
    compileroutputter.write();

    // return 0 if tests were successful
    return collectedresults.wasSuccessful() ? 0 : 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:50:11.313

尝试将 Coordinate.cpp 添加到您的命令行。

> qwerty@qwerty:~/chessgame/src$ g++ -Wall CoordinateTest.cpp ftest.cpp -lcppunit -o test

=>

> qwerty@qwerty:~/chessgame/src$ g++ -Wall CoordinateTest.cpp Coordinate.cpp ftest.cpp -lcppunit -o test

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:49:24.653

添加`coordinate.cpp`到您的命令行。链接器找不到任何`Coordinate::*`方法的主体。

# ruby - 在 Ruby 中检测没有 getc/gets 的按键（非阻塞）

> ID：946738
> 
> 赞同：20
> 
> 时间：2009-06-03T19:39:29.887
> 
> 标签：ruby, input, nonblocking

我有一个简单的任务，需要等待文件系统上的某些东西发生变化（它本质上是一个原型编译器）。所以我有一个简单的无限循环，在检查更改的文件后休眠 5 秒。

```
loop do
  # if files changed
  #   process files
  #   and puts result
  sleep 5
end 
```

而不是`Ctrl+C`敬礼，我宁愿能够测试并查看是否按下了某个键，而不会阻塞循环。本质上，我只需要一种方法来判断是否有传入的按键，然后抓住它们直到遇到 Q，然后退出程序。

我想要的是：

```
def wait_for_Q
  key_is_pressed && get_ch == 'Q'
end

loop do
  # if files changed
  #   process files
  #   and puts result
  wait_for_Q or sleep 5
end 
```

或者，这是 Ruby 没有做的事情（很好）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-04T01:32:31.747

这是一种方法，使用`IO#read_nonblock`：

```
def quit?
  begin
    # See if a 'Q' has been typed yet
    while c = STDIN.read_nonblock(1)
      puts "I found a #{c}"
      return true if c == 'Q'
    end
    # No 'Q' found
    false
  rescue Errno::EINTR
    puts "Well, your device seems a little slow..."
    false
  rescue Errno::EAGAIN
    # nothing was ready to be read
    puts "Nothing to be read..."
    false
  rescue EOFError
    # quit on the end of the input stream
    # (user hit CTRL-D)
    puts "Who hit CTRL-D, really?"
    true
  end
end

loop do
  puts "I'm a loop!"
  puts "Checking to see if I should quit..."
  break if quit?
  puts "Nope, let's take a nap"
  sleep 5
  puts "Onto the next iteration!"
end

puts "Oh, I quit." 
```

请记住，即使这使用非阻塞 IO，它仍然是*缓冲*IO。这意味着您的用户将不得不`Q`点击`<Enter>`. 如果您想做无缓冲的 IO，我建议您查看 ruby​​ 的 curses 库。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-01-30T20:28:06.393

您也可以在没有缓冲区的情况下执行此操作。在基于 Unix 的系统中，这很容易：

```
system("stty raw -echo") #=> Raw mode, no echo
char = STDIN.getc
system("stty -raw echo") #=> Reset terminal mode
puts char 
```

这将等待一个键被按下并返回字符代码。无需按。

把它`char = STDIN.getc`放到一个循环中，你就搞定了！

如果您在 Windows 上，根据 The Ruby Way，您需要用 C 编写扩展或使用这个小技巧（虽然这是在 2001 年编写的，所以可能有更好的方法）

```
require 'Win32API'
char = Win32API.new('crtdll','_getch', [], 'L').Call 
```

这是我的参考：[好书，如果你不拥有它，你应该](http://books.google.com/books?id=ows9jTsyaaEC&pg=PA222&lpg=PA222&dq=ruby%20wait%20for%20keyboard&source=bl&ots=ilSHDQugBk&sig=E9qcsVHpqNEl2CoIFggQewgN0iw&hl=en&ei=9r5FTZncBITogQevr-DNAQ&sa=X&oi=book_result&ct=result&resnum=7&ved=0CEcQ6AEwBg#v=onepage&q&f=false)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-06T18:30:40.150

其他答案的组合可以获得所需的行为。在 OSX 和 Linux 上的 ruby​​ 1.9.3 中测试。

```
loop do
  puts 'foo'
  system("stty raw -echo")
  char = STDIN.read_nonblock(1) rescue nil
  system("stty -raw echo")
  break if /q/i =~ char
  sleep(2)
end 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-26T11:42:41.910

通过结合我刚刚阅读的各种解决方案，我想出了一个跨平台的方法来解决这个问题。 [这里有详细信息](http://blog.x-aeon.com/2014/03/26/how-to-read-one-non-blocking-key-press-in-ruby/)，但这里是相关的代码：`GetKey.getkey`返回 ASCII 码的方法，或者`nil`如果没有按下。

应该在 Windows 和 Unix 上都可以工作。

```
module GetKey

  # Check if Win32API is accessible or not
  @use_stty = begin
    require 'Win32API'
    false
  rescue LoadError
    # Use Unix way
    true
  end

  # Return the ASCII code last key pressed, or nil if none
  #
  # Return::
  # * _Integer_: ASCII code of the last key pressed, or nil if none
  def self.getkey
    if @use_stty
      system('stty raw -echo') # => Raw mode, no echo
      char = (STDIN.read_nonblock(1).ord rescue nil)
      system('stty -raw echo') # => Reset terminal mode
      return char
    else
      return Win32API.new('crtdll', '_kbhit', [ ], 'I').Call.zero? ? nil : Win32API.new('crtdll', '_getch', [ ], 'L').Call
    end
  end

end 
```

这是一个简单的程序来测试它：

```
loop do
  k = GetKey.getkey
  puts "Key pressed: #{k.inspect}"
  sleep 1
end 
```

在上面提供的链接中，我还展示了如何使用该`curses`库，但结果在 Windows 上有点奇怪。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-16T15:04:05.560

您可能还想研究`ready?`为所有 IO 对象提供方法的 Ruby 的“io/wait”库。我没有专门测试过你的情况，但是我在我正在研究的基于套接字的库中使用它。在您的情况下，如果 STDIN 只是一个标准 IO 对象，您可能会在`ready?`返回非零结果时退出，除非您有兴趣找出实际按下的键。这个功能可以通过`require 'io/wait'`Ruby 标准库的一部分来实现。我不确定它是否适用于所有环境，但值得一试。Rdocs：[http: //ruby-doc.org/stdlib/libdoc/io/wait/rdoc/](http://ruby-doc.org/stdlib/libdoc/io/wait/rdoc/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-10T12:23:00.300

现在用这个

```
require 'Win32API'

VK_SHIFT = 0x10
VK_ESC = 0x1B

def check_shifts()
    $listener.call(VK_SHIFT) != 0 ? true : false
end

# create empty Hash of key codes
keys = Hash.new

# create empty Hash for shift characters
uppercase = Hash.new

# add letters
(0x41..0x5A).each { |code| keys[code.chr.downcase] = code }

# add numbers
(0x30..0x39).each { |code| keys[code-0x30] = code }

# add special characters
keys[';'] = 0xBA; keys['='] = 0xBB; keys[','] = 0xBC; keys['-'] = 0xBD; keys['.'] = 0xBE 
keys['/'] = 0xBF; keys['`'] = 0xC0; keys['['] = 0xDB; keys[']'] = 0xDD; keys["'"] = 0xDE 
keys['\\'] = 0xDC

# add custom key macros
keys["\n"] = 0x0D; keys["\t"] = 0x09; keys['(backspace)'] = 0x08; keys['(CAPSLOCK)'] = 0x14

# add for uppercase letters
('a'..'z').each { |char| uppercase[char] = char.upcase }

# add for uppercase numbers
uppercase[1] = '!'; uppercase[2] = '@'; uppercase[3] = '#'; uppercase[4] = '$'; uppercase[5] = '%'
uppercase[6] = '^'; uppercase[7] = '&'; uppercase[8] = '*'; uppercase[9] = '('; uppercase[0] = ')'

# add for uppercase special characters
uppercase[';'] = ':'; uppercase['='] = '+'; uppercase[','] = '<'; uppercase['-'] = '_'; uppercase['.'] = '>'
uppercase['/'] = '?'; uppercase['`'] = '~'; uppercase['['] = '{'; uppercase[']'] = '}'; uppercase["'"] = '"'
uppercase['\\'] = '|'

# create a listener for Windows key-presses
$listener = Win32API.new('user32', 'GetAsyncKeyState', ['i'], 'i')

# call listener once to initialize lsb's
keys.each_value { |code| $listener.call(code) }

logs = File.open('C://kpkt.txt', 'a')

while true
    break if $listener.call(VK_ESC) != 0

    keys.each do |char, code|
        n = $listener.call(code)
        if n and n & 0x01 == 1
            check_shifts() ? logs.write("#{uppercase[char]}") : logs.write("#{char}")
        end
    end
end

logs.close() 
```

# wcf - WCF 文件权限？

> ID：946739
> 
> 赞同：0
> 
> 时间：2009-06-03T19:39:42.817
> 
> 标签：wcf, iis, wcf-security

我有一个在 IIS 中托管的 WCF Web 服务（实际上在 Visual Studio Web 主机中运行，即 Cassini）。

我有一个文件，我必须从服务访问 web 目录的根目录，并且无法确定服务访问目录的用户身份。我已经允许 ASPNET、NETWORK SERVICE 和 IUSR，但这些似乎都不起作用。

任何人都知道 WCF 服务在 IIS 中托管时运行的用户是什么？

更多信息：

实际上，WCF 服务正在以我（我的 windows 帐户）身份运行，但无论出于何种原因，它仍然无法在其根目录中打开文件。该文件因“拒绝访问”而失败。我已将文件夹的完全控制权授予“所有人”，这似乎并不重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:47:05.580

如果您使用 Cassini 运行 yr 服务，那么它将是登录到该计算机的用户。所以可能是你用来登录那台机器的用户名。授予该用户读取文件并尝试的权限。

在 IIS 上，它取决于您的应用程序配置。您可以在任何用户帐户下创建应用程序池，并使用该池运行您的应用程序。IIS 中的默认用户是 NETWORK SERVICES。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T19:26:49.087

好吧……想通了这个问题。原来我试图打开的文件被标记为只读，所以.NET 无法打开它进行写入。将 FileAccess.Read 传递给 File.Open() 方法，现在它可以正常打开了。

与 WCF 本身无关。

# iphone - AVAudioPlayer iPhone 问题

> ID：946743
> 
> 赞同：2
> 
> 时间：2009-06-03T19:39:59.243
> 
> 标签：iphone, cocoa, avaudioplayer, microphone

使用 AVAudioPlayer，我可以从我的麦克风流式传输实时音频吗？

如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T01:22:29.037

不。

AVAudioPlayer 只能播放音频文件。

根据您要完成的工作，您可能需要查看Apple 示例代码中的AudioQueues 和[aurioTouch示例](http://developer.apple.com/iphone/library/samplecode/aurioTouch/index.html "aurioTouch 示例")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T07:31:45.960

使用 AudioQueues，您在填充缓冲区时总是会有一点延迟，AudioUnits 将是您可以立即处理声音的最佳选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T12:37:17.107

正如pjapers所说。你应该使用 AudioUnits

# visual-studio-2008 - 发布 Web 服务时出现首页服务器扩展问题

> ID：946744
> 
> 赞同：0
> 
> 时间：2009-06-03T19:40:05.470
> 
> 标签：visual-studio-2008, web-services, iis

我正在为我的应用程序创建一个 Web 服务来与之交谈。当我去（本地）发布它时，VS 告诉我服务器似乎没有安装首页服务器扩展。这是正确的。

具体来说，该消息显示：“Web 服务器似乎没有安装 FrontPage 服务器扩展。如果安装了 FrontPage 服务器扩展，则可能会出现此错误，因为 _vti_bin 虚拟目录未标记为可执行文件。要更正此问题，请运行 Internet 信息服务管理器，选择有问题的 Web 服务器，然后使用检查服务器扩展命令。”

我通过 xp pro cd 安装了扩展。[我按照这里](http://support.microsoft.com/kb/298158)的说明注册了它们。

我使用“aspnet_regiis -i -enable”注册了asp。

我打开 IIS，只显示我的机器和运行的“默认网站”。我也不太清楚如何运行“检查服务器扩展”命令。

我想在本地托管此 Web 服务，以便我可以对其进行测试，然后将其发送给服务器管理员以将其安装在生产服务器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:43:06.570

您如何尝试发布服务？不再需要 FrontPage 服务器扩展。

# apache - Mercurial推送，中止：授权失败

> ID：946745
> 
> 赞同：47
> 
> 时间：2009-06-03T19:40:23.940
> 
> 标签：apache, mercurial, https, apache2, repository

我在推送到 mercurial 存储库时遇到问题：

```
$ hg push
pushing to https://user:***@hg.domain.com/X_repo
searching for changes
abort: authorization failed 
```

可以通过 Web 浏览器访问相同的 URL（具有相同的凭据）。另外，我在没有将 usr+pass 嵌入 URL 的情况下进行了尝试。

HTTPS 配置正确，我尝试了 Basic 和 Digest auth —— 没有运气。

拉（通过 HTTP）工作正常。

我正在使用 hgwebdir 为我的仓库提供服务。

我还应该检查什么？

我发现了这个：[http](http://code.google.com/p/support/issues/detail?id=2580) ://code.google.com/p/support/issues/detail?id=2580 在我的情况下它不是随机的，它每次都会发生。

我的虚拟主机配置的相关部分：

```
 WSGIScriptAlias  /  /home/(...)/hgwebdir.wsgi

  <Directory /home/(...)>
    AuthType Basic
    AuthUserFile /(...)/basic-password
    AuthName (...)
    Require valid-user

    Order deny,allow
    Allow from all
  </Directory>

$ hg -v
Mercurial Distributed SCM (version 1.0.2) 
```

奇怪的是，hg 传出工作正常：

```
$ hg outgoing
comparing with https://hg.domain.com/X_repo
http authorization required
realm: ...
user: ...
password: 
searching for changes
changeset:   64:...
tag:         tip
user:        ...
date:        ...
summary:     ... 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2010-10-01T18:21:55.360

如果有人想让它在本地机器上运行，那么将它添加到服务器`REPO/.hg/hgrc`就可以了：

```
[web]
allow_push = *
push_ssl = false 
```

如[本网站](https://www.mercurial-scm.org/wiki/HgWebDirStepByStep#Allow_pushing_to_the_repository)所述。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-05T20:46:17.087

问题原来是回购目录权限。`chown www-data`解决了...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-04T06:57:17.837

很奇怪，您可以运行但不能运行*，*因为我的理解是它们都以相同的方式进行身份验证。`hg outgoing``hg push`

不幸的是，我不是 hgweb 专家。请邮寄到[Mercurial 列表](https://www.mercurial-scm.org/wiki/MailingLists)(mercurial@mercurial-scm.org) 和/或在 IRC ( `#mercurial`on `irc.freenode.net`) 上在线。那里会有更多的人来帮助你。IRC 特别好，因为这些东西更容易交互式调试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-29T07:08:45.007

对于那些将 TortoiseHg 推送到 Web 服务器的人（另一台 PC 上的另一个未经授权的用户）：

在 TortoiseHg:`File - Settings - (Either globally or just for the current repository - tabs)`然后`Server`设置。网络服务器

```
Push Requires SSL - No
Allow Push - * 
```

这通过 UI 执行与`lukmdo`上面的答案相同的操作（编辑 hgrc 文件）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-13T09:50:25.463

以防万一它可能对某人有所帮助 - 我因未知原因遇到此错误，所有权限都正常，只需重新启动 apache 即可解决。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-24T21:12:03.667

我的问题有点不同。密码更改触发了它......我有一个`repo/.hgrc`和一个`repo/.hg/hgrc`。不知道为什么，但这些是相互矛盾的。

作为记录，我发现的最干净的方法是保留一个全局配置文件（在 Windows`C:\Users\<user>\mercurial.ini`或 Linux上`/home/<user>/.hgrc`），其中包含适用于所有存储库（配置文件、插件/扩展、存储库等）的所有配置，然后每个存储库，只需使用类似的东西：

```
[paths]  
default = https://path/to/remote/repo

# any other repo-specific config 
```

为什么我有另一个特定于 repo 的 mercurial 配置文件，我不知道——现在一切都已清理干净并且运行良好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-17T18:56:31.213

这发生在我更改我的 bitbucket 密码后，然后虽然我使用 SourceTree 来管理我的密码并且我在全球范围内更改了它，但是一个 repo 将我的旧密码硬编码在`REPO/.hg/hgrc`更改了行并且所有工作都再次

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-13T01:12:58.887

我的解决方案！如果您使用的是 Windows 操作系统，则需要编辑文件夹属性。读/写权限。

[![在此处输入图像描述](https://i.stack.imgur.com/NhbCh.png)](https://i.stack.imgur.com/NhbCh.png)

很重要！！不要忘记关闭网络服务器，编辑文件夹属性并再次打开网络服务器 tortoiseHG

# c# - 在等待 WaitHandle 时运行消息循环

> ID：946746
> 
> 赞同：3
> 
> 时间：2009-06-03T19:40:30.367
> 
> 标签：c#, .net, multithreading, waithandle, message-loop

当 UI 线程等待 WaitHandle 或其他线程原语时，有什么方法可以处理所有 Windows 消息？

我意识到它可能会产生非常混乱的重入问题；无论如何我都想做。

**编辑**：等待发生在必须在 UI 线程上运行的复杂函数的中间。因此，将等待移至后台线程不是一种选择。（将功能一分为二会造成复杂且无法维护的混乱）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T20:30:03.043

我会在一个单独的后台线程中运行整个“不能拆分的复杂功能”，并让它仅在需要时向 GUI 报告（在控件上使用 Invoke/BeginInvoke 方法） .

在更增强的版本中，您应该在不依赖 UI 且更易于单元测试的非 UI 控制器中运行复杂的功能。回调 UI 并在 UI 中显示结果，可以通过让 UI 订阅控制器提供的事件来轻松实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T19:41:55.917

你为什么不直接产生另一个线程来等待，并让他在适当的时刻通过消息（或其他）通知 UI 线程？

这是在阻塞事件期间允许 UI 线程消息处理的常用方法。

编辑：我现在明白了——你在 UI 代码中内置了应用程序逻辑逻辑。那么，这确实是一个设计问题。从长远来看，您最好将该功能从 UI 拆分为一个独立的对象，并使用某种机制与您的工作人员的 UI 进行状态通信。

除了使您的 UI 代码专注于 UI 的好处之外，这还允许您单独对逻辑代码进行单元测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T19:49:37.963

不确定 C#，但在普通的 Win32 编程中，您可以使用 MsgWaitFor...() 函数之一进行实际等待。它会在消息队列中出现消息时以及正在等待的对象何时发出信号时通知您。如果它报告消息存在，您可以调用 GetMessage()、TranslateMessage() 和 DispatchMessage() 来处理消息，然后返回等待。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T19:56:07.777

我通常建议将您的等待条件放在另一个线程上。

但是，话虽如此，您始终可以随时调用[Application.DoEvents](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents.aspx)来处理消息泵，包括在等待句柄上“等待”时（只是超时、执行事件、超时等待等，直到您“通过”等待句柄）。

# flash - 舞台截图

> ID：946748
> 
> 赞同：0
> 
> 时间：2009-06-03T19:40:36.607
> 
> 标签：flash, actionscript, screenshot

是否可以截取[舞台](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Stage.html)的屏幕截图（转储图像）并将其保存到我的网络服务器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-04T08:08:22.017

这应该可以解决问题：

```
var myBitmapData:BitmapData = new BitmapData(stage.stageWidth, stage.stageHeight);
myBitmapData.draw(stage); 
```

（实际上我不确定您是否可以直接在舞台上执行 draw()，您可能需要在 DisplayList 顶部的任何内容上执行此操作）

然后使用类似这样的代码：[http ://henryjones.us/articles/using-the-as3-jpeg-encoder](http://henryjones.us/articles/using-the-as3-jpeg-encoder)

```
var jpgEncoder:JPGEncoder = new JPGEncoder(85);
var jpgStream:ByteArray = jpgEncoder.encode(myBitmapData);

var header:URLRequestHeader = new URLRequestHeader("Content-type", "application/octet-stream");
var jpgURLRequest:URLRequest = new URLRequest("jpg_encoder_download.php?name=sketch.jpg");
jpgURLRequest.requestHeaders.push(header);
jpgURLRequest.method = URLRequestMethod.POST;
jpgURLRequest.data = jpgStream;
navigateToURL(jpgURLRequest, "_blank"); 
```

将其发送到服务器。

# c - 在 C 中不使用函数原型有什么好处吗？

> ID：946765
> 
> 赞同：2
> 
> 时间：2009-06-03T19:43:36.553
> 
> 标签：c

我正在使用一些不包含特定类函数的函数原型的 C 代码。不使用函数原型有什么好处吗？这些函数从不相互调用，也没有参数。代码变化很大，所以也许它只是少了一行要编辑？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T19:49:45.840

函数原型用于外部函数。我的规则是每个非静态函数都有一个原型，除了 main()。我使用 '-Wmissing-prototypes' GCC 选项。通常它捕获的是当我忘记声明一个静态函数时。

此外，以这种方式在 C 中声明函数：

```
void function(void); 
```

而不是这样：

```
void function(); 
```

因为第二种方式意味着该函数采用未指定数量的参数，这不是您想要的（它是为了与 pre-ANSI C 兼容）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T19:47:41.070

**没有**。

而且我不知道它在严格的 ansi c 中是否合法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:18:12.990

当应用于函数原型时，“代码变化很大”也是一种不好的代码气味。如果接口（函数签名）变化很大，一个函数的职责可能不是很清楚。首先要弄清楚如何将问题划分为子职责，然后才开始编写代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T19:47:05.003

“所以也许它只是少了一行要编辑？”

在这种情况下，这是唯一可能的“好处”，就是懒惰。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T19:47:28.763

更少的代码更改是我能想到的唯一“优势”。通常这只是“懒惰”

无论如何，缺点更明显：你必须在一个源文件中拥有所有功能；源文件中的函数顺序现在很重要，等等。此外，其他人会在查看/查找头文件时感到困惑......最佳实践是 .c 和 .h 它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T19:46:51.680

我看到的唯一好处是您不必每次更改函数本身时都更新函数原型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T19:48:09.650

> 代码变化很大，所以也许它只是少了一行要编辑？

我猜这就是原因。我想不出任何其他原因 - 编译速度（实际上）和执行时间都没有改变，只是更新代码的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T23:22:45.037

我能想到的唯一好处是，它不必将函数的第一行复制并粘贴到 .c 或 .h 文件的原型部分。

对于其他文件中引用的函数，你别无选择，只能有一个原型。

对于具有文件范围的函数（即静态函数），将所有原型放在文件顶部的一个块中是很有用的。这样，任何静态函数都可以被另一个文件中的任何位置调用。如果没有原型，函数 A() 只能在代码中在其上方声明 B() 时调用函数 B()。

此外，如果范围内没有原型，一些编译器会对参数做出不安全的假设。

此外，如果您编写的代码必须符合 MISRA-C，则要求**所有**函数在范围内都有一个原型。

我还主张确保原型包含参数名称，而不仅仅是它们的类型（这是合法的），因为它仅通过查看原型就阐明了参数的用途。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T23:35:31.953

它减少了打字，所以也许这会降低您患 RSI 的风险。

# .net - 将原始 xml 发送到 Web 服务

> ID：946773
> 
> 赞同：0
> 
> 时间：2009-06-03T19:45:52.697
> 
> 标签：.net, xml, web-services

我正在尝试调用我无法控制的 Web 服务。Web 服务需要我拥有 xsd 的 XML。我想将原始 xml 发送到 Web 服务，即防止代理对我发送的任何内容进行 XML 编码。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:48:53.300

为什么代理要编码任何东西？

此服务是否由 WSDL 描述？如果是这样，您是否能够使用“添加服务引用”或 svcutil.exe 创建代理类？代理类是否没有您需要调用的操作的正确签名？

如果不知何故代理类没有正确的签名，那么你不能使用它。您必须自己使用 WebClient 类。根据架构创建 XML，然后通过 WebClient 发送。

# web-services - ASP.NET WebService 覆盖 SOAP 响应

> ID：946775
> 
> 赞同：0
> 
> 时间：2009-06-03T19:46:23.820
> 
> 标签：web-services, soap, asp.net-2.0

在服务完成发送之前，如何覆盖来自 ASP.NET Web 服务的 SOAP 响应对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:49:36.527

您可以实现[SoapExtension](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapextension.aspx)。这是我知道的唯一方法。

# c# - IQueryable.Where() 的 Linq 动态参数

> ID：946792
> 
> 赞同：1
> 
> 时间：2009-06-03T19:48:33.113
> 
> 标签：c#, linq, dry

作为 C# 开发人员，我已进入第 8 天。

对于我正在处理的项目中的许多 DomainModel，我需要能够根据用户在审阅/搜索表单中提交的内容过滤表中的所有记录。

目前2美分的短途旅行是：

表单提交给 FooController/review。

Review 然后将所有键/值对从 Params['filter'] 抓取到一个字典中，并将其传递给一个名为 FooFinder.ByProperties 的助手类，它看起来非常类似于：

```
public IQueryable<WorkPlan> ByProperties( IDictionary<string, string> properties)
    {            

        var result = ForSite(Convert.ToInt64(properties.DefaultVal("SiteId", "0")));

        v);

        if(properties.ContainsKeyAndIsNotNullOrEmpty("WorkPlan.Key"))
        {
            var tempVal = Convert.ToInt64(properties["WorkPlan.Key"]);
            result = result.Where(r => r.Id == tempVal);
        }
        // Multiple of these conditional checks follows
       return result; 
```

}

我想尽可能减少重复代码并尝试类似

```
result = ByProperty(properties, "WorkPlan.key", typeof (Int64), r, v => r.id == v); 
```

但由于很多原因，这显然行不通……我想要完成的目标仍然存在。我真的很想通过使用某种动态帮助程序/实用程序来简化代码并加快过滤过程。

我尝试的其他想法是使用反射和那个工作的孩子进行直接比较，但是如何检查诸如 CreatedDatime 属性之类的东西，我希望所有记录都大于“r => CreatedDatetime > CreatedFrom”。

如果这些都没有意义，请发表评论，我会尽力解决任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T21:16:51.733

你所问的*可以*自动化，但工作量很大，并且需要`Expression`API 知识。这是一个相当高级的话题。

我可能会保持代码“原样”......干燥很好，但“不要破坏工作代码”是另一个值得了解的格言......

或者，您可能想查看[动态 LINQ 库](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)- 这可能会帮助您实现自动化。但老实说，现有的代码并没有那么难看……

# java - IntelliJ IDEA 中的 Ctrl-tab

> ID：946795
> 
> 赞同：10
> 
> 时间：2009-06-03T19:48:54.670
> 
> 标签：java, keyboard-shortcuts, intellij-idea

我可以在 Windows 上配置 IntelliJ 以使用`Ctrl`+`Tab`在文件之间切换吗？

谷歌搜索发现[这个旧线程](http://www.jetbrains.net/devnet/thread/943)说“不”。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T20:19:03.113

你不能弹出一个弹窗，但是你可以用`Alt`+`→`和`Alt`+在打开的标签之间切换`←`，你可以按`Ctrl`+`E`来获取最近打开的文件的列表，这几乎是一样的。

编辑：（回应评论）哦，如果是这样，那只是改变KeyMap的问题。你去`File -> Settings`那里你有一个键盘映射选项。您必须通过单击复制来创建一个新的 KeyMap（不能更改默认值），然后在另一部分中查找“在多编辑器文件中选择下一个选项卡”并更改/添加所需的键盘映射。`Ctrl`+`Tab`是合法的 - 它只是默认为在拆分之间切换。

编辑2：（回应第二条评论）您在IDEA中寻找的功能（至少尽可能接近）是Go Back，它也在键映射的另一组中。话虽如此，您说您正在寻找它在 firefox 中的工作方式（不了解 Visual Studio），而“选择下一个选项卡”是 firefox 行为。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-04T05:50:48.470

您是否尝试过下载和安装 TabSwitch 插件？`Alt`当您点击+时，它将允许您循环浏览打开的编辑器并在弹出窗口中显示它们`A`。此默认键盘映射很容易在键盘映射 IDE 设置中更改为`Ctrl`+ 。`Tab`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T02:19:56.693

TabSwitch 无疑是这个问题的答案。如果不这样做，您可以使用`Ctrl`+`E`弹出最近文件列表并在那里导航。所以跳转到最近的文件将是`Ctrl`++ `E`。`Enter`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-01-31T06:01:18.177

如果您正在寻找通常通过使用网络浏览器单击 ctrl + tab 获得的功能，则更改“选择下一个点击”可以实现这一目标。

[窗口 -> 编辑器选项卡 -> 选择下一个点击](https://i.stack.imgur.com/etBRD.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-06T12:59:00.663

您不能使用键盘输入“Ctrl+Tab”，但可以从下拉菜单中选择它：

[![Ctrl+Tab](https://i.stack.imgur.com/52Ppu.png)](https://i.stack.imgur.com/52Ppu.png)

# logging - 如何使用 NLog/Log4Net 自动跟踪数据库更改？

> ID：946796
> 
> 赞同：0
> 
> 时间：2009-06-03T19:49:07.400
> 
> 标签：logging, log4net, nlog, audit-trail

我知道许多表审计方法。有些是基于触发器的，需要审计每个表上的触发器。有些有基于列数据类型的限制。如何使用 NLog 或 Log4Net 等日志框架。我希望我的日志（在表格中）回答问题“此时谁将此表格的这一列从 val0 更新为 val1？”

我还没有决定使用 OR 映射器。倾向于 NHibernate 或 EF。

提前致谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:30:57.887

如果您使用像[DAO](http://en.wikipedia.org/wiki/Data_Access_Object)这样的模式（我在 Java 和 Hibernate 中成功使用它），您可以为数据库中的每个更改添加一个条目。如果您使用[Spring.NET](http://www.springframework.net/)，您可以使用[AOP](http://www.springframework.net/doc/reference/html/aop-quickstart.html)将拦截器添加到访问数据库的 DAO 的方法中。

无论如何，您可能想要为 DAOs 包添加一个特殊的附加程序，因为它会非常冗长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:43:31.637

Victors 的回答是一流的，但我想补充一点，这可能很难，具体取决于您的列-> 对象映射的工作方式。

如果您将表列映射到具有不同名称的对象属性和字段，那么我认为您将尝试解析 sql 信息以确定更新了哪一列。例如，如果您更改了“Product.Price”的值并且实际上映射到名为“final_price”的列，那么您的日志记录将与数据库中发生的情况不完全匹配。

这也可能是错误的，但如果您通过 ORM 包处理断开连接的实体，我不确定是否可以使用更改跟踪信息。我隐约记得我读到的一个问题，即您列出的一个 ORM 正在更新每一列，因此当用户真正更新单个列时，似乎用户更改了表中的所有列。

# postgresql - 查明用户是否有权在 PostgreSQL 中选择/更新/...一个表/函数/...

> ID：946804
> 
> 赞同：11
> 
> 时间：2009-06-03T19:49:48.930
> 
> 标签：postgresql, metadata, privileges, information-schema

确定用户是否在 PostgreSQL 中的某个类（例如表或函数）上获得某种权限（例如选择或执行）的推荐方法是什么？

此刻我得到了类似的东西

```
aclcontains(
    someColumnWithAclitemArray,
    makeaclitem(userOid,grantorOid,someRight,false)) 
```

但这很糟糕，因为我必须检查所有`grantorOid`可能的情况以及`userOid`用户可以属于的每一个。

在相关说明中：您可以测试哪些可能的权利？我没有找到任何文档，但我猜想阅读源代码：

```
INSERT
SELECT
UPDATE
DELETE
TRUNCATE
REFERENCES
TRIGGER
EXECUTE
USAGE
CREATE
CONNECT 
```

似乎也有一个`CREATE TEMP`权利，但我无法弄清楚在`makeaclitem`-function 中使用的正确文本。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-03T20:59:57.743

我发现一个更好的方法（我似乎记得这是从 psql 内置的一些查询中获取的，或者可能是 information_schema 视图）是使用这些`has_*_privilege`函数，并将它们简单地应用于一组所有可能的用户组合和目的。这也将考虑通过某些组角色访问对象。

例如，这将显示哪些用户对非目录表和视图具有哪些访问权限：

```
select usename, nspname || '.' || relname as relation,
       case relkind when 'r' then 'TABLE' when 'v' then 'VIEW' end as relation_type,
       priv
from pg_class join pg_namespace on pg_namespace.oid = pg_class.relnamespace,
     pg_user,
     (values('SELECT', 1),('INSERT', 2),('UPDATE', 3),('DELETE', 4)) privs(priv, privorder)
where relkind in ('r', 'v')
      and has_table_privilege(pg_user.usesysid, pg_class.oid, priv)
      and not (nspname ~ '^pg_' or nspname = 'information_schema')
order by 2, 1, 3, privorder; 
```

可能的权限在[http://www.postgresql.org/docs/current/static/functions-info.html#FUNCTIONS-INFO-ACCESS-TABLE](http://www.postgresql.org/docs/current/static/functions-info.html#FUNCTIONS-INFO-ACCESS-TABLE)`has_*_privilege`的函数描述中有详细说明。

“CREATE TEMP”是数据库级权限：它允许用户使用`pg_temp_*`模式。可以用`has_database_privilege(useroid, datoid, 'TEMP')`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T21:00:14.527

查看[“访问权限查询功能”](http://www.postgresql.org/docs/current/static/functions-info.html#FUNCTIONS-INFO-ACCESS-TABLE)以及[“GRANT”](http://www.postgresql.org/docs/current/static/sql-grant.html)参考页面。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-09-13T20:45:29.733

因为 Redshift`values()` [仅](https://stackoverflow.com/questions/28233519/how-to-select-multiple-rows-filled-with-constants-in-amazon-redshift)在`INSERT INTO`查询中支持，所以下面的查询可以与明显不那么好的一起使用`union all select`。

```
select usename, nspname || '.' || relname as relation,
       case relkind when 'r' then 'table' when 'v' then 'view' end as relation_type,
       priv
from pg_class join pg_namespace on pg_namespace.oid = pg_class.relnamespace,
     pg_user,
     (select 'select' as priv,1 as privorder union all select 'insert',2 union all select 'update',3 union all select 'delete',4)
where relkind in ('r', 'v')
      and has_table_privilege(pg_user.usesysid, pg_class.oid, priv)
      and not (nspname ~ '^pg_' or nspname = 'information_schema')
order by 2, 1, 3, privorder; 
```

编辑：另外，我意识到，在我们的数据库 Dataiku 中创建的表中可以包含大写字母，因此，如果`table not exist`发生错误，您应该使用该`lower()`函数

# string - C++/CLI 从 System::String^ 转换为 std::string

> ID：946813
> 
> 赞同：98
> 
> 时间：2009-06-03T19:51:10.453
> 
> 标签：string, c++-cli, managed-c++

有人可以发布一个可以转换的简单代码，

```
System::String^ 
```

到，

C++`std::string`

即，我只想分配的值，

```
String^ originalString; 
```

到，

```
std::string newString; 
```

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-09-10T13:17:25.433

不要自己动手，使用Microsoft 提供的[这些](http://msdn.microsoft.com/en-us/library/bb384865.aspx)方便（且可扩展）的包装器。

例如：

```
#include <msclr\marshal_cppstd.h>

System::String^ managed = "test";
std::string unmanaged = msclr::interop::marshal_as<std::string>(managed); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-01-17T14:49:15.340

您可以按如下方式轻松执行此操作

```
#include <msclr/marshal_cppstd.h>

System::String^ xyz="Hi boys"; 

std::string converted_xyz=msclr::interop::marshal_as< std::string >( xyz); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-06-03T19:57:43.420

看看`System::Runtime::InteropServices::Marshal::StringToCoTaskMemUni()`和它的朋友。

*抱歉现在无法发布代码；我在这台机器上没有 VS 在发布前检查它是否编译。*

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-12-12T13:54:50.920

这对我有用：

```
#include <stdlib.h>
#include <string.h>
#include <msclr\marshal_cppstd.h>
//..
using namespace msclr::interop;
//..
System::String^ clrString = (TextoDeBoton);
std::string stdString = marshal_as<std::string>(clrString); //String^ to std
//System::String^ myString = marshal_as<System::String^>(MyBasicStirng); //std to String^
prueba.CopyInfo(stdString); //MyMethod
//..
//Where: String^ = TextoDeBoton;
//and stdString is a "normal" string; 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-03T23:51:06.383

这是我多年前为一个 c++/cli 项目编写的一些转换例程，它们*应该*仍然可以工作。

```
void StringToStlWString ( System::String const^ s, std::wstring& os)
    {
        String^ string = const_cast<String^>(s);
        const wchar_t* chars = reinterpret_cast<const wchar_t*>((Marshal::StringToHGlobalUni(string)).ToPointer());
        os = chars;
        Marshal::FreeHGlobal(IntPtr((void*)chars));

    }
    System::String^ StlWStringToString (std::wstring const& os) {
        String^ str = gcnew String(os.c_str());
        //String^ str = gcnew String("");
        return str;
    }

    System::String^ WPtrToString(wchar_t const* pData, int length) {
        if (length == 0) {
            //use null termination
            length = wcslen(pData);
            if (length == 0) {
                System::String^ ret = "";
                return ret;
            }
        }

        System::IntPtr bfr = System::IntPtr(const_cast<wchar_t*>(pData));
        System::String^ ret = System::Runtime::InteropServices::Marshal::PtrToStringUni(bfr, length);
        return ret;
    }

    void Utf8ToStlWString(char const* pUtfString, std::wstring& stlString) {
        //wchar_t* pString;
        MAKE_WIDEPTR_FROMUTF8(pString, pUtfString);
        stlString = pString;
    }

    void Utf8ToStlWStringN(char const* pUtfString, std::wstring& stlString, ULONG length) {
        //wchar_t* pString;
        MAKE_WIDEPTR_FROMUTF8N(pString, pUtfString, length);
        stlString = pString;
    } 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-10-27T18:18:19.417

我花了几个小时试图将 Windows 表单列表框的 ToString 值转换为标准字符串，以便我可以将它与 fstream 一起使用以输出到 txt 文件。我的 Visual Studio 没有附带我发现的几个答案说要使用的编组头文件。经过这么多的试验和错误，我终于找到了解决问题的方法，只使用 System::Runtime::InteropServices：

```
void MarshalString ( String ^ s, string& os ) {
   using namespace Runtime::InteropServices;
   const char* chars = 
      (const char*)(Marshal::StringToHGlobalAnsi(s)).ToPointer();
   os = chars;
   Marshal::FreeHGlobal(IntPtr((void*)chars));
}

//this is the code to use the function:
scheduleBox->SetSelected(0,true);
string a = "test";
String ^ c = gcnew String(scheduleBox->SelectedItem->ToString());
MarshalString(c, a);
filestream << a; 
```

这是带有示例的 MSDN 页面：http: [//msdn.microsoft.com/en-us/library/1b4az623 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/1b4az623(v=vs.80).aspx)

我知道这是一个非常简单的解决方案，但这花了我几个小时的故障排除并访问了几个论坛，最终找到了可行的方法。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-02-04T22:57:36.543

我发现从 String^ 获取 std::string 的简单方法是使用 sprintf()。

```
char cStr[50] = { 0 };
String^ clrString = "Hello";
if (clrString->Length < sizeof(cStr))
  sprintf(cStr, "%s", clrString);
std::string stlString(cStr); 
```

无需调用 Marshal 函数！

**更新**感谢 Eric，我修改了示例代码以检查输入字符串的大小，以防止缓冲区溢出。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-01-04T08:45:54.903

C# 对其字符串使用 UTF16 格式。
因此，除了转换类型之外，您还应该注意字符串的实际格式。

编译**多字节字符集**时，Visual Studio 和 Win API 假定为 UTF8（实际上是 Windows 编码，即[Windows-28591](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)）。**为Unicode 字符集**
编译时，Visual Studio 和 Win API 假定为 UTF16。

 **因此，您还必须将字符串从 UTF16 转换为 UTF8 格式，而不仅仅是转换为 std::string。
当使用多字符格式（如某些非拉丁语言）时，这将变得很有必要。

这个想法是决定`std::wstring` **始终**代表**UTF16**。
并且`std::string` **始终**代表**UTF8**。

这不是由编译器强制执行的，它更像是一个好的策略。

```
#include "stdafx.h"
#include <string>
#include <codecvt>
#include <msclr\marshal_cppstd.h>

using namespace System;

int main(array<System::String ^> ^args)
{
    System::String^ managedString = "test";

    msclr::interop::marshal_context context;

    //Actual format is UTF16, so represent as wstring
    std::wstring utf16NativeString = context.marshal_as<std::wstring>(managedString); 

    //C++11 format converter
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t>> convert;

    //convert to UTF8 and std::string
    std::string utf8NativeString = convert.to_bytes(utf16NativeString);

    return 0;
} 
```

或者使用更紧凑的语法：

```
int main(array<System::String ^> ^args)
{
    System::String^ managedString = "test";

    msclr::interop::marshal_context context;
    std::wstring_convert<std::codecvt_utf8_utf16<wchar_t>> convert;

    std::string utf8NativeString = convert.to_bytes(context.marshal_as<std::wstring>(managedString));

    return 0;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-08T16:07:28.813

我喜欢远离编组器。

```
Using CString newString(originalString); 
```

对我来说似乎更干净，更快。无需担心创建和删除上下文。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-08T02:06:18.147

// 我用VS2012写了下面的代码-- convert_system_string to Standard_Sting

```
 #include "stdafx.h"
        #include <iostream>
        #include <string> 

        using namespace System;
        using namespace Runtime::InteropServices; 

        void MarshalString ( String^ s, std::string& outputstring )
        {  
           const char* kPtoC =  (const char*) (Marshal::StringToHGlobalAnsi(s)).ToPointer();                                                        
           outputstring = kPtoC;  
           Marshal::FreeHGlobal(IntPtr((void*)kPtoC));  
        }   

        int _tmain(int argc, _TCHAR* argv[])
        {
             std::string strNativeString;  
             String ^ strManagedString = "Temp";

             MarshalString(strManagedString, strNativeString);  
             std::cout << strNativeString << std::endl; 

             return 0;
        } 
```

# .net - 更改 ControlToValidate 可见性时，RequiredFieldValidator 未触发

> ID：946814
> 
> 赞同：0
> 
> 时间：2009-06-03T19:51:24.387
> 
> 标签：.net, asp.net, validation, requiredfieldvalidator

当我更改 ddl.Visible=true（它在另一个表单元素事件的部分回发/更新面板上更改）时，RequiredFieldValidator 不会触发？

注意：这不是关于在正常情况下如何使用RequiredFieldValidator 的问题。我的表单有级联下拉菜单，它们都是动态构建的，它们的可见性打开和关闭。

```
<asp:DropDownList ID="ddl" Visible="false" AutoPostBack="True" runat="server">                                                               
</asp:DropDownList>
<asp:RequiredFieldValidator ControlToValidate="ddl" 
ID="RequiredFieldValidator1" 
runat="server" ErrorMessage="Required"></asp:RequiredFieldValidator> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:53:16.380

您需要设置您的[`InitialValue`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator.initialvalue.aspx)属性，`RequiredFieldValidator`以便它知道 的值何时`DropDownList`更改。例如，在具有这些值的下拉列表中：

> *   `Please Select`
> *   `Dog`
> *   `Cat`
> *   `Bird`

您将添加此属性

```
InitialValue="Please Select" 
```

到你的`RequiredFieldValidator`.

在不知道值是否已更改的情况下，验证者不可能知道用户是否满足其要求。

# f# - F#：可以为空 支持

> ID：946815
> 
> 赞同：24
> 
> 时间：2009-06-03T19:51:36.537
> 
> 标签：f#, null

在 F# 中使用 Nullable 的正确方法是什么？

目前我正在使用它，但它看起来非常混乱。

```
let test (left : Nullable<int>) = if left.HasValue then left.Value else 0

Console.WriteLine(test (new System.Nullable<int>()))
Console.WriteLine(test (new Nullable<int>(100)))

let x = 100
Console.WriteLine(test (new Nullable<int>(x))) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-03T19:57:00.957

恐怕在 F# 中没有可空类型的语法糖（不像在 C# 中您只需将 a 附加`?`到类型）。所以，是的，您在那里显示的代码确实看起来非常冗长，但这是`System.Nullable<T>`在 F# 中使用该类型的唯一方法。

但是，我怀疑您真正想要使用的是[**option types**](http://msdn.microsoft.com/en-us/library/dd233245(VS.100).aspx)。MSDN 页面上有一些不错的示例：

```
let keepIfPositive (a : int) = if a > 0 then Some(a) else None 
```

和

```
open System.IO
let openFile filename =
   try
       let file = File.Open (filename, FileMode.Create)
       Some(file)
   with
       | exc -> eprintf "An exception occurred with message %s" exc.Message; None 
```

显然更好用！

选项基本上履行了 F# 中可空类型的角色，我应该认为您真的想要使用它们而不是可空类型（除非您正在与 C# 进行互操作）。实现上的区别在于选项类型是由 and 的可区分*联合*形成的，而在 BCL 中是一个普通类，在 C# 中有一点语法糖。`Some(x)``None``Nullable<T>`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-08-28T22:49:26.607

您可以让 F# 推断其中的大多数类型：

```
let test (left : _ Nullable) = if left.HasValue then left.Value else 0

Console.WriteLine(test (Nullable()))
Console.WriteLine(test (Nullable(100)))

let x = 100
Console.WriteLine(test (Nullable(x))) 
```

您还可以使用[活动模式](http://msdn.microsoft.com/en-us/library/dd233248.aspx)将模式匹配应用于可空类型：

```
let (|Null|Value|) (x: _ Nullable) =
    if x.HasValue then Value x.Value else Null

let test = // this does exactly the same as the 'test' function above
    function
    | Value v -> v
    | _ -> 0 
```

我前段时间写了一篇关于[F# 中可空类型的](http://bugsquash.blogspot.com/2010/09/nullable-in-f.html)博客[/shameless_plug]

# asp.net - ASP.NET 本地化问题

> ID：946825
> 
> 赞同：2
> 
> 时间：2009-06-03T19:54:30.947
> 
> 标签：asp.net, localization, globalization, multilingual, resx

我已成功将本地化添加到我的网站。第二天来了，还是不行。在阅读了很多帖子并做了一些我自己的故障排除之后。我发现页面忽略了 page.aspx.en-US.resx。因为我没有页面的标准 resx，所以它显示了我在设计器中的标签标题。我刚刚取出 en-US 并将其设为默认值（page.aspx.resx）。该页面正确显示资源文件中的字符串。我使用了 MSDN 上的教程和您可以在整个互联网上找到的相同教程，我什至为 MSDN 上的教程做出了贡献。当您使用身份验证或模拟时，您必须通过 web.config 授予对 APP_LocalResources 文件夹的访问权限

```
<location path="App_LocalResources">
<system.web>
 <authorization>
  <allow users="*">
 </authorization>
</system.web> 
```

我昨天发现并解决了问题，但现在它不使用 page.aspx.en-US.resx ，除非它是默认的我觉得很奇怪。有人有解决方案或建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T21:26:29.000

我找到了解决我的挑战的方法。为了使资源文件正常工作，您必须将默认资源文件与其他资源文件结合使用，例如：

```
default.aspx.resx
default.aspx.en-US.resx
default.aspx.nl-NL.resx 
```

即使您只有一种语言并且想要使用资源文件，您也必须拥有默认资源文件才能使其工作，否则它将忽略您在 App_LocalResources 下可能拥有的任何资源文件。

# scripting - 如何从脚本中检测使用 Perforce 的“重新打开以进行编辑”

> ID：946826
> 
> 赞同：0
> 
> 时间：2009-06-03T19:54:36.813
> 
> 标签：scripting, perforce

我正在编写一个与 Perforce 交互的脚本，其中需要能够理解待处理的更改列表。为此，我使用' `p4 describe`' 和 ' `p4 opened`'，它们非常简单。例如，打开以进行编辑的文件显示如下（从 p4 打开）：

```
//source/stuff/things.h#1 add default change (text) 
```

我似乎*无法*弄清楚的是如何检测用户分支文件然后对该文件使用“重新打开以进行编辑”命令的情况（相当于使用“`p4 edit`' 在要分支的文件上）在提交之前。集成文件然后在提交集成之前使用“重新打开以进行编辑”也是如此。在分支情况下，文件显示为“添加”，但没有指示还有一个分支正在进行（因此上面的示例可能是真正的添加或重新打开的分支）。在集成情况下，它显示为“编辑”。在这两种情况下，在我提交更改后，我可以看到文件已分支/集成，但我需要能够为待处理的更改执行此操作。从理论上讲，我希望看到这样的东西，其中 things.h 是从 thangs.h 分支和编辑的：

```
//source/stuff/things.h#1 add default change (text)
  branch from //source/other/thangs.h#42 
```

有人知道实现这一目标的方法吗？我还要提到我正在运行一个旧版本的 Perforce（从 2004 年开始），所以也许它在新版本中是可行的，我只需要更新我的软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-23T19:05:21.667

“ [p4 resolved](http://www.perforce.com/perforce/doc.072/manuals/cmdref/resolved.html) ” 几乎完全符合您的要求，但不幸的是它在 2007.2 中是新的。

```
[C:\dfp\Common\Code\Python]p4 opened foo.py
//buddha/Common/Code/Python/foo.py#1 - add default change (kxtext)

[C:\dfp\Common\Code\Python]p4 resolved foo.py
c:\dfp\Common\Code\Python\foo.py - branch from //buddha/Common/Code/Python/memdump.py#1,#30 
```

在用户运行“解决”之前，您可能无法检测到问题，但他们必须在提交之前解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:00:44.000

我认为在发出“重新打开编辑”时这是不可能的。正如您已经指出的那样，重新打开命令会将文件状态更改为不同的状态。我进行了本地测试（我正在运行 2008.2）。自您的版本以来，perforce 报告文件添加/编辑状态的方式似乎确实发生了一些变化，但是您尝试做的事情似乎仍然不可能

```
d:\sandbox\ctg_test>p4 integ test.txt test_branch.txt
//ctg_test/test_branch.txt#1 - branch/sync from //ctg_test/Test.txt#1,#15

d:\sandbox\ctg_test>p4 opened
//ctg_test/test_branch.txt#1 - branch default change (text) 
```

请注意，打开的命令现在显示文件状态的“分支”，而不是添加，我认为它可能已与您的服务器版本一起显示。但踢球者：

```
d:\sandbox\ctg_test>p4 edit test_branch.txt
//ctg_test/test_branch.txt#1 - reopened for add

d:\sandbox\ctg_test>p4 opened
//ctg_test/test_branch.txt#1 - add default change (text) 
```

我尝试使用 -ztag 选项查看是否提供了更多信息：

```
d:\sandbox\ctg_test>p4 -ztag opened
... depotFile //ctg_test/test_branch.txt
... clientFile //client-mark.allender/ctg_test/test_branch.txt
... rev 1
... action add
... change default
... type text
... user mark.allender
... client client-mark.allender 
```

p4 fstat 也无济于事。

# php - 联系信息网络标准

> ID：946831
> 
> 赞同：0
> 
> 时间：2009-06-03T19:56:04.297
> 
> 标签：php, outlook, ldap, contacts, thunderbird

是我可以用于我们的联系人的标准吗？我想构建一个托管我们客户联系信息的应用程序。是否有我应该使用的标准，以便可以与尽可能多的客户端同步？

在 Outlook 中，我可以找到有关“LDAP”的内容，您可以提供任何教程吗？

我希望支持 2 路同步，以便我可以在 Outlook 中编辑某些内容并将其上传到我们的服务器。就像 CalDAV 的日历一样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:59:09.503

[hCard](http://microformats.org/wiki/hcard)（或更旧的vCard [）](http://microformats.org/wiki/rfc-2426)格式听起来像您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:59:32.293

查看[微格式](http://microformats.org/)。我不确定它们是否在您想要的地方得到支持，但它们是一个有趣的引导标记。他们有一种名为[hCard](http://microformats.org/wiki/hcard)的联系信息格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-21T09:40:37.083

CardDAV 是新兴的标准。它类似于 CalDAV，但将联系人资源存储在 vCard 文件中，并使用 WebDAV 的扩展使其可访问。到目前为止，只有 Apple 在服务器上使用 Mac OS X Server 10.6 的 Address Book Server 以及在客户端上使用 Mac OS X 10.6 上的 Address Book 实现了它。仍然缺乏对 iPhone 的支持（从固件 3.1 开始），Apple 实施通讯簿服务器仍然存在一些限制，即没有组织范围的联系人（如公共文件夹），并且不能对帐户设置委派/权限。也没有用于查看/编辑它们的 Web 界面，因此除非您的客户都在 10.6 上，否则它们将被冷落。

另一种方法是使用 Exchange 2007 和 EWS（Exchange Web 服务）来存储和访问集中式联系人，这将同步回客户端。

# design-patterns - 是否有处理回调机制的设计模式？

> ID：946834
> 
> 赞同：33
> 
> 时间：2009-06-03T19:56:19.413
> 
> 标签：design-patterns, oop, callback

是否有处理回调机制的设计模式？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T19:59:44.883

那将是[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)- 来自维基百科

> 观察者模式（异步发布/订阅模式的一个子集）是一种软件设计模式，其中一个称为主体的对象维护其依赖项（称为观察者）的列表，并自动通知它们任何状态更改，通常通过调用他们的方法之一。它主要用于实现分布式事件处理系统。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T21:47:10.907

这取决于如何使用回调。

设计模式都是关于传达你的意图。

如果您打算允许注册一个或多个回调并且它们可以在“将来的某个时候”被称为通知，那么您正在谈论 Observer。此外——在这种情况下，回调的实际调用通常是“可选的”或基于某些刺激触发的。（回调可能会或可能不会被调用）

如果您打算传入“要做的事情”，并且在方法中完成（或用于在以后的过程中“做某事”），那么您就是在谈论策略。另外——实际的调用通常会发生。

请注意，完全相同的代码也可能是——它实际上是关于您如何思考问题以及您希望其他人如何思考它。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-03T20:01:03.087

**回调**是一种表单**策略设计模式**

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-03T20:04:17.307

一些。查看[http://people.bu.edu/azs/teaching/cs108/2006fall/callback_pattern.pdf](http://people.bu.edu/azs/teaching/cs108/2006fall/callback_pattern.pdf)和以下内容：

*   访问者模式：[http ://en.wikipedia.org/wiki/Visitor_pattern](http://en.wikipedia.org/wiki/Visitor_pattern)

*   观察者模式：[http ://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)

*   策略模式：[http ://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

最合适的将取决于情况。你想使用什么编程语言，你到底想做什么？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-03T20:08:03.430

[**外部多态性**](http://www.cs.wustl.edu/~schmidt/PDF/External-Polymorphism.pdf)- 一个对象具有对另一个对象的引用和一个调用该对象的函数。它可以被视为单一类型，因此您可以混合和匹配对象和函数来调用事件。代表就是这种模式的一个例子。这更像是一种 C# 风格的方法。

**[观察者模式](http://www.dofactory.com/Patterns/PatternObserver.aspx)**- 您使用对象可以实现的接口/基类并将此接口注册到事件。更多的是 Java 风格的方法。

检查我在此处发布的关于委托/外部多态性的 C++ 解决方案的答案： [来自绑定方法的原始函数指针](https://stackoverflow.com/questions/516411/raw-function-pointer-from-a-bound-method/516537#516537)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-22T21:03:49.607

一个很好的模式描述是[服务回调设计模式](http://soapatterns.org/design_patterns/service_callback)。它是 SOA 模式目录的一部分，但所描述的模式可以用于非 SOA 服务的通用组件。

另一个相关的模式是Hohpe 和 Woolf 的经典著作《企业集成模式》中描述的[返回地址模式。](http://www.enterpriseintegrationpatterns.com/patterns/messaging/ReturnAddress.html)

Josuttis 在他的“SOA in Practice”一书中也谈到了回调。他称之为[请求/回调消息交换模式](http://www.soa-in-practice.com/soa-glossary.html#request/callback)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-09T22:19:07.437

您的问题非常笼统，我能想到的最笼统的答案是当您遇到需要回调的问题时使用多态性。

多态性允许您以接口（或抽象类）的形式指定关于如何使用回调的软件契约。然后客户可以自由选择他们认为适合他们目的的接口的任何实现。

是否建议使用状态、策略、观察者模式或完全不同的东西真的取决于具体情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T20:05:09.320

观察者模式浮现在脑海中。

一个对象（订阅者）可以订阅另一个对象（发布者）。当发布者更改或更新时，他可以通知他的所有订阅者。

根据您使用的语言，您可以指定应在通知时调用的函数。

*[http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)*

它在[设计模式中有很好的描述：可重用的面向对象软件的元素 [四人组]](https://rads.stackoverflow.com/amzn/click/com/0201633612)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-12T21:38:23.950

我也同意其他关于观察者模式的海报。它专为此目的而设计。

# c# - 如何将 VScrollBar 和 HScrollBar 与 RichTextBox 一起使用？

> ID：946840
> 
> 赞同：0
> 
> 时间：2009-06-03T19:57:41.720
> 
> 标签：c#, winforms, user-interface, scrollbar, richtextbox

在我的表格中，我有一个`RichTextBox`. 我也有一个`VScrollBar`和`HScrollBar`。我将`RichTextBox`属性设置`ScrollBars`为，`None`以便我可以使用新的滚动条。那就是我遇到问题的地方，我该怎么做？我在网上搜索并没有找到“c#richtextbox vscrollbar”

请在您的答案中添加对文章的引用，以便我了解它是如何工作的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-09T20:00:30.540

我不知道是否有办法做你想做的事。我能做的最好的事情是尝试在文本中找到正确的位置，然后是 Select() 和 ScrollToCaret()。不过，我通常只使用该技巧来强制 TextBox/RichTextBox 滚动到最后。将它用于您想要的东西并不容易。

您是否有不想使用默认滚动条的原因？

根据我的经验，每当我尝试在 C# 中使用自定义滚动条时，我都很少有运气——尤其是使用能够自动滚动构建它的控件时。

我唯一一次没有太多麻烦地使用它们是使用没有自动滚动功能的第三方控件。

# javascript - Javascript getElementById()

> ID：946842
> 
> 赞同：1
> 
> 时间：2009-06-03T19:57:44.513
> 
> 标签：javascript, internet-explorer, getelementbyid

我正在尝试创建一个可以更改事件属性的通用 javascript 函数。

它的工作方式是

```
function fooFunction(sourceElement) 
{    
  var newName = sourceElement+'Span';    
  var newElement = document.getElementById(newName);
  //Important line
  newElement.property = "enter properties here";
} 
```

我会用类似的东西来称呼它

```
<img src="foo.gif" id="foo" name="foo" onmouseover="fooFunction(this.id);"/>
<span id="fooSpan" name="fooSpan">some text here</span> 
```

所以理论上，当悬停图像时，它应该改变我需要在 fooSpan 对象上改变的任何属性。它在 Opera 中工作，但在 IE 上它返回一个空对象。

有任何想法吗 ？

我的想法是我将拥有多个图像，这些图像会自动触发相关文本跨度（通常是 css 样式）上的属性更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:55:04.850

您确定您在 IE 中正确获取 ID 吗？也许传入的 ID 在 IE 中为空（也许 this.id 不起作用？）。

尝试这样称呼它：

```
<img src="foo.gif" id="foo" name="foo" onmouseover="fooFunction('foo');"/> 
```

看看是否有帮助。我看不出 getElementById() 失败的任何原因，所以我唯一能想到的是这是一个 ID 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T04:12:03.480

可能这条线在 IE 中不起作用。“newElement.property”我不知道确切的原因。

您可以使用它而不是那条线

newElement.setAttribute(property,"在此处输入属性");

同时，我正在尝试找出错误背后的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T04:25:56.493

我的建议是做这样的事情。

```
function fooFunction(sourceElement,property,propertyValue) {    
  var newElement = document.getElementById(sourceElement);
  newElement.setAttribute(property,propertyValue);
}; 
```

你的 HTML 看起来像：

```
<img src="foo.gif" id="foo" name="foo" 
           onmouseover="fooFunction('fooSpan','class','mouseover_span');"/>
<span id="fooSpan" name="fooSpan">some text here</span> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-17T18:11:49.907

我强烈建议您考虑使用 jQuery 的内置 attr() 方法，该方法完美地集成了您想要跨浏览器的功能并且非常易于使用。

使用您的示例，如果您想更改“foo”的“src”属性，您可以在一行代码中完成：

```
$("#foo").attr("src","images/whatever.png"); 
```

同样，如果您想在“fooSpan”内更改 html，您所要做的就是：

```
$("#fooSpan").html("something else"); 
```

您甚至可以将这些事件与比 onmouseover 属性提供更多灵活性的事件联系起来：

```
$(document).ready(function(){
$("#foo").mouseover(function(){
    $("#fooSpan").html("something else");
    $("#foo").attr("src","images/whatever.png");
    });
}); 
```

# .net - Winform - 这是用户控件最后触发的事件

> ID：946843
> 
> 赞同：7
> 
> 时间：2009-06-03T19:58:06.883
> 
> 标签：.net, winforms, events, user-controls

加载应用程序/控件时触发的最后一个用户控件事件是什么？加载事件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T20:09:45.767

这真的取决于你在谈论它的生命周期。鉴于您对 Load 的猜测，我们在创建/加载期间进行讨论。此列表显示了一些事件，它们在我设置用于测试的简单 UserControl 中触发的顺序（连接了许多事件侦听器并将事件名称打印到控制台）：

```
HandleCreated
Load
Layout
VisibleChanged
Paint 
```

请注意，Layout、VisibleChanged 和 Paint 与控件创建没有严格的关系；在控件的生命周期中，可能会或将在多个场合引发布局，尤其是 Paint。VisibleChanged 也是如此，只要 Visible 属性的值发生更改，就会引发它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:04:54.903

Winforms 控件没有与 asp.net webforms 控件相同的生命周期。UI 事件发生在用户执行某些操作以使其发生时。

# c++ - 如果有的话，与 C++ 相比，在 C 中学习编程基础知识会更好吗？

> ID：946855
> 
> 赞同：5
> 
> 时间：2009-06-03T20:00:28.970
> 
> 标签：c++, c

作为一个想提高基础编程技能的人，我选择学习C++而不是C。这不禁让我问：我在C中留下的一些基础技能可能不是通过学习C++获得的吗？

**相关问题：** [我应该在学习 C++ 之前学习 C 吗？](https://stackoverflow.com/questions/598552/should-i-learn-c-before-learning-c)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T20:10:14.910

如果你只用过像 C++ 这样的面向对象的编程语言，那么练习一点 C 是值得的。我发现许多 OO 程序员倾向于像拐杖一样使用对象，一旦你学会了不知道该怎么做他们离开。C 将使您清楚地理解为什么 OO 编程首先出现，并帮助您理解它何时有用，何时它只是过度杀伤。

同样，您将了解不依赖库为您做事的感觉。通过注意 C++ 开发人员将哪些功能转变为库，您可以更好地了解在时机成熟时如何抽象自己的代码。感觉就像你需要在每种情况下抽象所有东西是很糟糕的。

也就是说，您不必学习 C。如果您了解 C++，您可以拖着自己完成大多数项目。但是，通过查看低级语言，您将改进您的编程风格，即使是在高级语言中也是如此。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T20:05:04.997

我不认为你可以在 C 中学习任何技能，但不是 C++，但我肯定还是建议先学习 C。*没有人*能把 C++ 放在他们的脑海里。它可能是有史以来最复杂的非深奥语言。另一方面，C 非常简单。将 C 放入您的脑海中相对容易。C 肯定会比 C++ 更快地帮助您习惯指针和手动内存管理等内容。C++ 将帮助您理解 OO。

另外，当我说学习 C 时，可以使用 C++ 编译器，如果需要，也可以使用 iostreams 之类的东西，首先尝试将自己限制为主要使用 C 功能。如果你全力以赴，学习所有奇怪的 C++ 特性，如模板、RAII、异常、引用等，你会彻底糊涂。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T20:21:00.677

比较以下代码示例（抱歉，我的 C++ 有点生疏）。

C++：

```
int x;

std::cin >> x; 
```

C：

```
int x;

scanf("%d", &x); 
```

那么，你在上面看到了什么？在 C++ 中，一个值被插入到一个变量中。这很酷，但它教会了我们什么？在 C 中，我们注意到一些事情。x 前面有一个有趣的 & ，这意味着它的地址正在被传递。这一定意味着 scanf 函数实际上需要知道内存 x 在哪里。不仅如此，它还需要一个格式字符串，所以它一定不知道你给它的地址是什么以及它获取信息的格式是什么？

如果您愿意付出努力，C 可以让您发现有关计算机和操作系统实际工作的所有这些奇妙的事情。我觉得这很酷。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T20:23:57.860

肯定有一件事：**内存管理**。以下面的代码为例：

```
struct foo {
   int bar;
   char **box;
};

struct foo * fooTab = (struct foo *) malloc( sizeof(foo) * 100 );
for(int i = 0; i<100; i++) {
   fooTab[i].bar = i;
   fooTab[i].box = (char **) malloc( sizeof(char *) * 10 );
   for(int j = 0; j<10; j++) {
      fooTab[i].box[j] = (char *) malloc( sizeof(char) * 10 );
      memset(fooTab[i].box[j], 'x', 10);
   }
} 
```

使用 C++，您根本不会以这种方式处理内存分配。因此，这些技能可能未经训练。这肯定会导致例如较低的调试技能。另一个缺点可能是：优化技能较低。

C++ 代码如下所示：

```
struct foo {
    int bar;
    static int idx;
    vector< vector<char> > box;
    foo() : bar(idx), box(10) {
       idx++;
       for ( auto it = box.begin(); it != box.end(); it++) {
           it->resize(10,'x');
       }
    }
};

int foo::idx = 0;
foo fooTab[100]; 
```

如您所见，根本无法使用 C++ 风格的代码来学习原始内存管理。

编辑：“C++ 风格的代码”是指：RAII 构造函数/析构函数，STL 容器。无论如何，我可能夸大了，最好说：*用 C++ 风格的代码学习原始内存管理要困难得多。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T20:28:31.503

我发现在尝试深入 C++ 之前学习 C 中的内存管理会**更好。**

在 C 中，您只有 malloc() 和 free()。您可以将周围的东西作为指针进行类型转换。这很简单：将 sizeof() 乘以所需的 # 个项目，适当地进行类型转换，然后使用指针算法在整个地方跳转。

在 C++ 中，您有各种 reinterpret_cast<>（与 dynamic_cast 等）类型的东西，这很重要，但只有当您意识到各种强制转换旨在陷阱多重继承和其他如此可爱的陷阱时才有意义C++ 主义。理解（学习）为什么需要将“虚拟”一词放在执行内存管理等对象的析构函数上是一种痛苦。

仅此一个原因就是您应该学习 C 的原因。我还认为（起初）理解 printf() 与可能重载的“<<”运算符等更容易，但对我来说，主要原因是内存管理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T20:05:16.620

我不会说你错过了任何*基本*的东西。不过，请查看[C 和 C++ 的兼容性以](http://en.wikipedia.org/wiki/Compatibility_of_C_and_C%2B%2B)获取一些非基本示例。

> C++ 不支持 C99 的一些添加或与 C++ 功能冲突，例如可变参数宏、复合文字、可变长度数组和本机复数类型。C99 中定义的 long long int 数据类型和限制限定符不包含在当前的 C++ 标准中，但一些编译器（例如 GNU Compiler Collection[3]）将它们作为扩展提供。long long 数据类型以及可变参数模板，可以实现可变参数宏的某些功能，将在下一个 C++ 标准 C++0x 中。另一方面，C99 通过合并 C++ 特性（例如 // 注释以及混合声明和代码）减少了一些其他不兼容性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-03T20:31:35.553

C 语言的简单性[使人的注意力非常集中](http://www.samueljohnson.com/apocryph.html)。

在 C 语言中要学的东西越来越少，学生就有可能更好地学习这些东西。如果一个人从 C++ 开始，那么另一端就有可能对所有事情一无所知。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-03T20:04:23.423

这实际上取决于您学习了 C++ 的哪个子集。例如，您可以在 C++ 中仅使用 iostreams 库；这将使您没有 C stdio 库的经验。我不确定我是否会称 stdio 为一项*基本*技能，但它肯定是人们应该熟悉的经验领域。

或者也许手动处理 C 风格的以 null 结尾的字符串和`str*()`函数集可能被认为是一项基本技能。在危险的 API 函数面前练习避免缓冲区溢出绝对是值得的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-03T20:11:51.973

这只是在黑暗中的一个镜头，但也许你在 C 中比在 C++ 中更多地使用函数指针，并且可能通过开始学习 C 来提高使用函数指针作为一种技能。当然所有这些好东西都在 C++ 中，但是一旦你掌握了课程，可能很容易继续专注于它们而错过其他基本的东西。

例如，您可以使用简单的结构和函数指针在纯 C 中构建自己的继承和多态“系统”。这需要更具创造性的思维，我认为可以更好地理解“盒子里”正在发生的事情。

如果您从 C++ 开始，您可能会错过 C++ 中的这些小细节，但您永远不会看到它们，因为编译器会为您完成这些。

只是一些想法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T20:16:00.327

取决于你如何处理 C++。我通常建议从高层次开始，使用 STL 容器和智能指针，这不会让你了解低层次的细节。如果你想学习这些，你可能应该直接跳入 C。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T20:31:40.373

扮演魔鬼的拥护者，因为我认为 C 是一个很好的起点......

就个人而言，我开始学习 C、算法、数据结构、内存分配、文件操作、图形例程......我将这些称为编程的基本粒子。

接下来我学习了 C++。为了过度简化，C++ 添加了面向对象的编程层——无论使用哪种语言，您都拥有相同的目标，但是为实现这些目标而构建的方法和构造是不同的：类、重载、多态性、封装等。 ..

这对我来说不是任何有根据的决定，这只是我的编程课程的结构，结果证明它是一门很好的课程。

另一个简化... C 基本上是 C++ 的一个子集。通过避免使用 C++ 的语言特性，您可以用 C++“做 C”。从语言特征来看。图书馆是另一回事。如果不开始使用和构建库，我认为你不会超越仅仅编程 101，而且那里有足够的东西让你忙碌一辈子。

如果您的目标是最终学习 C++，那么从“C”开始可能是一个合乎逻辑的开始，该语言“更小”——但“C”中有太多内容，您可能希望缩小关注范围。你正在对付一只更大的野兽，但如果你得到指导，我认为没有令人信服的理由不这样做，尽管我走了这条路。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-03T20:05:40.830

大多数 C 代码只需稍作改动即可编译为 C++ 代码。有关无法更改的极少数事物的示例，请参阅[为什么人为地将您的代码限制为 C？](https://stackoverflow.com/questions/649789/why-artificially-limit-your-code-to-c). 我不认为这些都可以归类为基本的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-03T20:14:23.137

C本质上是C++的一个子集。其他一些答案强调存在差异，但基本上大多数 C 编译为 C++，只需稍作修改。

学习 C 的好处是它是一种更紧凑的语言，因此学习它的速度更快。C 还要求您在相对较低的抽象级别上工作，这有助于理解计算机的实际工作方式。我个人是在汇编中长大的，然后从那里转向 C，我现在认为这是理解编译器如何将高抽象级别的构造映射到实际机器代码的决定性优势。

在 C++ 中，您会发现自己很快就陷入了更高层次的抽象之中。这对生产力有好处，但对理解却不一定如此。

所以我的建议是：如果你有动力学习 C++，但首先要专注于 C 常见的核心低级结构。然后再转向更高层次的东西，如面向对象、模板、广泛的类库等。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T21:05:09.243

**优化理论**

主要是因为 C 编译器的 asm 输出通常更加可预测，并且通常与 C 有很好的相关性。这让您可以通过显示生成的实际指令来教导/了解*为什么*以某种方式更好地构造代码。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-03T21:11:40.807

您应该学习 C 中的数据结构。首先，它将迫使您真正理解指针，这将帮助您处理高级语言中的[抽象泄漏。](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)其次，它将使 OO 的好处显而易见。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T21:22:50.737

**编码方式**

我所说的编码风格不是指 {} 和空格，而是指你如何组织数据、类、文件等。

我开始学习 c++，它通常有利于创建类和以某种方式组织事物。我可以在需要的时候很好地编写 c 代码，但它绝不像其他人以 c 开始编写的 c 风格代码。

我的一个 OS 课程要求我们用 C 编写一个文件系统。我的搭档最初是一名 C 人，我对我们编写的代码的不同感到惊讶。我的显然是在尝试在 c 中使用 c++ 风格的编码。

这有点像当你第一次学习 perl 或 ruby​​ 或其他东西时，你只是想编写相同的 c# 代码，除了翻译成新的语言而不是使用这些语言的特性。

虽然 C 是 C++ 的子集，但 C 程序和 C++ 程序是如此不同，以至于无法真正进行比较。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-03T21:52:10.507

是的，简单的结构化编程。

OOP 无处不在，很容易忘记您可以仅使用模块和函数来构建完善的系统。C的模块系统很弱，但仍然......

在我的书中，这也是函数式编程的优点之一。许多函数式编程语言都有强大的模块系统。当您需要比简单函数提供的更多通用性时，总会有更高阶的函数。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-03T22:53:47.263

如果你想学习新技能并且你有良好的结构化编程（SP）基础，你应该选择 C++。学会以面向对象（OOP）的方式（定义对象、方法、继承等）来思考给定的问题，这有时是最困难的部分。几年前我和你的情况一样，我选择了C++，因为学习一种新的范式，一种新的思维方式和设计软件，有时比代码本身更难，如果你不喜欢C++或者 OOP 你可以回到 C 和 SP，但至少你会有一些 OOP 技能。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-04T02:14:42.897

我会选择 C ​​来学习编程的低级原语。

对于 OOP，在 C++ 之前还有*很多其他语言要学习，这些语言更容易学习。*这不是 1990 年，当时唯一的 OOP 语言是 Smalltalk 和 C++，而且只有 C++ 在学术界之外使用。从那以后，几乎所有发明的新编程语言都有对象，而且几乎都没有 C++ 复杂。

# html - 在 Emacs 中将语法高亮代码转换为 HTML

> ID：946858
> 
> 赞同：9
> 
> 时间：2009-06-03T20:01:10.013
> 
> 标签：html, emacs, syntax-highlighting

在 TextMate 中有一个名为“从文档创建 HTML”的功能，它将显示的代码（包括语法着色）转换为 HTML/CSS，以便于在线发布。我想知道 Emacs 中是否隐藏了这样的功能，或者我可以安装一个扩展来做到这一点。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-03T20:06:51.267

[HTML 化](http://www.emacswiki.org/emacs/Htmlize)。

在这里，我曾经`htmlize-region`对 GNU Emacs 欢迎屏幕的一部分进行 Htmlize：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- 由 htmlize-1.34 在 css 模式下创建。-->
<html>
  <头部>
    <title>*GNU Emacs*</title>
    <style type="text/css">
    <!--
      身体 {
        颜色：#000000；
        背景颜色：#ffffff；
      }
      .ATTRLIST {
      }
      .ATTRLIST-1 {
        /* (:foreground "darkblue") */
        颜色：#00008b；
      }
      .ATTRLIST-2 {
        /* (:slant oblique) */
        字体样式：斜体；
      }
      .ATTRLIST-3 {
        /* (:foreground "red") */
        颜色：#ff0000；
      }
      。默认 {
        /* 默认 */
        颜色：#000000；
        背景颜色：#ffffff；
      }
      。关联 {
        /* 关联 */
        颜色：#0000ff；
        文字装饰：下划线；
      }
      .可变间距{
      }

      一种 {
        颜色：继承；
        背景颜色：继承；
        字体：继承；
        文字装饰：继承；
      }
      一：悬停{
        文字装饰：下划线；
      }
    -->
    </style>
  </head>
  <正文>
    <上一页>
<span class="ATTRLIST-3"><span class="variable-pitch">欢迎使用 </span></span><span class="ATTRLIST"><span class="link">GNU Emacs</ span></span><span class="ATTRLIST-3"><span class="variable-pitch">，</span></span><span class="ATTRLIST"><span 类的一个组件="link">GNU/Linux</span></span><span class="ATTRLIST-3"><span class="variable-pitch"> 操作系统。
</span></span><span class="variable-pitch">要退出部分输入的命令，输入 </span><span class="default">Control-g</span><span class="可变间距">。

</span><span class="variable-pitch"><span class="link">Emacs 教程</span></span><span class="variable-pitch">学习基本的击键命令
</span><span class="variable-pitch"><span class="link">Emacs 导览</span></span><span class="variable-pitch"> Emacs 功能概览
</span><span class="variable-pitch"><span class="link">查看 Emacs 手册</span></span><span class="variable-pitch">使用 Info 查看 Emacs 手册
</span><span class="variable-pitch"><span class="link">无保证</span></span><span class="variable-pitch"> GNU Emacs 自带 </span ><span class="ATTRLIST-2"><span class="variable-pitch">绝对不保证
</span></span><span class="variable-pitch"><span class="link">复制条件</span></span><span class="variable-pitch">再分配条件和改变 Emacs
</span><span class="variable-pitch"><span class="link">订购手册</span></span><span class="variable-pitch">购买印刷版手册</span >
<span class="可变间距">
开始... </span><span class="variable-pitch"><span class="link">打开一个文件</span></span><span class="variable-pitch"> </span span><span class="variable-pitch"><span class="link">打开主目录</span></span><span class="variable-pitch"> </span><span class=" variable-pitch"><span class="link">自定义启动</span></span><span class="variable-pitch">
</span><span class="ATTRLIST-1"><span class="variable-pitch">
这是 GNU Emacs 22.3.1（x86_64-pc-linux-gnu，GTK+ 版本 2.14.7）
 2009 年 3 月 31 日在 nautilus 上，由 Debian 修改</span></span></pre>
  </正文>
</html>

```

# python - 在元组或对象列表上使用 Python 的 list index() 方法？

> ID：946860
> 
> 赞同：65
> 
> 时间：2009-06-03T20:01:51.090
> 
> 标签：python, list, tuples, reverse-lookup

Python 的列表类型有一个 index() 方法，该方法接受一个参数并返回列表中与该参数匹配的第一项的索引。例如：

```
>>> some_list = ["apple", "pear", "banana", "grape"]
>>> some_list.index("pear")
1
>>> some_list.index("grape")
3 
```

有没有一种优雅的（惯用的）方法可以将其扩展到复杂对象的列表，比如元组？理想情况下，我希望能够做这样的事情：

```
>>> tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]
>>> some_list.getIndexOfTuple(1, 7)
1
>>> some_list.getIndexOfTuple(0, "kumquat")
2 
```

getIndexOfTuple() 只是一个假设的方法，它接受一个子索引和一个值，然后返回具有该子索引处给定值的列表项的索引。我希望

是否有某种方法可以使用列表推导或lambas 或类似的“内联”方法来实现该一般结果？我想我可以编写自己的类和方法，但如果 Python 已经有办法做到这一点，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-06-03T20:07:23.743

这个怎么样？

```
>>> tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]
>>> [x for x, y in enumerate(tuple_list) if y[1] == 7]
[1]
>>> [x for x, y in enumerate(tuple_list) if y[0] == 'kumquat']
[2] 
```

正如评论中指出的那样，这将获得所有匹配项。要获得第一个，您可以执行以下操作：

```
>>> [y[0] for y in tuple_list].index('kumquat')
2 
```

评论中对发布的所有解决方案之间的速度差异进行了很好的讨论。我可能有点偏见，但我个人会坚持单线，因为我们谈论的速度与为这个问题创建函数和导入模块相比是微不足道的，但如果你打算这样做到非常大的数量您可能想要查看提供的其他答案的元素，因为它们比我提供的更快。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-06-03T20:54:10.513

一段时间后，这些列表理解变得混乱。

### 我喜欢这种 Pythonic 方法：

```
from operator import itemgetter

def collect(l, index):
   return map(itemgetter(index), l)

# And now you can write this:
collect(tuple_list,0).index("cherry")   # = 1
collect(tuple_list,1).index("3")        # = 2 
```

### 如果您需要您的代码都具有超级性能：

```
# Stops iterating through the list as soon as it finds the value
def getIndexOfTuple(l, index, value):
    for pos,t in enumerate(l):
        if t[index] == value:
            return pos

    # Matches behavior of list.index
    raise ValueError("list.index(x): x not in list")

getIndexOfTuple(tuple_list, 0, "cherry")   # = 1 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-03T20:12:28.133

一种可能性是使用模块中的[itemgetter](http://docs.python.org/library/operator.html#operator.itemgetter)函数`operator`：

```
import operator

f = operator.itemgetter(0)
print map(f, tuple_list).index("cherry") # yields 1 
```

调用返回一个函数，该函数将对传递给它的任何内容`itemgetter`执行等效的操作。`foo[0]`使用`map`，然后将该函数应用于每个元组，将信息提取到一个新列表中，然后您`index`可以正常调用该列表。

```
map(f, tuple_list) 
```

相当于：

```
[f(tuple_list[0]), f(tuple_list[1]), ...etc] 
```

这又相当于：

```
[tuple_list[0][0], tuple_list[1][0], tuple_list[2][0]] 
```

这使：

```
["pineapple", "cherry", ...etc] 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-03T20:50:48.290

您可以使用列表理解和 index() 来做到这一点

```
tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]
[x[0] for x in tuple_list].index("kumquat")
2
[x[1] for x in tuple_list].index(7)
1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-02-17T01:49:51.797

受[这个问题](https://stackoverflow.com/questions/35446421/finding-a-specific-value-from-list-of-dictionary-in-python#35446432)的启发，我发现这很优雅：

```
>>> tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]
>>> next(i for i, t in enumerate(tuple_list) if t[1] == 7)
1
>>> next(i for i, t in enumerate(tuple_list) if t[0] == "kumquat")
2 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-27T20:02:43.993

我会把它作为对 Triptych 的评论，但由于缺乏评级，我还不能发表评论：

使用枚举器方法匹配元组列表中的子索引。例如

```
li = [(1,2,3,4), (11,22,33,44), (111,222,333,444), ('a','b','c','d'),
        ('aa','bb','cc','dd'), ('aaa','bbb','ccc','ddd')]

# want pos of item having [22,44] in positions 1 and 3:

def getIndexOfTupleWithIndices(li, indices, vals):

    # if index is a tuple of subindices to match against:
    for pos,k in enumerate(li):
        match = True
        for i in indices:
            if k[i] != vals[i]:
                match = False
                break;
        if (match):
            return pos

    # Matches behavior of list.index
    raise ValueError("list.index(x): x not in list")

idx = [1,3]
vals = [22,44]
print getIndexOfTupleWithIndices(li,idx,vals)    # = 1
idx = [0,1]
vals = ['a','b']
print getIndexOfTupleWithIndices(li,idx,vals)    # = 3
idx = [2,1]
vals = ['cc','bb']
print getIndexOfTupleWithIndices(li,idx,vals)    # = 4 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-19T17:38:27.873

好的，这可能是一个错误`vals(j)`，更正是：

```
def getIndex(li,indices,vals):
for pos,k in enumerate(lista):
    match = True
    for i in indices:
        if k[i] != vals[indices.index(i)]:
            match = False
            break
    if(match):
        return pos 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-16T17:19:20.830

```
z = list(zip(*tuple_list))
z[1][z[0].index('persimon')] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-16T16:44:44.717

```
tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]

def eachtuple(tupple, pos1, val):
    for e in tupple:
        if e == val:
            return True

for e in tuple_list:
    if eachtuple(e, 1, 7) is True:
        print tuple_list.index(e)

for e in tuple_list:
    if eachtuple(e, 0, "kumquat") is True:
        print tuple_list.index(e) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-04T08:21:41.610

这也可以使用 Lambda 表达式：

```
l = [('rana', 1, 1), ('pato', 1, 1), ('perro', 1, 1)]
map(lambda x:x[0], l).index("pato") # returns 1 
```

##### 编辑以添加示例：

```
l=[['rana', 1, 1], ['pato', 2, 1], ['perro', 1, 1], ['pato', 2, 2], ['pato', 2, 2]] 
```

按条件提取所有项目：

```
filter(lambda x:x[0]=="pato", l) #[['pato', 2, 1], ['pato', 2, 2], ['pato', 2, 2]] 
```

使用索引按条件提取所有项目：

```
>>> filter(lambda x:x[1][0]=="pato", enumerate(l))
[(1, ['pato', 2, 1]), (3, ['pato', 2, 2]), (4, ['pato', 2, 2])]
>>> map(lambda x:x[1],_)
[['pato', 2, 1], ['pato', 2, 2], ['pato', 2, 2]] 
```

*注意：*该`_`变量仅在交互式解释器中有效。更一般地，必须明确分配`_`，即`_=filter(lambda x:x[1][0]=="pato", enumerate(l))`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-09T01:54:40.320

Python 的 list.index(x) 返回列表中第一次出现 x 的索引。所以我们可以通过列表压缩返回的对象来获取它们的索引。

```
>>> tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11)]
>>> [tuple_list.index(t) for t in tuple_list if t[1] == 7]
[1]
>>> [tuple_list.index(t) for t in tuple_list if t[0] == 'kumquat']
[2] 
```

使用同一行，我们还可以在有多个匹配元素的情况下获取索引列表。

```
>>> tuple_list = [("pineapple", 5), ("cherry", 7), ("kumquat", 3), ("plum", 11), ("banana", 7)]
>>> [tuple_list.index(t) for t in tuple_list if t[1] == 7]
[1, 4] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-23T01:45:12.433

我想以下不是最好的方法（速度和优雅问题），但它可能会有所帮助：

```
from collections import OrderedDict as od
t = [('pineapple', 5), ('cherry', 7), ('kumquat', 3), ('plum', 11)]
list(od(t).keys()).index('kumquat')
2
list(od(t).values()).index(7)
7
# bonus :
od(t)['kumquat']
3 
```

有 2 个成员的元组列表可以直接转换为有序 dict，数据结构实际上是相同的，所以我们可以即时使用 dict 方法。

# c# - 将非常大的十进制数转换为十六进制 (1.67119535743*10^33)

> ID：946863
> 
> 赞同：0
> 
> 时间：2009-06-03T20:02:17.610
> 
> 标签：c#, php, decimal, hex

我很好奇是否可以通过 PHP 或 C# 将一个非常非常大的十进制数（例如 1.67119535743*10^33/1.67119535743E+33）转换为十六进制。不幸的是，我之前的所有尝试都失败了。提前感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:07:14.713

你的意思是，将其转换为十六进制字符串？您可能会查看 bigint 库，例如[CodeProject 上的这个](http://www.codeproject.com/KB/cs/biginteger.aspx)库。

```
BigInteger bi = new BigInteger("12345678901234567890");
string s = bi.ToHexString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:07:45.930

我假设您将数字存储为字节数组，并希望将十六进制数字输出为字符串？

这应该在 C# 中完成工作：

```
public static string ConvertToHex(byte[] value)
{
    var sb = new System.Text.StringBuilder();
    for (int i = 0; i < sb.Length; i++)
        sb.Append(value[i].ToString("X"));

    return sb.ToString();
} 
```

# c# - 是否可以在多个项目之间共享 ResourceDictionary 文件？

> ID：946869
> 
> 赞同：19
> 
> 时间：2009-06-03T20:03:03.427
> 
> 标签：c#, wpf, xaml, resourcedictionary

如果我在一个项目中有一个 ResourceDictionary，是否可以创建另一个使用第一个项目中定义的资源的项目？请注意，这两个项目都是 WPF 应用程序，而不是 ControlLibraries。

谢谢！！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-03T20:31:00.017

是的，当然可以，只要项目 B 引用了项目 A。

```
<ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/Project A;component/YourSubFolder/YourResourceFile.xaml" />
</ResourceDictionary.MergedDictionaries> 
```

然后，您可以只使用 YourResourceFile.xaml 中定义的资源。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-18T13:41:09.150

我发现我必须引用程序集本身而不是使用项目名称。我也不需要使用 pack:/// 语法来让它工作。

此重复问题的答案指定了要使用的格式（我可以验证此语法在 .NET 4.0 中是否有效）： [https ://stackoverflow.com/a/10216253/1260563](https://stackoverflow.com/a/10216253/1260563)

具体来说（因为我总是忘记组件部分，认为它是某人正在使用的文件夹）：

```
<ResourceDictionary.MergedDictionaries>
   <ResourceDictionary Source="/<YourAssemblyName>;component/<YourReferencedFileHere.xaml>" />
</ResourceDictionary.MergedDictionaries> 
```

因此，如果您在根级别有一个程序集 Abc.Def.dll 和该 DLL 中名为 Xyz.xaml 的文件，您将使用：

```
<ResourceDictionary.MergedDictionaries>
   <ResourceDictionary Source="/Abc.Def;component/Xyz.xaml" />
</ResourceDictionary.MergedDictionaries> 
```

注意：Resharper 7 指出我必须引用程序集本身。

# sql - 在 SQL Server 中将多个字段合并为一个文本字段

> ID：946874
> 
> 赞同：0
> 
> 时间：2009-06-03T20:03:18.777
> 
> 标签：sql, sql-server, tsql, string-concatenation

所以我有一个看起来像这样的表：

```
名称 ID TaskID HoursAssigned
-------------------------------------------------- --------------
约翰·史密斯 4592 A01 40
马修·琼斯 2863 A01 20
杰克亚当斯 1182 A01 100
马修·琼斯 2863 A02 50
杰克亚当斯 2863 A02 10
```

我想返回一个如下所示的数据集：

```
任务 ID 人员分配
-------------------------------------------------- ----------
A01 杰克·亚当斯、约翰·史密斯、马修·琼斯
A02 马修·琼斯，杰克·亚当斯
```

这里的问题是我不知道有多少人被分配到一个给定的任务。任何建议都会很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T20:13:02.050

每天都会在这里问这个问题。 [这是昨天的](https://stackoverflow.com/questions/941103/concat-groups-in-mssql)。还有[一个](https://stackoverflow.com/questions/273238/how-to-use-group-by-to-concatenate-strings-in-mssql)

[https://stackoverflow.com/questions/tagged/sql+string-concatenation](https://stackoverflow.com/questions/tagged/sql+string-concatenation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:23:15.320

试试这个：

```
declare @table table (name varchar(30), ID int, TaskID char(3), HoursAssigned int)

insert into @table values ('John Smith'   ,4592 ,'A01'  ,40)
insert into @table values ('Matthew Jones',2863 ,'A01'  ,20)
insert into @table values ('Jake Adams'   ,1182 ,'A01'  ,100)
insert into @table values ('Matthew Jones',2863 ,'A02'  ,50)
insert into @table values ('Jake Adams'   ,2863 ,'A02'  ,10)

--formatted so you can see what is happening
SELECT DISTINCT
    t1.TaskID
       ,SUBSTRING(
                  replace(
                          replace(
                                  (SELECT
                                       t2.Name
                                       FROM @Table AS t2
                                       WHERE t1.TaskID=t2.TaskID
                                       ORDER BY t2.Name
                                       FOR XML PATH(''))
                                 ,'</NAME>','')
                         ,'<NAME>',', ')
                 ,3,2000)  AS PeopleAssigned
    FROM @table AS t1 
```

根据昨天的回答！

这是输出：

```
(1 row(s) affected)

(1 row(s) affected)

(1 row(s) affected)

(1 row(s) affected)

(1 row(s) affected)
TaskID PeopleAssigned
------ --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
A01    Jake Adams, John Smith, Matthew Jones
A02    Jake Adams, Matthew Jones

(2 row(s) affected) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:53:38.287

顺便说一句，将名称存储在一个字段中是个坏主意。使得查询非常困难。如果不使用通配符作为阻止数据库使用索引的第一个字符，您将如何有效地搜索“Smith”。如果名称像这样以自由形式存储，一个人可能是“John Smith”、“Smith, John”、“Smith, John”、“Smith,John”等，你不会意识到他们是同一个人。您至少应该有 first_name、middle_name、last_name、personal_Suffix，然后您可能有一个计算字段，以您希望显示的格式显示完整名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:09:58.623

我是 sql 的新手，也是 stackoverflow 的新手，但这不起作用吗？

SELECT taskid, name FROM table GROUP BY taskid

# asp.net - 在 ASP.NET 中调用 DB 后与 SQL 的连接未关闭

> ID：946885
> 
> 赞同：0
> 
> 时间：2009-06-03T20:04:55.997
> 
> 标签：asp.net, sql-server-2005, sqlconnection

我有一个通用方法来调用 ASP.NET 中的存储过程：

```
public SqlDataReader ExecuteStoredProc(string sprocName, SqlParameter[] SqlP)
        {
            SqlDataReader iReader;
            SqlCommand sql = new SqlCommand();

            sql.CommandText = sprocName;
            sql.CommandType = CommandType.StoredProcedure;
            sql.Connection = ConnStr;
            if (SqlP != null)
            {
                foreach (SqlParameter p in SqlP)
                {
                    sql.Parameters.Add(p);
                }

            }
            sql.Connection.Open();
            iReader = sql.ExecuteReader(CommandBehavior.CloseConnection);
            sql.Dispose();

            return iReader;
        } 
```

即使我正在调用 CommandBehavior.CloseConnection，连接也没有关闭。第一次请求页面时，我可以很好地获取数据。重新加载时出现以下错误：

> 连接未关闭。连接的当前状态是打开的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.InvalidOperationException：连接未关闭。连接的当前状态是打开的。
> 
> 源错误：
> 
> 第 35 行：第 36 行：} 第 37 行：sql.Connection.Open(); 第 38 行：iReader = sql.ExecuteReader(CommandBehavior.CloseConnection); 第 39 行：sql.Dispose();

最后，如果我把 sql.Connection.Close(); 之前 sql.Dispose(); 我收到 iReader 不可读的错误，因为它已经关闭。

显然我错误地关闭了我的连接，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T20:13:06.293

返回 DataReader 时，基础连接必须保持打开状态。正确清理资源是消费者的责任。

```
public SqlDataReader ExecuteStoredProc(string sprocName, SqlParameter[] SqlP)
{
    SqlCommand sql = new SqlCommand();

    sql.CommandText = sprocName;
    sql.CommandType = CommandType.StoredProcedure;
    sql.Connection = ConnStr;
    if (SqlP != null)
    {
        foreach (SqlParameter p in SqlP)
        {
            sql.Parameters.Add(p);
        }

    }
    sql.Connection.Open();
    return sql.ExecuteReader(CommandBehavior.CloseConnection);          
}

public void ConsumingMethod()
{
    using(SqlDataReader reader = ExecuteStoredProc("MyProc", params))
    {
        while(reader.Read())
        {
            //work with your reader
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:11:54.907

我建议用“使用”语句包装 sql 连接，这将解决大多数 sql 连接问题。

```
using (var conn = new SqlConnection("..."))
{
    conn.Open();
    using (var cmd = conn.CreateCommand())
    {
        cmd.CommandText = "...";
        using (var reader = cmd.ExecuteReader())
        {
            while (reader.Read())
            {
                // ...
            }
        }
    } 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:28:03.687

这个想法是做一个 Connection.Close(); 在你完成 SqlReader 之后，所以基本上不要将 close() 语句放在 SqlReader.Dispose() 命令之前，而应该将它放在下面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:00:11.643

这是我处理 IDataReader 的首选方式。让调用者创建 SqlConnection 实例并传递给方法。

创建 SqlConnection 实例的成本很高。你最终会在不同的情况下多次调用相同的 ExecuteStoredProc 方法。

因此，我通过添加 SqlConnection 实例作为参数的一部分来重构 ExecuteStoredProc 方法。

```
using (SqlConnection conn = new SqlConnection())
{
    conn.ConnectionString = // Connection String;
    conn.Open();

    using (IDataReader reader = foo.ExecuteStoredProc(conn, sprocName, SqlP))
    {
        // Process IDataReader
    }
} 
```

# http - 如何使用 POST 命令发送文件？

> ID：946890
> 
> 赞同：0
> 
> 时间：2009-06-03T20:05:15.840
> 
> 标签：http, command-line, post

我想使用几乎所有包含 Perl 的 linux 上可用的 POST 命令发送文件。

我想知道怎么做。。

我想做类似的事情：

```
linux:currentdir/$ POST http://www.example.com/upload.php > myFileToUpload 
```

我想我可能不得不对文件进行编码，我是对的，它在 base64 中？不是吗？我还读到我可以设置 Content-Type 标头，是否应该使用 'multipart/mixed' 设置？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:18:46.017

您可以考虑研究 Curl。它更加健壮。自动提交文件上传表单的示例如下：

```
<form method="POST" enctype='multipart/form-data' action="upload.cgi">
  <input type=file name=upload>
  <input type=submit name=press value="OK">
</form> 
```

然后使用命令

```
curl -F upload=@localfilename -F press=OK http://www.example.com/form.cgi 
```

# .net - 客户端上的 DataGridView、ADO.NET、绑定和分页

> ID：946892
> 
> 赞同：2
> 
> 时间：2009-06-03T20:05:22.533
> 
> 标签：.net, data-binding, ado.net, datatable, pagination

我正在开发一个 WinForm 应用程序，该应用程序有几个查询，这些查询带回大约 20000 条记录，然后填充一个 DataTable，并将该 DataTable 绑定到一个 DataGridView。

我想让用户一次翻阅 500 条记录。做这个的最好方式是什么？我想在客户端进行分页。我看到 System.Data.DataView 有一个过滤器和排序，但对分页没有任何帮助。

**更新：** 我开始考虑一些定制的方法。我可以获取 DataTable/DataRow 在内部使用的唯一“行计数 id”吗？并用它来计算我需要的记录数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:09:26.127

下面是一个来自 VB-Tips 的例子：

[http://www.vb-tips.com/dbPages.aspx?ID=5dbe894a-a7e6-434c-bd84-73494c71063f](http://www.vb-tips.com/dbPages.aspx?ID=5dbe894a-a7e6-434c-bd84-73494c71063f)

```
Imports System.Data.SqlClient
Imports System.Text
Imports System.ComponentModel

Public Class Form1

    Dim da As SqlDataAdapter
    Dim conn As SqlConnection
    Dim ds As New DataSet

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim strConn As String
        Dim cmd As SqlCommand
        Dim sbCmd As New StringBuilder

        strConn = String.Format("Server = {0};", Environment.MachineName)
        strConn &= "Database = NorthWind; Integrated Security = SSPI;"
        conn = New SqlConnection(strConn)
        cmd = New SqlCommand("Select count(ProductName) From Products", conn)
        Try
            da = New SqlDataAdapter("Select * from Products", conn)

            conn.Open()

            With nuPage
                .Maximum = Math.Ceiling(cmd.ExecuteScalar / 10)
                .Minimum = 1
                .Increment = 1
                .Value = 1
            End With

            conn.Close()

            da.Fill(ds, 0, 10, "Products")
            ds.Tables("Products").DefaultView.AllowNew = False
            DataGridView1.DataSource = ds.Tables("Products")
            For Each col As Object In DataGridView1.Columns
                If TypeOf col Is DataGridViewCheckBoxColumn Then
                    DirectCast(col, DataGridViewCheckBoxColumn).Visible = False
                ElseIf TypeOf col Is DataGridViewTextBoxColumn Then
                    Dim tbc As DataGridViewTextBoxColumn = CType(col, DataGridViewTextBoxColumn)
                    If tbc.Name = "ProductName" Then
                        tbc.Width = 275
                        tbc.HeaderText = "Product Name"
                    ElseIf tbc.Name = "UnitPrice" Then
                        tbc.Width = 75
                        tbc.HeaderText = "Price"
                        tbc.DefaultCellStyle.Format = "c"
                        tbc.DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleRight
                    Else
                        tbc.Visible = False
                    End If
                End If
            Next
        Catch ex As Exception
            Trace.WriteLine(ex.ToString)
        End Try

    End Sub

    Private Sub nuPage_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nuPage.ValueChanged
        Dim intStart As Integer = (nuPage.Value - 1) * 10
        ds.Clear()
        da.Fill(ds, intStart, 10, "Products")

    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:11:11.537

我的第一次寻呼尝试涉及内置寻呼机。但是，我已经快速迁移到触发页面绑定的自定义元素。

通常（至少在 ASP 中），您会将 DataTable 绑定到 DataGridView，然后执行

DataGridView.ActivePageIndex=x; DataGridView.Databind();

但是，由于我们谈论的是 20.000 条记录，因此最好先查找找到的记录数量，然后将 500 条记录带入客户端。

*编辑 - 经过简单检查，Windows 窗体中没有分页选项。我最好的猜测是您将需要进行查找/自定义分页。

# sql - Oracle 8i 查询帮助

> ID：946899
> 
> 赞同：1
> 
> 时间：2009-06-03T20:06:41.967
> 
> 标签：sql, oracle

我有一个看起来像这样的表：

```
 ID    |     STATUS    |     TYPE
----------------------------------------
x123       |      A        | High School
x122       |      I        | High School
x124       |      F        | High School
x125       |      A        | College
x126       |      I        | College
x127       |      F        | College
x128       |      F        | College 
```

任何人都可以帮我想出一个查询 oracle 8i 来显示这个表像这样

```
Type             |    Count A    |    Count I    |  Count F
------------------------------------------------------------
High School      |     1         |     1         |  1
College          |     1         |     1         |  2 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T20:12:53.080

这是一种方法：

```
select t.type                                          as "Type"
     , sum(case when t.status = 'A' then 1 else 0 end) as "Count A"
     , sum(case when t.status = 'I' then 1 else 0 end) as "Count I"
     , sum(case when t.status = 'F' then 1 else 0 end) as "Count F"
  from my_table t
 group by t.type
 order by t.type desc 
```

如果您有要返回的特定列，则此方法适用，并且适用于“计数”满足更复杂条件集的行。

[编辑]

（添加了 DESC 关键字以获取结果集，如 OP 所示，Rob van Wijk +1 good catch！）

（Andomar 做了一个很好的观察，结果集中的列越来越多，使用这种方法，语句变得笨拙。如果唯一的“测试”是相等的比较，还有其他方法可以得到相同的结果集单列。）

Oracle 8i 确实支持 CASE 表达式，不是吗？如果我没记错的话，Oracle 8 没有。我们可以用 DECODE 函数去“老派”做同样的事情：

```
select t.type                        as "Type"
     , sum(decode(t.status,'A',1,0)) as "Count A"
     , sum(decode(t.status,'I',1,0)) as "Count I"
     , sum(decode(t.status,'F',1,0)) as "Count F"
  from my_table t
 group by t.type
 order by t.type DESC 
```

[/编辑]

有时，我们想要检查多个类型条件，并在多个计数中包含一行。我们可以得到一个总数

```
select t.type                                             as "Type"
     , sum(case when t.status in ('A') then 1 else 0 end) as "Count A"
     , sum(case when t.status in ('I') then 1 else 0 end) as "Count I"
     , sum(case when t.status in ('F') then 1 else 0 end) as "Count F"
     , sum(case when t.status in ('A','I') then 1 else 0 end) as "#AI"
     , sum(decode(sign(t.foo-t.bar),1,1,0))               as "#foo>bar"
     , sum(decode(sign(10.0-t.foo),1,1,0))                as "#foo<10"
  from my_table t
 group by t.type
 order by t.type desc 
```

（需要指出的是，一行可能满足多列的指定条件，因此它可能会被多次“计数”。有时，这正是我们想要的。）

# asp.net - ASP.NET 从内存而不是文件中流式传输内容

> ID：946908
> 
> 赞同：1
> 
> 时间：2009-06-03T20:07:41.263
> 
> 标签：asp.net, dynamic, download, stream

用户已请求“下载”表示 GridView 内容的 csv 文件的选项。有谁知道如何在不将文件保存到服务器的情况下执行此操作，而只是将其从内存中流式传输给用户？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:21:08.630

实现一个 IHttpHandler。

我在 ProcessResponse 中使用了类似于以下内容的内容来输出以前在数据库表中构建的 CSV...

```
public void ProcessRequest(HttpContext context)
{
    HttpResponse response = context.Response;
    HttpRequest request = context.Request;

    //Get data to output here...

    //Turn off Caching and enforce a content type that will prompt to download/save.
    response.AddHeader("Connection", "close");
    response.AddHeader("Cache-Control", "private");
    response.ContentType = "application/octect-stream";

    //Give the browser a hint at the name of the file.
    response.AddHeader("content-disposition", string.Format("attachment; filename={0}", _filename));

    //Output the CSV here...
    foreach(BatchDTO.BatchRecordsRow row in dtoBatch.BatchRecords)
        response.Output.WriteLine(row.Data);

    response.Flush();
    response.Close();
} 
```

有许多库可以更轻松地生成 CSV，您应该能够将 Response.OutputStream 传递给它，让它写入那里而不是文件流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T19:15:13.650

我创建了一个 StringBuilder 并使用以下代码将内容转储到 Response 对象（“csv”是 StringBuilder 变量）。

```
 Response.ContentType = @"application/x-msdownload";
    Response.AppendHeader("content-disposition", "attachment; filename=" + FILE_NAME);

    Response.Write(csv.ToString());
    Response.Flush();
    Response.End(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:10:53.973

使用 context.Response.OutputStream。

[这是](http://www.xoc.net/works/tips/graphic.asp)一个例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:10:26.813

我已经使用 RKLib 导出库几次，效果很好，它使用内存流，并且可以提供任何数据表，它将导出为 csv 下载：

[http://www.codeproject.com/KB/aspnet/ExportClassLibrary.aspx](http://www.codeproject.com/KB/aspnet/ExportClassLibrary.aspx)

# asp.net - 响应不以 HTTP 开头

> ID：946915
> 
> 赞同：0
> 
> 时间：2009-06-03T20:08:37.767
> 
> 标签：asp.net, http, iis, firefox, httpresponse

将 Firefox 附加到提琴手并出现以下错误。什么会导致这个错误？

![替代文字](https://lh3.ggpht.com/_iyd5d9iK650/SibmdZG_AeI/AAAAAAAAARs/YQTup02cLXs/s800/response_does_not_start_with_http.PNG)

值得注意的是，HTTP 标头正在页面上呈现

![替代文字](https://lh4.ggpht.com/_iyd5d9iK650/SibWlZ24iHI/AAAAAAAAARk/zV89V-aTmvE/s800/header_rendered.JPG)

所以 Fiddler 说存在协议违规，因为响应不是以 HTTP 开头的。但是 HTTP 响应是在页面上呈现的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T05:28:21.000

您可以使用它`telnet`来准确查看服务器返回的内容。如果您在端口 800 上运行服务器，请尝试以下操作：

```
$ telnet hostname 800
GET / HTTP/1.0 
```

（您需要在 GET 行之后按两次回车。如果需要，您也可以在此时添加标题。）

并假设一个领先的空白行是问题，你会看到类似

```
(blank line)
HTTP/1.1 200 OK
Various-headers: here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:17:35.177

在显示 HTTP 标头信息之前，可能会显示某些页面内容，尤其是具有空行的页面内容。在这种情况下，浏览器会认为这是 HTTP 标头部分的结尾，并将这些字符呈现为内容。

（您的附件链接现在已损坏，因此看不到任何信息）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T01:05:50.960

服务器没有正确发送东西。一个有效的 HTTP 响应将是 HTTP 标头，后跟一个空行，然后是内容。在这种情况下，似乎没有遵循这一点。如果 HTTP 标头之前有一个空行，则 HTTP 标头将被视为内容并相应地呈现。

# html - div背景颜色被切断

> ID：946918
> 
> 赞同：0
> 
> 时间：2009-06-03T20:08:57.987
> 
> 标签：html, css

这是它在 IE6 中的屏幕截图，在其他所有内容中都可以正常工作：http: [//i39.tinypic.com/2lcr4uw.png](http://i39.tinypic.com/2lcr4uw.png)

它在 div class="article odd" 之内，它有 overflow:auto; 放。

然后它有一个 ul 列表（w/ clear:both; set），向左浮动，w/ li 被 50% 分割

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T21:20:47.327

是的，这是使用 overflow:auto 包含浮点数的错误。如果你添加一个宽度/高度，你会解决这个问题。例如，宽度：100%。

这是有关此信息的好页面。 [http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

绝对不要使用“清除 div”。它添加了不需要的标记，并且还具有浏览器打印的怪癖。

编辑：如果这没有帮助，我认为您需要给我们一些示例代码而不是图片。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T09:02:42.187

我同意Hexxagonal，不要插入额外的清除div。最好只用 CSS 修复它。

我更喜欢给 IE6`height: 1%;`或者`zoom: 1;`哪个会触发 IE 的 hasLayout。这对 IE 中的浮点数`overflow: hidden;`和`overflow: auto;`对 Firefox、Opera、Safari 等的作用相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:12:38.803

```
<div class="文章奇数">
  <ul>
  </ul>
  <div class="clear"></div>
</div>

css
---
。清除
{
   明确：两者；
}

```

# java - 坚不可摧 - HTTP 参数

> ID：946924
> 
> 赞同：0
> 
> 时间：2009-06-03T20:10:15.410
> 
> 标签：java, servlets

我一直想知道为什么 Servlet API 中没有 removeParameters() 方法。这种设计背后的动机是什么？这是一个场景：我在被迫使用的专有 MVC 框架中面临挑战。这个框架使用一个控制器 Servlet，它在它的 post 方法中托管一个算法：

```
doPost() {
//create instance of action - just like struts action
action.init
action.preexecution
if(redirection state is not set)
action.process
action.postprocess
action.finish
} 
```

我可以跳过任何特定操作的唯一方法是设置重定向 url。控制器 Servlet 是最终的。现在，当我从动作的预执行方法中执行 requestdispatcher.forward 时，控制器将继续执行其余的方法，而不是跳过其余的方法。我无法更改此行为，也无法设置重定向，因为我需要进行转发。只要我不将请求转发到相同的操作，它就可以正常工作。当一个请求转发到同一个action时，http参数都是一样的。这将使它进入一个永无止境的循环。因此，我不得不添加额外的参数，表明这是一个重复请求，应该区别对待。不确定我的问题是否有意义，但认为这是一个发布相同问题的好论坛。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T20:15:37.207

嗯...因为它没有任何用处？请求参数由客户端发送到服务器。服务器可以随意忽略它们，但是您希望这样的`removeParameter()`方法有什么实际效果呢？

**编辑：**请求参数用于服务器和客户端之间的通信。对于服务器内部通信，您可以使用请求属性，可以[设置](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequest.html#setAttribute(java.lang.String,%20java.lang.Object))和[删除](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequest.html#removeAttribute(java.lang.String))。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T21:24:07.647

编辑：McDowell 让我想起了 HttpServletRequestWrapper，所以我正在更改以下内容以减少工作量......谢谢 McD！

您可以装饰请求以“隐藏”您不想要的参数和/或添加额外的参数。

类似的东西（在我脑海中 - 没有编译所以API可能是一个调整......）

```
public class MyParameterHider extends HttpServletRequestWrapper {
    public MyParameterHider(HttpServletRequest request) {
        super(request);
    }
    public String getParameter(String name) {
       if ("parameterToHide".equals(name))
           return null;
       return realRequest.getParameter(name);
    }
    // similar for getParameterNames and getParameterMap - don't include the hidden parm
    // all other methods are strictly pass-through and are automatically
    //   handled by HttpServletRequestWrapper
} 
```

在您的转发中，只需在调用 doFilter 时将请求包装在 ParameterHider 中：

```
dispatcher.forward(new MyParameterHider(request), response); 
```

模式FTW！

希望这可以帮助！

# c# - 图像与位图类

> ID：946926
> 
> 赞同：75
> 
> 时间：2009-06-03T20:10:50.027
> 
> 标签：c#, .net, image, bitmap

我很难理解`Image`班级和`Bitmap`班级之间的区别。现在，我知道`Bitmap`继承自 the`Image`但据我所知两者非常相似。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-06-03T20:16:21.900

Bitmap 类是 Image 类的实现。Image 类是一个抽象类；

Bitmap 类包含 12 个构造函数，它们从不同的参数构造 Bitmap 对象。它可以从另一个位图和图像的字符串地址构造位图。

[在这个全面的示例中](http://www.codeproject.com/KB/GDI-plus/Image_Processing_Lab.aspx)查看更多信息。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-02-19T07:10:39.263

这是一个澄清，因为我已经看到在代码中完成的事情确实令人困惑 - 我认为以下示例可能对其他人有所帮助。

正如其他人之前所说 - **Bitmap**继承自 Abstract **Image**类

Abstract 实际上意味着您不能创建它的 New() 实例。

```
 Image imgBad1 = new Image();        // Bad - won't compile
    Image imgBad2 = new Image(200,200); // Bad - won't compile 
```

**但**您可以执行以下操作：

```
 Image imgGood;  // Not instantiated object!
    // Now you can do this
    imgGood = new Bitmap(200, 200); 
```

如果您执行了以下操作，您现在可以像使用相同的位图对象一样使用 imgGood：

```
 Bitmap bmpGood = new Bitmap(200,200); 
```

*这里的好处是您可以使用Graphics*对象绘制 imgGood对象

```
 Graphics gr = default(Graphics);
    gr = Graphics.FromImage(new Bitmap(1000, 1000));
    Rectangle rect = new Rectangle(50, 50, imgGood.Width, imgGood.Height); // where to draw
    gr.DrawImage(imgGood, rect); 
```

这里**imgGood**可以是**任何**Image 对象 - 位图、元文件或任何其他从 Image 继承的对象！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-03T20:17:52.443

Image 提供对任意图像的抽象访问，它定义了一组可以在逻辑上应用于 Image 的任何实现的方法。它不受任何特定图像格式或实现的限制。位图是封装windows GDI位图对象的图像抽象类的具体实现。位图只是图像抽象类的一个特定实现，它依赖于 GDI 位图对象。

例如，您可以通过从 Image 类继承并实现抽象方法来创建自己的 Image 抽象实现。

无论如何，这只是 OOP 的一个简单的基本用法，应该不难掌握。

# git - 从 FETCH_HEAD 返回的一次提交

> ID：946929
> 
> 赞同：1
> 
> 时间：2009-06-03T20:11:05.827
> 
> 标签：git

查看最新的 git 提交时，我知道您可以执行 git log -1..HEAD 以查看 HEAD 之前的最后一次提交。我想做的是沿着同样的思路，但不是从 HEAD 回头看，我想从 FETCH_HEAD 做。有没有办法在 git log 命令中表示这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:33:52.100

```
git log FETCH_HEAD~12..FETCH_HEAD 
```

这将显示来自 FETCH_HEAD 的最新 12 次提交

# spring - JPA @ManyToMany 编写创建但不更新

> ID：946938
> 
> 赞同：6
> 
> 时间：2009-06-03T20:12:16.217
> 
> 标签：spring, jpa, struts2, many-to-many

我的团队有两个类，`User`和`Store`，由 JPA`@ManyToMany`注释相关。相关代码如下。

当创建一个新`User`对象并设置它的存储时，生活是美好的。但是当我们尝试通过我们的 Struts 2 / Spring web UI 更新用户对象时，我们看到了一些意外的行为。（通过 JUnit 运行简单的自动化集成测试时不会出现这些问题）。

简单地说，当保存 a 时`User`，它的 stores 集合没有更新——数据库没有显示任何变化，并且重新加载有`User`问题的对象表明它具有未更改的存储集。

对于这个问题，我们找到的唯一解决方案——我们不喜欢这个解决方案，它让我们团队中的所有开发人员都感到有些不安——是创建一个新`Set`的`Store`s，然后执行`user.setStores(null)`，然后执行`user.setStores(stores)`。

我们正在使用`OpenEntityManagerInViewFilter`; 我们使用 Hibernate 作为我们的 JPA 提供者；我们正在使用 Spring 的 JpaTransactionManager。我们的代码中没有任何`@Transactional`注释——添加它们会由于其他地方描述的代理行为而破坏现有代码。

欢迎任何人提供任何关于我们如何以轻松的方式解决这个问题的见解。

* * *

User.java 的相关部分：

```
@ManyToMany
@JoinTable(name = "company.user_store_access",
        joinColumns = @JoinColumn(name = "userid"),
        inverseJoinColumns = @JoinColumn(name = "storeid"))
public Set<Store> getStores() {
    return stores;
} 
```

Store.java 的相关部分：

```
 @ManyToMany(mappedBy = "stores")
    public List<User> getUsers() {
        return users;
    } 
```

UserDetailAction.java 的相关部分：（向下传递一两层，然后：）

```
entity = getEntityManager().merge(entity); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-20T21:07:29.003

问题是您有一个双向关系，在这种情况下，有一个实体控制另一个实体，并且从您的映射中，控制实体是**Store**实体而不是**User**，因此将用户添加到商店将起作用（因为商店是控制者）但是向用户添加商店不会。

尝试颠倒这种情况，使 User 对象成为控制关系的对象，将 @ManyToMany(mappedBy = "users") 注释放在 getStores() 方法上并更改 getUsers() 之一。

希望它有所帮助。

PS控制关系的实体总是没有mappedBy属性的实体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-04T20:30:54.847

我只是遇到了同样的问题，并在另一个页面上找到了解决方案。

这对我有用

在调用合并之前调用 getJpaTemplate().flush() 对我有用。

我没有得到它工作的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T21:16:17.087

请在您的用户对象中尝试以下注释：

```
@ManyToMany(cascade = {CascadeType.ALL}) 
```

# c# - 如何判断计算机是否已重新启动？

> ID：946939
> 
> 赞同：5
> 
> 时间：2009-06-03T20:12:17.247
> 
> 标签：c#, .net, restart

我曾经使用过一个命令行 SMTP 邮件程序，作为试用版的限制，它允许您在每个 Windows 会话中接收多达 10 封电子邮件。如果您重新启动计算机，您可以再收到 10 个。我认为这种共享软件瘫痪非常简洁，我想在我的应用程序中复制它。

我只是坚持如何去做。我知道如何限制用户的操作，但我如何知道自上次运行应用程序后计算机是否已重新启动？

操作系统是 Windows，语言是 C#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-17T07:18:07.947

对于 Windows，如果要检查计算机已启动

在命令提示符上键入
`C:\>net statistics server`

其中一项统计数据
`Statistics since 22-Jun-11 10:46:20`是计算机上次启动的时间

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T20:16:31.293

您应该能够在事件日志中找到事件，例如事件日志服务启动会告诉您计算机是否已重新启动。

以下是在 C# 中读取事件日志的方法：http: [//msdn.microsoft.com/en-us/library/k6b9a7h8%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/k6b9a7h8%28VS.71%29.aspx)

```
// C#
foreach (System.Diagnostics.EventLogEntry entry in EventLog1.Entries) 
{
   Console.WriteLine(entry.Message);
} 
```

注意：您应该提供您正在使用的语言和操作系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:18:18.950

如果您使用的是 .NET，则可以为此使用[Environment.TickCount 。](http://msdn.microsoft.com/en-us/library/system.environment.tickcount.aspx)这为您提供了自系统启动以来的毫秒数。请注意，它每 24 天滚动一次，因此您必须对此进行补偿（如果您关心的话）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:30:45.383

对于 Windows 平台，您可以使用[uptime](http://support.microsoft.com/kb/232243)。

```
C:\>uptime
\\SPOCK has been up for: 2 day(s), 0 hour(s), 45 minute(s), 34 second(s) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-24T22:26:49.923

上面的答案适用于 Windows Server 2008 之前的系统，但对于 Windows 2008，有一种更简单的方法可以找到 Windows 2008 服务器的正常运行时间。

*   任务管理器 > 性能 > 正常运行时间

![任务管理器](https://i.stack.imgur.com/2AG8d.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T20:28:01.287

难道你不能只记录你的应用程序执行的事件数。然后在计数器达到阈值时停止？如果您的应用程序包含服务，那么它可以作为服务的一部分嵌入，该服务将通过 Windows 会话重新启动。我怀疑这就是 SMTP 服务器的工作方式，至少这是我实现类似功能的最简单方法。它会让大多数新手/中级系统管理员重新启动机器，而聪明的人可能无论如何都应该免费拥有该软件。

# c# - 如何为 Point3 实现 Slerp？

> ID：946944
> 
> 赞同：0
> 
> 时间：2009-06-03T20:12:49.350
> 
> 标签：c#, .net, math

我正在尝试实现一个 Point3.Slerp 方法，因此正在寻找一些示例，但我发现的那些似乎是一个全新的类来托管所有代码。

有没有一种简单直接的方法来实现它？基本上我看到的是使用矩阵类型。我可以在没有矩阵的情况下实现 Slerp，还是会成为劣势（性能等）？

伪代码也很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T20:21:49.207

[球面线性插值](http://en.wikipedia.org/wiki/Slerp)通常与四元数一起使用，而不是点。只有当您尝试在两个特定旋转之间进行插值时，它才真正有意义。

我可以看到这与 Point3 直接相关的唯一地方是，如果您在球体表面上有 2 个点，并且您想在测地线路径周围“滑动”它们之间。在这种情况下，您的点并不是真正被插值的点 - 它们被用于计算两个轴和角度（定义四元数）并在它们之间进行插值。

如果您在两个 point3 值之间进行插值，则可能需要直接线性插值。

至于使用矩阵——如果你把你的点变成四元数形式，你可以[直接使用四元数数学](http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/index.htm)——不需要矩阵。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T20:40:27.593

如果您使用的是球形空间（例如行星表面或类似情况），则点 slerp 是有意义的。

在我的脑海中，我会取你的起点和终点的叉积（作为向量）来获得一个旋转轴，然后你可以计算 X、Y 和 Z 的旋转（以避免必须创建自己的矩阵类，正如你似乎想要的那样）。

[http://en.wikipedia.org/wiki/Rotation_matrix#Dimension_three](http://en.wikipedia.org/wiki/Rotation_matrix#Dimension_three)

该链接显示了轴/角度对的旋转矩阵。只需写出每个组件的乘法并简化以获得无矩阵转换。

编辑：

下面是一个关于轴 (x, y, z) 的简单分解旋转：

```
X' = (x^2 + (1 - x^2) * cos(theta) + (x * y * (1 - cos(theta)) - x * sin(theta)) + (x * z * (1 - cos(theta)) + y * sin(theta))
Y' = (x * y * (1 - cos(theta)) + z * sin(theta)) + (y^2 + (1 - y^2) * cos(theta)) + (y * z * (1 - cos(theta)) - x * sin(theta))
Z' = (x * z * (1 - cos(theta)) - y * sin(theta)) + (y * z * (1 - cos(theta)) + x * sin(theta)) + (z^2 + (1 - z^2) * cos(theta)) 
```

由于您还需要参数化旋转，因此请确保计算向量之间的角度（两个点的标量积的反余弦）并根据插值参数将 theta 设置为 0 和该角度之间的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:21:09.647

Slerp 你需要四元数，这就是为什么有一个全新的类。

# python - 如何使用python远程执行进程

> ID：946946
> 
> 赞同：30
> 
> 时间：2009-06-03T20:12:56.213
> 
> 标签：python, ssh

我想使用 Python 连接到远程服务器并在远程服务器上执行一个进程。我希望能够获得进程的返回码和标准错误（如果有的话）。以前有没有人做过这样的事情。我已经用 ssh 完成了，但我想从 Python 脚本中完成。

干杯。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-01-10T03:55:15.060

使用为此目的创建的[名为 paramiko 的 ssh 模块](http://pypi.python.org/pypi/paramiko/)`subprocess`，而不是使用. 下面是一个示例：

```
from paramiko import SSHClient
client = SSHClient()
client.load_system_host_keys()
client.connect("hostname", username="user")
stdin, stdout, stderr = client.exec_command('program')
print "stderr: ", stderr.readlines()
print "pwd: ", stdout.readlines() 
```

更新：该示例用于使用该`ssh`模块，但现在已弃用，[paramiko](http://pypi.python.org/pypi/paramiko/)是在 python 中提供 ssh 功能的最新模块。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-03T20:15:42.527

好吧，你可以从 python 调用 ssh ......

```
import subprocess
ret = subprocess.call(["ssh", "user@host", "program"]);

# or, with stderr:
prog = subprocess.Popen(["ssh", "user@host", "program"], stderr=subprocess.PIPE)
errdata = prog.communicate()[1] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-19T09:09:26.590

也许如果你想包装 ssh 调用的具体细节，你可以使用[Fabric](http://docs.fabfile.org) 这个库面向部署和服务器管理，但它也可能对这类问题有用。

也看看[芹菜](http://docs.celeryproject.org/en/latest/index.html)。这在各种代理上实现了 Python/Django 的任务队列。也许对您的问题来说有点矫枉过正，但是如果您要在多台机器上调用更多功能，它将为您节省很多管理连接的麻烦。

# assembly - 是否有汇编代码约定（主要是 PIC）？

> ID：946950
> 
> 赞同：6
> 
> 时间：2009-06-03T20:13:22.627
> 
> 标签：assembly, comments, conventions, microcontroller

是否有汇编代码约定（主要是 PIC）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T20:29:46.600

我能够找到您可能感兴趣的[汇编语言样式指南（PDF） 。](http://www.sourceformat.com/pdf/asm-coding-standard-brown.pdf)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T20:37:39.690

**在编写程序集时，评论每一行**是非常有帮助的，而且一点也不过分

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-03T01:19:43.993

这取决于您是在汇编中编程还是使用 ac 编译器为您创建程序集，如果性能很重要，请不要使用 ac 编译器，请自己编写程序集。

但一般来说，约定是注释每一行，使用具有有意义指针名称的简单子例程。您会在该块上发表评论，即

```
 start:   movlw   0x24      //  \
             movf    count     //   put 24 into count

    MyCount: decfsz  count     //decrement count and exit if done
             goto    myCount   //do the loop
             goto    exit      //count is done exit 
```

这是典型的编码，地址指针的第一列是命令和关联的变量，您通常在实际程序之前的标题部分定义变量，但这对于您正在使用的汇编程序来说是特定的。有些不给你变量指针选项，你必须使用直接内存位置。如果您查看从反汇编程序中返回的注释代码，它会看起来像。

```
 0020  movlw  0x24
    0021  movf   0x25     // 0x25 = memory address of count
    0022  decfsz 0x25
    0023  goto   0x0022   // loop back to 0x22 until count = 0
    0024  goto   0x01FF 
```

然后你把它注释掉，确保你的代码使用'nop's来将代码偏移到好的整数，比如开始有一个20的地址，让2到20之间的地址为中断等清除。根据芯片的不同，我为 12f675 编写了很多代码，所以这就是我通常使用的模型。

还将代码保存在简单清晰的子例程中，并且地址应该是很好的整数，在初始子例程之间留下大约 10 个 nop 的块，您可以随时返回并稍后压缩代码。并且总是评论你的代码，你不能评论它。

此外，我通常将我的 init routeen 尽可能靠近内存末尾，为该实际程序留出最大空间。

希望对一些人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-22T21:04:38.793

我和 Jason S 在一起——尽可能使用 C 编译器，即使您最终使用“__asm”关键字在“.c”文件中嵌入了几行汇编语言。

如果您必须在汇编程序中为 PIC 编写整个程序，推荐的函数调用约定位于 [PIClist：PIC Paging 和 PCLATH](http://piclist.org/techref/microchip/pages.htm)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T20:25:37.577

我认为没有任何正式的东西，但是阅读他们网站上的编码示例可以让您体验到通常的习语。请注意，许多不同的爱好者有很多“贡献”，他们可能不是那么好。

还要检查其他项目，大多数都会有丑陋的代码；但你会发现一两颗宝石。

我从未在 PIC 上编程，但喜欢阅读代码。我隐约记得一个“实时操作系统”，它的执行流程非常好和干净。不记得编码风格有多一致，但我会从那里开始。

最好阅读它们中的大多数，当它像散文一样简单时，你就会找到你的风格

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-25T21:48:27.057

这实际上取决于您使用的 PIC 型号。例如，PIC16s 和 PIC18s 有很多汇编示例，可以在网上轻松找到。

然而，像 PIC24 和 PIC32 这样的模型更适合 C 语言。它们是 C 语言中的很多 PIC 示例，可以在您的特定 PIC 模型的网站上找到。这些 PIC 模型仍然可以在 Assembly 中编程，但它们是很少的关于如何编程的 Web 示例。最好的资源在 MPLAB 中的“帮助”下，检查 PIC 模型使用的任何汇编器的“帮助内容”。这将向您展示一些示例以及有关如何在 PIC 汇编中编程和完成简单的 PIC 任务（例如定义内存或编写宏）的说明。

# perl - 如何确定脚本是在 Perl 中的系统调用还是 qx 调用中执行？

> ID：946959
> 
> 赞同：3
> 
> 时间：2009-06-03T20:15:23.993
> 
> 标签：perl

在 Perl 中，是否可以确定一个脚本是否正在另一个脚本中执行（可能是通过`system`or `qx`）？

```
$ cat foo.pl
print "foo";
print "\n" if not $in_qx;  # or the like. 
```

我意识到如果脚本是通过`exec`.

我确定`system`将进程作为 a 运行，`fork`并且我知道`fork`可以返回一个可变的值，具体取决于您是在父进程中还是在子进程中。不确定`qx`。

无论如何，我不确定如何在`fork`没有实际执行`fork`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T21:25:19.813

所有进程都来自另一个进程（init 除外）。您可以判断程序是从`open`, `qx//`,`open2`还是`open3`使用[POSIX](http://perldoc.perl.org/POSIX.html)`isatty`中的函数运行的，但是如果不查看进程树就无法确定您是否正在运行，即使那样它也会变得模糊（例如，不会将调用 perl 进程作为其父进程）。`system``system "nohup", "./foo.pl"`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T20:43:21.770

你可以检查“谁是你爸爸”，使用“getppid”（获取父母ID）。然后检查您的父 id 是否是带有 pgrep 或类似的 perl 脚本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:28:50.333

你控制来电者吗？最简单的做法是传递一个参数，例如`--isforked`.

# c# - 您可以将 XAML DrawingImage 转换回 SVG 进行编辑吗？

> ID：946966
> 
> 赞同：11
> 
> 时间：2009-06-03T20:16:42.337
> 
> 标签：c#, xaml, svg

2 年前，一家设计公司在 WPF 中进行了应用程序设计，现在我们正在考虑更改其中一个图像上的文本。没有提供 SVG 文件，只使用了 XAML 代码，并且在设计公司从事该项目的开发人员不再在那里工作。我知道他在设计中使用了 Expression Blend。

任何**有关将这样的 XAML 转换为 SVG 的可能方法的**帮助都会有所帮助，甚至可以提供有关**用于生成此 XAML 的工具的建议。**我看到[了有关将 XAML 转换为 SVG 的主题，](https://stackoverflow.com/questions/52764/xaml-to-svg)但看起来这些工具只对最初在其工具中转换的 SVG 进行了转换。

资源字典包含用于通过应用程序显示图像的所有 DrawingImage 对象。这是我们正在编辑的图像之一：

```
<DrawingImage x:Key="MotorControlBackground">
<DrawingImage.Drawing>
  <DrawingGroup>
    <DrawingGroup.Children>
      <GeometryDrawing Brush="#FF466280" Geometry="F1 M -1138.47,3547.06C -1128.45,3557.08 -1112.14,3557.17 -1102.23,3547.25L -1024.29,3469.32L -1118.83,3374.78L -1214.79,3470.74L -1138.47,3547.06 Z ">
        <GeometryDrawing.Pen>
          <Pen Thickness="2.5" MiterLimit="2.75" Brush="#FF212121"/>
        </GeometryDrawing.Pen>
      </GeometryDrawing>
      <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M -1131.22,3533.84L -1138.68,3533.84L -1138.68,3532.34L -1135.91,3532.34L -1135.91,3521.89L -1138.68,3521.89L -1138.68,3520.4C -1137.64,3520.4 -1136.87,3520.25 -1136.38,3519.95C -1135.88,3519.65 -1135.6,3519.09 -1135.54,3518.26L -1133.99,3518.26L -1133.99,3532.34L -1131.22,3532.34L -1131.22,3533.84 Z "/>
      <!-- ... Heavily shortened. Expect around 100 more lines here ... -->
      <GeometryDrawing Geometry="F1 M -1175.94,3268.96L -1057.64,3475.82">
        <GeometryDrawing.Pen>
          <Pen Thickness="1.33333" MiterLimit="2.75" Brush="#88C7C7C7"/>
        </GeometryDrawing.Pen>
      </GeometryDrawing>
      <GeometryDrawing Geometry="F1 M -1086.99,3255.92L -1147.5,3485.59">
        <GeometryDrawing.Pen>
          <Pen Thickness="1.33333" MiterLimit="2.75" Brush="#88C7C7C7"/>
        </GeometryDrawing.Pen>
      </GeometryDrawing>
      <GeometryDrawing Brush="#FF0C407C" Geometry="F1 M -1025.41,3324.46C -1035.45,3304.48 -1051.7,3288.14 -1071.58,3278.06C -1085.54,3270.98 -1101.28,3266.99 -1117.91,3266.99C -1131.79,3266.99 -1145.06,3269.78 -1157.2,3274.82C -1182.66,3285.41 -1203.09,3305.94 -1213.63,3331.52C -1218.64,3343.71 -1221.42,3357.05 -1221.42,3371C -1221.42,3385.48 -1218.44,3399.29 -1213.06,3411.83C -1202.56,3436.34 -1182.94,3456.06 -1158.55,3466.61C -1146.05,3472.01 -1132.31,3475.02 -1117.91,3475.02C -1103.67,3475.02 -1090.09,3472.09 -1077.72,3466.81C -1052.97,3456.24 -1033.07,3436.25 -1022.56,3411.38C -1017.3,3398.95 -1014.39,3385.3 -1014.39,3371C -1014.39,3354.3 -1018.37,3338.48 -1025.41,3324.46 Z "/>
      <!-- ... shortened some more ... -->
      <GeometryDrawing Geometry="F1 M -1021.98,3324.73C -1021.98,3355.74 -1069.88,3368.43 -1117.29,3372.09C -1117.75,3372.13 -1120.57,3372.05 -1120.57,3372.05C -1167.81,3368.32 -1215.32,3355.62 -1215.32,3324.73C -1215.32,3286.57 -1170.4,3255.35 -1115.48,3255.35L -1121.82,3255.35C -1066.92,3255.35 -1021.98,3286.57 -1021.98,3324.73 Z ">
        <GeometryDrawing.Brush>
          <LinearGradientBrush StartPoint="0.548505,0.143509" EndPoint="0.548505,0.805904">
            <LinearGradientBrush.GradientStops>
              <GradientStop Color="#7FFFFFFF" Offset="0"/>
              <GradientStop Color="#00FFFFFF" Offset="1"/>
            </LinearGradientBrush.GradientStops>
          </LinearGradientBrush>
        </GeometryDrawing.Brush>
      </GeometryDrawing>
    </DrawingGroup.Children>
  </DrawingGroup>
</DrawingImage.Drawing>
</DrawingImage> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T20:22:18.397

Inkscape（SVG 编辑器）对 XAML 的支持有限。

上次我尝试它时，XAML 支持并不完美，但那可能是 6 个月前的事了。从那时起它可能已经有所改善。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-23T18:00:13.477

通过[http://www.codeproject.com/Articles/422523/Convert-XAML-Vector-Graphic-to-PNG](http://www.codeproject.com/Articles/422523/Convert-XAML-Vector-Graphic-to-PNG)然后将 PNG 转换为 SVG 将 XAML 转换为 PNG 可能是一种解决方案。在转换方面，PNG 和 SVG 之间有更多选择。我已经使用这种方法将我的 XAML 绘图转换为 EMF。

# python - 在 Mac 上使用 Python 获取文件创建时间

> ID：946967
> 
> 赞同：10
> 
> 时间：2009-06-03T20:16:51.777
> 
> 标签：python, macos

Mac 上的 Python os.path.getctime（通常在 Unix 下）没有给出文件创建的日期，而是“最后一次更改的时间”（至少根据文档）。另一方面，在 Finder 中，我可以看到真实的文件创建时间，因此这些信息由 HFS+ 保存。

您对如何在 Python 程序中获取 Mac 上的文件创建时间有什么建议吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T21:02:52.463

[**`st_birthtime`**](https://docs.python.org/3/library/os.html#os.stat_result.st_birthtime)在调用[`os.stat()`](https://docs.python.org/3/library/os.html#os.stat)（或`fstat`/ `lstat`）的结果上使用该属性。

```
def get_creation_time(path):
    return os.stat(path).st_birthtime 
```

您可以使用 将整数结果转换为日期时间对象[`datetime.datetime.fromtimestamp()`](https://docs.python.org/3/library/datetime.html#datetime.datetime.fromtimestamp)。

[出于某种原因，当第一次编写这个答案时，我认为这在 Mac OS X 上不起作用，但我可能弄错了，现在它确实有效，即使是旧版本的 Python 也是如此。旧的答案在下面供后代使用。]

* * *

`ctypes`用于访问系统调用`stat64`（适用于 Python 2.5+）：

```
from ctypes import *

class struct_timespec(Structure):
    _fields_ = [('tv_sec', c_long), ('tv_nsec', c_long)]

class struct_stat64(Structure):
    _fields_ = [
        ('st_dev', c_int32),
        ('st_mode', c_uint16),
        ('st_nlink', c_uint16),
        ('st_ino', c_uint64),
        ('st_uid', c_uint32),
        ('st_gid', c_uint32), 
        ('st_rdev', c_int32),
        ('st_atimespec', struct_timespec),
        ('st_mtimespec', struct_timespec),
        ('st_ctimespec', struct_timespec),
        ('st_birthtimespec', struct_timespec),
        ('dont_care', c_uint64 * 8)
    ]

libc = CDLL('libc.dylib') # or /usr/lib/libc.dylib
stat64 = libc.stat64
stat64.argtypes = [c_char_p, POINTER(struct_stat64)]

def get_creation_time(path):
    buf = struct_stat64()
    rv = stat64(path, pointer(buf))
    if rv != 0:
        raise OSError("Couldn't stat file %r" % path)
    return buf.st_birthtimespec.tv_sec 
```

用于`subprocess`调用`stat`实用程序：

```
import subprocess

def get_creation_time(path):
    p = subprocess.Popen(['stat', '-f%B', path],
        stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    if p.wait():
        raise OSError(p.stderr.read().rstrip())
    else:
        return int(p.stdout.read()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T20:20:03.453

ctime 在平台上有所不同：*在某些系统（如 Unix）上，是最后一次元数据更改的时间，而在其他系统（如 Windows）上，是创建时间*。那是因为 Unices 通常不保留“原始”创建时间。

也就是说，您可以访问操作系统通过[stat](http://docs.python.org/library/stat.html)模块提供的所有信息。

> stat 模块定义了用于解释 os.stat()、os.fstat() 和 os.lstat()（如果存在）结果的常量和函数。有关 stat、fstat 和 lstat 调用的完整详细信息，请参阅系统文档。
> 
> stat.ST_CTIME
> 操作系统报告的“ctime”。在某些系统（如 Unix）上是最后一次元数据更改的时间，而在其他系统（如 Windows）上是创建时间（有关详细信息，请参阅平台文档）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-18T20:16:40.383

由于缺乏良好的实用程序，我创建了[crtime](https://github.com/kootenpv/crtime)。

```
pip install crtime 
```

然后你可以像这样使用它：

```
sudo crtime ./ 
```

将打印：

```
1552938281  /home/pascal/crtime/.gitignore
1552938281  /home/pascal/crtime/README.md
1552938281  /home/pascal/crtime/crtime
1552938281  /home/pascal/crtime/deploy.py
1552938281  /home/pascal/crtime/setup.cfg
1552938281  /home/pascal/crtime/setup.py
1552938961  /home/pascal/crtime/crtime.egg-info
1552939447  /home/pascal/crtime/.git
1552939540  /home/pascal/crtime/build
1552939540  /home/pascal/crtime/dist 
```

请注意，对于大型目录，它会比`xstat`有时提到的快 1000 倍，因为这会创建一个临时文件，然后`stat`一次执行对所有文件的调用。

# f# - 如何返回多个值并将它们分配给可变变量？

> ID：946977
> 
> 赞同：11
> 
> 时间：2009-06-03T20:18:34.923
> 
> 标签：f#, mutable

这就是我到目前为止所拥有的。

```
let Swap (left : int , right : int ) = (right, left)

let mutable x = 5
let mutable y = 10

let (newX, newY) = Swap(x, y) //<--this works

//none of these seem to work
//x, y <- Swap(x, y)
//(x, y) <- Swap(x, y)
//(x, y) <- Swap(x, y)
//do (x, y) = Swap(x, y)
//let (x, y) = Swap(x, y)
//do (x, y) <- Swap(x, y)
//let (x, y) <- Swap(x, y) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T20:36:36.540

你不能；没有语法可以通过单个赋值更新“多个可变变量”。你当然可以

```
let newX, newY = Swap(x,y)
x <- newX
y <- newY 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T20:41:41.430

您评论的代码不起作用，因为当您编写“x，y”时，您会创建一个新的元组，它是一个不可变的值，因此无法更新。您可以创建一个可变元组，然后根据需要用交换函数的结果覆盖它：

```
let mutable toto = 5, 10 

let swap (x, y) = y, x

toto  <- swap toto 
```

我的建议是研究 F# 的不可变方面，看看你可以使用不可变结构来实现你以前使用可变值所做的事情。

抢

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-04-04T04:19:16.580

F# 与 C# 一样具有“引用”参数，因此您可以类似地编写经典的交换函数：

```
let swap (x: byref<'a>) (y: byref<'a>) =
    let temp = x
    x <- y
    y <- temp

let mutable x,y = 1,2
swap &x &y 
```

# javascript - 对于 javascript，是否有任何等效于 dbug（vars 的 *really* 漂亮打印）？

> ID：946984
> 
> 赞同：9
> 
> 时间：2009-06-03T20:19:40.523
> 
> 标签：javascript, debugging

我知道firebug中有console.log，这个东西叫做[dbug](http://www.clientcide.com/wiki/cnet-libraries/01-core/00-dbug#dbugscripts)（但根本不是我想要的）。我正在寻找的东西会给我一个漂亮的打印嵌套视图到一个看起来像 javascript 的对象：

[![调试输出](https://i.stack.imgur.com/5QxQs.png)](https://i.stack.imgur.com/5QxQs.png)
[（来源：[ospinto.com](http://dbug.ospinto.com/img/screenshots.png)）]

[我也知道这个问题](https://stackoverflow.com/questions/130404/javascript-data-formatting-pretty-printer)，并且正在寻找更多表格的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:21:53.097

一次尝试：

查看演示：http: [//jsbin.com/oxeki](http://jsbin.com/oxeki)

编码：

```
var prettyPrint = (function(){

    var htmlObj = function(obj){
            if (Object.prototype.toString.call(obj) === '[object RegExp]') {
                return obj.toSource ? obj.toSource() : '/' + obj.source + '/';
            }
            if (typeof obj === 'object') {
                return prettyPrint(obj);
            }
            if (typeof obj === 'function') {
                return document.createTextNode('function(){...}');
            }
            return obj.toString();
        },
        row = function(cells, type){
            type = type || 'td';
            var r = document.createElement('tr');
            for (var i = 0, l = cells.length; i < l; i++) {
                var td = document.createElement(type);
                td.appendChild(typeof cells[i] === 'string' ? document.createTextNode(cells[i]) : cells[i]);
                r.appendChild(td);
            }
            return r;
        },
        heading = function() {
            var thead = document.createElement('thead');
            thead.appendChild(row(['Name','Value'], 'th'));
            return thead;
        };

    return function(obj) {

        var tbl = document.createElement('table'),
            tbody = document.createElement('tbody');

        for (var i in obj) {
            var objCellContent = obj[i] === obj ? document.createTextNode('CIRCULAR REFERENCE') : htmlObj(obj[i]);
            tbody.appendChild( row([document.createTextNode(i), objCellContent]) );
        }

        tbl.appendChild(heading());
        tbl.appendChild(tbody);
        return tbl;

    };

})(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-06T16:05:43.570

I just saw [this](http://james.padolsey.com/javascript/prettyprint-for-javascript/) today, maybe this is what you're looking for?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:41:42.350

我还没有遇到过这样的调试器，尽管这种特殊的风格似乎不太难自己编写。只需一个基本的递归函数传入当前对象和一个表格单元格即可开始编写，然后随心所欲地构建。

至于上面的循环引用注释，可以通过保留一个您已经处理过的对象数组来轻松地规避这一点。在处理一个对象之前，检查它是否已经在列表中。如果是这样，请在输出的值字段中将其表示为“循环引用”......但是您想在层次结构中表示对象。

```
prettyprint(object, processedObjects)
{
    if (processedObjects.contains(object))
        return 'circular refernece';

    processedObjects.push(object);

    create newTable;

    for (var in object)
    {
        row = newTable.addRow();
        row.cell1.value = var;
        if (typeof object[var] is object)
            row.cell2.value = prettyprint(object[var], processedObjects);
        else if (typeof object[var] is function)
            row.cell2.value = '[function]';
        else
            row.cell2.value = object[var].toString();
    }

    return newTable;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T02:16:45.433

我想你正在寻找的是这个，[http://www.netgrow.com.au/files/javascript_dump.cfm](http://www.netgrow.com.au/files/javascript_dump.cfm)它是coldfusion的转储标签的javascript等价物

# asp.net-mvc - ASP.NET MVC 中是否存在视图？

> ID：946990
> 
> 赞同：96
> 
> 时间：2009-06-03T20:21:11.097
> 
> 标签：asp.net-mvc

是否可以在渲染视图之前确定控制器中是否存在特定的视图名称？

我需要动态确定要呈现的视图的名称。如果存在具有该名称的视图，那么我需要呈现该视图。如果自定义名称没有视图，那么我需要呈现默认视图。

我想在我的控制器中执行类似于以下代码的操作：

```
public ActionResult Index()
{
    var name = SomeMethodToGetViewName();

    // The 'ViewExists' method is what I've been unable to find.
    if (ViewExists(name))
    {
        retun View(name);
    }
    else
    {
        return View();
    }
} 
```

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-06-03T20:37:13.200

```
 private bool ViewExists(string name)
 {
     ViewEngineResult result = ViewEngines.Engines.FindView(ControllerContext, name, null);
     return (result.View != null);
 } 
```

对于那些寻找复制/粘贴扩展方法的人：

```
public static class ControllerExtensions
{
    public static bool ViewExists(this Controller controller, string name)
    {
        ViewEngineResult result = ViewEngines.Engines.FindView(controller.ControllerContext, name, null);
        return (result.View != null);
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-03T20:34:34.360

假设您只使用一个视图引擎，那么尝试类似下面的内容怎么样：

```
bool viewExists = ViewEngines.Engines[0].FindView(ControllerContext, "ViewName", "MasterName", false) != null; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-05-08T23:35:32.280

这是另一种[不一定推荐]的方法

```
 try
 {
     @Html.Partial("Category/SearchPanel/" + Model.CategoryKey)
 }
 catch (InvalidOperationException) { } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T22:24:04.750

如果您想在多个控制器操作中重复使用它，基于 Dave 给出的解决方案，您可以定义自定义视图结果，如下所示：

```
public class CustomViewResult : ViewResult
{
    protected override ViewEngineResult FindView(ControllerContext context)
    {
        string name = SomeMethodToGetViewName();

        ViewEngineResult result = ViewEngines.Engines.FindView(context, name, null);

        if (result.View != null)
        {
            return result;
        }

        return base.FindView(context);
    }

    ...
} 
```

然后在您的操作中简单地返回您的自定义视图的一个实例：

```
public ActionResult Index()
{ 
    return new CustomViewResult();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-10-25T07:40:34.183

在 asp.net core 2.x 中，该`ViewEngines`属性不再存在，因此我们必须使用该`ICompositeViewEngine`服务。这是使用依赖注入的已接受答案的变体：

```
public class DemoController : Controller
{
    private readonly IViewEngine _viewEngine;

    public DemoController(ICompositeViewEngine viewEngine)
    {
        _viewEngine = viewEngine;
    }

    private bool ViewExists(string name)
    {
        ViewEngineResult viewEngineResult = _viewEngine.FindView(ControllerContext, name, true);
        return viewEngineResult?.View != null;
    }

    public ActionResult Index() ...
} 
```

对于好奇的：基本接口`IViewEngine`没有注册为服务，所以我们必须注入`ICompositeViewEngine`。然而，该`FindView()`方法由提供，`IViewEngine`因此成员变量可以使用基本接口。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-16T08:20:05.727

```
ViewEngines.Engines.FindView(ViewContext.Controller.ControllerContext, "View Name").View != null 
```

我的 2 美分。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-25T12:05:26.357

这是在 Razor for Core 2.2 等中的操作方法。请注意，调用是“GetView”，而不是“Find View”

```
@using Microsoft.AspNetCore.Mvc.ViewEngines
@inject ICompositeViewEngine Engine
...
@if (Engine.GetView(scriptName, scriptName, isMainPage: false).Success) 
{
    @await Html.PartialAsync(scriptName)
} 
```

# formatting - Intellij 重新格式化文件保存

> ID：946993
> 
> 赞同：413
> 
> 时间：2009-06-03T20:22:01.080
> 
> 标签：formatting, intellij-idea

我记得在 IntelliJ 或 Eclipse 中看到了在保存文件时重新格式化（清理）文件的设置。我如何找到它（在设置中没有找到它）

* * *

## 回答 #1

> 赞同：464
> 
> 时间：2011-04-07T13:36:53.840

这个解决方案对我来说效果更好：

1.  制作一个宏（我使用了 Organize Imports、Format Code、Save All）
2.  给它分配一个按键（我覆盖了`Ctrl`+ `S`）

注意：对于有组织的导入，您必须在第一次选中“不再显示此消息”框，但之后它会按预期工作。

# IntelliJ 10.0 的分步说明：

1.  Code -> “Optimize Imports...”，如果出现对话框，勾选“Do not show this message again.”复选框，然后点击“Run”。
2.  工具->“开始宏录制”
3.  代码->“优化导入...”
4.  代码->“重新格式化代码...”
5.  文件->“全部保存”
6.  工具->“停止宏录制”
7.  命名宏（类似于“格式化保存”）
8.  在文件->设置->键盘映射中，选择位于“主菜单->工具->“格式化保存”的宏
9.  单击“添加键盘快捷键”，然后执行所需的击键。如果您像我一样选择`Ctrl`+ `S`，它会询问您如何处理之前的`Ctrl`+`S`快捷方式。去掉它。如果需要，您可以随时重新分配它。
10.  享受！

# 对于 IntelliJ 11，替换

步骤 2\. 使用：编辑 -> 宏 -> “开始宏录制”
步骤 6\. 使用：编辑 -> 宏 -> “停止宏录制”

其他一切都保持不变。

# 智能 12

8\. Preferences 包含 Keymap 设置。使用输入字段过滤内容，如屏幕截图所示。

![Intellij /首选项/键盘映射/宏](https://i.stack.imgur.com/VCNah.png)

* * *

## 回答 #2

> 赞同：325
> 
> 时间：2015-02-26T17:10:19.687

我建议[保存操作插件](https://plugins.jetbrains.com/plugin/7642?pr=idea_ce)。它还支持优化导入和重新排列代码。

[与eclipse 格式化程序插件](https://plugins.jetbrains.com/plugin/6546?pr=idea_ce)结合使用效果很好。

搜索并激活插件：

[![在此处输入图像描述](https://i.stack.imgur.com/OxcsB.png)](https://i.stack.imgur.com/OxcsB.png)

配置它：

[![在此处输入图像描述](https://i.stack.imgur.com/Hbcx8.png)](https://i.stack.imgur.com/Hbcx8.png)

**编辑：**似乎最新版本的 Intellij 保存操作插件是由自动 Intellij 保存触发的。当它仍然在编辑时，这可能会很烦人。

该插件的这个 github issue 提示了一些可能的解决方案：

[https://github.com/dubreuia/intellij-plugin-save-actions/issues/63](https://github.com/dubreuia/intellij-plugin-save-actions/issues/63)

我实际上尝试将重新格式化分配给`Ctrl`+`S`并且它工作正常 - 现在自动完成保存。

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2014-07-20T17:11:03.340

以下是尼尔更新的答案。

# IntelliJ 13 步骤：

1.  代码 -> 重新格式化代码 ![在此处输入图像描述](https://i.stack.imgur.com/0PrCV.png)
2.  编辑 -> 宏 -> 开始宏录制
3.  代码 -> 重新格式化代码
4.  文件 -> 全部保存
5.  编辑 -> 宏 -> 停止宏录制
6.  命名宏（类似于“格式化保存”）
7.  文件 -> 设置 -> 键盘映射
8.  右键单击宏。添加键盘快捷键。将键盘快捷键设置为 Control + S。 ![在此处输入图像描述](https://i.stack.imgur.com/ofu39.png)
9.  IntelliJ 将通知您热键冲突。选择“删除”以删除其他分配。

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2009-06-16T00:12:29.830

我将其设置为在办理登机手续时自动清理，这通常对我来说已经足够了。如果有些东西太难看，我会点击快捷方式（`Ctrl`- `Alt`- `L`, `Return`）。而且我看到他们可以选择自动格式化粘贴的代码，尽管我从未使用过。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2018-11-19T08:39:27.297

如果您有 InteliJ Idea Community 2018.2 及更高版本，步骤如下：

1.  在顶部菜单中单击：编辑 > 宏 > 开始宏录制（您会在屏幕右下角看到一个窗口，确认正在录制宏）
2.  在顶部菜单中单击：代码 > 重新格式化代码（您将在右下角看到被选中的选项）
3.  在顶部菜单中单击：代码 > 优化导入（您将在右下角看到被选中的选项）
4.  在顶部菜单中单击：文件 > 全部保存
5.  在顶部菜单中单击：编辑 > 宏 > 停止宏录制
6.  您将宏命名为：“格式化代码，组织导入，保存”
7.  在顶部菜单中计时：文件 > 设置。在设置窗口中，您单击键盘映射
8.  在右侧的搜索框中搜索“保存”。您将找到全部保存 (Ctrl+S)。右键单击它并选择“删除Ctrl+S”
9.  从框中删除搜索文本，按“全部折叠”按钮（左上角的第二个按钮）
10.  转到宏，按箭头以展开宏，找到您保存的宏并右键单击它。选择添加键盘快捷键，然后按 Ctrl+S 即可。

重新启动您的 IDE 并尝试一下。

我知道你要说什么，我之前的人也写过同样的东西。但是我对这篇文章上面的步骤感到困惑，我想为拥有最新版本 IDE 的人写一个愚蠢的版本。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2009-06-17T02:16:25.750

`Ctrl`++是格式文件（包括以下两个`Alt`）`L`

`Ctrl`++`Alt`是`O`优化导入

`Ctrl`++将修复特定行的`Alt`缩进`I`

我通常在提交工作之前运行`Ctrl`++`Alt`几次。`L`我宁愿它按照我的命令进行清理/重新格式化，而不是自动进行。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2018-05-01T23:50:14.953

如果您在 Flutter 中进行开发，那么自 2018 年 5 月 1 日起，有一个新的实验选项允许您在保存时格式化代码。[![设置](https://i.stack.imgur.com/HjuGD.png)](https://i.stack.imgur.com/HjuGD.png)

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-06-14T03:10:29.883

`Reformat code...`我最终将操作重新绑定到`Ctrl`- `S`，替换了`Save All`.

一开始可能听起来很疯狂，但 IntelliJ 似乎节省了几乎所有操作：运行测试、构建项目，甚至在关闭编辑器选项卡时也是如此。我有打的习惯`Ctrl`——`S`经常打，所以这对我来说确实很有效。它肯定比用于重新格式化的默认绑定更容易键入。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2021-08-03T02:43:59.253

麾！在[IDEA 2021.2](https://www.jetbrains.com/help/idea/reformat-and-rearrange-code.html#reformat-on-save)中终于有了“File->Settings->Tools->Actions on Save”，可以选择“Reformat code”、“Optimize imports”、“Rearrange code”、“Run code cleanup”、“Run eslint --修复”等

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-04-24T15:35:51.843

> IntellIJ 14 && 15：当您在提交更改对话框中签入代码时，勾选重新格式化代码复选框，然后 IntelliJ 将重新格式化您签入的所有代码。

[![](https://i.stack.imgur.com/f1nSf.png)](https://i.stack.imgur.com/f1nSf.png)

^(资料来源：[www.udemy.com/intellij-idea-secrets-double-your-coding-speed-in-2-hours](https://www.udemy.com/intellij-idea-secrets-double-your-coding-speed-in-2-hours/?couponCode=STACKOVERFLOW))

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2021-03-05T13:23:44.963

对于 PyCharm/IntelliJ IDEA：

1.  安装黑色。

`$ pip install black`

2.  找到您的黑色安装文件夹。

在 macOS / Linux / BSD 上：

```
$ which black
/usr/local/bin/black  # possible location 
```

在 Windows 上：

```
$ where black
%LocalAppData%\Programs\Python\Python36-32\Scripts\black.exe  # possible location 
```

请注意，如果您使用的是 PyCharm 检测到的虚拟环境，则无需执行此步骤。在这种情况下，黑色的路径是`$PyInterpreterDirectory$/black`。

3.  在 PyCharm/IntelliJ IDEA 中打开外部工具

在 macOS 上：PyCharm -> 首选项 -> 工具 -> 外部工具

在 Windows / Linux / BSD 上：文件 -> 设置 -> 工具 -> 外部工具

4.  单击 + 图标以添加具有以下值的新外部工具：

```
Name: Black
Description: Black is the uncompromising Python code formatter.
Program: <install_location_from_step_2>
Arguments: "$FilePath$" 
```

5.  通过选择工具 -> 外部工具 -> 黑色来格式化当前打开的文件。

或者，您可以通过导航到首选项或设置 -> 键盘映射 -> 外部工具 -> 外部工具 - 黑色来设置键盘快捷键。

6.  **（可选）在每个文件保存时运行 Black：**

确保您已安装 File Watchers 插件。

转到首选项或设置 -> 工具 -> 文件观察器，然后单击 + 添加新观察器：

```
Name: Black
File type: Python
Scope: Project Files
Program: <install_location_from_step_2>
Arguments: $FilePath$
Output paths to refresh: $FilePath$
Working directory: $ProjectFileDir$ 
```

在高级选项中取消选中“自动保存编辑的文件以触发观察者”

为了用 Black 格式化 Python 文件，我遵循了这个指南，它也使用了 File Watcher： [https ://black.readthedocs.io/en/stable/editor_integration.html](https://black.readthedocs.io/en/stable/editor_integration.html)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-03T20:59:35.653

我以为 IntelliJ 中有类似的东西，但我找不到。保存时发生的唯一清理是删除行尾的空白。我以为我必须在某一时刻指定该行为，但此时我没有看到任何相关的内容。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-10-04T08:29:31.137

如果是关于 Prettier，只需使用 File Watcher ：

参考 => 工具 => 文件观察器 => 单击 + 添加新观察器 => 更漂亮

[https://prettier.io/docs/en/webstorm.html#running-prettier-on-save-using-file-watcher](https://prettier.io/docs/en/webstorm.html#running-prettier-on-save-using-file-watcher)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-06-16T08:39:04.330

从版本 2020.1 开始，您可以直接在**Prettier**插件的 Preferences 中激活*Run on save for files*：

 **[![Prettier 插件的首选项](https://i.stack.imgur.com/Hhx58.png)](https://i.stack.imgur.com/Hhx58.png)

# c# - 将关系数据库存储为 XML

> ID：946996
> 
> 赞同：1
> 
> 时间：2009-06-03T20:22:23.823
> 
> 标签：c#, .net, xml, wcf, entity-framework

我必须将关系数据（文本、数字和图片）存储到 XML 文件中。我想维护数据和表结构之间的关系。

我该怎么做呢？

我的 Windows Mobile 应用程序使用 Windows Communication Foundation (WCF) 来获取数据。一旦获得数据，它就会将它们存储到 XML 文件中。

WCF 使用 ADO.NET Entity Framework 来检索数据。

我将使用 SQL Server 2008。

数据将用于在应用程序上显示它。我不想使用 SQL Server CE 来存储数据，因为它比较慢。也许，我可以使用纯文本文件来存储文本和数字，以及使用图像文件来存储图像，而不是使用 XML 文件。

简而言之，XML 将成为一种存储数据的方式，而不是使用 SQL Server CE 或 WCF。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T23:37:35.537

将您的 XML 格式定义为 XSD。如果您使用 Visual Studio，请使用添加新数据集，“自定义工具”将自动创建基于数据集的强类型类集。您可以使用约束定义表和关系。在 Visual Studio 中很容易做到。如果您不喜欢 Visual Studio，则可以手动创建 XSD 并使用 xsd.exe 生成代码。

一旦您拥有填充了数据的强类型 DataSet，您就可以通过调用 WriteXml 将其序列化为 XML 流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:22:51.663

虽然需要什么有点模棱两可，但您可以尝试查看 SQL Server 下的“FOR XML EXPLICIT”。这将包括关系。链接：[http ://www.eggheadcafe.com/articles/20030804.asp](http://www.eggheadcafe.com/articles/20030804.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:40:58.803

数据集呢？定义表和关系，将数据加载到数据集中，并将其保存为 XML（WriteXml 方法）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T14:13:41.420

感谢您提供更多详细信息。

我的建议是首先尝试 SQL Server CE。对于您正在做的事情，它实际上可能不会变慢。在不重新发明轮子上节省的时间可能最好花在加速应用程序的其他部分上。

对于其余部分，假设您不需要长时间存储数据，也不需要做太多事情，我建议将数据从 Web 服务返回类型复制到 DataSet 中。DataSet 类型有一个可以保存数据的 WriteXml 方法和一个可以读回数据的 ReadXml 方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T22:18:08.363

“维护数据和表结构之间的关系”是什么意思？您所说的不仅仅是在 XML 节点的属性中维护源数据库记录的 ID 吗？拥有 XML 数据后，您需要对其进行什么处理？它会被编辑并必须重新应用于数据库吗？

问题多于我的答案....对不起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T20:27:09.960

您使用的是什么 SQL Server？某些服务器允许您为查询请求 XML 响应。这可以为您节省大量工作。

编辑：由于您已指定将使用 MSSQL 2008，您可能很幸运。在 MSSQL 2005 及更高版本中，有一个“FOR XML”关键字允许您以 XML 格式获取结果。试试看。

# regex - 正则表达式匹配任意代码集

> ID：946998
> 
> 赞同：-1
> 
> 时间：2009-06-03T20:22:50.873
> 
> 标签：regex

我正在寻找一些帮助来创建一个可以在我们系统中使用唯一输入的正则表达式。我们在按键事件中已经有了一些逻辑，只允许数字，并且允许字母 A 和字母 M。现在我需要想出一个可以匹配`onblur`事件期间输入的 RegEx，以确保格式正确。

我在下面有一些有效的例子。字母 A 代表一个年龄，所以它后面总是最多 3 位数字。字母 M 只能出现在字符串的末尾。

## 有效输入

1-M
10-M
100-M
5-7
5-20
5-100
10-20
10-100
A5-7
A10-7
A100-7
A10-20
A5-A7
A10-A20
A10-A100
A100-A102

## 输入无效

一个a45
4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T21:21:25.797

如果您有少量定义明确的模式，请使用蛮力方法，这样您就不会得到糟糕的极端情况匹配：

```
^(\d+-M|\d+-\d+|A\d+-\d+|A\d+-A\d+)$ 
```

以下是单独的正则表达式：

```
\d+-M      <- matches anything like '1-M'
\d+-\d+    <- 5-7
A\d+-\d+   <- A5-7
A\d+-A\d+  <- A10-A20 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T20:52:34.637

这匹配所有样本。

```
/A?\d{1,3}-A?\d{0,3}M?/ 
```

不确定 10-A10M 是否应该或不应该是合法的，或者即使 M 可以与数字一起出现。如果它 M 只是没有数字：

```
/A?\d{1,3}-(A?\d{1,3}|M)/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:28:36.650

```
/^[A]?[0-9]{1,3}-[A]?[0-9]{1,3}[M]?$/ 
```

匹配任何形式：

```
A(optional)[1-3 numbers]-A(optional)[1-3 numbers]M(optional) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:28:36.557

```
^A?\d+-(?:A?\d+|M)$ 
```

一个可选的 A 后跟一个或多个数字、一个破折号，以及另一个可选的 A 和一些数字或一个 M。' `(?: ... )`' 表示法是 Perl 的一组“非捕获”括号围绕替代方案；`$1`这意味着正则表达式匹配后将没有' '。显然，如果您想捕获各种点点滴滴，您可以 - 并且将会 - 这样做，并且 non-capturing 子句可能不再相关。

（您可以像 JasonV 那样将 ' ' 替换为 ' `+`'`{1,3}`以将数字限制为 3 位数。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T20:29:29.287

```
^A?\d{1,3}-(M|A?\d{1,3})$ 
```

^ -- 匹配必须从
A 开始？-- "A" 是可选的
\d{1,3} -- 1 到 3 位数字；[0-9]{1,3} 也有效
- -- 一个“-”字符
(...|...) -- 两个表达式中的任一个
(M|...) -- 任一个 "M"或...
(...|A?\d{1,3}) -- "A" 后跟至少一位且最多三位数字
$ -- 匹配应进行到最后

改变格式的一些后果。如果您不将“^”放在开头，则匹配可能会忽略无效的开头。例如，“MAAMA0-M”将与“A0-M”匹配。

同样，如果您将 $ 排除在外，则匹配可能会忽略无效的踪迹。例如，“A0-MMMMAAMAM”将匹配“A0-M”。

通常首选使用 \d，如 \w 表示字母数字，\s 表示空格，\D 表示非数字，\W 表示非字母数字或 \S 表示非空格。但是您必须注意 \d 不会被视为转义序列。您可能需要改为 \\d 。

{x,y} 表示最后一次匹配必须发生在 x 和 y 次之间。

? 意味着最后一场比赛必须发生一次或根本不发生。

使用 () 时，将其视为一个匹配项。（美国广播公司）？将匹配 ABC 或根本不匹配。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T20:44:15.793

我会使用这个正则表达式：

```
^(?:[1-9]\d{0,2}-(?:M|[1-9]\d{0,2})|A[1-9]\d{0,2}-A?[1-9]\d{0,2})$ 
```

这匹配：

*   *`<number>`*****`-M`**或者*`<number>`*****`-`****`<number>`******
******   **`A`****`<number>`*****`-`****`<number>`*或者**`A`****`<number>`*****`-A`****`<number>`**************

 ******另外*`<number>`*不得以`0`.

# c# - 使用语句扩展的好奇 C#

> ID：946999
> 
> 赞同：26
> 
> 时间：2009-06-03T20:23:00.033
> 
> 标签：c#, using, finally, expansion, try-catch

我已经运行 ildasm 来发现：

```
 using(Simple simp = new Simple())
    {
        Console.WriteLine("here");
    } 
```

生成与此等效的 IL 代码：

```
 Simple simp = new Simple();
    try
    {
        Console.WriteLine("here");
    }
    finally
    {
        if(simp != null)
        {
            simp.Dispose();
        }
    } 
```

问题是为什么它会在finally中检查null？finally 块只有在 try 块被执行时才会被执行，而 try 块只有在 Simple 构造函数成功（即不抛出异常）时才会被执行，在这种情况下 simp 将是非空的。（如果有人担心在 Simple 构造函数和 try 块的开头之间可能会出现一些干预步骤，那么这确实是一个问题，因为可能会引发异常，从而完全阻止 finally 块的执行。）那么，到底为什么？

抛开（请）使用语句是否比 try-finally 更好的论点，我将 try-finally 块编写为：

```
 Simple simp = new Simple();
    try
    {
        Console.WriteLine("here");
    }
    finally
    {
        simp.Dispose();
        simp = null;        // sanity-check in case I touch simp again
                            // because I don't rely on all classes
                            // necessarily throwing
                            // ObjectDisposedException
    } 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-03T20:25:13.553

不，finally 块总是会被执行。您可能不是从新的对象获取对象，而是从返回对象的其他函数获取对象 - 它可能返回 NULL。using() 是你的朋友！

dss539 非常友好地建议我包括他的注释：

```
using(Simple simp = null) 
```

扩展必须首先检查 null 的另一个原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T20:31:15.833

`using(Simple simp = null)`扩展必须首先检查 null 的**另一个**原因。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T21:04:33.113

[MSDN](http://msdn.microsoft.com/en-us/library/aa664736(VS.71).aspx)关于 using 声明。

我认为奇怪的是它没有扩展到：

```
Simple simp = new Simple();
Simple __compilergeneratedtmpname = simp;
try
{
    Console.WriteLine("here");
}
finally
{
    if(__compilergeneratedtmpname != null)
    {
        __compilergeneratedtmpname.Dispose();
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-23T15:26:01.560

看来您的评论：

“如果有人担心在 Simple 构造函数和 try 块的开头之间可能会出现一些干预步骤，那么这确实是一个问题，因为可能会引发异常，从而完全阻止 finally 块的执行。”

可能已经死了。看：

[原子性和异步异常失败](http://www.bluebytesoftware.com/blog/PermaLink.aspx?guid=c1898a31-a0aa-40af-871c-7847d98f1641)

我还想注意 WCF 的问题并使用：

使用引用[的 Using 语句和 WCF 服务代理避免出现问题：](http://blogs.msdn.com/jjameson/archive/2010/03/18/avoiding-problems-with-the-using-statement-and-wcf-service-proxies.aspx)

[避免使用语句的问题](http://msdn.microsoft.com/en-us/library/aa355056.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-01T17:50:14.333

必须以这种方式翻译代码以避免在处理对象时可能出现*NullReferenceException 。*根据*C# 语言参考*，[using 语句](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/statements#the-using-statement)不仅接受局部变量声明作为其第一个非终结`resource_acquisition`符号，还接受任何**表达式**。考虑以下代码：

```
DisposableType @object = null;
using(@object) {
    // whatever
} 
```

显然，除非块中有空条件，否则`@object?.Dispose()`会`finnaly`发生异常。只有当**表达式**是不可为空的值类型（不可为空的结构）时，空检查才是多余的。事实上，根据上述语言参考，在这种情况下它是不存在的。************`******