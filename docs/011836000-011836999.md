# StackOverflow 问答 11836000-11836999

# django - django 复杂查询过滤器

> ID：11836003
> 
> 赞同：3
> 
> 时间：2012-08-06T21:12:22.053
> 
> 标签：django, django-models

我需要制作一个复杂的过滤器，这意味着在模型属性上应用一个函数。

等效的 SQL 查询是：

```
SELECT * FROM myModel_table t WHERE abs(t.field1 - :binding_value) <= 50 
```

其中 binding_value 是从客户端接收到的数字。

有没有办法使用函数定义字段查找？还是我必须直接使用原始 sql？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:20:48.343

在这种情况下，最好的方法是使用 Django 的 queryset [extra()](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#extra)方法：

```
MyModel.objects.extra(where=['abs(field1 - %s) <= 50'], params=[binding_value]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T00:36:26.777

如果我没有想错（如果我想的话，请让我现在），您可以“翻译”您的查询以使用简单的 django 过滤。

首先，这是真的：

```
abs(A - B) <= 50 
```

等于：

```
-50 <= A - B <= 50 
```

那么，这等于：

```
-50 + B <= A <= 50 + B 
```

然后，您的查询可能是这样的：

```
MyModel.objects.filter(field1__range=(-50+binding_value,50+binding_value)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-18T02:23:20.633

[过滤注释](https://docs.djangoproject.com/es/1.9/topics/db/aggregation/#filtering-on-annotations)：

```
from django.db.models import Func

class Abs(Func):
    function = "abs"

MyModel.objects.annotate(
    expr=Abs("field1") - binding_value
).filter(
    expr__lte=50
) 
```

编辑：另见[https://stackoverflow.com/a/35658634/10840](https://stackoverflow.com/a/35658634/10840)

# entity-framework - 带有 EF DbContext 延迟加载的 MVVM 主/详细视图 - 多个 ViewModel，或全部在一个 VM 中

> ID：11836005
> 
> 赞同：1
> 
> 时间：2012-08-06T21:12:28.357
> 
> 标签：entity-framework, mvvm, dbcontext

我看过一些代码示例，它们基本上为 Master 创建了一个 View-Model，并为 Details 创建了一个 View-Model。然后他们将 Master 连接到带有 DataGrid 的视图，然后将 Master View-Model 的选定项绑定到 ObservableObject（DetailViewModel）类型的 SelectedItem 属性，然后将其发送到 Detail View-Model，即然后绑定到详细视图...如推荐[here](https://stackoverflow.com/questions/2222087/mvvm-multiple-views)。[或类似的](https://stackoverflow.com/questions/1988704/mvvm-with-wpf-binding-multiple-views-to-the-same-viewmodel)东西

读完后... [http://blogs.msdn.com/b/adonet/archive/2011/03/08/ef-feature-ctp5-code-first-model-with-master-detail-wpf-application。 aspx](http://blogs.msdn.com/b/adonet/archive/2011/03/08/ef-feature-ctp5-code-first-model-with-master-detail-wpf-application.aspx)

这..[一个模型实体，多个页面->多个视图？多个视图模型？](https://stackoverflow.com/questions/5073051/one-model-entity-multiple-pages-multiple-views-multiple-viewmodels)

还有这个......[与单个视图关联的多个 ViewModel](https://stackoverflow.com/questions/3259398/multiple-viewmodels-associated-with-a-single-view)

我很困惑:) Prism 这样做的首选方式似乎是为主视图和细节设置一个单独的 ViewModel，但在我的原因中，我觉得这样做会做更多的工作。

在我看来，如果您使用实体框架 DbContext 并且正在使用 .Local 属性进行绑定，那么将一个视图模型用于主/细节情况会更有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T14:53:41.717

直接绑定到 DbContext 或其任何属性将是一个坏主意，因为它会将模型暴露给视图，这违反了 MVVM 背后的想法。（View 知道 ViewModel，ViewModel 知道 Model）。

在主从场景中，您有两个不同的视图模型，每个视图模型有 2 个不同的视图，因为它们各自具有不同的角色。

*   Master 的角色是提供选择列表和导航到其详细信息的方法。
*   另一方面，Detail 的作用是呈现单个元素，可能带有更改值的方法。

假设您有一个产品列表作为数据模型，每个产品都有一个 id、一个名称和一个价格：

```
class Product {
    public int Id { get; set; }
    public string Name { get; set; }
    public int Price { get; set; }
} 
```

此外，您还有某种包含产品列表的数据模型：

```
class ProductRepository {
    private List<Product> products = new List<Product>();
    public List<Product> Products 
    { 
        get { return this.prodcuts; }
    }
} 
```

那么您的 MasterViewModel 的作用是公开`Products`ProductRepository 模型的列表并提供一种切换到详细视图的方法：

```
class ProductsViewModel {
    private ProductRepositry productsModel = new ProductRepository();
    private ObservableCollection<Product> products = new ObservableCollection<Product>(productsModel.Products);

    public ObservableCollection<Product> Products
    {
        get { return this.products; }
    }

    public ProductViewModel Detail { get... private set... } // setter includes PropertyChange

    public ICommand ViewDetail { get... }

    public void ViewDetail(Product detail)
    {
        this.Detail = new ProductViewModel(detail);
    }
} 
```

该`ProductViewModel`的 唯一 责任 是 提出`Product`:

```
class ProductViewModel {
    public string Name { get... set... } // Again a PropertyChange would be necessary for propert binding
    public int Price { get... set... } // dito
} 
```

# php - 从双向数组php中删除重复元素

> ID：11836011
> 
> 赞同：0
> 
> 时间：2012-08-06T21:12:43.567
> 
> 标签：php, arrays, duplicates

我有 2 个数组：1 个包含名称中包含 ID 的文件名，2 个包含一些数据：

```
Array
(
    [0] => Array
        (
            [file] => 103135_cara.jpg
        )

    [1] => Array
        (
            [file] => 103135_corpo.jpg
        )

    [2] => Array
        (
            [file] => 103136_cara.jpg
        )

    [3] => Array
        (
            [file] => 103136_corpo.jpg
        )

Array2
(
    [0] => Array
        (
            [id] => 103137
            [nome] => Eduardo Vieira
            [sexo] => 1
            [datanascimento] => 1983-11-15
            [morada] => R: Gothard Kaesemodel 750 ? Torre 1 - Ap 508
            [localidade] => Joinville
            [cp1] => 
            [cp2] => 
            [tlm] => 479946464
            [email] => eduardo@wetzel.com.br
            [estadocivil] => 1
            [profissao] => 7
        )

    [1] => Array
        (
            [id] => 103138
            [nome] => João Nuno Gonçalves
            [sexo] => 1
            [datanascimento] => 1984-08-13
            [morada] => Rua Elias Garcia Nº325 6D
            [localidade] => Amadora
            [cp1] => 2700
            [cp2] => 323
            [tlm] => 964359799
            [email] => joaoridebmx@yahoo.com
            [estadocivil] => 1
            [profissao] => 7
        ) 
```

我已将数组合并为：

```
Array3
(
    [0] => Array
        (
            [id] => 103137
            [nome] => Eduardo Vieira
            [sexo] => 1
            [datanascimento] => 1983-11-15
            [morada] => R: Gothard Kaesemodel 750 ? Torre 1 - Ap 508
            [localidade] => Joinville
            [cp1] => 
            [cp2] => 
            [tlm] => 479946464
            [email] => eduardo@wetzel.com.br
            [estadocivil] => 1
            [profissao] => 7
            [file1] => 103137_cara.jpg
        )

    [1] => Array
        (
            [id] => 103137
            [nome] => Eduardo Vieira
            [sexo] => 1
            [datanascimento] => 1983-11-15
            [morada] => R: Gothard Kaesemodel 750 ? Torre 1 - Ap 508
            [localidade] => Joinville
            [cp1] => 
            [cp2] => 
            [tlm] => 479946464
            [email] => eduardo@wetzel.com.br
            [estadocivil] => 1
            [profissao] => 7
            [file1] => 103137_cara.jpg
            [file2] => 103137_corpo.jpg
        )

    [2] => Array
        (
            [id] => 103138
            [nome] => João Nuno Gonçalves
            [sexo] => 1
            [datanascimento] => 1984-08-13
            [morada] => Rua Elias Garcia Nº325 6D
            [localidade] => Amadora
            [cp1] => 2700
            [cp2] => 323
            [tlm] => 964359799
            [email] => joaoridebmx@yahoo.com
            [estadocivil] => 1
            [profissao] => 7
            [file1] => 103138_cara.jpg
        )

    [3] => Array
        (
            [id] => 103138
            [nome] => João Nuno Gonçalves
            [sexo] => 1
            [datanascimento] => 1984-08-13
            [morada] => Rua Elias Garcia Nº325 6D
            [localidade] => Amadora
            [cp1] => 2700
            [cp2] => 323
            [tlm] => 964359799
            [email] => joaoridebmx@yahoo.com
            [estadocivil] => 1
            [profissao] => 7
            [file1] => 103138_cara.jpg
            [file2] => 103138_corpo.jpg
        ) 
```

我的问题是：如何删除仅包含键 'file1' 的数组元素，保留同时具有键 'file1' 和 'file2' 的数组元素

这是我用来合并数组的代码：

```
foreach ($ids as $val1) {
  foreach ($files as $key => $val2) {
    $cara = strpos($val2['file'], $val1['id'].'_cara');
    if ($cara !== false) {
      $val1['file1'] = $val2['file'];
      $data[] = $val1;
      unset($files[$key]);
    }
    $corpo = strpos($val2['file'], $val1['id'].'_corpo');
    if ($corpo !== false) {
      $val1['file2'] = $val2['file'];
      $data[] = $val1;
      unset($files[$key]);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:20:21.777

```
foreach ($array as $nr => $values){
  if (isset($values['file1']) && !isset($values['file2']){
        unset($array[$nr]);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:21:18.100

尝试：

```
function filter($element) {
    $result = isset($element['file1'], $element['file2']);

    return $result;
}

$out = array_filter($arr3, 'filter');
var_dump($out); 
```

其中 $arr3 是您的第三个数组

array_filter 也接受方法作为过滤函数：ex

```
array_filter($arr3, array('class_name or class instance', 'method_name')); 
```

//编辑
我使用了关于 isset 的 DaveRandom 建议

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:30:28.877

最简单的方法，可能会运行一个循环并检查密钥“file1”是否存在而密钥“file2”是否存在：

```
foreach ($array as $key => $val) {
    if (isset($val['file1']) && !isset($val['file2'])) {
        unset($array[$key]);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T12:30:29.910

由于您在原始数组中的 ID 似乎是唯一的（因为它们是 ID，而且都是 ID），因此将它们用作键是有意义的。这意味着您可以轻松识别每个文件所属的元素。

使用 ID 作为键重新索引数组很容易：

```
$data = array();
foreach ($ids as $val) {
  $data[$val['id']] = $val;
} 
```

然后为了将文件与适当的项目相关联，您需要做的就是：

```
foreach ($files as $file) {

  // First get the ID of the associated item
  $parts = explode('_', $file);
  $id = $parts[0];

  // Now add this file to the correct item
  // Find the next spare file number for this ID
  for ($i = 1; isset($data[$id]['file'.$i]); $i++) {
    continue;
  }
  // ...and add the file
  $data[$id]['file'.$i] = $file;

} 
```

这将首先避免产生重复的项目。它还避免了嵌套`foreach`- 通常，如果您发现自己这样做，您就做错了。这不是一个硬性规定，但它通常只有在您正在做的是计算多个数据集的可能排列时才有用/正确的方法，而这不是您在这里所做的。

现在，我不得不说我不会做你所做的事情并创建`file1`，`file2`而是创建一个子数组`files`。这将使以后循环文件变得更加容易，并且还将避免检查以查找文件的下一个可用编号。

所以，我会让第二个循环看起来像这样：

```
foreach ($files as $file) {

  // First get the ID of the associated item
  $parts = explode('_', $file);
  $id = $parts[0];

  // Now add this file to the correct item
  if (!isset($data[$id]['files'])) {
    $data[$id]['files'] = array();
  }
  $data[$id]['files'][] = $file;

} 
```

# captcha - 验证码无法阻止垃圾邮件提交

> ID：11836027
> 
> 赞同：5
> 
> 时间：2012-08-06T21:14:16.830
> 
> 标签：captcha, spam, spam-prevention

我已经在评论表单中添加了验证码及其工作，但我仍然不断收到垃圾邮件。我还有其他方法可以使用吗？谢谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:56:38.840

**免责声明：我拥有 SpamCaptcher，但仍会在这里保持公正**

您使用 CAPTCHA 看到的结果在很大程度上取决于 3 个主要因素：

1.  您如何实施验证码
2.  您使用的验证码类型
3.  垃圾邮件发送者通过向您的网站发送垃圾邮件获得的投资回报

**验证码实施**

在我们讨论您使用的 CAPTCHA 类型是否适合您的需求（或者您是否应该使用一种）之前，首先检查它是否正确实施。如果它没有在服务器端进行验证，可以通过关闭 JavaScript 或禁用 Flash（或更改任何其他客户端配置）来绕过它，或者答案存储在客户端，则需要修复实现。当然，无论是谁制作了您使用的 CAPTCHA，都应该制作它，这样您就不必担心这一点。注意：我强烈建议您不要推出自己的验证码解决方案。

**验证码类型**

大多数人认为验证码是他们必须破译的扭曲文本的图片。虽然这肯定是 CAPTCHA 的一种实现（也是目前最“流行的”），但它并不是唯一的一种。虽然这种基于扭曲文本的验证码成功了一段时间，但 OCR 的改进使得垃圾邮件发送者可以使用自动化工具解决这些问题。为了解决这个问题，制作验证码的人让它们更难阅读，现在我们陷入了这样一种境地：计算机在解决这些问题方面做得越来越好，而人类却越来越挣扎。最近，提供一系列不同类型的 CAPTCHA 的 CAPTCHA 提供商蓬勃发展：

*   图像识别
*   图像方向（我个人最喜欢的）
*   游戏
*   视频理解
*   音频理解
*   等等

此外，人们已经摆脱了 CAPTCHA 的严格定义，并提出了一些其他可能对您有用的解决方案，具体取决于您的站点（下一节将详细介绍）。

选择 CAPTCHA 类型时要记住的一些事情是，某些人可能会在某些类型上遇到困难。确保视力障碍者和听力障碍者仍然可以解决 CAPTCHA 是一种很好的做法。同样重要的是要注意，CAPTCHA 仅与其最弱点一样强大。因此，例如，如果验证码的视觉部分坚如磐石，但音频部分很弱，那么安全性就会很弱。事实上，在这种情况下，您只会用 CAPTCHA 来打扰大多数合法用户，同时为垃圾邮件发送者提供一种绕过它的简单方法。

**垃圾邮件投资回报率**

根据您网站的性质，垃圾邮件发送者可能有很大或很小的动机向您发送垃圾邮件。如果激励很小，那么他们很可能不会编写自定义解决方案来向您发送垃圾邮件。但是，如果激励很大，那么他们很有可能会为您的网站编写自定义解决方案。

让我们从小型激励案例开始。如果您属于这一类，那么我建议您选择尚未广泛采用（但仍然安全）并且对您的用户来说非常容易（即使不透明）的 CAPTCHA。蜜罐和 Hashcash 是透明解决方案的示例。在 SpamCaptcher，我们提供了一种称为[Proof-of-Work](https://www.spamcaptcher.com/captcha/proofOfWork.jsp)的解决方案。

另一方面，如果您的网站对垃圾邮件发送者来说投资回报率很高，那么您将需要更高的安全性。在这种情况下，您显然希望选择具有强大安全性且仍能提供良好用户体验的解决方案。但是，如果您网站的投资回报率足够高，那么您可能会遇到人工验证码求解器。仅 CAPTCHA 并不能保护您免受他们的侵害。然而，（另一个无耻的插件），SpamCaptcher 有它的 TrustMe Account 解决方案。

**结论**

您确实需要选择适合您需求的验证码，这意味着您需要在安全性和用户友好性之间找到适当的平衡点。我显然推荐 SpamCaptcher，并认为我们的[Rotational Image CAPTCHA](https://www.spamcaptcher.com/captcha/Demo.action)对您来说是一个很好的解决方案，但您显然需要决定什么最适合您的网站。以下是您可能需要考虑的几个 CAPTCHA 提供商：

*   垃圾邮件捕捉器
*   自信的技术
*   验证码

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:17:57.887

验证码已经被[破解了一段时间](http://www.guardian.co.uk/technology/2008/aug/28/internet.captcha)。

没有完美的解决方案来防止垃圾评论。

您可以要求用户在发表评论之前进行注册。虽然垃圾邮件机器人也可以打破这一点，但对他们来说这是一个更难解决的问题。这种解决方案也阻碍了真人的参与。

您可以在发布之前自动将来自非注册用户的评论标记为需要审核，然后您自己或通过社区进行审核（就像 Stack Overflow 对某些内容（例如编辑）所做的那样）。您可能还想标记尚未建立多少可信度的“新”用户的评论。

您不应*创建*IP 阻止列表。您的大部分垃圾邮件都来自合法用户*也*使用的受感染计算机。如果您阻止一个 IP，另一台僵尸计算机很可能会尝试连接以恢复工作。另一方面，您很可能会阻止僵尸计算机的人类用户使用您的站点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T21:20:07.683

关于（一千个原因之一）您的验证码可能不起作用的原因：一种被注意到的技术是，黑客会让他们的机器人将验证码的屏幕截图发送回基地，然后由最低工资的人来填写。（Erik J 的链接对此进行了详细说明。）

更好的解决方案似乎围绕网站结构而不是实施。

您可以特别查看这个网站 - 诸如限制权限之类的技术，直到用户显示自己是您的小社会的功能部分。本质上，将责任置于特权之上。

[XKCD，当然，说得好](http://xkcd.com/810/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-21T17:18:14.397

我建议在验证码之外添加额外的措施。

就我而言，我尝试添加一个隐藏字段->

```
<form action="/submit.php" method="post">
    <p>Your name: <input type="text" name="name" /></p>
    <p>Your email: <input type="text" name="email" /></p>
    <p class="antispam">Leave this empty: <input type="text" name="url" /></p>
    <p><textarea name="message"></textarea></p>
    <p><input type="submit" value="Send" /></p>
</form>

.antispam { display:none;} 
```

然后在服务器端验证它->

```
<?php 
// if the url field is empty 
if(isset($_POST['url']) && $_POST['url'] == ''){
     // then send the form to your email
} 
// otherwise, let the spammer think that they got their message through
?> 
```

上面的代码示例摘自这篇有用的文章：[http](http://www.nfriedly.com/techblog/2009/11/how-to-build-a-spam-free-contact-forms-without-captchas/) : //www.nfriedly.com/techblog/2009/11/how-to-build-a-spam-free-contact-forms-without-captchas/ 来自 Nathan Friedly

在我的网站中，我正在实施上述方法和 Google 的 reCaptcha-。

到目前为止工作正常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T22:25:25.767

不幸的是，验证码有它的挑战。去年的一项研究发现，验证码在阻止计算机识别方面可能不像以前那样可靠。该研究可在[http://homepages.cs.ncl.ac.uk/jeff.yan/google.pdf](http://homepages.cs.ncl.ac.uk/jeff.yan/google.pdf)获得。

我的公司与客户合作阻止社交垃圾邮件。查看我们关于对抗社交垃圾邮件的开发人员问题解答的博客文章。在我们的帖子中，我们重点介绍了您可以构建（我们也提供）来增强您的网站对垃圾邮件的防御能力的策略。[http://www.impermium.com/blog/2012/02/03/answers-to-developer-questions-on-fighting-social-spam/](http://www.impermium.com/blog/2012/02/03/answers-to-developer-questions-on-fighting-social-spam/)。

# c++ - C++11 原子 x86 内存排序

> ID：11836028
> 
> 赞同：6
> 
> 时间：2012-08-06T21:14:17.020
> 
> 标签：c++, c++11, atomic

在 C++0x 中原子变量的文档之一中，在描述内存顺序时，它提到：

> 发布-获取订购
> 
> 在强排序系统（x86、SPARC、IBM 大型机）上，发布-获取排序是自动的。此同步模式不会发出额外的 CPU 指令，只会影响某些编译器优化...

首先，x86 遵循严格的内存排序是真的吗？总是强加这一点似乎效率很低。意味着每次写入和读取都有围栏？

另外，如果我有一个对齐的 int，在 x86 系统上，原子变量是否有任何用途？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T21:41:10.563

是的，x86 确实有严格的内存排序，请参阅[Intel 手册](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)第 3A 卷第 8.2 章。较旧的 x86 处理器（例如 386）提供了真正严格的排序（称为**强排序**）语义，而更现代的 x86 处理器在少数情况下稍微宽松的条件，但您无需担心。例如，奔腾和 486 允许读取缓存未命中在写入缓存命中时先于缓冲写入（因此与读取的地址不同）。

是的，它可能效率低下。有时，高性能软件仅针对内存排序要求较宽松的其他架构而编写。

是的，原子变量在 x86 上仍然有用。它们与编译器具有特殊的语义，因此典型的[读-修改-写](http://en.wikipedia.org/wiki/Read-modify-write)操作以原子方式发生。如果您有两个线程同时递增一个原子变量（我的意思是`std::atomic<T>`C++11 中的类型变量），您可以确信该值会大 2；如果没有`std::atomic`，您可能会得到错误的值，因为一个线程在执行增量时将当前值缓存在寄存器中，即使在 x86 上存储到内存是原子的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T21:23:00.240

确实，在 x86 上，所有存储都有释放，所有加载都有获取语义。

这不会也不应该影响您编写 C++ 的方式：要编写并发的、无竞争的代码，您必须使用`std::atomic`构造或锁。

架构细节的意思是，在 x86 上，只要您最多要求获取/释放顺序，就会为原子字大小类型的操作生成很少或没有额外代码。（但是，顺序一致性会发出`mfence`指令。）但是，您仍然*必须*使用 C++ 原子类型，并且不能仅仅为了获得正确、格式良好的程序而忽略它们。原子变量的一个重要特性是它们可以防止*编译器*重新编码，这对于程序的正确性至关重要。

（在 C++11 之前，您将不得不使用编译器提供的扩展，例如 GCC 的`__sync_*`函数套件，这将使编译器正常运行。如果您真的想使用裸变量，您至少必须插入编译器为自己设障。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:19:15.937

*有一张很好的表格，列出了可能*发生的不同重新排序操作，并且（例如）x86 很少做这些操作。其他架构（众所周知的 Alpha）几乎可以做任何事情。

由于内存模型是由标准定义的，x86 et al 本质上是兼容的。

您关于原子变量的问题的答案略有不同。对变量的任何修改都涉及竞争条件，因此当多个线程更新同一个变量时，可能会丢失更新。原子变量的定义使得它们是原子操作的正确类型，从而消除了这种竞争条件。所以他们的目的之一不是为了订购。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-01T14:33:52.593

请注意，释放/获取语义不一定意味着在每条指令之后都有一个 mfence。[![在此处输入图像描述](../Images/8c4cce764edfbe4fded33ae25c692aa8.png)](https://i.stack.imgur.com/NvG21.gif)可以在@Adam Rosenfield 引用的手册或快速浏览[Wikipedia](https://en.wikipedia.org/wiki/Memory_ordering#Runtime_memory_ordering)中看到在x86 上的保留。尽管如此，x86 具有用于存储的释放语义和用于加载的获取语义。

来自 Kerrek SB 的回答：

> 架构细节的意思是，在 x86 上，只要您最多要求获取/释放顺序，就会为原子字大小类型的操作生成很少或没有额外代码。（不过，顺序一致性会发出 mfence 指令。）

请注意，顺序一致性是默认设置！（参见例如[cppreference）。](http://en.cppreference.com/w/cpp/atomic/memory_order)

这意味着...

```
#include <atomic>
#include <cassert>
#include <string>

std::atomic<std::string*> ptr;

void producer()
{
    std::string* p  = new std::string("Hello");
    ptr = p;
}

void consumer()
{
    std::string* p2;
    while (!(p2 = ptr))
        ;
    assert(*p2 == "Hello"); // never fails
} 
```

（x86 上的 g++ -std=c++11 -S -O3）

...实际上将导致在`mfence`生产者函数中发出一个，以解释上述 x86 ( [![在此处输入图像描述](../Images/8c4cce764edfbe4fded33ae25c692aa8.png)](https://i.stack.imgur.com/NvG21.gif)) 上的松弛。

而对于...

```
#include <atomic>
#include <cassert>
#include <string>

std::atomic<std::string*> ptr;

void producer()
{
    std::string* p  = new std::string("Hello");
    ptr.store(p, std::memory_order_release);
}

void consumer()
{
    std::string* p2;
    while (!(p2 = ptr.load(std::memory_order_acquire)))
        ;
    assert(*p2 == "Hello"); // never fails
} 
```

（x86 上的 g++ -std=c++11 -S -O3）

...不会插入 mfence，因为 x86 具有用于存储的释放语义和用于加载的获取语义。

# multithreading - 保证 Quartz.NET 触发器即使有很多实例也只触发一次事件

> ID：11836030
> 
> 赞同：1
> 
> 时间：2012-08-06T21:14:33.953
> 
> 标签：multithreading, triggers, quartz.net, appharbor

标题有点古怪，但我正在尝试为 AppHarbor 找出一个解决方法，可能会触发我的后台应用程序的多个实例。此应用程序使用 Quartz.NET 按基本计划将关键事件推送到我的服务器。但是，*我不能保证我的后台应用程序只有一个实例*，但我必须让每个事件正常触发（基本上作为服务器 POV 的一个单元）。

我最初尝试使用锁定和 Redis 来解决这个问题，但我无法让它工作得足够好。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T23:26:45.913

您可以通过在每次运行后重新安排自己的工作来做到这一点。您无需指定计划是什么，但如果不必同时发生，则使用仅触发一次的触发器来计划作业。当作业完成运行后，让它在未来的某个时间再次安排自己。这样，在任何给定时间，商店里只有一份工作。您可能必须在如何加载初始作业和处理错误方面发挥创造力，但只要您在引导时只能安排一项作业，那么您就有可能让它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:26:07.323

Quartz.NET 似乎[内置了对集群的支持](http://quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/tutorial-lesson-11)。从文档中：

> 每次触发时只有一个节点会触发作业。我的意思是，如果作业有一个重复触发器，告诉它每 10 秒触发一次，那么在 12:00:00 恰好一个节点将运行该作业，而在 12:00:10 恰好一个节点将运行作业等。它不一定每次都是同一个节点 - 哪个节点运行它或多或少是随机的。对于繁忙的调度程序（许多触发器），负载平衡机制是近乎随机的，但对于非繁忙（例如，一个或两个触发器）调度程序，它有利于刚刚处于活动状态的同一节点。

# c# - 在 Metro 应用程序中以编程方式设置图像源，图像不会出现

> ID：11836032
> 
> 赞同：4
> 
> 时间：2012-08-06T21:14:43.693
> 
> 标签：c#, image, windows-runtime, winrt-xaml, imagesource

我的应用程序中有一个主页和一个相机页面。主页有一个没有源集的图像和一个按钮。如果单击该按钮，它将带您进入相机页面。在相机页面上，我捕获图像并将其保存在平板电脑的图片库中，然后导航回主页，我想将图像的来源设置为我刚刚捕获并保存在图片库中的图像. 这是我的相关代码。

主页.xaml

```
<Image  x:Name="imgResume" HorizontalAlignment="Left" Height="303" Margin="975,60,0,0" Grid.Row="1" VerticalAlignment="Top" Width="360" Stretch="UniformToFill" Loaded="img_OnLoaded"/>
<Button x:Name="btnCamera" Content="Camera" HorizontalAlignment="Left" Margin="1128,372,0,0" Grid.Row="1" VerticalAlignment="Top" RenderTransformOrigin="2.05800008773804,0.184000000357628" Height="59" Width="108" Click="Camera_Click" IsEnabled="False"/> 
```

MainPage.xaml.cs

```
private void img_OnLoaded(object sender, RoutedEventArgs e)
    {
        if (txtFirstName.Text != "" && txtLastName.Text != "")
        {
            try
            {
                imgResume.Source = ImageFromRelativePath(this, Windows.Storage.KnownFolders.PicturesLibrary.Path + ((App)Application.Current).candidate.FirstName + ((App)Application.Current).candidate.FirstName + "Resume.jpg");
                imgResume.UpdateLayout();
            }
            catch
            {
                imgResume.Source = ImageFromRelativePath(this, @"Assets/logo.png");
                imgResume.UpdateLayout();
            }
            btnCamera.IsEnabled = true;
        }
    }

    public static BitmapImage ImageFromRelativePath(FrameworkElement parent, string path)
    {
        var uri = new Uri(parent.BaseUri, path);
        BitmapImage result = new BitmapImage();
        result.UriSource = uri;
        return result;
    } 
```

相机.xaml.cs

```
private async void Capture_Click(object sender, RoutedEventArgs e)
    {
        if (mediaCaptureMgr != null)
        {
            string firstName = ((App)Application.Current).candidate.FirstName;
            string lastName = ((App)Application.Current).candidate.LastName;
            string fileName = firstName + lastName + "Resume.jpg";

            Windows.Storage.IStorageFile photo = await Windows.Storage.KnownFolders.PicturesLibrary.CreateFileAsync(fileName, Windows.Storage.CreationCollisionOption.ReplaceExisting);

            await mediaCaptureMgr.CapturePhotoToStorageFileAsync(Windows.Media.MediaProperties.ImageEncodingProperties.CreateJpeg(), photo);

            this.Frame.Navigate(typeof(BasicPersonalInfo));
        }
    } 
```

MainPage.xaml 文件中的 img_OnLoaded 方法试图将图像源设置为我从 Camera.xaml.cs 中的 Capture_click 方法保存到图片库的图像。

我的问题是图片永远不会出现在第一页的图片上！请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T18:19:38.930

这也可能有助于人们尝试解决从本地资源文件更新图像的相关问题。

```
myImage.Source = ImageFromRelativePath(this, "relative_path_to_file_make_sure_build_set_to_content");

public static BitmapImage ImageFromRelativePath(FrameworkElement parent, string path)
{
    var uri = new Uri(parent.BaseUri, path);
    BitmapImage result = new BitmapImage();
    result.UriSource = uri;
    return result;
} 
```

代码来自[这里](http://www.codingbeta.com/programatically-setting-image-source-in-metro-style-apps-with-wpf/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T23:20:51.460

我认为这部分是问题所在：

```
var uri = new Uri(parent.BaseUri, path); 
```

这似乎是在您的路径是完整路径时尝试从安装文件夹加载图像，我认为不支持在 WinRT 中打开文件，并且即使使用 baseUri 也肯定不能作为 Uri 工作。

您应该改为执行以下操作：

```
var file = await Windows.Storage.KnownFolders.PicturesLibrary.GetFileAsync(((App)Application.Current).candidate.FirstName + "Resume.jpg");
var stream = await file.OpenReadAsync();
var bi = new BitmapImage();
bi.SetSource(stream);

return bi; 
```

# testing - 使用 Bonita 作为后端测试应用程序的资源

> ID：11836034
> 
> 赞同：0
> 
> 时间：2012-08-06T21:14:45.113
> 
> 标签：testing, web, workflow

我们正在开发一些使用 Bonita 作为工作流管理工具的 Web 应用程序。你们中是否有任何资源可以帮助我开发测试自动机

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:41:04.053

我用过硒。（从[http://seleniumhq.org](http://seleniumhq.org)下载）

您可以使用 firefox 创建测试（有点像创建宏）。然后您可以稍后重新运行它们或使用测试服务器自动执行大量测试。

下面我包含了一个基本测试的源代码，用于登录 Bonita 用户体验并启动一个流程。

用您的详细信息替换 SERVERIPADDRESS、MYUSERNAME 和 MYPASSWORD。

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://selenium-ide.openqa.org/profiles/test-case">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="selenium.base" href="http://SERVERIPADDRESS:8080/bonita/" />
<title>New Test</title>
</head>
<body>
<table cellpadding="1" cellspacing="1" border="1">
<thead>
<tr><td rowspan="1" colspan="3">New Test</td></tr>
</thead><tbody>
<tr>
    <td>open</td>
    <td>/</td>
    <td></td>
</tr>
<tr>
    <td>clickAndWait</td>
    <td>link=Business Process Management</td>
    <td></td>
</tr>
<tr>
    <td>type</td>
    <td>id=username</td>
    <td>MYUSERNAME</td>
</tr>
<tr>
    <td>typeAndWait</td>
    <td>name=password</td>
    <td>MYPASSWORD</td>
</tr>
<tr>
    <td>click</td>
    <td>css=div.gwt-Label</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>css=div.menu_choice</td>
    <td></td>
</tr>
<tr>
    <td>click</td>
    <td>css=button.bonita_form_button</td>
    <td></td>
</tr>

</tbody></table>
</body>
</html> 
```

# c# - 将标头添加到 .Net 3.5 WCF 客户端

> ID：11836035
> 
> 赞同：3
> 
> 时间：2012-08-06T21:14:45.503
> 
> 标签：c#, .net, wcf, header, client

我在 c# .Net framework 3.5 中有一个简单的 Web 客户端，它像这样调用 SOAP 服务 HelloWorld：

```
HelloService myservice = new HelloService();
string result = myservice.HelloWorld(); 
```

我正在使用一些中间件，通过请求授权标头来增加基本安全性：“Authorization=Bearer 123456abcd”，它与 REST 服务一起使用，但我想通过上面的 .Net 客户端使用该服务......

如何将标头添加到服务调用？是否存在类似：`myservice.addHeader("authorization=blah");`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:23:27.773

你应该使用[`OperationContextScope`](http://msdn.microsoft.com/ru-ru/library/system.servicemodel.operationcontextscope%28v=vs.90%29.aspx)

```
using (OperationContextScope scope = new OperationContextScope(wcfClient.InnerChannel))
      {
        MessageHeader header
          = MessageHeader.CreateHeader(
          "Service-Bound-CustomHeader",
          "http://Microsoft.WCF.Documentation",
          "Custom Happy Value."
          );
        OperationContext.Current.OutgoingMessageHeaders.Add(header);

        // Making calls.
        Console.WriteLine("Enter the greeting to send: ");
        string greeting = Console.ReadLine();

        //Console.ReadLine();
        header = MessageHeader.CreateHeader(
            "Service-Bound-OneWayHeader",
            "http://Microsoft.WCF.Documentation",
            "Different Happy Value."
          );
        OperationContext.Current.OutgoingMessageHeaders.Add(header);

        // One-way
        wcfClient.Push(greeting);
        this.wait.WaitOne();

        // Done with service. 
        wcfClient.Close();
        Console.WriteLine("Done!");
        Console.ReadLine();
      } 
```

授权

```
var messageProperty = new HttpRequestMessageProperty();
messageProperty.Headers.Add(HttpRequestHeader.Authorization, AuthorizationHeader); 
```

# java - 我在哪里可以获得 servlet-api.jar 的源代码？

> ID：11836039
> 
> 赞同：19
> 
> 时间：2012-08-06T21:15:01.447
> 
> 标签：java, servlets

我有一个项目使用`servlet-api.jar`. 调试时，我想进入它的类（例如 HttpServlet），但我得到“Source not found attach source”。

有没有办法像所有 Java 源代码一样获取源代码？拥有它会很好，这样我就可以调试它并进入代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T21:19:15.863

您可以从 apache tomcat 网站获取 apache 源代码：http: [//tomcat.apache.org/index.html](http://tomcat.apache.org/index.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T21:18:35.110

Servlet API JAR 只是接口（以及一些次要的实用程序类）；没有什么可以进入的。

根据您的应用服务器，您可以下载实现类的源代码，例如`HttpRequest`（对于 Tomcat，请参见[此处](http://tomcat.apache.org/svn.html)的说明）。但是，为什么您觉得进入这些课程很有价值？它们通常运行良好，几乎可以肯定任何问题都在您自己的代码中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-06T21:37:33.187

您可以从 java2s.com 获取源代码

（servlet API 3.0 版）：[http ://www.java2s.com/Code/Jar/s/Downloadservletapi3020100224sourcesjar.htm](http://www.java2s.com/Code/Jar/s/Downloadservletapi3020100224sourcesjar.htm)

（或旧版本 2） [http://www.java2s.com/Code/Jar/s/Downloadservletapi256114sourcesjar.htm](http://www.java2s.com/Code/Jar/s/Downloadservletapi256114sourcesjar.htm)

事实上 java2s.com 是一个巨大的 java 源、程序和 jar 资源。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-06T21:23:02.863

此外，如果您在 eclipse 或 netbeans 中，并且正在使用基于 maven 的项目，请右键单击依赖项并下载特定依赖项的源代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-14T01:35:27.983

**Intellij IDEA**

1.  从 Apache 下载源代码，放在计算机中某个稳定的地方。
2.  尝试进入一些 .jar 函数，直到“反编译”结果显示。
3.  点击“选择来源”。
4.  选择下载的源代码，IDEA 将完成剩下的工作 :)

[![在 IDEA 中选择来源](../Images/bbd188d021c2d4c1e3c0e1482ee030f4.png)](https://i.stack.imgur.com/8OEWb.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-30T01:33:22.017

要查看有关“servlet-api.jar”的类或方法的 Javadoc，请访问 [http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.27/src/](http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.27/src/)

（对于其他版本的 tomcat 访问 - [http://archive.apache.org/dist/tomcat/tomcat-8/](http://archive.apache.org/dist/tomcat/tomcat-8/)

并导航到他们的“src”目录，

并下载适用于 Windows 的 zip 文件（适用于 Linux 的 tar。），最后

将其附加到 IDE（Netbeans、Eclipse 等）中

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-07-05T23:22:04.477

*   当您下载 apache tomcat 的二进制发行版时，您还可以下载相应的源代码发行版（在同一页面上）。
*   只需下载源代码分发 zip。
*   将其移动到tomcat apache文件夹中的某个位置
*   当 Eclipse 要求您提供源代码附件时，请指向源代码分发 zip。

# c# - 我是在尝试错误地使用 Ninject，还是我遗漏了一些明显的东西？

> ID：11836046
> 
> 赞同：1
> 
> 时间：2012-08-06T21:15:36.417
> 
> 标签：c#, asp.net-mvc-3, ninject-2

我正在开发一个 ASP.NET MVC Web 应用程序。我想构建一个很好的数据层来抽象一切。所以就像一个好的数据层一样，控制器不会直接与数据库对话。

现在，当然，在数据层内部有很多东西需要与数据库对话。我希望所有这些对象都使用相同的数据上下文（这是使用 Linq2SQL，但并不认为这很重要。）所以是的，这听起来很像存储库或工作单元模式。有点像，除了我主要是在实现工作单元部分。

现在，我的问题是如何将数据上下文提供给所有需要它的类？我原以为 Ninject 可以将它注入我需要的地方。确实如此，如果我正在构建的对象在其构造函数中只有一个参数。

所以这似乎运作良好：

```
public class InjectedFoo
{
     InjectedFoo(IInjectable ii) {/*stuff*/}
} 
```

然而，这给了我编译器错误：

```
public class InjectedFoo
{
     InjectedFoo(Object stuff, IInjectable ii) {/*stuff*/}
} 
```

是的，这很有意义。毕竟编译器不知道 Ninject 将创建第二个参数。但同时，Ninject 只用一个参数就知道了……这似乎是重点。那么我该如何使用这两个参数呢？

现在，让我们提高一点赌注：

```
public static class FooFactory
{
    public static MakeFoo(int fooID, IInjectable ii)
    {
    }
} 
```

所以现在我想要一个类使用现有的数据上下文，而无需实际实例化。我需要将我想要的对象的 ID 传递给它。所以当然我有第二个参数没有被传入的问题，所以编译器会抱怨，但我什至不能使用属性注入，因为我不能有一个非静态属性。（我知道我可以使用静态属性，但我不知道它是否安全。）

所以我觉得我要么错误地使用了 Ninject，要么只是缺少处理这个问题的东西。不幸的是，所有文档和示例似乎都集中在非常简单的 1 参数构造函数上......

# c++ - 如何可靠地确定文件是否已在 Microsoft Excel 中打开？

> ID：11836048
> 
> 赞同：2
> 
> 时间：2012-08-06T21:15:44.537
> 
> 标签：c++, excel, com, automation

我正在实现一个 Excel 接口。我正在使用 COM 直接从 C++ 自动化 Excel。我的大部分应用程序都可靠地工作。

但是，我无法检测到文件是否已在 Excel 中打开。如果它是打开的，那么我想通知用户在运行他们的模拟之前关闭它。

我没有使用 MFC、VB 或 .NET。我的解决方案必须适用于 Excel 版本 97 到 2010。如果我可以通过编程方式知道 Excel 的版本，则可以对不同的 Excel 版本使用不同的技术。

我在同一个文件夹中寻找一个名为“~$xxx”（其中“xxx”是原始文件名）的文件，以确定 Excel 是否创建了会话锁。但这种技术并不总是有效。

一个类似的问题是，一旦在我的程序中开始模拟，我想阻止用户以写入模式打开文件（只读模式可以）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:37:12.477

我不使用 C++，但使用来自 VB.net 的相同逻辑，这个 C++ 代码可能应该做你想要的？不过，我还没有测试过……这也不需要您检查任何特定的 Excel 版本。对于`.xlsx`或任何其他扩展，只需替换下面的扩展。

```
std::ofstream ofs("MyFile.xls");

if(ofs.is_open())
{
    //~~> File is ready for output
}
Else
{
    //~~> File is NOT ready for output
} 
```

**编辑**：

你可能也想看看这个？

**主题**：FileInfo::IsReadOnly 属性

**链接**：http: [//msdn.microsoft.com/en-us/library/system.io.fileinfo.isreadonly.aspx#Y0](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.isreadonly.aspx#Y0)

**从上面的链接引用**

> 获取或设置一个值，该值确定当前文件是否为只读。
> 
> 命名空间：System.IO
> 
> 程序集：mscorlib（在 mscorlib.dll 中）

# macos - 如何判断 CGEvent 触发的动作何时完成？

> ID：11836049
> 
> 赞同：0
> 
> 时间：2012-08-06T21:15:56.970
> 
> 标签：macos, cocoa

我正在使用`CGEventPost()`以编程方式发布键盘和鼠标事件。这些事件最终会触发其他事件/动作（例如，某些窗口变为活动状态、按下按钮、在文本字段中输入字母）。为了同步线程，我想知道由特定触发的所有事件何时`CGEvent`完成处理。

所有`CGEventPost()`s 最终都将作用于单个应用程序的单个窗口。

编辑：

Nielsbot 的解决方案运行良好。我最终粗略地实现了 MCL 的 CCL 事件调度功能。该函数会一直阻塞，直到 Cocoa 运行过程循环中的所有当前事件都执行完毕。由于所有键盘和鼠标事件最终都会触发在此线程上运行的操作，因此这种方法可以正常工作。

我唯一担心的是事件调度在 CGEvent 触发事件循环中的动作之前被调用，但我的测试目前表明这没有发生。所以我现在正在使用这个解决方案。

只是 FYSA，至少在我的设置中，发布的事件似乎需要保守的 1 毫秒才能进入运行循环。

```
(defun event-dispatch ()
  (with-shadow (gui::queue-for-event-process
                 (lambda (f &key at-start)
                   (declare (ignore at-start)) 
                   (funcall fun-orig f :at-start nil))) 
    (gui::call-in-event-process (lambda () ())))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:20:16.293

插入自定义事件类型队列作为标记怎么样？等到该事件触发您自己的一些代码 - 这可能足以表明您之前发布的所有事件都已处理......

# javascript - 使用 Node 搜索 JSON 数组中的项目（最好不进行迭代）

> ID：11836050
> 
> 赞同：11
> 
> 时间：2012-08-06T21:16:07.493
> 
> 标签：javascript, json, node.js

目前我得到这样的JSON响应......

```
{items:[
  {itemId:1,isRight:0},
  {itemId:2,isRight:1},
  {itemId:3,isRight:0}
]} 
```

我想执行这样的事情（伪代码）

```
var arrayFound = obj.items.Find({isRight:1}) 
```

然后这将返回

```
[{itemId:2,isRight:1}] 
```

我知道我可以使用 for each 循环来做到这一点，但是，我试图避免这种情况。这目前是 Node.JS 应用程序的服务器端。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-06T21:26:43.423

```
var arrayFound = obj.items.filter(function(item) {
    return item.isRight == 1;
}); 
```

当然，您也可以编写一个函数来通过对象字面量作为条件来查找项目：

```
Array.prototype.myFind = function(obj) {
    return this.filter(function(item) {
        for (var prop in obj)
            if (!(prop in item) || obj[prop] !== item[prop])
                 return false;
        return true;
    });
};
// then use:
var arrayFound = obj.items.myFind({isRight:1}); 
```

这两个函数都使用了数组上的本[机`.filter()`方法。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/array/filter)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:27:30.050

由于 Node 实现了 EcmaScript 5 规范，因此您可以[在](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter).`obj.items`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T21:17:17.060

看看[http://underscorejs.org](http://underscorejs.org) 这是一个很棒的库。

[http://underscorejs.org/#filter](http://underscorejs.org/#filter)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-06T21:28:53.043

编辑为使用本机方法

```
var arrayFound = obj.items.filter(function() { 
    return this.isRight == 1; 
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-11T22:50:33.553

您可以尝试使用[find 函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find)查找预期结果，您可以在以下脚本中看到结果：

```
var jsonItems = {items:[
  {itemId:1,isRight:0},
  {itemId:2,isRight:1},
  {itemId:3,isRight:0}
]}

var rta =  jsonItems.items.find(
   (it) => {
     return it.isRight === 1;
   }
);

console.log("RTA: " + JSON.stringify(rta));

// RTA: {"itemId":2,"isRight":1}
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T15:07:32.647

实际上，如果您使用 mongoDB 来保存文档，我发现了一种更简单的方法...

```
findDocumentsByJSON = function(json, db,docType,callback) {
  this.getCollection(db,docType,function(error, collection) {
    if( error ) callback(error)
    else {
      collection.find(json).toArray(function(error, results) {
        if( error ) callback(error)
        else
          callback(null, results)
      });
    }
  });
} 
```

然后，您可以将 {isRight:1} 传递给该方法并仅返回一个对象数组，这样我就可以将繁重的工作推给有能力的 mongo。

# macos - Node.js：安装 node-yajl 时遇到问题

> ID：11836055
> 
> 赞同：0
> 
> 时间：2012-08-06T21:16:32.017
> 
> 标签：macos, node.js, npm, homebrew

我在 OS X Lion 上。我已经通过 Homebrew ( `brew install yajl`) 安装了 libyajl。标头存在于`/usr/local/include/yajl`：

```
scott @ scott-laptop : ~/Desktop
$ ls /usr/local/include/yajl
yajl_common.h  yajl_gen.h     yajl_parse.h   yajl_tree.h    yajl_version.h
scott @ scott-laptop : ~/Desktop
$ node -v
v0.8.5
scott @ scott-laptop : ~/Desktop
$ npm -v
1.1.46 
```

但是在安装 Node 模块时出现错误：

```
scott @ scott-laptop : ~/Desktop
$ npm install yajl
npm http GET https://registry.npmjs.org/yajl
npm http 304 https://registry.npmjs.org/yajl

> yajl@0.6.1 install /Users/scott/Desktop/node_modules/yajl
> node-waf configure build

Checking for program g++ or c++          : /usr/bin/g++ 
Checking for program cpp                 : /usr/bin/cpp 
Checking for program ar                  : /usr/bin/ar 
Checking for program ranlib              : /usr/bin/ranlib 
Checking for g++                         : ok  
Checking for node path                   : ok /usr/local 
Checking for node prefix                 : ok /usr/local 
Checking for header yajl/yajl_version.h  : not found 
/Users/scott/Desktop/node_modules/yajl/wscript:20: error: Could not find yajl headers. Make sure libyajl development package is installed.
npm ERR! yajl@0.6.1 install: `node-waf configure build`
npm ERR! `sh "-c" "node-waf configure build"` failed with 1
npm ERR! 
npm ERR! Failed at the yajl@0.6.1 install script.
npm ERR! This is most likely a problem with the yajl package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-waf configure build
npm ERR! You can get their info via:
npm ERR!     npm owner ls yajl
npm ERR! There is likely additional logging output above.

npm ERR! System Darwin 11.4.0
npm ERR! command "node" "/usr/local/bin/npm" "install" "yajl"
npm ERR! cwd /Users/scott/Desktop
npm ERR! node -v v0.8.5
npm ERR! npm -v 1.1.46
npm ERR! code ELIFECYCLE
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /Users/scott/Desktop/npm-debug.log
npm ERR! not ok code 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:55:11.523

在 Node 0.8.0 中，构建系统从 node-waf 更改为 node-gyp。我在这里向 node-yajl fork 添加了一个 gyp 构建：[https ://github.com/scttnlsn/node-yajl](https://github.com/scttnlsn/node-yajl)

# qt - 在 Qt 中将文件切割成块

> ID：11836056
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:16:36.480
> 
> 标签：qt

谁能给我一个提示或初步想法，我如何在 Qt 中将文件切成块？是否有任何特定的文件，如 java 它内置了拆分功能。稍后我想计算每个块的 SHA-256 哈希值。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:23:21.417

没有内置功能。

1.  打开原始文件。
2.  打开第一个块的文件。
3.  从原始文件中读取字节。
4.  将字节写入块文件。
5.  重复。

请参阅[QFile 文档](http://doc-snapshot.qt-project.org/4.8/qfile.html)。

# bdd - 使用 SpecFlow 1.9 和 SpecRun 1.1 时找不到 SpecRun.exe

> ID：11836057
> 
> 赞同：1
> 
> 时间：2012-08-06T21:16:40.433
> 
> 标签：bdd, specflow

刚刚从 NuGet 下载了最新的 SpecFlow 1.9 到 BookStore 演示。

场景运行良好 - 一切都过去了。

当我从 NuGet 安装 SpecRun 1.1 并运行场景时，SpecFlow 给我一个对话框，上面写着：“无法找到 SpecRun.exe”。

我已经从 app.config 中删除了 MSTest 运行器。

我已验证 SpecRun.exe 位于：\BookShop\packages\SpecRun.Runner.1.1.0\tools

它编译得很好，网站仍然运行得很好——只是没有使用 SpecRun 的 SpecFlow。

我错过了配置步骤吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T09:04:04.660

我相信问题在于删除 MSTest。我遇到了同样的错误（“无法找到 SpecRun.exe”），在我的情况下，这是因为我的项目设置中的测试运行器工具未设置为 MSTest。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T08:08:38.783

您可能需要同时升级 NuGet 包**和**VS IDE 集成；[http://www.specflow.org/specflownew/WhatsNew19.html](http://www.specflow.org/specflownew/WhatsNew19.html)。

至少为我工作:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-11T15:40:49.840

我遇到了类似的问题。尝试通过 Tools->Extension Manager 安装 SpecFlow 1.9.2 扩展...

# c# - 为什么我会得到一个关于文件正在被另一个进程使用的 IO 异常，而实际上它不是？

> ID：11836058
> 
> 赞同：0
> 
> 时间：2012-08-06T21:16:44.327
> 
> 标签：c#, .net, winforms

我已经实现了一个基本的日志记录类，当我尝试创建它的新实例时，我得到了以下异常。

该进程无法访问文件“C:\Users\carl\Desktop\My Projects\TCV2\CallPotential.UI\bin\Debug\application.log”，因为它正被另一个进程使用。

这是记录器类的代码。

```
using System;
using System.IO;
using System.Reflection;

namespace CallPotential.Utilities
{
    public class Logger : IDisposable
    {
        /// <summary>
        /// Used to write output to the log file.
        /// </summary>
        private StreamWriter _stream;

        /// <summary>
        /// The absolute path to the log files location.
        /// </summary>
        public String LogFileName
        {
            get
            {
                // get the directory where our main assembly is located.
                Assembly assembly = Assembly.GetExecutingAssembly();
                String directoryName = Path.GetDirectoryName(assembly.Location);
                return Path.Combine(directoryName, "application.log");
            }
        }

        /// <summary>
        /// Creates a new instance of the Logger class
        /// </summary>        
        public Logger()
        {         
           _stream = new StreamWriter(LogFileName);         
        }

        /// <summary>
        /// Writes a message out to the application log file.
        /// </summary>
        /// <param name="message">The message to write to the log file.</param>
        public void Write(String message)
        {
            _stream.WriteLine(message);
            _stream.Flush();
            _stream.Close();
        }

        /// <summary>
        /// Writes a message including the applications state to the log file.
        /// </summary>
        /// <param name="state">The application state at the time of the logged message.</param>
        /// <param name="message">The message to be written to the log file.</param>
        public void Write(AppState state, String message)
        {
            Write(String.Format("{0}\r\n\t{1}", state, message));
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
        public void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (_stream != null)
                {
                    _stream.Dispose();
                    _stream = null;
                }
            }
        }
        ~Logger()
        {
            Dispose(false);
        }
    }
} 
```

请注意原因，但它会在构造函数中引发异常。任何帮助解决这个问题将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:27:32.867

基本问题是您打开了一个流，这意味着您只能访问日志记录类的一个实例，除非您进行一些更改。

您可以进行的各种更改包括：

1) 确保每个实例生成自己的日志文件名。

2) 强制所有日志记录到在整个应用程序中使用的特定文件名。

在任何一种情况下，您都需要通过 SyncLock 块控制对关键功能的访问，例如打开、关闭、读取和写入，以确保如果您从线程记录或有多个实例共享同一个文件，则只有一个调用者正在执行代码同时。

在第一种情况下，您可能只想拥有一个实例。

在第二种情况下，您可以使用静态流编写器和静态方法，因为您不需要创建该类的新实例。这是我们多年前根据 Microsoft 在早期异常处理应用程序块中的指导实施的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:21:13.003

> 当我尝试创建它的新实例时，出现以下异常。

您应该在创建新实例之前处置当前实例。

也许你应该考虑单例模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:36:40.993

永远只能有 1 个记录器实例。但是，Visual Studio 应用程序可能正在通过反射创建一个实例，因此它可以使用智能感知。a) 关闭宿主进程，b) 使用命令行编译。

为了解决您的特定问题，但是设计很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:23:02.970

我总是使用 append 属性进行日志记录，所以永远不要忘记打开的流

```
 public void Write(AppState state, String message)
    {

        StreamWriter sw = new StreamWriter(LogFileName, true);// true to append the new text
        sw.WriteLine(String.Format("{0}\r\n\t{1}", state, message));
        sw.Close(); // Close() is the same as Dispose()
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:32:29.367

我能够重现错误 - 在第二行引发了异常：

```
var logger1 = new Logger();
var logger2 = new Logger(); 
```

但是，当我在第一个实例上使用 Write() 方法时，即：

```
var logger1 = new Logger();
logger1.Write("XYZ");
var logger2 = new Logger(); 
```

不再抛出异常。在您的情况下，它的行为方式是否相同？

问题是您对两个记录器使用相同的文件，如果您不关闭流或处置第一个实例，您基本上是在尝试为一个文件同时打开两个流。

尝试使用两个不同的文件（例如，您可以在构造函数中将路径传递给日志文件，而不是使用具有默认值的属性）并让我知道这是否解决了您的问题。

PS 但是，如果您需要两个记录器写入同一个文件并且它们应该能够同时访问该文件，那么您应该采用不同的方法 - 单例模式会更合适。

# ios - 使用 GLKit 在 OpenGL ES 2.0 中出现奇怪的混合效果

> ID：11836059
> 
> 赞同：1
> 
> 时间：2012-08-06T21:16:53.413
> 
> 标签：ios, opengl-es, xamarin.ios, opengl-es-2.0, glkit

这发生在带有 MonoTouch 5.3 的 GLKit 上，但我认为问题可能是一般的 OpenGL ES 2.0 性质。

我有三张脸，一张是红色的，一张是绿色的，一张是蓝色的，alpha 值都是 1.0，所以它们应该是不透明的。当它们在黑色背景上渲染时，一切正常。如果绿色的脸在其他人面前，那么一切都很好。但如果

*   红色的脸在绿色的前面
*   或者蓝脸在其他人的面前

前景色未渲染，但背景面完全可见。这似乎是某种混合效果，但我在我的代码中没有看到任何特别之处，并且我已经尝试了几种类似的东西`glBlendFunc`，但它并没有改变任何东西。

我可以发布我的代码，但由于代码很简单，我想也许有人会立即知道答案。

**更新：**由于这似乎是一个深度排序问题，以下是代码的一些重要部分：

```
 var aContext = new EAGLContext(EAGLRenderingAPI.OpenGLES2);
        var view = this.View as GLKView;
        view.Delegate = new GenericGLKViewDelegate(this);
        view.Context = aContext;

        view.DrawableColorFormat = GLKViewDrawableColorFormat.RGBA8888;
        view.DrawableDepthFormat = GLKViewDrawableDepthFormat.Format16;
        view.DrawableMultisample = GLKViewDrawableMultisample.Sample4x; 
```

这是 DrawInRect 方法：

```
 _baseEffect.PrepareToDraw();

        GL.Clear(ClearBufferMask.ColorBufferBit | ClearBufferMask.DepthBufferBit);

        GL.EnableVertexAttribArray((int)GLKVertexAttrib.Position);
        GL.EnableVertexAttribArray((int)GLKVertexAttrib.Color);

        GL.VertexAttribPointer((int)GLKVertexAttrib.Position, 3, VertexAttribPointerType.Float, false, 0, _squareVertices);
        GL.VertexAttribPointer((int)GLKVertexAttrib.Color, 4, VertexAttribPointerType.UnsignedByte, true, 0, _squareColors);

        GL.DrawArrays(BeginMode.TriangleStrip, 0, 9);

        GL.DisableVertexAttribArray((int)GLKVertexAttrib.Position);
        GL.DisableVertexAttribArray((int)GLKVertexAttrib.Color); 
```

`ColorFormat`我尝试了,`DepthFormat`和的所有可能组合`Multisample`，但还是一样。

**解决方案：**

我错过了一些启用深度缓冲区的调用，方法中缺少这些调用`ViewDidLoad`：

```
 GL.ClearDepth(30);
        GL.Enable(EnableCap.DepthTest);
        GL.DepthFunc(DepthFunction.Lequal); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:25:29.507

这听起来不像是混合问题，而是深度排序问题。

是否启用了深度缓冲区？您是否在每一帧都清除它？

# hibernate - 附加分离条件查询结果

> ID：11836060
> 
> 赞同：0
> 
> 时间：2012-08-06T21:16:57.280
> 
> 标签：hibernate, grails, grails-orm

我正在尝试运行以下分离条件查询：

```
 def e = new DetachedCriteria(Equipment).build {
        eq('name', ef.name)
    }.get() 
```

但是当我`e.isAttached()`随后立即打电话时，我得到了`true`。

背景：我知道我有一个对设备 e 的内存附加引用，但我想要一个对它的分离引用，以便我可以将旧数据库值与内存集进行比较，以查看发生了什么变化......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T02:10:54.267

您在此处创建的不是分离查询* - 它是一个`Equipment`实例。通过添加`get()`您正在执行查询并生成附加`Equipment`实例。要创建分离查询，请删除`get()`：

```
def dQuery = new DetachedCriteria(Equipment).build {
    eq('name', ef.name)
} 
```

然后当您需要执行时：

```
def e = dQuery.get() 
```

如果要分离`Equipment`实例，则可以调用

```
e.discard() 
```

*   实际上，您正在创建分离的查询 - 它只是从未分配给任何东西，因此它有点在后台。

# jsf-2 - Richfaces Rich：验证器在客户端验证期间未将 UIInput 标记为无效

> ID：11836061
> 
> 赞同：1
> 
> 时间：2012-08-06T21:17:00.880
> 
> 标签：jsf-2, richfaces

我在 inputText 上使用 rich:validator 进行 JSR-303 验证，如下所示：

```
<h:outputLabel value="#{msgs['label.email']}:"/>
            <h:inputText value="#{loginBean.email}" id="email" size="50" validatorMessage="Invalid email address." styleClass="#{component.valid ? '' : 'invalid'}">
                <rich:validator />
            </h:inputText>
            <rich:message for="email" /> 
```

当验证失败时， inputText 的类应该更改为`invalid`，这会导致组件周围出现红色边框，并且应该使用 rich:message 显示`Invalid email address`消息。如果我输入了无效的电子邮件地址并将鼠标光标移到 inputText 之外，则只会`Invalid email address`出现该消息；UIInput 不会切换到`invalid`类，因此组件周围不会出现红色边框。但是，如果我单击提交按钮并使用无效的电子邮件地址提交表单，则在重新加载页面时 inputText 框的类会发生更改，并且我会同时收到红边组件和错误消息。为什么会这样？JSR-303 不要求客户端验证工作与提交表单一样吗？

**编辑：**

我在 inputText 中添加了以下内容，这解决了更改 inputText 上的类的问题：

```
 <a4j:ajax event="blur" render="email"/> 
```

然而，这带来了一个新的问题。现在，错误消息不是“粘性的”。换句话说，当输入无效的电子邮件时，inputText 上会出现红色轮廓并出现错误消息，如预期的那样，但如果我随后在另一个组件上输入无效输入并且它的类更改为“无效”并且出现错误消息，“电子邮件”上的错误消息消失。inputText 类更改现在可以正常工作，但消息是不稳定的，如果另一个组件的条目无效，它们就会消失。

# java - 用于低带宽的 RMI - 替代方案？

> ID：11836062
> 
> 赞同：1
> 
> 时间：2012-08-06T21:17:03.330
> 
> 标签：java, sockets, proxy, rmi

我正在建立一个客户端-服务器连接，稍后将针对低带宽。目前我正在使用套接字。但现在我绕过 RMI——这似乎满足了我的需求：从客户端调用服务器端方法。

我的问题是：我应该更深入地了解 RMI，还是有更好的方法我可能不知道？

我的目标特别是在服务器上有一些方法，然后我可以由客户端执行。所以我的“消息队列”不能是静态的，因为它必须是在只使用套接字并从 read() 获取字符串时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:29:13.210

我不会从头开始写这样的东西。

RMI 表示纯 Java 客户端，RMI 或 CORBA 表示有线协议。

简单和开放赢得了胜利：为什么不考虑通过 SOAP、REST 或 RPC-XML 向客户端公开方法的基于 Web 的 HTTP 服务？那些可以被非 Java 客户端调用；它们在网络上可用；它们提供与 RMI 相同的优势。

我不明白为什么有人会再从原始 RMI 开始。它失去了争论，就像 CORBA 所做的那样。

# c - C：根据文件名创建新的文件扩展名

> ID：11836064
> 
> 赞同：0
> 
> 时间：2012-08-06T21:17:08.210
> 
> 标签：c, string, strcat

我想根据具有不同扩展名的基本文件名命名输出文件。在 C 伪代码中：

```
a_file = fopen(filename + ".dt1","wt");
b_file = fopen(filename + ".dt2","wt");
c_file = fopen(filename + ".dt3","wt"); 
```

我尝试使用 遵循[此](https://stackoverflow.com/questions/308695/c-string-concatenation)示例`strncat`，但我的程序一直附加到`filename`.

```
f1=fopen(strcat(filename,".dt1"),"wt");
f2=fopen(strcat(filename,".dt2"),"wt");
f3=fopen(strcat(filename,".dt3"),"wt"); 
```

这输出：

```
filename.dt1
filename.dt1.dt2
filename.dt1.dt2.dt3 
```

我需要最终结果看起来像：

```
filename.dt1
filename.dt2
filename.dt3 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:20:34.970

[`strcat`](http://en.cppreference.com/w/c/string/byte/strcat)考虑到将扩展名附加到给定字符串，您的代码按预期工作。您只使用一个字符串，因此扩展名彼此堆叠。

这是执行此操作的一种方法，修改您发布的代码，该代码使用单个字符串`filename`：

```
size_t len = strlen(filename);
f1 = fopen(strcat(filename, ".dt1"), "wt");
filename[len] = '\0';
f2 = fopen(strcat(filename, ".dt2"), "wt");
filename[len] = '\0';
f3 = fopen(strcat(filename, ".dt3"), "wt"); 
```

将此索引设置为`\0`有效地截断`filename`回调用之间的原始字符串。

请注意，它`filename` **必须**足够大以包含附加的扩展名 - **4 个**额外字符的空间 - 这样做会在打开每个文件后丢失中间文件名。

或者，如果您的扩展名仅在最后一个字符上有所不同：

```
size_t len = 0;
f1 = fopen(strcat(filename, ".dt1"), "wt");
len = strlen(filename);
filename[len - 1] = '2';
f2 = fopen(filename), "wt");
filename[len - 1] = '3';
f3 = fopen(filename, "wt"); 
```

与上述相同的警告也适用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T21:21:34.877

那是因为`strcat`直接写入第一个字符串的缓冲区。

最简单的方法可能是使用[`snprintf`](http://linux.die.net/man/3/snprintf)将两个字符串连接在一起：

```
snprintf(filename_a, n+4, "%s.dt1", filename);
snprintf(filename_b, n+4, "%s.dt2", filename);
snprintf(filename_c, n+4, "%s.dt3", filename); 
```

在这里，`filename`是长度`n`（包括尾随`\0`），和`filename_a`，`filename_b`并且`filename_c`是长度至少为 的缓冲区`n+4`。

（你也可以使用`sprintf`，但小心一点总是好的。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T21:21:39.560

我会说你的输出非常合理：

```
char * strcat ( char * destination, const char * source ); 
```

> 将源字符串的副本附加到目标字符串。目标中的终止空字符被源的第一个字符覆盖，并且一个新的空字符附加在目标中两者连接形成的新字符串的末尾。

因此， 指向的字符数组`filename`既可以从连接结果返回，`strcat`也可以用连接结果进行修改。

非常简单的解决方法是在修改之前记住文件名长度，然后：

```
filename[filename_length_before_modification] = '\0'; 
```

这将有效地减少附加的扩展名并让你回到起点

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-06T21:26:03.390

标准 C 库有点痛苦，但这是我的做法。

```
 char *fn = malloc(strlen(filename+5)); // Allocate a string with enough space
                                           // for the extensions.

    sprintf(fn, "%s.dt1", filename);       // Copy the name with extensions into fn.
    a_file = fopen(fn,"wt");               //
    sprintf(fn, "%s.dt2", filename);       //
    b_file = fopen(fn,"wt");               //
    sprintf(fn, "%s.dt3", filename);       //
    c_file = fopen(fn,"wt");               //

    free(fn); // Free the memory gained from malloc. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-07T02:50:51.240

一种更有效的方式。它每次只复制扩展名。如果我们假设只有最后一个字符发生变化，它可以变得更加高效（参见 pb2q 的[第二个解决方案](https://stackoverflow.com/a/11836102/1166181)）。

（未经测试，可能会关闭）

```
size_t len = strlen(filename);
char *buf = malloc(len+4); // Allocate a string with enough space for the
                           // extensions.
strcpy(buf, filename);
char *ext = buf+len // Get a pointer to where the extension starts.

strcpy(ext, ".dt1");             // Copy the name with extensions into fn.
FILE *a_file = fopen(buf, "wt"); //
strcpy(ext, ".dt2");             // 
FILE *b_file = fopen(buf, "wt"); //
strcpy(ext, ".dt3");             // 
FILE *c_file = fopen(buf, "wt"); //

free(buf); // Free the memory gained from malloc. 
```

# android - google nexus 7 开发轮换不起作用

> ID：11836065
> 
> 赞同：-2
> 
> 时间：2012-08-06T21:17:08.827
> 
> 标签：android, tablet, screen-orientation

我最近开始在google nexus 7上创建一个移动应用程序。我之前在kindle fire上测试过这个应用程序，纵向和横向模式都可以在所有屏幕上运行，但是当我将应用程序上传到nexus时，应用程序总是保持纵向。

有没有人遇到过这个问题或知道为什么 nexus 只以纵向模式显示我的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:21:08.323

您的设备旋转锁定是否打开？它在快速下拉菜单中。

# php - 将 microsoft world web 应用程序添加到网站 - 或在线预览文档。

> ID：11836076
> 
> 赞同：1
> 
> 时间：2012-08-06T21:18:19.663
> 
> 标签：php, ms-word, powerpoint

嗨，所有可爱的堆栈窥视者......希望你能帮助我解决一个小难题。

我正在开发的 Web 系统需要为用户提供预览文档的能力。我正在研究生成文档前几页的 Jpg 的方法，但这在我们的服务器 ATM 上可能是不可能的。

Facebook 接缝最近变得非常微软，他们添加的功能之一是“文档”的预览选项。这接缝使用微软的万维网应用工具。

我用谷歌搜索了一下，使用这个接缝的唯一方法是从 skydrive 帐户中嵌入东西。这不适合我的网站（我认为如果我们尝试的话我们会打破条款）所以我想知道是否有某种可用的 API。我还没有找到，但我想知道其他人有吗？

或者，在线预览 Microsoft 文档的最佳解决方案是什么？.. 是否有任何地方可用的库或工具包来做这种事情？是否有开放办公版的万维网应用程序？

干杯!

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:34:18.067

# web-services - 无法使用我可以使用两个浏览器窗口手动重现的工具 (jmeter) 重现情况

> ID：11836078
> 
> 赞同：2
> 
> 时间：2012-08-06T21:18:27.060
> 
> 标签：web-services, jmeter

我正在开发一个在线预订系统（细节与我的问题并不真正相关）。它主要是用 C# 和框架 4.0 开发的。我有一个数据库，其中包含产品和这些产品的可用性等内容。数据库由 Web 服务访问，后者由 Web 应用程序查询，然后将要显示的信息发送到浏览器。在架构方面没有什么太花哨的，但我对这种系统没有太多经验。这个项目很老了；它已经开发了几年，而我六个月前刚刚加入，之前没有网络编程经验。

我目前遇到并发问题。如果我打开两个浏览器窗口（任何浏览器），在两个窗口中输入相同的查询并尽可能快地在两个页面上发布，我的 Web 服务中会出现未处理的异常。一个客户端获取数据，另一个接收到错误。**编辑**：*另外，我同时使用两台不同的计算机进行了测试，但我仍然可以获得未处理的异常。*

我能够将问题追溯到大约一年前实施的缓存系统。没有锁定机制，缓存使用字典（不是线程安全的）。一些 Stack Overflow 问题帮助我查明了问题以及我应该如何纠正它（例如[这个](https://stackoverflow.com/questions/39112/what-is-the-best-way-to-lock-cache-in-asp-net)和[那个](https://stackoverflow.com/questions/4392956/pattern-for-concurrent-cache-sharing)）。

话虽如此，我正在尝试重现该问题，而无需手动单击两个浏览器窗口并希望获得同时访问相同缓存的正确时机。我试图这样做的原因是我不喜欢实施一个当我不能可靠地证明它确实有效时*应该有效的解决方案。*此外，有很多地方已经（糟糕地）实现了缓存，我不确定是否可以通过手动“猜测”正确的时间来测试所有这些地方。

因此，我下载了[Apache JMeter](http://jmeter.apache.org/)，并使用连接到我的两个浏览器的[Fiddler2](http://www.fiddler2.com/fiddler2/)，我可以找到创建发送完全相同请求的测试计划所需的所有 HTTP 请求。

但令我沮丧的是，即使我将线程组设置为创建 40 个并发用户，JMeter 也无法重现该问题！他们每个人都正确接收数据，并且没有一个会触发我手动执行的未处理异常。我知道这不是 cookie 问题，也不是用户代理的区别，因为我使用多个浏览器和禁用的 cookie 进行了测试。由于 HTTP 请求是直接从 Fiddler2 创建的，因此隐藏字段或 URL 重写应该不是问题，并且不涉及动态字段名称或内容。我知道 Fiddler2 有一个“重播”功能，但即使这样也无法重现问题。这让我百思不得其解。

所以，我的问题是：为什么我不能用 JMeter 重现问题？有没有比 JMeter 更好的工具（对于免费软件来说它非常完整）来做到这一点？Jmeter 不做的浏览器做了什么（除了渲染页面，这真的不是这里的问题）？

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:07:07.390

当您说 2 个 Windows 时，您确定他们使用 2 个会话，具体取决于浏览器和您打开第二个窗口的方式，您不会获得 2 个会话。

你确定你复制了浏览器和服务器之间的所有流量吗？

如果您有超过 1 个请求，那么您应该检查它是否不是来自浏览器的 2 个并行 Ajax 请求，如果是，您必须知道没有一些自定义脚本 jmeter 不会重现同一会话的 2 个并行请求（资源下载除外），那可能是你的问题。

问候

菲利普·M。

[http://www.ubik-ingenierie.com](http://www.ubik-ingenierie.com)

# android - android:noHistory="true" 是如何工作的？

> ID：11836080
> 
> 赞同：41
> 
> 时间：2012-08-06T21:18:43.427
> 
> 标签：android

假设我有一个带有菜单的基本活动，当我单击菜单项 A 时，它会转到活动 A。我再次打开菜单，然后转到 B。从 BI 回到 A，然后像这样返回和第四次一会儿。

所以堆栈将是 A，B，A，B，A，B，...。当我按下后退按钮时，它会按预期向后通过堆栈。

但是可以说我不想要这个功能，所以我添加到我的清单中，`android:noHistory="true"`. 因此，当我点击后退按钮时，它会退出应用程序而不是通过堆栈。

现在幻觉让它看起来，假设我在活动 A 中，我使用菜单并转到活动 B，堆栈将只是 B，因为我不能回到 A。

但是，当使用 时`noHistory="true"`，A、B、A、B、A、B 的真正堆栈是否存在？相反，是不是通过使用菜单实例化该活动的新副本而对活动的每次调用，但用户看不到它？这会导致资源问题吗？

或者什么时候`noHistory="false"`，后退按钮只是`startAcitvity(intent)`再次调用类似的东西还是遍历每个实例化的新副本？

我关心资源问题，而不是降低用户安卓设备的速度。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-06T21:33:04.240

来自关于的[文档](http://developer.android.com/guide/topics/manifest/activity-element.html)`noHistory`：

> “真”值意味着活动不会留下历史痕迹。它不会保留在任务的活动堆栈中，因此用户将无法返回它。

关于你的问题：

> A，B，A，B，A，B的真正堆栈存在吗？

文档会表明没有。

> 我关心资源问题，而不是降低用户安卓设备的速度。

你真的不需要担心这个。当内存变低时，操作系统应该处理活动的清理。在您的活动中不当使用位图或逻辑更有可能导致性能下降。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-04-18T07:50:32.480

android:noHistory=“true” 有效：-

假设您已经打开了“您的应用程序”。

您现在在主页活动中，

在它之后你去另一个（第二个）活动。从第二个活动你按下移动设备的主页按钮或打开其他一些应用程序。

现在，如果您再次打开“您的应用程序”，它将转到应用程序的主页，而不是转到您离开应用程序的活动（即第二个活动）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-19T05:54:26.260

我的应用程序中几乎没有碎片，并且在不进入我的应用程序的 Launcher Activity 的情况下按返回按钮似乎很难进入主屏幕。我在我的应用程序的启动器活动清单中使用了 android:noHistory="true" ，现在问题得到了解决。

# javascript - 用于检查文件扩展名的 Javascript If 语句不起作用

> ID：11836081
> 
> 赞同：2
> 
> 时间：2012-08-06T21:18:46.063
> 
> 标签：javascript, if-statement, operators, file-extension

我有一个表格，人们可以在其中输入文件路径。我想确保他们进入的路径指向图片，所以这就是我认为可行的方法。

```
function checkExt()
{
    var extension= /* I know that the code to cut the extension off of the file
                      is working correctly so for now let's just go with it ok */
    if(extension!="jpg" || "gif" || "bmp" || "png" || "whatever else")
        alert("The file extension you have entered is not supported");
} 
```

但这不起作用。我已将其跟踪到 if 语句，因为如果我只选择一种文件进行检查，那么它将正常工作。所以我问你的问题是，我到底要改变什么才能让这件事正常工作。我已经做了大约三个小时了，这让我发疯了。感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:20:54.907

这是语法和逻辑错误。它应该是：

```
if (extension != "jpg" && 
    extension != "gif" && 
    extension != "bmp" && 
    extension != "png" && 
    extension != "whatever else") {
    // This will execute when the extension is NOT one of the expected 
    // extensions.
} 
```

此外，您可以使用正则表达式更简洁地处理它：

```
if (!/jpg|gif|bmp|png|whatever/.test(extension)) {
    // This will execute when the extension is NOT one of the expected 
    // extensions.
} 
```

### 附录：

`extension`当 的值不是支持的值之一*时*，上面的示例执行 if 语句的主体。如果您想在值为`extensions`支持的值之一时执行 if 语句的主体，您可以将逻辑从不等于/和更改为等于/或，如下所示：

```
if (extension == "jpg" || 
    extension == "gif" || 
    extension == "bmp" || 
    extension == "png" || 
    extension == "whatever else") {
    // This will execute when the extension is one of the expected extensions.
} 
```

同样，使用正则表达式会更简洁：

```
// I just removed the leading ! from the test case.
if (/jpg|gif|bmp|png|whatever/.test(extension)) {
    // This will execute when the extension is one of the expected extensions.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:19:52.160

您应该使用`&&`而不是，`||`并且必须在每个条件上为`!=`运算符添加前缀`extension`，而不仅仅是第一个条件：

```
if (extension != "jpg" &&
    extension != "gif" &&
    extension != "bmp" && 
    extension != "png" &&
    extension != "whatever else") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:25:37.733

作为冗长的替代方法，使用正则表达式：

```
if (extension.search(/jpg|gif|bmp|png/) === -1) {
    alert("The file extension you have entered is not supported.");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:20:37.667

您需要在每个子句中包含要比较的参数。

```
if( extension != "jpg" || 
    extension != "gif" || 
    extension != "bmp" || 
    extension != "png" || 
    extension != "whatever else"){
 //TODO: handle condition
} 
```

正如其他人所指出的，这是一个逻辑错误，因为如果“jpg”是扩展名，则条件仍然会被命中，因为“jpg”！=“gif”。您可能要考虑使用`&&`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:23:33.953

您必须比较`extension`每个测试扩展的变量。一种紧凑的方法是：

```
var extension = whatever;
var supportedExtensions = ["jpg","gif","bmp","png",... whatever else];
if (supportedExtensions.indexOf(extension) < 0) alert("Unsupported extension"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-06T21:51:28.327

其他答案向您展示了多重比较的 javascript 逻辑是如何错误的。但是，更好的方法是使用这样的 javascript 映射：

```
function checkExt() {
    var allowedExtensions = {
        "jpg": true, "gif": true, "bmp": true, "png": true, "whatever else":true
    };
    var extension= /* I know that the code to cut the extension off of the file
                      is working correctly so for now let's just go with it ok */
    if (allowedExtensions[extension] !== true) {
        alert("The file extension you have entered is not supported");
    }
} 
```

只需向对象添加/删除项目即可更容易维护`allowedExtensions`。

# c# - 生成序列化程序后无法更改类型

> ID：11836090
> 
> 赞同：0
> 
> 时间：2012-08-06T21:19:31.907
> 
> 标签：c#, .net, protobuf-net

以下代码尝试使用其接口序列化项目并反序列化：

```
class Program
{
    static void Main()
    {
        Item item = new Item { A = 123321 };

        using (MemoryStream ms = new MemoryStream())
        {
            Serializer.Serialize(ms, item);
            ms.Position = 0;
            Serializer.Deserialize<IItem>(ms);
        }
    }
}

[ProtoContract(SkipConstructor = true)]
[ProtoInclude(100, typeof(Item))]
public interface IItem
{
    int A { get; set; }
}

[ProtoContract(SkipConstructor = true)]
public class Item : IItem
{
    [ProtoMember(1)]
    public int A { get; set; }
} 
```

尝试反序列化项目时引发以下异常：

```
The type cannot be changed once a serializer has been generated for Test.Item (Test.IItem)
   at ProtoBuf.Meta.RuntimeTypeModel.GetKey(Type type, Boolean demand, Boolean getBaseKey) in C:\Dev\protobuf-net\protobuf-net\Meta\RuntimeTypeModel.cs:line 388
   at ProtoBuf.Meta.RuntimeTypeModel.GetKeyImpl(Type type) in C:\Dev\protobuf-net\protobuf-net\Meta\RuntimeTypeModel.cs:line 362
   at ProtoBuf.Meta.TypeModel.GetKey(Type& type) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 982
   at ProtoBuf.Meta.TypeModel.DeserializeCore(ProtoReader reader, Type type, Object value, Boolean noAutoCreate) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 576
   at ProtoBuf.Meta.TypeModel.Deserialize(Stream source, Object value, Type type, SerializationContext context) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 506
   at ProtoBuf.Meta.TypeModel.Deserialize(Stream source, Object value, Type type) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 488
   at ProtoBuf.Serializer.Deserialize[T](Stream source) in C:\Dev\protobuf-net\protobuf-net\Serializer.cs:line 69
   at Test.Program.Main() in ... 
```

有什么想法/解决方法吗？谢谢！

# haskell - Haskell 重构建议

> ID：11836096
> 
> 赞同：2
> 
> 时间：2012-08-06T21:20:12.560
> 
> 标签：haskell, functional-programming, refactoring

我正在寻找有关以下代码的一些重构/最佳实践建议。我想尽量避免扩展，同时为互斥的不同“版本”维护单独的模块。我目前的解决方案是使用一个类并使用存在量化为每个`CountrySets`.

如果我使用 OOP，这对我来说很容易完成，但我还不能考虑“功能性”。

谢谢你的时间。

**省份.hs**

```
{-# LANGUAGE ExistentialQuantification, RankNTypes  #-}
module Province where

  class Country a where
    --some stuff that is not important

  data Power = 
    forall a. (Show a, Eq a, Country a) => Power a |
    Netural |
    Water

  data Unit = Unit {
    power  :: forall a. (Show a, Eq a, Country a) => a, 
    piece :: Piece

  data Piece = Tank | Plane

  data Province = Province {
    power  :: Power,
    provName :: String
  } deriving (Eq)

  instance Show Power where
    show (Power b) = "Power " ++ show b
    show (Netural) = "Netural"
    show (Water) = "Water"

  instance Eq Power where
    (==) a b = Prelude.show a == Prelude.show b 
```

**版本1.hs**

```
import Province

  data CountrySet1 =
    Country11 |
      Country12 
    deriving (Eq, Show)
  instance Country CountrySet1 where

  provs = 
    one1:one2:[]

  one1 = Province (Power Country11) "Place11"
  one2 = Province (Power Country12) "Place12" 
```

**版本2.hs**

```
import Province

  data CountrySet2 =
    Country21 |
    Country22 
      deriving (Eq, Show)
  instance Country CountrySet2 where

  provs = 
    two1:two2:[]

  two1 = Province (Power Country11) "Place21"
  two2 = Province (Power Country12) "Place22" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T23:07:25.677

您不必在数据类型中放置类约束。您可以改为在`a`变量上参数化您的数据类型，以便您可以将约束放在类型类实例本身上，如下所示：

```
-- Note that I added a type variable to "Power"
data Power a = Power a | Neutral | Water

instance (Show a) => Show (Power a) where ...

instance (Eq a) => Eq (Power a) where ... 
```

...或者你可以做大多数人做和使用的事情`deriving`：

```
data Power a = Power a | Neutral | Water deriving (Eq, Show) 
```

这会生成与您编写的完全相同的实例（除了`Eq`一个将比您编写的更有效）。无需扩展！

那么如果你想`a`成为一个特定的类型，你就这么说吧！

```
-- Version1.hs
myValue1 :: Power CountrySet1
myValue1 = ...

-- Version2.hs
myValue2 :: Power CountrySet2
myValue2 = ... 
```

然后它们是完全兼容的，并且两种实现可以相互共存。

# python - 使用 Ctrl + A 选择文本框 Selenium RC 中的所有文本

> ID：11836100
> 
> 赞同：8
> 
> 时间：2012-08-06T21:20:21.617
> 
> 标签：python, selenium

我正在尝试选择文本框中的所有文本以清除文本框。我正在使用 Ctrl+A 在 Windows 7 firefox 上的 Selenium RC 独立 2.20.0.jar 服务器上使用以下 Python 2.7 代码来执行此操作：

```
from selenium import selenium
s = selenium('remote-machine-ip', 4444, '*chrome', 'http://my-website-with-textbox')
locator = 'mylocator-of-textbox'
s.open()
s.type(locator, 'mytext')
s.focus(locator)
s.control_key_down()
s.key_down(locator, "A")
s.key_press(locator, "A")
s.key_up(locator, "A")
s.control_key_up()

# Nothing happens here... I cannot see the text getting selected...

# Nothing gets cleared here except the last char
s.key_down(locator, chr(8))  # Pressing backspace
s.key_press(locator, chr(8))
s.key_up(locator, chr(8)) 
```

有什么帮助吗？谢谢，阿米特

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-06T21:39:40.517

我在 WebDriver 中使用 clear() 没有任何麻烦......

```
el = self.selenium.find_element_by_name(name)
el.clear() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T05:58:03.673

在 Selenium RC 中，只需使用以下命令清除文本框

> selenium.type("someLocator", "");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T09:54:31.863

先尝试使用

```
element.click() 
```

然后使用元素

```
element.clear() 
```

它可能会解决您的问题，因为它确实解决了我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-15T03:29:18.210

你可以这样做：

```
 public void selectAll(WebElement element) {
    String selectAll = Keys.chord(Keys.CONTROL, "a");
    element.sendKeys(selectAll);
} 
```

当你想使用它时，例如：

```
 selectAll(myDriver.findElement(By.id("testId"))); 
```

在此示例中，WebElement 可以是文本框、文本区域等。

# jquery - 如果其他 div 为空，则更改 div 类名

> ID：11836101
> 
> 赞同：1
> 
> 时间：2012-08-06T21:20:32.037
> 
> 标签：jquery

嗨希望有人可以帮助解决这个问题：

我基本上想要的是，当 div introtext 为空时，它必须隐藏 div 并将父 div（grid-6）更改为 class=grid-12。我似乎无法完成这项工作！这是我所拥有的（示例代码）：

> **HTML**

```
<div class=header>
    <img src="[[DTIMAGE]]" alt="inuit.css logo">
</div>
<h1 style="font-size:10px;">[[TITLE]]</h1>
<div class=grids>
    <div class=grid-12>
        [[FULLTEXT]]
    </div><!-- /grid-6 -->
</div><!-- /grids -->
<hr>
<div class=grids>
    <div class=grid-6>
        [[FULLTEXT]]
    </div><!-- /grid-6 -->
    <div class=grid-6>
        <div class="introtext"></div>
    </div><!-- /grid-6 -->
</div><!-- /grids -->
<hr>
<div class=footer>
    [[FOOTER]]
</div> 
```

> **脚本**[*使用 jQuery 1.7.2* ]

```
$(document).ready(function(){
    if ($(".introtext").text() === ""){
        $(".introtext").hide();
    }
}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:24:47.720

如果我理解正确，那么我建议：

```
$('.introtext').each(
    function() {
        if (!$(this).text()) {
            $(this).hide().parent().toggleClass('grid-6 grid-12');
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/P45cU/)。

如 OP 的评论中所述，上述代码已重新设计以考虑对要求的更改：

> 我完全错了（挖掘太多以使其正常工作）事实是，如果 div introtext 为空，则 div grid-6（[[FULLTEXT]] 所在的位置）应更改为 div=grid-12

```
$('.introtext').each(
    function() {
        if (!$(this).text()) {
            $(this).hide().parent().prev().toggleClass('grid-6 grid-12');
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/P45cU/1/)。

复述以上内容：

```
$('.grid-6').filter(
    function(){
        var introtextEl = $(this).next('.grid-6').find('.introtext');
        return introtextEl.length && !introtextEl.text()
    }).toggleClass('grid-6 grid-12'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/P45cU/3/)。

上面的代码（最新的代码块），有效地查看了选择器返回的*所有*元素，并根据两个条件过滤它们，首先：如果有一个类的后续元素和一个类`grid-6`的子元素`introtext`（jQuery选择器总是返回一个数组，因此`.length`检查），第二：如果找到`.introtext`的元素没有文本内容。

如果这些条件都为真，则返回当前评估的元素（以及条件为真的所有元素）以由该`toggleClass()`方法执行。

参考：

*   [`each()`](http://api.jquery.com/each/).
*   [`filter()`](http://api.jquery.com/filter/).
*   [`find()`](http://api.jquery.com/find/).
*   [`hide()`](http://api.jquery.com/hide/).
*   [`next()`](http://api.jquery.com/next/).
*   [`parent()`](http://api.jquery.com/parent/).
*   [`prev()`](http://api.jquery.com/prev/).
*   [`text()`](http://api.jquery.com/text/).
*   [`toggleClass()`](http://api.jquery.com/toggleClass/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:24:52.510

您可以使用**[`:empty`](http://api.jquery.com/empty-selector/)**选择器：

```
if ( $(".introtext").is(':empty') ){
      $(".introtext").hide().parent().attr('class', 'grid-12')
} 
```

如果您有多个元素的类，`introtext`则可以使用以下`each`方法：

```
$('.introtext').each(function(){
    if ( $(this).is(':empty') ){
          $(this).hide().parent().attr('class', 'grid-12')
    }
}) 
```

* * *

```
$('.girds div').each(function(){
    if ( $(this).text() == '[[FULLTEXT]]'){
          $(this).attr('class', 'grid-12')
    }
}) 
```

# mysql - 跨 MySQL 表

> ID：11836104
> 
> 赞同：0
> 
> 时间：2012-08-06T21:20:43.747
> 
> 标签：mysql

我觉得这是我可以搜索的东西，但我不知道正确的术语。

我有一个有几个表的 SQL 数据库。一张表存储软件电话的呼叫者日志 (agent_log)，一张表存储软件电话上的人正在呼叫的活动信息 (活动)。两个表都有我可以用来互相调用的列“campaign_id”（我认为）。我需要关联这两个表，以便我可以有一个看起来像的 sql 查询

```
SELECT * FROM agent_log WHERE active = 'Y'; 
```

显然它不起作用，因为该表中不存在“活动”列，它存在于活动表中。有什么简单的方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:23:37.910

您正在尝试做的事情称为 a`JOIN`您将`JOIN`使用它们之间共有的字段来使用表，因此对于您的表来说，它将是`campaign_id`.

```
SELECT *
FROM agent_log al
INNER JOIN campaigns c
    ON al.campaign_id = c.campaign_id
WHERE c.active = 'Y' 
```

或者

```
SELECT *
FROM agent_log al
INNER JOIN campaigns c
    ON al.campaign_id = c.campaign_id
    AND c.active = 'Y' 
```

我建议您阅读有关`JOIN`s 的内容。 [连接的视觉解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)是一个很好的开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:23:39.390

```
SELECT * 
FROM agent_log 
INNER JOIN campaigns ON agent_log.campaign_id = campaigns.campaign_id 
WHERE campaigns.active = 'Y'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:31:02.213

idcampaign_id 存在于两个表中，并假设表之间存在关系，您可以加入它们：

```
SELECT agent_log.campaign_id
FROM agent_log, campaigns
WHERE agent_log.campaign_id = campaigns.campaign_id 
      AND campaigns.active = 'Y' 
```

如果您喜欢使用 JOIN，我建议您花一些时间来学习它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:24:59.903

您只需要像这样使用 JOIN 查询

```
SELECT al.*
FROM agent_log as al
INNER JOIN campaigns as c
ON al.campaign_id = c.campaign_id
WHERE c.active = 'Y'; 
```

您需要确保已在两个表上的campaign_id 字段和活动表中的活动字段上建立索引，以使查询高效运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:26:28.710

这应该在没有内部连接的情况下工作

```
SELECT 
    agent_log.campaign_id 
FROM 
    agent_log,
    campaigns 
WHERE 
    agent_log.campaign_id = campaigns.campaign_id
AND
    campaigns.active = 'Y'; 
```

# yii - yii 使用多个主题

> ID：11836107
> 
> 赞同：5
> 
> 时间：2012-08-06T21:20:47.953
> 
> 标签：yii

我想为访客和管理员用户设置至少两个不同的主题。可以选择为不同类型的用户设置不同的主题也很方便。例如，高级用户对访客和管理员的看法会有所不同。

当我尝试在 /config/main.php 中进行以下操作时：

```
'theme'=>(Yii::app()->user->isGuest)?'bluebox':'classic', 
```

它总是评估为假。我猜引擎还没有初始化。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-07T05:11:12.310

您不能在 config.php 文件中配置多个主题，您可以在控制器中执行此操作。

```
public function init()
{
   if(Yii::app()->user->isGuest)
      Yii::app()->theme = 'bluebox';
   else
      Yii::app()->theme = 'classic';

   parent::init();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T00:42:40.633

这是有关如何即时更改主题的主题：

[http://www.yiiframework.com/forum/index.php/topic/29619-changed-theme-on-the-fly/](http://www.yiiframework.com/forum/index.php/topic/29619-changing-theme-on-the-fly/)

# wpf - 保证金最佳实践

> ID：11836114
> 
> 赞同：0
> 
> 时间：2012-08-06T21:21:14.757
> 
> 标签：wpf, xaml, layout, margin

如果我有一个包含许多元素的 Horizo​​ntal StackPanel，它们之间的边距不同：

如果我给每个元素一个左边距，或者给每个第二个元素一个左右边距，有什么区别吗 - 这样只有一个元素设置了它的边距属性。

```
<StackPanel Orientation="Horizontal">
<TextBlock Name="textblock1" />
<TextBlock Name="textblock2" Margin="5,0,0,0" />
<TextBlock Name="textblock3" Margin="10,0,0,0" />
...
</StackPanel> 
```

或者

```
<StackPanel Orientation="Horizontal">
<TextBlock Name="textblock1" />
<TextBlock Name="textblock2" Margin="5,0,10,0" />
<TextBlock Name="textblock3" />
...
</StackPanel> 
```

我只是想知道是否有关于此的最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:34:56.617

如果每个元素的 Margin 都相同，则可以将其分解为样式：

```
<StackPanel Orientation="Horizontal">
   <StackPanel.Resources>
      <Style TargetType="TextBlock>
         <Setter Property="Margin" Value="5,0,0,0" />
      </Style>
   </StackPanel.Resources>
   <TextBlock Name="textblock1" />
   <TextBlock Name="textblock2" />
   <TextBlock Name="textblock3" />
   ...
</StackPanel> 
```

除此之外没有任何区别。

# sql-server - T-SQL 触发器导致阻塞

> ID：11836115
> 
> 赞同：0
> 
> 时间：2012-08-06T21:21:15.453
> 
> 标签：sql-server, sql-server-2008, tsql, locking, blocking

帮助！以下触发器在执行后会导致阻塞：

```
USE [Automation]
GO
/****** Object:  Trigger [dbo].[AfterInsertSendEmail]    Script Date: 08/06/2012 22:05:54 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      Chris Cannon
-- Create date: 20120806
-- Description: TBC
-- =============================================
ALTER TRIGGER [dbo].[AfterInsertSendEmail] 
   ON  [dbo].[Enquiry] 
   AFTER INSERT
AS 
BEGIN;
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Insert statements for trigger here
    DECLARE @l_profile_name nvarchar(128) = 'Automation Enquiries';
    DECLARE @l_importance varchar(6) = 'High';
    DECLARE @l_sensitivity varchar(12) = 'Personal';
    DECLARE @l_recipients varchar(500) = 'a.n.other@somewhere.co.uk';
    DECLARE @l_copy_recipients varchar(500) = 'b.n.other@somewhere.co.uk';
    DECLARE @l_blind_copy_recipients varchar(500) = 'c.n.other@somewhere.co.uk';
    DECLARE @l_reply_to varchar(500) = (SELECT [EmailAddress] FROM [inserted]);
    DECLARE @l_subject nvarchar(255) = (SELECT 'New Enquiry From ' + [FirstName] + ' ' + [LastName] FROM [inserted]);
    DECLARE @l_body nvarchar(500) = 'TBC';
    DECLARE @l_query nvarchar(500) = 'SELECT TOP(1) * FROM [Automation].[dbo].[Enquiry] ORDER BY [Id] DESC';
    DECLARE @l_query_result_separator char(1) = CHAR(9);
    DECLARE @l_query_result_no_padding bit = 1;
    DECLARE @l_attach_query_result_as_file bit = 1;
    DECLARE @l_query_attachment_filename nvarchar(260) = (SELECT 'automation_enquiry_' + REPLACE(REPLACE(REPLACE(CONVERT(nvarchar(19), [DateSubmitted], 120), '-', ''), ' ', ''), ':', '') + '.csv' FROM [inserted]);
    DECLARE @l_append_query_error bit = 1;

    EXEC [msdb].[dbo].[sp_send_dbmail]
          @profile_name = @l_profile_name
        , @importance = @l_importance
        , @sensitivity = @l_sensitivity
        , @recipients = @l_recipients
        , @copy_recipients = @l_copy_recipients
        , @blind_copy_recipients = @l_blind_copy_recipients
        , @reply_to = @l_reply_to
        , @subject = @l_subject
        , @body = @l_body
        , @query = @l_query
        , @query_result_separator = @l_query_result_separator
        , @query_result_no_padding = @l_query_result_no_padding
        , @attach_query_result_as_file = @l_attach_query_result_as_file
        , @query_attachment_filename = @l_query_attachment_filename
        , @append_query_error = @l_append_query_error;

END; 
```

据我所知，它看起来像这条线：

```
DECLARE @l_query nvarchar(500) = 'SELECT TOP(1) * FROM [Automation].[dbo].[Enquiry] ORDER BY [Id] DESC'; 
```

可能会阻塞某些东西或触发器本身会阻塞该语句。

我已经尝试了几件没有运气的事情。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:24:35.653

尝试使用“WITH（NOLOCK）”

```
SELECT TOP(1) * FROM [Automation].[dbo].[Enquiry] WITH (NOLOCK) ORDER BY [Id] DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:52:03.017

好吧，您正处于事务的中间，因此至少该行被锁定，然后您发送邮件，邮件在您锁定的同一张表上运行选择顶部...

您可以按照 losbear 的建议尝试 nolock ，但是看到您正在运行的查询可能是为了显示您刚刚插入的记录的详细信息，并且您已经在触发器中插入了可用的记录，为什么还要打扰 @query 呢。

就我个人而言，我从不喜欢在交易过程中发送邮件的想法。我宁愿将请求排队，提交事务，然后让一些“服务”进行邮寄。不过，这将是更多的工作。

# ios - 使用 ABPeoplePickerNavigationController 的委托

> ID：11836119
> 
> 赞同：1
> 
> 时间：2012-08-06T21:21:26.187
> 
> 标签：ios, delegates, uitabbarcontroller

我需要在 UITabBarController 中管理一个 ABPeoplePickerNavigationController（我不想以模态方式显示 ABPeoplePickerNavigationController，因为我想让标签栏保持可见）。然后我使用这段代码来设置 UITabBarController：

AppDelegate.m 文件：

```
#import "PickerDelegate.h"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    ABPeoplePickerNavigationController *contacts = [[ABPeoplePickerNavigationController alloc] init];
    PickerDelegate *pickerDel = [[PickerDelegate alloc] init];
    contacts.delegate = pickerDel;

    NSArray *aViewControllers = [NSArray arrayWithObjects:xvc, contacts, yvc, zvc, nil];

    UITabBarController *tabBarController = [[UITabBarController alloc] init];
    [tabBarController setViewControllers:aViewControllers];
    [xvc release];
    [contacts release];
    [yvc release];
    [zvc release];

    [window setRootViewController:tabBarController];
    [tabBarController release];
    [self.window makeKeyAndVisible];

    return YES;
} 
```

PickerDelegate.h 文件

```
#import <Foundation/Foundation.h>
#import <AddressBook/AddressBook.h>
#import <AddressBookUI/AddressBookUI.h>

@interface PickerDelegate : NSObject <UINavigationControllerDelegate, ABPeoplePickerNavigationControllerDelegate>

@property (nonatomic, assign) PickerDelegate *delegate;

-(void)peoplePickerNavigationControllerDidCancel:(ABPeoplePickerNavigationController *)peoplePicker;
-(BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person;
-(BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person property:(ABPropertyID)property identifier:(ABMultiValueIdentifier)identifier;

@end 
```

最后是 PickerDelegate.m 文件：

```
#import "PickerDelegate.h"

@implementation PickerDelegate

@synthesize delegate = _delegate;

#pragma mark ABPeoplePickerNavigationControllerDelegate methods

// Displays the information of a selected person
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person
{
     NSLog(@"shouldContinueAfterSelectingPerson");

     //...
     return YES;
}

- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person property:(ABPropertyID)property identifier:(ABMultiValueIdentifier)identifier
{
    NSLog(@"shouldContinueAfterSelectingPerson");

    //...
    return NO;
}

-(void)peoplePickerNavigationControllerDidCancel:(ABPeoplePickerNavigationController *)peoplePicker
{
    NSLog(@"peoplePickerNavigationControllerDidCancel");

     //...
}
@end 
```

但它不起作用，我的方法没有被调用。什么不见​​了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T08:41:03.057

ABPeoplePickerNavigationController 的委托属性是**peoplePickerDelegate**而不是**委托**

这样做以使其工作..

```
contacts.peoplePickerDelegate = pickerDel; 
```

# mysql - 在 Drupal 7 中，如何在不丢失节点引用的情况下将术语从一个词汇表移动到另一个词汇表？

> ID：11836127
> 
> 赞同：2
> 
> 时间：2012-08-06T21:22:19.197
> 
> 标签：mysql, drupal-7, taxonomy, term, vocabulary

我继承了一个具有非常大的分层分类法的站点：

```
Vocabulary name: categories
--term: company name
---- many child terms
-- term: country
---- many child terms
-- term: issue
---- many child terms 
```

我意识到如果我将这些父术语中的每一个都设置为它们自己的词汇表，那么创建具有适当内容的搜索方面和视图会更容易：

```
company
country
issue 
```

所以我创建了新的词汇表并使用[分类管理器](http://drupal.org/project/taxonomy_manager/)将所有子术语转移到他们的新词汇表中。然后我更新了 Article 节点内容类型以与这 3 个词汇表相关联。

不幸的是，我还注意到文章节点（全部 4,000 个）之间的术语关系，并且现在显示中丢失了术语。我认为这种关系将由分类管理器模块维护。

我一直在寻找一种方法来更新文章节点的词汇表引用，但我仍然不确定词汇表是如何与节点关联的。我看到为每个新词汇表创建了新的 field_data_field_vocabulary-machine-name 表 - 这是 termID 和节点/实体 ID 相关联的地方。但是，当我将术语从一个词汇表移动到另一个词汇表时，我不知道如何自动更新节点的词汇表。

我最近将该站点从 Drupal 6 移到了 7，因此 D6 中的大量死表使数据库变得混乱，这无济于事。

--

我现在已经设置了一个新的标准 D7 安装，并且正在查看 db 默认表，试图找出定义词汇/节点关系的位置。在我的旧数据库上，TermID 似乎仍然与节点表中的节点正确关联......但我看不到 VocabularyID/TermID/NodeID 的存储/更新位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T13:38:00.950

请尝试这个模块：[http ://drupal.org/project/taxonomy_manager](http://drupal.org/project/taxonomy_manager)

该模块为管理分类提供了一个强大的界面。词汇表显示在动态树视图中，其中父术语可以展开以列出其嵌套的子术语，也可以折叠。

分类管理器具有以下操作和主要功能：

动态树视图 大量删除 大量添加新术语 在层次结构中移动术语 合并术语（使用 7.x 中的术语合并模块） 使用上下箭头快速改变权重（以及 AJAX 保存） AJAX 驱动的术语编辑表单简单的搜索界面 CSV导出术语 i18n 支持多语言词汇（每个语言术语） 双树界面用于在层次结构中移动术语、添加新翻译和在不同词汇之间切换术语 要使用分类管理器，您应该在浏览器中启用 JavaScript 并自动加载图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T13:28:40.800

*-> 但我仍然不确定词汇表是如何与节点关联的*

在 Drupal 7 中，分类引用的完成方式与在 Drupal 6 中非常不同。如果要将词汇表与 Drupal 7 中的节点相关联，则必须将该术语添加为内容类型的字段：

1.  转到管理/结构/类型/管理/文章/字段，您可以在其中添加/删除/修改您的文章内容类型的字段
2.  添加一个新字段，将其命名为您喜欢的任何名称，并确保从下拉列表中选择类型“术语参考”
3.  确保你选择了正确的词汇来从中提取
4.  对剩余的两个词汇表重复此步骤（再添加两个字段）。
5.  转到 admin/structure/types/manage/article/display 并修改是否希望这些新字段显示在节点上或隐藏

=============== 加法==================

在 Drupal 7 中，由于术语与任何其他字段一样，您将在存储信息的新创建表中看到数据库中的关系（当然，只有在您将适当的术语引用字段添加到内容类型后）关于那个领域。例如，默认情况下，Drupal 7 附带的标准“标签”词汇表可能称为 field_data_field_tags。在该表中，您将看到列**entity_id**（即节点的 id）和**field_tags_id**（即术语的 id），但对于您的特定术语，该列可能具有不同的名称。因此，对于每个术语与节点的关系，您将拥有三个单独的表，因为它们将是 Drupal 7 中的三个单独的字段。

这会帮助更多吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-20T18:56:08.967

我觉得你应该 ：

1.  创建新词汇
2.  添加具有对新词汇表的术语引用的字段
3.  将内容类型与新词汇表连接后，您应该将术语移至新位置

我测试过，它适用于这个订单。

# css - Bootstrap 最小宽度网格

> ID：11836131
> 
> 赞同：17
> 
> 时间：2012-08-06T21:22:41.653
> 
> 标签：css, twitter-bootstrap

使用 twitter bootstrap 使用流动的行设置我有

```
<div class="row-fluid">
    <div class="span4">...</div>
    <div class="span8">...</div>
</div> 
```

我想要的是给第一个 div（类 span4）一个 275px 的最小宽度，而不会打乱第二个的布局。我试过只是添加`min-width: 275px`，但这会使第二个 div 移到下一行。有没有办法正确地做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T21:28:16.383

```
<div class="row-fluid">
    <div class="span4" style="min-width: 275px">...</div>
    <div class="span8">...</div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

为我工作。只有当第二个 div 的屏幕空间小于约 66% 时，它才会将第二个 div 移动到新行。

[http://jsfiddle.net/daniilr/DAw6p/embedded/result/](http://jsfiddle.net/daniilr/DAw6p/embedded/result/)（[获取代码](http://jsfiddle.net/daniilr/DAw6p/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-02T18:05:35.253

我也有类似的问题。我尝试用 css 和 bootstrap 解决这个问题。但我找不到解决方案。所以我用jQuery解决了这个问题。

## 我的情况

```
<div id="text" class="col-sm-3 col-sm-offset-2" style="min-width: 320px"></div>
<div id="image" class="col-sm-7" ></div> 
```

当窗口宽度变窄时，`#image`将移动到下一行。因为`#text`宽度不能再从 320px 松动了。所以`#image`不能占据它的宽度，而不得不移动下一行。

## 我是如何解决的

计算`#image`每个窗口大小的宽度。而 CSS 不适合这项工作。所以我应该使用jQuery。

```
$(window).ready(function() {
    resizeImageWidth();
});

$(document).ready(function() {
    $(window).resize(function() {
        resizeImageWidth();
    });
});

var resizeImageWidth = function() {
    var text_minwidth = parseInt($('#text').css('width'));
    var text_marginLeft = parseInt($('#text').css('margin-left'));
    var image_marginLeft = parseInt($('#image').css('margin-left'));

    if ($(window).width() > 768) {
        var image_width = $(window).width() - (text_marginLeft + text_minwidth + image_marginLeft + 32);
        $('#image').width(image_width);
        console.log(image_width);
    } else {
        $('#image').width('');
    }
} 
```

`resizeImageWidth`函数将获得`#text`宽度、左边`#image`距、左边距等等。当然它不适合你的代码。我应该减去这些东西。请检查我减去了什么。

渲染后`div`仍然可以移动到下一行。也许缺少一些元素。所以我`30px`几乎不减。但是这个计算还是有误差的。所以可以以一定宽度`div`移动下一行。`window`所以我应该再减去**2px**来防止它。理想情况下，我应该进行更精确的计算。

在小型显示器中，不需要这种计算。所以`if ($(window).width() > 768)`是需要的。这个函数应该加载在`$(window).ready`. 如果你加载`$(document).ready`，那么 CSS 属性是不完整的。所以计算误差更大。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-02-12T21:40:07.593

Bootstrap 列是弹性项目。您必须决定当其他列达到最小宽度时应该缩小的一列。这可以防止元素移动到下一行。

[这是我制作的漂亮代码笔： https](https://codepen.io/timar/pen/VQWmQq/) ://codepen.io/timar/pen/VQWmQq/

在这种情况下，我们取另一个跨度，将其减少到 span1。给它 flex-grow ，我们必须覆盖引导程序的 max-width 属性。

```
<div class="row-fluid">
    <div class="span4 style="min-width: 275px;">...</div>
    <div class="span1 style=" flex-grow: 1; max-width:100%; "">...</div>
</div> 
```

为了安全起见，您可以根据需要减少第二个跨度。即 span6 。将最大宽度调整为正常跨度的数量，我们有 span8 100/12*8 = 66.66%

# android - 查看主线程启动前的布局

> ID：11836132
> 
> 赞同：0
> 
> 时间：2012-08-06T21:22:41.637
> 
> 标签：android

我是 android 的新手，所以请不要为这个问题向我扔石头，但我已经经历了很多线程并且没有找到或者哪个更可能不理解答案。

我有主要的活动，应该在第一次开始从互联网上下载基本数据和图像。加载我在单独线程上的图像，因此它不会减慢启动速度。但是主要数据（一些文本和图像链接）也需要一些时间。

我的问题是我的 onCreate 活动在所有变量初始化 setContentView(R.layout.main); 然后检查缓存文件是否存在，如果没有创建它们并将日期下载到它们中（一切正常）......但布局显示在所有代码完成后！我在代码开始时尝试了progressBar，我尝试了分离线程并加入主线程，但在线程中的代码完成之前，屏幕始终保持空白（仅带有标签）。我认为我的问题是可以理解的，可能很愚蠢，并且不需要我的代码。

我想要的是......在应用程序启动后立即显示初始化布局，在完成最重要和最基本的任务以显示内容布局......然后我将处理一些延迟加载的图像（如一旦我理解它）。

所以对我来说最重要的是在执行任何代码之前强制显示一些东西......

感谢您的简单回答。

好的，这是我的 onCreate 代码。问题是，我想在应用程序启动后立即显示 layout.init（会有类似 - “第一次启动时请稍候......”）并且在下载基本数据并保存到 sdcard 以显示布局.主...

请忽略条款标签和与之相关的所有内容（仅限新闻标签）

```
 @Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    context = this;
    setContentView(R.layout.init);

    newsListView = (ListView) findViewById(R.id.novinky);
    termsListView = (ListView) findViewById(R.id.terminovka);

    File data_dir = new File(Environment.getExternalStorageDirectory() + "/" + Data.DATA_DIR);
    FileUtilities.DeleteRecursive(data_dir);

    if(!checkDataFiles()){
        createDataFiles();
        try {
            updateDataFiles(Data.NEWS_ONPAGE);
        } catch (IOException e) {
            // TODO Auto-generated catch block
                e.printStackTrace();
        }

    }

    imagesLoadingThread.start();

            setContentView(R.layout.main);

    newsVals = MyFunctions.readNewsData(Data.NEWS_ONPAGE);

    newsListView.setOnItemClickListener(new OnItemClickListener(){
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

          Bundle bundle = new Bundle();
          bundle.putLong("id", id);
          Intent newActivity = new Intent(view.getContext(),NewsActivity.class);
            newActivity.putExtras(bundle);
            startActivity(newActivity);               
          }                 
    });

    newsListView.setAdapter(new NewsAdapter(context, newsVals));        

    termsVals=MyFunctions.connectArrayValues(items, items, "#");
    termsVals=MyFunctions.connectArrayValues(termsVals, descrs, "#");

    termsListView.setAdapter(new TermsAdapter(context, termsVals)); 

    final TabHost tabs=(TabHost)findViewById(R.id.tabhost);

    tabs.setup();

    TabHost.TabSpec spec=tabs.newTabSpec("newstab");
    spec.setContent(R.id.novinky);
    spec.setIndicator(getText(R.string.news));
    tabs.addTab(spec);

    TabHost.TabSpec spec2=tabs.newTabSpec("termstab");
    spec2.setContent(R.id.terminovka);
    spec2.setIndicator(getText(R.string.terms));
    tabs.addTab(spec2); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:28:40.967

你走在正确的轨道上。每当某件事需要很长时间时，您都想在单独的线程上进行。问题似乎是您尝试将线程加入主线程。如果你加入线程，它会导致你的主线程停止处理，直到加入的线程完成。

我的建议是在 onCreate 方法中创建一个[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)并将所有繁重的处理放在 AsyncTask doInBackground 方法中。AsyncTask 有一个后台线程，并且还具有内置功能，可帮助将更新从后台线程发送到主线程，而不会冻结您的 UI。

# c# - Entity Framework 4 与非键列/字段和不同列/字段名称的关联

> ID：11836133
> 
> 赞同：4
> 
> 时间：2012-08-06T21:22:42.213
> 
> 标签：c#, entity-framework-4, associations, one-to-many

我正在使用 EF4 构建一个连接到旧数据库（无法修改）的新服务。

（这个 BD 似乎是由一个 DB 天才建造的，你会看到……脏活，我知道，但我必须这样做）

基本上，我有两个表（**SegurosPassageiros**和**LocsPassageiros**），它们的键以常规方式与其他表关联。如以下模型所示，它们与 PK/FK 没有物理关联，但它们由非键列“ **SegurosPassageiros.CodPassageiro** ”和“ **LocsPassageiros.CodLocPassageiroInterno** ”链接。此外，此关联是一对多的：

*LocsPassageiros 1...* * *SegurosPassageiros*

我找到了许多与非键关联相关的答案，但在同一场景中并非非键和不同名称。

表格：

```
 LocsPassageiros 
 ----------------------------------
 CodLocPassageiro (PK)   | int
 Nome                    | varchar
 CodLocPassageiroInterno | int
 ----------------------------------

 ----------------------------------
 SegurosPassageiros
 ----------------------------------
 CodSeguroPassageiro(PK)  | int
 CodPassageiro            | int
 ---------------------------------- 
```

代码（类“SeguroPassageiro”映射到表“SeguroPassageiros”）：

```
public class SeguroPassageiro
{
    [Key]
    public Int32 CodSeguroPassageiro { get; set; }

    .... (other fields)

     //tried this, no success
    //[ForeignKey("Passageiro")]
    public virtual Int32 CodLocPassageiroInterno { get; set; }

     //tried this annotation with no success
    [Association("Passageiro_Seguros", "CodPassageiro", "CodLocPassageiroInterno")]
    public virtual Passageiro Passageiro { get; set; }
} 
```

类“Passageiro”映射到表“LocsPassageiros”：

```
public class Passageiro
{
    [Key]
    public Int32 CodLocPassageiro { get; set; }

    ... (other fields)

     //tried this, no success
    //[ForeignKey("Seguros")]
    public Int32 CodLocPassageiroInterno { get; set; }

    //tried these annotations with no success
    [ForeignKey("CodLocPassageiroInterno")]
    [Association("Passageiro_Seguros", "CodLocPassageiroInterno", "CodPassageiro")]
    public List<SeguroPassageiro> Seguros { get; set; }
} 
```

设置模型：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();

        modelBuilder.Entity<Dominio.Aereo.Passageiro>().ToTable("LocsPassageiros");
        modelBuilder.Entity<Dominio.Aereo.SeguroPassageiro>()
         .ToTable("SegurosPassageiros");

         //Tried both lines below (together and separeted) with no success:            
        //modelBuilder.Entity<Dominio.Aereo.SeguroPassageiro>().HasRequired(s => s.Passageiro).WithOptional();
        //modelBuilder.Entity<Dominio.Aereo.Passageiro>().HasMany(p => p.Seguros).WithRequired();

        //Tried "linking" the column "CodPassageiro" on table "SegurosPassageiros" to                   
        //column "CodLocPassageiroInterno" on table "LocsPassageiros". No success.
        modelBuilder.Entity<Dominio.Aereo.SeguroPassageiro>().Property(s => s.CodLocPassageiroInterno).HasColumnName("CodPassageiro");
    } 
```

使用这个模型，经过数十次试验，我能达到的最接近的是在 Passageiro 对象中获得一个列表，但关联错误：“SegurosPassageiros.CodPassageiro”和“LocsPassageiros.CodLocPassageiro”（而不是“LocsPassageiros.CodLocPassageiro* **Interno*** ” ）。EF 坚持获取错误的关联（在 LocsPassageiros 上获取 PK）。

任何人都知道我怎样才能在 EF 中获得这个关联？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T07:35:55.117

不幸的是，这是不可能的。EF 只能在主体实体中定义的 PK 之上建立一对多关系。在您的情况下，仅当`LocsPassageiros.CodLocPassageiro`用作主键时。

在数据库中，只有当主键唯一时才能建立这种关系——它必须是主键或者必须具有唯一约束。如果数据库不满足这些要求，则关系无效。EF 目前不支持唯一约束，所以唯一的方法是使用主键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T08:31:04.493

这是一个解决方法。（如果我有权将此作为评论发布，我不会将其发布为答案。）您可以使用 EF 查询并在 Where 中加入这两个实体，而不是直接使用关联。

# ember.js - 嵌套循环：从父视图访问对象

> ID：11836142
> 
> 赞同：0
> 
> 时间：2012-08-06T21:23:37.223
> 
> 标签：ember.js, nested-loops

我在一个视图中基本上有两个对象数组：

```
App.List = Ember.View.extend({
  students: [{ "name": "yehuda" }, { "name": "tom" }],
  teacher: [{ "name": "mr. katz" }, { "name": "mr. dale" }]
}); 
```

我的车把看起来像这样：

```
{{#each teacher}}
  <li class="teacher">{{name}}</li>
  {{#each students}}
    // display students for this teacher
  {{/each}}
}} 
```

这里明显的问题是，`students`-array 不在`teacher`-array 之内，而是在同一个“级别”上。那么如何访问`students`-array？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:36:22.710

它似乎与视图上下文有关，尝试使用`{{view.students}}`，我认为它应该可以工作。

jsfiddle 针对评论更新：http: [//jsfiddle.net/Sly7/gdXfN/](http://jsfiddle.net/Sly7/gdXfN/)

# javascript - 将点击处理程序附加到动态生成的锚标记

> ID：11836149
> 
> 赞同：1
> 
> 时间：2012-08-06T21:24:07.440
> 
> 标签：javascript, jquery

我动态生成一些标记并将其注入到 DOM 中，如下所示：

```
content+='<td><a class="reportLink" onclick="showReport();return false;" href="'+layerResults.features[i].attributes['Information_External']+'">Info</a></td>'; 
```

我知道使用 jQuery 来附加点击处理程序而不是使用内联处理程序会更好。

问题是，即使使用内联处理程序和这样的函数：

```
function showReport() {
  console.log('stopped');
} 
```

仍然不能阻止链接离开我的页面。

第二个问题是，当我尝试使用

```
jQuery('.reportLink'.on('click', function(e) {
  e.preventDefault();
  console.log('clicked');
}); 
```

该事件永远不会附加。我正在使用 jQuery 1.7.2。

这让我有点发疯，因为这是我在 jQuery <= 1.5 中完成了无数次的简单任务。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T21:27:08.053

将事件处理程序委托给加载 dom 时存在的父元素。您可以替换`body`为该父级。

```
jQuery('body').on('click','.reportLink', function(e){
   e.preventDefault();
   console.log('clicked');
}); 
```

来自 jquery 文档[.on()](http://api.jquery.com/on/)

> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。为确保元素存在并且可以被选择，请在页面 HTML 标记中的元素的文档就绪处理程序内执行事件绑定。如果将新 HTML 注入页面，请在将新 HTML 放入页面后选择元素并附加事件处理程序。或者，使用委托事件来附加事件处理程序，如下所述。
> 
> 委托事件的优点是它们可以处理来自以后添加到文档的后代元素的事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。例如，该元素可以是模型-视图-控制器设计中视图的容器元素，或者如果事件处理程序想要监视文档中的所有冒泡事件，则可以是文档。在加载任何其他 HTML 之前，文档元素在文档的头部是可用的，因此在此处附加事件是安全的，而无需等待文档准备好。
> 
> 除了能够处理尚未创建的后代元素上的事件之外，委托事件的另一个优点是当必须监视许多元素时，它们的开销可能会大大降低。在其 tbody 中有 1,000 行的数据表上，此示例将处理程序附加到 1,000 个元素：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:27:00.737

为了防止它离开，在 "console.log('stopped'); 之后输入这个。

```
return false; 
```

对于第二个，我通常使用这种语法，也许它会有所帮助：

```
jQuery(".reportLink").click(function() {
    //do something
}); 
```

# ruby - Ruby 错误消息中的单字母前缀是什么意思？

> ID：11836152
> 
> 赞同：6
> 
> 时间：2012-08-06T21:24:11.493
> 
> 标签：ruby

Ruby 错误消息通常包含带有单字母前缀的词法常量，例如：

> 语法错误，意外的 tIDENTIFIER，期待 kEND

`t`和从哪里来`k`？还有其他字母吗？可能的关键字的主列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T21:40:21.500

对于这样的问题，[parse.y](https://github.com/ruby/ruby/blob/trunk/parse.y)通常是查看的地方。如果没记错的话，“t”代表令牌，而“k”表示关键字。

以下是表示标识符的不同标记（在其他事物的名称意义上）：

```
%token <id>   tIDENTIFIER tFID tGVAR tIVAR tCONSTANT tCVAR tLABEL 
```

`kEND`我通过快速搜索找到的唯一定义是`k_end`：

```
k_end : keyword_end
        {
          token_info_pop("end");
        }
        ; 
```

# android - 升级/重新安装应用程序后如何更新 Android AppWidget？

> ID：11836155
> 
> 赞同：6
> 
> 时间：2012-08-06T21:24:22.533
> 
> 标签：android, android-appwidget, appwidgetprovider

我创建了一个应用程序 (https://play.google.com/store/apps/details?id=com.widget.analytics)，它使用 AppWidget 在 Android 主屏幕上显示一个人的 Google Analytics 统计信息。

不幸的是，在将应用程序升级到新版本后，用户需要删除他们之前创建的所有小部件，并且必须重新安装它们。这很烦人。然而，我相信有办法解决。

升级应用程序后，小部件不会被破坏，它们只是处于从布局继承的“默认”状态。

我可以使用四个小部件回调中的任何一个来更新小部件吗？是否有我可以采取行动并更新小部件的升级后回调？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T11:25:05.757

我没有意识到`onUpdate`重新安装应用程序后会调用它。所以代码只是进入更新方法，每次升级后都会被调用：

```
public class WidgetProvider extends AppWidgetProvider {

  @Override
  public void onUpdate (Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds){
    // Here we update the widget :)
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:44:52.813

您可以注册 a`BroadcastReceiver`来接收[`ACTION_PACKAGE_REPLACED`](http://developer.android.com/reference/android/content/Intent.html#ACTION_PACKAGE_REPLACED)广播，然后在接收器中通知您的小部件重新加载（可能通过`AppWidgetManager.notifyAppWidgetViewDataChanged(..)`）。您可能还需要接收[`ACTION_MY_PACKAGE_REPLACED`](http://developer.android.com/reference/android/content/Intent.html#ACTION_MY_PACKAGE_REPLACED)广播。

# apache2 - 收到带有签名的 Ajp 无效消息

> ID：11836156
> 
> 赞同：25
> 
> 时间：2012-08-06T21:24:31.830
> 
> 标签：apache2, tomcat7, mod-proxy, proxypass

我正在使用带有 Apache 2.2.22 modproxy 的 Tomcat 7.0.29。在 httpd.conf 中将 Ajp 配置为协议，在 server.xml 中配置 AjpNioProtocol。服务器启动后，日志中充满以下消息：

> 严重：收到无效消息，签名
> 为 20599 com.apache.coyote.ajp.AjpMessage processHeader

没有请求发送到 web 或 tomcat 服务器，它仍然会抛出该错误。tomcat和apache的访问日志显示没有请求进来。是什么导致了invalid message错误？

这是配置：

*   httpd.conf

    ```
    ProxyPass /wl ajp:// ip : port /wl
    ProxyPassReverse /wl ajp:// ip : port /wl 
    ```

*   服务器.xml

    ```
    <Connector port="port" 
               protocol="org.apache.coyote.ajp.AjpNioProtocol" 
               connectionTimeout="20000" 
               acceptorThreadCount="2" 
               maxThreads="1600" 
               redirectPort="8443" /> 
    ```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2015-02-27T21:27:47.447

对我来说，问题很简单。我正在发送 HTTP 请求，但连接器配置了 AJP 协议。我的连接器`server.xml`配置如下：

```
<Connector port="8009" protocol="AJP/1.3" redirectPort="8443"/> 
```

但是当我把它改成这样时：

```
<Connector port="8009" protocol="HTTP/1.1" redirectPort="8443"/> 
```

错误消失了。

希望这将有助于解决此错误的人。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-30T14:23:45.973

当两端的缓冲区大小不同时，也可能发生这种情况：日志提到无效的 AJP 消息并且浏览器收到`400`错误代码。

我已经修复了`packetSize`AJP[连接器](http://tomcat.apache.org/tomcat-6.0-doc/config/ajp.html)和`ProxyIOBufferSize`Apache2 配置中的情况。

在 Tomcat 中`server.xml`：

```
<Connector protocol="AJP/1.3" port="8009"
   connectionTimeout="20000"
   packetSize="65536"
   proxyName="yourproxy.domain.ltd" proxyPort="80"
   /> 
```

在 Apache2 [mod_proxy_ajp 配置](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxyiobuffersize)中，添加语句`ProxyIOBufferSize 65536`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T19:49:38.563

发现其中一个内部进程正在调用该端口并发送 http 请求导致“无效消息..”错误。所以我最终为这些内部流程添加了一个额外的 http 连接器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-08T11:36:14.177

> 没有请求发送到 web 或 tomcat 服务器，它仍然会抛出该错误。tomcat和apache的访问日志显示没有请求进来。是什么导致了invalid message错误？

只是对其他人的一些提示，因为我偶然在我的一个配置中忘记了相同的内容：提到`Connector`的`server.xml`内容是全局监听，因为仅`port`指定了，没有任何`address`. 后者默认定义为全局监听：

> 默认情况下，此端口将用于与服务器关联的所有 IP 地址。

[https://tomcat.apache.org/tomcat-7.0-doc/config/http.html](https://tomcat.apache.org/tomcat-7.0-doc/config/http.html)

因此，如果没有任何额外的防火墙或类似的东西，不良客户端可能只是使用各种协议测试开放端口，这可能是也可能不是`HTTP`，因此会导致具有不同签名的错误消息。如果没有很好的理由，就不需要让 AJP 全局可用，尤其是在线程启动器使用的代理设置的情况下。

```
<Connector  address="localhost" port="port" 
            protocol="org.apache.coyote.ajp.AjpNioProtocol" 
            connectionTimeout="20000" 
            acceptorThreadCount="2" 
            maxThreads="1600" 
            redirectPort="8443" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-18T21:41:56.853

我今天收到了类似的消息：

```
Nov 18, 2016 4:25:00 PM org.apache.coyote.ajp.AjpMessage processHeader
SEVERE: Invalid message received with signature 65524 
```

我的问题的根本原因是 selinux 没有让 apache 连接到 tomcat。我对这个错误是如何导致的有点困惑——我希望不会有任何联系，期间。最好的猜测，我可能尝试使用 telnet 手动连接到该端口。这样做肯定会发出类似的信息。

无论如何，也许这个 selinux 提醒会对最终来到这里的其他人有所帮助。

# mongodb - Mongoose.js：Upsert + Type.Mixed

> ID：11836158
> 
> 赞同：0
> 
> 时间：2012-08-06T21:24:37.697
> 
> 标签：mongodb, mongoose, upsert

是否可以插入 Type.Mixed 数据字段？它似乎不起作用，但我还没有进入猫鼬代码。

# c# - SoundPlayer 不播放任何捆绑的 Windows 声音 PCM wav 文件

> ID：11836159
> 
> 赞同：2
> 
> 时间：2012-08-06T21:24:41.247
> 
> 标签：c#, .net, wav, pcm, soundplayer

在 C# 中，我无法使用以下代码从 System.Media 获取 SoundPlayer 类来播放我的 C:\Windows\Media 文件夹中的任何 wav。我得到的只是没有声音：

```
String filename = "C:\\Windows\\Media\\tada.wav";
SoundPlayer sp = new SoundPlayer(filename);
sp.Load();
sp.Play(); 
```

我用一个名为“Gspot”的程序检查了波形文件“tada.wav”，它告诉我音频编解码器是“PCM Audio”。我没有收到任何编译器警告或错误，运行程序时也没有引发异常。我只是听不到任何声音。我的扬声器已打开，我可以使用 Windows Media Player 播放文件。

将 wav 添加为项目资源没有任何区别。有人可以帮我弄清楚为什么我听不到任何声音吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-02T19:44:09.933

Play() 方法在单独的线程中播放声音。也就是说，控制台应用程序会旋转一个新线程来播放声音。这对于 Windows 应用程序非常有用，因此声音播放不会停止 Windows 主线程。在控制台应用程序中，当父线程结束时，子线程也会全部死亡。——因此没有声音。

有一个 PlaySync() 方法不会产生新线程，因此将保持控制台应用程序线程处于活动状态，直到它完成播放您的声音。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:45:24.730

您是否将其用作控制台应用程序中 main() 方法的主体？应用程序可能正在结束，从而关闭播放音频的线程。

我将您的代码复制并粘贴到新的“Visual C# 控制台应用程序”的主目录中。我添加了“使用 System.Text；” 文件顶部的行，编译，单步执行，它工作了。当我运行它（没有调试）时，我没有声音。

如果添加该行：

System.Threading.Thread.Sleep(2000);

在调用 Play() 之后，应用程序将停留足够长的时间来播放音频。

# php - 为这个元标记脚本 PHP 拉取 STDN

> ID：11836160
> 
> 赞同：0
> 
> 时间：2012-08-06T21:24:44.717
> 
> 标签：php, screen-scraping, meta-tags

我有一个提取网页元标记信息的 php 脚本。我从 CLI 使用这个脚本。我的问题是如何添加到这个接受参数（url）的脚本并将其应用于脚本。同样，这将来自命令行界面。

这是示例脚本。

```
#!/usr/bin/php
<?php

    function getMetaData($url){
        // get meta tags
        $meta=get_meta_tags($url);
        // store page
        $page=file_get_contents($url);
        // find where the title CONTENT begins
        $titleStart=strpos($page,'<title>')+7;
        // find how long the title is
        $titleLength=strpos($page,'</title>')-$titleStart;
        // extract title from $page
        $meta['title']=substr($page,$titleStart,$titleLength);
        // return array of data
        return $meta;
    }

    // This line should be replaced with the function call using argv    
    //$tags = getMetaData('$url');

    // Check data was passed
    if (empty($argv[1])) {
        exit("You didn't specify a URL!");
    }

    // Pass the supplied data into your code
    $tags = getMetaData($argv[1]);

    echo 'Title: '.$tags['title'];
    echo "\n";
    echo 'Description: '.$tags['description'];
    echo "\n";
    echo 'Keywords: '.$tags['keywords'];

?> 
```

非常感谢您的帮助，我是 php 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:32:48.097

首先，直接解决您的问题 - 您可以通过[`$argv`](http://php.net/manual/en/reserved.variables.argv.php)全局变量访问脚本的命令行参数。

`$argv`是在全局范围内注册的标准变量，而不是诸如等之类的[超全局变量](http://php.net/manual/en/language.variables.superglobals.php)-因此除非您将其作为参数传递，否则它将在您的函数中不可用。`$_GET``$_POST`

第一个参数将在 中可用`$argv[1]`，第二个参数在 中可用`$argv[2]`，依此类推。

现在解决有关您的脚本的几点问题：

*   在 PHP 中从 HTML 中提取信息时，最好的方法是使用[DOM](http://php.net/manual/en/book.dom.php)。这是一个适合 PHP 的 HTML 解析器，它允许您执行诸如选择`<meta>`文档中的所有标签并非常轻松地提取它们的属性值之类的操作。
*   您的代码将整个文档下载两次——一次一次，`get_meta_tags()`一次一次`file_get_contents()`。这显然是低效的——但可以通过使用 DOM 来解决，因为您只需要创建一次文档对象。或者，您可以`file_get_contents()`先使用并将数据保存到临时文件，然后调用`get_meta_tags()`该临时文件。
*   脚本中的结束`?>`标记可以（并且通常应该）被省略。这可以防止在脚本末尾意外输出意外的空白。

**编辑**

以下是如何使用的示例`$argv`：

```
<?php

  // Check data was passed
  if (empty($argv[1])) {
    exit("You didn't specify a URL!");
  }

  // Pass the supplied data into your code
  $tags = getMetaData($argv[1]);

  // ... 
```

# tfs - 不了解构建定义中的类别过滤器

> ID：11836162
> 
> 赞同：2
> 
> 时间：2012-08-06T21:24:47.987
> 
> 标签：tfs, msbuild

我有 2 个测试类别“A”和“B”。我希望构建定义忽略它们，所以我在类别过滤器中输入了以下内容：

```
!A&!B 
```

结果：MSBuild 将忽略所有标有“A”的测试，但不会忽略标有“B”的测试。但是：如果我将“A”添加到仅标有“B”的测试中，它将正常工作。

即使我想了两次，我也无法更好地解释它:-(。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T16:56:55.053

我相信，因为您使用的是'！或“不等于”，您需要在非“与”中有一个“或”。

```
!A|!B 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T17:40:29.487

似乎已过时，因为 TFS 2013 中没有出现该问题。他们更改了过滤器内的语法。也许这就是为什么？

# html - ie7的布局问题

> ID：11836163
> 
> 赞同：0
> 
> 时间：2012-08-06T21:24:51.673
> 
> 标签：html, css, alignment

看起来我的[网站](http://goo.gl/GfQ53)在 ie7 中看起来不太好（见下面的屏幕截图） 我应该是水平的菜单是垂直的，facebook 和 twitter 按钮彼此上方而不是彼此相邻。有没有办法解决这两个问题？非常感谢，

![在此处输入图像描述](../Images/bac3d42c06dee3e760759dfac3bf8264.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:29:25.770

“我应该是水平的菜单是垂直的”

这种类型的 IE7 问题通常会在您尝试使用一组`<li>`或`<div>`标记时发生`display:inline-block`——这适用于 IE8 和其他浏览器的当前版本。

问题是，IE7 尊重`display:inline-block`，但仅限于默认情况下内联的元素，例如`<span>`or `<a>`。所以它只是将它们保持为块，因此它们垂直堆叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:19:40.653

我会尝试`float: left;`同时申请`#nav > li`和`#nav a`。

这应该可以解决 IE7 的垂直堆栈问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:51:19.863

干得好：

[http://jsfiddle.net/aKPgt/](http://jsfiddle.net/aKPgt/)

简而言之，改变：

```
display:inline-block; 
```

到

```
display:inline; 
```

并添加：

```
float:right; 
```

请记住，您需要在无序列表中反转菜单项的顺序，因为您浮动的是 RIGHT 而不是 LEFT。

# c# - 如何在 F# 中为 T[] 定义类型扩展？

> ID：11836167
> 
> 赞同：17
> 
> 时间：2012-08-06T21:25:02.807
> 
> 标签：c#, arrays, f#, extension-methods

在 C# 中，我可以为 T 类型的泛型数组定义扩展方法，如下所示：

```
public static T GetOrDefault<T>(this T[] arr, int n)
{
    if (arr.Length > n)
    {
        return arr[n];
    }

    return default(T);
} 
```

但是对于我的生活，我无法弄清楚如何在 F# 中做同样的事情！我试过了`type 'a array with`，编译器对其中任何一个都不满意。`type array<'a> with``type 'a[] with`

谁能告诉我在 F# 中这样做的权利是什么？

当然，我可以通过遮盖 Array 模块并轻松添加一个函数来做到这一点，但我真的很想知道如何将它作为扩展方法！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-07T15:38:09.507

您必须使用“反引号”编写数组类型 - 如下所示：

```
type 'a ``[]`` with
  member x.GetOrDefault(n) = 
    if x.Length > n then x.[n]
    else Unchecked.defaultof<'a>

let arr = [|1; 2; 3|]
arr.GetOrDefault(1) //2
arr.GetOrDefault(4) //0 
```

**编辑**：语法`type ``[]``<'a> with ...`似乎也是允许的。在 F# 源代码 (prim-types-prelude.fs) 中，您可以找到以下定义：

```
type ``[]``<'T> = (# "!0[]" #) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-06T21:33:13.040

好问题。我不知道如何扩展`'T[]`，但你可以利用数组实现的事实`IList<_>`来做：

```
type System.Collections.Generic.IList<'T> with
  member x.GetOrDefault(n) = 
    if x.Count > n then x.[n]
    else Unchecked.defaultof<'T>

let arr = [|1; 2; 3|]
arr.GetOrDefault(1) //2
arr.GetOrDefault(4) //0 
```

# hadoop - hadoop 显示地图减少百分比运行两次

> ID：11836168
> 
> 赞同：0
> 
> 时间：2012-08-06T21:25:07.250
> 
> 标签：hadoop, mapreduce

我正在运行 Apache 的 Hadoop，并使用该安装提供的 grep 示例。**我想知道为什么地图减少百分比显示运行两次？**我以为他们只需要跑一次；这让我怀疑我对 map reduce 的理解。我查了一下（[http://grokbase.com/t/gg/mongodb-user/125ay1eazq/map-reduce-percentage-seems-running-twice](http://grokbase.com/t/gg/mongodb-user/125ay1eazq/map-reduce-percentage-seems-running-twice)）但确实没有解释，这个链接是针对MongoDB的。

```
hduser@ubse1:/usr/local/hadoop$ bin/hadoop jar hadoop*examples*.jar grep /user/hduser/grep /user/hduser/grep-output4 ".*woe is me.*" 
```

我在项目 gutenberg .txt 文件上运行它。输出文件是正确的。

如果需要，这是运行命令的输出：

```
12/08/06 06:56:57 INFO util.NativeCodeLoader: Loaded the native-hadoop library
12/08/06 06:56:57 WARN snappy.LoadSnappy: Snappy native library not loaded
12/08/06 06:56:57 INFO mapred.FileInputFormat: Total input paths to process : 1
12/08/06 06:56:58 INFO mapred.JobClient: Running job: job_201208030925_0011
12/08/06 06:56:59 INFO mapred.JobClient:  map 0% reduce 0%
12/08/06 06:57:18 INFO mapred.JobClient:  map 100% reduce 0%
12/08/06 06:57:30 INFO mapred.JobClient:  map 100% reduce 100%
12/08/06 06:57:35 INFO mapred.JobClient: Job complete: job_201208030925_0011
12/08/06 06:57:35 INFO mapred.JobClient: Counters: 30
12/08/06 06:57:35 INFO mapred.JobClient:   Job Counters 
12/08/06 06:57:35 INFO mapred.JobClient:     Launched reduce tasks=1
12/08/06 06:57:35 INFO mapred.JobClient:     SLOTS_MILLIS_MAPS=31034
12/08/06 06:57:35 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0
12/08/06 06:57:35 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0
12/08/06 06:57:35 INFO mapred.JobClient:     Rack-local map tasks=2
12/08/06 06:57:35 INFO mapred.JobClient:     Launched map tasks=2
12/08/06 06:57:35 INFO mapred.JobClient:     SLOTS_MILLIS_REDUCES=11233
12/08/06 06:57:35 INFO mapred.JobClient:   File Input Format Counters 
12/08/06 06:57:35 INFO mapred.JobClient:     Bytes Read=5592666
12/08/06 06:57:35 INFO mapred.JobClient:   File Output Format Counters 
12/08/06 06:57:35 INFO mapred.JobClient:     Bytes Written=391
12/08/06 06:57:35 INFO mapred.JobClient:   FileSystemCounters
12/08/06 06:57:35 INFO mapred.JobClient:     FILE_BYTES_READ=281
12/08/06 06:57:35 INFO mapred.JobClient:     HDFS_BYTES_READ=5592862
12/08/06 06:57:35 INFO mapred.JobClient:     FILE_BYTES_WRITTEN=65331
12/08/06 06:57:35 INFO mapred.JobClient:     HDFS_BYTES_WRITTEN=391
12/08/06 06:57:35 INFO mapred.JobClient:   Map-Reduce Framework
12/08/06 06:57:35 INFO mapred.JobClient:     Map output materialized bytes=287
12/08/06 06:57:35 INFO mapred.JobClient:     Map input records=124796
12/08/06 06:57:35 INFO mapred.JobClient:     Reduce shuffle bytes=287
12/08/06 06:57:35 INFO mapred.JobClient:     Spilled Records=10
12/08/06 06:57:35 INFO mapred.JobClient:     Map output bytes=265
12/08/06 06:57:35 INFO mapred.JobClient:     Total committed heap usage (bytes)=336404480
12/08/06 06:57:35 INFO mapred.JobClient:     CPU time spent (ms)=7040
12/08/06 06:57:35 INFO mapred.JobClient:     Map input bytes=5590193
12/08/06 06:57:35 INFO mapred.JobClient:     SPLIT_RAW_BYTES=196
12/08/06 06:57:35 INFO mapred.JobClient:     Combine input records=5
12/08/06 06:57:35 INFO mapred.JobClient:     Reduce input records=5
12/08/06 06:57:35 INFO mapred.JobClient:     Reduce input groups=5
12/08/06 06:57:35 INFO mapred.JobClient:     Combine output records=5
12/08/06 06:57:35 INFO mapred.JobClient:     Physical memory (bytes) snapshot=464568320
12/08/06 06:57:35 INFO mapred.JobClient:     Reduce output records=5
12/08/06 06:57:35 INFO mapred.JobClient:     Virtual memory (bytes) snapshot=1539559424
12/08/06 06:57:35 INFO mapred.JobClient:     Map output records=5
12/08/06 06:57:35 INFO mapred.FileInputFormat: Total input paths to process : 1
12/08/06 06:57:35 INFO mapred.JobClient: Running job: job_201208030925_0012
12/08/06 06:57:36 INFO mapred.JobClient:  map 0% reduce 0%
12/08/06 06:57:50 INFO mapred.JobClient:  map 100% reduce 0%
12/08/06 06:58:05 INFO mapred.JobClient:  map 100% reduce 100%
12/08/06 06:58:10 INFO mapred.JobClient: Job complete: job_201208030925_0012
12/08/06 06:58:10 INFO mapred.JobClient: Counters: 30
12/08/06 06:58:10 INFO mapred.JobClient:   Job Counters 
12/08/06 06:58:10 INFO mapred.JobClient:     Launched reduce tasks=1
12/08/06 06:58:10 INFO mapred.JobClient:     SLOTS_MILLIS_MAPS=15432
12/08/06 06:58:10 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0
12/08/06 06:58:10 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0
12/08/06 06:58:10 INFO mapred.JobClient:     Rack-local map tasks=1
12/08/06 06:58:10 INFO mapred.JobClient:     Launched map tasks=1
12/08/06 06:58:10 INFO mapred.JobClient:     SLOTS_MILLIS_REDUCES=14264
12/08/06 06:58:10 INFO mapred.JobClient:   File Input Format Counters 
12/08/06 06:58:10 INFO mapred.JobClient:     Bytes Read=391
12/08/06 06:58:10 INFO mapred.JobClient:   File Output Format Counters 
12/08/06 06:58:10 INFO mapred.JobClient:     Bytes Written=235
12/08/06 06:58:10 INFO mapred.JobClient:   FileSystemCounters
12/08/06 06:58:10 INFO mapred.JobClient:     FILE_BYTES_READ=281
12/08/06 06:58:10 INFO mapred.JobClient:     HDFS_BYTES_READ=505
12/08/06 06:58:10 INFO mapred.JobClient:     FILE_BYTES_WRITTEN=42985
12/08/06 06:58:10 INFO mapred.JobClient:     HDFS_BYTES_WRITTEN=235
12/08/06 06:58:10 INFO mapred.JobClient:   Map-Reduce Framework
12/08/06 06:58:10 INFO mapred.JobClient:     Map output materialized bytes=281
12/08/06 06:58:10 INFO mapred.JobClient:     Map input records=5
12/08/06 06:58:10 INFO mapred.JobClient:     Reduce shuffle bytes=0
12/08/06 06:58:10 INFO mapred.JobClient:     Spilled Records=10 
```

**编辑**Grep 的驱动程序类： **Grep.java**

```
/**
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
package org.apache.hadoop.examples;

import java.util.Random;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapred.*;
import org.apache.hadoop.mapred.lib.*;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;

/* Extracts matching regexs from input files and counts them. */
public class Grep extends Configured implements Tool {
 private Grep() {} // singleton

 public int run(String[] args) throws Exception {
 if (args.length < 3) {
 System.out.println("Grep <inDir> <outDir> <regex> [<group>]");
 ToolRunner.printGenericCommandUsage(System.out);
 return -1;
 }

 Path tempDir =
 new Path("grep-temp-"+
 Integer.toString(new Random().nextInt(Integer.MAX_VALUE)));

 JobConf grepJob = new JobConf(getConf(), Grep.class);

 try {

 grepJob.setJobName("grep-search");
 FileInputFormat.setInputPaths(grepJob, args[0]);

 grepJob.setMapperClass(RegexMapper.class);
 grepJob.set("mapred.mapper.regex", args[2]);
 if (args.length == 4)
 grepJob.set("mapred.mapper.regex.group", args[3]);

 grepJob.setCombinerClass(LongSumReducer.class);
 grepJob.setReducerClass(LongSumReducer.class);

 FileOutputFormat.setOutputPath(grepJob, tempDir);
 grepJob.setOutputFormat(SequenceFileOutputFormat.class);
 grepJob.setOutputKeyClass(Text.class);
 grepJob.setOutputValueClass(LongWritable.class);

 JobClient.runJob(grepJob);

 JobConf sortJob = new JobConf(getConf(), Grep.class);
 sortJob.setJobName("grep-sort");

 FileInputFormat.setInputPaths(sortJob, tempDir);
sortJob.setInputFormat(SequenceFileInputFormat.class);

 sortJob.setMapperClass(InverseMapper.class);

 sortJob.setNumReduceTasks(1); // write a single file
 FileOutputFormat.setOutputPath(sortJob, new Path(args[1]));
 sortJob.setOutputKeyComparatorClass // sort by decreasing freq
 (LongWritable.DecreasingComparator.class);

 JobClient.runJob(sortJob);
 }
 finally {
 FileSystem.get(grepJob).delete(tempDir, true);
 }
 return 0;
 }

 public static void main(String[] args) throws Exception {
 int res = ToolRunner.run(new Configuration(), new Grep(), args);
 System.exit(res);
 }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:30:05.107

在文件中有两个工作的统计数据：`job: job_201208030925_0011`和`job: job_201208030925_0012`。百分比属于这两个工作，因此有 2 个地图进度百分比。

# c# - 如何将浮点数组从 c# 编组到 c，然后在 c 中编辑数组，同时让 c# 能够立即引用更新的数组

> ID：11836170
> 
> 赞同：3
> 
> 时间：2012-08-06T21:25:14.750
> 
> 标签：c#, pointers, marshalling

我不确定这是否可能，我对 c# 中的编组了解不多，所以如果我很遥远，或者这是否可能，请填写我对这一点的理解。

但基本上我在基于 C# 的应用程序中有一个 C# 中的浮点数组。每次这个程序循环时，我都需要在这个浮点数组上做一些处理器密集型的繁重工作。所以我想用 C 编写这个处理器繁重的代码，然后将浮点数组编组到 C 并在 C 中处理编辑。这看起来很简单，但问题是我的 C# 代码需要立即访问浮点数组在 C 中编辑。

我遇到的问题是编组的开销。在编组过程中，性能上的任何收益都会丢失。如果我必须将这个浮点数组从 C# 编组到 C，然后在该程序的每个周期从 C 回到 C#，则不会有任何性能提升。

有什么方法可以让我制作一个浮点数组并将指向该数组的指针编组到 C 中，并在 C 中编辑该数组。但也能够使用来自 C# 的相同精确指针立即引用该数组并查看什么数组中的 C 代码已更改？那么我不必在每个周期来回编组数组吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:30:37.013

您可以使用[固定](http://msdn.microsoft.com/en-us/library/f58wzh21%28VS.80%29.aspx)块。这将防止垃圾收集器在内存中移动数组。因此，您将获得一个指向您可以使用的托管数组的原始指针。将原始指针传递给您的 C 代码。无需复制：C 代码将直接对托管数组进行操作。一旦固定块超出范围，就不要保留原始指针，否则您可能会在 GC 运行后持有错误的指针。

例子：

```
int[] arr;
// NOT SHOWN:  initialize arr array
fixed (int* p = arr) {
    // NOT SHOWN:  call C function, passing "p" pointer
} 
```

# redis - ServiceStack.Redis：无法连接：sPort：0

> ID：11836171
> 
> 赞同：6
> 
> 时间：2012-08-06T21:25:16.737
> 
> 标签：redis, servicestack

有时（并非总是）我得到

“无法连接：sPort：0”

使用 ServiceStack.Redis 时尝试从 Redis 获取值时出错。有谁知道这可能意味着什么？我正在使用 PooledRedisClientManager 来获取客户端。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T20:12:43.383

我相信您可以通过增加池的`ConnectTimeout`. 我把它设置得非常低（10 毫秒），所以当创建池时，一些客户端在短时间内无法连接。如果池返回这些客户端之一，它会抛出这个错误（“0”端口是因为它没有连接——它不知道它没有连接到哪个端口）。延迟一段时间后，所有客户端都可以连接。

我将连接超时增加到 500 毫秒，问题就消失了——客户端都连接了，尽管其中一些阻塞了几百毫秒。但这比错误要好得多。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-03-28T09:30:33.363

这可能意味着端口号或主机地址错误。

# php - 如何检测JPEG图像的压缩级别？

> ID：11836173
> 
> 赞同：1
> 
> 时间：2012-08-06T21:25:31.073
> 
> 标签：php, image, jpeg

是否可以使用 PHP 检测 JPEG 图像的压缩级别，而无需文件的“原始”（未压缩）版本？

如果是，该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:30:56.270

是的，PHP Imagick 可以为您做到这一点。

[http://www.php.net/manual/en/imagick.getcompression.php](http://www.php.net/manual/en/imagick.getcompression.php)

[http://www.php.net/manual/en/imagick.getcompressionquality.php](http://www.php.net/manual/en/imagick.getcompressionquality.php)

# iphone - iPad 上的“可执行文件已使用无效权利签名”，在 iPhone 上运行良好

> ID：11836181
> 
> 赞同：1
> 
> 时间：2012-08-06T21:25:42.930
> 
> 标签：iphone, ios, xcode, ipad, code-signing

我一直在我的 iPhone 上运行我的应用程序，然后我将它插入我的 iPad 在那里运行它，以测试 iCloud，它给了我代码签名错误`The executable was signed with invalid entitlements`。

任何想法为什么会这样？浏览我的证书和个人资料并重新制作它们的想法并不真正吸引我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:28:37.097

我之前遇到过类似的错误，我的解决方法是打开管理器（4.2 中的窗口-> 管理器）并单击设备，然后选择“使用此设备进行开发”。

![在此处输入图像描述](../Images/94d1e07fae0aed792fbd86eb79098098.png)

此外，请确保第二个设备在管理器中具有所有正确的配置信息，作为第一个工作的设备。

编辑1：

我刚刚想到的另一件事：

确保将其设置为为 Iphone 和 Ipad 部署：

在目标下编辑看起来像这样的设置 -![在此处输入图像描述](../Images/05fbba096de9ba674c0f7368e57efebc.png)

编辑2：

此外，检查 Apple 的[iOS 开发中心](http://developer.apple.com/membercenter/)并确保将您的设备添加到该配置文件的设备列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:33:19.453

没有说明您是否已经这样做了，但是您需要确保向 Apple 注册 iPad 的 UUID，并且可以在 iOS 开发者中心完成。如果这还没有完成，（不幸的是）您还需要创建一个新的配置文件并使用它来编译应用程序并将其添加到两个设备。

# javadoc - 记录 Salesforce.com Apex 类文件

> ID：11836182
> 
> 赞同：7
> 
> 时间：2012-08-06T21:25:47.823
> 
> 标签：javadoc, doxygen, apex-code

由于 Salesforce.com Apex 语言是“类 Java”，我想使用 javadoc 或 Doxygen 为我们计划在 App Exchange 上发布的包生成 API 文档。

我在 Google Code 上找到了一个[ApexDoc](http://code.google.com/p/apexdoc/)项目，但它受到严重限制，并且使用简单的解析器来生成 HTML 输出。我宁愿利用现有的 Doxygen 解析器和输出生成器，也不愿尝试从头开始重新发明那个轮子。

所以，我的问题：

1) 有没有人能够使用 javadoc 或 Doxygen 为其 Apex 类生成 API 文档？你是怎么做到的？

2) 我想知道编写一个简单的脚本来从 .cls Apex 类文件创建一系列 .java 文件、添加虚假`import`语句并可能修改某些声明以使 Doxygen 满意会有多难。关于 Doxygen（或 javadoc）在尝试解析 Apex .cls 文件时阻塞的任何想法？

我很惊讶 Salesforce 没有提供这样的工具，或者没有为 javadoc/Doxygen 贡献 Apex 解析器。他们的文档和开发人员工具非常广泛，并且他们拥有出色的自动化测试设置。我还没有从他们那里找到任何用于自动生成类的东西。

编辑：请在[Salesforce Stack Exchange上查看](https://salesforce.stackexchange.com/)[此问题的更新版本](https://salesforce.stackexchange.com/q/925/450)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-01T13:00:41.960

我写了一个基于 ApexDoc 的工具。[这里](http://scox67.blogspot.com/2013/08/sf-apexdoc.html)有一个简短的文章，带有指向 JAR 文件和 GitHub 项目的链接。如果您发现问题，请在我的博客上给我留言。

# symfony - symfony2 多数据库

> ID：11836184
> 
> 赞同：2
> 
> 时间：2012-08-06T21:25:51.987
> 
> 标签：symfony, parameters, fosuserbundle, multiple-databases

我将**symfony2**与**FOSuserBundle**一起使用。

我需要 2 个数据库连接，一个用于用户管理，另一个用于远程数据库连接。

我怎样才能同时使用它们？

**parameters.ini**文件可以有双数据库参数吗？像这样

> [参数] database_driver="pdo_mysql"
> database_host="localhost"
> database_port=""
> database_name="symfony"
> database_user="root"
> database_password=""
> database2_driver="pdo_mysql"
> database2_host="remote_ip"
> database2_port=""
> database2_name="symfonydb2"
> database2_user="root"
> database2_password=""

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T14:52:39.857

要回答您的问题：

> 我怎样才能同时使用它们？

就像@vbergae 说的那样，看看[如何与多个实体管理器一起工作](http://symfony.com/doc/current/cookbook/doctrine/multiple_entity_managers.html)

> parameters.ini 文件可以有双数据库参数吗？

当然，您只需在配置文件中引用它，如下所示：

*   %database2_driver%
*   %database2_host%
*   %database2_port%
*   %database2_name%
*   %database2_user%
*   %database2_password%

# javascript - 新包装器如何在 JavaScript 中工作？

> ID：11836186
> 
> 赞同：0
> 
> 时间：2012-08-06T21:25:53.363
> 
> 标签：javascript, underscore.js

在 underscore.js 的上下文中：

```
// Create a safe reference to the Underscore object for use below.
   var _ = function(obj) { return new wrapper(obj); }; 
```

简单来说，这个函数返回什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:24:33.553

[它](http://htmlpreview.github.io/?https://raw.github.com/jashkenas/underscore/06c773b06e53ec9a089f17c18852098cb1e25c66/docs/underscore.html#section-9)是[`wrapper`构造](http://htmlpreview.github.io/?https://raw.github.com/jashkenas/underscore/06c773b06e53ec9a089f17c18852098cb1e25c66/docs/underscore.html#section-131)函数的包装函数，允许您使用不带[`new`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/new)的下划线。调用下划线将始终返回一个新`wrapper`实例。

* * *

顺便说一句，该`wrapper`功能已在[此提交](https://github.com/jashkenas/underscore/commit/6587a30099fd283abd0e5b2b9918f1ec88a0dd6a#diff-1)中删除。`_`函数本身现在是构造函数，请参阅Understanding [the declaration of the underscore in _.js?](https://stackoverflow.com/questions/17660955/understanding-the-declaration-of-the-underscore-in-js) 解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:14:39.080

简单地说，它是 'wrapper' 的构造函数，让你的事情变得更容易

```
// this allows you to do things such as:
var a = _({/*object*/});

// rether than something like:
var a = new wrapper({/*object*/}); 
```

我认为从 underscore.js 开始，它是为了让你的编码保持整洁和简单:)

# php - 使用PHP-文本编辑器压缩和合并JS文件

> ID：11836189
> 
> 赞同：10
> 
> 时间：2012-08-06T21:26:03.273
> 
> 标签：php, javascript, caching

我目前正在缩小 JS 文件以提高页面速度。我已经能够找到适用于我几乎所有 js 文件的最简单的方法，除了两个。问题在于我试图在我的网站上实现的 wmd 编辑器的 js 文件。js 文件`wmd.js`并`showdown.js`没有被`scripts.php`. 我用萤火虫工具检查，在两个文件的响应头中`scripts.php`都没有包含在最终压缩的 js 文件中。

我压缩这些 js 文件（wmd 和摊牌）并将其合并为一个的过程有什么问题？[示例网站](http://jachamboneth.cpsc3430.ausrc.org/wmdXss/default.php)

**js/scripts.php- 负责压缩和缓存 js 文件**

```
<?php
error_reporting(E_ERROR);
// see http://web.archive.org/web/20071211140719/http://www.w3.org/2005/MWI/BPWG/techs/CachingWithPhp
// $lastModifiedDate must be a GMT Unix Timestamp
// You can use gmmktime(...) to get such a timestamp
// getlastmod() also provides this kind of timestamp for the last
// modification date of the PHP file itself
function cacheHeaders($lastModifiedDate) {
    if ($lastModifiedDate) {
        if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) && strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) >= $lastModifiedDate) {
            if (php_sapi_name()=='CGI') {
                Header("Status: 304 Not Modified");
            } else {
                Header("HTTP/1.0 304 Not Modified");
            }
            exit;
        } else {
            $gmtDate = gmdate("D, d M Y H:i:s \G\M\T",$lastModifiedDate);
            header('Last-Modified: '.$gmtDate);
        }
    }
}

// This function uses a static variable to track the most recent
// last modification time
function lastModificationTime($time=0) {
    static $last_mod ;
    if (!isset($last_mod) || $time > $last_mod) {
        $last_mod = $time ;
    }
    return $last_mod ;
}

lastModificationTime(filemtime(__FILE__));
cacheHeaders(lastModificationTime());
header("Content-type: text/javascript; charset: UTF-8");

ob_start ("ob_gzhandler");

foreach (explode(",", $_GET['load']) as $value) {
    if (is_file("$value.js")) {
        $real_path = mb_strtolower(realpath("$value.js"));
        if (strpos($real_path, mb_strtolower(dirname(__FILE__))) !== false || strpos($real_path, mb_strtolower(dirname(dirname(__FILE__)).DIRECTORY_SEPARATOR.'modules'.DIRECTORY_SEPARATOR)) !== false) {
            lastModificationTime(filemtime("$value.js"));
            include("$value.js");echo "\n";
        } 
    }
}
?> 
```

**我调用compressed.js的方式**

```
<script type = "text/javascript" src = "js/scripts.php?build=12345&load=wmd,showdown"></script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-09T19:54:01.127

我想问题在于语句`include("$value.js");echo "\n";`
这样，如果包含的 javascript 文件至少包含一个“ **<?** ”字符串，并且如果您在“php.ini”配置文件中启用了“ [short_open_tag](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag) ”选项，则 javascript 的一部分代码从 PHP 解释器解析，就好像它是 PHP 代码一样，可能会引发语法错误，因此忽略后续包含。
查看“prettify.js”源代码，我看到有效地存在“<？” 第 471 行的字符串。也许将行更改`include("$value.js");echo "\n";`为`readfile("$value.js");echo "\n";`应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T22:12:10.003

由于在问题的评论中要求这样做，因此这里是对问题代码的一些评论

## 功能`cacheHeaders`

`header()`通过使用或 函数的第三个参数可以使这个函数更简单、更稳定`http_response_code`。我强烈建议后者，因为即使使用第三个参数，`header()`也存在一些问题。有关4.3 <= PHP <= 5.4 和/或更多信息的函数，[请参阅此答案。](https://stackoverflow.com/questions/3258634/php-how-to-send-http-response-code/12018482#12018482)`http_response_code`

另请注意，有根据 RFC 2822 格式化日期的格式代码，包括正确的时区（而不是强制为 GMT）（`r`在[此处查找](http://php.net/date)）`date`

您拥有该代码的页面至少有 5 年的历史，并且即使在那时也可能是为了兼容性而编写的（PHP3！神圣的......！），这并不是真正的错误，但现在是继续前进的时候了。与最初用于其他用途的功能记录不佳或根本没有记录的行为相比，专用功能提​​供了更好的标准合规性和向上兼容性。

## 输出缓冲区和 HEAD 请求

在处理`HEAD`请求时，HTTP 服务器**必须**像处理请求一样处理请求，`GET`但**不能**返回消息体。这是公认标准的一部分，没有办法。因此，当使用请求执行脚本时，`HEAD`PHP 或 Web 服务器（或两者，我真的不知道）将在发送所有标头后立即中止脚本（或者换句话说，当您尝试输出某些内容时）。

但是，现在当您使用用户空间输出缓冲时，例如`ob_gzhandler`，可能直到执行结束才发送标头。当然，这仍然可以通过减少连接数来实现减少客户端加载时间的目标，但不会减少服务器负载 - 或者更确切地说引入了无用的服务器负载 - 客户端仍然必须等到你的脚本完成，这是标头的时间最终将被发送。

所以要走的路是在所有标题都准备好并设置后立即“手动”退出脚本。

```
// setup, header generation, etc.
if($_SERVER['REQUEST_METHOD'] == 'HEAD')
    exit();
ob_start('ob_gzhandler');
// more pretty code, includes and whatnot 
```

如果你不使用输出缓冲区，你也可以`flush()`在这一点上加上一些输出。但是（根据 php 手册）win32 版本的 apache/php 在调用时实际上不会刷新缓冲区`flush()`，这使得上面的代码仍然是最好的方法。

# java - Windows 是否默认安装了任何 JDBC 驱动程序？

> ID：11836198
> 
> 赞同：2
> 
> 时间：2012-08-06T21:26:46.790
> 
> 标签：java, sql, ms-access, jdbc, odbc

我正在编写一个从 MS Access 数据库中检索数据的 Java 程序。我的代码如下：

```
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
String url = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=" + databaseLocation + databaseName +";selectMethod=cursor; READONLY=true; TYPE=FASTLOAD";

con = DriverManager.getConnection(url); 
```

我正在使用一个基本的 JDBC:ODBC 桥。似乎Type 4驱动程序会更好。但是，我正在编写要在另一台 PC 上使用的程序，我希望他们不必安装任何驱动程序就可以工作。我不记得在我的电脑上安装过任何东西。

谁能告诉我这适用于任何 Windows 副本吗？那是我使用的 JDBC 驱动程序，默认情况下与 Windows 或 Java 或 Access 一起安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:30:32.993

不，Windows 上没有安装 IV 型 JDBC 驱动程序。

我不知道 Access 有免费的 IV 型 JDBC 驱动程序。

JDBC-ODBC 桥可用于 32 位 JVM，但不适用于 64 位。（需要一个不属于 64 位 JDK 的 DLL。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T09:26:25.940

**据我所知，当他/她说“Windows 上没有安装 IV 型 JDBC 驱动程序”时，**duffymo是正确的****

 **hxtt.com/access.html 不是使用 Samba 的 JDBC 4 类驱动程序，也不是 JDBC 4 类驱动程序所需的本机协议。

您需要的是 JDBC 类型 3 驱动程序，它使用自己的网络协议在客户端之间进行通信，在您的情况下，客户端将是远程 PC 和服务器组件。市售的[Easysoft JDBC-ODBC Bridge](http://www.easysoft.com/products/data_access/jdbc_odbc_bridge/index.html)提供了这样的解决方案。您将软件安装在包含 MS Access 数据库的机器上或可以使用访问数据库的 UNC 路径的机器上，然后将 EJOB.jar 文件与 Java 应用程序一起分发到需要访问该数据库的机器上。您可以在 32 位和 64 位 Java 应用程序中使用 Easysoft。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T08:25:10.337

> HXTT 在他们关于 JDBC 是类型 4 的声明中是 AFAIK 不正确的。

HXTT 驱动程序的所有驱动程序都是类型 4。

> 它使用 SMB 而不是本机协议

错误的。它可以运行于嵌入式模式、客户端/服务器模式、内存模式、映射驱动程序、SMB 协议、http 协议、https 协议和移动操作系统。

如果您选择下载并评估它，您将在[http://www.hxtt.com/access.html找到以下信息](http://www.hxtt.com/access.html)不是谎言：HXTT Access 包含 Microsoft Access 版本从 95、97、2000、XP、2002、2003、2007 到 2010 的唯一类型 4 JDBC（1.2、2.0、3.0、4.0、4.1）驱动程序包，其中支持事务、嵌入式访问、远程访问、客户端/服务器模式、仅内存数据库、压缩数据库（.ZIP、.JAR、.GZ、.TAR、.BZ2、.TGZ、.TAR.GZ、.TAR.BZ2） 、SMB 数据库（smb）、url 数据库（http、https、ftp）和 java.io.InputStream 数据库。通过嵌入式 Pure Java 数据库引擎，可以在任何带有 JVM 的平台上部署和访问 MS Access 数据库。支持JDBC1.2、JDBC2.0、JDBC3.0、JDBC4.0、JDBC4.1、SQL92，程序员无需特殊编码，DBA可以使用任何Java数据库工具轻松访问本地数据或远程数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-11T08:36:18.200

[http://www.hxtt.com/access/sqlsyntax.html](http://www.hxtt.com/access/function.html)上的许多强大的 SQL 语法（例如 select ... into outfile）或[http://www.hxtt.com](http://www.hxtt.com/access/sqlsyntax.html)上的 SQL 函数（例如 GROUP_CONCAT）MS ACCESS 引擎根本不支持[/access/function.html 。](http://www.hxtt.com/access/function.html)借助 HXTT Access 的帮助，您可以轻松访问 UNIX/LINUX/MAC OS 的本地 mdb/accdb 文件，无需任何第三方组件。**

# sql - SQL ORDER by STRING 奇怪的语法

> ID：11836200
> 
> 赞同：3
> 
> 时间：2012-08-06T21:26:56.667
> 
> 标签：sql, sql-server-2005

有没有更丑陋/更程序化的方法来解决这个问题：

```
ORDER BY CASE 
 WHEN lessonID = 'lesson_1' Then 1  
 WHEN lessonID = 'lesson_novid_1' Then 2 
 WHEN lessonID = 'lesson_2' Then 3 
 WHEN lessonID = 'lesson_novid_2' Then 4 
 WHEN lessonID = 'lesson_3' Then 5 
 WHEN lessonID = 'lesson_novid_3' Then 6 
 WHEN lessonID = 'lesson_4' Then 7 
 WHEN lessonID = 'lesson_novid_4' Then 8 
 WHEN lessonID = 'lesson_5' Then 9 
 WHEN lessonID = 'lesson_novid_5' Then 10 
 WHEN lessonID = 'lesson_6' Then 11 
 WHEN lessonID = 'lesson_novid_6' Then 12
 WHEN lessonID = 'lesson_7' Then 13 
 WHEN lessonID = 'lesson_novid_7' Then 14
 WHEN lessonID = 'lesson_8' Then 15
 WHEN lessonID = 'lesson_novid_8' Then 16
 WHEN lessonID = 'lesson_9' Then 17
 WHEN lessonID = 'lesson_novid_9' Then 18
 WHEN lessonID = 'lesson_10' Then 19
 WHEN lessonID = 'lesson_novid_10' Then 20
 WHEN lessonID = 'lesson_11' Then 21
 WHEN lessonID = 'lesson_novid_11' Then 22 
 WHEN lessonID = 'lesson_12' Then 23 
 WHEN lessonID = 'lesson_novid_12' Then 24
End ASC 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:33:50.033

尝试找到数字并将其转换为整数：

```
ORDER BY
    CAST(REPLACE(REPLACE(lessonID, 'lesson_', ''), 'novid_', '') AS INT),
    lessonID 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!3/aea03/1)

请注意，此查询将无法使用索引来执行排序。您可以考虑使用[计算列](http://msdn.microsoft.com/en-us/library/ms191250%28v=sql.105%29.aspx)并将其编入索引以提高性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:33:43.393

创建一个包含 courseId 和 sortPosition 列的表。加入它并按 sortPosition 排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:29:57.737

不，这几乎是你必须做的，但我使用了稍微不同的（更干净的？）语法：

```
ORDER BY (CASE lessonID
 WHEN 'lesson_1' Then 1   
 WHEN 'lesson_novid_1' Then 2  
 WHEN 'lesson_2' Then 3  
 End) ASC 
```

不过，这几乎是一回事。遗憾的是，您可能已经发现，您不能使用变量/参数进行排序

```
ORDER BY @parameter DESC 
```

也许 MS 会把它放在未来的版本中 =)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:03:16.920

将所有选项堆成一个分隔字符串并按子字符串位置排序：

```
order by CharIndex( '|' + lessonID + '|', '|lesson_1|lesson_novid_1|...|' ) 
```

就个人而言，我更喜欢 WW 使用查找表的答案。

# ios - 使用 setValuesForKeysWithDictionary 和 JSON 设置 NSDate 的问题

> ID：11836205
> 
> 赞同：1
> 
> 时间：2012-08-06T21:27:17.960
> 
> 标签：ios, json, json.net

所以我很高兴使用 JSON 和 setValuesForKeysWithDictionary 将数据猛烈撞击到我的系统中，直到遇到具有 NSDate 属性的对象。

JSON 包含具有以下格式的日期：

```
BackOrderDate: "2011-03-15T00:00:00" 
```

这给了我一个错误：

```
'NSInvalidArgumentException', reason: 'Unacceptable type of value for attribute: property = "BackOrderDate"; desired type = NSDate; given type = __NSCFString; value = 2011-03-15T00:00:00 
```

我将 JSON.NET 与 MVC 以及以下设置一起使用：

```
JsonSerializerSettings serializerSettings = new JsonSerializerSettings();
serializerSettings.Converters.Add(new Newtonsoft.Json.Converters.IsoDateTimeConverter());
string json = JsonConvert.SerializeObject(objects, Formatting.None, serializerSettings);
return Content(json); 
```

关于如何处理这个问题的任何想法？我不想失去对 setValuesForKeysWithDictionary 的使用，因为它太快了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:47:31.697

我假设您正在使用 Core Data（因为 Core Data 会产生您发布的错误）并且您的实体有一个名为“BackOrderDate”的“Date”类型的属性。

问题是 JSON 没有“日期”数据类型。在您的 .NET 代码中，您通过告诉 JSON 序列化将日期转换为 IS 格式的字符串来处理此问题。

在将数据传递给`setValuesForKeysWithDictionary:`.

`NSDate`您可以使用将字符串解析为`NSDateFormatter`，并且您可以在网络上轻松找到很多这样的示例。

在调用之前如何执行解析`setValuesForKeysWithDictionary:`取决于您使用什么来解析 JSON。

如果您使用的是 Apple 的`NSJSONSerialization`，您可能应该使用该`NSJSONReadingMutableContainers`选项。然后进入字典，`NSDate`在调用之前用一个对象替换日期字符串`setValuesForKeysWithDictionary:`。

如果您正在使用其他一些 JSON 解析器（如 SBJSON），我不知道进行替换的最佳方法。

# recursion - Hadoop 适用于递归数据处理

> ID：11836206
> 
> 赞同：3
> 
> 时间：2012-08-06T21:27:22.650
> 
> 标签：recursion, hadoop, mapreduce, bigdata

我有一个需要递归应用的过滤算法，我不确定 MapReduce 是否适合这项工作。如果没有放弃太多，我可以说每个被过滤的对象都以一个集合为特征，如果是有序列表或队列。

1.  数据并不大，当我从 SQL 导出到 CSV 时只有大约 250MB。
2.  映射步骤很简单：列表的头部包含一个可以将列表分类为属于**N**个映射节点之一的对象。每个节点的过滤算法对分配给该节点的列表集合起作用，并且在过滤结束时，列表保持与过滤之前相同，或者列表的头部被删除。
3.  reduce 函数也很简单：所有映射作业的列表都放在一起，可能必须写回磁盘。
4.  当所有**N**个节点都返回了它们的输出时，映射步骤将使用这组新数据重复。

注意：**N**可以多达 2000 个节点。很简单，但在满足算法的终止条件之前可能需要多达 1000 次递归。

我的问题是这份工作是否适合 Hadoop？如果没有，我有什么选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:56:31.367

Hadoop 的主要优势在于它能够透明地在大量机器上分配工作。为了充分受益于 Hadoop，您的应用程序必须至少具有以下三点特征：

1.  处理大量数据（分布在机器集群中的数据）——这不可能存储在一台机器上
2.  数据可并行化（即原始数据的块可以独立于其他块进行操作）
3.  应用程序试图解决的问题非常适合 MapReduce（分散 - 聚集）模型。

似乎在这 3 个中，您的应用程序只有最后 2 个特征（观察到您正在尝试递归地使用分散 - 收集过程 - 这意味着大量作业 - 等于递归深度；见最后一段为什么这可能不适合 hadoop）。

考虑到您要处理的数据量，我看不出有什么理由不在一台机器上执行，完全在内存中。如果您认为您可以从并行处理少量数据中受益，我建议您关注多核处理而不是分布式数据密集型处理。当然，使用网络集群的处理能力很诱人，但这需要付出代价：主要是网络通信（网络是 hadoop 集群中竞争最激烈的资源）和 I/O 导致的时间效率低下。在非常适合 Hadoop 框架的场景中，这些低效率可以忽略不计，因为通过分发数据和对该数据的相关工作获得了效率。

如我所见，您需要 1000 个工作岗位。所有这些作业的设置和清理对于您的场景来说都是不必要的开销。此外，在我看来，网络传输的开销是不必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:19:07.590

递归算法在分布式系统中很难，因为它们会导致快速饥饿。任何适用于此的中间件都需要支持分布式延续，即能够进行“递归”调用而不持有调用方的资源（如线程）。

[GridGain](http://www.gridgain.com)是一种原生支持分布式延续的产品。

分布式延续的试金石：尝试使用递归调用在分布式上下文中开发一个简单的斐波那契实现。这是 GridGain 的[示例](https://github.com/gridgain/gridgain/blob/master/examples/java/org/gridgain/examples/continuation/GridContinuationExample.java)，它使用延续来实现这一点。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T21:33:55.197

Q&D，但我建议您阅读 MongoDB 和 Hadoop 的比较： [http ://www.osintegrators.com/whitepapers/MongoHadoopWP/index.html](http://www.osintegrators.com/whitepapers/MongoHadoopWP/index.html)

不知道更多，很难说。您可能想尝试两者。如果您这样做，请发布您的结果！

# php - 从 javascript 调用 php 脚本

> ID：11836209
> 
> 赞同：-4
> 
> 时间：2012-08-06T21:27:29.577
> 
> 标签：php, javascript, jquery-ui, rest, autocomplete

我需要从 javascript 脚本调用我用 PHP 编写的 REST API。我可以指出的类似情况是 jquery ui 自动完成插件。当您为源属性指定外部 php 脚本时，它会读取 php 脚本的输出，并将其用作自动完成选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:29:00.830

[阿贾克斯](http://google.com/search?q=ajax)。就这些。

如果您有任何更具体的问题，请随时提问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:29:38.663

你可以使用 jQuery ajax 函数：

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:33:16.857

您可以使用 AJAX 请求（如果我理解了这个问题）如果您的 API 是用 myapi.php 编写的，您可以：

```
var word = "The Word";
$.ajax({
    url: "myapi.php?action=searchfor&word="+word,
    success: function(data){
        alert(data);
    }
}); 
```

...假设您使用的是 jQuery，当然 :)

# ruby-on-rails - 如何在不耗尽内存的情况下向 13k 图像（在 AWS S3 上）添加回形针样式？

> ID：11836211
> 
> 赞同：0
> 
> 时间：2012-08-06T21:27:50.427
> 
> 标签：ruby-on-rails, memory, amazon-s3, imagemagick, paperclip

我在回形针附件模型中添加了两种样式（小卡和中卡）截图：

```
class Screenshot < ActiveRecord::Base
    has_attached_file :image,
    :styles => { :tiny => "x75", :small => "x245", :medium => "x480", :large => "1280x900>",
                 :smallcard => "280x245#", :mediumcard => "570x480#" },
    :storage => :s3,
    :s3_credentials => "#{Rails.root}/config/amazon_s3.yml",
    :path => "/screenshots/:id_partition/:style/:filename"
end 
```

我手动创建了一个 public/system/paperclip_attachments.yml 文件以减少对预先存在的样式的处理：

```
---
:Screenshot:
  :image:
    - :tiny
    - :small
    - :medium
    - :large 
```

但是当我运行 rake paperclip:refresh:missing_styles CLASS=Screenshot 时，我得到以下信息：

```
Regenerating Screenshot -> image -> [:mediumcard, :smallcard]
rake aborted!
Cannot allocate memory - identify -format %wx%h '/tmp/79a229e96ab52dfa760132958da47bf320120806-31260-1eleoww[0]'
Tasks: TOP => paperclip:refresh:missing_styles
[clip] 
```

当我跟踪日志时，处理只达到 500 秒（id）。

该服务器无疑是一台运行 Ubuntu 的 Linode 512，多年来它在为 3 个 Rails 应用程序和 1 个 PHP 应用程序提供页面服务方面表现出色。我以前从来没有用过它的内存。

监视 rake 任务进程，它随着每个处理的图像而递增，直到它吃光所有可用的 RAM。

也许是时候让我的 Linode 成长了……但首先我希望有其他选择。

如何解决此内存问题并将这两种样式添加到预先存在的 13k 图像中？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:53:35.857

您需要让系统有机会正确释放内存。我们在遇到使用 ORM 处理 PHP 批处理任务的类似问题时使用的一个大胆技巧是：将您的任务包装在另一个任务中，该任务一次只为一个项目调用第一个任务。通常，您应该重构第一个任务以获取基本映像的参数。第二个任务应该收集所有图像（以内存友好的方式，例如对象 ID 或类似的东西），然后遍历它们并以每个作为参数调用第一个任务。当第一个任务完成时，它将内存返回给操作系统，然后可以释放内存。另一方面，第二个或包装任务从不一次需要那么多内存。这样，最大内存使用量应该是处理*一张*图像的最大值，而不是*全部*图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:47:20.973

希望这可以帮助其他有同样问题的人。

正如 Chris 建议的那样，我将一个 rake 任务包裹在另一个使用 %x() 调用的任务中。每次迭代都会完全释放上一次调用的内存。

```
namespace :screenshots do
  desc "Incrementally rebuild thumbnails. START=0 & BATCH_SIZE=10 & VERBOSE=false"
  task :reprocess_stepper => :environment do
    batch_size = (ENV['BATCH_SIZE'] || ENV['batch_size'] || 10)
    verbose    = (ENV['VERBOSE'] || ENV['verbose'] || nil)

    total = Screenshot.count
    start = 0

    while start < total
      puts "Spawning: bundle exec rake screenshots:reprocess_some START=#{start} BATCH_SIZE=#{batch_size} VERBOSE=#{verbose} RAILS_ENV=#{Rails.env}"
      puts %x{bundle exec rake screenshots:reprocess_some START=#{start} BATCH_SIZE=#{batch_size} VERBOSE=#{verbose} RAILS_ENV=#{Rails.env} }
      start = start + batch_size.to_i
    end
  end

  desc "Reprocess a batch of screenshots. START=0 & BATCH_SIZE=10 & VERBOSE=false"
  task :reprocess_some => :environment do
    start      = (ENV['START'] || ENV['start'] || 0)
    batch_size = (ENV['BATCH_SIZE'] || ENV['batch_size'] || 10)
    verbose    = (ENV['VERBOSE'] || ENV['verbose'] || nil)

    puts "start = #{start} & batch_size = #{batch_size}" if verbose
    puts "RAILS_ENV=#{Rails.env}" if verbose

    screenshots = Screenshot.order("id ASC").offset(start).limit(batch_size).all
    screenshots.each do |ss|
      puts "Re-processing paperclip image on screenshot ID: #{ss.id}" if verbose
      STDOUT.flush
      ss.image.reprocess!
    end
  end
end 
```

然后，您可以按如下方式调用此任务：

```
RAILS_ENV=production bundle exec rake screenshots:reprocess_stepper VERBOSE=true BATCH_SIZE=50 
```

# coldfusion - 为什么在使用 CFScript 时 CFMAIL 会忽略查询的第一行以外的所有内容？

> ID：11836212
> 
> 赞同：1
> 
> 时间：2012-08-06T21:27:55.873
> 
> 标签：coldfusion, coldfusion-9, cfmail

我正在尝试在 CFScript CFC 中使用 CFmail。我希望 CFMail 遍历查询，并根据查询内容更改值。只要查询对象只有 1 行，它就可以做到这一点。如果它有多行（例如 5 行），它将发送 5 封电子邮件，但每封电子邮件将包含来自第一个查询行的值。我尝试了一些不同的东西。见下文：

查询对象：

```
Name    |     Email     |   Number
----------------------------------
John    |  john@foo.com |     12
Bill    |  bill@bar.com |     42
Ann     |  ann@bat.com  |     100 
```

CF 脚本：

```
var mailerService = new mail();

mailerService.setQuery(nameEmailNumberQuery);
mailerService.setTo('eterps@sendtomefortesting.com');
mailerService.setFrom( 'noReply@example.com' );
mailerService.setSubject('Hi');
mailerService.setFailto('fail@foo.com');
mailerService.setType('html');
mailerService.setSpoolenable(true);

    savecontent variable="mailBody"{ 
    WriteOutput(
        "Hello " & Name & ". Your number is: " & Number & "!"
    );          
}   

mailerService.send(body=mailBody & tmpVariable); 
```

使用上面的代码，我收到了三封电子邮件。每封电子邮件都写着：“你好，约翰。你的电话号码是：12！”

我也试过：

```
WriteOutput(
    "Hello " 
     & mailerService.getQuery().Name 
     & ". Your number is: " 
     & mailerService.getQuery().Number 
     & "!"
); 
```

和：

```
WriteOutput(
    "Hello " 
    & mailerService.getQuery().Name[mailerService.getQuery.CurrentRow] 
    & ". Your number is: " 
    & mailerService.getQuery().Number[mailerService.getQuery.CurrentRow] 
    & "!"
); 
```

编辑：我尝试过的几件事（@invertedSpear 建议的一件）

在电子邮件正文中使用查询文字：

```
WriteOutput(
    "Hello " 
    & nameEmailNumberQuery.Name 
    & ". Your number is: " 
    & nameEmailNumberQuery.Number
    & "!"
); 
```

尝试使用递增的计数器：

```
var counter = 1;
...
WriteOutput(
    "Hello " 
    & mailerService.getQuery().Name[counter] 
    & ". Your number is: " 
    & mailerService.getQuery().Number[counter]
    & "!" & evaluate('counter = counter++')
); 
```

每次都有相同的结果 - 3 封电子邮件，都带有“John”和“12”。每封电子邮件的转储`mailerService.getQuery().CurrentRow`结果为“1”。我在 Windows Server 2008 R3 上使用 Coldfusion 9.0.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:55:59.157

我敢肯定，当您向查询列表发送邮件时，它只是将一封邮件发送给一大群人。

因此，您无法更改一封电子邮件中的姓名。

如果你想做你想做的事，你会发送多封邮件。

循环查询并对每条记录执行 cfmail，这将生成单独的邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T13:15:29.387

在这种情况下，您需要自己进行循环，并为循环`.send()`中的每个项目调用方法。MailService 不会为您执行循环。所以你需要这样做：

```
var mailerService = new mail();

mailerService.setTo('eterps@sendtomefortesting.com');
mailerService.setFrom( 'noReply@example.com' );
mailerService.setSubject('Hi');
mailerService.setFailto('fail@foo.com');
mailerService.setType('html');
mailerService.setSpoolenable(true);

for (x = 1; x <= nameEmailNumberQuery.RecordCount; x=x+1) { 
    savecontent variable="mailBody"{ 
        WriteOutput(
            "Hello " & nameEmailNumberQuery.Name[x] & ". Your number is: " & nameEmailNumberQuery.Number[x] & "!"
        );          
    } 
    mailerService.send(body=mailBody & tmpVariable);
} 
```

这将允许您配置一次基本电子邮件属性，然后为行中的每个项目发送单独的电子邮件。如果每封电子邮件都应该发送到一个唯一的电子邮件地址，只需将该`setTo()`方法移动到循环中并引用电子邮件地址的正确列即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T14:37:42.420

如果您尝试向查询中的每条记录发送一封电子邮件，我只会将其写在标签中。如果你这样做很简单

```
<cfmail query="nameEmailNumberQuery" 
  to="#nameEmailNumberQuery.Email#" from="noReply@example.com" 
  failto="fail@foo.com" subject="Hi" type="html">

  Hello #nameEmailNumberQuery.Name#. Your number is: #nameEmailNumberQuery.Number#!
</cfmail> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-06T22:29:24.807

在我看到的基于标签的版本的示例中，它们按名称引用查询。你有没有尝试过：

```
WriteOutput(
 "Hello " & arguments.engagementQuery.Name & ". Your number is: " & arguments.engagementQuery.Number & "!"
); 
```

# javascript - Jquery使用依赖验证并检查未填充

> ID：11836219
> 
> 赞同：0
> 
> 时间：2012-08-06T21:28:29.193
> 
> 标签：javascript, jquery, jquery-validate

我知道如何检查输入是否已填充，但是，您如何检查输入是否未填充？

```
rules: {
    new_email:          {required: "current_email:filled"}
} 
```

如果填充了 current_email 字段，这将使 new_email 字段成为必需。但我想检查该字段是否为空并使其成为必需。推理：

如果存在此类数据，我将从数据库中返回 current_email 的值。如果是这样，则存在现有电子邮件，并且不需要用户添加 new_email。如果数据库中有空值，则current_email字段中将没有任何内容，从而强制用户输入new_email。

现在取决于我已经尝试过：

```
rules: {
    new_email:{
               required: {
                   depends: function(element) {
                       return ($('#current_email').val() == '';
                   }
               }
              }
} 
```

但那里也没有运气。那么我该如何让它工作呢？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:54:55.923

通过上面的@UnLoCo：

“首先，你有一个右括号缺少 return ($('#current_email').val() == '';”

# css - 在 IE9 中调整 SVG 大小

> ID：11836220
> 
> 赞同：5
> 
> 时间：2012-08-06T21:28:32.233
> 
> 标签：css, svg, internet-explorer-9

我在 div 中有一个内联 SVG 元素，它可以缩放以适应浏览器窗口。当浏览器调整大小时，SVG 图像也会随之调整大小，以便所有图像都可见，并且保持相同的比例。

但是，在 IE9 中，图像要小得多，并且不会调整大小。取下 viewBox 会将图像缩放到全尺寸，这太大了，它仍然不会调整大小。

我发现通过设置包含 div 的宽度和高度会使图像更大，但只有固定像素，而不是 100%，这正是我所需要的。

[这个 jsfiddle](http://jsfiddle.net/Jnag5/6/)显示了问题的实际效果（即在 Chrome 中很好，在 IE9 中不好）。调整框架边框的大小应该会使图像调整大小。

```
<div id="outer">
    <svg viewBox="0 0 700 1000"  xmlns=http://www.w3.org/2000/svg>
        <g transform="rotate(90, 350, 350)" id="pitch-rotated">
            <title>Pitch</title>
            <path d="m0,0l1000,0l0,700l-1000,0l0,-700z" stroke-width="5" stroke="#fff" fill="#008800" id="perimiter"/>
            <line id="centre-line" y2="700" x2="500" y1="0" x1="500" stroke-width="5" stroke="#ffffff" fill="none"/>
            <path id="penalty-box-home" fill="none" stroke="#fff" stroke-width="5" d="m0,148.5l165,0l0,403l-165,0l0,-403z"/>
            <path id="six-yard-box-home" fill="none" stroke="#fff" stroke-width="5" d="m0,258.5l55,0l0,183l-55,0l0,-183z"/>
            <path d="m1000,148.5l-165,0l0,403l165,0l0,-403z" stroke-width="5" stroke="#fff" fill="none" id="penalty-box-away"/>
            <path d="m1000,258.5l-55,0l0,183l55,0l0,-183z" stroke-width="5" stroke="#fff" fill="none" id="six-yard-box-away"/>
            <circle fill="none" stroke="#ffffff" stroke-width="5" cx="500" cy="350" r="95" id="centre-circle"/>
            <circle fill="none" stroke="#ffffff" stroke-width="10" cx="500" cy="350" r="1" id="centre-spot"/>
            <circle fill="none" stroke="#ffffff" stroke-width="7" cx="110" cy="350" r="1" id="penalty-spot-home"/>
            <circle fill="none" stroke="#ffffff" stroke-width="7" cx="890" cy="350" r="1" id="penalty-spot-away"/>
            <path d="m165,277.5a91,91 1 0 10,145" stroke="#ffffff" stroke-width="5" fill="none" id="penalty-curve-home"/>
            <path d="m835,277.5a91,91 0 0 00,145" stroke="#ffffff" stroke-width="5" fill="none" id="penalty-curve-away"/>
            <path d="m0,10a7.5,7.5 0 0 010,-10" stroke="#ffffff" stroke-width="5" fill="none" id="corner-home-left"/>
            <path d="m0,690a7.5,7.5 0 0 110,10" stroke="#ffffff" stroke-width="5" fill="none" id="corner-home-right"/>
            <path d="m1000,10a7.5,7.5 0 0 1-10,-10" stroke="#ffffff" stroke-width="5" fill="none" id="corner-away-left"/>
            <path d="m1000,690a7.5,7.5 0 0 0-10,10" stroke="#ffffff" stroke-width="5" fill="none" id="corner-away-right"/>
        </g>
    </svg>      
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T09:17:37.660

我尚未在 IE 中对此进行测试，但如果您希望使用 100% 的宽度和高度，我假设您希望它是“全屏”或适合容器。由于您还提到它在...时正确缩放

> 设置包含 div 的宽度和高度会使图像变大，但仅限于固定像素

...那么您可以为此使用JS。例如，使用 jQuery，您可以执行以下操作：

```
$(window).resize(function()
{
    $('#outer').css({
        width: $(window).width() + 'px',
        height: $(window).height() + 'px'
    })
}); 
```

这是假设您希望您的`#outer`容器在调整窗口大小时成为窗口的宽度和高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T09:17:19.217

我知道你说过你想避免设置宽度和高度，但这是我个人设法让它工作的唯一方法。

虽然我确实发现您只需要设置高度，但您可以将宽度保留为 100%，因此：

```
 var container = this.$('.container'),
            width = container.width(),
            scale = svg.width / width;

        container.height(parseInt(svg.height / scale, 10)); 
```

其中 svg.width 和 svg.height 是我知道是 SVG 的原始宽度和高度的值。

# ios - iOS6 UDID - identifierForVendor 与 identifierForAdvertising 相比有什么优势？

> ID：11836225
> 
> 赞同：69
> 
> 时间：2012-08-06T21:28:43.220
> 
> 标签：ios, privacy, udid, ios6

Apple 正在更改其 iOS6 的隐私设置并弃用设备 UUID (UDID)。根据 WWDC 演示文稿和文档，在`UIDevice`类中有两个 UDID 的替代品：

## `-identifierForVendor`

*   来自同一开发者的应用程序之间相同的 ID。
*   删除该团队 ID 的最后一个应用程序后删除。
*   备份。

## `-identifierForAdvertising`

*   设备独有。
*   适用于所有应用程序；用于广告 — iAd 已从 iOS 6 及更高版本的 UDID 转换。
*   使用“删除所有内容和设置”进行重置。
*   备份。

在我看来，这似乎`-identifierForVendor`不如，`-identifierForAdvertising`因为它会在最后一次从供应商处卸载应用程序时重置，并通过“删除所有内容和设置”来重置。

`-identifierForVendor`有什么优势`-identifierForAdvertising`呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-19T21:41:30.980

**重要提示**：

苹果刚刚发布了 iOS 6.0，NDA 已经解除。

对于抢先包含引用的代码的开发人员

```
[[UIDevice currentDevice] identifierForAdvertising] 
```

这个方法在 iOS 6 中还**没有**包含。如果你使用上面的方法，你的应用程序（很可能）会崩溃并被拒绝！

相反，Apple 创建了一个新类`ASIdentifierManager`，其中包含方法`advertisingIdentifier`。这是上面的[苹果文档](http://developer.apple.com/library/ios/#documentation/AdSupport/Reference/ASIdentifierManager_Ref/ASIdentifierManager.html#//apple_ref/occ/instp/ASIdentifierManager/advertisingIdentifier)：

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-02T21:51:14.660

用户可以限制在手机上使用广告跟踪。请参阅设置 > 常规 > 关于 > 广告下 [有关退出机制的这篇文章。](http://9to5mac.com/2012/09/13/apple-clarifies-new-advertising-identifier-an-apparent-non-personal-udid-replacement-in-ios-6/)

新`ASIdentifierManager`类有一个属性`advertisingTrackingEnabled`，它返回 true 或 false，具体取决于用户是否有有限的广告跟踪。即使设备的广告标识符由`advertisingIdentifier`属性返回而不管选择退出，如果用户选择退出，您也不应该使用该标识符。

因此，identifierForVendor 的优势在于，无论用户是否选择加入或退出广告跟踪，您始终可以访问并有权使用手机的此 ID。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-04T10:27:52.147

我怀疑如果您将应用程序`identifierForAdvertising`用于与广告无关的任何内容（即，`identifierForAdvertising`即使您不是广告网络，您也将其发送到自己的服务器，或者如果您`identifierForAdvertising`在同一请求中发送其他可能识别个人的数据）。

如果我的怀疑是正确的，`identifierForVendor`over的好处`identifierForAdvertising`是它不会让您的应用程序被拒绝。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-28T16:06:33.410

它们是两个不同的 ID，用于两种不同的目的。我认为 identifierForVendor 将用于执行需要链接到特定用户/设备的应用程序的操作，例如提供推送通知和更新用户的应用程序数据服务器端（例如他们的分数或存储的任何其他数据）他们）。
identifierForAdvertising 应该用于诸如有针对性的广告之类的事情，也应该用于检查特定广告活动的有效性（检查哪些设备由于特定广告而安装了应用程序）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-11-14T12:34:37.093

使用**VendorID**。这是一篇很有启发性的文章[http://www.doubleencore.com/2013/04/unique-identifiers/](http://www.doubleencore.com/2013/04/unique-identifiers/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-27T03:57:44.613

在 iOS 6 中根据设备的唯一标识符创建一个 uniqueString：

```
#import <AdSupport/ASIdentifierManager.h>

NSString *uniqueString = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];
NSLog(@"uniqueString: %@", uniqueString); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-11T06:17:56.927

这些 API 设计得非常糟糕，这清楚地表明——Apple 不希望我们识别用户设备。

只需查看 identifierForVendor 描述。

如果用户删除来自同一供应商的所有应用程序，则它会被删除。:( 这不可靠 - 可以返回 nil （如果发生这种情况，文档建议“等待”一段时间。:(

他们没有使用明显的解决方案，该解决方案可以随时工作并且不依赖于安装/删除 - 返回与团队 ID 连接的内部硬件设备 ID 的 SHA-1（或任何其他哈希）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-30T21:54:24.393

`identifierForAdvertising`在跟踪方面可能更胜一筹，但可能会受到用户当前或将来选择退出的影响。另一方面`identifierForVendor`不太可能成为用户的主题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-15T06:44:47.433

重要的是要知道 identifierForVendor 的备份只能恢复到同一设备。如果备份恢复到不同的设备，则清除标识符。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-06T23:59:44.423

用户可以随时在设置中更改 identifierForAdvertising，如果设备上没有来自该供应商的应用，则重新安装应用后 identifierForVendor 会发生变化。

这是获取或持久、交叉安装设备标识符的替代方案和最佳解决方案：

描述：[https ://blog.onliquid.com/persistent-device-unique-identifier-ios-keychain/](https://blog.onliquid.com/persistent-device-unique-identifier-ios-keychain/)

代码：[https ://gist.github.com/miguelcma/e8f291e54b025815ca46](https://gist.github.com/miguelcma/e8f291e54b025815ca46)

# phpunit - 无法调用依赖测试用例

> ID：11836226
> 
> 赞同：2
> 
> 时间：2012-08-06T21:28:50.247
> 
> 标签：phpunit

我正在编写单元测试来测试模型类。首先，我有一个`testAddStudent()`向 db 添加一些数据的测试用例。然后我有另一个测试用例来检索我刚刚添加的记录。我的代码如下所示：

```
class Model_STest extends PHPUnit_Framework_TestCase {

protected $_student;

public function setUp() {
    error_log("Entered setup");
    parent::setUp();

    $this->_student = new Application_Model_Student();
}

public function testInit() {
    error_log("Entered testInit");
}

public function testAddStudent() {
    error_log("Entered testAddStudent");
    $testData = array(
            'name' => 'abc',
            'teacher' => 'amyac',
            'start_date' => '2012_08_06'
            );

    $result = $this->_student->addStudent($testData);
    error_log("result is ".print_r($result, true));
    $this->assertGreaterThan(0, $result);
}

/**
 * @depends testAddStudent
 */
public function testGetStudent($result) {
    error_log("Entered testGetStudent, finding student id: $result");
    $resultx = $this->_student->getStudent($result);
    $this->assertEquals($result, $resultx);
    }

} 
```

但是，当我运行 phpunit 测试（使用命令行）时，日志显示正在搜索的学生 ID 为 0。而`testAddStudent`返回的学生 ID 为非零值。

我究竟做错了什么？我有

> 塞巴斯蒂安伯格曼的 PHPUnit 3.6.11。

任何帮助是极大的赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:28:26.713

你应该`$result`从你的`testAddStudent()`函数中返回。

（依赖函数的返回值被传递给依赖函数。）

您也可以考虑对 Application_Model_Student 实例执行相同的操作，而不是使用受保护的类变量。这是您重写的示例以显示这一点。（我使用了一个虚拟的 Application_Model_Student 足以通过测试。）

```
class Application_Model_Student{
private $d;
function addStudent($d){$this->d=$d;return 1;}
function getStudent($ix){return $ix;}
}

//----------------------
class Model_STest extends PHPUnit_Framework_TestCase {

public function testAddStudent() {
    error_log("Entered testAddStudent");

    $testData = array(
            'name' => 'abc',
            'teacher' => 'amyac',
            'start_date' => '2012_08_06'
            );

    $student = new Application_Model_Student();
    $result = $student->addStudent($testData);
    error_log("result is ".print_r($result, true));
    $this->assertGreaterThan(0, $result);
    return array($student,$result);
}

/**
 * @depends testAddStudent
 */
public function testGetStudent($data) {
    list($student,$result)=$data;
    error_log("Entered testGetStudent, finding student id: $result");
    $resultx = $student->getStudent($result);
    $this->assertEquals($result, $resultx);
    }

} 
```

PS注意我用来`getStudent`让它通过的实现！我想这不是你打算做的测试。

# javascript - Netbeans中的Javascript参数颜色

> ID：11836232
> 
> 赞同：40
> 
> 时间：2012-08-06T21:29:17.477
> 
> 标签：javascript, netbeans, colors, editor

我正在尝试更改 netbeans 7.2 中的函数参数颜色，但更改“参数”中的颜色值根本不起作用。它的颜色似乎与“关键字”的值绑定。

这是一个已知的错误？

![在此处输入图像描述](../Images/746c6b05f648731a44ac93e71a17ff18.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:59:01.947

这是一个错误：[http ://netbeans.org/bugzilla/show_bug.cgi?id=216462](http://netbeans.org/bugzilla/show_bug.cgi?id=216462)

（说明很明显，但对于可能希望回答这个问题的人）

# bash - 使用 CURL 下载文件并查看标题和状态码

> ID：11836238
> 
> 赞同：17
> 
> 时间：2012-08-06T21:29:40.577
> 
> 标签：bash, curl

我正在编写一个 Bash 脚本来从[Snapito](http://snapito.com)的网页快照 API 下载图像文件。API 可以返回由不同 HTTP 响应代码和/或一些自定义标头指示的各种响应。我的脚本旨在作为自动 Cron 作业运行，该作业从 MySQL 数据库中提取 URL 并将屏幕截图保存到本地磁盘。

我正在使用`curl`. 我想用一个 CURL 命令来做这三件事：

1.  提取 HTTP 响应代码
2.  提取标题
3.  在本地保存文件（如果请求成功）

我可以使用多个`curl`请求来做到这一点，但我想尽量减少访问 Snapito 服务器的次数。`curl`有高手吗？

或者，如果有人有一个可以响应完整记录的 Snapito API 响应集的 Bash 脚本，那就太棒了。这是[他们的 API 文档](http://snapito.com/paid-api.jsp)。

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-06T21:39:05.370

使用转储头选项： `curl -D /tmp/headers.txt http://server.com`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-06T21:40:24.043

使用`curl -i`（包括 HTTP 标头） - 这将产生标头，后跟一个空行，然后是内容。

然后，您可以拆分标题/内容（或使用 -D 直接保存到文件，如上所述）。

* * *

有`-i`、`-I`和三个选项`-D`

```
> curl --help | egrep '^ +\-[iID]'
 -D, --dump-header FILE  Write the headers to FILE
 -I, --head          Show document info only
 -i, --include       Include protocol headers in the output (H/F) 
```

# javascript - onClick javascript不起作用

> ID：11836242
> 
> 赞同：3
> 
> 时间：2012-08-06T21:29:58.950
> 
> 标签：javascript

我无法让 javascript 内联函数调用工作。内联函数是这样的：

```
<span> <input type="button" value="Previous Week" onClick="subtractOneWeekReloadPage()"> 
```

我将应该调用的函数写入标题中，如下所示：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Time Tracking Page</title>

<script type="text/javascript">
function subtractOneWeekReloadPage() {
<%=currentWeek.subtractOneWeek()%>;
window.location.reload();}

</script>

</head> 
```

当我单击网页上的按钮时，没有任何反应。我的 jsp 调用和页面刷新调用都没有运行。谁能告诉我我做错了什么？

该页面的相关输出为：

```
<span> 
<input type="button" value="Previous Week" onClick="subtractOneWeekReloadPage()"> 
Hours for the week of 
<%=currentWeek.firstDayOfThisWeek()%> 
until 
<%=currentWeek.lastDayOfThisWeek()%> 
<input type="button" value="Next Week" onClick="addOneWeekReloadPage()">
</span> 
```

显示一周的第一天和最后几天的 jsp 调用工作正常。但是当我点击减去一周并用新设置的一周重新加载页面时，什么也没有发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:31:45.337

JSP 在页面到达浏览器之前就已经运行了。如果`currentWeek.subtractOneWeek`输出有效 JS 代码以外的任何内容，则会出现语法错误并且代码拒绝运行。

# c# - 多列实体框架 LINQ 的区别

> ID：11836243
> 
> 赞同：25
> 
> 时间：2012-08-06T21:30:01.847
> 
> 标签：c#, linq, entity-framework, linq-to-entities

什么是 LINQ 等效项

```
Select DISTINCT A, B, C from TESTDB WHERE ALPHA =1 
```

我正在尝试这样的事情：

```
var data = TESTDB.WHERE(i=>i.ALPHA==1).SELECT(A,B,C).DISTINCT(); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-06T22:32:45.057

使用匿名对象可以解决问题：

```
var data = TESTDB.Where(i => i.ALPHA == 1).Select(i => new {i.A, i.B, i.C}).Distinct(); 
```

要保留模型：

```
List<Book> books = db.Book.Select(i => new Book {Author = i.Author, Title = i.Title}).Distinct().ToList(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-13T23:29:40.713

你也可以试试

```
db.Table
  .OrderBy(m=>m.Name)
  .DistinctBy(m=> new{m.SerialNumber, m.Manufacturer})
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:47:25.563

如果你这样使用它：

```
var list = new List<Pet>()
                       {
                           new Cat() {Name = "Kitty", Id = 1},
                           new Cat() {Name = "Kitty", Id = 1},
                           new Cat() {Name = "Kitty", Id = 1}
                       };

var distinctCount = list.Where(i => i.Id == 1).Distinct().Count(); 
```

原来 distinctCount 等于 3。这是为什么呢？似乎默认情况下 Distinct 区分实例（即使所有属性都具有相同的值，但它们是三个实例）。

您应该实现自定义比较器，在这里您可以找到代码示例：http: [//msdn.microsoft.com/en-us/library/bb338049.aspx](http://msdn.microsoft.com/en-us/library/bb338049.aspx)。

但是我不确定您为什么要选择三个属性（A，B，C）。您可以通过这种方式访问​​单个属性：

```
var data = list.Where(i => i.Id == 1).Distinct().SelectMany(i => i.Name); 
```

但是，为了选择多个属性，您应该将整个对象转换为包含这些属性的某个类：

```
var data = list.Where(i => i.Id == 1).Cast<Pet>().Distinct().ToList(); 
```

# javascript - 如何在 jQuery 中使用 fittext 来调整 div 中的文本大小？// 编辑

> ID：11836254
> 
> 赞同：-2
> 
> 时间：2012-08-06T21:30:40.807
> 
> 标签：javascript, jquery, html, text, resize

我尝试使用 fittext 调整我的文本大小。div 容器的宽度为 200 像素到 200 像素。结果应该是无论文本有 10 还是 200 个单词，文本都必须适合框。

**编辑**： jQuery 中的 fittext 不适用于适合更多行的文本，这是我的问题。

所以我会尝试动态调整更多行的字体大小。如果我尝试这个，你会看到我的问题。文本可以是动态的：

```
body{
   background-color: rgb(48, 54, 52);   
}   

.parent{
    position: relative;
    background-color: black;
    width: 200px;
    height: 200px;
    clear: both;
}

.child_1
{
    width: 200px;
    height: 200px;
    position: absolute;
    padding: 5px;
}

.child_1
{
    background-color: rgb(255, 255, 255);
    color: rgb(124, 170, 52);

}

<div>
<div class="parent">

<div class="child_1" >Lorem ipsum dolor sit amet, consectetuer adipiscing elit.Lorem 
ipsum dolor sit amet, consectetuer adipiscing elit.Lorem ipsum dolor sit amet,         
consectetuer adipiscing elit.</div>
</div>
</div>

<script src="jquery.fittext.js"></script>
<script type="text/javascript"> 
    $(".child_1").fitText(1.1, { minFontSize: 30, maxFontSize: '75px' });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:38:38.793

如果你有一个固定尺寸的盒子，放很多东西，显然会装满，你想做的事情也是如此。

您需要动态调整字体大小或 div 宽度/高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:39:38.680

查看[FitText 文档](https://github.com/davatron5000/FitText.js)。它很简单：

```
$("#div_id").fitText(); 
```

尽管如此，FitText 还是根据容器的*宽度*而不是高度进行计算。如果您想将文本放在*一行*中，这很好，但如果您想将它放在一个框中，则不是很有用。

# javascript - 4 个切换按钮互相说 javascript，但没有一个是好的听众 - 续集：愚蠢反击

> ID：11836256
> 
> 赞同：2
> 
> 时间：2012-08-06T21:30:47.923
> 
> 标签：javascript, arrays, toggle, lightbox, return-value

这是该线程的续集： [4 个切换按钮相互讲 javascript，但没有一个是好的听众](https://stackoverflow.com/questions/11814832/4-toggle-buttons-speak-javascript-to-each-other-but-none-of-them-are-good-listen)

当@nbrooks - 由善良的力量重振旗鼓 - 征服了所有愚蠢放置的数组时，我们的英雄已经克服了最初在小提琴[http://jsfiddle.net/EjW7A/8/](http://jsfiddle.net/EjW7A/8/) （不再可用）中出现的荒谬的废话，功能和他的解决方案的大量冗余内容：http:
[//jsfiddle.net/EjW7A/24/](http://jsfiddle.net/EjW7A/24/)

经过 8 小时的戳戳、刺激、喝红牛、猛烈抨击混凝土墙，我们重新加入了 Luhring，这是解决厄运实施的史诗问题的最后一步：

# 新小提琴：

[http://jsfiddle.net/Luhring/EjW7A/38/](http://jsfiddle.net/Luhring/EjW7A/38/)

# 问题：

如何动态插入内容 - 允许每个按钮切换它自己的内容，同时确保其他按钮被关闭并隐藏它们的内容？例如，如果按钮 1 处于打开状态（它会像“真正的”按下按钮一样进行动画处理），按钮 1 的内容会显示在图库中，单击内容可以显示灯箱。单击按钮 2 时，应关闭按钮 1 并用其自己的内容替换按钮 1 的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T08:51:05.190

[**新的工作演示**](http://jsfiddle.net/EjW7A/45/)

任何在 DOM 元素上调用 jQuery 的东西都必须包含在 DOM 就绪函数中才能正常工作（这就是你`$('a').click()`失败的原因。另外，通常如果你看到自己创建了多个你永远不会使用的数组，但最终还是会直接引用每个元素, 你浪费了很多精力。我清理了你的代码 - 看看：

```
jQuery(document).ready(function($) {
    //variable declaration section.
    var contentArray = ['albumArt', 'logoDesign', 'UX', 'other'],
        content = {}, newClassName, $selectedArray, i;

    for ( i = 0; i < contentArray.length; i++) {
        var className = contentArray[i];
        content[className] = $('.' + className);
    }

    //prevent links that are clicked from going anywhere
    $("a").click(function(e) {
        e.preventDefault();
    });

    $('.workTypes').click(function() {
        if ($(this).is('#centeringDiv a')) return;

        $(this).toggleClass('workTypesSelected');
        $('.workTypesSelected').not(this).removeClass('workTypesSelected');

        $selectedArray = content[$('.workTypesSelected').attr('id')];
        $('#galleryDiv').empty();

        if ( $selectedArray ) {
            // note creates #largeGallery elements dynamically
            for ( i = 0; i < $selectedArray.length; i++ ) {
                var $selected = $selectedArray.eq(i);

                $('<a>').attr({
                    href: $selected.attr('href'),
                    title: $selected.attr('title'),
                    class: "lb_gal"
                }).append(
                    $('<img>').attr({
                        id: "largeGallery"+i,
                        src: $selected.attr('href'),
                        class: "gallery cf"
                    }).rlightbox()
                )
                .appendTo('#galleryDiv')
                .rlightbox();
            }
        }

    }); // end click handler
}); //end the document ready jquery function​ 
```

# java - SyntaxHighlighter 与 php 加载页面？

> ID：11836261
> 
> 赞同：1
> 
> 时间：2012-08-06T21:31:07.253
> 
> 标签：java, highlighting, syntaxhighlighter

我正在尝试将 Alex Gorbatchevs Syntax Highlighter 与各种 java 示例结合使用。我不想将每个示例复制并粘贴到它自己的 html 页面中，而是喜欢使用 php 来获取文件名和路径，然后在“pre”标签之间加载文本内容......就像

```
<?php
echo "<pre>";
include ("$filename");
echo "</pre>";
?> 
```

显然，由于它位于“pre”标签之间，因此呈现为

```
include("$filename"); 
```

非常突出... =P

有什么对我有用的吗？还是我坚持复制和粘贴？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:37:35.213

不要使用 include() 方法来执行此操作 - 而是使用 php 的“fopen”命令进行读取/播放。[http://php.net/manual/en/function.fopen.php](http://php.net/manual/en/function.fopen.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T14:34:44.733

你确定吗？我已经重现了这个场景并且对我来说很好：

代码.php

```
<? echo "this is my code"; ?> 
```

语法.php

```
<?
$filename = "code.php";

echo "<pre>";
include("$filename");
echo "</pre>";
?>

<script type="text/javascript">
     SyntaxHighlighter.all()
</script> 
```

输出：

```
1  this is my code 
```

# c# - 在 C# 中的位移位中捕获丢失的字节

> ID：11836262
> 
> 赞同：3
> 
> 时间：2012-08-06T21:31:14.360
> 
> 标签：c#, .net, bit-manipulation

如果您想知道一个字节中是否设置了特定位，一个简单的 AND 掩码就可以解决问题。我想知道是否有更快的方法来实现同样的目标。例如，位移 << 或 >> 返回位移后的数字，而不是刚刚“脱落”的位。

如果托管代码中没有替代方案，编写不安全的程序集会使其更快吗？如果是这样，请解释如何。

上下文：这是针对需要针对生产代码进行高度优化的复杂算法。我觉得有必要澄清这一点，以避免可怕的“做你自己的功课”评论和/或投票否决。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:42:47.727

要通过移位操作执行位测试，您必须将其移位（无符号）两次，以从任一侧剔除多余的位（您无需将其放回任何特定位置 - 只需测试为零） . 这很复杂并且不是最优的。

奇怪的是，an`&`是执行位测试的标准方式，并且已经过大量优化；这是一条单 CPU 指令，速度非常快。

只需使用`&`测试，例如`if((x & MASK) != 0)`.

不，`unsafe`代码在这里不会真正帮助您。`unsafe`主要对指针感兴趣。指针很有趣，但没有它们你也可以做**完全相同**的位测试。这里指针的一个潜在用途是，如果有某种方法可以使用指针强制来一次测试比最初情况*更多*`byte[]`的数据，例如，如果你有一个，但你想一次测试 8 个字节，通过强制`byte[]`to a `byte*`，然后`byte*`to a `long*`or `ulong*`。这可能是一个有用的优化，比如 web-socket 掩码（它使用更宽的 xor 掩码对字节流进行操作）。但是，对于简单的位测试，这些都不是必需的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T23:07:28.217

如前所述：按位运算非常高效。在任何现代处理器上，几乎可以肯定任何此类操作都在单个时钟周期内执行。

如果您想查看为您的表达式生成的实际代码，请在 Visual Studio 调试器中启动它。设置一个断点，当你点击它时，点击菜单：Debug..Windows..Disassembly。

也许，如果您的表达式足够复杂，您可以在这类事情上击败编译器和优化器，但我对此表示怀疑。更重要的是，您遇到的任何性能问题都不太可能与位旋转有关。在遇到问题之前不要进行优化。正如詹姆斯迈克尔黑尔所说：

> 记住优化的两条定律。我不确定我第一次听到这些的地方，但它们是如此真实：
> 
> *   对于初学者：不要**优化**。
> *   对于专家：尚未**优化**。
> 
> 这是真的。如果您是初学者，请**抵制**不惜一切代价进行优化的冲动。如果您是专家，请**推迟**该决定。只要你为你的任务选择了正确的数据结构和算法，你的表现可能就绰绰有余了。有可能是网络、数据库或磁盘命中会降低您的速度，而不是您的代码。正如他们所说，98% 的代码瓶颈存在于 2% 的代码中，因此过早的优化可能会增加不会产生任何可衡量影响的维护和安全债务。
> 
> 取而代之的是，为了可维护性和安全性而编写代码，然后，只有这样，当您发现真正的瓶颈时，您才应该返回并进一步优化。

更多在这里：

*   [过早的优化](http://c2.com/cgi/wiki?PrematureOptimization)
*   [过早优化的危险](http://scientopia.org/blogs/goodmath/2011/05/03/the-perils-of-premature-optimization/)

请参阅[Bit-Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)了解如何完成与位操作相关的任何事情。面向 C 语言，但相同的技术在 C# 中只需稍加修改即可工作（例如，任何涉及指针的事情都可能需要重新考虑）。

# javascript - 护照资料 ID

> ID：11836272
> 
> 赞同：1
> 
> 时间：2012-08-06T21:32:06.170
> 
> 标签：javascript, node.js, passport.js

我正在使用 passport.js 为我的 node.js 应用程序提供 OAuth 身份验证。但我确实有一个疑问：

当我在身份验证时收到配置文件对象时（当您定义 OAuth 策略时）对于所有提供者是唯一的还是特定于该提供者？

```
passport.use(new FacebookStrategy({
    clientID: conf.fb.appId,
    clientSecret: conf.fb.appSecret,
    callbackURL: "http://local.host:3000/auth/facebook/callback"   },   function(accessToken, refreshToken, profile, done) {
    var user = users[profile.id] || 
                (users[profile.id] = { id: profile.id, name: profile.username });
    done(null, user);   } )); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T05:41:41.503

它特定于提供者。在这种情况下，它将是 Facebook ID。

建议您创建自己的用户记录（在您选择的数据库中），并将提供者 ID 与该记录相关联。这样做还可以轻松实现“连接”帐户，因此用户可以链接其他帐户（例如 Facebook 和 Twitter），然后使用其中任何一个登录。

# oracle11g - 无法创建新连接或登录添加的用户？

> ID：11836273
> 
> 赞同：0
> 
> 时间：2012-08-06T21:32:14.523
> 
> 标签：oracle11g, oracle-sqldeveloper

我正在使用 Oracle SQL Developer 连接到 Oracle Express 11g 并创建一个新用户。当我尝试创建新连接（并对其进行测试）或尝试使用新创建的用户名和密码登录时（通过右键单击默认连接“xe”中的“其他用户”表而疯狂），我不断收到相同的错误)

错误-

> 失败 - 测试失败：ORA-01017：用户名/密码无效；登录被拒绝

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-06T21:37:10.423

似乎您使用的用户权限不足，请尝试使用“系统”用户。那应该可以解决您的问题。

验证您创建的用户的权限。

# emacs - Elisp：缓冲区菜单

> ID：11836275
> 
> 赞同：0
> 
> 时间：2012-08-06T21:32:26.953
> 
> 标签：emacs, menu, elisp

每次我在 Emacs 中按 CTRL + 左键单击时，我都会得到所有打开的缓冲区的列表。如何更改默认输出以弹出自己自定义的菜单，我有这样的想法：

```
Buffer Menu  
-----------
dot.C     >  ex1.c  
dot.java     ex2.c
dot.lisp     ex3.c
dot.?  
... 
----------- 
```

例如，每个 .c 文件都将存储在 dot.c 条目中，如上所示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T10:11:50.933

您是说您有一个文件菜单`.c`和另一个`.h`文件菜单，即使它们都使用相同的主要模式？标准菜单根据主要模式进行分类，所以我认为您需要自定义菜单代码来实现这一点。

想到的一个 hacky 方法是定义最小派生的主要模式，以便将每个模式与不同的文件扩展名相关联，然后您*可以*使用现有菜单来实现您的目标。

如果您不是这个意思，并且按主要模式分组很好，那么当前系统应该已经提供了解决方案。

在任何一种情况下，以下内容都可能有用：

*   [如何在 Emacs 中设置鼠标缓冲区菜单中的项目数？](https://stackoverflow.com/questions/10710467/how-do-i-set-the-number-of-items-in-the-mouse-buffer-menu-in-emacs)
*   `M-x` `apropos-variable` `RET` `mouse-buffer-menu` `RET`

# java - 爪哇玩！2 - 缓存.删除

> ID：11836279
> 
> 赞同：7
> 
> 时间：2012-08-06T21:32:46.600
> 
> 标签：java, playframework-2.0, ehcache

[http://www.playframework.org/documentation/2.0.2/JavaCache](http://www.playframework.org/documentation/2.0.2/JavaCache)

Atm 我找不到 Cache.remove 方法。估计还没实现？

然后我现在需要使用第 3 方库缓存解决方案，例如 memcached。

```
// 2.0 final
Cache.set("item.key", null, 0)
// later
Cache.remove("item.key") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T21:46:48.923

虽然完全不清楚，但可以理解为：

由于`Play 2.0 final`要删除缓存条目，请使用：

```
Cache.set("item.key", null, 0); 
```

（它会`item.key`用`null`值设置缓存，0秒后过期）

“稍后”表示有人忘记添加此方法，稍后会添加；）

**编辑：**

[Play 的 Lighthouse](https://play.lighthouseapp.com/projects/82401/tickets/254-add-a-cacheapiremove-method)已经解决了这个问题

# postgresql - sql查询分解每个组合的计数

> ID：11836280
> 
> 赞同：1
> 
> 时间：2012-08-06T21:32:47.033
> 
> 标签：postgresql, group-by

我需要一个 Postgresql 查询，它返回每种类型的记录组合的计数。

例如，我有一个表 T，其中包含 A、B、C、D、E 列和其他不重要的列：

```
药片
--------------
一个 | 乙| C | D | 乙

```

查询应返回一个表 R，其中包含 A、B、C、D 列的值，以及每个配置在指定 E 值下发生的次数。

```
表 R
---------------
一个 | 乙| C | D | 数数

```

当每条记录的所有计数加在一起时，它应该等于原始表中的记录总数。

这似乎是一个非常简单的问题，但由于我缺乏 SQL 知识，我无法弄清楚如何做到这一点。

我能想到的唯一解决方案是：

```
select a, b, c, d, count(*)
  from T
  where e = 'abc'
  group by a, b, c, d 
```

但是当从这个查询中添加计数时，它比原始表的计数要多。似乎不应该使用 count(*) ，或者我只是完全以错误的方式去做。我真的很感激任何关于我应该如何去做的建议。谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:28:34.263

我想通了，这真的很愚蠢。比较计数时，我忘记在 select count(*) 中指定 where 'E' = 'ABC' 子句。无论如何，谢谢你们的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:01:34.350

`NULL`价值观不可能骗过你。考虑这个演示：

```
WITH t(a,b,c,d) AS (
    VALUES
     (1,2,3,4)
    ,(1,2,3,NULL)
    ,(2,2,3,NULL)
    ,(2,2,3,NULL)
    ,(2,2,3,4)
    ,(2,NULL,NULL,NULL)
    ,(NULL,NULL,NULL,NULL)
    )
SELECT a, b, c, d, count(*)
FROM   t
GROUP  BY a, b, c, d
ORDER  BY a, b, c, d;

 a | b | c | d | count
---+---+---+---+-------
 1 | 2 | 3 | 4 |     1
 1 | 2 | 3 |   |     1
 2 | 2 | 3 | 4 |     1
 2 | 2 | 3 |   |     2
 2 |   |   |   |     1
   |   |   |   |     1 
```

这里一定有其他的误解。

# c# - 从 SQL Server 读取 blob 并下载

> ID：11836283
> 
> 赞同：1
> 
> 时间：2012-08-06T21:32:59.570
> 
> 标签：c#, asp.net, sql-server, blob

我正在更新一个 asp.net 应用程序并从 mssql 数据库中保存和检索文档。保存非常简单，但是有没有办法从直接从数据库下载的锚点下载文件？假设该 blob 绑定在 gridview 或其他一些数据控件中，我想这样做，例如：`<a href="<%#Eval("blobcolumn")%">Download Doc</a>`. 我也保存文件名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:57:53.027

首先，您不会将图像分配给 href 元素，而是创建一个 img 标签来显示图像，然后使用 href 标签下载它或将图像标签直接嵌入到 href 中：

```
<a href="http://somelink.com"><img src="<%#Eval("blobcolumn")%></img></a> 
```

其次，将不带 URL 的图像内联显示到文件需要[Data URI](http://en.wikipedia.org/wiki/Data_Uri)，这意味着网页中嵌入了 base-64 版本的图像：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"> 
```

这种方法意味着您的网络服务器和最终用户的机器上的大量额外流量，因为如果您在网络服务器中提供了图像的实际 URL（即 /images/reddot.png），图像将不会被缓存）。

我认为最好将图像的副本保存到 Web 服务器并在页面中提供这些图像的 url。

如果担心文件的大小或数量，您可以创建批处理作业以从临时图像缓存中清除超过特定天数或数小时的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T02:59:38.270

您可以创建一个*处理*程序来下载数据。

样本.ashx

* * *

```
public void ProcessRequest (HttpContext context) 
{
  string id = context.Request["id"];
  if (!string.IsNullOrEmpty(id))
     {
       //read byte[] and other data from database based upon given ID
       byte []ar=//result from database
       string fileName=//filename 
       context.Response.ContentType = "Application/octet-stream";
       context.Response.AddHeader("Content-Length", ar.Length.ToString());
       context.Response.AddHeader("Content-Disposition", "attachment; filename=" +  fileName );
       context.Response.BinaryWrite(ar);
       context.Response.Flush();
       context.Response.End();
      }
} 
```

并通过超链接请求

```
<a href="sample.ashx?id=101">Download .zip</a>
<a href='sample.ashx?id=<%#Eval("ID")%>'><%#Eval("Desc")%></a> 
```

# python - 使用 pandas 和 statsmodels 时提取变量名

> ID：11836286
> 
> 赞同：4
> 
> 时间：2012-08-06T21:33:08.727
> 
> 标签：python, pandas, statsmodels

我正在尝试从`statsmodels`. 我将在示例代码之后详细说明。

```
import scikits.statsmodels.api as sm
import pandas as pd
data = sm.datasets.longley.load()
df = pd.DataFrame(data.exog, columns=data.exog_name)
y = data.endog
df['intercept'] = 1.
olsresult = sm.OLS(y, df).fit() 
```

此摘要输出包括变量名称。当您调用类似 olsresult.params 的内容时，它会返回以下内容：

```
In [21]: olsresult.params
Out[21]: 
GNPDEFL           15.061872
GNP               -0.035819
UNEMP             -2.020230
ARMED             -1.033227
POP               -0.051104
YEAR            1829.151465
intercept   -3482258.634596 
```

现在我很好奇的是创建一个像字典一样的东西，变量名作为键，参数值作为值。所以，诸如此类的东西`{'GNPDELF':15.0618, 'GNP':-0.035819}`。如果不可能做到这一点，有没有其他方法可以单独访问变量名称和值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:41:15.663

总是值得尝试显而易见的.. :^)

```
In [14]: olsresult.params
Out[14]: 
GNPDEFL           15.061872
GNP               -0.035819
UNEMP             -2.020230
ARMED             -1.033227
POP               -0.051104
YEAR            1829.151465
intercept   -3482258.634597

In [15]: dict(olsresult.params)
Out[15]: 
{'ARMED': -1.0332268671737328,
 'GNP': -0.035819179292614578,
 'GNPDEFL': 15.061872271452557,
 'POP': -0.051104105653539733,
 'UNEMP': -2.0202298038172479,
 'YEAR': 1829.151464613984,
 'intercept': -3482258.6345966831} 
```

另见对象的`.to_dict()`方法。`Series`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T10:04:04.987

`olsresult.params` is a pandas.Series object which is dict like, maybe you don`t need to convert to a dict.

```
In [12]: olsresult.params.get('GNP')
Out[12]: -0.035819179292566283

In [13]: olsresult.params['GNP']
Out[13]: -0.035819179292566283

In [14]: for key, value in olsresult.params.iteritems():
   ....:     print key, value
   ....:
GNPDEFL 15.0618722714
GNP -0.0358191792926
UNEMP -2.02022980382
ARMED -1.03322686717
POP -0.0511041056537
YEAR 1829.15146461
intercept -3482258.6346 
```

# windows - windows 上的 monodevelop 3.0.4.2 和 MVC4 上的 mono.2.10.8 问题

> ID：11836287
> 
> 赞同：1
> 
> 时间：2012-08-06T21:33:09.707
> 
> 标签：windows, mono, asp.net-mvc-4, monodevelop

我很高兴将一个 mvc4 beta 网站与 monodevelop 一起部署到我的 mac 上的 appharbor，这是一次不错的体验。

然而，我决定启动我的 windows 机器并使用相同的工具在 windows 上工作，但它并不那么顺利。

使用 monosoft 调试器进行调试时出现以下错误：

> System.Net.WebException：请求在 C:\cygwin\tmp\monobuild\build\BUILD\mono-2.10.8\mcs\class\ 中的 System.Net.HttpWebRequest.EndGetResponse (System.IAsyncResult) [0x00046] 处超时System\System.Net\HttpWebRequest.cs:824 在 System.Net.HttpWebRequest.GetResponse () [0x0000e] 在 C:\cygwin\tmp\monobuild\build\BUILD\mono-2.10.8\mcs\class\System\ System.Net\HttpWebRequest.cs:836

我已经尝试了每种类型的 WebRequest/WebClient 组合来解决这个问题，但超时是立即的。mac o/s 上的相同代码很好，在生产中也可以正常工作。

我已经安装了 mozroots --sync 并尝试了框架的每个稳定版本和 beta/alpha 版本以及 windows 上的 monodevelop，但我无法获得一个正常工作的开发环境。

![monodevelop 使用的运行时](../Images/3b2a7ee3861ec73a0af6ae8bf2238006.png)

![bin 部署了可在 Mac OS 和 appharbor 上运行的 dll](../Images/6f6076325084cfe0349c2b4fb0650518.png)

如果有人有任何想法，我将不胜感激。

# objective-c - 在哪里设置弹出框大小？

> ID：11836294
> 
> 赞同：19
> 
> 时间：2012-08-06T21:33:37.833
> 
> 标签：objective-c, ios, uitableview

我有一个`UIViewController`被调用的`HomeViewController`，它有一个包含数据数组的模型。 `HomeViewController`还有一个按钮，按下时会显示`UITableViewController`模型的数据数组。

我的问题是，设置弹出框大小的标准/最佳方法是什么？我只希望弹出窗口足够高以显示数据，但不能更高。什么是普遍做法？我假设我需要`contentSizeForViewInPopover`在某个时候进行设置，但我不确定在哪里......在`viewDidLoad`popover 类的方法中？在`prepareForSegue`方法上？

这是我到目前为止的代码：（请注意，这`DataPresentingViewController`是我的弹出视图控制器类`）

```
//In HomeViewController
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.destinationViewController isKindOfClass:[DataPresentingViewController class]])
    {
        DataPresentingViewController *dest = (DataPresentingViewController *) segue.destinationViewController;
        dest.mySavedData = self.myModel.mySavedData;
    }
} 
```

我知道我可以`contentSizeForViewInPopover`在方法中设置这里`prepareForSegue`；然而，这似乎是 popover 类应该处理的事情。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-11-27T04:31:31.340

自 iOS7 起`contentSizeForViewInPopover`已弃用。您应该改用`UIViewController`'`preferredContentSize`属性。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-16T10:48:30.107

`contentSizeForViewInPopover`在`ViewDidLoad`方法中设置`HomeViewController`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-01-07T23:51:36.580

`contentSizeForViewInPopover`在 iOS 7 中已弃用UIPopoverController
的属性：`popoverContentSize`表示由 UIPopoverController 的 contentViewController 属性中的视图控制器管理的内容视图的大小。
[参考](https://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html#//apple_ref/occ/instp/UIPopoverController/popoverContentSize)

优点是它在 iOS 3.2 及更高版本中可用，因此您不需要每次都检查设备版本，只需将`contentSizeForViewInPopover`方法替换为您的 UIPopOverController 对象实例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-18T13:33:43.133

你有没有尝试过：

```
setPopoverContentSize:<#(CGSize)#> animated:<#(BOOL)#> 
```

在你的 segue 逻辑块中。如果您希望弹出框大小根据数据集或视图位置等而变化，这很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-17T10:38:32.527

```
// self.contentSizeForViewInPopover = CGSizeMake(320.0, 600.0); //Deprecated in ios7

self.preferredContentSize = CGSizeMake(320.0, 600.0); //used instead 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-15T04:30:15.807

试试下面的代码：

```
- (IBAction)setData:(id)sender
{
    UIViewController *popoverContent=[[UIViewController alloc] init];
    UITableView *tableView=[[UITableView alloc] initWithFrame:CGRectMake(265, 680, 0, 0) style:UITableViewStylePlain];

     UIView *popoverView=[[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 300)];

     popoverView.backgroundColor=[UIColor whiteColor];

    popoverContent.view=popoverView;
    popoverContent.contentSizeForViewInPopover=CGSizeMake(200, 420);//setting the size
    popoverContent.view=tableView;
    tableView.delegate=self;
    tableView.dataSource=self;

    self.popoverController=[[UIPopoverController alloc] initWithContentViewController:popoverContent];
    [self.popoverController presentPopoverFromRect:CGRectMake(400, 675, 0, 0) inView:self.view permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES];
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-07T18:10:46.423

一个鲜为人知的调整你的大小`UIPopoverViewController`以匹配你的高度的技巧`UITableView`是使用 tableView 的`rectForSection`方法来给你高度。像这样使用 viewController 中的高度`contentSizeForViewInPopover`：

```
- (CGSize)contentSizeForViewInPopover {
    // Currently no way to obtain the width dynamically before viewWillAppear.
    CGFloat width = 200.0; 
    CGRect rect = [self.tableView rectForSection:[self.tableView numberOfSections] - 1];
    CGFloat height = CGRectGetMaxY(rect);
    return (CGSize){width, height};
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-06T22:11:35.377

看起来您想以编程方式执行此操作，但在情节提要中，在将视图控制器连接到 segue 之前，在属性检查器下有一个“弹出框，使用显式大小选项”。也许您可以先设置最适合您的应用程序的大小，而不必担心使用代码的大小。希望这会有所帮助，让我们知道它是怎么回事。

# scripting - WinSCP：当前 SFTP-3 会话不支持您请求的命令。可以打开单独的 shell 会话来处理命令

> ID：11836302
> 
> 赞同：2
> 
> 时间：2012-08-06T21:33:58.333
> 
> 标签：scripting, winscp

我正在使用 WinSCP 与仅支持 SFTP 并且不允许 SSH 访问的远程服务器进行交互。

我的交互涉及移动/删除某个目录中的文件子集（由文件名标识）。

为了简化这一点，我通常会同步 [ Remote -> Local ]，使用 cygwin 命令行在本地删除文件（这样我可以指定文件名列表而不是在 GUI 中选择文件），然后同步 [ Local -> Remote ] 将删除推送到远程。

但是，现在，我想进一步简化流程，以便将其交给运营人员。我去寻找并很高兴地发现 WinSCP 支持“命令”。

如果我可以在 WinSCP 的“指挥官”视图底部的“命令”字段中输入类似的内容，那就太好了：

```
get queue-queue-from-DLQ-ID-69703273-db51-11e1-ba9f-005056010165 \
    queue-queue-from-DLQ-ID-3d64697a-db51-11e1-b86e-005056010166 \
    queue-queue-from-DLQ-ID-76fdb365-db50-11e1-b78d-005056010164 \
    queue-queue-from-DLQ-ID-76ed3836-db50-11e1-ba9f-005056010165 
```

但是当我在“命令”字段中输入这个时，我收到以下错误：

> 当前 SFTP-3 会话不支持您请求的命令。可以打开单独的 shell 会话来处理命令。您想打开单独的 shell 会话吗？

![错误 1](../Images/0cc7353f0e74c8270b5d2f65c7614439.png)

当我点击确定时，我收到以下错误：

> 跳过启动消息时出错。您的 shell 可能与应用程序不兼容（推荐使用 BASH）。

![错误 2](../Images/e7ab67f1341cf48f109ae49ce1536786.png)

后一种可能是因为不支持SSH。

但我的问题是，既然`get`是 SFTP 命令，为什么我会收到第一个错误？WinSCP 本身不是在幕后使用该命令来支持 GUI“复制到本地”操作吗？

如何配置 WinSCP 或 Linux 机器，以便我可以执行上面显示的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:09:21.233

我想这回答了我的问题：[http ://winscp.net/eng/docs/remote_command](http://winscp.net/eng/docs/remote_command)

显然，仅 SCP 支持“命令”功能。

我想知道为什么 WinSCP 不能为 sftp 交互式会话期间通常支持的 SFTP 操作公开命令行界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T14:16:13.683

您可以使用 WinSCP 命令行脚本界面来运行该`get`命令。

[https://winscp.net/eng/docs/scripting](https://winscp.net/eng/docs/scripting)

* * *

即使是 SFTP 协议也支持“命令”功能（远程命令执行）。但是此功能在远程服务器上执行命令。您不能使用此功能来自动化 WinSCP。并且没有可以轻松用于下载文件的远程命令。
请参阅[https://winscp.net/eng/docs/remote_command](https://winscp.net/eng/docs/remote_command)

# xcode - Xcode 编译不断从 HD 中占用更多空间？

> ID：11836303
> 
> 赞同：1
> 
> 时间：2012-08-06T21:34:10.230
> 
> 标签：xcode, macos, project, hard-drive

我有一个项目，其中有一些常规文件和一些 3rd 方库。我也有 2 个静态库。问题是，每当我构建项目时，我的笔记本电脑的 HD 空间都会不断减少。

我的构建是否在某个地方举行？为什么它不断地从我的 HD 中占用越来越多的空间？

到目前为止，我已经从这个问题中损失了大约 20GB。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T09:27:47.403

仅作记录，以便可以将其存档为已回答：

您是否尝试清理构建本身？您可以通过以下路径找到它们：`/Users/{user}/Library/Application\ Support/iPhone\ Simulator/5.1/Applications/`每个模拟器都有自己的文件夹。您应该尝试删除所有具有这种签名的文件夹：`1890A6A8-3EBB-443A-B220-CB8BE265999B`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-21T21:46:46.967

要检查的另一件事是在*DerivedData/Build/Intermediates*和*DerivedData/.../Index*中具有散列名称的*PrecompiledHeaders*文件夹（至少对于 xcode 7）。它们只是随着每次构建而累积，每个可以达到数十 MB。

 **检查它们大小的脚本是

```
find <your-dev-folder> -type d -path '*/DerivedData/*/PrecompiledHeaders' -exec du -s -m '{}' \; | sort -n 
```

删除它们都做

```
find <your-dev-folder> -type d -path '*/DerivedData/*/PrecompiledHeaders' -exec rm -rf '{}' \; 
```**

# javascript - Conflicting Javascript libraries with Fusion Charts and JQWidgets

> ID：11836305
> 
> 赞同：0
> 
> 时间：2012-08-06T21:34:22.230
> 
> 标签：javascript, jquery, jquery-plugins, fusioncharts

So at work, I've been tasked with using two Javascript libraries (Fusion Charts and JQWidgets) to build a couple of web apps.

With Fusion charts, you have the ability to render charts in Flash or in Javascript. Our app updates the charts based on certain criteria through AJAX calls and all is fine when the charts are rendered in Flash. However, when rendering it Javascript, when the update method is called for the JQWidgets Grid component, it throws an error in one of the Fusion Charts included files.

I've chalked this up to conflicting method names in the respective libraries. After searching their forums, one of the moderators suggested re-writing the libraries "hooks." I am not a JS pro, and have no idea what that would entail. And if I'd even be capable of doing something like this. I was wondering if anyone had a similar experience, or could offer some advice.

Thank you in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T11:39:13.083

尝试更改 .js 文件包含的顺序。把它当前低于的那个放在第一位，反之亦然。

# language-agnostic - 4X4 网格中的哪些单元格彼此相邻？

> ID：11836307
> 
> 赞同：-2
> 
> 时间：2012-08-06T21:34:23.723
> 
> 标签：language-agnostic, multidimensional-array

我有一个数组，将单元格的索引存储在 4X4 网格中，0、1、2、3 等。我知道紧挨着项目 0 的是项目 1（右侧）和项目 4（下）。我将如何编写一个函数来返回与传入的索引直接相邻的单元格索引？

```
function getCellsAround(0)
{
     should return 1 and 4
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:38:16.307

```
public static ArrayList<Point> getPointsAround(Point p, Rectangle r) {
    ArrayList<Point> points = new ArrayList<Point>();
    for(int dx = -1; dx <= 1; dx++) {
        for(int dy=-1; dy <= 1; dy++) {
            if(dx!=0 || dy !=0) {
                Point point = new Point(p.x+dx, p.y+dy);
                if(r.contains(point)) {
                    points.add(point);
                }
            }
        }
    }
    return points;
} 
```

类似的东西？这使用 x, y 坐标（Point 类），而不仅仅是：

（1、2、3

4、5、6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:42:04.230

这对我来说听起来像是家庭作业，所以这是一个总体思路。

为每种类型的邻居创建一个函数。由于您编写了这么多语言，因此不确定您实际使用的是什么。这里是java

```
private Integer getTopNeighbor(int ind) // ....
private Integer getBottomNeighbor(int ind) // ....
private Integer getLeftNeighbor(int ind) // ....
private Integer getRightNeighbor(int ind) // ....

public Integer[] getAllNeighbors(int ind) // use the four above to determine 
```

然后其中一些可能为空（例如第一个索引 0 不会有左或上邻居）。所以检查所有这些并返回非空的。

只是为了让您开始，getRightNeighbor 将是 ind + 1 并进行一些边界检查。

# javascript - 使用 chrome web 开发者工具在 HTML5 中调试 javascript

> ID：11836310
> 
> 赞同：0
> 
> 时间：2012-08-06T21:34:37.647
> 
> 标签：javascript, google-chrome

为了能够直接在 HTML5 代码/库中调试 Eclipse 上的 javascript，我下载了 ChromeWebdeveloper 工具并将其安装在 Eclipse 上。还运行 \chrome.exe --remote-shell-port= 在 chrome 上的端口 9222 上运行调试。但是，当我尝试启动应用程序时，它会显示 - “无法连接到远程浏览器” - 连接超时错误。

任何线索这里出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:37:07.630

您已经拥有 Chrome。

Chrome 自带了一个*非常好的*调试器！

只需按下`CTRL + SHIFT + J`启动它，然后单击`Sources`：

[![铬调试器](../Images/28e063c2e9ca44e752ede340a4b551be.png "哦哦，这太神奇了……你知道！")](https://i.stack.imgur.com/rLYII.png "哦哦，这太神奇了……你知道！")

# java - 授予对受保护文件的字词的权限

> ID：11836313
> 
> 赞同：4
> 
> 时间：2012-08-06T21:34:50.827
> 
> 标签：java, security, permissions, administrator

我需要以编程方式编辑、写入或删除受保护的文件。在 Windows 中，如果我手动操作，它会请求许可，而在 Unix 系统中我需要“sudo”。

在执行期间如何在 Java 中要求更高的权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T02:57:49.823

如果您的程序需要高级访问权限，最好告知用户他们需要以 root / 特权帐户运行它才能工作。否则，最好的选择是启动一个使用“sudo”初始化的新“代理进程”，然后执行您想要的程序，例如“sudo cp File1 File2”，它将为您执行您的脏活。不幸的是，这不是跨平台的，需要用户密码。根本不可能在执行期间将 JVM 撞到更高的用户，因为这会带来巨大的安全风险。

md_5

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T03:02:31.723

因为 Java 使用虚拟机工作，所以您不能仅以提升模式启动（例如）另一个线程。相反，您需要启动一个全新的虚拟机，您将无法连接到该虚拟机。

我会研究执行可以以提升的权限运行的单独 Java 进程的方法。您仍然可以使用相同的代码，但将其作为主要方法。

你不能仅仅提高你的特权。

我可能完全错了，很高兴被别人展示出来。

# ruby - 可以在键值对的值中引用键吗？

> ID：11836317
> 
> 赞同：0
> 
> 时间：2012-08-06T21:35:45.743
> 
> 标签：ruby

例如，假设我想这样做：

```
{
  :mytime => times[:mytime]
} 
```

这里有一些重复，是否可以只做类似`{ :mytime => times[$_key] }`（组成语法）的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:53:45.030

简短的回答是：不，没有语法可以做这样的事情。如果没有更多关于您实际尝试做的事情的背景信息，那么就没有一个很好的更长的答案。不过，我会尝试变得更有用一些。如果您真的担心重复，您可以执行以下操作：

```
h = {}
[:mytime, :yourtime].each do |k|
  h[k] = times[k]
end 
```

只有几个键，我个人认为这是不值得的。

# ios - iOS中的1bpp UIImage

> ID：11836318
> 
> 赞同：1
> 
> 时间：2012-08-06T21:35:54.197
> 
> 标签：ios

我想创建一个黑白图像，所以它是 1bpp。现在这是我的代码，它根据阈值将图像转换为黑白：

```
- (UIImage *)pureBlackAndWhiteImage:(UIImage *)image value:(float)value {

    unsigned char *dataBitmap = [self convertUIImageToBitmapRGBA8:image];

    for (int i = 0; i < image.size.width * image.size.height * 4; i += 4) {

        if ((dataBitmap[i + 0] + dataBitmap[i + 1] + dataBitmap[i + 2]) < value) {
            dataBitmap[i + 0] = 0;
            dataBitmap[i + 1] = 0;
            dataBitmap[i + 2] = 0;
        } else {
            dataBitmap[i + 0] = 255;
            dataBitmap[i + 1] = 255;
            dataBitmap[i + 2] = 255;
        }
    }
    image = [self convertBitmapRGBA8ToUIImage:dataBitmap withWidth:image.size.width withHeight:image.size.height];

    return image;
} 
```

然而，这个图像仍然是 8bpp。我怎样才能使它成为1bpp？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:15:43.670

我不知道您指的是什么方法，但是第二种方法确实声称可以从 RGBA 数据集生成图像，那么您为什么期望 1bpp？

坦率地说，我不知道 iOS 是否甚至可以支持 1bpp。如果您不能确定答案是否定的，您可能需要进行试验。

您需要做的是首先渲染现有的 RGBA 图像并访问像素（看起来您已经完成了。然后您需要 malloc 一块内存并根据需要写入图像 - 每个像素 1 位。当你有这些数据，你可以使用以下方法获取 CGImageRef：

```
CGImageRef CGImageCreate (
   size_t width,
   size_t height,
   size_t bitsPerComponent,
   size_t bitsPerPixel,
   size_t bytesPerRow,
   CGColorSpaceRef colorspace,
   CGBitmapInfo bitmapInfo,
   CGDataProviderRef provider,
   const CGFloat decode[],
   bool shouldInterpolate,
   CGColorRenderingIntent intent
); 
```

和一个 UIImage 。

# python - pywin32和excel。写入大量数据时的异常

> ID：11836319
> 
> 赞同：5
> 
> 时间：2012-08-06T21:35:56.743
> 
> 标签：python, excel, pywin32

我目前正在尝试使用 pywin32 库将大量数据写入 excel 电子表格。作为我面临的问题的一个简单示例，使用以下代码生成一个 1000 单元 x 1000 单元的乘法表。

```
import win32com.client
from win32com.client import constants as c

xl = win32com.client.gencache.EnsureDispatch("Excel.Application")                             
xl.Visible = True
Workbook = xl.Workbooks.Add()
Sheets = Workbook.Sheets

tableSize = 1000

for i in range(tableSize):
    for j in range(tableSize):
        Sheets(1).Cells(i+1, j+1).Value = i*j 
```

对于较小的值，这有效。但是，对于较大的值，python 程序最终会因错误而崩溃：

```
Traceback (most recent call last):
  File ".\Example.py", line 16, in <module>
    Sheets(1).Cells(i+1, j+1).Value = i*j
  File "C:\PYTHON27\lib\site-packages\win32com\client\__init__.py", line 474, in __setattr__
    self._oleobj_.Invoke(*(args + (value,) + defArgs)) pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, None, None, None, 0, -2146777998), None) 
```

由于这比 xlwt 慢得多，我已经承认失败了，但我仍然对导致此错误的原因感到好奇。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T18:51:26.100

我想到了。

仅当用户在代码运行时与 excel 窗口交互时才会发生该错误。通过`xl.Interactive = False`在使用 excel 进行任何工作之前添加，可以避免这种情况。如果在应用程序可见之前添加它，则没有任何交互的机会。

所以最终的代码是：

```
import win32com.client
from win32com.client import constants as c

xl = win32com.client.gencache.EnsureDispatch("Excel.Application")
xl.Interactive = False
xl.Visible = True
Workbook = xl.Workbooks.Add()
Sheets = Workbook.Sheets

Sheets(1).Cells(1,2).Value = "Test"
print Sheets(1).Cells(1,2).Value

tableSize = 1000

for i in range(tableSize):
    for j in range(tableSize):
            Sheets(1).Cells(i+1, j+1).Value = i*j 
```

# ruby-on-rails - 如何重构这些 Rails 路由？

> ID：11836320
> 
> 赞同：0
> 
> 时间：2012-08-06T21:36:00.327
> 
> 标签：ruby-on-rails, routes

我有以下路线。我希望应用程序的结构保持不变（一个控制器具有多种功能），但我想让路由文件看起来更合理且易于扩展。

```
get 'splunk/ocd/:order_id' => "splunk#order_collection_details"
get 'splunk/ord/:order_id' => "splunk#order_request_details"
get 'splunk/ord_ar/:request_id' => "splunk#ord_associated_requests"
get 'splunk/ord_ad/:user_id/:deal_option_id' => "splunk#ord_additional_details"
get 'splunk/avatax_logs/:order_id' => "splunk#avatax_logs"
get 'splunk/billing_updates/:billing_record_id' => "splunk#billing_updates"
get 'splunk/cc_storage_details/:billing_record_id' => "splunk#cc_storage_details" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:12:30.960

我同意@MikeBrant 的观点，似乎真的不需要重构这个，但如果你真的想，我可能会尝试这样的事情 -

```
controller :splunk do
  get 'splunk/ocd/:order_id' => :order_collection_details
  get 'splunk/ord/:order_id' => :order_request_details
  get 'splunk/ord_ar/:request_id' => :ord_associated_requests
  get 'splunk/ord_ad/:user_id/:deal_option_id' => :ord_additional_details
  get 'splunk/avatax_logs/:order_id' => :avatax_logs
  get 'splunk/billing_updates/:billing_record_id' => :billing_updates
  get 'splunk/cc_storage_details/:billing_record_id' => :cc_storage_details
end 
```

它更有条理，更容易阅读，但如果你的整个应用程序将围绕一个控制器，我不确定我是否看到了这种需要。

# c++ - Visual Studio 2010 Assimp 库不会链接

> ID：11836321
> 
> 赞同：2
> 
> 时间：2012-08-06T21:36:08.833
> 
> 标签：c++, visual-studio-2010, linker, static-libraries, assimp

我似乎有一个永远无法让任何库与 Visual Studio 链接的永久问题。曾经。我最终厌倦了尝试，只手动包含头文件和源文件。

我最近的努力是尝试建立 Assimp。我去下载了最新版本并按照 Visual Studio 2010 的安装指南进行操作。[http://assimp.sourceforge.net/lib_html/install.html](http://assimp.sourceforge.net/lib_html/install.html)

结果：

```
LINK : fatal error LNK1104: cannot open file 'assimp--3.0.1270-sdk/lib/assimp_release-dll_x64/assimp.lib' 
```

我设置了包含目录：

```
assimp--3.0.1270-sdk/include 
```

我设置了库目录：

```
assimp--3.0.1270-sdk/lib/assimp_release-dll_x64 
```

我设置了额外的依赖项（指南包括目录，但我不应该只放 assimp.lib，因为我在上面包含了库目录吗？）：

```
assimp--3.0.1270-sdk/lib/assimp_release-dll_x64/assimp.lib 
```

我究竟做错了什么？

另外，考虑到这不是我第一次遇到这些困难，有没有什么好的教程可以帮助我更好地理解这个过程？我试过搜索它，但大多数都是针对以前版本的 VS...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:22:11.843

我的猜测是您应该为库目录提供明确的相对或绝对路径。

您对依赖项名称是正确的，`assimp.lib`是正确的名称，并且该指南在这里有点模棱两可。

除此之外，你做的一切都是正确的。如果`lib`文件存在，它应该链接。

（assimp 联合创始人在这里写作）

# spring - ClasspathXmlApplicationContext 与当前 ApplicationContext 的父级？

> ID：11836322
> 
> 赞同：0
> 
> 时间：2012-08-06T21:36:14.473
> 
> 标签：spring, spring-3

由于另一个库的要求，我必须`ApplicationContext`在我的 main 中定义`ApplicationContext`一个名称为`default.context`：

```
<?xml version="1.0"?>
<beans>
    <bean name="default.context" class="org.springframework.context.support.ClassPathXmlApplicationContext">
        <constructor-arg>
            <list>
                <value>../other-file.xml
            </list>
        </constructor-arg>
    </bean>

    <bean class="MyNiceDependency"/>
</beans> 
```

我怎样才能使上下文`MyNiceDependency`可用？`default.context`我假设我需要使用的`parent`属性，`ClassPathXmlApplicationContext`但如何将当前上下文注入它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:44:15.550

这是应该完成工作的事情：

```
import org.springframework.beans.BeansException;
import org.springframework.beans.factory.FactoryBean;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;

public class ThisApplicationContextFactoryBean implements FactoryBean<ApplicationContext>,
        ApplicationContextAware {

    private ApplicationContext applicationContext;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext)
            throws BeansException {
        this.applicationContext = applicationContext;
    }

    public ApplicationContext getApplicationContext() {
        return this.applicationContext;
    }

    @Override
    public ApplicationContext getObject() throws Exception {
        return getApplicationContext();
    }

    @Override
    public Class<?> getObjectType() {
        return ApplicationContext.class;
    }

    @Override
    public boolean isSingleton() {
        return true;
    }
} 
```

也许有更好的东西，或者更好的东西，包含在 Spring 中？

# c# - Await 运算符只能在 Async 方法中使用

> ID：11836325
> 
> 赞同：78
> 
> 时间：2012-08-06T21:36:25.930
> 
> 标签：c#, .net, build, .net-4.5, async-await

我正在尝试制作一个简单的程序来测试 Visual Studio 2012 中的新 .NET 异步功能。我通常使用 BackgroundWorkers 异步运行耗时的代码，但有时对于相对简单（但昂贵）的操作来说似乎很麻烦. 新的 async 修饰符看起来很好用，但不幸的是我似乎无法进行简单的测试。

这是我在 C# 控制台应用程序中的代码：

```
static void Main(string[] args)
{
    string MarsResponse = await QueryRover();
    Console.WriteLine("Waiting for response from Mars...");
    Console.WriteLine(MarsResponse);
    Console.Read();
}

public static async Task<string> QueryRover()
{
    await Task.Delay(5000);
    return "Doin' good!";
} 
```

我在 MSDN 上查看了一些示例，在我看来，这段代码应该可以工作，但是我在包含“await QueryRover();”的行上出现了构建错误。我是疯了还是发生了什么可疑的事情？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-08-06T21:52:09.647

只能`await`在`async`方法中使用，[`Main`不能是`async`](http://blog.stephencleary.com/2012/02/async-console-programs.html)。

您必须使用自己的`async`- 兼容上下文，在方法中调用`Wait`返回，或者只是忽略返回并阻止对. 请注意，这会将任何异常包装在.`Task``Main``Task``Read``Wait``AggregateException`

如果您想要一个好的介绍，请参阅我的[`async`/`await`介绍帖子](http://blog.stephencleary.com/2012/02/async-and-await.html)。

# url - 添加页面选项卡对话框不再起作用

> ID：11836326
> 
> 赞同：0
> 
> 时间：2012-08-06T21:36:28.460
> 
> 标签：url, facebook-apps

我曾经让我的用户通过单击通过电子邮件发送给他们的链接或使用添加页面选项卡对话框来添加我的应用程序。两者都在这里描述：http: [//developers.facebook.com/docs/appsonfacebook/pagetabs/](http://developers.facebook.com/docs/appsonfacebook/pagetabs/)

截至周五（2012 年 8 月 3 日），这些似乎都不起作用。用户只会看到一个页面，上面写着“发生错误。请稍后再试”。没有进一步的解释。即使单击上述页面上的示例 URL 也会产生相同的错误。使用任何 Facebook 个人资料登录时，我都会收到任何应用程序的此错误。

有没有人经历过这种情况，如果有，你知道需要改变什么才能让它再次工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:11:43.427

当您的应用缺少**基本**（页面标签 URL、安全页面标签 URL）设置的**页面标签**部分中的设置时，通常会发生这种情况。**如果您的应用启用了沙盒模式**，也会发生这种情况。

 ****我已经提交了一张票以更正该文档页面上的示例链接（谢谢）。****

# jquery - 在显示之前在 div 中加载栏

> ID：11836329
> 
> 赞同：0
> 
> 时间：2012-08-06T21:36:48.163
> 
> 标签：jquery, hide, show, fade

我有以下 Jquery，在单击复选框时，它会重新加载一个 DIV，传递框的值并根据查询显示新项目。

我想有一个“加载”栏3秒左右......在加载DIV的内容之前，之后淡出。然后加载带有淡入效果的 DIV。我尝试了几件事，但没有奏效。

这是我的代码。

谢谢！

```
jQuery(document).ready(function($) {
    $("input:checkbox").change(function() {
        if ($(this).is(':checked')) 
        {
            $(".loadingItems").delay(3000).fadeOut(3000);
            var color = [];
            color.push($(this).val());
            $(".indexMain").load('indexMain.php?color='+color);
        }
        else if ($(this).not(':checked')) 
        {
            $(".indexMain").load('indexMain.php');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:46:01.413

通常认为让您的用户等待三秒钟只是为了展示您的加载栏是不好的做法，当它淡出时，六秒钟过去了，您的用户已经离开了。ajax 调用完成且内容准备好后移除加载栏。另外，您确定应该在查询字符串中使用数组吗？

```
$(function() {
    $("input:checkbox").on('change', function() {
        $(".loadingItems").fadeIn(300); //fade in on change
        if (this.checked) {
            var color = [];
            color.push(this.value); //array in querystring ?
            $(".indexMain").load('indexMain.php?color='+color, function() {
                $(".loadingItems").fadeOut(300); //remove when load is complete
            });
        }else{
            $(".indexMain").load('indexMain.php', function() {
                $(".loadingItems").fadeOut(300);  //remove when load is complete
            });
        }
    });
}); 
```

我会大胆猜测并说这就是你所追求的：

```
$(function() {
    $("input:checkbox").on('change', function() {
        $(".loadingItems").fadeIn(300); //fade in on change
        var qs = this.checked ? 'color='+this.value : '';
        $(".indexMain").load('indexMain.php'+qs, function() {
            $(".loadingItems").fadeOut(300); //remove when load is complete
        });
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:39:34.010

一个简单的`setTimeout()`函数可以延迟命令的执行。

```
$("#loader").fadeIn();
setTimeout(function(){
  $("#loader").fadeOut();  
  $(".indexMain").load('indexMain.php?color='+color);
  ...
},3000); 
```

延迟被指定为`setTimeout`函数中的第二个参数。在这个例子中，我放置了`3000`. 这个数字以毫秒为单位；1 秒 = 1000 毫秒。

参考 -

*   [设置超时（）](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:39:45.957

我认为您正在寻找 jQuery 预加载器？

[http://www.gayadesign.com/diy/queryloader-preload-your-website-in-style/](http://www.gayadesign.com/diy/queryloader-preload-your-website-in-style/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:41:16.460

您可以使用[`fadeOut`](http://api.jquery.com/fadeOut/)方法的回调函数：

> .fadeOut( [duration] [, easing] [, callback] ) `callback`：动画完成后调用的函数。

```
var color = [];
color.push($(this).val());
$(".loadingItems").delay(2700).fadeOut(300, function(){
    $(".indexMain").load('indexMain.php?color='+color);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:43:38.943

这是一个简单的函数，您可以在将某些内容加载到 div 时使用它

```
function loadIntoDiv(div,url){
    $("#loader").fadeIn();
    $(div).load(url,function(){
        $("#loader").fadeOut();
    });
} 
```

例子：`loadIntoDiv(".indexMain",'indexMain.php');`

# ruby - Ruby：如何获取相对于自身的父模块的名称？

> ID：11836334
> 
> 赞同：1
> 
> 时间：2012-08-06T21:37:13.123
> 
> 标签：ruby

我正在尝试获取我的子类的父模块的名称：

```
module Special
  class BaseController
    def self.action
      puts Module.nesting.inspect # i want this to be relative to self
    end
  end
end

module Foobar
  class Controller < Special::BaseController
    action do
      # should print Foobar::Controller
    end
  end
end 
```

如何获取子类的父模块而不是基类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:42:59.553

这最终比我想象的要容易。来电`self.to_s`会给你全名（包括模块）。所以你可以抓住倒数第二个：

```
class_name = self.to_s.split('::')[-2] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:10:17.107

我认为问题在于 Ruby 还没有在你想知道的时候完成对模块和类的定义。关闭定义后，您可以创建它的一个实例并找出：

```
irb(main):017:0> Foobar::Controller.new.class
Foobar::Controller < Special::BaseController 
```

然后是进行字符串拆分的情况：

```
irb(main):033:0> Foobar::Controller.new.class.to_s.split('::')
[
    [0] "Foobar",
    [1] "Controller"
] 
```

# c# - 什么是在运行时创建类似 XML 的文件的好库或编码方法

> ID：11836336
> 
> 赞同：0
> 
> 时间：2012-08-06T21:37:21.420
> 
> 标签：c#

我想编写某种 API，这样我就可以调用它并说嘿添加这个东西作为那个东西的子类和它为我生成的输出文件我可以看到这样的东西：

![在此处输入图像描述](../Images/0bb8451cebad3860f8c0a90cb1fc5959.png)

或者告诉它把这些东西声明为一个类，输出看起来像这样：

![在此处输入图像描述](../Images/941d4db723790589ffce65ac9e95fa51.png)

在这里，只有那些 Person 和 Student 是我将传递给 API 的参数。其余的就像关键字一样，总是一样的。

基本上是这样的：[http ://www.w3.org/TR/owl-ref/#subClassOf-def](http://www.w3.org/TR/owl-ref/#subClassOf-def)

所以我很想知道你对什么是好的方法或库等的建议......这有助于我进行这种文件操作？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:15:48.140

您可以使用 c# 并使用`XmlDocument`该类

基本上，您可以使用它的方法指定要添加到 XML 文档中的节点，然后您可以获取 XML 输出并将其流式传输到文件等

[http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)

你有什么编程经验？

这里的用法示例：

[http://msdn.microsoft.com/en-us/library/fw1ys7w6.aspx](http://msdn.microsoft.com/en-us/library/fw1ys7w6.aspx)

我想这取决于你需要什么样的控制 - 这可能是你想要的过度

# python - 我可以在 Python Bottle 中使用 PUT http 方法吗？

> ID：11836342
> 
> 赞同：3
> 
> 时间：2012-08-06T21:38:05.390
> 
> 标签：python, rest, bottle

我正在尝试这样做：

```
@get("/admin/questions/:question_id")
def question (question_id):
    pass
    #Some code for returning the question

@put("/admin/questions/:question_id")
    pass
    #I intend to write some code to update the question here. 
```

这可能吗？GET 和 POST 确实有效，但 PUT 显然不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T11:48:48.900

是的，你可以这样做。请参阅文档：

*   [http://bottlepy.org/docs/dev/tutorial.html#http-request-methods](http://bottlepy.org/docs/dev/tutorial.html#http-request-methods)
*   [http://bottlepy.org/docs/dev/api.html#bottle.put](http://bottlepy.org/docs/dev/api.html#bottle.put)

例子：

```
from bottle import put, run

@put("/foo")
def foo():
    return "Foo"

run() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T11:44:16.963

我发现了这个：[https](https://myadventuresincoding.wordpress.com/2011/01/02/creating-a-rest-api-in-python-using-bottle-and-mongodb/) ://myadventuresincoding.wordpress.com/2011/01/02/creating-a-rest-api-in-python-using-bottle-and-mongodb/ 。它可能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T19:37:24.373

我也有同样的问题。上面的链接很有帮助。我还发现这些网页很有用：

[http://gotofritz.net/blog/weekly-challenge/restful-python-api-bottle/](http://gotofritz.net/blog/weekly-challenge/restful-python-api-bottle/)（周末代码战士在一页中创建宁静的界面 - 这对我来说很清楚）

[http://www.marginhound.com/bottle-py-resources/](http://www.marginhound.com/bottle-py-resources/) [http://isbullsh.it/2011/11/Python-micro-frameworks/](http://isbullsh.it/2011/11/Python-micro-frameworks/) [http://publish.luisrei.com/articles/flaskrest.html](http://publish.luisrei.com/articles/flaskrest.html)

一旦我花时间浏览了这些页面，它就非常容易实现。

# eclipse - ClassNotFoundException：org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider

> ID：11836343
> 
> 赞同：3
> 
> 时间：2012-08-06T21:38:07.007
> 
> 标签：eclipse, google-app-engine, google-cloud-datastore

我尝试在我的 Eclipse 中启动一个 Google appengine 应用程序。

我有 Google 插件，并为我的应用程序设置了 sdk。

但是，当我启动这个时，我收到以下错误：

```
java.lang.ClassNotFoundException: org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider 
```

但是，这个类存在于我的类路径中的 sdk 中。

为什么 Appengine 找不到这个类？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T03:34:55.300

[https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2)

请尝试按照步骤在应用的 war/WEB-INF/lib/ 目录中添加 JPA 和数据存储 JAR。

appengine-java-sdk/lib/opt/user/datanucleus/v2/ 目录下的所有 jars。

我遇到了同样的问题并按照该网页上的步骤进行操作。现在我的代码运行良好。

我相信问题的发生是因为我们现在使用的是 JPA 2.0 而不是 JPA 1.0。

另外，请确保您使用 org.datanucleus.api.jpa.PersistenceProviderImpl 作为提供程序，而不是 org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider。至少我使用了新的提供程序，因为我正在使用最新的 GAE 插件开发 GAE 项目

祝你好运。

# javascript - jQuery - 光标后的文本

> ID：11836344
> 
> 赞同：0
> 
> 时间：2012-08-06T21:38:07.007
> 
> 标签：javascript, jquery, cursor

我知道：几乎没有 javascript Basic HTML 和 CSS

所以 - 我的目标：当且仅当光标位于 div 或图像上时，光标后面会有一小行文本。当光标不在 div 或图像上时，我不希望在任何地方看到文本。

我在 jsFiddle 页面上发现了类似的东西，并从中制作了以下 .html 和 .css 文件：

.html 文件：

```
<!DOCTYPE html>
<html>
<head>

<link href="css/lern.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
$(function(){
    $(index.html).bind('mousemove', function(e){
        $('#tail').css({
           left:  e.pageX + 5,
           top:   e.pageY - 20
        });
    });​
});
</script>

</head>

<body>

<div id="tail">
    <p>Farewell</p>
    <p>N.C. Hunter Hayden</p>
</div>​

</body>
</html> 
```

.css 文件：

```
@charset "UTF-8";
/* CSS Document */

#tail
{
position: absolute;
} 
```

这是输出：

â€‹ 告别

NC猎人海登

如果有人愿意花时间耐心地向我这样的绿人解释，将不胜感激。如果你有更好的事情要做，我完全理解。一天要做这么多事情，你懂我的意思吗？

我想我已经提供了我所拥有的所有信息，但如果您需要更多信息，请询问。

无论如何，无论如何，谢谢你至少愿意读到这里。你真棒。保持！

祝你有美好的一天。明天也有一个很好的，以防我没有另一个改变告诉你。

-Oijl

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:41:48.490

只需更改`index.html`为`document`.

您不想通过文件名来选择文档，而是通过其实际选择器来选择。

[这](http://jsfiddle.net/purmou/rbdFF/)是在行动。

# c# - 在实体框架中使用带有输入参数的 ObjectResult 到 StoredProcedure 的正确方法是什么？（输出映射到复杂类型属性）

> ID：11836345
> 
> 赞同：0
> 
> 时间：2012-08-06T21:38:15.507
> 
> 标签：c#, wpf, stored-procedures, entity-framework-4.1, complextype

我有几个具有 SelectedItem 属性的列表框，我打算将其用作输入参数以在 Entity Framework 中执行我的存储过程。

我现在意识到，作为存储过程的结果，我唯一希望轻松返回实体对象是将存储过程（或函数导入）映射到与输出匹配的复杂类型。[（在这里](http://thedatafarm.com/blog/data-access/a-big-step-for-stored-procedures-in-ef4/)使用 Julie Lerman 的帖子来做出这个决定。）

但是，我需要帮助使用 ObjectResult 和 EntityFramework 来捕获我的列表框 SelectedItem 属性并将它们提供给存储过程（从而输出我的复杂类型实体）。有人熟悉这个过程吗？

任何帮助将不胜感激（包括猜测）。如果我能更清楚，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:52:24.707

您可以将其作为函数调用访问，参数的顺序由 EF 确定：

```
using (var db = new YourEntityContext())
{
    var result = db.YourFunctionImportName(
        Convert.ToInt32(ddlWhatever1.SelectedValue),
        Convert.ToInt32(ddlWhatever2.SelectedValue));

    //Int32 used as an example, use whatever type your function import is expecting.
    //Do whatever with result.
} 
```

# java - Java ScheduledThreadPoolExecutor 运行延迟 15 毫秒/时间不一致？

> ID：11836351
> 
> 赞同：4
> 
> 时间：2012-08-06T21:38:43.870
> 
> 标签：java, multithreading, time, threadpool

我也是这个网站的新手，如果我在错误的地方或其他地方发布了这个问题，请原谅我:)

我一直在研究和创建测试程序，试图找出我创建的 ScheduledThreadPoolExecutor 可能出了什么问题。

**问题：**

在运行以下测试应用程序时，计划以 3 毫秒的固定速率运行的 ScheduledThreadPoolExecutor 会以大于 15 毫秒的频繁峰值运行混乱。它应该以每 3 毫秒的速率执行。

**有趣的细节：**

该问题**仅**发生在 IDE 之外，ScheduledThreadPoolExecutor 在诸如 Netbeans 或 IntelliJ 之类的 IDE 中按预期运行。

**问题：**

为什么使用 Timer 和 ScheduledThreadPoolExecutor 类的时间**非常不一致？**执行之间的时间范围从每次执行的预期 3 毫秒到执行之间的 15 毫秒的频繁峰值。

**配置：**

Java 7 Update 5、IntelliJ IDE、Windows 7、从命令提示符运行。

**测试应用程序演示问题，确保在 IDE 之外使用以查看问题。该程序将输出大于执行之间预期时间的时间。应该在 15 毫秒左右，而不是预期的 3 毫秒。**

谢谢大家的帮助！:)

```
package testtime;

import javax.swing.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.concurrent.ScheduledThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

public class TestTime extends JFrame {

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestTime().setVisible(true);
            }
        });
    }

    JTextArea area = new JTextArea();
    JScrollPane pane = new JScrollPane(area);

    ScheduledThreadPoolExecutor executor;

    public TestTime() {
        setSize(300, 300);
        setAlwaysOnTop(true);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

        area.addMouseListener(new MouseAdapter() {
            @Override
            public void mousePressed(MouseEvent e) {
                area.setText("--Press anywhere to start--\n\n" +
                        "If time exceeds 3 milliseconds it will be printed here...\n\n" +
                        "------------------------------------\n\n");
                executor = new ScheduledThreadPoolExecutor(1);
                executor.scheduleAtFixedRate(new Loop(), 0L, 3L, TimeUnit.MILLISECONDS);
            }

            @Override
            public void mouseReleased(MouseEvent e) {
                executor.shutdownNow();
            }
        });

        area.setLineWrap(true);
        area.setWrapStyleWord(true);
        area.setText("--Press anywhere to start--");
        add(pane);
    }

    class Loop extends Thread {
        long time = 0L;

        @Override
        public void run() {
            long timeTaken = System.nanoTime() - time;
            time = System.nanoTime();

            if(timeTaken > 3500000L) {
                area.append(timeTaken+"(nanoseconds)  -- "+(timeTaken/1000000L)+"(milliseconds)\n");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T09:27:41.797

我认为您的问题来自垃圾收集器，它会定期冻结进程以从内存中删除未使用的对象。

JVM 支持几种不同的[GC 算法](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html#1.1.%20Types%20of%20Collectors%7Coutline)。延迟和吞吐量之间存在权衡。

IntelliJ 可能使用低暂停 GC 来支持 UI 快速响应，而 JVM 在 IDE 之外默认使用高吞吐量。

您可以尝试在`-Xincgc`您的项目中添加选项（选择 Concurrent Mark&Sweep）吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T09:40:19.893

我认为 Windows 计时器根本没有这么好的分辨率。如果您 Google [http://www.google.de/search?q=windows+timer+resolution ，您会发现更多关于该主题的信息](http://www.google.de/search?q=windows+timer+resolution)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:45:09.793

从技术上讲，Timer 和 ScheduledExecutor 接口指定的合约不保证任务将在指定的时间间隔内准确执行。他们只是承诺不会在间隔时间之前运行它们。

# php - $class->method() 或 $class::method()

> ID：11836352
> 
> 赞同：3
> 
> 时间：2012-08-06T21:38:49.063
> 
> 标签：php, class

> **可能重复：**
> [我们在 php 中使用对象运算符“->”](https://stackoverflow.com/questions/3037526/where-we-use-object-operator-in-php)

`$class::method()`在 PHP 5 中，打字而不是的优点是`$class->method()`什么？

与任何性能或功能差异一样。或者这只是因为完全重写而强制代码非 PHP4 友好的一种方式？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-06T21:43:42.217

在 PHP5 中，两者不可互换。

静态方法调用将比非静态调用执行得更快（经过多次迭代），但随后该方法在静态上下文中被调用，并且被调用方法没有可用的对象。

PHP 允许您使用静态表示法调用非静态方法的唯一原因是为了在 PHP 4 中向后兼容（*因为 PHP 4 没有用于函数的 static 修饰符，或 public/protected/private*）。如果您确实静态调用非静态方法，则会收到有关“严格标准”输出的警告，最终这可能会因致命错误而失败。

所以答案实际上是以它应该被调用的方式调用该方法。如果是 PHP 5 中的静态方法，则静态调用`Class::method()`，如果是公共方法，则使用对象调用`$class->method()`。

考虑这段代码（在 PHP 5 中运行）：

```
class Foo {
    protected $bar = 'bar';

    function f() {
        echo $this->bar;
    }
}

echo Foo::f(); // Fatal error: Using $this when not in object context 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:44:12.697

`$class::method()`调用类的静态方法，而`$class->method()`调用类的公共标准方法。

# c# - 如何以编程方式检索 Excel 工作表中的页数？

> ID：11836354
> 
> 赞同：2
> 
> 时间：2012-08-06T21:39:03.087
> 
> 标签：c#, .net, excel, excel-interop, worksheet

我不是在寻找工作表的数量。我正在寻找每个工作表中的总页数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:43:19.640

这就是你如何得到它

```
ActiveSheet.PageSetup.Pages.Count 
```

# java - 如何序列化一个arraylist

> ID：11836357
> 
> 赞同：2
> 
> 时间：2012-08-06T21:39:08.530
> 
> 标签：java, serialization, arraylist

我正在尝试序列化这个数组列表：

```
static ArrayList<Product> Chart=new ArrayList<Product>(); 
```

使用这些对象：

```
double Total;
String name;
double quantity;
String unit;
double ProductPrice 
```

这是到目前为止的课程：

```
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;

public class Product implements Serializable{
double Total;
String name;
double quantity;
String unit;
double ProductPrice;

public Product(String n)
{
    name=n;
}
private void writeObject(ObjectOutputStream s) throws IOException
{
    s.defaultWriteObject();
    Product pt=new Product(name);
    ObjectOutputStream oos=new ObjectOutputStream(s);
    oos.writeObject(pt);
}
private void readObject(ObjectInputStream s) throws IOException, ClassNotFoundException
{
    s.defaultReadObject();
    Product pt;
    ObjectInputStream ios =new ObjectInputStream(s);
    ObjectInputStream ois = null;
    pt=(Product)ois.readObject();
}

} 
```

我正在尝试序列化和反序列化 arraylist（在另一个类中声明），以便在运行时之间保存 arraylist 中的对象。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:43:29.753

为什么要`Product`在这些方法中创建新对象？它们不是静态的，所以我认为它们应该在`this`? 您还试图调用`readObject()`刚刚设置为的对象`null`。

如果您可以提供有关您所看到的错误以及您如何使用它的更多详细信息，我们可能会提供更多帮助。

编辑：添加了一些示例代码

把它写出来：

```
 Product p = new Product("My Product");
    try
    {
       FileOutputStream fileOut =
       new FileOutputStream("product.ser");
       ObjectOutputStream out = new ObjectOutputStream(fileOut);
       out.writeObject(p);
       out.close();
       fileOut.close();
    } catch(IOException ioe)
    {
        ioe.printStackTrace();
    } 
```

阅读它：

```
 Product p = null;
    try
    {
        FileInputStream fileIn = new FileInputStream("product.ser");
        ObjectInputStream in = new ObjectInputStream(fileIn);
        p = (Product) in.readObject();
        in.close();
        fileIn.close();
    } catch(IOException ioe)
    {
        ioe.printStackTrace();
        return;
    } catch(ClassNotFoundException c)
    {
        System.out.println(.Product class not found.);
        c.printStackTrace();
        return;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:05:06.620

看起来不需要`Product`提供`readObject`和`writeObject`方法。您应该能够按原样序列化和反序列化`List`。

我建议将列表包装在一个在上下文中有意义的类中。（我不知道上下文是什么，或者顺序是什么（会`Set`更好）。）可变静态通常是一个坏主意，特别是如果您要尝试序列化和反序列化引用的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:43:50.623

ArrayList 类已经实现了 Serializable，并且您使您的类 (Product) 可序列化；一切似乎都写信给我。“这样数组列表中的对象将在运行时之间保存。” 你让它听起来像是你认为它应该在每次运行它之间自动保存它们；这可能是你的错误。您必须将其写入文件，并在下一次执行时读取它（使用 ObjectOutput(/Input)Streams）

# jquery - 结合 Masonry 和 Waitforimages，图像加载

> ID：11836361
> 
> 赞同：1
> 
> 时间：2012-08-06T21:39:33.717
> 
> 标签：jquery, jquery-plugins, waitforimages

我在测试 Masonry 时注意到，如果我在 Firefox 中移位重新加载（硬重新加载），那么布局将偏离页面中任何图像的高度。我认为 div 高度必须取决于知道图像高度，这是有道理的。

因为我已经在使用 jquery.waitforimages.js，所以我在页面和脚本的末尾添加了这个：

```
$wall.waitForImages(function() {

    $wall.masonry( 'reload' );

}); 
```

尽管一切正常，但现在我在 Firebug 中看到了一个错误，该错误仅在我**不**重新加载时才会发生。所以我假设这个错误发生在图像已经被缓存时：“在初始化之前不能调用砌体上的方法；试图调用方法'reload'”。

有没有办法解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T10:10:28.937

答案：使用名为 imagesLoaded with Masonry 的脚本，因为同一作者编写了这两者并且它们一起工作。
脚本：[https ://github.com/desandro/imagesloaded/](https://github.com/desandro/imagesloaded/)

在您的 jQuery 中，类似：

```
 $wall = $('#mydiv');
    $wall.imagesLoaded(function(){
            // call your layout function, something like:
            // layoutBricks();
    }); 
```

这应该有助于避免 Heisenbug。我还没有在我的其他小工具上测试过这个新的图像加载脚本，所以我还不知道。

# c# - 匹配日期后跟字符串的模式

> ID：11836367
> 
> 赞同：0
> 
> 时间：2012-08-06T21:39:58.770
> 
> 标签：c#, regex

我有一个带有重复模式的字符串

`MM/DD/YYYY (FirstName LastName) Status Update: blah blah blah blah`

例如

```
string test = "11/01/2011 (Joe Bob) Status Update: Joe is the collest guy on earfth 08/07/2010 (Rach Mcadam) Status Update: whatever I dont care 06/28/2009 (Some Guy) Status Update: More junk and note how I end there's not gonna be another date after me" 
```

如何分组匹配，以便为每场匹配更新日期、名称和状态？

我试过了

```
 string datePattern = "\\d{1,2}/\\d{1,2}/\\d{0,4}";
        string personPattern = "\\(\\w*\\)";
        Regex regex = new Regex("(" + datePattern + ") (" + personPattern + ") (.*)");
        MatchCollection matches = regex.Matches(test);
        foreach (Match match in matches)
        {
            Console.WriteLine("##Match Found##");
            Console.WriteLine("");
            Console.WriteLine("");
            Console.WriteLine(match.Groups[0]);//full text
            Console.WriteLine("");
            Console.WriteLine(match.Groups[1]);//date only
            Console.WriteLine("");
            Console.WriteLine(match.Groups[2]);//person
            Console.WriteLine("");
            Console.WriteLine(match.Groups[3]);//note
        } 
```

在这一点上它什么也没有拉回来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:42:13.960

空格不包含在 中`\w`，因此`\w*`不会匹配`Joe Bob`。尝试更改`personPattern`为`"\\([ \\w]*\\)"`.

看起来您的正则表达式也太贪心了，因为`.*`末尾的 将匹配字符串的其余部分，而不是在下一个日期停止。尝试将您的正则表达式更改为以下内容：

```
Regex regex = new Regex("(" + datePattern + ") (" + personPattern + ") (.*?(?=$|" + datePattern + "))"); 
```

# android - 配置更改时正确处理 AlertDialog

> ID：11836369
> 
> 赞同：0
> 
> 时间：2012-08-06T21:40:16.443
> 
> 标签：android

我看到了许多需要维护的解决方案，`AlertDialog`其中大多数可能在屏幕变暗时不起作用。但是我做的这个很好用，还有其他轻量级的方法可以做到这一点，我想在里面使用`Fragment`它`ACL`。

```
 public class Test extends Activity {

    AlertDialog dialog;
    boolean dialog_should_be_shown = false;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Button btn = new Button(this);
        btn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                createDialog();
            }
        });
        setContentView(btn);
        if (savedInstanceState != null) {
            dialog_should_be_shown = savedInstanceState.getBoolean("flag",
                    false);
        }
    }

    private void createDialog() {
        dialog = new AlertDialog.Builder(Test.this).setMessage("HEllo")
                .setCancelable(true).create();
        dialog.show();
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {

        super.onSaveInstanceState(outState);
        outState.putBoolean("flag", dialog_should_be_shown);
    }

    @Override
    protected void onResume() {
        super.onResume();
        if (dialog_should_be_shown) {
            createDialog();
        }
    }

    @Override
    protected void onPause() {
        super.onPause();
        if (dialog != null && dialog.isShowing()) {
            dialog_should_be_shown = true;
            dialog.dismiss();
        } else {
            dialog_should_be_shown = false;
        }
    }

    @Override
    protected void onStop() {
        super.onStop();

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_test, menu);
        return true;
    }
} 
```

更新：我不想保留`Framgnet`在内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:43:38.130

改为使用 DialogFragment，它包含在支持库中，您可以使用 setRetainInstance(true) 保留它，

[http://developer.android.com/reference/android/app/DialogFragment.html](http://developer.android.com/reference/android/app/DialogFragment.html)

# java - Java TreeMap firstEntry() 方法的 Big O 中的运行时复杂度是多少？

> ID：11836373
> 
> 赞同：3
> 
> 时间：2012-08-06T21:40:27.027
> 
> 标签：java, big-o, red-black-tree

我知道这个类使用红黑树，但这是否意味着获得最少元素是 O(log(n)) 还是 O(1) 或其他什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:42:20.377

鉴于它是*二叉搜索树*，它必须遍历树的高度（即 O(log n)）才能到达第一个（即最少的）条目，因此该方法确实是 O(log n)。

[您可以在此处](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/TreeMap.java#TreeMap.getFirstEntry%28%29)查看它是如何在 OpenJDK 中实现的。

```
/**
 * Returns the first Entry in the TreeMap (according to the TreeMap's
 * key-sort function).  Returns null if the TreeMap is empty.
 */
final Entry<K,V> getFirstEntry() {
    Entry<K,V> p = root;
    if (p != null)
        while (p.left != null)
            p = p.left;
    return p;
} 
```

* * *

如果您正在寻找支持恒定时间查找最小值的结构，可以考虑使用[二进制最小堆](http://en.wikipedia.org/wiki/Binary_heap)，其中根节点对应于最小值。请注意，这是具有不同语义的完全不同的数据结构。

# c# - 如何制作具有不同签名的多态方法

> ID：11836374
> 
> 赞同：9
> 
> 时间：2012-08-06T21:40:31.867
> 
> 标签：c#, oop, inheritance, polymorphism

考虑我有一些**抽象** `Vehicle`类和汽车、卡车、摩托车抽象类，它们派生自`Vehicle`. 还想象一下，我必须能够为卡车和摩托车创造一辆基于燃料的汽车或电动汽车等等。（具体类）

两个问题：

1.考虑我想在不知道它是什么的情况下以多态方式在车辆中填充能量。例如，如果车辆是基于燃料的，我想用燃料填充它，该方法应该使用 3 个参数：
`void FillUpEnergy(EfuelType i_fuelType,int amounOfEnergy, int maxAmountOfEnergy)`

但是对于基于电动的车辆，我需要几乎相同的功能签名，但这次当然没有燃料类型，例如（2个参数）：

```
void FillUpEnergy(int amounOfEnergy, int maxAmountOfEnergy) 
```

我可以`FillUpEnergy`用上述约束做一个多态方法吗？（不同方法的签名）

2.在我的实现中，所有具体类都为`Engine`（另一个抽象类）提供一个引用，它代表一个`FuelEngine`或`ElectricEngine`（我拥有的其他从引擎派生的具体类）。例如，我有一个名为的具体类`ElectricCar`，其中包含`ElectricEngine`.
这种架构足够好还是有更好的方法来实现车库系统？（在面向对象设计等方面。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T21:52:59.263

您不能使用不同的签名创建多态“推式”方法，但可以使用广为人知的[*访问者模式*](http://en.wikipedia.org/wiki/Visitor_pattern)创建多态“拉式”方法。

这个想法是颠倒交互的顺序，让汽车对象决定做什么：与其调用`FillUpEnergy`并*给*汽车你认为它需要的东西，不如调用`FillUpEnergy`并让汽车*接受*它知道它需要的东西，如下所示：

```
interface IEnergyProvider {
    void TakeFuel(EfuelType i_fuelType, int amounOfEnergy);
    void TakeElectricity(int amounOfEnergy);
}
interface ICar {
    void FillUpEnergy(IEnergyProvider provider);
} 
```

现在你的多态方法的签名是固定的，但是方法的调度需要两条腿而不是一条腿：

*   你打电话`myCar.FillUpEnergy(myProvider)`
*   汽车呼叫`myProvider.TakeFuel`或`myProvider.TakeElectricity`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T21:44:32.883

关于问题1）

您可以将电动/汽油作为燃料类型的一部分，并在您的域逻辑中处理它。

C# 不提供具有不同签名的多态性。

2) 称为组合

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T21:52:10.853

`ElectricCar`与有什么区别`FueledCar`？只有引擎（概念上）：

```
interface IEngine
{
    void FillUpFuel(int amountOfFuel, int maxAmountOfFuel);
}

class ElectricEngine : IEngine
{
    public void FillUpFuel(int amountOfFuel, int maxAmountOfFuel) { ... }
}

abstract class Vehicle
{
    public abstract IEngine Engine { get; }
}

class Car : Vehicle
{
    public IEngine _engine;
    public override IEngine Engine { get { return _engine; } }

    public Car(IEngine engine)
    {
        _engine = engine;
    }
}
...
var electricCar = new Car(new ElectricEngine());
electricCar.Engine.FillUpFuel(40, 70); 
```

典型的组合与继承示例。命名与 ElectricEngine 填充燃料有点奇怪……但这不是重点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:52:41.427

关于 1)
具有`FillUpEnergy`多态性（[子类型多态性](http://en.wikipedia.org/wiki/Subtype_polymorphism)）的要点是能够在您唯一知道的是对象是 a 时调用此方法`Vehicle`。

如果您需要知道确切的类型以选择正确的参数集，那么他们不需要这个函数是多态的。

关于 2)
没有什么令人震惊的

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-06T21:47:23.980

1.  你不能这样做，因为这完全违反了封装。
2.  我不明白你关于引擎的问题，但我可以肯定地说，可能有很多更好的方法来实现“车库系统”，因为有这么多不同的“车库系统”。这实际上意味着您不应该尝试对系统建模（根据 OOP 或任何其他术语），直到您很好地掌握了您的需求。

# css - 样式表中 background-image 属性的最有效位置

> ID：11836377
> 
> 赞同：7
> 
> 时间：2012-08-06T21:40:37.753
> 
> 标签：css, optimization, background-image

`background`我正在使用 CSS属性在我的网站上放置一个大的、非重复的背景图像。由于图像太大，一些连接渲染图像需要很长时间。

这是我的CSS：

```
#wrapper {
    background: url('large-image.jpg) no-repeat center center;
} 
```

我已经完成了以下操作来优化网络图像：

*   将其降低到不影响质量的最低分辨率
*   将图像类型从 PNG 更改为 JPEG
*   对页面进行样式设置，即使没有背景图像也可以阅读内容

我的问题：为了进一步优化图像加载时间，如果我将`background`标签放在样式表的底部会有所不同吗？或者这种影响可以忽略不计？

我倾向于按照我的 HTML 的层次结构来排序我的 CSS，所以`#wrapper`样式位于我的样式表的顶部。当用户的连接速度较慢时，样式表中的属性顺序是否会对加载时间产生显着影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:50:49.507

样式表中的位置不会影响加载时间。

不过，您可以做的是防止它在某些情况下加载，例如在手机上。

供参考： [http ://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

这些媒体查询不是防故障的，但它们会捕获很多速度较慢的情况，通常是移动设备。另一方面，如果有人使用 56k 调制解调器和桌面，我只是不知道该怎么办（也许他们已经习惯了）。

如果您愿意，您可以使用 Jquery 和[waitforimages](https://github.com/alexanderdickson/waitForImages)来确保它在所有其他图像之后加载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:39:02.157

可能会影响*感知*加载时间的是初始`#wrapper`可用性 - 即，如果在初始加载时它不是页面的一部分并且添加了 JS，则背景图像将不会开始加载 - 但我怀疑这将是一个常见的场景。

背景图像加载不会影响 domready 处理程序，但是如果您想加快后台可用性，您可以尝试以下操作：

```
#wrapper {
    background: url(large-image.png) no-repeat center center,
                url(small-image.png) no-repeat center center;
} 
```

来自[mdn](https://developer.mozilla.org/en-US/docs/CSS/Multiple_backgrounds)：

> 使用 CSS3，您可以将多个背景应用于元素。它们相互叠加，您提供的第一个背景在顶部，最后一个背景在后面列出。只有最后一个背景可以包含背景颜色。

这样做有效地允许您加载较低分辨率的图像作为背景的底层，而昂贵的高分辨率图像仍在加载。还记得过去的美好时光`lowsrc`吗？这就是我们正在模拟的行为。请注意，低分辨率和高分辨率图像下载同时开始，因此只有在大图像确实大到无法忍受时才使用它。

另外：您是说您已经优化了图像；我仍然建议您尝试[Yahoo SmushIt](http://www.smushit.com/ysmush.it/)，您会惊讶于如何从 PNG 中删除大量冗余数据而不会降低质量（我目前在使用他们的服务时遇到间歇性问题，但经过几次尝试后它可以工作，或者您可以使用[OptiPNG](http://optipng.sourceforge.net/)但是 imo 为单个图像设置和配置它会花费太多精力）

## 更新：

建议您等待 domready 触发并使用`$("#wrapper").css(...);`. 这样做是为元素添加内联样式，这将 1) 干扰选择器的特异性 2) 仅适用于这个特定的实例`#wrapper`（如果它是来自服务器的 ajax 内容的一部分，则不好）。

您也可以在运行时添加新的 CSS 规则：

```
$('head').append('<style type="text/css">#wrapper {background: url(large-image.jpg) no-repeat center center;}</style>'); 
```

这将被有机地添加到文档样式表中并应用于所有未来的实例`#wrapper`，并且不会干扰选择器的特异性。您仍然会得到一个短暂的无样式内容（在触发处理程序并应用样式之前），所以我不提倡这种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:46:45.690

请参阅[上一个问题](https://stackoverflow.com/questions/6500141/do-external-stylesheets-get-loaded-before-the-html)。CSS 样式表将在页面显示之前完全加载和评估，因此背景图像 CSS 的位置在样式表中无关紧要。

如果您希望仅在显示其余内容后才加载图像，您可以使用 jQuery：

```
$(window).load(function(){
    $("#wrapper").css({'background-image':'url("large-image.jpg")', 'background-repeat':'no-repeat', 'background-position':'center center'});
}); 
```

# php - Rails/PHP 共存

> ID：11836379
> 
> 赞同：3
> 
> 时间：2012-08-06T21:40:48.817
> 
> 标签：php, ruby-on-rails, migration

[我目前有一个使用Laravel 框架](http://laravel.com)使用 PHP/MySQL 构建的应用程序。我想将此应用程序迁移到[Ruby on Rails](http://rubyonrails.org)，但我完全拆卸/重建是不可行的。我想知道让 PHP 应用程序和 Rails 应用程序共存并慢慢迁移代码是多么容易。

有没有人尝试过这个？如果是这样，有哪些值得注意的事情可能对我有用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:59:56.687

在我的脑海中没有什么可以阻止你这样做。只要您始终确保数据库的一致性，这应该不是问题。

根据我的经验，最具挑战性的任务是解决 Rails 中的约定，例如表和列的命名。如果您想保留数据库模式并且它不适合意外，则需要这样做。

# php - 当站点负载平衡时，php5.2 APC_UPLOAD_PROGRESS 是否工作？

> ID：11836381
> 
> 赞同：0
> 
> 时间：2012-08-06T21:40:59.613
> 
> 标签：php, file-upload, load-balancing, apc

我想`APC_UPLOAD_PROGRESS`用于在 PHP > 5.2 中显示文件上传的进度。

我想知道我是否会遇到与 SESSION 处理相同的场景，`APC_UPLOAD_PROGRESS`如果请求发送到我正在接受请求的任何一个盒子，引用可能会变得很奇怪。

它的局限性是什么？我应该使用它吗？它会在我的场景中工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:40:31.750

是的，您会遇到同样的问题——PHP 上传进度在服务器之间不可见，因此如果用户最终将请求拆分到服务器上，您将得到不一致的结果。

您最好的选择是使用某种一致的散列（基于会话或远程 IP），以保证来自用户的所有请求始终路由到同一服务器，或者将所有上传路由到单个服务器。或者，您可能想研究 HTML5 分块上传，这将允许您在客户端显示上传进度，并支持更大的上传。

# windows - 跨活动目录域使用 User.IsInRole() 检查组成员身份

> ID：11836390
> 
> 赞同：0
> 
> 时间：2012-08-06T21:41:35.417
> 
> 标签：windows, active-directory, windows-server-2008, trust

我有两个域设置了双向信任。

域 A 有一个组（组 A）和一个成员（用户 A）。

域 B 有一个组（组 B），组 A（来自另一个域）作为成员。

我正在检查：

```
if(User.IsInRole(group B))
{
  // logging in as User A should provide access because this use is part of Group A which is part of Group B
} 
```

但这不起作用。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-07T15:25:11.137

在以用户身份登录并加入该域的计算机上运行时，这对我来说失败了。

```
 private static SecurityIdentifier GetGroupSid(string domainName, string groupName)
    {
        using (var d = Domain.GetDomain(new DirectoryContext(DirectoryContextType.Domain, domainName)))
        {
            using (var context = new PrincipalContext(ContextType.Domain, d.Name))
            {
                using (var group = GroupPrincipal.FindByIdentity(context, groupName))
                {
                    return group.Sid;
                }
            }
        }
    }
    [Test]
    public void should_check_role_with_sid()
    {

        var barDomain = "bar.example.com";
        var groupinBar = GetGroupSid(barDomain, "group_in_bar");
        var identity = WindowsIdentity.GetCurrent();
        var windowsPrincipal = new WindowsPrincipal(identity);
        Assert.That(windowsPrincipal.IsInRole(groupinBar), Is.True, "Checking role " + groupinBar);
    } 
```

# php - mod_rewrite 将 site.com/something 指向 index.php?values=something

> ID：11836403
> 
> 赞同：0
> 
> 时间：2012-08-06T21:42:34.527
> 
> 标签：php, mod-rewrite

（我可能是个白痴，似乎 .htaccess 在 OSX 上的 Apache 中默认未启用。）

我知道那里有很多 mod_rewrite 问题，但我就是无法正确解决我的问题，而且似乎没有其他东西能完全涵盖它。

我想做的就是重定向

```
www.url.com/something 
```

或者

```
www.url.com/something/anything/more 
```

到

```
www.url.com/index.php?values=something 
```

或者

```
www.url.com/index.php?values=something/anything/more 
```

没有什么比这更有趣的了（我会添加一些关于忽略 gif/jpg/png 的内容，稍后添加 www. 等）——所有东西/任何东西/更多的处理都将在 PHP 中完成。

我只是无法做到这一点。任何提示/资源或刚刚设法做到这一点的任何人？知道我曾经完全完美但多年前丢失了该代码，这更令人沮丧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:47:20.223

```
RewriteEngineOn
RewriteCond %{REQUEST_URI} !-f
RewriteCond %{REQUEST_URI} !-d    
RewriteRule ^(.*)$ /index.php?values=$1 [L] 
```

请注意，如果您尝试在 .htaccess 文件中执行此操作，并且当然需要启用 mod_rewrite 模块，则需要在相关目录的 Apache 主机配置文件中设置 AllowOverride On。

此规则将忽略任何实际存在的文件或目录（即图像）的重定向（包括 index.php）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:48:29.603

这很简单，至少在你所问的方面但基本上你需要让 index.php 直通（所以你不会将 index.php 重写*为*index.php），然后是主要的重写。

```
RewriteEngine On
RewriteRule index.php - [L]

# your conditions here
RewriteRule ^/?(.*)$ /index.php?values=$1 [L] 
```

`# your conditions here`在现场添加您想要排除重写的任何条件

# android - 即使调用了宽度 fill_parent，LinearLayout 也不会填充 tablerow

> ID：11836409
> 
> 赞同：4
> 
> 时间：2012-08-06T21:43:06.380
> 
> 标签：android, android-layout

我在 tableRow 中有一个 linearLayout，这个 linearLayout 包含一个我想为我的应用程序显示的图表。我读了一些线程说 tableRow 的孩子不需要指定它的宽度和高度，所以我做到了，但图表没有显示。如果我将linearLayout指定为width=fill_parent和height=200dp，那么linearlyLayout只填充了tableRow的1/3。

```
<?xml version="1.0" encoding="UTF-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TableLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center_horizontal" >

            <TextView
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:text="Record"
                android:textSize="18dp"
                android:textStyle="bold"
                android:typeface="serif" >
            </TextView>
        </TableRow>

        <TableRow
            android:id="@+id/tableRow2"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center_horizontal" >

            <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="0.3"
                android:text="Name:"
                android:textStyle="bold"
                android:typeface="serif" >
            </TextView>

            <EditText
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="0.7"
                android:ems="10"
                android:singleLine="true" />
        </TableRow>

        <TableRow
            android:id="@+id/tableRow3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center_horizontal" >

            <TextView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="0.3"
                android:text="Date:"
                android:textStyle="bold"
                android:typeface="serif" >
            </TextView>

            <TextView
                android:id="@+id/editRecordDate"
                android:layout_width="0dp"
                android:layout_weight="0.7"       
                android:layout_height="wrap_content" />
        </TableRow>

        <TableRow
            android:id="@+id/tableRow9"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <LinearLayout
                android:id="@+id/soundaomplitude_graphViewLinearLayout"
                android:paddingTop="4dip" >    //if I specify nothing then nothing is displayed, if I set width = fill_parent and height = 200dp, then only 1/3 of the space is occupied

            </LinearLayout>
        </TableRow>

        <TableRow
            android:id="@+id/tableRow10"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <Button
                android:id="@+id/saveEditRecord"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight=".3"
                android:text="Save" />

            <Button
                android:id="@+id/deleteEditRecord"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight=".3"
                android:text="Delete" />

            <Button
                android:id="@+id/cancelEditRecord"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_gravity="right"
                android:layout_weight=".3"
                android:text="Cancel" />
        </TableRow>
    </TableLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-07T01:19:10.000

我发现只是为 linearLayout 设置 weight = 1（或任何数字）

```
<LinearLayout
                android:id="@+id/soundaomplitude_graphViewLinearLayout"
                android:layout_width="0dp"
                android:layout_height="200dp"
                android:layout_weight="1"
                android:paddingTop="4dip" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:21:35.583

似乎 TableRow 充当 LinearLayout，因此在 TableRow 内嵌套一个似乎是多余的。它说，在 Eclipse 中，它也是“无用的”。因此，您可以直接在 TableRow 中包含您的视图（任何视图），而不是 LinearLayout。如果它没有显示，那么，可能还有其他一些问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T22:34:29.410

再次阅读 TableLayout 如何管理其内容。特别注意，它忽略了子视图的 layout_width。

# delphi - 发送 smtp 消息时，什么标头控制“保留在服务器上”功能？

> ID：11836415
> 
> 赞同：1
> 
> 时间：2012-08-06T21:43:29.347
> 
> 标签：delphi, smtp

我正在使用 Synapse smtp 库发送 smtp 消息。但是消息不会保留在服务器上。电子邮件客户端有“在服务器上保留消息”选项，但如何手动设置？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T22:06:01.180

这是 POP3 客户端的用户定义设置。当 POP3 客户端下载消息时，它决定是否在下载该消息后从服务器中删除该消息。它根本不是 SMTP 的功能。

# verilog - " if 语句中的不是常量”错误

> ID：11836416
> 
> 赞同：7
> 
> 时间：2012-08-06T21:43:33.680
> 
> 标签：verilog

我正在尝试编写一个简单的模块来根据四个输入信号的值输出一个 14 位数。我的尝试如下所示。

```
module select_size(
    input a,
    input b,
    input c,
    input d,
    output [13:0] size
);

    if (a) begin
        assign size = 14'h2222;
    end
    else begin
        if (b) begin
            assign size = 14'h1111;
        end
        else begin
            if (c) begin
                assign size = 14'h0777;
            end
            else begin
                assign size = 14'h0333;
            end
        end
    end

endmodule 
```

编译后，我收到以下错误：

> 错误：HDLCompiler：44 - 第 67 行：c 不是常量

我不明白为什么如果前面的其他两个 if 语句不起作用，那么它为什么不起作用。我尝试将条件更改为

```
if (c == 1) begin 
```

但无济于事。

有谁知道如何解决这个错误？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T21:57:15.463

两个问题：

1）您需要将`if`语句放在一个`always`块内。

如果你使用verilog-2001，你可以使用

```
always @*
   if ....
   end
end 
```

否则指定敏感度列表中的所有输入：

```
always @(a or b or c or d)
   if ....
   end
end 
```

* * *

2) if 语句中不允许常量赋值。

`assign`从块内的任何语句中删除关键字`if`：

```
if (a) begin
    size = 14'h2222;
end 
```

您还必须将 size 声明为一种`reg`类型。

但是我更喜欢用条件运算符重写整个模块，我发现它更适合阅读。以下模块实现了相同的结果：

```
module select_size(
    input a,
    input b,
    input c,
    input d,
    output [13:0] size
);

    assign size = a ? 14'h2222 :
                  b ? 14'h1111 :
                  c ? 14'h0777 : 
                      14'h0333 ;

endmodule 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T08:00:22.960

正如@Tim 已经回答的那样，使用块`reg`内的类型`always`或`wire`with `assign`。

@Tim 还描述了嵌套的三元赋值，虽然在示例中写得很好，但它们通常被视为不好的做法。它们意味着很长的组合路径，并且可能难以维护。组合路径可以通过综合来优化，这应该意味着具有优化选择逻辑的多路复用器。

更易于维护的代码将具有更低的拥有成本，并且只要它不会导致更大的综合设计，它通常是首选。

我的实现是使用casez，（？不在乎）。我发现每个值的优先级更容易查看/调试。

```
module select_size(
  input a,
  input b,
  input c,
  input d,
  output logic [13:0] size //logic (SystemVerilog) or reg type
);

always @* begin
  casez ({a,b,c})
    3'b1?? : size = 14'h2222 ;
    3'b01? : size = 14'h1111 ;
    3'b001 : size = 14'h0777 ;
    3'b000 : size = 14'h0333 ;
    default: size = 'bx      ;
  endcase
end

endmodule 
```

# android - 无法在 Mountain Lion 的 Eclipse 中 cmd+单击 Java 方法

> ID：11836420
> 
> 赞同：11
> 
> 时间：2012-08-06T21:43:44.303
> 
> 标签：android, eclipse, osx-mountain-lion

昨天我从 Lion 升级到 Mountain Lion，今天我的工作效率下降了。我无法在方法或变量上执行“cmd + click”来声明它，因为 eclipse 中显示的弹出窗口包含一个水平滚动条，它溢出了最后一个选项。

有没有人有解决方案如何解决这个问题？

更新：要明确一点——“滚动时”和“自动基于鼠标或触控板”选项都不会为我解决问题。只有“始终”有效，但它对整个系统用户体验的影响是不可接受的

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T20:07:06.767

尝试这样做。在 Mountain Lion 中，转到 Preferences -> General 并`Show scroll bars`选择`Always`如下：

![在此处输入图像描述](../Images/466bdc5274a191827a3c225c5a6e69b2.png)

这应该可以防止滚动条覆盖最后一个选项并允许您单击它。这有帮助吗？

**更新**

我刚刚检查过这确实有效。事实上，对我来说，这只是`When Scrolling`造成问题的选项。使用剩下的任何一个设置，事情都很顺利：

不幸的是，我无法发布屏幕截图，因为当我按下用于截屏的快捷键（Cmd + Shift + 4）时，cmd + click 弹出窗口就会消失。

**更新 2** 我刚刚制作了这个快速屏幕截图，以显示山狮偏好之间的关系以及它如何影响日食。看看**[这里](http://youtu.be/qV7EmzozI0o)**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-24T09:24:46.720

如果在光标位于变量或方法上时按 F3，则 Eclipse 将“打开声明”。通过删除基于鼠标的工作流程来解决问题？

# jquery - jQuery：单击关闭时，警报会删除 div 标签

> ID：11836422
> 
> 赞同：1
> 
> 时间：2012-08-06T21:43:51.183
> 
> 标签：jquery, twitter-bootstrap

我的`ajax`样子

```
 // send the data to the server using .ajax() or .post()
    $.ajax({
        type: 'POST',
        url: 'addVideo',
        data: {
            video_title: title,
            playlist_name: playlist,
            url: id
            // csrfmiddlewaretoken: '{{ csrf_token }}',
        },
        done: notify('success', 'video saved successfully'),
        fail: notify('error', 'There were some errors while saving the video. Please try in a while')
    }); 
```

`notify`好像

```
function notify(notify_type, msg) {
    var alerts = $('#alerts');
    alerts.addClass('alert');
    alerts.append('<a class="close" data-dismiss="alert" href="#">×</a>');
    if (notify_type == 'success') {
      alerts.addClass('alerts-success').append(msg).fadeIn('fast');
    }
    if (notify_type == 'failure') {
      alerts.addClass('alerts-error').append(msg).fadeIn('fast');
    }
} 
```

*   当我保存单击按钮时，我收到成功消息

> 视频保存成功 x(叉号)

*   我点击交叉，现在通知消失了
*   当我再次保存单击按钮时，没有任何反应，我看到萤火虫在抱怨 `No elements were found with the selector: "#alerts"`

*   我的猜测是单击十字标记会`div="alerts"`完全从 DOM 中删除标记。这是正确的吗？

**问题** - 我怎样才能得到正确的行为。单击十字标记删除通知 div，单击按钮创建再次创建通知 div

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:09:00.023

实际上，当您单击插件时会根据[**此**](http://twitter.github.com/bootstrap/assets/js/bootstrap-alert.js)`x`删除 div，因此当您尝试在关闭它后`div`再次选择使用时，一旦.`var alerts = $('#alerts');``div``dom`

负责关闭/删除元素的插件的一部分

```
function removeElement() {
  $parent
    .trigger('closed')
    .remove()
}

$.support.transition && $parent.hasClass('fade') ?
  $parent.on($.support.transition.end, removeElement) :
  removeElement() 
```

尝试每次（使用 id `alerts`）创建一个动态 div 并将其附加到您要放置它的主体，它可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T15:42:33.130

正如 Sheikh Heera 所说，您可以通过更改在插件中解决此问题

```
function removeElement() {
  $parent
  .trigger('closed')
  .remove()
} 
```

到

```
function removeElement() {
  $parent
  .trigger('closed')
  .hide()
} 
```

# c++ - Can I use std::shared_ptr to wrap per I/O data in IOCP?

> ID：11836423
> 
> 赞同：1
> 
> 时间：2012-08-06T21:44:02.740
> 
> 标签：c++, sockets, winsock2, iocp

I'm working on a client application that uses IOCP.

My per I/O data class is derived from WSAOVERLAPPED:

```
class IoRequest : public WSAOVERLAPPED
{
...
}; 
```

And when performing asynchronous I/O operations, I use it like this:

```
{ // WSASend - this is done in my main thread.
    IoRequest *pIoRequest = new IoRequest;
    pIoRequest->SetSocket(m_socket);
    pIoRequest->SetBuffer(vecCommandData);
    pIoRequest->SetOperationType(OP_TYPE_SEND);
    WSASend(m_socket, pIoRequest->GetWsaBuffer(), 1, NULL, 0, pIoRequest, NULL);
}

{ // WSARecv - this is done in my I/O worker thread.
    GetQueuedCompletionStatus(m_hIocp, &dwNumberOfBytesTransferred, &ulCompletionKey, (LPOVERLAPPED*)&pIoRequest, INFINITE);
    ...
    WSARecv(pIoRequest->GetSocket(), pIoRequest->GetWsaBuffer(), 1, NULL, &(pIoRequest->GetFlags()), pIoRequest, NULL);
    ...
} 
```

I reuse my IoRequest instance in my worker thread routine. I wonder, will there be any problem using std::shared_ptr instead of a raw pointer to manage my per I/O data?

So for WSASend(), something like:

```
std::shared_ptr<IoRequest> spIoRequest(new IoRequest);
spIoRequest->SetSocket(m_socket);
spIoRequest->SetBuffer(vecCommandData);
spIoRequest->SetOperationType(OP_TYPE_SEND);
WSASend(m_socket, spIoRequest->GetWsaBuffer(), 1, NULL, 0, spIoRequest.get(), NULL); 
```

Cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:49:56.110

Unless you have a live instance of `std::shared_ptr<IoRequest>` somewhere, your `IoRequest` will be deallocated at the end of the sending routine before the completion handler receives it.

# c++ - C++ EXC_BAD_ACCESS, argv[]

> ID：11836426
> 
> 赞同：0
> 
> 时间：2012-08-06T21:44:17.243
> 
> 标签：c++, exc-bad-access, command-line-arguments

我已经坚持了一段时间，无法调试此`EXC_BAD_ACCESS`错误。我已经运行了 NSZombie，我很确定这是一个内存问题`argv[1]`（或其他任何问题）。我检查了我的语法和库，所以我不知道为什么它不会存储过去`arg[0]`。

```
#include <iostream>
#include <cstdlib>
#include <cstring>
using namespace std;

int main(int argc, char* argv[])
{
    cout << "Enter the initial bankroll" << endl;
    int bankroll = atoi(argv[1]); //code faults here

    cout << "Enter seed" << endl;
    int seed = atoi(argv[2]);

    // ... 
```

我省略了其余部分，因为错误发生在其他任何事情之前。

代码在终端中运行，但我的班级的自动评分器失败了。

输入的参数：

> ./二十一点 400 1

应该适用于任何数字。

不`argv[0]`应该是二十一点，`argv[1]`第一个数字和`argv[2]`第二个数字？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:45:34.120

`cout` **不**填充 的元素`argv`，它们来自用于执行程序的命令行。此外，无论何时使用`argv`，请务必检查`argc`，这是 . 中有效索引的数量`argv`。您的程序可能崩溃了，因为您*没有*向程序传递任何参数，因此 的元素`argv`不可用。

您需要使用`cin`调用来读取您期望的用户输入，或者更改您的程序以使用从命令行传入的值，即没有提示或读取。

您添加的假设是正确的`argv`：如果您使用以下命令执行程序`./blackjack 400 1`，则`argv[1]`应该是`400`，并且`argv[2]`应该是`1`。

因为，根据您的编辑，您似乎想从命令行获取这些数字，然后删除您的`cout`呼叫。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:01:00.190

正如其他人所指出的， argv 是命令行参数。如果它们被填满，您只需使用它们。我经常这样做：

```
int
main(int n_app_args, char** app_arg)
{
  std::string nec_file;
  if (n_app_args > 1)
    nec_file = app_arg[1];
  else
  {
    std::cout << "Enter NEC output file: ";
    std::cin >> nec_file;
  } 
```

如果我忘记了程序问我的命令行参数。如果我记得这个论点，那么这个论点是在没有进一步干预的情况下使用的。您显然可以将其扩展到更多参数。

# linux - 如何将结果“！find ...”命令重定向到lftp命令

> ID：11836427
> 
> 赞同：5
> 
> 时间：2012-08-06T21:44:17.067
> 
> 标签：linux, shell, ftp, lftp

我想从 lftp 的 !find 命令的结果中放入文件。

我试过了：

```
$> lftp -u foo, sftp://bar
lftp foo@bar$> put < !find ./local -type f 
```

但是失败了！！

这有效：

```
$> lftp -u foo, sftp://bar
lftp foo@bar$> !find ./local -type f | awk '{print "put "$1}' > /tmp/files.lftp
lftp foo@bar$> source /tmp/files.lftp 
```

有没有别的办法！？我想使用标准输入输出重定向（管道、标准输入...）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-28T14:21:12.663

我通读了整个[人 lftp(1)](http://lftp.yar.ru/lftp-man.html)，看来**您选择的方式实际上是最好的方式**。

1.  `!`command 不支持与其他命令直接组合，正如您尝试的那样`put < !find ...`
2.  上传文件的唯一方法是使用`put`,`mput`或`mirror`. `mirror`正如您所指出的，它对您没有用，因为它保留了路径。
3.  `put`或`mput`命令不支持以任何方式指定要上传的文件列表的文件。

所以，唯一的可能就是你所拥有的：生成脚本并使用`source`它来运行它。

您可以尝试将所有文​​件放入一个`mput`命令中：

```
!find ./local -type f | awk -v ORS=" " 'BEGIN{print "mput "}{print}' > /tmp/files.lftp 
```

但要小心：虽然我没有在文档中找到它，但最大行大小可能有限制！所以我认为最终你的方式是最好的方式。

请注意，您还可以将您的命令编码为：

```
!find ./local -type f -printf "put %p\n" > /tmp/files.lftp 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-31T02:10:41.740

```
source -e find ./local -type f \| sed \'s/^\(.*\)$/put \"\1\"/\' 
```

该命令用双引号 ( ) 将`sed`每个输出行括起来，并在前面加上. 这将适用于包含空格和一些其他关键字符的文件名，但对于包含双引号、换行符等的文件名将失败...如果您的文件名中碰巧有这样的字符，您可以扩展相应的替换。`find``"``put``sed`

请注意，`\`管道符号 ( ) 前面的反斜杠 ( ) `|`、双引号和单引号是为了逃避`lsftp`命令行解析器的解释。要在`sh`-like shell 上测试命令，请使用：

```
find ./local -type f | sed 's/^\(.*\)$/put "\1"/' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-06T10:50:25.187

如果你知道`local`目录的最大深度，你可以使用`mput`这样的普通命令：

```
lcd local && mput * */* */*/* */*/*/* 
```

# database-design - Amazon DynamoDB 是否适合小型数据集？

> ID：11836429
> 
> 赞同：2
> 
> 时间：2012-08-06T21:44:37.920
> 
> 标签：database-design, amazon-web-services, nosql, amazon-dynamodb

我目前正在开发一个由 DynamoDB 支持的应用程序，该应用程序为大型客户群存储与客户相关的数据。它非常适合 DynamoDB：客户 ID 作为散列键分区很好。

我有一些与此数据集相关的元数据。它现在非常小（大约 10 项），但我预计它会在未来几年内增长到多达 100 项。尽管它很小，但我考虑过简单地对其进行硬编码，但这会使数据与业务利益相关者保持距离并且不必要地使部署复杂化（我正在开发一个可跨多个站点使用的库）。

因此，由于将相似的事物与相似的事物保持一致是有意义的，因此将元数据与它所元数据一起保存在 DynamoDB 表中是有意义的。然而，DynamoDB 文档以可扩展性问题为由[警告不要](http://aws.amazon.com/dynamodb/faqs/#How_does_selection_of_primary_key_influence_the_scalability_I_can_achieve)使用少量流行的哈希键。未缓存的小数据集可能使用与大数据集相同的容量估计，尽管我会通过一些积极的缓存来抵消它。

有责任心的开发人员应该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T11:51:01.767

如果这些元数据打算由重型决策算法使用，那么使用 memcached 或其他一些分布式缓存替代方案可能更有意义，此外，由于数据库不会成为瓶颈，您可以选择任何您想要的数据库。

实现将非常简单，只是数据访问组件的代理，它会在缓存中查找键，当找不到它时，它会从数据库中读取，然后放入缓存中。

看看 AWS [ElasticCache](http://docs.amazonwebservices.com/AmazonElastiCache/latest/GettingStartedGuide/Welcome.html)

# module - 你可以在变量上调用“require”吗？

> ID：11836434
> 
> 赞同：4
> 
> 时间：2012-08-06T21:45:05.060
> 
> 标签：module, lua, coronasdk

我有一个需要另一个 lua 文件才能运行的 lua 文件，但我无法对文件名进行硬编码。我可以在变量上使用 require 函数，还是需要找出我正在做的事情的替代方法？

例如

```
local path = "mypath.txt"

local level = require path 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:58:04.837

是的你可以。`require "module"`只是一个语法糖`require("module")`，只有在调用具有单个参数的函数时才有效，该函数是字符串或表构造函数。使用正确的调用形式，`require(path)`它会起作用。

# bash - 如果 find -exec 返回不为零，则停止 make

> ID：11836435
> 
> 赞同：6
> 
> 时间：2012-08-06T21:45:07.710
> 
> 标签：bash, makefile, find

我正在尝试将检查我的代码使用集成`pyflakes`到构建过程中。我在我的 中定义了以下目标`Makefile`：

```
pyflakes:
    find $(APPLICATION_DIRECTORY) -iname "*.py" -exec pyflakes "{}" \; 
```

问题是每次都`find`返回`0`，即使有代码问题（`pyflakes`返回不`0`）并`make`成功。理想情况下，我想对每个源文件运行检查，并`make`在至少有一个`-exec`失败时停止。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:14:21.593

我认为没有办法`find`返回退出代码`-exec`。
应该工作的是管道`xargs`：

```
find $(APPLICATION_DIRECTORY) -iname "*.py" |xargs -I file pyflakes file 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:17:34.460

您可以将 find 的输出通过管道传输到您自己的处理循环并在 pyflakes 返回非 0 的退出状态时退出。

```
find . -iname '*.jpg' | \
while read line ; do
    pyflakes "$line"
    res=$?
    if [ $res -ne 0 ] ; then
        exit $res
    fi
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T00:20:35.337

让它结束查找过程

```
pyflakes:
    find $(APPLICATION_DIRECTORY) -iname "*.py" -exec bash -c 'pyflakes {}; if [[ $$? != 0 ]]; then kill -INT $$PPID;fi' \; 
```

这是 makefile 中的内容，它不是脚本文件，如果您想知道语法的话。

# python - 如何用模拟模拟只读属性？

> ID：11836436
> 
> 赞同：115
> 
> 时间：2012-08-06T21:45:09.190
> 
> 标签：python, unit-testing, mocking, pytest

你如何用[mock](http://www.voidspace.org.uk/python/mock/index.html)模拟只读属性？

我试过：

```
setattr(obj.__class__, 'property_to_be_mocked', mock.Mock()) 
```

但问题是它随后适用于类的所有实例......这打破了我的测试。

你还有别的想法吗？我不想模拟整个对象，只模拟这个特定的属性。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2014-08-21T10:28:54.713

我认为更好的方法是将属性模拟为`PropertyMock`，而不是`__get__`直接模拟方法。

它在[文档](https://docs.python.org/3/library/unittest.mock.html#unittest.mock.PropertyMock)中说明，搜索`unittest.mock.PropertyMock`：旨在用作类的属性或其他描述符的模拟。`PropertyMock`提供`__get__`和`__set__`方法，以便您可以在获取时指定返回值。

方法如下：

```
class MyClass:
    @property
    def last_transaction(self):
        # an expensive and complicated DB query here
        pass

def test(unittest.TestCase):
    with mock.patch('MyClass.last_transaction', new_callable=PropertyMock) as mock_last_transaction:
        mock_last_transaction.return_value = Transaction()
        myclass = MyClass()
        print myclass.last_transaction
        mock_last_transaction.assert_called_once_with() 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-08-07T10:17:53.097

实际上，答案是（像往常一样）在[文档](http://www.voidspace.org.uk/python/mock/examples.html#mocking-properties)中，只是当我按照他们的示例时，我将补丁应用于实例而不是类。

这是如何做到的：

```
class MyClass:
    @property
    def last_transaction(self):
        # an expensive and complicated DB query here
        pass 
```

在测试套件中：

```
def test():
    # Make sure you patch on MyClass, not on a MyClass instance, otherwise
    # you'll get an AttributeError, because mock is using settattr and
    # last_transaction is a readonly property so there's no setter.
    with mock.patch(MyClass, 'last_transaction') as mock_last_transaction:
        mock_last_transaction.__get__ = mock.Mock(return_value=Transaction())
        myclass = MyClass()
        print myclass.last_transaction 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2019-04-11T23:18:37.323

如果要覆盖其属性的对象是模拟对象，则不必使用`patch`.

相反，可以创建一个[`PropertyMock`](https://docs.python.org/3/library/unittest.mock.html#unittest.mock.PropertyMock)然后覆盖模拟*类型上的属性。*例如，要覆盖`mock_rows.pages`要返回的属性`(mock_page, mock_page,)`：

```
mock_page = mock.create_autospec(reader.ReadRowsPage)
# TODO: set up mock_page.
mock_pages = mock.PropertyMock(return_value=(mock_page, mock_page,))
type(mock_rows).pages = mock_pages 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-01-10T14:28:42.670

可能是风格问题，但如果您更喜欢测试中的装饰器，@jamescastlefield 的[答案](https://stackoverflow.com/a/25424012/451710)可以更改为：

```
class MyClass:
    @property
    def last_transaction(self):
        # an expensive and complicated DB query here
        pass

class Test(unittest.TestCase):
    @mock.patch('MyClass.last_transaction', new_callable=PropertyMock)
    def test(self, mock_last_transaction):
        mock_last_transaction.return_value = Transaction()
        myclass = MyClass()
        print myclass.last_transaction
        mock_last_transaction.assert_called_once_with() 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-01-06T16:05:07.477

如果您使用[`pytest`](https://docs.pytest.org/en/latest/)with [`pytest-mock`](https://github.com/pytest-dev/pytest-mock)，您可以简化代码并避免使用上下文管理器，即`with`语句如下：

```
def test_name(mocker): # mocker is a fixture included in pytest-mock
    mocked_property = mocker.patch(
        'MyClass.property_to_be_mocked',
        new_callable=mocker.PropertyMock,
        return_value='any desired value'
    )
    o = MyClass()

    print(o.property_to_be_mocked) # this will print: any desired value

    mocked_property.assert_called_once_with() 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-10-21T08:59:49.573

如果你需要你的 mocked`@property`依赖于原来的`__get__`，你可以创建你的自定义`MockProperty`

```
class PropertyMock(mock.Mock):

    def __get__(self, obj, obj_type=None):
        return self(obj, obj_type) 
```

用法：

```
class A:

  @property
  def f(self):
    return 123

original_get = A.f.__get__

def new_get(self, obj_type=None):
  return f'mocked result: {original_get(self, obj_type)}'

with mock.patch('__main__.A.f', new_callable=PropertyMock) as mock_foo:
  mock_foo.side_effect = new_get
  print(A().f)  # mocked result: 123
  print(mock_foo.call_count)  # 1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-07T00:46:13.837

如果您不想测试是否访问了模拟属性，您可以简单地使用预期的`return_value`.

```
with mock.patch(MyClass, 'last_transaction', Transaction()):
    ... 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-30T18:34:29.737

我被引导到这个问题，因为我想在测试中模拟 Python 版本。不确定这是否与这个问题非常相关，但`sys.version`显然是只读的（......虽然技术上是“属性”而不是“属性”，我想）。

所以，在仔细阅读了这个地方并尝试了一些愚蠢复杂的东西之后，我意识到答案本身就是简单的：

```
with mock.patch('sys.version', version_tried):
    if version_tried == '2.5.2':
        with pytest.raises(SystemExit):
            import core.__main__
        _, err = capsys.readouterr()
        assert 'FATAL' in err and 'too old' in err 
```

...可能会帮助某人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-01T16:29:21.710

模拟对象属性的另一种方法是：

```
import mock

mocked_object = mock.Mock()
mocked_object.some_property = "Property value"

print(mocked_object.some_property) 
```

# ruby-on-rails - Rails 将 date_select 转换为 int 值

> ID：11836437
> 
> 赞同：0
> 
> 时间：2012-08-06T21:45:10.247
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

在 Rails 3.x 中，我有一个带有 int 字段“my_int_date”的模型类。我希望 int 字段由作为 date_select 表单元素的表单填充。

问题是当表单读取 date_select 值时，它会将其作为多参数值发回，这会导致错误

```
1 error(s) on assignment of multiparameter attributes 
```

无论如何我可以将它作为日期存储在我的模型中，但在将其转储到数据库时将其转换为 int？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:01:09.473

Ruby 可以使用 to_i 将 Time 对象转换为秒

```
Time.now.to_i # Returns epoc time (s) 
```

如果是字符串，则可以使用 to_time 方法

```
'2012-06-01'.to_time.to_i # string to Time object then to epoc time (s) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T21:59:44.337

这是我如何解决的，

在我的 ActiveRecord 模型中，我添加了字段

```
attr_accessible :my_int_date_time

columns_hash["my_int_date_time"] = ActiveRecord::ConnectionAdapters::Column.new("my_int_date_time", nil, "DateTime")

def my_int_date_time
  return TimeHelper.datetime_from_integer(self.my_int_date)
end

def my_int_date_time= val
    self.my_int_date = TimeHelper.datetime_to_integer(val)
end 
```

然后在我的表单中，我将日期时间字段链接到字段 my_int_date_time 而不是将其链接到 my_int_date

# jpa - JPA/Hibernate 和复合键

> ID：11836440
> 
> 赞同：4
> 
> 时间：2012-08-06T21:45:25.783
> 
> 标签：jpa, composite-primary-key

我遇到了一些**SO**讨论和其他帖子（例如，[此处](https://stackoverflow.com/questions/4024800/jpa-hibernate-whats-better-for-composite-primary-keys-idclass-or-embeddedid)、[此处](http://www.ibm.com/developerworks/java/library/os-hibernatejpa/)和[此处](http://www.coderanch.com/t/486475/ORM/databases/JPA-composite-primary-key-classes)），其中将复合主键与**JPA**一起使用被描述为尽可能避免的事情，或者由于遗留数据库或具有“毛茸茸”的必要性角落案例。由于我们正在从头开始设计一个新数据库并且没有任何遗留问题需要考虑，因此建议或者更安全地避免使用**JPA**（**Hibernate**或**EclipseLink**？）的复合主键。

我自己的感觉是，由于**JPA**引擎足够复杂，而且当然，像所有软件一样，并非没有错误，最好忍受非规范化表而不是忍受与复合主键相关的错误运行的恐惧（基本原理因为数字单列主键和外键是 JPA 引擎支持的最简单的用例，因此它应该尽可能没有错误）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T21:58:27.000

这两种方法我都试过了，我个人更喜欢避免使用复合主键，原因如下：

*   您可以创建一个包含 id 字段的超类，因此您不必在所有实体中都使用它。
*   实体创建变得更加容易
*   JPA 总体上表现更好
*   引用实体变得更容易。例如，将一堆 ID 存储在一个集合中，或者在网页的查询字符串中指定一个 id，这在很大程度上简化为只需要使用一个数字。
*   您可以使用适用于所有实体的超类中指定的单个 equals 方法）。
*   如果你使用 JSF，你可以制作一个通用转换器
*   使用数据库客户端时更容易指定对象

但它也带来了一些不好的部分：

*   少量的非规范化
*   在某些情况下，使用非持久对象（如果您使用自动生成的 ID，您应该这样做）可能会带来麻烦，因为等式方法等需要一个 ID 才能正常工作

# middleman - Middlemanapp：未知扩展

> ID：11836443
> 
> 赞同：2
> 
> 时间：2012-08-06T21:45:43.043
> 
> 标签：middleman

我从控制台运行：

```
middleman build 
```

我明白了

```
== Unknown Extension: smusher
== Unknown Extension: favicon_maker 
```

我的宝石文件

```
source :rubygems
gem "middleman", "~>3.0.0"
gem "middleman-smusher"
gem "middleman-favicon-maker" 
```

我运行捆绑安装和捆绑更新。问题可能出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-21T21:17:48.313

在项目的根目录内应该是一个`config.rb`文件。在该文件中，您应该向构建配置添加两个扩展：

```
configure :build do
 activate :smusher
 activate :favicon_maker
end 
```

[中间人配置指南](http://middlemanapp.com/advanced/configuration/#toc_3)

# python - Python 数字的智能四舍五入

> ID：11836445
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:45:58.593
> 
> 标签：python, list, numbers, rounding

我有一些奇怪的数字，例如`19 or 23.`这两个需要分成`5 lists`，这样 5 个列表的总和将为 19。换句话说，每个列表中的 3.8 为 19/5 = 3.8。但是问题是我不能有小数，我想要四舍五入的数字。有什么办法可以相应地对数字进行四舍五入，将 4、4、3、4、4 放入列表中，而不是 3.8 五次？

更重要的是，有些没有分成 5 个不同的数字。有些可能类似于 77/12，因此被分成 12 个差异。每个列表中的数字为 6 或 7，最终加起来为 77。

知道如何解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T21:50:54.253

```
def split(number, length):
    div, mod = divmod(number, length)
    return [div+1]*mod + [div]*(length-mod)

>>> split(19, 5)
[4, 4, 4, 4, 3]
>>> split(23, 4)
[6, 6, 6, 5] 
```

原始版本：

```
def split(number, length):
    result = [number//length]*length
    for i in range(number%length):
        result[i] += 1
    return result 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:46:51.123

干得好。

```
def roundto(number,items):
    start = [1 for i in xrange(items)]
    reached = False
    while not reached:
        for i in xrange(len(start)):
            start[i] += 1
            if sum(start) == number:
                return start

print roundto(19,5)
>>> 
[4, 4, 4, 4, 3] 
```

# python - python termios 模式，如“htop，atop”实用程序

> ID：11836448
> 
> 赞同：2
> 
> 时间：2012-08-06T21:46:07.957
> 
> 标签：python, terminal

当可以通过它的坐标对每个单元格进行操作时，如何在模式下使用终端窗口？我不知道这个模式是怎么命名的，这就是为什么我不能谷歌它。另外，我知道[这种方法](https://stackoverflow.com/questions/4224933/htop-style-gui-with-python-how)，但现在对我来说如何在低级别使用它很有趣。

**UPD：** 好的，我阅读了所有 termios 手册页和其他一些文档，我现在唯一能说的 - 我仍然不知道如何在终端的某处制作旋转条，即按帧：- \ | / - .:(

**UPD2** 哦，我在[那里](https://stackoverflow.com/questions/2122385/dynamic-terminal-printing-with-python?rq=1)突然发现它：

```
import sys
import time

f='-\\|/'

for i in range(10):
    sys.stdout.write("\r{0}".format(f[i%4]))
    sys.stdout.flush()
    time.sleep(0.5) 
```

那么，本主题的最后一个问题 -*仅使用 termios 的任何坐标*呢？

**子问题[已解决]：**

当我使用[这篇文章](https://stackoverflow.com/a/2122972/1531116)`curses`中的第二个代码列表时- 它使我的半透明终端窗口不透明，当不这样做时。如何保持透明？`top`

解决方案：插入`curses.use_default_colors()`.`def pbar(window):`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:48:12.460

诅咒（[http://docs.python.org/library/curses.html](http://docs.python.org/library/curses.html)）或控制台（[http://effbot.org/zone/console-handbook.htm](http://effbot.org/zone/console-handbook.htm)）模块是你想要的

Console.py 的源代码可在此处获得[http://www.math.uiuc.edu/~gfrancis/illimath/windows/aszgard_mini/pylibs/readline/Console.py](http://www.math.uiuc.edu/~gfrancis/illimath/windows/aszgard_mini/pylibs/readline/Console.py)我相信你可以看看……虽然我确定这可能是一个很大的痛苦，这就是为什么人们总是使用诅咒......

在 Windows 上，您可能想浏览 msdn [http://msdn.microsoft.com/en-us/library/system.console.aspx](http://msdn.microsoft.com/en-us/library/system.console.aspx) 并使用 ctypes.cdll.whatever 调用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:03:13.290

如果你想要一个低于 的库[`curses`](http://docs.python.org/library/curses.html)，你可以使用[`termios`](http://docs.python.org/library/termios.html)（虽然我怀疑 htop 的 UI 主要是用 curses 编写的）

Python 文档页面`termios`很少，因为该模块几乎只公开了底层 UNIX'y termios 库，因此非 Python 特定文档是主要信息来源，[如 termios 上的本指南](http://en.wikibooks.org/wiki/Serial_Programming/termios)或[termios.h 标头](http://linux.die.net/man/3/termios)（或`man termios`在外壳中运行）

当然，挑战是将代码翻译成 Python，但通常翻译是相当直接的（函数调用通常非常相似，并且 bit-swizzling/bit-masking 通常是相同的）

# html - z-index 在 ipad 中不能很好地工作

> ID：11836451
> 
> 赞同：7
> 
> 时间：2012-08-06T21:46:43.873
> 
> 标签：html, css, mobile-safari, z-index

我正在为一个朋友（[http://pasionesargentas.com/sm/](http://pasionesargentas.com/sm/)）建立一个带有缩略图翻转全屏画廊的网站（[http://tympanus.net/codrops/2011/02/09/fullscreen-gallery-with-缩略图翻转/](http://tympanus.net/codrops/2011/02/09/fullscreen-gallery-with-thumbnail-flip/)）。我不太喜欢翻转的想法，所以我只是更喜欢禁用它并添加一个菜单。菜单 div css 类似于

```
#top {
position:fixed;
background: transparent;
display: block;
z-index: 99999;
} 
```

它在 Chrome、Safari、Explorer 和 Opera 中运行良好。但由于某种原因，她在 iPad 上看不到菜单。因为我没有 ipad，所以我下载了 Ripple Mission Control，它也可以正常工作，所以我不知道发生了什么。

现在，问题是：我必须为平板电脑浏览器（iPad）做不同的 css 吗？还是画廊弄乱了菜单并掩盖了它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T20:47:59.387

有同样的问题，想在另一个 div 上使用一个带有透明 png 的覆盖 div。发现`z-index`这只适用于位置属性已明确设置为绝对、固定或相对的元素。立即修复了我的 ipad`z-index`问题。

```
.topbar { 
    display:block; 
    background: transparent; 
    height: 60px; 
    width: 1024px; 
    display: block; 
    margin: 0; 
    padding: 0; 
    z-index:6; 
    position:relative; 
} 
.middlebar { 
    display:block; 
    background: transparent; 
    height: 60px; 
    width: 1024px; 
    display: block; 
    margin: 0; 
    padding: 0; 
    z-index:5; 
    position:relative; 
} 
.bottom { 
    display:block; 
    background: transparent; 
    height: 758px; 
    width: 1024px; 
    display: block; 
    margin: 0; 
    padding: 0; 
    z-index:4; 
    position:relative; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T12:47:50.537

```
.description {
position: fixed;
top: 5px;
left: 50px;
text-shadow: 1px 1px 1px black;
z-index: 5;
}
#nav:hover {
background: #829FB0;
opacity: 1.0;
filter: alpha(opacity=100);
z-index: 10;
}
#nav {
align: center;
background: #829FB0;
padding: 3px 7px;
display: inline;
opacity: 1.0; //change this later
filter: alpha(opacity=65);
-moz-border-radius: 9px;
border-radius: 9px;
z-index: 10;
} 
```

**问题可能是透明的覆盖 divs**，所以首先用这个代码替换你的代码，其中必须放置更高的 divs/nodes 不透明然后看看，也使用我给出的 z-indexes，你不需要太很高的价值观

在检查 css 中的错误时，请确保使节点可见并删除它们的不透明度，并且永远不要为 z-indexes 提供过高的值。试试这个，如果它不起作用，我会仔细看看。

# android - 用于展示厅的 Android 启动器应用程序

> ID：11836457
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:46:51.807
> 
> 标签：android, launcher

我在陈列室里有一个 Galaxy Tab，我想锁定 Android 的所有选项，例如安装/卸载应用程序、蓝牙、更改主屏幕等。

我想知道是否有人知道可以让我完成此任务的启动器应用程序？

蒂亚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:49:22.227

我建议将平板电脑植根并创建自己的自定义家庭应用程序来替换库存的应用程序。

这样做，您可以控制对应用程序和系统的访问。

**编辑**

看看这个链接： http: [//www.addictivetips.com/android/the-best-free-android-launchers-for-home-screen-replacement/](http://www.addictivetips.com/android/the-best-free-android-launchers-for-home-screen-replacement/)

# php - 如何使用 php 和 Codeigniter 存储搜索条件？

> ID：11836461
> 
> 赞同：2
> 
> 时间：2012-08-06T21:47:16.190
> 
> 标签：php, codeigniter, session, pagination

我有一个小问题。

我使用 CodeIgniter 框架在 php 中编写了一个完整的网站。我的模块之一是搜索模块，它包含带有关键字的文本输入和三个带有过滤条件的选择列表。

没关系，当我搜索某些内容时 - 结果的列表分页是通过这样的 URL 完成的：

```
mysite.com/$keyword/$criteria1/$criteria2/$criteria3/$offset 
```

奇迹般有效。

但是当我进入我的一张图片（它是图片库）时，我希望有一个选项可以从我的搜索结果中进入 NEXT 和 PREVIOUS 图像 - 我输入这张图片的那些。

我现在正在以这种方式解决这个案例 - 我有一个名为“search_conditions”的会话表，我在那里存储了关键字的值和我的三个条件，但这很不舒服，因为为什么如果有人打开第二个窗口并搜索其他东西那里？

然后他在另一个窗口或选项卡中的所有搜索都获得相同的标准 - 因为每次新搜索时，用户都会覆盖会话值。

我的下一个和上一个功能：

```
public function next($count)
{
    $search = $this->session->userdata('search_conditions'); //getting session table and overwriting it

    $catid = isset($search['catid'])?$search['catid']:'0';
    $brandid = isset($search['brandid'])?$search['brandid']:'0';
    $prodid = isset($search['prodid'])?$search['prodid']:'0';
    $keyword = isset($search['keyword'])?$search['keyword']:'';

    $res = $this->search_model->main_search($keyword,  $catid, $brandid, $prodid, $count, 1);       
}

public function previous($count)
{
    $search = $this->session->userdata('search_conditions');

    $catid = isset($search['catid'])?$search['catid']:'0';
    $brandid = isset($search['brandid'])?$search['brandid']:'0';
    $prodid = isset($search['prodid'])?$search['prodid']:'0';
    $keyword = isset($search['keyword'])?$search['keyword']:'';

    $res = $this->search_model->main_search($keyword,  $catid, $brandid, $prodid, $count-2, 1);     

} 
```

你能给我推荐一些其他更舒服的解决方案吗，因为这似乎不太好...... :)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:58:56.700

在 next() 和 previous() 函数中从 URI 中提取段。使用 codeigniter URL 帮助程序。这应该允许您将不同的搜索条件作为变量传递到下一页，这也将消除您使用会话的需要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:31:11.820

`$search_conditions`为变量添加索引：

```
$search_conditions[1]['catid']
$search_conditions[1]['brandid']
... 
```

然后使用控制器或配置变量引用它。这样，您可以允许一个会话存储多个搜索条件。

但我建议您放弃在会话中存储搜索条件。相反，只需将其与 URI 一起传递。在您描述的情况下，会话数据充当中介；你不需要它。使用[分页类](http://codeigniter.com/user_guide/libraries/pagination.html)并将搜索页码*而*不是*方向*（`next`或`previous`）传递给 URI。
不要担心 URI 可能看起来很丑 - 它只取决于用户搜索的内容，并且仍然可以友好地共享。您唯一关心的是 GET 字符串是否没有扩展[有限的长度](https://stackoverflow.com/questions/2659952/maximum-length-of-http-get-request)。

# mysql - 使用 levenshtein 距离比比较 2 条记录

> ID：11836462
> 
> 赞同：0
> 
> 时间：2012-08-06T21:47:18.753
> 
> 标签：mysql, distance, levenshtein-distance

我使用 levenshtein distance 和 ratio 源代码创建了 mysql 用户函数。我正在比较 2 条记录，并根据 75% 的匹配度来选择记录。

1.  订单进入`paypal_ipn_orders`带有`ITEM`标题的表格
2.  对表执行查询以`itemkey`在记录中找到 75% 的匹配项，`ITEM`同时调用
3.  `itemkey`如果 75% 的标题匹配，它会在表之间分配一个八位数字`paypal_ipn_orders`

这是查询

```
 UPDATE paypal_ipn_orders
      SET sort_num = (SELECT sort_id
      FROM itemkey
      WHERE  levenshtein_ratio(itemkey.item, paypal_ipn_orders.item_name) > 75)
      WHERE packing_slip_printed = 0 
      AND LOWER(payment_status) = 'completed' 
      AND address_name <> ''
      AND shipping < 100 
```

我已经对此进行了几次调整，但它在 levenshtein_ratio 部分的第 4 行和第 5 行之间失败了。如果它有效，则表示子查询返回多于一行。我不知道如何修复它以使其返回正确的结果，我只是不知道如何使它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:08:41.877

SET 上的子查询应该只返回一个值。如果 itemkey 有一个以上的 item_name 的 75% 你想做什么？下面将使用最佳匹配之一：

```
UPDATE paypal_ipn_orders
SET sort_num = (SELECT sort_id
  FROM itemkey
  WHERE  levenshtein_ratio(itemkey.item, paypal_ipn_orders.item_name) > 75
  ORDER BY levenshtein_ratio(itemkey.item, paypal_ipn_orders.item_name) DESC
  LIMIT 1)
WHERE packing_slip_printed = 0 
  AND LOWER(payment_status) = 'completed' 
  AND address_name <> ''
  AND shipping < 100 
```

# javascript - underscore.js 中的 context 参数有什么作用？

> ID：11836467
> 
> 赞同：3
> 
> 时间：2012-08-06T21:47:32.433
> 
> 标签：javascript, underscore.js

> **可能重复：**
> [underscore.js _.each(list, iterator, [context]) 什么是上下文？](https://stackoverflow.com/questions/4946456/underscore-js-eachlist-iterator-context-what-is-context)

所以在 underscore.js 中这个 forEach 函数的上下文中：

```
// The cornerstone, an `each` implementation, aka `forEach`.
// Handles objects with the built-in `forEach`, arrays, and raw objects.
// Delegates to **ECMAScript 5**'s native `forEach` if available.
var each = _.each = _.forEach = function(obj, iterator, context) {
  if (obj == null) return;
  if (nativeForEach && obj.forEach === nativeForEach) {
    obj.forEach(iterator, context);
  } else if (obj.length === +obj.length) {
    for (var i = 0, l = obj.length; i < l; i++) {
      if (i in obj && iterator.call(context, obj[i], i, obj) === breaker) return;
    }
  } else {
    for (var key in obj) {
      if (_.has(obj, key)) {
        if (iterator.call(context, obj[key], key, obj) === breaker) return;
      }
    }
  }
}; 
```

什么是参数*上下文*以及如何使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:52:22.787

设置传递的迭代器函数的`this`值*（调用上下文） 。*

```
iterator.call(context, obj[i], i, obj);
      //         ^---right here 
```

JavaScript`.call`和`.apply`方法允许您调用一个函数，并将`this`您正在调用的函数的值设置为您提供的第一个参数。

所以如果我...

```
var obj = {foo:"bar"};
func.call(obj); 
```

... `this`inside的值`func`将是`{foo:"bar"}`对象。

因此，如果您提供该参数，下划线将`.call`在调用您传递的函数时将其用作第一个参数，如上所示。

# android - FragmentPager 不更新视图

> ID：11836468
> 
> 赞同：3
> 
> 时间：2012-08-06T21:47:46.313
> 
> 标签：android, android-fragments

我尝试按照其他答案的建议进行操作，但是当我查看日志时，在使用 POSITION_NONE 返回 getItemPosition 后，不会为 getItem 调用位置 0，知道吗？我还尝试在返回 getItemPosition 时覆盖 destoryItem，它确实被调用但没有任何反应。

公共类 ProvidersActivityPagerAdapter 扩展 FragmentPagerAdapter {

```
private ArrayList<String> fragments;

public ProvidersActivityPagerAdapter(FragmentManager fm) {
  super(fm);
  fragments=new ArrayList<String>();
  if(provider.isInitialized()){
    fragments.add(BaseDetailsFragment.class.getName());
  }else{
    fragments.add(BaseAuthFragment.class.getName());
  }
  this.fm=fm;
}

@Override
public int getCount(){
  return fragments.size();
}

@Override 
public int getItemPosition(Object object) {
  AppUtils.logI("Get Item Position: "+POSITION_NONE+" "+object.getClass().getName());
  return POSITION_NONE;
}

@Override
public Fragment getItem(int position) {
  AppUtils.logI("Get Fragment for: "+position);
  String f=fragments.get(position);
  if(f.equals(BaseDetailsFragment.class.getName())){
    return provider.getDetailFragment();
  }
  if(f.equals(BaseAuthFragment.class.getName())){
    return provider.getAuthFragment();
  }
  if(f.equals(BaseSelectorFragment.class.getName())){
    return provider.getCurrentSelector();
  }
  return new Fragment();
}

private void addItem(int loc,String fa,String tag){
  this.fragments.add(loc,fa);
  AppUtils.logI(fragments.toString());
  notifyDataSetChanged(); //only creates the new fragment but not updating the old ones. 
  mViewPager.setCurrentItem(loc);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T22:39:05.920

FragmentPagerAdapter 的支持库版本似乎在销毁项目中没有任何作用。所以解决的办法是在构造页面适配器的时候保存fragment manager，重写destoryItem()函数。请注意，这可能与支持库的未来版本不兼容。

```
@Override
public void destroyItem(ViewGroup container,int position,Object object){
  super.destroyItem(container, position, object);
  FragmentTransaction bt = fm.beginTransaction();
  bt.remove((Fragment)object);
  bt.commit();
} 
```

# macos - OS X 上的 USB 设备枚举

> ID：11836469
> 
> 赞同：2
> 
> 时间：2012-08-06T21:47:55.443
> 
> 标签：macos, usb, driver, kernel-extension

我有一个用于连接 USB 单芯片设备 (CSR BC4) 的无代码 kext - 效果很好。如果我将多个设备连接到外部集线器，它仍然可以正常工作。

在我的 info.plist 的 IOKitPersonalities 字典中，对于设备和接口字典，我一直在 IOBluetoothFamily.kext 中的 CSR 驱动程序上匹配一个引用该 CSR kext 和该包中的 IOClass 的 CFBundleIdentifier。

快进到在内部集线器上使用多个 CSR BC7 芯片的新设备。长话短说，我无法让该设备正确匹配设备中的所有芯片。苹果驱动程序通常会抓取两个芯片。如果我插入两个设备，我会从一个设备中获取所有芯片，而从另一个设备中获取任何芯片。几天的挖掘随之而来。我一直在 Apple 列表中看到有关使用“com.apple.kernel.iokit”或“com.apple.kpi.iokit”的 CFBundleIdentifier 和“IOService”的 IOClass 的参考资料

我尝试了 com.apple.kernel.iokit，但我的两个设备都没有运气。由于我在 64 位平台上，我决定尝试 com.apple.kpi.iokit - 宾果游戏！两种设备都像魅力一样工作。

我的问题是我真正匹配的是什么？我可以理解将设备与现有驱动程序匹配，但在这种情况下我匹配的是什么？我无法从 Apple 那里找到任何能真正告诉我我在做什么的确切信息。

任何帮助表示赞赏！

初始人格示例：

```
MyCsrDevice  
  CFBundleIdentifier    com.apple.driver.CSRUSBBluetoothHCIController  
  IOClass               CSRUSBBluetoothHCIController  
  IOProviderClass       IOUSBDevice  
  idProduct             32  
  idVendor              vvvv  

MyCsrInterface  
  CFBundleIdentifier    com.apple.driver.CSRUSBBluetoothHCIController  
  IOClass               CSRUSBBluetoothHCIController  
  IOProviderClass       IOUSBInterface  
  idProduct             32  
  idVendor              vvvv 
  bInterfaceNumber      0  
  bConfigurationValue   1 
```

当前人格示例：

```
MyCsrDevice  
  CFBundleIdentifier    com.apple.kpi.iokit  
  IOClass               IOService  
  IOProviderClass       IOUSBDevice  
  idProduct             32  
  idVendor              vvvv 

MyCsrInterface  
  CFBundleIdentifier    com.apple.kpi.iokit  
  IOClass               IOService  
  IOProviderClass       IOUSBInterface  
  idProduct             32  
  idVendor              vvvv 
  bInterfaceNumber      0  
  bConfigurationValue   1 
```

# c - c中的字符串处理

> ID：11836475
> 
> 赞同：0
> 
> 时间：2012-08-06T21:48:12.777
> 
> 标签：c, string

这是我的代码

```
char* a[10];
a[0]="'example'";
char* p;
p=strstr(a[0],"'"); 
```

我知道 strstr 是否可以找到`'`它返回一个指向第一个字符的指针，即`'`. 我想取两者之间的值`'`并将其保存在`a[1]`. 我该怎么做？结果 `a[1]`是`"example"`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:57:16.047

[`strchr()`](http://en.cppreference.com/w/c/string/byte/strchr)似乎是一个更合适的选择`strstr()`。

使用 first `strchr()`, `+ 1`, 的结果作为后续`strchr()`and then`malloc()`和`strcpy()`or `sprintf()`into的参数`a[1]`：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main()
{
    char* a[10];
    char* p;

    a[0] = "'example'";

    p = strchr(a[0], '\'');
    if (p)
    {
        char* q = strchr(++p, '\'');
        if (q)
        {
            a[1] = malloc((q - p) + 1);
            if (a[1])
            {
                sprintf(a[1], "%.*s", q - p, p);
                printf("[%s]\n", a[1]);
            }
        }
    }
    return 0;
} 
```

将指向字符串文字和`malloc()`数据的指针存储到同一个数组中似乎是一件危险的事情。您必须`free()`动态分配内存，但*只能*动态分配内存。代码需要知道其中的哪些元素`a`指向动态分配的内存，并且必须是`free()`d，而那些不是。

初始化`a`所有`NULL`s，这样就知道填充了哪些元素：

```
char* a[10] = { NULL }; 
```

并且调用指针是安全`free()`的`NULL`（什么都不做）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:55:48.213

只需找到下一次出现`'`并复制子字符串：

```
char* a[10];
a[0]="'example'";
char* p, *q;
p=strstr(a[0],"'");
if (p) {
    q = strstr(p+1, "'");
    if (q) {
        size_t len = (size_t)(q - p);
        char *sub = malloc(len + 2);
        if (!sub) {
            /* Oops */
            exit(EXIT_FAILURE);  /* Something more sensible rather */
        }
        memcpy(sub, p, len+1);
        sub[len+1] = 0;
        a[1] = sub;
     }
     else {
         a[1] = NULL;
     }
}
else {
    a[1] = NULL;
} 
```

请注意，在这种情况下，最好使用`strchr`查找单个字符。

# ios - 在objective-c中旋转视图

> ID：11836476
> 
> 赞同：0
> 
> 时间：2012-08-06T21:48:24.163
> 
> 标签：ios, iphone-privateapi, tweak

我正试图让多任务切换器一直以横向模式打开......即使手机是纵向的......有什么想法吗？该类是“SBAppSwitcherController”，我正在调用方法“viewDidAppear”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T20:35:28.433

只需将 Supported Interface Orientations 设置为仅横向模式即可。为此，您可以在 Project Navigator 中转到您的项目。然后，您将看到 Supported Interface Orientations 标题。单击涉及纵向模式的深色图标以使其变亮。那么您的程序将仅处于横向模式。所以，如果我知道你在说什么，你就完了！

# ruby-on-rails-3 - 从视图中多次插入表中

> ID：11836482
> 
> 赞同：0
> 
> 时间：2012-08-06T21:49:03.343
> 
> 标签：ruby-on-rails-3

我有以下课程

```
class TableA < ActiveRecord::Base
       has_one :tableb
end
class TableB < < ActiveRecord::Base
       belongs_to :tableA
end 
```

我有一个 tableA/form.html.erb

```
<%= form_for(@@table) do |f| %>
    <%= f.text_field :tableAColumn %>
    <%= f.text_field :tableAColumn1 %>
    #how can i how this 
    <%= f.text_field :tableBColumn %>
    <%=f.text_field :tableBColumn1 %>
    <%= f.submit %>
<%end> 
```

这样当我点击保存时，记录都可以保存在表 A 和表 B 中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T03:48:09.000

我用了accepted_nested_attributes_for

[嵌套属性](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)

# java - 放注解和 Resteasy 最佳实践

> ID：11836483
> 
> 赞同：0
> 
> 时间：2012-08-06T21:49:10.007
> 
> 标签：java, http, rest, resteasy, put

在其他世界中使用@PUT 的最佳实践是什么。我有一个简单的方法

```
@PUT
@Path("/")
public boolean putShotComponentNote(String note) {
    System.out.println(note);
    return true;
} 
```

当我尝试使用 Chrome 的插件（如 Simple REST Client 或 REST Console）访问此方法时，我在其中指定 url 并在数据段中放置键值对

```
note=This is some note 
```

在我的方法中，我得到了键和值。理想情况下，我只想根据变量名称获取值，就像我在[http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Web_Platform/5/html-single/RESTEasy_Reference_Guide的一些示例中看到的那样/index.html](http://docs.redhat.com/docs/en-US/JBoss_Enterprise_Web_Platform/5/html-single/RESTEasy_Reference_Guide/index.html)

```
@PUT
@Path("array")
@Consumes("application/xml")
public void putCustomers(Customer[] customers)
{
  Assert.assertEquals("bill", customers[0].getName());
  Assert.assertEquals("monica", customers[1].getName());
} 
```

那么有人可以指出我正确的方向吗？

谢谢大家

这可能是困难的吗？

这是发送的请求

```
 Request Url:       
 http://localhost:8080/rest/
 Request Method: PUT
 Status Code: 415
 Params: {
     "note": "asd"
 } 
```

那么如何访问 notes 参数呢？@PathParam 不会工作，@QueryParam 也不会工作，只是普通的 String 不会（如上所述）让我 note=asd，我想避免这种情况。

这可能吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:09:45.710

这取决于您的参数是如何发送的。由于@QueryParam 未检测到您的数据，因此您的数据可能位于表单内。

试试@FormParam： [http ://docs.jboss.org/resteasy/docs/1.1.GA/userguide/html_single/index.html#_FormParam](http://docs.jboss.org/resteasy/docs/1.1.GA/userguide/html_single/index.html#_FormParam)

我最近在通过 JQuery 的 ajax 函数发送 PUT 请求时遇到了这个问题。以下是调用 REST 服务的方法：

```
$.ajax({
    type:"PUT",
    url:"/rest/",
    data:{  "var1": "val1",
            "var2" : "val2"}
}); 
```

如果您只是想获取参数的字符串值，RESTEasy 可以通过 java.util.list 对象轻松获取它们。我以 URL 编码为例，但这也可以应用于其他人：

```
@PUT
@Consumes("application/x-www-form-urlencoded")
public void Method1(@FormParam("var1") List<String> list1,
                    @FormParam("var2") List<String> list2){
    String v1 = list1.get(0);
    String v2 = list1.get(0);

    System.out.println(v1);
    System.out.println(v2);
} 
```

输出：

```
val1
val2 
```

# c++ - 如何覆盖 std::filebuf？

> ID：11836485
> 
> 赞同：2
> 
> 时间：2012-08-06T21:49:19.073
> 
> 标签：c++, iostream, fstream

我有一个使用 STLPort 5.2.1 的 Visual Studio 2008 C++ 03 应用程序，我想在其中使用自定义`std::filebuf`实现。例如：

```
class MyFileBuf : public std::filebuf
{
protected:
    virtual int_type sync()
    {
        // breakpoint here never fires
        return std::filebuf::sync();
    };

    virtual std::streamsize xsputn( const char_type* p, std::streamsize n )
    {
        // breakpoint here never fires
        return std::filebuf::xsputn( p, n );
    };

    virtual int_type overflow( int_type c = traits_type::eof() )
    {
        // breakpoint here never fires
        return std::filebuf::overflow( c );
    };
};

class MyFileStream : public std::ofstream
{
public:
    MyFileStream() : std::ofstream( new MyFileBuf() ) { clear(); };
    ~MyFileStream() { delete rdbuf(); };
};

int main()
{
    MyFileStream fs;
    fs.open( "test.txt" );
    fs << "this is a test" << std::endl;
    return 0;
} 
```

不幸的是，没有一个 MyFileBuf 的成员被调用过。如果我单步执行代码，我会看到`<<`操作员转到

```
stlpd_std::basic_streambuf<char,stlpd_std::char_traits<char> >::xsputn(const char* __s, long int __n)
stlpd_std::basic_streambuf<char,stlpd_std::char_traits<char> >::sputn(const char* __s, long int __n)
stlpd_std::basic_ostream<char,stlpd_std::char_traits<char> >::_M_put_nowiden(const char* __s)
stlpd_std::operator<<<stlpd_std::char_traits<char> >(stlpd_std::basic_ostream<char,stlpd_std::char_traits<char> >& , const char* __s )
main() 
```

我希望调用堆栈的顶部是：

```
MyFileBuf::xsputn(const char* p, long int n) 
```

但是，这些文件是正确写入的。谁能帮我理解我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T14:57:32.130

感谢@jahhaj 和@DanielKO 的帮助。

解决方案似乎是这样的：

```
#include <iostream>
#include <fstream>
using namespace std;

class MyFileBuf : public std::filebuf
{
protected:
    virtual int_type sync()
    {
        return std::filebuf::sync();
    };

    virtual std::streamsize xsputn( const char_type* p, std::streamsize n )
    {
        return std::filebuf::xsputn( p, n );
    };

    virtual int_type overflow( int_type c = traits_type::eof() )
    {
        return std::filebuf::overflow( c );
    };
};

class MyFileStream : public std::ostream
{
public:
    MyFileStream() : std::ostream( 0 ) { init( &buf_ ); };
    MyFileStream( const char* filename, std::ios_base::openmode mode = std::ios_base::out )
        : std::ostream( 0 )
    {
        init( &buf_ );
        this->open( filename, mode );
    }

    bool is_open() const { return buf_.is_open(); };

    void close() { buf_.close(); };

    void open( const char* filename, std::ios_base::openmode mode = std::ios_base::out )
    {
        buf_.open( filename, mode );
    };

    std::filebuf* rdbuf() { return &buf_; };

private:
    MyFileBuf buf_;
};

int main()
{
    MyFileStream fs( "test.txt" );
    fs << "this is a test" << std::endl;
    return 0;
} 
```

[例子](http://ideone.com/FwmuP#)

# objective-c - 如何以编程方式嵌入笔尖？

> ID：11836489
> 
> 赞同：2
> 
> 时间：2012-08-06T21:49:48.867
> 
> 标签：objective-c, ios5, uiview, embedded, customization

我有一个 UIViewController，里面有一个 UIScrollView。

然后我创建了一个新的 UIView 子类，其中包含一些我想以编程方式添加到此 UIScrollView 中的属性，直到我的数据结束。

应该看起来像这张照片的东西： ![嵌入uiview](../Images/dedb587c99ca778532501ff5e6c0cd96.png)

我已经阅读了通过创建视图并将其类设置为自定义视图子类来做到这一点的其他主题，但我想以编程方式完成它并且它不起作用。

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T22:01:45.260

从您的图像看来，您正在寻找从 nib 加载视图并将它们添加为 UIScrollView 的子视图。为此，请查看[UINib 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINib_Ref/Reference/Reference.html)。

你想创建你的 nib 并将它的主视图设置为你的 UIView 子类的一个实例，然后将 nib 加载到`viewDidLoad`你的 viewController 中，并将 nib 的视图添加为你的滚动视图的子视图（我假设它是你的 viewController 的子视图看法）。

您可以使用`instantiateWithOwner:options:`.

> 此方法取消归档每个对象，对其进行初始化，将其属性设置为其配置值，并重新建立与其他对象的任何连接

要从 nib 获取视图数组，您可以执行以下操作：

```
UINib *myNib = [UINib nibWithNibName:@"myNib" bundle:[NSBundle mainBundle]];
NSArray *viewsFromNib = [myNib instantiateWithOwner:nil options:nil]; 
```

我假设我们在 UIViewController 中，并且我们在（或之后）的某个地方`viewDidLoad`。然后，您将使用上面的数组并将视图添加为滚动视图的子视图。您可能需要设置这些视图的框架以正确放置它们，但这应该是微不足道的。

```
UIView *aView = [viewsFromNib objectAtIndex:0];
[self.scrollView addSubview:aView]; 
```

我希望这能让你朝着正确的方向前进。

**编辑：**

如果您想了解更多信息，您可能需要更深入地了解 nib 如何管理您的期望。与 UINib 文档链接的是“资源编程指南”，特别是[nib 部分](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html#//apple_ref/doc/uid/10000051i-CH4-SW8)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:57:24.050

安德烈，这可以相对容易地完成。确保导入要嵌入的类。然后用你的正常创建它们

```
ClassName *subview=[[ClassName alloc]init]; 
[subview.view setFrame:CGRectMake(x,y,width,height)]; 
[self.view addSubview:subview.view]; 
```

这会将其添加到您指定的 x,y 坐标中，其大小由您的宽度、高度指定。您可以在 viewDidLoad 中或在需要创建它们时执行此操作。

# php - PHP 强制文件下载

> ID：11836492
> 
> 赞同：2
> 
> 时间：2012-08-06T21:50:01.337
> 
> 标签：php, download

我正在尝试使用 PHP 在客户端计算机上强制下载（带有文件对话框 - 没什么险恶的）。我发现很多页面都建议我使用 header() 函数来控制我的 PHP 脚本的响应，但我没有运气。我的代码如下：

```
$file = $_POST['fname'];

if(!($baseDir . '\\AgcommandPortal\\agcommand\\php\\utils\\ISOxml\\' . $file)) {
    die('File not found.');
} else {
    header('Pragma: public');
    header('Content-disposition: attachment; filename="tasks.zip"');
    header('Content-type: application/force-download');
    header('Content-Length: ' . filesize($file));
    header('Content-Description: File Transfer');
    header('Content-Transfer-Encoding: binary');
    header('Connection: close');
    ob_end_clean();
    readfile($baseDir . '\\AgcommandPortal\\agcommand\\php\\utils\\ISOxml\\' . $file);
} 
```

我使用这个 JavaScript 调用它：

```
 $.ajax({
            url: url,
            success: function(text) {
                var req = new XMLHttpRequest();
                req.open("POST", 'php/utils/getXMLfile.php', true);
                req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                req.send('fname=' + encodeURIComponent(text));
            }
        }); 
```

这会将文件的内容作为文本返回，但不会触发下载对话框。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:51:34.830

无需使用 AJAX，只需将浏览器重定向到相关 URL。当它收到`content-disposition:attachment`标头时，它将下载文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:53:20.163

几点建议：

1.

```
if(!($baseDir . '\\AgcommandPortal\\agcommand\\php\\utils\\ISOxml\\' . $file)) { 
```

反而：

```
if(!file_exists($baseDir ....)){ 
```

2.不需要尺寸。

3.试试这个：

```
 header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment; filename='.basename($fullpath));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Pragma: public');
    ob_clean();
    flush();
    readfile($fullpath);
    exit; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:53:59.680

我会尝试像这样从 PHP 发送标头来替换您的`application/force-download`标头：

```
header("Content-type: application/octet-stream"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T14:08:02.683

Kolink 的回答对我有用（将窗口位置更改为 php 文件），但由于我想随请求一起发送 POST 变量，我最终改用隐藏表单。我正在使用的代码如下：

```
 var url = 'php/utils/getXMLfile.php';
                var form = $('<form action="' + url + '" method="post" style="display: none;">' +
                    '<input type="text" name="fname" value="' + text + '" />' +
                    '</form>');
                $('body').append(form);
                $(form).submit(); 
```

感谢所有的答案！

# javascript - 正则表达式不会按预期匹配单词

> ID：11836493
> 
> 赞同：2
> 
> 时间：2012-08-06T21:50:09.323
> 
> 标签：javascript, regex, xregexp

我正在尝试根据这些标准使用[XRegExp](http://xregexp.com/)来测试字符串是否是有效单词：

*   字符串以一个或多个 Unicode 字母开头，后跟
*   撇号 ( `'`) 后跟一个或多个 Unicode 字母，重复 0 次或多次。
*   字符串在匹配的模式之后立即结束。

也就是说，它将匹配这些术语

> 你好不能 Alah'u'u'v'oo O'reilly

但不是这些

> 吃完为止

我正在尝试这种模式，

```
^(\\p{L})+('(\\p{L})+)*$ 
```

但它不会匹配任何包含撇号的单词。我究竟做错了什么？

编辑：使用正则表达式的代码

```
var separateWords = function(text) {
    var word = XRegExp("(\\p{L})+('(\\p{L})+)*$");
    var splits = [];
    for (var i = 0; i < text.length; i++) {
        var item = text[i];
        while (i + 1 < text.length && word.test(item + text[i + 1])) {
            item += text[i + 1];
            i++;
        }
        splits.push(item);
    }
    return splits;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:59:21.287

我认为您需要省略[字符串开始/结束锚点](http://www.regular-expressions.info/anchors.html)以匹配单个单词：

```
"(\\p{L})+('(\\p{L})+)*" 
```

另外我不确定这些捕获组需要什么（这可能取决于您的应用程序），但您可以将它们缩短为

```
"\\p{L}+('\\p{L}+)*" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:54:58.977

试试这个正则表达式：

```
^[^'](?:[\w']*[^'])?$ 
```

首先，它检查以确保第一个字符不是撇号。然后它要么得到任意数量的单词字符或撇号，后跟撇号以外的任何东西，要么什么都没有（一个字母的单词）。

# ruby-on-rails-3 - 急切加载范围内的轨道对象集

> ID：11836496
> 
> 赞同：3
> 
> 时间：2012-08-06T21:50:22.907
> 
> 标签：ruby-on-rails-3

我有一个与此类似的问题，只是使用了较新版本的 rails：

[Ruby on Rails - 在 ':include =>' 上添加条件以加载有限数量的对象](https://stackoverflow.com/questions/4454204/ruby-on-rails-add-condition-on-include-to-load-limited-number-of-objects)

我想急切加载一个关联，但要限定急切加载中包含的内容。这在rails 3.2中可能吗？我试过了

```
Foo.includes(:bar).where("bars.col = x") 
```

但这仅限于只有`Foo`至少有一个`Bar`where的 's `col = x`，而我也想要那些`Foo`没有`Bar`'s 的 's。我可以创建另一个关联，但随后我失去了发送参数的能力（似乎 :conditions 不能处理带参数的 lambda）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T21:32:59.093

尝试在下一个范围内包含所需的 Foo

```
Foo.includes(:bar).where("bars.col = x OR bars.id IS NULL") 
```

或者

```
Foo.includes(:bar).where("bars.col = x AND bars.id IS NULL") 
```

取决于你的需要

所以你可以动态地做，比如

```
#Foo class
def self.including_bars_equal_to(x) # or scope :including_bars_equal_to, :lambda{|x| ....}
   self.includes(:bar).where("bars.col = ? AND bars.id IS NULL", x)  
end 
```

**Attempt2** 也许你应该尝试自定义加入和包含

```
Foo.joins("LEFT OUTER JOIN bars ON foos.id = bars.foo_id AND bars.col = 'x'").
includes(:bar) 
```

或者您可以将连接与选择选择相结合

```
 Foo.joins("LEFT OUTER JOIN bars ON foos.id = bars.foo_id AND bars.col = 'x'").
  select("foos.*, bar.id as bar_id, bar.col as bar_col") 
```

# jquery - 对类使用 jQuery 选择器和另一个属性

> ID：11836498
> 
> 赞同：3
> 
> 时间：2012-08-06T21:50:36.327
> 
> 标签：jquery, selector

我想要做的是向具有特定 url 的特定元素添加一个类。但我似乎无法让它工作。

这就是我所拥有的。

```
var pageName = window.location.pathname
    pageName = pageName.replace("/", "");

$("div.mainleftmenu a.rtsLink.rtsRoot[href=pageName]").addclass("rtsSelected"); 
```

如果它有帮助 a.rtsLink.rtsRoot 是进入层次结构的几个步骤。我是 jQuery 的新手。

## 更新

感谢您的快速回复，但我仍然收到错误消息。

> TypeError: Object [object Object] 没有方法 'addclass' [ [http://XXXXXXX/training-events:69]](http://XXXXXXX/training-events:69])

这是我试图遍历的标记示例。（这是自动生成的，所以修改 html 不是一种选择。）

```
<div class="mainleftmenu">                       
    <div id="mainleftmenu_T76A8AA8B013">
        <div id="ctl00_mainleftmenu_T76A8AA8B013_ctl00_ctl00_siteMapControl_verticalsimple"
        class="RadTabStripVertical RadTabStrip_mainleftmenu RadTabStripLeft_mainleftmenu">
            <div class="rtsLevel rtsLevel1">
                <ul class="rtsUL">
                    <li class="rtsLI rtsFirst">
                        <a class="rtsLink rtsRoot" href="products">
                            <span class="rtsOut">
                                <span class="rtsIn">
                                    <span class="rtsTxt">Products</span>
                                </span>
                            </span>
                        </a>
                    </li>
                    <li class="rtsLI">
                        <a class="rtsLink" href="products/heavybid">
                            <span class="rtsOut">
                                 <span class="rtsIn">
                                    <span class="rtsTxt">HeavyBid</span>
                                </span>
                             </span>
                         </a>
                   </li>
                </ul>
             </div>
         </div>
    </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:54:07.603

您应该将变量传递给选择器，目前您正在传递一个字符串：

```
$("div.mainleftmenu a.rtsLink.rtsRoot[href='"+pageName+"']").addClass("rtsSelected"); 
```

另请注意，您已经写`addclass`了应该是`addClass`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:52:54.737

这应该使您不使用 string `pageName`，但使用 的值`pageName`：

```
$("div.mainleftmenu a.rtsLink.rtsRoot[href='"+pageName+"']")
                                               .addClass("rtsSelected"); 
```

# c# - 如果使用一系列高值而不是低值计算浮点数是否具有更高的精度？

> ID：11836506
> 
> 赞同：1
> 
> 时间：2012-08-06T21:51:31.137
> 
> 标签：c#, floating-accuracy

与较低范围相比，较高范围的浮点数乘/除/加/减会更准确吗？

例如，会`567.56 / 345.54`比`.00097854 / .00021297`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T22:04:04.920

你的问题的答案是“不”。浮点数（通常*）用归一化尾数和指数表示。乘法和除法首先对归一化尾数进行运算，然后对指数进行运算。

当然，加法和减法是另一回事。像你的例子这样的操作：

```
 567.56 + 345.54 or .00097854 - .00021297 
```

工作正常。但是具有不同数量级的操作，例如

```
 567.56 + .00097854    or  345.54  - .00021297 
```

可能会损失一些低阶精度。

*   IEEE 浮点标准包括非规格化数字。如果您是天体物理学家或运行时库开发人员，您可能需要了解它们。见[http://en.wikipedia.org/wiki/Denormal_number](http://en.wikipedia.org/wiki/Denormal_number)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T16:54:55.990

对于 IEEE 754 二进制浮点数（最常见），浮点值在大部分指数范围内的有效位中具有相同的位数。然而，有一部分范围的有效数字实际上具有更少的位。舍入引起的相对误差确实会根据有效数字在其范围内的位置而有所不同。

IEEE 754 浮点数由符号（+1 或 -1，编码为 0 或 1）、指数（对于双精度，-1022 到 1023，编码为指数加 1023，因此为 1 到 2046）表示, 和一个有效数（对于双精度，小数通常从 1 到略低于 2，用 53 位表示，但用 52 位编码，因为第一位隐式为 1）。

例如，数字 6.5 用位 0（符号 +1）、10000000001（指数 2）和 10100000000000000000000000000000000000000000000000000（二进制小数 1.1010，十六进制 1.a，十进制 1.3125）进行编码。我们可以用十六进制浮点数将其写为 0x1.ap2（十六进制小数 1.a 乘以 2 的十进制 2 次方）。以十六进制浮点形式编写使人们能够相当容易地看到浮点表示。

对于指数，0 和 2047 的编码值是特殊的。编码为 0 时，指数与编码为 1 时相同（-1022），但分数的隐含位为 0 而不是 1。编码为 2047 时，浮点对象表示无穷大（如果有效位全为零）或 NaN（否则）。

当编码指数为 0 且有效位全为零时，该数字表示零（+0 和 -0 以符号区分）。如果有效位不全为零，则称该数字是非规范化的。这是因为大多数数字都是通过调整指数来“归一化”的，因此分数在 1（包括）和 2（不包括）之间。对于非规格化数，分数小于 1；它以“0”开头。而不是“1.”。

当浮点运算的结果是非规格化数字时，有效数字中的有效位数更少。因此，随着数字下降到 0x1p-1022 (2 ^(-1022) ) 以下，有效精度会降低。

当数字在正常范围内（不下溢到非正规并且不上溢到无穷大）时，具有不同指数的数字的有效数字没有差异，因此：

*   (2a+2b)/2 的结果与 a+b 完全相同。
*   (2a-2b)/2 的结果与 ab 完全相同。
*   (2ab)/2 的结果与 ab 完全相同。

但是请注意，相对误差可能会发生变化。执行浮点运算时，必须将精确的数学结果四舍五入为可表示的值。这种舍入只能以有效数字表示的单位发生。对于给定的指数，有效数字中的位具有固定值。所以有效数字的最后一位代表一个特定的值。该值在 1 附近的有效数字的部分比在 2 附近的有效数字的更大。

对于双精度结果，最小精度单位 (ULP) 是有效数字中最高位值的2 ^(52分之一。)当使用四舍五入模式（最常见的默认值）时，最大误差最多是该值的一半，因为如果一个方向上的可表示数字超过 ULP 的一半，那么另一个方向上的数字会更小距离 ULP 不到一半。更接近的数字由适当的浮点运算返回。

因此，有效数字接近 1 的结果中的最大相对误差略高于 2 ^(-53)，但有效数字接近 2 的结果中的最大相对误差略低于 2 ^(-54)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T13:49:31.483

为了完整起见，我不得不有点不同意并说**Yes**，它可能以某种方式很重要...
确实，如果您执行 56756.0 / 34554.0，那么您将获得最接近精确数学结果的可表示浮点数，只需一个浮点舍入“错误”。
这是因为 56756.0 和 34554.0 可以精确地表示为浮点数（单精度或双精度 IEEE 754），并且因为根据 IEEE 754 标准，操作执行精确的舍入操作（在默认模式下到最接近的值）。

如果您写 567.56 / 345.54，那么这两个数字都不会以基数 2 的浮点数精确表示，因此此操作的结果是累积 3 个浮点舍入“错误”。

让我们比较 Squeak Smalltalk 中双精度（浮点数）的结果，转换为精确算术（分子和分母处具有任意整数长度的分数）：

```
((56756.0 / 34554.0) asFraction - (56756 / 34554)) asFloat.
-> -7.932275867322412e-17 
```

到目前为止，一切都很好，误差的幅度小于或等于半个 ulp，正如 IEEE 754 所承诺的那样：

```
(56756 / 34554) asFloat ulp / 2
-> 1.1102230246251565e-16 
```

对于累积的舍入误差，您可能会得到更大的误差（但绝不会更小）：

```
((567.56 / 345.54) asFraction - (56756 / 34554)) asFloat
-> -3.0136736359825544e-16

((0.00056756 / 0.00034554) asFraction - (56756 / 34554)) asFloat
-> 3.647664511768385e-16 
```

上面的例子很难概括，我完全同意其他答案：一般来说，**不**，你应该只关心相对精度。
...除非您想实现一些对舍入误差具有非常严格容忍度的功能...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:57:18.560

不。从某种意义上说，无论您的数字的数量级（指数部分）是多少，都有相同数量的有效数字可用。

# eclipse - Github 问题作为 Mylyn 中的任务（推送任务有效，拉取问题（任务）无效）

> ID：11836509
> 
> 赞同：2
> 
> 时间：2012-08-06T21:51:59.887
> 
> 标签：eclipse, github, task, issue-tracking, mylyn

所以我最近开始在我的公司使用 Mylyn，我个人很喜欢它，并且与 Jira 配合得很好。但是现在我正试图让它在 Github 上为我与其他几个人一起工作的个人项目工作。

我将 Eclipse Juno 与 Github 连接器一起使用并添加了存储库信息。当我去创建一个任务时，它会正确地执行并提取我正确配置的标签，所以我知道它在两个方面都有很好的连接性。当我在 Mylyn 中保存任务时，它会很好地显示在 Github 上。

问题是，我需要访问其他人在 Github 上创建的问题，但是当我在 Mylyn 中创建一个查询并将其命名时（说“所有错误”），然后选择错误标签并点击完成，它会在任务视图中显示查询，但是它是空的，并且永远不会从 Github 检索问题列表。我知道他们在那里，只是没有在 Mylyn 中显示它们，而且 Mylyn 没有抛出任何错误。

我还尝试了包含上述所有内容的查询和带有我名字的“提及”字段（以防空白字段与查询混淆），但这也不起作用。

需要注意的一点是，我在私人回购中使用它，但是在进行搜索（并作为我可以获取标签和推送问题的证据）我不认为私人与公共回购在这里是一个问题。

真希望有人能伸出援手。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-09T23:33:15.377

@TheKojuEffect 在这里为我回答了这个问题：

[为什么 Mylyn 没有从 GitHub 收到问题？](https://stackoverflow.com/questions/16328660/why-mylyn-is-not-getting-issues-from-github)

基本上，如果您在 Eclipse 中的查询中选择多个标签，则查询只会提取所有这些标签的问题（逻辑与，而不是我期望的 OR）。为您希望查看的每个问题标签创建一个查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T17:46:23.920

解决此问题的最佳方法是针对 Mylyn 的 Github 连接器打开错误报告。

# android - 集成android和instagram

> ID：11836515
> 
> 赞同：2
> 
> 时间：2012-08-06T21:52:14.020
> 
> 标签：android, instagram

我需要在 Instagram 中捕获整个关注者列表并为我的应用导入。这个有可能 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:56:56.140

通过[instagram api](http://instagram.com/developer/api-console/)，它允许通过`https://api.instagram.com/v1/users/{user-id}/followed-by`. 请注意，在此方法返回任何数据之前需要进行身份验证。

从那里，你应该得到一个包含所有关注者的 JSON 响应，你可以在你的应用程序中随意处理。

# git - 如何从客户端的服务器每 10 分钟设置一次自动 git push？

> ID：11836520
> 
> 赞同：0
> 
> 时间：2012-08-06T21:52:40.713
> 
> 标签：git, ssh, crontab

我即将与客户完成一个项目。我正在使用 github 存储所有文件。在我离开项目后，他自然会通过 CMS 进行更新、上传新图像等。

恐怕从现在起六个月或一年后，如果出现问题，我们将处于不利境地，因为在没有任何 git 提交的情况下，这将是一整年左右的更改（再次，这是一个客户。我不指望他SSH 进入并运行 git 命令。）我正在尝试设置一个每小时运行一次的 crontab 作业，它将添加所有内容、提交并将其推送到 github。我遇到的问题是它询问我的用户名和密码并且失败了。如何设置它以便我的客户端服务器可以将更改推送到 github 存储库而不必危及我的安全性？

这是我到目前为止所拥有的。

```
0 * * * * cd ~/clientswebsite.com/; git add -u; git commit -m "Cron job"; git push --verbose > log.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:00:22.833

您有几个选择，但本质上，您必须开始使用 SSH 密钥身份验证而不是用户名/密码身份验证。

选项取决于您希望使用密钥识别的确切内容。对于您的情况，我会说它是部署密钥（绑定到机器）或机器用户（绑定到特定用户帐户，可能跨机器）。

有关详细信息，请参阅此 GitHub 文章： [https ://help.github.com/articles/managing-deploy-keys](https://help.github.com/articles/managing-deploy-keys)

# c - 在C中查找字符串中子字符串的位置

> ID：11836524
> 
> 赞同：9
> 
> 时间：2012-08-06T21:53:05.987
> 
> 标签：c, string, substring, strstr

这是一个接受的程序：

1.  来自用户的一句话。
2.  用户的话。

如何找到输入的单词在句子中的位置？

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int main()
{
    char sntnc[50], word[50], *ptr[50];
    int pos;
    puts("\nEnter a sentence");
    gets(sntnc);
    fflush(stdin);
    puts("\nEnter a word");
    gets(word);
    fflush(stdin);
    ptr=strstr(sntnc,word);

    //how do I find out at what position the word occurs in the sentence?

    //Following is the required output
    printf("The word starts at position #%d", pos);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-06T22:00:39.570

指针将`ptr`指向 的开头`word`，因此您可以从中减去句子指针 的位置`sntnc`：

```
pos = ptr - sntnc; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T14:36:55.323

仅供参考：

```
char saux[] = "this is a string, try to search_this here";
int dlenstr = strlen(saux);
if (dlenstr > 0)
{
    char *pfound = strstr(saux, "search_this"); //pointer to the first character found 's' in the string saux
    if (pfound != NULL)
    {
        int dposfound = int (pfound - saux); //saux is already pointing to the first string character 't'.
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T22:03:00.940

strstr() 的返回是指向您的“单词”第一次出现的指针，所以

```
pos=ptr-sntc; 
```

这仅适用于 sntc 和 ptr 是指向同一字符串的指针。为了澄清当我说发生时，它是在目标字符串中找到匹配字符串时第一个匹配字符的位置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-07T14:46:30.823

您可以使用这个简单的 strpos 修改

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int strpos(char *haystack, char *needle, int offset);
int main()
{
    char *p = "Hello there all y'al, hope that you are all well";
    int pos = strpos(p, "all", 0);
    printf("First all at : %d\n", pos);
    pos = strpos(p, "all", 10);
    printf("Second all at : %d\n", pos);
}

int strpos(char *hay, char *needle, int offset)
{
   char haystack[strlen(hay)];
   strncpy(haystack, hay+offset, strlen(hay)-offset);
   char *p = strstr(haystack, needle);
   if (p)
      return p - haystack+offset;
   return -1;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-24T04:55:38.797

由于某些原因，我在使用 strstr() 时遇到了问题，而且我还想要 index.html。

我制作了这个函数来查找更大字符串（如果存在）中子字符串的位置，否则返回-1。

```
 int isSubstring(char * haystack, char * needle) {
     int i = 0;
     int d = 0;
     if (strlen(haystack) >= strlen(needle)) {
         for (i = strlen(haystack) - strlen(needle); i >= 0; i--) {
             int found = 1; //assume we found (wanted to use boolean)
             for (d = 0; d < strlen(needle); d++) {
                 if (haystack[i + d] != needle[d]) {
                     found = 0; 
                     break;
                 }
             }
             if (found == 1) {
                 return i;
             }
         }
         return -1;
     } else {
         //fprintf(stdout, "haystack smaller\n"); 
     }
 } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-26T09:30:58.990

我对该线程中原始帖子的评论：此声明不正确：

```
 char sntnc[50], word[50], *ptr[50]; 
```

C 代码甚至无法编译：它将在这一行失败：

```
 ptr = strstr(sntnc,word); 
```

所以该行应更改为：

```
 char sntnc[50], word[50], *ptr; 
```

而且你不需要分配给'ptr string'的内存。你只需要一个指向 char 的指针。

# c# - 带有下载音频进度的滑块

> ID：11836525
> 
> 赞同：0
> 
> 时间：2012-08-06T21:53:08.420
> 
> 标签：c#, windows-phone-7, xaml, slider, dependency-properties

我正在开发一个带有进度矩形的滑块[见图]。此代码不适用于动态设置宽度

```
public class AudioSlider : Slider, INotifyPropertyChanged {
    public AudioSlider() {
      DefaultStyleKey = typeof(AudioSlider);
    }
    #region PropertyChanged
    public event PropertyChangedEventHandler PropertyChanged;
    protected void OnPropertyChanged(string name) {
      PropertyChangedEventHandler handler = PropertyChanged;
      if (handler != null)
        handler(this, new PropertyChangedEventArgs(name));
    }

    #endregion
    private double _trwidth;
    public double TrackProgressWidth {
      get { return _trwidth; }
      set {
        _trwidth = value; OnPropertyChanged("TrackProgressWidth");
      }
    }

... 
```

xml。默认样式...

```
<Rectangle x:Name="HorizontalFillLoaded" Height="12" MaxWidth="{Binding TrackProgressWidthMax,ElementName=audio}" Width="{Binding TrackProgressWidth,ElementName=audio}" IsHitTestVisible="False" Grid.Column="1" Fill="Black" Margin="0,0,0,28" /> 
```

…… ![在此处输入图像描述](../Images/38f7a1e71261cf446503abe5fe59c70e.png)

我需要改变“Horizo​​ntalFillLoaded”的宽度，比如

```
var t=new AudioSlider();
t.SetDownloadedProgress(50);//50% 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T06:47:41.743

假设 XAML 是默认样式的模板的一部分：

使用`TemplateBinding`代替`Binding`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T11:09:18.893

```
 Rectangle TrackLoaded;
    public override void OnApplyTemplate() {
      base.OnApplyTemplate();
      Rectangle txtBoxValue = base.GetTemplateChild("HorizontalFillLoaded") as Rectangle;

      Binding valueBinding = new Binding("TrackProgressWidth");
      valueBinding.Mode = BindingMode.TwoWay;
      valueBinding.Source = this; txtBoxValue.SetBinding(Rectangle.WidthProperty,
       valueBinding);
    } 
```

# php - 如何根据复选框的值在表中存储多个权限？

> ID：11836533
> 
> 赞同：0
> 
> 时间：2012-08-06T21:54:09.667
> 
> 标签：php, checkbox

我正在构建一个简单的系统来允许/禁止特定区域的权限，但我想知道将复选框的值从`jquery.ajax()`PHP 函数中发送到处理并插入表中的最佳方法是什么：

不存在问题，只是我想知道一种方法来插入表格中每个区域的每个复选框的值，`table_perfiles_permisos`而无需为每个复选框创建变量并插入！一些动态的使用 foreach 什么的。

![复选框权限](../Images/b52e581a02813bb8b14944f205fb2da4.png)

**HTML**

```
 <form> 
    <div id="permisosPerfiles">
        <div id="leftPermisos">
        <p>
        <h4>Usuarios</h4>
        <label for="pCrearUsuario">Crear</label>
        <input id="pCrearUsuario" name="permUsuarios[]" value="CrearU" type="checkbox" />
        <label for="pBuscarUsuario">Buscar</label>
        <input id="pBuscarUsuario" name="permUsuarios[]" value="BuscarU" type="checkbox"/>
        <label for="pModificarUsuario">Modificar</label>
        <input id="pModificarUsuario" name="permUsuarios[]" value="ModificarU" type="checkbox"/>
        <label for="pEliminarUsuario">Eliminar</label>
        <input id="pEliminarUsuario" name="permUsuarios[]" value="EliminarU" type="checkbox"/>
        </p>

        <p>
        <h4>Clientes</h4>
        <label for="pCrearCliente">Crear</label>
        <input id="pCrearCliente" name="permClientes[]" value="CrearC" type="checkbox"/>
        <label for="pBuscarCliente">Buscar</label>
        <input id="pBuscarCliente" name="permClientes[]" value="BuscarC" type="checkbox"/>
        <label for="pModificarCliente">Modificar</label>
        <input id="pModificarCliente" name="permClientes[]" value="ModificarC" type="checkbox"/>
        <label for="pEliminarCliente">Eliminar</label>
        <input id="pEliminarCliente" name="permClientes[]" value="EliminarC" type="checkbox"/>
        </p>
        <p>
        <h4>Marca, Producto Subproducto</h4>
        <label for="pCrearMPS">Crear</label>
        <input id="pCrearMPS" name="permMPS[]" value="CrearMPS" type="checkbox"/>
        <label for="pBuscarMPS">Buscar</label>
        <input id="pBuscarMPS" name="permMPS[]" value="BuscarMPS" type="checkbox"/>
        <label for="pModificarMPS">Modificar</label>
        <input id="pModificarMPS" name="permMPS[]" value="ModificarMPS" type="checkbox"/>
        <label for="pEliminarMPS">Eliminar</label>
        <input id="pEliminarMPS" name="permMPS[]" value="EliminarMPS" type="checkbox"/>
        </p>
        </div>

        <div id="rightPermisos">
        <p>
        <h4>Póliza</h4>
        <label for="pCrearPoliza">Crear</label>
        <input id="pCrearPoliza" name="permPoliza[]" value="CrearP" type="checkbox"/>
        <label for="pBuscarPoliza">Buscar</label>
        <input id="pBuscarPoliza" name="permPoliza[]" value="BuscarP" type="checkbox"/>
        <label for="pModificarPoliza">Modificar</label>
        <input id="pModificarPoliza" name="permPoliza[]" value="ModificarP" type="checkbox"/>
        <label for="pEliminarPoliza">Eliminar</label>
        <input id="pEliminarPoliza" name="permPoliza[]" value="EliminarP" type="checkbox"/>
        </p>
        <p>
        <h4>Servicio</h4>
        <label for="pCrearServicio">Crear</label>
        <input id="pCrearServicio" name="permServicio[]" value="CrearS" type="checkbox"/>
        <label for="pBuscarServicio">Buscar</label>
        <input id="pBuscarServicio" name="permServicio[]" value="BuscarS" type="checkbox"/>
        <label for="pModificarServicio">Modificar</label>
        <input id="pModificarServicio" name="permServicio[]" value="ModificarS" type="checkbox"/>
        <label for="pEliminarServicio">Eliminar</label>
        <input id="pEliminarServicio" name="permServicio[]" value="EliminarS" type="checkbox"/>
        </p>
        </div>
    </div>
</form> 
```

**jQuery**序列化表单

formchecks = $(form).serialize();

```
$.ajax({
    type : "POST",
        url: "process.php",
        data: formchecks,
        success: function(response) {

             if (response == "success") {
                 //actions if success    
             } else {
                //actions if doesn't success   
             }
        }
}); 
```

**存储的数据也应该如此**

```
table_perfiles
*id   *nombre   *descripcion
1      NameOne    DescOne
2      NameTwo    DescTwo

table_perfiles_permisos
*id_perfil *area_permiso *buscar *crear *eliminar *modificar 
    1            1          0      1         1        1
    1            2          0      0         1        0
    2            1          1      1         1        1

table_areas_permisos
*id *nombre
1    usuarios
2    clientes
3    mps
4    poliza
5    servicio 
```

例如，如果复选框被选中，将存储 1 否则将为每个区域中的每个复选框存储 0

我希望我已经解释得够多了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:29:33.910

您可以将其设为二进制数并将整个权限集存储为整数，而不是将每种权限类型存储在单独的数据库列中。这样您就可以随时添加新的权限类型，而无需修改您的数据库。

例如，如果您按如下方式定义权限类型常量：

```
define('PERMISSION_CREATE', bindec('0001'));
define('PERMISSION_SEARCH', bindec('0010'));
define('PERMISSION_EDIT',   bindec('0100'));
define('PERMISSION_DELETE', bindec('1000')); 
```

然后，您可以将它们与按位 OR 运算符组合：

```
$permissions_set = (PERMISSION_CREATE | PERMISSION_SEARCH); 
```

这等于 0011（二进制）或 3，这是您可以存储在数据库中的数字。

要检查特定权限是否“开启”，请使用按位与：

```
if( ($permissions_set & PERMISSION_CREATE) === true ) {
    // create is on
} 
```

# ios - 在应用程序上执行 segue 进入具有多个视图的前景？

> ID：11836534
> 
> 赞同：0
> 
> 时间：2012-08-06T21:54:21.267
> 
> 标签：ios, xcode, storyboard, segue

我想使用 segue 回到我的主视图。当按下主页按钮并且应用程序进入后台时......然后用户希望再次打开应用程序将其带到前台我希望运行一个segue，它将他们从他们所在的任何视图中带回“主要观点”。我不介意使用多个转场......或者我如何在应用程序委托中访问这些转场。

最好的方法是什么？谢谢！每个给出好答案的人都可以喝啤酒和积分；）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T15:22:42.127

您可以实现该`applicationWillEnterForeground:application:`方法（来自 UIApplicationDelegate 协议）。每当您的应用程序的状态从 backgo 变为 inactive 状态时（在变为 active 之前），就会调用此方法。

在这种方法中，您可以调用`performSegueWithIdentifier:identifier sender:`. 如果你有一个从每个可能的视图到你的主视图的转场，你就完成了。

`application:didFinishLaunchingWithOptions:`但是，除非您的应用程序具有需要大量时间来重建的非常复杂的状态，否则我建议您在或中重新初始化您的应用程序`applicationDidBecomeActive:`。这样更容易保持一致的状态。

# c# - 在 Web 服务中获取 System.ServiceModel.ServiceActivationException

> ID：11836535
> 
> 赞同：1
> 
> 时间：2012-08-06T21:54:35.143
> 
> 标签：c#, wcf, web-services

在将代码发布到我们的生产服务器后，我偶尔会收到 System.ServiceModel.ServiceActivationException。这将记录在服务器事件日志中并向发出请求的客户端返回 500。

> 修复它需要停止 IIS，清除 .NET 临时文件，然后重新启动 IIS。

我的问题是，如果没有使用 Fiddler 观察网络流量并监控服务器事件日志，我该如何捕获这个异常。我在 svc 文件中有一个错误处理程序，可以捕获一些错误，但这似乎发生在实际服务代码之外。我希望能够抓住它并获得通知。

异常全文如下：

```
WebHost failed to process a request.
Sender Information: System.ServiceModel.ServiceHostingEnvironment+HostingManager/63835064
Exception: System.ServiceModel.ServiceActivationException: The service '/SCORMInterface.svc' cannot be activated due to an exception during compilation.  The exception message is: Could not load file or assembly 'App_Web_yuna0pfp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.. ---> System.IO.FileNotFoundException: Could not load file or assembly 'App_Web_yuna0pfp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.
at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)
at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
at System.Reflection.Assembly.Load(String assemblyString)
at System.ServiceModel.Activation.ServiceHostFactory.CreateServiceHost(String constructorString, Uri[] baseAddresses)
at System.ServiceModel.ServiceHostingEnvironment.HostingManager.CreateService(String normalizedVirtualPath)
at System.ServiceModel.ServiceHostingEnvironment.HostingManager.ActivateService(String normalizedVirtualPath)
at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)
--- End of inner exception stack trace ---
at System.ServiceModel.ServiceHostingEnvironment.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath)
at System.ServiceModel.ServiceHostingEnvironment.EnsureServiceAvailableFast(String relativeVirtualPath)
Process Name: w3wp 
```

# apache - Apache 413 请求实体太大，字符串很大

> ID：11836537
> 
> 赞同：7
> 
> 时间：2012-08-06T21:54:50.160
> 
> 标签：apache

最近，我更改为专用服务器，并且开始在 jquery ajax 帖子中保存大字符串时遇到问题。在旧服务器中工作正常，但在这个新服务器中我收到 Apache 413 错误。

Firebug 发送此响应：

```
Encabezados de la respuesta
Connection  close
Content-Encoding    gzip
Content-Length  331
Content-Type    text/html; charset=iso-8859-1
Date    Mon, 06 Aug 2012 20:53:23 GMT
Server  Apache
Vary    Accept-Encoding
Encabezados de la petición
Accept  */*
Accept-Encoding gzip, deflate
Accept-Language es-MX,es;q=0.8,en-us;q=0.5,en;q=0.3
Connection  keep-alive
Content-Length  1105294
Content-Type    application/x-www-form-urlencoded; charset=UTF-8
Cookie  SpryMedia_DataTables_table-objetos_crear.php=%7B%22iCreate%22%3A1344285216690%2C%22iStart%22%3A0%2C%22iEnd%22%3A10%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B1%2C%22asc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20true%2Ctrue%2Ctrue%2Ctrue%2Ctrue%5D%7D; SpryMedia_DataTables_confs-tabla_index.php=%7B%22iCreate%22%3A1344286395266%2C%22iStart%22%3A0%2C%22iEnd%22%3A8%2C%22iLength%22%3A10%2C%22sFilter%22%3A%22%22%2C%22sFilterEsc%22%3Atrue%2C%22aaSorting%22%3A%5B%20%5B8%2C%22desc%22%5D%2C%5B4%2C%22asc%22%5D%2C%5B0%2C%22asc%22%5D%2C%5B1%2C%22asc%22%5D%2C%5B2%2C%22asc%22%5D%5D%2C%22aaSearchCols%22%3A%5B%20%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%2C%5B%22%22%2Ctrue%5D%5D%2C%22abVisCols%22%3A%5B%20true%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Ctrue%2Cfalse%2Ctrue%2Cfalse%5D%7D; PHPSESSID=3d8f502be166becd4e504a438eb2b4ae; chkFiltroCol2=; COL=misconfs; ACCION=CONF_EDITAR_CONTENIDO; CONF_ID=279
Host    eduweb.mx
Referer http://myserver.com/edit-article.php
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:14.0) Gecko/20100101 Firefox/14.0.1
X-Requested-With    XMLHttpRequest 
```

谷歌搜索我发现错误在于 LimitRequestBody 的大小，我将其更改为 64Mb 但我仍然收到此错误。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-03-26T10:20:08.267

这对我有用：

在 modsecurity.conf 文件中

在我的 Ubuntu 14.04 上，配置文件在这里，但这真的取决于系统：/etc/modsecurity/modsecurity.conf

将这两个命令更改为此值：

SecRequestBodyLimit 13107200

SecRequestBodyNoFilesLimit 13107200

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T15:26:56.977

您可能会遇到 SSL 重新协商缓冲区溢出情况。检查您的 Apache 日志文件。如果是这种情况，快速解决方法是使用 SSLRenegBufferSize 指令来增加您的重新协商缓冲区。请参阅[SSL Renegotiation with Client Certificate 导致服务器缓冲区溢出](https://stackoverflow.com/questions/14281628/ssl-renegotiation-with-client-certificate-causes-server-buffer-overflow)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T23:02:46.213

`LimitRequestBody`可能不是你想要的。那是请求*正文*，而不是看起来太长的标头。尝试将默认情况下为 8k[的 LimitRequestFieldSize](http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfieldsize)设置为更大的值（请注意有关此设置优先级的警告）。

# java - Java中使用的带宽计算公式

> ID：11836540
> 
> 赞同：0
> 
> 时间：2012-08-06T21:55:01.160
> 
> 标签：java, formula, bandwidth

我环顾四周，似乎找不到适合我需要的好配方。对于与应用程序的单个连接，我有以下值

```
long elapsedTimeSeconds = (System.currentTimeMillis() - client.getCreationTime()) / 1000;
long totalBytesRead = conn.getReadBytes();
long totalBytesWritten = conn.getWrittenBytes(); 
```

我想以 Kbps 为单位计算经过的时间段内使用的带宽量（读取和写入）。

这是分别计算每个的正确公式吗？

```
long readBandwidthUsed = (totalBytesRead / 1024) / elapsedTimeSeconds; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T00:28:25.403

我最终使用了这个公式：

```
long bandwidthUsed = (totalBytes / 1024) / elapsedTimeSeconds;

```

# excel - 需要在 excel 2003 表单上换行

> ID：11836541
> 
> 赞同：1
> 
> 时间：2012-08-06T21:55:02.380
> 
> 标签：excel, excel-2003, vba

我使用在线教程在 Excel 2003 中创建了一个表单，但我有一个不同的用例，现在遇到了一个小问题。我对VB知之甚少，我的搜索没有产生任何有用的东西。我有一个文本输入字段，它不会包装首选的文本，因此用户可以在提交之前看到他/她写给教授阅读或编辑的内容。我的猜测是这个代码块需要一些东西来指定文本应该在那个文本框中换行。提前感谢您提供的任何帮助。

```
Private Sub txtopportunity_Change()

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T22:01:14.153

您不必在代码中执行此操作。您可以将文本框设置为始终像这样换行：

在设计器模式下，右键单击您的文本框并打开它的“属性”其中一个称为“WordWrap”，将其设置为 True。并将“MultiLine”属性设置为**True**

如果你真的需要通过 VBA 启用/禁用它，它看起来像

```
 Me.txtopportunity.WordWrap = True
    Me.txtopportunity.MultiLine = True 
```

# reporting-services - 自定义格式 SSRS

> ID：11836542
> 
> 赞同：0
> 
> 时间：2012-08-06T21:55:13.193
> 
> 标签：reporting-services

我有这个数据。

```
city        value 

seoul       2.42999
tokyo       5.70109 
```

如果城市是首尔，我想将数字格式化为 0 位小数，如果城市是东京，我想格式化为显示 3 位小数。

我尝试过这样的事情，但没有奏效。

```
=IIF(Fields!CityName.Value="seoul",N0,N3) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:11:23.757

格式说明符是字符串，添加引号。此外，您可能需要修剪字段值

`=IIF(Trim(Fields!CityName.Value) ="seoul","N0","N3")`

# java - 最快的 Java HashSet 图书馆

> ID：11836546
> 
> 赞同：6
> 
> 时间：2012-08-06T21:55:47.107
> 
> 标签：java, performance, hashset

除了[这篇相当老的帖子](https://stackoverflow.com/questions/629804/what-is-the-most-efficient-java-collections-library)之外，我还需要一些可以使用原语并为包含大量`HashSet`s 的应用程序提供加速的东西`Integers`：

```
Set<Integer> set = new HashSet<Integer>(); 
```

所以人们提到像 Guava、Javalution、Trove 这样的库，但是在基准和性能结果方面并没有完美的比较，或者至少是来自良好经验的好答案。从我看到的很多人推荐 Trove's `TIntHashSet`，但也有人说它不是那么好；有人说 Guava 超酷且易于管理，但我不需要美观和可维护性，只需要时间执行，所以 Python 的风格 Guava 就回家了 :) Javalution？我访问过该网站，对我来说似乎太旧了，因此很古怪。

图书馆应该提供最佳的可实现时间，内存无关紧要。

查看“Thinking in Java”，有一个想法是`HashMap`使用`int[]`as 键创建自定义。所以我想看到类似的东西，`HashSet`或者只是下载并使用一个很棒的库。

**编辑**（回应下面的评论）所以在我的项目中，我从大约 50 个`HashSet<Integer>`集合开始，然后我调用一个函数大约 1000 次，内部创建多达 10 个`HashSet<Integer>`集合。如果我更改初始参数，数字可能会呈指数增长。我只在这些集合上使用`add()`,`contains()`和`clear()`方法，这就是选择它们的原因。

现在我要找到一个实现`HashSet`或类似的库，但由于自动装箱`Integer`开销和其他我不知道的东西，它会更快地完成。事实上，当我的数据进入并将它们存储在那些`HashSet`s 中时，我正在使用整数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-18T09:38:34.007

Trove 是一个很好的选择。

*它比通用*集合快得多的原因是内存使用。

A在内部`java.util.HashSet<Integer>`使用 a `java.util.HashMap<Integer, Integer>`。在 a`HashMap`中，每个对象都包含在一个`Entry<Integer, Integer>`. 这些对象在实际哈希表中占用估计的 24 字节`Entry`+ 实际整数的 16 字节 + 4 字节。这产生了 44 个字节，与 Trove 中的 4 个字节相比，内存开销高达 11 倍（请注意，主表中未占用的整体将在实践中产生较小的差异）。

另见这些实验：

[http://www.takipiblog.com/2014/01/23/java-scala-guava-and-trove-collections-how-much-can-they-hold/](http://www.takipiblog.com/2014/01/23/java-scala-guava-and-trove-collections-how-much-can-they-hold/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-18T12:54:52.417

看看[Java 的高性能原始集合 (HPPC)](http://labs.carrotsearch.com/hppc.html)。它是 trove 的替代品，成熟且为提高效率而精心设计。请参阅[IntOpenHashSet](http://labs.carrotsearch.com/download/hppc/0.6.0/api/com/carrotsearch/hppc/IntOpenHashSet.html)的 JavaDoc 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:05:49.173

您是否尝试在创建 HashSet 时使用初始容量和负载因子参数？

[哈希集文档](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#HashSet%28int,%20float%29)

初始容量，如您所想，指的是空哈希集在创建时有多大，而负载因子是决定何时增长哈希表的阈值。通常您希望将已用桶与总桶的比率保持在三分之二以下，这被认为是在哈希表中实现良好稳定性能的最佳比率。

[哈希表的动态调整](http://en.wikipedia.org/wiki/Hash_table#Dynamic_resizing)

所以基本上，尝试设置一个适合您需要的初始容量（以避免在哈希表增长时重新创建和重新分配值），以及摆弄负载因子直到找到最佳位置。

对于您的特定数据分布和设置/获取值，较低的负载因子可能会有所帮助（几乎没有更高的负载因子，但您的里程可能会有所不同）。

# javascript - 在不更改 HTML 的情况下访问特定的 html 元素值

> ID：11836549
> 
> 赞同：0
> 
> 时间：2012-08-06T21:56:16.773
> 
> 标签：javascript

我是 Javasript 的新手，想了解如何访问特定元素。我有超过 20 首歌曲跨度的内容。如果我已经在脚本中的一个变量中拥有了跨度 ID，例如“歌曲 3”，我如何访问与该歌曲相关的“producedBy”类，更具体地说，是其中包含的文本，在这种情况下说“不管天气”。不改变底层 HTML？

非常感谢任何帮助以帮助理解 javascript。谢谢。

```
 <div class="Artist Song">
    <span id="song_1" class="song">   
       <span class="artistname">MJ</span>
        <span class="songname">Billie Jean</span>
        <span class="email" style="whatever"><strong>neverland@ranch.com</strong></span>
        <span class="recordlabel">def jam</span>
        <span class="age">34 years</span>
        <span class="album">Album:<strong>Bad</strong></span>
        <span class="dateReleased" style="display:none">whatever</span>
        <span class="producedBy" style="display:none">Produced by Quincy jones</span>
    </span>
</div>

<div class="Artist Song">
    <span id="song_2" class="song">   
       <span class="artistname">Prodigy</span>
        <span class="songname">Firestarter</span>
        <span class="email" style="whatever"><strong>firestarter@twisted.com</strong></span>
        <span class="recordlabel">whatever</span>
        <span class="age">whatever</span>
        <span class="album">Album:<strong>Fat of the land</strong></span>
        <span class="dateReleased" style="display:none">whatever</span>
        <span class="producedBy" style="display:none">whatever</span>
    </span>
</div>

<div class="Artist Song">
    <span id="song_3" class="song">   
       <span class="artistname">Whoever</span>
        <span class="songname">Whatever</span>
        <span class="email" style="whatever"><strong>whatever@wherever.com</strong></span>
        <span class="recordlabel">whatever</span>
        <span class="age">whatever</span>
        <span class="album">Album:<strong>Whatever</strong></span>
        <span class="dateReleased" style="display:none">whatever</span>
        <span class="producedBy" style="display:none">whatever the weather</span>
    </span>
</div>

<div class="Artist Song">
    <span id="song_4" class="song">   
       <span class="artistname">Whoever</span>
        <span class="songname">Whatever</span>
        <span class="email" style="whatever"><strong>whatever@wherever.com</strong></span>
        <span class="recordlabel">whatever</span>
        <span class="age">whatever</span>
        <span class="album">Album:<strong>Whatever</strong></span>
        <span class="dateReleased" style="display:none">whatever</span>
        <span class="producedBy" style="display:none">whatever</span>
    </span>
</div>

... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:58:05.827

```
document.getElementById("song_1").getElementsByClassName("producedBy")[0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:04:25.400

```
document.getElementById("song_3").getElementsByClassName("producedBy")[0].innerHTML 
```

[document.getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)

[getElementsByClassName](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)

[element.innerHTML](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)

[演示](http://jsfiddle.net/mowglisanu/TxqJF/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:59:27.603

使用[jQuery](http://jquery.com/)进行简单的 dom 操作：

```
$("#song_1 > .songname").text() 
```

# html5-audio - 在 MediaElement.js 播放器上设置空 SRC？

> ID：11836553
> 
> 赞同：1
> 
> 时间：2012-08-06T21:56:59.400
> 
> 标签：html5-audio, mediaelement.js

我在页面上有一个音频播放器。用户可以选择要加载的音轨。在选择之间，我想将音频播放器的源设置为空。将空字符串传递给“setSrc”会产生“下载文件”消息的不良效果。

那么实现这一目标的最佳方法是什么？目前我正在将一个字符串传递给我知道不是文件的“setSrc”，这种产生了预期的效果，但显然并不理想。

[https://github.com/johndyer/mediaelement/issues/587](https://github.com/johndyer/mediaelement/issues/587)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-16T14:23:20.237

我有一个相关的问题。我构建了一个动态加载曲目的音频播放器。问题是我在创建音频标签时必须将某些东西设置为 src。我什至尝试使用 base64 编码的空 mp3，结果却发现它会使 Flash 回退引发异常。

它没有很好的记录，但最终我意识到如果我初始化 MediaElement 并将参数“type”设置为“audio/mp3”（在我的情况下），则不需要最初设置 src。

从我在 mediaelement.js 中可以看到，它只需要 src 来确定媒体类型，例如（.mp3、.mpg 等）。

因此，要回答您的问题，一旦明确设置类型，您应该能够将 src 设置为“无”。

# ruby-on-rails - 编辑 Ruby 文件时是否有用于 HTML 的 Sublime Text 智能感知？

> ID：11836554
> 
> 赞同：7
> 
> 时间：2012-08-06T21:56:59.523
> 
> 标签：ruby-on-rails, sublimetext2

我喜欢 Sublime Text 2 作为我的 Ruby on Rails 项目的编辑器，但是，当我编辑我的 .erb 文件时，我没有得到任何 html 帮助。

例如，如果我键入：`<input type="`，我想查看“文本”、“按钮”、“文件”等列表。

我喜欢 Visual Studio 智能感知对 HTML 的支持，Sublime 和 Ruby on Rails 有类似的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T23:40:32.530

Sublime Text 为 html 内置了智能感知，即使在编辑 .erb 文件时也是如此。它甚至会进行模糊匹配，而不是像大多数智能感知工具那样进行精确的子字符串匹配。

1.  确保您的语法是 html (rails)。点击`ctrl+shift+p`并输入`Set Syntax: HTML (Rails)`
2.  `ctrl+space`每当您想弹出智能感知菜单时点击

如果您希望智能感知自动弹出而不是点击，`ctrl+space`您可以修改`"auto_complete_triggers"`Preferences.sublime_settings 中的设置。例如，如果您希望在键入后弹出智能感知，`<`或者`=`将其添加到用户设置文件中：

`"auto_complete_triggers": [ {"selector": "text.html", "characters": "<="} ]`

![崇高文本智能感知的示例](../Images/946eeb7b4b0fbf8627b0bc48f25832f8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-16T11:50:17.587

如果您想要 HTML 智能感知，请按照以下步骤操作 1) CTRL + SHIFT + P -> 安装新包 2) 键入 emmet 3) 安装 emmet.io 4) 瞧，您已准备好使用崇高文本中的 HTML 智能感知 2。

# javascript - 加载时 getelementbyID 返回 null

> ID：11836563
> 
> 赞同：0
> 
> 时间：2012-08-06T21:57:23.903
> 
> 标签：javascript

我有这个简单的函数需要找到一个元素并在加载时设置它的高度：

```
function setGround() { 

document.getElementById('content').style.height = '40px';

        } 

document.onload = setGround(); 
```

但是，该函数在加载时返回“null”。我错过了一些明显的东西吗？是的，具有该 ID 的元素确实存在。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:59:35.340

```
document.onload = setGround; 
```

删除`()`or 函数**立即**运行，然后`document.onload`设置为函数的返回（在你的情况下是）。~~`null`~~ `undefined`

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-06T22:01:18.843

忽略这个，对不起

* * *

从技术上讲，在设置 .onload 时，您应该将其设置为要运行的 javascript 的字符串，所以您应该这样做

```
document.onload = "setGround()"; 
```

这可能是你的问题，它可能只是一个不影响它的小错误，但认为它应该有所帮助

# mysql - 简单的 MySQL INSERT 查询非常慢

> ID：11836564
> 
> 赞同：0
> 
> 时间：2012-08-06T21:57:33.160
> 
> 标签：mysql, ubuntu-12.04

我认为我的 MySQL 服务器或我正在使用的查询有问题。我不确定是哪个。

服务器是 VM Ubuntu12.4 4 cores/16gb Ram MySQL 5.5.24 x86

我的查询：

```
INSERT INTO `NEWTEXT`.`Order_LineDetails`

( OrderLineItem_ID, Customer_ID, Order_ID, ProductName )
SELECT
'Order_Details'.'OrderDetailID',
'Orders'.'CustomerID',
'Order_Details'.'OrderID',
'prods'.'ProductName'

FROM Order_Details 
JOIN Orders ON Orders.OrderID = Order_Details.OrderID
JOIN Products prods ON prods.ProductID = Order_Details.ProductID
WHERE Orders.OrderID = 500000 
```

我不确定从哪里开始寻找问题。上面的查询需要 9+ 秒才能完成。Order_Details 表中包含 1,800,000 多条记录。

让我烦恼的是，当我运行选择查询时，它也会变慢。但是，我有另一台正在运行 win2k MsSql 的服务器，它几乎可以立即使用相同的 SELECT 查询。

我希望有人可以在这里为我指明正确的方向。

## 编辑

好吧，很抱歉给您带来麻烦并感谢您的帮助。

我发现问题在于，在完成导入后，我跳过了通常分配新表 a 的步骤`PrimaryKey`。我知道，:(愚蠢。

反正！不要忘记分配你的`Primary Keys`！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T15:35:00.017

回到起点： [http ://dev.mysql.com/doc/refman/5.5/en/optimizing-primary-keys.html](http://dev.mysql.com/doc/refman/5.5/en/optimizing-primary-keys.html)

# wolfram-mathematica - 函数式编程

> ID：11836566
> 
> 赞同：1
> 
> 时间：2012-08-06T21:57:49.523
> 
> 标签：wolfram-mathematica

假设我有这个 Mathematica 代码，它的输出是一个实数，取决于输入，比如 x,y,z。如何根据代码在 x,y,z 中创建实值函数？

如果代码描述了 x,y,z 之间的简单关系，我可以直接定义这个函数。这里的重点是给定的代码是一个非常复杂的块（或模块）。

例如，如果代码只是简单地将 x,y,z 相加，我会简单地定义

```
f[x_,y_,z_]=x+y+z 
```

如果我有一个非常复杂的示例，如下所示：

```
s0[a_, b_, x_] :=
{1, 0, (a + b) x + (1 - a - b)}

s1[a_, b_, c_, d_, p_, q_, n_, x_] :=

Which[0 <= x <= c, {2, n - 1, x/c*q + p},
c <= x <= c + d, {2, n, (x - c)/d*p},
c + d <= x <= 1, {1, n + 1, (x - (c + d))/(1 - c - d)*(1 - a - b)}]

s2[s_, t_, c_, d_, p_, q_, n_, x_] :=

Which[0 <= x <= 1 - s - t, {2, n - 1, 
x/(1 - s - t)*(1 - p - q) + p + q},
1 - s - t <= x <= 1 - s, {3, 
n - 1, (x - (1 - s - t))/t*(1 - c - d) + c + d},
1 - s <= x <= 1, {3, n, (x - (1 - s))/s*d + c}]

s3[c_, a_, b_, s_, t_, n_, x_] :=

Which[0 <= x <= 1 - a - b, {4, n - 1, x/(1 - a - b)*t + 1 - s - t},
1 - a - b <= x <= 1 - a, {4, n, (x - (1 - a - b))/b*(1 - s - t)},
1 - a <= x <= 1, {3, n + 1, (x - (1 - a))/a*c}]

s4[p_, q_, s_, a_, b_, n_, x_] :=

Which[0 <= x <= p, {4, n - 1, x/p*s + 1 - s},
p <= x <= p + q, {5, n - 1, (x - p)/q*a/(a + b) + b/(a + b)},
p + q <= x <= 1, {5, n, (x - (p + q))/(1 - p - q)*b/(a + b)}]

F[{k_, n_, x_}] :=
Which[k == 0, s0[a, b, x],
k == 1, s1[a, b, c, d, p, q, n, x],
k == 2, s2[s, t, c, d, p, q, n, x],
k == 3, s3[c, a, b, s, t, n, x],
k == 4, s4[p, q, s, a, b, n, x]]

G[x_] := NestWhile[F, {0, 0, x}, Function[e, Extract[e, {1}] != 5]]
H[x_] := Extract[G[x], {2}] + Extract[G[x], {3}]
H[0] 
```

要运行上述代码，需要指定列表

```
{a,b,c,d,p,q,s,t} 
```

并且输出是实数。如何在 a,b,c,d,p,q,s,t 中定义一个函数来输出这些实数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T06:40:45.210

您的基本问题是您的辅助函数中有大量参数，但是您的大字母函数（`F`和`G`顺便`H`说一下 Mathematica 中的单大写字母函数名称是一个**坏主意**）只需要三个参数，而您的辅助函数（`s0`等）只返回返回列表中的三个值。

您有两种可能的方法来解决此问题。

您可以重新定义所有内容以要求整个系统所需的所有参数 - 我假设辅助函数中的公共参数名称确实是公共值 - 如下所示：

```
 G[x_, a_, b_, c_, d_, p_, q_, s_, t_] := 
 NestWhile[F, {0, 0, x, a, b, c, d, p, q, s, t}, 
  Function[e, Extract[e, {1}] != 5]] 
```

或者

您可以设置一些选项，为整个系统全局设置这些参数。向上看`Options`和`OptionsPattern`。你会做这样的事情：

首先，定义默认选项：

```
Options[mySystem] = {aa -> 0.2, bb -> 1., cc -> 2., dd -> 4., 
     pp -> 0.2, qq -> 0.1, ss -> 10., tt -> 20.}
SetOptions[mySystem, {aa->0.2, bb->1., cc->2., dd->4., pp->0.2, 
     qq->0.1, ss->10., tt->20.}] 
```

然后像这样编写你的函数：

```
F[{k_, n_, x_}, OptionsPattern[mySystem]] :=
 With[{a = OptionValue[aa], b = OptionValue[bb], c = OptionValue[cc], 
   d = OptionValue[dd], p = OptionValue[pp], q = OptionValue[qq], 
   s = OptionValue[ss], t = OptionValue[tt]}, 
  Which[k == 0, s0[a, b, x], k == 1, s1[a, b, c, d, p, q, n, x], 
   k == 2, s2[s, t, c, d, p, q, n, x], k == 3, 
   s3[c, a, b, s, t, n, x], k == 4, s4[p, q, s, a, b, n, x]] ] 
```

您的使用也有一些问题`Extract`（您假设列表中的部分比前几次迭代中实际存在的部分更多），但这回答了您的主要问题。

# python - 如何为不可变类型实现“__iadd__()”？

> ID：11836570
> 
> 赞同：3
> 
> 时间：2012-08-06T21:58:08.713
> 
> 标签：python, immutability, augmented-assignment

我想子类化一个不可变类型或实现我自己的一个，其行为类似于`int`以下控制台会话中所示的那样：

```
>>> i=42
>>> id(i)
10021708
>>> i.__iadd__(1)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'int' object has no attribute '__iadd__'
>>> i += 1
>>> i
43
>>> id(i)
10021696 
```

毫不奇怪，`int`对象没有`__iadd__()`方法，但应用`+=`到一个对象不会导致错误，相反它显然会创建一个新对象`int`，并且还以某种方式神奇地将其重新分配给增强赋值语句中给出的名称。

是否可以创建一个用户定义的类或内置不可变类的子类来执行此操作，如果可以，如何？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-06T22:03:32.860

根本不实施`__iadd__`，而只是`__add__`：

```
>>> class X(object):
...     def __add__(self, o):
...             return "added"
>>> x = X()
>>> x += 2
>>> x
'added' 
```

如果没有`x.__iadd__`，Python 会简单地计算`x += y`为`x = x + y` [^(doc)](http://docs.python.org/reference/datamodel.html#object.__iadd__)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:05:25.727

当它看到时`i += 1`，Python 会尝试调用`__iadd__`. 如果失败，它将尝试调用`__add__`.

在这两种情况下，调用的结果都将绑定到名称，即它会尝试`i = i.__iadd__(1)`然后`i = i.__add__(1)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T22:26:13.283

的返回值`__iadd__()`被使用。您不需要返回要添加的对象；您可以创建一个新的并将其返回。实际上，如果对象是不可变的，*则必须这样*做。

```
import os.path

class Path(str):
    def __iadd__(self, other):
        return Path(os.path.join(str(self), str(other)))

path = Path("C:\\")
path += "windows"

print path 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-06T22:15:19.077

```
class aug_int:
    def __init__(self, value):
        self.value = value

    def __iadd__(self, other):
        self.value += other
        return self

>>> i = aug_int(34)
>>> i
<__main__.aug_int instance at 0x02368E68>
>>> i.value
34
>>> i += 55
>>> i
<__main__.aug_int instance at 0x02368E68>
>>> i.value
89
>>> 
```

# actionscript-3 - 如何在通过 OSMF 加载的 HDS 视频上允许 BitmapData.draw

> ID：11836575
> 
> 赞同：2
> 
> 时间：2012-08-06T21:58:34.673
> 
> 标签：actionscript-3, video-streaming, osmf

我正在使用[OSMF加载](http://www.osmf.com)[HDS 视频](http://www.adobe.com/products/hds-dynamic-streaming.html)（一个 .f4m 文件），并希望将视频绘制到. 我目前收到以下错误：`BitmapData`

```
Exception fault: SecurityError: Error #2123: Security sandbox violation: BitmapData.draw: [url ommitted] cannot access null. No policy files granted access. 
```

如果我只是使用平原`NetStream`，我相信我可以通过设置`.checkPolicyFile`来解决这个问题`true`。

是这样吗，我怎样才能在 OSMF 中实现同样的效果？

# javascript - JavaScript 对象 - 对象值在构造后变得未定义

> ID：11836580
> 
> 赞同：0
> 
> 时间：2012-08-06T21:59:11.990
> 
> 标签：javascript, function, object, methods

我正在尝试创建一个处理 Google Maps Api 的对象，如下所示：

```
function GoogleMap(container, mapOptions) {
    this.Container = container;
    this.Options = mapOptions;
    this.Map = new google.maps.Map(document.getElementById(this.Container), this.Options);

    // Direction
    this.DirectionService = new google.maps.DirectionsService();
    this.DirectionRenderer = new google.maps.DirectionsRenderer();
    this.DirectionRenderer.setMap(this.Map);
    this.DirectionId = 0;
    this.DirectionResponse = new Array();
    this.DrawDirectionDriving = drawDirectionDriving;
} 
```

drawDirectionDriving 函数是这样的：

```
function drawDirectionDriving(start, end) {
  var request = {
    origin: start,
    destination: end,
    travelMode: google.maps.TravelMode.DRIVING
  };

  this.DirectionService.route(request,
    function (response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        this.DirectionRenderer.setDirections(response);
        this.DirectionResponse[this.DirectionId] = response;
        this.DirectionId++;
      }
      else {
        alert("Error during drawing direction, Google is not responding...");
      }
    }
  );
} 
```

在某个地方，我正在使用这样的对象：

```
var myGoogleMap;

function MapInit() {
    myGoogleMap = new GoogleMap("divMap", myMapOptions);
    myGoogleMap.DrawDirectionDriving("İstanbul", "Ankara");
} 
```

谷歌地图显示在我的浏览器上，构造对象没有问题，但 DrawDirectionDriving 函数出错。

当我在这一行创建断点时：“myGoogleMap.DrawDirectionDriving("İstanbul", "Ankara");" “DirectionRenderer”似乎已构建，但在此行之后（在“Draw”方法之后）DirectionRenderer 对象似乎为空（未定义），因此它会出现这样的错误“无法获取 setDirections 属性，它为空 bla bla ...”

你能帮我一把吗？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:12:28.193

[`this`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)确实指向`route`回调函数中的其他内容。它的`DirectionRenderer`属性解析为`null`/ `undefined`，从中获取`setDirections`属性将导致异常。

使用解引用变量：

```
function drawDirectionDriving(start, end) {
  var request = {
    origin: start,
    destination: end,
    travelMode: google.maps.TravelMode.DRIVING
  };
  var that = this;

  this.DirectionService.route(request,
    function (response, status) {
      if (status == google.maps.DirectionsStatus.OK) {
        that.DirectionRenderer.setDirections(response);
        that.DirectionResponse[this.DirectionId] = response;
        that.DirectionId++;
//      ^^^^ points to the GoogleMap instance
      }
      else {
        alert("Error during drawing direction, Google is not responding...");
      }
    }
  );
} 
```

# iphone - 关闭时应用程序崩溃

> ID：11836583
> 
> 赞同：2
> 
> 时间：2012-08-06T21:59:24.017
> 
> 标签：iphone, ios, crash

当我在我的 iPhone 上关闭我的应用程序（双击主页按钮并触摸 X）时，它崩溃并且我收到此错误：

```
objc[9337]: class `ADManager' not linked into application
objc[9337]: class `ADSessionManager' not linked into application
objc[9337]: class `ADSession' not linked into application
(lldb) 
```

-部署目标：iOS 5.1 -Iphone
iOS 5.1.1
-在 iPhone 上使用 Xcode 进行测试

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T06:02:27.150

这是 iOS4 及更高版本中所有 iOS 应用程序的默认行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T07:18:09.587

嗯，运行连接到 Xcode 调试器的应用程序然后在进程中间终止它不是一个好主意。它很容易导致引导错误。

当您在 iTunes 中运行应用程序时，调试器会不断监控您的应用程序，终止它显然会导致崩溃 =/

当您处于调试过程中时，您可以在 Xcode 4 的“调试”选项卡中看到一个旋转图标（该选项卡的图标看起来像一个语音按钮，并且在您的项目导航器中包含一些行）。

不确定通过终止您的应用程序（已注册的后台进程（例如位置服务））要达到什么目的？

# flash - 如何在不包含 SDK 库的情况下在 FDT 中编译 SWC？

> ID：11836587
> 
> 赞同：1
> 
> 时间：2012-08-06T21:59:35.480
> 
> 标签：flash, fdt, compc

似乎命令 -el 强制外部链接，但由于无法找到 playerglobal.swc 中的选项，因此无法编译。我只想从源文件夹构建一个 swc，而不包括任何外部资产。

我的第二个问题是关于构建包含 ASDOC 信息的 FAT SWC 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T18:18:02.330

以下是如何在 ANT 中执行此操作。

```
<target name="foundation build-debug">
    <delete file="${FDTProjectPath}/bin/${foundation-debug-file}"/>
    <fdt.loadProjectProperties projectname="frameworks" />
    <fdt.launch.library projectname="${FDTProject}" debug="true" autoaddclasspath="false" compilerarguments="
        -target-player=${FDTProjectPlayerVersion}
        -include-sources=${FDTProjectPath}/src
        -allow-source-path-overlap=true 
            -external-library-path+=${FDTProjectSdkPath}/frameworks/libs/ 
            -external-library-path+=${FDTProjectPath}/lib 
        -incremental=true 
        -benchmark=true" target="${FDTProjectPath}/bin/${foundation-debug-file}" />
</target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T13:50:54.077

确保将每个 SDK .SWC 设置为“用作运行时共享代码”。它位于项目的属性页面中。

![在此处输入图像描述](../Images/1fa4f6aa92739e6311ab6bfac772f3ad.png)

# unit-testing - 学习使用When和Should和TDD进行单元测试

> ID：11836589
> 
> 赞同：4
> 
> 时间：2012-08-06T21:59:37.417
> 
> 标签：unit-testing, tdd, bdd

我新工作的测试与我以前遇到的测试完全不同。

当他们编写单元测试时（大概在代码之前），他们创建了一个以“When”开头的类。该名称描述了测试将运行的场景（夹具）。他们将通过代码为每个分支创建子类。类中的所有测试都以“应该”开头，并在运行后测试代码的不同方面。因此，他们将有一种方法来验证每个模拟（DOC）是否被正确调用并检查返回值（如果适用）。我对这种方法有点困惑，因为这意味着每个测试都运行完全相同的执行代码，这似乎很浪费。我想知道是否有类似的技术他们可能已经适应了。一个解释样式及其应该如何实现的链接会很棒。

我还注意到他们已经将重复调用“执行”SUT 移动到设置方法中。当他们期待异常时，这会导致问题，因为他们不能使用内置工具来执行检查（Python unittest 的 assertRaises）。这也意味着将返回值存储为测试类的支持字段。他们还必须存储许多模拟作为支持字段。跨类层次结构很难分辨每个模拟的配置。

他们也以不同的方式测试代码。这真的归结为他们认为的集成测试。他们模拟出任何从被测试函数中窃取上下文的东西。这可能意味着同一类中的私有方法。我一直将模拟限制在可能影响测试结果的资源上，例如数据库、文件系统或日期。我可以看到这种方法的一些价值。但是，现在使用它的方式，我可以看到它导致脆弱的测试（每次代码更改都会中断的测试）。我很担心，因为如果没有集成测试，在这种情况下，您可能会错误地使用第 3 方 API，但您的单元测试仍然会通过。我也想了解更多关于这种方法的信息。

因此，任何关于在哪里可以了解更多关于其中一些方法的资源都会很好。我不想因为我不了解他们做事的方式而放弃一个很好的学习机会。我也想停止关注这些方法的负面影响，看看好处在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:33:22.583

如果我正确理解了您在第一段中的解释，那与我经常做的非常相似。（取决于测试框架是否使它变得容易。许多模拟框架也不支持它，但像[Mockito](http://code.google.com/p/mockito/)这样的间谍框架做得更好。）

例如，请参见[此处的堆栈示例，](http://specsy.org/documentation.html#isolated_execution_model)该示例具有通用设置（将内容添加到堆栈），然后是一堆独立的测试，每个测试都检查一件事。[这里还有另一个例子](https://github.com/orfjackal/tdd-tetris-tutorial/blob/beyond/src/test/java/tetris/RemovingFullRowsTest.java)，这次没有一个测试 (@Test) 修改公共夹具 (@Before)，但每个测试都专注于检查应该发生的一件独立的事情。如果测试非常集中，那么应该可以更改生产代码以使任何单个测试失败，而所有其他测试都通过（我最近在[Unit Test Focus Isolation](http://blog.orfjackal.net/2012/05/unit-test-focus-isolation.html)中写过）。

主要思想是让每个测试检查一个特性/行为，以便在测试失败时更容易[找出失败的原因](http://blog.orfjackal.net/2010/02/three-styles-of-naming-tests.html)。有关更多示例并了解该风格，请参阅[此 TDD 教程。](https://github.com/orfjackal/tdd-tetris-tutorial)

我不担心多次执行相同的代码路径，运行一个测试需要一毫秒（如果[运行所有单元测试需要几秒钟以上](http://arlobelshee.com/what-makes-a-good-test-suite/arlo-belshee)，测试可能太大了）。从您的解释来看，如果每个模拟都有一个测试是系统的，我更担心测试可能与实现过于紧密地耦合，而不是功能。测试的名称将很好地表明测试的结构或脆弱程度——它是否描述了一个特性或该特性是如何实现的。

关于 mocking，一本好书是[《Growing Object-Oriented Software Guided by Tests》](http://www.growing-object-oriented-software.com/)。由于您已经提到的原因，不应模拟第 3 方 API（您不拥有且无法修改的 API），但应在其上创建一个抽象，以更好地满足使用它的系统的需求并工作你想要的方式。该抽象需要与第 3 方 API 进行集成测试，但在所有*使用*该抽象的测试中，您都可以模拟它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T02:52:35.570

首先，您使用的模式基于 Cucumber - 这是一个[链接](http://cukes.info/)。风格来自 BDD（行为驱动开发）方法。与传统 TDD 相比，它有两个优点：

1.  语言 - BDD 的租户之一是，您使用的语言会通过迫使您以最终用户的语言说话来影响您的想法，最终您将编写与以程序员为中心编写测试不同的测试
2.  测试锁定代码 - BDD 将代码锁定在适当的级别。测试中常见的一个问题是您编写了大量测试，这使您的代码库更加脆弱，因为当您更改代码时，您也必须更改大量测试。BDD 强制您锁定代码的行为，而不是代码的实现。这样，当测试中断时，它更有可能是有意义的。

值得注意的是，您不必使用 Cucumber 测试风格来实现这些影响，并且使用它确实会增加额外的开销层。但很少有程序员在使用传统 xUnit 工具 (TDD) 时成功地保持 BDD 思维方式。

听起来您也有一些场景，您想说“当我这样做时，然后验证”。因为当前的 BDD xUnit 框架只允许您验证原语（字符串、整数、双精度、布尔值......），这通常会导致大量单独的测试（每个 Assert 一个）。可以使用[Golden Master](https://stackoverflow.com/a/10535414/1335105)范式测试工具（例如[ApprovalTests](http://www.approvaltests.com) ）进行更复杂的验证。这是一个[视频示例](http://www.youtube.com/watch?v=vKLUycNLhgc)。

最后，这是 Dan North[博客](http://dannorth.net/)的链接——他开始了这一切。

# javascript - 将javascript数据放入表单

> ID：11836594
> 
> 赞同：1
> 
> 时间：2012-08-06T22:00:13.287
> 
> 标签：javascript, jquery, forms

我有以下 javascript 代码：

```
game.bind('gameover', function(seconds) {
    setTimeout(function() {
      var rank = game.getRank(seconds);
      scorecard.find('.time').text(seconds + ' sec');
      scorecard.find('.rank').text(rank[0]);
      scorecard.find('.byline').text(rank[1]);
      ...more code 
```

在以下 div 中显示此数据（因此 js 脚本正在运行）：

```
<div class="inner">
  <h3>Nice job! Your time:</h3>
  <h1 class="wobble time"><!-- 15 seconds --></h1>
  <h2 class="rank"><!-- Friendly Mallard --></h2>
  <h3 class="byline"><!-- (That's pretty good) --></h3>
</div> 
```

现在我想把结果也放在一个表单中，这样我就可以将它发布到数据库（mysql）。所以我添加了一个表单并将其放在同一个 div 中：

```
<form id="form" action="updatescore.php" method="post">
  <input type="text" id="time" name="time" value="" />
  <input type="text" id="rank" name="rank" value="" />
  <input type="text" id="byline" name="byline" value="" />
</form> 
```

现在在 JS 中，我复制了这些行（例如`scorecard.find('.time').text(seconds + ' sec');`）并将其更改为查找 id，因此`.`变成`#`并在 js 中传递它，如下所示：

```
scorecard.find('.time').text(seconds + ' sec');
scorecard.find('#time').text(seconds + ' sec');
etc 
```

所以我认为这应该可行，但表单输入保持为空。我究竟做错了什么？

亲切的问候，

莫里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:09:52.940

如果您只是想通过`updatescore.php`您根本不需要使用表单将 js 变量移动到数据库中！您可以使用 AJAX 来实现。

```
 var scoreData = {
       time : time,
       rank : rank[0],
       byline : rank[1]
  };
  $.post('updatescore.php', scoreData); //done! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:05:47.217

使用`val()`而不是`text()`设置值

# javascript - 在 Ember.js 中创建分组选择

> ID：11836596
> 
> 赞同：5
> 
> 时间：2012-08-06T22:00:29.460
> 
> 标签：javascript, forms, ember.js

[使用Ember.Select](http://docs.emberjs.com/#doc=Ember.Select&src=false)在 Ember.js 中创建选择相对容易。

问题是，如何使用 optgroup 将其变为分组选择。我不认为这是内置的，但我猜对模板进行一些修改是可能的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-08T15:38:39.660

Ember 现在原生支持这一点，但有一些问题。在 1.4.0 中，以下解决方案有效...

这是示例数据：

```
foos: Ember.A([{value: 'foo', label: 'Foo', group: 'Foos'}, {value: 'bar', label: 'Bar', group: 'Bars'}, {value: 'bar2', label: 'Bar2', group: 'Bars'}, {value: 'foo2', label: 'Foo2', group: 'Foos'}]) 
```

这是视图助手：

```
{{view Ember.Select content=controller.foos optionLabelPath='content.label' optionValuePath='content.value' optionGroupPath='group'}} 
```

如果您只是执行上述操作，您将获得一个如下所示的选择列表：

![在此处输入图像描述](../Images/6bf77d29688c8f514540947e00607e68.png)

我可以解决这个问题的唯一方法是首先按分组字段**对数组进行排序：**

```
foos: Ember.A([{value: 'foo', label: 'Foo', group: 'Foos'}, {value: 'bar', label: 'Bar', group: 'Bars'}, {value: 'bar2', label: 'Bar2', group: 'Bars'}, {value: 'foo2', label: 'Foo2', group: 'Foos'}]).sortBy("group") 
```

![在此处输入图像描述](../Images/7d7567ac605a2b22856f39a96cf64045.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-04T15:35:43.427

这里的答案有点过时了。Ember 现在支持对内容进行分组。想象一下你有：

```
App.SomeController = Ember.Controller.extend({
  content: [{value: 'foo', label: 'Foo', group: 'Foos'}, {value: 'bar', label: 'Bar', group: 'Bars'}]
}) 
```

然后你可以做

```
Ember.Select contentBinding='content' optionLabelPath='content.label' optionValuePath='content.value' optionGroupPath='group' 
```

注意 optionGroupPath 不做 content.path，只是 path

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T18:51:04.500

这是我想出的解决方案。[https://gist.github.com/3297425](https://gist.github.com/3297425)

我不得不制作两个系列。一个分组，另一个只是内容，以便可以选择正确的选项。

```
groupedServiceCodes = [Ember.Object.create({label: 'Label for optgroup', content: Ember.A()}), …] 
```

然后将 groupedServiceCodes 中的内容展平以保持选择的顺序：

```
flattenedServiceCodes = [].concat(object.get('content'), …) 
```

这有点小题大做，我认为 Ember 想要一个更好的解决方案，但这对我有用。我很想听听关于改进这一点的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T13:54:46.170

Ember.Select 不支持 optgroups，但您可以通过为其提供新模板和选项的新模板来扩展 Ember.Select。我这样做是为了支持 Ember 中的 selected.js 选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-21T15:04:57.090

Ember 现在支持开箱即用。参考这个 git pull request [https://github.com/emberjs/ember.js/pull/2465](https://github.com/emberjs/ember.js/pull/2465)

# iphone - iPhone 旋转时的行为不符合预期

> ID：11836598
> 
> 赞同：1
> 
> 时间：2012-08-06T22:00:44.720
> 
> 标签：iphone, xcode, user-interface, rotation

我的应用程序在每个视图上有 3 个按钮和 1 个图像视图。由于按钮和图像的大小以及导航栏和标签栏控制器的大小，需要调整大小以使横向模式下的所有内容都变小。我将以下代码放入：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{

if (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || interfaceOrientation == UIInterfaceOrientationLandscapeRight)
{
    viewofimage.frame = CGRectMake(130, 45, 220, 115);
    share.frame = CGRectMake(205, 161, 70, 70);
    invite.frame = CGRectMake(8, 161, 70, 70);
    contact.frame = CGRectMake(402, 161, 70, 70);
    invitation.frame = CGRectMake(3, 227, 81, 21);
    sharing.frame = CGRectMake(200, 227, 81, 21);
    contacting.frame = CGRectMake(397, 227, 81, 21);
}
else
{
    viewofimage.frame = CGRectMake(20, 64, 280, 206);
    invite.frame = CGRectMake(8, 285, 70, 70);
    share.frame = CGRectMake(125, 285, 70, 70);
    contact.frame = CGRectMake(242, 285, 70, 70);
    invitation.frame = CGRectMake(3, 358, 81, 21);
    sharing.frame = CGRectMake(120, 358, 81, 21);
    contacting.frame = CGRectMake(237, 358, 81, 21);
}

return YES; 
} 
```

在模拟器中，这表现得很完美，图像视图被调整大小并且一切都是可见的。在设备上，它只是将所有内容向右移动。关于错误在代码中的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:02:02.667

不要像这样对值进行硬编码，您应该使用自动调整大小的掩码来处理旋转等事件的大小调整

一个问题可能是 shouldAutoRotate 被缓存并且每次设备旋转时都不会调用，也许可以尝试将此代码移动到 will/did rotate 方法

另一个是在发生任何旋转之前会调用此方法，因此您的框架会发生变化，然后设备会旋转，并且任何默认的自动调整大小都意味着框架不是您所期望的

# javascript - YUI Compressor Maven Mojo 缩小 javascript 的使用

> ID：11836599
> 
> 赞同：2
> 
> 时间：2012-08-06T22:00:54.843
> 
> 标签：javascript, jsp, maven, package, minify

我在一个使用 maven 编译的 struts2 项目上工作。我正在尝试缩小位于不同位置的 javascript 文件。

```
<plugin>
    <groupId>net.alchim31.maven</groupId>
    <artifactId>yuicompressor-maven-plugin</artifactId>
    <version>1.3.0</version>
    <executions>
      <execution>
        <goals>
          <goal>compress</goal>
        </goals>
      </execution>
    </executions>        
    <configuration>
      <nosuffix>true</nosuffix>
    </configuration>
  </plugin> 
```

我假设通过这样做，所有的js文件都将被缩小并替换生产war文件中的原始文件（根据nosuffix的定义）。

然而，情况似乎并非如此。我怎样才能做到这一点？

其次，如果我选择使用带有后缀的那个，我假设我必须手动更改我的 jsp 文件中的脚本引用，对吗？如果是这样，我该如何设置它以删除没有后缀的原始文件？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T10:40:31.670

我在[这里](https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-web/pom.xml)找到了可行的解决方案。基本上，您需要将以下内容放入 pom.xml 中（仅替换 src/main/webapp 文件夹中的 js 和 css 文件的路径）：

```
 <build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <configuration>
                <webResources>
                    <!-- Add minified resources -->
                    <resource>
                        <directory>${project.build.directory}/minimized</directory>
                        <targetPath>/</targetPath>
                        <filtering>false</filtering>
                    </resource>
                </webResources>
            </configuration>
        </plugin>

        <plugin>
            <groupId>net.alchim31.maven</groupId>
            <artifactId>yuicompressor-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>compress</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <nosuffix>true</nosuffix>
            </configuration>
        </plugin>
    </plugins>

    <pluginManagement>
        <plugins>
            <!-- Javascript and CSS files compression -->
            <plugin>
                <groupId>net.alchim31.maven</groupId>
                <artifactId>yuicompressor-maven-plugin</artifactId>
                <version>1.1</version>
                <configuration>
                    <!-- Don't output in the default webapp location, since the war plugin will overwrite the files in there
                    with the original, uncompressed ones. -->
                    <webappDirectory>${project.build.directory}/minimized</webappDirectory>
                    <jswarn>false</jswarn>
                    <!-- Overwrite existing files -->
                    <nosuffix>true</nosuffix>
                    <includes>
                        <include>%path to your js and css files inside src/main/webapp%/**/*</include>
                    </includes>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
    </build> 
```

# android - 以编程方式检查 Android OTA 系统更新

> ID：11836609
> 
> 赞同：6
> 
> 时间：2012-08-06T22:01:23.457
> 
> 标签：android, ota

如果您转到“设置”->“关于手机”->“检查更新”，则会启动检查以查看是否有任何系统更新可供您的手机使用。

如何以编程方式执行此操作？此外，我正在尝试找出在 Android 源代码中发生这种情况的位置，以便我可以完全看到它并更好地理解它。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T22:23:37.297

据我所知，没有已知的广播、意图或 API 可以以编程方式执行此操作。

这取决于ROM和制造商。

例如，索尼使用一项服务，当 wifi 被激活时，该服务会检查索尼的服务器是否有任何更新并通知它。

但是当谈到 AOSP 源时，我认为不会发生这种情况。

最近的*系统更新*点位于`packages/apps/Settings/src/com/android/settings/DeviceInfoSettings.java`

**提示**：在目录中使用 grep 字符串“系统更新”`res/values`并使用反词并找出该字符串变量标识符的使用位置！

***编辑：***

这是一个示例广播接收器：

```
public class SystemUpdateClass extends BroadcastReceiver{
   @Override
   public void onReceive(Context context, Intent intent){
      if (intent.getAction().equals("android.settings.SYSTEM_UPDATE_SETTINGS")){
           Toast.makeText(context, 
                 "Yup! Received a system update broadcast", 
                 Toast.LENGTH_SHORT).show();
      }
   }
} 
```

这是一个示例代码，来自一个活动的`onCreate`：

```
SystemUpdateClass sysUpdate = new SystemUpdateClass();
IntentFilter filter = new IntentFilter();
filter.addAction("android.settings.SYSTEM_UPDATE_SETTINGS");
registerReceiver(sysUpdate, filter); 
```

现在，应该发生的是您的应用程序应该接收广播，除非我误认为广播仅适用于系统签名的应用程序......但是其余的留作练习:)

# ipython - ipython的配置文件在哪里/如何/在什么上下文中执行？

> ID：11836612
> 
> 赞同：2
> 
> 时间：2012-08-06T22:01:41.340
> 
> 标签：ipython

ipython 的以 开头的配置文件在哪里`c = get_config()`执行？我问是因为我想了解 ipython 中的操作顺序，例如为什么某些命令如果包含为`c.InteractiveShellApp.exec_lines`.

这与我的另一个问题[Log IPython output?](https://stackoverflow.com/questions/11833654/log-ipython-output) ，因为我想访问一个`logger`属性，但我无法弄清楚如何在配置文件中访问它，并且`exec_lines`运行时，记录器已经启动（为时已晚）。

编辑：我已经接受了基于在`ipython0.12+`. 这是我对该解决方案的实现：

```
from time import strftime
import os.path

ip = get_ipython()

#ldir = ip.profile_dir.log_dir 
ldir = os.getcwd()
fname = 'ipython_log_' + strftime('%Y-%m-%d') + ".py"
filename = os.path.join(ldir, fname)
notnew = os.path.exists(filename)

try:
  ip.magic('logstart -o %s append' % filename)
  if notnew:
      ip.logger.log_write( u"########################################################\n" ) 
  else:
      ip.logger.log_write( u"#!/usr/bin/env python\n" )
      ip.logger.log_write( u"# " + fname + "\n" )
      ip.logger.log_write( u"# IPython automatic logging file\n" )
  ip.logger.log_write( u"# " + '# Started Logging At: '+ strftime('%Y-%m-%d %H:%M:%S\n') ) 
  ip.logger.log_write( u"########################################################\n" ) 
  print " Logging to "+filename
except RuntimeError:
    print " Already logging to "+ip.logger.logfname 
```

与所链接的建议解决方案只有两个细微的区别：1.将日志保存到`cwd`某个日志目录而不是某个日志目录（尽管我更喜欢...） 2.`ip.magic_logstart`似乎不存在，而是应该使用`ip.magic('logstart')`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T00:55:37.023

配置系统设置一个包含`get_config()`函数的特殊命名空间，运行配置文件，并收集值以在创建对象时将它们应用于对象。参考您之前的问题，看起来日志输出没有配置值。当您可以更精确地控制它时，您可能希望在配置后开始自己记录。请参阅[此](http://wiki.ipython.org/Cookbook/DatedLog)自动开始记录的示例。

您的另一个问题提到您在一个系统上仅限于 0.10.2：该系统具有完全不同的配置系统，甚至不会查看同一个文件。

# c# - 运行 Fitnesse 测试时映射组件时无法找到程序集 FluentNHibernate

> ID：11836615
> 
> 赞同：3
> 
> 时间：2012-08-06T22:01:53.140
> 
> 标签：c#, fluent-nhibernate, fitnesse, fluent-nhibernate-mapping, fitsharp

我遇到了一个非常奇怪的问题。我有几个正在工作的 Fitnesse 测试，它们在数据库中插入数据，然后测试我的完整 MVC 应用程序堆栈。

当我尝试将 2 个组件属性映射添加到我的实体映射时，我收到一条错误消息“无法找到程序集 'FluentNHibernate ...'，这似乎有点神秘。

所有这些都是通过 Fitnesse 运行的，所以这可能是 Fitnesse 如何加载依赖项的问题……但我不知道确定。我唯一知道的是，在我添加 2 个“组件”映射之前，这段代码运行良好。最重要的是，当此代码通过普通 Web 应用程序运行时，这些映射运行良好（所以我知道“组件”映射和 SessionFactory 类在测试项目之外工作）。

有谁知道为什么我会收到我收到的错误消息？如果我需要发布任何其他代码，请告诉我。任何帮助是极大的赞赏！

DLL 版本：

*   NHibernate - **3.3.1.4000**
*   FluentNHibernate - **1.3.0.733**
*   Fitnesse - **v20111026**
*   fitSharp - **2.2.4498.25493**

这是我的实体：

```
// namespace Reporting.Domain
public class Holdings
{
    public virtual int HoldingsId { get; set; }
    public virtual DateTime AsOfDate { get; set; }
    public virtual string Portfolio { get; set; }

    // need to add these next 2 properties!
    public virtual Balances PriorPeriod { get; set; }
    public virtual Balances CurrentPeriod { get; set; }
} 
```

我的映射文件：

```
// namespace Reporting.Infrastructure
public sealed class HoldingsMap : ClassMap<Holdings>
{
    public HoldingsMap()
    {
        Id(x => x.HoldingsId).GeneratedBy.Identity();
        Map(x => x.AsOfDate).Not.Nullable();
        Map(x => x.Portfolio).Not.Nullable();

        // adding these lines eventually leads to the error
        Component(x=> x.PriorPeriod).ColumnPrefix("Prior");
        Component(x=> x.CurrentPeriod).ColumnPrefix("Current");
    }
} 
```

我的 SessionFactory （**调用 BuildSessionFactory 时发生错误**）：

```
// namespace Reporting.Infrastructure
public class SessionFactory
{
    public ISessionFactory CreateSession(Action<Configuration> configurationFunction)
    {
        return CreateConfiguration().ExposeConfiguration(c => {}).BuildSessionFactory();
    }

    private FluentConfiguration CreateConfiguration()
    {
        var connectionString = "...";
        var msSqlConfiguration = MsSqlConfiguration.MsSql2008.ConnectionString(connectionString);
        var database = Fluently.Configure().Database(msSqlConfiguration);
        return database.Mappings(m => m.FluentMappings.AddFromAssemblyOf<SessionFactory>().Conventions.Add(ForeignKey.EndsWith("Id")));
    }
} 
```

我得到这个堆栈跟踪：

```
__EXCEPTION__:System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> FluentNHibernate.Cfg.FluentConfigurationException: An invalid or incomplete configuration was used while creating a SessionFactory. Check PotentialReasons collection, and InnerException for more detail.

 ---> FluentNHibernate.Cfg.FluentConfigurationException: An invalid or incomplete configuration was used while creating a SessionFactory. Check PotentialReasons collection, and InnerException for more detail.

 ---> System.Runtime.Serialization.SerializationException: Unable to find assembly 'FluentNHibernate, Version=1.3.0.733, Culture=neutral, PublicKeyToken=8aa435e3cb308880'.
   at System.Runtime.Serialization.Formatters.Binary.BinaryAssemblyInfo.GetAssembly()
   at System.Runtime.Serialization.Formatters.Binary.ObjectReader.GetType(BinaryAssemblyInfo assemblyInfo, String name)
   at System.Runtime.Serialization.Formatters.Binary.ObjectMap..ctor(String objectName, String[] memberNames, BinaryTypeEnum[] binaryTypeEnumA, Object[] typeInformationA, Int32[] memberAssemIds, ObjectReader objectReader, Int32 objectId, BinaryAssemblyInfo assemblyInfo, SizedArray assemIdToAssemblyTable)
   at System.Runtime.Serialization.Formatters.Binary.__BinaryParser.ReadObjectWithMapTyped(BinaryObjectWithMapTyped record)
   at System.Runtime.Serialization.Formatters.Binary.__BinaryParser.Run()
   at System.Runtime.Serialization.Formatters.Binary.ObjectReader.Deserialize(HeaderHandler handler, __BinaryParser serParser, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, IMethodCallMessage methodCallMessage)
   at FluentNHibernate.Utils.Extensions.DeepClone[T](T obj)
   at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source, Func`2 predicate)
   at FluentNHibernate.Visitors.ComponentReferenceResolutionVisitor.ProcessComponent(ReferenceComponentMapping mapping)
   at FluentNHibernate.MappingModel.ClassBased.ReferenceComponentMapping.AcceptVisitor(IMappingModelVisitor visitor)
   at FluentNHibernate.MappingModel.MappedMembers.AcceptVisitor(IMappingModelVisitor visitor)
   at FluentNHibernate.MappingModel.ClassBased.ClassMappingBase.AcceptVisitor(IMappingModelVisitor visitor)
   at FluentNHibernate.MappingModel.HibernateMapping.AcceptVisitor(IMappingModelVisitor visitor)
   at FluentNHibernate.Utils.CollectionExtensions.Each[T](IEnumerable`1 enumerable, Action`1 each)
   at FluentNHibernate.PersistenceModel.ApplyVisitors(IEnumerable`1 mappings)
   at FluentNHibernate.PersistenceModel.BuildMappings()
   at FluentNHibernate.PersistenceModel.Configure(Configuration cfg)
   at FluentNHibernate.Cfg.MappingConfiguration.Apply(Configuration cfg)
   at FluentNHibernate.Cfg.FluentConfiguration.BuildConfiguration()
   --- End of inner exception stack trace ---
   at FluentNHibernate.Cfg.FluentConfiguration.BuildConfiguration()
   at FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory()
   --- End of inner exception stack trace ---
   at FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory()
   at Reporting.Infrastructure.SessionFactory.CreateSession() in Reporting.Infrastructure\SessionFactory.cs:line 32
   at Reporting.FitnesseTests.Database.Setup() in Reporting.FitnesseTests\Database.cs:line 23
   --- End of inner exception stack trace ---
   at fitSharp.Machine.Model.TypedValue.ThrowExceptionIfNotValid()
   at fitSharp.Slim.Operators.ExecuteCall.ExecuteOperation(Tree`1 parameters)
   at fitSharp.Slim.Operators.InvokeInstructionBase.Invoke(TypedValue instance, MemberName memberName, Tree`1 parameters) 
```

FWIW，这就是我使用我的 Fitnesse Tests 项目中的会话工厂的方式：

```
// namespace Reporting.FitnesseTests
public class Database
{
    public static ISession Session { get; private set; }

    public static void Setup()
    {
        Session = new SessionFactory().CreateSession().OpenSession();
    }
} 
```

我的 Fitnesse Classpath 是：

```
!path ..\Reporting.FitnesseTests\bin\Debug\Reporting.FitnesseTests.dll 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T16:06:18.697

尝试将测试要查找的 DLL 放在与 fitsharp Runner.exe 相同的文件夹中。我遇到的一个问题是，在 app.config 中定义的 .NET 运行时依赖项是从执行进程的目录中解析的，在这种情况下，该目录可能是 fitsharp 所在的目录。显然有一种方法可以使用 fitsharp 套件配置文件来改变这种行为，但我无法让它成功运行（[http://fitsharp.github.com/FitSharp/SuiteConfigurationFile.html](http://fitsharp.github.com/FitSharp/SuiteConfigurationFile.html)）。

# mysql - 理解 GROUP BY 子句

> ID：11836621
> 
> 赞同：1
> 
> 时间：2012-08-06T22:02:24.357
> 
> 标签：mysql, sql, oracle

`SELECT a,b from <table_name> GROUP BY a,b,c`.

以上是有效的sql语句吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T22:03:44.673

不是没有表名就不是。如果它有一个表名，它将是有效的，但可能不是很有用。

通常，将 GROUP BY 子句与一些聚合函数（SUM、COUNT、MAX、MIN 等）结合使用来导出与分组字段相关的一些值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:08:09.763

如果您包含表名，我猜您是在询问是否可以按未选择的元素 c 分组。是的你可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T23:22:15.837

是的，该查询是合法的 SQL。SQL是否**有用完全是另一回事。**

查询

```
select a , b
from foo
group by a,b,c 
```

执行以下操作：

*   将源表中的行分组到不同的组中，每个列的唯一组合`a`1`b`和`c`.
*   然后将每个这样的组折叠成一行，其中包含分组列和查询所需的任何所需聚合函数的值。
*   然后将生成的结果集返回给调用者，丢弃任何不需要的列（在本例中为 column `c`）。

由于其中一个分组列被丢弃，因此不能保证指定的查询是一组唯一的行。它很可能包含重复项。例如，如果`group by`想出要返回的这些组：

```
A  B  C
-  -  -
0  0  0
0  0  1
0  1  0
0  1  1
1  0  0
1  0  1
1  1  0
1  1  1 
```

查询返回的结果集将是

```
A  B
-  -
0  0
0  0
0  1
0  1
1  0
1  0
1  1
1  1 
```

所以，不一定有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T22:04:03.043

不——你需要一张桌子。

`SELECT a,b FROM myTable GROUP BY a,b,c`

其中 myTable 是您从中选择的表（必须包含 a、b 和 c 列）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T22:08:05.373

否 - 因为您没有指定表名。如果你有，那么是的，它肯定对 mysql 有效，不确定 Oracle（它验证 GROUPing 的方式非常不同）。但这没有任何意义...

```
a  b  c
0  0  0
0  0  1
0  1  0
0  1  1 
```

将查询应用于上表将给出：

```
0 0 
0 0
0 1
0 1 
```

而且我看不出这将是一个有意义的结果——如果你不想要一个聚合值，那么 DISTINCT 更有意义——但会给出不同的结果：

```
SELECT DISTINCT a, FROM `atable` 

0 0
0 1 
```

也许如果你解释了你问这个问题的真正原因，我们可以做出更明智的尝试来回答它。

# java - ListView中的EditText？

> ID：11836622
> 
> 赞同：0
> 
> 时间：2012-08-06T22:02:29.350
> 
> 标签：java, android, android-layout, android-listview

我正在使用此代码在列表视图中获取 edittext 的值。

```
 View view = listview.getChildAt(position);
     EditText text = (EditText)view.findViewById(R.id.myEditBox);
     String contents = text.getText().toString(); 
```

但问题是，当我滚动列表视图时，位置发生了变化，我得到了不同的结果。即，如果我滚动，第五个位置的元素位于顶部，它的位置变为 0。有什么补救措施吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:16:28.000

如果您还没有这样做，您将必须为您的列表视图创建一个适配器，并且在您设置视图时在您的适配器上添加一个 textwatcher 并在文本更改为您的活动或片段时报告。

在您的适配器上：

```
edittext.addTextChangedListener(new TextWatcher() {

                @Override
                public void onTextChanged(CharSequence s, int start, int before, int count) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void beforeTextChanged(CharSequence s, int start, int count,
                        int after) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void afterTextChanged(Editable s) {
                    ((MyActivity) getContext()).textChanged(s.toString());

                }
            }); 
```

关于你的活动

```
public void textChanged(String s){

       //do somthing with the string
} 
```

这样您就不必猜测编辑文本的位置

# python - Pyside setText() 不更新 QLabel

> ID：11836623
> 
> 赞同：1
> 
> 时间：2012-08-06T22:02:33.483
> 
> 标签：python, qt, pyside

我有以下内容：

```
 self.testTxt = QtGui.QLabel("0")
 .
 .
 for i in range(10):
        sleep(1)
        self.testTxt.setText(unicode(i)) 
```

但 QLabel 直到循环结束才会更新

我试过了：

```
self.processEvents()
self.testTxt.update() 
```

但无济于事。

有谁碰巧知道为什么？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:40:21.393

文本框不会更新，因为程序被绑定在 for 循环中，因此永远不会回到 Qt 的事件循环来重绘小部件。调用 testTxt.update() 无济于事，因为正如[QWidget 文档](http://qt-project.org/doc/qt-4.8/qwidget.html#update)所述，update() 只是为下一次运行事件循环时*安排*重绘（无论如何，当您调用 setText 时会处理这一点）。

可能的解决方案：

*   使用 QTimer 重复调用更新文本的函数（这是首选解决方案）
*   每次调用 setText 后调用 testText.repaint()
*   每次调用 setText 后调用 QApplication.processEvents()

# python - 与 web.py 匹配的 URL

> ID：11836624
> 
> 赞同：1
> 
> 时间：2012-08-06T22:02:38.523
> 
> 标签：python, apache, url, web-applications, web.py

我正在用 apache 和 web.py 编写一个简单的“Hello world”。该应用程序在我去时有效

```
http://sandbox-dev.com/webapp/ 
```

但不是当我去：

```
http://sandbox-dev.com/webapp 
```

我的直觉（显然是错误的）是以下代码会匹配这些地址中的任何一个。

```
import sys, os
abspath = os.path.dirname(__file__)
sys.path.append(abspath)
os.chdir(abspath)

import web

urls = (
      '/.*', 'hello',
      )

class hello:
      def GET(self):
          return "Hello, web.py world."

application = web.application(urls, globals()).wsgifunc() 
```

为了匹配这两个，我需要更改什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T01:45:45.637

当 URL 为“http://sandbox-dev.com/webapp”时，web.py 将其视为“”，而不是“/”。因此，将 url 模式更改为“。*”将起作用。

但是，也许你应该在你的 apache 配置中而不是在 webapp 中修复它。添加规则以将 /webapp 重定向到 /webapp/。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:40:47.113

如果你想让**首页**由类**hello**处理，你只需要这样：

```
urls = (
  '/', 'hello',
  ) 
```

还是我误解了你的意图？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:46:06.230

@Anand Chitipothu 是对的。

```
http://sandbox-dev.com/webapp/ matches '/' 
```

和

```
http://sandbox-dev.com/webapp matches '' #empty string 
```

所以如果你想在 webpy 中修复它，你可以写：

```
urls = (
    '.*', 'hello'    #match all path including empty string
    ) 
```

或添加一个重定向类

```
urls = (
    '/.*', 'hello',  
    '', 'Redirect'
    )
class Redirect(object):
    def GET(self):
        raise web.seeother('/')    # this will make the browser jump to url: http://sandbox-dev.com/webapp/ 
```

# c# - appharbor 连接字符串

> ID：11836627
> 
> 赞同：0
> 
> 时间：2012-08-06T22:02:47.213
> 
> 标签：c#, asp.net-mvc-3, connection-string, appharbor

我正在构建一个需要访问数据库的 ASP.NET MVC3 应用程序。我已经在本地机器上成功设置了数据库，一切正常，但后来我将应用程序上传到 appharbor.com 进行测试，现在我无法再访问数据库了。

如何在 appharbor.com 上为 SQLEXPRESS 数据库添加连接字符串？数据库文件位于 App_Data 文件夹中。几天来我一直在尝试让它工作但无济于事。我已经在 appharbor 上添加了 SQL Server 插件。如果有帮助，我不会使用任何实体框架功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T03:27:30.303

在 AppHarbor 上运行时，不应使用应用程序嵌入的 SQL Server 快速数据库。每当部署新的应用程序版本时，任何文件系统状态都会丢失，并且您将丢失对数据库的任何更改。查看本指南，了解如何使用 Sequelizer 插件：http: [//support.appharbor.com/kb/add-ons/using-sequelizer](http://support.appharbor.com/kb/add-ons/using-sequelizer)

# java - LIBGDX - 创建音乐时出错

> ID：11836634
> 
> 赞同：3
> 
> 时间：2012-08-06T22:03:14.613
> 
> 标签：java, audio, libgdx

我正在尝试使用 libgdx 简单地加载音乐资产，这就是我所拥有的：

```
Music main_background;
main_background = Gdx.audio.newMusic(Gdx.files.internal("data/music/main_bg.wav")); 
```

这段代码与使用 libgdx “制作游戏”的小教程中的代码完全相同，我正在尝试加载我自己制作的声音（使用 GarageBand，以防万一）。每当我尝试将其作为桌面应用程序运行时，都会出现一堆错误：

> 线程“LWJGL 应用程序”com.badlogic.gdx.utils.GdxRuntimeException 中的异常：为文件创建音乐 com.badlogic.gdx.backends.openal.Wav$Music 时出错：data/music/main_bg.wav
> 
> 引起：java.lang.reflect.InvocationTargetException
> 
> 原因：com.badlogic.gdx.utils.GdxRuntimeException：读取 WAV 文件时出错：data/music/main_bg.wav
> 
> 引起：com.badlogic.gdx.utils.GdxRuntimeException：未找到 RIFF 标头：data/music/main_bg.wav

我不确定问题可能是什么，因为音频文件没有损坏（因为我可以很好地听它）但是我无法在任何地方找到有关人们在加载资产时遇到此类错误的信息。

我有一堆纹理加载得很好，但由于某种未知原因，我无法加载音乐资产（为了记录，我尝试加载与声音资产相同的文件并得到基本相同的错误）。

有没有人遇到过这种情况或对可能出现的问题有任何想法？

编辑：我应该提到，如果我也尝试加载 mp3 或 ogg 文件，我也会收到此错误，它不仅仅发生在 wav 上

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T23:24:24.627

首先，了解 libGdx 中 Sound 和 Music 的区别。阅读：[https](https://code.google.com/p/libgdx/wiki/Audio)
://code.google.com/p/libgdx/wiki/Audio 问题可能出在比特率上。我遇到了这个问题，我将 wav 文件的比特率更改为 705kbps 并且它起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-17T05:38:09.330

我遇到过同样的问题。通过重新启动 Eclipse 解决了这个问题。似乎一些 SDK 文件尚未完全安装，重新启动 Eclipse 允许它们完成安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-24T09:35:02.670

您可以将其转换为`.ogg`，它占用的空间更少。并将其保存在您的数据文件夹中。然后声明一个名为的变量`music`：

```
Music music; 
```

之后在您的`create`方法中：

```
music = Gdx.audio.newMusic(Gdx.files.internal("data/whoo.ogg")); 
```

`render`然后在游戏中的任何地方使用它——在`touchUp` `touchDown`任何你想要音乐的地方：

```
music.play(); 
```

# apache-flex - BitmapImage 的不可见部分

> ID：11836637
> 
> 赞同：0
> 
> 时间：2012-08-06T22:03:44.437
> 
> 标签：apache-flex, adobe, bitmapimage, rect

我有一个 SkinnableContainer，它包含 s:BitmapImage。我需要图像的一部分（矩形）完全透明。只需做一个透明的切口，这将很容易定位。背景中的图像是width="300" height="200"，透明区域应该是width="200" height="20" and right="0" bottom="50"。我设法用 BlendMode.OVERLAY 达到了类似的效果，但我相信一定有更好的方法。

请问有什么想法、建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T12:09:41.337

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" 
               creationComplete="onComplete(event)"
               backgroundColor="0xEEEEEE">
    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;
            import mx.graphics.ImageSnapshot;
            import mx.skins.RectangularBorder;      

            protected function onComplete(event:Event):void
            {
                var bW:int = 300;
                var bH:int = 200;

                var X:int = 0;
                var Y:int = 150;
                var W:int = 200;
                var H:int = 20;

                var topRect:Rectangle = new Rectangle(0,0,bW,Y);

                var righRect:Rectangle = new Rectangle(W,0,bW-W,bH);

                var bottomRect:Rectangle = new Rectangle(0,Y+H,bW,bH-(Y+H));

                var targetBitmapData:BitmapData = ImageSnapshot.captureBitmapData(original);

                var newBitmapData:BitmapData = new BitmapData(bW,bH,true,0x00000000);

                newBitmapData.copyPixels(targetBitmapData, topRect, new Point(0, 0),null, null, true);

                newBitmapData.copyPixels(targetBitmapData, righRect, new Point(W, 0),null, null, true);

                newBitmapData.copyPixels(targetBitmapData, bottomRect, new Point(0,Y+H),null, null, true);

                modified.source = new Bitmap(newBitmapData);
            }                   
        ]]>
    </fx:Script>
    <s:VGroup gap="10" left="10" top="10">
        <s:Group id="original">
            <s:Rect width="300" height="200">
                <s:fill>
                    <s:SolidColor/>
                </s:fill>
                <s:stroke>
                    <s:SolidColorStroke color="0xFF0000"/>
                </s:stroke>
            </s:Rect>
        </s:Group>
        <s:Group>
            <mx:Image width="300" height="200" id="modified" />
            <s:Rect top="0" left="0" right="0" bottom="0">
                <s:stroke>
                    <s:SolidColorStroke color="0xFF0000"/>
                </s:stroke>
            </s:Rect>
        </s:Group>          
    </s:VGroup>
</s:Application> 
```

您的特定情况的示例，也许您会扩展它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T00:11:48.643

您可以将另一个对象（如 UIMovieClip）作为蒙版应用于图像。您还可以操作 Bitmap 的像素并将其设置为 BitmapImage 的源。根据您的具体要求，这可能有意义，也可能没有意义。

# java - Spring jsp页面未评估

> ID：11836641
> 
> 赞同：14
> 
> 时间：2012-08-06T22:04:20.417
> 
> 标签：java, spring, jsp, servlets, el

我对 Spring 3.1.0 有一个有趣的问题。JSP 页面没有评估其 EL。我已经调试了视图解析过程，并且正在使用 JstlView 并且检测到 Jstl 库。但是，我的 JSP 页面只是呈现如下内容

```
<%="Hello World!"%> 
```

这里有很多关于这个问题的参考资料，但没有一个对我有用。

[脚本标签未在 JSP 页面中呈现（使用 Spring + Tiles + JSPX）](https://stackoverflow.com/questions/9434755/script-tags-not-rendered-in-jsp-page-using-spring-tiles-jspx) [未处理 Spring 和 JSP EL](https://stackoverflow.com/questions/7971978/spring-and-jsp-el-not-being-processed)

从顶部开始，这是我的配置；

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
         http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
     version="2.5">         

<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:applicationContext.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
</listener> 
</web-app> 
```

**spring-servlet.xml**

```
<!--?xml version="1.0" encoding="UTF-8"? -->
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:aop="http://www.springframework.org/schema/aop" xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd          
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">
    <!--  
    https://stackoverflow.com/questions/3652090/difference-between-applicationcontext-and-spring-servlet-xml-in-spring
    -->         
</beans> 
```

**应用程序上下文.xml**

```
<!--?xml version="1.0" encoding="UTF-8"? -->
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:aop="http://www.springframework.org/schema/aop" xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd          
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<context:annotation-config />
<context:component-scan base-package="com.csc.fs.emea" />
<mvc:default-servlet-handler />
<mvc:annotation-driven />
<mvc:resources mapping="/static/**" location="/" />

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver" p:order="1" />
<bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver" p:order="2" p:defaultErrorView="sorry" />

<bean id="freemarkerConfig" class="org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer">
    <property name="templateLoaderPath" value="/WEB-INF/freemarker/" />
    <property name="freemarkerSettings">
        <props>             
            <prop key="default_encoding">UTF-8</prop>
            <prop key="output_encoding">UTF-8</prop>
            <prop key="auto_include">macros.ftl</prop>
            <prop key="auto_import">spring.ftl as spring</prop>
            <prop key="template_update_delay">${freemarker.template.update.delay}</prop>
        </props>
    </property>
    <property name="freemarkerVariables">
        <props>
            <prop key="googleAnalyticsId">${google.analytics.id}</prop>
        </props>
    </property>
</bean>

<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="viewResolvers">
        <list>
        <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
                <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
                <property name="prefix" value="/WEB-INF/jsp/" />
                <property name="suffix" value=".jsp" />
                <property name="contentType" value="text/html;charset=UTF-8"></property>
            </bean>
            <bean class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver">
                <property name="cache" value="true" />
                <property name="prefix" value="" />
                <property name="suffix" value=".html" />
                <property name="contentType" value="text/html;charset=UTF-8"></property>
                <property name="exposeSpringMacroHelpers" value="true" />
            </bean>             
        </list>
    </property>     
</bean>

<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="classpath:messages" />
</bean>  
<bean id="localeChangeInterceptor" class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
    <property name="paramName" value="lang" />
</bean>  
<bean id="localeResolver" class="org.springframework.web.servlet.i18n.AcceptHeaderLocaleResolver"></bean>    
<bean id="handlerMapping" class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
    <property name="interceptors">
        <ref bean="localeChangeInterceptor" />
    </property>
</bean>
</beans> 
```

我正在使用 ContentNegotiatingViewResolver，因为我也有一些 freemarker 的东西和 REST。

**控制器**

```
@RequestMapping("/")
@Controller
public class RootResource extends AbstractResource {

    ...abridged...

    @RequestMapping(value="/jsp", method = RequestMethod.GET, produces = "text/html")
    public String getJSP(final Model m) {        
        return "example";
    }
} 
```

**例子.jsp**

```
<%@ page isScriptingEnabled="true" isELIgnored="false" %>
<html>
<head>
    <title>Hello World JSP Page.</title>
</head>
<body>
<font size="10"><%="Hello World!"%></font>
</body>
</html> 
```

我从控制器返回“example”作为视图名称，您可以在日志中看到它解析为正确的 WEB-INF/jsp/example.jsp

```
22:35:13,049 DEBUG [1168657208@qtp-1342126426-0] [org.springframework.web.servlet.view.ContentNegotiatingViewResolver] Returning [org.springframework.web.servlet.view.JstlView: name 'example'; URL [/WEB-INF/jsp/example.jsp]] based on requested media type 'text/html'
22:35:13,050 TRACE [1168657208@qtp-1342126426-0] [org.springframework.web.servlet.view.JstlView] Rendering view with name 'example' with model {} and static attributes {}
22:35:13,054 DEBUG [1168657208@qtp-1342126426-0] [org.springframework.web.servlet.view.JstlView] Forwarding to resource [/WEB-INF/jsp/example.jsp] in InternalResourceView 'example' 
```

所以一切看起来都不错，只是 JSP 页面从未被正确评估。

example.jsp 看起来像这样

```
<%@ page isScriptingEnabled="true" isELIgnored="false" %> <%="Hello World!"%> 
```

我正在使用 Maven jetty 6 插件来运行 webapp。

我确定我遗漏了一些简单的东西，这可能是那些“看得太久”的问题之一。

感谢您提供的任何指示。

**更新 1** - 我刚刚将 Spring servlet 映射从 更改`/*`为`/spring/*`，现在它可以工作了。所以有一些关于spring servlet的细节被映射到`/*`我错过了。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-07T10:58:10.380

绝对是“看了太久”的案例。

spring servlet 需要是默认的 servlet。即映射到`/`而不是`/*`。

```
<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>        
</servlet-mapping> 
```

# c++ - 指针类型的priority_queue元素的排序

> ID：11836643
> 
> 赞同：0
> 
> 时间：2012-08-06T22:04:22.300
> 
> 标签：c++, stl

假设我们有一个priority_queue，其中包含一堆 ListNode 对象，声明如下：

```
class ListNode {
  int val;
  ListNode *next;
public:
  explicit ListNode(int v) : val(v), next(NULL) {}
  inline bool operator<(const ListNode& rhs) const {
    return val < rhs.val;
  }
};

std::priority_queue<ListNode> pq; 
```

通过覆盖 operator< 方法或提供排序函子，我们可以让 priority_queue 按 val 的升序保存 ListNode 对象。

我的问题是，如果priority_queue 持有指向ListNode 类的指针，我是否可以对指针进行排序，以便val 的指向按升序排列。我怎么做？

```
std::priority_queue<ListNode *> pq1; 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:11:20.640

如您所说，[`std::priority_queue`](http://en.cppreference.com/w/cpp/container/priority_queue)接受它必须用于执行比较的比较函子作为第三个模板参数。

只需在比较它们之前编写自己的取消引用项目：

```
template<typename T>
struct PtrLess
{
    bool operator()(const T* left, const T* right)
    {
        return *left < *right;
    }
};

std::priority_queue<ListNode *, std::vector< ListNode * >, PtrLess< ListNode > > pq1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:13:08.897

指向的指针`ListNode`就像一个日常指针。您不能在两个指针之间重载运算符。

但是，您可以覆盖比较运算符以实现`priority_queue`. 它会是这样的：

```
struct ListNodePtrLess {
    bool operator()(const ListNode* a, const ListNode* b) {
        return a->val < b->val;
    }
};

typedef std::priority_queue<ListNode*, std::vector<ListNode*>, ListNodePtrLess> MyPriorityQueue; 
```

（另外：您需要与交`ListNodePtrLess`朋友`ListNode`，或让它`val`以某种不同的方式访问该字段）

# jquery - IE 显示一个额外的层

> ID：11836650
> 
> 赞同：-1
> 
> 时间：2012-08-06T22:05:01.893
> 
> 标签：jquery, css, position

如果它在 IE 中加载，我会看到一个带有红色背景的额外图层。但如果它加载到 Firefox 中，它就不存在了。任何人都知道我怎样才能摆脱图层，所以我只看到图像和“X”图标？

我尝试更改大小并使其可见和隐藏，但没有任何效果。

编辑：现在我添加了红色背景颜色，它也显示在 Firefox 中。

我只想查看图像和“X”图标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:12:42.463

只需删除`.window`课堂上的规则`background-color: #ff0000;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:18:24.227

您的图像正在下降，因为`a.close`，也停止了，设置`a.close`为`position: absolute`，`position:relative`但即使那样，您的图像也不足以覆盖红色区域。

# javascript - 防止标记在 MarkerClusterer 中聚集

> ID：11836651
> 
> 赞同：1
> 
> 时间：2012-08-06T22:05:03.437
> 
> 标签：javascript, google-maps, google-maps-api-3, markerclusterer

有什么方法可以防止单个标记与 MarkerClusterer 聚集在一起？

这是我的代码：

```
google.maps.event.addListener(marker, 'click', function() {
    // prevent marker from being clustered here
}); 
```

我知道我可以从 MarkerClusterer 对象中删除标记，然后再将其添加回来，但这会有点复杂，我想知道是否有任何内置功能可以做到这一点。我浏览文档结果是徒劳的，但我可能会遗漏一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:14:16.460

看起来没有任何内置功能，但您可以做一些事情来简化操作。

我建议将集群存储在标记上以便于切换：

```
myClusterer = new MarkerClusterer(map, markers);

...

google.maps.event.addListener(marker, 'click', function() {
    // if marker is detached from clusterer
    if(marker.clusterer) {
        clusterer.attachMarkers([marker]);
        marker.clusterer = null;
    // if marker is attached to clusterer
    } else {
        marker.clusterer = myClusterer;
        clusterer.removeMarker(marker);
    }
}); 
```

**或者**事件更好，让标记从一开始就存储集群：

```
myClusterer = new MarkerClusterer(map)
marker = new MyClusterableMarker();
marker.attachToClusterer(myClusterer)

...

google.maps.event.addListener(marker, 'click', function() {
    marker.toggleAttachmentToClusterer();
});

...

$.extend(MyClusterableMarker.prototype, google.maps.Marker.prototype, {

    attachToClusterer: function(clusterer) {
        this.clusterer = clusterer;
        this.clusterer.attachMarkers([this]);
        this.attachedToClusterer = true;
    },

    toggleAttachmentToClusterer: function() {
        if(this.attachedToClusterer) {
            this.clusterer.removeMarker(this);
            this.attachedToClusterer = false;
        } else {
            this.clusterer.addMarkers([this]);
            this.attachedToClusterer = true;
        }
    }
}) 
```

# javascript - 如何跟踪网站上嵌入式黑莓媒体播放器的播放和暂停事件？

> ID：11836655
> 
> 赞同：0
> 
> 时间：2012-08-06T22:05:25.370
> 
> 标签：javascript, jquery, html, blackberry

我在我的网站上使用嵌入式媒体播放器，让黑莓用户无需下载即可收听音频。（我在黑莓粗体 9700 上对此进行测试，因此任何酷炫的 html5、flash 或嵌入标签都不起作用）我嵌入它的原因是因为我希望能够跟踪用户的收听时间。

基本上我想要的是能够知道用户何时点击播放或暂停。如何控制这些按钮？可能使用一些jQuery？

这是我的播放器代码：

```
<object data="myfilepathHere" type="audio/mpeg">embedded track isnt working!</object> 
```

这是我用作参考的网站：http: [//devblog.blackberry.com/2009/08/blackberry-browser-embedded-media-content-automatic-playback-how-to/](http://devblog.blackberry.com/2009/08/blackberry-browser-embedded-media-content-automatic-playback-how-to/)

我可以让两个按钮播放/暂停和停止显示（它看起来就像它在我提供的链接中所做的那样）在黑莓和要播放的轨道上，所以如果我能让它工作，那就是花花公子。谢谢！:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T20:00:39.810

抱歉，我花了一些时间尝试了一些想法，我很确定不可能跟踪或收听对象上的任何事件。您确实需要 BBOS 6.0 及更高版本上的音频标签。如果您正在开发 WebWorks 应用程序而不是网站，我们有一个 API 可以提供帮助 (https://developer.blackberry.com/html5/apis/blackberry.audio.player.html)。

支持 6.0+ 还不错。您可能会发现访问您网站的大多数人都使用该版本或更高版本。

# permissions - 在 Wix 中设置文件夹和所有子文件夹的权限

> ID：11836660
> 
> 赞同：0
> 
> 时间：2012-08-06T22:05:49.757
> 
> 标签：permissions, wix, windows-installer

所有相关链接似乎都假定我在其中使用 DirectoryRefs 和 CreateFolder。当我运行 heat 时，我得到一个 .wxs 文件，其中包含`<Directory>`标签和`<Component>`标签，但不包含 DirectoryRefs。我宁愿不手动重写整个 5000 行文件。有没有办法编辑这些标签的文件夹权限？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T06:27:33.073

您不必重写`heat`自动生成的片段。您可以使用另一个片段中的 DirectoryRef 元素引用此处定义的目录。

您很可能希望执行以下操作：

首先，更改热生成片段中的根目录的ID。这可以通过`-dr <DirectoryName>`命令行开关来完成`heat.exe`。为 选择一个名称`DirectoryName`，例如`MY_ROOT_FOLDER`。`DirectoryRef`这对于在元素中方便地引用该目录是必要的

接下来，创作一个特殊的组件（在不同的片段中），它只包含权限功能。像这样的东西：

```
<DirectoryRef Id="MY_ROOT_FOLDER">
  <Component DiskId="1" Id="Permissions" Guid="GUID-GOES-HERE">
    <Condition>...</Condition>
    <CreateFolder>
      <util:PermissionEx GenericAll="yes" User="[LOGON_ACCOUNT]" Domain="[LOGON_DOMAIN]" />
    </CreateFolder>
  </Component>
</DirectoryRef> 
```

最后，不要忘记将此组件包含在您选择的功能中。

请注意，默认情况下，该`<util:PermissionEx>`元素**会将**权限附加到**相关文件夹及其所有后代**。

# .htaccess - .htaccess 重定向错误页面问题

> ID：11836665
> 
> 赞同：0
> 
> 时间：2012-08-06T22:06:19.250
> 
> 标签：.htaccess

我在我的 .htaccess 中使用以下代码：

```
 ErrorDocument 404 error_page.php?msg=404 
```

当我触发 404 错误时，我会得到一个这样的页面：

```
 error_page.php?msg=404 
```

有什么我做错了吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:14:54.440

不确定您是否可以将查询字符串传递给由 指定的文档`ErrorDocument`，您可以尝试将它与 mod_rewrite 结合使用：

```
ErrorDocument 404 /error-doc-404
ErrorDocument 405 /error-doc-405
ErrorDocument 500 /error-doc-500

RewriteEngine On
RewriteRule ^error-doc-([0-9]{3})$ /error_page.php?msg=$1 [L] 
```

* * *

由于它位于文档根目录的子目录中，因此它会改变一切。

说子目录是`/something/`

```
ErrorDocument 404 /something/error-doc-404
ErrorDocument 405 /something/error-doc-405
ErrorDocument 500 /something/error-doc-500

RewriteEngine On
RewriteRule ^error-doc-([0-9]{3})$ /something/error_page.php?msg=$1 [L] 
```

假设您的`error_page.php`文件实际上在`/something/`子目录中。

# ruby-on-rails - 如何在 Rails 3.2.7 中生成指向控制器操作的链接？

> ID：11836666
> 
> 赞同：0
> 
> 时间：2012-08-06T22:06:29.017
> 
> 标签：ruby-on-rails, ruby, url, action

这是我要生成的 HTML：

```
<li><a href="/Home/Index">HOME</a></li> 
```

意思是，指向 Home 控制器的 Index 操作的链接。

如何在 Rails 中实现这一点而不生成整个`<a>`元素？

这样的事情存在吗？

```
<li><a href="<%= link_tag(:controller => "home", :action => "index") %>">HOME</a></li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:24:51.973

`link_to`生成所有标记，因此您无需将其写入`<a>`标签内。

```
<%= link_to 'Home', {:controller => :home, :action => :index}, :class => "awesome", :id => "super-awesome" %> 
```

吐出来

```
<a href="/home/index" class="awesome" id="super-awesome">Home</a> 
```

编辑：另外，这是你的朋友 - [http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:08:54.110

为什么不使用`link_to`助手？如果您的路线命名为`home`：

`link_to('Home', home_path)`

会产生

`<a href="/Home/Index">HOME</a>`

`rake routes`您可以通过从命令行运行来检索您的路线名称。

# php - 使用php从根路径获取用户名

> ID：11836668
> 
> 赞同：0
> 
> 时间：2012-08-06T22:06:58.117
> 
> 标签：php, url

我想知道是否有可能只提取用户名。

这是我正在使用的示例路径：

```
/home/UserName/public_html/index.php 
```

文件夹的 IP 链接使用相同的用户名。这是我正在使用的示例。 [http://xxx.xxx.xxx.xxx/~用户名/index.php](http://xxx.xxx.xxx.xxx/~UserName/index.php)

我想知道我是否可以以某种方式使用 php 从我的服务器获取此路径，然后解析除 usrername 之外的所有内容。然后，我想使用该用户名并将其设置为可以在页面上的其他位置使用的变量。

```
$username = UserName 
```

这有意义吗？

我遇到的根本问题是我使用了很多 php 包含，并且我遇到了绝对/相对路径的问题。我在想，通过获取用户名，我可以将所有内容都设为绝对路径。也许我对这一切都错了。

任何建议都会很棒。谢谢大家的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:10:34.683

AFAIK，最佳实践是`$_SERVER['DOCUMENT_ROOT']`用于包含。

```
include($_SERVER['DOCUMENT_ROOT'] . '/templates/footer.php'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:09:41.157

```
$path = $_SERVER['REQUEST_URI']; // this gives you /folder1/folder2/THIS_ONE/file.php

$folders = preg_split('/', $path); // splits folders in array 

$what_we_need = $folders[3]; 
```

[从http://www.sitepoint.com/forums/showthread.php?192267-How-to-get-folder-name-out-of-a-URL](http://www.sitepoint.com/forums/showthread.php?192267-How-to-get-folder-name-out-of-a-URL)被盗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:37:01.117

知道了！这是代码：

```
<?php
$full = dirname(__FILE__);
$folder = basename(dirname(__FILE__));
$trim = strtr($full, array('/home/'=>''));
$trim2 = strtr($trim, array('/public_html/'=>''));
$userid = strtr($trim2, array($folder=>''));
?> 
```

在这个例子中，如果

```
 dirname(__FILE__) = /home/USERNAME/public_html/blog/ 
```

然后 $userid = USERNAME

# cuda - cuda：全局内存使用总量

> ID：11836669
> 
> 赞同：0
> 
> 时间：2012-08-06T22:06:59.220
> 
> 标签：cuda

我使用 cudaMalloc 分配大小为 100 的整数数组，即我拥有的总数

```
int_total_bytes=100*sizeof(int), 
```

并分配大小为 1000 的双精度数组，即我有

```
db_total_bytes=1000*sizeof(double),... 
```

我可以确定 gpu 上使用的全局内存总量是

```
int_total_bytes+db_total_bytes? 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:43:00.240

由于添加填充以实现最佳地址对齐或由于最小块大小，有几种情况可能使分配的实际内存大小大于计算大小。

对于您给出的两个示例，数据大小与自然对齐大小和边界兼容，因此您可能不会看到计算内存和实际使用的内存之间有太大差异。但是，如果 cudaMalloc 使用子分配器，可能仍然存在一些变化 - 如果它从操作系统（或设备）分配一个大块，然后将该大块细分为较小的块以填充 cudaMalloc() 请求。

如果涉及到子分配器，那么操作系统将显示实际内存使用量比您计算的使用量大得多，但即使您的应用程序进行多次小分配（可以从已经分配的大块中填充），实际使用量仍将保持稳定。

类似地，硬件通常具有通常与内存页面大小相同的最小分配大小。如果可以从硬件分配的最小内存块是 64K，那么当您要求 3k 时，您得到的 61K 已分配但未使用。这是子分配器有用的地方，以确保您尽可能多地使用您分配的内存块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:07:03.983

除了 dthorpe 所说的之外，您还可以使用`nvidia-smi`命令检查进程的 GPU 内存使用情况。

# asp.net - “SELECT”和“AS”附近的 dbo.StoredProcedure SQL 语法错误

> ID：11836671
> 
> 赞同：0
> 
> 时间：2012-08-06T22:07:12.503
> 
> 标签：asp.net, sql, syntax

嘿伙计们，我希望你能帮助`SELECT`我`AS`

```
CREATE PROCEDURE dbo.StoredProcedure2
SELECT
,   Announcements.ID
,   Announcement.CreateDate
,   Announcements.Announcement
,aspnet_Users.UserName 
,(SELECT Announcement_Read_State.Read_Date 
    FROM Announcement_Read_State 
    WHERE Announcement_Read_State.Announcement_ID = Announcements.ID 
    AND Announcement_Read_State.User_ID = 2) AS ReadState 
FROM Announcements INNER JOIN aspnet_User ON Announcements .Sender_User_ID = aspnet_User.UserName 
WHERE (Announcements.ID IN 

        ( SELECT Max(Announcements.ID) 
        FROM Thread_Participant INNER JOIN Announcements ON 
        Thread_Participant.ThreadId = Announcements.Announcement_ThreadId 
        WHERE MessageThreadParticipant.UserID = 2 
        GROUP BY ThreadParticipant.AnnouncementThreadId
        )

 ORDER BY Message.CreateDate DESC; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:08:59.547

它应该是：

```
CREATE PROCEDURE dbo.StoredProcedure2
AS  -- you were missing this

SELECT  -- you had an extra comma here
    Announcements.ID
,   Announcement.CreateDate
,   Announcements.Announcement
,aspnet_Users.UserName 
,(SELECT Announcement_Read_State.Read_Date 
    FROM Announcement_Read_State 
    WHERE Announcement_Read_State.Announcement_ID = Announcements.ID 
    AND Announcement_Read_State.User_ID = 2) AS ReadState 
FROM Announcements INNER JOIN aspnet_User ON Announcements .Sender_User_ID = aspnet_User.UserName 
WHERE (Announcements.ID IN 

        ( SELECT Max(Announcements.ID) 
        FROM Thread_Participant INNER JOIN Announcements ON 
        Thread_Participant.ThreadId = Announcements.Announcement_ThreadId 
        WHERE MessageThreadParticipant.UserID = 2 
        GROUP BY ThreadParticipant.AnnouncementThreadId
        )
)-- you were missing this one

 ORDER BY Message.CreateDate DESC; 
```

# javascript - 如何使用可调整大小的元素重叠其他元素？

> ID：11836673
> 
> 赞同：0
> 
> 时间：2012-08-06T22:07:45.673
> 
> 标签：javascript, jquery, css, jquery-ui-resizable

如何防止可调整大小的 div 被相邻元素重叠？我将可调整大小的 div 的 z-index 更改为 1，其余为 0。

这个例子马上就清楚了：http: [//jsfiddle.net/gALUP/1/](http://jsfiddle.net/gALUP/1/)

**HTML**

```
<div id='grid'>
    <div class='outline'>
        <div class='container resizable'>
        </div>    
    </div>
    <div class='outline'>
        <div class='container'>
        </div>    
    </div>
</div> 
```

**CSS**

```
.outline { 
    height: 200px;
    width: 200px;
    border: 1px solid black; 
    position: relative; 
    z-index: 0; 
    display: inline-block;
}
.container { 
    height: 100%; 
    width: 100%; 
    background-color: #ff0000;
}

.resizable { 
    background-color: #0000ff; 
    position: absolute; 
    z-index: 1; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:11:46.343

`z-index: 0`从中删除`.outline`：

```
.outline {
    height: 200px;
    width: 200px;
    border: 1px solid black;
    position: relative;
    display: inline-block;
}
.container {
    height: 100%;
    width: 100%;
    background-color: #ff0000;
}
.resizable {
    background-color: #0000ff;
    position: absolute;
    z-index: 1;
} 
```

[http://jsfiddle.net/elclanrs/gALUP/2/](http://jsfiddle.net/elclanrs/gALUP/2/)

# ajax - Magento 和 Fancybox - 阻止 CMS 内联加载

> ID：11836674
> 
> 赞同：0
> 
> 时间：2012-08-06T22:07:54.833
> 
> 标签：ajax, magento, fancybox, inline

情况：
我们的 Magento 产品页面上有几个小图标。单击一个后，会打开一个包含来自 CMS 块的内容的花式框。

问题：
fancybox 似乎没有正确“编译”块内容。magento 变量不会转换为“可读”代码。

这是代码： http:
[//pastebin.com/24qyYinD](http://pastebin.com/24qyYinD)

输出：

```
<div id="data-winddicht">
<div class`enter code here`="technologie_lightbox">
<div class="image"><img src="{{media url="wysiwyg/Technology/Wasserdicht.png"}}" alt="" /></div>
<p>LOREM TEST</p>
</div> 
```

{{media url=""}} 未转换为 html 代码。

任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:24:56.457

解决方案在这里：
magentocommerce.com/boards/viewthread/210263/#t399724

感谢 Kalpesh Mehta

代码：从

```
echo $block->getContent(); 
```

至

```
echo $this->helper('cms')->getBlockTemplateProcessor()->filter($block->getContent()); 
```

# javascript - 为什么我的函数没有按预期在文档加载时运行？

> ID：11836675
> 
> 赞同：5
> 
> 时间：2012-08-06T22:08:00.023
> 
> 标签：javascript, html, height

此代码应设置元素高度；但是没有添加任何样式。我错过了一些明显的东西吗？

```
function setGround() { 
    document.getElementById('content').style.height = '40px';
} 

document.onload = setGround; 
```

HTML 非常基础：

```
<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Template</title>
    <link rel="stylesheet" type="text/css" href="css/default.css"/>
    <link rel="stylesheet" type="text/css" href="css/orange.css"/>
    <script type="text/javascript" src="javascript/detect-css.js"></script>
</head>

<body>
    <header>
        <div id="logo"></div>
    </header>
    <section id="sidebar"><p>sf </p>
    </section>

    <section id="content"><p>sf </p>
    </section>

</body>
</html> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T22:12:50.093

不要使用`document.onload`use`window.onload`代替。

见[http://jsfiddle.net/mowglisanu/r6NzE/](http://jsfiddle.net/mowglisanu/r6NzE/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:21:53.647

你可以使用这个：

```
function setGround() { 
    document.getElementById('content').style.height = '40px';
} 
document.onload = setGround; 
```

但如果您想查看更改，您应该使用以下方法在部分标签上创建边框：

```
<section id="content" style='border:1px solid fuchsia;' >
<p>sf </p>
</section> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-24T06:26:29.087

你应该使用

```
window.onLoad = setGround; 
```

代替

```
document.onload = setGround; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:22:20.127

你把javascript代码放在哪里了？它在detect-css.js 中吗？

这有效：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Template</title>
<link rel="stylesheet" type="text/css" href="css/default.css"/>
<link rel="stylesheet" type="text/css" href="css/orange.css"/>
<script language="javascript">
function resize(){
document.getElementById("content").style.height='100px';
}
</script>
</head>

<body onload="resize()">
<header><div id="logo"></div></header>
<section id="sidebar"><p>sf </p>
</section>

<section id="content" style="background-color:#CCC; display:block;"><p>sf </p>
</section>

</body>
</html> 
```

# jquery - Jquery 滑块下一个/上一个按钮

> ID：11836681
> 
> 赞同：0
> 
> 时间：2012-08-06T22:08:44.813
> 
> 标签：jquery, slider, addclass, removeclass, appendto

我已经构建了一个滑块，我可以在其中单击图像并向前移动。我正在尝试添加“下一个”和“上一个”按钮，但遇到了麻烦。任何帮助表示赞赏！

这是我在哪里的演示...... [JSFiddle](http://jsfiddle.net/coltanious/dRGKH/11/)

```
<div id="container">

    <div class="next">Next</div>
    <div class="prev">Previous</div>

    <div id="image1" class="box">Orange</div>
    <div id="image2" class="box">Blue</div>
    <div id="image3" class="box">Green</div>
    <div id="image4" class="box">Red</div>
    <div id="image5" class="box">Yellow</div>

</div> 
```

CSS

```
body {
    padding: 0px;    
}

.next {
    width:100px;
    height:50px;
}

.prev {
    width:100px;
    height:50px;
}

#container {
    position: absolute;
    margin: 0px;
    padding: 0px;
    width: 100%;
    height: 100%;
    overflow: hidden;

}

.box {
    position: absolute;
    width: 50%;
    height: 300px;
    line-height: 300px;
    font-size: 50px;
    text-align: center;
    left: 150%;
    top: 100px;
    margin-left: -25%;
}

#image1 {
    background-color: orange;
    left: 50%;
}

#image2 {
    background-color: blue;
}

#image3 {
    background-color: green;
}

#image4 {
    background-color: red;
}

#image5 {
    background-color: yellow;
} 
```

查询

```
$('.box').click(function() {

$(this).animate({
    left: '-50%'
}, 500, function() {
    $(this).css('left', '150%');
    $(this).appendTo('#container');
});

$(this).next().animate({
    left: '50%'
}, 500);
});​ 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:38:07.470

嘿，看看这个：http: [//jsfiddle.net/Dwxfc/](http://jsfiddle.net/Dwxfc/)

这应该符合您的需要，`:)`还要注意上面的示例只有下一个功能，因此它会重复自己。

休息希望它适合您的需要，如果不适合，请让我知道。`B-)`

**代码**

```
$(function(){

    //Lazyload function
    $.fn.lazyload = function(){
        var image = $(this);
        if (image.attr('real-src')){
            image.attr('src', image.attr('real-src'));
            image.removeAttr('real-src');
        }
        return this;
    };

    //Slider constructor
    $.fn.imageSlider = function(){
        this.each(function(){
            var $slider = $(this);

            var $active = $slider.find('img:first');
            $active.addClass('active');
            $active.lazyload();

            //Slider control buttons
            var $nextButton = $slider.find('.next');
            var $prevButton = $slider.find('.previous');

            $prevButton.toggle();

            //Handle if next button should appear
            $nextButton.click(function(){
                var $next = $active.next();
                $active.removeClass('active');
                $next.addClass('active');
                $active = $next;
                $active.lazyload();

                if ($active.next().length == 0){
                    $nextButton.toggle();
                }
                $prevButton.show();

            })

            //Handle if next button should appear
            $prevButton.click(function(){
                var $prev = $active.prev();
                $active.removeClass('active');
                $prev.addClass('active');
                $active = $prev;
                $active.lazyload();

                if ($active.prev().length == 0){
                    $prevButton.toggle();
                }
                $nextButton.show();
            })
        })

            return this;
        };

})

$(document).ready(function(){
    var $slider = $('#slider');
    if ($slider.find('.active').length == 0){
        $slider.imageSlider();
    }
})
​ 
```

**HTML**

```
<div id="slider" class="slider_container">
    <center>
        <a href="#" class="previous"> Previous &lt; </a>
        <a href="#" class="next"> Next &gt; </a>
        <img class="slider_image" src="http://www.appelsiini.net/projects/lazyload/img/grey.gif" real-src="http://ultradownloads.com.br/conteudo/Joyce/para_nossa_alegria_cartoon.jpg">
        <img class="slider_image" src="http://www.appelsiini.net/projects/lazyload/img/grey.gif" real-src="http://www.oesquema.com.br/trabalhosujo/wp-content/uploads/2012/03/para-nossa-alegria-pan.jpg">
        <img class="slider_image" src="http://www.appelsiini.net/projects/lazyload/img/grey.gif" real-src="http://youpix.com.br/wp-content/uploads/2012/03/para-nossa-alegria-uhu.jpg">
        <img class="slider_image" src="http://www.appelsiini.net/projects/lazyload/img/grey.gif" real-src="http://2.bp.blogspot.com/-dcgzVluf0is/T2z1K0GbVgI/AAAAAAAAMIU/yVXoH4IHV5M/s1600/para-nossa-alegria.jpg">
        <img class="slider_image" src="http://www.appelsiini.net/projects/lazyload/img/grey.gif" real-src="http://desordempublica.com.br/wp-content/uploads/2012/03/sexta-para-nossa-alegria.jpg">
    </center>
</div>

​ 
```

**CSS**

```
.slider_container {
    position: relative;
}

.slider_container img {
    display:none;
}

.slider_container img.active {
    display:block;
}
​ 
```

# php - Mysql order by rand PHP

> ID：11836689
> 
> 赞同：0
> 
> 时间：2012-08-06T22:09:41.490
> 
> 标签：php, mysql

我在用

```
$nameimg = mysql_query("SELECT * 
                        FROM images 
                        WHERE id='".$row['imgID']."' 
                        ORDER BY RAND()    
                        LIMIT 10"); 
```

显示所述用户的随机图像，但不显示随机图像。它只是通过提交的时间显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:14:34.173

`WHERE`条件检查 ID 通常会将结果集减少到一行，因此整个`ORDER BY`子句变得无用。

您应该考虑您的架构并重新设计查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:21:02.820

您应该使用 PHP 随机打乱数组。如果您感兴趣的领域被称为`url`：

```
$req = mysql_query("SELECT url FROM images WHERE user_id = '{$row['userID']}'");
$images = array();
while($image = mysql_fetch_array($req)) {
    $images[] = $image['url'];
}
shuffle($images);
$tenImages = array_slice($images, 0, 10); 
```

**编辑。**请考虑将 PDO 用于[准备好的语句](http://php.net/manual/en/pdo.prepare.php)。

**更新。**为什么不一次选择十张图片呢？

```
$images = array();
while(count($images) < 10) {
    $req = mysql_query("SELECT url FROM images WHERE user_id = '{$row['userID']}' LIMIT " . rand(1, 10000) . ", 1");
    $image = mysql_result($req, 0, 0);
    if(!in_array($image)) {
        $images[] = $image;
    }
} 
```

**更有趣（更快）的方式。**[在这里](http://www.titov.net/2005/09/21/do-not-use-order-by-rand-or-how-to-get-random-rows-from-table/)提供。

```
$ids = array();
for($i = 0 ; $i < 1000 ; $i++) {
    $ids[] = rand(1, 10000);
}
$req = mysql_query("SELECT url FROM images WHERE user_id = '{$row['userID']}' AND id IN (" . implode(',', $ids) . ") LIMIT 10"); 
```

# .net - 为什么不作为导航属性引入自引用外键

> ID：11836691
> 
> 赞同：2
> 
> 时间：2012-08-06T22:09:54.110
> 
> 标签：.net, entity-framework, entity-framework-4, linq-to-entities

我们有一个表，其中包含一个返回到自身的 FK。

`Jobs.SecondaryJobKey``Jobs.Key`是同表中的 FK 。

创建这个 FK 后，我们在设计器中执行了“从数据库更新...”（是的，我知道，我们想先移动到代码但还没有）关联没有创建，所以导航属性当然也没有.

这是创建 FK 的 T-SQL：

```
ALTER TABLE [dbo].[Jobs]  WITH CHECK ADD  CONSTRAINT [FK_Jobs_SecondaryJobKey] FOREIGN KEY([SecondaryJobKey])
REFERENCES [dbo].[Jobs] ([Key]) 
```

为什么会发生这种情况？我们是否违反了一些未知的规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T21:15:59.357

看来这在为测试而创建的干净数据库中应该可以正常工作。有问题的数据库似乎存在某种类型的损坏，使我们无法正确添加 FK.... 我希望这会使 EF 无法看到它。

# iphone - 不断推送视图控制器

> ID：11836695
> 
> 赞同：0
> 
> 时间：2012-08-06T22:10:18.980
> 
> 标签：iphone, objective-c, uiviewcontroller, ios5.1

我正在尝试制作一个导航控制器，当旋转到横向时，它会将新视图推送到堆栈上，当旋转回纵向时，它会弹出该视图。到目前为止，我可以显示横向视图，但只有当我可以通过将该视图控制器再次推送到堆栈上来恢复纵向视图时。我假设如果用户连续来回旋转，堆栈将耗尽内存。当我尝试使用 popToViewController 时，没有任何反应。有人可以帮我让 pop 功能正常工作吗？

此方法在我的 ViewController 类中：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if(toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft ||
       toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
    {
        AppDelegate *delegate =
        (AppDelegate *)[[UIApplication sharedApplication] delegate];

        Landscape *landScape=
        [[Landscape alloc] initWithNibName:@"Landscape" bundle:nil];

        [delegate.navController pushViewController:landScape animated:YES];
    }
} 
```

此方法在我的 Landscape 类中：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if(toInterfaceOrientation == UIInterfaceOrientationPortrait ||
            toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown)
    {
        AppDelegate *delegate =
        (AppDelegate *)[[UIApplication sharedApplication] delegate];

        ViewController *viewController=
        [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];

        [delegate.navController pushViewController:viewController animated:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:13:44.827

`[delegate.navController popViewControllerAnimated:YES];`看来您的 ViewController 应该已经在堆栈上，因此您应该能够通过调用而不是调用来取回它`[delegate.navController pushViewController:viewController animated:YES];`

# java - 如果无效，则删除 JTextField 中的最后一次击键

> ID：11836699
> 
> 赞同：1
> 
> 时间：2012-08-06T22:10:29.963
> 
> 标签：java, swing, jframe, jtextfield

在我的第一个程序上工作。我想出了如何识别我不想输入的字符。我想知道如何删除输入的最后一个字符，以便从用户的角度来看，它会显示为只能输入数字。

```
@Override
public void keyPressed(KeyEvent e) {
    char keyChar = e.getKeyChar();;
    char[] badCharArray = "abcdefghijklmnopqrstuvwxyz-`~!@#$%^&*()[]{}<>_+=|\"':;?/ ".toCharArray();
        for (int i = 0; i < badCharArray.length; i++) {
            if (badCharArray[i] == keyChar) {
                System.out.print(badCharArray[i] + " bad\n");
                hourlyWageInput.setBackground(Color.RED);
                } 
            }
        } 
```

谢谢。 ![在此处输入图像描述](../Images/d8de62dc5040d230b00cd769931e77c7.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T22:11:05.393

最简单的方法是使用 JFormattedTextField 而不是 JTextField。

```
NumberFormat format = NumberFormat.getNumberInstance();
format.setMinimumFractionDigits(2); // eventually maximum fraction digits

JFormattedTextField fld = new JFormattedTextField(format); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T22:45:44.093

`keyListener`在这种情况下，您应该避免使用 s。如果用户将文本粘贴到字段中会发生什么。将`keyListener`不会收到通知，允许插入无效字符。

您最好使用[DocumentFilter](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DocumentFilter.html)过滤掉您不想要的任何无效字符。

查看[实现 DocumentFilter](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)以获取更多信息，并[查看 DocumentFilter](http://www.jroller.com/dpmihai/entry/documentfilter)以获取一些不错的示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T22:13:50.753

只需将其文本设置为当前文本，在插入符号位置之前没有字符

* * *

```
 @Override
    public void keyReleased(KeyEvent paramKeyEvent) {
        char keyChar = paramKeyEvent.getKeyChar();
        char[] badCharArray = "abcdefghijklmnopqrstuvwxyz-`~!@#$%^&*()[]{}<>_+=|\"':;?/ ".toCharArray();
            for (int i = 0; i < badCharArray.length; i++) {
                if (badCharArray[i] == keyChar) {
                    int caret = field.getCaretPosition()-1;
                    System.out.print(badCharArray[i] + " bad\n");
                    field.setText(field.getText().substring(0, caret) + 
                            field.getText().substring(caret+1));
                    field.setCaretPosition(caret);
                    } 
            }
    } 
```

把它设置为红色，就好像你要自动更正它一样，在那里没有意义（也许将它设置为显示红色一秒钟？）

* * *

实际上，唯一的问题是，如果他们持有无效的密钥，它只会删除最后一个；以下应该工作得更好，并且不会改变插入符号：P

```
 boolean held = false;
        private int oldCaret = 1;
        @Override
        public void keyPressed(KeyEvent e) {
            if(! held) {
                oldCaret=field.getCaretPosition();
                System.out.println(oldCaret);
            }
            held = true;

        }
        @Override
        public void keyReleased(KeyEvent paramKeyEvent) {
            char keyChar = paramKeyEvent.getKeyChar();
            char[] badCharArray = "abcdefghijklmnopqrstuvwxyz-`~!@#$%^&*()[]{}<>_+=|\"':;?/ ".toCharArray();
            for (int i = 0; i < badCharArray.length; i++) {
                if(field.getText().contains(badCharArray[i]+"")) {
                    field.setText(field.getText().replace(badCharArray[i]+"", ""));
                    field.setCaretPosition(oldCaret);
                }
            }

            held=false;
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T02:43:03.627

下面是 JTextField 的创建：

```
hourlyWageInput = new JTextField("7.25");
DocumentFilter filter = new UppercaseDocumentFilter();
((AbstractDocument) hourlyWageInput.getDocument()).setDocumentFilter(filter);
hourlyWageInput.setHorizontalAlignment(JTextField.CENTER);
add(hourlyWageInput); 
```

这是我的文档过滤器：

```
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;

public class UppercaseDocumentFilter extends DocumentFilter {

     public void replace(DocumentFilter.FilterBypass fb, int offset, int length,
          String text, javax.swing.text.AttributeSet attr)

          throws BadLocationException {
               fb.insertString(offset, text.replaceAll("\\D", ""), attr);   
     }
} 
```

这有效，自动从 JTextField 中删除所有字母和字符。所以谢谢你，这肯定是最好的。

但是，我想知道是否有人知道所有命令都类似于“\D”的地方。我花了一段时间才找到正确的信息。

此外，我现在拥有的代码也可以防止 . 不是我在使用双打时需要的类型。有任何想法吗？

感谢所有的帮助，今天我学到了很多东西。连续编码 13 小时。

# windows - 回显到文件时 Ant 不会创建 NL

> ID：11836703
> 
> 赞同：4
> 
> 时间：2012-08-06T22:10:47.063
> 
> 标签：windows, macos, windows-7, file-io, ant

我最初有这个：

```
<echo file="${my.file}"
     message="This is line #1"/>
<echo file="${my.file}"
     append="true"
     message="This is line #2"/>
<echo file="${my.file}"
     append="true"
     message="This is line #3"/> 
```

并在我的文件中得到了这个：

```
 This is line#1This is line #2This is line#3 
```

所以，我尝试了：

```
 <echo file="${my.file}">
     This is line #1
     This is line #2
     This is line #3
 </echo> 
```

并得到：

```
 This is line#1This is line #2This is line#3 
```

我这样做了：

```
 <echo file="${my.file}">
     This is line #1${line.separator}
     This is line #2${line.separator}
     This is line #3${line.separator}
 </echo> 
```

并得到：

```
 This is line#1This is line #2This is line#3 
```

我这样做了：

```
 <echo file="${my.file}">
     This is line #1&#13;&#10;
     This is line #2&#13;&#10;
     This is line #3&#13;&#10;
 </echo> 
```

并得到：

```
 This is line#1This is line #2This is line#3 
```

我什至试过这个：

```
 <concat destfile="${my.file}">
     This is line #1&#13;&#10;
     This is line #2&#13;&#10;
     This is line #3&#13;&#10;
 </concat> 
```

仍然得到：

```
 This is line#1This is line #2This is line#3 
```

如果我对控制台执行任何这些操作，它会打印在单独的行上。将它们保存到文件中，并且这些行不显示。

我在 Win7，Ant 1.8 上。

有任何想法吗？

* * *

## 窗户的东西？

我已经在我的 Mac 上尝试了这些。第一个给了我同样的结果。但是，第二种方式在文件中给了我三行。添加的第三种方式`${line.separator}`每隔一行跳过。使用的第四种方式`&#13;&10;`给了我在最后的每一行`^M`（毕竟，Mac 是 Unix，不使用 CRLF 结尾，而只是 LF）。

并且，使用`<concat>`还创建了单独的行。

* * *

## 更多信息

我已将问题追溯到我的`build.xml`文件中的以下代码段：

这如宣传的那样工作。也就是说，空白并`NL`显示在结果文件中：

```
<target name="package"
    depends="-resolve,compile"
    description="Packaging of the artifact">

    <!-- Build version.txt and let the user figure out how to use it -->
    <mkdir dir="${target.dir}"/>
    <echo file="${version.file}">
        Jenkins Project: ${env.JOB_NAME}
        Jenkins Build Number: ${env.BUILD_NUMBER}
        Build Date: ${build.date}
    </echo>

    <!--
    <antcall target="jar"/>
    <antcall target="war"/>
    <antcall target="ear"/>
    -->
</target> 
```

这不会：

```
<target name="package"
    depends="-resolve,compile"
    description="Packaging of the artifact">

    <!-- Build version.txt and let the user figure out how to use it -->
    <mkdir dir="${target.dir}"/>
    <echo file="${version.file}">
        Jenkins Project: ${env.JOB_NAME}
        Jenkins Build Number: ${env.BUILD_NUMBER}
        Build Date: ${build.date}
    </echo>

    <antcall target="jar"/>
    <antcall target="war"/>
    <antcall target="ear"/>
</target> 
```

这些片段之间的唯一区别在于我在`<antcall>`编写文件之后执行了三个任务。这三个 antcall 任务都有一个`if`子句，因此它们可能会或可能不会根据设置的属性运行。这是我们开发团队的构建模板，所以我真的很想让它工作。

为什么`<antcall>`' 会引起问题。顺便说一句，有时它太坏了，我需要重新打开一个新的控制台窗口才能让这些`NL`东西正常工作。

我之前遇到过类似的问题，这是一个 Windows 代码页问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:44:25.190

下面的 Ant 项目使用该`echo`任务创建了四个文件：

*   回声1.txt
*   回声2.txt
*   回声3.txt
*   回声4.txt

当项目使用 Ant 1.8.x 在 Windows 7 上运行时，每个文件的 hex 视图如下：

```
// echo1.txt
// HEX                         // TEXT
6c 69 6e 65 20 23 31           line #1
6c 69 6e 65 20 23 32           line #2
6c 69 6e 65 20 23 33           line #3

// echo2.txt
// HEX                         // TEXT
6c 69 6e 65 20 23 31 0a        line #1  (0a => line feed)
6c 69 6e 65 20 23 32 0a        line #2
6c 69 6e 65 20 23 33 0a        line #3

// echo3.txt
// HEX                         // TEXT
6c 69 6e 65 20 23 31 0d 0a 0a  line #1  (0d => carriage return)
6c 69 6e 65 20 23 32 0d 0a 0a  line #2
6c 69 6e 65 20 23 33 0d 0a 0a  line #3

// echo4.txt
// HEX                         // TEXT
6c 69 6e 65 20 23 31 0d 0a     line #1
6c 69 6e 65 20 23 32 0d 0a     line #2
6c 69 6e 65 20 23 33 0d 0a     line #3 
```

只有 echo4.txt [将所有三行放在由`message`分隔的属性中`${line.separator}`] 会在 Windows 上产生正确的行结尾（回车 + 换行）。在记事本（使用回车 + 换行）以及保留 Unix 换行符的编辑器（单换行）中编辑项目文件时，输出是相同的。看来，当 Ant 解析 XML 文件时，行尾被规范化为单个换行符。

## 蚂蚁计划

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="echo-project" basedir="." default="echo-all">

  <target name="echo-test1">
    <property name="echo1.file" location="${basedir}/echo1.txt" />
    <echo file="${echo1.file}" message="line #1" />
    <echo file="${echo1.file}" message="line #2" append="true" />
    <echo file="${echo1.file}" message="line #3" append="true" />
  </target>

  <target name="echo-test2">
    <property name="echo2.file" location="${basedir}/echo2.txt" />
    <echo file="${echo2.file}">line #1
line #2
line #3
</echo>
  </target>

  <target name="echo-test3">
    <property name="echo3.file" location="${basedir}/echo3.txt" />
    <echo file="${echo3.file}">line #1${line.separator}
line #2${line.separator}
line #3${line.separator}
</echo>
  </target>

  <target name="echo-test4">
    <property name="echo4.file" location="${basedir}/echo4.txt" />
    <echo file="${echo4.file}" message=
"line #1${line.separator}line #2${line.separator}line #3${line.separator}" />
  </target>

  <target name="echo-all"
      depends="echo-test1, echo-test2, echo-test3, echo-test4" />
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:12:55.223

您是否尝试过`\n`作为线路断路器？

# php - facebook在CodeIgniter中连接php sdk问题

> ID：11836704
> 
> 赞同：0
> 
> 时间：2012-08-06T22:10:51.770
> 
> 标签：php, facebook, codeigniter-2

我在使用 facebook connect php 库时遇到问题。基本上在返回 url 上我的用户是 0。这是我的代码：

```
public function facebook_login()
{
    $params = array(
        'appId' => 'XXXX',
        'secret' => 'XXXX',
        'cookie' => TRUE
    );
    $facebook = $this->load->library('facebook', $params);

    $user = $facebook->getUser();

    if (empty($user))
    {
        $url = $facebook->getLoginUrl(array(
            "redirect_uri" => site_url('/auth/facebook/connect') 
                ));
        header("Location: $url"); 
        exit; 
    }
}

public function facebook_connect()
{
    $params = array(
        'appId' => 'XXXX',
        'secret' => 'XXXX',
        'cookie' => TRUE
    );
    $facebook = $this->load->library('facebook', $params);

    $user = $facebook->getUser();

    print_r($user);die;
} 
```

$user 在返回 url 上始终为 0。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T13:34:55.300

去`config/config.php`更换；

```
$config['enable_query_strings'] = False; 
```

和

```
$config['enable_query_strings'] = TRUE; 
```

刷新并看到**魔法**
希望它有帮助！

# php - 如何检查一个数组与另一个数组并返回单个最高匹配？

> ID：11836706
> 
> 赞同：0
> 
> 时间：2012-08-06T22:10:56.490
> 
> 标签：php, arrays

我的网站上有很多不同标签的文章。目前我只对这 4 个标签感兴趣：

```
Dog
Camel
Bear
Cat 
```

如果一篇文章有​​任何这些标签，我想显示它。如果一篇文章有​​ 2 个或更多这些标签，我希望返回更多位于顶部的标签。例如，如果一篇文章同时具有 Bear 和 Cat 标签，则应返回 Bear。

到目前为止我的代码：

```
function determine_tag($tags) {
    $weights = array(
        'Dog',
        'Camel',
        'Bear',
        'Cat'
    );

    $matches = array();

    foreach($tags as $tag) {
        if(in_array($tag, $weights)) {
            $matches[] = $tag;
        }
    }

    var_dump($matches); // returns array (Cat, Dog)
}

$tags = array('Cat', 'Floating', 'Dog', 'lol', 'Article');
echo determine_tag($tags); 
```

我认为它的效率不是很高，而且它只返回匹配的标签，它不会只返回权重最高的标签。怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:13:55.530

`$tag = array_shift(array_intersect($weights, $tags));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:15:35.113

我会使用 array_intersect，然后只查看匹配数组中的第一个值。像这样：

```
function determine_tag($tags) {
    $weights = array(
        'Dog',
        'Camel',
        'Bear',
        'Cat'
    );

    $matches = array_intersect($weights, $tags);

    if (count($matches) > 0) {
       $top_match = $matches[0];
    }
} 
```

# ios - 如何在按钮单击时加载 UITabBarcontroller 中的第二个选项卡..？

> ID：11836710
> 
> 赞同：2
> 
> 时间：2012-08-06T22:11:13.413
> 
> 标签：ios, uiviewcontroller, uitabbarcontroller, uitabbar

我有一个首字母`UIViewController`。我有两个按钮`UIViewController`，一个是`Tutorial`，另一个是`Start`。

当我单击时，`Tutorial`我将导航到默认（第一个）选项卡`UITabBarController`在哪里。`Tutorial`我对此没有任何问题。我通过按住并右键单击并拖动到`UITabBarController`并选择模式来完成。

但是当我单击`Start`按钮时，我将不得不导航到`UITabBarController`. 如何才能做到这一点？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:19:26.387

只需将该`UITabBarController.selectedIndex`属性设置为您要使用的选项卡的索引。

# ruby-on-rails - 用于 Rails 查询的 ActiveRecord

> ID：11836716
> 
> 赞同：0
> 
> 时间：2012-08-06T22:11:40.140
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

我正在尝试在 Rails 的 ActiveRecord 中进行以下查询。

```
SELECT * FROM test_run WHERE build = '$build' AND suite='$suite'AND (result = 'fail' OR     result = 'error') 
    AND test_name NOT IN(SELECT test_name FROM test_run WHERE result = 'pass' AND   build  = '$build')GROUP BY test_name"; 
```

第一部分很简单，我不知道如何做子查询。

```
scope :never_passed, lambda { |b| where(:build => b, :status => 'fail').where(??) 
```

关于我需要做什么才能让这个子查询像上面的 sql 一样工作的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:33:26.130

感谢 Arel，您可以执行以下子查询：

```
TestRun.where(:test_name => TestRun.where('result != ? && build != ?','pass','somevalue').select('test_name')).to_sql 
```

将输出以下 SQL：

```
SELECT `test_runs`.* FROM `test_runs` WHERE `test_runs`.`test_name` IN ('test1','test2') 
```

# javascript - 如何“重置”点击事件（使用 qtip2）？

> ID：11836719
> 
> 赞同：2
> 
> 时间：2012-08-06T22:11:53.190
> 
> 标签：javascript, jquery, qtip2, dajax

我对点击事件和qtip2有一点疑问。

在第一次点击 element 之后`$j('a[href^="/i/"]')`，当我再次在它上面移动时，会出现气泡。我希望每次单击元素时都会出现气泡。

我的代码：

```
$j('a[href^="/i/"]').click(function(event) { 
        event.preventDefault(); 
        $j(this).qtip({
            content: {
                title: {
                    text: title_qtip,
                    button: true,
                },
                text: text_qtip,                
            },
            show: { 
                //  event: false,   <-- doesn't work
                solo: true,
                ready: true 
            },
            hide: false,
        });   
       // $j('a[href^="/i/"]').unbind('click');    <-- doesn't work
       // $j('a[href^="/i/"]').unbind('onmouseover').unbind('onmouseout');   <-- doesn't work
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:00:03.637

首先，不要在事件处理程序中声明您的 qTip2 函数。您不想在每次单击对象时声明一个新的 qTip。您所要做的就是更改 show 函数中的事件行。它应该是：

```
$j(document).ready(function(){

     $j('//selector').qtip({
        content: {
            title: {
                text: title_qtip,
                button: true,
            },
            text: text_qtip,                
        },
        show: { 
            event: 'click',   
            solo: true,
            ready: true 
        },
        hide: false,
    });   
} 
```

这将在单击选择器 ( ) 时触发工具提示`$j(//your selector)`。

这是一个更新的小提琴：http: [//jsfiddle.net/LJwLh/1101/](http://jsfiddle.net/LJwLh/1101/)

看来您的问题是`a`标签的使用。如果您不打算链接到任何内容，则没有理由使用该标签。

# regex - 文本变量中模式的 Bash 脚本 grep

> ID：11836720
> 
> 赞同：2
> 
> 时间：2012-08-06T22:12:11.633
> 
> 标签：regex, string, bash, grep

我有一个包含文本的变量；我可以将它回显到标准输出，所以我认为这个变量很好。我的问题是尝试在该文本变量中查找模式。这是我正在尝试的：

```
ERR_COUNT=`echo $VAR_WITH_TEXT | grep "ERROR total: (\d+)"` 
```

当我回显 $ERR_COUNT 时，变量似乎为空，所以我一定做错了什么。

如何正确执行此操作？谢谢。

编辑-只是想提一下，在变量中的示例文本上测试该模式确实给了我一些东西（我测试过：[http](http://rubular.com) ://rubular.com ）

然而，正则表达式仍然可能是错误的。

EDIT2 - 还没有得到任何结果，所以这是我正在使用的字符串：

`ALERT line125: Alert: Cannot locate any description for 'asdf' in the qwer.xml hierarchy. (due to (?i-xsm:\balert?\b) ALERT in ../hgfd.controls) ALERT line126: Alert: Cannot locate any description for 'zxcv' in the qwer.xml hierarchy. (due to (?i-xsm:\balert?\b) ALERT in ../dfhg.controls) ALERT line127: Alert: Cannot locate any description for 'rtyu' in the qwer.xml hierarchy. (due to (?i-xsm:\balert?\b) ALERT in ../kjgh.controls) [1] 22280 IGNORE total: 0 WARN total: 0 ALERT total: 3 ERROR total: 23 [1] + Done /tool/pandora/bin/gvim -u NONE -U NONE -nRN -c runtime! plugin/**/*.vim -bg ...`

那是字符串，所以希望不再有歧义......我想将数字“23”（在“ERROR total:”之后）提取到一个变量中，我很难过哈哈。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T02:49:11.473

您可以使用 bash 的`=~`运算符来提取值。

```
[[ $VAR_WITH_TEXT =~ ERROR\ total:\ ([0-9]+) ]] 
```

请注意，您必须转义空格，或者只引用正则表达式的固定部分：

```
[[ $VAR_WITH_TEXT =~ "ERROR total: "([0-9]+) ]] 
```

因为引用任何元字符会导致它们被逐字处理。

您还可以将正则表达式保存在变量中：

```
regex="ERROR total: ([0-9]+)"
[[ $VAR_WITH_TEXT =~ $regex ]] 
```

无论如何，一旦表达式匹配，括号中的表达式可以在`BASH_REMATCH`数组中找到。

```
ERR_COUNT=${BASH_REMATCH[1]} 
```

（第零个元素包含整个匹配的正则表达式；括号中的子表达式按照它们在完整正则表达式中出现的顺序在其余元素中找到。）

* * *

如果你想使用`grep`，你需要一个可以接受 Perl 风格正则表达式的版本。

```
ERR_COUNT=$( echo "$VAR_WITH_TEXT" | grep -Po "(?<=ERROR total: )\d+" ) 
```

只要你需要使用 Perl 风格的正则表达式来启用后向断言，你可以`[0-9]`用`\d`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:30:57.523

您的错误在模式中：`(\d+)`匹配：

*   `'('`
*   一个数字
*   `'+'`
*   `')'`

根据您的评论，您想要的是`\(\d\+\)`：

*   定义一个子模式`\( ... \)`
    *   里面至少匹配一个 ( `\+`) 数字 ( `\d`)。

在这种情况下，如果您不需要子模式，您可以删除`\(`and `\)`。

注意：如果您`grep`不明白`\d`，可以将其替换为`[0-9]`。最简单的方法是`grep '\d'`通过编写几行测试来编写和测试它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T22:27:13.647

```
# setting example data
    test="adfa\nfasetrfaqwe\ndsfa ERROR total: 32514235dsfaewrf" 
```

**一种解决方案：**

```
echo $(sed -n 's/^.*ERROR total: \([0-9]*\).*$/\1/p' < <(echo $test))
32514235 
```

**其他解决方案：**

```
# throw away everything up to "ERROR total: "
test=${test##*ERROR total: } 
# cut from behind assuming number contains no spaces and is
# separated by space
test=${test%% *}
echo $test
32514235 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T22:30:02.577

可能仅在 perl 正则表达式模式下`\d`被识别为数字，您可能想要使用`grep -P`.

如果您只想要您可以尝试的号码：

`ERR_COUNT=$(echo $VAR_WITH_TEXT | perl -pe "s/.*ERROR total: (\d+).*/\1/g")`

或者：

`ERR_COUNT=$(echo $VAR_WITH_TEXT | sed -n "s/.*ERROR total: ([0-9]+).*/\1/gp")`

# jquery - 可以在不滚动所有 div 的情况下滑入下一个 div 吗？

> ID：11836721
> 
> 赞同：0
> 
> 时间：2012-08-06T22:12:13.940
> 
> 标签：jquery

刚刚使用选项卡完成滚动 div，但试图找出一种制作方法，例如，您单击链接 4，而不是脚本滚动浏览所有 div 以到达数字 4，我希望它滚动出 div1 和在 div4 中滚动

js小提琴：http: [//jsfiddle.net/cC4tU/1/](http://jsfiddle.net/cC4tU/1/)

jQuery

```
$.extend($.easing,
 {
     easeInOutQuad: function (x, t, b, c, d) {
        if ((t/=d/2) < 1) return c/2*t*t + b;
        return -c/2 * ((--t)*(t-2) - 1) + b;
    },
    easeInOutElastic: function (x, t, b, c, d) {
        var s=1.70158;var p=0;var a=c;
        if (t==0) return b;  if ((t/=d/2)==2) return b+c;  if (!p) p=d*(.3*1.5);
        if (a < Math.abs(c)) { a=c; var s=p/4; }
        else var s = p/(2*Math.PI) * Math.asin (c/a);
        if (t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;
        return a*Math.pow(2,-10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )*.5 + c + b;
    }

    });
//EXPAND PAGE DIV CONTENT
$(".tab_item").hover(function(){
         var background = $(this).parent().find(".moving_bg");
        $(background).stop().animate({
            left: $(this).position()['left']
        }, {
            duration: 700, easing: 'easeInOutElastic'
        });
    });

var TabbedContent = {
    init: function() {    
        $(".tab_item").click(function() {
            var background = $(this).parent().find(".moving_bg");
            $(background).stop().animate({
                left: $(this).position()['left']
            }, {
                duration: 500
            });
            TabbedContent.slideContent($(this));
        });
    },

    slideContent: function(obj) {
        var margin = $(obj).parent().parent().find(".slide_content").width();
        margin = margin * ($(obj).prevAll().size() - 1);
        margin = margin * -1;
        $(obj).parent().parent().find(".tabslider").stop().animate({
            marginLeft: margin + "px"
        }, {
            duration: 1500, easing: 'easeInOutQuad'
        });
    }
}
TabbedContent.init(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:03:07.857

Dwhizz，你想要的当然是可能的。

我不会为你写它，但据我所知，所有更改都将在`slideContent`.

战略 ：

*   隐藏除当前和新的所有 tabslider 元素
*   根据两个可见项计算边距
*   动画（可能没有变化）
*   下次记住当前的 tabslider 元素。

# java - 在 Java 应用程序中强制定期执行周期性任务

> ID：11836726
> 
> 赞同：1
> 
> 时间：2012-08-06T22:12:38.110
> 
> 标签：java, multithreading, scheduling

ScheduledExecutorService 似乎有一个问题，即如果它无法获得空闲线程，则定期任务将延迟发生。对我来说不幸的是，分配给它的定期任务确实需要按计划进行。目前它被安排为每分钟一次，但有时由于应用程序正忙于其他事情（我认为这就是原因），它未能在五分钟内完成，而五分钟恰好是“主要生产错误”阈值。

如何通过优先级或以其他方式控制线程平衡器来强制执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:19:52.073

如果您的 ScheduledExecutorService 用于其他任务，或者您的任务有时需要超过 1 分钟才能运行，您可以简单地增加 ScheduledExecutorService 中可用的线程数。因此，如果一项任务尚未完成运行，执行程序仍然可以运行新的任务。

```
ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(10); 
```

（我随机选择了 10 个 - 如果您每分钟运行一次任务并且它最多可以运行 5 分钟，那么这会给您留下一些错误余地）

# c# - C# 应用程序在其他计算机上不起作用

> ID：11836727
> 
> 赞同：1
> 
> 时间：2012-08-06T22:12:38.560
> 
> 标签：c#, ioexception

为什么我用 C# 编译的应用程序不能在其他计算机上运行？

我已经安装了 .Net Framework 4.0。

当我`.exe`在另一台计算机上打开我的时，我收到错误：

```
ERROR SIGNATURE:

    Event Type: clr20r3  
    P1:         myapp.exe 
    P2:         1.0.0.0
    P3:         502051f 
    P4:         myapp 
    P5:         1.0.0.0 
    P6:         502051f 
    P7:         2 
    P8:         6 
    P9:         System.IO.FileNotFoundException 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:16:05.113

A`system.io.filenotfoundexception`通常意味着您的程序试图打开一个不存在的文件。您的程序可能正在尝试使用不存在或位于其他计算机上的不同位置的路径或文件名来访问某些文件。不知道该怎么`myapp.exe`做，我不能再回答了。

您的解决方案可能是重新编写您的应用程序，以便它以某种方式更好地处理该异常，例如在尝试打开文件之前检查文件是否存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:16:49.840

在我看来，这听起来像是缺少参考资料的情况。从解决方案资源管理器中检查您的引用或进入 bin/debug 或 bin/release（取决于您的配置）并确保复制您的项目所依赖的所有 dll 或 exe

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T21:05:39.880

我遇到了完全相同的问题，并且像 Joao 一样最终发现它是由 Windows 窗体 LineShape 引起的。这会将 Microsoft.VisualBasic.PowerPacks 引用添加到您的项目中。然后，当您在未安装 PowerPacks 的系统上运行它时，您只会收到无用的 System.IO.FileNotFoundException 错误，而无法知道丢失了哪个文件。

是的，我知道这应该得到解决，如果您不小心进行了正确的分发设置，这将提示用户安装......等等。但我只想能够简单地将我的 EXE 复制到另一个系统。

解决方法：从表单中删除任何 LineShapes，然后在您的引用中删除对 VisualBasic 和 VisualBasic.PowerPacks 的引用。

大卫

【使用VS2008 SP】

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:21:51.653

该应用程序很可能正在尝试加载程序集并且无法找到它

有点离题，但理想情况下，对于任何想要添加一些“未处理”异常处理以写入日志文件或事件日志的应用程序，以便您可以捕获更多异常堆栈。

通常您只会收到最后一条异常消息，而且您也看不到调用堆栈

您可以使用以下方法轻松汇总异常：

```
string RollupException(Exception ex)
{
    StringBuilder sb = new StringBuilder();

    sb.Append(ex.Message);

    while(ex.InnerException != null) 
    {
         sb.Append(Environment.Newline);
         sb.Append(ex.Message);
         ex = ex.InnerException;
    }

    return sb.ToString();
} 
```

您还可以使用`EventLog`该类写入事件日志。

这里的信息：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)

查看示例 - 记得先注册一个事件源！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T22:22:06.677

看起来您的程序缺少 DLL（或 DLL 被放错了位置）：

[http://social.msdn.microsoft.com/Forums/pl-PL/clr/thread/782217a8-46bd-4371-9915-28655d9b2c2f](http://social.msdn.microsoft.com/Forums/pl-PL/clr/thread/782217a8-46bd-4371-9915-28655d9b2c2f)

[解密 .NET clr20r3 异常参数 P1..P10](https://stackoverflow.com/questions/4052770/deciphering-the-net-clr20r3-exception-parameters-p1-p10/4053325#4053325)

解决此问题的一种简单方法是创建一个安装项目 - 然后将您的项目的依赖项捆绑到一个安装文件中。如果您使用的是 Visual Studio Express 版本，我认为该选项不可用。. .

[http://www.dreamincode.net/forums/topic/58021-deploying-ac%23-application-visual-studio-setup-project/](http://www.dreamincode.net/forums/topic/58021-deploying-a-c%23-application-visual-studio-setup-project/)

如果您非常确定缺少的是 .net 框架，以下工具将向您展示您的机器/客户端上的内容，以便您找出缺少的内容：

[http://www.asoft.be/prod_netver.html](http://www.asoft.be/prod_netver.html)

希望有帮助。

# image - 平均任意对象的形状（边界点）

> ID：11836728
> 
> 赞同：0
> 
> 时间：2012-08-06T22:12:40.183
> 
> 标签：image, opencv, image-processing, shapes

我有几个对象的图像（轮廓）。但是，我想对这些形状进行平均，并使用对象的平均形状进行进一步的形状分析。

例子：

[![平均形状](../Images/572015c43e1c7de9574261f79ce956ed.png)](https://i.stack.imgur.com/zRH3D.png)

在上图中，我堆叠了轮廓来说明我的示例。

我已经实现了以下算法的前两个步骤：

1）找到这两个对象形状的质心

2）对齐中心

3）插值对象形状

因为，我没有使用一些参数/解析方程来表示形状，我怎样才能得到插值的对象形状（即第三步）？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:28:58.520

如果您的形状没有参数形式，您可以：

*   对于每个形状，创建一个带符号的距离场，在边界内为正，在边界外为负（反之亦然）。这可以基于（例如）[距离变换](http://homepages.inf.ed.ac.uk/rbf/HIPR2/distance.htm)并在每个像素处进行评估。
*   计算有符号距离场的平均值
*   从平均场的过零计算插值形状

我认为本文描述了一种类似的方法（尽管可能更复杂）：“使用倒角距离的基于形状的插值” [http://rd.springer.com/chapter/10.1007/BFb0033762](http://rd.springer.com/chapter/10.1007/BFb0033762)，但我没有期刊访问权我当前的位置要检查。

# c# - 在 WPF 中处理大型位图图像

> ID：11836730
> 
> 赞同：0
> 
> 时间：2012-08-06T22:12:45.907
> 
> 标签：c#

我需要每秒多次处理（更改亮度、对比度等）非常大的高质量位图（通常超过 10MPx），并且每次都需要在屏幕上更新它（在 WPF 中的图像控制上）。目前我正在使用 AForge.NET 库进行非托管图像处理，但有些问题我无法解决。首先，一个操作需要大约 300 毫秒（不更新屏幕），这对我来说是不可接受的。这是示例代码：

```
UnmanagedImage _img;
BrightnessCorrection _brightness = new BrightnessCorrection();

void Load()
{
   _img = UnmanagedImage.FromManagedImage((Bitmap)Bitmap.FromFile("image.jpg"));
}

void ChangeBrightness(int val) // this method is invoked by changing Slider value - several times per second
{
   _brightness.AdjustValue = val;
   _brightness.ApplyInPlace(_img); // it takes ~300ms for image 22MPx, no screen update - just change brightness "in background"
} 
```

我没有图像处理方面的经验，但我认为它的速度不会快得多，因为它的分辨率非常高。我对吗？

另一个问题——如何有效地更新屏幕？目前我有以下（ofc 非常糟糕）的解决方案：

```
void ChangeBrightness(int val)
{
   _brightness.AdjustValue = val;
   _brightness.ApplyInPlace(_img);

    using (MemoryStream ms = new MemoryStream())
    {
        using (Bitmap b = _img.ToManagedImage())
        {
            b.Save(ms, ImageFormat.Bmp);
            ms.Seek(0, SeekOrigin.Begin);

            var bmp = new BitmapImage();
            bmp.BeginInit();
            bmp.StreamSource = ms;
            bmp.CacheOption = BitmapCacheOption.OnLoad;
            bmp.EndInit();

            MyImageControl.Source = new WriteableBitmap(bmp); // !!!
        }
    }
} 
```

如您所见，每次创建新的 WriteableBitmap 时（您可以想象会发生什么）。而不是这些“使用”，我尝试了这种方式：

```
 WriteableBitmapSource.Lock(); // this object (of type WriteableBitmap) is just MVVM ViewModel's property which is binded to MyImageControl.Source
    WriteableBitmapSource.Source.WritePixels(new Int32Rect(0, 0, _img.Width, _img.Height), _img.ImageData, _img.Stride * _img.Height * 3, _img.Stride, 0, 0); // image's PixelFormat is 24bppRgb 
```

...但 WritePixels 方法抛出“值不在预期范围内”。任何想法为什么？任何帮助都感激不尽 ：）

PS AForge.NET 是一个不错的选择吗？也许有更好的图像处理库？

对不起我的英语;P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:31:49.240

图像 22MPx 约 300 毫秒，每像素约 20 ns。这应该是对的。

您需要考虑 CPU 成本和内存访问成本。

如果您想进一步改进这一点，请考虑： 1) 使用多个线程，每个线程负责位图的一部分。2) 使用 SIMD 指令编写您自己的实现。3）不要对位图进行预处理，在需要时转换位图扫描线。

# xml - ajax 函数与 if 加载 xml 数据

> ID：11836732
> 
> 赞同：1
> 
> 时间：2012-08-06T22:12:46.010
> 
> 标签：xml, ajax, if-statement

这是我第一次来这里寻求您的帮助和知识！我对 AJAX 脚本和添加“if”条件以从 XML 下载文件有疑问。

一般来说，脚本本身可以工作，但没有我需要以某种方式添加的函数“if”。我在谷歌上寻求一些帮助，但没有结果:(如果我理解得很好，应该添加一个条件“如果，否则”，但我不知道该怎么做，所以我非常感谢你的帮助。如果有人能够为我提供帮助并添加此代码，我将不胜感激！

```
// this is not active now becouse i don't use this xml file
$(document).ready(function() {
    $.ajax({
        type: "GET",
        url: "premier-rates.xml",
        dataType: "xml",
        success: parseXml
    });
    // this is my XML file
    $.ajax({
        type: "GET",
        url: "go-rates.xml",
        dataType: "xml",
        success: parseXml_go
    });

    $("#selCountry").change(onSelectChange);
    $("#selCountry_go").change(onSelectChange_go);

});

function gup(name) {
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.href);
    if (results == null) return "";
    else return results[1];
}

function parseXml(xml) {

    $(xml).find("db_rates").each(function() {
        var this_countryname = $(this).find("country").text();
        var this_id = $(this).find("id").text();
        var curOption = $("<option value='" + this_id + "'>" + this_countryname + "</option>")
        curOption.data("db_rates", $(this)); // bind the country node data from the XML to the                                             option of the dropdown
        $(curOption).appendTo($('#selCountry'))
    });

}

function onSelectChange() {
    var selected = $('#selCountry').children(':selected').data('db_rates');

    $('#rates_output').html("");
    var this_country = $(selected).find('country').text();
    var this_landlineRates = $(selected).find('landline_rates');
    var this_mobileRates = $(selected).find('mobile_rates');

    $("#rates_output").append("<p class='dest_title'>" + this_country + "</p>");
    $("#rates_output").append("<ul><li><div class='dest_list'>Landline</div><div class='dest_list'>" + this_landlineRates.text() + "p /min</div><div class='clear'></div></li><li><div class='dest_list'>Mobile</div><div class='dest_list'>" + this_mobileRates.text() + "p /min</div><div class='clear'></div></li></ul>");

    //$("#rates_output").append("Landline: " + this_landlineRates.text() + "p /min<br />     Mobile: " + this_mobileRates.text() +"p /min");
    this_country = this_country.replace(/ /gi, "-");

    var flagoutput = "";
    var this_id = gup('id');

    if (this_id == "1") {
        flagoutput = "<img src='images/flag/" + this_country + ".png' style='float:right;     border:1px solid #CCC; margin-right:10px; ' />";
    } else {
        flagoutput = "<img src='images/flag/" + this_country + ".png' style='float:left; border:1px solid #CCC; ' />";
    }
    $("#flagoutput").html(flagoutput);
}

function parseXml_go(xml) {

    $(xml).find("db_rates").each(function() {
        var this_countryname = $(this).find("country").text();
        var this_id = $(this).find("id").text();
        var curOption = $("<option value='" + this_id + "'>" + this_countryname + "</option>")
        curOption.data("db_rates", $(this)); // bind the country node data from the XML to the     option of the dropdown
        $(curOption).appendTo($('#selCountry_go'))
    });

}

function onSelectChange_go() {
    var selected = $('#selCountry_go').children(':selected').data('db_rates');

    $('#rates_output_go').html("");
    var this_country = $(selected).find('country').text();

    //THOSE TWO VARIABLE ARE ALWAYS LOADED
    var this_landlineRates = $(selected).find('landline_rates');
    var this_mobileRates = $(selected).find('mobile_rates');

    // THOSE VARIABLES I WOULD LIKE TO ADD TO MY WEBSITE (DEPENDS ON HOW MANY OPERATORS ARE IN THE COUNTRY... SO IT CAN BE: this_mobileRatesC, D, E... 
    var this_mobileRatesA = $(selected).find('mobile_ratesA');
    var this_mobileRatesB = $(selected).find('mobile_ratesB');

    // AGAIN - THOSE TWO VARIABLES ARE ALWAYS LOADED
    $("#rates_output_go").append("<p class='dest_title'>" + this_country + "</p>");
    $("#rates_output_go").append("<ul><li><div class='dest_list'>Landline</div><div class='dest_list'>" + this_landlineRates.text() + "p /min</div><div class='clear'></div></li><li><div class='dest_list'>Mobile</div><div class='dest_list'>" + this_mobileRates.text() + "p /min</div><div class='clear'></div></li></ul>");

    // SO I WAS TRYING TO ADD MY CODE, BUT I THINK SOMETHING IS WRONG AS IT ALWAYS SHOWS VALUE EVEN IF THE VALUE IS 0 OR DOES NOT EXIST IN MY XML FILE (it will be more for this_mobileRatesB, C, D...)
    var this_mobileRatesA = $(selected).find('mobile_ratesA');
    if ('mobile_ratesA' >= "0") {
        $("#rates_output_go").append("<ul><li><div class='dest_list'>A</div><div class='dest_list'>" + this_mobileRatesA.text() + "p /min</div><div class='clear'></div></li></ul>");

        // for more added this_mobileRatesB
        var this_mobileRatesA = $(selected).find('mobile_ratesA');
        if ('mobile_ratesB' >= "0") {
            $("#rates_output_go").append("<ul><li><div class='dest_list'>A</div><div class='dest_list'>" + this_mobileRatesB.text() + "p /min</div><div class='clear'></div></li></ul>");

            this_country = this_country.replace(/ /gi, "-");

            var flagoutput = "";

            /* */
            var this_id = gup('id');

            if (this_id == "1") {
                flagoutput = "<img src='images/flag/" + this_country + ".png' style='float:right;     border:1px solid #CCC;margin-right:10px; ' />";
            } else {
                flagoutput = "<img src='images/flag/" + this_country + ".png' style='float:left; border:1px solid #CCC; ' />";
            }
            $("#flagoutput").html(flagoutput);
        }
    }
} 
```

请注意：添加评论只是为了使这篇文章更清晰

XML 文件 Premier-rates.xml

```
<?xml version="1.0" encoding="utf-8" ?>
<Rates>
<db_rates>
<id>1</id>
<country>country1</country>
<landline_rates>0.10</landline_rates>
<mobile_rates>0.15</mobile_rates>
<mobile_ratesA>0.50</mobile_ratesA> // I WONT IF HAVE VALUE IS APPENDED
<mobile_ratesB></mobile_ratesB> // I WONT IF 0 OR EMPTY IS NOT APPENDED
</db_rates>
<db_rates>
... // MORE COUNTRIES
</db_rates>
...
</Rates> 
```

请你能帮我解决这个问题，不一定是我试图这样做的方式，因为可能有更好的方式来做到这一点。我将不胜感激任何帮助和建议。

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:25:19.447

不确定您要问的全部内容，但如果我是正确的，您只是希望做一个有条件的 XML 文件吗？AKA 如果一个条件产生真正的拉 xml 文件 A，如果不是拉 xml 文件 B？

如果是这样，您可以这样做：更改以下代码片段

```
$.ajax({
type: "GET",
url: "premier-rates.xml",
dataType: "xml",
success: parseXml   
});
// this is my XML file
$.ajax({
type: "GET",
url: "go-rates.xml",
dataType: "xml",
success: parseXml_go    
}); 
```

成为：

```
var file_data = {};
var download_xml_file_A = true; //This can be any type of conditional, just using an example
if(download_xml_file_A) {
    file_data.filename = "premier-rates.xml";
    file_data.callback = parseXml;
}
else {
    file_data.filename = "go-rates.xml";
    file_data.callback = parseXml_go;
}

$.ajax({
    type: "GET",
    url: file_data.filename,
    dataType: "xml",
    success: file_data.callback
    }); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:21:56.627

这是第一个引起我注意的事情：

```
// SO I WAS TRYING TO ADD MY CODE, BUT I THINK SOMETHING IS WRONG AS IT ALWAYS SHOWS VALUE EVEN IF THE VALUE IS 0 OR DOES NOT EXIST IN MY XML FILE (it will be more for this_mobileRatesB, C, D...)
var this_mobileRatesA = $(selected).find('mobile_ratesA');
if ('mobile_ratesA' >="0"){
$("#rates_output_go").append("<ul><li><div class='dest_list'>A</div><div class='dest_list'>" + this_mobileRatesA.text() + "p /min</div><div class='clear'></div></li></ul>");

// for more added this_mobileRatesB
var this_mobileRatesA = $(selected).find('mobile_ratesA');
if ('mobile_ratesB' >="0"){
$("#rates_output_go").append("<ul><li><div class='dest_list'>A</div><div class='dest_list'>" + this_mobileRatesB.text() + "p /min</div><div class='clear'></div></li></ul>"); 
```

与`if ('mobile_ratesA' >="0")`您比较两个常量字符串。这个结果永远不会改变，所以这个值总是会被​​打印出来（因为`'mobile_ratesA' >= '0'`通过字符串比较）。

我相信你想要的是

```
// only print if we find at least one mobileRatesA node
if(this_mobileRatesA.get().length > 0) {
    ...
} 
```

也许

```
// only print if mobileRatesA contains a string
// representation of a number greater than 0
if(parseInt(this_mobileRatesA.text()) > 0) {
    ...
} 
```

# visual-studio-2010 - 以编程方式将数据从 Infopath 传输到 Excel

> ID：11836733
> 
> 赞同：0
> 
> 时间：2012-08-06T22:12:46.080
> 
> 标签：visual-studio-2010, excel, infopath

我正在寻找为 Infopath（使用 Visual Studio 2010）创建一些自定义代码，以获取表单中的某些数据字段并将它们导出到 Excel，将此数据映射到正确的单元格。有没有办法做到这一点？我尝试过 excel 服务，但它从来没有将数据放在正确的位置（如果它完全获取数据）。我`Microsoft.Office.Interop.Excel.Application`通过一些搜索找到了一些信息......这是我应该用来做这个的吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T15:03:35.130

Siddharth Rout 在这里（[http://www.siddharthout.com/vb-dot-net-and-excel/](http://www.siddharthrout.com/vb-dot-net-and-excel/)）给了我一个很好的解决方案，这正是我想要的。谢谢！

# javascript - 如何测试 Greasemonkey 脚本，尤其是在网页的本地副本上？

> ID：11836739
> 
> 赞同：8
> 
> 时间：2012-08-06T22:13:09.603
> 
> 标签：javascript, debugging, firefox, greasemonkey

我有自己的 javascript，需要用 Greasemonkey 进行测试。我以前从未与 Greasemonkey 合作过；如何测试脚本？

我没有在万维网上测试它，我已经保存了目标页面（**Firefox > Save page as > Web page, complete**），所以我在本地测试它。

过程是什么？如何测试脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T05:13:20.223

以下是对 Greasemonkey 脚本进行故障排除的一些指南，包括一般性和网页本地副本。

1.  要在本地页面上进行测试（没有本地 Web 服务器），您必须更改 Greasemonkey 的设置。
    打开[about:config](http://kb.mozillazine.org/About:config)并设置`greasemonkey.fileIsGreaseable`为`true`

2.  确保网页的本地副本不在系统`/tmp`或`/temp`文件夹中。如果是，该脚本将无法可靠地工作。

3.  确保脚本源不在系统`/tmp`或`/temp`文件夹中。 [如果是 ，则该脚本将不会安装](http://wiki.greasespot.net/Troubleshooting_%28Script_Authors%29#Installing_from_.2Ftmp)。

4.  对于处理本地文件的脚本，请确保您有针对本地网页副本的适当[`@include`指令。](http://wiki.greasespot.net/Metadata_Block#.40include)例如：

    ```
    // @include file:///D:/web/local%20page%20copies/* 
    ```

5.  熟悉 Firefox 的错误控制台 ( `Ctrl``Shift``J`) 以及[如何使用它来确定 Greasemonkey 脚本中的错误来源](https://stackoverflow.com/a/9627507/331508)。

6.  安装[Firebug](https://www.getfirebug.com/)并熟悉它。 [Firebug 出色的控制台功能](http://getfirebug.com/wiki/index.php/Console_API)在 GM 脚本中工作得很好——尽管您*可能*必须在它们前面加上`unsafeWindow.`.

7.  首先在 Firebug 的 JavaScript 控制台中 尽可能多地测试不使用[GM_ 函数的 javascript。](http://wiki.greasespot.net/Category:API_Reference)

**也可以看看：**

*   [脚本作者疑难解答](http://wiki.greasespot.net/Troubleshooting_%28Script_Authors%29)
*   [避免 Greasemonkey 中的常见陷阱](http://wiki.greasespot.net/Avoid_Common_Pitfalls_in_Greasemonkey)

# php - PHP if in_array() 如何获取密钥？

> ID：11836741
> 
> 赞同：62
> 
> 时间：2012-08-06T22:13:32.490
> 
> 标签：php, arrays

为一个小问题而苦苦挣扎。

我有一个数组：

```
Array
(
    [0] => 
    [6] => 6
    [3] => 5
    [2] => 7
) 
```

我正在检查数组中是否有设定值。

```
if(in_array(5, $array)) {
//do something
} else {
// do something else
} 
```

问题是，当它在数组中找到值 5 时，我真的需要在我的“做某事”中使用密钥。

在这种情况下，我需要设置：

```
$key = 3; 
```

（来自找到的值 in_array 的键）。

有什么建议么？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-08-06T22:17:44.180

[`array_search()`](http://php.net/array-search)就是你要找的。

```
if (false !== $key = array_search(5, $array)) {
    //do something
} else {
    // do something else
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-06T22:18:44.153

如果您只需要第一个匹配项的密钥，请使用`array_search()`：

```
$key = array_search(5, $array);
if ($key !== false) {
    // Found...
} 
```

如果您需要与特定值匹配的所有条目的键，请使用`array_keys()`：

```
$keys = array_keys($array, 5);
if (count($keys) > 0) {
    // At least one match...
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T22:19:07.230

你可以使用这个[http://www.php.net/manual/en/function.array-search.php](http://www.php.net/manual/en/function.array-search.php)

```
$key = array_search(5, $array)
if ($key !== false) {
... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-06T22:19:07.023

你可以试试

```
if(in_array(5, $array))
{
    $key = array_search(5, $array);
    echo $key;
} 
```

这样你就知道它存在，如果它不存在，它不会导致通知、警告或致命的脚本错误，具体取决于你之后对该键所做的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-06T22:17:52.353

也许您想改用 array_search，如果未找到该值，则返回 false，如果找到该值，则返回索引。看看[这里的描述](http://php.net/manual/en/function.array-search.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-22T14:17:40.987

万一有人需要它在数组中。我的情况是这样的：

我有一个这样的数组：

```
$myArray =

array:3 [▼
  0 => array:3 [▼
    0 => 2
    1 => 0
    2 => "2019-07-21 23:59:59"
  ]
  1 => array:3 [▼
    0 => 3
    1 => 2
    2 => "2019-07-21 23:59:59"
  ]
  2 => array:3 [▼
    0 => 1
    1 => 1
    2 => "2019-07-21 23:59:59"
  ]
] 
```

另一个像这样的（对象数组）：

```
$Array2 = 

Collection {#771 ▼
  #items: array:12 [▼
    0 => {#1047 ▼
      +"id": 2
      +"name": "demografico"
      +"dict_key": "demographic"
      +"component": "Demographic"
      +"country_id": null
      +"created_at": null
      +"updated_at": null
    }
    1 => {#1041 ▶}
    2 => {#1040 ▶}
    etc... 
```

作为 OP，我必须使用数组中某个值的键“做某事”（使用 html php 模板中的值，我的情况是带有刀片的 Laravel）。对于我的代码，我不得不使用这个：

```
foreach($Array2 as $key => $item)
    if(false !== $key = array_search($item->id, array_column($myArray, 0))
    // Note that $key is overwritten
        <input type="number" class="form-control" id="{!! $item->id !!}" value="{{ $myArray[$key][1] }}"> 
```

# php - Recess 框架：为什么当文件存在时出现资源未找到错误？

> ID：11836742
> 
> 赞同：1
> 
> 时间：2012-08-06T22:13:34.730
> 
> 标签：php, url-routing, recess

我正在考虑使用按原样下载并认真遵循说明的[Recess 框架。](http://www.recessframework.org/)

我将它与 PHP 一起使用（这不是问题），我似乎已经启动并运行了......但是我怀疑所提供的页面有些问题（它们不包含预期的徽标）所以我检查了代码只是发现框架 javascript 和 CSS 文件是“找不到资源”。

顺便说一句，文件存在于指定的路径中，权限设置不正确不是问题 - 我也检查过。

但是......我不熟悉通过 URL 使用“路由”作为 MVC 样式的一部分，并且想知道它是否与此有关。

如果你下载了这个框架，你会发现使事情看起来很漂亮的 css 和 javascript 文件，并激活框架工具集的某些部分存在于路径中：

```
http://localhost/yourRecessFolderName/index.php/recess/recess/apps/tools/public/js/shCore.js 
```

但我发现可怕的 404 资源未找到，这会阻止凹槽工具正常工作。

1）有没有其他人有这个或类似的问题？2) 可能的原因是什么 - 帮助我指出正确的方向，除非你当然知道答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:33:55.600

[好吧，似乎通过从https://github.com/recess/recess](https://github.com/recess/recess)下载 Recess 框架的最新（“最新边缘”）版本来解决它

现在一切似乎都很好......嗯0.o

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T19:21:12.430

当从开发传递到生产时，Recess Framework 使用缓存来加速访问站点。在您的情况下，缓存内容可能是错误的。

我建议您访问路径**/your/recess/path/data/temp**并删除文件**recess.php**和**sqlite-cache.db 并重**试。

我希望这对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-03T02:35:45.700

在 Recess v0.2 中，/apps 中有一个 .htaccess 文件，可防止直接访问儿童。您需要修改 .htaccess 或在 mod_rewrite 中配置一些自定义内容，以允许查看应用程序下的公用文件夹。

# python - 使用 conn = httplib.HTTPConnection ("http://ipaddr:port") 时出错

> ID：11836748
> 
> 赞同：0
> 
> 时间：2012-08-06T22:14:25.253
> 
> 标签：python, http

我在用

```
httplib.HTTPConnection ("http://ipaddr:port")  
conn.request("GET", "", params, headers) 
```

我可以使用 ipaddr:port 使用我的 firefox 客户端进行 PUT/GET 操作！！。但是我在执行脚本时看到了这个错误：

```
 File "post_python.py", line 5, in <module>
    conn.request("GET", "", params, headers)
  File "/usr/lib64/python2.6/httplib.py", line 914, in request
    self._send_request(method, url, body, headers)
  File "/usr/lib64/python2.6/httplib.py", line 951, in _send_request
    self.endheaders()
  File "/usr/lib64/python2.6/httplib.py", line 908, in endheaders
    self._send_output()
  File "/usr/lib64/python2.6/httplib.py", line 780, in _send_output
    self.send(msg)
  File "/usr/lib64/python2.6/httplib.py", line 739, in send
    self.connect()
  File "/usr/lib64/python2.6/httplib.py", line 720, in connect
    self.timeout)
  File "/usr/lib64/python2.6/socket.py", line 553, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno -2] Name or service not known" 
```

请问有人可以帮我吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:20:10.020

您可能有一个浏览器已经知道的代理。如果您在 linux 下尝试设置`http_proxy`环境变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T23:15:38.100

试试这个（IP地址前没有“http://”）：

```
conn = httplib.HTTPConnection("x.x.x.x", port)  
conn.request("GET", "", params, headers) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T23:28:54.037

如果它是 IPv6 地址，则需要根据[RFC 2732](http://www.ietf.org/rfc/rfc2732.txt)用括号括起来。如果我没记错的话，如果你不使用括号，那就是你得到的错误信息。

```
httplib.HTTPConnection ("http://[::1]:8080")  
conn.request("GET", "", params, headers) 
```

# jquery - jQuery slideToggle 只是显示和隐藏，但动画不正确

> ID：11836751
> 
> 赞同：2
> 
> 时间：2012-08-06T22:14:36.250
> 
> 标签：jquery, animation, html, slidetoggle

在[这个例子](http://jsfiddle.net/7xzMa/1/)中，我的 div 容器只是隐藏和显示，但没有做[很棒的 jQuery 动画](http://jsfiddle.net/tdsUC/)。

```
$('.button').click(function() {
    $('.class1').slideToggle();
}); 
```

谁能告诉我为什么？我知道表格上的动画不能正常工作，但在 div 上应该没问题。

更新感谢所有答案。我缺少的信息是绝对位置会从 DOM 中删除元素。是的，我知道我应该把样式放在 css 中——这个版本只是为了快速测试，但谢谢你的回答！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T22:36:44.853

.slideToggle() 将元素的高度设置为 0% - 100%，同时隐藏其子元素。

通过在整个小提琴中使用 position:absolute，您正在从 DOM 流中删除子元素并干扰父元素逐渐隐藏其子元素的能力。

如果您将溢出设置为隐藏，并从孩子中删除位置：绝对，这将正常工作。

[http://jsfiddle.net/7xzMa/6/](http://jsfiddle.net/7xzMa/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:41:19.913

更新了您的FIDDLE - [http://jsfiddle.net/7xzMa/14/](http://jsfiddle.net/7xzMa/14/) --- 清理了 div，您应该将 css 放入样式表中，以便于编辑。“显示”应设置为“无”。除非您希望它可见，否则单击隐藏。[http://jsfiddle.net/7xzMa/8/](http://jsfiddle.net/7xzMa/8/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T23:22:07.320

Artur，我的建议是完全重构你的代码，这有太多的事情要做。简短而简单总是最好的。我首先要摆脱 html 中的“样式”属性。确保将样式放在 CSS 中（它更干净、更易于维护——比从多个标签中删除样式要好得多）。

刚刚给你做了个demo，希望对你有帮助！随意使用它！快乐编码！[http://jsfiddle.net/7xzMa/17/](http://jsfiddle.net/7xzMa/17/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-15T22:52:19.550

使用 JQuery 用户界面

```
$(document).ready(function() {
    $('.button').click(function() {
        $('.class1').toggle('slide',{direction: 'up'},500);
    });
}); 
```

# java - IntelliJ Tomcat 部署工件的顺序

> ID：11836753
> 
> 赞同：0
> 
> 时间：2012-08-06T22:14:51.537
> 
> 标签：java, tomcat, deployment, intellij-idea, artifacts

我试图弄清楚如何修改 IntelliJ 中工件的默认启动/部署顺序（我在 IJ 11 上）。看起来它使用基本的字符串排序（升序）来部署工件，并且它是按顺序进行的。我想稍微改变一下，这样我就可以控制我的工件的启动顺序。

我已经为此搜索了网络和堆栈溢出，但没有找到答案。（SO链接：[重启tomcat时如何控制webapp部署顺序](https://stackoverflow.com/questions/2539245/how-to-control-webapp-deployment-order-when-restarting-tomcat)）

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T15:37:29.693

我正在回答我自己的问题，因为事实证明这个功能没有为 Tomcat 实现。我为其提交了功能请求，您可以在此链接上对其进行跟踪：http: [//youtrack.jetbrains.com/issue/IDEA-89803#comment=27-367677](http://youtrack.jetbrains.com/issue/IDEA-89803#comment=27-367677)

# javascript - MooTools 的 jQuery 函数

> ID：11836756
> 
> 赞同：-3
> 
> 时间：2012-08-06T22:15:02.320
> 
> 标签：javascript, jquery, ajax, mootools

我开始学习 MooTools，到目前为止，我发现如何制作与 jQuery 版本相似的代码真的很困难

```
<span id="clickme" onclick="myFunction(5,46,'add')"/> I'm a span</span>

function myFunction(id,iduser,type){

// ajax request with this values

} 
```

在 MooTools 中

```
window.addEvent('domready', function() { 

    $('clickme').addEvent('click', function()
    {
            // ajax request ...
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:10:58.477

呃。什么？您已经完成了点击处理程序，那么为什么不调用您的函数呢？

```
window.addEvent('domready', function() { 

    $('clickme').addEvent('click', function() {
          // get from html el
          var a = this.get('data-a'), b = this.get('data-b');

          new Request({
              url: 'someurl/',
              method: 'get',
              onComplete: function() {
                  console.log(this.response.text);
              }
          }).send({a: a, b: b}); // sends somerul/?a=nn&b=nn
    });

}); 
```

这可以说`<span id='clickme' data-a='5' data-b='45'>click me</span>`

只需阅读文档并阅读一些教程 - 在许多框架中比较 ajax 的大量示例。今天发布在推特上：[http](http://wernancheta.wordpress.com/2012/08/03/performing-ajax-calls-on-jquery-dojo-and-mootools/) ://wernancheta.wordpress.com/2012/08/03/performing-ajax-calls-on-jquery-dojo-and-mootools/ - 不是说它很好或其他什么，但它在那里。

[http://mootools.net/docs/core/Request/Request](http://mootools.net/docs/core/Request/Request)

[http://mootools.net/docs/core/Element/Element.Event#Element:addEvent](http://mootools.net/docs/core/Element/Element.Event#Element:addEvent)

# javascript - D3.js 中的 selection.style 和 selection.attr 有什么区别？

> ID：11836757
> 
> 赞同：22
> 
> 时间：2012-08-06T22:15:12.287
> 
> 标签：javascript, function, events, d3.js

我发现它们都在我的测试中有效：

```
 .on("mouseover",
        function() {
            d3.select(this)
                .select("text")
                .style("fill","red");
        }) 
```

或者

```
 .on("mouseover",
        function() {
            d3.select(this)
                .select("text")
                .attr("fill","red");
        }) 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-06T22:23:19.513

如果您查看获得的 HTML，您会看到如下内容：

```
<text style="fill: red">... 
```

和

```
<text fill="red">... 
```

..这在 SVG 中都是合法的，但是当你需要样式时使用 attr 可能会让你绊倒，如果你将它用于其他东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T09:09:15.527

这稍微取决于您在 d3 中制作的 svg 对象。

例如，当您想要制作一个圆形元素时，它将具有定义圆形元素的形状和位置的“x”、“y”和“r”属性 (attr)。您可以使用不透明度、填充颜色等设置圆形样式。

属性通常表示 svg 对象的大小和形状，而样式通常表示您在可视化中使用的 svg 对象的更多设计方面。

# asp.net - WCF gzip压缩？

> ID：11836759
> 
> 赞同：1
> 
> 时间：2012-08-06T22:15:23.433
> 
> 标签：asp.net, wcf, compression, gzip, discountasp

我需要压缩我的 WCF 响应。经过几次谷歌搜索，我发现

*   我需要在 iis7 上启用压缩
*   我需要在 applicationhost.config 中添加一些条目。

我的 wcf 托管在 discountasp.net 上。在控制面板中，我没有找到任何启​​用压缩的选项。此外，applicationhost.config 位于“C:\Windows\System32\Inetsrv\Config\applicationHost.config”目录中。

而在共享主机环境中，我无权访问该目录。

我的问题是，如果我的上述观察是正确的，我如何在共享主机中完成它？

## 编辑：

我在这里找到了一些东西：在此处 [输入链接描述](http://codeasp.net/blogs/raghav_khunger/microsoft-net/1973/asp-net-enable-gzip-compression-via-web-config)

我试过这个没有运气。在 Fiddler 的响应头中，我没有看到任何压缩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:22:11.703

一种替代方法是实现一个 HttpModule，它会根据内容类型拦截响应并使用 GZipStream 类即时压缩输出。

[这篇文章](http://geekswithblogs.net/rashid/archive/2007/09/15/Compress-Asp.net-Ajax-Web-Service-Response---Save-Bandwidth.aspx)有一个完整的例子，我已经在生产中成功地使用了这种方法。您需要做的就是更改您的 Web.config 以注册 http 模块：

```
<httpModules>
    <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    <add name="JsonCompressionModule" type="JsonCompressionModule"/>
</httpModules> 
```

该示例针对 JSON 响应执行此操作，但没有什么可以阻止您针对 XML 响应执行相同的操作。

# c# - 带有多个计时器的 WinForm

> ID：11836760
> 
> 赞同：3
> 
> 时间：2012-08-06T22:15:23.617
> 
> 标签：c#, winforms, timer

我正在编写一个 WinForm 应用程序以每 30 秒或 1 分钟使用一次 SNMP 调用。

我有一个用于调用我的 SNMP 命令的计时器，但我想添加一个 texbox 计数器来显示操作期间经过的总时间。

我遇到了很多问题，所以这里有一个列表：

1.  我希望我的 SNMP 计时器“计时器”在等待分配的时间之前执行一次，所以我让它在 3 秒时关闭，然后更改我的处理程序中的间隔。但这有时会使计时器多次关闭，这不是我想要的。
2.  每次“计时器”关闭并且我的 SNMP 调用执行时，我的计数器计时器“appTimer”变得不同步。我尝试了一种解决方法，我检查它是否在另一个处理程序中，然后将计时器跳到适当的时间。哪个有效，但我觉得这太复杂了。
3.  我知道的最后一个问题发生在我使用停止按钮停止应用程序时，该按钮并未完全退出应用程序。当我开始另一次运行时，两个计时器之间的时间变得更长，并且由于某种原因，我的计数计时器“appTimer”开始以两倍的速度计数。

我希望这个描述不会太令人困惑，但无论如何这是我的代码：

```
using System;
using System.Net;
using SnmpSharpNet;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public static bool stop = false;
        static bool min = true, eye = false, firstTick = false;
        static string ipAdd = "", fileSaveLocation = "";
        static System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer();
        static System.Windows.Forms.Timer appTimer = new System.Windows.Forms.Timer();
        static int alarmCounter = 1, hours = 0, minutes = 0, seconds = 0, tenthseconds = 0, count = 0;
        static bool inSNMP = false;
        static TextBox textbox, timeTextbox;

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            textbox = outputBox;
            timeTextbox = timeBox;
            ipAdd = "192.168.98.107";
            fileSaveLocation = "c:/Users/bshellnut/Desktop/Eye.txt";
            min = true;
            inSNMP = false;
        }

        private void IPtext_TextChanged(object sender, EventArgs e)
        {
            ipAdd = IPtext.Text;
        }

        private void stopButton_Click(object sender, EventArgs e)
        {
            stop = true;
            timer.Stop();
            appTimer.Stop();
            count = 0;
            hours = minutes = seconds = tenthseconds = 0;
            inSNMP = false;
        }

        // This is the method to run when the timer is raised.
        private static void TimerEventProcessor(Object myObject,
                                                EventArgs myEventArgs)
        {
            inSNMP = true;
            timer.Stop();

            if (firstTick == true)
            {
                // Sets the timer interval to 60 seconds or 1 second.
                if (min == true)
                {
                    timer.Interval = 1000 * 60;
                }
                else
                {
                    timer.Interval = 1000 * 30;
                }
            }

            // Displays a message box asking whether to continue running the timer.
            if (stop == false)
            {
                textbox.Clear();
                // Restarts the timer and increments the counter.
                alarmCounter += 1;
                timer.Enabled = true;

                System.IO.StreamWriter file;
                //if (eye == true)
                //{
                    file = new System.IO.StreamWriter(fileSaveLocation, true);
                /*}
                else
                {
                    file = new System.IO.StreamWriter(fileSaveLocation, true);
                }*/

                // SNMP community name
                OctetString community = new OctetString("public");

                // Define agent parameters class
                AgentParameters param = new AgentParameters(community);
                // Set SNMP version to 2 (GET-BULK only works with SNMP ver 2 and 3)
                param.Version = SnmpVersion.Ver2;
                // Construct the agent address object
                // IpAddress class is easy to use here because
                //  it will try to resolve constructor parameter if it doesn't
                //  parse to an IP address
                IpAddress agent = new IpAddress(ipAdd);

                // Construct target
                UdpTarget target = new UdpTarget((IPAddress)agent, 161, 2000, 1);

                // Define Oid that is the root of the MIB
                //  tree you wish to retrieve
                Oid rootOid;
                if (eye == true)
                {
                    rootOid = new Oid("1.3.6.1.4.1.128.5.2.10.14"); // ifDescr
                }
                else
                {
                    rootOid = new Oid("1.3.6.1.4.1.128.5.2.10.15");
                }

                // This Oid represents last Oid returned by
                //  the SNMP agent
                Oid lastOid = (Oid)rootOid.Clone();

                // Pdu class used for all requests
                Pdu pdu = new Pdu(PduType.GetBulk);

                // In this example, set NonRepeaters value to 0
                pdu.NonRepeaters = 0;
                // MaxRepetitions tells the agent how many Oid/Value pairs to return
                // in the response.
                pdu.MaxRepetitions = 5;

                // Loop through results
                while (lastOid != null)
                {
                    // When Pdu class is first constructed, RequestId is set to 0
                    // and during encoding id will be set to the random value
                    // for subsequent requests, id will be set to a value that
                    // needs to be incremented to have unique request ids for each
                    // packet
                    if (pdu.RequestId != 0)
                    {
                        pdu.RequestId += 1;
                    }
                    // Clear Oids from the Pdu class.
                    pdu.VbList.Clear();
                    // Initialize request PDU with the last retrieved Oid
                    pdu.VbList.Add(lastOid);
                    // Make SNMP request
                    SnmpV2Packet result;
                    try
                    {
                        result = (SnmpV2Packet)target.Request(pdu, param);
                    }
                    catch (SnmpSharpNet.SnmpException)
                    { 
                        timer.Stop();
                        textbox.Text = "Could not connect to the IP Provided.";
                        break;
                    }
                    // You should catch exceptions in the Request if using in real application.

                    // If result is null then agent didn't reply or we couldn't parse the reply.
                    if (result != null)
                    {
                        // ErrorStatus other then 0 is an error returned by 
                        // the Agent - see SnmpConstants for error definitions
                        if (result.Pdu.ErrorStatus != 0)
                        {
                            // agent reported an error with the request
                            textbox.Text = "Error in SNMP reply. " + "Error " + result.Pdu.ErrorStatus + " index " + result.Pdu.ErrorIndex;

                            lastOid = null;
                            break;
                        }
                        else
                        {
                            // Walk through returned variable bindings
                            foreach (Vb v in result.Pdu.VbList)
                            {
                                // Check that retrieved Oid is "child" of the root OID
                                if (rootOid.IsRootOf(v.Oid))
                                {
                                    count++;
                                    textbox.Text += "#" + count + " " + v.Oid.ToString() + " " + SnmpConstants.GetTypeName(v.Value.Type) +
                                                   " " + v.Value.ToString() + Environment.NewLine;

                                    file.WriteLine("#" + count + ", " + v.Oid.ToString() + ", " + SnmpConstants.GetTypeName(v.Value.Type) +
                                                   ", " + v.Value.ToString(), true);
                                    if (v.Value.Type == SnmpConstants.SMI_ENDOFMIBVIEW)
                                        lastOid = null;
                                    else
                                        lastOid = v.Oid;
                                }
                                else
                                {
                                    // we have reached the end of the requested
                                    // MIB tree. Set lastOid to null and exit loop
                                    lastOid = null;
                                }
                            }
                        }
                    }
                    else
                    {
                        //Console.WriteLine("No response received from SNMP agent.");
                        textbox.Text = "No response received from SNMP agent.";
                        //outputBox.Text = "No response received from SNMP agent.";
                    }
                }
                target.Close();
                file.Close();
            }
            else
            {
                // Stops the timer.
                //exitFlag = true;
                count = 0;
            }
        }

        private static void ApplicationTimerEventProcessor(Object myObject,
                                                EventArgs myEventArgs)
        {

            tenthseconds += 1;

            if (tenthseconds == 10)
            {
                seconds += 1;
                tenthseconds = 0;
            }

            if (inSNMP && !firstTick)
            {
                if (min)
                {
                    seconds = 60;
                }
                else
                {
                    textbox.Text += "IN 30 SECONDS!!!";
                    if (seconds < 30)
                    {
                        seconds = 30;
                    }
                    else
                    {
                        seconds = 60;
                    }
                }
            }

            if(seconds == 60)
            {
                seconds = 0;
                minutes += 1;
            }

            if(minutes == 60)
            {
                minutes = 0;
                hours += 1;
            }

            timeTextbox.Text = (hours < 10 ? "00" + hours.ToString() : hours.ToString()) + ":" + 
                               (minutes < 10 ? "0" + minutes.ToString() : minutes.ToString()) + ":" +
                               (seconds < 10 ? "0" + seconds.ToString() : seconds.ToString()) + "." +
                               (tenthseconds < 10 ? "0" + tenthseconds.ToString() : tenthseconds.ToString());
            inSNMP = false;
            firstTick = false;
        }

        private void eyeButton_Click(object sender, EventArgs e)
        {
            outputBox.Text = "Connecting...";
            eye = true;
            stop = false;
            count = 0;
            hours = minutes = seconds = tenthseconds = 0;

            timer.Tick += new EventHandler(TimerEventProcessor);

            timer.Interval = 3000;
            firstTick = true;

            appTimer.Tick += new EventHandler(ApplicationTimerEventProcessor);

            appTimer.Interval = 100;

            appTimer.Start();
            timer.Start();
        }

        private void jitterButton_Click(object sender, EventArgs e)
        {
            outputBox.Text = "Connecting...";
            eye = false;
            stop = false;
            count = 0;
            hours = minutes = seconds = tenthseconds = 0;

            timer.Tick += new EventHandler(TimerEventProcessor);

            timer.Interval = 3000;
            firstTick = true;

            appTimer.Tick += new EventHandler(ApplicationTimerEventProcessor);

            appTimer.Interval = 100;

            appTimer.Start();
            timer.Start();
        }

        private void Seconds_CheckedChanged(object sender, EventArgs e)
        {
            min = false;
        }

        private void Minutes_CheckedChanged(object sender, EventArgs e)
        {
            min = true;
        }

        private void exitButton_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        private void savetextBox_TextChanged(object sender, EventArgs e)
        {
            fileSaveLocation = savetextBox.Text;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T23:28:53.527

使用单个计时器很容易做到这一点。计时器的分辨率为 1/10 秒（左右），可直接用于更新经过的时间。然后，您可以使用该计时器内的相对经过时间来触发您的 SNMP 事务，并且您可以动态重新安排下一个事务。

这是一个简单的例子

```
using System;
using System.Drawing;
using System.Windows.Forms;

class Form1 : Form
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }

    DateTime lastSnmpTime;
    TimeSpan snmpTime = TimeSpan.FromSeconds(30);
    DateTime startTime;
    TextBox elapsedTimeTextBox;
    Timer timer;

    public Form1()
    {
        timer = new Timer { Enabled = false, Interval = 10 };
        timer.Tick += new EventHandler(timer_Tick);

        elapsedTimeTextBox = new TextBox { Location = new Point(10, 10), ReadOnly = true };
        Controls.Add(elapsedTimeTextBox);
    }

    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);

        startTime = DateTime.Now;
        timer.Start();
    }

    void timer_Tick(object sender, EventArgs e)
    {
        // Update elapsed time
        elapsedTimeTextBox.Text = (DateTime.Now - startTime).ToString("g");

        // Send SNMP
        if (DateTime.Now - lastSnmpTime >= snmpTime)
        {
            lastSnmpTime = DateTime.Now;

            // Do SNMP

            // Adjust snmpTime as needed
        }
    }
} 
```

**更新问答**

> 使用此代码，计时器在开始时触发一次，在我按下停止按钮并调用 timer.Stop() 然后按下我的开始按钮后，计时器直到大约 12 秒后才会触发。重置日期时间会解决这个问题吗？

当用户按下开始按钮时，设置`lastSnmpTime = DateTime.MinValue`. 这会导致(DateTime.Now - lastSnmpTime) 的TimeSpan 超过2000 年，所以它会大于snmpTime 并且会立即触发。

> 我在文本框中的输出时间也如下所示：0:00:02.620262。这是为什么？有没有办法让它只显示 0:00:02.62？

当您减去两个 DateTime 值时，结果是 TimeSpan 值。我使用了标准的[TimeSpan 格式字符串](http://msdn.microsoft.com/en-us/library/ee372286.aspx)。`"g"`您可以使用[自定义 TimeSpan 格式字符串](http://msdn.microsoft.com/en-us/library/ee372287.aspx)来`@"d\:hh\:mm\:ss\.ff"`获取 days:hours:minutes:seconds.fraction（2 个小数位）。

> 当计时器运行超过 9 小时时，它还会继续运行并打印到文本框吗？因为我打算让它运行 24 小时+

如果您使用带有“d”的自定义格式来显示天数，它将运行`TimeSpan.MaxValue`略多于 10,675,199 天，即超过 29,000 年。

# facebook - 如何捕获 facebook 用户点击安装我的应用程序的位置

> ID：11836762
> 
> 赞同：0
> 
> 时间：2012-08-06T22:15:35.680
> 
> 标签：facebook, facebook-graph-api

这是一个解释我的问题的场景：

假设该应用程序是一个简单的“建议框”。该公司安装该应用程序并将其添加到他们的 Facebook 页面。然后用户看到它并决定留下建议。

一旦他们点击该应用程序，该应用程序将要求获得授权。一旦他们授权，我就可以毫不费力地将他们的 FB 用户名发送到我的服务器。

但是，在安装应用程序之前，我如何捕获他们在其页面上首次单击应用程序的公司的用户 ID？

我希望该应用程序同时捕获授权它的人的用户名，以及他在其页面上单击该应用程序的人的用户名。

有些用户可能会直接从应用中心安装应用，在这种情况下，此字段可能为空白，但每次有人在某人的 Facebook 页面上点击该应用时，我都需要这两条信息才能访问服务器。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:08:17.967

您将能够在`signed_request`传递给您的应用程序中找到此信息。它包含一个`page`参数，该参数包含有关安装应用程序的页面的信息。如果`page`存在，则用户正在从页面选项卡访问您的应用程序，如果不存在，则可以安全地假设用户正在其画布 url 上与应用程序交互 -`https://apps.facebook.com/yourAppNamespace`

> [Facebook 签名请求](https://developers.facebook.com/docs/authentication/signed_request/)- Facebook
> 使用 signed_request 参数在许多不同场景中将数据传递给应用程序......

# xslt - Xpath 需要匹配三种不同的场景

> ID：11836763
> 
> 赞同：2
> 
> 时间：2012-08-06T22:15:45.603
> 
> 标签：xslt, xpath

我一直在 w3schools.com 上阅读有关 xpath 轴的信息，并且一直在尝试寻求帮助，但我很难弄清楚要实际搜索什么。

我有一个 xsl 样式表，用于将各种 xml 文件转换为 pdf 打印。我坚持的部分是，当我需要更改某些格式时，我已经确定了至少 3 种不同的场景。我已经找到了一种在两种情况下更改格式的方法，但第三种是其他两种情况的混合体，当我只想要一组格式时，我一直在显示两组格式。

请让我知道是否有任何其他信息有用，谢谢！

场景一：

```
<TASK>
    <REVST>Some revised text
</TASK> 
```

场景二：

```
<LIST>
  <PARA>
    <REVST />Some Text <REVEND />
  </PARA>
</LIST> 
```

场景 3：

```
<TASK>
   <PARA>
      <REVST />Some other revised text <REVEND />
   </PARA>
 </TASK> 
```

似乎适用于场景 1 的方法是将其`<xsl:if test="parent::*TASK/REVST">`放在样式表的一部分中，该样式表执行一个 for-each 并遍历每个“ITEM”。似乎适用于场景 2 的方法是`<xsl:if test="descendant::REVST">`在 PARA 模板中进行此测试。

但是对于场景 3，我最终都显示，而它应该只是来自 PARA 模板的格式。

有什么建议么？甚至是搜索词的建议？任何帮助将不胜感激 ：）

我知道我有很多东西要学，我很感激所提供的帮助，但我仍然不太明白如何让它不显示修订格式（页面右侧的一个栏）当只有部分文本被指出需要修改时，是否需要对整个文件进行修改？

```
<LIST>
<PARA>
    <REVST/>
    THIS IS SOME TEXT THAT SHOULD BE MARKED BY A REVISION BAR.
    <REVEND/>
</PARA>
</LIST> 
```

而像这样的案例，我需要为基本上整个文档显示一个修订栏。

```
<TASK>
  <ELE1/>
    <REVST/>
    <ELE2/>
    <TITLE>The Title</TITLE>
    <ELE3>
      <ELE4>
        <TITLE>General</TITLE>
        <LIST>
          <LITEM>
            <PARA>This is some paragraph text.</PARA>
          </LITEM>
        </LIST>
      </ELE4>
    </ELE3>
</TASK> 
```

我尝试了所呈现的内容，但除非我在文本或 PARA 部分添加 *，否则它似乎并不适用。我可能在那里也遗漏了一些东西。

```
<xsl:template match="TASK/*text()[preceding-sibling::*[1][self::REVST] and following-sibling::*[1][self::REVEND]]">
    <fo:block color="red" border-right="solid black 2pt" margin-right="16pt">
        <xsl:apply-templates />
    </fo:block>
</xsl:template>
<xsl:template match="LIST1/*PARA/text()[preceding-sibling::*[1][self::REVST] and following-sibling::*[1][self::REVEND]]">
    <fo:block color="green" border-right="solid black 2pt" margin-right="16pt">
        <xsl:apply-templates />
    </fo:block>
</xsl:template> 
```

有什么额外的建议吗？我仍然被困住:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:41:40.480

> 我一直在 w3schools.com 上阅读有关 xpath 轴的信息

这不是一个好的学习策略。w3schools 非常方便查找您曾经知道但已经忘记的东西，但它的组织方式无法帮助您理解基本概念。给自己买一本好书。

您的帖子向我表明您还没有理解上下文的重要概念。XPath 表达式的含义在很大程度上取决于上下文节点在其被评估点的位置。如果您确实了解上下文，我假设您会告诉我们使用这些表达式的上下文是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T02:40:57.180

**以下是如何做到这一点**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match=
 "TASK/text()[preceding-sibling::*[1][self::REVST]
            and
              following-sibling::*[1][self::REVEND]
              ]">

  Processing Type1 of: "<xsl:value-of select="."/>"
 </xsl:template>

 <xsl:template match=
 "LIST/PARA/text()[preceding-sibling::*[1][self::REVST]
                 and
                   following-sibling::*[1][self::REVEND]
                   ]">

  Processing Type2 of: "<xsl:value-of select="."/>"
 </xsl:template>

 <xsl:template match=
 "TASK/PARA/text()[preceding-sibling::*[1][self::REVST]
                 and
                   following-sibling::*[1][self::REVEND]
                   ]">

  Processing Type3 of: "<xsl:value-of select="."/>"
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t>
 <TASK> <REVST/>Some revised text<REVEND/> </TASK>
 <LIST> <PARA> <REVST />Some other revisedext <REVEND /> </PARA> </LIST>
 <TASK> <PARA> <REVST />Some yet other revised text <REVEND /> </PARA> </TASK>
</t> 
```

**产生了想要的结果（每个案例都以自己的方式处理）：**

```
 Processing Type1 of: "Some revised text"

  Processing Type2 of: "Some other revisedext "

  Processing Type3 of: "Some yet other revised text " 
```

**要记住的规则**：

将 XSLT 用作 ... XSLT。

这意味着：总是喜欢模板而不是内联`xsl:for-each`。前者的结果是简短、简单、不易出错、干净、更易于理解和维护的代码。后者会导致更长、更复杂、更丑陋、类似意大利面条的代码，这些代码容易出错、难以理解、难以扩展和维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:20:17.187

为什么不每次都使用完整路径：

```
/TASK/REVST
/LIST/PARA
/TASK/PARA/REVST 
```

# facebook-apps - 作为公司用户（而不是个人应用程序）如何构建 Facebook 应用程序？

> ID：11836765
> 
> 赞同：1
> 
> 时间：2012-08-06T22:15:49.590
> 
> 标签：facebook-apps

我正在为一个拥有 Facebook 公司页面的客户构建一个 Facebook 应用程序，我对如何开发该应用程序感到困惑，这样他们就可以在不将其与我自己的个人 FB 登录名绑定的情况下实际访问它（我显然不想授予他们访问权限）。

他们已将我作为管理员添加到他们的 FB 页面，但是当我登录该页面并转到 developer.facebook.com 时，我被告知要继续，我必须切换回我自己的个人帐户。

我确定我在这里遗漏了一些基本的东西，但是对于为第三方构建应用程序的过程是什么感到完全困惑，这样他们就不必给我他们的个人 FB 登录名，我也不需要必须给他们我自己的。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T11:12:28.543

您应该使用真实的个人帐户创建和管理 Facebook 应用程序。

您可以添加多个真实用户作为应用程序的管理员，并且可以将他们添加到多个不同的“角色”下。切勿将用户名和密码提供给他人以登录您的个人 Facebook 帐户。

您不应设置新的 Facebook 用户来管理应用程序。当 Facebook 的自动化系统检测到一个非真实用户帐户并且该帐户被暂停时，该帐户所连接的所有应用程序也将受到影响。

如果您想要一种简单的方法来控制可以访问多个应用程序的许多用户，您可以创建一个秘密 Facebook 群组 - 将您想要管理该应用程序的所有用户添加到该群组，然后在 Facebook 应用程序仪表板中，您可以添加组到应用程序的角色组之一。这种方法的优点是，如果有人加入或离开公司，您只需在该组中添加/删除他们，然后他们就可以编辑（或不编辑）该组已添加到的所有应用程序.

简而言之 - 始终使用您的真实账户 - 有一些方法可以让它为像您这样为客户构建应用程序的人工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:34:25.120

您将希望使用 FB 应用程序的**角色**设置来添加管理员（以及可选的开发人员、测试人员和洞察用户）。每个应用程序可以有多个管理员。当然，当您创建应用程序时，您将成为管理员。然后，转到应用设置中的**角色**选项卡并将其他人添加为管理员（注意，您必须是他们的 FB 好友）。然后，您添加的人员必须访问 Developers 站点，接受管理员请求（在**Apps**下），然后才能拥有管理员权限。

另一种方法是创建一个 FB 组，其成员是应用程序的管理员。这以相同的方式完成，但不是输入一个人的姓名，而是单击“添加管理员”对话框中的“为管理员创建组”。然后，将人员添加到组中。

事实上，您现有的任何 FB 组都可以添加为应用程序的管理员、开发人员、测试人员或洞察用户。

另一种选择是让客户端最初创建 FB 应用程序（即仅最低配置），然后将您添加为管理员。

有关角色的更多信息： [https ://developers.facebook.com/docs/ApplicationSecurity/](https://developers.facebook.com/docs/ApplicationSecurity/)

# asynchronous - 如何确保嵌套异步代码使用 Mocha 正确测试？

> ID：11836766
> 
> 赞同：1
> 
> 时间：2012-08-06T22:15:53.370
> 
> 标签：asynchronous, express, mocha.js

我正在使用 Mocha 并正在尝试测试我正在构建的 API。

我无法理解该`done()`函数的放置位置。

如果我把它放在现在的位置，它不会执行`User.findOne()`.

如果我将 done 放在回调函数的底部`User.findOne()`，那么它会创建一个超时。

我对 async 和这个 done 功能相对较新，所以有人可以帮助解释为什么会发生这两种情况，以及如何修复代码以便在 Mocha 中正确测试？

```
describe('POST /signup', function() {
  before(checkServerIsRunning); // Need to implement
  it('create a new user if username is unique', function(done) {
    httpReq({
      method : 'POST',
      url    : url + '/signup',
      json   : true,
      body   : JSON.stringify({ 
        username : 'test',
        first    : 'first',
        last     : 'last' })
      },
      function (err, res, body) {
        if (err) {
          done(err);
        }
        else {
          res.statusCode.should.be.equal(201);
          User.findOne( { username: 'test' }, function(err, user) {
            user.should.have.property('username', 'testy');
            user.should.have.property('firstName', 'first');
            user.should.have.property('lastName', 'last');
            usersToRemove.push(user);
          });
          done();
        }
      }
    );
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T13:09:52.277

你应该放在`done()`被调用的 to 里面`findOne`。

如果您发现它超时，那么要么`findOne`永远不会调用它的回调（这是一个错误！），要么执行时间太长。

在这种情况下，您可以通过在测试开始时粘贴类似`this.timeout(5000)`的东西来延长超时时间（这会将超时时间增加到 5 秒）。

一般来说，您通常不希望测试那么慢，所以也许尝试找出为什么需要这么长时间。

# android - Facebook 登录偶尔会返回空 JSON

> ID：11836770
> 
> 赞同：0
> 
> 时间：2012-08-06T22:16:12.933
> 
> 标签：android, facebook, parsing

我已经将 Facebook SSO 与我的 Android 应用程序集成在一起，我会说大约 80-85% 的时间它运行良好。但每隔一段时间，它就会返回一个空的 JSON，我不知道为什么。我正在使用[Parse](https://parse.com/)与 Facebook 集成，代码如下：

```
ParseFacebookUtils.logIn(mContext, new LogInCallback() {
    @Override
    public void done(ParseUser user, ParseException ex) {
        if (user != null) {
            //login successful
        } else if (ex != null) {
            ex.printStackTract();
            //something failed
        }
    }
}); 
```

这个 logIn() 方法基本上是 Facebook.authorize() 的包装器，它将结果发送到 Parse 自己的回调，任何异常都包装在 ParseException 中。当它失败时，它会给我一个 JSONException：

```
08-06 14:53:16.706: W/System.err(13996): com.parse.ParseException: org.json.JSONException: End  of input at character 0 of 
08-06 14:53:16.721: W/System.err(13996):    at com.parse.ParseUser$8.onError(ParseUser.java:944)
08-06 14:53:16.721: W/System.err(13996):    at com.parse.auth.FacebookAuthenticationProvider.handleError(FacebookAuthenticationProvider.java:189)
08-06 14:53:16.721: W/System.err(13996):    at com.parse.auth.FacebookAuthenticationProvider.access$1(FacebookAuthenticationProvider.java:185)
08-06 14:53:16.721: W/System.err(13996):    at com.parse.auth.FacebookAuthenticationProvider$GetUserIdBackgroundTask.onPostExecute(FacebookAuthenticationProvider.java:49)
08-06 14:53:16.721: W/System.err(13996):    at android.os.AsyncTask.finish(AsyncTask.java:417)
08-06 14:53:16.721: W/System.err(13996):    at android.os.AsyncTask.access$300(AsyncTask.java:127)
08-06 14:53:16.721: W/System.err(13996):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
08-06 14:53:16.725: W/System.err(13996):    at android.os.Handler.dispatchMessage(Handler.java:99)
08-06 14:53:16.725: W/System.err(13996):    at android.os.Looper.loop(Looper.java:123)
08-06 14:53:16.725: W/System.err(13996):    at android.app.ActivityThread.main(ActivityThread.java:4627)
08-06 14:53:16.733: W/System.err(13996):    at java.lang.reflect.Method.invokeNative(Native Method)
08-06 14:53:16.733: W/System.err(13996):    at java.lang.reflect.Method.invoke(Method.java:521)
08-06 14:53:16.733: W/System.err(13996):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
08-06 14:53:16.737: W/System.err(13996):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
08-06 14:53:16.737: W/System.err(13996):    at dalvik.system.NativeStart.main(Native Method)
08-06 14:53:16.737: W/System.err(13996): Caused by: org.json.JSONException: End of input at character 0 of 
08-06 14:53:16.757: W/System.err(13996):    at org.json.JSONTokener.syntaxError(JSONTokener.java:446)
08-06 14:53:16.757: W/System.err(13996):    at org.json.JSONTokener.nextValue(JSONTokener.java:93)
08-06 14:53:16.757: W/System.err(13996):    at org.json.JSONObject.<init>(JSONObject.java:154)
08-06 14:53:16.757: W/System.err(13996):    at org.json.JSONObject.<init>(JSONObject.java:171)
08-06 14:53:16.757: W/System.err(13996):    at com.parse.auth.FacebookAuthenticationProvider$GetUserIdBackgroundTask.doInBackground(FacebookAuthenticationProvider.java:38)
08-06 14:53:16.757: W/System.err(13996):    at com.parse.auth.FacebookAuthenticationProvider$GetUserIdBackgroundTask.doInBackground(FacebookAuthenticationProvider.java:1)
08-06 14:53:16.761: W/System.err(13996):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
08-06 14:53:16.761: W/System.err(13996):    at java.util.concurrent.FutureTask$Sync.innerRun (FutureTask.java:305)
08-06 14:53:16.761: W/System.err(13996):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-06 14:53:16.764: W/System.err(13996):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
08-06 14:53:16.764: W/System.err(13996):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
08-06 14:53:16.764: W/System.err(13996):    at java.lang.Thread.run(Thread.java:1096) 
```

通常，如果我只是在之后立即尝试再次登录，它就会起作用。由于它是如此不一致，我真的不知道是什么原因造成的。这是 Facebook 刚刚发生的事情，还是 Parse 更有可能是罪魁祸首？

在一个可能相关的注释中，由于超时或损坏的管道做同样的事情，我也会间歇性地得到 IOExceptions。这些通常会重复几次尝试，然后它会再次起作用。就像我说的，这些错误并不常见，但它们经常发生，足以让我认为 Facebook 的服务器不可能那么不可靠，而且可能还会发生其他事情。

还有其他人经历过类似的事情，尤其是 Parse 用户吗？

**编辑：**所以当我尝试通过 Facebook.request() 获取用户朋友的列表时，会弹出相同的错误：

```
String friends = ParseFacebookUtils.getFacebook().request("me/friends");
JSONObject result = Util.parseJson(friends); 
```

Parse 包含 Facebook SDK 的完整副本，因此此方法只是通过 Facebook 实例的标准纯调用。它在 10 次中工作 9 次，但是同样的周期性 JSONException 被抛出 parseJson();

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:27:48.790

我会联系 Parse 支持并询问他们可能出了什么问题。根据我广泛使用 Facebook Android SDK 的经验，我从未见过这样的错误。作为一个疯狂的猜测，可能会错误地将 OnError 回调视为常规回调，并尝试将响应解析为 JSON，而它是纯文本的。

是什么阻止您使用原始 Facebook SDK？这很简单

# php - 带有数组的嵌套foreach - php

> ID：11836774
> 
> 赞同：0
> 
> 时间：2012-08-06T22:16:53.777
> 
> 标签：php, arrays, foreach

我面临的问题是当我在另一个中使用一个 foreach 并且第一个 foreach 的数组有超过 1 个条目时。我想要做的是从数组2中排除数组1的所有条目。我几乎在所有相关的帖子上，无法自己解决，如果可能的话我需要一点帮助。对不起，我的英语不好。

例子：

`$choice`---> 每次都有随机条目数的数组（对于本例 2）

例子：

```
/var/www/clients/client1/web1/web/images,/var/www/clients/client1/web1/web/tmp 
```

`$list`---> 每次随机条目数的数组（对于本例为 10000）

例子：

```
/var/www/clients/client1/web1/web/images,/var/www/clients/client1/web1/web/tmp,/var/www/clients/client1/web1/web/includes,/var/www/clients/client1/web1/web/libraries,...... 
```

`$list`条目总是多于`$choice`

我在这里有这段代码：

```
foreach ( $choice as $select )
{
    foreach ( $list as $file )
    {
        if ( (strpos( $file, $select )) !== false ) 
        {
            // exclude this
        }
        else
        {
            // include this
        }
    }
} 
```

上面的代码会做什么（不幸的是）是：

步骤 1\. 将`$select`entry-1 与所有`$file`条目进行比较。

`$select`第 2 步。将从所有条目中排除条目 1 `$file`，并将包括 $select 条目 2。

步骤 3\. 将`$select`entry-2 与所有`$file`条目进行比较。

`$select`第 4 步。将从所有条目中排除条目 2 `$file`，并将包括 $select 条目 1。

结果：没有排除任何东西。

任何帮助真的很感激。我在这方面待了一个星期，我所尝试的只是把它们从里面拿出来，我没有想法。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:23:24.960

我相信您正在尝试从 $choice 中删除 $list 中的项目。（或者相反？）你试过[array_diff](http://www.php.net/manual/en/function.array-diff.php)函数吗？如果两个数组中的项目相等，这将起作用。例如：

```
<?php

//Option 1: array_diff
$bigger = array("A", "B", "C", "D", "E", "F");
$smaller = array("A", "B");

$result = array_diff($bigger, $smaller);
print_r($result); 
```

如果您需要对删除的项目进行额外处理，您可以尝试[in_array](http://www.php.net/manual/en/function.in-array.php)，但这需要项目相等（如上）。例如：

```
//Option 2: in_array (only one foreach loop)
foreach ($smaller as $key => $item) {
    if (in_array($item, $bigger)) {
        //do something to "remove" it, for example:
        unset($smaller[$key]);
        unset($bigger[$key]);
        //...
    }
}
print_r($smaller);
print_r($bigger); 
```

最后，如果不能保证两个数组中的项目严格相等，则可以使用双 foreach。您需要在内循环中标记项目并在外循环中处理它们。例如：

```
//Option 3: double-foreach (items not strictly equals)
$choice = array(
    "/var/www/clients/client1/web1/web/images",
    "/var/www/clients/client1/web1/web/tmp"
);

$list = array(
    "/var/www/clients/client1/web1/web/images",
    "/var/www/clients/client1/web1/web/tmp",
    "/var/www/clients/client1/web1/web/includes",
    "/var/www/clients/client1/web1/web/libraries",
    // more items
);

foreach ($choice as $choice_key => $choice_item) {
    $exists_in_list = FALSE;
    foreach ($list as $list_key => $list_item) {
        if (strpos($list_item, $choice_item) !== FALSE) {
            //$choice_item is string-contained inside $list_item:
            $exists_in_list = TRUE;

            //Do some processing on $list (while "$list_key" is in scope). For example:
            unset($list[$list_key]); //removes the matching items from $list
            //...

            break;
        }
    }
    if ($exists_in_list) {
        //Do post-processing on $choice. For example:
        unset($choice[$choice_key]); //removes the matching items from $choice
        //...
    }
}

echo '$choice is now ';
print_r($choice);

echo '$list is now ';
print_r($list); 
```

$结果是：

```
//Option 1:
Array //$result == $bigger - $smaller
(
    [2] => C
    [3] => D
    [4] => E
    [5] => F
)

//Option 2:
Array //$smaller - $bigger
(
)
Array //$bigger - $smaller
(
    [2] => C
    [3] => D
    [4] => E
    [5] => F
)

//Option 3:
$choice is now Array
(
)
$list is now Array
(
    [2] => /var/www/clients/client1/web1/web/includes
    [3] => /var/www/clients/client1/web1/web/libraries
) 
```

# ios - 越狱 - 重新定位 Core Data 应用程序的“文档”目录

> ID：11836775
> 
> 赞同：0
> 
> 时间：2012-08-06T22:17:08.883
> 
> 标签：ios, xcode, core-data, jailbreak

我制作了一个 Core Data 应用程序，我想将其保存`file.sqlite`到与默认目录不同的目录中。我遇到了这个[SO 线程](https://stackoverflow.com/questions/9065585/cydia-app-documents-folder-not-created)，然后发布了[这个 SO 问题](https://stackoverflow.com/questions/11812576/ios-how-to-change-documents-directory)，并且该项目似乎正在编译，但我`file.sqlite`没有保存在我指定的位置。我创建了一个方法，并向`AppDelegate.m`文件中添加了一些代码，但`storeURL`变量仍保存`file.sqlite`在默认的“文档目录”中。如何调用我在`AppDelegate.m`文件中创建的方法来指定`storeURL`变量的正确位置？

我是否应该改变，

```
NSURL *storeURL = [NSURL fileURLWithPath: [docPath stringByAppendingPathComponent:@"Accounts.sqlite"]]; 
```

到

```
NSURL *storeURL = [NSURL fileURLWithPath: [documentsDirectoryPath stringByAppendingPathComponent:@"Accounts.sqlite"]]; 
```

这也会破坏 iOS 模拟器的支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T17:35:40.577

我通过保留模拟器的默认*文档*路径，然后为设备设置不同的*文档*路径解决了这个问题。以下代码在我的*AppDelegate.m*文件中

```
// add conditional code for simulator and iDevice
#if TARGET_IPHONE_SIMULATOR
NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSString *docPath = [documentPaths objectAtIndex:0];

NSURL *storeURL = [NSURL fileURLWithPath: [docPath stringByAppendingPathComponent:@"Accounts.sqlite"]];
#else
// jailbroken path - /var/mobile/Library/KegCop/
NSString *docPath = self.documentsDirectoryPath;

NSURL *storeURL = [NSURL fileURLWithPath: [docPath stringByAppendingPathComponent:@"Accounts.sqlite"]];
#endif 
```

# java - 从java代码重新启动apache服务器？

> ID：11836777
> 
> 赞同：0
> 
> 时间：2012-08-06T22:17:16.693
> 
> 标签：java, apache, jakarta-ee

我想从 java webapp （重启按钮或类似）中执行 apache 服务器重启。例如`apachectl graceful`

如果有的话，我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:20:21.537

您可以在脚本中使用 apache 服务器启动命令，然后从您的 Java 代码中调用该脚本。

# c# - 使用接口时多态性如何？

> ID：11836781
> 
> 赞同：2
> 
> 时间：2012-08-06T22:17:49.837
> 
> 标签：c#, inheritance, interface, polymorphism

我没有得到接口与多态性的连接。
对我来说，多态性是关于使用抽象方法或虚拟方法+覆盖以不同的方式为某些不同的具体类执行方法，因此在我看来这仅与继承有关，但是如何使用接口覆盖方法？您如何使用接口以不同的方式执行相同的方法并让对象根据其具体类型决定要做什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:22:05.570

正如 Andreas Hartl 在[他关于继承与继承的文章中所述。接口](http://tipsandtricks.runicsoft.com/General/InheritanceVSInterfaces.html)：

> 许多高级语言支持继承和接口，对于刚接触这些概念的人来说，有时并不清楚该选择哪一种。尽管语言在对继承和接口的确切处理上有所不同，但基本原理通常是相同的，因此本技巧应该适用于大多数语言。
> 
> 继承意味着我们从另一个类（基类）派生一个类（派生类）。派生类是基类的扩展。它包含基类的所有特性（方法和数据成员），可以用新特性扩展它，并且可以重新实现基类的虚方法。一些语言，如 C++，支持多重继承，派生类可以有多个基类，但通常继承仅限于单个基类。
> 
> 接口通常只能定义方法而不能定义数据成员（但例如 C# 允许接口内的属性形式的数据成员），并且一个类总是可以实现多个接口。接口只包含没有实现的方法定义，实现接口的类提供实现。
> 
> 因此，使用继承，你编写了一个带有方法实现的基类，当你从它派生一个类时，这个类将继承基类的所有内容，并立即能够使用它的特性。另一方面，接口只是方法签名的契约，想要实现接口的类被迫提供接口所有方法的实现。
> 
> 那你什么时候用哪个？在某些情况下，语言已经规定了你使用什么：如果你需要你的类有多个“父母”，你不能在不支持多重继承的语言中使用继承。如果要重用库对象，则必须使用拟合概念，具体取决于该库对象是类还是接口。
> 
> 但是，如果您可以自由选择，该使用哪个？基本上，基类描述并实现了相关类型的共同行为，而接口描述了不相关类型可以实现的功能。继承描述“是一种”关系，接口描述“行为类似”关系。例如，假设您正在编写一个飞行模拟器。例如，您将存储在列表中的基本实体将是“飞机”。您的具体类型将是“协和”和“幻影”。那么应该如何对这三种类型进行建模呢？Concorde 和 Phantom 是相关的，它们都是飞机并且共享数据，如“重量”或“最大速度”和功能，如“加速”，因此我们可以通过继承对它们进行建模。'飞机' 将是具有通用数据和方法的基类，“Concorde”和“Phantom”将派生自“Airplane”。我们可以说两者都是专业飞机，这就是为什么人们常说继承意味着专业化。现在假设我们还在我们的程序中添加了一个类“Pilot”，并且我们希望让用户能够保存游戏并在以后加载它。所以当他保存游戏时，我们需要保存所有飞机的状态和所有飞行员的状态。我们想在一个函数中做到这一点，该函数只接受所有可保存对象的列表。那么我们如何建模呢？要回答这个问题，我们必须看看我们想要保存的不同类型。飞行员和飞机。很明显，它们根本没有关系。它们不共享通用数据和通用功能。我们可以看到，编写一个基类 'Saveable' 并从中派生 Pilot 和 Airplane 没有什么意义，因为 Saveable 中的任何代码都不能被 Airplane 或 Pilot 重用，因为它们没有共同的属性。在这种情况下，接口是最好的解决方案。我们可以使用 Save() 方法编写一个接口“ISaveable”。Pilot 然后可以通过保存他的名字来实现 ISaveable.Save()，而 Airplane 可以保存它当前的速度和坐标。
> 
> 如您所见，类之间关系的清晰图像通常可以明确选择：对相关类型使用继承，其中每个派生类“都是”基类。对具有一些通用功能的不相关类型使用接口。
> 
> 以下是继承和接口需要考虑的更多要点：
> 
> *   接口是固定的。当您更改接口时，您必须更改实现该接口的每个类。但是当您更改基类时，每个派生类都将获得新功能，这两者都很好（如果您在某些基类方法实现中进行错误修复，则使用该方法的派生类将获得错误修复，而无需您进行更改它）或坏的（如果基类的更改引入了新的错误，所有使用该方法的派生类也将被错误）。
>     
>     
> *   接口通常更灵活，因为在大多数语言中，您只能从一个类派生，但要实现许多接口
>     
>     
> *   接口有助于保护内部类：假设类 A 有一个类 B 的内部对象 b。当 A 中的方法返回一个指向 b 的指针或引用时，调用此方法的代码现在可以访问整个对象 b，这可以如果 A 只想暴露 b 的某些成员，则很危险。如果您只使用可以安全公开的成员创建接口 I，则可以解决此问题。当 B 实现此接口，并且您在 A 中的方法通过 I 指针或引用返回 b 时，外部代码只能通过接口执行您允许的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:37:47.553

多态作为一个概念不需要继承，尽管在许多语言中继承是实现它的唯一方法。一些语言，如 smalltalk，允许您以多态方式使用实现相同成员和属性集的任何类型。如果它长得像鸭子，叫起来像鸭子，走路像鸭子，你可以把它当作鸭子。

多态性只是通过提供与原始对象相同的方式访问和使用它来将一个对象视为另一个对象的能力。里氏替换原则最好地说明了这一点。这称为“接口”或有时称为“合同”，因为它定义了另一个对象可以用来对对象做有趣事情的“签名”。

在 C# 中，您可以从接口或其他（非密封）类继承。不同之处在于接口不提供任何实际的存储或方法（仅提供它们的“签名”），它只是一个定义。不能实例化接口，只能实例化实现接口的对象。

类实现接口（例如 IDisposable）的方式与基于蓝图建造房屋的方式相同。如果你用相同的蓝图建造两栋房子，那么每栋房子都有完全相同的“界面”，它们可能有不同颜色的油漆或地毯，但它们的功能完全相同，但它们是两座截然不同的房子，有很多各种事物如何运作的差异。

谈到 C#，只需知道接口说明了实现它的对象*必须*具有哪些属性或成员。同样，在 C# 中，一个很大的区别是您可以继承多个接口，但只能继承一个类。（即`public class Test : BaseClass, IDisposable, ITest, IFooBar`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:24:54.850

考虑这个...

```
public int SomeMethod(SomeBaseClass object)
{
  // Pass in a descendant classe that implements / overrides some method in SomebaseClass
}

public int SomeMethod(ISomeInterface intf)
{
   // pass in concrete classes that implement some ISomeInterface function 
} 
```

这是多态行为的基本本质，一个通用的契约，专门由一个专家类来实现。

# ruby-on-rails-3 - RoR：我怎样才能让人们在没有登录的情况下看到用户链接？

> ID：11836785
> 
> 赞同：0
> 
> 时间：2012-08-06T22:18:20.347
> 
> 标签：ruby-on-rails-3

我正在努力让没有帐户/未登录的人可以看到用户列表和所有用户帖子..

在我的 users_controller.rb 我有

```
class UsersController < ApplicationController
  before_filter :signed_in_user, 
                only: [:index, :edit, :update, :destroy]
  before_filter :correct_user,   only: [:edit, :update]
  before_filter :admin_user,     only: :destroy

  def index
    @users = User.paginate(page: params[:page])
  end

  def show
    @user = User.find(params[:id])
    @microposts = @user.microposts.paginate(page: params[:page])
  end 
```

我猜测 before_filter :signed_in_user 是它的原因，所以只有登录用户才能访问用户列表/查看用户配置文件。如何在不出错的情况下更改它？

目前，当我删除第 3 行的 :index 部分时，出现以下错误。

未定义的方法“管理员？” 对于零：NilClass

这是 /app/views/users/_user.html.erb 的第 4 行

```
<li>
2:   <%= gravatar_for user, size: 52 %>
3:   <%= link_to user.name, user %>
4:   <% if current_user.admin? && !current_user?(user) %>
5:     | <%= link_to "delete", user, method: :delete, confirm: "You sure?" %>
6:   <% end %>
7: </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:59:35.860

我假设你的文件中有类似`root :to => 'users#index'`的东西`routes.rb`。

“已登录/未登录”行为的常见解决方案包括根据身份验证状态有条件地重定向，或根据状态呈现各种部分。

在 下`index`，您的`@users`实例变量将始终包含分页的用户模型，无论状态如何。但是，我们无法知道是什么`signed_in_user`。如果您在代码中搜索`def signed_in_user`，您可以看到它的作用。这可能会揭示一些关于应用程序如何处理身份验证状态的信息——或者如果这是你正在构建的内容，还可以揭示如何进行。

**更新**

所以看起来你没有填充`current_user`对象。这通常是一种将返回对象的方法。

如果您使用的是 Devise，您可能需要对其进行一些额外的配置，以使该`current_user`辅助方法可用于您的视图。

该`nil`错误是由于`current_user`返回 nil 或根本不存在而导致的。所以它本质上是在尝试`nil.admin?`并导致错误被引发。

也许您正在寻找的逻辑是，

```
<li>
<%= gravatar_for user, size: 52 %>
<%= link_to user.name, user %>
<% if current_user.present? && current_user.admin? && !current_user?(user) %>
| <%= link_to "delete", user, method: :delete, confirm: "You sure?" %>
<% end %> 
```

您还可以`current_user`从 Rails 调试器控制台调查 ​​的值。你可以在你的控制器中添加一个`debugger`语句，然后到处玩。此外，您还可以使用 Rails 控制台（从命令行运行`rails console`）并在那里玩耍。

**更新 2**

> 那么为什么当我包含 :index 时填充 current_user 对象没有问题。为什么删除它（见上面的问题）会导致 current_user 变得人口稀少

我们不知道`signed_in_user`进一步调查的方法是什么。

但是，我有一种预感，那`current_user == nil`是`true`因为您根本没有登录。

# php - Zend_Reflection 没有得到某些类的文档块

> ID：11836787
> 
> 赞同：2
> 
> 时间：2012-08-06T22:18:29.920
> 
> 标签：php, zend-framework, reflection, doctrine-orm

我正在尝试使用 Zend_Reflection 来读取某些类的文档块：

这是我的代码

```
 $r = new Zend_Reflection_Class($class);
  $docblock = $r->getDocblock(); 
```

它适用于具有如下文档块的类：

```
/**
 * Zend Framework
 *
 * LICENSE
 *
 * This source file is subject to the new BSD license that is bundled
 * with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://framework.zend.com/license/new-bsd
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@zend.com so we can send you a copy immediately.
 *
 * @category   Zend
 * @package    Zend_Barcode
 * @subpackage Renderer
 * @copyright  Copyright (c) 2005-2011 Zend Technologies USA Inc. (http://www.zend.com)
 * @license    http://framework.zend.com/license/new-bsd     New BSD License
 * @version    $Id: Image.php 23775 2011-03-01 17:25:24Z ralph $
 */

/** @see Zend_Barcode_Renderer_RendererAbstract*/
require_once 'Zend/Barcode/Renderer/RendererAbstract.php';

/**
 * Class for rendering the barcode as image
 *
 * @category   Zend
 * @package    Zend_Barcode
 * @copyright  Copyright (c) 2005-2011 Zend Technologies USA Inc. (http://www.zend.com)
 * @license    http://framework.zend.com/license/new-bsd     New BSD License
 */
class Zend_Barcode_Renderer_Image extends Zend_Barcode_Renderer_RendererAbstract 
```

但是在下面的类中，它是一个 Doctrine 2 实体定义，它不起作用，

```
<?php
namespace DbEntities\Entity;

/**
 * Class for archived companies
 * 
 * @category DbEntities
 * @package Ycode_DbEntities
 * @copyright Copyright (c) 2012
 * @licence Porprietory Code 
 * @Table(name="Archiveddeal",
 *      indexes={
 *          @index(name="textualIdentifier_idx", columns={"textualIdentifier"}),
 *          @index(name="rank_idx", columns={"rank"}),
 *          @index(name="realunique_idx", columns={"realunique"}),
 *          @index(name="coordinations_idx", columns={"latitude","longitude"})
 *      })
 * @Entity
 * @HumanFriendlyName = "Archived Companies"
 * @author Jim
 */
class Archivedcompany extends \Application_Model_Archivedcompany{ 
```

它在我的代码的第 2 行引发以下错误：

```
 No valid tag name found within provided docblock line 
```

第一个文件的 $class 值是“Zend_Barcode_Renderer_Image”，对于第二个文件，我尝试了“DbEntities\Entity\Archivedcompany”和“\DbEntities\Entity\Archivedcompany”，它们返回相同的错误。

我不确定是不是混淆 ZendReflection 的命名空间，当我使用 PHP 的反射时，一切似乎都有效

```
 $rc = new ReflectionClass($class);
 $comments = $rc->getDocComment(); 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T06:46:50.580

有类似的问题。我猜你有 Windows 行尾。尝试将行尾从 Windows 转换为 Unix 样式。

# objective-c - 归档/取消归档 NSTableViewController 数据的最佳实践？

> ID：11836793
> 
> 赞同：2
> 
> 时间：2012-08-06T22:19:08.640
> 
> 标签：objective-c, cocoa, cocoa-design-patterns

我有一个拥有 nib 文件的 NSWindowViewController。nib 文件中的对象之一是 NSTableView，由 NSTableViewController（也是 nib 的一部分）管理。

我想实现 NSCoding 协议来保存所有模型数据，其中一些包含在 NSTableViewController 中（我将简称为 TVC）。归档整个 TVC 似乎是错误的答案，因为当它稍后取消归档时，它不会连接到笔尖。虽然我可能会以编程方式重新连接所有内容……但这看起来很笨拙。

我可以让 NSWindowViewController 从 TVC 中获取表数据，但这意味着我必须公开所有 ivars，这似乎也是错误的解决方案。

归档/取消归档 TVC 中存储的数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:47:07.670

表视图控制器应该具有对存储数据的模型的引用，或者如果您的应用程序很简单，您可能会将模型数据存储在表视图控制器的数组或字典中。它是那个数组或字典，不管你的数据应该被归档，而不是表视图控制器。

# graphviz - Graphviz - 如何显示集中边缘的边缘计数？

> ID：11836796
> 
> 赞同：2
> 
> 时间：2012-08-06T22:19:44.660
> 
> 标签：graphviz, dot, graph-visualization

我有一个有向图，将重叠边集中到一个边上。下面给出了一个示例 .dot 文件：

```
strict digraph Test {
concentrate=true
A -> B;
A -> B;
A -> B;
} 
```

我想将重叠边缘的数量显示为边缘标签。这听起来很微不足道，但我无法弄清楚如何做到这一点。这可能吗？如果可能的话，我该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-11T00:10:05.027

唯一的方法是自己对 .gv 文件进行一些后处理，然后再将其提供给 dot。您必须修改输出以明确包含所需的文本，例如：

```
strict digraph Test
{
    concentrate=true
    A -> B [label="3 connections between A and B"];
} 
```

# jquery - 如何从 JQuery getJSON 的 JSON 对象中提取数据

> ID：11836799
> 
> 赞同：0
> 
> 时间：2012-08-06T22:20:01.497
> 
> 标签：jquery

我正在尝试显示如下所示的 JSON 数据：

```
{
    "response": {
        "@attributes": {
            "status": "ok",
            "version": "12"
        },
        "label": {
            "@attributes": {
                "plid": "1234",
                "name": "demo"
            }
        },
        "page": {
            "@attributes": {
                "name": "bookinfo"
            },
            "count": 1,
            "pages": "144",
            "current_page": 1,
            "isbn10": "0824828917",
            "isbn13": "9780824828912",
            "title": "Surf Science",
            "author": "Tony Butt - Paul Russell - Rick Grigg",
            "binding": "Paperback",
            "msrp": 34,
            "publisher": "University of Hawaii Press",
            "published_date": "2004-07-01",
            "edition": "2nd",
            "rank": 176243,
            "rating": 0,
            "_amazon_item": null,
            "image": "http:\/\/ecx.images-amazon.com\/images\/I\/51-dKe7tztL._SL75_.jpg"
        }
    }
}​ 
```

我知道 JQuery 调用 .getJSON 可用于获取类似上述对象的对象，但我不知道如何从中提取数据，以便可以在网页上动态显示它。关于如何使用 JQuery/Javascript 做到这一点的任何想法？例如，我将如何获得作者或标题？

下面是我的代码（唯一的区别是，当我测试它时，我实际上使用了我的真实密钥）：

```
 <!DOCTYPE html>
    <html lang="en-US">
    <head>
      <meta charset="UTF-8">
      <script src="http://code.jquery.com/jquery-latest.js"></script>
    </head>
    <body>

    <script type="text/javascript">

    $.ajax({
      type: "GET",
      url: "http://api2.campusbooks.com/12/rest/search",
      dataType: "json",
      data: {
        key : "[my_key]",
        keywords : "calc",
        timeout : "7",
        format : "json"
      },
      success: function(jsonData) {
        console.log("Success! " + jsonData);
      },
      error: function(jsonData) {
        console.log("Error! " + jsonData);
      }
    });
      </script>

    </body>
    </html> 
```

萤火虫控制台中的打印内容是：

```
 Error! [object Object] 
```

所以返回的对象只是[object Object]。“错误！”部分来自我的代码。当我将所有变量放入 1 个 url 并转到它时，页面会显示：

```
{"response":{"@attributes":{"status":"ok","version":"12"},"label":{"@attributes":{"plid":"[1234]","name":"[my_name]"}},"page":{"@attributes":{"name":"search"},"count":1000,"pages":100,"current_page":1,"results":{"book":[{"isbn10":"0538497394","isbn13":"9780538497398","title":"Essential Calculus: Early Transcendentals, Enhanced Edition (with Enhanced WebAssign with eBook Printed Access Card for Multi Term Math and Science)","author":"James Stewart","binding":"Hardcover","msrp":177.95,"pages":"944","publisher":"Brooks Cole","published_date":"2010-01-01","edition":"1","rank":12133,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/41%2Bk0odfWaL._SL75_.jpg"},{"isbn10":"1439058474","isbn13":"9781439058473","title":"Dosage Calculations (Available Titles 321 Calc!dosage Calculations Online)","author":"Gloria D. Pickar - Amy Pickar-Abernethy","binding":"Paperback","msrp":90.95,"pages":"720","publisher":"Delmar Cengage Learning","published_date":"2012-01-01","edition":"9","rank":2004,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/41TcBjzhPnL._SL75_.jpg"},{"isbn10":"0840065639","isbn13":"9780840065636","title":"Applied CALC (with Mathematics CourseMate with eBook Printed Access Card)","author":"Frank Wilson","binding":"Paperback","msrp":83.95,"pages":"256","publisher":"Brooks Cole","published_date":"2011-01-01","edition":"1","rank":514542,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/516p3a40S4L._SL75_.jpg"},{"isbn10":"1430231599","isbn13":"9781430231592","title":"Beginning OpenOffice Calc: From Setting Up Simple Spreadsheets to Business Forecasting","author":"Jacek Artymiak","binding":"Paperback","msrp":39.99,"pages":"136","publisher":"Apress","published_date":"2011-09-05","edition":"1","rank":682980,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51FFF95bq4L._SL75_.jpg"},{"isbn10":"0071488456","isbn13":"9780071488457","title":"Bob Miller's High School Calc for the Clueless - Honors and AP Calculus AB & BC (Bob Miller's Clueless Series)","author":"Bob Miller","binding":"Paperback","msrp":12.95,"pages":"246","publisher":"McGraw-Hill","published_date":"2007-08-14","edition":"1","rank":1121409,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51Adl-dr0cL._SL75_.jpg"},{"isbn10":"0821848178","isbn13":"9780821848173","title":"Riot at the Calc Exam and Other Mathematically Bent Stories","author":"Colin Adams","binding":"Paperback","msrp":32,"pages":"271","publisher":"American Mathematical Society","published_date":"2009-07-21","edition":"","rank":625803,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51Jvoh2ZQtL._SL75_.jpg"},{"isbn10":"111816170X","isbn13":"9781118161708","title":"Calculus II For Dummies","author":"Mark Zegarelli","binding":"Paperback","msrp":19.99,"pages":"384","publisher":"For Dummies","published_date":"2012-01-24","edition":"2","rank":16179,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51W8PJsg%2BZL._SL75_.jpg"},{"isbn10":"1847190979","isbn13":"9781847190970","title":"Learn OpenOffice.org Spreadsheet Macro Programming: OOoBasic and Calc automation: A fast and friendly tutorial to writing macros and spreadsheet applications","author":"Dr Mark Alexander Bain","binding":"Paperback","msrp":39.99,"pages":"220","publisher":"Packt Publishing","published_date":"2006-12-22","edition":"","rank":1118193,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51SOipRUqOL._SL75_.jpg"},{"isbn10":"0495014281","isbn13":"9780495014287","title":"Essential Calculus: Early Transcendentals (Stewart's Calculus Series)","author":"James Stewart","binding":"Hardcover","msrp":190.95,"pages":"912","publisher":"Brooks Cole","published_date":"2006-03-01","edition":"1","rank":1392,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/41T-md-t%2B6L._SL75_.jpg"},{"isbn10":"0764146939","isbn13":"9780764146930","title":"Barron's AP Calculus, 11th Edition","author":"David Bock  M.S. - Shirley O. Hockett  M.A.","binding":"Paperback","msrp":18.99,"pages":"696","publisher":"Barron's Educational Series","published_date":"2012-02-01","edition":"11","rank":3475,"rating":0,"image":"http:\/\/ecx.images-amazon.com\/images\/I\/51GENtM0pGL._SL75_.jpg"}]}}}} 
```

使用的网址：

```
http://api2.campusbooks.com/12/rest/search?key=[my_key]&keywords=calc&timeout=7&format=json 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:30:42.147

假设 JSON 如您所示返回，这是一个示例：

```
$.getJSON("some/URL", function(jsonData) {
    $("#titleDiv").html(jsonData.response.page.title); 
    // #titleDiv now holds the text "Surf Science"

    // another way
    $("#authorDiv").html(jsonData["response"]["page"]["author"]);
    // #authorDiv now holds the text "Tony Butt - Paul Russell - Rick Grigg"
}); 
```

也许更好的方法是使用`$.ajax`，因为无论如何这都是 jQuery 在幕后使用的。通过这种方式，您可以指定成功和错误处理函数，这将有助于调试您可能遇到的任何问题：

```
$.ajax({
  type: "GET",
  url: "http://api2.campusbooks.com/12/rest/bookinfo",
  dataType: "json",
  data: {
    key : "[yourkey]",
    isbn : "0538497815",
    timeout : "6",
    format : "json"
  },
  success: function(jsonData) {
    console.log("Success! " + jsonData);
  },
  error: function(request, status, error) {
    console.log("Error! " + request.responseText);
  }
}); 
```

如果发生错误，您应该能够通过查看浏览器的 JavaScript 控制台找出它是什么。顺便说一句，您可以像我上面所做的那样指定参数，而不是将它们放入 URL 中。

还有许多开发人员工具可用于帮助处理此类事情，例如Google Chrome的[REST 控制台应用程序或 Firefox 的](https://chrome.google.com/webstore/detail/cokgbflfommojglbmbpenpphppikmonn)[RESTClient 插件](https://addons.mozilla.org/en-us/firefox/addon/restclient/)。它们使您可以轻松输入请求参数并确定可能导致问题的原因。

# generics - 支持 null 的结构和引用类型的类型约束

> ID：11836807
> 
> 赞同：2
> 
> 时间：2012-08-06T22:21:12.687
> 
> 标签：generics, f#, constraints

是否可以将类型限制为支持 null 的结构或引用类型？类似于此函数的*假设*约束：

```
let getOrDefault<'T when ('T : struct) or ('T : null)> (d: IDictionary<_, 'T>) key =
  match d.TryGetValue(key) with
  | true, v -> v
  | _ -> Unchecked.defaultof<'T> 
```

该函数不应与 F# 类型一起使用，除非用`[<AllowNullLiteral>]`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T06:11:00.420

我认为你不能`or`在两个约束之间放置一个。通常当我需要像constraint1或constraint2或...或constraintN这样的东西时，我所做的是创建重载：

```
open System.Collections.Generic

// unconstrained function
let getOrDefaultG (d: IDictionary< _ , 'T>) key =
  match d.TryGetValue(key) with
  | true, v -> v
  | _ -> Unchecked.defaultof<'T>

// individually constrained
let getOrDefaultS<'K,'T when 'T :struct> (d:IDictionary<'K,'T>) = getOrDefaultG d
let getOrDefaultN<'K,'T when 'T :null  > (d:IDictionary<'K,'T>) = getOrDefaultG d

// overloads
type GetOrDefault = GetOrDefault with
    static member ($) (GetOrDefault, d) = fun dummyArg        -> getOrDefaultS d
    static member ($) (GetOrDefault, d) = fun (dummyArg:unit) -> getOrDefaultN d

// the desired function
let inline getOrDefault d key = (GetOrDefault $ d) () key 
```

注意： dummyArg 是我用来创建两个不同签名并使其编译的技巧。

# iphone - 在 iPhone 应用程序中解析 twitter-json

> ID：11836808
> 
> 赞同：0
> 
> 时间：2012-08-06T22:21:13.913
> 
> 标签：iphone, objective-c, xcode, json, twitter

在我找到一个可以学习的非常好的教程之前，我曾经在解析 json 时遇到了麻烦。当我构建自己的 web 服务来解析 json 时，我遵循了相同的步骤，但是现在当我尝试解析 twitters json-feed 时，我正在画空白。这是我的代码。

```
NSError* error;
NSDictionary* json = [NSJSONSerialization 
                      JSONObjectWithData:responseData //1

                      options:kNilOptions 
                      error:&error];

NSArray* itemNumber = [json objectForKey:@"posts"]; //2

NSUInteger numObjects = [itemNumber count];

arrayTweets = [[NSMutableArray alloc] init];
arrayTimes = [[NSMutableArray alloc] init];

if (numObjects != 0) {

    int i = 0;
    do
    {
        NSDictionary* loan = [itemNumber objectAtIndex:i];

        NSString* text = [(NSDictionary*)loan objectForKey:@"text"];
        [arrayTweets addObject:text];

        NSString *time = [(NSDictionary*)loan objectForKey:@"created_at"];
        [arrayTweets addObject:time];

        i++;

    } while (i < numObjects);

} else {
    NSLog(@"Nej");
}

[tableTweet performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO]; 
```

注意 "NSArray* itemNumber = [json objectForKey:@"**帖子**"];"。因为我的旧 json-feed 曾经看起来像这样......

```
{"status":"ok","count":4,"count_total":4,"pages":1,"posts":[{"id":58,"type": 
```

它一直在工作，因为我之前有“帖子”：[，但现在有了 twitter 提要，它刚刚开始：

```
[{"created_at":"Mon Aug 06 19:16:42 +0000 2012","id":232555817835048961,"... 
```

我不知道该怎么做。我意识到这很愚蠢，但除非有人向我解释，否则我认为我不会学习。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:30:02.207

啊，你的代码有一个小问题。您之前提要的根对象曾经是一本字典。您可以通过`{`开头的标志看到这一点。您的新提要立即为您返回一个数组`[`。因此，您不必将数据解析为字典，而是解析为 NSArray。事不宜迟，这里解释：[https ://stackoverflow.com/a/8356919/341358](https://stackoverflow.com/a/8356919/341358)

# javascript - 克隆的表单字段未提交（没有 $_POST 数据）

> ID：11836809
> 
> 赞同：0
> 
> 时间：2012-08-06T22:21:25.240
> 
> 标签：javascript, jquery, forms, clone

我在表格中有一个表格，可以选择复制某一行（从而允许用户根据需要添加更多字段）。克隆工作正常，事件数据和处理程序工作正常。但是，当提交表单时，克隆的表单字段数据不会发布。下面是我用于克隆字段的代码，它可以正常工作并解决任何重复 ID 的问题。任何关于为什么克隆字段不提交的建议/帮助将不胜感激。

```
$('#btnAddNewField').click(function() {
    var currLength = $('.cloneInput').length;   
    var newID = new Number(currLength + 1); 

    var clonedField = $('#field_id' + currLength).clone(true);  
    clonedField[0].setAttribute('id', 'field_id' + newID);      
    clonedField.find(':text').each(function() {                             
        this.setAttribute('id', this.getAttribute('id') + newID);               
        this.setAttribute('name', this.getAttribute('name') + newID);       
    });
    $('#field_id' + currLength).after(clonedField); 
```

HTML：

```
<tr id="field_id_1">
    <td>
    <table>             
        <tr>
            <td>Pick option</td>
            <td> 
                <select name="choice_1" id="choice_1"  parent="true">
                    <option value="null" selected="selected">Select</option>
                    <option value="1">option 1</option>
                    <option value="2">option 2</option>
                    <option value="3">option 3</option>             
                </select>
            </td>
        </tr>
        <tr>
            <td>Pick next option</td>
            <td> 
                <select name="next_choice_1" id="next_choice_1">
                    <option value="null" selected="selected">Select next</option>                
                </select>
            </td>
        </tr>             
         <tr>
            <td>Image:</td>
            <td><input type="file" name="image_1" id="image_1"/></td>
        </tr>           
    </table>
    </td>                               
</tr> 
<tr>
    <td></td>
    <td> 
        <input type="button" value="Add New" id="btnAddNewField" /> 
        <input type="button" value="Remove" id="btnDelField" />
    </td>        
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:23:53.823

我看不到您更改克隆表单字段的名称属性的任何地方。您需要更改此设置，以免发布的数据被其他字段覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:24:19.447

我认为您对 post 的工作方式有误。您实际上应该为克隆字段创建一个新名称，因为这是用于发布变量的名称。创建一个新的 id 只需要生成有效的 html，但与实际发布无关。

# php - 创建一个自定义属性并将其添加到类别网格视图 Magento

> ID：11836810
> 
> 赞同：0
> 
> 时间：2012-08-06T22:21:31.353
> 
> 标签：php, magento, e-commerce

在我的一些产品（不是全部）上，我需要添加一个下拉列表以从产品列表中进行选择（因产品而异）。实现此功能的最佳方法是什么，以便在前端类别网格上的“添加到购物车”旁边选择它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:30:52.437

我就在几天前这样做了。您想`simple`在类别页面中显示任何可配置产品的产品下拉列表，对吗？检查下面的链接，它将逐步向您解释实施它。如果您有不同的想法，请告诉我。

[http://www.catgento.com/adding-configurable-product-options-to-category-list-in-magento/](http://www.catgento.com/adding-configurable-product-options-to-category-list-in-magento/)

# php - 如何在替换整个文档的同时更新 mongodb 文档？

> ID：11836814
> 
> 赞同：3
> 
> 时间：2012-08-06T22:21:39.890
> 
> 标签：php, mongodb

如果我有一个包含两个值的文档：

```
{
  "name" : "Bob",
  "location" "France"
} 
```

然后将一个数组传递给包含“name”、“country”的文档。如何确保更新整个文档，删除“位置”？

我不会意识到这两个文档之间的差异，因此我无法取消设置特定字段。我正在寻找一种方法来简单地用提供的数组替换文档数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T22:38:56.960

如果您提供`update`包含所需记录的新文档，您将替换该文档。

例如：

```
db.so.insert({"name":"Bob", "location": "France"})
db.so.update({"name":"Bob", "location": "France"}, {"name":"Roberto", "country":"Italy"})
db.so.find()

{ "_id" : ObjectId(), "name" : "Roberto", "country" : "Italy" } 
```

当然，如果您有`_id`文档，这将是指定更新的更好方法（而不是像上面那样传回您刚刚插入的文档）

# asp.net-mvc-3 - IIS Web App 性能问题....MVC3

> ID：11836818
> 
> 赞同：0
> 
> 时间：2012-08-06T22:22:01.723
> 
> 标签：asp.net-mvc-3, performance, iis

我有一个 MVC3 C#.Net 网络应用程序。它在 Windows Server 2008 R2 上的 IIS 7 上运行。我们在最初加载页面时注意到显着的性能问题。我们正在使用 nHibernate，并且发现在某些情况下性能很慢。但是所有页面，即使是简单的页面，行为都相似。我不是一个真正的IIS stud所以......

我是否遗漏了 IIS 中的某些内容……我可以调整以提高性能的设置或操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T12:58:52.033

我在只为应用程序池分配 100MB RAM 的共享主机上运行站点时遇到了类似的问题。当您超过该 IIS 设置为回收它。该应用程序通常以大约 120MB 运行，因此不断回收。随着整个事情的重新开始，每个页面的加载速度都非常缓慢。增加应用程序池可用的 RAM 可修复它。

我会尝试的另一件事是设置 SQL 分析器并观察发送到数据库的查询。您可以将其配置为以比默认值更小的增量报告持续时间列（也许是微秒？），这使得痛苦的那些脱颖而出。然后，您可以挑选那些可疑的，通过打开“显示执行计划”的查询分析器运行它们并检查子树成本。也许 NHibernate 正在生成讨厌的查询或者[太多](https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem)？

# ios - iOS 使用 Rhomobile 调整图像大小生成旋转图片

> ID：11836824
> 
> 赞同：0
> 
> 时间：2012-08-06T22:22:38.280
> 
> 标签：ios, camera, rhomobile, rhodes

我正在使用 Rhodes 3.3.3 为 iOS 和 Android 开发。我的应用程序使用相机，我需要调整图片大小。我使用以下 Rhodes 命令来调整图片大小：

```
settings = {:enable_editing => false, :desired_width => 800, :desired_height => 800}
Camera::take_picture(url_for(:action => :camera_callback_new), settings) 
```

文档：[http ://docs.rhomobile.com/rhodes/device-caps#camera](http://docs.rhomobile.com/rhodes/device-caps#camera)

返回的图片已调整大小。但是，如果以纵向模式拍摄，则旋转 90 度，如果以横向模式拍摄，则旋转 180 度。

我的问题的视觉解释：[https ://groups.google.com/forum/?fromgroups#!topic/rhomobile/W0b46OllwRw](https://groups.google.com/forum/?fromgroups#!topic/rhomobile/W0b46OllwRw)

相机的罗德源代码链接如下。到目前为止，我还没有弄清楚问题出在哪里。如果我不指定调整大小，则图片不会旋转。到目前为止，罗德支持一直忽略我的请求。

[https://github.com/rhomobile/rhodes/blob/master/platform/iphone/Classes/Camera/PickImageDelegate.m](https://github.com/rhomobile/rhodes/blob/master/platform/iphone/Classes/Camera/PickImageDelegate.m)

谢谢，

缺口，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:31:44.637

我通过使用 UIImage+Resize 库解决了这个问题。完整的拉取请求在这里：

[https://github.com/rhomobile/rhodes/pull/81](https://github.com/rhomobile/rhodes/pull/81)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T06:34:01.840

您是否尝试过 Launchpad 开发者社区？它是 RhoElements 开发人员的论坛

[Launchpad 开发者社区](https://developer.motorolasolutions.com)

你可以免费注册。

# .htaccess - 简单的 .htaccess 重写不起作用

> ID：11836825
> 
> 赞同：0
> 
> 时间：2012-08-06T22:22:49.920
> 
> 标签：.htaccess, rewrite

我的服务器上有一个 .htacces 应该这样做：

你进入 ziced.com/cl/something 并将其重写为 ziced.com/cl/index.php?var1=something，但是不起作用。

您可以通过输入 ziced.com/cl/faq 与 ziced.com/cl/index.php?var1=faq 来检查是否不起作用

这是.htaccess

```
AddHandler application/x-httpd-php5 .php

# This is the initialization
# For security reasons, Option followsymlinks cannot be overridden.
#Options +FollowSymLinks
#Options +SymLinksIfOwnerMatch
RewriteEngine On

RewriteBase /

#chilean redirect

# /cl/var1
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^cl/([a-zA-Z0-9\.\*\°\~\,\%\"\'\+\(\)\-]+)/?$ /cl/index.php?var1=$1 [L,QSA] 
```

我可能知道问题出在哪里，但我不知道如何解决。具有重写规则的网页 ziced.com 是 metrikstudios.com 的一个插件域

ziced.com 指向metrikstudios.com/ziced/ 所以，也许我应该添加类似：

```
RewriteRule ^ziced/cl/([a-zA-Z0-9\.\*\°\~\,\%\"\'\+\(\)\-]+)/?$ /cl/index.php?var1=$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:03:16.297

解决了这个问题。在子目录 ziced (metrikstudios.com/ziced) 中添加了 .htacces。然后它工作完美。

希望它在未来对某人有用

# c# - 将值从网格视图传递到新页面 ASP.NET C#？

> ID：11836826
> 
> 赞同：0
> 
> 时间：2012-08-06T22:23:01.710
> 
> 标签：c#, asp.net, gridview

我有一个网格视图。我想从网格视图中获取选定的行，并将该行中的列值传递到新页面，同时将该值存储在会话中。

到目前为止，我知道如何将其存储为 tut 中的字符串，但不知道如何将值保持为 int 格式而不将其转换为字符串。

这是我在 C# 代码中的内容...就像我说的那样，这确实将行写为字符串类型，我希望它保持为 int。

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "Select")
        {
            Int16 num = Convert.ToInt16(e.CommandArgument);
            TextBox2.Text = GridView1.Rows[num].Cells[0].Text;

        }
    } 
```

将其放入会话将很容易。我发现它是：

```
Session["customerID"] =  GridView1.Rows[num].Cells[0].Text; 
```

所以现在真正的问题是如何将值保持为 int 格式。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:30:25.237

不能直接保存为 int 类型。Session 将值保存为对象类型。所以你必须将它转换为int。

```
int customerID = (int) Session["customerID"];
      // or
int customerID = Convert.ToInt32( Session["customerID"].ToString());
     // or
int customerID = int.Parse( Session["customerID"].ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:31:58.213

您可以通过执行以下操作来获得价值：

```
var myInt = (int)Session["customerID"] 
```

会话变量可以存储任何对象，而不仅仅是字符串。从技术上讲，您可以将整个 gridview 对象存储在会话变量中。

# php - PHP - 删除粗体文本

> ID：11836832
> 
> 赞同：2
> 
> 时间：2012-08-06T22:23:22.270
> 
> 标签：php, regex, text

我有一些文字：`This is <b>an</b> example <b>text</b>.`

我将如何删除粗体标签内的所有文本，所以它应该输出：

`This is example.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:28:35.670

使用**[preg_replace()](http://php.net/manual/fr/function.preg-replace.php)**
如果您想删除一个简单的标签以及其中的文本：

```
<?php 
$string = 'This is <b>an</b> example <b>text</b>';
echo preg_replace('/(<b>.+?)+(<\/b>)/i', '', $string); 
```

**输出：**
这是示例

* * *

并带有正则表达式（类，id），间距错误和反斜杠：

```
<?php
$string = 'This is <b class="c1" id=\'c2\'>an</b> example <b>text</B >'; 
echo preg_replace('@<(\w+)\b.*?>.*?</\1.*?>@si', '', $string); 
```

**输出：**
这是示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:27:06.923

简单的解决方案：

```
echo str_replace(array('<b>', '</b>'), '', 'This is <b>an</b> example <b>text</b>'); 
```

可能有更好的技术。在这里，我只是用一个空字符替换数组中每个出现的序列。有关详细信息，请参阅[php.net](http://php.net/manual/en/function.str-replace.php)。他们在那里有一个类似的例子：

```
// Provides: Hll Wrld f PHP
$vowels = array("a", "e", "i", "o", "u", "A", "E", "I", "O", "U");
$onlyconsonants = str_replace($vowels, "", "Hello World of PHP"); 
```

**编辑。**我错过了正则表达式标签，但正则表达式为此目的有点矫枉过正？

# neo4j - Neo4j 中的自动增量

> ID：11836838
> 
> 赞同：4
> 
> 时间：2012-08-06T22:23:46.053
> 
> 标签：neo4j

有没有办法像在 MySQL for Neo4j 中那样设置 auto_increment？例如，当我使用 GraphDatabaseService 对象创建节点时，我希望节点以 1000000000 之类的数字开头。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T22:57:02.427

查看这个答案：[我可以在 neo4j 中创建一个具有指定 ID 的节点吗？](https://stackoverflow.com/questions/8626470/can-i-create-a-node-in-neo4j-with-specified-id)

Neo4J 为每个对象分配的 ID，与分配给数据库中一行的 PK 不同。节点索引中的位置反映在 Neo4J 分配的 ID 中。在关系数据库中，值只是您可以查找的唯一索引键。一种更简洁的方法是创建一个任意 Index 值作为 Node 属性并对其进行索引（这样您就可以对其进行快速查找）。

# objective-c - 子类化 UIViewController 加载问题的子类

> ID：11836839
> 
> 赞同：0
> 
> 时间：2012-08-06T22:23:51.087
> 
> 标签：objective-c, ios, uiviewcontroller, subclassing

所以，这就是问题所在。我对 iOS 编程比较陌生，并且我已经承担了一个巨大的项目。

我正在开发一个具有多个级别的游戏，这些级别基本上遵循相同的模式，但具有不同的精灵图像和值，我只是为了速度而决定在 IB 中布置所有级别（不一定是最佳实践，我知道，但是和我一起工作）。每个“关卡”都有自己的视图控制器，类似于“FireLevel1ViewController”、“FireLevel2ViewController”等。所有这些视图控制器都继承自我创建的名为“GameController”的 UIViewController 的自定义子类。

我的问题是，当我在测试设备上打开每个关卡时，GameController 的 viewDidLoad 会在我的子类控制器的 init 或 viewDidLoad 方法之前被调用，因此我的关卡图像/值都没有分配给超类属性。具体来说，我有一个应该在关卡开始时隐藏的暂停菜单（我在 GameController 的 viewDidLoad 中执行 setHidden），但由于 GameController 的 viewDidLoad 在 FireLevel1 有机会将正确的 IB 属性与 PauseMenu 相关联之前运行，因此 GameController 只是隐藏一个空视图，实际的 PauseMenu 永远不会被隐藏。

我可能在这里遇到了多个问题，但大多数情况下我认为我并没有真正理解如何对 UIViewController 的子类进行子类化，以及如何让第二个子类的属性/值/图像在第一个子类的方法中工作。

非常感谢您的帮助！我希望这个问题是有道理的......

游戏控制器代码：

```
@implementation GameController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self)
{
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self.view addSubview:pauseMenu];
    [pauseMenu addSubview:helpMenu];

    //Hides the pause and help menus until their respective buttons are pressed
    [pauseMenu setHidden:YES];
    [helpMenu setHidden:YES];
    isPaused = NO;
} 
```

FireLevel1Controller 的代码：

```
-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{

    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];

    if(self)
    {
           theMainview = mainview;
           theScene = scene;
           theBG = bg;
           theHudView = hud;
           thePauseView = pauseMenu;
           theHelpView = helpMenu;
    }

return self;
}

-(void)viewDidLoad
{

    [super viewDidLoad];
    firstTurret = [[StationaryEnemy alloc]init:turretImage1 baseView:base1];
    secondTurret = [[StationaryEnemy alloc]init:turretImage2 baseView:base2];

    NSLog(@"I'm in view did load");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:24:20.720

啊，我想通了——我不小心否定了我的变量。我应该一直在做 mainview = theMainview; 而不是 theMainview = mainview - 我只是将它们全部分配为零。我还将它们全部从 init 中移出到 viewDidLoad 中，并将 [super viewDidLoad] 移到它们下面，现在它可以完美运行了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:59:12.020

你试过用`viewWillAppear`吗？应该在所有可见的 UI 元素都已初始化后调用该方法。

# android - 在android中动态更改背景或前景按钮颜色

> ID：11836844
> 
> 赞同：0
> 
> 时间：2012-08-06T22:24:32.150
> 
> 标签：android, xml, button, colors, onclick

假设我的应用程序中有一个如下所示的页脚，在诸如 footer.xml 之类的 XML 文件中定义：

```
 <LinearLayout android:id="@+id/llfooter"
        android:layout_weight="1" android:layout_width="fill_parent"
        android:orientation="horizontal" android:layout_height="0dp"
        android:visibility="visible" android:background="@drawable/fbg"
        android:weightSum="5.0" android:gravity="center"
        android:layout_margin="0dp">

        <Button android:id="@+id/home" android:layout_height="wrap_content"
            android:layout_width="wrap_content" android:layout_weight="1"
            android:background="@drawable/home" android:textColor="#FFFFFF"
            android:padding="10px"></Button>

        <Button android:id="@+id/issue" android:layout_height="wrap_content"
            android:layout_width="wrap_content" android:layout_weight="1"
            android:background="@android:drawable/ic_menu_send" android:textColor="#FFFFFF"
            android:padding="10px"></Button>

        <Button android:id="@+id/browse" android:layout_height="wrap_content"
            android:layout_width="wrap_content" android:layout_weight="1"
            android:background="@android:drawable/ic_menu_slideshow" android:textColor="#FFFFFF"
            android:padding="10px"></Button>

        <Button android:id="@+id/search" android:layout_height="wrap_content"
            android:layout_width="wrap_content" android:layout_weight="1"
            android:background="@drawable/search" android:textColor="#FFFFFF"
            android:padding="10px"></Button>

        <Button android:layout_height="wrap_content" android:id="@+id/favorite"
            android:background="@drawable/favorite" android:layout_width="wrap_content"
            android:focusable="true"
            android:clickable="true"
            android:layout_weight="1"
            android:textColor="#FFFFFF" android:padding="10px"></Button>
    </LinearLayout> 
```

现在，问题是*home*、*issue*、*browse*等都是 PNG 图标，当我点击它们时，用户无法获得触摸反馈，因为它们保持不变。

我想在按下它们时更改背景颜色（例如稍微亮一点）。我知道我可以为每个按钮写下 XML drawables() 一个，例如以下

```
 <selector xmlns:android="http://schemas.android.com/apk/res/android"> 
      <item android:state_focused="true" android:state_pressed="true" 
            android:drawable="@drawable/bgalt" /> 
      <item android:state_focused="false" android:state_pressed="true" 
            android:drawable="@drawable/bgalt" /> 
      <item android:drawable="@drawable/bgnorm" /> 
  </selector> 
```

.. 但是如果我有 10 个按钮（例如，5 个用于页脚，5 个用于页眉），我应该创建其他 10 个更改背景的按钮（因此更多地使用图形编辑器和 .apk 更重，因为更多的光栅图标..）。有没有办法创建（即使在java中）更浅的颜色“onClick”和正常颜色“onRelease”，资源中每个功能只有一个图标？

有什么建议么？

提前Tnx。加博

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:37:47.757

使用 ImageButton，并将 android:src 参数设置为具有透明背景的可绘制按钮，然后将 android:background 值设置为例如在选择时会改变颜色的选择器可绘制对象。

这样，您的图标就有一组可绘制对象，而一个仅用于背景的可绘制对象会根据按钮的状态而变化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:39:05.193

您可以在代码中的 onTouch 中获取按钮位图并更改颜色，但这是个坏主意。选择器是最好的解决方案。

# jquery - 单击事件跟踪设置

> ID：11836846
> 
> 赞同：0
> 
> 时间：2012-08-06T22:24:34.160
> 
> 标签：jquery, google-analytics, element, analytics, tracking

我正在尝试使用谷歌分析来计算网页上某些元素的点击次数，这是我的新手。我昨天设置了它，这是我的代码：

放置在结束`</head>`标记之前（根据[此处](https://developers.google.com/analytics/devguides/collection/gajs/asyncTracking)的说明），我有这个：

```
 <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-33903909-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
        </script>
        </head> 
```

我还有一组元素：

```
 <div class="block aside" id ="slideAside">
                    <aside>
                        <form class="form">
                            <fieldset id="fs_section_abstract" class="fs section abstract">
                                <label id="fs_abstract_heading" class="fs btn heading abstract">Abstract</label>
                            </fieldset>

                            <fieldset id="fs_section_businessapproach" class="fs section businessapproach">
                                <label id="fs_businessapproach_heading" class="fs btn heading businessapproach">Business Approach</label>
                            </fieldset>

                            <fieldset id="fs_section_workexperience" class="fs section workexperience">
                                <label id="fs_workexperience_heading" class="fs btn heading workexperience">Work Experience</label><br>
                            </fieldset>

                            <fieldset id="fs_section_academic" class="fs section academic">
                                <label id="fs_academic_heading" class="fs btn heading academic">Academic</label>
                            </fieldset>

                            <fieldset id="fs_section_skillstable" class="fs section skillstable">
                                <label id="fs_skillstable_heading" class="fs btn heading skillstable">Skills Table</label><br>
                            </fieldset>

                            <fieldset id="fs_section_community" class="fs section community">
                                <label id="fs_community_heading" class="fs btn heading community">Community</label><br>
                            </fieldset>
                        </form>
                    </aside>
                </div> 
```

为了跟踪它们，在下面的脚本中，我有：

```
 $('.btn').click(function () {
    //FS IDentifier
    if ($(this).hasClass("fs")) {
        //heading
        if ($(this).hasClass("heading")) {
            //track number of times clicked
            _gaq.push(['_trackEvent', 'Heading', 'The ID is' + $(this).attr('id') + '.']);
            _gaq.push(['_trackEvent', 'Heading', 'HEading']); 
```

我已经设置了将近一天的 GA Analytics，并尝试了上述两个`_gaq.push()`es 以及其他几种方法，但是在分析页面的“内容”部分的“事件”部分没有注册。

我是不是误会了什么？我的代码不好吗？

我知道这是异步跟踪，但结果是每天更新还是其他时间间隔更新？如果是每天，同步更新需要付费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T00:29:46.397

如果您还没有 Chrome，请下载 Chrome 并安装[Google Analytics Debugger 扩展程序](https://chrome.google.com/webstore/detail/jnkmfdileelhofjcijamephohjechhna)。

确保您的 jquery click 函数编码正确。您的代码段无效。

在 Chrome 中查看[这个小提琴](http://jsfiddle.net/eJEJ6/)并打开调试器。我在调试器上运行它并跟踪事件。

事件跟踪已在 3 到 6 小时内为我出现。谷歌总是说要等待 24 小时才能准确跟踪。但是，要立即检查跟踪，请下载 Chrome 和 GA 调试器。

![在此处输入图像描述](../Images/9aa8ffffac3ae51ef51d1cbb830f2a71.png)

![在此处输入图像描述](../Images/26862f6da8db6a3c1096d2127a2ed714.png)

# php - 整数常量不等于常规整数？

> ID：11836851
> 
> 赞同：0
> 
> 时间：2012-08-06T22:24:56.707
> 
> 标签：php, constants, equals, equality

快速提问：为什么下面的内容总是比较为假，尽管打印时都显示为 22？不，常量没有用引号定义 int 。

```
<?php
...
if(count($_POST) != _NUM_TEAM_REG_FORM_FIELDS_)
    $fields = $_POST;
else die(Core::FormatError("Incorrect number of form fields."));

?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:32:00.017

`Why does the below always compare as false, despite both showing 22 when printed?` 因为你错误地比较了它。（即您使用了！= 而不是 ==）

试试下面的代码，

```
if(count($_POST) == _NUM_TEAM_REG_FORM_FIELDS_)
    $fields = $_POST;
else die(Core::FormatError("Incorrect number of form fields.")); 
```

请注意，我已将它们与 EQUAL TO 进行比较。

# ruby-on-rails - 如何让 will_paginate 正确显示条目数？

> ID：11836854
> 
> 赞同：5
> 
> 时间：2012-08-06T22:25:04.727
> 
> 标签：ruby-on-rails, ruby, will-paginate

[WillPaginate](https://github.com/mislav/will_paginate)有一个`page_entries_info`视图助手来输出文本，例如“显示总共 4825 份合同中的 1 - 35 份”。

但是，我发现当我尝试像这样使用它时......

```
= page_entries_info @contracts 
```

它输出...

> 共显示 4825 份合约 1 - 35

（它输出模型的单数名称，而不是复数形式，全部小写。）

我需要给它一些其他参数吗？

我试过`page_entries_info @contracts, :model => Contract`但得到了同样的结果。

我使用的是 3.0.3 版本——当前版本。

顺便说一句，有人可以指点我 WillPaginate 的 API 文档吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-12T13:41:11.707

will_paginate API 文档： [https ://github.com/mislav/will_paginate/wiki/API-documentation](https://github.com/mislav/will_paginate/wiki/API-documentation)

**简短的回答**

您可以将模型选项指定为字符串，该字符串将正确复数。

```
page_entries_info @contracts, :model => 'contract'
# Displaying contracts 1 - 35 of 4825 in total 
```

**更长的答案**

[will_paginate 文档建议](https://github.com/mislav/will_paginate/wiki/I18n)您使用i18n[机制](http://guides.rubyonrails.org/i18n.html)来自定义输出。这是一种痛苦，因为 AFAICT 您必须为`config/locales/*.yml`文件中的所有模型（例如，en.yml）写出单数和复数形式，并且`%{foo}`-style 语法似乎不是 ERB，而只是占位符，所以你不能做类似的事情`%{foo.downcase}`。

如果您编写自己的助手，则可以完全控制输出。例如：

```
def my_page_info(collection)
  model_class = collection.first.class
  if model_class.respond_to? :model_name
    model = model_class.model_name.human.downcase
    models = model.pluralize
    if collection.total_entries == 0
      "No #{models} found."
    elsif collection.total_entries == 1
      "Found one #{model}."
    elsif collection.total_pages == 1
      "Displaying all #{collection.total_entries} #{models}"
    else
      "Displaying #{models} #{collection.offset + 1} " +
      "to #{collection.offset + collection.length} " +
      "of #{number_with_delimiter collection.total_entries} in total"
    end
  end
end

# Displaying contracts 1 - 35 of 4,825 in total 
```

# python - Twisted dataRecivied 中的碎片数据

> ID：11836855
> 
> 赞同：2
> 
> 时间：2012-08-06T22:25:07.753
> 
> 标签：python, protocols, twisted

我正在使用 protocol.Protocol 从服务器接收数据。如下

```
from twisted.internet.protocol import Protocol, Factory

class MyProtocol(Protocol):
    def dataReceived(self, data):
        print data

class MyFactory(Factory):
    def startedConnecting(self, connector):
        print 'Started to connect.'

    def buildProtocol(self, addr):
        print 'Connected.'
        return MyProtocol() 
```

当我接收到大数据时，由于 TCP 流分片，我只接收到部分传入的消息。我正在尝试缓冲收到的数据。但是，我无法接收剩余的数据。分片后接收所有数据的好习惯是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T03:26:44.127

这是关于 Twisted 的常见问题。 [您可以在 Twisted FAQ 中找到答案](http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#Whyisprotocol.dataReceivedcalledwithonlypartofthedataIcalledtransport.writewith)。查看它推荐的类，例如[`Int16StringReceiver`](http://twistedmatrix.com/documents/12.1.0/api/twisted.protocols.basic.Int16StringReceiver.html)或[`NetstringReceiver`](http://twistedmatrix.com/documents/12.1.0/api/twisted.protocols.basic.NetstringReceiver.html)。或者，对于功能齐全的进程间消息传递系统，请查看[AMP（异步消息传递协议）](http://twistedmatrix.com/documents/12.1.0/api/twisted.protocols.amp.html)，它也有[其他语言的实现](http://amp-protocol.net)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:31:13.853

您要覆盖的功能是`stringReceived`.

使用时`Int16StringReceiver`，`stringReceived`在接收到整个长度前缀字符串后输入，而`dataReceived`在接收每个字符串期间可以输入零次或多次。

`dataReceived`是调用`Int16StringReceiver`之前用来构造完整数据包的调用`stringReceived`。它可能必须解析同时接收到的多个字符串，或者等待接收到完整的字符串。

# c++ - 就编译模板而言，char、signed char 或 unsigned char 参数类型的函数重载

> ID：11836856
> 
> 赞同：2
> 
> 时间：2012-08-06T22:25:09.870
> 
> 标签：c++, templates, c++11

这是一个关于启用函数重载的不同方法的公开讨论，仅在 C++11 模板编译方面借助类型特征或类型的参数启用`char`函数重载`signed char`。`unsigned char`

`std::enable_if`虽然令人满意，但类型断言的复合逻辑`std::is_same`（请参阅 PS）并不聪明，因为所有匹配类型，特别`char`是尽管有符号，都用于枚举。因此，我希望有人可以指定一些其他子句或复合逻辑，以更好地促进类型断言（也许`std::is_integral`，`std::is_arithmetic`或`std::is_signed`？）。

PS：

```
template <typename type>
void foo(std::enable_if<std::is_same<type, char>::value||std::is_same<type, signed char>::value||std::is_same<type, unsigned char>::value, type> x)
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:53:50.090

如果你想要这样的类型特征，你必须自己做一个：

```
template <typename T>
struct is_char
{
    static const bool value = std::is_same<T, char>::value ||
            std::is_same<T, signed char>::value ||
            std::is_same<T, unsigned char>::value;
};

template <typename T>
void f(T t, typename std::enable_if<is_char<T>::value>::type* = 0)
{
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:06:23.257

好吧，杰西已经提供了一个解决方案，但无论如何我都会把我的留在这里。

```
// Tests whether the first template argument is equal to at least
// one of the rest of them
// e.g. any_is_same<int, char, bool, int>::value == true
// e.g. any_is_same<int, char, bool, std::string>::value == false

template<typename...>
struct any_is_same;

// Base cases

template<typename T, typename... Types>
struct any_is_same<T, T, Types...> {
    enum { value = true };
};

template<typename T>
struct any_is_same<T> {
    enum { value = false };
};

// Recursive

template<typename T, typename Head, typename... Tail>
struct any_is_same<T, Head, Tail...> {
    enum { value = any_is_same<T, Tail...>::value };
};

// Helper
template<typename T>
struct is_some_char {
    enum { value = any_is_same<T, char, signed char, unsigned char>::value };
};

template <typename type, typename std::enable_if<is_some_char<type>::value, int>::type = 0>
void foo(type x)
{

} 
```

`any_is_same`如果你假装对其他类型做同样的事情（比如`int`/ `unsigned int`/ `signed int`/...） ，你可以重用类型特征：

```
template<typename T>
struct is_some_int {
    enum { value = any_is_same<T, int, signed int, unsigned int>::value };
}; 
```

演示[在这里](http://ideone.com/KVFl5)。

# joomla - Joomla home 丢失了组件的 sef 别名

> ID：11836858
> 
> 赞同：1
> 
> 时间：2012-08-06T22:25:18.277
> 
> 标签：joomla, joomla2.5, joomla1.7

我正在为 joomla 1.7/2.5 开发一个组件，其中包含一些模块，这些模块生成到具有不同视图的组件的 sef 链接。一切都很好，除了网站的主页 http://localhost/en/

当我在主页上时，我的所有组件链接都更改为 http://localhost/en/ **component/componentname** /category/2032 如果我使用此链接在哪里：http://localhost/en/whateverhere 相同的链接就像它们应该是 http://localhost/en/ **component_menu_alias** /category/2032

没有内容，也没有菜单有别名“whateverhere”，所以我很困惑 joomla 如何知道正确的别名，当它在任何地方而不是在家里时 http://localhost/en/

关于这里出了什么问题的任何想法？

PS：该页面是多语言的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:30:01.067

我很快就会自己面对这个挑战，并[在您的组件中添加支持 SEF URL 的](http://docs.joomla.org/Supporting_SEF_URLs_in_your_component)书签。请让我知道这对你有没有用。

# php - 使用 REGEX 得到一个净化的字符串（不检查它是否适合正则表达式）

> ID：11836862
> 
> 赞同：-1
> 
> 时间：2012-08-06T22:25:41.290
> 
> 标签：php, regex, preg-match

我曾经`preg_match`检查一个字符串是否与给定的正则表达式匹配，而不是解析出无效字符。这就是我想要做的，在一个名为的函数中`toSearchableString($string)`：

传递的原始字符串：`Where'd You Go (feat. Holly Brook and Jonah Matranga)`

返回净化后的字符串：`Whered You Go feat Holly Brook and Jonah Matranga`

如果我们必须用任何内容替换无效的字符，则首选空格（或空字符串来简单地删除它们）。

这是我想要匹配的正则表达式：`a-zA-Z0-9`和一个空格

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:32:43.110

使用[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)匹配无效字符的模式作为第一个参数，空字符串作为第二个参数，原始字符串作为第三个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:40:38.753

玩得开心： [http ://www.txt2re.com/index-php.php3](http://www.txt2re.com/index-php.php3)

我用了很长时间，我仍然不知道如何自己编写正则表达式，懒惰。这有很大帮助，您可以在之后稍微调整代码以制作您想要的东西。

只是说，这有时很有帮助。

# javascript - 使用 jquery 克隆选择菜单？

> ID：11836863
> 
> 赞同：0
> 
> 时间：2012-08-06T22:26:00.610
> 
> 标签：javascript, jquery, jquery-plugins, jquery-selectors

我有一个由 jNice 插件设计的简单选择菜单

[http://www.whitespace-creative.com/jquery/jNice/](http://www.whitespace-creative.com/jquery/jNice/)

我编写了一个简单的 jquery 来克隆选择菜单并删除克隆的菜单

```
$(function() {
  var scntDiv = $('#p_scents');
  var i = $('#p_scents p').size() + 1;

  $('#addScnt').live('click', function() {

    $('<p class="sel-a"><select name="lang[]" id="p_scnt' + i +'" class="lang"><option value="">Select Language</option><option value="slovenski">Slovenski</option></select><a id="remScnt">Remove</a></p>').appendTo('#LangForm');
    i++;
    return false;
  });
}); 
```

它工作正常，但有一个小问题它不采用相同的 CSS 格式

我尝试了很多东西，即使在阅读 CSS 文件后，我也没有发现选择菜单的类，它完全由 jNice 插件完成。

我需要知道这个问题是否有解决方案

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T23:17:20.093

我不知道你为什么要这样做，但如果你有对 select 元素的引用，你可以这样做：

```
select.parentNode.replaceChild(select.cloneNode(true), select); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:38:18.657

找出 jNice 插件正在创建和更改的选择菜单的类是什么：

```
$('<p class="sel-a"><select name="lang[]" id="p_scnt' + i +'" class="lang"><option value="">Select Language</option><option value="slovenski">Slovenski</option></select><a id="remScnt">Remove</a></p>').appendTo('#LangForm'); 
```

至：

```
$("#LangForm").append($(".selectmenuclass").html()); 
```

这将完全复制 jNice 创建的选择菜单。您可以保持所有其他逻辑相同。

# iphone - 带有 Dropbox SDK 的 TICoreDataSync 给出“找不到路径”错误

> ID：11836864
> 
> 赞同：0
> 
> 时间：2012-08-06T22:26:02.583
> 
> 标签：iphone, objective-c, dropbox, dropbox-api, ticoredatasync

我已按照[此处](http://timisted.github.com/TICoreDataSync/ios-tutorial.html)找到的教程设置我的应用程序以进行 Dropbox 同步。当我启动应用程序从而开始同步时，我得到了这个：

```
[WARNING] DropboxSDK: error making request to /1/metadata/dropbox/com.timisted.notebook - Path '/com.timisted.notebook' not found

[WARNING] DropboxSDK: error making request to /1/metadata/dropbox/com.timisted.notebook/Documents/Notebook - Path '/com.timisted.notebook/Documents/Notebook' not found 
```

以及类似错误的列表。

有什么想法是什么原因造成的，我该如何解决？

编辑：我使用我的凭据对 TICoreDataSync 提供的示例应用程序进行了尝试，它接受了凭据但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:02:51.597

我发现您通常可以忽略这些消息。TICoreDataSync 将尝试发出请求，然后如果失败，它将创建文件夹并继续。

以下是我必须进行的更改才能让 iOSNotebook 运行：

1.  Dropbox 不允许我创建一个名为“iOSNotebook”的应用程序，因为它已经被占用了（这并不奇怪 :)）。所以我将 Xcode 项目的名称和目标更改为 iOSNotebookCA 以及 TICDSDropboxSDKBasedApplicationSyncManager 的 globalAppIdentifier 为 @"com.timisted.iOSNotebookCA"

2.  接下来我必须更改 Build Settings > Build Active Architectures Only = Yes

3.  我将部署目标更改为 5.1，这样我就可以避免让所有测试设备运行 6.0（可选）

4.  我还必须更改 info.plist 文件的 URL 字符串以反映分配给我的 iOSNotebookCA (db-blahblahblah) 的 Dropbox 密钥。

5.  并将 DBSession 根更改为 kDBRootAppFolder

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T04:07:16.060

[我们最近在项目 wiki](https://github.com/nothirst/TICoreDataSync/wiki)上发布了框架的 1.0.2 版以及更新的文档、示例应用程序和教程。检查一下，如果遇到任何问题，请在项目的[问题](https://github.com/nothirst/TICoreDataSync/issues)页面上打开一个问题

# java - 递归删除java中的文件夹

> ID：11836867
> 
> 赞同：2
> 
> 时间：2012-08-06T22:26:44.390
> 
> 标签：java, fileutils

我已经有一个有效的代码，但如果可能的话，我不希望它实际删除临时文件夹。我正在使用 apache fileutils。还有谁知道如何排除文件夹被删除？

```
public class Cleartemp { 
    static String userprofile = System.getenv("USERPROFILE");
    public static void main(String[] args) { 
        try { 
            File directory = new File(userprofile+"\\AppData\\Local\\Temp");  
            // 
            // Deletes a directory recursively. When deletion process is fail an 
            // IOException is thrown and that's why we catch the exception. 
            // 
            FileUtils.deleteDirectory(directory); 
        } catch (IOException e) { 
            e.printStackTrace(); 
        } 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:42:26.297

这是一个实际的递归方法：

```
public void deleteDirectory(File startFile, FileFilter ignoreFilter) {
    if(startFile.isDirectory())
        for(File f : startFile.listFiles()) {
            deleteDirectory(f, ignoreFilter);
        }
    if(!ignoreFilter.accept(startFile)) {
        startFile.delete();
    }
} 
```

将文件过滤器设置为对目录返回 true（见下文），使其不删除目录。您也可以为其他文件添加例外

```
 FileFilter folderFilter = new FileFilter() {

        @Override
        public boolean accept(File paramFile) {
            return paramFile.isDirectory();
        }

    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:59:12.367

[FileUtils.cleanDirectory](http://commons.apache.org/io/apidocs/org/apache/commons/io/FileUtils.html#cleanDirectory%28java.io.File%29)怎么样？它清理目录而不删除它。

如果您需要一些过滤逻辑，也可以使用 Apache Commons [DirectoryWalker 。](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/DirectoryWalker.html)该页面上的示例之一包括`FileCleaner`实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:39:29.177

简单的，

用于`isDirectory()`将其排除在删除之外。

参考这里：[http](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#isDirectory) ://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#isDirectory ()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-30T12:40:01.370

第一次发帖，不要认为自己是专家，但我坚持使用 1.4 ......

这是一个很好的递归删除方法，删除父文件夹中的所有文件和子文件夹，然后删除父文件夹本身，假设传递的文件是一个目录，就像我的情况一样。

```
private void deleteTemp(File tempDir) {
    File[] a = (tempDir.listFiles());
        for (int i = 0; i < a.length; i++) {
            File b = a[i];
                if (b.isDirectory())
                    deleteTemp(b);

                b.delete();
        }

        tempDir.delete();
} 
```

# python - google appengine sdk：本地主机上的HTTP异常；在 appengine 上完美运行

> ID：11836869
> 
> 赞同：-1
> 
> 时间：2012-08-06T22:27:01.177
> 
> 标签：python, google-app-engine

我正在编写一个需要连接到 Google 进行身份验证的 Google AppEngine python 应用程序。我一定改变了我在过去 5 天里试图弄清楚的一些事情：这个应用程序以前会在部署在 localhost 上运行（并执行所述身份验证），但现在无法这样做。然而，一旦我部署到 appengine，这个错误就不再存在了。我已经确定这不是互联网连接问题，因为我已将其部署在另一台计算机上，但它仍然给我同样的错误。

这是堆栈跟踪的样子

```
Traceback (most recent call last):
  File "C:\Program Files\Google\google_appengine\google\appengine\ext\webapp\_webapp25.py", line 701, in __call__
    handler.get(*groups)
  File "C:\Users\username\Desktop\AppEngine Things\engineapp\main.py", line 372, in get
    creds = self.GetCodeCredentials()
  File "C:\Users\username\Desktop\AppEngine Things\engineapp\main.py", line 323, in GetCodeCredentials
    creds = oauth_flow.step2_exchange(code)
  File "lib\oauth2client\client.py", line 883, in step2_exchange
    headers=headers)
  File "lib\httplib2\__init__.py", line 1445, in request
    (response, content) = self._request(conn, authority, uri, request_uri, method, body, headers, redirections, cachekey)
  File "lib\httplib2\__init__.py", line 1197, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "lib\httplib2\__init__.py", line 1167, in _conn_request
    response = conn.getresponse()
  File "lib\httplib2\__init__.py", line 999, in getresponse
    raise httplib.HTTPException()
HTTPException 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T21:47:00.977

在命令行上运行应用程序`dev_appserver.py`似乎可以解决问题。不过，我真的没有太多了解为什么会这样。所以现在我不能使用 sdk 的 GUI 启动器

# java - UNC 路径 .exists() 返回 false

> ID：11836872
> 
> 赞同：3
> 
> 时间：2012-08-06T22:27:15.577
> 
> 标签：java

为什么这在java中返回false？

```
new File("\\\\10.10.1.4").exists() 
```

但

```
new File("\\\\10.10.1.4\\dir").exists() 
```

返回真。

**如果我在 Windows 资源管理器中打开第一个地址（没有“目录”），我会看到内容，所以我认为这不是权限问题**，因为 Windows 可以看到它就好了

File.listFiles() 也会发生同样的事情。第一个地址返回 null 但第二个返回实际内容

最后，如果所有其他方法都失败了，是否有任何其他方法来测试 UNC 地址（只是没有目录的 ip）是否存在并列出其内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:56:42.377

`\\10.10.1.4`是地址，不是共享引用，它不指向已安装的文件系统。 `\\10.10.1.4\dir`指向一个共享点，它是一个挂载的文件系统。

我就像向街道地址发送一封信，但留下门牌号码......它没有可以从中删除的上下文点。这里也是一样。Java 看不到`\\10.10.14`as `File`，因此它不存在（从 a 的上下文中`File`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:35:31.207

文件（“\\10.10.1.4”）不存在。

File("\\10.10.1.4\") 可能会。

浏览器/资源管理器会自动添加反斜杠，这就是它显示内容的原因。

# javascript - 在 knockout.js 中从另一个更新一个深度结构化的 javascript 对象

> ID：11836873
> 
> 赞同：0
> 
> 时间：2012-08-06T22:27:33.977
> 
> 标签：javascript, knockout.js

我有一个绑定到 view 的 javascript 对象（viewModel）。我正在从 server 获取它的新版本（newViewModel）。（您可以想象此时的股市价格应用）

我不想绑定 newViewModel，因为我不想丢失旧 viewModel 的引用。

所以我需要从服务器响应中更新我现有 javascript 对象的所有属性！

这可能是 javascript 问题，但我的 viewModel 有很多可观察的属性和子属性。（淘汰赛可观察到）

Ps：jQuery 的 $.extend 不起作用。

更新（看起来还可以）：

ko.mapping.fromJS(newViewModel,viewModel); 似乎工作..我无法识别它，因为“Vs.Net Intellisense”没有显示它的过载。

我的对象结构非常深刻。如果我看到任何问题，我会通知你。

更新（不起作用）：

viewModel.x[] 长度=2

newViewModel.x[] 长度=12

上面的代码将所有 x 替换为新的。（我丢失了 viewModel.x[0],viewModel.x[1] 引用）！！

所以我的 html 与我的对象不同步。viewModel.x[0] 在右侧的篮子中，但
不在左侧的篮子​​中（屏幕）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T10:03:16.523

没有什么神奇的方法。因为我需要将旧的数组元素与新闻相匹配。“代码”需要知道数组元素的“键”。

如果我可以在旧数组中找到 newElement，我会访问所有数组元素如果找不到，我会更新 oldElement 的属性，我将 newElement 添加到 oldArray。

痛苦，但我不得不这样做。

# sql - 使用 Rails 和 PostgreSQL 返回包含出现次数的分组列表

> ID：11836874
> 
> 赞同：0
> 
> 时间：2012-08-06T22:27:39.737
> 
> 标签：sql, ruby-on-rails-3, postgresql, activerecord, heroku

`Tags`我的rails 应用程序中有一个列表，这些列表与`Posts`使用`Taggings`. 在某些观点中，我想展示 5 个最常用标签的列表，以及它们被标记的时间。要创建一个完整的示例，假设一个包含 3 个帖子的表：

```
POSTS
ID | title
1  | Lorem
2  | Ipsum
3  | Dolor 
```

还有一张有 2 个标签的桌子

```
TAGS
ID | name
1  | Tag1
2  | Tag2 
```

现在，如果帖子 1 用 Tag1 标记，而帖子 2 用标记 1 和 2 标记，我们的标记表如下所示：

```
TAGGINGS
tag_id | post_id
1      | 1
1      | 2
2      | 2 
```

那么问题是如何获取所需的信息（最好不要多次返回数据库）以显示以下结果：

```
Commonly used tags:
tag1 (2 times)
tag2 (1 time) 
```

我已经设法通过包含标签、`tag_id`按计数分组和排序来使用 MySQL 做到这一点：

红宝石：

```
taggings = Tagging.select("*, count(tag_id) AS count").includes(:tag).group(:tag_id).order('count(*) DESC').limit(5)
taggings.each { |t| puts "#{t.tag.name} (#{t.count})" } 
```

但是，我正在将应用程序迁移到 Heroku，因此我需要迁移到 PostgreSQL 9.1。不幸的是，Postgres 的严格性破坏了该查询，因为它要求在子句中指定*所有字段。*`group by`我试过那样做，但结果是我不能再使用`t.count`来获取行数了。

所以，最后要回答这个问题：

从 postgres (v9.1) 查询此类信息并将其显示给用户的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T14:15:34.387

你的问题：

*不幸的是，Postgres 的严格性破坏了该查询，因为它要求在 group by 子句中指定所有字段。*

现在，这在 PostgreSQL 9.1 中有所改变（引用 9.1[的发行说明](https://www.postgresql.org/docs/9.1/release-9-1.html#AEN110817)）：

> 在子句中指定主键时允许查询目标列表中的非[`GROUP BY`](https://www.postgresql.org/docs/9.1/queries-table-expressions.html#QUERIES-GROUP)列`GROUP BY`(Peter Eisentraut)

更重要的是，你描述的基本查询甚至不会遇到这个：

*显示 5 个最常用标签的列表，以及它们被标记的时间。*

```
SELECT tag_id, count(*) AS times
FROM   taggings
GROUP  BY tag_id
ORDER  BY times DESC
LIMIT  5; 
```

在任何情况下都有效。

# c# - WCF 客户端不遵循合同 UriTemplates

> ID：11836875
> 
> 赞同：0
> 
> 时间：2012-08-06T22:27:45.660
> 
> 标签：c#, .net, wcf, web-services, wcf-client

我在 WCF 服务的 ServiceContract 中定义了一个函数，如下所示：

```
[WebInvoke(Method = "GET", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare, UriTemplate = "/test")]
CommandResponse Test(); 
```

另一方面，在客户端应用程序中，我通过 Visual Studio 中的“添加服务引用”添加了 WCF 服务。使用以下方式调用服务测试功能时：

```
var test = m_ServiceClient.Test(); 
```

我收到一条错误消息：

```
Operation 'GetUser' of contract... specifies multiple request body parameters to be serialized ... 
```

GetUser() 是我在服务合同中的另一个函数（也是一个 GET 函数，但在 UriTemplate 中有参数）。我的猜测是客户端正在使用它的参数调用该函数，但请求将转到错误的 UriTemplate （或者根本没有模板，它只是跳转到某种默认值）。

我必须遵循任何特殊说明来让客户了解 UriTemplates 功能？

我已经搜索了所有内容，但找不到可以帮助解决此问题的单个页面...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T08:40:57.477

当您公开您的服务时使用这些`WebInvoke/WebGet`属性，该服务`WebHttpBinding`用于以 REST 样式使用您的 WCF 服务。为了通过 SOAP 添加`[OperationContract]`属性访问方法并通过`basicHttpBinding`.

如果您想以 REST 样式访问服务，那么您应该使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)类来创建您的请求，而不是添加`Add Service Reference`.

为了实现这两者，即通过 SOAP 和 REST 访问服务，只需添加属性`[OperationContract]`并`WebInvoke`公开另一个端点元素`basicHttpBinding`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T17:08:15.533

为了让客户端识别 UriTemplates 并以模板定义的格式将每个方法传递给它自己的 Url，我将 ServiceContract 接口复制到客户端，然后创建了一个到服务基础 url 的通道

```
WebChannelFactory<IServiceContract> cf = new WebChannelFactory<IServiceContract>(new Uri("http://...."));
var service = cf.CreateChannel(); 
```

生成的“服务”是直接与 Web 服务一起使用的可用接口。

# jsp - jspx 传递变量

> ID：11836878
> 
> 赞同：0
> 
> 时间：2012-08-06T22:27:50.280
> 
> 标签：jsp, google-maps, spring-roo, jspx

我正在使用 Spring Roo 和 jspx 来制作一个用于管理房地产投资组合的系统。

在我的“propertys/show.jspx”文件中，我使用 Google Maps API 嵌入了地图，现在我希望将属性的邮政编码/邮政编码传递到地理编码方法中，以在地图上显示属性的位置。

我对 jsp(x) 比较陌生，但是我尝试了各种选项，例如使用邮政编码“id”值或使用 ${property.postcode}/${property.getPostcode()}，但这些都不起作用。当然，我正在尝试做的事情是可能的，我已经在网上搜索了几个小时，但一直在努力寻找任何有帮助的东西。

这是我的代码：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<div xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:embed="urn:jsptagdir:/WEB-INF/tags/embed" xmlns:field="urn:jsptagdir:/WEB-INF/tags/form/fields" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:page="urn:jsptagdir:/WEB-INF/tags/form" xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" version="2.0">
    <jsp:directive.page contentType="text/html;charset=UTF-8"/>
    <jsp:output omit-xml-declaration="yes"/>
    <page:show id="ps_propertymodule_model_Property" object="${property}" path="/propertys"  z="WKsfPr4ho5x13a9S80pO1Z6yVzU=">
        <table width="100%;">
            <tr>
                <td width="60%">
        <field:display field="propertyNameNumber" id="s_propertymodule_model_Property_propertyNameNumber" object="${property}" z="DRkvOGCjByMk2N7UunO4fD8LJfc="/>
        <field:display field="streetName" id="s_propertymodule_model_Property_streetName" object="${property}" z="caugN9DlFqoZLN+WEKIjaJEQUSI="/>
        <field:display field="townCity" id="s_propertymodule_model_Property_townCity" object="${property}" z="Fp+KSaGrgdbXhRzllkBo9FxmXIM="/>
        <field:display field="county" id="s_propertymodule_model_Property_county" object="${property}" z="mmJB81/8iBFbt+jXICA9q8xCDHw="/>
        <field:display field="postcode" id="s_propertymodule_model_Property_postcode" object="${property}" z="j1qr8EujBkOLnsX1vcgFaPlEWtU="/>
        <br/>
        <br/>
        <field:display date="true" dateTimePattern="${property_datepurchased_date_format}" field="datePurchased" id="s_propertymodule_model_Property_datePurchased" object="${property}" z="B22znN56FtmM/zueTwnOcjNl83k="/>
        <field:display field="pricePaid" id="s_propertymodule_model_Property_pricePaid" object="${property}" z="CQLyDqQhFtqoYfMusAB/XeA+wW0="/>
        <field:display field="stampDuty" id="s_propertymodule_model_Property_stampDuty" object="${property}" z="x7sgRlL8ROhdb9MonWP33N4Ishs="/>
        <field:display field="legalCost" id="s_propertymodule_model_Property_legalCost" object="${property}" z="TH0DgdlKfeFDefSgq+HDVebcxm0="/>
        <field:display field="agentFee" id="s_propertymodule_model_Property_agentFee" object="${property}" z="05bXxWqJcMzgbwtVBHUujPWU7ZA="/>
        <br/>
        <br/>
        <field:display field="area" id="s_propertymodule_model_Property_area" object="${property}" z="Eb5a0xmk5qSFaKZ3BYMGR7lNYw8="/>
        <field:display field="salePrice" id="s_propertymodule_model_Property_salePrice" object="${property}" z="cQHnoPj/QNnb2XwRclq6n4zR+gs="/>
        <field:display field="saleCommission" id="s_propertymodule_model_Property_saleCommission" object="${property}" z="ULPRSdiwV/tk+kS59uyk16TkcoY="/>
        <field:display field="legalExpenses" id="s_propertymodule_model_Property_legalExpenses" object="${property}" z="/a0+xD2IyDttEZpI9zlcOpruOaQ="/>
        <field:display field="comments" id="s_propertymodule_model_Property_comments" object="${property}" z="RDKzYGFdOQUXNcAhV3/JGF8v7V0="/>
        <field:display field="image" id="s_propertymodule_model_Property_image" object="${property}" z="TBQCQkvQcyTDVJQw7l95WI6zt9U="/>
        <field:display field="vacant" id="s_propertymodule_model_Property_vacant" object="${property}" z="03Pa/jpb5PtZRPMAQzLryud0dBs="/>
        <c:set var="post_code" value="${property.postcode}" />
        </td>
            <td>

        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBQaHw1aSWtIjQzAiriBPC3hvm7Bs1R35U&amp;sensor=false"><jsp:text></jsp:text></script>
    <script type="text/javascript">
        //<![CDATA[ 
            var map;
      function initialize() {

        var mapOptions = {
          zoom: 8,
          center: new google.maps.LatLng(51.10,-0.84),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(document.getElementById('map_canvas'),
            mapOptions);

        codeAddress();
      }

      function codeAddress() {

          var address = document.getElementById(address).value;
          geocoder.geocode( { 'address': address}, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
              map.setCenter(results[0].geometry.location);
              var marker = new google.maps.Marker({
                  map: map,
                  position: results[0].geometry.location
              });
            } else {
              alert('Geocode was not successful for the following reason: ' + status);
            }
          });
        }
          google.maps.event.addDomListener(window, 'load', initialize);
         // ]]> 
            </script>
            <div  id="map_canvas" style="width: 250px; height: 250px"></div>
            </td>
        </tr>
    </table>
  </page:show> 
</div> 
```

如果有人能给我任何提示或提示，我将不胜感激，因为我真的认为这是一个基本问题，而且无法解决它真的让我很沮丧！

谢谢

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T08:45:02.800

如果您查看 display.tagx，您可以看到这样引用的对象值：

```
<spring:eval expression="object[field]" /> 
```

据推测，您应该能够使用这是您的 jspx 访问邮政编码：

```
<spring:eval expression="property[postcode]" /> 
```

例如：

```
<script type="text/javascript">
        //<![CDATA[
            var map;
            var post_code = <spring:eval expression="property[postcode]" />;
            ... 
```

# php - Jquery 发布到 php 文件有效，但只能在 PHP 中回显时返回一些数据

> ID：11836882
> 
> 赞同：0
> 
> 时间：2012-08-06T22:28:30.323
> 
> 标签：php, jquery, post

//Jquery代码用AJAX发送数据

```
 $.ajax({
            type: "POST",
            url: "test.php",
            data:
            "fname="+ fname +
            "&amp; lname="+ lname +
            "&amp; address="+ address +
            "&amp; city="+ city +
            "&amp; state="+ state +
            "&amp; zip="+ zip +
            "&amp; phone="+ phone +
            "&amp; useremail="+ useremail +
            //the following values are not being receieved by the php correctly
            "&amp; subtotal="+ subTotal +
            "&amp; quantity="+ quantity,
            success: function(){
            $('#oderBtn').hide(function({$('#orderTest').fadeOut();});
            }
        }); 
```

//接收AJAX数据的PHP代码

```
$fname = htmlspecialchars(trim($_POST['fname']));
$lname = htmlspecialchars(trim($_POST['lname']));
$city = htmlspecialchars(trim($_POST['city']));
$state = htmlspecialchars(trim($_POST['state']));
$zip = htmlspecialchars(trim($_POST['zip']));
$address = htmlspecialchars(trim($_POST['address']));
$email = htmlspecialchars(trim($_POST['useremail']));

//these do not post correctly, i do not know why
$subTotal = htmlspecialchars(trim($_POST['subtotal']));
$quantity = htmlspecialchars(trim($_POST['quantity'])); 
```

所以问题是 fname、lname、city、state、zip、address 和 email 都可以工作但小计和数量都不起作用，firebug 让它们都以相同的方式发布，似乎 PHP 只是没有收到数据正确。

添加 echo file_get_contents("php://input"); 到 php 确实得到了发送回的所有内容，包括小计和数量，但只是做 $_POST['subtotal'] 不会得到价值。

感谢您在此问题上提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:40:41.330

好吧，首先，您不需要构建这样的字符串。您可以简单地传递一个对象文字：

```
 $.ajax({
        type: "POST",
        url: "test.php",
        data: {
            fname: fname,
            lname: lname
            ...
        },
        success: function(){
        $('#oderBtn').hide(function({$('#orderTest').fadeOut();});
        }
    }); 
```

并且 jQuery 将根据需要对其进行序列化。我认为令人印象深刻的是，它完全尊重您的 POST 请求，因为您向它传递了一个查询字符串。

此外，它看起来很可疑，它在发送电子邮件后停止工作。你可以将结果粘贴到`print_r($_POST);`PHP 中吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:37:30.047

您是否尝试过使用`$_GET[]`而不是`$_POST[]`？那将是我要尝试的第一件事，因为`$_GET`它是为从 URL 获取数据而`$_POST`设计的，而更多地是为从表单提交中获取数据而设计的。

```
$fname    = htmlspecialchars(trim($_GET['fname']));
$lname    = htmlspecialchars(trim($_GET['lname']));
$city     = htmlspecialchars(trim($_GET['city']));
$state    = htmlspecialchars(trim($_GET['state']));
$zip      = htmlspecialchars(trim($_GET['zip']));
$address  = htmlspecialchars(trim($_GET['address']));
$email    = htmlspecialchars(trim($_GET['useremail']));
$subTotal = htmlspecialchars(trim($_GET['subtotal']));
$quantity = htmlspecialchars(trim($_GET['quantity'])); 
```

此输出作为 JSON 数组的示例：

```
$data = array(
    'fname'    => htmlspecialchars(trim($_GET['fname']));
    'lname'    => htmlspecialchars(trim($_GET['lname']));
    'city'     => htmlspecialchars(trim($_GET['city']));
    'state'    => htmlspecialchars(trim($_GET['state']));
    'zip'      => htmlspecialchars(trim($_GET['zip']));
    'address'  => htmlspecialchars(trim($_GET['address']));
    'email'    => htmlspecialchars(trim($_GET['useremail']));
    'subTotal' => htmlspecialchars(trim($_GET['subtotal']));
    'quantity' => htmlspecialchars(trim($_GET['quantity']));
);

echo json_encode($data); 
```

**编辑：**

您可能还需要`encodeURI()`在 jQuery 中使用以确保没有与号或其他字符混淆 URL 字符串。

```
$.ajax({
    type: "GET",
    url: "test.php",
    data: encodeURI(
        "?fname="     + fname +
        "&lname="     + lname +
        "&address="   + address +
        "&city="      + city +
        "&state="     + state +
        "&zip="       + zip +
        "&phone="     + phone +
        "&useremail=" + useremail +
        "&subtotal="  + subTotal +
        "&quantity="  + quantity
    ),
    success: function(response){
        alert(response); // Will show the JSON array
        $('#oderBtn').hide(function({$('#orderTest').fadeOut();});
    }
}); 
```

小提琴：http: [//jsfiddle.net/xNSLX/](http://jsfiddle.net/xNSLX/)

# asp.net-mvc-3 - mvc3 jquery mobile如何使用Html.BeginForm

> ID：11836884
> 
> 赞同：1
> 
> 时间：2012-08-06T22:28:51.443
> 
> 标签：asp.net-mvc-3, jquery-mobile

我已经用 MVC3 编写了一个完整的站点。我正在尝试使用 Jquery Mobile 构建移动版本。我没有更改我的控制器代码，除了添加检查它是否应该返回移动页面。我的移动登录页面的文档头中有以下内容：

```
<head>
    <title>Mobile Logon</title>
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0-alpha.1/jquery.mobile-1.2.0-alpha.1.min.css" />
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

$(document).bind("mobileinit", function(){
  $.extend(  $.mobile , {
    ajaxEnabled: false
  });
});

    <script src="http://code.jquery.com/mobile/1.2.0-alpha.1/jquery.mobile-1.2.0-alpha.1.min.js"></script>

</head> 
```

我有一个带有标题和内容的页面。在内容中，我想让用户重定向到注册表单。以下似乎有效：

```
<form action="Register" method="get" data-ajax="false">           
    <button type="submit" value="Register for an account"></button>
</form> 
```

这不起作用：（网址在浏览器中似乎正确，但加载的只是一个空白的白色页面）

```
@using(Html.BeginForm("Register", "Account", FormMethod.Get, null ))
{
    <button type="submit" value="Register for an account"></button>  
} 
```

当我查看页面源代码时，我注意到两个不同之处：第一个给出了一个带有

```
action="Register" 
```

而第二个给出了一个表单标签

```
action="Account/Register" 
```

另一个区别是表单标签中的“data-ajax=false”。

问题：我可以在 Jquery Mobile 中使用 @Html.BeginForm() 吗？如果没有，我如何重定向到不同的控制器？

为什么我在 head 部分的代码没有关闭 Jquery Mobile 的默认 ajax 行为？（我尝试在没有 data-ajax=false 的情况下使用上面的表单标签，我得到了与 @Html.BeginForm 给我的相同的空白屏幕）。

编辑：这是我的登录控制器代码（帐户控制器）

```
public ActionResult LogOn()
    {
        //return View();
        return SelectView("Logon", null);
    }

    private ActionResult SelectView(string viewName, object model, string outputType = "html")
    {
        if (outputType.ToLower() == "json")
        {
            return Json(model, JsonRequestBehavior.AllowGet);
        }
        else
        {
#if MOBILE
  return View(viewName + ".Mobile", model);
#else
            if (Request.Browser.IsMobileDevice)
            {
                return View(viewName + ".Mobile", model);
            }
            else
            {
                return View(viewName, model);
            }
#endif
        }
    } 
```

这是我的注册控制器代码：（帐户控制器）

```
 public ActionResult Register(string returnUrl = "")
    {
        //if no return url supplied, use referrer url.
        //Protect against endless loop by checking for empty referrer.
        if (String.IsNullOrEmpty(returnUrl) && Request.UrlReferrer != null && Request.UrlReferrer.ToString().Length > 0)
        {
            return RedirectToAction("Register", new { returnUrl = Request.UrlReferrer.ToString() });
        }                       

        return View();
    } 
```

# java - 文件和 InputStream/OutputStream

> ID：11836889
> 
> 赞同：1
> 
> 时间：2012-08-06T22:29:13.410
> 
> 标签：java

你好 Stack Overflow 社区，

我正在对使用 java Servlet 接收的一些数据进行多步处理。我目前的过程是我使用 Apache File Upload 将文件输入到服务器并将它们转换为`File`. 然后，一旦`input1`填充了数据，我就会运行类似于此的流程（其中流程函数是 xsl 转换）：

```
File input1 = new File(FILE_NAME);  // <---this is populated with data
File output1 = new File(TEMP_FILE); // <---this is the temporary file

InputStream read = new FileInputStream(input1); 
OuputStream out = new FileOutputStream(output1);

process1ThatReadsProcessesOutputs( read, out);

out.close();
read.close();

//this is basically a repeat of the above process!
File output2 = new File(RESULT_FILE);  // <--- This is the result file 
InputStream read1 = new FileInputStream(output1);
OutputStream out1 = new FileOutputStream(output2);
Process2ThatReadsProcessesOutputs( read1, out1);
read1.close();
out1.close();
… 
```

所以我的问题是，是否有更好的方法来做到这一点，这样我就不必创建那些临时`File`的 s 并重新创建那些 s 的流`File`？（我假设我的表现不错）

我看到了这种[从 OutputStream 创建 InputStream 的最有效方法，](https://stackoverflow.com/questions/1225909/most-efficient-way-to-create-inputstream-from-outputstream)但我不确定这是否是最好的方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:50:55.297

如果您真的不需要，我不知道您为什么要转换使用 Apache Commons 检索到的[FileItem 。](http://commons.apache.org/fileupload/apidocs/org/apache/commons/fileupload/FileUpload.html)您可以使用`InputStream`每个`FileItem`人都必须使用的相同内容并读取上传文件的内容：

```
// create/retrieve a new file upload handler
ServletFileUpload upload = ...;

// parse the request
List<FileItem> items = (List<FileItem>) upload.parseRequest(request);

/* get the FileItem from the List. Yes, it's not a best practice because you must verify 
   how many you receive, and check everything is ok, etc. 
   Let's suppose you've done it */
//...
FileItem item = items.get(0); 

// get the InputStrem to read the contents of the file 
InputStream is = item.getInputStream(); 
```

所以最后，您可以使用该`InputStream`对象来读取客户端发送的上传流，避免不必要的实例化。

是的，确实建议使用像`BufferedInputStream`and之类的缓冲类`BufferedOutputStream`。

另一种想法可能是避免（中间一个）并在不需要写入磁盘时`FileOutputStream`将其替换为（总是比在内存中工作慢）。`ByteArrayOutputStream`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:01:40.230

只需替换`FileOutputStream`为`ByteArrayInputStream`反之亦然。

例子：

```
ByteArrayOutputStream out = new ByteArrayOutputStream();
ByteArrayInputStream in = new ByteArrayInputStream(out.toByteArray()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-02T09:26:56.853

Java 9 为这个问题带来了新的答案：

```
// All bytes from an InputStream at once
byte[] result = new ByteArrayInputStream(buf)
    .readAllBytes();

// Directly redirect an InputStream to an OutputStream
new ByteArrayInputStream(buf)
    .transferTo(System.out); 
```

# c - 使用 Xor 交换产生错误结果

> ID：11836894
> 
> 赞同：1
> 
> 时间：2012-08-06T22:29:34.930
> 
> 标签：c

这是一个奇怪的错误，我得到一个简单的选择排序。

使用以下输入`89,52,10,1,56,63,24,36,12,5`

如果您要对其进行调试，您会注意到在第三次迭代期间，该行将 `a[i]=a[i] ^ a[min];`两个操作数都设置为零。

知道为什么会这样吗？

```
#include<stdio.h>

int main()
{
    int a[10]={'\0'};
    int i=0,j=0,k=0;
    int min=0;

    printf("Enter 10 Elements\n");

    for(i=0;i<10;i++)
    {
        scanf("%d",&a[i]);
    }

    for(i=0;i<10;i++)
    {
        min=i;

        for(j=i+1;j<10;j++)
        {
            if(a[j]<a[min])
            {
                min=j;
            }
        }

        a[i]=a[i] ^ a[min];
        a[min]= a[min] ^ a[i];
        a[i]= a[i] ^ a[min];
    }

    for(i=0;i<10;i++)
    {
        printf("\n %d",a[i]);
    }

    return(0);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T22:33:16.057

XOR 是一种糟糕的交换变量的方法。只需声明一个临时并使用分配。

XOR 技巧：

```
x = x ^ y;
y = y ^ x;
x = x ^ y; 
```

如果`x`和`y`是内存中的相同位置，则失败；然后它将值设置为0。

我没有详细分析你的代码，但我敢打赌：

```
a[i]=a[i] ^ a[min];
a[min]= a[min] ^ a[i];
a[i]= a[i] ^ a[min]; 
```

时失败`i == min`。

...

确认后，我尝试使用添加的`printf`语句运行程序，并使用指定的输入`i == min`进行至少一次交换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T01:55:23.890

当两个指针指定相同的内存位置时，程序将失败。这称为内存别名。

# android - 在 .apk 上包含 jar 文件

> ID：11836895
> 
> 赞同：2
> 
> 时间：2012-08-06T22:29:59.543
> 
> 标签：android, eclipse

我正在开发一个使用 Google 消息传递的应用程序。因此，我需要在最终的 .apk 文件中包含 gcm.jar。

我使用项目属性在 Eclipse 中添加了 jar 文件，但我仍然不认为 .apk 文件中包含该文件，因为我收到了以下消息：

```
java.lang.NoClassDefFoundError: com.google.android.gcm.CMRegistrar 
```

因此，我想知道如何将 jar 包含在 .apk 文件中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T22:34:10.970

在您的项目中，您需要创建文件夹“libs”，并放入 gcm.jar

# jquery - jScrollPane。类型错误：$drag[0] 未定义

> ID：11836899
> 
> 赞同：0
> 
> 时间：2012-08-06T22:30:11.617
> 
> 标签：jquery, jscrollpane

我正在尝试实现 jScrollPane。但是我的控制台中出现了许多错误。他们都是`TypeError: $drag[0] is undefined. maxY = trackHeight - $drag[0].offsetHeight;`

Scrollpane 正在识别 div - 它将它包装在 jScrollPaneScrollable 中并删除标准浏览器滚动条 - 但不应用它的滚动条或根本不允许我滚动，我在控制台中收到上述错误。

我的 HTML：

```
<div id="homePageOffersWindow">
        <div class="homePageOffersContainer">
            <div class="homePageOfferBlock">
                <h3>HELI HIKES</h3>
                <p>Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old. </p>
                <p><strong>Save $23 per person</strong></p>
                <div class="clear"></div>
                <a href="#" class="stdButton whiteBlue">MORE DETAILS</a>
            </div>
            <div class="homePageOfferBlock">
                <h3>HELI HIKES</h3>
                <p>Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old. </p>
                <p><strong>Save $23 per person</strong></p>
                <div class="clear"></div>
                <a href="#" class="stdButton whiteBlue">MORE DETAILS</a>
            </div>
        </div>
    </div> 
```

jQuery：

```
$('#homePageOffersWindow').jScrollPane(); 
```

CSS：

```
#homePageOffersWindow{height: 200px; overflow: auto}
    .homePageOffersContainer{}
    .homePageOfferBlock{margin:0 0 20px;}
    .homePageOfferBlock:last-child{margin-bottom: 0} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T05:34:31.750

尝试调用 jquery 1.4.2 而不是你的 jquery 版本 `<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>`

# c# - 将数据标签添加到 Excel 饼图

> ID：11836902
> 
> 赞同：4
> 
> 时间：2012-08-06T22:30:25.823
> 
> 标签：c#, excel

我正在绘制带有一些数据的饼图：

```
private void DrawFractionChart(Excel.Worksheet activeSheet, Excel.ChartObjects xlCharts, Excel.Range xRange, Excel.Range yRange)
{
        Excel.ChartObject myChart = (Excel.ChartObject)xlCharts.Add(200, 500, 200, 100);
        Excel.Chart chartPage = myChart.Chart;

        Excel.SeriesCollection seriesCollection = chartPage.SeriesCollection();
        Excel.Series series1 = seriesCollection.NewSeries();
        series1.XValues = activeSheet.Range["E1","E3"];
        series1.Values = activeSheet.Range["F1","F3"];

        chartPage.ApplyDataLabels(Excel.XlDataLabelsType.xlDataLabelsShowPercent, true,true,false,true,true,true,true);
        chartPage.ChartType = Excel.XlChartType.xlDoughnut;

        Excel.Axis axis = chartPage.Axes(Excel.XlAxisType.xlValue, Microsoft.Office.Interop.Excel.XlAxisGroup.xlPrimary) as Excel.Axis;
} 
```

我只是不知道如何打开数据标签。我到处搜索它，但遗憾的是到目前为止没有任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T04:48:41.527

试试这个（**尝试和测试**）

```
 private void DrawFractionChart(Excel.Worksheet activeSheet, Excel.ChartObjects xlCharts, Excel.Range xRange, Excel.Range yRange)
    {
        Excel.ChartObject myChart = (Excel.ChartObject)xlCharts.Add(200, 500, 200, 100);
        Excel.Chart chartPage = myChart.Chart;

        Excel.SeriesCollection seriesCollection = chartPage.SeriesCollection();
        Excel.Series series1 = seriesCollection.NewSeries();
        series1.XValues = activeSheet.Range["E1", "E3"];
        series1.Values = activeSheet.Range["F1", "F3"];

        chartPage.ChartType = Excel.XlChartType.xlDoughnut;

        Excel.Axis axis = chartPage.Axes(Excel.XlAxisType.xlValue, Microsoft.Office.Interop.Excel.XlAxisGroup.xlPrimary) as Excel.Axis;

        series1.ApplyDataLabels(Excel.XlDataLabelsType.xlDataLabelsShowPercent, true, true, false, true, true, true, true);
    } 
```

一个快速的问题。如果您不使用`xRange`，`yRange`那么为什么要声明它？

这是经过尝试和测试的完整代码。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Excel = Microsoft.Office.Interop.Excel; 

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Microsoft.Office.Interop.Excel.Application xlexcel;
            Microsoft.Office.Interop.Excel.Workbook xlWorkBook;
            Microsoft.Office.Interop.Excel.Worksheet xlWorkSheet;

            object misValue = System.Reflection.Missing.Value;
            xlexcel = new Excel.Application();

            xlexcel.Visible = true;
            // Add a Workbook
            xlWorkBook = xlexcel.Workbooks.Add();

            // Set Sheet 1 as the sheet you want to work with
            xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

            xlWorkSheet.Cells[1, 5] = "Apples";
            xlWorkSheet.Cells[2, 5] = "Oranges";
            xlWorkSheet.Cells[3, 5] = "Pears";

            xlWorkSheet.Cells[1, 6] = "80";
            xlWorkSheet.Cells[2, 6] = "65";
            xlWorkSheet.Cells[3, 6] = "45";

            Excel.ChartObjects myCharts = (Excel.ChartObjects)xlWorkSheet.ChartObjects(Type.Missing);

            // Specified xlWorkSheet.Cells[3, 6], xlWorkSheet.Cells[3, 6] just for the heck of it.
            DrawFractionChart(xlWorkSheet, myCharts, xlWorkSheet.Cells[3, 6], xlWorkSheet.Cells[3, 6]);

            //Once done close and quit Excel
            //xlWorkBook.Close(true, misValue, misValue);
            //xlexcel.Quit();

            //releaseObject(xlWorkSheet);
            //releaseObject(xlWorkBook);
            //releaseObject(xlexcel);
        }

        private void DrawFractionChart(Excel.Worksheet activeSheet, Excel.ChartObjects xlCharts, Excel.Range xRange, Excel.Range yRange)
        {
            Excel.ChartObject myChart = (Excel.ChartObject)xlCharts.Add(200, 500, 200, 100);
            Excel.Chart chartPage = myChart.Chart;

            Excel.SeriesCollection seriesCollection = chartPage.SeriesCollection();
            Excel.Series series1 = seriesCollection.NewSeries();
            series1.XValues = activeSheet.Range["E1", "E3"];
            series1.Values = activeSheet.Range["F1", "F3"];

            chartPage.ChartType = Excel.XlChartType.xlDoughnut;

            Excel.Axis axis = chartPage.Axes(Excel.XlAxisType.xlValue, Microsoft.Office.Interop.Excel.XlAxisGroup.xlPrimary) as Excel.Axis;

            series1.ApplyDataLabels(Excel.XlDataLabelsType.xlDataLabelsShowPercent, true, true, false, true, true, true, true);
        }

        //private void releaseObject(object obj)
        //{
        //    try
        //    {
        //        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
        //        obj = null;
        //    }
        //    catch (Exception ex)
        //    {
        //        obj = null;
        //        MessageBox.Show("Unable to release the Object " + ex.ToString());
        //    }
        //    finally
        //    {
        //        GC.Collect();
        //    }
        //} 
    }
} 
```

**快照**

![在此处输入图像描述](../Images/e741cf2ba6fce32d0816d9a56355bdcc.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-13T08:39:28.950

```
 #region Export Excel To Chart

            Excel.Range chartRange;

            Excel.ChartObjects xlCharts = (Excel.ChartObjects)xlWorkSheet.ChartObjects(Type.Missing);
            Excel.ChartObject myChart = (Excel.ChartObject)xlCharts.Add(300, 50, 500, 500);
            Excel.Chart chartPage = myChart.Chart;

            chartRange = xlWorkSheet.get_Range("A6", "B" + (counter-1));

            chartPage.SetSourceData(chartRange, misValue);
            chartPage.ChartType = Excel.XlChartType.xlPie;// type of chart
            chartPage.ApplyDataLabels(Excel.XlDataLabelsType.xlDataLabelsShowPercent, Excel.XlDataLabelsType.xlDataLabelsShowLabel, true, false, false, true, false, true);// set label
            chartPage.Export(@"C:\excel_chart_export.bmp","BMP",misValue );

            #endregion 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-13T17:36:42.527

上面的解决方案在 VS 2013 和 Excel 2013 中对我不起作用。

添加以下引用：

```
Microsoft.Office.Core
Microsoft.Office.Interop.Excel 
```

并使用以下方法：

```
Chart oChart = ...    
oChart.SetElement(Microsoft.Office.Core.MsoChartElementType.msoElementDataLabelOutSideEnd); 
```

来源（MSDN）：

[https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.chart.setelement.aspx](https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.chart.setelement.aspx) [https://msdn.microsoft.com/en-us/library/microsoft.office.core .msochartelementtype.aspx](https://msdn.microsoft.com/en-us/library/microsoft.office.core.msochartelementtype.aspx)

# python - Python 覆盖窗口

> ID：11836912
> 
> 赞同：1
> 
> 时间：2012-08-06T22:32:10.083
> 
> 标签：python, linux, overlay, mousemove

在一个 Python 程序中，我想在鼠标指针下绘制一个（可能是形状的）覆盖窗口，它应该跟随它（我已经有代码在 mousemove 上获取它的新坐标）并且不能干扰对其他窗口的点击。我的目标平台是 Linux (KDE)，但如果它是跨平台的，那就更好了。我该怎么做，例如使用 Tkinter 或 PyQT？
提前感谢您的回答
编辑：我忘了说窗口应该支持透明度（它将是鼠标指针周围的 alpha 混合圆圈）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:11:15.170

在 PyQt 中，您可以创建任何 QWidget 以显示为窗口并使用 QWidget.setGeometry() 设置其在屏幕上的位置。

您可以阅读有关背景透明度的文档：http: [//qt-project.org/doc/qt-4.8/qwidget.html#autoFillBackground-prop](http://qt-project.org/doc/qt-4.8/qwidget.html#autoFillBackground-prop)

..以及摆脱窗口边框的问题： [如何从 Qt 小部件中删除窗口边框（包含最小化、最大化和关闭按钮）？](https://stackoverflow.com/questions/3948441/how-to-remove-the-window-border-containing-minimize-maximize-and-close-buttons)

但是，要避免捕获鼠标点击可能很困难。最简单的解决方案可能是使用 QWidget.setMask 或 Qt::WA_TransparentForMouseEvents （请参阅上面的第一个链接），但我敢打赌，这在某种程度上取决于操作系统的窗口管理器，并且不受您的程序的控制。一种可能的解决方法可能是将您的界面分解为围绕光标平铺的单独窗口。

# php - IP 和域创建不同的会话

> ID：11836914
> 
> 赞同：2
> 
> 时间：2012-08-06T22:32:42.157
> 
> 标签：php, session, web, session-cookies

我已经建立了一个用户登录的网站。现在，由于某种原因，当我从站点的 IP 和站点的域输入时，会创建一个不同的会话。

在网站中，我使用了一个全局参数，名为：ROOT 其中：

```
define("HOST", "localhost/final-project-management-system");
define("ROOT", "http://".HOST."/"); 
```

我在网站上给出了很多相关的链接`ROOT`。

当我尝试连接到 IP 时，会创建一个初始会话，但是当我移动到`ROOT`涉及的页面之一时，会创建一个新会话并删除旧会话。

有谁知道为什么会这样？

谢谢 ..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T22:36:41.907

PHP会话基于cookie的范围，您描述的行为正是它的工作原理。

cookie 的范围仅由基于浏览器地址栏中显示的主机名（或 IP）的字符串值定义。仅仅因为主机名解析为特定 IP，并不意味着它们共享 cookie。

如果您考虑一下，那么当您考虑共享托管环境时，基于解析的 IP 地址的 cookie 范围可能会导致站点之间的 cookie 泄漏的重大问题。

为了使这项工作正常工作，用户必须通过 DNS 名称或 IP 地址访问该站点*，*而*不是*两者。您*可以*手动传递会话 ID 来解决此问题，但不建议这样做（无论如何，我不推荐）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-18T10:40:50.297

如果浏览器中的 URL 包含 IP 地址，并且 cookie 存储在浏览器中针对主机名或其父域，则 cookie 不会作为请求的一部分发送到那里，可能会导致新会话的创建。

最佳实践是在服务器端设置规则，如果传入请求包含主机标头作为 IP 地址，则只需重定向到 URL 包含主机名/FQDN 的位置。当使用 IP 地址对网站发出请求时，Google、Facebook 等网站将返回 302 重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:37:33.383

您在会话中尝试过**var_dump()吗？**

```
var_dump($_SESSION); 
```

您在 php 顶部启动**session_start()吗？**

# html-email - 发送没有任何标题元素（h1，h2，h3，h4）的html电子邮件是否安全

> ID：11836915
> 
> 赞同：4
> 
> 时间：2012-08-06T22:32:42.130
> 
> 标签：html-email

我发现很难为带有或不带有链接的多个标题元素（h1、h2、h3）设置样式。我的 html 电子邮件的标题具有多种颜色和样式，而 hotmail 和 Outlook 2010 对它们的表现非常糟糕。我想知道在标题中使用“p”元素是否安全，我可以在其中拥有更多控制权。电子邮件是否会对任何电子邮件客户端/提供商产生负面影响或垃圾邮件影响？

非常感谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T16:28:52.277

在`<p>`标签中使用大字体可能会略微增加您的垃圾邮件分数。邮件正文中异常大的文本是垃圾邮件过滤器的常用触发器。

*   一般的经验法则是不要在标签中使用大于~3（~12 pt）的字体大小`<p>`，以尽量减少垃圾邮件过滤。

*   对异常大的字体使用标题标签是一种更安全的选择，并且不太可能增加垃圾邮件分数。

*   将图像用于大标题文本是减少垃圾邮件过滤的另一种方法。

[下面是关于如何避免垃圾邮件过滤器](http://www.dotmailer.co.uk/email_marketing_resources/deliverability/getting_your_email_past_the_spam_filters.aspx)的一个很好的概述。

**例子：**

这是一个[示例标题](http://www.digilink.net/antispam-ex.shtml)，说明了 DigiLink 的 SpamAssassin 工具使用的垃圾邮件过滤算法。在此示例中，声明字体大小为 3 及以上会在风险评分中增加 0.3，其中 4 及以上的总分被标记为垃圾邮件。在此示例中，使用具有默认字体大小的 h1 标题不会触发分数增加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T23:20:41.790

我真的不相信使用 p 标签代替标题标签会对电子邮件客户端产生任何负面影响。你是如何将风格应用到这些元素上的？这可能是你问题的根源。

为避免任何问题，我使用了以下链接中提供的一些建议：[HTML 电子邮件入门](http://net.tutsplus.com/tutorials/html-css-techniques/getting-started-with-html-emails)，[20 个电子邮件设计最佳实践](http://net.tutsplus.com/tutorials/html-css-techniques/20-email-design-best-practices-and-resources-for-beginners)

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-08-15T14:58:08.913

当您为网页构建 HTML 编码时，它可能看起来有点像大纲，带有主标题和副标题。为了获得最佳 SEO 结果，将关键字放在这些标题中的标题标签内很重要。

标题标签是网页 HTML 编码的一部分。标题用 H1 到 H6 标签定义。H1 标记定义页面上最重要的标题（通常也是最大或最粗的），而 H6 表示最低级别的标题。您要避免将标题视为简单的页面格式：标题在搜索引擎中占有很大的比重，因为它们用于分类，而不是化妆品。您可以使用 CSS 样式表来控制每个标题在您的站点中的外观，该样式表为每个标题标签指定字体、大小、颜色和其他属性。以下是各种标题标签的示例：

```
<H1>This is a heading</H1>
<H2>This is subheading A</H2>
<H2>This is subheading B</H2>
<H3>This is a lower subheading</H3> 
```

Search engines pay special attention to the words in your headings because they expect headings to include clues to the page’s main topics. You definitely want to include the page’s keywords inside Heading tags.

# jsf - 未调用 JSF 支持 Bean 方法

> ID：11836922
> 
> 赞同：1
> 
> 时间：2012-08-06T22:33:22.300
> 
> 标签：jsf, primefaces, method-call, backing-beans

当我单击触发 editUser(User) 方法的命令按钮或触发支持 bean 中的 editClient(User) 方法的命令按钮时，不再调用这些方法。它以前工作过，但现在什么都没有被调用。页面被重新加载。

这里有什么问题？？？

这是我的看法：

```
<p:accordionPanel activeIndex="#{userManagement.activeOverviewTab}" id="overview" rendered="#{loginControl.isAllowedForClientUserCreation()}">
<p:tab title="#{text.tabClients}" rendered="#{loginControl.isAllowedForUserManagement()}">
    <h:form id="clientForm">
    <p:dataTable value="#{userManagement.clientUsers}" var="clientUser" paginator="true" rows="5" id="clientTable">
        <p:column><f:facet name="header"><h:outputText value="#{text.colClientName}"/></f:facet><h:outputText value="#{clientUser.client.clientName}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colClientEmail}"/></f:facet><h:outputText value="#{clientUser.client.email}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colClientJobLayout}"/></f:facet><h:outputText value="#{clientUser.client.reportLayout}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersLogin}"/></f:facet><h:outputText value="#{clientUser.login}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersPassword}"/></f:facet><h:outputText value="#{clientUser.password}"/></p:column>            
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersAction}"/></f:facet>
            <p:commandLink onclick="clientDlg.show()">
                <h:graphicImage name="icons/pencil.png" title="#{text.editClientUser}" />
            </p:commandLink>
                <p:dialog header="#{text.editClientUser}" widgetVar="clientDlg" modal="true" resizable="false" width="350" height="190" showEffect="slide" hideEffect="explode">
                <h:form id="customerEditForm">
                <p:growl id="clientUserMessages"/>
                <br/>
                <p:panelGrid columns="2" columnsClasses="odd, even">
                    <h:outputLabel value="#{text.colClientName}"/><h:inputText value="#{clientUser.client.clientName}" />
                    <h:outputLabel value="#{text.colClientEmail}"/><h:inputText value="#{clientUser.client.email}" />
                    <h:outputLabel value="#{text.colClientJobLayout}"/><h:inputText value="#{clientUser.client.reportLayout}" />
                    <h:outputLabel value="#{text.colUsersLogin}"/><h:inputText value="#{clientUser.login}" />
                    <h:outputLabel value="#{text.colUsersPassword}"/><h:inputText value="#{clientUser.password}" />
                </p:panelGrid>
                <br/>
                    <p:commandButton value="#{text.applyButton}" type="button" action="#{userManagement.editClient(clientUser)}" onclick="clientDlg.hide()"/>
                    <p:commandButton value="#{text.abortButton}" type="button" onclick="clientDlg.hide()" />                    
                </h:form>
            </p:dialog>

        </p:column>             
    </p:dataTable>
    </h:form>
</p:tab>

<p:tab title="#{text.tabPrinter}" rendered="#{loginControl.isAllowedForClientUserCreation()}">
    <h:form id="userForm">
    <p:dataTable value="#{userManagement.printUsers}" var="printUser" paginator="true" rows="5" id="userTable">
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersUsername}"/></f:facet><h:outputText value="#{printUser.name}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersLogin}"/></f:facet><h:outputText value="#{printUser.login}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersPassword}"/></f:facet><h:outputText value="#{printUser.password}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colsUsersAssignedClient}"/></f:facet><h:outputText value="#{printUser.client.clientName}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersLocked}"/></f:facet><h:graphicImage name="icons/lock.png" rendered="#{printUser.locked == 1}"/></p:column>
        <p:column><f:facet name="header"><h:outputText value="#{text.colUsersAction}"/></f:facet>
            <p:commandLink onclick="dlg.show()">
                <h:graphicImage name="icons/pencil.png" title="Drucker bearbeiten" />
            </p:commandLink>
                <p:dialog header="#{text.editPrintUser}" widgetVar="dlg" modal="true" resizable="false" width="350" height="190" showEffect="slide" hideEffect="explode">
                <h:form id="printerEditForm">
                <p:growl showDetail="true" id="printerMessages" />  
                <br />
                    <p:panelGrid columns="2" columnClasses="odd, even">
                        <h:outputLabel value="#{text.colUsersLogin}"/><h:inputText value="#{printUser.login}" />    
                        <h:outputLabel value="#{text.colUsersPassword}"/><h:inputText value="#{printUser.password}" />  
                        <h:outputLabel value="#{text.colsUsersAssignedClient}"/>
                        <h:selectOneMenu value="#{printUser.client}" converter="de.flexicon.webtools.entity.Client">
                            <f:selectItems value="#{userManagement.clients}" />
                        </h:selectOneMenu>                          
                        <h:outputLabel value="#{text.colUsersLocked}"/><h:inputText value="#{printUser.locked}" />  
                        <h:outputLabel value="#{text.colClientEmail}"/><h:inputText value="#{printUser.email}" />   
                    </p:panelGrid>  
                    <br />
                        <p:commandButton value="#{text.applyButton}" type="button" action="#{userManagement.editUser(printUser)}" onclick="dlg.hide()"/>
                        <p:commandButton value="#{text.abortButton}" type="button" onclick="dlg.hide()" />
                    </h:form>
                </p:dialog>

        </p:column>
    </p:dataTable>
    </h:form>
</p:tab>
</p:accordionPanel> 
```

这是我的支持bean：

```
package de.flexicon.webtools.util;

import java.io.Serializable;
import java.util.List;
import java.util.ResourceBundle;    
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import org.apache.log4j.Logger;
import de.flexicon.webtools.entity.Client;
import de.flexicon.webtools.entity.User;
import de.flexicon.webtools.entity.dao.ClientDAO;
import de.flexicon.webtools.entity.dao.RoleDAO;
import de.flexicon.webtools.entity.dao.UserDAO;
import de.flexicon.webtools.entity.report.constants.UserRole;

@SuppressWarnings("serial")
@ManagedBean(name="userManagement")
@ViewScoped
public class UserManagement implements Serializable
{

private User newUser;
private Client selectedClient;

private List<User> clientUsers;
private List<User> printUsers;

private List<Client> clients;

private int activeOverviewTab = -1;

public UserManagement(){

}

public User getNewUser() {
    if(newUser==null){
        newUser = new User();
    }
    return newUser;
}

public void setNewUser(User newUser) {
    this.newUser = newUser;
}

/**
 * Legt einen neuen Drucker mit Kundenzuordnung an!
 */
    public void createNewTechUser(ActionEvent e){

    FacesContext ctx = FacesContext.getCurrentInstance();
    ResourceBundle bundle = ctx.getApplication().getResourceBundle(ctx, "text");

    try
    {
        UserDAO userDAO = new UserDAO();
        User user = new User();
        user.setEmail(newUser.getEmail());
        user.setLocked(0);
        user.setLogin(newUser.getLogin());
        user.setName(newUser.getName());
        user.setPassword(newUser.getPassword());
        userDAO.persist(user);

        RoleDAO roleDAO = new RoleDAO();
        user.getRoles().add(roleDAO.findById(UserRole.DRUCKER));

        user.setClient(selectedClient);
        userDAO.update(user);

        ctx.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, bundle.getString("msgNewTechUserCreated"), bundle.getString("msgNewTechUserCreated")));
    }
    catch(Exception ex){
        Logger.getRootLogger().error(bundle.getString("logErrorCreatingUser") + ex);
        ctx.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, bundle.getString("logErrorCreatingUser") + ": " + ex.getMessage(), bundle.getString("logErrorCreatingUser") + ": " + ex.getMessage()));
    }
    finally{
        setActiveOverviewTab(1);
    }
}

public void createNewClient(ActionEvent e)
{
    FacesContext ctx = FacesContext.getCurrentInstance();
    ResourceBundle bundle = ctx.getApplication().getResourceBundle(ctx, "text");
    try
    {
        UserDAO userDAO = new UserDAO();
        User user = new User();
        user.setEmail(newUser.getEmail());
        user.setLocked(0);
        user.setLogin(newUser.getLogin());
        user.setName(newUser.getName());
        user.setPassword(newUser.getPassword());
        userDAO.persist(user);

        RoleDAO roleDAO = new RoleDAO();
        user.getRoles().add(roleDAO.findById(UserRole.KUNDE));

        ClientDAO clientDAO = new ClientDAO();
        Client client = new Client();
         client.setClientName(user.getName());
         client.setEmail(user.getEmail());
        clientDAO.persist(client);

        user.setClient(client);
        userDAO.update(user);

        ctx.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, bundle.getString("msgNewTechUserCreated"), bundle.getString("msgNewTechUserCreated")));
    }
    catch(Exception ex){
        Logger.getRootLogger().error(bundle.getString("logErrorCreatingUser") + ex);
        ctx.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, bundle.getString("logErrorCreatingUser") + ": " + ex.getMessage(), bundle.getString("logErrorCreatingUser") + ": " + ex.getMessage()));
    }
    finally{
        setActiveOverviewTab(0);
    }
}

public Client getSelectedClient() {
    return selectedClient;
}

public void setSelectedClient(Client selectedClient) {
    this.selectedClient = selectedClient;
}

public List<User> getClientUsers() {
    if(clientUsers==null){

        UserDAO userDAO = new UserDAO();
        clientUsers= userDAO.getUsersByRole(UserRole.KUNDE);
    }
    return clientUsers;
}

public void setClientUsers(List<User> clientsUsers) {
    this.clientUsers = clientsUsers;
}

public void setPrintUsers(List<User> printUsers) {
    this.printUsers = printUsers;
}

public List<User> getPrintUsers() {
    if(printUsers==null){
        UserDAO userDAO = new UserDAO();
        printUsers = userDAO.getUsersByRole(UserRole.DRUCKER);
    }
    return printUsers;
}

public List<Client> getClients() {
    if(clients==null){
        ClientDAO clientDAO = new ClientDAO();
        setClients(clientDAO.getClientsOrderedByName());
    }
    return clients;
}

public void setClients(List<Client> clients) {
    this.clients = clients;
}

public void editUser(User user){
    UserDAO userDAO = new UserDAO();
    userDAO.update(user);
    FacesContext context = FacesContext.getCurrentInstance();
    ResourceBundle bundle = context.getApplication().getResourceBundle(context, "text");
    context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, bundle.getString("printerUpdated"), bundle.getString("descUpdatedPrintUser")));
    setActiveOverviewTab(1);
}

public void editClient(User user){
    UserDAO userDAO = new UserDAO();
    userDAO.update(user);
    FacesContext context = FacesContext.getCurrentInstance();
    ResourceBundle bundle = context.getApplication().getResourceBundle(context, "text");
    context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO, bundle.getString("printerUpdated"), bundle.getString("descUpdatedPrintUser")));
    setActiveOverviewTab(0);
}

public void setActiveOverviewTab(int tabIdx){
    this.activeOverviewTab = tabIdx;
}

public int getActiveOverviewTab(){
    return this.activeOverviewTab;
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T03:14:59.613

您正在嵌套表单。有关更多详细信息，请参阅[h:commandLink / h:commandButton 没有被调用](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked)。

# jasper-reports - JasperReports：子报表多次渲染，导致重复页面

> ID：11836923
> 
> 赞同：2
> 
> 时间：2012-08-06T22:33:29.660
> 
> 标签：jasper-reports, duplicates, subreport

我正在使用*JasperReports*使用两个单独的查询为 Web 应用程序生成图形和表格。我的主要*JRXML*生成图表，我在***Detail***区域中包含一个子报表来生成表格。但是，当它呈现时，子报表似乎被呈现了多次（确切地说是 12 次），这导致生成的报表是 12 页上的相同图表和表格（彼此完全相同）。这通过在线应用程序和*iReport*都发生。

我的主要*JRXML*、子报表*JRXML*和报表生成代码如下（由于 NDA 原因，一些细节已被删除）。

任何有关问题所在的见解或想法都会非常有帮助。

主要*JRXML*：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
        <property name="ireport.zoom" value="1.0"/>
        <property name="ireport.x" value="0"/>
        <property name="ireport.y" value="0"/>
        <parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
            <defaultValueExpression><![CDATA["<<PATH_TO_SUBREPORT>>"]]></defaultValueExpression>
        </parameter>
        <parameter name="param" class="java.util.Collection" />     
     <queryString language="SQL">
            <![CDATA[<<DATABASE_QUERY>>]]>
        </queryString>
        <field name="FIELD1" class="java.lang.Integer"/>
        <field name="FIELD2" class="java.sql.Date"/>
        <field name="FIELD3" class="java.math.BigDecimal"/>
        <field name="FIELD4" class="java.math.BigDecimal"/>
        <field name="FIELD5" class="java.math.BigDecimal"/>
        <background>
            <band splitType="Stretch"/>
        </background>
        <title>
            <band height="10" splitType="Stretch"/>
        </title>
        <pageHeader>
            <band height="5" splitType="Stretch"/>
        </pageHeader>
        <columnHeader>
            <band height="5" splitType="Stretch"/>
        </columnHeader>
        <detail>
            <band height="513" splitType="Stretch">
                <lineChart>
                    <chart>
                        <reportElement positionType="Float" x="51" y="0" width="680" height="400"/>
                        <chartTitle/>
                        <chartSubtitle/>
                        <chartLegend/>
                    </chart>
                    <categoryDataset>
                        <categorySeries>
                            <seriesExpression><![CDATA["FIELD1"]]></seriesExpression>
                            <categoryExpression><![CDATA[$F{f1}]]></categoryExpression>
                            <valueExpression><![CDATA[$F{f2}]]></valueExpression>
                        </categorySeries>
                        <categorySeries>
                            <seriesExpression><![CDATA["FIELD2"]]></seriesExpression>
                            <categoryExpression><![CDATA[$F{f1}]]></categoryExpression>
                            <valueExpression><![CDATA[$F{f2}]]></valueExpression>
                        </categorySeries>
                        <categorySeries>
                            <seriesExpression><![CDATA["FIELD3"]]></seriesExpression>
                            <categoryExpression><![CDATA[$F{f1}]]></categoryExpression>
                            <valueExpression><![CDATA[$F{f2}]]></valueExpression>
                        </categorySeries>
                    </categoryDataset>
                    <linePlot>
                        <plot labelRotation="-90.0"/>
                        <categoryAxisFormat labelRotation="-90.0">
                            <axisFormat>
                                <tickLabelFont>
                                    <font size="12"/>
                                </tickLabelFont>
                            </axisFormat>
                        </categoryAxisFormat>
                        <rangeAxisMinValueExpression><![CDATA[0]]></rangeAxisMinValueExpression>
                        <rangeAxisMaxValueExpression><![CDATA[101]]></rangeAxisMaxValueExpression>
                    </linePlot>
                </lineChart>
                <subreport>
                    <reportElement x="377" y="413" width="425" height="100"/>
                    <subreportParameter name="param">
                        <subreportParameterExpression><![CDATA[$P{param}]]></subreportParameterExpression>
                    </subreportParameter>
                    <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                    <subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "testReport.jasper"]]></subreportExpression>
                </subreport>
            </band>
        </detail>
        <columnFooter>
            <band height="5" splitType="Stretch"/>
        </columnFooter>
        <pageFooter>
            <band height="15" splitType="Stretch">
                <textField>
                    <reportElement mode="Opaque" x="3" y="2" width="759" height="13" backcolor="#E6E6E6"/>
                    <textElement textAlignment="Right"/>
                    <textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
                </textField>
                <textField evaluationTime="Report">
                    <reportElement mode="Opaque" x="762" y="2" width="40" height="13" backcolor="#E6E6E6"/>
                    <textElement/>
                    <textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
                </textField>
                <textField pattern="EEEEE dd MMMMM yyyy">
                    <reportElement x="3" y="0" width="100" height="13"/>
                    <textElement/>
                    <textFieldExpression><![CDATA[new SimpleDateFormat("MM-dd-yyyy").format(
    new java.util.Date())]]></textFieldExpression>
                </textField>
            </band>
        </pageFooter>
        <summary>
            <band height="10" splitType="Stretch"/>
        </summary>
    </jasperReport> 
```

子报告*JRXML*：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="evcas_sub" language="groovy" pageWidth="450" pageHeight="150" columnWidth="10" leftMargin="10" rightMargin="10" topMargin="10" bottomMargin="10">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <style name="table">
        <box>
            <pen lineWidth="1.0" lineColor="#000000"/>
        </box>
    </style>
    <style name="table_TH" mode="Opaque" backcolor="#0000FF">
        <box>
            <pen lineWidth="0.5" lineColor="#000000"/>
        </box>
    </style>
    <style name="table_CH" mode="Opaque" backcolor="#BFBFFF">
        <box>
            <pen lineWidth="0.5" lineColor="#000000"/>
        </box>
    </style>
    <style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
        <box>
            <pen lineWidth="0.5" lineColor="#000000"/>
        </box>
        <conditionalStyle>
            <conditionExpression><![CDATA[new Boolean($V{REPORT_COUNT}.intValue()%2==0)]]></conditionExpression>
            <style backcolor="#EFEFFF"/>
        </conditionalStyle>
    </style>
    <style name="Crosstab Data Text" hAlign="Center"/>
    <parameter name="param" class="java.util.Collection" />
    <queryString>
        <![CDATA[<<DATABASE_QUERY>>]]>
    </queryString>
    <field name="FIELD1" class="java.lang.String"/>
    <field name="FIELD2" class="java.math.BigDecimal"/>
    <field name="FIELD3" class="java.math.BigDecimal"/>
    <field name="FIELD4" class="java.math.BigDecimal"/>
    <field name="FIELD5" class="java.math.BigDecimal"/>
    <field name="FIELD6" class="java.math.BigDecimal"/>
    <field name="FIELD7" class="java.math.BigDecimal"/>
    <field name="FIELD8" class="java.math.BigDecimal"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="5" splitType="Stretch"/>
    </title>
    <pageHeader>
        <band height="5"/>
    </pageHeader>
    <columnHeader>
        <band height="12">
            <textField>
                <reportElement style="table_TH" x="0" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD1"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="50" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD2"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="100" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD3"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="150" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD4"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="200" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD5"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="250" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD6"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="300" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD7"]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_TH" x="350" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="9"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA["FIELD8"]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>
    <detail>
        <band height="12">
            <textField>
                <reportElement style="table_CH" x="0" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f1}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="50" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f2}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="100" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f3}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="150" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f4}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="200" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f5}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="250" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f6}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="300" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f7}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement style="table_CH" x="350" y="0" width="50" height="12" backcolor="#FFFFFF"/>
                <textElement>
                    <font size="8"/>
                    <paragraph leftIndent="2"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{f8}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <columnFooter>
        <band height="5" splitType="Stretch"/>
    </columnFooter>
    <pageFooter>
        <band height="5" splitType="Stretch"/>
    </pageFooter>
</jasperReport> 
```

渲染代码：

```
String strFileName = "<<FILENAME>>";
File jrxml = new File(strFileName);
InputStream iStream = new FileInputStream(jrxml);
JasperReport objJReport = JasperCompileManager.compileReport(iStream);
JasperPrint objJPrint = JasperFillManager.fillReport(objJReport, hashMap, datasource.getConnection());
JasperExportManager.exportReportToPdfStream(objJPrint, os); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T08:35:57.803

数据集中的每条记录都会打印一个详细信息带。因此，如果您的数据库查询返回 12 行，您将获得 12 个详细信息带的副本。每个波段都使用单行中的数据，但这对您来说无关紧要，因为您正在使用图表和子报表来显示数据。

为避免这种重复，只需将您的图表和子报告放入不同的波段。我会选择列标题或页脚，但除了细节之外的任何东西都可以。

# python - 将 pyodbc.Binary 数据 (BLOB) 插入 SQL Server 图像列

> ID：11836924
> 
> 赞同：6
> 
> 时间：2012-08-06T22:33:32.297
> 
> 标签：python, sql-server-2008, pyodbc

我正在尝试将二进制数据插入到`image`SQL Server 数据库中的数据类型列中。我知道`varbinary(max)`是首选数据类型，但我无权更改架构。

无论如何，我正在读取文件的内容并将其包装在 pyodbc.Binary() 中，如下所示：

```
f = open('Test.ics', 'rb')
ablob = f.read().encode('hex')
ablob = pyodbc.Binary(ablob) 
```

当我`print repr(ablob)`看到正确的值时`bytearray(b'424547494e3a5 . . .`（添加了省略号）。

但是，插入后

```
insertSQL = """insert into documents(name, documentType, document, customerNumber) values(?,?,?,?)"""
cur.execute(insertSQL, 'test200.ics', 'text/calendar', pyodbc.Binary(ablob), 1717) 
```

文档列的值`0x343234353 . . .`看起来好像十六进制数据已转换为 ASCII 字符代码。

我认为将值包装在 pyodbc.Binary() 会解决这个问题吗？任何帮助将不胜感激。

我正在使用 Python 2.7 和 SQL Server 2008 R2 (10.50)。

**编辑**：

Beargle 好心地指出，我不必要地调用了 encode('hex')，这导致了我的问题。我相信这一定是将数据强制转换为字符串（尽管更全面的解释会有所帮助）。

工作代码：

```
ablob = pyodbc.Binary(f.read())
cur.execute(insertSQL, 'test200.ics', 'text/calendar', ablob, 1717) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T14:17:25.880

首先确保您使用[`with open(..)`](http://docs.python.org/tutorial/inputoutput.html#methods-of-file-objects)读取文件（[另一个示例](https://stackoverflow.com/questions/1373660/file-open-is-this-bad-python-style#1373713)）。这会在文件对象用尽*或*引发异常时自动关闭。

```
# common vars
connection = pyodbc.connect(...)
filename = 'Test.ics'
insert = 'insert into documents (name, documentType, document, customerNumber)'

# without hex encode
with open(filename, 'rb'):
    bindata = f.read()

# with hex encode
with open(filename, 'rb'):
    hexdata = f.read().encode('hex')

# build parameters
binparams = ('test200.ics', 'text/calendar', pyodbc.Binary(bindata), 1717)
hexparams = ('test200.ics', 'text/calendar', pyodbc.Binary(hexdata), 1717)

# insert binary
connection.cursor().execute(insert, binparams)
connection.commit()

# insert hex
connection.cursor().execute(insert, hexparams)
connection.commit()

# print documents
rows = connection.cursor().execute('select * from documents').fetchall()
for row in rows:
    try:
        # this will decode hex data we inserted
        print str(row.document).decode('hex')
    # attempting to hex decode binary data throws TypeError
    except TypeError:
        print str(row.document) 
```

我猜您是`0x343234353...`通过查看 Management Studio 中的结果来获取数据的：

![SQL Server Management Studio 结果](../Images/fc1230403cc3611a2318c0120e031212.png)

这并不意味着数据是以这种方式存储的，它只是 Management Studio 在结果窗格中表示`image`、`text`、`ntext`、`varbinary`等数据类型的方式。

# swing - 您是否需要对 Swing 有深入的了解才能继续使用 JavaFX？

> ID：11836925
> 
> 赞同：1
> 
> 时间：2012-08-06T22:33:35.620
> 
> 标签：swing, javafx-2

我的目标是将 Swing 与 JavaFX 一起使用，因为我对两者都是全新的，我想为什么不现在。我最终要创建一个 WhiteBoard 应用程序，但在我的第一遍中，我只是在 Swing 中制作了一个名为 StickyNotes 的应用程序。

但我也想要 JavaFX 的所有新特性。

我已经使用 Swing 工作了几个星期，到目前为止已经取得了相当大的成就。

那么现在是开始使用 JavaFX 的好时机吗？

PS这一定是我之前看到的链接：http: [//docs.oracle.com/javafx/2/swing/jfxpub-swing.htm](http://docs.oracle.com/javafx/2/swing/jfxpub-swing.htm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T15:45:40.327

JavaFX 最终将取代 Swing，Oracle 的大部分（如果不是全部）新开发将针对 JavaFX。如果您对两者都不熟悉，我认为学习 Swing 没有任何优势 - 只需开始在 JavaFX 中工作，因为它们具有不同的事件模型。

作为一种快速生成新 GUI 应用程序的方法，请试用 JavaFX SceneBuilder：[http ://docs.oracle.com/javafx/scenebuilder/1/get_started/jsbpub-get_started.htm](http://docs.oracle.com/javafx/scenebuilder/1/get_started/jsbpub-get_started.htm)

它是一款出色的工具，可让您在很短的时间内生成功能齐全的应用程序。以下是我发现有用的其他几个 JavaFX 链接：

[http://fxexperience.com/](http://fxexperience.com/)

[http://www.learnjavafx.typepad.com/weblog/](http://www.learnjavafx.typepad.com/weblog/)

# apache-camel - 在 Camel 中聚合多个请求后响应 MINA 请求

> ID：11836927
> 
> 赞同：1
> 
> 时间：2012-08-06T22:33:44.590
> 
> 标签：apache-camel, apache-mina

我正在尝试实现一个 mina 服务，其中对最终消息的响应应该基于以前的消息。每条消息（header (1), data (n), end (1)）都应该收到一个响应，但是对“end”消息的响应应该基于“header”，并且接收到的任何“data”消息也是如此作为“结束”消息。目前，我正在将消息路由到一个聚合器，该聚合器在找到特定关联 ID 的“标题”和“结束”消息时完成。不幸的是，响应是在消息发送到聚合器之前（或同时？）发送的，因此我无法访问聚合消息（其中包含构建正确响应所需的所有数据）时构建响应。

有没有办法做到这一点，而无需手动存储和访问累积的数据（即，无需重新实现骆驼的聚合器）？

编辑：

路线类似于：

```
<camelContext>
    <route>
        <from uri="mina:..."/>
        <process ref="messageProcessor"/>
        <aggregate>
            <process ref="completeMessageProcessor"/>
        </aggregate>
    </route>
</camelContext> 
```

为了清楚起见，我省略了一些标签和属性（`correlationExpression`、`completionPredicate`、`strategyRef`等）。

消息被正确聚合，并且在“完成”（即聚合时）时被正确处理。但是通过`mina`端点发送回客户端的响应是由 生成的`messageProcessor`，而不是由`completeMessageProcessor`.

例如（是的，这是一个相当人为的例子，但请耐心等待），假设该协议涉及客户端发送一个标头消息，其中包括它期望发送的数据消息的总数。然后它发送一些数据消息，这些数据消息的数量可能与它预期发送的不同。最后，它发送一个页脚或结束消息。然后，服务器应以预期消息数与实际消息数之间的差异进行响应。使用所写的路由，这是不可能的，因为消息的数量不知道`messageProcessor`，它只处理单个消息。,`completeMessageProcessor`具有聚合消息（由标头、所有数据和结尾组成）**确实**知道这个数字，但此时生成的响应不会传播回`mina`端点。

更改消息的解析以仅在接收到完整的组合消息时生成消息不是一种选择，因为服务器必须响应各个消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T03:32:01.900

最重要的是，我的猜测是`messageProcessor`正在设置 OUT 消息，但`completeMessageProcessor`正在设置 IN 消息。[mina](http://camel.apache.org/mina.html)消费者的响应是期待/使用 OUT 消息。

您可以添加一些[日志](http://camel.apache.org/log.html)来验证这一点。如果是这种情况，那么您可能会更改`messageProcessor`为使用 IN 正文（或使用交换标头）并在您`completeMessageProcessor`根据 IN 正文设置 OUT 正文之后添加一个转换

```
<transform>
  <simple>${in.body}</simple>
</transform> 
```

有关更多信息，请参见：http: [//camel.apache.org/using-getin-or-getout-methods-on-exchange.html](http://camel.apache.org/using-getin-or-getout-methods-on-exchange.html)

更新：经过一番讨论，真正的问题是聚合器目前只处理“InOnly”交换

# css - 如何让一个 div 与另外两个 div 重叠？

> ID：11836928
> 
> 赞同：0
> 
> 时间：2012-08-06T22:33:52.487
> 
> 标签：css, html, overlap

我正在为簿记服务进行网站设计：

[http://digitaldemo.net/vintage/home.html](http://digitaldemo.net/vintage/home.html)

整体“外观”应该是桌面吸墨纸的外观。一切都在全面正确地渲染，但我遇到了一个问题。

我试图让主要内容区域（“桌面吸墨纸”）与顶部和底部边框重叠。

整个页面背景是无缝平铺的图像（较浅的棕色/金色），然后顶部边框是 DIV（#section-head），其背景是半透明 PNG，底部边框 DIV（#section-foot）有同样的半透明背景也是如此。

我的“桌面吸墨纸”位于#container DIV 中，该 DIV 使用以下 CSS 重叠顶部边框：

```
#container  { clear:both ;
width:1002px ;
margin:auto ;
background:url("images/paper-bg.jpg") ;
min-height:600px ;
position:relative ;
top:-40px ;
-webkit-box-shadow: #0e0300 0px 0px 14px;
-moz-box-shadow: #0e0300 0px 0px 14px;
box-shadow: #0e0300 0px 0px 14px;
behavior: url("PIE.htc");
z-index:1000 ;
} 
```

这一切都很好。问题是它会在#container DIV 的底部产生一个等于-40px 顶部位置的间隙。

所以两个问题：

一个。我如何摆脱这个差距；湾。如何让“桌面吸墨纸”也与底部边框重叠？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:42:54.543

我不确定我是否完全理解，但要让吸墨纸与页脚重叠，您可以添加以下 CSS：

```
#section-foot {
    position: relative;
    top: -80px;
} 
```

如果您在此处有任何其他内容，您可能希望在页脚顶部添加一些填充。

# ruby-on-rails - AJAX 中的 Cucumber + Capybara 和更新 html

> ID：11836931
> 
> 赞同：0
> 
> 时间：2012-08-06T22:34:19.367
> 
> 标签：ruby-on-rails, ajax, cucumber, capybara

我有一个下拉列表，当值更改时，它会执行 AJAX 调用并在子下拉列表中呈现一些新内容。在 capybara 中选择第一个下拉菜单时，即使选择正确，它也不会更新第二个下拉菜单。

我这样做是为了测试：

```
select(province, :from => "province_id")
print page.html 
```

即使我看到选择的省份，我也没有看到第二个下拉列表（城市）与对应的省份一起更新。

我能做些什么？

# facebook - Facebook JS SDK 在尝试删除应用请求时抛出 104 错误

> ID：11836933
> 
> 赞同：0
> 
> 时间：2012-08-06T22:34:50.240
> 
> 标签：facebook, facebook-c#-sdk, facebook-javascript-sdk

我已经设置了 facebook javascript sdk 来初始化朋友邀请对话框以向朋友发送请求。单击 Facebook 中的邀请，将用户带回该站点。

查询字符串包含所有未处理（删除）的 request_id。

我正在关注[此处](https://developers.facebook.com/docs/requests/#deleting)的 FB 开发人员网站上列出的文档，其中指出：

***JavaScript SDK:*** FB.api(requestId, 'delete', function(response) {

当它们返回到我的站点时，查询字符串有一个**request_ids**参数：

**例如：** www.mysite.com/somepage ?request_ids=0493834050

我的 Javascript 代码如下所示：

```
FB.api(requestIds[i], 'delete', function (response) {
          console.log(response);
        }); 
```

但我得到的错误是：

**错误**

代码：104

消息：“请求此资源需要访问令牌。”

类型：“OAuthException”

我要做的就是删除请求 ID。在我运行上面的代码之前，查询字符串是随着每个提交的请求建立起来的。看来它们已被删除，因为查询字符串已减少为单个请求 ID。但我仍然不确定它是否得到了妥善处理。

**注意** 我没有使用 Graph 版本 - 因为我没有在 Facebook 的应用程序设置中设置 Graph。

我有 Facebook C# sdk - 如果有人在这里有一个简单的方法来做到这一点。我已经尝试了以下相同的结果。

```
var fbClient = new FacebookClient(accessToken)
fbClient.Delete(requestId); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T11:40:04.583

我看不出错误消息有什么可能不清楚的地方——你需要一个有效的访问令牌才能删除请求，但看起来你没有。

因此，您要么必须让用户连接到您的应用程序才能为他获取活动访问令牌；或者您必须使用您自己的应用程序访问令牌来执行此操作（但这必须在服务器端完成，因为您不想将您的应用程序访问令牌传输到客户端）。

# ssl - Heroku，不断从 Google Web Master Tool 收到 SSL 证书错误

> ID：11836934
> 
> 赞同：1
> 
> 时间：2012-08-06T22:34:57.260
> 
> 标签：ssl, heroku

我不断从 google web master 工具收到 ssl 证书错误，如下所示。

* * *

> 尊敬的网站管理员，您网站的主机名[https://myapp.com/](https://myapp.com/)与您的 SSL 证书中的任何“主题名称”都不匹配，它们是：
> 
> *.herokuapp.com
> herokuapp.com
> 
> 这将导致许多网络浏览器阻止用户访问您的站点，或在访问您的站点时显示安全警告消息。要更正此问题，请由证书颁发机构 (CA) 获取新的 SSL 证书，其中“主题名称”或“主题备用 DNS 名称”与您的主机名匹配。谢谢，Google 网络抓取小组

* * *

我按照 Heroku 开发中心的说明将 ssl 设置为我的 heroku 应用程序。

[https://devcenter.heroku.com/articles/ssl-certificate](https://devcenter.heroku.com/articles/ssl-certificate) [https://devcenter.heroku.com/articles/ssl-endpoint](https://devcenter.heroku.com/articles/ssl-endpoint)

我还使用 rack_rewrite 进行 301 重定向，以便从裸域重定向到 www 子域。

浏览器似乎一切正常，当我访问裸域时，它将重定向到[https://www.myapp.com](https://www.myapp.com)而没有任何 SSL 错误。

# heroku 的输出如下

```
heroku certs --remote production

Endpoint                Common Name(s)                      Expires               Trusted
----------------------  ----------------------------------  --------------------  -------
XXXXXXXX.herokussl.com  www.myapp.com, myapp.com            2013-08-05 00:20 PHT  True

heroku certs:info --remote production

Fetching information on SSL endpoint XXXXXXX.herokussl.com... done
Certificate details:
    subject: /serialNumber=XXXXXXXXXX www.rapidssl.com/resources/cps (c)12/OU=Domain Control Validated - RapidSSL(R)/CN=www.myapp.com
    start date: (some date)
    expire date: (some date)
    common name(s): www.myapp.com, myapp.com
    issuer: /serialNumber=XXXXXXXXXXX www.rapidssl.com/resources/cps (c)12/OU=Domain Control Validated - RapidSSL(R)/CN=www.myapp.com
    SSL certificate is verified by a root authority. 
```

# 域设置

```
Type    NAME           TTL         Points to
ALIAS   myapp.com      3600     xxxxxx.herokussl.com
CNAME   www.myapp.com  3600     xxxxxx.herokussl.com 
```

为什么我不断收到来自 Google 的错误消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T00:31:30.300

不支持裸域。[请参阅Heroku Endpoint SSL](https://devcenter.heroku.com/articles/ssl-endpoint#naked-domains)的文档部分

# java - Drools Planner 考试示例只有一个 Topic

> ID：11836935
> 
> 赞同：0
> 
> 时间：2012-08-06T22:35:01.767
> 
> 标签：java, drools, drools-planner

我测试了 Drools Planner 的考试示例。过了一会儿，我想解决一个未解决的问题。我启动了应用程序，选择了一个 xml 文件并点击了解决按钮。在我的 XML 文件中有 5 个考试，有 5 个不同的主题（t1、t2、t3、t4、t5）。

Drools 生成了一个解决方案。在这个解决方案中，有 5 门考试，但它们都有相同类型的主题 (t1)。我没有发现为什么流口水给我 5 次相同主题的考试失败。一开始（在解决之前）调试器告诉我所有考试都有不同的主题。

通常不应该改变考试的主题。

在我的**ExamSolutionInitializer.java**中，方法“ *changeWorkingSolution* ”返回错误的解决方案。*scoreDirector.getWorkingSolution()*生成的考试只有一个主题。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T06:09:27.430

**您的 XML 输入文件中可能存在错误。**您可以将其复制粘贴到此处或 gist.github.com 上并链接吗？

在 Drools Planner 的考试示例中，每个 Exam 实例正好有 1 个字段 Topic，并且 Planner 永远不会更改它。Planner 更改的是考试的字段 Room 和 Period。

```
public class Exam ... {

    private Topic topic;
    ...

    // Planning variables: changes during planning, between score calculations.
    private Period period;
    private Room room;
    ...
} 
```

此外，考试与主题的关系是一对一的关系。它们本可以设计为 1 类，但没有。主题类包含在计划期间不会更改的所有考试信息，考试类将每个主题链接到它的房间和时期。

![考试域图](../Images/1859329876345d951e584b2e06e0dfb3.png)

至于 ExamSolutionInitializer.java：这是在 Planner 中添加构造启发式之前编写的。现在，通常最好只使用首次拟合或首次拟合递减。它仍然存在于考试示例中的唯一原因是，它具有特定领域的代码来处理`Exam.isCoincidenceLeader()`需要同时安排多个考试并因此需要一起移动的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T14:40:12.663

问题是我在我的exam.java中将主题声明为@PlanningVariable

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T10:08:11.363

也许问题是我的新规划变量“天”。我不想在此期间有一个日索引。所以我复制了期间的课程并将它们变成了日间课程。在我的 ExamSolutionInitializer 中，我有 initializeExamList。在遍历每个时间段和每个 ExamToHandle 之前，我会遍历这些天。但我认为问题可能出在 scheduleLeader() 上。在这种方法中，我找出了 bestRoom 和 bestPeriod，但没有找出 bestDay。你怎么看？

# php - PHP/SQL 列表顺序不显示

> ID：11836936
> 
> 赞同：0
> 
> 时间：2012-08-06T22:35:07.943
> 
> 标签：php, mysql

**一点信息**

我目前正在做一个项目，我可以在其中将我的工作显示为项目。

在我的数据库中，我已经设置了它，所以里面的数字`list`告诉 PHP 它应该在哪里 - 根据 MYSQL 查询。

在我的项目页面中，我创建了分页，因此如果超过 5 行，则会将一个新的项目列表页面添加到分页中。

（我的前后分页是通过链接的图像完成的）

我使用 Jquery Ajax POST 来调用新页面。

**问题：**

我曾经将我的 PHP 查询设置为按`name`（项目名称）排序，但我创建了一个新列`list`，以便我可以按自定义顺序显示它们 - 根据中的数字`list`

但是自从我将其从更改`name`为`list`- 该页面仅显示 5 条记录并且不再为我提供分页选项（何时应该）

我知道问题与分页中的 2 个查询有关 - 谁能告诉我如何解决这个问题。

我试过让`list`Char、Varchar 和 INT 列都没有帮助！:(

**编码：**

**PHP分页：**

```
 <?
$get_stuff = mysql_query("SELECT * FROM `projects` WHERE `cat`='$arrc' ORDER BY `list` ASC")or die(mysql_error());
$getid = mysql_num_rows($get_stuff);
$r = mysql_fetch_row($get_stuff);
$numrows = $r[0];
// number of rows to show per page
$rowsperpage = 5;
// find out total pages
$totalpages = ceil($numrows / $rowsperpage);

// get the current page or set a default
if (isset($_POST['pid']) && is_numeric($_POST['pid'])) {
   // cast var as int
   $currentpage = (int) $_POST['pid'];
} else {
   // default page num
   $currentpage = 1;
} // end if

// if current page is greater than total pages...
if ($currentpage > $totalpages) {
   // set current page to last page
   $currentpage = $totalpages;
} // end if
// if current page is less than first page...
if ($currentpage < 1) {
   // set current page to first page
   $currentpage = 1;
} // end if

// the offset of the list, based on current page 
$offset = ($currentpage - 1) * $rowsperpage;
// get the info from the db 
$get_stuff2 = mysql_query("SELECT * FROM `projects` WHERE `cat`='$arrc' ORDER BY `list` ASC LIMIT $offset, $rowsperpage")or die(mysql_error());
while($projectz = mysql_fetch_array($get_stuff2)){
?>
<ul class="projex">
<li onClick="project('project','<? echo $projectz['id']; ?>','1','<? echo $currentpage; ?>')" class="onclick"> <? echo $projectz['name']; ?>
</ul>
<?
}
?> 
```

我没有添加我的链接代码，因为我知道这不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T02:45:47.080

您的问题似乎在这里：

```
<?
$get_stuff = mysql_query("SELECT * FROM `projects` WHERE `cat`='$arrc' ORDER BY `list` ASC")or die(mysql_error());
$getid = mysql_num_rows($get_stuff);
$r = mysql_fetch_row($get_stuff);
$numrows = $r[0]; 
```

您将行数放入`$getid`，然后忽略该变量并将结果集中返回的第一个列放入`$numrows`并使用它。这意味着所有的分页计算都是基于返回的第一列而不是行数。我猜想按`name`第一列排序时为 7，而按`list`第一列排序时为 5 或更少。

我建议的解决方法是获取`COUNT`SQL 查询中的行数，除非您的示例中没有显示迫切需要`$getid`：

```
<?php
$get_stuff = mysql_query("SELECT COUNT(*) FROM `projects` WHERE `cat`='$arrc'")or die(mysql_error());
$r = mysql_fetch_row($get_stuff);
$numrows = $r[0]; 
```

# php - 单数验证码匹配，PHP

> ID：11836937
> 
> 赞同：1
> 
> 时间：2012-08-06T22:35:15.997
> 
> 标签：php, mysql, html, captcha

我经营一个 PTC 网站，为人们宣传网站。而且我需要一个易于降低或完全阻止机器人使用的方法。

广告计数器完成倒计时后，我想加载验证码。
但我不想要你必须输入任何东西的验证码。只需单击鼠标。

如果验证码可以在 javascript 中完成，那就太好了。

我正在寻找类似这样的东西：

计数器：0 选择匹配数：7 [1] [0] [7] [2]

用户必须单击与该数字匹配的框中的数字。

数字将在 1-9 之间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T10:11:55.073

我制作了一个[验证](http://en.wikipedia.org/wiki/CAPTCHA "完全自动化的公共图灵测试来区分计算机和人类")码脚本。它的大小、字符数和可供选择的字符都是可定制的。

**这里是`captcha.php`：**

```
<?php
function generateCaptcha($num_digits, $challenge_num, $size, $chars, $incode = false) {
    if(session_id() == '') session_start();
    if(isset($_SESSION['captcha'])) unset($_SESSION['captcha']);
    // You *must* type your own random salt here, *DO NOT* use this one.
    $salt = 'H#(*h3^rh@(*E%h$W*WK#vMIv)%(D*(A&*W@A^D6@r4*I%u8tgsc#yejdi$d8dee';
    $message = '';
    if(isset($_POST['hash']) && isset($_POST['code'])) {
        if(!empty($_POST['hash']) && !empty($_POST['code']) && !empty($_POST['correct_index'])) {
            if(md5($_POST['hash'] . $_POST['code'] . $salt) == $_POST['correct_index']) {
                $message = '<p>Correct!</p>';
            } else {
                $message = 'Incorrect code. Please try again.';
            }
        }
    }
    $code = '';
    if($incode == false) {
        for($i = 0; $i < $num_digits; $i++) {
            $digit = substr($chars, floor(mt_rand(0, strlen($chars) - 1)), 1);
            while(strpos($code, "$digit") !== false) {
                $digit = substr($chars, floor(mt_rand(0, strlen($chars) - 1)), 1);
            }
            $code .= $digit;
        }
    } else {
        for($i = 0; $i < $num_digits; $i++) {
            $digit = substr($incode, floor(mt_rand(0, strlen($incode) - 1)), 1);
            while(strpos($code, "$digit") !== false) {
                $digit = substr($incode, floor(mt_rand(0, strlen($incode) - 1)), 1);
            }
            $code .= $digit;
        }
    }
    $parts = str_split($code);
    $width = $num_digits * $size;
    $height = $size * 2;
    $image = imagecreatetruecolor($width, $height);
    $background = imagecolorallocate($image, floor(mt_rand(96, 255)), floor(mt_rand(96, 255)), floor(mt_rand(96, 255)));
    imagefilledrectangle($image, 0, 0, $width, $height, $background);
    $num_spots = floor(mt_rand($size * 2, $size * 15));
    for($i = 0; $i < $num_spots; $i++) {
        $color = imagecolorallocate($image, floor(mt_rand(30, 255)), floor(mt_rand(30, 255)), floor(mt_rand(30, 255)));
        $x = floor(mt_rand(0, $width));
        $y = floor(mt_rand(0, $height));
        $ellipse_width = floor(mt_rand(0, $size / 2));
        $ellipse_height = floor(mt_rand(0, $size / 2));
        imagefilledellipse($image, $x, $y, $ellipse_width, $ellipse_height, $color);
        $x1 = floor(mt_rand(0, $width));
        $y1 = floor(mt_rand(0, $height));
        $x2 = floor(mt_rand(0, $width));
        $y2 = floor(mt_rand(0, $height));
        imageline($image, $x1, $y1, $x2, $y2, $color);
    }
    $num_dots = floor(mt_rand($size * 50, $size * 80));
    for($i = 0; $i < $num_dots; $i++) {
        $color = imagecolorallocate($image, floor(mt_rand(30, 255)), floor(mt_rand(30, 255)), floor(mt_rand(30, 255)));
        $x = floor(mt_rand(0, $width));
        $y = floor(mt_rand(0, $height));
        imagesetpixel($image, $x, $y, $color);
    }
    for($i = 0; $i < count($parts); $i++) {
        $color = imagecolorallocate($image, floor(mt_rand(0, 150)), floor(mt_rand(0, 150)), floor(mt_rand(0, 150)));
        $x = floor(mt_rand($size * 0.9, $size * 1.1));
        $y = floor(mt_rand($size, $size * 2));
        imagettftext($image, $size, floor(mt_rand(-10, 10)), $i * $x, $y, $color, 'Justus-Bold.ttf', $parts[$i]);
        imagettftext($image, $size, floor(mt_rand(-10, 10)), $i * $x + floor(mt_rand(1, 7)), $y, $color, 'Justus-Bold.ttf', $parts[$i]);
        imagettftext($image, $size, floor(mt_rand(-10, 10)), $i * $x + floor(mt_rand(1, 7)), $y, $color, 'Justus-Bold.ttf', $parts[$i]);
        imagettftext($image, $size, floor(mt_rand(-10, 10)), $i * $x + floor(mt_rand(1, 7)), $y, $color, 'Justus-Bold.ttf', $parts[$i]);
    }
    $white = imagecolorallocate($image, 255, 255, 255);
    $filename = md5(time() . $_SERVER['REMOTE_ADDR'] . mt_rand(0, 1000)) . '.png';
    imagepng($image, $filename);
    imagedestroy($image);
    $file = file_get_contents($filename);
    $imgsize = getimagesize($filename);
    unlink($filename);
    $captcha = 'data:' . $imgsize['mime'] . ';base64,' . base64_encode($file);
    $challenge = array('captcha' => '', 'code' => null, 'size' => 0, 'digits' => 0);
    if($incode == false) {
        $challenge = generateCaptcha($challenge_num, 0, $size, $chars, $code);
    }
    $hash = md5($challenge['code'] . $salt);
    $correct_index = array();
    for($i = 0; $i < strlen($challenge['code']); $i++) {
        $correct_index[] = strpos($code, substr($challenge['code'], $i, 1));
    }
    $result = array(
        'captcha' => $captcha,
        'challenge' => array($challenge['captcha'], $challenge['size'], $challenge['digits']),
        'size' => array($imgsize[0], $imgsize[1]),
        'hash' => $hash,
        'code' => $code,
        'message' => $message,
        'width' => $size,
        'digits' => $num_digits,
        'correct_index' => md5($hash . implode('', $correct_index) . $salt)
    );
    return $result;
}
?> 
```

**...这里是`captcha.html`：**

```
<!DOCTYPE HTML>
<!--
<?php
include 'captcha.php';
$captcha = generateCaptcha(4, 2, 100, '0123456789');
?>
-->
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <title>Click-captcha test</title>
    <style type="text/css">
#challenge, #captcha-img {
    margin: 10px
}
#captcha-img {
    overflow: hidden
}
.captcha-digit {
    display: block;
    float: left;
    width: <?php echo $captcha['width']; ?>px;
    height: 100%;
    cursor: pointer
}
.captcha-digit-selected {
    background: #ccc;
    opacity: .75;
    filter: progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#f2cccccc', EndColorStr='#f2cccccc')
}
    </style>
    <script type="text/javascript">
var captchaLinks = [];
var digits = [];
var num_digits = <?php echo $captcha['challenge'][2]; ?> - 1;
addEvent(window, 'load', init);
function init() {
    captchaLinks = ['<?php
$digits = array();
for($i = 'digit0'; $i < 'digit' . $captcha['digits']; $i++) {
    $digits[] = $i;
}
echo implode("', '", $digits);
?>'];
    for(var i = 0; i < captchaLinks.length; i++) {
    //for(var link in captchaLinks) {
        addEvent(document.getElementById(captchaLinks[i]), 'click', newCaptchaDigit);
    }
}
function newCaptchaDigit(e) {
        if(e.target.className == 'captcha-digit captcha-digit-selected') {
            digits.splice(digits.indexOf(e.target.id.substr(-1, 1)), 1);
            e.target.className = 'captcha-digit';
        } else if(digits.length <= num_digits) {
            digits.splice(num_digits, digits.length - num_digits, e.target.id.substr(-1, 1));
            e.target.className = 'captcha-digit captcha-digit-selected';
        }
        document.getElementById('code').value = digits.join('');
}
function addEvent(elem, event, handler) {
    if(elem !== null & typeof elem !== 'undefined') {
        if(elem.addEventListener) {
            elem.addEventListener(event, handler, false);
        } else if(elem.attachEvent) {
            elem.attachEvent('on' + event, handler);
        } else if(elem['on' + event]) {
            elem['on' + event] = handler;
        }
    }
}
    </script>
</head>
<body>
    <div>
        <form action="<?php echo $_SERVER['REQUEST_URI']; ?>" method="post">
            <div id="captcha">
                <div><?php echo $captcha['message']; ?></div>
                <div>Click the following number sequence:
                    <div id="challenge" style="width: <?php echo $captcha['challenge'][1][0]; ?>px; height: <?php echo $captcha['challenge'][1][1]; ?>px; background-image: url('<?php echo $captcha['challenge'][0]; ?>')"></div>
                </div>
                <div id="captcha-img" style="width: <?php echo $captcha['size'][0]; ?>px; height: <?php echo $captcha['size'][1]; ?>px; background-image: url('<?php echo $captcha['captcha']; ?>')">
<?php for($i = 'digit0'; $i < 'digit' . $captcha['digits']; $i++) { ?>
                    <a class="captcha-digit" id="<?php echo $i; ?>"></a>
<?php } ?>
                </div>
            </div>
            <input type="hidden" name="hash" value="<?php echo $captcha['hash']; ?>" />
            <input type="hidden" name="correct_index" value="<?php echo $captcha['correct_index']; ?>" />
            <input type="hidden" name="code" id="code" value="" />
            <input type="submit" value="Submit" />
        </form>
    </div>
</body>
</html> 
```

希望你能看到发生了什么，但我会在这里解释。:-)

该函数被调用`generateCaptcha`，它接受参数`$num_digits, $challenge_num, $size, $chars, $incode = false`。

* * *

*   `$num_digits`: 输入验证码的字符数
*   `$challenge_num`: 加入挑战的字符数
*   `$size`：验证码的大小
*   `$chars`：要包含哪些字符（例如数字`'0123456789'`：）
*   `$incode`：这只是为了让脚本可以判断它是否被自己调用来生成挑战。**不要设置它。**

因此，要创建一个包含 4 个字符、一个 1 个字符的挑战（如您的问题）、大小为 30 且仅包含数字的验证码图像，请使用以下代码：

```
<?php
include 'captcha.php';
$captcha = generateCaptcha(4, 1, 30, '0123456789');
?> 
```

然后变量`$captcha`最终会是这样的：

```
array(9) {
  ["captcha"]=>
  string(118058) "data:image/png;base64,iVBORw0KG...kSuQmCC"
  ["challenge"]=>
  array(3) {
    [0]=>
    string(76266) "data:image/png;base64,iVBORw0KG...kJggg=="
    [1]=>
    array(2) {
      [0]=>
      int(200)
      [1]=>
      int(200)
    }
    [2]=>
    int(2)
  }
  ["size"]=>
  array(2) {
    [0]=>
    int(400)
    [1]=>
    int(200)
  }
  ["hash"]=>
  string(32) "81bc501400b8da366e70b26007cb2323"
  ["code"]=>
  string(4) "4817"
  ["message"]=>
  string(0) ""
  ["width"]=>
  int(100)
  ["digits"]=>
  int(4)
  ["correct_index"]=>
  string(32) "17ae615be69c757505dc7f69fce2afb1"
} 
```

如果您需要更多信息，请在评论中提问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:50:41.037

如果没有完整的验证码，您将无法阻止一个坚定的机器人。

一些想法。

在 10 分钟内允许 10 - 15 个请求，如果超过，要求验证码或完全阻止。确保这是基于 IP 的，因为 cookie/会话不起作用

在表单中添加一些javascript，这样没有它就无法发布。大多数电子邮件收集垃圾邮件机器人不会运行 javascript 并放弃。生成一个随机字符串，存储在页面请求的 $_SESSION 中。使用 javascript 添加到表单帖子。如果该字符串不存在表单帖子上的匹配项，则显示验证码。

或者使用 javascript 来构造表单本身。

一个坚定的刮刀可以解决大多数问题，但您只是想增加这样做的成本。

# login - Symfony2：记录用户活动

> ID：11836938
> 
> 赞同：2
> 
> 时间：2012-08-06T22:35:16.490
> 
> 标签：login, symfony, logout

我是 Symfony 和 PHP 的新手（以前使用 C++、Java），我找不到任何关于如何将用户登录和注销操作记录到数据库的解决方案。我想要这些具体信息：

*   采取行动的用户（通过 userId），
*   操作描述（登录或注销），
*   当前时间戳。

我正在寻找最简单的解决方案。我通过修改渲染用户登录表单的功能成功地记录了用户登录信息，但是在注销时我失败了。我知道这毕竟是一个糟糕的主意，但我想不出更好的主意。有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:05:48.093

如果你看一下[这里](https://github.com/symfony/symfony/pull/3652)，它说你可以定义一个成功处理程序和一个失败处理程序，用于将内容记录到数据库中。您还可以找到[参考文档](http://symfony.com/doc/current/reference/configuration/security.html)中定义的处理程序参数。

**登录**

您将首先创建一个以 security.context 和 entityManager 作为参数的服务，并使用两者来确定哪个用户登录。然后将此服务添加到 success_handler 参数中，并在用户登录后调用。

**登出**

我猜这个更棘手，因为我假设 security.context 不再有关于用户的信息，你不能用它来确定哪个用户正在注销。您可能想查看`handlers`参数实际上是什么。它可能是在处理注销时调用的处理程序，因此您可以使用它。当然，您可能会记录一些失败的注销，因为没有成功处理程序，您无法确定注销是否成功。另一方面，也许您可​​以从某个地方（同样，security.context 可能）获取会话 ID，然后将其记录下来。

# java - 获取 org.hibernate.MappingException

> ID：11836944
> 
> 赞同：0
> 
> 时间：2012-08-06T22:35:52.527
> 
> 标签：java, hibernate, hql, hibernate-mapping

这是我在 Stackoverflow 上的第一个问题。我希望清楚。我在使用 Hibernate 映射时遇到了麻烦，我不知道错误在哪里。当我尝试运行 HQL 时

```
from Sensor 
```

我得到以下异常

```
org.hibernate.MappingException: Association references unmapped class: sipiaHibernate.TipoSensor
at org.hibernate.cfg.HbmBinder.bindCollectionSecondPass(HbmBinder.java:2380)
at org.hibernate.cfg.HbmBinder$CollectionSecondPass.secondPass(HbmBinder.java:2662)
at org.hibernate.cfg.CollectionSecondPass.doSecondPass(CollectionSecondPass.java:43)
at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1130)
at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:324)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1286)
at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:859) 
```

我正在使用 openjdk6、hibernet 3.2.5 和 MySQL 数据库开发 netbeans 7。我在包 sipiaHibernate 中有所有 POJO 的类。配置文件中提到的所有表都在我的数据库中。我使用 netbeans hibernet 实用程序生成了 POJO 类和映射文件。

休眠.cfg.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/gatewaysipia</property>
    <property name="hibernate.connection.username">root</property>
    <property name="hibernate.connection.password">xxxxxxxxx</property>
    <property name="hibernate.show_sql">true</property>
    <property name="hibernate.current_session_context_class">thread</property>
    <property name="hibernate.query.factory_class">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</property>
    <property name="hibernate.jdbc.batch_size">0</property>
    <mapping resource="sipiaHibernate/TipoSensor.hbm.xml"/>
    <mapping resource="sipiaHibernate/Mote.hbm.xml"/>
    <mapping resource="sipiaHibernate/LogDataInd.hbm.xml"/>
    <mapping resource="sipiaHibernate/ModeloSensor.hbm.xml"/>
    <mapping resource="sipiaHibernate/Usuario.hbm.xml"/>
    <mapping resource="sipiaHibernate/Proyecto.hbm.xml"/>
    <mapping resource="sipiaHibernate/DatosProyecto.hbm.xml"/>
    <mapping resource="sipiaHibernate/ServerVariables.hbm.xml"/>
    <mapping resource="sipiaHibernate/LogMoteStart.hbm.xml"/>
    <mapping resource="sipiaHibernate/Sensor.hbm.xml"/>
    <mapping resource="sipiaHibernate/SensorConstantes.hbm.xml"/>
  </session-factory>
</hibernate-configuration> 
```

休眠.reveng.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-reverse-engineering PUBLIC "-//Hibernate/Hibernate Reverse Engineering DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-reverse-engineering-3.0.dtd">
<hibernate-reverse-engineering>
  <schema-selection match-catalog="gatewaysipia"/>
  <table-filter match-name="modelo_sensor"/>
  <table-filter match-name="server_variables"/>
  <table-filter match-name="log_mote_start"/>
  <table-filter match-name="mote"/>
  <table-filter match-name="datos_proyecto"/>
  <table-filter match-name="proyecto_has_usuario"/>
  <table-filter match-name="tipo_sensor"/>
  <table-filter match-name="log_data_ind"/>
  <table-filter match-name="usuario"/>
  <table-filter match-name="sensor_constantes"/>
  <table-filter match-name="sensor"/>
  <table-filter match-name="proyecto"/>
</hibernate-reverse-engineering> 
```

映射xml文件是：

传感器.hbm.xml

```
<!-- language: lang-xml -->
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 06/08/2012 18:34:16 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="sipiaHibernate.Sensor" table="sensor" catalog="gatewaysipia">
        <id name="idsensor" type="java.lang.Long">
            <column name="idsensor" />
            <generator class="identity" />
        </id>
        <many-to-one name="modeloSensor" class="sipiaHibernate.ModeloSensor" fetch="select">
            <column name="modelo_sensor_idmodelo_sensor" not-null="true" />
        </many-to-one>
        <many-to-one name="mote" class="sipiaHibernate.Mote" fetch="select">
            <column name="mote_idMote" not-null="true" />
        </many-to-one>
        <many-to-one name="proyecto" class="sipiaHibernate.Proyecto" fetch="select">
            <column name="proyecto_idproyecto" />
        </many-to-one>
        <property name="dirSensor" type="short">
            <column name="dir_sensor" not-null="true">
                <comment>el nro de entrada analogica/digital a la cual el sensor esta conectado en el mote</comment>
            </column>
        </property>
        <property name="etiqueta" type="string">
            <column name="etiqueta" length="100" not-null="true">
                <comment>etiqueta/label dada por el usuario</comment>
            </column>
        </property>
        <property name="ubicacion" type="string">
            <column name="ubicacion" length="100" not-null="true">
                <comment>ubicacion texto libre dada por el usuario</comment>
            </column>
        </property>
        <property name="gpsLatitud" type="big_decimal">
            <column name="gps_latitud" precision="8" scale="6" />
        </property>
        <property name="gpsLongitud" type="big_decimal">
            <column name="gps_longitud" precision="8" scale="6" />
        </property>
        <property name="estadoSensor" type="string">
            <column name="estado_sensor" length="9" not-null="true" />
        </property>
        <set name="datosProyectos" inverse="true">
            <key>
                <column name="sensor_idsensor" not-null="true" />
            </key>
            <one-to-many class="sipiaHibernate.DatosProyecto" />
        </set>
    </class>
</hibernate-mapping> 
```

模型传感器.hbm.xml

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 06/08/2012 18:34:16 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="sipiaHibernate.ModeloSensor" table="modelo_sensor" catalog="gatewaysipia">
        <id name="idmodeloSensor" type="java.lang.Long">
            <column name="idmodelo_sensor" />
            <generator class="identity" />
        </id>
        <many-to-one name="tipoSensor" entity-name="sipiaHibernate.TipoSensor" class="sipiaHibernate.TipoSensor" fetch="select">
            <column name="tipo_sensor_idtipo_sensor" not-null="true" />
        </many-to-one>
        <property name="descripcionModelo" type="string">
            <column name="descripcion_modelo" length="100">
                <comment>Indica el modelo del sensor, por ej, PT100, etc</comment>
            </column>
        </property>
        <set name="tipoSensors"  inverse="true">
            <key>
                <column name="idtipo_sensor" not-null="true" unique="true" />
            </key>
            <one-to-many class="sipiaHibernate.TipoSensor" />
        </set>
        <set name="sensors" inverse="true">
            <key>
                <column name="modelo_sensor_idmodelo_sensor" not-null="true" />
            </key>
            <one-to-many entity-name="sipiaHibernate.Sensor" class="sipiaHibernate.Sensor" />
        </set>
    </class>
</hibernate-mapping> 
```

TipoSensor.hbm.xml

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 06/08/2012 18:34:16 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="sipiaHibernate.TipoSensor" table="tipo_sensor" catalog="gatewaysipia">
        <id name="idtipoSensor" type="java.lang.Long">
            <column name="idtipo_sensor" />
            <generator class="identity" />
        </id>
        <many-to-one name="modeloSensor" class="sipiaHibernate.ModeloSensor" update="false" insert="false" fetch="select">
            <column name="idtipo_sensor" not-null="true" unique="true" />
        </many-to-one>
        <property name="tipoDescripcion" type="string">
            <column name="tipo_descripcion" length="45" />
        </property>
        <property name="unidad" type="string">
            <column name="unidad" length="45" />
        </property>
        <property name="valorMinimo" type="java.lang.Float">
            <column name="valor_minimo" precision="12" scale="0" />
        </property>
        <property name="valorMaximo" type="java.lang.Float">
            <column name="valor_maximo" precision="12" scale="0" />
        </property>
        <set name="modeloSensors" inverse="true">
            <key>
                <column name="tipo_sensor_idtipo_sensor" not-null="true"/>
            </key>
            <one-to-many entity-name="sipiaHibernate.ModeloSensor" class="sipiaHibernate.ModeloSensor" />
        </set>
    </class>
</hibernate-mapping> 
```

传感器 POJO 类

```
package sipiaHibernate;
// Generated 06/08/2012 18:34:16 by Hibernate Tools 3.2.1.GA

import java.math.BigDecimal;
import java.util.HashSet;
import java.util.Set;

/**
 * Sensor generated by hbm2java
 */
public class Sensor  implements java.io.Serializable {

     private Long idsensor;
     private ModeloSensor modeloSensor;
     private Mote mote;
     private Proyecto proyecto;
     private short dirSensor;
     private String etiqueta;
     private String ubicacion;
     private BigDecimal gpsLatitud;
     private BigDecimal gpsLongitud;
     private String estadoSensor;
     private Set datosProyectos = new HashSet(0);

    public Sensor() {
    }

    public Sensor(ModeloSensor modeloSensor, Mote mote, short dirSensor, String etiqueta, String ubicacion, String estadoSensor) {
        this.modeloSensor = modeloSensor;
        this.mote = mote;
        this.dirSensor = dirSensor;
        this.etiqueta = etiqueta;
        this.ubicacion = ubicacion;
        this.estadoSensor = estadoSensor;
    }
    public Sensor(ModeloSensor modeloSensor, Mote mote, Proyecto proyecto, short dirSensor, String etiqueta, String ubicacion, BigDecimal gpsLatitud, BigDecimal gpsLongitud, String estadoSensor, Set datosProyectos) {
       this.modeloSensor = modeloSensor;
       this.mote = mote;
       this.proyecto = proyecto;
       this.dirSensor = dirSensor;
       this.etiqueta = etiqueta;
       this.ubicacion = ubicacion;
       this.gpsLatitud = gpsLatitud;
       this.gpsLongitud = gpsLongitud;
       this.estadoSensor = estadoSensor;
       this.datosProyectos = datosProyectos;
    }

    public Long getIdsensor() {
        return this.idsensor;
    }

    public void setIdsensor(Long idsensor) {
        this.idsensor = idsensor;
    }
    public ModeloSensor getModeloSensor() {
        return this.modeloSensor;
    }

    public void setModeloSensor(ModeloSensor modeloSensor) {
        this.modeloSensor = modeloSensor;
    }
    public Mote getMote() {
        return this.mote;
    }

    public void setMote(Mote mote) {
        this.mote = mote;
    }
    public Proyecto getProyecto() {
        return this.proyecto;
    }

    public void setProyecto(Proyecto proyecto) {
        this.proyecto = proyecto;
    }
    public short getDirSensor() {
        return this.dirSensor;
    }

    public void setDirSensor(short dirSensor) {
        this.dirSensor = dirSensor;
    }
    public String getEtiqueta() {
        return this.etiqueta;
    }

    public void setEtiqueta(String etiqueta) {
        this.etiqueta = etiqueta;
    }
    public String getUbicacion() {
        return this.ubicacion;
    }

    public void setUbicacion(String ubicacion) {
        this.ubicacion = ubicacion;
    }
    public BigDecimal getGpsLatitud() {
        return this.gpsLatitud;
    }

    public void setGpsLatitud(BigDecimal gpsLatitud) {
        this.gpsLatitud = gpsLatitud;
    }
    public BigDecimal getGpsLongitud() {
        return this.gpsLongitud;
    }

    public void setGpsLongitud(BigDecimal gpsLongitud) {
        this.gpsLongitud = gpsLongitud;
    }
    public String getEstadoSensor() {
        return this.estadoSensor;
    }

    public void setEstadoSensor(String estadoSensor) {
        this.estadoSensor = estadoSensor;
    }
    public Set getDatosProyectos() {
        return this.datosProyectos;
    }

    public void setDatosProyectos(Set datosProyectos) {
        this.datosProyectos = datosProyectos;
    }   

} 
```

TipoSensor POJO 类

```
package sipiaHibernate;
// Generated 23/08/2012 15:10:47 by Hibernate Tools 3.2.1.GA

import java.util.HashSet;
import java.util.Set;

/**
 * TipoSensor generated by hbm2java
 */
public class TipoSensor  implements java.io.Serializable {

     private Long idtipoSensor;
     private ModeloSensor modeloSensor;
     private String tipoDescripcion;
     private String unidad;
     private Float valorMinimo;
     private Float valorMaximo;
     private Set modeloSensors = new HashSet(0);

    public TipoSensor() {
    }

    public TipoSensor(ModeloSensor modeloSensor) {
        this.modeloSensor = modeloSensor;
    }
    public TipoSensor(ModeloSensor modeloSensor, String tipoDescripcion, String unidad, Float valorMinimo, Float valorMaximo, Set modeloSensors) {
       this.modeloSensor = modeloSensor;
       this.tipoDescripcion = tipoDescripcion;
       this.unidad = unidad;
       this.valorMinimo = valorMinimo;
       this.valorMaximo = valorMaximo;
       this.modeloSensors = modeloSensors;
    }

    public Long getIdtipoSensor() {
        return this.idtipoSensor;
    }

    public void setIdtipoSensor(Long idtipoSensor) {
        this.idtipoSensor = idtipoSensor;
    }
    public ModeloSensor getModeloSensor() {
        return this.modeloSensor;
    }

    public void setModeloSensor(ModeloSensor modeloSensor) {
        this.modeloSensor = modeloSensor;
    }
    public String getTipoDescripcion() {
        return this.tipoDescripcion;
    }

    public void setTipoDescripcion(String tipoDescripcion) {
        this.tipoDescripcion = tipoDescripcion;
    }
    public String getUnidad() {
        return this.unidad;
    }

    public void setUnidad(String unidad) {
        this.unidad = unidad;
    }
    public Float getValorMinimo() {
        return this.valorMinimo;
    }

    public void setValorMinimo(Float valorMinimo) {
        this.valorMinimo = valorMinimo;
    }
    public Float getValorMaximo() {
        return this.valorMaximo;
    }

    public void setValorMaximo(Float valorMaximo) {
        this.valorMaximo = valorMaximo;
    }
    public Set getModeloSensors() {
        return this.modeloSensors;
    }

    public void setModeloSensors(Set modeloSensors) {
        this.modeloSensors = modeloSensors;
    }

} 
```

我会感谢你的帮助。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T05:58:32.047

是否存在您的 TipoSensor 类？映射休眠未找到您的类

# mysql - 选择显示优先级最高的组

> ID：11836945
> 
> 赞同：0
> 
> 时间：2012-08-06T22:36:06.367
> 
> 标签：mysql

我在选择具有最高显示优先级的组时遇到问题。查询是：

```
SELECT
    xf_user_group_relation.user_id, xf_user_field_value.field_value as custom_flags,
    xf_user_external_auth.provider_key,
    xf_user_group_relation.user_group_id,
    MAX( xf_user_group.display_style_priority ) AS display_style_priority,
    xf_user_group_relation.user_group_id IN(5,6,11,12) AS is_vip
FROM xf_user_group_relation
INNER JOIN xf_user_group
    ON xf_user_group_relation.user_group_id = xf_user_group.user_group_id
INNER JOIN xf_user_external_auth
    ON xf_user_group_relation.user_id = xf_user_external_auth.user_id
LEFT JOIN xf_user_field_value
    ON xf_user_group_relation.user_id = xf_user_field_value.user_id
    AND xf_user_field_value.field_id = 'gtarp_custom_flags'
WHERE
    xf_user_external_auth.provider = 'steam'
    AND xf_user_group.display_style_priority >= 1000
    AND xf_user_group_relation.user_group_id NOT IN(19,20)
GROUP BY
    xf_user_group_relation.user_id,
    xf_user_external_auth.provider_key 
```

似乎它选择了具有最低 id 的组，这不是我想要的。我希望它选择具有最高显示优先级的组。

所以 user_group_id 应该是显示优先级最高的组，即`MAX( xf_user_group.display_style_priority)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:59:20.680

尝试这个：

```
SELECT
    xf_user_group_relation.user_id, xf_user_field_value.field_value as custom_flags,
    xf_user_external_auth.provider_key,
    xf_user_group_relation.user_group_id,
    MAX( xf_user_group.display_style_priority ) AS display_style_priority,
    xf_user_group_relation.user_group_id IN(5,6,11,12) AS is_vip
FROM xf_user_group_relation
INNER JOIN xf_user_group
    ON xf_user_group_relation.user_group_id = xf_user_group.user_group_id
INNER JOIN xf_user_external_auth
    ON xf_user_group_relation.user_id = xf_user_external_auth.user_id
LEFT JOIN xf_user_field_value
    ON xf_user_group_relation.user_id = xf_user_field_value.user_id
    AND xf_user_field_value.field_id = 'gtarp_custom_flags'
WHERE
    xf_user_external_auth.provider = 'steam'
    AND xf_user_group.display_style_priority >= 1000
    AND xf_user_group_relation.user_group_id NOT IN(19,20)
GROUP BY
    xf_user_group.display_style_priority,
    xf_user_group_relation.user_id,
    xf_user_external_auth.provider_key 
```

# php - 为什么登录时mysql查询不匹配？

> ID：11836946
> 
> 赞同：0
> 
> 时间：2012-08-06T22:36:34.047
> 
> 标签：php, mysql, login, hash

我无法弄清楚为什么在激活后尝试登录时密码不匹配。为了便于查看，我已经修剪了下面粘贴的代码。

以下是相关的注册码：

```
$salt = substr(sha1(uniqid(rand(),true)),0,20);
$password_db = hash('sha256', $salt.$password1);

$sqlinfo = mysql_query("INSERT INTO db_1 (email, password, salt)
VALUES('$email1','$password_db','$salt')") or die(mysql_error()); 
```

这是登录的相关代码：

```
$email = $_POST['email'];
$password = $_POST['password'];

$sqlinfo = mysql_query("SELECT * FROM db_1 WHERE email='$email' AND emailactiv='1'"); 

if($sqlinfo['password'] == hash('sha256', $sqlinfo['salt'].$password)){
    while($row = mysql_fetch_array($sqlinfo)){
    ... }
    else { ... 
```

到目前为止，我已经进行了几次迭代，但无济于事。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:00:45.040

目前，您的代码容易受到 SQL 注入的影响。一个建议是使用**[PDO](http://php.net/manual/en/book.pdo.php)**或**[MySQLI](http://php.net/manual/en/book.mysqli.php)**重新格式化您的代码。

PDO 示例：

```
<?php

$stmt = $dbh->prepare("SELECT * FROM db_1 WHERE email = ? AND emailactiv=? ");
$stmt->bindParam(1, $email);
$stmt->bindParam(2, 1);

$stmt->execute();

?> 
```

您没有获取该行，这就是它不匹配任何内容的原因。`IF`在语句之前添加这一行：

```
$rowHere = mysql_fetch_row($sqlinfo); 
```

并`$rowHere`在您的`IF`声明中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:49:04.953

```
$email = $_POST['email'];
$password = $_POST['password'];

$sqlinfo = mysql_query("SELECT * FROM db_1 WHERE email='$email' AND emailactiv='1'"); 

//You need to first fetch data before using it.
while($result = mysql_fetch_array($sqlinfo)) {

    //Now you can use the data
    if($result['password'] == hash('sha256', $result['salt'].$password)){
         //matched... login correct
    } else {
         //not matched.. invalid login
    }
}
... 
```

希望它是不言自明的。你错过了一条非常重要的线！

顺便说一句，停止使用 mysql_* 函数，因为它们已被弃用，使用 PDO 或 mysqli_*

编辑：请立即尝试。我认为它只能保存一个值（用于登录目的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T23:14:48.750

你需要使用[`mysqli_fetch_array`](http://php.net/manual/en/function.mysql-fetch-array.php).

此外，`mysql_*`函数已被弃用。请改用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)。

而且您需要“清理您的输入”（一个常用短语）以避免 SQL 注入、使用[`mysqli_real_escape_string`](http://php.net/manual/en/mysqli.real-escape-string.php)或[PDO](http://php.net/manual/en/book.pdo.php)。

根据对问题的评论，请参阅[Bobby Tables链接。](http://bobby-tables.com)

# javascript - 如何改变图像的大小？

> ID：11836950
> 
> 赞同：1
> 
> 时间：2012-08-06T22:36:48.283
> 
> 标签：javascript, jquery

当用户将鼠标悬停在图像上时，我正在尝试放大图片并在用户鼠标移出图像后减小图像的大小。

我有以下代码

```
$('#image_layout').on('hover','img',function(){
    $(this).css('width','110%');
})

$('#image_layout').on('mouseout','img',function(){
    $(this).css('width','90%');
}) 
```

我想从图像的中心位置放大图像，而不是从图像的左上角位置放大图像。

我有一个：

```
 ----        ------
|    |  ->  |      |
 ----       |      |
             ------ 
```

我想要的：（从图像中心放大图片）

```
 ------
   ----       |      | 
  |    |  --> |      |
   ----       |      |
               ------ 
```

我不确定如何实现这一目标。有小费吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:49:26.233

避免将 JavaScript 用于可以通过简单的 CSS 调整来处理的任务，不要让 JavaScript 在页面上的重量过重。

```
#image_layout 
{
   width : /* initial width value */ 
   height: /* initial height value */
}

#image_layout : hover
{
   width : /* new width value */ 
   height: /* new height value */
   /* use of multiple tranistions */
   transition : all 0.2s ease-out 
} 
```

关于 jQuery 方式，无需应用 .css() 两次，只需将包含属性及其值的对象传递给它：

```
$('#image_layout').on('mouseout','img',function(){
    $(this).css({'width':'90%', 'height':'100%'});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:45:13.493

你想要达到的目标并不像看起来那么容易。如果要将原点保持在容器的中心，则需要将图像相对于容器进行绝对定位。试试这个 lil' 插件，它可能不适用于所有情况，但值得一试。

```
$.fn.centerIt = function(){

    var height = this.outerHeight(),
        width = this.outerWidth();

    this.css({
        position: 'absolute',
        top: '50%',
        left: '50%',
        marginTop: -(height/2),
        marginLeft: -(width/2)
    })
    .parent()
    .css('position', 'relative');

    return this;    
};

$('img').css('width', '90%').centerIt(); 
```

**演示：http:** [//jsfiddle.net/elclanrs/RMsSh/](http://jsfiddle.net/elclanrs/RMsSh/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T22:40:32.717

当你改变了`width`并且你还没有定义 时`height`，浏览器会自动保持它们之间的比例，所以`height`也将是`110%`和`90%`。

试试这个代码：

```
$('#image_layout').on('hover','img',function(){
    $(this).css('width','110%')
        .css('height','100%')
});
$('#image_layout').on('mouseout','img',function(){
    $(this).css('width','90%')
        .css('height','100%');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:44:18.977

您需要使图像水平和垂直居中才能做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T22:39:16.480

在 JQuery 中更改图像大小非常容易。您可以使用 .CSS() 采用这种方法或 CSS 方法

```
$('#imageId').width(150).height(100); 
```

# c++ - 有没有办法显式分离隐式链接的 DLL？

> ID：11836953
> 
> 赞同：1
> 
> 时间：2012-08-06T22:37:35.087
> 
> 标签：c++, unit-testing, dll

这不适用于生产代码，这是用于单元测试。

我们有一个旧版 DLL，它在 DLL_PROCESS_DETACH 事件上释放资源。我们在可执行文件的静态销毁阶段遇到了崩溃场景，因为静态变量的析构函数试图访问 DLL 未映射的资源（悬空引用）。

我想在单元测试中重现这个崩溃场景，这样我就可以证明我已经修复了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:57:33.740

您可以使用 获取模块的句柄[`GetModuleHandle(LPCTSTR lpModuleName)`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683199.aspx)，并将其传递给[`FreeLibrary()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683152.aspx).

状态的文档`GetModuleHandle()`：

> 该`GetModuleHandle`函数返回一个映射模块的句柄而不增加其引用计数。但是，如果将此句柄传递给`FreeLibrary`函数，则映射模块的引用计数将递减。因此，不要将返回的句柄传递`GetModuleHandle`给`FreeLibrary`函数。这样做会导致 DLL 模块过早地被取消映射。

尽管警告*不*要这样做，但这听起来正是您想要做的。这应该很容易在您的场景中进行测试，以验证它是否符合您的要求。

# python - 将 for 循环集成到 if 语句中

> ID：11836964
> 
> 赞同：2
> 
> 时间：2012-08-06T22:38:54.200
> 
> 标签：python, for-loop

这是一个双管齐下的问题，但它让我感到困惑。我目前有以下代码：

```
from __future__ import division
import math

function = int(raw_input("Type function no.: "))

if function == 1:
    a = float(raw_input ("Enter average speed: "))
    b = float(raw_input ("Enter length of path: "))
    answer= float(b)/a
    print "Answer=", float(answer),

elif function == 2:
    mass_kg = int(input("What is your mass in kilograms?" ))
    mass_stone = mass_kg * 2.2 / 14
    print "You weigh", mass_stone, "stone."

else: print "Please enter a function number." 
```

现在，我想要某种循环（我猜它是一个 for 循环，但我不完全确定），以便在一个函数完成后，它会返回到顶部，所以用户可以输入一个新的函数号并做一个不同的方程。我该怎么做？过去半个小时我一直在想办法，但什么都没有出现。

尝试忽略代码中的任何混乱......它需要一些清理。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T22:43:57.200

最好使用`while`-loop 来控制重复，而不是`for`-loop。这样用户就不会被限制在固定的重复次数上，*他们可以随心所欲地继续*。为了退出，用户输入一个 <= 0 的值。

```
from __future__ import division
import math

function = int(raw_input("Type function no.: "))

while function > 0:
    if function == 1:
        a = float(raw_input ("Enter average speed: "))
        b = float(raw_input ("Enter length of path: "))
        answer = b/a
        print "Answer=", float(answer),
    elif function == 2:
        mass_kg = int(input("What is your mass in kilograms?" ))
        mass_stone = mass_kg * 2.2 / 14
        print "You weigh", mass_stone, "stone."

    print 'Enter a value <= 0 for function number to quit.'
    function = int(raw_input("Type function no.: ")) 
```

您可以根据需要调整它（例如，终止条件）。例如，您可以指定 0 是唯一的终止值等。

***另一种方法***是“永远”运行的循环，如果提供了特定的函数号（在本例中`0`）则中断。这是这种方法的框架/草图：

```
 function = int(raw_input("Type function no.: "))

    while True:
       if function == 1:
          ...
       elif function == 2:
          ...
       elif function == 0:
          break      # terminate the loop.

      print 'Enter 0 for function number to quit.'
      function = int(raw_input("Type function no.: ")) 
```

*注意*：如果您要**迭代已知/固定次数**，例如在序列（如列表）上，或者如果您想以某种方式限制重复，`for`则 -loop 是最合适的。为了给您的用户更多的灵活性，-loop 是一种更好的方法。**`while`**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:42:15.263

您只需将整个脚本包装在一个循环中，例如：

```
from __future__ import division
import math

for _ in range(10):

    function = int(raw_input("Type function no.: "))

    if function == 1:
        a = float(raw_input ("Enter average speed: "))
        b = float(raw_input ("Enter length of path: "))
        answer= float(b)/a
        print "Answer=", float(answer),

    elif function == 2:
        mass_kg = int(input("What is your mass in kilograms?" ))
        mass_stone = mass_kg * 2.2 / 14
        print "You weigh", mass_stone, "stone."

    else: print "Please enter a function number." 
```

这将连续运行您的 if 语句 10 次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T22:42:39.923

我会试试这个：

```
while True:
    function = ...
    if function == 0:
        break
    elif ... 
```**

# r - OpenCPU 管理员 opencpu.demo

> ID：11836966
> 
> 赞同：1
> 
> 时间：2012-08-06T22:39:00.777
> 
> 标签：r, opencpu

我在运行时收到错误消息

我的 OpenCPU 服务器上的管理应用程序错误消息：未找到

```
The requested URL /Radmin/call/opencpu.demo/install.opencpu/json was not found on this server. 
```

我有 opencpu repo 的 R 文件夹和安装的包但我不知道 install.opencpu 函数文件在哪里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T09:44:36.823

我不确定您在哪里找到了该`/Radmin/`网址，但该功能从未进入 opencpu。尝试使用手册页中的内容：www.opencpu.org。

# c# - 设置依赖属性时发生灾难性错误

> ID：11836970
> 
> 赞同：0
> 
> 时间：2012-08-06T22:39:11.127
> 
> 标签：c#, xaml, windows-8

将依赖属性设置为 XAML 元素时遇到问题。XAML：

```
 <local2:RichTextColumns xmlns:local2="using:App2.Common">
            <local2:RichTextColumns.ColumnTemplate>
                <DataTemplate x:Name="overflowControl1">
                    <RichTextBlockOverflow Width="1000" Margin="5,0,0,0"/>
                </DataTemplate>
            </local2:RichTextColumns.ColumnTemplate>
            <RichTextBlock Foreground="Black" Width="1000">
                <Paragraph>
                </Paragraph>
            </RichTextBlock>
        </local2:RichTextColumns> 
```

C＃

```
var tmp = (DataTemplate)FindName("overflowControl1");
tmp.SetValue(RichTextBlockOverflow.ActualWidthProperty, 100); 
```

结果是

> 灾难性故障（HRESULT 异常：0x8000FFFF (E_UNEXPECTED)）。

我也尝试过使用`RichTextBlockOverflow.WidthProperty`

先感谢您 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:53:21.947

尝试

```
<local2:RichTextColumns xmlns:local2="using:App2.Common">
        <local2:RichTextColumns.ColumnTemplate>
            <DataTemplate>
                <RichTextBlockOverflow  x:Name="overflowControl1" Width="1000" Margin="5,0,0,0"/>
            </DataTemplate>
        </local2:RichTextColumns.ColumnTemplate>
        <RichTextBlock Foreground="Black" Width="1000">
            <Paragraph>
            </Paragraph>
        </RichTextBlock>
    </local2:RichTextColumns> 
```

C＃

```
var tmp = (RichTextBlockOverflow)FindName("overflowControl1");
tmp.SetValue(RichTextBlockOverflow.WidthProperty, 100); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:24:24.810

好的 找到了很好的解决方案。我使用绑定为 RichTextBlock 和 RichTextBlockOverflow 设置相同的宽度。

# asp.net-mvc - 在 ASP.NET MVC 应用程序中保留匿名用户的状态信息

> ID：11836976
> 
> 赞同：1
> 
> 时间：2012-08-06T22:39:42.580
> 
> 标签：asp.net-mvc, security, cookies, state-management

我想为网站的所有匿名访问者无缝地保持状态。例如，仅在第一次访问时显示提示，并最初通过客户端上的 cookie 分析 java 脚本阻止“投票”按钮出现（原因与服务器端的二级基于 ip 的过滤有关）。

如何在客户端浏览器中管理这些 cookie。理想情况下，我想将它们用作可以在服务器和客户端上读写的字典。如果这都是基本的东西，请展示我如何将“hasVoted”布尔值分配给用户的 cookie 并在客户端和服务器上读取它。

如果我的想法有什么根本错误，请告诉我=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:00:12.693

在他们投票后（我假设发生在 POST 中），您需要设置 cookie：

```
[HttpPost]
public ActionResult Vote()
{
    HttpCookie hasVoted = new HttpCookie("hasVoted", true);
    Request.Cookies.Add(hasVoted);

    return RedirectToAction("Index");
} 
```

得到它是这样的：

```
[HttpGet]
public ActionResult Index()
{
    bool hasVoted = Request.Cookies["hasVoted"].Value;        

    return View();
} 
```

如果我这样做，我会采用 hasVoted 布尔值，将其放入 ViewModel 中，并根据 .aspx 页面中的该值设置按钮的可见性。如果你真的想要，你可以使用 javascript 读写 cookie：

```
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
} 
```

看看这个[http://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

# css - 位置：相对 div 在 Firefox/IE 中不起作用

> ID：11836977
> 
> 赞同：0
> 
> 时间：2012-08-06T22:39:48.993
> 
> 标签：css, internet-explorer, html

基本上我有一个嵌套在 2 个 div 中的 div 中的图片。我想在图片的角落贴上一条胶带。

所以我为那张磁带图像制作了一个 div 并将它放在文档的底部，给它相对的位置并给它这些属性。

```
#tape
{
    width: 100px;
    height: 65px;
    position:relative;
    left: 25px;
    top: -662px;
} 
```

这是图片的属性：

```
#character-spotlight 

    {
        margin-left:50px;
        width:250px;
        height:250px;
        float:left;
        z-index:1;
    } 
```

这些 Div 中的 Bot 嵌套在

```
#content 
{
    width:800px;
    height:1360px;
    background-image:url(Cork.Board.png);
    background-size:100%;
    float:left;
    display:block;
} 
```

它本身嵌套在

```
#container 
{
    width: 1024px;
    height:1600px;
    margin-left:auto;
    margin-right:auto;
    margin-top: 50px;
    display:block;
} 
```

这是网页

[www.workaholicsfans.com/characters-files/Adam-Demamp.html](http://www.workaholicsfans.com/characters-files/Adam-Demamp.html)

它在 Chrome 中运行良好，但在 IE 和 Firefox 中运行良好。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:54:01.237

（您的帖子中没有链接）我几乎无法相信您描述并提供的 css 情况可以工作。我猜你让它在 Chrome 中工作的事实只是纯粹的运气，你可能一直在玩数字以使其适合。

解决方案实际上相当简单。

```
<div class='picture-wrapper'>
 <img class='picture' src='picture.../>
 <img class='tape' src='tape... />
</div> 
```

然后在css中

```
.picture-wrapper {
 position: relative;  /* this now acts as the reference for  position absolute of the children */
}
.tape {
 display: block;
 position: absolute;  /* position according to its parent */
 top: 0;  /* top position */
 left: 0; /* left position */
 z-index: 5; /* bring to front */
} 
```

这应该够了吧。

**编辑：** 我刚刚看到你添加了链接。如果您希望胶带溢出图片边缘，简单的方法是在包装上添加一些 padding-top 和 padding-left。像这样的东西：

```
padding: 8px 0 0 8px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:59:05.360

或者，如果您希望它根据页面容器进行绝对定位：

```
#tape {
    height: 65px;
    left: 325px;
    position: absolute;
    top: 300px;
    width: 100px;
} 
```

（但我必须承认，我更喜欢 PeterVR 的代码，因为这可以保持相关性，如果您将“新”内容放在#tape div 上方，这会派上用场）。

# heroku - 从共享数据库迁移到 Heroku Postgres /

> ID：11836981
> 
> 赞同：3
> 
> 时间：2012-08-06T22:40:15.450
> 
> 标签：heroku

在 MAC OS X 1.7.2 上

我尝试按照说明[https://devcenter.heroku.com/articles/migrating-from-shared-database-to-heroku-postgres](https://devcenter.heroku.com/articles/migrating-from-shared-database-to-heroku-postgres)

所以我尝试在 my-app 上运行命令：

```
$ heroku addons:add heroku-postgresql:dev -a my-app
-----> Adding heroku-postgresql:dev to test-biowatts... failed
 !     You're running an outdated version of the Heroku gem/toolbelt that cannot perform the requested action. Please update your client and try again. 
```

所以我尝试更新 Heroku

```
$ heroku update
 !   update is not a heroku command. See 'heroku help'. 
```

在哪里

```
$ heroku version
heroku-gem/2.4.0 
```

问题更新 1 - Heroku 更新现在给出不同的信息

```
$ heroku update
 !    `heroku update` is only available from Heroku Toolbelt.
 !    Download and install from https://toolbelt.heroku.com 
```

所以我下载并安装了工具带，但 heroku 更新仍然给出相同的消息

问题更新 2 - 删除了安装的 heroku TOOLBELT - 已解决

```
sudo rm -rf /usr/local/heroku 
sudo rm -rf /usr/bin/heroku
gem uninstall heroku 
```

然后安装[https://toolbelt.heroku.com/](https://toolbelt.heroku.com/)

重启终端

它奏效了！

干杯，

乔尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:43:11.237

您是否尝试过 gem update heroku？

如果您使用的是 Mac OSX 山狮。也许你应该更好地使用heroku toolbelt。我遇到了几乎相同的问题，并且在我安装 Heroku 工具带后解决了。

# wpf - 具有可编辑集合的 MVVM 示例，其中 View 不直接使用模型类型

> ID：11836986
> 
> 赞同：8
> 
> 时间：2012-08-06T22:40:37.477
> 
> 标签：wpf, mvvm

我读过很多人说模型类型不应该暴露给 View，而是应该包装在 ViewModel 类型中。有没有一些例子，我可以看到 ViewModel 和 Model 数据之间的同步是如何使用实体框架完成的。特别是，我需要一个可编辑集合的示例（例如：显示客户列表的 DataGrid 或 DataForm）。

所以，像这样

[http://msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

但具有可编辑的集合数据，而不仅仅是只读的。

我感兴趣的一个例子：

1）网格需要显示产品。显示 3 列：

*   产品代码
*   产品名称
*   产品类别
*   产品单元

Type 是一个枚举，可以说：ProductType { TypeA, TypeB }。如果您发现难以实现枚举，那么将其设置为 int，这不是问题。重要的是，如果 Product 已在其他表中用作参考，则无法更改类型。我正在使用此规则，因为您不能使用属性（数据注释）执行此操作，并且需要在 ViewModel 端完成。

产品类的每个属性都必须绑定到 CustomerViewModel 属性。您可以为代码和名称设置一些规则：

代码唯一名称：必填，MaxLength(30)

**编辑：**我主要关心的是我们如何在批量更新中在 ViewModel 和 EF 模型之间进行同步。一个例子是：

1) 当移除 Product 时，如果我们从 ProductViewModel 集合和 DBContext 中移除它，当用户决定取消时会发生什么（犯了一个错误或任何事情）？我们是否需要从数据库中重新加载所有 Product 并重新创建所有 ProductViewModel？

2）用户更改产品并将产品置于无效状态（请记住，对象仍然可以接受无效状态，除非我们决定将其刷新到数据库）。然后用户将光标移动到另一个产品，更改它（该产品保持有效状态），并执行保存命令。到时候我们应该怎么做？

我对所有这些问题都有自己的解决方案，但我不确定它们是否正确，是否有更好的方法，所以我向在日常工作中使用这种方法的人征求其他意见的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T07:48:54.520

如果您需要批量更新能力，那么应用程序需要一些更新：

1) 不要从 ProductViewModel 调用 SaveChanges。更改应仅在按下“保存”按钮时保存

2) 在 MainViewModel 中，您需要维护两个额外的集合：用于新项目和已删除项目。当用户按下“保存”按钮时，删除的项目将从数据库中删除，新项目将添加到数据库中。

3）当用户按下“取消”按钮时，所有更改都应还原。即所有字段都应该恢复到原来的状态，删除的项目应该被添加回来，新的项目应该被删除

请参阅 github 上的更新：[https ://github.com/alexshakurin/EditableDataGridMVVM](https://github.com/alexshakurin/EditableDataGridMVVM)

# html - 是否有任何替代方法可以在表单中实现多个 html“提交”按钮？

> ID：11836990
> 
> 赞同：1
> 
> 时间：2012-08-06T22:41:17.920
> 
> 标签：html, forms, google-app-engine, jinja2

我正在编写这个应用程序以更轻松地编写合同：

[http://contractpy.appspot.com/](http://contractpy.appspot.com/)

但是，我不想使用提交按钮插入第一和第二缔约方数据，而是使用一个按钮插入第一缔约方数据，另一个按钮插入第二缔约方数据。我想要这个，因为有时有两个或更多人作为第一缔约方（或第二缔约方），并且用户只有在将所有缔约方都插入该合同后才应按下“提交”按钮。最好的（或唯一的）方法是使用多个提交按钮？有什么选择吗？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:46:52.563

我会将表单拆分为多个表单，这样提交按钮到特定表单之间就不会混淆。

PS 由于工作访问受限，我无法查看您的应用程序。

# jquery - 更新面板后不执行可滚动功能

> ID：11836993
> 
> 赞同：0
> 
> 时间：2012-08-06T22:41:34.920
> 
> 标签：jquery, visual-studio-2008, updatepanel

QI 有一个 jQuery 函数，它使我的数据网格搜索结果可滚动。
但是，如果我更新面板，滚动条就会消失，结果只会填满整个页面。是因为它没有再次调用该函数吗？这是我当前的代码。

jQuery

```
<script type="text/javascript">

        $(document).ready(function scroll() {
            $('#<%=gvMapping.ClientID%>').Scrollable({ ScrollHeight: 370 });
        }
        )
</script>
<script type="text/javascript">
    function getGL(){
    var button = document.getElementById("<%= btnGetGLDept.ClientID %>");
    button.click();
}
</script> 
```

HTML

```
 <%--Mapping Search Bar --%>
    <div class="searchrev1">
    <asp:TextBox ID="mpSearch" class="txtbox" runat="server" text="Please start entering Department Name or Number to search"
        onfocus="if(this.value==this.defaultValue) {this.value='';$(this).css('color','#3B3B3B');}"  
        onblur="if(this.value=='') {this.value=this.defaultValue;$(this).css('color','rgb(173,180,195)');}" Width="400px"/>
    <asp:Button  ID="mapsearch" text="Search" runat="server" 
        onclick="getGLDepts" />
    <asp:CheckBoxList ID="mpcbl" class="cbl" runat="server" DataSourceID="Rollup" 
            DataTextField="COA_SYSTEM" DataValueField="COA_SYSTEM" ondatabound="chkFormat" OnClick="javascript:scroll;getGL();"></asp:CheckBoxList>
        <asp:SqlDataSource ID="Rollup" runat="server" 
            ConnectionString="<%$ ConnectionStrings:Rollup2ConnectionString %>" 
            SelectCommand="SELECT DISTINCT [COA_SYSTEM] FROM [T_ROLLUP_GL_EXCEPT]">
        </asp:SqlDataSource>
    </div>
    <%--Mapping Graph --%>
    <div class="botcontent">
    <asp:Label ID="lblGLDeptData" runat="server"></asp:Label>
    </div>
    <asp:UpdatePanel runat="server">
        <ContentTemplate>
            <div class="topcontent">
                <asp:GridView ID="gvMapping" runat="server" GridLines="none" AutoGenerateColumns="false">
                <HeaderStyle CssClass="GVFixedHeader" />
                <Columns>...</Columns>
                </asp:GridView>
                <asp:Button ID="btnGetGLDept" runat="server" OnClick="getGLDepts" CssClass="invisible" />
            </div>
        </ContentTemplate>
    </asp:UpdatePanel> 
```

单击时，我让 Checkboxlist 调用函数 getGL() 。然后调用 jquery 函数，该函数调用按钮单击来调用 c# 代码。这是不发生可滚动的时候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:51:18.617

需要添加此 javascript，以便在调用更新面板时

```
var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm.add_endRequest(EndRequest);

    function EndRequest(sender, args) {
       $('#<%=gvMapping.ClientID%>').Scrollable({ ScrollHeight: 370 });
    } 
```

或者用这个替换你的document.ready

```
Sys.Application.add_load(initSomething);
function initSomething()
{
    $('#<%=gvMapping.ClientID%>').Scrollable({ ScrollHeight: 370 });
  // will execute on load plus on every UpdatePanel postback
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T16:05:00.930

您的 jQuery document.Ready 函数只会被调用一次，因为您的网格包含在 updatePanel 中。UpdatePanels 导致部分回发，这将触发 pageLoad 事件

尝试将您的代码替换为

```
$(document).ready(function scroll() {
  $('#<%=gvMapping.ClientID%>').Scrollable({ ScrollHeight: 370 });
}); 
```

和

```
function pageLoad() {
  $('#<%=gvMapping.ClientID%>').Scrollable({ ScrollHeight: 370 });
} 
```

# ajax - PHP yii 如何使用 chtml 类调用 ajax 渲染部分？

> ID：11836995
> 
> 赞同：0
> 
> 时间：2012-08-06T22:41:39.737
> 
> 标签：ajax, widget, yii, partial-views, render

我有一个调用特定 ajax 操作的链接，作为回报，它在屏幕上呈现部分视图，该部分视图始终在 div 内更新。使用它通常可以工作，但是当我使用 CHTML 类来使用如下静态函数时

```
 <?php echo CHTML::linkButton("Like",array("href"=>"http://www.aa.com","id"=>"link-button-shrinked"))?> 
```

然后ajax调用不起作用并给出奇怪的错误

```
 <h1>PHP Error [2]</h1>
      <p>YiiBase::include(CHTML.php) [<a href='yiibase.include'>yiibase.include</a>]: failed to open stream: No such file or directory (C:\AppServ\www\abc.com\framework\YiiBase.php:418)</p> 
```

我的渲染视图功能是这样的

```
$this->renderPartial('_character_actions',array("actionRecords"=>$actionRecords),false,true); 
```

如果我删除 CHTML 函数调用，那么一切正常......请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:24:28.453

你把类名弄错了。

只需更改`CHTML`为`CHtml`，您应该会很好。

# silverlight - Silverlight 中的混合按钮/组合框 UI 控件

> ID：11836996
> 
> 赞同：0
> 
> 时间：2012-08-06T22:41:45.073
> 
> 标签：silverlight, button, user-interface, combobox

有一种混合 UI 模式，即部分按钮、部分下拉列表。如果用户点击显示的动作，那么该动作将按照普通按钮被调用；如果他们单击箭头部分，则用户可以从其他可用操作中进行选择，就像使用组合框一样。

两个问题：

*   这种混合按钮/列表 UI 模式有名称吗？
*   Silverlight 中是否有本机或第三方实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T06:12:39.730

Telerik 称之为[拆分按钮](http://demos.telerik.com/silverlight/#Buttons/SplitButton)

# node.js - exec 回调中的范围

> ID：11836997
> 
> 赞同：0
> 
> 时间：2012-08-06T22:41:45.543
> 
> 标签：node.js, express, mongoose

我试图打破基于表达式的函数，但是在范围界定方面遇到了麻烦。这是代码片段：

```
function createService(dict, res) {
    // Ensure no duplicate
    var serviceExists = Service.find({name: dict['name']}).count().exec(function(err, doc) {
        return (doc !== 0);
    });

    console.log(serviceExists);

    if(serviceExists){
        res.send(500, "Duplicate document. Try updating existing entry or chooseing a different name");
        return;
    }

    //Insert the document
    service = new Service(dict);
    service.save(function(err) {
        if(!err) {
            res.send("Service saved");
        }
    });
} 
```

console.log() 的输出：

```
{ emitted: {},
  _events: { err: [Function], complete: [Function] } } 
```

这里的最终目标是，如果 doc ！== 0，代码将不会到达“插入文档”部分。请让我知道这样做的正确方法（也许使用异常？这是我剩下的唯一想法）。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T22:54:21.393

`Service.find`是异步的。回调`exec`不会立即执行。这会导致问题 1。（如果`Service....exec(...)`返回一个值，您`console.log`将在回调之前已经执行。）

问题 2 也很常见。`return`in`exec()`不返回可以分配给变量的值。（`exec()`不返回匿名函数的返回值。）

这是您的代码的修复：

```
function createService(dict, res) {
    // Ensure no duplicate
    Service.findOne({name: dict['name']}).count().exec(function(err, doc) {
        var serviceExists = (doc !== 0);
        console.log(serviceExists);
        if(serviceExists){
            res.send(500, "Duplicate document. Try updating existing entry or chooseing a different name");
            return;
        }

        //Insert the document
        service = new Service(dict);
        service.save(function(err) {
            if(!err) {
                res.send("Service saved");
            }
        });
    });
} 
```

我也改为`find`，`findOne`否则你会得到一个数组而不是一个文档。