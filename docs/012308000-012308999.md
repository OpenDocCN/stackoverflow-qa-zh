# StackOverflow 问答 12308000-12308999

# php - symfony 1.4推进1.6：总和

> ID：12308008
> 
> 赞同：4
> 
> 时间：2012-09-06T20:38:07.173
> 
> 标签：php, symfony-1.4, sum, propel

我试图在推进中获得列的总和。我的代码

```
$c = new Criteria();
$c->add(valuePeer::OWNER_ID, $this->getId());
$c->addSelectColumn('SUM(' . valuePeer::VALUE . ') as total');
$c->addGroupByColumn(valuePeer::VALUE);

$sum = valuePeer::DoSelect($c); 
```

打印出来`$sum`什么都不返回（甚至没有空对象）。我得到的只是`Notice: Undefined offset: 1 in /.../lib/model/om/BaseValue.php on line 203 Notice: Undefined offset: 2 in /.../lib/model/om/BaseValue.php on line 204`

[我按照这里](http://oldforum.symfony-project.org/index.php/m/20554/)`::DoSelectRS($c)`的建议和其他多个讨论尝试了这种方法，但我得到了一个错误：。`Fatal error: Call to undefined method ValuePeer::DoSelectRS() in /.../lib/model/Restauracia.php on line 39`

谁能告诉我这方面的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T07:51:21.420

为什么不使用新的 ModelCriteria 而不是旧的冗长的呢？

```
$sum = ValueQuery::create()
  ->select(array('total'))
  ->filterByOwnerId($this->getId())
  ->withColumn('SUM(Value.Value)', 'total')
  ->find(); 
```

将返回如下内容：

```
PropelArrayCollection(
  array('total' => 25)
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:00:45.703

我刚刚找到了这个解决方案。它就像我需要的那样工作。

```
$c = new Criteria();
$c->clearSelectColumns();
$c->add(valuePeer::OWNER_ID, $this->getId());
$c->addSelectColumn('SUM(' . valuePeer::VALUE . ') as total');
//$c->addGroupByColumn(valuePeer::VALUE);

$sum = valuePeer::DoSelectStmt($c)->fetchAll(PDO::FETCH_COLUMN,0);
$sum = $sum[0]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-30T14:39:58.563

试试这个（不要担心`findOne`， `SUM`无论如何都会返回一行）。

请注意，这`getTotal()`是从 withColumn 的参考“总计”生成的。

惯例是`get+Columnname`（驼峰式）

```
$sum = ValueQuery::create()
  ->filterByOwnerId($this->getId())
  ->withColumn('SUM(Value.Value)', 'total')
  ->findOne()
  ->getTotal(); 
```

# git - 如何让 git log 在一行中包含时间戳、用户名、操作和文件名？

> ID：12308009
> 
> 赞同：0
> 
> 时间：2012-09-06T20:38:13.040
> 
> 标签：git

我想从 git 中获取 CSV 历史转储，如下所示：

```
1344882131,Josh Yeager,A,main.cs
1344882131,Josh Yeager,A,other.cs
1344882191,John Doe,D,other.cs 
```

第一列是 UNIX 时间戳，第二列是作者姓名，第三列是操作 (A/M/D)，最后是文件名。我想出了如何获取每个提交的时间戳和作者姓名，但我不知道如何让它也列出提交中的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T23:38:57.063

如果您将`--name-status`其作为参数提供给`git log`，它将包括文件名和操作，并且您只需要进行一些文本处理即可将提交和操作数据连接在一起并生成 CSV 输出。

# wpf - 始终禁用粘贴

> ID：12308016
> 
> 赞同：0
> 
> 时间：2012-09-06T20:38:51.457
> 
> 标签：wpf, copy, paste, cut

对于“常见”的外观和感觉，我有一个应用程序在功能区中显示粘贴/剪切/复制按钮，但无论选择哪个字段，我都希望始终禁用粘贴。我该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:45:04.030

# jquery - CSS div 换行和垂直空白

> ID：12308018
> 
> 赞同：0
> 
> 时间：2012-09-06T20:39:04.070
> 
> 标签：jquery, css, html

当容器的宽度发生变化时，我试图让几个 div 元素换行到下一行。包装部分工作正常，当没有足够的宽度容纳它时，框将下降到下一行，但是如果高度不同，则第一行元素和第二行元素之间存在间隙。在下面的示例中，我希望框 b4 向上滑入 b1 下方的空白区域。这可能吗？谢谢你的帮助。

[http://jsfiddle.net/86xcY/](http://jsfiddle.net/86xcY/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:15:55.937

这可能与您正在寻找的内容接近。它可能会进行很多优化，并进行调整以更好地满足您的需求。此外，当它转到单个列时存在一个错误，我无法对其进行排序。很有可能，最好的解决方案是将所有`margin-top`值设置为`0`在特定屏幕宽度下。

[http://jsfiddle.net/86xcY/1/](http://jsfiddle.net/86xcY/1/)

```
$(window).resize(function(e){
    var wid = $("#container").width();

    $("#container .box").each(function(index, element){
        $(this).css("margin-top", 0);
        var top = $(this).position().top;
        var left = $(this).position().left;

        var upwards = null;
        var htm = $("html")[0];

        if (top > 0){
            var cTop = top;
            while ((upwards == null || upwards == htm) && cTop > 0){
                cTop -= 10;
                upwards = document.elementFromPoint(left, cTop);
            }
            var uTop = $(upwards).position().top;
            var uHei = $(upwards).height();

            var negMarg = (uTop + uHei) - top;

            if (negMarg < 0){
                $(this).css("margin-top", negMarg);
            }
            else if (negMarg > 0)
                $(this).css("margin-top", 0);
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:53:06.083

```
 hello one small changes  i this case you must set the min-height and  max-height     details as follows. and when you add the content the height automatically increased.

   #box3 {
    display: table-cell;
    max-height: 300px;
    min-height: 98px;
    width: 200px;
 } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-06T20:44:26.610

如果您将 a 添加`float:left`到您的元素中，这是可能的。

# javascript - 将动态高度/宽度图像居中到固定高度/宽度 div

> ID：12308022
> 
> 赞同：0
> 
> 时间：2012-09-06T20:39:25.843
> 
> 标签：javascript, html, css

我将动态图像居中到固定大小的 div 有问题。因此，主要思想是图像知道如何缩放自己，无论是全景图像还是肖像图像。我要对齐的 div 接近 16:9 (300x170)。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:50:32.527

试试这个 -[**演示**](http://jsfiddle.net/SnPR6/)

```
div {
    height: 170px;
    width: 300px;
    border: solid;
    line-height: 170px;
    text-align: center;
}

div img {
    display: inline-block;
    max-width: 300px;
    max-height: 170px;
    vertical-align: middle;
} 
```

# python - 从没有换行符或 EOF 的 sys.stdin 读取

> ID：12308028
> 
> 赞同：6
> 
> 时间：2012-09-06T20:39:34.283
> 
> 标签：python, tcp, tcplistener, xinetd

我想从我的 gps-tracker 接收数据。它通过 tcp 发送数据，所以我使用 xinetd 来监听一些 tcp 端口和 python 脚本来处理数据。这是 xinetd 配置：

```
service gps-gprs
{
    disable     = no
    flags       = REUSE
    socket_type = stream
    protocol    = tcp
    port    = 57003
    user        = root
    wait        = no
    server      = /path/to/gps.py
    server_args     = 3
} 
```

在 /etc/services 中配置

```
gps-gprs        57003/tcp           # Tracking system 
```

和 Python 脚本 gps.py

```
#!/usr/bin/python
import sys

def main():
    data = sys.stdin.readline().strip() 
    #do something with data
    print 'ok'

if __name__ =='__main__':
    main() 
```

跟踪器以原始文本形式发送数据字符串，例如

```
$GPRMC,132017.000,A,8251.5039,N,01040.0065,E,0.00,,010111,0,,A*75+79161234567# 
```

问题是 python 脚本中的 sys.stdin 没有收到行尾或文件结尾字符，并且 sys.stdin.readline() 永远存在。我试图用 python 脚本从另一台电脑发送数据

```
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('', 57003))
s.sendall( u'hello'  )
data = s.recv(4024)
s.close()
print 'Received', data 
```

如果消息是'hello'，它会失败，但如果消息是'hello\n'，没关系，一切都很好。但我不知道如何告诉 tracker 或 xinetd 在消息末尾添加这个 '\n'。如何在没有 EOF 或 EOL 的情况下从 sys.stdin 读取数据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-06-17T19:33:40.740

简单的：

```
data=sys.stdin.read().splitlines()

for i in data:
        print i 
```

没有换行符

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-06T20:50:51.570

`sys.stdin.readline()`永远等待，直到它收到换行符。然后它认为当前行是完整的并完整地返回它。如果您想读取不包含换行符的数据，或者您不想等到收到换行符后再处理（部分）数据，那么您将不得不使用`readline`. 最有可能你应该调用`read`，它读取任意数据到给定大小。

但是，您的 GPS 似乎正在以众所周知的[NEMA](http://www.gpsinformation.org/dale/nmea.htm)格式发送数据，并且该格式肯定会以换行符结束每一行。实际上，它可能会用 CRLF ( ) 终止每一行，`\r\n`但它可能`\r`会在到达您的 TCP 套接字之前在某个地方被删除。无论哪种方式`\n`，每行的末尾都有一个。

如果您的`readline`呼叫挂起而没有返回任何线路，很可能是因为发送方正在缓冲线路，直到它有一个完整的缓冲区。如果您等待发件人缓冲区填满的时间足够长，您将一次收到一大堆行。如果发生这种情况，您必须将发送者更改为在每个 NEMA 语句之后刷新其发送缓冲区。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:50:47.907

看来您正在接收`#`而不是`<CR><LF>`，请阅读直到`#`标志。

```
data = ""
while len(data) == 0 or data[-1] <> '#':
    data += sys.stdin.read(1)

#do something with data
print 'ok' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-21T11:12:31.363

我的解决方案：

```
var = sys.stdin.readline().replace('\n', '') 
```

它 ：

*   在条目中找到换行符，
*   将其从条目中替换为 '' (none) ~remove,
*   将其分配给变量。

# reference - 在 javascript 中调用函数/对象引用时适应任何数据类型

> ID：12308032
> 
> 赞同：0
> 
> 时间：2012-09-06T20:39:41.933
> 
> 标签：reference, javascript

我正在为工作中的重复编码任务构建一个实用程序库，并且在此过程中遇到了几个问题。

该库以各种[SEAF 模式](http://www.novogeek.com/post/2010/05/27/Create-a-jQuery-like-chainable-JavaScript-toolbox-specific-to-your-project.aspx)为模型。通用示例：

```
(function() {
   var A = function() {
      return new B();
   };

   var B = function() {

   }

   B.prototype = {
    /* Object Methods */
   }

   window.a = window._a = A;
})(); 
```

如果我将值分配给窗口对象的“A”，我可以通过调用成功调用任何可用的原型方法`_a.object_method();`但是，如果我调用`_a('selector');`它可以理解地抛出 typeError。

反过来也是如此，如果我为窗口对象分配了函数引用`window.a = _a = A;`，我只能通过以下方式调用它：`_a('selector');`并且在尝试访问任何对象方法时会抛出 typeError 。

我的问题是，通常最好的处理方法是什么？如果有任何其他解决此问题的 SO 问题，请以我的方式发送这些 URL。

非常感谢！

这是一个基本的小提琴，取消注释交替行以了解我的意思。

[小提琴。](http://jsfiddle.net/ktstowell/Hg3KX/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:10:45.670

您不能调用 `_a.init('HAI');`，因为`_a`没有任何`init`方法，只有`B`do 的实例（并且`_a`只是对 的引用`A`）。

但是，在您调用 之后`_a()`，您会返回一个`B`. 所以，你可以这样做：

```
_a('HAI').init(); 
```

# python - Python 脚本退出时没有输出，我不知道为什么

> ID：12308036
> 
> 赞同：1
> 
> 时间：2012-09-06T20:39:56.813
> 
> 标签：python, windows, svn, python-3.x

我正在尝试调试调用一些 python 脚本的 Subversion 提交后挂钩。到目前为止，我能够确定的是，当我`post-commit.bat`手动运行时（我为它创建了一个包装器以使其更容易）一切都会成功，但是当 SVN 运行它时，一个特定的步骤不起作用。

我们正在使用 CollabNet SVNServe，我[从文档](http://help.collab.net/index.jsp?topic=/csvn/faq/repohooks.html)中知道它会删除所有环境变量。这在早些时候引起了一些问题，但现在不应该成为问题。

> *在 Subversion 调用钩子脚本之前，它会从环境中删除所有变量——包括 Unix 上的 $PATH 和 Windows 上的 %PATH%。因此，如果您拼出该程序的绝对名称，您的脚本只能运行另一个程序。*

的相关部分`post-commit.bat`是：

```
echo -------------------------- >> c:\svn-repos\company\hooks\svn2ftp.out.log

set SITENAME=staging
set SVNPATH=branches/staging/wwwroot/
"C:\Python3\python.exe" C:\svn-repos\company\hooks\svn2ftp.py ^
 --svnUser="svnusername" ^
 --svnPass="svnpassword" ^
 --ftp-user=ftpuser ^
 --ftp-password=ftppassword ^
 --ftp-remote-dir=/ ^
 --access-url=svn://10.0.100.6/company ^
 --status-file="C:\svn-repos\company\hooks\svn2ftp-%SITENAME%.dat" ^
 --project-directory=%SVNPATH% "staging.company.com" %1 %2 >> c:\svn-repos\company\hooks\svn2ftp.out.log

echo -------------------------- >> c:\svn-repos\company\hooks\svn2ftp.out.log 
```

当我`post-commit.bat`手动运行时，例如：`post-commit c:\svn-repos\company 12345`，我看到如下输出`svn2ftp.out.log`：

```
-------------------------- 
args1: c:\svn-repos\company
args0: staging.company.com
abspath: c:\svn-repos\company
project_dir: branches/staging/wwwroot/
local_repos_path: c:\svn-repos\company
getting youngest revision...
done, up-to-date
-------------------------- 
```

但是，当我向 repo 提交某些内容并自动运行时，输出为：

```
-------------------------- 
-------------------------- 
```

`svn2ftp.py`有点长，所以我很抱歉，但这里有。我将在其下方提供一些关于其内容的注释/免责声明。

```
#!/usr/bin/env python

"""Usage: svn2ftp.py [OPTION...] FTP-HOST REPOS-PATH

Upload to FTP-HOST changes committed to the Subversion repository at 
REPOS-PATH.  Uses svn diff --summarize to only propagate the changed files

Options:

 -?, --help             Show this help message.

 -u, --ftp-user=USER    The username for the FTP server. Default: 'anonymous'

 -p, --ftp-password=P   The password for the FTP server. Default: '@'

 -P, --ftp-port=X       Port number for the FTP server. Default: 21

 -r, --ftp-remote-dir=DIR   The remote directory that is expected to resemble the
                        repository project directory

 -a, --access-url=URL   This is the URL that should be used when trying to SVN
                        export files so that they can be uploaded to the FTP 
                        server

 -s, --status-file=PATH   Required.  This script needs to store the last 
                          successful revision that was transferred to the 
                          server.  PATH is the location of this file.

 -d, --project-directory=DIR   If the project you are interested in sending to
                               the FTP server is not under the root of the 
                               repository (/), set this parameter.
                               Example: -d 'project1/trunk/'
                               This should NOT start with a '/'.
2008.5.2 CKS
Fixed possible Windows-related bug with tempfile, where the script didn't have
permission to write to the tempfile. Replaced this with a open()-created file
created in the CWD.

2008.5.13 CKS
Added error logging. Added exception for file-not-found errors when deleting files.

2008.5.14 CKS
Change file open to 'rb' mode, to prevent Python's universal newline support from
stripping CR characters, causing later comparisons between FTP and SVN to report changes.
"""

try:
    import sys, os
    import logging
    logging.basicConfig(
        level=logging.DEBUG,
        format='%(asctime)s %(levelname)s %(message)s',
        filename='svn2ftp.debug.log',
        filemode='a'
    )
    console = logging.StreamHandler()
    console.setLevel(logging.ERROR)
    logging.getLogger('').addHandler(console)

    import getopt, tempfile, smtplib, traceback, subprocess
    from io import StringIO
    import pysvn
    import ftplib
    import inspect

except Exception as e:
    logging.error(e)
    #capture the location of the error
    frame = inspect.currentframe()
    stack_trace = traceback.format_stack(frame)
    logging.debug(stack_trace)
    print(stack_trace)
    #end capture
    sys.exit(1)

#defaults
host = ""
user = "anonymous"
password = "@"
port = 21
repo_path = ""
local_repos_path = ""
status_file = ""
project_directory = ""
remote_base_directory = ""
toAddrs = "developers@company.com"
youngest_revision = ""

def email(toAddrs, message, subject, fromAddr='autonote@company.com'):
    headers = "From: %s\r\nTo: %s\r\nSubject: %s\r\n\r\n" % (fromAddr, toAddrs, subject)
    message = headers + message
    logging.info('sending email to %s...' % toAddrs)
    server = smtplib.SMTP('smtp.company.com')
    server.set_debuglevel(1)
    server.sendmail(fromAddr, toAddrs, message)
    server.quit()
    logging.info('email sent')

def captureErrorMessage(e):
    sout = StringIO()
    traceback.print_exc(file=sout)
    errorMessage = '\n'+('*'*80)+('\n%s'%e)+('\n%s\n'%sout.getvalue())+('*'*80)
    return errorMessage

def usage_and_exit(errmsg):
    """Print a usage message, plus an ERRMSG (if provided), then exit.
    If ERRMSG is provided, the usage message is printed to stderr and
    the script exits with a non-zero error code.  Otherwise, the usage
    message goes to stdout, and the script exits with a zero
    errorcode."""
    if errmsg is None:
        stream = sys.stdout
    else:
        stream = sys.stderr
    print(__doc__, file=stream)
    if errmsg:
        print("\nError: %s" % (errmsg), file=stream)
        sys.exit(2)
    sys.exit(0)

def read_args():
    global host
    global user
    global password
    global port
    global repo_path
    global local_repos_path
    global status_file
    global project_directory
    global remote_base_directory
    global youngest_revision

    try:
        opts, args = getopt.gnu_getopt(sys.argv[1:], "?u:p:P:r:a:s:d:SU:SP:",
            ["help",
            "ftp-user=",
            "ftp-password=",
            "ftp-port=",
            "ftp-remote-dir=",
            "access-url=",
            "status-file=",
            "project-directory=",
            "svnUser=",
            "svnPass="
            ])
    except getopt.GetoptError as msg:
        usage_and_exit(msg)

    for opt, arg in opts:
        if opt in ("-?", "--help"):
            usage_and_exit()
        elif opt in ("-u", "--ftp-user"):
            user = arg
        elif opt in ("-p", "--ftp-password"):
            password = arg
        elif opt in ("-SU", "--svnUser"):
            svnUser = arg
        elif opt in ("-SP", "--svnPass"):
            svnPass = arg
        elif opt in ("-P", "--ftp-port"):
            try:
               port = int(arg)
            except ValueError as msg:
               usage_and_exit("Invalid value '%s' for --ftp-port." % (arg))
            if port < 1 or port > 65535:
               usage_and_exit("Value for --ftp-port must be a positive integer less than 65536.")
        elif opt in ("-r", "--ftp-remote-dir"):
            remote_base_directory = arg
        elif opt in ("-a", "--access-url"):
            repo_path = arg
        elif opt in ("-s", "--status-file"):
            status_file = os.path.abspath(arg)
        elif opt in ("-d", "--project-directory"):
            project_directory = arg

    if len(args) != 3:
        print(str(args))
        usage_and_exit("host and/or local_repos_path not specified (" + len(args) + ")")

    host = args[0]
    print("args1: " + args[1])
    print("args0: " + args[0])
    print("abspath: " + os.path.abspath(args[1]))
    local_repos_path = os.path.abspath(args[1])
    print('project_dir:',project_directory)

    youngest_revision = int(args[2])

    if status_file == "" : usage_and_exit("No status file specified")

def main():
    global host
    global user
    global password
    global port
    global repo_path
    global local_repos_path
    global status_file
    global project_directory
    global remote_base_directory
    global youngest_revision

    read_args()

    #repository,fs_ptr

    #get youngest revision
    print("local_repos_path: " + local_repos_path)
    print('getting youngest revision...')
    #youngest_revision = fs.youngest_rev(fs_ptr)

    assert youngest_revision, "Unable to lookup youngest revision."
    last_sent_revision = get_last_revision()

    if youngest_revision == last_sent_revision:
        # no need to continue.  we should be up to date.
        print('done, up-to-date')
        return

    if last_sent_revision or youngest_revision < 10:
        # Only compare revisions if the DAT file contains a valid
        # revision number. Otherwise we risk waiting forever while
        # we parse and uploading every revision in the repo in the case
        # where a repository is retroactively configured to sync with ftp.

        pysvn_client = pysvn.Client()
        pysvn_client.callback_get_login = get_login

        rev1 = pysvn.Revision(pysvn.opt_revision_kind.number, last_sent_revision)
        rev2 = pysvn.Revision(pysvn.opt_revision_kind.number, youngest_revision)

        summary = pysvn_client.diff_summarize(repo_path, rev1, repo_path, rev2, True, False)

        print('summary len:',len(summary))
        if len(summary) > 0 :
            print('connecting to %s...' % host)
            ftp = FTPClient(host, user, password)
            print('connected to %s' % host)
            ftp.base_path = remote_base_directory
            print('set remote base directory to %s' % remote_base_directory)

            #iterate through all the differences between revisions
            for change in summary :
                #determine whether the path of the change is relevant to the path that is being sent, and modify the path as appropriate.
                print('change path:',change.path)
                ftp_relative_path = apply_basedir(change.path)
                print('ftp rel path:',ftp_relative_path)

                #only try to sync path if the path is in our project_directory
                if ftp_relative_path != "" :
                    is_file = (change.node_kind == pysvn.node_kind.file)
                    if str(change.summarize_kind) == "delete" :
                        print("deleting: " + ftp_relative_path)
                        try:
                            ftp.delete_path("/" + ftp_relative_path, is_file)
                        except ftplib.error_perm as e:
                            if 'cannot find the' in str(e) or 'not found' in str(e):
                                # Log, but otherwise ignore path-not-found errors
                                # when deleting, since it's not a disaster if the file
                                # we want to delete is already gone.
                                logging.error(captureErrorMessage(e))
                            else:
                                raise
                    elif str(change.summarize_kind) == "added" or str(change.summarize_kind) == "modified" :
                        local_file = ""
                        if is_file :
                            local_file = svn_export_temp(pysvn_client, repo_path, rev2, change.path)
                        print("uploading file: " + ftp_relative_path)
                        ftp.upload_path("/" + ftp_relative_path, is_file, local_file)
                        if is_file :
                            os.remove(local_file)
                    elif str(change.summarize_kind) == "normal" :
                        print("skipping 'normal' element: " + ftp_relative_path)
                    else :
                        raise str("Unknown change summarize kind: " + str(change.summarize_kind) + ", path: " + ftp_relative_path)
            ftp.close()

    #write back the last revision that was synced
    print("writing last revision: " + str(youngest_revision))
    set_last_revision(youngest_revision)     # todo: undo

def get_login(a,b,c,d):
    #arguments don't matter, we're always going to return the same thing
    try:
        return True, "svnUsername", "svnPassword", True
    except Exception as e:
        logging.error(e)
        #capture the location of the error
        frame = inspect.currentframe()
        stack_trace = traceback.format_stack(frame)
        logging.debug(stack_trace)
        #end capture
        sys.exit(1)

#functions for persisting the last successfully synced revision
def get_last_revision():
    if os.path.isfile(status_file) :
        f=open(status_file, 'r')
        line = f.readline()
        f.close()
        try: i = int(line)
        except ValueError:
            i = 0
    else:
        i = 0
    f = open(status_file, 'w')
    f.write(str(i))
    f.close()
    return i

def set_last_revision(rev) :
    f = open(status_file, 'w')
    f.write(str(rev))
    f.close()

#augmented ftp client class that can work off a base directory
class FTPClient(ftplib.FTP) :
    def __init__(self, host, username, password) :
        self.base_path = ""
        self.current_path = ""
        ftplib.FTP.__init__(self, host, username, password)

    def cwd(self, path) :
        debug_path = path
        if self.current_path == "" :
            self.current_path = self.pwd()
            print("pwd: " + self.current_path)

        if not os.path.isabs(path) :
            debug_path = self.base_path + "<" + path
            path = os.path.join(self.current_path, path)
        elif self.base_path != "" :
            debug_path = self.base_path + ">" + path.lstrip("/")
            path = os.path.join(self.base_path, path.lstrip("/"))
        path = os.path.normpath(path)

        #by this point the path should be absolute.
        if path != self.current_path :
            print("change from " + self.current_path + " to " + debug_path)
            ftplib.FTP.cwd(self, path)
            self.current_path = path
        else :
            print("staying put : " + self.current_path)

    def cd_or_create(self, path) :
        assert os.path.isabs(path), "absolute path expected (" + path + ")"
        try: self.cwd(path)
        except ftplib.error_perm as e: 
            for folder in path.split('/'): 
                if folder == "" :
                    self.cwd("/")
                    continue

                try: self.cwd(folder)
                except: 
                    print("mkd: (" + path + "):" + folder)
                    self.mkd(folder)
                    self.cwd(folder)

    def upload_path(self, path, is_file, local_path) :
        if is_file:
            (path, filename) = os.path.split(path)
            self.cd_or_create(path)

            # Use read-binary to avoid universal newline support from stripping CR characters.
            f = open(local_path, 'rb')

            self.storbinary("STOR " + filename, f)

            f.close()
        else:
            self.cd_or_create(path)

    def delete_path(self, path, is_file) :
        (path, filename) = os.path.split(path)
        print("trying to delete: " + path + ", " + filename)
        self.cwd(path)
        try:
            if is_file :
                self.delete(filename)
            else:
                self.delete_path_recursive(filename)
        except ftplib.error_perm as e:
            if 'The system cannot find the' in str(e) or '550 File not found' in str(e):
                # Log, but otherwise ignore path-not-found errors
                # when deleting, since it's not a disaster if the file
                # we want to delete is already gone.
                logging.error(captureErrorMessage(e))
            else:
                raise

    def delete_path_recursive(self, path):
        if path == "/" :
            raise "WARNING: trying to delete '/'!"
        for node in self.nlst(path) :
            if node == path :
                #it's a file.  delete and return
                self.delete(path)
                return
            if node != "." and node != ".." :
                self.delete_path_recursive(os.path.join(path, node))
        try: self.rmd(path)
        except ftplib.error_perm as msg :
            sys.stderr.write("Error deleting directory " + os.path.join(self.current_path, path) + " : " + str(msg))

# apply the project_directory setting
def apply_basedir(path) :
    #remove any leading stuff (in this case, "trunk/") and decide whether file should be propagated
    if not path.startswith(project_directory) :
        return ""
    return path.replace(project_directory, "", 1)

def svn_export_temp(pysvn_client, base_path, rev, path) :
    # Causes access denied error. Couldn't deduce Windows-perm issue.
    # It's possible Python isn't garbage-collecting the open file-handle in time for pysvn to re-open it.
    # Regardless, just generating a simple filename seems to work.
    #(fd, dest_path) = tempfile.mkstemp()
    dest_path = tmpName = '%s.tmp' % __file__

    exportPath = os.path.join(base_path, path).replace('\\','/')
    print('exporting %s to %s' % (exportPath, dest_path))
    pysvn_client.export( exportPath,
            dest_path,
            force=False,
            revision=rev,
            native_eol=None,
            ignore_externals=False,
            recurse=True,
            peg_revision=rev )

    return dest_path    

if __name__ == "__main__":
    logging.info('svnftp.start')
    try:
        main()
        logging.info('svnftp.done')
    except Exception as e:
        # capture the location of the error for debug purposes
        frame = inspect.currentframe()
        stack_trace = traceback.format_stack(frame)
        logging.debug(stack_trace[:-1])
        print(stack_trace)
        # end capture
        error_text = '\nFATAL EXCEPTION!!!\n'+captureErrorMessage(e)
        subject = "ALERT: SVN2FTP Error"
        message = """An Error occurred while trying to FTP an SVN commit.

repo_path = %(repo_path)s\n
local_repos_path = %(local_repos_path)s\n
project_directory = %(project_directory)s\n
remote_base_directory = %(remote_base_directory)s\n
error_text = %(error_text)s
        """ % globals()
        email(toAddrs, message, subject)
        logging.error(e) 
```

注释/免责声明：

*   我基本上没有接受过 Python 培训，所以我边走边学，并花大量时间阅读文档来解决问题。
*   的主体`get_login`在 try 块中，因为我收到奇怪的错误，说 callback_get_login 中存在未处理的异常。一直不知道为什么，但现在看起来很好。让睡狗躺着，对吧？
*   用户名和密码`get_login` *目前是*硬编码的（但正确），只是为了消除变量并尝试一次尽可能少地更改。（我将 svnuser 和 svnpass 参数添加到现有参数解析中。）

这就是我所在的地方。我无法弄清楚为什么它没有将任何内容打印到`svn2ftp.out.log`. 如果您想知道，svn2ftp.debug.log 中这些失败尝试之一的输出是：

```
2012-09-06 15:18:12,496 INFO svnftp.start
2012-09-06 15:18:12,496 INFO svnftp.done 
```

成功运行也没有什么不同。所以没有什么有用的被记录。

我迷路了。我已经在这个兔子洞里走了很远，不知道从这里去哪里。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:06:50.250

看起来好像您正在覆盖您的日志记录级别。尝试将两者都设置为 DEBUG，看看会发生什么。

```
import sys, os
import logging
logging.basicConfig(
    level=logging.DEBUG,  # DEBUG here
    format='%(asctime)s %(levelname)s %(message)s',
    filename='svn2ftp.debug.log',
    filemode='a'
)
console = logging.StreamHandler()
console.setLevel(logging.ERROR) # ERROR here
logging.getLogger('').addHandler(console) 
```

此外，您在某些地方打印并在其他地方登录。我不确定日志库是否会自动将 sys.stdout 重定向到日志控制台。我会将所有打印语句转换为日志语句以保持一致。

# java - 如何读取带有西里尔文路径的文件

> ID：12308037
> 
> 赞同：3
> 
> 时间：2012-09-06T20:40:01.180
> 
> 标签：java, character-encoding, filenotfoundexception

其实我有下一个代码：

```
String f = LauncherFrame.class.getProtectionDomain().getCodeSource().getLocation().getPath(); // path to launcher
java.lang.System.out.println(f);

String launcherHash = "";

try{
  MessageDigest md5  = MessageDigest.getInstance("MD5");
  launcherHash = calculateHash(md5, f);
}catch (Exception e) {
  java.lang.System.out.println(e){
  return;
} 
```

**计算哈希**函数：

```
public static String calculateHash(MessageDigest algorithm,String fileName) throws Exception{
      FileInputStream    fis = new FileInputStream(fileName);
      BufferedInputStream bis = new BufferedInputStream(fis);
      DigestInputStream  dis = new DigestInputStream(bis, algorithm);

      while (dis.read() != -1);
            byte[] hash = algorithm.digest();

      return byteArray2Hex(hash);
} 
```

当我的 .jar 文件在路径中没有西里尔字符时，它在 unix/windows 上运行良好。但是当它有时，我得到下一个例外：

```
java.io.FileNotFoundException: 
C:\Users\%d0%90%d1%80%d1%82%d1%83%d1%80\Documents\NetBeansProjects\artcraft-client\build\classes (Can't find file) 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:00:22.460

这是来自记忆，所以语法可能有点偏离，但最好的可能是使用内置的 URL 支持直接从 URL 打开流；

```
URL url = LauncherFrame.class.getProtectionDomain().getCodeSource().getLocation(); 
```

然后将 URL 传递给`calculateHash`而不是文件名，并使用[URL 的 openStream 方法](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#openStream())获取包含内容的流；

```
InputStream is = url.openStream();
BufferedInputStream bis = new BufferedInputStream(is);
... 
```

# .net - 从 .sln 文件解析 ProjectDependency

> ID：12308040
> 
> 赞同：1
> 
> 时间：2012-09-06T20:40:05.473
> 
> 标签：.net, visual-studio-2010, parsing, projects-and-solutions, msbuild-4.0

```
Project("{00000000-0000-0000-0000-000000000000}") = "Test Projects", "TestProjects", "{5FAF487E-B913-4D46-983E-CB13FDF36FCB}"
EndProject
Project("{11111111-1111-1111-1111-111111111111}") = "ProjPropHelperAPI", "ProjPropHelperAPI\ProjPropHelperAPI.vcxproj", "{22222222-2222-2222-2222-222222222222}"
EndProject
Project("{33333333-3333-3333-3333-333333333333}") = "ProjectPropertiesHelperAPI", "ProjectPropertiesHelperAPI\ProjectPropertiesHelperAPI.csproj", "{66666666-6666-6666-6666-666666666666}"
    ProjectSection(ProjectDependencies) = postProject
        {44444444-4444-4444-4444-444444444444} = {44444444-4444-4444-4444-444444444444}
        {55555555-5555-5555-5555-555555555555} = {55555555-5555-5555-5555-555555555555}
    EndProjectSection
EndProject 
```

**[我可以使用此问题](https://stackoverflow.com/q/707107/1035156)**中提到的解决方案来阅读项目名称、它们的 GUID 和路径。名称、guid 和路径使用

```
Type.GetType().GetProperty() 
```

我需要解析 ProjectDependencies 选项卡。我想知道是否可以类似地获得 ProjectDependencies 值？

也欢迎任何其他解决方案

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:35:46.790

```
 var filePath = @"C:\Users\xyz\Documents\Visual Studio 2010\Projects\test\test.sln"
        var slnLines = File.ReadAllLines(filePath);
        var projGuid = new List<string>();
        for(var i=0; i<slnLines.Length; i++)
        {
            if (slnLines[i].Contains(@"ProjectSection(ProjectDependencies)"))
                while (!slnLines[i+1].Contains("EndProjectSection"))
                {
                    var temp = (slnLines[i+1].Split(new[]{'=', '\n', '\t', ' '},2,StringSplitOptions.RemoveEmptyEntries));
                    if(temp.ElementAt(0) == temp.ElementAt(1))
                        projGuid.Add(temp.ElementAt(0));
                    i++;
                }
        }

        using (var file = new StreamWriter(@"C:\Users\xyz\Desktop\Results.txt"))
        {
            foreach (var pGuid in projGuid)
            {
                file.WriteLine(pGuid);
            }
        } 
```

这段代码做到了。

谢谢。

# asp.net-mvc-3 - 通过 url 查询字符串对用户进行身份验证

> ID：12308042
> 
> 赞同：1
> 
> 时间：2012-09-06T20:40:25.580
> 
> 标签：asp.net-mvc-3

我正在尝试根据查询字符串参数对用户进行身份验证。我创建了一个自定义 AuthorizeAttribute，它覆盖 AuthorizeCore 方法来解码\验证查询字符串参数，调用 FormsAuthentication.SetAuthCookie() 并在它有效并且按预期工作时返回 true（用户可以访问安全区域）

但是，用我的自定义 AuthorizeAttribute 装饰的控制器无法通过 Membership.GetUser() 访问用户的数据，我认为是因为请求仍未经过身份验证。

有任何想法吗？

# javascript - JS 异步分页策略

> ID：12308044
> 
> 赞同：0
> 
> 时间：2012-09-06T20:40:31.023
> 
> 标签：javascript, jquery

我在主页上有一个`<ul>`数据列表。现在我一次加载它们，并且想要实现分页导致有时列表达到 500-1000 项，这会推迟网站并创建糟糕的用户体验。

我可以使用可用的插件，但都提供了同样糟糕的用户体验——点击时用户会感觉到这种故障、这种暂停、这种数据流的延迟。

[我可以在 UI 中显示一些 preloader 或 msg](http://datatables.net/release-datatables/examples/server_side/defer_loading.html)，但我希望避免它。我希望使这种预加载对用户透明。

我想只在开始时加载第一个项目，而不是当用户单击*下一个*按钮时，我会在每次下一个 2（或 3）“页面”时加载。

我担心以下情况：当用户快速点击导航按钮时如何处理数据。如何防止 UI 错误。

还有一个主题——缓存。我怎样才能提高我的表现？如果需要，我可以使用哪些技术？

谢谢！

# java - 从失败的 XML 中获取元素

> ID：12308045
> 
> 赞同：0
> 
> 时间：2012-09-06T20:40:35.050
> 
> 标签：java

我有一个大 xml 文件要针对大 XSD 进行验证。当出现验证错误时，客户要求我用不同的数据值填充表。例如，如果学生证无效，我将显示学区、地区和学生证。在 XML 的另一部分，如果状态无效，我将显示学校名称、州和地区。要显示的数据因无效数据而异。但是应该提取其作为无效子元素的父元素的两个或三个或四个元素。

如何使用 XMLSTREAMREADER 和 Validator 提取数据？

我试过这个，我只能得到无效元素而不是其他数据......

```
public class StaxReaderWithElementIdentification {

private static final StreamSource XSD = new StreamSource("files\\InterchangeEducationOrganizationExension.xsd");
private static final StreamSource XML = new StreamSource("files\\InterchangeEducationOrganizationExension.xml");

public static void main(String[] args) throws Exception {
    SchemaFactory factory=SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
    Schema schema = factory.newSchema(XSD);

    XMLStreamReader reader = XMLInputFactory.newFactory().createXMLStreamReader(XML);
    Validator validator = schema.newValidator();
    validator.setErrorHandler(new MyErrorHandler(reader));
    validator.validate(new StAXSource(reader));

}
} 
```

处理程序是：

```
public class MyErrorHandler implements ErrorHandler {

private XMLStreamReader reader;

public MyErrorHandler(XMLStreamReader reader) {
    this.reader = reader;
}

@Override
public void error(SAXParseException e) throws SAXException {
    warning(e);
}

@Override
public void fatalError(SAXParseException e) throws SAXException {
    warning(e);
}

@Override
public void warning(SAXParseException e) throws SAXException {
    //System.out.println(reader.getProperty(name));
    System.out.println(reader.getLocalName());
    System.out.println(reader.getNamespaceURI());
    e.printStackTrace(System.out);
    }

} 
```

发生验证错误时，谁能帮助我如何提取其他数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T14:26:35.090

我不确定它是否是最佳解决方案，但您可以尝试使用 [HTML EditorKit](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/HTMLEditorKit.html)并实现自定义[ParserCallback](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/HTMLEditorKit.ParserCallback.html)。

以这种方式，您可以解析文档并仅对您感兴趣的标签做出反应。它会咀嚼任何 XML/HTML，无论它多么无效。

# python - 如何在 Heroku 上启动您已经制作的 Django 应用程序

> ID：12308046
> 
> 赞同：3
> 
> 时间：2012-09-06T20:40:35.067
> 
> 标签：python, django, heroku

我已经制作了一个在我的服务器上运行的 django 应用程序。我现在想使用 heroku 在网络上启动它，但我找到的所有教程都让你开始一个全新的项目。我不知道该怎么做才能简单地更新我已经存在的 django 项目以使用 heroku。

我的文件现在是这样组织的：

```
in hcp:
       crunchWeb:
                 crunchWeb: files = _init_.py ; settings.py ; urls.py ; wsgi.py
                 crunchApp: files = _init_.py ; admin.py ; models.py ; views.py etc...
                 manage.py
                 sqlite3.db

       env: folders= bin ; helloflask ; include ; lib #all of these were created automatically 
       templates:  all my .html files 
```

我想知道 heroku 教程 (https://devcenter.heroku.com/articles/django#using-a-different-wsgi-server) 中的哪些命令我仍然需要执行，哪些可以跳过。

我还想知道执行所有命令时我需要在哪个文件夹中

谢谢！

```
2012-09-06T21:44:52+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
2012-09-06T21:44:52+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
2012-09-06T21:44:52+00:00 app[web.1]:     return getattr(connections[DEFAULT_DB_ALIAS], item)
2012-09-06T21:44:52+00:00 app[web.1]:     backend = load_backend(db['ENGINE'])
2012-09-06T21:44:52+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/utils.py", line 24, in load_backend
2012-09-06T21:44:52+00:00 app[web.1]:     return import_module('.base', backend_name)
2012-09-06T21:44:52+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
2012-09-06T21:44:52+00:00 app[web.1]:     __import__(name)
2012-09-06T21:44:52+00:00 app[web.1]:   File "/app/.heroku/venv/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py", line 31, in <module>
2012-09-06T21:44:52+00:00 app[web.1]:     raise ImproperlyConfigured("Error loading either pysqlite2 or sqlite3 modules (tried in that order): %s" % exc)
2012-09-06T21:44:52+00:00 app[web.1]: django.core.exceptions.ImproperlyConfigured: Error loading either pysqlite2 or sqlite3 modules (tried in that order): No module named _sqlite3
2012-09-06T21:44:54+00:00 heroku[web.1]: Process exited with status 1
2012-09-06T21:44:54+00:00 heroku[web.1]: State changed from starting to crashed
2012-09-06T21:44:54+00:00 heroku[web.1]: State changed from crashed to starting
2012-09-06T21:44:58+00:00 heroku[web.1]: Starting process with command `python ./manage.py runserver 0.0.0.0:57395 --noreload`
2012-09-06T21:44:59+00:00 app[web.1]:   File "./manage.py", line 10, in <module> 
```

设置.py

```
 # Django settings for crunchWeb project.
import dj_database_url

DEBUG = True
TEMPLATE_DEBUG = DEBUG

ADMINS = (
# ('Your Name', 'your_email@example.com'),
)

MANAGERS = ADMINS

DATABASES = {'default': dj_database_url.config(default='postgres://localhost')}

# {
#     'default': {
#         'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
#         'NAME': '/Users/Santi/hcp/crunchWeb/sqlite3.db',                      # Or path to database file if using sqlite3.
#         'USER': '',                      # Not used with sqlite3.
#         'PASSWORD': '',                  # Not used with sqlite3.
#         'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
#         'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
#     }
# } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T13:41:27.293

直接从方向[https://devcenter.heroku.com/articles/django](https://devcenter.heroku.com/articles/django)，如果您再次阅读说明并遵循它们，您将执行：

```
$pip install Django psycopg2 dj-database-url 
```

## 数据库设置

接下来，配置应用程序以使用 Heroku 的 Postgres 数据库。已安装的 dj-database-url 模块将自动从 env 执行所有操作。

将以下内容添加到您的 settings.py 中：

```
import dj_database_url
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

您可以在 settings.py 的末尾添加这些行以继续在本地使用 sql lite 并且仅在 heroku 上使用 postgres。

```
settings.py
------------------------
import dj_database_url
import os
if os.getcwd() == "/app":
    DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:14:52.070

您链接的[heroku/django 部署教程](https://devcenter.heroku.com/articles/django)仍然是您最好的选择。我刚刚按照该教程部署了一个现有应用程序，并跳过了我已经完成的步骤，例如：

```
virtualenv venv --distribute
django-admin.py startapp...
manage.py syncdb...
git init 
```

基本上，如果您已经为现有的应用程序干了这个！

我在您上面的文件夹结构中没有看到 requirements.txt，所以请确保您

```
pip freeze > requirements.txt 
```

为了减少破坏我现有代码的可能性，我执行了以下操作

```
# create a branch for testing heroku
git checkout -b heroku_test

#... follow the heroku tutorial

# add my changes
git add .
git commit -m "Heroku deployment steps"

# add the heroku remote
git remote add heroku [address]
git push heroku heroku_test:master 
```

push 语句的最后一部分`heroku_test:master`让您将本地分支推`heroku_test`送到远程分支`master`。（否则 heroku 将忽略提交，因为它不在 master 分支上）。

# spring - 带有tomcat的Spring jpa（Hibernate）

> ID：12308050
> 
> 赞同：2
> 
> 时间：2012-09-06T20:40:45.283
> 
> 标签：spring, hibernate, tomcat

这些天我正在使用JPA（Hibernate）和spring项目，我配置了spring，jpa并尝试在tomcat7上部署应用程序，据我所知jpa / hibernate使用实体类首先加载创建表，但在这里我看不到应用程序启动时数据库和应用程序之间的任何连接，下面你可以看到我的配置，我已经看到很多关于这个问题的问题，我找不到我的问题的正确解决方案。

谁能告诉我这里有什么问题。我在码头服务器上创建了一个没有任何问题的应用程序，提前谢谢你

applicationContext-dao.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-3.0.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx-3.0.xsd"
       default-lazy-init="true">

    <!-- Use @Transaction annotations for managing transactions  -->
    <!--<tx:annotation-driven/>-->

    <!-- holding properties for database connectivity / -->
    <context:property-placeholder location="classpath:jdbc.properties"/>

    <tx:annotation-driven proxy-target-class="true" />
    <!-- Activates scanning of @Autowired -->
    <context:annotation-config/>

    <!-- Activates scanning of @Repository -->
    <context:component-scan base-package="lk.gov.elg"/>

    <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" />

    <tx:annotation-driven transaction-manager="transactionManager" />

    <bean id="dataSource"
          class="org.springframework.jdbc.datasource.DriverManagerDataSource"
          p:driverClassName="${jdbc.driverClassName}"
          p:url="${jdbc.url}"
          p:username="${jdbc.username}"
          p:password="${jdbc.password}"/>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"
          p:entityManagerFactory-ref="entityManagerFactory"
          p:dataSource-ref="dataSource"/>

    <bean class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource"/>
    </bean>

    <bean id="entityManagerFactory"
          class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
          p:dataSource-ref="dataSource"
          p:jpaVendorAdapter-ref="jpaAdapter">
        <property name="persistenceUnitName" value="eLGPersistenceUnit"></property>
        <property name="loadTimeWeaver">
            <bean class="org.springframework.instrument.classloading.SimpleLoadTimeWeaver"/>
        </property>
    </bean>

    <!-- Jpa adapter for the Hibernate -->
    <bean id="jpaAdapter"
          class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"
          p:databasePlatform="org.hibernate.dialect.MySQLDialect"
          p:generateDdl="true"
          p:showSql="true"  >
    </bean>

    <bean
            class="org.springframework.context.annotation.CommonAnnotationBeanPostProcessor"/>

    <bean
            class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor"/>
</beans> 
```

持久性.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
             xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="eLGPersistenceUnit"
                      transaction-type="RESOURCE_LOCAL">
    <!--transaction-type="JTA">-->
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <properties>
            <property name="hibernate.hbm2ddl.auto" value="validate"/>
        </properties>
        <!--<provider>org.hibernate.ejb.HibernatePersistence</provider>-->
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:46:57.410

我认为您的配置没有问题，请在删除“default-lazy-init=true”属性后尝试

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:53:57.597

尝试改变：

```
<property name="hibernate.hbm2ddl.auto" value="validate"/> 
```

到：

```
<property name="hibernate.hbm2ddl.auto" value="update"/> 
```

或者：

```
<property name="hibernate.hbm2ddl.auto" value="create"/> 
```

# java - Guice 和非单例 Servlet

> ID：12308053
> 
> 赞同：0
> 
> 时间：2012-09-06T20:41:04.663
> 
> 标签：java, jakarta-ee, servlets, guice, guice-servlet

我们如何在 Guice 中使用非单例 servlet 或处理程序，例如，我想为每个请求创建新实例并在处理请求后立即将其销毁或将其提供给垃圾收集器。

我不想将 ii 作为单例保存在内存中，也不想重用于其他未来的请求。

我认为可能以某种方式通过使用 bind() 函数，

RGDS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:42:01.627

你试过@SessionScoped 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:57:25.523

您想[使用 RequestScope](http://code.google.com/p/google-guice/wiki/Scopes)。

我通常使用具有范围的提供程序方法，因此您的代码看起来像

```
public class FooModule extends AbstractModule {
  @Override protected void configure() {
    // set up bindings
  }

  @Provides
  @RequestScoped
  PerRequestObject providePerRequestObject() {
    return new PerRequestObject(...);
  }
} 
```

一定要[安装`ServletModule`](http://code.google.com/p/google-guice/wiki/ServletModule)和[设置，`GuiceFilter`](http://code.google.com/p/google-guice/wiki/Servlets)否则这将不起作用！

# ios - iOS UIWebView 无法正确呈现外语

> ID：12308061
> 
> 赞同：3
> 
> 时间：2012-09-06T20:42:06.250
> 
> 标签：ios, uiwebview

我有一个 UIWebView，我在其中显示了一个带有外语内容（在本例中为法语）的 HTML 文件，该文件由谷歌翻译。

英文原文是：

> 清除 - 用于停止所有计时器并清除视图最右侧显示的数量。

谷歌的翻译是这样的：

> Effacer - permet d'arrêter toutes les minuteries et effacer les montants indiqués à l'extrême droite de la vue。

这是当法语是本地化语言时 iPhone 模拟器中显示的内容： ![在 UIWebView 中呈现法语翻译](../Images/a70b2d55c87f8ff3c951a449d8e1aa1f.png)

这是我用来加载它的代码：

```
//  determine what the language for this locale is...
NSString *sysLangCode = [[NSLocale preferredLanguages] objectAtIndex:0];

//  contatenate the language code to the filename
NSURL *indexURL = [[NSBundle mainBundle] URLForResource: [NSString stringWithFormat:@"instRST-%@", sysLangCode]
                withExtension:@"html"];

//  load it...
[webView loadRequest:[NSURLRequest requestWithURL:indexURL]]; 
```

我查看了 Google、SO 和 UIWebView 以找到可以正确渲染的任何设置。使用的字体是 Verdana。

我该怎么做才能正确渲染？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-06T21:33:36.267

我找到了答案：见[http://webdesign.about.com/od/localization/l/blhtmlcodes-fr.htm](http://webdesign.about.com/od/localization/l/blhtmlcodes-fr.htm)

这是您必须用于法语和其他单字符语言的元标记：

```
<meta http-equiv="content-type" content="text/html;charset=utf-8"> 
```

这适用于所有语言，包括双字符语言，如日语和中文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:57:51.120

尝试将您的 html 加载到字符串中（您必须知道文件的编码）

```
NSString *indexPath = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"instRST-%@", sysLangCode] ofType:@"html"];
// use correct encoding
NSString *content = [NSString stringWithContentsOfFile:indexPath encoding:NSUTF8StringEncoding error:nil];
[webView loadHTMLString:content baseURL:nil]; 
```

# ruby-on-rails - 在多对多关系中删除不是对称的？

> ID：12308065
> 
> 赞同：3
> 
> 时间：2012-09-06T20:42:19.010
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有两个模型，产品和类别，以及一个连接表，分类，用于多对多关系。

假设我有两个对象，产品和类别，它们是上述的实例。

```
products = Product.new(...)
category = Category.new(...)
product.categories << category 
```

这成功地在 rails 控制台中创建了两个方向的关系，因此：

```
product.categories
category.products 
```

都是非空的。下一个：

```
product.categories.delete category 
```

将从产品对象和连接表中删除值。但是它*不会*从类别对象中删除它，因此：

```
category.products 
```

是非空的，这意味着内存中的 category.products 对象与实际数据库不同步。对我来说，创建会对称地工作但删除不会，这似乎很奇怪。

以下是相关型号：

```
class Product < ActiveRecord::Base
  has_many :categorizations, dependent: :destroy
  has_many :categories, through: :categorizations, :uniq => true
end

class Category < ActiveRecord::Base
  has_many :categorizations, dependent: :destroy
  has_many :products, through: :categorizations, :uniq => true
end

class Categorization < ActiveRecord::Base
  belongs_to :product, class_name: "Product"
  belongs_to :category, class_name: "Category"

  validates :product, presence: true
  validates :category, presence: true
end 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T12:42:09.390

Answer: it's product.reload

This explanation is the first one I've found after hours searching: [https://stackoverflow.com/a/7449957/456280](https://stackoverflow.com/a/7449957/456280)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:11:35.187

The behavior you're observing is the way Rails is designed to behave. See the [Rails Guide on associations](http://guides.rubyonrails.org/association_basics.html)

You might also want to look at the section on has_and_belongs_to_many (HABTM) associations. HABTM would let you get rid of your explicit Categorization model if renamed the join table categories_products.

# php - PHP 原生扩展

> ID：12308066
> 
> 赞同：0
> 
> 时间：2012-09-06T20:42:37.173
> 
> 标签：php, php-extension

我有一组类和方法，我希望可以在给定系统上通过任何 PHP 使用访问它们，并且希望将其打包为扩展，即使它不是用 C 编写的。类和方法也被打包使用一两个`SUID`设置了位的 shell 脚本。无论`DOCUMENT_ROOT`.

从我读过的`auto_prepend`选项来看，`php.ini`或者`.htaccess`似乎是唯一的选项。有一个更好的方法吗？如果我使用自动前置（包括或需要我假设会导致自动前置再次触发的文件），我会遇到重新声明问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:45:34.297

Have a look at namespaces! You can put all your classes in the same namespace, without interfering with the rest of the system.

Do not try to build a extension, if you want to package your library, have a look at [PHAR](http://php.net/manual/en/book.phar.php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:46:43.560

将您的类/文件放在服务器上的某个位置，并设置`php.ini`'s`include_path`以包括这些文件的位置。或者，正如您所说，您可以使用`auto_prepend_file`强制执行，但如果您不使用命名空间，这是**非常糟糕的想法。**迟早你会面临名称冲突。仍然不确定为什么不将所有内容转换为类并使用[自动加载](http://php.net/manual/en/language.oop5.autoload.php)。

# ios - 如何让地图丢针 - iOS 5

> ID：12308067
> 
> 赞同：1
> 
> 时间：2012-09-06T20:42:37.793
> 
> 标签：ios, google-maps

以下代码以正确的位置和正确的缩放打开地图应用程序，但是如何让地图在该确切位置放置一个图钉？

```
 [[UIApplication sharedApplication] openURL: [NSURL URLWithString:
                                             [NSString stringWithFormat:@"http://maps.google.com/maps?ll=%f,%f&z=%d",
                                              self.latitude,
                                              self.longitude,
                                              17]] ]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:48:31.837

尝试基于查询的链接：

> [http://maps.google.com/maps?q=asdsad@%f,%f&z=%d](http://maps.google.com/maps?q=asdsad@%f,%f&z=%d)

例子：

> [http://maps.google.com/maps?q=aplace@12,13&z=5](http://maps.google.com/maps?q=aplace@12,13&z=5)

# sql-server - Sql Server 作为日志记录，最佳连接实践

> ID：12308070
> 
> 赞同：0
> 
> 时间：2012-09-06T20:42:47.527
> 
> 标签：sql-server, logging, ado.net

我正在使用 SqlServer 作为日志记录。是的，这是错误的决定，有更好的数据库来满足这个要求。但我目前没有其他选择。

记录间隔为每秒 3 个记录。

所以我有静态 Logger 类，它有静态 Log 方法。

使用“打开连接”作为静态成员对性能更好。但它的最佳实施是什么？

这不是我知道的。

```
public static class OzzLogger
{
    static SqlConnection Con;

    static OzzLogger()
    {
       Con=ne SqlConnection(....);
       Con.Open();  
    }

    public static void Log(....)
    {
       Con.ExecuteSql(......);
    }
} 
```

**更新**

我问是因为我的旧信息。人们说“连接池性能就足够了”。如果没有异议，我将关闭这个问题:)

# eclipse - 在 p2 存储库生成后更新插件

> ID：12308071
> 
> 赞同：0
> 
> 时间：2012-09-06T20:42:57.960
> 
> 标签：eclipse, eclipse-plugin

当我在生成 p2 后构建我的产品时，我会更新我的品牌插件。在品牌插件中，我更改了一些仅在 p2 生成后可用的信息，例如 plugin.properties 中的版本。结果，当我想更新产品的先前版本时，我收到有关 md5 不匹配的错误，因为 p2 中插件的 md5 与生成的不同。在这种情况下，一个快速的解决方法是编辑 artifacts.jar 中的 artifacts.xml 以删除已更改插件的“download.md5”属性。这是手动过程，如果可能，我想避免它。我可以指示某处不要生成“download.md5”，或者在我进行修改后重新生成它的值吗？也许还有其他解决方案？

我当然可以自动化手动过程并打开 artifacts.jar 并修改 artifacts.xml，但想知道我是否可以避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:22:33.377

找到了解决方案，我需要在更改插件数据后调用 p2.process.artifacts 来重建 p2。

# xslt - 使用 xsl:for-each 迭代使用复杂的 xsl:template 定义

> ID：12308073
> 
> 赞同：0
> 
> 时间：2012-09-06T20:43:09.697
> 
> 标签：xslt, xpath

我想要做的是通过循环遍历每个元素，按位置提取数据，然后对它们执行 XSLT 来使用元素`call-template:SpecialRadio`。`Radio`出于某种原因，单选按钮出现了，但没有显示`Caption`数据`StaticLabel`，即“Postanschrift”和“SMS / MMS”。我的 XSL 哪里出错了？

**给定 jsp-include.xsl**

```
<xsl:template name="SpecialRadio">      
        <xsl:param name="name"/>
        <xsl:param name="map"/>
        <xsl:param name="radio"/>
        <xsl:param name="radioStyle"/>
        <xsl:param name="radioLabel"/>
        <xsl:param name="i"/>

    <StaticLabel>
        <xsl:attribute name="style">
          <xsl:copy-of select="$radioStyle[position()=$i]/@style"/>
          <xsl:text>; margin-left:500px</xsl:text>
        </xsl:attribute>
        <xsl:copy-of select="$radioLabel[position()=$i]/@Caption"/>
    </StaticLabel>

    <Radio>                             
           <ReadOnly>false</ReadOnly>                                                                   
           <Map rtexprvalue="true">mb.getLookup("YES_NO")</Map>
           <Name rtexprvalue="true"><xsl:value-of select="$radio/Name"/></Name>
           <Default rtexprvalue="true">mb.getValue("<xsl:value-of select="Name"/>")/Default>
        </Radio>
</xsl:template> 
```

**给定 Main.xsl**

```
<div id="head">
    <xsl:call-template name="JspInclude">
            <xsl:with-param name="flush" select="'true'"/>
        <xsl:with-param name="file" select="'Header_1_D.jsp'"/>
    </xsl:call-template>

    <xsl:for-each select="$radio[position() &lt;= 4]">
    <xsl:call-template name="SpecialRadio">
                <xsl:with-param name="i" select="position()"/>
            <xsl:with-param name="name" select="FieldList[@group='2']/Radio/Name"/>
                 <xsl:with-param name="map" select="FieldList[@group='2']/Radio/Map"/>
            <xsl:with-param name="radio" select="FieldList[@group='2']/Radio"/>
            <xsl:with-param name="radioStyle" select="FieldList[@group='2']/StaticLabel"/>
        <xsl:with-param name="radioLabel" select="FieldList[@group='2']/StaticLabel"/>
</xsl:call-template> 
```

**给定 XML**

```
<FieldList group="2">
        <StaticLabel style="font-family:Arial;color:#330000;font-size:9pt">
            <Caption><![CDATA[Postanschrift]]></Caption>
            <Name><![CDATA[APPLICATION_CUSTOMER.APPLICATION_TYPE]]></Name>
        </StaticLabel>
        <Radio>
            <EntityID><![CDATA[6100]]></EntityID>
            <Name><![CDATA[APPLICATION_CUSTOMER.APPLICATION_TYPE]]></Name>
            <FieldType><![CDATA[]]></FieldType>
            <Default rtexprvalue="true"><![CDATA[mb.getValue("APPLICATION_CUSTOMER.APPLICATION_TYPE", "")]]></Default>
            <Map rtexprvalue="true"><![CDATA[mb.getLookup("YES_NO", "CODE", "NAME", "EN", false,"")]]></Map>
            <ReadOnly rtexprvalue="true"><![CDATA[mb.isReadonly(2)]]></ReadOnly>
            <AccessType><![CDATA[2]]></AccessType>
            <SearchMatchFlag><![CDATA[]]></SearchMatchFlag>
            <InvalidatePlanFlag><![CDATA[false]]></InvalidatePlanFlag>
        </Radio>
        <StaticLabel style="font-family:Arial;color:#330000;font-size:9pt">
            <Caption><![CDATA[SMS / MMS]]></Caption>
            <Name><![CDATA[APPLICATION_CUSTOMER.APPLICATION_TYPE]]></Name>
        </StaticLabel>
        <Radio>
            <EntityID><![CDATA[6101]]></EntityID>
            <Name><![CDATA[APPLICATION_CUSTOMER.APPLICATION_TYPE]]></Name>
            <FieldType><![CDATA[]]></FieldType>
            <Default rtexprvalue="true"><![CDATA[mb.getValue("APPLICATION_CUSTOMER.APPLICATION_TYPE", "")]]></Default>
            <Map rtexprvalue="true"><![CDATA[mb.getLookup("YES_NO", "CODE", "NAME", "EN", false,"")]]></Map>
            <ReadOnly rtexprvalue="true"><![CDATA[mb.isReadonly(2)]]></ReadOnly>
            <AccessType><![CDATA[2]]></AccessType>
            <SearchMatchFlag><![CDATA[]]></SearchMatchFlag>
            <InvalidatePlanFlag><![CDATA[false]]></InvalidatePlanFlag>
        </Radio>        
    </FieldList> 
```

**使用 Altova 生成的 XSLT**

```
<div id="head">
        <HtmlCode xmlns:jsp="http://www.microforum.com/calms/tags/jsptag-1">
            <jsp:include flush="true" page="Header_1_D.jsp"/>
        </HtmlCode>
        <StaticLabel xmlns:jsp="http://www.microforum.com/calms/tags/jsptag-1" style="; margin-left:500px"/>
        <Radio xmlns:jsp="http://www.microforum.com/calms/tags/jsptag-1">
            <ReadOnly>false</ReadOnly>
            <Map rtexprvalue="true">mb.getLookup("YES_NO")</Map>
            <Name rtexprvalue="true"/>
            <Default rtexprvalue="true">mb.getValue("APPLICATION_CUSTOMER.APPLICATION_TYPE")</Default>
        </Radio>
        <StaticLabel xmlns:jsp="http://www.microforum.com/calms/tags/jsptag-1" style="; margin-left:500px"/>
        <Radio xmlns:jsp="http://www.microforum.com/calms/tags/jsptag-1">
            <ReadOnly>false</ReadOnly>
            <Map rtexprvalue="true">mb.getLookup("YES_NO")</Map>
            <Name rtexprvalue="true"/>
            <Default rtexprvalue="true">mb.getValue("APPLICATION_CUSTOMER.APPLICATION_TYPE")</Default>
        </Radio>
        <HtmlCode>
            <br/>
            <br/>
            <br/>
        </HtmlCode>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:21:19.317

不应该是这样的——

```
<xsl:copy-of select="$radioLabel[position()=$i]/Caption"/> 
```

因为 Caption 是一个元素，而不是一个属性？

# php - 在表单中创建一个黑名单过滤器以避免某些单词

> ID：12308078
> 
> 赞同：1
> 
> 时间：2012-09-06T20:44:07.417
> 
> 标签：php, javascript, input, filter

我需要创建一个过滤器以避免将某些网站提交到我的数据库。我想这样做是为了保护我的网站内容免受垃圾邮件发送者的侵害。

我有一个用于发送 URL 的常规表单输入文本，我需要一些帮助来创建一个后台操作（可能在 php 中），以检查用户尝试发送的这个 URL 是否有一些列入黑名单的单词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:51:08.887

您可能希望存储正则表达式列表（在数据库中，或在文件中硬编码 - 无论您发现使用哪种更方便且长期灵活）。

`preg_filter`然后只需使用或类似的正则表达式过滤输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:45:25.357

You probably want to look into preg_match

[http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)

# jquery - jquery 与 jquery 的兼容性验证旧版本

> ID：12308079
> 
> 赞同：1
> 
> 时间：2012-09-06T20:44:09.443
> 
> 标签：jquery, validation

我正在使用 jquery validate v1.7 和 jQuery v1.4.2，我必须在 blur 和 onkeyup 事件上使用 .live。这些事件似乎不适用于这些版本。任何关于如何处理带有这些约束的 onkeyup 和 blur 事件的解决方案都会有所帮助。

注意：我将无法将这些版本更新到可用的最新版本，因为多个团队正在使用这些文件的旧版本并且他们不想升级到最新版本。

Jquery 验证调用：

```
onkeyup: function(element){
    C.options.throwMessages(element); 
```

},

```
throwMessages: function(el){

                            if($(el).attr('name') === "email"){ //Validating email field
                                var selectedField = $(el);
                                var emailValid = C.options.simple_validate_email(selectedField);

                                if (C.options.pageName === 'login' || C.options.pageName === 'register'){
                                        $(C.options.currentPage).find(':submit').click(function(){
                                            var selectedField = $(C.options.currentPage).find('input.email');
                                            if(!selectedField.val().length){
                                                            selectedField.removeClass('errorIndicator');
                                            }
                                        });
                                }

                                if(C.options.pageName === "register"){
                                            selectedField.live('blur', function(){
                                                if($(this).val().length === 0){
                                                    $(this).parent().parent().removeClass('aimValid');  
                                                }
                                            });

                                            selectedField.live('keydown focusout', function(event) {
                                                        if(event.type == 'keydown'){
                                                            if(!C.options.simple_validate_email($(this))){
                                                                $(this).parent().parent().removeClass('aimValid');
                                                                $(C.options.currentPage).find('.emailTip').show().html('Please enter a valid email address.');
                                                            }else{
                                                                $(this).removeClass('errorIndicator');
                                                                $(C.options.currentPage).find('.emailTip').hide().html('');
                                                            }

                                                        }else if(event.type == 'focusout'){

                                                                if(!C.options.simple_validate_email($(this))){

                                                                }else{
                                                                    $(this).removeClass('errorIndicator');
                                                                    $(C.options.currentPage).find('.emailTip').hide().html('');
                                                                }

                                                            }   

                                            });

                                    }

                            }else if($(el).attr('name') === "password"){//Validating password field
                                var selectedPasswordField = $(el);
                                    if(C.options.pageName === "register"){
                                                //password field
                                                selectedPasswordField.live('keydown', function(){
                                                    if($(this).val().length === 0){
                                                        $(this).parent().parent().removeClass('aimValid');  
                                                        $(this).removeClass('aimError');
                                                    }
                                                });
                                        }
                            }else if($(el).attr('name') === "username2"){//Validating email field on ForgotPassword screen
                                var selectedField = $(el);
                                if (C.options.pageName === 'forgotPassword') {
                                            var isFormValid = false;
                                            $(C.options.currentPage).find(':submit').click(function(){
                                                        if((selectedField.val().length === 0) || !selectedField.parent().parent().find('div.aimError').length){
                                                                    isFormValid = true;
                                                        }
                                                selectedField.live('keydown focusout', function(event){
                                                        if(event.type === 'keydown'){
                                                                $(C.options.currentPage).find('.emailTip').hide().html('');

                                                        }else{
                                                                $(C.options.currentPage).find('.emailTip').hide().html('');
                                                        }                                               
                                                });

                                                    if (isFormValid) {
                                                        $(C.options.currentPage).find('.emailTip').show().html('Please enter a valid email address.');
                                                    }else{
                                                        $(C.options.currentPage).find('.emailTip').hide().html('');
                                                    }

                                            });

                                    }
                            }

                        }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:02:52.033

`.live()`已在所有版本的 jQuery 中被弃用。对于 1.4，您可以`.delegate()`这样使用：

```
$("#container").delegate("#test", "keyup keydown focusout", function(e) {
    log(e.type + " event");
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/WxqwS/](http://jsfiddle.net/jfriend00/WxqwS/)

* * *

对于 1.7，您可以使用`.on()`which 几乎相同，`.delegate()`只是参数的顺序更符合逻辑：

```
$("#container").on("keyup keydown focusout", "#test", function(e) {
    log(e.type + " event");
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/FULfe/](http://jsfiddle.net/jfriend00/FULfe/)

# c# - 向 ASP 控件添加自定义事件

> ID：12308080
> 
> 赞同：3
> 
> 时间：2012-09-06T20:44:22.160
> 
> 标签：c#, javascript, asp.net, event-handling

我正在使用 ASP 和 C# 构建一个网站，我想知道是否可以将自定义事件添加到 asp 控件。

我想将 OnClick、OnMouseDown、OnMouseUp（等）事件添加到`<asp:image>`.

是否可以？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:35:57.993

是的，你可以这样做。

**HTML**

```
 <asp:Image runat="server" ID="Image1"  /> 
```

**代码背后**

```
 protected void Page_Load(object sender, EventArgs e){

        this.Image1.Attributes.Add("onmouseup", "alert('this is the OnMouseUp event')");

    } 
```

**编辑**

```
 It can be do it using DHTML but as you may know 
  DHTML is the art of combining HTML, JavaScript, DOM, and CSS.

  protected void Page_Load(object sender, EventArgs e){
        //change the Image Url when the click event fire
        this.Image1.Attributes.Add("onclick", "this.src='image1.jpg'");

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:11:06.210

请注意，在服务器上处理鼠标事件可能不切实际，最好在客户端本地（更快）处理它们，因此网络速度不会影响您的事件处理速度。

# android - Android First App教程不起作用

> ID：12308083
> 
> 赞同：1
> 
> 时间：2012-09-06T20:44:39.227
> 
> 标签：android

我正在按照 Android 开发人员教程构建第一个应用程序。我完全按照它所说的一步一步完成了这个页面： [https ://developer.android.com/training/basics/firstapp/starting-activity.html](https://developer.android.com/training/basics/firstapp/starting-activity.html)

在这里，我得到了许多与 Java 相关的错误：

```
Description                               Resource             Path                             Location    Type
View cannot be resolved to a type   MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 24 Java Problem
Intent cannot be resolved to a type MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 25 Java Problem
Intent cannot be resolved to a type DisplayMessageActivity.java /MyFirstApp/src/com/example/myfirstapp  line 16 Java Problem
TextView cannot be resolved to a type   DisplayMessageActivity.java /MyFirstApp/src/com/example/myfirstapp  line 20 Java Problem
TextView cannot be resolved to a type   DisplayMessageActivity.java /MyFirstApp/src/com/example/myfirstapp  line 20 Java Problem
Intent cannot be resolved to a type MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 25 Java Problem
EditText cannot be resolved to a type   MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 26 Java Problem
EditText cannot be resolved to a type   MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 26 Java Problem
edit_message cannot be resolved or is not a field   MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 26 Java Problem 
```

请问有什么帮助吗？

编辑：@pawalzieba 好的，现在我只收到以下 3 个错误：

```
Description Resource    Path    Location    Type
edit_message cannot be resolved or is not a field   MainActivity.java   /MyFirstApp/src/com/example/myfirstapp  line 29 Java Problem
error: Error: No resource found that matches the given name (at 'hint' with value '@string/edit_message').  activity_main.xml   /MyFirstApp/res/layout  line 6  Android AAPT Problem
error: Error: No resource found that matches the given name (at 'text' with value '@string/button_send').   activity_main.xml   /MyFirstApp/res/layout  line 11 Android AAPT Problem 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T08:35:38.610

```
error: Error: No resource found that matches the given name (at 'hint' with value '@string/edit_message').  activity_main.xml   /MyFirstApp/res/layout  line 6  Android AAPT Problem
error: Error: No resource found that matches the given name (at 'text' with value '@string/button_send').   activity_main.xml   /MyFirstApp/res/layout  line 11 Android AAPT Problem 
```

尝试添加到strings.xml：

```
<string name="edit_message">Enter a message</string>
<string name="button_send">Send</string> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:55:50.737

在Eclipse中：右键单击Package Explorer选项卡中的项目->对话框中的“属性”->左侧菜单中的“Java构建路径”->“源”选项卡

在那里您可以更改源文件夹。将其设置为指向项目中的 src 文件夹。

* * *

编辑

java 文件中缺少导入。在 Eclipse 中按此快捷键**Ctrl+Shift+O**来组织导入。

# c# - The best way to display repeated data in ASP.Net?

> ID：12308090
> 
> 赞同：0
> 
> 时间：2012-09-06T20:45:19.837
> 
> 标签：c#, asp.net, html

I have an ASP.Net web page that displays various chunks of data based on a user's search string. In this web page I'm using a `<Panel>` tag because I need to have a vertical scrollbar that displays when needed to display all of the data.

I've thought about defining an HTML page (in code behind, with all the tags and data included), and displaying that inside a `<div>`, inside the `<Panel>`.

I've also explored the possibility of displaying an ASP.Net web page with the data/tags/etc. and placing each page in its own `<Iframe>` element. I'm afraid that this solution would be slow to load (as compaired to the HTML method described above) especially when there's 100's of individual pages to be loaded.

My question is what's the best way to display N number of individual pages of data and have a vertical scrollbar when there's a need?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:03:07.227

我想，在 ASP.NET 页面上显示各种数据片段是一个大主题，可以使用许多方法，包括您提到的那些。

如何使用动态数据框架 .NET v2、3、4。最强大的当然是最新的。

然后，您不需要创建 100 个单独的页面，只需使用模型/上下文中使用的元表名称进行动态重定向。您的所有数据也将在适当的地方完美链接。还需要根据需要呈现的数据仔细设计模型。其控件可以是 GridView 或其他，但都在服务器端完成。

# asp.net - ASP.NET CustomError 重定向 404 在 Fiddler 中不返回 404 代码

> ID：12308091
> 
> 赞同：1
> 
> 时间：2012-09-06T20:45:21.647
> 
> 标签：asp.net, web-config

如何让它返回错误代码为 404 的自定义 ASP.NET 页面？目前，当我设置

```
<customErrors mode="On">
            <error statusCode="404" redirect="~/UtahDisclosures.aspx" />
        </customErrors> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:22:42.950

这似乎是 ASP.NET 的一个怪癖，在阅读您的帖子之前我并不知道。

然而，一个快速的谷歌出现了这篇博文：[http ://www.digitallycreated.net/Blog/57/getting-the-correct-http-status-codes-out-of-asp.net-custom-error-pages](http://www.digitallycreated.net/Blog/57/getting-the-correct-http-status-codes-out-of-asp.net-custom-error-pages)

他们似乎知道他们在做什么，并建议使用这个： `<% Response.StatusCode = (int)HttpStatusCode.NotFound; %>`以及其他一些关键步骤（参见链接）。

此外，在发送自定义错误页面时，您可能需要记住这个[IE 最小错误页面大小的怪癖](http://perishablepress.com/important-note-for-your-custom-error-pages/ "IE 怪癖")。

# sql - Loading missing lookup records in the drop down

> ID：12308096
> 
> 赞同：0
> 
> 时间：2012-09-06T20:45:43.907
> 
> 标签：sql, .net, metadata, lookup

I have employee data capture application. .net and t-sql.

It has number of lookup(metadata) tables which used to populate drop downs in the UI. ex: "Departments". Every lookup table has active flag. Sometimes this flag set to false. This means I should not load those inactive “Departments” in the drop down. This perfectly works for ADD NEW EMPLOYEE scenario. But in EDIT EMPLOYEE scenario, if one lookup record (Department-HR) happens to be inactive but associated with the EMPLOYEE for some reson, I have a problem that the Department-HR is missing in the drop down to select.

I know question looks silly. I can pass EmployeeId and load Active + all associated departments to EmployeeId, but I want to know a smarter and cleaner way to handle the situation.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:57:38.437

一种方法是防止删除一个部门，如果它首先被员工使用。如果他们在可能导致员工数据无效的时候被通知问题，这对用户会更有帮助。

如果您的数据库中有一个`Employees`and`Departments`表（具有一对多或多对多关系），那么您将配置适当的外键。如果您实际上是从`Departments`表中删除部门行（而不是将它们标记为非活动），那么如果有任何员工记录引用正在删除的部门，那么显然您会遇到外键违规。

如果您将部门标记为“非活动”，那么当用户尝试将其标记为非活动时，您的 UI 可能会显示引用该部门的员工列表。然后可以为他们提供一个 UI，用于将员工分配到另一个部门。

无论哪种方式，我都不确定为什么您有专门用于填充部门下拉列表的表格？为什么不`Departments`直接从表中填充？添加新员工界面和编辑员工界面可以查询得到所有活跃部门的列表，编辑界面还可以查看员工当前部门的活跃状态，然后在用户进入时提示用户重新分配员工编辑屏幕。

# javascript - Onclick 不触发...可能的 javascript 语法问题

> ID：12308097
> 
> 赞同：0
> 
> 时间：2012-09-06T20:45:51.877
> 
> 标签：javascript

我试图让 onclick 触发，但它不会，现在已经尝试了几个小时。

任何人都可以看到以下代码有任何问题吗？

```
output += '<li><a href="#" onclick="window.plugins.childBrowser.showWebPage('http://www.google.com',{ showLocationBar: true });">link</a></li>'; 
```

我觉得这与某处的语法有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:47:18.100

你的引号有问题。看看错误控制台，我确定它在对你大喊大叫。

你需要用一个来逃避`\`

```
output += '<li><a href="#" onclick="window.plugins.childBrowser.showWebPage(\'http://www.google.com\',{ showLocationBar: true });">link</a></li>'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T20:47:33.450

查看您自己帖子的颜色编码。显然，您需要转义字符串中的单引号。

```
output += '<li><a href="#" onclick="window.plugins.childBrowser.showWebPage(\'http://www.google.com\',{ showLocationBar: true });">link</a></li>'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T20:47:48.683

您在`'`-delimited 字符串中有一个`'`-delimited 字符串。你需要逃避内部`'`：

```
output += '<li><a href="#" onclick="window.plugins.childBrowser.showWebPage(\'http://www.google.com\',{ showLocationBar: true });">link</a></li>'; 
```

# c# - Console.Read() and Console.ReadLine() problems

> ID：12308098
> 
> 赞同：6
> 
> 时间：2012-09-06T20:45:56.243
> 
> 标签：c#, .net, console-application

I have been trying to use Console.Read() and Console.ReadLine() in C# but have been getting weird results. for example this code

```
Console.WriteLine("How many students would you like to enter?");
int amount = Console.Read();
Console.WriteLine("{0} {1}", "amount equals", amount);

for (int i=0; i < amount; i++)
{
     Console.WriteLine("Input the name of a student");
     String StudentName = Console.ReadLine();
     Console.WriteLine("the Students name is " + StudentName);
} 
```

has been giving me that amount = 49 when I input 1 for the number of students, and Im not even getting a chance to input a student name.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-06T20:48:01.203

这是因为您阅读了一个字符。使用类似的适当方法`ReadInt32()`可以将读取的符号正确转换为您想要的类型。

你得到的原因`49`是因为它是'1'符号的字符代码，而*不是*整数表示。

```
char     code
0 :      48
1 :      49
2:       50
...
9:       57 
```

例如：`ReadInt32()`可能看起来像这样：

```
public static int ReadInt32(string value){
      int val = -1;
      if(!int.TryParse(value, out val))
          return -1;
      return val;
} 
```

并像这样使用：

```
int val = ReadInt32(Console.ReadLine()); 
```

有可能创建一个 真的很好`extension method`，但不幸的是，不可能在静态类型上创建扩展方法，并且[Console](http://msdn.microsoft.com/en-us/library/system.console.aspx)是一种`static`类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T20:50:38.377

尝试以这种方式更改您的代码

```
int amount;
while(true)
{
    Console.WriteLine("How many students would you like to enter?"); 
    string number = Console.ReadLine(); 
    if(Int32.TryParse(number, out amount))
        break;
}
Console.WriteLine("{0} {1}", "amount equals", amount); 
for (int i=0; i < amount; i++) 
{ 
    Console.WriteLine("Input the name of a student"); 
    String StudentName = Console.ReadLine(); 
    Console.WriteLine("the Students name is " + StudentName); 
} 
```

而不是使用`Read`use`ReadLine`然后检查用户输入是否真的是使用`Int32.TryParse`. 如果用户未输入有效数字，请重复该问题。
使用`Console.Read`会将您的输入限制为需要转换并检查为有效数字的单个字符。

当然，这是一个残酷的例子，没有任何错误检查或任何类型的循环安全中止。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-03T01:50:21.727

对于可能仍然需要这个的人：

```
static void Main(string[] args)
{
     Console.WriteLine("How many students would you like to enter?");
     var amount = Convert.ToInt32(Console.ReadLine());

     Console.WriteLine("{0} {1}", "amount equals", amount);

     for (int i = 0; i < amt; i++)
     {
         Console.WriteLine("Input the name of a student");
         String StudentName = Console.ReadLine();
         Console.WriteLine("the Students name is " + StudentName);
     }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T20:54:35.350

`char`你从读取而不是 int 中得到一个字符。您需要先将其设为字符串并将其解析为字符串。实现可能如下所示

```
 Console.WriteLine("How many students would you like to enter?");
    var read = Console.ReadLine();
    int amount;
    if(int.TryParse(read,out amount)) {
      Console.WriteLine("{0} {1}", "amount equals", amount);

      for (int i=0; i < amount; i++)
      {
        Console.WriteLine("Input the name of a student");
        String StudentName = Console.ReadLine();
        Console.WriteLine("the Students name is " + StudentName);
      }
    } 
```

我已将其更改为使用 readline，因为 readline 返回一个字符串，并且不会任意将学生人数限制为 9（一位数的最大人数）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-12T15:18:59.560

```
Console.WriteLine("How many students would you like to enter?");
string amount = Console.ReadLine();
int amt = Convert.ToInt32(amount);

Console.WriteLine("{0} {1}", "amount equals", amount);

for (int i = 0; i < amt; i++)
{
    Console.WriteLine("Input the name of a student");
    String StudentName = Console.ReadLine();
    Console.WriteLine("the Students name is " + StudentName);
}
//thats it 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T20:57:58.110

`Console.Read`返回按下的键字符的 asci 值。

如果你使用`Console.ReadKey().KeyChar`你会得到一个`char`代表被按下的实际字符。

然后，您可以使用 将该字符转换为一个字符串`.ToString()`。

现在您有了一个字符串，您可以使用`int.Parse`或`int.TryParse`将包含完全数字字符的字符串转换为整数。

所以把它们放在一起：

```
int value;
if (int.TryParse(Console.ReadKey().KeyChar.ToString(), out value))
{
    //use `value` here
}
else
{
    //they entered a non-numeric key
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-06T20:56:03.427

代替：

```
int amount = Console.Read(); 
```

尝试：

```
int amount = 0;
int.TryParse(Console.ReadLine(), out amount); 
```

这是因为您只读取了字符代码，因此例如键入 11 您仍然会得到 49。您需要读取字符串值并将其解析为 int 值。在输入错误的情况下使用上面的代码您将得到 0。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-06T20:49:25.150

`Console.Read()`正在返回您输入的字符的字符代码。您需要使用`Convert.ToChar(amount);`来获取字符作为字符串，然后您需要`int.Parse()`获取您正在寻找的值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-06T10:57:07.213

尝试这个：

```
int amount = ReadInt32(); 
```

或者如果它不起作用，试试这个：

```
int amount = Console.ReadInt32(); 
```

或这个：

```
int amount = Convert.ToInt32(Console.Readline()); 
```

在此，它将读取字符串，然后将其转换为 Int32 值。

你也可以去这里：[http ://www.java2s.com/Tutorials/CSharp/System.IO/BinaryReader/C_BinaryReader_ReadInt32.htm](http://www.java2s.com/Tutorials/CSharp/System.IO/BinaryReader/C_BinaryReader_ReadInt32.htm)

如果没有任何效果，请告诉我。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-24T08:53:35.690

**TL;博士;** `Enter`Windows 中的键不是单个字符。`Console.Read()`这个事实是与方法相关的许多问题的根源。

**完整详细信息**：如果您在计算机上运行以下代码，那么您可以解决背后的许多谜团`Console.Read()`：

```
static void Main(string[] args)
{
    var c = Console.Read();
    Console.WriteLine(c);
    c = Console.Read();
    Console.WriteLine(c);
} 
```

运行程序时，`Enter`只需在键盘上按一次键，然后检查控制台上的输出。下面是它的外观：

[![在此处输入图像描述](../Images/58f213666b99c3ad13354f87c07b5912.png)](https://i.stack.imgur.com/zwt3Q.png)

有趣的是，您`Enter`只按了一次键，但它能够满足`Read()`我的代码片段中的两个调用。`Enter`Windows 中的 key 为换行符发出两个字符，即回车符（`\r`- ASCII 代码 13）和换行符（`\n`- ASCII 代码 10）。您可以在这篇文章中了解更多信息 - [Windows 回车符 \r\n 是由两个字符还是一个字符组成？](https://stackoverflow.com/q/7013034/465053)

# sql-server - t-sql：在多个条件下动态过滤 XML？

> ID：12308099
> 
> 赞同：1
> 
> 时间：2012-09-06T20:46:02.123
> 
> 标签：sql-server, xml, tsql

我试图找到一种方法来对 XML 字符串进行接受/拒绝，方法是将其加入条件表。我现在有一个“过滤器”正在工作，但想编写它以便它可以过滤 2 个或更多。

这是与两者之一匹配的代码。如果其中任何一个匹配，它将过滤字符串。我想要做的是使它必须匹配两者，同时仍然保留单一条件的选项

```
CREATE TABLE #filter (exclusion_type CHAR(1), excluded_value varchar(10))
INSERT INTO #filter VALUES ('B','boy')
INSERT INTO #filter VALUES ('C','cat')

DECLARE @data XML
SELECT @data = '<A><B>boy</B><C>cat</C></A>'
SELECT * FROM (SELECT CONVERT(VARCHAR(128),node.query('fn:local-name(.)')) AS NodeName, CONVERT(VARCHAR(MAX),node.query('./text()')) AS NodeValue
FROM @data.nodes(N'//*') T(node))xml_shred

IF NOT EXISTS 
(SELECT * FROM (SELECT CONVERT(VARCHAR(128),node.query('fn:local-name(.)')) AS NodeName, CONVERT(VARCHAR(MAX),node.query('./text()')) AS NodeValue
FROM @data.nodes(N'//*') T(node)) xml_shred
INNER JOIN #filter
ON   (nodename = exclusion_type AND nodevalue LIKE excluded_value)
)
select 'record would be inserted '
ELSE select 'record was filtered' 
```

这是我目前使用它来过滤两者的方法。丑陋且不可扩展。

```
IF NOT EXISTS 
(SELECT * FROM (SELECT CONVERT(VARCHAR(128),node.query('fn:local-name(.)')) AS NodeName, CONVERT(VARCHAR(MAX),node.query('./text()')) AS NodeValue
FROM @data.nodes(N'//*') T(node)) xml_shred
INNER JOIN #filter
ON   (nodename = exclusion_type AND nodevalue LIKE excluded_value)
)
--combination filters don't easily work within that xml_shred
and not(
        @data.value('(/A/B)[1]', 'varchar(128)') = 'boy'
        AND 
        @data.value('(/A/C)[1]', 'varchar(128)')='cat'
        )

select 'record would be inserted '
ELSE select 'record was filtered' 
```

我唯一的其他想法：

*   某种 GUID 将 #filter 表中的记录链接在一起，然后在 #filtertable 的 GROUP BY 上进行内部连接，按 GUID 分组并使用 SUM 来匹配记录数。
*   使用分号分隔 #filter 行，然后使用 CTE 或其他东西来伪造层次结构并从那里开始工作。

* * *

根据 Mikael 的建议进行的代码更改

```
CREATE TABLE #filter
    (
      exclusion_set SMALLINT,
      exclusion_type CHAR(1) ,
      excluded_value VARCHAR(10)
    )
INSERT  INTO #filter
VALUES  (1, 'B', 'boy')
INSERT  INTO #filter
VALUES  (1, 'C', 'cat')
INSERT  INTO #filter
VALUES  (2, 'D', 'dog' )

DECLARE @data XML
SELECT  @data = '<A><B>boy</B><C>cat</C></A>'
IF NOT EXISTS(
SELECT * FROM 
(
select COUNT(*) AS match_count, exclusion_set
              from #filter as F
              where exists (
                           select *
                           from (
                                select X.N.value('local-name(.)', 'varchar(128)') as     NodeName,
                                       X.N.value('./text()[1]', 'varchar(max)') as     NodeValue
                                from @data.nodes('//*') as X(N)
                                ) T
                           where T.NodeName = F.exclusion_type and
                                 T.NodeValue like F.excluded_value 
                           )
GROUP BY exclusion_set
) matches_per_set
INNER JOIN 
(SELECT COUNT(*) AS total_count, exclusion_set FROM #filter GROUP BY exclusion_set)     grouped_set
ON match_count = total_count
AND grouped_set.exclusion_set = matches_per_set.exclusion_set
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T06:05:22.547

```
if not exists (
              select *
              from #filter as F
              where exists (
                           select *
                           from (
                                select X.N.value('local-name(.)', 'varchar(128)') as NodeName,
                                       X.N.value('./text()[1]', 'varchar(max)') as NodeValue
                                from @data.nodes('//*') as X(N)
                                ) T
                           where T.NodeName = F.exclusion_type and
                                 T.NodeValue like F.excluded_value 
                           )
              having count(*) = (select count(*) from #filter)
              )
  select 'record would be inserted '
else
  select 'record was filtered' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T20:27:44.650

由于如果我不将某些内容标记为答案，我显然会感到厌烦，所以我从上面包括了我的。非常感谢对 Mikael Eriksson 的帮助。他的 XML shred 比我的快，并且通过添加“exclusion_set”字段（char(2) 以表明它不是 IDENTITY 或主键），我可以进行多项检查。如果集合中的所有条件都匹配，则过滤记录。

* * *

```
CREATE TABLE #filter
    (
      exclusion_set CHAR(2),
      exclusion_type CHAR(1) ,
      excluded_value VARCHAR(10)
    )
INSERT  INTO #filter
VALUES  ('aa', 'B', 'boy')
INSERT  INTO #filter
VALUES  ('aa', 'C', 'cat')
INSERT  INTO #filter
VALUES  ('ab', 'D', 'dog' )

DECLARE @data XML
SELECT  @data = '<A><B>boy</B><C>cat</C></A>'
IF NOT EXISTS(
SELECT * FROM 
(
select COUNT(*) AS match_count, exclusion_set
              from #filter as F
              where exists (
                           select *
                           from (
                                select X.N.value('local-name(.)', 'varchar(128)') as     NodeName,
                                       X.N.value('./text()[1]', 'varchar(max)') as     NodeValue
                                from @data.nodes('//*') as X(N)
                                ) T
                           where T.NodeName = F.exclusion_type and
                                 T.NodeValue like F.excluded_value 
                           )
GROUP BY exclusion_set
) matches_per_set
INNER JOIN 
(SELECT COUNT(*) AS total_count, exclusion_set FROM #filter GROUP BY exclusion_set)     grouped_set
ON match_count = total_count
AND grouped_set.exclusion_set = matches_per_set.exclusion_set

 )
select 'record would be inserted '
else
  select 'record was filtered' 
```

# macos - 在 Mac 上为 ActionScript 设置开发环境的好方法

> ID：12308100
> 
> 赞同：1
> 
> 时间：2012-09-06T20:46:02.560
> 
> 标签：macos, actionscript

这里有一个非常接近的问题：[在 mac 上的 actionscript development](https://stackoverflow.com/questions/2503998/actionscript-development-on-mac)。然而，答案是两年前的事了。问题下有评论要求更新，但没有得到回应。所以我在这里问。

在 MAC 上设置 ActionScript 开发环境有哪些好方法？如果安装了 Adob​​e CreativeSuite，那应该会给你一个完整的开发环境吗？如果是这样，为什么人们仍在询问 IDE？

我个人更喜欢 Vim + 命令行工具。我发现 Flex SDK [http://www.adobe.com/devnet/flex/flex-sdk-download.html](http://www.adobe.com/devnet/flex/flex-sdk-download.html)可能能够用于此目的。但是，不确定它是否会有一些兼容性问题。还有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:39:57.837

我不是 MAC 用户，但我认为您链接到的问题中接受的答案可能仍然存在；也就是说，如果您想在 MAC 上进行认真的 ActionScript 开发，您应该考虑[FlashBuilder](http://www.adobe.com/products/flash-builder.html)或[FDT](http://fdt.powerflasher.com/product/)。

第二个问题的答案取决于您安装的 CreativeSuite 版本。如果您拥有似乎包含 FlashBuilder 4.6 Premium 的[主合集](http://www.adobe.com/products/creativesuite/mastercollection.html)，那么您很幸运。否则，Flash IDE（讽刺地）对于编写 ActionScript 来说是非常可怕的。

# xml - Scala XML：测试节点存在和值

> ID：12308101
> 
> 赞同：5
> 
> 时间：2012-09-06T20:46:05.480
> 
> 标签：xml, scala

我正在解析来自外部数据存储的一系列 XML 响应。在此期间，我必须测试子节点是否存在，如果存在，则测试它的值。为此，我有以下代码：

```
...
  val properties = for {
    val row <- root \\ "ResultDescription"
    val cond:Boolean = checkDetectionNode(row) match {
      case Some(nodeseq) => {
          val txt = nodeseq.text.toLowerCase
          if (txt contains "non-detect")
            false
          else
            true
      }
      case None => true
    }
    if (cond)
    val name = (row \ "CharacteristicName").text
    if (charNameList.exists(s => s == name) == false)
  } yield {
    getObservedProperty(name) match {
      case Some(property) => {
          charNameList = name :: charNameList
          property
      }
    }
  }
... 
```

checkDetectionNode 定义如下：

```
private def checkDetectionNode(row: scala.xml.NodeSeq) : Option[scala.xml.NodeSeq] = {
  if ((row \ "ResultDetectionConditionText") != null)
    Some[scala.xml.NodeSeq]((row \ "ResultDetectionConditionText"))
  else
    None
} 
```

上面的代码在行上导致“非法开始简单表达式”的未指定错误`val name...`。老实说，我不是 Scala 程序员，甚至不是函数式程序员（总是更偏向于 OO/命令式）。我只使用 Scala 几天，并且基于我从 Java 和 lambda 运算符中了解的大部分内容。不幸的是，我真的没有时间像我希望的那样坐下来真正学习 Scala。截止日期，愚弄我们所有人。

我希望有人可以看看并让我知道我是否做错了什么（因为我确信有）。我试图将显示的代码限制为我希望与问题相关的代码。但是，如果需要任何其他代码，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:17:47.323

首先，请注意，如果不存在具有该名称的子项，`(row \ "ResultDetectionConditionText")`则不会出现`null`— 它只是一个空的`NodeSeq`（惯用的 Scala 代码倾向于避免返回`null`，正如您可能已经注意到的那样）。因此，您当前的代码将始终返回 a `Some`，这可能不是您想要的。更改`!= null`为`.nonEmpty`将解决该问题。

接下来，这是编写条件逻辑的更简洁的方法：

```
val cond = (row \ "ResultDetectionConditionText").exists(
  _.text.toLowerCase contains "non-detect"
) 
```

这表示：获取一个`NodeSeq`包含所有名为 的子节点`"Result..."`（如果存在），然后检查它`NodeSeq`是否有一个包含文本的节点`"non-detect"`。逻辑与您的不完全相同，因为我们单独检查节点的文本，但它实际上更符合我的猜测是您的意图 - 大概您不希望这样的东西通过测试：

```
val row = <row>
  <ResultDetectionConditionText>non-d</ResultDetectionConditionText>
  <ResultDetectionConditionText>etect</ResultDetectionConditionText>
</row> 
```

但它会在您当前的版本中。

但是这些都不能解决你的`"illegal start of simple expression"`问题——它只是修复了逻辑并将 16 行代码减少到 3 行。这里的问题是，如果你刚刚完成的测试失败，你需要决定你`name`应该做什么。最明显的方法是使用`Option`：

```
val name = if (cond) Some((row \ "CharacteristicName").text) else None 
```

但根据您的使用`name`方式，其他一些方法可能更合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:23:34.300

xml 在这里让人分心。问题是最后的 if (cond) 没有起到保护作用，它看起来应该是，编译器认为是新的 if 'then' 部分的开始。

在以下示例中：

```
val l = List(1,2,3,4,5)

val r = for {
    i <- l 
      if (i > 2)
    x <- Some(i * 2)
  } yield x 
```

你会得到如你所料的 List(6,8,10) 。

使用

```
val r = for {
    val i <- l if (i > 2)
    val x <- Some(i * 2)
  } yield x 
```

应该给你一个弃用警告，和

```
val r = for {
    val i <- l 
    if (i > 2)
    val x <- Some(i * 2)
  } yield x 
```

得到

```
error: illegal start of simple expression
  val x <- Some(i * 2) 
```

只需删除 Generator 前面的 val (Pattern1 '<-' Expr [Guard])，即可恢复正常服务。如果没有我发现的 for 循环中的 val，它也会更好地流动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:05:32.173

`if (cond)`后面应该跟一个表达式。在 Scala 中，`if`更像是 Java 中的三元运算符：它是表达式，而不是语句。变量声明不是一个表达式（如在 Java 中），因此您不能`val`在`then`if 部分使用 a。

老实说，我猜不出你想在那里实现什么，所以我不能提出一个有意义的语法正确的替代方案。但是，如果您有更多依赖于 的逻辑，`cond`则可以将其放在一个块中：

```
if (cond) {
  val name = ...
  // do more here
} 
```

# php - Oddity of static:: calling a method that contains $this

> ID：12308102
> 
> 赞同：1
> 
> 时间：2012-09-06T20:46:14.607
> 
> 标签：php, static, this, self

In this example I get the fatal error "Fatal error: Using $this when not in object context" as expected

```
class ctis_parent{
    public function objFunc(){
        var_dump('Called succes');
    }

    public static function call(){

        $this->objFunc(); 
    }

    public function __construct(){
        self::call();
    }

}

new ctis_parent(); 
```

But if remove static keyword from definition of call() method all work fine, why?

```
class ctis_parent{
    public function objFunc(){
        var_dump('Called succes');
    }

    public  function call(){
        $this->objFunc();
    }

    public function __construct(){
        self::call();
    }

}

new ctis_parent(); 

//string 'Called succes' (length=13) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:51:11.607

根据定义，静态函数不需要实例化类，因此它无权访问`$this->`指向当前实例的引用。如果实例不存在，则无法指向它。说得通。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:49:11.750

因为您不在`$this`对象中时使用。好吧，你不是真的，但是使用静态声明，人们可以这样做：

```
ctis_parent::call(); 
```

在哪里，`$this`将是非法的。

请参阅[静态文档](http://php.net/manual/en/language.oop5.static.php)。

# mysql - MySQL：在与表 A 连接的结果中将表 B 的行作为列。比这更聪明/更好的方法？

> ID：12308112
> 
> 赞同：0
> 
> 时间：2012-09-06T20:47:04.527
> 
> 标签：mysql, row, left-join, identity-column

我做了功课并在网上和 StackOverflow 中查找信息，但我没有找到问题的答案。我在看：

[从表的行创建两个列](https://stackoverflow.com/questions/10796412/creating-two-colums-from-rows-of-a-table)（不明白） [MySQL 连接同一个表以列方式显示行（复杂）](https://stackoverflow.com/questions/8739141/mysql-join-same-table-display-rows-in-columns-way-complicated)（不同且问题似乎不一样） [从表的行创建两个列](https://stackoverflow.com/questions/10796412/creating-two-colums-from-rows-of-a-table)

我用它来构建我的查询：

[如何在 MySQL 中将行显示为列？](https://stackoverflow.com/questions/7888631/how-to-display-rows-as-columns-in-mysql)

我有一个表格“课程”，如下所示：

```
ID  title
---------
1   Math
2   Latin
3   English
4   Science 
```

我有第二个表“结果”，它存储了每节课通过的测试用户的类型。目前有两种类型的测试：o 和 w（将来可能会有更多）。表格是这样的：

```
lesson_id  usr_id  test_type   course_id
----------------------------------------
1          100       o          1
1          100       w          1
1          24        o          1
1          36        w          1 
```

在上表中，用户 100 通过了数学测试 o 和 w。在上表中，用户 24 通过了数学测试 o。在上表中，用户 36 通过了数学测试 w。

现在我想获得用户 100 的报告，我想有类似的东西：

```
ID  title      o       w
------------------------------
1    Math       TRUE    TRUE
2    Latin      FALSE   FALSE
3    English    FALSE   FALSE
4    Science    FALSE   FALSE 
```

对于用户 36：

```
ID  title      o       w
------------------------------
1    Math       FALSE    TRUE
2    Latin      FALSE   FALSE
... 
```

对于用户 24：

```
ID  title      o       w
------------------------------
1    Math       TRUE    FALSE
2    Latin      FALSE   FALSE
... 
```

任何其他用户：

```
ID  title      o       w
------------------------------
1    Math       FALSE   FALSE
2    Latin      FALSE   FALSE
... 
```

我可以通过如下查询来完成此操作：

```
SELECT l.id, l.title, COALESCE(s.o,FALSE) AS o, COALESCE(t.w, FALSE) AS w FROM lessons l 
LEFT JOIN (
    SELECT r.lesson_id,
    CASE
        WHEN r.test_type='o' THEN TRUE
        ELSE FALSE
    END AS o
    FROM results r WHERE r.itype='o' AND r.usr_id=100
    ) AS s ON l.id=s.lesson_id 
LEFT JOIN (
    SELECT rr.lesson_id,
    CASE
        WHEN rr.test_type='w' THEN TRUE
        ELSE FALSE
    END AS w 
    FROM results rr WHERE rr.test_type='w' AND rr.usr_id=100
    ) AS t ON l.id=t.lesson_id
WHERE l.course_id=1 ORDER BY l.id ASC; 
```

虽然这段代码似乎可以工作（仍在忙于测试它），但我不喜欢它，因为它需要两个连接，并且每个连接都是由一个表中的选择组成的，将来可能会变得非常大。此查询将经常运行

1.  你能建议一个更好的方法来做到这一点（更好可能意味着更聪明、更直接、更快或其他设计......或任何其他建议:-)）？

2.  如果我需要坚持这一点，您能否推荐参考资料，说明如何设置最佳索引以快速运行此查询？链接，您使用的文章？

3.  在创建更多 test_types 的地方会发生什么？我的查询只使用 w 和 o 如果明天还有更多呢？有没有通用的方法来做这种事情？

任何帮助/建议都非常受欢迎，

菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:02:21.167

您正在尝试做的事情`PIVOT`在其他数据库中称为 a 。不幸的是，MySQL 没有，因此您必须使用聚合函数和`CASE`语句创建一个。

如果你知道你只有两个`test_type`值，那么你可以硬编码：

```
select l.id,
  l.title,
  max(case when test_type = 'o' then 'true' else 'false' end) as o,
  max(case when test_type = 'w' then 'true' else 'false' end) as w
from lessons l
left join results r
  on l.id = r.lesson_id
  and r.usr_id = 100  -- the user id will change for each person
group by l.id, l.title 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/da517/12)

现在，如果您想动态执行此操作，这意味着您事先不知道`test_types`要转置的数量，那么您应该查看以下文章：

[动态数据透视表（将行转换为列）](http://buysql.com/mysql/14-how-to-automate-pivot-tables.html)

您的代码如下所示：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(CASE WHEN test_type = ''',
      test_type,
      ''' THEN ''true'' ELSE ''false'' END) AS ',
      test_type
    )
  ) INTO @sql
FROM Results;

SET @sql 
  = CONCAT('SELECT l.id,
      l.title, ', @sql, ' 
     from lessons l
     left join results r
       on l.id = r.lesson_id
       and r.usr_id = 100
     group by l.id, l.title');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/da517/22)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:06:58.527

我认为这是一个简单的聚合查询。聚合是按课程 ID 和标题。然后，计算只是旋转 o 和 w 的结果：

```
select l.lesson_id, l.title,
       max(case when r.test_type = 'o' then 'TRUE' else 'FALSE' end) as o,
       max(case when r.test_type = 'w' then 'TRUE' else 'FALSE' end) as w
from lessons l left outer join
     results r
     on l.lesson_id = r.lesson_id
where r.user_id = <whatever>
group by l.lesson_id, l.title
order by 1 
```

用户在这个级别选择是一个问题，因为它需要来自结果，由于左外连接，结果可能为NULL。这是解决问题的变体：

```
select l.lesson_id, l.title,
       max(case when r.test_type = 'o' then 'TRUE' else 'FALSE' end) as o,
       max(case when r.test_type = 'w' then 'TRUE' else 'FALSE' end) as w
from lessons l left outer join
     results r
     on l.lesson_id = r.lesson_id and
        r.user_id = <whatever>
group by l.lesson_id, l.title
order by 1 
```

通过将条件移至“on”子句，我们保证将保留所有课程。

# java - 在java中的文本文件中打印输出

> ID：12308114
> 
> 赞同：0
> 
> 时间：2012-09-06T20:47:10.260
> 
> 标签：java, io, arraylist

```
public static void main(String[] args) {

int i;
float[] npoints = new float[10];
float[] points = new float[10];
points[0]=(float) 0.3;
points[1]=(float) 0.2;
points[2]=(float) 0.4;
points[3]=(float) 0.5;
points[4]=(float) 0.6;
points[5]=(float) 0.0123;

for(i=0;i<6;i++)
{
    if(points[i]!=0.0)
    {
        npoints[i]=points[i];
        System.out.println(i+":"+points[i]);
    }

}
System.out.println(npoints[i]);
} 
```

输出：

```
run:
    0:0.3
    1:0.88
    2:0.22
    3:0.95
    4:0.16
    5:0.0123
[0.95, 0.88, 0.3, 0.22, 0.16, 0.0123]
BUILD SUCCESSFUL (total time: 0 seconds)
` 
```

我想在文本文件中打印这个输出，有什么建议吗？我是java新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:49:31.653

您可以使用[缓冲作家之类的东西](http://www.mkyong.com/java/how-to-write-to-file-in-java-bufferedwriter-example/)

```
 FileWriter fw = new FileWriter(fileObj);
   BufferedWriter bw = new BufferedWriter(fw);
   bw.write(content);
   bw.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:53:04.930

创建一个新的`BufferedWriter`：

```
BufferedWriter bw = new BufferedWriter(new FileWriter("somefilename.txt")); 
```

然后使用`write`方法：

```
bw.write(i+":"+points[i]);  // or bw.write(anything else) 
```

完成后不要伪造关闭它`BufferedWriter`：

```
bw.close(); 
```

另外，请记住从 导入适当的类`java.io`，并处理`IOException`.

相关Javadocs：

*   [缓冲写入器](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedWriter.html)
*   [文件编写器](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileWriter.html)
*   [IO异常](http://docs.oracle.com/javase/6/docs/api/java/io/IOException.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:53:15.243

试试这个代码——改变这是你需要打印的第1行

```
import java.io.*;

public class WriteText{
   public static void main(String[] args){
       try {
           FileWriter outFile = new FileWriter(args[0]);
          PrintWriter out = new PrintWriter(outFile);

          // Also could be written as follows on one line
          // Printwriter out = new PrintWriter(new FileWriter(args[0]));

          // Write text to file
          out.println("This is line 1");
          out.println("This is line 2");
          out.print("This is line3 part 1, ");
          out.println("this is line 3 part 2");
          out.close();
      } catch (IOException e){
          e.printStackTrace();
      }
  } 
```

}

# java - JBoss 将 ROOT.WAR 重命名为默认值

> ID：12308116
> 
> 赞同：1
> 
> 时间：2012-09-06T20:47:13.153
> 
> 标签：java, servlets, jboss

我有一个 jboss 4 网络服务器，如果我将一个 webapp 部署到

```
www/webapps/ROOT.WAR/ 
```

它在域上加载为[http://www.mywebsite.com/](http://www.mywebsite.com/)

如果我将 webapp 部署到

```
www/webapps/internal 
```

它在域上加载为[http://www.mywebsite.com/internal/](http://www.mywebsite.com/internal/)

所以某处 jboss 将 ROOT.WAR 检测为指示“/”的魔术关键字。

这是可配置的吗？如果我需要我的文件夹结构是：

```
www/webapps/default 
```

我可以更改设置以使 Jboss 将其加载为[http://www.mywebsite.com/](http://www.mywebsite.com/)而不是[http://www.mywebsite.com/default/](http://www.mywebsite.com/default/)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T10:08:06.547

`ROOT.war`作为默认 Web 应用程序是 Java EE Servlet 规范的一部分。

基本上，如果您的 Web 应用程序没有明确指定上下文根，默认情况下它将使用 war 文件的名称。“根”上下文是一种特殊情况，它将分配给您站点的根。IE ”/”。更改上下文根的最简单方法是将您的战争文件重命名为“ROOT”以外的名称。

特别是对于 JBoss，您可以像这样`jboss-web.xml`在您的应用程序`WEB-INF`文件夹中创建一个：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-web>
    <context-root />
</jboss-web> 
```

以上将是您明确设置根上下文的方式。以下是如何将“内部”设置为上下文：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-web>
    <context-root>internal</context-root>
</jboss-web> 
```

这是关于如何配置它的 JBoss 指南：

[http://docs.jboss.org/jbossas/guides/webguide/r2/en/html/ch06.html](http://docs.jboss.org/jbossas/guides/webguide/r2/en/html/ch06.html)

# c# - 如何通过反射区分集合与单个对象？

> ID：12308119
> 
> 赞同：0
> 
> 时间：2012-09-06T20:47:19.770
> 
> 标签：c#, reflection

我有这个：

```
var Virtual = Property.GetValue(Entity, null); 
```

正在使用实体框架从存储库中提取实体。

如何确定它是单个对象还是集合？

我尝试检查类型，但不确定将其与什么进行比较。

```
var VirtualType = Virtual.GetType(); 
```

使用调试器检查时，Virtual 要么是`DynamicProxy`实例化的单一的`class`，要么是`HashSet`实例化的`ICollection`。如果`.GetType()`在`DynamicProxy`this 上使用，则会抛出：

```
Object reference not set to an instance of an object. 
```

我也试过这个：

```
var test = (IEnumerable<object>)Virtual;
if (test.Count() > 0) 
```

它适用于集合，但在单个对象上失败。

我也试过这个：

```
if (Virtual is Enumerable) 
```

但这是错误的，即使对于收藏也是如此。

我如何通过反思来辨别两者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:50:45.960

检查它是否实现`IEnumerable`：

```
if (Virtual is IEnumerable)
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:51:17.583

只是通过查看您的代码快速猜测。

```
//works for collection but throws exception for single object (as it should)
var test = (IEnumerable<object>)Virtual;

//try using
var test = Virtual as IEnumerable;
if(test == null) // single object 
```

这和

```
if(Virtual is IEnumerable){} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T20:59:04.790

[`Type.IsAssignableFrom()`](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom%28v=vs.71%29.aspx)是确定类型支持哪些赋值的非常有用的方法：

```
if (VirtualType.IsAssignableFrom(typeof(ICollection)) {
  // Do something
} 
```

# php - php中字符串的每种可能组合

> ID：12308132
> 
> 赞同：-2
> 
> 时间：2012-09-06T20:47:55.760
> 
> 标签：php, string

我需要用每种可能的组合在 PHP 中构建字符串，例如

> s5z-s4z-s3z-s2z-s1z

其中“s”则数字始终位于同一位置。唯一的区别是最后是否有 az 。

所以例如我会有

*   s5z-s4z-s3z-s2z-s1
*   s5z-s4z-s3z-s2z-s1z
*   s5z-s4z-s3z-s2-s1
*   s5z-s4z-s3z-s2z-s1
*   s5z-s4z-s3z-s2-s1z
*   s5z-s4z-s3-s2-s1z
*   等等

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:51:24.463

所以基本上这一切都依赖于“z 是否存在”。这可以很容易地转换为二进制数，其中每个`0`表示`z`不存在，每个`1`表示存在`z`。

因此，您只需要遍历所有数字。

```
$length = 5;
$max = bindec(str_repeat("1",$length));
$out = Array();
for( $i=0; $i<$max; $i++) {
  $entry = Array();
  for( $x=0; $x<$length; $x++) $entry[] = "s".($length-$x).($i & (1<<$x) ? "z" : "");
  $out[] = implode("-",$entry);
}
echo implode(" ",$out); 
```

# mysql - MySQL 1 个表中的多个级联外键

> ID：12308135
> 
> 赞同：0
> 
> 时间：2012-09-06T20:48:04.980
> 
> 标签：mysql, foreign-keys

我使用 MySQL 5.1。有一个带有 2 个外键的表，引用 2 个不同的表：

```
CREATE TABLE `words` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `word` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `words_groups` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `words_in_group` (
  `group_id` int(10) unsigned DEFAULT NULL,
  `word_id` int(10) unsigned DEFAULT NULL,
  KEY `word_id` (`word_id`) USING BTREE,
  KEY `group_id` (`group_id`) USING BTREE,
  CONSTRAINT `group_id` FOREIGN KEY (`group_id`) REFERENCES `words_groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `word_id_fk` FOREIGN KEY (`word_id`) REFERENCES `words` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

但是由于某种原因，当我使用 phpMyAdmin 或 Navicat 并检查此表结构时，words_in_group 表中的键之一的 CASCADE 属性未设置。

会是什么？怎么解决？也许，使用触发器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:15:36.107

通过插入一些测试数据来测试级联，然后从单词中删除一行。

您还可以使用 mysqldump 转储数据库，并读取数据库服务器认为它应该做什么。

我很确定您会发现级联按书面方式工作，而不是图形界面中显示的那样。

# google-apps-script - Google Apps 脚本：getUsers = 未生成完整列表

> ID：12308136
> 
> 赞同：1
> 
> 时间：2012-09-06T20:48:19.673
> 
> 标签：google-apps-script

问题描述：想要获取组的用户并将列表放入文件中。只有部分列表正在写入。

重现问题：结合使用两个 Google 示例（1）获取订阅组的电子邮件地址的逗号分隔列表，以及（2）将列表写入 Google Docs 文件，然后通过电子邮件将其发送给自己：

```
// Part (1)... 
function listGroupMembers() {
  var group = GroupsApp.getGroupByEmail("particular.group@example.com");
  var s = group.getEmail() + ': ';
  var users = group.getUsers();
  for (var i = 0; i < users.length; i++) {
    var user = users[i];
    s = s + user.getEmail() + ", ";
  }

// Part (2)... 
  var doc = DocumentApp.create(group.getEmail() + ' Member List');
  doc.appendParagraph('This is the list of emails on the ' + group.getEmail() + ' Email Reflector: ');
  doc.appendParagraph(s);
  doc.saveAndClose();

  var url = doc.getUrl();

  var emailAddress = Session.getActiveUser().getEmail();

  GmailApp.sendEmail(emailAddress,
                     'Member List for ' + group.getEmail(),
                     'Here is a link to a document ccontaining the list of all emails in the ' + group.getEmail() + ' Email Reflector... ' + url);
} 
```

失败结果：生成的文件包含 8 个电子邮件地址。它应该包含 27 个地址（完整组）。我看不到是什么阻止了整个列表的创建。在这8个人中，有些人在我的领域，有些人不在。其他一些域由 Google 托管，有些则不是。有些电子邮件有“昵称”，有些则没有。

谢谢，JJR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:59:49.970

GroupsApp 返回用户，即与实际 Google 帐户相对应的电子邮件地址。不返回邮件列表和未知电子邮件地址。有关详细信息，请参阅[此问题。](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1157)

# cakephp - CakePHP 1.3.x 的 Twitter Bootstrap 2.x 插件

> ID：12308137
> 
> 赞同：0
> 
> 时间：2012-09-06T20:48:23.267
> 
> 标签：cakephp, twitter-bootstrap, cakephp-1.3

我可以找到一些 Twitter Bootstrap 2.x 插件，其中包含 CakePHP 2.x 的一些帮助程序，但我找不到 CakePHP 1.3.x。

[https://github.com/slywalker/TwitterBootstrap](https://github.com/slywalker/TwitterBootstrap)

[https://github.com/loadsys/twitter-bootstrap-helper](https://github.com/loadsys/twitter-bootstrap-helper)

这两个插件非常酷，但仅适用于 CakePHP 2.x。

CakePHP 1.3.x 有插件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T12:45:43.797

不，不会有。CakePHP 1.3 是旧的，而 Twitter Bootstrap 2.x 是新的。几乎没有人再用 1.3 创建新项目了，所以没有人会觉得有必要为它创建新项目的插件。

如果您使用 Twitter Bootstrap 启动一个新项目，请改用 Cake 2.x。它更好更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T20:01:11.967

我为 Cake 2.0 移植了一个 Twitter Bootstrap 助手。它不是插件，而是助手，只需将它放在一个名为`app/views/helpers/t_b_s.php`. 在您看来，替换所有`$this->Form->input()`对`$this->TBS->input()`. 此方法是我在生产应用程序中测试和使用的唯一方法。

此方法将自动或显式创建许多表单控件类型。'type' 选项可以是：text、textarea、textdate（使用 jquery.calendar 插件的文本输入）、checkbox、select、radioGroup（您通过 'selectOptions' 属性传递具有有效选项的数组）。您可以使用选项 'prepend'、'append'、'ly_w'=>[1,2,3,4]（布局宽度：这会将 .spanN 类添加到您的控件中）

此外，默认情况下，“maxlength”属性是通过查询数据库元数据来设置的。但是，如果您设置了模型的 $_schema 属性，它将使用那里指定的长度（您可以只在属性的数组中放入您想要严格控制最大长度的字段）。Flash 和 Flashes 方法也可以使用，您可以使用它们在布局/元素中替换它们。

顺便说一句：我很想从 1.3 迁移到 2，但是我遇到了 dbo_firebird 数据源的问题。我从 github 的驱动程序开始，但我已经编程和修补了很多东西，例如我会在适当的线程上寻求一些帮助。

```
<?php
/**
 * Helper to generate Twitter's Bootstrap UI interface controls and styles. 
 * Based on the code from Joey Trapp
 *
 * @author Lev A Gutierrez
 *
 */

/**
 * Helper that captures the Session flash and renders it in proper html
 * for the twitter bootstrap alert-message styles.
 *
 * @author Joey Trapp
 *
 */
class  TBSHelper extends AppHelper {

    /**
     * Helpers available in this helper
     *
     * @var array
     * @access public
     */
    public $helpers = array("Form", "Html", "Ajax", "Session", 'Number', 'Time', 'Text');

    // Confirm Replacement
    /**
     * Creates an HTML link.
     *
     * If $url starts with "http://" this is treated as an external link. Else,
     * it is treated as a path to controller/action and parsed with the
     * HtmlHelper::url() method.
     *
     * If the $url is empty, $title is used instead.
     *
     * ### Options
     *
     * - `escape` Set to false to disable escaping of title and attributes.
     *
     * @param string $title The content to be wrapped by <a> tags.
     * @param mixed $url Cake-relative URL or array of URL parameters, or external URL (starts with http://)
     * @param array $options Array of HTML attributes.
     * @param string $confirmMessage JavaScript confirmation message.
     * @return string An `<a />` element.
     * @access public
     * @link http://book.cakephp.org/view/1442/link
     */
        function link($title, $url = null, $options = array(), $confirmMessage = false) {
            $escapeTitle = true;
            if ($url !== null) {
                $url = $this->url($url);
            } else {
                $url = $this->url($title);
                $title = $url;
                $escapeTitle = false;
            }

            if (isset($options['escape'])) {
                $escapeTitle = $options['escape'];
            }

            if ($escapeTitle === true) {
                $title = h($title);
            } elseif (is_string($escapeTitle)) {
                $title = htmlentities($title, ENT_QUOTES, $escapeTitle);
            }

            if (!empty($options['confirm'])) {
                $confirmMessage = $options['confirm'];
                unset($options['confirm']);
            }
            if ($confirmMessage) {
                $confirmMessage = str_replace("'", "\'", $confirmMessage);
                $confirmMessage = str_replace('"', '\"', $confirmMessage);
                $options['onclick'] = "return bootbox.confirm('{$confirmMessage}');";
            } elseif (isset($options['default']) && $options['default'] == false) {
                if (isset($options['onclick'])) {
                    $options['onclick'] .= ' event.returnValue = false; return false;';
                } else {
                    $options['onclick'] = 'event.returnValue = false; return false;';
                }
                unset($options['default']);
            }
            return sprintf($this->Html->tags['link'], $url, $this->_parseAttributes($options), $title);
        }

    /**
     * Takes an array of options to output markup that works with
     * twitter bootstrap forms.
     *
     * @param array $options
     * @access public
     * @return string
     */
    public function input($field, $options = array()) {

        // Checkout how the input parameters are given
        if (is_array($field)) {
            $options = $field;
            $field = $options['field'];
        } else {
            $options["field"] = $field;
        }

        if (!isset($field)) { return ''; }

        $out = $theGroup = $theHelp = $theLabel = $theControl = $theError = $help_inline = $help_block = $theStyleClass = $theScripts = $thePrependAppendClass = $theSelectOptions = '';

        // Default options, etc...
        if(isset($options['type'])) 
            $theType=$options['type'];

        $defaults = array(
            'help_inline' => '',
            'help_block' => '',
        );

//      $options = array_merge($defaults, $options);

        // Determine both model and field parameters
        $theModel = ucfirst($this->Form->defaultModel);
        $split = explode(".", $options["field"]);
        if($split && sizeof($split)>1) {
            $theModel = ucfirst($split[0]);
            $theField = ucfirst($split[1]);
        }
        else {
            $theField = ucfirst($split[0]);
        }

        $options['field'] = $theModel.(!empty($theModel)?'.':'').$theField;

        // Introspects the Model to get field's info
        if (!isset($this->Form->fieldset[$theModel])) {
            $this->Form->_introspectModel($theModel);
        }

        // Get the field's metadata into the theFieldMeta variable
        if( isset($this->Form->fieldset) &&
            array_key_exists($theModel, $this->Form->fieldset) &&
            array_key_exists('fields', $this->Form->fieldset[$theModel])
            ) {
            $theFieldMeta=$this->Form->fieldset[$theModel]['fields'][strtolower($theField)];
        }

        // If the field's type is text or String,
        // then set the MaxLength option when it is not passed by parameter.
        if(!array_key_exists('maxlength', $options) &&
            isset($theFieldMeta['length']) &&
            isset($theFieldMeta['type']) && 
            ($theFieldMeta['type']=='text' || $theFieldMeta['type']=='string')
        ) {
            $options['maxlength']=$theFieldMeta['length'];
        }

        // Generate a Label for the Control
        if (!isset($options['label']) || $options['label'] === false) {
            $options['label'] = '';
        } else if (!empty($options['label'])) {
            $theLabel = '<label for="'.$theModel.$theField.'" class="control-label">'.$options['label'].'</label>';
        } else {
            if(!isset($options['label']))
                $theLabel = '<label for="'.$theModel.$theField.'" class="control-label">'.$theField.'</label>';
        }
        $options['label']=false;

        // Generate the extra Prepend/Appended content
        if (!empty($options['prepend'])) {
            $thePrepend=$this->Html->tag('span',$options['prepend'], array('class'=>'add-on'));
            $options['prepend']=null;
            $thePrependAppendClass="input-prepend";
        }
        if (!empty($options["append"])) {
            $theAppend=$this->Html->tag("span",$options['append'], array('class'=>'add-on'));
            $options['append']=null;
            $thePrependAppendClass.="input-append";
        }

        // generate the error...
        list($help_inline, $help_block) = $this->_help_markup($options);

        // generate the error message for the input field, if any...
        if ($this->Form->error($field)) {
//          echo WCR.WCR."Error-${field}::".$this->Form->error($field);
            $theError=$this->Form->error($field);
            $help_block = $this->Html->tag(
                "span",
                str_replace(array('<div class="error-message">','</div>'),'',$this->Form->error($field)),
                array("class" => "help-inline")
            );
        }

        // Get the control's layout width and define the control's style class
        if(isset($options['class'])) $theStyleClass=trim($options['class']);
        if(isset($options['ly_w'])) {
            $theStyleClass.=' span'.$options['ly_w'];
            $options['ly_w']=null;
        }
        $options['class']=trim($theStyleClass);

        if(isset($options['type']) && $options['type']=='textdate') {
            $options['type']='text';
            $theScripts.=' $(\'#'.$theModel.'.'.$options['field'].'\').datepicker({ dateFormat: \'yy-mm-dd\'});';
//          $options['dateFormat'] = 'DMY';
        }

        // generate the form's input control (main thing)
            //
        $options['div']=false;

        if(isset($options['type']) && $options['type']=='radiogroup') {
            $theSelectOptions=$options['selectOptions'];
            $options['selectOptions']=null;
            $theControl = $this->Form->radio($field, $theSelectOptions, array('label'=>'','legend'=>'','div'=>false));
        }
        else {
            if(isset($this->data[$theModel][strtolower($theField)]) &&
            !empty($this->data[$theModel][strtolower($theField)]) &&
                is_numeric(trim($this->data[$theModel][strtolower($theField)])) &&
                trim($this->data[$theModel][strtolower($theField)])<>'' &&
                !is_integer(trim($this->data[$theModel][strtolower($theField)]))
                )
            if(isset($options['format']) ) {
                if($options['format']==='currency') {
                    $options['value']=$this->Number->currency(trim($this->data[$theModel][strtolower($theField)]), array('places'=>'2'));
                }
                if($options['format']==='integer') {
                    $options['value']=$this->Number->format(trim($this->data[$theModel][strtolower($theField)]), array('places'=>'0'));                 
                }

            }

            $theControl = $this->Form->input($field, $options);         
        }

        // clean the error message, if any.
        $theControl = str_replace($this->Form->error($field),'',$theControl);

/*
        if(stristr('type="text"',$theControl) ) {
            str_ireplace('type="text"', 'type="text" maxlength="'..'"');
        }
*/      
        // create the prepend-append div
        if(!empty($thePrepend) || !empty($theAppend)) {
            $controlGroup = $this->Html->tag(
                            "div",
                            (!empty($thePrepend)?$thePrepend:'').
                            $theControl.
                            (!empty($theAppend)?$theAppend:''),
                            array("class" => $thePrependAppendClass));
        }
        else {
            $controlGroup = $theControl;
        }

        // control's div
        $controlGroup = $this->Html->tag(
            "div",
            $controlGroup.
            $help_inline.$help_block,
            array("class" => "controls input".(isset($options['multiple'])?' multiple-input':''))
        );

        if(!empty($theScripts)) {
            $theScripts='<script>'.$theScripts.'</script>';
        }

        // final control-group div. Set the field's style here.
        $controlGroup = $this->Html->tag(
            "div",
            $theLabel.$controlGroup.$theScripts,
            array("class" => "control-group".(!empty($theError)?' error':''))
        );

        return $controlGroup."\n";
    }

    /**
     * Takes the options from the input method and returns an array of the
     * inline help and inline block content wrapped in the appropriate markup. 
     * 
     * @param mixed $options 
     * @access public
     * @return string
     */
    public function _help_markup($options) {
        $help_markup = array("help_inline" => "", "help_block" => "");
        foreach (array_keys($help_markup) as $help) {
            if (isset($options[$help]) && !empty($options[$help])) {
                $help_class = str_replace("_", "-", $help);
                $help_markup[$help] = $this->Html->tag(
                    "span",
                    $options[$help],
                    array("class" => $help_class)
                ); 
            }
        }
        return array_values($help_markup);
    }

    /**
     * Outputs a list of radio form elements with the proper
     * markup for twitter bootstrap styles 
     * 
     * @param array $options 
     * @access public
     * @return string
     */
    public function radio($field, $options = array()) {
        if (is_array($field)) {
            $options["field"] = $field;
        } else {
            $options = $field;
        }
        if (!isset($options["options"]) || !isset($options["field"])) { return ""; }
        $opt = $options["options"];
        $options["options"]=null;
        $inputs = "";
        foreach ($opt as $key => $val) {
            $input = $this->Form->radio(
                $options["field"],
                array($key => $val),
                array("label" => false)
            );
            $id = array();
            preg_match_all("/id=\"[a-zA-Z0-9_-]*\"/", $input, $id);
            if (isset($id[0][1]) && !empty($id[0][1])) {
                $id = $id[0][1];
                $id = substr($id, 4);
                $id = substr($id, 0, -1);
                $input = $this->Html->tag("label", $input, array("for" => $id));
            }
            $inputs .= $this->Html->tag("li", $input);
        }
        $options["input"] = $this->Html->tag("ul", $inputs, array("class" => "inputs-list"));
        return $this->input($options);
    }

    /**
     * Wraps the form button method and just applies the Bootstrap classes to the button
     * before passing the options on to the FormHelper button method. 
     * 
     * @param string $value 
     * @param array $options 
     * @access public
     * @return string
     */
    public function button($value = "Submit", $options = array()) {
        $options = $this->button_options($options);
        return $this->Form->button($value, $options);
    }

    /**
     * Wraps the html link method and applies the Bootstrap classes to the options array
     * before passing it on to the html link method. 
     * 
     * @param mixed $title 
     * @param mixed $url 
     * @param array $options 
     * @param mixed $confirm 
     * @access public
     * @return string
     */
    public function button_link($title, $url, $options = array(), $confirm = false) {
        $options = $this->button_options($options);
        return $this->Html->link($title, $url, $options, $confirm);
    }

    /**
     * Wraps the postLink method to create post links that use the bootstrap button
     * styles. 
     * 
     * @param mixed $title 
     * @param mixed $url 
     * @param array $options 
     * @param mixed $confirm 
     * @access public
     * @return string
     */
    public function button_form($title, $url, $options = array(), $confirm = false) {
        $options = $this->button_options($options);
        return $this->Form->postLink($title, $url, $options, $confirm);
    }

    /**
     * Takes the array of options from $this->button or $this->button_link and returns
     * the modified array with the bootstrap classes 
     * 
     * @param mixed $options 
     * @access public
     * @return string
     */
    public function button_options($options) {
        $valid_styles = array("danger", "info", "primary", "success");
        $valid_sizes = array("small", "large");
        $style = isset($options["style"]) ? $options["style"] : "";
        $size = isset($options["size"]) ? $options["size"] : "";
        $disabled = isset($options["disabled"]) ? (bool)$options["disabled"] : false;
        $class = "btn";
        if (!empty($style) && in_array($style, $valid_styles)) { $class .= " {$style}"; }
        if (!empty($size) && in_array($size, $valid_sizes)) { $class .= " {$size}"; }
        if ($disabled) { $class .= " disabled"; }
        unset($options["style"]);
        unset($options["size"]);
        unset($options["disabled"]);
        $options["class"] = isset($options["class"]) ? $options["class"] . " " . $class : $class;
        return $options;
    }

    /**
     * Delegates to the HtmlHelper::getCrumbList() method and sets the proper class for the
     * breadcrumbs class. 
     * 
     * @param array $options 
     * @access public
     * @return string
     */
    public function breadcrumbs($options = array()) {
        return $this->getCrumbList(array_merge(array("class" => "breadcrumb"), $options));
    }

    /**
     * Delegates to the HtmlHelper::addCrumb() method. 
     * 
     * @param mixed $title 
     * @param mixed $link 
     * @param array $options 
     * @access public
     * @return string
     */
    public function add_crumb($title, $url, $options = array()) {
        return $this->Html->addCrumb($title, $url, $options);
    }

    /**
     * Creates a Bootstrap label with $messsage and optionally the $type. Any
     * options that could get passed to HtmlHelper::tag can be passed in the
     * third param.
     * 
     * @param string $message 
     * @param string $type 
     * @param array $options
     * @access public
     * @return string
     */
    public function label($message = "", $style = "", $options = array()) {
        $class = "label";
        $valid = array("success", "important", "warning", "notice");
        if (!empty($style) && in_array($style, $valid)) {
            $class .= " {$style}";
        }
        if (isset($options["class"]) && !empty($options["class"])) {
            $options["class"] = $class . " " . $options["class"];
        } else {
            $options["class"] = $class;
        }
        return $this->Html->tag("span", $message, $options);
    }

    /**
     * Renders alert markup and takes a style and closable option 
     * 
     * @param mixed $content 
     * @param array $options 
     * @access public
     * @return void
     */
    public function alert($content, $options = array()) {
        $close = "";
        if ((isset($options['closable']) && $options['closable']) || !isset($options['closable']) ||true) {
            $close = '<a href="#" class="close" data-dismiss="alert">x</a>';
        }
        $style = isset($options["style"]) ? $options["style"] : "flash";
        $types = array("info", "success", "error", "warning");
        if ($style === "flash") {
            $style = "info";
        }
        if (strtolower($style) === "auth") {
            $style = "error";
        }
        if (!in_array($style, array_merge($types, array("auth", "flash")))) {
            $style = "error";
        }
        $class = "alert alert-{$style}";
        return $this->Html->tag(
            'div',
            '<h4 class="alert-heading">'.$style.'!</h4>'.
            "{$close}<p>{$content}</p>",
            array("class" => $class)
        );
    }

    /**
     * Captures the Session flash if it is set and renders it in the proper
     * markup for the twitter bootstrap styles. The default key of "flash",
     * gets translated to the warning styles. Other valid $keys are "info",
     * "success", "error". The $key "auth" with use the error styles because
     * that is when the auth form fails.
     *
     * @param string $key
     * @param $options
     * @access public
     * @return string
     */
    public function flash($key = "flash", $options = array()) {
        $content = $this->_flash_content($key);
        if (empty($content)) { return ''; }
        $close = false;
        if ((isset($options['closable']) && $options['closable'])) {
            $close = true;
        }
        return $this->alert($content, array("style" => $key, "closable" => $close));
    }

    /**
     * By default it checks $this->flash() for 5 different keys of valid
     * flash types and returns the string.
     *
     * @param array $options
     * @access public
     * @return string
     */
    public function myflashes($options = array()) {
        if (!isset($options["keys"]) || !$options["keys"]) {
            $options["keys"] = array("info", "success", "error", "warning", "flash");
        }
        if (isset($options["auth"]) && $options["auth"]) {
            $options["keys"][] = "auth";
            unset($options["auth"]);
        }
        $keys = $options["keys"];
        unset($options["keys"]);
        $out = '';
        foreach($keys as $key) {
            $thisFlash=$this->_flash_content($key);
            if(!empty($thisFlash)) {
                if($key=='default') {
                    $out.='<div id="flashMessage" class="alert alert-info">
    <a class="close" data-dismiss="alert">×</a>
    <h4 class="alert-heading">Atencion !</h4>
    <p>'.
    $thisFlash.'
    </p>
</div>';
                }
                else {
                    $out.=$thisFlash;
                }
            }
        }
        return $out;
    }

    /**
     * By default it checks $this->flash() for 5 different keys of valid
     * flash types and returns the string.
     *
     * @param array $options
     * @access public
     * @return string
     */
    public function flashes($options = array()) {
        if (!isset($options["keys"]) || !$options["keys"]) {
            $options["keys"] = array("info", "success", "error", "warning", "flash");
        }
        if (isset($options["auth"]) && $options["auth"]) {
            $options["keys"][] = "auth";
            unset($options["auth"]);
        }
        $keys = $options["keys"];
        unset($options["keys"]);
        $out = '';
        foreach($keys as $key) {
            $out .= $this->flash($key, $options);
        }
        return $out;
    }

/**
 * Create a text field with Autocomplete.
 *
 * Creates an autocomplete field with the given ID and options.
 *
 * options['with'] defaults to "Form.Element.serialize('$field')",
 * but can be any valid javascript expression defining the additional fields.
 *
 * @param string $field DOM ID of field to observe
 * @param string $url URL for the autocomplete action
 * @param array $options Ajax options
 * @return string Ajax script
 * @link http://book.cakephp.org/view/1370/autoComplete
 */
    function autoComplete($field, $url = "", $options = array()) {
        $out=$this->Ajax->autocomplete($field, $url, $options);
        return $out;
    }

    /**
     * Returns the content from SessionHelper::flash() for the passed in
     * $key. 
     * 
     * @param string $key 
     * @access public
     * @return void
     */
    public function _flash_content($key = "flash") {
        return $this->Session->flash($key, array("element" => null));
    }

    /**
     * Displays the alert-message.block-messgae div's from the twitter
     * bootstrap.
     *
     * @param string $message
     * @param array $links
     * @param array $options
     * @access public
     * @return string
     */
    public function block($message = null, $options = array()) {
        $style = "warning";
        $valid = array("warning", "success", "info", "error");
        if (isset($options["style"]) && in_array($options["style"], $valid)) {
            $style = $options["style"];
        }
        $class = "alert-message block-message {$style}";
        $close = $links = "";
        if (isset($options["closable"]) && $options["closable"]) {
            $close = '<a href="#" class="close">x</a>';
        }
        if (isset($options["links"]) && !empty($options["links"])) {
            $links = $this->Html->tag(
                "div",
                implode("", $options["links"]),
                array("class" => "alert-actions")
            );
        }
        return $this->Html->tag("div", $close.$message.$links, array("class" => $class));
    }

}
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T22:07:59.633

没有插件，但在您的项目中安装并不是特别难。将样式表添加到 CSS 文件夹，将 JavaScript 添加到 js，将字形图标添加到 img。从您的布局中调用它们并开始更新所有视图中的 CSS 类。这种 CSS 类的手动更新是永远不会有插件的原因。

如果您想查看一个集成了 Bootstrap 的特别出色的 Cake 2.x 项目，请查看 CakeStrap。您也许可以从中复制 View 文件夹并将其调整为 1.3 的命名约定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-16T08:20:35.420

您仍然可以将 cakephp 1.3 与 bootstrap 3.0 一起使用。

```
<style>
.form-control {width:auto}
</div>
<?php 
echo $this->Form->create('YourForm',array(
        'inputDefaults'=>array(
        'label' => array(
        'class' => 'col col-md-4 control-label'
    ),
    'div' => 'form-group',
        'wrapInput' => 'col col-md-8',
        'class' => 'form-control'
    ),
    'class'=>'form-horizontal',
    )); ?>

 <div class='col-md-12'>
    //your form control here
</div>
<?php echo $this->Form->end(__('', false)); ?> 
```

# jquery - 带有 display:none 表单元素的 jquery 验证器插件

> ID：12308138
> 
> 赞同：26
> 
> 时间：2012-09-06T20:48:23.410
> 
> 标签：jquery, plugins, block, validation

我正在使用[此处](http://docs.jquery.com/Plugins/Validation)找到的验证器插件来验证表单。

我遇到的问题是，如果我将以下内容放在表单输入元素周围，验证将失败：

```
<div style="display:none;"><input type="text" name="test" /></div> 
```

我需要这个，因为我正在为输入元素使用其他 UI 控件层并且不希望它们可见。

它适用于内联和块元素，但我需要隐藏它。有没有办法解决这个问题？

感谢您的任何反馈

**更新：**

我主要使用 django 验证选择选项字段（即： {{form.select_option_element}} ）

如此有效：

```
<div style="display:none;">
    {{form.select_option_element}}
</div> 
```

...不起作用

发布后我似乎解决了这个问题：

```
<div style="visibility: hidden; height: 0;">
     {{form.select_option_element}}
</div> 
```

然后它允许我验证该字段。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-09-06T21:21:29.007

来自[jQuery Validate](https://github.com/jzaefferer/jquery-validation/blob/master/changelog.md#190)的 1.9.0 更改日志：

> *   固定 #189 - :hidden 元素现在默认被忽略

要重新打开它，只需执行以下操作：

```
$(document).ready(function(){    
    $.validator.setDefaults({
        ignore: []
    });
}); 
```

确保在您调用代码中的实际验证插件**之前出现此信息。**

我希望这有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-26T08:48:32.080

我喜欢@dSquared 的答案，但不幸的是，'ignore'-property 将为页面上的每个表单的验证器重置。在某些情况下它不需要。

我用这种方式：

```
$(document).ready(function () {

    var $form = $("#some-form");

    $form.validate().settings.ignore = []; // ! Say to validator dont ignore hidden-elements on concrete form.

    $('#button-send').click(function () {
        if ($form.valid()) { .. }
    });

    // !! apply plugin's initializers which will hide origin elements (it can be CLEditor or Choosen plugins)
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:57:39.527

您是否尝试将样式属性添加到输入元素？因此，不要用**div**包装它，而是尝试：

```
<input type="text" name="test" value="" style="display: none;" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T20:59:48.543

你可以做两件事。

1）您可以为此输入字段静态设置不会失败验证的值，例如

```
<div style="display:none;"><input type="text" name="test" value="default" /></div> 
```

2）如果你想在你的验证方法中否定这个值。

如果您能提供更详细的代码，我将不胜感激。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-26T12:30:10.707

解决此问题的另一种形式是`display: none`将`visibility: hidden`.

例如：`<input type="text" name="test" value="" style="visibility: hidden;" />`

# java - 用于输出到 csv 的 java 库 - 需要处理哪些特殊情况，将数据输出为 csv 格式

> ID：12308140
> 
> 赞同：0
> 
> 时间：2012-09-06T20:48:25.797
> 
> 标签：java, csv

我正在寻找一个（最好）免费的 Java 库，它将存储在变量（即列表列表）中的数据输出到 csv 文件。

我看到 RiceBridge 的一个商业图书馆，他们谈到了他们图书馆处理的各种特殊情况——有没有免费的图书馆也能做到这一点？

或者，如果我想创建自己的 csv 编写器库，我应该处理哪些特殊情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T20:52:32.107

我目前正在使用[http://commons.apache.org/csv/](http://commons.apache.org/csv/)，可以很好地满足我的目的，即解析。值得一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T23:01:10.480

[Super CSV](http://supercsv.sourceforge.net)是一个免费的开源 Java CSV API。

它有 4种[写入实现](http://supercsv.sourceforge.net/writers.html)：除了从 List 写入之外，您还可以从 Map 或 POJO 写入。

我们（Super CSV 团队）刚刚发布了一个具有强大 Dozer 扩展的[新版本](http://supercsv.sourceforge.net/release_notes.html)- 允许您使用嵌套属性和索引（用于数组/集合）映射 POJO。它还提供了多种[处理器](http://supercsv.sourceforge.net/cell_processors.html)，可用于转换和验证数据。

正如 JohnB 所说，写 CSV 相对容易，读起来[相当复杂](http://supercsv.sourceforge.net/csv_specification.html)。话虽如此，我仍然建议使用图书馆进行写作。它是免费和开源的！与其推出自己的解决方案，不如考虑为开源解决方案做出贡献？这样其他人就可以从您的想法中受益:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T20:53:43.583

阅读 csv 很困难，而写作则不然。您可以用双引号将所有值括起来，并用双双引号替换字段值中的双引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:15:07.760

[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/) 是一个值得一看的 Java API

# java - 使用 ws-security 时是否应加密 SoapFaults

> ID：12308144
> 
> 赞同：1
> 
> 时间：2012-09-06T20:48:34.417
> 
> 标签：java, web-services, cxf, ws-security

我正在尝试使用来自 Apache CXF 的 Web 服务，但由于 soapfault 未加密而出错。我想检查soapfault并提供更具描述性的错误消息。我正在使用的 Web 服务是否应该加密soapfault？可以将 CXF 配置为使用引发未加密肥皂错误的 Web 服务吗？

# mediaelement.js - 如何禁用 MediaElementPlayer 的缓冲区

> ID：12308147
> 
> 赞同：2
> 
> 时间：2012-09-06T20:48:59.867
> 
> 标签：mediaelement.js, mediaelement

不幸的是，我在同一页面上有多个播放器，并且想禁用正在播放的歌曲的自动加载/缓冲。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T22:12:39.413

您是否尝试过设置有`preload="none"`问题的音频/视频标签？

# networking - 如何在 Vagrant 中增加 RAM 并设置仅限主机的网络？

> ID：12308149
> 
> 赞同：97
> 
> 时间：2012-09-06T20:49:08.497
> 
> 标签：networking, configuration, vagrant

我想将 RAM 增加到至少 1 GB，并且我想将“仅主机”网络配置为使用“199.188.44.20”。

这是我的`Vagrantfile`：

```
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant::Config.run do |config|

    config.vm.customize ["modifyvm", :id, "--memory", 1024]

    config.vm.network :hostonly, "199.188.44.20"

    config.vm.define :web do |web_config|
        web_config.vm.box = "lucid32"
        web_config.vm.forward_port 80, 8080

        web_config.vm.provision :puppet do |puppet|
            puppet.manifests_path = "manifests"
            puppet.manifest_file = "lucid32.pp"
        end
    end

    config.vm.define :web2 do |web2_config| 
        web2_config.vm.box = "lucid32"
        web2_config.vm.forward_port 80, 8081

        web2_config.vm.provision :puppet do |puppet|
            puppet.manifests_path = "manifests"
            puppet.manifest_file = "myweb.pp"
        end
    end
end 
```

但是，当我跑步时，`vagrant up`我得到：

> *尝试启动时，VM 未能保持在“运行”状态。这通常是由错误配置或主机系统不兼容引起的。请打开 VirtualBox GUI 并尝试手动启动虚拟机以获取更多信息错误消息*

而且，`connection refuse`当我尝试登录虚拟机时，我遇到了错误。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2014-10-20T15:07:35.417

要在使用 Vagrant 2 时增加内存或 CPU 数量，请将其添加到您的 Vagrantfile

```
Vagrant.configure("2") do |config|
    # usual vagrant config here

    config.vm.provider "virtualbox" do |v|
        v.memory = 1024
        v.cpus = 2
    end
end 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2013-04-23T08:30:05.270

由于`Vagrant 1.1` `customize`选项变得特定于 VirtualBox。

现代的做法是：

```
config.vm.provider :virtualbox do |vb|
  vb.customize ["modifyvm", :id, "--memory", "256"]
end 
```

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2012-09-11T17:08:59.470

您可以通过添加以下配置来修改各种 VM 属性（[有关更多信息，请参阅 Vagrant 文档](http://vagrantup.com/v1/docs/config/vm/customize.html)）：

```
 # Configure VM Ram usage
  config.vm.customize [
                        "modifyvm", :id,
                        "--name", "Test_Environment",
                        "--memory", "1024"
                      ] 
```

您可以从 VirtualBox 命令行选项的文档中获取要更改的属性：

*   [http://www.virtualbox.org/manual/ch08.html#vboxmanage-modifyvm](http://www.virtualbox.org/manual/ch08.html#vboxmanage-modifyvm)

[vagrant 文档](http://vagrantup.com/v1/docs/host_only_networking.html)中有关于如何更改 IP 地址的部分：

```
Vagrant::Config.run do |config|
  config.vm.network :hostonly, "192.168.50.4"
end 
```

您也可以像这样重组配置，结束是与结束而不嵌套它。这更简单。

```
config.vm.define :web do |web_config|
    web_config.vm.box = "lucid32"
    web_config.vm.forward_port 80, 8080
end
web_config.vm.provision :puppet do |puppet|
    puppet.manifests_path = "manifests"
    puppet.manifest_file = "lucid32.pp"
end 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-05-20T05:45:15.807

我无法得到任何这些答案。这是我最终放在我的 Vagrantfile 最顶部的内容，在`Vagrant::Config.run do`块之前：

```
Vagrant.configure("2") do |config|
  config.vm.provider "virtualbox" do |vb|
    vb.customize ["modifyvm", :id, "--memory", "1024"]
  end
end 
```

我注意到快捷方式访问器样式“vb.memory = 1024”似乎不起作用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-23T07:21:45.203

您可以通过修改 vagrant 文件中 config.vm.provider 部分的 memory 属性轻松增加 VM 的 RAM。

```
config.vm.provider "virtualbox" do |vb|
 vb.memory = "4096"
end 
```

这会为您的 VM 分配大约 4GB 的 RAM。您可以根据您的要求更改此设置。例如，以下设置将为您的 VM 分配 2GB 的 RAM。

```
config.vm.provider "virtualbox" do |vb|
 vb.memory = "2048"
end 
```

尝试删除`config.vm.customize ["modifyvm", :id, "--memory", 1024]`文件中的，并添加上面的代码。

对于网络配置，尝试将`config.vm.network :hostonly, "199.188.44.20"`文件中的修改为`config.vm.network "private_network", ip: "199.188.44.20"`

# sql - Facebook ID 号与 api 不同

> ID：12308152
> 
> 赞同：0
> 
> 时间：2012-09-06T20:49:12.920
> 
> 标签：sql, facebook, api, login

我正在使用 facebook 应用程序来允许用户登录我的网站。

这工作正常，并提示用户在输入用户名和密码后允许该应用程序。

作为登录的一部分，我将一些用户信息提交到数据库，以便在我的网站上为他们创建个人资料。这适用于我的 4 个测试用户中的 2 个，并且正确的信息被保存到数据库中（姓名、电子邮件、id 等）。

但是，我的另外两个测试用户返回的 ID 号相同，这与 Facebook API 工具中显示的用户名的 ID 号不同。

因此，忽略有效的两个，我将与下面两个无效的问题讨论我的问题：

如果我从我的数据库中删除所有条目并使用 account3 登录，它将使用正确的用户名、电子邮件地址、名称等添加到数据库中。但是它的 ID 与 facebook API 工具中显示的 ID 不同。如果我使用 Account4 登录，我会收到一条错误消息，指出 ID 号存在重复 ID 这就是我暂时设计代码的方式，以便我可以调试此问题。如果我删除 account3 的条目并使用 account4 登录，那么它将使用正确的名称、电子邮件地址、用户名等保存到数据库中，但 ID 号仍然错误。

为什么这适用于 4 个帐户中的 2 个？当所有用户 ID 都应该是唯一的时，为什么我会收到重复 ID 错误？

任何帮助都会很棒。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:54:40.700

Facebook 使用 int64 作为 id，所以使用双精度就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T20:54:02.510

经过一段时间的研究，我终于找到了解决方案。

ID 对于 mysql 中的 int 字段来说太长了，所以它放置了最大可能的 ID 号。

我已将 ID 字段更改为 varchar(500)，我的问题已解决。

# c - 文件读/写缓冲区的最佳类型

> ID：12308154
> 
> 赞同：1
> 
> 时间：2012-09-06T20:49:23.620
> 
> 标签：c, alignment

`char[]`很长一段时间以来，我在读写文件时都使用简单的缓冲区。

假设我有一个非常简单的功能，例如：

```
int f(int fd_in, int fd_out)
{
    char buf[4096];
    char* bufp = buf;
    ssize_t ret, wr;

    ret = read(fd_in, buf, sizeof(buf));
    /* ... */

    while (ret > 0)
    {
        wr = write(fd_out, bufp, ret);
        /* ... */
    }

    return wr;
} 
```

现在，我对对齐问题有了更多的了解，我开始认为这实际上是次优的，因为缓冲区将针对`char`.

为了获得“更强”的对齐方式，为缓冲区使用不同的（更大的）整数类型似乎合理吗？它会使读/写更优化吗？福利能走多远？使用`posix_memalign`to get more alignment than integer types可以实现更好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T23:01:28.130

*   不要高估 memcpy() 的成本。在当前机器上，memcpy 运行“比总线快”，并且花费大量时间等待缓存槽被拉入。
*   4096 大小的缓冲区跨越多个缓存槽（64 字节大小，IIRC）。
*   操作系统也有自己的缓冲区。（必须从网络缓冲区或 DMA 内存中复制块以用于磁盘）
*   在部分读+写时，无论如何你都搞砸了。您的代码已准备好接收和发送 13 个字节。或 133 或 1333。或 4095。或 4096。在大多数情况下，*下一次*读/写不会很好地对齐。好消息：对于磁盘文件，大小可能是 512 的倍数。
*   两个系统调用（读+写）的成本比 memcpy 的（对齐或不对齐）高得多（在 Gray&Reuter 书的封面内有一个很好的估计成本表。可能有点过时，但仍然很有启发性）
*   （在 Linux 中）这个（copyfd 等）有一个内核内无缓冲区函数**更新**：*sendfile()*是名称，作为系统调用实现。
*   您总是可以尝试测量差异： int buff[4096 / sizeof(int)]; 至少会是int-aligned。最好的方法是使用 int 数组和 char 数组的联合。工会总是与最挑剔的成员的要求保持一致。

# c# - 如何将 System.Windows.Input.Key 转换为数字？

> ID：12308161
> 
> 赞同：3
> 
> 时间：2012-09-06T20:49:37.583
> 
> 标签：c#, keyboard, converter

我正在使用一个事件`PreviewKeyDown`，并将该键添加到一个键列表中，如下例所示：

```
 List<Key> keys = new List<Key>();
    private void MDIChildBackground_PreviewKeyDown(object sender, KeyEventArgs e)
    {        

        keys.Add(e.Key);
    } 
```

然后我想从列表中取出键并转换为整数。

例子：

```
 int number=int.parse(keys[0].ToString()); 
```

ps：只会输入数字

但问题在于转换为字符串，因为当我在键盘上键入一 (1) 并转换为字符串时，字符串值为“D1”而不是“1”。很快，如果我尝试将此字符串转换为整数，它会给出异常。

现在，我该如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:34:37.277

您可以使用[KeyInterop.VirtualKeyFromKey](http://msdn.microsoft.com/en-us/library/system.windows.input.keyinterop.virtualkeyfromkey%28v=vs.100%29)方法将 WPF 密钥转换为 Win32 虚拟密钥。它将返回所按下键的整数值。

例如，如果您按下`T`键，它将返回 84。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:53:53.377

如果您确定您只处理数字键，那么以下应该可以工作（我对 Windows.Input 不太熟悉 - 那是 WPF 的东西吗？）；

```
int Number = -1;

if( keys[0] >= Key.D0 && keys[0] <= Key.D9 )
   Number = keys[0] - Key.D0; 
```

对列表中的其他键重复此操作。

# ruby-on-rails - 轮胎和 Elasticsearch SearchRequestFailed SearchPhaseExecutionException

> ID：12308163
> 
> 赞同：1
> 
> 时间：2012-09-06T20:49:42.937
> 
> 标签：ruby-on-rails, exception, elasticsearch, tire

我用弹性搜索实现了轮胎。在本地，我的项目运行良好，搜索索引也没有问题。但是当我将我的应用程序部署到我的服务器时，我收到了以下错误消息：

Tire::Search::SearchRequestFailed (500 : {"error":"SearchPhaseExecutionException[未能执行阶段 [query_fetch]，完全失败；shardFailures {[hDTlT_K_Sl6P5regwKNJyg][articles] [0]: QueryPhaseExecutionException[[articles][0]: query[ConstantScore(NotDeleted(cache(_type:article)))],from[0],size[25],sort[!]: 查询失败[无法执行主查询]]; 嵌套: IOException[无法排序对于每个文档具有多个值或每个字段具有多个标记的字符串类型]; }]","status":500})：

我相信我的文章存储在我的索引中，因为创建它们时我没有收到任何错误。我还尝试使用以下方法手动运行相同的查询：

```
curl -XPOST 'http://localhost:9200/articles/article/_search' -d '{ 
    "sort": [ 
        { 
            "supplier_code": "desc" 
        } 
    ] 
}' 
```

我得到了几乎相同的回应：

{"error":"SearchPhaseExecutionException[未能执行阶段 [query_fetch]，完全失败；shardFailures {[hDTlT_K_Sl6P5regwKNJyg][articles][0]:QueryPhaseExecutionException[[articles][0]:query[ConstantScore(NotDeleted(cache(_type: article)))],from[0],size[10],sort[!]: Query Failed [Failed to execute main query]]; 嵌套: IOException[Can't sort on string types with more than one value per doc , 或每个字段多个标记]; }]","status":500}

那么有人可以指出我正确的方向吗？我复制了我在本地机器上使用的确切 sam 配置。太奇怪了，它在服务器上不起作用。

我在这里想念什么？

非常感谢提前

编辑：

我发现我正在尝试执行的排序导致了这个问题。这也与我的文章对象到弹性搜索的映射有关。

我试图排序的领域的东西放在 not_analyzed 我是对的吗？如果我只映射一个字段，是否需要显式映射我的所有字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:03:27.947

This is the actual issue: **Can't sort on string types with more than one value per doc, or more than one token per field.** It means one of two things: either you have multiple `supplier_code` fields per document or the field `supplier_code` is analyzed by an analyzer the produces multiple tokens (default analyzer would do that for some strings). Elasticsearch can only sort on fields that contains no more than one value per record. So, if you have multiple fields, you need to come up with another sort key or if you have a single field, you need to make it not_analyzed, or use some other analyzer that doesn't produce multiple tokens.

# java - 如何将 SSL 站点上的 reCaptcha 与 Java 库集成？

> ID：12308164
> 
> 赞同：0
> 
> 时间：2012-09-06T20:49:43.503
> 
> 标签：java, ssl, https, recaptcha

因此，有过时 URL 指向的人存在一个有据可查的问题：

```
https://api-secure.recaptcha.net/challenge<etc,etc> 
```

新的 URL 应该是：

```
https://www.google.com/recaptcha/api/XXX 
```

这一切都很好，但我正在使用谷歌的 reCaptcha 库，如下所述：

```
https://developers.google.com/recaptcha/docs/java 
```

您会注意到唯一的版本是 0.07，并且是在 2007 年上传的，比 2011 年 URL 更改公告早了 4 年。据我所知，没有更新版本的库提供 2011 年后的 URL 转换。有谁知道我们低级的 Java 开发人员有这样的库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T19:31:19.443

解决方案是这样做：

```
((ReCaptchaImpl) captcha).setRecaptchaServer("google.com/recaptcha/api";); 
```

希望能帮助遇到这个问题的人

# xpath - 为以下 xml 创建 xpath 表达式

> ID：12308165
> 
> 赞同：0
> 
> 时间：2012-09-06T20:49:44.913
> 
> 标签：xpath

我对 XPath 非常陌生，我正在创建一个 XPath 表达式以检索以下 xml 的多个元素

```
<ol>
<li>
    <a data- key="abc(/parent)" value="superval)">Parent</a> 
    <ol>
     <li>
        <a data-key="abc(/parent/1)" data-value="parent-val">Parent/1</a>
       <ol>
       <li>
          <a data-key="abc(/parent/1/1)" data-value="xyz">Parent/1/1</a>
       </li>
       <li>
          <a data-key="abc(/parent/1/2)" data-value="xyz">Parent/1/2</a>
       </li>
      <li>
          <a data-key="abc(/parent/1/3)" data-value="xyz">Parent/1/3</a>
       </li>
       <li>
          <a data-key="abc(/parent/1/4)" data-value="xyz">Parent/1/4</a>
       </li>
    </ol>
   </li>
 </ol>
 </li>
 <li>
  <a data-key="bcd/(parent1)" value="superval">Parent1</a>
 <ol>
     <li>
        <a data-key="bcd(/parent1/1)" data-value="parent-val">Parent1/1</a>
       <ol>
       <li>
          <a data-key="bcd(/parent1/1/1)" data-value="xyz">Parent1/1/1</a>
       </li>
       <li>
          <a data-key="bcd(/parent1/1/2)" data-value="xyz">Parent1/1/2</a>
       </li>
     <li>
          <a data-key="bcd(/parent1/1/3)" data-value="xyz">Parent1/1/3</a>
       </li>
       <li>
          <a data-key="bcd(/parent1/1/4)" data-value="xyz">Parent1/1/4</a>
       </li>
    </ol>
  </li>
 </ol>
</li>
</ol> 
```

上面的xml只是一个例子，每个父级可以包含多个子值。`parent/1/1/1`我需要搜索具有从 say ( ) 到 ( )开始的数据键值的元素`parent/1/1/4`，并为这些键提取`value`与其关联的属性的值。数据键值也可以跨越不同的父级，例如 ( `parent/1/1/1`) 到 ( `parent/1/1/2`)。

我需要为上述两种情况创建 XPath 表达式。我试过使用这个 XPath 表达式

```
//*[@data-key='abc(/parent/1/1/1)'] 
```

但它只给了我一个`<a>`元素，因为我需要一系列元素。我对 XPath 完全陌生，所以这方面的任何帮助都会很有用。

提前谢谢了。阿希什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:07:54.873

尝试使用 contains() 函数，以及您要查找的范围，如下所示：

```
//*[contains(@data-key,'abc(/parent/1/1/)')] 
```

这将为您提供具有至少具有该根的数据键的所有节点，例如在您的示例中为 (parent/1/1/1) 到 (parent/1/1/4)。尽管您提供的 xml 片段不包含该范围的数据键，但您可以将斜杠/数字编辑为您想要的。

# magento - 如何覆盖 Magento 中的搜索和建议？

> ID：12308166
> 
> 赞同：0
> 
> 时间：2012-09-06T20:49:46.630
> 
> 标签：magento, search, magento-1.7

我想修改 Magento 搜索表单发送的查询（修剪零、删除连字符等）。我必须覆盖哪些方法才能使其在 magento 搜索、建议和高级搜索中工作？（我使用magento CE 1.7）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T11:50:19.123

从搜索表格的地方开始`POST`：

1.  [`Mage_CatalogSearch_ResultController::indexAction()`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/CatalogSearch/controllers/ResultController.php#L44)
2.  [`Mage_CatalogSearch_AdvancedController::resultAction()`](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/CatalogSearch/controllers/AdvancedController.php#L44)

在这些方法中的每一个中，您都可以通过相应的搜索集合跟踪链，例如：

*   `Mage_CatalogSearch_Block_Advanced_Result::_getProductCollection()`
    *   `Mage_CatalogSearch_Model_Advanced::getProductCollection()`
        *   等等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T22:32:22.953

我最终所做的是重写 Mage_CatalogSearch_Helper_Data 并按照此处的建议覆盖 getQueryText()：[https ://stackoverflow.com/a/11308076/594323](https://stackoverflow.com/a/11308076/594323)

# java - 扩展 JMenu 给它一个复选框？

> ID：12308168
> 
> 赞同：5
> 
> 时间：2012-09-06T20:50:01.017
> 
> 标签：java, swing, jmenu, jmenuitem

我计划将 JMenu 和 JCheckBoxMenuItem 结合起来，这样我就可以拥有：（1）一个包含这个新组件实例的弹出菜单。(2) 这个新组件将在左侧有一个复选框，并且能够向右扩展并显示其他子菜单（如常规 JMenu）

我有几个问题：

首先，我是在重新发明轮子吗？/ 这以前做过吗？

其次，我想弄清楚 swing 是如何知道如何为扩展的 Component 类获取 UI 类的？（例如，我看到 JMenu 有一个 String uiClassID 成员，它*以某种方式*用于此目的，但它不是确切的类名......我将它调试为 UIDefaults 中的 HashTable 查找）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:17:41.490

1.  我认为用户看到带有复选框的 JMenu 会感到困惑（如果我理解正确，您想将这个东西直接放在 JMenuBar 中）。我不认为以前经常这样做，这是有原因的:)

2.  使用的 UI 类取决于实际的外观。查看 javax.swing.plaf.MenuItemUI 的子类

此处描述了有关 Swing 架构的完整故事：http: [//java.sun.com/products/jfc/tsc/articles/architecture/](http://java.sun.com/products/jfc/tsc/articles/architecture/)

> 外观实现为每个抽象 plaf UI 类提供了具体的子类。例如，Windows 外观定义了 WindowsButtonUI、WindowsScrollBarUI 等。当一个组件安装它的 UI 委托时，它必须有一种方法可以动态地为当前的默认外观查找适当的具体类名。此操作使用哈希表执行，其中密钥由组件中的 getUIClassID() 方法以编程方式定义。约定是为这些键使用 plaf 抽象类名。

编辑：如果你想把它放在一个弹出菜单中，请注意 JPopupMenu 是一个 JComponent，因此你可以把任何东西放在那里，包括普通的 JCheckBoxes。一个例子在这里：[http ://www.javarichclient.com/do-more-with-jpopupmenu/](http://www.javarichclient.com/do-more-with-jpopupmenu/)

# java - Android/Java常用json导入接口

> ID：12308171
> 
> 赞同：5
> 
> 时间：2012-09-06T20:50:20.547
> 
> 标签：java, android, json, interface, import

我正在编写一个 Android 应用程序，它能够将`Activity`或的当前状态导出`Fragment`到 JSON 文件，该文件具有以下通用格式：

```
{
  "data": {
    "result": {
      <content depends on specific class>
    },
    "input": {
      <content depends on specific class>
    }
  },
  "identifier": <identifier depends on specific class>,
  "version": 1
} 
```

这意味着具有导出功能的`Activities`/`Fragments`填充了实现我称为“可导出”的接口的标记内容，并且整个导出功能调用了接口中定义的方法。这是一个直截了当的解决方案，效果很好。

到目前为止，一切都很好。现在我想做相反的方向。我想加载一个文件并根据标识符的内容调用对应的`Activity`/ 。`Fragment`

读取“输入”和“结果”的内容应通过`Activity`/`Fragment`本身的方法来完成。

不幸的是，这对我来说如何以优雅的方式解决这个问题并不明显。最好的方法是什么？解决方案应尽可能抽象，以便于扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T20:05:00.557

这个问题可能有很多不同的答案。Google 有一个名为 GSON 的库，它可以自动在 Java 类中读取和写入 JSON 数据。如果不想使用库，可以使用 Java 反射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T12:30:54.457

if-else 将是最简单的解决方案，但如果它对您来说不够抽象，请使用[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。

创建一个`ExportableFactory`接口，该接口定义一个方法来创建一个`Exportable`, 以及该接口的实现`Activity`和`Fragment`。然后创建一个`Map<String, ExportableFactory>`将可能的值映射`identifier`到正确的工厂。然后调用：

```
Exportable exportable = factoryMap.get(identifier).createExportable(data); 
```

这样，如果您想添加 的第三个实现`Exportable`，您只需创建相应的实现`ExportableFactory`并将其添加到地图中，而无需修改调用函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T00:11:34.077

JSONObject js= 新 JSONObject("数据");

JSONObject jSObject1=js.getJSONObject("结果"); JSONObject jSObject2=js.getJSONObject("输入"); 等等，我希望我能理解你的问题

# sql-server - CTE 不适用于额外的连接子句

> ID：12308174
> 
> 赞同：0
> 
> 时间：2012-09-06T20:50:34.800
> 
> 标签：sql-server, tsql

有人能告诉我为什么当我为 [PropertyId] 添加额外的连接信息时返回 0 条记录吗？我知道这很简单，但是我不知所措。

```
declare @ViewId as int;

set @ViewId = 11;

with Views
as
(
    select [LiveWireView].[Id], [LiveWireView].[Name], [LiveWireView].[ParentId], [PropertyToViewMap].[PropertyId]
    from [LiveWireView]
    inner join [PropertyToViewMap] on [PropertyToViewMap].[ViewId] = [LiveWireView].[Id]
    where [LiveWireView].[Id] = @ViewId
    union all
    select [v].[Id], [v].[Name], [v].[ParentId], [p].[PropertyId]
    from [LiveWireView] v
    inner join [PropertyToViewMap] p on [p].[ViewId] = [v].[Id]
    inner join Views on Views.Id = v.ParentId
)

select [PropertyId] from Views; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:53:06.390

如果您添加了此联接：

```
inner join [PropertyToViewMap] p on [p].[ViewId] = [v].[Id] 
```

并且不再获得结果，我认为说没有符合这些条件的记录是一样的。您可以通过将其转换为 a`LEFT JOIN`并查看是否为`PropertyId`

# iphone - ios如何在动画完成后删除子视图（animationDidStop）

> ID：12308176
> 
> 赞同：-3
> 
> 时间：2012-09-06T20:50:36.070
> 
> 标签：iphone, ios, core-animation, uiviewanimationtransition

我很少有子视图响应相同的动画。我想在动画完成后删除子视图（animationDidStop）。是一种检测 animationDidStop 中动画子视图的方法吗？

在这种特殊情况下：

```
 if ([animationID isEqualToString:@"myAnimation"])
    view.removeSubView:myView; 
```

如果是正确的子视图，你怎么看？，因为我之前说过一些子视图响应相同的动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T20:57:20.380

您可以为动画命名（每个视图都需要一个唯一的动画名称）：

```
[UIView beginAnimations:@"myAnimation" context:nil];
myView.alpha = 1.0f;     // or whatever property you're animating...
[UIView commitAnimations]; 
```

然后在

```
- (void)animationDidStop:(NSString *)animationID finished:(NSNumber *)finished context:(id)context
{
    if ([finished boolValue])
    {
        if ([animationID isEqualToString:@"myAnimation"])
            [myView removeFromSuperview];
    }
} 
```

或者更好的是，使用 iOS4+ 块动画方法及其完成处理程序，您将能够在完成处理程序中更清晰地引用正在动画的视图。例如

```
[UIView animateWithDuration:0.4f animations:^
{ 
    myView.alpha=1.0f; 
} 
completion:^(BOOL finished)
{
    [myView removeFromSuperview];
}]; 
```

# asp.net-mvc - 客户端的身份验证令牌存储在哪里？

> ID：12308182
> 
> 赞同：6
> 
> 时间：2012-09-06T20:50:54.493
> 
> 标签：asp.net-mvc, authentication, asp.net-web-api

我想在 Azure 上托管一个 MVC 4 Web API 项目。我需要确保可以从任何第三方应用程序和任何浏览器访问 API。实现一个简单地返回 JSON 的 RESTful API 对我来说是个好主意。现在，对我来说最大的挑战是创建与平台无关的身份验证机制。我不想使用默认的 MembershipProvider。我将使用 SSL。我也不会使用 FormsAuthentication。所有 API 调用都将通过 JQuery/AJAX。

我正在尝试了解基于令牌的身份验证。这是我认为我可以做的： - 客户端通过 HTTPS 将他们的用户凭据发送到服务器 - 服务器对客户端进行身份验证，创建令牌，将其连同日期时间戳和到期期限一起保存到数据库，然后将其发送回客户端 - 客户端每次访问 API 时都会将令牌发送到服务器

现在，我不明白的部分是，客户端将令牌存储在哪里？它是否保存在 cookie 中？如果是这样，非浏览器第三方应用程序在哪里保存身份验证令牌？代币被盗有多容易？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T04:40:55.113

身份验证令牌由 ASP.net 成员资格提供程序和身份验证模块存储在 cookie 中。在客户端，HTTP 客户端库可以处理 cookie。无 cookie 身份验证也可以使用表单身份验证。如果通道未加密（ssl 或 https），则中间人嗅探器可以窃取令牌。安全的 websapps 为身份验证 cookie 设置了一个小的超时，这样一小段不活动就会使会话过期，从而使 cookie 过期。

但是对于 API 身份验证，身份验证机制可能不同。每个呼叫都可以独立验证。因此无需为客户端维护令牌。每个 API 调用的 Authorization 标头应该有一些服务器可以识别的秘密。Amazon AWS 使用这种风格的 API 身份验证，许多其他的也遵循这种风格。使用 webapi，您可以实现这种身份验证。

1.  客户有一个由服务器签发或由用户为该帐户导入服务器的私钥。

2.客户端照常调用API，但将一些信息放入Authorization标头中。该信息将是发送的数据的 HMAC 与客户的帐户 ID 和日期混合。

这是 HTTP API 中的授权标头应该是什么样子

```
Authorization: account-id  HMAC_OF_WITH_SECRET_KEY(data + account-id + GMT Date that will be in date header) 
```

3.在服务器端（WebApi 端），您需要为 WebApi 控制器自定义 AuthorizeAttribute。这些自定义身份验证将接收来自客户端的请求，并与客户端所做的相反。服务器有客户端私钥，它可以像客户端一样排列数据并再次计算HMAC。如果此 HMAC 与 Authorization 标头中发送的 HMAC 相同，则它是帐户或用户 ID 的身份验证客户端。请注意，授权标头具有 account-id + HMAC 密钥。因此，使用此标头服务器中的 account-id 或 user-id 可以知道哪个客户端正在请求。

该机制涵盖身份验证以及数据完整性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T04:17:14.867

客户端需要将令牌安全地存储在其应用程序空间中。它可以选择进一步加密令牌。

cookie 也是存储令牌的地方，但问题是某些客户端没有 cookie 的优势。所以想想一般情况。

# javascript - jsf的xthml文件中的javascript中的不等号（“<”）引发错误（在netbeans中）

> ID：12308183
> 
> 赞同：4
> 
> 时间：2012-09-06T20:51:00.420
> 
> 标签：javascript, jsf, netbeans, xhtml

> **可能重复：**
> [javax.servlet.ServletException：错误解析/page.xhtml：元素的内容必须由格式良好的字符数据或标记组成](https://stackoverflow.com/questions/4338538/javax-servlet-servletexception-error-parsing-page-xhtml-the-content-of-elemen)

这是一个 jsf 2.0 项目。

xhtml 文件：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
    <h:head>
        <title>Ring</title>
        <h:outputScript library="js" name="jquery-1.8.1.min.js" />
        <h:outputScript library="js" name="processing-1.4.1.js" />

        <script type="text/javascript">
            $(function(){
                var pjs = Processing.getInstanceById("viz");
                var json = #{TableMatchesBean.json};
                var data = eval("("+json+")");
                if(data) {

                    for(i=0; i<data.segments.length; i++) {
                        var segment = data.segments[i];
                        pjs.addSegment(segment.label, segment.count,segment.isMain);
                    }
                }
            }); //end ready
        </script>

    </h:head>
    <h:body>

        <canvas id ="viz" data-processing-sources="common.pde"></canvas>

    </h:body>
</html> 
```

在 javascript 中 for 循环的第一行，

```
for(i=0; i<data.segments.length; i++) { 
```

Netbeans 引发此错误：“致命错误：元素类型“data.segments.length”必须后跟属性规范“>”或“/>”。”

这个错误表明“<”被解释为一些xhtml，而不是js（我认为）。这是Netbeans的错误还是这里的js和xhtml之间真的存在混淆？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-06T20:54:11.243

将 JavaScript 代码移动到外部 JavaScript 文件

或者

使用[CDATA](https://developer.mozilla.org/en-US/docs/Properly_Using_CSS_and_JavaScript_in_XHTML_Documents#Using_CDATA_Instead_of_Comments)

```
<script type="text/javascript">
 //<![CDATA[
  var i = 0;

  while  (++i < 10)
  {
    // ...
  }
 //]]>
</script> 
```

# python - 为什么我不能在这个分叉的进程中读取标准输入？

> ID：12308186
> 
> 赞同：2
> 
> 时间：2012-09-06T20:51:11.273
> 
> 标签：python, fork, stdin, pty

下面的代码什么也不打印，但它应该重复打印出“a”。os.read(0, 1) 上的分叉进程阻塞。父进程确实在写入 stdin_master，但 stdin_slave 什么也没收到。有任何想法吗？

```
import os
import pty
import resource
import select
import signal
import time

stdin_master, stdin_slave = pty.openpty()
stdout_master, stdout_slave = pty.openpty()
stderr_master, stderr_slave = pty.openpty()

pid = os.fork()

# child process
if pid == 0:
    os.setsid()
    os.close(stdin_master)
    os.close(stdout_master)
    os.close(stderr_master)

    os.dup2(stdin_slave, 0)
    os.dup2(stdout_slave, 1)
    os.dup2(stderr_slave, 2)

    max_fd = resource.getrlimit(resource.RLIMIT_NOFILE)[0]
    os.closerange(3, max_fd)

    while True:
        char = os.read(0, 1)
        os.write(1, char)

    os._exit(255)

# parent process
else:
    os.close(stdin_slave)
    os.close(stdout_slave)
    os.close(stderr_slave)

    try:
        while True:
            read, write, err = select.select([stdout_master], [stdin_master], [], 0)
            for to_read in read:
                print os.read(to_read, 1)

            for to_write in write:
                os.write(to_write, "a")

            time.sleep(0.1)

    finally:
        os.kill(pid, signal.SIGKILL) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:24:20.813

Thomas Wouters 很友好地提供了答案：

PTY 只能从主 fd 中读取。因此，孩子的 os.read(0, 1) 无法正常工作。如果我们改变

```
stdin_master, stdin_slave = pty.openpty() 
```

至

```
stdin_slave, stdin_master = pty.openpty() 
```

现在 chlid 将从 master 读取，我们将从 parent 写入 slave。这行得通。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:22:44.273

我不确定您是否想在`pty`这里使用该模块。您似乎需要的基本上是一对[`os.pipe`](http://docs.python.org/library/os.html#os.pipe)'s。

这是一个使用管道的解决方案：

```
import os
import select
import signal
import time

stdin_slave, stdout_master = os.pipe()
stdin_master,stdout_slave  = os.pipe()

pid = os.fork()

# child process
if pid == 0:

    while True:
        char = os.read(stdin_slave, 1)
        os.write(stdout_slave, char)

    os._exit(255)

# parent process
else:
    try:
        while True:
            read, write, err = select.select([stdin_master], [stdout_master], [], 0)

            for to_read in read:
                print os.read(to_read, 1)

            for to_write in write:
                os.write(to_write, "a")

            time.sleep(0.1)

    finally:
        os.kill(pid, signal.SIGKILL) 
```

# html - IE7 边框超出容器宽度

> ID：12308191
> 
> 赞同：0
> 
> 时间：2012-09-06T20:51:25.140
> 
> 标签：html, css, border

我正在尝试使用 div 在容器中设置分隔线。 [这是代码的小提琴](http://jsfiddle.net/dkindler/WtCPR/)

在所有浏览器中都可以正常工作，除了 IE7，其中边框延伸通过容器 div 的右边框区域。尝试了很多东西。不知道还有什么可以尝试的。

顺便说一句，如果有更好的方法使用 HR 或其他东西，我愿意，但我喜欢 div 边界线的外观。该线必须延伸到容器 div 的左右边界。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:20:34.577

添加这个类，然后在所有浏览器中完美运行。

```
.dividlineContainer
{
    width:308px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:03:39.783

## 负利润的解决方案？

以下情况如何：

```
.divideline {
  height:1px;
  line-height:1px;
  border-top:1px solid #ccc;
  margin: 8px -1.5em 8px -.75em;
} 
```

我目前无法访问 IE7 版本进行测试，但它应该可以工作。它适用于我能够测试的所有东西（FF、Chrome、Opera、Safari）。

您的原始版本在 Internet Explorer 中超出范围的原因是由于在将填充应用于父元素时计算子元素的百分比宽度/高度时浏览器之间的差异。不同之处在于每个浏览器实现了不同的“盒子模型”。有关主题结帐的进一步阅读[http://www.quirksmode.org/css/box.html](http://www.quirksmode.org/css/box.html)或[http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/](http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/)

```
.divideline {
  ...
  width:125%;
  ...
} 
```

此外，如果您所涉及的元素改变了宽度，使用 +25% 来考虑您的 .75em 填充会导致问题 - 因为混合测量只会在某些值处对齐。

## 更好的方法

而不是实施必须依靠负边距才能正确定位的分界线。最好使用 HTML 自然的工作方式，而不是反对它。以下内容将使您的生活更轻松：

```
<div class="ccr">
  <div class="pad divide-after">
    <p>
     Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
     do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
     Ut enim ad minim veniam.
    </p>
  </div>
  <div class="pad">
    <p>
     Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed 
     do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
     Ut enim ad minim veniam.
    </p>
  </div>
</div> 
```

接着：

```
.ccr {
  width: 48%;
  margin: 0 0 0 11px; 
  border: 1px solid #ccc;
}

.pad {
  padding: .75em;
  margin-bottom: 8px;
}

.divide-after {
  border-bottom: 1px solid #ccc;
} 
```

通过将填充应用于单独的无尺寸元素，您可以自动避免盒模型问题 - 因为尺寸和填充总是单独计算的。并且通过将您的划分添加到现有的包装器意味着您减少了标记。

# mysql - 数据建模 - 为什么不是属性的平面表？

> ID：12308193
> 
> 赞同：0
> 
> 时间：2012-09-06T20:51:29.353
> 
> 标签：mysql, ruby-on-rails, database, database-design

我正在与一位刚接触编程的同事一起工作，我正在尝试解释 ORM（和 SRP）的一些概念，但不知何故我失败了。这是一个 Rails 应用程序。

我正在使用的应用程序的类层次结构如下所示：

-CallFlow——
路由（多态）
——RouteOptions

有特定于各种 Route 的属性，每个 RouteType 都有自己的一组选项。理想情况下，对我来说，会有一个 call_flows 表，每个路由类型的表，然后对于具有选项的路由类型，该路由类型的选项表。一个非常粗糙的模型：

![在此处输入图像描述](../Images/93a51640ec8b2c33cc2f4b819ad9a85f.png)

Simple_route 和 outbound_route 没有选项。在确实有选项的路线中，它是一个 has_many 关系，为我们提供了该路线的一系列选项。

相反，我的同事想将特定于每个路由的所有字段放在 call_flows 表中。这是该模式的模型：

![在此处输入图像描述](../Images/8ce4c18c2069efadd5df2f824bc44455.png)

因此，您将拥有一个大的 call_flows 表，其中的字段并不适用于每条记录。事实上，只有少数人愿意。我的建模决定背后的原因如下：

*   它遵循基本的标准化模式
*   它减少了空值的数量，从而减少了数据库大小
*   改变更灵活
*   它遵循基本的SRP原则

我错过了什么吗？如果有任何资源可以帮助新程序员了解 DB 规范化的重要性，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:23:07.583

标准化背后的核心概念是`Data Dependency`vs `Functional Dependency`。在规范化模式中，只有依赖关系是功能依赖关系，由业务或数据语义决定。例如，RouteOptions 依赖于 Route。

在非规范化表中，由于所有数据都存储在所有地方，因此将存在数据依赖以及函数依赖。在这种情况下，很难执行事务并以 100% 的信心断言您的数据模型是一致的。

让我们举个例子。您想添加一个新的路线选项。这是你的交易。在规范化表中，您在 RouteOption 表中创建一条新记录，并将 Route_ID 填写在同一记录中。您 100% 确信您的数据模型在事务之后是一致的。

采用非规范化模式，假设您有相同的 RoutOption 表和 RouteSummary 表，其中包含来自多个表的列。当您在此架构上执行上述事务时，您的数据模型并不一致。您必须“记住”才能更新 RouteSummary 表。几天后，将创建一些其他表，该表也将具有 RouteOption。先前存在的事务将不知道这个新表。

非规范化模式也有一个地方。当您的数据存储不是事务性的时。如果它是 ReadOnly 模式，主要用于分析原因，则不会有事务，因此不会有数据不一致的风险。因此，它们在该用例中是可以的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T20:58:23.473

我真的不明白通过拥有额外的 *_options 表可以获得什么。即这里的内容不能只进入表中的路线类型。

话虽如此，您使用不同的路由类型、选项等描述的那种复杂结构对我来说似乎更适合 NoSQL、无模式的存储方法。在这种情况下，您可以只拥有一个路由集合，每个集合在属性、选项等方面都可以有自己独特的结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T06:26:10.917

您的案例看起来像是称为“泛化专业化”或简称 Gen-Spec 的设计模式的一个实例。如何使用数据库表对 gen-spec 建模的问题一直出现在 SO 中。

如果您在 Java 等 OOPL 中对 gen-spec 进行建模，您将使用子类继承工具来为您处理细节。您只需定义一个类来处理泛化对象，然后定义一个子类集合，每个子类都扩展其父超类。它简单明了。

不幸的是，据我所知，关系数据模型没有内置子类继承，并且 SQL 数据库系统不提供任何此类工具。但你并不是不走运。您可以设计您的表以与 OOP 的类结构相似的方式对 gen-spec 进行建模。当新项目添加到通用类时，您必须安排实现自己的继承机制。详情如下。

Martin Fowler 确定了三种不同的模仿继承的表格设计。您喜欢的设计接近于 Fowler 所说[的 Class Table Inheritance](http://martinfowler.com/eaaCatalog/classTableInheritance.html)。您的同事喜欢的设计接近于 fowler 所说的[Single Table Inheritance](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)。每个都有其优点和缺点。

类表继承的有趣部分称为共享主键。在这里，子类表有一个具有双重职责的键。它是主键，也是返回超类表的外键引用。当创建新条目时，您的应用程序必须将键值从超类表传播到适当的子类表。

当您需要将数据重新连接在一起时，就会出现平滑的部分。基于共享主键的加入操作非常灵活、简单且快速。

# java - 弹簧注入类

> ID：12308194
> 
> 赞同：3
> 
> 时间：2012-09-06T20:51:41.757
> 
> 标签：java, spring

我是使用 Spring 的新手，我刚刚加入了一个开发团队，该团队正在将它用于我们正在开发的产品。我开始了解 IoC。但是，我在一个特定点上感到困惑。我一直在寻找答案，但找不到任何东西。

我正在查看的课程上`@Controller`设置了注释。其中一种方法具有`@RequestMapping`注释。这个特定方法的方法签名包含我公司的一个专有类的参数。这个专有类没有针对 Spring 的任何注释，也没有在 Spring 配置文件中列出。

所以，我的问题是：**当没有任何东西可以帮助框架识别它时，如何注入该参数？**

我怀疑它能够做到这一点，因为在之前的交易中，专有类是通过添加到模型中的`ModelAndView.addObject()`，但我希望有人可以确认或否认。

具体情况是这样的：

1.  用户请求登录页面
2.  `addObject(proprietaryClass)`
3.  显示登录页面的用户
4.  用户点击按钮登录
5.  使用方法签名中的专有类调用方法。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:09:48.510

在您的 bean 配置中的某处，您会发现一个转换服务 bean。如果其他开发人员很好，他们会将其命名为“ConverterFactory”，并且可能会扩展`org.springframework.format.support.FormattingConversionServiceFactoryBean`. 您还可以 grep 的代码库`org.springframework.format.FormatterRegistry`。

这在[Spring 参考手册](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert)中有描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:11:32.380

春天很聪明……真的很聪明。它可以查看请求参数的名称，并按字段名称将它们映射到 POJO。例如，如果您的用户有“first”和“last”字段，您可以传入 user.first=Joe&user.last=Blow，它会尝试设置用户对象的“first”和“last”属性。看看[http://www.jpalace.org/docs/technotes/spring/mvc-params.html](http://www.jpalace.org/docs/technotes/spring/mvc-params.html)特别是名为 Binding Domain Objects 的部分。

另一种选择是他们已经实施了转换器或转换器工厂。在我的项目中，我实现了一个通用的 ConverterFactory 来处理我的任何数据库实体，采用 Long 并通过 id 查找将其转换为物化实体。

# c# - 没有注释的 Protobuf-net 序列化

> ID：12308196
> 
> 赞同：23
> 
> 时间：2012-09-06T20:51:48.830
> 
> 标签：c#, serialization, annotations, protobuf-net

我查看了[这个](https://stackoverflow.com/questions/8175030/is-datamemberorder-n-annotation-required-for-protobuf-net-v2)答案，我处于不需要保持向后兼容性的情况，我必须有一个可以工作的解决方案，而无需使用 protobuf-net 所需的属性来装饰数十个类。所以我尝试使用`RuntimeTypeModel.Default.InferTagFromNameDefault = true;`但我可能没有正确使用它，因为 Serializer.Serialize 调用仍然会引发异常，要求签订合同。这是我的快速测试，我做错了什么？

```
public enum CompanyTypes
{
    None, Small, Big, Enterprise, Startup
}

public class BaseUser
{
    public string SSN { get; set; }    
}

public class User : BaseUser
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int Age { get; set; }
    public DateTime BirthDate { get; set; }
    public List<string> Friends { get; set; }
    public Company Company { get; set; }
}

public class Company
{
    public string Name { get; set; }
    public string Address { get; set; }
    public CompanyTypes Type { get; set; }
    public List<Product> Products { get; set; }
}

public class Product
{
    public string Name { get; set; }
    public string Sku { get; set; }
}

[TestClass]
public class SerializationTest
{
    [TestMethod]
    public void SerializeDeserializeTest()
    {
        var user = new User
                       {
                           Age = 10,
                           BirthDate = DateTime.Now.AddYears(-10),
                           FirstName = "Test First",
                           LastName = "Test Last",
                           Friends = new List<string> { "Bob", "John" },
                           Company = new Company
                                         {
                                             Name = "Test Company",
                                             Address = "Timbuktu",
                                             Type = CompanyTypes.Startup,
                                             Products = new List<Product>
                                             {
                                                new Product{Name="Nerf Rocket", Sku="12324AC"},
                                                new Product{Name="Nerf Dart", Sku="DHSN123"}
                                             }
                                         }
                       };

        RuntimeTypeModel.Default.InferTagFromNameDefault = true;
        using (var memoryStream = new MemoryStream())
        {
            Serializer.Serialize(memoryStream, user);
            var serialized = Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-07T06:20:36.023

`InferTagFromName`（它是双胞胎，`InferTagFromNameDefault`）仅在需要为成员解析*标签号*时才出手；它们不会影响需要序列化的成员（因此目前的答案是：没有，即使系统知道它们）。您*可能*选择的选项是`ImplicitFields`，但目前仅可用作`[ProtoContract(...)]`标记。如果你不介意*一点*注释，一个务实的修复可能是：

```
[ProtoContract(ImplicitFields = ImplicitFields.AllPublic)] 
```

on `User`, `Company`and `Product`, 和一些更复杂的东西`BaseUser`（因为继承）：

```
[ProtoContract(ImplicitFields = ImplicitFields.AllPublic, ImplicitFirstTag = 10)]
[ProtoInclude(1, typeof(User))] 
```

请注意，我们不必为每个成员添加大量注释。如果你真的是真的反属性，那么也可以通过代码来配置整个模型，通过：

```
RuntimeTypeModel.Default.Add(typeof(Product), false).Add("Name", "Sku");
RuntimeTypeModel.Default.Add(typeof(Company), false).Add("Name", "Address",
         "Type", "Products");
RuntimeTypeModel.Default.Add(typeof(User), false).Add("FirstName", "LastName",
         "Age", "BirthDate", "Friends", "Company");
RuntimeTypeModel.Default.Add(typeof(BaseUser), false).Add(10, "SSN")
         .AddSubType(1, typeof(User)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-09-14T10:53:47.797

这个问题很老，但也许有人会需要这个。我实现了**ProtobufSerializer**类，它将在使用时构造您的类型图。您只需要使用**[KnownTypeAttribute]**和**[DataMember]** / **[IgnoreDataMember]**属性来注释您的 DTO。大多数情况下，这是某个人的另一个 nuget 项目的重构版本。这样你就不需要在你的合约依赖中包含 protobuf：

```
 internal sealed class ProtobufSerializer
    {
        private readonly RuntimeTypeModel _model;
        private const BindingFlags Flags = BindingFlags.FlattenHierarchy | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance;
        private readonly Dictionary<Type, HashSet<Type>> _subTypes = new Dictionary<Type, HashSet<Type>>();
        private readonly ConcurrentDictionary<Type, bool> _builtTypes = new ConcurrentDictionary<Type, bool>();
        private static readonly Type[] ComplexPrimitives = new [] { typeof(object), typeof(ValueType), typeof(Enum), typeof(Array)};
        private readonly object _sync = new object();

        public ProtobufSerializer()
        {
            _model = TypeModel.Create();
        }

        public void Serialize(Stream s, object input)
        {
            EnsureType(input.GetType());
            _model.Serialize(s, input);
        }

        public T Deserialize<T>(Stream s)
        {
            EnsureType(typeof(T));
            return (T)_model.Deserialize(s, null, typeof(T));
        }

        public void EnsureType(Type type)
        {
            if (_builtTypes.ContainsKey(type))
            {
                return;
            }
            lock (_sync)
            {
                if (_builtTypes.ContainsKey(type))
                {
                    return;
                }
                var all = GetGraph(type).ToArray();
                foreach (var t in all)
                {
                    InternalBuild(t);
                }
            }
        }

        private void InternalBuild(Type type)
        {
            if (IsPrimitive(type))
            {
                return;
            }

            FlatBuild(type);
            EnsureBaseClasses(type);
            EnsureGenerics(type);

            _builtTypes.TryAdd(type, false);
        }

        private bool IsPrimitive(Type type)
        {
            return type == null || type.IsPrimitive || _model.CanSerializeBasicType(type) || _builtTypes.ContainsKey(type) || ComplexPrimitives.Contains(type);
        }

        private static IEnumerable<Type> GetGraph(Type type)
        {
            return type.TraverseDistinct(GetConnections).Distinct().OrderBy(x=> x.FullName);
        }

        private static Type GetParent(Type type)
        {
            return type.BaseType;
        }

        private static IEnumerable<Type> GetChildren(Type type)
        {
            var knownTypes = type.GetCustomAttributes(typeof(KnownTypeAttribute)).Cast<KnownTypeAttribute>().Select(x => x.Type).ToArray();
            foreach (var t in knownTypes)
            {
                yield return t;
            }

            var fields = GetFields(type);
            var props = GetProperties(type);
            foreach (var memberType in fields.Select(f => f.FieldType))
            {
                yield return memberType;
            }
            foreach (var memberType in props.Select(f => f.PropertyType))
            {
                yield return memberType;
            }
        }

        private static IEnumerable<Type> GetConnections(Type type)
        {
            var parent = GetParent(type);
            if (parent != null)
            {
                yield return parent;
            }
            var children = GetChildren(type);
            if (children != null)
            {
                foreach (var c in children)
                {
                    yield return c;
                }
            }
        }

        private void FlatBuild(Type type)
        {
            if(type.IsAbstract)
                return;

            var meta = _model.Add(type, false);
            var fields = GetFields(type);
            var props = GetProperties(type);
            meta.Add(fields.Select(m => m.Name).ToArray());
            meta.Add(props.Select(m => m.Name).ToArray());
            meta.UseConstructor = false;
            foreach (var memberType in fields.Select(f => f.FieldType).Where(t => !t.IsPrimitive))
            {
                InternalBuild(memberType);
            }
            foreach (var memberType in props.Select(f => f.PropertyType).Where(t => !t.IsPrimitive))
            {
                InternalBuild(memberType);
            }
        }

        private static FieldInfo[] GetFields(Type type)
        {
            return type.GetFields(Flags).Where(x => x.IsDefined(typeof(DataMemberAttribute))).Where(x => !x.IsDefined(typeof(IgnoreDataMemberAttribute))).ToArray();
        }

        private static PropertyInfo[] GetProperties(Type type)
        {
            return type.GetProperties(Flags).Where(x => x.IsDefined(typeof(DataMemberAttribute))).Where(x=> !x.IsDefined(typeof(IgnoreDataMemberAttribute))).ToArray();
        }

        private void EnsureBaseClasses(Type type)
        {
            var baseType = type.BaseType;
            var inheritingType = type;

            while (!IsPrimitive(baseType))
            {
                HashSet<Type> baseTypeEntry;

                if (!_subTypes.TryGetValue(baseType, out baseTypeEntry))
                {
                    baseTypeEntry = new HashSet<Type>();
                    _subTypes.Add(baseType, baseTypeEntry);
                }

                if (!baseTypeEntry.Contains(inheritingType))
                {
                    InternalBuild(baseType);
                    _model[baseType].AddSubType(baseTypeEntry.Count + 500, inheritingType);
                    baseTypeEntry.Add(inheritingType);
                }

                inheritingType = baseType;
                baseType = baseType.BaseType;
            }
        }

        private void EnsureGenerics(Type type)
        {
            if (type.IsGenericType || (type.BaseType != null && type.BaseType.IsGenericType))
            {
                var generics = type.IsGenericType ? type.GetGenericArguments() : type.BaseType.GetGenericArguments();

                foreach (var generic in generics)
                {
                    InternalBuild(generic);
                }
            }
        }
    } 
```

还有一些简单的扩展：

```
 public static IEnumerable<T> TraverseDistinct<T>(this T enumer, Func<T, IEnumerable<T>> getChildren)
    {
        return new[] { enumer }.TraverseDistinct(getChildren);
    }
    public static IEnumerable<T> TraverseDistinct<T>(this IEnumerable<T> enumer, Func<T, IEnumerable<T>> getChildren)
    {
        HashSet<T> visited = new HashSet<T>();
        Stack<T> stack = new Stack<T>();
        foreach (var e in enumer)
        {
            stack.Push(e);
        }
        while (stack.Count > 0)
        {
            var i = stack.Pop();
            yield return i;
            visited.Add(i);

            var children = getChildren(i);
            if (children != null)
            {
                foreach (var child in children)
                {
                    if (!visited.Contains(child))
                    {
                        stack.Push(child);
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-09T13:05:33.140

在这个阶段它是相当实验性的，但我制作了一个小型库，它采用大多数类型并在运行时生成 Protobuf-net 序列化程序：[https ://github.com/fnicollier/AutoProtobuf](https://github.com/fnicollier/AutoProtobuf)

# javascript - 使用 JavaScript 从用户输入追加行

> ID：12308198
> 
> 赞同：0
> 
> 时间：2012-09-06T20:51:57.940
> 
> 标签：javascript, jquery, tablerow

我是一个非常早期的初学者，正在尝试用 JavaScript 做一些事情。

基本上我有一个 HTML 表单，用于收集用户输入。我有一个提交按钮。提交时，我希望将输入中的值作为新行附加到表中。

我花了几个小时试图找到一个方向，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:48:54.090

由于没有其他人愿意（或不能）提供纯 JS 答案，因此您可以使用纯 JavaScript 做到这一点。如果有些事情不清楚，请告诉我，我很乐意为您提供有用的链接并解释此代码的作用：

HTML：

```
<table id='targetTbl'>
    <tbody>
        <tr><th>Name</th><th>First name</th></tr>
    </tbody>
</table>
<form id='inForm'>
    <input type='text' name='name' id='name'/>
    <input type='text' name='first' id='first'/>
    <input type='submit' value='add row'/>
</form>​ 
```

JavaScript：

```
document.getElementById('inForm').onsubmit = function(e)
{
    var newRow,i;
    e = e || window.event;
    if (e.preventDefault)
    {
        e.preventDefault();
        e.stopPropagation();
    }
    e.returnValue = false;
    e.cancelBubble = true;
    newRow = '<tr>';
    for(i=0;i<this.elements.length;i++)
    {
        if (this.elements[i].tagName.toLowerCase() === 'input' && this.elements[i].type === 'text')
        {
            newRow += '<td>'+this.elements[i].value+'</td>';
        }
    }
    document.getElementById('targetTbl').innerHTML += newRow + '</tr>';
    return false;
}; 
```

为了使其工作，您需要在 HTML 文件的底部包含此代码（不推荐）以确保在您尝试更改之前已加载 DOM，或者您必须将此代码放入其中事件处理程序：

```
window.onload = function()
{
    //above code goes here
}; 
```

[这是一个工作小提琴](http://jsfiddle.net/SaxNH/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:04:46.230

Few points to consider:

*   You do not want your submit button to work. That means you do not want it to take you to the `action` you specified in the form element. So you either add an onclick event which (`<input type="submit" onclick="dosomething();return false;" />`) returns false, or you make it of type "button" (`<input type="button" onclick="dosomething();" />`).

*   You need to define a function that should be called when the button is pressed:

Example:

```
function dosomething() {
    alert("I did something");
    // do something useful
} 
```

*   You need to create a `<table>` tag, and add rows to it based on your data. ~~You could use jQuery for that, and I would recommend that to get you starting quickly. DOM manipulation in javascript is a pain.~~ You know what, forget jQuery. Check [@Elias's answer](https://stackoverflow.com/a/12308894/1043456) for a better, cleaner, faster approach. And also, it teaches you much more. It might be a valuable asset when/if you do use a library, and it certainly will, if you can do without one.

~~Example (in jQuery):~~

 ~~```
var table = $("<table></table>");
for (var i=0; i<data.length; i++) {
    var tr = $("<tr></tr>");
    var td = $("<td></td>");
    $(td).text(data[i]);
    $(tr).append(td);
    $(table).append(tr);
}
$("body").append(table); 
```~~  ~~* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T08:17:27.227

好的，伙计们，在阅读了更多内容并请朋友解释之后，我能够使用 jQuery 做到这一点。很抱歉我一开始没有添加jQuery标签，因为我不知道。但是我从第一个 js 练习就接触到了 jQuery。所以我最终能够掌握这一点。所以这就是我所拥有的，它对我有用。如果这是正确的，可能对像我这样的学习者有用。

我的输入字段的 ID 是“名字”和“姓氏”。getElementById().value 获取用户输入的值。

```
var firstname = document.getElementById("firstname").value;
var lastname = document.getElementById("lastname").value; 
$("#myTable tr:last").after("<tr><td>" + firstname + "</td><td>" + lastname + "</td></tr>" ); 
```

我通过按钮 onclick() 调用这个函数。谢谢你的支持。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-06T21:03:58.000

You can use this function. You need to send as a parameter the id of the table and change valueInputForm with the variables in which you have the values of the inputs

```
function addRow(tableID) {      

    var table = document.getElementById(tableID);

    var rowCount = table.rows.length;
    var row = table.insertRow(rowCount);

    var cell1 = row.insertCell(0);
    cell1.innerHTML = valueInputForm;

    var cell2 = row.insertCell(1);
    cell2.innerHTML = valueInputForm;

    var cell3 = row.insertCell(2);
    cell2.innerHTML = valueInputForm;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-06T20:55:59.903

你有两个选择：

**经典**：您提交表格。服务器读取表单，并为添加了新行的表单的新副本生成 HTML，并将其发送回浏览器。

**Ajax**：您使用 AJAX 在后台提交表单，然后使用 JavaScript，将新行附加到 HTML 客户端。

您选择哪种取决于您对后端与前端编码的舒适程度。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-06T21:05:57.680

假设你有这个 html HTML：

```
<form id="target">
  form-field1: <input type="text" id="form-field1" value="Hello there" />
  form-field2: <input type="text" id="form-field2" value="How are you" />
  <input type="submit" value="Go" />
</form>
<div id='targettable'><table><thead></thead><tbody></tbody></table></div> 
```

您可以使用 jquery：

```
$("#target :input").each(function(){
 var input = $(this); // This is the jquery object of the input, do what you will
  $("#targettable >tbody:last').append($(this).val());
}) 
```

将 jquery 脚本添加到标记中的代码`<head>`中

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```~~

# c# - 未处理无效的 CastException

> ID：12308201
> 
> 赞同：0
> 
> 时间：2012-09-06T20:52:02.183
> 
> 标签：c#, facebook, facebook-graph-api, sdk, facebook-c#-sdk

尝试从[http://facebooksdk.blogspot.co.uk/2011/04/facebook-groups.html运行代码时出现以下错误](http://facebooksdk.blogspot.co.uk/2011/04/facebook-groups.html)

错误是“Invalid CastException Was Unhandled”和“Specified Cast Is Not Valid”

我正在使用 Facebook C# SDK，并且正在使用以下代码...

```
 public Dictionary<string, string> GetGroups()
    {
        string accessToken = _accessToken;
        FacebookClient facebookClient = new FacebookClient(accessToken);
        JsonObject resul = facebookClient.Get("https://graph.facebook.com/me/groups?access_token=" + accessToken) as JsonObject;
        Dictionary<string, string> dicGroups = new Dictionary<string, string>();
        foreach (JsonObject item in (((KeyValuePair<string, object>)(resul[0])).Value as JsonArray))
        {
            comboBox1.Items.Add(item["id"].ToString());
        }
        return dicGroups;
    } 
```

有人可以帮忙吗？我正在尝试获取所有用户组的列表并将它们添加到组合框中。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:08:14.423

我更多地查看了 Facebook C# SDK，并且 api 返回了一个 json 组字符串。您需要遍历 json 字符串中的每个对象以获得所需的内容。

```
JsonObject groups = facebookClient.Get("me/groups") as JsonObject;
foreach(var group in (JsonArray)groups["data"])
{
    comboBox1.Items.Add(item["id"].ToString());
    ...
} 
```

注意：您需要提示用户提供`user_groups`扩展权限才能检索组。按照[此链接](http://blog.prabir.me/post/Facebook-CSharp-SDK-Writing-your-first-Facebook-Application.aspx)获取提示扩展权限的示例。我没有 Facebook 应用程序，因此无法测试权限提示和检索组信息。

# iphone - 在应用程序中创建信用卡支付网关

> ID：12308204
> 
> 赞同：1
> 
> 时间：2012-09-06T20:52:04.683
> 
> 标签：iphone, credit-card

我正在为 iPhone 和 Android 开发一个使用 Titanium 的应用程序。我想让用户输入他们的信用卡详细信息，然后每当他们确认付款时，我只需将数据发送给信用卡处理公司。付款是针对披萨，而不是针对 App Content，所以我认为 Apple 对此没有问题。我应该使用网络视图进行信用卡处理，还是您建议如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:53:03.643

由于您有自己的处理器，您可以使用[card.io](https://www.card.io/)或[Jumio](https://pay.jumio.com/)来捕获信用卡数字，这样用户就不必输入它们。然后只需将信用卡号、CVV 和到期日期传递给您的 API 进行处理付款。在 webview 或 native 中执行此操作应该没有什么不同。

在 SO 上[的这篇文章](https://stackoverflow.com/questions/7469274/accept-credit-card-payment-in-iphone-app)中提到了一个 PayPal API 。它仍然会启动一个 webview。

# javascript - Safari 上的 Javascript 奇怪的日期 JSON 表示

> ID：12308205
> 
> 赞同：0
> 
> 时间：2012-09-06T20:52:21.903
> 
> 标签：javascript, json, date, safari

我发现 Safari (5.1.7 (6534.57.2)) 有一个奇怪的问题，在将日期转换为字符串时，我得到一个毫秒数为负数的表示。

```
new Date(1966,6,7,20,45,38,713) 
```

结果`.toJSON()`是：

```
"1966-07-07T18:45:38.-287Z" 
```

它是一个 Safari 错误（如我所愿）还是有任何奇怪的 Javascript 规则，这是预期的（甚至是可接受的）行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T21:52:03.837

`toJSON`webkit 错误跟踪器中的算法存在一个错误：

*   [Date.prototype.toJSON 不执行步骤 1-2](https://bugs.webkit.org/show_bug.cgi?id=105282)

它看起来像另一个测试用例，但它也可能是这个问题的根本原因。

# iphone - 视网膜中的 ClipToMask

> ID：12308206
> 
> 赞同：1
> 
> 时间：2012-09-06T20:52:24.493
> 
> 标签：iphone, ios, xcode, ios5

对于 iPhone，我正在使用 CGContextClipToMask 剪辑图像。

在 320x480 中，它看起来很漂亮。但在视网膜显示器/模拟器中，掩蔽看起来像是在 320x480 中完成的，*然后*放大到 640x960 - 它看起来有点简陋。

正在使用正确的 640x960 图像（我已标记它们以确保）。

我的代码如下。有谁知道它可能是什么？将非常感谢一些帮助。非常感谢。

```
-(id)makeMainImage:(UIImage*)initMaskImg initMainImage:(UIImage*)initMainImage{

    //get images
    UIImage *mainImg = initMainImage;
    UIImage *maskImg = initMaskImg;

    //new context, to draw image into
    UIGraphicsBeginImageContext(mainImg.size);
    CGContextRef context = UIGraphicsGetCurrentContext();

    //position context
    CGContextTranslateCTM(context, 0,480);
    CGContextScaleCTM(context, 1.0, -1.0);//flip coordinates

    //rect
    CGRect imageRect = CGRectMake(0, 0, 320, 480);

    //set mask
    CGContextClipToMask(context, imageRect, maskImg.CGImage);

    //main image
    CGContextDrawImage(context, imageRect, mainImg.CGImage);

    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();    

    return newImage;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:11:58.500

不要使用'UIGraphicsBeginImageContext'，使用

```
UIGraphicsBeginImageContextWithOptions(size, opaque, 0); // last option is the scale option 
```

这就是您创建视网膜图像的方式。

# java - Struts2 获取当前 URL

> ID：12308208
> 
> 赞同：1
> 
> 时间：2012-09-06T20:52:27.800
> 
> 标签：java, jakarta-ee, struts2

我试图编写一个侦听器，在会话超时之前从用户那里获取当前 URL。我需要将此网址存储在数据库中。

```
public class SessionTimeoutListener implements HttpSessionListener,SessionAware {

HttpServletRequest request;

@Override
public void sessionDestroyed(HttpSessionEvent event) {

    String url = request.getRequestURL().toString();
// url is empty here!!
    }

@Override
public void sessionCreated(HttpSessionEvent arg0) {

}

@Override
public void setSession(Map<String, Object> arg0) {
    session=arg0;
  }
} 
```

我是 struts2 和 java 编程的新手......我不明白为什么我在那一行得到一个空值。我是否必须将 url 设置在某个地方才能让我得到它，如图所示？还是听众本身不正确？

# r - ddply 汇总字符串操作

> ID：12308209
> 
> 赞同：5
> 
> 时间：2012-09-06T20:52:31.927
> 
> 标签：r, plyr

我现在正在使用`ddply`。处理数字非常容易。例如取子组的均值或标准差。

但是我很难处理字符串。我想将每个子组中同一列中的字符串组合起来，但我做不到。我试过`cbind` `paste`了，等等。任何人都可以提供一些帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T20:58:45.223

添加`collapse=""`到您的粘贴语句

```
ddply(mtcars, .(carb), summarize, cyl_concatenated = paste(cyl, collapse = ""))
#  carb cyl_concatenated
#1    1          4664444
#2    2       8444888444
#3    3              888
#4    4       6686688888
#5    6                6
#6    8                8 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-06T21:37:40.803

我看到达森有办法。我宁愿将单独的东西分开，并建议：

```
 ddply(mtcars, .(carb), summarize, cyl_list = list(as.character(cyl)))
#-----------
  carb                     cyl_list
1    1          4, 6, 6, 4, 4, 4, 4
2    2 8, 4, 4, 4, 8, 8, 8, 4, 4, 4
3    3                      8, 8, 8
4    4 6, 6, 8, 6, 6, 8, 8, 8, 8, 8
5    6                            6
6    8                            8 
```

您还可以修改 Dason 以使用 collapse=", "，它看起来与上面相同，但结构不同。使用`list()`该示例时您需要转换为字符，或者您获得因子变量的整数编码。

# sybase - 使用 RapidSQL 导出 Sybase 表数据的方法

> ID：12308212
> 
> 赞同：0
> 
> 时间：2012-09-06T20:52:37.423
> 
> 标签：sybase, dump, rapidsql

我正在尝试使用 RapidSQL 导出 Sybase DB 表。我作为客户端访问数据库表，因为数据库位于远程服务器上。

我需要将用逗号分隔的表格内容转储到我的本地机器上。

有哪些方法可以实现？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:46:22.747

使用 Sybase bcp 实用程序。它允许您从数据库中逐表导出数据。默认情况下，我相信它会创建一个 TAB 分隔文件，但您可以使用 -t 选项更改字段分隔符，使用 -r 选项更改行分隔符。

可以在[此处的 Sybase 文档中找到更多信息](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc30191.1502/html/utility/X51453.htm)

# java - 如何让 Spring MVC 在 JUnit 测试中调用验证？

> ID：12308213
> 
> 赞同：15
> 
> 时间：2012-09-06T20:52:38.183
> 
> 标签：java, spring, spring-mvc, junit, bean-validation

我有一个名为 Browser 的 POJO，我用 Hibernate Validator 注释进行了注释。

```
import org.hibernate.validator.constraints.NotEmpty;

public class Browser {

    @NotEmpty
    private String userAgent;
    @NotEmpty
    private String browserName;

...

} 
```

我编写了以下单元测试，试图验证我的 Controller 方法是否捕获了验证错误。

```
@Test
public void testInvalidData() throws Exception {
    Browser browser = new Browser("opera", null);
    MockHttpServletRequest request = new MockHttpServletRequest();

    BindingResult errors = new DataBinder(browser).getBindingResult();
    // controller is initialized in @Before method
    controller.add(browser, errors, request);
    assertEquals(1, errors.getErrorCount());
} 
```

这是我的控制器的 add() 方法：

```
@RequestMapping(value = "/browser/create", method = RequestMethod.POST)
public String add(@Valid Browser browser, BindingResult result, HttpServletRequest request) throws Exception {
    if (result.hasErrors()) {
        request.setAttribute("errorMessage", result.getAllErrors());
        return VIEW_NAME;
    }

    browserManager.save(browser);

    request.getSession(false).setAttribute("successMessage",
            String.format("Browser %s added successfully.", browser.getUserAgent()));

    return "redirect:/" + VIEW_NAME;
} 
```

我遇到的问题是结果永远不会有错误，所以就像@Valid 没有得到认可。我尝试将以下内容添加到我的测试类中，但它并没有解决问题。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"file:path-to/WEB-INF/spring-mvc-servlet.xml"}) 
```

有谁知道在使用 JUnit 进行测试时如何让 @Valid 被识别（和验证）？

谢谢，

马特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:31:05.567

The validation is done before the call to the controller, so your test is not invoking this validation.

There is another approach to testing controllers, where you dont invoke the controller directly. Instead you construct and call the URL that the controller is mapped on. Here is a good example of how to do this: [http://rstoyanchev.github.com/spring-31-and-mvc-test/#1](http://rstoyanchev.github.com/spring-31-and-mvc-test/#1)

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(loader=WebContextLoader.class, locations = {"classpath:/META-INF/spring/applicationContext.xml", "classpath:/META-INF/spring/applicationContext-test-override.xml", "file:src/main/webapp/WEB-INF/spring/webmvc-config.xml"})
public class MyControllerTest {
@Autowired
WebApplicationContext wac;
MockMvc mockMvc;

@Before
public void setup() {
    this.mockMvc = MockMvcBuilders.webApplicationContextSetup(this.wac).build();
}

@Test
@Transactional
public void testMyController() throws Exception {
    this.mockMvc.perform(get("/mycontroller/add?param=1").accept(MediaType.TEXT_HTML))
    .andExpect(status().isOk())
    .andExpect(model().attribute("date_format", "M/d/yy h:mm a"))
    .andExpect(model().attribute("myvalue", notNullValue()))
    .andExpect(model().attribute("myvalue", hasSize(2)))
    .andDo(print());
}
} 
```

POM (need to use spring milestone repo):

```
 <!-- required for spring-test-mvc -->
    <repository>
        <id>spring-maven-milestone</id>
        <name>Spring Maven Milestone Repository</name>
        <url>http://maven.springframework.org/milestone</url>
    </repository>
...
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-test-mvc</artifactId>
        <version>1.0.0.M1</version>
        <scope>test</scope>
    </dependency> 
```

NOTE: the spring-mvc-test lib is not production ready yet. There are some gaps in the implementation. I think its planned to be fully implemented for spring 3.2.

This approach is a great idea as it tests your controllers fully. Its easy to mess up your controller mappings, so these do really need to be unit tested.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T21:32:03.163

在调用控制器方法之前调用验证器 - 在将请求绑定到方法参数的过程中。由于在这种情况下您直接调用控制器方法，因此绕过了绑定和验证步骤。

让它工作的方法是通过 Spring MVC 堆栈调用控制器 - 有几种方法可以做到这一点，我觉得最好的方法是使用[spring-test-mvc](https://github.com/SpringSource/spring-test-mvc)，它提供了一个很好的机制通过堆栈调用。

通过堆栈调用的另一种方法是以这种方式将 HandlerAdapter 注入到测试中：

```
@Autowired
private RequestMappingHandlerAdapter handlerAdapter; 
```

然后在测试中：

```
MockHttpServletRequest request = new MockHttpServletRequest("POST","/browser/create");
MockHttpServletResponse response = new MockHttpServletResponse();
httpRequest.addParameter(.... );//whatever is required to create Browser..
ModelAndView modelAndView = handlerAdapter.handle(httpRequest, response, handler); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:33:17.717

基本上你用 实例化了一个 POJO `this.controller = new MyController()`，然后调用它的方法`this.controller.add(...)`。只是带有简单对象的简单 Java，没有任何上下文：不考虑 @Valid。

@ContextConfiguration 只会加载您可能的 bean，以及可能的自定义验证器等，但它不会发挥处理 @Valid 的魔力。

您需要的是模拟对控制器`add`方法的请求。完全模仿它，包括验证。您离这样做不远了，因为您使用了一些 Spring 测试工具（实例化 MockHttpServletRequest）。

**如果您使用 Spring 3.0.x 或更低版本**，则需要执行

```
new AnnotationMethodHandlerAdapter()
      .handle(request, new MockHttpServletResponse(), this.controller); 
```

让它工作。

**如果您使用 Spring 3.1+**，上述解决方案将不起作用（[请参阅此链接了解更多信息](http://forum.springsource.org/showthread.php?120616-NPE-in-AnnotationMethodHandlerAdapter-in-unit-tests-of-Controllers)）！您将需要使用[这个库](https://github.com/SpringSource/spring-test-mvc)（来自 Spring 团队，所以听起来不用担心），同时等待他们将其集成到下一个 Spring 版本中。然后你将不得不做类似的事情

```
myMockController = MockMvcBuilders.standaloneSetup(new MyController()).build();
myMockController.perform(get("/browser/create")).andExpect(...); 
```

还可以看看罗森·斯托扬切夫（Rossen Stoyanchev）的这些非常[有趣的幻灯片](http://rstoyanchev.github.com/spring-31-and-mvc-test)（我们在这里讨论的部分从幻灯片 #116 开始）！

注意：我不会讨论这种测试是否被视为单元测试或集成测试。有人会说这是我们在这里进行的集成测试，因为我们模拟了请求的完整路径。但另一方面，您仍然可以使用来自 Mockito 的 @Mock 注释来模拟您的控制器（或使用任何其他模拟框架做类​​似的事情），所以其他人会说您可以将测试范围缩小到几乎纯粹的“单元测试” . 当然，您也可以使用普通的旧 Java + 模拟框架对您的控制器进行纯粹的单元测试，但在这种情况下，这将不允许您测试 @Valid 验证。做出你的选择 ！:)

# model-view-controller - 我的 CustomViewController 没有被调用

> ID：12308217
> 
> 赞同：0
> 
> 时间：2012-09-06T20:52:52.587
> 
> 标签：model-view-controller, view, xcode4, viewcontroller

这与[使用协议和委托](https://stackoverflow.com/questions/12302508/using-a-protocol-and-a-delegate)有关，我已经缩小了问题范围

我有一个 NavigationController 有两个正确显示的视图。

“GraphView”是一个名为 GraphViewController 的 ViewController 中的视图。在对象检查器中，“GraphViewController”和“GraphView”分别正确显示在 ViewController 和 View 的自定义类框中。

但是，在 GraphViewController 中，我已将此代码（如下）放在 setGraphView 方法中，并且永远不会调用它。好像 GraphViewController 没有被设置为 GraphView 的 GraphViewController。

我使用的代码是（我@synthesize GraphView 进一步向上）

```
- (void) setGraphView:(GraphView *)graphView {
    _graphView = graphView;
    self.graphView.dataSourceDelegate = self;
    [self.graphView setNeedsDisplay];
    NSLog(@"just set Graph View");
    } 
```

我从来没有收到 NSLog 消息，我在一个类似（但工作）的应用程序中这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:03:55.040

关于链接的评论是一个线索。我通过 ctrl 将链接从视图下方的栏中的圆形图标拖到 GraphView 视图组件中，即 ViewController 旁边的视图组件中重新制作了链接。

检查器的内容保持不变，但它确实起到了作用，随后代码正在运行。

# ios - Cocos2d：在CCMenuItem的selected方法中调用选择器

> ID：12308218
> 
> 赞同：0
> 
> 时间：2012-09-06T20:53:02.480
> 
> 标签：ios, cocos2d-iphone, selector, ccmenuitem

当调用 CCMenuItemSprite 的“selected”方法时，我想调用目标选择器（见下文：**buttonPressedWithId :）。**

```
 CCMenuItemSprite *buttonB = [CCMenuItemSprite itemWithNormalSprite:[CCSprite spriteWithSpriteFrameName:@"emptyCircle.png"] selectedSprite:[CCSprite spriteWithSpriteFrameName:@"greenCircle.png"] target:self  selector:@selector(buttonPressedWithId:)]; 
```

我查看了 CCMenuItemSprite 的实现，发现了这个：

```
-(void) selected
{
    [super selected];
    //HERE IS WHERE I WANT TO CALL buttonPressedWithId: 
    if( selectedImage_ ) {
        [normalImage_ setVisible:NO];
        [selectedImage_ setVisible:YES];
        [disabledImage_ setVisible:NO];

    } else { // there is not selected image

        [normalImage_ setVisible:YES];
        [selectedImage_ setVisible:NO];
        [disabledImage_ setVisible:NO];
    }
} 
```

目标是在 selected 方法中调用目标选择器。所以我查看了**initWithNormalSprite**方法，发现：

```
-(id) initWithNormalSprite:(CCNode<CCRGBAProtocol>*)normalSprite selectedSprite:(CCNode<CCRGBAProtocol>*)selectedSprite disabledSprite:(CCNode<CCRGBAProtocol>*)disabledSprite target:(id)target selector:(SEL)selector
{
    // avoid retain cycle
    __block id t = target;

    return [self initWithNormalSprite:normalSprite selectedSprite:selectedSprite disabledSprite:disabledSprite block:^(id sender) {
        [t performSelector:selector withObject:sender];
    } ];
} 
```

我想我必须以某种方式调用**_*块****函数，但我没有看到一个很好的例子来理解如何。我也不太清楚 ** _block* 是什么:(。

现在，我应该继承 CCMenuItemSprite 并更改此行为吗？如果是这样，我该如何调用目标选择器？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:08:45.160

CCMenuItemSprite - CCMenuItem 的超类中有 -activate 方法。因此，如果您愿意，您可以继承 CCMenuItemSprite 并使其 -selected 方法如下所示：

```
-(void) selected
{
    [super selected];
    [self activate];
} 
```

你也可以看到-activate的代码，很简单:)

# sublimetext2 - SublimeText2 键绑定可以映射到包命令，例如“SublimeREPL:Ruby”吗？

> ID：12308220
> 
> 赞同：0
> 
> 时间：2012-09-06T20:53:02.200
> 
> 标签：sublimetext2, key-bindings

我正在尝试创建用于在 ST2 中打开 SublimeREPL:Ruby 窗口的键绑定，但不确定是否可以为非基本命令创建快捷方式。

我搜索了[http://sublimetext.info/docs/en/reference/key_bindings.html](http://sublimetext.info/docs/en/reference/key_bindings.html)并用谷歌搜索了我的小心脏，但找不到任何关于为外国包创建键绑定的信息。

第二个想法（我是 1y/o 开发人员） - 我决定浏览包文件。我发现这个`/Users/administrator/Library/Application Support/Sublime Text 2/Packages/SublimeREPL/config/Ruby`：

```
[
 {
    "id": "tools",
    "children":
    [{
        "caption": "SublimeREPL",
        "mnemonic": "r",
        "id": "SublimeREPL",
        "children":
        [
            {"command": "repl_open", 
             "caption": "Ruby",
             "id": "repl_ruby",
             "mnemonic": "r",
             "args": {
                "type": "subprocess",
                "external_id": "ruby",
                "encoding": "utf8",
                "cmd": {"windows": ["irb.bat", "--noreadline", "--inf-ruby-mode"],
                        "linux": ["irb", "--noreadline", "--inf-ruby-mode"],
                        "osx": ["irb", "--noreadline", "--inf-ruby-mode"]},
                "soft_quit": "\nexit\n",
                "cwd": "$file_path",
                "cmd_postfix": "\n", // postfix 
                "suppress_echo": true,
                "syntax": "Packages/Ruby/Ruby.tmLanguage"
                }
            }
        ]   
    }]
}
] 
```

我创建了键绑定：`{ "keys": ["super+i", "super+r", "super+b"], "command": "repl_open" }`

但没有骰子。有任何想法吗？重启ST2可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T21:40:43.057

当您定义快捷键时，您应该向`repl_open`命令提供它在您提供的菜单项的声明中获得的参数。

尝试以下（未经测试，但与我在 REPL 中的另一个环境中的配置非常相似）：

```
{ "keys": ["super+i", "super+r", "super+b"], "command": "repl_open", "args":
   {
        "type": "subprocess",
        "external_id": "ruby",
        "encoding": "utf8",
        "cmd": {"windows": ["irb.bat", "--noreadline", "--inf-ruby-mode"],
            "linux": ["irb", "--noreadline", "--inf-ruby-mode"],
            "osx": ["irb", "--noreadline", "--inf-ruby-mode"]},
        "soft_quit": "\nexit\n",
        "cwd": "$file_path",
        "cmd_postfix": "\n", // postfix 
        "suppress_echo": true,
        "syntax": "Packages/Ruby/Ruby.tmLanguage"
   }
} 
```

一个更简单的选项（但配置较少）只是直接调用菜单项（同样，未经测试，但类似于我的配置）：

```
{ "keys": ["super+i", "super+r", "super+b"],
  "command": "run_existing_window_command", "args":
    {
        "id": "repl_ruby",
        "file": "config/Ruby/Main.sublime-menu"
    }
}, 
```

# c++ - c++隐式指针转换

> ID：12308227
> 
> 赞同：3
> 
> 时间：2012-09-06T20:53:19.090
> 
> 标签：c++, pointers, casting, implicit

我有以下测试程序（展示了我真正想要完成的事情）。

有谁知道如果没有 reinterpret_cast<> 是否可以实现以下操作？

```
struct B;

struct A {
  A() { }
  A( const B &b) { }
  A( const B *b) { }
  A( B *b) { }

  A* operator=(const B *b) { }
  A* operator=(B *b) { }
};

struct B {
  B() { }
  B( const A &a) { }
  B( const B * b) { }
  B( B *b) { }

  B* operator=(const A *a) { }
  B* operator=(A *a) { }
};

int main(int argc, char *argv[])
{
  A *a = new A();
  B *b = new B();

  A *c = b;

  return 0;
} 
```

我尝试尽我所能做每一个转换运算符，但我似乎无法得到

```
 A *c = b; 
```

不抱怨

```
error C2440: 'initializing' : cannot convert from 'B *' to 'A *' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T20:57:05.940

不，这是不可能的，因为 a`B`不是`A`. 您要么需要使用继承来创建`B`一个子类`A`（以便 a`B`是一个`A`），要么使用组合然后引用适当的子对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:21:03.920

不，不可能使该行不是错误，因为在您的示例中`B*`并且`A*`不能隐式转换。

如果它们以正确的顺序位于相同的继承层次结构中，或者如果`A`是`void`. 现在这些类型是不相关的，并且语言规则拒绝在这些不相关的指针类型之间进行隐式转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T21:43:52.570

不能投射指针。即使定义了 operator= 函数。这仅适用于相应的对象，而不适用于它们的指针。

像那样：

```
A *c;
*c = b;  //or 
c->operator=(b); 
```

# c# - 根据复选框选择填充数据

> ID：12308230
> 
> 赞同：0
> 
> 时间：2012-09-06T20:53:29.967
> 
> 标签：c#, asp.net-mvc

我在页面上有四个复选框，根据选择，需要填充数据。我能够将检查的项目发送到服务器，例如 type1:true、type2:false 等。但是如何有效地编写 if-else 块来检索数据。返回类型是相同的，但我需要从单独的表中提取并根据选择，我需要合并它们。我正在使用 dapper 进行数据库操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:50:07.157

感谢 DarthVader 的回复，很抱歉没有提供足够的信息。是的，我知道如何编写 ifelse 语句，但想知道是否可以通过一次只提供一种类型来完成任何缓存。它消除了 if-else 语句。我现在有了一个想法，通过为单个类型创建一个 js 数组，如果它为空，则访问服务器，否则从数组中获取。

# algorithm - 是否有经过充分研究的优化来找到穿过图的每个加权边的最短路径？

> ID：12308232
> 
> 赞同：4
> 
> 时间：2012-09-06T20:53:36.050
> 
> 标签：algorithm, graph

我一直在四处寻找，但似乎每个人最喜欢的问题的情况略有不同：TSP、哈密顿量、欧拉等。我有一个图，由 V（顶点）和 E（边）表示，其中每条边是无向的，并且有一定的遍历成本。我想以最低的成本遍历每一条边，并可能重复。

直观地说，这个问题感觉是 NP-hard，因为它与其他 NP-hard 问题非常相关。但是，我意识到由于路径可以重复边缘，因此可能更容易。

我的第一个想法是将边转换为顶点，将顶点转换为节点，并尝试像哈密顿量一样对其进行分析。但是，这具有只能访问每个节点一次的限制，并且我找不到任何关于放宽可以多次访问节点的问题的信息。

有谁知道我是否只是不擅长搜索并且这实际上是一个已知和研究的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-18T02:34:00.463

**这是什么**

您正在考虑**[中国邮递员问题](https://en.wikipedia.org/wiki/Route_inspection_problem)**，也称为路线检查问题或邮递员之旅。

**它能做什么**

该问题要求至少访问每个边一次的图的最短/最小成本之旅。这称为**中国邮递员之旅 (CPT)**解决此问题允许您在其他应用程序中：

*   找到校车或邮件递送的最佳路线，其中必须访问所有街道以接送乘客/投递邮件，并且公共汽车不限于仅访问街道一次。其他示例包括扫雪机路线、高速公路部门在街道上画线，或者警车试图在节拍中访问每条街道。

*   表征机器的复杂性和/或优化测试该机器。例如，按下电话上的按钮就像在状态之间采取有向边。菜单出现，菜单关闭。如果您知道手机可能处于的所有状态，那么求解 CPP 将为您提供测试所有状态转换的最佳计划。该计划的长度是机器复杂性的度量。例如，诺基亚 2110 手机的菜单子系统包含 88 个菜单项和 273 个操作。该系统的 CPT 有 515 次按键长度。[1]

**无向图**

这是最初的问题，由[Mei-Ko Kwan](https://en.wikipedia.org/wiki/Meigu_Guan)在 1960 年提出。他的论文在 1962 年被翻译成英文。 [2] 此后不久，表明该问题可以简化为匹配，因此可以在多项式时间内使用线性规划。[3] Grötschel 等人。给出一个很好的小历史。[5]

要解决此问题，请注意该图必须是单个[连通分量](https://en.wikipedia.org/wiki/Connected_component_(graph_theory))。

如果图是单个连接组件并且所有节点的[度数](https://en.wikipedia.org/wiki/Degree_(graph_theory))相等，则图具有[欧拉路径](https://en.wikipedia.org/wiki/Eulerian_path)。可以使用[Hierholzer 算法在](https://en.wikipedia.org/wiki/Eulerian_path#Hierholzer.27s_algorithm)*O(|E|)*时间内找到该路径。如果不是所有的节点都具有相同的度数，那么我们需要一个更强大的算法。

观察如果一个图有两个奇数度的节点，添加连接它们的额外边将导致一个[多重图](https://en.wikipedia.org/wiki/Multigraph)，其中每个节点都有偶数度。根据上述，这样的图具有易于找到的欧拉路径。进一步：无论采取哪条路线，必须经过多次的边将连接奇数度的两个节点。原因很容易理解：向其中一个奇数度节点添加一条边使其成为偶数度，但使入射在该边上的另一个节点具有奇数度。获得只有偶度节点的图的唯一方法是在两个奇度节点之间建立一条路径。为了最小化多重图上欧拉路径的成本，我们应该在两个奇数度节点之间沿着最小成本路径添加额外的边。这可以通过，比如说，[Dijkstra 算法](https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)。

现在，假设我们有`2n`奇数节点。通过对上述内容的一些思考，您可以说服自己，您将需要`n`连接这些顶点对的不同的、不重叠的路径。知道了这一点，解决问题的一种方法是使用[Floyd-Warshall 算法在](https://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)*O(|V|³)*时间内计算奇数度节点之间的所有对最短路径。然后可以在 *O(|E|*|V| log |V|)*时间内找到最大加权匹配。[4]

Michaels 对此有一个简单的文章以及一些直观的证明。[6] Laporte 提供了更技术性的描述，将匹配问题转换为线性整数程序。[7] 艾瑟尔特等人。给出另一个技术描述以及对相关问题的相当广泛的审查（见下文）。[8]

**其他一些变体**

由于我们总是只需要一个想法就可以使算法问题变得更难，这里有一些可能会引起兴趣的变体：

*   **完全有向图：只有当图是**[强连接](https://en.wikipedia.org/wiki/Strongly_connected_component)时才存在解决方案（对此有[快速测试](https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm)）。要找到解决方案，请在*O(|E|)*时间内计算每个顶点的入度和出度之间的差异。然后解决了一个多有限源网络问题：每个节点根据其输入输出差异产生或消耗流量。*在O(|V|² |E|)*时间内解决了最小权重最大流的问题。沿边的流动量是平行边的数量，必须在边上插入这些平行边以形成欧拉图。然后可以使用[Hierholzer 算法在](https://en.wikipedia.org/wiki/Eulerian_path#Hierholzer.27s_algorithm)*O(|E|)时间内找到欧拉之旅*. Harold Thimbleby 提供了一个文档齐全的 Java 实现（参见 [1]，还有他的[网站](http://www.harold.thimbleby.net/cpp/index.html)）。

*   **具有有向和无向边的图**：这个问题是 NP-Complete。即使图是[平面图](https://en.wikipedia.org/wiki/Planar_graph)，节点的总度数最多为 3，并且所有边的成本等于 1，它仍然如此。也就是说，即使在严重受限的情况下，混合图也是一个难题。[9]

*   **无向树图**：树的每条边被访问两次。有一些快速方法可以确定图表是否为树：请参阅[此](https://en.wikipedia.org/wiki/Tree_(graph_theory))wiki 页面。

*   **带有欧拉**环的图：欧拉环是 CPT。有一些快速方法可以确定图是否为欧拉图：请参阅[此](https://en.wikipedia.org/wiki/Eulerian_path)wiki 页面。

*   **必须根据优先级访问边的图**：这是*分层*CPP。它并不总是可以解决的。如果是，它可以是 NP 完全的。但是，在某些条件下，存在*O(N⁵)*算法。[10]

*   **带时间窗的图**：在这个公式中，每条边都与`[le,ue]`必须完成边的时间范围相关联。例如，当清道夫正在清扫街道并且要求某些街道在不同时间禁止车辆通行时，就会出现这样的问题。这个问题是 NP 难的，可以通过约束规划精确地解决。[11]

*   **你不需要访问所有的边缘**：这被称为**农村邮递员问题**。对于有向和无向情况，这个问题都是 NP-hard。具有有向和无向边的实例（**堆垛机问题**）也是 NP 难的。参见 [12] 进行审查。

*   **边的成本因遍历的方向而异**：这被称为有**风邮递员问题**。这个问题是NP完全的。[13]

[1] Thimbleby, H. 2003\. 指导的中国邮递员问题。软：实践。专家，33：1081-1096。doi:10.1002/spe.540

[2] 关美高。1962\. 使用奇数点或偶数点的图形编程，中国数学 1，第 273-277 页。

[3] Edmonds, J., Johnson, EL, 1973\. Matching、Euler tours 和中国邮递员。数学编程 5, 88–124。

[4] Galil, Z., Micali, S., Gabow, H. 1986。在一般图中寻找最大加权匹配的 O(EV log V) 算法。暹罗学家比较。15、120-130。

[5] Grötschel, M., Yuan, Y., 2012\. Euler, Mei-ko Kwan, Königsberg, and a Chinese Postman。优化故事 43.

[6] Michaels, JG, 1991\. 第 20 章：中国邮递员问题，载于：离散数学的应用。麦格劳-希尔高等教育，第 354-364 页。

[7] Laporte, G.，2014 年。第 3 章：无向中国邮递员问题，载于：弧形路由。第 53-64 页。

[8] Eiselt, HA, Gendreau, M., Laporte, G., 1995。弧路由问题，第一部分：中国邮递员问题。运筹学 43, 399–414。

[9] Papadimitriou, CH, 1976。关于边缘遍历的复杂性。ACM 杂志 (JACM) 23, 544–554。（如果这个 Papadimitriou 的名字看起来很眼熟，那可能是你认出他是[Logicomix](https://www.logicomix.com/en/index.html)中的一个角色）。

[10] Dror, M.、Stern, H. 和 Trudeau, P. (1987)，Postman tour on a graph with priority relationship on a arcs。网络，17：283-294。doi:10.1002/net.3230170304

[11] UF AMINU AND RW EGLESE, A constraint programming approach to the Chinese postman problem with time windows, Computers & Operations Research, 33 (2006), pp. 3423–3431.

[12] Eiselt, HA, Gendreau, M., Laporte, G., 1995。弧形路由问题，第二部分：农村邮递员问题。运筹学 43, 399–414。

[13] 关美谷（1984），《论有风的邮递员问题》，离散应用数学，9（1）：41-46，doi：10.1016/0166-218X（84）90089-1，MR 754427。

# java - 立即创建 SQL Server 死锁的最小 Java JDBC 程序？

> ID：12308234
> 
> 赞同：2
> 
> 时间：2012-09-06T20:53:51.007
> 
> 标签：java, sql-server, jdbc, deadlock

使用 SQL Server 时有时会出现这样的错误：

```
Transaction (Process ID 54) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction. 
```

有关更多背景信息，请查看 Jeff Atwood关于此问题的[博客。](http://www.codinghorror.com/blog/2008/08/deadlocked.html)

我想通过使用普通 JDBC 的小测试以编程方式创建 SQL Server 死锁。测试应该*立即*创建一个死锁，以便我可以测试一些重试逻辑。

通过阅读 Jeff 的分析，我的理解是，我只需要一些数据并阅读它很多，然后写一点。

我目前有一个简短的 Java 程序（如下），它创建一个表并将一些测试数据写入表中。他们的程序启动了数百个线程。每个线程要么进行更新，要么读取测试数据。我改变了更新与读取操作的比率，但无论比率如何，我似乎都无法以编程方式创建死锁。这个版本的测试程序没有我的重试逻辑，我会补充一点，一旦我可以可靠地让 SQL Server 死锁发生。

我想知道是否让所有线程在单个进程中运行可能会以某种方式在 JDBC 驱动程序级别序列化操作，所以我尝试同时运行多个进程（在同一台机器上），但仍然没有死锁。

```
import java.sql.*;
import java.util.*;
import java.util.concurrent.*;
import static java.util.concurrent.TimeUnit.*;

public class Deadlock {
    static final int QUERY_THREAD_COUNT = 300, MAX_OPERATIONS_ITERATION = 5000;
    static String server, db, user, pw;
    static CountDownLatch latch = new CountDownLatch(QUERY_THREAD_COUNT);

    public static void main(String... args) throws Exception {
        server = args[0];
        db     = args[1];
        user   = args[2];
        pw     = args[3];
        Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
        Connection connection = getConnection();
        Statement statement = connection.createStatement();
        statement.execute("CREATE TABLE TESTTABLE (BAR INTEGER, BAZ VARCHAR(32))");
        statement.execute("DELETE FROM TESTTABLE");
        statement.execute("INSERT INTO TESTTABLE VALUES (1, 'FOOBARBAZ')");
        connection.setAutoCommit(false);
        connection.commit();
        connection.close();
        ScheduledExecutorService scheduledExecutorService = Executors.newSingleThreadScheduledExecutor();
        for (int i = 0; i < QUERY_THREAD_COUNT; ++i) {
            scheduledExecutorService.scheduleWithFixedDelay(new Operation(), 0, 1, MILLISECONDS);
        }
        latch.await();
        System.exit(0);
    }

    static class Operation implements Runnable {
        Connection connection = getConnection();
        Statement statement = getStatement(connection);
        int iteration;

        @Override
        public void run() {
            if (++iteration > MAX_OPERATIONS_ITERATION) {
                latch.countDown();
                return;
            }
            try {
                double  random = Math.random();
                boolean update = (random < 0.01);
                if (update) {
                    statement.executeUpdate("UPDATE TESTTABLE SET BAR=" + ((int) (random * 100)) + " WHERE BAZ='FOOBARBAZ'");
                } else {
                    ResultSet rs = statement.executeQuery("SELECT BAR, BAZ FROM TESTTABLE");
                    if (! rs.next()) {
                        return;
                    }
                    int    bar = rs.getInt(1);
                    String baz = rs.getString(2);
                    if (bar > 100) {
                        System.err.println("int is greater than 100");
                    }
                    if (! baz.equals("FOOBARBAZ")) {
                        System.err.println("string is not FOOBARBAZ");
                    }
                }
                connection.commit();
            } catch (SQLException sqle) { // <-- looking for a deadlock exception here!
                System.err.println(sqle);
            }
        }
    }

    static Connection getConnection() {
        try {
            return DriverManager.getConnection("jdbc:sqlserver://" + server + ";databaseName=" + db + ";", user, pw);
        } catch (Exception e) {
            System.err.println(e);
            throw new RuntimeException(e);
        }
    }

    static Statement getStatement(Connection connection) {
        try {
            return connection.createStatement();
        } catch (Exception e) {
            System.err.println(e);
            throw new RuntimeException(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T16:20:18.200

我认为这样做：

```
import java.sql.*;
import java.util.*;
import java.util.concurrent.*;

/**
 * Creates an SQL Server deadlock.
 *
 * <pre>
   javac SQLServerDeadlock.java && java -cp ".:sqljdbc.jar" SQLServerDeadlock <server> <db-name> <username> <password>
 * </pre>
 */
public class SQLServerDeadlock {
    static String server, db, user, pw;
    static String TABLE_A = "TABLE_A", TABLE_B = "TABLE_B";
    static CountDownLatch latch = new CountDownLatch(2);

    public static void main(String... args) throws SQLException {
        server = args[0];
        db     = args[1];
        user   = args[2];
        pw     = args[3];
        Connection connection = null;
        try {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            connection = getConnection();
            init(connection);
            Thread t1 = new Thread(new Update(TABLE_A, TABLE_B), "A-THEN-B");
            Thread t2 = new Thread(new Update(TABLE_B, TABLE_A), "B-THEN-A");
            if (Math.random() < .5) {
                t1.start();
                t2.start();
            } else {
                t2.start();
                t1.start();
            }
            t1.join();
            t2.join();
        } catch (Exception e) {
            System.err.println(e);
        } finally {
            cleanup(connection);
        }
    }

    static class Update implements Runnable {
        String table1;
        String table2;

        Update(String table1, String table2) {
            this.table1 = table1;
            this.table2 = table2;
        }

        @Override
        public void run() {
            Connection connection = null;
            try {
                connection = getConnection();
                Statement statement = connection.createStatement();
                statement.executeUpdate("UPDATE " + table1 + " SET FOO=1");
                latch.countDown();
                latch.await();
                statement.executeUpdate("UPDATE " + table2 + " SET FOO=1");
                connection.commit();
                System.err.println(Thread.currentThread().getName() + ": SUCCESS!");
            } catch (SQLException sqle) {
                if (sqle.getMessage().contains("Rerun the transaction")) {
                    System.err.println(Thread.currentThread().getName() + ": DEADLOCK VICTIM!");
                }
                System.err.println(sqle);
            } catch (InterruptedException ie) {
                System.err.println(ie);
            } finally {
                try {
                    connection.close();
                } catch (SQLException sqle) {
                    System.err.println(sqle);
                }
            }
        }
    }

    static void init(Connection connection) throws SQLException {
        Statement statement = null;
        try {
            statement = connection.createStatement();
            for (String tableName : Arrays.asList(TABLE_A, TABLE_B)) {
                if (tableExists(connection, tableName)) {
                    statement.execute("DROP TABLE " + tableName);
                }
                statement.execute("CREATE TABLE " + tableName + " (FOO INTEGER)");
                statement.execute("INSERT INTO  " + tableName + " VALUES (0)");
            }
            connection.commit();
        } finally {
            statement.close();
        }
    }

    static void cleanup(Connection connection) throws SQLException {
        if (connection == null) {
            return;
        }
        Statement statement = null;
        try {
            statement = connection.createStatement();
            for (String tableName : Arrays.asList(TABLE_A, TABLE_B)) {
                if (tableExists(connection, tableName)) {
                    statement.execute("DROP TABLE " + tableName);
                }
            }
            connection.commit();
        } finally {
            statement.close();
        }
    }

    static boolean tableExists(Connection connection, String tableName) throws SQLException {
        Statement statement = null;
        try {
            statement = connection.createStatement();
            String sql =
                " SELECT TABLE_NAME                         " +
                "   FROM INFORMATION_SCHEMA.TABLES          " +
                "  WHERE TABLE_CATALOG = '" + db        + "'" +
                "    AND TABLE_NAME    = '" + tableName + "'";
            ResultSet rs = statement.executeQuery(sql);
            return rs.next();
        } finally {
            statement.close();
        }
    }

    static Connection getConnection() throws SQLException {
        Connection connection = DriverManager.getConnection("jdbc:sqlserver://" + server + ";databaseName=" + db + ";", user, pw);
        connection.setAutoCommit(false);
        return connection;
    }
} 
```

线程启动的随机化不是必需的，但不会影响正确性。线程调度程序应该任意交错线程执行。然而，在我的环境中，我观察到启动的第二个线程几乎（但并非总是）是死锁受害者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T21:24:17.413

这是创建死锁的伪代码。

```
thread A:
    conA.setAutoCommit(false); // use transactions
    UPDATE TABLE_A SET AVALUE=5
    sleep(5); // seconds
    UPDATE TABLE_B SET BVALUE=5
    conA.commit();

thread B:
    conB.setAutoCommit(false); // use transactions
    sleep(1); // let thread A go first
    UPDATE TABLE_B SET BVALUE=5
    UPDATE TABLE_A SET AVALUE=5
    conB.commit(); 
```

# android - 检测返回按钮点击并忽略额外点击

> ID：12308235
> 
> 赞同：0
> 
> 时间：2012-09-06T20:53:53.573
> 
> 标签：android

在我的应用程序中，有时用户单击后退按钮，但没有响应，因此他们立即再次单击，而不是返回上一个屏幕，而是返回 2-3 个屏幕。有时完全退出应用程序。然而，这些点击都发生在只显示一个屏幕时！有什么方法可以拦截并忽略这些后续点击。也许观察它们的间距或它们出现的屏幕？还有其他人有这个问题吗？

我的猜测是什么都做不了，因为用户可以最终控制后退按钮，但是为什么 Android 不忽略额外的点击，因为它们都发生在同一个页面上，甚至没有声明要切换？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T21:46:40.223

您可以使用下面的代码轻松地抓住后退按钮，但是您真的不应该永远响应。您的 UI 线程被阻止做某事，这从根本上是错误的。

```
@Override
public void onBackPressed() {
  // do something on back.
  return;
} 
```

# ajax - ajax 事件未调用，但 jsf2 spring bean 在用户单击时调用构造函数和 postconstruct

> ID：12308239
> 
> 赞同：0
> 
> 时间：2012-09-06T20:54:03.050
> 
> 标签：ajax, jsf, jsf-2

（问题已解决）我有一个 jsf2-spring-hibernate 项目，每次单击按钮时，bean 中的构造函数和 postconstruct 都会被调用，而我要执行的实际单击侦听器将被忽略。请注意 bean 是 sessionscoped （不是请求），可能它应该是 viewscoped ——但这会干扰 Spring 吗？注意 2：我尝试了 ViewScoped，结果相同。

提示我的问题是 clickListener （下面）没有执行

```
<h:selectOneListbox id="listBox" value="#{ScheduleMB.clients}" size="5"  
    rendered="#{ScheduleMB.showClients}" >
    <f:selectItems value="#{ScheduleMB.clientList}" var="c"
    itemLabel="#{c.lastName}" itemValue="#{c.lastName}" />
    <f:ajax event="click" listener="#{ScheduleMB.clickListener}"  
    render="group" />
</h:selectOneListbox> 
```

我试图做的是在用户单击按钮时出现客户端列表（按钮未在上面显示，但包含在下面的完整 jsf2 页面中）。当用户单击列表框时，clicklistener 被激活并且 bean 处理单击的值。

第二次编辑 - 我的 facelet 包括绑定到 bean，这似乎是导致 bean 在 vi​​ewscope 中重建的原因，但不是 sessionscope。

编辑 - 我做了一些更改 1) 我确保我的 bean 扩展的类是抽象的。这允许 ajax 代码工作，但是即使在 viewscoped 下，构造函数仍然运行了几次，我不确定这是否应该发生。2）将范围更改为会话，其他更改一切正常。

所以我的问题是，为什么构造函数在 ViewScoped 时仍然多次触发？

原始问题：

下面是完整的 jsf2 页面（下面是 javabean）。

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:p="http://primefaces.org/ui"
xmlns:t="http://myfaces.apache.org/tomahawk">

<h:form>   

    <h3>TimeOnly</h3>

    <t:div style="position: absolute; left: 5px; top: 5px; right: 5px; width: 875px ">
        <t:schedule value="#{ScheduleMB.model}" id="schedule1"
            binding="#{ScheduleMB.schedule}"
            rendered="true" visibleEndHour="18" visibleStartHour="8"
            workingEndHour="17" workingStartHour="9" readonly="false"
            theme="default" tooltip="true"
            submitOnClick="true"
            mouseListener="#{ScheduleMB.scheduleClicked}"
            action="#{ScheduleMB.scheduleAction}" />
    </t:div>

    <t:div style="position: absolute; left: 925px; top: 5px; width: 210px; overflow: auto">
        <h:panelGrid columns="1">
            <t:inputCalendar id="scheduleNavigator"
                value="#{ScheduleMB.model.selectedDate}" />
        </h:panelGrid>
    </t:div>

    <t:div style="position: absolute; left: 890px; top: 190px; width: 325px; overflow: auto; font-size: 14px; 
        text-align: left; height: 270px" >
        <h:panelGrid columns="1" rendered="true">
            <h:outputLabel>Enter From Date:Time</h:outputLabel>

            <t:inputDate popupCalendar="true" type="both" value="#{ScheduleMB.from}"/>

            <h:outputLabel>Enter To  Date:Time</h:outputLabel>

            <t:inputDate popupCalendar="true" type="both" value="#{ScheduleMB.to}"/>
            <h:outputLabel for="TitleText" value="Title:"/>
            <h:panelGroup id="group">
                <h:inputText id="TitleText" value="#{ScheduleMB.title}"/>
                <h:commandButton value="Clients" >
                    <f:ajax event="click" listener="#{ScheduleMB.clientList}"
                    render="group"/>
                </h:commandButton>

                <h:selectOneListbox id="listBox" value="#{ScheduleMB.clients}" size="5"  
                rendered="#{ScheduleMB.showClients}" >
                    <f:selectItems value="#{ScheduleMB.clientList}" var="c"
                        itemLabel="#{c.lastName}" itemValue="#{c.lastName}" />
                    <f:ajax event="click" listener="#{ScheduleMB.clickListener}"  
                        render="group" />
                </h:selectOneListbox>
            </h:panelGroup>
            <h:outputLabel for="DescText" value="Description:"/>
            <h:inputText id="DescText" value="#{ScheduleMB.description}"/>
            <h:panelGroup>
                <h:commandButton
                actionListener="#{ScheduleMB.addNewEntry}"
                value="Add entry" rendered="#{not ScheduleMB.model.entrySelected}"/>

                <h:commandButton
                actionListener="#{ScheduleMB.deleteSelectedEntry}"
                value="Delete entry"
                rendered="#{ScheduleMB.model.entrySelected}"/>
            </h:panelGroup>
        </h:panelGrid>
    </t:div>

 </h:form>
</html> 
```

这是 Sessionscoped bean（我已经消除了很多不相关的部分）：

```
@ManagedBean(name="ScheduleMB")
@SessionScoped
public class ScheduleMB extends ScheduleBase
                                     implements Serializable
{
 Map<String,Object> clientValues = new HashMap<String,Object>();
 List<Client> clientValues2 = new ArrayList<Client>();

@ManagedProperty(value="#{UserService}")
IUserService userService;   

public ScheduleMB() {
    clients="hello";   //I put a breakpoint here just to be sure it was called

    }
@PostConstruct
public void init() {
    createClientValues();

}

//This part is not executing.
  public void clickListener(AjaxBehaviorEvent event){
    this.title = clients;
    showClients = false;
    renderClientList=false;

}

public List<Client> getClientList() {
    return clientValues2;
}

private void createClientValues() {

    clientValues2 = userService.findAllClients();

}

public void clientList() {
    showClients=true;
}

public String getDescription() {
    return description;
}

public void setDescription(String description) {
    this.description = description;
}

public String getTitle() {
    return title;
}

public void setTitle(String title) {
    this.title = title;
}

public String getClients() {
    return clients;
}

public void setClients(String clients) {
    this.clients = clients;
}

    public boolean isRenderClientList() {
    return renderClientList;
}

public void setRenderClientList(boolean renderClientList) {
    this.renderClientList = renderClientList;
}

public boolean isShowClients() {
    return showClients;
}

public void setShowClients(boolean showClients) {
    this.showClients = showClients;
}

public IUserService getUserService() {
    return userService;
}

public void setUserService(IUserService userService) {
    this.userService = userService;
}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T14:47:08.370

弄清楚问题是什么以及如何解决它。最初的症状是我的 f:ajax click 事件没有触发关联的 bean 方法，并且每个交互都在构建 bean，尽管是 viewscoped。我仔细检查了 bean 并注意到它的父类不是抽象的并且具有不一致的范围。我消除了范围并将其抽象化。我还将主 bean 的作用域更改为 session，因为 facelet 绑定到 bean，这也将导致在 viewscoped 下的每个交互都调用构造函数。问题解决了。

# clearcase - 在新设备上恢复 ClearCase 动态视图

> ID：12308240
> 
> 赞同：2
> 
> 时间：2012-09-06T20:54:03.850
> 
> 标签：clearcase, clearcase-ucm

**背景**

我的公司一直在向 ClearCase 开发其源代码控制解决方案，为此，我一直在学习在日常开发活动中使用该工具。最近，我公司发的笔记本电脑放弃了ghost，被换掉了。不幸的是，我对复制到新设备的内容没有任何发言权，安装技术忽略了我的 ClearCase 视图存储目录。

**问题**

鉴于它们都是*动态*视图，是否可以从服务器恢复这些视图？我相当肯定这对于快照视图是不可能的，因为文件本地存储在失败的机器上，但我希望能看到动态视图。作为参考，一些视图的长输出如下（部分信息已编辑）：

```
C:\Users\<my_id>>ct lsview -long *<my_id>*
Tag: <my_id>_Shared_FSA_Prod_Dyn
  Global path: \\<old_device_id>\Clearcase_Storage\<my_id>_Shared_FSA_Prod_Dyn.vws
  Server host: <old_device_id>
  Region: SCE
  Active: NO
  View tag uuid:edb85a16.7a564dfd.ac26.9e:d0:2f:3a:62:fe
View on host: <old_device_id>
View server access path: C:\Clearcase_Storage\<my_id>_Shared_FSA_Prod_Dyn.vws
View uuid: edb85a16.7a564dfd.ac26.9e:d0:2f:3a:62:fe
View attributes: ucmview
View owner: SCE\<my_id>

Tag: <my_id>_FSA_Prod_Int_Dyn
  Global path: \\<old_device_id>\Clearcase_Storage\<my_id>_FSA_Prod_Int_Dyn.vws
  Server host: <old_device_id>
  Region: SCE
  Active: NO
  View tag uuid:4536b95b.ee9d45c2.9289.19:3c:64:5b:ae:95
View on host: <old_device_id>
View server access path: C:\Clearcase_Storage\<my_id>_FSA_Prod_Int_Dyn.vws
View uuid: 4536b95b.ee9d45c2.9289.19:3c:64:5b:ae:95
View attributes: ucmview
View owner: SCE\<my_id> 
```

我的最终目标是重新映射现有视图。如果这是不可能的，那么删除旧视图（在我当前的设备上重新创建）是下一个选项。预先感谢您的协助。

**参考**

[重用 ClearCase 视图](https://stackoverflow.com/questions/10851192/reuse-a-clearcase-view)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:03:36.840

如果与动态视图关联的视图存储仍然存在并且可以访问，那么可以，您可以简单地重新启动动态视图。

但是，如果视图存储已被擦除，那么您将无法恢复动态视图或恢复其中的任何签出或私人文件；它们都存储在所述存储视图中。

下一步是删除该视图（注销和 rmtag），然后重新创建具有相同名称的视图。有关and的具体示例，
请参阅“[如何删除其他用户创建的 clearcase 视图？](https://stackoverflow.com/questions/9782424/how-to-delete-clearcase-views-created-by-other-users/9782443#9782443) ” 。`cleartool unregister``cleartool rmtag`

请注意，映射部分与您的问题无关：所有动态视图都在`M:\`驱动器上启动（对于 Windows），并使用简单的`subst`windows 命令映射到任何空闲驱动器号：
参见例如“ [ClearCase，将特定文件夹映射到驱动器，使用动态视图](https://stackoverflow.com/questions/2062810/clearcase-mapping-specific-folders-into-drives-using-dynamic-views/2062854#2062854)”。

# c++ - 尝试将 qsort 与向量一起使用

> ID：12308243
> 
> 赞同：15
> 
> 时间：2012-09-06T20:54:44.910
> 
> 标签：c++, sorting, vector, qsort

我正在尝试学习 c++，并尝试使用 sort 和 qsort。sort() 工作得很好，但 qsort 没有，我不知道为什么，所以你能帮我吗这是我试图编译的代码

```
#include<iostream>
#include<vector>
#include<cstdlib>
#include<ctime>
#include<algorithm>

using namespace std;

int compvar(const void *one, const void *two)
{
    int a = *((int*)one);
    int b = *((int*)two);
    if (a<b)
       return -1;
    if (a == b)
       return 0;
    return 1;   

}

void bvect(vector<int> &vec, int num)
{
     srand(time(NULL));
     for(int i=0; i<num; ++i)
             vec.push_back(rand()%1000 + 1);
}

void showvec(vector<int> vec)
{
     for (int i=0; i<vec.size(); ++i)
         cout<<vec[i]<<endl;
}

int main()
{
    vector<int>numbers;
    bvect(numbers, 1000);
    showvec(numbers);
    qsort(numbers.begin(), numbers.size(), sizeof(int), compvar);
    showvec(numbers);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-06T21:04:54.847

First of all, DON'T.

If you just want to muck about, you can replace iterators with actual pointers:

```
qsort(&numbers[0], numbers.size(), sizeof(int), compvar); 
```

Apart from not doing all the work `std::sort` does, there is one unexpected thing about `qsort`. It is *slower*.

1.  `sort (myvector1.begin(), myvector1.end());`

2.  `sort (myvector2.begin(), myvector2.end(), myfunction);`

3.  `sort (myvector3.begin(), myvector3.end(), myobject);`

4.  `qsort(&myvector4[0], myvector4.size(), sizeof(int), cmyfunction);`

4 is the slowest, followed by 2 (function pointer passed to `std::sort`). 1 and 3 (default and functor) are the fastest (compiled with gnu's g++ with -O3 flag).

# javascript - 如何在 JavaScript 中实现观察者模式？

> ID：12308246
> 
> 赞同：18
> 
> 时间：2012-09-06T20:55:22.100
> 
> 标签：javascript, design-patterns, observer-pattern

嗨，我很想在 JavaScript 中实现观察者模式：

**我的 index.js**：

```
$(document).ready(function () {
  var ironMan = new Movie();
  ironMan.setTitle('IronMan');
  ironMan.setRating('R');
  ironMan.setId(1);
  //  ironMan.setCast(['Robert Downey Jr.', 'Jeff Bridges', 'Gwyneth Paltrow']);

  var terminator = new Movie();
  terminator.setTitle('Terminator');
  terminator.setRating('P');
  terminator.setId(2);

  console.log(ironMan.toString());
  console.log(terminator.toString());

  ironMan.play();
  ironMan.stop();
  ironMan.download();
  ironMan.share('V. Rivas');

  console.log(ironMan.getCast()[0]);
}); 
```

**我的电影**：

```
var title;
var rating;
var id;
var observers;

function Movie() {
  observers = new ObserverList();
}

//function Movie (title, rating, id){
//  this. title = title;
//  this.rating =  rating;
//  this.id =id;
//  observers = new ObserverList();
//}

Movie.prototype.setTitle = function (newTitle) {
  this.title = newTitle;
}

Movie.prototype.getTilte = function () {
  return this.title;
}

Movie.prototype.setRating = function (newRating) {
  this.rating = newRating;
}

Movie.prototype.getRating = function () {
  return this.rating;
}

Movie.prototype.setId = function (newId) {
  this.id = newId;
}

Movie.prototype.getId = function () {
  return this.id;
}

Movie.prototype.play = function () {
  for (i = 0; i < observers.Count; i++) {
    console.log("palying...");
  }
}

Movie.prototype.stop = function () {
  for (i = 0; i < observers.Count; i++) {
    console.log("stoped");
  }
}

Movie.prototype.AddObserver = function (observer) {
  observers.Add(observer);
}; 
```

**最后观察者**：

```
function ObserverList() {
  this.observerList = [];
}

ObserverList.prototype.Add = function (obj) {
  return this.observerList.push(obj);
};

ObserverList.prototype.Empty = function () {
  this.observerList = [];
};

ObserverList.prototype.Count = function () {
  return this.observerList.length;
};

ObserverList.prototype.Get = function (index) {
  if (index > -1 && index < this.observerList.length) {
    return this.observerList[index];
  }
};

ObserverList.prototype.Insert = function (obj, index) {
  var pointer = -1;

  if (index === 0) {
    this.observerList.unshift(obj);
    pointer = index;
  } else if (index === this.observerList.length) {
    this.observerList.push(obj);
    pointer = index;
  }

  return pointer;
}; 
```

您能提供的任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-10-21T16:29:55.187

JavaScript 是*事件驱动的*：这意味着它可以感知时间并期望事情会随着时间而改变。最初的观察者模式是为像 C++ 这样不知道时间的语言创建的。您可以通过使用**游戏循环**来检查状态变化来利用 JavaScript 的优势。

创建两个 DOM 元素，一个输入和一个输出

```
<input type="text" value="Enter some text...">
<p id="output"> 
```

建立一个`requestAnimationFrame`循环并开始观察。

```
//Get a reference to the input and output
var input = document.querySelector("input");
var output = document.querySelector("#output");

//Set up a requestAnimationFrame loop
function update () {
  requestAnimationFrame(update);

  //Change the output to match the input
  output.innerHTML = input.value;
}
update(); 
```

这就是游戏引擎为*即时模式*渲染所做的事情。这也是 React 框架检查 DOM 中状态变化的工作。

（如果需要，这里有一个简单的requestAnimationPolyfill）

```
//Polyfill for requestAnimationFrame
window.requestAnimationFrame = (function(){
  return  window.requestAnimationFrame       ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame    ||
          window.oRequestAnimationFrame      ||
          window.msRequestAnimationFrame     ||
          function(/* function */ callback, /* DOMElement */ element){
            window.setTimeout(callback, 1000 / 60);
          };
})(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-06T21:11:28.180

在 JavaScript 中，没有必要像在 Java 中那样实现纯观察者模式，因为 JavaScript 有一个叫做函数式编程的小东西。[因此，只需使用http://api.jquery.com/category/callbacks-object/](http://api.jquery.com/category/callbacks-object/)之类的东西，而不是您的 ObserverList。

如果您仍想使用您的对象，那么一切都取决于您要传递给 ObserverList.Add 的内容。如果是某个对象，那么您需要编写

```
for( i = 0; i < observers.Count; i++) { 
  observers[i].Notify("some data"); 
} 
```

如果它是一个函数，那么你需要编写

```
for( i = 0; i < observers.Count; i++) { 
  observers[i]("Some data"); 
} 
```

您也可以使用 Function.apply() 或 Function.call() 来提供`this`给您的功能

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-02T23:09:34.283

这是 JavaScript 中的 Observer 模式的实现，它提供了一个非常类似于[Backbone Models](http://backbonejs.org/#Model)的 API 。[正如Douglas Crockford](https://stackoverflow.com/questions/383402/is-javascript-s-new-keyword-considered-harmful)所建议的，此实现避免使用“this”和“new” 。

```
// The constructor function.
function Model(){

  // An object containing callback functions.
  //  * Keys are property names
  //  * Values are arrays of callback functions
  var callbacks = {},

      // An object containing property values.
      //  * Keys are property names
      //  * Values are values set on the model
      values = {};

  // Return the public Model API,
  // using the revealing module pattern.
  return {

    // Gets a value from the model.
    get: function(key){
      return values[key];
    },

    // Sets a value on the model and
    // invokes callbacks added for the property,
    // passing the new value into the callback.
    set: function(key, value){
      values[key] = value;
      if(callbacks[key]){
        callbacks[key].forEach(function (callback) {
          callback(value);
        });
      }
    },

    // Adds a callback that will listen for changes
    // to the specified property.
    on: function(key, callbackToAdd){
      if(!callbacks[key]){
        callbacks[key] = [];
      }
      callbacks[key].push(callbackToAdd);
    },

    // Removes a callback that listening for changes
    // to the specified property.
    off: function(key, callbackToRemove){
      if(callbacks[key]){
        callbacks[key] = callbacks[key].filter(function (callback) {
          return callback !== callbackToRemove;
        });
      }
    }
  };
} 
```

下面是一些使用模型的示例代码：

```
// Create a new model.
var model = Model();

// Create callbacks for X and Y properties.
function listenX(x){
  // The new value is passed to the callback.
  console.log('x changed to ' + x);
}

function listenY(y){
  // The new value can be extracted from the model.
  console.log('y changed to ' + model.get('y'));
}

// Add callbacks as observers to the model.
model.on('x', listenX);
model.on('y', listenY);

// Set values of X and Y.
model.set('x', 30); // prints "x changed to 30"
model.set('y', 40); // prints "y changed to 40"

// Remove one listener.
model.off('x', listenX);
model.set('x', 360); // prints nothing
model.set('y', 50); // prints "y changed to 40" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-08-28T12:12:22.433

```
class EventObserver {
  constructor () {
    this.observers = []
  }

  subscribe (fn) {
    this.observers.push(fn)
  }

  unsubscribe (fn) {
    this.observers = this.observers.filter(subscriber => subscriber !== fn)
  }

  broadcast (data) {
    this.observers.forEach(subscriber => subscriber(data))
  }
} 
```

或者您可以在 NodeJs [https://nodejs.org/api/events.html#events_class_eventemitter中使用 EventEmitter](https://nodejs.org/api/events.html#events_class_eventemitter)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-07T14:15:35.893

下面是我从《Learning Javascript Design Patterns》一书中改编的一个实现。

```
function pubsub(obj) {

var events = {},
    subUid = -1;

obj.publish = function (event, args) {

    if (!events[event]) {
        return false;
    }

    var subscribers = events[event],
    len = subscribers ? subscribers.length : 0;

    while (len--) {
        subscribers[len].func(event, args);
    }
};

obj.subscribe = function (event, func) {

    if (!events[event]) {
        events[event] = [];
    }

    var token = (++subUid).toString();
    events[event].push({
        token: token,
        func: func
    });

    return token;

};

obj.unsubscribe = function (token) {

    for (var event in events) {
        if (events.hasOwnProperty(event)) {
            for (var i = 0, j = events[event].length ; i < j ; i++) {
                if (events[event][i].token === token) {
                    events[event].splice(i, 1);
                }
            }
        }
    }

    return this;

};

}

var obj = {}; // Any javascript object
pubsub(obj); // Make an observable from the given object

var subscription = obj.subscribe('load', handler);

// event handler callback
function handler(event, data) {
    console.log(event, data);
}

obj.publish('load', 'Data loaded successfully'); // logs 'load Data loaded successfully'
obj.unsubscribe(subscription);
obj.publish('load', 'Data loaded successfully'); // nothing happens 
```

干杯!

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-07-28T19:06:53.393

```
class Observable {
    constructor() {
       this.observer = []; 
    }
    subscribe(item) {
        this.observer.push(item);
    }
    unsubscribe(item) {
        if(!this.observer) return 'empty';
        else {
            this.observer.filter(subscribe => subscribe !== item);
        }
    }
    notify(data) {
        this.observer.forEach(item => item(data));
    }
}

var p1 = document.querySelector('.p1');
var p2 = document.querySelector('.p2');
var p3 = document.querySelector('.p3');
var input = document.querySelector('.input');

const update1 = text => p1.textContent = text;
const update2 = text => p2.textContent = text;
const update3 = text => p3.textContent = text;

var observarble = new Observable();
observarble.subscribe(update1);
observarble.subscribe(update2);
observarble.subscribe(update3);

input.addEventListener('keyup', event => observarble.notify(event.target.value));
```

```
<input type="input" class="input" />
<div class="p1"></div>
<div class="p2"></div>
<div class="p3"></div>
```

Observer 是在所有 javascript 应用程序中使用的流行模式之一。

实例（主体）维护对象（观察者）的集合，并**在状态发生更改时通知它们**。

让我们通过写一些逻辑来解释

```
class Observable {
    constructor() {
       this.observer = []; 
    }
    subscribe(item) {
        this.observer.push(item);
    }
    unsubscribe(item) {
        if(!this.observer) return 'empty';
        else {
            this.observer.filter(subscribe => subscribe !== item);
        }
    }
    notify(data) {
        this.observer.forEach(item => item(data));
    }
} 
```

现在你的问题将是下一步是什么？

在哪里实际使用此模式。

想象一下，当某个事件发生时，您必须同时更新多个元素。

在代码中添加一些 HTML

```
<input type="input" class="input" />
<div class="p1"></div>
<div class="p2"></div>
<div class="p3"></div> 
```

使用 Javascript 获取这些节点

```
var p1 = document.querySelector('.p1');
var p2 = document.querySelector('.p2');
var p3 = document.querySelector('.p3');
var input = document.querySelector('.input'); 
```

要使用观察者设置值，您需要添加其文本内容

```
const update1 = text => p1.textContent = text;
const update2 = text => p2.textContent = text;
const update3 = text => p3.textContent = text;

var observarble = new Observable();
observarble.subscribe(update1);
observarble.subscribe(update2);
observarble.subscribe(update3); 
```

最后一件事附加一个带有输入键/更改的事件侦听器

```
input.addEventListener('keyup', ev => observarble.notify(ev.target.value)); 
```

而已 ：） ！！

工作演示链接 [https://codepen.io/nishant5857/pen/MWKdByY](https://codepen.io/nishant5857/pen/MWKdByY)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-04T19:57:23.953

观察者模式是关于更新一个对象并让这些更新自动发送一个事件来提供有关更新内容的信息。

例如：

```
function ObserverList(){
  this.observerList = []
  this.listeners = []
}

ObserverList.prototype.add = function( obj ){
  this.observerList.push(obj)
  this.listeners.forEach(function(callback){
    callback({type:'add', obj:obj})
  })
}

ObserverList.prototype.onChange = function(callback){
  this.listeners.push(callback)
} 
```

这是javascript中观察者模式的一个模块，您可以查看源代码以获取更多信息：[https ://github.com/Tixit/observe](https://github.com/Tixit/observe)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-17T06:49:06.957

`Observable`您可以使用为您提供API的 RxJS，而不是实现自己的观察者模式。

一个非常简单的版本，不依赖于完整的库，但应该允许您将来迁移到整个 RxJS 堆栈，可以编写如下（它不尝试执行完整和错误回调）

```
/**
 * Basic Observable, made compatible with RX-JS API.
 */
type Observer<T> = {
  next: (value: T) => void;
};

interface Subscription {
  unsubscribe(): void;
}

export class Observable<T> {
  private observers: Observer<T>[] = [];
  subscribe(next: (value: T) => void): Subscription {
    const observer = { next }
    this.observers.push(observer);
    return {
      unsubscribe: () => {
        this.observers = this.observers.filter((h) => h !== observer);
      },
    };
  }
  next(data: T) {
    this.observers.forEach((h) => h.next(data));
  }
} 
```

并测试如下：

```
import { Observable } from './Observable';
import noop from 'noop-fn';
describe('Observable', () => {
  it('can be created', () => {
    new Observable();
  });
  it('can be subscribed to', () => {
    const o = new Observable();
    const subscription = o.subscribe(noop);
    subscription.unsubscribe();
  });
  it('can receive notifications', () => {
    const o = new Observable();
    const handler = jest.fn();
    const subscription = o.subscribe(handler);
    o.next('Hello');
    subscription.unsubscribe();
    expect(handler.mock.calls.length).toBe(1);
    expect(handler.mock.calls[0][0]).toBe('Hello');
  });
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-03T03:41:45.680

这是旧的，但我想为原始问题提供一个答案，“如何在现有代码的情况下实现观察者模式”。

观察者模式可以简化为一种通信设计，其中目标（被观察的事物）有一个指向观察者的指针，并为观察者假设一个公共 API。例如，目标假定观察者有一个被调用的方法，`update`或者观察者是一个`Function`. 这是目标通过实际调用观察者对象上的方法（或者`Function`如果观察者是一个函数）来通知观察者变化的方式。

任何时候属性发生突变或更改，目标都必须`update`通知所有已注册的观察者。

在这里，我假设您想知道如何实现 Key-Value Observer。在这种情况下，代码必须遍历其观察者列表并在属性更改时调用每个观察者`update`方法（或者在它是 a 的情况下只执行观察者）。`Function`

```
var observers = null;

function Movie() {
 observers = new ObserverList();
}

Movie.prototype.changed = function(key, old, value){
  // Assumption here is that observers can observe individual properties.
  if(!this.observers[key]) return

  this.observers[key].forEach( o => {
    // Assumption is that observers have an update method. This is the only
    // thing the target knows about an observer.
      o.update(key, old, value, this)
  })

}

// Now every setter on the target has to notify the observers by calling `changed`
Movie.prototype.setTitle = function (newTitle) {
  var old = this.title;
  this.title = newTitle;
  this.changed("title", old, this.title, this)
}
```

您必须添加该`changed`方法，然后按照上面的方法更新所有要调用的 setter 方法。

我还注意到`observes`电影的原始代码中没有任何地方。鉴于我上面的示例，您需要添加实际的代码，`observes`实现的东西。`update`

我不确定`play`and的意图是什么`stop`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-13T12:48:25.590

对我来说，这是在 JS 中实现观察者模式的最佳方式

```
function Click() {
    this.handlers = [];  // observers
}

Click.prototype = {

    subscribe: function(fn) {
        this.handlers.push(fn);
    },

    unsubscribe: function(fn) {
        this.handlers = this.handlers.filter(
            function(item) {
                if (item !== fn) {
                    return item;
                }
            }
        );
    },

    fire: function(o, thisObj) {
        var scope = thisObj || window;
        this.handlers.forEach(function(item) {
            item.call(scope, o);
        });
    }
}

// log helper

var log = (function() {
    var log = "";

    return {
        add: function(msg) { log += msg + "\n"; },
        show: function() { alert(log); log = ""; }
    }
})();

function run() {

    var clickHandler = function(item) { 
        log.add("fired: " + item); 
    };

    var click = new Click();

    click.subscribe(clickHandler);
    click.fire('event #1');
    click.unsubscribe(clickHandler);
    click.fire('event #2');
    click.subscribe(clickHandler);
    click.fire('event #3');

    log.show();
} 
```

# c# - 对象引用未设置为对象的实例...错误？

> ID：12308252
> 
> 赞同：2
> 
> 时间：2012-09-06T20:55:43.930
> 
> 标签：c#, sharepoint, event-handling, sharepoint-list, event-receiver

好的，所以我对 C# 完全陌生，并且正在尝试调试错误。基本上我正在尝试为 SharePoint 列表创建一个 EventReceiver ...这是在调试时给我对象引用错误的代码：

```
 public override void ItemAdding(SPItemEventProperties properties)
   {
       base.ItemAdding(properties);

       SPListItem item = properties.ListItem;

       if (item["Name"] == null)
           return; //or better yet, log 

       string oldFileName = item["Name"].ToString(); 
```

我正在做的是进入调试模式，并选择将文件添加到 SharePoint 库（这是在 ItemAdding 事件中），现在在我选择要上传的文件后显示此错误，知道为什么吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:00:27.133

这不是“对象引用错误”，这是`NullReferenceException`由于您尝试访问 的索引运算符（`item`即`null`.

您可以通过在语句的行中设置断点`if`并将鼠标悬停在不同的变量上来发现这一点。

要解决此问题，请确保`properties.ListItem`包含非空值或在 if 中插入另一个检查：

```
if (item == null || item["Name"] == null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:02:36.470

```
SPListItem item = properties.ListItem;
System.Debug.Assert(item != null, "item is null.");

if (item["Name"] == null) --DEBUGGER STOPS HERE
    return; //or better yet, log 
```

it seems that `item` or more specific `properties.ListItem` is null! ~~As `item` is just a reference.~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:00:56.237

你可能得到了错误，因为`SPListItem item`它是空的。您不能访问空变量。您可以尝试将您的代码更新为：

```
 SPListItem item = properties.ListItem;

       if (item == null || item["Name"] == null) 
           return; //or better yet, log 
```

# c# - 使用 POST 传递报告参数，仍然达到长度限制

> ID：12308254
> 
> 赞同：1
> 
> 时间：2012-09-06T20:55:46.987
> 
> 标签：c#, silverlight, post, reporting-services

我有一个 Silverlight 应用程序（打算在浏览器中运行），它允许用户从一个大列表中选择尽可能多的 SSRS（子）报告。选定的子报表聚合成一个大报表，该报表在新窗口中启动。每个子报表都有自己的一组参数。因此，参数值列表可能会变得很长。以前，应用程序会使用 GET 方法来传递参数值，例如：

```
http://<serverName>/_vti_bin/ReportServer/Pages/ReportViewer.aspx?http://<reportPath>&rs:Command=Render&rs:ClearSession=true&rc:Parameters=false&rc:Toolbar=true&rc:Zoom=100&FacilityUniqueValues=A&WorkWeek=0&... 
```

但是对于长参数值列表，URL 很容易超过 2000 个字符。在这个长度或更长的时候，报告会失败——浏览器只会给出一个 HTTP 404 页面。我认为这是由于沿线某处的 URL 长度限制，因此，在查找解决方案后，我让它使用 POST 方法来传递参数，完全按照[这个 SO answer](https://stackoverflow.com/a/9175975/908291)中的描述。上面的 URL 现在看起来像：

```
http://<serverName>/_vti_bin/ReportServer/Pages/ReportViewer.aspx?<reportPath> 
```

但是，当参数值列表很长时，问题仍然存在。

我注意到，当列表较短并且报告显示成功时，浏览器会重定向到表单中的 URL：

```
http://<serverName>/_layouts/ReportServer/RSViewerPage.aspx?rv:RelativeReportUrl=<relativeReportPath>&rv%3aParamMode=Hidden&rv%3aZoom=100&rp%3aFacilityUniqueValues=A&rp%3aWorkWeek=0&... 
```

即这些值无论如何都会被制成GET参数。我不明白这一点，因为当您有很多报告参数时，我已经看到许多使用 POST 绕过 URL 长度限制的建议——如果它重定向到 GET URL 有什么意义？

那么，有没有办法传播 Posted 参数？或者解决这个问题的另一种方法？

我对所涉及的大多数技术都非常缺乏经验，因此对于我未包含的任何相关细节，我深表歉意——请让我知道哪些信息可能会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:04:09.677

您正在连接的报告服务器正在重定向到一个页面并将子报告指定为 URL 参数。这是报告服务器中的问题，您无法在 Silverlight 应用程序中修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T11:07:44.197

首先，无论是POST还是GET，通过uri传递参数，这叫做URI隧道，它有一个预定义的长度限制（如果我没记错的话我想大约2000个字符），因此你会看到是否没有区别或者不使用 POST 或 GET。又名.. [http://url.com](http://url.com) **？**<-- 之后的任何内容**？**是 Uri 隧道。

POST 请求通常伴随着 BODY 内容（可以是 XML、JSON 等），我认为这就是您[从 silverlight 导航和发布数据](https://stackoverflow.com/questions/9175910/navigate-and-post-data-from-silverlight/9175975#9175975)的链接的意思。正文内容/有效负载不会有 URI 字符串最大长度的限制。正文内容将具有 URL [http://url.com](http://url.com)和不可见的有效负载，直到您使用 Fiddler 等工具或浏览器的开发人员工具检查请求对象的消息正文。注意注释掉的部分

```
// TODO: doc.CreateElement("input");
// TODO: SetAttribute("type", "hidden");
// TODO: SetAttribute("name", someName);
// TODO: SetAttribute("value", someValue);
// TODO: newForm.AppendChild() 
```

这会将参数的值设置为通过表单发布请求传递。在上面的代码中， doc.CreateElement("input"); 创建一个输入元素来保存“someValue”的隐藏值和“someName”的名称；

我可以给你一些基于你的查询字符串的例子

```
doc.CreateElement("input");
SetAttribute("type", "hidden");
SetAttribute("name", "FacilityUniqueValues");
SetAttribute("value", "A");
newForm.AppendChild()

doc.CreateElement("input");
SetAttribute("type", "hidden");
SetAttribute("name", "WorkWeek");
SetAttribute("value", 0);
newForm.AppendChild() 
```

所以总而言之，您的服务器必须能够处理表单参数 FacilityUniqueValues 和 WorkWeek 的解构。

# javascript - 获取给定元素的每个 CSS 属性和 HTML 属性

> ID：12308257
> 
> 赞同：0
> 
> 时间：2012-09-06T20:55:53.490
> 
> 标签：javascript, jquery, html, css

使用 Javascript/jQuery，是否可以获取文档中给定元素的属性名称及其值以及 HTML 属性名称及其值。这与它们是否：

**内联样式**

```
<h1 style="font-weight="900">Heading 1</h1> 
```

**嵌入式**

```
<style>
h1
{
font-weight: bold;
}
</style> 
```

**链接的**

```
<link href="main.css" rel="stylesheet" type="text/css" media="all" /> 
```

**进口的**

```
 @import url("reset.css"); 
```

而且不管

*   用户代理/浏览器（IE、FF、GC、AS、OP）
*   以上应用的默认样式
*   以上版本

好吧，可以启动 FF 中的 Firebug 或开发人员工具，以及其他 UA 中的类似工具，但它们缺乏一些能力。我正在寻找一种 jQuery 插件类型，其中元素显示在左侧，以上所有内容都显示在右侧（可能在 iframe 中？）。

我只是制作了一个文档（一个非常简单的可能只有一个元素 say ）并将它显示在浏览器的左侧，上面显示在右侧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T18:12:44.360

您可以使用文档对象的 getComputedStyle() 方法和元素的属性字段：

```
var oDiv = document.getElementById("div1");
var css = document.defaultView.getComputedStyle(oDiv, null);
var attr = oDiv.attributes; 
```

这应该返回一个对象，其中包含元素具有的每个 CSS 样式的字段。然后，您可以编写一个简单的、深度优先的树遍历来遍历 DOM 中的每个元素（我使用 jQuery 编写了这个，以便于理解）：

```
var stack = new Array();
stack.push($('html')[0]);
var i = 0;
while(stack.length > 0 && i < 100){
    //pop the next element off the stack
    var ele = stack.pop();

    var css = document.defaultView.getComputedStyle(ele, null);
    var attr = ele.attributes;

    //do things with the css object
    console.log(css);

    //do things with the attributes
    console.log(attr);

    //add children to the stack
    $(ele).children().each(function(index, child){
        stack.push(child);
    });
    i++;
} 
```

请注意，我在其中放置了一个计数器 (i) 以将迭代次数限制为 100，并且如果您的页面有大量元素，则可以防止您炸毁浏览器。如果需要，您可以删除它，但要小心。另请注意，搜索的根可以是 DOM 中的任何节点，但我从 html 标记开始。

根据您的评论，我将介绍您将如何实现这一点。请记住，它所做的只是将 CSS/属性对象打印到控制台，您需要修改该部分以执行您真正想要的操作。

**脚本：**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script type="text/javascript">
function doStuff(){
  var stack = new Array();
  stack.push($('html')[0]);
  var i = 0;
  while(stack.length > 0 && i < 100){
    //pop the next element off the stack
    var ele = stack.pop();

    var css = document.defaultView.getComputedStyle(ele, null);
    var attr = ele.attributes;

    //do things with the css object
    console.log(css);

    //do things with the attributes
    console.log(attr);

    //add children to the stack
    $(ele).children().each(function(index, child){
        stack.push(child);
    });
    i++;
  }        
}
</script> 
```

**运行它的 HTML 按钮**

```
<button type="button" onclick="doStuff()">Click Me!</button> 
```

**全面实施**

```
<!DOCTYPE html>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script type="text/javascript">
function doStuff(){
  var stack = new Array();
  stack.push($('html')[0]);
  var i = 0;
  while(stack.length > 0 && i < 100){
    //pop the next element off the stack
    var ele = stack.pop();

    var css = document.defaultView.getComputedStyle(ele, null);
    var attr = ele.attributes;

    //do things with the css object
    console.log(css);

    //do things with the attributes
    console.log(attr);

    //add children to the stack
    $(ele).children().each(function(index, child){
        stack.push(child);
    });
    i++;
  }        
}
</script>
</head>
<body>
  <button type="button" onclick="doStuff()">Click Me!</button>
</body>
</html> 
```

我很想听听你想用这个来完成什么。这是一个缓慢的操作，检查您放置在页面上的标签通常没有多大好处......

# php - PHP根据数组值对关联数组进行排序

> ID：12308261
> 
> 赞同：0
> 
> 时间：2012-09-06T20:56:04.377
> 
> 标签：php, multidimensional-array, sorting

我目前有一个关联的值数组，我需要根据另一个数组中的值对其进行排序。

例子：

如果我有一个值数组，AssocArray = '122'=>'12', '123'=>'32', '232'=>'54', '343'=>'12'

我需要对照另一个值数组进行检查，orderArray = '232', '123'

如果存在，则将该值推送到 AssocArray 的顶部。所以最终的数组看起来像这样。

AssocArray = '232'=>'54', '123'=>'32', '122'=>'12', '343'=>'12'

对不起，我没有任何工作代码，我还在学习 PHP。

任何帮助将不胜感激:) 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:01:20.490

遍历您的`$orderArray`, 并检查具有该键的元素是否存在于`$AssocArray`. 如果是，则将该元素添加到`$result`数组中，并将其从原始`$AssocArray`. 然后，您只需要将剩余的元素`$AssocArray`与推到`$results`数组顶部的任何元素合并：

```
$AssocArray = array( '122'=>'12', '123'=>'32', '232'=>'54', '343'=>'12');
$orderArray = array( '232', '123');

rsort( $orderArray, SORT_STRING); // Make sure the order array is sorted from highest to lowest

$result = array();
foreach( $orderArray as $key) {
    if( isset( $AssocArray[ $key ])) {
        $result[$key] = $AssocArray[ $key ];
        unset( $AssocArray[ $key ]);
    }
}

foreach( $AssocArray as $k => $v) {
    $result[$k] = $v;
}

print_r( $result); // Print the resulting array 
```

你可以看到[这打印](http://viper-7.com/3ORfyw)：

```
Array
(
    [232] => 54
    [123] => 32
    [122] => 12
    [343] => 12
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:05:53.863

```
$orderArray = array("232", "123");

function customSort($key1, $key2){
    $key1Pos = array_search($key1, $orderArray);
    $key2Pos = array_search($key2, $orderArray);
    if($key1Pos !== NULL && $key2Pos != NULL){
        return $key1Pos - $key2Pos;
    }else if($key1Pos === NULL){
        return 1;
    }else{
        return -1;
    }
}

uksort($array, "customSort"); 
```

# knockout.js - 添加到输入敲除js的列表

> ID：12308265
> 
> 赞同：1
> 
> 时间：2012-09-06T20:56:32.213
> 
> 标签：knockout.js, custom-binding

按回车后，我无法将名称添加到列表中，但单击“添加名称”时仍会添加。有任何想法吗？

[http://jsfiddle.net/someyoungideas/WWpcC/](http://jsfiddle.net/someyoungideas/WWpcC/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:07:13.353

看看[http://todomvc.com/architecture-examples/knockoutjs/](http://todomvc.com/architecture-examples/knockoutjs/)

具体来说，[http ://todomvc.com/architecture-examples/knockoutjs/js/app.js](http://todomvc.com/architecture-examples/knockoutjs/js/app.js)

```
var ENTER_KEY = 13;

// a custom binding to handle the enter key (could go in a separate library)
ko.bindingHandlers.enterKey = {
    init: function( element, valueAccessor, allBindingsAccessor, data ) {
        var wrappedHandler, newValueAccessor;

        // wrap the handler with a check for the enter key
        wrappedHandler = function( data, event ) {
            if ( event.keyCode === ENTER_KEY ) {
                valueAccessor().call( this, data, event );
            }
        };

        // create a valueAccessor with the options that we would want to pass to the event binding
        newValueAccessor = function() {
            return {
                keyup: wrappedHandler
            };
        };

        // call the real event binding's init function
        ko.bindingHandlers.event.init( element, newValueAccessor, allBindingsAccessor, data );
    }
}; 
```

请注意，此扩展名为*enterKey*而不是*addOnEnter*，后者更适合通用作品的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:14:45.070

考虑提交绑定 [http://knockoutjs.com/documentation/submit-binding.html](http://knockoutjs.com/documentation/submit-binding.html)

它避免了需要进行自定义绑定来捕获 keycode 13 你也不需要 valueUpdate

html

```
<form data-bind="submit:pushPeople">
 <input type="text" data-bind="value: addPeople, valueUpdate: 'afterkeydown'"/>
 <input type="submit" value="Add Name" />
</form> 
```

[http://jsfiddle.net/jnewcomb/umf3f/1/](http://jsfiddle.net/jnewcomb/umf3f/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:19:59.897

像这样试试

[http://jsfiddle.net/KDz6E/](http://jsfiddle.net/KDz6E/)

基本上你的“自我”是一个 html 元素，而不是你的视图模型

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:12:05.947

这段代码的问题是 pushPeople() 中的 self.people 是未定义的（因为`this`指向输入元素而不是视图模型）。

试试这个：http: [//jsfiddle.net/WWpcC/22/](http://jsfiddle.net/WWpcC/22/)

改为`value.call(this);`_`value.call(ko.dataFor(this));`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T15:09:18.807

其实你不需要任何自定义绑定，简单的事件就足够了！

我已经调整了你的例子。**更新示例：** [**JS FIDDLE**](http://jsfiddle.net/dmitry_zaets/WWpcC/36/)

希望它会帮助你。

问候，德米特里·扎伊茨。

# android - 试图以编程方式将 TextView 对象设置在 RelativeLayout 的中心

> ID：12308267
> 
> 赞同：0
> 
> 时间：2012-09-06T20:56:40.367
> 
> 标签：android

我正在尝试以编程方式将 TextView 对象设置在 RelativeLayout 的中心。并且总是在中心附近设置 TextView。

```
params = (RelativeLayout.LayoutParams) N2.getLayoutParams();
params.setMargins(px(widthDP/2)-(px(35)),(height/2), 0, 0);
N2.setLayoutParams(params)

private int px(float dips) // return converting DP to PX
{
  float DP = getResources().getDisplayMetrics().density;
  return Math.round(dips * DP);
} 
```

谢谢，伊格尔阿西斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:41:10.717

这会将 align_centerInParent 属性设置为 true：

```
params.addRule(RelativeLayout.CENTER_IN_PARENT, 1); 
```

# facebook - Facebook图形API，自定义操作的FB.api帖子第一次失败但第二次成功

> ID：12308269
> 
> 赞同：0
> 
> 时间：2012-09-06T20:56:49.890
> 
> 标签：facebook, facebook-graph-api

我最近开始涉足 Facebook Graph api。我已经使用命名空间“测试”定义了一个自定义操作“开始”，这是我用来发布到 Facebook 的代码。

```
FB.api('/me/Test:start',{ article : currentURL, message: $j('.subject-content h2 a').html()}, 'post', function(response) {

                                  if (!response || response.error) {
                                       console.log('Error  '+response.error.message);
                                  }
                                  else {
                                       console.log('Message was posted! (post id: ' + response.id + ")");
                                  }
                             }); 
```

由于某种原因，该帖子第一次失败，但在随后的尝试中，该帖子成功了。

这是我从萤火虫捕获的请求。

1)

```
 access_token    xxxxx
        article https://testserver:8080/xxx
        callback    FB._callbacks.__gcb2
        message testpage
        method  post
        pretty  0
        sdk joey 
```

2)

```
 access_token    yyyy
    article https://testserver:8080/xxx
    callback    FB._callbacks.__gcb6
    message testpage
    method  post
    pretty  0
    sdk joey 
```

如您所见，调用完全相同。第一次收到这个回复

```
/**/ FB._callbacks.__gcb4({"error":{"message":"An unknown error has occurred.","type":"OAuthException","code":1}}); 
```

我也在图形浏览器上尝试了相同的请求，它每次都有效。

难道我做错了什么？任何帮助都会很棒。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T23:37:05.100

问题中并不清楚您遇到的错误，即：

我有理由确定使用`localhost`对象 URL 是行不通的，您应该使用 Facebook 爬虫可访问的域进行测试 - 爬虫需要读取页面及其上的元标记才能在 Facebook 的图表中创建对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T23:12:17.790

修复了问题。我同时执行了两个发布请求，而这个总是失败，所以我认为这个请求有问题。

```
FB.api('/me/Test:start .... );
FB.api('/me/feed .... ); 
```

我不知道问题是什么，但是当我将这两个请求分开时。一切都按预期工作。

# jquery - jquery mobile上的jquery漂亮的复选框？

> ID：12308272
> 
> 赞同：1
> 
> 时间：2012-09-06T20:57:10.163
> 
> 标签：jquery, jquery-mobile

嗨，我喜欢[这些](http://aaronweyenberg.com/90/pretty-checkboxes-with-jquery)漂亮的复选框：

并在我的网站上实施了它们。不幸的是，当我尝试将它们与 jquery mobile 集成时，它们失去了外观和感觉。

一旦我尝试包括

链接 rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" /

在我的内联 css 之前或之后，效果都被破坏了。我怎样才能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:38:21.840

如果您希望 jQuery Mobile 不触及特定的表单控件，只需为该元素赋予属性`data-role="none"`。所以你必须`data-role="none"`在输入类型复选框标签上添加属性，问题就会得到解决。

我希望这有帮助。

# javascript - 正确调整 D3 条形图的大小

> ID：12308273
> 
> 赞同：1
> 
> 时间：2012-09-06T20:57:12.087
> 
> 标签：javascript, svg, d3.js

我正在尝试将标签/轴/标题/等添加到 D3 条形图。我可以得到接近正确尺寸的东西，但是我最终剪掉了最后一个小节的一部分（所以最后一个小节比其他小节更瘦）。以下是相关代码：

```
var x = d3.scale.linear()
.domain([0, object.data.length])
.range([0, object.width]);
var y = d3.scale.linear()
.domain([object.min-(object.max-object.min)*.15, object.max (object.max-object.min)*.15])
.rangeRound([ object.height - 30, 0]);

var vis = d3.select(object.ele)
    .append("svg:svg")
    .attr("width", object.width)
    .attr("height", object.height)
    .append("svg:g");

vis.selectAll("g")
.data(object.data)
.enter().append("rect")
.attr("x", function(d, i) { return x(i); })
.attr("y", function(d) { return object.height - y(d.value); })
.attr("width", object.width/object.data.length - 1)
.attr("height",  function(d) { return y(d.value); })
.attr("transform", "translate(30,-30)"); 
```

目前一切（标签、轴等）都是 30 像素。如何正确更改图表以腾出空间容纳我需要的其他任何东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:07:09.783

您正在切断最后一个栏，因为您使用平移 x 坐标，但您的 x 范围仅是宽度，没有额外的 30 像素。

此外，使用 .domain([object.min, object.max]) 简化您的 y 域可能会更容易，然后将“y”和“height”函数颠倒过来。这样，您从 y(d.value) 开始矩形并使其高度为 object.height - y(d.value)。

我最初会创建三个组，一个用于您的 y 轴，一个用于 x 轴，然后另一个用于条形图。在最后一个组内绘制你的条，然后翻译整个组本身而不是每个单独的条。增加 object.width 和 object.height 的大小以匹配您想要的总空间。

# sharepoint-2010 - 自定义 xlviewer.aspx

> ID：12308275
> 
> 赞同：3
> 
> 时间：2012-09-06T20:57:20.713
> 
> 标签：sharepoint-2010, export-to-excel

我正在尝试自定义 SharePoint 的 xlviewer.aspx 页面以删除“在 Excel 中打开”按钮并可能将其替换为“下载快照”，其他人是否尝试过这样做并取得了任何进展？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T08:52:15.153

将以下 Javascript 添加到 xlviewer.aspx 允许我删除在 excel 中打开的按钮

```
</script>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript">
    $(document).ready(function ()
    {
        setTimeout(HideOpenInExcelRibbonButton, 10); 
    });

    function HideOpenInExcelRibbonButton()
    {
        $('a[id*="openInExcel"]').hide();  

         var doc = document.getElementsByTagName('ie:menuitem'); 

         for (var i = 0; i < doc.length; i++)
         {
          itm = doc[i];
          if (itm.id.match("OpenInExcel")!=null)
           { itm.hidden=true; }
         } 
        setTimeout(HideOpenInExcelRibbonButton, 10);
    }   
    </script> 
```

# java - java-如何转换一个ArrayList > 成字符串[]][]

> ID：12308276
> 
> 赞同：0
> 
> 时间：2012-09-06T20:57:21.290
> 
> 标签：java, string, list, arraylist

我想将`ArrayList<ArrayList<String>>`变量中的一些数据存储到 csv 文件中。

为此，我将注意力集中在 Ostermiller Utilities 上——其中还包括一个 CSV Writer。

问题是，csvwrite 功能需要一个字符串、字符串 [] 或一个`String[][]`变量。

我不会事先知道我的 ArrayList 的 ArrayList 中的行数/列数 - 那么如何使用上述（cswrite）功能？我不必为`String[]][]`变量声明固定大小吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:00:31.803

A`String[][]`只不过是一个数组数组。例如，这使用 2d 数组创建了一个“三角矩阵”。它不一定是正方形（尽管 CSV 可能应该是正方形，但不一定是）。

```
String[][] matrix = new String[][5];    

matrix[0] = new String[1];
matrix[1] = new String[2];
matrix[2] = new String[3];
matrix[3] = new String[4];
matrix[4] = new String[5]; 
```

所以为了你的目的

```
String[][] toMatrix(ArrayList<ArrayList<String>> listOFLists) {
    String[][] matrix = new String[][listOfLists.size()];
    for(int i = 0; i < matrix.length; i++) {
        matrix[i]= listOfLists.get(i).toArray();
    }
    return matrix;
} 
```

请记住，在这种情况下，它是 in `matrix[col][row]`，而不是`matrix[row][col]`。您可能需要转置此结果，具体取决于您的图书馆的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:03:34.250

You can create an array of arrays (matrix) with one size at first, and then iterate and add the data as you traverse the list of list

```
String[][] arr = new String[listOfList.size()][];
int i = 0;
for (List<String> row: listOfList) {
    arr[i++] = row.toArray(new String[row.size()]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:11:14.633

测试和工作：

```
 String[][] arrayOfArraysOfString = new String[arrayListOfArrayListsOfStrings.size()][];

    for (int index = 0; index < arrayListOfArrayListsOfStrings.size(); index++) {
        ArrayList<String> arrayListOfString = arrayListOfArrayListsOfStrings.get(index);
        if (arrayListOfString != null) {
            arrayOfArraysOfString[index] = arrayListOfString.toArray(new String[arrayListOfString.size()]);
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:17:02.267

这是一个如何将多维 ArrayList 转换为多维字符串数组的示例。

```
package stuff; 
```

导入 java.util.ArrayList；

公共类 ArrayTest {

```
public static void main(String[] args) throws Exception {
    ArrayList<ArrayList<String>> multidimesionalArrayList = createArrayListContent(); 
    String[][] multidimensionalStringArray = new String[multidimesionalArrayList.size()][];
    int index = 0;

    for (ArrayList<String> strings : multidimesionalArrayList) {
        multidimensionalStringArray[index] = strings.toArray(new String[]{}); 
        index++;
    }

    System.out.println(multidimensionalStringArray);
}

private static ArrayList<ArrayList<String>> createArrayListContent() throws Exception  {
    ArrayList<ArrayList<String>> result = new ArrayList<ArrayList<String>>();
    result.add(createArrayList());
    result.add(createArrayList());
    result.add(createArrayList());
    result.add(createArrayList());
    result.add(createArrayList());
    return result;
}

private static ArrayList<String> createArrayList() throws Exception {
    ArrayList<String> list = new ArrayList<String>();
    list.add(String.valueOf(System.currentTimeMillis()));
    Thread.sleep(10);
    list.add(String.valueOf(System.currentTimeMillis()));
    Thread.sleep(10);
    list.add(String.valueOf(System.currentTimeMillis()));
    Thread.sleep(10);
    list.add(String.valueOf(System.currentTimeMillis()));
    Thread.sleep(10);
    list.add(String.valueOf(System.currentTimeMillis()));
    return list;
} 
```

}

# joomla2.5 - Joomla 2.5：无法登录后端和前端

> ID：12308277
> 
> 赞同：0
> 
> 时间：2012-09-06T20:57:25.390
> 
> 标签：joomla2.5

我突然无法登录了，无论是在后端还是前端。我确定我使用了正确的用户名/密码并且该用户已启用。我已经用 phpmyadmin 检查了这个。我收到的错误消息是用户名/密码不正确。我也尝试恢复我的密码并且我成功完成了此操作，但是当我再次尝试登录时，它告诉我用户名/密码不正确。

有什么想法可以尝试解决此问题吗？我可以访问网络服务器和数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:42:42.463

我找到了解决方案。我确实禁用了 joomla-authentication 插件。只需确保在您的 joomla 数据库的 _extensions 表中启用 plg_authentication_joomla。

# wordpress - add_action 相对于回调函数的位置

> ID：12308281
> 
> 赞同：1
> 
> 时间：2012-09-06T20:57:53.223
> 
> 标签：wordpress

使用时`add_action`，最好写成：

```
add_action('blah', 'my_function');
function my_function() { return $something; } 
```

或者

```
function my_function() { return $something; }
add_action('blah', 'my_function'); 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:09:32.277

这纯粹是一种风格选择，两者的行为方式完全相同。

个人比较喜欢

```
add_action('blah', 'my_function');
function my_function() { return $something; } 
```

因为我觉得在阅读代码时更容易识别钩子。如果函数特别长，那么它可能不会立即被挂钩。

作为参考，在 quora 上提出了同样的问题 - [http://www.quora.com/WordPress/In-WordPress-is-it-best-practice-to-add_action-before-or-after-your-custom-功能](http://www.quora.com/WordPress/In-WordPress-is-it-best-practice-to-add_action-before-or-after-your-custom-function)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:01:44.327

由你决定。大多数人都跟随。

```
function my_function() { return $something; }
add_action('blah', 'my_function'); 
```

我用

```
add_action('blah', 'my_function');
function my_function() { return $something; } 
```

我觉得以这种方式阅读代码更容易。但这里没有严格的规定。

# javascript - 打破AJAX回归

> ID：12308283
> 
> 赞同：0
> 
> 时间：2012-09-06T20:57:58.047
> 
> 标签：javascript, string, split

> **可能重复：**
> [如何使用拆分？](https://stackoverflow.com/questions/2555794/how-to-use-split)

我正在尝试基于插件创建一个动态内容 div。默认情况下，插件采用幻灯片对象并以逗号分隔它。每个逗号后面的每个字符串都是分隔的。但是，当通过 AJAX 返回一个值时，它被解释为一个长字符串，而不是被分解。如何让 jQuery 将其拆分为多个字符串？

阿贾克斯：

```
$.ajax({
url: 'backend/index.php',
data: {'check':'true'},
type: 'POST',
async: false,
success: function(data) {
    var carousel,
    el,
    i,
    page,
    slides = [ data ];
}
}; 
```

当前返回的数据：

```
echo "
    '<strong>Swipe</strong> to know more &gt;&gt;&gt;<br>Or scroll down for <em>Lorem Ipsum</em>',
    '1\. A robot may not injure a human being or, through inaction, allow a human being to come to harm.',
    '2\. A robot must obey the orders given to it by human beings, except where such orders would conflict with the First Law.',
    '3\. A robot must protect its own existence as long as such protection does not conflict with the First or Second Laws.'
";
exit(); 
```

幻灯片的默认示例：

```
slides = [
    '<strong>Swipe</strong> to know more &gt;&gt;&gt;<br>Or scroll down for <em>Lorem Ipsum</em>',
    '1\. A robot may not injure a human being or, through inaction, allow a human being to come to harm.',
    '2\. A robot must obey the orders given to it by human beings, except where such orders would conflict with the First Law.',
    '3\. A robot must protect its own existence as long as such protection does not conflict with the First or Second Laws.'
]; 
```

作为参考，这里使用的是 SwipeView 插件：http: [//cubiq.org/swipeview](http://cubiq.org/swipeview)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:06:30.563

哦，伙计，这是一个糟糕的问题。提交后几分钟，我意识到它是多么容易。

编辑后端 PHP 以返回：

```
$result = array('<strong>Swipe</strong> to know more &gt;&gt;&gt;<br>Or scroll down for <em>Lorem Ipsum</em>','1\. A robot may not injure a human being or, through inaction, allow a human being to come to harm.','2\. A robot must obey the orders given to it by human beings, except where such orders would conflict with the First Law.','3\. A robot must protect its own existence as long as such protection does not conflict with the First or Second Laws.');

echo json_encode($result); 
```

然后简单地添加到ajax：

```
dataType: "json", 
```

感谢大家的帮助！

# magento - 我无法启用或禁用模块。我收到“保存此配置时发生错误”

> ID：12308284
> 
> 赞同：0
> 
> 时间：2012-09-06T20:57:59.683
> 
> 标签：magento, magento-1.7

我有一个全新的 Magento 1.7.0.2 安装。我安装了两个运行良好的自定义付款方式模块。但是现在，每当我尝试禁用或启用任何付款方式或运输方式时，都会出现如下错误：

> 保存此配置时出错：警告：preg_match() 期望参数 2 为字符串，数组在 /app/code/core/Mage/Adminhtml/Model/System/Config/Backend/Encrypted.php 第 57 行给出

你知道为什么吗？

编辑2：

我发现了问题。它是由我为修复以前的 BUG 而应用的补丁引起的。:P

编辑：

所以我禁用了所有自定义模块，但我仍然遇到同样的错误。我记录了发生的事情，似乎一些核心模块正在发送要保存的数组。

例如 PayPal Express Checkout。配置选项之一是结算报告设置的 SFTP 凭据中的时间。它由三个不同的下拉菜单组成，它正在发送一个要保存的数组！

在运输方法中，UPS 有一个名为 Allowed Methods 的配置选项，它还发送一个数组！

我仍然不知道为什么以前没有发生，现在发生了。他们不应该加密一切。有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T05:22:34.077

我有同样的问题，它是一个已知的错误，在第 1 行尝试这个。135 在代码/core/mage/Adminhtml/model/config/data.php

```
// add this code
$backendClass=false;
if (isset($fieldConfig->backend_model)) {
    $backendClass = $fieldConfig->backend_model;
}  // before this
if (!$backendClass) {
    $backendClass = 'core/config_data';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T14:51:49.843

这实际上是 Magento 中报告的一个错误，它似乎会影响加密的配置设置（密码、API 密钥等）。

[http://www.magentocommerce.com/bug-tracking/issue?issue=14217](http://www.magentocommerce.com/bug-tracking/issue?issue=14217)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T08:01:07.310

尝试禁用第一个模块，退出管理面板，清除 /var/cache 并查看问题是否仍然存在。如果是这样，请对第二个模块执行相同的操作。

问题应该消失了。现在您知道哪个模块导致了问题，您可以决定尝试另一个模块，或者调试以查看问题所在。

在 /app/code/core/Mage/Adminhtml/Model/System/Config/Backend/Encrypted.php 的第 57 行设置断点，看看哪里出了问题。当第二个参数被赋予 preg_match 函数时，它似乎不是一个字符串（可能是 null，例如由于错误的配置或其他原因）。也许这可以帮助您识别问题。

问候

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-06T21:47:26.770

通过后台禁用模块不是一个好主意，因为它只会禁用块输出，如果你想禁用一个模块，你应该去`app/etc/modules`那里找到`Module_Name.xml`文件 - 在这个文件中只需放入`false`node.js文件`active`。

# ios - IOS -webkit-overflow-scrolling 在错误的轴上滚动，或者根本不滚动

> ID：12308292
> 
> 赞同：8
> 
> 时间：2012-09-06T20:58:24.930
> 
> 标签：ios, webkit, scroll, direction

我正在为 IOS 构建一个带有 html5 的移动应用程序。我正在使用“-webkit-overflow-scrolling: touch”来获得原生惯性滚动，但它非常有问题。我已经解决了直到滚动停止才呈现内容的问题，但是一个持续存在的错误是：

当我尝试上下滚动时，什么也没有发生，但是当我尝试水平滚动时，内容会**垂直**滚动（离轴 90 度）。如果我浏览我的应用程序并返回到该页面，它有时会被修复。此外，有时它根本不会滚动，尽管内容很丰富。

从我用谷歌搜索的内容来看，共识似乎是苹果已经意识到了这个错误，并且不打算很快修复它。有没有人找到让 -webkit-overflow-scrolling 正常工作的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-11T03:00:18.770

几个月来，我也一直在与这个错误作斗争。我发现的最佳表征是：

[https://bugs.webkit.org/show_bug.cgi?id=87391](https://bugs.webkit.org/show_bug.cgi?id=87391)

这表示当页面具有 iFrame 并且内容是从 Javascript 设置时会发生这种情况。我目前在[The Graphics Codex 1.6 版](http://graphicscodex.com "图形法典 1.6")中的解决方法是使用 iScroll4 显式滚动页面，而不是使用触摸滚动。因为 Javascript 是单线程的，所以如果您还要执行动画或后台加载内容，这可能会很慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T03:30:30.303

我遇到了同样的问题：使用`-webkit-overflow-scrolling: scroll`它的节点只能通过左/右滚动手势间歇性地向上/向下滚动。

以下是我发现的可能原因：

*   iframe 出现在页面上的任何地方，可见或其他（[来源](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/n2k-OvqCDcE)）
*   `visibility: hidden`应用于可滚动节点的任何父节点（[源](http://travisjbeck.com/blog/browsers/webkit-overflow-scroll-touch-vertical-scrolling-only-responds-to-horizontal-swiping/)）

但是，我的网络应用程序中不存在这些情况。`<ul>`我在编写的纯 CSS 模态对话框中有一个可滚动的内容，它使用了一个巧妙的技巧来添加一个透明的底层——一个`::after`带有`position: fixed`.

当我`position: fixed`从伪元素中删除 时，问题就消失了！当然，这让我的聪明伎俩毫无用处，但有趣的是，这种情况可能会触发这个错误。

**设备：** 2012 iPad 3（视网膜）上的 iOS 5.1.1

**违规代码：**

```
/* Underlay */
.dialog::after {
    z-index: -1;
    position: fixed; /* <--- This was the problem! */
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;

    background-color: rgba(0,0,0,0.4);

    content: "";
} 
```

**tl;dr：**如果包含元素具有固定位置的伪元素，则删除它可以解决您的滚动问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-23T21:36:38.883

我知道这个问题有点老了，但我不得不让我的网站在 iOS 5 上运行。不幸的是，我无法删除或替换 iframe。我注意到 iframe 的存在仅在它在要平滑滚动的元素之前呈现时才会导致问题。稍后将 iframe 附加到文档（在带有 -webkit-overflow-scrolling:touch 的元素之后）解决了问题:)

# mongodb - MongoDB system.profile 集合：没有“插入”操作的数据？

> ID：12308293
> 
> 赞同：2
> 
> 时间：2012-09-06T20:58:33.230
> 
> 标签：mongodb, logging, profiling

我已经配置了我的 MongoDB 2.0.2 实例（更新：也尝试使用 v2.2.0 实例）以将所有操作记录到`system.profile`集合中（即，`db.setProfilingLevel(2)`），并试图准确查看应用程序在插入时插入了哪些数据调用 save() 获取**新**文档。

*我可以在集合中看到“插入”操作`system.profile`，但它不包括正在插入的数据。这是为什么？*

相反，记录在中的更新操作`system.profile`具有显示数据的“updateobj”属性。

这是来自 2.2.0 实例的示例。如您所见，配置文件日志包含一个带有“updateObj”数据的更新条目。但是，插入没有关于插入内容的任何信息。

```
> use test;
switched to db test
> db.getProfilingStatus();
{ "was" : 2, "slowms" : 100 }
> show collections;
cartoons
system.indexes
system.profile
> db.foobar.insert({ "blah": true });
> db.foobar.update({ "blah": true }, { $set: { blerg: 1 } });
> db.system.profile.find({ ns:"test.foobar" });
{
  "ts": ISODate("2012-09-25T20:37:40.287Z"),
  "op": "insert",
  "ns": "test.foobar",
  "keyUpdates": 0,
  "numYield": 0,
  "lockStats": {
    "timeLockedMicros": {
      "r": NumberLong(0),
      "w": NumberLong(2028)
    },
    "timeAcquiringMicros": {
      "r": NumberLong(0),
      "w": NumberLong(10)
    }
  },
  "millis": 2,
  "client": "127.0.0.1",
  "user": ""
}{
  "ts": ISODate("2012-09-25T20:38:11.454Z"),
  "op": "update",
  "ns": "test.foobar",
  "query": {
    "blah": true
  },
  "updateobj": {
    "$set": {
      "blerg": 1
    }
  },
  "nscanned": 1,
  "moved": true,
  "nmoved": 1,
  "nupdated": 1,
  "keyUpdates": 0,
  "numYield": 0,
  "lockStats": {
    "timeLockedMicros": {
      "r": NumberLong(0),
      "w": NumberLong(1797)
    },
    "timeAcquiringMicros": {
      "r": NumberLong(0),
      "w": NumberLong(9)
    }
  },
  "millis": 1,
  "client": "127.0.0.1",
  "user": ""
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T14:28:23.520

很抱歉最初误导您，事实证明这是故意的（我最初的回应与这是一个记录缓慢操作的错误有关）。不这样做背后的想法是，通过打开它，您只会自动将写入负载加倍，因为您实际上只是将相同的信息（实际上更多一点）写入了两次。

由于分析的想法通常是解决性能问题，因此默认情况下并未实施。但是，它已被要求作为一个选项：

[https://jira.mongodb.org/browse/SERVER-3848](https://jira.mongodb.org/browse/SERVER-3848)

正如您所看到的，它还没有计划一个版本，但是在决定实施什么时，投票和评论概述了为什么这会很有帮助。

# javascript - spring security：jsp页面上用户名中的点

> ID：12308296
> 
> 赞同：1
> 
> 时间：2012-09-06T20:58:57.997
> 
> 标签：javascript, spring-security, iso-8859-1

我正在使用 Spring Security 3.1.2。

当用户名包含点时，以下代码：

```
<sec:authentication property="principal.username"/>
```

`user&#46;name`当用户名是时返回值`user.name`。

它似乎是 ISO 8859-1 字符集表示法。

有什么方法可以使用 javascript 将其转换为通常的符号？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-12T14:13:21.790

要使用的属性是“htmlEscape”。例如：

```
<sec:authentication property="principal.username" htmlEscape="false" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T12:52:23.410

默认情况下，身份验证标签会对[HTML 进行转义。](https://github.com/SpringSource/spring-security/blob/master/taglibs/src/main/java/org/springframework/security/taglibs/authz/AuthenticationTag.java#L51)

`escapeHtml`如果要禁用此功能，可以在标记中将属性设置为 false。

# objective-c - 我的一些单元测试测试没有在 XCode 4.4 中完成

> ID：12308297
> 
> 赞同：27
> 
> 时间：2012-09-06T20:58:58.663
> 
> 标签：objective-c, xcode, unit-testing, ocunit, xcode4.4

我已经看到有人在这里和其他地方发布过这个问题，但我还没有找到任何可行的解决方案。我正在使用 XCode 4.4 并设置了一堆单元测试。我以前在这个项目上运行过它们，所以我知道如果它们实际运行，它们确实会通过/失败。

我有大约 15 个测试套件，每个套件包含 1-7 个测试。在大多数尝试中，除了 1 (FooTests) 之外，所有测试套件都完成（并通过）。它给出了警告：

```
FooTests did not finish
    testFoo did not finish 
```

XCode 将报告测试成功，无论未完成的测试发生什么。还有一点需要注意，有时是不同的测试无法完成，有时多个套件无法完成。我没有注意到所有测试都完成的情况，但从这种看似随机的行为来看，我相信这是可能的。

那么，这是 XCode 中的错误吗？我想不出任何其他原因导致随机测试未完成，然后导致 XCode 报告一切都成功。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-19T03:45:17.387

我在 XCode 4.5.2 上。对于应用程序单元测试，如果您的测试套件完成得太快以至于在此之前没有正确加载主应用程序，您将收到警告。您可以通过在测试结束时添加睡眠来简单地避免该问题，如下所示。逻辑单元测试不会发生这种情况。

```
 [NSThread sleepForTimeInterval:1.0]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-17T10:02:20.557

我正在使用 XCode46-DP3，我刚刚在测试中解决了这个问题。我有几个测试启动一个 Web 服务器，然后对其执行 http 调用；在测试结束时，Web 服务器停止。在上周，这些测试开始出现“未完成”的警告。对我来说，在这些测试结束时添加以下 sleep 就足够了（确切地说，我已经在 tearDown 中添加了它）：

```
- (void)tearDown {
  [self.httpServer stop];
  [NSThread sleepForTimeInterval:1.0];
  self.httpServer = nil;
  self.urlComposer = nil;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-12T10:21:18.147

我刚刚遇到了 XC4.5DP4 的这个问题。

我有一个测试，它在循环中做了一些工作，当它退出循环时什么都不做，我得到了“没有完成”错误。

为了证明测试已经完成，我将其添加为最后一行：

```
NSLog(@"done"); 
```

不仅“完成”被打印到输出 - 现在 Xcode 说测试已经完成。

似乎是一种解决方法...去图。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-14T02:02:24.467

问题似乎是您的测试终止太快，以至于 Xcode 无法接收和解析指示失败或成功的日志消息。在最后一个测试用例运行中睡眠 1 秒对我来说可靠，而 0.0 则没有。要查看哪个测试用例是最后一个测试用例，请检查“方案”对话框中的测试操作。

我用一个方法创建了一个单独的 WorkaroundForTestsFinishingTooFast 测试用例：

```
- (void)testThatMakesSureWeDontFinishTooFast
{
    [NSThread sleepForTimeInterval:1.0];
} 
```

问题是当您添加更多测试用例时，您必须确保此测试是最后运行的方法。这意味着从 Test 操作中删除和添加此类，因为不允许重新排序测试用例。另一方面，您只是将整个测试包延迟了 1 秒。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-21T13:57:49.663

我在日志导航器中有同样的警告。我为我修好了。

在我的项目中，我有 2 个方案，一个用于运行项目，一个用于单元测试。

1.  转到产品-> 编辑方案...
2.  在方案选择器中选择 UnitTest 方案
3.  选择左侧的“测试”图标
4.  将调试器从 LLDB 更改为 GDB，然后按 OK
5.  测试现在应该完成。（对我来说效果很好）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-30T21:46:08.653

对我来说，解决方案是减少测试正在测试的应用程序部分的日志输出。我认为 xcode 无法及时解析测试输出，因为我在整个应用程序中都有其他输出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T02:09:37.060

我在使用 XCode 4.6 运行时遇到了同样的问题，就我而言，其原因是该方案与测试服中的实际单元测试之间存在不一致。在该计划中，我检查了一些套装，但在他们的 .m 文件中对一些单元测试进行了评论。

解决问题：取消注释测试或取消选择方案中的文件/诉讼，所有应再次变为绿色:)

对于像我这样忘记如何获得该计划的人来说，这些是必需的步骤：

1.  右键单击方案部分中的项目名称（停止按钮右侧）
2.  选择编辑方案
3.  选择测试调试
4.  单击单元测试项目旁边的三角形，每个文件旁边都有一个复选框
5.  取消选中您在注释中放置单元测试的文件

希望这可以帮助

# c# - 组合框 SelectionChangeCommitted 事件不适用于箭头键

> ID：12308300
> 
> 赞同：4
> 
> 时间：2012-09-06T20:59:26.470
> 
> 标签：c#, winforms, visual-studio-2010

我有一个组合框，该组合框具有在事件`DropDownList`上运行一些代码的属性。`SelectionChangeCommitted`它可以通过鼠标单击正常工作，但如果我尝试使用箭头键进行选择，它会在第一次按键后触发。我如何让它作为一个标准的下拉菜单工作，我可以用鼠标和键导航？

```
private void dd_jobs_SelectionChangeCommitted(object sender, EventArgs e)
{
  Pk_Error p = new Pk_Error(ref_num, j[dd_jobs.SelectedIndex]);
  p.Show(); p.BringToFront();
  this.Close();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-04T19:56:52.720

我有同样的问题要遵守 508 合规性。我必须实现一个从 Windows 继承并覆盖功能的组合框。

因为您在 OnEnter 调用中捕获选定的文本，并在 OnLeave 期间使用它来进行更改。覆盖 OnSelectionChangeCommitted 以检查列表是否被删除并且不进行选择。

```
 if(this.DroppedDown == true)
        {
            base.OnSelectionChangeCommitted (e);
            sCurrentItem = this.Text;
        } 
```

# arrays - 如何在 Actionscript 中获取稀疏数组中的元素数？

> ID：12308303
> 
> 赞同：0
> 
> 时间：2012-09-06T20:59:32.597
> 
> 标签：arrays, actionscript-3, count, sparse-array

Actionscript 使用稀疏数组，所以我可以有一个这样的数组：

```
var myArray:Array = new Array();
myArray[0] = "foo";
myArray[22] = "bar"; 
```

现在 myArray.length 将给我 23。有没有办法在不迭代每个元素的情况下获取数组中的实际项目数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:11:12.673

通过使用`for`语法，它将迭代定义的索引：

```
public static function definedCount(arr:Array):uint {
    var ctr:uint = 0;
    for(ix:* in arr)
        ctr++;
    return ctr;
} 
```

如果您需要经常检查稀疏数组中的项目数，则应将其包装为一个单独跟踪项目数的集合类。就像是：

```
public class IndexedCollection { 
    private var _arr:Array = [];
    private var _itemCount:uint = 0;

    public function get count():uint {
        return _itemCount;
    }

    public function getItem(index:uint):* { 
        return _arr[index]; 
    }

    public function setItem(index:uint, value:*):void {
        if(_arr[index] === undefined)
            _itemCount++;
        _arr[index] = value; 
    }

    public function delete(index:uint):void { 
        if(_arr[index] === undefined) 
            return;
        delete _arr[index]; 
        _itemCount--;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:22:58.807

如果您不想遍历数组，可以对其进行过滤：

```
var myArray:Array = new Array();
myArray[0] = "foo";
myArray[22] = "bar";

var numberOfItems:int = myArray.toString().split(',').filter(isItem).length;

function isItem(item:*, index:int, array:Array):Boolean
{
  return item != "";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T13:59:54.873

最快的方法应该是始终使用内置函数。

```
 function myFilter(item:*, index:int, array:Array):Boolean{
        if(item)
        {
            return true;
        }else{
            return false;
        }
    }

    var myArray:Array = new Array();
    myArray[0] = "foo";
    myArray[22] = "bar";
    trace(myArray.length) // 23
    var myMyNewArray:Array = myArray.filter(myFilter)
    trace(myMyNewArray .length) // 2 
```

# php - wordpress next_post_link() 仅来自当前子类别

> ID：12308304
> 
> 赞同：0
> 
> 时间：2012-09-06T20:59:42.457
> 
> 标签：php, wordpress

我创建了一个自定义循环，一次只显示一个帖子，帖子之间的导航是使用`next_post_link()`and完成的`previous_post_link()`。

问题是我的帖子层次结构包含许多帖子共有的父类别，我只想导航到该子类别中的帖子。

这些链接也可以在父类别的所有帖子之间进行导航。

我已经做了一些研究，但我找不到解决这个问题的方法，知道吗？

**代码：**

```
<div class="setas-next">
    <?php previous_post_link('%link', '»', TRUE); ?>
</div>
<div class="setas-prev">
    <?php next_post_link('%link', '«', TRUE); ?>
</div> 
```

我在`loop.php`和中创建此导航`loop-single.php`。

谢谢，

里卡多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:29:28.630

自从我在 Wordpress 工作以来已经有一段时间了，但我发现对于像这样更复杂的分页需求，最好使用 WP_Query ( [http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query) ) 来使用您想要的子类别的确切 ID，然后使用帖子 ID 查找当前正在使用的类别的下一个和上一个。

请注意你的边缘情况，特别是你最近的帖子不会有最近的……至少不会马上;）

# python - python 正则表达式问题匹配td元素中的链接

> ID：12308306
> 
> 赞同：0
> 
> 时间：2012-09-06T20:59:59.397
> 
> 标签：python, html, regex, html-table

我正在尝试使用正则表达式来匹配表格中的单元格，但问题是并非所有单元格都遵循相同的模式。例如，td 可能采用以下格式：

```
<td><a href="page101010.html">PageNumber</a></td> 
```

或这种格式：

```
<td align="left" ></td> 
```

基本上，td 中的超链接部分并不存在，它只是在一些。

我尝试使用下面的 python 正则表达式代码匹配这种情况，但它失败了。

```
match = re.search(r'<td align="left" ><?a?.+\>?(.+)\<?\/?a?\>?\<\/td\>', tdlink) 
```

我只需要“匹配”即可找到上面 () 中包含的部分。但是我收到语法错误或无对象消息。

我哪里错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:05:12.603

You are using a regular expression, and matching XML with such expressions get too complicated, too fast.

Use a HTML parser instead, Python has several to choose from:

*   [ElementTree](http://docs.python.org/library/xml.etree.elementtree.html) is part of the standard library
*   [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/) is a popular 3rd party library
*   [lxml](http://lxml.de/) is a fast and feature-rich C-based library.

ElementTree example:

```
from xml.etree import ElementTree

tree = ElementTree.parse('filename.html')
for elem in tree.findall('tr'):
    print ElementTree.tostring(elem) 
```

# html - 文本下方出现不需要的下划线

> ID：12308310
> 
> 赞同：2
> 
> 时间：2012-09-06T21:00:27.610
> 
> 标签：html

我正在显示一些文本，其下方出现一条蓝线

[http://jsfiddle.net/mungbeans/CmVsJ/](http://jsfiddle.net/mungbeans/CmVsJ/)

和这个问题一样

[显示带有蓝色下划线的文本，它来自哪里？](https://stackoverflow.com/questions/12255029/text-being-displayed-with-a-blue-underlining-where-is-it-coming-from)

对此和其他人的答案说它对 html4 无效，但对 html5 有效。在这种情况下，为什么小提琴会出现这个问题？解决方案是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:03:22.313

它来自你的`<a>`——因为**一切都**被包裹在其中。要删除它，只需应用：

```
a {
    text-decoration: none
} 
```

[**演示**](http://jsfiddle.net/CmVsJ/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T21:04:16.517

这是你的代码

```
<ul>
  <a href="http://whatever">
    <li id = "header_list">
      <div id = "main_title">title</div>
      <img id = "logo" src="logo.png"/>
    </li>
  </a>
</ul> 
```

div id="main_title" 在锚标签内，这意味着它是一个链接。默认情况下，链接样式具有蓝色下划线。您可以添加 css 样式以删除蓝色下划线：

```
#main_title {text-decoration: none; color: #000;} 
```

此外，你应该把 li 标签直接放在 ul 之后，因为它需要是一个直接的孩子：

```
<ul>
  <li id = "header_list">
    <a href="http://whatever">
      <div id = "main_title">title</div>
      <img id = "logo" src="logo.png"/>
    </a>
  </li>
</ul> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:04:32.787

您只需要更改链接的样式（所有文本都在您的`<a>`标签内）：

```
a{text-decoration:none;} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T21:04:42.460

它在一个`<a>`标签内，默认情况下将用下划线呈现。通过设置链接更改默认行为`text-decoration: none`，它应该可以工作。`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T21:09:52.083

默认情况下，锚标签`a`有一个`text-decoration`定义`underline`。您可以通过简单地将`text-decoration: none;`属性添加到 CSS 定义来解决此问题。

我还应该指出，您的标记并不完全正确。您的锚点应该在 list-item 内，并且在 inline-block elements 内`li`包含块元素通常不是一个好主意。`div``a`

这是您的 jsfiddle 的更新版本，以说明我的意思：http: [//jsfiddle.net/CmVsJ/2/](http://jsfiddle.net/CmVsJ/2/)

# cassandra - 验证 Cassandra 的 Hector 连接

> ID：12308312
> 
> 赞同：2
> 
> 时间：2012-09-06T21:00:35.503
> 
> 标签：cassandra, hector

假设我已经连接到一个集群

```
HFactory.getOrCreateCluster(cluster, address) 
```

有没有办法稍后检查我是否仍然连接？通过查看他们的 javadocs 似乎没有明显的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T12:07:24.780

一种选择可能是在 try-catch 语句中向集群发出一个简单的查询，并查看它是否正确返回，或者是否引发异常。

# sorting - ASPxGridView 组摘要排序 - 它对内部的内容进行排序，而不是对外部的摘要进行排序

> ID：12308317
> 
> 赞同：11
> 
> 时间：2012-09-06T21:00:52.180
> 
> 标签：sorting, devexpress, aspxgridview, group-summaries

我通过将 groupindex 赋予 aspxgridview 中的特定列来完成网格的分组。

例如，如果我按人员姓名进行分组，则当单击箭头查看内容时，该特定人员所做的订单详细信息将出现在详细内容中。

当我单击标题字段进行排序时，它正在对***groupContent***内的数据进行排序，但它不用于对***groupsummary的数据进行排序***

除了人名之外，我将所有总数显示为组摘要的一部分。

例如，如果您在以下链接中看到：

[https://demos.devexpress.com/ASPxGridViewDemos/Summary/GroupSortBySummary.aspx](https://demos.devexpress.com/ASPxGridViewDemos/Summary/GroupSortBySummary.aspx)

如果按公司名称排序，内容将被排序，但显示国家和总和的摘要无法在外部级别排序。

请给我建议解决这个问题的选项。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-04T11:37:24.303

这是基于[此](https://www.devexpress.com/Support/Center/Example/Details/E3180)示例的解决方法。主要思想是创建汇总项，显示组内列
的最小值或最大值，并按此汇总值对组进行排序。对于此事件，用于更改排序行为。 这是示例：`Country``City``City``BeforeColumnSortingGrouping`

```
<dx:ASPxGridView ...
    OnBeforeColumnSortingGrouping="gridCustomers_BeforeColumnSortingGrouping"> 
```

```
private void SortByCountry()
{
    gridCustomers.GroupSummary.Clear();
    gridCustomers.GroupSummarySortInfo.Clear();

    var sortOrder = gridCustomers.DataColumns["Country"].SortOrder;

    SummaryItemType summaryType = SummaryItemType.None;

    switch (sortOrder)
    {
        case ColumnSortOrder.None:
            return;
            break;
        case ColumnSortOrder.Ascending:
            summaryType = SummaryItemType.Min;
            break;
        case ColumnSortOrder.Descending:
            summaryType = SummaryItemType.Max;
            break;
    }

    var groupSummary = new ASPxSummaryItem("Country", summaryType);
    gridCustomers.GroupSummary.Add(groupSummary);

    var sortInfo = new ASPxGroupSummarySortInfo();
    sortInfo.SortOrder = sortOrder;
    sortInfo.SummaryItem = groupSummary;
    sortInfo.GroupColumn = "City";

    gridCustomers.GroupSummarySortInfo.AddRange(sortInfo);
}

protected void Page_Load(object sender, EventArgs e)
{
    SortByCountry();
}

protected void gridCustomers_BeforeColumnSortingGrouping(object sender, ASPxGridViewBeforeColumnGroupingSortingEventArgs e)
{
    SortByCountry();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-18T16:11:24.633

当您按列分组时，devexpress 会自动使用该列进行排序。如果不对数据进行排序，就不可能进行分组。为了克服这个问题，我们对数据源本身进行了排序，然后将该数据源应用于网格。

# android - 无论如何将textsize存储在drawable中，这样取决于main.xml的屏幕大小将选择正确的textsize？

> ID：12308334
> 
> 赞同：1
> 
> 时间：2012-09-06T21:01:53.443
> 
> 标签：android, text

我希望我的应用程序能够在多种屏幕尺寸上运行，并且我希望我可以将文本尺寸值存储在不同的可绘制文件夹中，以便文本适合屏幕尺寸。或者这个问题有更好的做法吗？

例如：drawable-hdpi << textsize == 50

drawable-mdpi << textsize == 25

drawable-ldpi << textsize == 10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:06:36.403

最简单的做法是在`dp`（密度独立像素）或`sp`（缩放像素）中定义文本大小。

这样做，Android 将使用以下计算自动考虑密度：

*   ldpi = 0.75x
*   mdpi = 1x（基线）
*   hdpi = 1.5x
*   xhdpi = 2x

因此，假设您将文本定义为`12dp`. 它最终会在中等密度设备上为 12 像素，在高密度设备上为 18 像素，依此类推。

与alextsc 注释一样，对于文本大小，最好将其`sp`用于您的单元，因为它将考虑到用户对ICS 中添加的字体大小的偏好。在较低版本的 Android 上，`sp`简单地等同于`dp`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:12:04.440

如果您想要一个相同的外观并且它的比例正确，@wsanville 的答案是正确的，但是如果由于某种原因您想要完全不同的尺寸。例如，您在平板电脑上使用的布局与在手机上使用的布局不同，并且您希望它是 1 上的标题和另一个上的子标题。然后我建议你定义不同的维度文件夹。

```
 - values/dimens.xml
<dimen name="textSize">16sp</dimen>
 - values-large/dimens.xml
<dimen name="textSize">32sp</dimen>
 - values-xlarge/dimens.xml
<dimen name="textSize">32sp</dimen> 
```

上面的示例可以让您在手机上小看一下，在平板电脑上大看一下。

# c# - SQL Server 2000 连接错误 - 登录前握手？

> ID：12308340
> 
> 赞同：5
> 
> 时间：2012-09-06T21:02:32.067
> 
> 标签：c#, sql-server, visual-studio-2010, visual-studio, sql-server-2000

我正在使用 SQL Server 2000 后端在 VS 2010 中开发 ASP.NET 应用程序（我知道，我知道......）

在过去 3 个月的大部分时间里，我一直在使用这个设置。但是，昨天我确实应用了 VS 2010 SP1，现在连接到此数据库会导致以下错误：

> 连接超时已过期。尝试使用登录前握手确认时超时时间已过。这可能是因为登录前握手失败或服务器无法及时响应。尝试连接到此服务器所花费的持续时间是 - [Pre-Login] 初始化 = 72；握手=44924

请记住，我没有对连接字符串或 SQL Server 2000 服务器/数据库进行任何更改。因此，自从新添加以来，它的发生肯定是有原因的。

我的连接项目相当普通

```
conn.Open();
SqlCommand cmd = new SqlCommand();
cmd.Connection = conn;
cmd.CommandText = sqlStatement;
SqlDataReader dr = cmd.ExecuteReader();
resultData.Load(dr);
dr.Close();
conn.Close(); 
```

我的连接字符串看起来像

```
Data Source=192.168.1.200;Persist Security Info=false;Initial Catalog=MyDB;User Id=MyUser;Password=MyPW;Timeout=45; 
```

您可以看到我对超时进行了更改，但这不起作用。但是，再一次，我不应该做任何改变。我昨天刚刚应用了 VS 2010 SP 1，这是唯一的变化。帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T23:32:54.143

我通过在服务器防火墙上打开端口 1433 (SQL) 来解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T04:42:55.833

我遇到了和你一样的问题。我通过允许防火墙中的 SQL 客户端和 SQL 主机之间的连接解决了这个问题。当然，您可以授予端口 1433 访问权限，该端口专门用于 SQL Server。

# c++ - 我可以以某种巧妙的方式将联合初始化为函数参数吗？

> ID：12308341
> 
> 赞同：0
> 
> 时间：2012-09-06T21:02:33.127
> 
> 标签：c++, initialization, unions

我正在寻找一些我不确定是否存在的语法糖。很难描述，所以我举个例子：

```
#include <iostream>
using namespace std; // haters gonna hate

union MyUnion
{
    float f;
    unsigned int i;
    // more types
};

unsigned int someFunction(MyUnion m)
{
    return m.i;
}

int main()
{
    unsigned int i = 10;
    float f = 10.0;

    // this is the syntactic sugar I'm looking to emulate
    cout << someFunction(i) << endl; // automagically initializes unsigned int member
    cout << someFunction(f) << endl; // automagically initializes float member
    return 0;
} 
```

我知道我可以定义我的函数的一堆重载，在堆栈上声明联合，初始化它，如下所示：

```
unsigned int someFunction(unsigned int i)
{
    return i; // this is the shortcut case
}

unsigned int someFunction(float f)
{
    MyUnion m = {f};
    return m.i;
}

// more overloads for more types 
```

但我希望有更好的方法。有没有？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T21:04:46.883

你可以给联合一些构造函数：

```
union Jack
{
    int a;
    float f;

    Jack(int a_) : a(a_) { }
    Jack(float f_) : f(f_) { }
};

Jack pot(1);
Jack son(1.);

int main()
{
    someFunction(Jack(100));
    someFunction(100);        // same, implicit conversion
} 
```

# objective-c - -[NSString stringByAppendingPathComponent:] 或只是 -[NSString stringByAppendingFormat:] 用于 NSStrings 用于 NSURL？

> ID：12308347
> 
> 赞同：5
> 
> 时间：2012-09-06T21:02:55.153
> 
> 标签：objective-c, foundation

打电话时，`+[NSURL URLWithString:]`我有两个选项来构建我的 URL：

```
[[@"http://example.com" stringByAppendingPathComponent:@"foo"] stringByAppendingPathComponent:@"bar"] 
```

或者

```
[@"http://example.com" stringByAppendingFormat:@"/%@/%@",@"foo",@"bar"]; 
```

`-[NSString stringByAppendingPathComponent:]`似乎是更正确的答案，但是`-[NSString stringByAppendingFormat:]`除了在以下情况下处理双斜杠之外，我还会丢失任何东西吗？

```
// http://example.com/foo/bar
[[@"http://example.com/" stringByAppendingPathComponent:@"/foo"] stringByAppendingPathComponent:@"bar"] 

// http://example.com//foo/bar  oops!
[@"http://example.com/" stringByAppendingFormat:@"/%@/%@",@"foo",@"bar"]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T18:07:07.207

我刚刚遇到了 stringByAppendingPathComponent 的问题：它到处都删除了双斜杠！：

```
NSString* string1 = [[self baseURL] stringByAppendingString:partial];
NSString* string2 =  [[self baseURL] stringByAppendingPathComponent:partial];

NSLog(@"string1 is %s", [string1 UTF8String]);
NSLog(@"string2 is %s", [string2 UTF8String]); 
```

对于[https://blah.com的 baseURl](https://blah.com)

和 /moreblah 的一部分

产生两个字符串：

2012-09-07 14:02:09.724 myapp string1 是[https://blah.com/moreblah](https://blah.com/moreblah)

2012-09-07 14:02:09.749 myapp string2 是 https://blah.com/moreblah

但由于某种原因，我致电 blah.com 以使用单斜杠获取资源。但它向我表明 stringByAppendingPathComponent 用于路径 - 而不是 url。

这是在运行 iOS 5.1 的 iPhone 4 硬件上。

我输出了 UTF8 字符串，因为我想确保我看到的调试器输出是可信的。

所以我想我是在说 - 不要在 URL 上使用路径，使用一些自制软件或库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-09T23:46:32.497

当您使用 URLS 时，您应该使用以下`NSURL`方法：

```
NSURL * url = [NSURL URLWithString: @"http://example.com"];
url = [[url URLByAppendingPathComponent:@"foo"] URLByAppendingPathComponent:@"bar"] 
```

* * *

*或在斯威夫特*

```
var url = NSURL.URLWithString("http://example.com")
url = url.URLByAppendingPathComponent("foo").URLByAppendingPathComponent(".bar") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T21:12:32.867

怎么样：

~~[NSString pathWithComponents:@[@"http://example.com", @"foo", @"bar"]]~~

正如评论中指出的那样，`/`当使用 from 的方法时，a 会从协议中剥离`NSPathUtitlites.h`，所以这是明显的失败。我能想出的最接近我发布的原始解决方案是：

```
[@[ @"http://example.com", @"foo", @"bar" ] componentsJoinedByString:@"/"] 
```

[`NSString`您只需要使用一个文字作为路径分隔符，这](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/Strings/Articles/ManipulatingPaths.html)就是.

> `NSString`一般用“/”作为路径分隔符和“.”表示路径 作为扩展分隔符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:05:25.673

stringByAppendingPathComponent 的重点是处理双斜杠，但是，您可以执行以下操作：

```
[[@"http://example.com/" stringByAppendingPathComponent:[NSString stringWithFormat:@"%@/%@", @"foo", @"bar"]] 
```

# android - 如何确定下载是否可恢复

> ID：12308350
> 
> 赞同：0
> 
> 时间：2012-09-06T21:03:24.380
> 
> 标签：android, download, download-manager

我正在创建一个下载加速器库在从链接天气开始下载之前有什么方法可以知道服务器支持恢复下载/下载文件 reange 。因为如果是这样，那么我将使用多个连接和下载范围，否则我将正常下载整个文件

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:13:03.233

`GET`与获取所需 html 页面的 header 类似，我们有一个叫做header`HEAD`的东西。

当您发送`HEAD`URL 请求时，我们会得到一组 URL 值

示例：如果您想了解 [http://www.wgz.org/chromatic/perl/IntroTestMore.pdf的详细信息](http://www.wgz.org/chromatic/perl/IntroTestMore.pdf)

向 URL发送`HEAD`命令，响应将是

```
Date: Mon, 03 Nov 2008 06:29:09 GMT
Accept-Ranges: bytes
ETag: "156046f-11889-3a578cd2bf2c0"
Server: Apache
Content-Length: 71817
Content-Type: application/pdf
Last-Modified: Thu, 11 Jul 2002 04:53:07 GMT
Client-Date: Mon, 03 Nov 2008 06:29:10 GMT
Client-Peer: 167.168.132.148:8080
Client-Response-Num: 1 
```

有趣的价值观：`Accept-Ranges`,`Content-Length`

`Accept-Ranges: bytes`告诉服务器已准备好按要求逐步提供文件

更多信息在这里：[http ://www.crazyengineers.com/community/threads/how-does-resume-download-work.7396/](http://www.crazyengineers.com/community/threads/how-does-resume-download-work.7396/)

# asp.net-mvc-3 - 如何在请求下载 ASP.NET MVC3 中的文件后立即执行 ajax 调用

> ID：12308356
> 
> 赞同：0
> 
> 时间：2012-09-06T21:03:39.993
> 
> 标签：asp.net-mvc-3, jquery, download, actionresult

我想要做的是在我阅读一个之后更新“新文件”的数量。首先，我有一个包含新文件数量的文本（新文件是指我尚未下载或单击下载的文件）。

```
<a id="Plans">Plans (@Model.NewPlansQuantity)</a> 
```

每当我点击“下载链接”时，我必须下载文件并更新我认为是新文件的数量。这是下载链接：

```
foreach (var item in @Model.MediaItems)
        {
        <tr>
            <td> 
                @Html.ActionLink(@item.Name, "DownloadFile", "Controller",
                                 new
                                    {
                                        FileName = item.FileName,
                                        Type = item.Type,
                                        FileID = item.MediaItemID
                                    }, new { @class = "DownloadLink" })
            </td> 
```

此链接调用以下操作：

```
public FilePathResult DownloadFile(string FileName, int Type, int FileID)
    {
        var file= FileRepository.GetFiles(FileID);
        var fileroute = FilesRepository.FileRoute.FirstOrDefault(x => x.Type == Type);

        if (file != null)
        { 
            file.Read = true;
            FileRepository.SaveFile(file );
        }

        var route = Server.MapPath(Url.Content(fileroute.Route));

        var path = Path.Combine(route, FileName);

        FileInfo info = new FileInfo(path);

        if (info.Exists)
        {
            return File(path, "application/octet-stream", FileName);
        }
        else
        {
            throw new HttpException(404, "Not found");
        } 
    } 
```

我在操作方法中所做的是将文件实体更新为读取并下载它。之后，我必须更新新文件数量的文本，这是上面的第一行代码（我认为是通过 ajax 调用）。我尝试在以下事件中进行 ajax 调用：

```
 $('.DownloadLink').live("click", function () {

       //Tried to do the ajax call here
    }); 
```

我尝试在下载链接事件单击中进行 ajax 调用，但没有奏效。似乎 ajax 调用正在停止，可能是因为我正在同时请求下载文件。有谁知道有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:40:22.710

我想我没有清楚地解释我的问题，无论如何我在这篇文章中找到了我正在寻找的答案。

[使用 ASP.NET MVC，我可以使用 jQuery GET 和 FilePathResult 下载文件吗？](https://stackoverflow.com/questions/2884655/using-asp-net-mvc-can-i-download-a-file-using-a-jquery-get-and-filepathresult)

# android - 使用测试用户进行测试不起作用

> ID：12308364
> 
> 赞同：0
> 
> 时间：2012-09-06T21:04:16.213
> 
> 标签：android, testing, billing

我正在尝试使用“android.test.purchased”保留项和我创建的测试用户来测试我的应用程序。

我的应用程序已签名并上传，但该应用程序不公开。

当我的测试用户尝试使用保留项目“android.test.purchased”购买项目时，签名验证失败。它适用于我的设备（上面有开发者帐户）。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:57:56.277

我的测试帐户不是 gmail.com 地址。

我改变了它并且它有效。

# android - android - MediaRecorder throws illegalstateexception

> ID：12308365
> 
> 赞同：5
> 
> 时间：2012-09-06T21:04:17.073
> 
> 标签：android, mediarecorder, illegalstateexception

I am trying to develop a simple android audio recorder.Everything builds fine and it also runs fine on the android device. It seems like i can start the recording but when i want to stop it throws a IllegalStateException. I can't find the mistake. Here is the code:

```
public class VoiceRecorder {
MediaRecorder recorder= new MediaRecorder();
static Context cont;

public void startRecord(Context context) throws IllegalStateException, IOException{
    cont = context;

    recorder.setAudioSource(MediaRecorder.AudioSource.MIC); 
    recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP); 
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB); 
    recorder.setOutputFile(cont.getFilesDir()+"/recordings.3gp"); 
    recorder.prepare();
    recorder.start();  

 }  
public void stopRecording(Context context) {
    cont = context;
    recorder.stop();
    recorder.release();
    File file = new File (cont.getFilesDir()+"/recordings.3gp");
    UploadFile.uploadFile("recordings.3gp", file);
    recorder = null;
 }
} 
```

I want to trigger it with:

VoiceRecorder vr = new VoiceRecorder();

vr.startRecord(cont);

vr.stopRecording(cont);

when calling start Logcat says: (what should be ok)

```
09-06 22:56:42.830: D/AudioHardwareMSM72XX(123): audpre_index = 0, tx_iir_index = 0
09-06 22:56:42.840: D/HTC Acoustic(123): msm72xx_enable_audpre: 0x0000
09-06 22:56:42.850: I/AudioHardwareMSM72XX(123): Routing audio to Speakerphone
09-06 22:56:42.850: D/HTC Acoustic(123): msm72xx_enable_audpp: 0x0001
09-06 22:56:42.850: I/AudioHardwareMSM72XX(123): Routing audio to Speakerphone
09-06 22:56:42.860: D/HTC Acoustic(123): msm72xx_enable_audpp: 0x0001
09-06 22:56:42.870: D/AudioFlinger(123): setParameters(): io 3, keyvalue routing=262144;vr_mode=0, tid 156, calling tid 123
09-06 22:56:42.870: I/AudioHardwareMSM72XX(123): Routing audio to Speakerphone
09-06 22:56:42.880: D/AudioHardwareMSM72XX(123): audpre_index = 0, tx_iir_index = 0
09-06 22:56:42.880: D/HTC Acoustic(123): msm72xx_enable_audpre: 0x0000
09-06 22:56:42.880: I/AudioHardwareMSM72XX(123): do input routing device 40000
09-06 22:56:42.880: I/AudioHardwareMSM72XX(123): Routing audio to Speakerphone
09-06 22:56:42.890: D/HTC Acoustic(123): msm72xx_enable_audpp: 0x0001 
```

But when i call stop:

```
09-06 22:59:52.440: E/MediaRecorder(1069): stop called in an invalid state: 1
09-06 22:59:52.440: W/System.err(1069): java.lang.IllegalStateException
09-06 22:59:52.460: W/System.err(1069):     at android.media.MediaRecorder.stop(Native Method)
09-06 22:59:52.460: W/System.err(1069):     at de.spyapp.VoiceRecorder.stopRecording(VoiceRecorder.java:33)
09-06 22:59:52.460: W/System.err(1069):     at de.spyapp.CheckCMD.checkCMD(CheckCMD.java:30)
09-06 22:59:52.460: W/System.err(1069):     at de.spyapp.AppActivity$2.run(AppActivity.java:44)
09-06 22:59:52.460: W/System.err(1069):     at java.lang.Thread.run(Thread.java:1096) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:23:26.807

问题不在于停止，而在于开始。它无法正确启动，这就是为什么您以后无法停止它的原因。

检查几件事：a）您添加了权限 android.permission.RECORD_AUDIO

b）您写入 SD 卡（我不确定它的要求，但我相信我在写入内部存储器时遇到了问题）。您需要获得写入 SD 卡的权限。

c) 另外，尝试设置 onErrorListener [http://developer.android.com/reference/android/media/MediaPlayer.html#setOnErrorListener(android.media.MediaPlayer.OnErrorListener](http://developer.android.com/reference/android/media/MediaPlayer.html#setOnErrorListener(android.media.MediaPlayer.OnErrorListener) )

d) 在任何其他调用之前尝试 reset() MediaPlayer 我建议阅读这篇文章 [http://developer.android.com/reference/android/media/MediaPlayer.html#Valid_and_Invalid_States](http://developer.android.com/reference/android/media/MediaPlayer.html#Valid_and_Invalid_States) Android 的 MediaRecorder 状态是噩梦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T21:15:18.583

当您从无效状态调用 stop() 时，似乎会引发该错误。

*   [http://developer.android.com/reference/android/media/MediaPlayer.html#stop](http://developer.android.com/reference/android/media/MediaPlayer.html#stop) ()

记录器的活动周期似乎也表明您需要在开始记录之前准备（）它 - 您在这样做吗？除非至少准备好记录器，否则 stop() 不是有效命令。

*   [http://developer.android.com/reference/android/media/MediaPlayer.html#StateDiagram](http://developer.android.com/reference/android/media/MediaPlayer.html#StateDiagram)

如果是这样，那么记录器可能需要一段时间才能真正稳定在有效状态，然后才能稍后调用 stop()。您在 start() 之后*立即*调用它，所以那里可能正在发生一些事情。

# jquery - Inject multiple lines into iframe head of page same domain

> ID：12308367
> 
> 赞同：2
> 
> 时间：2012-09-06T21:04:35.313
> 
> 标签：jquery

> **Possible Duplicate:**
> [Add CSS to iFrame](https://stackoverflow.com/questions/6960406/add-css-to-iframe)

I'm trying to put some styling and jquery into the head of a page 'within' an iframe. This is on the domain so yes I can pass things into the head. It works fine with just one <'line of code'> but if I use it won't execute. I basically need the following to work:

```
$('#someFrame').contents().find('head').html('<link rel="stylesheet" type="text/css" href="styles.css"/> <script src="link to jquery library"></script> <script src="link to my script">'); 
```

using .append instead of .html doesn't work (I've tried many times, it's 50/50 at best). I can't just add multiple jQuery statements because each time I do it wipes the one before it out.

I tried one big .js file but it won't get past the
not sure what I'm doing wrong. Anybody have any ideas?

# python - Python，需要帮助将文本文件中的项目解析为列表

> ID：12308368
> 
> 赞同：1
> 
> 时间：2012-09-06T21:04:40.397
> 
> 标签：python, parsing

我正在尝试解析文本文件中的项目并将它们存储到列表中。数据看起来像这样：

```
[(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)]
[(10, 3, 1), (11, 3, 1), (12, 3, 1), (13, 3, 1), (13, 4, 1)]
[(10, 3, 5), (11, 3, 5), (12, 3, 5), (13, 3, 5), (13, 4, 5), (13, 5, 5), (13, 6, 5)]
[(6, 13, 5), (7, 13, 5), (8, 13, 5), (8, 14, 5), (7, 14, 5), (6, 14, 5), (6, 14, 6)] 
```

我能够剥离“[”和“]”，但无法将其余信息以如下格式存储到列表中：(x, y, z)。有什么帮助吗？

```
 def dataParser(fileName):
    zoneList=[]; zone=[]
    input=open(fileName,"r")

    for line in input:
        vals = line.strip("[")
        newVals = vals.strip("]\n")

        print newVals
        v=newVals[0:9]
        zone.append(v)

    input.close()
    return zone 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:14:23.710

在这种特殊情况下，您可以使用`ast.literal_eval`：

```
>>> with open("list.txt") as fp:
...     data = [ast.literal_eval(line) for line in fp if line.strip()]
... 
>>> data
[[(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)], [(10, 3, 1), (11, 3, 1), (12, 3, 1), (13, 3, 1), (13, 4, 1)], [(10, 3, 5), (11, 3, 5), (12, 3, 5), (13, 3, 5), (13, 4, 5), (13, 5, 5), (13, 6, 5)], [(6, 13, 5), (7, 13, 5), (8, 13, 5), (8, 14, 5), (7, 14, 5), (6, 14, 5), (6, 14, 6)]] 
```

这是“安全”版本的`eval`. 但是，正是出于这个原因，它并不那么普遍。如果您正在生成此输入，您可能希望研究一种不同的方式来保存您的数据（“序列化”），无论是使用`pickle`还是类似的方式`JSON`- 您可以在 SO 和其他地方找到很多使用这两种方式的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:34:20.713

您可以使用字符串拆分方法和元组构造函数在没有 eval 的情况下执行此操作：

```
>>> st = "[(0,0,0), (1,0,0)]"
>>> splits = st.strip('[').strip(']\n').split(', ')
>>> splits
['(0,0,0)', '(1,0,0)']
>>> for split in splits:
...   trimmed = split.strip('(').strip(')')
...   tup = tuple(trimmed.split(','))
...   print tup, type(tup)
...
('0', '0', '0') <type 'tuple'>
('1', '0', '0') <type 'tuple'>
>>> 
```

从那里，它只是附加到一个列表中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:13:52.937

有些人可能不喜欢[`eval()`](http://docs.python.org/library/functions.html#eval)在这里使用，但您可以使用它在一行中执行此操作：

```
In [20]: lis=eval("[(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)]")
In [23]: lis
Out[23]: [(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)] 
```

使用文本文件：

```
In [44]: with open('data.txt') as f:
   ....:     lis=[eval(x.strip()) for x in f]
   ....:     print lis
   ....:     
   ....:     
[[(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)], [(10, 3, 1), (11, 3, 1), (12, 3, 1), (13, 3, 1), (13, 4, 1)], [(10, 3, 5), (11, 3, 5), (12, 3, 5), (13, 3, 5), (13, 4, 5), (13, 5, 5), (13, 6, 5)], [(6, 13, 5), (7, 13, 5), (8, 13, 5), (8, 14, 5), (7, 14, 5), (6, 14, 5), (6, 14, 6)]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:14:24.243

如果您从任何您不完全信任的来源获取此数据，则以下是一个坏主意，但如果数据始终采用这种格式（并且仅包含数字作为元素），则类似这样的事情非常简单：

```
collect = []
for line in input:
    collect.append(eval(line)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T22:23:03.253

其他答案工作得很好，是这个特定问题的简单解决方案。但我假设如果您在字符串操作方面遇到问题，那么下次遇到此问题时，一个简单的 eval() 函数不会对您有太大帮助。

作为一般规则，当您遇到此类问题时，您要做的第一件事就是定义分隔符。

```
[(0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0), (4, 0, 0), (5, 0, 0), (6, 0, 0)] 
```

在这里您可以看到**“），（”**是组之间的潜在分隔符，简单的逗号（**“，”**）是值之间的分隔符。接下来您想查看需要删除的内容，正如您所指出的，括号 ( **"["**和**"]"** ) 提供的信息很少。我们还可以看到，因为我们处理的是数值，所以所有的空格给我们的信息很少，需要删除。

在此信息的基础上，我以返回您正在寻找的值的方式设置了您的*dataParser函数：*

```
fileName= "../ZoneFinding/outputData/zoneFinding_tofu_rs1000.txt"

def dataParser(fileName):
    with open(fileName,"r") as input
        zoneLst = []
        for line in input:
            #First remove white space and the bracket+parenthese combos on the end
            line = line.replace(" ","").replace("[(","").replace(")]","")

            #Now lets split line by "),(" to create a list of strings with the values
            lineLst = line.split("),(")

            # At this point lineLst = ["0,0,0" , "1,0,0", "2,0,0", ...]
            #Lastly, we will split each number by a "," and add each to a list
            zone = [group.split(",") for group in lineLst]

            zoneLst.append(zone)

        return zoneLst 
```

在上面的示例中，所有值都存储为字符串。您还可以用下面的代码替换区域的定义，以将值存储为浮点数。

```
zone = [ [float(val) for val in group.split(",")] for group in lineLst] 
```

# xpath - XPath using string functions in the middle of the path

> ID：12308374
> 
> 赞同：1
> 
> 时间：2012-09-06T21:04:48.513
> 
> 标签：xpath, web-deployment, webdeploy

I'm trying to use Web Deploy 3.0 to make changes to my web.config before deployment. Let's say I have the following xml:

```
<node>
    <subnode>
        <connectInfo httpURL="http://LookImAUrl.com" />
    </subnode>
<node> 
```

And I'd like to match just the "http" in "http://..." so that I can potentially replace it with https.

I looked into XPath string functions and understand them -- I just don't know how to put them in the middle of an expression, for example:

```
"//node/subnode/connectInfo/@httpURL/substring-before(../@httpURL,':')" 
```

That's basically what I want to do, but it doesn't look right.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:20:45.530

> ```
>  "//node/subnode/connectInfo/@httpURL/substring-before(../@httpURL,':')" 
> ```
> 
> 这基本上就是我想要做的，但它看起来不正确。

但它是正确的，并且会匹配http。

（顺便说一句，你可以在没有 ..

```
 //node/subnode/connectInfo/@httpURL/substring-before(.,':') 
```

)

但是，它将返回字符串“http”，而不是某种指向 @httpUrl 值的指针，这是不可能的，因为值中没有部分节点。

（在 XPath 2 中）您可以返回属性和一个新值，然后可能在调用语言中更改它

```
 //node/subnode/connectInfo/@httpURL/(., concat("https:", substring-after(.,':'))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T12:25:12.863

使用 XPath 1.0，如果要返回 URL 的初始部分，请使用：

```
substring-before(//node/subnode/connectInfo/@httpURL,':') 
```

请注意，这将仅返回第一个`connectInfo`元素的值。

如果要获取`connectInfo`使用 HTTP 的节点：

```
//node/subnode/connectInfo[starts-with(@httpURL,'http:')] 
```

如果你想得到所有`httpURL`使用 HTTP 的东西：

```
//node/subnode/connectInfo/@httpURL[starts-with(.,'http:')] 
```

# android - Android RecognizerIntent 语音识别

> ID：12308381
> 
> 赞同：2
> 
> 时间：2012-09-06T21:05:21.957
> 
> 标签：android, speech-recognition, recognizer-intent

如果由于用户不说话而导致识别器意图完成，如何处理图像（ImageView）的可见性

```
if (RecognizerIntent.EXTRA_RESULTS == null){
image1.setVisibility(View.VISIBLE);///microphone icon
} 
```

或者

```
if (RecognizerIntent.ACTION_RECOGNIZE_SPEECH == null){
image1.setVisibility(View.INVISIBLE);///microphone
} 
```

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-25T15:08:57.800

在上面的代码中，您只是测试常量是否为空，而它们不是。您必须通过以下方式在代码中的某处开始识别

```
 Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
    intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,
            RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
    //... put other settings in the Intent 
    startActivityForResult(intent, REQUEST_CODE); 
```

并收到结果

```
 @Override
     protected void onActivityResult(int requestCode, int resultCode, Intent data)
     {
       if (requestCode == REQUEST_CODE && resultCode == RESULT_OK) {
         ArrayList<String> results = data.getStringArrayListExtra(
                RecognizerIntent.EXTRA_RESULTS);
          //... do your stuf with results
         }
     super.onActivityResult(requestCode, resultCode, data);
     } 
```

一种更可定制的方式是直接使用 SpeechRecognizer。例如看[这个问题](https://stackoverflow.com/questions/6316937/how-can-i-use-speech-recognition-without-the-annoying-dialog-in-android-phones)。

# java - 在 servlet 中运行 java 代码之前加载资源

> ID：12308384
> 
> 赞同：2
> 
> 时间：2012-09-06T21:05:35.733
> 
> 标签：java, tomcat, servlets

我在tomcat中有一个servlet。后端的java代码需要很长时间才能执行。有没有办法与后端代码并行加载静态资源（css、图像、javascript）？现在，它们仅在代码完成运行后才加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:17:34.933

您可以使用 Ajax 风格的解决方案，在没有数据的情况下绘制页面，使用占位符来检索数据，甚至可能使用“加载”微调器图形。

Ajax 调用的工作方式是，当页面加载时，一些 Javascript 将触发，这将通过 XmlHttpRequest 向 Tomcat 发起 Ajax 请求，该请求将开始计算。当tomcat请求完成时，浏览器会通知浏览器。然后网页中会有一些 javascript 将获取响应并替换占位符。如果服务器返回一个 HTML 片段，它就像在 javascript *placeholder-div* .innerHtml = *your-response-text*中执行一样简单。

这是[关于 Ajax 的基本教程](http://www.w3schools.com/ajax/default.asp)和基于[Java 的示例](http://www.ibm.com/developerworks/library/j-ajax1/)，其中 Web 前端与 Java Servlet 后端进行通信。

# css - Why are we not using one CSS file instead of many CSS files?

> ID：12308388
> 
> 赞同：7
> 
> 时间：2012-09-06T21:05:43.877
> 
> 标签：css, organization, project-organization

I recently stumbled across a project that has **27 different CSS files used by the same theme**, and they are for specific sections in the application, rules split like this: there's a CSS file for the menubar, there's two more files for contact forms, another one does the footer, specific-page formatting, two more for galleries, so on.

So I asked lead what's the reasoning for so many CSS files and if it's safe to concatenate.

His reply was that all files sum 126KB, bandwidth matters and there's 500+ CSS rules, so best not concatenate to prevent selector collisions.

I know that 126KB of uncompressed CSS files is an awful lot, but I also know (from the best practices guide) that all these files should be downloaded single shot, so browsers will cache one biggie instead of downloading them one by one across the browsing session.

Why should I not keep myself from gluing all these files together? Is it a big deal?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:08:15.327

由于级联的工作方式，如果您按照它们在源中出现的顺序保存它们，则仅将文件连接在一起是不可能造成伤害的。这将确保以后的文件覆盖较早的文件仍然会这样做。

然后，您可以考虑缩小 CSS。这不会改变选择器的功能，但会压缩它们以减少带宽。

总而言之，拥有 27 个 CSS 文件实在是太愚蠢了。用户必须等待建立 27 个连接、发出请求和完成下载，才能看到该页面。现在，通过适当的缓存，这确实有所改善，但即便如此......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T21:13:09.757

> 为什么我不应该阻止自己将所有这些文件粘在一起？有什么大不了的吗？

如果您知道 CSS 文件没有任何冲突的指令，并且应该为应用程序中的每个页面以相同的顺序加载它们，那么您实际上*应该将它们捆绑到一个缩小的 CSS 文件中。*

但仅此而已。通常，当您发现自己处于这种情况时，很难辨别哪些 CSS 指令应用于哪些屏幕。

重点：您所面临的情况表明[技术债务](http://en.wikipedia.org/wiki/Technical_debt)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T22:20:00.287

虽然我同意 27 个 CSS 文件完全疯狂，并且理想情况下应该合并和缩小它，但在某些用例中划分样式表是有意义的。

考虑一下：您正在处理一个需要大量 CSS 规则的子站点，这些规则在站点上没有使用。如果不能保证用户将同时访问子站点和主站点（因此利用缓存），保留两个样式表是有意义的，因此浏览器不必通读一个巨大的样式表来查看如果有任何内容与 HTML 文档匹配。

现在，这并不常见，但确实会发生。一个例子是一家大型公司，拥有许多拥有自己网站的细分市场。它们可能包含一个样式表用于所有共享样式（企业特定 UI 等），并为布局和覆盖包含单独的样式表。

也就是说，我非常怀疑 27 个样式表是否有意义。原作者可能没有头绪，认为这样更有条理。模块化的 CSS 实际上非常简洁，但在到达客户端之前应该始终将其合并和缩小。这是[SASS](http://sass-lang.com/)中常用的工作方法。对于网站的特定部分或功能，您将拥有许多部分样式表，但是一旦您点击`Ctrl`+ `S`，它就会自动合并到一个整洁的小包中。

现在，您可能只需访问每个页面并记下顺序，就可以弄清楚您网站上的 CSS 文件的加载顺序。这将是一项乏味的工作，并且不能保证它会真正得到回报，但它可以做到。

# c++ - 为什么我需要像临时构造这样的复合文字来初始化我的 std::array 成员？

> ID：12308389
> 
> 赞同：0
> 
> 时间：2012-09-06T21:05:46.220
> 
> 标签：c++, c++11, compiler-errors, g++, compound-literals

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:09:48.627

很多时候，问题在于编译器版本。以下代码适用于 GCC 4.7.1：

```
#include <array>

struct X{
  std::array<int, 2> a;
  X() : a{{1,2}} {}
};

int main(){
  X x;
} 
```

[活生生的例子。](http://liveworkspace.org/code/ccc92885d7384db48fec0999db97699a)

# html - :hover 在我的 svg 路径上不起作用

> ID：12308393
> 
> 赞同：-1
> 
> 时间：2012-09-06T21:05:53.753
> 
> 标签：html, css, svg

我无法通过悬停更改 SVG 路径上的不透明度。这是我的代码：

```
<html>
<head><style>path:hover{opactiy:0.5;}</style></head>
<body>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
<path class='slice' id='slice1' d='M200,200 L199,20 A180,180 0 0,1 380,199 z' fill='#000'/>
<path class='slice' id='slice2' d='M200,200 L380,199 A180,180 0 0,1 305,345 z' fill='#468966'/>
<path class='slice' id='slice3' d='M200,200 L305,345 A180,180 0 0,1 200,380 z' fill='#FFF0A5'/>
<path class='slice' id='slice4' d='M200,200 L200,380 A180,180 0 0,1 54,94 z' fill='#FFB03B'/>
</svg>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:10:39.487

opactiy 不正确，您需要不透明度

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:11:33.460

有错字：

```
path:hover{opactiy:0.5;} 
```

它应该是：

```
path:hover{opacity:0.5;} 
```

# php - PHP，无法发送电子邮件

> ID：12308398
> 
> 赞同：3
> 
> 时间：2012-09-06T21:06:06.873
> 
> 标签：php, forms, validation

我想在我的表格上有一个需要 *fullname、*email 地址以及 *subject 和 *message 的联系表。我按照教程开发了我的表单，但由于某种原因它没有发送我的测试消息。

我没有足够的 PHP 经验来弄清楚我做错了什么，所以我希望得到关于如何解决这个问题的建议。欢迎提出所有问题、建议和可能的解决方案。谢谢。

联系表格 php： 代码：

```
<?php 

// EDIT THE FOLLOWING LINE BELOW AS REQUIRED

$send_email_to = "jb@me.com";

function send_email($name,$email,$email_subject,$email_message)
{
  global $send_email_to;  

  $headers = "MIME-Version: 1.0" . "\r\n";
  $headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
  $headers .= "From: ".$email. "\r\n";

  $message = "<strong>Email = </strong>".$email."<br>";
  $message .= "<strong>Name = </strong>".$name."<br>";
  $message .= "<strong>Message = </strong>".$email_message."<br>";
  @mail($send_email_to, $email_subject, $message,$headers);
  return true;
}

function validate($name,$email,$message,$subject)
{
  $return_array = array();
  $return_array['success'] = '1';
  $return_array['name_msg'] = '';
  $return_array['email_msg'] = '';
  $return_array['message_msg'] = '';
  $return_array['subject'] = '';

 if($email == '')
  {
    $return_array['success'] = '0';
    $return_array['email_msg'] = 'email is required';
  }
  else
  {
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    if(!preg_match($email_exp,$email)) {
      $return_array['success'] = '0';
      $return_array['email_msg'] = 'enter valid email.';  
    }
  }

  if($name == '')
  {
    $return_array['success'] = '0';
    $return_array['name_msg'] = 'name is required';
  }
  else
  {
     $string_exp = "/^[A-Za-z .'-]+$/";
    if (!preg_match($string_exp, $name)) {
      $return_array['success'] = '0';
     $return_array['name_msg'] = 'enter valid name.';
    }
  }

  if($subject == '')
  {
    $return_array['success'] = '0';
    $return_array['subject_msg'] = 'subject is required';
  }

  if($message == '')
  {
    $return_array['success'] = '0';
    $return_array['message_msg'] = 'message is required';
  }
  else
  {
    if (strlen($message) < 2) {
      $return_array['success'] = '0';
      $return_array['message_msg'] = 'enter valid message.';
    }
  }
  return $return_array;
}

$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];
$subject = $_POST['subject'];

$return_array = validate($name,$email,$message,$subject);
if($return_array['success'] == '1')
{
  send_email($name,$email,$subject,$message);
}

header('Content-type: text/json');
echo json_encode($return_array);
die();

?> 
```

联系表格 HTML： 代码：

```
<fieldset id="contact_form">
          <div id="msgs"> </div>
          <form id="cform" name="cform" method="post" action="">
            <input type="text" id="name" name="name" value="Full Name*" onfocus="if(this.value == 'Full Name*') this.value = ''"
                            onblur="if(this.value == '') this.value = 'Full Name*'" />
            <input type="text" id="email" name="email" value="Email Address*" onfocus="if(this.value == 'Email Address*') this.value = ''"
                            onblur="if(this.value == '') this.value = 'Email Address*'" />
            <input type="text" id="subject" name="subject" value="Subject*" onfocus="if(this.value == 'Subject*') this.value = ''"
                            onblur="if(this.value == '') this.value = 'Subject*'" />
            <textarea id="msg" name="msg" onfocus="if(this.value == 'Your Message*') this.value = ''"
                            onblur="if(this.value == '') this.value = 'Your Message*'">Your Message*</textarea>
            <button id="submit" class="button"> Send Message</button>
          </form>
        </fieldset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:07:46.577

您的表单操作未设置为任何内容。您需要将其指向您那里的发送电子邮件的脚本。

IE：

```
<form id.. name.. method.. action="/handle_post.php"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:12:56.550

设置正确的操作，然后尝试它应该可以工作..如果它仍然不起作用，请使用 curl 实用程序测试它以查看您的脚本是否正常..我看到的另一个错误是您的文本区域表单名称是 msg 在服务器上你期待你的帖子请求它有消息。那行不通..如果您仍然遇到问题，那么我们将进一步调试:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:14:27.427

首先，您需要为一些将处理`$_POST`输入 ( `contactform.php`) 或`$_SERVER['PHP_SELF']`同一文件的脚本设置操作。

其次，您应该通过输入`type=submit`而不是按钮发送数据。

# android - 泄漏服务连接是什么意思？

> ID：12308400
> 
> 赞同：20
> 
> 时间：2012-09-06T21:06:15.047
> 
> 标签：android, service

我正在为我的 Android 应用程序编写服务，并试图了解绑定机制是如何工作的。如果我在活动的 onCreate 中绑定我的服务，但我没有在 onStop 或 onDestroy 中取消绑定，我会收到错误消息：

```
android.app.ServiceConnectionLeaked: Service com.google.ipc.invalidation.ticl.android.AndroidInvalidationService has leaked ServiceConnection com.googl
                              e.ipc.invalidation.external.client.android.service.ServiceBinder$1@4177f8f8 that was originally bound here 
```

所以我的问题是：泄漏连接到底有什么问题，我通过解除绑定我的服务来防止什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-06T21:17:14.017

通常，您的应用程序是唯一可以访问您的服务（或使用它）的应用程序。如果在此服务仍在运行的情况下销毁您的应用程序，则该服务不再具有用途。它将存在于内存中消耗资源但什么都不做。通过在完成后解除绑定或停止服务，您可以返回这些资源，以便其他应用程序可以使用它们。

想象一个孩子把玩具摊开在房间里然后离开。房子里的其他人（父母、兄弟姐妹和客人）对他们没有用处，必须在所有地方走来走去。玩具只是碍事。如果孩子把它们收起来，那么任何人都可以随心所欲地使用这个房间。

希望有帮助！

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-09-06T21:09:23.940

当 Android OS 销毁`Activity`并发现 a`ServiceConnection`仍然绑定到 running时会发生这种情况`Service`，因此您需要在销毁您的服务之前取消绑定服务`Activity`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-12T11:41:32.070

即使活动关闭，服务仍在运行。所以需要在 onStop 或 onDestroy 中解绑资源。

# iframe - 带有dojo.io.iframe的IE9“访问被拒绝”，但仅在关注gmail链接时

> ID：12308401
> 
> 赞同：2
> 
> 时间：2012-09-06T21:06:18.257
> 
> 标签：iframe, file-upload, dojo, internet-explorer-9, access-denied

好的，我们正在使用 dojo.io.iframe 上传文件。我一直在阅读有关情况可能会导致“访问被拒绝”错误的许多不同方式，但我仍然很难过。以下是一些细节：

*   道场 1.6.1 (23843)
*   Windows 7 上的 IE 9.0.8112.16421
*   **最奇怪的部分：**要进入上传页面，用户单击电子邮件中的链接。当我在 IE 中打开 gmail 并单击链接然后提交表单时出现错误，但如果我将链接复制并粘贴到 IE 并提交表单，则不会发生此错误。
*   没有跨域。但是，该地址是 IP 地址，而不是主机名或域名。
*   错误发生在 dojo.io.iframe _fireNextRequest() 函数的 form.submit() 行上。所以它不会是由服务器响应中的任何内容引起的。

这个完全相同的代码在其他页面上的 IE 中运行良好，当我复制并粘贴链接而不是通过 gmail 跟踪它时。

# c#-4.0 - 递归搜索 Linq to xml

> ID：12308402
> 
> 赞同：1
> 
> 时间：2012-09-06T21:06:25.010
> 
> 标签：c#-4.0, twitter, linq-to-xml

这是我的示例 xml。

```
<Messages>
  <Conversation>
    <id>Z100</id>
    <ReplyToId></ReplyToId>
    <Message>Topic</Message>
  </Conversation>
  <Conversation>
    <id>A100</id>
    <ReplyToId></ReplyToId>
    <Message>This is a test</Message>
  </Conversation>
  <Conversation>
    <id>M100</id>
    <ReplyToId>A100</ReplyToId>
    <Message>What kind of test</Message>
  </Conversation>
  <Conversation>
    <id>A200</id>
    <ReplyToId>M100</ReplyToId>
    <Message>Stage 1</Message>
  </Conversation>
  <Conversation>
    <id>M200</id>
    <ReplyToId>A200</ReplyToId>
    <Message>Test result for </Message>
  </Conversation>
</Messages> 
```

如何在 C# 中使用 linq 获取基于 id 的对话列表。例如，如果我想获取 id 为“A100”的对话，该对话具有指向基于 ReplyToid 的其他对话的链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:36:20.740

**编辑：** *由于您的澄清，我已经重写了我的答案。*

## 构建对话树

1.  用于`XElement`从您的 xml 文件**加载根元素**及其子元素：

    ```
    var root = XElement.Load(@"path\to\your.xml"); 
    // Alternatively, XElement.Parse(stringContainingXML); 
    ```

2.  **将元素**转换为对话（对话类如下所示）：

    ```
    var conversations = (from element in root.Elements()
                         select Conversation.FromXElement(element)).ToList();
    // ToList prevents multiple iteration of the IEnumerable 
    ```

3.  **将回复添加**到每个对话：

    ```
    foreach (var conversation in conversations)
    {
        conversation.Replies.AddRange( 
        conversations.Where(reply => reply.ReplyToId == conversation.Id));
    } 
    ```

4.  *（可选）*从顶层删除回复：

    ```
    conversations.RemoveAll(x => !string.IsNullOrEmpty(x.ReplyToId)); 
    ```

5.  *（可选）*按 id 检索单个对话：

    ```
    Conversation singleConversation = conversations.Single(x => x.Id == "A100"); 
    ```

* * *

## 结果

```
Z100：主题
A100：这是一个测试
*->M100: 什么样的测试
   *->A200：第一阶段
      *->M200: 测试结果

```

* * *

## 会话助手类

```
public class Conversation
{
    public string Id { get; private set; }
    public string ReplyToId { get; private set; }
    public string Message { get; private set; }
    public readonly List<Conversation> Replies = new List<Conversation>();

    public static Conversation FromXElement(XElement source)
    {
        return new Conversation
        {
            Id = (string)source.Element("id"),
            ReplyToId = (string)source.Element("ReplyToId"),
            Message = (string)source.Element("Message")
        };
    }     
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T17:57:42.367

我必须再包含一个函数来进行递归搜索:-)。

```
public IEnumerable<Conversation> GetReplies() {
  yield return this;

  if (Replies != null) {
    foreach (var item in Replies
                          .Where(s => s != null)
                          .SelectMany(x => x.GetReplies())) {
      yield return item;
    }
  }
} 
```

# php - Symfony2 Form - 嵌入表单和事件监听器

> ID：12308403
> 
> 赞同：2
> 
> 时间：2012-09-06T21:06:27.053
> 
> 标签：php, symfony, symfony-forms

我有一个带有事件侦听器的表单“AddressType”，它在单独实例化时按预期工作。这是代码。

```
namespace Nc\ClientsBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;
use Nc\ClientsBundle\Form\EventListener\AddCityFieldSubscriber;

class AddressType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('street')
            ->add('number', 'text')
            ->add('complement')
            ->add('district')
            ->add('state', 'entity', array(
                'class' => 'ClientsBundle:State', 
                'property' => 'name',
            ));
        $subscriber = new AddCityFieldSubscriber($builder->getFormFactory());
        $builder->addEventSubscriber($subscriber);
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Nc\ClientsBundle\Entity\Address',
        );
    }

    public function getName()
    {
        return 'addresstype';
    }
}

<?php

namespace Nc\ClientsBundle\Form\EventListener;

use Symfony\Component\Form\Event\DataEvent;
use Symfony\Component\Form\FormFactoryInterface;
use Symfony\Component\EventDispatcher\EventSubscriberInterface;
use Symfony\Component\Form\FormEvents;
use Doctrine\ORM\EntityRepository;

class AddCityFieldSubscriber implements EventSubscriberInterface
{
    private $factory;

    public function __construct(FormFactoryInterface $factory)
    {
        $this->factory = $factory;
    }

    public static function getSubscribedEvents()
    {
        // Tells the dispatcher that we want to listen on the form.pre_set_data
        // event and that the preSetData method should be called.
        return array(FormEvents::PRE_SET_DATA  => 'preSetData');
    }

    public function preSetData(DataEvent $event)
    {
        $data = $event->getData();
        $form = $event->getForm();

        // During form creation setData() is called with null as an argument
        // by the FormBuilder constructor. We're only concerned with when
        // setData is called with an actual Entity object in it (whether new,
        // or fetched with Doctrine). This if statement let's us skip right
        // over the null condition.
        if (null === $data) {
            return;
        }

        if (!$data->getCity()) {

            $form->add($this->factory->createNamed('city_selector', 'city', null, array(
                'choices'   => array('' => '--  Selecione um estado  --'),
                'required'  => true,
                'expanded'  => false,
                'multiple'  => false,
            )));

        } else {

            $city = $data->getCity();
            $form->add($this->factory->createNamed('city_selector', 'city', null, array(
                'choices'   => array($city->getId() => $city->getName()),
                'required'  => true,
                'expanded'  => false,
                'multiple'  => false,
            )));
        }

    }

}

<?php

namespace Nc\ClientsBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

use Doctrine\Common\Persistence\ObjectManager;
use Nc\ClientsBundle\Form\DataTransformer\CityToIdTransformer;

class CitySelectorType extends AbstractType
{
    /**
     * @var ObjectManager
     */
    private $om;

    /**
     * @param ObjectManager $om
     */
    public function __construct(ObjectManager $om)
    {
        $this->om = $om;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $transformer = new CityToIdTransformer($this->om);
        $builder->prependNormTransformer($transformer);
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'invalid_message' => 'Selecione um estado e uma cidade.',
        );
    }

    public function getParent(array $options)
    {
        return 'choice';
    }

    public function getName()
    {
        return 'city_selector';
    }
}

<?php

namespace Nc\ClientsBundle\Form\DataTransformer;

use Symfony\Component\Form\DataTransformerInterface;
use Symfony\Component\Form\Exception\TransformationFailedException;
use Doctrine\Common\Persistence\ObjectManager;
use Nc\ClientsBundle\Entity\City;

class CityToIdTransformer implements DataTransformerInterface
{
    /**
     * @var ObjectManager
     */
    private $om;

    /**
     * @param ObjectManager $om
     */
    public function __construct(ObjectManager $om)
    {
        $this->om = $om;
    }

    /**
     * Transforms an object (city) to a integer (id).
     *
     * @param  City|null $city
     * @return string
     */
    public function transform($city)
    {
        if ($city === null) {
            return '';
        }

        return $city->getId();

    }

    /**
     * Transforms a string (id) to an object (city).
     *
     * @param  string $id
     * @return City|null
     * @throws TransformationFailedException if object (city) is not found.
     */
    public function reverseTransform($id)
    {
        if (!$id) {
            return null;
        }

        $city = $this->om
            ->getRepository('ClientsBundle:City')
            ->findOneBy(array('id' => $id))
        ;

        if (null === $city) {
            throw new TransformationFailedException(sprintf(
                'An city with id "%s" does not exist!',
                $id
            ));
        }

        return $city;
    }
} 
```

发生的情况是，当我尝试将此表单嵌入“ClientType”表单时，“city”字段未呈现。

```
namespace Nc\ClientsBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class ClientType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder->add('name');
        $builder->add('type', 'choice', array(
            'choices'   => array('1' => 'Comum', '2' => 'Parceiro'),
            'expanded'  => true,
            'multiple'  => false,
            'required'  => true,
        ));
        $builder->add('contactInfo', new ContactInfoType(), array('label' => ' '));
        $builder->add('address', new AddressType(), array('label' => ' '));
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Nc\ClientsBundle\Entity\Client',
        );
    }

    public function getName()
    {
        return 'clienttype';
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T14:45:42.920

当您尝试嵌入城市字段并且实体没有填充城市值时，方法$form->getData()返回null，因此在这种情况下城市字段不会呈现，因为“if”语句总是返回false（preSetData函数在订阅者类）首先我们要检查是否填写了城市，如果是，则添加相应的表单字段，否则添加空白字段（或其他）。

以下是一些代码片段：

1.  如果其值已填充，则添加城市字段

    ```
    public function preSetData(DataEvent $event)
    {
        $data = $event->getData();
        $form = $event->getForm();

        if (!($data instanceof Address) || !$data->getCity()) {
            return;
        }

        $city = $data->getCity();
        $form->add($this->factory->createNamed('city_selector', 'city', null, array(
            'choices'   => array($city->getId() => $city->getName()),
            'required'  => true,
            'expanded'  => false,
            'multiple'  => false,
        )));
    } 
    ```

2.  如果其值未填充，则添加空白城市字段（postSetData 在设置数据后触发）

    ```
    public function postSetData(DataEvent $event)
    {
        $form = $event->getForm();

        if (!$form->has('city_selector')) {
            $form->add($this->factory->createNamed('city_selector', 'city', null, array(
                'choices'   => array('' => '--  Selecione um estado  --'),
                'required'  => true,
                'expanded'  => false,
                'multiple'  => false,
            )));
        }
    } 
    ```

3.  我们还必须注册 postSetData 事件

    ```
    public static function getSubscribedEvents()
    {
        return array(
            FormEvents::PRE_SET_DATA   => 'preSetData',
            FormEvents::POST_SET_DATA  => 'postSetData'
        );
    } 
    ```

# wix - 在自定义操作中写入本地计算机注册表（有条件地）

> ID：12308404
> 
> 赞同：1
> 
> 时间：2012-09-06T21:06:28.510
> 
> 标签：wix, windows-installer, uac

Windows Installer 具有自动决定是否将注册表值存储在`HKEY_CURRENT_USER`或`HKEY_LOCAL_MACHINE`（`Root="HKMU"`在 WiX 中使用）的智能功能。

我需要在安装过程中编写一些复杂的注册表项，因此我为此创建了一个自定义操作。取决于是否`ALLUSERS`设置或`HKEY_CURRENT_USER`将`HKEY_LOCAL_MACHINE`是自定义操作使用的位置。

不幸的是，我不得不意识到，即使在`ALLUSERS`安装中，自定义操作也没有写入所需的权限，`HKEY_LOCAL_MACHINE`除非以管理员身份启动安装。如何获得要写入的自定义操作，`HKEY_LOCAL_MACHINE`但仍保留按用户安装的选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:01:31.570

不要使用自定义操作，您将失去 Windows Installer 的所有其他智能功能，例如 ugprades、回滚、卸载等。

相反，将注册表值放在它们自己的组件中，并对组件设置条件。如果条件评估为真，则组件及其关联的注册表资源将被安装。

看看[Privileged 属性](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370852%28v=vs.85%29.aspx)。这听起来像是您正在寻找进行评估的内容。

# c# - 工作线程和后台工作线程之间的区别？

> ID：12308413
> 
> 赞同：3
> 
> 时间：2012-09-06T21:07:39.183
> 
> 标签：c#, java, .net, multithreading

> **可能重复：**
> [BackgroundWorker 和 Thread 之间的区别？](https://stackoverflow.com/questions/4757159/difference-between-backgroundworker-and-thread)

我在一次采访中被问到这个问题。这应该是什么答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:10:11.410

“后台”这个词意味着它比非后台线程执行的关键任务更少，并且在它们完成时并不重要。在 Java 中，这可能意味着使用守护线程。

从技术上讲，它们是同一件事，不同之处是主观的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:12:12.643

当您需要在后台执行长时间操作并从线程与 UI 交互时，最常使用后台工作线程。Backgroundworker 具有一些功能，可以更轻松地与 UI 交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:16:59.103

“worker”和“background”线程都不是主/ UI 线程。

除非您有更多详细信息（例如，*在 Language X 或 Framework Y 的上下文中*），否则它们之间没有明显区别。但是，正如我认为的那样：

*   **工作线程** *听起来*可能属于工作人员池。在这种情况下，它可能会在完成任务后被重新使用（并且只有在工作池终止时才会停止）。
*   **后台线程** *听起来像是*被异步调用以完成单个任务。可能是为了避免 UI 线程阻塞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T22:31:13.713

BackgroundWorker 是一个 System.ComponentModel 类，可让您在单独的 Threadpool 线程上执行方法。Joe Albahari 有一篇[很好的文章](http://www.albahari.com/threading/part3.aspx#_BackgroundWorker)。

工作线程是从主线程产生的线程的通用术语，通常与 UI 并行工作。

# javascript - 我想用 addEventListener 复制它

> ID：12308415
> 
> 赞同：1
> 
> 时间：2012-09-06T21:07:47.740
> 
> 标签：javascript, addeventlistener

如果问题可能有点宽泛，我很抱歉，但我已经尝试了所有方法，但我无法找到替代它的东西（这不是我的，我只是在使用它）：

```
 function onlyNum(evt){

        evt = window.event;
        var charCode = (evt.which) ? evt.which : evt.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57)){
            return false;
        }

        return true;
    }

// this INPUT will not accept anything but numbers now.
<input type="text" id="idInput" onKeyPress="return onlyNum(event)"> 
```

有了这个：

```
 function onlyNum(evt){

    evt = window.event;
    var charCode = (evt.which) ? evt.which : evt.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57)){
        return false;
    }

    return true;
}

// this INPUT's with this event listeners will just acept numbers now.
// like this code is cleaner since you just need to make a list of ids that will have this listeners.
var input = document.getElementById('idTest');
input.addEventListener('keyDown', onlyNum, false); 
```

我找不到将事件传递给函数和“返回”部分的方法。抱歉，我什至不知道如何描述它，也许这就是为什么我找不到有关此问题的任何信息的原因...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:59:06.040

`addEventListener()`当使用带有or的通用事件处理程序时`attacheEvent()`，您不能`return false`像将事件处理程序放在 HTML 中那样仅仅阻止默认操作。相反，您可能需要在大多数浏览器中调用`evt.preventDefault()`，或者在旧版本的 IE 中调用。`evt.stopPropagation()``window.event.returnValue = false``window.event.cancelBubble = true`

为了简单和跨平台地做到这一点，我开发了一个`addEvent()`功能，可以为您完成所有跨平台工作（包括 IE6、IE7、IE8）。因此，使用它来添加事件处理程序，您要做的就是：

```
addEvent("idTest", "keydown", onlyNum);​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/2ATmz/](http://jsfiddle.net/jfriend00/2ATmz/)。

这是使用新事件函数的代码：

```
function onlyNum(evt){
    var charCode = (evt.which) ? evt.which : evt.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57)){
        return false;
    }
    return true;
}

addEvent("test", "keydown", onlyNum);​ 
```

而且，这是跨平台事件函数：

```
// refined add event cross browser
function addEvent(elem, event, fn) {
    if (typeof elem === "string") {
        elem = document.getElementById(elem);
    }

    // avoid memory overhead of new anonymous functions for every event handler that's installed
    // by using local functions
    function listenHandler(e) {
        var ret = fn.apply(this, arguments);
        if (ret === false) {
            e.stopPropagation();
            e.preventDefault();
        }
        return(ret);
    }

    function attachHandler() {
        // set the this pointer same as addEventListener when fn is called
        // and make sure the event is passed to the fn also so that works the same too
        var ret = fn.call(elem, window.event);   
        if (ret === false) {
            window.event.returnValue = false;
            window.event.cancelBubble = true;
        }
        return(ret);
    }

    if (elem.addEventListener) {
        elem.addEventListener(event, listenHandler, false);
    } else {
        elem.attachEvent("on" + event, attachHandler);
    }
} 
```

注意：我稍作修改`onlyNum()`，因为这个事件处理函数总是传递事件对象（你不必为 IE 以不同的方式处理事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:30:14.953

你可以试试这个

```
window.onload=function(){ 
    var input = document.getElementById('idTest');
    if(input.addEventListener) input.addEventListener('keydown', onlyNum, false);
    else input.attachEvent('onkeydown', onlyNum, false);
}

function onlyNum(e)
{
    var e=e || window.event;
    var charCode = (e.which) ? e.which : e.keyCode;
    if (charCode > 31 && (charCode < 48 || charCode > 57)){
        if(e.preventDefault) e.preventDefault();
        else e.returnValue = false;    
    }
} 
```

[**演示**](http://jsfiddle.net/GVKwS/)。

# wordpress - 页面模板中未解析简码 - Wordpress

> ID：12308418
> 
> 赞同：0
> 
> 时间：2012-09-06T21:08:01.520
> 
> 标签：wordpress, shortcode

我在 Wordpress 中创建了一个 404 错误页面，并尝试在 404.php 模板中包含一个联系表单。因此，我安装了“快速安全联系表单”插件，并创建了一个帖子，其中包含所述插件的简码。当我查看此插件的帖子时，联系表格会正确显示。当我尝试手动将帖子注入 404.php 模板时，使用： $page_id = 4015; $page_object = get_post($page_id); 回声 $page_object->post_content;

简码仅显示为文本。对此的任何帮助将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T04:05:37.077

为什么不这样做，将短代码添加到您的 404 页面。

```
<?php echo do_shortcode('[si-contact-form form="1"]'); ?> 
```

您不必为联系表单创建新帖子。

# c# - 将 XML 序列化为 byte[] 而不是文件

> ID：12308422
> 
> 赞同：1
> 
> 时间：2012-09-06T21:08:40.040
> 
> 标签：c#, serialization, xml-serialization

这一定很简单，但我无法通过搜索找到它。

我有以下代码将对象序列化为文件并返回。但现在我想序列化为 byte[] 并返回。

```
XmlSerializer serializer = new XmlSerializer(typeof(Class1));
using (TextWriter textWriter = new StreamWriter(path))
    serializer.Serialize(textWriter, class1);
using (TextReader textReader = new StreamReader(path))
    class1b = (Class1)serializer.Deserialize(textReader); 
```

我尝试使用 MemoryStream：

```
byte[] buffer = new byte[1000];
using (TextWriter textWriter = new MemoryStream(buffer))
... 
```

但我得到一个错误。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T21:10:48.133

您应该将流发送到 StreamWriter，而不是尝试将 Stream 分配给 TextWriter。

```
using (var stream = new MemoryStream(buffer))
{
    using (TextWriter textWriter = new StreamWriter(stream))
    { ... }
} 
```

# google-maps-api-3 - 使用 API Google 更改 KML 文件的所有标记的大小

> ID：12308424
> 
> 赞同：1
> 
> 时间：2012-09-06T21:08:50.203
> 
> 标签：google-maps-api-3, kml

我正在尝试制作一张显示项目多个信息的地图。我在 Arcgis 中有 1000 个点，每个点都有一个 html 代码，显示点的特定信息（名称、位置、1 张图片等）。我将这些点导出到一个 kml 文件，所以我在一个包含所有信息的一个 kml 文件中拥有 1000 个点。我想要做的是使用 api Google 地图（大小、颜色等）格式化 kml 文件的所有标记，所以当我在网页中加载地图时，我可以使用标记的大小或颜色kml 文件。我还没有找到程序。我不知道我是否很好地解释了这个问题。

我的意思是使用 API Google 地图更改 kml 文件的所有标记的大小和颜色的代码。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T03:24:39.893

您无法使用本机 Google Maps API v3 [KmlLayer](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)类来做到这一点。您可以将 KML 导入 FusionTables，覆盖[FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/reference#FusionTablesLayer)和[动态样式，](https://developers.google.com/maps/documentation/javascript/layers#fusion_table_styles)或使用第三方 KML 解析器（如[geoxml3](http://code.google.com/p/geoxml3/)或[geoxml-v3](http://code.google.com/p/geoxml-v3/)）解析 KML 并使用原生 Google Maps API v3 对象呈现它。

# javascript - Javascript日期字符串到年龄

> ID：12308425
> 
> 赞同：0
> 
> 时间：2012-09-06T21:08:52.573
> 
> 标签：javascript, date, datetime

> **可能重复：**
> [在 JavaScript 中计算年龄](https://stackoverflow.com/questions/4060004/calculate-age-in-javascript)

假设我有一个表单字符串`Apr 1928`，我想得到这个人的年龄（`84`在这种情况下）。如果我在当前月份是那个月份并且不清楚他们是哪一天出生的特殊情况下休假一年也没关系。获取此人年龄的最简单、最优雅的方法是什么？

# python - 参数化 SQL 查询中 pg_trgm % 运算符的问题

> ID：12308432
> 
> 赞同：2
> 
> 时间：2012-09-06T21:09:36.763
> 
> 标签：python, postgresql, psycopg2

这可能是一个非常愚蠢的问题。

psyco2pg 或 postgres 都不喜欢相似性运算符。这有效：

```
sql = 'Select * from movie where title = %s'
data = ('Clockers',)
cur.execute(sql, data) 
```

但是，当我将运算符更改为 pg_trgm 模块的 '%' 时，我得到一个 'tuple index out of range' 错误。

```
sql = 'Select * from movie where title % %s'
data = ('Clockers',)
cur.execute(sql, data) 
```

有解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:53:53.870

尝试`title %% %s`

（从评论中复制和粘贴）

# html - 谷歌搜索站点地图

> ID：12308433
> 
> 赞同：1
> 
> 时间：2012-09-06T21:09:37.667
> 
> 标签：html, sitemap

有谁知道任何好的教程可以向我展示如何创建类似于下图的站点地图。我不知道如何在下面添加不同的部分，例如您的帐户、常见问题解答等。
任何帮助都会非常有帮助。谢谢你。

谷歌搜索Instagram

![在此处输入图像描述](../Images/c92fec65fcd605ad4781e8463be6fa1d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:26:05.713

你可以试试[这个：http://www.xml-sitemaps.com/](http://www.xml-sitemaps.com/)，或者只是谷歌“xml站点地图生成器”我记得发生了什么（在我的“前世”生活中，当我不得不处理所有血腥的细节时我们公司网站的）我只是按照谷歌推荐的 seo 建议。这是艰苦而缓慢的，但随着时间的推移，当我们开始出现在搜索结果的顶部时，这正是谷歌向我们展示的方式。它自己提取相关信息并创建了漂亮的显示。查看我的旧代码库，我什至看不到站点地图文件。但我确实记得使用其中一个在线生成器，然后手动转动一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:38:30.400

您想要的是 Google 所称的[Sitelinks](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=47334)。

该过程是自动化的，目前无法创建它们，但您可以使用 Google 的网站管理员工具对其进行管理。谷歌用来生成它们的算法是[不公开](http://en.wikipedia.org/wiki/Sitelink)的。

# c# - ASP.NET WebApi - 我如何“允许”而不是“要求”客户端证书？

> ID：12308434
> 
> 赞同：6
> 
> 时间：2012-09-06T21:09:41.503
> 
> 标签：c#, security, ssl, asp.net-web-api, client-certificates

在 IIS 中，我可以“忽略”、“允许”和“要求”客户端证书。

在 ASP.NET WebAPI（不久前推出的 4.0 版）中，我似乎只能“忽略”或“要求”。

默认情况下，客户端证书被忽略......所以这个语句总是产生空值：

```
var cert = actionContext.Request.GetClientCertificate(); 
```

但是，如果我在我的配置上设置这个标志：

```
config.ClientCredentialType = HttpClientCredentialType.Certificate; 
```

然后我得到了客户端证书......但是，我不再有能力允许匿名访问。

我的匿名客户端现在收到`403`错误消息：“远程服务器返回错误：(403) Forbidden。”

我可以像在 IIS 中那样做一种“允许”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T16:47:56.673

这是在自托管方案中使用 X509 证书的已知限制。实际限制来自 WCF 中的底层传输绑定，它没有关于客户端证书的*允许选项。*

但是，您可以使用其他选项（例如匿名和窗口）允许多个身份验证方案。我们正在与 WCF 团队合作，以确定我们是否可以通过匿名和 x509 证书添加该支持。

希望这可以澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T11:00:26.517

可能是提供的证书无效吗？如果是这种情况，以下内容可以帮助您： [RemoteCertificateValidationCallback](http://msdn.microsoft.com/en-us/library/system.net.security.remotecertificatevalidationcallback.aspx)

# azure - Azure 服务总线 BrokeredMessage 已被使用？

> ID：12308440
> 
> 赞同：9
> 
> 时间：2012-09-06T21:09:56.763
> 
> 标签：azure, servicebus, azureservicebus

Azure 服务总线出现间歇性问题。偶尔，在总线上放置消息会导致以下异常：

类型：无效操作异常

MESSAGE：无法执行操作，因为代理消息“723eab13dab34351a78bb687d0923b89”已被消费。请使用新的 BrokeredMessage 实例进行操作。

堆栈跟踪

```
at Microsoft.ServiceBus.Messaging.MessagingUtilities.ValidateAndSetConsumedMessages(IEnumerable`1 messages)
at Microsoft.ServiceBus.Messaging.MessageSender.Send(TrackingContext trackingContext, IEnumerable`1 messages, TimeSpan timeout)
at Microsoft.Practices.TransientFaultHandling.RetryPolicy.<>c__DisplayClass1.<ExecuteAction>b__0()
at Microsoft.Practices.TransientFaultHandling.RetryPolicy.ExecuteAction[TResult](Func`1 func)
at IQ.IR.Core.ServiceBus.AzureBus`1.Enqueue(T message) in c:\BuildAgent\work\cc0c51104c02a4e9\IQ.IR.Core\ServiceBus\AzureBus.cs:line 69
...Rest of stacktrace snipped as it's within my app 
```

AzureBus 的违规代码是：

```
public void Enqueue(T message)
{
    using (var brokeredMessage = new BrokeredMessage(message) { Label = message.GetType().FullName, TimeToLive = _timeToLive })
    {
        _retryPolicy.ExecuteAction(() => _sender.Send(brokeredMessage));
    }
} 
```

传入的 T 消息是

```
[Serializable]
public class ValidationMessage
{
    public string ValidationToken { get; set;}
} 
```

_retryPolicy 是一个

```
RetryPolicy<ServiceBusTransientErrorDetectionStrategy> 
```

_timeToLive 是 12 小时的时间跨度

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T16:22:50.823

.... 并补充 Abhishek 的回答：现在您需要为每次重试构建一个新的 BrokeredMessage，因此您的重试策略范围需要更上一层。请注意，如果您放入一个流，我们将在代理消息中按原样使用该流并将其直接拉到线路上，因此您需要提前制作流的副本以进行重试循环。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T06:13:19.230

该错误表示消息“已发送”，但过程中发生错误。不幸的是，没有简单的方法可以通过检查消息来了解这一点，并且消息不能再次被重用，因为它被认为是已消耗的。我们正在进行一些改进，例如允许您查询此类消息的状态并抛出 MessagingException 而不是 InvalidOperation。最后，克隆消息的能力将有助于更容易地从此类故障中恢复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-23T13:20:35.910

我最近遇到了这个问题并发现了另一个原因：如果您正在构建一个 BrokeredMessage 并在使用 MessageSender 发送它之前设置一个断点，并检查 Message 上的属性，它将尝试访问队列并抛出此异常。简单地先发送消息而不在 IDE 中检查其属性不会导致此问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T19:54:46.163

即使出现错误，是否可能已发送消息？在这种情况下尝试重试之前消息是否应该是幂等的？

# git - Git：分支上的文件不再需要在分支上

> ID：12308442
> 
> 赞同：4
> 
> 时间：2012-09-06T21:10:07.637
> 
> 标签：git

我的分支“branch_a”有一个文件（file_a.txt），该文件不应与“master”上的同名文件不同。我想以这样一种方式更改分支，即从分支中删除这个更改的文件，也就是说，再次出现来自“master”的未更改文件，而不是该文件的更改分支。我试图避免的是必须维护这个文件，它不应该被改变。

起初我认为 git-reset 可能会有所帮助。然后我想也许我应该“git-rm”文件，但这根本不会让我留下文件。我需要将它从分支中删除，以便它不再是“master”上的不同版本。在这种情况下，最佳做法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:19:24.187

我假设您只需将该文件重置回版本`master`，而不是删除任何更改历史，对吗？前者很容易，后者需要修改历史记录并且不应该轻易完成（特别是如果您已将分支推送到本地存储库之外）。

要将文件的内容重置`foo/bar/baz.txt`回它的状态`master`，只需检查您的分支并运行

```
git checkout master -- foo/bar/baz.txt 
```

这将从 master 获取文件，将其写入您的工作副本，并将其暂存到索引中。您现在可以`git commit`做到这一点，您的文件现在将与`master`.

# javascript - 鼠标单击时的 HTML5 画布绘制矩形

> ID：12308446
> 
> 赞同：0
> 
> 时间：2012-09-06T21:10:29.163
> 
> 标签：javascript, html5-canvas, dom-events

我有一个加载到选定图像中的画布。画布应显示用户单击的 2 个 6x6 矩形。在第一次点击时，矩形应该是红色的，第二次点击它应该是蓝色的，第三次点击它，它会重置（删除第一个矩形）等等。这很好用（见这里的例子：[http://jsfiddle.净/8HSGG/](http://jsfiddle.net/8HSGG/) )

 `我的问题是当我重新加载图像时，矩形开始混乱（即颜色以不同的顺序出现或根本不显示）。

我在 Javascript 中有两个变量：topLeft 和 bottomRight 每当加载图像时它们都是空的，然后基于这些进行检查并相应地绘制。

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:15:48.927

每次“处理”图像时，您都会向画布添加事件侦听`click`器。`mouseover`因此，我怀疑您得到的代码会被多次调用。`

# ruby - 正则表达式中的最短匹配

> ID：12308451
> 
> 赞同：0
> 
> 时间：2012-09-06T21:10:41.800
> 
> 标签：ruby, regex

这是我的正则表达式：

```
/<strong>.*ingredients.*<\/ul>/im 
```

假设源代码：

```
<strong>Contest closes on Thursday May 10th 2012 at 9pm PST</strong></div>
<br />
<br />
<br />
* I am not affiliated with Blue Marble Brands or Ines Rosales Tortas in any way.&nbsp; I am not sponsored by them and did not receive any compensation to write this post...I just simply think the&nbsp;Tortas&nbsp;are wonderful!<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-35J5vNrXkqE/T6htXTafrmI/AAAAAAAAA5E/g2mtiuSpSmw/s1600/food+003.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" mea="true" src="http://1.bp.blogspot.com/-35J5vNrXkqE/T6htXTafrmI/AAAAAAAAA5E/g2mtiuSpSmw/s640/food+003.JPG" width="640" /></a></div>
<br />
<strong><span style="font-size: large;">Ingredients:</span></strong><br />
<ul>
<li>Ines Rosales Rosemary and Thyme Tortas</li>
<li>Pizza Sauce (ready made in a jar)</li>
<li>Roma Tomatoes</li>
<li>Roasted Red Peppers </li>
<li>Marinated Artichoke Hearts</li>
<li>Olives (I used Pitted Spanish Manzanilla Olives)</li>
<li>Daiya Vegan Mozzarella Cheese</li>
</ul>
<span style="font-size: large;"><strong>Directions:</strong></span><br />
<br />
Spread small amount of pizza sauce over Torta. 
```

正则表达式是贪婪的，并从中获取所有内容，`<strong>Contest...</ul>`但最短的匹配应该产生`<strong><span style="font-size: large;">Ingredients...</ul>`

这是我的要点：[https ://gist.github.com/3660370](https://gist.github.com/3660370)

::编辑:: 请在强标签和成分之间允许灵活性，以及​​成分和 ul。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:21:13.067

尝试这个：

```
/<strong><span.*ingredients.*<\/ul>/im 
```

请不要对 html 进行正则表达式处理。请改用 Nokogiri 或类似的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T11:08:06.543

我想这就是你要找的：

```
/<strong>(?:(?!<strong>).)*ingredients.*?<\/ul>/im 
```

将第一个替换为`.*`允许`(?:(?!<strong>).)*`它在找到之前匹配除另一个`<strong>`标签之外的任何内容`ingredients`。在那之后，非贪婪导致它在它看到`.*?`的第一个实例时停止匹配。`</ul>`（您的样本仅包含一个`<UL>`元素，但我假设真实数据可能包含更多元素。）

通常的警告适用：即使在完全有效的 HTML 中，也有很多方法可以欺骗这个正则表达式，更不用说我们通常在那里看到的垃圾了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T22:02:55.773

这应该有效：

```
/(?!<strong>.*<strong>.*<\/ul>)<strong>.*?ingredients.*?<\/ul>/im 
```

[在这里](http://rubular.com/r/xlkEsrVXvB)测试

基本上，正则表达式使用负前瞻来避免多个`<strong>`之前，`<\ul>`如下所示：`(?!<strong>.*<strong>.*<\/ul>)`

# objective-c - 实现UITableView的父类的子类未返回数据源，抛出异常

> ID：12308456
> 
> 赞同：1
> 
> 时间：2012-09-06T21:10:50.313
> 
> 标签：objective-c, ios, uitableview, uiview, uiviewcontroller

我想在 UITableView 中显示一些不同类别的媒体（例如，最受关注的、已加星标的）。我创建了`APPParentViewController`哪个实现`UITableViewDataSource`和`UITableViewDelegate`协议。在`cellForRowAtIndexPath`方法 in 中`APPParentViewController`，我返回适当的单元格，该单元格中填充了来自数组的数据。

该数组实际上是`init`在 的子类中的方法中实例化的`APPParentViewController`，我将其示例性地称为`APPChildViewController`。每个媒体类别都有一个`APPChildViewController`。它们只是在实例化数组的方式上有所不同，可以说是数组的内容。

`APPChildViewController`我在另一个 UIViewController ( ) 中实例化所有类，`[[APPChildViewController alloc] init]`然后最初选择一个`APPChildViewController`来查看（所有这些都发生在该 UIViewController 的 viewDidLoad 方法中）。工作至今。

但是当我想`APPChildViewController`简单地通过删除旧视图并添加请求的视图来显示另一个时（当用户通过按下按钮请求它时），我得到以下异常：

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:' *** 
```

这是我正在使用的代码（我删除了我认为不重要的所有内容，所以我希望它仍然可以理解）：

APPParentViewController.h

```
#import <UIKit/UIKit.h>

@interface APPParentViewController : UIViewController <UITableViewDataSource, UITableViewDelegate>
@property (strong, nonatomic) NSArray *media;
@property (strong, nonatomic) UITableView *tableView;
@end 
```

APPParentViewController.m

```
#import "APPParentViewController.h"
#import "APPCell.h"

@interface APPParentViewController ()
@end

@implementation APPParentViewController
@synthesize media;
@synthesize tableView;

-(void)viewDidLoad
{
     self.tableView = [[UITableView alloc] init];
     [self.view addSubview:self.tableView];

     self.tableView.delegate = self;
     self.tableView.dataSource = self;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
     return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
     return [self.media count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
     static NSString *CellTableIdentifier = @"CellTableIdentifier";
     static BOOL nibsRegistered = NO;
     if (!nibsRegistered) {
         UINib *nib = [UINib nibWithNibName:@"APPCell" bundle:nil];
         [self.tableView registerNib:nib forCellReuseIdentifier:CellTableIdentifier];
         nibsRegistered = YES;
     }

     APPCell *cell = [self.tableView dequeueReusableCellWithIdentifier: CellTableIdentifier];
     NSUInteger row = [indexPath row];
     NSDictionary *rowData = [self.media objectAtIndex:row];
     cell.title = [rowData objectForKey:@"Title"];
     return cell;
}
@end 
```

APPChildViewController.h

```
#import "APPParentViewController.h"
@interface APPChildViewController : APPParentViewController
@end 
```

APPChildViewController.m

```
#import "APPChildViewController.h"
#import "APPCell.h"

@interface APPChildViewController ()
@end

@implementation APPChildViewController

- (id)init
{
     self = [super init];
     if (self) {
          self.media = fill array...
     }
     return self;
} 
```

当我将 cellForRowAtIndexPath 方法实现复制到所有子类时它实际上可以工作，但这显然不是继承的工作方式......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:28:03.907

当您进行切换时，一些单元格将引用旧孩子的媒体，如果该对象消失了，哦：

```
NSDictionary *rowData = [self.media objectAtIndex:row]; 
```

尽快切换数据源，您是否发送：

```
 [self.tableView reloadData]; 
```

我假设（希望！）你只有父母拥有的一个笔尖......

# ruby-on-rails - 在非对称的一对多层次关系中删除？

> ID：12308457
> 
> 赞同：0
> 
> 时间：2012-09-06T21:10:53.300
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个简单的层次结构，我正在尝试构建。

```
class Category < ActiveRecord::Base
  attr_accessible :name

  belongs_to :parent, class_name: "Category"
  has_many :children, class_name: "Category", foreign_key: :parent_id
end 
```

我可以将类别添加到树中，并且效果很好。但是，删除时事情并没有按预期工作。例如：

```
root = Category.new(:name => "Root")
child = Category.new(:name => "Child")
child.parent = root
# things are fine to this point. root.children contains child,
# and child.parent is root

root.children.delete child
# at this point root.children is empty, but child.parent is still root 
```

有什么想法可能在这里发生吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:53:59.963

答：是product.reload

这是我在数小时搜索后发现的第一个解释： [https ://stackoverflow.com/a/7449957/456280](https://stackoverflow.com/a/7449957/456280)

（这也与我的问题直接相关：[Delete in Many to Many Relationship Not Symmetric?](https://stackoverflow.com/questions/12308065/delete-in-many-to-many-relationship-not-symmetric/12318359#12318359)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:58:15.777

您可以添加`:dependent => :destroy`到`has_many`关系中，这将在父级被销毁时删除父级的子级。如果只有一个孩子被摧毁，你可能不想摧毁父母，对吧？

# html - 仅用于 HTML 的 Sass

> ID：12308458
> 
> 赞同：5
> 
> 时间：2012-09-06T21:10:59.273
> 
> 标签：html, sass

我发现 SASS 听起来很棒，您可以使用变量、使代码更简洁等等……但是，我看到它适用于 Ruby on Rails。

有没有办法让它像 CSS 一样与 HTML 一起工作？如果不可能的话，那里有类似的东西吗？

谢谢！

（顺便说一句，我将使用 php）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:16:28.427

你可以在任何地方使用 SASS，前提是你已经安装了 ruby​​。它不必是 Ruby on Rails 项目，您只需要安装 SASS gem。

见 - [http://sass-lang.com/tutorial.html](http://sass-lang.com/tutorial.html)

或者，还有其他 CSS 预处理器，例如 LESS 和 Stylus，它们是使用 node.js 而不是 ruby​​ 编译的。

**少**- [http://lesscss.org/](http://lesscss.org/)

**手写笔**- [http://learnboost.github.com/stylus/](http://learnboost.github.com/stylus/)

它们每个都提供类似的功能，但语法略有不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:12:36.603

Jade 是您要查找的预处理器的名称。

[Css-tricks](http://css-tricks.com/video-screencasts/111-get-yourself-preprocessing-in-just-a-few-minutes/)在代码工具包的视频教程中提到并展示了它。
编辑：见评论:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:17:03.357

使用 sass 二进制文件，您实际上可以将 sass 与任何东西一起使用。以下将监视文件夹 ./css/sass 的更改并将编译的 .css 文件放入 ./css

```
sass --watch css/sass:css 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T21:17:40.933

Haml 和 Sass 已经在 Ruby 中使用了一段时间，以简化模板 (Haml) 并使 CSS 更加智能、灵活和易于管理 (Sass)；现在他们来到[phaml](http://code.google.com/p/phamlp/)中的 PHP 。

1.  独立于框架。PHamlP 可以与任何框架一起使用（包装函数需要与框架集成；提供了 Yii 的示例 - 我欢迎为其他框架做出贡献）或独立使用。

2.  缩进自动检测。PHamlP 允许使用空格或制表符作为缩进字符，并自动检测每个文件的缩进；如果有空格，有多少。

3.  渲染选项以支持开发的可读性和最小化的生产空白。

4.  Haml & Sass V3.x 兼容（.sass 和 .scss SASS 语法支持、FireSass 集成、新变量语法、@extend 指令）

5.  包括指南针（PHamlP V3.2 及更高版本）。

# tcpdump - tcpdump 表达式捕获一个接口上的端口和另一个接口上的另一个端口？

> ID：12308467
> 
> 赞同：0
> 
> 时间：2012-09-06T21:11:33.937
> 
> 标签：tcpdump

我需要捕获 eth0 上的端口 9090 和 lo 上的端口 8080（本地主机或环回）。有人可以向我展示可以做到这一点的 tcpdump 表达式吗？我正在使用

```
tcpdump -n -i any port 8080 or port 9090 
```

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:47:51.950

tcpdump -n -i any '（***eth0***和 9090 的主机 ip）或（主机 127.0.0.1 和 8080）'

# css - 使用 CSS 控制 div 内联块之间的环绕间距

> ID：12308468
> 
> 赞同：0
> 
> 时间：2012-09-06T21:11:33.937
> 
> 标签：css, html, whitespace

我正在处理的页面位于[http://www.derekbeck.com/1775/excerpts/](http://www.derekbeck.com/1775/excerpts/)

在桌面浏览器中看起来一切正常，但在移动屏幕截图中，如下所示，它被强制换行。（有关我的问题，请参见下图...）

![](../Images/bd7c2bce53845e34cf1ba5e4cfdd960e.png)
[（全尺寸图像）](https://i.stack.imgur.com/6ePP6.png)

我试图让它优雅地包装，但我有两个问题：

1) 是否有一些 CSS 方法来控制 div inline-block (class="exnote2") 的`Want the entire chapter?<BR>Sign up for the newsletter!`包装方式？

具体来说，我想要：

1a）`padding-left: 20px;`如果它在下面的第二行上，则它的左侧不存在（但如果它确实都在一行上，则有必要将其与PDF图标保持20px），

1b) div inline-block (class="exnote2") 上方的一些空格，使其与“Read Online”图标不那么接近。但是，如果我添加 padding-top 或 margin-top，它会影响桌面版本的漂亮布局（上面链接）。

对于上面的 1b)，我确实为图像后面的整个内联块、包含文本 (class="exitemdetails") 的整个 div 内联块一起制定了一个解决方案。我是这样做的：

```
.exitemdetails {
margin-left: 25px;
/* The following allows for graceful wrapping for mobile phones */
padding-top: 20px;
position: relative;
top: -10px; /* half the padding-top */
} 
```

我也可以为这条线路设计一些东西`Want the entire chapter?<BR>Sign up for the newsletter!`，但我怀疑在不同的条件下它不会像我希望的那样显示。因此，我在这里发帖希望有一个更好、更优雅的解决方案，即如何使用 CSS 来控制 div 的换行方式，以及只有当它们换行时它们之间的间距。

2）我还有一个与此相关的问题：当空间不足时，是否没有简单的 CSS 方法来缩小书籍封面图像？我试过这个，但它什么也没做：

```
.eximage {
width: auto;
height: auto;
}
.eximage img {
max-width: 100%; 
height: auto;
} 
```

感谢您的关注！德里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T18:49:26.580

您是否考虑过使用 css 媒体查询来更改页面在不同屏幕尺寸下的布局？可能值得一试。

[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)

# javascript - 可以刷新 jqGrid 组摘要吗？

> ID：12308470
> 
> 赞同：2
> 
> 时间：2012-09-06T21:11:40.683
> 
> 标签：javascript, jqgrid, grouping, summary

我正在使用两个 jqGrids（在 javascript 中）来实现主从信息。主表使用分组和分组摘要行以及总页脚摘要。详细信息表的单个列是可编辑的。

当用户更新详细信息行时，我可以使用以下代码更新主行和主表的页脚。但是，由于组摘要没有 rowid，我找不到任何挂钩来更新组摘要行。（设置组中的行时不会自动重新计算。）

```
 jQuery(this).footerData('set',{ae:aeTotal});     //details footer
    jQuery('#grid').footerData('set',{ae:newEpaAe}); //master footer
    jQuery('#grid').setCell(rowId, 'ae', aeTotal);   //master row
    //master group summary?? 
```

![以绿色更新圈出的值。 对红色圈出的值的句柄感兴趣。](../Images/06fff41c4b29f7514717d829bd870038.png)

有没有办法在不重新加载整个网格的情况下刷新组的摘要行（红色圈出的值）？

提前致谢！

**更新：**
我仍然没有任何运气获得汇总摘要页脚的钩子。是否可以使用标题的行 ID（即 listghead_0_0）来访问这些数据？

我以这种方式更新表格的主要目的是避免重新加载整个主网格。如果有办法重新加载单行，那也适用于我的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-01T14:32:38.013

桑迪普，你的回答让我走上了正轨。请参阅下面的正确重新分组代码。

```
jQuery("#grid").jqGrid('groupingRemove');
jQuery("#grid").jqGrid('groupingGroupBy', 'data'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-30T08:07:52.160

Have you tried to destroy headers and regrouping with setGroupHeaders

```
jQuery("#grid").jqGrid('destroyGroupHeader'); 
```

and to regroup

```
jQuery("#grid").jqGrid('setGroupHeaders', {
  useColSpanStyle: true, 
  groupHeaders:[
    {startColumnName: 'amount', numberOfColumns: 3, titleText: '<em>Price</em>'},
    {startColumnName: 'closed', numberOfColumns: 2, titleText: 'Shiping'}
  ]
});
... 
```

(From wiki)

Refreshing group headers doesnt seem to be possible.

# c# - WCF 数据服务 5.0

> ID：12308474
> 
> 赞同：0
> 
> 时间：2012-09-06T21:12:06.520
> 
> 标签：c#, .net, wcf-data-services, appharbor

我最近更新到 Visual Studio 2012，现在，当我在 MVC 项目中创建新的 WCF 数据服务时，AppHarbor 似乎缺少 Microsoft.Data.Services 5.0 的程序集。任何人都能够解决这个问题？或者有人知道 AppHarbor 是否计划支持 WCF DS 5.0？

问题是，每当我将程序集添加到我的项目时，我的项目都会抱怨 System.Data.Services 和 Microsoft.Data.Services 之间的冲突。如果我删除 System.Data.Services，那么我的 ODataContext 类会抛出错误，指出它找不到 IUpdatable 接口。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T23:18:51.590

您是否尝试过从 NuGet 安装[数据服务](https://nuget.org/packages/Microsoft.Data.Services)并使用[NuGet 包还原](http://blog.appharbor.com/2012/02/06/use-nuget-package-restore-to-avoid-pushing-packages-to-appharbor)让 AppHarbor 获取包？

您可能也应该解决冲突 - 这里有更多详细[信息](https://stackoverflow.com/questions/5773011/microsoft-data-services-client-dll-vs-system-data-services-client-dll)。

# visual-studio-2010 - 如何在 VS2010 中热交换我的代码？

> ID：12308475
> 
> 赞同：0
> 
> 时间：2012-09-06T21:12:07.423
> 
> 标签：visual-studio-2010

> **可能重复：**
> [是否可以在 Visual Studio 2010 中编辑并继续而不暂停执行？](https://stackoverflow.com/questions/8581969/is-it-possible-to-edit-and-continue-in-visual-studio-2010-without-pausing-execut)

如何在调试和替换正在运行的代码时编辑我的 c# 代码？
* 我习惯于其他 IDE，您只需在其中编译并自动热插拔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:31:22.853

This is called [Edit & Continue](http://msdn.microsoft.com/en-us/library/x17d7wxw.aspx).

# variables - Google Analytics（分析）自定义变量未显示在报告中

> ID：12308478
> 
> 赞同：0
> 
> 时间：2012-09-06T21:12:22.657
> 
> 标签：variables, google-analytics

我“继承”了这段代码，它使用 Google Analytics 来跟踪使用自定义变量的错误，但它们没有显示在 Google Analytics 网站上。不幸的是，实现这个的人不再在这里工作，没有其他人知道它是如何工作的，甚至可以告诉我这些自定义变量是否曾经工作过。我一直在阅读本网站上的文档和示例，看来他的说法是正确的。这是减去帐号的代码：

```
<script type="text/javascript"> 

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-XXXXXXXXX-1']);
    _gaq.push(['_setCustomVar', 1, 'ErrorCode', 'BadPassword-05', 3]);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script> 
```

此代码位于任何其他 javascript 之前的标记中。当我访问 Google Analytics 站点时，我可以看到 18,000 次访问，它显示了所有 URL 信息，但是当我转到 Audience->Custom->Custom Variables 时，它没有显示任何内容，并说“没有此数据看法”。根据我从文档和我的网络搜索中了解到的数据，这就是数据所在的位置。如果以前的开发人员甚至正确编码，谁能给我关于它是如何工作的或基于代码的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T08:47:39.457

此代码在“页面”范围内存储一个自定义变量（“3”作为最后一个值），并且当前的 GUI，没有显示页面级自定义变量报告的标准报告。

您需要使用自定义变量值和页面构建自定义报告（表格格式）。

这应该向您显示收集的数据。

# php - PHP：从另一个函数调用函数时出错 500 内部服务器错误

> ID：12308480
> 
> 赞同：1
> 
> 时间：2012-09-06T21:12:31.123
> 
> 标签：php, function

从这样的另一个函数调用函数时，我没有发现错误：

**函数 PHP**

```
class DB_Functions extends DB_Connect{

    private $dbConnect = "";

    public function __construct() {
        $this->dbConnect = $this->pdo_connect();
    }

    public function __destruct() {
        $this->dbConnect = null;
    }

    public function actionOnProfile() {

        //MORE CODE
        $id = $this->dataActionProfile['id'];
        $nombre = $this->dataActionProfile['nombre'];
        $descrip = $this->dataActionProfile['descrip'];

        updateprofile($nombre, $descrip, $id);
    }

    function updateprofile($nombre, $descrip, $id) {
        $sql = "UPDATE cat_perfiles SET Nombre = :nom, Descripcion = :des WHERE Id = :id";

        $result = $this->dbConnect->prepare($sql) or die ($sql);
        $result->bindParam(':nom',$nombre,PDO::PARAM_STR);
        $result->bindParam(':des',$descrip,PDO::PARAM_STR);
        $result->bindParam(':id',$id,PDO::PARAM_INT);

        if (!$result->execute()) {
            return false; 
        }

        $jsonErrorProfile = array();
        $jsonErrorProfile['success'] = 'success';
        return $jsonErrorProfile;
    }
} 
```

错误是使用**updateprofile($nombre, $descrip, $id);**

错误：**500 内部服务器错误**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:13:48.547

因为你需要打电话`$this->updateprofile(...);`

在 php 中，除了 C++、C#、Java 等 - 您需要始终指定`$this->`

# java - 为什么我会收到此“无法从 Stad 投射到 Edge”错误？

> ID：12308486
> 
> 赞同：0
> 
> 时间：2012-09-06T21:12:53.860
> 
> 标签：java, oop, casting, edges

我正在创建一个使用 Dijkstra 算法的程序，我正在使用代表导入地图上的城市的节点，并且您可以在地图上的两个城市之间创建边。我的问题是每条边都有一个“权重”，它将以分钟为单位表示距离，并且我有一个功能，我想查看两条边之间的距离。

`Cannot cast from Stad to Edge`但是我一直在该行收到错误“ ”

```
Edge<Stad> selectedEdge = (Edge) fvf.visaFörbLista.getSelectedValue(); 
```

其中“Stad”代表城市，“Edge”代表边缘。

```
FormVisaförbindelse fvf = new FormVisaförbindelse();
for(;;) {
  try {
    int svar = showConfirmDialog(null, fvf, "Ändra Förbindelser", JOptionPane.OK_CANCEL_OPTION);
    if (svar != YES_OPTION) return;
    if (fvf.visaFörbLista.isSelectionEmpty() == true) {
      showMessageDialog(mainMethod.this, "En Förbindelse måste valjas.","Fel!", ERROR_MESSAGE);
      return;
    }

    Edge<Stad> selectedEdge = (Edge) fvf.visaFörbLista.getSelectedValue();
    FormÄndraförbindelse faf = new FormÄndraförbindelse();
    af.setförbNamn(selectedEdge.getNamn());

    for(;;) {
      try {
        int svar2 = showConfirmDialog(mainMethod.this, faf, "Ändra Förbindelse", OK_CANCEL_OPTION);
        if (svar2 != YES_OPTION) return;
        selectedEdge.setVikt(faf.getförbTid());
        List<Edge<Stad>> edges = lg.getEdgesBetween(sB, sA);
        for (Edge<Stad> edge : edges) {
          if (edge.getNamn()==selectedEdge.getNamn()) {
            edge.setVikt(faf.getförbTid());
          }
        }
        return;
      } catch(NumberFormatException e) {
        showMessageDialog(mainMethod.this, "Ogiltig inmatning.","Fel!", ERROR_MESSAGE);
      }
      // etc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T09:36:50.307

当然，您不能从 Stad 转换为 Edge。想一想：你的`fvf.visaFörbLista.getSelectedValue()`回报是一个 Stad。没有办法将 Stad 转换为 Edge，因为它们是完全不同的东西。（例如，一个是通用的，另一个不是）。

你想导航到现有的 Edge 然后确保 Stad 有一个 Edge 列表，然后调用适当的 getter。例如。：`fvf.visaFörbLista.getSelectedValue().getEdgeList().getSomeEdge()`

如果您无法从 Stad 导航（调用 getter）到其 Edges，那么您应该获取所有边缘的列表（您的 lg 变量似乎有它们），然后选择您需要的边缘。

**简短版本：您正在获得一个城市并试图将其转换为边缘，这是不可能的，因为城市与边缘根本不同（例如，边缘应该连接两个城市）。不要尝试将其转换为边缘，尝试获取所需的边缘。**

ps：如果您只需要边缘的城市名称，那么绝对不需要强制转换（转换）只需获取城市名称就可以了

# facebook - 是否可以使用 Graph API 来同步 FB Group <--> External Site 上的帖子

> ID：12308494
> 
> 赞同：2
> 
> 时间：2012-09-06T21:13:16.737
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-group

只是浏览API，我对此有点不清楚。我需要挖掘更多才能弄清楚，但我想知道那里是否有其他人这样做过。似乎 Facebook 群组模仿公告板，但更强大。我希望至少能够同步评论和导入群组帖子，也许是在主题 >> FACEBOOK 帖子下。[对于濒临死亡的公告板世界来说，搭载 Facebook 同步将是一个巨大的胜利，这样人们就可以在 FB 组中发帖并让其他人在Facebook 实时更新 API](https://developers.facebook.com/docs/reference/api/realtime/)的某种实现中接收通知 . 从 Facebook 页面导入新帖子，以便新用户或不在 Facebook 上的用户也可以参与讨论。困难的部分当然是同步各自的帖子 ID 和他们在论坛 <--> Facebook 上的评论。

这是否已经完成，更重要的是是否允许？它是否违反 Facebook 条款和条件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:27:06.757

看起来我的询问和这个很相似

[从 facebook 页面墙或群组墙获取数据以在个人网站上使用](http://facebook.stackoverflow.com/questions/3417868/get-data-from-a-facebook-page-wall-or-group-wall-for-use-on-personal-website)

以防万一我没有得到更好的答案，而其他人发现了这个问题......

# dart - Dart - 可拖动的图像

> ID：12308496
> 
> 赞同：2
> 
> 时间：2012-09-06T21:13:23.850
> 
> 标签：dart

我正在尝试在 Dart 中获取可拖动的图像。虽然设置我的图像的可拖动布尔值不起作用。

```
image = new ImageElement();
image.src = ImageSourceByName(name);
image.on.load.add((event) {Context.drawImage(image, 10, 10, CARD_SMALL_WIDTH, CARD_SMALL_HEIGHT);});
image.draggable = true; 
```

（注意：上下文是我从 Canvas 获得的 2D 上下文。）

绘图效果很好，我可以看到我的卡片，虽然我不能拖动它。我对 Dart 很陌生，所以这可能很明显，尽管我找不到任何解释它的教程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:42:37.080

您正在使用 ImageElement 作为在 CanvasElement 上绘制内容的源。
一旦像素在画布上（通过drawImage（）），您的图像数据就不是HTMLElement，而是像素:)

然而`draggable`，attr 是 HTMLElement 的一个属性。如果将图像添加到文档中，您会注意到您可以研究 的行为`draggable`，如下所示： `document.body.nodes.add(image);`

如果你“只”想要有可拖动的图像，你可以从那里拿它，也许看看[http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html](http://www.whatwg.org/specs/web-apps/current-work/multipage/dnd.html) 否则，如果你希望画布上的东西可以拖动，这是一个不同的（更复杂的？）故事。

# mysql - 通过html表单将图像插入数据库

> ID：12308502
> 
> 赞同：0
> 
> 时间：2012-09-06T21:13:39.040
> 
> 标签：mysql, jsp, java-ee-6

`<input type="file" name="file" />`我想通过这个 Servlet使用 HTML 表单将图像插入 MySQL ，所以我使用这个代码。

```
if (!isMultipart) {
    System.out.println("File Not Uploaded");
} else {
    FileItemFactory factory = new DiskFileItemFactory();
    ServletFileUpload upload = new ServletFileUpload(factory);
    List items = null;

    try {
        items = upload.parseRequest(request);
        System.out.println("items: "+items);
    } catch (FileUploadException e) {
        e.printStackTrace();
    }

    Iterator itr = items.iterator();

    while (itr.hasNext()) {
        FileItem item = (FileItem) itr.next();

        if (item.isFormField()){
            String name = item.getFieldName();
            System.out.println("name: "+name);
            String value = item.getString();
            System.out.println("value: "+value);
        } else {
            try {
                String itemName = item.getName();
                Random generator = new Random();
                int r = Math.abs(generator.nextInt());

                String reg = "[.*]";
                String replacingtext = "";
                System.out.println("Text before replacing is:-" + itemName);
                Pattern pattern = Pattern.compile(reg);
                Matcher matcher = pattern.matcher(itemName);
                StringBuffer buffer = new StringBuffer();

                while (matcher.find()) {
                    matcher.appendReplacement(buffer, replacingtext);
                }

                int IndexOf = itemName.indexOf("."); 
                String domainName = itemName.substring(IndexOf);
                System.out.println("domainName: "+domainName);

                String finalimage = buffer.toString()+"_" + r + domainName;
                System.out.println("Final Image===" + finalimage);

                File savedFile = new File("/home/abdo/NetBeansProjects/Gestion_des_taches/web/"+"img/"+finalimage);
                item.write(savedFile);
                out.println("<html>");
                out.println("<body>");
                out.println("<table><tr><td>");
                out.println("<img src=images/" + finalimage + ">");
                out.println("</td></tr></table>");

                Connection conn = null;
                String url = "jdbc:mysql://localhost/";
                String dbName = "actors";
                String driver = "com.mysql.jdbc.Driver";
                String username = "root"; 
                String userPassword = "root";
                String strQuery = null;
                String strQuery1 = null;
                String imgLen="";

                try {
                    System.out.println("itemName::::: "+itemName);
                    Class.forName(driver).newInstance();
                    conn = DriverManager.getConnection(url+dbName,username,userPassword);
                    Statement st = conn.createStatement();
                    strQuery = "insert into pictures set image='" + finalimage + "'"; 
                    int rs = st.executeUpdate(strQuery);
                    System.out.println("Query Executed Successfully++++++++++++++");
                    out.println("image inserted successfully");
                    out.println("</body>");
                    out.println("</html>");                     
                } catch (Exception e) {
                    System.out.println(e.getMessage());
                } finally {
                    conn.close();
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
} 
```

当我使用

```
out.println("<img src=images/" + finalimage + ">"); 
```

它工作正常。我的问题是如何通过 MySQL 请求显示图像`select image from pictures;`？

这是`pictures`表的输出：

```
mysql> select * from pictures;

+----+----------------------+ 
| id | image                |
+----+----------------------+
| 42 | Photo_1339972050.jpg |
| 43 | Photo_168423959.jpg  |
| 44 | Photo_859939969.jpg  |
| 45 | Photo_1696305644.jpg |
| 46 | Photo_910632756.jpg  |
| 47 | Photo_560808853.jpg  |
+----+----------------------+
6 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:35:21.197

您将需要一个额外的 servlet 来下载实际的图像数据。检查 BalusC 的[FileServlet](http://balusc.blogspot.de/2009/02/fileservlet-supporting-resume-and.html)。

# .net - 在不使用另一个线程的 Invoke/BeginInvoke 的情况下读取表单控件值（但不更改它）是否线程安全

> ID：12308503
> 
> 赞同：3
> 
> 时间：2012-09-06T21:13:41.490
> 
> 标签：.net, multithreading, .net-3.5

我知道您可以在不使用 Invoke/BeginInvoke 的情况下从工作线程读取 gui 控件，因为我的应用程序现在正在执行此操作。没有抛出跨线程异常错误，并且我的 System.Timers.Timer 线程能够很好地读取 gui 控件值（不像这个人：[工作线程可以读取 GUI 中的控件吗？](https://stackoverflow.com/questions/3295870/can-a-worker-thread-read-a-control-in-the-gui)）

**问题 1：** 鉴于线程的基本规则，我应该使用 Invoke/BeginInvoke 来读取表单控制值吗？这是否使它更加线程安全？这个问题的背景源于我的应用程序遇到的问题。似乎随机破坏了另一个线程正在引用的表单控件。（见问题 2）

**问题 2：** 我有第二个线程需要更新表单控件值，所以我调用/BeginInvoke 来更新这些值。好吧，同一个线程需要对这些控件的引用，以便它可以更新它们。它包含这些控件的列表（比如 DataGridViewRow 对象）。有时（并非总是），DataGridViewRow 引用会“损坏”。我所说的损坏是指引用仍然有效，但某些 DataGridViewRow 属性为空（例如：row.Cells）。这是由问题 1 引起的，还是您能给我一些提示，说明为什么会发生这种情况？

这是一些代码（最后一行有问题）：

```
public partial class MyForm : Form
{
    void Timer_Elapsed(object sender)
    {
        // we're on a new thread (this function gets called every few seconds)  
        UpdateUiHelper updateUiHelper = new UpdateUiHelper(this);       

        // Is it thread-safe to step through the datagrid rows here without invoking?
        foreach (DataGridViewRow row in dataGridView1.Rows)
        {
            object[] values = GetValuesFromDb();
            updateUiHelper.UpdateRowValues(row, values[0]);
        }

        // .. do other work here

        updateUiHelper.UpdateUi();
    }
}

public class UpdateUiHelper
{
    private readonly Form _form;
    private Dictionary<DataGridViewRow, object> _rows;
    private delegate void RowDelegate(DataGridViewRow row);
    private readonly object _lockObject = new object();

    public UpdateUiHelper(Form form)
    {
        _form = form;
        _rows = new Dictionary<DataGridViewRow, object>();
    }

    public void UpdateRowValues(DataGridViewRow row, object value)
    {
        if (_rows.ContainsKey(row))
            _rows[row] = value;
        else
        {
            lock (_lockObject)
            {
                _rows.Add(row, value);
            }
        }

    }

    public void UpdateUi()
    {
        foreach (DataGridViewRow row in _rows.Keys)
        {
            SetRowValueThreadSafe(row);               
        }
    }

    private void SetRowValueThreadSafe(DataGridViewRow row)
    {
        if (_form.InvokeRequired)
        {
            _form.Invoke(new RowDelegate(SetRowValueThreadSafe), new object[] { row });
            return;
        }

        // now we're on the UI thread
        object newValue = _rows[row];
        row.Cells[0].Value = newValue; // randomly errors here with NullReferenceException, but row is never null!
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T16:14:41.417

RE 1：基本规则是必须在运行消息泵的线程上访问 Windows 控件。在 .NET 中，这是正在运行的线程`Application.Run`. 它处理消息，您对 Windows 控件所做的一切都是消息。因此，如果您从另一个线程发送消息，则处理消息的线程可能会出现竞争条件（消息泵不是线程安全的，因为这会过多地影响性能，以及其他原因）。现在，访问 .NET 类实例并不一定会导致发送消息。在这些情况下，是的，可以从不是 UI 线程的线程访问它们。没有记录什么发送和不发送消息，或者单个成员在什么情况下发送和不发送消息。因此，您只是在赌当您从非 UI 线程访问控件对象时不会发生异常。最佳做法是始终使用`InvokeRequired`/`BeginInvoke`. 其他任何事情都可能在您最不期望的时候发生变化，如果它确实失败了，那么您所做的就不受支持。

RE 2：我不能告诉你 1 是否导致了 2——确实没有足够的细节。如果您正在以不受支持的方式处理某事，那么预期会发生意想不到的事情是合理的。

如果这是一个 WinForms 应用程序，我建议使用它`Forms.Timer`。它调用`Tick`UI 线程上的处理程序，您不必理会`InvokeRequired`/`BeginInvoke`

# xslt - 如何对 xsl:copy 中的所有非选定元素执行应用模板？

> ID：12308506
> 
> 赞同：1
> 
> 时间：2012-09-06T21:13:57.463
> 
> 标签：xslt, apply-templates

假设我有以下 XSLT：

```
<xsl:template match="DTS:Executable[@DTS:ExecutableType='SSIS.Package.2' or @DTS:ExecutableType='MSDTS.Package.1']">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates select="./DTS:Property"/>
        <xsl:apply-templates select="./DTS:ConnectionManager"/>
        <xsl:apply-templates select="./DTS:Configuration"/>
        <xsl:apply-templates select="./DTS:LogProvider"/>
    </xsl:copy>
</xsl:template> 
```

我意识到如果有其他节点类型，例如 DTS:Variable，它们将从生成的 XML 中过滤掉，因为没有 apply-templates 语句选择它们。

我的问题是：如何用一个 apply-templates 语句来结束副本，该语句选择之前的 apply-templates 语句中未指定的所有元素？

我试过类似的东西：

```
 <xsl:apply-templates select="./node()[name!='DTS:Property' and name!='DTS:ConnectionManager' and name!='DTS:Configuration' and name!='LogProvider']" /> 
```

但这似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:05:43.997

您应该使用该函数`name()`，而不仅仅是`name`在您的表达式中。还要注意`./`这里是多余的，所以你可以写这个.....

```
<xsl:apply-templates select="node()[name()!='DTS:Property' and name()!='DTS:ConnectionManager' and name()!='DTS:Configuration' and name()!='LogProvider']" /> 
```

或者，编写以下内容可能会更短

```
<xsl:apply-templates select="node()[not(self::DTS:Property|self::DTS:ConnectionManager|self::DTS:Configuration|self::LogProvider)]" /> 
```

# iphone - 重命名 xib 文件后 IBAction 不起作用

> ID：12308508
> 
> 赞同：2
> 
> 时间：2012-09-06T21:14:04.250
> 
> 标签：iphone, xcode, xib, uiapplication, ios-universal-app

我有一个通用应用程序，它在同一个文件 MainWindow.xib 中包含所有视图。今天我决定将这些视图分成各自的 xib 文件（例如 MainMenuController.h、MainMenuController.m 和 MainMenuController.xib）。现在我无法接收和 IBActions。这是我一步一步做的：

1.  我创建了一个名为 MainMenuController.xib 的新 .xib 文件，并将它的 File's Owner 设置为已经存在的 MainMenuController 类。

2.  我从 MainWindow.xib 文件中复制了 MainMenuController 对应的视图，并将其粘贴到新创建的 MainMenuController.xib 中。我将文件所有者的视图设置为新粘贴的视图（在 IB 中连接）。

3.  在 info.plist 中，我删除了“主 xib 文件基本名称”的条目，因此应用程序不会自动打开 MainWindow.xib。

4.  我修改了应用程序委托以编程方式创建窗口，并使用以下代码将 MainMenuController 添加到其中：

    ```
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    mainMenuController = [[MainMenuController alloc] init];
    self.window.rootViewController = mainMenuController;
    [self.window makeKeyAndVisible];
    [mainMenuController release]; 
    ```

    “mainMenuController”和“window”是实例变量，也被声明为属性。

5.  我只有一个 AppDelegate 类和 main.m 包含：

    ```
    int main(int argc, char *argv[])
    {
      @autoreleasepool {
      return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    }} 
    ```

现在，当应用程序打开时，我看到 MainMenuController 的视图出现了。此时，我开始在新的 xib 文件中的粘贴视图中连接 IBOutlets 和 IBActions。尽管我在 File's Owner 中看到了 IBOutlets 并正确连接了它们，但是当我按下按钮时，IBAction 的函数从未被调用。

我想到的可能错误：（1）应用程序窗口设置不正确，它没有传递事件，（2）复制视图时有东西卡住或丢失，仍然指向旧所有者（3）卡住了错误xcode 项目

你认为问题可能是什么？是上述之一吗？我该如何解决这个问题？任何帮助表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:30:34.217

Your creation of the main view controller:

```
mainMenuController = [[MainMenuController alloc] init]; 
```

makes no reference to the XIB. So you're doing a purely programmatic creation with no reference to whatever may or may not be in the XIB. Hence your view controller appears to work but none of the outlets or actions are wired up. You may be making reference elsewhere, but I guess not appropriately.

Probably you want:

```
mainMenuController = [[MainMenuController alloc] 
                              initWithNibName:@"MainMenuController" bundle:nil]; 
```

That'll explicitly use whatever is in the XIB to create the controller.

# c# - 写入TextWriter时如何输出字节顺序标记？

> ID：12308509
> 
> 赞同：8
> 
> 时间：2012-09-06T21:14:08.557
> 
> 标签：c#, encoding, utf-8, utf-16, textwriter

我正在向`TextWriter`. 我希望 UTF-16 字节顺序标记 ( `BOM`) 出现在输出中：

```
public void ProcessRequest(HttpContext context)
{
   context.Response.ContentEncoding = new UnicodeEncoding(true, true);
   WriteStuffToTextWriter(context.Response.Output);
} 
```

除了输出不包含字节顺序标记：

```
HTTP/1.1 200 OK
Server: ASP.NET Development Server/10.0.0.0
Date: Thu, 06 Sep 2012 21:09:23 GMT
X-AspNet-Version: 4.0.30319
Content-Disposition: attachment; filename="Transactions_Calendar_20120906.csv"
Cache-Control: private
Content-Type: text/csv; filename="Transactions_Calendar_20120906.csv"; charset=utf-16BE
Content-Length: 95022
Connection: Close

JobName,ShiftName,6////09////2012 12::::00::::00 АΜ,... 
```

我如何告诉 a`TextWriter`编写编码标记？

**注意**：[第二个参数`UnicodeEncoding`](http://msdn.microsoft.com/en-us/library/984ebfcy.aspx)：

```
 context.Response.ContentEncoding = new UnicodeEncoding(true, true); 
```

> **byteOrderMark**
> 类型：**true**指定提供 Unicode 字节顺序标记；否则，**false**。[`System.Boolean`](http://msdn.microsoft.com/en-us/library/system.boolean.aspx)

 ***** * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-27T22:57:54.747

## 简洁版本

```
String zwnbsp = "\xfeff"; //Zero-width non-breaking space

//The Zero-width non-breaking space character ***is*** the Byte-Order-Mark (BOM).
String s = zwnbsp+"The quick brown fox jumped over the lazy dog.";
writer.Write(s); 
```

## 长版

在某些时候，我意识到解决方案是多么简单。

我**曾经**认为 Unicode Byte-Order-Mark 是一些特殊的签名。我曾经认为我必须仔细决定要输出哪个字节序列，才能输出正确的 BOM：

*   0xFE 0xFF
*   0xFF 0xFE
*   0xEF 0xBB 0xBF

但从那时起，我意识到字节 Byte-Order-Mark**不是**您必须添加到文件中的特殊字节序列。

BOM 只是一个**Unicode 字符**。您不输出任何字节；你只输出字符`U+FEFF`。编写该字符的*行为*本身，序列化程序会将其转换为您**为**您使用的任何编码。

选择字符`U+feff`( `ZERO WIDTH NO-BREAK SPACE`) 是有充分理由的。它是一个**空格**，所以它没有任何意义，它是**零宽度**，所以你甚至不应该看到它。

这意味着我的问题从根本上是有缺陷的。没有*“编写字节顺序标记”之*类的东西。您只需确保您写出的第一个字符是`U+FEFF`. 就我而言，我正在写信给`TextWriter`：

```
void WriteStuffToTextWriter(TextWriter writer)
{
   String csvExport = GetExportAsCSV();

   writer.Write("\xfeff"); //Output unicode charcter U+FEFF as a byte order marker
   writer.Write(csvExport);
} 
```

`TextWriter`它将处理将 unicode 字符`U+feff`转换为已配置为使用的任何字节编码。

> **注意**：任何代码都会发布到公共领域。无需归属。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:19:44.760

写出 context.Response.ContentEncoding.GetPreamble()。看看[写没有字节顺序标记（BOM）的文本文件？](https://stackoverflow.com/questions/2437666/write-text-files-without-byte-order-mark-bom)****

# java - 将Java中的PDF作为文件读取并使“PDF”可编辑

> ID：12308513
> 
> 赞同：1
> 
> 时间：2012-09-06T21:14:25.493
> 
> 标签：java, pdf

我有一个程序将用于构建问题数据库。我正在为一个希望用户知道 contet 是从该站点下载的站点制作它。这就是为什么我希望输出为 PDF - 几乎每个人都可以查看它，几乎没有人可以编辑它（并删除例如页脚或水印，这与某些更简单的文件类型不同）。这就解释了为什么它**必须**是 PDF。

该程序将被众多用户使用，他们将创建新数据库或扩展现有数据库。这就是为什么将输出形成为多个文件是实现我想要实现的目标的极其草率和低效的方式（这会使用户的事情变得复杂）。

我想要做的是创建 PDF 文件，一旦创建，这些文件仍然可以用我的程序进行编辑。

我想通过将我的程序可读的自定义文件类型实现到输出 PDF 中来实现这一点。

我想出了三种方法：

1.  将文件附加到 PDF，然后破坏包含它的 PDF 部分，这只会使 PDF 不知道它包含该文件，从而使用户无法（轻松地）注意到它。阅读文档后，我将使用可能的 PDF 库之一恢复损坏并提取文件。

2.  将文件隐藏在图像中，该图像将被添加到 PDF 的第一页或最后一页的某个位置，以某种方式（仍然需要解决）隐藏在公众视线之外。知道它的位置，使用 PDF 库检索它应该很容易。

3.  我了解到，如果您在 PDF 中的第一个字符中添加“%”符号，则 PDF 阅读器（至少 Adob​​e 阅读器）将忽略整行（类似于 Java 中的“//”），从而使我可以在 PDF 中添加尽可能多的行（如果我知道在哪里，我会这样做），而最终用户并不知道这一点。我可以通过这种方式将我的整个自定义文件实现为 PDF。这里的问题是我实际上必须使用 Java 的输入阅读器之一阅读 PDF，但我不确定是哪一个。我知道 PDF 不能像文本文件一样读取，因为它是二进制文件（对吗？）。

最后，我决定采用方法3。除非有人有更好的想法，而且条件是：1。只有一个文件。该文件是PDF。2.用户必须不知道添加。

问题是我不知道如何将 PDF 作为文件读取（我不想将其作为 PDF 读取，我会使用 PDF 库来读取）。

1.  那么，有人有更好的主意吗？
2.  如果不是，我如何将 PDF 读取为**FILE**，因此输出是字符数组（带有换行符检测），然后用我的内容添加重写整个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:08:17.537

在 Java 中，文本文件和二进制文件之间没有真正的区别，您可以将它们都作为输入流来读取。不同之处在于，对于二进制文件，您不能真正为它创建 Reader，因为这假设有一种方法可以将字节流转换为 unicode 字符，而这不适用于 PDF 文件。

因此，在您的情况下，您需要读取字节缓冲区中的文件，并可能遍历它们以扫描表示 PDF 中的“%”和行尾字符的字节。

更好的方法是使用另一种在 PDF 中编码数据的现有方法：XMP 标签。这允许任何类型的复杂键值对以 XML 编码并嵌入 PDF、JPEG 等。请参阅[http://partners.adobe.com/public/developer/en/xmp/sdk/XMPspecification.pdf](http://partners.adobe.com/public/developer/en/xmp/sdk/XMPspecification.pdf)。

Java 中有一个开源库，可以让您对其进行操作：http: [//pdfbox.apache.org/userguide/metadata.html](http://pdfbox.apache.org/userguide/metadata.html)。另请参阅另一个成功的人提出的相关问题：[自定义模式到 XMP 元数据](https://stackoverflow.com/questions/7965599/custom-schema-to-xmp-metadata)或[http://plindenbaum.blogspot.co.uk/2010/07/pdfbox-insertextract-metadata-frominto.html](http://plindenbaum.blogspot.co.uk/2010/07/pdfbox-insertextract-metadata-frominto.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T05:04:22.423

这只是 1 和 0 - 只需使用 RandomAccessFile 并开始阅读。PDF 规范定义了有效的换行符是什么（有几个）。拿起一个十六进制编辑器并打开一个 PDF，您至少可以开始对事物有所了解。但请注意插入行的位置 - 您需要将它们添加到文件末尾，它们不会将外部参照表偏移量与 obj 条目搞砸。

这是一个可能感兴趣的相关问题：[PDF parsing file trailer](https://stackoverflow.com/questions/2898669/pdf-parsing-file-trailer)

我建议将您的评论放在 startxref 行之前。如果你把它放在其他任何地方，你最终可能会四处移动并破坏外部参照表指针。

因此，插入您的特殊评论的简单算法将是：

转到文件末尾 向后搜索 startxref 在 startxref 之前插入您的特殊注释 - 确保在您的特殊注释末尾插入换行符 保存 PDF

您可以（并且应该）在十六进制编辑器中手动执行此操作。

非常重要：您的用户是否会保存对这些文件的更改？即，如果他们填写表单字段，他们会点击保存吗？如果是这样，您的注释行可能会在保存期间被删除（并且不同 PDF 查看器的不同版本在这方面的行为可能不同）。

XMP 标记是执行您想要做的事情的正确方法——您可以嵌入整个 XML 段，而且我认为您很难想出一个无法表示为 XML 的数据结构。

我个人建议为此使用 iText，但我有偏见（我是开发人员之一）。iText In Action 这本书有一个关于将 XMP 数据嵌入 PDF 的精彩章节。这是书中的一些示例代码（我绝对推荐）：http: [//itextpdf.com/examples/iia.php ?id=217](http://itextpdf.com/examples/iia.php?id=217)

# php - php中其他变量生成数组变量名后输出数组元素

> ID：12308514
> 
> 赞同：0
> 
> 时间：2012-09-06T21:14:25.883
> 
> 标签：php, arrays, variables, echo

我有一段时间不做php了，现在我决定做一个小脚本，但我遇到了一个以前遇到过的问题，我自己设法解决了，但现在我做不到。

假设我有'n'这样的数组......

```
$numbers1=array('32','16','29','41','36');
$numbers2=array('13','50','47','7','39');
$numbers3=array('3','4','29','35','31'); 
```

然后我想使用'for循环'来生成数组名称并输出数组的某些元素和/或整个数组本身，就像这样......

```
for($count1=1;$count1<=3;$count1++)
{
    $num1='numbers'.$count1;
    print_r($$num1); //this outputs what's inside all arrays as expected
    echo $$num1[0];
} 
```

“echo $num1[0]”是问题所在，它只是为了说明我想从所有数组的元素 0 中“回显”内容，获得以下输出“32133”。

很久以前，当我开始使用 php 时，我在 stackoverflow 上提出了一个类似的问题，但该问题的答案不适用于这种情况，而且我在 stackoverflow 上搜索和搜索的 2 小时都没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:19:18.467

你需要使用`{}`，所以 PHP 知道如何解释你的变量。

```
${$num1}[0] 
```

试试看。那应该按照您想要的方式工作。

`$$num1[0]`被解释为`${$num1[0]}`（所以 PHP 正在寻找`$n`）。

演示：[http ://codepad.org/yn1JUG5U](http://codepad.org/yn1JUG5U)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:23:08.010

你可以像这样迭代，但我不推荐它。您需要重新考虑您的阵列设置。

```
<?php
$numbers1=array('32','16','29','41','36');
$numbers2=array('13','50','47','7','39');
$numbers3=array('3','4','29','35','31');

for( $i=1; $i<=3; $i++ )
{
    $array = 'numbers'.$i;

    foreach( $$array as $v )
    {
        echo $v .' ';
    }

    echo "\n";
}
?> 
```

输出：

> 32 16 29 41 36
> 
> 13 50 47 7 39
> 
> 3 4 29 35 31

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:18:56.570

您必须插入如下内容：

```
$my_array = $$num1;
echo $my_array[0]; 
```

**编辑：**去找@Rocket 的答案——稍微干净一点。

# asp.net - Asp.net Css Gridview 样式

> ID：12308521
> 
> 赞同：0
> 
> 时间：2012-09-06T21:14:59.243
> 
> 标签：asp.net, css

我有一个 asp.net 网格视图。我已经使用阴影将样式应用于主标题栏。这在 IE9 中运行良好，但它不使用 Chrome 中的阴影。我在我的 web 应用程序中对 div 等使用完全相同的阴影，Chrome 和 IE9 都可以正常工作。那么为什么 Chrome 不喜欢我的 CSS 呢？（特别是 .mGrid 中的 3 条阴影线如下所示）

谢谢达摩

**HTML 代码**

```
<asp:GridView ID="GridViewMain" OnRowDataBound="RowDataBound" OnPageIndexChanging="gridView_PageIndexChanging"
                                        runat="server"  AllowPaging="True" PageSize="50" PagerSettings-Position="TopAndBottom"
                                        CssClass="mGrid"
                                        PagerStyle-CssClass="pgr"
                                        AlternatingRowStyle-CssClass="alt"
                                        >
                                     </asp:GridView> 
```

**CSS**

```
/* Grids */

.mGrid { width: 100%; background-color: #fff; margin: 5px 0 10px 0; border: solid 1px #525252; border-collapse:collapse;font-family:Verdana; font-size:12px; }

.mGrid td { padding: 2px; border: solid 1px #c1c1c1; color: #003366; }

.mGrid th { padding: 4px 2px; color: #000000; 
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#99CCFF'); /* for IE */
            background: -webkit-gradient(linear, left top, left bottom, from(#FFF), to(#9CF)); /* for webkit browsers */
            background: -moz-linear-gradient(top,  #FFF,  #9CF); /* for firefox 3.6+ */
            background: #99CCFF; font-size: 0.9em;border: solid 2px #c1c1c1;         
          }

.mGrid .alt { background: #fcfcfc; }

.mGrid .pgr {background: #FFFFFF; }

.mGrid .pgr table { margin: 5px 0; }

.mGrid .pgr td { border-width: 0px; padding: 0 6px; border-left: solid 1px #666; font-weight: bold; color: #fff; line-height: 12px; }  

.mGrid .pgr a { color: #666; text-decoration: none; }

.mGrid .pgr a:hover { color: #000; text-decoration: none; }

.mGrid tr:hover{background-color:#FFFFCC;color:white;}

/* End Grids */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T05:55:16.233

你可以使用以下样式，

```
 /***** data table ******/
.dataTable{ display:table; margin:0px 0px 3px 0px; padding:0px; border: none;  border-spacing:0px; font-size:100%;   }
.noPad{ padding:0px !important; margin:0px !important;}
.dataTable tr.altRow td{ background:#EAEAEA ;}
.dataTable tr.selRow td{ background:#FFFFCC ;}
.dataTable td.middleAlign{ padding:11px !important; }
.dataTable tr.totalRow td{ background:#999999 !important;}
.dataTable th{ background: url('/_layouts/ABFSG/MF/Images/tableHdr_bg.png') left top repeat-x; margin:0px; font-size:12px; color:#000;  border-top:0px solid #D7BB00; vertical-align:middle !important; }
.dataTable th, td{ display:table-cell; padding:5px 5px 5px 7px; border:0px solid #cecece; vertical-align:middle;text-align:left; font-weight:normal;}
.dataTable td.subRow { border-top:1px solid #D7BB00;background: url('/_layouts/ABFSG/MF/Images/subRowHeader.png') left top repeat-x; height:17px; padding:2px !important; padding-left:7px !important; }
.dataTable tr.singleRow td{ padding:0px 5px 3px 5px !important;}
.withBorder td{ border:1px solid #EAEAEA;}
.dataTable td.gray{ background-color:#818181;}
.dataTable td.noPadDiv{ padding:0px !important; margin:0px !important;}
.dataTable td.vtop{  vertical-align:top;}

.sec_dataTable{display:table; margin:0px 0px 3px 0px; padding:0px; border: none;  border-spacing:0px; font-size:100%;}
.sec_dataTable tr th{background:#FFFAEA ; margin:0px; font-size:11px; color:#000;  display:table-cell; padding:5px 5px 5px 7px; border:1px solid #DDDDDD; vertical-align:middle; text-align:left; font-weight:normal;}
.sec_dataTable tr td{ display:table-cell; padding:5px 5px 5px 7px; border:1px solid #DDDDDD; vertical-align:middle; text-align:left; font-weight:normal;}
.sec_dataTable tr.altRow td{ background:#EAEAEA !important;}

.dataTableBrd{display:table; margin:0px 0px 3px 0px; padding:0px; border: none;  border-spacing:0px; font-size:100%;}
.dataTableBrd tr th{ background: url('/_layouts/ABFSG/MF/Images/tableHdr_bg.png') left top repeat-x;border:1px solid #EBBA05; margin:0px; font-size:11px; color:#000;padding:5px 5px 5px 7px;  border-top:0px solid #D7BB00; vertical-align:middle !important; font-weight:normal;}
.dataTableBrd tr td{ display:table-cell; padding:5px 5px 5px 7px; border:1px solid #DDDDDD; vertical-align:middle; text-align:left; font-weight:normal;}
.dataTableBrd tr.altRow td{ background:#EAEAEA !important;}

.globalNav{background:url(/_layouts/ABFSG/MF/Images/globalNav_bg.png) left top repeat-x; margin:0px; padding:0px; height:22px; float:left;}
.globalNav ul{ margin:0px; padding:0px; list-style:none;}
.globalNav li{ float:left;}
.globalNav li a{ display:block; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#000; margin:0px; padding:4px 10px 4px 10px;}
.globalNav li.sep{ display:block; background:url('/_layouts/ABFSG/MF/Images/globalNav_sep.png') left top no-repeat; width:1px; height:22px;}
.globalNav li.sel a{ display:block; background:url(/_layouts/ABFSG/MF/Images/globalNav_selbg.png) top left repeat-x; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#FECB02;}
.globalNav li.sel a:hover{ cursor:default;}
.globalNav li.first{ float:left; background:url(/_layouts/ABFSG/MF/Images/globalNav_unselFirL.png) left top no-repeat; margin:0px; padding:0px;}
.globalNav li.first a{ display:block; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#000; margin:0px; padding:4px 10px 4px 10px;}
.globalNav li.firstsel{ float:left; background:url(/_layouts/ABFSG/MF/Images/globalNav_selFirL.png) left top no-repeat; margin:0px; padding:0px;}
.globalNav li.firstsel a{ display:block; background:url(/_layouts/ABFSG/MF/Images/globalNav_selbg.png) top left repeat-x; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#FECB02; margin:0px 0px 0px 5px; padding:4px 10px 4px 5px;}
.globalNav li.firstsel a:hover{ cursor:default;}
.globalNav li.last{ float:left; background:url(/_layouts/ABFSG/MF/Images/globalNav_unselLastL.png) right top no-repeat; margin:0px; padding:0px;}
.globalNav li.last a{ display:block; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#000; margin:0px; padding:4px 10px 4px 10px;}
.globalNav li.lastsel{ float:left; background:url(/_layouts/ABFSG/MF/Images/globalNav_selLastL.png) right top no-repeat; margin:0px; padding:0px;}
.globalNav li.lastsel a{ display:block; background:url(/_layouts/ABFSG/MF/Images/globalNav_selbg.png) top left repeat-x; font-family: Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#FECB02; margin:0px 4px 0px 0px; padding:4px 5px 4px 10px;}
.globalNav li.lastsel a:hover{ cursor:default;}

.grayNav ul{ margin:0px; padding:0px;}
.grayNav li{ float:left; list-style:none;}
.grayNav li a{ display:block; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#6c7f85; margin:0px; padding:0px 2px; }
.grayNav li.sel a{ display:block; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:11px; color:#000; margin:0px; padding:0px 2px; }
.grayNav li.sel a:hover{ cursor:default; }
.grayNav li.sep{ color:#C8C8C8; font-weight:bold; margin:0 7px 0 7px;}

.header h1{ font-size:15px; color:#000; font-weight:bold; float:left;}
.btnSearchTopPad{ margin-top:0px; *margin-top:1px;}

.arrowPlace{position:absolute; margin-top:-7px;}
.solutionTxt{ padding:5px 0px; width:100%;width:97%\9; text-align:center; color:#000!important; float:left;}
.blkLinkText{ padding:5px 0px; width:100%;width:97%\9; color:#000!important; float:left;}
.largeFont{ font-size:15px; font-weight:bold;}
/*.pagination_bg{background:#D0D0D0; float:left; -moz-border-radius: 3px;-webkit-border-radius: 3px;}*/
.pagination_sel{ padding:2px 5px; float:left;}
.pagination_sel a{  cursor:default;}
.pagination_unsel{ padding:2px 5px; float:left;}

.testimonialBox{ background: #fff url(/_layouts/ABFSG/MF/Images/header_boxBG.png) bottom left repeat-x;}
.testimonialBoxShadow{ background: #fff url(/_layouts/ABFSG/MF/Images/header_boxSDO.png) center no-repeat; height: 10px;}

.testimonial{ position:relative; border:1px solid #9F9F9F; padding:0px!important; float:left; border-left:none; border-top:none; border-bottom:none;}
.testimonialCont{position:absolute; height: 18px; width: 18px; background-position: -47px 0px;}
.testimonial .bdrT{ background:url('/_layouts/ABFSG/MF/Images/testmonial_Top.png') left top repeat-x; margin-left:25px; padding:3px 0 0 0; font-size:3px;}
.testimonial .bdrB{ background:url('/_layouts/ABFSG/MF/Images/testmonial_Top.png') left top repeat-x;  margin-left:25px; padding:0 0 3px 0; height:1px; }
.testimonial .bdrL{background: url("/_layouts/ABFSG/MF/Images/testmonial_Aro.png") no-repeat scroll left center transparent; margin: 0;padding: 0 0 0 22px;}
.tmTL{top: -2px; left:19px; clip: rect(auto 8px 8px auto);}
.tmTR{top: -2px; right: -5px; clip: rect(auto auto 8px 8px); float: right;}
.tmBL{bottom: -1px;left: 19px; clip: rect(8px 8px auto auto); }
.tmBR{bottom: -1px;right: -5px;clip: rect(8px auto auto 8px); }

.os_banner1{ margin-left:-10px; padding:103px 0px 4px 0px; background:url(/_layouts/ABFSG/MF/Images/our_solutions_banner1.png) left top no-repeat; width:454px; height:115px;}
.os_banner2{ margin:-4px 0px 0px -10px; padding:103px 0px 4px 0px; background:url(/_layouts/ABFSG/MF/Images/ourSolutions_banner2.jpg) left top no-repeat; width:452; height:111px; width: 456px;}

.os_banner_grp{ margin:-4px 0px 0px -10px; padding:103px 0px 0px 0px; background:url(/_layouts/ABFSG/MF/Images/group_oursolutions.png) left top no-repeat; width:452; height:115px; width: 456px;}
.banner1Cont{ margin:-70px 0 0 250px;}
.banner2Cont{ margin:-80px 0 0 205px;}
h1.privaFont{font-size:16px; color:#000; font-family:PrivaThreeItalicPro,Verdana, Arial; letter-spacing:-1px;}
.os_bannerBG{ background: url(/_layouts/ABFSG/MF/Images/our_solutions_bg.png) top left repeat-x; padding:7px; height:92px; width:442px;}

.headerBox_smallShadow{ background: #fff url(/_layouts/ABFSG/MF/Images/header_box_smallSDO.png) center top no-repeat; height:6px; padding:0px; margin:0px; float:left;}

#wealth_layer,#fundsLayer,#orgFundsLayer,#rollOver1,#rollOver2,#wealthPro_layer,#adityaB_layer,#mutual_layer,#Purchase_step1,#equity,#funds{padding-top:10px;   position:absolute; display:none; z-index:10;}

.portlet_01 .bdrRt{background-image:url(/_layouts/ABFSG/MF/Images/purple_dropdwn_right.png);background-position:right 5px; background-repeat:no-repeat; margin-bottom:0px;}
.portlet_01 .bdrLt{background-image:url(/_layouts/ABFSG/MF/Images/purple_dropdwn_left.png);background-position:left 5px; background-repeat:no-repeat; margin-bottom:0px;}

.borderBottHeader{ border-bottom:1px solid #D6D6D6; width:449px; margin-left:3px; margin-top:-0px; *margin-top:-10px;}

.moverArr{background-image:url(/_layouts/ABFSG/MF/Images/solutionSelArr.png); background-position:absolute;  height:9px;                width:113px;  margin-top:-8px; *margin-top:-8px; margin-left:5px; z-index:99;}

#breadCrumbs a{ font-weight:bold;}
.star_icon{width:16px; height:15px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-34px -113px; background-repeat:no-repeat; padding:0px;}
.ratingFull_icon{width:10px; height:11px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-54px -113px; background-repeat:no-repeat; padding:0px;}
.ratingHalf_icon{width:9px; height:11px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-67px -113px; background-repeat:no-repeat; padding:0px;}
.returns_icon{width:17px; height:15px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-81px -116px; background-repeat:no-repeat; padding:0px;}
.risk_icon{width:18px; height:17px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-101px -116px; background-repeat:no-repeat; padding:0px;}
.liquidity_icon{width:16px; height:18px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-122px -116px; background-repeat:no-repeat; padding:0px;}
.investment_icon{width:16px; height:17px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-143px -116px; background-repeat:no-repeat; padding:0px;}
.awards_icon{width:15px; height:20px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-167px -113px; background-repeat:no-repeat; padding:0px;}
.vr_icon{width:12px; height:10px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-189px -118px; background-repeat:no-repeat; padding:0px;}
.botBrdr{ border-top:1px solid #FFDD00; height:0px; border-bottom:1px solid #FFF; margin:0 0px 0 -10px; padding-right:20px;}

.lightYellowBox{border: 1px solid #F6E04E; position:relative; overflow:visible;background-color:#FEFCE5;background-image:none;}
.type7 .yellowBxCrnr{background-image:url(/_layouts/ABFSG/MF/Images/sprite_icon.png);}                
.yellowBxCrnr { position:absolute; height: 12px; width: 12px; background-position:-68px 0px;}
.YTL{position: absolute;left: -1px; top: -1px; clip: rect(0 6px 6px 0);}
.YTR {position: absolute;top: -1px; right: -1px; clip: rect(auto auto 6px 6px); float: right;}
.YBL {position: absolute;clip:  rect(6px 6px auto auto);left: -1px; bottom: -1px;_bottom: -3px;}
.YBR  { position: absolute; clip: rect(6px auto auto 6px);bottom: -1px;right: -1px;_bottom: -3px;}

.fundDetailsBg{ margin:0px 0px 0px 7px; padding:40px 10px 0px 350px; background:url(/_layouts/ABFSG/MF/Images/fund_details.png) left top no-repeat; width:320px; height:118px;  }
.gratuityDetailsBg{ margin:0px; padding:40px 0px 0px 350px; background:url(/_layouts/ABFSG/MF/Images/oursolutions_gratuity.png) left top no-repeat; width:330px; height:90px; font-size:20px;}

.fundDetailsMFBg{ margin:0px; padding:40px 0px 4px 340px; background:url(/_layouts/ABFSG/MF/Images/fund_details.gif) left top no-repeat; width:330px; height:138px; }

.fundDetailsCorporateBg{  margin:0px; padding:40px 0px 4px 0px; background:url(/_layouts/ABFSG/MF/Images/Corporatefunddetailsoverview_img.jpg) left top no-repeat; width:670px; height:145px;}
.shadowSep{background:url(/_layouts/ABFSG/MF/Images/shadowSep.png) left top no-repeat; width:680px; height:9px;}
.marginNeg{margin-left:-5px; margin-right:-2px;}

div.greyTab{background:url('/_layouts/ABFSG/MF/Images/button_sprite.png') left no-repeat;overflow: hidden;         height: 24px;padding-left: 10px;margin-right: 0px;           float:left;             background-position:0px -124px; z-index:1000; }
a:hover.greyTab{text-decoration:none}
a.greyTab { display:block; background:url('/_layouts/ABFSG/MF/Images/button_sprite.png') right no-repeat ;   padding: 5px 23px 5px 5px;            margin-right: 0px;height: 24px;  float:left;             color: #000;         background-position: right -124px;}

#contentBox{ position:absolute; left:264px; left:260px\9; top:256px; float:left; z-index:1001;}
#searchNAVBox{ position:relative;  float:left;}

.borderBottom{ border-bottom:1px solid #acacaa; margin-left:3px; margin-top:-0px; *margin-top:-10px; padding-bottom:10px;}
.greyBox{ background-color:#EAEAEA; border-top:1px solid #acacaa; border-bottom:1px solid #acacaa; padding:10px; margin-left:-10px; padding-left:10px;width:671px;}
.whtBox{ background-color:#fff; padding:10px; margin-left:-10px; padding-left:10px; width:671px;}
.whiteBox_01{padding-bottom:10px; margin-left:-10px; padding-left:10px; background:#ffffff;}

#curtain{ width:100%; height:100%; position: absolute; z-index:995 !important; overflow:hidden; left:0px; top:0px; opacity:.4; filter: alpha(opacity=60); background-color: #000;}
.popupAlign{position:absolute; left:50%; top:20%; z-index:999 !important;}

.closeBtn{width:17px; height:17px; background-image:url('/_layouts/ABFSG/MF/Images/sprite_icon.png'); background-position:-137px 0px; background-repeat:no-repeat; padding:0px; `enter code here`margin-top:-3px; margin-right:-5px; cursor:pointer;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:19:39.180

需要放线

```
background: #99CCFF; font-size: 0.9em;border: solid 2px #c1c1c1; 
```

在应用阴影之前。如下所示。现在修复了。谢谢达摩

```
.mGrid th { padding: 4px 2px; color: #000000;
             **background: #99CCFF; font-size: 0.9em;border: solid 2px #c1c1c1;**  
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#99CCFF'); /* for IE */
            background: -webkit-gradient(linear, left top, left bottom, from(#FFF), to(#9CF)); /* for webkit browsers */
            background: -moz-linear-gradient(top,  #FFF,  #9CF); /* for firefox 3.6+ */

          } 
```

# javascript - d3 不透明度过渡闪烁最终状态

> ID：12308523
> 
> 赞同：9
> 
> 时间：2012-09-06T21:15:07.483
> 
> 标签：javascript, d3.js, transition

我有一些基本的不透明度过渡

```
emp_line.transition()
    .duration(1250)
    .attr('opacity', 1) 
```

但是，当我运行它们时，这些项目通常会闪烁到完全不透明，然后又变回无并淡入。有什么办法可以防止这些内容闪烁吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-06T23:32:41.200

测试这个，看起来你得到了闪烁`.attr('opacity')`，但没有`.style('opacity')`，所以将转换更改为`.style()`应该可以解决这个问题。

测试小提琴：http: [//jsfiddle.net/nrabinowitz/Y5uX6/](http://jsfiddle.net/nrabinowitz/Y5uX6/)

不知道为什么这应该是真的:(。

# javascript - 对象显示属性但访问它们返回未定义

> ID：12308525
> 
> 赞同：5
> 
> 时间：2012-09-06T21:15:20.743
> 
> 标签：javascript

所以我正在写一个游戏，我有一个模块可以返回当前通过 jQuery 按下的键。那里没有问题。当我尝试访问按下的键时出现问题：

```
var Keys = require('./lib/keys')

Player.prototype.update = function () {
    Keys(function (err, keydown) {
        console.log(keydown, keydown['w']);
        /* // To move a player up, for example:
          if (keydown['w']) {
            this.y += this.speed;
          }            
        */
    });
}; 
```

控制台显示按下了哪些键，但尝试访问一个键会给我一个未定义而不是真的。

```
Object    undefined
s: true
w: true
x: true
__proto__: Object 
```

有人有什么想法吗？

更新：关键模块

```
var $ = require('./jquery')

var Keys = function (callback) {
  var keydown = {};

  function keyName(event) {
    return String.fromCharCode(event.which).toLowerCase();
  }

  $(document).bind('keydown', function (event) {
    keydown[keyName(event)] = true;
    return false;
  });

  $(document).bind('keyup', function (event) {
    return false;
  });

  callback(null, keydown);
}

module.exports = Keys; 
```

/ ***** ** *** ** *** ** *** ** ***** *****更新 ***** ****** *** ** *** ** *** ** *** *** /****

 ****这是最终修复：

./lib/keys.js var $ = require('./jquery')

```
var Keys = function () {
  this.keydown = {};

  var keyName = function (event) {
    return String.fromCharCode(event.which).toLowerCase();
  }

  var self = this;
  $(document).bind('keydown', function (event) {
    self.keydown[keyName(event)] = true;
    return false;
  });

  $(document).bind('keyup', function (event) {
    self.keydown[keyName(event)] = false;
    return false;
  });
};

Keys.prototype.getKeys = function (callback) {
  callback(null, this.keydown);
}

module.exports = new Keys; 
```

./lib/player.js var Keys = require('./keys')

```
var Player = function (game, keys) {
  // stuff
}

Player.prototype.update = function() {
  var self = this;
  Keys.getKeys(function(err, keys) {
    if (keys['w']) {
      self.y -= self.speed;
    }
    if (keys['a']) {
      self.x -= self.speed;
    }
    if (keys['s']) {
      self.y += self.speed;
    }
    if (keys['d']) {
      self.x += self.speed;
    }
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:25:44.027

发生这种情况是因为其中`Keys`有异步进程。

这只是一个已知的 chrome 问题，它通过引用显示对象值。因此，您在调用*后*会立即看到对象值`console.log`

为了更清楚地看到它，打开 chrome webdev 工具并放置`debugger;`而不是`console.log`查看`keydown`对象中的实际内容。我敢打赌它只是一个空对象。

我就把它留在这里： http: [//felix-kling.de/blog/2011/08/18/inspecting-variables-in-javascript-consoles/](http://felix-kling.de/blog/2011/08/18/inspecting-variables-in-javascript-consoles/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:17:59.800

那会教我扫描代码太快。评论是正确的，这段代码没有指向当前的问题。

`this`每次输入新函数时，该变量都会重置。

```
Player.prototype.update = function () {
    var self = this;
    Keys(function (err, keydown) {
        console.log(keydown, keydown['w']);
        /* // To move a player up, for example:
          if (keydown['w']) {
            self.y += self.speed;
          }            
        */
    });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:21:03.760

我在这里没有看到任何 jQuery。您需要提供更多代码，例如 Keys 源代码。但我猜你需要使用[http://api.jquery.com/event.which/](http://api.jquery.com/event.which/)，例如，`keydown.which === 'w'`****

# c++ - 未定义的 vtable C++

> ID：12308527
> 
> 赞同：1
> 
> 时间：2012-09-06T21:15:31.207
> 
> 标签：c++, g++

```
#include <stdio.h>

class A {
public:
  virtual void print();
  A();
};

class B :public A {
public:
  void print();
  B();
};

class C :public B {
public:
  void print();
  C();
};

A::A(){
}

B::B(){
}

C::C(){
}

void B::print() {
  printf("From B\n");
}

void C::print() {
  printf("From C\n");
}

int main() {
  B* object = new C;
  object->print();

  return 0;
} 
```

当我尝试编译此 C++ 文件时，出现以下错误。想不通原因。我尝试阅读关于 SO 的类似未定义 vtable 问题。

```
/tmp/ccpOkVJb.o: In function `A::A()':
test1.cpp:(.text+0xf): undefined reference to `vtable for A'
/tmp/ccpOkVJb.o:(.rodata._ZTI1B[_ZTI1B]+0x10): undefined reference to `typeinfo for A'
collect2: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T21:16:56.223

如果`A::print()`不打算实现，请将其声明为纯：

```
class A {
public:
  virtual void print() = 0;
  A();
}; 
```

否则，执行它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:18:29.193

您声明应该有一个`A::print`实现的方法（您可能打算使其成为纯虚拟 using `= 0`），但您没有实现它。

由于第一个实现的虚方法使编译器实例化了 vtable 并且您没有在 A 中实现任何内容，因此 A 的 vtable 丢失了，导致`undefined reference to 'vtable for A'`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:18:00.113

您需要声明`A::print()`为纯虚拟，或提供实现：

```
class A {
public:
  virtual void print()=0;
  A();
}; 
```

或者

```
class A {
public:
  virtual void print() {}
  A();
}; 
```

# django - 如何在 Django 中的任何模板中捕获特定错误？

> ID：12308530
> 
> 赞同：0
> 
> 时间：2012-09-06T21:15:43.880
> 
> 标签：django, templates, exception, middleware

我想捕获我在从 base.html 调用的方法中引发的自定义异常。发生这种情况时，我需要将用户重定向到另一个页面。最好的地方在哪里？

下面是显示问题的简化代码示例

base.html：

```
{% if something %}{{ widget_provider.get_header }}{% endif %} 
```

widget_providers.py

```
class SpecificWidgetProvider(BaseWidgetProvider):
    def get_header(self):
        if self.user.is_anonimous():
            raise AuthenticationRequired()
        return third_party_api.get_top_secret_header_widget() 
```

AuthenticationRequired 异常可能由我的站点的许多部分（大多数时间在视图中）引发，我想将处理程序保留在一个地方。所以我创建了一个中间件来捕获这种类型的异常。

中间件.py

```
def process_exception(request, exception):
    if isinstance(exception, AuthenticationRequired):
        return redirect('accounts:login') 
```

但我发现基于类的视图可能会将模板渲染阶段留到以后。它们只是返回 TemplateResponse 实例，并且 Django 的请求处理程序（django.core.handlers.base 中的 get_response()）在所有中间件堆栈之外调用 response.render()。所以现在我的中间件无法捕捉到异常。也许从上下文处理器调用 get_header() 会更好，但这也无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T21:08:59.390

我通过在同一个中间件的 process_template_response() 中预取 try/except 中的数据解决了这个问题，并将错误处理移至公共私有方法。这使我可以将错误处理保持在同一个地方。

```
def process_template_response(self, request, response)
    try:
        widget_provider.get_header()
    except AuthenticationRequired:
        response = self._process_auth_required()
        # Bind render() method that just returns itself, because we must
        # return TemplateResponse or similar here.
        def render(self):
            return self
        response.render = types.MethodType(render, response)
        return response

def process_exception(self, request, exception):
    if isinstance(exception, AuthenticationRequired):
        return self._process_auth_required()

def _process_auth_required(self):
    return redirect('accounts:login') 
```

# jquery - JQuery Mobile 在 jQuery(document).on('pageinit' 中指定页面 ID

> ID：12308533
> 
> 赞同：0
> 
> 时间：2012-09-06T21:15:49.097
> 
> 标签：jquery, mobile

在我的多页 JQM 应用程序中，我遇到了多次触发事件的问题。例如：

```
 $("#Button").on("click", function (event) {

            alert("hello");

    }); 
```

这会在第一次触发一次，但在导航到其他页面或使用后退按钮后，警报弹出窗口的数量会随着链接访问次数的增加而增加。我能够通过使用来阻止这种情况

```
event.stopImmediatePropagation(); 
```

但这在我的应用程序中引起了另一个问题。怎么回事？这非常令人沮丧。为什么这在 JQM 网站上没有得到更好的记录？..无论如何。在寻找解决方案时，我在

[http://www.ardeearam.com/blog/2012/06/03/jquery-mobile-events-firing-multiple-times/](http://www.ardeearam.com/blog/2012/06/03/jquery-mobile-events-firing-multiple-times/)

它建议将 'pageinit' 事件委托给找到元素的页面 id。IE

```
jQuery(document).on('pageinit', '#page_one', function (event) { 

)}; 
```

我有一种预感，而不是为该页面的每个代码块（如文章所述）设置多个 pageinit 块，而是将 pageinit 页面 ID 设置为 html 中的第一页。我试过了，多事件问题消失了。我测试了我的应用程序以确保其他页面（我总共有六个页面）上的其他内容没有损坏并且运行良好。我的问题是：任何人都可以看到将这种方法用于 pageinit 的缺点或问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:18:07.727

发生这种情况是因为 jQuery Mobile 一次在 DOM 中保留了多个页面。您必须牢记这一点进行编码。如果具有 id 的元素`button`存在于两个不同的页面上，则其中一个元素将多次绑定事件（因为 id 必须是唯一的）

委托`pageinit`方法是推荐的方法。

# wpf - TextBlock 元素中的 WPF 失真

> ID：12308541
> 
> 赞同：0
> 
> 时间：2012-09-06T21:16:24.890
> 
> 标签：wpf, xaml, text-rendering

有关文本渲染失真的屏幕截图，请参见[http://inky.ws/g/21s](http://inky.ws/g/21s)。

我应用这种样式来获得发光效果：

```
<Style TargetType="FrameworkElement" x:Key="GlowBright"
       BasedOn="{StaticResource ToolTipBase}">
    <Setter Property="Effect">
        <Setter.Value>
            <DropShadowEffect Opacity="1" ShadowDepth="0" BlurRadius="7"
                              Color="White"/>
        </Setter.Value>
    </Setter>
</Style>

<!-- Expander headers, Group box headers, Check box headers, Labels -->
<Style TargetType="TextBlock" BasedOn="{StaticResource GlowBright}"/> 
```

不幸的是，它使某些元素渲染出现故障。当我调整窗口大小时，故障会改变或消失。那么......如何避免故障？

* * *

编辑 - 这样做：

```
<Style TargetType="TextBlock" BasedOn="{StaticResource GlowBright}">
    <Setter Property="TextOptions.TextFormattingMode" Value="Ideal"/>
    <Setter Property="TextOptions.TextHintingMode" Value="Fixed"/>
    <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
</Style> 
```

没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:11:03.893

尝试添加此附加属性**TextOptions.TextFormattingMode**。更多可以通过[MSDN找到](http://msdn.microsoft.com/en-us/library/system.windows.media.textoptions.textformattingmode.aspx)

```
<TextBox TextOptions.TextFormattingMode="Ideal" FontSize="15">HELLO WORLD</TextBox> 
```

*

## *此属性的指南*

**场景推荐模式**

**大文本 (15pt+)** =*理想 \ 显示（用户偏好）*

**转换后的文本**=*理想*

**缩放文本**=*理想*

**设计场景**=*理想*

**小文本**=*显示*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T20:00:00.707

您可能会遇到视频卡驱动程序的问题，因为 DropShadowEffect 是通过像素着色器完成的（编译成在视频卡上运行的特殊例程）。旧驱动程序在以下情况下引入视觉缺陷并不少见。使用着色器。如果这只发生在您的机器上，这可能是原因。

# javascript - Jquery从图像中删除类

> ID：12308551
> 
> 赞同：2
> 
> 时间：2012-09-06T21:17:35.623
> 
> 标签：javascript, jquery

嘿，我这里有这 3 张图片缩略图...

```
<div class="wpcart_gallery" style="text-align:center; padding-top:5px;">

<a class="thickbox cboxElement" title="DSC_0118" href="/wp-content/uploads/2012/07/DSC_0118.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/DSC_0118.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="DSC_0118" alt="DSC_0118" src="/wp-content/uploads/2012/07/DSC_0118-50x50.jpg">
</a>

<a class="thickbox cboxElement" title="P7230376" href="/wp-content/uploads/2012/07/P7230376.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/P7230376.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="P7230376" alt="P7230376" src="/wp-content/uploads/2012/07/P7230376-50x50.jpg">
</a>

<a class="thickbox cboxElement" title="P7230378" href="/wp-content/uploads/2012/07/P7230378.jpg" rel="Teardrop Druzy Amethyst Ring" rev="/wp-content/uploads/2012/07/P7230378.jpg">
<img class="attachment-gold-thumbnails colorbox-736" width="50" height="50" title="P7230378" alt="P7230378" src="/wp-content/uploads/2012/07/P7230378-50x50.jpg">
</a>
</div> 
```

我想要做的是想出一个 jquery 代码，`cboxElement`当页面加载时，它会从第一个图像中删除，如果我单击其中一个图像来删除`cboxElement`并放置`cboxElement`到没有`cboxElement`类的图像..

希望这是有道理的，我已经尝试了我提供的所有答案，但没有任何效果:(

这适用于第一部分....从第一个链接中删除 cboxElement

```
<script type="text/javascript">
    jQuery('document').ready(function($){
        $(".wpcart_gallery a:first").removeClass("cboxElement");
        $('.thickbox').click(function(){
            $('.thickbox').each(function(obj){
                if(!$(this).hasClass("cboxElement")){
                    $(this).addClass("cboxElement");
                }
            })
            $(this).removeClass("cboxElement");
        })

    });
</script> 
```

点击功能根本不起作用:(这是一个wordpress网站所以我不得不把`jQuery('document')`而不是`$('document')`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T05:40:50.717

我遇到过同样的问题....

```
jQuery('document').ready(function($){
$(".wpcart_gallery a:first").removeClass("cboxElement");
jQuery(".wpcart_gallery img").click(function($){
jQuery(".wpcart_gallery a").addClass('cboxElement');
jQuery(this).closest('a').removeClass('cboxElement');
});
}); 
```

这将工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:27:11.140

```
jQuery( function(){
    var images = jQuery("#wpcart_gallery").on("click","a", function(e){
        e.preventDefault();
        images.addClass("cboxElement");
        jQuery(this).removeClass("cboxElement");
    });
    images.eq(0).removeClass("cboxElement");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T08:32:57.827

试试这个

```
 $(function(){
       $("a:first").removeClass("cboxElement");
        $('.thickbox').click(function(){
            $('.thickbox').each(function(obj){
                if(!$(this).hasClass("cboxElement")){
                    $(this).addClass("cboxElement");
                }
            })
            $(this).removeClass("cboxElement");
        })
    }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:26:09.800

未经测试，但：

```
$("#wpcart_callery img").click(function(){

    // strip the class from all of them
    $("#wpcart_gallery img").removeClass("cboxElement");

    // add it to the clicked one
    $(this).addClass("cboxElement");

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T21:36:02.750

```
(function ($) {
    $(function () {
        $('.cboxElement').click(function () {
            $(this).removeClass('cboxElement').siblings().addClass('cboxElement');
        });
    });
})(jQuery); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-15T06:32:58.233

我假设您希望通过没有类来“选择”页面上的第一个图像，然后通过没有类来更改类以指示选择`.cboxElement`

```
$(function() {
  var list = $('.wpcart_gallery .cboxElement').click(function() {
    list.not('.cboxElement').addClass('cboxElement');
    $(this).removeClass('cboxElement');
  });
  list.first().click();
}); 
```

[上面的 JsFiddle](http://jsfiddle.net/HXeYf/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-16T07:29:11.620

```
$(document).ready(function(){

   $(".wpcart_gallery").filter("a:first").removeClass("cBoxElement");      
   $(".wpcart_gallery").on("click", "a", function(){
       $(".wpcart_gallery a").addClass("cBoxElement");
       $(this).removeClass("cBoxElement");   

} 
```

试试这个..它应该工作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-17T21:28:47.793

是因为您只是缺少一些分号吗？您在控制台窗口中看到什么错误？

```
<script type="text/javascript">
    jQuery('document').ready(function($){
        $(".wpcart_gallery a:first").removeClass("cboxElement");
        $('.thickbox').click(function(){
            $('.thickbox').each(function(obj){
                if(!$(this).hasClass("cboxElement")){
                    $(this).addClass("cboxElement");
                }
            });  //<-- semi-colon added here
            $(this).removeClass("cboxElement");
        });  //<-- semi-colon added here
    });
</script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-19T02:46:16.947

不确定这是否是最好的方法，但这有效（下面有更详细的解释）：

```
var elements = new Array();
jQuery(document).ready(function() {
    $('.cboxElement').each(function() {
        var element = $(this);
        element.attr('href', '#');
        element.click(function() {
            for (var i in elements) {
                elements[i].addClass('cboxElement');
            }
            $(this).removeClass('cboxElement');
         });
        elements.push(element);
    });
    $('.cboxElement:first').removeClass('cboxElement');
}); 
```

你可以在这里看到一个[活生生的例子](http://soundwave.robotsidekick.com/dev/stackoverflow/thumbnail.html)。

保留页面上所有 .cboxElement 元素的列表：

```
var elements = new Array(); 
```

然后在页面加载时，我们将找到所有的 .cboxElement 并做三件事： 1.`<a>`通过将`href`属性设置为`'#'` 2\. 为每个元素设置点击侦听器（将 cboxElement 类添加到所有原始元素，然后从刚刚单击的元素中删除 cboxElement）。3\. 填充我们所有元素的列表

```
$('.cboxElement').each(function() {
    var element = $(this);
    // 1\. remove <a> tag behavior
    element.attr('href', '#');
    // 2\. set click listener
    element.click(function() {
        for (var i in elements) {
            elements[i].addClass('cboxElement');
        }
        $(this).removeClass('cboxElement');
     });
    // 3\. keep track of all the .cboxElements
    elements.push(element);
}); 
```

然后，一旦我们准备好，从第一个中删除 cboxElement。

```
 $('.cboxElement:first').removeClass('cboxElement'); 
```

# scala - 有没有办法获取远程参与者的 IP 地址？

> ID：12308552
> 
> 赞同：2
> 
> 时间：2012-09-06T21:17:36.440
> 
> 标签：scala, ip, actor, akka, remote-actors

我想知道是否有办法获取远程 akka 演员的 ip 地址，因为目前我正在使用广播 ip 地址来设置演员系统（这是唯一一个似乎有效的方法）。我目前能够看到演员路径，但我想确切地知道它所在的机器，因为广播 ip 是用于网络的。

这是我的一些主要演员的代码：

```
# remote actor config
remotecreation{ #user defined name for the configuration
    include "common"
    akka {
            actor{
                    deployment{
                            /remoteActor{   #Specifically has to be the name of the remote actor
                                    router = "round-robin"
                                    nr-of-instances = 10
                                    target {
                                            nodes = ["akka://RemoteCreation@172.17.100.232:2554", "akka://RemoteCreation@172.17.100.224:2554"]
                                    }
                            }
                    }
            }
    remote.netty.port = 2554
    }

    remote{
            log-received-messages = on
            log-sent-messages = on
    }
} 
```

这是主定义：

```
class Master(goodies: AuthNetActorObject) extends Actor {

var start: Long = _ // helps measure the calculation time

def receive = {
case "start" => {
  System.out.println("Master Started!")
  System.out.println("The master is at: " + self.path.toString())
...
        }
    }
} 
```

这是我初始化和敲击演员的地方：

```
object Payment extends Controller {
    var goodies: AuthNetActorObject = null
    val system = ActorSystem("RemoteCreation",ConfigFactory.load.getConfig("remotecreation"))
    ...
    val master = system.actorOf(Props(new Master(actorObject)))
    master ! "start"
    ...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:13:35.130

采用`actorRef.path.address.host`

# internet-explorer - Windows Azure 上的 Chrome 与 IE 等使用回发

> ID：12308555
> 
> 赞同：2
> 
> 时间：2012-09-06T21:17:45.130
> 
> 标签：internet-explorer, firefox, google-chrome, jquery, azure

我之前发布了一个类似的问题，但没有得到任何回复，所以我试图让它更具体（经过大量测试后我已经能够做到这一点）。我不会继续推动，但这是一个阻碍，让我发疯。

我有一个 MVC3 应用程序。在其中我有一个包含以下两种方法的测试控制器：

```
public ActionResult Test2()
{
    return View();
}

public ActionResult Test2Get()
{
    System.Threading.Thread.Sleep(270000);
    var x = "Author = x";
    return Json(x,JsonRequestBehavior.AllowGet);
} 
```

Test2 视图如下：

```
@{
    ViewBag.Title = "Test2";
}

<h2>Test2</h2>

<script type="text/javascript">
    $(document).ready(function () {
        $.ajax({
            url: 'http://www.lp-web.net/Test/Test2Get',
            type: 'GET',
            success: function (result) { alert('success'); }
        });
    });
</script> 
```

正如您所看到的，Test2 视图只是在“加载”时对一个休眠 4.5 分钟然后返回一些 JSON 的方法执行回调。

当通过 Azure 模拟器在 VS 中本地运行时，这在所有浏览器上都可以正常工作。如果我构建一个非 Azure 版本并部署到托管服务器，那么这在所有浏览器中都可以正常工作。“工作”是指显示带有“成功”消息的警报。

但是，当部署到 Windows Azure 时，这仅在我使用 Chrome 时才有效。否则警报永远不会出现。

还有其他一些花絮：例如，如果睡眠持续时间设置为 4 分钟或更短，所有浏览器都可以工作，即使应用程序部署到 Azure 也是如此。但我真的不知道这有什么相关性。

我希望有人知道我可以在哪里看。如果有人想亲自尝试，您可以访问[http://www.lp-web.net](http://www.lp-web.net)，单击“Test2”操作链接并等待 4.5 分钟。我很想知道是不是“只有我”。

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T02:36:20.017

听起来连接在负载平衡器处超时。负载均衡器超时默认为四分钟（以前是一分钟），之后连接被重置。

这并不能完全解释 Chrome 的工作原理。但是，[该线程的底部观察到](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/89b283f0-dfca-49a7-99fe-c3b73d77ff6d)影响 IE 和 Firefox 的类似行为（通过明确命名它们可能意味着它不会在 Chrome 上发生？）

有关负载均衡器含义的更多上下文以及您可以如何补救，请查看[Windows Azure 负载均衡器超时详细信息](http://blogs.msdn.com/b/avkashchauhan/archive/2011/11/12/windows-azure-load-balancer-timeout-details.aspx)。

# android - WebView和检测html中编辑文本的类型？键盘类型？

> ID：12308558
> 
> 赞同：0
> 
> 时间：2012-09-06T21:17:48.520
> 
> 标签：android, android-layout

我的应用程序的一部分在 WebView 中有一个表单？我如何检测用户是否点击了 html 中应该只有数字的内容？例如邮政编码或信用卡信息？这样我就可以向他们展示正确类型的键盘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:44:48.477

基本上，您正在尝试修复 android 设备中缺少的 HTML5 实现： [http ://www.quirksmode.org/html5/inputs_mobile.html](http://www.quirksmode.org/html5/inputs_mobile.html)

这应该给你一个关于如何从 JS [http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%调用 Java 原生函数的提示29](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)

我认为您不能在显示键盘输入法时逐步更改它。

这是打开键盘的一种方法，但您需要处理输入，这看起来很糟糕，因为您看不到您在哪里输入。 [以编程方式打开软键盘](https://stackoverflow.com/questions/5593053/open-soft-keyboard-programmatically)

另一种解决键盘类型问题的方法我会弹出一个带有文本字段的本机对话框，并将该字段的键盘类型设置为您需要的类型。

然后通过使用 loadURL() 注入 javascript 将结果发送回 webview；

无论如何，您都希望将 html 字段设置为只读，这样它的键盘就不会跳动。

# c# - 如何使用流利的 nHibernate 将 .Net DateTime 映射到 DB2 Date？

> ID：12308559
> 
> 赞同：0
> 
> 时间：2012-09-06T21:17:53.100
> 
> 标签：c#, fluent-nhibernate, db2, data-mapping

我的 iSeries DB2 模式中有下表：

```
CREATE TABLE LATHAM1.SGINES1.LICVP010
  (ID FOR COLUMN ID10 BIGINT NOT NULL PRIMARY KEY,
   CompanyCode FOR COLUMN CONO10 CHARACTER (2) CCSID 37 NOT NULL,
   CreateDate FOR COLUMN CDAT10 DATE not null); 
```

以及表的以下映射：

```
public class OrderReferenceID
{
    public virtual long ID { get; set; }
    public virtual string CompanyName { get; set; }
    public virtual DateTime CreationDate { get; set; }
}

public class OrderReferenceIDMap : ClassMap<OrderReferenceID>
{
    public OrderReferenceIDMap()
    {
        Table("LICVP010");
        Id(x => x.ID, "ID10")
            .GeneratedBy.Native()
            .Not.Nullable();
        Map(x => x.CompanyName, "CONO10")
            .Length(2)
            .Not.Nullable();
        Map(x => x.CreationDate, "CDAT10");
    }
} 
```

和以下代码：

```
ISessionFactory sessionFactory = CreateSessionFactory();

using (var session = sessionFactory.OpenSession())
{
    OrderReferenceID newID = new OrderReferenceID { CompanyName = "LI", CreationDate = DateTime.Now.Date };

    session.Save(newID);
    session.Flush();
    session.Close();
} 
```

当我执行这个时，我得到一个错误：

```
A conversion error occurred. 
```

由于从 CLR DateTime 到 DB2 Date 对象的转换，这似乎正在发生。

我怎样才能正确映射这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:43:00.120

我发现修改这一行

```
Map(x => x.CreationDate, "CDAT10"); 
```

对此

```
Map(x => x.CreationDate, "CDAT10")
    .CustomType("Date"); 
```

解决了这个问题。

# jquery - 如何让我的 jquery 动画在返回时设置为不透明度 0？

> ID：12308564
> 
> 赞同：1
> 
> 时间：2012-09-06T21:18:07.857
> 
> 标签：jquery

随着项目的上升，它会淡出。然后该项目将再次下降并重新开始。
我想创建一个更连续的效果，其中对象在第一次上升后下降时仍然不可见，然后淡入淡出（），然后重新开始。那可能吗？有没有更好的方法来写这个？

```
$(".item")
    .animate({"marginTop":"-100px",opacity:0}, 3000,'linear')
    .animate({"marginTop":"0px",opacity: 0.5}, 600, 'linear', runMyFunctionAgain); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:43:37.880

这实际上没有并发计时器，因此您的方法足够有效。查看这个[jsFiddle](http://jsfiddle.net/edhwJ/)以获取我认为您想要的示例。如果网站有问题，代码如下：

`<html>`

```
<div class="item">Some Item Content</div>​ 
```

`js`

```
var initAnime = (function StartAnimation(){
 $('.item').animate(
  {"marginTop":"-100px",opacity:0},
  3000,
  'linear',
  function(){
   $('.item').animate(
    {"marginTop":"0px"},
    600,
    'linear',
    function(){
     $('.item').animate(
      {opacity: 0.5}, 
      600, 
      'linear', 
      StartAnimation
     );
    }
   );
  }
 );
})();​ 
```

我添加了额外的缩进以清楚地表明它在哪里，因为它有点链式。希望它使它更具可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:46:33.773

看看这个小提琴，看看这是否是你的想法：

[http://jsfiddle.net/BvQDs/4/](http://jsfiddle.net/BvQDs/4/)

HTML：

```
<div class="container">
    <div class="item"></div>
</div>
<div id="clickMe">
    <a href="#">Click Me!</a>
</div>​ 
```

JavaScript：

```
var animate = function(){
    $(".item").animate({"marginTop":"-100px",opacity:0}, 1000,'linear', function(){
        $(this).hide()
               .css({'marginTop':'0px', opacity:100})
               .fadeIn(1000, animate());
    });
};

$('#clickMe').on('click', function(){
    animate();
}); 
```

# ruby - 为 ActiveRecord 测试创建数百万条记录

> ID：12308565
> 
> 赞同：0
> 
> 时间：2012-09-06T21:18:21.697
> 
> 标签：ruby, postgresql, activerecord, greenplum

在 Ruby 中，我有一个测试，它是 Postgres（实际上是 Greenplum）数据库中`ActiveSupport::TestCase`的子类并通过子类访问表。`ActiveRecord`对于一个特定的测试，我需要用大约一百万行来填充表格，但我并不关心里面有什么。我可以做类似的事情

```
for i in 1...1000000 do
  MyTable.create(:column1 => 'value', :column2 => 'value')
end 
```

但这需要很长时间才能运行。我可以通过将它包装在一个事务中来让它更快一点，这样`create`就不会每次都创建一个新的，但这只会节省很多时间。

有没有一些好的方法可以做到这一点，这样我就不必在表中执行大量的虚假值插入？

（注意：试图假装表包含一百万条记录是行不通的，因为我稍后需要与实际行交互；对于这个特定的测试，我只是不在乎它们是什么）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:32:22.380

在一个简单的查询中运行所有这些，例如：

```
INSERT INTO mytable (col1, col2) 
SELECT 'value1', 'value2' 
FROM generate_series(1,1000000); 
```

这应该非常快地填充数据库。我的笔记本电脑需要 2 秒。

# mysql - Rackspace 云数据库和 Xeround 的区别

> ID：12308569
> 
> 赞同：0
> 
> 时间：2012-09-06T21:18:38.467
> 
> 标签：mysql, database, rackspace, xeround

我使用 Rackspace 云服务器。我在那里运行自己的 MySQL 实例，现在我看到 Rackspace 也提供云数据库产品。在我直接在云服务器上管理 MySQL 的情况下使用它有什么优势？

第二个问题是，如果有 Rackspace 的云数据库产品，我为什么要使用 Xeround 或其他类似的附加系统？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T06:51:44.117

Xeround 最便宜的计划比 Rackspace 云数据库便宜约 3 倍。此外，它还为连接很少（少于 5 个）的小型数据库提供免费计划。

另一方面，Xeround 使用自己的 MySQL 引擎，这有一些限制。就像，它不支持外键。主键也只能用 CREATE TABLE 添加，ALTER TABLE 不能添加 PK。

从在专用云服务器上托管自己的 MySQL 实例到使用这些 DaaS 服务之一，您可以从一些与数据库相关的管理任务中解放出来，例如更新软件或扩展。

# c++ - 为什么 weak_ptr 没有 atomic_{store,load}？

> ID：12308576
> 
> 赞同：8
> 
> 时间：2012-09-06T21:19:33.860
> 
> 标签：c++, c++11, shared-ptr, atomic, smart-pointers

为什么 C++ 标准包含`atomic_store`or`atomic_load`重载 for `shared_ptr`，但不包含`weak_ptr`？

这只是一个疏忽，还是有实际原因不提供原子操作`weak_ptr`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-09T17:40:50.800

这似乎是一个疏忽。Herb Sutter 有一个针对 atomic_shared_ptr/atomic_unique_ptr/atomic_weak_ptr 的 C++(17?) 标准设计提案，该文档还解释了现有方法的缺点，其中包含用于 shared_ptr 的免费函数 atomic_load/atomic_store：[http://www.open-std。 org/jtc1/sc22/wg21/docs/papers/2014/n4162.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4162.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:21:25.917

大概答案是因为，为了使用 a `weak_ptr`，您首先将其转换为`shared_ptr`using `lock()`。一旦你有了它，`shared_ptr`你就可以使用原子操作。

# ios - numberOfSectionsInTableView 仅在 tableview 为空时在 viewDidLoad 中/之后请求

> ID：12308581
> 
> 赞同：0
> 
> 时间：2012-09-06T21:20:05.297
> 
> 标签：ios, uitableview

一个简单的 tableviewController，空的。可以从按钮启动的模式。tableview 的数据源中没有数据，也没有显示行。

我打开模态框，用它添加一个项目，然后返回到 tableview 控制器。表格视图会自动更新，并显示新行。

我添加了第二项。表格视图不会自动更新。

我可以通过在 numberOfSectionsInTableView 中登录来判断，即使我去添加第一项并取消，tableview 也会刷新 - 它会询问要显示的部分、行和单元格的数量（如果有的话）。但如果表中有一个预先存在的行，则不会。

我已经搜索了我的代码，但找不到任何会导致 tableview 知道何时添加第一个项目，但之后没有。

有任何想法吗？

编辑 - 我已经进一步缩小了我的问题范围，所以很快就会关闭这个问题，并在[Why does an empty tableView check the number of section but a non-empty one not? 上发布了一个更具体的问题？](https://stackoverflow.com/questions/12325829/when-and-why-does-a-tableview-check-the-number-of-sections)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:41:18.697

来自 Apple 的[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)：

> UITableView 会覆盖 UIView 的 layoutSubviews 方法，以便它仅在您创建 UITableView 的新实例或分配新数据源时调用 reloadData。

也许您在显示该模式后正在设置表格视图的数据源？所以第二次数据源没有变化，tableView 也没有更新。

另一个关键（我不确定）可能是第一次显示模态。modal 的方法 -addSubview 导致 -layoutSubviews。

# java - Java，创建日历

> ID：12308582
> 
> 赞同：-1
> 
> 时间：2012-09-06T21:20:18.837
> 
> 标签：java, calendar

在我的 Java 类中，我必须构建一个日历应用程序。我已经完成了大部分工作，但是我需要一些方法的帮助。我已经评论了我需要帮助的部分。该代码包括三个类和一个名为 TestCalendar 的主类。我需要帮助的函数位于 Calendar 类中，名为 removeEvent（其中两个，采用两个不同的参数）、printEvents 和 findEvents。提前致谢！

这是 Date 类。

```
 public class Date {
    int year, month, day;
    //constructor
    public Date(int yr, int mth, int dy){
    year = yr;
    if (yr < 2000  || yr > 2100)
    {
        System.out.println("Wrong Calander Year");
        System.exit(1);
    }
    month = mth;
    if (mth < 1 || mth > 12)
    {
        System.out.println("Wrong Month");
        System.exit(1);
    }
    day = dy;
    if (dy < 1 || dy > 31)
    {
        System.out.println("Wrong Day");
        System.exit(1);
    }

    }
    //accessor methods
    public int getYear()
    {
        return year;
    }
    public int getMonth()
    {
        return month;
    }
    public int getDay()
    {
        return day;
    }
    //returns date in correct format
    public String toString()
    {
        return "" + month + "/" + day + "/" + year;
    }
    } 
```

这是事件类

```
 public class Event {
    Date date;
    int hour;
    String activity;

    Event(int year, int month, int day, int hour, String activity)
    {
        if (year < 2000  || year > 2100)
        {
            System.out.println("Wrong Calander Year");
            System.exit(1);
        }
        if (month < 1 || month > 12)
        {
            System.out.println("Wrong Month");
            System.exit(1);
        }
        if (day < 1 || day > 31)
        {
            System.out.println("Wrong Day");
            System.exit(1);
        }
        this.date = new Date(year, month, day);
        this.hour = hour;
        this.activity = activity;

    }
    public Date getDate()
    {
    return date;    
    }
    public int getHour()
    {
        return hour;    
    }
    public String getActivity()
    {
        return activity;
    }
    void setActivity(String newActivity) 
    {
        this.activity = newActivity;
    }
    public String toString()
    {
    return "" + date +" " + "@" + hour +":" + " " + activity;
    }
    public boolean equals(Object obj)
    {
    if (obj instanceof Event)   
    {
        return true;
    }
    else return false;
    }
    } 
```

日历类

```
 public class Calander {
        static final int MAXEVENTS = 10;
        Event[] events;
        int numEvents;

        // constructor
        public Calander() {
            numEvents = 0;
            events = new Event[MAXEVENTS];
        }

        void addEvent(int year, int month, int day, int hour, String activity) {
            Event newEvent = new Event(year, month, day, hour, activity);
            events[numEvents] = newEvent;
            numEvents++;
        }

        void removeEvent(int year, int month, int day, int hour, String activity) {

            {
             if (events[numEvents] == null);
             numEvents--;    
            }
        }

        // instructions say to remove (all) Event objects in the Calendar that are equals to the event argument.  Use the equals method from the event class

        void removeEvent(Event event) {

    //what to put here?
        }

        // this method needs to print every Event in the associated Calendar that matches the date arguments.  Print each on a separate line, using the toString method from the Event class.

        void printEvents(int year, int month, int day) { // how to set equality
    if (this.events[numEvents] == )
            {
                // what to put here?
            }
        }

        // same as above but matches the (Date date) arguments
        void printEvents(Date date) {
                toString();
        }

        // Return the first Event in the Calendar that has a matching (equals) activity field.  If no match is found, you must return a reference type, so return null.

                    Event findEvent(String activity) {
                            //what to put here?
            return null;
        }

        void dump() {

            for (int i = 0; i < MAXEVENTS; i++)
            {
                if (events[i] != null)
                System.out.println(events[i]);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:29:41.497

well, your event class has a method:

```
public boolean equals(Object obj) 
```

Which, presumably, should return whether or not the passed event is equal to the instance.

So your `void removeEvent(Event event)` method should look similar to the following:

**take note that this is psudo-code and not valid java. you're going to have to flesh out the details on your own.**

```
void removeEvent(Event event) 
{
    foreach(event e in this.events)
    {
        if(event.equals(e))
        {
            // remove e from the events array
        }
    }
} 
```

The rest of the methods are going to more or less be similar in concept to the first one with 2 varying factorrs:

*   how you identify a match
*   what you do with the match

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:29:12.667

Since this is homework, I don't actually want to do your homework. So as a hint, you want to use (your event).equals(comparing to other event), not "==".

# php - Wordpress - 在类别页面内显示所有类别的最新帖子列表

> ID：12308585
> 
> 赞同：0
> 
> 时间：2012-09-06T21:20:37.210
> 
> 标签：php, wordpress, themes

一般来说，WordPress 新手，玩主题很开心。

我现在有一个网站，顶部有一个最新帖子框。我希望它显示任何类别的 5 个最新帖子。

我遇到的问题是，此列表仅显示您当前所在类别的帖子。即，当 on 时`website.com/?cat=6`，它只显示类别 6 的帖子，但我希望它始终包含所有类别的列表。

这是可行的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:25:43.453

以下功能应该做你想做的事，此外还提供了示例：

[http://codex.wordpress.org/Template_Tags/get_posts](http://codex.wordpress.org/Template_Tags/get_posts)

# html - 我的 ul 有问题

> ID：12308586
> 
> 赞同：1
> 
> 时间：2012-09-06T21:20:41.767
> 
> 标签：html, html-lists

试图制作一个非常简单的html页面。出于某种原因，<ul> 似乎跳出了 <div> 并在顶部，这意味着 <ul> 成为页面上的第一件事。

这是我的代码 [http://jsfiddle.net/pnQCs/2/](http://jsfiddle.net/pnQCs/2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:52:32.397

您忘记在div`table`之前关闭第一个标签。`tabWrapper`

```
</table> <!-- add this -->
<div id="tabWrapper"> 
```

那些盲桌到底在做什么？只需设置您的 div 样式。

# eclipse - Subversion 连接：RA 层请求失败

> ID：12308590
> 
> 赞同：3
> 
> 时间：2012-09-06T21:20:58.973
> 
> 标签：eclipse, svn, subclipse, subversive

昨天下午出乎意料的是，从我的 Eclipse IDE 到我们的 Subversion 存储库的 subversion 连接一直失败（使用 Subversive 和 Subclipse）。

我可以通过浏览器浏览 subversion 目录，它只能通过 Eclipse 连接失败（我使用的是 MacBook Prod Mountain Lion OSX 10.8.1；Apple 1.6.0 的最新 Java）

尝试颠覆连接时收到的消息：

“RA 层请求失败 svn：'http://example.com/tags/project' 的选项：无法读取状态行：对等 (http://example.com) 重置连接”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T13:36:44.470

您是否正在尝试浏览存储库，或者您是否有正在尝试更新的现有工作副本？我认为您可能没有输入正确的 SVN 存储库 URL。仅仅因为浏览器工作正常，并不意味着这是客户端的正确 URL。它*可能*是。这取决于您是直接浏览存储库还是使用 Web GUI。

该问题也可能与代理服务器有关。如果您需要代理服务器，很可能您的网络浏览器已经配置为使用它。但是，SVN 客户端有自己的代理配置，必须单独配置。

# c# - 在类级别应用 PrincipalPermission 时出现权限错误

> ID：12308594
> 
> 赞同：1
> 
> 时间：2012-09-06T21:21:13.517
> 
> 标签：c#, principalpermission

```
[PrincipalPermission(SecurityAction.Demand, Role = "ValidRole")]
public partial class CustomerAdd : System.Web.UI.UserControl
{....

} 
```

当我尝试上面的代码时，我没有收到编译时错误并且没有应用权限。即使对于有效角色，我也无法执行任何代码方法。即使对于有效角色，我也会收到权限被拒绝错误。

这适用于方法级别的声明，但不适用于类级别的声明。

请告诉我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T16:51:53.660

我上周遇到了这个问题，我发现唯一有意义的[答案是：](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/41c5a8c6-8d17-41c7-9714-4e47296ba75d/)

> 那是因为您现在已经在构造函数上设置了权限。确保创建服务实例（IIS、Windows 服务等）的主机现在有权访问该服务。

对 ASP.NET 成员资格/角色提供程序进行了一些测试，我可以明确地确定调用构造函数的用户和方法是不同的。

# c# - 如何写入COM端口并等待回复c#

> ID：12308597
> 
> 赞同：0
> 
> 时间：2012-09-06T21:21:35.717
> 
> 标签：c#, serial-port

我需要向串行端口发送命令以与 Enfora 调制解调器通信。对于每个命令，我都会收到回复，但回复字符串的长度可能会有所不同。我需要知道如何写，然后等待回复，直到它完成......

所以我想制作一个从串口读取的线程，而程序只写......

线程函数

```
private void thread_Handler()
{
    while(true)
        this.read();
}
private void read()
{
    if (this.rtbMessages.InvokeRequired)
    {
        try
        {
            SetTextCallback d = new SetTextCallback(read);
            this.Invoke(d);
        }
        catch{}
    }
    else
    {
        readBuffer = serialPort.ReadExisting();
        rtbMessages.AppendText(readBuffer);
    }
} 
```

所以这个线程总是试图从 com 端口读取，我以这种方式发送消息

```
writeBuffer = "COMMAND 1";
serialPort.Write(writeBuffer);
writeBuffer = "COMMAND 2";
serialPort.Write(writeBuffer); 
```

但是，我没有从使用 Write() 发送的第二个命令中得到答复...我尝试在每次 Write() 之后删除线程并使用 ReadExisting() 但这也不起作用。

我可以让它工作的唯一方法是添加一个

```
System.Threading.Thread.Sleep(1000); 
```

每次调用 Write 后，我都会从每个 Write() 命令中获得所有回复...但我不想使用它，我想知道另一种有效写入并从我发送的每个命令中获得每个回复的方法无论回复字符串的长度以及我收到回复消息需要多长时间。

有时我会一直收到消息，直到我发送另一个命令来停止生成消息。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:31:55.223

.Net 将为您做这一切。

只需创建一个 SerialPort 并订阅其[DataReceived](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx)事件。（请注意，在某些情况下，您可能需要将以这种方式接收的几块数据拼接在一起，以组装一个完整的数据包，但如果它是来自调制解调器命令的简短回复，您可能总是/通常会找到您每次引发事件时获取完整的数据包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:29:38.983

Use an Event to receive the data.

Here is an example from DreamInCode (you will have to customize it to your particular needs):

```
/// <summary>
/// This method will be called when there's data waiting in the comport buffer
/// </summary>
void comPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
{
    //determine the mode the user selected (binary/string)
    switch (CurrentTransmissionType)
    {
        //user chose string
        case TransmissionType.Text:
            //read data waiting in the buffer
            string msg = comPort.ReadExisting();
            //display the data to the user
            DisplayData(MessageType.Incoming, msg + "\n");
            break;
        //user chose binary
        case TransmissionType.Hex:
            //retrieve number of bytes in the buffer
            int bytes = comPort.BytesToRead;
            //create a byte array to hold the awaiting data
            byte[] comBuffer = new byte[bytes];
            //read the data and store it
            comPort.Read(comBuffer, 0, bytes);
            //display the data to the user
            DisplayData(MessageType.Incoming, ByteToHex(comBuffer) + "\n");
            break;
        default:
            //read data waiting in the buffer
            string str = comPort.ReadExisting();
            //display the data to the user
            DisplayData(MessageType.Incoming, str + "\n");
            break;
    }
} 
```

[http://www.dreamincode.net/forums/topic/35775-serial-port-communication-in-c%23/](http://www.dreamincode.net/forums/topic/35775-serial-port-communication-in-c%23/)

# html - 如何使用 perl 替换两个特定行之间的文本

> ID：12308602
> 
> 赞同：2
> 
> 时间：2012-09-06T21:22:17.353
> 
> 标签：html, regex, perl

嗨，我有一个像这样的名为 1.html 的 html 文件

```
<div class="t_l"></div>
 <some> 
   lines
     of
 codes
 </some>
<div class="t_r"></div> 
```

我想将该 div 的内容替换为另一个内容，该内容存储在名为“banner”的文件中。横幅文件是

```
<other> 
   lines
     of some
 codes
</other> 
```

所以我想要得到的是：

```
<div class="t_l"></div>
 <other> 
   lines
     of some
 codes
 </other>
<div class="t_r"></div> 
```

我想出使用 perl 是这样的：

```
# Slurp file 1.html into a single string
open(FILE,"1.html") or die "Can't open file: $!";
undef $/;
my $file = <FILE>;
open(BANNER,"banner") or die "Can't open file: $!";
undef $/;
my $banner = <BANNER>;
close BANNER;

# Set strings to find and insert
my $first_line = '<div class="t_l"></div>';
my $second_line = '<div class="t_r"></div>';

$file =~ s/$first_line\n.+?\n$second_line#s/$first_line\n$banner\n$second_line/;

close FILE;

# Write output to output.txt
open(OUTPUT,">1new.html") or die "Can't open file: $!";
print OUTPUT $file;
close OUTPUT; 
```

上面的代码不能工作。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:51:01.890

您快到了。

的正常正则表达式行为`.`是匹配除换行符以外的任何字符。`.+?`在您的正则表达式中对您不起作用，因为`$first_line`和之间有更多换行符`$second_line`。

使用`/s`修饰符告诉 Perl 也让`.`匹配换行符。

（你的表达中也有一个无关的“ `#s`”）

所以一个有效的替代是：

```
$file =~ s/$first_line\n.+?\n$second_line/$first_line\n$banner\n$second_line/s; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:45:31.263

一起去

```
$file =~ s/($first_line\n)[^\n]+(\n$second_line)/$1$banner$2/; 
```

或者

```
$file =~ s/(?<=$first_line\n)[^\n]+(?=\n$second_line)/$banner/; 
```

# ios - RestKit：现在不推荐使用`postObject mapResponseWith：delegate：`，我该怎么做？

> ID：12308603
> 
> 赞同：3
> 
> 时间：2012-09-06T21:22:29.553
> 
> 标签：ios, restkit

我使用这种方法来发布我的对象，但它已被弃用：

```
- (void)postObject:(id<NSObject>)object mapResponseWith:(RKObjectMapping *)objectMapping delegate:(id<RKObjectLoaderDelegate>)delegate 
```

我现在应该改用什么？如何配置我的响应的 RKObjectMapping？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:50:04.060

选择器已被弃用，`- (void)postObject:(id<NSObject>)object usingBlock:(RKObjectLoaderBlock)block`因此您可以使用该块来配置`RKObjectLoader`实例。示例如下如何在块中设置 objectMapping（用于映射*响应*的映射）：

```
[[RKObjectManager sharedManager] postObject:object
                                      block:^(RKObjectLoader* loader) { 
                                         loader.objectMapping = objectMapping;
                                         loader.delegate = delegate;
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T07:16:53.247

你也可以使用

```
[[RKObjectManager sharedManager] postObject:(id<NSObject>)object delegate:(id<RKObjectLoaderDelegate>)delegate]; 
```

这没有被弃用

# sql - PL/SQL -- 将不相关行的子表连接起来

> ID：12308604
> 
> 赞同：1
> 
> 时间：2012-09-06T21:22:38.120
> 
> 标签：sql, join, plsql

我正在尝试在 PL/SQL 中执行连接，以获取包含多个子表的父记录列表作为单个查询的一部分。我不是甲骨文专家。如果我写了这样的查询：

```
SELECT PEOPLE.PersonName, JOBS.JobName, CREDENTIALS.CredentialName 
  FROM PEOPLE
  LEFT OUTER JOIN JOBS
    ON PEOPLE.PersonName = JOBS.PersonName
  LEFT OUTER JOIN CREDENTIALS
    ON PEOPLE.PersonName = CREDENTIALS.PersonName
  WHERE PEOPLE.PersonName = 'James' 
```

我会得到一张表，其中列出了工作和凭证的每个组合，如下所示：

```
RN PERSON    JOB         CREDENTIAL
1  James     Developer   MBA
2  James     Developer   PhD
3  James     Developer   MCAD
4  James     QA          MBA
5  James     QA          PhD
6  James     QA          MCAD 
```

这很好，并且正是您期望左外连接工作的方式。但我需要的是 JOB 和 CREDENTIAL 列只列出每个元素一次并且彼此无关 - 但仍然在 PERSON 是 James 的行上并且仅在行上列出 James 的子记录。

```
RN PERSON    JOB         CREDENTIAL
1  James     Developer   MBA
2  James     QA          PhD
3  James     (null)      MCAD 
```

但我不知道如何写这个加入。（想法是 C# 代码将获取查询结果并将其转换为一个父 PERSON 对象，其中包含对两个子 JOB 对象和三个子 CREDENTIAL 对象的引用列表。

然而，在这个例子之外，实际上有不止两个子表，所以我不能过滤一个结果集，它是所有子组合的产物；我需要列是不相关的列表。

我愿意处理毛茸茸的 SQL 来实现这一点，但它需要是一个查询，而不是多个查询，结果在 C# 端组合。

感谢任何能提供帮助的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:01:00.567

您需要枚举每个列表，然后将其用于加入：

```
select p.PersonName, j.JobName, c.CredentialName
from Person p left outer join
     (select j.*,
             row_number() over (partition by PersonName order by jobname) as seqnum
      from jobs
     ) j
     on p.PersonName = j.PersonName full outer join
     (select c.*,
             row_number() over (partition by PersonName order by CredentialName) as seqnum
      from Credentials
     ) c
     on p.PersonName = c.PersonName and
        j.seqnum = c.seqnum
WHERE p.PersonName = 'James' 
```

这个查询正在做更多的工作，因为它为所有人分配了 seqnum。如果您真的一次只选择一个人，您可以将 WHERE 子句放在子查询中以提高效率。

# optimization - 从长时间运行的进程中写入大量文件？

> ID：12308608
> 
> 赞同：3
> 
> 时间：2012-09-06T21:23:03.360
> 
> 标签：optimization, io, output-buffering, filehandle

我有一个项目，它扫描一个大文件（2.5GB）挑选字符串，然后将其写入数百个文件的某个子集。

仅使用普通缓冲写入是最快的，但是

1.  我担心文件句柄用完。
2.  我希望能够在写入文件时查看文件的进度。
3.  如果过程中断，我希望损失尽可能少。不完整的文件仍然部分有用。

因此，我以读/写模式打开，追加新行，然后再次关闭。

这在很多时候已经足够快了，但我发现在某些操作系统上这种行为是一种严重的*悲观*。上次我在 Windows 7 上网本上运行它时，我在几天后中断了它！

我可以实现某种 MRU 文件句柄管理器，它可以保持这么多文件打开并在每个文件进行这么多写操作后刷新。但这是否矫枉过正？

**这一定是常见的情况，有没有“最佳实践”、“模式”？**

^(当前的实现是在 Perl 中，并已在 Linux、Solaris 和 Windows、上网本到 phat 服务器上运行。但我对一般问题感兴趣：语言无关和跨平台。我曾想过用 C 或 node.js 编写下一个版本。)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:29:18.867

On Linux, you can open a lot of files (thousands). You can limit the number of opened handles in a single process with the [setrlimit](http://linux.die.net/man/2/setrlimit) syscall and the [ulimit](http://ss64.com/bash/ulimit.html) shell builtin. You can query them with the `getrlimit` syscall and also using `/proc/self/limits` (or `/proc/1234/limits` for process of pid 1234). The maximum number of system-wide opened files is thru `/proc/sys/fs/file-max` (on my system, I have 1623114).

So on Linux you could not bother, and open many files at once.

And I would suggest to maintain a [memoized](http://en.wikipedia.org/wiki/Memoization) [cache](http://en.wikipedia.org/wiki/Cache_%28computing%29) of opened files, and use them if possible (in a MRU policy). Don't open and close each file too often, only when some limit has been reached... (e.g. when an `open` did fail).

In other words, you could have your own file abstraction (or just a `struct`) which knows the file name, may have an opened `FILE*` (or a null pointer) and keep the current offset, maybe also the last time of opening or writing, then manage a collection of such things in a FIFO discipline (for those having an opened `FILE*`). You certainly want to avoid `close`-ing (and later re-`open`-ing) a file descriptor too often.

You might occasionally (i.e. once a few minutes) call [sync(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/sync.2.html), but don't call it too often (certainly not more than once per 10 seconds). If using buffered `FILE`-s don't forget to sometimes `fflush` them. Again, don't do that very often.

# c++ - 如果我有符号，如何在 DLL 中找到参数签名并调用未导出的方法？

> ID：12308611
> 
> 赞同：2
> 
> 时间：2012-09-06T21:23:09.240
> 
> 标签：c++, dll, reverse-engineering, symbols

这是 Windows 中内置的 dll，[odbc32.dll](http://msdn.microsoft.com/en-us/library/windows/desktop/ms714562%28v=vs.85%29.aspx)。该函数称为 LoadTraceDll()

Visual Studio 2008 中的堆栈帧是：

> odbc32.dll!LoadTraceDll() + 0x42f 字节

我使用了 PE 分析器，但在 odbc32.dll 的导出列表中没有看到它。

我的问题如下：

*   如何确定参数类型和返回类型（方法签名）？
*   我怎么称呼它？我可以避免调用它的相对地址吗？

完整的堆栈跟踪如下：

```
ODBCTracer.dll!TraceVersion()  Line 2259    C++
odbc32.dll!LoadTraceDll()  + 0x42f bytes    
odbc32.dll!FInitTrace()  + 0xf3 bytes   
odbc32.dll!DllMain()  + 0x14692 bytes   
odbc32.dll!_CRT_INIT()  - 0x3e3 bytes   
ntdll.dll!LdrpRunInitializeRoutines()  + 0x1e8 bytes    
ntdll.dll!LdrpLoadDll()  - 0x336 bytes  
ntdll.dll!LdrLoadDll()  + 0x9e bytes    
KernelBase.dll!LoadLibraryExW()  + 0x13f bytes  
odbccp32.dll!LoadDM()  + 0x2a bytes 
odbccp32.dll!TracingPageProc()  + 0xc46 bytes   
user32.dll!UserCallDlgProcCheckWow()  - 0x180d bytes    
user32.dll!DefDlgProcWorker()  + 0xba bytes 
user32.dll!DefDlgProcW()  + 0x36 bytes  
user32.dll!UserCallWinProcCheckWow()  + 0x11d bytes 
user32.dll!InternalCreateDialog()  - 0xc7 bytes 
user32.dll!CreateDialogIndirectParamAorW()  + 0x5b bytes    
user32.dll!CreateDialogIndirectParamW()  + 0x18 bytes   
comctl32.dll!_CreatePageDialog()  + 0xb1 bytes  
comctl32.dll!_CreatePage()  + 0x161 bytes   
comctl32.dll!PageChange()  + 0xca bytes 
comctl32.dll!PropSheetDlgProc()  + 0x36e bytes  
user32.dll!UserCallDlgProcCheckWow()  + 0x11b bytes 
user32.dll!DefDlgProcWorker()  + 0xba bytes 
user32.dll!DefDlgProcW()  + 0x36 bytes  
user32.dll!UserCallWinProcCheckWow()  + 0x11d bytes 
user32.dll!SendMessageWorker()  + 0x158 bytes   
user32.dll!SendMessageW()  + 0x5d bytes 
comctl32.dll!CCSendNotify()  + 0xfbd bytes  
comctl32.dll!SendNotifyEx()  + 0x80 bytes   
comctl32.dll!ChangeSel()  + 0x2dc bytes 
comctl32.dll!Tab_OnLButtonDown()  + 0xfc bytes  
comctl32.dll!Tab_WndProc()  + 0x56d bytes   
user32.dll!UserCallWinProcCheckWow()  + 0x11d bytes 
user32.dll!DispatchMessageWorker()  + 0x12a bytes   
user32.dll!IsDialogMessageW()  + 0x102 bytes    
comctl32.dll!Prop_IsDialogMessage()  + 0x1f0 bytes  
comctl32.dll!_RealPropertySheet()  + 0x31b bytes    
comctl32.dll!_PropertySheet()  + 0x55 bytes 
odbccp32.dll!MainSheet()  + 0x18c bytes 
odbccp32.dll!SQLManageDataSources()  + 0x4b bytes   
odbcad32.exe!WinMain()  + 0x25b bytes   
odbcad32.exe!ODBC___GetSetupProc()  + 0x4ae bytes   
kernel32.dll!BaseThreadInitThunk()  + 0xd bytes 
ntdll.dll!RtlUserThreadStart()  + 0x21 bytes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T11:32:48.160

如果您有图像的符号（PDB 文件），则可以检索未导出的符号及其签名（如果这些符号是公开的（用 PDB 公开与私有的说法）。使用[DIA](http://msdn.microsoft.com/en-us/library/x93ctkx8%28v=vs.71%29.aspx)，您可以将符号与关联的图像文件匹配。有关PDB 符号和图像之间的映射如何工作的示例，请参见[此处。](http://www.codeproject.com/Articles/37456/How-To-Inspect-the-Content-of-a-Program-Database-P)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:27:31.903

> 如何确定参数类型和返回类型（方法签名）？

你不能。

（嗯，你可以，有一定的信心，但它需要强大的逆向工程技能。你必须反汇编库，找到函数是如何定义和调用的，从典型的操作序列和参数/变量大小，你可以推断出参数的类型和返回值**可以是什么**）

> 我怎么称呼它？我可以避免调用它的相对地址吗？

您可以`dlopen()`...呃... `LoadLibrary()`DLL，然后使用 获取其地址`GetProcAddres()`，将其存储在函数指针中，然后调用它：

```
HMODULE hndl = LoadLibrary("My.DLL");
void (*func)() = GetProcAddress(hndl, "MyFunction");
func(); 
```

# facebook - 如何访问现有应用程序

> ID：12308613
> 
> 赞同：1
> 
> 时间：2012-09-06T21:23:21.940
> 
> 标签：facebook, web, administration

我继承了一个当前具有 appId 的应用程序，但我需要更改一些其他信息。我不知道是什么用户控制应用程序。如何访问现有应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T01:53:15.863

您将需要追踪谁是当前应用程序的管理员，没有其他办法。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-06T21:26:13.323

可能您可以将 git 存储库克隆到本地计算机 - 您可以在应用程序详细信息中找到地址。您当然应该删除旧的 ssh 密钥并上传您的公钥 - [https://devcenter.heroku.com/articles/keys](https://devcenter.heroku.com/articles/keys)

# sql - 将数组传递给存储过程

> ID：12308616
> 
> 赞同：0
> 
> 时间：2012-09-06T21:23:37.633
> 
> 标签：sql, sql-server, stored-procedures

我想将一个包含 20k 个 ID 的数组传递给我的存储过程参数，以便更新某个表。

我不想单独运行 20k 更新查询，而是想运行 1 个查询来更新所有查询，它应该会提高我的性能。

任何人都知道我可以将参数传递给我的存储过程吗？

我知道 NVARCHAR(MAX) 限制为 8000 个字符，是否有可能使用存储的 proc 参数发送如此庞大的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:25:56.917

请改用[表值参数](http://msdn.microsoft.com/en-us/library/bb675163.aspx)。请参阅[使用表值参数（数据库引擎）](http://msdn.microsoft.com/en-us/library/bb510489.aspx)。顾名思义，TVP 就是一个参数表。您从您的客户端代码中为其分配一个 DataTable，并且该过程（或您的临时 SQL 代码）接收整个 DataTable 作为参数。这是 MSDN 复制的示例：

```
// Assumes connection is an open SqlConnection.
using (connection)
{
// Create a DataTable with the modified rows.
DataTable addedCategories = CategoriesDataTable.GetChanges(
    DataRowState.Added);

// Define the INSERT-SELECT statement.
string sqlInsert = 
    "INSERT INTO dbo.Categories (CategoryID, CategoryName)"
    + " SELECT nc.CategoryID, nc.CategoryName"
    + " FROM @tvpNewCategories AS nc;"

// Configure the command and parameter.
SqlCommand insertCommand = new SqlCommand(
    sqlInsert, connection);
SqlParameter tvpParam = insertCommand.Parameters.AddWithValue(
    "@tvpNewCategories", addedCategories);
tvpParam.SqlDbType = SqlDbType.Structured;
tvpParam.TypeName = "dbo.CategoryTableType";

// Execute the command.
insertCommand.ExecuteNonQuery();
} 
```

# winapi - Pascal - Win32api SYSTEMTIME 结构 wYear 始终为 97

> ID：12308617
> 
> 赞同：0
> 
> 时间：2012-09-06T21:23:45.777
> 
> 标签：winapi, pascal, systemtime

我有一个返回 SYSTEMTIME 的函数。

```
function GetFileDate : SYSTEMTIME; //Stdcall;
var
    CheckFile: Long;
    FileTime: LPFILETIME;
    FileTimeReturn: LPFILETIME;
    SystemTimeReturn: LPSYSTEMTIME;
begin
    CheckFile := CreateFile(PChar('main.dll'), GENERIC_READ, FILE_SHARE_READ, NIL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
    GetFileTime(CheckFile, @FileTime, NIL, NIL);
    FileTimeToLocalFileTime(@FileTime, @FileTimeReturn);
    FileTimeToSystemTime(@FileTime, @SystemTimeReturn);
    GetFileDate := SystemTimeReturn^;
end; 
```

对于 2012 年和 2006 年的文件以及其他任何文件，它始终返回 97 年。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:31:13.047

该代码是胡说八道，我很惊讶它完全可以编译。你声明了三个指针变量，但你从来没有让它们指向任何东西。您将指向这些变量的指针传递给 API 函数，但这些 API 函数并不期望指向您提供的类型的指针。

`FileTimeToLocalFileTime`期望收到两个`FILETIME`指针。您已将`FileTime`and声明`FileTimeReturn`为指向`FILETIME`值的指针，但是当您将`@`运算符应用于它们时，您将获得*指向*指向`FILETIME`值的指针的指针。更好的代码应该是这样的：

```
function GetFileDate : SYSTEMTIME; //Stdcall;
var
  CheckFile: Long;
  FileTime: FILETIME;
  FileTimeReturn: FILETIME;
  SystemTimeReturn: SYSTEMTIME;
begin
  CheckFile := CreateFile(PChar('main.dll'), GENERIC_READ, FILE_SHARE_READ, NIL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
  GetFileTime(CheckFile, @FileTime, NIL, NIL);
  FileTimeToLocalFileTime(@FileTime, @FileTimeReturn);
  FileTimeToSystemTime(@FileTime, @SystemTimeReturn);
  GetFileDate := SystemTimeReturn;
end; 
```

Note that I've removed the `LP` prefixes from the type names, and I've removed the dereference from the final line.

Correct code would check each API function's return value to make sure it succeeded before calling the next one.

* * *

Here's why you get the unexpected results you see. A `FILETIME` is a 64-bit value. If you're using a 32-bit system, then your `LPFILETIME` variables are only 32 bits wide. The API expects a pointer to a 64-bit-wide buffer, but you're giving it a pointer to a 32-bit space. When the API writes 64 bits of information into a 32-bit space, we can't be sure where the extra 32 bits are being stored.

You passed a pointer to `SystemTimeReturn`, which was an `LPSYSTEMTIME`. The API wrote into that space as though it were a `SYSTEMTIME`. Then, your function dereferenced what it assumed to be an `LPSYSTEMTIME`, but which actually held a value of type `SYSTEMTIME`. You dereferenced a time instead of a pointer. The time you got happens to look like a valid address, and the value residing at that "address" happens to be 97.

# perl - 有没有办法记录在 PERL 中运行的最大内存

> ID：12308619
> 
> 赞同：1
> 
> 时间：2012-09-06T21:23:53.857
> 
> 标签：perl, memory

正如我所说，我想记录程序运行时使用的最大内存。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T05:40:13.670

`Devel::Size`一次只测量一个特定数据结构的内存大小，以测量脚本中使用的所有数据结构的总内存大小在类 Unix 系统上，`Proc::ProcessTable`为它提供了一个很好的 API：

这是一个简单的脚本，将其与 Devel::Size 进行比较。

```
 #!/usr/bin/perl -w
use strict;
use Proc::ProcessTable;
use Devel::Size qw(size);

my @arr = ('A' .. 'M');
my $devel_size = size(\@arr);
print "With DEVEL::SIZE I'm $devel_size bytes big\n";

my $t = Proc::ProcessTable->new();

foreach my $p ( @{$t->table} ) {
    if($p->pid() == $$) {
    print "With Proc::ProcessTable I'm ", $p->size(), " bytes big.\n";
        last;
    }
} 
```

它给：

`DEVEL::SIZE`我有 104 个字节。我有 5357568 字节大
。`Proc::ProcessTable`

**注：**信息来源：[http ://www.perlmonks.org/](http://www.perlmonks.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T00:24:01.507

在 perlmonks 上找到了这个，[http](http://www.perlmonks.org/?node_id=498401) ://www.perlmonks.org/?node_id=498401 ：

```
use Devel::Size qw/ total_size /;
print total_size( \%:: ); 
```

# c++ - 在循环中连接 Visual Studio C++ 6.0 中的字符串

> ID：12308630
> 
> 赞同：0
> 
> 时间：2012-09-06T21:24:46.930
> 
> 标签：c++, string, concatenation

你能帮我在 C++ 中为 Visual Studio C++ 6.0 优化这段代码吗：

```
char output[10000] = "";
for (int i = 0; i < cnt; i++) {
    char row[150];
    _snprintf(row, 149, "…", …);
    row[149] = '\0';
    strcat(output, row);
}
return _snprintf(buffer, size-1, "%s\r\nend\r\n", output); 
```

我需要的是我没有指定 output[] 的大小，而是动态增加它。row[] 可能也是如此。对不起，我是 C++ 的新手。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:29:28.400

In C++, you ought to use `std::string` for strings instead of `char` arrays, and `std::stringstream` and its cousins `std::istringstream` and `std::ostringstream` instead of `sprintf()` or `snprintf()` for formatting in string buffers. Here’s the basis of a C++ solution:

```
std::ostringstream result;
for (int i = 0; i < cnt; ++i) {
    result << "...\n";
}
result << "end\n";
return result.str(); 
```

The `std::string` class handles all of the details of managing memory, and `std::stringstream` uses `std::string` internally.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:25:42.343

`std::stringstream`再加上`operator <<`作品就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T00:46:49.847

如果您正在使用，则使用该类`MFC`非常容易：`CString`

```
// loop count
int nCount = 100;
CString strOutput, strOne;
for (int i=0 ; i<nCount ; i++)
{   // format one line
    strOne.Format(_T("..."), ...);
    // accumulate the result
    strOutput += strOne;
}
return strOutput; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T22:07:59.763

我认为作为答案给出的 C++ 容器的使用并没有得到优化。开始时没有保留内存，并且结果不会复制到`buffer`您提供的代码中。

你仍然可以像这样做得更好：

```
char suffix[] = "\r\nend\r\n";
int suffix_len = strlen(suffix);
char *buf_end = buffer + size - suffix_len - 1;
char *buf_begin = buffer;

for (int i = 0; i < cnt; i++) {
    int nchars = _snprintf(buf_begin, buf_end-buf_begin, "…", …);
    if( nchars >= 0 ) {
        buf_begin += nchars;
    } else {
        // You may want to set an overflow flag here.
        buf_begin = buf_end;
        break;
    }
}

// There will always be enough room in the buffer to store the suffix, so 
// this will null-terminate even if the above loop overflowed the buffer.
_sprintf(buf_begin, "%s", suffix); 
```

我已将其修改为直接写入`buffer`而不是`output`. 它利用了`_sprintf`家庭返回写入的字符数（如果写入的最大字符数为负数）的事实。对我来说，这是将数据连接到缓冲区的更可取的方式，即使在 C++ 中也是如此。

# html - 是否有从链接生成嵌入 HTML 的服务？

> ID：12308641
> 
> 赞同：1
> 
> 时间：2012-09-06T21:25:56.070
> 
> 标签：html, embed

我正在编写一个涉及发布内容的应用程序，我希望人们的输入以纯文本的形式，但自动嵌入链接到的内容，例如 Facebook。是否有生成 HTML 以在每个站点上嵌入链接内容的服务？例如，YouTube 链接将返回视频的嵌入代码，图像将返回缩略图，Facebook 个人资料将返回个人资料图片+名称等。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:33:21.587

也许你正在寻找这个： http: [//www.addthis.com/](http://www.addthis.com/)

# javascript - 如何在 Highcharts 动态更改 y 轴的单位？

> ID：12308643
> 
> 赞同：9
> 
> 时间：2012-09-06T21:26:05.670
> 
> 标签：javascript, jquery, highcharts

如何在 Highcharts 动态更改 y 轴的单位？

我有一个 y 轴的格式化程序：

```
 yAxis:{
        title:{
            text:'Custom Title'
        },
        labels: {
            formatter: function () {
                var maxElement;//I want to set it to max value at y axis labels

                if(maxElement > gb){
                    return (this.value / gb).toFixed(1) + " GB";
                }else if(maxElement > mb){
                    return (this.value / mb).toFixed(1) + " MB";
                }else if(maxElement > kb){
                    return (this.value / kb).toFixed(1) + " KB";
                } else {
                    return (this.value) + " B";
                }
            }
        },
      ... 
```

我在这里问了一个问题：[如何在 highcharts 上获得 ay 轴的最大值？](https://stackoverflow.com/questions/12301236/how-can-i-get-the-max-value-of-a-y-axis-at-highcharts)关于如何在 y 轴标签处获得最大值。但是我认为我应该有一些像 beforeLoad 和 beforeRedraw 方法。

如何动态更改 y 轴标签的单位（因为如果您在右侧禁用/关闭系列最大 y 轴标签更改）？

欢迎其他关于我的问题的解决方案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-06T21:48:31.987

这种情况下，您可以`max`通过以下行获得：
`this.axis.max;`

所以你的功能应该是：

```
formatter: function() {
    var maxElement = this.axis.max;
    if (maxElement > gb) {
        return (this.value / gb).toFixed(1) + " GB";
    } else if (maxElement > mb) {
        return (this.value / mb).toFixed(1) + " MB";
    } else if (maxElement > kb) {
        return (this.value / kb).toFixed(1) + " KB";
    } else {
        return (this.value) + " B";
    }
}​ 
```

你可以看到它**[在这里工作](http://jsfiddle.net/RFcPD/)**。

# jquery-animate - jquery .animate() marginTop 不断扩大文档高度

> ID：12308644
> 
> 赞同：0
> 
> 时间：2012-09-06T21:26:09.290
> 
> 标签：jquery-animate

查看我的小提琴，看看我正在使用什么：

[http://jsfiddle.net/ETKYj/7/](http://jsfiddle.net/ETKYj/7/)

它会扩展高度直到持续时间结束，使页面大小增加三倍。我希望这些词在整个持续时间内为页面的初始/加载高度的距离设置动画。

编辑：我接受了溢出建议，它在小提琴中起作用，但如果你注意到，单词并没有在持续时间下降（因为页面更短而变慢），它们仍然下降，好像页面长 3 倍（并且他们以不同的速度下降，这是不应该的）他们都应该表现得像“第一次”一致下降

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:29:57.657

将要

```
body {
    overflow: hidden;
} 
```

做你想要达到的目标？

如果您只想在页面的一部分中执行此效果，则以下操作也可能会起作用：

```
#wordframe {
    overflow: hidden;
    width: 100%;
    height: 100%;
}
.word {
    color: #000;
    font-size: 200%;
    font-family: Gloria Hallelujah;
}​

<div id="wordframe">
    <div class="word" cue="5">first</div>
    <div class="word" cue="10">second</div>
    <div class="word" cue="20">third</div>
    <div class="word" cue="20">fourth</div>
    <div class="word" cue="30">fifth</div>
    <div class="word" cue="35">sixth</div>
    <div class="word" cue="40">seventh</div>
</div> 
```

# php - 异常类是否应该总是被 try catch 捕获？

> ID：12308647
> 
> 赞同：0
> 
> 时间：2012-09-06T21:26:28.743
> 
> 标签：php, exception, exception-handling

总是在 try catch 中捕获基 Exception 类是一种好的编码习惯吗？

```
try
{
    //
    // Piece of code
    //
}
catch (CustomException $my_ex)
{
    // Handle CustomExcepton
}
catch (Exception $other_exceptions)
{
    // Handle all other exceptions
} 
```

如果是这样，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:27:58.813

在 PHP 中，您可以安装一个[全局异常处理程序](http://www.php.net/manual/en/function.set-exception-handler.php)。需要时，您可以在代码中捕获异常，所有未处理的异常都会转到全局异常处理程序。根据你的策略，你决定做什么。

当然，当您决定死亡时，我们会感谢您提供清晰的错误消息和日志。

一般来说，如果您可以从异常中恢复，请使用 try .. catch 块，否则让全局异常处理程序完成他的工作，并且不恢复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:31:10.497

您应该只捕获您现在如何处理的异常。其他人应该冒泡到最后调用方法和一些全局处理程序。

# macos - 如何调试 emacs 的缓慢启动时间？

> ID：12308648
> 
> 赞同：13
> 
> 时间：2012-09-06T21:26:31.017
> 
> 标签：macos, emacs, osx-mountain-lion

我最近买了一台带有 Mountain Lion 的新 Retina MacBook Pro。不幸的是，emacs 在我的新计算机上启动需要很长时间（大约 5 秒）。我尝试安装最新的自制版本的 emacs，但问题仍然存在。我没有 .emacs 文件，所以我对可能导致启动缓慢的原因一无所知。

我可以使用哪些工具来调试 emacs 在启动期间花费的时间？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-08T20:27:25.887

看起来您需要为您的计算机主机名提供一个完全限定的域名（例如，`myretina.local`）；否则，[Emacs 启动会很慢](https://web.archive.org/web/20120428020900/http://web.cecs.pdx.edu/~akshay/2012/01/fix-emacs-slow-start-up-on-fedora-16/)。

您可以通过终端验证您的主机名

```
hostname 
```

你可以设置它

```
sudo scutil --set HostName myretina.local 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-06T23:07:27.477

对于初学者，运行`emacs -Q`（这将启动 Emacs，根本没有启动文件），看看是否仍然很慢。

您可能希望阅读以下内容，其中解释了 Emacs 将默认查找的所有各种可能的文件：

`C-h``i``g` `(emacs) Init File` `RET`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T19:47:58.650

更改主机名对我没有任何作用。对我来说神奇的东西似乎违反直觉，但现在我的 emacs 立即从终端启动。这就是我所做的

```
alias emacs=/Applications/Emacs.app/Contents/MacOS/Emacs --debug-init 
```

但是，从图形界面开始仍然需要几秒钟，有时甚至 15 秒钟。诡异的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-06T23:24:02.803

Emacs 应该在您的设置中立即启动

Mac 构建（来自源代码）

```
% time /Applications/Emacs.app/Contents/MacOS/Emacs --debug-init -eval '(kill-emacs)' -Q
/Applications/Emacs.app/Contents/MacOS/Emacs --debug-init -eval '(kill-emacs)  0.19s user 0.06s system 35% cpu 0.696 total 
```

从 emacsformacosx.com 下载的 NS 版本

```
% time /Volumes/Emacs/Emacs.app/Contents/MacOS/Emacs --debug-init -eval '(kill-emacs)' -Q
/Volumes/Emacs/Emacs.app/Contents/MacOS/Emacs --debug-init -eval  -Q  0.17s user 0.08s system 35% cpu 0.691 total 
```

我不为 Emacs 使用自制软件，但它应该是相似的。你确定你没有加载非标准包吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-03T16:04:32.370

确实有一些东西完全被打破了`emacs`。如果`nameservice`崩溃或路由不正常，或者您的 vpn 隧道已关闭等。

**对于我们系统管理员来说，启动 vi 始终是一种选择：**

```
# time emacs -debug-init -eval '(kill-emacs)' -Q

real    2m5.177s
user    0m0.029s
sys     0m0.024s 
```

此时 vpnc 已经死掉并导致了一些问题（路由和名称服务）。注意超过2分钟！

使用 emacs 30 年后仍然不明白为什么它真的需要解析您的主机名。对于锁定文件，有比这更好的选择。

管理成百上千的机器和虚拟机并设置单个主机文件并不是真正的答案。手动将需要数天/数周并自动生成。它真的和没有一样好。

# asp.net - Asp.net 默认页面不返回 runAllManagedModulesForAllRequests = true

> ID：12308651
> 
> 赞同：1
> 
> 时间：2012-09-06T21:26:46.227
> 
> 标签：asp.net, iis-7, web-config

我已将 MVC 集成到旧的 Web 表单应用程序中。版本 ASP.NET 版本是 4.0。

以下配置将导致在导航到域时默认不加载 Default.aspx 页面。（即[http://www.myfakeeeeeeeeeeeedomain.com/](http://www.myfakeeeeeeeeeeeedomain.com/)）

```
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
  </system.webServer> 
```

但是，如果我将该值切换为 false，则默认情况下，我的 default.aspx 页面将在导航到域时加载，但是……我的 MVC 路由请求将不起作用。如何在正确显示 default.aspx 页面的同时保持 MVC 路由？

注意：“默认页面”选项已在 IIS 7 中正确设置。

如果需要，我可以提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T03:15:11.650

通过查看这篇文章回答了我的问题：[在将 MapPageRoute 添加到 asp.net mvc 项目后，站点停止进入 Home Controller](https://stackoverflow.com/questions/10178276/after-add-mappageroute-to-an-asp-net-mvc-project-the-site-stops-to-enter-in-hom)

我实现的实际代码如下：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.MapPageRoute("DefaultPage", "", "~/Default.aspx", false, null, new RouteValueDictionary { { "outgoing", new CustomWebFormRouteConstraint() } });
        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

    }

    public class CustomWebFormRouteConstraint : IRouteConstraint
    {
        // Only match on incoming requests
        public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
        {
            return routeDirection == RouteDirection.IncomingRequest;
        }
    } 
```

# android - getJSON 和安卓浏览器

> ID：12308654
> 
> 赞同：4
> 
> 时间：2012-09-06T21:27:01.707
> 
> 标签：android, jquery, getjson

我正在尝试通过以下方式执行简单的 JSON 请求：

```
<!DOCTYPE html>
 <html>
 <head>
 <title></title>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js">
 </script>
 <script>
  (function(){
    $.getJSON("http://smart-ip.net/geoip-json?callback=?", function (data) {
     alert(data.host)
     });
   })();
 </script>
 </head>
 <body>
 </body>
 </html> 
```

这在桌面 chrome 和其他浏览器上运行良好，现在我尝试使用 jquery mobile 并尝试了我手机上的所有浏览器，它曾经在 android chrome beta 上运行，但在最终版本中停止，任何想法为什么它没有运行安卓？

**更新：**为更新晚道歉，我发现 Omega Rom 出于某种奇怪的原因正在处理我的 jquery 请求。从 Omega 到 stock rom 来回切换了几次，很明显 Omega rom 导致了奇怪的行为.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:53:45.640

如果您像这样删除自执行语法，它会有所帮助吗？

```
$.getJSON("http://smart-ip.net/geoip-json?callback=?", function (data) {
  // Maybe do something like this to display the data more reliably too:
  $(body).append(data.host);
}); 
```

# iphone - 如何在Objective-C中一个数字中的部分较少的版本号上使用比较？

> ID：12308659
> 
> 赞同：2
> 
> 时间：2012-09-06T21:27:23.807
> 
> 标签：iphone, objective-c, ios

我在[http://snipplr.com/view/2771找到了以下代码](http://snipplr.com/view/2771)

这非常好，几乎正是我想要的，但如果我使用这些值`@"1.4.5", @"10.4"`会产生错误的结果，说第一个数字较低。

**Arghhhh 深夜编码，抱歉，我将 10.4 读为 1.4 :(**

我不确定为什么 compare 有问题，问题是什么？

```
/*
 * compareVersions(@"10.4",             @"10.3"); //             
       returns NSOrderedDescending (1) - aka first number is higher

 * compareVersions(@"10.5",             @"10.5.0"); //           
       returns NSOrderedSame (0) 

 * compareVersions(@"10.4 Build 8L127", @"10.4 Build 8P135"); // 
       returns NSOrderedAscending (-1) - aka first number is lower
 */
NSComparisonResult compareVersions(NSString* leftVersion, NSString* rightVersion)
{
    int i;

    // Break version into fields (separated by '.')
    NSMutableArray *leftFields  = [[NSMutableArray alloc] initWithArray:[leftVersion  componentsSeparatedByString:@"."]];
    NSMutableArray *rightFields = [[NSMutableArray alloc] initWithArray:[rightVersion componentsSeparatedByString:@"."]];

    // Implict ".0" in case version doesn't have the same number of '.'
    if ([leftFields count] < [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [leftFields addObject:@"0"];
        }
    } else if ([leftFields count] > [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [rightFields addObject:@"0"];
        }
    } 
```

.

```
 // Do a numeric comparison on each field
    for(i = 0; i < [leftFields count]; i++) {
        NSComparisonResult result = [[leftFields objectAtIndex:i] compare:[rightFields objectAtIndex:i] options:NSNumericSearch];
        if (result != NSOrderedSame) {
            [leftFields release];
            [rightFields release];
            return result;
        }
    }

    [leftFields release];
    [rightFields release];  
    return NSOrderedSame;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:33:19.523

[我今天早些时候发布了这个，但它没有被选为答案，它可能更适合你的问题。还有其他技术，您可以[在此处](https://stackoverflow.com/q/3339722/1633251)和[此处](https://stackoverflow.com/q/12300794/1633251)查看其他解决方案。]

我所做的是把那个字符串分解成组件：

```
NSArray *array = [myVersion componentsSeparatedByCharactersInSet:@"."];

NSInteger value = 0;
NSInteger multiplier = 1000000;
for(NSString *n in array) {
  value += [n integerValue] * multiplier;
  multiplier /= 100;
} 
```

这样做是为您提供一个可用于比较的标准化值，并且通常会比较具有不同“深度”的版本，即 1.5 和 1.5.2。

如果您有超过 100 个点发布（即任何数字大于 100），它就会中断，并且还会声明 1.5.0 == 1.5。也就是说，它简短、甜美且易于使用。

编辑：如果您使用 NSString 'compare:options:' 方法，请确保您的字符串修饰得很好：

```
 s1 = @"1.";
    s2 = @"1";
    NSLog(@"Compare %@ to %@ result %d", s1, s2, (int)[s1 compare:s2 options:NSNumericSearch]);
    s1 = @"20.20.0";
    s2 = @"20.20";
    NSLog(@"Compare %@ to %@ result %d", s1, s2, (int)[s1 compare:s2 options:NSNumericSearch]);

2012-09-06 11:26:24.793 xxx[59804:f803] Compare 1\. to 1 result 1
2012-09-06 11:26:24.794 xxx[59804:f803] Compare 20.20.0 to 20.20 result 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:55:34.990

Mac 的 Sparkle 框架是开源的，它有一些简洁的版本检查代码，你可以看看：[https ://github.com/andymatuschak/Sparkle/blob/master/SUStandardVersionComparator.m](https://github.com/andymatuschak/Sparkle/blob/master/SUStandardVersionComparator.m)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:57:33.313

所以你想比较 10.5 和 1.4.6 使得 10.5 被视为 0.10.5

如果是这种情况，您需要在分隔的版本号的左侧添加“0”数组项

```
NSComparisonResult compareVersions(NSString* leftVersion, NSString* rightVersion)
{
    int i;

    // Break version into fields (separated by '.')
    NSMutableArray *leftFields  = [[NSMutableArray alloc] initWithArray:[leftVersion  componentsSeparatedByString:@"."]];
    NSMutableArray *rightFields = [[NSMutableArray alloc] initWithArray:[rightVersion componentsSeparatedByString:@"."]];

    // Implict "0" in case version doesn't have the same number of '.'
    if ([leftFields count] < [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [leftFields insertObject:@"0" atIndex:0];
        }
    } else if ([leftFields count] > [rightFields count]) {
        while ([leftFields count] != [rightFields count]) {
            [rightFields insertObject:@"0" atIndex:0];
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T22:52:59.407

我不是 100% 确定你在问什么，但如果你想对数字进行排序，不管有多少句点“。” 在您可以`NSSortDescriptor`在操作系统版本字典中使用的数字中：

```
NSArray *originalArray = [NSArray arrayWithObjects:
              [NSDictionary dictionaryWithObject:@"10.4.5" forKey:@"version"],
              [NSDictionary dictionaryWithObject:@"10.5.6" forKey:@"version"],
              [NSDictionary dictionaryWithObject:@"10.6.8" forKey:@"version"],
              [NSDictionary dictionaryWithObject:@"10.8" forKey:@"version"],
              [NSDictionary dictionaryWithObject:@"10.7.1" forKey:@"version"],
              [NSDictionary dictionaryWithObject:@"10.8.2" forKey:@"version"],
              nil];

NSSortDescriptor *sort = [[NSSortDescriptor alloc] initWithKey:@"version" ascending:true];
NSArray *sortedArray = [originalArray sortedArrayUsingDescriptors:[NSArray arrayWithObject:sort]];
NSLog(@"Lowest to highest: %@", sortedArray);
NSLog(@"Highest OS version: %@",[[sortedArray objectAtIndex:[sortedArray indexOfObject:[sortedArray lastObject]]] objectForKey:@"version"]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T23:17:07.580

我的感觉是第一个数字组总是最重要的，所以 10.anything 大于 9.anything.anything。如果我是对的，那么解决方案是用零替换点，并用零填充右侧的较短字符串以匹配较长字符串的长度：

```
e.g.
9.4   --->  90400  (padded on the right with 00)
8.6.7 --->  80607 
```

这样做的好处是，如果我对要求有误，可以通过在右侧填充较短的字符串来轻松修复算法。

```
- (NSComparisonResult)compareVersion:(NSString *)vA withVersion:(NSString *)vB {

    NSString *vAPadded = [vA stringByReplacingOccurrencesOfString:@"." withString:@"0"];
    NSString *vBPadded = [vB stringByReplacingOccurrencesOfString:@"." withString:@"0"];

    while (vAPadded.length < vBPadded.length)
        vAPadded = [vAPadded stringByAppendingString:@"0"];

    while (vBPadded.length < vAPadded.length)
        vBPadded = [vBPadded stringByAppendingString:@"0"];

    return [vAPadded intValue] - [vBPadded intValue];
} 
```

如果我对有效数字的要求倒退，请像这样更改焊盘：

```
vAPadded = [@"0" stringByAppendingString:vAPadded]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T05:11:18.510

为什么不使用 NSString compare:options:NSNumericSearch

```
NSString *sysVer = [[UIDevice currentDevice] systemVersion];
NSLog(@"%@,%d,%d,%d", sysVer, [sysVer compare:@"1.0" options: NSNumericSearch], [sysVer compare:@"6.0" options: NSNumericSearch],[sysVer compare:@"10.0" options: NSNumericSearch]);
if ([sysVer compare:@"6.0" options: NSNumericSearch]>=NSOrderedSame) {
    NSLog(@"ios 6");
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-31T12:08:45.537

您可以使用我的 Version 类来帮助您将版本字符串解析为 Version 对象以便于比较。它支持major.minor.release.build等4个字段版本号，所有字段都是可选的。此外，它有一个比较方法来比较两个版本对象。

[https://github.com/polatolu/version-ios](https://github.com/polatolu/version-ios)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-13T17:05:33.053

VersionComparator 类很简单

[https://github.com/danhanly/VersionComparator](https://github.com/danhanly/VersionComparator)

BOOL 更大 = [VersionComparator isVersion:@"2.0.0" greaterThanVersion:@"1.1.0"];

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-01T18:41:25.760

正如这篇文章中所回答的那样；[比较 Objective-C 中的版本号](https://stackoverflow.com/questions/1978456/compare-version-numbers-in-objective-c)

查看我在 github 上实现简单版本检查的 NSString 类别；[https://github.com/stijnster/NSString-compareToVersion](https://github.com/stijnster/NSString-compareToVersion)

```
[@"1.2.2.4" compareToVersion:@"1.2.2.5"]; 
```

这将返回一个比使用更准确的**NSComparisonResult ；**

```
[@"1.2.2" compare:@"1.2.2.5" options:NSNumericSearch] 
```

还添加了助手；

```
[@"1.2.2.4" isOlderThanVersion:@"1.2.2.5"];
[@"1.2.2.4" isNewerThanVersion:@"1.2.2.5"];
[@"1.2.2.4" isEqualToVersion:@"1.2.2.5"];
[@"1.2.2.4" isEqualOrOlderThanVersion:@"1.2.2.5"];
[@"1.2.2.4" isEqualOrNewerThanVersion:@"1.2.2.5"]; 
```

# php - 为什么在使用文件 Mtime (PHP) 时插入 SQL Server 会失败，但在使用 Ctime 时不会？

> ID：12308660
> 
> 赞同：0
> 
> 时间：2012-09-06T21:27:23.860
> 
> 标签：php, sql-server, file-io, windows-server-2003

我正在尝试遍历目录（使用 PHP）并获取文件的修改和创建时间，根据需要更新或插入 SQL Server 2003 表。

我正在使用 PHP`DirectoryIterator`来做到这一点，*如果*我只使用对象的`getCTime()`函数，它就可以完美地工作。如果我移动到包含或改为使用 objects`getMTime()`方法，SQL Server 在插入/更新时会向我抛出一个错误：

> 22003：[Microsoft][SQL Server Native Client 10.0][SQL Server]将表达式转换为数据类型 smalldatetime 时出现算术溢出错误。

此错误仅在使用对象`getMTime()`方法时发生。Testdir 里面有两个文件，显然只是为了测试。

我已经通过谷歌搜索了这方面的帮助，尤其是在 Stackoverflow（[一](https://stackoverflow.com/questions/12124716/arithmetic-overflow-error-converting-expression-to-data-type-datetime-int64-to)、[二](https://stackoverflow.com/questions/8289310/arithmetic-overflow-error-converting-expression-to-data-type-int)、[三](https://stackoverflow.com/questions/6253561/arithmetic-overflow-error-converting-expression-to-data-type-datetime)）上。然而，那些 StackOverflow 问题是针对一个`SELECT`语句的，并且说是使用`CONVERT`SQL 的函数。我发现的唯一半相关的项目是[一篇博客文章](http://computerproblemsolutions.blogspot.com/2009/08/arithmetic-overflow-error-converting.html)，它说要确保 SQL 用户正确设置了默认语言。在我的用户案例中，它被正确设置为“英语”。

这是整个函数和后续调用：

```
function fillArrayWithFileNodes( DirectoryIterator $dir )
{
  $data = array();
  require('connecttodbfile');
  clearstatcache();

  foreach ( $dir as $node )
  {
    if ( $node->isDir() && !$node->isDot() )
    {
      $data[$node->getFilename()] = fillArrayWithFileNodes( new DirectoryIterator( $node->getPathname() ) );
    }
    else if ( $node->isFile() )
    {

        $filename = $node->getFilename();
        //Comment this out below and use CTime, Update works!

        //$file_time = date('Y-d-m H:i:s', $node->getMTime());

        //Comment this out and use MTime, Update DOES NOT WORK!
        $file_time = date('Y-d-m H:i:s', $node->getCTime()); 

        //Debug here, make sure I'm getting expected values 

        echo sprintf("Mtime (%s): %s - %s<br />Ctime (%s):  %s - %s<br /> <br />", gettype($node->getMTime()), $node->getMTime(), gettype($node->getMTime()), date('Y-d-m H:i:s', $node->getMTime()), $node->getCTime(), date('Y-d-m H:i:s', $node->getCTime()));

        $data[] = array('time'=>$file_time);

        try {

        $sQuery = <<<EOD
BEGIN TRAN
UPDATE files SET file_time=:ftime WHERE file_name=:fname

IF @@ROWCOUNT = 0 and @@ERROR = 0
   BEGIN
    INSERT INTO files (file_name,file_time) VALUES (:f_name, :f_time)
   END
COMMIT TRAN
EOD;

        $statm = $conn->prepare($sQuery);

        //PDO doesn't like it if we name repeat variables the same. So even if you use the same variable more than once in your query, PDO says you need the exact number of variables in the execute array as is in your statement, all unique names.

        $statm->execute(array(':ftime'=> $file_time, ':fname'=>$filename,':f_time'=> $file_time, ':f_name'=>$filename));

    } catch(PDOException $err) {//SQL got mad at us. Figure out why.
        echo $statm->errorCode() . " : ";
        $error = $statm->errorInfo();
        print_r( $error[2]);
        exit(1);
     }
    }
  }
  return $data;
}

$fileData = fillArrayWithFileNodes( new DirectoryIterator( 'C:\testdir' ) );

echo "<pre>";

print_r($fileData);

echo "</pre>"; 
```

当此代码`mtime`作为`$file_time`（通过网络浏览器）运行时，我得到以下输出：

```
Mtime (integer): 1311599068 - 2011-25-07 08:04:28 
Ctime (integer): 1346941012 - 2012-06-09 09:16:52

22003 : [Microsoft][SQL Server Native Client 10.0][SQL Server]Arithmetic overflow error converting expression to data type smalldatetime. 
```

如果我`$file_time`改为使用`getCTime()`，则输出完成且没有错误：

```
Mtime (integer): 1311599068 - 2011-25-07 08:04:28 
Ctime (integer): 1346941012 - 2012-06-09 09:16:52
Mtime (integer): 1265983000 - 2010-12-02 07:56:40 
Ctime (integer): 1346941018 - 2012-06-09 09:16:58

Array (
    [0] => Array
        (
            [time] => 2012-06-09 09:16:52
        )

    [1] => Array
        (
            [time] => 2012-06-09 09:16:58
        )

) 
```

即使在 StackOverflow 问题（上面链接）中指定的方法可以同时正确上传`mtime`和`ctime`上传，我的问题仍然是**为什么使用`ctime`没有任何修改但没有任何修改`mtime`？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T00:57:24.477

因为 SQL Server 需要 YYYY-MM-DD，而在您的情况下，您发送的是 YYYY-DD-MM。mdate 为您提供 2011-25-07，这不是 YYYY-MM-DD 的有效日期，因为 25 不是有效月份。cdate 正在工作只是偶然，因为它返回 2012-06-09 并且 06 是有效月份。您需要更改格式或更改服务器上的日期本地化。

# javascript - Django - Generating csv for dygrapgs

> ID：12308662
> 
> 赞同：2
> 
> 时间：2012-09-06T21:27:34.053
> 
> 标签：javascript, python, django, dygraphs

For my project, I am trying to generate a csv-file to be read in dygraphs. Dygraphs is a Javascript library that graphs a csv-file. In the Dygraphs' documentation, it says when you specify a file, it sends an XHR to get the csv. So, in my views, I interpreted that as I need a

```
if request.is_ajax(): 
```

But is that really what it means?

My problem is that my dygraphs won't display on the page. The error message that I'm getting from Firebug is:

```
"NetworkError: 404 Not Found - http://www.albedo.csrcdev.com/VAM/Appearance/VAMStyleSheet.css
"NetworkError: 404 Not Found - http://www.albedo.csrcdev.com/VAM/3_0_3/VAM.js/
ReferenceError: VAM_ValSumFmtBullet is not defined 
ReferenceError: VAM_GetById is not defined 
```

I don't really know what that is telling me, but when I had a static csv file, the graph did display so I'm pretty sure it's just not grabbing the dynamically created csv file.

Any help is appreciated.

Thanks

* * *

```
# The function does work, when I type the url manually, it prompts me 
# to download the csv and is all correct. 

def dygraphs_generate_csv( request, year=None ):
    if request is_ajax():
        if year is None:
            year = datetime.today().year

        entries = DataEntry.objects.all().filter(observation_Date__year=year)

        return render( request, 'pages/output.csv',
                {'entries': entries},
                content_type='text/csv'
            ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:46:33.243

这些错误与您的 CSV 生成无关。如果您的 JS/CSS 不是 404，您的页面可能会更正确地呈现。

如果 CSV 是一个挑战，您还可以向 dygraphs 传递一个原生 JavaScript 数组。有关详细信息，请参阅[http://dygraphs.com/data.html](http://dygraphs.com/data.html)。

# jquery - jquery isotope Hash history with jQuery BBQ

> ID：12308670
> 
> 赞同：4
> 
> 时间：2012-09-06T21:28:11.363
> 
> 标签：jquery, jquery-isotope

I'm playing around with [isotope](http://isotope.metafizzy.co/index.html) for filtering and it's great. When the user clicks on one of the images it shows a different page (detail page), but the menu for filtering its still present. Now what I want is when the user click again on one of the possibilities, he goes back to main page but but already with the filtred results.

I already read this page ( [http://isotope.metafizzy.co/docs/hash-history-jquery-bbq.html](http://isotope.metafizzy.co/docs/hash-history-jquery-bbq.html) ) but I confess that I didn't understood many things

I have the following HTML code, as they reccomended:

```
div id="leftMenu">

            <span><a href="#filter=*" >All Menus</a></span>
            <span><a href="#filter=.pizza" >Pizza </a></span>
            <span><a href="#filter=.soda" >Soda </a></span>
            <span><a href="#filter=.popcorn" >PopCorn</a></span>
            <span><a href="#filter=.beer" >Beer</a></span>
         </div> 
```

and the followin Js code

```
$('#leftMenu span a').click(function() {
        // get href attr, remove leading #
        var href = $(this).attr('href').replace(/^#/, ''),
        // convert href into object
        // i.e. 'filter=.inner-transition' -> { filter: '.inner-transition' }
        option = $.deparam(href);
        // set hash, triggers hashchange on window
        console.log('value de href: '+href+ ' || option: '+option);
        $.bbq.pushState(recursiveDecoded);

        return false;
    }); 
```

But I got an error at the depram function. It tells me that $.depram is not a function

Do I have to link an other extra file for read the depram method??

Can anyone help me how to accomplish or understand??

many thanks

**EDIT - My Progress** I found two extra js files, I linked my project to them and with the following code

```
$('#leftMenu span a').click(function() {
        // get href attr, remove leading #
        var href = $(this).attr('href').replace(/^#/, ''),
        // convert href into object
        // i.e. 'filter=.inner-transition' -> { filter: '.inner-transition' }
        option = $.deparam(href);
        // set hash, triggers hashchange on window
        $.bbq.pushState(option);
        console.log("--> " +option );
        //return false;
    });     

$(window).bind('hashchange', function(event) {
    alert('Hello');
    // get options object from hash
    var hashOptions = $.deparam.fragment();
    console.log(hashOptions);
    // apply options from hash
    $('#leftMenu span a').isotope(hashOptions);
})
// trigger hashchange to capture any hash data on init
.trigger('hashchange'); 
```

I don't got any errors. BUT it doesn't the filter.

I can get the alert('Hello').

Any ideas??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T18:55:40.670

我找到了解决方案。我的 js 代码有错误。

这是代码

```
$container.isotope({});

    $('#leftMenu span a').click(function() {
        // get href attr, remove leading #
        var href = $(this).attr('href').replace(/^#/, ''),
        // convert href into object
        // i.e. 'filter=.inner-transition' -> { filter: '.inner-transition' }
        option = $.deparam(href);
        // set hash, triggers hashchange on window
        $.bbq.pushState(option);
        return false;
    }); 

    $(window).bind('hashchange', function(event) {
        // get options object from hash
        var hashOptions = $.deparam.fragment();
        // apply options from hash
         $container.isotope(hashOptions);
    })
    // trigger hashchange to capture any hash data on init
    .trigger('hashchange'); 
```

我认为 the 指的 `$container.isotope(hashOptions);`是菜单项，但实际上它指的是结果容器。

# .net - EF Code First: Foreign Key With Where Clause?

> ID：12308672
> 
> 赞同：2
> 
> 时间：2012-09-06T21:28:28.040
> 
> 标签：.net, linq, entity-framework, linq-to-entities, ef-code-first

Given entities like these:

```
public class Entity
{
    public int Id { get; set; }
    public ICollection<EntityTwo> EntityTwos { get; set; }
}

public class EntityTwo
{
    public int Id { get; set; }
    public int TypeId { get; set; }
    public int EntityId { get; set; }
} 
```

Normally, `Entity.EntityTwos` would return all EntityTwo entities where `EntityId` equals `Entity.Id`. Is it possible to rig up the model so that property returns entities that join on that Id, but also have `EntityTwo.TypeId == 2` (essentially adding a where clause to the join)?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:59:01.750

您必须进行手动连接，而不是依赖导航属性来创建隐含连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:43:22.610

也许你可以通过不同的方式来解决这个问题。您的加入密钥将是：

```
{ TypeId, Id } equals { 2, Id } 
```

也许可以使用常量作为两个复合键之一？将 Ladislav 的 [复合键视为外键](https://stackoverflow.com/questions/5436731/composite-key-as-foreign-key)答案。

# php - 具有多个叶节点的 PHP 扁平化数组

> ID：12308673
> 
> 赞同：1
> 
> 时间：2012-09-06T21:29:01.580
> 
> 标签：php, multidimensional-array

将具有多个叶节点的数组展平以使每个叶的完整路径都是不同的返回的最佳方法是什么？

```
array("Object"=>array("Properties"=>array(1, 2))); 
```

屈服

1.  对象.属性.1
2.  对象.属性.2

我能够展平到 Object.Properties.1 但 2 没有得到递归函数处理：

```
function flattenArray($prefix, $array)
{
    $result = array();
    foreach ($array as $key => $value)
    {
        if (is_array($value))
            $result = array_merge($result, flattenArray($prefix . $key . '.', $value));
        else
            $result[$prefix . $key] = $value;
    }   
    return $result;
} 
```

我认为在预期多个叶节点时自上而下将不起作用，因此要么需要某种类型的自下而上处理，要么需要一种为每个叶和进程复制数组的方法（尽管这似乎完全低效）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:00:48.193

```
function flatten(array $data, $separator = '.') {
  $result = array();
  $stack = array();
  $path = null;

  reset($data);
  while (!empty($data)) {
    $key = key($data);
    $element = $data[$key];
    unset($data[$key]);  
    if (is_array($element)) {
      if (!empty($data)) {
        $stack[] = array($data, $path);
      }
      $data = $element;
      $path .= $key . $separator;
    } else {
      $result[$path . $key] = $element;
    }

    if (empty($data) && !empty($stack)) {
      list($data, $path) = array_pop($stack);
    }
  }
  return $result;
}

var_dump(flatten(array("Object"=>array("Properties"=>array(1, 2))))); 
```

输出：

```
array(2) {
  ["Object.Properties.0"]=>
  int(1)
  ["Object.Properties.1"]=>
  int(2)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:34:07.827

使用[Kdyby 框架](https://github.com/Kdyby/Framework/blob/master/libs/Kdyby/Tools/Arrays.php#L145)中的函数 flatMapAssoc() ：

```
$flattened= array();
flatMapAssoc($array, function ($value, $keys) use (&$flattened) {
        $flattened[implode('.', $keys)] = $value;
});

/**
 * @param array|\Traversable $array
 * @param callable $callback
 * @return array
 */
    function flatMapAssoc($array, $callback)
{
    $callback = callback($callback);
    $result = array();
    $walker = function ($array, $keys = array()) use (&$walker, &$result, $callback) {
        foreach ($array as $key => $value) {
            $currentKeys = $keys + array(count($keys) => $key);
            if (is_array($value)) {
                $walker($value, $currentKeys);
                continue;
            }
            $result[] = $callback($value, $currentKeys);
        }

        return $result;
    };

    return $walker($array);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T22:37:52.570

我将使用包装函数来隐藏实现细节（前缀参数）并添加一个 if 分支来测试空数组。最后，在简单叶子的情况下，您应该使用`$value`变量而不是那个`$key`。

```
$x = array("Object"=>array("Properties"=>array(1, 2), "test"=>array(), "post"));

function flatten ($array) {
    return flattenArray('',$array);
}

function flattenArray($prefix, $array) {
    $result = array();
    foreach ($array as $key => $value) {
        if (is_array($value)) {
            if(count($value)) {
                $result = array_merge($result, flattenArray($prefix."$key.", $value));
            } else {
                $result[] = "$prefix$key";
            }
        } else {
            $result[] = "$prefix$value";
        }
    }   
    return $result;
}

echo join("\n", flatten($x)); 
```

如果你想模仿树结构，也许你可以使用不同的数组结构。像这样的东西：

```
$y = array ("Object", 
            array("Properties", 1, 2),
            "test",
            "post"
); 
```

并且 flattenArray 变为：

```
function flattenArray($prefix, $array) {
    $result = array();
    $prefix .=array_shift($array).'.';
    foreach ($array as $value) {
        if (is_array($value)) {
            $result = array_merge($result, flattenArray($prefix, $value));
        } else {
            $result[] = "$prefix$value";
        }
    }   
    return $result;
} 
```

# java - When do instance variables get initialized and values assigned?

> ID：12308674
> 
> 赞同：13
> 
> 时间：2012-09-06T21:29:10.247
> 
> 标签：java, object, inheritance, abstract-class, instance

When does the instance variable get initialized? Is it after the constructor block is done or before it?

Consider this example:

```
public abstract class Parent {

 public Parent(){
   System.out.println("Parent Constructor");
   init();
 }

 public void init(){
   System.out.println("parent Init()");
 }
} 
```

* * *

```
public class Child extends Parent {

private Integer attribute1;
private Integer attribute2 = null;

public Child(){
    super();
    System.out.println("Child Constructor");
}

public void init(){
    System.out.println("Child init()");
    super.init();
    attribute1 = new Integer(100);
    attribute2 = new Integer(200);
}

public void print(){
    System.out.println("attribute 1 : " +attribute1);
    System.out.println("attribute 2 : " +attribute2);
}
} 
```

* * *

```
public class Tester {

public static void main(String[] args) {
    Parent c = new Child();
    ((Child)c).print();

}
} 
```

* * *

# OUTPUT:

Parent Constructor

Child init()

parent Init()

Child Constructor

attribute 1 : 100

attribute 2 : null

* * *

1.  When are the memory for the atribute 1 & 2 allocated in the heap ?

2.  Curious to know why is attribute 2 is NULL ?

3.  Are there any design flaws?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-06T21:35:54.063

> 何时在堆中分配属性 1 和 2 的内存？

`new`在调用运算符时，在`java.lang.Object`进入构造函数之前，为整个对象分配内存。内存是为 中的单个`Integer`实例分配的`init`，但是没有必要为单个属性分配内存——只有整个对象。

> 想知道为什么属性 2 是 NULL ？

该`init`方法在超级构造函数中被调用，因此`attribute2`被赋值`new Integer(200)`，然后子类构造函数被调用，它按照属性初始值设定项在源代码中出现的顺序应用它们。这条线

```
private Integer attribute2 = null; 
```

覆盖由`init()`to分配的值`null`。

如果您将呼叫添加到

```
 System.out.println("attribute 2 : " +attribute2); 
```

在您致电`super();`之后，这将变得显而易见。

> 有没有设计缺陷？

在基类完成初始化之前调用子类方法是危险的。子类可能依赖其基类的不变量来保护自己的不变量，如果基类构造函数尚未完成，则其不变量可能不成立。

这也可能使 C++ 程序员等感到困惑，他们希望`init`从基类调用来调用基类的版本，因为 C++ 在输入构造函数时重写了 vtable 指针。

有关所有血腥细节，请参阅[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.5)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T22:37:14.990

* * *

使用此处提供的答案和链接后，我的摘要观察结果如下：

* * *

这是流程：

1.  输入子类构造函数。孩子（）{ ... }

2.  调用显式 super() [调用父类构造函数]。

3.  输入 Parent() { ... } 类构造函数

4.  调用隐式 super() [调用 Object 类构造函数]

5.  输入 Object(){ } （没有超级构造函数调用）

6.  对超类构造函数的递归调用到此结束。

7.  返回 Object 类构造函数

8.  现在在父类构造函数中......父类的实例初始化器和实例变量初始化器被执行。

9.  父类构造函数的其余部分被执行并返回

10.  现在在 Child 类构造函数中。Child 类的实例初始化器和实例变量初始化器被执行。

11.  然后执行 Child 类构造函数的其余部分并完成对象初始化过程。

* * *

**原因属性 2 为 NULL，因为**

1.  在第 9 步为属性 2 分配了一个值 200。
2.  但在步骤 10 中被覆盖为 NULL

**有没有设计缺陷？**

正如 Fabian Barney 提到的 ::::: 在构造函数中调用可以被子类覆盖的方法通常是不好的做法。

**何时在堆中分配属性 1 和 2 的内存？** 还在摸索中。感谢任何指针。

感谢迈克和费边

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-17T12:11:16.717

请参阅下面说明初始化流程的代码及其控制台输出。请注意，Parent 类的“在构造对象时”方法和属性根本不会被使用（调用）。

## 代码

```
class Parent{
   static{ System.out.println("Static Parent initialization"); }

   int i=1234;
   {  System.out.println("Parent's instance initializer running");
      print("executed from Parent's instance initializer");
      update(1);
   }

   Parent() {
      System.out.println("Parent's constructor running");
      print("executed from Parent's constructor");
      update(2);
   }

   void print(String note) { System.out.println("never executed"); }
   void update(int newI){ System.out.println("never executed"); }
} 
```

* * *

```
class Child extends Parent{
   static{ System.out.println("Static Child initialization"); }

   int i = 3;
   {System.out.println("Child's instance initializer; i=" + i); }

   Child(){super(); i=4; System.out.println("Child's constructor running. Setting i to 4");}

   void print(String note) { System.out.println("print(): '"+note.toUpperCase()+"' ; i="+i); }
   void update(int newI){i=newI;System.out.println("update("+newI+"): After update i="+i);}
} 
```

* * *

```
class Context {
   public static void main(String[] args) {
      Parent parent = new Child();
      System.out.println("In main: child's i="+((Child)parent).i);
      System.out.println("In main: parent's i=" +parent.i);
   }
} 
```

## 输出

> 静态父初始化
> 
> 静态子初始化
> 
> 父实例初始化程序运行
> 
> print(): '从父实例初始化器中执行' ; 我=0
> 
> 更新（1）：更新后 i=1
> 
> 父母的构造函数运行
> 
> print(): '从父构造函数中执行' ; 我=1
> 
> 更新（2）：更新后 i=2
> 
> Child的实例初始化器；我=3
> 
> 孩子的构造函数正在运行。将 i 设置为 4
> 
> 主要：孩子的 i=4
> 
> 主要是：父母的 i=1234

# cordova - Xtify Cordova 未在应用程序中接收 gcm 推送（仅在从推送启动时）

> ID：12308681
> 
> 赞同：0
> 
> 时间：2012-09-06T21:29:46.147
> 
> 标签：cordova, google-cloud-messaging, xtify

新下载的 XtifyCordovaSample 1.3.1 - 正确配置并接收 gcm 推送消息，但是 cordova (javascript) 仅在从通知中心启动时接收它们。

我希望示例“收到通知”即使在应用程序打开时也会使用推送消息内容进行更新。

任何提示还是设计使然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:12:57.330

这是设计使然，如果您只想在应用程序打开时接收通知，您需要在扩展 DroidGap 的活动中进行以下操作：

```
package com.xtify.cordova.samples;

import android.content.Context;
import android.content.IntentFilter;
import android.os.Bundle;

import com.xtify.cordova.XtifyCordovaPlugin;
import com.xtify.sdk.api.XtifyBroadcastReceiver;

public class MainActivity extends org.apache.cordova.DroidGap {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.loadUrl("file:///android_asset/www/index.html");
    }

    @Override
    protected void onResume() {
        super.onResume();
        this.registerReceiver(this.xtifyReceiver, new IntentFilter(
                "com.xtify.sdk.NOTIFIER"));
    }

    @Override
    protected void onPause() {
        super.onPause();
        this.unregisterReceiver(this.xtifyReceiver);
    }

    private XtifyBroadcastReceiver xtifyReceiver = new XtifyBroadcastReceiver() {
        @Override
        protected void onRegistered(Context arg0) {
            // no-op
        }

        @Override
        protected void onMessage(Context arg0, Bundle msgExtras) {
            XtifyCordovaPlugin.processActivityExtras(msgExtras,
                    MainActivity.this);
        }

        @Override
        protected void onC2dmError(Context arg0, String arg1) {
            // no-op
        }
    };
} 
```

您还需要将 com.xtify.cordova.XtifyCordovaPlugin.processActivityExtras 方法修改为以下内容：

```
public static void processActivityExtras(Bundle msgExtras, DroidGap dg) {
    if (msgExtras != null && (msgExtras.getString("com.xtify.sdk.NOTIFICATION_TITLE") != null)) {
        try {
            JSONObject data = new JSONObject();
            for (String key : msgExtras.keySet()) {
                data.put(key, msgExtras.getString(key));
            }
            Context context = dg.getApplicationContext().getApplicationContext();
            String eventCallBackName = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE).getString(KEY_CALLBACK, "");
            String js = "javascript:" + eventCallBackName + "(" + data.toString() + ")";
            dg.sendJavascript(js);
        } catch (JSONException e) {
            Log.e(TAG, "Error processing activity extras", e);
        }
    }
} 
```

还要确保在 Xtify 控制台或 Push API 中将通知操作设置为***NONE 。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T13:53:30.233

这是用于在前台运行的应用程序中接收推送通知的 hackish 代码（对有效负载数据有用..）

（从 xtify cordova 样本工作）

在@Override public void onCreate 之前添加：

```
private static MainActivity single;
public static MainActivity get() { return single; }

public MainActivity() {
    super();
    single = this;
} 
```

这使我们能够调用：

XtifyCordovaPlugin.processActivityExtras(msgExtras, MainActivity.get());

在 XtifyNotifier.java onMessage 函数中.. 因此在前台接收推送并传递给cordova/javascript..

# knockout.js - How do I fill a ko.observerablearray from a rest call based on user input (jsfiddle includer)

> ID：12308685
> 
> 赞同：0
> 
> 时间：2012-09-06T21:30:00.137
> 
> 标签：knockout.js, knockout-mapping-plugin

I'm new to Knokout. How can I fill an observable array in my view model when a user clicks a button. The object from the server will be large , so I want to use ko.mapping to make them observables.

I have a jsfiddle here: [http://jsfiddle.net/russellgove/UXbnz/](http://jsfiddle.net/russellgove/UXbnz/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:41:23.297

**更新小提琴：http: [//jsfiddle.net/UXbnz/5/](http://jsfiddle.net/UXbnz/5/)**

用于使用`ko.mapping.fromJS(FrimServer, {}, this.trades);`来自服务器的新数据更新您的 observableArray。

我还冒昧地清理了你的小提琴。

1.  在 JavaScript 中定义 ViewModel 时使用`var self = this`是常见的做法。这是为了避免关闭和范围的问题。
2.  `<label>`用元素替换`<span>`元素。`<label>`专门用于为输入元素分配标签。
3.  将对敲除文件的引用移至托管资源。这是在 jsFiddle 中引用外部库的适当方式
4.  为了清晰起见，添加了一些样式和额外元素。
5.  扩展数据和显示数据以展示可能的场景。

# c# - BindingList and checkedListBox

> ID：12308689
> 
> 赞同：0
> 
> 时间：2012-09-06T21:30:22.970
> 
> 标签：c#, bindinglist

I'm using a BindingList bound to a checkedListBox which contains FileInfo objects. I want to load an image into a PictureBox when the checkedListBox_SelectedIndexChanged event is fired, since each FileInfo object represents an image file.

My problem is that I can't figure out how to access the FullName property of a FileInfo object from the object selected in the checkedLisBox.

Any help will be appreciated :) Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:40:20.943

您需要将所选对象转换为 FileInfo：

```
String Fullname = "";
FileInfo Info = checkedListBox1.SelectedItem as FileInfo;
if (Info != null)
{
    Fullname = Info.FullName;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:33:38.497

您必须将 checkedListBox.SelectedItem 强制转换为 FileInfo 并在 SelectedIndexChanged 事件处理程序中读取其 FullName。

# javascript - 如何将参数从 JS 传递到 rails3 控制器

> ID：12308694
> 
> 赞同：0
> 
> 时间：2012-09-06T21:30:49.170
> 
> 标签：javascript, ruby-on-rails-3, jquery

这是我的 JS.coffee 代码：

```
fetchselect =(val) ->
 $.ajax(url: '/firstpages/page', dataType: 'json', par_id: val )

$('.homeNav').find('.unactive').click ->
 id = $(this).attr('id')
 fetchselect(id) 
```

这是我的控制器代码：

```
def page
@select = Firstpage.where(:pid=>params[:par_id])

 respond_to do |format|
   format.html # page.html.erb
   format.js { render :layout => false }
   format.json { render :json => @select }
end 
```

它无法将参数传递给@select，当我点击 $('.homeNav') 时，日志告诉我：

在 2012-09-07 05:27:07 +0800 开始 GET "/firstpages/page" for 127.0.0.1 +0800 由 FirstpagesController#page 作为 JSON 第一页加载 (0.2ms) 选择 "firstpages".* FROM "firstpages" WHERE " firstpages"."pid" IS NULL Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.2ms)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:48:37.813

看起来问题出在实际的ajax请求中。尝试：

```
$.ajax({
  type: "POST",
  url: '/firstpages/page',
  dataType: 'json',
  data: {par_id : val})
}) 
```

有关更多示例，请查看[jQuery $.ajax 文档](http://api.jquery.com/jQuery.ajax/#sending-data-to-server)。

# nsstring - NSRange returning nil in simulator

> ID：12308695
> 
> 赞同：1
> 
> 时间：2012-09-06T21:30:54.303
> 
> 标签：nsstring, nsmutablearray, null, nsrange

I am making a search function and it works fine on an iphone and the iphone simulator but not the ipad simulator. When I enter my value to search it gives the error basically saying the NSRange is nil:

'NSInvalidArgumentException', reason: '*** -[NSCFString rangeOfString:options:range:locale:]: nil argument'

Heres what I have.

```
for (int i = 0, c = names.count; i < c; ++i) {
   sFirst = [firstArray objectAtIndex:i];
   sSecond = [secondArray objectAtIndex:i];
    NSRange result = [sFirst rangeOfString:searchText options:NSCaseInsensitiveSearch];
    NSRange r = [sSecond rangeOfString:searchText options:NSCaseInsensitiveSearch];
    if (result.location != NSNotFound) {
        [searchedFirst addObject:sFirst];
        [searchedSecond addObject:sSecond];
    }    
    if (r.location != NSNotFound) {
        [searchedFirst addObject:sFirst];
        [searchedSecond addObject:sSecond];
    }    

} 
```

Can anyone explain to me why this is happening, or is there anything I can do about this problem? Should I not worry about it since its working fine on an actual device?

**SOLVED** I guess since i was calling the searchText (or searchBar.text) without changing the value into a string first it returned nil. So I just declared a string in the header file.

```
stringValue = searchBar.text; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:36:55.697

NSRange 不能为 nil - 它不是对象，甚至不是指针。

这很可能`searchText`是零。

如果它在模拟器或设备上出现问题，您必须修复它，因为它总有一天**会**失败。

# php - MySQL 查询未获取正确的结果

> ID：12308696
> 
> 赞同：1
> 
> 时间：2012-09-06T21:30:54.740
> 
> 标签：php, mysql

我有一个网络论坛，仅允许某些选定的用户访问它，即他们必须拥有`$_SEESION['username']`。

现在在个人资料页面上 - 看起来像这样

```
http://127.0.0.1/mysite/profile.php?username=john 
```

我想显示上传按钮或编辑配置文件按钮，具体取决于他们是否上传了图像。

我正在检查是否设置了 $_GET，如果没有设置，则首先重定向到主页：

```
if(isset($_GET['username'])) {
$username = mysql_real_escape_string($_GET['username']);

$profile = mysql_query(SELECT *
                       FROM forum
                       WHERE username = '$username') or DIE(mysql_error());

                       $row = mysql_fetch_array($profile);

                    echo"
                    Name : $row[name];
                   Country : $row[country];

    if($_GET['username'] == $_SESSION['username'] && $row['imagepath'] == '') {
   echo "Upload Button";
}
else {
      echo"Edit Button";
}
} 
```

上传按钮显示在屏幕上，实际上指定了图像路径。

请问我哪里错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:51:24.463

您应该在 mysql_query 参数周围加上双引号。我复制了你的代码，这就是我的解决方案。

顺便说一句，你回声太多了。应该是如下代码。

```
echo "Name: ".$row['name'];
echo "Country: ".$row['country'];

if($_GET['username'] == $_SESSION['username'] && $row['imagepath'] == '') {
    echo "Upload Button";
}
else {
    echo"Edit Button";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:53:33.543

*   `mysql_query("QUERY HERE")`，否则它根本不起作用。
*   `$row['name']`, `$row['country']`: 您需要将名称放在引号之间。
*   `echo 'Text'`. 你没有关闭引号。
*   `empty($row['imagepath'])`. 它有一个功能，所以使用它。

如果上述更正仍然不起作用，请尝试回显您需要的所有变量：`$_GET['username']`, `$_POST['username']`, `$row['imagepath']`. 也许 PHP 无法读取它们。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-06T21:54:27.143

从这里修复了所有语法错误，您可以开始调试：

```
if ( isset( $_GET['username'] ) ) {
  $username = mysql_real_escape_string( $_GET['username'] );

  $profile = mysql_query( "SELECT *
    FROM forum
    WHERE username = '$username'" ) or DIE( mysql_error() );

  $row = mysql_fetch_array( $profile );

  echo "Name : " . $row['name'];
  echo "Country : ". $row['country'];

  if ( $_GET['username'] == $_SESSION['username'] && $row['imagepath'] == '' ) {
    echo "Upload Button";
  } 
  else {
    echo"Edit Button";
  }
} 
```

# ruby-on-rails - How best to DRY up this Rspec code?

> ID：12308701
> 
> 赞同：0
> 
> 时间：2012-09-06T21:31:12.580
> 
> 标签：ruby-on-rails, rspec, refactoring, dry

I have the following Rspec code which I think can be DRY'ed up quite a bit, specifically the `check_creation_email_sent` and `check_rename_email_sent` methods, I just don't know how to do it.

I tried doing it with `shared_examples` and `it_behaves_like` but got the error `undefined method it_behaves_like...` so I'm hoping someone can shed some light for me.

```
require 'spec_helper'

describe CreateTopicFolder do
  let(:ids) { [123,456] }

  def clear_bucket(topic_id)
    subject.find_folder(topic_id).each { |obj| obj.delete } unless subject.find_folder(topic_id).nil?
  end

  def check_folder_and_object(topic_id, permalink, old_permalink=nil)
    folder = subject.find_folder(topic_id)
    folder.should_not be_empty
    folder.size.should == 1

    object = folder.first
    object.key.should include(permalink)
    object.key.should_not include(old_permalink) unless old_permalink.nil?
  end

  def check_creation_email_sent(email, permalink)
    ActionMailer::Base.deliveries.should_not be_empty

    email.subject.should match("Folder for '#{permalink}' created")
    email.body.should include("(You can reply to this e-mail to contact Engineering if something doesn't look right)")
  end

  def check_rename_email_sent(email, permalink, old_permalink)
    ActionMailer::Base.deliveries.should_not be_empty

    email.subject.should match("Folder for '#{old_permalink}' renamed to '#{permalink}'")
    email.body.should include("(You can reply to this e-mail to contact Engineering if something doesn't look right)")
  end

  before(:all) do
    ids.each { |folder| clear_bucket(folder) }
    permalink = "123-How-to-Have-Fun"
    subject.create_or_rename_folder(permalink)
  end

  it 'should find an existing folder in the S3 bucket if it exists' do
    subject.find_folder(123).should_not be_empty
  end

  it 'should create a new folder with the topic permalink as name if none already exists' do
    subject.find_folder(456).should be_nil

    permalink = "456-How-to-Not-Have-Any-Fun"
    subject.create_or_rename_folder(permalink)
    email = subject.instance_variable_get(:@email)

    check_creation_email_sent(email, permalink)
    check_folder_and_object(456, permalink)
  end

  it 'should rename an existing folder with new permalink' do
    subject.find_folder(456).should_not be_empty

    permalink = "456-How-to-Have-Fun-Again"
    old_permalink = subject.instance_variable_get(:@old_permalink)
    subject.create_or_rename_folder(permalink)
    email = subject.instance_variable_get(:@email)

    check_rename_email_sent(email, permalink, old_permalink)
    check_folder_and_object(456, permalink, old_permalink)
  end
end 
```

Thanks in advance for any help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:44:48.520

您可能正在寻找`shared_examples_for("a thing")`and `it_should_behave_like("a thing")`。

# python - UnboundLocalError: local variable 'rows' referenced before assignment

> ID：12308706
> 
> 赞同：2
> 
> 时间：2012-09-06T21:31:42.430
> 
> 标签：python, postgresql, relational-database, variable-assignment

i'm trying to make a database connection by an other script. But the script didn't work propperly.

and if I do a 'print' on the rows then I get the value 'null'

But if I use a 'select * from incidents' query then i get the result from the table incidents.

import database

```
rows = database.database("INSERT INTO incidents VALUES(3 ,'test_title1', 'test',     TO_DATE('25-07-2012', 'DD-MM-YYYY'), CURRENT_TIMESTAMP, 'sector', 50, 60)")
#print database.database()
print rows 
```

database.py script:

```
import psycopg2
import sys
import logfile

def database(query):
logfile.log(20, 'database.py', 'Executing...')  
con = None

try:        
    con = psycopg2.connect(database='incidents', user='ipfit5', password='test') 

    cur = con.cursor()
    #print query

    cur.execute(query)
    rows = cur.fetchall()

    con.commit()

#test row does work
    #cur.execute("INSERT INTO incidents VALUES(3 ,'test_titel1', 'test', TO_DATE('25-07-2012', 'DD-MM-YYYY'), CURRENT_TIMESTAMP, 'sector', 50, 60)")

except:
    logfile.log(40, 'database.py', 'Er is iets mis gegaan') 
    logfile.log(40, 'database.py', str(sys.exc_info()))

finally:

    if con:
        con.close()
return rows 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:36:47.620

由于您没有在“尝试：”块之前声明“行”，因此如果出现异常，则不会定义它。尝试放在`rows = []`上面`try`。

# css - CSS Flexbox module: min-width/width not being respected when viewport shrinks

> ID：12308707
> 
> 赞同：1
> 
> 时间：2012-09-06T21:31:48.400
> 
> 标签：css, flexbox

I'm trying to use the css3 flexbox module in order to have table columns that can stretch, but still have a default width, as well as having a min-width and max-width.

This works well when the viewport is wide enough to hold the minimum widths for each column, but when the viewport shrinks, all the columns collapses. Is there any good way to make sure that the min-width/width is always maintained for flexboxes, or is there any other way to have table columns that can "flex". I've only tested this with Chrome 21 so far.

CSS:

```
#test, #test > thead, #test > tbody {
    display: block;
    width: 100%;
}

#test tr {
    display : -webkit-flex;
}

#test tr > td, #test tr > th {
    -webkit-flex-direction: row;
}

.col1 {
    width: 35px;
}

.col2 {
    -webkit-flex: 1 200px;
    width: 120px;
    max-width: 2000px;
}

.col3 {
    -webkit-flex: 1 150px;
    width: 80px;
    max-width: 2000px;
}

.col4, .col5 {
    width: 70px;
}

.col6 {
    width: 75px;
}

.col7 {
    -webkit-flex: 1 100px;
    width: 100px;
    max-width: 2000px;
}

.col8 {
    width: 55px;
}

.col9 {
    -webkit-flex: 1 100px;
    width: 60px;
    max-width: 100px;
}

.col10 {
    width: 80px;
} 
```

HTML:

```
<table id="test">
    <thead>
        <tr>
            <th class="col1">col1</th>
            <th class="col2">col2</th>
            <th class="col3">col3</th>
            <th class="col4">col4</th>
            <th class="col5">col5</th>
            <th class="col6">col6</th>
            <th class="col7">col7</th>
            <th class="col8">col8</th>
            <th class="col9">col9</th>
            <th class="col10">col10</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="col1">col1</td>
            <td class="col2">col2</td>
            <td class="col3">col3</td>
            <td class="col4">col4</td>
            <td class="col5">col5</td>
            <td class="col6">col6</td>
            <td class="col7">col7</td>
            <td class="col8">col8</td>
            <td class="col9">col9</td>
            <td class="col10">col10</td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:35:58.190

好的，这似乎是一个 Chrome 错误。我用 Chrome Canary 试过了，css 似乎在那里工作。

# web-applications - Getting Web Application Name in a Servlet

> ID：12308708
> 
> 赞同：2
> 
> 时间：2012-09-06T21:31:51.277
> 
> 标签：web-applications, servlets

I am developing a common artifact that can be used in multiple web applications. The developers will just have to add my listener class to their web.xml. In my listener, I have a need to get the web application name that my code is running under.

Although getServletContextName() will give a name, this name is the display-name coded in web.xml. I think display-name is optional so it is not reliable. So I would like to get the actual web application name. Is there a way to do this?

Thanks for looking.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-07-13T10:51:36.597

尝试使用此代码

```
String ApplicationName = ((HttpServletRequest) request).getContextPath()
                    .replace("/", ""); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-07T12:57:28.387

我找到了一种方法来做到这一点......

```
new java.io.File(context.getRealPath("/")).getName() 
```

上面给出了 Web 应用程序名称，即 WAR 名称。

Hardik，感谢您对此进行调查。

MaVRoSCy，显示名称可以是任何东西。它不必是 Web 应用程序名称。例如，所有 Maven Web 项目都将默认显示名称为“原型创建的 Web 应用程序”，我不想选择它。

# wpf - 有没有办法将绑定分配给一个值，而不是绑定 XAML 中的值？

> ID：12308710
> 
> 赞同：2
> 
> 时间：2012-09-06T21:32:02.477
> 
> 标签：wpf, xaml, binding, storyboard

因此，假设我想以动态方式修改多个可视元素的 DataContext，并且我想将其作为 Storyboard 的一部分。我可能会这样做：

```
<Storyboard>
    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SomeVisualElement"  Storyboard.TargetProperty="(FrameworkElement.DataContext)" Duration="0:0:0" >
        <DiscreteObjectKeyFrame KeyTime="0:0:0" >
            <DiscreteObjectKeyFrame.Value>
                <Binding Path="Repository.GeneratedThings[0].Element" />
            </DiscreteObjectKeyFrame.Value> 
        </DiscreteObjectKeyFrame>
    </ObjectAnimationUsingKeyFrames>
</Storyboard> 
```

这具有将 DiscreteObjectKeyFrame 的值绑定到 Repository.GeneratedThings[0].Element 的效果。应用此 Storyboard 时，SomeVisualElement 的 DataContext 设置为 Repository.GeneratedThings[0].Element。我认为这相当于说：

```
<UserControl x:Name="SomeVisualElement" DataContext="{Binding Path="Repository.GeneratedThings[0].Element"} /> 
```

这是功能性的，但我想做的是采用某种方式使绑定仅在视觉元素中而不是在关键帧中维护。我们只有很少的视觉元素，但有很多 Storyboard 和 KeyFrames，我们注意到当我们更新 GeneratedThings 对象（而不是集合的单个元素）时，性能损失与 KeyFrames 的数量成正比。

如何设置 DiscreteObjectKeyFrame 以便 DataContext 最终正确绑定但 DiscreteObjectKeyFrame 的值未绑定？在 WPF/XAML 的上下文中，作为绑定的值和被绑定的值之间，这甚至是合理的语义区别吗？

或者，是否有另一种方法可以从 Storyboard 中更改多个可视元素的 DataContext 并且不涉及让每个 Storyboard 维护绑定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-12T13:38:51.290

假设您有以下代码：

```
<ObjectAnimationUsingKeyFrames Storyboard.TargetName="SomeVisualElement"  Storyboard.TargetProperty="SomeProperty" Duration="0:0:0" >
    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value={Binding Foo} />
</ObjectAnimationUsingKeyFrames> 
```

这里应该注意到两个问题。

1.  每个 Storyboard 都必须维护这个 Binding。
2.  *在运行这个 Storyboard 时，实际上Foo*的当前值将设置为*SomeProperty*。*Foo*的后续更改不会受到影响。

我建议以下。创建一些以 Foo 作为依赖属性的依赖对象。例如：

```
<Grid.Resources>
    <viewModel:FooContainer Foo={Binding Foo} x:Key="FooContainer" />
</Grid.Resources> 
```

在情节提要中使用此容器。

```
<ObjectAnimationUsingKeyFrames Storyboard.TargetName="SomeVisualElement"  Storyboard.TargetProperty="SomeProperty" Duration="0:0:0" >
    <DiscreteObjectKeyFrame KeyTime="0:0:0" Value={StaticResource FooContainer} />
</ObjectAnimationUsingKeyFrames> 
```

修改 Control 的 ContentTemplate 以便您可以绑定到 Foo 属性本身。因此，您可以将*绑定*而不是Foo 的*值*直接传递给控件。Storyboard 也不会受到 Foo 值变化的影响。

# android - 如何安全地访问异步获取的内容？

> ID：12308714
> 
> 赞同：1
> 
> 时间：2012-09-06T21:32:30.090
> 
> 标签：android, android-asynctask

这是我想要做的事情：当我的应用程序启动时，它直接启动异步调用以从 WebService 获取一些数据。然后，我打开显示该数据的第二个 Activity。简化代码：活动 1：

```
OnPostExecute()
{               
for (int i = 0; i < jsonArray.length(); ++i)
    { JSONObject jsonTrack = jsonTrackArray.getJSONObject(i);
                JSONObject jsonObject = jsonArray.getJSONObject(i);
                Content content = new Content(jsonObject.getString("content"),
                MyApp.contentList.add(Content);
         }
} 
```

第二个活动：

```
doSomething (contentList.get(0)); 
```

当我尝试访问 contentList(0) 时，如何确保它已被 AsynTask 获取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:01:30.207

您可能希望在第一个活动中保留用户，直到操作完成，或者将此逻辑移动到服务并在完成时广播并设置一些标志，第二个活动可以检查其生命周期创建方法。

```
scenario 1:
activity1 starts service then launches activity2.
Service completes, saves a preference, and broadcasts a success message.
activity2 receives this and does its thing.

scenario 2:
User comes back later to activity2, it's onResume checks a preference flag and knows the data exists, so it does its thing. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:04:39.030

在您启动请求的那一刻开始加载对话框，并且只有在收到响应或错误后才将其关闭。如果您需要存储可跨活动共享的状态，只需将其放在 SharedPreference 中，然后在那里检查。很可能您只会让用户保持在同一活动上，直到操作完成，但如果您想让他们切换到下一个活动，您可以在您使用的意图（添加到意图的参数）中传递有关请求的信息开始下一个活动。因此，数据确实需要通过意图传递给第二个活动，或者存储在第二个活动可以访问它的中心位置。

刚刚注意到您将它放在 Application 类中。不建议。我会将它存储在其他地方，例如 SharedPreference 或数据库。

如果您想要非模态对话框，您可以使用进度小部件。顺便说一句，您可以将其放在列表的标题中。

另外请注意 startActivityForResult() 选项。

# sql-server-2008 - 使用 tsql 编写表模式脚本

> ID：12308716
> 
> 赞同：2
> 
> 时间：2012-09-06T21:32:35.050
> 
> 标签：sql-server-2008

我正在编写代码来为服务器上所有数据库中的所有表编写 CREATE TABLE 语句。下面的代码将适用于特定数据库。想要一些关于如何修改它的想法，所以它可以为所有表编写表模式。

```
select  'create table [' + so.name + '] (' + o.list + ')' + CASE WHEN tc.Constraint_Name IS NULL THEN '' ELSE 'ALTER TABLE ' + so.Name + ' ADD CONSTRAINT ' + tc.Constraint_Name  + ' PRIMARY KEY ' + ' (' + LEFT(j.List, Len(j.List)-1) + ')' END
from    sysobjects so
cross apply
    (SELECT 
        '  ['+column_name+'] ' + 
        data_type + case data_type
                when 'sql_variant' then ''
                when 'text' then ''
                when 'decimal' then '(' + cast(numeric_precision_radix as varchar) + ', ' + cast(numeric_scale as varchar) + ')'
                else coalesce('('+case when character_maximum_length = -1 then 'MAX' else cast(character_maximum_length as varchar) end +')','') end + ' ' +
        case when exists ( 
        select id from syscolumns
        where object_name(id)=so.name
        and name=column_name
        and columnproperty(id,name,'IsIdentity') = 1 
        ) then
        'IDENTITY(' + 
        cast(ident_seed(so.name) as varchar) + ',' + 
        cast(ident_incr(so.name) as varchar) + ')'
        else ''
        end + ' ' +
         (case when IS_NULLABLE = 'No' then 'NOT ' else '' end ) + 'NULL ' + 
          case when information_schema.columns.COLUMN_DEFAULT IS NOT NULL THEN 'DEFAULT '+ information_schema.columns.COLUMN_DEFAULT ELSE '' END + ', ' 

     from information_schema.columns where table_name = so.name
     order by ordinal_position
    FOR XML PATH('')) o (list)
left join
    information_schema.table_constraints tc
on  tc.Table_name               = so.Name
AND tc.Constraint_Type  = 'PRIMARY KEY'
cross apply
    (select '[' + Column_Name + '], '
     FROM       information_schema.key_column_usage kcu
     WHERE      kcu.Constraint_Name     = tc.Constraint_Name
     ORDER BY
        ORDINAL_POSITION
     FOR XML PATH('')) j (list)
where   xtype = 'U'
AND name        NOT IN ('dtproperties') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:03:32.417

由于您似乎对 TSQL 下定决心，一个快速而肮脏的解决方案是使用（未记录的）sp_foreachdb 存储过程。这将为您提供 sql 实例上每个数据库的名称，因此您只需依次使用每个数据库并运行您发布的 TSQL（在转义其中的所有单个 qoutes 之后）。

这是一个简短的示例：

```
EXECUTE sp_msforeachdb 'USE [?]
select  ''create table ['' + so.name + ''] ''
from    sysobjects so 
-- the rest of your escaped TSQL goes here...
-- then finish with a closing quote: 
' 
```

# mysql - ORDERBY "human" 使用 SQL 字符串操作的字母顺序

> ID：12308719
> 
> 赞同：5
> 
> 时间：2012-09-06T21:32:56.260
> 
> 标签：mysql, sql, wordpress

我有一个帖子表，其标题按“人类”字母顺序排列，但不按计算机字母顺序排列。它们有两种形式，数字和字母：

*   **数值：**图1.9、图1.10、图1.11……

*   **按字母顺序排列：**图 1A ... 图 1Z ... 图 1AA

如果我`orderby`命名，结果是 1.10-1.19 介于 1.1 和 1.2 之间，而 1AA-1AZ 介于 1A 和 1B 之间。但这不是我想要的；我想要“人类”字母顺序，其中 1.10 在 1.9 之后，1AA 在 1Z 之后。

我想知道 SQL 中是否还有一种方法可以使用字符串操作（或其他我没有想到的东西）来获得我想要的顺序。

我不是 SQL 专家，所以我不知道这是否可能，但如果有办法进行条件替换，那么我似乎可以通过这样做来强加我想要的顺序：

1.  删除句号（可以用 来完成`replace`，对吧？）

2.  *如果剩余的数字超过三个字符*，则在第一个字符后添加一个`0`（零）。

这似乎给了我想要的结果：`1.9`会变成`109`，它在之前`110`；`1Z`会变成`10Z`，这在之前`1AA`。但它可以在 SQL 中完成吗？如果是这样，语法是什么？

请注意，我不想修改数据本身——只是为了按照描述的顺序输出查询结果。

这是在 Wordpress 安装的上下文中，但我认为这个问题更适合 SQL 问题，因为各种事情（例如分页）取决于 MySQL 查询阶段发生的排序，而不是 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T14:24:31.027

我的第一个想法是添加一个由触发器或其他外部机制更新的附加列。

1）使用该列进行排序 2）无论更新该列的机制都将具有通过代理创建可接受的顺序的逻辑（例如，它将 1.1 变成 AAA 或类似的东西）。

无论如何......这将是一个痛苦。我不知道你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:55:47.467

您可以创建具有逻辑以具有人类排序顺序的函数，例如

```
Alter FUNCTION [dbo].[GetHumanSortOrder] (@ColumnName VARCHAR(50))
RETURNS VARCHAR(20)
AS

BEGIN
DECLARE @HumanSortOrder VARCHAR(20)

SELECT  @HumanSortOrder =
CASE 
    WHEN (LEN(replace(replace(<Column_Name>,'.',''),'Figure ',''))) = 2
THEN
CONCAT (SUBSTRING(replace(replace(<Column_Name>,'.',''),'Figure ',''),1,1),'0',SUBSTRING(replace(replace(<Column_Name>,'.',''),'Figure ',''),2,2))
    ELSE
       replace(replace(<Column_Name>,'.',''),'Figure ','')
      END 
FROM    <Table_Name> AS a (NOLOCK)
WHERE   <Column_Name> = @ColumnName

RETURN  @HumanSortOrder

END 
```

此功能根据需要为您提供 104,107,119,10A,10B 等

您可以使用此功能作为 order by

```
 SELECT * FROM <Table_Name> ORDER BY GetHumanSortOrder(<Column_Name>) 
```

希望这可以帮助

# android - 安卓通知图标

> ID：12308727
> 
> 赞同：0
> 
> 时间：2012-09-06T21:33:39.303
> 
> 标签：android, android-notifications

我需要制作一个通知图标。

图标将只显示一个数字。

我需要多大尺寸才好看？

我正在考虑与此处类似的大小：[https ://lh5.ggpht.com/4G8a85pukLYnj0Xu5H23ZjqNNYyTJuIGdTVvDqgnqj4i_z8AMp73uo4uGcCss2f6cg](https://lh5.ggpht.com/4G8a85pukLYnj0Xu5H23ZjqNNYyTJuIGdTVvDqgnqj4i_z8AMp73uo4uGcCss2f6cg)

我做的每一个图标看起来都很难看。边缘参差不齐

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:35:23.017

[在此处](http://developer.android.com/guide/practices/ui_guidelines/icon_design_status_bar.html)查看官方 Android 指南。您正在寻找*状态栏*图标：

```
LDPI:  18 x 18 px    
MDPI:  24 x 24 px   
HDPI:  36 x 36 px    
XHDPI: 48 x 48 px 
```

# javascript - 向 websocket 客户端发送消息时压缩位必须为 0

> ID：12308728
> 
> 赞同：1
> 
> 时间：2012-09-06T21:33:53.350
> 
> 标签：javascript, python, websocket

我正在用python编写一个websocket服务器，在将消息发送回客户端时遇到了问题。使用 chrome 的 javascript 控制台，我可以找到此错误消息：

> 如果没有协商的放气帧扩展，压缩位必须为 0

但除此之外，我找不到任何关于这实际上意味着什么的文档。你可以在这里找到这个问题（和代码）的[开始](https://stackoverflow.com/questions/12304216/websocket-onmessage-not-firing)。我有点不知所措。我尝试过使用第一个字节，将其更改为全 0，但根据[this ，如果](https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-5.2)[此](https://datatracker.ietf.org/doc/html/draft-tyoshino-hybi-permessage-compression-00)文档正确，第二个位（在我的情况下为 0）应该是“压缩位” ；

> “WebSocket 帧头中的一个保留位 RSV1 被分配用于控制每个消息的压缩应用。”

所以我不完全确定从这里去哪里。在 Firefox 中，错误只是“页面加载时与 ws://localhost:8080/ 的连接中断”。错误。

编辑：这是接收消息时的解析代码：

```
def parse( self, data, client_socket ):
    display_server_message( "Received message:\n%s" % str( data ) )
    byte_array = bytearray( data )
    mask = []

    message_string = ""
    for i in range( 0, len( byte_array ) ):
        b = byte_array[ i ]
        if i > 0 and i < 2:
            b = b & 0b01111111
        if i > 1 and i < 6:
            mask.append( byte_array[ i ] )
        if i > 5:
            b = b ^ mask[ (i - 2) % 4 ]
            message_string = message_string + chr( b )

    display_server_message( "Decoded Message:\n%s" % message_string )
    if ( message_string == "a test message" ):
        time.sleep( 5 )
        self.send_message( "Hello, how are you?", client_socket )

    pat = re.compile( "Sec-WebSocket-Key: (\S+)", re.MULTILINE )

    for match in pat.findall( data ):
        magic_string = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"

        message = "HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: %s\r\n\r\n" % base64.standard_b64encode( hashlib.sha1( match + magic_string ).digest() )

        client_socket.send( message )
        display_server_message( "Message Sent:\n%s" % message ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:45:00.690

**这与您的其他问题的答案相同：[WebSocket onmessage not fire](https://stackoverflow.com/questions/12304216/websocket-onmessage-not-firing)**

您的问题是您`bytes`在 python 2.X 中使用该函数，但希望它能够像在 python 3.X 中那样工作

python2.6.6：

```
>>> bytes([129, 19])
'[129, 19]' 
```

蟒蛇3：

```
>>> bytes([129, 19])
b'\x81\x13' 
```

通过在您的服务器代码中将 send 替换为以下内容，它在 python2.X 中对我有用：

```
client_socket.send( "".join( [chr(c) for c in formatted_bytes] ) 
```

其他几点注意事项：

*   您链接到的代码将消息长度加 1，这是不正确的。

*   您确实应该将握手代码与正常的消息解析代码分开。如果有人碰巧发送了一条包含“Sec-WebSocket-Key:”的消息，你最终会通过再次发送原始握手来破坏流。

# javascript - jQuery是否可以连接两个选择器变量？

> ID：12308729
> 
> 赞同：1
> 
> 时间：2012-09-06T21:33:55.203
> 
> 标签：javascript, jquery

假设我有两个变量定义了单独的选择器，例如......

```
var parent = $('.parent');
var child = $('.child'); 
```

我想创建一个类似以下的东西......

```
$(parent + child).click(); 
```

这应该相当于这样做（如果它是正确的语法）......

```
$('.parent .child').click(); 
```

这可能不是最佳实践，但我很好奇是否可能。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:43:33.797

您可以传递一个 jQuery 对象以`context`在另一个选择器中使用，使用[`$( selector [, context] )`](http://api.jquery.com/jQuery/#jQuery1)：

```
var parent = $('.parent');
var child = $('.child');
$(child, parent).click(function () {

}); 
```

`$(child, parent)`相当于`$(".parent .child")`。

**[演示](http://jsfiddle.net/D6nx2/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:42:35.583

尝试使用`.find`.

```
parent.find(child).click(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-29T21:14:38.127

标题表明 OP 想知道是否可以连接两个已绑定到变量的选择（至少其他登陆这里的人会寻找那个）a la jQuery's `.add()`。`child`假设and的隐含嵌套关系`parent`是一条红鲱鱼，您可以使用如下连接：

```
parent.add(child).click(); 
```

# iphone - CSS 投影没有在 iPhone 上显示……？

> ID：12308730
> 
> 赞同：0
> 
> 时间：2012-09-06T21:33:58.060
> 
> 标签：iphone, css, button, safari

[我在我的网站](http://v3.edharrisondesign.com/about/)上的动画按钮上有一个阴影，它在所有浏览器上都可以正常工作，但它似乎没有出现在 iPhone 上……很奇怪，因为它是在几天前显示的。不完全确定我为了防止它工作而改变了什么。

任何指向我做错了什么的指针将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:58:01.827

使用 box-shadow 的 IE8 和 IE7 也会遇到问题。如果我可以推荐一些东西（我倾向于这样做），那就是制作一些图像并将其用作这些图像的背景。这有点工作，但这是最安全的路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:58:08.477

我相信旧版本的 safari 需要 -webkit-box-shadow，因为不完全支持 box-shadow。但是它确实适用于最新的移动 safari

# ruby-on-rails - 来自延迟工作的咆哮通知

> ID：12308734
> 
> 赞同：-1
> 
> 时间：2012-09-06T21:34:08.323
> 
> 标签：ruby-on-rails, delayed-job, gritter

我刚刚打破了我现有的从延迟工作中获取咆哮式通知的方式，并且打开别人的宝石并四处乱窜并没有让我到任何地方。所以我想知道：从后台任务获取通知的明智方法是什么。目前我正在使用带有这样的 ruby​​ 类的[gritter_notices](https://github.com/dapi/gritter_notices)（但我已经做了一些事情来阻止它工作......并且文档不是我的母语......）

```
#User.rb

has_gritter_notices

class DoThing

  def run_thing(books, template, client, user)
     # some code

     User.find(user).notice "<a href='/archives' target='_blank'>View Archive</a>", :level => :notice, :sticky => true, :title => "Things generated." 

  end

handle_asynchronously :run_thing

end 
```

ps 我得到的错误是`ActiveRecord::RecordInvalid: Validation failed: Text can't be blank`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T07:28:00.847

哦，别理我。我打开了 whitelist_attributes：

```
config.active_record.whitelist_attributes = true 
```

并且 gem 没有将其属性列入白名单`attr_accessible`。

# html - nth-of-type 仅适用于 1 和 2

> ID：12308736
> 
> 赞同：0
> 
> 时间：2012-09-06T21:34:09.353
> 
> 标签：html, css, css-selectors

我有一个样式问题，我正在使用 WordPress，并且希望前两个类与其他类完全不同。

我的理想情况是：

```
.si-biplace:nth-of-type(3) { float:left; margin:20px 0px 0px 0px; }
.si-image:nth-of-type(3) { float:left; margin:20px 0px 0px 0px; border:0px; }
.si-title:nth-of-type(3) { width:100px; height:20px; margin:0px; font-size:7px; color:#FFFFFF; font-weight:bold; } 
```

它们似乎在以下情况下工作正常：

```
.si-biplace { float:left; margin:-10px 0px 0px 0px; }
.si-biplace:nth-of-type(2) { float:left; margin:-10px 0px 0px 15px; } 
```

有没有理由为什么它不适用于 nth-of-type(3) 但适用于 nth of type 2？每次使用 div 时，我基本上都需要不同的属性，但不能有单独的 div 类，因为它通过 php 数组运行。

这是我的 HTML 和 PHP 结构，以防我做错了什么：

```
<div class="si-biplace">
    <div class="si-image">
        <a href="http://universitycompare.com:8888/945/test/">
        <img width="340" height="170" src="http://universitycompare.com:8888/wp-content/uploads/2012/09/post-test.png" class="attachment-si-images wp-post-image" alt="post-test" title="post-test"/></a>
    </div>
    <div class="si-title">
        <a href="http://universitycompare.com:8888/945/test/">Testing Post Article Number1</a>
    </div>
    <div class="si-date">
        &nbsp;Date:&nbsp; <a style="color:#154157;" href="http://universitycompare.com:8888/945/test/">
        September 6, 2012 </a>
    </div>
</div>
<div class="si-biplace">
    <div class="si-image">
        <a href="http://universitycompare.com:8888/28/what-graduates-need-to-know-about-creative-internships/">
        <img width="340" height="170" src="http://universitycompare.com:8888/wp-content/uploads/2012/09/post-test.png" class="attachment-si-images wp-post-image" alt="post-test" title="post-test"/></a>
    </div>
    <div class="si-title">
        <a href="http://universitycompare.com:8888/28/what-graduates-need-to-know-about-creative-internships/">What graduates need to know about creative internships</a>
    </div>
    <div class="si-date">
        &nbsp;Date:&nbsp; <a style="color:#154157;" href="http://universitycompare.com:8888/28/what-graduates-need-to-know-about-creative-internships/">
        July 3, 2012 </a>
    </div>
</div>
<div class="si-biplace">
    <div class="si-image">
        <a href="http://universitycompare.com:8888/25/students-say-they-will-work-for-free-after-graduating/">
        <img width="340" height="170" src="http://universitycompare.com:8888/wp-content/uploads/2012/09/post-test.png" class="attachment-si-images wp-post-image" alt="post-test" title="post-test"/></a>
    </div>
    <div class="si-title">
        <a href="http://universitycompare.com:8888/25/students-say-they-will-work-for-free-after-graduating/">Students say they will work for free after graduating</a>
    </div>
    <div class="si-date">
        &nbsp;Date:&nbsp; <a style="color:#154157;" href="http://universitycompare.com:8888/25/students-say-they-will-work-for-free-after-graduating/">
        July 3, 2012 </a>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T06:04:59.143

To style the first two elements in a class differently from the others, it is best to set general style settings for the class and then override them as desired for the first two.

If you for some reason wish to do it by setting some styles for the 3rd, 4th, 5th etc. child of an element, you can use `:nth-child(n+3)`, and to refer to the 3rd, 4th, 5th etc. child of its kinf of an element, use `:nth-of-type(n+3)`. This can be combined with a class selector, but it does *not* mean referring to nth element in a class.

In your case, assuming there is no other `div` element before these elements, you could thus use

```
.si-biplace:nth-of-type(n+3) { ... }
.si-biplace:nth-of-type(n+3) .si-image { ... }
.si-biplace:nth-of-type(n+3) .si-title { ... } 
```

You cannot use constructs like `.si-image:nth-of-type(3)`, because in your markup, each element in class `.si-image` is the first child of its parent and therefore never matches the selector.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:44:22.790

好的，我想我已经重现了您的问题。看起来您需要将 :nth-child() 用于“si-biplace”div 中的元素。

**这是我小提琴中的 CSS ..**

```
.biplace:nth-of-type(3){
    float:left; margin:20px 0px 0px 0px;   
}

.biplace:nth-of-type(3) .image:nth-child(3){
    float:left; margin:20px 0px 0px 0px; border:0px; 
}

.biplace:nth-of-type(3) .title:nth-child(3){
    width:100px; height:20px; margin:0px; font-size:7px; color:red; font-weight:bold; border:1px solid red; 
} 
```

**还有一些HTML，应该和你的结构一样...**

```
 <p class="image">Something</p>
   <p class="image">Something</p>

   <h2 class="title">First Title</h2>
</div>

 <div class="biplace">
   <p class="image">Something</p>
   <p class="image">Something</p>

     <h2 class="title">Second Title</h2>
</div>

 <div class="biplace">
   <p class="image">Something</p>
   <p class="image">Something</p>

     <h2 class="title">Third Title</h2>
</div> 
```

**这是我开始重现问题的小提琴。**

[http://jsfiddle.net/krishollenbeck/sFkLz/6/](http://jsfiddle.net/krishollenbeck/sFkLz/6/)

**还有文章更详细地讨论了两者的区别......**

[http://css-tricks.com/the-difference-between-nth-child-and-nth-of-type/](http://css-tricks.com/the-difference-between-nth-child-and-nth-of-type/)

# vba - 如何在自定义功能区上动态填充菜单控件？

> ID：12308737
> 
> 赞同：2
> 
> 时间：2012-09-06T21:34:09.760
> 
> 标签：vba, excel, openxml, ribbon

```
For Each ws In Worksheets
ListBox1.AddItem ws.Name
Next ws

ListBox1_Click()
Worksheets(ListBox1.Value).Activate 
```

我可以在自定义功能区
xml 上使用菜单控件吗？

```
<menu id="mnuCats" label="abc" size="large" imageMso="PropertySheet"  >
<button id="go01" label="sky"  onAction="go01" imageMso="TextAlignGallery" />
<button id="go02" label="sea"  onAction="go02" imageMso="TextAlignGallery" />
</menu> 
```

那么，如何使用工作表名称填充菜单以及如何将按钮的标签属性作为字符串获取，以激活相应的工作表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T07:20:47.423

您需要一个下拉功能区控件。如果您在 Excel 文件中输入以下 customUI XML（可能使用自定义 UI 编辑器[http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2006/05/25/customuieditor.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2006/05/25/customuieditor.aspx)），您可以获得一个列表您需要实现的正确 VBA 回调签名以填充值并响应操作：

```
<dropDown id="drpTest" label="Test" showImage="false" getSelectedItemIndex="TestGetSelItem" onAction="TestOnAction" getItemCount="TestGetItemCount" getItemID="TestGetItemID" getItemLabel="TestGetItemLabel" sizeString="HowBigDropdownDoYouWant" supertip="Select Test.">
</dropDown> 
```

# dns - 如何为我的权威域上的 Google Apps (GMail) MX 记录禁用 DNSSC？

> ID：12308741
> 
> 赞同：2
> 
> 时间：2012-09-06T21:34:21.413
> 
> 标签：dns, gmail, bind

我正在使用 DNSSEC 运行 BIND 主/从设置，但我的一些域使用 Google Apps 提供电子邮件服务。Google 不支持 DNSSEC，BIND 根本不喜欢它。

日志输出：

```
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ALT2.ASPMX.L.GOOGLE.COM.dlv.isc.org/DLV/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ALT2.ASPMX.L.GOOGLE.COM/A/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ALT2.ASPMX.L.GOOGLE.COM/AAAA/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f755cb83950: ALT2.ASPMX.L.GOOGLE.COM AAAA: bad cache hit (ALT2.ASPMX.L.GOOGLE.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ALT2.ASPMX.L.GOOGLE.COM/AAAA/IN': 69.147.224.178#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f755ca52c30: ALT2.ASPMX.L.GOOGLE.COM A: bad cache hit (ALT2.ASPMX.L.GOOGLE.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ALT2.ASPMX.L.GOOGLE.COM/A/IN': 69.147.224.178#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f755ca52c30: ASPMX2.GOOGLEMAIL.COM AAAA: bad cache hit (ASPMX2.GOOGLEMAIL.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ASPMX2.GOOGLEMAIL.COM/AAAA/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f755cb83950: ASPMX2.GOOGLEMAIL.COM A: bad cache hit (ASPMX2.GOOGLEMAIL.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ASPMX2.GOOGLEMAIL.COM/A/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f754c1b0bd0: ASPMX2.GOOGLEMAIL.COM A: bad cache hit (ASPMX2.GOOGLEMAIL.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ASPMX2.GOOGLEMAIL.COM/A/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f754c1a6a30: ASPMX2.GOOGLEMAIL.COM AAAA: bad cache hit (ASPMX2.GOOGLEMAIL.COM.dlv.isc.org/DLV)
Sep  6 17:12:51 srv549 named[5376]: error (broken trust chain) resolving 'ASPMX2.GOOGLEMAIL.COM/AAAA/IN': 70.32.45.42#53
Sep  6 17:12:51 srv549 named[5376]: validating @0x7f755cb83950: ASPMX3.GOOGLEMAIL.COM AAAA: bad cache hit (ASPMX3.GOOGLEMAIL.COM.dlv.isc.org/DLV) 
```

我不确定这是否会阻止 Google Apps 工作，因为我刚刚启用了所有 DNSSEC 功能。这里有人有这方面的经验吗？

# symfony1 - 带有位掩码列的 Doctrine2 实体

> ID：12308742
> 
> 赞同：0
> 
> 时间：2012-09-06T21:34:24.130
> 
> 标签：symfony1, doctrine-orm

我正在开发一个项目，该项目具有具有多个位掩码列的实体。因此，例如我的 User 实体有一个 column `specialitiesBitmask`。此位掩码将与另一个表相关联，例如 Specialty。如果我想做这样的事情`$user->getSpecialties()`，最好的方法是什么？我需要查询专业表，并相应地分解位掩码。但是，使用 Doctrine2 您无权访问 EntityManager。

我四处寻找任何解决方案，但找不到太多。看看这个，你可以使用一个监听器来挂钩 postLoad 事件并以这种方式获取 EM，但是这非常hacky而且不干净。

我能想到的唯一其他解决方案是创建其他服务并执行类似的操作，`$userService->getSpecialtiesForUser($user);`但这也不会那么干净/高效，因为有许多列是位掩码的。

你认为最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T18:12:44.253

创建一个`SpecialtyRepository`，并实施`getByUser($user)`。[您可以在此处](http://symfony.com/doc/current/book/doctrine.html#custom-repository-classes)和[此处](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html)找到如何操作。

然后，要获得用户的特长，您可以：

`$specialties = $em->getRepository('Specialty')->getByUser($user);`

# azure - 检索 Azure（工作人员）角色的 DNS URL

> ID：12308744
> 
> 赞同：5
> 
> 时间：2012-09-06T21:34:42.880
> 
> 标签：azure, azure-configuration

我的服务部署到几个不同的环境（多个开发环境以及生产环境）。服务代码需要在运行时找出当前部署的 URL。

是否有一种简单的方法来检索 Azure 角色的面向外部的 URL？如果 Web 角色正在处理请求，则可以直接查看 HttpContext.Current.Request 并找出 URL。但是我还没有找到一种方法来为工人角色做到这一点。您可能认为有一种方法可以从 RoleEnvironment 获取此信息，但我能找到的最接近的东西 (RoleEnvironment.CurrentRoleInstance.RoleInstanceEndpoints) 似乎返回内部 IP/端口信息，而不是面向外部的 DNS 名称。

我总是可以将部署 URL 存储在 ServiceConfiguration 键中（即，将其静态存储在每个 ServiceConfiguration.???.cscfg 中），但我希望避免在配置文件中对其进行硬编码。有没有办法以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T09:41:24.943

您需要调用 REST 管理 API

请参阅此 StackOverflow 帖子： [如何找到 Azure 部署的暂存 URL？](https://stackoverflow.com/questions/6460190/how-can-i-find-the-staging-url-for-an-azure-deployment)

使用 GetDeployment： http: [//msdn.microsoft.com/en-us/library/ee460804.aspx](http://msdn.microsoft.com/en-us/library/ee460804.aspx) 来获取已部署服务的 url

# security - 一个短语是一个好代码吗？

> ID：12308747
> 
> 赞同：1
> 
> 时间：2012-09-06T21:35:10.113
> 
> 标签：security, entropy

## 介绍

我正在为我的网站使用“奖品代码”系统：管理员可以将积分分配给用户，给他们一个可以兑换的代码。
这个想法本身很容易实现：生成（我假设算法很难预测）代码，将它们存储在安全的数据库中，并让管理员有权读取一个随机代码。但我发现我想要的一些功能确实会发生冲突：

1.  代码必须以合理的计算能力合理地抵抗攻击；
2.  必须有大量的代码，100万；
3.  代码必须易于键入。

我想到了这些解决方案，直到现在：

经过一番思考，我想出了这个解决方案：使用 N 个单词的短语 [我不是在谈论“n”单词。我的意思是，“N 次随机单词”]。这似乎是一个好主意，但我在这个领域没有经验。

### 问题 1

对代码使用短语是否安全？如果是，我应该使用多少字才能足够安全？[假设平均长度和 8 岁儿童知道的单词。]

### 问题2

给定一个单词列表，将它们存储到数据库中的最佳方法是什么？

*   桌面端，生成一个包含所需短语的文件，然后使用 PHP 读取并将它们放入数据库？
*   服务器端，读取单词列表并将短语直接写入数据库？
*   其他方法？

请注意，我不能只让管理员阅读短语文件，因为编码比使用数据库更难。另请注意，这些词必须是普通的意大利语：我估计要使用 4.000 到 6.000 个词。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:11:23.200

我将始终假设您的代码将由正确的（伪）随机数生成。如果您生成大量它们，请确保为生成它们的计算机的随机数生成器提供足够的熵。

像您所说的代码通常被创建为随机可打印字符的字符串。例如，一种方法是生成一个 144 位随机数并对其进行 base64 编码。这将为您提供包含 24 个字符的字符串的 144 位信息。通常人们不介意将字符串读作垃圾，因为它们要么被复制粘贴，要么嵌入在 URL 中。您可以将此字符串视为由 64 个字符的字母表生成的 24 个符号的序列，或由 2 位的字母表生成的 144 个符号的序列。结果是一样的。

生成 WORDS 列表而不是 CHARACTERS（或 BIT）列表是类似的。您使用的不是 2 位或 64 个字符的字母表，而是 4000 到 6000 个单词的字母表。这是一个更大的字母表（更多信息），但您希望在您的短语中使用更少或它们（更少信息）。

使用`n`单词，您将获得 log₂((4​​000 到 6000)ⁿ) 位。为简单起见，假设您选择了 4096 个单词的字母表。要包含与 144 位标记相同数量的信息，您的短语将需要每个包含 12 个单词。

您的要求“必须有大量代码，100 万”不清楚。您的意思是代码空间必须是 100 万个短语，还是您打算生成 100 万个不同的短语，这些短语是更大的代码空间的每个部分。

如果您的代码空间需要为 100 万，则只有 log₂(1000000) = 20 位。2个单词的短语就可以了。我想这可能是一个很小的代码空间......但这取决于对手有多少机会猜测正确的短语以及他们能够以多快的速度进行猜测。它还取决于对手猜测正确代码的破坏性。在不知道您的要求的情况下，我只能猜测您想要拥有多大的代码空间。比特数可能是原来的两倍（1 万亿个代码）？

**问题 2：**只要生成短语的计算机具有良好的随机性来源，生成短语的位置并没有任何区别。如果有疑问，请使用您的桌面。然后，如何将它们加载到数据库中并不重要，无论是 RPC、远程数据库访问还是将文件复制到服务器。

如果您生成大量短语，请注意将它们作为纯字符串存储在数据库中的成本会很高。您可以通过将它们编码为整数序列来节省大量空间，这些整数是您的参考词表的索引。

**额外**：请注意，如果您在每个短语中使用超过 2 或 3 个单词，您可能会发现这些短语与随机字符序列一样难以记忆和键入。这是因为即使它们由真实的单词组成，这些短语也大多是无意义的，包括在语法上不能彼此相邻的单词。

如果你想减轻这种情况，你可以使用一个统计模型来了解某些单词在文本语料库（例如，一组文献）中彼此相邻出现的频率，以使单词序列看起来很自然一个人。对相邻单词的相邻部分、三元组或四元组进行建模分别称为第二、第三或 n 级[马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain)。

显然，生成这样的短语将减少短语中的信息量（在信息论意义上），因此您必须通过延长它们来进行补偿。使用特定统计模型导致的信息减少的确切数量留作练习供您计算:-)

# php - 设置中的变量 if() 语句？

> ID：12308749
> 
> 赞同：1
> 
> 时间：2012-09-06T21:35:14.643
> 
> 标签：php, variables, if-statement

因此，假设我有一个选项页面将设置`$threshold`为`'1'`, `'2'`, `'3'`, `'4'`, 或`'5'`

我有一个基于该阈值以不同方式提交/重定向的表单（现在阈值设置为`three`only，不可更改，所以`one`，，`two`然后`three`转到第 1**页**并执行**FUNCTION ONE**，而`four`转到`five`第**2 页**并执行**FUNCTION二**。

我希望人们能够设定自己的门槛。

**目前我有：**

```
if($foo == 'five' || $foo == 'four' || $foo == 'three'){
    //DO ALL THIS CRAZY STUFF
} else {
    //DO ALL THIS OTHER STUFF
} 
```

**我想要的基本上是一个围绕它的阈值：**

```
if($threshold == '5'){
    if($foo == 'five'){
        //DO ALL THIS CRAZY STUFF
    } else {
        //DO ALL THIS OTHER STUFF
    }
} else if ($threshold =='4'){
    if($foo =='five' || $foo == 'four') 
```

if($foo == 'five'){ //做所有这些疯狂的事情 } else { //做所有这些其他事情 } }

等等 3、2 和 1 也是如此。

有没有简单的方法可以做到这一点？就像我应该将 if/or 语句设置为变量一样吗？像：

```
if($threshold == '5'){ $var = "$foo =='five'" }
else if($threshold == '4'){ $var = "$foo =='five' || $foo == 'four'" } 
```

然后做

```
if($var){
    //DO ALL THIS CRAZY STUFF
} else {
    //DO ALL THIS OTHER STUFF
} 
```

??

我不太确定对此的“最佳方法”：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:28:42.607

我不太确定，对于不同的`$threshold`数字和`$foo`组合，您是否对它们中的每一个都有不同的功能，或者您是否只想知道是否`$foo`位于指定的`$threshold`. 我想后者是你的目标：

```
// the map
$thresholds = array(
 5 => array('five'),
 4 => array('five','four'),
 // etc
);

// dummy values
$threshold = 5;
$foo = "four";

// check values
if(array_key_exists($threshold,$thresholds)) {
  if(in_array($foo, $thresholds[$threshold]))  {
    //DO ALL THIS CRAZY STUFF
  }
  else {
    //DO ALL THIS OTHER STUFF
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:44:06.127

如果您必须基于多个变量做出复杂的决定，一个好的策略是构建地图。

map 是一个多维数组，具有函数名或闭包作为值。您所做的是根据数组的键查找要调用的函数。

# html - 导航中的图像定位

> ID：12308750
> 
> 赞同：0
> 
> 时间：2012-09-06T21:35:15.610
> 
> 标签：html, css, navigation

我很难弄清楚如何定位我在导航下方添加的社交媒体图标。如何在不移动链接的情况下将图像定位在导航右侧并将其稍微推到底部？

这是它现在的样子：http: [//i48.tinypic.com/34shzc3.png](http://i48.tinypic.com/34shzc3.png)

下面是布局，

HTML：

```
 <!-- HEADER -->
      <div id="header">

        <div id="site_nav">
          <virb load="nav" />
<a href="http://www.facebook.com/"><img src="http://i47.tinypic.com/2hsawr8.png" /></a>
<a href="http://www.facebook.com/"><img src="http://i47.tinypic.com/2hsawr8.png" /></a>
        </div>

        <div class="module" id="display_name">
          <h1><a href="get[site.url]"><virb customize="logo" /></a></h1>
          <h2 id="virb_customize_tagline"><virb customize="tagline" /></h2>
        </div> 

      </div>
      <!-- END HEADER --> 
```

CSS：

```
/* ---------- HEADER ---------- */

div#header_wrapper {
    width:100%;
    background: <virb get="customize.colors.background_header" />;
    z-index: 2;
}

div#header {
    width:960px;
    margin:0 auto;
    padding:35px 0 20px;
}
    #header h1 {
        font: normal <virb get="customize.fonts.site_size" /><virb get="customize.fonts.site_family" />;
        line-height: 100%;
    }

        #header h1 a,
        #header h1 a:hover {
            color: <virb get="customize.colors.site_name" />;
        }

        #header h1 img {
            display: block;
            max-width: 300px;
        }

    #header h2 {
        font-weight: bold;
        font-size: <virb get="customize.fonts.tagline_size" />;
        font-family: <virb get="customize.fonts.header_family" />;
        color: <virb get="customize.colors.tagline" />;
        line-height: 110%;
        padding-top: 6px;
    }

    #header #page_title {
       float:left;
    }
    #header #site_nav {
       float:right;
       margin-top: 54px;
    }

#display_name {width: 300px;}

    #display_name h2 {color:<virb get="customize.colors.tagline" />; text-transform: uppercase;}

/* ---------- NAVIGATION ---------- */

div#site_nav {
    display: block;
    max-width: 700px;
}

#site_nav ul li {
    display: inline;
    position: relative;
    font-size: <virb get="customize.fonts.nav_size" />;
    font-family: <virb get="customize.fonts.header_family" />;
    font-weight: bold;
    letter-spacing: .2px;
    text-transform: uppercase;
}

#site_nav div.clear {
    display: none;
}

    #site_nav li.section:after { content: " "; }

    #site_nav li.section ul { display: none; } 
    #site_nav li.section:hover ul { display: block; }
    #site_nav li.section ul {
        position: absolute;
        top: <virb get="customize.fonts.nav_size" />;
        left: 10px;
        width: 200px;
        z-index: 111;
        padding-top: 10px;
    }
        #site_nav li.section ul li {
            float: none;
            display: block;
            font: normal <virb get="customize.fonts.nav_size" />;
            background: <virb get="customize.colors.nav_dropdown" />;
            margin: 0;
            padding: 7px 7px 5px 7px;
            letter-spacing: 0;
            text-align: left;
            line-height: 1.5;
            border-bottom: 1px solid <virb get="customize.colors.background_header" />;
        }
            #site_nav li.section ul li:last-child {border-bottom: none;}

            #site_nav li.section ul li a {
                text-transform: none;
                letter-spacing: 0;
                padding: 4px 7px 4px 3px;
                font: <virb get="customize.fonts.header_family" />;
                display: block;
            }

    #site_nav ul li a, 
    #site_nav ul li.section {
        cursor: pointer;
        padding: 0 12px;
        font: <virb get="customize.fonts.header_family" />;
        color: <virb get="customize.colors.nav_link" />;
    }
    #site_nav ul li a:hover,
    #site_nav ul li.section:hover {
        color: <virb get="customize.colors.nav_hover" />;
    }
    #site_nav ul li.active, #site_nav ul li.active a {
        color: <virb get="customize.colors.nav_hover" />;
    }

    #site_nav ul li.active ul li a {
        color: <virb get="customize.colors.nav_link" />;
    }

    #site_nav ul li.active ul li a:hover {
        color: <virb get="customize.colors.nav_hover" />;
    }

    #site_nav ul li.active ul li.active a {
        color: <virb get="customize.colors.nav_hover" />;
        cursor: default;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:11:19.773

将以下 css 添加到 facebook 图像的周围锚标记：

```
.fr
{
    float:right;
} 
```

像这样：

```
<a href='some-url' class='fr'><img src='facebook'/></a> 
```

# mootools - http://wall.plasm.it/examples/example-the-wall/ 的问题 - 图片

> ID：12308753
> 
> 赞同：2
> 
> 时间：2012-09-06T21:35:38.400
> 
> 标签：mootools, javascript-framework, imagesource

这对你来说可能是小菜一碟，但我现在在黑洞里，我不知道墙有什么问题。我想做一些 www.wall.plasm.it/examples/example-the-wall/。请 - 看看：www.megainstal.pl/ 没有任何图像。你能帮忙修一下吗？我将非常感谢任何帮助/信息。

短篇小说：1）我从 github 下载文件：[https](https://github.com/plasm/the-wall) ://github.com/plasm/the-wall 2）我只更改了 3 个文件：

```
01-wall.css, 
index.html, 
01-wall.js 
```

（案例：基本）

3）在 01-wall.js 我声明了图像：

```
var a = new Element("img[src=../../img/middle/"+counterFluid+".jpg]"); 
```

4) 图片是：1 到 76.jpg

你能指出我犯错的地方吗？如果您要查看源文件-我将其全部压缩在一个文件中：www.megainstal.pl/files.zip

我与 plasm 的作者联系，他告诉我我在以下方面有错误：1）宽度和高度尺寸图像 - 我改进了 2）window.addEvent("domready", function() ...在 01-wall.js 中不确定 -我改进了，但我有疑问。请 - 看看代码：

```
// Define 01-wall.js
var maxLength    = 76; // Max Number images
var counterFluid = 1;
var wallFluid = new Wall("wall", {
                "draggable":true,
                "inertia":true,
                "width":150,
                "height":150,
                "rangex":[-100,100],
                "rangey":[-100,100],
                callOnUpdate: function(items){
                    items.each(function(e, i){
                        var a = new Element("img[src=public/img/middle/"+counterFluid+".jpg]");
                            a.inject(e.node).fade("hide").fade("in");
//THERE
        // Behaviour on click
                                a.addEvent("click", function(e){
                                    // Get Movement
                                    if( wall.getMovement() ){
                                        //(move)
                                    }else{
                                        //(no move)
                                    }
                                })
//THERE
                        counterFluid++;
                        // Reset counter
                        if( counterFluid > maxLength ) counterFluid = 1;
                    })
                }
            });
// Init Fluid Wall
wallFluid.initWall(); 
```

请 - 帮我解决这个问题。我真的需要墙；）

# spring - 两个日期之间的 Spring Data MongoDB 日期

> ID：12308756
> 
> 赞同：9
> 
> 时间：2012-09-06T21:35:54.737
> 
> 标签：spring, mongodb, spring-data-mongodb

我正在为 MongoDB 使用 Spring Data 并获得了以下类

```
class A {
    List<B> b;
}

class B {
    Date startDate;
    Date endDate;
} 
```

当我保存 A 的对象时，它会像

```
{
    "_id" : "DQDVDE000VFP8E39",
    "b" : [
          {
              "startDate" : ISODate("2009-10-05T22:00:00Z"),
              "endDate" : ISODate("2009-10-29T23:00:00Z")
          },
          {
              "startDate" : ISODate("2009-11-01T23:00:00Z"),
              "endDate" : ISODate("2009-12-30T23:00:00Z")
          }
    ]
} 
```

现在我想在数据库中查询与 b 中给定日期在 startDate 和 endDate 之间的条目匹配的文档。

```
Query query = new Query(Criteria.where("b").elemMatch(
    Criteria.where("startDate").gte(date)
    .and("endDate").lte(date)
); 
```

这导致以下 mongo 查询：

```
{
   "b": {
       "$elemMatch": { 
           "startDate" : { "$gte" : { "$date" : "2009-11-03T23:00:00.000Z"}}, 
           "endDate" : { "$lte" : { "$date" : "2009-11-03T23:00:00.000Z"}}
       }
   }
} 
```

但不返回任何结果文档。有人知道我在做什么错吗？我不明白...

非常感谢您提前！！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-07T04:34:02.480

如果你想查找数组元素的和`date`之间的文档，那么你需要反转你的和调用：`startDate``endDate``b``gte``lte`

```
Query query = new Query(Criteria.where("b").elemMatch(
    Criteria.where("startDate").lte(date)
    .and("endDate").gte(date)
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T05:02:36.160

```
{"created_at":{$gt:ISODate("2013-04-30T00:00:00Z"),$lt:ISODate("2013-04-30T23:59:59Z")}} 
```

# actionscript-3 - FLV 播放器皮肤自定义 URL

> ID：12308759
> 
> 赞同：0
> 
> 时间：2012-09-06T21:36:07.577
> 
> 标签：actionscript-3, flash, banner-ads, flvplayer

我有一个 Flash 横幅广告 (AS3)，它使用 FLV 播放器组件来删除视频。皮肤导出它自己的 SWF 文件给带有视频控件的用户，我相信任何熟悉 Flash 的人都知道。

有没有办法远程指定这个文件在哪里？我必须向我的广告商提供 1 个文件，并且不想为此创建自定义视频控件。是否可以将此 swf 文件上传到远程位置并告诉 Flash 从那里提取它？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T00:00:07.667

如果您使用的是实际的 FLV 组件，您将使用该`skin`属性

> 一个字符串，它指定皮肤 SWF 文件的 URL。该字符串可以包含文件名、相对路径（例如 Skins/MySkin.swf）或绝对 URL（例如[http://somedomain.com/MySkin.swf](http://somedomain.com/MySkin.swf)）。

例如

```
vidPlayer.skin = "http://youdomain.com/skin.swf"; 
```

如果你要走这条路，你需要在托管皮肤的服务器上设置一个 crossdomain.xml 文件，这样任何人都可以请求加载皮肤 swf。

我做了一段时间的横幅创作，我记得严格的文件大小限制和一个文件的东西。我最终也在远程服务器上托管了很多内容。

# bash - Inotifywait 不运行命令

> ID：12308761
> 
> 赞同：2
> 
> 时间：2012-09-06T21:36:11.960
> 
> 标签：bash, inotify, stylus

我有一个名为 watch.sh 的基本 inotifywait 脚本和一些以 .styl 结尾的文件，位于同一目录中。这是脚本，它捕获更改，但不执行 do/done 中的代码

我喜欢它`sh watch.sh`，这是脚本

```
#!/bin/sh

while inotifywait -m -o ./log.txt -e modify ./*.styl; do
  stylus -c %f
done 
```

我尝试`echo "hi"`在 exec 部分中，但没有执行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:48:43.180

您遇到的问题`-m`是`inotifywait`. 这会导致命令永远不会退出。由于`while`检查命令的退出状态，命令必须退出才能继续执行循环。

以下是`-m`手册页中的描述：

```
Instead of exiting  after  receiving  a  single  event,  execute
indefinitely.   The default behaviour is to exit after the first
event occurs. 
```

删除该`-m`选项应该可以解决您的问题：

```
while inotifywait -o ./log.txt -e modify ./*.styl; do
  stylus -c %f
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T14:02:49.233

尝试这个：

```
while K=`inotifywait -o ./log.txt --format %f -e modify ./*.styl`; 
do 
   stylus -c $K;
done 
```

# java - 小部件在使用“setlayout(null)”时表现异常

> ID：12308764
> 
> 赞同：0
> 
> 时间：2012-09-06T21:36:24.140
> 
> 标签：java, swing, layout, awt, null-layout-manager

我在我的代码中执行以下调用：

```
...
setLayout(null);
... 
```

我试图通过指定它们的 x 和 y 坐标来放置一个按钮和一个文本字段。

当我运行程序（使用 Eclipse 或 BlueJ）时的问题是我需要在面板上运行到按钮和文本字段的位置，以便分别查看按钮和文本字段。

当我找到文本字段时，它很小。只有当我开始写作时，它才会采用我指定的大小。

有谁知道如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T21:43:39.753

1.  避免 setLayout (null)，除非你有很好的理由。您可以在这里了解布局管理器：http: [//docs.oracle.com/javase/tutorial/uiswing/layout/using.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)

2.  如果您仍想使用 null 布局，则必须设置组件的宽度和高度，而不仅仅是其 x 和 y 位置（参见 setSize 方法）。

从上面提到的链接：

> 尽管我们强烈建议您使用布局管理器，但您可以在没有它们的情况下执行布局。通过将容器的布局属性设置为 null，您可以使容器不使用布局管理器。使用这种称为绝对定位的策略，您必须指定该容器内每个组件的大小和位置。绝对定位的一个缺点是当顶层容器调整大小时它不能很好地调整。它也不能很好地适应用户和系统之间的差异，例如不同的字体大小和语言环境。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:54:32.047

我建议使用该`setBounds`方法而不是`setLocation`

```
 JTextField tf = new JTextField(10);
    Dimension d = tf.getPreferredSize();
    tf.setBounds(x, y, d.width, d.height); 
```

当然，如果您使用的是 null 布局管理器，您还需要处理好您的`preferredSize`. 这是一个包含所有主要方面的示例：

```
import java.awt.*;
import javax.swing.*;

public class TestProject extends JPanel{

    public TestProject(){
        super(null);

        JTextField tf = new JTextField(10);
        add(tf);

        Dimension d = tf.getPreferredSize();        
        tf.setBounds(10, 20, d.width, d.height);

    }

    @Override
    public Dimension getPreferredSize(){
        //Hard coded preferred size - but you'd probably want 
        //to calculate it based on the panel's content 
        return new Dimension(500, 300);
    }

    public static void main(String args[])
    {

        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
                frame.setContentPane(new TestProject());    
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

# visual-studio-2005 - 无法从 'cli::array 转换 ^' 到 'cli::array ^[]'

> ID：12308765
> 
> 赞同：0
> 
> 时间：2012-09-06T21:36:33.707
> 
> 标签：visual-studio-2005, c++-cli

我对 C++/CLI 很陌生，我正在尝试将 System::String 转换为 System::Char 数组。

这是我到目前为止所拥有的：

```
private: System::Void modeToolStripMenuItem_Click(System::Object^  sender, System::EventArgs^  e) {
             Mode frmMode;
             if(frmMode.ShowDialog() == System::Windows::Forms::DialogResult::OK){
                 array <Char>^ load [] = gcnew array<Char>(txtbxName->Text->ToCharArray());
             }
         } 
```

txtbxName 是表单内的文本框。据说，这应该可以工作，但我得到编译器错误：

```
error C2440: cannot convert from 'cli::array<Type> ^' to 'cli::array<Type> ^[]' 
```

对于代码段的第四行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T04:12:04.850

ToCharArray 已经为您提供了数组，您无需创建新数组。此外，正如其他回答者所指出的，您不需要指定`[]`创建数组变量，`array<>`就足够了。

```
array<Char>^ load = txtbxName->Text->ToCharArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:40:44.563

您正试图将对数组 ( ) 的引用分配给对数组 ( `array<Char> ^`) 的引用的 C 样式数组`array<Char> ^ []`。

您很可能打算改用此行：

```
array <Char>^ load = gcnew array<Char>(txtbxName->Text->ToCharArray()); 
```

# c++ - 子网类的比较运算符

> ID：12308773
> 
> 赞同：0
> 
> 时间：2012-09-06T21:37:03.690
> 
> 标签：c++, network-programming, operator-overloading, comparison-operators

我想为子网类定义一些比较运算符。我的第一个想法是我们应该比较子网中的主机数量：

```
192.168.0.0/24 < 192.168.0.0/23
               ||
               \/
254            < 510 (evaluates true) 
```

我不确定在两个大小相似但不同的子网的情况下应该做什么：

```
10.0.0.0/24 < 192.168.0.0/24
            ||
            \/
254         < 254 (evaluates ?) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:39:26.730

您可以按字典顺序对*pair* `(size, address)`进行排序。这将最小的子网放在首位，在一个大小内，您按网络地址值排序：

```
struct netclass { uint32_t size; uint32_t addr; };

bool operator<(netclass const & nc1, netclass const & nc2)
{
    return (nc1.size < nc2.size) ||
           (!(nc2.size < nc1.size) && (nc1.addr < nc2.addr));
} 
```

# c# - 没有 ravenDB 的 NServiceBus 基本消息发布者

> ID：12308774
> 
> 赞同：2
> 
> 时间：2012-09-06T21:37:07.663
> 
> 标签：c#, nservicebus

我试图创建一个非常基本的 NServicebus.Host 应用程序，它每秒发送一条消息。我不想使用任何使用 RavenDB 的 NServiceBus 持久性东西（即超时/传奇）。

我做了以下事情：

```
public class EndpointConfig : IConfigureThisEndpoint, AsA_Server, AsA_Publisher, IWantCustomInitialization
{
    public void Init()
    {
        Configure.With()
            .DisableTimeoutManager();
    }
} 
```

和

```
public class MessageSender : IWantToRunWhenTheBusStarts
{
    private readonly IBus _bus;

    public MessageSender(IBus bus)
    {
        _bus = bus;
    }

    public void Run()
    {
        Task.Factory.StartNew(() =>
        {
            while (true)
            {
                _bus.Publish(new MyMessage { Timestamp = DateTime.Now });
                Thread.Sleep(1000);
            }
        });
    }
} 
```

但是我在发布行出现异常：

> System.Net.WebException 未被用户代码处理
> HResult=-2146233079 消息=无法连接到远程服务器
> Source=System StackTrace：在 Raven.Client.Connection.HttpJsonRequest.ReadStringInternal(Func) 的 System.Net.HttpWebRequest.GetResponse() `1 getResponse) at Raven.Client.Connection.HttpJsonRequest.ReadResponseString() at Raven.Client.Connection.HttpJsonRequest.ReadResponseJson() at Raven.Client.Connection.ServerClient.DirectGet(String serverUrl, String key) at Raven.Client.Connection.ServerClient.<>c__DisplayClass1.<Get>b__0(String u) at Raven.Client.Connection.ServerClient.TryOperation[T](Func`Raven.Client.Connection.ServerClient.ExecuteWithReplication[T] 处的 2 操作，String operationUrl，布尔型 AvoidThrowing，T& 结果（String 方法，Func `2 operation) at Raven.Client.Connection.ServerClient.Get(String key) at Raven.Client.Document.DocumentSession.Load[T](String id) at System.Linq.Enumerable.WhereSelectArrayIterator`2.MoveNext() at System.Linq.Enumerable.WhereEnumerableIterator `1.MoveNext() at System.Linq.Enumerable.<SelectManyIterator>d__14`2.MoveNext() at System .Linq.Enumerable.d_ *81 `1.MoveNext() at System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source) at NServiceBus.Unicast.UnicastBus.Publish[T](T[] messages) at ClassLibrary1.MessageSender.b*_1() in at System.Threading.Tasks.Task.Execute() InnerException: System.Net.Sockets.SocketException HResult=-2147467259 Message=无法建立连接，因为目标机器主动拒绝它 127.0.0.1:8080 Source= System ErrorCode=10061 NativeErrorCode=10061 StackTrace: 在 System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress) 在 System.Net.Sockets.Socket.InternalConnect(EndPoint remoteEP) 在 System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket&socket, IPAddress&地址, ConnectSocketState状态, IAsyncResult asyncResult, Exception&异常)

这表明 NServiceBus 仍在尝试连接到 RavenDB。

我还需要禁用什么才能使此示例正常工作？

为什么它甚至试图连接到 RavenDB 进行基本发布？

注意：我还没有订阅者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T22:27:08.597

看起来 NServiceBus 默认也使用 RavenDB 进行订阅存储。通过指定备用存储机制，我能够使这个示例正常工作。

```
 .MsmqTransport()
                .MsmqSubscriptionStorage()
            .DisableTimeoutManager(); 
```

并在 app.config

```
<configuration>
    <configSections>
        <section name="MessageForwardingInCaseOfFaultConfig" type="NServiceBus.Config.MessageForwardingInCaseOfFaultConfig, NServiceBus.Core" />
        <section name="MsmqSubscriptionStorageConfig" type="NServiceBus.Config.MsmqSubscriptionStorageConfig, NServiceBus.Core" />
    </configSections>
    <MessageForwardingInCaseOfFaultConfig ErrorQueue="error" />
    <MsmqSubscriptionStorageConfig Queue="YourQueue" />
</configuration> 
```

# .net - 在其他项目中使用 App_GlobalResources

> ID：12308778
> 
> 赞同：1
> 
> 时间：2012-09-06T21:37:26.517
> 
> 标签：.net, embedded-resource

我有一个网站，其中 App_GlobalResources 定义了所有网站的文本值。这些可以通过强类型对象（Resources.GlobalResource）在视图中访问，效果很好。

我已将控制器分离到另一个项目中，但无法访问网站中的 App_GlobalResources，但需要（他们在控制器中生成了一些控件并需要在那里进行本地化）。

如何最好地从另一个项目访问 App_GlobalResources？

# python - 干扰物体（或不那么险恶的东西？）

> ID：12308779
> 
> 赞同：0
> 
> 时间：2012-09-06T21:37:27.903
> 
> 标签：python, oop, object

我创建了一个 word 对象，它只包含两个方法，并且只接受两个参数。尽管看起来很简单，但它的行为方式超出了我的理解：如果我创建同一个对象的两个实例，使用相同的第一个参数（在本例中为“伪装”），第二个实例会以某种方式干扰第一个实例。打印实例表明它们确实是分开的，那么为什么会以这种方式交互呢？

```
# Example tested with Python 2.7.3

from collections import namedtuple
DefinitionTuple = namedtuple("Definition", "word word_id text pos")

class Word(object):

    def __init__(self, word, defs=None):
        """"""
        self.definitions = []       
        self.word = word

        if defs != None:
            for each in defs:
                try:
                    each.pos
                    if each.word.lower() == self.word.lower():
                        self.definitions.append(each)
                except AttributeError:
                    raise AttributeError("Definitions must be named tuples")

            self.orderDefinitions()

    def orderDefinitions(self):
        """"""  
        ordered = sorted(self.definitions, key=lambda definition: definition.pos)
        for i,each in enumerate(ordered):
            each.pos = (i+1)

        self.definitions = ordered

class Definition(object):
    """"""
    def __init__(self, definition):
        """Incoming arg is a single namedtuple"""       
        self.word = definition.word
        self.word_id = definition.word_id
        self.text = definition.text
        self.pos = definition.pos       

if __name__ == "__main__":
    nt1 = DefinitionTuple("dissemble", 5, "text_string_a", 1)
    nt2 = DefinitionTuple("dissemble", 5, "text_string_b)", 2)
    nt3 = DefinitionTuple("dissemble", 5, "text_string_c", 3)   

    # Definiton objects
    def_1 = Definition(nt1)
    def_2 = Definition(nt2)
    def_3 = Definition(nt3)

    dissemble = Word("dissemble", [def_1, def_2, def_3])
    print "first printing: "
    for each in dissemble.definitions:
        print each.pos, each.text

    # create a new instance of Word ...
    a_separate_instance = Word("dissemble", [def_3])    

    # ... and now the 'pos' ordering of my first instance is messed up!
    print "\nnow note how numbers differ compared with first printing:"     
    for each in dissemble.definitions:
        print each.pos, each.text 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:45:13.980

您创建 的新实例`Word`，但重复使用 的相同实例`def_3`：

```
a_separate_instance = Word("dissemble", [def_3]) 
```

这是有状态的。如果我们使用`vars`：

```
print vars(def_3)
# create a new instance of Word ...
a_separate_instance = Word("dissemble", [def_3])    
print vars(def_3) 
```

我们看

```
{'text': 'text_string_c', 'word': 'dissemble', 'pos': 3, 'word_id': 5}
{'text': 'text_string_c', 'word': 'dissemble', 'pos': 1, 'word_id': 5} 
```

由于`orderDefinitions`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T21:48:59.263

在您的`orderDefinitions`方法中，您正在修改对象的`pos`属性`Definition`：

```
each.pos = (i+1) 
```

因此，当您`orderDefinitions`第二次调用时，您将执行`def_3.pos = 1`.

但是，`dissemble`持有对该对象的引用，该`def_3`对象的`pos`属性现已更改，因此您的问题。

# iphone - Cocoa：在 webkit 中执行时无法访问 HTML5 Web 应用程序的本地数据库

> ID：12308780
> 
> 赞同：0
> 
> 时间：2012-09-06T21:37:28.413
> 
> 标签：iphone, cocoa, html, webkit, local-storage

请帮助我，我想做的是我有

1.  一个带有 webkit 的 Cocoa 应用程序。
2.  具有本地数据库的基于 HTML5 的 Web 应用程序。

我正在尝试在可可应用程序中运行此 HTML5 应用程序并收到此错误**“错误：未知错误错误：SECURITY_ERR：DOM Exception 18。”** 相同的应用程序在

1.  苹果浏览器
2.  苹果浏览器
3.  UIWebkit

我尝试过以下事情

```
@interface WebPreferences (WebPreferencesPrivate)
- (void) _setLocalStorageDatabasePath:(NSString *)path;
- (void) setDatabasesEnabled: (BOOL) databaseEnabled;
- (void) setLocalStorageEnabled: (BOOL) localStorageEnabled;
@end

WebPreferences* prefs = [self.mainWebVEW preferences];
[prefs _setLocalStorageDatabasePath:appdir];
[prefs setDatabasesEnabled:YES];
[prefs setLocalStorageEnabled:YES];
[prefs setDefaultFontSize:20]; 
```

唯一看起来有效的偏好是字体大小。

任何人都可以帮我解决这个问题吗？

提前致谢

问候

Ankit

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T18:24:19.947

好的，所以最终解决了你所要做的就是再使用一个私有 API

```
@interface WebView(WebViewPrivate)
- (void)webView:(WebView *)sender frame:(WebFrame *)frame exceededDatabaseQuotaForSecurityOrigin:(id) origin database:(NSString *)databaseIdentifier;
@end

- (void)webView:(WebView *)sender frame:(WebFrame *)frame exceededDatabaseQuotaForSecurityOrigin:(id) origin database:(NSString *)databaseIdentifier
{
static const unsigned long long defaultQuota = 5 * 1024 * 1024;
if ([origin respondsToSelector: @selector(setQuota:)]) {
    [origin performSelector:@selector(setQuota:) withObject:[NSNumber numberWithLongLong: defaultQuota]];
} else { 
    NSLog(@"could not increase quota for %@", defaultQuota); 
}
} 
```

# jquery - 为一个元素设置多个值

> ID：12308781
> 
> 赞同：2
> 
> 时间：2012-09-06T21:37:30.100
> 
> 标签：jquery, prettyphoto, rel

我正在制作一个可点击的 DIV，如下所示：

```
jQuery(".post").click(function(){
    window.location=jQuery(this).find(".post-title a").attr("href");
    return false;
}); 
```

但我也想为其添加 rel 属性，以便链接可以在灯箱中打开。我尝试添加`.attr("rel=prettyphoto")`，但似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:39:33.293

它应该是：

```
$("whatever").attr("rel", "prettyphoto"); 
```

正如文档所[指出](http://api.jquery.com/attr/)的：

```
attr( name ) is the getter
attr( name, value ) is the setter 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:40:33.930

您应该`rel`在页面加载时添加属性，而不是在点击时添加属性，并确保在初始化灯箱脚本之前执行此操作。在单击时设置属性没有意义，因为无论如何都会重新加载页面，并且该属性会消失。

所以：

```
// Inside this block we're sure the DOM is loaded,
// so we can init our stuff
$(document).ready(function() {

    // Add rel to post title links
    $('.post .post-title a').attr('rel', 'lightbox');

    // Now init your lightbox script
    // (your init code here)

    // Now set the click handler (does not have to be last)
    $(".post").click(function(){
        window.location=$(this).find(".post-title a").attr("href");
        return false;
    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:44:54.670

如果我是你，我会把它分成几个步骤，你实际上会在这个过程中回答你自己的问题。

```
jQuery(".post").click(function(){

    // store the link in var
    var link = jQuery(this).find(".post-title a");

    // set the rel
    link.attr('rel','prettyphoto');

    // get the href
    var location = link.attr("href");

    window.location=location;
    return false;
}); 
```

另外，请记住该`.attr( attrName [, attrVal] )`方法有两个参数：如果您在函数中编写第二个参数，它将*设置*一个值。

# java - 从另一个类访问 Class 的实例

> ID：12308791
> 
> 赞同：-2
> 
> 时间：2012-09-06T21:38:24.527
> 
> 标签：java

我正在使用 API 编写一个项目。所以总的来说我的程序看起来像这样。

```
public class Programm extends bridge {
Client Eclient = new Client() ;
public static void main(String[] args) {
Programm MyProgramm = new Programm();
MyProgramm.MyMethod();
public void MyMethod(){
 Runnable countdown = new flipper();
 Thread worker = new Thread(countdown);
 worker.start();
}
}
abstract bridge implements API{}
class flipper implements runnable {
public void run(){MyProgramm.Eclient.ApiMethod()}
} 
```

基本上我需要访问 EClient 类实例，因为它会被 MyProgramm 实例从类翻转器访问

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:45:53.910

```
class flipper implements Runnable {
private ESocket lEClient;
   public flipper (Object pEClient) {
     lEClient = pEClient;
   } 
```

然后你调用使用这样的构造函数：

```
public void MyMethod()
 {

   Runnable countdown = new flipper(Eclient);

  Thread worker = new Thread(countdown);
   worker.start();
 }

public void run() {lEClient .Apimethod()} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:54:17.850

选项 2：使 Flipper 成为内部类

```
public class Program extends bridge {
   Client eClient = new Client() ;
   public void main(String[] args) {...}
   public void myMethod(){...}
   class Flipper implements Runnable {
      public void run(){Program.eClient.apiMethod()}
   }
} 
```

# jquery - 使用 jquery 选择 window.opener

> ID：12308792
> 
> 赞同：0
> 
> 时间：2012-09-06T21:38:27.697
> 
> 标签：jquery

> **可能重复：**
> [如何使用 jquery 访问父窗口对象？](https://stackoverflow.com/questions/2167455/how-to-access-parent-window-object-using-jquery)

我有以下 jquery 代码

```
var events = $(window.opener).find("tr.athletics-date");
        var events_length = events.length; 
```

我正在尝试从父页面（打开当前的新页面）中检索所有带有运动日期类的 tr 标签，但它不起作用。类名是正确的，我做错了什么？events_lenth 为 0！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:42:49.680

`window.opener`给你`window`对象，你想要`document`对象。

```
$(window.opener.document).find(... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:53:56.067

`window.opener.document`有所作为。

尝试这个：

```
var events = $(window.opener.document).find("tr.athletics-date");
var events_length = events.length; 
```

# vb.net - 如何在VB中为文件夹分配挂载点

> ID：12308796
> 
> 赞同：0
> 
> 时间：2012-09-06T21:38:47.223
> 
> 标签：vb.net, directory, mount-point

我希望我的措辞是正确的……无论如何……在编写 VB 程序时，我注意到了一些事情。在文件资源管理器中，`C:\Users\Username\`您会看到类似`My Documents`和的文件夹`My Pictures`。当您在命令提示符下查看它们时，您会看到它们实际上被称为`Documents`and `Pictures`。诡异的。

现在假设我想在 VB 中创建一个名为的文件夹，`My Files`但我希望它指向实际的文件夹`Files`。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T13:02:04.040

我不能保证这一点，但我听说你可以通过[Create A Special Folder In Windows Explorer](http://a2ztricks.blogspot.com/2008/04/create-special-folder-in-windows.html)来实现它。我肯定会先备份您的注册表。

您可以使用[Namespace Extensions](http://msdn.microsoft.com/en-us/library/cc144095%28v=vs.85%29.aspx)创建“虚拟文件夹” 。.NET 很痛苦。有像[EZNamespaceExtensions.Net](http://www.ssware.com/eznamespaceextensions/eznamespaceextensions.htm)这样的组件可以让这个过程变得更容易一些。

# groovy - 像 WHERE 子句一样使用 XmlSlurper 进行选择

> ID：12308802
> 
> 赞同：0
> 
> 时间：2012-09-06T21:39:57.060
> 
> 标签：groovy, xmlslurper, gpath

给定以下 HTML 片段，我需要为属性等于的`meta`标签和属性`name`等于`description`的`meta`标签`property`提取内容属性的文本`og:title`。我已经尝试过[Groovy: Correct Syntax for XMLSlurper to find elements with a given attribute](https://stackoverflow.com/questions/100325/groovy-correct-syntax-for-xmlslurper-to-find-elements-with-a-given-attribute)中显示的内容，但它在 Groovy 1.8.6 中似乎不一样。

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <meta property="fb:admins" content="100003979125336" />
    <meta name="description" content="Shiny embossed blue butterfly" />
    <meta name="keywords" content="Fancy That Blue Butterfly Platter" />
    <meta property="og:title" content="Fancy That Blue Butterfly Platter" /> 
```

有没有一种干净的方法来用 GPath 检索这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:27:43.460

这适用于 groovy 2.0.1 - 我目前手头没有 1.8.6：

```
def slurper = new XmlSlurper()
File xmlFile = new File('sample.xml')
def xml = slurper.parseText(xmlFile.text)
println 'description = ' + xml.head.children().find{it.name() == 'meta' && it.@name == 'description'}.@content
println 'og:title = ' + xml.head.children().find{it.name() == 'meta' && it.@property == 'og:title'}.@content 
```

# java - 在java中，有没有办法确保在finally块中调用多个方法？

> ID：12308812
> 
> 赞同：5
> 
> 时间：2012-09-06T21:41:06.410
> 
> 标签：java, exception, exception-handling, try-catch-finally, try-finally

所以我有一个 try/finally 块。我需要在 finally 块中执行一些方法。但是，这些方法中的每一个都可能引发异常。有没有办法确保在没有嵌套 finally 块的情况下调用（或尝试）所有这些方法？

这就是我现在所做的，这很丑陋：

```
protected void verifyTable() throws IOException {
    Configuration configuration = HBaseConfiguration.create();
    HTable hTable = null;                                               

    try {
        hTable = new HTable(configuration, segmentMatchTableName);      

        //...
        //various business logic here
        //...

    } finally {                         
        try {
            try {
                if(hTable!=null) {
                    hTable.close(); //This can throw an IOException
                }               
            } finally {
                try {
                    generalTableHelper.deleteTable(configuration, segmentMatchTableName); //This can throw an IOException
                } finally {
                    try {
                        generalTableHelper.deleteTable(configuration, wordMatchTableName); //This can throw an IOException
                    } finally {
                        generalTableHelper.deleteTable(configuration, haplotypeTableName); //This can throw an IOException      
                    }
                }
            }                               
        } finally {
            HConnectionManager.deleteConnection(configuration, true); //This can throw an IOException   
        }
    }               
} 
```

有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:55:44.963

如果这是 Java 7，您可以考虑使用新的 try-with-resources 构造。您可能需要创建一些基本`AutoCloseable`的包装来删除表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T22:14:06.290

在 Java 中正确的资源管理的标准（工作）方法（该原则也适用于其他语言）是：

```
Resource resource = acquire(resource);
try {
    use(resource);
} finally {
    resource.release();
} 
```

或者在当前版本的 Java SE 中使用快捷方式（稍微聪明一点）：

```
try (Resource resource = acquire(resource)) {
    use(resource);
} 
```

（正如 Joe K 指出的那样，您可能需要包装资源以使其确认 Java 语言所依赖的特定接口。）

两个资源，你只需应用成语两次：

```
Resource resource = acquire(resource);
try {
    SubResource sub = resource.acquire();
    try {
        use(sub);
    } finally {
        sub.release();
    }
} finally {
    resource.release();
} 
```

在 Java SE 7 中：

```
try (
    Resource resource = acquire(resource);
    SubResource sub = resource.acquire()
) {
    use(resource, sub);
} 
```

新语言功能的真正巨大优势是资源处理在写出时经常被破坏。

您可能有更复杂的异常处理。例如，您不想抛出低级异常，例如`IOException`通过适当的应用程序 - 您可能希望将`RuntimeException`. 这可以使用 Execute Around 成语（参见[这个*优秀的*问题](https://stackoverflow.com/q/341971/4725)）来解决，因为 Java 的典型冗长性。从 Java SE 8 开始，还会有更短的语法和随机不同的语义。

```
with(new ResourceSubAction() { public void use(Resource resource, SubResource sub) {
    ... use resource, sub ...
}}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:47:47.557

一般来说，这是没有办法的。您需要多个 finally 块。

但是，我不想评论您的特定代码，无论这是否是适当的设计。它看起来确实很奇怪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:55:26.577

没有办法我害怕。关闭 io 资源时也有类似的模式。例如，当关闭文件引发 IOException 时，您会怎么做？通常你只需要忽略它。因为这有点像反模式，所以他们在 Java 7 中引入了 try-with 语法。对于您的示例，尽管我认为没有其他选择。也许将每个 finally 放入自己的方法中以使其更清晰

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T21:55:34.667

要从 finally 块调用多个方法，您必须确保它们都不抛出 - 无论如何这是一个好主意，因为从 finally 块抛出的任何异常都将覆盖从 try/catch 抛出的异常或返回值。

最常见的用例是文件或数据库连接，在这种情况下，您编写“安静地关闭”方法（或使用现有库中的一个，例如 Jakarta Commons IO）。如果你需要清理的东西不允许你使用预先存在的方法，你自己写（在你的情况下，`deleteTableQuietly()`）。

如果您使用的是 JDK-7，您还可以使用“ [try with resource](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html) ”构造。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-06T21:56:14.950

您可以使用 execute 方法创建一个抽象类 Action，并从该类派生一个类，用于每个要调用的抛出异常的方法，从 execute 方法调用此方法。然后，您可以创建一个 Action 列表并遍历列表中的元素，在 try finally 块中调用它们的 execute 方法，忽略异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-06T22:27:08.150

```
deleteTableSilently(table1);    
deleteTableSilently(table2);    
deleteTableSilently(table3);

deleteTableSilently()
    try
        deleteTable()
    catch whatever
        log.error(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-06T23:26:14.780

考虑使用 java.util.concurrent 框架——如果将每个调用编码为单独的 Callable（命名或匿名），则可以使用 ExecutorService.invokeAll。

# c - c - 将指针传递给函数

> ID：12308813
> 
> 赞同：4
> 
> 时间：2012-09-06T21:41:09.333
> 
> 标签：c, function, pointers

我正在尝试更改指针 min 和 max 指向的位置，但似乎“更改”并未超出函数的范围（在函数运行后）。在运行函数之前，我将 *min 和 *max 设置为指向“double m = 0”。我是一个菜鸟，所以任何建议都将不胜感激。

```
int min_max(double * min , double * max , int size , double a[]){                                                                       
int i;                                                                                                                                

printf("\n%lg\t%lg\n", *min, *max);                                                                                                   

min = &a[0];                                                                                                                          
max = &a[0];                                                                                                                          

for (i = 1 ; i < size ; i++) {                                                                                                        
 if (a[i] > *max)                                                                                                                    
  max = &a[i];                                                                                                                      
 else if (a[i] < *min)                                                                                                               
  min = &a[i];                                                                                                                      
 }                                                                                                                                     
 printf("\n%lg\t%lg\n", *min, *max);                                                                                                   
 return 0;                                                                                                                             
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-06T21:45:28.533

如果您发送指向双精度的指针，则您允许该双精度的内容发生变化。如果要更改指针，则必须向指针 ( `double**`) 发送一个指针，它允许指针的内容发生更改。

```
int min_max(double ** min , double ** max , int size , double a[]){  
    int i;                                                                                                                                

    printf("\n%lg\t%lg\n", **min, **max);                                                                                                   

    *min = &a[0];                                                                                                                          
    *max = &a[0];                                                                                                                          

    for (i = 1 ; i < size ; i++) {                                                                                                        
        if (a[i] > **max)                                                                                                                    
            *max = &a[i];                                                                                                                      
        else if (a[i] < **min)                                                                                                               
            *min = &a[i];                                                                                                                      
    }                                                                                                                                     
    printf("\n%lg\t%lg\n", **min, **max);                                                                                                   
    return 0;                                                                                                                             
} 
```

由于此处进行了所有取消引用，因此保留两个本地指针甚至仅保留索引并在循环结束时设置一次返回值可能是有意义的。

*[编辑]*

> 为什么我不能更改函数中的指针？如果我改为发送一个数组（类似指针的东西）来保留最小值和最大值，比如 minmax[0]=min 和 minmax[1]=max，这些值会改变，不是吗？

好吧，有点，但是您要求的是指向最小值和最大值的数组元素的指针，而不是实际值。因此，即使您传递了一个数组来实现这一点，它也必须是一个指针数组（`double *minmax[2]`）。现在，这实际上只是 a`double**`指向两个`double*`值（您分别索引为元素 0 和 1）。所以这是一样的。

现在，为什么不能更改指针？你可以！但是您的更改仅限于您的功能范围内。您不能*在调用者处将值更改回，*因为`double*`指针是按值传递的。在我让您感到困惑之前，您可能需要先阅读一下按值传递和按引用传递，但总体思路是这样的：

您发送给函数的任何数据类型都会被有效地复制。因此，如果您传递 a `double`，则该值将从调用者复制到新的内存位置（函数的参数）。该函数现在没有引用该值的原始位置。

```
void my_func( double val ) {
    val = 42;  // Does not affect caller's value because it was copied
}

double value = 1;
my_func( value );
// value is still 1 
```

当你通过一个`double*`. 您正在将`double`值的地址发送给函数，但*实际地址*（指针）是复制到`double*`提供给函数的值。

```
void my_func( double* val ) {
    *val = 42;  // Stuff 42 into the memory location pointed to by 'val'.
}

double value = 1;
my_func( value );
// value is now 42 
```

但是您的调用者似乎想要最大值和最小值数组中的实际地址（除非这是由于指针新手而导致的错误）。在这种情况下，指针是不够的，因为您正在复制指针的内容。在这里，您需要获取保存指针的内存地址并将其传递给函数。该地址被复制，当您引用它时，您可以将指针写入该内存位置。

```
void my_func( double** val ) {
    *val = *val + 1;  // Change the pointer pointed to by 'val'.
}

double values[4] = { 1, 2, 3, 42 };
double *value = &values[2];         // value points to '3'.
my_func( &value );
// value now points to 42 
```

每当您提供指向要由函数更改的值的指针时，它被称为通过引用传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:47:13.507

你的功能应该是

```
int min_max(double ** min , double ** max , int size , double a[]); 
```

调用语句应该是

```
int *min,*max;
min_max(&min,&max,...); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T21:45:01.187

您无法更改指针指向的位置并在函数外部查看这些更改。由于您已经传递了指针，因此您可以更改指向的内容*，*但指针本身是按值传递的：您只是在更改副本。

要更改指针本身，您需要将指针传递给指针：

```
int min_max(double**, double**, int, double); 
```

# ruby - Ruby:: 在 Windows 上安装 ruby -debug-ide 时出错

> ID：12308817
> 
> 赞同：2
> 
> 时间：2012-09-06T21:41:34.763
> 
> 标签：ruby, debugging

[我参考这篇文章在 eclipse aptana 插件](https://stackoverflow.com/questions/6104548/how-to-debug-ruby-on-rails-in-eclipse-aptana-plugin)ruby​​-debug-ide 和这个[链接](http://www.rubytips.org/2011/12/20/installing-ruby-on-windows-7-ruby-1-9-x-guide/)中安装How to debug on rails on rails 。

我已经安装

```
C:\Users>gem install ruby-debug-ide --platform=ruby --pre
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
Successfully installed ruby-debug-ide-0.4.17.beta14
1 gem installed
Installing ri documentation for ruby-debug-ide-0.4.17.beta14...
Installing RDoc documentation for ruby-debug-ide-0.4.17.beta14... 
```

但是当我安装 ruby​​-debug-ide 时出现此错误

```
C:\Users>gem install ruby-debug-ide --platform=ruby
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing ruby-debug-ide:
        ERROR: Failed to build gem native extension.

        C:/Ruby193/bin/ruby.exe mkrf_conf.rb
Building native extensions.  This could take a while...

Gem files will remain installed in C:/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.16 for inspection.
Results logged to C:/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.16/ext/gem_make.out 
```

这是我的环境

```
C:\Users>gem environment
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.11
  - RUBY VERSION: 1.9.3 (2011-10-30 patchlevel 0) [i386-mingw32]
  - INSTALLATION DIRECTORY: C:/Ruby193/lib/ruby/gems/1.9.1
  - RUBY EXECUTABLE: C:/Ruby193/bin/ruby.exe
  - EXECUTABLE DIRECTORY: C:/Ruby193/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-mingw32
  - GEM PATHS:
     - C:/Ruby193/lib/ruby/gems/1.9.1
     - C:/Users/username/.gem/ruby/1.9.1
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T21:58:07.940

你试过了吗

```
gem install ruby-debug-ide --platform=ruby --pre 
```

[它应该工作](http://www.rubytips.org/2011/12/20/installing-ruby-on-windows-7-ruby-1-9-x-guide/)。

# javascript - 使用 CSS 为 CKEditor 中的预览设置样式

> ID：12308819
> 
> 赞同：3
> 
> 时间：2012-09-06T21:41:44.673
> 
> 标签：javascript, html, ckeditor, wysiwyg

我已将 CKEditor 集成到我的网站 CMS 中。预览按钮有效，但我无法让它使用样式表 (CSS)。我已经编辑了 preview.html 位于：

网站/ckeditor/plugins/preview/

但它似乎没有听我环绕从所见即所得编辑器中提取内容的代码的任何 html。

据我了解这段代码：

```
<script>

var doc = document;
doc.open();
doc.write( window.opener._cke_htmlToLoad );
doc.close();

delete window.opener._cke_htmlToLoad;

</script> 
```

拉入编辑器中的任何内容，因此我应该能够环绕该 html 以包含可用于每个页面的元素？以及指向样式表的链接？

有人做过吗？可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:52:27.170

“window.opener._cke_htmlToLoad”似乎是一个字符串（包含一个完整的 html 文档）。

要获取 <body></body> 的 innerHtml，可以使用以下正则表达式：

```
var doc = window.opener._cke_htmlToLoad; // is string
var innerBody = ( doc.replace(/((?:.(?!<\s*body[^>]*>))+.<\s*body[^>]*>)|(<\s*\/\s*body\s*\>.+)/g,'') );
document.getElementById('insertIntoMe').innerHTML = innerBody; 
```

从我的测试来看，这似乎只适用于 Firefox。但是 Chrome 和 Internet Explorer 直接显示窗口文档，不允许任何更改。那么也许其他人可以提供更好的解决方案？

# javascript - 在 kendoui 的列表视图中添加一个按钮以打开模式窗口

> ID：12308821
> 
> 赞同：0
> 
> 时间：2012-09-06T21:41:45.623
> 
> 标签：javascript, jquery, html, kendo-ui

我需要在 Listview (PHP/Json) 结果的每个元素上添加一个按钮，以打开一个模式窗口，客户可以在其中输入他的预订信息，如日期、成人和儿童，这是我的 JavaScript 代码：

```
<script>
 $(document).ready(function() {
        var dataSource = new kendo.data.DataSource({
                pageSize: 8,
                transport: {
                    read: "tours_lista.php",
                         dataType: "jsonp"
                },
                schema: {   
                    data: "data",
                    total: "data.length"
                }

            });

        $("#pager").kendoPager({
            dataSource: dataSource,

        });

        $("#listView").kendoListView({
            dataSource: dataSource,

            template: kendo.template($("#template").html())
        });

    }); 
```

这是我的 HTML 代码：

```
<div id="intro" >
    <H3>TOURS</H3>
<div id="listView"></div>
<div id="pager" class="k-pager-wrap"></div>
<script type="text/x-kendo-tmpl" id="template">
  <div class="product">
       <a class="t-link"  href="inicio.php?action=detalle&tourid=${recid}"><img  src="controlc/test/${main_pic}" title="Ver detalles de ${tit_esp}" /></a>
        <h3>${tit_esp}</h3>
        <dl>
            <dt>Adulto: </dt>
            <dd>$ ${rate_adult}</dd>
            <dt>Niño: </dt>
            <dd>$ ${rate_child}</dd>

        </dl>
         <div style="text-align:right;float:right;border:0px solid red;padding-top:7px;padding-left:5px;width:250px;height:30px;">
         </div>
    </div>
</script>
</div>
 <!-- end .intro --> 
```

我正在使用 Kendo UI Web

附件是我想做的一张泰国图片，很高兴收到提示，我有几天时间寻找它，问候，

胜利者 ![在此处输入图像描述](../Images/82a42e489b85cc3d6da26d9951c9b36f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T10:47:52.800

看起来你已经大部分时间了。

您缺少的只是 html 中的一个按钮和一个回调。我这样做的方式只是一个普通按钮，与 html 中的任何内容无关。但是在 JS 中，在列表视图的渲染事件中，您将需要一个 jquery 选择器来获取列表视图的所有元素。然后，您可以在这些上 .each 并向传递给定按钮所在元素的 id 的按钮添加一个单击事件。单击处理程序可以将此 id 作为参数并使用它在数据源中查找适当的项目。然后使用表单数据，你可以做任何你想做的事情，比如发出你的 ajax 请求。

哦，我发现的一个问题是，每次列表视图重新绘制自身时，kendo 都会使用您的模板在 dom 中重新创建整个列表。因此，您在 jquery 中为事件绑定的任何按钮都将有效地成为新按钮。所以这就是我建议将绑定代码放在 listview 事件中进行绘画的方法。因此，您可以确定它会在正确的位置触发。

# c# - 试图理解 MVC。这是正确的吗？

> ID：12308823
> 
> 赞同：1
> 
> 时间：2012-09-06T21:41:59.507
> 
> 标签：c#, model-view-controller, events, design-patterns, chess

它的解释方式是通过使用事件和发布/订阅模型。基本上，模型只是数据，它不知道视图/GUI/UI。模型通常只是一个抽象对象，它对其数据进行操作，并且可以执行操作等等。

视图是一个不同的类，它响应模型中的变化并且通常将这些数据显示给用户。以前，我不知道如果没有视图和模型之间的耦合，这怎么会发生，但是用事件解释它可以消除很多混乱。这是否意味着模型包含在发生有趣事情时自身引发的公共事件？例如，如果我们正在编写一个国际象棋游戏，当一个棋子被移动时，模型将`PieceMoved`使用必要的信息（哪一个棋子，从哪里移动到哪里等）引发事件，并且视图可以订阅这样一个事件，然后显示作品从旧方块移动到新方块的动画。

仍然让我感到困惑的部分是控制器的确切性质。我无法理解它如何为模型和视图提供新信息。我想控制器包含对模型和视图的引用。与国际象棋示例保持一致，控制器是否会仅响应用户输入（例如移动棋子），然后仅向模型建议要移动的棋子到哪里？然后模型获取这些信息，查看它是否是合法的移动，如果是，相应地更新模型，引发`PieceMoved`事件，视图对此做出反应并相应地更新图形领域？

最后，控制器如何找出试图移动的部分？似乎这种类型的东西与视图密切相关（假设移动涉及首先单击您要移动的部分，然后单击目标方块）。我想控制器会响应鼠标点击并将这些坐标发送给模型，但是模型如何知道如何转换这些坐标以找到选择了哪一块？这不是与视图密切相关吗？看起来视图必须执行一些逻辑处理，而不是简单地响应模型和控制器，但它不再是正确的视图（而是视图/模型组合）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:48:53.840

MVC 是一个非常通用的概念。它有很多不同的实现方式，其中大多数都有某种妥协。

我看到的问题是您正试图采用一个深奥的概念并将具体的实现细节应用于它。这很难做到，除非您有一个非常具体的实现（asp.net MVC、fubuMVC、spring MVC、smalltalk MVC 等等），并且每个实现都以不同的方式完成通知和事件处理之类的事情。

如果您只是在谈论 MVC 概念，那么您必须以通用的方式处理 MVC 概念。我知道如果你有一个具体的实现可能会更容易理解，但是你会根据对实现的理解走上理解模式（MVC）的道路，这可能会扭曲你对模式本身的理解。

因此，当您阅读有关消息或事件的信息时，您只需要考虑“某种由实现定义的机制”。它可能是一个回调，或者它可能是一个 C# 事件，或者它可能是一个 Windows 消息，或者它可能正在使用强制 ;)

编辑：

关于您的更新，我会重复一遍。您无法回答有关通用概念的实现特定细节。您必须定义一个特定的实现，以便有人能够告诉您这些实现细节是如何完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:10:38.590

这个问题有很多答案，主要是因为有太多不同的 MVC 框架。查看[http://martinfowler.com/eaaDev/uiArchs.html](http://martinfowler.com/eaaDev/uiArchs.html)获取一些示例。我也可以给出一个 MVVM 的观点，主要是因为这是我这些天一直在做的事情，所以这就是我的想法。

模型层基本上是您的数据和业务逻辑。您可能在这里与数据库或 Web 服务通信。如果您最终编写了一个系统，而不仅仅是一个 GUI，那么这就是您的可重用代码。

然后 ViewModel 位于 Model 之上，基本上将数据呈现（咳咳）作为属性。它使用 INotifyPropertyChanged 接口在数据更改时通知 UI。如果在将数据推送到模型层之前，您有用于构建某些东西的数据，那么它就存在于此。您通常会将可以在 UI 中执行的操作公开为 ICommands。

View 层是耦合度最低的，因为它只是使用绑定来连接 ViewModel。要可视化的东西是与用于更改其形式的可选 IValueConverters 绑定的属性，例如

```
Visibilty="{Binding IsVisible, Converter={StaticResource booleanToVisibiltyConverter}}" 
```

操作 UI 元素绑定到 ViewModel 上的命令以启动 ViewModel 操作。

```
Command="{Binding DoSomething}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T22:24:40.663

MVC 模式的坏处是：

*   每个人都有她/他自己的版本
*   刚开始理解有点抽象

好东西：

*   其实很简单
*   这是划分大多数应用程序的绝佳方式

不过要回答你的问题：

**该模型**

这是一个容易的。模型应该只知道它自己。它是*棋盘*、*棋子*和游戏规则。如果您可以在桌面应用程序或 Web 应用程序中重用它，您就知道您正在构建您的模型。

**风景**

这也不复杂。它是视觉部分，也是处理用户输入的部分。理解视图在 MVC 模式中的作用的最重要的概念是它们必须提供一种方法来调用系统的公共接口。在国际象棋游戏中，它必须绘制元素并检测用户使用鼠标/键盘在做什么。当用户做某事时，视图负责调用系统：例如。“用户 1 想将块从 X 移动到 Y”（重要提示：大多数时候，您不希望视图触发像用户 1 在坐标 x、y 中单击的调用。像素是视图的领域。系统必须接收与图形表示方式无关的订单）。

**控制器**

你是对的，这个不是那么直截了当。控制器是必须处理对系统公共接口的调用的控制器。在您的示例中，它将收到一个调用“User1 从 X 移动到 Y”并调用模型的适当对象中的一个方法（在这种情况下很可能是*板*）。因此，控制器*完全*了解模型中的对象。但是，它也可以包含应用程序中必需但不属于您的模型域的代码。您必须检查用户是否有权访问系统？您必须将该调用记录到文件中吗？好吧，大多数时候这种东西都会进入控制器。

然而，这只是我自己的 MVC 版本（我和其他人一样，也有我自己的...... :)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-06T21:54:58.537

因此，如果您有一个视图（棋盘）和一个用于棋盘的控制器，控制器将为它存储事件。当您移动一块时，它会引发`PieceMoved`事件，该事件应将信息传递给该事件，例如当前位置和所需位置。

对于一个非常简单的应用程序，您可能无法掌握模型的概念。一个人可能有一个可以在多个视图（例如详细信息和创建视图）上重复使用的计费模型。您不希望每次需要时都复制此代码，因此在您的控制器中，每个事件都会联系到需要它的计费模型。通过创建模型，您可以封装您的代码。

# c++ - 仅使用位操作将 16 位有符号值约束在 0 和 4095 之间（无分支）

> ID：12308826
> 
> 赞同：4
> 
> 时间：2012-09-06T21:42:20.287
> 
> 标签：c++, c, optimization, bit-manipulation

我想将`signed short`变量的值限制在 0 到 4095 之间，之后我将最重要的 8 位作为最终值，以便在其他地方使用。现在我正在以如下基本方式进行操作：

```
short color     = /* some external source */;
/* 
 * I get the color value as a 16 bit signed integer from an
 * external source I cannot trust. 16 bits are being used here
 * for higher precision.
 */

if ( color < 0 ) {
    color = 0;
}
else if ( color > 4095 ) {
    color = 4095;
}

unsigned char color8bit  = 0xFF & (color >> 4);
/*
 * color8bit is my final value which I would actually use
 * in my application.
 */ 
```

有什么方法可以仅使用位操作来完成，即不使用任何条件？它可能有助于加快速度，因为此操作在代码中发生了数千次。

以下内容无济于事，因为它不处理负值和溢出等边缘情况：

```
unsigned char color8bit = 0xFF & (( 0x0FFF & color ) >> 4 ); 
```

**编辑：** [亚当·罗森菲尔德的答案](https://stackoverflow.com/a/12308926/1044750)是采用正确方法但实施不正确的答案。[ouah 的回答](https://stackoverflow.com/a/12309664/1044750)给出了正确的结果，但采用了与我最初打算找出的不同的方法。

这就是我最终使用的：

```
const static short min = 0;
const static short max = 4095;
color = min ^ (( min ^ color ) & -( min < color ));
color = max ^ (( color ^ max ) & -( color < max ));
unsigned char color8bit = 0xFF & (( 0x0FFF & color ) >> 4 ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-06T21:51:29.683

是的，看看[这些小技巧](http://graphics.stanford.edu/~seander/bithacks.html#IntegerMinOrMax)：

```
short color = ...;
color = color ^ (color & -(color < 0));  // color = max(color, 0)
color = 4096 ^ ((color ^ 4096) & -(color < 4096));  // color = min(color, 4096)

unsigned char color8bit  = 0xFF & (color >> 4); 
```

我不知道这是否真的更快，你应该分析一下。如今，大多数现代 x86 和 x86-64 芯片都支持“条件移动”指令 (cmov)，它根据 EFLAGS 状态位有条件地存储一个值，优化编译器通常会从三元表达式（如`color >= 0 ? color : 0`. 这些可能是最快的，但它们不会在较旧的 x86 芯片上运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-06T21:50:14.060

您可以执行以下操作：

```
BYTE data[0x10000] = { ..... };

BYTE byte_color = data[(unsiged short)short_color]; 
```

在你的日子里，64kb 表并不是什么离谱的事情，可能是可以接受的。与其他可能的方法相比，此代码变体中的汇编器命令数量绝对是最少的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T22:05:33.913

我假设 a`short`是 16 位。

删除负值：

```
int16_t mask=-(int16_t)((uint16_t)color>>15);//0xFFFF if +ve, 0 if -ve
short value=color&mask;//0 if -ve, colour if +ve 
```

`value`现在介于 0 和 32767（含）之间。

然后，您可以执行类似的操作来限制值：

```
mask=(uint16_t)(value-4096)>>15;//1 if <=4095, 0 if >4095
--mask;//0 if <=4095, 0xFFFF if >4095
mask&=0xFFF;//0 if <=4095, 4095 if >4095

value|=mask;//4095 if >4095, color if <4095 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T23:03:52.143

```
short color = /* ... */
color =   ((((!!(color >> 12)) * 0xFFF)) | (!(color >> 12) * color ))
        & (!(color >> 15) * 0xFFF);

unsigned char color8bit  = 0xFF & (color >> 4); 
```

它假定二进制补码表示。

这具有不使用任何相等或关系运算符的优点。在某些情况下，您希望不惜一切代价避免分支：在某些安全应用程序中，您不希望攻击者执行分支预测。如果没有分支（特别是在嵌入式处理器中），您可以使您的函数在所有输入的恒定时间内运行。

注意：`x * 0xFFF`可以进一步简化为`(x << 12) - x`。`(!(color >> 12) * color )`此外，也可以进一步优化in 的乘法，因为`*`这里的左操作数是`0`or `1`。

**编辑：**

我添加一点解释：上面的表达式与下面的表达式相同，没有使用条件和关系运算符：

```
y =   ((y > 4095 ? 4095 : 0) | (y > 4095 ? 0 : y))
    & (y < 0 ? 0 : 4095); 
```

**编辑2：**

正如@HotLicks 在他的评论中正确指出的那样，这`!`仍然是一个概念分支。尽管如此，它也可以使用按位运算符计算。例如`!!a`可以用简单的方法来完成：

```
b = (a >> 15 | a >> 14 | ... | a >> 1 | a) & 1 
```

并且`!a`可以作为`b ^ 1`. 而且我确信有一个很好的技巧可以更有效地做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-06T23:44:03.880

您还可以使用[英特尔的 SSE 内在函数](http://software.intel.com/sites/default/files/m/9/4/c/8/e/18072-347603.pdf)轻松地对其进行矢量化。一个 128 位寄存器可以容纳 8 个您的寄存器，`short`并且有一些函数可以并行地最小/最大/移位/屏蔽所有这些。在循环中，最小值/最大值的常量可以预加载到寄存器中。该`pshufb`指令（SSSE3 的一部分）甚至会为您打包字节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T00:01:47.507

即使它没有直接回答原始问题，我也会留下答案，因为最后我认为您会发现它更有用。

我假设您的颜色来自以 12 位运行的相机或图像扫描仪，然后是一些未确定的处理步骤，可能会创建超出 0 到 4095 范围的值。如果是这种情况，这些值几乎肯定是以线性方式得出的。问题是显示器是经过伽马校正的，因此从 12 位到 8 位的转换需要非线性伽马函数，而不是简单的右移。这将比您的问题试图优化的钳位操作慢得多。如果您不使用伽玛函数，图像会显得太暗。

```
short color     = /* some external source */;
unsigned char color8bit;
if (color <= 0)
    color8bit = 0;
else if (color >= 4095)
    color8bit = 255;
else
    color8bit = (unsigned char)(255.99 * pow(color / 4095.0, 1/2.2)); 
```

此时，您可能会考虑[Kirill Kobelev 建议](https://stackoverflow.com/a/12308911/5987)的查找表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-27T03:02:33.720

这有点类似于 Tom Seddon 的回答，但使用了一种稍微清洁的方式来完成上面的夹子。请注意，Seddon 先生的回答和我的回答都避免了 ouah 回答的问题，即向右移动有符号值是实现定义的行为，因此不能保证适用于所有架构。

```
#include <inttypes.h>
#include <iostream>

int16_t clamp(int16_t value)
{
    // clampBelow is 0xffff for -ve, 0x0000 for +ve
        int16_t const clampBelow = -static_cast<int16_t>(static_cast<uint16_t>(value) >> 15);

    // value is now clamped below at zero
    value &= ~clampBelow;
    // subtract 4095 so we can do the same trick again
    value -= 4095;
    // clampAbove is 0xffff for -ve, 0x0000 for +ve,
    // i.e. 0xffff for original value < 4095, 0x0000 for original >= 4096
        int16_t const clampAbove = -static_cast<int16_t>(static_cast<uint16_t>(value) >> 15);

    // adjusted value now clamped above at zero
    value &= clampAbove;
    // and restore to original value.
    value += 4095;
    return value;
}

void verify(int16_t value)
{
    int16_t const clamped = clamp(value);
    int16_t const check = (value < 0 ? 0 : value > 4095 ? 4095 : value);
    if (clamped != check)
    {
        std::cout << "Verification falure for value: " << value << ", clamped: " << clamped << ", check: " << check << std::endl;
    }
}

int main()
{
    for (int16_t i = 0x4000; i != 0x3fff; i++)
    {
        verify(i);
    }
    return 0;
} 
```

这是一个完整的测试程序（好的，所以它不测试 0x3fff - 告我。;)），您可以从中提取`clamp()`例程以满足您的需要。

为了清楚起见，我还将钳位打破为“每行一步”。如果你的编译器有一个不错的优化器，你可以保持原样并依靠编译器来产生最好的代码。如果您的编译器的优化器不是那么好，那么无论如何都可以减少行数，尽管以牺牲一点可读性为代价。

“永远不要为了效率而牺牲清晰度”—— Bob Buckley，计算机科学教授，U-Warwick，考文垂，英格兰，1980 年。

我得到的最好的建议。;)

# iphone - 转换为 ARC 后的 EXC_BAD_ACCESS 但可以在没有僵尸的情况下正确分析

> ID：12308828
> 
> 赞同：1
> 
> 时间：2012-09-06T21:42:31.220
> 
> 标签：iphone, ios

对我来说这是一个奇怪的情况，我无法在设备或模拟器上运行我的项目，但是当我选择配置文件而不是运行选项时，应用程序运行完美，没有任何僵尸家伙。

它发生在我将项目转换为 ARC 之后。我只是按照 Xcode 告诉我的方式修改代码，并且由于这个项目的大小，我无法查看每一行代码。

附言。我是这个应用程序的第三手，所以我几乎不可能理解 10k 行代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T22:00:28.197

您是否尝试过在 Xcode 本身中启用 Zombies 而不进行分析？这会将对象设置为从不释放，这样当您向保留计数为零的对象发送消息时，它将知道该对象是什么并告诉您。只要确保再次打开它，对象就会正常释放。

在这里查看如何做到这一点： [如何在 Xcode 中启用 NSZombie？](https://stackoverflow.com/questions/5386160/how-to-enable-nszombie-in-xcode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:04:42.730

以下内容可以在事后为您提供帮助，但最好在 IMO迁移*之前*执行它们；如果存在问题，ARC 将解决一些问题，同时从您那里*抽象出其他问题：*

1)**创建更多自动释放池**一种可以帮助您缩小范围的方法是显式创建自动释放池——这可以帮助本地化您的应用程序的一些内存相关问题。显式添加自动释放池还有其他好处，因此这不仅可以用于寻找错误。

2)也**使用 GuardMalloc**，还有其他与内存相关的工具——您的应用程序也应该在启用 GuardMalloc 的情况下运行良好。切换到 ARC 可能会改变破坏点——你可能会抓住一个悬空的指针。

3）最后**删除所有泄漏**，这可能听起来倒退 - 删除所有可能的泄漏。您希望明确定义内存操作和生命周期。如果您偶尔有泄漏，您的问题可能很难被发现。通常，减少泄漏可以通过使问题更容易重现来帮助您隔离问题。

# python - GAE Python - 将“文本内容”与控制器和视图分开？

> ID：12308829
> 
> 赞同：0
> 
> 时间：2012-09-06T21:42:32.940
> 
> 标签：python, model-view-controller, google-app-engine

现在我在视图中有一个循环，显示主题的简要描述：

示例代码：

```
 <div id="menu">
            <ul>
                {% for item in topics %}
                <li>
                    <img src="img/{{item.name}}_ico.png" alt="{{item.name}}" />
                    <h2>{{item.heading}}</h2>
                    <p>{{ item.detail|safe }}</p>
                </li>
                {% endfor %}
            </ul>
        </div> 
```

上面的代码显示了一个图标——一个标题和几个项目的一些文本。

由于这些主题永远不会改变并且仅由开发人员更新，因此我在控制器中创建了一个包含所有这些内容的字典。

```
 topics= [
                    {'name': 'alert',
                     'heading': "Maintain attention",
                     'detail': 'Keep your students involved, alert and attentive during class with closed questions about the current subject.'},
                    {'name': 'time',
                     'heading': 'Instant feedback',
                     'detail': 'Save precious time and avoid checking quizzes!<br />studyWise&copy; check them instantly, providing you with results.'},
                    {'name': 'reward',
                     'heading': "Reward students",
                     'detail': 'Motivate students to participate and learn by rewarding good work with positive feedback.'},
                    {'name': 'money',
                     'heading': 'Save on expenses!',
                     'detail': 'Why spend money buying similar gadgets or subscriptions?<br />Use studyWise&copy; free of charge now.'},
                    {'name': 'cell',
                     'heading': 'Accessible',
                     'detail': 'Works with any smartphone, laptop or tablet.<br />No installation required.'},
                    {'name': 'share',
                     'heading': 'Share with colleagues',
                     'detail': 'Share topics, quizes or course statistics with colleagues.<br />See how your assistants are doing.'},
                    {'name': 'statistics',
                     'heading': 'Statistics',
                     'detail': 'Get helpful info about your students understanding of the learning material today.'}
                ] 
```

我想要做的是遵守 MVC 原则并保持代码干净。我应该将此字典移动到“模型”文件吗？这会影响性能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:52:07.903

这些主题应该是数据库记录，您应该在需要使用它们时查询它们。根据您使用的框架，您甚至可能不必更改模板。

在 Django 中，您将拥有：

```
#models.py
from django.db import models

class Topic(models.Model):
    name = models.CharField(...)
    heading = models.CharField(...)
    detail = models.TextField()

#views.py
from myapp.models import Topic

# In your view:
    topics = Topic.objects.all() 
```

在这方面，它们是否经常变化并不重要。

老实说，我认为性能影响[不是您应该关注的问题](http://c2.com/cgi/wiki?PrematureOptimization)。

# python - json中的UnicodeEncodeError

> ID：12308831
> 
> 赞同：0
> 
> 时间：2012-09-06T21:42:36.790
> 
> 标签：python, json

我正在教自己如何使用 json 解析谷歌结果，但是当我运行这段代码（应该可以工作）时，我收到了这个错误：`UnicodeEncodeError: 'charmap' codec can't encode character u'\u2014' in position 5: character maps to <undefined>`. 有人能帮我吗？

```
import urllib
import simplejson

query = urllib.urlencode({'q' : 'site:example.com'})
url = 'http://ajax.googleapis.com/ajax/services/search/web?v=1.0&%s&start=50' \
  % (query)
search_results = urllib.urlopen(url)
json = simplejson.loads(search_results.read())
results = json['responseData']['results']
for i in results:
  print i['title'] + ": " + i['url'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:13:21.007

此错误可能是由控制台应用程序在将 unicode 数据发送到 stdout 时使用的编码引起的。有[一篇文章](http://wiki.python.org/moin/PrintFails)谈到它。

检查标准输出的编码：

```
>>> import sys
>>> sys.stdout.encoding # On my machine I get this result:
'UTF-8' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:13:17.200

我的猜测是错误出现在 simplejson.loads(search_results.read()) 行中，可能是因为您的 python 拾取的默认编码不是 utf-8 并且 google 正在返回 utf-8。

试试：simplejson.loads(unicode(search_results.read(), "utf8")。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:44:10.640

[使用`unicode`文字。](http://farmdev.com/talks/unicode/)

```
print i[u'title'] + u": " + i[u'url'] 
```

还：

```
jsondata = simplejson.load(search_results) 
```

# c# - asp.net MVC，重定向到视图，查看打开新窗口到外部 url，它被视为视图

> ID：12308832
> 
> 赞同：-2
> 
> 时间：2012-09-06T21:42:37.747
> 
> 标签：c#, javascript, asp.net-mvc

试图将一个快速而肮脏的页面放在一起，以在新窗口中重定向到另一个网站。

所以我在会话中存储一个 url，从 mvcSiteMap 重定向到页面，点击页面......

运行这个 javascript

```
 $(document).ready(function () {
        window.open( '@HttpContext.Current.Session["EisUrl"].ToString();' );
    });

</script> 
```

}

而不是打开一个指向 google.com 的新窗口，我得到与此消息相同的窗口。

未找到视图“http://google.com”或其主视图，或者没有视图引擎支持搜索到的位置。搜索了以下位置：~/Views/ReportsManagement/http://google.com.aspx ~/Views/ReportsManagement/http://google.com.ascx ~/Views/Shared/http://google.com。 aspx ~/Views/Shared/http://google.com.ascx ~/Views/ReportsManagement/http://google.com.cshtml ~/Views/ReportsManagement/http://google.com.vbhtml ~/Views/共享/http://google.com.cshtml ~/Views/Shared/http://google.com.vbhtml

所以它把我的外部 URL 当作它仍然在网站内部......

这似乎应该很简单......显然我错过了一些明显的东西。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:46:43.127

确保从会话中呈现的内容是您所期望的正确且格式正确的 URL。我通常`window.location`也使用在javascript中重定向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T21:50:08.233

也许完全超出范围，但你不能在`ActionResult`?

```
return Redirect("http://www.google.com"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T21:46:24.547

尝试

`window.location = '@HttpContext.Current.Session["EisUrl"].ToString()';`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T22:49:07.643

我想通了，我是一个 id 10 t，

我在视图中有这个（剃刀）

```
@model string 
```

这在控制器中

```
public ActionResult GetEisReportRedirect()
        {
            string url =  eisReportBLLHdl.DoGetEisReportRedirect(  );

            return View( url );// i was passing url here to the view
        } 
```

所以它试图将字符串作为模型传递，我决定我不确定确切的行为并交换到将它放在会话中..但将它们留在原处。

出于某种原因，该字符串被作为 URL 进行了解析，新窗口未打开的事实应该是它过早脱轨的线索。

当我从模型中删除该行并从返回 View()...

感谢所有的帮助！

# r - R：Quantmod - getsymbols.csv 文件格式？

> ID：12308846
> 
> 赞同：2
> 
> 时间：2012-09-06T21:44:03.460
> 
> 标签：r, quantmod

我正在努力使用 quantmod 读取本地 CSV 文件`getSymbols`。我试图阅读的文件（wkn_541779.csv）的格式是这样的：

```
Date;Open;High;Low;Close;Volume;Ajdusted
2012-09-06;104,62;105,95;104,62;105,95;1248065,00;105,95
2012-09-05;104,78;104,78;104,45;104,48;1176371,00;104,48
2012-09-04;104,73;104,73;104,26;104,26;13090,00;104,26

> getSymbols("wkn_541779", src="csv", header = TRUE, sep=";", dec=",") 
```

给我一条错误消息：“列多于列名”。

```
> count.fields("wkn_541779.csv", sep = ";", skip = 0, blank.lines.skip = TRUE) 
```

每行（包括标题！）的结果为“7”，这正是标题中的列数。

有人可以帮我找出这里的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:58:13.323

`getSymbols.csv``read.csv`使用其默认值调用。IE`sep=","`

# android - Ant 构建带有依赖项的 Android 项目

> ID：12308849
> 
> 赞同：4
> 
> 时间：2012-09-06T21:44:12.840
> 
> 标签：android, ant, continuous-integration, jenkins

我正在尝试通过 Ant构建`android-app`一个依赖于 SDK（我们称之为）的应用程序（我们称之为）。`sdk`这台计算机上没有安装 Eclipse（出于推理，它是一个带有 Jenkins 的 CI 框）。

这两个项目并排位于两个完全独立的目录中。`android-app`在目录中`~/.jenkins/jobs/android-app/workspace`，`sdk`在目录中`~/.jenkins/jobs/sdk/workspace`。

让我们假设这两个项目都是“普通的”并且之前没有使用 Ant 构建过。我`cd`到`../android-app/workspace`目录并运行`android update project -p . --library ~/.jenkins/jobs/sdk/workspace`它通过。然后我`cd`到`../sdk/workspace`目录并运行`android update project -p .`它也通过了。

此时我`cd`回到`../android-app/workspace`目录并运行`ant clean build`. 它失败并出现错误：

```
BUILD FAILED
/path/to/ant/build.xml:440: 
/path/to/sdk/workspace resolve to a path with no project.properties file for 
project /path/to/android-app/workspace 
```

...`/path/to`目录的完整路径在哪里。我在这里简化了。

如果我`cd`到`sdk`工作区并打开`project.properties`，我会收到以下信息：

```
# ProGuard
proguard.config=proguard.cfg

# Project target.
target=android-10
android.library=true 
```

它确实存在。所有这些文件也是如此：

![ls](../Images/91bb434815482ef8667e0795315bfe6d.png)

那么，为什么会失败呢？我究竟做错了什么？我试图提供尽可能多的细节。如果我能提供任何额外的东西，请告诉我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T09:01:52.163

嗯，我也遇到这个问题。

我使用 strace 找出到底发生了什么，发现您在 project.properties 中指定的路径将附加您当前的文件夹路径作为其前缀。

例如，/home/myfolder/project > ant debug

您在 project.properties 中指定的库是 /path/to/library

然后，路径将变为 /home/myfolder/project/path/to/library

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-07T12:20:53.993

只是为了填补这里的答案空白，我的 Java 版本完全关闭了。我超级尴尬。

# c# - 什么 API 可用于发送 DHCP 发现、请求和确认？

> ID：12308850
> 
> 赞同：2
> 
> 时间：2012-09-06T21:44:17.117
> 
> 标签：c#, network-programming, upnp, dhcp, zeroconf

我已经搜索了很长一段时间，似乎无法在 C# 中找到一个有效的 DHCP 客户端实现示例。我是网络编程的新手，但我正在做一些研究，需要我编写一个手动 DHCP 客户端并在没有 DHCP 服务器的情况下实现 Auto-IP。

任何可以帮助我的代码示例或内置 C# 类的名称将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T08:28:06.007

你不会发现的；原因是“安全”。

常规网络 API 允许您处理 Level-3 及更高级别，但 DHCP 客户端必须能够处理 Level-2；即用于在 DHCP DISCOVERY 数据包上广播到 MAC FF:FF:FF:FF:FF:FF

出于安全原因，Microsoft 今天不允许您在如此低的级别上制作以太网包。

您不能使用原始套接字；在这里阅读为什么：

原始套接字的限制

[http://msdn.microsoft.com/en-us/library/ms740548(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms740548(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T15:59:38.903

您可以在您的电脑上安装 pccap 驱动程序并使用该 api 发送原始数据包

# mysql - MySql 交易与第三方代码

> ID：12308851
> 
> 赞同：1
> 
> 时间：2012-09-06T21:44:22.793
> 
> 标签：mysql, transactions

我遇到了一个问题，我想在 MySql 事务中运行一段第三方代码，如果其中任何一个在此过程中失败，则将两者都恢复。执行此操作的标准方法是什么？谢谢

示例代码是：

```
...
some mysql code
some third party code
rollback both if either mysql commits fails or the third part fails
... 
```

# macos - Sublime text 2 sftp，无法在mac上上传文件夹

> ID：12308853
> 
> 赞同：3
> 
> 时间：2012-09-06T21:44:45.093
> 
> 标签：macos, sftp, sublimetext2

我已经在我的 Mac 上安装了 sublime text 2，安装了包控制和 sftp 包，将文件夹添加到项目中，将其映射到远程。现在我在尝试上传 wordpress 文件夹时遇到了问题。

```
2012-09-06 23:33:51
Traceback (most recent call last):
  File "./sftp/threads.py", line 16, in run_with_except_hook
  File "./sftp/threads.py", line 101, in handler
  File "./sftp/commands.py", line 264, in run
  File "./sftp/commands.py", line 403, in do_operation
  File "./sftp/file_transfer.py", line 25, in handler
  File "./sftp/sftp_transport.py", line 565, in put
  File "./sftp/file_transfer.py", line 330, in handle_put_dirs
  File "./sftp/sftp_transport.py", line 284, in cd
NotFoundError: Folder not found 
```

我的stfp配置

```
"type": "sftp",

"save_before_upload": true,
"upload_on_save": true,
"sync_down_on_open": false,
"sync_skip_deletes": false,
"confirm_downloads": false,
"confirm_sync": true,
"confirm_overwrite_newer": true,

"host": "xxx.nazwa.pl",
"user": "xxx",
"password": "xxx",
//"port": "22",

"remote_path": "/xxx/", 
```

我在 Windows 上做了同样的事情，它工作得很好。有什么想法有什么问题吗？

# sencha-touch-2 - Sencha touch 2.0 Calendar Plugin Run Issues in production, package and device

> ID：12308854
> 
> 赞同：1
> 
> 时间：2012-09-06T21:44:45.500
> 
> 标签：sencha-touch-2

我已经在我用 sencha touch 2.0 开发的应用程序中实现了这个日历，但我遇到了一个问题。当我在网络浏览器中运行我的应用程序源代码时，日历工作正常。但是当我生成应用程序的生产和包时，日历不起作用并出现以下问题。此外，当应用程序在设备中运行时也会出现这些问题：1）：在日历的月份视图中未选择单元格。2): Next 和 Previous 在日历的月、周和日视图中不起作用。3）：在我看来，点击事件无法绑定

例子 ：

this.element.on({ tap: this.onTableHeaderTap, scope: this, delegate: 'td' });

this.element.on({ tap: this.onTimeSlotTap, scope: this, delegate: this.getItemSelector() });

请帮助我摆脱这个障碍。

我将非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T11:56:07.727

像这样创建您的类 obj 并将其添加到您的子类构造函数中：

```
companyCalender = Ext.create('myapp.view.TouchCalendarView',{
                  viewConfig : {
                      mode : 'month',
                      weekStart : 0,
                      value : new Date()
                  }
});
Ext.apply(this.initialConfig, config);
Ext.apply(this, config);
myapp.view.CompanyCalender.superclass.constructor.apply(this, arguments); 
this.add(companyCalender); 
```

# ios - iOS 推送通知不会触发应用程序功能

> ID：12308855
> 
> 赞同：0
> 
> 时间：2012-09-06T21:44:46.370
> 
> 标签：ios, function, logging, notifications, push

所以我的问题是我想在为我的应用程序激活推送通知服务时记录。我知道这个函数会被调用

```
- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)_deviceToken 
```

所以我把我的日志记录代码放在那里。然而，断点基本上表明程序永远不会进入该函数。我最近刚刚添加了日志记录代码，并且我正在测试的设备已经为推送通知激活了该应用程序。

因此我的问题是，我能做什么，我想测试我的日志记录代码是否正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:28:37.920

我相信你正在寻找的是

```
- (void)application:(UIApplication*)application didReceiveRemoteNotification:(NSDictionary*)userInfo 
```

这将进入您的`AppDelegate.m`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-06T22:10:24.567

[- (void)unregisterForRemoteNotifications](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/unregisterForRemoteNotifications)

# android - 从 BroadcastRecevier 启动 AlertDialog 时在后台显示当前活动

> ID：12308860
> 
> 赞同：2
> 
> 时间：2012-09-06T21:44:55.767
> 
> 标签：android, broadcastreceiver, android-alertdialog

我设置了一个半透明的 AlertDialog 来显示用户是否收到短信。它是从广播接收器启动的。

用户只收到这种“紧急”类型的消息，只有当发送者将它设置为这样的消息*并且*用户启用这种类型的中断时。

我有一个小问题，因为如果我的应用程序正在运行，我的背景就是我的应用程序最后一次停止的地方。我获得背景以显示用户“当前正在做什么”的唯一方法是完全关闭我的应用程序。

有没有人在使用具有半透明背景的 AlertDialogs 时遇到过类似的问题？

这是我开始活动的方式；

```
Intent i = new Intent(context, LayoutStartActivity.class);
i.putExtras(intent);
i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(i); 
```

这是我的警报对话框的精简版

```
 AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setView(holder);
    builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            dialog.cancel();
            finish();
        }
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:54:10.103

在 AndroidManifest.xml 中设置任务关联性，使其在最近堆栈上作为唯一进程运行。

例子

```
<activity android:name=".LayoutStartActivity"
                    android:theme="@style/Theme.Light"
                    android:taskAffinity="com.example.standAlone"> 
```

# asp.net - 初学者：ASP.NET窗口输出html耗时较长

> ID：12308870
> 
> 赞同：0
> 
> 时间：2012-09-06T21:46:15.390
> 
> 标签：asp.net, sql-server-2008, iis-6, cpu

我运行了很长时间的网站，有时会出现一些速度问题，但是我们清理了MSSQL数据后，它就可以正常工作了。

但是这一次就不行了，老是出现Timeout错误，IIS导致CPU跑得很高。

我们去掉了一些功能，网站运行正常，但速度慢且没有错误。

例如，当我们进行搜索时，如果我们的结果少于 10 个，则页面/输出非常快。

当我们有超过 200 个结果时，页面非常慢，几乎需要大约 15 到 20 秒才能输出整个页面

我知道如果你有更多的数据要输出，当然它需要更多的时间来运行，但我们曾经有超过 500 个结果，它运行/输出也非常快。

你知道我应该去哪里解决这个速度问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:12:28.650

我将从分解问题开始。例如 sql server 时间和 iis 时间。您可以分离代码的不同部分并测量执行时间等。

[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)是开始使用和用于 ASP.NET 的好工具。您可以从简单的[跟踪](http://msdn.microsoft.com/en-us/library/bb386420.aspx)和[页面跟踪](http://msdn.microsoft.com/en-us/library/94c55d08.aspx)开始。

有关[测试](http://msdn.microsoft.com/en-us/library/bb924375.aspx)和[性能的更多信息](http://msdn.microsoft.com/en-us/library/ff649152.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:58:21.173

您需要查看代码以查看显示这些结果时执行的操作。使用调试器实现一些日志记录或逐步执行结果。

如果你有一个源代码控制系统，现在是时候回顾一下在快速代码和现在的慢速代码之间所做的更改。

显示 10 个结果可能需要 1 秒，这几乎无法容忍，但正如您所说，200 个结果需要 20 秒。所以问题是某处的一些错误代码。我认为有人已经更改了代码。

# python - 手动创建对象时未应用 Django 模型字段默认值

> ID：12308876
> 
> 赞同：0
> 
> 时间：2012-09-06T21:46:42.200
> 
> 标签：python, django

假设我的对象具有`DecimalField`默认设置为`20`. 当我在 python 中创建一个对象并且没有为它指定一个值时`DecimalField`，它是`None`.

如何确保每次我不提供值时都应用默认值？

```
class SomeModel(models.Model):
    """Demonstrate the flaw of the default value."""

    dec_field = models.DecimalField(default=1, blank=True, null=True)

my_model = SomeModel()
my_model.save()  # this is where I expect the dec_field to become Decimal('1.0')
                 # instead it's None 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:53:30.150

确保您的模型和数据库已同步，可以使用 South 等迁移工具，也可以删除表并重新同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:51:45.447

默认值应设置为您所描述的内容，需要有关您的示例的更多信息。但是，如果您想覆盖或手动设置默认值，您可以执行以下操作；

```
DEC_FIELD_DEFAULT = 20
class Example(models.Model):
    dec_field = models.DecimalField(default=DEC_FIELD_DEFAULT)

    def __init__(self, *args, **kwargs):
        super(Example, self).__init__(self, *args, **kwargs)
        self.dec_field = DEC_FIELD_DEFAULT 
```

# java - java中的文件覆盖——用户映射部分打开错误

> ID：12308878
> 
> 赞同：5
> 
> 时间：2012-09-06T21:46:45.300
> 
> 标签：java, overwrite

java程序中的以下函数是为了从文件中读取并在之后覆盖回同一个文件而编写的。

```
public static void readOverWrite(File dir) throws IOException {
    for (File f : dir.listFiles()) {
        String[] data = readFile(f).split("\n");
        try (BufferedWriter writer = new BufferedWriter(new FileWriter(f))) {
            for (int i = 0; i < data.length; i++) {
                writer.write((data[i]+"\n"));
            }
            writer.close();
        }
    }
} 
```

尝试运行该程序的错误消息是：

```
Exception in thread "main" java.io.FileNotFoundException: ..\..\data\AQtxt\APW19980807.0261.tml (The requested operation cannot be performed on a file with a user-mapped section open)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(Unknown Source)
    at java.io.FileOutputStream.<init>(Unknown Source)
    at java.io.FileWriter.<init>(Unknown Source)
    at General.SplitCreationDate.splitLine(SplitCreationDate.java:37)
    at General.SplitCreationDate.main(SplitCreationDate.java:53) 
```

请求帮助以解决错误。

* * *

读取文件的代码

```
protected static String readFile(File fullPath) throws IOException {
    try(FileInputStream stream = new FileInputStream(fullPath)) {
        FileChannel fc = stream.getChannel();
        MappedByteBuffer bb = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
        stream.close();
        return Charset.defaultCharset().decode(bb).toString();
    }
} 
```

* * *

在另一个线程中读取这是一个 Windows 问题，因此 readFile 方法中的 MappedByteBuffer 是问题的原因。重写 readFile 方法如下。有用！

```
protected static String readFile(File fullPath) throws IOException {
    String string = "";
    try (BufferedReader in = new BufferedReader(new FileReader(fullPath))) {
        String str;
        while ((str = in.readLine()) != null) {
            string += str + "\n";
        }
    }
    return string;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:09:32.910

您需要在打开文件流后关闭它们，否则它们仍会在您的系统中。这可能会导致损坏和类似的错误。查看[有关文件 I/O 的 Java 学习教程](http://docs.oracle.com/javase/tutorial/essential/io/index.html)。[本教程](http://www.javapractices.com/topic/TopicAction.do?Id=42)还展示了方法。

```
import java.io.*;

public class ReadWriteTextFile {

  /**
  * Fetch the entire contents of a text file, and return it in a String.
  * This style of implementation does not throw Exceptions to the caller.
  *
  * @param aFile is a file which already exists and can be read.
  */
  static public String getContents(File aFile) {
    //...checks on aFile are elided
    StringBuilder contents = new StringBuilder();

    try {
      //use buffering, reading one line at a time
      //FileReader always assumes default encoding is OK!
      BufferedReader input =  new BufferedReader(new FileReader(aFile));
      try {
        String line = null; //not declared within while loop
        /*
        * readLine is a bit quirky :
        * it returns the content of a line MINUS the newline.
        * it returns null only for the END of the stream.
        * it returns an empty String if two newlines appear in a row.
        */
        while (( line = input.readLine()) != null){
          contents.append(line);
          contents.append(System.getProperty("line.separator"));
        }
      }
      finally {
        input.close();
      }
    }
    catch (IOException ex){
      ex.printStackTrace();
    }

    return contents.toString();
  } 
```

注意*finally*块。这样可以确保无论是否发生异常，流都会关闭。您应该使用一个来关闭打开的流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-18T23:30:17.737

当基础文件关闭时，内存映射不会关闭。如果必须，请使用另一种技术将文件读入内存。通常最好一次处理一个文件。

# c - 使用 pwrite() API 时错误未设置为 EIO

> ID：12308891
> 
> 赞同：0
> 
> 时间：2012-09-06T21:48:36.940
> 
> 标签：c, linux, posix

我使用 NFS 在我的系统上安装了远程磁盘，我正在尝试使用 pwrite() API 写入已安装的远程磁盘上的文件。

它不会每次都发生，但在某些情况下，执行 I/O pwrite() 失败并将错误号设置为 EIO（输入/输出错误）。

有人可以解释一下为什么首先会出现这个错误，有什么办法可以纠正它吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T12:53:04.473

从读取和写入`NFS`基于文件的（糟糕）经验中，我了解到您有一个很好的机会`EIO`通过简单地重试失败的 I/O 操作 ( `read()`, `write()`) 来解决这个问题。

也`NFS`不能假设`read()`/`write()`确实传输了指定的数据量，因此最好始终检查相关函数的返回值，了解传输了多少字节。

我在底层`NFS`功能或`NFS`内核处理驱动程序结果的方式中看到了问题，因此我强烈假设`pread()`/显示出与我在使用/`pwrite()`时看到的相同的效果。`read()``write()`

# ruby-on-rails - 如何在 Rails 中创建全局实用程序函数

> ID：12308896
> 
> 赞同：4
> 
> 时间：2012-09-06T21:48:55.240
> 
> 标签：ruby-on-rails, ruby

我需要一个地方来粘贴全局引用透明的实用程序方法。这些应该可以从 Rails 中的任何地方访问（模型、视图、控制器和其他任何地方）。例如：

```
bool = GlobalUtilities.to_bool "false"
unicorn = GlobalUtilities.make_me_a "unicorn" 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-06T22:00:24.387

你总是可以坚持这些`/lib`并要求它们。请参阅[砌砖者的回答](https://stackoverflow.com/a/7737062/456584)——您可以要求从您的 加载这些模块`application.rb`，这将使它们在任何地方都可以访问。

请参阅：[Rails lib 目录](https://stackoverflow.com/questions/7736773/rails-lib-directory)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-06T23:54:32.903

我会为您希望实现的每个行为创建一个描述性命名的文件，并将它们收集在 /lib （或者，更好的是，一个引擎）中。然后，将您想要的功能混合到您希望扩展的类中。例如，在您描述的场景中，您可以将`parse_boolean`方法直接添加到`String`. 很光滑的东西。

/lib/add_parse_boolean_to_string.rb

```
class String

  def parse_boolean
    self == 'true' # or whatever...
  end

end 
```

# java - javax.jdo.JDODetachedFieldAccessException 当我要求列表时 使用 JPA 和数据存储

> ID：12308903
> 
> 赞同：0
> 
> 时间：2012-09-06T21:49:37.063
> 
> 标签：java, google-app-engine, jpa, entitymanager, datastore

我有 javax.jdo.JDODetachedFieldAccessException，当我想在我的 DAO 实现中将我的所有实体作为列表检索后，从我的实体中请求一个属性对象。

```
public List<T> findAll() {
    this.entityManager = SingletonEntityManagerFactory.get().createEntityManager();
    EntityTransaction tx = this.entityManager.getTransaction();
    try {
      tx.begin();
    return this.entityManager.createQuery(
        "select f from " + clazz.getName() + " as f").getResultList();

    }finally {
      tx.commit();
      if (tx.isActive()) {
        tx.rollback();
      }
      this.entityManager.close();
    }

  } 
```

例如，假设 T 具有 A 类的属性，该属性已经是一个实体持久化，在 List 之后我无法获得 A

但是，如果我只按 ID 查找单个实体，我就没有这个问题。我获得了我的实体，我可以毫无问题地询问它的属性对象已经存在

```
public T getById(final Key id) {
   return getEntityManager().find(clazz, id);
} 
```

现在我可以做

```
A a= t.getA(); 
```

如何编写 findAll() 的实现以避免此错误？也许是另一个组件而不是 EntityManager？我怎样才能使它通用，而不必为特定类型的实体实现特定代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T08:18:06.493

您在那里所做的事情并不能确保在离开该方法之前已加载该字段，因此要么访问它，要么确保默认获取它。

# javascript - 在 HTML5/Javascript MOBILE 应用程序中下载 PDF 文件

> ID：12308904
> 
> 赞同：3
> 
> 时间：2012-09-06T21:49:39.380
> 
> 标签：javascript, html, pdf, mobile

我需要创建允许用户从我的基于 HTML5/JavaScript 的移动应用程序下载 PDF 文件的功能。我将把 PDF 文件作为 Base 64 编码字节流。单击页面中的按钮后，如何允许用户将 PDF 下载到他们的设备？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-02-03T13:54:16.333

**对于 IOS：** 您可以在 iPhone 应用程序上下载 pdf 并在 WebView 中显示。这个（链接的）问题列出了一些方法。您还可以在那里找到如何将 pdf 放入运行该应用程序的设备/iPhone 的文件夹中：[如何下载 PDF 并将其存储在 iPhone 上本地？](https://stackoverflow.com/questions/2226615/how-to-download-pdf-and-store-it-locally-on-iphone)

```
let request = URLRequest(url:  URL(string: "http://www.msy.com.au/Parts/PARTS.pdf")!)
let config = URLSessionConfiguration.default
let session =  URLSession(configuration: config)
let task = session.dataTask(with: request, completionHandler: {(data, response, error) in
    if error == nil{
        if let pdfData = data {
            let pathURL = FileManager.default.urls(for: .documentDirectory, in: .userDomainMask)[0].appendingPathComponent("\(filename).pdf")
            do {
                try pdfData.write(to: pathURL, options: .atomic)
            }catch{
                print("Error while writting")
            }

            DispatchQueue.main.async {
                self.webView.delegate = self
                self.webView.scalesPageToFit = true
                self.webView.loadRequest(URLRequest(url: pathURL))
            }
        }
    }else{
        print(error?.localizedDescription ?? "")
    }
}); task.resume() 
```

**对于 Android：Android** 有很多方法可以做到这一点。这个应该在大多数情况下都可以正常工作，没有任何问题：

```
 URL u = new URL("http://www.path.to/a.pdf");
    //open a connection
    HttpURLConnection c = (HttpURLConnection) u.openConnection();
    c.setRequestMethod("GET");
    c.setDoOutput(true);
    c.connect();
    FileOutputStream f = new FileOutputStream(new File(root,"file.pdf"));
    //read the file
    InputStream in = c.getInputStream();

    byte[] buffer = new byte[1024];
    int len1 = 0;
    while ( (len1 = in.read(buffer)) > 0 ) {
         f.write(buffer,0, len1);
    }
    f.close(); 
```

这个另一种单行选项适用于在 android 中下载 pdf，但根据设备和其他已安装的应用程序（pdf 阅读器），似乎有不同的行为：

```
`startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("path/filename.pdf")));` 
```

我使用了这个问题，并得到了一个工作代码示例的回复。您可以在帖子底部找到一个很长的答案，其中包含许多不同的用例及其解决方案在同一篇文章中进行了解释。：[如何在 Android 中下载 pdf 文件？](https://stackoverflow.com/questions/6368788/how-to-download-a-pdf-file-in-android)

# css - CSS - 使用 :hover 伪类在锚标记的底部不起作用

> ID：12308907
> 
> 赞同：1
> 
> 时间：2012-09-06T21:49:50.980
> 
> 标签：css, hover, anchor, wiki

我目前正在修改[http://onverse.wikia.com/wiki/Onverse_Wiki](http://onverse.wikia.com/wiki/Onverse_Wiki)上的样式表。我在使用页面左上角的橙色“Onverse Wiki”按钮时遇到了问题。发生的情况是，当您将鼠标放在锚点的底部时，它不会注册 :hover 伪类。我尝试了很多不同的方法，例如更改 z-index、显示属性、更改 line-height 属性，但没有任何效果。我已经尽可能地删除了所有边距（这当然是必要的）、边框和填充，以便对象本身覆盖它似乎没有成功的整个区域。

但是，您将鼠标悬停在文本下方的任何位置（即使它在锚标记内），您的光标都不会变成指针光标。点击那里什么也没做。它实际上并不依赖于文本，因为... 1\. 锚标记的顶部、左侧和右侧在悬停时仍然可以识别。2.更改高度为41px，填充为0，显示为表格单元格，垂直对齐到底部，将文本带到该区域的底部，您可以清楚地看到鼠标悬停在底部时没有出现指针光标的文本。

我认为它可能与它相对于其他元素的布局有关？我不知道如果有什么会干扰...而且我已经将 z-index 更改为 100000，因此锚点将位于所有内容之上。我之前遇到过类似的问题，蓝色按钮在右侧，但我所要做的就是将 z-index 更改为 1。

所以我在这里迷路了。有什么帮助吗？将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:24:49.300

我不完全理解您的问题，但是如果我`display: block;`从 中删除`<A ..>`并增加填充，那么我会在整个事物上获得指针光标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:32:05.000

如果您从以下代码行中删除高度 8px ，我认为它会修复它：

```
.WikiHeader h1::before, .WikiHeader .WikiaRail .module h2::before, .WikiaRail .module    .WikiHeader h2::before, .WikiHeader .WikiaRail #RIGHT_SKYSCRAPER h2::before, .WikiaRail #RIGHT_SKYSCRAPER .WikiHeader h2::before, .WikiHeader .shadow-mask {
  bottom: 0;
  height: 8px;
  position: absolute;
  right: 0;
  width: 1000px;
} 
```

# c# - 内存管理和程序性能问题

> ID：12308912
> 
> 赞同：0
> 
> 时间：2012-09-06T21:50:14.397
> 
> 标签：c#, memory-management, garbage-collection, out-of-memory

好的，我制作了一个 C# winform 应用程序，它是一个 File_Splitter_Joiner。您只需给它一个文件，它就会为您将其拆分为您指定的多个部分。拆分在单独的线程中完成。在我切片 1Gig 文件之前，一切都运行良好！在任务管理器中，我看到我的程序开始消耗 1G 内存，我的电脑差点死机！不仅如此，切片完成后，消耗并没有改变！（不知道这是否意味着垃圾收集器不工作，虽然我很确定我丢失了对持有大数据块的所有引用，所以它应该工作）这是 Splitter 构造函数（只是为了给你一个更好的主意）：

```
public FileSplitter(string FileToSplitPath, string PiecesFolder, int NumberOfPieces, int PieceSize, SplittingMethod Method)
{
  FileToSplitInfo = new FileInfo(FileToSplitPath);
  this.FileToSplitPath = FileToSplitPath;
  this.PiecesFolder = PiecesFolder;
  this.NumberOfPieces = NumberOfPieces;
  this.PieceSize = PieceSize;
  this.Method = Method;
  SplitterThread = new Thread(Split);
} 
```

这是进行实际拆分的方法：（我还是个新手，所以你即将看到的“可能不会”以最好的方式完成，我只是在这里学习）

```
private void Split()
{
  int remainingSize = 0;
  int remainingPos = -1;
  bool isNumberOfPiecesEqualInSize = true;
  int fileSize = (int)FileToSplitInfo.Length; // FileToSplitInfo is a FileInfo object
  if (fileSize % PieceSize != 0)
  {
    remainingSize = fileSize % PieceSize;
    remainingPos = fileSize - remainingSize;
    isNumberOfPiecesEqualInSize = false;
  }
  byte[] fileBytes = new byte[fileSize];
  var _fs = File.Open(FileToSplitPath, FileMode.Open);
  BinaryReader br = new BinaryReader(_fs);
  br.Read(fileBytes, 0, fileSize);
  br.Close();
  _fs.Close();

  for (int i = 0, index = 0; i < NumberOfPieces; i++, index += PieceSize)
  {
   var fs = File.Create(PiecesFolder + "\\" + Path.GetFileName(FileToSplitPath) + "." + (i+1).ToString());
   var bw = new BinaryWriter(fs);
   bw.Write(fileBytes, index, PieceSize);
   if(i == NumberOfPieces-1 && !isNumberOfPiecesEqualInSize && Method == SplittingMethod.NumberOfPieces)
   bw.Write(fileBytes, remainingPos, remainingSize);
   bw.Close();
   fs.Close();
  }
 MessageBox.Show("File has been splitted successfully!");
 SplitterThread.Abort();
} 
```

现在，我不是通过 BinaryReader 读取文件的字节，而是首先通过该`File.ReadAllBytes`方法读取它，它适用于小文件大小，但是，当我与我们的大家伙打交道时，我遇到了**“SystemOutOfMemory”**异常，不知道为什么当我通过 BinaryReader 读取字节时没有得到那个异常。

（这是一个介于两者之间的问题）

所以，主要问题是，我怎样才能以不消耗太多内存的方式加载大文件（讲演出）？我的意思是，我怎样才能让我的程序不消耗所有的内存？以及如何在拆分完成后释放已使用的内存？（我实际上用过

```
bw.Dispose; fs.Dispose; 
```

代替

```
bw.Close(); fs.Close(); 
```

是一样的。我知道 Q 可能没有意义，因为当我们加载某些东西时，它会进入我们的记忆而不是其他地方，但是，我这样问的原因是因为我使用了另一个 Splitting_Joining 程序（不是我写的）只是为了看看如果它有同样的问题，我加载了文件，程序消耗了大约 5Migs 的内存，当我开始拆分时，它使用了大约 10Migs ！现在这是一个非常大的区别.. 可能那个应用程序是 C/C++ ..

所以总结一下，谁很烂？它是我的代码吗？如果是，我该如何解决？还是在性能方面是 C#？

非常感谢你能帮我搞定的任何事情：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T21:58:53.463

以下两行将杀死您：

```
int fileSize = (int)FileToSplitInfo.Length; // a FileInfo object
...
byte[] fileBytes = new byte[fileSize]; 
```

1.  当大小结束时，您的代码将失败`Int32.MaxValue`。没必要，直接用`long fileSize = FileToSplitInfo.Length;`
2.  当没有足够的*连续*内存时，此更正的代码将失败。（LOH的）碎片化迟早会让你失望。
3.  您为整个文件分配内存，但`PieceSize`一次只需要字节。

您甚至不需要知道文件大小，只需

```
byte[] pieceBuffer = new byte[PieceSize];

while (true)
{
    int nBytes = br.Read(pieceBuffer, 0, pieceBuffer.Length);
    if (nBytes == 0) 
       break;

    // write this piece, the length is nBytes 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:56:07.147

有不同的方面可以做得更好：

*   如果您正在使用大文件，为什么要先读取数组中的**所有内容，***然后再*写入另一个文件？只需在读取另一个文件时写入新文件。

*   用于`using`保证流的处置，在任何情况下：要么有例外，要么没有。

*   如果您开始使用非常大的文件，例如 1GB 甚至更大，我建议您查看 [Memory Mapped Files](http://msdn.microsoft.com/en-us/library/dd997372.aspx)。因此，您将获得令人难以置信的内存消耗优势和一些增加的性能成本。

# php - 如何从用户表单 PHP 安全地编辑数据库中的信息

> ID：12308913
> 
> 赞同：2
> 
> 时间：2012-09-06T21:50:20.207
> 
> 标签：php, mysql, forms, security, edit

目前我有一个有效的 PHP 编辑脚本，它允许用户编辑他们发布的广告，但我意识到用户可以修改`?id=`数字以显示另一组数据，然后编辑其他人的数据并将其保存在数据库中。

有什么办法可以让当用户点击他们发布的广告进行编辑时，他们只能访问他们自己的广告，他们将无法通过调整 id 来编辑其他人的广告？=以及保护表单免受操纵的方法？

这是我当前的代码：

```
<?php
/* 
EDIT.PHP
Allows user to edit specific entry in database
*/

// creates the edit record form
// since this form is used multiple times in this file, I have made it a function that is      easily reusable
function renderForm($id, $fname, $lname, $contact, $price, $error)
{
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Edit Record</title>
 <link rel="stylesheet" type="text/css" href="stylesheet.css">

 <style type="text/css">

#page-wrap                  {
position:absolute;
top: 206px;
left: 288px;
width: 50%;
text-align:left;
background-color:#FFF;
padding: 10px;
border-radius: 10px;
box-shadow: 1px 2px 2px #888888;
     }

    </style>
    <script type = "text/javascript">

    function myfunction(url)
    {
    window.location.href = url;
    }
   </script>

</head>
<body>

  <div class="container">

  <div id="imagelogo" onclick = "window.location.href = 'index.html'" > 

  <p> Buy and sell stuff around University</p>
   </div>

   <ul id="navigation" name="navigation">
  <li id="nav-home"><a href="index.html">Home</a></li>
  <li id="nav-search"><a href="search.php">Search</a></li>
  <li id="nav-selling"><a href="#">Selling</a></li>
  <li id="nav-buying"><a href="#">Buying</a></li>
   <li id="nav-FAQ"><a href="#">FAQ</a></li>
  <li id="nav-contact"><a href="#">Contact</a></li>

  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>Sponsors</p>
  </ul>
  <div id="account">

  <?php
  if( isset( $_SESSION['username'] ) ){

  echo "<a href='securedpage1.php'>My Account</a><img src='images/uni-icon.png' width='30'        height='18' style='vertical-align: middle;'/>";

  }else{

 echo "<a href='login.php' >Login</a><img src='images/uni-icon.png' width='30' height='18'    style='vertical-align: middle;'/>";
}
?>

</div>

<div id="registerlogout">
<?php
if( isset( $_SESSION['username'] ) ){
echo "<a href='logout.php'>Logout</a>";

}else{

echo "<a href='register.php'> Register</a>";
}
?>
</div>

<div id="social">
<img src="images/fb-logo.png" width="22" height="20" />     

 <img src="images/twitter-logo.png" width="24" height="25" />
  </div>

 <div id="page-wrap">
 <?php 
 // if there are any errors, display them
 if ($error != '')
 {
 echo '<div style="padding:4px; border:1px solid red; color:red;">'.$error.'</div>';
 }
 ?> 

 <form action="" method="post">
 <input type="hidden" name="id" value="<?php echo $id; ?>"/>
 <div>
 <strong>Ad Title: *</strong> <input type="text" name="fname" style="width: 60%; box-    sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;"value="<?php      echo $fname; ?>"/><br/>
  <strong>Description: *</strong> <textarea name="lname" cols="45" rows="5"><?php echo     $lname; ?></textarea><br/>
 <strong>Contact*</strong> <input type="text" name="contact"  style="width: 60%; box-    sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" value="<?php     echo $contact; ?>"/><br/>
<strong>Price*</strong> <input type="text" name="price"  style="width: 60%; box-sizing:    border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" value="<?php echo    $price; ?>"/><br/>
 <p>* Required</p>
 <input type="submit" name="submit" value="Submit">
 </div>
 </form>
 </div>
 </div>
 </body>
 </html> 
 <?php
  }

// Inialize session
    session_start();

 // connect to the database
 include('conn.php');

 // check if the form has been submitted. If it has, process the form and save it to the    database
 if (isset($_POST['submit']))
  { 
 // confirm that the 'id' value is a valid integer before getting the form data
 if (is_numeric($_POST['id']))
 {
 // get form data, making sure it is valid
 $id = $_POST['id'];
 $fname = mysql_real_escape_string(htmlspecialchars($_POST['fname']));
 $lname = mysql_real_escape_string(htmlspecialchars($_POST['lname']));
 $contact = mysql_real_escape_string(htmlspecialchars($_POST['contact']));
 $price = mysql_real_escape_string(htmlspecialchars($_POST['price']));

 // check that firstname/lastname fields are both filled in
 if ($fname == '' || $lname == '' || $contact == '' || $price == '' )
 {
 // generate error message
 $error = 'ERROR: Please fill in all required fields!';

 //error, display form
 renderForm($id, $fname, $lname, $contact, $price, $error);
 }
else
 {
 // save the data to the database
 mysql_query("UPDATE people SET price='$price', contact='$contact', fname='$fname',      lname='$lname' WHERE id='$id'")
 or die(mysql_error()); 

 // once saved, redirect back to the view page
 header("Location: view.php"); 
 }
 }
 else
 {
 // if the 'id' isn't valid, display an error
 echo 'Error!';
 }
 }
 else
 // if the form hasn't been submitted, get the data from the db and display the form
 {

 // get the 'id' value from the URL (if it exists), making sure that it is valid (checing   that it is numeric/larger than 0)
 if (isset($_GET['id']) && is_numeric($_GET['id']) && $_GET['id'] > 0)
 {
 // query db
 $id = $_GET['id'];
 $result = mysql_query("SELECT * FROM people WHERE id=$id")
 or die(mysql_error()); 
$row = mysql_fetch_array($result);

 // check that the 'id' matches up with a row in the databse
 if($row)
 {

 // get data from db
 $fname = $row['fname'];
 $lname = $row['lname'];
 $contact = $row['contact'];
 $price = $row['price'];

 // show form
 renderForm($id, $fname, $lname, $contact, $price, '');
 }
 else
 // if no match, display result
 {
 echo "No results!";
 }
 }
 else
 // if the 'id' in the URL isn't valid, or if there is no 'id' value, display an error
 {
 echo 'Error!';
 }
 }
 ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T21:52:09.577

您需要在数据库中记录每个广告的海报。这只是另一列。

当尝试编辑广告（显示表单或保存结果）时，您需要检查广告的所有者是否与当前登录的用户匹配。

例如`UPDATE adverts SET text=? WHERE id=? AND user=?`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:04:14.103

在他们登录时设置会话。检查会话用户名是否与链接到他们要编辑的帖子的用户名相同。如果为真，他们可以编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T21:52:01.687

我建议您查询数据库以检查用户请求的 id 是否是允许他/她访问的 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T21:55:29.717

将其保留在服务器端，将 id 存储在数据库中，然后拨打该号码，这将阻止他们对其进行编辑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-06T21:56:53.693

md5 将每个帐户的 ID 号代码添加到查询中。确保代码与与帐户关联的代码匹配（因此 md5 id 并确保它与数据库中的代码匹配）然后添加内容。这样，任何人都无法更改号码并编辑其他帐户的帖子。md5 算法特定于您的服务器并且不可预测。

`$hash = md5( $id );`

使用它来创建代码并将其与帐户相关联，并且除了 id 之外还像 id 一样使用它。这意味着当您创建帐户时，您需要在数据库中创建一个 md5 版本的 id 作为 id 旁边的字段。

像这样改变：

`mysql_query("UPDATE people SET price='$price', contact='$contact', fname='$fname', lname='$lname' WHERE id='$id'") or die(mysql_error());`

到

`mysql_query("UPDATE people SET price='$price', contact='$contact', fname='$fname', lname='$lname' WHERE id='$id' and idCode='$hash'") or die(mysql_error());`

只需确保您在数据库中有一个名为的字段，`idCode`因为 md5 是一种不可逆的加密。

# asp.net - 如何右对齐 GridView 分页按钮？

> ID：12308914
> 
> 赞同：2
> 
> 时间：2012-09-06T21:50:31.027
> 
> 标签：asp.net, css, gridview, paging

我无法让我的分页按钮：“<< < > >>”正确对齐。这是我的网格视图：

```
 <asp:GridView ID="GridView1" ShowHeader="false" AllowPaging="true" PageSize="2"
                                AutoGenerateColumns="false" Width="100%" runat="server">
                                <Columns>
                                    <asp:TemplateField>
                                        <ItemTemplate>
                                           foo
                                        </ItemTemplate>
                                        <ItemStyle CssClass="blah" />
                                    </asp:TemplateField>
                                    <asp:TemplateField>
                                        <ItemTemplate>
                                            bar
                                        </ItemTemplate>
                                        <ItemStyle CssClass="pluh" />
                                    </asp:TemplateField>
                                </Columns>

                                <PagerStyle CssClass="gridpager" HorizontalAlign="Right" />
                                <PagerSettings Mode="NextPreviousFirstLast" FirstPageText="<<" PreviousPageText="<"
                                    NextPageText=">" LastPageText=" >>"  Position="Bottom" />

                            </asp:GridView> 
```

和 CSS 样式：

```
 .gridpager, .gridpager td
    {
       padding-left: 5px;
       text-align: right;
    } 
```

如果我删除 PageStyle CssClass 并在 PagerSettings 上使用 Horizo​​ntalAlign="Right" 它可以工作，但是我没有得到我需要的填充。并且像我的示例一样指定 CssClass 和 Horizo​​ntalAlign 不起作用。

我需要做什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T22:01:00.373

它看起来是因为可怕的标记 Web 表单输出。寻呼机被创建为 td 中的表。我可以让它与这个 CSS 一起工作：

```
.gridpager table {
    float: right;
} 
```

编辑：很高兴你明白了。我不知道你是否想用纯 CSS 来做。我也不太喜欢这种`float`方法。

编辑2：看起来渲染的网格在您使用时使用了用于寻呼机的`align`属性`td``<PagerStyle HorizontalAlign="Right" />`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T21:59:55.200

好吧，我觉得有点傻，但事实证明我只需要从我的风格中删除“text-align：right”。谢谢阅读！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T19:38:56.920

你可以做一个简单的 css 技巧：

```
.gridpager td table{
     margin-right:20px;
} 
```

这应该可以解决问题。

# c++ - _mm_sfence 与 __faststorefence

> ID：12308916
> 
> 赞同：3
> 
> 时间：2012-09-06T21:50:47.523
> 
> 标签：c++, concurrency, 64-bit, intel, windows-7-x64

根据 MSDN 文档，`__faststorefence`比`_mm_sfence`. 在我的时间里，它慢了三倍多。

平台：Win7-64，带有 x64 SDK 的 Visual Studio 2010。

```
#include <windows.h>
#include <xmmintrin.h>
#include <intrin.h>

int main(int argc, char* argv[])
{
    int* x = new int;
    __int64 loops = 1000000000; // 1 billion
    __int64 start, elapsed;

    start = __rdtsc();
    for (__int64 i = 0; i < loops; i++)
    {
        *x = 0;
        _mm_sfence();
    }
    elapsed = __rdtsc() - start;

    std::cout << "_mm_sfence: " << elapsed << std::endl
              << "average   : " << double(elapsed) / double(loops) << std::endl;

    start = __rdtsc();
    for(__int64 i = 0; i < loops; i++)
    {
        *x = 0;
        __faststorefence();
    }
    elapsed = __rdtsc() - start;

    std::cout << "__faststorefence: " << elapsed << std::endl
              << average          : " << double(elapsed) / double(loops) << std::end;
} 
```

结果：

*   _mm_sfence 平均：5.7
*   __faststorefence 平均：18.37

__faststorefence 生成`lock or DWORD PTR [rsp], ebp`，其中 ebp 已异或为零，并且 _mm_sfence 生成`sfence`（不出所料）

[__faststorefence](http://technet.microsoft.com/fr-fr/subscriptions/t710k390%28v=vs.100%29.aspx)的MSDN 文档明确指出它比`_mm_sfence`我的测试错误或错误更快。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-07T15:59:15.577

我使用提供的基准测试的`AMD`处理器显示 __faststorefence 是赢家。

```
Intel - _mm_sfence: 8.61, __faststorefence: 21.60
AMD 1 - _mm_sfence: 138.21, __faststorefence: 90.96
AMD 2 - _mm_sfence: 55.21, __faststorefence: 20.08 
```

这是与 VS 2013\.
_mm_sfence = sfence
__faststorefence = lock 或 dword ptr [rsp],esi

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-20T22:55:31.250

您无法比较 __fasstorefence（全围栏）与 _mm_sfence（商店围栏）。

您需要比较 __fasstorefence（全围栏）与 _mm_mfence（m - 全围栏）。

# php - 获取 mysql_affected_rows() 期望参数 1 是资源，给定布尔值 - 然而查询成功插入数据库 - 什么给出？

> ID：12308918
> 
> 赞同：0
> 
> 时间：2012-09-06T21:50:49.927
> 
> 标签：php, mysql

这个问题把我难住了。即使当我在 phpmyadmin 中检查数据库时，查询已成功插入到数据库中，我也会收到此错误。所以我知道查询通过并且不是错误的。我想要做的是注册一个用户，如果有结果返回 - 返回它以检查真或假，即如果结果存在然后继续。我班上的代码；

```
class registerUser {

    function register($email,$password) {
        $query = "insert into users(email,password) values('".$email."','".$password."')";
        $result = mysql_query($query) or die("Could not enter the user into the database".mysql_error());

        return mysql_affected_rows($result); 
    }

    function checkPasswords($password1,$password2) {
        if($password1 == $password2) {
            return true;
        }
        else {
            return false;
        }
    }
} 
```

使用该类的文件：

```
include('../data/connection.php');
include('../data/registerUser.php');

$connect = new connection();
$connect->connect($con, $db);
$register = new registerUser();
$checkPass = $register->checkPasswords($_POST['regpass'],$_POST['confirm']);

if($checkPass) {
    $reg = $register->register($_POST['regemail'],$_POST['regpass']);
        if($reg) {
            session_start();
            $_SESSION['id'] = $_POST['email'];
            $connect->close($con);
            header("Location:dashboard.php");    
        } else  {
           // Failure - message
            echo "Registration not successful, contact Administrator";
        }   
} else {
    echo "Passwords do not match";    
} 
```

似乎它永远不会通过 registerUser 中的注册函数并在 mysql_query 中执行 die 消息，但是在 phpMyAdmin 中检查时插入成功。我究竟做错了什么？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T16:43:39.613

```
return mysql_affected_rows($result); 
```

要修复它，请删除参数`$result`：

```
return mysql_affected_rows(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-06T22:03:01.000

[来自http://php.net/mysql_query](http://php.net/mysql_query)的几件事

1.  mysql 被“劝阻”，建议的替代方案是 mysqli 或 PDO。
2.  插入时的 mysql_query 返回一个布尔值

并来自[http://php.net/mysql_affected_rows](http://php.net/mysql_affected_rows)

它期望的资源是数据库链接，而不是查询结果。如果您只有一个与数据库的连接，则该参数是可选的。

此外，您可能希望添加输入转义来处理 sql 注入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-08T16:27:30.397

尝试传递连接变量，如 mysqli_affected_rows($conn); 这里 $conn 是我的连接变量

# html - 通过 varnish 代理服务器发送的事件

> ID：12308923
> 
> 赞同：2
> 
> 时间：2012-09-06T21:51:16.807
> 
> 标签：html, varnish, server-sent-events

我有一个网站在 Varnish 代理后面运行。为服务器发送的事件打开的任何连接都不会获得任何内容，也不会关闭。Varnish 似乎在将该内容转发到浏览器之前等待内容流结束。并且它保持与服务器的连接打开，直到内容结束。这两个问题都与服务器发送的事件不兼容。

**如何配置 Varnish 以在浏览器关闭连接时立即将内容刷新到浏览器并关闭其与服务器的连接？**

或者我可以动态地指示 Varnish 完全充当连接的传递，就好像它根本不存在一样？我可以毫无问题地在非代理系统上运行完全相同的 Web 应用程序。而且我无法在此设置中完全绕过 Varnish（例如不同的端口）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T12:30:26.157

您是否尝试在**vcl_recv中返回****管道**？

 **从[文档](https://www.varnish-cache.org/docs/3.0/tutorial/vcl.html)中：

> 管道也可以从 vcl_recv 返回。管道使客户端和后端连接短路，Varnish 只会坐在那里并来回移动字节。Varnish 不会查看来回发送的数据——因此您的日志将不完整。请注意，使用 HTTP 1.1 客户端可以在同一连接上发送多个请求，因此您应该指示 Varnish 在实际返回管道之前添加“Connection: close”标头。

不要错过您必须仅为 SSE 传入请求返回**管道。****

# c++ - 了解 valgrind 的输出

> ID：12308927
> 
> 赞同：0
> 
> 时间：2012-09-06T21:51:44.620
> 
> 标签：c++, linux, memory-leaks, valgrind

我正在为大学写一个项目，一切都完成了，通过了所有测试，运行良好，但 valgrind 告诉我：

```
==8059== Invalid read of size 8
==8059==    at 0x406E4E: RegPoly::getCurrentCoefficient() const (RegPoly.cpp:59)
==8059==    by 0x403368: MyPoly::operator+(MyPoly const&) const (MyPoly.cpp:281)
==8059==    by 0x403A6D: MyPoly::operator+=(MyPoly const&) (MyPoly.cpp:354)
==8059==    by 0x401E20: main (DemoPoly.cpp:50)
==8059==  Address 0x5953f50 is 0 bytes after a block of size 16 alloc'd
==8059==    at 0x4C27297: operator new(unsigned long) (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==8059==    by 0x4060CD: __gnu_cxx::new_allocator<double>::allocate(unsigned long, void const*) (new_allocator.h:92)
==8059==    by 0x405934: std::_Vector_base<double, std::allocator<double> >::_M_allocate(unsigned long) (in /a/fr-05/vol/home/stud/lablabla/CppLab/Ex3/DemoPoly)
==8059==    by 0x407355: double* std::vector<double, std::allocator<double> >::_M_allocate_and_copy<__gnu_cxx::__normal_iterator<double const*, std::vector<double, std::allocator<double> > > >(unsigned long, __gnu_cxx::__normal_iterator<double const*, std::vector<double, std::allocator<double> > >, __gnu_cxx::__normal_iterator<double const*, std::vector<double, std::allocator<double> > >) (stl_vector.h:1052)
==8059==    by 0x40700E: std::vector<double, std::allocator<double> >::operator=(std::vector<double, std::allocator<double> > const&) (vector.tcc:167)
==8059==    by 0x406C5D: RegPoly::RegPoly(RegPoly const&) (RegPoly.cpp:19)
==8059==    by 0x4031DB: MyPoly::operator=(MyPoly const&) (MyPoly.cpp:249)
==8059==    by 0x403B58: MyPoly::operator*=(MyPoly const&) (MyPoly.cpp:364)
==8059==    by 0x401DB6: main (DemoPoly.cpp:44) 
```

这些行：

44 -`p3 *= p2; // both are MyPoly objects`

50 -`p3 += p1;`

我有点明白这意味着我正在尝试从已更改的内存中读取（？）但我不明白为什么。我可以发布相关代码，只是，我不确定是哪一部分，因为它会使问题变得混乱。我可以粘贴相关部分，告诉我你需要什么。

谢谢！

编辑：这是代码：

```
MyPoly& MyPoly::operator *=(const MyPoly& rhs)
{
    *this = *this * rhs; // 364
    return *this;
}

===================

case PolyInterface::REG:
{
    RegPoly *tempReg = dynamic_cast<RegPoly*>(rhs.p_PolyBody); // rhs is an interface, hence the dynamic cast
    if (tempReg != NULL)
    {
        p_PolyBody = new RegPoly(*tempReg);  // 249\. p_PolyBody is a pointer stored in MyPoly. points to RegPoly object
    }
    break;
}

===================

RegPoly::RegPoly(RegPoly const& other)
{
    gCurrentRank = 0;
    gData = other.gData; // 19\. gData is a vector<double>
    _isZeroPoly = other._isZeroPoly;
}

===================

double RegPoly::getCurrentCoefficient() const
{
    return *gDataIterator; // 59\. vector<double>::const_iterator
}

===================

newPolyValues.push_back(
                p_PolyBody->getCurrentCoefficient() + rhs.p_PolyBody->getCurrentCoefficient());
// 281. 
```

`getCurrentCoefficient()`编辑：返回时我也得到了这`gData[gCurrentRank]` 意味着它与 gData 本身的位置有关，对吗？

RegPoly：

```
std::vector<double> gData;
std::vector<double>::iterator gDataIterator;
int gCurrentRank;
bool _isZeroPoly; // Inherited from the interface 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:04:01.327

相信 valgrind，它几乎总是显示存在的问题。

以下是您阅读消息的方式：

`RegPoly::getCurrentCoefficient() const (RegPoly.cpp:59)`试图从它不应该读取的内存位置读取，因为它不属于您的应用程序（未分配，非堆栈等......）。这个无效地址刚好超出了新操作符分配的空间，用于`RegPoly`复制构造函数（您可以看到创建该调用的整个回溯）。

如果这还不够帮助，请发布相关代码。

更新：

我没有看到您的复制构造函数复制`gDataIterator`（顺便说一句，当您复制时，为什么初始化`gCurrentRank`为 0？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:04:28.940

问题出在 RegPoly.cpp:59 上，而不是在 DemoPoly.cpp:50 上。

据说您已经分配了 16 个字节，但正在尝试读取超出分配的 8 个字节。

看到这个：http: [//valgrind.org/docs/manual/mc-manual.html#mc-manual.errormsgs](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.errormsgs)

**编辑**

可能您正在尝试访问无效的迭代器。一个 const 迭代器只是意味着你不能使用这个迭代器来修改容器内的值。

**编辑 2**

与无效迭代器相关的[简要说明。](http://www.gotw.ca/gotw/018.htm)

# core-data - 核心数据轻量级迁移失败 - “表 ZTABLENAME 已存在”

> ID：12308934
> 
> 赞同：1
> 
> 时间：2012-09-06T21:52:26.373
> 
> 标签：core-data, data-migration

注意！我看过[Core Data Migration - Table Already Exists](https://stackoverflow.com/questions/9897452/core-data-migration-table-already-exists)，但它并没有解决我的问题。

我正在尝试对我的数据模型进行轻量级迁移，但此时失败了：

```
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                         [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption,
                         nil];
store = [self addPersistentStoreWithType:NSSQLiteStoreType configuration:nil
                    URL:url options:options error:&error]; 
```

错误信息是：

```
2012-09-06 17:14:19.450 Selene[79064:c07] CoreData: error: (1) I/O error for database at /Users/colin/Library/Application Support/iPhone Simulator/5.1/Applications/E1638F38-B13A-4728-91CD-CC380E761544/Library/Application Support/Selene/.Selene.sqlite.migrationdestination_41b5a6b5c6e848c462a8480cd24caef3\.  SQLite error code:1, 'table ZMEASUREMENT already exists' 
```

对数据模型的实际更改是在完全不同的表 ZCYCLE 上添加了一个可选字符串列。因此，它抱怨 ZMEASUREMENT 是没有意义的。

我已经逐步完成了核心数据实例化，并且 NSManagedObjectModel 看起来已正确加载（新版本）。网址是正确的。

我尝试在 xcode 中进行 Clean，在 iOS 模拟器中重置内容和设置...，从头开始重新生成版本 1 的 sqlite 文件（使用核心数据），然后再次尝试迁移到版本 2 - 没有骰子。所以这并不是我的 sqlite 文件以某种方式损坏。

数据模型信息是否存储在我的清理可能遗漏的任何其他地方？

有没有其他方法可以调试轻量级迁移中实际发生的事情？除了上面引用的“表已存在”错误之外，我找不到任何信息，这对我来说没有任何意义。addPersistentStoreWithType: 内部发生的任何事情对我来说都是不透明的。

我发现进行迁移的唯一方法是将 Core Data 抱怨的表重命名为 ZMEASUREMENT，作为迁移的一部分。这仅适用于一（1）次迁移，然后我必须再次重命名表才能进行第二次迁移。我真的不同意每次更改数据模型时都必须更改名称的表的想法；当然，Core Data 并没有这么坏。

编辑：如果有帮助，这里是表 ZMEASUREMENT 的属性列表。这有什么奇怪的吗？

```
@property (nonatomic) int epochDay;         // Integer32 indexed
// time as number of seconds since local midnight, to avoid time zone and DST issues
@property (nonatomic, strong) NSNumber *localTime;  // Integer32 optional

// stored in Kelvins, to force me to test temperature conversion code properly
@property (nonatomic, strong) NSNumber *temperatureK;   // Float optional
@property (nonatomic) BOOL excludeTemperature;      // Boolean default=NO
@property (nonatomic, strong) NSNumber *fluidCode;  // Integer16 optional
@property (nonatomic, strong) NSNumber *openingCode;    // Integer16 optional
@property (nonatomic, strong) NSNumber *positionCode;   // Integer16 optional
@property (nonatomic, strong) NSNumber *textureCode;    // Integer16 optional
@property (nonatomic, strong) NSNumber *rateCode;   // Integer16 optional
@property (nonatomic, strong) NSNumber *heightCode; // Integer16 optional
// try renaming the internal property to see if it helps lightweight migration
@property (nonatomic, strong) NSString *commentDPL; // String optional
@property (nonatomic, strong) NSString *comment;    /* derived property (alias for commentDPL) */
@property (nonatomic, strong) NSSet *notes;     // Optional to-many relationship to MeasurementNote 
```

唯一的非可选字段是 epochDay 和 excludeTemperature。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:18:22.077

首先，您是否尝试过检查数据库的完整性？很多时候，当我迁移客户端时，它会抛出错误，因为他们的数据库实际上已经损坏，但损坏很轻微，直到迁移才被发现。

你想做这样的事情：

```
sqlite3 FILENAME
pragma integrity_check; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T22:37:28.097

您是否使用了名称与内置方法名称一致的任何属性或实体？没有这些列表，但是像“name”、“count”这样的名称可能会因为这种效果而导致问题。

还是新属性第十七，莫非？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T19:53:04.130

好的，最终为了解决我的问题，我不得不删除我的整个 xcdatamodeld 目录并从头开始重新生成数据模型。我想我那里有腐败吗？它现在似乎起作用了；手指交叉。我对这个解决方案不满意，因为它会让我要求我所有的 beta 测试人员丢弃他们保存的数据并重新开始，但这似乎是我唯一拥有的东西。

如果有人对到底出了什么问题有更好的了解，我仍然*很想*听听。我的应用程序将因保存数据的可靠性而生死攸关，如果我还有任何付费客户，这种丢弃所有内容并重新开始的“解决方案”将是行不通的。Core Data 现在让我很紧张。

# android - 如何从终端为本地应用程序创建 android 项目？

> ID：12308935
> 
> 赞同：2
> 
> 时间：2012-09-06T21:52:26.443
> 
> 标签：android, c++, android-ndk, project

我想加快我的工作，为仅使用 C++ 代码的 Android 原生应用程序创建模板，这种应用程序的清单略有不同，文件夹和文件配置也略有不同，我希望我能从命令行创建一个项目

```
android create project 
```

命令。

我只对为 NDK 和本机活动创建一个 android 项目模板感兴趣，没有别的，没有 java 没有 JNI。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T23:54:41.687

1.  如前所述创建 Android 项目。您必须创建它，因为它是一个纯 Java Android 项目。
2.  `jni`在你的 android 项目中创建文件夹。创建您的代码和您的 Makefile。查看 NDK 附带的示例。
3.  一旦您拥有所有（本机代码），本机活动和本机活动的清单，运行`ndk-build`以编译本机部分。
4.  然后运行`ant debug`以构建 APK。

# javascript - 如何从 django 中的 url 解析 javascript 字符串

> ID：12308942
> 
> 赞同：1
> 
> 时间：2012-09-06T21:52:45.540
> 
> 标签：javascript, html, django, url

我在 javascript "/people/things/" 中有这个 url 我想要一个只返回 "things" 的函数我该怎么做？

我试过丑陋的东西。就像迭代一样，但是当我必须弄清楚如何删除字符串的其余部分并且渐近地非常缓慢时，我会陷入困境。

我不断得到“非法”。超级烦。

```
$(function() { 

    var parse = function(str) {

        var a = "";   
        if (str.length && str.length > 1) {

           str = str.slice(0, str.length -1);   //remove first

            for (var i = str.length; i > 1; i--) {
                if (str[i] !== '\\' ) {
                      a += str[i];
                    }

            }

        }

        return a;

    };   

       c = "\things\stuff\";
       alert(parse(c));        //result should be "things"                

});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T21:56:06.557

首先，您可以使用以下代码来简化代码[`match()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)：

```
var s = "/people/things/";
var match = s.match(/\/([^/]+)\/$/);
var things = match[1]; // "things" 
```

关于`ILLEGAL`错误，那是因为您忘记在字符串中**转义**`\`。因此，请`\things\stuff\`使用`\\things\\stuff\\`.

现在，到你的`parse`功能。一般的想法是正确的，但是您有几个实现错误：

1.  `break`一旦你找到`\\`（你的`else`部分`if`）就退出循环；否则，您将跳过`\`，添加*所有*其他字符；
2.  您正在从头开始遍历数组，并将每个字符添加到字符串中；因此，最后，你会得到一个*反转*的字符串。要修复它，而不是使用`a += str[i]`，使用`a = str[i] + a`。
3.  `i`应该以 开头`a.length - 1`，而不是`a.length`。

这是最终版本：

```
var parse = function(str) {
  var a = '';   
  if (str.length && str.length > 1) {
    str = str.slice(0, str.length -1);
    for (var i = str.length - 1; i > 1; i--) {
      if (str[i] !== '\\' ) {
        a = str[i] + a;
      } else {
        break;   
      }
    }
  }
  return a;
}; 
```

**[演示](http://jsfiddle.net/3WahJ/)**。

# c# - 剑道 UI 网格数据源 asp webforms

> ID：12308946
> 
> 赞同：3
> 
> 时间：2012-09-06T21:53:17.767
> 
> 标签：c#, jquery, asp.net, ajax, kendo-ui

因此，我按照[Kendo 提供](http://demos.kendoui.com/web/grid/local-data.html)的示例使用外部数据源，由于某种原因，当您放置 Default.aspx/GetEvents 的 URL（其中 GetEvents 是 Default.aspx 中的网络方法）时，它会返回 Default.aspx 的整个 HTML只是在普通的 AJAX 调用中调用 webmethod。

所以我找到了一种解决方法，我使用了本地数据源方法，它调用了一个javascript函数——这个javascript函数在default.aspx中对我的webmethod进行了自己的ajax调用，并获得了成功的响应

所以这是我的代码

```
 $(document).ready(function () {
                $("#grid").kendoGrid({
                    dataSource: {
                        data: createRandomData(),
                        schema: {
                            data: "d"
                        },
                        pageSize: 10
                    },
                    height: 250,
                    scrollable: true,
                    sortable: true,
                    filterable: true,
                    pageable: {
                        input: true,
                        numeric: false
                    },
                    columns: [
                        {
                            field: "Title",
                            title: "Title",
                            width: 100
                        },
                        {
                            field: "StartDate",
                            title: "StartDate",
                            width: 100
                        },
                        {
                            field: "Keywords",
                            width: 100
                        }
                    ]
                });
            }); 
```

这是 createRandomData() 返回的开始 - 它是有效的 json - 我只是不想全部粘贴并让这个问题不可读

```
"d" : [
{
    "Title": "Chicago BlackHawks vs. Detroit Redwings",
    "StartDate": "9/7/2012 12:00:00 AM",
    "Keywords": "-- Select --"
},
{
    "Title": "",
    "StartDate": "1/1/1900 12:00:00 AM",
    "Keywords": "-- Select --"
}, ....... 
```

我看不出为什么这不起作用，现在网格只是说“正在加载......”并且永远保持这种状态，没有控制台错误

```
 function createRandomData() {
                    $.ajax({
                        type: "POST",
                        url: "MyEvents.aspx/GetEvents",
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (msg) {                                
                            var rs = msg;
                            return rs;
                        }
                    });
                    return false;
                } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T22:01:12.750

可能的问题是 KendoUI 在使用该`data`元素时需要一个简单的 javascript 调用（没有 AJAX）。当您调用 JS 方法时，它会立即返回，但 AJAX 调用需要更长的时间才能完成，但 Kendo 网格在调用完成时永远不会收到通知。

您可以尝试在[此处](http://docs.kendoui.com/api/framework/datasource#transportread-objectstringfunction)`transport.read`使用dataSource 上的对象。这样，网格应该可以与 AJAX 调用一起正常工作。

编辑：你有没有尝试过这样的事情：

```
dataSource: {
    transport: {
        read: function(options) {
            $.ajax({
                type: "POST",
                url: "MyEvents.aspx/GetEvents",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (msg) {                                
                    options.success(msg.d);
                }
            });
        }
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:02:40.873

也许更改您的架构定义：

由此

```
schema: {
 data: "d"
} 
```

对此

```
schema: {
 model: {
  fields: {
    Title: { type: "string" },
    StartDate: { type: "string" },
    Keywords: { type: "string" }
   }
 }
} 
```

# ruby-on-rails-3 - Rails 3.1 不能为非数据库模型批量分配受保护的属性

> ID：12308947
> 
> 赞同：1
> 
> 时间：2012-09-06T21:53:24.897
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.1

处理的rails 3.1部分`attr_accessor`显然已损坏。

我有几个模型根本没有数据库，有些模型的属性没有持久化。

例子：

```
class User < ActiveRecord::Base

  #persisted attribs
  attr_accessible :name, :email, :password, :password_confirmation, :is_admin, :permissions

  #non persisted attribs<br />
  attr_accessor :roseburg, :kfc, :kcpl
  ........ 
```

如果我尝试将用户保存在控制器中创建或更新

```
def create<br />
  @user = User.new(params[:user]) 
```

或者

```
def update
  @user = User.find(params[:id])

  respond_to do |format|
    if @user.update_attributes(params[:user]) 
```

我收到类似的错误`Cannot mass assign protected attributes :roseburg, :kfc, :kcpl`

解决方法是填充属性并使用 save 方法。

```
def create
  @user = User.new             

  (params[:user]).each do |attr_name, attr_value| 
    if @user.respond_to?("#{attr_name}")
      @user.send("#{attr_name}=", attr_value)                  
    end
  end

  @user.save
    ..... 
```

和

```
def update
  @user = User.find(params[:id])
  respond_to do |format|

  (params[:user]).each do |attr_name, attr_value| 
    if @user.respond_to?("#{attr_name}")
      @user.send("#{attr_name}=", attr_value)                  
    end    
  end

  if @user.save
  .... 
```

我的问题是这对安全有什么影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:06:36.877

当您将哈希传递给类似`new`,`create`或的方法时`update_attributes`，Rails 将确保您只能批量分配允许使用的属性`attr_accessible`（或者，不允许使用 列入黑名单的属性`attr_protected`）。

如果您不添加`:roseburg`,`:kfc`和`:kcpl`to `attr_accessible`，它将引发像您描述的那样的批量分配错误。

将它们定义为`attr_accessor`仅保证您将拥有 setter 和 getter（例如`roseburg=`和`roseburg`），这与 Rails 的批量赋值检查无关。`attr_accessor`实际上是一个 Ruby 结构，而不是 ActiveRecord 提供的任何东西。

如果您不将非持久属性添加到`attr_accessible`，则需要在初始化模型实例时手动分配值，就像您在问题中描述的那样。

# wpf - UnhandledExceptionFilter 捕获所有异常但仅重新抛出一些异常

> ID：12308950
> 
> 赞同：3
> 
> 时间：2012-09-06T21:53:35.687
> 
> 标签：wpf, exception, add-in, dispatcher, unhandled-exception

我正在使用 WPF 窗口开发 Word 加载项。我正在使用 UnhandledExceptionFilter 来捕获任何未处理的异常，以便 Word 不会引发错误消息。

```
Dispatcher.CurrentDispatcher.UnhandledExceptionFilter += new DispatcherUnhandledExceptionFilterEventHandler(Dispatcher_UnhandledExceptionFilter);

void Dispatcher_UnhandledExceptionFilter(object sender, DispatcherUnhandledExceptionFilterEventArgs e)
{
  e.RequestCatch = false;
  // Display error message and close the window.
} 
```

我的事件被正确触发，我可以显示相应的错误消息框。但是，对于某些异常（例如窗口代码中的空指针异常），异常仍然被抛出给调用类。而其他异常（例如，从窗口中使用的另一个帮助程序类抛出的 EndpointNotFoundException）在我的事件中被捕获并且不会被重新抛出。

有什么想法吗？谢谢。

我问了一个关于如何捕获未处理异常的初始问题，但现在我遇到了这个额外的问题。

[在 Microsoft 显示错误消息之前，在 Word 加载项中捕获 C# WPF 未处理的异常](https://stackoverflow.com/questions/12115030/catch-c-sharp-wpf-unhandled-exception-in-word-add-in-before-microsoft-displays-e)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-12-02T00:51:41.130

我通过使用 3 个不同的异常处理程序来解决此问题，具体取决于抛出异常的方式和位置，您需要单独捕获它。这也使您有机会根据您自己对异常是否致命的决定来取消终止并继续程序执行。

```
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Threading;

public class ExceptionHelper
{
    public static ExceptionHelper()
    {
        TaskScheduler.UnobservedTaskException += TaskSchedulerOnUnobservedTaskException;
        Application.Current.Dispatcher.UnhandledException += DispatcherOnUnhandledException;
        AppDomain.CurrentDomain.UnhandledException += CurrentDomainUnhandledException;
    }

    private static void TaskSchedulerOnUnobservedTaskException(object sender, UnobservedTaskExceptionEventArgs e)
    {
        e?.SetObserved();
        CurrentDomainUnhandledException(sender, new UnhandledExceptionEventArgs(e.Exception, false));
    }

    private static void DispatcherOnUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)
    {
        e.Handled = true;
        CurrentDomainUnhandledException(sender, new UnhandledExceptionEventArgs(e.Exception, false));
    }

    public static void CurrentDomainUnhandledException(object sender, [CanBeNull] UnhandledExceptionEventArgs e)
    {
        //Program is hung, ensure we don't infinite loop on outofmemory exception by removing the handler
        var isTerminating = e?.IsTerminating == true;

        if (isTerminating)
        {
            TaskScheduler.UnobservedTaskException -= TaskSchedulerOnUnobservedTaskException;
            Application.Current.Dispatcher.UnhandledException -= DispatcherOnUnhandledException;
            AppDomain.CurrentDomain.UnhandledException -= CurrentDomainUnhandledException;
        }

        var ex = (Exception)e?.ExceptionObject;

        //Kill the app if we weren't already terminating and the program is in a corrupted state.

        if(!isTerminating)
            Process.GetCurrentProcess().Kill();

    }
} 
```

# c# - 将先前生成的实体类与另一个数据库重用（相同的模式/表）

> ID：12308959
> 
> 赞同：0
> 
> 时间：2012-09-06T21:54:21.013
> 
> 标签：c#, linq-to-sql

我编写了一个使用 Linq to SQL 查询/更新数据库的工具。Visual Studio 自动生成的实体类绑定到此特定数据库副本的名称。看起来如果我需要在同一数据库的另一个副本（相同的表名、模式等）上重新运行该工具，我需要再次为该数据库创建实体类。在创建数据上下文时，是否可以创建一组实体类并让程序的其余部分作为参数传入服务器/数据库的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:00:23.040

请使用 DataContext 的这个构造函数来指定新的数据库连接字符串 - [DataContext Constructor](http://msdn.microsoft.com/en-us/library/bb350721.aspx)

# java - 尝试从 xaction 输出 excel 时出现 Pentaho Max Column width 错误

> ID：12308962
> 
> 赞同：1
> 
> 时间：2012-09-06T21:54:39.250
> 
> 标签：java, excel, max, pentaho

我已经成功地使用 3 个 pentaho 工具为我的数据库建立了一个成功的工作环境。水壶转换：从 JNDI 查询。pentaho 报告：组织和输出转换给出的数据。还有一个 Action Secuence xaction，用于管理参数并将报告解决方案上线。

一切似乎都运行良好，一旦我将报告放到网上并在参数中输入一些输入，然后它会以几乎任何报告格式提交表单：text/html、pdf 和 cvs。

但是当我尝试提交 excel 输出 (application/vnd.ms-excel) 时，我收到以下错误：

> Pentaho BI 平台在运行操作序列时报告错误
> 
> 可能的原因：RuntimeContext.ERROR_0017 - [es_18] 活动未能执行操作序列：BillingReport.xaction 执行堆栈：执行操作：Pentaho 报告（SimpleReportingComponent）循环索引（基于 1）：0 错误时间：miércoles 5 de septiembre de 2012 12H18 ' VET 错误类型：ActionExecutionException 会话 ID：joe 实例 ID：65ad1224-f779-11e1-a34f-b53c1ce91064 操作类：SimpleReportingComponent 操作描述：Pentaho 报告

即使 .prpt 文件中没有字段，它也会一直显示相同的错误（我还使用管理控制台刷新了 biserver 并进行了每次更改）。如果我检查 catalina.out 日志中发生的事情，我会得到一堆 java 异常跟踪，但有一行显示：

> java.lang.IllegalArgumentException：单个单元格的最大列宽为 255 个字符。

我不确定，但这似乎是一个与名为 setColumnWidth 的 apache/tomcat 函数相关的 jira 问题。

有任何想法吗？

# c++ - C++ 文本框字体

> ID：12308974
> 
> 赞同：1
> 
> 时间：2012-09-06T21:55:55.297
> 
> 标签：c++, winapi

我在 C++ (Win32) 中创建了一个文本框现在我想更改文本框的形式和字体，因为它看起来很丑我怎么做？

这就是我创建文本框的方式

```
HWND WindowManager::textbox(int width, int height, int xPos, int yPos, LPCSTR content, bool edit_able)
{
    int type = (edit_able) ? (WS_CHILD|WS_VISIBLE|ES_AUTOHSCROLL) : (WS_CHILD|WS_VISIBLE|WS_HSCROLL|ES_AUTOHSCROLL);
    return CreateWindowEx(
        WS_EX_CLIENTEDGE,
        "EDIT",
        content,
        type,
        xPos,
        yPos,
        width,
        height,
        window,
        (HMENU)50,
        GetModuleHandle(NULL),
        NULL
    );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:59:17.727

几个 Windows 控件使用丑陋的系统字体初始化 - 如果您想要漂亮的控件，您必须自己更改字体，如下所示：

```
// create the text box
HWND hTextBox = CreateWindowEx(...);

// initialize NONCLIENTMETRICS structure
NONCLIENTMETRICS ncm;
ncm.cbSize = sizeof(ncm);

// obtain non-client metrics
SystemParametersInfo(SPI_GETNONCLIENTMETRICS, sizeof(ncm), &ncm, 0);

// create the new font
HFONT hNewFont = CreateFontIndirect(&ncm.lfMessageFont);

// set the new font
SendMessage(hTextBox, WM_SETFONT, (WPARAM)hNewFont, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T23:29:17.303

该`WM_SETFONT`消息是您正在寻找的。

# unit-testing - 如何让 HBaseTestingUtility 在 map reduce 作业中查找类？

> ID：12308980
> 
> 赞同：1
> 
> 时间：2012-09-06T21:56:17.933
> 
> 标签：unit-testing, scala, hadoop, hbase, sbt

我们正在使用 cdh3u4、Hadoop 和 HBase。我正在尝试运行一个单元测试，在启动 HBaseTestingUtility 提供的 miniMapReduceCluster 后启动 MapReduce 作业。

作业在 map 和 reducer 任务 stderr 日志中失败：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/hadoop/mapred/Child
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.mapred.Child
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
 Could not find the main class: org.apache.hadoop.mapred.Child.  Program will exit.
java.lang.Throwable: Child Error 
```

这几天我一直在想办法解决这个问题。我猜这是一个错误的配置，并且由于 fs / hdfs 配置值配置错误，集群没有找到我的任何 jar。我的测试设置代码如下所示（请原谅拼写错误，因为这是从 Scala 翻译的）：

```
HBaseTestingUtility htest = new HBaseTestingUtility();
Configuration c = htest.getConfiguration();
c.set("hadoop.log.dir", "/tmp/hadoop-test-logs"); // required or else can't start the miniMapReduceCluster
htest.startMiniCluster();
htest.startMiniMapReduceCluster();

// create and run a MapReduce job that works in production but not in test 
```

如果这很重要，我们正在使用 Play！带有 Specs2 测试框架和 Scala 的框架 2.0（使用 SBT）。我认为这无关紧要（我们没有使用 Java + JUnit）。

有没有人见过这个？关于在哪里看的任何指示？

提前致谢，

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:11:20.957

事实证明，我们必须在 minicuster 上手动设置类路径。这可能是 SBT / Ivy 的事情 - 因为我见过的所有示例都不必这样做，并且可能使用 Maven（和 Java）。

这是我解决类路径问题的方法（在 Scala 中）：

```
// unit test setup:
val htest = new HBaseTestingUtility
htest.startMiniCluster()

val conf = htest.getConfiguration
conf.set("hadoop.log.dir", "/tmp/hadoop-test-logs") // required to prevent NPE when starting miniMapReduceCluster
htest.startMiniMapReduceCluster()

// Set up cluster classpath:
val fs = FileSystem.get(conf)
val jarsDir = new Path("/tmp/hadoop-test-lib")
fs.mkdirs(jarsDir)

// copy jars over to hdfs and add to classpath:
for (jar <- myjars) {
    val localJarPath = new Path("file://%s".format(jar.getAbsolutePath))
    val hdfsJarPath = new Path("/tmp/hadoop-test-lib/%s".format(jar.getName))
    fs.copyFromLocalFile(localJarPath, hdfsJarPath)
    DistributedCache.addFileToClassPath(hdfsJarPath)
}

// now Map and Reduce tasks can find classes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T06:36:54.917

我确实编译了一个博客： http: [//mevivs.wordpress.com/2012/05/03/perform-crud-over-hbase-using-hbasetestingutilityembeddedhbase/](http://mevivs.wordpress.com/2012/05/03/perform-crud-over-hbase-using-hbasetestingutilityembeddedhbase/)

看看这个。

希望能帮助到你。

-维维克

# javascript - 图片源后期绑定——去掉同时显示的冗余错误图标

> ID：12308981
> 
> 赞同：0
> 
> 时间：2012-09-06T21:56:30.140
> 
> 标签：javascript, jquery, html, css, internet-explorer

在页面上我有 img 声明：

```
<img src="" alt="" itemid="7" /> 
```

我想将此图像与适当的源 URL 绑定。我需要从外部服务获取这个 url：

```
$(document).ready(function () {
    var id = $(img).attr('itemid');
    getImageUrl(id);  // fetch the image source url, takes about 5 seconds
});

function getImageUrl(id) {
    $.ajax({
        url: 'http://images.service.svc/get?id=' + id,
        type: 'GET',
        dataType: 'json',
        contentType: 'application/json; charset=utf-8',
        success:
            /* after about 5 seconds */
            function (result) {
                var imageUrl = result.ImageUrl;
                image.attr('src', imageUrl);
            }
    });
} 
```

同时，在 IE 中我得到错误图像

![在此处输入图像描述](../Images/6504e8b7044eeaa75d760654cb314c24.png)

源url绑定图片后如何显示图片，然后由浏览器下载，最后准备显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:08:58.893

您可以`visibility:hidden`在 CSS 中将图像设置为，然后在 JavaScript 中，属性完成后，将 CSS 设置为`visibility:visible`

```
image.css('visibility','visible'); 
```

# javascript - 抓住一个卷轴

> ID：12308987
> 
> 赞同：0
> 
> 时间：2012-09-06T21:56:57.457
> 
> 标签：javascript, jquery, scroll, jquery-events, mousewheel

我使用`scrollTop`jQuery 上的鼠标滚轮调整在我的网站上导航，问题是：它适用于真正的鼠标（不是那么糟糕）：如果你滚动 2，你必须滚动一个档位才能进入网站的第二部分缺口它将转到第 3 页等。

因此，当有人使用笔记本电脑滚动时，它看起来非常有问题：它直接进入网站的最后一页。

我想知道如何在用户停止滚动之前捕捉几个滚动凹槽。就像在这个页面上一样：neverbland.com

这是我的：knmprod.com/knmprod

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T22:05:07.380

每次收到鼠标滚轮事件时设置一个计时器，每次收到另一个事件时取消第一个事件。

只有在您停止获取事件一段时间（例如 0.5 秒）后才会触发您的操作。

```
var timer, longTimer = false, delta;

$('.page').bind('mousewheel', function(e, localDelta) {
  if(!longTimer) longTimer = setInterval(action, 1500);
  clearInterval(timer);
  timer = setInterval(action, 500);
  delta = localDelta;
}

function action() {
  clearInterval(timer);
  clearInterval(longTimer);
  longTimer = false;

  if(delta<0) {
    number=plusone(number);
    goToByScroll(number);
  } else {
    number= minusone(number);
    goToByScroll(number);
  } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T22:21:09.190

您可以使用[鼠标滚轮插件](http://brandonaaron.net/code/mousewheel/docs)和计时器来检查滚轮何时没有移动几毫秒（例如 250 毫秒），然后执行页面更改。无论鼠标的速度或类型如何，这将允许每次鼠标移动只更改一个页面 - 与 neverbland.com 一样：

```
$('body').mousewheel(function() {
  clearTimeout($(this).data('timer'));
  $(this).data('timer', setTimeout(function() {
     alert('Change Page');
  }, 250));
}); 
```

[JSFiddle 这里](http://jsfiddle.net/QJSz4/2/)

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-06T22:31:04.080

这不起作用吗？

```
​$(window).scroll(function(){alert(1)});​ 
```

[http://jsfiddle.net/2hwu9/](http://jsfiddle.net/2hwu9/)

# ruby-on-rails-3 - 如何处理错误并将错误发送到 respond_with

> ID：12308988
> 
> 赞同：0
> 
> 时间：2012-09-06T21:57:03.930
> 
> 标签：ruby-on-rails-3, error-handling

我正在开发一个 Rails 应用程序，现在只是 Web 服务..

在其中一个网络服务中，我收到一个包含大量用户信息的 JSON，例如：

```
"friends": [
    {
        "name": "John",
        "age": "10",
        "country": "Ecuador"
    },
    {
        "name": "Tom",
        "age": "15",
        "country": "USA"
    },
    {
        "name": "Mery",
        "age": "20",
        "country": "Mexico"
    }
] 
```

所以......在我的控制器中，我只是遍历每个“朋友”并执行类似 Friend.new 之类的操作，然后填充该对象上的字段，然后保存......

但是我的问题出现在向请求者发送响应的那一刻，有时这个过程可能会因为验证失败或类似的事情而失败......我该如何处理？我只是为循环做一个开始...救援...结束然后？我要向respond_with 发送什么？是否可以发送respond_with({:error => "Validation problem"})？？

有什么好的方法来处理这个？任何的想法？

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T22:06:05.380

是的，如果出现问题，您可以使用 respond_with。例如，您可以转储无效对象的错误，并为此设置 http 状态代码。

```
respond_with(@your_object.errors.messages, :status => :unprocessable_entity) 
```

为了清楚起见，尝试创建新的无效实例并保存它。然后将`errors`方法转换为该实例。

# java - 抛出异常后不去正确的 catch 块

> ID：12308999
> 
> 赞同：1
> 
> 时间：2012-09-06T21:58:13.633
> 
> 标签：java, exception, try-catch, jdbctemplate

我在 jdbctemplate 中使用 batchupdate 插入时尝试处理重复键异常。

当我尝试使用重复键插入时，它将进入服务方法中的异常捕获块而不是 BatchUpdateException 捕获块。我将堆栈跟踪作为 BatchUpdateException 得到，但它仍然是 Exception catch 块。任何的想法？

代码如下：

服务等级：

```
 try {
        auctionDM.insertSelctedAuctionItem(salesBean, Constants.VESL_CODE);
    } catch (BatchUpdateException bue) {
        logger.error(" Duplicate item -", bue);
        throw new MyException(ExceptionCodes.DB_DUPLICATE_ITEM);
    } catch (SQLException se) {
        logger.error(" SQL Exception occured -", se);
        throw new MyException(ExceptionCodes.DB_ERROR);
    } catch (LegacyException e) {
        logger.error(" AppException occured -", e);
        throw new MyException(ExceptionCodes.DB_ERROR);
    } catch (Exception e) {
        logger.error(" SystemException occured -", e);
        throw new MyException(ExceptionCodes.DB_ERROR);
    } 
```

数据管理器类：

```
public int[] insertSelctedAuctionItem(SalesBean salesBean, String veslCode) throws SQLException {

      //code
      return getJdbcTemplate().batchUpdate(sqlQuery.toString(), batchParams);
} 
```

堆栈步数：

```
org.hibernate.exception.ConstraintViolationException: Duplicate entry 'PD-2794-86686' for key 'PRIMARY'
    at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:128)
    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)
    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)
    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:129)
    at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)
    at $Proxy77.executeBatch(Unknown Source)
    at org.springframework.jdbc.core.JdbcTemplate$4.doInPreparedStatement(JdbcTemplate.java:899)
    at org.springframework.jdbc.core.JdbcTemplate$4.doInPreparedStatement(JdbcTemplate.java:1)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:587)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:615)
    at org.springframework.jdbc.core.JdbcTemplate.batchUpdate(JdbcTemplate.java:884)
    at org.springframework.jdbc.core.BatchUpdateUtils.executeBatchUpdate(BatchUpdateUtils.java:32)
    at org.springframework.jdbc.core.JdbcTemplate.batchUpdate(JdbcTemplate.java:931)
    at org.springframework.jdbc.core.JdbcTemplate.batchUpdate(JdbcTemplate.java:927)
    at com.gfa.fastar.dm.mysql.AuctionMySQL.insertSelctedAuctionItem(AuctionMySQL.java:2091)
    at com.gfa.fastar.domain.AuctionPD.insertQuickAddArtPiece(AuctionPD.java:1121)
    at com.gfa.fastar.domain.AuctionPD$$FastClassByCGLIB$$898d8775.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)
    at com.gfa.fastar.domain.AuctionPD$$EnhancerByCGLIB$$2aff5854.insertQuickAddArtPiece(<generated>)
    at com.gfa.fastar.action.ArtSalesAction.quickAdd(ArtSalesAction.java:977)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:453)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:292)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:255)
    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:265)
    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:138)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:211)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:211)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at com.gfa.fastar.util.SessionInterceptor.intercept(SessionInterceptor.java:39)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:511)
    at org.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:77)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.doFilter(StrutsPrepareAndExecuteFilter.java:91)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.orm.hibernate4.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:119)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:563)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:399)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:317)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:204)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:311)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.sql.BatchUpdateException: Duplicate entry 'PD-2794-86686' for key 'PRIMARY'
    at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1693)
    at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1108)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)
    ... 96 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T22:02:18.630

Spring 将 SQLExceptions 包装在名为 DataAccessException 的 RuntimeException 类中。因此，您的 insertSelectedAuctionItem 会引发 RuntimeException，然后由 Exception catch 子句处理。

可以在[此处找到 Spring 异常处理的文档](http://static.springsource.org/spring/docs/3.2.0.M1/reference/html/dao.html#dao-exceptions)