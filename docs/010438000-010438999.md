# StackOverflow 问答 10438000-10438999

# css - FireFox 和 Chrome 在 url 中处理 \（反斜杠）的不同行为

> ID：10438008
> 
> 赞同：16
> 
> 时间：2012-05-03T19:23:25.273
> 
> 标签：css, firefox, url, google-chrome, backslash

**背景**

根据我的经验，当我的 ubuntu 工作站配置在具有活动目录的域上时，为我创建的用户名是根据以下模式。

> 域名\用户名

在 linux 上使用 apache的**userdir**扩展需要在 URL 中使用用户名才能访问主目录中的 public_html。

> [http://localhost/~domain_name\user_name](http://localhost/~domain_name%5Cuser_name)

**问题一：**

Chrome 将 URL 中的所有反斜杠 ' **\** ' 字符转换为正斜杠 ' **/** ' 并且生成的 url 变得完全不同，并且总是导致**Not Found**。

> [http://localhost/~domain_name/user_name](http://localhost/~domain_name/user_name)

另一方面，Firefox**不会将反斜杠转换为正斜杠**，因此对预期目标的 http 请求由 Web 服务器提供。

```
Common solution is to encode back slash in %5C. 
```

**问题 B：**

如果我们在 CSS @import 构造中使用类似的路径（路径中包含**\**），则作为 HTTP Get 请求的 css 文件的导入过程将失败并报告 404 错误，并且在 404 错误中报告的 URL 完全错过了**\**的存在。这意味着在调用 GET 请求之前从 URL 中删除了**\ 。**

这种行为在 Firefox 和 Chrome 中很常见。但他们有不常见的解决方案

Firefox 需要转义反斜杠才能在 css 导入过程中工作。

> @import url(" [http://localhost/~domain_name\\user_name/path/to/css](http://localhost/~domain_name%5C%5Cuser_name/path/to/css) ");

Chrome 像往常一样需要编码的反斜杠解决方案。

> @import url(" [http://localhost/~domain_name%5Cuser_name/path/to/css](http://localhost/~domain_name%5Cuser_name/path/to/css) ");

*   **处理URL中的\**的统一解决方案是什么？
*   有没有办法避免**\**出现在用户名中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-04T07:33:03.087

处理 URL 中的反斜杠的统一解决方案是使用 %5C。RFC 2396 根本不允许在 URL 中使用该字符（因此有关该字符的任何行为都只是错误恢复行为）。RFC 3986 确实允许这样做，但没有得到广泛实施，尤其是因为它与现有的 URL 处理器不完全兼容。

尤其是 Chrome，它与 IE 做同样的事情：假设您在任何时候键入反斜杠时都表示正斜杠，正如您所发现的那样，因为这就是 Windows 文件路径的作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-19T11:57:07.333

尝试使用 Firefox 中的 Slashy 插件来帮助您。这里是它的链接。

[斜杠](https://addons.thunderbird.net/en-us/firefox/addon/slashy/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-04T19:23:19.537

此反斜杠自动转换问题已在 Chrome 版本 >= 53.0.2785.116 中修复。

现在反斜杠被正确地视为**%5C**。

# php - 在 MySQL 数据库中存储 MS SQL Server 凭据

> ID：10438009
> 
> 赞同：1
> 
> 时间：2012-05-03T19:23:37.403
> 
> 标签：php, mysql, sql, sql-server, security

我正在开发一个连接到用户 MSSQL 数据库以收集信息的网站。用户被分配到不同的 MSSQL 数据库帐户，并使用存储在 MySQL DB 中的 IP、用户名和密码连接到它们。

目前，我所拥有的是 PHP，AES 根据需要对密码进行加密/解密。这似乎不对。它可以防止您通过查看数据库来查看纯文本密码（这无疑是好的），但我并没有出售它的安全级别。

如果您再也不需要密码，那么哈希非常好，但我需要。所以我真的不知道如何在网站的这个特定方面实施合理的安全级别。

任何建议都会很棒。我是不是完全错了，是个白痴。有没有一种非常优越的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:57:32.800

显然，如果您将密码发送到 MS SQL，您将需要能够反转该值。我认为加密将是这里最正确的答案。无论哪种方式，您的代码仍然能够推断此密码，否则您将无法连接。

如果您想提高安全性，您可以使用根据用户名计算的校验和来为您​​的加密提供种子……但是，如果用户名发生更改，您将需要解密并重新加密。这只会让可能知道您正在使用 AES 的“其他人”变得更加困难。

但归根结底，您将始终能够知道密码是什么，因为您需要解密。在这种情况下你能做的只有这么多，最好的办法是在每次需要密码时都向用户索要密码。

# ruby-on-rails - RailsCast 182（修订）：Jcrop 不工作

> ID：10438012
> 
> 赞同：4
> 
> 时间：2012-05-03T19:23:42.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, coffeescript, railscasts, jcrop

我正在尝试以与 Ryan Bates 在 RailsCasts 第 182 集（修订版）中使用它的方式完全相同的方式将 Carrierwave 与 Jcrop 一起使用，但我无法让 Jcrop 工作，我不知道为什么。

当我到达 时`crop.html.erb`，它按预期显示原始图片和预览，但我无法在原始图片上选择任何内容并且预览没有响应。

我玩了一点，当我添加`()`后面时，`.Jcrop`我至少可以在原始图片上选择一些东西，但预览仍然没有响应，并且所选区域也没有保持 aspectRatio 为 1。所以我猜出于某种原因之后的代码`.Jcrop`不执行。我不是 CoffeeScript 专家，所以我需要一些帮助来解决这个问题。

这是我的代码。非常感谢！

`user.js.coffee`：

```
jQuery ->
  new AvatarCropper()

class AvatarCropper
  constructor: ->
    $('#cropbox').Jcrop() ->
      aspectRatio: 1
      setSelect: [0, 0, 500, 500]
      onSelect: @update
      onChange: @update

    update: (coords) =>
      $('#user_crop_x').val(coords.x)
      $('#user_crop_y').val(coords.y)
      $('#user_crop_w').val(coords.w)
      $('#user_crop_h').val(coords.h)
      @updatePreview(coords)

    updatePreview: (coords) =>
      $('#preview').css
        width: Math.round(100/coords.w * $('#cropbox').width()) + 'px'
        height: Math.round(100/coords.h * $('#cropbox').height()) + 'px'  
        marginLeft: '-' + Math.round(100/coords.w * coords.x) + 'px'
        marginTop: '-' + Math.round(100/coords.h * coords.y) + 'px' 
```

`users_controller.rb`：

```
 def update
      @user = User.find(params[:id])
      if @user.update_attributes(params[:user])
        if params[:user][:avatar].present?
          render :crop
        else
          redirect_to @user, notice: "Successfully updated user."
        end
      else
        render :new
      end
    end

  def crop
    @user = User.find(params[:id])
    render view: "crop"
  end 
```

`users/crop.html.erb`：

```
<h1>Crop Avatar</h1>
<%= image_tag @user.avatar_url(:pre_crop), id: "cropbox" %>

<h4>Preview</h4>
<div style="width:100px; height:100px; overflow:hidden;">
  <%= image_tag @user.avatar.url(:pre_crop), :id => "preview" %>
</div>

<%= form_for @user do |f| %>
  <div class="actions">
    <% %w[x y w h].each do |attribute| %>
      <%= f.hidden_field "crop_#{attribute}"%>
    <% end %>
    <%= f.submit "Crop" %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:58:26.353

这不是你想要的：

```
$('#cropbox').Jcrop ->
  aspectRatio: 1
  setSelect: [0, 0, 500, 500]
  onSelect: @update
  onChange: @update 
```

它以函数 ( ) 作为参数调用 Jcrop 插件，`->`而 Jcrop 不知道如何处理函数。添加括号：

```
$('#cropbox').Jcrop() ->
  aspectRatio: 1
  setSelect: [0, 0, 500, 500]
  onSelect: @update
  onChange: @update 
```

没有太大帮助；正确调用插件 ( `.Jcrop()`) 但随后尝试将其返回值作为另一个函数调用，该函数将函数作为参数：

```
$('#cropbox').Jcrop()(-> ...) 
```

这让您可以使用裁剪器，但除非 Jcrop 插件返回一个函数，否则您可能会遇到错误；无论如何，这不会让您的选项进入 Jcrop 插件，因此不会调用您的回调，并且 Jcrop 不会看到纵横比。

我认为您只想删除`->`（而不包括括号），以便使用选项对象调用 Jcrop 插件：

```
$('#cropbox').Jcrop
  aspectRatio: 1
  setSelect: [0, 0, 500, 500]
  onSelect: @update
  onChange: @update 
```

或者，如果括号可以帮助您查看分组，您也可以这样做：

```
$('#cropbox').Jcrop(
  aspectRatio: 1
  setSelect: [0, 0, 500, 500]
  onSelect: @update
  onChange: @update
) 
```

完成后，您需要仔细查看缩进，您的 AvatarCropper 没有`update`和`updatePreview`方法，因为它们缩进太远：

```
class AvatarCropper
  constructor: ->
    $('#cropbox').Jcrop
    ...
    update: (coords) =>
    ...
    updatePreview: (coords) => 
```

这最终定义了一个匿名对象`{update: ..., updatePreview: ...}`，然后它被扔掉了；如果使用更深的缩进（比如 4 个空格）或不同的编辑器，这个问题会更加明显，但我不会详细说明这一点，我只想说你必须在 CoffeeScript 中非常仔细地观察你的空格；也许更好的编译器警告将有助于解决这个非常常见的错误。修复你的缩进，你一切都很好：

演示：http: [//jsfiddle.net/ambiguous/jTvV3/](http://jsfiddle.net/ambiguous/jTvV3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-08T15:34:22.270

如果您使用的是引导程序，则必须添加

`img.jcrop {max-width: none}`

为您的 css .. 不知何故，引导程序覆盖了 img {max-width:100%}

有关更多信息，请查看[https://github.com/twbs/bootstrap/issues/1649](https://github.com/twbs/bootstrap/issues/1649)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-02T13:17:29.040

与其使用 js.coffee ，不如将代码放入 js 文件中，而我已放入 application.js 并像魅力一样工作

```
function showCoords(c) {
$('#user_crop_x').val(c.x);
$('#user_crop_y').val(c.y);
$('#user_crop_w').val(c.w);
$('#user_crop_h').val(c.h); };

   jQuery(function($) {
    $('#target').Jcrop({
        onSelect:    showCoords,
        bgColor:     'magenta',
        bgOpacity:   .4,
        setSelect:   [ 0, 0, 600, 600 ],
        aspectRatio: 1
    });
}); 
```

[如果错误仍然存​​在，请参考链接](http://deepliquid.com/content/Jcrop_Manual.html)

# android - Android中的ImageView按钮切换

> ID：10438014
> 
> 赞同：2
> 
> 时间：2012-05-03T19:23:45.897
> 
> 标签：android, button, imagebutton

当我单击它时，我正在尝试切换 ImageView 按钮。我有以下代码：

```
 ImageView button01 = (ImageView) findViewById(R.id.button01);
    button01.setOnClickListener(new OnClickListener() {
        int button01pos = 0;
        public void onClick(View v) {
            if (button01pos == 0) {
                button01.setImageResource(R.drawable.image01);
                button01pos = 1;
            } else if (button01pos == 1) {
                button01.setImageResource(R.drawable.image02);
                button01pos = 0;
            }
        }
    }); 
```

但由于某种原因 button01 在 Eclipse 中带有红色下划线，它给出了错误：

> 不能在不同方法中定义的内部类中引用非最终变量 button01

有谁知道它为什么这样做以及如何解决它？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-04T11:25:51.660

这是工作代码：

```
final ImageView button01 = (ImageView) findViewById(R.id.button01);
button01.setOnClickListener(new OnClickListener() {
    int button01pos = 0;
    public void onClick(View v) {
        if (button01pos == 0) {
            button01.setImageResource(R.drawable.image01);
            button01pos = 1;
        } else if (button01pos == 1) {
            button01.setImageResource(R.drawable.image02);
            button01pos = 0;
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-23T11:02:09.350

试试这个，它对我有用。这里复选框可见性设置为“不可见”......！此代码在按钮 OnClickListener 内...！

```
@Override
public void onClick(View v) {

    ImageView iv_icon = (ImageView) findViewById(R.id.icon);

    CheckBox cb = (CheckBox) findViewById(R.id.cb);

    if (cb.isChecked()) {
        iv_icon.setImageResource(R.drawable.image01);
        cb.setChecked(false);
    } else if (!cb.isChecked()) {
        iv_icon.setImageResource(R.drawable.image02);
        cb.setChecked(true);
    } else {
        // Nothing happens
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-06T01:12:20.443

尝试这个，

```
 int button01pos = 0;

        ImageView button01 = (ImageView) findViewById(R.id.button01);
        button01.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            if (button01pos == 0) {
                button01.setImageResource(R.drawable.image01);
                button01pos = 1;
            } else if (button01pos == 1) {
                button01.setImageResource(R.drawable.image02);
                button01pos = 0;
            }
        }
    }); 
```

# tkinter - 使用 tkinter 设置背景图像

> ID：10438016
> 
> 赞同：0
> 
> 时间：2012-05-03T19:23:50.087
> 
> 标签：tkinter

我有一个带有按钮、标签、文本框等的 gui，我想把它全部放在背景图像上（比如猫王的脸），比如桌面。我希望文本框和标签不会遮挡图像，而是文本位于图像上并且图像保持完全可见。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:29:58.580

好的，所以给出了一些警告，我已经完成了这项工作。首先，我没有费心尝试让它与 ttk 小部件一起工作，因为我还没有跟上样式的速度。其次，我知道这将适用于 Windows，并且很确定它不会在其他平台上运行。综上所述，诀窍是在图像顶部弹出一个顶层窗口（在我的代码中命名为叠加层），将其配置为透明色（这显然只能在 Windows Tk 中实现）然后将小部件放在叠加层上并设置他们的背景到你的透明颜色（我的代码中的 trans_color ）。我还捕获了根的`<Configure>`事件以保持覆盖在适当的位置。对于图像，我只需右键单击您的个人资料图像并将其保存到磁盘（将其命名为 spice.png）。

```
from Tkinter import *
#from ttk import *
from PIL import Image, ImageTk

trans_color = '#FFFFFE'

root = Tk()
img = ImageTk.PhotoImage(Image.open('spice.png'))
img_label = Label(root, image=img)
img_label.pack()
img_label.img = img  # PIL says we need to keep a ref so it doesn't get GCed
root.update()
overlay = Toplevel(root)
print 'root.geo=', root.geometry()
geo = '{}x{}+{}+{}'.format(root.winfo_width(), root.winfo_height(),
    root.winfo_rootx(), root.winfo_rooty())
print 'geo=',geo
overlay.geometry(geo)
overlay.overrideredirect(1)
overlay.wm_attributes('-transparent', trans_color)
overlay.config(background=trans_color)

lbl = Label(overlay, text='LABEL')
lbl.config(background=trans_color)
lbl.pack()

def moved(e):
    geo = '{}x{}+{}+{}'.format(root.winfo_width(), root.winfo_height(),
        root.winfo_rootx(), root.winfo_rooty())
    overlay.geometry(geo)

root.bind('<Configure>', moved)

root.mainloop() 
```

# java - Android JavaCV 困境，创建 IplImage 时方法“draw”内部抛出 NoClassDefFoundError

> ID：10438017
> 
> 赞同：5
> 
> 时间：2012-05-03T19:23:50.217
> 
> 标签：java, android, opencv, noclassdeffounderror, javacv

我正在使用 JavaCV 库和为 Android 预构建的 OpenCV 库。我想我已经以正确的方式设置了 Eclipse，因为我已经包含了 javacv.jar 和 javacpp.jar 的 jar。另外，java-cv-android-arm.jar，在我的项目中。一切都编译得很好，没有错误，警告，任何应该怀疑在运行时会出错的东西。但是我得到了下面这个方法体中抛出的 NoClassDefFOundError 异常：

```
@Override
    public void draw(Canvas canvas)
    {
    try
    {
        canvas.drawColor(Color.BLUE);
        if (current != null)
        {
        int width = current.getWidth();
        int height = current.getHeight();
        IplImage i = IplImage.create(width, height, IPL_DEPTH_8U, 1); // I assume here is where the exception gets thrown
        ByteBuffer buffer = i.getByteBuffer();
        current.copyPixelsToBuffer(buffer);
        // We need a grayscale image in order to do the recognition, so
        // we
        // create a new image of the same size as the original one.
        IplImage grayImage = IplImage.create(i.width(), i.height(),
            IPL_DEPTH_8U, 1);
        // We convert the original image to grayscale.
        cvCvtColor(i, grayImage, CV_BGR2GRAY);
        CvMemStorage storage = CvMemStorage.create();
        // We instantiate a classifier cascade to be used for detection,
        // using the cascade definition.
        CvHaarClassifierCascade cascade = new CvHaarClassifierCascade(
            cvLoad("haarcascade_frontalface_alt.xml"));
        // We detect the faces.
        CvSeq faces = cvHaarDetectObjects(grayImage, cascade, storage,
            1.1, 1, 0);
        // We iterate over the discovered faces and draw yellow
        // rectangles around them.
        for (int index = 0; index < faces.total(); index++)
        {
            CvRect r = new CvRect(cvGetSeqElem(faces, index));
            cvRectangle(i, cvPoint(r.x(), r.y()),
                cvPoint(r.x() + r.width(), r.y() + r.height()),
                opencv_core.CvScalar.YELLOW, 1, CV_AA, 0);
        }
        Bitmap b = BitmapFactory.decodeByteArray(i.getByteBuffer()
            .array(), 0, i.getByteBuffer().array().length);
        canvas.drawBitmap(b, x, y, paint);
        canvas.drawText(new Date().toLocaleString(), canvas.getWidth() - 100,
            canvas.getHeight() - 50, paint);
        paint.setColor(Color.GREEN);
        }
    } catch (Exception e)
    {
        canvas.drawColor(Color.RED);

        canvas.drawText(
            "Handled exception occurred in panel:\n" + e.getMessage(),
            250, 250, paint);
        paint.setColor(Color.GREEN);
    }
    super.draw(canvas);
    } 
```

当然，在抛出异常之后，我的 Android 崩溃了，我强制关闭了应用程序。我是否正确包含了罐子和所需的库？有什么我应该注意的吗？任何帮助将不胜感激。

这是为喜欢猫的人准备的 LogCat（*在此处插入表情符号*）：

```
05-03 19:07:53.217: E/AndroidRuntime(741): FATAL EXCEPTION: main
05-03 19:07:53.217: E/AndroidRuntime(741): java.lang.NoClassDefFoundError: com.googlecode.javacv.cpp.opencv_core$IplImage
05-03 19:07:53.217: E/AndroidRuntime(741):  at home.security.DrawingPanel.draw(DrawingPanel.java:81)
05-03 19:07:53.217: E/AndroidRuntime(741):  at home.security.Main$2.run(Main.java:105)
05-03 19:07:53.217: E/AndroidRuntime(741):  at android.os.Handler.handleCallback(Handler.java:587)
05-03 19:07:53.217: E/AndroidRuntime(741):  at android.os.Handler.dispatchMessage(Handler.java:92)
05-03 19:07:53.217: E/AndroidRuntime(741):  at android.os.Looper.loop(Looper.java:123)
05-03 19:07:53.217: E/AndroidRuntime(741):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-03 19:07:53.217: E/AndroidRuntime(741):  at java.lang.reflect.Method.invokeNative(Native Method)
05-03 19:07:53.217: E/AndroidRuntime(741):  at java.lang.reflect.Method.invoke(Method.java:507)
05-03 19:07:53.217: E/AndroidRuntime(741):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-03 19:07:53.217: E/AndroidRuntime(741):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-03 19:07:53.217: E/AndroidRuntime(741):  at dalvik.system.NativeStart.main(Native Method) 
```

**'libs 文件夹的文件夹结构**

![在此处输入图像描述](../Images/3096eb30f5e95451bf0bcade1f59c49b.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:20:26.540

jars 需要位于**project-root/libs**文件夹中，或者在项目的构建路径中将它们标记为导出...

现在它应该工作......

# python - Django - 第一个项目 - runserver 是无效的语法

> ID：10438018
> 
> 赞同：0
> 
> 时间：2012-05-03T19:23:57.407
> 
> 标签：python, django

我决定尝试用 django 在 python 上开发，而 python 对我来说是新的。

[我使用的是 Windows 7 64 位]

然后，我安装了 python 2.7，添加了 C:\Python27\;C:\Python27\Scripts; 到 PATH 变量。接下来，我安装了 Eclipse Classic（最新版本）并安装了 PyDev 和 Django。

我在 Eclipse 上创建了我的第一个项目作为 Django 项目，但无法运行它。我正在尝试（右键单击我的项目）-> 运行方式-> PyDev：Django，并且我有以下控制台日志：

```
Validating models...

Traceback (most recent call last):   File "C:\Users\Matan\workspace\FirstSample\manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)   File "C:\Python27\Lib\site-packages\django\core\management\__init__.py", line 443, in execute_from_command_line
    utility.execute()   File "C:\Python27\Lib\site-packages\django\core\management\__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)   File "C:\Python27\Lib\site-packages\django\core\management\base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)   File "C:\Python27\Lib\site-packages\django\core\management\base.py", line 232, in execute
    output = self.handle(*args, **options)   File "C:\Python27\Lib\site-packages\django\core\management\commands\runserver.py", line 69, in handle
    self.run(*args, **options)   File "C:\Python27\Lib\site-packages\django\core\management\commands\runserver.py", line 80, in run 
```

而这样的例子不胜枚举...

所以我尝试使用 python 控制台运行该项目，使用：

```
import Django

manage.py runserver 
```

我有以下语法错误：

```
File "<stdin>", line 1
  manage.py runserver
                    ^ SyntaxError: invalid syntax 
```

运行我的项目有什么问题？我该如何解决这个问题？

谢谢。

编辑：尝试使用以下命令运行项目后：

```
python manage.py runserver on the project directory, i receive the following traceback log: Validating models...

Unhandled exception in thread started by <bound method Command.inner_run of <dja ngo.contrib.staticfiles.management.commands.runserver.Command object at 0x000000 0002688748>> Traceback (most recent call last):   File "C:\Python27\lib\site-packages\django\core\management\commands\runserver. py", line 91, in inner_run
    self.validate(display_num_errors=True)   File "C:\Python27\lib\site-packages\django\core\management\base.py", line 266,  in validate
    num_errors = get_validation_errors(s, app)   File "C:\Python27\lib\site-packages\django\core\management\validation.py", lin e 23, in get_validation_errors
    from django.db import models, connection   File "C:\Python27\lib\site-packages\django\db\__init__.py", line 40, in <modul e>
    backend = load_backend(connection.settings_dict['ENGINE'])   File "C:\Python27\lib\site-packages\django\db\__init__.py", line 34, in
__geta ttr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)   File "C:\Python27\lib\site-packages\django\db\utils.py", line 92, in
__getitem
__
    backend = load_backend(db['ENGINE'])   File "C:\Python27\lib\site-packages\django\db\utils.py", line 24, in load_back end
    return import_module('.base', backend_name)   File "C:\Python27\lib\site-packages\django\utils\importlib.py", line 35, in im port_module
    __import__(name)   File "C:\Python27\lib\site-packages\django\db\backends\mysql\base.py", line 16 , in <module>
    raise ImproperlyConfigured("Error loading MySQLdb module: %s" % e) django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No mo dule named MySQLdb 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T00:17:10.730

下载适用于 Windows 的预编译[python-mysql 包](http://www.lfd.uci.edu/~gohlke/pythonlibs/#mysql-python)，安装它，然后再次运行该命令。

当你在那里时，如果你还没有安装[setuptools ，你也可以安装。](http://www.lfd.uci.edu/~gohlke/pythonlibs/#setuptools)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:38:41.687

您必须在项目目录中才能运行 python manage.py runserver 命令。您还需要 (1) 设置 PYTHONPATH 环境变量以包含您的项目目录的*父*目录和 (2) 将 DJANGO_SETTINGS_MODULE 环境变量设置为*yourproject.settings*

如果你做对了，你应该能够去一个不相关的目录（即不是你的项目目录）并在 python shell 中执行以下导入：

```
c:\temp> python
...
>>> from django.conf import settings 
```

导入的设置模块应该是您项目目录中的那个...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:47:12.417

> 加载 MySQLdb 模块时出错：没有名为 MySQLdb 的模块

您已经为 MySQL 配置了设置，但尚未安装`MySQL-python`：

```
pip install MySQL-python 
```

# blackberry - 使工具栏像 iPhone 一样的黑莓 UI 指南

> ID：10438020
> 
> 赞同：1
> 
> 时间：2012-05-03T19:24:09.950
> 
> 标签：blackberry, custom-controls, usability

我想在黑莓中制作一个现有的 iPhone 应用程序。现在我正处于模型设计的可行性研究阶段。我正在寻找为黑莓实现 iPhone 工具栏（如下图所示）的功能。我并不是真的想实现相同的，它可以根据黑莓 UI 指南进行更改。

![在此处输入图像描述](../Images/d99af219a0bb0a0336c3466a62a47c1b.png)

在进行一轮谷歌搜索后，我遇到了下面列出的几件事

1.  使用菜单项和放置图标
2.  创建与 iPhone 相同的 ToolBar，但 API 仍可从 BB SDK 6.0 开始使用。我热衷于在 BB SDK 5.0 中实现。我们可以定制相同的，但我相信这将是一个巨大的努力。

一些参考链接

[BlackBerry - 自定义菜单工具栏](https://stackoverflow.com/questions/2656169/blackberry-custom-menu-toolbar)

[如何在黑莓中创建类似 iphone 的标签布局](https://stackoverflow.com/questions/4621805/how-to-create-iphone-like-tabs-layout-in-blackberry)

[http://docs.blackberry.com/en/developers/deliverables/17965/Toolbars_6_0_1137042_11.jsp](http://docs.blackberry.com/en/developers/deliverables/17965/Toolbars_6_0_1137042_11.jsp)

请在不违反黑莓可用性指南的情况下提出任何其他最佳实施方式，并且可能最适合我的要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T06:43:41.443

您可以使用[高级 UI 组件](http://supportforums.blackberry.com/t5/Java-Development/Implement-advanced-buttons-fields-and-managers/ta-p/488276)，我们在项目中使用它们，它们通常可以解决问题。

该代码是开源的，如果需要，您可以对其进行扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T04:42:38.257

尝试这个 -

```
import net.rim.device.api.system.Bitmap;
import net.rim.device.api.ui.Field;
import net.rim.device.api.ui.FocusChangeListener;
import net.rim.device.api.ui.Graphics;
import net.rim.device.api.ui.Manager;
import net.rim.device.api.ui.UiApplication;
import net.rim.device.api.ui.component.BasicEditField;
import net.rim.device.api.ui.component.BitmapField;
import net.rim.device.api.ui.component.ButtonField;
import net.rim.device.api.ui.component.LabelField;
import net.rim.device.api.ui.component.SeparatorField;
import net.rim.device.api.ui.container.HorizontalFieldManager;
import net.rim.device.api.ui.container.MainScreen;
import net.rim.device.api.ui.container.VerticalFieldManager;

public class tabbar extends UiApplication {

public tabbar() {
    TabControlScreen screen = new TabControlScreen();
    pushScreen(screen);
}

/**
 * @param args
 */
public static void main(String[] args) {
    tabbar app = new tabbar();
    app.enterEventDispatcher();
}

private class TabControlScreen extends MainScreen implements FocusChangeListener {

    private VerticalFieldManager tabArea;

    private LabelField tab1Heading;
    private LabelField tab2Heading;
    private LabelField tab3Heading;
    private LabelField tab4Heading;

    private VerticalFieldManager tab1Manager;
    private VerticalFieldManager tab2Manager;
    private VerticalFieldManager tab3Manager;
    private VerticalFieldManager tab4Manager;
    BitmapField bit,bit1,bit2,bit3;

    public TabControlScreen() {

        HorizontalFieldManager hManager = new HorizontalFieldManager(FIELD_HCENTER);

        final Bitmap header_logo = Bitmap.getBitmapResource("1.png");
        bit=new BitmapField(header_logo,BitmapField.FOCUSABLE |BitmapField.HIGHLIGHT_FOCUS);

        final Bitmap header_logo1 = Bitmap.getBitmapResource("3.png");
        bit1=new BitmapField(header_logo1,BitmapField.FOCUSABLE |BitmapField.HIGHLIGHT_FOCUS);

        final Bitmap header_logo2 = Bitmap.getBitmapResource("2.png");
        bit2=new BitmapField(header_logo2,BitmapField.FOCUSABLE |BitmapField.HIGHLIGHT_FOCUS);

        final Bitmap header_logo3 = Bitmap.getBitmapResource("4.png");
        bit3=new BitmapField(header_logo3,BitmapField.FOCUSABLE |BitmapField.HIGHLIGHT_FOCUS);

        bit.setFocusListener(this);
        bit1.setFocusListener(this);
        bit2.setFocusListener(this);
        bit3.setFocusListener(this);

        hManager.add(bit);
        hManager.add(bit1);
        hManager.add(bit2);
        hManager.add(bit3);

        add(hManager);

        tab1Manager = new VerticalFieldManager();
        tab2Manager = new VerticalFieldManager();
        tab3Manager = new VerticalFieldManager();
        tab4Manager = new VerticalFieldManager();

        tabArea = displayTab1();
        add(tabArea);

    }

    public void focusChanged(Field field, int eventType) {
        if (tabArea != null) {
            if (eventType == FOCUS_GAINED) {
                if (field == bit) {

                    delete(tabArea);
                    tabArea = displayTab1();
                    add(tabArea);
                } else if (field == bit1) {

                    delete(tabArea);
                    tabArea = displayTab2();
                    add(tabArea);
                } else if (field == bit2) {

                    delete(tabArea);
                    tabArea = displayTab3();
                    add(tabArea);
                }
                else if (field == bit3) {

                    delete(tabArea);
                    tabArea = displayTab4();
                    add(tabArea);
                }
            }
        }

    }

    public VerticalFieldManager displayTab1() {
        if (tab1Heading == null) {
            tab1Heading = new LabelField("1");

            ButtonField settings=new ButtonField("Settings",ButtonField.FIELD_LEFT);
            //ButtonField add=new ButtonField("Add",ButtonField.FIELD_RIGHT);

            //JustifiedHorizontalFieldManager JustifiedHorizontalFieldManager=new JustifiedHorizontalFieldManager(settings,add,true);

            tab1Manager.add(settings);
        }

        return tab1Manager;
    }

    public VerticalFieldManager displayTab2() {
        if (tab2Heading == null) {
            tab2Heading = new LabelField("2");
            tab2Manager.add(tab2Heading);
        }

        return tab2Manager;
    }

    public VerticalFieldManager displayTab3() {
        if (tab3Heading == null) {
            tab3Heading = new LabelField("3");
            tab3Manager.add(tab3Heading);
        }

        return tab3Manager;
    }
    public VerticalFieldManager displayTab4() {
        if (tab4Heading == null) {
            tab4Heading = new LabelField("4");
            tab4Manager.add(tab4Heading);
        }

        return tab4Manager;
    }
}

} 
```

# mysql - 在 Mac 上运行 MySQL 必须导出 DYLD_LIBRARY_PATH

> ID：10438031
> 
> 赞同：0
> 
> 时间：2012-05-03T19:24:53.787
> 
> 标签：mysql, macos, terminal

要在我的 mac 上运行 mysql，我总是必须在终端上发送这个命令：

```
export DYLD_LIBRARY_PATH=/usr/local/mysql/lib/ 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T09:04:06.577

将其插入您的 ~/.profile 或 ~/.bash_profile

# php - 试图显示成员列表

> ID：10438033
> 
> 赞同：0
> 
> 时间：2012-05-03T19:25:00.023
> 
> 标签：php, mysql, html, sql, database

出于某种原因，我试图在列表中显示数据库中的所有成员，以便在单击它们时访问他们的每个配置文件，但我只获取数据库中最后一个人的链接，任何帮助？

```
include_once "../../mysql_server/connect_to_mysql.php";

//This code is used to display friends in the box of friends
$sql = mysql_query("SELECT * FROM myMembers");
$numberofRows = mysql_num_rows($sql);

$memberDisplayList = 'There are ' . $numberofRows .' members<br /><br />';

while($row = mysql_fetch_array($sql)) {

    $id = $row['id']; 
    $firstname = $row["firstname"];
    $lastname = $row["lastname"];

    ///////  Mechanism to Display Pic. See if they have uploaded a pic or not 
    $check_pic = "../../members/$id/image01.jpg";
    $default_pic = "../../members/0/image01.jpg";
    if (file_exists($check_pic)) {
        $user_pic = "<img src=\"$check_pic?$cacheBuster\" width=\"80px\" />"; 
    } else {
        $user_pic = "<img src=\"$default_pic\" width=\"80px\" />"; 
    }

    $memberDisplayList = '<a href="http://www.pathtosite.com/friends_page.php?id='. $id .'">' . $firstname .' '. $lastname .'</a><br />';   
}
// ------- END WHILE LOOP FOR GETTING THE MEMBER DATA --------- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:31:46.047

我认为而不是

```
$memberDisplayList = '<a href= (...etc) 
```

你打算输入

```
$memberDisplayList .= '<a href= (...etc) 
```

这会将新链接附加到您的字符串。

此外，您似乎没有在任何地方呼应您的`$user_pic`和`$memberDisplayList`字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:32:55.217

这是因为您在每次迭代时覆盖了变量，您需要将数据保存在数组中，然后在输出时执行另一个 foreach 循环：

```
<?php 
while($row = mysql_fetch_array($sql)){
    ///////  Mechanism to Display Pic. See if they have uploaded a pic or not  //////////////////////////
    $check_pic = "../../members/{$row['id']}/image01.jpg";
    $default_pic = "../../members/0/image01.jpg";
    if (file_exists($check_pic)) {
        $user_pic = "<img src=\"$check_pic?$cacheBuster\" width=\"80px\" />";
    } else {
        $user_pic = "<img src=\"$default_pic\" width=\"80px\" />";
    }

    $user[] = array('id'=>$row['id'],
                    'firstname'=>$row["firstname"],
                    'lasname'=>$row["lastname"],
                    'user_pic'=>$user_pic,
                    'display_list'=>'<a href="http://www.pathtosite.com/friends_page.php?id='. $row['id'].'">' . $row["firstname"] .' '. $row["lastname"] .'</a><br />');
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:32:03.407

您实际上在哪里构建 HTML？您在提供的代码中设置了一堆变量，这看起来不错。所以它可能在表示逻辑中。如果这在循环中，那么你的状态很好。但是如果它在循环之外，那么我无法想象除了最后一行之外你会在哪里显示任何东西。

# php - 如何使用 php + css 更改活动菜单的样式

> ID：10438034
> 
> 赞同：0
> 
> 时间：2012-05-03T19:25:01.533
> 
> 标签：php, css

所以，我正在写一个菜单，我希望它在该页面上保持某种颜色。我已经在页面上添加了“class = 'active'”，并尝试将它添加到 CSS，但它不起作用。有任何想法吗？

PHP代码：

```
<?php
$currentPage = basename($_SERVER['REQUEST_URI']);
print "<div id = 'submenu-container'>";
print "<div id = 'submenu'>";
print "<ul class = 'about'>";
print "     <li><a  href='about.php#about_intro.php'if($currentPage=='about.php#about_intro.php' || $currentPage=='about.php') echo 'class='active''>About</a></li>";
print "     <li><a href='about.php#about_team.php'if($currentPage=='about.php#about_team.php') echo 'class='active''>Team</a></li>";
print "     <li><a href='about.php#about_services.php' if($currentPage=='about.php#about_services.php') echo 'class='active'>Services</a></li>";            
print " </ul>";
print "</div>";
print"</div>";
?> 
```

CSS：

```
#submenu ul li a .active {
background:#FFF;    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:29:14.380

`$_SERVER['REQUEST_URI']`永远不会包含哈希后的部分。它只会显示到`about.php`和任何通过`?`. 您应该为每个页面创建特定页面，在查询字符串中而不是哈希中提供 about_intro/about_team/about_services，或者使用 javascript 添加活动类。

此外，不要在另一个语句中使用 if 语句。使用三元运算符。

```
print "<li><a href='about.php'"
    .$currentpage=="about.php"?" class='active'":""
    .">About</a></li>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:31:57.420

```
print "     <li><a  href='about.php#about_intro.php'if($currentPage=='about.php#about_intro.php' || $currentPage=='about.php') echo 'class='active''>About</a></li>"; 
```

没有意义。所有这些字符串都将输出并显示在 html 中。您必须使用字符串连接：

```
$cl = ($currentPage=='about.php#about_intro.php' || $currentPage=='about.php')?" class='active'": "";
print "<li><a  href='about.php#about_intro.php' $cl>About</a></li>"; 
```

# memory-management - LLVM 分配的空闲内存

> ID：10438037
> 
> 赞同：4
> 
> 时间：2012-05-03T19:25:14.383
> 
> 标签：memory-management, llvm

我正在努力寻找如何释放 LLVM 函数分配的内存。例如，当我调用该函数`Function::Create()`来创建 LLVM 函数时，如何释放分配给它的内存？这实际上适用于许多 LLVM 函数，如`IRBuilder::CreateAlloca()`,`IRBuilder::CreateStore()`等。知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T07:09:52.557

首先，当删除*任何*一种s 时[`Value`](http://llvm.org/docs/doxygen/html/classllvm_1_1Value.html)，请确保它不再有任何[`User`](http://llvm.org/docs/doxygen/html/classllvm_1_1User.html)s。显然，删除使用的值会导致错误（以断言的形式）。这可以很容易地通过调用来测试[`getNumUses()`](http://llvm.org/docs/doxygen/html/classllvm_1_1Value.html#a380559e99b47632a34f74de7c1d03cc0)，或者更好（阅读：更快） [`hasNUses(0)`](http://llvm.org/docs/doxygen/html/classllvm_1_1Value.html#ad58ff1cf33943e54cc5bed1aba593928)。

当你确定你的值不再被使用时，不同类型的值有时需要不同的方式来删除它们。对于您的两种情况：

*   [`Function`](http://llvm.org/docs/doxygen/html/classllvm_1_1Function.html)s 可以通过调用简单地删除[`operator delete`](http://llvm.org/docs/doxygen/html/classllvm_1_1Function.html#a3b03f7cf0b75d16edebdda1dee1db6fd)。这可以确保从[`Module`](http://llvm.org/docs/doxygen/html/classllvm_1_1Module.html).
*   [`Instruction`](http://llvm.org/docs/doxygen/html/classllvm_1_1Instruction.html)s 应该通过调用来删除[`eraseFromParent()`](http://llvm.org/docs/doxygen/html/classllvm_1_1Instruction.html#a6fe2f06b8a4b2c3d6308afb223a0238a)。或者，等效地，首先调用[`removeFromParent()`](http://llvm.org/docs/doxygen/html/classllvm_1_1Instruction.html#a0fd53f63d349dc8a7c5fc0cdd7a94c8d)然后手动删除它。

# cocos2d-iphone - 谁最先得到更新，父母还是孩子？(cocos2d)

> ID：10438038
> 
> 赞同：0
> 
> 时间：2012-05-03T19:25:22.043
> 
> 标签：cocos2d-iphone

假设我有一个带有 N 个子节点的父节点。他们都在每一帧都安排了更新。首先调用谁`update:`的选择器，子节点还是父节点？有固定的顺序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:33:39.630

`visit`方法中的`CCNode`代码如下：

```
if(children_) {
    ccArray *arrayData = children_->data;
    NSUInteger i = 0;

    // draw children zOrder < 0
    for( ; i < arrayData->num; i++ ) {
        CCNode *child = arrayData->arr[i];
        if ( [child zOrder] < 0 )
            [child visit];
        else
            break;
    }

    // self draw
    [self draw];

    // draw children zOrder >= 0
    for( ; i < arrayData->num; i++ ) {
        CCNode *child =  arrayData->arr[i];
        [child visit];
    } 
```

因此，如您所见，首先是访问`zOrder`小于零的子节点，然后绘制当前节点（子节点的父节点），然后还访问其余的子节点（请注意，访问一个节点最终会绘制它，根据刚刚解释的标准）。

# java - 使用反射调用 java/groovy 对象的静态方法

> ID：10438039
> 
> 赞同：3
> 
> 时间：2012-05-03T19:25:29.957
> 
> 标签：java, reflection, groovy

我正在研究一个 groovy 单元测试类，其中包含一组规则，用于确定文件内容是否正确格式化。（不使用适当的规则引擎，它只是利用 Groovy 的断言功能以一种类似于规则引擎的方式进行验证。）我在想我可以创建一个名为 FireAllRules 的方法，如下所示：

```
public static void FireAllRules(File file)
{
    for(def method in Class.getMethods)
    {
        if(method.name.indexOf("rule" == 0) method.invoke(file);
    }
} 
```

我希望循环选择的所有方法都是静态的，并且我注意到在调试过程中我的规则方法都没有包含在 Class.getMethods() 枚举中。理想情况下，我只想循环遍历我个人编写到类中的方法，而不是对随 java.Object 一起出现的几十个无趣的方法进行排序。有没有办法在运行时使用反射来迭代这些静态方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T19:44:13.073

鉴于：

```
class Test {
  public static testThis() {
    println "Called testThis"
  }

  public static woo() {
    println "Called woo"
  }

  public static testOther() {
    println "Called testOther"
  }
} 
```

你可以做：

```
Test.metaClass.methods.grep { it.static && it.name.startsWith( 'test' ) }.each {
  it.invoke( Test )
} 
```

打印：

```
Called testOther
Called testThis 
```

执行类的静态测试方法的更通用的方法是：

```
def invokeClass( clazz ) {
  clazz.metaClass.methods.grep { it.static && it.name.startsWith( 'test' ) }.each {
    it.invoke( clazz )
  }
}

invokeClass( Test ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T19:40:49.970

静态方法包含在`getMethods()`. 你的问题可能是`method.name.indexOf("rule" == 0)`. 这应该是`method.name.indexOf("rule") == 0`，或者更好了`method.name.startsWith("rule")`。

另外，您的规则方法是否公开？如果没有，您可以使用`getDeclaredMethods()`. 要调用它们，您必须先调用`setAccessible()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T00:47:49.653

java 版本是这样的（为了清楚起见，我删除了导入和异常）。

```
public class FindAndRunStaticMethods {
    public static void main(String[] args) {
        fireAllRules();
    }

    public static void fireAllRules() {
        for(Method method : StaticMethodClass.class.getDeclaredMethods()) {
            findAndRunRules(method);
        }
    }

    private static void findAndRunRules(Method method) {
        if (!Modifier.isStatic(method.getModifiers())) return;
        if (!method.getName().startsWith("rule")) return;
        if (!method.getReturnType().equals(Void.TYPE)) return;

        Class[] parameterTypes = method.getParameterTypes();

        if (parameterTypes.length != 1) return;
        if (!parameterTypes[0].equals(File.class)) return;

        method.invoke(null, new File("dummy"));
    }
} 
```

示例测试类可能如下所示

```
public class StaticMethodClass {
    public static void ruleHere(File x) { System.out.println("should print"); }
    public static void ruleRun(File x) { System.out.println("should print"); }  
    public void ruleNotSelected() { System.out.println("not run"); }
} 
```

# objective-c - 如何减少这些 if 条件的嵌套？

> ID：10438047
> 
> 赞同：2
> 
> 时间：2012-05-03T19:26:16.960
> 
> 标签：objective-c, logic, conditional

我有一个小问题：D 我找不到合适的词来搜索，所以我写了这个问题。我怎么变短？我知道这个逻辑|| 但是我怎么能在一行中添加超过 1 个呢？谢谢你的时间最好的问候约翰

```
 bool b = [self NSStringContains:convert contains:@"Input"];
    if (b ==true)
    {
           bool b = [self NSStringContains:convert contains:@"Output"]; 
           if (b ==true)
           {
                     bool b = [self NSStringContains:convert contains:@"statecheck"]; 
                     if (b ==true)
                     {
                     ....
                     }
           }
     } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T19:29:44.620

在这种情况下，您似乎需要`&&`：

```
if ([self NSStringContains:convert contains:@"Input"] &&
    [self NSStringContains:convert contains:@"Output"] &&
    [self NSStringContains:convert contains:@"statecheck"])
{
   ...
} 
```

因为它的价值，给定`bool b;`，`if (b==true)`总是多余的——只需使用`if (b)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:29:33.737

大概是这样的：

```
bool hasInput = [self NSStringContains:convert contains:@"Input"];
bool hasOutput = [self NSStringContains:convert contains:@"Output"];
bool hasStatecheck = [self NSStringContains:convert contains:@"statecheck"];
if (hasInput && hasOutput && hasStatecheck)
{
} 
```

您使用的是“如果此条件，则检查此条件和此条件”等。您可以将这些与逻辑 AND 放在一起，用`&&`.

# javascript - Javascript Canvas 渲染错误

> ID：10438048
> 
> 赞同：1
> 
> 时间：2012-05-03T19:26:21.637
> 
> 标签：javascript, html, internet-explorer, canvas, render

我只是对 Javascript 和 HTML5 画布进行了一些实验，当我在浏览器（chrome）中看到它时，我意识到它的渲染效果不是很好。在那之后，我在 Internet Explorer 中看到了它，它看起来更加难看。我做了一个小例子： http: [//ios.xomz.de/](http://ios.xomz.de/) 我只是在html代码中声明了canvas对象

`<canvas id="mycanvas" width="1000px" height="600px"/>`

并用

```
var canvas = document.getElementById("mycanvas");
var context = canvas.getContext("2d");
context.beginPath();
context.rect(200, 200, 600, 200);
context.lineWidth = 5;
context.strokeStyle = 'black';
context.stroke();
context.font = "40pt arial";
context.fillStyle = "black";
context.fillText("Hello World!", 220, 380); 
```

例如。

你能解释为什么渲染不好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:01:34.613

不要使用“px”，我也建议不要使用自闭合标签：

`<canvas id="mycanvas" width="1000" height="600"></canvas>`

[http://jsfiddle.net/c2KeD/](http://jsfiddle.net/c2KeD/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:05:11.760

这个问题与在基于浮点的网格上绘制对象的方式有关（尤其是垂直和水平线，因此是矩形）。

见那里的解释和模式：[http ://canop.org/blog/?p=220](http://canop.org/blog/?p=220)

根据对象的大小，您需要为形状使用整数或中间整数坐标和大小，目标是在两个维度上填充完整的像素。

例如 ：

*   使用中间整数表示细线（一个像素宽度）
*   对 2 像素宽的线使用整数坐标

（并扩展矩形的逻辑）

在您的情况下，线宽为 5，您可以使用以下方式获得更清晰的矩形：

```
context.rect(200.5, 200.5, 600, 200); 
```

在这里演示：http: [//jsfiddle.net/dystroy/TyNBB/](http://jsfiddle.net/dystroy/TyNBB/)

# ruby - 代码块中的 Markdown 换行符

> ID：10438050
> 
> 赞同：9
> 
> 时间：2012-05-03T19:26:38.400
> 
> 标签：ruby, haml, markdown, redcarpet

使用 Redcarpet，当我在降价中包含以下内容时，它不尊重任何换行符或缩进。我在行尾尝试了两个空格。代码之间的额外行。似乎没有任何效果。

```
```xml
<?xml version="1.0" encoding="UTF-8"?>
<hash>
   <money>3</money>
</hash>

``` 
```

我懂了：

```
<?xml version="1.0" encoding="UTF-8"?> <hash> <money>3</money> </hash> 
```

以下是红地毯设置：

```
Redcarpet::Markdown.new(Redcarpet::Render::HTML, :autolink => true, :space_after_headers => true, :fenced_code_blocks => true, :no_intra_emphasis => true, :lax_html_blocks => true) 
```

我需要做什么才能使行正确中断并保留缩进，就像这里或 GitHub 上的一样？

**更新**- 源代码如下：

```
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
                &lt;hash&gt;
                &lt;money&gt;3&lt;/money&gt;
                &lt;/hash&gt;  
                </code></pre> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T18:59:13.083

### 尝试将降价结果包装在`find_and_preserve`Haml 帮助器中

```
# Assuming a setup like this:
markdown = Redcarpet::Markdown.new(Redcarpet::Render::HTML)
code_snippet = "    <xml>\n      <tag/>\n    </xml>"

# This should prevent undesirable spaces within code blocks:
find_and_preserve(markdown.render(code_snippet)).html_safe 
```

当您使用`find_and_preserve`Haml 帮助程序包装渲染调用时，markdown 输出中标记内的所有换行符`<pre>`都将使用等效的 HTML 实体进行转义，然后 Haml 自动缩进将忽略它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T20:28:05.500

`<pre>`解析的结果在我的块内有换行符：

```
require 'redcarpet'
md = Redcarpet::Markdown.new(Redcarpet::Render::HTML, fenced_code_blocks:true)

puts md.render("```xml\n<foo>\n</foo>\n```")
#=> <pre><code class="xml">&lt;foo&gt;
#=> &lt;/foo&gt;
#=> </code></pre> 
```

1.  确认您在输出 HTML 中看到了类似的包装器
2.  `<pre>`将您的 CSS 设置为在块中使用预格式化：

    ```
    pre { white-space:pre } 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-13T16:05:53.860

在 Github 上，我需要做的就是用`<pre>`和`</pre>`标签包装我的缩进/格式化文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T19:58:45.407

试试这个脚本来隔离它是在你的应用程序中还是在红地毯上。

我无法重现您遇到的问题（使用 redcarpet-2.1.1 gem）。把它放到一个文件中，然后运行它（`ruby redcarpet_test.rb`）：

```
require 'rubygems'
require 'redcarpet'

md = %Q{...
```xml
<?xml version="1.0" encoding="UTF-8"?>
<hash>
   <money>3</money>
</hash>
```
...}

r = Redcarpet::Markdown.new(Redcarpet::Render::HTML, :autolink => true, :space_after_headers => true, :fenced_code_blocks => true, :no_intra_emphasis => true, :lax_html_blocks => true)

puts r.render md 
```

结果适当：

```
<p>...
<code>xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;hash&gt;
   &lt;money&gt;3&lt;/money&gt;
&lt;/hash&gt;
</code>
...</p> 
```

# ios - ios - 检查文件是否已加载

> ID：10438052
> 
> 赞同：0
> 
> 时间：2012-05-03T19:27:05.000
> 
> 标签：ios, xcode, callback, loading

有没有办法检查 iphone/ipad 上主包或文档目录中的文件是否已成功加载。我想要一个回调只在加载时做一些额外的事情，否则它们不会执行，因为它们在文件之前。

谢谢，阿什利

编辑：为避免混淆，我实际上需要在文件加载后立即运行另一种方法或设置一些属性。这有完成块吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-03T19:35:24.970

```
NSFileManager *manager = [[NSFileManager alloc]init];

NSString *filePath = [NSBundle mainBundle] pathForResource:@"Your File Name" ofType:@"YOur FIleTYPE"];

if([ manager fileExistsatPath: filePath])
{
NSLog(@"exist and loaded");
}
[manager release]; 
```

这是我认为可行的一种方式..上面的代码可能有一些错误..我推荐 Xcode 的自动完成功能

# c# - C# 自动从 db 更新数据

> ID：10438054
> 
> 赞同：1
> 
> 时间：2012-05-03T19:27:09.227
> 
> 标签：c#, sql

我正在构建两个在同一个数据库上工作的应用程序。我的问题是我想创建一个自动更新。

细节 ：

我有一个农场，在主要表格上我显示了一些数据（例如药物清单）。我有另一个应用程序允许我添加/编辑/删除药物。

我希望第一个应用程序不时更新（1-2 秒）。

我尝试在主应用程序中创建另一个线程并以 2 秒的睡眠时间调用它，但它冻结了应用程序，我不希望这样。我希望应用程序（两者）都能正常运行并以某种方式进行后台更新。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:29:24.807

[BackgroundWorker](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)将允许您执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:34:00.197

如果您使用 的实例`System.Threading.Timer`每 X 秒更新一次显示，则可以依靠 tick 回调在后台线程上。这将防止显示冻结。

请记住，您只能访问更新它们的线程上的控件。如果需要访问工作线程上的控件，可以使用 InvokeRequired/Invoke 模式（在 WinForms 中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:52:14.223

看看[Async CTP](http://msdn.microsoft.com/en-us/vstudio/gg316360)。它将帮助您在后台做一些事情并稍后更新您的视图（表单）。

# xpath - 如何使用 xpath 和 selenium ide 单击链接

> ID：10438058
> 
> 赞同：0
> 
> 时间：2012-05-03T19:27:21.967
> 
> 标签：xpath, selenium

我是 xpath 和 selenium 的新手，我需要能够根据天气单击带有 selenium 的链接，或者不是某个文本的跨度。示例代码是：

```
 <div>
    <span>Fri</span>
    <ul>
    <li>
    <a href=#></a>
    </li>
    </ul>
    </div>
<div>
    <span>Sat</span>
    <ul>
    <li>
    <a href=#></a>
    </li>
    </ul>
    </div> 
```

我的 xpath`//*[text()[contains(.,'Fri')]]`可以找到正确的跨度，现在我想我可以使用`//*[text()[contains(.,'Fri')]]../ul/li/a`，但这不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T19:48:38.370

Selenium IDE 命令将是：

```
command: click
target : //span[contains(text(),'Fri')]/following::a 
```

从[这里](http://msdn.microsoft.com/en-us/library/ms256456.aspx)：

> following:: 树中上下文节点之后的所有节点，不包括任何后代、属性节点和命名空间节点。

请注意，您可能不会`[1]`在 xpath 表达式的末尾写入以从所有出现中选择第一个节点，因为 selenium IDE 默认会这样做。

当您使用 IDE 时，您还可以使用更易于阅读的 css 选择器：

```
command: click
target : css=span:contains('Fri')+ul a 
```

至于您最初的 xpath，您之前错过了一个斜杠`../`：

```
//*[text()[contains(.,'Fri')]]/../ul/li/a 
```

# c++ - 指向对象的指针作为构造函数的参数

> ID：10438060
> 
> 赞同：0
> 
> 时间：2012-05-03T19:27:24.633
> 
> 标签：c++, pointers, constructor

好的，假设我有一些随机的抽象基类`Base`，并且我有一个`Foo`包含指向该基类的指针作为数据成员的类。所以

```
class Foo
{
    public:
        Foo(Base*);

    private:
        Base* ptr;
} 
```

现在我使用指向基类的指针的原因是因为我希望能够选择我的`Foo`对象具有指向哪个派生类。现在，对我来说，棘手的部分是`Foo`.

如果我这样做

```
Foo::Foo(Base* _ptr)
{
    Foo::ptr = _ptr;
}; 
```

用户可以调整指向的对象，`Foo::ptr`因为`_ptr`在构造函数完成后仍然存在。我无法使`_ptr`常量指向的对象，因为`Foo::ptr`需要定期更新自身。现在我正在考虑`_ptr = NULL`在构造函数的末尾添加一行，但这也可能很危险，因为用户可以尝试取消引用`_ptr`.

我能想到的唯一方法是复制所指向的对象`_ptr`并初始化`Foo::ptr`该副本的地址。但是然后指向的对象`_ptr`需要有一个成员函数`Clone()`或类似的东西，因为我不能为一个我在编译时不知道类的对象调用复制构造函数。

那么如果没有的话，有什么优雅的方法可以做到这一点`Clone()`吗？或者这真的是唯一的可能性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:33:32.940

另一种方法是使用智能指针。这样，所有权被分配给智能指针实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:33:44.410

从 a 构造`unique_ptr`。这样，您的用户在创建`Foo`对象后将无法访问指针（除非他真的想要并使用`get`）。

例如

```
#include <memory>
struct Bar {};

struct Foo {
  Foo(std::unique_ptr<Bar>&& ptr) : ptr_(std::move(ptr)) {}
  std::unique_ptr<Bar> ptr_;
};

int main()
{
  std::unique_ptr<Bar> tt(new Bar());
  Foo f(std::move(tt));

  return 0;
} 
```

# macos - Mac OS X：如何将多个 NSView 绘制成一个新的多页 PDF？

> ID：10438061
> 
> 赞同：4
> 
> 时间：2012-05-03T19:27:40.960
> 
> 标签：macos, cocoa, core-graphics, quartz-2d

我有一个与图形相关的基于文档的 Mac 应用程序。我的应用程序的文档可能有多个“页面”。每个页面都有一个`NSView`“画布”对象。

我的应用程序有几个导出选项，它们被实现为返回`NSData`对象（然后将其写入磁盘）的方法。

我想以以下方法实现 PDF 导出选项：

1.  创建内存 PDF
2.  循环遍历我文档的画布视图，并在内存 PDF 的新页面中呈现每个视图
3.  将内存中的多页 PDF 作为`NSData`

下面的代码是我目前正在尝试的。

我文档中的每一页都是 800 x 600 像素。

当我将生成的`NSData`对象写入磁盘时，写入操作成功，但磁盘上的文件以某种方式损坏。该文件无法在预览或我尝试过的任何其他应用程序中打开。

我究竟做错了什么？

```
NSMutableData *data = [NSMutableData data];
CGDataConsumerRef consumer = CGDataConsumerCreateWithCFData((CFMutableDataRef)data);

CGRect mediaBox = CGRectMake(0.0, 0.0, 800.0, 600.0);
CGContextRef ctx = CGPDFContextCreate(consumer, &mediaBox, NULL);
CFRelease(consumer);

NSGraphicsContext *gc = [NSGraphicsContext graphicsContextWithGraphicsPort:ctx flipped:NO];

for (NSView *canvas in myCanvases) {
    CGContextBeginPage(ctx, &mediaBox);
    CGContextSaveGState(ctx);

    [canvas displayRectIgnoringOpacity:mediaBox inContext:gc];

    CGContextRestoreGState(ctx);
    CGContextEndPage(ctx);
}

CGPDFContextClose(ctx); // UPDATE: this line was originally missing. see answer below
CGContextRelease(ctx);

...

NSError *err = nil;
if (![data writeToFile:s options:NSDataWritingAtomic error:&err]) {
    if (err) {
        NSLog(@"%@", err);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T21:08:54.937

在这里。我已经解决了这个问题。我错过了对`CGPDFContextClose()`.

所以在释放上下文之前......

```
CGPDFContextClose(ctx);
CGContextRelease(ctx); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-13T08:41:19.493

我发现这是一个最有用的答案（并且必须对问题和答案都投赞成票！）。将它翻译成 Swift 3 时遇到了一些麻烦，但这就像一个魅力，它可以在 iOS 上运行......

```
let data = NSMutableData()
guard let consumer = CGDataConsumer(data: data) else { Swift.print("Aargh - no CGDataConsumer"); return }
var mediaBox = CGRect(x: 0, y: 0, width: 800, height: 600)
guard let ctx = CGContext(consumer: consumer, mediaBox: &mediaBox, nil) else { Swift.print("Aargh - no CGContext"); return }

//let gc = NSGraphicsContext(cgContext: ctx, flipped: false) 
//I don't need the NS context, as my drawing routines just use CGContext

for page in self.pages { // Array of page models
    ctx.beginPage(mediaBox: &mediaBox)
    ctx.saveGState()
    myDraw(page, context: ctx, options: []) // My routine
    ctx.restoreGState()
    ctx.endPage()
}
ctx.closePDF()
do {
    try data.write(toFile: "/Users/grimxn/Test.pdf", options: .atomic)
} catch {
    Swift.print("Aargh - failed to write output file")
} 
```

# css - 如何将组合媒体查询从 css 转换为 sass？

> ID：10438064
> 
> 赞同：1
> 
> 时间：2012-05-03T19:27:59.707
> 
> 标签：css, sass, media-queries

目前我有这个：

```
@media only screen and (-webkit-min-device-pixel-ratio: 1.5),
only screen and (-o-min-device-pixel-ratio: 3/2),
only screen and (min--moz-device-pixel-ratio: 1.5),
only screen and (min-device-pixel-ratio: 1.5) {
  h1.top-logo{
    background-image: url('../img/logo@2x.png');
    -moz-background-size: 180px 32px;
    -o-background-size: 180px 32px;
    -webkit-background-size: 180px 32px;
    background-size: 180px 32px;
  }
} 
```

查看 sass 文档，他们提供了单个媒体查询的示例，这......我想这会起作用，但是当我真的只需要一个时，我有 4 个媒体查询和重复的 css。

我尝试了 css2sass 转换器（只是想看看它的建议[http://css2sass.heroku.com/](http://css2sass.heroku.com/)）它给了我这个：

```
@media only screen and (-webkit-min-device-pixel-ratio: 1.5),
only screen and (-o-min-device-pixel-ratio: 3/2),
only screen and (min--moz-device-pixel-ratio: 1.5),
only screen and (min-device-pixel-ratio: 1.5)
  h1.top-logo
    background-image: url('../img/logo@2x.png')
    -moz-background-size: 180px 32px
    -o-background-size: 180px 32px
    -webkit-background-size: 180px 32px
    background-size: 180px 32px 
```

这给了我一个错误：`only screen and ": expected selector, was "(-o-min-device-..."`

不知道从这里去哪里。

**编辑**

我想我总是可以将它放在一个单独的文件中，并在 html 中使用媒体查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T12:53:02.897

这就是我现在最终解决它的方式：

```
@mixin mobi-logo-fix
  h1.top-logo
    background-image: url('../img/logo@2x.png')
    -moz-background-size: 180px 32px
    -o-background-size: 180px 32px
    -webkit-background-size: 180px 32px
    background-size: 180px 32px

@media only screen and (-webkit-min-device-pixel-ratio: 1.5)
  @include mobi-logo-fix
@media only screen and (-o-min-device-pixel-ratio: 3/2)
  @include mobi-logo-fix
@media only screen and (min--moz-device-pixel-ratio: 1.5)
  @include mobi-logo-fix
@media only screen and (min-device-pixel-ratio: 1.5)
  @include mobi-logo-fix 
```

结果相同，它没有结合 css，但是 mixin 让我只能将代码放在一个位置。

# jquery - Jquery在提交时从文本框中删除默认文本

> ID：10438067
> 
> 赞同：2
> 
> 时间：2012-05-03T19:28:19.283
> 
> 标签：jquery

```
 $('input[class*="defaulttext"]').each(function () {

                    this.value = $(this).attr('title');
                    $(this).addClass('defaultclass');

                    $(this).focus(function () {
                        if (this.value == $(this).attr('title')) {
                            this.value = '';
                            $(this).removeClass('defaultclass');
                        }
                    });

                    $(this).blur(function () {
                    if (this.value == '') {
                        this.value = $(this).attr('title');
                        $(this).addClass('defaultclass');
                    }
                });

                }); 
```

这基本上为文本框添加了背景文本效果（使用标题）。一旦选择，文本就会消失。

现在，我对可选字段有疑问。如果用户不编辑这些字段，则默认背景文本与表单一起提交。所以我需要在提交表单后重置未编辑字段的值。任何想法如何做到这一点？

也许在表单提交时，检查标题是否=值？如果是，则设置为''。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:33:30.937

我们使用了[HTML5 Placeholder jQuery Plugin](https://github.com/mathiasbynens/jquery-placeholder)，它在这种情况下运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:35:31.753

根据您拥有的代码，您可以执行以下操作：

```
$("#yourForm").submit(function () {
     $('input[class*="defaulttext"]').val("");
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:33:33.207

您可以这样做，并检查 title=value 的值。或者，您可以使用[jQuery.data()标记已编辑的字段](http://api.jquery.com/jQuery.data/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T19:44:17.900

```
$("#yourForm").submit(function () {
    $('input.defaulttext').each(function() {
        if($(this).val() === $(this).attr('title')) { $(this).val(''); }
    });
}; 
```

# php - 让我的 PHP 表单在服务器上工作

> ID：10438068
> 
> 赞同：-1
> 
> 时间：2012-05-03T19:28:20.370
> 
> 标签：php, html, dreamweaver

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

> 警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由 D:\USBWebserver_v8_en\root\pages 中的（输出开始于 D:\USBWebserver_v8_en\root\pages\login.php:1）发送\login.php 在第 0 行

我用 html 代码创建了一个登录表单，我的服务器全部设置了所有设置和所有这些东西，我使用 USB Webserver V8，它具有 phpmyadmin 功能，所以我在上面创建了一个数据库并使用了 dreamweaver为了链接数据库字段和内容，我使用了 Dream Weaver 上的登录验证字段功能，使页面在成功或失败时转到它所在的位置。

当我在我的服务器上打开它时，我什至在输入任何内容之前都会收到以下错误

警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由 D:\USBWebserver_v8_en\root\pages 中的（输出开始于 D:\USBWebserver_v8_en\root\pages\login.php:1）发送\login.php 在第 0 行

警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 标头已发送（输出开始于 D:\USBWebserver_v8_en\root\pages\login.php:1）在 D:\USBWebserver_v8_en\root\pages \login.php 在第 0 行

警告：session_regenerate_id() [function.session-regenerate-id]：无法重新生成会话 id - 标头已在第 62 行的 D:\USBWebserver_v8_en\root\pages\login.php 中发送

当输入某些内容时，不会发生验证，并且我也收到另一条消息警告：无法修改标头信息 - 标头已由 D:\USBWebserver_v8_en\ 中的（输出开始于 D:\USBWebserver_v8_en\root\pages\login.php:1）发送第 70 行的 root\pages\login.php

这是我表格上的代码

```
<form METHOD="POST" action="<?php echo $loginFormAction; ?>" id="form2">
<p>&nbsp;</p>
<p><span class="letter">Username:</span>
<input type="text"name="username""username id="username"">
</p>
<p><span class="letter">Password: </span>
<input type="password"name="password"/>
</p>
<p>
<input name="submit" type="submit" class="content1" value="Login" />
</p>
<p>&nbsp;</p>
<!-- end .content -->
</form> 
```

这是我的 php 代码

```
<?php virtual('/Connections/reuben1.php'); ?>
<?php
if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "",  $theNotDefinedValue = "") 
{
if (PHP_VERSION < 6) {
$theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;
}

$theValue = function_exists("mysql_real_escape_string") ?  mysql_real_escape_string($theValue) : mysql_escape_string($theValue);

switch ($theType) {
case "text":
$theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
break;    
case "long":
case "int":
$theValue = ($theValue != "") ? intval($theValue) : "NULL";
break;
case "double":
$theValue = ($theValue != "") ? doubleval($theValue) : "NULL";
break;
case "date":
$theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
break;
case "defined":
$theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
break;
}
return $theValue;
}
}
?>
<?php
//*** Validate request to login to this site.
if (!isset($_SESSION)) {
session_start();
}

$loginFormAction = $_SERVER['PHP_SELF'];
if(isset($_GET['accesscheck'])) {
$_SESSION['PrevUrl'] = $_GET['accesscheck'];
}

if(isset($_POST['username'])) {
$loginUsername=$_POST['username'];
$password=$_POST['password'];
$MM_fldUserAuthorization = "";
$MM_redirectLoginSuccess = "/Pages/Home.html";
$MM_redirectLoginFailed = "/Pages/Help.html";
$MM_redirecttoReferrer = false;
mysql_select_db($database_reuben1, $reuben1);

$LoginRS__query=sprintf("SELECT username, passwowrd FROM users WHERE username=%s AND   passwowrd=%s",
GetSQLValueString($loginUsername, "text"), GetSQLValueString($password, "text")); 

$LoginRS = mysql_query($LoginRS__query, $reuben1) or die(mysql_error());
$loginFoundUser = mysql_num_rows($LoginRS);
if ($loginFoundUser) {
$loginStrGroup = "";
if (PHP_VERSION >= 5.1) {session_regenerate_id(true);} else {session_regenerate_id();}
//declare two session variables and assign them
$_SESSION['MM_Username'] = $loginUsername;
$_SESSION['MM_UserGroup'] = $loginStrGroup;       

if (isset($_SESSION['PrevUrl']) && false) {
$MM_redirectLoginSuccess = $_SESSION['PrevUrl'];    
}
header("Location: " . $MM_redirectLoginSuccess );
}
else {
header("Location: ". $MM_redirectLoginFailed );
}
}
?> 
```

我不知道它为什么不起作用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:30:23.470

查看 D:\USBWebserver_v8_en\root\pages\login.php 的第 1 行

它在那里输出一些东西，阻止它开始会话。这可能是开始 php 标记之前的空行或空格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:33:32.767

```
Warning: session_start() [function.session-start]: Cannot send session cookie - headers already sent 
```

这意味着 PHP 已经向浏览器输出了一些数据，这意味着它不能设置任何标题（在发送任何 HTML 之前设置的东西）。在这种情况下，通常意味着**在第一个 PHP 标签之前**有一些代码。在 login.php 中，确保在第一个打开 PHP 标记之前**没有任何内容-****甚至是空格**（空格、新行等）。同样的规则也适用`/Connections/reuben1.php`- 确保它的开头也没有任何空格。

# .net - 使用 DispatcherObject.Dispatcher 时如何防止 MVVM 中的循环引用

> ID：10438070
> 
> 赞同：0
> 
> 时间：2012-05-03T19:28:24.457
> 
> 标签：.net, wpf, mvvm, dispatcher, circular-reference

下面的代码非常简化。我正在尝试抽象调度程序上下文，以便我的视图模型可以同步只能在 GUI 线程上引发的事件。

此模式中有一个循环引用。有没有其他方法可以创建一个`DispatcherObject`？我做错了吗？

我读过其他类似的问题，但答案似乎都涉及`DispatcherObject`对`ViewModel`. 这是一个可以接受循环引用的地方吗？

```
class ViewModel {
    public DispatcherObject Dispatcher { get; set; }
}

class ModelView : UserControl {

    ModelView() {
        InitializeComponent();
        DataContext = new ViewModel { Dispatcher = this };
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T07:55:06.047

一般来说，循环引用是您要避免的。这里有两种选择：

## 1.静态抓取dispatcher

快速而肮脏的方法。很容易做到，几乎所有时间都可以正常工作，但与其他任何静态完成的事情一样，它不适合可测试性（这可能是也可能不是问题）。在您的 WPF 应用程序具有多个 UI 线程的极少数情况下，您将无法盲目地使用这种方法。

WPF：`var dispatcher = Application.Current.Dispatcher;`

银光：`var dispatcher = Deployment.Current.Dispatcher;`

## 2.使dispatcher成为ViewModel的依赖

适当地配置您的依赖注入容器，并使其`Dispatcher`成为需要访问它的那些 ViewModel 的依赖项。这种方法更麻烦，但它允许您使用多个 UI 线程，是可测试的，并且通常具有使用 DI 做事的所有常见优点/缺点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T21:11:13.043

无需从控件中获取特定的调度程序。可以直接通过Deployment进行调度，即Deployment.Current.Dispatcher.BeginInvoke(()=>something)。

我通常不提供调度程序对象，而是提供一个动作委托。然后，您可以通过只执行操作来测试而不跳线程，而在生产中它可以在 Dispatcher 上调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T08:43:45.603

为什么要保留对`DispatcherObject`您真正需要调用的是调度程序本身的时间的引用？

```
class ViewModel {
    public Dispatcher Dispatcher { get; set; } }

class ModelView : UserControl {

    ModelView() {
        InitializeComponent();
        DataContext = new ViewModel { Dispatcher = Dispatcher };
    } } 
```

# c# - 我对 Ubuntu/Mono/C# 有一个看似无法追踪的问题。我怎样才能找到它？

> ID：10438075
> 
> 赞同：0
> 
> 时间：2012-05-03T19:28:49.317
> 
> 标签：c#, ubuntu, mono

我有一个在 Ubuntu 上运行的服务器程序，它在几个客户端连接后挂起。问题是，它只有在 IDE 中没有被调试时才会这样做。我可以从命令行运行它（完全相同的调试二进制文件），将 gdb 附加到它，它会挂起，但 gdb 没有发现问题。但是，当我从 MonoDevelop 调试时，它永远不会挂起。

我完全不知道如何从这里开始。

有谁知道 Mono 是否设置了一些标志或我不知道的东西？我严重受阻并且完全沮丧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:33:10.733

您可能在某个地方遇到了竞争条件 - MonoDevelop 使用软调试器，它会减慢执行速度作为副作用，因此锁的生存率会降低。或者你可以试试这个：[http ://www.mono-project.com/Debugging#Debugging_Unmanaged_Deadlocks](http://www.mono-project.com/Debugging#Debugging_Unmanaged_Deadlocks)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T18:53:16.530

显然，不要让控制台 IO 堵塞，因为几乎没有指标。

# mysql - 我该如何调查这些神秘的 Django 崩溃？

> ID：10438076
> 
> 赞同：2
> 
> 时间：2012-05-03T19:28:53.933
> 
> 标签：mysql, django, apache, profiling

一个每月提供大约 950k 页面浏览量的 Django 站点（托管在 Webfaction 上）正在经历崩溃，我无法弄清楚如何调试。以不可预测的时间间隔（平均每天一次，但不是每天同一时间），对站点的所有请求都开始挂起/超时，使得站点完全无法访问，直到我们重新启动 Apache。这些请求在前端访问日志中显示为 499，但根本不会出现在我们应用程序的日志中。

在仔细研究服务器日志（包括由 django-timelog 生成的日志）时，我似乎找不到任何在网站关闭之前就点击页面的模式。对于最近的崩溃，在网站关闭之前被击中的所有页面似乎都是标准的“渲染到响应”操作，使用的模板看起来非常简单，并且在其余时间运行良好。根据时间日志，崩溃前的请求似乎不需要更长的时间，而且我无法通过负载测试故意复制崩溃。

Webfaction 说这不是超出我们允许的内存使用量的情况，否则他们会通知我们。需要注意的一件事是，当我们恢复站点时，数据库并没有重新启动（只是应用程序/Apache）。

您将如何调查此类反复出现的问题？似乎必须有一行代码挂在某个地方——你对找到它的过程有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T02:35:54.823

我曾经遇到过这样的问题，基本上归结为我对 django 中间件中的线程安全的误解。基本上，django 中间件是我相信在所有线程之间共享的单例，并且这些线程正在与我拥有的自定义中间件类上设置的值发生冲突。我的解决方案是重写我的中间件以不使用已更改的实例或类属性，并将我的应用程序的关键部分切换为根本不使用我的 uwsgi 服务器的线程，因为这些似乎是我的应用程序的整体性能下降。当您的视图可能以不同的时间间隔完成（一些长时间运行的视图和一些快速运行的视图）时，线程化 uwsgi 设置似乎工作得最好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:29:13.180

由于在复制崩溃之前您无法真正描述故障条件，因此您可能需要使用`ab`（[apache benchmark](http://httpd.apache.org/docs/2.0/programs/ab.html)）强制这种情况。如果您不想对您的生产站点执行此操作，您可以在子域中复制该站点。警告：`ab`可以击败服务器中永远爱的废话，所以 RTM。您可能还希望让 WF 管理员提前了解您将要做什么。

**更新评论：**

我建议使用*完全相同的机器*，以便子域名是唯一的区别。鉴于您使用了不同的*机器*，有大量微妙的（而不是那么微妙的）环境因素可能会使您远离让错误显现出来。如果新机器没问题，并且如果您愿意在不实际解决问题的情况下摆脱问题，那么您可能只需将其用作生产机器并感到高兴。就我个人而言，我倾向于沉迷于这样的事情，但话说回来，我也退休了，有足够的时间玩我的脚趾。:-)

# image - 无法使用 NSURLConnection sendSynchronousRequest 从 url 获取图像

> ID：10438077
> 
> 赞同：0
> 
> 时间：2012-05-03T19:28:56.413
> 
> 标签：image, url, proxy, nsurlconnection

我有一个在浏览器中返回图像的特殊 URL。我想把这个特殊的图像放入 UIImage 对象中。但是，在我下面的代码示例中，返回的数据似乎不是图像。

浏览器似乎知道图像，我怎样才能得到图像？

是的，我需要通过代理代理服务器获取此图像来解决我们遇到的问题。

这是示例代码。

```
-(UIImage*)retrieveMap
{        
    NSString* proxifiedGoogleMapURL = @"http://proxify.com/p/011010A1000100/687474703a2f2f6d6170732e676f6f676c652e636f6d2f6d6170732f6170692f7374617469636d61703f63656e7465723d34312e3031343130312c2d3130342e393738333333267a6f6f6d3d362673697a653d35303678353036267363616c653d32266d6170747970653d726f61647326666f726d61743d706e672673656e736f723d66616c7365";  

    NSURLRequest * firstRequest = [NSURLRequest requestWithURL:[NSURL URLWithString: proxifiedGoogleMapURL]];
    NSURLResponse * firstResponse = nil; 
    NSError * firstError = nil;
    NSData* firstData = [NSURLConnection sendSynchronousRequest:firstRequest returningResponse:&firstResponse error:&firstError];

    UIImage* dataAsImage = [UIImage imageWithData:firstData];

    if(firstError != nil || dataAsImage == nil)
    {
        NSLog(@"Failed in retrieving the map");
    }
    else 
    {
        NSLog(@"Succeeded in retrieving the map");
    }

    return dataAsImage;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T15:09:42.580

我发现了几个问题：

1.  `firstError != nil`在尝试转换为 UIImage 之前，您应该进行测试。之后对其进行测试使其无用。

2.  我试图访问您发布的那个 URL，但我收到一条错误消息，说它只对登录的用户可用。在浏览器中它可能对您有用，因为您可能已经登录，但 iphone 不是，您会得到那个 HTML从代理

3.  要查看您得到的响应，在创建图像之前将其转换为 NSString 并将其显示到控制台：

`NSLog(@"Response from server: %@", [[NSString alloc] initWithData:firstData encoding:NSUTF8StringEncoding]`

# javascript - “函数 xy () {...}”上的语法错误？

> ID：10438079
> 
> 赞同：0
> 
> 时间：2012-05-03T19:29:02.170
> 
> 标签：javascript, syntax, syntax-error

如何修复以下 javascript 错误？这是一个 ASP.NET 页面的处理程序，用于在按下回车键时禁用回发：

```
 <script type="text/javascript">
            function document.onkeydown() {

                if (event.keyCode == 13) {
                    event.returnValue = false;
                    event.cancel = true;
                }
            }
        </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:30:57.287

请注意，这`document.onkeydown`不是有效的函数名称。你可能想这样做：

```
document.onkeydown = function(ev) {
  if (ev.keyCode == 13) {
  // ...
} 
```

或更好：

```
document.addEventListener('keydown', function(ev) {
  if (ev.keyCode == 13) {
  // ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:33:19.613

要添加到 maerics 答案，要访问事件，您需要它作为参数......

```
document.addEventListener( 'keydown', function( event ) {
    console.log( event, event.keyCode );
    if (event.keyCode == 13) {
        event.returnValue = false;
        event.cancel = true;
    }
}); 
```

# mysql - 尽管选择是，但使用 WHERE、AND、JOIN 更新不起作用

> ID：10438081
> 
> 赞同：0
> 
> 时间：2012-05-03T19:29:11.173
> 
> 标签：mysql, join, where

我再次感到非常困惑，我回到这里寻求更多帮助

如果我运行以下查询，我会返回 721 条记录。

```
select 
users.`MobilePhone`
from users 
left join MobilePhones on 
users.`MobilePhone` = MobilePhones.`Telephone No`

WHERE MobilePhones.`Telephone No` IS NULL
and 
users.`MobilePhone` <> "" 
and 
users.`TelephonyProfile` = "Mobile"
and 
users.`MobilePhone` not like "44%" 
```

我现在想标记这些以便进一步调查。

因此，我运行以下

```
UPDATE users join MobilePhones on (users.`MobilePhone` = MobilePhones.`Telephone No`)

SET `CheckMobileNo` = 'YES' 

WHERE MobilePhones.`Telephone No` IS NULL
  and 
users.`MobilePhone` <> "" 
  and 
users.`TelephonyProfile` = "Mobile"
  and 
users.`MobilePhone` not like "44%" 
```

这将返回 NO 更新，`CheckMobileNo`尚未更新并保持空白。

请问我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:32:40.687

您在这里加入：

```
UPDATE users join MobilePhones on 
```

应该是一个`LEFT JOIN`

# git - Git fetch/pull 已停止工作

> ID：10438082
> 
> 赞同：10
> 
> 时间：2012-05-03T19:29:11.517
> 
> 标签：git, github, git-fetch

Git fetch 和 pull 昨天都在服务器（AWS 实例）上停止工作。

```
$ git fetch
ERROR: Repository not found.
fatal: The remote end hung up unexpectedly 
```

该实例上有两个存储库克隆，都给出了相同的错误。git 在本地 PC 上仍然运行良好。

`git remote -v`在本地 PC 和服务器上给出相同的结果；`ssh git@github.com`正常工作（“嗨（姓名）！您已成功通过身份验证，但 GitHub 不提供 shell 访问权限。”）

行为上有一个区别：`git pull origin st`+[Tab] 用于扩展为分支名称；现在它扩展为当前目录中文件的名称（文件名与分支名称不同）。

**更新**：我尝试重新创建远程：SSH 版本仍然失败，但 HTTP 工作。

根据git mailing list 中的讨论，[这](http://thread.gmane.org/gmane.comp.version-control.git/197323/)实际上是 GitHub 网站上的一个问题。

**更新**

输出与`GIT_TRACE=1`

```
############# Local results #############

$ GIT_TRACE=1 git fetch
setup: git_dir: .git
setup: worktree: c:/Projects/(local_path)
setup: cwd: c:/Projects/(local_path)
setup: prefix: (null)
trace: built-in: git 'fetch'
trace: run_command: 'ssh' 'git@github.com' 'git-upload-pack '\''(username)/(reponame).git'\'''
Enter passphrase for key '(keyname)':
trace: run_command: 'rev-list' '--quiet' '--objects' '--stdin' '--not' '--all'

############# AWS results #############

$ GIT_TRACE=1 git fetch
trace: built-in: git 'fetch'
trace: run_command: 'ssh' 'git@github.com' 'git-upload-pack '\''(username)/(reponame).git'\'''
ERROR: Repository not found.
fatal: The remote end hung up unexpectedly 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T18:44:04.473

问题解决了。

原来这是我们这边的一个误传：在那个盒子上设置钥匙的人离开了，他对 GH 回购的访问权已被撤销。

GitHub 返回“未找到存储库”而不是“您没有此存储库的访问权限” - 他们的支持表示他们不想泄露存储库的存在，除非您有权访问它。

# ios - 在 iOS 中使用 SQLite... 非常初学者的程序

> ID：10438089
> 
> 赞同：4
> 
> 时间：2012-05-03T19:29:25.140
> 
> 标签：ios, sqlite

我正在尝试编写一个应用程序，其中有两个用于输入的文本字段。从文本字段中获取的输入被初始化为字符串。所以我想要完成的是：

*   创建一个将保存在 Xcode 项目中的 SQLite 数据库（文件）（我不确定它可以保存到哪里，但我需要能够读取和写入它）。
*   然后我想将字符串（来自文本字段输入）放入 SQLite 表中，该表只有两个字段（为简单起见）。我正在使用一个按钮来接受来自文本字段的输入，将输入放入字符串中，然后将字符串的值放入标签中。
*   我最终希望将文本字段中的字符串放入表格中，然后读取表格以“抓取”字符串并将它们显示到标签中。所有这一切都将通过单击一个按钮来完成。

我意识到这是非常具体的，但我一直很难找到任何简单的方法来实现这一点。我对 iOS 开发非常陌生，如果有人可以尽可能具体和详细，或者至少向我指出一些可以教我如何完成此任务的资源，我将不胜感激。

我使用的是 Xcode v4.3.2，我不使用 Storyboard 或 ARC。我试图尽可能详细，但你可以，我的目标真的很简单。

我已经被淘汰了，我很感激我能得到的所有帮助。

谢谢！-马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T19:55:56.563

*   创建数据库文件：只需将 data.sqlite 文件拖放到 xcode 项目中，就像删除任何其他类或图像资源一样。请注意，您必须在应用安装后将文件复制到可写目录。看看[createeditablecopyofdatabaseifneeded](https://stackoverflow.com/questions/3737832/createeditablecopyofdatabaseifneeded-create-an-empty-copy-of-db)。
*   相对于您的新数据库位置，使用[sqlite3_open](https://stackoverflow.com/questions/3288269/sqlite3-open-cant-open-database)打开您的数据库。
*   使用 sqlite3_prepare_v2 查询数据库

一个简单的查询片段如下所示：

```
NSString *querystring;

// create your statement
querystring= [NSString stringWithFormat:@"SELECT text1, text2 FROM datatable;"];  

const char *sql = [querystring UTF8String];

NSString *text1 = nil;
NSString *text2 = nil;

if (sqlite3_prepare_v2(db, sql, -1, &statement, NULL)!=SQLITE_OK){

    NSLog(@"sql problem occured with: %s", sql);
    NSLog(@"%s", sqlite3_errmsg(db));

}
else
{
    // you could handle multiple rows here
    while (sqlite3_step(statement) == SQLITE_ROW) {            

       text1 = [NSString stringWithUTF8String:(char*)sqlite3_column_text(statement, 0)];
       text2 = [NSString stringWithUTF8String:(char*)sqlite3_column_text(statement, 1)];

    } // while        

}
sqlite3_finalize(statement);

// go on with putting data where you want 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T14:55:57.177

这里有一个使用 SQLite 的示例项目，您可以参考：[https ://github.com/AaronBratcher/ABSQLite](https://github.com/AaronBratcher/ABSQLite)

它具有以更传统的数据库方式访问 SQLite 的类。示例项目使用 SQL 创建表，并展示了如何在不同版本的应用程序上更改架构。

# mysql - 如何以pythonic方式匹配和分配数据？

> ID：10438091
> 
> 赞同：0
> 
> 时间：2012-05-03T19:29:27.983
> 
> 标签：mysql, match, python

我有一个人员列表（mysql 表）及其标题，如下表所示。我还有一个标题列表及其类别。我如何将他们的类别分配给这个人？当一个人有多个头衔时，就会出现问题。将标题映射到类别并将其分配给人员的pythonic方法是什么？

**人员表**

```
Name   Title
--------------------
John D CEO, COO, CTO 
Mary J COO, MD
Tim  C Dev Ops, Director 
```

**标题类别表**

```
Title      Executive IT Other
-----------------------------
CEO        1
COO        1
CTO        1          1
MD         1
Dev Ops               1
Director                 1 
```

**期望的输出：**

```
Name   Title             Executive  IT  Other
---------------------------------------------
John D CEO, COO, CTO     1          1
Mary J COO, MD           1 
Tim  C Dev Ops, Director            1   1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:47:36.603

首先以列表字典形式排列输入数据：

```
>>> name_to_titles = {
        'John D': ['CEO', 'COO', 'CTO'],
        'Mary J': ['COO', 'MD'],
        'Tim C': ['Dev Ops', 'Director']
} 
```

然后循环输入字典以创建反向映射：

```
>>> title_to_names = {}
>>> for name, titles in name_to_titles.items():
        for title in titles:
            title_to_names.setdefault(title, []).append(name)

>>> import pprint
>>> pprint.pprint(title_to_names)
{'CEO': ['John D'],
 'COO': ['John D', 'Mary J'],
 'CTO': ['John D'],
 'Dev Ops': ['Tim C'],
 'Director': ['Tim C'],
 'MD': ['Mary J']} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:49:04.427

```
name_title = (("John D",("CEO","COO","CTO")),
              ("Mary J",("COO","MD")),
              ("Tim C",("Dev Ops","Director")))
title_cat = {"CEO": set(["Executive"]),
             "COO": set(["Executive"]),
             "CTO": set(["Executive"]),
             "MD": set(["Executive"]),
             "Dev Ops": set(["IT"]),
             "Director": set(["Other"])}

name_cat = [(name, reduce(lambda x,y:x|y, [title_cat[title]for title in titles])) for name,titles in name_title] 
```

如果有一个`union`在场景中表现得像的，那就太好了`sum`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:57:10.717

```
people=['john','Mary','Tim']
Title=[['CEO','COO','CTO'],['COO','MD'],['DevOps','Director']]
title_des={'CEO':'Executive','COO':'Executive','CTO':'Executive',
           'MD':'Executive','DevOps':'IT','Director':'Others'
           }
people_des={}

for i,x in enumerate(people):
    people_des[x]={}
    for y in Title[i]:
        if title_des[y] not in people_des[x]:
             people_des[x][title_des[y]]=[y]
        else:     
             people_des[x][title_des[y]].append(y) 
print(people_des) 
```

**输出：**

```
{'Tim': {'IT': ['DevOps'], 'Others': ['Director']}, 'john': {'Executive': ['CEO', 'COO', 'CTO']}, 'Mary': {'Executive': ['COO', 'MD']}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T19:53:05.000

如果你的意思是你有字符串，我建议这个：

```
s = '''Name   Title
--------------------
John D CEO, COO, CTO
Mary J COO, MD
Tim  C Dev Ops, Director

Title      Executive IT Other
-----------------------------
CEO        1
COO        1
CTO        1
MD         1
Dev Ops               1
Director                 1
'''

lines = s.split('\n')
it = iter(lines)

for line in it:
    if line.startswith('Name'):
        break

next(it) # '--------------------'

for line in it:
    if not line:
        break
    split = line.split()
    titles = split[2:]
    name = split[:2]
    print ' '.join(name), titles

# John D ['CEO,', 'COO,', 'CTO']
# Mary J ['COO,', 'MD']
# Tim C ['Dev', 'Ops,', 'Director'] 
```

# ruby-on-rails - 在 Heroku 上重新启动后，长时间运行的延迟作业作业保持锁定状态

> ID：10438100
> 
> 赞同：16
> 
> 时间：2012-05-03T19:30:05.530
> 
> 标签：ruby-on-rails, ruby, heroku, delayed-job

当 Heroku 工作程序重新启动时（根据命令或部署的结果），Heroku 将发送`SIGTERM`到工作程序进程。在 的情况下`delayed_job`，`SIGTERM` [信号被捕获](https://github.com/collectiveidea/delayed_job/blob/master/lib/delayed/worker.rb#L125)，然后工作人员在当前作业（如果有）停止后停止执行。

如果工人需要很长时间才能完成，那么 Heroku 将发送`SIGKILL`. 在 的情况下`delayed_job`，这会在数据库中留下一个锁定的作业，不会被其他工作人员拾取。

我想确保工作最终完成（除非出现错误）。鉴于此，解决此问题的最佳方法是什么？

我看到两个选项。但我想得到其他输入：

1.  修改`delayed_job`以在收到`SIGTERM`.
2.  找出一种（程序化的）方法来检测孤立的锁定作业，然后解锁它们。

有什么想法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-05-29T10:47:16.253

## 在 SIGTERM 上彻底中止作业

delay_job 现在内置了一个更好的解决方案。通过在初始化程序中添加此设置，使用此设置在 TERM 信号上引发异常：

```
Delayed::Worker.raise_signal_exceptions = :term 
```

使用该设置，作业将在 heroku 发出用于非合作进程的最终 KILL 信号之前正确清理并退出：

> 您可能需要在 SIGTERM 信号上引发异常，Delayed::Worker.raise_signal_exceptions = :term 将导致工作人员引发 SignalException 导致正在运行的作业中止并被解锁，从而使其他工作人员可以使用该作业。此选项的默认值为 false。

的可能值为`raise_signal_exceptions`：

*   `false`- 不会引发异常**（默认）**
*   `:term`- 只会在 TERM 信号上引发异常，但 INT 将等待当前作业完成。
*   `true`- 将在 TERM 和 INT 上引发异常

**从版本 3.0.5 开始可用。**

在引入它的地方查看[这个提交](https://github.com/collectiveidea/delayed_job/commit/90579c3047099b6a58595d4025ab0f4b7f0aa67a)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-26T17:00:37.767

**TLDR：**

把它放在你的工作方法的顶部：

```
begin
  term_now = false
  old_term_handler = trap 'TERM' do
    term_now = true
    old_term_handler.call
  end 
```

**和**

确保至少每十秒调用一次：

```
 if term_now
    puts 'told to terminate'
    return true
  end 
```

**和**

在你的方法的最后，把这个：

```
ensure
  trap 'TERM', old_term_handler
end 
```

* * *

**解释：**

我遇到了同样的问题，并遇到了[这篇 Heroku 文章](https://devcenter.heroku.com/articles/ps#graceful-shutdown-with-sigterm)。

该作业包含一个外部循环，因此我按照文章添加了一个`trap('TERM')`and `exit`。但是`delayed_job` ，将其捡起`failed with SystemExit`并将任务标记为失败。

现在`SIGTERM`被我们`trap` [的工人处理程序困住了，它不会被调用](https://github.com/collectiveidea/delayed_job/blob/master/lib/delayed/worker.rb#L125)，而是立即重新启动作业，然后在`SIGKILL`几秒钟后得到。回到原点。

我尝试了一些替代方案`exit`：

*   A`return true`将作业标记为成功（并将其从队列中删除），但如果队列中有另一个作业在等待，则会遇到同样的问题。

*   调用`exit!`将成功退出作业和工作人员，*但*它不允许工作人员从队列中删除作业，因此您仍然存在“孤立锁定作业”问题。

我的最终解决方案是我的答案顶部给出的解决方案，它包括三个部分：

1.  在我们开始可能很长的工作之前，我们`'TERM'`通过执行 a `trap`（如 Heroku 文章中所述）添加一个新的中断处理程序，并使用它来设置`term_now = true`.

    **但**我们还必须抓住`old_term_handler`哪个[延迟作业工人代码](https://github.com/collectiveidea/delayed_job/blob/master/lib/delayed/worker.rb#L125)集（由 返回`trap`）**并**记住`call`它。

2.  我们仍然必须确保我们`Delayed:Job:Worker`有足够的时间将控制权返回给它，以便它清理和关闭，所以我们应该`term_now`至少（略低于）每十秒检查一次，`return`如果它是`true`。

    您可以`return true`或`return false`取决于您是否希望该工作被认为是成功的。

3.  最后，**重要**的是要记住删除处理程序并`Delayed:Job:Worker`在完成后重新安装处理程序。如果你没有这样做，你将保留一个对我们添加的引用的悬空引用，如果你在其上添加另一个引用，这可能会导致内存泄漏（例如，当工作人员再次开始这项工作时）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-04T04:49:28.480

新网站，因此无法评论 Dave 的帖子，需要添加新答案。

我对 Dave 方法的问题是我的任务很长（几分钟到 8 小时），而且根本没有重复性。我不能“确保每 10 秒打一次电话”。此外，我已经尝试了 Dave 的回答，并且无论我返回什么，无论是真还是假，该作业总是从队列中删除。我不清楚如何让工作保持在队列中。

看到这个[这个拉请求](https://github.com/collectiveidea/delayed_job/pull/285)。我认为这可能对我有用。请随时对其发表评论并支持拉取请求。

我目前正在试验一个陷阱然后拯救出口信号......到目前为止还没有运气。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-26T01:17:38.810

这就是为什么`max_run_time`：`max_run_time`从作业被锁定的时间过去后，其他进程将能够获得锁。

从谷歌组看到[这个讨论](https://groups.google.com/forum/?fromgroups=#!topic/delayed_job/nGCKoxzdgTY)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-12T23:48:43.260

我最终不得不在几个地方这样做，所以我创建了一个我坚持在 lib/ 中的模块，然后从延迟作业的执行块中运行 ExitOnTermSignal.execute { long_running_task }。

```
# Exits whatever is currently running when a SIGTERM is received. Needed since
# Delayed::Job traps TERM, so it does not clean up a job properly if the
# process receives a SIGTERM then SIGKILL, as happens on Heroku.
module ExitOnTermSignal
  def self.execute(&block)
    original_term_handler = Signal.trap 'TERM' do
      original_term_handler.call
      # Easiest way to kill job immediately and having DJ mark it as failed:
      exit
    end

    begin
      yield
    ensure
      Signal.trap 'TERM', original_term_handler
    end
  end
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-04T08:35:03.557

我使用状态机来跟踪作业的进度，并使进程具有幂等性，因此我可以多次调用给定作业/对象的 perform 并确信它不会重新应用破坏性操作。然后更新 rake task/delayed_job 以释放 TERM 上的日志。

当进程重新启动时，它将按预期继续。

# events - 用于实时软件设计的事件时序可视化工具

> ID：10438101
> 
> 赞同：3
> 
> 时间：2012-05-03T19:30:05.883
> 
> 标签：events, real-time, visualization, scheduling, documentation-generation

我正在设计一个以给定间隔产生输出的实时系统，但长度有点复杂。我正在寻找一种工具，它可以生成事件时间线的图形表示，以用于文档或讨论。

例如，我可以指定 A 需要 10ns，B 需要 N*A ns，C 需要 40+B ns。根据事件 A+A+A+3*(B+A+B+C)+C+C+A 的顺序，向我显示事件发生时间的图形时间线。请注意，时间线以纳秒为单位，而不是天。

我考虑过 Verilog 或 SystemC 仿真，但这太过分了，我仍然希望输出比波形更好看。

有没有可以做这种事情的工具包（GoogleAPI？、Ruby on Rails？、Excel？、LaTex？），但我什么都不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T15:31:37.517

如果您需要高性能，您可以尝试[VTK](http://www.vtk.org/)。

如果您不需要高性能，您可以在[d3](http://d3js.org/)、[Processing](http://processing.org/)、[ProcessingJS](http://processingjs.org/)或[Protovis](http://mbostock.github.com/protovis/ex/)中执行此操作。它们都非常灵活，几乎可以让你做任何你想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T20:12:26.640

可调度性分析的常用工具是[TriPacific 的 RapidRMA](http://www.tripac.com/rapid-rma)。再加上 Rhapsody 或类似的东西，您可能能够完成您正在寻找的可视化类型。

# android - Android gridview 不会填满屏幕 - 只有很小的滚动

> ID：10438106
> 
> 赞同：1
> 
> 时间：2012-05-03T19:30:30.177
> 
> 标签：android

我遵循了本教程：

[http://mytelcoit.com/2010/02/programming-android-create-icon-with-text-using-gridview-and-layout-inflater/](http://mytelcoit.com/2010/02/programming-android-create-icon-with-text-using-gridview-and-layout-inflater/)

所以我的代码是一样的。我的问题是 gridView 只有大约 1 行高，带有滚动条，我无法让它填满屏幕。您必须向下滚动才能查看其他行。我不明白是什么变量使它填满了屏幕或它可用的空间——我尝试过改变明显的变量。

```
 GridView gridview = (GridView) findViewById(R.id.gridview);

    gridview.setAdapter(new ImageAdapter(this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:43:43.000

尝试在您的 XML 布局中设置`layout_with`和`layout_height``fill_parent`

或者

您必须根据其父类型以编程方式设置 GridView 的布局参数，例如`RelativeLayoutLayoutParams`，`LinearLayout.LayoutParams`...

```
gridView.setLayoutParams(new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT)); // for example with RelativeLayout 
```

# javascript - jquery bxslider 集成ajax

> ID：10438113
> 
> 赞同：1
> 
> 时间：2012-05-03T19:30:58.930
> 
> 标签：javascript, jquery, ajax, bxslider

我有这个 bxslider 代码。

```
$(function(){
  $('#slider1').bxSlider({
    infiniteLoop: false,
    hideControlOnEnd: true
  });
}); 
```

我有这个 ajax 代码：

```
$(function () {
$.get('/Scripts/PagedList/PagedList.Mvc.Template.html', function (pagerTemplate) { // get template for pager
// create our pager control object
var pagedList = $.pagedList(
$.template(null, pagerTemplate), // convert into compiled template
function(pageNumber){
return '/home/ajax/#' + pageNumber; // give the pager control the url for loading this page
},
{ pagesToDisplay: 10 } // optional page render options
);

function showNamesAndPagerControl(p) {
$.getJSON("/home/ajaxpage", { page: p ? p : 1 }, function (data) { // default to page 1
$("#namesList")
.attr("start", data.pager.FirstItemOnPage) // update the <li> numbers
.html($("#namesTemplate").tmpl(data.names)); // show the names for this page
$("#namesPager").html(pagedList.render(data.pager)); // update the pager control
}).error(function () {
// if we hit an error (such as a 404), try loading the first page
if (p !== 1) // don't do this if we just tried to load the first page
showNamesAndPagerControl(1);
});
}

// get current url hash (ex: "#3" for page 3)
var hash = window.location.hash;
if (hash)
hash = hash.slice(1); // chop off the leading "#"

// load whatever the currently requested page is
showNamesAndPagerControl(hash);

$(".PagedList-pager a").live("click", function (ev) {
ev.preventDefault(); // don't let the page actually navigate
var pageNumber = $(this).data('page'); // load the pagenumber from the link's data-pager attribute
showNamesAndPagerControl(pageNumber);
window.location.hash = pageNumber; // update the url hash
});
});
}); 
```

我想将此 ajax 集成到 bxslider。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:52:38.417

将它与 ajax 一起使用取决于您的数据如何从服务器返回。如果它回来了并且已经在服务器端进行了格式化，那么你应该可以这样做：

```
$.getJSON({
    success:function(data){
                $(data).appendTo($('wherever'));
                $(data).find('#yourItem').bxSlider();
            }
} 
```

如果它没有格式化服务器端，那么你只需要在你的 javascript 中格式化它，然后将 bxSlider() 应用到它。我觉得也许我不太明白你的问题？

如果您仍然遇到问题，如果您正在努力处理它的 ajax 部分，或者更多地应用 bxslider，请随时澄清一点。

# android - Android 如何同步一个布局视图？

> ID：10438116
> 
> 赞同：0
> 
> 时间：2012-05-03T19:31:22.170
> 
> 标签：android, scrollview, synchronized

我在*ScrollView中有一个**TableLayout* ，它由*AsyncTask*不断更新。

 **当用户可能正在滚动 TableLayout 时，我不知道通过*AsyncTask***添加/删除行是否“合法”。**

 *如何确保更新不会干扰 GUI 中的滚动？

或者操作系统会为我处理这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:04:59.923

在 Android 上，运行应用程序的主线程是唯一可以更新 UI 的线程。如果您尝试从 AsyncTask 中修改布局的内容，则会收到错误消息。但是， AsyncTask`onPreExecute`和`onPostExecute`方法在主线程上运行，因此您可以在那里更新 UI。

因此，要回答您的问题，是的，操作系统会通过不允许异步 UI 更新来为您解决这个问题。***

# ios - Facebook iOS SDK - 身份验证/登录页面上的语言错误

> ID：10438117
> 
> 赞同：9
> 
> 时间：2012-05-03T19:31:22.380
> 
> 标签：ios, facebook

我当前的应用程序与 facebook API 一起使用，今天它开始重定向用户以使用日语（或其他一些东方语言）登录 facebook。我很确定我的代码没有任何改变，我也再次从库中下载了 src 代码。

有人有同样的问题吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-04T16:59:41.703

也在这里看到它，截至今天早上（美国东部标准时间）。在所有应用程序以及 m.facebook.com 中看到它。显然，语言是印度尼西亚语。（例如“Dapatkan Facebook untuk iPhone dan menjelajah....”）

编辑：这显然是 Facebook 级别的问题。您可以在此处跟踪状态：

[http://developers.facebook.com/bugs/407246299295529?browse=search_4fa410ea79db26337556383](http://developers.facebook.com/bugs/407246299295529?browse=search_4fa410ea79db26337556383)

“使用 Facebook 首次登录时，要求用户授权此应用程序的对话框以看似随机的语言显示。仅当用户通过 Wifi 连接时才会发生。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-07T09:09:06.250

我在 Android 设备和 iPad 上遇到了同样的问题。

我也在此处发布此问题： [Android facebook sdk 中的示例始终显示语言为“Bahasa Indonesia”的身份验证页面](https://stackoverflow.com/questions/10417979/the-sample-of-in-facebook-sdk-for-android-always-displays-authentication-page-wi)

我在台湾，登录页面总是以印度尼西亚语显示。我使用的网络是中华电信 ADSL。

我尝试更改设备的网络提供商，例如 3G 模式或其他公共 wifi 服务。登录页面变成了我所在的语言。

我用这个网址[http://touch.whatsmyip.org/](http://touch.whatsmyip.org/)查看我的IP，当IP的起始部分是220.133.XX时，登录页面是错误的。

IP 为 101.10.XX 或 60.245.XX，登录页面以正确的语言显示。

# android - 由于 JIT，Bouncycastle AES 256 多线程解密速度下降

> ID：10438120
> 
> 赞同：2
> 
> 时间：2012-05-03T19:31:36.890
> 
> 标签：android, encryption, aes, jit, bouncycastle

我正在编写加密照片的应用程序，尽管它需要解密并在画廊中显示缩略图，如活动。然后，您当然可以单击并查看不同活动中的全尺寸图像。我正在使用带有 256 位密钥的 AES/CBC/PKCS7Padding 密码。我使用 PBEWithSHA256And256BitAES-CBC-BC 导出密码密钥并将其存储到内存中。然后所有需要进行加密/解密的线程都使用内存中的密钥来初始化 Cipher 对象。

所以这是我的问题。当我同时解密许多图像时（假设我需要显示画廊）并且在我尝试解密全尺寸图像之后，它非常慢。另一方面，如果我只解密一个图像（无论大小），然后去画廊然后解密全尺寸图像，它非常快。

我真的很困惑。

那么我做错了什么？也许 Bouncy Castle Crypto 库不是线程安全的？

**更新：**我发现这个问题与 JIT 有关。禁用 JIT 完全消除了任何处理速度差异。任何人都可以帮助理解如何优化代码以强制 JIT 在使用多线程解密照片以获得与开始时仅解密一张照片相同的速度时编译代码的正确部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T10:53:13.327

从我们上面的讨论中，性能下降的一个可能的罪魁祸首是大量的工作线程。限制线程数量的一种可能方法是使用固定（或上限）线程池，使用`java.util.concurrent`.

`Executors`您可以使用合适的静态工厂方法创建固定线程池执行服务。然后，您可以创建异步任务来解密单个缩略图并使用返回`ExecutorService`的实例的`submit()`方法填充 GridView 单元格。

另一种可能性可能是新的[Loaders API](http://developer.android.com/guide/topics/fundamentals/loaders.html) (developer.android.com)，但我不确定。我现在正在阅读它们以供我自己使用。因此，您可能需要查看文档。

[在这个答案](https://stackoverflow.com/a/6319593/391315)中还有另一种选择（stackoverflow.com）。

# php - php : xml节点内容编辑并返回xml

> ID：10438122
> 
> 赞同：0
> 
> 时间：2012-05-03T19:31:46.650
> 
> 标签：php, domdocument, ixmldomdocument

这是我的 XML`<response> <statusCode>200</statusCode> <statusText>OK</statusText> <data> <getAssetResponse> <assetId>89898</assetId> <content> some text with HTML content </content> </getAssetResponse> </data></response>`

在我的 php 中，我需要替换内容节点 substr（HTML 与 xhtml）并返回具有相同结构的 XML。

`<?php $file = file_get_contents("filx.xml"); $doc = DOMDocument::loadXML($file); $data = $dom->getElementsByTagName("data"); foreach($data as $node){echo "hello";}`

我的简单开始不起作用...我需要做什么才能获取节点内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:45:08.743

如果您只需要替换内容节点的内容，使用 SimpleXML 可能更容易，如下所示：

```
<?
$xml_object = simplexml_load_file("test.xml");
$xml_object->data->getAssetResponse->content = "Test 123";
print $xml_object->asXML();
?> 
```

结果：

```
<?xml version="1.0"?>
  <response>
    <statusCode>200</statusCode>
    <statusText>OK</statusText>
    <data>
      <getAssetResponse>
        <assetId>89898</assetId>
        <content>Test 123</content>
      </getAssetResponse> 
    </data>
  </response> 
```

# java - xstream 无法解决类异常

> ID：10438124
> 
> 赞同：11
> 
> 时间：2012-05-03T19:31:52.210
> 
> 标签：java, xstream

我正在尝试使用 xstream 1.4.2 将 xml 转换为对象。直到我将对象的类文件放在一个单独的包中，而不是主代码运行的地方，它对我来说确实工作得很好。然后我得到一个CannotResolveClassException。我试过使用其他人推荐的 setClassLoader 方法，但这没有帮助。

```
Exception in thread "main" com.thoughtworks.xstream.mapper.CannotResolveClassException: result
at com.thoughtworks.xstream.mapper.DefaultMapper.realClass(DefaultMapper.java:56)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.DynamicProxyMapper.realClass(DynamicProxyMapper.java:55)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.PackageAliasingMapper.realClass(PackageAliasingMapper.java:88)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.ClassAliasingMapper.realClass(ClassAliasingMapper.java:79)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.ArrayMapper.realClass(ArrayMapper.java:74)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.MapperWrapper.realClass(MapperWrapper.java:30)
at com.thoughtworks.xstream.mapper.CachingMapper.realClass(CachingMapper.java:45)
at com.thoughtworks.xstream.core.util.HierarchicalStreams.readClassType(HierarchicalStreams.java:29)
at com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller.java:133)
at com.thoughtworks.xstream.core.AbstractTreeMarshallingStrategy.unmarshal(AbstractTreeMarshallingStrategy.java:32)
at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:1052)
at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:1036)
at com.thoughtworks.xstream.XStream.fromXML(XStream.java:912)
at com.thoughtworks.xstream.XStream.fromXML(XStream.java:903)
at main.readClass(main.java:48)
at main.main(main.java:28) 
```

**答案：** xstream 期望 xml 结构与它（对象）源自的包相关。因此必须使用 xstream.alias 来为 xml 结构设置别名。

```
xstream.alias("something", Something.class); 
```

否则 xstream 会期望“Something”在默认包中，而不是它所属的包中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-31T14:24:23.967

当您将类名传递给别名方法时，您需要传递完全限定的类名，即类名及其包名。

示例：假设如果类 Something 在包 com.xyz 中，那么您需要将 com.xyz.Something.class 作为参数传递

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-20T14:41:16.470

对于您的问题，它将很有用

**下载 Xtream.jar**

```
package businessfunctions;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.TimeUnit;

import objectrepository.LoginPojo;
import objectrepository.LoginPojos;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;

import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.io.xml.DomDriver;

    public void readRepository(String fNmae){

        // Instantiate XStream Object
        XStream xstream = new XStream(new DomDriver()); 

        // Set Person class into xstream alias
        xstream.alias("loginpojos",LoginPojos.class);
        xstream.alias("loginpojo",LoginPojo.class);

        xstream.addImplicitCollection(LoginPojos.class, "loginpojos");

        // Create a StringBuffer var
        StringBuffer contents = new StringBuffer();

         try {
                // TODO Auto-generated method stub

                // Set BufferReader var "in" to read from PersonXML.xml file
                BufferedReader in = new BufferedReader(new FileReader(repoPath+fNmae));

                String str;

                while ((str = in.readLine()) != null) {
                contents.append(str);
                }

                in.close();

             } catch (IOException e) {
                    System.out.println(e.toString());
             }
            // Checking the StringBuffer variable "contents"
            System.out.println(contents);

            String content = new String();

            // Put all the contents from contents to String variable content --xstream.fromXML()takes
            //only String
            content = contents.toString();

            // Convert content into XML and change and set to obj newPerson of class Person
            LoginPojos loginPojosList = (LoginPojos)xstream.fromXML(content);

            List<LoginPojo> loginPojoList = loginPojosList.getLoginpojos();
            for(LoginPojo newLogiPojo:loginPojoList){
            // Print out the newPerson properties
            System.out.println("Property Label: " + newLogiPojo.getPropLabel());
            System.out.println("Property Name: " + newLogiPojo.getPropName());
            System.out.println("Property Value: " + newLogiPojo.getPropValue());
            }

             }

public static void main(String args[]) {
         try {
             DriverSetup ds= new DriverSetup();
             ds.readRepository("login.xml");  

         }catch(Exception e){
            e.printStackTrace(); 
         }

package objectrepository;

import java.util.ArrayList;
import java.util.List;

public class LoginPojos {

     public List<LoginPojo> loginpojos = new ArrayList<LoginPojo>();

    public List<LoginPojo> getLoginpojos() {
        return loginpojos;
    }

    public void setLoginpojos(List<LoginPojo> loginpojos) {
        this.loginpojos = loginpojos;
    }

}

package objectrepository;

public class LoginPojo {

    private String propLabel;
    private String propName;
    private String propValue;
    public String getPropLabel() {
        return propLabel;
    }
    public void setPropLabel(String propLabel) {
        this.propLabel = propLabel;
    }
    public String getPropName() {
        return propName;
    }
    public void setPropName(String propName) {
        this.propName = propName;
    }
    public String getPropValue() {
        return propValue;
    }
    public void setPropValue(String propValue) {
        this.propValue = propValue;
    }

}

<loginpojos>
<loginpojo>
<propLabel>User name1</propLabel>
<propName>id1</propName>
<propValue>username1</propValue>
</loginpojo>
<loginpojo>
<propLabel>User name</propLabel>
<propName>id</propName>
<propValue>username</propValue>
</loginpojo>
</loginpojos> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-22T16:54:54.943

花了半个晚上试图解决类似的错误。
将驱动程序传递给 xStream 奇迹般地有所帮助。

```
XStream xstream = new XStream(new StaxDriver()); 
```

# jakarta-ee - 是否有 Java EE JDK

> ID：10438127
> 
> 赞同：19
> 
> 时间：2012-05-03T19:31:58.367
> 
> 标签：jakarta-ee, java

我知道这已经被问了一百万次并且我确实做了功课，但我不完全理解的最后一件事是，是否有“Java **EE** JDK”？

当我下载 SDK 时，它会尝试安装很多我不想要的垃圾。所以我做了一些阅读并意识到实际上 Java SDK 是一组在技术上与 JDK 无关的工具。所以我正在寻找的只是一个干净简单的 JDK 独立下载。

我们知道“Java SE JDK”一直[可以](http://www.oracle.com/technetwork/java/javase/downloads/index.html)从 Sun（现在的 Oracle）网站获得。但是，我正在开发一个 Web 应用程序并且对 Java EE 的*一些*特性感兴趣：javax.servlet、javax.validation、javax.persistence 和 javax.transaction。所以实际上我真正在寻找的是“Java EE JDK”。

我使用的是典型的 Maven / Tomcat / Spring / Hibernate 设置，过去我总是在 Maven 提供的范围内为 Java EE 规范的这些部分添加仅 API 依赖项到我的项目中，即：

```
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>2.5</version>
</dependency> 
```

因此，如果我为我的项目所需的所有 Java EE API 执行此操作，那么我实际上是在使用 Java SE JDK 和一些额外的手动声明的 Java EE 组件。此外，当我指示我的 IDE 使用 Java EE SDK 安装附带的 JDK 时，这些额外的命名空间不可用。

换句话说，从所有意图和目的来看，Java EE SDK 下载附带的 JDK 似乎等同于我在安装“Java SE JDK”时获得的 JDK……如果这是正确的，那么有我不需要安装 Java EE SDK，我可以简单地使用 Java (SE) JDK，按照我上面描述的方式将我需要的任何 Java EE 组件声明为 *-api/provided 依赖项。

所以我的问题是：我上面描述的是正确的方法，还是有“Java EE JDK”之类的东西？即带有诸如javax.servlet 和javax.resources 之类的未实现接口的JDK？如果存在这样的野兽，我该从哪里下载？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-08T13:15:30.587

您要问的是“我可以在没有 GlassFish、NetBeans 等的情况下一次性下载所有 EE 组件吗”。

确切地知道 Java EE 到底是什么是很有帮助的。这是一组有时相关/有时不相关的“企业”级组件的规范（无论企业是什么意思:)）。例如，servlet-api 规范（如上一个答案所示）是 Java EE 规范的一部分。JTA（事务 API）、JPA、Java Mail 等也是如此。

EE 组件有两种类型。1\. 仅作为接口提供的那些，应用程序服务器或第三方实现它们。例如 JTA、JPA、Servlet-API。2\. 作为完整参考实现发布的那些。例如 Java-Mail。我无法想到其他人，但会有一些。

现在，一个完整的应用程序服务器，例如 glassfish，附带了一组实现，所以很多时候人们在 Glassfish、Websphere 等中看到它们并认为他们需要这些实现来使用它们。诸如 Tomcat 之类的容器不是应用程序服务器，它是一个 servlet 容器，因此仅实现了完整 Java EE 堆栈的一个子集（仅 servlet 所需的部分）。

为了获得全套 Java EE 接口/实现，您需要将单独的接口或实现添加到您的构建中。在这种情况下，您只需要“知道”在哪里可以找到它们，而这取决于经验。例如，人们倾向于知道 JPA 是作为 Hibernate 依赖项的一部分添加的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-19T17:20:51.240

在下载 JDK 时，只有一个 JDK，无论是从 Java SE 下载还是从 Java EE 下载。

不同之处在于，当您从 Java EE 下载中下载它时，它被打包在一个 SDK 中。SDK 附带 Glassfish、代码示例、API 文档、教程。我真的不需要这些，所以我更喜欢从 Java SE 下载中下载。

在 Maven JavaEE 项目中，您将指定对 Java EE 库的依赖关系。在 jboss AS7 的情况下，您使用 jboss-spec 依赖项，它可以让您对所有 Java EE 类进行导入。应用服务器负责提供实现 Java EE API 的类：

```
<dependency>
   <groupId>org.jboss.spec</groupId>
   <artifactId>jboss-javaee-6.0</artifactId>
   <version>3.0.2.Final-redhat-3</version>
   <type>pom</type>
   <scope>import</scope>
</dependency> 
```

如果您想查看这个 pom 导入的 javaEE 工件，请查看： [http ://maven.repository.redhat.com/techpreview/eap6/6.1.0/maven-repository/org/jboss/spec/jboss- javaee-6.0/3.0.2.Final-redhat-3/jboss-javaee-6.0-3.0.2.Final-redhat-3.pom](http://maven.repository.redhat.com/techpreview/eap6/6.1.0/maven-repository/org/jboss/spec/jboss-javaee-6.0/3.0.2.Final-redhat-3/jboss-javaee-6.0-3.0.2.Final-redhat-3.pom)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T19:59:19.293

一般来说，你或多或少是正确的。

应用服务器通常提供 Java EE API 以及 Java EE API 的实现。因此，如果您想使用与应用程序服务器相同的版本，请使用：

```
<dependency>
   <groupId>javax.servlet</groupId>
   <artifactId>servlet-api</artifactId>
   <version>2.5</version><!-- or whatever version your application server provides -->
   <scope>provided</scope>
</dependency> 
```

如果你想使用更新的版本，你应该省略提供的范围。

如果您想使用更新或不同的实现（例如 EclipseLink 而不是 Hibernate），您还必须为实现添加依赖项。否则你可以省略它。

# ruby-on-rails - RoR 用户管理和字典教程推荐

> ID：10438132
> 
> 赞同：0
> 
> 时间：2012-05-03T19:32:08.290
> 
> 标签：ruby-on-rails

我已经有将近 4 年没有接触过 ROR 了。

我有一个应用程序的想法，该应用程序将依赖用户输入来构建字典，其他用户可以添加到字典中 - 基本上是一个 wiki。

任何人都可以建议一个很好的教程来让我了解创建用户模型、身份验证和其他基本内容。

我还读到 rails 3.2 使用户身份验证更加简单和稳定。听起来对吗？

我在运行 10.7 的 Mac 上，我有 Xcode 4.3.2 和文本伴侣 - 如果其中任何一个有用的信息。

多谢你们！

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T08:57:22.090

我真的很喜欢这个 railscast，你可能也喜欢

[http://railscasts.com/episodes/250-authentication-from-scratch](http://railscasts.com/episodes/250-authentication-from-scratch)

# php - 如何使用 .htaccess 或 php.ini 使用 gzip 压缩来优化 php 文件？

> ID：10438135
> 
> 赞同：1
> 
> 时间：2012-05-03T19:32:25.033
> 
> 标签：php, apache, .htaccess, gzip

我使用的是[http://html5boilerplate.com/](http://html5boilerplate.com/)`.htaccess`提供的，它可以正确压缩 .html、.css 和 .js 文件，但除非我添加到顶部，否则我无法压缩 .php 文件这页纸。我要做的最后一件事是将该行添加到一百多页。`<?php if (substr_count($_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip')) ob_start("ob_gzhandler"); else ob_start(); ?>`

我一直在使用以下两个站点来验证 gzip 压缩：

*   [http://www.whatsmyip.org/http-compression-test/](http://www.whatsmyip.org/http-compression-test/)
*   [http://www.gidnetwork.com/tools/gzip-test.php](http://www.gidnetwork.com/tools/gzip-test.php)

以下建议也没有奏效：

*   [通过.htaccess的Gzip压缩不起作用](https://stackoverflow.com/questions/5846376/gzip-compression-through-htaccess-not-working)
*   [如何在 .htaccess 或 php.ini 中使用 gzip？](https://stackoverflow.com/questions/10217410/how-do-you-use-gzip-in-htaccess-or-php-ini)

我还尝试了以下方法（[http://perishablepress.com/fast-effective-php-compression/](http://perishablepress.com/fast-effective-php-compression/)）：

```
<?php // placed in a gzip_start.php file
ob_start("ob_gzhandler");
?>

<?php // placed in a gzip_stop.php file
ob_flush();
?>

# Placed in the .htaccess filew
# dual file includes for PHP compression
php_value  auto_prepend_file  /specify/full/path/to/gzip_start.php
php_value  auto_append_file   /specify/full/path/to/gzip_stop.php 
```

`.htaccess`这是我文件的 Gzip 部分：

```
# ----------------------------------------------------------------------
# Gzip compression
# ----------------------------------------------------------------------

<IfModule mod_deflate.c>

# Force deflate for mangled headers developer.yahoo.com/blogs/ydn/posts/2010/12/pushing-beyond-gzipping/
<IfModule mod_setenvif.c>
  <IfModule mod_headers.c>
    SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s,?\s(gzip|deflate)?|X{4,13}|~{4,13}|-{4,13})$ HAVE_Accept-Encoding
    RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
  </IfModule>
</IfModule>

# HTML, TXT, CSS, JavaScript, JSON, XML, HTC:
<IfModule filter_module>
  FilterDeclare   COMPRESS
  FilterProvider  COMPRESS  DEFLATE resp=Content-Type /text/(html|css|javascript|plain|x(ml|-component))/
  FilterProvider  COMPRESS  DEFLATE resp=Content-Type /application/(javascript|json|xml|x-javascript)/
  FilterChain     COMPRESS
  FilterProtocol  COMPRESS  change=yes;byteranges=no
</IfModule>

<IfModule !mod_filter.c>
  # Legacy versions of Apache
  AddOutputFilterByType DEFLATE text/text text/html text/plain text/css application/json
  AddOutputFilterByType DEFLATE text/javascript application/javascript application/x-javascript 
  AddOutputFilterByType DEFLATE text/xml application/xml text/x-component
</IfModule>

# Webfonts and SVG:
  <FilesMatch "\.(ttf|otf|eot|svg|php)$" >
    SetOutputFilter DEFLATE
  </FilesMatch>
</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-14T04:47:01.350

**像这样编辑您的 .htaccess 文件**

```
# 压缩文本、html、javascript、css、xml：
AddOutputFilterByType DEFLATE 文本/纯文本
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE 文本/xml
AddOutputFilterByType DEFLATE 文本/css
AddOutputFilterByType DEFLATE 应用程序/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE 应用程序/javascript
AddOutputFilterByType DEFLATE 应用程序/x-javascript

# 或者，按扩展名压缩某些文件类型：

<文件 *.html >
SetOutputFilter DEFLATE
 </文件>

<文件 *.css>
SetOutputFilter DEFLATE
 </文件>

<文件 *.js >
SetOutputFilter DEFLATE
 </文件>

<文件 *.img >
SetOutputFilter DEFLATE
 </文件>

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-19T13:05:46.483

如果您有带有 .php 扩展名的视图。您必须将其添加到 .htaccess 文件中

```
<files *.php >
SetOutputFilter DEFLATE
 </files> 
```

# ios - 是否有任何 iOS 库允许异步且可靠地发送 POST 消息？

> ID：10438136
> 
> 赞同：1
> 
> 时间：2012-05-03T19:32:25.527
> 
> 标签：ios, ios5

我想将一些数据发送到接受 POST 数据的 Web 服务。

但是，如果互联网连接断开，那么我需要对数据进行排队。即缓存它并在下一个可用的机会发送它。

是否有任何 iOS 库可以帮助解决这个问题？

目前我正计划使用 ASIFormDataRequest 来执行此操作，如果失败，则使用 NSUserDefaults 存储数据。然后，我假设我需要通过以下方式在后台完成该过程：

*   使用 NSOperation 查找连接，该连接使用 NSNotification 标记连接
*   从 NSUserDefaults 读取数据
*   发送此数据
*   从 NSUserDefaults 中删除数据

看起来工作量不大，但我是在这里重新发明轮子还是这是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T10:01:42.523

我通常最终使用 ASIFormDataRequest 并使用 NSThread 来分离一个新线程以及调用。然后我让它在完成后调用我自己的委托/协议：

```
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:[NSURL URLWithString:@"some_url"]];
[request setUseKeychainPersistence:YES];
[request addRequestHeader:@"Content-Type" value:@"application/json"];
for (NSString *key in dictionary) {
    [request setPostValue:[dictionary objectForKey:key] forKey:key];
}
[request startSynchronous];
if([request responseStatusCode] == 200)
{
    NSString *response = [NSString stringWithFormat:@"%@", [request responseString]];
    if ([self _isValidDelegateForSelector:@selector(requestSucceeded)]) {
        [_delegate requestSucceeded];
    }
    if ([self _isValidDelegateForSelector:@selector(itemAdded:)]) {
        [_delegate itemAdded:[response JSONValue]];
    }
}
else {
    if ([self _isValidDelegateForSelector:@selector(requestFailedWithError:)])
        NSLog(@"%@", [request debugDescription]);
    [_delegate requestFailedWithError:[request error]];
} 
```

这一切都是在我自己的“API”对象中完成的，该对象包含对 Web 服务的所有调用，因此我调用`startSynchronous`而不是异步调用，因为我无论如何都在不同的线程中处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T09:58:09.767

请查看 Github 上的 AFNetworking 框架，这可能是您正在寻找的：[https ://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

# c++ - 在 Visual C++ 2010 中构建 Tesseract

> ID：10438148
> 
> 赞同：4
> 
> 时间：2012-05-03T19:33:32.190
> 
> 标签：c++, tesseract

当我尝试在 Visual C++ 2010 Express 中构建 Tesseract 解决方案时，它说：

```
21>C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppCommon.targets(113,5): error MSB3073: The command "post-build.cmd "C:\Tesseract-OCR\tesseract-3.01\vs2010\Release\" "C:\Tesseract-OCR\tesseract-3.01\vs2010\bin.rel"
21>C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppCommon.targets(113,5): error MSB3073: :VCEnd" exited with code 4.
========== Build: 20 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我不知道该怎么做。有谁知道问题是什么以及我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T10:52:06.980

您必须编辑 [tesseract source]\vs2010 文件夹中的 post-build.cmd 文件，如下所示打开文件，例如在 Notepad++ 中，然后“rem”以下行：

```
xcopy ..\vs2008\lib\liblept168%DebugVersion%.dll %TargetFolder% /Y /I /D
rem copy data
if not exist %DataFolder% (
   md %DataFolder%
)
xcopy ..\TessData\eng.traineddata %DataFolder% /Y /I /D 
```

如果您之前安装了可执行文件，这应该可以做到。由于在函数中从“mainblk.cpp”文件中的环境变量 ( ) 中`tesseract`获取文件夹，因此无需按照 post-build.cmd 中的说明复制数据文件夹。`\tessdata\``TESSDATA_PREFIX``main_setup`

如果您没有安装可执行文件，则必须手动创建此变量。该值应指示 \tessdata\ 所在的文件夹，而不是 \tessdata\ 本身，因为 main_setup 的最后一行`\tessdata`被添加到路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T07:47:55.790

您可能没有正确安装[tesseract-ocr-3.01.eng.tar.gz](http://tesseract-ocr.googlecode.com/files/tesseract-ocr-3.01.eng.tar.gz)。

从他们的[自述文件中](http://code.google.com/p/tesseract-ocr/wiki/ReadMe)：

> 下载这些软件包：
> 
> tesseract-3.01.tar.gz - tesseract 源
> 
> tesseract-3.01-win_vs.zip - 带有必要库的 Visual Studio（2008 和 2010）解决方案
> 
> tesseract-ocr-3.01.eng.tar.gz - tesseract 的英文文件（或下载其他 3.01 或 3.00 语言数据文件）
> 
> 将它们解压到一个目录（'tesseract-3.01'）。tesseract-ocr-3.01.eng.tar.gz 的根目录名称错误（“tesseract-ocr”而不是“tesseract-3.01”）。Windows 相关文件位于 vs2008 目录中（例如“tesseract-3.01\vs2008”）。与通常相同的构建过程适用：使用 VC++Express 2008 打开 tesseract.sln 并构建所有（或只是 Tesseract）它应该编译（至少在发布模式下），而无需进一步安装任何东西。包括 dll 依赖项和 Leptonica。输出将在 tesseract-3.01\vs2008\bin （或 tesseract-3.01\vs2008\bin.rd 或 tesseract-3.01\vs2008\bin.dbg 基于配置构建）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T12:36:10.080

以管理员身份运行 vs2010 并按照 raym0nd 的建议重新构建。它对我有用。

# c++ - 如何在 std::map 类中定义迭代器

> ID：10438152
> 
> 赞同：0
> 
> 时间：2012-05-03T19:33:35.920
> 
> 标签：c++, stl, iterator, compiler-errors

我需要帮助来定义专业`map`，我无法获得专业的 map::iterator 来正确编译。

我如何需要为`find()`调用定义这个迭代器？

代码：

```
// My case-insensitive-less functor, which has historically worked fine for me:
struct ci_less : std::binary_function<std::string, std::string, bool>
{
  // case-independent (ci) compare_less binary function
  struct nocase_compare : public std::binary_function<unsigned char,unsigned char,bool>
  {
    bool operator() (const unsigned char& c1, const unsigned char& c2) const {
      return tolower (c1) < tolower (c2);
    }
  };
  bool operator() (const std::string & s1, const std::string & s2) const {
    return std::lexicographical_compare (s1.begin (), s1.end (),
                                         s2.begin (), s2.end (),
                                         nocase_compare());  // comparison
  }
};

//My offending code:
template <class T>
class CaseInsensitiveMap : public map<string, T, ci_less>
{
 public:
// This one actually works, but it requires two "find()" calls.
// I can't ethically call find twice.
  const T* lookup(const T& key) const {
    if (find(key) == map<string, T, ci_less>::end()) return 0;
    else                                             return &find(key)->first;
  }
// This one complains with errors shown below.
  T* lookup(const T& key) {
    CaseInsensitiveMap<T>::iterator itr = find(key);
    if (itr == map<string, T, ci_less>::end()) return 0;
    else              return itr->second;
  }
}; 
```

错误：

> 在成员函数中`'T* CaseInsensitiveMap<T>::lookup(const T&)'`：错误：错误之前
>     预期     ：未在此范围内声明`';'``'itr'`
> `'itr'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:38:50.520

将`typename`关键字添加到变量的类型：

```
typename CaseInsensitiveMap<T>::iterator itr = find(key); 
```

无论如何，您不应该继承 STL 容器。阅读为什么你不应该[在这里](https://stackoverflow.com/questions/2034916/is-it-okay-to-inherit-implementation-from-stl-containers-rather-than-delegate)这样做。

**编辑**：由于您要实现的只是一个不区分大小写的映射，因此您可以通过这种方式实现它，无需继承`std::map`，只需提供您自己的比较对象：

```
#include <iostream>
#include <map>
#include <string>

using namespace std;

struct nocase_compare {
    bool operator() (const unsigned char& c1, const unsigned char& c2) const {
      return tolower (c1) < tolower (c2);
    }
};

struct map_comparer {
  bool operator() (const std::string & s1, const std::string & s2) const {
    return std::lexicographical_compare (s1.begin (), s1.end (),
                                         s2.begin (), s2.end (),
                                         nocase_compare());  // comparison
  }
};

template<class T>
struct CaseInsensitiveMap {
    typedef std::map<std::string, T, map_comparer> type;
};

int main() {
    CaseInsensitiveMap<int>::type my_map;
    my_map["foo"] = 12;
    std::cout << my_map["FoO"] << "\n";
    my_map["FOO"] = 100;
    std::cout << my_map["fOo"] << "\n";
} 
```

这输出：

```
12
100 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:39:34.313

**类型名 CaseInsensitiveMap::iterator itr = find(key) **;****

 **在第 31 行**

# gcc - 我可以将 arm-eabi 与 arm-elf 混合使用吗？

> ID：10438158
> 
> 赞同：6
> 
> 时间：2012-05-03T19:33:52.600
> 
> 标签：gcc, embedded, arm, eabi

我有一个产品，它使用生成“arm-elf”的编译器（gnuarm GCC 4.1.1）编译引导加载程序和应用程序。

引导加载程序和应用程序在链接描述文件中被隔离在不同的 FLASH 存储区中。

该应用程序具有一项功能，可以调用引导加载程序（作为具有 2 个参数的简单 c 函数）。

我需要能够升级世界各地的现有产品，并且我可以使用始终使用相同的编译器安全地做到这一点。

现在我希望能够使用输出 arm-eabi 的新 GCC 版本来编译这个产品应用程序。

对于新产品来说一切都会好起来的，其中应用程序和引导加载程序都是使用相同的工具链编译的，但是现有产品会发生什么？如果我刷新一个使用 GCC 4.6.x 和 arm-none-eabi 编译的新应用程序，我的应用程序是否仍然能够从旧的 arm-elf 引导加载程序调用引导加载程序函数？

* * *

此外，与上述问题没有直接关系，我可以将使用 arm-elf 编译的目标文件混合到使用 arm-eabi 编译的二进制文件中吗？

* * *

编辑：

我认为很清楚我正在为裸机 ARM7 构建，如果它有什么不同的话......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:36:31.630

不，ABI 是使二进制文件兼容的魔法。应用程序二进制接口决定了如何与其他库/应用程序通信的各种约定。例如，ABI 将定义调用约定，它会隐含假设哪些寄存器用于将参数传递给 C 函数，以及如何处理多余的参数。

我不知道 EABI 和 ABI 之间的确切区别，但您可以通过阅读 EABI 找到其中的一些。[Debian 的页面](http://wiki.debian.org/ArmEabiPort)提到系统调用约定是不同的，以及一些对齐更改。

鉴于上述情况，当然，您不能混合 arm-elf 和 arm-eabi 对象。

上面的答案是在您与主应用程序中的引导加载程序代码对话的假设下给出的。鉴于接口可能非常简单（只是一个带有两个参数的函数调用），它可能会起作用。这将是一个有趣的尝试。但是，不能**保证**工作。

请记住，您不必使用 EABI。您可以使用 gcc 4.6 以及旧版本生成 arm-elf 工具链。由于您在 Windows 上使用二进制工具链，因此您可能面临更多挑战。我建议调查[crosstool-ng](http://crosstool-ng.org/)，它在 Linux 上运行良好，并且可能在 cygwin 上运行良好以构建适当的工具链。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-04T16:59:22.353

始终可以选择在内联汇编中调用引导加载程序，在这种情况下，您可以遵守您需要的任何调用标准:)。

但是，除了它引入的可移植性问题之外，这种方法还会对您的引导加载程序和应用程序做出两个假设：

*   您可以在您的应用程序中检测到特定设备具有使用非 EABI 工具链构建的引导加载程序，因为您只能使用汇编代码调用旧类型的引导加载程序。
*   您提到的两个参数被引导加载程序用作原始数据。例如，如果引导加载程序将它们用作指向结构的指针，那么您可能会面临对齐不正确、填充等问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T17:13:24.723

我*认为*这会好起来的。我自己进行了类似的迁移，据我所知，我只遇到了与处理除法有关的问题。

[这是我能找到的关于差异的最佳信息](http://wiki.debian.org/ArmEabiPort)，它表明如果你没有结构对齐问题，你可能没问题。

# algorithm - 在 OpenCL 中查找浮点数组最大值的快速方法

> ID：10438160
> 
> 赞同：0
> 
> 时间：2012-05-03T19:34:04.503
> 
> 标签：algorithm, opencl, multicore, max

在 OpenCL 中查找数组最大值的简单任务遇到了麻烦。

```
__kernel void ndft(/* lots of stuff*/)
{
    size_t thread_id = get_global_id(0); // thread_id = [0 .. spectrum_size[

    /* MATH MAGIC */

    // Now I have    float spectrum_abs[spectrum_size]    and
    // I want the maximum as well as the index holding the maximum

    barrier();
    // this is the old, sequential code:
    if (*current_max_value < spectrum_abs[i])
    {
        *current_max_value = spectrum_abs[i];
        *current_max_freq = i;
    }
}
```

现在我可以`if (thread_id == 0)`像在单核系统上那样添加和循环整个事情，但是由于性能*是*一个关键问题（否则我不会在 GPU 上进行频谱计算），有没有更快的方法来做到这一点?

在上面的内核结束时返回 CPU 不是一种选择，因为内核实际上在那之后继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T21:05:48.500

您将需要编写并行归约。将您的“大”数组分成小块（单个工作组可以有效处理的大小）并计算每个小块。

反复执行此操作（涉及主机和设备代码），直到您只剩下一组最小值/最大值。

请注意，您可能需要编写一个单独的内核来执行此操作**，除非当前的工作分发适用于这部分内核**（请参阅我上面的问题）。

如果您当前的工作分配适合，另一种方法是找到每个工作组内的最小最大值并将其写入全局内存中的缓冲区（索引 = local_id）。在barrier（）之后，只需让运行在thread_id == 0 上的内核循环遍历减少的结果并找到其中的最大值。这不是最佳解决方案，但可能适合您当前的内核。

# sql - sql邻接列表CTE：过滤/限制为仅完整路径

> ID：10438161
> 
> 赞同：1
> 
> 时间：2012-05-03T19:34:07.810
> 
> 标签：sql, tree, adjacency-list

我已经构建了一个函数/查询，该函数/查询将 [paths] 作为邻接列表返回，如下所示，它运行良好，但是我试图弄清楚如何将结果限制为仅完整的路径，而不是深度（n）的每次迭代。

例如，在下面显示的以下结果中，只有这些是有效的，我想要返回或过滤的完整路径：

```
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB1_Close
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB1_Open
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB2
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Close>S2-UG
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Open>S1-UG 
```

测试

select * from fn_Get_SubTreePaths('S11', 11) order by DPath

## 结果

```
S11>S11-LG
S11>S11-LG>V613
S11>S11-LG>V613>V613_Close
S11>S11-LG>V613>V613_Close>B31A
S11>S11-LG>V613>V613_Close>B31A>B30
S11>S11-LG>V613>V613_Close>B31A>B30>B30A
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB1_Close
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB1_Open
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Close>B-GARNER>VB1>VB2
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Close
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Close>S2-UG
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Open
S11>S11-LG>V613>V613_Close>B31A>B30>B30A>V30A1>V30A1_Open>V30A2>V30A2_Open>S1-UG 
```

换句话说 - 我如何才能确定仅包含遍历/深度中最底部项目的那些路径？

任何帮助将不胜感激！我正在阅读 Joe Celko 为 Smarties 编写的 SQL 中的树和层次结构 - 但到目前为止，我还没有思考如何正确限制结果......

这是代码；

```
create function [dbo].[fn_Get_SubTreePaths]( @Start varchar(20), @MaxLevels int)
returns table 
as
RETURN(
    WITH CTE AS (
    SELECT 
        c.DeviceID AS Start,
        CAST(d.DeviceName AS VARCHAR(2000)) AS Path, 
        c.ConnectedDeviceID, 
        1 AS Level
    FROM Connections c
    INNER JOIN Devices d ON d.ID=c.DeviceID
                        AND d.DeviceName=@Start
    UNION ALL
    SELECT 
        r.Start, 
        CAST(r.Path + '>'+ d.DeviceName AS VARCHAR(2000)), 
        --CAST(r.Path + ' -> ' + d.DeviceName + '-' + cast(r.SLevel as varchar) AS VARCHAR),
        c.ConnectedDeviceID, 
        Level = r.Level + 1
    FROM Connections c
    INNER JOIN Devices d ON d.ID=c.DeviceID
                        and d.DeviceName<>@Start
    INNER JOIN CTE r ON c.DeviceID=r.ConnectedDeviceID
      AND r.Level < @MaxLevels
    )

    SELECT 
      DISTINCT a.DPath
      FROM (
        SELECT c.Path + '>' + ISNULL(d.DeviceName,'?')  AS DPath
        FROM CTE c
        INNER JOIN Devices d ON d.ID=c.ConnectedDeviceID
        ) a    
    )                                  

CREATE TABLE [dbo].[Connections](
    [ID] [int] NOT NULL,
    [DeviceID] [int] NULL,
    [ConnectedDeviceID] [int] NULL
 CONSTRAINT [PK_Connections] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE TABLE [dbo].[Devices](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [DeviceName] [varchar](50) NULL
 CONSTRAINT [PK_Devices] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

CTE 使用的视图：

```
ALTER view [dbo].[vw_DeviceConnections] as
select 
  c.ID as ID,
  c.DeviceID as DeviceID,
  d.DeviceName,
  d.DeviceType,
  c.ConnectedDeviceID as ConnDeviceID,
  cd.DeviceName as ConnDeviceName,
  cd.DeviceType as ConnDeviceType
from Devices d  
inner join Connections c on
   d.id=c.DeviceID
inner join Devices cd on
   cd.id=c.ConnectedDeviceID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:05:35.107

**[请参阅此处](http://sqlfiddle.com/#!3/a6f41/3)在 SQLFiddle 上工作的答案。**

这是我的策略：让你的递归 CTE 返回当前节点以及它之前的节点。然后，您可以将其加入自身并将其限制为最后一个节点未用作另一个节点的父节点的行。

这是您的函数的外观（用您的参数替换 'S11' 和 15）：

```
WITH CTE AS (
  SELECT
    d.ID AS Start,
    CAST(d.DeviceName AS VARCHAR(2000)) AS Path, 
    d.ID AS node,
    NULL AS parent,
    1 AS Level
  FROM Devices d
  WHERE d.DeviceName= 'S11'
UNION ALL
  SELECT 
    r.Start, 
    CAST(r.Path + '>'+ d.DeviceName AS VARCHAR(2000)), 
    d.ID as node,
    r.node as parent,
    r.Level + 1 as Level
  FROM CTE r
    INNER JOIN Connections c ON c.DeviceID = r.node
    INNER JOIN Devices d ON d.ID = c.ConnectedDeviceID
  WHERE r.Level < 15
),
Trimmed as (
  SELECT L.*
  FROM CTE L
    LEFT JOIN CTE R on L.node = R.parent
  WHERE R.parent IS NULL
)   
SELECT * FROM Trimmed 
```

如果您想了解它的工作原理，请告诉我，我可以尝试更好地解释它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:15:38.393

尝试下一个解决方案

```
select 
    *
from 
    fn_Get_SubTreePaths('S11', 11) f1
where
    (
        select
            count(*)
        from
            fn_Get_SubTreePaths('S11', 11) f2
        where
            charindex(f1.dPath, f2.dPath) > 0
    ) = 1

order by DPath 
```

# javascript - 为什么 Chrome 和 Safari 看不到某些子域的 cookie？

> ID：10438165
> 
> 赞同：3
> 
> 时间：2012-05-03T19:34:33.780
> 
> 标签：javascript, google-chrome, cookies, safari

我有一个为 example.com 生成 cookie 的网站。它可以在 Firefox、Chrome 18 和 Safari 中通过[http://example.com](http://example.com)和[http://www.example.com 访问](http://www.example.com)。但是，我无法在 webkit 派生的浏览器中从[http://test.me.example.com访问 cookie。](http://test.me.example.com)它适用于火狐。

在从 javascript 设置 cookie 时，我已经使用 domain= example.com 和 .example.com 之一对此进行了测试。

cookie 的路径为 / 并设置了过期时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-24T04:37:27.487

你如何指定子域？Chrome 期望子域的 cookie 以点为前缀，例如 domain=.example.com

您可能会发现这篇文章很有用：[https ://serverfault.com/questions/153409/can-subdomain-example-com-set-a-cookie-that-c​​an-be-read-by-example-com](https://serverfault.com/questions/153409/can-subdomain-example-com-set-a-cookie-that-can-be-read-by-example-com)

> 引用您阅读的同一 RFC2109：
> 
> ```
>  * A Set-Cookie from request-host x.foo.com for Domain=.foo.com would
>      be accepted. 
> ```
> 
> 所以 subdomain.example.com 可以为 .example.com 设置一个 cookie。到目前为止，一切都很好。
> 
> ```
>  The following rules apply to choosing applicable cookie-values from
>    among all the cookies the user agent has.
> 
>    Domain Selection
>         The origin server's fully-qualified host name must domain-match
>         the Domain attribute of the cookie 
> ```
> 
> 那么我们有域匹配吗？
> 
> *   A 是 FQDN 字符串，格式为 NB，其中 N 是非空名称字符串，B 格式为 .B'，B' 是 FQDN 字符串。（因此，xycom 域匹配 .y.com 而不是 y.com。）但是现在 example.com 不会根据定义与 .example.com 域匹配。但是 www.example.com （或域中的任何其他“非空名称”）> > 会。该 RFC 理论上已被 RFC2965 淘汰，后者规定了在 Set-Cookie2 操作上强制域的前导点。
> 
> 正如@Tony 所指出的，更重要的是现实世界。有关实际用户代理正在做什么的一瞥，请参阅
> 
> Firefox 3 的 nsCookieService.cpp 和
> 
> Chrome 的 cookie_monster.cc 要了解实际站点在做什么，请尝试使用 wget 使用 > --save-cookies、--load-cookies 和 --debug 来查看发生了什么。
> 
> 您可能会发现，实际上大多数站点都在使用旧 RFC 规范中的 Set->> Cookie 与“Host”值的某种组合，隐含地没有前导点（如 twitter.com 所做的）或设置域值（带有前导点）并重定向到像 www.example.com 这样的服务器（就像 google.com 一样）。

# .net - WPF DataGrid 中的 TextBlock 上未调用 Validation.ErrorChangedHandler

> ID：10438173
> 
> 赞同：1
> 
> 时间：2012-05-03T19:35:16.957
> 
> 标签：.net, wpf, validation, datagrid

我有一个非常简单的 DataGrid 绑定到自定义对象的集合。自定义对象使用 DataAnnotations 进行注释并实现 IDataErrorInfo。

```
public class MyObject : IDataErrorInfo {
    [Required(ErrorMessageResourceName = "Amount_Required", ErrorMessageResourceType = typeof(Resources))]
    [Range(typeof(decimal), "0", "1000000000", ErrorMessageResourceName = "InventoryCost_Amount_Invalid", ErrorMessageResourceType = typeof(Resources))]
    public decimal? Amount { get; set; }

    [Required(ErrorMessageResourceName = "Name_Required", ErrorMessageResourceType = typeof(Resources))]
    [StringLength(50, ErrorMessageResourceName = "Name_MaxLength", ErrorMessageResourceType = typeof(Resources))]
    public string Name { get; set; }

    // standard IDataErrorInfo stuff here
 } 
```

我希望 DataGrid 验证其中的任何对象，并且我将能够在代码中检测对象是否正确。我尝试了以下方法：

1.  在 UserControl 中添加所有验证错误的集合

    ```
    private readonly List<Tuple<object, ValidationError>> errors = new List<Tuple<object, ValidationError>>(); 
    ```

2.  在 UserControl 的构造函数中添加验证处理程序：

    ```
    Validation.AddErrorHandler(this, ErrorChangedHandler); 
    ```

3.  处理验证更改：

    ```
    private void ErrorChangedHandler(object sender, ValidationErrorEventArgs e)
    {
        Debug.WriteLine(e.Action.ToString() + ":object=" + e.OriginalSource.ToString() + ",error=" + e.Error.ToString());
        if (e.Action == ValidationErrorEventAction.Added)
        {
            errors.Add(new Tuple<object, ValidationError>(e.OriginalSource, e.Error));
        }
        else
        {
            Tuple<object, ValidationError> error = errors.FirstOrDefault(err => err.Item1 == e.OriginalSource && err.Item2 == e.Error);
            if (error != null) { errors.Remove(error); }
        }
        bool hasError = !errors.Any();
    } 
    ```

如果我编辑**现有**对象，这可以正常工作，但是如果我尝试**添加**新对象，错误更改的事件流非常奇怪：TextBlock 的验证错误在创建新对象时添加并且永远不会删除，即使我为所有对象设置了正确的值两个领域。这是我的日志（我记录了所有验证错误）：

```
(I created new row,i.e. object) 
```

添加：object=System.Windows.Controls.TextBlock，error=System.Windows.Controls.ValidationError 添加：object=System.Windows.Controls.TextBlock，error=System.Windows.Controls.ValidationError 添加：object=System.Windows。 Controls.TextBox,error=System.Windows.Controls.ValidationError 已添加：object=System.Windows.Controls.DataGridCell,error=System.Windows.Controls.ValidationError 已删除：object=System.Windows.Controls.DataGridCell,error=System。 Windows.Controls.ValidationError

```
(I put correct value for Name field) 
```

已删除：object=System.Windows.Controls.TextBox,error=System.Windows.Controls.ValidationError 添加：object=System.Windows.Controls.TextBox,error=System.Windows.Controls.ValidationError 添加：object=System.Windows。 Controls.DataGridCell,error=System.Windows.Controls.ValidationError

```
(I put correct value for Amount field, now object (and whole row is the grid) is valid) 
```

已删除：object=System.Windows.Controls.DataGridCell,error=System.Windows.Controls.ValidationError 已删除：object=System.Windows.Controls.TextBox,error=System.Windows.Controls.ValidationError

但是与 TextBlock 相关的前两个错误没有被删除，因此所有错误的列表不为空，并且 ErrorChangedHandler 中的 hasError 变量为 false。我的 XAML 也很简单：

```
 <DataGrid x:Name="grid"
              ItemsSource="{Binding MyObjects}" 
              CanUserDeleteRows="False" Margin="11,11,11,11" 
              AutoGenerateColumns="False"
              Height="308">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Path=Name, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, 
                                ValidatesOnExceptions=True, NotifyOnValidationError=True}" 
                                Header="Name" Width="100" ElementStyle="{StaticResource TextCellElementStyle}"
                                EditingElementStyle="{StaticResource TextCellEditingStyle}"/>
            <DataGridTextColumn Binding="{Binding Path=Amount, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, 
                                ValidatesOnExceptions=True, NotifyOnValidationError=True}" 
                                Header="Amount" Width="75" ElementStyle="{StaticResource TextCellElementStyle}"
                                EditingElementStyle="{StaticResource TextCellEditingStyle}"/>
        </DataGrid.Columns>
    </DataGrid> 
```

# php - 如何将浮点百分比值转换为整数百分比？

> ID：10438177
> 
> 赞同：-2
> 
> 时间：2012-05-03T19:35:33.063
> 
> 标签：php

如何在 PHP 中将浮点百分比数值转换为整数百分比数值？

示例：3.8461538461538 % = 4 %

更新：这是我的代码，我编码以获得百分比值，但我得到十进制值，但我需要它没有十进制值。

```
$total = array_sum($total_count);
$percent = ($occurs/$total)*100;
echo $percent ; 
echo "%"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T19:43:32.140

这是通过[round()](http://uk.php.net/manual/en/function.round.php)完成的- 舍入到最接近的 int

```
<?php 
echo round('3.8461538461538'); //4
?> 
```

还有：

[floor()](http://uk.php.net/manual/en/function.floor.php) -- 向下舍入分数。

[ceil()](http://uk.php.net/manual/en/function.ceil.php) -- 向上取整分数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:38:17.303

使用`round()`. 这是一个PHP函数。

**编辑：** 给定代码：

```
$total = array_sum($total_count);
 $percent = ($occurs/$total)*100;
 echo round($percent). "%"; 
```

例如：

```
$number="3.8461538461538%";   //if it's a string with % in the end.
$number=substr($number, 0,-1);  //It type converts automatically here. Lazy code :)
$number_rounded=round($number); 
```

或者

```
$number=3.8461538461538;  //If it's just a float.
$number_rounded=round($number); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:41:19.887

```
<?php number_format(3.8461538461538); ?> 
```

您可以在第二个参数中指定小数点的数量（默认为 0）。

# jquery - jQuery - 将多个选择器缓存到一个变量？

> ID：10438178
> 
> 赞同：1
> 
> 时间：2012-05-03T19:35:33.793
> 
> 标签：jquery, caching, jquery-selectors

我需要对 jQuery 缓存进行一些说明。据我了解，这是：

```
var $element = $('#element'); 
```

如果我们不止一次地引用这个元素（通过引用我的意思是改变它，或者监听它上面的事件），我们就会受益。它是否正确？

如果正确，以下代码是否有意义，为什么？

```
var $button = $('#submit, #save, #reset'); 
```

我看到的是 jQuery 允许我这样做（因此将相同的漂亮主题应用于所有 3 个按钮），但我在任何地方都找不到文档，这对性能有任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:38:16.283

这对性能方面的影响可以忽略不计。您正在谈论创建多个一元素数组或一个三元素数组，所有这些都可以忽略不计。

基本上，jQuery 为您的选择器构造一个包含所有可能匹配项的数组并返回它。

在担心 javascript 的性能之前，先考虑其他方面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:39:03.343

是的，这是有道理的，但前提是您必须将这些按钮作为一组进行多次操作。这不太可能。

我建议你不要在 jquery 优化上付出太多努力，直到你真正以高频率做事（比如动画）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:39:06.027

它有助于提高性能的唯一方法是您要访问`$element`或`$button`多次访问。当您这样做时`$('#element')`，js 会在页面中搜索具有该 ID 的元素，然后执行您告诉它执行的任何操作。下次您这样做时`$('#element')`，它会再次搜索该元素的页面。如果您使用`var $element = $('#element')`，那么下次调用它（使用`$element`）时，将不会进行搜索，因为引用已经存储。

# jquery - 用于防止用户通过对话框离开带有未保存数据的页面的 jQuery 插件？

> ID：10438179
> 
> 赞同：2
> 
> 时间：2012-05-03T19:35:46.477
> 
> 标签：jquery, forms, jquery-plugins

我正在使用 jQuery 1.4.4，并且我正在尝试找到一个插件，该插件会在用户离开未保存更改的表单时发出警告。我尝试自己编写代码，但遇到了 window.beforeunload 和 IE 8 的问题。

我需要它没有像 GPL 这样的限制性许可证，因为这将是一个商业应用程序，如果可能的话是免费的。

Afermath：感谢他们团队的帮助，在解决了配置问题后，我最终使用了[脏表单插件。](http://mal.co.nz/code/jquery-dirty-forms/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:40:00.403

脏表格 --> [https://github.com/snikch/jquery.dirtyforms](https://github.com/snikch/jquery.dirtyforms)

我没有亲自使用过，但看起来你需要什么:)

# wpf - IsPressed 触发器（按钮）导致异常

> ID：10438181
> 
> 赞同：2
> 
> 时间：2012-05-03T19:35:51.707
> 
> 标签：wpf, templates, button, triggers, styles

我正在尝试覆盖按钮样式。其实我已经做了几十次了，但现在我遇到了这个：

异常和InnerException：{“触发器中的属性不能为空。”}

我的代码：

```
<Style x:Key="ArrowRightStyle" TargetType="{x:Type Button}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
    <Setter Property="Background" Value="{StaticResource ButtonNormalBackground}"/>
    <Setter Property="BorderBrush" Value="{StaticResource ButtonNormalBorder}"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate>
                <Grid Height="{Binding ElementName=imgBackground, Path=ActualHeight, Mode=OneWay}" 
                      Width="{Binding ElementName=imgBackground, Path=ActualWidth, Mode=OneWay}">
                    <Image x:Name="imgBackground" Source="{StaticResource RightArrowImageNormal}" Stretch="None"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter TargetName="imgBackground" Property="Source" Value="{StaticResource RightArrowImageDisabled}"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter TargetName="imgBackground" Property="Source" Value="{StaticResource RightArrowImageIsPressed}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>

</Style> 
```

所以它有效：

```
 <Style x:Key="ArrowRightStyle" TargetType="{x:Type Button}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
    <Setter Property="Background" Value="{StaticResource ButtonNormalBackground}"/>
    <Setter Property="BorderBrush" Value="{StaticResource ButtonNormalBorder}"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate>
                <Grid Height="{Binding ElementName=imgBackground, Path=ActualHeight, Mode=OneWay}" 
                      Width="{Binding ElementName=imgBackground, Path=ActualWidth, Mode=OneWay}">
                    <Image x:Name="imgBackground" Source="{StaticResource RightArrowImageNormal}" Stretch="None"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter TargetName="imgBackground" Property="Source" Value="{StaticResource RightArrowImageDisabled}"/>
                    </Trigger>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsPressed}" Value="True">
                        <Setter TargetName="imgBackground"
                                Property="Source" Value="{StaticResource RightArrowImageIsPressed}"/>
                    </DataTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

为什么？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T21:34:26.393

只是快速浏览，我认为它找不到属性 IsPressed

添加“按钮”。应该这样做。

```
....
  <Trigger Property="Button.IsPressed" Value="True">
     <Setter TargetName="imgBackground" Property="Source" Value="{StaticResource.... 
```

或确保您的模板以按钮为目标（我知道您在样式上指定了这一点，但这还不够 - 模板将假定 typeof(Control) 并且控件上没有 IsPressed 。

```
...
<Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
            ....the rest of your code 
```

我觉得

```
{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsPressed}" 
```

在运行时将相对源的类型解析为“Button”，因此能够找到 IsPressed...

# ravendb - AppHarbor + RavenDB - EsentFileAccessDeniedException

> ID：10438182
> 
> 赞同：4
> 
> 时间：2012-05-03T19:35:51.927
> 
> 标签：ravendb, appharbor

我正在尝试使用 RavenDB 实例让我的应用程序在 AppHarbor 中运行。我已经更新了我的 raven 库以构建 888，但我仍然收到以下错误。我还允许文件系统写访问，但我仍然遇到同样的错误。任何想法如何解决这个问题？

```
[EsentFileAccessDeniedException: Cannot access file, the file is locked or in use]
   at Microsoft.Isam.Esent.Interop.Api.Check(Int32 err) in C:\Work\ravendb\SharedLibs\Sources\managedesent-61618\EsentInterop\Api.cs:line 2739
   at Microsoft.Isam.Esent.Interop.Api.JetInit(JET_INSTANCE& instance) in C:\Work\ravendb\SharedLibs\Sources\managedesent-61618\EsentInterop\Api.cs:line 131
   at Raven.Storage.Esent.TransactionalStorage.Initialize(IUuidGenerator uuidGenerator) in c:\Builds\RavenDB-Stable\Raven.Storage.Esent\TransactionalStorage.cs:line 205 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:18:42.187

似乎在应用程序启动期间，我的应用程序正在应用程序根目录中创建一个数据目录。我发现我有一个对 RavenDB Embedded 的旧引用，该引用在创建不需要的数据目录的项目中使用的时间更长。一旦我删除了该引用并推送，一切都开始正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T23:01:40.903

您是否尝试将 AppHarbor Web Worker 实例文件存储用于 RavenDB 后备存储？这是个坏主意，请改用托管的[RavenHQ 插件](https://appharbor.com/addons/ravenhq)。

无法在 AppHarbor 上运行的自托管 RavenDB 是一个[已知问题](https://serverfault.com/questions/292545/esent-fails-to-determine-the-minimum-i-o-block-size)。

即使您让它工作，请注意，当您部署新版本的代码或工作人员实例失败时，工作人员文件系统不会持久保存。

# java - 使用 Twilio 的 REST API

> ID：10438186
> 
> 赞同：0
> 
> 时间：2012-05-03T19:36:05.667
> 
> 标签：java, http, rest, twilio

不熟悉 REST，在阅读了一些关于它的文档后，我对它的工作方式有点困惑。

我实际上想使用 Twilio SMS Gateway，它提供了一个 REST API 来与现有的 Web 应用程序交互并发送文本消息。

据我了解，REST 是一种构建 Web 服务的方法，最终，我们不使用 SOAP，而是使用 URL 访问“资源”，依靠 HTTP 来获取、放置或删除数据。

我正在谈论的 SMS 网关提供了一个 Java API，我可以将它集成到我的 Web 应用程序中。此 API 中的类使用 httpcore、httpclient 和 commons-codec jar。这是因为 REST 依赖于 HTTP 吗？

所以基本上，他们的 API 依赖于 Apache 和 HTTP 库来构建 Java 中的 HTTP 请求并设置基础，所以我只需要提供我想要提交的数据和/或特定信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:32:02.220

REST API 是 HTTP API。*REST*这个词应该表明你的 API 是如何工作的。基本上，您使用 POST 请求来更新数据并使用 GET 请求来检索数据，并且对于 API 中的所有不同资源（例如调用或记录）都有不同的 HTTP 端点。

Twilio 帮助程序库（包括 Java 库）基本上是对 Twilio API 的 HTTP 调用的包装器。这个想法是通过抽象出 HTTP 身份验证和请求一些更特定于语言的代码后面的东西，使您更容易对 Twilio 进行 API 调用。我们还为您将 HTTP 响应解析为一个对象。

# c# - NHibernate 属性配置

> ID：10438193
> 
> 赞同：0
> 
> 时间：2012-05-03T19:36:29.380
> 
> 标签：c#, nhibernate

在 NHibernate 中，我有这个配置。

```
 <property name="Name" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a222222229">
      <column name="Name" />
    </property> 
```

这些是什么意思？msconrlib，版本，文化，publicKeyToken ？为什么我们需要这些？我在 java env 中研究过 Hibernate，我从不使用这些标签。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:31:13.640

类型描述了用于该属性的 .Net CLR 类型。在这种情况下，一个普通的字符串。

在这种情况下，您不必指定它。在某些情况下，您需要指定它，例如，当您使用自定义类型时。或者当您想要映射 DateTime 时。

关于类型各部分的含义： 类型是System.String，对程序集名称、文化和版本进行了非常精确的描述。publicKeyToken 是程序集强名称的密钥——这允许重复程序集名称，只要它们使用不同的密钥签名。

您可以将此映射写为

```
 <property name="Name">
      <column name="Name" />
 </property> 
```

或者

```
<property name="Name" type="String">
      <column name="Name" />
</property> 
```

但是，如果您想在某些程序集中使用自定义类型，则需要指定是否更详细，就像您现在正在做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T21:54:30.633

在 MS .Net 中，它被称为强程序集名称。这是在 .Net Framework 中识别特定类型的方式。所以这个特定的字符串表明要使用 4.0 版 mscorlib 库中的 System.string。对本地化没有偏好。这允许 .Net 使用部署到 GAC 的程序集 - 全局程序集缓存，它充当系统 dll 的全局目录。

# sql-server - 将 SQL Server 存储过程中的数据检索到列表中

> ID：10438194
> 
> 赞同：0
> 
> 时间：2012-05-03T19:36:58.693
> 
> 标签：sql-server, asp.net-mvc, generic-list

我有这个项目，我正在创建一个库来处理来自多个项目的所有数据，我已经在存储过程中组织了查询。我需要将 4 个参数传递给存储过程并取回一些数据。我不敢相信没有简单的方法可以做到这一点。

我已经尝试过数据读取器，数据表我不想遍历数据，因为它确实有可能变大。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:39:04.473

实体框架很好。添加新项目 > ADO.NET 实体模型从数据库生成仅选择 SP，除非您也想导入表模式。

一旦找到您的 SP，它就会为您创建复杂的类型，一切都会变得非常简单。

为取胜的实体框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:25:48.153

我建议使用 Dapper [http://code.google.com/p/dapper-dot-net/](http://code.google.com/p/dapper-dot-net/)

这是一个微型 ORM，比 EF**快得多**- 由 SO 背后的人编写和使用；-)

*注意*：`I do not want to have to iterate through the data as it does have the possibility to grow large`- 有人将*不得不*遍历结果集 - 无论是您还是您将使用的框架。如果您认为一次可能会获得太多数据，请考虑分页。

# c++ - 无法在 C++ 控制台应用程序项目中包含头文件

> ID：10438206
> 
> 赞同：2
> 
> 时间：2012-05-03T19:37:51.240
> 
> 标签：c++, visual-c++, header-files, visual-c++-2010

我一直在尝试链接一个 .lib 文件，并且还在我的 C++ 控制台应用程序项目中包含一个头文件。我从我的其他项目之一复制了 C++ 头文件，并将其粘贴`Header Files`到控制台应用程序项目的文件夹下。这是要查看的屏幕截图：http: [//i.imgur.com/JFFIn.png](http://i.imgur.com/JFFIn.png)

但是，当我尝试在我的代码中包含头文件时`#include...`，我没有得到头文件名称的智能感知。（我只看到 targetver.h、stdafx.h 和 Debug 文件夹）
我试图将`Add additional include directories`我的 C++ 控制台应用程序项目属性指向项目文件夹本身，但这似乎没有帮助，文件仍然没有显示。

如果我将头文件的名称写为`#include "DllTest.h"`，我会收到一条错误消息：
`Cannot open include file: 'DLLTest.h': No such file or directory c:\users\ht\documents\visual studio 2010\projects\dlltest\dlltestconsole\dlltestconsole.cpp`

头文件如何包含在此处，以便它开始出现？如果 I `add a new item > Header File`，将其命名为 DLLTest.h 并将头文件内容复制粘贴到此处，它就会正常显示。复制的头文件 - 粘贴到`Header Files`文件夹中如何显示在代码中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:18:26.193

在 C++ 项目中，在解决方案资源管理器中看起来像文件夹的东西实际上并不是文件夹，它们是*过滤器*。它们是纯 UI 实体，可用于在 IDE 中组织项目项。但是，它们不以任何方式反映磁盘上项目的结构或位置。您可以将磁盘上任何位置的文件添加到解决方案中的任何过滤器。

编译器对这些过滤器一无所知；它只知道磁盘上存在的文件。

在您的情况下，这些文件不在您的项目文件夹中。您要么需要：

*   将文件复制到项目文件夹中，然后从那里将它们添加到项目中（右键单击解决方案，然后添加现有项），或

*   从它们所在的位置添加文件，然后将它们的位置添加到项目属性中的“其他包含目录”属性中。

当您将文件复制并粘贴到项目中时，我不知道有什么方法可以让 IDE 自动将文件移动到项目目录中。C++ 项目系统与用于 C# 和 VB 的项目系统有根本的不同。

# vim - 标签弹出的重映射键

> ID：10438207
> 
> 赞同：4
> 
> 时间：2012-05-03T19:37:53.280
> 
> 标签：vim

我正在尝试将`Ctrl`+重新映射`[`到`:pop`. 我已经将我的`Ctrl`+和++反弹`t`到新的 shell 选项卡。我想出了：`:tabe``Ctrl``Shift``T`

```
nnoremap <C-[> :pop 
```

但是当我这样做时，我`:pop`几乎每次击键，甚至是鼠标点击。

这个想法是这个键映射让我备份了标签列表的链。`Ctrl`+的对面`]`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T06:58:25.660

在终端中，与 ;`<Esc>`相同`<C-[>`。两者都由相同的键码表示。

由于键盘输入在内部处理的方式，即使在 GVIM 中，今天也无法区分这个以及许多其他组合键（如 Ctrl+Letter 与 Ctrl+Shift+Letter）。这是一个已知的痛点，也是 vim_dev 和 #vim IRC 频道上各种讨论的主题。

一些人（最重要的是 Paul LeoNerd Evans）想要解决这个问题（即使是支持这个的终端中的控制台 Vim），并提出了各种建议，cp。[http://groups.google.com/group/vim_dev/browse_thread/thread/626e83fa4588b32a/bfbcb22f37a8a1f8](http://groups.google.com/group/vim_dev/browse_thread/thread/626e83fa4588b32a/bfbcb22f37a8a1f8)

但是截至今天，还没有补丁或志愿者出现，尽管许多人表示希望在未来的 Vim 8 主要版本中拥有它。

# css - 有人知道“|”是什么吗 在 CSS 选择器中表示

> ID：10438208
> 
> 赞同：1
> 
> 时间：2012-05-03T19:37:56.043
> 
> 标签：css

在[http://www.w3.org/TR/css3-selectors/#negation](http://www.w3.org/TR/css3-selectors/#negation) 我发现了有趣的选择器

```
html|*:not(:link):not(:visited) 
```

有人知道“|”是什么吗 方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T19:42:58.413

在 6.2.1 的同一页面中，它声明垂直条用于选择命名空间中的元素（在上面的示例中，为 html 命名空间）。

看这里：

[http://www.w3.org/TR/css3-selectors/#univnmsp](http://www.w3.org/TR/css3-selectors/#univnmsp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:42:06.640

您可以在此处找到有关它的更多信息：

[什么| 在 CSS 中表示](http://www.w3.org/TR/css3-selectors/#univnmsp)

它用于分隔 CSS 中的命名空间和元素名称。

希望它会帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T19:45:12.297

这些问题似乎与您的相似：[Using the pipe in css](https://stackoverflow.com/questions/8066053/using-the-pipe-in-css) or [What does a pipe (|) do in a CSS selector?](https://stackoverflow.com/questions/6497934/what-does-a-pipe-do-in-a-css-selector)

> 它将命名空间和元素名称分开。
> 
> 除非已定义默认命名空间，否则*|* :link 是写 *:link 或只是 :link 的复杂方式。

# css - 标题和浮动问题

> ID：10438213
> 
> 赞同：0
> 
> 时间：2012-05-03T19:38:17.397
> 
> 标签：css, header, position, css-float, repeat

我的问题是，我有一个比我的浏览器大的标题图像，我想这样做是因为我希望图像根据您的浏览器宽度变得或多或少可见。当您的浏览器大于图像时，会重复一种颜色。最重要的是，我有一个居中的图像，然后是两个三角形。一左一右飘。我的问题是，当我将 .content-outer .content-inner 的宽度从 978px 更改为 1134px 以适应三角形上的大图像时，它会与导航栏的居中混淆。这是我的代码。列表样式适用于我的导航。

```
<div class="content-outer" id="top_nav">
<div class="content-inner">
</div>

<div class="content-outer" id="header_map">
<div class="diamond-left">
<div class="diamond-right">
<div class="content-inner">
</div>
</div>
</div>
</div>

#header,

#header_map {
height:529px; 
background:#3b96a9 url(Layer-57.jpg) top center no-repeat;
margin-bottom:45px; 
overflow:visible;
}

#header .diamond-left,

#header_map .diamond-left {
width:100%; 
height:529px; 
overflow:visible; 
float:left; 
background:url(Layer-58.png) top left no-repeat;
}

#header .diamond-right,

#header_map .diamond-right {
width:100%;
height:529px; 
overflow:visible; 
float:right; 
background:url(Layer-59.png) top right no-repeat;
}

#header_map .content-inner  {
height:391px; 
background:url(Layer-61.png) top center no-repeat; 
position:relative; 
overflow:visible; }

#header .content-inner {
position:relative; 
overflow:visible; 
padding-bottom:20px;
}

.content-outer
{ width:100%; float:left; overflow:visible; }
.content-outer .content-inner
{ width:978px; margin:0 auto; overflow:visible; position:relative; }
.content-outer .content-inner ul
{ margin:20px 0; padding:0; }
.content-outer .content-inner ul li
{ margin:3px 0 3px 20px; padding:0; font-size:1.1em; }
.content-outer .content-inner ul li p
{ font-size:1em; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:03:43.273

除非我误解了什么，否则代码似乎没问题。您是否仔细检查以确保：

*   三角形图像具有透明背景，因此您可以看到它们的背后？
*   主标题背景是否位于样式表中指定的正确位置？

如果该页面存在于我们可以查看的某个地方，请告诉我们 - 它可能会更清楚地说明您的问题。

# c - gtk_source_undo_manager_begin_not_undoable_action / gtk_source_undo_manager_end_not_undoable_action 不工作

> ID：10438214
> 
> 赞同：2
> 
> 时间：2012-05-03T19:38:17.823
> 
> 标签：c, gtk, gtksourceview

我正在尝试使用 gtk+-2.0 和 gtksourceview-2.0 在 C 中编写我自己的文本编辑器。当我被卡住时，我一直在使用 gedit 源，但他们显然没有使用这个功能，而且我在网上找不到它的使用示例。当我打开一个文本文件并将其内容放入文本缓冲区时，这被注册为可撤消的操作。我希望这个过程不可撤销，所以我放置了：

gtk_source_undo_manager_begin_not_undoable_action(um);

在我的 open_activated 函数开始时（如下提供），并且：

gtk_source_undo_manager_end_not_undoable_action(um);

在同一功能的末尾。根据 devHelp 中提供的帮助，它说这两行之间的所有内容都不应撤消，但确实如此。我错过了什么？有没有更好的方法来完成同样的功能？

```
GtkSourceUndoManager *um; (defined globally)

void open_activated(GtkWidget *widget, GtkWindow *parent)
{
  GtkSourceLanguage *lang;
  GtkSourceLanguageManager *lm;
  GtkWidget *dialog;
  int pages = 0;
  GtkWidget *tablabel;

  gtk_source_undo_manager_begin_not_undoable_action(um);

  /* create new tab */
  tablabel = gtk_label_new("New File");
  pages = gtk_notebook_get_n_pages(GTK_NOTEBOOK(notebook));
  gtk_container_add(GTK_CONTAINER(scrollwin[pages]),txtinput[pages]);
  gtk_widget_show_all (scrollwin[pages]);
  gtk_notebook_append_page(GTK_NOTEBOOK(notebook),scrollwin[pages],tablabel);
  //gtk_source_view_set_show_line_numbers (GTK_SOURCE_VIEW (txtinput[pages]), TRUE);
  gtk_notebook_set_current_page (GTK_NOTEBOOK(notebook), pages);

  //gtk_text_buffer_set_modified (gtk_text_view_get_buffer((GTK_TEXT_VIEW(txtinput[pages]))), TRUE);

  dialog = gtk_file_chooser_dialog_new("Open File", parent, GTK_FILE_CHOOSER_ACTION_OPEN,GTK_STOCK_CANCEL,GTK_RESPONSE_CANCEL,GTK_STOCK_OPEN,GTK_RESPONSE_ACCEPT,NULL);
  GtkTextBuffer *buffer;
  //buffer = gtk_text_view_get_buffer(GTK_TEXT_VIEW(txtinput[gtk_notebook_get_current_page(GTK_NOTEBOOK(notebook))]));
  buffer = gtk_text_view_get_buffer(GTK_TEXT_VIEW(txtinput[pages]));

  if(gtk_dialog_run(GTK_DIALOG(dialog))== GTK_RESPONSE_ACCEPT)
  {
    char *path,*string;
    const gchar *filename;
    char temp[40];
    gsize length = -1;
    path = gtk_file_chooser_get_filename(GTK_FILE_CHOOSER(dialog));
    paths[pages] = path;
    filename = filenameFromPath(path);
    //printf("%s\n",out);
    strcpy(temp,filename);
    tablabel = gtk_label_new(temp);
    g_file_get_contents(path,&string,&length,NULL);     
    gtk_text_buffer_set_text(buffer,string,-1);

    /* syntax highlighting */
    lm = gtk_source_language_manager_new();
    lang = gtk_source_language_manager_guess_language (lm, path, NULL);
    gtk_source_buffer_set_language (GTK_SOURCE_BUFFER(buffer), lang);

    /* change tab label */
    gtk_notebook_set_tab_label (GTK_NOTEBOOK(notebook), scrollwin[pages], tablabel);

    /* set some sourceview options */
    gtk_source_view_set_show_line_numbers (GTK_SOURCE_VIEW (txtinput[pages]), TRUE);
    gtk_source_view_set_tab_width (GTK_SOURCE_VIEW (txtinput[pages]), 2);

    /* Set the editor's font. */
    PangoFontDescription *font_desc = pango_font_description_new();
    pango_font_description_set_family (font_desc, "monospace");
    gtk_widget_modify_font (txtinput[pages], font_desc);

    g_free(path);
    g_free(string);

  }

  gtk_widget_destroy(dialog);
  gtk_text_buffer_set_modified (gtk_text_view_get_buffer((GTK_TEXT_VIEW(txtinput[pages]))), FALSE);
  changeLabelColor("black");

  gtk_source_undo_manager_end_not_undoable_action(um);

} 
```

* * *

不幸的是，没有像语言管理器那样的 gtk_source_undo_manager_new () 或 gtk_source_undo_manager_get_default ()。GtkSourceUndoManager 的文档是：

描述

可以实现 GtkSourceUndoManager 接口来为 GtkSourceBuffer 提供自定义撤消管理。使用 gtk_source_buffer_set_undo_manager 为特定源缓冲区安装自定义撤消管理器。

分别在撤销堆栈的撤销状态或重做状态发生变化时使用 gtk_source_undo_manager_can_undo_changed 和 gtk_source_undo_manager_can_redo_changed。

细节

GtkSourceUndoManager

```
typedef struct _GtkSourceUndoManager GtkSourceUndoManager; 
```

GtkSourceUndoManagerIface

```
typedef struct {
GTypeInterface parent;

/* Interface functions */
gboolean (*can_undo)                  (GtkSourceUndoManager *manager);
gboolean (*can_redo)                  (GtkSourceUndoManager *manager);

void     (*undo)                      (GtkSourceUndoManager *manager);
void     (*redo)                      (GtkSourceUndoManager *manager);

void     (*begin_not_undoable_action) (GtkSourceUndoManager *manager);
void     (*end_not_undoable_action)   (GtkSourceUndoManager *manager);

/* Signals */
void     (*can_undo_changed)          (GtkSourceUndoManager *manager);
void     (*can_redo_changed)          (GtkSourceUndoManager *manager);
} GtkSourceUndoManagerIface; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T06:07:49.090

如果您没有实现自定义撤消管理器，则只需使用`gtk_source_buffer_begin_not_undoable_action()`。

# objective-c - 使用 Core Data 的长期运行前台操作的最佳实践？

> ID：10438218
> 
> 赞同：3
> 
> 时间：2012-05-03T19:38:34.403
> 
> 标签：objective-c, ios, core-data, ios5

我有一个应用程序，它会在用户明确按下同步按钮后从网络上导入大量数据，并使用 Core Data 存储这些数据。因为我想显示反馈并且我不希望用户在发生这种情况时与应用程序的其余部分进行交互，所以按下同步按钮会弹出一个模态对话框。由于我希望该操作立即发生，因此该操作在 viewDidAppear 方法中执行。我敢肯定，这是不赞成的。

目前这种方法存在很多问题：

*   一切都发生在主线程中。用户会获得反馈，因为有一个活动指示器会继续动画，但无法指示进度或显示中间消息。这不是做事的正确方式。
    *   但是，有人告诉我，在使用 Core Data 时，一切都必须使用主线程，因此将工作分解到另一个线程似乎并不容易。
*   如果应用程序进入后台状态（用户点击 Home 按钮或 iPad 进入睡眠状态），则游戏结束 - 操作终止。从文档中我很清楚为什么会这样。
    *   我知道您可以处理“我即将进入后台”事件，但这并不是说我可以在文件下载过程中将代码的执行从一个地方移动到另一个地方。无论我使用什么解决方案，都必须是一个连续的动作，在转换到/从后台之前和之后以相同的方式执行。
    *   就用户而言，我希望操作在前台执行。在执行此操作时，他们与应用程序的其他部分进行交互是没有意义的。

我正在阅读有关此内容的 Apple 文档，但我提出此问题是希望找到有关此特定需求组合的更简洁的指导。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-08T15:40:25.707

你真的不应该冻结主线程。您仍然可以“禁止”某些 UI 操作。

小时候创建一个单独的上下文，然后在其中完成所有工作。完成后（或每隔一段时间），将上下文保存到主上下文中，并通知主线程进行一些 UI 更新交互...可能是进度条之类的...

```
NSManagedContext *backgroundContext = [NSManagedContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
backgroudContext.parentContext = [self mainManagedObjectContext];
[backgroundContext performBlock:^{
    // This block is running in a background thread.
    // Go get your data from the web

    // Call this to push data to the main MOC (either at end, or at intervals)
    [backgroundContext save:&error];

    // When you want to do something on the main thread...
    dispatch_async(dispatch_get_main_queue(), ^{
        // This block is running on the main queue... I can do anything with the UI...
    }];
}]; 
```

需要注意的几件事......您的 mainMOC 需要是私有或主队列并发类型。如果您使用的是应用程序委托中的 Core Data 模板，只需将 alloc/init 更改为 initWithConcurrencyType:NSMainQueueConcurrencyType。

但是，我建议使用规范的主/父关系。创建一个私有 MOC，将其分配给持久存储，然后创建一个主 MOC，将其父 MOC 设置为该私有 MOC。现在您已准备好使用后台操作处理任何 I/O，而不会阻塞您的 UI。

尽管如此，当从 web 加载时，使用上面的模式：创建一个子 MOC，然后将对象加载到主 MOC。

请注意，在“根”MOC 调用 save 之前，数据不会保存到磁盘。

# c# - 带有数据注释的 EF 4.3 Code First 中的索引已存在错误

> ID：10438219
> 
> 赞同：1
> 
> 时间：2012-05-03T19:38:36.090
> 
> 标签：c#, entity-framework, data-annotations, entity-framework-4.3

我正在尝试使用带有数据注释的 Code First 创建带有 Entity Framework 4.3 的计费数据库，每次尝试创建数据库时都会出错。以下是我正在处理的对象：

```
public class ClientBase
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ClientID { get; set; }

    [Required]
    public string ClientName { get; set; }

    [Required]
    public bool IsActive { get; set; }

    [Required]
    public string ClientContactName { get; set; }

    [Required]
    public string ClientContactEmail { get; set; }

    public virtual List<PropertyBase> Communities { get; set; }
}

public class PropertyBase
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int PropertyID { get; set; }

    [ForeignKey("Client")]
    public int ClientID { get; set; }

    [Required, EnumDataType(typeof(BillingFrequency))]
    public BillingFrequency PropertyBillingFrequency { get; set; }

    [Required]
    public bool IsActive { get; set; }

    [Required]
    public string PropertyName { get; set; }

    public string PropertyStreet { get; set; }

    public string PropertyCity { get; set; }

    public string PropertyState { get; set; }

    public int PropertyZipCode { get; set; }

    public virtual ClientBase Client { get; set; }
} 
```

无论我尝试做什么，我总是会收到此错误：

```
The operation failed because an index or statistics with name 'IX_ClientID' already exists on table 'Property'. 
```

我已经使用 Fluent API 看到了这个问题的解决方案，但我还没有找到一个用于数据注释的解决方案。

有谁知道如何解决这个问题？

编辑：这是 DbContext 中的代码：

```
public DbSet<ClientBase> ClientBases { get; set; }
public DbSet<PropertyBase> PropertyBases { get; set; }

protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        base.OnModelCreating(modelBuilder);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T13:20:26.317

修复。结果我忘记了我创建的另一个类与 ClientBase 有外键关系。我忘记将它作为虚拟属性带入 ClientBase，而 Entity Framework 对我不满意。当我包含它时，它工作得很好。

谢谢你们的帮助！

# c# - 为什么我的 TextBox.Width 值不接受我尝试分配的值？

> ID：10438220
> 
> 赞同：0
> 
> 时间：2012-05-03T19:38:41.597
> 
> 标签：c#, winforms, dynamic, tablelayoutpanel

我试图通过给它们一个宽度和高度来均匀地分配动态创建的控件，该宽度和高度是容器控件的宽度和高度的一小部分。

然而，尽管我计算尺寸的函数是正确的，但由于某种原因，对 Width 属性的分配被顽固地拒绝了。WidthToUse() 函数返回 19，但是当尝试将该值分配给动态创建的 TextBox 时，它仍保持在...630！为什么要从 630 开始，为什么它拒绝分配？

即使是高度，虽然“工作”并不完全正确 - 面板上的控件太多或没有足够的空间来容纳使用此数学的所有控件。

这是我的代码：

```
int WidthToUse = getTextBoxWidthToUse(tableLayoutPanelGreatGooglyMoogly.Width);
int HeightToUse = getControlHeightToUse(tableLayoutPanelGreatGooglyMoogly.Height);

TextBox txtbx = new TextBox();
txtbx.Parent = tableLayoutPanelGreatGooglyMoogly;
txtbx.Margin = new Padding();
txtbx.Dock = DockStyle.Fill;
txtbx.AutoSize = false;
txtbx.Width = WidthToUse;   // WidthToUse is 19, but txtbx.Width is 630 both before AND after this assignment!
txtbx.Height = HeightToUse; // HeightToUse is 27

private static int getControlHeightToUse(int theDynPanelHeight) {
    return (theDynPanelHeight / NUMBER_OF_ROWS);
}

private static int getTextBoxWidthToUse(int theDynPanelWidth) {
    return (theDynPanelWidth / 32);
}

private static int getLabelWidthToUse(int theDynPanelWidth) {
    return ((theDynPanelWidth / 64) * 3);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T19:42:08.190

DockStyle.Fill 是描述控件相对于其容器大小的大小的属性。使用此属性集，控件将调整大小以适应其父容器中的所有空白空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:41:48.887

因为您将`Dock`属性设置为`Fill`我的猜测。

# android - 可以在 Android 应用内购买创建注册会员并在月底收取费用

> ID：10438223
> 
> 赞同：1
> 
> 时间：2012-05-03T19:38:59.740
> 
> 标签：android

是否可以在 Android 应用内购买中创建诸如注册会员或订阅者之类的内容，以允许该组中的用户下载内容并在月底收取费用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:53:17.513

截至目前，[还没有 Google Play](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=140504)。不过，[亚马逊应用内计费](http://www.amazonappstoredev.com/2012/04/announcing-the-in-app-purchasing-api-for-kindle-fire-and-other-android-devices.html)API 确实支持这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:06:14.193

[非托管购买](http://developer.android.com/guide/market/billing/billing_admin.html#billing-purchase-type)是可能的，但您需要为此提供服务器端支持。

您必须将购买保存在自己的系统中，跟踪每个用户的到期时间等。

此外，您可以通过每月创建一个新产品来管理购买，但它有其局限性。例如，您从每月的第一天到最后一天提供每月订阅，而用户在当月的最后一天购买一个，他/她将只支付一天的全月价格。我不推荐它。

# html - 内联文本区域样式以覆盖 CSS 默认值

> ID：10438231
> 
> 赞同：1
> 
> 时间：2012-05-03T19:39:27.490
> 
> 标签：html, css

我需要您对我的表单字段的文本区域提供帮助。我有下面的 CSS 来为 texarea 应用一般样式。但是现在我想对某些特定的文本区域进行一些内联​​更改，因为它们在容器之外重叠。

谢谢您的帮助。

```
 textarea[type=text]{
    border:             2px solid #a9c6c9;
    vertical-align:         middle;
    padding:             9px;
    height:             129px;
    border-collapse:         collapse;
    margin:             2px;
    padding:             2px;
    space:             2px;
    width:             6.1in;
    z-index:             1;
    font-family: calibri;
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:41:54.977

您可以使用`:not`过滤掉您不想更改的内容。将您的 CSS 选择器更改为：

```
textarea[type=text]:not(#element1, #element2, ...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:50:37.747

如果只是确保没有任何东西延伸到容器之外，请尝试添加`max-width:100%;`到您的 textarea CSS。这应该可以帮助您防止它超出容器，同时仍然使所有其他文本区域具有相同的宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T21:00:21.403

尝试将一个类添加到单个文本区域

```
<!-- Original -->
textarea[type=text]{
    border: 2px solid #a9c6c9;
    vertical-align: middle;
    padding: 9px;
    height: 129px;
    border-collapse: collapse;
    margin: 2px;
    padding: 2px;
    space: 2px;
    width: 6.1in;
    z-index: 1;
    font-family: calibri;
} 
```

然后：

```
<!-- add this class to you individual textarea's -->
textarea[type=text].newclass{
    width: 200px;
} 
```

或者你可以将它放在一个 div 中，如下所示：

```
<!-- add this class to the <div> your individual textareas are inside of -->
.newclass textarea[type=text]{
    width: 200px;
} 
```

或将其添加到 html 中的 textarea 中：

```
style="width:200px !important;" 
```

希望这可以帮助

# xaml - 自定义 TabItem ：可关闭的选项卡并在关闭时释放内存

> ID：10438232
> 
> 赞同：0
> 
> 时间：2012-05-03T19:39:34.397
> 
> 标签：xaml, mvvm

自定义选项卡项

我有一个绑定到我的 ViewModel 的 TabControl 我也想删除选项卡，但我看不到 tabitems 看到的默认值没有更改

```
 <TabControl
        Margin="5 5 5 0"
        Grid.Row="1"
        ItemsSource="{Binding Path=ListTabItem}"
        SelectedIndex="{Binding Path=CurrentTabItemIndex}"
        x:Name="Workspace" Background="White">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="SelectionChanged">
                <cmd:EventToCommand
                Command="{Binding ChangeTabCommand}"
                CommandParameter="{Binding SelectedItem, ElementName=Workspace}"/>
            </i:EventTrigger>
        </i:Interaction.Triggers>
        <!--Here is my tabHeader-->
        <TabControl.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Header}" />                        
                    <Button Content="X" Command={Binding CloseTabCommand}
                      CommandParameter="{Binding SelectedItem, ElementName=Workspace}"/>
                </StackPanel>
            </DataTemplate>
        </TabControl.ItemTemplate>            
    </TabControl> 
```

## 编辑：

我得到了一种工作方式，但是当关闭选项卡不释放内存时我遇到了问题：

```
 <Style x:Key="HeaderTabItem" TargetType="TabItem">
        <Setter Property="HeaderTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Button                                
                            Width="20"
                            Height="20"
                            Margin="-3 0 5 0"
                            Padding="2"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            BorderBrush="{x:Null}" Background="{x:Null}" Foreground="{x:Null}"
                            DataContext="{Binding DataContext, ElementName=Workspace}"
                            Command="{Binding Path=CloseTabCommand}"
                            CommandParameter="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=TabItem, AncestorLevel=1}}" Content="X"/>
                        <ContentControl
                            Grid.Column="1" 
                            VerticalAlignment="Center"
                            HorizontalAlignment="Left"
                            Content="{Binding Path=Header, RelativeSource={RelativeSource FindAncestor, AncestorType=TabItem, AncestorLevel=1}}" />
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

在我的视图模型中

```
 CloseTabCommand = new RelayCommand<TabItem>(tab =>
    {
        if (null == tab) return;
        ListTabItem.Remove(tab);
    },
    tab =>
    {
        return ListTabItem.IndexOf(tab) == CurrentTabItemIndex;
    }); 
```

### 有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:11:16.153

WPF 控件往往不会适当地处理自己，除非它们的 DataContext 已被清除（这似乎是一种黑客行为）。试试这个：

```
CloseTabCommand = new RelayCommand<TabItem>(tab =>
{
    if (null == tab) return;

    tab.DataContext = null;

    ListTabItem.Remove(tab);
},
tab =>
{
    return ListTabItem.IndexOf(tab) == CurrentTabItemIndex;
}); 
```

另外，请记住，您可能**看不到****立即**释放的内存。由于垃圾收集在 .NET 中的工作方式，您的应用程序可能需要等待/其他事件才能真正发生垃圾收集并清除内存。

如果你**真的**想要，你可以调用 GC.Collect()，但我**只会**在你不相信内存被释放的情况下才会这样做**，**我只会将它放入调试并确保对象被释放。确认后，将其删除并允许垃圾收集器完成其工作。

# jquery - JQuery Modal，需要不能让点击返回等问题，有什么想法吗？

> ID：10438235
> 
> 赞同：0
> 
> 时间：2012-05-03T19:39:38.833
> 
> 标签：jquery, modal-dialog

我已经返回了一个没有问题的结果列表。

当您单击该列表中的某个项目时，模式会显示在可单击项目列表上。

当我单击模式右上角的关闭按钮时，它会淡出然后淡入。

我已经尝试在列表中关闭单击“关闭”，但没有办法重新打开它。

由于关闭按钮也在列表上方，因此它的操作会立即被模式下方列表的“显示”操作忽略。

这是代码：

```
// This does the showing
$('ul.property-content li.box-sizing').on('click',function(){

        $(this).find('.property-modal-wrapper').fadeIn("fast");
        $('ul.property-content li.box-sizing').off('click');// this works

});

// This is inside of the modal element that is inside of the element that does the showing
$('.modal .close').on('click',function(){

        $(this).parentsUntil('li.box-sizing').find('.property-modal-wrapper').fadeOut("fast");
        $('ul.property-content li.box-sizing').on('click');// but can't get this to come back on

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:57:18.473

您可能只需要使用 .stopPropagation() 而不是关闭事件处理程序。试试这个：

```
// This does the showing
$('li').on('click', function() {
    $('#modal').fadeIn("slow");
});

// This is inside of the modal element that is inside of the element that does the showing
$('#modal').on('click', function(event) {
    event.stopPropagation();
    $('#modal').fadeOut("slow");
});​ 
```

# sql-server - 关系数据库设计

> ID：10438237
> 
> 赞同：-1
> 
> 时间：2012-05-03T19:39:53.780
> 
> 标签：sql-server, sqlite

我有 3 个表 表 1：植物表

PlantId（主键）

植物名

和其他一些领域

表2：输入文件

植物名，文件名

PlantId(外键) 引用 PlantId(Plant)

表3; 输入数据

ID。

和其他领域

我需要将它设计成一种植物可以有许多输入文件所以这是植物表和输入文件表之间的 1 米

现在当用户从 table2 中选择一个 inputfile 时，所有与 input file 相关的数据都存储在 Inputdata table3 中。

table2（输入文件）和table3（输入数据）之间应该是什么关系

谢谢

太阳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:33:54.277

inputfiles 和 inputdata 之间应该存在 1-1 的关系。

根据您对问题的描述，我会让 inputfiles 将 inputdata.id 作为外键。

# android - AlarmManager 不适用于特定日期

> ID：10438239
> 
> 赞同：1
> 
> 时间：2012-05-03T19:40:00.987
> 
> 标签：android, service, calendar, alarmmanager, android-pendingintent

我一直在尝试为特定日期设置 AlarmManager，但它根本不起作用！当我只是使用时间它工作正常。这是代码：

```
SharedPreferences prefs = PreferenceManager
                    .getDefaultSharedPreferences(this);
            String getEventTime = prefs.getString("EventSTime", "");
            String getEventDate = prefs.getString("EventDate", "");
            Toast.makeText(this, getEventTime + " " + getEventDate,
                    Toast.LENGTH_LONG).show();
            String temp = "", temp2 = "";
            DateFormat dateformat = new SimpleDateFormat("HH:mm");
            DateFormat dateformatDate = new SimpleDateFormat("dd-MM-yyyy");
            try {
                temp = dateformat.format(dateformat.parse(getEventTime));
                temp2 = dateformatDate.format(dateformatDate
                        .parse(getEventDate));
                Toast.makeText(this, temp + " " + temp2, Toast.LENGTH_LONG)
                        .show();

            } catch (ParseException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            String getEventTimeSubStringHour = temp.substring(0, 2);
            String getEventTimeSubStringMinute = temp.substring(3, 5);
            String getEventDateSubStringDay = temp2.substring(0, 2);
            String getEventDateSubStringMonth = temp2.substring(3, 5);
            String getEventDateSubStringYear = temp2.substring(6, 10);
            Toast.makeText(
                    this,
                    getEventTimeSubStringHour + " "
                            + getEventTimeSubStringMinute + " "
                            + getEventDateSubStringDay + " "
                            + getEventDateSubStringMonth + " "
                            + getEventDateSubStringYear, Toast.LENGTH_LONG)
                    .show();
            hourOfDay = Integer.parseInt(getEventTimeSubStringHour);
            minute = Integer.parseInt(getEventTimeSubStringMinute);
            day = Integer.parseInt(getEventDateSubStringDay);
            month = Integer.parseInt(getEventDateSubStringMonth);
            year = Integer.parseInt(getEventDateSubStringYear);
            int second = 0;
//          calendar.setTimeInMillis(System.currentTimeMillis());
//          calendar.clear();
            //calendar.set(year, month, day);
            calendar.set(Calendar.YEAR, year);
            calendar.set(Calendar.MONTH, month);
            calendar.set(Calendar.DAY_OF_MONTH, day);
            calendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
            calendar.set(Calendar.MINUTE, minute);
            calendar.set(Calendar.SECOND, second);

            Intent intent = new Intent(MessageService.this,
                    ServiceManager.class);
            PendingIntent callToServiceManager = PendingIntent.getService(
                    MessageService.this, 2, intent, 0);
            AlarmManager alarmToCallServiceManager = (AlarmManager) getSystemService(ALARM_SERVICE);
            alarmToCallServiceManager.set(AlarmManager.RTC_WAKEUP,
                    calendar.getTimeInMillis(), callToServiceManager); 
```

即使使用后`calendar.set(year, month, day, hourOfDay, minute, second)`什么也没有发生。请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T17:38:17.213

感谢 Eugen 指导我。原来是价值的问题，事实上，我将六月存储为第 7 个月而不是第 6 个月。我在这个月里加了 1，但它出现了问题。现在我已经修复了它，它现在工作正常。

# php - openid：无需重定向即可登录

> ID：10438240
> 
> 赞同：1
> 
> 时间：2012-05-03T19:40:01.003
> 
> 标签：php, flash, openid

我是opeid的新手，所以如果问题是转储，请原谅。我正在开发一个系统（在 PHP 上）以通过各种 openid-providers 统一登录。应该有几种方法（登录，检查用户是否登录等）。

问题是系统将被闪存使用。而且我不知道如何在没有重定向的情况下执行登录。这是我的问题：如果用户已经在 open-id 提供程序上登录（或使用不需要密码的 myopenid 等提供程序）并确认他允许使用他的个人信息，是否可以在不重定向的情况下登录（登录openid 提供程序上的页面）。一个例子会很棒！

将不胜感激任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T15:57:22.657

您应该[立即](http://openid.net/specs/openid-authentication-2_0.html#anchor28)向提供者发出请求，即将参数设置`openid.mode`为`checkid_immediate`. 无论身份验证是否成功，提供者都必须响应。如果身份验证不成功，您仍应执行重定向以允许用户进行身份验证。

# sql - 如何在不指定 column_name 的情况下更改所有列？

> ID：10438241
> 
> 赞同：2
> 
> 时间：2012-05-03T19:40:04.230
> 
> 标签：sql, sql-server

有没有一种方法可以将更改语句应用于表中的所有列而无需指定列名？这只会在我需要清理报告中的重复数据的临时表中使用。

这是我想知道是否可能的示例：

```
select T1.Column1, T1.Column2, T1.Column3, T2.Column1, T2.Column2
into #templateTable
from Table1 T1
join Table2 T2 on T1.Column1 = T2.Column2

alter table #templateTable
alter column * null 
```

我真正需要的是我的#tempTable 允许在它最初从中获取数据的列中存在空值，而这些列以前不允许空值。

最后，我不想浏览和编辑每一列有两个原因：

1.  从至少 10 个表中提取了许多列 (~50)。
2.  我不知道哪些允许 null 并且研究哪些允许我需要接下来的两天。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:13:22.810

丑陋的方式，但它至少可以在 SqlServer Management Studio 中工作（可能用作“字符串”）

```
select 'alter table ' + table_name + ' alter column '+ column_name +' ' + data_type + 
(case 
  when character_maximum_length is not null and CHARACTER_MAXIMUM_LENGTH <> -1 then ' (' + CAST(CHARACTER_MAXIMUM_LENGTH as varchar) +')' 
  when CHARACTER_MAXIMUM_LENGTH = -1 then '(MAX)'
  else '' end)  + ' null;'  from tempdb.information_schema.COLUMNS
where TABLE_NAME = '<YOUR TABLE NAME>'
and IS_NULLABLE='NO'; 
```

复制结果，粘贴并执行...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T19:57:45.987

我并没有完全收集你试图用你的临时表完成的事情，但就你的第一个问题而言，你可以在 sysobjects 表中查询你的表名，然后通过遍历 syscolumns 表来更改该表中的每一列

所以可以说我想遍历表主表中的每一列：

```
declare @i int
declare @colcount int
declare @column varchar(max)
declare @sql nvarchar(max)

set @i = 1
set @colcount = (select MAX(colID) from syscolumns where ID = (select id from sysobjects        
where name = 'master'))

WHILE @i < @colcount
BEGIN

set @column = (select name from syscolumns where ID = (select id from sysobjects where name = 'master') and colid = @i)

set @sql = 'select top 1000 [' + @column + '] from master'

EXECUTE(@sql)

set @i = @i + 1

End 
```

您可以将@sql更改为您需要的任何内容，并且应该得到它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:56:47.420

查看这个问题[Create a nullable column using SQL Server SELECT INTO?](https://stackoverflow.com/questions/5465245/create-a-nullable-column-using-sql-server-select-into)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:00:43.100

我猜这是一次性运行...

```
select 'alter table xxx alter column ' + columnname + ...
from information_schema.columns
where ... 
```

将结果复制并粘贴到单独的窗口中并运行。

# jsf-2 - 如果用户未登录，是否可以将 JSF 2.0 web.xml 配置为重定向到另一个上下文根？

> ID：10438242
> 
> 赞同：0
> 
> 时间：2012-05-03T19:40:05.167
> 
> 标签：jsf-2, weblogic11g

我需要为一个新的 JSF Web 应用程序实现安全性，该应用程序与一个“旧”的基于 JSP/servlet 的应用程序一起部署在单个 EAR 文件中（容器是 WebLogic 11g）。现在我有一个 JSF Phase Listener 来检查用户在他们的会话中是否有一个标志表明他们已经登录（请注意，“共享会话数据”已打开，以便两个 Web 应用程序使用相同的 HTTP 会话） .

如果可能，我宁愿不使用阶段侦听器，而是在 web.xml 中指定如果用户未登录，则将用户重定向到登录页面（这是在旧版 Web 应用程序中实施检查的方式）但是，登录页面位于与 JSF Web 应用程序不同的上下文根目录中的“旧版”应用程序中。（请注意，旧应用程序在比新 JSF Web 应用程序更旧的 servlet 容器版本上运行）。

如果 JSF Web 应用程序的 web.xml 文件具有不同的上下文根，有没有办法将它们配置为能够重定向到第一个 Web 应用程序的登录页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:14:21.980

在 WebLogic 11g 中似乎没有办法做到这一点（重定向到另一个上下文根的登录页面）。似乎 Phase Listener 解决方案是最好的方法。

注意 WebLogic 11g 确实允许在单个 EAR 中部署的 Web 应用程序之间共享会话和用户主体信息，但不支持将 URL 指定到与 web.xml 所在的当前 Web 应用程序不同的上下文根中的登录页面. 因此，需要一个类似 servlet 过滤器的解决方案，该解决方案可以重定向到其他 Web 应用程序中的登录页面。

# objective-c - 从 iOS 应用程序向 JS 表单发送数据

> ID：10438243
> 
> 赞同：1
> 
> 时间：2012-05-03T19:40:05.997
> 
> 标签：objective-c, ios, forms, jsp

红十字会有一个[定位器页面](http://www.redcross.org/where)，您可以在其中通过表单提交邮政编码，并通过 JSP 运行以返回您当地红十字会办公室的联系信息。

在 iOS 应用程序中，我有用户的邮政编码，并希望运行此过程并取回该联系信息……或者至少是要链接到的适当 URL。我希望我能找到某种方法通过 URL 传递邮政编码，但它看起来并不那么容易。

任何人都可以就如何解决这个问题提供一些指导吗？我以前用表单做过一些简单的事情，但我不太确定从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:04:01.500

根据`<form>`action 参数，这是您拥有`post`的数据的 URL： `http://www.redcross.org//portal/site/en/template.MAXIMIZE/ziplocator/;jsessionid=MWwKPvjSWmvz8p4XrRtNLVL0VCTM7fcwfnFnKHpwRhJTnwLMMDcv!-1938881463!-1334769155?javax.portlet.tpst=2bd907ea326f7e9e934afa36c23f78a0_ws_MX&javax.portlet.prp_2bd907ea326f7e9e934afa36c23f78a0_viewID=result&javax.portlet.begCacheTok=com.vignette.cachetoken&javax.portlet.endCacheTok=com.vignette.cachetoken&vgnextoid=6d65e821cbdf9110VgnVCM1000002bf3870aRCRD`

字段名称是`zipcode`。AFNetworking 文档很好地解释了如何发送 POST 请求。我还推荐 nsscreencasts 系列，他在 AFNetworking 上也有一集。

我希望这有帮助。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:14:08.363

您可以使用 NSURLConnection 执行发布请求并返回结果，尽管取决于返回的格式，您可能需要对结果进行一些解析。

这是一个例子：

[http://forums.macrumors.com/showthread.php?t=689884](http://forums.macrumors.com/showthread.php?t=689884)

NSURLConnection 文档：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)

# algorithm - 图，与一组点的距离最小的一组点

> ID：10438244
> 
> 赞同：0
> 
> 时间：2012-05-03T19:40:12.950
> 
> 标签：algorithm, graph, distance, graph-algorithm

> **可能重复：**
> [最小曼哈顿距离的算法](https://stackoverflow.com/questions/10402087/algorithm-for-minimum-manhattan-distance)

假设我有一个大的网格图和一组给定的节点 S。我想找到另一个节点/一组节点，以最小化从该点到给定节点集 S 的距离。边权重为 1。有没有除了穷举搜索之外的其他算法？

# java - 在 HttpSession 中存储关键数据是否安全？

> ID：10438245
> 
> 赞同：5
> 
> 时间：2012-05-03T19:40:17.587
> 
> 标签：java, google-app-engine

我将用户数据（例如姓名、密码和电子邮件）存储在您`HttpSession`的`setAttribute`.

我想知道将关键数据存储在`HttpSession`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:44:22.550

尝试将登录信息存储在以下用户存储库之一中（登录时检查有效性）：

*   内存中（比如说，它可能是一个 xml 文件），
*   基于 JDBC，
*   基于 LDAP。

这不是身份验证选项的完整列表。

您至少应该使用 SSL/HTTPS 登录和任何其他敏感数据。

看看这篇文章：[http ://en.wikipedia.org/wiki/Session_hijacking](http://en.wikipedia.org/wiki/Session_hijacking)

这是关于该问题的一个很好的 SO 讨论：[防止会话劫持的最佳方法是什么？](https://stackoverflow.com/questions/22880/what-is-the-best-way-to-prevent-session-hijacking)

这里还提到了一些安全问题：[每个程序员都应该了解 Web 开发什么？](https://softwareengineering.stackexchange.com/questions/46716/what-should-every-programmer-know-about-web-development)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T16:29:19.107

理想的做法是永远不要以应用程序的任何方式保存密码。理想情况下，如果您使用基于数据库的身份验证或使用 LDAP 身份验证，则密码需要加密保存在数据库的用户表中。

认证成功后，可以在http session中保留email、name等字段。最好在会话中保留用户名（这是唯一的），并且必须通过执行数据库读取从基于此用户名的数据库中读取配置文件信息。可以将此信息保存在 cookie 中，以便为经常访问者重新填充一些信息。

最重要的是不要将密码保存在隐藏变量、cookie 或查询字符串中。

必须保留的任何敏感信息都必须在 SESSION 中但已加密。

# c++ - 在 C++ 中，static_cast 之间有什么区别 （a）和双（a）？

> ID：10438249
> 
> 赞同：34
> 
> 时间：2012-05-03T19:40:25.020
> 
> 标签：c++, casting

之间有什么区别

```
int a;
// a gets some value
double pi = static_cast<double>(a)/3; 
```

和

```
int a;
// a gets some value
double pi = double(a)/3; 
```

你见过后者吗？在我看来，我在 Stroustrup 编写的一些片段中看到了它，但我找不到参考。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-03T20:07:47.793

有人可能认为他们是在构建而不是铸造。考虑：

```
some_fun(std::string("Hello")); 
```

许多人认为他们在那里调用了构造函数，而实际上他们正在执行 C 风格的转换。碰巧的是，强制转换将在它查看的一长串其他事物中查看目标类型的构造函数，因此在这里它最终会调用构造函数。

功能符号转换与其他类型的 C 转换具有所有相同的弱点：

*   可以不经意间抛弃 constness
*   可以默默地变成重新诠释的演员
*   很难用 grepping 工具区分。

除此之外，您在两种情况下都执行完全相同的操作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-03T19:45:28.740

后者被称为*显式转换的**功能符号*，您明确地说应该被视为. 您几乎可以使用这种技术将任何内容转换为任何类型。*`a``double`*

 *前者是在 C++ 中强制转换类型的首选方式。它会进行基本检查以查看您要转换的类型是否有意义（指向基类指针的子类指针等）。此外，就像您展示的示例一样，您可以执行隐式转换。从技术上讲`static_cast`，您的示例中的 是显式的，但操作（分配）的结果是隐式的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-03T20:12:55.420

`static_cast<double> (a)`和之间生成的汇编代码没有区别`(double) a`。强制转换符号 , 的主要优点`(type_id) cast_expression`是它更灵活。在一种情况下，它可能等价于 a `const_cast`，在另`static_cast`一种情况下，在另一种情况下，在另一种情况下，在另一种情况下，在另一种情况下，和（或）`dynamic_cast`的组合。`const_cast``static_cast``dynamic_cast`

这种力量也是一种弱点。演员表在不同的地方意味着不同的东西。另一个缺点是很容易找到`xxx_cast<type_id> (cast_expression)`。只需搜索`_cast`. 很难找到使用强制转换符号的表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-03T19:44:01.440

使用 static_cast 是一种安全的 C++ 风格的方式，但是 (double) - 不安全的旧 C 风格的方式。

看这里：[类型转换](http://www.cplusplus.com/doc/tutorial/typecasting/)*

# iphone - 如何通过 App 提供更大的数据库

> ID：10438250
> 
> 赞同：4
> 
> 时间：2012-05-03T19:40:26.800
> 
> 标签：iphone, database

我刚刚与 App 审核团队的一位成员聊天，有人告诉我，提供 10 MB 的 DB 对于获得批准的应用来说太大了。这位女士告诉我，我的应用程序的问题是我不符合存储指南的指南 2.23。他们，至少是我在电话里与之交谈的那个人声称，Apple 不会批准它在首次启动时复制 10 MB 数据库的应用程序。我正在将包含一组 > 50'000 条记录的数据库从资源文件夹复制到库文件夹中。我将数据库分为 2 个 DB，一个 DB，用户实际应用更改，另一个 DB，用户可以从中复制数据。

问题：是否有另一种方法可以代替从资源目录中复制数据库？我决定使用资源文件夹到库文件夹的方法，因为这是最快的并且在我看来是最用户友好的方法。当然，我可以让用户从互联网上下载数据库。但这是另一个过程步骤，我个人不希望作为最终用户进行。

我仍然没有来自 Apple 的任何规格，首次启动数据库的最大允许大小是多少。不知道，为什么苹果对这些信息如此模糊。

无论如何，我非常感谢您的评论和可能的解决方案。

勒内

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T15:29:23.113

我可能会在这里提到，我对这个问题的解决方案是根本不复制静态数据库。我只是将它放在包中并从那里读取数据。由于它是只读数据，因此该应用程序很好。苹果很高兴。更改后获得批准。感谢大家的支持。勒内

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T21:36:05.437

我有一个类似的问题。此处采用的正确方法是将文件移动到 Library/Caches 文件夹。该文件夹在内存不足的情况下会被清理，也不会备份到 iCloud。我有一个具有 36 MB 数据库文件的应用程序。但我不将它与应用程序捆绑在一起。当应用程序第一次打开时应用程序告诉用户下载一次数据库。这样，应用程序的大小就大大减小了。

您将数据库与应用程序捆绑在一起的任何具体原因？

# c++ - 我在 Xcode 中使用 C++11 时遇到了一些问题

> ID：10438253
> 
> 赞同：5
> 
> 时间：2012-05-03T19:40:47.290
> 
> 标签：c++, xcode, c++11, osx-lion

我是使用 Xcode for C++ 的 Mac OS X Lion 用户，似乎没有可用于 Xcode 的更新。我似乎无法编译 C++11 独有的代码，但无论出于何种原因，我认为 Apple 已经基本实现了 C++11。是的，我确实支持命令行工具。

再说一次，那可能只是我。如果是这样，是否有任何支持 C++11 的 IDE 或任何升级方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T19:51:53.573

我使用 Xcode 并设置以下设置：

**C++ 语言方言**：C++11 或 GNU++11

**C++ 标准库**：libc++（支持 C++11 的 LLVM C++ 标准库）

Xcode 版本：4.3.2

![XCode 项目设置](../Images/9a0f5c8eeac646bc79cd57f98aaf1418.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T19:48:57.657

如果您使用的是 Xcode 4.3，则需要使用 C++11 功能进行几个相关的项目设置。首先是使用clang编译器。就像是

```
GCC_VERSION = com.apple.compilers.llvm.clang.1_0 
```

在您的`.xcconfig`意愿中设置它，或者您可以使用 GUI。

接下来，您需要告诉 LLVM 使用哪个 C++ 标准：

```
CLANG_CXX_LANGUAGE_STANDARD = gnu++11 
```

这将使诸如基于范围的语言特性、委托构造函数等可用。

最后，如果要使用 C++11 STL 特性（例如`std::unordered_map`），则需要使用 libc++ STL：

```
CLANG_CXX_LIBRARY = libc++ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-02T06:53:33.560

在 XCode 5 / opencv 2.4.9 上，我可以选择：

![XCode 设置](../Images/87f2f3ddad42e63abb11b808c77c46a8.png)

它的构建没有错误。如果我在没有指定 C++ 语言方言的情况下设置 libc++，那么我会遇到与 OP 相同的问题

# ios - 如何在设备关闭时停止文本字段和选取的图像消失

> ID：10438254
> 
> 赞同：0
> 
> 时间：2012-05-03T19:40:49.020
> 
> 标签：ios, singleton, photo

如果我的应用程序停止运行或设备已关闭，我的文本字段和从图像选择器中选择的图像全部重置为空白，我该如何保留这些信息？

我使用了单例（在其他成员的帮助下），我可以保留我的图像……直到应用程序被杀死或设备被关闭。然后就没了。

.m

```
- (void)viewDidLoad
{
    singletonObj = [Singleton sharedSingletonController];
    imageView.image = singletonObj.imagePicked;
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setImageView:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
 {
     return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
 }

 #pragma mark - Action

- (IBAction)done:(id)sender
{
    [self.delegate flipsideViewControllerDidFinish:self];
}

- (IBAction)btn:(id)sender {

    UIImagePickerController * picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;

    if((UIButton *) sender == choosePhotoBtn) {
        picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
    }

    [self presentModalViewController:picker animated:YES];
}

- (void)imagePickerController:(UIImagePickerController*)picker didFinishPickingMediaWithInfo:(NSDictionary*)info

{
    NSData  *dataImage = UIImageJPEGRepresentation([info objectForKey:@"UIImagePickerControllerOriginalImage"],1);

    UIImage *img = [[UIImage alloc] initWithData:dataImage];
    singletonObj.imagePicked = img;
    imageView.image = img;
    [picker dismissModalViewControllerAnimated:YES];
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:50:47.397

内存有两种类型：易失性（RAM）和永久内存（即：硬盘驱动器和其他存储）。

当程序/计算机关闭时，易失性内存被清除并丢失。

使用单例很好，但它与将数据从会话保存到会话完全无关（*会话*是指程序运行的时间：从启动到终止应用程序）。

您需要使用任何您想要的方法存储您希望从会话到会话保存的数据到文件。根据您要存储的信息，有不同的专用保存机制：

*   （例如用户偏好的[NSUserDefaults](https://developer.apple.com/documentation/foundation/nsuserdefaults)）。
*   [Core Data](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreData/)是一个框架，它定义了结构化数据并将其保存/读取到文件（又名持久存储）的机制。
*   您也可以使用[序列化](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Archiving/Archiving.html)。
*   或者您可以随时手动操作文件。
*   [`NSData`](https://developer.apple.com/documentation/foundation/nsdata)具有[`writeToFile:atomically:`](https://developer.apple.com/documentation/foundation/nsdata/1408033-writetofile)它将从数据对象中写入创建文件。如果要保存图像，则必须获取 UIImage 的底层数据（即：）[`UIImagePNGRepresentation(...)`](https://developer.apple.com/documentation/uikit/1624096-uiimagepngrepresentation)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:10:25.817

您将不得不使用核心数据。它可以接受来自 UIIimage 的 NSData 以及 NSStrings。必须使用 appDelegate 中的函数 AppicationWillTerminate，以便在应用程序终止之前存储信息。

这将需要一些体面的工作才能使其正常工作，但没有什么太难的。如果你需要帮助理解核心数据，我推荐这个链接

[http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)

# c# - 使用 Microsoft.Build.Evaluation 发布数据库项目 (.sqlproj)

> ID：10438258
> 
> 赞同：14
> 
> 时间：2012-05-03T19:40:57.183
> 
> 标签：c#, visual-studio-2010, msbuild, msbuild-propertygroup, sql-server-data-tools

我需要能够以编程方式发布 SSDT 项目。我正在考虑使用 Microsoft.Build 来执行此操作，但找不到任何文档。创建 .dacpac 似乎很简单，但我将如何发布到现有数据库或至少发布到 .sql 文件。这个想法是让它做当我右键单击项目并选择发布时所做的事情。它应该与选定的数据库进行比较并生成升级脚本。

到目前为止，这是我创建 .dacpac 的内容：

```
partial class DBDeploy
{
  Project project;

  internal void publishChanges()
  {
     Console.WriteLine("Building project " + ProjectPath);
     Stopwatch sw = new Stopwatch();
     sw.Start();

     project = ProjectCollection.GlobalProjectCollection.LoadProject(ProjectPath);
     project.Build();
     //at this point the .dacpac is built and put in the debug folder for the project

     sw.Stop();
     Console.WriteLine("Project build Complete.  Total time: {0}", sw.Elapsed.ToString());

  }
} 
```

本质上，我正在尝试执行此[MSBuild 示例](http://sqlproj.com/index.php/2012/03/headless-msbuild-support-for-ssdt-sqlproj-projects/)显示的内容，但在代码中。

对不起，这就是我所拥有的。Build 类的文档很差。任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-13T12:03:53.827

我不得不做类似的事情，因为我们之前使用的 VSDBCMD 没有部署到 SQL Server 2012，我们需要支持它。我发现的是 Microsoft.SqlServer.Dac 程序集，它似乎是 SQL Server 数据工具的一部分（[http://msdn.microsoft.com/en-us/data/tools.aspx](http://msdn.microsoft.com/en-us/data/tools.aspx)）

当您在客户端计算机上运行它时，您将需要完整版本的 .NET 4 框架以及 SQL CLR 类型和 SQL T-SQL ScriptDOM 包，可在此处找到：http: [//www.microsoft.com/en-us/download /details.aspx?id=29065](http://www.microsoft.com/en-us/download/details.aspx?id=29065)

下面的代码来自我为测试新部署方法并部署给定的 .dacpac 文件而制作的模型

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using Microsoft.SqlServer.Dac;
    using System.IO;

    namespace ConsoleApplication3
    {
        class Program
        {
            private static TextWriter output = new StreamWriter("output.txt", false);
            static void Main(string[] args)
            {

                Console.Write("Connection String:");
                //Class responsible for the deployment. (Connection string supplied by console input for now)
                DacServices dbServices = new DacServices(Console.ReadLine());

                //Wire up events for Deploy messages and for task progress (For less verbose output, don't subscribe to Message Event (handy for debugging perhaps?)
                dbServices.Message += new EventHandler<DacMessageEventArgs>(dbServices_Message);
                dbServices.ProgressChanged += new EventHandler<DacProgressEventArgs>(dbServices_ProgressChanged);

                //This Snapshot should be created by our build process using MSDeploy
                Console.WriteLine("Snapshot Path:");

                DacPackage dbPackage = DacPackage.Load(Console.ReadLine());

                DacDeployOptions dbDeployOptions = new DacDeployOptions();
                //Cut out a lot of options here for configuring deployment, but are all part of DacDeployOptions
                dbDeployOptions.SqlCommandVariableValues.Add("debug", "false");

                dbServices.Deploy(dbPackage, "trunk", true, dbDeployOptions);
                output.Close();

            }

            static void dbServices_Message(object sender, DacMessageEventArgs e)
            {
                output.WriteLine("DAC Message: {0}", e.Message);
            }

            static void dbServices_ProgressChanged(object sender, DacProgressEventArgs e)
            {
                output.WriteLine(e.Status + ": " + e.Message);
            }
        }
    } 
```

这似乎适用于 2005 年及更高版本的所有 SQL Server 版本。Microsoft.SqlServer.Management.Dac 中有一组类似的对象可用，但我相信这是在 DACFx 的先前版本中，并且不包含在最新版本中。因此，如果可以，请使用最新版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T14:04:33.253

我们需要一种方法来告诉 msbuild 如何以及在哪里发布。在 Visual Studio 中打开您的项目并开始使用`Publish`它。在对话框中输入所有需要的信息，包括您的数据库连接信息和任何自定义 SQLCMD 变量值。`Save Profile As...`到一个文件，例如 Northwind.publish.xml。（然后你可以`Cancel`。）现在我们可以使用这个和项目文件来构建和发布：

```
// Create a logger.
FileLogger logger = new FileLogger();
logger.Parameters = @"logfile=Northwind.msbuild.log";
// Set up properties.
var projects = ProjectCollection.GlobalProjectCollection;
projects.SetGlobalProperty("Configuration", "Debug");
projects.SetGlobalProperty("SqlPublishProfilePath", @"Northwind.publish.xml");
// Load and build project.
var dbProject = ProjectCollection.GlobalProjectCollection.LoadProject(@"Northwind.sqlproj");
dbProject.Build(new[]{"Build", "Publish"}, new[]{logger}); 
```

这可能需要一段时间，并且可能会卡住。要有耐心。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T18:48:45.730

您应该使用[SqlPackage.exe](http://msdn.microsoft.com/en-us/library/hh550080%28v=vs.103%29.aspx?ppud=4)来发布您的 dacpac。

```
SqlPackage.exe 
  /Action:Publish 
  /SourceFile:C:/file.dacpac 
  /TargetConnectionString:[Connection string] 
```

此外，您可以将设置保存到 DAC 发布配置文件中，而不是传递太多参数（这可以从 Visual Studio 完成）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-08T18:24:00.273

我想基于 sqlproj 文件构建和发布数据库，并将有用的信息记录到控制台。这是我得出的结论：

```
using Microsoft.Build.Framework;
using Microsoft.Build.Execution;

public void UpdateSchema() {
    var props = new Dictionary<string, string> {
        { "UpdateDatabase", "True" },
        { "PublishScriptFileName", "schema-update.sql" },
        { "SqlPublishProfilePath", "path/to/publish.xml") }
    };

    var projPath = "path/to/database.sqlproj";

    var result = BuildManager.DefaultBuildManager.Build(
        new BuildParameters { Loggers = new[] { new ConsoleLogger() } },
        new BuildRequestData(new ProjectInstance(projPath, props, null), new[] { "Publish" }));

    if (result.OverallResult == BuildResultCode.Success) {
        Console.WriteLine("Schema update succeeded!");
    }
    else {
        Console.ForegroundColor = ConsoleColor.Red;
        Console.WriteLine("Schema update failed!");
        Console.ResetColor();
    }
}

private class ConsoleLogger : ILogger
{
    public void Initialize(IEventSource eventSource) {
        eventSource.ErrorRaised += (sender, e) => {
            Console.ForegroundColor = ConsoleColor.Red;
            Console.WriteLine(e.Message);
            Console.ResetColor();
        };
        eventSource.MessageRaised += (sender, e) => {
            if (e.Importance != MessageImportance.Low)
                Console.WriteLine(e.Message);
        };
    }
    public void Shutdown() { }
    public LoggerVerbosity Verbosity { get; set; }
    public string Parameters { get; set; }
} 
```

这适用于 .NET 4 及更高版本。确保并包含对**Microsoft.Build**和**Microsoft.Build.Framework**的程序集引用。

# javascript - 使用 keydown() 仅发送一个 Ajax 发布请求 - jQuery

> ID：10438263
> 
> 赞同：1
> 
> 时间：2012-05-03T19:41:11.940
> 
> 标签：javascript, jquery, ajax, events, keydown

所以这是我的情况：

*   我在一个类“.editable”中有一堆 DOM 元素，它们附加了 contentEditable 属性。

*   对于每个元素，我用 实例化一个 Ajax POST `keydown()`，但在发送 ajax 请求之前，我检查 keydown() 是否给了我一个 TAB 或一个 ENTER 键，如果是，那么 ajax POST 成功。

我现在遇到的问题是，如果按住 TAB 键或 ENTER 键，我最终会发送多个 Ajax POST。我将如何阻止这一切？

注意：我不想用 .off() 分离事件，因为我希望这些事件在 ajax POST 完成后仍然存在。

任何帮助或建议将不胜感激！

```
(function($, window, document) {

  /* Namespace */
  $.fn.SaveEditable = function() {  
        var settings = {
            context: null,
            position: null,
            content: "(empty)",
            element: "(empty)",
            data_id: "(empty)"
        };

        var s, keyCode;

        function init(e, options) {         
          s = $.extend({}, settings, options);
          keyCode = e.keyCode || e.which;           

            //If Enter or Tab key is pressed
            if(keyCode == 9 || keyCode == 13) { 
                e.preventDefault();
                s.context.blur();
                sendAjax();
            }
        } //End init

        function sendAjax() {
           $.ajax({
              url: 'save.php',
              type: 'POST',
              data: { user_id: <?=$user_id;?>, sort_id: <?=$currentSort;?>, element: s.element, data_id: s.data_id, content: s.content },

              success: function (data) {
                if(data) {
                    var obj = jQuery.parseJSON(data);
                    //Do something with obj
                }
                $(".ajax-status")
                .addClass("success")
                .html("Updated content successfully");
              },

              error: function() {
                $(".ajax-status")
                .addClass("error")
                .html("An error has occurred. Please try again.");
              }
          });        
         } //End sendAjax

        /* Initilize */
        return this.each(function(i, domEl) {               
            $(this).on({
                keydown: function(e) {
                    init(e, {
                        context: $(this),
                        position: i,
                        content: $(this).text(),
                        element: $(this).data('element'),
                        data_id: $(this).data('id')
                    });
                 }
            });
        });
  };
})(jQuery, window, document); 
```

然后它是这样调用的：

```
$('.editable').SaveEditable(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:24:07.870

这是一个阻止 XHR 请求的示例，如果它仍然处于挂起状态

```
$(function(){
    var xhr;
    $("#my-input").keydown(function(){    
         if (!xhr || xhr.readyState === 4) {
            xhr = $.ajax({...});
         }
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:43:05.860

嗯，使用`keyup`事件怎么样？

正如[jQuery 文档](http://api.jquery.com/keyup/)中所说：

> 当用户在键盘上释放一个键时，keyup 事件被发送到一个元素。

**更新：**为了修复元素焦点，您可以`keydown`使用以下方式离开事件：

```
keydown: function(e) {
    e.preventDefault();
    if ((e.keyCode || e.which) == 9) {
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T21:52:38.220

```
 function init(e, options) {
      var check = true;
      s = $.extend({}, settings, options);
      keyCode = e.keyCode || e.which;           

        //If Enter or Tab key is pressed
        if(keyCode == 9 || keyCode == 13) { 
                e.preventDefault();
                s.context.blur();
                if(check)
                    sendAjax();
                check = false;
        }

    } //END init 
```

在键设置检查回到真。

# php - 无法使用 file_get_contents() 获取正确格式的 json

> ID：10438267
> 
> 赞同：0
> 
> 时间：2012-05-03T19:41:21.453
> 
> 标签：php, json, file-get-contents

我将参数解析为 php 文件并尝试使用 file_get_contents() 获取 json。这是我的代码：

```
< ?php
    $url = $_GET['url'];
    $url = urldecode($url);
    $json = file_get_contents($url, true);
    echo($json);
? > 
```

这是被调用的 URL：http: [//vimeo.com/api/v2/channel/photographyschool/videos.json](http://vimeo.com/api/v2/channel/photographyschool/videos.json)

这是我的结果的一部分：

```
[{"id":40573637,"title":"All For Nothing - \"Dead To Me\" & \"Twisted Tongues\""}] 
```

等等......所以一切都逃脱了。结果中甚至还有 \n 。

由于之后我需要使用 json（在 js 中），我需要一个非转义版本！

有趣的是，我的代码例如适用于这个 json：http: [//xkcd.com/847/info.0.json](http://xkcd.com/847/info.0.json)

我的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T19:43:53.527

用这个：

```
echo json_decode($json); 
```

**编辑：**忘记上面的。尝试添加：

```
header('Content-Type: text/plain'); 
```

以上

```
$url = $_GET['url']; 
```

看看是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:53:07.593

如果您只想代理/转发响应，则只需使用正确的 Content-Type 标头回显它：

```
<?php
    header('Content-Type: application/json');
    $json = file_get_contents('http://vimeo.com/api/v2/channel/photographyschool/videos.json');
    echo $json;
?> 
```

你必须非常小心传递的 url，因为它可能导致 XSS！

由于 API 很慢/资源匮乏，您应该缓存结果或至少将其保存在会话中，这样它就不会在每次页面加载时重复。

```
<?php
$cache = './vimeoCache.json';
$url = 'http://vimeo.com/api/v2/channel/photographyschool/videos.json';

//Set the correct header
header('Content-Type: application/json');

// If a cache file exists, and it is newer than 1 hour, use it
if(file_exists($cache) && filemtime($cache) > time() - 60*60){
    echo file_get_contents($cache);
}else{
    //Grab content and overwrite cache file
    $jsonData = file_get_contents($url);
    file_put_contents($cache,$jsonData);
    echo $jsonData;
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:45:37.233

你应该使用 json_decode ： [http ://php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T19:46:11.607

更好的是，您在哪里交付您的 json 使用：

```
json_encode(array(
    "id" => 40573637,
    "title" => 'All For Nothing - "Dead To Me" & "Twisted Tongues"'
)); 
```

# c# - XML阅读器过度泛滥listBox

> ID：10438268
> 
> 赞同：0
> 
> 时间：2012-05-03T19:41:21.967
> 
> 标签：c#, xml, visual-studio, stringbuilder, xmlreader

作为 c# 的初学者，我正在用以下内容撞墙：

基本上，这样做的目的是尝试将有关以 xml 格式格式化的类的信息读入表（列表框）中……这不会发生。

所以，我试图读取 xml 并将字符串生成器附加到每行打印到列表框。

而是在 1713 行上打印了相同的语句。这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml;

namespace StartProgram
{
    public partial class ModuleSummary : Form
    {
        public ModuleSummary()
        {
            InitializeComponent();
            XmlTextReader moduleReader = new XmlTextReader("c:\\users\\w1283057\\documents\\visual studio 2010\\Projects\\StartProgram\\StartProgram\\myCourses.xml");
            //to revise...

            System.Text.StringBuilder moduleEntry = new System.Text.StringBuilder();
            while(moduleReader.Read())
            {
                if ((moduleReader.NodeType == XmlNodeType.Element) && (moduleReader.Name == "moduleCode"))
                    {                        
                        moduleEntry.Append(moduleReader.ReadElementContentAsString() + " ");
                    }
                    if ((moduleReader.NodeType == XmlNodeType.Element) && (moduleReader.Name == "moduleTitle"))
                    {
                        moduleEntry.Append(moduleReader.ReadElementContentAsString() + " ");
                    }
                    if ((moduleReader.NodeType == XmlNodeType.Element) && (moduleReader.Name == "credits"))
                    {
                        moduleEntry.Append(moduleReader.ReadElementContentAsString()+" ");
                    }
                    if ((moduleReader.NodeType == XmlNodeType.Element) && (moduleReader.Name == "level"))
                    {
                        moduleEntry.Append(moduleReader.ReadElementContentAsString() + " ");
                    }
                    if ((moduleReader.NodeType == XmlNodeType.Element) && (moduleReader.Name == "semester"))
                    {
                        moduleEntry.Append(moduleReader.ReadElementContentAsString() + " test ");
                    }
                    moduleSummaryBox.Items.Add(moduleEntry);
            }
        }
        private void button1_Click(object sender, EventArgs e)
        {
            AddModule frm = new AddModule();
            frm.Show();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:51:53.850

您需要使用 XmlDocument 读取您的 XML 并以这种方式解析它。网上有很多教程.. [http://www.functionx.com/csharp2/xml/Lesson02d.htm](http://www.functionx.com/csharp2/xml/Lesson02d.htm)

# ruby-on-rails-3 - 如何在 Windows 上的 Rails 3 + Thin 中禁用静态文件缓存

> ID：10438276
> 
> 赞同：1
> 
> 时间：2012-05-03T19:41:49.153
> 
> 标签：ruby-on-rails-3, caching, windows-server-2008, thin, static-files

我有静态文件，这些文件通过我的 Rails 3 应用程序中的 Thin 提供服务。这些文件没有路径，它们只是通过 url 直接引用。但是，似乎文件正在被缓存。我不确定缓存是由于 Web 服务器 (Thin) 还是由于浏览器 (Chrome) 而发生的。

**有没有办法在 Rails 3 或 Windows 上的 Thin 中禁用静态文件缓存？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:46:02.200

强制禁用缓存`config.action_controller.perform_caching = false`

尝试检查的其他选项

```
config.serve_static_assets = false

config.static_cache_control = "public, max-age=0"

config.assets.digest = false 
```

[https://devcenter.heroku.com/articles/rack-cache-memcached-static-assets-rails31#serve_static_assets](https://devcenter.heroku.com/articles/rack-cache-memcached-static-assets-rails31#serve_static_assets)

* * *

要禁用浏览器缓存，您可以尝试

application_controller.rb..

```
 before_filter :set_cache_buster

  def set_cache_buster
    response.headers["Cache-Control"] = "no-cache, no-store, max-age=0, must-revalidate"
    response.headers["Pragma"] = "no-cache"
    response.headers["Expires"] = "Fri, 01 Jan 1990 00:00:00 GMT"
  end 
```

信用[https://stackoverflow.com/a/748646/643500](https://stackoverflow.com/a/748646/643500)

* * *

对于服务器配置，您可以更改缓存标头，例如：

对于阿帕奇：

```
<LocationMatch "^/assets/.*$">
  Header unset ETag
  FileETag None
  # RFC says only cache for 1 year
  ExpiresActive On
  ExpiresDefault "access plus 1 year"
</LocationMatch> 
```

[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

# c# - 带有 Windows 窗体应用程序的 C# 套接字服务器

> ID：10438281
> 
> 赞同：5
> 
> 时间：2012-05-03T19:42:10.400
> 
> 标签：c#, sockets

我搜索了很多，但互联网上的所有示例都是控制台应用程序。我已经尝试对 Windows 表单使用控制台应用程序示例，但是当我调用 socket.start 时，表单冻结并且状态更改为（不响应）。我也尝试了多个线程，但也没有成功。如果可能的话，请给我一些建议。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;
using System.Threading;

namespace mserver1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            ServerClass sc = new ServerClass();
            sc.startServer(textBox1, richTextBox1);
        }
    }

    public class ServerClass
    {
        public void startServer(TextBox tb, RichTextBox rb)
        {

            IPEndPoint ip = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 9939);
            Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

            socket.Bind(ip);
            socket.Listen(20);
            rb.Text = rb.Text + "Waiting for client...";
            Socket client = socket.Accept();
            IPEndPoint clientep = (IPEndPoint)client.RemoteEndPoint;

            rb.Text = rb.Text + "Connected with " + clientep.Address + " at port " + clientep.Port;

            string welcome = tb.Text;
            byte[] data = new byte[1024];
            data = Encoding.ASCII.GetBytes(welcome);
            client.Send(data, data.Length, SocketFlags.None);

            rb.Text = rb.Text + "Disconnected from" + clientep.Address;
            client.Close();
            socket.Close();
        }
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T19:48:17.097

您的应用程序将一直阻塞，直到 button1_Click 返回。

您需要生成一个工作线程来进行聆听。此外，您不应将控件直接传递到工作线程。相反，您应该有一个回调，它将使用来自套接字通信的数据填充您的控件。

查找有关 BackgroundWorker 的信息。这会让你到达你需要去的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-06T17:31:26.687

我有同样的问题，请按照我的服务器解决方案

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

using System.Net;
using System.Net.Sockets;

using System.Threading;

namespace SERVER_WIN
{
    public partial class Form1 : Form
    {

        //Declare and Initialize the IP Adress
        static IPAddress ipAd = IPAddress.Parse("10.1.42.31");

        //Declare and Initilize the Port Number;
        static int PortNumber = 8888;

        /* Initializes the Listener */
        TcpListener ServerListener = new TcpListener(ipAd, PortNumber);
        TcpClient clientSocket = default(TcpClient);

        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Thread ThreadingServer = new Thread(StartServer);
            ThreadingServer.Start();
        }

        private void THREAD_MOD(string teste)
        {
            txtStatus.Text += Environment.NewLine + teste;
        }

        private void StartServer()
        {
            Action<string> DelegateTeste_ModifyText = THREAD_MOD;            
            ServerListener.Start();
            Invoke(DelegateTeste_ModifyText, "Server waiting connections!");
            clientSocket = ServerListener.AcceptTcpClient();
            Invoke(DelegateTeste_ModifyText, "Server ready!");

            while (true)
            {
                try
                {

                    NetworkStream networkStream = clientSocket.GetStream();
                    byte[] bytesFrom = new byte[20];
                    networkStream.Read(bytesFrom, 0, 20);
                    string dataFromClient = System.Text.Encoding.ASCII.GetString(bytesFrom);
                    dataFromClient = dataFromClient.Substring(0, dataFromClient.IndexOf("$"));

                    string serverResponse = "Received!";
                    Byte[] sendBytes = Encoding.ASCII.GetBytes(serverResponse);
                    networkStream.Write(sendBytes, 0, sendBytes.Length);
                    networkStream.Flush();
                }
                catch
                {
                    ServerListener.Stop();
                    ServerListener.Start();
                    Invoke(DelegateTeste_ModifyText, "Server waiting connections!");
                    clientSocket = ServerListener.AcceptTcpClient();
                    Invoke(DelegateTeste_ModifyText, "Server ready!");
                }

            }
        }
    }
} 
```

您只需要在 Windows 窗体中放入一个名为 txtStatus 的控件 TextView。

客户计划：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

using System.Net;
using System.Net.Sockets;
using System.IO;

namespace CLIENT_WIN
{
    public partial class Form1 : Form
    {
        TcpClient tcpclnt = new TcpClient();

        //Declare and Initialize the IP Adress
        IPAddress ipAd = IPAddress.Parse("10.1.42.31");

        //Declare and Initilize the Port Number;
        int PortNumber = 8888;

        public Form1()
        {
            InitializeComponent();

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Console.WriteLine("Connecting.....");
            try
            {
                tcpclnt.Connect(ipAd, PortNumber);
                txtStatus.Text += Environment.NewLine + "Connected";
                txtStatus.Text += Environment.NewLine + "Enter the string to be transmitted";
            }
            catch { }
        }

        private void btnEnviar_Click(object sender, EventArgs e)
        {
            String str = txtEnviar.Text + "$";
            Stream stm = tcpclnt.GetStream();

            ASCIIEncoding asen = new ASCIIEncoding();
            byte[] ba = asen.GetBytes(str);

            txtStatus.Text += Environment.NewLine + "Transmitting...";
            //Console.WriteLine("Transmitting.....");

            stm.Write(ba, 0, ba.Length);

            byte[] bb = new byte[100];
            int k = stm.Read(bb, 0, 100);

            string Response = Encoding.ASCII.GetString(bb);

            txtStatus.Text += Environment.NewLine + "Response from server: " + Response;

        }
    }
} 
```

对于客户，您需要进行一些控制；两个 TextView（txtStatus 和 txtEnviar）和一个名为 btnEnviar 的按钮，就是这样！

你必须首先运行服务器，然后才能运行客户端，如果你需要停止客户端，不要担心你可以让服务器运行。

# asp.net - 如何在 SQL Server 参数中存储超过 4000 个字符？

> ID：10438283
> 
> 赞同：1
> 
> 时间：2012-05-03T19:42:16.803
> 
> 标签：asp.net, sql-server, xml, sql-server-2005

我正在尝试将`XML`大于 4000 个字符的字符传递给存储过程。我试过使用`NTEXT`, `NVARCHAR(MAX)`, `VARCHAR(MAX)`,`VARCHAR(8000)`和`XML`作为参数类型，但我总是得到错误：

> System.Data.SqlClient.SqlException：字符串或二进制数据将被截断。该语句已终止。

该值没有存储到表中，它只是一个变量，从中选择了数据然后存储到表中。

ASP.NET 不能发送超过 4000 个字符作为参数吗？或者我可以关闭 SQL Server 中的设置吗？

谢谢，

托马斯

编辑：

这是与`NTEXT`. 我查看了错误详细信息，发现 SQL 的哪一行导致了错误，结果发现有一个完全不相关的列设置为`VARCHAR(50)`应该是`VARCHAR(MAX)`- 我假设它来自 10000 个字符`XML`，但它完全不相关。我很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T15:45:18.083

将 XML 分成更小的块并将它们分配给单独的变量，然后将它们连接起来

声明@SQL1，@SQL2

SET @SQL1=chunk1

SET @SQL2=chunk2

SET @SQLn=chunkn

执行 (@SQL1+@SQL2.....+@SQLn)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T10:39:07.527

这是所有版本中的 sql server 限制。您可以将 xml 拆分为两个 varchar 变量并将它们合并到存储过程中。这是该问题的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T21:12:37.533

似乎有几种方法可以做到这一点。[这](http://www.codedementia.com/blogs/?p=5 "博客")就是我最近的做法。

# c# - 如何从 Xml 文档中去除命名空间

> ID：10438284
> 
> 赞同：3
> 
> 时间：2012-05-03T19:42:18.737
> 
> 标签：c#, xml, xml-parsing

为了使专有的 Parse() 函数正常工作，我在从文档中删除命名空间时遇到了一些麻烦。我收到一个如下所示的 XML 字符串：

```
<r xmlns:p="p" xmlns:s="s" p:p="1">
<d id="{FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3}">
    <r uid="{F72A4E1A-519B-42DA-A1E8-F7D10EA92C65}" p:before="r[@uid='{15E0854F-39D8-4890-8541-9C4102C0F944}']" s:id="{6AF25CA3-6AB7-4792-B582-5DE0DF6349D7}" s:ph="/body/main/tab_content/body_content_column"/>
    <r uid="{15E0854F-39D8-4890-8541-9C4102C0F944}" p:before="r[@uid='{7CCB5501-52DF-49F6-BE71-E7B0CA68EE3B}']" s:id="{FD61546D-1226-4292-85F2-656883507F45}" s:ph="/body/main/tab_content/body_content_column"/>
    <r uid="{7CCB5501-52DF-49F6-BE71-E7B0CA68EE3B}" p:before="r[@uid='{17AC1E20-55CB-4EA1-9073-35D9E776C9A3}']" s:id="{1778C38C-071A-4219-A141-4686B095E361}" s:ph="/body/main/tab_content"/>
    <r uid="{17AC1E20-55CB-4EA1-9073-35D9E776C9A3}" p:before="r[@uid='{9B34F931-3C72-40D2-90B7-D4DCC81163D5}']" s:id="{C1CF5E12-1793-4F2C-B49C-00D30F0F501F}" s:ph="/body/hero/booking_widget"/>
    <r uid="{9B34F931-3C72-40D2-90B7-D4DCC81163D5}" p:before="r[@uid='{957B0932-A2B0-406F-A2D4-8C37E9F9D3A7}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{DF8E2887-0BCA-4C46-B2E4-02CDD3652892}" s:par="" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{957B0932-A2B0-406F-A2D4-8C37E9F9D3A7}" p:before="r[@uid='{B6EBC78C-5C85-4256-9F9D-3DF2F907DFA6}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{69FF80E2-6E79-4556-AC95-E409121B15C7}" s:par="MapSize=mini" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{B6EBC78C-5C85-4256-9F9D-3DF2F907DFA6}" p:before="r[@uid='{6700A64F-D8B7-44D3-8BE8-A162563ADB01}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{A6F5FC25-AB71-4C3B-B7FA-EF1F790DA86A}" s:par="" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{6700A64F-D8B7-44D3-8BE8-A162563ADB01}" p:before="r[@uid='{9863B72F-AE05-4D34-B271-E1AD6D67B946}']" s:id="{0430BDF5-8E53-4B12-A8A2-C098F667E575}" s:ph="/body/main/tab_content/print_share_toolbar"/>
    <r uid="{9863B72F-AE05-4D34-B271-E1AD6D67B946}" p:before="r[@uid='{166944E6-FCEA-4CE6-A5DC-EC317337046B}']" s:id="{FDF0D36C-1863-4DAA-BB68-555A2F3A270A}" s:ph="/body/main/tab_menu"/>
    <r uid="{166944E6-FCEA-4CE6-A5DC-EC317337046B}" p:before="r[@uid='{E98B1E29-46AF-46A3-89C0-441443E97BA0}']" s:id="{F94A415B-6922-43F2-9DEE-F012DE1497BA}" s:ph="/body/main"/>
    <r uid="{E98B1E29-46AF-46A3-89C0-441443E97BA0}" p:before="r[@uid='{B03EF589-3103-448A-8105-BFC33BA953D0}']" s:id="{EAFA90C7-136A-41C8-9AE9-8B1123E7E3C9}" s:ph="body"/>
    <r uid="{969938EE-BF4F-4A42-BA30-A7AE12183B08}">
        <p:d/>
    </r>
    <r uid="{AAA093DC-A63F-4538-A94B-ECBB509008F5}">
        <p:d/>
    </r>
    <r uid="{16A7A1FE-5FB4-4394-B053-58147F3B584D}">
        <p:d/>
    </r>
    <r uid="{4CD0B2F1-CAC8-4C03-B11E-56AE8A2589E1}" p:before="*[1=2]"/>
</d>
</r> 
```

我正在使用编辑实用程序以 HTML 格式查看上述 XML，该格式显示与以下内容相同的输出：

```
<r xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<d id="{FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3}" l="{EAB1DFDD-9918-4158-862B-BC3FD02B00CC}">
    <r id="{FC207214-4E05-40E9-B3C5-49AE41B6A323}" ph="head" uid="{B03EF589-3103-448A-8105-BFC33BA953D0}"/>
    <r id="{EAFA90C7-136A-41C8-9AE9-8B1123E7E3C9}" ph="body" uid="{969938EE-BF4F-4A42-BA30-A7AE12183B08}"/>
    <r id="{9325E0F7-A4B5-46EC-B178-E7EF051FB1FE}" ph="hero" uid="{6C998C3F-C968-466A-AB3A-C9C12C78A389}"/>
    <r id="{7728075C-15DE-4DBE-9018-32794A1540F0}" ph="breadcrumb" uid="{593B65AF-BFA4-45F0-9EF0-12806CF54468}"/>
    <r id="{C1CF5E12-1793-4F2C-B49C-00D30F0F501F}" ph="booking_widget" uid="{AAA093DC-A63F-4538-A94B-ECBB509008F5}"/>
    <r id="{2BA579A5-06C8-41D7-B170-EA745D4CDE8E}" ph="image_rotator" uid="{CC96DC9A-60EB-4C68-8F32-06838EB69818}"/>
    <r uid="{F8E91E5B-1C55-42F6-96C2-52B1FE86ECEA}" id="{C8B42985-3D99-4E08-951C-2C3A98A737B4}" ph="main"/>
    <r uid="{209FDA28-CA6D-4306-9587-294E35849620}" id="{0430BDF5-8E53-4B12-A8A2-C098F667E575}" ph="print_share_toolbar"/>
    <r id="{F94A415B-6922-43F2-9DEE-F012DE1497BA}" ph="main" uid="{B14A545D-F2F1-4AAB-8463-8034ABD06826}"/>
    <r id="{FDF0D36C-1863-4DAA-BB68-555A2F3A270A}" ph="tab_menu" uid="{16A7A1FE-5FB4-4394-B053-58147F3B584D}"/>
    <r id="{1778C38C-071A-4219-A141-4686B095E361}" ph="/body/main/tab_content" uid="{4CD0B2F1-CAC8-4C03-B11E-56AE8A2589E1}"/>
    <r id="{E863286C-76C6-4078-A718-09E0AF129D68}" ph="foot" uid="{D6163B3C-0B93-4ADE-8657-E6AB4DF84B1E}"/>
    <r uid="{26A873D4-2928-401D-A5AF-F71041A65AB9}" cac="0" cnd="" mvt="" ds="" id="{2834C1FA-1150-4784-B4DF-A743DB3EF0F4}" par="" ph="special_rates_sidebar" vbd="0" vbdev="0" vbl="0" vbp="0" vbqs="0" vbu="0"/>
</d>
<d id="{46D2F427-4CE5-4E1F-BA10-EF3636F43534}" l="{1B03BFE2-32C4-4C12-A4AE-C966CEB3F7FD}">
    <r id="{E7FB95F1-9E08-412E-A9DF-7F338C74D220}" ph="head" uid="{C409527B-CDC3-4D20-B9DD-27DE389904C7}"/>
    <r cac="0" cnd="" mvt="" ds="" id="{789ABFC6-2950-485D-B600-C139B7FEAA9B}" par="" ph="" uid="{E63EE34C-639D-493F-A3BC-DCF782EFC75B}" vbd="0" vbdev="0" vbl="0" vbp="0" vbqs="0" vbu="0"/>
    <r cac="0" cnd="" mvt="" ds="" id="{255C6F91-525C-4665-B897-1CF9282F59AA}" par="" ph="body" uid="{2373A2F1-3AD8-440E-B401-1169BF6BB8AA}" vbd="0" vbdev="0" vbl="0" vbp="0" vbqs="0" vbu="0"/>
</d>
</r> 
```

这是我需要 XML 的格式，以便引用的`Parse()`函数正确解析数据。但是，我似乎无法让它在代码中工作。我已经尝试过这里描述的解决方案：[如何删除命名空间前缀。(C#)](https://stackoverflow.com/questions/3052030/how-to-remove-namespace-prefix-c)但是当我调用`Remove()`方法时，`s:`前缀会转换为`p:7`.

有人可以给我一些关于如何将我的第一个示例转换为我的第二个示例的建议。

**编辑：这是我现在拥有的代码和我得到的输出**

```
XDocument xDoc = XDocument.Parse(renderingProperty);
xDoc.Root.RemoveAttributes();
xDoc.Root.Add(new XAttribute(XNamespace.Xmlns + "xsi", "http://www.w3.org/2001/XMLSchema-instance\\"));
xDoc.Root.Add(new XAttribute(XNamespace.Xmlns + "xsd", "http://www.w3.org/2001/XMLSchema\\")); 
```

**输出**

```
<r xmlns:p="p" xmlns:s="s" p:p="1">
<d id="{FE5D7FDF-89C0-4D99-9AA3-B5FBD009C9F3}">
    <r uid="{F72A4E1A-519B-42DA-A1E8-F7D10EA92C65}" p:before="r[@uid='{15E0854F-39D8-4890-8541-9C4102C0F944}']" s:id="{6AF25CA3-6AB7-4792-B582-5DE0DF6349D7}" s:ph="/body/main/tab_content/body_content_column"/>
    <r uid="{15E0854F-39D8-4890-8541-9C4102C0F944}" p:before="r[@uid='{7CCB5501-52DF-49F6-BE71-E7B0CA68EE3B}']" s:id="{FD61546D-1226-4292-85F2-656883507F45}" s:ph="/body/main/tab_content/body_content_column"/>
    <r uid="{7CCB5501-52DF-49F6-BE71-E7B0CA68EE3B}" p:before="r[@uid='{17AC1E20-55CB-4EA1-9073-35D9E776C9A3}']" s:id="{1778C38C-071A-4219-A141-4686B095E361}" s:ph="/body/main/tab_content"/>
    <r uid="{17AC1E20-55CB-4EA1-9073-35D9E776C9A3}" p:before="r[@uid='{9B34F931-3C72-40D2-90B7-D4DCC81163D5}']" s:id="{C1CF5E12-1793-4F2C-B49C-00D30F0F501F}" s:ph="/body/hero/booking_widget"/>
    <r uid="{9B34F931-3C72-40D2-90B7-D4DCC81163D5}" p:before="r[@uid='{957B0932-A2B0-406F-A2D4-8C37E9F9D3A7}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{DF8E2887-0BCA-4C46-B2E4-02CDD3652892}" s:par="" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{957B0932-A2B0-406F-A2D4-8C37E9F9D3A7}" p:before="r[@uid='{B6EBC78C-5C85-4256-9F9D-3DF2F907DFA6}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{69FF80E2-6E79-4556-AC95-E409121B15C7}" s:par="MapSize=mini" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{B6EBC78C-5C85-4256-9F9D-3DF2F907DFA6}" p:before="r[@uid='{6700A64F-D8B7-44D3-8BE8-A162563ADB01}']" s:cac="0" s:cnd="" s:mvt="" s:ds="" s:id="{A6F5FC25-AB71-4C3B-B7FA-EF1F790DA86A}" s:par="" s:ph="/body/main/tab_content/body_tile_column" s:vbd="0" s:vbdev="0" s:vbl="0" s:vbp="0" s:vbqs="0" s:vbu="0"/>
    <r uid="{6700A64F-D8B7-44D3-8BE8-A162563ADB01}" p:before="r[@uid='{9863B72F-AE05-4D34-B271-E1AD6D67B946}']" s:id="{0430BDF5-8E53-4B12-A8A2-C098F667E575}" s:ph="/body/main/tab_content/print_share_toolbar"/>
    <r uid="{9863B72F-AE05-4D34-B271-E1AD6D67B946}" p:before="r[@uid='{166944E6-FCEA-4CE6-A5DC-EC317337046B}']" s:id="{FDF0D36C-1863-4DAA-BB68-555A2F3A270A}" s:ph="/body/main/tab_menu"/>
    <r uid="{166944E6-FCEA-4CE6-A5DC-EC317337046B}" p:before="r[@uid='{E98B1E29-46AF-46A3-89C0-441443E97BA0}']" s:id="{F94A415B-6922-43F2-9DEE-F012DE1497BA}" s:ph="/body/main"/>
    <r uid="{E98B1E29-46AF-46A3-89C0-441443E97BA0}" p:before="r[@uid='{B03EF589-3103-448A-8105-BFC33BA953D0}']" s:id="{EAFA90C7-136A-41C8-9AE9-8B1123E7E3C9}" s:ph="body"/>
    <r uid="{969938EE-BF4F-4A42-BA30-A7AE12183B08}">
        <p:d/>
    </r>
    <r uid="{AAA093DC-A63F-4538-A94B-ECBB509008F5}">
        <p:d/>
    </r>
    <r uid="{16A7A1FE-5FB4-4394-B053-58147F3B584D}">
        <p:d/>
    </r>
    <r uid="{4CD0B2F1-CAC8-4C03-B11E-56AE8A2589E1}" p:before="*[1=2]"/>
</d>
</r> 
```

谢谢！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T20:41:18.510

您的问题是您正在从根元素中删除名称空间前缀，但它仍被用于限定文档其余部分中的属性本身。您想首先从整个文档中去除名称空间。

```
public static class XmlExtensions
{
    public static void StripNamespace(this XDocument document)
    {
        if (document.Root == null) return;

        foreach (var element in document.Root.DescendantsAndSelf())
        {
            element.Name = element.Name.LocalName;
            element.ReplaceAttributes(GetAttributesWithoutNamespace(element));
        }
    }

    static IEnumerable GetAttributesWithoutNamespace(XElement xElement)
    {
        return xElement.Attributes()
            .Where(x => !x.IsNamespaceDeclaration)
            .Select(x => new XAttribute(x.Name.LocalName, x.Value));
    }
} 
```

然后简单地说：

```
XDocument xDoc = XDocument.Parse(xml);
xDoc.StripNamespace();
xDoc.Root.Add(new XAttribute(XNamespace.Xmlns + "xsi", "http://www.w3.org/2001/XMLSchema-instance\\"));
xDoc.Root.Add(new XAttribute(XNamespace.Xmlns + "xsd", "http://www.w3.org/2001/XMLSchema\\")); 
```

这将产生您所追求的 XML。

# c# - c# 将数据添加到firebird数据库

> ID：10438285
> 
> 赞同：2
> 
> 时间：2012-05-03T19:42:24.560
> 
> 标签：c#, database, firebird

有我用来将新数据传递到数据库（火鸟）的代码：

```
FbConnection fbCon = new FbConnection(csb.ToString());
FbDataAdapter fbDAdapter = new FbDataAdapter("SELECT ID,name,score FROM players",fbCon);
FbCommandBuilder Cmd = new FbCommandBuilder(fbDAdapter);
DataSet DSet = new DataSet();
fbDAdapter.Fill(DSet);
DataRow rw = DSet.Tables[0].NewRow();
rw["ID"] = zID + 1;
rw["name"] = var;
rw["score"] = score;
DSet.Tables[0].Rows.Add(rw);
fbDAdapter.Update(DSet); 
```

也许您可以建议更好的算法，或者这很好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T19:50:14.033

这种方式没问题，你使用的是一个做很多工作的命令生成器，你可以简单地将上面的代码翻译成插入命令，直接在数据库表上执行：

```
 FbConnection fbCon = new FbConnection(csb.ToString());
  FbCommand fbCom = new FbCommand("INSERT INTO players(ID,name,score) VALUES (@id,@name,@score)", fbCon);
  fbCom.Parameters.AddWithValue("id", zID + 1);
  fbCom.Parameters.AddWithValue("name", var);
  fbCom.Parameters.AddWithValue("score", score);
  fbCom.ExecuteNonQuery(); 
```

通过这种方式，您避免了命令生成器并将数据加载到数据表中，应该会更快......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:51:47.120

这对数据库来说更轻：

```
 FbConnectionStringBuilder csb = new FbConnectionStringBuilder( );
      csb.ServerType = FbServerType.Default;
      csb.Database = Settings.Default.LastBDPath;
      csb.Password = Settings.Default.LastBDPassword; //            "masterkey";
      csb.UserID = Settings.Default.LastBDUser;       //            "SYSDBA";
      connection = new FbConnection( csb.ToString( ) );

      connection.Open( ); 

      string scriptLine = string.Format("INSERT INTO TABLE (Id, Name, Score) values ({0}, '{1}', {2}", zId+1, var, score) ; 
      FBCommand command = new FbCommand( scriptline, connection );
      command.ExecuteNonQuery( ); 
```

对于选择：

```
string sql = string.Format("select * from table where name='{0}';", your_name);

FbCommand command = new FbCommand( sql ), connection );
FbDataReader reader = command.ExecuteReader( );
while ( reader.Read( ) )
{
    for ( int i=0; i<reader.FieldCount; i++ )
    {
         objects[i].Add( reader.GetValue( i ) );
    }
} 
```

# android - NDK C 代码调用会杀死整个 Android 应用

> ID：10438286
> 
> 赞同：1
> 
> 时间：2012-05-03T19:42:27.353
> 
> 标签：android, android-ndk

我猜标题很不言自明......这是在java中调用函数

```
...
char[] path = stringPath.toCharArray();
char[] result = new char[256];

Log.e("ndk", "starting native method"); 

pcmEncoder.encodePCM(path, result);
... 
```

这是我认为可能是错误的C代码：

```
JNIEXPORT jint JNICALL Java_cz_hundredspires_que_SignalProcessor_encodePCM (JNIEnv *env, jobject obj, jcharArray jcha1, jcharArray jcha2)
{
char *FileName = (*env)->GetCharArrayElements(env, jcha1, NULL);
char *BestOutput = (*env)->GetCharArrayElements(env, jcha2, NULL);
...
(*env)->ReleaseCharArrayElements(env, FileName, jcha1, 0);
(*env)->ReleaseCharArrayElements(env, BestOutput, jcha2, 0);
return 1;
} 
```

jcha1 是文件路径，jcha2 是写入孔函数结果的数组，我以后应该可以在 java 代码中读取它。

我解决不了。任何人都可以帮助我吗？谢谢

编辑：抱歉，有一个有趣的 LogCat 条目：

```
05-03 22:38:43.093: E/JavaBinder(13929): !!! FAILED BINDER TRANSACTION !!! 
```

编辑2：

```
05-03 22:55:03.705: E/ndk(14279): starting native method
05-03 22:55:03.825: I/DEBUG(11836): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
05-03 22:55:03.825: I/DEBUG(11836): Build fingerprint: 'google/passion/passion:2.3.6/GRK39F/189904:user/release-keys'
05-03 22:55:03.825: I/DEBUG(11836): pid: 14279, tid: 14279  >>> cz.hundredspires.que <<<
05-03 22:55:03.825: I/DEBUG(11836): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 12cdaa90
05-03 22:55:03.825: I/DEBUG(11836):  r0 00000025  r1 afd42320  r2 44ada300  r3 00171e90
05-03 22:55:03.825: I/DEBUG(11836):  r4 00000000  r5 00172010  r6 00000000  r7 00000000
05-03 22:55:03.825: I/DEBUG(11836):  r8 bebfd0c8  r9 44adcccc  10 0000abe0  fp 00000000
05-03 22:55:03.825: I/DEBUG(11836):  ip 00000000  sp bebfce00  lr afd149c1  pc 80400aea  cpsr 60000030
05-03 22:55:03.825: I/DEBUG(11836):  d0  6472656767756265  d1  3fd6666666666666
05-03 22:55:03.825: I/DEBUG(11836):  d2  002f006400720076  d3  bff0000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d4  4053131840531258  d5  405313d040535550
05-03 22:55:03.825: I/DEBUG(11836):  d6  40531480405355f8  d7  3ff0000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d8  0000000000000000  d9  0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d10 0000000000000000  d11 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d12 0000000000000000  d13 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d14 0000000000000000  d15 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d16 44b14df040022da0  d17 0000d8790000d879
05-03 22:55:03.825: I/DEBUG(11836):  d18 0000000000000000  d19 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d20 0000000000000000  d21 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d22 0000000000002902  d23 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d24 0000000000008790  d25 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d26 0000000000008783  d27 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d28 0000000000008853  d29 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  d30 00000000000000d0  d31 0000000000000000
05-03 22:55:03.825: I/DEBUG(11836):  scr 60000010
05-03 22:55:03.895: I/DEBUG(11836):          #00  pc 00000aea  /data/data/cz.hundredspires.que/lib/libpcm_encoder.so (Java_cz_hundredspires_que_SignalProcessor_encodePCM)
05-03 22:55:03.895: I/DEBUG(11836):          #01  lr afd149c1  /system/lib/libc.so
05-03 22:55:03.895: I/DEBUG(11836): code around pc:
05-03 22:55:03.895: I/DEBUG(11836): 80400ac8 dcf1429e a018f8cd ed9f9a08 9b053b21 
05-03 22:55:03.895: I/DEBUG(11836): 80400ad8 7b21ed9f ed9f9804 eddf1b24 f8dd0a27 
05-03 22:55:03.895: I/DEBUG(11836): 80400ae8 f853b018 ee054022 eeb84a90 46236be5 
05-03 22:55:03.895: I/DEBUG(11836): 80400af8 6bc0eeb5 fa10eef1 eeb0bf54 eeb05b47 
05-03 22:55:03.895: I/DEBUG(11836): 80400b08 42b85b43 f04fbfcc f04f3eff 9f050e01 
05-03 22:55:03.895: I/DEBUG(11836): code around lr:
05-03 22:55:03.895: I/DEBUG(11836): afd149a0 4798680b bf00bd10 0002db88 ffffff28 
05-03 22:55:03.895: I/DEBUG(11836): afd149b0 4a054b04 b510447b 6819589b 4798684b 
05-03 22:55:03.905: I/DEBUG(11836): afd149c0 bf00bd10 0002db6c ffffff28 f8df4b05 
05-03 22:55:03.905: I/DEBUG(11836): afd149d0 447bc018 f853b510 681a300c 47986893 
05-03 22:55:03.905: I/DEBUG(11836): afd149e0 bf00bd10 0002db4e ffffff28 f8df4b05 
05-03 22:55:03.905: I/DEBUG(11836): stack:
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdc0  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdc4  afd477a4  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdc8  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdcc  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdd0  bebfd0c8  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdd4  afd149c1  /system/lib/libc.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdd8  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcddc  afd18afb  /system/lib/libc.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfcde0  afd477a4  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcde4  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcde8  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdec  afd18611  /system/lib/libc.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdf0  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdf4  00172010  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdf8  df002777  
05-03 22:55:03.905: I/DEBUG(11836):     bebfcdfc  e3a070ad  
05-03 22:55:03.905: I/DEBUG(11836): #00 bebfce00  44248f70  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce04  47389032  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce08  afd477a4  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce0c  47388749  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce10  00000025  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce14  00171e90  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce18  00000000  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce1c  bebfcdb0  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce20  44ada300  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce24  00000028  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce28  0000abe0  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce2c  4053c338  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce30  acaa5001  
05-03 22:55:03.905: I/DEBUG(11836):     bebfce34  aca16d98  /system/lib/libdvm.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfce38  aca16e10  /system/lib/libdvm.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfce3c  aca16cb8  /system/lib/libdvm.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfce40  aca16ce0  /system/lib/libdvm.so
05-03 22:55:03.905: I/DEBUG(11836):     bebfce44  80403138  
05-03 22:55:04.615: I/BootReceiver(783): Copying /data/tombstones/tombstone_00 to DropBox (SYSTEM_TOMBSTONE)
05-03 22:55:04.625: I/WindowManager(783): WIN DEATH: Window{40812f60 cz.hundredspires.que/cz.hundredspires.que.TerminalActivity paused=false}
05-03 22:55:04.625: I/ActivityManager(783): Process cz.hundredspires.que (pid 14279) has died.
05-03 22:55:04.635: D/Zygote(748): Process 14279 terminated by signal (11)
05-03 22:55:04.675: W/InputManagerService(783): Got RemoteException sending setActive(false) notification to pid 14279 uid 10067
05-03 22:55:07.195: D/dalvikvm(11075): GC_CONCURRENT freed 96K, 44% free 3771K/6727K, external 0K/0K, paused 2ms+3ms
05-03 22:55:07.255: D/Finsky(11075): [1] 5.onFinished: Installation state replication succeeded. 
```

# python - 用python填写javascript？

> ID：10438291
> 
> 赞同：1
> 
> 时间：2012-05-03T19:42:35.883
> 
> 标签：python

我正在尝试解析 html 页面，但我需要在解析页面之前过滤结果。

例如，“http://www.ksl.com/index.php?nid=443”是犹他州汽车的分类列表。而不是解析所有的汽车，我想先过滤它（即找到所有的宝马），然后只解析那些页面。是否可以用python填写javascript表单？

这是我到目前为止所拥有的：

```
import urllib

content = urllib.urlopen('http://www.ksl.com/index.php?nid=443').read()
f = open('/var/www/bmw.html',"w")
f.write(content)
f.close() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:34:09.117

这是执行此操作的方法。首先下载页面，抓取它以找到您正在寻找的模型，然后您可以获得指向要抓取的新页面的链接。这里不需要javascript。该模型和 BeautifulSoup 文档将助您一臂之力。

```
from BeautifulSoup import BeautifulSoup
import urllib2

base_url = 'http://www.ksl.com'
url = base_url + '/index.php?nid=443'
model = "Honda" # this is the name of the model to look for

# Load the page and process with BeautifulSoup
handle = urllib2.urlopen(url)
html = handle.read()
soup = BeautifulSoup(html)

# Collect all the ad detail boxes from the page
divs = soup.findAll(attrs={"class" : "detailBox"})

# For each ad, get the title
# if it contains the word "Honda", get the link
for div in divs:
    title = div.find(attrs={"class" : "adTitle"}).text
    if model in title:
        link = div.find(attrs={"class" : "listlink"})["href"]
        link = base_url + link
        # Now you have a link that you can download and scrape
        print title, link
    else:
        print "No match: ", title 
```

在回答时，此代码片段正在寻找本田车型并返回以下内容：

```
1995-  Honda Prelude http://www.ksl.com/index.php?sid=0&nid=443&tab=list/view&ad=8817797
No match:  1994-  Ford Escort
No match:  2006-  Land Rover Range Rover Sport
No match:  2006-  Nissan Maxima
No match:  1957-  Volvo 544
No match:  1996-  Subaru Legacy
No match:  2005-  Mazda Mazda6
No match:  1995-  Chevrolet Monte Carlo
2002-  Honda Accord http://www.ksl.com/index.php?sid=0&nid=443&tab=list/view&ad=8817784
No match:  2004-  Chevrolet Suburban (Chevrolet)
1998-  Honda Civic http://www.ksl.com/index.php?sid=0&nid=443&tab=list/view&ad=8817779
No match:  2004-  Nissan Titan
2001-  Honda Accord http://www.ksl.com/index.php?sid=0&nid=443&tab=list/view&ad=8817770
No match:  1999-  GMC Yukon
No match:  2007-  Toyota Tacoma 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-03T19:45:45.993

如果你使用 python，[Beautifull Soup](http://www.crummy.com/software/BeautifulSoup/)就是你要找的。

# php - 根据上一个页面操作在页面加载时执行某些操作

> ID：10438293
> 
> 赞同：0
> 
> 时间：2012-05-03T19:42:39.123
> 
> 标签：php, jquery

我正在 wordpress 上建立一个网站，但遇到了一个我不太确定如何解决的问题。

**情况：**

1.  用户从`<select>`一个页面上的标签中进行选择并提交他们的选择
2.  用户到达具有相同特征的页面`<select>`。当用户选择一个选项时，它会使用一点点 jQuery 显示与该选项对应的内容。

-

```
$('.result').hide();

$('#servicearea').change(function() {
  $('.result').hide();

  var optionValue = $ (this).attr('value');
  $('#'+optionValue).show('fast');

}); 
```

**问题：**

1.  我需要从第一页进行选择以延续到第二页，然后运行此脚本。

**解决方案：**

1.  老实说，我不知道从哪里开始，也许是饼干？我希望有一种 jQuery 类型的解决方案，因为我对 jQuery 有点熟悉。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:53:11.770

javascript 不知道您发布到页面的内容。

您可以使用以下内容将值从 php 放入 javascript：

```
<script>
    doSomething(<?=$_POST['selected'?>);
</script> 
```

或者你可以把它放到一个隐藏的表单域中

```
<input type="hidden" id="hiddenField" value="<?=$_POST['selected']?>"> 
```

并抓住价值

```
$('#hiddenField').val() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:57:40.480

隐藏的表单域将起作用。但是，如果您决定改用 PHP 会话，[请查看此处。](http://www.php.net/manual/en/function.session-start.php)

*从上面的链接...*

```
<?php
// page1.php

session_start();

echo 'Welcome to page #1';

$_SESSION['favcolor'] = 'green';
$_SESSION['animal']   = 'cat';
$_SESSION['time']     = time();

// Works if session cookie was accepted
echo '<br /><a href="page2.php">page 2</a>';

// Or maybe pass along the session id, if needed
echo '<br /><a href="page2.php?' . SID . '">page 2</a>';
?> 
```

查看 page1.php 后，第二个页面 page2.php 将包含会话数据。[阅读会话参考](http://www.php.net/manual/en/ref.session.php)以获取有关[传播会话 id](http://www.php.net/manual/en/session.idpassing.php)的信息，例如，它解释了常量 SID 的全部含义。

```
<?php
// page2.php

session_start();

echo 'Welcome to page #2<br />';

echo $_SESSION['favcolor']; // green
echo $_SESSION['animal'];   // cat
echo date('Y m d H:i:s', $_SESSION['time']);

// You may want to use SID here, like we did in page1.php
echo '<br /><a href="page1.php">page 1</a>';
?> 
```

**更新**

从您的代码片段来看，我相信您会通过执行以下操作来设置会话变量：

```
<form action="" method="post">
<select type="select" name="servicearea" >
    <option value="option1">Option 1</option>
    <option value="option2">Option 2</option>
    <option value="option3">Option 3</option>
</select>
<input type="submit" name="Submit" value="Submit!" />
</form>

<?php
session_start();
if (isset($_POST['Submit'])) {
    $_SESSION['optionValue'] = $_POST['servicearea'];
}
echo $_SESSION['optionValue'];
?> 
```

# bash - 无法为 jdk 设置 PATH 变量

> ID：10438295
> 
> 赞同：0
> 
> 时间：2012-05-03T19:42:40.220
> 
> 标签：bash, java-7, bash4

我通过首先构建包然后安装它在archlinux kde中安装了sun-java。这是在我的机器中设置环境变量的方式： file: /etc/profile # /etc/profile

```
#Set our umask
umask 022

# Set our default path
PATH="/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin"
export PATH

# Load profiles from /etc/profile.d
if test -d /etc/profile.d/; then
    for profile in /etc/profile.d/*.sh; do
        test -r "$profile" && . "$profile"
done
unset profile
fi

# Source global bash config
if test "$PS1" && test "$BASH" && test -r /etc/bash.bashrc; then
. /etc/bash.bashrc
fi

# Termcap is outdated, old, and crusty, kill it.
unset TERMCAP

# Man is much better than us at figuring this out
unset MANPATH 
```

和文件：/etc/profile.d/jdk.sh

```
export J2SDKDIR=/opt/java
export PATH=$PATH:/opt/java/bin:/opt/java/db/bin
export JAVA_HOME=/opt/java
export DERBY_HOME=/opt/java/db 
```

我从中了解到的是，jdk 路径应该在路径环境变量中设置，但不是。但是属性 $JAVA_HOME 设置正确。我面临这个问题的任何原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T21:14:27.107

实际上，这对我来说是一个愚蠢的错误。我正在使用 zsh 外壳。所以我被要求输入：

```
 export PATH=$PATH:$JAVA_HOME/bin 
```

在 .zshrc 文件而不是 .bashrc 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T21:35:36.090

/etc/profile 和 /etc/profile.d 仅针对*登录 shell*进行处理，因此除非您对安装了 java 的机器执行 ssh 操作，否则您将不会获得这些变量。

要将它们放在*本地*（例如，当您在工作站上打开 xterm 时）将它们放在文件 /etc/bash.bashrc 中。

希望这可以帮助。

# jquery - 使用 jquery ui 对话框 iframe 显示 onload 即

> ID：10438296
> 
> 赞同：0
> 
> 时间：2012-05-03T19:42:55.883
> 
> 标签：jquery, jquery-ui, iframe

我正在寻找建议/解决方法或更好的方法来做到这一点 这一点代码适用于 FF 和 chrome 但在 IE 中不会调用 hideProgress

```
function showPDF(url){
       $("#divId")
               .html('<div id="loading">Loading....</div>
                      <iframe id="modalIframeId" width="100%" height="100%" 
                          src='+url+' marginWidth="0" marginHeight="0" frameBorder="0"
                          scrolling="auto" title="Dialog Title" 
                      onload="hideProgress();">Your browser does not support</iframe>')
               .dialog('open');
        return ;
   }
   function hideProgress(){
       $('#loading').hide();
   } 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:45:12.037

`.on()`尝试使用or函数将 onload 事件处理程序调用分配给#modalIframeId，`.delegate()`而不是将其放入`<iframe>`您要插入的标记中。我很惊讶它在 FF 和 Chrome 中工作 - 大多数时候，由于 jQuery 与页面代码的交互方式，为任何动态代码分配这样的事件处理程序都不起作用。您可能还想尝试为 #modalIframeId iframe 设置一个唯一的 id - 如果您要在页面上多次调用 showPDF() 函数，它会创建具有重复 id 的元素，这会混淆 jQuery 并产生意想不到的结果。根据我的经验，即使您删除 #modalIframeId 然后重新添加它，它仍然可能会导致问题。每次创建它时都有一个唯一的 id 可以防止这个潜在的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T02:31:20.180

正如前面的答案所提到的，这里的问题是您正在内联附加事件处理程序。您正在寻找的功能可以通过简单地分解您的功能来实现。我已经在这个 jsFiddle 中证明了这一点：

[http://jsfiddle.net/xyctR/2/](http://jsfiddle.net/xyctR/2/)

'loaded' 已登录所有浏览器。

此外，在这种情况下，不需要将“open”传递给 jQuery UI 的`dialog`方法。只要打电话`dialog()`。​</p>

# powershell - Powershell 列出非活动帐户

> ID：10438304
> 
> 赞同：3
> 
> 时间：2012-05-03T19:43:39.020
> 
> 标签：powershell, active-directory, accounts

我正在尝试列出所有在 6 个月内未登录的帐户。

这是我第一次真正使用 powershell，此时我只是在编辑其他人的脚本以满足我自己的需要。

我想将搜索分成两个列表：仅限计算机和仅限用户。

六个月以外的计算机代码。

```
Search-ADAccount -accountinactive -computersonly | where {$_.lastlogondate -lt (get-date).addmonths(-6)} | FT Name,LastLogonDate 
```

六个月以外的用户的代码。

```
Search-ADAccount -accountinactive -usersonly | where {$_.lastlogondate -lt (get-date).addmonths(-6)} | FT Name,LastLogonDate 
```

但是，这些都不起作用，只是吐出所有帐户。我还注意到将 -6 更改为任何数字确实没有效果。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-21T09:43:54.340

在这里查看按类别跟踪非活动用户（登录状态、禁用用户、密码过期用户、acc 过期用户、未登录用户、已删除用户等）

[http://www.adsysnet.com/asn-active-directory-inactive-account-tracker-features.aspx](http://www.adsysnet.com/asn-active-directory-inactive-account-tracker-features.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:21:40.437

你的测试没问题（它在我的广告中工作）唯一的事情是你必须消除 $_.lastlogondate 为空的对象。

尝试 ：

```
Search-ADAccount -accountinactive -usersonly  | where {! ($_.lastlogondate -lt (get-date).addMonths(-6))} | ft Name,lastlogondate 
```

编辑：

因为 lastLogon 属性不在 Active Directory 中复制，所以可以在每个域控制器上的 Active Directory 副本中存储不同的值。一种解决方案是遍历所有域控制器以构建此类用户的列表。但我很确定还有其他解决方案！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:01:25.817

我相信您需要将日期或时间跨度与 -AccountInactive 开关一起传递。这样做应该使您的自定义过滤器变得不必要，因此请尝试以下操作（未经测试）：

```
Search-ADAccount -accountinactive -datetime (get-date).AddMonths(-6) -computersonly | ft Name,LastLogonDate
Search-ADAccount -accountinactive -datetime (get-date).AddMonths(-6) -userssonly | ft Name,LastLogonDate 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:04:42.153

```
$sixMonths = (Get-Date).AddMonths(-6)
Search-ADAccount -accountinactive -usersonly -datetime "$sixMonths" 
```

# g++ - 关于 stl list::splice

> ID：10438312
> 
> 赞同：1
> 
> 时间：2012-05-03T19:44:42.230
> 
> 标签：g++

我面临着将列表与自身拼接的问题。请注意，我已经[在 std::list 和迭代器失效上完成了 splice()](https://stackoverflow.com/questions/143156/splice-on-stdlist-and-iterator-invalidation) 问题是关于两个不同的列表。但我的问题是关于同一个列表。

```
mylist.splice(mylist.end(), mylist, ++mylist.begin()); 
```

似乎 gcc 3.x 使移动的迭代器无效。所以我想它正在重新分配和分配节点。这对于同一个列表没有意义。SGI 确实告诉这个版本的 splice 不应该使任何迭代器失效。如果有任何解决方法，这是 gcc 3.x 的错误吗？

与此同时，我正在浏览 stl_list.h 文件。但是坚持使用 transfer() 函数，我找不到这些的定义。

```
struct _List_node_base
  {
    _List_node_base* _M_next;   ///< Self-explanatory
    _List_node_base* _M_prev;   ///< Self-explanatory

    static void
    swap(_List_node_base& __x, _List_node_base& __y);

    void
    transfer(_List_node_base * const __first,
         _List_node_base * const __last);

    void
    reverse();

    void
    hook(_List_node_base * const __position);

    void
    unhook();
  }; 
```

你知道我在哪里可以找到这些函数定义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T02:49:29.223

This functions are in the libstdc++ sources, not the headers. In 3.4 it's in `libstdc++-v3/src/list.cc`

[http://gcc.gnu.org/viewcvs/branches/gcc-3_4-branch/libstdc%2B%2B-v3/src/list.cc?view=markup](http://gcc.gnu.org/viewcvs/branches/gcc-3_4-branch/libstdc%2B%2B-v3/src/list.cc?view=markup)

Have you tried compiling with `-D_GLIBCXX_DEBUG` ? That will enable the Debug Mode and tell you if you're using invalid iterators or anything else that causes the problem.

I just tried this simple test with GCC 3.4, with and without debug mode, and it worked fine:

```
#include <list>
#include <iostream>
#include <string>

int main()
{
  std::list<std::string> l;
  l.push_back("1");
  l.push_back("2");
  l.push_back("3");
  l.push_back("4");
  l.push_back("5");
  l.push_back("6");
  l.splice(l.end(), l, ++l.begin());

  for (std::list<std::string>::iterator i = l.begin(), e = l.end(); i != e; ++i)
    std::cout << *i << ' ';
  std::cout << std::endl;
} 
```

Modifying it further and debugging it I see that no element is destroyed and reallocated when doing the splice, so I suspect the bug is in your program. It's hard to know, as you haven't actually said what the problem is.

# json - 多表同列数据结构 CFC JSON

> ID：10438313
> 
> 赞同：1
> 
> 时间：2012-05-03T19:44:53.037
> 
> 标签：json, coldfusion, cfc

我正在尝试从 cfc 中取回类型列表，并将其作为 JSON 返回。问题是如何创建 JSON 的结构。我一直在绞尽脑汁，试图以 json 格式获取它，但我不确定它是否可能像目前所写的那样。

所以这里是设置。我有 4 张桌子，除了一列之外，所有桌子都是相同的。我需要每个表中的多行。

我尝试从每个表中获取适当的数据，如下所示：

```
<cfscript>
    tempStruct = setAttributionTypes(dsn,type);
    tempStruct = setCharacteristicTypes(dsn,type);
    //tempArray = setExposureTypes(dsn,type);
    //tempArray = setWeightTypes(dsn,type);             
</cfscript> 
```

如您所见，我正在尝试不同的方法。创建一个结构，并创建一个结构数组（未显示）

这是我用来将所有字段重新放在一列中的当前查询：

```
<cfquery name="getAllTypes" datasource="#dsn#">
    SELECT udc_code,
           type
    FROM(
        SELECT attribution_id AS udc_code,type
        FROM   tbl_asset_profile_template_attributions
        WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
        UNION ALL
        SELECT characteristic_id AS udc_code,type
        FROM   tbl_asset_profile_template_characteristics
        WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
        UNION ALL
        SELECT exposure_id AS udc_code,type
            FROM   tbl_asset_profile_template_exposures
        WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
        UNION ALL
        SELECT weight_id AS udc_code,type
        FROM   tbl_asset_profile_template_weights
        WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">) AS tbl
    GROUP  BY type,
                 udc_code
    ORDER  BY type 
</cfquery> 
```

我创建了一个类似的结构`[{'attribution1':data,...}{...}]`，但这很难处理。

我一直在尝试创建这样的结构：

```
 [{ATTRIBTUIONS{'TYPE1','TYPE2',}},{CHARACTERISTICS{'TYPE1',...}}] 
```

我只是很难想象我需要什么。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T01:12:48.040

通过一些查询调整和数据按摩，您可以获得所需的 json 对象：

1）将您的查询更改为：

```
<cfquery name="getAllTypes" datasource="#dsn#">
SELECT profilename,udc_code
FROM (
    SELECT attribution_id AS udc_code, type, 'Attributions' AS profilename
    FROM   tbl_asset_profile_template_attributions
    WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
    UNION ALL
    SELECT characteristic_id AS udc_code, type, 'Characteristics' AS profilename
    FROM   tbl_asset_profile_template_characteristics
    WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
    UNION ALL
    SELECT exposure_id AS udc_code, type, 'Exposures' AS profilename
    FROM   tbl_asset_profile_template_exposures
    WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">
    UNION ALL
    SELECT weight_id AS udc_code, type, 'Weights' AS profilename
    FROM   tbl_asset_profile_template_weights
    WHERE  template_id = <cfqueryparam cfsqltype="cf_sql_varchar" value="#type#">) AS tbl
GROUP  BY profilename, type, udc_code
ORDER  BY profilename, type 
</cfquery> 
```

2）创建一个结构来保存您的数据并使用具有 GROUP 属性的 cfoutput 填充它：

```
<cfset stTypes = structnew()>

<cfoutput query="getAllTypes" group="profilename">
 <cfset stTypes[getAllTypes.profilename] = arraynew(1)>
 <cfoutput>
  <cfset arrayappend(stTypes[getAllTypes.profilename], getAllTypes.type)>
 </cfoutput>
</cfoutput> 
```

3）将结构序列化为json对象：

```
<cfset jsonobj = serializejson(stTypes)> 
```

这将创建一个像这样的 json 对象：

```
{'Attributions':['Type1', 'Type2',...], 'Characteristics':['TypeA', 'TypeB',...], ...} 
```

hth

# sql - SQL 编码风格：逗号

> ID：10438314
> 
> 赞同：0
> 
> 时间：2012-05-03T19:44:53.573
> 
> 标签：sql, coding-style

这些 SQL 编码风格中哪一种更好，为什么？

**逗号第一：**

```
SELECT Name
    , Email
    , Phone
FROM Contact 
```

**逗号最后：**

```
SELECT Name,
    Email,
    Phone
FROM Contact 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:47:37.760

两者都是有效的，做你或你的商店**一贯**做的事。我更喜欢方法2。乍一看，第一个似乎缺少逗号，只有在您再看一些之后，您才会注意到它很好。其他人的可读性是关键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:48:44.740

我正在从事的一些工作的查询：

```
 SELECT TOP 1000 [Id]
      ,[ProductCode]
      ,[Month]
      ,[Year]
      ,[SalesVolume]
  FROM [VeryBigCorp].[dbo].[MonthlySales] 
```

我不得不说，以上是一种非常巧妙的方法，误差较小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:47:52.920

这是一个偏好问题。就个人而言，我更喜欢第二个示例，但使用其中一个没有任何好处。

在第一个示例中，您需要删除第一列的前导逗号，在第二个示例中，您需要从最后一列中删除尾随逗号。

# html - 对 DIV Z-index 感到困惑，加上可见/隐藏 DIV 的逻辑

> ID：10438316
> 
> 赞同：1
> 
> 时间：2012-05-03T19:45:02.580
> 
> 标签：html, css, z-index

我整个上午都在尝试编写我认为很简单的代码。

*   两长列内容，只有第一列可见
*   单击链接时，第 1 列被隐藏，第 2 列变为可见
*   两者都处于完全相同的位置，但是两者的长度不同且不同

我决定使用`target`伪类在列之间切换，设置一个显示的可见性。

这似乎有效，但我不完全理解我做了什么。另外，这些列下方的内容似乎在 z 轴上放置在它们下方，而不是在 y 轴上放置在它们下方。

我的两个（相关）问题：

1.  我不确定我创建的逻辑到底是什么，我可以用简单的英文解释来做。
2.  我不明白为什么两列和容器下方的 DIV 没有出现在 y 轴上。

这是我的CSS：

```
#container
{
    background-color: red;
    position: relative;
}

#schools-list
{
    width: 400px; /* Set the width of the visible portion of content here */
    height: 600px; /* Delete the height, let the content define the height */
    background-color: purple;
    position: absolute;
    top: 0;
    left: 0;
}

#boards-list
{
    width: 400px; /* Set the width of the visible portion of content here */
    height: 700px; /* Delete the height, let the content define the height */
    background-color: green;
    position: absolute;
    top: 0;
    left: 0;
    visibility: hidden;
}

#container:target #schools-list
{
    visibility: hidden;
}

#container:target #boards-list
{
    visibility: visible;
} 
```

这是我的 HTML：

```
<div id="container">

    <div id="boards-list">
    Boards List<br>
    Switch to <a href="">Schools List</a>
    Here's some content
    </div>

    <div id="schools-list">
    Schools List<br>
    Switch to <a href="#container">Boards List</a>
    Here's some other content
    </div>

</div>

<div>Why is this beneath everything?</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T19:54:49.880

绝对定位从页面流中删除一个项目。这就是导致底部 div 出现在下方的原因。

可见性将元素从视线中移除，但元素仍将占用空间。

我的建议是使用显示而不是可见性。

在和之间切换您的元素`display:block`并`display:none`删除绝对定位，您应该能够实现您想要的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:56:11.940

#borad-list 和 #school-list 都按位置从正常页面流中取出：绝对，这就是为什么你的容器高度应该是 0px，因为没有任何东西可以垂直占用任何空间。

我可以更好地解释它，但现在用我的手机写作，所以......我会试着给你一个起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:57:01.820

通过使用 定位容器`position:absolute`，您可以将它们从页面的正常流程中移除。换句话说，您的其他内容就像那些容器根本不存在一样，而这些容器神奇地出现在内容的前面。

相反，您可能想要做的是删除容器的位置、顶部和左侧，并用于`display:block`显示和`display:none`隐藏容器。您还可以移除容器的高度，让内容自行决定需要多少空间。

# iphone - 隐藏按钮保存

> ID：10438325
> 
> 赞同：0
> 
> 时间：2012-05-03T19:45:35.647
> 
> 标签：iphone, xcode, button, save, hidden

单击时我有一组按钮被隐藏，显示底层图像。我需要知道保存状态的最佳方法，以便在重新启动时它们不会恢复到未单击的视图。这可能吗？谢谢你。

```
-(IBAction)Act1 { 
Act1Button.hidden = YES;
}

-(IBAction)De1 {
Act1Button.hidden = NO;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // initialization
}
return self;
}

- (IBAction)savedata:(id)sender
{

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
 [defaults setValue:@"myValue" forKey:@"mykey"];
[defaults synchronize];

}

- (void)viewDidLoad
{
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
if (![userDefaults valueForKey:@"mykey"]) {
    [userDefaults setValue:@"myValue" forKey:@"mykey"];
    NSLog(@"setting value");
}
[userDefaults synchronize];

}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end

'@interface testViewController : UIViewController
{
IBOutlet UIButton *Act1Button;
IBOutlet UIButton *De1Button;

}

@property (retain, nonatomic) IBOutlet UIButton *Act1Button;
@property (retain, nonatomic) IBOutlet UIButton *De1Button;

- (IBAction)Act1;
- (IBAction)De1;

-(IBAction)savedata:(id)sender;

@end` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:01:38.040

是的，NSUserDefaults 正是用于此目的：

[https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T01:36:40.310

根据您的代码，您错过了在应用程序加载时将保存的值从默认值中拉出并对其进行操作的非常重要的步骤。

你应该有更多这样的东西：

```
-(IBAction)Act1 { 
  Act1Button.hidden = YES;
  NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
  [defaults setValue:Act1Button.hidden forKey:@"act1buttonState"];
}

- (void)viewDidLoad {
  NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
  Act1Button.hidden = [userDefaults valueForKey:@"act1buttonState"];
} 
```

这样，您每次按下按钮时都会存储状态更改，而不是需要单独的按钮来保存（可能您会将保存移动到每个按钮操作都会调用的自己的方法中）。此外，当您稍后再次加载视图时，它会获取先前保存的状态，并设置按钮的可见性以匹配。

这个简单的代码会让你在个人基础上做这件事，所以你应该考虑在 NSUserDefaults 中存储一个 NSDictionary 来保存所有按钮的状态。在 viewDidLoad 中，您可以获得该字典，并遍历它的所有值并一次性设置所有可见性。

# java - 在 UIInput 组件中使用带参数的方法时如何调用 setter 方法？

> ID：10438329
> 
> 赞同：2
> 
> 时间：2012-05-03T19:45:51.043
> 
> 标签：java, jsf-2, el, mojarra

例如，在我使用带参数的方法来获取 JSF 页面上组件的值之前

```
<h:dataTable value="#{myBean.getMyList(argument)}"> 
```

但是现在我需要相同的原理，但是在 inputText 元素的 value 属性上使用它，所以它或多或少是这样的：

```
<h:inputText value="#{myBean.getMyValue(argment)}"> 
```

问题是，当从 af:ajax 元素执行元素时，第二种方法不会调用 setter 方法。

将值传递给 backingBean 上的 setter 和 getter 方法的另一种方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:55:56.763

确实不可能在不代表 getter 的 EL 表达式上设置值。您需要`myValue`变成 a`Map<String, Object>`并使用以下符号。

```
<h:inputText value="#{myBean.myValue[argument]}"> 
```

然后这将`put()`调用`Map`. 请注意，您在这里不需要设置器`myValue`。

# facebook - 通过 Facebook 发送消息会引发 500 错误

> ID：10438336
> 
> 赞同：2
> 
> 时间：2012-05-03T19:46:25.777
> 
> 标签：facebook, facebook-javascript-sdk

我正在从我的应用程序（网站）通过 facebook 发送一条私人消息。这是一个网站的邀请链接 - 但是，它给出了以下错误：

```
The website encountered an error while retrieving https://www.facebook.com/dialog/send. It may be down for maintenance or configured incorrectly.
Here are some suggestions:
Reload this webpage later.
HTTP Error 500 (Internal Server Error): An unexpected condition 
```

正在发送的链接邀请链接类似于 [http://myapp.com/invitation](http://myapp.com/invitation) - 无效 [http://myapp.com](http://myapp.com) - 有效！

如何在正斜杠后使它与某些东西一起工作？

实际代码：

```
 :javascript
    $(function(){
      $('li.friend:not(.invited) label').live('click', function() {
        FB.init({appId: #{Rails.application.config.fb_app_id}, xfbml: true, cookie: true})
        FB.ui({
          method: 'send',
          display: 'popup',
          name: 'New Invitation',
          link: 'http://myapp.com/invitation/',
          to: this.parentNode.getAttribute("data-id"),
          frictionlessRequests:true,
          show_error: 'true'
        })
        $(this).parent().addClass("invited")
        $(this).siblings().prop("checked", true)
      })
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T19:02:53.057

你有'frictionlessRequests'和'method：send'；这些不是兼容的选项。,`frictionlessRequests: true`应该在您的 FB.init() 调用中，并在预填充收件人时影响请求对话框的工作方式，您所拥有的是来自不同对话框的参数的混合

示例[发送对话框](https://developers.facebook.com/docs/reference/dialogs/send/)调用是：

```
 FB.ui({
          method: 'send',
          name: 'People Argue Just to Win',
          link: 'http://www.nytimes.com/2011/06/15/arts/people-argue-just-to-win-scholars-assert.html',
          }); 
```

和一个示例[apprequests 对话框](https://developers.facebook.com/docs/reference/dialogs/requests/)：

```
FB.ui({
    method: 'apprequests',
    message: 'Come use this app with me.'
  });
} 
```

此外（如您所见）链接需要正确解析返回 200 响应；如果它立即重定向，它将无法正常工作

# vba - VB Excel宏毫秒计时

> ID：10438338
> 
> 赞同：3
> 
> 时间：2012-05-03T19:46:47.370
> 
> 标签：vba, excel

我正在尝试在 VB 中为 Excel 电子表格编写一个宏，该电子表格以特定间隔执行，该间隔由电子表格本身中包含的值（以 Hz 为单位）定义。我的问题是我发现以这种方式完成自动宏的代码似乎只允许第二精度，因此任何高于 1Hz 的频率都是不可能的。如果可能的话，我希望能够达到 10Hz 左右，这需要毫秒级的精度。

我是VB新手，所以对它了解不多。这是代码：

```
Sub Macro2()
    Range("K1").Select
    Dim f As Single
    f = ActiveCell.Value
    Dim t As Integer
    t = 1 / f
    dTime = Now + TimeSerial(0, 0, t)
    Application.OnTime dTime, "Macro2"
    Range("J1").Select
    Dim c As Integer
    c = ActiveCell.Value
    c = c Xor 1
    ActiveCell.Value = c
End Sub 
```

有没有办法使用这种方法获得毫秒精度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-30T14:53:57.487

就像`Application.Wait (Now + 0.000001)`1/10sec 一样简单：

```
Sub Macro2()
' Macro2 Macro
Range("C1").FormulaR1C1 = "1"
Application.Wait (Now + TimeValue("0:00:01")) '1sec
Range("C1").FormulaR1C1 = "2"
Application.Wait (Now + 0.000001) '1/10sec
Range("C2").Select
Sleep (100)
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:32:17.727

**Excel 在不到整秒的时间内无法工作。**

您的代码有几个问题：

您定义`Dim t As Integer`并继续分配`t = 1 / f`，这意味着对于任何`f`大于一的值，`t`将为零（因为它被限制为整数）。

`TimeValue()`只能在整秒内工作，所以是否`t`是分数都没有关系，因为`TimeValue()`会丢弃任何分数部分。

宏将以`t`零运行，但它是不受控制且不规则的。我怀疑这是 Excel VBA 无法在毫秒内工作的部分原因：VBA 代码的执行不够准确。

不幸的是，因为 VBA 不能在几毫秒内工作，所以我不能建议一种让它这样做的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T13:26:30.177

使用[`Sleep`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)API。

```
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)

Sub Macro2()
    Range("K1").Select
    Dim f As Single
    f = ActiveCell.Value
    If f = 0 Then Exit Sub
    Dim t As Long
    t = 1000 / f
    Sleep t
    Range("J1").Select
    Dim c As Integer
    c = ActiveCell.Value
    c = c Xor 1
    ActiveCell.Value = c
    Macro2
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-05T05:42:02.230

如果不需要使用毫秒的确切值，而只是“尽快”，则可以使用*TimeSerial(0, 0, **0** )*

# php - 在 PHP 中一次从 3 个表中删除行

> ID：10438339
> 
> 赞同：2
> 
> 时间：2012-05-03T19:46:47.713
> 
> 标签：php, mysql, sql, mysqli, prepared-statement

# 短的

我的表格结构看起来像这样

![在此处输入图像描述](../Images/0aa5acf5fc5e080c15e1f07e390ce811.png)

这是 Sql 语句

```
 $stmt = $this->db->prepare("DELETE FROM chapters WHERE (subject_id=? AND id = ?)") or die($this->db->error());
            $stmt->bind_param("ii", $subject_id, $node);
            $stmt->execute();
            $stmt = $this->db->prepare("DELETE FROM sections WHERE (subject_id=? AND chapter_id=? )") or die($this->db->error());
            $stmt->bind_param("ii", $subject_id, $node);
            $stmt->execute();
            $stmt = $this->db->prepare("DELETE FROM paragraphs WHERE (subject_id=? AND chapter_id=?)") or die($this->db->error());
            $stmt->bind_param("ii", $subject_id, $node);
            $stmt->execute(); 
```

所以我想做的是，`merge`把这3条语句合二为一，优化服务器负载。

# 详细的

例如，如果我想从`chapters`表中删除 id=1 的行，那么还要从另外 2 个表中删除：`sections`，`paragraphs`通过 2 个参数：`$node`和`$subject_id`（当然，如果有这些参数的行。我的意思是必须加入防止任何错误）。

# 问题是..

那可能吗？我不知道，sql语句必须是什么样子。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T19:49:50.843

如果您已经设置了外键约束，`ON DELETE CASCADE`那么您只需要删除父行。然后 MySQL 将自动删除子行。

*   [如何在 mysql 中使用删除级联？](https://stackoverflow.com/questions/511361/how-do-i-use-on-delete-cascade-in-mysql)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T20:12:52.687

我没试过，但你可以尝试多表删除：

[http://dev.mysql.com/doc/refman/5.6/en/delete.html#id933512](http://dev.mysql.com/doc/refman/5.6/en/delete.html#id933512)

```
 删除章节、章节、段落
    从章节
    在sections.subject_id = $subject_id AND section.chapter_id = $node 上左连接部分
    左连接段落 paras.subject_id = $subject_id AND paragraphs.chapter_id = $node
    在哪里 chapters.subject_id = $subject_id AND chapters.id = $node
```

我不确定使用左连接是否真的比使用 3 个单独的删除更快。

# c# - 在 Windows 窗体中的窗口底部放置一个 StatusStrip

> ID：10438342
> 
> 赞同：0
> 
> 时间：2012-05-03T19:47:18.790
> 
> 标签：c#, winforms, statusstrip

我试图保持状态栏与可实现窗口的左下角齐平而不会溢出。我有一个调整大小的功能来更新状态条的位置和大小，但它的底部和右侧总是延伸到窗口之外。这就是我计算它应该去哪里的方法。

```
statusBar.Location = new System.Drawing.Point(0, Form.Size.Height - 22);
statusBar.Size = new System.Drawing.Size(Form.Size.Width, 22); 
```

其中 22 是我希望 statusBar 成为的恒定高度。我知道在设置存储在表单中的这个变量时，我没有考虑其他一些变量，但我不确定如何访问它，或者它甚至是什么。

我究竟做错了什么？无论调整大小事件如何，还有其他更简单的方法可以将状态条保持在窗口底部吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:49:38.157

将`Dock`属性设置为`Bottom`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T00:13:10.190

您必须使用`ClientSize`而不是`Size`.

以下：

```
textBox1.AppendText(Size.ToString() + "\r\n");
textBox1.AppendText(ClientSize.ToString() + "\r\n"); 
```

产量：

```
{Width=300, Height=300}
{Width=284, Height=262} 
```

当然，使用 Boo 的答案是最简单的。

# c# - ASP.NET 图表控件 - 第一个图表在第一次加载页面时显示为空白

> ID：10438343
> 
> 赞同：0
> 
> 时间：2012-05-03T19:47:20.147
> 
> 标签：c#, asp.net, charts

我有一个页面，它使用 ASP.NET 4.0 图表控件生成四个图表并显示它们。图表是在页面加载的代码隐藏中创建的，并添加到页面上的表格中。

我的问题是，当页面加载时，前 1 个或多个图形（通常只有一个，但有时是 2 个或 3 个）是空白的（用户得到一个空的轮廓框，该框与图形大小相同，左上角有一个红色 X角落）。

刷新页面会导致所有图表正确呈现。

关于如何在第一次通过时填充图表的任何想法？

这是生成图表并将其添加到页面的代码（包含此代码的例程被调用 4 次）。请注意，“points”对象包含一组名称-值对，其中名称是要显示在 X 轴上的标签，值是数字 Y 轴值：

```
Chart graph = new Chart();
graph.Width = 800;
graph.Height = 400;
Series series = new Series();
series.Name = "Series1";
series.Palette = ChartColorPalette.Bright;
series.IsXValueIndexed = true;
for (int j = 0; j < points.Count; j++)
{
    DataPoint dataPoint = new DataPoint(j+1.0, points.GetItem(j).Value);
    dataPoint.AxisLabel = points.GetItem(j).Name.Trim();                    
    series.Points.Add(dataPoint);
}
graph.Series.Add(series);
ChartArea chartArea = new ChartArea();
chartArea.Name = "ChartArea1";
chartArea.AxisX.Interval = 1;
chartArea.AxisY.LabelStyle.Format = "###,###,###,###";
graph.ChartAreas.Add(chartArea);
graph.Titles.Add(caption);

TableRow tr = new TableRow();
TableCell td = new TableCell();
td.Width = new Unit(100.0, UnitType.Percentage);
tblGraph.Rows.Add(tr);
tr.Cells.Add(td);
td.Controls.Add(graph); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T19:15:33.957

这样做的过程是什么（渲染页面的延迟）？我断断续续地遇到同样的问题。在开发中，图表（这里只有一个）不会显示 10 次中的 9 次。在生产中，图表确实显示了大约 10 次中的 7 次。我想修复的是十分之三的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T19:50:40.017

这里同样的问题。图表图像被写入文件系统，但这发生在页面呈现后大约 20 毫秒。如果您在渲染 Chart 控件后让代码休眠 20 毫秒，则问题不会发生 - 将有时间将图像写入磁盘。

# testing - 如何测试电子商务交易？

> ID：10438344
> 
> 赞同：0
> 
> 时间：2012-05-03T19:47:34.423
> 
> 标签：testing, google-analytics, e-commerce

是否可以在发送到生产之前测试 Google 电子商务交易代码是否正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:12:36.923

大多数商家服务提供商都有测试模式设置。看看你有没有发现。您也可以进行真实交易并在完成后退款。

# java - 如何从我的 Android 设备获取未读短信/未接电话？

> ID：10438349
> 
> 赞同：1
> 
> 时间：2012-05-03T19:47:45.133
> 
> 标签：java, android

我一直在开发 Android 应用程序，我需要从我的 Android 设备接收未读短信/未接来电。有什么方法可以做到吗？我希望有一些内容提供商可以做到这一点。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T04:23:54.163

要获得短信 uread 计数。我认为这对你有用

```
 public static int getUnreadSmsCount(Context context) { 
         String SMS_READ_COLUMN = "read"; 
         String UNREAD_CONDITION = SMS_READ_COLUMN + "=0"; 
         int count = 0; 
         Cursor cursor = context.getContentResolver().query( 
               SMS_INBOX_CONTENT_URI, 
               new String[] { SMS_ID }, 
               UNREAD_CONDITION, null, null); 
         if (cursor != null) { 
            try { 
               count = cursor.getCount(); 
            } finally { 
               cursor.close(); 
            } 
         } 
         // We ignored the latest incoming message so add one to the 
total count 
         //   count += 1; 
         return count; 
   } 
```

# java - 在 Java 中流式传输音频/广播？

> ID：10438351
> 
> 赞同：3
> 
> 时间：2012-05-03T19:48:14.330
> 
> 标签：java, audio, streaming, mp3, radio

我一直在浏览整个网络，并尝试了很多不同的东西，但我不知道如何在 java 中播放流音频——这对于我现在正在开发的应用程序至关重要。这是一台收音机。我已经为网络编写了它，但我想要一个桌面版本，我认为 java 可能是要走的路。

流看起来像这样（主要是 MP3）： http: [//lyd.nrk.no/nrk_radio_mp3_mp3_h](http://lyd.nrk.no/nrk_radio_mp3_mp3_h)（示例来自 NRK MP3 - 挪威的广播频道）。

那么我应该从这里去哪里呢？我已经尝试过 JMF、FMJ 和很多其他的东西。我只想流式传输音频..感谢所有答案，请帮帮我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:59:42.360

您是否尝试过 Java FX 2（最新版本是 2.1）？它有一个相当容易使用的媒体组件。根据我的经验，适用于视频，包括流视频（甚至 JavaFX 2.1 中的 h.264）。可以用它播放普通的 mp3 文件，但从未尝试过流式传输 mp3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T15:23:21.410

JavaFX 2 不支持 mp3 流，但您可以破解它。

在新线程中打开与任何 ICY mp3 流的套接字连接，并开始将字节保存到文件中。

收到几千字节后，在 JavaFX MediaPlayer 中打开文件并播放它，但不要停止在另一个线程上接收字节。

这对我有用。

# c++ - c++ 对数组的引用

> ID：10438354
> 
> 赞同：1
> 
> 时间：2012-05-03T19:48:31.887
> 
> 标签：c++, char, pass-by-reference

我无法`unsigned char`在`z`. `myfunc()`我已经尝试了几种方法，但就是想不通。这是我最近的尝试：

```
int myfunc (int &y, unsigned char (&z)[2]);

int main(int argc, char *argv[]) {
 int y = 1;
 unsigned char z[2];

 int x = myfunc(y, z[2]);
}

int myfunc(int &y, unsigned char (&z)[2]) {
 y = 123;
 z[0] = foo;
 z[1] = bar;
 return 456;
} 
```

我收到以下错误：

```
error: in passing argument 2 of ‘int myfunc(int&, unsigned char (&)[2])’ 
```

对于线`int myfunc (int &y, unsigned char (&z)[2]);`

和：

```
error: invalid initialization of reference of type ‘unsigned char (&)[2]’ from expression of type ‘unsigned char’ 
```

对于线`int x = myfunc(y, x);`

我应该如何引用它自己的数组（而不是引用数组？）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-03T19:50:55.173

```
myfunc(y, z[2]); 
```

表达式`z[2]`是类型的`unsigned char`（并且引用数组末尾之外的元素，因此它是未定义的行为）。你想做：

```
myfunc(y, z); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:52:16.497

调用应该是：`int x = myfunc(y, z);`

这是因为`z`代表 an`unsigned char [2]`但`z[2]`代表 type `char`。还`z[2]`可以越界访问数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T01:49:04.837

我对你想要做什么感到有点困惑。恕我直言，您的签名应该是`int myfunc (int &y, unsigned char z[2])`.

数组不会“按值”传递（如果您想这样做，那么使用向量是最简单的方法），并且默认值使您的`get_mac`函数（我认为应该是`myfunc`）按需要工作（除非我'我误解了你的愿望）。

签名`int myfunc (int &y, unsigned char (&z)[2])` *表明*您可能希望`z`在调用者中更改其自身的值（不仅仅是 的元素`z`），但即使调用者也不能这样做（！），如果您尝试，您会收到错误消息。如果需要，请使用实际指针。

使用示例中的语法通过引用传递数组*是*合法的用途，即强制声明的数组大小。但如果你只是在学习，我认为你还不需要担心这个。

# iphone - EKCalendarItem 的 UUID 真的是独一无二的吗？

> ID：10438355
> 
> 赞同：0
> 
> 时间：2012-05-03T19:48:32.957
> 
> 标签：iphone, ios, ios4, ekeventkit

iOS 4 中的 EKEvent 类有一个名为 eventIdentifier 的属性，它不是“真正”唯一的（主要是在本地日历与远程日历同步时）。

在 iOS 5 sdk 中，EKCalendarItem 有一个名为 UUID 的属性，根据文档，它是唯一的

我的问题是，有没有人发现这不是真的？我试图用我的核心数据和本地日历编写一些同步代码，并且我“需要”一个唯一标识符才能让它工作。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T07:13:55.980

不，不同设备上相同事件的 UUID 不同。检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:31:57.573

在 UUID（通用唯一标识符）的上下文中，“唯一”一词的意思是“实际上唯一”而不是“保证唯一”。

根据Wikipedia 的[Universally unique identifier](http://en.wikipedia.org/wiki/Universally_unique_identifier)一文中的[随机 UUID 重复概率](http://en.wikipedia.org/wiki/Universally_unique_identifier#Random_UUID_probability_of_duplicates)部分，在生成 68,719,476,736 个 UUID 后，仅创建一个重复的概率为 0.0000000000000004。

# android - 使用 PhoneGap 访问网站

> ID：10438357
> 
> 赞同：1
> 
> 时间：2012-05-03T19:48:39.790
> 
> 标签：android, jquery-mobile, cordova, asp.net-mvc-4

我有一个由 ASP.Net MVC 生成的客户端 Web 应用程序（Html 5、CSS、JQueryMobile 等）。我使用 ASP.Net MVC 将用户代理识别为传统浏览器或移动浏览器。如果是移动浏览器，那么我会呈现移动视图。当通过桌面上的浏览器或移动设备（iPad 和 Android 平板电脑）上的浏览器访问时，该应用程序按设计运行。

客户希望将他们的应用程序包装在 PhoneGap 中，以便他们可以为 Google Play 和 Apple 商店创建可分发的内容。我对PhoneGap 比较陌生，所以我采用的方法是创建一个精简的html 页面，其中包含一个访问所述应用程序URL 的iframe。我的意图是使用 Dreamweaver CS 5.5 和 PhoneGap 生成 APK 文件和 iPad 等效文件，以便我们可以将客户端的应用程序加载到不同的移动商店。

我不确定这种方法是否正确。看起来它应该可以工作：一个精简的 index.html 页面，它只有一个调用应用程序的 iframe。这是代码：

```
<html>
<head>... phoneGap.js..</head>
<body style="margin:0px;padding:0px;overflow:hidden">
    <iframe src="[URL TO WEBSITE HERE]" frameborder="0" style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" height="100%" width="100%"></iframe>
</body>
</html> 
```

我使用上面的代码创建了一个 APK 文件，并将其加载到运行 IceCreamSandwhich 的 Android 平板电脑中，但性能很糟糕。但是，我可以通过同一台 Android 平板电脑上的浏览器访问该应用程序，并且一切都按设计运行。

有人可以请我指出如何让它发挥作用的正确方向。我无法更改 ASP.Net MVC。必须有一种方法可以将由 ASP.Net MVC 生成的移动应用程序打包，以便将其放入 Google Play 和 Apple Store。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T23:47:41.433

您很可能无法使其以您拥有的方式工作，因为在 iframe 中运行的代码无法访问 phonegap.js。

您可以将索引页面重定向到您的服务器，但是 Apple 很可能不允许您通过他们的应用商店分发它。这还需要您将 phonegap/cordova js 文件放在您的服务器上。

一个“典型的”phonegap/cordova 应用程序具有位于客户端上的资源（它们被打包到应用程序中），而服务器仅用于提供数据，通常通过 REST+JSON api。

您听起来要构建的是一个包装好的网站，恕我直言，它不是一个应用程序，应该只在浏览器中使用。

# lua - Lua 模式中的交替运算符是什么？

> ID：10438358
> 
> 赞同：9
> 
> 时间：2012-05-03T19:48:40.390
> 
> 标签：lua, lua-patterns

在正则表达式中，`|`用于交替。Lua 模式中对应的字符是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-03T19:56:05.653

首先，注意 Lua[模式](http://www.lua.org/manual/5.1/manual.html#5.4.1)不是正则表达式；它们是它们自己更简单的匹配语言（具有不同的优点和缺点）。

根据我上面链接到的规范，并且根据[这个答案](https://stackoverflow.com/a/2696469/405017)，Lua 模式中没有交替运算符。要获得此功能，您需要使用更强大的 Lua 构造（如[LPEG](http://www.inf.puc-rio.br/~roberto/lpeg/)或[Lua Regex Library](http://rrthomas.github.com/lrexlib/)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-19T13:01:44.407

Lua 在你不能使用的模式中没有交替（`test1`| `test2`）。您只能在多个字符之间进行选择，例如will `[abcd]`match `a`、或。`b``c``d`

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2017-06-08T01:25:31.627

另一个解决方法是：而不是：

> 苹果|橙

写：

> [ao][pr][pa][ln][例如]

说明：匹配每个单词的替代字母。瞧！

# css - 如何使用从右到左的 twitter-bootstrap 跨度？

> ID：10438364
> 
> 赞同：4
> 
> 时间：2012-05-03T19:49:17.783
> 
> 标签：css, twitter-bootstrap

如果我想在屏幕右侧放置一个元素，例如最后 3 个跨度，并希望它们左侧有空白（不使用跨度），这可以在 twitter-bootstrap 上实现吗？如果可以，如何实现？谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-03T20:00:07.263

你可以这样做：

```
<div class="row">
    <div class="span9"></div>
    <div class="span3"></div>
</div> 
```

你也可以这样做：

```
<div class="row">
    <div class="span3 offset9"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-21T13:10:38.780

您可以使用`pull-right`和`pull-left`：

```
<div class="row">
  <div class="span3 pull-right"></div>
  <div class="span6 pull-left"></div>  
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T19:54:44.253

跨度在 12 个部分中工作，因此如果您想要左侧 3 个跨度，您只需要一个占用其余空间的跨度

```
<div class="row">
  <div class="span6"></div>
  <div class="span2"></div>
  <div class="span2"></div>
  <div class="span2"></div>
</div> 
```

或者，您可以使用偏移量

```
<div class="row">
  <div class="span2 offset6"></div>
  <div class="span2"></div>
  <div class="span2"></div>
</div> 
```

# javascript - Div 部分未显示到所有单选按钮部分-Jquery

> ID：10438365
> 
> 赞同：0
> 
> 时间：2012-05-03T19:49:30.383
> 
> 标签：javascript, jquery, jquery-ui

`show()` `hide()`当您单击单选按钮时，我遇到了这个 Jquery div问题。我已经搜索了这个论坛，并且能够使该功能正常工作，但不是所有的单选按钮。我有*n*个单选按钮，当用户单击“是”时，我想显示一个 div 部分。但我遇到的问题是这对第一个单选按钮正常工作，其余的不响应点击。这是我正在使用的 js

```
$(document).ready(function() {

    $('#isYes').click(function() {
        var test = $(this).val();
        alert(test)
        $("div.desc").hide();
        $('#divCheck').show();

    });

    $('#isNo').click(function() {

        $('#divCheck').hide();
    }); 
```

我的jsp代码看起来像

```
 <p>

           <td><core:out value="${obj.txt}" /> <form:radiobutton
                                            path="car[${Status.index}].carSelection"
                        value="isYes" onclick="" id="isYes" label="Yes" /> <form:radiobutton
                        path="car[${Status.index}].carSelection"
                        value="isNo" id="isNo" label="No" />
    </td>

</p>

     <div id="divCheck" class="desc({where desc is display: none;})">

                    <c:forEach items="${car.carList}" var="type"
                        varStatus="cstatus">

                        <form:checkbox path="carList[${cstatus.index}]"
                            value='${type.carName' />
                        <core:out value="${type.carName}" />
                        <br />

            </c:forEach>

            </div> 
```

为什么复选框只显示第一个单选按钮而不显示其余单选按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:24:54.333

正如 alexg 所说，如果您在一个页面上使用多个 id，jquery 只会找到第一个。如果你把它改成一个类。您将获得一个包含任意数量元素的选择器。

这有效：

```
<input class="isYes" type="radio">
<input class="isYes" type="radio">
var totalElements = $('.isYes').length; // 2 
```

这不会：

```
<input id="isYes" type="radio">
<input id="isYes" type="radio">
var totalElements = $('#isYes').length; // 1 
```

# jquery - jQuery - 更改输入文本

> ID：10438369
> 
> 赞同：29
> 
> 时间：2012-05-03T19:49:48.777
> 
> 标签：jquery, onchange, textinput

我正在尝试创建一个函数，该函数将在 a 的值`text input field`更改时执行。单击表格单元格时，字段的值会发生变化，而不是 on `keyup`，也不粘贴。我试过这样：

```
$("#kat").change(function(){ 
    alert("Hello");
}); 
```

我有文本字段：

```
<input type="text" id="kat" value="0"/> 
```

但它不起作用。有什么帮助吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-03T19:54:24.163

这是来自 jQuery 文档页面上的评论：

> 在较旧的 HTML5 之前的浏览器中，“keyup”绝对是您要找的。
> 
> 在 HTML5 中有一个新事件“input”，它的行为与您认为“change”应该表现的完全一样——只要按下一个键以将信息输入到表单中，它就会触发。
> 
> $('元素').bind('输入',函数);

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-03T19:58:59.213

在我看来，您正在更新 javascript 中文本字段的值。`onchange`仅当您键入数据并跳出文本字段时才会触发事件。

一种解决方法是在从脚本修改文本框值时触发文本框更改事件。见下文，

```
$("#kat").change(function(){ 
    alert("Hello");
});

$('<tab_cell>').click (function () {
   $('#kat')
      .val($(this).text()) //updating the value of the textbox 
      .change();           //trigger change event.
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-06-05T16:53:17.317

这种技术对我有用：

```
$('#myInputFieldId').bind('input',function(){ 
               alert("Hello");
    }); 
```

请注意，根据[this JQuery doc](http://api.jquery.com/bind/)，建议使用“on”而不是在较新版本中绑定。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-12-16T11:54:47.057

这对我有用

```
var change_temp = "";
$('#url_key').bind('keydown keyup',function(e){
    if(e.type == "keydown"){
        change_temp = $(this).val();
        return;
    }
    if($(this).val() != change_temp){
        // add the code to on change here 
    }

}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-03T19:57:47.637

jQuery 文档说：“如果您更改字段中的文本然后单击离开，它也会显示 [处理程序执行结果]。但是，如果字段在内容没有更改的情况下失去焦点，则不会触发事件。”。

尝试 keyup 和 keydown 事件，如下所示：

```
$("#kat").keydown(function(){ 
   alert("Hello");
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-08T12:08:53.063

```
function search() {
        var query_value = $('input#search').val();
        $('b#search-string').html(query_value);
        if(query_value !== ''){
            $.ajax({
                type: "POST",
                url: "search.php",
                data: { query: query_value },
                cache: false,
                success: function(html){
                    //alert(html);
                    $("ul#results").html(html);
                }
            });
        }return false;    
    }

    $("input#search").live("keyup", function(e) {
        clearTimeout($.data(this, 'timer'));

        var search_string = $(this).val();

        if (search_string == '') {
            $("ul#results").fadeOut();
            $('h4#results-text').fadeOut();
        }else{
            $("ul#results").fadeIn();
            $('h4#results-text').fadeIn();
            $(this).data('timer', setTimeout(search, 100));
        };
    });

and the html 
<input id="search" style="height:36px; font-size:13px;" type="text" class="form-control" placeholder="Enter Mobile Number or Email"  value="<?php echo stripcslashes($_REQUEST["string"]); ?>" name="string" />
        <h4 id="results-text">Showing results for: <b id="search-string">Array</b></h4>
        <ul id="results"></ul> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-29T16:15:32.063

我最近想知道为什么我的代码不起作用，然后我意识到，我需要在加载文档后立即设置事件处理程序，否则当浏览器逐行加载代码时，它会加载 JavaScript，但它没有还拥有将事件处理程序分配给它的元素。以你的例子，它应该是这样的：

```
$(document).ready(function(){
     $("#kat").change(function(){ 
         alert("Hello");
     });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-01T08:17:42.873

这适用于所有浏览器和 Jquery <= v1.10

```
$('#kat').on('keyup', function () {
    alert("Hello");
}); 
```

或者如你所愿

```
$('#kat').on('click', function () {
    alert("Hello");
}); 
```

文本框输入字段更改事件会按您的预期触发，jQuery .Change 事件仅在支持 html5 的浏览器上正常工作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-03T20:01:32.627

这对我有用。如前所述，可能是浏览器问题，或者可能没有正确注册 jQuery，或者真正的问题可能更复杂（您制作了一个更简单的版本来问这个问题）。PS-确实必须单击文本框才能使其触发。

[http://jsfiddle.net/toddhd/Qt7fH/](http://jsfiddle.net/toddhd/Qt7fH/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-09-07T11:58:51.633

尝试这个，

```
$('#kat').on('input',function(e){
 alert('Hello')
}); 
```

# javascript - Javascript Array.indexOf() 在应用于对象数组时表现出奇怪的行为

> ID：10438373
> 
> 赞同：0
> 
> 时间：2012-05-03T19:50:26.577
> 
> 标签：javascript, arrays, object, indexof

我创建了以下代码 [http://jsfiddle.net/EbCUx/](http://jsfiddle.net/EbCUx/)

```
var arr = [{a:1,b:2,c:3},{a:3,b:5,c:6}];
var a = arr[0];
alert(arr.indexOf(a));
var b = {a:1,b:2,c:3};
alert(arr.indexOf(b)); 
```

即使 a 和 b 的内容相同，为什么 indexOf() 返回 -1 ..我知道 a 是参考值 ..这是原因吗...有人可以解释一下确切的原因吗​​？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:51:12.633

您正在比较 2 个碰巧在内部具有相同值的不同对象，但从相等的角度来看，它们仍然是不同的对象。

您的原始代码：

```
<script>
    var arr = [{a:1,b:2,c:3},{a:3,b:5,c:6}];
    var a = arr[0];
    alert(arr.indexOf(a));
    var b = {a:1,b:2,c:3};
    alert(arr.indexOf(b));
</script> 
```

显示如何在比较中获得匹配的更新版本。

```
<script>
    var b = {a:1,b:2,c:3};
    var arr = [b,{a:3,b:5,c:6}];
    var a = arr[0];
    alert(arr.indexOf(a));
    alert(arr.indexOf(b));
</script> 
```

如果要比较碰巧具有相同值的 2 个不同对象，则必须手动进行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T19:54:46.270

来自[MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf)：

> indexOf 使用严格相等将 searchElement 与 Array 的元素进行比较（与 === 或三等号运算符使用的方法相同）。

由于没有两个对象是严格相等的，因此您不能使用 indexOf 搜索对象数组，您必须循环（如果数组的元素是对象，则扩展 indexOf 以循环）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-04T05:03:20.867

改用这个

添加此代码：

```
<script>
   Array.prototype.newIndexOf = function( item ) {
      var count = this.length;
      var j = 0;
      while (this[j++] !== item && j < count) {}
      return (j === count) ? -1 : j;
   }
</script> 
```

indexOf 很慢并且没有严格的相等检查。

> [http://jsperf.com/indexof-vs-equaling/2](http://jsperf.com/indexof-vs-equaling/2)

# asp.net - 如果我使用带有 requestvalidation 的 ASP.net 控件，应该防止 XSS 对吗？

> ID：10438379
> 
> 赞同：0
> 
> 时间：2012-05-03T19:51:10.540
> 
> 标签：asp.net, security, xss

好吧，我们都知道将来总会发现 XSS 漏洞，这些漏洞会破坏 ASP.net 的默认请求验证安全性。

但是，默认情况下，validateRequest 为 true。因此，很多 html 值首先不能输入到 ASP.net 文本框和其他输入中，对吗？

因此，虽然它不是针对 XSS 的 100% 可靠安全性，但它肯定涵盖了其中的大部分，对吧？

我不相信每次我从数据库中向 ASP.net html（通过 .Text = ...）吐出一些东西时，我都需要做进一步的 HtmlEncodes() 或自定义的 plainText() 函数，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:15:06.010

> 我不相信每次我从数据库中向 ASP.net html（通过 .Text = ...）吐出一些东西时，我都需要做进一步的 HtmlEncodes() 或自定义的 plainText() 函数，对吗？

**我强烈建议不要这样做。**

首先，ASP.NET 请求验证不会阻止 JavaScript 或 SQL 注入。

其次，请记住，XSS 漏洞的发生是由于您的代码中的错误——例如，无法正确地对用户输入进行 HTML 编码或 JavaScript 编码的代码。仅仅因为您启用了请求验证，并且 ASP.NET 阻止*了一些*恶意输入，并不能神奇地从您的代码中删除错误！

请求验证是一种纵深防御措施，可以帮助防止您的应用程序*在您犯错时*被利用。编写始终正确编码用户输入的无错误代码，您可以放心，攻击者必须跳过*两圈*才能破坏您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T08:56:36.013

输入过滤不能解决输出转义问题。抵挡不经意的攻击者充其量只是一种局部且不可靠的防御。在我看来，框架提供商将其作为针对 XSS 问题的可靠防御是错误的和不负责任的。

您*必须*对放入 HTML 字符串的任何文本内容进行 HTML 编码。同样，您必须对您放入 JS 字符串的任何文本内容进行 JavaScript-string-literal-encode。您必须对放入 SQL 查询的任何文本内容进行 SQL 转义。等等。

这完全取决于您创建的输出格式；它**无法**在您不知道输出目标格式将是什么的输入层处理。

如果您从 HTTP 参数输入以外的来源获取任何内容并将其包含在输出中，那么您根本不受保护；相反，如果您使用 HTTP 输入来创建 HTML 以外的内容，那么您的内容就会受到不必要的破坏。另外，当然，您正在阻止完全有效的输入——如果 SO 使用请求验证，我们将无法进行此对话，因为它会在我们提到的任何时候中断`<script>`。

明智的编码人员使用现有的库/框架层来避免手动调用转义函数的需要，因为很容易忘记这样做。因此建议使用参数化查询，而不是从字符串连接创建 SQL。HTML 也是如此：使用精心设计的模板语言或 Web 控件集将避免您必须做任何事情，因为默认情况下会发生 HTML 转义。

ASP.NET 和 Web 窗体在这方面*部分设计得很好。*如果您设置`TextBox.Text=...`为是，则内容将根据您的需要进行转义，无需执行更多操作。另一方面，如果您将`Literal.Text=...`其设置为不编码，则默认情况下（这可以通过`LiteralMode`属性进行更改）。这种不一致是非常不幸的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:55:37.550

如果您启用了请求验证，则大多数情况下您应该受到保护。不幸的是，如果您需要保存标记，则必须先将其剥离，否则验证将抛出`HttpRequestValidationException`：

![在此处输入图像描述](../Images/365e1d5532644b8877c0fb41ee952191.png)

有关详细信息，请参阅白皮书：[请求验证 - 防止脚本攻击](http://www.asp.net/whitepapers/request-validation)

# java - Java TCP 客户端/服务器和循环问题

> ID：10438382
> 
> 赞同：2
> 
> 时间：2012-05-03T19:51:23.393
> 
> 标签：java, loops, client, boolean

这是我第一次制作**TCP Client/Server 程序**。我应该制作一个简单的 Java 客户端和服务器程序，向客户端询问用户名和密码。服务器从那里检查其用户数据库（我尝试使用覆盖维数组创建）以查看是否存在匹配并向客户端返回一条消息“Hello”（用户名），然后告诉用户所有其他服务器上的注册用户。

然而，我的**具体问题**是，每当我运行这两个时，当我到达服务器应该通过循环的部分时，显示的只是*“当前在服务器上注册的其他用户包括：MATTCARLJOHN 其他用户在服务器目前包括：MATTCARLJOHN 目前在服务器上注册的其他用户包括：MATTCARLJOHN"*。

似乎我的服务器完全忽略了我的 for 循环和 if 语句，该语句应该检查身份验证并直接跳到该循环，而不管我在客户端输入的用户名和密码是什么。

**这是两个程序： 客户端**

```
import java.io.*;
import java.net.*;

class TCPClient2
{
    public static void main(String argv[]) throws Exception
    {
         String userName;
         String passWord;
         String loginInfo;
         String loginInfo2;

         BufferedReader inFromUser = new BufferedReader( new InputStreamReader(System.in));
         Socket clientSocket = new Socket("localhost", 6789);
         DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
         BufferedReader inFromServer = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

         System.out.println("Username: ");
         userName = inFromUser.readLine();
         outToServer.writeBytes(userName + '\n');

         System.out.println("Password: ");
         passWord = inFromUser.readLine();
         outToServer.writeBytes(passWord + '\n');

         loginInfo = inFromServer.readLine();
         System.out.println(loginInfo);

         clientSocket.close();
     }
} 
```

**和服务器**

```
import java.io.*;
import java.net.*;

class TCPServer2
{
    public static void main(String argv[]) throws Exception
    {

        ServerSocket welcomeSocket = new ServerSocket(6789);
        String[][] Login = {{"MATT","UNCP"},{"JOHN","UNCP"},{"CARL","UNCP"}};
        String username;
        String username1;
        String password;
        String password1;
        while(true)
        {
            Socket connectionSocket = welcomeSocket.accept();
            BufferedReader inFromClient =
               new BufferedReader(new InputStreamReader(connectionSocket.getInputStream()));
            DataOutputStream outToClient = new DataOutputStream(connectionSocket.getOutputStream());
            username = inFromClient.readLine();
            System.out.println("Username received: " + username);
            password = inFromClient.readLine();
            System.out.println("Password received: " + password);
            username1=username.toUpperCase() + '\n';
            password1=password.toUpperCase() + '\n';

            for(int i = 0; i<Login.length; i++){
                if(Login[i][0].equals(username1) && Login[i][1].equals(password1)){
                    outToClient.writeBytes("Hello " + username1);
                    outToClient.writeBytes("Other users registered on the server currently include: ");
                    for(int k = 0; k<Login.length; k++){
                        outToClient.writeBytes(Login[k][0]);}
                else
                    outToClient.writeBytes("Invalid Username and/or password.");
                }
            }

        }
    }
} 
```

任何帮助将不胜感激，这是我第一次在网站上发帖，而且我对网络和 Java 非常陌生，所以如果我的问题看起来令人困惑，请原谅我。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:32:27.253

您将换行符附加到`username1`and `password1`。这些换行符不存在于硬编码的登录凭据 ( `"MATT","UNCP"`) 中，因此比较...

```
if(Login[i][0].equals(username1) && Login[i][1].equals(password1)){ 
```

永远不会成功。

只需省略`username1`and中的换行符`password1`（至少在 之后`if`）。

哦，不要忘记所有消息的换行符，fe：

```
outToClient.writeBytes("Invalid Username and/or password.\n");
//                                                       /
//                                                 added the \n 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:53:58.957

当我运行它时，代码实际上似乎对我有用。在客户端上看到：

```
$ java TCPClient -classpath .
Username:
blah
Password:
blah 
```

在我看到的服务器上：

```
$ java TCPServer -classpath .
Username received: blah
Password received: blah 
```

# ios - 在 iOS 中跟踪手机使用统计信息

> ID：10438383
> 
> 赞同：-1
> 
> 时间：2012-05-03T19:51:24.053
> 
> 标签：ios, statistics, cellular-network

我想制作一个应用程序，显示蜂窝使用的统计信息，例如在哪里拨打了多少电话，每次通话时长，短信数量等...

我在任何地方都找不到任何资源，即使在 Apple Developer 文档中也找不到。

这种应用可以吗？有谁知道我如何设置这种应用程序？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:16:25.333

此信息没有公共 API。

一般来说，iOS 安全沙箱会阻止应用程序收集任何其他应用程序的信息，包括电话应用程序，除非有公共 API 或以前注册的 URL 处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:54:09.823

我不知道您将能够访问此类信息。我确实认为这在 Android 中将是一项微不足道的任务，但在 iOS 中我对此表示怀疑。

# php - 使用 PHP / GD 将二进制数据保存为 JPEG 而不会丢失元数据

> ID：10438384
> 
> 赞同：0
> 
> 时间：2012-05-03T19:51:29.680
> 
> 标签：php, gd, jpeg, binary-data

我有一个图像作为二进制数据输入我的 PHP 脚本。我想将此图像作为 jpeg 保存到我服务器上的目录中。我可以使用以下代码完成此操作：

```
// create image resource from the binary data
$image = imagecreatefromstring($binary_data);

// save the image resource as a jpeg
imagejpeg($image, $directory); 
```

问题是当我这样做时，我认为它正在创建一个包含新元数据的新图像。有没有办法可以将二进制数据保存为图像并保留原始二进制数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:20:44.450

With Meta data, you can read the data via [iptcparse()](http://php.net/iptcparse) and embed it back in via [iptcembed()](http://php.net/iptcembed)

This comment will pretty much do exactly what you want -> [http://us3.php.net/manual/en/function.iptcembed.php#85887](http://us3.php.net/manual/en/function.iptcembed.php#85887)

For EXIF data, you can read it via [exif-read-data()](http://php.net/manual/en/function.exif-read-data.php) but there isn't a way of writing that data back to the file, but hopefully that should be enough to get you started in the right direction.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:00:54.287

你为什么不直接保存`$binary_data`而不是通过 GD
`file_put_contents($directory, $binary_data)`

# c# - 在嵌套的粗体标签中/周围保留空格

> ID：10438388
> 
> 赞同：0
> 
> 时间：2012-05-03T19:51:40.463
> 
> 标签：c#, wpf, xaml

我有一些用于 Silverlight 项目的 xaml 代码，如下所示：

```
<Grid>
    <RichTextBox>
        <Paragraph>
            <Bold>Note: </Bold>This is an important message!
        </Paragraph>
    </RichTextBox>
</Grid> 
```

问题是，无论我在粗体标签中/周围放置空格的位置，我都无法在“This”中的“T”之前获得空格。有没有比仅在父标签上使用 xml:space="preserve" 属性更优雅的解决方案？因为那时我必须删除带有此问题的标签之前的所有制表符，这会破坏 xml 本身的分层视图。

需要明确的是，我知道以下解决方案有效：

```
 <Grid>
        <RichTextBox>
            <Paragraph xml:space="preserve">
<Bold>Note:</Bold> This is an important message!
            </Paragraph>
        </RichTextBox>
    </Grid> 
```

但我很想知道是否有更清洁的方法来完成同样的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T08:53:12.270

怎么样

```
<Grid>
    <RichTextBox>
        <Paragraph>
            <Bold xml:space="preserve">Note: </Bold>This is an important message!
        </Paragraph>
    </RichTextBox>
</Grid> 
```

让您需要保留空间的地方更加明显？

# jquery - IOS地图没有固定到地图

> ID：10438393
> 
> 赞同：1
> 
> 时间：2012-05-03T19:51:58.280
> 
> 标签：jquery, ios5, jquery-mobile, cordova

我设置了一个 phonegap 应用程序，其中包含一个地图链接。该链接假设退出我的程序并输入固定位置的地图程序。但相反，应用程序退出并进入地图程序，但不固定实际位置。我尝试了几个不同的位置、链接格式等。似乎没有任何效果。我正在运行以下内容：

phonegap 1.4 jquery 1.7.1 jquerymobile 1.1

还有其他一些事情，但是我禁用了所有内容，只是在索引 html 文件中放置了一个链接，它做了同样的事情。谁能想到可能是什么原因造成的？这是我正在使用的链接：

```
 <a href='maps://maps.google.com/maps?q=cupertino' data-role='button'   class="directions">Directions</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:09:07.127

根据我评论中的链接，正确的查询是：

```
maps:q=<search query> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T19:58:17.343

我们正在努力解决同样的问题。这在设置`saddr`和`daddr`设置（路由的源地址和目标地址）时工作正常，但`q`它不起作用。

一种选择似乎是您设置纬度+经度。但是如果这些值不可用，那么似乎没有解决方案（我的意思是使用 q 参数）。

# r - 有什么方法可以禁用 PDF/Poscript 输出中的“减号黑客”？

> ID：10438398
> 
> 赞同：6
> 
> 时间：2012-05-03T19:52:21.773
> 
> 标签：r, graphics, ggplot2, hyphen

在 R 中，将绘图保存到 PDF 或 Postscript 文件时，轴标签中的连字符会变成减号。显然，这是设计使然。根据“后记”设备的文档：

> [正常编码规则]有一个例外。字符 45 ('"-"') 始终设置为减号（它在 Adob​​e ISOLatin1 中的值），即使它在其他编码中是连字符。连字符在所有拉丁编码、西里尔文和希腊文中都可用作字符 173（八进制 0255）。（这可以在 UTF-8 语言环境中输入为 '"\uad"'。）

有什么办法可以关闭这个功能吗？

我遇到的问题是我经常以各种格式保存绘图，如果我遵循建议的“\uad”解决方法，我会在 Postscript/PDF 输出中得到预期的连字符，但在将绘图渲染到其他图形设备（如 PNG）时却没有. 我宁愿不必为每个绘图创建两个版本，一个用于 PDF，一个用于 PNG。

如果我可以禁用“减号黑客”，那么图形设备之间的渲染行为将是一致的，我可以简单地“打印”一个图到多个设备上以获取不同格式的图。例如，我希望能够执行以下操作，并让连字符在 PDF 和 PNG 版本的绘图中一致地呈现：

```
p <- qplot(arrival_rate, mean_service_time, data = response_times, ...)
ggsave(p, file = "/tmp/service-scaling.pdf", useDingbats = F)
ggsave(p, file = "/tmp/service-scaling.png") 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T23:13:20.957

如果您的机器支持它（并且您可以键入`capabilities()`以了解它是否支持），您可以改用`cairo_pdf()`. 它似乎`"-"`更像其他绘图设备一样处理：

![在此处输入图像描述](../Images/762b7cec9c7d80103036fe135fd9dbe3.png) ![在此处输入图像描述](../Images/f1ce61c311d6acd9d64c4c1cdc0a5f64.png)

在这里，因为我不妨包括它，是我用于上述两个 pdf 的代码：

```
cairo_pdf("cairo_pdf.pdf", width=6, height=3.5)
    par(mar=c(10,4,4,1))
    plot(1:10, type = "n", axes = FALSE, 
         main = "Plotted using cairo_pdf()",
         ylab = "", xlab = "x-y", cex.lab = 10)
dev.off()

pdf("pdf.pdf", width=6, height=3.5)
    par(mar=c(10,4,4,1))
    plot(1:10, type = "n", axes = FALSE, 
         main = "Plotted using pdf()",
         ylab = "", xlab = "x-y", cex.lab = 10)
dev.off() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-29T21:35:31.597

[此处](https://stat.ethz.ch/pipermail/r-help/2007-November/146272.html)描述的 pdf() 有一个解决方法：用 unicode 字符`"\255"`或 UTF8替换“-”连字符`"\uad"`。这可能无法在 R 控制台中很好地打印，但会在 pdf 中。它可以很容易地替换为`gsub("-", "\uad", "x-y")`：

[![在此处输入图像描述](../Images/43196d1eaee0b177276b113df5f54a89.png)](https://i.stack.imgur.com/APRT1.png)

```
pdf("pdf.pdf", width=5, height=4)
par(mar=c(6,2,2,2), mfrow=c(2,1))
plot(1:10, type = "n", axes = FALSE, 
     main = "Default",
     ylab = "", xlab = "x-y", cex.lab = 8)
plot(1:10, type = "n", axes = FALSE, 
     main = "with '\\uad'",
     ylab = "", xlab = gsub("-", "\uad", "x-y"), cex.lab = 8)
dev.off() 
```

我结束了使用此解决方案，因为我想以 CMYK 颜色模式导出 pdf，这在 cairo_pdf 中是不可能的（并且稍后转换为 CMYK 的替代方法使小文件的文件大小增加了 10 倍）。我希望其他人可以使用它。

[编辑]：添加了一个缺失的“”（这是为了避免 6 个字符的限制）

# matlab - 在同一个图中显示多个合适的对象？

> ID：10438402
> 
> 赞同：3
> 
> 时间：2012-05-03T19:52:42.893
> 
> 标签：matlab, matlab-uitable

我想在同一个 MATLAB 图中显示几个表，就像 subplot 可以用来显示多个图一样。但是，似乎子图不适用于合适的对象。

![尝试失败](../Images/c148a3f29a3534c3149d733172364c58.png)

如您所见，我得到了五组空轴，而不是分布在图中的五个表，并且只有一个表是可见的。

有没有办法在 MATLAB 中做到这一点？

编辑：应用下面提供的答案后好多了！

![在此处输入图像描述](../Images/0622ae14d3194590bf9211a07ecd10c8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:24:25.550

uitable 的父级是图形或 uipanel 本身。因此，您可以使用表格单位和位置属性手动设置表格在图形或 uipanel 中的位置。如果`t`是创建的表的句柄，`t=uitable(...)`则可以使用`set(t,'units'...)`和`set(t,'position',[left buttom widht height])`适当地定位表。

这是一个具体的例子

```
f=figure
dd=rand(5,4); %# data
colnames = {'1' '2' '3' 'weight'}
for i=1:4
    t(i) = uitable(f,'columnname',colnames, ...
                     'data',dd, ...
                     'units','normalized', ...
                     'pos',[(i-1)/4 0 .25 1])
end 
```

# c# - Windows 7坚持文件夹不存在

> ID：10438403
> 
> 赞同：2
> 
> 时间：2012-05-03T19:52:57.857
> 
> 标签：c#, windows-7, file-io

请阅读整篇文章，因为整篇文章都是相关的。

我写了这个 C# 代码：

```
static void DumpDir(string dir)
{
    string[] subdirs = Directory.GetDirectories(dir);
    foreach (string subdir in subdirs)
    {
        DumpDir(subdir);
    }

    string[] files = Directory.GetFiles(dir);

}

static void Main(string[] args)
{
    string startdir = @"G:\multimedia_dump";
    dirindexstart = startdir.Split('\\').Length;
    string[] dirs = Directory.GetDirectories(startdir);

    foreach (string dir in dirs)
    {
        DumpDir(dir);
    }
} 
```

它打开一个硬编码的目录，并递归地遍历它的所有子目录。这就是它所做的一切。而已。

但是，它在特定文件夹上出错：

[错误](http://chaoticlogic.net/err_msg/img2.png)

注意这不是初始目录。请注意，如果您遵循代码，它必须从逻辑上派生自 Directory.GetDirectories() 调用之一。此文件夹名称的生成效果并不差。它是真实的。

它不仅是真实的，而且我可以在 Explorer 的 GUI 中导航到它：

[GUI让我在那里导航](http://chaoticlogic.net/err_msg/img1.png)

奇怪的是，如果您在 CMD 中导航到该文件夹​​，它会显示在 DIR 中，但如果您按 TAB 键直到您收到有关文件夹名称的建议，它不会让您 CD 进入它。我会发布第三个链接，但这件事不会让我因为我是新手。

是什么赋予了？我认为生成此文件夹的软件是使用某种低级 NTFS 调用来实现的。有没有办法以编程方式清理这些文件夹名称，或者解决此错误，以便您可以访问存在但不应该的文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:23:42.593

该目录名称的末尾是否有空格？看起来你拍摄的 Explorer 中有。我认为这是不允许的，某些工具可能正在修剪空白，这就是导致您不匹配的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:30:01.923

看起来您的路径包含一个`|`. 这是一个非法字符，就正常的 Win32 API 而言，但就 NT API 而言并非如此。

您可以通过在路径前加上前缀来禁用一些 Win32 路径限制（例如最大路径长度 ~260 个字符）`\\?\`，但看起来这不包括`|`.

因此，您可能需要使用[NT API](http://msdn.microsoft.com/en-us/library/bb432380%28v=vs.85%29.aspx)来处理这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-03T18:08:18.597

我找到了一个可以清理名称的解决方案，但您必须在编辑它们之前执行此操作。如果您使用 ROBOCOPY 文件，它将从文件和文件夹名称中删除非法字符。

# c# - C# 从另一个实例化枚举

> ID：10438408
> 
> 赞同：0
> 
> 时间：2012-05-03T19:53:20.943
> 
> 标签：c#, enums

我有一个包含枚举的网络参考。

```
WebService.WebEnum.Member1
WebService.WebEnum.Member2
WebService.WebEnum.Member3 
```

等等

有没有办法基于 WebEnum 创建另一个枚举？我已经在这个上拉了几个小时的头发。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:03:04.743

不，你不能在枚举上使用继承。

但是，您可以通过使用类的静态成员属性（而不是枚举）来实现类似的效果。然后可以通过继承扩展这个类。

```
public class WebEnum
{
     protected WebEnum(int value)
     {
         ...
     }

     private static WebEnum _member1 = new WebEnum(1);

     public static WebEnum Member1
     {
         get { return _member1; }
     }
} 
```

然后你可以扩展

```
public class OtherWebEnums : WebEnums
{
     private static WebEnum _member4 = new WebEnum(4);

     public static WebEnum Member4
     {
          get { return _member4; }
     }
} 
```

免责声明：就设计而言，我敢打赌有些人会不高兴看到它，因为它可能违反了许多面向对象的设计规则......但它应该服务于目的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:29:00.363

是的，您可以使用[设计时 T4 文本模板](http://msdn.microsoft.com/en-us/library/dd820620.aspx)来生成基于另一个枚举的枚举。

（您必须将程序集名称设置为适合您的 WebService 枚举。）

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="$(SolutionDir)WebService\bin\Debug\WebService.Dll" #>
<#@ output extension=".cs" #>
enum GeneratedEnum
{
<# foreach(var member in Enum.GetValues(typeof(WebService.WebEnum))){ #>
     <#= member #>,
<# } #>
    AdditionalMember1,
    AdditionalMember2
} 
```

该`GeneratedEnum`类型将在编译时创建，如下所示：

```
enum GeneratedEnum
{
    Member1,
    Member2,
    Member3,
    AdditionalMember1,
    AdditionalMember2
} 
```

# java - Spring IoC - 构建上下文相关的bean？

> ID：10438409
> 
> 赞同：0
> 
> 时间：2012-05-03T19:53:24.500
> 
> 标签：java, spring, dependency-injection, ioc-container

考虑以下代码：

```
@Service
class UserSpecificService {
    @Autowired ServiceA serviceA;
    @Autowired ServiceB serviceB;
    @Autowired User user;

    public void doUserSpecificThings() {
        // consume serviceA, serviceB and user here
    }
}

@Service class ServiceA {}
@Service class ServiceB {}

@Service
class Facade {
    public void doThingsForUser(Long userId) {
        User user = userService.getById(userId);
        UserSpecificService userSpecificService = ...; // !!!
        userSpecificService.doUserSpecificThings();
    } 
} 
```

问题是关于标有 的行`// !!!`。有什么方法可以`UserSpecificService` *在不*实现我自己的工厂的情况下构建，它知道`ServiceA`and`ServiceB`并且只需要一个实例`User`来实例化 a `UserSpecificService`？

如果这很重要 - 我将使用`Facade`Spring MVC，尽管我不希望它依赖于此。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:00:20.300

这里有一个建议：

*   使所有有资格成为的服务`userSpecificService`（我猜这些是ServiceA和serviceB）都有一个通用接口
*   让该接口有两种方法 -`doUserSpecificThing()`和`isEligibleFor(user)`
*   利用`@Autowired List<YourInterface> list`
*   在您的`doThingsForUser()`方法中迭代给定接口的所有实例的列表，并为每个实例检查它是否符合给定用户的条件。如果是 - 调用该方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:04:25.170

如果您询问是否可以动态创建 UserSpecificService 而无需手动设置服务，请尝试以下操作：

```
@Configurable
class UserSpecificService {
    @Autowired private ServiceA serviceA;
    @Autowired private ServiceB serviceB;
    private User user;

    public UserSpecificService(User user){
        this.user = user;
    }

    public void doUserSpecificThings() {
        // consume serviceA, serviceB and user here
    }
}

@Service class ServiceA {}
@Service class ServiceB {}

@Service
class Facade {
    public void doThingsForUser(Long userId) {
        User user = userService.getById(userId);
        UserSpecificService userSpecificService = new UserSpecificService(user);
        userSpecificService.doUserSpecificThings();
    } 
} 
```

请注意，您需要配置 spring 上下文以扫描 @Configurable。为此，您所要做的就是添加`<context:spring-configured/>`到您的应用程序上下文文件中。另一种方法是：

```
@Service
class UserSpecificService {
    @Autowired private ServiceA serviceA;
    @Autowired private ServiceB serviceB;

    public void doUserSpecificThings(User user) {
        // consume serviceA, serviceB and user here
    }
}

@Service class ServiceA {}
@Service class ServiceB {}

@Service
class Facade {
    public void doThingsForUser(Long userId) {
        User user = userService.getById(userId);
        userSpecificService.doUserSpecificThings(user);
    } 
} 
```

根据您的具体应用，这种方法可能会更好。

# c# - 将字符串转换为十六进制字符串的 C# 惯用方法是什么？

> ID：10438412
> 
> 赞同：2
> 
> 时间：2012-05-03T19:53:36.620
> 
> 标签：c#, vb.net

我有一串字符，但我想要一串十六进制字符，其中十六进制字符通过将原始字符转换为整数然后将这些整数转换为十六进制字符来转换。我怎么做？

这就是我在VB中的做法：

```
for i = 1 to len(str)
    hex_str = hex_str + lcase(cstr(hex(asc(mid(str, i, 1))))) 
next 
```

现在，在 C# 中最惯用的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:00:24.033

在 C# 中，我能想到的最简单的方法是：

```
var hexStr = str.ToCharArray()
                .Aggregate("", (current, c)
                               => current + Convert.ToInt32(c).ToString("X")); 
```

第一行将字符串转换为类型的字符数组`char[]`，第二行和第三行将每个字符转换为整数`Int32`，然后转换为十六进制字符类型`String`。该十六进制字符通过[聚合函数](http://en.wikipedia.org/wiki/Aggregate_function)添加到`hexStr`of 类型中。`String`

以下是上述表达式中使用的函数：

*   [String.ToCharArary](http://msdn.microsoft.com/en-us/library/ezftk57x.aspx)

*   [可枚举](http://msdn.microsoft.com/en-us/library/bb548651.aspx)。聚合；来自 System.LINQ，因此您可能需要添加`using System.LINQ;`

*   [转换.ToInt32](http://msdn.microsoft.com/en-us/library/sf1aw27b.aspx)

*   [Int32.ToString(String format)](http://msdn.microsoft.com/en-us/library/8wch342y.aspx)，传递`"X"`使结果为十六进制而不是十进制。

对于聚合，我使用了[lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)( `parameters => return value`)。这是一个接受`current`和`c`做的功能`return current + Convert.ToInt32(c).ToString("X");`

如果有不清楚的地方，请随时在下面的评论中提问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:56:32.290

我不是 VB.NET 开发人员，但有一个转换器，我有这个：

```
for (i = 1; (i <= str.Length); i++) {
     hex_str = (hex_str + hex(asc(str.Substring((i - 1), 1))).ToString().ToLower());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T19:59:02.397

尝试这个：

```
 for (var i = 1; i <= str.Length; i++)
    {
        hex_str = hex_str + Convert.ToString(Convert.ToString(Convert.ToInt32(str[i - 1]), 16).ToUpper()).ToLower();
    } 
```

# mysql - MySQL加入查询非常慢，解释没有帮助

> ID：10438414
> 
> 赞同：0
> 
> 时间：2012-05-03T19:53:58.073
> 
> 标签：mysql, join

**询问**

```
explain select item_name, rating
from loyalty_visit_items
join loyalty_visits
on loyalty_visits.id = loyalty_visit_items.loyalty_visit_id
where loyalty_visits.parent_venue_id = 3794 
```

**结果**

```
1   SIMPLE  loyalty_visits       ref  PRIMARY,parent_venue_id  parent_venue_id   4  const                      14388    
1   SIMPLE  loyalty_visit_items  ref  loyalty_visit_id         loyalty_visit_id  5  loyalty.loyalty_visits.id  12     Using where 
```

索引似乎使用得当，但此查询通常不会在超时之前返回。这个数据库中的数据相对于它需要扩展处理的数据非常少，所以我想知道发生了什么。我只想要这个项目并显示父访问表中的一列以及每个项目行。有没有更好的方法来完成我完全错过的加入？

```
**CREATE SHOW TABLE**
CREATE TABLE `loyalty_visits` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `loyalty_member_id` int(11) DEFAULT NULL,
  `venue_id` int(11) DEFAULT NULL,
  `parent_venue_id` int(11) NOT NULL DEFAULT '0',
  `visit_date` datetime DEFAULT NULL,
  `check_number` double(11,0) DEFAULT NULL,
  `code` varchar(16) DEFAULT NULL,
  `spend` decimal(12,2) DEFAULT NULL,
  `discount` decimal(11,0) DEFAULT NULL,
  `cover_count` int(11) DEFAULT NULL,
  `created_at` datetime DEFAULT NULL,
  `updated_at` datetime DEFAULT NULL,
  `sms_from_number` varchar(55) DEFAULT NULL,
  `rating` int(2) DEFAULT NULL,
  `server_id` int(11) DEFAULT NULL,
  `server_name` varchar(255) DEFAULT NULL,
  `terminal_id` int(11) DEFAULT NULL,
  `initial_text_sent` tinyint(1) DEFAULT NULL,
  `error` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `visit_date` (`visit_date`),
  KEY `parent_venue_id` (`parent_venue_id`),
  KEY `idx2` (`code`) USING HASH,
  KEY `venue_id_2` (`venue_id`),
  KEY `rating` (`rating`),
  KEY `idx3` (`loyalty_member_id`) USING HASH,
  KEY `spend` (`spend`),
  KEY `id` (`id`,`parent_venue_id`)
) ENGINE=Xeround DEFAULT CHARSET=latin1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:14:26.503

我不确定索引是否被用于最大效果。连接类型`ref`并不是那么好。`eq_ref`并且`const`好多了。

您可以在`rows`列中看到 MySQL 期望从中读取大量行`loyalty_visits`。但由于它不是按主键查找行，它不能使用聚集索引。这意味着 MySQL 可能必须执行许多磁盘读取，因此索引几乎没有帮助。

如何优化——你能减少需要读取的行数吗？可以使用聚集索引吗？你可以使用覆盖索引吗？

# asp.net - 将 MembershipProvider 与温莎城堡一起使用

> ID：10438419
> 
> 赞同：0
> 
> 时间：2012-05-03T19:54:23.897
> 
> 标签：asp.net, asp.net-mvc-3, castle-windsor, membership-provider

我正在使用一个类来实现 Windsor Container MembershipProvider。我可以解决实现，但它不会调用从 web.config 中提取值的 Initialize 方法。如何实例化它并确保它调用 Initialize 方法？

添加到容器的代码

```
container.Register(Component.For<FNHMembershipProvider>()
    .LifeStyle.Transient
    .Named("myMembershipProvider"));

container.Register(Component.For<FNHRoleProvider>()
    .LifeStyle.Transient
    .Named("myRoleProvider")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:03:57.937

这里的一个关键点是您不是在注入 Membership 类，而是在注入 Membership PROVIDER。Membership 类是根据您的注册表项来初始化成员资格提供程序，并调用 intialize。Membership 类是一个静态类，您不能注入它（尽管您可以注入一个返回静态 Membership 类的包装类，但我看不到那里有很多好处）。

总的来说，我发现尝试让会员使用 DI 比它的价值更痛苦。

# google-bigquery - 谷歌 BigQuery API

> ID：10438421
> 
> 赞同：0
> 
> 时间：2012-05-03T19:54:31.587
> 
> 标签：google-bigquery

我只是在使用 BigQuery API 创建表的示例中遇到了一些问题： [https ://developers.google.com/bigquery/docs/developers_guide#creatingatable](https://developers.google.com/bigquery/docs/developers_guide#creatingatable)

之前的一切工作正常，但在这里我总是收到一个解析异常......在请求中发送的正文下方（我实际上将示例修改为教程中下一个示例的数据和架构，但与原始示例有相同的问题schema + 自生成数据集）和错误响应。

当我使用网络界面和相同的模式上传相同的数据集时，它就像一个魅力......

感谢您提供任何有用的线索！

约尔格

* * *

```
    --xxx
    内容类型：应用程序/json；字符集=UTF-8

    {
       “配置”： {
         “加载”： {
         “模式”：{
         “领域”：[
                    {
                    “名称”：“名称”，
                    “类型”：“字符串”，
                   “模式”：“需要”，
                    },
                    {
                    “姓名年龄”，
                    “类型”：“整数”，
                    “模式”：“需要”，
                    },
                    {
                    “名称”：“重量”，
                    “类型”：“浮动”，
                    “模式”：“需要”，
                    },
                    {
                    "name": "IsMagic",
                    “类型”：“布尔”，
                    “模式”：“需要”，
                    }
                    ]
         },
          “目的地表”：{
            "projectId": "536201353583",
            "datasetId": "基准测试",
            “tableId”：“syntest2”
          }
    “writeDisposition”：“WRITE_APPEND”}
      }
    }
    --xxx
    内容类型：应用程序/八位字节流

    《流星》，15325.5，真
    “魔术松饼”，12,411.5，真
    “火焰”，16,312.2，假
    "老红",22,388.2,false
    --xxx--

```

* * *

```
    {'status': '400', 'content-length': '171', 'expires': 'Fri, 01 Jan 1990 00:00:00 GMT', 'server': 'HTTP Upload Server Built on Apr 30 2012 12:11:36 (1335813096)', 'pragma': 'no-cache', 'cache-control': 'no-cache, no-store, must-revalidate', 'date': 'Thu, 03 May 2012格林威治标准时间 19:40:00”，“内容类型”：“应用程序/json”}

    {
     “错误”： {
      “错误”：[
       {
        “域”：“全球”，
        “原因”：“解析错误”，
        “消息”：“解析错误”
       }
      ],
      “代码”：400，
      “消息”：“解析错误”
     }
    }

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T16:38:23.990

您看到的解析错误是指您的 JSON 请求，而不是 CSV 数据。

除了 Jordan 指出的解析错误（destinationTable 后缺少逗号）之外，定义表模式的对象中还有尾随逗号，这是无效的 JSON。尝试删除它们，看看是否有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T21:11:40.937

看起来您在 destinationTable 的末尾大括号和 writeDisposition 说明符之间缺少逗号。

# vba - 在 excel vba 中找不到对象

> ID：10438427
> 
> 赞同：0
> 
> 时间：2012-05-03T19:54:55.060
> 
> 标签：vba, excel

我对下面的代码有几个问题。我正在将图表从一个文件复制并粘贴到另一个文件，然后关闭图表所在的文件。当我在调试器中逐步执行代码时，一切正常，但是当我使用工作表上的按钮触发该过程时，它给了我一个错误：找不到对象。

即使我正在使用`Application.ScreenUpdating = False`.

任何人都可以帮忙吗？任何帮助将不胜感激！！！

谢谢

```
Application.ScreenUpdating = False

Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Application.DisplayFullScreen = True
ActiveSheet.ChartObjects("ChartImage").Activate
ActiveSheet.ChartObjects("ChartImage").Delete

ChDir _
    "C:\...FILES"
Workbooks.Open Filename:= _
    "C:\...BLACK.xls"
Sheets("RYG CHARTS").Visible = True
Sheets("RYG CHARTS").Activate
ActiveSheet.Unprotect Password:="052100F"
ActiveSheet.ChartObjects("Chart 5").Activate
ActiveChart.ChartArea.Select
ActiveChart.ChartArea.Copy
ActiveWindow.Visible = False
Windows("Overhead Display.xls").Activate
ActiveSheet.Paste
'Rename chart to delete later
ActiveChart.Parent.Name = "ChartImage"
ActiveSheet.ChartObjects("ChartImage").Activate
ActiveSheet.Shapes("ChartImage").Top = 100
ActiveSheet.Shapes("ChartImage").Width = 700
ActiveSheet.Shapes("ChartImage").Height = 375
ActiveSheet.Shapes("ChartImage").Left = 20

'ActiveWindow.Visible = False
Windows("Overhead Display.xls").Activate
Range("A1").Select
With ActiveWindow
    .DisplayGridlines = False
    .DisplayHeadings = False
    .DisplayHorizontalScrollBar = False
    .DisplayVerticalScrollBar = False
    .DisplayWorkbookTabs = False
End With

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Sheets("FILE SETUP").Activate
ActiveSheet.Unprotect Password:="052100AF"
Range("J2").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("K2").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("J3").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("J3").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("D2").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("L4").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("D3").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("N3").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("H13").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("U11").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("F13").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("U13").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Range("G13").Select
Selection.Copy
Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("U15").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Application.CutCopyMode = False

Windows("BMW F25 OUTERBELT BLACK.xls").Activate
Sheets("RAW DATA LIST").Activate
ActiveSheet.Range("A2") = ""
Windows("BMW F25 OUTERBELT BLACK.xls").Activate

ActiveWorkbook.Close SaveChanges:=False

Windows("Overhead Display.xls").Activate
Sheets("CHART DISPLAY - FINISH").Activate
Range("A1").Select

Application.ScreenUpdating = True 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:15:14.773

选择是导致闪烁的命令之一

代替

```
Range("G13").Select
Selection.Copy 
```

采用

```
Range("G13").Copy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:24:14.473

**未经测试**

试试这个并告诉我你是否有任何错误？

```
Option Explicit

Sub Sample()
    Dim wbThis As Workbook, WbOther As Workbook
    Dim wsThis As Worksheet

    Application.ScreenUpdating = False

    Set wbThis = ThisWorkbook
    Set wsThis = wbThis.Sheets("CHART DISPLAY - FINISH")

    wsThis.ChartObjects("ChartImage").Delete

    '~~> Change the path as required
    Set WbOther = Workbooks.Open(Filename:="C:\...BLACK.xls")

    With WbOther.Sheets("RYG CHARTS")
        .Visible = True
        .Unprotect Password:="052100F"
        .ChartObjects("Chart 5").ChartArea.Copy
        wsThis.Activate
        ActiveSheet.Paste
    End With

    wbThis.Activate
    'Rename chart to delete later
    ActiveChart.Parent.Name = "ChartImage"
    ActiveSheet.ChartObjects("ChartImage").Activate
    ActiveSheet.Shapes("ChartImage").Top = 100
    ActiveSheet.Shapes("ChartImage").Width = 700
    ActiveSheet.Shapes("ChartImage").Height = 375
    ActiveSheet.Shapes("ChartImage").Left = 20

    With ActiveWindow
        .DisplayGridlines = False
        .DisplayHeadings = False
        .DisplayHorizontalScrollBar = False
        .DisplayVerticalScrollBar = False
        .DisplayWorkbookTabs = False
    End With

    With WbOther
        With .Sheets("FILE SETUP")
            '.Unprotect Password:="052100AF"
            wbThis.Range("K2").Value = .Range("J2").Value
            wbThis.Range("J3").Value = .Range("J3").Value
            wbThis.Range("L4").Value = .Range("D2").Value
            wbThis.Range("N3").Value = .Range("D3").Value
            wbThis.Range("U11").Value = .Range("H13").Value
            wbThis.Range("U13").Value = .Range("F13").Value
            wbThis.Range("U15").Value = .Range("G13").Value
        End With

        .Close SaveChanges:=False
    End With

    Application.ScreenUpdating = True
End Sub 
```

# java - 在没有客户端调用的 Web 服务中，我可以发送文件并执行一些操作吗？

> ID：10438428
> 
> 赞同：0
> 
> 时间：2012-05-03T19:55:02.240
> 
> 标签：java, web-services, compilation, soa

在我的应用程序中，我想将某种编程语言的源文件从客户端发送到 SOA WS，之后，WS 将检查另一个连接的客户端，如果客户端已连接并具有适当的编译器，我的 java 客户端应用程序将编译上传从 WS 文件，并重新发送回 WS，之后，WS 会将结果重新发送给请求的客户端，如何将文件从 WS 发送到客户端，无需客户端调用，并调用客户端方法？是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T23:16:46.830

是的，这是可能的，但是请求的客户端必须注册到监听服务，然后接收请求。

换句话说，您需要在每个客户端上创建一个服务来注册自己并配置一个端点 Web 服务来接收您的请求。

您可以查看的一些模式是发布/订阅和工厂模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:04:30.527

不，您不能只在服务器端拥有一个 Web 服务，将数据推送到不存在的客户端。Web 服务只是拉取的。

但是，如果可能的话，您可以让您的代码“在客户端”调用 Web 服务，否则您只需要等待他们给您打电话。

# .net - 生成应用程序清单错误

> ID：10438431
> 
> 赞同：9
> 
> 时间：2012-05-03T19:55:24.643
> 
> 标签：.net, visual-studio-2010, build-error

我和我的团队经常出现这个错误，但是是随机的，我们不确定它为什么会这样。为了解决这个问题，我们要么构建解决方案几次，要么必须重新启动 Visual Studio (10)。这是我尝试构建时遇到的错误：

```
错误 5 “GenerateApplicationManifest”任务意外失败。
System.Runtime.InteropServices.COMException (0x8731F2​​30)：来自 HRESULT 的异常：0x8731F2​​30
 在 System.Runtime.InteropServices.UCOMITypeInfo.ReleaseTypeAttr(IntPtr pTypeAttr)
 在 Microsoft.Build.Tasks.Deployment.ManifestUtilities.ComImporter..ctor（字符串路径，OutputMessageCollection outputMessages，字符串 outputDisplayName）
 在 Microsoft.Build.Tasks.Deployment.ManifestUtilities.FileReference.ImportComComponent（字符串路径，OutputMessageCollection outputMessages，字符串 outputDisplayName）
 在 Microsoft.Build.Tasks.GenerateApplicationManifest.AddIsolatedComReferences（ApplicationManifest 清单）
 在 Microsoft.Build.Tasks.GenerateApplicationManifest.BuildApplicationManifest（ApplicationManifest 清单）
 在 Microsoft.Build.Tasks.GenerateApplicationManifest.OnManifestLoaded（清单清单）
 在 Microsoft.Build.Tasks.GenerateManifestBase.BuildManifest()
 在 Microsoft.Build.Tasks.GenerateManifestBase.Execute()
 在 Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()
 在 Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask（ITaskExecutionHost taskExecutionHost、TaskLoggingContext taskLoggingContext、TaskHost taskHost、ItemBucket 存储桶、TaskExecutionMode howToExecuteTask、Boolean& taskResult）

```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:40:23.247

I had run into a similar issue and found that it was because one of my assembly's path was too long. I don't really understand why in some cases it may work for you, and in others it doesn't though, so it may be something else, but never hurts to check it out.

I believe the maximum length is 260 characters.

# html - 为什么我看到条纹 在移动浏览器上旋转？

> ID：10438433
> 
> 赞同：10
> 
> 时间：2012-05-03T19:55:27.957
> 
> 标签：html, rotation, html5-canvas, mobile-website, cairo

我正在旋转 2d 画布，它在桌面上运行良好，但在移动空间中存在一个小问题。这是放大的屏幕截图：

![在此处输入图像描述](../Images/2220c07712be25c590a3747ad620f38d.png)

拇指图像在 500 毫秒的过程中旋转了大约 0.2rad。我认为所有相关代码都在下面内联。如您所见，图像的每个顶角都留下了某种“轨迹”。

```
var duration = 500;
var start = 0;
var stop = 0.287554326;
var step = (stop - start) / 10;
var steps = (stop - start) / step;
var current = 0;
var delay = duration / steps;
var first = true;
if (navigator.userAgent.match(/iP(hone|[ao]d)|android/i)) step *= 1.5;
var rotate_int = setInterval(function() {
  if (current >= stop) {
    clearInterval(rotate_int);
    callback && callback();
    return;
  }
  ctx.clearRect(0, 0, cvs.width, cvs.height);
  ctx.translate(cvs.width / 2, cvs.height / 2);
  ctx.rotate(step);
  current += step;
  ctx.translate(cvs.width / -2, cvs.height / -2);
  ctx.drawImage(i, 0, 0);
  if (first) {
    first = false;
    thumb.hide();
  }
}, delay); 
```

笔记：

1.  该代码在桌面上运行良好（Firefox、Chrome、Safari、Opera 甚至 IE 的最新版本）
2.  我测试了以下设备和浏览器：
    1.  iPhone 3GS：Safari、Opera Mini
    2.  iPhone 4S：Safari
    3.  iPad（第一代）：Safari
    4.  Android Galaxy S（带姜饼）：默认浏览器，Firefox 手机
    5.  摩托罗拉 Droid X（带姜饼）：默认浏览器，Firefox 手机
3.  我还没有找到`<canvas>`表现出这种行为的桌面浏览器（支持）
4.  我还没有找到**没有**表现出这种行为的移动设备
5.  发布的图像是来自 iPad 的放大屏幕截图
6.  如果重要的话，`<canvas>`（旋转时）正在被动画（通过 jQuery）穿过它后面的图像并停止，这在屏幕截图中可见。
7.  页面上还有第二个`<canvas>`。它使用相同的竖起大拇指 .png，并使用上面发布的相同代码进行旋转，并且还具有动画以穿过不同的背景图像（但方向相反，即一个“竖起大拇指”向西北移动，一个向东南移动)，并且轨迹也出现在相对于画布上下文的相同位置。

我已经把我能想到的所有泥巴都扔到了墙上，希望有什么能导致诊断。有没有其他人见过这样的事情？我可以尝试什么不同的方法？我是否错过了 HTML5 教程网站上某个警告此类行为的大红色警告标签？

**==编辑 1==**

根据@GGG 的评论，我删除了 UA 嗅探（旨在减少画布重绘的数量和频率，因为如果我使用与桌面相同的设置，移动浏览器都会突突突突）但这只会导致轨迹变得更加明显（例如更厚）。然后，我通过重新放入 UA 嗅探器进行实验，但我并没有将循环减少 50%，而是实际上将它们*增加*了 500%。同样，这导致痕迹变得更加明显。然而，这种加厚似乎是渐近的——换句话说，通过调整动画速度的参数，我可以使轨迹变粗是有限度的。

**==编辑 2==**

根据@GGG 的*其他*评论，我去编辑图像以添加一些透明数据，以尝试找到合适的解决方法。我看到的是图像突出在画布的顶部和左侧边缘（这是“ *Photoshop*画布的”，而不是“HTML5 的`<canvas>`”）。当我在顶部和左侧添加相等的透明数据填充时，条纹问题消失了。这是原始 PSD（预先添加额外间距）：

![在此处输入图像描述](../Images/ca6fb7824d00fadc825e82c4035c3e89.png)

所以我的问题就变成了：即使图像（用不透明的像素）填充了它的整个 [Photoshop] 画布，为什么我的画布上下文不`clearRect()`表现自己？这不应该抹去画布范围内的任何东西吗？如果是这样，为什么会留下这几个像素？

**==编辑 3==**

经过一番研究，事实证明[Cairo](http://en.wikipedia.org/wiki/Cairo_%28graphics%29#Notable_usage)被几个主要的渲染引擎（至少 WebKit 和 Gecko）相当普遍地使用。正如@JonasWielicki 首次建议的那样，Cairo 库——当针对移动执行进行优化时——可能是不是有点过分热心？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-08T21:00:42.187

根据评论，尝试在图像边缘周围添加一些透明像素作为解决方法。

我真的不知道为什么会这样。我*认为*这与移动设备上对 alpha 通道的奇怪处理有关，但这只是猜测。

我注意到移动浏览器在滚动时似乎放弃或“估计”了 alpha 通道（慢慢地上下滚动，甚至字体看起来更“脆”）。我想知道他们是否分两个阶段渲染事物，将 alpha 通道留给第二阶段，如果有另一个“帧”要在当前“帧”之后立即渲染，则跳过第二阶段，如果这有意义的话。也许这会以某种方式混淆渲染器，使其认为它没有在它拥有的地方绘制东西。

无论如何，这可能确实需要一个错误报告。如果不出意外，我很想听到关于发生了什么的真正解释。

# xaml - 将位图图像添加到列表框时出错

> ID：10438438
> 
> 赞同：0
> 
> 时间：2012-05-03T19:55:41.610
> 
> 标签：xaml, listbox, bind, bitmapimage

因此，我几乎整个工作日都在努力将 BitmapImages 添加到 ListBox 中。这是我的代码：

```
public class SomeClassViewModel : ViewModelBase
{
    public SomeClassViewModel(EnhanceImage image)
    {
       LoadImages();
    }

    public List<BitmapImage> ListOfImages { get; set; }

    public void LoadImages()
    {
        ListOfImages = new List<BitmapImage>();
        DirectoryInfo imageDir = new DirectoryInfo(@"..\..\Images");
        foreach (FileInfo imageFile in imageDir.GetFiles("*.jpg"))
        {
            Uri uri = new Uri(imageFile.FullName);
            ListOfImages.Add(new BitmapImage(uri));
        }
    }
} 
```

如您所见，我将“Images”文件夹中具有文件扩展名“.jpg”的所有图像添加到名为 ListOfImages 的 BitmapImages 列表中。然后，我将它绑定到 XAML 中的 ListBox，如下所示：

```
<ListBox ItemsSource="{Binding ListOfImages}"/> 
```

问题是当我运行它时，我得到这个错误：“调用线程无法访问这个对象，因为另一个线程拥有它”。现在我通过查看这个 StackOverflow 线程知道我必须做什么：[调用线程无法访问这个对象，因为不同的线程拥有它。如何编辑图像？](https://stackoverflow.com/questions/5961179/the-calling-thread-cannot-access-this-object-because-a-different-thread-owns-it)，但我就是跟不上。有人可以告诉我如何使用这个 Dispatcher.Invoke 吗？

编辑：现在我只是想让图像的 URI 显示在列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T13:22:25.640

我想通了，并认为我会发布我的答案。

这是我在 foreach 循环中所做的：

```
Uri uri = new Uri(imageFile.Fullname);
BitmapImage tmpImage = new BitmapImage(uri)
tmpImage.Freeze();
Action action = delegate { ListOfImages.Add(tmpImage); };
Dispatcher dispatcher = Dispatcher.CurrentDispatcher;
dispatcher.Invoke(action); 
```

如您所见，我所做的是冻结 BitmapImage，然后将添加 BitmapImage 的操作委托给 ListOfImages。然后最后我调用了这个动作。

# android - 如何使用具有特定参数值的意图过滤器捕获 URL

> ID：10438439
> 
> 赞同：4
> 
> 时间：2012-05-03T19:55:53.297
> 
> 标签：android

我正在尝试使用意图过滤器以以下格式拦截 QR 码上的 URL： [https](https://qx.process.com?f=anyValue) ://qx.process.com?f=anyValue 也就是说，如果指定的 URL 为 'f=，我只想拦截它' 指定的参数。我已经尝试过了，但它不起作用：

```
<intent-filter>
<action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE"></category>
    <data android:scheme="https"  android:host="qx.process.com" 
               android:pathPrefix="\\?f=*">
    </data>
</intent-filter> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:35:12.067

路径只涉及路径，而不是像您的查询字符串`?XXXX`

# c - 如何将 execvp() 与 grep 一起使用？

> ID：10438445
> 
> 赞同：2
> 
> 时间：2012-05-03T19:56:17.890
> 
> 标签：c, grep, exec, execvp

我正在尝试 exec() 在我的 C 程序中调用 grep 。我正在寻找给定文件中字符串模式的出现次数，这可以通过以下方式实现：

```
$ grep -e my_string -F my_file.txt -c 
```

这给出了预期的数字输出，例如：

```
5 
```

但是，我希望等效的似乎有一些困难。以下代码：

```
char *arg_list[] = {"-e", "my_string", "-F", "my_file.txt", "-c", "\0"};

int pid;
if ((pid = fork()) == 0) {
    if (execvp("grep", arg_list) < 0)
        perror("execvp");
} 
```

结果是：

```
 my_file.txt:5
 -e: : No such file or directory 
```

有两个问题。首先，我只想要数字——而不是找到它的文件。其次，我不确定为什么它试图断言 -e 标志需要是一个文件。如果我将参数列表切换为：

```
char *arg_list[] = {"-F", "my_file.txt", "-e", "my_string", "-c", "\0"}; 
```

然后我回来：

```
my_file.txt:5
-F: : No such file or directory 
```

我不确定从哪里开始寻找为什么会发生这种情况。我也不确定为什么命令行的 grep 调用的输出只是一个数字，但 exec() 的 grep 调用会输出文件名和数字。

任何帮助，将不胜感激！谢谢你。

编辑：

解决方案：在参数列表中包含程序名称，或者简单地使用 system() 调用。还有，RTFM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:13:25.010

您有两个问题（在此处插入关于正则表达式的 JWZ 引用）：

1.  传递的数组中的第一个参数`exec`被传递`argv[0]`给新的可执行文件。通常，这是可执行文件的名称，程序使用它来确定自己的名称。所以你告诉 grep 它的名字是`-e`，它的参数是`my_string -F my_file.txt -c ""`。它没有`-e`像您期望的那样得到论点，因此它误解了它的论点并给您一个错误。

2.  您没有正确地将参数数组以 NULL 结尾`exec`。最后一个参数必须是文字`NULL`，而不是字符串`"\0"`。该字符串是一个空字符串，但它不是空指针。

# jquery - jQuery UI Combobox Widget 不能与 click() 事件一起使用？

> ID：10438447
> 
> 赞同：0
> 
> 时间：2012-05-03T19:56:25.720
> 
> 标签：jquery, jquery-ui

当我编写一个 click() 事件时，为什么输入字段（由 jquery ui 组合框小部件创建）在选择器的范围内，该事件永远不会触发？

我有一个具有验证的表单，当最终用户没有正确填写它时，它使用 css 类“reqFieldGroupEmpty”突出显示该表单字段的整个父 <div>。

当用户在错过的必填字段内单击时，我有一个 click() 事件删除该表单字段的父类

```
$('input, textarea, select').click(function () { $('div').removeClass('reqFieldGroupEmpty') }); 
```

但是，正如我在开始时提到的，组合框创建的不会触发 click()，因此不会删除类。

我错过了什么？

谢谢你的帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T00:06:46.037

尝试绑定到 focus() 事件而不是单击...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T20:11:32.177

JakeCigar 通过 jQuery 论坛回答的帖子：http: [//forum.jquery.com/topic/jquery-ui-combobox-widget-not-working-with-click-event#14737000003343231](http://forum.jquery.com/topic/jquery-ui-combobox-widget-not-working-with-click-event#14737000003343231)

> click 仅查找设置时存在的元素。使用 .on() 的延迟形式 – jQuery API

```
$('body').on('click’, 'input, textarea, select' , function () { $('div').removeClass('reqFieldGroupEmpty') }); 
```

> JΛ̊KE"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T14:16:02.223

我想我可以重现 wizzy 看到的内容。此代码在 a 中运行良好`$(function(){...});`：

```
$('<button>', {text: 'Go'}).appendTo($('body')).on('click', function() {
    console.log('clicked');
}); 
```

但是在小部件内，单击的内容永远不会被记录。例子：

```
_init: function() {
    $('<button>', {text: 'Go'}).appendTo(this.element).on('click', function() {
        console.log('clicked');
    });
} 
```

该按钮已附加，但似乎没有触发单击事件。

[http://jsfiddle.net/cawoodm/cww3c/](http://jsfiddle.net/cawoodm/cww3c/)

# java - 有没有办法将 java 数据类型输出到控制台？

> ID：10438448
> 
> 赞同：51
> 
> 时间：2012-05-03T19:56:30.390
> 
> 标签：java, types, casting

我正在尝试调试我继承的程序。这个程序包含字符串、数组列表和集合、类型之间的大量转换，我需要做一些字符串操作（`substring`等）

打印到控制台时，数据*看起来*`Johnson, John`像字符串（例如，它是一行文本，如or `Chicago Region`），但我的代码因各种`index out of range`错误而出错，这表明我要转换为 String 的代码不起作用。

我想弄清楚正在输入什么数据类型，并让我的方法来验证程序是否按预期运行。有没有办法在 Java 中找到字段类型？在一个完美的世界里，我可以在每一步都生成控制台输出，这会给我数据值，无论它是字符串、数组列表还是集合。可以这样做吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-05-03T20:11:04.227

给定任何对象的实例，您可以调用它的 getClass() 方法来获取描述对象类型的 Class 对象的实例。

使用 Class 对象，您可以轻松打印它的类型名称：

```
Integer number=Integer.valueOf(15);
System.out.println(number.getClass().getName()); 
```

此打印用于控制台类的完全限定名称，例如：

```
java.lang.Integer 
```

如果您想要更简洁的输出，可以使用：

```
Integer number=Integer.valueOf(15);
System.out.println(number.getClass().getSimpleName()); 
```

getSimpleName() 只给你类的名称：

```
Integer 
```

打印原始变量的类型有点复杂：有关详细信息，请参阅[此 SO question](https://stackoverflow.com/questions/180097/dynamically-find-the-class-that-represents-a-primitive-java-type)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-03T19:59:19.517

对于任何对象`x`，您都可以打印`x.getClass()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T20:03:25.197

`instance.getClass()`如果您只想打印类型，这是要走的路。`instanceof`如果要根据类型分支行为，也可以使用，例如

```
if ( x instanceof String )
{
   // handle string
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-03T20:03:53.953

使用`getClass()`方法。

```
Object o;
System.out.println(o.getClass()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-03T20:00:13.757

只需`.class.getName();`在任何对象中执行

# iphone - 保存玩家进度，以防篡改

> ID：10438450
> 
> 赞同：0
> 
> 时间：2012-05-03T19:56:43.447
> 
> 标签：iphone

如何在 iPhone sdk 中保存文件并使其防黑客（例如玩家通过的级别）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:57:01.647

您可以尝试加密文件的内容。

它不会是 100% 的黑客证明，但由于在代码上定位加密密钥等工作，它可能会使编辑变得更加困难。所以很多用户将无法做到。

否则，将进度存储在外部服务器（需要互联网连接）中，以便您控制该数据。但它可能不适合你的游戏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T08:08:08.470

对于没有 root 权限的 iPhone，只需将文件保存在本地即可使其具有[防](http://xkcd.com/538/)黑客功能。如果出于某种原因您担心黑客使用 root 手机，那么加密本地文件，或依赖远程存储（通过加密通信）会使其[更具](http://hyperboleandahalf.blogspot.com/2010/04/alot-is-better-than-you-at-everything.html)黑客攻击性。

# javascript - Javascript动态分组表

> ID：10438454
> 
> 赞同：1
> 
> 时间：2012-05-03T19:56:56.000
> 
> 标签：javascript, datatables

我一直在寻找带有 JavaScript 的客户端分组表。我想要的是允许用户通过将列标题拖到分组框中来动态分组数据的能力。可以拖动多个列，并且可以在其中更改一次顺序。这是一个 .NET 的商业产品，可以满足我的要求：

[http://demos.devexpress.com/RWA/WebmailClient/](http://demos.devexpress.com/RWA/WebmailClient/)

我正在使用 jQuery，所以基于 jQuery 的解决方案就可以了。我看到了数据表。它已经接近了一些附加组件。

有人知道非.NET 解决方案吗？我想您可以在所有客户端都执行此操作，从而使后端无关紧要。

如果我想从头开始实现它，我应该从哪里开始？DataTables 的插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T10:24:31.020

AngularJS 有一个 ui 项目，该项目的一部分[`ng-grid`](http://angular-ui.github.com/ng-grid/)（基于 jquery）可以满足您的需求。

这是一个[plunker 演示](http://plnkr.co/edit/Bo11ckeWFiMyJ4tyLVWC?p=preview)。

# javascript - 将 php 文件 (html w/php) 的内容附加到 div

> ID：10438457
> 
> 赞同：0
> 
> 时间：2012-05-03T19:57:08.340
> 
> 标签：javascript, jquery, ajax

如何将 php 文件（html 和 php 的混合）的内容附加到现有的 div 中？

我定义了这个 div，它加载了三个不同的 php 文件。但这非常慢，因为每个 php 都使用 http 检索许多项目。我想要第一个 php`<?php require("readenglish.php"); ?>`然后异步加载其他的。我尝试了 $.get() ，但没有加载 php 内容。

这是div。

```
<div id="readings">

    <?php require("readenglish.php"); ?>
    <!-- ?php require("readfrench.php"); ? --> <!-- EDITED OUT DON'T WANT THIS -->
    <!-- ?php require("readspanish.php"); ? --> <!--  -->

</div> 
```

这是加载 php 文件的脚本。

```
<!--  EDIT  WANT THIS INSTEAD OF WHAT IS COMMENTED OUT ABOVE -->
<script>
    $(document).ready(function(){    
    $.get("readfrench.php",function(data){
        $("#readings").append(data);
    },'html');

    $.get("readspanish.php",function(data){
        $("#readings").append(data);
    },'html');    
    });

</script> 
```

这是一个示例 php 文件。

```
<?php 

    $todayfeast = date("Ymd");

    $ctitlefe = 'http://feed.evangelizo.org/reader.php?date='.$todayfeast.'&type=reading_lt&lang=AM&content=FR';
    $creadfe = 'http://feed.evangelizo.org/reader.php?date='.$todayfeast.'&type=reading&lang=AM&content=FR';

    if ( $curl_exists ) {
        curl_setopt($ch, CURLOPT_URL, $ctitlefe);        
        $titlefe = curl_exec($ch);

        curl_setopt($ch, CURLOPT_URL, $creadfe);      
        $readfe = curl_exec($ch);
    }

?>
    <div id="readf" class="tabbertab">
        <h2>First Reading</h2>

        <div id='titlefe' class='rtitle'>
        <?php echo $titlefe; ?>
        </div>
        <div id='readfe' class='rtext'>
        <?php echo $readfe; ?>
        </div>

    </div> 
```

php 文件将检索到的内容加载到传递给 html 元素的变量中。这些元素必须附加到顶部显示的 div 中。

是否有不同的方式来调用 $.get()？有不同的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:04:04.500

您的 JScript 工作正常。我唯一想不通的是PHP代码。它是否使用您的代码输出正确的文档？这是我尝试过的代码。它正在工作。

`PHP`：

```
<?php 

    $todayfeast = date("Ymd");

    $ctitlefe = 'http://feed.evangelizo.org/reader.php?date='.$todayfeast.'&type=reading_lt&lang=AM&content=FR';
    $creadfe = 'http://feed.evangelizo.org/reader.php?date='.$todayfeast.'&type=reading&lang=AM&content=FR';

    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL,$ctitlefe);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    $titlefe= curl_exec($ch);
    curl_close($ch);

    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL,$creadfe);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    $readfe= curl_exec($ch);
    curl_close($ch);    

?>
    <div id="readf" class="tabbertab">
        <h2>First Reading</h2>

        <div id='titlefe' class='rtitle'>
        <?php echo $titlefe; ?>
        </div>
        <div id='readfe' class='rtext'>
        <?php echo $readfe; ?>
        </div>

    </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T22:24:28.877

该代码确实有效。好像tabber插件不能在jscript中添加它必须在页面上。如果它是在 javascript 中添加的，则不会绘制该元素。

# jpa - 使用 PersistentContext 注解

> ID：10438461
> 
> 赞同：0
> 
> 时间：2012-05-03T19:57:23.007
> 
> 标签：jpa, persistence

我在persistence.xml 中配置了持久单元'testDao'。并尝试像这样使用 PersitentUnit 和 PersistentContext 注释创建 EntityManagerFactory 和 EntityManager，

```
@PersistenceUnit(name = "testDao", unitName = "testDao")
private EntityManagerFactory emf = null;

@PersistenceContext(name = "testDao", unitName = "testDao")
protected EntityManager em; 
```

但是这两个对象并没有被创建。我在这里做错什么了吗。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T05:37:14.110

很难确定，因为没有太多的上下文，但很可能您正在尝试在非容器管理的类中使用注入。注入只能在容器管理的类中完成。

如果这是您面临的问题，您可以从这个问题中找到更多详细信息：[JBoss - 未启动用户事务](https://stackoverflow.com/questions/9188946/jboss-user-transaction-not-inited)

# jsf - 命令按钮后的 JSF 2.0 导航

> ID：10438462
> 
> 赞同：0
> 
> 时间：2012-05-03T19:57:29.677
> 
> 标签：jsf, navigation, web, web.xml, faces-config

您好，我正在使用 JSF 2.0 构建网站。

我正在尝试设置一个commandButton，以便在我按下它之后它会使用一个方法执行一些操作，然后根据该方法返回的内容导航到一个页面。

到目前为止，我一直只使用 JSF 2.0 动作导航，但从我读到的内容来看，不可能有两个动作，因此您必须使用 faces-config.xml 文件。

我已经尝试创建一个并制定导航规则，但我无法让它工作。认为在我的 web.xml 中声明它可能是一个问题。我试图保留原始参数值，但代码无法编译，因此被注释掉：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
<context-param>
    <!--
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Development</param-value>
    -->

    <param-name>javax.faces.CONFIG_FILES</param-name> 
  <param-value>/WEB-INF/faces-config.xml</param-value>

</context-param>
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
</servlet-mapping>
<session-config>
    <session-timeout>
        30
    </session-timeout>
</session-config>
<welcome-file-list>
    <welcome-file>faces/index.xhtml</welcome-file>
</welcome-file-list>
</web-app>

<param-name>javax.faces.PROJECT_STAGE</param-name>
<param-value>Development</param-value> 
```

我的 faces-config 文件如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
version="2.0">

   <navigation-rule> 
<from-view-id>/tabletsHome.xhtml</from-view-id> 
<navigation-case> 
  <from-outcome>product1</from-outcome> 
  <to-view-id>/inputForm.xhtml</to-view-id> 
</navigation-case> 
<navigation-case> 
  <from-outcome>product2</from-outcome> 
  <to-view-id>/inputForm.xhtml</to-view-id> 
</navigation-case> 
```

此外，在导航将您带到下一页后，还有一种方法可以根据用户单击的内容将信息传递到此页面。例如产品编号？

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:00:45.597

我不确定`web.xml`/`faces-config.xml`与此有何关系。至于您的上下文参数问题，只需创建另一个`<context-param>`. 但这不会解决你的问题。至于您的导航问题，您可以只使用一个返回不同结果的操作方法。

```
public String submit() {
    if (...) {
        return "view1";
    }
    else {
        return "view2";
    }
} 
```

# mysql - 如何使用 WHERE 子句将数据从一个表复制到另一个表？

> ID：10438464
> 
> 赞同：4
> 
> 时间：2012-05-03T19:57:34.467
> 
> 标签：mysql, sql

我有两张看起来像这样的桌子

`TABLE1`： `id` `value` `number`

`TABLE2`： `id` `name` `value` `rid`

我想将`value`TABLE2 中的数据复制到 TABLE1 中，其中 TABLE2.rid=TABLE1.id。我尝试了以下方法：

```
INSERT INTO TABLE1 (value) SELECT value FROM TABLE2 WHERE TABLE2.rid=TABLE1.id. 
```

但是我不能这样做，因为我没有加入 TABLE1 和 TABLE2 ——如果我尝试这样做，我会收到语法错误。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:14:44.107

您需要一个带有 JOIN 子句而不是 INSERT 语句的 UPDATE 语句，因为您已经在两个表中都有数据，并且您希望将其中一个列中的值从一个表复制到另一个表。

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!2/bd9fb/1)

*脚本*：

```
CREATE TABLE table1
(   id          INT NOT NULL 
    , value     INT NOT NULL
    , number    INT NOT NULL
);

CREATE TABLE table2
(       id      INT         NOT NULL
    ,   name    VARCHAR(30) NOT NULL
    ,   value   INT         NOT NULL
    ,   rid     INT         NOT NULL
);

INSERT INTO table1 (id, value, number) VALUES
  (1,  0, 111),
  (2,  0, 222),
  (3,  0, 333),
  (4, 10, 444);

INSERT INTO table2 (id, name, value, rid) VALUES
  (1, 'abc', 123, 1),
  (2, 'def', 345, 2),
  (3, 'efg', 456, 3),
  (4, 'ghi', 567, 4);

UPDATE      table1
INNER JOIN  table2
ON          table1.id       = table2.rid
SET         table1.value    = table2.value; 
```

*运行 UPDATE**之前**的数据*：

```
table1:
ID  VALUE NUMBER
--  ----- ------
1     0    111
2     0    222
3     0    333
4    10    444

table2:
ID  NAME  VALUE RID
--  ----  ----- ---
1   abc   123   1
2   def   345   2
3   efg   456   3
4   ghi   567   4 
```

*运行 UPDATE**后**的数据*：

```
table1:
ID  VALUE NUMBER
--  ----- ------
1    123    111
2    345    222
3    456    333
4    567    444

table2:
ID  NAME  VALUE RID
--  ----  ----- ---
1   abc   123   1
2   def   345   2
3   efg   456   3
4   ghi   567   4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:00:03.350

```
UPDATE table2 t2 
INNER JOIN table1 t1
    ON t2.rid=t1.id
SET t2.value = t1.value; 
```

# maven - 如何让 maven surefire 产生增量控制台输出？

> ID：10438472
> 
> 赞同：4
> 
> 时间：2012-05-03T19:58:04.950
> 
> 标签：maven, maven-surefire-plugin

我的 maven surefire 测试在自己运行实际测试时不会产生任何控制台输出，即控制台显示下面的输出，然后在测试期间旋转。测试完成后，控制台输出可用，但直到那时才可用。所以问题是，我怎样才能禁用这个缓冲？

```
[INFO] Using configured provider org.apache.maven.surefire.junitcore.JUnitCoreProvider

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Concurrency config is parallel='none', perCoreThreadCount=true, threadCount=2, useUnlimitedThreads=false 
```

这是我的 pom 的相关部分：

```
 <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <!-- version 2.12 has a bug in single-test -->
            <version>2.11</version>
            <dependencies>
                <dependency>
                    <groupId>org.apache.maven.surefire</groupId>
                    <artifactId>surefire-junit47</artifactId>
                    <version>2.11</version>
                </dependency>
            </dependencies>
        </plugin>
    </plugins> 
```

它在（咳咳）Windows 上运行，如果这很重要的话。

# java - 当 JMS Prod 存在于辅助 POJO 类中时，如何在事务中包含 JMS 生产者

> ID：10438475
> 
> 赞同：2
> 
> 时间：2012-05-03T19:58:10.790
> 
> 标签：java, exception, transactions, jms

简短的问题：有没有办法强制由无状态 EJB 调用的 POJO 存在于 EJB 的上下文中，以便事务和资源注入将在 POJO 中工作？

特别是在我想要做的事情的上下文中：如何在调用 POJO 发送消息之前将 POJO JMS Producer 包含在 EJB 的事务中，该事务在数据库中保留一些数据，这样如果消息不能由于异常被发送，数据库事务也会回滚吗？我想异步发送邮件。

这是幸福的道路（从无状态会话 bean 开始）：

*   将数据保存到数据库 // 这有效
*   从持久化的数据中提取选择数据并将其放置在自定义的“消息”类中（实际上是一个 dto）
*   调用 EmailQueueMessenger POJO 的 sendEmail 方法，将消息对象传递给它。
*   消息被发送到 MDB 以处理和发送电子邮件（不是问题的一部分，只是为了完整性）

下面的代码有效，如果我在上下文查找中强制出错，它就不会回滚调用类中的数据库“持久”。顺便说一句，我也无法让@Resource 注入工作。

```
//In the EJB
EmailQueueMessenger eqm = new EmailQueueMessenger();
eqm.sendEmail(messageObject);
// mailObject will be translated into an email message at the other end of the queue.  

/******************** POJO Below ************/  

public class EmailQueueMessenger implements Serializable {

    // Resource injection doesn't work... using 'lookup' below, which does work.
    //    @Resource(name = "jms/EmailerQueueConnectionFactory")
    //    private ConnectionFactory connectionFactory;
    //    @Resource(name = "jms/EmailerQueue")
    //    private Destination EmailerQueue;

        public EmailQueueMessenger() {
        }

        public void sendEmail(MailMessageDTO theMessage) {

            Context ctx = null;
            try {
                ctx = new InitialContext();
                ConnectionFactory connectionFactory = (ConnectionFactory) ctx.lookup("jms/EmailerQueueConnectionFactory");
                System.out.println("JMS Producer CTX Name In Namespace: " + ctx.getNameInNamespace());
                //Destination EmailerQueue = (Destination) ctx.lookup("jms/ERROR"); // forces exception
                Destination EmailerQueue = (Destination) ctx.lookup("jms/EmailerQueue");  // normal working code

                try {
                    Connection con = connectionFactory.createConnection();
                    Session session = con.createSession(false,
                            Session.AUTO_ACKNOWLEDGE);
                    MessageProducer msgProd = session.createProducer(EmailerQueue);

              ... 
```

我试过添加：

```
@TransactionAttribute(TransactionAttributeType.MANDATORY)
@Stateless 
```

到 POJO 定义，但它没有任何区别。

FWIW 我为 EmailQueueMessenger 使用了一个单独的类，因为应用程序的其他部分需要偶尔发送电子邮件，所以不想重复代码。

* * *

应该提到我做了一个测试，我将所有 JMS 东西移动到第一个 EJB 中并且它运行正确......但我需要它在一个单独的类中工作以供应用程序的其他部分使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:01:31.560

我认为你有两个问题：

1.  你需要让你的 pojo 成为一个 SLSB。它应该被注入到您的 jms 侦听器中，而不是直接调用，以便您处理代理引用。它仍然可以作为简单的 pojo 重用，因为如果未部署在容器中，注释将被忽略。

2.  您正在使用 AUTO_ACKNOWLEDGE 创建一个 jms 会话，但需要对其进行处理。此外，请确保 jms 连接来自事务性 JCA 源，因为这会将会话与事务相关联。

**========= 更新=========**

嘿比尔；

抱歉，由于某种原因，我认为外部 bean 是 JMS 侦听器......无论如何，问题是一样的。

如果您希望*EmailQueueMessenger*的行为符合您在其上放置的注释（事务性、注入等），则必须将其作为 EJB 引用，而不是简单的 pojo。因此，您的外部会话 bean 应如下所示：

```
@EJB   // key difference
private EmailQueueMessenger eqm;

@TransactionAttribute(TransactionAttributeType.REQUIRED)
public void sendMessage(Object messageObject) {
   eqm.sendEmail(messageObject);
} 
```

现在你的

```
@Resource(name = "jms/EmailerQueueConnectionFactory")
@Resource(name = "jms/EmailerQueue") 
```

和

```
@TransactionAttribute(TransactionAttributeType.MANDATORY)
@Stateless 
```

注释将被尊重。

最后，您的 JMS 发送者将在调用点注册到事务中，您需要确保事务管理器知道您在事务中征用了第二个资源管理器（首先是 DB，现在是 JMS）。我对 glassfish 不太熟悉，但似乎有一个带有开关的配置屏幕，可让您指定对[连接工厂的事务支持级别](https://stackoverflow.com/questions/4186738/glassfish-jta-does-not-affect-jms-resource-rollback-but-message-sent)。

我会将发件人代码更改为：

```
Session session = con.createSession(true, Session.SESSION_TRANSACTED); 
```

从技术上讲，您可以在 EmailQueueMessenger 实例中缓存 JMS 连接实例。您的代码不应关闭 JMS 会话，因为这将在事务完成时处理（尽管我在这一点上看到了 JMS/JTA 实现之间的差异）。

我希望这能解决问题，我*真的*希望它能奏效！

# magento - Magento - 处理多个白标商店的最佳方法

> ID：10438489
> 
> 赞同：-1
> 
> 时间：2012-05-03T19:59:39.980
> 
> 标签：magento

使用单个 magento 安装处理多个白标商店的最佳方法是什么。

商店之间的唯一区别是它们的域名、皮肤以及名称和地址。

我认为有多种方法可以实现这一点，但我正在寻找最被接受的方法作为最佳实践

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T08:36:30.737

域只能在全球或网站级别进行管理。所以这限制了你的选择。

顺便说一句，这将允许您执行您要求的所有操作，以及更多，例如划分您可能需要的白标客户。

# ios - 如何禁用 UITableView 上的左右滑动手势

> ID：10438491
> 
> 赞同：0
> 
> 时间：2012-05-03T19:59:53.350
> 
> 标签：ios, uitableview, uipageviewcontroller, uiswipegesturerecognizer

我有一个 UIPageViewController 在每个内容视图中都有一个大表。当我开始在 UITableView 之外向左或向右滑动时，会触发翻页效果。当我在 UITableView 的范围内向左或向右滑动时，UIPageView 控制器似乎没有进行滑动。

我已经使用以下方法关闭了表格行的编辑：

```
-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    return NO;
} 
```

UITableView 似乎仍然在窃取并保持左右滑动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:27:22.233

A`UITableView`是 的子类`UIScrollView`，它`panGestureRecognizer`窃取触摸（用于滚动）。tableView 可能还添加了自己的 SwipeGestureRecognizer。

如果您使用的是 iOS 5，则可以尝试使用 panGestureRecognizer，但您可能会更幸运，只需使用自己的手势识别器覆盖另一个视图，然后从那里滚动 tableView。

# c# - AccessViolation 发生在 RichTextBox.ScrollToCaret

> ID：10438493
> 
> 赞同：3
> 
> 时间：2012-05-03T19:59:57.123
> 
> 标签：c#, winforms, access-violation

当非 UI 线程尝试将其输出附加到`RichTextBox`主线程中的 UI 控件时，会发生难以跟踪的异常。

此异常随机发生，主要是在线程快速连续调用此方法时。它甚至发生在 2 个非 UI 线程中。

下面是 AppendLog 方法的代码。它位于主 UI 的 Form 类中。我产生 2 个线程并将此方法传递给它们`Action<string> logDelegate`

我什至有同步对象。

```
 public void AppendLog(string message)
    {
        try
        {
            if (this.InvokeRequired)
            {
                this.Invoke(new Action<string>(this.AppendLog), message);
            }
            else
            {
                lock (_logSyncRoot)
                {

                    if (rtbLog.TextLength > 100000)
                        rtbLog.ResetText();

                    rtbLog.AppendText(message);
                    rtbLog.ScrollToCaret();
                }
            }
        }
        catch (Exception ex)
        {
            Logger.LogException(ex);
        }
    } 
```

**System.AccessViolationException : 试图读取或写入受保护的内存。这通常表明其他内存已损坏。**

```
 at System.Windows.Forms.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)
  at System.Windows.Forms.NativeWindow.DefWndProc(Message& m)
 at System.Windows.Forms.Control.DefWndProc(Message& m)
at System.Windows.Forms.Control.WndProc(Message& m)
at System.Windows.Forms.TextBoxBase.WndProc(Message& m)
at System.Windows.Forms.RichTextBox.WndProc(Message& m)
at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
at System.Windows.Forms.UnsafeNativeMethods.SendMessage(HandleRef hWnd, Int32 msg, Int32 wParam, Object& editOle)
at System.Windows.Forms.TextBoxBase.ScrollToCaret()
at MyApp.UI.OfflineAnalyzer.AppendLog(String message) in    D:\MyApp\Code\Charting\OfflineAnalyzer.cs:line 339 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T03:01:38.587

The easiest situation in scenarios like this is to maintain a `Queue<string> queue;` if you have a list of messages for example. Add values to to the queue at will. In the main form thread, use a timer component and lock the queue while pulling out values e.g. `lock (queue) {rtbLog.AppendText(queue.Dequeue());}`.

# javascript - 文档停止加载时的事件

> ID：10438497
> 
> 赞同：0
> 
> 时间：2012-05-03T20:00:07.653
> 
> 标签：javascript, jquery, javascript-events

我有一个网页，其大部分内容是在前端用 javascript 构建的。当基本的 HTML 被解析并构建了 DOM 树时，“ready”事件就会触发。在此事件中，将启动一个 javascript 代码，该代码将继续构建网页。

```
$().ready(function() {
    $(document.body).html('<img src = "img.png" />');
    $.ajax({
        url: 'text.txt'
    });
}); 
```

正如你在这个小例子中看到的，

*   新元素被添加到 DOM
*   更多的东西，比如正在加载图像
*   正在发送 ajax 请求

只有当所有这些都完成时，当浏览器的加载进度条第一次消失时，我才认为我的文档实际上已经准备好了。有没有合理的方法来处理这个事件？

请注意，这

```
$().ready(function() {
    $(document.body).html('<img src = "img.png" />');
    $.ajax({
        url: 'text.txt'
    });
    alert('Document constructed!');
}); 
```

还不够，因为 HTTP 请求是异步的。也许将处理程序附加到每个请求，然后检查所有请求是否都已完成是做我想做的一种方法，但我正在寻找更优雅的东西。

**附录：** 我正在寻找的事件的更正式定义：

文档准备就绪且页面的动态内容首次完成加载/执行时的事件，除非用户通过鼠标移动、单击等触发另一个事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:26:00.897

您正在寻找`.ajaxStop()`.

像这样使用：

```
$("#loading").ajaxStop(function(){
      $(this).hide();
}); 
```

`this`除非您想像上面示例中那样使用，否则附加到什么 DOM 元素并不重要。

来源：[http ://api.jquery.com/ajaxStop/](http://api.jquery.com/ajaxStop/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:57:00.343

如此处所述，您可以[在](http://api.jquery.com/load-event/)单个图像最终加载时为它们注册加载事件。但是，正如那里所描述的那样，这可能在浏览器之间不可靠，或者如果图像已经在浏览器的缓存中。所以我认为至少有一部分不是 100% 值得信赖的。话虽如此，您可以轻松地挂钩到一堆不同的异步事件，然后仅在所有事件都完成时才做出反应。例如：

```
$(document.body).html('<img src="img.png" id="porcupine"/>');

var ajaxPromise1 = $.get(...);
var ajaxPromise2 = $.get(...);
var imgLoadDeferred1 = $.Deferred();

$("#porcupine").load(
  function() {
    imgLoadDeferred1.resolve();
  }
);

$.when(ajaxPromise1, ajaxPromise2, imgLoadDeferred1).done(
  function () {
    console.log("Everything's done.");
  }
); 
```

如果您想考虑到图像加载可能永远不会生成事件的事实，您还可以设置一个最终会关闭的计时器，并尝试解决尚未解决的 imgLoadDeferred1。这样你就不会被困在等待一个永远不会发生的事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:20:40.187

将全局计数器添加到 ajax 调用中，当 ajax 请求准备好时，它会调用`addToReadyCounter();`+1 到 glogal 的函数`var readyCount;`。

在同一函数中检查您的 readyCount 并触发事件处理程序

```
var readyCount = 0, ajaxRequestCount = 5;
function addToReadyCount() {
    ++readyCount;
    if (readyCount >= ajaxRequestCount) {
        documentReadyEvent();
    }
}

$.ajax(
...
    success: function(data){
        addToReadyCount();
}
...); 
```

如果您仅使用`success: ...`for addToReaadyCount documentReadyEvent() 仅在所有调用成功时触发，请使用其他 .ajax() 事件处理程序来增加计数器以防出错。

# mysql - 查询问题中的 MySQL IF 语句

> ID：10438501
> 
> 赞同：2
> 
> 时间：2012-05-03T20:00:30.637
> 
> 标签：mysql, sql

我有以下要尝试执行的查询。它是运行报告所需的查询的起点：

```
SET @fname = 'Bob';
SET @blah = 0;

SELECT CASE WHEN @fname IS NULL THEN @blah = 1 ELSE @blah END;

    IF (@blah > 0) THEN
       SELECT * FROM mytable
    END IF; 
```

我的语法显然有问题，但我无法弄清楚。我已经使用 IF 语句编写了其他查询，没有问题。这不会在 SQLyog 或 Workbench 中运行。它说有或没有括号的“IF”存在语法错误，没关系。

我所需要的只是评估 IF 语句中的变量/输入参数的能力。

任何帮助表示赞赏。*注意*- 如果我可以让 IF 正确评估参数，则 SELECT CASE 可能不是必需的，但我正在尝试任何可能的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T10:47:01.907

您只能在 BEGIN...END 子句中使用 IF-THEN 构造，它只能在过程、函数、触发器和事件中使用。不可能在简单的脚本中使用它。

对于您的情况，我建议您这样做-

```
SELECT * FROM mytable WHERE @blah > 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T11:32:41.983

1.  需要有一个过程或某种形式的脚本需要在特定情况下执行。
2.  `CALL`此类场景需要在报表数据源中启动procedure方法

    脚本可以写成如下方式：（注：PROCEDURE可以根据需要有参数）

    ```
    DELIMITER ?
    CREATE PROCEDURE XYZ()
    BEGIN
    SET @fname = 'Bob';
    SET @blah = 1;

    SELECT CASE WHEN @fname IS NULL THEN  @blah = 0 ELSE @blah END;
    IF (@blah > 0) THEN
    SELECT * from mytable;
    END IF;
    END ?
    DELIMITER; 
    ```

    然后，您可以`CALL XYZ()`根据需要将带或不带参数传递给数据源，或者传递查询以执行生成报告的位置。

以下在 MySQL Workbench 上正常工作。`SELECT CASE`如果不需要，可以从上述过程中删除查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:04:59.397

我看到 else 语句的问题：

```
SELECT CASE WHEN @fname IS NULL THEN @blah = 1 END; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T09:05:48.467

```
// Using procedure getting result as per requirement

drop procedure abc;
DELIMITER // 
create procedure abc() 
begin 
declare fname varchar(10);
declare blah int; 

set fname = 'Bob'; 
set blah = 0;

if(fname IS not NULL) then
       SELECT * from studmaster; 
end if; 

end //
DELIMITER ;

//--comment--> for execute procedure
call abc(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T20:34:54.420

不确定这是否对您有很大帮助，但您可以在 sql 查询中使用 if 语句

```
Select Blah.name,sum(Blah.quan) as SumofQuan,  IF(Blah.descr LIKE '%searchterm%', "FOUND", IF(Blah.descr ="x", "x", "The Rest")) as New_DECRIPTION 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-17T12:17:36.683

我对 SQL SERVER 了解更多，那么可能是我的回答不是很有帮助，但无论如何这里是我的帮助：

尝试更改下面的代码片段，

```
SELECT @blah = (CASE WHEN @fname IS NULL THEN 1 ELSE @blah END) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-17T15:35:34.283

在我看来，当使用 Sql server 时，我发现变量不能在不声明的情况下赋值..

我认为您必须这样做：

```
declare @fname nvarchar(50)
declare @blah int 
```

那么你必须为变量赋值。

```
SET @fname = 'Bob'
SET @blah = 0

SELECT CASE WHEN @fname IS NULL THEN @blah = 1 ELSE @blah END;

IF (@blah > 0) THEN
   SELECT * FROM mytable
END IF; 
```

# jquery - jQuery live() - 功能丢失 - live() 没有点击：但是在输入键上？

> ID：10438502
> 
> 赞同：0
> 
> 时间：2012-05-03T20:00:30.627
> 
> 标签：jquery

我有一个关于 jQuery 的 live() 函数的问题。

我正在编写一个论坛。一旦有人发布内容并点击回车，jQuery 就会附加其他帖子并插入一个用于评论的文本区域，以下事件处理程序适用于该文本区域：

```
//Comment on a post
$('.commenttext').keyup(function(e) {
    if (((e.keyCode || e.which) == 13) && !event.shiftKey) {
        comment($(this));
    }
}); 
```

然后调用发布评论的函数 - 至少它应该是。对于旧帖子，它可以正常工作，但不适用于刚刚发布和附加的帖子。

我知道使用 live() 函数可以保留功能。但是，如您所见，点击回车时帖子被提交，没有涉及任何按钮。所以我想知道如何结合这些东西，即使用 live() 但没有 click: ？

仅供参考，发布内容的功能如下所示：

```
//Function to post
function post()
{
    //Get posttext and preserve line breaks
    var posttext=$('#posttext').val();

    //Ajax if posttext is not empty
    if(posttext!="")
    {
        $.ajax({
            //blablabla
            success: function(postid){

                //Prepend posts with the new post
                var newpost=posttext+'<br/><textarea id="commenttext'+postid+'" class="commenttext" placeholder=" Comment..."></textarea>';
                $(newpost).hide().prependTo('#postsDiv').fadeIn('slow');

            }
        });
    }
} 
```

更新 1：

我已更改事件处理程序以向此发布一些内容，该发布很好，但功能仍然不存在：

```
//Post something
$('#postDiv').on('keyup', '#posttext', function(e) {
    if ((e.which == 13) && !event.shiftKey) {
        post($(this));
    }
}); 
```

更新 2：

它现在有效:) 我不知道comment() 和post() 都必须是实时的。我现在有以下两个功能：

```
//Post something
$('#postDiv').on('keyup', '#posttext', function(e) {
    if ((e.which == 13) && !event.shiftKey) {
        post($(this));
    }
}); 
```

和

```
//Comment on a post
$('.commenttext').live('keyup', function(e) {
    if (e.which == 13 && !event.shiftKey) {
        comment($(this));
    }
}); 
```

它工作正常，但最好也使用 on() 来评论。我试过这个：

```
$('.commentsDiv').on('keyup', '.commenttext', function(e) {
    if ((e.which == 13) && !event.shiftKey) {
        post($(this));
    }
}); 
```

但它不起作用 - 怎么会？commentsDiv 是commenttext 的父元素，即comment textarea。我需要用id来解决吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:04:12.040

[`.live`](http://api.jquery.com/live/)可以与您想要的任何事件一起使用，而不仅仅是`click`（甚至是自定义事件）。

```
$('.commenttext').live('keyup', function(e) {
    if (e.which == 13 && !event.shiftKey) {
        comment($(this));
    }
}); 
```

注意：如果您使用的是 jQuery 1.7+，则不应再使用`.live`，[`.on`](http://api.jquery.com/on/)而应使用。

```
$(document).on('keyup', '.commenttext', function(e) {
    if (e.which == 13) && !event.shiftKey) {
        comment($(this));
    }
}); 
```

而不是`document`，您应该使用最近的父级（尽管此元素不需要从 DOM 中删除，如果它被删除，事件也会被删除）。

PS`e.which`在 jQuery 中被规范化，这意味着它对`e.keyCode || e.which`你有用。

文档：[http ://api.jquery.com/category/events/event-object/](http://api.jquery.com/category/events/event-object/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:05:29.227

未经测试，但我怀疑这......应该......工作？

```
$('.commenttext').live('keyup', function(e) {
  if (((e.keyCode || e.which) == 13) && !event.shiftKey) {
    comment($(this));
  }
}); 
```

# msbuild - 尝试使用 sublime text 到 msbuild 时出现错误 6

> ID：10438508
> 
> 赞同：8
> 
> 时间：2012-05-03T20:00:50.930
> 
> 标签：msbuild, sublimetext, sublimetext2

我正在尝试将 msbuild 与我的 sublime 项目一起使用。[我在这里创建了建议](https://stackoverflow.com/questions/9646776/how-do-i-make-a-build-system-for-sublime-text-2-to-build-msbuild)的构建文件，以下是我的项目文件

```
{
    "folders":
    [
        {
            "path": "/W/MyOrg/MyApp",
                        "folder_exclude_patterns": ["_ReSharper.*", "bin", "obj"]
        }
    ]
} 
```

我选择 msbuild40 构建系统并点击`Build`并获取输出：

```
[Error 6] The handle is invalid
[Finished] 
```

我什至不确定这是 python 还是 msbuild 错误。它是哪一个，我该如何修复它，以及将来解决此类问题的好方法是什么？

### 更新

我尝试将我的项目更新为以下内容并使用该构建，但仍然没有骰子

```
{
    "folders":
    [
        {
            "path": "/W/MyOrg/MyApp",
            "folder_exclude_patterns": ["_ReSharper.*", "bin", "obj"]
        }
    ],
    "build_systems":
    [
        {
            "name": "msbuild",
            "cmd": ["c:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe", "w:\\MyOrg\\MyApp\\MyApp.sln"]
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-04T15:50:57.853

事实证明，每当您从命令行启动 sublime 时都会发生这种情况（我是通过 powershell 别名启动它）。

您可以通过使用批处理文件和[START 命令](http://ss64.com/nt/start.html)来解决此问题。我创建了 sublime_text.bat：

```
START "Sublime Text 2"  "C:\Program Files\Sublime Text 2\sublime_text.exe" %* 
```

并将我的 powershell 别名设置为该 bat 文件。现在一切正常。

# c++ - 如何使用 Qt/C++ 在 Windows 上将 GUI 转换为路径？

> ID：10438510
> 
> 赞同：0
> 
> 时间：2012-05-03T20:01:03.647
> 
> 标签：c++, windows, file, qt

单击开始菜单中的“我的电脑”会返回一个 GUID 链接而不是直接链接。例如：

`::{20B04FE1-3AEA-1069-A2D8-08012B30309D}`

如何将其转换为正常路径，以便在 的帮助下获取目录和文件列表`QDir`？

**更新**

我不是要获取驱动器列表。使用 Qt 可以轻松完成。我只想知道用户在开始菜单中单击了我的电脑。（我的应用程序可以替换 Windows 资源管理器）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:12:12.270

您正在查看 Shell 命名空间中的项目，而不是文件系统中的项目。

Shell 命名空间简介：

[http://msdn.microsoft.com/en-us/library/windows/desktop/cc144090(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144090(v=vs.85).aspx)

外壳显示了许多不作为文件存在的东西，我的电脑就是其中之一。桌面是另一个 - shell 桌面是所有用户桌面文件夹、您的个人桌面文件夹和其他一些纯虚拟项目（如回收站）的合并视图。

要了解有关可用于`SHParseDisplayName`将名称转换为`ITEMIDLIST`.

如果您打算提供 Explorer 的替代品，祝您好运！

# php - 在 PHP 中通过空引用传递

> ID：10438518
> 
> 赞同：2
> 
> 时间：2012-05-03T20:01:33.877
> 
> 标签：php, null, pass-by-reference

在 PHP 中，我需要**通过****引用**将一些参数传递给函数。我不想为类似的行为编写 2 种不同的方法。所以我需要通过参数选择行为。但我不能通过引用传递**null 。**所以我创建了一个虚拟数组。

所以我要么通过

```
 $temp[0]=-1;
    $this->doSomething($bigIds, $temp);
or
    $temp[0]=-1;
    $this->doSomething($temp, $smallIds);

public function doSomething(&$bigIds, &$smallIds) {
        if ($bigIds[0] != -1) {
             // make some thing
        }
        if ($smallIds[0] != -1) {
             // make some thing
        }
} 
```

有没有更好/优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:14:32.860

可能有很多事情你可能更愿意做，例如@ad7six 在评论中所说的，你也可以给它某种设置和一个数组..

```
public function doSomething(&$bIds, $mode) {
   switch($mode){
      case 1: do smallthing;break;
      case 2: do bigthing;break;
      case 3: do both;break;
      default: do nothing;break;
} 
```

这一切都取决于你真正需要什么

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:15:27.313

我会建议一个枚举，但这是 PHP。所以这应该为你做：

```
class YourClass
{
    const DoSomethingSmall = 0;
    const DoSomethingBig = 1;

    public function doSomething(&$ids, $actionType) {
        // can also use a switch here
        if($actionType == self::DoSomethingSmall) {
            // do small
        }
        else if($actionType == self::DoSomethingBig) {
            // do big
        }
    }
} 
```

然后你可以这样做：

```
$this->doSomething($bigIds, self::DoSomethingBig);
$this->doSomething($smallIds, self::DoSomethingSmall); 
```

在课堂之外，您可以使用`YourClass::DoSomethingBig`和`YourClass::DoSomethingSmall`

# java - 仅当该模式恰好出现一次时，正则表达式才能匹配该模式吗？

> ID：10438522
> 
> 赞同：0
> 
> 时间：2012-05-03T20:01:50.943
> 
> 标签：java, regex

举个例子：

```
string1 = "aaxadfxasdf"

string2 = "asdfxadf"

string3 = "sadfas" 
```

我需要一个匹配 x 的模式，以便它只为 string2 返回 x 的匹配。

注意：出于这个问题的目的，我必须使用 java regex。另外，我无权访问代码，所以我不能简单地检查 java regex 对象返回的匹配数。

* * *

大家好，

感谢您的回复，其中一些确实回答了我的问题。我的例子并不像我需要的那样具体。因此，让我将这个怪癖添加到组合中：

如果我匹配多个字符怎么办？

```
string4 = "This is a sentence!"
string5 = "This is just another sentence with some repetition in it. This is a   sentence"
string6 = "this is" 
```

在这种情况下，我只想匹配“句子”，只要它只出现在字符串中一次。

此外，虽然示例中没有表示，但我需要能够跨行搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:05:14.107

```
^[a-wy-z]+x[a-wy-z]+$ 
```

我不确定您是否只期待字母，或者`x`您想要匹配的前后是否可能包含符号和数字。如果是这样，请使用`[^x]`代替`[a-wy-z]`，如下所示：

```
^[^x]+x[^x]+$ 
```

如果您还想自己匹配`x`，请将`+`符号替换为`*`：

```
^[a-wy-z]*x[a-wy-z]*$ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T22:37:18.040

```
^[^x]*x[^x]*$ 
```

其中第一个 ^ 是行首（$ 是行尾），但另一个 ^ 表示字符集的补码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:06:44.223

您可以使用有限状态自动机来完成，因此您肯定可以使用正则表达式来完成。

```
(all the chars except x)*x(all the chars except x)* 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T20:10:01.647

这将匹配任何被单词“asdf”和“adf”包围的字符串（它是贪婪的）。

```
(?=asdf).+(?<=adf) 
```

非贪婪：

```
(?=asdf)((?<!adf).)+(?<=adf) 
```

有更严格的界限：

```
^(?=asdf)((?<!adf).)+(?<=adf)$ 
```

# sql - 合计值和查找前 x 值

> ID：10438525
> 
> 赞同：2
> 
> 时间：2012-05-03T20:02:04.300
> 
> 标签：sql

情况：

我有一个包含销售记录的数据库，每条记录都有一个 ID (PK)、ProductCode、Year、Month、SalesVolume。

作为用户，我将指定年份，因此如果指定 1980，我将在数据库中查询与该年份对应的所有记录。

我正在尝试创建一个查询，该查询将合计指定年份的月 SalesVolumes，然后选择前 5 个销售量值。

到目前为止我收集到的是以某种方式执行上述操作，然后选择前 5 个销售量值，按降序排列，然后选择前 5 个，但这就是我所得到的

请注意，一年内会有多个产品的 SalesVolumes：

```
ID,     Product Code, Year, Month, SalesVolume
23041   121           1980  1      21
23042   121           1980  2      960
23043   121           1980  3      939
23044   121           1980  4      927
23045   121           1980  5      931
23046   121           1980  6      950
23047   121           1980  7      975
23048   121           1980  8      994
23049   121           1980  9      994
23050   121           1980  10     968
23051   121           1980  11     918
23052   121           1980  12     854
23425   122           1980  1      1002
23426   122           1980  2      1032
23427   122           1980  3      1090
23428   122           1980  4      1062
23429   122           1980  5      1010
23430   122           1980  6      1103
23431   122           1980  7      1214
23432   122           1980  8      1122
23433   122           1980  9      1019
23434   122           1980  10     1181
23435   122           1980  11     1343
23436   122           1980  12     1180 
```

预期输出：

1980 年

```
Product Code, SalesVolume
121         , (total SalesVolume of the 12 months)
122         , (total SalesVolume of the 12 months) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:14:38.783

以下是您可以执行的操作 - 将给定年份的每个商品的销售额合计，对它们进行排名，然后选择排名前 5 的商品。

```
SELECT *
FROM (
    SELECT "Product Code",
        SUM(SalesVolume) as total,
        RANK() OVER (ORDER BY SUM(SalesVolume) DESC) as rnk
    FROM YourTable
    WHERE Year = 1980
    GROUP BY "Product Code"
) A
WHERE rnk <= 5 
```

如果您想在所有年份中选择每年前 5 名，您也可以这样做：

```
SELECT *
FROM (
    SELECT Year,
        "Product Code",
        SUM(SalesVolume) as total,
        RANK() OVER (PARTITION BY Year ORDER BY SUM(SalesVolume) DESC) as rnk
    FROM YourTable
    GROUP BY Year, "Product Code"
) A
WHERE rnk <= 5 
```

# php - RewriteEngine 条件目录

> ID：10438527
> 
> 赞同：1
> 
> 时间：2012-05-03T20:02:22.130
> 
> 标签：php, mod-rewrite

我有以下网站结构

```
index.php   
services.php   
contact.php   
/admin 
```

以及 .htaccess 中的以下内容：

```
RewriteEngine on  
RewriteCond %{REQUEST_URI} !(\.[^./]+)$  
RewriteCond %{REQUEST_FILENAME} !-d  
RewriteCond %{REQUEST_FILENAME} !-f  
RewriteRule (.*) /$1.php [L]  
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^.]+\.)+php\ HTTP  
RewriteRule ^(.+)\.php$ /$1 [R=301,L] 
```

这成功地整理了我的 URL 并指向正确的页面。

但是，它会阻止在管理员中执行任何功能，其中 $_POST 和 $_GET 被大量使用。

那么有没有办法阻止规则在 /admin 中执行或将其限制为仅在顶级页面中执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:18:57.660

只需`RewriteEngine on`在行之后添加此规则（在您的两个规则之前）：

```
RewriteRule ^admin(/.*|)$ - [L] 
```

# iphone - 你如何设计 iOS 组件的样式？

> ID：10438528
> 
> 赞同：0
> 
> 时间：2012-05-03T20:02:36.277
> 
> 标签：iphone, ios, cocoa-touch, uikit, uibutton

从早期开始在 Android 工作后，我才刚刚开始 iOS 开发，我对你如何设计/皮肤 iPhone 组件有点困惑。

我看到有一种方法可以在属性中更改某些组件的颜色（这就是它们的名称吗？），但是我怎样才能走得更远呢？

例如，我如何设计自定义按钮或自定义列表视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:11:42.187

您要问的有几个要素，所以我的回答可能不足以满足您的所有需求。

例如，您可以在此处使用此页面，它为您提供了一个非常好的教程，用于对 UI 组件进行一些自定义：

[http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5](http://www.raywenderlich.com/4344/user-interface-customization-in-ios-5)

对于 UITableViews，您还必须采取其他步骤。例如，这个非常好的教程：

[http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:09:32.097

> 如果您创建自定义 UI 元素以复制除外观之外的所有标准 UI 元素，则应考虑使用 iOS 5 及更高版本中可用的外观自定义编程接口。

通过[HIG](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/MobileHIG/UIElementGuidelines/UIElementGuidelines.html)

我建议查看[此](https://developer.apple.com/library/mac/#documentation/ToolsLanguages/Conceptual/Xcode4UserGuide/InterfaceBuilder/InterfaceBuilder.html)内容以更好地了解界面构建器

* * *

对于作为图像的按钮：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
UIImage *image = [UIImage imageNamed:@"myFile.png"];
button.frame = CGRectMake(x, y, image.size.width, image.size.height);
[button setImage:image forState:UIControlStateNormal];
[myView addSubview:button]; 
```

或使用界面生成器：

> 选择“自定义按钮”作为类型，然后从下拉菜单中选择所需的图像。

* * *

# asp.net-mvc-3 - 如何更改 MVC3 不显眼验证的 errorElement

> ID：10438532
> 
> 赞同：1
> 
> 时间：2012-05-03T20:02:47.363
> 
> 标签：asp.net-mvc-3, validation, jquery-plugins

我正在使用 MVC3 不显眼的 jquery 验证。默认情况下，错误消息被放入位于已验证元素右侧的 span 中。在某些情况下，错误消息会换行到下一行并且看起来很难看。我想将“span”更改为“div”，以便错误元素将显示在自己的行上。一般来说，我还想知道如何在*不*修改 jQuery 库的情况下覆盖验证器的 jQuery 默认值。

我已经尝试了这两个 javascript 调用来触发验证。这个不验证：

```
var settngs = $.validator.defaults;
settngs.errorElement = "div";
$('#createForm').validate(); 
```

...并且这个没有设置errorElement：

```
$.validator.unobtrusive.parse($('#createForm')); 
```

仅通过查看 js 文件，我无法弄清楚这一点。我肯定错过了一些东西。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-03T20:10:26.393

在我发现的第 108 行（至少是我拥有的版本）上`jquery.validate.unobtrusive.js`：

```
errorElement: "span", 
```

只需将其更改为：

```
errorElement: "div", 
```

这在我的字段下方创建了一个 div，而不是在它旁边创建了一个跨度

# android - 在 Android 片段上显示对话框时出现问题

> ID：10438542
> 
> 赞同：1
> 
> 时间：2012-05-03T20:03:58.260
> 
> 标签：android, android-layout

以下代码在用户单击 EditText 时显示日期选择器（作为弹出对话框）。showDialog() 调用 onCreateDialog()。代码工作正常，除非它在片段中实现。在 Fragment 中，没有显示对话框。

```
edtTxtDateTime.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                showDialog(DATE_DIALOG_ID);
            }
        });

 @Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
            case DATE_DIALOG_ID:
                // Displaying Date & Time as a dialog

        }
        return null;
    } 
```

我尝试使用 DialogFragment API 实现相同的行为，但是在单击 EditText 时无法获取对话框。

任何建议/提示都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:08:58.860

确保您使用正确的上下文在片段代码中显示对话框。您需要使用父 Activity 的上下文。在您的 Fragment 中，您可以通过调用以下方法获取 Activity（和正确的上下文）：

```
getActivity(); 
```

# c# - 在 C# 中使用 GZip 压缩 BitArray

> ID：10438547
> 
> 赞同：0
> 
> 时间：2012-05-03T20:04:23.707
> 
> 标签：c#, gzip, gzipstream

我有 100M 个元素的 BitArray。这大约是 12.5M。我必须压缩这个数组。我使用 GZipStream 的 Framework 。

```
 public static byte[] Compress(byte[] bytData)
    {
        try
        {
            MemoryStream ms = new MemoryStream();
            Stream s = new GZipStream(ms, CompressionMode.Compress);
            s.Write(bytData, 0, bytData.Length);
            s.Close();
            byte[] compressedData = ms.ToArray();
            return compressedData;
        }
        catch
        {
            return null;
        }
    }

    static void Main(string[] args)
    {
        BitArray t = GetArray();
        byte []byteArray = new byte[100000000/8];
        t.CopyTo(byteArray, 0);
        byte[] compressedData = Compress(byteArray);
        Console.WriteLine(compressedData.Length);
    }
    public static BitArray GetArray()
    {
        Random r = new Random();
        BitArray result = new BitArray(100000000);
        for (int i = 0; i < result.Count; i++)
        {
            if (r.NextDouble() > .5)
            {
                result.Set(i, true);
            }
        }
        return result;
    }
} 
```

但是变量compressedData的大小是12515308。它比原始数组大。有任何想法吗？

可能需要我另一个压缩机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:13:49.533

您是否尝试过不使用随机数据？压缩良好的数据不是随机的。我相信常见的压缩算法会寻找位模式以进行压缩。作为一个简单的测试，您可以将这些随机字节写到一个文件中，然后查看压缩它时会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T23:47:36.313

没有压缩器可以压缩真正的随机数据。（正如所指出的，如果您可以推断出种子和算法，则可以压缩伪随机数据。）

你的应用是什么？你有真实的数据来测试它吗？

# netty - 使用netty设计一个服务器推送

> ID：10438550
> 
> 赞同：1
> 
> 时间：2012-05-03T20:04:29.310
> 
> 标签：netty

在我关于netty的第二个问题中。我们才刚刚开始。我们有一个设计，我们需要使用~~带有长轮询~~HTTP 流的 HTTP。我们估计有 5k - 50k 连接用户打开连接。我们知道 tomcat 不会处理，所以我们查看 netty 来完成任务。

设计应该足够简单，但我们不能使用 websockets（我们希望在 netty 之上使用 hornetQ 并支持 websocket/stomp）但我们不能。

所以基本上我们将在连接的客户端中有服务器推送事件（我们甚至可以使用 JS SSE 来做到这一点）。

客户端将根据 url 订阅端点（就像 JMS 上的队列，不过要简单得多）

所以我们将在服务器端有一个进程来生成事件并通知感兴趣的通道（我们为此使用了一个简单的观察者模式）。

因此，频道订阅了这些进程，然后从它们接收事件。

我今天在这里的问题是看看我们使用的设计方法是否考虑到netty的架构是正确的。

```
public void channelConnected(ChannelHandlerContext ctx, ChannelStateEvent e) throws Exception {
    service.subscribe(this);
    this.context = ctx;
    ctx.sendUpstream(e);
}

//this method gets called by the service when a server event happens
public void onUpdate(String message) {
  ChannelBuffer buffer = Channels.buffer(message.getBytes().length());
  buffer.writeBytes(message.getBytes());
  ChannelFuture future = Channels.future(this.context.getChannel());
  future.addListener(ChannelFutureListener.CLOSE);
  Channels.write(this.context,future,buffer);
} 
```

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:59:37.453

看起来还可以，但那里没有太多东西。您如何处理长轮询启动和可能的后续超时？（或者也许你对此完全满意......这不是西班牙宗教裁判所）

*根据“ URL 队列*”的数量和受欢迎程度，您可能会考虑的一件事是使用[ChannelGroup](http://docs.jboss.org/netty/3.1/api/org/jboss/netty/channel/group/ChannelGroup.html)作为订阅该 url 队列的所有频道的容器。这样，您就可以将消息写入组。另外，当通道关闭时，它们将从组中弹出，因此那里有一些代码简化。

另外，您是否考虑过 HTTP 流式传输？在我看来，不如 websockets 好，但比长轮询好。

我不是 110% 确信所有的实现都是完美的，但我已经整理了一个[测试项目](https://github.com/nickman/netty-ajax-server)，演示了使用 netty 进行长轮询、websockets 和 http 流的 JSON 推送。还有一个 javascript 客户端可以适应您选择的推送类型。您可能会发现它很有用（我很高兴收到任何反馈......）

# dns - 如何在 Saas App 中提供指向子域的自定义域

> ID：10438553
> 
> 赞同：15
> 
> 时间：2012-05-03T20:04:34.693
> 
> 标签：dns, hosting, saas

我想创建一个示例 SaaS 应用程序，用户可以通过该应用程序注册、创建网页、使用模板和/或使用自定义 css 对其进行自定义，从自定义域中提供他们的网页。

我正在考虑将模板与媒体/样式表/js 文件一起保存在 S3/其他 CDN 上。虽然所有这些在技术上都是可能的（实用的？这可能是有争议的）。无论如何，在这种情况下，我很难弄清楚如何通过自定义域为网站提供服务？例如，当他们注册时，他们可以获得一个`subdomain.domain.com`地址。但是，他们如何指出`customerdomain.com`，以便在`customerdomain.com`输入时，它提供与 相同的内容`customerdomain.domain.com`，并且 URL 保持不变`customerdomain.com`

此外，如果我想拥有一个“ `feature`”，那么自定义域可能是一项付费功能。我如何将其限制为仅限付费用户？

通常，当我们设置网站时，我们会在虚拟主机配置文件 (apache) 中指定它，并为其指定别名，因此它会查找并提供这些别名。在这种情况下，我不希望每个注册的人都有一个单独的虚拟主机文件。有替代方案吗？我该如何编程？有什么需要注意的问题吗？

我见过的一种解决方案是让服务器提供一个通配符域 ie `*.domain.com`，并为每个自定义域提供一个单独的虚拟主机，但是如果可以的话，我宁愿避免。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T19:29:31.187

自定义域通常通过 CNAME DNS 记录（DNS 记录的符号链接）完成。您告诉您的客户（通常控制 customerdomain.com）创建 CNAME 记录，说明 customerdomain.com 是 customerdomain.domain.com 的别名。然后，您需要设置自己的服务器来解释对 customerdomain.com 的请求，就像处理对 customerdomain.domain.com 的请求一样。

根据您为子域提供服务的方式，这可以通过几种不同的方式完成。

如果每个客户都有一个 vhost 文件，则需要为客户提供的自定义域添加“ServerAlias”指令。

如果您正在通过自己的应用程序服务器对入口点进行编码（例如，从 PHP 读取“Host”HTTP 标头，然后从中设置客户名称），那么您需要相应地调整该代码以根据您的自己的自定义域数据库。您甚至可以为此使用直接 DNS！

类似的东西：

```
if http "host" header does not end in domain.com:
    cname = get_cname_record(http "host" header value)
    if cname does not end in domain.com:
        return error 404
    else:
        site = first part of cname
else:
    site = first part of http "host" header 
```

然后您可以使用 DNS 作为您的“自定义域数据库”。但请确保您使用的是 DNS 缓存，因为这些查询将在每个请求上执行。

# redis - 使用 django-celery 和弦，celery.chord_unlock 会一直执行，而不是调用提供的回调

> ID：10438557
> 
> 赞同：9
> 
> 时间：2012-05-03T20:04:59.843
> 
> 标签：redis, django-celery, chord

我正在使用 Django Celery 和 Redis 来运行一些这样的任务：

```
header = [
    tasks.invalidate_user.subtask(args = (user)),
    tasks.invalidate_details.subtask(args = (user))
]

callback = tasks.rebuild.subtask()

chord(header)(callback) 
```

[所以基本上与文档](http://docs.celeryproject.org/en/latest/userguide/tasksets.html#chords)中所述相同。

我的问题是，当调用此任务和弦时，**`celery.chord_unlock`任务会一直重试**。中的任务`header`成功完成，但由于`chord_unlock`从未完成，**`callback`从未被调用**。

猜测我的问题是无法检测到任务`header`是否已完成，我转向文档查看如何自定义。我找到[了一个部分](http://docs.celeryproject.org/en/latest/userguide/tasksets.html#important-notes)，描述了同步是如何实现的，提供了一个示例，我缺少的是如何调用该示例函数（即是否有此信号？）。

此外，请注意，此方法不适用于 Redis 后端：

> 这被除 Redis 和 Memcached 之外的所有结果后端使用，它们在标头中的每个任务之后增加一个计数器，然后在计数器超过集合中的任务数时应用回调。

但也说，Redis 方法更好：

> Redis 和 Memcached 方法是更好的解决方案

那是什么方法？它是如何实施的？

那么，为什么`chord_unlock`从未完成，我怎样才能让它检测到已完成的`header`任务？

我正在使用：Django 1.4、芹菜 2.5.3、django-celery 2.5.5、redis 2.4.12

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-18T20:48:19.743

您没有任务示例，但我遇到了同样的问题，我的解决方案可能适用。

我有`ignore_result=True`我要添加到和弦的任务，定义如下：

```
@task(ignore_result=True) 
```

显然忽略结果使得 chord_unlock 任务不知道它们已经完成。在我删除了ignore_result（即使任务只返回true）之后，和弦正确地调用了回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T08:40:07.940

这可能会导致这样的问题；从文档中；

> # 笔记：
> 
> 如果您在 Redis 结果后端使用和弦并且还覆盖了 Task.after_return() 方法，则需要确保调用 super 方法，否则将不会应用和弦回调。

```
def after_return(self, *args, **kwargs):
    do_something()
    super(MyTask, self).after_return(*args, **kwargs) 
```

据我了解，如果您`after_return`的任务中有覆盖功能，则必须将其删除或至少调用**超级**功能。

话题底部：[http ://celery.readthedocs.org/en/latest/userguide/canvas.html#important-notes](http://celery.readthedocs.org/en/latest/userguide/canvas.html#important-notes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T21:32:03.883

我遇到了同样的错误，我将代理更改为 rabbitmq 并且 chord_unlock 正在工作，直到我的任务完成（2-3 分钟的任务）

使用 redis 时，任务完成并且 chord_unlock 每 1 秒重试 8-10 次，因此回调没有正确执行。

`[2012-08-24 16:31:05,804: INFO/MainProcess] Task celery.chord_unlock[5a46e8ac-de40-484f-8dc1-7cf01693df7a] retry: Retry in 1s [2012-08-24 16:31:06,817: INFO/MainProcess] Got task from broker: celery.chord_unlock[5a46e8ac-de40-484f-8dc1-7cf01693df7a] eta:[2012-08-24 16:31:07.815719-05:00]`

`... just like 8-10 times....`

更改代理对我有用，现在我正在测试@Chris 解决方案，我的回调函数从不接收来自标题子任务的结果：S，因此，它对我不起作用。

* * *

芹菜==3.0.6

django==1.4

django-celery==3.0.6

redis==2.6

经纪人：Mac OS X 上的 redis-2.4.16

# c# - 如何使用 CommandParameter 传递 UserControl？

> ID：10438564
> 
> 赞同：6
> 
> 时间：2012-05-03T20:05:28.830
> 
> 标签：c#, wpf, xaml, binding, view

我使用了 DelegateCommand，我想通过命令传递 UserControl。

```
#region OpenViewCommand
private DelegateCommand<UserControl> _openViewCommand;
public ICommand OpenViewCommand
{
    get
    {
        if (_openViewCommand == null)
            _openViewCommand = new DelegateCommand<UserControl>(new Action<UserControl>(OpenView));
        return _openViewCommand;
    }
}

public void OpenView(UserControl ViewName)
{
    UserControl ctrl = (UserControl)ViewName;
    JIMS.Controls.Message.Show(ViewName.ToString());
}
#endregion 
```

XAML 中的命令

```
<Button Name="btnStockGroups" Command="{Binding OpenViewCommand}" CommandParameter="JIMS.View.Stock.StockGroups">stock group</Button> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T20:22:53.340

如果你给你的 UserControl 一个 x:Name（例如“MyView”），你应该能够做这样的事情：

```
<Button Name="btnStockGroups" 
        Command="{Binding OpenViewCommand}" 
        CommandParameter="{Binding ElementName=MyView}"> 
```

# jquery - JQuery 移动滑块 vmouseup 事件

> ID：10438569
> 
> 赞同：0
> 
> 时间：2012-05-03T20:05:39.277
> 
> 标签：jquery, jquery-mobile, slider, jquery-events

因为我现在花了大约一周的时间来解决一个问题，所以我决定在这个社区中询问是否有人可以帮助我，或者至少在跌倒的故事成真之前给我一个线索:-)

我正在用 Python 编写一个动态页面，该页面生成 HTML 输出，其中表单将其值提交给生成的 Python 脚本本身——效果很好——在客户端使用 JQuery Mobile。我确实使用多页布局，其中 5 页包含一个带有滑块的表单。

我希望所有滑块触发一个 cgi 脚本（这是 Python 脚本本身）。我首先在每种形式中使用以下代码执行此操作：

```
<form action="**scriptname**" method="get" name="raum1" id="f_raum1">

<input type="range" name="slider_r1l" id="slider-1" value="**bfout1**" min="-70" max="12" data-theme="b" data-highlight="true" data-track-theme="a" onchange="document.getElementById('f_raum1').submit()"/> 
```

（**xxx**值会在输出到浏览器之前被 python 替换）

问题是，在我完成滑块值更改之前触发了 onchange（意味着我仍在滑块上更改值），因为即使是很小的更改也会触发 cgi 请求。我想用 vmouseup 做到这一点，以便当我从设备上释放手指或鼠标时触发器变为真。

我在我的 html 标头中尝试了这个，但我没有让它工作（肯定是我缺乏 Javascript 知识的原因）并删除了输入标签中的 onchange：

```
<script type="text/javascript">
var in = getElementsByTagName("INPUT");
$(in).bind('vmouseup', function () {
self.document.submit();
 });
</script> 
```

我的问题在哪里？这应该将所有输入标签绑定到 vmouseup 函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:08:19.497

鼠标与图形组件交互，而不是与输入框交互。您可以绑定到 -ui-slider：

```
$('#slider-1').siblings('.ui-slider').bind('vmouseup', function () {
  /* Do submit */
}); 
```

您在此处获得了有关如何绑定滑块事件的更详细说明： [jQueryMobile：如何使用滑块事件？](https://stackoverflow.com/questions/4583083/jquerymobile-how-to-work-with-slider-events)

# c++ - 如何在 Qt 上播放带有 alpha 通道的电影？

> ID：10438573
> 
> 赞同：4
> 
> 时间：2012-05-03T20:05:57.877
> 
> 标签：c++, qt, video, alpha

我正在尝试在 Qt 中加载和查看带有 alpha 通道的视频。视频是使用设置为 RGB + Alpha 和百万种颜色 + 的 Quicktime Animation 编码的。当我将视频加载到 After Effects 并检查时，我确信视频具有透明度工作。

我尝试使用 Phonon 模块但没有成功。视频加载正常，但没有 Alpha 通道，它只显示黑色背景。我尝试设置 WA_TranslucentBackground 属性，但这也不起作用。GIF 不是一个选项，因为图形非常复杂。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T11:50:00.247

我不确定是否可行（不知道 After Effects 的导出选项），​​但您是否尝试将电影转换为 MNG 格式？然后你可以用 QMovie 加载它，它支持 alpha 通道（虽然可能很大）。

也许这个链接会有所帮助：[http ://www.libpng.org/pub/mng/mngapcv.html](http://www.libpng.org/pub/mng/mngapcv.html)

# php - 将子域重定向到 CakePHP 动作

> ID：10438577
> 
> 赞同：3
> 
> 时间：2012-05-03T20:06:27.723
> 
> 标签：php, apache, .htaccess, cakephp, mod-rewrite

## 背景

我有一个 CakePHP 应用程序，它位于`/m/`. 我想编写一个根级`.htaccess`文件，它将站点的“子域”作为参数重定向到操作。

例如：我想编写一个重写规则，这将导致像这样的重定向 -

*   `http://mysite.myserver.com`→`http://myserver.com/m/mysite/`
*   `http://mysite.myserver.com/home`→`http://myserver.com/m/mysite/home`
*   `http://mysite.myserver.com/foo/bar?baz=true`→`http://myserver.com/m/mysite/foo/bar?baz=true`

理想情况下，这个重定向应该对用户不可见（我不想使用 301，因为我不想更改 URL）。

这是我目前的尝试：

```
<IfModule mod_rewrite.c>
  Options +FollowSymLinks
  RewriteEngine on
  RewriteCond %{HTTP_HOST} ^(.*)\.myserver\.com$ [NC]
  RewriteRule ^(.*)$ http://myserver.com/m/%1/$1 [L]
</IfModule> 
```

据我所知，主要问题在于`$_SERVER['REQUEST_URI']`：

*   如果我`http://myserver.com/m/mysite/home`直接浏览到，`$_SERVER['REQUEST_URI'] = /m/mysite/home`.
*   如果我浏览到`http://mysite.myserver.com/home`使用`.htaccess`上面的文件，`$_SERVER['REQUEST_URI'] = /home`.

## 问题

由于 的问题`$_SERVER['REQUEST_URI']`，我的路线无法正确解析：它试图将用户带到`/home`而不是`/m/mysite/home`按照需要。

如何更改我的重写规则以使其正常工作？还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:53:17.123

在正常情况下，您所要求的（更改 URL 中的域名但不要让浏览器看到 URL 更改）是无法实现的。但是，要使其成为可能，您必须在 Apache中**启用并重新启动它。** `mod_proxy`完成后，在您的站点根目录 .htaccess 中使用以下代码：

```
RewriteCond %{HTTP_HOST} ^([^.]+)\.myserver\.com$ [NC]
RewriteRule !^m/ http://myserver.com/m/sites/%1%{REQUEST_URI} [NC,L,P] 
```

# javascript - 让 moment.js 显示适合正在查看的信息的日期时间

> ID：10438579
> 
> 赞同：11
> 
> 时间：2012-05-03T20:06:43.190
> 
> 标签：javascript, datetime, timezone, momentjs

此处先前的答案将我指向用于 javascript 日期处理的[moment.js](http://momentjs.com/)，我真的很高兴找到它。我可以很高兴地解析和操作。

我网站上的用户查看与不同物理站点/位置相关的信息，我想**在特定于该位置的时间**显示相关的日期时间，*而不是*用户位置。

每个物理站点都有一个时区属性字符串，例如“Europe/London”或“Europe/Amsterdam”

我的日期时间都以 UTC 格式从数据库存储和传递。

有没有一种聪明简单的方法可以在任何指定的时区呈现我的 moment.js 对象？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-04T16:23:55.317

理论上，你可以做这样的事情。

```
moment.fn.formatInZone = function(format, offset) {
    return this.clone().utc().add('hours', offset).format(format);
}

moment().formatInZone('HH:mm:ss', 7);
moment().formatInZone('HH:mm:ss', -7); 
```

但是，这要求您知道正确的偏移量，因此它不会考虑夏令时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T12:44:37.800

如果您想在用户实际所在的另一个时区显示日期，那么您需要开始查看[https://bitbucket.org/pellepim/jstimezonedetect](https://bitbucket.org/pellepim/jstimezonedetect)之类的内容（如果您需要检测用户所在的时区）和[https://github.com/mde/timezone-js](https://github.com/mde/timezone-js)如果您需要在区域之间本地化日期。

我在上面链接的 jsTimezoneDetect 将帮助您提供相关时区的候选名单。

多亏了 mde/timezone-js，您将日期时间存储在 UTC 中会让您非常轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:30:45.873

[在 node.js 中，使用节点时间（ https://github.com/TooTallNate/node-time](https://github.com/TooTallNate/node-time) ）实际上非常简单。覆盖全局 Date 对象，然后扩展 moment.js：

```
var time = require('time')(Date),
    moment = require('moment');

moment.fn.setTimezone = function(timezone, relative) {
    this.toDate().setTimezone(timezone, relative);
    return this;
}

moment.fn.getTimezone = function() {
    return this.toDate().getTimezone();
} 
```

为了更好地衡量，让我们引入一个实用函数来将“传入”日期/时间字符串转换为 UTC：

```
moment.fromTimezone = function(datetime, timezone) {
    return moment(datetime, "YYYY-MM-DD HH:mm").setTimezone(timezone, true).setTimezone("UTC");
} 
```

你可以这样做：

```
var fmt = "YYYY-MM-DD HH:mm",
    datetime = "2013-03-21 00:40",
    timezone = "Israel",
    m = moment.fromTimezone(datetime, timezone);

console.log(datetime, "in", timezone, "is", m.format(fmt), "in UTC");
console.log(m.format(fmt), "in UTC is", m.setTimezone(timezone).format(fmt), "in", m.getTimezone()); 
```

外壳输出：

```
$ node mtz.js
2013-03-21 00:40 in Israel is 2013-03-20 22:40 in UTC
2013-03-20 22:40 in UTC is 2013-03-21 00:40 in Israel
$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-23T10:21:20.433

在提出这个问题大约一年后，引入了[Moment Timezone](http://momentjs.com/timezone/docs/)。这是 Moment Timezone 如何解决此问题的示例。

```
const databaseDate = '2014-05-01T12:00:00Z';
const databaseTimezone = 'America/New_York';
const formatString = 'MMMM Do YYYY, h:mm:ss a';

const dateInUTC = moment.utc(databaseDate);
document.getElementById('dateInUTC').textContent = dateInUTC.format(formatString) + ' in UTC';

const dateInDbTZ = moment.utc(databaseDate).tz(databaseTimezone);
document.getElementById('dateInDbTZ').textContent = dateInDbTZ.format(formatString)  + ' in ' + databaseTimezone;

const dbDateWithoutTZ = '2014-05-01T12:00:00'; // no 'Z'
const dateInLocalTime = moment(dbDateWithoutTZ);
   document.getElementById('dateInLocalTime').textContent = dateInLocalTime.format(formatString) + ' in local time or ' + dateInLocalTime.utc().format(formatString) + ' in UTC';
```

```
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.17/moment-timezone-with-data.min.js"></script>
<dl>
<dt>UTC Date</dt>
<dd id="dateInUTC"></dd>
<dt>Timezone-formatted Date</dt>
<dd id="dateInDbTZ"></dd>
<dt>Bad: non-UTC date interpreted as "local time"</dt>
<dd id="dateInLocalTime"></dd>
</dl>
```

# jquery-mobile - jQuery mobile 将动画添加到可折叠集

> ID：10438588
> 
> 赞同：5
> 
> 时间：2012-05-03T20:07:42.090
> 
> 标签：jquery-mobile

我想使用**jQuery Mobile**向可折叠集添加动画。让我展示一个简单的例子：

```
<div id="tiles" data-role="collapsible-set" data-iconpos="right">
   <div class="tile" data-role="collapsible" data-iconpos="right">blablabla</div>
   <div class="tile" data-role="collapsible" data-iconpos="right">blablabla</div>
   <div class="tile" data-role="collapsible" data-iconpos="right">blablabla</div>
</div> 
```

**jQuery Mobile**完美地处理了这个问题，并向我展示了可折叠的 3 个项目。我想要的是动画，但是我似乎在文档中找不到任何东西。

我还没有测试过简单的**CSS 动画**（动画高度属性）是如何工作的，但是有没有**jQuery Mobile**的方式来做它，比如转动一些内部标志？

**编辑** 我已经测试了一个简单的 jQuery 动画方法，它确实有效。以防万一其他人需要这个。即使在我的 528MHz Android 手机的默认浏览器上，它也能流畅运行。我添加的一个片段非常简单：

```
$( ".ui-collapsible-heading" ).live( "click", function(event, ui) {
    $(this).next().css('height', '0').animate({
        height: '100px'
    });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T23:52:32.457

给你：

```
$('[data-role="collapsible"]').bind('expand collapse', function (event) {
    $(this).find('p').slideToggle(500);
    return false;
});​ 
```

我喜欢你的想法，所以我玩了一下。这与 jQuery Mobile 控制可折叠小部件的方式挂钩，因此与绑定到标题元素相比，它有点不那么笨拙。

停止默认行为，另一行使用 jQuery /动画`return false;`切换内容进/出视图。您还可以使用或滚动您自己的动画。如果您选中，您可以根据触发的事件制作动画。`slideUp``slideDown``.fadeToggle()``event.type`

这是一个演示：http: [//jsfiddle.net/VtVFB/](http://jsfiddle.net/VtVFB/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-29T07:31:58.463

请注意，在 jQuery Mobile 1.4 及更高版本中，您需要绑定到`collapsibleexpand`and`collapsiblecollapse`事件而不是`expand`and `collapse`。所以完整的代码就变成了

```
$('[data-role="collapsible"]').on('collapsibleexpand collapsiblecollapse', function(event) {
    $(this).find('p').slideToggle(500);
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T05:06:49.633

​代码并不完全正确。它覆盖了展开折叠事件的默认 jquery 移动实现，但不处理展开折叠图标的更改。

更好的代码将是：

```
$('[data-role="collapsible"] h3:first').bind('click', function (event) {
   $(this).next('p').slideToggle(500);
   return false;
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-25T21:22:21.057

接受的答案没有说明它不会因为返回错误而改变可折叠光标，所以这是我的答案：

在我的项目中，它是相对于的`[date-role="collapsible"]`内容`$(this).find('>*:not(h3)')`

```
/* animate collapsible-set */
$('[data-role="collapsible"]').on('expand', function (event) {
    $(this).find('>*:not(h3)').each(function() {
        if (!$(this).is(':visible')) {
            $(this).stop().slideToggle();
        }
    });
}).on('collapse', function (event) {
    $(this).find('>*:not(h3)').each(function() {
        if ($(this).is(':visible')) {
            $(this).stop().slideToggle();
        }
    });
}); 
```

# symfony1 - symfony：路由总是在同一条路线上

> ID：10438590
> 
> 赞同：0
> 
> 时间：2012-05-03T20:07:48.593
> 
> 标签：symfony1, symfony-1.4, url-routing

我的路由有一个大问题：所有页面都匹配相同的路由！

路由.yml

```
# default rules
homepage:
  url:   /
  param: { module: home, action: index }

# generic rules
# please, remove them by adding more specific rules

localized_homepage:
  url:   /:sf_culture/
  param: { module: home, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr)

change_language:
  url:   /change_language
  param: { module: language, action: changeLanguage }

contatti:
  url:   /:sf_culture/:contatti.html
  param: { module: contatti, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr)

about:
  url:   /:sf_culture/:about.html
  param: { module: about, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr)

opera_slug:
  url:   /:sf_culture/opere/:operaslug.html
  class:    sfDoctrineRoute
  param: { module: opera, action: permalink }
  options:  { model: Opera, type: object }
  requirements:
    sf_culture: (?:it|en|es|fr)

opere:
  url:   /:sf_culture/:opere.html
  param: { module: opera, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr)

default_index:
  url:   /:module
  param: { action: index }

default:
  url:   /:module/:action/* 
```

_header.php

```
<ul>
<li><?php echo link_to(__('Home'), '@homepage') ?></li>
<li><?php echo link_to(__('About'), '@about?about='.strtolower(__('About'))) ?></li>
<li><?php echo link_to(__('Works'), '@opere?opere='.strtolower(__('Works'))) ?></li>
<li><?php echo link_to(__('Contacts'), '@contatti?contatti='.strtolower(__('Contacts'))) ?></li>
</ul> 
```

当我单击菜单上的按钮（_header）时，我总是被重定向到联系人页面，并且观看日志，我可以看到

```
Match route "contatti" (/:sf_culture/:contatti.html) for /es/obras.html with parameters array ( 'module' => 'contatti', 'action' => 'index', 'sf_culture' => 'es', 'contatti' => 'obras',) 
```

这怎么可能？我使用了@route sintax，所以我告诉 symfony 使用特定的路由，但这被忽略了。

您对如何解决有任何想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:42:26.230

Symfony 从上到下匹配路由，因此 symfony 找到匹配的第一条路由被执行。

您的路线在您的模板中正确展开，但是当发出请求时，symfony 与路线`/es/obras.html`正确匹配`@contatti`。这是因为 "obras" 匹配 ":contatti" 参数。

要解决您的问题，您需要为 symfony 提供一种唯一匹配您的 url 的方法。

希望这对您现在更有意义。

**编辑（独特的路线）：**

```
contatti:
  url:   /:sf_culture/contact/:contatti.html
  param: { module: contatti, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr)

about:
  url:   /:sf_culture/about/:about.html
  param: { module: about, action: index }
  requirements:
    sf_culture: (?:it|en|es|fr) 
```

# c# - 我想禁止一个按钮点击

> ID：10438592
> 
> 赞同：1
> 
> 时间：2012-05-03T20:07:56.003
> 
> 标签：c#, winforms

基本上我正在创建一个允许用户输入值的程序，如果值超过一定数量，则禁用另一个表单上的按钮。但我不确定如何访问其按钮控件。我以为会是这样的？谢谢

```
 if(value>120)
 {
  Form3 form3 = new Form3();
  Button.Disable();
  this.close();
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:13:16.697

您的请求是禁用另一个表单上的按钮*-*从阅读中我假设该表单已经存在。通过创建一个新实例：

```
Form3 form3 = new Form3(); 
```

您正在创建一个新实例，`Form3`因此您永远不会禁用已经可见的表单上的按钮。

您必须让当前表单知道 的*实例*`Form3`才能更改那里的任何内容。以下是使它们交互的几种方法：

*   将这些值存储在一个单独的对象中，并让您的表单通过事件对更改做出反应，例如
*   `Form3`在创建或`Show()`输入“this”表单时提供对实例的引用
*   在静态类中保留对每个创建的表单的引用

另请记住，同时激活多个相关表单可能会使您的最终用户感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:13:38.040

您可以像这样禁用按钮：

```
otherForm.Button.Enabled = false; 
```

为了能够从另一个上下文（表单）禁用此按钮，您需要将其声明为公共的。您可以按如下方式执行此操作：

*   在设计视图中选择按钮
*   在属性窗口中将*修饰符*设置为**公共**

然后您可以显示带有禁用按钮的表单，如下所示：

```
var newForm = new Form3();
newForm.Button.Enabled = false;
newForm.Show(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:13:45.023

您需要对 Form3*实例的引用。*您正在创建一个新的 Form3 实例，这可能不是您想要的。然后您的 Form3 需要将您感兴趣的按钮公开为公共属性，以便您可以从类外部访问它。然后您应该能够将 Disabled 属性设置为 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:10:59.910

我想你必须做这样的事情。

更新

```
 if(value>120)
 {
 Form3 form3 = new Form3();
 form3.Button.Enabled = false;
 this.close();
 } 
```

更新

# c++ - 对象数组初始化 (C++)

> ID：10438593
> 
> 赞同：0
> 
> 时间：2012-05-03T20:08:02.697
> 
> 标签：c++, object, new-operator, dynamic-arrays

嘿伙计们，我是 C++ 新手，通过我在大学的一个项目，我遇到了一些困难时期。更特别：我已经为列表和队列创建了一个代码（列表名称 = 链，队列名称 = 队列，产品是一个基本上具有链字段的结构）[顺便说一句，如果有人知道的话，我已经使用过 Sahnis 书（数据结构）。我被困在这里：

```
int k=4;
Queue<Chain<Product>*>* x = new Queue<Chain<Product>*> [k];
for(int i=1;i<k;i++)
{
   x[i] = new Queue<Chain<Product>*> [i+1];
} 
```

在循环上它会抛出错误：从 Queue*>* 到 int 的无效转换

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:13:19.320

它应该是

```
for(int i=0;i<k;i++)   // first index is 0
{
   x[i] = Queue<Chain<Product>*>();
} 
```

因为

```
Queue<Chain<Product>*>* x = new Queue<Chain<Product>*> [k]; 
```

创建一个对象数组`Queue<Chain<Product>*>`，而不是指针。

或者，如果你想要一个二维数组，你可以使用：

```
Queue<Chain<Product>*>** x = new Queue<Chain<Product>*> * [k];
for(int 0=1;i<k;i++)
{
   x[i] = new Queue<Chain<Product>*> [i+1];
} 
```

**为了简化**，您基本上是在尝试以下操作：

```
int* x = new int[4];
for ( int i = 0 ; i < 4 ; i++ )
   x[i] = new int[i]; 
```

这显然是错误的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:13:49.803

在这一行`x[i] = new Queue<Chain<Product>*> [i+1]`中，他 [i+1] 是错误的。
为什么？好吧，您正在创建一个新的对象`new`关键字。并`.operator[int x]`在数组中使用。在该行中，您说它应该是一个大小为 i+1 的新数组，类型`Queue<Chain<Product>*>`是错误的。而是使用`x[i] = Queue<Chain<Product>*>();`

所以结束代码是：

```
for(int i=0;i<k;i++)//because indexes begin at 0, not 1.
{
  x[i] = Queue<Chain<Product>*>()
} 
```

注意*要查看您的错误的简化版本，请参阅其他人的帖子（我不会复制代码 - 浪费空间）。

# ubuntu - CouchDB：不提供蒲团

> ID：10438594
> 
> 赞同：0
> 
> 时间：2012-05-03T20:08:07.997
> 
> 标签：ubuntu, couchdb, apache, couchdb-futon

我已经在 Ubuntu 11.10 中安装了 CouchDB。我有一个 HTTPD 服务器正在运行（运行正常）以及 CouchDB 的所有先决条件。

我已经在后台为系统上的用户启动了 CouchDB：

> sudo -i -u bpetruk couchdb -b

它告诉我它已经开始了，“是时候放松一下了”。不幸的是，我还不能放松——因为即使服务器已经加载，我也无法从标准的[http://127.0.0.1:5984/_utils](http://127.0.0.1:5984/_utils)位置访问 Futon。

这是启动例程的一些错误输出。可怕，我知道哈哈。它似乎刚刚将一些 JSON 转储到终端：

> Apache CouchDB 1.2.0 (LogLevel=info) 正在启动。[错误] [<0.96.0>] {error_report,<0.31.0>, {<0.96.0>,crash_report, [[{initial_call,{couch_auth_cache,init,['Argument__1']}}, {pid,< 0.96.0>}, {registered_name,[]}, {error_info, {exit, {{badmatch,{error,eacces}}, [{couch_auth_cache,ensure_users_db_exists,2}, {couch_auth_cache,open_auth_db,0}, {couch_auth_cache, reinit_cache,1}, {couch_auth_cache,init,1}, {gen_server,init_it,6}, {proc_lib,init_p_do_apply,3}]},

同样令人沮丧的是，在 couchdb 上定义 -s 标志（应该打印后台进程的状态）绝对不会产生任何结果！所以我也无法提供这方面的信息。

在我第一次涉足 CouchDB 世界时，是否有任何常见问题我可能视而不见？我真的卡在这个上了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T16:17:18.573

正如上面错误输出的第三行中的“ **{{badmatch,{error,eacces}}** ”所暗示的，CouchDB 遇到了一些文件权限错误，并且无法正确写入某些文件。我无法确定是哪个文件导致了这个问题，但是拥有整个 CouchDB 目录的所有权解决了这个问题。

# php - PHP 哈希键数组

> ID：10438596
> 
> 赞同：4
> 
> 时间：2012-05-03T20:08:22.057
> 
> 标签：php, arrays, hash

我在 GitHub 上搜索 Bloom Filters 时遇到了这个简单的 PHP 类，它被命名为“Bloom Filter”，但我认为它更像是一个“哈希表”，无论哪种方式我都很好奇，它很容易理解。

它读入一个单词文件并为每个单词创建一个哈希数组键，然后您可以检查该单词是否存在于哈希数组中。

我很好奇，尽管使用它与仅将实际单词存储为数组键或值然后检查该单词是否存在于数组中相比有什么好处，理论上这只会增加开销并做同样的事情，请帮助我明白我错过了什么吗？

```
<?php
class Dictionary {
    private $words;
    private $wordsHash;
    public $hashLength;

    public function __construct($filepath, $hashLength) {
        $this->words = file($filepath);
        $this->hashLength = $hashLength;
        foreach($this->words as $word){
            $this->wordsHash[$this->createHash($word)] = true;
        }
        echo 'words: ' . count($this->words) . '   hashes: ' . count($this->wordsHash) . "\n";
    }

    public function createHash($str){
        $hash = substr(md5(trim($str)), 0, $this->hashLength);
        return $hash;
    }

    public function checkDictionary($str){
        $hash = $this->createHash(trim($str));
        if(array_key_exists ($hash , $this->wordsHash)){
            return true;
        }
        return false;
    }

}
?> 
```

dictionary.txt 文件有 10,000 个单词，我将仅显示一些用于演示

```
der
die
und
in
den
von
zu
das
mit
sich
des
auf
für
ist 
```

示例用法：

```
<?php
$dictionary = new Dictionary('dictionary.txt', 30);

if($dictionary->checkDictionary('den')){
    echo 'The Word den Exist in the Hash Table';
}else{
    echo 'The Word den DOES NOT Exist in the Hash Table';
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T20:19:20.733

这样做的想法似乎是搜索键比在数组中搜索特定值要快得多。对于非常大的阵列尤其如此。但是，我会推荐一种更简单的方法来（正如您已经说过的）避免开销和冲突：

```
$words = array_flip( file($filename) );

// The actual values are now the keys!
// So checking for a word works like this:
if (isset($words['und'])) {
    // ...

// Travling through the words works like this:
foreach ($words as $word => $i) {
    // ... 
```

（PS：这段代码不会像预期的那样工作，因为每个单词都会包含换行符，所以你需要先去掉它。但我希望你明白。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T20:18:50.563

这种方法通常使用非常大的字符串来完成。我曾经在创建画廊时使用过这种方法。上传的文件将以`sha1`整个文件的校验和命名（而实际名称保存在数据库中）。这样，如果上传了重复文件，很容易被拒绝。

我不知道他会从散列 3 个字母字符串（甚至 50 个字母字符串）中获得什么好处。我不会那样做的。您将询问原始开发人员。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T20:22:30.527

如果您在 github 上找到它 - 可能值得询问您找到的代码的作者。

字典类确实有 2 个好处 - 它修剪键，并避免重复，但以下代码大部分是等效的，并且可能要快得多：

```
$words = file($filepath);
$words = array_map('trim', $words);
$words = array_unique($words);
sort($words); // just for convenience debugging

...

if (in_array($test, $words)) {
    return true;
} else {
    return false;
} 
```

如果有疑问，对每个（或任何）竞争技术进行基准测试应该清楚地表明哪个是给定用例的最佳解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-03T20:32:58.743

我看到该构造函数与仅使用单词本身作为键之间没有功能差异。php 中的非数字数组本质上是哈希图（如果我没记错的话，在语法和实现中）。考虑这个片段：

```
$contents = file($filepath);
$dictionary = array();
foreach($contents as $word) {
    $dictionary[$word] = $word;
}

if(array_key_exists('den', $dictionary){
    echo 'The Word den Exist in the Hash Table';
}else{
    echo 'The Word den DOES NOT Exist in the Hash Table';
} 
```

它与示例类做同样的事情。您唯一丢失的是`->`语法，但从技术上讲，您可以将`$dictionary['den']`其用作存在条件...如果未设置，则返回 null ，其计算结果为 false，所以...

该课程还承诺在不需要密码安全的情况下使用密码散列函数的计算机科学禁忌。MD5 算法的运行成本比常规的、不安全的（相对而言；在这一点上调用 MD5 安全是可疑的）哈希函数要昂贵得多。除了没有真正提供任何东西之外，使用字典类会明显变慢。正如 Truth 所指出的，比较非常长的字符串的摘要可以节省您的时间。但是计算摘要仍然很昂贵，计算 3 个字母字符串的摘要只不过是浪费时间。

# xcode - 命令 /Developer/Platforms 失败，退出代码为 1

> ID：10438597
> 
> 赞同：0
> 
> 时间：2012-05-03T20:08:36.040
> 
> 标签：xcode

ld：重复符号_OBJC_METACLASS_$_iPadCategoryTableViewController 在/Users/cilat/Library/Developer/Xcode/DerivedData/CommonChineseCharacters-cstedjbqaisoopbqvizbwrsniyda/Build/Intermediates/CommonChineseCharacters.build/Debug-iphonesimulator/CommonChineseCharacters.build/Objects-normal/i386/iPadCategoryTableViewController.o和 /Users/cilat/Library/Developer/Xcode/DerivedData/CommonChineseCharacters-cstedjbqaisoopbqvizbwrsniyda/Build/Intermediates/CommonChineseCharacters.build/Debug-iphonesimulator/CommonChineseCharacters.build/Objects-normal/i386/CategoryTableViewController.o 用于架构 i386 命令 /Developer/ Platforms/iPhoneSimulator.platform/Developer/usr/bin/llvm-gcc-4.2 失败，退出代码为 1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T14:08:03.843

很可能您在项目中两次包含了您引用的文件之一。

请重新检查您的文件

项目->构建阶段->编译源

# sql - SQL Server 视图的性能测试产生了令人惊讶的结果。为什么？

> ID：10438601
> 
> 赞同：3
> 
> 时间：2012-05-03T20:08:46.737
> 
> 标签：sql, sql-server, performance, sql-view

最近，我们对一些可能对性能产生负面影响的 SQL Server 视图进行了一些更改。我们决定对这些视图进行一些性能测试，看看我们是如何影响它们的。结果令人惊讶。

下图显示了我们运行的性能测试的结果。以下是图表所代表的内容：

*   蓝线是进行任何更改之前的视图。
*   红线显示更改后的视图。
*   x 轴表示循环中的迭代。
    *   每次迭代，都会插入**一千条新记录**（视图将返回）。
    *   每次迭代，我们都会从我们正在测试的视图中进行几次选择，并对结果进行平均。
*   y 轴表示视图返回结果所需的时间
*   经过性能测试的 select 语句有一个 where 子句，每次只返回 100 条记录。（在测试期间，每个名字上插入了 100 条记录）。

结果表明，我们确实确实受到了性能影响，但令我们感到困惑的是，一旦我们在数据库中达到大约 40,000 条记录，性能就会大幅提升。我们在**几个不同的服务器**上运行了这个测试，每次都得到类似的结果。

我想知道是否有人可以深入了解为什么会发生这种情况。当我们突破 40,000 个记录水平时，为什么我们会获得**巨大的性能提升？**有没有人见过这样的事情？我试图为此寻找某种原因，但空手而归。

我们尝试过调整视图、弄乱索引、重建和重组索引、分析执行计划以及其他各种事情，但到目前为止，我们还没有发现任何会导致这种情况的事情。

![查看性能](../Images/4d2161c358327cb881ce5d75bab65404.png)

任何帮助或见解将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:42:46.190

您应该像任何其他性能调查一样处理此问题：使用合理的方法和衡量标准。[再次，等待和队列](http://technet.microsoft.com/en-us/library/cc966413.aspx)作为识别瓶颈的方法将是无价的。一旦您确定并衡量了相关指标，就可以给出正在发生的事情的答案。

现在，您只是测量响应时间，没有任何实际数据来说明花费的时间。没有提供单个实际数据点（收集的指标、其他人尝试的测试规范等），*任何*解释都可以冒险尝试正确的机会：客户端代码、锁定争用、文件增长、日志增长、索引统计信息、查询计划变化，人为错误，小精灵，月光，当然还有我最喜欢的：[碎片](http://rusanu.com/2010/03/31/the-bizzaro-guide-to-sql-server-performance/)。

因此，要么进行适当的分析和调查并收集相关指标，要么发布准确的测试（重现脚本、方法），以便我们进行自我衡量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T00:25:42.580

您是否尝试过更新有关表的统计信息。

也许您的统计数据已过时，并且所使用的计划对于您的行数来说是错误的计划。

# javascript - 在jquery中为内联css构造图像路径的最佳方法

> ID：10438603
> 
> 赞同：0
> 
> 时间：2012-05-03T20:08:59.983
> 
> 标签：javascript, jquery, html

我有以下代码：

```
$('<div style="background-image:url(\'/images/a.gif\')"></div>').appendTo('body') 
```

根据我在页面上的位置，路径会变成这样：

[http://www.mysite.com/this/is/where/i/am/_images/spinner.gif](http://www.mysite.com/this/is/where/i/am/_images/spinner.gif)

我需要它是“http://www.mysite.com/images/a.gif”。

我不想硬编码它。我也不希望给它一个类名并用 css 定义它。我也试过这个：

myVar = window.location.hostname + "/images/a.gif" 并在上面的 jQuery 代码中使用 'myVar' 作为路径。这似乎也不起作用。我得到类似于此[http://www.mysite.com/this/is/where/i/am/mysite.com/images/a.gif](http://www.mysite.com/this/is/where/i/am/mysite.com/images/a.gif)的内容

所以我想我的问题是构建从 jQuery 到该图像的路径的最佳方法是什么。这些信息也可能相关：

该 jquery 代码位于 main.js 中，它位于“javascript”文件夹中，该文件夹与“images”文件夹具有相同的父目录，因此“images”和“javascript”文件夹是兄弟文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:13:46.443

你有没有尝试过

`$("<div>").css('background-image', 'url(/images/a.gif)').appendTo('body')`

# css - 如何动态更改 css 文件的路径？

> ID：10438607
> 
> 赞同：-2
> 
> 时间：2012-05-03T20:09:22.323
> 
> 标签：css, scala, lift

<头部>

...

<link href="static/css/bootstrap.css" rel="stylesheet">

<lift:dynamicStile></lift:dynamicStile> //???

...

</head>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:58:20.777

我会用简短的​​问题来回答：

[https://github.com/lift/framework/blob/master/web/webkit/src/main/scala/net/liftweb/builtin/snippet/CSS.scala](https://github.com/lift/framework/blob/master/web/webkit/src/main/scala/net/liftweb/builtin/snippet/CSS.scala)

# jquery - jquery - 检查必需但为空的复选框、多选、单选和下拉字段

> ID：10438608
> 
> 赞同：1
> 
> 时间：2012-05-03T20:09:23.160
> 
> 标签：jquery

在 stackoverflowers 的帮助下，我在示例应用程序中得到了这段代码，但论坛中的某人指出我需要更多代码来验证复选框、单选、多选和下拉菜单。现在，这可以验证一个空的文本字段。

我想如果我查找所需字段的类型可能会起作用，但我不知道如何合并它或者它是否会起作用。有人可以提供帮助吗/

**我的 jsfiddle** >> [http://jsfiddle.net/justmelat/kBDNt/](http://jsfiddle.net/justmelat/kBDNt/)

**我的html代码**>>

```
<form method="post" action="">
    <div id="holdErrMsg"></div>
    <fieldset id="mainSection" name="mainSection">
                <legend style="color:blue; font-weight:bold">Project Overview Section</legend>

                <table style="width: 100%">
                    <tr>
                        <td style="height: 33px; width: 178px;">Name</td>
                        <td style="height: 33px"><input  id="1125" name="1125" class="1125-required" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="height: 33px; width: 178px;">Email</td>
                        <td style="height: 33px"><input id="1026" name="1026" class="1026-required" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 178px">Product Title</td>
                        <td><input  id="1089" name="1089" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="width: 178px">Product Type</td>
                        <td><select id="1169" name="1169">
                        <option value="">Select</option>
                        <option value="Cars">Cars</option>
                        <option value="Boats">Boats</option>
                        <option value="Planes">Planes</option>
                        </select></td>
                    </tr>
                                        <tr><td>
                                        <button id="btnCatchReqFlds" type="button" name="btn">Check Required Fields</button>
                                        </td></tr>
                                    </table>
            </fieldset>

            <fieldset id="section-11" name="section-11">
                <legend style="color:fuchsia; font-weight:bold">Car Details Section</legend>

                <table cellpadding="2" style="width: 100%">
                    <tr>
                        <td style="width: 334px; height: 35px"><label>Size:*</label></td>
                        <td style="height: 35px"><input id="1245" class="1245-required" name="1245" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="height: 35px; width: 334px">Color:*</td>
                        <td style="height: 35px">
                        <select id="1433" class="1433-required" name="1433">
                <option value="Orange">Orange</option>
                        <option value="Blank">Blank</option>
                        <option value="Green">Green</option>
            </select></td>
                    </tr>
                    <tr>
                        <td style="width: 334px">Description:</td>
                        <td>
                        <textarea id="1290" name="1290" rows="2" style="width: 433px"></textarea></td>
                    </tr>
                </table>
                            </fieldset>

            <fieldset id="section-12" name="section-12">
                <legend style="color:fuchsia; font-weight:bold">Plane Details Section</legend>

                <table cellpadding="2" style="width: 100%">
                    <tr>
                        <td style="width: 334px; height: 35px"><label>Size:</label></td>
                        <td style="height: 35px"><input id="1245" name="1245" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="height: 35px; width: 334px">Color*:</td>
                        <td style="height: 35px">
                                                <input type="checkbox" name="1433[]" id="1433[]" value"Orange" class="1433[]-required"/>Orange
                                                <input type="checkbox" name="1433[]" id="1433[]" value"Blue" class="1433[]-required"/>Blue
                                                <input type="checkbox" name="1433[]" id="1433[]" value"Green" class="1433[]-required"/>Green
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 334px">Description:</td>
                        <td>
                        <textarea id="1290" name="1290" rows="2" style="width: 433px"></textarea></td>
                    </tr>
                </table>
                            </fieldset>
            <fieldset id="section-13" name="section-13">
                <legend style="color:fuchsia; font-weight:bold">Boat Details Section</legend>

                <table cellpadding="2" style="width: 100%">
                    <tr>
                        <td style="width: 334px; height: 35px"><label>Size:</label></td>
                        <td style="height: 35px"><input id="1245" name="1245" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="height: 35px; width: 334px">Color:*</td>
                        <td style="height: 35px">
                                                <input type="radio" name="1834" id="1834" value="None" class="valuetext" class="1834-required">None
                                                <input type="radio" name="1834" id="1834" value="All" class="valuetext" class="1834-required">All
                       </td>
                    </tr>
                    <tr>
                        <td style="width: 334px">Description:</td>
                        <td>
                        <textarea id="1290" name="1290" rows="2" style="width: 433px"></textarea></td>
                    </tr>
                </table>
                            </fieldset><br>
<fieldset id="section-1011" name="section-1011">
                <legend style="color:green; font-weight:bold">Misc Info Section</legend>

                <table cellpadding="2" style="width: 100%">
                    <tr>
                        <td style="width: 334px; height: 35px"><label>Size:</label></td>
                        <td style="height: 35px"><input id="1301" name="1301" type="text" /></td>
                    </tr>
                    <tr>
                        <td style="height: 35px; width: 334px">Color:</td>
                        <td style="height: 35px">
                        <select id="1302" name="1302">
                <option value="Orange">Orange</option>
                        <option value="Blank">Blank</option>
                        <option value="Green">Green</option>
            </select></td>
                    </tr>
                    <tr>
                        <td style="width: 334px">Description:</td>
                        <td>
                        <textarea id="1303" name="1303" rows="2" style="width: 433px"></textarea></td>
                    </tr>
                </table>
                            </fieldset>

</form>​ 
```

**我的jQuery代码**>>

```
$("#section-11").hide();
$("#section-12").hide();
$("#section-13").hide();
$("#section-1011").hide();

var projtype = new Array(
        {value : 'Cars', sect_id : 'fieldset#section-11'},
        {value : 'Planes', sect_id : 'fieldset#section-12'},
        {value : 'Boats', sect_id : 'fieldset#section-13'}
    );
$("select#1169").on('change',function () {
var thisVal = $(this).val();
 var sect_id ="";
     //$('fieldset[id!="mainSection"]').hide();
    $(projtype).each(function() {
$(this.sect_id).hide();
        if(this.value == thisVal) {
        $(this.sect_id).show();
        }
    });        
});

$("#btnCatchReqFlds").on('click', function() {
    var requiredButEmpty = $("fieldset:visible").find('input[class*="-required"], select[class*="-required"]').filter(function() {
      return $.trim($(this).val()) === "";  
    });
    if (requiredButEmpty.length) {
        requiredButEmpty.each(function () {

            $("#holdErrMsg").append("Please fill in the " + this.name + "<br />");
        });
    }
    return !requiredButEmpty.length;
});
​ 
```

# jsf - 命令按钮操作不起作用

> ID：10438609
> 
> 赞同：2
> 
> 时间：2012-05-03T20:09:26.807
> 
> 标签：jsf, redirect

我有这个数据表：

```
<h:dataTable value="#{orderController.orderList}" var="order"
                                     styleClass="table table-striped">
                            <h:column>
                                <f:facet name="header">#</f:facet>
                                <h:outputText value="#{order.orderNo}" escape="false"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Cliente</f:facet>
                                <h:outputText value="#{order.client}" escape="false"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Data</f:facet>
                                <h:outputText value="#{order.date}" escape="false"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">Status</f:facet>
                                <h:outputText value="#{order.status}" escape="false"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header"></f:facet>
                                <h:form>
                                    <h:commandButton action="#{orderController.orderDetail}" value="Detalhe" styleClass="btn btn-info"/>
                                </h:form>
                            </h:column>
</h:dataTable> 
```

我正在显示一个订单列表，每个列表都有一个“详细信息”按钮，它将用户重定向到`orderDetail.html`里面的页面`views/fornecedores`。

我已经调试过，当我点击 时`commandButton`，它没有调用我的 bean 函数。[

我也试过这个：`<h:commandButton action="views/fornecedores/orderDetail.html" value="Detalhe" styleClass="btn btn-info"/>`什么都没有，它一直将我重定向到同一页面，`orderSearch.html`.

我需要的是调用将接收`orderNo`参数并加载对象并重定向到`orderDetail.html`页面的方法。

我做错了什么或者这种方法的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T20:21:41.687

在这种特殊情况下，当您嵌套 HTML 中非法的表单时，可能会发生这种情况。这也可能发生在`#{orderController}`请求范围内并且`orderList`内容取决于基于请求的值，这会导致在处理表单提交时列表发生不兼容的更改。

因此，请确保您没有将多个`<h:form>`组件相互嵌套，并确保 the`#{orderController}`是一个`@ViewScoped`bean 并且您没有`orderList`在其 getter 方法中操作。

### 也可以看看：

*   [未调用 commandButton/commandLink/ajax 操作/侦听器方法或未更新输入值](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked)

* * *

至于您的具体功能要求，`<h:link>`with`<f:param>`和`<f:viewParam>`是一种更理智的方法。它是可收藏的，对 SEO 更友好。另请参阅[JSF 2.0 中的通信 - 处理 GET 请求参数](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)。

# c# - 为什么 MVC3 modelbinder 不解析列表 > 带有空列表 在里面吗？

> ID：10438611
> 
> 赞同：1
> 
> 时间：2012-05-03T20:09:41.610
> 
> 标签：c#, asp.net-mvc, json, asp.net-mvc-3, model-binding

我有一种类型`List<List<int>>`，我试图让 MVC3 中的模型绑定器解析并且它失败了。我的控制器将该类型作为参数，当我像这样发送完全填充的列表时，它可以工作。

**有效的、正确解析/绑定的数据**

`[ [ 22, 12, 9 ], [1, 2, 3], [5] ]`

一旦我将相同的数据结构发送到控制器，但这次是一个空数组，它就会停止解析外部集合。这是活页夹窒息的一些数据：

**有效的、不正确的解析/绑定数据**

`[ [ 4, 5], [], [6, 7] ]`

该值绑定到 a `List<List<int>>`，但它的长度为 1 并且第一项是 a`List<int>`的`4, 5`

`List<List<int>>`那么，当某些`List<int>`' 是空列表时，如何让 modelbinder 接受 a ？我需要上面显示的“有效的、未正确解析/绑定的”数据才能工作。

更糟糕的是，没有绑定错误`ModelState`！

如果这很重要，这也将作为 JSON 发送到控制器（通过`application/json`）。我想如果这是一个错误，它可能特定于那个 json 模型绑定器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:10:07.227

这必须只是模型绑定器中的实现细节或实现错误。如果您通过`null`而不是`[]`为您的空`List<int>`的，它会正常工作。

此解决方法的一个奇怪细节是这些`null`值被转换为空`List<int>`的！

如果你发送

`[ [ 4, 5], null, [6, 7] ]`

那么您的`List<List<int>>`遗嘱中的项目是：

```
 [0] = List<int> {4, 5}
 [1] = List<int> {}
 [2] = List<int> {6, 7} 
```

我仔细检查了，索引`1`绝对是一个空列表，您可以访问它的计数等。

此外，MVC 中的默认 Json 序列化程序会将该列表序列化为

`[ [ 4, 5], [], [6, 7] ]`

代替

`[ [ 4, 5], null, [6, 7] ]`

乐趣。

# c# - DataGridView - 如何使复选框充当单选按钮？

> ID：10438613
> 
> 赞同：3
> 
> 时间：2012-05-03T20:09:46.700
> 
> 标签：c#, winforms, datagridview

我有一个 Windows 窗体应用程序，它在[DataGridView](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellparsing.aspx)中显示对象列表。

此控件将布尔值呈现为复选框。

对象属性中有一组三个复选框，它们是互斥的。最多有一个可以是真的。因此，我希望复选框像一组单选按钮一样。

> 只是老家伙的旁白：我认为现在的人们甚至不知道为什么这些被称为单选按钮。在过去，汽车中的收音机有 4 或 5 个按钮，按下其中任何一个都会导致其他所有按钮弹出。它们是相互排斥的。如今，“单选按钮”可能不是一个有用的描述，因为收音机不再有这样的按钮，我不认为。

我该怎么做？我想如果我将“CheckedChanged”事件附加到复选框，并且我知道该行，我将能够找到所有其他复选框。

我可以在第一次呈现复选框控件时挂钩什么事件，以便我可以将 CheckedChanged 事件附加到它？我知道`DataGridView.CellFormatting`，但我认为这是错误的，因为每次 DataGridView 绘制时都会调用它。我真的需要一个仅在第一次渲染 DGV 时才调用的事件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T20:56:32.137

感谢 KeithS 提供的有用答案。

当我查看[CellValueChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvaluechanged.aspx)的​​文档时，我发现这很有帮助：

> DataGridView.CellValueChanged 事件在提交用户指定的值时发生，这通常在焦点离开单元格时发生。
> 
> 但是，对于复选框单元格，您通常希望立即处理更改。要在单击单元格时提交更改，您必须处理 DataGridView.CurrentCellDirtyStateChanged 事件。在处理程序中，如果当前单元格是复选框单元格，则调用 DataGridView.CommitEdit 方法并传入 Commit 值。

这是我用来获取无线电行为的代码：

```
 void dataGridView1_CurrentCellDirtyStateChanged(object sender, EventArgs e)
    {
        // Manually raise the CellValueChanged event
        // by calling the CommitEdit method.
        if (dataGridView1.IsCurrentCellDirty)
        {
            dataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit);
        }
    }

    public void dataGridView1_CellValueChanged(object sender,
                                               DataGridViewCellEventArgs e)
    {
        // If a check box cell is clicked, this event handler sets the value
        // of a few other checkboxes in the same row as the clicked cell.
        if (e.RowIndex < 0) return; // row is sometimes negative?
        int ix = e.ColumnIndex;
        if (ix>=1 && ix<=3)
        {
            var row = dataGridView1.Rows[e.RowIndex];

            DataGridViewCheckBoxCell checkCell =
                (DataGridViewCheckBoxCell) row.Cells[ix];

            bool isChecked = (Boolean)checkCell.Value;
            if (isChecked)
            {
                // Only turn off other checkboxes if this one is ON. 
                // It's ok for all of them to be OFF simultaneously.
                for (int i=1; i <= 3; i++)
                {
                    if (i != ix)
                    {
                        ((DataGridViewCheckBoxCell) row.Cells[i]).Value = false;
                    }
                }
            }
            dataGridView1.Invalidate();
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:18:21.053

您想要的是 DGV 本身上的 CellContentClick。附加一个处理程序，检查 DGV 的该列是否为 CheckBoxCell，如果是，则取消选中该行上的所有其他复选框。

不过请注意，对于 CheckBoxCell，此事件会在复选框值实际更改之前触发。这意味着无论您对当前单元格做什么，它都会被稍后触发的事件覆盖。摆脱这种情况的行为是，您可以通过选中行上的一个框然后再次检查它来检查行上的任何单元格（无论您是否尝试在处理程序中设置复选框值，复选框将在第二次单击后被清除）。要克服这一点并强制选中其中一个复选框，您可以改为处理 CellValueChanged，如果更改的单元格是当前单元格并且未选中，请选中它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-08T23:39:56.170

```
 private void dataGridViewProduit_CellValueChanged(object sender, DataGridViewCellEventArgs e)
    {
        if ((sender as DataGridView).CurrentCell is DataGridViewCheckBoxCell)
        {
            if (Convert.ToBoolean(((sender as DataGridView).CurrentCell as DataGridViewCheckBoxCell).Value))
            {
                foreach (DataGridViewRow row in (sender as DataGridView).Rows)
                {
                    if (row.Index != (sender as DataGridView).CurrentCell.RowIndex && Convert.ToBoolean(row.Cells[e.ColumnIndex].Value) == true)
                    {
                        row.Cells[e.ColumnIndex].Value = false;
                    }
                }
            }
        }
    }

    private void dataGridViewClient_CurrentCellDirtyStateChanged(object sender, EventArgs e)
    {
        if (this.dataGridViewClient.IsCurrentCellDirty)
        {
            dataGridViewClient.CommitEdit(DataGridViewDataErrorContexts.Commit);
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-05T06:27:33.113

这里太容易了：

考虑您的复选框列是数据网格视图中的第二列。

```
private void YourDatagridview_CellValueChanged(object sender, DataGridViewCellEventArgs e)
    {
         if (IsHandleCreated)
        {
            if (YourDatagridview.CurrentCell == YourDatagridview.Rows[e.RowIndex].Cells[1])
            {
                if (Convert.ToBoolean(YourDatagridview.CurrentCell.Value) == true)
                {
                    for (int i = 0; i < YourDatagridview.RowCount; i++)
                    {
                        if (YourDatagridview.Rows[i].Cells[1] != YourDatagridview.CurrentCell)
                        {
                            YourDatagridview.Rows[i].Cells[1].Value = false;
                        }
                    }
                }
            }
        }
    } 
```

也叫这个：

```
private void YourDatagridview_CurrentCellDirtyStateChanged(object sender, EventArgs e)
    {
        if (this.YourDatagridview.IsCurrentCellDirty)
        {
            YourDatagridview.CommitEdit(DataGridViewDataErrorContexts.Commit);
        }
    } 
```

瞧！

# wcf - 通过“添加 Web 引用”添加 WCF 引用

> ID：10438616
> 
> 赞同：0
> 
> 时间：2012-05-03T20:10:02.220
> 
> 标签：wcf, .net-2.0, web-reference

我将 Visual Studio 2008 与一个面向 .NET 2.0 的项目一起使用。我需要添加对在同一解决方案中的另一个项目中定义的 WCF 服务的引用。WCF 项目面向 .NET 3.5，服务使用`basicHttpBinding`.

因为客户端项目配置为面向 .NET 2.0，所以我没有“添加服务引用”选项。当我尝试“添加 Web 引用”并选择“此解决方案中的 Web 服务”时，我收到以下消息：

![在当前解决方案中未找到 Web 服务。](../Images/fba81a9f8e248ee1d2ffd97584d2b9a6.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:13:19.070

Web 参考适用于传统的 ASMX 技术。“添加 Web 引用”自然不知道 WCF 甚至存在，所以它不知道解决方案中的您的 WCF 服务也就不足为奇了。它正在寻找 .asmx 文件。

首先尝试通过右键单击 .svc 文件并使用“在浏览器中查看”来启动您的服务。然后将服务的 URL 提供给“添加 Web 引用”对话框。此外，请确保您的服务公开其元数据，以便“?WSDL”将为添加 Web 引用生成 WSDL。

# c - 无法访问我的结构数组

> ID：10438619
> 
> 赞同：0
> 
> 时间：2012-05-03T20:10:22.093
> 
> 标签：c, arrays, struct

我已经声明了一个结构数组：

```
typedef struct{
int source;
int dest;
int type;
int port;
char data;
}test;

test packet[50]; 
```

我正在尝试访问数组并将其打印到屏幕上：

```
for (p = 0; p < i; p++)
{
    printf("%i", packet[p]);
} 
```

但我没有得到我所期望的。我是 C 的新手，所以对于这篇文章的任何问题，我深表歉意。只是要求更多信息，我会给它。我的逻辑完全错了吗？

在我的脑海中，我在一个数组中创建了 50 个结构实例，数组的每个元素都包含结构中的 5 个变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:12:11.763

自从我完成 C 以来已经有很多年了，但我认为它不会那样工作。您可能想要一一打印结构的成员变量。

```
for (p = 0; p < i; p++)
{
  printf("%i\n", packet[p].source);
  printf("%i\n", packet[p].dest);
  printf("%i\n", packet[p].type);
  printf("%i\n", packet[p].port);
} 
```

或者更好的是，制作一个方法，将其命名为类似的名称`printTest()`并让它执行上述操作。

在上面的示例中，您尝试打印整个对象，但这是行不通的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:44:19.607

给定

```
typedef struct{
int source;
int dest;
int type;
int port;
char data;
}test;

test packet[50]; 
```

您必须明确引用要访问的每个字段。在您的示例中，您希望打印结构的每个字段，因此您需要专门引用每个字段，如下所示：`printf("%i\n", packet[0].source);`

您的具体示例是在以 p 作为数组索引的 for 循环中，因此实际代码是`printf("%i\n", packet[p].source);`

最后，您可以轻松地讨论 C++ 中的一些 C 构造，但不能讨论 C 中的 C++ 构造，如类。

# ruby-on-rails - 如何使用 link_to rails 显示个人资料

> ID：10438623
> 
> 赞同：0
> 
> 时间：2012-05-03T20:10:43.467
> 
> 标签：ruby-on-rails, email, url, dynamic, hyperlink

最后，我们为我们的邮件生成了一个有用的链接。 [为电子邮件生成一个带有 rails 的真实 url](https://stackoverflow.com/questions/10437811/generate-an-real-url-with-rails-for-an-e-mail) 这工作得很好，非常好。但是我们想调用鞋子动作:-)

```
<%=link_to('Link', :controller => 'mycontroller', :action => 'show', :id => @mycontroller.id )%> 
```

网址看起来如此

```
http://localhost:3000/mycontroller/show/10 
```

我们需要这个结构

```
http://localhost:3000/mycontroller/10 
```

`rake routes`命令这样说

```
mycontroller GET    /mycontroller/:id(.:format)               mycontroller#show 
```

我们如何获得所需的结构？我们是否需要编辑我们的路线，还是有其他方法可以获得正确的 url？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:13:59.467

尝试使用路由助手

```
 mycontroller_url(@mycontroller.id) 
```

取而代之的是 {:controller => ..., :action => ...}

你的 link_to 助手应该看起来像这样更好的例子我使用用户显示操作

耙路线返回此

```
user GET  /users/:id(.:format) users#show 
```

现在我知道我可以使用 user_url(@user) 助手

```
<%=link_to('Link', user_url(@user) )%> 
```

# c++ - *nix 上的模板方法特化

> ID：10438624
> 
> 赞同：4
> 
> 时间：2012-05-03T20:10:50.437
> 
> 标签：c++, linux, templates, gcc

我有一个变体类，它使用一些函数模板专业化来获取和设置不同的类型，这些类型在 Visual Studio 2010 中编译和工作得很好。然而，这段代码位于一个通用解决方案中，它也需要在 redhat、ubuntu 等上编译。

我收到了一个关于非命名空间范围内显式专业化的错误。我认为简单的解决方法是简单地在类之外定义我的专业化，并在同一命名空间中为类使用范围限定符。

但是，现在我收到错误，即在实例化之后发生特化，因为用于从各种类型转换的类的其他方法正在类中使用此模板。

那么做这样的事情的正确方法是什么：

```
namespace Example
{
    class CSomeVariant
    {
    public:
        bool toString(std::string& out)
        {
            return get(out);
        }
    private:
        template <typename T>
        bool get(T& val)
        {
            try {
                val = boost::any_cast<T>(m_stored);
            }
            catch (...) {
                return false;
            }
            return true;
        }

        boost::any m_stored;
    };

    template<>
    bool CSomeVariant::get(std::string& val)
    {
        try {
            if (m_stored.type() != typeid(std::string))
               val = convertToString();
            else
               val = boost::any_cast<std::string>(m_stored);
        }
        catch(...) {
            return false;
        }
        return true;
    }
} 
```

注意：这不是实际代码，但我相信它显示了问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:19:43.727

问题是您`get()`在类定义中使用该函数，然后再对其进行专门化，这是不允许的。从 14.7.3 第 6 段

> 如果模板、成员模板或类模板的成员是显式特化的，则应在第一次使用该特化之前声明该特化，这将导致发生隐式实例化，在每个翻译单元中出现这种使用; 不需要诊断。如果程序没有为显式特化提供定义，并且该特化的使用方式会导致发生隐式实例化，或者该成员是虚拟成员函数，则该程序是格式错误的，不需要诊断。

一种解决方案是重新排序类定义，以便在任何使用之前声明特化。在这种情况下，我能够将函数的内联使用移动到专业化之后。

```
#include <string>
#include <boost/any.hpp>
namespace Example
{
    class CSomeVariant
    {
    public:
        bool toString(std::string& out);

    private:
       template <typename T>
       bool get(T& val)
       {
           try {
              val = boost::any_cast<T>(m_stored);
           }
           catch (...) {
               return false;
           }
           return true;
       }

       boost::any m_stored;
   };

   template<>
   bool CSomeVariant::get(std::string& val)
   {
       try {
           if (m_stored.type() != typeid(std::string))
              val = convertToString();
           else
              val = boost::any_cast<std::string>(m_stored);
       }
       catch(...) {
           return false;
       }
       return true;
   }

   inline bool CSomeVariant::toString(std::string& out)
   {
        return get(out);
   }
} 
```

# c++ - 使用C通过引用传递数组

> ID：10438625
> 
> 赞同：3
> 
> 时间：2012-05-03T20:10:54.387
> 
> 标签：c++, parameters, pass-by-reference

是的，我读过这个问题和答案：[Passing an array by reference in C?](https://stackoverflow.com/questions/1106957/pass-array-by-reference-in-c) . 我有一个类似的问题，并从那个问题中实现了相同的想法。

但是，我仍然从以下代码中得到一个错误：

```
#include <iostream>

void FillArray(int** myArray)
{
   free( *myArray ) ;
   * myArray = (int*) malloc(sizeof(int) * 2);

   *myArray[0] = 1;
   *myArray[1] = 2;
}

int main()
{
   int* myArray = NULL;
   FillArray(& myArray);    
   return 0;
} 
```

FillArray 函数结束后，我立即收到以下运行时错误：

> Program.exe 0xC00000005 中 0x773115de 处的未处理异常：访问冲突写入位置 0xcccccccccc。

我正在使用 Visual Studio，打开 Visual C++ 空项目。以及名为 main.cpp 的文件。这是否意味着它是用 C++ 编译器而不是 C 编译器编译的？如果是这样，我怎样才能打开一个只能编译 C 编译器的文件？我尝试用 main.c 重命名 main.cpp，但仍然有同样的问题。（我在问这个问题，因为我读了一些关于“按引用传递”的内容，发现它在 C 和 C++ 中是不同的。）

对不起这个非常基本的问题。

我将不胜感激任何帮助，

坐下。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-03T20:15:13.810

优先级没有按您预期的那样工作。试试这些：

```
(*myArray)[0] = 1;
(*myArray)[1] = 2; 
```

（注意：`iostream`不是 C。它是 C++。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:13:30.747

您的问题是运算符优先级之一。

运算符比运算`[]`符绑定得更紧密`*`，所以

```
*myArray[1] 
```

是相同的

```
*(myArray[1]). 
```

这是错误的，因为顶级指针只为一个指针分配了足够的内存。你要：

```
(*myArray)[1] = 2; 
```

附带说明一下，没有充分的理由像你一样混合 C 和 C++。很明显，这里有 C++ 代码，所以更喜欢一遍`new`又`delete`一遍`malloc`，`free`因为后两者没有考虑复杂对象的构造函数和析构函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:13:47.130

好的：

```
int main()
{
   int* myArray = NULL;
   FillArray(& myArray);   
   ... 
```

好的：

```
void FillArray(int** myArray)
{
   * myArray = (int*) malloc(sizeof(int) * 2); 
```

灾难性的糟糕：

```
void FillArray(int** myArray)
{
   free( *myArray ) ;
   * myArray = (int*) malloc(sizeof(int) * 2);
   ... 
```

更好的：

```
void FillArray (int** myArray)
{
   if (myArray)
     free (*myArray);
   *myArray = (int*) malloc(sizeof(int) * 2);
   ... 
```

还：

```
 *(myArray[0]) = 1;
   *(myArray[1]) = 2; 
```

# c# - 透明地获取 Facebook 个人资料图片

> ID：10438634
> 
> 赞同：0
> 
> 时间：2012-05-03T20:11:34.833
> 
> 标签：c#, facebook, asp.net-mvc-3, facebook-graph-api

我刚刚进入 Graph API，并且很难弄清楚是否/如何在**我的网站上显示****我**的个人资料相册，而无需让用户登录 facebook。我被访问令牌迷住了...我意识到如果有人登录该站点，我可以检索访问令牌来检索我的照片，但我希望它是透明的，通过代码使用我的凭据（安全) 如果有必要的话。

 **我怎样才能做到这一点？我正在寻找一般的概念解释，但伪代码永远不会受到伤害。任何人都可以为我澄清一下吗？

**使用：**
Facebook Javascript Sdk
Mirosoft MVC
[Facebook C# Sdk](http://csharpsdk.org/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T21:55:55.723

据我所知，没有办法做到这一点。

Facebook 应用程序对所有用户一视同仁，您不能对您的用户拥有特殊权限。如果您的用户是公开的，那么您应该能够使用不会过期的[应用程序访问令牌获得所有公众。](http://developers.facebook.com/docs/authentication/applications/)

如果不是这种情况，那么在我看来，您有两个选择。

对您的用户使用[服务器端身份验证](http://developers.facebook.com/docs/authentication/server-side/)，或[扩展一个有效令牌](http://developers.facebook.com/roadmap/offline-access-removal/)（一种替换“offline_access”权限的弃用方法），这将为您提供一个长寿命的令牌，大约 60 天，然后在那个时间范围内您可以从 facebook 获取您的数据。然后当过期时以相同的方式重新验证并获得另外 60 个工作日等。

另一种方法是以您自己的身份进行身份验证，然后让您的应用程序保存数据，然后从您自己的数据库中显示它。确保每隔一段时间更新一次数据。**

# sql - 等效于 winforms 中控件的 value-property

> ID：10438639
> 
> 赞同：1
> 
> 时间：2012-05-03T20:12:08.163
> 
> 标签：sql, database, vb.net, winforms

我习惯于 web 开发，当我使用数据库时，我通常使用一些文本作为`Text`单选按钮的 -property，并将行的 ID 作为`Value`-property。这使得保存到数据库变得非常容易。

-property在 winforms 中是等价的`Value`，还是我必须根据控件中的文本识别行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:02:02.203

作为一种通用的状态存储机制，[`Tag`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.tag.aspx)所有控件都有一个属性。你可以在里面放任何你喜欢的东西。

# android - Android Mediaplayer 播放带变量的本地文件

> ID：10438642
> 
> 赞同：0
> 
> 时间：2012-05-03T20:12:33.793
> 
> 标签：android, json, media-player, local

想知道是否有人可以帮助我弄清楚如何在 Android Mediaplayer 中播放本地音频/视频文件...我可以使用保存 URL 地址的变量从 URL 流式传输音频/视频，但是如何处理本地文件？如何使用localFile变量调用本地Files进行播放？感谢大家！

```
package com.ryanleckey2;

import android.media.MediaPlayer;
import android.net.Uri;
import android.os.Bundle;
import android.widget.MediaController;
import android.widget.VideoView;

public class Audio_Video_Stream extends  BT_activity_base{

    private String localFile = "";
    private String localFileName = "";
    private String dataURL = "";
    private String currentURL = "";
    public String thisActivityName = "Screen_Video";

    //movie controller
    String videoUrl;
    VideoView videoView;
    MediaController mediaController;
    public int isLoading;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.screen_video);

        //fill JSON properties...
        dataURL = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "dataURL", "");
        currentURL = dataURL;

        localFileName = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "localFileName", "");

                //setup the saveAsFileName
                if(localFileName.length() > 1){

                    //use the file name in the JSON data...
                localFile = localFileName;  

        //Log.i("ZZ", thisActivityName + ":videoUrl : " + videoUrl);   

        videoView = (VideoView) findViewById(R.id.videoView);
        mediaController = new MediaController(this);
        mediaController.setAnchorView(videoView);
        isLoading = 0;
        }

    }   

    ///////////////////////////////////////////////////
    //activity life-cycle overrides

    //onStart
    @Override 
    protected void onStart(){
        super.onStart();
        //Log.i("ZZ", thisActivityName + ":onStart");
    }

    //onResume
    @Override
    public void onResume() {
        super.onResume();

        if(isLoading == 1){
            if(videoView != null){
                videoView = null;
            }
        }
        startMovie();
        //Log.i("ZZ", thisActivityName + ":onResume");
    }

    //onPause
    @Override
    public void onPause() {
        //Log.i("ZZ", thisActivityName + ":onPause");
        super.onPause();

        if(videoView != null){
            videoView = null;
        }
    }

    //onStop
    @Override 
    protected void onStop(){
        super.onStop();

        //Log.i("ZZ", thisActivityName + ":onStop");
    }   

    //onDestroy
    @Override
    public void onDestroy() {
        //Log.i("ZZ", thisActivityName + ":onDestroy");
        super.onDestroy();
    }

    //activity life-cycle overrides
    ///////////////////////////////////////////////////

    //starts movie
    public void startMovie(){

        //show progress for a few seconds..
        showProgress("Starting media stream...", "Please be patient. If you're on 3G this could take a bit.\nWi-Fi is much better for streaming.");
        isLoading = 1;

        try{
            //set audio/video link (mp4,mp3 format )
            mediaController = new MediaController(this);
            Uri uri = Uri.parse(currentURL);
            //Uri       uri=Uri.parse("android.resource://"+getPackageName()+"/"+R.raw.);  
            videoView.setMediaController(mediaController);
            videoView.setVideoURI(uri);        
            videoView.setOnPreparedListener(mOnPreparedListener);

            videoView.start();

        }catch(Exception je){
        hideProgress();
            showAlert("Invalid URL","The URL to the media could not be determined. This screen will close.");
            finish();
        }

    }

    //onPrepared...
    private MediaPlayer.OnPreparedListener mOnPreparedListener = new MediaPlayer.OnPreparedListener(){
        public void onPrepared(MediaPlayer mp){
            //Log.i("ZZ", thisActivityName + ":OnPreparedListener");
            isLoading = 0;
        //  mp.setLooping(true);
        hideProgress();
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:11:41.067

我使用**媒体播放器**播放位于我的资产文件夹中的本地**音频文件。**这是我的代码片段。如果您需要帮助实施，请告诉我。这些代码行位于 try 方法中。

**更新**好的，我在这里在黑暗中拍摄，但让我们看看你是否可以用我的方法切换你的尝试方法。首先，使用这个导入：

`import android.content.res.AssetFileDescriptor;`

现在，在你的“尝试”括号内，试试这个：

```
 AssetFileDescriptor afd = getAssets().openFd("YOURSOUNDORVIDEO.mp3/mpg");  
 mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength()); 
 mp.prepare();
 mp.start(); //play sound or video 
```

在我的代码中，mp 代表媒体播放器。将其更改为您用来描述本地文件或播放器的任何内容，看看它是否有效。如果出现问题，Android 会告诉您出了什么问题。如果没有，那么我们将需要专业知识。但是你不能责怪一个菜鸟女孩的尝试，是吗？

# perl - 我在 Perl 的散列中声明散列有什么问题？

> ID：10438644
> 
> 赞同：1
> 
> 时间：2012-05-03T20:12:45.507
> 
> 标签：perl, hash, xml-simple

我正在努力处理 Perl 中的以下哈希声明：

```
my %xmlStructure = {
            hostname    =>  $dbHost,
            username    =>  $dbUsername,
            password    =>  $dbPassword,
            dev_table   =>  $dbTable,
            octopus     =>  {
                                alert_dir       =>  $alert_dir,
                                broadcast_id    =>  $broadcast_id,
                                system_id       =>  $system_id,
                                subkey          =>  $subkey
                            }
 }; 
```

我一直在谷歌搜索，但我无法提出解决方案，我所做的每一次修改都会导致另一个警告或我不想要的结果。

Perl 抱怨以下文本：

```
Reference found where even-sized list expected at ./configurator.pl line X. 
```

我这样做是因为我想使用该模块：

```
XML::Simple 
```

为了生成具有以下结构的 XML 文件：

```
 <settings>
  <username></username>
  <password></password>
  <database></database>
  <hostname></hostname>

  <dev_table></dev_table>

  <octopus>
      <alert_dir></alert_dir>
      <broadcast_id></broadcast_id>
      <subkey></subkey>
  </octopus>
 </settings> 
```

就像这样：

```
my $data = $xmlFile->XMLout(%xmlStructure);
warn Dumper($data); 
```

将显示后一个 xml 示例结构。

**更新：**

我忘了提到我还尝试使用括号而不是花括号作为哈希引用，尽管它似乎有效，但 XML 文件没有正确写入：我最终得到以下结构：

```
<settings>

 <dev_table>5L3IQWmNOw==</dev_table>
 <hostname>gQMgO3/hvMjc</hostname>

 <octopus>
  <alert_dir>l</alert_dir>
  <broadcast_id>l</broadcast_id>
  <subkey>l</subkey>
  <system_id>l</system_id>
 </octopus>

 <password>dZJomteHXg==</password>
 <username>sjfPIQ==</username>

</settings> 
```

这并不是完全错误的，但我不确定随着 XML 文件变大，我以后是否会遇到问题。凭据是使用 RC4 算法加密的，但我使用 base 64 编码以避免任何带有特殊字符的不当行为。谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T20:17:15.807

`{}`用于哈希引用。要声明散列，请使用普通括号`()`：

```
my %xmlStructure = (
            hostname    =>  $dbHost,
            username    =>  $dbUsername,
            password    =>  $dbPassword,
            dev_table   =>  $dbTable,
            octopus     =>  {
                                alert_dir       =>  $alert_dir,
                                broadcast_id    =>  $broadcast_id,
                                system_id       =>  $system_id,
                                subkey          =>  $subkey
                            }
 ); 
```

另请参阅[perldoc perldsc - Perl 数据结构说明书](http://perldoc.perl.org/perldsc.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T20:17:20.203

您正在使用花括号`{ ... }`来构造对匿名哈希的引用。您应该将其分配给标量，或将其更改`{ ... }`为标准括号`( ... )`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-03T20:35:43.957

对于第二个问题，您应该记住[XML::Simple](https://metacpan.org/module/XML%3a%3aSimple)对于大多数应用程序来说确实太简单了。如果您需要特定的布局，最好使用另一种生成 XML 的方式，例如使用[HTML::Template](https://metacpan.org/module/HTML%3a%3aTemplate)。例如（出于说明目的，我引用了变量名）：

```
#!/usr/bin/env perl

use strict; use warnings;
use HTML::Template;

my $tmpl = HTML::Template->new(filehandle => \*DATA);
$tmpl->param(
    hostname    =>  '$dbHost',
    username    =>  '$dbUsername',
    password    =>  '$dbPassword',
    dev_table   =>  '$dbTable',
    octopus     =>  [
        {
            alert_dir       =>  '$alert_dir',
            broadcast_id    =>  '$broadcast_id',
            system_id       =>  '$system_id',
            subkey          =>  '$subkey',
        }
    ]
);

print $tmpl->output;

__DATA__
<settings>
  <username><TMPL_VAR username></username>
  <password><TMPL_VAR password></password>
  <database><TMPL_VAR database></database>
  <hostname><TMPL_VAR hostname></hostname>

  <dev_table><TMPL_VAR dev_table></dev_table>

  <octopus><TMPL_LOOP octopus>
    <alert_dir><TMPL_VAR alert_dir></alert_dir>
    <broadcast_id><TMPL_VAR broadcast_id></broadcast_id>
    <subkey><TMPL_VAR subkey></subkey>
    <system_id><TMPL_VAR system_id></system_id>
  </TMPL_LOOP></octopus>
</settings> 
```

输出：

```
<settings>
  <username>$dbUsername</username>
  <password>$dbPassword</password>
  <database></database>
  <hostname>$dbHost</hostname>

  <dev_table>$dbTable</dev_table>

  <octopus>
    <alert_dir>$alert_dir</alert_dir>
    <broadcast_id>$broadcast_id</broadcast_id>
    <subkey>$subkey</subkey>
    <system_id>$system_id</system_id>
  </octopus>
</settings> 
```

# ruby-on-rails - 声明 Rails 模型子类的静态属性

> ID：10438647
> 
> 赞同：2
> 
> 时间：2012-05-03T20:12:59.257
> 
> 标签：ruby-on-rails, ruby, sti

我是 Ruby 和 Rails 的新手（和编程！），并试图找出将属性从模型传递给它的 STI 子代的惯用方式。

我有一个通用模型“文档”，以及一些从它继承的模型——让我们以“教程”为例。我有一个“图标”的字符串字段，我想在其中存储图标的文件名而不是完整路径（我认为路径应该取决于每个模型，因为它是检索记录数据的细节？）：

```
class Document < ActiveRecord::Base
  attr_accessible :title, :body, :icon

  @@asset_domain = "http://assets.example.com/"
  @@asset_path = "documents/"

  def icon
    @@asset_domain.to_s + @@asset_path.to_s + read_attribute(:icon).to_s
  end
end 
```

这是我想对子类做的事情，所以他们在适当的地方寻找他们的“图标”（或任何其他资产）。

```
class Tutorial < Document
  attr_accessible :title, :body, :icon

  @@asset_path = "tutorials/"

  # Other tutorial-only stuff
end 
```

我已经阅读了类变量并理解为什么我上面写的内容没有像我预期的那样工作，但是在教程类中覆盖“asset_path”的最佳方法是什么？我认为我不应该使用实例变量，因为值不需要更改每个模型实例。任何想法都非常感谢（即使这意味着重新考虑它！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:52:10.887

看起来您正在尝试创建一个可以重用于构建路径的常量值。我不会使用类变量，而是使用常量。

现在是安置问题：

## 在班上

如果它真的只需要在`Document`和继承自它的类中使用，请在堆栈顶部定义一个常量：

```
# document.rb
#
class Document < ActiveRecord::Base
  attr_accessible :title, :body, :icon

  ASSET_DOMAIN = "http://assets.example.com/"

end 
```

这将可以在`Document` `Tutorial`从这些对象继承的其他对象中访问。

## 环境.rb

如果这是您要在**任何地方**使用的值，那么向您的`environment.rb`. 这样你就不必记住在你放置它的所有类中重新定义它。

```
# environment.rb
#
# other config info
#
ASSET_DOMAIN = "http://assets.example.com/" 
```

然后你可以在任何你喜欢的地方建立链接，而不受类的限制：

```
# documents.rb
#
icon_path = ASSET_DOMAIN + path_and_file

# tutorial.rb
#
icon_path = ASSET_DOMAIN + path_and_file

# non_document_model.rb
#
icon_path = ASSET_DOMAIN + path_and_file 
```

这可能是社论，但红宝石学家在看到`@@`. 有时间和地点，但对于你想做的事情，我会使用一个常数并决定你需要把它放在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:44:09.827

您可以简单地从in覆盖该`icon`函数（因为它继承自它）并让它返回正确的路径。`Document``Tutorial`

这是面向对象编程中[多态](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)的经典案例。一个例子：

```
class Document
  attr_accessor :title, :body, :icon

  ASSET_DOMAIN = "http://assets.example.com/"

  def icon
    return ASSET_DOMAIN + "documents/" + "document_icon.png"
  end
end

class Tutorial < Document
  def icon
    return ASSET_DOMAIN + "tutorials/" + "tutorial_icon.png"
  end
end

d = Document.new
puts d.icon

i = Tutorial.new
puts i.icon 
```

输出：

```
http://assets.example.com/documents/document_icon.png
http://assets.example.com/tutorials/tutorial_icon.png 
```

请注意，因为`Tutorial`它是 的**子类**，`Document`所以它继承了它的字段和方法。因此`:title`，`:body`并且`:icon`不需要在内部重新定义`Tutorial`并且`icon`可以重新定义方法以给出所需的输出。`ASSET_DOMAIN`在这种情况下，将很少变化的值存储在常量中也是明智的。

# objective-c - 在 Cocoa-Touch 但不是 Cocoa 的标头中放置“const double NA = 1e-300”错误？

> ID：10438648
> 
> 赞同：0
> 
> 时间：2012-05-03T20:13:11.837
> 
> 标签：objective-c, xcode, cocoa-touch, cocoa

我试图放置`const double NA = 1e-300;`在 Cocoa-Touch 的头文件中，但 Xcode 不喜欢它。但是，当我在 Cocoa（64 位 MAC）中执行此操作时，它工作得很好。

？？？？？？

错误：

* * *

> /Users/jdl/Library/Developer/Xcode/DerivedData/iExperiment-chcmotcyeolxeacnidtlgofkcihz/Build/Intermediates/iExperiment.build/Debug-iphonesimulator/iExperiment.build/Objects-normal/i386/ViewController.o 和 /Users/ 中的重复符号 _NA jdl/Library/Developer/Xcode/DerivedData/iExperiment-chcmotcyeolxeacnidtlgofkcihz/Build/Intermediates/iExperiment.build/Debug-iphonesimulator/iExperiment.build/Objects-normal/i386/AppDelegate.o 架构 i386

* * *

> 命令 /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/clang 失败，退出代码为 1

* * *

```
#import <UIKit/UIKit.h>

const double NA = 1e-300; // <------------- Error in Cocoa-Touch but not Cocoa ??  
// So where do I put this so it doesn't error out in Cocoa-Touch?? 

@interface ViewController : UIViewController
{
    UITextView *tvText;
}
@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:22:15.960

头文件中定义的常量应如下所示：

```
__unused static const double NA = 1e-300; 
```

这`__unused`是为了抑制未使用变量的编译器警告，并`static`防止将常量暴露给链接器，这将解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T20:57:23.750

您收到错误的原因是您在包含 .h 文件的每个 .m 文件中声明并定义了一个名为“NA”的变量。所以链接器得到两个同名的变量，这是违反规则的。（C++/ObjC++ 有额外的规则来处理这个问题，但它们不会在 C/ObjC 中发挥作用。）

如果您不关心实际变量，则可以使用预处理器，如 kuba 的回答所述。

如果你想要一个实际的变量，你必须决定是让所有编译单元共享该变量，还是在每个编译单元中都有一个单独的副本。换句话说，你想要一个外部变量，还是一个静态变量？

对于外部：

视图控制器.h：

```
extern const double NA; 
```

视图控制器.m：

```
const double NA = 1e-300; 
```

对于静态：

视图控制器.h：

```
static const double NA = 1e-300; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:24:31.707

你可以定义一个：

```
#define NA 1e-300 
```

定义任何常量表达式。这将解决所有链接问题，因为该值被“放入”使用它的代码中，而不是使其成为（常量）变量。

# python - 你能帮我处理 Django 的 URL 正则表达式吗？

> ID：10438668
> 
> 赞同：0
> 
> 时间：2012-05-03T20:13:54.957
> 
> 标签：python, regex, django

目前，我的一个网址无法正常工作，因为我无法匹配它。我的 urls.py 中有以下条目

```
url(r'no_inventariado/nuevo/(?P<nombre>\S+)/(?P<serie>[a-zA-Z0-9_]*)/(?P<extension>\d{4})', 'inventario.views.nuevo_resguardo', name='nuevo_resguardo'),$ 
```

问题似乎出在`<nombre>`. 我使用的 url 包含大写、小写和空格`<nombre>`。

前任。

```
http://127.0.0.1:8000/inventario/no_inventariado/nuevo/LUIS%20%20RICARDO%20DAVID%20P/XXXBX7399F11/7070/ 
```

我该如何解决这个问题？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:23:05.863

如果您现在允许`\S+`, 表示任何非空白字符，并且您现在想要添加空格然后使用`.+?`

```
url(r'no_inventariado/nuevo/(?P<nombre>.+?)/(?P<serie>[a-zA-Z0-9_]*)/(?P<extension>\d{4})>     'inventario.views.nuevo_resguardo', name='nuevo_resguardo'),$ 
```

`+?`进行非贪婪匹配，意味着将`.+?`匹配每个字符，直到下一个斜杠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:23:54.127

`\S`应该匹配所有非空白字符，但`%20`示例中的 s 是编码空格。我不能肯定地说，但我猜空格在 GET 请求到达 url 处理程序之前被解码。您可以通过使用不带空格的名称进行测试来确认这一点。

如果这是问题，您可以通过使用捕获组`(?P<nombre>[^/]+)`来解决它（“所有不是正斜杠的东西”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:25:04.913

我做了一个简单的测试，它可以在我的机器上运行：

```
from django.conf.urls import patterns, include, url
from django.http import HttpResponse

def hello(request, nombre):
    return HttpResponse('Hello: '+nombre)

urlpatterns = patterns('',
    url(r'^(?P<nombre>[a-zA-Z\s]*)/$', hello),
) 
```

但它不适用于 \S

# ruby-on-rails - 在 Mac 中安装 wkhtmltopdf 以供 RoR 中的 imgkit gem 使用

> ID：10438670
> 
> 赞同：2
> 
> 时间：2012-05-03T20:14:06.877
> 
> 标签：ruby-on-rails, macos, gem, wkhtmltopdf

我正在尝试使用 IMGKit gem。所以我需要安装wkhtmtopdf软件。

以下命令不起作用： sudo imgkit --install-wkhtmltoimage ，所以我正在尝试手动安装它。

我为 Mac 下载了两个版本：一个是 .i386 文件，另一个是 4 个 .dylib 文件。

我怎样才能安装它们中的任何一个？为什么他们没有正常的安装程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T15:36:20.163

.i386 文件可以直接复制到 /usr/local/bin 并且我必须使其可执行 chmod u+x NAMEOFTHEFILE.i386

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:24:37.920

您可能想[看看 Homebrew](https://github.com/mxcl/homebrew/wiki/installation)。它简化了在 OSX 上安装许多工具和库的过程。

# php - 在插入数据库之前检查项目的唯一性

> ID：10438673
> 
> 赞同：2
> 
> 时间：2012-05-03T20:14:11.407
> 
> 标签：php, mysql, performance

我目前正在开展一个项目，其中对 API 的访问仅限于注册用户。API 本身已经完成并按预期工作。限制对 API 的访问也变得相当简单。但是，我的问题（或者更确切地说是问题）是如何确保注册、验证和/或失物招领过程的数据库交互效率。

这是当前发生的情况的示例：

1.  用户通过输入他们的电子邮件地址请求 API 密钥
2.  用户收到一封验证电子邮件
3.  用户单击电子邮件中的链接，php 检查数据库的哈希值
4.  验证哈希后，生成、存储 API 密钥并通过电子邮件发送
5.  如果用户忘记/丢失 API 密钥，可以再次通过电子邮件发送
6.  如果没有收到验证邮件，可以再次发送邮件

这是数据库结构的示例： http: [//s13.postimage.org/h8ao5oo2v/dbstructure.png](http://s13.postimage.org/h8ao5oo2v/dbstructure.png)

正如您可能想象的那样，对于流程中的每个特定步骤，幕后都在进行大量的数据库交互。我想知道效率的一个步骤是检查某些项目的唯一性。显然，我们不希望出现任何重复的 API 密钥，也不希望出现任何重复的电子邮件验证哈希。

所以，我写了一个简单的函数，在将它们插入数据库之前检查数据库中的这些东西。然而，这个项目比我以前做过的任何项目都要大数百倍。我之前构建并维护过为 500 到 1,000 名用户提供服务的项目……但据估计，该项目每天至少为大约 50,000 名用户提供服务。我非常高兴我终于完成了一个大型项目，但对它的规模越来越感到畏惧。

无论如何，这是我编写的用于与数据库交互以在存储项目之前检查项目的唯一性的函数。

```
function isUnique($table, $col, $data) {
  mysql_connect("localhost", "root", "") or die(mysql_error());  
  mysql_select_db("api") or die(mysql_error());
  $check = mysql_query("SELECT ".$col." FROM ".$table." WHERE ".$col."='".$data."'");
  $match = mysql_num_rows($check);
  if($match < 1) {
    return true;
  }
  return false;
  mysql_close('localhost');
} 
```

此函数与另一个函数结合使用，该函数仅生成一个随机的 40 位 0-9、az 和 AZ 字符串，用于电子邮件验证哈希以及 API 密钥本身。（功能如下）

```
function makeRandom($length = 40) {
  $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
  $randomString = '';
  for($i = 0; $i < $length; $i++) {
    $randomString .= $characters[mt_rand(0, strlen($characters) - 1)];
  }
  return $randomString;
} 
```

然后将这两个功能的组合用于与 API 密钥颁发相关的 3 个不同页面：第一页用于注册/请求，第二页用于验证电子邮件，第三页用于丢失密钥或未收到的电子邮件。现在在实践中：

```
$hash   = makeRandom();
$unique = isUnique('users', 'hash', $hash);
if($unique == false) {
  while($unique == false) {
    $hash   = makeRandom();
    $unique = isUnique('users', 'hash', $hash);
  }
}
else {
  $searchactive   = mysql_query("SELECT email, active FROM users WHERE email='".$email."' AND active='1'") or die(mysql_error());
  $matchactive    = mysql_num_rows($searchactive);
  $searchinactive = mysql_query("SELECT email, active FROM users WHERE email='".$email."' AND active='0'") or die(mysql_error());
  $matchinactive  = mysql_num_rows($searchinactive);

  if($matchactive > 0) {
    $hash = mysql_query("SELECT hash FROM users WHERE email='".$email."' AND active='1'") or die(mysql_error());
    $hash = mysql_fetch_assoc($hash);
    $hash = $hash['hash'];
    $msg = 'The email address you entered is already associated with an active API key. <a href="lost.php?email='.$email.'&amp;hash='.$hash.'&active=1">[Recover Lost API Key]</a>';
  }
  elseif($matchinactive > 0) {
    $hash = mysql_query("SELECT hash FROM users WHERE email='".$email."' AND active='0'") or die(mysql_error());
    $hash = mysql_fetch_assoc($hash);
    $hash = $hash['hash'];
    $msg = 'The email address you entered is already pending verification. <a href="lost.php?email='.$email.'&amp;hash='.$hash.'&active=0">[Resend Verification Email]</a>';
  }
} 
```

我的主要问题是：对于这样一个（看似）简单的功能进行这么多的查询，这会产生比它解决的问题更多的问题吗？出于明显的原因，我确实需要确保没有任何重复的验证哈希或 API 密钥。但是，估计有 50k 人在使用此功能，这是否会因为 SQL 查询的数量而使服务器陷入困境？主要问题是由于 while() 循环用于在插入之前检查生成的内容的唯一性。

我知道这不是幕后发生的事情的完整画面，但它确实为其余页面的工作方式提供了线索。如果需要有关整个过程的更多信息，我很乐意发布。

感谢您提供的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:20:05.610

解决此问题的一种方法是不检查重复项，而只是确保它们从一开始就不会发生。因此，只需对您的用户表进行版本化（为版本添加一个字段）。这将只是一个在用户行更改时前进的 int。

然后，当您生成随机密钥时，在存储密钥之前将 user_id 和 user_version 添加到其中。

例子：

11ap0w9jfoaiwej203989wesef

其中第一个 1 是 user_id，第二个 1 是用户版本。

然后，即使在统计上很小的机会生成两次大密钥，它也将始终是唯一的，因为您的用户 ID 将是唯一的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:28:54.333

我会考虑使用 UUID 而不是滚动您自己的随机字符串。出于所有实际目的，这将是一个独特的价值。

[http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_uuid](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_uuid)

# javascript - 使用 jQuery ajax 请求外部网站数据

> ID：10438683
> 
> 赞同：2
> 
> 时间：2012-05-03T20:14:48.140
> 
> 标签：javascript, jquery, ajax, same-origin-policy

我已经尝试阅读有关此内容的信息，但不确定从哪里开始，因此希望有人能够为我指明正确的方向。

基本上我正在尝试使用 jQuery ajax 来读取外部网站并从中检索链接列表。目前没有什么特别的原因，只是想看看我是否可以通过这样做来挑战自己。

在这样做的过程中，我已经阅读了一些关于同源政策的内容并理解了它（有点），但可以用一些指针来做。

这可能吗？例如，我一直在查看 Kate Spanos 使用的拼字游戏积分计算器，她的 jQuery 代码包含一些似乎可以检查字典网站并处理某些输出的 ajax。

有人能指出我正确的方向吗，或者我是在吠叫错误的树，如果没有其他一些技术知识，基本上是不可能的。

谢谢，垫

PS我是一个“菜鸟”，所以请尽可能温柔。我们都必须从这些东西的某个地方开始，所以请不要把我击倒......在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:18:15.110

您应该研究 JSONP，或者更有可能使用某种中介，例如使用 cURL 或 file_get_contents 访问第三方站点的 PHP 脚本（所以相同的来源）

例如：

```
<?php
$file=file_get_contents('http://some_domain_not_yours.com/somefile');
echo $file;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:27:55.577

尝试参考这些，希望对您有所帮助

[带有 jquery 的 jsonp](https://stackoverflow.com/questions/2681466/jsonp-with-jquery)

[http://www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

[http://api.jquery.com/jQuery.getJSON/#jsonp](http://api.jquery.com/jQuery.getJSON/#jsonp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:29:30.043

您应该通过 PHP 执行此操作，即通过 PHP 加载包括外部站点，然后在您的 PHP 中解析它。

你不能通过 jQuery 做到这一点，基本上你不能让客户端在没有服务器端过滤它的情况下检索远程内容。如果客户端可以自由访问远程内容，您将无法控制 SOP 的数据访问，您始终需要一个服务器来保证内容管理和过滤，这可以是您的服​​务器或远程服务器（如 API提供者）。为了确保这一点，您只能跨域共享 JSON 对象，JSON 对象是通过 PHP 创建的对象（例如），因此您无法在没有服务器脚本的情况下获取 JSON 对象。另一种方式（您的服务器介于两者之间）是您创建一个服务器来检索远程内容，然后以您喜欢的任何格式将其提供给您的客户端。

# android - 为什么这个移动的圆圈在拖动过程中会振动？

> ID：10438689
> 
> 赞同：2
> 
> 时间：2012-05-03T20:15:16.557
> 
> 标签：android, event-handling, drawing

我自己写了`extends View`，但效果不好。它的目的是允许拖动红色圆圈。不幸的是，圆在拖动过程中会振动，即移动不顺畅：

```
public class FieldView extends View {

private int cellWidth;
private int cellHeight;
private float startleft, starttop;
private float startx, starty;

private Paint paint;

public FieldView(Context context) {
    super(context);

    paint = new Paint();
    paint.setColor(Color.RED);

}

@Override
protected void onDraw(Canvas canvas) {

    canvas.drawOval(new RectF(
            getTranslationX()-(float)cellWidth/2f, 
            getTranslationY() - (float)cellHeight/2f, 
            getTranslationX() + (float)cellWidth/2f, 
            getTranslationY() + (float)cellHeight/2f), paint);

}

public void setCellWidth(int value) {
    this.cellWidth = value;
}

public void setCellHeight(int value) {
    this.cellHeight = value;
}

@Override
public boolean onTouchEvent(MotionEvent event) {

    if( event.getActionMasked() == MotionEvent.ACTION_DOWN ) {
        startx = event.getX();
        starty = event.getY();
        startleft = getTranslationX();
        starttop = getTranslationY();
        return true;
    }

    else if( event.getActionMasked() == MotionEvent.ACTION_UP ) {

        setTranslationX( startleft + (event.getX() - startx) );
        setTranslationY( starttop + (event.getY() - starty) );

        invalidate();

        startx = starty = 0;
        return true;
    }

    else if( event.getActionMasked() == MotionEvent.ACTION_MOVE ) {
        setTranslationX( startleft + (event.getX() - startx) );
        setTranslationY( starttop + (event.getY() - starty) );

        invalidate();

        return true;
    }

    else {
        return false;
    }

}

 } 
```

亚军：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    FieldView fieldView = new FieldView(this);

    fieldView.setCellHeight(100);
    fieldView.setCellWidth(100);

    setContentView(fieldView);

} 
```

问题是：为什么？

**编辑 1**

我认为这不是噪音，因为跳跃的幅度相对较大。

**固定的**

这是一个错误。我对 get/setTranslationX/Y() 的使用干扰了触摸事件坐标。显然，事件考虑了翻译。当我切换到自己的翻译领域时，振动消失了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:23:12.867

触摸屏不是完美的设备，坐标中会有一些噪音。更新太频繁，尤其是没有任何平滑处理，会导致圆因为报告坐标中的噪声而跳动。

可能您想做以下一项或两项：

*   不那么频繁地更新，或者特别是仅在坐标至少发生最小量的变化时才更新

*   实现平滑过滤器，例如运行平均值或更高级的算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:26:59.953

我只简单地使用过触摸界面，但我想如果你的手指和大多数其他手指一样，它们会同时触摸屏幕上的许多地方。

你得到的反馈可能更符合触摸时屏幕上最大点的平均值。

尝试平均您将处理的 onTouchEvent 的数量。将其设置为设定的 fps，以便忽略一些调用，但仍具有足够高的 FPS 以创建良好的平滑拖动。

您可能还想进行某种输入过滤/平均，以便接收到的点永远不会大于接收到的前 X 个输入量的平均值。因此，如果您的手指（像我的一样）有点矮胖，它会自行变平。

# objective-c - 使用循环以编程方式添加 NSMutableArray 时出错

> ID：10438690
> 
> 赞同：1
> 
> 时间：2012-05-03T20:15:24.130
> 
> 标签：objective-c, ios, xcode, ios5.1

我正在尝试将我从 NSURL 获得的数组添加到使用 for 循环的数组中：

```
(int i = 0; i < 10; i++) 
```

使其成为二维数组。不断收到 NSRangeException 错误。它只能在 index[0] 处插入对象或添加对象，当 'i' 增加到 1 时，它会引发错误。它只能意味着它不是添加而是覆盖，所以当它第二次覆盖并且 i = 1 时，它会抛出错误。如何添加更多而不是覆盖初始化的二维数组？

```
- (void)qBlock{
    for (int i = 0; i < 10; i++) {
        NSURL *url = [NSURL URLWithString:@"http://somefiles.php"];
        NSError *error;
        NSStringEncoding encoding;
        NSString *response = [[NSString alloc] initWithContentsOfURL:url 
                                                        usedEncoding:&encoding 
                                                               error:&error];
        if (response) {

            const char *convert = [response UTF8String];
            NSString *responseString = [NSString stringWithUTF8String:convert];
            NSMutableArray *sample = [responseString JSONValue];

            block = [[NSMutableArray alloc]init];
        [block insertObject:sample atIndex:i];
        }

    else {
        UIAlertView *alert1 = [[UIAlertView alloc]initWithTitle:@"ALERT" message:@"Internet Connection cannot be established." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert1 show];
    }
}
//Calling 10 blocks of codes
for (id obj in block) {
    NSLog(@"%@",obj);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:25:04.667

这：

```
 block = [[NSMutableArray alloc]init];
    [block insertObject:sample atIndex:i]; 
```

在通过 for 循环的每次迭代中，将整个块数组替换为一个空数组。

将块数组初始化移到 for 循环之外。

# javascript - JavaScript 警报在新 Firefox 中的 z-index 为 0

> ID：10438692
> 
> 赞同：1
> 
> 时间：2012-05-03T20:15:27.897
> 
> 标签：javascript, firefox, cross-browser, alert

我有一个*1*`z-index`的DIV 。有一个单击事件处理程序附加到 DIV 的子元素。

 *引发事件时会显示警报。在新的 Firefox 中，无论出于何种原因，警报的 a`z-index`为*0*，因此显示在索引为*1的 DIV***后面**。

 *我可以做些什么来确保警报可见？**

# java - Java - 将命名的 html 实体转换为编号的 xml 实体

> ID：10438694
> 
> 赞同：8
> 
> 时间：2012-05-03T20:15:38.257
> 
> 标签：java, html, xml, parsing, entities

我正在寻找将包含 html 命名实体的 html 块转换为使用编号的 xml 实体的 xml 兼容块，同时保留所有 html 标记元素。

这是通过测试说明的基本思想：

```
@Test
public void testEvalHtmlEntitiesToXmlEntities() {
    String input = "<a href=\"test.html\">link&nbsp;</a>";
    String expected = "<a href=\"test.html\">link&#160;</a>";
    String actual = SomeUtil.eval(input);
    Assert.assertEquals(expected, actual);
} 
```

有人知道提供此功能的类吗？我可以编写一个正则表达式来遍历非元素匹配并执行以下操作：

```
xlmString += StringEscapeUtils.escapeXml(StringEscapeUtils.unescapeHtml(htmlString)); 
```

但希望有一种更简单的方法或已经提供此功能的类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-05T14:54:29.623

这就是我最终使用的。似乎工作正常：

```
/**
 * Some helper methods for XHTML => HTML manipulation
 * 
 * @author David Maple<d@davemaple.com>
 *
 */
public class XhtmlUtil {

    private static final Pattern ENTITY_PATTERN = Pattern.compile("(&[^\\s]+?;)");

    /**
     * Don't instantiate me
     */
    private XhtmlUtil() { } 

    /**
     * Convert a String of HTML with named HTML entities to the 
     * same String with entities converted to numbered XML entities 
     * 
     * @param html
     * @return xhtml
     */
    public static String htmlToXmlEntities(String html) {
        StringBuffer stringBuffer = new StringBuffer();
        Matcher matcher = ENTITY_PATTERN.matcher(html);

        while (matcher.find()) {
            String replacement = htmlEntityToXmlEntity(matcher.group(1));
            matcher.appendReplacement(stringBuffer, "");
            stringBuffer.append(replacement);
        }

        matcher.appendTail(stringBuffer);
        return stringBuffer.toString();
    }

    /**
     * Replace an HTML entity with an XML entity
     * 
     * @param htmlEntity
     * @return xmlEntity
     */
    private static String htmlEntityToXmlEntity(String html) {
        return StringEscapeUtils.escapeXml(StringEscapeUtils.unescapeHtml(html));
    }

} 
```

和相应的测试：

```
public class XhtmlUtilTest {

    @Test
    public void testEvalXmlEscape() {
        String input = "link 1 &nbsp;|&nbsp; link2 &amp; & dkdk;";
        String expected = "link 1 &#160;|&#160; link2 &amp; & dkdk;";
        String actual = XhtmlUtil.htmlToXmlEntities(input);
        System.out.println(actual);
        Assert.assertEquals(expected, actual);
    }

    @Test
    public void testEvalXmlEscape2() {
        String input = "<a href=\"test.html\">link&nbsp;</a>";
        String expected = "<a href=\"test.html\">link&#160;</a>";
        String actual = XhtmlUtil.htmlToXmlEntities(input);
        System.out.println(actual);
        Assert.assertEquals(expected, actual);
    }

    @Test
    public void testEvalXmlEscapeMultiLine() {
        String input = "<a href=\"test.html\">link&nbsp;</a>\n<a href=\"test.html\">link&nbsp;</a>";
        String expected = "<a href=\"test.html\">link&#160;</a>\n<a href=\"test.html\">link&#160;</a>";
        String actual = XhtmlUtil.htmlToXmlEntities(input);
        System.out.println(actual);
        Assert.assertEquals(expected, actual);
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T20:46:26.813

你试过[JTidy](http://jtidy.sourceforge.net/)吗？

```
private String cleanData(String data) throws UnsupportedEncodingException {
    Tidy tidy = new Tidy();
    tidy.setInputEncoding("UTF-8");
    tidy.setOutputEncoding("UTF-8");
    tidy.setPrintBodyOnly(true); // only print the content
    tidy.setXmlOut(true); // to XML
    tidy.setSmartIndent(true); 
    ByteArrayInputStream inputStream = new ByteArrayInputStream(data.getBytes("UTF-8"));
    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    tidy.parseDOM(inputStream, outputStream);
    return outputStream.toString("UTF-8");
} 
```

虽然我认为它会修复你的一些 HTML 代码，以防万一。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-04T15:06:53.047

这可能对你有用。

```
private static Map<String, String> entityMap = new HashMap<String, String>();
static{
    entityMap.put("nbsp", "&#160;");
    entityMap.put("iexcl", "&#161;");
    entityMap.put("cent", "&#162;");
    entityMap.put("pound", "&#163;");
    entityMap.put("curren", "&#164;");
    entityMap.put("yen", "&#165;");
    entityMap.put("brvbar", "&#166;");
    entityMap.put("sect", "&#167;");
    entityMap.put("uml", "&#168;");
    entityMap.put("copy", "&#169;");
    entityMap.put("ordf", "&#170;");
    entityMap.put("laquo", "&#171;");
    entityMap.put("not", "&#172;");
    entityMap.put("shy", "&#173;");
    entityMap.put("reg", "&#174;");
    entityMap.put("macr", "&#175;");
    entityMap.put("deg", "&#176;");
    entityMap.put("plusmn", "&#177;");
    entityMap.put("sup2", "&#178;");
    entityMap.put("sup3", "&#179;");
    entityMap.put("acute", "&#180;");
    entityMap.put("micro", "&#181;");
    entityMap.put("para", "&#182;");
    entityMap.put("middot", "&#183;");
    entityMap.put("cedil", "&#184;");
    entityMap.put("sup1", "&#185;");
    entityMap.put("ordm", "&#186;");
    entityMap.put("raquo", "&#187;");
    entityMap.put("frac14", "&#188;");
    entityMap.put("frac12", "&#189;");
    entityMap.put("frac34", "&#190;");
    entityMap.put("iquest", "&#191;");
    entityMap.put("Agrave", "&#192;");
    entityMap.put("Aacute", "&#193;");
    entityMap.put("Acirc", "&#194;");
    entityMap.put("Atilde", "&#195;");
    entityMap.put("Auml", "&#196;");
    entityMap.put("Aring", "&#197;");
    entityMap.put("AElig", "&#198;");
    entityMap.put("Ccedil", "&#199;");
    entityMap.put("Egrave", "&#200;");
    entityMap.put("Eacute", "&#201;");
    entityMap.put("Ecirc", "&#202;");
    entityMap.put("Euml", "&#203;");
    entityMap.put("Igrave", "&#204;");
    entityMap.put("Iacute", "&#205;");
    entityMap.put("Icirc", "&#206;");
    entityMap.put("Iuml", "&#207;");
    entityMap.put("ETH", "&#208;");
    entityMap.put("Ntilde", "&#209;");
    entityMap.put("Ograve", "&#210;");
    entityMap.put("Oacute", "&#211;");
    entityMap.put("Ocirc", "&#212;");
    entityMap.put("Otilde", "&#213;");
    entityMap.put("Ouml", "&#214;");
    entityMap.put("times", "&#215;");
    entityMap.put("Oslash", "&#216;");
    entityMap.put("Ugrave", "&#217;");
    entityMap.put("Uacute", "&#218;");
    entityMap.put("Ucirc", "&#219;");
    entityMap.put("Uuml", "&#220;");
    entityMap.put("Yacute", "&#221;");
    entityMap.put("THORN", "&#222;");
    entityMap.put("szlig", "&#223;");
    entityMap.put("agrave", "&#224;");
    entityMap.put("aacute", "&#225;");
    entityMap.put("acirc", "&#226;");
    entityMap.put("atilde", "&#227;");
    entityMap.put("auml", "&#228;");
    entityMap.put("aring", "&#229;");
    entityMap.put("aelig", "&#230;");
    entityMap.put("ccedil", "&#231;");
    entityMap.put("egrave", "&#232;");
    entityMap.put("eacute", "&#233;");
    entityMap.put("ecirc", "&#234;");
    entityMap.put("euml", "&#235;");
    entityMap.put("igrave", "&#236;");
    entityMap.put("iacute", "&#237;");
    entityMap.put("icirc", "&#238;");
    entityMap.put("iuml", "&#239;");
    entityMap.put("eth", "&#240;");
    entityMap.put("ntilde", "&#241;");
    entityMap.put("ograve", "&#242;");
    entityMap.put("oacute", "&#243;");
    entityMap.put("ocirc", "&#244;");
    entityMap.put("otilde", "&#245;");
    entityMap.put("ouml", "&#246;");
    entityMap.put("divide", "&#247;");
    entityMap.put("oslash", "&#248;");
    entityMap.put("ugrave", "&#249;");
    entityMap.put("uacute", "&#250;");
    entityMap.put("ucirc", "&#251;");
    entityMap.put("uuml", "&#252;");
    entityMap.put("yacute", "&#253;");
    entityMap.put("thorn", "&#254;");
    entityMap.put("yuml", "&#255;");
    entityMap.put("fnof", "&#192;");
    entityMap.put("Alpha", "&#913;");
    entityMap.put("Beta", "&#914;");
    entityMap.put("Gamma", "&#915;");
    entityMap.put("Delta", "&#916;");
    entityMap.put("Epsilon", "&#917;");
    entityMap.put("Zeta", "&#918;");
    entityMap.put("Eta", "&#919;");
    entityMap.put("Theta", "&#920;");
    entityMap.put("Iota", "&#921;");
    entityMap.put("Kappa", "&#922;");
    entityMap.put("Lambda", "&#923;");
    entityMap.put("Mu", "&#924;");
    entityMap.put("Nu", "&#925;");
    entityMap.put("Xi", "&#926;");
    entityMap.put("Omicron", "&#927;");
    entityMap.put("Pi", "&#928;");
    entityMap.put("Rho", "&#929;");
    entityMap.put("Sigma", "&#931;");
    entityMap.put("Tau", "&#932;");
    entityMap.put("Upsi", "&#933;");
    entityMap.put("Phi", "&#934;");
    entityMap.put("Chi", "&#935;");
    entityMap.put("Psi", "&#936;");
    entityMap.put("Omega", "&#937;");
    entityMap.put("alpha", "&#945;");
    entityMap.put("beta", "&#946;");
    entityMap.put("gamma", "&#947;");
    entityMap.put("delta", "&#948;");
    entityMap.put("epsi", "&#949;");
    entityMap.put("zeta", "&#950;");
    entityMap.put("eta", "&#951;");
    entityMap.put("theta", "&#952;");
    entityMap.put("iota", "&#953;");
    entityMap.put("kappa", "&#954;");
    entityMap.put("lambda", "&#955;");
    entityMap.put("mu", "&#956;");
    entityMap.put("nu", "&#957;");
    entityMap.put("xi", "&#958;");
    entityMap.put("omicron", "&#959;");
    entityMap.put("pi", "&#960;");
    entityMap.put("rho", "&#961;");
    entityMap.put("sigmaf", "&#962;");
    entityMap.put("sigma", "&#963;");
    entityMap.put("tau", "&#964;");
    entityMap.put("upsi", "&#965;");
    entityMap.put("phi", "&#966;");
    entityMap.put("chi", "&#967;");
    entityMap.put("psi", "&#968;");
    entityMap.put("omega", "&#969;");
    entityMap.put("theta", "&#977;");
    entityMap.put("upsih", "&#978;");
    entityMap.put("piv", "&#982;");
    entityMap.put("bull", "&#8226;");
    entityMap.put("hellip", "&#8230;");
    entityMap.put("prime", "&#8242;");
    entityMap.put("Prime", "&#8243;");
    entityMap.put("oline", "&#8254;");
    entityMap.put("frasl", "&#8260;");
    entityMap.put("weierp", "&#8472;");
    entityMap.put("image", "&#8465;");
    entityMap.put("real", "&#8476;");
    entityMap.put("trade", "&#8482;");
    entityMap.put("alefsym", "&#8501;");
    entityMap.put("larr", "&#8592;");
    entityMap.put("uarr", "&#8593;");
    entityMap.put("rarr", "&#8594;");
    entityMap.put("darr", "&#8595;");
    entityMap.put("harr", "&#8596;");
    entityMap.put("crarr", "&#8629;");
    entityMap.put("lArr", "&#8656;");
    entityMap.put("uArr", "&#8657;");
    entityMap.put("rArr", "&#8658;");
    entityMap.put("dArr", "&#8659;");
    entityMap.put("hArr", "&#8660;");
    entityMap.put("forall", "&#8704;");
    entityMap.put("part", "&#8706;");
    entityMap.put("exist", "&#8707;");
    entityMap.put("empty", "&#8709;");
    entityMap.put("nabla", "&#8711;");
    entityMap.put("isin", "&#8712;");
    entityMap.put("notin", "&#8713;");
    entityMap.put("ni", "&#8715;");
    entityMap.put("prod", "&#8719;");
    entityMap.put("sum", "&#8722;");
    entityMap.put("minus", "&#8722;");
    entityMap.put("lowast", "&#8727;");
    entityMap.put("radic", "&#8730;");
    entityMap.put("prop", "&#8733;");
    entityMap.put("infin", "&#8734;");
    entityMap.put("ang", "&#8736;");
    entityMap.put("and", "&#8869;");
    entityMap.put("or", "&#8870;");
    entityMap.put("cap", "&#8745;");
    entityMap.put("cup", "&#8746;");
    entityMap.put("int", "&#8747;");
    entityMap.put("there4", "&#8756;");
    entityMap.put("sim", "&#8764;");
    entityMap.put("cong", "&#8773;");
    entityMap.put("asymp", "&#8773;");
    entityMap.put("ne", "&#8800;");
    entityMap.put("equiv", "&#8801;");
    entityMap.put("le", "&#8804;");
    entityMap.put("ge", "&#8805;");
    entityMap.put("sub", "&#8834;");
    entityMap.put("sup", "&#8835;");

    entityMap.put("nsub", "&#8836;");
    entityMap.put("sube", "&#8838;");
    entityMap.put("supe", "&#8839;");
    entityMap.put("oplus", "&#8853;");
    entityMap.put("otimes", "&#8855;");
    entityMap.put("perp", "&#8869;");
    entityMap.put("sdot", "&#8901;");

    entityMap.put("lceil", "&#8968;");
    entityMap.put("rceil", "&#8969;");
    entityMap.put("lfloor", "&#8970;");
    entityMap.put("rfloor", "&#8971;");
    entityMap.put("lang", "&#9001;");

    entityMap.put("loz", "&#9674;");

    entityMap.put("spades", "&#9824;");
    entityMap.put("clubs", "&#9827;");
    entityMap.put("hearts", "&#9829;");
    entityMap.put("diams", "&#9830;");

    entityMap.put("quot", "&#34;");
    entityMap.put("amp", "&#38;");
    entityMap.put("lt", "&#60;");
    entityMap.put("gt", "&#62;");

    entityMap.put("OElig", "&#338;");
    entityMap.put("oelig", "&#339;");
    entityMap.put("Scaron", "&#352;");
    entityMap.put("scaron", "&#353;");
    entityMap.put("Yuml", "&#376;");

    entityMap.put("circ", "&#710;");
    entityMap.put("tilde", "&#732;");

    entityMap.put("ensp", "&#8194;");
    entityMap.put("emsp", "&#8195;");
    entityMap.put("thinsp", "&#8201;");
    entityMap.put("zwnj", "&#8204;");
    entityMap.put("zwj", "&#8205;");
    entityMap.put("lrm", "&#8206;");
    entityMap.put("rlm", "&#8207;");
    entityMap.put("ndash", "&#8211;");
    entityMap.put("mdash", "&#8212;");
    entityMap.put("lsquo", "&#8216;");
    entityMap.put("rsquo", "&#8217;");
    entityMap.put("sbquo", "&#8218;");
    entityMap.put("ldquo", "&#8220;");
    entityMap.put("rdquo", "&#8221;");
    entityMap.put("bdquo", "&#8222;");
    entityMap.put("dagger", "&#8224;");
    entityMap.put("Dagger", "&#8225;");
    entityMap.put("permil", "&#8240;");
    entityMap.put("lsaquo", "&#8249;");
    entityMap.put("rsaquo", "&#8250;");
} 
```

然后我只是将数据作为 DOCTYPE 附加到文档中

```
 StringBuffer buffer = new StringBuffer();
        buffer.append("<?xml version=\"1.0\"?> " + " <!DOCTYPE some_name [ ");
        Iterator<Entry<String, String>> iterator = entityMap.entrySet().iterator();
        while (iterator.hasNext()) {
            Entry<String, String> entry = iterator.next();
            buffer.append("<!ENTITY " + entry.getKey() + " \"" + entry.getValue() + "\">");
        }
        buffer.append(" ]>");

        convertedData = buffer.toString() + convertedData; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-04T15:40:11.663

如果您的类路径中已经有 commons-lang，请查看 ; 中的数组`EntityArrays`。它们包含所有实体的映射。

要获取数值，只需`codePointAt(0)`在第一个元素（Unicode 字符）上使用。

现在您需要一个基于正则表达式的循环来搜索`&[^;]+;`. 这是非常安全的，因为`&`它是一个需要转义的特殊字符。如果您需要 100% 确定，请查找 CDATA 元素并忽略它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-04T16:29:08.937

这是我使用的另一种解决方案

```
 /**
     * Converts the specified string which is in ASCII format to legal XML
     * format. Inspired by XMLWriter by http://www.megginson.com/Software/
     */
    public static String convertAsciiToXml(String string) {
        if (string == null || string.equals(""))
            return "";

        StringBuffer sbuf = new StringBuffer();
        char ch[] = string.toCharArray();
        for (int i = 0; i < ch.length; i++) {
            switch (ch[i]) {
                case '&':
                    sbuf.append("&amp;");
                    break;
                case '<':
                    sbuf.append("&lt;");
                    break;
                case '>':
                    sbuf.append("&gt;");
                    break;
                case '\"':
                    sbuf.append("&quot;");
                    break;
                default:
                    if (ch[i] > '\u007f') {
                        sbuf.append("&#");
                        sbuf.append(Integer.toString(ch[i]));
                        sbuf.append(';');
                    }
                    else if (ch[i] == '\t') {
                        sbuf.append(' ');
                        sbuf.append(' ');
                        sbuf.append(' ');
                        sbuf.append(' ');
                    }
                    else if ((int) ch[i] >= 32 || (ch[i] == '\n' || ch[i] == '\r')) {
                        sbuf.append(ch[i]);
                    }
            }
        }
        return sbuf.toString();
    } 
```

# php - 更新日期格式

> ID：10438696
> 
> 赞同：1
> 
> 时间：2012-05-03T20:15:44.893
> 
> 标签：php, html

我无法更新 mysql 日期

试 ，

mysql 在插入日期格式时剩余 0000-00-00`date('d-m-Y')`

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:17:53.207

改用这个：

```
date('Y-m-d') 
```

此外，如果您只想使用当前时间/日期并且您的 MySQL 服务器与您的 Web 服务器位于同一时区，您可以[在 SQL中](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_now)[使用`NOW()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_now)。

# url - symfony2 使用正则表达式对单个控制器操作使用多个 url 模式

> ID：10438698
> 
> 赞同：15
> 
> 时间：2012-05-03T20:15:47.000
> 
> 标签：url, routing, symfony

symfony2 是否可以使用正则表达式为单个控制器操作定义多个 url 模式，因此我们不必定义多个规则？提前致谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-08T10:34:30.533

使用注解时，您可以定义多个路由。像那样：

```
/**
 * @Route ("item1")
 * @Route ("item/2")
 * @Method("GET")
 */
public function itemAction() {

} 
```

我正在使用版本 2.0.9

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-03T20:27:26.220

您是指有要求的占位符吗？

```
blog:
    pattern:   /blog/{page}
    defaults:  { _controller: AcmeBlogBundle:Blog:index, page: 1 }
    requirements:
        page:  \d+ 
```

在这里，您有多个由占位符定义的路由，通过正则表达式验证到相同的控制器操作。

编辑：

url 的每个部分都可以是占位符。

```
blog:
    pattern:   /{type}/{page}
    defaults:  { _controller: AcmeBlogBundle:Blog:index, page: 1 }
    requirements:
        type: blog|articles
        page:  \d+ 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-07-12T17:06:36.517

带有参数的路由的注释示例：

```
/**
 * @Route("/shops/{page}", name="shops")
 * @Route("/shops/town/{town}/{page}", name="shops_town")
 * @Route("/shops/department/{department}/{page}", name="shops_department")
 */
public function shopsAction(Town $town = null, Department $department = null, $page = 1)
{ ... } 
```

然后像这样在树枝中生成路线：

```
{{ path('shops_town') }} 
```

或者

```
{{ path('shops_town', {'town': town.id}) }} 
```

或者

```
{{ path('shops_department', {'department': department.id}) }} 
```

# c# - 如何在gridview中检查更新/插入的uniq约束？

> ID：10438700
> 
> 赞同：0
> 
> 时间：2012-05-03T20:16:01.077
> 
> 标签：c#, asp.net

我有一个简单的 gridview 和 sqldatasource 来将数据绑定到 gridview ， SqlDatabase 我试图为列设置唯一性约束，所以如果我添加新行或更新一行并且值已经存在它不会更新。

对于列 Name ，我设置 ->Indexes/keys -> new -> selected column Name -> Unique key 。

当它在标签中说已经存在时，我怎么能得到错误？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:51:10.613

首先创建一个过程，如下所示：

```
Create PROCEDURE [dbo].[test]
( 
@myUniquecolumn as varchar(20),
@ID    as int
)
AS
DECLARE @ReturnValue int
IF EXISTS (SELECT myUniquecolumn FROM mytable WHERE myUniquecolumn=@myUniquecolumn)
BEGIN
-- if the value already exist return 1
SELECT @ReturnValue = 1;
RETURN @ReturnValue;
END
ELSE
BEGIN
update mytable set myUniquecolumn=@myUniquecolumn where ID=@ID
SELECT @ReturnValue = 0;
RETURN @ReturnValue;
END 
```

然后在您的 sqldatasource 中使用此过程进行更新。按照此[教程](http://www.mikesdotnetting.com/Article/54/Getting-the-identity-of-the-most-recently-added-record)了解如何将输出参数添加到 sql 数据源。

在您的 aspx sqldatasource 之后应该类似于以下内容：

```
 <UpdateParameters>
        <asp:Parameter Name="myUniquecolumn" Type="String" />
        <asp:Parameter Name="ID" Type="Int32" />
        <asp:Parameter DbType="Int32" Direction="ReturnValue" Name="uniqtest" />
    </UpdateParameters> 
```

然后在您的代码隐藏文件中写入以下代码。

```
protected void SqlDataSource1_Updated(object sender, SqlDataSourceStatusEventArgs e)
{
    int uniquecolumn= (int)e.Command.Parameters["@uniqtest"].Value;

  if (uniquecolumn == 0)
    {
        Label1.Text = "Success";
    }
    else
    {
        Label1.Text = "fail";
    }
  } 
```

希望能帮助到你.... ：）

# c++ - C++ 对象列表无法正常工作

> ID：10438703
> 
> 赞同：1
> 
> 时间：2012-05-03T20:16:11.530
> 
> 标签：c++, oop, casting

UML 图：http: [//i.imgur.com/en0Nf.png](http://i.imgur.com/en0Nf.png)

我的 OOP 老师说我们可以用 C++ 实现上图中类似的东西（用于实验室作业）。她说我们可以做这样的事情，这样我们就不需要两个 List 类（一个用于 Books，一个用于 Clients）。

我开始实现它，我被困在 getFromPosition(int) 上（它应该在列表中的某个位置返回对象）。我想要做的是将 Book 对象保存在 List 对象中（这工作正常），我以后希望能够返回/读取/修改这些保存的 Book 对象。它返回对象，但后来我（可能) 应该做某种类型的演员，这样我就可以使用书中的方法。这甚至可能吗？这是该方法的代码：

```
 Obj List::getFromPosition(int i){
            return list[i];
        } 
```

我希望我提供了足够的信息（这是我的第一个问题）。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:19:19.923

由于您返回的是`Obj`按值，我猜在内部您持有`Obj`对象集合，而不是指针。

这是错误的。您遇到了**对象切片**。

首先，您应该在内部保留指针或智能指针，并返回 an`Obj*`或 a `SmartPtr<Obj>`。

其次，是否需要演员阵容取决于。

如果您的派生类之间有一个通用方法，它可能应该放在基类中。如果没有，您可能需要演员表。

这是我*粗略*的做法：

```
class List
{
   std::vector<Obj*> _objects;
public:
   Obj* getFromPosition(int i)
   {
      return _objects[i];
   }
};

//...
List list;
//...
Obj* obj = list.getFromPosition(0);

obj->commonMethod();   //common method is virtual and a member of Obj
(dynamic_cast<Book*>(obj))->bookMethod(); //book method is only available for Book class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:19:27.207

只需让您的函数返回一个`Book`.

# r - 使用 apply(,2,) 对巨大数据集的列执行混合效果 (lme())

> ID：10438704
> 
> 赞同：2
> 
> 时间：2012-05-03T20:16:13.620
> 
> 标签：r

我是这方面的新手，所以我无法确定这是否愚蠢。基本上，我想在一个巨大的数据集中的所有连续变量之间做成对的混合效应模型。显而易见的替代方案是简单的 spearman 相关，但我有我的理由，要解释我为什么要使用混合效应模型需要很长时间。

数据看起来像这样：

```
0     X1507.07  XAB1524.33  XAB1624.21  XAB1808.09...(~4000 columns)
1       12         19           12         45
2       15         35           2          25
3       22         23           65         33
4       0          55           23         67
5       12         10           90         94
6       34         22           11         2
...
90      13         8            14         45 
```

目标是所有列的成对模型。
这是脚本有问题的部分：

```
for(i in 1:ncol(dat))
{
ni<-names(dat)[i]
pvalue <- apply(dat, 2, function(x)
    {
formula<-as.formula(paste(ni,"~", x," + Location",sep=""))
model<-do.call("lme", args = list(formula, random=~1|Subject, data=dat))    
summary(model)$tTable[2,5]
    }) 
```

错误：

```
invalid model formula in ExtractVars 
```

对于那些感到困惑的人：我使用 as.formula 因为如果您尝试：

```
model<-lme(X1507.07~x+Region,random=~1|Subject, data=dat) 
```

错误：

```
Error in eval(expr, envir, enclos) : object 'x' not found 
```

（“位置”和“主题”是数据框 dat 中的因素）。我只关心一个 p 值（我知道它与混合效应有争议）。我尝试在 as.formula() 中传递 x as.matrix(x) 和 colnames(x) 但似乎没有任何效果。重点是：有谁知道这是否可能？如果我必须循环大约 10 ^ 7 次，它不值得花时间（年），所以 apply() 是我能想到的唯一合理的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-05T01:18:56.233

我仍然认为这可能是愚蠢的，并且您可以通过手动计算出瞬时方法的答案来获得更快的解决方案，但是（除非我在某处犯了错误）这样做的时机并不像灾难性的那样我想可能是这样。

**tl;博士**如果你没有遇到任何其他缩放问题，整个事情应该需要大约 3-4 天的蛮力。`lmer`实际上更慢（虽然它被设计为更快地解决大问题，但由于设置成本，单个小问题的时间实际上可能更慢）。因为`lme`是一个不平凡的问题，我认为循环实际上是总计算成本的一小部分。

补一些数据：

```
set.seed(101)
n <- 10
nobs <- 90
dat <- as.data.frame(matrix(rpois(nobs*n,20),nrow=nobs))
Subject <- rep(1:n,each=nobs/n)
Location <- runif(n) 
```

这样做`nlme`：

```
library(nlme)
fun.lme <- function() {
    r <- numeric(n*(n-1)/2)
    k <- 1
    for (i in 2:n) {
        for (j in 1:(i-1)) {
            m <- lme(y~x+Location,random=~1|Subject,
                     data=data.frame(x=dat[,i],y=dat[,j],
                     Location,Subject))
            tt <- summary(m)$tTable[2,5]
            r[k] <- tt
            k <- k+1
        }
    }
    r
}
t1 <- system.time(r1 <- fun.lme())
detach("package:nlme") 
```

（`nlme`在使用之前分离`lme4`是个好主意）

```
fun.lmer <- function(...) {
    r <- numeric(n*(n-1)/2)
    k <- 1
    for (i in 2:n) {
        for (j in 1:(i-1)) {
            m <- lmer(y~x+Location+(1|Subject),
                     data=data.frame(x=dat[,i],y=dat[,j],
                     Location,Subject),...)
            tt <- coef(summary(m))[2,2]  
            r[k] <- tt
            k <- k+1
        }
    }
    r
} 
```

稳定的测试时间`lme4`：

```
library(lme4.0) ## 'stable' version (the same as you get by installing
                ## lme4 from CRAN
t2 <- system.time(r2 <- fun.lmer())
detach("package:lme4.0") 
```

现在有了 development (r-forge) `lme4`，有标准和非标准优化器选择：

```
library(lme4)
t3 <- system.time(r3 <- fun.lmer())
t4 <- system.time(r4 <- fun.lmer(optim="bobyqa"))
detach("package:lme4") 
```

检查时间：

```
tvals <- c(lme=t1["elapsed"],lme4.0=t2["elapsed"],
           lme4=t3["elapsed"],lme4_bobyqa=t4["elapsed"]) 
```

将我们花费的时间缩放到完整工作的时间：

```
totsecs <- (3789*3788/2)*tvals/(n*(n-1)/2)
totdays <- totsecs/(60*60*24)

round(totdays,1)
##   lme.elapsed   lme4.0.elapsed   lme4.elapsed lme4_bobyqa.elapsed 
##           3.0              4.4            4.1                 3.8 
```

您不妨使用 t 统计量作为 p 值进行比较；据我所知，除了作为关联强度的指标之外，p 值将完全无关紧要。

# r - 使用样本列表作为模板从更大的列表中进行采样，而无需环绕

> ID：10438705
> 
> 赞同：1
> 
> 时间：2012-05-03T20:16:17.083
> 
> 标签：r, sampling

如果我有一个字母向量：

```
> all <- letters
> all
[1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z" 
```

然后我从字母中定义一个参考样本，如下所示：

```
> refSample <- c("j","l","m","s") 
```

其中元素之间的间距为 2（第 1 到第 2）、1（第 2 到第 3）和 6（第 3 到第 4），然后我如何从中选择*n 个*样本，这些样本`all`在其元素之间具有相同的非环绕间距`refSample`? 例如，`"a","c","d","j"`and`"q" "s" "t" "z"`将是有效样本，但`"a","c","d","k"`and`"r" "t" "u" "a"` 不会。前者在第 3 个和最后一个元素之间的索引差异为 7（而不是 6），而后者具有正确的间距但会环绕。

其次，我如何参数化它，以便无论`refSample`使用什么，我都可以将它的间距用作模板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:33:37.070

这里有一个简单的方法——

```
all <- letters                                                                                                                                                                                                                                                                
refSample <- c("j","l","m","s")                                                                                                                                                                                                                                               

pick_matches <- function(n, ref, full) {                                                                                                                                                                                                                                      
  iref <- match(ref,full)                                                                                                                                                                                                                                                     
  spaces <- diff(iref)                                                                                                                                                                                                                                                        
  tot_space <- sum(spaces)                                                                                                                                                                                                                                                    
  max_start <- length(full)  - tot_space                                                                                                                                                                                                                                      
  starts <- sample(1:max_start, n, replace = TRUE)                                                                                                                                                                                                                            
  return( sapply( starts, function(s) full[ cumsum(c(s, spaces)) ] ) )                                                                                                                                                                                                        
}                                                                                                                                                                                                                                                                             

> set.seed(1)                                                                                                                                                                                                                                                                
> pick_matches(5, refSample, all) # each COLUMN is a desired sample vector                                                                                                                                                                                                                                         
      [,1] [,2] [,3] [,4] [,5]                                                                                                                                                                                                                                                
 [1,] "e"  "g"  "j"  "p"  "d"                                                                                                                                                                                                                                                 
 [2,] "g"  "i"  "l"  "r"  "f"                                                                                                                                                                                                                                                 
 [3,] "h"  "j"  "m"  "s"  "g"                                                                                                                                                                                                                                                 
 [4,] "n"  "p"  "s"  "y"  "m" 
```

# c# - 在 IE 中选择时，jQuery UI 自动完成值消失

> ID：10438708
> 
> 赞同：1
> 
> 时间：2012-05-03T20:16:46.843
> 
> 标签：c#, .net, jquery-ui, rad-controls

我有一个 RadTextBox，它使用 jQuery UI 自动完成功能来获取特定值。这在 Firefox 和 Chrome 中效果很好，但是当我从自动完成值中选择一个项目时，它不会填充 IE 9 中的值。不确定为什么它不起作用或我需要做什么才能使它起作用。

# php - 基于PHP中的时间间隔拆分数组

> ID：10438710
> 
> 赞同：4
> 
> 时间：2012-05-03T20:16:54.467
> 
> 标签：php, arrays

我正在寻找一种基于数组中包含的时间间隔来拆分数组的方法。例如，

```
Array (
   [0] => Array (
               ['type'] => Text Format
               ['interval'] => 30
               ['init'] => 2012-04-30 09:00:00
               ['final'] => 2012-04-30 10:00:00
           )
   [1] => Array (
               ['type'] => Word Format
               ['interval'] => 12
               ['init'] => 2012-04-28 13:00:00
               ['final'] => 2012-04-28 13:30:00
           )
) 
```

将其拆分为：

```
Array (
   [0] => Array (
               ['type'] => Text Format
               ['interval'] => 30
               ['init'] => 2012-04-30 09:00:00
               ['final'] => 2012-04-30 09:30:00
           )
   [1] => Array (
               ['type'] => Text Format
               ['interval'] => 30
               ['init'] => 2012-04-30 09:30:00
               ['final'] => 2012-04-30 10:00:00
           )
   [2] => Array (
               ['type'] => Word Format
               ['interval'] => 12
               ['init'] => 2012-04-28 13:00:00
               ['final'] => 2012-04-28 13:12:00
           )
   [3] => Array (
               ['type'] => Word Format
               ['interval'] => 12
               ['init'] => 2012-04-28 13:12:00
               ['final'] => 2012-04-28 13:24:00
           )
) 
```

这样做的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:14:07.253

鉴于您提供的内容，应该这样做：

```
foreach($old as $o) {
    $interval= $o['interval'];
    $new[] = $o;
    $x = count($new)-1;
    $new[$x]['final'] = date("Y-m-d H:i:s",strtotime("+$interval minutes", strtotime($old[$x]['init'])));

    $new[] = $o;
    $y = count($new)-1;
    $new[$y]['init'] = $new[$x]['final'];
    $new[$y]['final']   = date("Y-m-d H:i:s",strtotime("+$interval minutes", strtotime($new[$y]['init'])));
}

echo "Old:<pre>".print_r($old,true)."</pre>";
echo "New<pre>".print_r($new,true)."</pre>"; 
```

我测试的输出：

```
Old:
Array
(
    [0] => Array
        (
            [type] => Text Format
            [interval] => 30
            [init] => 2012-04-30 09:00:00
            [final] => 2012-04-30 10:00:00
        )

    [1] => Array
        (
            [type] => Word Format
            [interval] => 12
            [init] => 2012-04-28 13:00:00
            [final] => 2012-04-28 13:30:00
        )

)

New
Array
(
    [0] => Array
        (
            [type] => Text Format
            [interval] => 30
            [init] => 2012-04-30 09:00:00
            [final] => 2012-04-30 09:30:00
        )

    [1] => Array
        (
            [type] => Text Format
            [interval] => 30
            [init] => 2012-04-30 09:30:00
            [final] => 2012-04-30 10:00:00
        )

    [2] => Array
        (
            [type] => Word Format
            [interval] => 12
            [init] => 2012-04-28 13:00:00
            [final] => 1969-12-31 16:12:00
        )

    [3] => Array
        (
            [type] => Word Format
            [interval] => 12
            [init] => 1969-12-31 16:12:00
            [final] => 1969-12-31 16:24:00
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:50:44.433

这可能对你有用......我只比较最多 20 个间隔

```
$dates = Array (
        0 => Array (
                'type' => "Text Format",
                'interval' => "30",
                'init' => "2012-04-30 09:00:00",
                'final' => "2012-04-30 10:00:00" 
        ),
        1 => Array (
                'type' => "Word Format",
                'interval' => 12,
                'init' => "2012-04-28 13:00:00",
                'final' => "2012-04-28 13:30:00" 
        ) 
);

echo "<pre>";

$output = array ();

foreach ( $dates as $key => $value ) {
    makeDates ( $value ['init'], $value ['final'], $value ['interval'], $value ['type'] ,$output);
}

var_dump ( $output );
function makeDates($start, $end, $min, $type, &$output) {
    $start = new DateTime ( $start );
    $end = new DateTime ( $end );

    $interval = new DateInterval ( 'PT' . $min . 'M' );

    for($i = 0; $i < 20; $i ++) {
        $list = array ();
        $list ['type'] = $type;
        $list ['interval'] = $min;
        $list ['init'] = $start->format ( 'Y-m-d H:i:s' );

        $start->add ( $interval );

        $list ['final'] = $start->format ( 'Y-m-d H:i:s' );

        if ($start == $end) {
            $output [] = $list;
        }

        if ($start >= $end) {
            break;
        }

        $output [] = $list;

    }

    return $output;
} 
```

输出

```
array
  0 => 
    array
      'type' => string 'Text Format' (length=11)
      'interval' => string '30' (length=2)
      'init' => string '2012-04-30 09:00:00' (length=19)
      'final' => string '2012-04-30 09:30:00' (length=19)
  1 => 
    array
      'type' => string 'Text Format' (length=11)
      'interval' => string '30' (length=2)
      'init' => string '2012-04-30 09:30:00' (length=19)
      'final' => string '2012-04-30 10:00:00' (length=19)
  2 => 
    array
      'type' => string 'Word Format' (length=11)
      'interval' => int 12
      'init' => string '2012-04-28 13:00:00' (length=19)
      'final' => string '2012-04-28 13:12:00' (length=19)
  3 => 
    array
      'type' => string 'Word Format' (length=11)
      'interval' => int 12
      'init' => string '2012-04-28 13:12:00' (length=19)
      'final' => string '2012-04-28 13:24:00' (length=19) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:47:55.540

有几件事可以让您走上正轨：

1.  您不能直接在 PHP 中比较日期/时间字符串，将它们转换为时间戳

2.  比较 init 和 final 并检查差异是否 > 间隔

3.  如果差异<=间隔，你就完成了

4.  如果差异 > 间隔，则创建新数组并将间隔添加到 init。转到第 2 步

向我们展示代码！

# sql - 如何刷新用户定义的函数

> ID：10438711
> 
> 赞同：3
> 
> 时间：2012-05-03T20:16:57.067
> 
> 标签：sql, sql-server

> **可能重复：**
> [SQL Server UDF 刷新](https://stackoverflow.com/questions/7683732/sql-server-udf-refresh)

系统存储过程`sp_refreshview`可用于验证和重新编译 SQL Server 中的视图。

我怎样才能对标量函数和表函数做同样的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T20:35:43.203

你应该看看[sp_refreshsqlmodule](http://msdn.microsoft.com/en-us/library/bb326754.aspx)。

# google-checkout - Google 结帐按钮在 nopcommerce 中不起作用

> ID：10438712
> 
> 赞同：0
> 
> 时间：2012-05-03T20:16:59.503
> 
> 标签：google-checkout, nopcommerce

我在 nopcommerce 中设置了 google checkout 付款方式，它出现在购物车上，但它不起作用。我查看了 html，发现 id=form-googlecheckout 的表单没有出现在我的页面上。为什么它会发生？

我也不确定谷歌结帐的流程。处理付款后，我的客户会被重定向到 onecheckout 页面吗？

谢谢， 雅罗斯拉夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T23:32:54.393

关于第二个问题，答案是否定的。

在 Google Checkout 交易完成后，买家不会自动重定向。买方必须**单击**提供的链接才能导航回卖方的网站。

您可以以编程方式为买家提供一个链接，让他们在完成订单后点击并返回您的网站。使用 Checkout API，您可以为每个订单更改此 URL。请参阅 continue_url 参数：

[https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Parameter_Reference#tag_continue-shopping-url](https://developers.google.com/checkout/developer/Google_Checkout_HTML_API_Parameter_Reference#tag_continue-shopping-url)

# ffmpeg - 使用ffmpeg在静态背景图像上覆盖具有透明度的动画图像？

> ID：10438713
> 
> 赞同：28
> 
> 时间：2012-05-03T20:17:02.463
> 
> 标签：ffmpeg

我正在寻找使用一组具有与静态背景合并的透明度的 png 图像创建视频。

经过大量挖掘后，我似乎使用过滤器库绝对有可能。

我最初的不包括背景的视频制作是：

```
ffmpeg -y -qscale 1 -r 1 -b 9600 -loop -i bg.png -i frame_%d.png -s hd720 testvid.mp4 
```

使用`-vf`我可以将背景应用为叠加层：

```
ffmpeg -y -qscale 1 -r 1 -b 9600 -i frame_%d.png -vf "movie=bg.png [wm];[in][wm] overlay=0:0 [out]" -s hd720 testvid.mp4 
```

然而问题是它在输入上覆盖了背景。根据[libacfilter](http://ffmpeg.org/libavfilter.html#Tutorial)，我可以拆分输入并使用它的内容。我想知道是否可以以某种方式更改叠加顺序？

非常感谢任何帮助！

**更新1：**
我正在尝试使以下过滤器工作，但我得到的电影没有背景：

```
ffmpeg -y -qscale 1 -r 1 -b 9600 -i frame_%d.png -vf "movie=bg.png [bg]; [in] split [T1], fifo, [bg] overlay=0:0, [T2] overlay=0:0 [out]; [T1] fifo [T2]" -s hd720 testvid.mp4 
```

**更新 2：**
使用 -vf 选项制作视频。只需通过管道将输入狭缝应用到其上并覆盖两个分流！可能不是最有效的方法……但它奏效了！

```
ffmpeg -y -r 1 -b 9600 -i frame_%d.png -vf "movie=bg.png, scale=1280:720:0:0 [bg]; [in] format=rgb32, split [T1], fifo, [bg] overlay=0:0, [T2] overlay=0:0 [out]; [T1] fifo [T2]" -s hd720 testvid.mp4 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-08T23:22:33.533

覆盖顺序由[ffmpeg 文档中的输入顺序控制](http://ffmpeg.org/ffmpeg-filters.html#overlay-1)

> [...] 需要两个输入和一个输出，第一个输入是第二个输入覆盖的“主”视频。

您的第二个命令因此变为：

```
ffmpeg -y -loop 1 -qscale 1 -r 1 -b 9600 -i frame_%d.png -vf "movie=bg.png [wm];[wm][in] overlay=0:0" -s hd720 testvid.mp4 
```

使用最新版本的 ffmpeg，新`-filter_complex`命令使相同的过程更加简单：

```
ffmpeg -loop 1 -i bg.png -i frame_%d.png -filter_complex overlay -shortest testvid.mp4 
```

* * *

一个完整的工作示例：

我们透明输入图像的来源（为跳舞道歉）：使用[ImageMagick](http://www.imagemagick.org/script/index.php)
![跳舞的香蕉](../Images/baf18cf3f8e7601af56ff13c25720a7d.png)
分解为帧：

```
convert dancingbanana.gif -define png:color-type=6 over.png 
```

（设置`png:color-type=6`（RGB-Matte）至关重要，因为 ffmpeg 不能正确处理索引透明度。）输入被命名为`over-0.png`、`over-1.png`、`over-2.png`等。

我们的背景图片（缩放为香蕉）：
![快乐的小山](../Images/ca3d641de29f1e6f9faf8ac9b43549eb.png)

使用`ffmpeg version N-40511-g66337bf`（昨天的[git build](http://ffmpeg.org/download.html)），我们这样做：

```
ffmpeg -loop 1 -i bg.png -r 5 -i over-%d.png -filter_complex overlay -shortest out.avi 
```

`-loop`循环输入背景图像，这样我们就不会只有一帧了，这很重要！
`-r`稍微减慢跳舞的香蕉，可选的。
`-filter_complex`是最近添加的 ffmpeg 功能，可以更轻松地处理多个输入。
`-shortest`当最短的输入结束时结束编码，这是必要的，因为循环背景意味着该输入永远不会结束。

使用稍微不那么先进的构建，`ffmpeg version 0.10.2.git-d3d5e84`：

```
ffmpeg -loop 1 -r 5 -i back.png -vf 'movie=over-%d.png [over], [in][over] overlay' -frames:v 8 out.avi 
```

`movie`不允许设置速率，因此我们减慢背景速度，从而产生相同的效果。因为叠加的电影不是正确的输入，我们不能使用`-shortest`而是明确设置要输出的帧数为我们有多少叠加的输入帧。

最终结果（作为嵌入的 gif 输出）：
![有背景的跳舞香蕉](../Images/1c6b667710c8b8693d1cf18079eb28c6.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-17T08:38:14.613

for references in the future as of 17/02/2015, the command-line is :

```
ffmpeg -loop 1 -i images/background.png -i images/video_overlay%04d.png -filter_complex overlay=shortest=1 testvid.mp4 
```

thanks for llogan who took the time to reply here : [https://trac.ffmpeg.org/ticket/4315#comment:1](https://trac.ffmpeg.org/ticket/4315#comment:1)

# xpath - 匹配 TR 元素的 bgcolor 属性的 XPath 表达式

> ID：10438714
> 
> 赞同：2
> 
> 时间：2012-05-03T20:17:13.637
> 
> 标签：xpath, html-agility-pack

使用 HtmlAgilityPack 处理在没有`name`或的情况下生成的表行`id`。相反，我需要根据行的 bgcolor 属性中包含的值进行选择：

我知道 XPath 将返回`name`属性 =的所有行`display`：

```
foreach(HtmlNode cell in doc.DocumentElement.SelectNodes("//tr[@name='display']/td") 
```

给定下面的代码片段，当行的`bgcolor ="#FFFFFF"`> 时，什么表达式会选择所有元素？

我试过了：`SelectNodes(//tr[@bgcolor='#FFFFFF']/td")`

```
> <tr bgcolor="#EAF2FA">
>     <td colspan="2">
>         <font style="font-family: sans-serif; font-size:12px;"><strong>Name</strong></font>
>     </td> </tr> <tr bgcolor="#FFFFFF">
>     <td width="20">&nbsp;</td>
>     <td>
>         <font style="font-family: sans-serif; font-size:12px;">Steve</font>
>     </td> </tr> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T17:17:02.573

bgcolor 很奇怪，我发现使用 contains 可以解决问题。

这将工作...

```
SelectNodes(//*//tr[contains(@bgcolor, 'FFFFFF')]/td") 
```

# c++ - 为什么堆栈上的许多地址都指向 .map 文件中函数的确切位置？

> ID：10438715
> 
> 赞同：0
> 
> 时间：2012-05-03T20:17:13.520
> 
> 标签：c++, visual-studio, visual-studio-2008, stack-trace

我正在调试运行时崩溃，堆栈跟踪似乎已损坏（请参阅昨天的相关问题：[如果 EBP 帧指针为 NULL，堆栈是否已损坏？](https://stackoverflow.com/questions/10420325/is-the-stack-corrupted-if-the-ebp-frame-pointer-is-null)）。

尽管堆栈损坏，但我在堆栈上看到许多值指向相应 .map 文件中函数的**确切位置。**此外，在这种情况下，这些函数是（大部分，如果不是全部）应该出现在堆栈上的预期函数。

作为一个例子（有很多），这里是堆栈值，以及对应的 .map 条目值：

```
0588fe5c: 005caa30 (stack address / value at that address)

0001:001c9a30 __ehhandler$?ProcessTAFRequest@TQueryThread@@UAEXXZ 005caa30 f portable_source:UQueryThread.obj
(.map file entry indicating that address 005caa30 is the starting location of the function noted) 
```

假设（可能不正确）堆栈除了顶部附近*没有*损坏，并且我看到的函数地址确实对应于堆栈帧和相应的 EIP（返回地址）指针，那么我的问题是：为什么我一直看到.map 文件中与堆栈对应的函数位置的*确切值？*过去，我多次浏览未损坏的堆栈跟踪，并且堆栈帧中的 EIP 指针始终指向.map 文件中列出的相应函数的位置**附近**，但不**指向。**（这是有道理的，因为返回地址通常位于函数的中间，而不是开头）。

有人可以阐明吗？

# google-maps - 融合表过滤条件或

> ID：10438720
> 
> 赞同：5
> 
> 时间：2012-05-03T20:17:33.497
> 
> 标签：google-maps, google-maps-api-3, google-fusion-tables

根据[https://developers.google.com/fusiontables/docs/developers_reference](https://developers.google.com/fusiontables/docs/developers_reference) OR 操作不允许作为过滤条件的一部分。所以我试图想出一种创造性的方法来解决以下问题：

我有一个融合表支持的谷歌地图，其中包含数百个地点，并且希望将其过滤到仅具有“标签”或“标题”包含搜索参数的地点。

理想情况下，我可以将以下内容用作我的过滤条件：

```
tags CONTAINS IGNORING CASE 'searchterm' OR title CONTAINS IGNORING CASE 'searchterm' 
```

但是融合表 API 根本不允许这样做。那么该怎么办？进行 2 个单独的查询，然后过滤掉重复项？这意味着我不能使用漂亮的 FusionTablesLayer 预渲染平铺功能。

你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:20:22.543

一个可能的答案是预渲染表中的数据。本质上添加另一列，它是标签和标题的聚合。然后我只需要查询一个'tags_or_titles'列。当然，这意味着当我将数据导出到融合表中并且感觉不那么好和干净时，会预先进行更多的数据处理......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T15:20:50.053

如何在您的表中添加一个名为“Show_In_Results”的列，

然后运行两个单独的查询，根据是否在特定列中找到搜索词来更新每行数据的该列。

```
UPDATE 'table_id'
SET Show_In_Results = 1

UPDATE 'table_id'
SET Show_In_Results = 1
WHERE tags CONTAINS IGNORING CASE 'searchterm' 

UPDATE 'table_id'
SET Show_In_Results = 1
WHERE title CONTAINS IGNORING CASE 'searchterm' and Show_In_Results <> 1 
```

然后，当您渲染地图图层时：

```
SELECT 'columns' FROM 'table_id' WHERE Show_In_Results = 1 
```

# ruby - 用黄瓜测试服务器 ruby -application

> ID：10438721
> 
> 赞同：1
> 
> 时间：2012-05-03T20:17:34.383
> 
> 标签：ruby, cucumber, bdd, webrick

我的 ruby​​ 应用程序运行 Webrick 服务器。我想用黄瓜来测试它，并想确保它给我正确的反应。

在测试环境中运行服务器进行测试是否正常？在我的代码中我应该在哪里启动服务器进程以及我应该在哪里销毁它？

现在我通过后台步骤启动服务器并在 After hook 中销毁。它很慢，因为服务器在每个场景之前启动并在之后销毁。

我有想法在 env.rb 中启动服务器并在 env.rb 中声明的 at_exit 块中销毁它。你怎么看待这件事？

你知道这个问题的任何模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:20:22.793

我为此使用Spork。它启动一个或多个服务器，并能够在需要时重新加载这些服务器。这样，每次运行测试时都不会产生启动 Rails 的开销。

[https://github.com/sporkrb/spork](https://github.com/sporkrb/spork)

查看此 RailsCast 了解详细信息： [http ://railscasts.com/episodes/285-spork](http://railscasts.com/episodes/285-spork)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T11:15:19.507

由于黄瓜不再支持 spork （为什么？）我在 env.rb 中使用以下代码来分叉一个进程，我使用这个库：[https ://github.com/jarib/childprocess](https://github.com/jarib/childprocess)

```
require 'childprocess'

ChildProcess.posix_spawn = true

    wkDir=File.dirname(__FILE__)

server_dir = File.join(wkDir, '../../site/dev/bin')
#Because I use rvm , I have to run the server thru a shell
@server = ChildProcess.build("sh","-c","ruby pageServer.rb -p 4563")
@server.cwd = server_dir
@server.io.inherit!
@server.leader = true
@server.start

at_exit do
puts "----------------at exit--------------"
puts  "Killing process " + @server.pid.to_s
 @server.stop
 if @server.alive?
     puts "Server is still alive - kill it manually"
 end
end 
```

# svn - 链接呈现为原始 html 文本

> ID：10438725
> 
> 赞同：0
> 
> 时间：2012-05-03T20:17:54.260
> 
> 标签：svn, mod-dav-svn, svn-server

我有一个这样的主页：

```
== Current Links ==
* [http://173.22.73.107/mediawiki/index.php?title=Tiremwiki:Changelog TIREM Changelog]
* [http://173.22.73.107/bugzilla3/ Bugzilla]
* [http://tempser.alionatigerabear.com/svn/Repository/ SubVersion]
* [http://173.22.73.107/bugzilla3/buglist.cgi?query_format=specific&order=relevance+desc&bug_status=__open__ All open TIREM bugs]
* [http://tempser.alionatigerabear.com/svn/Repository/TIREM-3/trunk/html/index.html TIREM-3 API Documentation]
* [http://tempser.alionatigerabear.com/svn/Repository/TIREM-4/trunk/html/index.html TIREM-4 API Documentation] 
```

当我单击底部的两个链接之一时，我得到原始 html 源而不是网页。

我究竟做错了什么？

其他链接工作，包括第三个链接到与最后一个相同的服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T22:12:02.647

可能您必须[按照书中](http://svnbook.red-bean.com/en/1.2/svn.advanced.props.html#svn.advanced.props.special.mime-type)所述和[svick](https://stackoverflow.com/users/41071/svick)`svn:mime-type`的建议对感兴趣的文件设置属性。

# java - 混淆一个 Android 库项目 / apklib

> ID：10438726
> 
> 赞同：1
> 
> 时间：2012-05-03T20:17:58.660
> 
> 标签：java, android, maven, proguard

我有一个关于如何混淆 Android 库项目的问题。总的来说，我想混淆一个包含 .java 文件（在 Android src/ 目录中）和 XML 文件/外部资源（在 Android res/ 目录中）的 apklib 文件（或者实际上是任何库项目的 .java 文件） ）。我希望能够将此库分发给其他开发人员，类似于 Facebook SDK 库（https://github.com/facebook/facebook-android-sdk 供参考）。但是，我希望代码被混淆，这样我的方法就不会以易于阅读的方式公开。

我已经尝试将 Proguard 与 Maven 一起使用，但即使在使用 Proguard 构建我的项目之后，我的 .apklib 中的文件也没有被混淆。我也尝试手动运行 Proguard，但我无法让它输出原始 .java 文件（可以被另一个项目作为库引用）而不是 .class 文件。

如果有人有任何关于如何混淆 apklib / Android 库中的 java 代码的信息，我将不胜感激。此外，了解是否根本无法创建混淆的 andoroid 库也将非常有帮助。

非常感谢您的帮助。

最好的，凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:24:07.537

根据您设置 android maven 插件的 proguard 目标的方式，您很可能会创建一个混淆的 apklib。但是我自己没有试过。请记住，proguard 可能会混淆为辅助工件，而不是主 apklib。

您还应该记住，如果您混淆了库，您的用户将不得不使用经过混淆的方法名称......这会违背分发的目的，并且会使其非常难以使用，因此这可能是一个坏主意。唯一可行的是，如果您在不混淆任何公共方法和类名的情况下混淆所有代码..

# c# - 尝试从文本框将值插入数据库

> ID：10438728
> 
> 赞同：1
> 
> 时间：2012-05-03T20:18:05.617
> 
> 标签：c#, sql-server, ado.net

我完全被这个难住了，而且我是 C# 的新手，所以也许你们中的一个好人可以帮助我。我正在尝试使用 ADO.NET 从表单字段更新数据库。

基本上，我得到的错误是我试图将空值插入数据库。错误的确切文本是：

```
System.ArgumentNullException: The SqlParameterCollection only accepts non-null SqlParameter type objects. 
```

这是我尝试使用的页面背后的代码：

```
private void ExecuteInsert(string firstName, string lastName, string emailAddress, string city, string phone)
{
    SqlConnection conn = new SqlConnection(GetConnectionString());
    string sql = "INSERT INTO contactInfo (firstName, lastName, emailAddress, city, phone) VALUES "
                + " (@firstName, @lastName, @emailAddress, @city, @phone)";

    try
    {
        conn.Open();
        SqlCommand cmd = new SqlCommand(sql, conn);
        SqlParameter[] param = new SqlParameter[6];
        param[0] = new SqlParameter("@firstName", SqlDbType.NVarChar, 25);
        param[1] = new SqlParameter("@lastName", SqlDbType.NVarChar, 25);
        param[2] = new SqlParameter("@emailAddress", SqlDbType.NVarChar, 30);
        param[3] = new SqlParameter("@city", SqlDbType.NVarChar, 50);
        param[4] = new SqlParameter("@phone", SqlDbType.Int, 10);

        param[0].Value = firstName;
        param[1].Value = lastName;
        param[2].Value = emailAddress;
        param[3].Value = city;
        param[4].Value = phone;

        for (int i = 0; i < param.Length; i++)
        {
                cmd.Parameters.Add(param[i]);
        }

        cmd.CommandType = CommandType.Text;
        cmd.ExecuteNonQuery();
    }
    catch (System.Data.SqlClient.SqlException ex)
    {
        string msg = "Insert Error:";
        msg += ex.Message;
        throw new Exception(msg);
    }
    finally
    {
        conn.Close();
    }
}

protected void Button1_Click(object sender, EventArgs e)
{
    if (firstName.Text != null)
    {
        //call the method to execute insert to the database
        ExecuteInsert(firstName.Text,
                      lastName.Text,
                      emailAddress.Text,
                      city.Text,
                      phone.Text);
        Response.Write("Record was successfully added!");
        ClearControls(Page);
    }
    else
    {
        Response.Write("Please enter your name");
    }
}

public static void ClearControls(Control Parent)
{

    if (Parent is TextBox)
    { (Parent as TextBox).Text = string.Empty; }
    else
    {
        foreach (Control c in Parent.Controls)
            ClearControls(c);
    }
} 
```

如果有另一种方式我应该这样做，我很想听听。我似乎无法在网上找到好的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:21:39.250

这一行：

```
SqlParameter[] param = new SqlParameter[6]; 
```

应该是（数组太大，你没有设置最后一个参数）：

```
SqlParameter[] param = new SqlParameter[5]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:21:51.043

改变

`SqlParameter[] param = new SqlParameter[6];`

到

`SqlParameter[] param = new SqlParameter[5];`

您可以直接添加参数，`cmd.Parameters`而无需创建临时数组。

# iphone - 使用情节提要的 Xcode 横向模式

> ID：10438732
> 
> 赞同：3
> 
> 时间：2012-05-03T20:18:24.813
> 
> 标签：iphone, ios, xcode4, uiinterfaceorientation, uistoryboard

我正在为 Zoo 制作一个应用程序，它非常简单，但是因为起初我尝试使用代码和使用 xcode 3.2 来制作它，但是我遇到了一些问题，所以我使用 Xcode 4.3 开始它并尝试使用故事板。

我的问题是，如何将所有应用程序置于横向模式？我的意思是我已经在 infoplist 中设置了它：初始界面方向，然后在 .m 文件中我更改了以下内容：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return UIInterfaceOrientationLandscapeRight;
} 
```

但它不起作用。当我添加一个 tabbarcontroller 并链接它时，所有的视图都变成了纵向的。第一个如果我旋转它，它确实给了我风景，但所有其他人总是纵向的，那我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:34:55.557

当您在情节提要上添加标签栏控制器时，在标签栏的属性检查器中，您有默认推断的方向，将其更改为横向。但是最好将方向从项目的摘要选项卡设置为横向右。它可以让您在正确的风景中出现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T07:16:47.950

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return interfaceOrientation==UIInterfaceOrientationLandscapeRight;
} 
```

# java - 如何在Java中的两个同名方法之间进行选择

> ID：10438734
> 
> 赞同：43
> 
> 时间：2012-05-03T20:18:28.513
> 
> 标签：java, overloading

我正在尝试访问我创建的类中的方法，但由于它的名称和参数数量相似，我的 IDE 说该方法不明确。下面是这两种方法的样机：

```
methodName(X, Y, Z)
methodName(A, Y, Z) 
```

我调用了该方法，并`null`为我的测试传递了第一个参数的值。不幸的是，我无法以任何方式重命名方法、更改参数的顺序或修改方法的结构。有没有办法区分这两种方法？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-05-03T20:20:51.927

将第一个参数转换为您要调用的方法的第一个参数的类型，例如：

```
methodName((A) null, y, z); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:41:50.367

您可以使用对象上的反射来获取方法列表吗？如果是这样，您可以显式调用与您相关的方法。我确实相信五位数的答案可能会更好...

# c# - 如何找到主表单并附加孩子

> ID：10438735
> 
> 赞同：0
> 
> 时间：2012-05-03T20:18:45.070
> 
> 标签：c#, winforms, mdi

我在 MainForm.cs 中使用 MDI

```
 public Le_MainForm()
        { 
            InitializeComponent();
            this.IsMdiContainer = true;
            this.Name = "MainUSER";

        }

 private void barButtonItem_ListeOrdres_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            Close_AllForm();
            Liste_Ordres f_Liste = new Liste_Ordres();
            f_Liste.MdiParent = this;
            f_Liste.Show();
        }

        private void barButtonItem_CreatOrdreAller_ItemClick(object sender, DevExpress.XtraBars.ItemClickEventArgs e)
        {
            Close_AllForm();
            Program.AllerRetour = "Ordre Aller";
            Fiche_Ordre f_Fiche = new Fiche_Ordre();
            f_Fiche.MdiParent = this;
            f_Fiche.Show();
        } 
```

现在的问题是，当我处于其他形式时，例如：Liste_Ordres.cs 或 Fiche_Ordre.cs 如何在不丢失 MDI 的情况下从 Fiche_Ordre.cs 重定向到 Liste_Ordres.cs，反之亦然？

当我在 Fiche_Ordres.cs 去 Liste_Ordres.cs 时，我使用：

```
private void simpleButton_Annluer_Click_1(object sender, EventArgs e)
        {
            Liste_Ordres f_Liste = new Liste_Ordres();

            f_Liste.Show();
            this.Close();
        } 
```

但是正如您所看到的，我丢失了 MDI，这意味着当我单击 MainForm 上的菜单时，Liste_Ordres 表单将消失。

正如您在此[视频](http://www.flickr.com/photos/stevchen99/7139919169/)中看到的那样，当我从 Liste 重定向到 fiche，然后最大化窗口时，我失去了菜单，这意味着我失去了 Mdi。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:21:37.533

您只需要`MdiParent`再次设置：

```
f_Liste.MdiParent = this.MdiParent; 
```

# python - 使用 BeautifulSoup 根据包含在其中的字符串提取 li 元素

> ID：10438748
> 
> 赞同：2
> 
> 时间：2012-05-03T20:20:04.507
> 
> 标签：python, beautifulsoup

我一直在尝试使用 BeautifulSoup 来检索`<li>`包含以下单词的任何格式的任何元素：`Ottawa`. 问题是它`ottawa`永远不在它自己的标签内，例如`<p>`. 所以我只想打印`li`包含`Ottawa`.

HTML 格式是这样的：

```
<html>
<body>
<blockquote>
<ul><li><a href="http://link.com"><b>name</b></a>
(National: Ottawa, ON)
<blockquote> some description </blockquote></li>
<li><a href="http://link2.com"><b>name</b></a>
(National: Vancouver, BC)
<blockquote> some description </blockquote></li>
<li><a href="http://link3.com"><b>name</b></a>
(Local: Ottawa, ON)
<blockquote> some description </blockquote></li>
</ul>
</blockquote>
</body>
</html> 
```

我的代码如下：

```
from bs4 import BeautifulSoup
import re
import urllib2,sys

url = "http://www.charityvillage.ca/cv/nonpr/nonpr1.html"
html = urllib2.urlopen(url).read()
soup = BeautifulSoup(html)

re1='.*?'
re2='(Ottawa)'
ottawa = soup.findAll(text=re.compile(re1+re2,re.IGNORECASE|re.DOTALL))
search = soup.findAll('li') 
```

上面代码的结果正确地找到了渥太华，当使用它来查找`li`元素时，它确实找到了`li`元素，但它给了我页面上的每一个元素。

我知道他们目前没有结合在一起，因为试图`search = soup.findAll('li', text=re.compile(re1+re2,re.IGNORECASE|re.DOTALL))`在`[]`

我的最终目标基本上是获取`<li>`包含任何提及的每个元素，`Ottawa`并给我整个`<li>`元素的名称、描述、链接等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:25:55.943

使用*text*属性过滤*findAll*的结果：

```
elems = [elem for elem in soup.findAll('li') if 'Ottawa' in str(elem.text)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T12:15:41.090

```
from bs4 import BeautifulSoup
import re
import urllib2,sys

url = "http://www.charityvillage.ca/cv/nonpr/nonpr1.html"
html = urllib2.urlopen(url).read()
soup = BeautifulSoup(html)

for item in soup.find_all(text=re.compile('\(.+: Ottawa', re.IGNORECASE)):
    link = item.find_previous_sibling(lambda tag: tag.has_key('href'))
    if link is None:
        continue
    print(u'{} [{}]: {}'.format(link.text,
                               item.strip(),
                               link['href']).encode('utf8')) 
```

# sql - 设置表达式的最大值

> ID：10438750
> 
> 赞同：0
> 
> 时间：2012-05-03T20:20:06.547
> 
> 标签：sql, postgresql, null, case, max

我正在尝试根据`char_length`字段创建分数。我正在使用`char_length`返回的一小部分。

```
 (CASE WHEN (char_length(e.summary)/100) is null THEN +0
  ELSE +(char_length(e.summary)/100) END) 
```

我想知道如何设置最大返回值。有一个简单的功能还是我需要再做一个`CASE WHEN with if >=10 THEN`......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T00:51:33.390

您可以使用该`least`功能。

`least(<YOUR CALC HERE>, 10)`将返回的最大值限制为 10。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T23:22:25.857

简化为：

```
LEAST(COALESCE(length(e.summary)/100, 0), 10) 
```

*   使用[**LEAST** ()](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-GREATEST-LEAST)引入上边界，正如@Mark 已经提到的那样。
*   使用[**COALESCE** ()](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL)为值提供默认`NULL`值。
*   [`length()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)和`char_length()`

# r - 在ggplot2中添加x和y轴标签

> ID：10438752
> 
> 赞同：130
> 
> 时间：2012-05-03T20:20:19.633
> 
> 标签：r, label, ggplot2

请问如何更改此图上的 x 和 y 标签？

```
library(Sleuth2)
library(ggplot2)
discharge<-ex1221new$Discharge
area<-ex1221new$Area
nitrogen<-ex1221new$NO3
p <- ggplot(ex1221new, aes(discharge, area), main="Point")
p + geom_point(aes(size= nitrogen)) + 
    scale_area() + 
    opts(title = expression("Weighted Scatterplot of Watershed Area vs. Discharge and Nitrogen Levels (PPM)"), 
         subtitle="n=41") 
```

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-05-03T22:57:41.707

[注意：编辑以使 ggplot 语法现代化]

你的例子是不可重现的，因为没有`ex1221new`（有一个`ex1221`in `Sleuth2`，所以我想这就是你的意思）。此外，您不需要（也不应该）将列拉出以发送到`ggplot`. 一个优点是直接`ggplot`与`data.frame`s 一起使用。

`xlab()`您可以使用和设置标签`ylab()`，或使其成为`scale_*.*`调用的一部分。

```
library("Sleuth2")
library("ggplot2")
ggplot(ex1221, aes(Discharge, Area)) +
  geom_point(aes(size=NO3)) + 
  scale_size_area() + 
  xlab("My x label") +
  ylab("My y label") +
  ggtitle("Weighted Scatterplot of Watershed Area vs. Discharge and Nitrogen Levels (PPM)") 
```

![在此处输入图像描述](../Images/ac665c85fb2e59e63aeaa2496302c8ab.png)

```
ggplot(ex1221, aes(Discharge, Area)) +
  geom_point(aes(size=NO3)) + 
  scale_size_area("Nitrogen") + 
  scale_x_continuous("My x label") +
  scale_y_continuous("My y label") +
  ggtitle("Weighted Scatterplot of Watershed Area vs. Discharge and Nitrogen Levels (PPM)") 
```

![在此处输入图像描述](../Images/a44af6e842e7f20bbd3dfd45fd22213a.png)

仅指定标签的另一种方法（如果您不更改刻度的任何其他方面，则很方便）是使用该`labs`函数

```
ggplot(ex1221, aes(Discharge, Area)) +
  geom_point(aes(size=NO3)) + 
  scale_size_area() + 
  labs(size= "Nitrogen",
       x = "My x label",
       y = "My y label",
       title = "Weighted Scatterplot of Watershed Area vs. Discharge and Nitrogen Levels (PPM)") 
```

这给出了与上述相同的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-19T15:06:17.897

由于没有给出数据 ex1221new，所以我创建了一个虚拟数据并将其添加到数据框中。此外，被问到的问题在代码中几乎没有变化，例如 ggplot 包已弃用

```
"scale_area()" and nows uses scale_size_area()
"opts()" has changed to theme() 
```

在我的回答中，我已将绘图存储在 mygraph 变量中，然后我使用了

```
mygraph$labels$x="Discharge of materials" #changes x axis title
       mygraph$labels$y="Area Affected" # changes y axis title 
```

工作完成了。以下是完整的答案。

```
install.packages("Sleuth2")
library(Sleuth2)
library(ggplot2)

ex1221new<-data.frame(Discharge<-c(100:109),Area<-c(120:129),NO3<-seq(2,5,length.out = 10))
discharge<-ex1221new$Discharge
area<-ex1221new$Area
nitrogen<-ex1221new$NO3
p <- ggplot(ex1221new, aes(discharge, area), main="Point")
mygraph<-p + geom_point(aes(size= nitrogen)) + 
  scale_size_area() + ggtitle("Weighted Scatterplot of Watershed Area vs. Discharge and Nitrogen Levels (PPM)")+
theme(
 plot.title =  element_text(color="Blue", size=30, hjust = 0.5), 

 # change the styling of both the axis simultaneously from this-
 axis.title = element_text(color = "Green", size = 20, family="Courier",)

   # you can change the  axis title from the code below
   mygraph$labels$x="Discharge of materials" #changes x axis title
   mygraph$labels$y="Area Affected" # changes y axis title
   mygraph 
```

此外，您可以使用上面使用的相同公式更改标签标题 -

```
mygraph$labels$size= "N2" #size contains the nitrogen level 
```

# .net - 日文、中文和韩文等语言的 KeyUp/KeyDown 替代方案？

> ID：10438766
> 
> 赞同：3
> 
> 时间：2012-05-03T20:21:12.073
> 
> 标签：.net, windows-phone-7, cjk, textblock, ime

在 a`TextBox`中，我无法捕获具有特殊 IME（如日语和韩语）的语言的击键，因为 IME 不断地决定不同的字符或音节。KeyUp/KeyDown 实际上大部分时间都不会触发（如果 IME 不在决策中，退格键会触发）。

在按下 Enter 之前，我需要捕获 TextBox 中的文本。

你能提供一个建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T03:25:23.100

您可以改为测试文本框更改。

# sql - Query that matches on several potential conditions: Proper design?

> ID：10438768
> 
> 赞同：0
> 
> 时间：2012-05-03T20:21:27.117
> 
> 标签：sql, sql-server, sql-server-2008, query-optimization

I'm working on a query to find records in a table of new entries that match records in a table of historical entries, where the match could be on one of many fields. In other words:

"Show all records where current.id = archive.id or current.name = archive.name or current.address = archive.address"

My SQL for this query is as follows:

```
SELECT current.id, current.name, current.address FROM current
INNER JOIN archive
ON
    current.id = archive.id OR
    current.name = archive.name OR
    current.address = archive.address 
```

When I run it, it takes FOREVER, and this is on the first load of data; archive will always have around 300,000 records in it, but current will fluctuate between 500 and 40,000.

Is there a better way to write this query? Or, is my query solid, but my underlying database potentially in trouble?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:24:24.983

Creating an index on the 3 fields in question in each table would probably help (especially on the archive table if it is very large), but try this instead:

```
SELECT current.id, current.name, current.address
FROM current
INNER JOIN archive
ON
    current.id = archive.id

UNION

SELECT current.id, current.name, current.address
FROM current
INNER JOIN archive
ON
    current.name = archive.name

UNION 

SELECT current.id, current.name, current.address
FROM current
INNER JOIN archive
ON
    current.address = archive.address 
```

This query would allow you to index the fields individually (which you should still do), resulting in potentially smaller indexes and better overall performance.

Using OR's in join criteria can really mess up the query optimizer, potentially making it do suboptimal things. The `UNION`s are expensive, but it is more likely that your query time is spent on the join, and simplifying that may help a lot.

# c++ - 如何在 Visual Studio 2010 中使用来自不同 C++ 项目的函数？

> ID：10438770
> 
> 赞同：10
> 
> 时间：2012-05-03T20:21:31.167
> 
> 标签：c++, visual-studio-2010, include, unresolved-external, multiple-projects

我想在 Visual Studio 2010 的同一解决方案中构建两个可以相互交互的 C++ 项目。我在目录下创建了一个解决方案`C:\Users\me\Desktop\SolutionDir`。这两个项目分别在`C:\Users\me\Desktop\SolutionDir\FirstProject`和下创建`C:\Users\me\Desktop\SolutionDir\SecondProject`。

我的第一个项目包含两个文件，一个头文件`function.h`和一个cpp文件`function.cpp`

### 函数.h

```
#pragma once
void print_stuff(); 
```

### 函数.cpp

```
#include "function.h"
#include <iostream>

void print_stuff() {
    std::cout << "hello world" << std::endl;
} 
```

我的第二个项目包含主文件`main.cpp`

### 主文件

```
#include "FirstProject\function.h"
#include <iostream>

int main(void) {
    print_stuff();

    int stop;
    std::cin >> stop;
    return 0;
} 
```

`C:\Users\me\Desktop\SolutionDir\`我在 SecondProject 中添加了目录`Configuration Properties > C/C++ > General > Additional Include Directories`。我仍然得到经典错误：`error LNK2019: unresolved external symbol`调用函数时`print_stuff()`。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T20:28:46.633

尝试在项目属性/配置属性/常规/配置类型中将第一个项目构建为静态库。

然后在第二个项目的项目属性中，您需要更改两件事：

1.  在链接器/常规中，您可能需要将`.lib`构建第一个项目的文件夹添加到“其他库目录”。
2.  在链接器/输入中，您需要将文件名添加到附加依赖项中，例如`.lib`文件`FirstProject.lib`名或任何文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T20:27:33.393

是的，您需要使用导出函数`_declspec(dllexport)`并将它们导入到调用函数的项目中`_declspec(dllimport)`。

这种二元性通常通过宏来实现：

```
#pragma once

#ifdef FIRST_PROJECT_BUILD
#define IMPEXP _declspec(dllexport)
#else
#define IMPEXP _declspec(dllimport)
#endif

IMPEXP void print_stuff(); 
```

在您的第一个项目的配置中，您添加`FIRST_PROJECT_BUILD`到您的预处理器指令。这样，当你编译第一个项目时，你告诉编译器函数要被导出。但是，当您将`FIRST_PROJECT_BUILD`未定义的文件包含在不同的项目中时，您会告诉编译器该函数是在不同的库中实现的并且应该被导入。

此外，除了添加额外的包含路径外，您还需要将`.lib`实现功能的项目生成的文件添加到`Extra dependencies`项目配置的 Liner 设置中的选项卡中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:31:10.133

您可以包含一个 realPath 为您包含目录！就像您的 FirstProject 包含“./../”一样，您的第二个项目也包含相同的包含目录，您可以移动或复制您的目录 SolutionDir，它将始终有效！

对于您未解决的链接，您必须在您的第一个和第二个项目中添加 function.cpp 和 function.h 您可以将它放在 SolutionDir 中！就像那样，您的第一个和第二个项目总是有两个文件，而不是四个！

希望能帮助到你 ！

# java - 使用 Java 访问在线数据库

> ID：10438773
> 
> 赞同：1
> 
> 时间：2012-05-03T20:21:38.957
> 
> 标签：java, mysql, database

我制作了一个访问数据库的 Java 程序。在开发阶段，我使用了一个本地数据库（XAMPP 和 MySQL），但是当我尝试访问 2 个不同的**在线**数据库（一个商业数据库和一个免费数据库）时，我在这两种情况下都收到了以下异常：

> SQLException: Communications link failure
> 最后一个成功发送到服务器的数据包是 0 毫秒前。驱动程序没有收到来自服务器的任何数据包。

我用 PHP 访问它们没有任何问题。

这是我的代码：

```
private String user = "user1";
private String pass = "pass1";
private String dbClass = "com.mysql.jdbc.Driver";
private String dbDriver = "jdbc:mysql://db4free.net:3306/DBNAME";
private Connection conn = null;

public boolean connect() {
    boolean done = false;
    //load driver
    try {
        Class.forName(dbClass).newInstance();
        System.out.println("driver loaded"); // THIS IS BEING RETURNED
    } catch (ClassNotFoundException | InstantiationException | IllegalAccessException ex) {
        System.err.println(ex);
    }
    // Connection
    try {
        conn = DriverManager.getConnection(dbDriver, user, pass);
        System.out.println("connected"); // THIS IS NOT BEING RETURNED
        done = true;
    } catch (SQLException ex) {
        System.out.println("SQLException: " + ex.getMessage());
    }
    return done;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:50:26.167

您的代码在 db4free 新创建的帐户上非常适合我：

检查以下事项：

[应该显示您的公共 ip 或单个 %](http://www.db4free.net/d4f_changeips.php)

[您的用户名和密码是否正确，也将验证您的帐户是否已确认。](http://www.db4free.net/d4f_changepw.php)

如果“DBNAME”正确，请登录[db4free.net](http://www.db4free.net/)上的“phpMyAdmin-Login:”，DBNAME 将在“information_schema”上方的左侧

最后，您的本地防火墙不会阻止您：

```
telnet db4free.net 3306 (from a command line/prompt) 
```

（如果您收到提示，您的防火墙会让您通过。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:28:00.920

MySQL 数据库不仅允许用户使用特定密码进行连接，还允许从 IP 范围或地址进行连接。

[http://dev.mysql.com/doc/refman/5.1/en/create-user.html](http://dev.mysql.com/doc/refman/5.1/en/create-user.html)

`CREATE USER 'jeffrey'@'127.0.0.1' IDENTIFIED BY 'mypass';`

因此，在线数据库可能不允许该用户从您的 IP 地址连接或阻止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:59:08.913

您的代码中没有提到端口号。这是工作代码的示例。

```
 try {
            Class.forName("com.mysql.jdbc.Driver");
        } catch (ClassNotFoundException e) {
            System.out.println(" Unable to load driver. ");
        }
        String url = "jdbc:mysql://DBSERVERNAME:3306/DATABASENAME";
        String username = "user";
        String password = "pass";
        try {
            this.conn = DriverManager.getConnection(url, username, password);
             System.out.println(" Connection Established. ");
        } catch (SQLException e) {
            System.out.println(" Error connecting to database:  "
                    + e);
        } 
```

但是，此问题可能有多种原因。

*   如果主机（运行此代码的机器）有权访问 MySQL 服务器，请检查您的 MySQL 服务器设置？
*   验证 JDBC URL，检查端口号、IP 地址/主机名
*   检查是否有任何东西（如防火墙、代理）阻止从主机到数据库服务器的连接
*   尝试从主机 ping 数据库服务器

类似帖子：[com.mysql.jdbc.exceptions.jdbc4.CommunicationsException:Communications link failure](https://stackoverflow.com/questions/2121829/mysql-jdbc-communications-link-failure)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-19T08:34:20.657

我想可能是防火墙的问题，一般服务器可能在监听 127.0.0.1 的 ip 地址，所以你只能从本地系统访问我的 sql，在配置文件中将其更改为 0.0.0.0，然后它就会启动在职的。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-06-11T07:59:50.503

```
static private String user = "ajaykakkar";
static private String pass = "ajaykakkar7432";
static private String dbClass = "com.mysql.jdbc.Driver"; 
```

// 它的 - - - "jdbc:mysql://www.db4free.net:3306/yourdatabasename_ark";

```
static private String dbDriver = "jdbc:mysql://www.db4free.net:3306/yourdatabasename_ark";
static private Connection conn = null;

public static boolean connect() {
    boolean done = false;
    //load driver
    try {
        Class.forName(dbClass).newInstance();
        System.out.println("driver loaded"); // THIS IS BEING RETURNED
    } catch (ClassNotFoundException | InstantiationException | IllegalAccessException ex) {
        System.err.println(ex);
    }
    // Connection
    try {
        conn = DriverManager.getConnection(dbDriver, user, pass);
        System.out.println("connected"); // THIS IS NOT BEING RETURNED
        done = true;
    } catch (SQLException ex) {
        System.out.println("SQLException: " + ex.getMessage());
    }
    return done;
}

public static void main(String args[]) {

    connect();

} 
```

// 由@ajay.r.kakkar 完成

# android - LinearLayout 部分覆盖在 ScrollView 上但不阻止触摸事件？

> ID：10438782
> 
> 赞同：1
> 
> 时间：2012-05-03T20:22:13.683
> 
> 标签：android, android-layout

我有一个 LinearLayout，其半透明颜色覆盖在 ScrollView 的一半上。我希望 LinearLayout 在触摸交叉点时阻止触摸事件进入 ScrollView。我尝试在模糊时设置过滤器触摸，但没有效果。

我错过了什么？

编辑：在设备上工作正常，但在模拟器上不行。

# java - 如何在 apache ode 下上传 zip 文件？

> ID：10438783
> 
> 赞同：0
> 
> 时间：2012-05-03T20:22:15.040
> 
> 标签：java, web-services, soa, axis, bpel

我在 Apache Ode 中，当我想上传 zip 文件（zip 文件只是 ODE 网站中的 helloWorld 示例）时，我收到了这个错误：

```
Invocation of operation deploy failed: org.apache.ode.axis2.OdeFault: The deployment doesn't appear to contain a
deployment descriptor in its root directory named deploy.xml, aborting. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T10:07:29.633

解压缩 zip 文件后，它应该具有以下结构。

```
.
|-- deploy.xml
|-- HelloWorld2.bpel
|-- HelloWorld2.wsdl
`-- test.properties 
```

谢谢

# objective-c - UITableView 坚持 UISearchBar

> ID：10438792
> 
> 赞同：0
> 
> 时间：2012-05-03T20:23:12.887
> 
> 标签：objective-c, ios, uitableview, uisearchbar

我有一个带有**UISearchBar**、[**MCSegmentedControl**](https://github.com/oettam/MCSegmentedControl)和**UITableView的视图**

这是我在**UISearchBar**不活动时的视图：

![在此处输入图像描述](../Images/6f3d1147534c6e1491925a3566e0f2d1.png)

这是**UISearchBar**处于活动状态时的视图

![在此处输入图像描述](../Images/0c3ccc03fa06a8eaec2c3254fe2b38e7.png)

如您所见，当**UITableView**处于活动状态时，它会粘在**UISearchBar**上，这不是我想要的。我希望**UITableVIew**留在[**MCSegmentedControl下面**](https://github.com/oettam/MCSegmentedControl)

我真的不知道该放什么代码，所以如果您需要一些代码，请随时询问。

有谁知道如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:32:21.087

您实际上正在查看两个不同的 UITableView：您的和 UISearchDisplayController 的 searchResultsTableView（当 searchBar 处于活动状态时可见）。我自己没有尝试过，但我认为你应该可以在 searchResultsTableView 上设置框架：来抵消它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T21:34:40.880

您的 SegmentedControl 和 table 之间的关系是什么？

我会大胆猜测您将 SegmentedControl 作为组标头提供，在这种情况下，这可能是预期的行为。

如果没有 - 请发布详细信息。

# input - 在网站上输入程序输入值

> ID：10438796
> 
> 赞同：1
> 
> 时间：2012-05-03T20:23:23.133
> 
> 标签：input, javafx

我想要我的 JavaFX 2.0 程序中的一个函数，它接受用户输入并将其转发到网站文本字段，然后获取网站返回的值。该网站将是一个检查特定程序的保修是否有效的网站。

用户需要输入的只是reg。ID 和程序品牌。

我只是在寻找有关如何执行此操作的想法，链接甚至代码都会很棒。我怀疑它不需要那么多代码，但是嘿..我以前很惊讶！

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T23:16:24.753

一种可能的实现算法：

1.  将保修检查页面加载到`WebView`.
2.  监视`webEngine.documentProperty`以检查加载何时完成。
3.  加载完成后，使用`webEngine.executeScript`将文本字段设置为所需值并提交表单。
4.  任何一个

    一个。监控`webEngine.documentProperty`更多，当文档加载后，检查文档（使用 JavaScript 或 Java）以查看保修是否有效。

    或者

    湾。更改生成的保修显示页面以回调到 Java 并通知您的应用程序保修状态。

* * *

*一些背景资料*

如果您可以控制网站页面内容，那么您的实施可能会变得更容易。但我认为你应该仍然能够在不修改网站的情况下获得你想要的结果。

最近的 JavaFX 2.1 版本增加了一些内容，以促进从 Javascript 到 Java 的回调。您要阅读的[webview 文档](http://docs.oracle.com/javafx/2/webview/jfxpub-webview.htm)`webEngine.executeScript`是使用该方法的“处理 JavaScript 命令”部分和使用`JSObject.setMember`.

您可能还想查看使用我编写[的 jQuery UI 示例的 JavaFX 示例 DatePicker 。](https://gist.github.com/1422815)它演示了将 html 加载到 a 中的各种方法，从 Java`WebView`调用函数`WebView`并将用户交互的结果`WebView`返回到 Java 中。不完全是您正在寻找的东西，但其中的想法可能会有所帮助。

您的另一个选择是：

1.  接受 JavaFX 控件中的注册 ID。
2.  直接从您的 java 应用程序创建`java.net.URL`并发布到网络服务器，而无需使用`WebView`.
3.  解析来自网络服务器的响应以提取保修是否有效。

这是我可能为此类任务采取的方法 - 完全消除 WebView 的使用。

# ruby - 在命令行参数中指定一个 nil

> ID：10438798
> 
> 赞同：3
> 
> 时间：2012-05-03T20:23:34.863
> 
> 标签：ruby, bash, command-line-interface

我有一个生成平面 json 文档的命令行工具。想象一下：

```
$ ruby gen-json.rb --foo bar --baz qux
{
    "foo": "bar"
    "baz": "qux"
} 
```

我想要的是这个工作：

```
$ ruby gen-json.rb --foo $'\0' --baz qux
{
    "foo": null,
    "baz": "qux"
} 
```

而不是 null 我得到一个空字符串。为了简化问题，进一步考虑：

```
$ cat nil-args.rb
puts "argv[0] is nil" if ARGV[0].nil?
puts "argv[0] is an empty string" if ARGV[0] == ""
puts "argv[1] is nil" if ARGV[1].nil? 
```

我想像这样运行它并得到这个输出：

```
$ ruby nil-args.rb $'\0' foo
argv[0] is nil 
```

但相反我得到

```
argv[0] is an empty string 
```

我怀疑这（可以说）是 ruby​​ 解释器中的一个错误。它将 argv[0] 视为一个以 null 结尾的 C 字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:31:44.520

命令行参数*始终*是字符串。您将需要使用哨兵来指示您要以其他方式处理的论点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T00:35:52.667

我很确定你*真的*不能按照你的提议去做。这是您使用的 shell 的一个基本限制。您只能将字符串参数传递给脚本。

它已经在评论中提到过，但是您尝试使用 \0 方法获得的输出非常有意义。空终止符在技术上是一个空字符串。

还要考虑访问尚未定义的数组的任何元素将始终为零。

```
a = [1, 2, 3]
a[10].nil?
#=> true 
```

但是，一个可能的解决方案是让您的程序像这样工作：

```
$ ruby gen-json.rb --foo --baz qux
{
    "foo": null,
    "baz": "qux"
} 
```

因此，当您有一个双减号参数后跟另一个双减号参数时，您推断第一个为空。不过，您将需要编写自己的命令行选项解析器来实现这一点。

这是一个非常简单的示例脚本，它似乎可以工作（但可能存在边缘情况和其他问题）：

```
require 'pp'

json = {}

ARGV.each_cons(2) do |key, value|
  next unless key.start_with? '--'
  json[key] = value.start_with?('--') ? nil : value
end

pp json 
```

这对你的目的有用吗？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T12:25:17.427

你将不得不决定一个特殊的字符来表示零。我建议`"\0"`（双引号确保传入文字字符串*反斜杠零*）。然后，您可以在以下位置使用特殊类型转换器`OptionParser`：

```
require 'optparse'
require 'json'

values = {}
parser = OptionParser.new do |opts|
  opts.on("--foo VAL",:nulldetect) { |val| values[:foo] = val }
  opts.on("--bar VAL",:nulldetect) { |val| values[:foo] = val }

  opts.accept(:nulldetect) do |string|
    if string == '\0'
      nil
    else
      string
    end
  end
end

parser.parse!

puts values.to_json 
```

显然，这要求您明确说明您接受的标志，但是如果您想接受任何标志，您当然可以手动插入`if`语句以检查`"\0"`

作为旁注，您可以让标志是可选的，但您会将空字符串传递给块，例如

```
opts.on("--foo [VAL]") do |val|
  # if --foo is passed w/out args, val is empty string
end 
```

所以，你仍然需要一个替身

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:59:33.990

Ruby 将除`nil`和之外的所有内容都`false`视为`true`. 因此，任何空字符串都将评估为真（以及`0`or `0.0`）。

您可以通过以下方式强制执行 nil 行为：

```
ARGV.map! do |arg|
  if arg.empty?
    nil
  else
    arg
  end
end 
```

这样，任何空字符串都将转换为对`nil`.

# shell - untar/remove 在 unix shell 脚本中的并行处理

> ID：10438800
> 
> 赞同：1
> 
> 时间：2012-05-03T20:23:52.533
> 
> 标签：shell, unix, parallel-processing, tar

### 问题：

我想解压一个 tarfile，它本身有许多 tar 文件，并删除所有 tar 文件中的文件，我希望所有这些进程在 Unix bash 脚本中并行运行。

### 条件：

1.  如果任何解压缩/删除过程有任何错误，脚本应该返回一个错误。
2.  只有在所有 N 个（解压缩和删除）进程成功完成后，它才应该返回成功。

### 建议的解决方案：

```
 mkdir a
 tar -C a -xvf b.tar
 cd a
 for i in *
 do
 rm -r $i &
 done 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:59:17.663

如果你安装了 GNU Parallel [http://www.gnu.org/software/parallel/](http://www.gnu.org/software/parallel/)你可以这样做：

```
tar xvf foo.tgz | perl -ne 'print $l;$l=$_;END{print $l}' | parallel rm 
```

如果您没有空间来提取完整​​的 tar.gz 文件，这很有用，但您需要在解压缩文件时对其进行处理：

```
tar xvf foo.tgz | perl -ne 'print $l;$l=$_;END{print $l}' | parallel do_stuff {}\; rm {} 
```

您可以通过以下方式安装 GNU Parallel：

```
wget http://git.savannah.gnu.org/cgit/parallel.git/plain/src/parallel
chmod 755 parallel
cp parallel sem 
```

观看 GNU Parallel 的介绍视频以了解更多信息： [https ://www.youtube.com/playlist?list=PL284C9FF2488BC6D1](https://www.youtube.com/playlist?list=PL284C9FF2488BC6D1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T21:08:19.960

```
mkdir a
tar -C a -xvf b.tar
 cd a
 success=$(for i in *
 do
 rm -r $i || echo failed & # if a job fails false will be echoed
 done
 wait)
 # if any of the jobs failed, success will be set to a value other than ""
 [[ -z "$success" ]] && exit 0 || exit 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-12T12:55:58.317

答案`tar xvf a.tar | tac | xargs -P 4 rm -rv`的灵感来自[Burton Samograd](https://stackoverflow.com/users/450756)关于`xargs -P`

```
$ mkdir -p a/b/c/d
mkdir: created directory `a'
mkdir: created directory `a/b'
mkdir: created directory `a/b/c'
mkdir: created directory `a/b/c/d'

$ touch a/1 a/2 a/3 a/b/4 a/b/5

$ tar cf a.tar a

$ rm -rfv a
removed directory: `a/b/c/d'
removed directory: `a/b/c'
removed `a/b/4'
removed `a/b/5'
removed directory: `a/b'
removed `a/3'
removed `a/1'
removed `a/2'
removed directory: `a'

$ tar xvf a.tar | tac | xargs -P 4 rm -rv
removed `a/2'
removed `a/1'
removed `a/3'
removed `a/b/5'
removed `a/b/4'
removed directory: `a/b/c/d'
removed directory: `a/b/c'
removed directory: `a/b'
removed directory: `a' 
```

# python - 使用请求和多处理时的奇怪问题

> ID：10438802
> 
> 赞同：4
> 
> 时间：2012-05-03T20:24:02.050
> 
> 标签：python, linux, multiprocessing, kill, python-requests

请检查这个python代码：

```
#!/usr/bin/env python
import requests
import multiprocessing
from time import sleep, time
from requests import async

def do_req():
    r = requests.get("http://w3c.org/")

def do_sth():    
    while True:
        sleep(10)

if __name__ == '__main__':        
    do_req()
    multiprocessing.Process( target=do_sth, args=() ).start() 
```

当我按 Ctrl-C （运行后等待 2 秒 - 让进程运行）时，它不会停止。当我将导入顺序更改为：

```
from requests import async
from time import sleep, time 
```

它在 Ctrl-C 之后停止。为什么它在第一个示例中没有停止/杀死？

这是一个错误还是一个功能？

笔记：

*   是的，我知道，我没有在这段代码中使用异步，这只是精简代码。在实际代码中我使用它。我这样做是为了简化我的问题。
*   按下 Ctrl-C 后，有一个新的（子）进程正在运行。为什么？
*   `multiprocessing.__version__ == 0.70a1`, `requests.__version__ == 0.11.2`,`gevent.__version__ == 0.13.7`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T10:29:41.543

请求异步模块使用 gevent。如果你查看 gevent 的源代码，你会发现它对Python 的许多标准库函数进行了[猴子补丁，包括 sleep：](http://en.wikipedia.org/wiki/Monkey_patch)

导入期间的 request.async 模块执行：

```
 from gevent import monkey as curious_george
    # Monkey-patch.
    curious_george.patch_all(thread=False, select=False) 
```

查看 gevent 的 monkey.py 模块，您可以看到：

[https://bitbucket.org/denis/gevent/src/f838056c793d/gevent/monkey.py#cl-128](https://bitbucket.org/denis/gevent/src/f838056c793d/gevent/monkey.py#cl-128)

```
def patch_time():
    """Replace :func:`time.sleep` with :func:`gevent.sleep`."""
    from gevent.hub import sleep
    import time
    patch_item(time, 'sleep', sleep) 
```

查看 gevent 存储库中的代码以获取详细信息。

# c# - RequestSecurityTokenResponse 不会反序列化

> ID：10438805
> 
> 赞同：1
> 
> 时间：2012-05-03T20:24:08.997
> 
> 标签：c#, wcf, deserialization, sts-securitytokenservice, servicecontract

我有一个连接到 STS 服务器的 WCF 客户端，我无法控制它（它是第 3 方 PHP 服务）。

经过几天的研究，我设法以它接受的方式与服务器交谈，使用纯 WCF。当然，将一些字符放到网络上会很容易，而忽略所有 SOAP 内容。但最后我设法猜对了每个配置参数，所以 STS 服务这样回答我的请求

```
<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/">
  <Body>
    <RequestSecurityTokenResponse xmlns="http://schemas.xmlsoap.org/ws/2005/02/trust">
      <TokenType>http://schemas.xmlsoap.org/ws/2005/02/sc/sct</TokenType>
      <RequestedSecurityToken>
        <SecurityContextToken xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
              <Identifier>bipro:D5J9M0...</Identifier>
        </SecurityContextToken>
      </RequestedSecurityToken>
    </RequestSecurityTokenResponse>
  </Body>
</Envelope> 
```

但是现在我无法提取标识符值。对于我的代理类 ( )，我尝试了所有类型的,和的所有`SecurityTokenServicePortTypeClient : ClientBase<SecurityTokenServicePortType>, SecurityTokenServicePortType`可以想象的组合。但我得到的只是。`ServiceContract``DataContract``XmlSerialization``null`

服务合同的（大量修改的）接口看起来像这样

```
[ServiceContract(Namespace = "http://schemas.xmlsoap.org/ws/2005/02/trust")]
public interface SecurityTokenServicePortType {
  [OperationContract(Action = "urn:RequestSecurityToken", ReplyAction = "*")]
  object RequestSecurityToken();
} 
```

（大量修改的）实现类有这样的方法

```
object SecurityTokenServicePortType.RequestSecurityToken() {
  var x = base.Channel.RequestSecurityToken();
  return x;
} 
```

x 总是`null`。

而不是它的返回类型`object`最初是`RequestSecurityTokenResponse`等等。

几年前我在 WSE 上遇到过同样的问题，我能够通过使用正确的组合来解决这个问题，例如`XmlElementAttribute`控制反序列化过程。但这一次似乎没有帮助。

感谢您的任何建议！

比约恩

# python - 从列表中检索元素：python

> ID：10438807
> 
> 赞同：2
> 
> 时间：2012-05-03T20:24:21.297
> 
> 标签：python

可能是一个非常幼稚的问题：

我有一个清单：

```
color = ["red","blue","red","green","blue"] 
```

现在，我想遍历列表

```
for c in color:
   # color is "red"
     get the rest of the colors except this red
    so rest = ["blue","red","green",blue"] 
```

在下一次迭代中：

```
 c = blue
    rest = ["red","red","green","blue"] 
```

嗯。为什么我觉得这很简单……而且可能有一个单行命令可以解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T20:27:16.677

想到这一点的最简单方法是，您要遍历每个长度比列表小一的组合。为此，我们可以使用`itertools.combinations()`：

```
import itertools

color = ["red","blue","red","green","blue"]

for rest in itertools.combinations(color, len(color)-1):
    print(rest) 
```

这给了我们：

```
('red', 'blue', 'red', 'green')
('red', 'blue', 'red', 'blue')
('red', 'blue', 'green', 'blue')
('red', 'red', 'green', 'blue')
('blue', 'red', 'green', 'blue') 
```

这是一个很好的解决方案，因为它适用于可迭代对象和序列，非常易读，并且应该又好又快。

如果你还需要当前值，你也可以很容易地得到它，因为`combinations()`它给你一个可预测的顺序，所以我们只是同时迭代两者`zip()`（当然，如果你想要最好的性能，`itertools.izip()`在 Python 2.x 下使用， as`zip()`创建一个列表，而不是 3.x 中的生成器）。

```
import itertools

color = ["red","blue","red","green","blue"]

for c, rest in zip(color, itertools.combinations(reversed(color), len(color)-1)):
    print(c, rest)

red ('blue', 'green', 'red', 'blue')
blue ('blue', 'green', 'red', 'red')
red ('blue', 'green', 'blue', 'red')
green ('blue', 'red', 'blue', 'red')
blue ('green', 'red', 'blue', 'red') 
```

在这里，我反转输入，`comibinations()`使其从左到右工作 - 您可以反转`color`以`zip()`从右到左。

所以是的，简而言之，这是一个单行解决方案（如果计算导入，则为两个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:43:46.913

这也应该有效

```
for i in range(len(yourlist)):
    newlist = yourlist[:i] + yourlist[i:] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:38:23.817

切片和*枚举*可以轻松完成这项任务：

```
>>> colors = ["red", "blue", "red", "green", "blue"]
>>> for i, color in enumerate(colors):
        rest = colors[:i] + colors[i+1:]
        print color, '-->', rest

red --> ['blue', 'red', 'green', 'blue']
blue --> ['red', 'red', 'green', 'blue']
red --> ['red', 'blue', 'green', 'blue']
green --> ['red', 'blue', 'red', 'blue']
blue --> ['red', 'blue', 'red', 'green'] 
```

[*枚举*](http://docs.python.org/library/functions.html#enumerate)跟踪每种颜色的位置，切片提取颜色之前和之后的列表部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T13:42:02.920

以下示例将返回删除重复项的列表。它从一个空的返回列表开始，检查颜色列表，如果一种颜色（在本例中为红色）已经在输出中，则将其忽略。

```
#!/usr/bin/env python

color = ["red","blue","red","green","blue"]

def rem_dup(dup_list):
    corrected_list = []
    for color in dup_list:
        if color in corrected_list:
            continue
        else:
            corrected_list.append(color)

    return corrected_list 
```

你可能会更好地使用类似的东西

```
>>> set(color)
set(['blue', 'green', 'red'])
>>> 
```

或者

```
>>> import collections
>>> color = ["red","blue","red","green","blue"]
>>> collections.OrderedDict.fromkeys(color)
OrderedDict([('red', None), ('blue', None), ('green', None)])
>>> 
```

删除重复项。两者都比 for 循环更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-03T20:27:30.243

此 Python 代码将创建一个没有重复项的新输出列表。

```
done = []
for c in color:
    if c in done:
        continue
    done.append(c)
    print c 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-05-03T20:28:33.880

```
for idx, item in enumerate(color):
    print 'I am %s' % item
    rest = color[:idx] + color[idx+1:]
    print 'Rest is %s' % ','.join(rest) 
```

# iphone - MPMoviePlayerController 导致所有其他音频变软（MP 完成后）

> ID：10438810
> 
> 赞同：0
> 
> 时间：2012-05-03T20:24:31.550
> 
> 标签：iphone, mpmovieplayercontroller, avcapturesession, avaudiosession

我有一个播放一些背景音乐的应用程序，当按下某个按钮时，它会使用导航控制器推送一个新视图。这个新视图有一个 MPMoviePlayerController 和一个带有共享 AudioSession 的 AVCaptureSession。关闭该视图后，与之前相比，背景中的声音确实很柔和。是什么原因导致播放后音量如此低？

```
NSError* error4 = nil;
AVAudioSession* audioSession = [AVAudioSession sharedInstance];
if (![audioSession setCategory:AVAudioSessionCategoryPlayAndRecord error:&error4]) {
    NSLog(@"AVAudioSession setCategory failed: %@", [error4 localizedDescription]);
}

// Set audio session property "allow mixing" to true so audio can be recorded while it is playing
UInt32 allowMixing = true;
OSStatus status = AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof(allowMixing), &allowMixing);
if (status != kAudioSessionNoError) {
    NSLog(@"AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryMixWithOthers) failed: %ld", status);
}

// Activate the audio session
error4 = nil;
if (![audioSession setActive:YES error:&error4]) {
    NSLog(@"AVAudioSession setActive:YES failed: %@", [error4 localizedDescription]);
}
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectoryPath = [paths objectAtIndex:0];

NSString *proud = [[documentsDirectoryPath stringByAppendingPathComponent:@"imissyou"] stringByAppendingPathComponent:selectedCountry];

NSURL  *movieURL = [[NSURL fileURLWithPath:proud] retain];
player =

[[MPMoviePlayerController alloc] initWithContentURL: movieURL];
player.useApplicationAudioSession=YES;

[player prepareToPlay];
player.controlStyle = MPMovieControlStyleNone;
player.allowsAirPlay = NO;
player.scalingMode = MPMovieScalingModeFill;   

player.view.frame = self.view.frame;

[self.view insertSubview:player.view belowSubview:vImagePreview];

[player setFullscreen:YES animated:YES];

// ...

[[NSNotificationCenter defaultCenter] 
 addObserver:self
 selector:@selector(movieFinishedCallback:)
 name:MPMoviePlayerPlaybackDidFinishNotification
 object:player];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(exitedFullscreen:) name:MPMoviePlayerDidExitFullscreenNotification object:player];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayerWillExitFullscreen:)
                                             name:MPMoviePlayerWillExitFullscreenNotification
                                           object:player];

[player play];

session = [[AVCaptureSession alloc] init];
[session beginConfiguration];
session.sessionPreset = AVCaptureSessionPresetMedium;

CALayer *viewLayer = self.vImagePreview.layer;
NSLog(@"viewLayer = %@", viewLayer);

AVCaptureVideoPreviewLayer *captureVideoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
captureVideoPreviewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
captureVideoPreviewLayer.frame = self.vImagePreview.bounds;
[captureVideoPreviewLayer setCornerRadius:14];
[captureVideoPreviewLayer setBorderWidth:3.0];
[captureVideoPreviewLayer setBorderColor:[[UIColor whiteColor] CGColor]];
[[vImagePreview layer] setCornerRadius:14];

[[vImagePreview layer] setBorderWidth:3.0];

[[vImagePreview layer] setBorderColor:[[UIColor whiteColor] CGColor]];

[self.vImagePreview.layer addSublayer:captureVideoPreviewLayer];
[captureVideoPreviewLayer release];
AVCaptureDevice *device = [self frontFacingCameraIfAvailable];
NSError *error = nil;
AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:device error:&error];
if (!input) {
    // Handle the error appropriately.
    NSLog(@"ERROR: trying to open camera: %@", error);
}

AVCaptureDevice *audioCaptureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
NSError *error2 = nil;
AVCaptureDeviceInput *audioInput = [AVCaptureDeviceInput deviceInputWithDevice:audioCaptureDevice error:&error2];

AVCaptureMovieFileOutput *movieFileOutput = [[AVCaptureMovieFileOutput alloc] init];

NSString *archives = [documentsDirectoryPath stringByAppendingPathComponent:@"archives"];
NSString *editedfilename = [[selectedCountry lastPathComponent] stringByDeletingPathExtension];
NSString *datestring = [[editedfilename stringByAppendingString:@" "] stringByAppendingString:currentTime];
NSLog(@"%@", datestring);
NSString *outputpathofmovie = [[archives stringByAppendingPathComponent:datestring] stringByAppendingString:@".mp4"];
NSURL *outputURL = [[NSURL alloc] initFileURLWithPath:outputpathofmovie];
[session addInput:input];
[session addInput:audioInput];
[session addOutput:movieFileOutput];
[session commitConfiguration];
[session startRunning];
[movieFileOutput startRecordingToOutputFileURL:outputURL recordingDelegate:self];
[movieURL release];
[outputURL release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:10:50.017

音频会话可能正在“躲避”背景音乐。您可能希望将属性“kAudioSessionProperty_OtherMixableAudioShouldDuck”设置为 false 以禁用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T15:57:26.783

我现在明白了。我将类别设置为 PlayAndRecord。我将其更改为 Ambient（它还允许在播放音频时录制音频）并删除 OverrideCategoryMixWithOthers 的属性，只留下

```
OSStatus propertySetError = 0; 
UInt32 allowMixing = true; 
propertySetError |= AudioSessionSetProperty(kAudioSessionProperty_OtherMixableAudioShouldDuck, sizeof(allowMixing), &allowMixing); 
```

# android - Android 中带有服务器名称指示扩展 (RFC 3546) 的 TLS

> ID：10438814
> 
> 赞同：5
> 
> 时间：2012-05-03T20:24:52.890
> 
> 标签：android, https, ssl, sni

我正在构建一个需要使用 https 的 Android 应用程序。我对不使用带有[服务器名称指示扩展](https://www.rfc-editor.org/rfc/rfc3546#section-3.1)的 TLS 的 https 地址进行 https 连接没有问题。但我需要连接到使用带有 SNI 扩展的 TLS 的 https 地址。

我为使用没有主机名扩展名的 TLS 的 https 地址所做的是：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("https://exampleurl.com/api");

    try {

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("username", email));
        nameValuePairs.add(new BasicNameValuePair("ssh_public_key", publickey));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        HttpResponse response = httpclient.execute(httppost);

        Log.d(TAG, response.toString());

        return response.toString();

    } catch (Exception e) {
        Log.d(TAG, e.toString());
    } 
```

如何在 Android 的 TLS 中添加服务器名称指示扩展。经过研究，我发现了一篇关于 stackoverflow 的帖子，但我无法让它与这些信息一起工作。

但它有点在路上“据我所知，Android SDK有部分支持。目前的情况如下：

自 Gingerbread 发布以来，与 HttpsURLConnection API 的 TLS 连接支持 SNI。Android 附带的 Apache HTTP 客户端库不支持 SNI Android Web 浏览器也不支持 SNI（因为使用了 Apache HTTP 客户端 API）”

“感谢您的帮助。我已经使用 android sdk 中的 SSLCONTEXT(TLS) 和 SSLENGINE 类尝试了 sni.velox.ch 链接。我正在握手。”

[Android SSL - SNI 支持](https://stackoverflow.com/questions/5879894/android-ssl-sni-support)

这篇文章给出的答案是这将在 Android 中运行，但我无法使用 HttpsURLConnection、SSLCONTEXT(TLS) 和 SSLENGINE 来实现。

任何机构都可以提供如何在 TLS 中设置服务器名称指示扩展的代码示例吗？

# android - 检查这是否是 LinearLayout 中的最后一个 EditText？

> ID：10438823
> 
> 赞同：2
> 
> 时间：2012-05-03T20:25:50.217
> 
> 标签：android, android-layout, android-edittext

假设在 LinearLayout 中我们有两个 EditText。Android系统能够以某种方式判断一个EditText是否是最后一个EditText，因为第一个EditText的软键盘的“Enter”按钮是“Next”，而第二个EditText的软键盘的“Enter”按钮是“完毕”。这是我用来测试 EditText 的代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    LinearLayout editContainer = new LinearLayout(this);
    editContainer.setOrientation(LinearLayout.VERTICAL);

    EditText firstEdit = new EditText(this);
    firstEdit.setSingleLine(true);

    EditText secondEdit = new EditText(this);
    secondEdit.setSingleLine(true);

    editContainer.addView(firstEdit);
    editContainer.addView(secondEdit);

    setContentView(editContainer);
} 
```

有人能告诉我如何以编程方式知道 EditText 是否是最后一个吗？当然，我可以遍历整个 LinearLayout，但我想保留这种方法作为最后的手段。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:44:06.903

Next/Done 标签使用[setImeOptions](http://developer.android.com/reference/android/widget/TextView.html#setImeOptions%28int%29)设置。如果你想查询这个值，你可以试试[getImeOptions](http://developer.android.com/reference/android/widget/TextView.html#getImeOptions%28%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:30:12.250

快速简便的方法是为您的视图添加“最后”标签。

```
EditText secondEdit = new EditText(this);
secondEdit.setSingleLine(true);
secondEdit.setTag('last'); 
```

你会得到这个值`view.getTag()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T20:34:12.657

您可以为 EditTexts 提供唯一的 ID，例如：

```
 mEditText1.setId(1);
    mEditText2.setId(2); 
```

`mEditText.getId()`然后，您可以通过将其 id ( ) 与 EditText 总数进行比较来检查焦点 EditText 是否是最后一个。

同样，您可以使用`setTag()`and`getTag()`方法。

# sql - Bit的可变类型

> ID：10438824
> 
> 赞同：1
> 
> 时间：2012-05-03T20:25:54.473
> 
> 标签：sql, boolean, bit

我从数据库表中获取值并将它们保存在相应的变量类型中。我对当我从数据库中获取 BIT 类型数据（即 True 或 False）时，我应该使用什么类型的数据类型将其保存在 .

例如

```
public string Industry { get; set; }
        public bool CO2e { get; set; }
        public int ID { get; set; } 
```

这里 Industry 和 ID 分别是 string 和 int 类型。但是 ISEFCO2e 是我用于来自表的 BIT 类型数据的变量。那么使用 bool 是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:27:23.630

对，那是正确的。请参见[此处](http://msdn.microsoft.com/en-us/library/ms177603.aspx)：字符串值 TRUE 和 FALSE 可以转换为位值：TRUE 转换为 1，FALSE 转换为 0。

请注意，一个位可能只包含 1 或 0。这就是以持久方式表示布尔值所需的全部内容。请注意，特别是对于 SQL 服务器，数据库将按字面意思返回“true”和“false”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:29:37.483

位只有两个值，它们是 0/1，所以 a`bool`是这样一个值的完美匹配。

# php - phpmailer & 在主题中作为 &

> ID：10438829
> 
> 赞同：2
> 
> 时间：2012-05-03T20:26:15.080
> 
> 标签：php, phpmailer, ampersand

我正在使用 PHPMailer 并通过我的 gmail 帐户使用 SMTP 发送电子邮件。这一切都有效，除非`&`主题中有一个，然后在我的收件箱中主题有`&amp;`

有什么办法让这种情况不会发生？我试过设置字符集并对主题进行编码。

我的代码如下

```
$mail             = new PHPMailer();
$mail->IsSMTP(); // telling the class to use SMTP
$mail->CharSet = 'UTF-8';
$mail->SMTPDebug  = false;
$mail->SMTPAuth   = true;                  // enable SMTP authentication
$mail->SMTPSecure = "tls";                 // sets the prefix to the servier
$mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
$mail->Port       = 587;                   // set the SMTP port for the GMAIL server
$mail->Username   = "myusername@gmail.com";  // GMAIL username
$mail->Password   = "password";            // GMAIL password
$mail->SetFrom('from@somesite.com', 'From Person');
$mail->AddReplyTo("from@somesite.com", "From Person");
$mail->Subject    = 'An example with a & in the middle';
$mail->MsgHTML('Some text to send');
$mail->AddAddress('myusername@gmail.com');
$mail->Send() 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T13:36:27.397

尝试使用此代码，让我知道它是否有帮助。

```
$mail->Subject    = "=?UTF-8?B?".base64_encode($_POST['subject'])."?="; 
```

# windows - 安装 NDIS 轻量级过滤器需要重新启动操作系统

> ID：10438830
> 
> 赞同：1
> 
> 时间：2012-05-03T20:26:24.753
> 
> 标签：windows, networking, device-driver, ndis

我正在尝试开发一个动态加载 NDIS 6.0 轻量级过滤器并稍后卸载它的工具。我遇到了一个问题。某些系统需要在过滤器安装后重新启动。（INetCfgClassSetup:Install 返回 0x4A020 NETCFG_S_REBOOT）。驱动程序未加载。然而其他系统会立即加载驱动程序，一切正常。轻量级过滤器与 WinDDK 中 src\network\ndis\filter 中的示例几乎相同。我的假设是轻量级过滤器应该加载而不需要重新启动操作系统。这是一个有效的假设吗？如果是，如何对需要重新启动的系统进行故障排除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T23:09:14.297

添加新的 ndis 过滤器时，系统必须暂停并重新启动所有驱动程序堆栈。也许其他一些过滤器会阻止重新启动驱动程序堆栈（例如防火墙 ndis 过滤器）。

# android - MediaPlayer的Android控制速度可以吗？

> ID：10438831
> 
> 赞同：0
> 
> 时间：2012-05-03T20:26:25.880
> 
> 标签：android, android-mediaplayer

MediaPlayer的Android控制速度可以吗？我需要实现将速度乘以或除以两个（用户单击 x2 和 /2 按钮，超过 100MB 的非常大的文件）。如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:03:41.030

Android MediaPlayer 不提供对播放速率的直接访问。但是，SoundPool 可以。尝试其中的 setRate(int streamID, float rate) 函数。

[http://developer.android.com/reference/android/media/SoundPool.html](http://developer.android.com/reference/android/media/SoundPool.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-12T23:31:04.727

[API 23+ 的setPlaybackParams](https://developer.android.com/reference/android/media/MediaPlayer.html#setPlaybackParams(android.media.PlaybackParams))现在应该可以实现了。

# extjs - 将 JSON 中的 getTotalCount() 值添加到变量中

> ID：10438833
> 
> 赞同：0
> 
> 时间：2012-05-03T20:26:36.860
> 
> 标签：extjs

该程序应检查 getTotalCount() 的值是否大于一个数字（例如 10），如果是则显示警报窗口。

我的问题是如何将 getTotalCount() 的值分配给变量。

```
var Store = new Ext.data.Store({
        id: 'ID_Store',
        proxy: new Ext.data.HttpProxy({
                url: 'get.php',      
                method: 'POST'
            }),
        baseParams:{task: "LIST"}, 
        reader: new Ext.data.JsonReader({   
                    root: 'results',
                    totalProperty: 'total',
                    id: 'id'
                },[ 
                    {name: 'IDclass', type: 'int', mapping: 'id_class'},
                    {name: 'Class', type: 'string', mapping: 'class'}
                ])
    });

Store.load;
var total_num = Store.getTotalCount();

if(total_num > 10){
    alert("greater than 10");
} 
```

JSON是：

```
{success:true}{total:23,results:[{"id_class":"1","class":"V-1"},{"id_class":"2","class":"V-2"},{"id_class":"3","class":"V-3"},{"id_class":"4","class":"V-4"},{"id_class":"5","class":"V-5"},{"id_class":"6","class":"VI-1"},{"id_class":"7","class":"VI-2"},{"id_class":"8","class":"VI-3"},{"id_class":"9","class":"VI-4"},{"id_class":"10","class":"VI-5"},{"id_class":"11","class":"VII-1"},{"id_class":"12","class":"VII-2"},{"id_class":"13","class":"VII-3"},{"id_class":"14","class":"VII-4"},{"id_class":"15","class":"VII-5"},{"id_class":"16","class":"VIII-1"},{"id_class":"17","class":"VIII-2"},{"id_class":"18","class":"VIII-3"},{"id_class":"19","class":"VIII-4"},{"id_class":"20","class":"VIII-5"}]} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T21:19:07.907

将样品的末尾替换为：

```
Store.on('load', function() {

  var total_num = Store.getTotalCount();

  if(total_num > 10){
     alert("greater than 10"); 
  }

}, this, { single: true });
Store.load(); 
```

# sharepoint-2010 - 给项目创建者的 Sharepoint 列表项目警报

> ID：10438835
> 
> 赞同：1
> 
> 时间：2012-05-03T20:26:48.053
> 
> 标签：sharepoint-2010

我正在尝试设置警报以在编辑项目时转到项目创建者。谁能指出我正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T09:29:51.553

试试这个网站

[http://technet.microsoft.com/en-us/library/cc288540%28v=office.12%29.aspx](http://technet.microsoft.com/en-us/library/cc288540%28v=office.12%29.aspx)

[http://office.microsoft.com/en-us/windows-sharepoint-services-help/create-an-alert-or-subscribe-to-an-rss-feed-HA010215103.aspx](http://office.microsoft.com/en-us/windows-sharepoint-services-help/create-an-alert-or-subscribe-to-an-rss-feed-HA010215103.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T12:09:37.953

创建一个处理[ItemAdded的](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spitemeventreceiver.itemadded.aspx)[事件接收器](http://msdn.microsoft.com/en-us/library/ee231563.aspx)。使用以下代码获取项目的作者：

```
SPWeb web = properties.Web;
SPListItem item = properties.ListItem;
SPFieldUserValue userValue = 
    new SPFieldUserValue(web, item[SPBuiltInFieldId.Author].ToString());
SPUser user = userValue.User; 
```

然后，您可以为当前项目向用户[添加](http://msdn.microsoft.com/en-us/library/ee577543.aspx)新的[SPAlert 。](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spalert.aspx)

# android - 自动截断 TextView 文本以免与另一个 TextView 重叠

> ID：10438837
> 
> 赞同：5
> 
> 时间：2012-05-03T20:26:54.067
> 
> 标签：android, xml, android-layout

我有一个`ListView`显示一堆家庭作业的。这些`ListView`项目使用 a`FrameLayout`来定位两个`TextViews`。第一个`TextView`是左对齐，第二个是右对齐。（两者都垂直居中对齐。）第一个显示作业描述的片段，第二个显示截止日期。

我想要做的是使截止日期占用尽可能多的空间，并且描述会填满剩余的空间，如下所示：

|------------------------------------------------- ---|
| 阅读第 15-35 页，更新时间... 5 月 4 日星期五|
|------------------------------------------------- ---|

现在，描述文本将继续与日期重叠。它会在行尾截断。

无论如何我可以在 XML 中执行此操作，还是必须在设置`TextView`值之前通过缩短字符串在代码中执行此操作（大概在我的`getView`调用中）？如果我在代码中这样做，我必须计算字符串将占用的水平空间量，以确定描述需要多短。这似乎会变得混乱......

非常感谢有关如何完成此操作的任何其他建议！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T20:29:12.663

尝试使用 ellipsize 属性，例如：

```
<TextView android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:ellipsize="end"
      android:singleLine="true"/> 
```

* * *

请注意，Android 或至少某些版本需要“ellipsize”和“singleline”属性，以便系统实际执行截断并添加省略号。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-03T20:32:18.350

这是 LinearLayout 或 RelativeLayout 与 ellipsize 组合的理想位置，而不是 FrameLayout：

```
<LinearLayout
  android:orientation="horizontal"
  android:layout_width="match_parent"
  android:layout_height="wrap_content" >

  <TextView
    ...
    android:width="0dp"
    android:height="wrap_content"
    android:layout_weight="1" 
    android:ellipsize="end" />

  <TextView
    ...
    android:width="wrap_content"
    android:height="wrap_content"
    android:layout_weight="0" />

</LinearLayout> 
```

或者交替

```
<RelativeLayout
  android:layout_width="match_parent"
  android:layout_height="wrap_content" >

  <TextView
    ...
    android:id="@+id/secondTV"
    android:width="wrap_content"
    android:height="wrap_content"
    android:layout_weight="0" />

  <TextView
    ...
    android:width="0dp"
    android:height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_toLeftOf="@id/secondTV" 
    android:ellipsize="end"/>

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:33:02.993

将 FrameLayout 更改为 LinearLayout 或 RelativeLayout。

*   LinearLayout：使到期日期宽度“wrap_content”和描述宽度0dp，然后将layout_weight =“1”添加到描述中

*   相对布局：首先使用宽度 wrap_content 布局到期日，然后按照应在到期日左侧的规则布局描述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-05T19:32:24.430

Anton 和 JRaymond 都非常投入（JRaymond 用他的例子帮我弄清楚了）。这就是我想出的：

```
<RelativeLayout android:layout_width="fill_parent"
        android:layout_height="fill_parent">
        <TextView android:id="@+id/due_date"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_alignParentRight="true"
            android:singleLine="true" />

        <TextView android:id="@+id/description"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_alignParentLeft="true"
            android:layout_toLeftOf="@id/due_date"
            android:singleLine="true" />
</RelativeLayout> 
```

（我需要先声明我的截止日期标签，以便我可以在描述中引用它。我也刚刚意识到 android:ellipsize 似乎是可选的——我猜它默认为“结束”。）

非常感谢！

# php - 文件结构问题，来自 php 的 ftp。

> ID：10438838
> 
> 赞同：0
> 
> 时间：2012-05-03T20:26:57.600
> 
> 标签：php, ftp

所以我正在尝试制作一个功能来制作文件夹和所有内容（带有子文件夹）的本地副本并将副本发送到远程服务器，本地副本很好，但 ftp 副本的格式不一样应该。他们都有所有文件，但 ftp 版本没有正确格式化文件结构。我看了但找不到任何有这个问题的帖子，所以任何指针都会有帮助。

示例：正确

*   主要的

    *   子1
    *   子 2
    *   子 3
    *   子 4
        *   4 - 1 分
        *   4 - 2 的子

但这就是我得到的，

*   主要的
    *   子 4
        *   子 0f 4 - 1
            *   子 0f 4 - 2
                *   子 3
                    *   子 2
                        *   子 1

这是代码：

```
function copyr($source, $dest, $conId) {
    $sourceName = explode('/',$dest); 
    $sourceName = $sourceName[count($sourceName)-1];

    // copy file
    if (is_file($source)) {
        $upLink = ftp_fput($conId, $sourceName, fopen($source, 'r'), FTP_ASCII);
        return copy($source, $dest);
    }
    // Make destination directory
    if (!is_dir($dest)) {
        mkdir($dest);
        ftp_mkdir($conId, $sourceName);
        ftp_chdir($conId, $sourceName);
    } else if(is_dir($dest)){ // go to one that has been made.
        ftp_chdir($conId, $sourceName);
    }
    // Loop the folder
    $dir = dir($source);
    while (false !== $entry = $dir->read()) {
        // Skip pointers
        if ($entry == '.' || $entry == '..') {
            continue;
        }
        // Copy sub directories
        if ($dest !== "$source/$entry") {
            copyr("$source/$entry", "$dest/$entry", $conId, $entry);
        }
    }
    // Clean up
    $dir->close();
    return true;
}
$source = 'images';
$dest = 'NewImages';
if(copyr($source, $dest, $conId)){
    echo "It's finished .... Good.";
} else {
    echo "Failed ... ";
}
ftp_close($conId); 
```

在查看 .net Manual for ftp 后，我从 php.net 复制了其中的一部分，将其他部分放在一起。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:36:57.780

`cd ..`从递归返回后，您忘记退出目录（例如）。

# php - 设置 MySQL 表以跟踪用户链接点击

> ID：10438842
> 
> 赞同：1
> 
> 时间：2012-05-03T20:27:21.927
> 
> 标签：php, mysql, sql, database

这是我几天前发布的一个问题的后续。

基本上，我有一个包含六个链接的网站。为了访问该站点，用户必须使用 LDAP 身份验证登录。当他们这样做时，我会获取他们的一些帐户凭据（用户名、名字、姓氏），并将其存储在 PHP $_SESSION 变量中。

这样可行; 用户可以登录，会话数据存储成功。

现在，我想建立一种方法来跟踪哪些用户点击了哪些链接。基本上只是在他们点击链接的数据库中存储一个时间戳。我希望能够查看谁（或没有）点击了每个链接，以及何时点击。

我可以在一个表中执行此操作/这是一个坏主意吗？我在想这样设置表：

表（每个项目符号表示一列）

*   自增 ID
*   用户帐号名：abc1234
*   用户帐户名：John
*   链接 1：上次访问时间为 2012 年 5 月 2 日下午 4:15
*   链接2：空
*   链接3：空
*   链接 4：上次访问时间为 2012 年 5 月 1 日下午 2:20
*   链接5：空
*   链接6：空

基本上上面会说“约翰”只点击了第一个和第四个链接。其余的都是空的，因为他从未访问过它们。如果他再次单击#1，它将被更新的日期/时间覆盖。

我可以在一个表中执行此操作吗？还是会造成并发症？我觉得我最难的事情是在添加信息之前检查用户是否已经在数据库中（即，如果约翰第二次登录，则不会为他创建一个全新的行)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:31:32.587

那将是一个坏主意。如果你想有第七个链接怎么办？如果用户格式发生变化怎么办？

此解决方案需要 3 个表：

*   用户 - 包含用户数据（和用户 ID）。
*   链接 - 包含链接数据（和链接 ID）。
*   点击 - 用户和链接之间的多对多关系。

第三个表看起来像这样：

```
user_id | link_id | timestamp
-----------------------------
1       | 2       | ...
2       | 2       | ...
1       | 3       | ...
............ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:34:40.877

为什么不只是有

```
increment_ID
Account_ID
Link_URL
Timestamp 
```

然后只需为每次点击插入一条新记录。您也不需要管理链接，因为您将存储整个 URL 路径

# php - Wordpress - 多个帖子查询

> ID：10438848
> 
> 赞同：0
> 
> 时间：2012-05-03T20:27:45.747
> 
> 标签：php, wordpress

我正在使用以下代码来查询帖子的类别：

```
<?php query_posts("cat=8"); ?>
<?php if ( have_posts() ) while ( have_posts() ) : the_post(); ?>
            <article>
                <h4><?php the_title(); ?> </h4>
                 <p><?php the_content(); ?></p>
             </article>
    <?php endwhile; ?> 
```

它似乎工作正常，直到我在一个页面上第三次（上面的代码的三个实例）做了它。现在页面似乎永远加载并且它中断，好像它正在编译超过 1 个页面模板。我应该提一下，除非我将帖子发布到第三类，否则一切正常

有没有人遇到过这样的问题，或者知道为什么会这样？这是查询帖子的坏习惯吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:58:25.800

请改用 WP_query，这样您就可以使用 wp_reset_postdata 来解决问题。

```
<?php
$the_query = new WP_Query( 'cat=8' );
while ( $the_query->have_posts() ) : $the_query->the_post();
?>
    <article>
        <h4><?php the_title(); ?> </h4>
        <p><?php the_content(); ?></p>
    </article>
<?php
endwhile;
wp_reset_postdata();
?> 
```

# vb.net - 方法重载得到错误的重载

> ID：10438850
> 
> 赞同：1
> 
> 时间：2012-05-03T20:27:54.730
> 
> 标签：vb.net, methods, overloading

我在说服 Visual Studio 和编译器使用正确的方法重载时遇到问题，可能是因为继承。

给定这些对象：

```
Public Class Matrix
...
End Class

Public Class Vector
Inherits Matrix
...
End Class 
```

模块中存在两种方法：

```
Public Function Add(vector1 as Vector, vector2 as Vector) as Vector
...
End Function

Public Function Add(matrix1 as Matrix, matrix2 as Matrix) as Matrix
...
End Function 
```

但是，当我在两个 Vector 对象上显式调用 Add() 时，我得到一个 InvalidCastException，因为无法将 Vector 强制转换为 Matrix 以使用该函数的 Matrix 化身。我的印象是编译器会尝试使用最具体的方法，因此对于这些参数使用 Vector 方法。此外，如果有任何歧义，编译器会捕获这些并提供错误。

1.  这种行为是否符合规范？
2.  是否可以强制使用 Vector 方法？我已经尝试过强制转换这两个参数，但由于它们已经被标注为向量，所以它没有效果。

**编辑**：请求调用代码

注意这两个 Add 方法在同一个 Math 模块中，即

```
Public Module Math
    Public Function Add(vector1 as Vector, vector2 as Vector) as Vector
    ...
    End Function

    Public Function Add(matrix1 as Matrix, matrix2 as Matrix) as Matrix
    ...
    End Function

    Public Function Subtract(ByVal vector1 As Vector, ByVal vector2 As Vector) As Vector
        Return Add(vector1, -vector2)
    End Function
End Module 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T21:07:57.837

答案：

1.  不它不是; 您的项目中可能定义了多个 Vector 或 Matrix 类型的对象。这就是您收到 InvalidCastException 的原因。
2.  你不需要。

# vba - 在 %TEMP% 中写入文件以静默方式失败

> ID：10438855
> 
> 赞同：4
> 
> 时间：2012-05-03T20:28:08.413
> 
> 标签：vba, vb6, windows-server-2008

我有这个写入我的日志文件的函数。它正在默默地失败。因为此函数中没有引发错误，它只是无法创建或写入文件。我正在尝试写信给`%TEMP%\myappname.log`. 它也失败了`%USERPROFILE%\Desktop\myappname.log`。服务器是 Windows Server 2008 R2 标准。我在使用其他程序写入应用程序文件夹时遇到了这种情况，因此转而写入`%TEMP%`目录，这解决了它。但是这个系统甚至不允许我写入`%TEMP%`目录。是的，我也尝试以管理员身份运行，但没有帮助。在这种情况下，%TEMP% 解析`ExpandEnvironmentStrings`为`C:\Users\sa\AppData\Local\Temp\2` So g_strLogPath is `C:\Users\sa\AppData\Local\Temp\2\myappname.log`。

```
Public Function LogMessage(ByVal strInput As String, Optional ByVal blnDate As Boolean = False) As Boolean

   Dim intFileNumber As Integer

   On Error GoTo ErrorHandler

   If g_lngLogLevel <> 1 Then
      Exit Function
   End If

   If Len(g_strLogPath) = 0 Then
      SetLogPath
   End If

   If blnDate Then
      strInput = Format(Now, cstrLogDateFormat) & " : " & strInput
   End If

   intFileNumber = FreeFile
   Open g_strLogPath For Append As #intFileNumber
   Print #intFileNumber, strInput
   Close #intFileNumber

   LogMessage = True

   Exit Function

ErrorHandler:

   MsgBox _
      "Error: " & Err.Number & vbCrLf & _
      "Location: Module1.LogMessage" & vbCrLf & _
      "Line: " & Erl & vbCrLf & _
      Err.Description, vbExclamation + vbOKOnly

End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:56:44.117

尝试这个

```
Sub GetTmpPath()
    'This will give the Temp Path
    MsgBox IIf(Environ$("tmp") <> "", Environ$("tmp"), Environ$("temp"))
End Sub 
```

因此，您可以尝试将其用作

```
 Ret = IIf(Environ$("tmp") <> "", Environ$("tmp"), Environ$("temp"))

    g_strLogPath = Ret & "\Sample.Log"

    Open g_strLogPath For Append As #intFileNumber 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:42:20.107

尝试使用[GetTempPath](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364992%28v=vs.85%29.aspx)而不是`Environ$("TEMP")`获取临时文件夹。

如果当前用户在 TEMP 文件夹中没有写入权限，许多系统组件也会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T21:50:42.133

问题是日志级别检查。它实际上从未涉及到 open 或 print 语句。

我定义了三个日志级别 0 = 无日志 1 = 一切 2 = 仅错误

它被设置为 2 并且 LogError 调用了 LogMessage 来检查 loglevel <> 1 并且因此从未运行过。

# objective-c - 从核心数据中显示空的 UITableView 行

> ID：10438856
> 
> 赞同：1
> 
> 时间：2012-05-03T20:28:13.700
> 
> 标签：objective-c, uitableview, core-data, ios5, nsfetchedresultscontroller

我正在尝试模仿 iPhone 日历列表视图并在列表中显示我的约会。不管我是否有“今天”的约会，我都希望有一个包含今天日期的部分。使用下面的 fetchController 我将如何检查，然后如果今天没有约会，添加一个空白部分而不是弄乱排序？

```
- (NSFetchedResultsController *)fetchedResultsController {

//    if (fetchedResultsController != nil) {
//        return fetchedResultsController;
//    }

    /*
     Set up the fetched results controller.
     */
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Appointments" inManagedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext]];
    [fetchRequest setEntity:entity];
    //[fetchRequest setIncludesPendingChanges:YES];

    // Set the batch size to a suitable number.
    //[fetchRequest setFetchBatchSize:20];

    // Sort using the date / then time property.
    NSSortDescriptor *sortDescriptorDate = [[NSSortDescriptor alloc] initWithKey:@"date" ascending:YES];
    NSSortDescriptor *sortDescriptorTime = [[NSSortDescriptor alloc] initWithKey:@"start_time" ascending:YES selector:@selector(localizedStandardCompare:)];
    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptorDate, sortDescriptorTime, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Use the sectionIdentifier property to group into sections.
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext] sectionNameKeyPath:@"date" cacheName:nil];
    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;
    return fetchedResultsController;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T20:55:12.087

似乎这不能用 来完成`NSFetchedResultsController`，但是有一个 3rd 方类可以操作这些数据，因此您可以添加空行。

[https://github.com/timothyarmes/TAFetchedResultsController](https://github.com/timothyarmes/TAFetchedResultsController)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T01:24:46.987

`[context countForFetchRequest:request error:&error];`如果没有结果，您可以尝试这将返回 0。由于您使用的是 NSFetchedResultController，因此您必须在 tableView 方法中进行一些操作，以便显示结果控制器中没有的内容。所以你可以先做 e countForFetchRequest ，然后如果它是 0 继续在表格中显示你需要的东西。

# html - 锚标签页面跳转

> ID：10438859
> 
> 赞同：0
> 
> 时间：2012-05-03T20:28:36.263
> 
> 标签：html, anchor

这应该是一个简单的：我有一个带有一堆命名锚标记的页面。这些标签链接到网站上的各种其他页面。但是由于某种原因，当我链接到页面#anchor 时，它总是跳回顶部。例如：

[http://thedenvillehub.com/test-hs/services.asp#firesetter](http://thedenvillehub.com/test-hs/services.asp#firesetter)

它会进入正确的区域，但随后会跳到顶部。

如果您单击链接访问它，也会发生同样的事情：

[http://thedenvillehub.com/test-hs/trouled.asp](http://thedenvillehub.com/test-hs/troubled.asp)（点击“少年放火计划”）

有任何想法吗？它在 IE 中可以正常工作，但不能在 FF 或 Chrome 中正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:34:04.527

您有导致此问题的内联 JS：

```
<script type="text/javascript">
// When ready...
window.addEventListener("load",function() {
    // Set a timeout...
    setTimeout(function(){
        // Hide the address bar!
        window.scrollTo(0, 1);
    }, 0);
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:33:27.723

这是由以下 JavaScript 引起的：

```
// When ready...
window.addEventListener("load",function() {
    // Set a timeout...
    setTimeout(function(){
        // Hide the address bar!
        window.scrollTo(0, 1);
    }, 0);
}); 
```

删除此脚本应该可以解决您的问题。

# actionscript-3 - 如果其任何属性发生更改，Flash 会停止将关键帧信息应用于 MovieClip？

> ID：10438860
> 
> 赞同：0
> 
> 时间：2012-05-03T20:28:37.040
> 
> 标签：actionscript-3, flash, timeline, keyframe, avm2

假设我有一个带有盒子（实例名称“盒子”）的 3 帧影片剪辑。每一帧都对盒子应用不同的模糊，所以它在第 1 帧有点模糊，在第 2 帧有点模糊，在第 3 帧非常模糊。

我可以在三个帧中的任何一个上调用“gotoAndStop”，并且将应用正确的模糊，并且我可以根据需要多次执行此操作而不会出现问题。

但是，如果在任何时候我更改了框的宽度，例如“box.width = 100”，那么突然当我调用“gotoAndStop”时，不再应用关键帧信息并且框的模糊不会改变。如果我在第 2 帧上也添加位置更改，则会出现相同的行为......位置更改在 gotoAndStop 上起作用，直到我更改框的宽度，然后当我进出该帧时它不再移动。

为什么当我更改关键帧对象上的“宽度”等属性时，Flash 会停止应用这样的关键帧信息？

# c++ - 模板专业化别名

> ID：10438862
> 
> 赞同：6
> 
> 时间：2012-05-03T20:28:51.540
> 
> 标签：c++, templates, c++11, template-specialization

我最近遇到了一个问题。我实际上认为它无法像我希望的那样解决，但如果可以的话，它会非常方便。无论如何，这是问题所在：

我会给你一个我几天前在这个论坛上看到的例子，因为它会更容易解释。假设我正在尝试以这种方式创建张量结构：

```
template <int N>
struct Tensor
{
    Tensor<N - 1> x;
    Tensor<N - 1> y;
    Tensor<N - 1> z;
}; 
```

为了避免无限递归，我必须为 N = 1 编写模板特化。

```
template<>
struct Tensor<1>
{
    double x;
    double y;
    double z;
}; 
```

实际上，当 N = 1 时，这个 Tensor 实际上是一个 Vector（物理的）。假设我已经以这种方式定义了一个 Vector 结构：

```
struct Vector
{
    double x;
    double y;
    double z;
}; 
```

这个结构和 Tensor<1> 完全一样。由于 Vector 结构已经存在，假设我自己没有实现它，我希望能够使 Tensor<1> 结构成为 Vector 结构的别名。就像 typedef 一样。所以，我想这样做：

```
// C++03
typedef Vector Tensor<1>;

// or C++11
using Tensor<1> = Vector; 
```

这样一来，Tensor<1> 和 Vector 将是完全相同的结构，因此我可以在程序中任何我想要的地方使用一个而不是另一个，而我不必两次编写相同的结构。

但是，实际上不可能以这种方式定义模板特化。如果是这样，我就不会在那里问这个问题。

**注意：**我知道前面的例子不是一个好例子，因为我们仍然可以这样做：

```
using Vector = Tensor<1>; 
```

但是，如果我想用两个不同结构的特化来做这件事，那就很麻烦了。例如，在编写可以在 N 维空间中计算几何的几何库时：

```
using Circle<2> = Hypersphere<2>; 
```

所以，总结一下：有没有办法通过将模板特化定义为另一个模板的别名来创建它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T20:33:41.723

给定遗留类 Scalar、Vector 和 Matrix，您可以使用继承：

```
template<>
class Tensor<0>: public Scalar {};

template<>
class Tensor<1>: public Vector {};

template<>
class Tensor<2>: public Matrix {}; 
```

请注意，这不是滥用继承，因为您正在建模 is-a 关系。

# vb.net - 在 vb.net 类中使用表单句柄而不将其作为参数传递？

> ID：10438864
> 
> 赞同：0
> 
> 时间：2012-05-03T20:28:53.880
> 
> 标签：vb.net, winforms, class, handle

我正在编写一个需要表单句柄的类，但是有一种方法可以在不将其作为参数发送到类构造函数或属性中的情况下使用它？

我知道在表单完全加载之前不会设置处理程序，所以这也是另一个问题。

基本思想是捕获表单句柄而不将其作为参数传递并处理 wm 消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:57:41.557

目前尚不清楚“表单句柄”（表单对象本身还是 Form.Handle 属性？）是什么意思。

但是，您可以使用**My.Application.OpenForms**集合[（请参阅此处）](http://msdn.microsoft.com/en-us/library/eh13dca9.aspx)循环所有打开的表单并找到您需要知道其标题或名称的表单

```
Private Function GetFormByTitle(title as String) as Form
    Dim result As Form
    For Each f As Form In My.Application.OpenForms
        if f.Text = title then
            result = f
            Exit For
        End If
    Next
    Return result
End Function 
```

然后，您可以使用此方法的结果来获取已识别表单的“句柄”：

```
Dim h as IntPtr
Dim f as Form

f = GetFormByTitle("Caption_Of_Form")
if f IsNot Nothing then
    h = f.Handle
    ' .... do your work with handle here
End if 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T01:57:28.163

最后我找到了适合我需要的解决方案。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.nativewindow.createhandle.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.nativewindow.createhandle.aspx)

这允许我创建一个“幽灵窗口”并在运行时获取它的处理程序，而无需修改我的类或在构造函数或属性中传递处理程序。

需要的另一件事是处理 WM，这也解决了问题。

请注意，WM 和表单处理程序属于“幽灵窗口”，而不是承载界面的表单。

# javascript - 使用 tornado websockets 传递消息

> ID：10438866
> 
> 赞同：4
> 
> 时间：2012-05-03T20:28:59.890
> 
> 标签：javascript, python, websocket

我正在使用 tornado websockets 来更新页面上的一些信息。如果用户更改屏幕上的某些内容，我希望将这些更改显示给所有其他具有活动连接的用户。我可以让 javascript 将消息发送到服务器，但我不知道如何将该消息发送回客户端。这是javascript和python

```
$(document).ready(function () {
    var ws = new WebSocket("company website, I know this works");

    ws.onopen = function () {
        console.log("websocket engage");
    };

    ws.onmessage = $(".column li").on("mouseup", function (evt) {
        pid = $(this).attr("id");
        oldCid = $(this).parent().parent().attr("id");
        newCid = $(this).parent().attr("id");
        message = pid + " " + oldCid + " " + newCid;
        ws.send(message);
    });

    ws.onclose = function (evt) {
        console.log("connection closed");
    };

    ws.writemessage = function (evt) {
        alert(evt.data);
    };

}); 
```

这是python代码：

```
import tornado.httpserver
import tornado.websocket
import tornado.ioloop
import tornado.web

from tornado.options import define, options

define("port", default=8888, help="run on the given port", type=int)

change = "original"

listeners = []

class WSHandler(tornado.websocket.WebSocketHandler):
  def open(self):
    print "opened a new websocket"
    listeners.append(self)
    print listeners

  def on_message(self, message):
     #self.write_message(u"You Said: " + message)
     print ("in on_message " + message)
     change = message
     #self.write_message(message)

  def on_close(self):
    print 'connection closed'
    listeners.remove(self)

  def write_message(self, message):
    print ("in write message " + change)
    self.write_message(change)

def main():
    #tornado.options.parse_command_line()
    application = tornado.web.Application([
(r'/ws', WSHandler),
 ])
    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(8888)
    tornado.ioloop.IOLoop.instance().start()

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T22:29:10.933

在 python 代码中，您已映射`/ws`到`WSHandler`类，但是在创建 WebSocket 对象时，您需要在 javascript 代码中执行此操作：

1)

```
var ws=new WebSocket("ws://192.168.3.33:8888/ws"); 
/* 
  if 192.168.3.33 is the server IP and 8888 is the port, the server is serving on. 
  So object is mapped to r"/ws". so now the server can identify the request 
*/ 
```

代替 ：

```
var ws = new WebSocket("company website, I know this works"); 
```

2）`onmessage()`WebSocket的事件发生在服务器发回一些东西时。

所以 javascript 代码将如下所示：

```
$(document).ready(function () {
var ws=new WebSocket("ws://192.168.3.33:8888/ws");

ws.onopen = function () {
    console.log("websocket engage");
};

ws.onmessage = function(evt){
    //the received content is in evt.data, set it where you want
};

ws.onclose = function () {
    console.log("connection closed");
 };

$(".column li").on("mouseup")  //the function  that sends data
{
    pid = $(this).attr("id");
    oldCid = $(this).parent().parent().attr("id");
    newCid = $(this).parent().attr("id");
    message = pid + " " + oldCid + " " + newCid;
    ws.send(message);   
};
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-31T20:58:36.930

重新定义：

```
 def on_message(self, message):
     print ("in on_message " + message)
     for w in listeners:
        w.write_message(message) 
```

这将向所有连接的客户端发送“消息”。

另外，我建议摆脱您的 self.write_message 版本。

# javascript - 通过在锚标记上应用 onclick 来删除文本

> ID：10438868
> 
> 赞同：0
> 
> 时间：2012-05-03T20:29:01.860
> 
> 标签：javascript, html

```
<td><input type="button" value="remove" onClick="removeBox(this.parentNode.parentNode.rowIndex); "/></td>

function removeBox(i)
        {
            document.getElementById("firstTbl").deleteRow(i);

        } 
```

我的这段代码正在工作，我可以删除我的整个 tr，但是当我想要在我的链接中使用相同的功能而不是它不起作用时，让我解释一下，当我想要一个带有名称的链接时，当用户单击该下划线链接时，它会删除该文本我的意思是整个 tr 就像我以前的作品一样，唯一的区别在于我使用的是 onclick on button 现在它位于锚标签上

```
<td><a href="#" onclick="removeLink(this.parentNode.parentNode.rowIndex);">Remove</a></td>
function removeLink(i)
{
document.getElementByID('tab2').deleteRow(i);

} 
```

上面有我的代码与锚标记不同

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T13:19:17.390

你不应该使用内联事件。是老风格。

```
<a href="#" class="remove">Remove</a> 
```

并在 JS 中使用 jQuery；

```
$('.remove').on('click', function (e) {
    e.preventDefault();

    $(this).closest('tr').remove(); // will delete the upper tr.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:37:42.610

我强烈建议您在单击时返回 false 以阻止页面重新加载或部分卸载。

```
<td><a href="#" onclick="return removeLink(this.parentNode.parentNode.rowIndex);">Remove</a></td>
function removeLink(i) {
  document.getElementByID('tab2').deleteRow(i);
  return false
} 
```

# c - C语言中指针的难点

> ID：10438876
> 
> 赞同：-1
> 
> 时间：2012-05-03T20:29:42.230
> 
> 标签：c, function, pointers

```
double volume(double l,double w,double h);  
double area(double l,double w,double h);  

int main() {  
    double l,w,h,v,a`;  
    volume (3.0,1.5,2.0);  
    area(3.0,1.5,2.0);  
    printf("The Volume is %lf cubic meters and the area is %lf square meters.\n", v,a);  
    return 0;
}  

double volume(double l,double w,double h) {  
    double v;  
    v = l*w*h;  
    return v;
}  

double area(double l,double w,double h) {  
    double a;  
    a = (2*l*w) + (2*w*h) + (2*l*h);  
    return a;
} 
```

体积是`2091994552961492532068352.000000`立方米，面积是`637485042878638687518720.000000`平方米。

我目前正在获得上述输出（这显然是错误的，并且是垃圾值），我想知道我哪里出错了。我猜这是一个指针问题。如果您可以向我解释指针的基础知识，我将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:31:56.840

这根本与指针无关。您甚至没有在代码中使用任何指针。

您只是不分配返回值，因此打印未初始化变量的值。

这是固定代码：

```
int main() {  
    double v, a; 
    v = volume(3.0, 1.5, 2.0);  
    a = area(3.0, 1.5, 2.0);  
    printf("The Volume is %lf cubic meters and the area is %lf square meters.\n", v, a);  
    return 0;
} 
```

您也不需要其他两个函数中的变量 - 只需直接返回结果：

```
double volume(double l,double w,double h) {  
    return l*w*h;  
}  

double area(double l,double w,double h) {  
    return (2*l*w) + (2*w*h) + (2*l*h);  
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:31:47.873

`v`并且`a`是未初始化的变量，它们可以包含任何值。我想你的意思是：

```
v = volume (3.0,1.5,2.0);
a = area(3.0,1.5,2.0); 
```

它与指针无关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T20:32:02.697

您没有将返回值分配给局部变量。

```
v=volume (3.0,1.5,2.0);  
a=area(3.0,1.5,2.0); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:33:33.770

这就是为什么你应该初始化你声明的每个变量！

```
double volume(double l,double w,double h);  
    double area(double l,double w,double h);  

int main() {  
    double l,w,h,v,a`;  
    v = volume (3.0,1.5,2.0);  
    a = area(3.0,1.5,2.0);  
    printf("The Volume is %lf cubic meters and the area is %lf square meters.\n", v,a);  
    return 0;
}  

double volume(double l,double w,double h) {  
    double v;  
    v = l*w*h;  
    return v;
}  

double area(double l,double w,double h) {  
    double a;  
    a = (2*l*w) + (2*w*h) + (2*l*h);  
    return a;
} 
```

# ruby-on-rails - Mac Rails 安装 - 错误：安装 rails 时出错：/Users/..../cache/railties-3.2.3.gem 的 gem 格式无效

> ID：10438877
> 
> 赞同：2
> 
> 时间：2012-05-03T20:29:43.377
> 
> 标签：ruby-on-rails, macos, gem, installation

在此处使用适用于 OSX 的 Ruby on Rails 教程：[http ://ruby.railstutorial.org/book/ruby-on-rails-tutorial](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial)

它声明通过“$ gem install rails -v 3.2.3”安装导轨，当我这样做时，我得到了错误

> 安装 rails 时出错：/
> Users//.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/cache/railties-3.2.3.gem 的 gem 格式无效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T21:20:01.643

听起来您的 gem 依赖项搞砸了。使用以下命令重新安装所有 gem：

```
gem pristine --all --no-extensions 
```

# jsf-2 - 对 primefaces 中的选项卡的响应非常慢

> ID：10438878
> 
> 赞同：0
> 
> 时间：2012-05-03T20:29:44.077
> 
> 标签：jsf-2

我的 jsf 页面中有 4 个选项卡。但是，当我单击其中一个选项卡时，在该选项卡上获取实际页面的响应非常慢。对这部分有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-07T18:59:21.513

解决此问题的最佳方法是使用部分更新。部分更新的一种方法是使用 p:remoteCommand。这是一个帮助您前进的代码示例。

```
 <p:tabView widgetVar="tabPanel"
    dynamic="false" cache="true"
    actionListener="tabChange()">

    <p:remoteCommand  name="tabChange"
              process="@this"
              update="someOtherThingPerhaps"
              actionListener="#{tabBean.onTabChange}" />
  .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T11:04:22.103

也许您的选项卡定义示例会很有用，primefaces + 相关 jsf 库的版本，以我的经验，当用户单击选项卡时响应缓慢取决于每个选项卡中数据表的复杂性，当用户单击新选项卡时，请求被发送到您的支持 bean onTabChange（确保该侦听器中的代码不太昂贵），并且客户端计算机的重绘时间也会影响（如果您有一个包含 100 列的数据表，其中包含很多东西，例如工具提示，按钮，链接等，当客户端计算机绘制更改缓慢时会很明显）。

# collections - 骨干.js collection.get(id) 返回未定义

> ID：10438879
> 
> 赞同：1
> 
> 时间：2012-05-03T20:29:47.377
> 
> 标签：collections, view, backbone.js

当我想使用预先填充的 ID 向服务器添加新模型时，我遇到了 idAttribute 问题，导致 .save() 报告错误的 isNew() 值。这导致我将其关闭并设置 model.id手动。

这是我的观点：

```
 RecordListItemView = Backbone.View.extend({
        initialize:function () {
            var record = this.model.attributes;
            if (record.user_id) {
                this.model.id = parseInt( record.user_id );
                record.id = parseInt( record.user_id );
                    // Added this so ID would show up in model and .attributes
            }
            this.model.bind("change", this.render, this);
            this.model.bind("destroy", this.close, this);
        },

        render:function (eventName) {
            $(this.el).html(this.template(this.model));
            console.log(this);
            return this;
        }
    }); 
```

在这一点上，我无法使用 collection.get(id) 检索任何记录，尽管我可以通过 collection.getByCid(cid) 来做到这一点。

这是我的 console.log 输出：

```
 d
      $el: e.fn.e.init[1]
      cid: "view36"
      el: HTMLLIElement
      model: d
        _callbacks: Object
        _escapedAttributes: Object
        _pending: Object
        _previousAttributes: Object
        _silent: Object
        attributes: Object
        id: 15
        user_id: "15"
        user_name: "Test"
        __proto__: Object
      changed: Object
      cid: "c8"
      collection: d
      id: 15
      __proto__: x
    options: Object
    __proto__: x 
```

有没有办法修复 collection.get(id) 而无需更改我的数据库以包含 id 字段？（目前使用user_id作为pk）

**正如本杰明·考克斯 (Benjamin Cox) 在下面发布的那样：（**将 parseInt() 删除为不必要的）

代替

```
 this.model.id = record.user_id; 
```

和

```
 this.model.set({ id: record.user_id }); 
```

.. 避免绕过模型的更改事件，从而更新集合的 internal_byId[] 数组。

**在测试了两者之后，我最终使用了 mu is too short 的`parse`建议..**

```
 parse: function(response) {
        return {
            id: response.user_id,
            user_id: response.user_id,
            user_name: response.user_name
        };
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:41:49.430

调用 collection.get(id) 找不到您的模型的原因是您在这样做时绕过了 Backbone 的事件机制：

```
this.model.id = parseInt( record.user_id ); 
```

如果您改为这样做：

```
this.model.set({ id: parseInt(record.user_id)}); 
```

那么模型的 set() 方法中的 Backbone 事件代码将触发“change:id”事件。反过来，该集合侦听此事件并更新它的内部 _byId[] 数组变量。稍后，当您调用 collection.get(id) 时，此数组用于搜索匹配模型。

# ruby-on-rails - MongoMapper：基于键作为数组维护关联的排序顺序

> ID：10438881
> 
> 赞同：3
> 
> 时间：2012-05-03T20:30:09.303
> 
> 标签：ruby-on-rails, mongodb, mongomapper

所以我创建了这样的关系：

```
Class Business
    include MongoMapper::Document

    key  :published_review_ids , Array         , typecast: 'BSON::ObjectId'
    many :published_reviews    , class: Review , in: :published_review_ids
end 
```

我使用 published_review_ids 来维护我的评论的排序顺序，这会在数组中上下移动它们。

因此，访问 Business.first.published_review_ids 会以正确的顺序为我提供所有 ID。访问 Business.first.published_reviews 将返回一系列评论，但按默认顺序（生成时间）排序。

有没有办法让我告诉这个关联总是根据它所基于的数组的顺序进行排序？

附带说明一下，array.first 和 array.last 在返回的 Business.first.published_reviews 数组上似乎无法正常运行。这是一个要点，显示了一些行为示例：[https ://gist.github.com/09c9a0a23dc67f30a76d](https://gist.github.com/09c9a0a23dc67f30a76d)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T22:12:05.297

不，由于 MongoDB 的工作方式，该列表未排序。命中 Mongo 的查询看起来像......

```
{
  "_id": { "$in" => [ObjectId('...'), ObjectId('...'), ObjectId('...')] }
} 
```

...Mongo 的*唯一*保证是它将返回与查询匹配的所有文档。

如果您想为您的关联设置默认顺序，您应该能够将其添加到声明中。

```
many :published_reviews, class: Review , in: :published_review_ids, order: :published_at.desc 
```

您也可以这样做来更准确地解决您的问题：

```
def sorted_published_reviews
  published_review_ids.map do |id|
    # to_a will only fire a Mongo query the first time through this loop
    published_reviews.to_a.find { |review| review.id == id }
  end
end 
```

在你身边：

调用`first`和`last`直接在关联上触发查询。如果没有排序顺序，您将不会得到任何不同的东西。（[见勇敢的来源](https://github.com/jnunemaker/plucky/blob/master/lib/plucky/query.rb#L85-91)）

以下将加载整个关联并将第一个/最后一个拉出内部 Ruby 数组：

```
my_business.published_reviews[0]
my_business.published_reviews[-1]
my_business.published_reviews.to_a.first
my_business.published_reviews.to_a.last 
```

# ruby - 将相同的方法添加到多个类

> ID：10438888
> 
> 赞同：7
> 
> 时间：2012-05-03T20:30:26.793
> 
> 标签：ruby

我有一些代码可以计算数字的第 n 个根。目前，该方法仅适用于 Fixnum，因为我在 Fixnum 类中定义了它。这样做很容易

```
class Float
    #same code as was in Fixnum
end 
```

但这似乎没有必要。我不知道如何动态调用类。我试过了：

```
classes = [Fixnum, Float]
classes.each do |x|
    x.instance_eval do
        def root(pow)
            return self ** (1/pow.to_f)
        end
    end
end 
```

但这没有用。我该怎么做呢？ **注意**：发布后，我意识到这可能更适合 Programmers.SE，因为它是理论上的，也是基于单个问题的。随意迁移...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-03T21:06:35.150

类层次结构的相关部分如下所示：

*   [`Numeric`](https://ruby-doc.org/core/Numeric.html)
    *   [`Integer`](https://ruby-doc.org/core/Integer.html)
        *   旧版本有`Fixnum`和`Bignum`作为 的子类`Integer`。
    *   [`Float`](https://ruby-doc.org/core/Float.html)
    *   [`Rational`](https://ruby-doc.org/core/Rational.html)

因此，将您的更改修补为 Numeric 以一次性覆盖它们：

```
class Numeric
  def root(pow)
    return self ** (1/pow.to_f)
  end
end 
```

然后你可以做这些事情：

```
>> 11.root(2) # Integer
=> 3.3166247903554
>> 2.18.root(3) # Float
=> 1.296638256974172
>> Rational(23, 42).root(6) # Rational
=> 0.9045094132598528
>> 2**1000.root(42) # Integer
=> 2.2638347236157763 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-03T20:52:02.570

你会想要使用#class_eval：

```
classes = [Fixnum, Float]
classes.each do |x|
    x.class_eval do
        def root(pow)
            return self ** (1/pow.to_f)
        end
    end
end 
```

请参阅[此博客文章](http://ilikestuffblog.com/2009/01/09/fun-with-rubys-instance_eval-and-class_eval/)作为参考。

或者，您可以创建一个模块并将其包含到每个类中：

```
module MyRoot
  def root(pow)
    return self ** (1/pow.to_f)
  end
end

class Fixnum
  include MyRoot
end

class Float
  include MyRoot
end 
```

我倾向于后者。它更清楚你在做什么，也允许一次性添加。

# ios - 使用按钮调用另一个类iOS中的方法

> ID：10438889
> 
> 赞同：1
> 
> 时间：2012-05-03T20:30:47.680
> 
> 标签：ios, xcode4, uibutton, core-location

我几乎看过所有其他关于此的帖子，但我似乎无法理解。我是 iOS 和 Objective-C 的新手，我正在关注 Objective-C 和 iOS 的 Big Nerd Ranch 指南。我在他们的网站上发现的挑战之一是制作一个简单的 CoreLocation 应用程序，我正在尝试将代码分离到类中，以便以后可以根据需要重用它。

我想在我的 ViewController.m 文件中获取按钮来调用 MyLocation.m 文件中的 locationManager，这是 MyLocation 类。我已经研究过 NSNotificaiton，但我也无法让它正常工作。

我一生都无法弄清楚我错过了什么或做错了什么。对于这个问题的简单性，我深表歉意，我正在努力学习尽可能多的基础知识。

以下是我的文件：

视图控制器.h：

```
#import <UIKit/UIKit.h>
#import "MyLocation.h"

@interface ViewController : UIViewController
- (IBAction)GetLocation:(id)sender;
@property (weak, nonatomic) IBOutlet UILabel *LocationOutput;

@end 
```

视图控制器.m：

```
#import "ViewController.h"
#import "MyLocation.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize LocationOutput;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setLocationOutput:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (IBAction)GetLocation:(id)sender {

    //WHAT GOES HERE?
}
@end 
```

我的位置.h：

```
#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>

@class MyLocation;

@protocol MyLocationDelegate <NSObject>;

@end

@interface MyLocation : NSObject <CLLocationManagerDelegate>
@property (nonatomic, strong) CLLocationManager *locationManager;

@end 
```

我的位置.m：

```
#import "MyLocation.h"

@implementation MyLocation
@synthesize locationManager = _locationManager;

-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    NSLog(@"Latitude is: %f", newLocation.coordinate.latitude);
}

@end 
```

我知道我还没有向标签输出任何东西，但我正在做一个 NSLog。

感谢您的任何帮助。对此，我真的非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:48:39.580

为了向对象发送消息，您需要对其进行引用。在您发布的两个类中，您有同样的问题：您没有对它们的引用，因此您将无法向它们发送消息。

在`ViewController`中，您需要以某种方式获取对`MyLocation`对象的引用。例如，如果您将代码更改为：

```
- (IBAction)GetLocation:(id)sender {
    MyLocation *myLocation = [[[MyLocation alloc] init] autorelease];
    [myLocation someMethod];
} 
```

这将在每次调用操作时实例化一个新`MyLocation`对象，并将`someMethod`消息发送给它。在您的情况下，这有点复杂。你的`MyLocation`类需要有一个实例化的`CLLocationManager`实例。可能，您需要一个实例变量并执行以下操作：

```
@interface MyLocation {
    CLLocationManager *_locationMananger;
}
@end

@implementation MyLocation

- (id)init {
   self = [super init];
   if (self) {
       _locationManager = [[CLLocationManager alloc] init];
       _locationManager.delegate = self;
   }
   return self;
}

- (void)dealloc {
   [_locationManager release];

   [super dealloc];
}

@end 
```

然后，`CLLocationManager`您创建的实例`MyLocation`将在位置更改时调用其委托方法。您应该在该方法中执行的操作是将该位置存储在 的某个实例变量中`MyLocation`，以便您以后可以访问它。

最后，我将更改为仅在初始化或视图加载时`ViewController`创建一次实例：`MyLocation`

```
@interface ViewController {
    MyLocation *_myLocation;
}
@end

@implementation ViewController

- (id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)bundle {
    self = [super initWithNibName:nibName bundle:bundle];
    if (self) {
        _myLocation = [[MyLocation alloc] init];
    }
    return self;
}

- (void)dealloc {
   [_myLocation release];
   [super dealloc];
}

- (IBAction)GetLocation:(id)sender {
   // Grab the location from _myLocation using a property or method defined
}

@end 
```

希望你明白这个想法，这可以让你开始。

# python - Python：下标一个模块

> ID：10438894
> 
> 赞同：2
> 
> 时间：2012-05-03T20:31:22.040
> 
> 标签：python, module, subscript

我试图做这样的事情：

**模块.py**

```
def __getitem__(item):
    return str(item) + 'Python' 
```

**测试.py**

```
import module
print module['Monty'] 
```

我希望打印“MontyPython”。但是，这不起作用：

```
TypeError: 'module' object is not subscriptable 
```

是否可以在纯 Python 中创建一个可下标的模块（即不修改其源代码、猴子补丁等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:40:32.273

```
>>> class ModModule(object):
    def __init__(self, globals):
        self.__dict__ = globals
        import sys
        sys.modules[self.__name__] = self
    def __getitem__(self, name):
        return self.__dict__[name]

>>> m = ModModule({'__name__':'Mod', 'a':3})
>>> import Mod
>>> Mod['a']
3

# subclassing the actual type won't work
>>> class ModModule(types.ModuleType):
    def __init__(self, globals):
        self.__dict__ = globals
        import sys
        sys.modules[self.__name__] = self
    def __getitem__(self, name):
        return self.__dict__[name]

>>> m = ModModule({'__name__':'Mod', 'a':3})

Traceback (most recent call last):
  File "<pyshell#114>", line 1, in <module>
    m = ModModule({'__name__':'Mod', 'a':3})
  File "<pyshell#113>", line 3, in __init__
    self.__dict__ = globals
TypeError: readonly attribute 
```

您可以使用 ModModule(globals()) 替换 sys.modules 中的当前模块。

# graphviz - Graphviz 输出一团糟

> ID：10438895
> 
> 赞同：35
> 
> 时间：2012-05-03T20:31:25.350
> 
> 标签：graphviz

我正在尝试使用 GraphViz 以点格式可视化以下数据：

```
digraph n {
  node [nodesep=2.0, fontsize=11];
  graph [ overlap=false];
  edge[weight=0.2];
  A -> B [label="I/5"]
  A -> A [label="*/0"]
  A -> C [label="ii/2"]
  A -> H [label="vii/1"]
  B -> D [label="iii/1"]
  B -> E [label="IV/2"]
  B -> F [label="V/2"]
  B -> B [label="vi/2"]
  C -> F [label="V/2"]
  C -> H [label="vii/1"]
  D -> E [label="IV/2"]
  E -> D [label="iii/2"]
  E -> G [label="iv/1"]
  E -> F [label="V/3"]
  F -> B [label="I/4"]
  F -> B [label="vi/1"]
  F -> B [label="*/0"]
  G -> B [label="I/5"]
  H -> B [label="vi/1"]
} 
```

运行以下命令： `neato -Tpng Chord_NFA.dot > Chord_NFA.png`

给我这个输出：

![](../Images/256b8727368fb7bba264759cddfddccf.png)

我希望它适合 A4 并且没有任何边缘重叠或跨越节点。这是可能的（数学上），因为我自己用圆珠笔做的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-03T21:58:31.403

这是朝着更好方向迈出的一些步骤：

*   [**`nodesep`**](http://www.graphviz.org/content/attrs#dnodesep)不是节点属性 - 它可能没有达到您的预期。但它在你的情况下仍然有用：

    > ...这会影响单个节点上循环之间的间距，或一对节点之间的多重边。

*   如果您为*所有*边缘更改边缘重量，我认为边缘**重量**不会改变。
**   启用[**样条曲线**](http://www.graphviz.org/content/attrs#dsplines)通常是个好主意。*   在节点周围添加额外的空间可以通过[**`sep`**](http://www.graphviz.org/content/attrs#dsep)*   [**`overlap`**](http://www.graphviz.org/content/attrs#doverlap)比真/假有更多的价值——我经常觉得`scalexy`有用。*   一旦节点分布正常，您可以使用/和的组合**微调标签位置**（下例中的红色以使其突出）。`headlabel``taillabel``labeldistance``labelangle`*

 *这是修改后的示例：

```
digraph n {
splines=true;
sep="+25,25";
overlap=scalexy;
nodesep=0.6;
node [fontsize=11];
//edge[weight=0.2];

A -> B [label="I/5"]
A -> A [label="*/0"]
A -> C [label="ii/2"]
A -> H [label="vii/1"]
B -> D [label="iii/1"]
B -> E [label="IV/2"]
B -> F [headlabel="V/2", labeldistance=4, labelangle=-10, labelfontcolor=red]
B -> B [label="vi/2"]
C -> F [label="V/2"]
C -> H [label="vii/1"]
D -> E [label="IV/2"]
E -> D [label="iii/2"]
E -> G [label="iv/1"]
E -> F [headlabel="V/3", labeldistance=8, labelangle=-7, labelfontcolor=red]
F -> B [label="I/4"]
F -> B [label="vi/1"]
F -> B [label="*/0"]
G -> B [taillabel="I/5", labeldistance=4, labelangle=15, labelfontcolor=red]
H -> B [label="vi/1"]
} 
```

![图形输出](../Images/4370d8d2940402050f9e6a804044e942.png)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-13T18:54:52.147

我玩了几下，得到了这个：

```
digraph n {
  node [nodesep=2.0, fontsize=11];
  graph [overlap = false];
  subgraph cluster_a {
    style=invisible;
    A; B; H;
  }
  subgraph cluster_b {
    style=invisible;
    D; E; G;
  }
  subgraph cluster_c {
    style=invisible;
    C; F;
  }
  A -> B [label="I/5"];
  A -> A [label="*/0"];
  A -> C [label="ii/2"];
  A -> H [label="vii/1"];
  B:w -> D [label="iii/1"];
  B:nw -> E [minlen=3 label="IV/2"];
  B -> F [minlen=2 label="V/2"];
  B -> B [label="vi/2"];
  C -> F [minlen=2 label="V/2"];
  C -> H [label="vii/1"];
  D -> E [label="IV/2"];
  D -> E [minlen=2 dir=back label="iii/2"];
  G -> E [minlen=2 dir=back label="iv/1"];
  F -> E [dir=back label="V/3"];
  B -> F [minlen=2 dir=back label="I/4"];
  B -> F [minlen=2 dir=back label="vi/1"];
  B -> F [minlen=2 dir=back label="*/0"];
  B -> G [dir=back label="I/5"];
  H -> B [label="vi/1"];
} 
```

编译：

```
dot -Tpng -o Chord_NFA.png Chord_NFA.gv 
```

输出是这样的，没有任何线交叉：

![图形](../Images/fbfc5d270e5134664a006ed0489e15f7.png)

诀窍是：

1.  添加 minlen 属性以强制进行一些分离，为渲染提供更多间距，而不会出现重叠和交叉。

2.  反转某些边缘的逻辑（使用 dir=back 使它们不反转）。这样，dot 总是看到一个无环图，并且可以对边进行排序而不会混淆。

3.  首先关注一些子图并将它们的节点分组到集群中，以便在渲染图的其余部分时为它们提供一些“保护”免受干扰。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-23T02:21:12.973

使用点引擎我得到了以下输出，而没有更改应该适合 A4 的点文件。Marapet 的演绎确实更好地利用了空间。

![点引擎输出](../Images/ee9ce719d737312868b488d706a99818.png)*

# multithreading - 在 Perl 中，如何使用多个线程来处理大型数组的一部分？

> ID：10438896
> 
> 赞同：3
> 
> 时间：2012-05-03T20:31:29.740
> 
> 标签：multithreading, perl

我需要 Perl 中的多线程方面的帮助。

基本逻辑是启动20个线程。我有一个数组`@dataarray`，我希望将 20 块数据传递给每个线程。比如说，`@dataarray`里面有 200 行数据，所以前 10 行将被发送到线程 1，接下来的 10 行应该被发送到线程 2，所以它们不会覆盖彼此的数据，最终在处理线程后应该更新返回结果到`@outputarray`at与 source 相同的索引位置`@datarray`。

例如：第 19 行（索引位置 18）从`@dataarray`被发送到线程 2，所以在处理它之后线程 2 应该更新`$outputarray[18] = $processed_string`。

只需要弄清楚如何从数组的位置发送到特定线程即可。

```
#!/usr/bin/perl

use strict;
use threads;
my $num_of_threads = 20;
my @threads = initThreads();
my @dataarray;

foreach(@threads)
    {
    $_ = threads->create(\&doOperation);
    }

foreach(@threads)
     {
     $_->join();
     }

sub initThreads
     {
       my @initThreads;
         for(my $i = 1;$i<=$num_of_threads;$i++)
         {
         push(@initThreads,$i);
     }
     return @initThreads;
     }

sub doOperation
    {
    # Get the thread id. Allows each thread to be identified.
    my $id = threads->tid();
    # Process something--- on array chunk
    print "Thread $id done!\n";
    # Exit the thread
    threads->exit();
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T21:10:10.713

我不认为我之前所说的必须使用[threads::shared](http://perldoc.perl.org/threads/shared.html)是正确的。我不得不去检查文档，我不确定。我永远不确定 Perl 的线程。

**更新：**事实证明，我的不完全理解再次暴露出来。至少，您需要`threads::shared`能够`@output`从每个线程中放入结果。

```
#!/usr/bin/env perl

use strict; use warnings;
use threads;
use threads::shared;

use List::Util qw( sum );
use YAML;

use constant NUM_THREADS => 20;

my @output :shared;
my @data = ( ([1 .. 10]) x 200);

# note that you'll need different logic to handle left over
# chunks if @data is not evenly divisible by NUM_THREADS
my $chunk_size = @data / NUM_THREADS;

my @threads;

for my $chunk ( 1 .. NUM_THREADS ) {
    my $start = ($chunk - 1) * $chunk_size;
    push @threads, threads->create(
        \&doOperation,
        \@data,
        $start,
        ($start + $chunk_size - 1),
        \@output,
    );
}

$_->join for @threads;

print Dump \@output;

sub doOperation{
    my ($data, $start, $end, $output) = @_;

    my $id = threads->tid;

    print "Thread [$id] starting\n";

    for my $i ($start .. $end) {
        print "Thread [$id] processing row $i\n";
        $output->[$i] = sum @{ $data->[$i] };
        sleep 1 if 0.2 > rand;
    }

    print "Thread $id done!\n";

    return;
} 
```

输出：

```
- 55
- 55
- 55
…
- 55
- 55
- 55
- 55
```

# android - 如何在 onListItemClick 之后更新自定义 baseadapter？

> ID：10438898
> 
> 赞同：0
> 
> 时间：2012-05-03T20:31:40.123
> 
> 标签：android

当用户单击列表时，我需要一种更新 MyCustomAdapter 的方法，以便删除哈希键、值对并更新列表。

我真的卡在 onListItemClick 你能帮忙吗

谢谢格雷厄姆

```
protected void onListItemClick(ListView l, View v, int position, long id) { 
    //TODO Auto-generated method stub 

    Toast.makeText(getApplicationContext(),"SHORT click"  , Toast.LENGTH_LONG).show();
    Toast.makeText(getApplicationContext(),"DATA is" + map.entrySet() , Toast.LENGTH_LONG).show();  //NAME,VALUE
    //remove the key,value pair and update CustomAdapter 

    ????? 
    //end of remove entries from hashmap map   

} 

package telephone.org;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import java.util.Map.Entry;

import telephone.org.MyService.LocalBinder;
import android.app.ActivityManager;
import android.app.ListActivity;
import android.app.ActivityManager.RunningServiceInfo;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.os.IBinder;
import android.provider.ContactsContract;
import android.provider.ContactsContract.PhoneLookup;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.AdapterView.OnItemLongClickListener;

//class 1 
public class DynamicLists extends ListActivity { 

    MyService mService;
    boolean mBound = false;

//class 2 ///////////////////////////////////
public class MyCustomAdapter extends BaseAdapter { 

    public HashMap<String, Integer> mData = new HashMap<String,Integer>();
    private String[] mKeys;
    //constructor    
    public MyCustomAdapter(DynamicLists dynamicLists, int row, HashMap<String, Integer> map){ 
    mData = map;
    mKeys = mData.keySet().toArray(new String[map.size()]);
    Log.d(TAG, "INSIDE ADAPTER constructor HELLO WORLD " + map.entrySet()); 

}

public MyCustomAdapter(MyService mService, int row, Object map) {
        // TODO Auto-generated constructor stub
    }

@Override
public View getView(int position, View convertView, ViewGroup parent) {
//TODO Auto-generated method stub

    Log.d(TAG, "inside getview  ");
    View row=convertView;

if (row==null){
    LayoutInflater inflater=getLayoutInflater();
    row=inflater.inflate(R.layout.row, null);
}

TextView label =(TextView)row.findViewById(R.id.blocked);
label.setText(mKeys[position] +  "   " + getItem(position).toString()); //key + value 
return row;   

}

@Override
public int getCount() 
{
    // TODO Auto-generated method stub
    return mData.size();
}
@Override
public Object getItem(int position) 
{
    // TODO Auto-generated method stub
    Log.d(TAG, "inside getitem " + mData.get(mKeys[position])); 
    return mData.get(mKeys[position]);
}
@Override
public long getItemId(int position) 
{
    // TODO Auto-generated method stub
    return position;
}

}  //end of class 2 ////////////////////////

private static final String TAG = "DynamicList";

//class 1 

public static  HashMap<String, Integer> map = new HashMap<String, Integer>(); 

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
 super.onCreate(savedInstanceState);

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) { 
    //TODO Auto-generated method stub 

    Toast.makeText(getApplicationContext(),"SHORT click"  , Toast.LENGTH_LONG).show();
    Toast.makeText(getApplicationContext(),"DATA is" + map.entrySet() , Toast.LENGTH_LONG).show();  //NAME,VALUE
    //remove the name,value pair 

    //end of remove entries from hashmap map   

    } 

@Override
public void onStart() {
    super.onStart();
     isMyServiceRunning();

}

public void onStop() {
    super.onStop();
    // Unbind from the service
    if (mBound) {
    unbindService(mConnection);
    mBound = false;
    }
}

private boolean isMyServiceRunning() { 
    ActivityManager manager = (ActivityManager) getSystemService(ACTIVITY_SERVICE); 
    for (RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) { 
        if ("telephone.org.MyService".equals(service.service.getClassName())) 
        { 
            //Toast.makeText(getApplicationContext(),"SERVICE IS RUNNING", Toast.LENGTH_LONG).show();
            Intent intent = new Intent(this, MyService.class);
            bindService(intent, mConnection, Context.BIND_AUTO_CREATE);  //SEE INTERACT WITH SERVICE BELOW

            return true; 
        } 
    } 
           Toast.makeText(getApplicationContext(),"SERVICE IS STOPPED AND IS NOT RUNNING", Toast.LENGTH_LONG).show();
    return false; 
} 

//INTERACT WITH SERVICE
/** Defines callbacks for service binding, passed to bindService() */
private ServiceConnection mConnection = new ServiceConnection() {
@Override
public void onServiceConnected(ComponentName className, IBinder service) {
// We've bound to LocalService, cast the IBinder and get LocalService instance
LocalBinder binder = (LocalBinder) service;
mService = binder.getService();
mBound = true;
Set<Entry<String, Integer>> whatsup = mService.getNumbers();
//Toast.makeText(getApplicationContext(),"NUMBER INTERACTION IS" + whatsup, Toast.LENGTH_LONG).show();
Log.d(TAG, "ELEMENTS from service are:" + whatsup);
//Toast.makeText(getApplicationContext(),"NUMBER OF ENTRIES IS" + whatsup.size(), Toast.LENGTH_LONG).show();

//convert SET BACK TO HASHMAP 
for (Entry<String,Integer> entry : whatsup) { 

    String name = null; 
    String[] projection = new String[] { 
            ContactsContract.PhoneLookup.DISPLAY_NAME};
    Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(entry.getKey())); 
    Cursor cursor = getContentResolver().query(uri, projection, null, null, null);

    if (cursor.moveToFirst()) { 
        name = cursor.getString(cursor.getColumnIndex(ContactsContract.PhoneLookup.DISPLAY_NAME));
    }
    //Toast.makeText(getApplicationContext(),"RESOLVED NAME IS " + name, Toast.LENGTH_LONG).show();
    projection = null;
    map.put(name,entry.getValue()); 
    }

//NEW CODE 
MyCustomAdapter custom = (new MyCustomAdapter(DynamicLists.this, R.layout.row, map));
setListAdapter(custom);
custom.notifyDataSetChanged();
//END NEW CODE 
}

//end CONVERT SET BACK TO HASHMAP

@Override
public void onServiceDisconnected(ComponentName arg0) {
mBound = false;
}
};
//END INTERACTION WITH SERVICE 

} //end of class 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:51:48.970

您必须修改适配器的数据集（显然是您的 mData）并调用`notifyDataSetChanged`适配器的方法。

# c++ - SNMP AgentX：如何注册 OID？

> ID：10438899
> 
> 赞同：1
> 
> 时间：2012-05-03T20:31:43.117
> 
> 标签：c++, snmp, net-snmp, oid, mib

我正在用 C++ 为 Net-SNMP 编写 AgentX 子代理。

我尝试像这样注册 OID 1.3.6.1.4.1.4711.1.1

```
oid myOID[] = { 1, 3, 6, 1, 4, 1, 4711, 1, 1 };
handler = netsnmp_create_handler_registration("foo", handler, myOID, OID_LENGTH(myOID), HANDLER_CAN_RONLY);
if (handler)
    netsnmp_register_scalar(handler); 
```

奇怪的是 1.3.6.1.4.1.4711.1.1 的 snmpget 失败，并且我的处理程序仅在我为 1.3.6.1.4.1.4711.1.1.0 执行 snmpget 时才被调用（添加零）。

如何注册 1.3.6.1.4.1.4711.1.1 ？

net-snmp.org 上的示例都注册了一个实例变量，但我必须运行一些代码来收集该值。

我是否必须将我的回调声明为来自 C++ 应用程序的外部“C”？

是否有人有一个示例如何注册 1.3.6.1.4.1.4711.1 以下的所有 OID，所以我不必定义这么多处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:34:39.567

您正在尝试做的是不受支持的 SNMP 用例，并且可能无法使用 Net-SNMP 库（尽管我不确定您是否无法破解自己的荣耀并使其工作）。

它不受支持的原因是标量（或者，换句话说，不是表）根据定义应该以`base_oid.0`. 另一方面，表格以表格条目的索引结束：`base_oid.1`表示您正在查看表格中索引为`1`.

如果您仍然需要以 OID 结尾`.1`而不是`.0`，则支持的选项是注册一个表处理程序。

# facebook-graph-api - 代表应用发布到用户的个人资料

> ID：10438907
> 
> 赞同：0
> 
> 时间：2012-05-03T20:32:05.100
> 
> 标签：facebook-graph-api, notifications, facebook-wall

有没有办法让应用程序 (xyz) 在特定成员的 FB 墙上发布，而**不是在应用程序的所有**成员上发布？应用 xyz 想在亚当斯密的 FB 墙上发帖，“亚当斯密，你的分数被打了。” 我的理解是只有会员可以在自己的墙上而不是应用程序上自我发布。目的是**尝试**在我们的通知通过时，在 fb 页面左上角的通知框中获取通知标志。通过让成员自我发布，旗帜将不会出现。那么，一个应用 xyz 可以在不将帖子发送给所有成员的情况下在特定成员的墙上发帖吗？如果没有，是否有办法在该成员墙上发布帖子时“提高”通知标志？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:55:21.323

这是不可能通过帖子实现的，但 Requests API 允许这样做；请参阅[https://developers.facebook.com/docs/requests/上的应用程序到用户请求](https://developers.facebook.com/docs/requests/)

# linux - 在 XDEBUG 中出现错误

> ID：10438910
> 
> 赞同：2
> 
> 时间：2012-05-03T20:32:23.487
> 
> 标签：linux, debian, xdebug, eclipse-pdt

我刚刚在我的 Eclipse PDT 安装上安装了 xdebug，现在在我的本地 debian 机器上尝试使用 XDEBUG 调试我的 PHP 代码时出现以下错误：

网络启动已经运行

2个问题：

1.  我怎样才能在 Eclipse 中杀死它而不一起离开 Eclipse？
2.  是否需要设置我的说明中没有的其他配置设置？

任何帮助/指导将不胜感激，因为我正处于开始拔头发的地步。谢谢！

这是我按照说明在动态扩展部分中添加到我的 php.ini 文件中的内容：

```
;load module
zend_extension="/usr/lib/php5/20090626+lfs/xdebug.so"

;some options
xdebug.remote_enable=1
xdebug.remote_handler=dbgp
xdebug.remote_mode=req

;The following IP should be of the host running Eclipse!
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.idekey=

;Only enable the following if you want profiler output (lots of data!)
;xdebug.profiler_enable=1
;xdebug.profiler_output_dir=/var/log/XDebug/
;xdebug.profiler_enable_trigger=1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T03:36:19.413

“Web Launch Already Running”
这意味着您已经开始调试会话并且它还没有被终止。
打开“调试”透视图并查看“调试”选项卡，选择“PHP Web 应用程序”并单击“终止”（红色方块）按钮。

# c - 如何手动有效地计算C中的模数？

> ID：10438912
> 
> 赞同：4
> 
> 时间：2012-05-03T20:32:31.380
> 
> 标签：c, trigonometry, modulus, avr-gcc

我编写了一个使用查找表的正弦函数的基本定点变体（针对不带 FPU 的 AVR 微控制器）。我的实现也接受负值和超过 2π 的值，就像它在*math.h*中的浮点挂件一样。

所以我需要将给定值映射到 0 到 2π 之间的范围（即它们的固定点对应物）。对于积极的论点，很容易用 C 的内置余数运算符*%*来修剪它们。由于这不是负值的选项，因此我使用以下（明显）方法：

```
 unsigned int modulus = (a - (INT_FLOOR(a / b) * b) + b) % b; 
```

*a*和*b*是整数类型的值，而 INT_FLOOR() 只是暗示 (a/b) 的小数部分被截断。该公式确保计算出的模数（用作表格数组的索引）始终为正，并且负参数也映射到它们的正对应物（保持两个方向的相移）。

我对这种方法的问题是它似乎过于复杂，因为它涉及不少于五个算术运算。我缺少更有效的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T23:32:02.777

除非你的整数参数已经被缩放，使得它们是 π 的倍数（例如 65536 表示 2π），否则尝试进行参数缩减可能是错误的，因为 2π 是不合理的，并且任何缩减 mod 2π 都会引入按比例放大的错误*整个*归约结果变为错误之前的周期数。这实际上是许多浮点三角实现中的一个严重问题。

我建议要么根本不减少参数，要么使用基于 2 的幂而不是弧度的角度比例（例如，0x10000 或 0x1000000 对应于 2π 或 360 度）。然后参数归约变为单个按位与运算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T22:45:15.013

我看到你的公式是正确的，虽然不是那么漂亮。

如果你`b`是 2 的幂，那么一些操作可以用位掩码来完成。类似于以下内容：

```
unsigned int modulus = (a - (a & ~(b-1)) + b) & (b-1); 
```

如果`b`是常量或宏，它应该会优化很多。

# distributed-computing - 分布式多播中的“接收”和“交付”有什么区别？

> ID：10438914
> 
> 赞同：6
> 
> 时间：2012-05-03T20:32:44.503
> 
> 标签：distributed-computing, multicast, definition, difference

在多播的上下文中，接收消息的进程和传递消息的进程有什么区别？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-17T20:37:19.530

分布式计算中的组播通常假设某些保证，例如因果顺序，是由网络和应用程序之间的协议层提供的。这个协议层可能会延迟从网络到达的消息，忽略消息，使用额外的控制消息，......通常，这是最重要的层，需要有趣的算法。

In this context, when describing such algorithms, *receive* (and send) is the interface between the protocol layer and the underlying network channels. *Deliver* (and multicast) is the interface between the protocol layer and the application. It is thus a naming convention to make it easy do distinguish message arrival at different layers, instead of having to say "received at the protocol" (aka *received*) and "received at the application" (aka *delivered*).

一个例子：假设你正在执行因果关系并且有`m1->m2`. 现在假设在之前`m2`到达（即被*接收*到）进程 p `m1`。`m2`不能立即显示给应用程序（即*交付*）给应用程序。它只能在*收到*后*交付*，然后先*交付*。`m1`

# php - 使用 PHP 处理 SQL JOIN 结果

> ID：10438916
> 
> 赞同：1
> 
> 时间：2012-05-03T20:33:03.110
> 
> 标签：php, mysql, join

我在使用从 MySQL 检索到的 PHP 处理数据时遇到问题。这是表架构：

```
parents:
id | firstname | lastname

children:
id | firstname | lastname

parent_child_link
child_id | parent_id 
```

我需要以这种方式保存数据，因为我想将多个父母链接到一个孩子。现在，当我想检索一个孩子时，我想获取孩子的所有信息，还有父母的 id。这显然是一个 JOIN 查询，所以我使用：

```
SELECT *
FROM children c
JOIN parent_child_link l on l.child_id=c.id
WHERE c.id=1 
```

现在，当这个 id=1 的孩子有 2 个父母（假设 id 为 1 和 2）时，我得到以下结果：

```
id | firstname | lastname | parent_id
1    test        test       1
1    test        test       2 
```

如果我在 PHP 中处理它，我会得到 2 个数组，但我希望它在一个数组中，例如

```
array(
    'firstname' => 'test', 
    'lastname' => test',
    'parents' => array(1, 2)
) 
```

我怎样才能做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:41:20.023

您可以使用 GROUP_CONCAT 返回值的逗号分隔数组

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T20:55:25.790

您可以在 php.ini 中处理您的查询结果。创建一个以子 ID 为索引的新数组，并为查询结果中的每个项目创建一个新数组，如果它不存在则将其添加到数组中。如果是，则将父 ID 添加到其“父母”项。

# html - 在电子邮件中使用隐藏输入是个好主意吗？

> ID：10438920
> 
> 赞同：0
> 
> 时间：2012-05-03T20:33:26.950
> 
> 标签：html, email, html-email

我想将电子邮件的内容与我的软件中的对象连接起来。例如带有评论。当用户使用电子邮件回复评论时，消息的内容也应作为评论出现在系统中。我能想到的唯一方法是在 HTML 格式的电子邮件中使用隐藏的输入，并将评论的 ID 放在那里。该行为类似于您可以通过电子邮件回复的 google 群组。

10倍

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:37:17.637

您可以使用自定义标题来实现您想要的。

[VB示例](http://www.systemnetmail.com/faq/3.3.4.aspx)

在 google 中查找以查找更多信息。

# c# - 修改当前 httprequest 后服务器错误

> ID：10438924
> 
> 赞同：0
> 
> 时间：2012-05-03T20:33:39.427
> 
> 标签：c#, asp.net, sharepoint, httprequest, server-error

我在这方面已经太久了，我敢肯定有人会在几秒钟内指出我的错误。

我的公司有一个 ipad 应用程序，可以为我们的销售人员下载销售材料（PowerPoint、视频等）。所有资源都位于 SharePoint 内的文档库中。我没有将文档库公开（并且不太安全），而是创建了一个 .aspx 页面，其中包含一个用于获取文档的 Web 部件。ipad 应用程序联系 .aspx 页面并发送两个查询：“token”和“document”。令牌本质上是一个密码，因此 Web 部件知道它来自 ipad 应用程序。如果令牌正确，则 Web 部件将获取指定的任何文档。

**这是我的问题**。该文档按原样获取并交付，但是如果我尝试下载另一个文档，或为此导航服务器上的任何其他位置，我会收到服务器错误。我必须关闭浏览器（也就是结束会话）。

**我得到的错误在这里解释**：http : [//blog.tylerholmes.com/2008/07/problem-with-sharepoint.html](http://blog.tylerholmes.com/2008/07/problem-with-sharepoint.html)

但是，我不想在该博客上使用修复程序，因为我知道我的代码导致了问题，并且我想修复问题的根源。

我的 Web 部件代码如下：

```
protected override void CreateChildControls()
    {
        string toRender = string.Empty;
        SPWeb webInUserContext = SPContext.Current.Web;
        SPSite SiteInUserContext = SPContext.Current.Site;
        Guid webGuid = webInUserContext.ID;
        Guid siteGuid = SiteInUserContext.ID;

         //gives visitors the authority to see the dam data
        SPSecurity.RunWithElevatedPrivileges(delegate()
        {
            using (SPSite site = new SPSite(siteGuid))
            {
                using (SPWeb web = site.OpenWeb(webGuid))
                {
                    using (DAM dam = new DAM())
                    {
                        String mystring = HttpContext.Current.Request.Url.AbsoluteUri;
                        //If the request contains the correct token
                        if (mystring.ToString().Contains("REgrgg0434GgdLk6"))
                        {
                            //Get the document data into a byte array
                            byte[] buf = new byte[0];
                            using (var wc = new System.Net.WebClient())
                            {
                                //Right now I'm just hard-coding a document url for testing, rather than
                                //getting it from the url query
                                String url = "http://web-dev/sites/damedit/DocLibrary/document.ppt";
                                System.Net.CredentialCache cc = new System.Net.CredentialCache();
                                cc.Add(new Uri(url), "NTLM", new System.Net.NetworkCredential("username", "password", "domain"));
                                wc.Credentials = cc;
                                buf = wc.DownloadData(url);
                            }

                            //Rewrite the current response so that it contains the document
                            HttpContext.Current.Response.Clear();
                            HttpContext.Current.Response.ContentType = "application/pdf";
                            HttpContext.Current.Response.AddHeader("Content-Disposition", "attachment;filename=\"document.ppt\"");
                            HttpContext.Current.Response.BinaryWrite(buf);
                            HttpContext.Current.Response.Flush();
                            HttpContext.Current.Response.End();
                        }
                    }
                }
            }
        });
        base.CreateChildControls();
    } 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:25:17.290

好的，我找到了解决方案。我所要做的就是删除**HttpContext.Current.Response.Flush();** 线。原来是下一行代码，**HttpContext.Current.Response.End();** 与 Flush 方法做同样的事情，它将响应输出发送到客户端。出于某种原因，当您同时调用这两种方法时，服务器不喜欢它。希望这对某人有帮助！

# php - 如何在外部 PHP 工作表的 HTML 代码前后插入 PHP？（用 PHP 包装一个 div）

> ID：10438925
> 
> 赞同：-2
> 
> 时间：2012-05-03T20:33:40.527
> 
> 标签：php

这是我的问题，我有各种各样的 PHP 文件，可以为我的网站创建特定的主题。我创建了一个子主题，它使用父主题中的 PHP 框架，但使用备用 CSS 和一种 functions.php。在父主题的 PHP 中有用于创建什锦`<div>`s 的 HTML。我需要的是使用孩子的functions.php 来包装`<div>`来自父母的PHP/HTML 的s块，该块`<div>`具有自定义id 和类。换句话说，我想在打开之前和关闭之后 `<div>`使用外部 PHP 表将 HTML 包装在一个中。`<div>`

有没有可以做到这一点的PHP函数？

我无法编辑父主题 PHP，由于父主题具有升级功能，我不能只是将代码从父主题复制并粘贴到子主题。作为参考，这里是来自父文件的 PHP 块。我想`<div id="footer">`用`<div>`id 为“footer-wrapper”来包装。

```
<!-- footer -->
        <div id="footer"<?php $this->html( 'userlangattributes' ) ?>>
            <?php foreach( $this->getFooterLinks() as $category => $links ): ?>
                <ul id="footer-<?php echo $category ?>">
                    <?php foreach( $links as $link ): ?>
                        <li id="footer-<?php echo $category ?>-<?php echo $link ?>"><?php $this->html( $link ) ?></li>
                    <?php endforeach; ?>
                </ul>
            <?php endforeach; ?>
            <?php $footericons = $this->getFooterIcons("icononly");
            if ( count( $footericons ) > 0 ): ?>
                <ul id="footer-icons" class="noprint">
<?php           foreach ( $footericons as $blockName => $footerIcons ): ?>
                    <li id="footer-<?php echo htmlspecialchars( $blockName ); ?>ico">
<?php               foreach ( $footerIcons as $icon ): ?>
                        <?php echo $this->skin->makeFooterIcon( $icon ); ?>

<?php               endforeach; ?>
                    </li>
<?php           endforeach; ?>
                </ul>
            <?php endif; ?>
            <div style="clear:both"></div>
        </div>
        <!-- /footer --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:38:29.267

在 child_theme.php 中

```
echo '<div id="footer-wrapper">';
include('parent_theme_footer_block.php');
echo '</div>'; 
```

# tsql - 使用非英语字符集的函数

> ID：10438934
> 
> 赞同：0
> 
> 时间：2012-05-03T20:34:05.587
> 
> 标签：tsql, function, cjk

我有一个基本上从选择中去除数字的功能。此功能适用于基于英语的字符集。我有一组由非英文字符（中文、日文、印度文等）组成的新数据，但我没有得到预期的效果。我正在使用该`NVarchar`集合来存储任何可能是非英语的记录。以下是我目前正在使用的功能。任何建议都会非常有帮助。

```
GO
/****** Object:  UserDefinedFunction [dbo].[StripVenName]    Script Date: 05/03/2012 16:24:46 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE FUNCTION [dbo].[StripVenName] (@InString as VarChar(8000))                           
RETURNS NVarChar(100) AS                            
BEGIN                           
    Declare @ReturnVal as NVarchar(4000)                        
    Declare @OutString as NVarchar(4000)                        
    Declare @Pos as smallint                        
    Declare @CurChar as NVarChar(1)                     

    IF LEN(@InString) = 0                       
        SET @ReturnVal = ''                 
    ELSE                        
    BEGIN                       
        Set @Pos = 1                    
        SET @OutString = ' '                    
        WHILE (@Pos <= Len(@InString))                  
        BEGIN                   
            Set @CurChar =  SUBSTRING(@InString, @Pos, 1)               
            if ASCII(@CurChar) between 65 and 90 or ASCII(@CurChar) between 97 and 122              
                SET @OutString = @OutString +   @CurChar            
            Set @Pos = @Pos + 1             
        END                 

        if len(@OutString) = 0                  
            SET @OutString = @InString              
        SET @ReturnVal = LTRIM(RTRIM(@OutString))                   
    END                     
RETURN @ReturnVal                           

END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T20:55:06.267

几年前我写了一篇关于这个的博客。该博客解释了如何删除字母，但您想删除数字。[有关SQL Server 提取数据](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-extracting-data-again)的完整说明，请参阅博客

您的代码可以简化为这个（它也会表现得更好）。

```
Create Function [dbo].[RemoveNumericCharacters](@Temp NVarChar(1000))
Returns NVarChar(1000)
AS
Begin

    While PatIndex(N'%[0-9]%', @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(N'%[0-9]%', @Temp), 1, N'')

    Return @Temp
End 
```

# excel - 需要将用户选择的工作表名称分配给变量

> ID：10438935
> 
> 赞同：2
> 
> 时间：2012-05-03T20:34:06.040
> 
> 标签：excel, excel-2007, vba

我想提示用户在工作表中选择一个单元格来填充一个值。我正在尝试使用`Application.Input`，但它没有获取在其中选择单元格的工作表的名称......它继续使用运行宏时处于活动状态的工作表名称。

我到处找。有没有办法将工作表名称以及用户在提示时选择的单元格范围分配给变量？

```
varCellContent = Application.InputBox(prompt:="Choose a sheet by clicking on any cell in it.", Type:=8)
strDestinationSheetName = ActiveSheet.Name
MsgBox ("Sheet = " & strDestinationSheetName) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:50:30.440

这是你正在尝试的吗？

```
Option Explicit

Sub Sample()
    Dim varCellContent As Range
    Dim strDestinationSheetName As String

    On Error Resume Next
    Set varCellContent = Application.InputBox(Prompt:="Choose a sheet by clicking on any cell in it.", Type:=8)
    On Error GoTo 0

    If Not varCellContent Is Nothing Then
        strDestinationSheetName = varCellContent.Parent.Name

        MsgBox ("Sheet = " & strDestinationSheetName)
    End If
End Sub 
```

# html - Jekyll 上是否支持与 mathjax 配合得很好的降价解析器？

> ID：10438937
> 
> 赞同：13
> 
> 时间：2012-05-03T20:34:11.973
> 
> 标签：html, markdown, jekyll, mathjax

我使用基于 Jekyll 的博客，并且需要一个不会破坏我的 Mathjax 表达式的降价解析器（例如，解释`b_t - b_{t-1}`为`b<em>t - b</em> t - 1`）。Mathjax 和 markdown 在 math.stackechange.com 和 mathoverflow.net 上相处得很好。一些解析器还需要对开始/结束等式符号进行双重转义`\\(`，而其他解析器似乎不需要。

**不是完全解决方案的事情：**

[Redcarpet2](https://github.com/tanoku/redcarpet)有一个选项`no_intra_emphasis`，它可以避免字母之间的下划线被破坏，所以`b_t`没关系，但它仍然是 clobbers `b_{t-1}`。

有一个 Jekyll 插件可以让你使用流动的语法，比如`{% m}%`开始一个等式，但这意味着文件不再是用纯 markdown 编写的，因此不能移植到其他上下文中。

那么有没有一个不同的降价解释器可以让我进入 Jekyll 并体验幸福呢？如果没有，其他人找到了哪些解决方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-04T01:23:52.770

Markdown 不会处理块级 HTML 标记中的任何内容，因此只需将 Mathjax 语法包装在`<div>` `</div>`其中即可保护 Mathjax 语法，而不管解释器如何。这很好地避免了必须转义开始和结束 Mathjax 的命令，例如`\(`(inline) 和`\[`(display)。感谢 Github 上的[@lsegal](https://github.com/lsegal)向我指出这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T05:06:56.707

是的，它是[kramdown](http://kramdown.rubyforge.org)，我已经完成了配置它的过程，并在[我的博客](http://oblita.com/blog/2012/07/06/octopress-with-mathjax-by-kramdown/)中进行了解释。我还发现您可以使用语法让 Redcarpet 接受内联数学`\\( some math \\)`。它将输出`\( math \)`到 MathJax。无论如何，我更喜欢 kramdown，因为它声明支持 LaTeX。

# java - 用“super”生成

> ID：10438940
> 
> 赞同：7
> 
> 时间：2012-05-03T20:34:23.927
> 
> 标签：java, generics

我想写一个这样的Interator：

```
class Plant { }
class Tree extends Plant { }
class Maple extends Tree { }

// Iterator class: compiler error on the word "super".
class MyIterator<T super Maple> implements Iterator<T> {
    private int index = 0;
    private List<Maple> list = // Get the list from an external source.

    public T next() {
         Maple maple = list.get(index++);
         // Do some processing.
         return maple;
    }

    // The other methods of Iterator are easy to implement.
} 
```

从概念上讲，这个想法是有一个看起来像它返回树或植物（即使它们总是枫树）的迭代器，而无需为每个迭代器编写单独的类。

`T super Maple`但是当我用;进行泛化时，编译器不喜欢它。显然你只能使用`T extends Something`. 有谁知道完成同样事情的好方法？

我问的动机是我有一个程序，它使用 API 的接口。我想要一种方法返回接口的迭代器（用于 API），另一种方法返回实现类的迭代器（供内部使用）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:55:44.110

请参阅：[为什么类型参数没有下限？](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ107)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T20:50:31.437

如果`Maple`是 a`Tree`和 a `Plant`，因为它同时扩展了两者，那么在您要使用的超级子句中又有什么意义呢？您可以通过经典的子类型多态性分配`Mapple`给`Object`、`Tree`或`Plant`引用。

`? extends T`和都是`? super T`通配符，声明为类型参数以替换类型参数`T`。

您打算做的是定义类型参数而不是类型参数的边界。您可以简单地将类型参数声明为 T，没有界限，然后在使用它时，使用通配符作为类型参数。

```
class MyIterator<T> implements Iterator<T> { ... } 
```

当你使用它时：

```
MyIterator<? super Maple> iter; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T02:59:22.893

好的，所以你的迭代器返回了一个基于 maple 的迭代器，但是你想将它转换为一个基于 Plant 的迭代器。

让我们假设（片刻）Iterator 有一个方法 insertInto(T t) 将一个对象放入列表中迭代器所在的位置。. 如果将迭代器转换为 Iterator<Plant> 则意味着可以调用 i.insertInto(myCarrot) - 因为胡萝卜是植物。但这会违反类型 - 它会试图将胡萝卜放入枫树的基础列表中。

换句话说，您的迭代器*不是*Plants 上的迭代器，它不会将任何旧植物作为其方法参数，这就是为什么您不能这样转换或生成它的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T20:57:34.833

它声明一个`super`-bounded 类型参数是不允许[的，原因是它没有用](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ107)。

您成功地偶然发现了一个有趣的案例，嗯，它*确实*有意义，因为如果您正在实现一个只读迭代器，那么像这样绑定它*会*很方便。

简单的选择是让它存在并实现`Iterator<Maple>`，或者`Iterator<T>`进行一些类型检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T09:54:18.553

显然没有理想的方法来做到这一点，所以我会建议两个次优的解决方案。

第一个是这样的包装迭代器：

```
public class SuperTypeIterator<E> implements Iterator<E> {
    private final Iterator<? extends E> iter;

    public SuperTypeIterator(Iterator<? extends E> iter) {
        this.iter = iter;
    }

    @Override
    public E next() {
        return iter.next();
    }

    // And similarly for the other methods of Iterator
} 
```

这允许您像这样更改返回类型：

```
Iterator<Plant> getPlantIterator() {
    return new SuperTypeIterator<Plant>( new MapleIterator() );
} 
```

这以创建新对象为代价提供了完整的类型安全性。

另一种方法是使用未经检查的演员表：

```
Iterator<Plant> getPlantIterator() {
    return (Iterator<Plant>) (Iterator<?>) new MapleIterator();
    // Yes, the double cast is necessary to get it to compile.
} 
```

这消除了创建包装对象的需要，但以牺牲所有类型安全为代价。

# undefined - Jasmine 匹配返回值

> ID：10438944
> 
> 赞同：0
> 
> 时间：2012-05-03T20:34:58.010
> 
> 标签：undefined, jasmine, matcher

我得到了一些典型的茉莉花代码，例如：

```
expect(actual).someMatcher(expected); 
```

有没有办法确定这种匹配是成功还是失败（以编程方式）？根据结果​​，我可能想在之后进行某些操作。例如，如果失败，则将实际值写入磁盘。

使用匹配器的返回值似乎不起作用。它总是返回未定义的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T10:31:00.270

最干净的方法是写你自己的[记者](http://pivotal.github.com/jasmine/jsdoc/symbols/jasmine.Reporter.html)。

或者，在规范中，`this`是规范。将返回结果，`this.results()`您可以通过查看`items_`.`this.results()`

# jquery - 将图像保存到 Json 文件

> ID：10438947
> 
> 赞同：2
> 
> 时间：2012-05-03T20:35:17.270
> 
> 标签：jquery, json, html

我试图为浏览器创建一个扩展，我想在本地保存图像。我希望将图像保存在 json 文件中。我很迷茫怎么做。下面是我的代码，虽然我确信我离得很远。谢谢

```
<label>Add New Image From Desktop</label>
        <input type="radio" title="Add New Image From Local Machine" name="addMethod" id="radio" />
        </br>
        <input  type="file" id="file-field"/>
        <input type="button" id="upload" value="Submit" />
        </br>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" language="JavaScript">
            $(document).ready(function() {
                $("#upload").click(function(data) {
                    //alert(data);
                    $.ajax({
                        type : "POST",
                        url : "settings.json",
                        dataType : 'json',
                        data : {
                            json : JSONArray.stringify(data) /* convert here only */
                        }
                    });
                    window.location.reload();
                });
            });
        </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:39:14.617

JSON 没有真正的二进制数据存储。如果您认为您确实必须这样做，那么您能做的最好的事情就是对您的数据进行 base64 编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:38:42.800

您需要将图像转换为 Base64 编码，以便将其存储在 JSON 中。JSON 不能包含二进制数据。

# java - 如何修改不同窗体上的控件？

> ID：10438948
> 
> 赞同：0
> 
> 时间：2012-05-03T20:35:21.920
> 
> 标签：java, swing, netbeans

我需要使用 JTable 第一列的内容来设置 JComboBox 下拉列表中的值。问题是 JTable 采用不同的形式 (JFrame)，因此不能直接访问私有 JComboBox。如何从 JTable 表单向 JComboBox 表单发送信号和/或事件，让它知道它需要更新它的下拉内容？我不关心数据，我可以创建一个 public String[] 或其他东西，但我如何正确通知 JComboBox 它需要自行更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T21:31:53.213

> 我需要使用 a 的第一列的内容`JTable`来设置`JComboBox`下拉列表中的值。问题是`JTable`是在不同的形式 ( `JFrame`) 所以私人`JComboBox`不能直接访问。

为什么 the`JComboBox`和 the`JTable`应该可以互相访问？这些只是视图组件。如果您想显示组合框而不显示表格（例如在测试中）会发生什么？如果它直接从那里检索数据，那么`JTable`您有一个严重的问题。在你创建你的那一刻，`JTable`你有一个`TableModel`包含`JTable`. 应该共享的是该模型（或至少该模型中的数据）。

所以让组合框的模型和表格的模型共享相同的数据，一切都会好起来的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:38:10.540

Swing MVC 模型会说您应该更新模型对象。当 JComboBox 重新显示时，它会看到新的模型值。

# maven - Maven 包作为战争：不考虑 src/main/java 下带有 *.vm 文件的文件夹（速度模板）

> ID：10438956
> 
> 赞同：1
> 
> 时间：2012-05-03T20:36:00.333
> 
> 标签：maven, maven-2

我使用 Maven 将 Java EE 项目打包为 war。

我使用 tomcat-maven-plugin，我只是简单地 "mvn clean tomcat deploy" 。

一切正常，除了没有打包到 War 文件中的文件夹。

此文件夹是 src/main/java 下的源文件夹，其中只有 *.vm 文件（不是 .java 文件），它们是我的 Velocity 模板。

有没有办法告诉 maven 打包这个文件夹！（我怀疑只考虑带有 .java 文件的包）

在控制台中我得到：

```
[INFO] --- maven-war-plugin:2.1.1:war (default-war) @ accueil_individu ---
[INFO] Packaging webapp
[INFO] Assembling webapp [accueil_individu] in             [D:\DevSpring\workspace\accueil_individu\target\accueil_individu]
[INFO] Processing war project
[INFO] Copying webapp resources        [D:\DevSpring\workspace\accueil_individu\src\main\webapp]
[INFO] Processing overlay [ id org.springframework.security:spring-security-samples-cas-client]
[INFO] Webapp assembled in [1699 msecs]
[INFO] Building war:   D:\DevSpring\workspace\accueil_individu\target\accueil_individu.war
[WARNING] Warning: selected war files include a WEB-INF/web.xml which will be ignored 
(webxml attribute is missing from war task, or ignoreWebxml attribute is specified as    'true')
[INFO] 
[INFO] <<< tomcat-maven-plugin:1.1:deploy (default-cli) @ accueil_individu <<<
[INFO] 
[INFO] --- tomcat-maven-plugin:1.1:deploy (default-cli) @ accueil_individu ---
[INFO] Deploying war to http://pcwebapps02.ifma.fr:8080/accueil_individu  
[INFO] OK - Application déployée pour le chemin de contexte /accueil_individu
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:40:21.193

像速度模板文件这样的资源文件应该在运行时的类路径中结束，应该在 src/main/resources 而不是 /src/main/java

在此处阅读有关 Maven 标准目录布局的更多信息[http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)

# asp.net - 为什么 RazorViewEngine 不选择我的 DisplayTemplate？

> ID：10438958
> 
> 赞同：7
> 
> 时间：2012-05-03T20:36:29.040
> 
> 标签：asp.net, visual-studio-2010, asp.net-mvc-3, razor

应用程序是一个带有 RAZOR 视图引擎的 MVC3 应用程序。

这里使用的控制器是TestController。我正在使用嵌套视图。

基本视图（项目列表）是这样的，

```
//Listing.cshtml
@model ItemsList 
@for (int i = 0; i < Model.Items.Count(); i++)
    {
        @Html.DisplayFor(x => x.Items[i], new { RowPosition = i})
} 
```

这是项目的模板

```
//Item.cshtml
@model Item
@Html.DisplayFor(x=>x.HeaderText)
@Html.DisplayFor(x=>x, "ItemDetails") 
```

这是项目详细信息的视图

```
//ItemDetails.cshtml
@model Item
@Html.DisplayFor(x=>x.Description) 
```

所以，我试图将模型从 ITEM 模板传递到 ITEMDETAILS 模板。ItemDetails.cshtml 位于“Views\Test\DisplayTemplates”下。事实上，我已经尝试将它放在文件夹“Views\Shared”以及“Views\Shared\DisplayTemplates”下。但是 View 引擎似乎只是不接受它。

[但是，此处](http://msdn.microsoft.com/en-us/library/ee407429%28v=vs.98%29.aspx)的Microsoft 文档指出，视图引擎确实在 Controller\DisplayTemplates 文件夹中查找以使用使用的 TemplateName 获取 VIEW。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T21:56:04.133

这似乎是 Display/EditorTemplates 的预期行为，大概是为了防止自定义显示模板中的意外无限递归，例如执行 (in `Item.cshtml`)：

```
@model Item
@Html.DisplayFor(x => x) 
```

...这将无限显示`Item.cshtml`DisplayTemplate。

显然，在您的示例中，您将项目/模型传递给*不同*的模板，因此它不会导致无限递归。但是，它似乎仍然被框架中的相同安全防护所捕获。不确定它是否会被归类为“错误”或只是“设计”？

这是[DisplayFor/TemplateFor 助手](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/f59892797e46#src%2fSystem.Web.Mvc%2fHtml%2fTemplateHelpers.cs)中的检查：

```
// Normally this shouldn't happen, unless someone writes their own custom Object templates which 
// don't check to make sure that the object hasn't already been displayed 
object visitedObjectsKey = metadata.Model ?? metadata.RealModelType;
if (html.ViewDataContainer.ViewData.TemplateInfo.VisitedObjects.Contains(visitedObjectsKey)) {    // DDB #224750 
    return String.Empty;
} 
```

`ViewData.TemplateInfo.VisitedObjects`存储父模板的访问对象/模型。当你运行时：

```
@Html.DisplayFor(x => x.Items[i], new { RowPosition = i}) 
```

它呈现您的`Item.cshtml`DisplayTemplate 并将项目/模型添加到`VisitedObjects`. 这意味着当`Item.cshtml`尝试显示另一个具有相同项目/模型的子模板时：

```
@Html.DisplayFor(x => x, "ItemDetails") 
```

项目/模型已经在 中`VisitedObjects`，所以上面的 if 语句返回 true 而不是渲染`ItemDetails.cshtml`它只是默默地返回/渲染一个空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T21:13:59.907

尝试使用`@Html.RenderPartial("ItemDetails", item)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T21:09:42.497

首先，不要使用 for 循环。Display/EditorTemplates 能够处理集合。

二、什么是ItemsList？它是如何定义的？如果它只是命名一个特定的集合类型，那么不要这样做。只需有一个 List 或其他东西（除非您需要特殊的项目处理，在这种情况下，在您的集合类上实现 IEnumerable）。然后，如果您转换为使用 List，您将拥有一个 ItemsList.cshtml 或只是一个 Item.cshtml

此外，您在主视图中的 DisplayFor() 是错误的。您不能以这种方式将 html 属性传递给 DisplayTemplates。

# php - 避免 zip 文件内容的绝对路径名

> ID：10438961
> 
> 赞同：3
> 
> 时间：2012-05-03T20:36:46.917
> 
> 标签：php, linux, zip

我正在用php编写。我有以下代码：

```
$folder_to_zip = "/var/www/html/zip/folder";
$zip_file_location = "/var/www/html/zip/archive.zip";
$exec = "zip -r $zip_file_location  '$folder_to_zip'";

exec($exec); 
```

我希望将 zip 文件存储在`/var/www/html/zip/archive.zip`它所在的位置，但是当我打开该 zip 文件时，整个服务器路径都在 zip 文件中。如何编写此文件以使服务器路径不在 zip 文件中？

运行此命令的脚本不在同一目录中。它位于`/var/www/html/zipfolder.php`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:59:47.047

zip 倾向于以任何路径存储文件以访问它们。Greg 的评论为您提供了针对当前目录树的潜在修复。更一般地说，你可以 - 有点粗略 - 做这样的事情

```
$exec = "cd '$folder_to_zip' ; zip -r '$zip_file_location  *'" 
```

通常，尽管您希望最后一个目录成为存储名称的一部分（这有点礼貌，所以无论谁解压都不会将所有文件转储到他们的主目录或其他目录中），但您可以通过将其拆分为单独的变量来实现使用文本处理工具，然后执行类似的操作

```
$exec = "cd '$parent_of_folder' ; zip -r '$zip_file_location $desired_folder'" 
```

警告：没有时间测试任何这些愚蠢的错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T07:29:46.180

请检查这个在 Windows 和 Linux 服务器上都能正常工作的 PHP 函数。

```
function Zip($source, $destination, $include_dir = false)
{
    if (!extension_loaded('zip') || !file_exists($source)) {
        return false;
    }

    if (file_exists($destination)) {
        unlink ($destination);
    }

    $zip = new ZipArchive();
    if (!$zip->open($destination, ZIPARCHIVE::CREATE)) {
        return false;
    }

    $source = realpath($source);

    if (is_dir($source) === true)
    {

        $files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($source), RecursiveIteratorIterator::SELF_FIRST);

        if ($include_dir) {

            $arr = explode(DIRECTORY_SEPARATOR, $source);
            $maindir = $arr[count($arr)- 1];

            $source = "";
            for ($i=0; $i < count($arr) - 1; $i++) {
                $source .= DIRECTORY_SEPARATOR . $arr[$i];
            }

            $source = substr($source, 1);

            $zip->addEmptyDir($maindir);

        }

        foreach ($files as $file)
        {
            // Ignore "." and ".." folders
            if( in_array(substr($file, strrpos($file, '/')+1), array('.', '..')) )
                continue;

            $file = realpath($file);

            if (is_dir($file) === true)
            {
                $zip->addEmptyDir(str_replace($source . DIRECTORY_SEPARATOR, '', $file . DIRECTORY_SEPARATOR));
            }
            else if (is_file($file) === true)
            {
                $zip->addFromString(str_replace($source . DIRECTORY_SEPARATOR, '', $file), file_get_contents($file));
            }
        }
    }
    else if (is_file($source) === true)
    {
        $zip->addFromString(basename($source), file_get_contents($source));
    }

    return $zip->close();
} 
```

# php - 错误=字符串。$variable - 失败

> ID：10438963
> 
> 赞同：0
> 
> 时间：2012-05-03T20:37:07.963
> 
> 标签：php, javascript

为什么会失败？它在`onerror=`不是变量而只是手动输入的字符串时起作用。

```
<?php 
$error = "onerror='this.src = \'http://userlogos.org/files/logos/pek/stackoverflow2.png\'';";
for ($i = 1; $i <= 10; $i++) { 
  echo "<img src='http://services.runescape.com/m=itemdb_rs/3716_obj_sprite.gif?id=" . $i . "' alt='ID " . $i . "' title='ID " . $i . "'" . $error . "/>"; 
} 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:48:25.857

试试这个：

```
<?php 
$error = " onerror='this.src =\"http://userlogos.org/files/logos/pek/stackoverflow2.png\";'";
for ($i = 1; $i <= 10; $i++) { 
  echo "<img src='http://services.runescape.com/m=itemdb_rs/3716_obj_sprite.gif?id=" . $i . "' alt='ID " . $i . "' title='ID " . $i . "'" . $error . "/>"; 
} 
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-03T20:45:02.920

引用太多。我将其重写如下，然后您可以更容易地发现错误：

```
<?php 
$error = "onerror='this.src = \'http://userlogos.org/files/logos/pek/stackoverflow2.png\'';";
for ($i = 1; $i <= 10; $i++) { 
  echo "<img src='http://services.runescape.com/m=itemdb_rs/3716_obj_sprite.gif?id=$i' alt='ID $i' title='ID $i' $error />"; 
} 
?> 
```

不确定这是否正是您想要的，但它更容易调试。

# java - 国际化 JSF 2.0

> ID：10438964
> 
> 赞同：3
> 
> 时间：2012-05-03T20:37:14.377
> 
> 标签：java, jsf-2, internationalization, locale

我有一个应用程序，我正在尝试设置国际化可用性。

这是我的 faces-config.xml：

```
<application>
    <locale-config>
        <default-locale>lt</default-locale>
        <supported-locale>en</supported-locale>
        <supported-locale>de</supported-locale>
    </locale-config>
    <resource-bundle>
        <base-name>application</base-name>
        <var>msg</var>
    </resource-bundle>
</application> 
```

我有三个属性文件：

```
application_lt.properties
application_en.properties
application_de.properties 
```

豆类：

```
@ManagedBean(name = Beans.LOCALE_BEAN)
@SessionScoped
public class LocaleBean extends BaseBean implements Serializable {

    private String lang;

    public String getLang() {
        return lang;
    }

    public void setLang(String lang) {
        this.lang = lang;
    }
} 
```

动作类：

```
@ManagedBean(name = "localeAction")
@SessionScoped
public class LocaleAction extends BaseAction implements Serializable {

    public void changeLocale() {
        LocaleBean localeBean = getBean(Beans.LOCALE_BEAN);
        String language = localeBean.getLang();
        FacesContext.getCurrentInstance().getViewRoot().setLocale(new Locale(language));
    }

} 
```

要更改语言环境，我正在使用 commandLink：

```
<h:commandLink action="#{localeAction.changeLocale}">
    <f:setPropertyActionListener target="#{localeBean.lang}" value="en"/>
    English
</h:commandLink>

<h:commandLink action="#{localeAction.changeLocale}">
    <f:setPropertyActionListener target="#{localeBean.lang}" value="lt"/>
    Lithuanian
</h:commandLink> 
```

第一个问题：

我已经定义我的默认语言环境是“lt”：lt。为什么当我启动我的应用程序文本值是从 application_en.properties 而不是从 application_lt.properties 加载的？

第二个问题：

当我执行 commandLink 操作时，语言环境会根据我选择的语言环境而变化。但是执行该操作是单击一次，第二次单击应用程序的任何其他链接也可以，当我第三次单击应用程序的任何链接时，文本值位于 application_en.properties。似乎语言环境以某种方式发生了变化......

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T20:50:59.200

> *我已经定义我的默认语言环境是“lt”：lt。为什么当我启动我的应用程序文本值是从 application_en.properties 而不是从 application_lt.properties 加载的？*

显然是因为您的浏览器通过请求标头将自己的语言环境标识`en`为首选语言环境。`Accept-Language`JSF 将自动使用它，因为它属于受支持的语言。您需要在浏览器的设置中更改首选语言。

* * *

> *当我执行 commandLink 操作时，语言环境会根据我选择的语言环境而变化。但是执行该操作是单击一次，第二次单击应用程序的任何其他链接也可以，当我第三次单击应用程序的任何链接时，文本值位于 application_en.properties。似乎语言环境以某种方式发生了变化。*

显然你改变了看法。您的操作方法仅更改当前视图的区域设置。您需要确保在主模板或至少所有视图中设置区域设置`LocaleBean`表单`<f:view>`。

```
<f:view locale="#{localeBean.lang}"> 
```

### 也可以看看：

*   [JSF 中的本地化，如何记住每个会话而不是每个请求/视图选择的语言环境](https://stackoverflow.com/questions/4830588/jsf-locale-is-set-per-request-not-for-session/4830669#4830669)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:54:38.187

**第一个问题** 当涉及到语言环境时，JSF 正在读取客户端浏览器的 HTTP Accept-Language 标头并使用最喜欢的语言环境。如果应用程序不支持（faces-config 设置），则它使用 HTTP 标头中的第二首选语言环境等。如果应用程序不支持客户端首选语言环境，则使用 faces-config.xml 中的默认语言环境用来。因此，可能会简单地忽略 faces-config.xml 中的默认语言环境。

因此，您的客户端浏览器似乎可能会在 HTTP Accept-Language 标头中发送英语语言环境。

**第二个问题。** 发生这种情况是因为默认情况下区域设置是按请求设置的，而不是按用户会话设置的。看看这个[问题](https://stackoverflow.com/questions/4830588/jsf-locale-is-set-per-request-not-for-session) ，看看如何克服这个问题。

# r - 为丢失的时间步添加行的最快方法？

> ID：10438969
> 
> 赞同：36
> 
> 时间：2012-05-03T20:37:51.497
> 
> 标签：r, dataframe, plyr, data.table

我的数据集中有一列，其中时间段 ( `Time`) 是范围从 ab 的整数。有时，任何给定的组都可能缺少时间段。我想用`NA`. 以下是 1 个（几个 1000 个）组的示例数据。

```
structure(list(Id = c(1, 1, 1, 1), Time = c(1, 2, 4, 5), Value = c(0.568780482159894, 
-0.7207749516298, 1.24258192959273, 0.682123081696789)), .Names = c("Id", 
"Time", "Value"), row.names = c(NA, 4L), class = "data.frame")

  Id Time      Value
1  1    1  0.5687805
2  1    2 -0.7207750
3  1    4  1.2425819
4  1    5  0.6821231 
```

如您所见，时间 3 不见了。通常可能缺少一个或多个。我可以自己解决这个问题，但恐怕我不会以最有效的方式做到这一点。我的方法是创建一个函数：

生成从`min(Time)`到的时间段序列`max(Time)`

然后做一个`setdiff`来获取缺失`Time`值。

将该向量转换为`data.frame`

提取唯一标识符变量（`Id`以及上面未列出的其他变量），并将其添加到此 data.frame。

合并两者。

从函数返回。

因此，整个过程将按如下方式执行：

```
 # Split the data into individual data.frames by Id.
    temp_list <- dlply(original_data, .(Id)) 
    # pad each data.frame
    tlist2 <- llply(temp_list, my_pad_function)
    # collapse the list back to a data.frame
    filled_in_data <- ldply(tlist2) 
```

实现这一目标的更好方法？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-06T20:18:43.053

跟进 Ben Barnes 的评论并从他的`mydf3`:

```
DT = as.data.table(mydf3)
setkey(DT,Id,Time)
DT[CJ(unique(Id),seq(min(Time),max(Time)))]
      Id Time        Value Id2
 [1,]  1    1 -0.262482283   2
 [2,]  1    2 -1.423935165   2
 [3,]  1    3  0.500523295   1
 [4,]  1    4 -1.912687398   1
 [5,]  1    5 -1.459766444   2
 [6,]  1    6 -0.691736451   1
 [7,]  1    7           NA  NA
 [8,]  1    8  0.001041489   2
 [9,]  1    9  0.495820559   2
[10,]  1   10 -0.673167744   1
First 10 rows of 12800 printed. 

setkey(DT,Id,Id2,Time)
DT[CJ(unique(Id),unique(Id2),seq(min(Time),max(Time)))]
      Id Id2 Time      Value
 [1,]  1   1    1         NA
 [2,]  1   1    2         NA
 [3,]  1   1    3  0.5005233
 [4,]  1   1    4 -1.9126874
 [5,]  1   1    5         NA
 [6,]  1   1    6 -0.6917365
 [7,]  1   1    7         NA
 [8,]  1   1    8         NA
 [9,]  1   1    9         NA
[10,]  1   1   10 -0.6731677
First 10 rows of 25600 printed. 
```

`CJ`代表交叉连接，请参阅`?CJ`。使用 s 进行填充`NA`是因为`nomatch`默认情况下是`NA`. 设置`nomatch`为`0`改为删除没有匹配项。如果不需要用`NA`s 填充当前行，只需添加`roll=TRUE`. 这比用`NA`s 填充然后填充`NA`s 更有效。参见 中的描述`roll`。`?data.table`

```
setkey(DT,Id,Time)
DT[CJ(unique(Id),seq(min(Time),max(Time))),roll=TRUE]
      Id Time        Value Id2
 [1,]  1    1 -0.262482283   2
 [2,]  1    2 -1.423935165   2
 [3,]  1    3  0.500523295   1
 [4,]  1    4 -1.912687398   1
 [5,]  1    5 -1.459766444   2
 [6,]  1    6 -0.691736451   1
 [7,]  1    7 -0.691736451   1
 [8,]  1    8  0.001041489   2
 [9,]  1    9  0.495820559   2
[10,]  1   10 -0.673167744   1
First 10 rows of 12800 printed. 

setkey(DT,Id,Id2,Time)
DT[CJ(unique(Id),unique(Id2),seq(min(Time),max(Time))),roll=TRUE]
      Id Id2 Time      Value
 [1,]  1   1    1         NA
 [2,]  1   1    2         NA
 [3,]  1   1    3  0.5005233
 [4,]  1   1    4 -1.9126874
 [5,]  1   1    5 -1.9126874
 [6,]  1   1    6 -0.6917365
 [7,]  1   1    7 -0.6917365
 [8,]  1   1    8 -0.6917365
 [9,]  1   1    9 -0.6917365
[10,]  1   1   10 -0.6731677
First 10 rows of 25600 printed. 
```

* * *

您可以使用`on`. `CJ`也需要一个`unique`论点。一个带有两个“Id”的小例子：

```
d <- data.table(Id = rep(1:2, 4:3), Time = c(1, 2, 4, 5, 2, 3, 4), val = 1:7)

d[CJ(Id, Time = seq(min(Time), max(Time)), unique = TRUE), on = .(Id, Time)]
#     Id Time val
# 1:   1    1   1
# 2:   1    2   2
# 3:   1    3  NA
# 4:   1    4   3
# 5:   1    5   4
# 6:   2    1  NA
# 7:   2    2   5
# 8:   2    3   6
# 9:   2    4   7
# 10:  2    5  NA 
```

在这种特殊情况下，其中一个向量`CJ`是用 生成的`seq`，因此需要明确命名结果以匹配 中指定的名称`on`。在使用裸变量时`CJ`（如此处的“Id”），它们是自动命名的，如 in `data.table()`(from `data.table 1.12.2`)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-30T21:19:22.400

你可以用`tidyr`这个。

用于[`tidyr::complete`](http://tidyr.tidyverse.org/reference/complete.html)填充 的行`Time`，默认情况下使用 填充值`NA`。

### 创建数据

我扩展了示例数据以表明它适用于多个`Id`s，即使在不存在`Id`的全部范围内`Time`也是如此。

```
library(dplyr)
library(tidyr)

df <- tibble(
  Id = c(1, 1, 1, 1, 2, 2, 2),
  Time = c(1, 2, 4, 5, 2, 3, 5),
  Value = c(0.56, -0.72, 1.24, 0.68, 1.46, 0.74, 0.99)
)

df
#> # A tibble: 7 x 3
#>      Id  Time Value
#>   <dbl> <dbl> <dbl>
#> 1     1     1  0.56
#> 2     1     2 -0.72
#> 3     1     4  1.24
#> 4     1     5  0.68
#> 5     2     2  1.46
#> 6     2     3  0.74
#> 7     2     5  0.99 
```

### 填写缺失的行

```
df %>% complete(nesting(Id), Time = seq(min(Time), max(Time), 1L))

#> # A tibble: 10 x 3
#>       Id  Time Value
#>    <dbl> <dbl> <dbl>
#> 1      1     1  0.56
#> 2      1     2 -0.72
#> 3      1     3    NA
#> 4      1     4  1.24
#> 5      1     5  0.68
#> 6      2     1    NA
#> 7      2     2  1.46
#> 8      2     3  0.74
#> 9      2     4    NA
#> 10     2     5  0.99 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-04T00:11:05.360

*请参阅 Matthew Dowle 的回答（现在，希望在上面）。*

这是使用`data.table`包的东西，当有多个 ID 变量时它可能会有所帮助。它也可能比 更快`merge`，这取决于您想要的结果。我会对基准测试和/或建议的改进感兴趣。

首先，使用两个 ID 变量创建一些要求更高的数据

```
library(data.table)

set.seed(1)

mydf3<-data.frame(Id=sample(1:100,10000,replace=TRUE),
  Value=rnorm(10000))
mydf3<-mydf3[order(mydf3$Id),]

mydf3$Time<-unlist(by(mydf3,mydf3$Id,
  function(x)sample(1:(nrow(x)+3),nrow(x)),simplify=TRUE))

mydf3$Id2<-sample(1:2,nrow(mydf3),replace=TRUE) 
```

创建一个函数（这已被**编辑**- 见历史）

```
padFun<-function(data,idvars,timevar){
# Coerce ID variables to character
  data[,idvars]<-lapply(data[,idvars,drop=FALSE],as.character)
# Create global ID variable of all individual ID vars pasted together
  globalID<-Reduce(function(...)paste(...,sep="SOMETHINGWACKY"),
    data[,idvars,drop=FALSE])
# Create data.frame of all possible combinations of globalIDs and times
  allTimes<-expand.grid(globalID=unique(globalID),
    allTime=min(data[,timevar]):max(data[,timevar]),
    stringsAsFactors=FALSE)
# Get the original ID variables back
  allTimes2<-data.frame(allTimes$allTime,do.call(rbind,
    strsplit(allTimes$globalID,"SOMETHINGWACKY")),stringsAsFactors=FALSE)
# Convert combinations data.frame to data.table with idvars and timevar as key
  allTimesDT<-data.table(allTimes2)
  setnames(allTimesDT,1:ncol(allTimesDT),c(timevar,idvars))
  setkeyv(allTimesDT,c(idvars,timevar))
# Convert data to data.table with same variables as key
  dataDT<-data.table(data,key=c(idvars,timevar))
# Join the two data.tables to create padding
  res<-dataDT[allTimesDT]
  return(res)
} 
```

使用功能

```
(padded2<-padFun(data=mydf3,idvars=c("Id"),timevar="Time"))

#       Id Time        Value Id2
#  [1,]  1    1 -0.262482283   2
#  [2,]  1    2 -1.423935165   2
#  [3,]  1    3  0.500523295   1
#  [4,]  1    4 -1.912687398   1
#  [5,]  1    5 -1.459766444   2
#  [6,]  1    6 -0.691736451   1
#  [7,]  1    7           NA  NA
#  [8,]  1    8  0.001041489   2
#  [9,]  1    9  0.495820559   2
# [10,]  1   10 -0.673167744   1
# First 10 rows of 12800 printed.

(padded<-padFun(data=mydf3,idvars=c("Id","Id2"),timevar="Time"))

#      Id Id2 Time      Value
#  [1,]  1   1    1         NA
#  [2,]  1   1    2         NA
#  [3,]  1   1    3  0.5005233
#  [4,]  1   1    4 -1.9126874
#  [5,]  1   1    5         NA
#  [6,]  1   1    6 -0.6917365
#  [7,]  1   1    7         NA
#  [8,]  1   1    8         NA
#  [9,]  1   1    9         NA
# [10,]  1   1   10 -0.6731677
# First 10 rows of 25600 printed. 
```

编辑后的函数将 globalID 拆分为组合 data.frame 中的组成部分，然后与原始数据合并。这应该（我认为）更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T21:25:17.960

我的一般方法是使用`freqTable <- as.data.frame(table(idvar1, idvar2, idvarN))`然后拉出行 where `Freq==0`，根据需要填充，然后堆叠回原始数据。

# javascript - IE8 和 IE9 中的类似时间线布局问题

> ID：10438975
> 
> 赞同：2
> 
> 时间：2012-05-03T20:38:25.570
> 
> 标签：javascript, jquery, css, ajax, jsp

美国国家科学基金会于 2009 年在 nsf.gov 网站上安装了 Simile Timeline 的 v.2.3.1。可以在[http://www.nsf.gov/news/special_reports/history-nsf/timeline/index 上查看时间表。 .jsp](http://www.nsf.gov/news/special_reports/history-nsf/timeline/index.jsp) _ 当时，没有浏览器兼容性问题。我们现在在 IE8 和 IE9 中遇到时间线布局问题，但在 Firefox、Safari 和 Chrome 中没有。

已部署 IE 9 开发人员工具栏来检查 Javascript 问题，并且未报告任何错误。在[http://code.google.com/p/simile-widgets/issues/detail?id=428](http://code.google.com/p/simile-widgets/issues/detail?id=428)建议可以通过在时间线捆绑中将“className”更改为“class”来纠正布局问题。明喻小部件展品。进行了此更改，但未修复布局。然后进行了全局更改，但这也没有修复布局。然后，检查了 nsfhistory.js 文件，但布局问题仍然存在。

你有什么建议我们可以做些什么来纠正 IE8 和 IE9 中的 Simile 时间线的布局问题？如果可以修复，那么我们将能够在 nsf.gov 网站上保留时间表。

在此先感谢您的帮助。

史蒂夫

# android - 尝试启用 FFmpeg stagefright 支持时出现链接器错误

> ID：10438978
> 
> 赞同：0
> 
> 时间：2012-05-03T20:38:37.300
> 
> 标签：android, android-ndk, ffmpeg

我想在基于 FFmpeg - 版本 0.10.2“Freedom”的 Android 电影播放器​​中使用 stagefright 进行硬件加速解码。我已经使用工具目录中的构建脚本成功构建了所有库。但是，我有许多与 stagefright 相关的链接器错误，例如：

```
undefined reference to android::OMXClient::disconnect()
undefined reference to android::MediaBuffer::MediaBuffer(unsigned int) 
```

我认为使用 stagefright 支持构建的二进制文件是独立的，不需要任何其他东西来链接。难道我做错了什么？我应该将 libstagefright.so 添加到我的项目中吗？我认为这会给兼容性带来很多麻烦......

它与 API 8 兼容还是仅与 API 9 及更高版本兼容？

非常感谢，维塔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T05:25:27.240

我为 Android 创建了 VPlayer。并在 VPlayer 中使用了怯场。但我不建议您在 ffmpeg 中使用 libstagefright.cpp，因为它太麻烦且不可移植。

但是，如果你想构建它，你应该按照 ffmpeg 中的构建指令，或者你可以试试这个 configure [FFMpeg Android Stagefright SIGSEGV error (h264 decode)](https://stackoverflow.com/questions/9098167/ffmpeg-android-stagefright-sigsegv-error-h264-decode)

请务必替换一些指向您的环境的路径。

# c++ - 将 std::random_shuffle 与 std::array 一起使用

> ID：10438982
> 
> 赞同：-1
> 
> 时间：2012-05-03T20:38:54.980
> 
> 标签：c++, stl, c++11, std

我有这样的代码：

```
typedef intptr_t ptr_t;

const int num_elements = 100;
ptr_t *pstr = (ptr_t *)malloc(sizeof(ptr_t) * num_elements);
std::array<ptr_t,num_elements> *parray = new (pstr) std::array<ptr_t,num_elements>; 
```

我希望能够将元素 1 洗牌到 num_elements-2 ，所以我想使用 std::shuffle。

```
auto s = parray->begin()++;
auto e = parray->end()--;
std::random_shuffle ( s, e ); 
```

我抱怨说没有为此的重载功能。我无法看到自己做错了什么，我感到非常愚蠢。我该怎么做？

编辑：由于答案和反馈，它已更改为

```
auto s = parray->begin();
s++;
auto e = parray->end();
std::random_shuffle ( s, e ); 
```

但是，在“auto e”上，我得到：“auto”的间接级别与“int *”不同

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T20:44:08.183

回答您的直接问题：我相信您的错误是使用后增量运算符，它们在增量之前返回其原始值。由于`std::array`迭代器基本上是指针，请尝试

```
auto s = parray->begin() + 1;
auto e = parray->end() - 1; 
```

编辑：现在，至于其余的。你到底为什么要那样做？您是否考虑 `std::vector<int> arr(100)`过创建一个包含 100 个元素的动态数组？它具有类似的功能，而无需直接操作指针？

编辑2：阅读您的评论后，我意识到问题是您正在尝试对您作为指针给出的数组进行洗牌。在那种情况下，我根本不会做新的安置。假设您有指针 in `pstr`，这应该可以工作。

```
std::random_shuffle(pstr +1, pstr + num_elements - 1); 
```

这是可行的，因为数组中的简单指针将作为算法库的随机访问迭代器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T20:44:14.553

即使编译器允许，你的代码也不会做你想做的事。您正在尝试对从`begin()`/返回的值使用后递增/递减`end()`，因此您仍将原始值分配给`s`and `e`，然后（如果可能）递增/递减它们返回的临时值。您显然想要更改分配的值。

```
auto s= parray->begin();
auto e= parray->end();

++s;
--e;

std::random_shuffle(s, e); 
```

或者，因为你显然有随机访问迭代器：

```
 std::random_shuffle(parray->begin()+1, parray->end()-1); 
```

我不确定你为什么要动态分配一个`std::array`- 这似乎几乎违背了使用`std::array`开始的意义。

# php - php sorting multi arrays with multi priority

> ID：10438985
> 
> 赞同：1
> 
> 时间：2012-05-03T20:39:17.160
> 
> 标签：php, arrays, sorting

I have N number of arrays (eg. 3 arrays):

```
$arr1 = array(0 => array('id' => 34, 'score' => 440),
          1 => array('id' => 32, 'score' => 140),
          2 => array('id' => 22, 'score' => 121),
          3 => array('id' => 99, 'score' => 532)
    );

$arr2 = array(0 => array('id' => 32, 'score' => 213),
          1 => array('id' => 34, 'score' => 354),
          2 => array('id' => 22, 'score' => 674)
    );

$arr3 = array(0 => array('id' => 34, 'score' => 10),
          1 => array('id' => 22, 'score' => 449),
          2 => array('id' => 99, 'score' => 586),
          3 => array('id' => 32, 'score' => 113),
          4 => array('id' => 16, 'score' => 777)

    ); 
```

I want to sort these (N) arrays depending on (id) and (score) but i want to give the priority to the repetition id occurrence in all arrays and then the second priority to the max score, and the result will be (1) filtered unique array which holds unique ids according to these rules of sort.

I tried to do this using php `usort` function to pass comparison function but i failed to do the job.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T22:03:00.607

If the source of the data comes from a mysql database, this custom sort can be easily retrieved with a simple sql query.

But if we must work with the arrays directly then this should work too: (Sorry for dirty coding and poor mobility.)

```
$all_arrays = array_merge( $arr1, $arr2, $arr3 ); // merge all arrays into one
$items = $ascores = $scores = $occurs = $sorted_ids = array();
foreach( $all_arrays as $elem ) {
    if(isset($occurs[ $elem['id'] ])) { $occurs[ $elem['id'] ]++; } else { $occurs[ $elem['id'] ] = 1; }
    if( ! isset($ascores[ $elem['id'] ]) || $elem['score'] > max( $ascores[ $elem['id'] ] ) ) { 
        $ascores[ $elem['id'] ][] = $elem['score']; 
        $scores[ $elem['id'] ] = $elem['score']; 
    }
    $items[ $elem['id'] ] = array( 'id'=>$elem['id'], 'maxs'=>$scores[ $elem['id'] ], 'occs'=>$occurs[ $elem['id'] ] );
}

array_multisort( $occurs, SORT_DESC, $scores, SORT_DESC, $items);
/// print_r( $items ); // $items holds unique sorted data. outputs: Array ( [0] => Array ( [id] => 22 [maxs] => 674 [occs] => 3 ) [1] => Array ( [id] => 34 [maxs] => 440 [occs] => 3 ) [2] => Array ( [id] => 32 [maxs] => 213 [occs] => 3 ) [3] => Array ( [id] => 99 [maxs] => 586 [occs] => 2 ) [4] => Array ( [id] => 16 [maxs] => 777 [occs] => 1 ) )

foreach( $items as $item ) $sorted_ids[] = $item['id'];
/// print_r( $sorted_ids ); // $sorted_ids holds your desired ids list. outputs: Array ( [0] => 22 [1] => 34 [2] => 32 [3] => 99 [4] => 16 ) 
```

# instance - 什么是 NSObject 的实例

> ID：10438986
> 
> 赞同：3
> 
> 时间：2012-05-03T20:39:18.837
> 
> 标签：instance, nsobject, xcode3.2

我是新手，我想知道 NSObject 的实例是什么。我正在研究 Xcode 3.2，想知道实例是什么。我经常听到这个词并且对此感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T23:43:53.477

来自[Wikipedia on Objects in OOP](http://en.wikipedia.org/wiki/Object_%28computer_science%29)

> “面向对象编程”中的对象基本上是结合相关处理例程的数据结构。例如，文件是一个对象：一组数据和相关的读写例程。对象被认为是类的实例。通俗地说，文件是一个类，而文件是对象。一个类定义属性一次行为，通常用于多个实例化。在其他学科中，这种区分也称为属/种二分法。
> 
> ...
> 
> 在每个对象都是从一个**类**创建的语言中，一个对象被称为该类的一个**实例**。如果每个对象都有一个类型，那么具有相同类的两个对象将具有相同的数据类型。创建类的实例有时称为实例化类。

本质上[NSObject](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)是 Apple 开发中的基本对象类型。`classes`NSObject 定义了从它扩展而来的所有东西之间共享的所有东西：

> NSObject 是大多数 Objective-C 类层次结构的根类。通过 NSObject，对象继承了运行时系统的基本接口以及作为 Objective-C 对象的能力。

如果您正在为对象实例化的定义而苦恼，我建议您花一些时间来学习编程和 OOP 风格编程的基础知识。理解这个概念对于未来的成功至关重要，如果你在不学习基础知识的情况下继续下去，你会更加沮丧。

# python - 使用点符号和链接的 Python dict

> ID：10438990
> 
> 赞同：3
> 
> 时间：2012-05-03T20:39:36.997
> 
> 标签：python, dictionary, syntax

理想情况下，我的目标是`dict`在 Python 中扩展（或非常相似） a 并具有附加功能的类：

*   点符号能够设置和获取值
*   键值功能，例如`dict`（即 setitem、getitem）
*   可以链接点表示的操作

目标是，如果我有类似的事情`example = DotDict()`可以针对它执行以下操作，`example.configuration.first= 'first'`并且它将实例化适当的 DotDict 实例`example`，但真正痛苦的警告是，如果操作不是赋值，它应该简单地引发 a `KeyError`like a `dict`would do

这是我天真的组装的

```
class DotDict(dict):
    def __getattr__(self, key):
        """ Make attempts to lookup by nonexistent attributes also attempt key lookups. """
        import traceback
        import re
        s= ''.join(traceback.format_stack(sys._getframe(1),1))
        if re.match(r'  File.*\n.*[a-zA-Z]+\w*\.[a-zA-Z]+[a-zA-Z0-9_. ]*\s*=\s*[a-zA-Z0-9_.\'"]+',s):
            self[key] = DotDict()
            return self[key]

        return self[key]

    def __setattr__(self, key, value):
        if isinstance(value,dict):
            self[key] = DotDict(value)
        self[key] = value 
```

除了一些常见的边缘情况外，它都有效，我必须说我绝对讨厌这种方法，并且必须有更好的方法。查看堆栈并在最后一行运行正则表达式并不是实现此目的的好方法。

问题的核心是 Python 从左到右解释代码行，所以当它到达一个语句时，就像`a.b.c = 3`它的第一个操作是 a`getattr(a,b)`而不是 a`setattr`所以我无法轻易确定操作堆栈中的最后一个操作是否是一个赋值.

我想知道的是是否有一种好方法可以确定操作堆栈中的最后一个操作，或者至少它是否是`setattr`.

编辑：

这是我在 user1320237 的推荐下提出的解决方案。

```
class DotDict(dict):
    def __getattr__(self, key):
        """ Make attempts to lookup by nonexistent attributes also attempt key lookups. """
        if self.has_key(key):
            return self[key]
        import sys
        import dis
        frame = sys._getframe(1)
        if '\x00%c' % dis.opmap['STORE_ATTR'] in frame.f_code.co_code:
            self[key] = DotDict()
            return self[key]

        raise AttributeError('Problem here')

    def __setattr__(self, key, value):
        if isinstance(value,dict):
            self[key] = DotDict(value)
        self[key] = value 
```

在实际实现中还有一点点，但它做得很棒。它的工作方式是检查堆栈中的最后一帧并检查字节码是否有 STORE_ATTR 操作，这意味着正在执行的操作是有`a.b.this.doesnt.exist.yet = 'something'`说服力的。我很好奇这是否可以在 CPython 之外的其他解释器上完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:49:42.610

您可能需要为这些边缘情况覆盖**getattribute**，然后使用

```
object.__getattribute__ 
```

看看模块[dis](http://docs.python.org/library/dis.html)。但是你写的比拆机好。

```
>>> import dis
>>> def g():
    a.b.c = 4

>>> dis.dis(g)
  2           0 LOAD_CONST               1 (4)
              3 LOAD_GLOBAL              0 (a)
              6 LOAD_ATTR                1 (b)
              9 STORE_ATTR               2 (c)
             12 LOAD_CONST               0 (None)
             15 RETURN_VALUE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T21:15:53.133

根据user1320237的回答，这就是我得到的。它似乎做你想做的事。

```
class A(object):
    def __getattribute__(self, attr):
        try:
            return super(A, self).__getattribute__(attr)
        except AttributeError:
            self.__setattr__(attr, A())
            return super(A, self).__getattribute__(attr) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-21T07:22:24.820

这是另一个解决方案： http: [//tech.zarmory.com/2013/08/python-putting-dot-in-dict.html](http://tech.zarmory.com/2013/08/python-putting-dot-in-dict.html)

```
>>> d = DefaultDotDict({1: {2: 3}})
>>> d.a.b.c.d = "magic!"
>>> import json; print json.dumps(d, indent=2)
{
  "a": {
    "b": {
      "c": {
        "d": "magic!"
      }
    }
  }, 
  "1": {
    "2": 3
  }
}
>>> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T08:13:12.750

[这是使用包装器的替代解决方案。](https://stackoverflow.com/a/12187277/275491)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-16T06:17:47.297

class DotDict(dict):

```
"""Dot natation for dict"""

def __init__(self, theDict):
    super(MyDict, self).__init__()
    for key, item in theDict.items():
        if isinstance(item, dict):
            item = MyDict(item)
        self.__dict__[key] = item

def __getattr__(self, key):
    return self.__dict__[key]

def __setattr__(self, name, value):
    self.__dict__[name] = value 
```

# scons - scons、-u 和别名

> ID：10438991
> 
> 赞同：0
> 
> 时间：2012-05-03T20:39:41.653
> 
> 标签：scons, aliases

这是我正在试验的问题的最小重现步骤。

假设我有以下 SConscripts 和 SConstruct：

#/S构造：

```
SConscript( "SConscript", variant_dir="build" ) 
```

#/SConscript：

```
SConscript( "lib1/SConscript" )
SConscript( "lib2/SConscript" ) 
```

#/lib1/SConscript：

```
Alias( "lib", SharedLibrary( "lib1", "codeLib1.cpp" ) ) 
```

#/lib2/SConscript：

```
Alias( "lib", SharedLibrary( "lib2", "codeLib2.cpp" ) ) 
```

scons 手册指出，调用“scons -u”只会构建在当前目录下找到的指定目标。

这意味着调用

scons -u lib

在目录 #/lib1 中将在 lib1 及其所有依赖项下构建“lib”目标（在这种情况下是我的别名）。

据我了解，“scons -u lib”只有在当前文件夹下有一个名为 lib 的目标（在我们的例子中是别名）时才会构建“lib”目标。如果我要求目标“测试”，它本来存在于其他地方（假设在项目的根目录），它就不会被编译。

scons 使用的算法似乎是：

*   阅读所有 SConscript 并构建依赖树
*   查看命令行的请求目标（“lib”）是否存在于当前目录下（“-u”）
*   如果它不存在，不要做任何事情
*   如果是，则编译该目标的所有依赖项。

不幸的是，“lib”依赖于 lib1 和 lib2，并且 scons 继续编译它们。我希望由于 lib2 不在 lib1 之下，所以它不会被添加到构建中。

一种解决方案是让每个库都有自己的别名，并以 lib 为后缀，但这样系统使用起来会更加棘手。另一种方法是检查从何处创建别名（通过我自己替换环境中的 Alias 方法，该方法使用 Scons 的 call_stack 全局来了解我从哪个 SConscript 调用 Alias 并根据位置创建或不创建别​​名SConscript 的）并按原样返回新创建的别名或对象。

我宁愿不搞这个，所以我想知道我是否遗漏了什么。

感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:30:15.950

如果您希望使用 Alias() 函数对 lib1 和 lib2 进行不同的处理，那么您需要为它们中的每一个分配一个不同的别名，如下所示：

/lib1/SConscript：

```
Alias( "lib1", SharedLibrary( "lib1", "codeLib1.cpp" ) ) 
```

/lib2/SConscript：

```
Alias( "lib2", SharedLibrary( "lib2", "codeLib2.cpp" ) ) 
```

如果您为两个目标分配相同的别名，那么您将***两个***目标添加到相同的别名，并且在编译该别名目标时它们都将被编译/评估（考虑编译）。

如果您只想编译某个目录中的内容，您应该能够执行以下操作：

```
# cd lib1
# scons . 
```

或者您可以指定要编译的路径，假设您在项目根目录中：

```
# scons ./lib1 
```

# asp.net - 在 Firefox 中刷新页面后下拉列表显示错误的项目

> ID：10438993
> 
> 赞同：0
> 
> 时间：2012-05-03T20:39:49.100
> 
> 标签：asp.net, firefox, drop-down-menu, refresh

我在更新面板中有一个下拉列表

```
<asp:UpdatePanel ID="UpdatePanelTables" UpdateMode="Conditional" runat="server">
<ContentTemplate>
                <asp:DropDownList ID="DropDownListTournamnets" AutoPostBack="true"  OnSelectedIndexChanged="OnIndexChanged"
                    runat="server">
                    <asp:ListItem Value="1" Text="Something1"></asp:ListItem>
                    <asp:ListItem Value="2" Text="Something2"></asp:ListItem>
                </asp:DropDownList>
</ContentTemplate>
<asp:/UpdatePanel> 
```

当我选择某个项目时，下拉菜单会回发，并且更新面板中的内容会更改。当我刷新页面（使用 f5）时，加载的内容对应于 index=0 的项目，但下拉列表显示刷新之前的项目，如果我现在选择第一个项目回发不会发生。问题仅在 Firefox 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T23:05:25.100

如果您确实需要在 FF 上刷新时重置该下拉列表，请这样做：

```
<head>
<script type="text/javascript">
function resetddp(){
    var ddl=document.getElementById('DropDownListTournamnets');
    ddl.options[0].selected=true;
}
</script>
</head>

<body onload="resetddp();">
<!--The rest of your code here-->
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-05T06:28:52.623

```
$(document).ready(function ()
{
    $("#content_ProjectName option[value='1']").prop("selected", true);
}); 
```

显示下拉菜单的第一项 `ProjectName.ClearSelection();`
将此代码放在您的设计页面中以在所有浏览器上工作，并将其放在页面加载时的代码后面