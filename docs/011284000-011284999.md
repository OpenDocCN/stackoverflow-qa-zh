# StackOverflow 问答 11284000-11284999

# for-loop - 无法弄清楚为什么这会导致无限循环

> ID：11284002
> 
> 赞同：-2
> 
> 时间：2012-07-01T17:04:02.003
> 
> 标签：for-loop, while-loop, logic, infinite-loop

所以我有这行代码，它时不时地生成一个无限循环。我的逻辑在某处不正确吗？"if (randomNumbersForSelectionArray.Count > 0)" 中的 if 语句应该总是返回 true，但事实并非如此。然后，当我执行 else 语句并检查代码进入无限循环时是否应该为真时，它确认我的逻辑应该是正确的。我似乎无法弄清楚这是哪里出了问题。谢谢！！

* * *

***这是我得到的一些示例输出。***

12| 2 =应该= 2
为什么会这样坏掉！？！？！？
12| 2 =应该= 2
为什么会这样坏掉！？！？！？
*...无限*

* * *

整数计数循环 = 0；

if (trackFitnessRankArray.Length >= 1) {

```
 while (randomNumbersForSelectionArray.Count > 0)
            {
                countLoop++;

                for (int j = trackFitnessRankArray.Length - 1; j >= 0; j--)
                {
                    if (randomNumbersForSelectionArray.Count > 0)
                    {
                        if (randomNumbersForSelectionArray[0] >= (trackFitnessRankArray[j].CutoffPointForReproduction - trackFitnessRankArray[j].ChanceOfReproduction) && randomNumbersForSelectionArray[0] < trackFitnessRankArray[j].CutoffPointForReproduction)
                        {
                            //take the selected AIs and put them in an array
                            selectedToBreed.Add(trackFitnessRankArray[j]);

                            //remove the number from the randomNumber array
                            randomNumbersForSelectionArray.RemoveAt(0);
                        }
                        else
                        {
                            //if we're in an infinite loop
                            if (countLoop > AI_IN_EACH_GENERATION)
                            {
                                if (randomNumbersForSelectionArray[0] == trackFitnessRankArray[j].CutoffPointForReproduction)
                                {
                                    if (j != 0)
                                        Debug.WriteLine(j + "| " + randomNumbersForSelectionArray[0] + " =should= " + (trackFitnessRankArray[j - 1].CutoffPointForReproduction + trackFitnessRankArray[j - 1].ChanceOfReproduction));
                                    if (randomNumbersForSelectionArray[0] != (trackFitnessRankArray[j - 1].CutoffPointForReproduction + trackFitnessRankArray[j - 1].ChanceOfReproduction))
                                        Debug.WriteLine("Why is this breaking!?!?!?");
                                }
                            }
                        }
                    }
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T17:16:33.383

组件

```
//remove the number from the randomNumber array
                            randomNumbersForSelectionArray.RemoveAt(0); 
```

应该超出if

# bash - 为什么这个文件没有被复制到我的 $PATH 中？

> ID：11284003
> 
> 赞同：-1
> 
> 时间：2012-07-01T17:04:14.490
> 
> 标签：bash, macvim

我试图根据[这个问题](https://stackoverflow.com/questions/2056137/how-to-run-mvim-macvim-from-terminal)将 mvim shell 脚本添加到 /usr/local/bin 形式的 bash 中，一切似乎都正常；但是，每当我尝试执行脚本时，我仍然会收到“找不到命令”。

从我的 mvim 文件所在的目录（下载）中，我输入：

```
sudo cp -v mvim /usr/local/bin 
```

我得到输出：

```
mvim -> /usr/local/bin 
```

然后无论我输入`mvim`还是`mvim -v`

我以前从来没有在我的 $PATH 中添加过一些东西，但是即使在查阅了一些关于它是如何完成的教程之后，我似乎也无法`mvim`作为终端命令来工作。

**编辑：**

```
echo $PATH

/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin 
```

和

```
ls -l mvim

-rwxr-xr-x ... 
```

和

```
ls -l /usr/local/bin

-rwxr-xr-x ... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T17:08:04.583

### */usr/local/bin*是否存在？

如果运行`sudo cp -v mvim /usr/local/bin`后`/usr/local/bin`文件夹不存在，cp会复制`mvim`到`/usr/local/`文件夹并命名`bin`。

您需要先使用`sudo mkdir -p /usr/local/bin`. `mvim`然后，您可以使用前面的`cp`命令进行复制。

### mvim*可以*执行吗？

您是否确定设置`/usr/local/bin/mvim`了*可执行*标志？尝试`ls -l /usr/local/bin/mvim`如果结果以 开头`-rw-r--r--`，则*mvim*不可执行。

然后你需要运行`sudo chmod +x /usr/local/bin/mvim`. 如果您现在`ls`再次运行上一个命令，结果应该以`-rwxr-xr-x`. 这`x`意味着该文件现在*可*由其所有者、其组成员以及所有其他用户执行。

### */usr/local/bin*在你的*PATH*中吗？

你确定这`/usr/local/bin`是你的`PATH`变量的一部分吗？

尝试`echo $PATH`，如果输出不包含`/usr/local/bin`，那么 shell 将不会在那里查找命令。然后你需要运行`export PATH=$PATH:/usr/local/bin`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:07:09.700

查看：

1.  如果 /usr/local/bin/mvim 是可执行的（如果不是，添加 exec 位：chmod +x /usr/local/bin/mvim）
2.  如果 /usr/local/bin 在 $PATH ( `echo $PATH`)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T17:07:34.693

要么启动一个新的 shell，要么输入：

```
hash -r 
```

以便 shell 重新检查`$PATH`. （它缓存内容以提高效率，当您将内容添加到路径中的目录时，您需要重新加载该缓存。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T17:11:01.807

这是您发布的内容：

```
mvim -> /usr/local/bin 
```

我相信那是*错误*的。*看起来*“ mvim ”是一个指向*目录*/usr/local/bin的*符号链接。*

 *如果是这样，这*不是*你想要的！

请执行以下操作：

1.  打开终端（命令行）窗口。

2.  "cd" 到你原来的 "mvim" 目录（你试图复制到 /usr/localbin 的那个目录）

3.  剪切/粘贴：

    a) 目录名称

    b)`ls -l mvim`

    C）`echo $PATH`

“echo $PATH”也很重要。

请将所有三个剪切/粘贴到您的回复中。

先感谢您。*

# mysql - Sql 查询仅显示特定用户的最新消息？

> ID：11284012
> 
> 赞同：1
> 
> 时间：2012-07-01T17:05:24.123
> 
> 标签：mysql, sql, database

我有两个 sql 表，一个有用户，另一个有消息。现在我的查询是：

```
SELECT users.memberid,users.username,users.profileimage,users.gender,message.messagebody, message.fromid,message.toid,message.messageid 
FROM message,users 
WHERE message.fromid = users.memberid AND message.toid = '$id' AND recieverdeleted='0' 
ORDER BY datetime DESC LIMIT 55 
```

现在返回的是everymessage的所有信息，而不考虑formid（发件人的ID）问题是，我只想显示每个来自ID的最新消息..有点像Facebook如何只向您显示最新消息那个朋友 x 发给了你，而不是所有的消息。在用户点击他朋友的最新消息后，我将努力显示所有消息。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T11:22:48.913

嗯，你试过了。那挺好的。

```
 SELECT u.memberid
      , u.username
      , u.profileimage
      , u.gender
      , m.messagebody
      , m.fromid
      , m.toid
      , m.messageid 
   FROM users u
   JOIN message m
     ON m.fromid = u.memberid
   JOIN (SELECT fromid,toid,MAX(datetime) max_datetime FROM message GROUP BY fromid,toid) n
     ON n.fromid = m.fromid
    AND n.toid = m.toid
    AND n.max_datetime = m.datetime
  WHERE message.toid = $id 
    AND recieverdeleted = 0 
  ORDER 
     BY datetime DESC LIMIT 55; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:16:21.957

起初`join`这两个表比应用`order by`，因为此时命令不确定您要对哪个表应用排序。或者更好的是，您从两个表的选择中创建一个中间表，然后应用排序。就像是：

```
SELECT username,messagebody,fromid FROM(
SELECT users.memberid,users.username,users.profileimage,users.gender,message.messagebody, message.fromid,message.toid,message.messageid,message.datetime 
FROM message,users 
WHERE message.fromid = users.memberid AND message.toid = '$id' AND recieverdeleted='0' )INTERMEDIATE_TABLE ORDER BY datetime DESC 
```

我可能在语法上是错误的，因为我很久以前做过 sql 代码，但你应该尝试一些非常相似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T10:48:35.503

试试这个它的工作

```
SELECT m1.* 
  FROM table_name m1 
  INNER JOIN (SELECT MAX(senddate) AS senddate, 
                     IF(member_id2 = 3, member_id1, member_id2 ) AS user 
                FROM table_name 
               WHERE (member_id1 = 3 AND delete1=0) OR 
                     (member_id2 = 3 AND delete2=0) 
              GROUP BY user) m2 
         ON m1.senddate = m2.senddate AND 
           (m1.member_id1 = m2.user OR m1.member_id2 = m2.user) 
     WHERE (member_id1 = 3 AND delete1=0) OR 
           (member_id2 = 3 AND delete2=0) 
   ORDER BY m1.senddate DESC 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-01T17:21:49.903

尝试这个：：

```
 SELECT users.memberid,users.username,users.profileimage,users.gender,message.messagebody, message.fromid,message.toid,message.messageid 

FROM message inner join users on (message.fromid = users.memberid)
where  message.toid = '$id' AND recieverdeleted='0' 
ORDER BY message_datetime DESC limit 1 
```

# sql - In 和 Exists 的性能比较

> ID：11284039
> 
> 赞同：0
> 
> 时间：2012-07-01T17:08:38.943
> 
> 标签：sql

我想知道以下哪一项 - **Exists**或**In**更快，以及为什么。我已经做了很多谷歌搜索，共识看起来当外部查询有一个大数据集并且内部查询返回一个小的数据集时， **In更有效，而****Exists**在相反的情况下更快。事实上，[Oracle Tips](http://www.techrepublic.com/article/oracle-tip-understand-the-difference-between-in-and-exists-in-subqueries/5297080)链接上的文章说这是因为在**Exists**的情况下，首先运行外部查询，而在**In**的情况下，首先运行内部查询。如果是这样，谁能解释为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T08:43:47.567

在 Oracle 文档中，您对如何[生成和使用执行计划](http://docs.oracle.com/cd/B28359_01/server.111/b28274/optplanmgmt.htm)有深入的解释。此外[，](http://www.dba-oracle.com/oracle11g/oracle11g_sql_plan_management.htm)您还有更多信息，最后还有更多链接来指导您完成任务。但最终一切都将只花费几个小时进行自己的研究、执行查询和比较时间、执行计划和其他已知的性能问题。

# php - 带有 for 循环错误的卷曲

> ID：11284040
> 
> 赞同：0
> 
> 时间：2012-07-01T17:08:40.160
> 
> 标签：php, loops, curl

脚本在没有实现 for 循环的情况下运行，但是当我放置一个 for 循环时它会失败。

工作脚本：

```
$dob=new DateTime('28-12-83');
$regno='1984';
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://domain.com/login.php');
curl_setopt ($ch, CURLOPT_POST, 1);
curl_setopt ($ch, CURLOPT_POSTFIELDS, 'op=&sub=3&txtregno='.$regno.'&txtrollno=&txtpass=&txtdob='. $dob->format('d-m-y'));
curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
$store = curl_exec ($ch);
curl_setopt($ch, CURLOPT_URL, 'http://domain.com/results.php');
curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
$fp = fopen('mm.htm', 'w');
curl_setopt ($ch, CURLOPT_FILE, $fp);
$store = curl_exec ($ch);
fclose($fp);
curl_close ($ch); 
```

上面的脚本运行良好并生成一个带有输出的 mm.htm 文件。

for循环后脚本不正确

```
$dob=new DateTime('27-12-83');
$regno='1984';
for($i=1; $i<=3; $i++)
{
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'domain.com/login.php');
    curl_setopt ($ch, CURLOPT_POST, 1);
    curl_setopt ($ch, CURLOPT_POSTFIELDS, 'op=&sub=3&txtregno='.$regno.'&txtrollno=&txtpass=&txtdob='. $dob->format('d-m-y'));
    curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    $store = curl_exec ($ch);
    curl_setopt($ch, CURLOPT_URL, 'domain.com/results.php');
    curl_setopt ($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
    $fp = fopen($regno."_".$i.'.htm', 'w');
    curl_setopt ($ch, CURLOPT_FILE, $fp);
    $store = curl_exec ($ch);
    fclose($fp);
    $dob->modify('+1 day');
    set_time_limit(0);
    curl_close ($ch);
} 
```

上面的脚本生成 3 个 htm 文件，但没有任何输出。这意味着这个脚本在某个地方失败了，但我没有找到问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T22:14:22.737

如果您想将接收到的内容存储在您使用 CURLOPT_FILE 指定的文件中，那么您当然不应该也使用 CURLOPT_RETURNTRANSFER 来要求它返回吗？或者我应该问你为什么这样做？

# scala - Scala模式匹配变量绑定

> ID：11284048
> 
> 赞同：1
> 
> 时间：2012-07-01T17:10:15.493
> 
> 标签：scala, extractor

为什么提取器返回时我不能以@样式绑定变量`Option[<Type>]`？即这个不起作用：

```
object IsUpperCase {
  def unapply(s: String): Option[String] = {
    if (s.toUpperCase() == s) {
      Some(s)
    } else {
      None
    }
  }
}

val s = "DuDu@qwadasd.ru"
s match {
  case u @ IsUpperCase() => println("gotcha!") // what? "wrong number of arguments for object IsUpperCase"?
  case _ => 
} 
```

但这一个有效！

```
val s = "DuDu@qwadasd.ru"
s match {
  case IsUpperCase(u) => println("gotcha!")
  case _ => 
} 
```

另一方面，如果`IsUpperCase`看起来像这样：

```
object IsUpperCase {
  def unapply(s: String): Boolean = {
    return s.toUpperCase() == s
  }
} 
```

然后第一个示例有效，而第二个示例无效！为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-01T17:49:19.057

> 什么？“对象 IsUpperCase 的参数数量错误”？

```
case u @ IsUpperCase() => println("gotcha!") 
```

嗯，是。`unapply`is的返回类型`Option[String]`，表示 的模式匹配`IsUpperCase` *必须*接受一个参数，像这样：

```
case u @ IsUpperCase(_) => println("gotcha!") // I don't care about the parameter 
```

适合第一个模式的`unapply`定义是这样的：

```
object IsUpperCase {
  def unapply(s: String): Boolean = s.toUpperCase() == s
} 
```

这可用于对`IsUpperCase()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-01T17:33:49.590

因为对于第一个示例，您需要编写类似`case u @ IsUpperCase(v) =>`or`case u @ IsUpperCase(_) =>`的内容，这意味着“匹配`IsUpperCase(v)`并且如果成功将*原始*字符串绑定到`u`”。

# ios - 如何在不缓慢加载的情况下将按钮中的图像添加到表格中

> ID：11284049
> 
> 赞同：0
> 
> 时间：2012-07-01T17:10:20.883
> 
> 标签：ios, objective-c, iphone, xcode, uitableview

我有两种将图像添加到表格的方法，哪种方法最有效，还有更好的方法吗？两种方式都放置在带有“图层对象”的按钮顶部。

另外我注意到表格在模拟器中滚动缓慢，这种缓慢滚动可能发生在真手机上吗？我看到原因的唯一原因可能是因为我没有关联按钮，但它可能与记忆有关，或者在每个单元格中绘图。我不能是因为图像来自 URL 对吗？

以下是我将每个按钮添加到表格单元格的两种方法：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];

[button setTitle:@"image.png" forState:UIControlStateNormal];

[[button titleLabel] setFont:[UIFont fontWithName:@"Helvetica-Bold" size:13]];

[button setTitleColor:[UIColor clearColor] forState:UIControlStateNormal];

[button setBackgroundColor:[UIColor blackColor]];

UIImage *btn = [UIImage imageWithData:"png image from url"];

UIImage* newImage2 = [btn scaleToSize:CGSizeMake(280, 209.0)];

CGSize newSize = CGSizeMake(280, 209.0);

UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0);

[newImage2 drawInRect:CGRectMake(0, 0, (newSize.width), (newSize.height))];

UIImage *newImage4 = UIGraphicsGetImageFromCurrentImageContext();   

UIGraphicsEndImageContext();

[button setImage:newImage4 forState:UIControlStateNormal];

button.frame = CGRectMake(20.0, 50.0, 280, 255.0); 
```

/////////////////////////////////// 第二种方式：

```
UIButton *button2 = [UIButton buttonWithType:UIButtonTypeCustom];

[button2 setTitle:@"photo.png" forState:UIControlStateNormal];

[[button2 titleLabel] setFont:[UIFont fontWithName:@"Helvetica-Bold" size:13]];

[button2 setTitleColor:[UIColor clearColor] forState:UIControlStateNormal];

[button2 setBackgroundColor:[UIColor blackColor]];

UIImage *btnImage = [UIImage imageWithData:"png image from url"];

UIImageView *imageView2 = [[UIImageView alloc] initWithImage:btnImage];

imageView2.frame = CGRectMake(0, 0, 280, 209);

button2.frame = CGRectMake(20.0, 50.0, 280, 255.0);

[button2 addSubview:imageView2]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:20:41.130

这里您的一些图像来自远程服务器。您应该使用[延迟加载](http://developer.apple.com/library/ios/#samplecode/LazyTableImages/Introduction/Intro.html)从远程服务器加载图像。它将异步下载图像并根据需要加载图像。您还可以使用[SDWebImage](https://github.com/rs/SDWebImage)库来执行此操作并且还具有缓存机制。使用这个库非常简单直接。像：

```
 [cell.imageView sd_setImageWithURL:[NSURL URLWithString:@"http://www.domain.com/path/to/image.jpg"]
                      placeholderImage:[UIImage imageNamed:@"placeholder.png"]]; 
```

# opengl - OpenGL顶点缓冲区不会在golang中绘制任何东西

> ID：11284055
> 
> 赞同：4
> 
> 时间：2012-07-01T17:11:35.380
> 
> 标签：opengl, go

我尝试将本教程与 Golang 一起使用：[http](http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/) ://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/ go-version 打开窗口并使背景变为蓝色，但它不显示三角形。c版本确实显示了它。这是 Go 中的代码：

```
err := glfw.Init()
if err != nil {
    log.Fatal("Failed to init GLFW: " + err.Error())
}

err = glfw.OpenWindow(1024, 768, 0,0,0,0, 32,0, glfw.Windowed)
if err != nil {
    log.Fatal("Failed to open GLFW window: " + err.Error())
}

if gl.Init() != 0 {
    log.Fatal("Failed to init GL")
}

gl.ClearColor(0.0, 0.0, 0.3, 0.0)

// create vertexbuffer
gVertexBufferData := []float32{-1.0,-1.0,0.0, 1.0,-1.0,0.0, 0.0,1.0,0.0}
vertexBuffer := gl.GenBuffer()
vertexBuffer.Bind(gl.ARRAY_BUFFER)
gl.BufferData(gl.ARRAY_BUFFER, len(gVertexBufferData), gVertexBufferData, gl.STATIC_DRAW)

for {
    // clear screen
    gl.Clear(gl.COLOR_BUFFER_BIT)

    // first attribute buffer: vertices
    var vertexAttrib gl.AttribLocation = 0
    vertexAttrib.EnableArray()
    vertexBuffer.Bind(gl.ARRAY_BUFFER)
    var f float32 = 0.0
    vertexAttrib.AttribPointer(
        3,     // size
        false, // normalized?
        0,     // stride
        &f) // array buffer offset

    // draw the triangle
    gl.DrawArrays(gl.TRIANGLES, 0, 3)

    vertexAttrib.DisableArray()

    glfw.SwapBuffers()
} 
```

这是c中有效的代码：

```
if(!glfwInit())
    return -1;

if(!glfwOpenWindow( 1024, 768, 0,0,0,0, 32,0, GLFW_WINDOW ))
    return -1;

if(glewInit() != GLEW_OK)
    return -1;

glClearColor(0.0f, 0.0f, 0.3f, 0.0f);

GLuint VertexArrayID;
glGenVertexArrays(1, &VertexArrayID);
glBindVertexArray(VertexArrayID);

static const GLfloat g_vertex_buffer_data[] = { 
    -1.0f, -1.0f, 0.0f,
    1.0f, -1.0f, 0.0f,
    0.0f,  1.0f, 0.0f,
};
GLuint vertexbuffer;
glGenBuffers(1, &vertexbuffer);
glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);

while(1) {
    glClear( GL_COLOR_BUFFER_BIT );

    // 1rst attribute buffer : vertices
    glEnableVertexAttribArray(0);
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
    glVertexAttribPointer(
        0,
        3, // size
        GL_FLOAT, // type
        GL_FALSE, // normalized?
        0, // stride
        (void*)0 // array buffer offset
    );

    // Draw the triangle !
    glDrawArrays(GL_TRIANGLES, 0, 3); // From index 0 to 3 -> 1 triangle

    glDisableVertexAttribArray(0);

    // Swap buffers
    glfwSwapBuffers();
} 
```

也许我给了 vertexAttrib.AttribPointer() 错误的参数，因为我不确定要给它什么而不是 (void*)0。我尝试了 nil，但这导致应用程序崩溃。&gVertexBufferData[0] 也不起作用。

我使用 github.com/banthar/gl 作为 glew-wrapper，转到 1.0.2 和 ubuntu 12.04 amd64。

编辑更新：

glGetError 没有给出任何错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T14:44:17.433

我遇到了同样的问题，看了你的帖子后我设法解决了，所以首先非常感谢。

我设法通过调用banthar绑定的工作分支来显示一个三角形`AttribPointer`：

```
vertexAttrib.AttribPointer(
        3,     // size
        gl.FLOAT, //type
        false, // normalized?
        0,     // stride
        nil) // array buffer offset 
```

并将字节大小传递给 BufferData。

```
[...]
data := []float32{0, 1, 0, -1, -1, 0, 1, -1, 0}
[...]
gl.BufferData(gl.ARRAY_BUFFER, len(data)*4, data, gl.STATIC_DRAW)
[...] 
```

可能有更好的方法来传递正确的长度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-29T07:35:54.687

我最近遇到了与 Golang OpenGL 绑定类似的问题，这个问题是我能找到的唯一参考资料之一。但是，现有的答案都没有解决我的问题，因为现在 2015 年的绑定似乎与 2012 年的情况略有不同。

现有答案尚未涵盖的我的问题的解决方案涉及创建 VBO 时调用的 gl.BufferData() 函数。

有问题的代码产生问题的示例如下所示：

```
[...]
vertices := []float32{0, 1, 0, -1, -1, 0, 1, -1, 0}
[...]
gl.BufferData(
    gl.ARRAY_BUFFER,
    len(vertices)*4,
    unsafe.Pointer(&vertices),
    gl.STATIC_DRAW)
[...] 
```

已经提供的一种解决方案建议将此代码更改为以下内容：

```
[...]
vertices := []float32{0, 1, 0, -1, -1, 0, 1, -1, 0}
[...]
gl.BufferData(
    gl.ARRAY_BUFFER,
    len(vertices)*4,
    vertices,
    gl.STATIC_DRAW)
[...] 
```

但是，我使用的绑定与此处使用的绑定具有不同的函数签名，并且出现以下错误：

```
cannot use vertices (type []float32) as type unsafe.Pointer in argument to gl.BufferData 
```

我最终找到的解决方案，并想放在这里，这样其他人就不应该经历试图找出问题所带来的头痛，看起来像这样：

```
[...]
vertices := []float32{0, 1, 0, -1, -1, 0, 1, -1, 0}
[...]
gl.BufferData(
    gl.ARRAY_BUFFER,
    len(vertices)*4, //len(vertices)*int(reflect.TypeOf(vertices).Elem().Size()),
    gl.Ptr(vertices),
    gl.STATIC_DRAW)
[...] 
```

我还包括一个注释掉的选项来替换 len(vertices)*4 ，它产生完全相同的结果，但根据切片的类型（在本例中为 float32）找到“4”

**脚注**

我使用的绑定：
github.com/go-gl/gl/all-core/gl
github.com/go-gl/glfw/v3.1/glfw

我的 OpenGL 上下文是使用以下提示创建的：primaryMonitor := glfw.GetPrimaryMonitor() vidMode := primaryMonitor.GetVideoMode()

```
glfw.WindowHint(glfw.ContextVersionMajor, 3)
glfw.WindowHint(glfw.ContextVersionMinor, 3)
glfw.WindowHint(glfw.OpenGLProfile, glfw.OpenGLCoreProfile)
glfw.WindowHint(glfw.OpenGLForwardCompatible, glfw.True)

glfw.WindowHint(glfw.RedBits, vidMode.RedBits)
glfw.WindowHint(glfw.GreenBits, vidMode.GreenBits)
glfw.WindowHint(glfw.BlueBits, vidMode.BlueBits)
glfw.WindowHint(glfw.RefreshRate, vidMode.RefreshRate)
glfw.WindowHint(glfw.Visible, glfw.False) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T00:30:08.760

我遇到了同样的问题，最终由于某种原因调用 glfw.OpenWindowHint 搞砸了。它会请求正确的上下文，我的 opengl 版本会匹配，我根本不会收到任何错误，但它不起作用。如果我忽略了提示，我会得到一个 4.3 的上下文，并且一切似乎都正常。

即使我在提示中请求 4.3，它也不起作用。如果我请求其他内容，我的 opengl 字符串匹配，但它再次不起作用。

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T17:41:07.820

我不知道 OpenGL 绑定到 Go 的确切外观，但我至少可以告诉你这么多：

最后一个参数`glVertexAttribPointer`应该是从缓冲区对象开始的字节偏移量，所以（在你的情况下）0。

> 注意：该参数的 C 类型通常应该是`int`，因为它是一个字节偏移量。相反，这是`void*`出于遗留原因——它在 VBO 之前曾经有不同的含义。

而不是`&f`尝试传递一个文字 0，或者，如果这不起作用，则传递一个值等于 0 的指针。如何在 Go 中做到这一点？这是让你弄清楚的，因为我不了解 Go。我告诉过你 OpenGL 的期望，我希望这对你有很大帮助。

* * *

另外：对于调试，请`glGetError()`经常检查。

# c++ - 重载的返回值<<

> ID：11284056
> 
> 赞同：3
> 
> 时间：2012-07-01T17:11:49.870
> 
> 标签：c++

```
#include <iostream>

using namespace std;

struct info {
    info(int x, int y) : x(x), y(y) {}
    int x;
    int y;
};

ostream& operator<<(ostream& out, const info &myinfo){
    out << myinfo.x << "  " << myinfo.y;
    return cout;
}

int main() {
    info a(1,2);
    info b(3,4);
    cout << a << " " << b << endl;
} 
```

上述程序的输出似乎很好，即使`operator <<`.

谁能告诉我这个超载问题的影响是什么？我知道重载函数应该返回`out`而不是返回`cout`，但是上述版本的行为如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T17:14:44.330

在这种情况下，由于您传入`std::cout`了重载`operator<<`，因此行为没有区别。不过，一般来说，你会导致`" " << b << std::endl`被发送到`std:cout`，而你`a`会去你传入的任何内容。

例如：

```
info a(1,2);
info b(3,4);
std::ostringstream ss;
ss << a << " " << b << std::endl; 
```

会导致`a`去`ss`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:13:56.717

显然，它会在这种情况下工作，因为目标流是`cout`. 它会在其他情况下中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T17:15:16.253

它*恰好*在这里工作，因为`out`and`cout`指的是同一个对象。

# c++ - 在 lambda 表达式中调用方法

> ID：11284059
> 
> 赞同：22
> 
> 时间：2012-07-01T17:12:19.573
> 
> 标签：c++, lambda, c++11

我想在 lambda 表达式中调用我的类的方法：

```
void my_class::my_method(my_obj& obj)
{
}

void my_class::test_lambda()
{ 
   std::list<my_obj> my_list;

   std::for_each(my_list.begin(), my_list.end(), [](my_obj& obj)
   {
      // Here I want to call my_method:
      // my_method(obj);
   });
} 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-01T17:16:57.063

您需要`this`显式或隐式地捕获：

```
std::for_each(l.begin(), l.end(),
    [this](my_obj& o){ // or [=] or [&]
      my_method(o); // can be called as if the lambda was a member
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:16:03.927

您不能在没有对象的情况下调用非静态方法来调用它。

创建一个`my_class`对象并在 lambda 中捕获对它的引用...

```
my_class x;

std::for_each(my_list.begin(), my_list.end(), [&x](my_obj& obj)
//                                            ^^^^
{
    // Here I want to call my_method:
    x.my_method(obj);
}); 
```

或者，如果您的意思是 lambda 在`my_class`then capture的方法中`this`。或者，如果它是一个静态方法，那么您可以`my_class::my_method(obj)`在不捕获任何内容的情况下调用，如下面的 bames53 所述。

# c# - 以编程方式将 Excel 电子表格中的数字字符串转换为实际数字

> ID：11284064
> 
> 赞同：2
> 
> 时间：2012-07-01T17:13:04.367
> 
> 标签：c#, export-to-excel, excel-2010

我有一些 C# 代码以编程方式循环遍历电子表格中的所有单元格，并将任何数字字符串值转换为实际数字。它似乎有效，但运行速度相当慢（在 40 列 x 3000 行的电子表格上，运行需要一分钟多的时间）：

```
private void SetNumberStringsToValues(Excel.Range range)
  {
     object[,] values = range.get_Value(Excel.XlRangeValueDataType.xlRangeValueDefault);

     Parallel.For(1, range.Columns.Count, i =>
     {
        for (var j = 1; j < range.Rows.Count; j++)
        {
           var doubleValue = 0.0;
           if (double.TryParse(values[j, i].ToString(), out doubleValue))
              values[j, i] = doubleValue;
        }
     });
     range.set_Value(Excel.XlRangeValueDataType.xlRangeValueDefault, values);
  } 
```

有谁知道这样做更有效的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:21:43.857

尝试缓存行数，而不是在循环内调用 range.Rows.Count。当从多个线程访问时，实例中可能存在一些内部同步，这些内部同步`range`将受到争用。

另外，我很好奇你为什么从 1 而不是 0 开始枚举？那不会错过第一行和第一列吗？

```
...

var columns = range.Columns.Count;
var rows = range.Rows.Count;

Parallel.For(1, columns + 1, i => 
{ 
   for (var j = 1; j <= rows; j++) 
   { 
      var doubleValue = 0.0; 
      if (double.TryParse(values[j, i].ToString(), out doubleValue)) 
         values[j, i] = doubleValue; 
   } 
});

... 
```

# javascript - 这两个小型 JavaScript 类的最佳 OOP 方法

> ID：11284066
> 
> 赞同：1
> 
> 时间：2012-07-01T17:13:46.523
> 
> 标签：javascript, oop, design-patterns

我开始在一个相当大的 JS 项目上进行一些工作，并希望确保我干净有效地构建代码。我一直在阅读大量关于 JS 中 OOP 的不同方法，但还没有找到我真正喜欢的方法。

我很欣赏使用该`prototype`属性提供的性能改进，但是当您尝试将真正的私有方法和变量添加到混合中时，它会变得相当混乱。另一方面，我真的很喜欢这种`closure`方法，但我对性能下降感到不舒服。我查看了该`module`模式，但发现它非常冗长。某处有快乐的媒介吗？

为了说明我正在努力解决的问题，这里有两个非常小的示例类：

**积分等级：**

```
function Point(x, y) {
  this.x = x;
  this.y = y;
}

// Get the x coordinate.
Point.prototype.getX = function() {
  return this.x;
}

// Get the y coordinate.
Point.prototype.getY = function() {
  return this.y;
}

// Get the (x, y) coordinate.
Point.prototype.getXY = function() {
  return {x: this.x, y: this.y};
}

// Set the x coordinate.
Point.prototype.setX = function(x) {
  this.x = x;
}

// Set the y coordinate.
Point.prototype.setY = function(y) {
  this.y = y;
}

// Set the (x, y) coordinate.
Point.prototype.setXY = function(x, y) {
  this.x = x;
  this.y = y;
} 
```

**用户等级：**

```
function User(guid) {
  var guid = guid;

  // Return the user's GUID.
  this.getGuid = function() {
    return guid;    
  }
} 
```

在任何给定时间都可能有数千个点对象在使用中，所以我觉得这种`prototype`方法是那里的最佳选择。但是，如果我想在坐标设置中添加任何验证，只需调用`Point.x = <value>`. 同样，我可能会`Point.getXY()`在大部分时间调用，这将为本质上是公共属性的内容构建新对象。我应该摆脱`Point`类的 getter 和 setter 的概念，让它创建完全开放的公共对象吗？这在 OOP 的上下文中似乎是错误的。

对于`User`该类，我想在内部存储一个 GUID，以便可以请求但从不修改它。这不能用这种`prototype`方法来完成（除非我遗漏了什么），所以我被迫使用某种`closure`. 我预计有数百名用户同时处于活动状态，因此性能并不像在`Point`课堂上那么重要。但是，我真的不想在整个代码库中切换不同类型的 OOP 样式。

所以，作为一个普遍的问题，在 JS 中是否有一种我缺少的 OOP 方法可以让我`prototype`在干净地将选择函数和变量私有化的同时使用该属性？或者，我看错了方向？我应该以不同的方式处理这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:17:39.507

您只能使用文档和约定（如`_`前缀）将方法标记为“内部”，但 javascript 中没有真正的、强制的对象私有成员。

闭包是不可接受的——它们将拥有数据而不是可能产生“有趣”结果的对象，尤其是当人们想以这种方式使用闭包扩展“类”时。另一点是，您将使用 O(n) 内存来存储所有函数对象，如果库的用户无法控制，他们可以很容易地以一种会导致内存问题。

您可以像这样使用下划线前缀约定：

```
function Point(x, y) {
  this._x = x;
  this._y = y;
}

// Get the x coordinate.
Point.prototype.getX = function() {
  return this._x;
}

// Get the y coordinate.
Point.prototype.getY = function() {
  return this._y;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:17:32.193

我不知道你的背景，但可能是的，所以看看[咖啡脚本](http://coffeescript.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T17:35:02.660

由于基于原型的面向对象并不是真正的面向对象，我认为您可能找错了地方。

基于原型的对象是它们子类的克隆。因此，如果您声明您的对象具有属性 getXY() ，那么它对任何从中克隆的东西都是开放的。

所以我想真正的问题是，你认为私有函数在这个实现中会给你带来什么？

如果你真的需要私有函数，我鼓励你处理你必须在闭包模式中处理的混乱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T20:59:02.593

您可以在开发过程中使用闭包方法，这样您就知道没有人绕过验证，然后在发布代码时切换到更快的原型方法。

```
var Release = true;
if (Release) {
    function Point(x, y) {
        this.x = x;
        this.y = y;
    }

    // Get the x coordinate.
    Point.prototype.getX = function () {
        return this.x;
    }

    // Get the y coordinate.
    Point.prototype.getY = function () {
        return this.y;
    }

    // Get the (x, y) coordinate.
    Point.prototype.getXY = function () {
        return {
            x: this.x,
            y: this.y
        };
    }

    // Set the x coordinate.
    Point.prototype.setX = function (x) {
        this.x = x;
    }

    // Set the y coordinate.
    Point.prototype.setY = function (y) {
        this.y = y;
    }

    // Set the (x, y) coordinate.
    Point.prototype.setXY = function (x, y) {
        this.x = x;
        this.y = y;
    }
} else {
    function Point(x, y) {
        var _x = x,
            _y = y;
        return {
            // Get the x coordinate.
            getX: function () {
                return _x;
            },

            // Get the y coordinate.
            getY: function () {
                return _y;
            },

            // Get the (x, y) coordinate.
            getXY: function () {
                return {
                    x: _x,
                    y: _y
                };
            },

            // Set the x coordinate.
            setX: function (x) {
                _x = x;
            },

            // Set the y coordinate.
            setY: function (y) {
                _y = y;
            },

            // Set the (x, y) coordinate.
            setXY: function (x, y) {
                _x = x;
                _y = y;
            }
        }
    }
} 
```

# php - 在 localhost 子文件夹中加载 .js 文件的路径不起作用，仅在基本路径中

> ID：11284070
> 
> 赞同：0
> 
> 时间：2012-07-01T17:14:12.220
> 
> 标签：php, javascript, html, subdirectory, base-path

只是在这里度过了一段艰难的时光，希望它真的能解决......它是这样的：

在尝试在脚本中包含 jQUery 时，它只会在文件位于基本目录中时加载它（使用 localhost，我的文件名为 jquery.js）：

```
<script type="text/javascript" src="jquery.js" ></script> 
```

但是当我尝试使用放在子文件夹中的同一个文件时，说“js/jquery.js”，那么无论我使用多少不同的名称变体，它都不会识别它：

```
<script type="text/javascript" src="/js/jquery.js" ></script>
<script type="text/javascript" src="js/jquery.js" ></script>
<script type="text/javascript" src="http://localhost/js/jquery.js" ></script>
<script type="text/javascript" src="http://localhost/js/jquery.js" ></script> 
```

此外，我尝试使用 "echo $_SERVER['DOCUMENT_ROOT']."";" 获取基本目录 逐个字母添加完整路径无济于事。我得到的结果是'/var/www'，尝试了这些行但没有工作：

```
<script type="text/javascript" src="var/www/js/jquery.js" ></script>
<script type="text/javascript" src="/var/www/js/jquery.js" ></script> 
```

这里会发生什么？奇怪的是图像加载没有问题，因为

例子：`scr="IMG/imagie.gif"`

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T17:44:51.267

在我看来，您正在使用 .htaccess 文件或其他一些机制来破坏包含目录的 URL。您使用的是 CodeIgniter 之类的框架吗？您在文件系统的基本目录中是否有一个 .htaccess 文件（如果有，您必须执行 ls -a 才能看到它）？您是否有权访问该虚拟主机的 Apache 配置文件？

**编辑：** 用户确定根本原因是文件夹权限问题。

# perl - OOP Perl 将 @_ 传递给第二种方法

> ID：11284077
> 
> 赞同：0
> 
> 时间：2012-07-01T17:14:51.687
> 
> 标签：perl, oop, inheritance, object

```
#! /usr/bin/perl

# this is the object tester

{package Hate;
sub status {
my $class = shift;
print "-- $_[0] $_[1] $_[2]\n";
print "$class exists and ", $class->stats($_[0]), "and ", $class->type($_[1]), "and ",     $class->location($_[2]);
}
}

{package Grudge;
@ISA = "Hate";
sub stats{"$_[0]\n"}
sub type{"$_[0]\n"}
sub location{"$_[0]\n"}
}

Hate::status("Grudge", @ARGV); 
```

我跑了 ./program 一二三

这个输出是我预期的怨恨存在，一二三

这就是我得到的怨恨存在和怨恨和怨恨和怨恨

但是当我使用这个脚本时

```
#! /usr/bin/perl

# this is the object tester

{package Hate;
sub status {
my $class = shift;
print "-- $_[0] $_[1] $_[2]\n";
print "$class exists and ", $class->stats($_[0]), "and ", $class->type($_[1]), "and ",     $class->location($_[2]);
}
}

{package Grudge;
@ISA = "Hate";
sub stats{"$_[1]\n"}
sub type{"$_[1]\n"}
sub location{"$_[1]\n"}
}

Hate::status("Grudge", @ARGV); 
```

这行得通。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:37:13.663

在您的第一个示例中，`$class->stats($_[0])`作为**方法**调用并作为第一个参数传递一个对象，需要像在`Hate::status`. 这就是`$_[1]`有效的原因：因为该方法的第一个参数实际上是`@_`(after `$self`) 中的第二项。

`@_`如果您在函数的开头解包参数，事情会变得更加清晰和易于管理，例如

```
{
    package Hate;
    sub status {
        my ($class, $stats, $type, $location) = @_;
        print "-- $stats $type $location\n";
        print "$class exists and ", $class->stats($stats), ...;
    }
}

{
    package Grudge;
    our @ISA = qw(Hate);
    sub stats { my ($self, $stats) = @_; $stats; }
    sub type { my ($self, $type) = @_; $type; }
    sub location { my ($self, $location) = @_; $location; }
}

Hate::status('Grudge', @ARGV); 
```

附带说明一下，您对对象的使用并不典型——如果您提供更多代码，我们也许能够提供更惯用的 Perl 解决方案。例如，您的所有对象都没有构造函数，而目前这三个 Grudge 方法似乎在做同样的事情。也不清楚为什么`Grudge`是`Hate`（如 所示`@ISA`）的子类。

如果您真的不想`Grudge`将其自己的名称作为参数传递，您可以将其方法作为函数调用，`&{$class . '::stats'}()`但您必须禁用`strict subs`. 通常最好像现在这样调用方法。

# mysql - mysql - 在同一查询中选择组和用户

> ID：11284079
> 
> 赞同：0
> 
> 时间：2012-07-01T17:14:54.160
> 
> 标签：mysql, sql

我有以下两个表'USERS'和'GROUPS'：

```
USERS 
-id
-name
-groupid

GROUP 
-id
-name 
```

我想返回所有用户以及他们的组名和组 ID。它应该是组 id 字段的外部连接，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:23:49.383

一个简单的 INNER JOIN 就足够了：

```
SELECT `USERS`.*, `GROUP`.name AS group_name
FROM `USERS`, `GROUP`
WHERE `USERS`.groupid = `GROUP`.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:25:28.780

你会想看看`JOIN`声明

用我的手机做这个，所以请原谅任何适度不正确的语法，但有些东西很长

编辑：其他人的语法更好。这里为时过早

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T20:08:38.240

您可以使用`LEFT JOIN`between `users`and`groups`以便不在组中的用户仍然显示在结果集中，但组名和 id 为 NULL：

```
SELECT 
    a.*,
    b.name AS group_name
FROM
    users a
LEFT JOIN
    `group` b ON a.group_id = b.id 
```

旁注：确保将表名包含`group`在反引号中，因为它是保留关键字。

结果集应类似于：

```
id       |       name       |       group_id       |       group_name
-----------------------------------------------------------------------------
1        |       John       |       5              |       ThisIsGroup5
3        |       Tim        |       3              |       ThisIsGroup3
6        |       NotInGroup |       NULL           |       NULL 
```

在上述查询中更改`LEFT`为将 INNER JOIN 两个表并从结果集中排除用户“NotInGroup”。`INNER`

# mysql - 保存布尔值并在搜索时节省 CPU 和内存的最佳解决方案

> ID：11284080
> 
> 赞同：0
> 
> 时间：2012-07-01T17:15:05.097
> 
> 标签：mysql, database, database-design

如果您希望在 select 语句上获得更高的查询性能和最小的内存损失，那么在数据库中插入布尔值的最佳解决方案是什么。

例如：我有一个包含 36 个字段的表，其中 30 个字段具有布尔值（零或一），我需要使用只有**真实**值的布尔字段来搜索记录。

```
SELECT * FROM `myTable`
WHERE 
    `field_5th` = 1 
    AND `field_12th` = 1 
    AND `field_20` = 1 
    AND `field_8` = 1 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:18:10.567

如果要存储布尔值或标志，基本上有三个选项：

1.  单个列

这反映在您上面的示例中。优点是您将能够将索引放在您打算最常用于查找的标志上。缺点是这会占用更多空间（因为可以分配的最小列大小是 1 字节。）

但是，如果您的列名确实是 field_20、field_21 等。那么这绝对不是要走的路。编号的列表示您应该使用其他两种方法中的任何一种。

1.  位掩码

如上所述，您可以将多个值存储在单个整数列中。BIGINT 列最多可为您提供 64 个可能的标志。

值将类似于： UPDATE table SET flags=b'100'; 更新表 SET flags=b'10000';

然后该字段看起来像：10100

这将表示设置了两个标志值。要查询任何特定的标志值集，你会做

SELECT flags FROM table WHERE flags & b'100';

这样做的好处是您的标志在空间上非常紧凑。缺点是您不能在字段上放置索引，这将有助于提高搜索特定标志的性能。

1.  一对多关系

这是您创建另一个表的地方，那里的每一行都会有它链接到的行的 id 和标志：

CREATE TABLE main ( main_id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY, );

CREATE TABLE 标志（ main_id INT UNSIGNED NOT NULL，名称 VARCHAR(16) ）；

然后，您将在标志表中插入多行。

优点是您可以使用索引进行查找，并且每行可以有任意数量的标志，而无需更改架构。这最适用于稀疏值，其中大多数行没有值集。如果每一行都需要定义所有标志，那么这不是很有效。

对于性能比较，您可以阅读我写的关于该主题的博客文章： [设置性能比较](http://gtowey.blogspot.com/2009/01/three-types-of-sets-performance.html)

此外，当您问哪个是“最佳”时，这是一个*非常*主观的问题。最擅长什么？这完全取决于您的数据是什么样的，您的需求是什么以及您希望如何查询它。

请记住，如果您想执行如下查询：SELECT * FROM table WHERE some_flag=true

仅当少数行设置了该值时，索引才会对您有所帮助。如果表中的大多数行的 some_flag=true，那么 mysql 将忽略索引并进行全表扫描。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:30:08.707

您要查询多少行数据？您可以将布尔值存储在整数值中，并使用位运算来测试它们。它不可索引，但存储空间非常好。使用带有索引的 TINYINT 字段将选择一个索引来使用并从那里扫描。

# c# - Console.In.Peek() 在输入时返回 -1

> ID：11284082
> 
> 赞同：1
> 
> 时间：2012-07-01T17:15:33.383
> 
> 标签：c#, .net

我本来希望下面的 C# 程序只打印“EOF！” 一旦我在控制台中点击“Ctrl-Z”。相反，程序在我按下 Enter 后立即结束：

```
var textReader = Console.In;
var sb = new StringBuilder();
while(textReader.Peek() != -1)
{
    sb.Append((char)textReader.Read());
}
Console.WriteLine("Entered: '{0}'", sb);
Console.WriteLine("EOF!"); 
```

例子：

```
12345 <= I entered this
Entered: '12345 <= program outputs this
'
EOF!
Press any key to continue . . . 
```

谁能解释上述行为？这根本不是我所期望的。

如何从 Console.In 一次读取超过 1 行的输入？

**更新：**如下回答：问题是 Peek() 不能依赖。虽然使用 Read() 有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:23:23.563

Console.In.Read() 在 EOF 上返回 -1，所以你可以这样做：

```
int c;
while((c = Console.In.Read()) != -1)
Console.Out.Write((char)c); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:45:47.520

点击 Ctrl-Z 将产生值 26`Console.In.Peek();` 您必须关闭输入流才能产生 -1 （在您关闭控制台、点击 Ctrl-C（默认情况下）或显式调用时发生`Console.In.Close()`）。

此外，默认情况下，控制台流将以行模式运行，这意味着在您按 Enter 之前，流实际上不会填充字符。您可以使用阻止的“Console.ReadKey”（请参阅[​​ http://msdn.microsoft.com/en-us/library/system.consolekeyinfo.key.aspx](http://msdn.microsoft.com/en-us/library/system.consolekeyinfo.key.aspx)），或者您可以将控制台切换到离线模式。可以在此处找到 AC# 示例：http: [//ewbi.blogs.com/develops/2005/11/net_console_pre.html](http://ewbi.blogs.com/develops/2005/11/net_console_pre.html)。

# javascript - WebKit + V8 在哪里？

> ID：11284084
> 
> 赞同：2
> 
> 时间：2012-07-01T17:15:41.823
> 
> 标签：javascript, c++, webkit

是否有任何 WebKit 端口使用 V8（或可以这样构建）并且可以在任何 GUI 系统中轻松使用？

（我检查了一些 WebKit-GTK+ 分支，但由于代码中的一些错误，它甚至无法编译。）

我在 WebKit 的网站上看到了一些 Chromium 端口。它包括V8吗？编译时是同一个 Chromium 吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2016-11-25T06:46:21.637

你试过 NW.js 即 node-webkit

# groovy - 在 Groovy 中使用 .match 运算符的示例

> ID：11284086
> 
> 赞同：0
> 
> 时间：2012-07-01T17:15:50.743
> 
> 标签：groovy

作为一个新手问题，假设可以使用 switch 语句，匹配运算符是否可以用于列表迭代器

```
def myList = [1, 2, 3, 4]
myList.each {
    it.match {
        case /1/ => println "ONE!"
        // etc.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:25:53.363

你的意思是这样的：

```
def myList = [1, 2, 3, 4]
myList.each {
    switch(it) {
        case ~/1/ : println "ONE!"; break
        case ~/2/ : println "TWO!"; break
    }
} 
```

（我不是 groovy 专家 - 建议是可取的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T20:09:29.100

一个很好的方法是使用闭包映射：

```
def caseMap = [ 1 : { println "ONE!" },
                2 : { println "TWO!" },
              ]
def myList = [1, 2, 3, 4]
myList.each { 
    if (caseMap.containsKey(it)) { 
        caseMap[it]() 
    }
} 
```

您可能需要在 caseMap[it] 周围加上括号。

# php - 使用 mod_rewrite 删除 .php 扩展名有效，但标签页面无效

> ID：11284105
> 
> 赞同：1
> 
> 时间：2012-07-01T17:18:19.387
> 
> 标签：php, .htaccess, mod-rewrite, tags

我有这样的 .htaccess 文件：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php
RewriteRule (.*)/sites/([^a-zA-Z][0-9_/]*$) $1.php?sites=$2 [L]
RewriteRule (.*)/sites/([0-9_/]*)/(.*) $3 [L]
RewriteRule (.*)/sites/(.*) $2 [L]
RewriteRule tags_xml/(.*).xml tags/display_xml.php?tag=$1 [L]
RewriteRule news_xml/(.*).xml rss.php?site=$1 [L]
RewriteRule tags/([ÄĂ“ĹĹšÄ„Ĺ»ĹąÄ†ĹÄ™ĂłĹ‚Ĺ›Ä…ĹĽĹşÄ‡Ĺ„a-zA-Z0-9%\ ]*)/([^a-zA-Z][0-9_/]*$) tags/display.php?tag=$1&page=$2 [L]
RewriteRule tags/([ÄĂ“ĹĹšÄ„Ĺ»ĹąÄ†ĹÄ™ĂłĹ‚Ĺ›Ä…ĹĽĹşÄ‡Ĺ„a-zA-Z0-9%\ ]+) tags/display.php?tag=$1 [L]
RewriteRule news/([0-9]*)/([0-9]*)/([^a-zA-Z][0-9]*)/(.*).html$ kom.php?id_b=$1&id_n=$2&kom_page=$3 [L]
RewriteRule news/([0-9]*)/([0-9]*)/(.*).html$ kom.php?id_b=$1&id_n=$2 [L]
RewriteRule news/([0-9]*)/([0-9]*)/([^a-zA-Z][0-9]*)/(.*) $4 [L]
RewriteRule news/([0-9]*)/([0-9]*)/(.*) $3 [L]
RewriteCond %{THE_REQUEST} ^.*index.php.* 
```

现在当我进入

> www.domain.com/file

代替

> www.domain.com/file.php

它工作正常，但是当我进入

> www.domain.com/tags/银行

我没有找到这样的标签错误。此文件夹中的其他脚本也仅显示“未找到此类标记”。

以前的工作代码是：

```
RewriteEngine On
RewriteBase /
RewriteRule (.*)/sites/([^a-zA-Z][0-9_/]*$) $1.php?sites=$2 [L]
RewriteRule (.*)/sites/([0-9_/]*)/(.*) $3 [L]
RewriteRule (.*)/sites/(.*) $2 [L]
RewriteRule tags_xml/(.*).xml tags/display_xml.php?tag=$1 [L]
RewriteRule news_xml/(.*).xml rss.php?site=$1 [L]
RewriteRule tags/([ĘÓŁŚĄŻŹĆŃęółśążźćńa-zA-Z0-9%\ ]*)/([^a-zA-Z][0-9_/]*$) tags/display.php?tag=$1&page=$2 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule tags/([ĘÓŁŚĄŻŹĆŃęółśążźćńa-zA-Z0-9%\ ]+) tags/display.php?tag=$1 [L]
RewriteRule news/([0-9]*)/([0-9]*)/([^a-zA-Z][0-9]*)/(.*).html$ kom.php?id_b=$1&id_n=$2&kom_page=$3 [L]
RewriteRule news/([0-9]*)/([0-9]*)/(.*).html$ kom.php?id_b=$1&id_n=$2 [L]
RewriteRule news/([0-9]*)/([0-9]*)/([^a-zA-Z][0-9]*)/(.*) $4 [L]
RewriteRule news/([0-9]*)/([0-9]*)/(.*) $3 [L]
RewriteCond %{THE_REQUEST} ^.*index.php.* 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T17:27:25.807

更新：好的，再次阅读您的 htaccess 后，我注意到您使用以下内容：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

在某些系统上，这将指向您的文件系统，因此添加 DOCUMENT_ROOT 可能对您有用。像这样：

```
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T17:54:00.333

解决方案是在最后添加：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^\.]+)$ $1.php [NC,L] 
```

# java - 用java编写的Selenium测试可以在Play中执行吗

> ID：11284107
> 
> 赞同：-1
> 
> 时间：2012-07-01T17:18:31.983
> 
> 标签：java, selenium, playframework, playframework-1.x

是否可以在 Play1 框架中运行用 Java 编写的 Selenium 测试？

表演！框架在其测试运行程序中支持 Selenium 测试，但文档指出测试必须以“HTML 表”的形式出现。

另一方面，Selenium 支持更方便的 Java API，并提供了普通编程语言的所有功能。

但是我在Play中没有找到任何东西！有关运行用 Java 编写的 Selenium 测试的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T04:02:38.760

在我自己没有使用过 Play 的情况下，它似乎具有标准的 Java[依赖集成](http://www.playframework.org/documentation/1.2/dependency)，可以从 Maven 存储库中提取库。根据文档中的说明，您可以编辑该`dependencies.yml`文件，并添加如下内容：

```
# Application dependencies

require:
    - play 1.2
    - org.seleniumhq.selenium -> selenium-java 2.24.1 
```

这将允许您使用 Selenium 的标准 Java API。

# android - Android Ksoap 将对象作为参数传递错误

> ID：11284108
> 
> 赞同：2
> 
> 时间：2012-07-01T17:18:56.900
> 
> 标签：android, android-ksoap2

我通过与请求一起发送对象来与 Web 服务进行通信。

这是对 Web 服务的请求格式。

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"   xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
<soap:Body>
<UpdateLocation xmlns="http://tempuri.org/">
<location>
<Id>int</Id>
<TabletId>int</TabletId>
<SpeedVisibility>boolean</SpeedVisibility>
<BeltVisibility>boolean</BeltVisibility>
<LightVisibility>boolean</LightVisibility>
<ProjectorVisibility>boolean</ProjectorVisibility>
<DefStart>int</DefStart>
<DefEnd>int</DefEnd>
<DefPickerCount>int</DefPickerCount>
<DefSlotCount>int</DefSlotCount>
<ServerIP>string</ServerIP>
<WebURL>string</WebURL>
</location>
</UpdateLocation>
</soap:Body>
</soap:Envelope> 
```

这是我发出请求的java代码。

```
private void updateSettingsOnServer() {
SoapObject request = new SoapObject(NAMESPACE, METHOD_UPDATE_SETTINGS);

Location serverObject = new Location(currentLocation.databaseId, currentLocation.tabletId, currentLocation.isSpeedVisible, currentLocation.isBeltVisible, currentLocation.isLightVisible, currentLocation.isProjectorVisible, currentLocation.slotStarting, currentLocation.slotEnding, prefPickerCount, prefSlotCount, prefServerIPString, prefWebURL);

 PropertyInfo pi = new PropertyInfo();
    pi.setName("serverObject");
    pi.setValue(serverObject);
    pi.setType(serverObject.getClass());
    request.addProperty(pi);

SoapSerializationEnvelope envelope = 
    new SoapSerializationEnvelope(SoapEnvelope.VER11); 
envelope.dotNet = true;
envelope.setOutputSoapObject(request);

envelope.addMapping(NAMESPACE,"Location",new Location().getClass());

HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

try {
    androidHttpTransport.call(SOAP_ACTION_UPDATE_SETTINGS, envelope);

    SoapObject result=(SoapObject)envelope.getResponse(); //To get the data.
    tempText.setText("Received :" + result.toString());

}
catch(Exception e)
{

    tempText.setText("Error");
    //Toast.makeText(context, "Error", Toast.LENGTH_LONG).show();
    e.printStackTrace();
}

} 
```

我通过以下方式制作了我的自定义类 KVMSerializable。

```
class Location implements KvmSerializable
{
public Location(int id, int tabletid, boolean speed, boolean belt, boolean light, boolean projector, int start, int end, int picker, int slot, String server, String web)
{
    databaseId =id;
    tabletId = tabletid;
    isSpeedVisible = speed;
    isBeltVisible = belt;
    isLightVisible = light;
    isProjectorVisible = projector;
    slotStarting = start;
    slotEnding = end;
    pickerCounting = picker;
    slotCounting = slot;
    serverUrlLink = server;
    webUrlLink = web;

}

public Location() {
    // TODO Auto-generated constructor stub
}

boolean isSpeedVisible, isLightVisible, isBeltVisible, isProjectorVisible;
int slotStarting, slotEnding , pickerCounting, slotCounting;
int databaseId, tabletId;
String serverUrlLink, webUrlLink;

public Object getProperty(int arg0) {
    // TODO Auto-generated method stub

     switch(arg0)
        {
        case 0:
            return databaseId;
        case 1:
            return tabletId;
        case 2:
            return isSpeedVisible;
        case 3:
            return isBeltVisible;
        case 4:
            return isLightVisible;
        case 5:
            return isProjectorVisible;
        case 6:
            return slotStarting;
        case 7:
            return slotEnding;
        case 8:
            return pickerCounting;
        case 9:
            return slotCounting;
        case 11:
            return serverUrlLink;
        case 12:
            return webUrlLink;

        }

     return null;
}

public int getPropertyCount() {
    // TODO Auto-generated method stub
    return 12;
}

public void getPropertyInfo(int arg0, Hashtable arg1, PropertyInfo info) {
    // TODO Auto-generated method stub

    switch(arg0)
    {
    case 0:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "databaseId";
        break;
    case 1:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "tabletId";
        break;
    case 2:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "isSpeedVisible";
        break;
    case 3:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "isBeltVisible";
        break;
    case 4:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "isLightVisible";
        break;
    case 5:
        info.type = PropertyInfo.BOOLEAN_CLASS;
        info.name = "isProjectorVisible";
        break;
    case 6:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "slotStarting";
        break;
    case 7:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "slotEnding";
        break;
    case 8:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "pickerCounting";
        break;
    case 9:
        info.type = PropertyInfo.INTEGER_CLASS;
        info.name = "slotCounting";
        break;
    case 11:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "serverUrlLink";
        break;
    case 12:
        info.type = PropertyInfo.STRING_CLASS;
        info.name = "webUrlLink";
        break;

    default:break;
    }

}
public void setProperty(int index, Object value) {
    // TODO Auto-generated method stub

    switch(index)
    {
    case 0:
        databaseId = Integer.parseInt(value.toString());
        break;
    case 1:
        tabletId = Integer.parseInt(value.toString());
        break;
    case 2:
        isSpeedVisible = Boolean.parseBoolean(value.toString());
        break;
    case 3:
        isBeltVisible = Boolean.parseBoolean(value.toString());
        break;
    case 4:
        isLightVisible = Boolean.parseBoolean(value.toString());
        break;
    case 5:
        isProjectorVisible = Boolean.parseBoolean(value.toString());
        break;
    case 6:
        slotStarting = Integer.parseInt(value.toString());
        break;
    case 7:
        slotEnding = Integer.parseInt(value.toString());
        break;
    case 8:
        pickerCounting = Integer.parseInt(value.toString());
        break;
    case 9:
        slotCounting = Integer.parseInt(value.toString());
        break;
    case 10:
        serverUrlLink = (value.toString());
        break;
    case 11:
        webUrlLink = (value.toString());
        break;

    default:
        break;
    }

}
} 
```

但是，不幸的是，它不起作用。

我收到此**错误**。我环顾四周，但仍然无法找到解决此问题的方法。

```
SoapFault - faultcode: 'soap:Server' faultstring: 'Server was unable to process request. ---> Object reference not set to an instance of an object.' faultactor: 'null' detail 
```

请帮助/建议我如何解决该错误。

# javascript - 在 Chrome 扩展中插入 CSS

> ID：11284112
> 
> 赞同：3
> 
> 时间：2012-07-01T17:19:30.567
> 
> 标签：javascript, json, google-chrome, google-chrome-extension

我知道可以使用 Content_Scripts 将 CSS 添加到页面，但我想在 JS 文件中使用 InsertCSS 函数。

我有：

```
chrome.tabs.insertCSS(null, {code: "adfree.css"}); 
```

但它不会改变网页的任何内容。我给了权限：

```
"permissions": [
    "tabs", "*://*"
], 
```

为什么它不起作用？

**编辑：**

```
chrome.tabs.insertCSS({file: "adfree.css"}); 
```

或者

```
chrome.tabs.insertCSS(null, {file: "adfree.css"}); 
```

也不起作用...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:25:27.390

`code`当您应该使用密钥时，您正在向它传递一个文件名，但使用`file`密钥：

```
chrome.tabs.insertCSS(null, {file: "adfree.css"}); 
```

有关更多信息，请参阅[文档](http://code.google.com/chrome/extensions/tabs.html#method-insertCSS)。

# c# - 找到包含“必需文本”的标签

> ID：11284113
> 
> 赞同：0
> 
> 时间：2012-07-01T17:19:32.003
> 
> 标签：c#, label

在 C# Winforms 中，当用户首次加载表单时，我通过单击该标签将输入作为标签“文本”输入数据库。再次，如果另一个用户加载该表单，我想禁用该标签。我怎样才能做到这一点？这是表格样本

![在此处输入图像描述](../Images/6b3d9d78ec992a54b604ca721aaa5f69.png)

这是我试过的：

*   如果用户点击多个标签，我会得到输入字符串“E10,E9,E8,E7 等，”
*   当另一个用户加载表单时，我检索该字符串并使用“，”将其拆分并将其存储在一个数组中

    但我不知道如何使该标签从数组中禁用。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:40:04.497

**强文本**1.- 在您的数组中循环
2.- 使用标签名称查找标签（我认为标签名称与您在数组中的输入字符串相同）
3 .- 禁用控制

```
foreach (string name in yourArray)
{
   var matches = this.Controls.Find(name , true);
   ((Label) matches).Enable = False
} 
```

我现在没有编译器，我希望它能运行。如果不是，请谅解。

**编辑**：通过他的文本属性找到一个标签：

```
foreach(Control c in this.Controls)
{
   if(c is Label)
   {
      if((Label) c).Text == "RequiredText")
      {
          // Do stuff here ;
      }
   }
} 
```

请注意，如果标签位于面板、组框或任何内容控件内，则必须使用 udo contentControl.Controls 而不是使用“this”。

**编辑 2：**好的，此代码对我有用。我有一个带有文本“示例”的标签。

```
 var myarray = "E1,E2,Sample".Split(',');

    foreach (Control labelcontrol in this.Controls)
    {
        if (!(labelcontrol is Label)) continue;
        foreach (var text in myarray)
        {
            if (labelcontrol.Text == text)
                labelcontrol.Enabled = false;
        }
    } 
```

# c# - 使用 linq 解析 youtube 提要

> ID：11284114
> 
> 赞同：4
> 
> 时间：2012-07-01T17:19:37.023
> 
> 标签：c#, xml, linq, youtube, feed

我想解析 youtube 频道的 atom 提要。这是该 rss atom 提要的链接。

> [http://gdata.youtube.com/feeds/api/users/cokestudio/uploads?orderby=updated](http://gdata.youtube.com/feeds/api/users/cokestudio/uploads?orderby=updated)

```
 List<YTFeeds> lstYT = new List<YTFeeds>();
 XDocument xDocumentYT = XDocument.Load(Server.MapPath("XMLFile.xml"));
 XNamespace xmlns = "http://www.w3.org/2005/Atom";
lstYT.AddRange((from entry in xDocumentYT.Descendants(xmlns + "entry").Elements(xmlns + "media:group")
                        select new YTFeeds
                        {
                            Title = entry.Element(xmlns + "media:title").Value,
                            Description = entry.Element(xmlns + "media:description").Value,
                            Video = entry.Elements(xmlns + "media:player").ElementAt(1).Attribute("url").Value,
                            Image = entry.Elements(xmlns + "media:thumbnail").ElementAt(1).Attribute("url").Value

                        }).ToList()); 
```

我收到一条错误消息`invalid character or hexcode ":"`。我想从标签中获取元素：`<media:group>` 请建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:56:21.673

当使用命名空间写出元素的名称时，您必须省略前缀，它将为您处理。在这种情况下，您需要一个单独的命名空间实例才能获取`media`元素。所以访问标题、描述等应该是这样的：

```
var doc = XDocument.Load(Server.MapPath(@"XMLFile.xml"));
XNamespace xmlns = "http://www.w3.org/2005/Atom";
XNamespace media = "http://search.yahoo.com/mrss/";
var query =
    from entry in doc.Root.Elements(xmlns + "entry")
    let grp = entry.Element(media + "group")
    select new YTFeeds
    {
        Title = (string)grp.Element(media + "title"),
        Description = (string)grp.Element(media + "description"),
        Video = (string)grp.Element(media + "player").Attribute("url"),
        Image = grp.Elements(media + "thumbnail")
            .Select(e => (string)e.Attribute("url"))
            .First(),
    };
var lstYT = query.ToList(); 
```

# vba - Excel 数据比较的最佳方法存在于 2 张纸中

> ID：11284115
> 
> 赞同：0
> 
> 时间：2012-07-01T17:19:42.397
> 
> 标签：vba, excel

> **可能重复：**
> [用于匹配和排列行的 Excel 宏](https://stackoverflow.com/questions/4379213/excel-macro-to-match-and-lineup-rows)

我有一个 Excel 工作簿，其中包含 2 张具有相同列集但数据以不同方式排列的工作表。我需要使用一个或多个 Key 列将 Sheet 2 与 Sheet 1 进行比较，并识别不匹配的记录。

**sheet1中的数据：**

```
UserId Name Salary DeptId DeptName Location
1      Loga 2000   1      HR       Chennai
2      Mano 1500   2      PM       Mumbai
3      Raj  2500   5      GM       Delhi 
```

**sheet1中的数据：**

```
UserId Name Salary DeptId DeptName Location
2      Mano 1500   2      PM       Mumbai
3      Raj  2500   5      GM       Delhi 
```

首先，我需要根据 UserId 和 DeptId 匹配记录，如果在工作表比较薪水 -> 如果薪水匹配将记录与 UserId 存储为薪金匹配。类似地，如果 UserId 和 DeptId 在两个工作表中都匹配，则比较位置 -> 如果匹配，则将用户 ID 的记录存储为位置匹配，如果不报告为特定的用户 ID 不匹配。，

我计划在 VBA 宏中使用 HLookUp 进行比较，但是当行数增加并降低性能时，这似乎是一个漫长的过程。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T21:28:22.290

我看到了多种解决方案。最简单但不是最干净的解决方案是使用 UserId 和 Dept-Id 创建密钥。一个简单的连接就可以完成这项工作。例如，添加一个 G 列（假设 UserId 在 A 中等等..）您可以这样做：`=$A2 & "-" & $D2`然后使用一个简单的查找函数来查看您创建的唯一 ID 是否存在于两个工作表中，例如：（`=IF(ISERROR(VLOOKUP($G2, Sheet2!$G$2:$G$3, 1, 0)), 0, 1)`对不起，如果函数名称不正确，我是从法语翻译的）。然后对这些数据做任何你想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:35:13.397

我总是使用一种方法，它是硬编码的，您可以根据您的示例对其进行优化。子 findMatch()

```
 Dim i As Integer
  Dim j As Integer
  Dim UserID As Integer
  Dim UserID2 As Integer
  Dim DeptID As Integer
  Dim DeptID2 As Integer
  Dim sal As Integer
  Dim Salary2 As Integer
  Dim Location As String
  Dim Location2 As String

  Dim rows1 as Integer
  Dim rows2 as Integer

  rows1=Worksheets("sheet1").Cells(Rows.Count, "A").End(xlUp).Row 'rows count in sheet1
  rows2=Worksheets("sheet2").Cells(Rows.Count, "A").End(xlUp).Row 'rows count in sheet2

    For i = 1 To rows1
        UserID = Workbooks("yourWorkBook").Worksheets("sheet1").Cells(i, "A").Value)
        'yourWorkBook is the name of the Access document
        DeptID = Workbooks("yourWorkBook").Worksheets("sheet1").Cells(i, "D").Value)
        Salary = Workbooks("yourWorkBook").Worksheets("sheet1").Cells(i, "C").Value)
        Location  = Workbooks("yourWorkBook").Worksheets("sheet1").Cells(i, "F").Value)

        for j= 1 to rows2
            UserID2 = Workbooks("yourWorkBook").Worksheets("sheet2").Cells(j, "A").Value)
            DeptID2 = Workbooks("yourWorkBook").Worksheets("sheet2").Cells(j, "D").Value)
            Salary2 = Workbooks("yourWorkBook").Worksheets("sheet2").Cells(j, "C").Value)
            Location2 = Workbooks("yourWorkBook").Worksheets("sheet2").Cells(j, "F").Value)

            If (UserID=UserID2) and (DeptID=DeptID2) Then

                If Salary=Salary2 then 'userID, DeptID and Salary match
                    'you create manually another sheet (sheet3) in wich you will store the desired data
                    lstSalRow = Worksheets("sheet3").Cells(Rows.Count, "A").End(xlUp).Row 'Getting the count of rows in the sheet
                    'inserting after the last row
                    Worksheets("sheet3").Cells(lstSalRow+1, "A").Value=UserID  'Storing UserID
                    Worksheets("sheet3").Cells(lstSalRow+1, "B").Value=Salary  'Storing salary

                Elseif strcmp(Location, Location2)=0 then  'userID, deptID and Location match

                    'Location matched : you can create another sheet (sheet4) in wich you will store the desired data
                    lstLocRow = Worksheets("sheet4").Cells(Rows.Count, "A").End(xlUp).Row
                    Worksheets("sheet4").Cells(lstLocRow+1, "A").Value=UserID 
                    Worksheets("sheet4").Cells(lstLocRow+1, "B").Value=Location

                Else 'only userID and DeptID match
                    'do other actions
                End If

            End If

        next j

    next i

End Sub 
```

我希望它有所帮助。

# java - 如何将 d3 (javascript) 添加到 vaadin 应用程序？

> ID：11284116
> 
> 赞同：8
> 
> 时间：2012-07-01T17:19:47.887
> 
> 标签：java, javascript, visualization, vaadin, d3.js

各位晚安，

我目前正在尝试将 d3 的可视化功能添加到我的 vaadin 应用程序中。如果你不知道 d3 是什么，这里有一个快速链接：[http ://d3js.org/](http://d3js.org/)

然而我遇到了一些问题：

*   如何添加使用 d3 进行开发所必需的“d3.v2.js”javascript 文件/库？我尝试将它添加到自己的主题（WebContent/VAADIN/themes/myOwnTheme/..），但通过在 Eclipse 中刷新我收到消息：“在构建过程中发生错误。在项目上运行构建器'JavaScript Validator'时出错' VaadinD3Testproject'.14"。我猜那是因为 js 文件可能太大了，大约有 8000 行？我读到了以某种方式将文件添加到 web.xml？有办法吗？

*   然后如何将 javascript 代码添加到我的 vaadin 应用程序？经过研究，我知道可以使用以下选项：

    *   getMainWindow().executeJavaScript("alert('foo');")

    或者

    *   Label test = new Label("将鼠标移到这里..

        ",标签.CONTENT_XHTML);

--> 还有其他方法可以集成 javascript 代码吗？

有人可以用一种“逐步”的解释来帮助我，如何解决这两种方式？在这里真的会很感激帮助，因为我对此没有那么有经验。

- - - - 更新 - - - - - -

> 如何添加使用 d3 进行开发所必需的“d3.v2.js”javascript 文件/库？我尝试将其添加到自己的主题（WebContent/VAADIN/themes/myOwnTheme/..），但通过刷新我收到消息：“构建期间发生错误。在项目'VaadinD3Testproject'上运行构建器'JavaScript Validator'时出错' . 14"。我猜那是因为 js 文件可能太大了，大约有 8000 行？我读到了以某种方式将文件添加到 web.xml？有办法吗？

我修复了出现的这个错误，这是我的 eclipse 和内置 javascript 验证器的问题。我现在可以通过用自己的 servlet 覆盖 ajax 类来将 js 文件加载到我的应用程序中，正如这里在几篇文章中所描述的那样。

我现在尝试了几种方法：

*   getMainWindow.executeJavaScript() 无法以我可以使用 d3 的方式工作，不知何故，只要我想添加一些 d3 代码，例如“d3.select("body") .append("svg");" ，它只是不执行它（无论我是否做标签，但我注意到一般标签中的代码不会被执行）

*   我尝试使用 CustimLayout，因为它已在本论坛的一些示例中显示，但它再次像上面描述的那样。当我检查网站源代码时，我的代码只是丢失或解析了

*   标签不再起作用，无论是 XHTML 还是 RAW 模式，都会发生异常

*   覆盖在服务器启动时构建主体时调用的另一个 servlet 方法，结果是我收到一条错误消息，指出 vaadin 甚至无法再加载默认的小部件集。

那么，还剩下什么？真的没有办法将d3与vaadin集成吗？从来没有人尝试过这个吗？昨天我也读了很多关于即将推出的 vaadin 7 的文章。但是使用我不知道它的稳定性的 alpha 版本是否是一种选择（我想这就是它被称为 alpha 的原因）

感谢您与我分享的每一个想法

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-09T07:23:10.310

合并现有 javascript 库的最全面方法是开发您自己的[自定义组件](https://vaadin.com/book/-/page/gwt.html)。这*比*“正常”的 Vaadin 开发要复杂一些，但可以让您完全访问浏览器中的 javascript 方法和对象（通过 GWT）。

要在页面中仅包含一个外部 javascript 文件，请扩展 ApplicationServlet 类并覆盖该`writeAjaxPageHtmlVaadinScripts`方法。这是当前项目的摘录，其中包括一些外部库。

然后，您可以使用“getMainWindow().executeJavaScript(blah)”来使用这些库

尽管如此，从我对 d3 的了解来看，开发自定义 Vaadin 组件更有意义。您可能会发现查看是否存在现有的 GWT d3 小部件更为谨慎，然后尝试在 Vaadin 组件中使用它。

```
@Override
protected void writeAjaxPageHtmlVaadinScripts(Window window,
                                              String themeName, Application application, BufferedWriter page,
                                              String appUrl, String themeUri, String appId,
                                              HttpServletRequest request) throws ServletException, IOException {
  page.write("<script type=\"text/javascript\">\n");
  page.write("//<![CDATA[\n");
  page.write("document.write(\"<script language='javascript' src='" + appUrl + "/VAADIN/scripts/jquery/jquery-1.4.4.min.js'><\\/script>\");\n");
  page.write("document.write(\"<script language='javascript' src='" + appUrl + "/VAADIN/scripts/highcharts/highcharts.js'><\\/script>\");\n");
  page.write("document.write(\"<script language='javascript' src='" + appUrl + "/VAADIN/scripts/highcharts/modules/exporting.js'><\\/script>\");\n");
  page.write("//]]>\n</script>\n");
  super.writeAjaxPageHtmlVaadinScripts(window, themeName, application,
      page, appUrl, themeUri, appId, request);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-06T07:31:02.380

我知道为时已晚，但我从 D3js 和 Vaadin 的集成开始。我得到了一些资源。它可能会对在这条赛道上的人有所帮助 首先，Vaadin 最好的书是**《Vaadin 之书》** 这本书将帮助您全面了解 Vaadin 还被推荐用于 Vaadin 认证

[**点击这里下载** **Vaadin 之书**](https://vaadin.com/download/book-of-vaadin/vaadin-7/pdf/book-of-vaadin.pdf)

1) [Freecode Charts 和 D3 Wrapper](https://vaadin.com/directory#!addon/freecode-charts-and-d3-wrapper)

2) [D3 与 Vaadin 的集成](http://www.rapidpm.org/2013/10/13/using-javascript-libraries-(d3)-in-vaa.html)

如果您在本教程中遇到任何错误，请尝试参考此链接 --> [Vaadin 论坛](https://vaadin.com/forum#!/thread/5349118)

3）[直接使用d3库](http://www.freecode.net.ua/chapter-5.-direct-use-of-d3-library.html)

# java - 安卓网络应用的最佳实践

> ID：11284118
> 
> 赞同：0
> 
> 时间：2012-07-01T17:19:52.533
> 
> 标签：java, android

我是 android 应用程序开发的新手，我不确定我是否正确地解决了我的问题：

我想开发一个显示来自特定网站的一些信息的应用程序，例如，我想显示包含在一个中的所有链接：

```
<div class="title"> link </div> 
```

为此，我想在 java 中开发一个解析器，它将`<div class="title">`在页面源中搜索。

现在我的问题是：将搜索字符串存储`<div class="title">`在服务器上的文件中是否是一种好习惯，并且每次应用程序加载时都会下载此字符串？如果`<div class="title">`示例更改为`<div class="abc">`我想轻松更改字符串并且不让用户下载应用程序的更新。

有没有比我想的更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:25:34.270

试试这个自制的解决方案......

**1.**将字符串存储在服务器上。

**2.**最初当用户安装应用程序时，让当前字符串与应用程序一起安装。

**3.**下次字符串更改时，向您的应用程序的所有用户发送**通知**，一旦用户单击通知，只需确保您的应用程序启用了逻辑代码以使用新的（当前） 细绳。

# jquery - 如何使用它的位置获取元素？

> ID：11284121
> 
> 赞同：0
> 
> 时间：2012-07-01T17:20:13.360
> 
> 标签：jquery, html

我想得到一个在这个位置的元素。我该怎么做？

```
<div class="parent">
    <div id="pos1" style="left:0;top:0">pos1</div>
 <div id="pos2" style="left:100px;top:100px">pos2</div>
  <div id="pos3" style="left:100px;top:100px">pos3</div>
</div> 
```

css

```
.parent{position:relative}
.parent div{position:absolute} 
```

现在，如果我想获取位置 100px,100px 的所有元素。我该如何使用 jquery 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:24:13.897

您可以使用 .filter （如此处所示[jQuery: Selecting all elements where attribute is greater than a value](https://stackoverflow.com/questions/2613648/jquery-selecting-all-elements-where-attribute-is-greater-than-a-value)）

就像是：

```
$('.parent div').filter(function() {
  return ( $(this).css('top') == '100px' && $(this).css('left') == '100px')
}); 
```

# android - Android：如何使用音量按钮来初始化应用程序？

> ID：11284122
> 
> 赞同：0
> 
> 时间：2012-07-01T17:20:34.500
> 
> 标签：android

我就像在开发一个当我按下音量时会打电话回家的应用程序。

我有一个有效的拨号/呼叫方法。现在我需要帮助弄清楚如何将它全部封装在一个方法中，该方法将在按下并按住音量键时激活。

任何建议都会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:27:03.317

您需要使用该[`onKeyLongPress()`](http://developer.android.com/reference/android/view/KeyEvent.Callback.html#onKeyLongPress%28int,%20android.view.KeyEvent%29)方法来捕获此事件，如下所示：

```
@Override
public boolean onKeyLongPress(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) 
    {
        //Your Code here
        return true;
    }
    return super.onKeyLongPress(keyCode, event);
} 
```

这仅捕获 Volum down 事件，并将其他所有内容传递回它的正常实现。

# php - crondoc 电子邮件和日志文件

> ID：11284128
> 
> 赞同：0
> 
> 时间：2012-07-01T17:20:51.423
> 
> 标签：php, cron, crontab

我们有一个开发人员设置了一个 crondoc.txt 文件来处理我们的 cron 作业，而我在 cron 作业方面没有经验，不知道如何完全理解如何改变它。我必须立即执行此操作，因此我正在寻求帮助。我需要更改它，以便它通过电子邮件发送给我并将 cron 作业发送到文件。

```
0,20,40 8,9,10,11,12,13,14,15,16,17,18,19,20 * * 1,2,3,5,6,7 /usr/bin/php /home/folder/filename.php >> /dev/null 2>&1 
```

**更新：这实际上对我来说没有意义。上面有一个 crontab，然后是下面这样的另一种设置：**

```
0 2 * * 5 /usr/bin/php /home/folder/filename.php | mail -s "Service Alert Output" me@myemail.com 
```

问题：如何将它们组合起来，以便获取电子邮件并登录到文件？

我不知道以 >> 开头的文件名之后的结尾是什么意思，但希望通过电子邮件发送给我并放入日志文件中。可能的？示例将很好地帮助我完成这项工作。

谢谢你。

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:33:31.887

要更改电子邮件设置，您应该使用 MAILTO 变量，例如 put

MAILTO=vivek@nixcraft.in

在 cron 文件的开头。您可以在此处阅读有关 MAILTO 变量的更多信息 - [http://www.cyberciti.biz/faq/linux-unix-crontab-change-mailto-settings/](http://www.cyberciti.biz/faq/linux-unix-crontab-change-mailto-settings/)

关于 >> /dev/null 2>&1 部分，它将命令的输出重定向到 /dev/null 文件。因此，您应该将 /dev/null 更改为要保存命令输出的文件名。

编辑：

完整的 crontab 文件示例：

```
MAILTO=youremail@example.com
0 2 * * 5 /usr/bin/php /home/folder/filename.php >> /path/to/your/logfile 2>&1 
```

我认为您不需要将命令的输出通过管道传输到邮件程序，因为 crontab 具有内置功能。

# jquery - 将php数组的元素调用到jquery中

> ID：11284137
> 
> 赞同：0
> 
> 时间：2012-07-01T17:22:22.750
> 
> 标签：jquery, arrays

我将把以下数组的元素调用到 jquery 中。

```
$options[] = array( 'title' => 'Upload Favicon',
                    'id'    => 'favicon',
                    'type'  => 'upload' ); 
```

我尝试了以下方法，但它不起作用..

```
jquery("'.$option['id'].'").hide(); 
```

可能是我错了，但我自己猜是因为在jquery代码中没有#用于id调用，但我不知道如何添加#。

请帮忙..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:33:00.603

明显的问题在这里：

```
$options[] = array( 'title' => 'Upload Favicon',  
        ^^ 
```

这表示“向数组添加一个元素`$options`，并将该元素的值设置为数组`'title' => 'Upload Favicon'...`。如果`$option`尚未设置，它将被创建为一个数组。所以它实际上是这样的：

```
$options = array (
    array ('title' => 'Upload Favicon',
           'id'    => 'favicon',
           'type'  => 'upload'
          );
); 
```

这可能不是您的意思，因为您需要像这样访问它：

```
$options[0]['id'] 
```

要修复它，请删除`[]`：

```
$options = array( 'title' => 'Upload Favicon',
                  'id'    => 'favicon',
                  'type'  => 'upload' 
                ); 
```

# c# - 如何删除字符串中的重复字符集

> ID：11284140
> 
> 赞同：-1
> 
> 时间：2012-07-01T17:22:35.810
> 
> 标签：c#, .net, windows

例如一个字符串包含以下内容（字符串是可变的）：

```
http://www.google.comhttp://www.google.com 
```

在这里删除重复 url 的最有效方法是什么 - 例如输出将是：

```
http://www.google.com 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:39:47.230

我假设输入只包含网址。

```
string input = "http://www.google.comhttp://www.google.com";

// this will get you distinct URLs but without "http://" at the beginning
IEnumerable<string> distinctAddresses = input
   .Split(new[] {"http://"}, StringSplitOptions.RemoveEmptyEntries)
   .Distinct();

StringBuilder output = new StringBuilder();
foreach (string distinctAddress in distinctAddresses)
{
   // when building the output, insert "http://" before each address so 
   // that it resembles the original
   output.Append("http://");
   output.Append(distinctAddress);
}

Console.WriteLine(output); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:29:16.927

将字符串收集到列表中并使用不同的，如果您的字符串有http地址，您可以应用正则`http:.+?(?=((http:)|($))`表达式`RegexOptions.SingleLine`

```
var distinctList = list.Distinct(StringComparer.CurrentCultureIgnoreCase).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T17:29:44.433

效率有各种定义：代码大小、总执行时间、CPU 使用率、空间使用率、编写代码的时间等。如果你想“高效”，你应该知道你正在尝试其中的哪一个。

我会做这样的事情：

```
string url = "http://www.google.comhttp://www.google.com";
if (url.Length % 2 == 0)
{
    string secondHalf = url.Substring(url.Length / 2);
    if (url.StartsWith(secondHalf))
    {
        url = secondHalf;
    }
} 
```

根据您需要删除的重复项的种类，这可能适合您，也可能不适合您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T17:47:04.230

鉴于您不知道字符串的长度，您不知道某些东西是否是双倍的，您也不知道什么是双倍的：

```
string yourprimarystring = "http://www.google.comhttp://www.google.com";
int firstCharacter;
string temp;
for(int i = 0; i <= yourprimarystring.length; i++)
{
  for(int j = 0; j <= yourprimarystring.length; j++)
  {
    string search = yourprimarystring.substring(i,j);
    firstCharacter = yourprimaryString.IndexOf(search);
    if(firstCharacter != -1)
    {
      temp = yourprimarystring.substring(0,firstCharacter) + yourprimarystring.substring(firstCharacter + j - i,yourprimarystring.length)
      yourprimarystring = temp;
    }
} 
```

这将遍历您的所有元素，从第一个字母到最后一个字母全部取出并像这样搜索它们：

ABCDA - 搜索 A 发现 A 排除 A，这就是问题所在，如果要使其可变，您需要指定重复需要多长时间，但也许我的代码可以帮助您。

# iphone - 通过划分 .xib 文件来减少内存使用？

> ID：11284142
> 
> 赞同：0
> 
> 时间：2012-07-01T17:22:45.700
> 
> 标签：iphone, ios, class, memory, ram

我正在回顾我的一个旧应用程序（实际上是我的第一个应用程序），并试图减少内存使用量以防止它在旧设备上崩溃（我已经在旧设备上运行它并使用仪器进行了分析，绝对是内存问题导致它崩溃）。不幸的是，当我制作这个应用程序时，我对 iOS 开发的常见做法不是很熟悉，并且结构很差：**一个视图控制器和一个 xib 文件**，根据需要隐藏和显示界面元素。

现在我想知道是否值得对多个类和视图控制器进行全面检修并重新开始，以及这是否会减少加载应用程序所需的大量内存（70+MB）。

另外，如果我只是清空 .xib 文件并以编程方式加载所有界面元素（并继续使用一个 .xib 文件），它会起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:28:01.730

如果不知道您的应用程序中到底发生了什么，就很难知道它会有多大帮助。不过，这里有一些通用提示可以帮助您：

*   拆分您的视图控制器，以便每个视图都有一个视图控制器。在某些情况下，视图控制器实际上应该控制多个视图（为了内存效率、性能等），但以此为起点。
*   不要将所有对象放在一个 XIB 中。将其拆分，以便每个视图控制器拥有一个 XIB，并让 iOS 在需要时加载您的 XIB 元素。
*   以编程方式创建界面元素对内存使用没有帮助。
*   观察你缓存的内容，只有在有明显的性能优势时才将它们保存在内存中。

如果您决定重写您的应用程序，请务必经常使用 Instruments 对其进行分析以衡量您的进度。

# python - 如何用 Python Popen 做多个参数？

> ID：11284147
> 
> 赞同：25
> 
> 时间：2012-07-01T17:23:43.873
> 
> 标签：python, pygtk, subprocess, popen, gnome-terminal

我正在尝试制作一个带有按钮的 PyGtk Gui。当用户按下此按钮时，`gnome-terminal`提示用户输入密码。

然后它将为JQuery 片段克隆这个[Git 存储库。](https://github.com/pererinha/gedit-snippet-jquery)`gedit`

然后，它将`js.xml`文件复制到`/usr/share/gedit/plugins/snippets/js.xml`

最后，它强行删除了 Git 存储库。

**命令：**

```
gnome-terminal -x sudo git clone git://github.com/pererinha/gedit-snippet-jquery.git && sudo cp -f gedit-snippet-jquery/js.xml /usr/share/gedit/plugins/snippets/js.xml && sudo rm -rf gedit-snippet-jquery 
```

它在我的终端上运行良好。

*但是，*通过它刚刚打开的 GUI，我添加了我的密码，按 Enter，然后它再次关闭。

我只想将命令运行到第一个`&&`

**这是我的 Python 函数（带有命令）：**

```
def on_install_jquery_code_snippet_for_gedit_activate(self, widget):
    """ Install Jquery code snippet for Gedit. """
    cmd="gnome-terminal -x sudo git clone git://github.com/pererinha/gedit-snippet-jquery.git && sudo cp -f gedit-snippet-jquery/js.xml /usr/share/gedit/plugins/snippets/js.xml && sudo rm -rf gedit-snippet-jquery"
    p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=STDOUT,
             close_fds=False)
    self.status.set_text(p.stdout.read()) #show response in 'status 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-07-03T11:22:19.550

要直接回答您的问题，请阅读下文。但是您的程序存在很多问题，其中一些我在“更好的实践”中进行了介绍。

* * *

默认情况下，[`subprocess.Popen`](https://docs.python.org/2/library/subprocess.html#subprocess.Popen)命令以字符串列表的形式提供。

但是，您也可以使用该`shell`参数来执行“格式与在 shell 提示符下键入时完全一样”的命令。

**不：**

```
>>> p = Popen("cat -n file1 file2") 
```

**是的：**

```
>>> p = Popen("cat -n file1 file2", shell=True)
>>> p = Popen(["cat", "-n", "file1", "file2"]) 
```

这两个选项之间存在许多差异，并且每个选项都有有效的用例。我不会试图总结这些差异——[`Popen`文档](https://docs.python.org/2/library/subprocess.html#subprocess.Popen)已经做得很好了。

* * *

因此，对于您的命令，您将执行以下操作：

```
cmd = "gnome-terminal -x sudo git clone git://github.com/pererinha/gedit-snippet-jquery.git && sudo cp -f gedit-snippet-jquery/js.xml /usr/share/gedit/plugins/snippets/js.xml && sudo rm -rf gedit-snippet-jquery"
p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=STDOUT,
          close_fds=False) 
```

## 更好的实践

但是，使用 Python 作为许多系统命令的包装器并不是一个好主意。至少，您应该将命令分解为单独的 Popen，以便可以充分处理非零退出。实际上，这个脚本似乎更适合作为 shell 脚本。但如果你坚持使用 Python，还有更好的做法。

该[`os`模块](http://docs.python.org/library/os.html)应该代替对`rm`and的调用`cp`。虽然我没有这方面的经验，但您可能想看看像[GitPython](http://gitorious.org/git-python)这样的工具来与 Git 存储库进行交互。

### 兼容性问题

最后，您应该小心调用`gnome-terminal`和`sudo`。并非所有 GNU/Linux 用户都运行 Ubuntu，也不是每个人都`sudo`安装了 或 GNOME 终端仿真器。在当前形式下，如果出现以下情况，您的脚本将会崩溃，而且毫无帮助：

*   该`sudo`命令未安装
*   用户不在`sudoers`群组中
*   用户不使用 GNOME 或其默认终端仿真器
*   未安装 Git

如果您愿意假设您的用户正在运行 Ubuntu，那么调用`x-terminal-emulator`是比`gnome-terminal`直接调用更好的选择，因为它将调用他们安装的任何终端仿真器（例如`xfce4-terminal`对于 Xubuntu 的用户）。

# c++ - Taglib：性能和崩溃问题

> ID：11284154
> 
> 赞同：4
> 
> 时间：2012-07-01T17:25:21.783
> 
> 标签：c++, performance, qt, taglib

我在我的 Qt 应用程序中使用 taglib 库（1.7.2），从音乐文件夹中读取 mp3 文件的一些元数据。问题是我发现它很慢。

例如，这是代码：

```
QString path = "C:/Music/";
QDir d(path);
QStringList fileTypes;
fileTypes << "*.mp3" ;
d.setNameFilters(fileTypes);
QStringList pathList = d.entryList( QDir::NoDotAndDotDot | QDir::Files);

QTime t;
t.start();
foreach (QString fileName, pathList) {
    fileName = path + fileName;
    TagLib::FileRef *f = new TagLib::FileRef(fileName.toStdWString().c_str());
}
qDebug()<<t.elapsed(); 
```

这段代码加载一个包含 400 首歌曲的文件夹大约需要 11 秒，即每个文件大约需要 28 毫秒。这是一条非常慢的线：

```
TagLib::FileRef *f = new TagLib::FileRef(pathFile.toStdWString().c_str()); 
```

这么长正常吗？我尝试过使用多线程，但它并没有改变任何东西，而且它不是来自我的 PC，因为它足够强大。奇怪的是，一旦加载了所有文件，下次再次加载文件夹时，它就会立即完成（直到我重新启动操作系统）。

* * *

我还有另一个问题。

有时，当未设置标签时，应用程序崩溃并输出：

```
HEAP[myapp.exe]: 
Invalid address specified to RtlFreeHeap( 0ED90000, 0ED92CC0 ) 
```

例如以下行：

```
if (!f->tag()->genre().isNull()) 
```

我正在使用 Windows 7。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:50:30.713

> > 有时，当未设置标签时，应用程序崩溃并输出...

这是 TagLib 中许多奇怪的设计决策之一。没有标签时，AudioProperties 对象为 NULL。您必须忍受它并添加一些额外的代码来检查 NULL。

> > 奇怪的是，一旦加载了所有文件，下次再次加载文件夹时，它就会立即完成（直到我重新启动操作系统）

这并不奇怪，因为 Windows 7 具有非常先进且非常激进的磁盘 I/O 缓存机制。一旦您“触摸”该文件，它就会进入 RAM，下次您访问它时，它几乎是瞬间完成的。400 个 mp3 文件并不多，而且都适合 RAM。

> > 11 秒加载包含 400 首歌曲的文件夹

您必须执行 400 次磁盘寻道，这在典型的硬盘驱动器上通常需要 9-11 毫秒（是的，SSD 只需 0.1 毫秒）。因此，如果文件夹碎片，您至少有 10*400 = 4 秒来“倒带”驱动器的头部。由于 id3 标签可能出现在文件的开头和结尾，这实际上增加了两次读取次数（您必须倒回到文件末尾），从而提供 2 倍时间（大约 8 秒）。

简历：阅读文件夹的时间接近于现实。TagLib 中有许多怪癖（如 NULL 或无法重载文件操作以允许，例如从档案中读取），但它们是可以避免的。TagLib 的功能非常好，而且在很多方面都是独一无二的（支持广泛的格式）。

# php - 使用 php header('location') 使用 javascript 刷新页面

> ID：11284158
> 
> 赞同：1
> 
> 时间：2012-07-01T17:25:42.143
> 
> 标签：php, javascript, http-headers, refresh

我想使用一个 php 文件来处理我所有的投票请求。

`siteType`目前，如果未设置，脚本将转发用户并显示一条消息。如果用户已经`JS`打开，那么它将返回一个 json 对象并 ajax 页面。

```
 if(!isset($_COOKIE['siteType'])){
            displayMessages('bad', 'Before you can continue you must select which category you would like to be in.');
            header('Location:/');
            exit;
        } 
```

我需要它，因为如果执行上面的 php 代码，页面将重新加载，我假设使用 javascript 并读取 http 标头？

**[编辑]** 我没有让自己足够清楚，但这是一个 ajax 请求。我不输出任何html。所以这真的只是让 js 处理标题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:50:38.627

您不能*使用 php header('location') 使用 javascript 刷新页面，* 因为 header('Location: xxx'); 必须是你的 PHP 脚本的唯一输出，它是一个标头，你不能把它放在 javascript 语法之后

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:52:25.057

PHP

```
echo '<meta http-equiv="refresh" content="0">'; 
```

Javascript

```
window.location.reload(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T17:44:57.420

也许这对你来说是一些解决方案，

```
if(!isset($_COOKIE['siteType'])){
     displayMessages('bad', 'Before you can continue you must select which category you would like to be in.');
     echo '<script>window.location.reload()</script>';
     exit;
 } 
```

# python - python中的变量

> ID：11284165
> 
> 赞同：0
> 
> 时间：2012-07-01T17:27:10.330
> 
> 标签：python

我得到这样的变量：

```
ocd[2].likelihood.range[1][0]=[-5219, -5191, 11.7];
ocd[2].likelihood.range[1][1]=[-5180, -5057, 56.5]; 
```

从其他程序。我重新格式化为：

```
range10=[-5219, -5191, 11.7];
range11=[-5180, -5057, 56.5]; 
```

为了在 Python 中使用它们，但这是很多工作，所以我的问题是，是否有可能以某种方式在 Python 中使用具有原始名称的这些变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:49:57.183

不知道你在问什么，但我会试一试 - 在“其他”程序的代码中执行以下操作：

1.  `range*`在第一次使用变量之前添加此代码：

    ```
    class Likelihood():
        def __init__(self, x, y):
            self.range = [{} for i in range(x)] # without default values
            # if you need default values, use this code or numpy.zeros(shape=(x,y))
            #self.range = [[0 for j in range(y)] for i in range(x)]

    class MyDataType():
        def __init__(self, dimension_1, dimension_2):
            self.likelihood = Likelihood(dimension_1, dimension_2)

    ocd = [0, 1, MyDataType(100, 100)]

    # copy-paste your code here:
    ocd[2].likelihood.range[1][0]=[-5219, -5191, 11.7];
    ocd[2].likelihood.range[1][1]=[-5180, -5057, 56.5];

    print(ocd[2].likelihood.range[1][0]) 
    ```

2.  全部替换`range10`为`ocd[2].likelihood.range[1][0]`，例如在 Notepad++ Regex 中替换：

    ```
    Find what:    range(\d)(\d)
    Replace with: ocd[2].likelihood.range[\1][\2]

    i.e. from code: print(range10)
    to code:        print(ocd[2].likelihood.range[1][0]) 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:34:01.403

你可以用pythonic的方式来做：

```
def range_function(row, column):
    return ocd[2].likelihood.range[row][column]

range_function(1, 0) == [-5219, -5191, 11.7] 
```

# php - Codeigniter 的 redirect() 和非标准 url

> ID：11284168
> 
> 赞同：3
> 
> 时间：2012-07-01T17:27:39.690
> 
> 标签：php, codeigniter, redirect

Codeigniter 不会`oauth://application`正确重定向“url”，将其固定在当前域之后，如下所示：

```
http://mywebsite.com/index.php/oauth://application 
```

代码如下所示：

```
redirect("oauth://application", "location"); // changing to refresh doens't work either. 
```

知道如何让它工作吗？我正在尝试重定向到 Android 应用程序。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T17:33:54.480

还不如使用 PHP 的原生`header`函数：

```
header('Location: oauth://application', TRUE, 302);
exit; 
```

如果你想调整 CI 的功能，只需创建`application/helpers/my_url_helper.php`并调整`preg_match`URL 检查：

```
function redirect($uri = '', $method = 'location', $http_response_code = 302)
{
    // if ( ! preg_match('#^https?://#i', $uri))
    if ( ! preg_match('#^(https?|oauth)://#i', $uri))
    {
        $uri = site_url($uri);
    }

    switch($method)
    {
        case 'refresh'  : header("Refresh:0;url=".$uri);
            break;
        default         : header("Location: ".$uri, TRUE, $http_response_code);
            break;
    }
    exit;
} 
```

# javascript - 将内联 Youtube API javascript 代码移动到单独的文件

> ID：11284171
> 
> 赞同：0
> 
> 时间：2012-07-01T17:28:07.410
> 
> 标签：javascript, youtube, youtube-api, jsfiddle, youtube-javascript-api

我有这个[jsfiddle](http://jsfiddle.net/4WPmY/6/)。

当我将脚本从上面板移动到下面板时，它不再起作用。为什么我不能使用 jQuery 来定位按钮？现在，我必须使用 vanilla JavaScript，因为 jQuery 不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:39:42.307

在 JSFiddle 中，在左侧面板^([屏幕截图](http://i.stack.imgur.com/Efivl.png))中，您可以选择放置脚本的位置。默认情况下，它被包装在`onload`头部的一个事件中。默认情况下，Mootools 库已加载。

YouTube Player API 无法使用默认设置的原因是该 API 需要定义一个**全局** `onYouTubePlayerAPIReady`事件。当代码被包装在一个`onload`事件中时，该函数不再是全局的。

解决方案是正确使用 JSFiddle：使用`no wrap (body)`和`jQuery 1.7.2`：http: [//jsfiddle.net/4WPmY/12/](http://jsfiddle.net/4WPmY/12/)。

另一种解决方案虽然不如推荐的解决方案好，但`onYouTubePlayerAPIReady`通过将其设置为以下属性来全局定义：http `window`: [//jsfiddle.net/4WPmY/13/](http://jsfiddle.net/4WPmY/13/)

```
window.onYouTubePlayerAPIReady = function () { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:38:35.570

在 jsFiddle 的左侧窗格中，在标题为“选择框架”的部分中，您需要将第一个设置更改为，`no wrap (body)`以便在加载 DOM 后运行 JS 面板。`jQuery 1.7.2`如果您希望使用该库，您还应该将第二个选项更改为。

**你的小提琴，更新：http:** [//jsfiddle.net/Marcel/4WPmY/11/](http://jsfiddle.net/Marcel/4WPmY/11/)

# php - 将 PHP 变量传递给 jQuery 函数

> ID：11284180
> 
> 赞同：3
> 
> 时间：2012-07-01T17:28:58.607
> 
> 标签：php, jquery, video, plugins, src

我正在尝试为我的网站实现 jQuery Flare 视频插件。有一个下拉菜单，用户必须从中选择一年，当单击提交按钮时，视频将显示在屏幕上。我有一个数据库，它从数据库中获取视频的路径，即`$row['videoName']`. 我的问题是如何在 jQuery 函数中传递 PHP 变量。在插件中给出的示例中，在`src`jQuery 函数的属性中给出了视频的完整路径。我试图`src`通过将 PHP 变量传递给它来实现动态。

我没有收到任何错误，包含视频的 div 出现在屏幕上，但视频没有显示。

谢谢你。

```
 jQuery(function($){
          fv = $("#video").flareVideo();
          fv.load([
            {
              src:  '$row['videoName']',
              type: 'video/mp4'
            }
          ]);
        })
      </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:34:41.797

要访问 PHP 变量，您必须将代码括在 PHP 括号中，如下所示：

```
jQuery(function($){
    fv = $("#video").flareVideo();
    fv.load([
      {
        src:  "<?php echo $row['videoName']; ?>",
        type: 'video/mp4'
      }
    ]);
  })
</script> 
```

这也必须与创建 PHP 变量以允许访问位于同一页面上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T17:46:23.207

我建议尽可能将 PHP 预处理排除在 javascript 之外。我有一个约定，在视图中从 PHP 创建所有变量的哈希，然后将它们注入到我的 Javascript 对象中。在这种情况下，您可以将这样的内容放入视图中：

```
<script>
var options = {
    videoName: '<?php echo $row['videoName']?>'
}
</script> 
```

或者

```
<script>
var options = <?php echo json_encode($row);?>;
</script> 
```

稍后在您的任何 javascript 文件中，您可以执行以下操作：

```
$(function(){
    fv = $("#video").flareVideo();
    fv.load([{
        src:  options.videoName,
        type: 'video/mp4'
    }]);
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T17:33:07.283

```
jQuery(function($){
      fv = $("#video").flareVideo();
      fv.load([
        {
          src:  '<?= $row['videoName'] ?>',
          type: 'video/mp4'
        }
      ]);
    })
  </script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T17:45:20.080

混合 php 和 js 代码很难看。因此，当您将所有 js 代码放入 .js 文件时，您可以这样做：

将代码写入 .js 文件

```
jQuery(document).ready(function($){
    fv = $("#video").flareVideo();
    fv.load([
    {
        src:  videoName, // videoName is in the global scope
        type: 'video/mp4'
    }
    ]);
})

var videoName = ""; // init var to avoid undefined values 
```

将代码写入 .php 文件

```
echo <<<EOM
<script type="text/javascript">
var videoName = '{$row['videoName']}';
</script>
EOM; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-01T18:32:25.440

视频的 URL 应该在 HTML 范围内的某个位置。JS 可以方便地获取 URL，例如

```
fv.load({
  src: $('.videlink').attr('href'),
  type: 'video/mp4'
}) 
```

我不知道这个flareVideo() 的确切javascript，但URL 应该真的在你的HTML 中的某个地方。不要只将它传递给 JavaScript，这真的是丑陋的设计：\

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-18T21:14:28.197

将 PHP 变量传递给 jQuery 的另一种方法是通过 DOM。您说您有一个用户选择年份的下拉列表。当您构建页面时，获取整个视频数组，如下所示：

```
$rows = array(
    '1991' => '/url/to/your/1991-video',
    '1992' => '/url/to/your/1992-video',
    '1993' => '/url/to/your/1993-video',
    '1994' => '/url/to/your/1994-video'
); 
```

因此，您可以像这样构建您的选择列表：

```
<select id="videoName">
  <option value="<?php echo $rows['1991'] ?>">1991</option>
  <option value="<?php echo $rows['1992'] ?>">1992</option>
  <option value="<?php echo $rows['1993'] ?>">1993</option>
  <option value="<?php echo $rows['1994'] ?>">1994</option>
</select> 
```

我使用了一个简单的数组，但您将使用数据库查询的结果，您也可以使用 foreach 来构建下拉列表。

然后您的视频脚本将仅引用 $('#videoName').value()。

通过在 select 上执行 .change() 事件处理程序，您可以启动视频而无需重新加载任何页面。

您可以使用相同的方法基于数​​据库查询构建项目表。只需根据您的数据库输出命名您的对象或使用唯一值标识它们。

（代码未经测试）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-19T20:11:51.453

想用饼干做这个吗？我想像这样的事情......

PHP

```
setcookie('your_cookie_name', json_encode($your_array), time()+3600, "\"); 
```

Javascript

然后，您将在 JS 中使用 PHP 数组来执行您想要在其上执行的任何 JS。

```
 var arrayVar = []
    arrayVar = $.parseJSON($.cookie('your_cookie_name')); 
```

# ios - 是否可以在 IOS 中检测标签是否即将溢出？

> ID：11284181
> 
> 赞同：2
> 
> 时间：2012-07-01T17:29:01.733
> 
> 标签：ios, objective-c, iphone, ipad

在我的应用程序中，我有一个`UILabel`包含越来越多的条目，例如，每次用户按下按钮时，标签末尾都会附加一个“1”。但是我希望能够检测到何时向标签添加额外的条目会导致它超出其容器的大小并成为丑陋的“111 ...”标签，所需的行为类似于以下内容：

```
int maximumLengthBeforeOverrun = self.maximumLengthBeforeLabelOverrun;
if(label.text.length > maximumLengthBeforeOverrun) {
    NSString * newLabel = [label.text substringTo:label.text.length - 1]
    label.text = newLabel;
}
label.text = [label.text appendWithString:toAppend] 
```

我的问题是 IOS SDK 中有一些方法可以为我做到这一点吗？或者我应该使用不同的方法来显示信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:38:29.640

你可以使用`sizeWithFont`

```
NSString *str = @"Test String";
CGSize size = [str sizeWithFont:label.font]; 
```

然后使用 size 与 label.frame.size 进行比较

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-14T17:17:52.697

sizeWithFont 在 iOS 7 中已被弃用，因此您需要使用 sizeWithAttributes

```
NSString *str = @"Test String";
NSDictionary *attributes = @{NSFontAttributeName: label.font};
CGSize size = [str sizeWithAttributes:attributes]; 
```

# javascript - 如何使用 Backbone.Paginator.js 运行多个实例？

> ID：11284184
> 
> 赞同：39
> 
> 时间：2012-07-01T17:29:18.983
> 
> 标签：javascript, jquery, backbone.js, underscore.js, infinite-scroll

我正在尝试[`Backbone.Paginator.js`](https://github.com/addyosmani/backbone.paginator)在同一页面上运行多个应用程序（分页器的多个实例）。

[我创建了一个测试页面。](http://dl.dropbox.com/u/19974044/backbone.paginator.zip)（导航到`backbone.paginator/examples/netflix-infinite-paging`）。

我保留了 for`app.js`和 create的代码`app2.js`，这是一个克隆，`app.js`但所有 javascript 代码都位于一个文件中，并且该应用程序已重命名为 app2。

两个实例在第一次加载页面时工作，但随后的请求/刷新只加载 app2.js 的数据。

**是否可以在同一页面上运行多个实例？**

*   我对使用自动分页（无限/无尽滚动）很感兴趣，所以我尝试使用 Paul Irish [`jQuery Infinite Scroll plugin`](https://github.com/paulirish/infinite-scroll/%5d%5b2%5d%29)，但我无法让它工作。
*   我正在启动插件以在准备好的文档上运行（这不起作用，正如预期的那样），但也在 app2 的 ResultView 中运行代码，这也不起作用。

关于如何获得自动分页无限滚动解决方案的任何想法？

*   我遇到了[https://github.com/joneath/infiniScroll.js](https://github.com/joneath/infiniScroll.js)但我不确定如何将它与 Backbone.Paginator.js 集成。
*   我仍在学习，任何帮助将不胜感激！:)

* * *

**更新：**在跨不同浏览器进行进一步测试后，问题似乎出在缓存问题/差异上。例如，在 Safari 中，它有时（随机）在刷新页面时起作用。我不确定如何调试它。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:43:52.197

问题： 1- 您是否在代码库中也包含了 jQuery Javascript 框架依赖项？2- 我已经下载了 zip 文件，在本地 Xammp 上运行它，它似乎是下载的演示而不是测试页面，您能否从问题所附的压缩文件中确认哪个页面是您的测试页面？3- 你能在 jsfiddle 中创建一个模型（以防发生一些服务器端代码）吗？4-无限滚动jquery插件提供的链接坏了，应该是：[https ://github.com/joneath/infiniScroll.js](https://github.com/joneath/infiniScroll.js)

如果你想让 jQuery 分页器插件独立，你可能需要考虑容器元素来触发它

……

从建议的链接中，我认为我们应该对此进行试验。否则，您可能想为浏览器创建一个 cookie 或其他东西，以记住多个实例上插件的更改。这里有一些想法？

1#

```
 Backbone.InfiniScroll(collection, **options**) 
```

渲染 Backbone 视图后，实例化一个新的 InfiniScroll 对象。

```
myView = Backbone.View.extend({
  initialize: function(){
    _.bindAll(this, "render");

this.render();
this.infiniScroll = new Backbone.InfiniScroll(this.collection, {success: this.appendRender}); 
```

})};

2# 从选项菜单一目了然

```
 target: $(window), 
```

也许我们应该尝试：

```
 $(body).find('#container1'), 
```

-或者-

```
 $(window).children('div').hasClass('container'), 
```

只是一些想法，自己没有尝试过-

3# 你可能想让 (1) 成为一个 javacript 函数并基于一个类或它的 id 来触发它，以初始化所需容器上的滚动。

这就是我可以通过快速查看来提出的所有想法，但如果它有帮助或至少给出一些方向，请随时回复。

4# 另一个想法是 myView 可以是 Javascript 中具有时间戳 id 的变量，这样您可以确保唯一性，并且由于您正在调用 new，那么您可以为您的视图运行多个插件实例。

# objective-c - 解析JSON目标c

> ID：11284185
> 
> 赞同：0
> 
> 时间：2012-07-01T17:29:23.713
> 
> 标签：objective-c, ios, json

我正在启动一个 URL 连接，并且我的脚本正在返回以下 JSON：

> ( 1, { "id" = <-ID Here->; hash = <-Hash Here->; }, ( ), ( ) )

到目前为止，我看到的所有示例似乎在各自的数组/字典之前都有“id”或标识符。尽管四处寻找，我找不到解析这个的方法。（即，我需要获取第一个布尔值、id、哈希，然后是数组（目前为空））。

抱歉，如果我遗漏了什么——我是在 Obj-C 中解析 JSON 的新手。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:37:15.020

我使用的功能内置于 Cocoa 库中：NSJSONSerialization 类。它提供了将 JSON 解析为图形以及将图形编码为 JSON 的方法。规则类似于 plist（即基本类型加上数组和字典）。

如果你有 NSData （你可以很容易地从字符串中获取），你可以这样做：

```
NSArray *yourJSONAsObjectGraph = [NSJSONSerialization JSONObjectWithData:yourNSData options:nil error:&err]; 
```

然后，使用上面的数据，objectAtIndex:0 将是您可以调用的 NSNumber `boolValue`，objectAtIndex:1 将是您可以调用的 NSDictionary `objectForKey:@"id"`（和 @"hash"），等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:32:10.577

请参阅[如何在 Objective-C 中使用 JSON](http://blog.zachwaugh.com/post/309924609/how-to-use-json-in-cocoaobjective-c)。如果您还没有听说过，请查看[SBJSON](http://stig.github.com/json-framework/)。

# php - XP 上的 XAMPP 配置失败

> ID：11284191
> 
> 赞同：0
> 
> 时间：2012-07-01T17:30:05.773
> 
> 标签：php, apache, xampp

我的操作系统是 XP sp2。[我从apachefriends](http://www.apachefriends.org/en/xampp-windows.html)下载了 XAMPP（XAMPP 1.7.7 的新版本）。然后安装。我阅读了很多文章并观看了视频。但我仍然无法访问*“ [http://localhost/xampp](http://localhost/xampp) ”。*浏览器说

> 此网页无法使用

当我同时启动 mysql 和 apache 时，这是一个屏幕截图。
![在此处输入图像描述](../Images/e520175a5ad69fcd90d2c1a0986ea147.png)

正如互联网上的所有教程所说，当我开始时，每个组件都有一个绿色标签，上面写着“正在运行”。这里没有显示任何内容，但控制台中有一些内容。但是在键入任何相关 URL 后，我在浏览器中看不到任何 php 页面。我是这方面的绝对初学者。
**新**
我手动安装了 Apache 2.2。然后它运行良好，XAMPP 显示 Apache 正在运行。当 URL 键入“localhost”时，会出现 Apache 的 htdocs html 页面。所以，现在我假设端口“80”没有问题（因为手动安装的 apache 正在其上运行）。我想配置 XAMPP 以使用我手动安装的 apache 版本。请问有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:04:26.553

确保没有其他应用程序正在使用端口 80。（例如，Skype 使用。关闭 Skype 重新启动 Apache）。

检查 cmd 中是否有任何东西正在运行`netstat`。

# jquery - 带有 jQ uery 的 CSS3 转换事件监听器

> ID：11284194
> 
> 赞同：13
> 
> 时间：2012-07-01T17:30:21.780
> 
> 标签：jquery, events, css, css-transitions, event-listener

我在文章元素上实现 CSS3 过渡效果，但事件监听器*transitionend*仅适用于纯 JavaScript，不适用于 jQuery。

请参见下面的示例：

```
// this works
this.parentNode.addEventListener( 'transitionend', function() {alert("1"); }, true);

// this does not work
$(this).parent().addEventListener( 'transitionend', function() {alert("1"); }, true); 
```

有人可以解释一下我做错了什么吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-04T22:35:59.303

另请注意，如果您在一个元素上运行多个转换（例如不透明度和宽度），您将获得多个 transitionEnd 回调。

如果您使用 jQuery 将事件绑定到 div 的转换结束，您可能需要考虑使用 one() 函数。

```
$(this).parent().one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend", function() {
    // your code when the transition has finished
}); 
```

这意味着代码只会在第一次触发。所以，如果你在同一个元素上发生了四种不同的转换，你的回调只会触发一次。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-01T17:32:36.757

在 jQuery 中你应该使用`bind()`or`on()`方法：

```
$(this).parent().bind( 'transitionend', function() {alert("1"); }); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-01T18:05:28.657

`this.parentNode`返回一个 javascript 对象。它有一个属性`.addEventListener` `$(this).parent()`返回一个 jQuery 对象。它没有属性`.addEventListener`

试试这个，

```
$(this).parent().on('webkitTransitionEnd oTransitionEnd transitionend msTransitionEnd', function() {
    alert("1");
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T17:32:41.343

如果第一个确实有效（我对此表示怀疑，因为它应该需要供应商前缀），那么这也应该有效：

```
$(this).parent().on('transitionend', function() {
    alert("1");
}); 
```

# drupal - 使用 Drupal 开发日志系统

> ID：11284199
> 
> 赞同：0
> 
> 时间：2012-07-01T17:31:50.263
> 
> 标签：drupal, drupal-6

我将开发一个期刊系统，该系统具有论文提交和带有评估表的审阅操作，类似于 OJS 系统。我想为此使用drupal，但我不确定它是否是一个不错的选择。

Drupal 有能力创建这样的应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T12:29:18.537

It is a very generic question. To answer some part:

Drupal can be customized and used for a lot of projects, thanks to the powerful community and module developers.

Let me give a glimpse of possibilities, you can find the rest: Each paper can be a `content type`. Each user can have specific roles and permissions (eg. publisher, editor, reviewer etc) who are allowed to do specifically what you allow them to do. They can apply for higher roles as well.

Each review process can be captured and maintained using `workflow` module. There are plenty of tutorials for that.

List of articles can be shown with various properties and filters using `views`. They can be shown in various regions of a theme you select or make of your own (or customize).

The community can be built using `forums`.

In short there are thousands of possible ways you can make this. But one note from personal experience: sometimes you will find extremely tough things to be done in simple ways, while simple things will take time. This is mostly because like all systems, it takes a bit of time to get used to with the drupal api.

Best of luck!

# android - 在 Android 中复制 iOS 时间选择器

> ID：11284200
> 
> 赞同：0
> 
> 时间：2012-07-01T17:31:50.470
> 
> 标签：android, datetimepicker, picker, custom-datetimepicker

我正在尝试编写一个在 Android 中使用 timepicker 的应用程序，但我真的很想从 iOS 实现一个。

我有几个线索，但没有发现任何对我有用的东西。

我的问题是时间选择器是用于时间的，但我想将我的用于三个可以选择的不同数值（没有上午/下午），所以看起来选择器是[要走](http://developer.android.com/guide/topics/ui/controls/pickers.html)的路，除了它们是在 API 11 中引入的.

我发现这个[博客](http://android-devblog.blogspot.com/2010/05/wheel-ui-contol.html)似乎为你提供了一些代码，但我无法让它工作。

我也找到了[android-wheel](http://code.google.com/p/android-wheel/source/checkout)，但我不知道如何获取它的来源。任何人都可以引导我朝着正确的方向前进吗？

iOS 时间选择器如下所示：

![在此处输入图像描述](../Images/7e4eb7b3b4ccb0ea21ce1ddb3fcc6d6d.png)

Android 滚轮看起来像这样：

![在此处输入图像描述](../Images/71070b58877653afcbbf07cfe539f97c.png)

但是，我一直无法弄清楚如何获取它的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-19T08:09:05.403

代码在谷歌代码项目中 - [https://code.google.com/p/android-wheel/source/browse/](https://code.google.com/p/android-wheel/source/browse/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-27T13:16:47.083

从以下链接下载各种车轮示例的源代码：

[http://android-wheel.googlecode.com/svn/trunk/](http://android-wheel.googlecode.com/svn/trunk/)

确保您有 svn 插件可供下载。

谢谢。

# c# - 如何使用 ASP.NET 从 SQL Server 显示图像？

> ID：11284217
> 
> 赞同：4
> 
> 时间：2012-07-01T17:34:29.800
> 
> 标签：c#, asp.net, sql-server, image

这是我的课程（product.cs），其中插入图像的方法是：

```
public static void InsertProductIMG(byte[] image, string contentType) 
{
   string cs = "Data Source=(local);Initial Catalog=myApp;Integrated Security=True";
   string comandoSql = "INSERT INTO [myApp].[dbo].[product] (image, ContentType) VALUES (@image, @contentType)";

   using (SqlConnection conn = new SqlConnection(cs))
   {
       conn.Open();

       using (SqlTransaction trans = conn.BeginTransaction())
       {
           SqlCommand cmd = new SqlCommand(comandoSql, conn, trans);
           SqlParameter[] parms = new SqlParameter[2];
           parms[0] = new SqlParameter("@image", image);
           parms[1] = new SqlParameter("@contentType", contentType);
           foreach (SqlParameter p in parms)
           {
              cmd.Parameters.Add(p);
           }

           cmd.ExecuteNonQuery();
           trans.Commit();
       }
    }
} 
```

这是我调用上述方法的 apsx 页面背后的代码：

```
byte[] imageBytes = new byte[fupld.PostedFile.InputStream.Length];
product.InsertProductIMG(imageBytes, "image/jpeg");//product is the class where the method is 
```

现在我想知道如何显示此图像？

我是否必须从 sql (SELECT) 中读取 byte[]，转换为字符串，然后再转换为 byte[]？然后将其转换为位图（System.Drawing）。但是我如何在 aspx 页面中显示这个位图呢？

我不知道该怎么做。请帮忙！！:]

谢谢

观察：在 SQL Server 中，列`image`的类型为`varbinary(MAX)`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T17:45:04.027

创建一个返回图像的网页。您将从数据库中选择字节（因为您已经编写了要插入的代码，我想您知道如何选择）。获得字节后，您需要设置 mime 类型并将字节写入响应流。

```
var bytesFromDatabase = getImageFromDatabase();
context.Response.ContentType = "image/jpeg";
context.Response.BinaryWrite(bytesFromDatabase); 
```

**编辑：**

只需在前面提到的 aspx 网页上使用带有源代码的 img 标签。例如：

```
<img src="http://www.example.com/image.aspx?id=1" alt="image" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T17:49:30.367

您需要使用处理程序来执行此操作

读这个，一个很好的例子

[http://www.dotnetcurry.com/ShowArticle.aspx?ID=129](http://www.dotnetcurry.com/ShowArticle.aspx?ID=129)

# ruby-on-rails - 可以为 Ruby-Rack 应用程序服务的服务器管理软件

> ID：11284218
> 
> 赞同：-2
> 
> 时间：2012-07-01T17:34:33.450
> 
> 标签：ruby-on-rails, ruby, sinatra, rack, cpanel

我需要一个 cPanel 替代品，但要支持易于部署的 Ruby-Rack 应用程序，而不仅仅是 Rails。

对我来说，在雪松之后，Heroku 刚刚开始严重失败。他们的停机时间比我 6 月份的计算机停机时间还要长。所以它不再是一个选择。

或者您可以建议一个易于修改的开源套件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:32:13.427

查看[OpenShift](https://openshift.redhat.com/app/)。这是一个 PaaS 系统，类似于 Heroku，是开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:14:26.993

我听说过[Interworx](http://www.interworx.com/ "互联互通")的好消息，它也可以托管 Ruby 应用程序。

# c# - C#同级XML解析

> ID：11284220
> 
> 赞同：0
> 
> 时间：2012-07-01T17:34:37.710
> 
> 标签：c#, xml-parsing, linq-to-xml

我得到了这个 XML 文件：

```
<Msg UserText="start 0">
</Msg>
<Msg UserText="A">
</Msg>
<Msg UserText="A">
</Msg>
<Msg UserText="start 1">
</Msg>
<Msg UserText="A">
</Msg>
<Msg UserText="start 2">
</Msg>
<Msg UserText="A">
</Msg>
<Msg UserText="A">
</Msg>
<Msg UserText="A">
</Msg> 
```

我需要计算每个“开始 x”之间有多少个“A”

即对于上面我会输出：

```
start 0 : 2 
start 1 : 1 
start 2 : 3 
```

我应该如何在 C# 中解决这个问题？我有几个方向，但我确信那里有更简单的方向（例如使用 linq）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:05:13.243

这是一个分组示例：

```
XDocument doc = XDocument.Load("../../XMLFile1.xml");

var groups = from msg in doc.Root.Elements("Msg")
             where !((string)msg.Attribute("UserText")).StartsWith("start")
             group msg by 
             msg.ElementsBeforeSelf("Msg").Where(m => 
                 ((string)m.Attribute("UserText")).StartsWith("start")).Last();

foreach (var group in groups)
{
    Console.WriteLine("Group starting with {0} has {1} member(s).", 
        group.Key.Attribute("UserText"), group.Count());
} 
```

使用 XML 输入示例 XMLFile1.xml

```
<Root>
  <Msg UserText="start 0">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="start 1">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="start 2">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
</Root> 
```

我得到输出

```
Group starting with UserText="start 0" has 2 member(s).
Group starting with UserText="start 1" has 1 member(s).
Group starting with UserText="start 2" has 3 member(s). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:58:56.680

这应该为你做。

```
using System.Collections.Generic;
using System.Xml.Linq;

namespace TraverseXMLNodes
{
    public class Class1
    {
        public static void Main(string[] args)
        {
            XDocument doc = XDocument.Load(@"C:\Udvikling\StackOverflow\TraverseXMLNodesSln\TraverseXMLNodes\XMLFile1.xml");
            var msgs = doc.Element("root").Elements("Msg");

            List<int> numbers = new List<int>();
            List<string> numbersStr = new List<string>();
            int count = 0;
            foreach (var xElement in msgs)
            {
                string value = xElement.Attribute("UserText").Value;
                numbersStr.Add(value);
                if (value.Contains("start"))
                {
                    numbers.Add(count);
                    count = 0;
                }
                else
                {
                    count++;
                }
            }
            numbers.Add(count);
        }
    }
} 
```

我的 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<root>
  <Msg UserText="start 0">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="start 1">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="start 2">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
  <Msg UserText="A">
  </Msg>
</root> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:12:13.723

```
 static void Main(string[] args)
    {
         const string xml = @"<SomeRootTag>
            <Msg UserText='start 0'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
            <Msg UserText='start 1'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
            <Msg UserText='start 2'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
            <Msg UserText='A'>
            </Msg>
        </SomeRootTag>";

        var xDoc = XDocument.Load(new StringReader(xml));
        var msgs = xDoc.Root.Elements().Where(el => el.Name == "Msg").Select(el => el.Attribute("UserText").Value);
        var results = GetCounts(msgs);

        foreach (var keyValue in results)
        {
            Console.WriteLine("{0}:{1}", keyValue.Item1, keyValue.Item2);
        }

        Console.ReadKey();
    }

    private static IEnumerable<Tuple<string,int>> GetCounts(IEnumerable<string> msgs)
    {
        string last = null;
        int count = 0;
        foreach (var msg in msgs)
        {
            if (msg.StartsWith("start"))
            {
                if (last != null)
                {
                    yield return new Tuple<string, int>(last, count);
                }
                count = 0;
                last = msg;
            }
            else
            {
                count++;
            }
        }
        yield return new Tuple<string, int>(last, count);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T18:17:03.070

利用该[`ElementsAfterSelf()`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.elementsafterself.aspx)方法获得以下兄弟姐妹。然后从那里很容易：

```
var root = XElement.Parse(xmlStr);
var query =
    from msg in root.Elements("Msg")
    let message = (string)msg.Attribute("UserText")
    where message.StartsWith("start")
    select new
    {
        Message = message,
        FollowingAs = msg.ElementsAfterSelf("Msg")
            .TakeWhile(e => (string)e.Attribute("UserText") == "A")
            .Count(),
    }; 
```

# python - Python：确定字典中数字最近匹配的优雅方法

> ID：11284223
> 
> 赞同：3
> 
> 时间：2012-07-01T17:34:43.120
> 
> 标签：python

我有一个字典结构，可以将 id（整数）映射为数字（双精度）。这些数字实际上是物品的重量。

我正在编写一个函数，它允许我获取给定权重的 id（如果在 dict 中找到权重，否则，它将返回下一个最接近（即最接近的匹配）权重的**id**。

这是我到目前为止所拥有的：

```
def getBucketIdByValue(bucketed_items_dict, value):
    sorted_keys = sorted(bucketed_items_dict.keys())
    threshold = abs(bucketed_items_dict[sorted_keys[-2]] -bucketed_items_dict[sorted_keys[-1]]) # determine gap size between numbers

    # create a small dict containing likely candidates
    temp = dict([(x - value),x] for x in bucketed_items_dict.values() if abs(x - value) <= threshold)
    print 'DEBUG: Deviations list: ', temp.keys()
    smallest_deviation = min(temp.keys()) if value >= 0 else max(temp.keys()) # Not sure about this ?
    smallest_deviation_key = temp[smallest_deviation]
    print 'DEBUG: found bucketed item key:',smallest_deviation_key
    return smallest_deviation_key 
```

我不确定逻辑是否正确（尤其是我获得最小偏差的地方）。无论如何，即使逻辑是正确的，这似乎也是一种过于复杂的做事方式。有没有更优雅/pythonic的方式来做到这一点？

在我的脑海中，我认为一种更 Pythonic/优雅的方式是做一些事情，比如将自定义函数传递给`min`函数 - 不知道这是否可能......

**[[更新]]**

我正在运行 Python 2.6.5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:40:05.097

尝试按重量与目标值的距离对项目进行排序：

```
from operator import itemgetter
distances = ((k, abs(v - value)) for k, v in bucketed_items_dict.items())
return min(distances, key=itemgetter(1))[0] 
```

或者使用 lambda 函数而不是 itemgetter：

```
distances = ((k, abs(v - value)) for k, v in bucketed_items_dict.items())
return min(distances, key=lambda x:x[1])[0] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T17:45:33.230

```
def getBucketIdByValue(bucket, value):
    distances = [( id , abs( number - value ) ) for id , number in bucket.items()]
    swapped = [( distance , id ) for id , distance in distances]
    minimum = min ( swapped )
    return minimum[1] 
```

或者简而言之：

```
def getBucketIdByValue(bucket, value):
    return min((abs(number-value),id) for id,number in bucket.items())[1] 
```

此函数使用桶创建 id/number 对，然后创建距离/id 对的迭代器，然后获取它的第一个最小对，最后提取该对的 id 并返回它。

距离定义为数字与求值之差的绝对值。

最小值定义为距离最短的对。如果还有更多，则返回具有最低 id 的对。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T17:57:13.717

您可以在排序键中使用 bisect 找到最接近权重的索引：

```
import bisect

def bisect_weight(sorted_keys, value):
    index = bisect.bisect(sorted_keys, value)
    # edge cases
    if index == 0: return sorted_keys[0]
    if index == len(sorted_keys): return sorted_keys[index - 1]
    minor_weight = sorted_keys[index - 1]
    greater_weight = sorted_keys[index]

    return minor_weight if abs(minor_weight - value) < abs(greater_weight - value) else greater_weight 
```

这样你只需要检查 2 个权重并找到最好的一个。排序和二进制搜索可能比计算所有权重并找到最佳权重更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T17:52:35.163

我也会考虑`bisect`模块。

# java - 如何将子节点添加到 n 数组树中的特定节点？

> ID：11284225
> 
> 赞同：5
> 
> 时间：2012-07-01T17:35:02.917
> 
> 标签：java, arrays, search, tree

我写了这个 n 数组树类。我想编写一个方法来将子节点添加到树中的特定节点。

首先，我应该搜索我的树以找到父亲，然后将孩子添加到该节点孩子。我不知道我应该如何声明我的方法

```
public class FamilyNode {
    public String name;
    public String Family;
    public String sex;
    public FamilyNode Father;
    public FamilyNode Mother;
    public FamilyNode Spouse=null;
    public String status="alive";
    public int population;
    public ArrayList<FamilyNode> children=new ArrayList<FamilyNode>() ;

    public FamilyNode(String firstname,String lastname,String sex1){
        this.name=firstname;
        this.Family=lastname;
        this.sex=sex1;
        this.population=this.children.size()+1;
    }

    public void SetParents(FamilyNode father,FamilyNode mother){
        this.Father=father;
        this.Mother=mother;
    }

    public void SetHW(FamilyNode HW){
        this.Spouse=HW;
    }

    public int Number (){
        int number_of_descendants = this.population;

        if(this.Spouse!=null) number_of_descendants++;

        for(int index = 0; index < this.children.size(); index++)
            number_of_descendants = number_of_descendants+ this.children.get(index).Number();
            return number_of_descendants;
    }

    public void AddChild(FamilyNode Father,FamilyNode child){

        //the code here                                         
    }                                        
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:11:04.960

我昨天回答了你的一个[相关问题](https://stackoverflow.com/questions/11275817/need-a-search-method-for-my-treen-ary-tree/11275928#11275928)，所以让我们继续我发布的代码:)

```
public class FamilyNode {
    // ...
    // ...
    public FamilyNode findNodeByName(String nodeName){
       if(name.equals(nodeName)){
          // We found a node named nodeName, return it
          return this;
       } 
       // That's not me that you are looking for, let's see my kids
       for(FamilyNode child : children){
            if(child.findNodeByName(nodeName) != null) 
                // We found what we are looking, just return from here
                return child;
       }
       // Finished looping over all nodes and did not find any, return null
       return null;
    }

    public void addChild(FamilyNode child){
       children.add(child);
    }
} 
```

基本上，您需要找到您要查找的节点（在本例中按名称），这可以通过`findNodeByName`上述方法完成。找到节点后，向其添加一个子节点。

像这样使用此代码：

```
FamilyNode root = ...;
FamilyNode node = root.findNodeByName("Parent");
if(node != null) node.addChild(...); 
```

**注意** 如果要调试和访问所有树节点，请使用以下方法：

```
public FamilyNode findNodeByName(String nodeName){
   System.out.println("Visiting node "+ name);
   // That's not me that you are looking for, let's see my kids
   for(FamilyNode child : children){
     child.findNodeByName(nodeName)
   }
   // Finished looping over all nodes and did not find any, return null
   return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:29:36.050

这不完全是一棵树，因为孩子可能有两个父母，而不仅仅是一个。这是一个有向图。

最好将变量和方法名称更改为与通常的以小写字符开头的 Java 约定一致。

出于数据一致性的考虑，您可以考虑使该`addChild`方法简单地添加到当前节点的子列表中，但在您的`setParents`方法中，更新两个父节点的子列表，将当前节点作为子节点添加到那里，通过调用`father.addChild(this)`and `mother.addChild(this)`（当然要防止它们为空）。

如果父节点在先前设置时可以更改（可能是错误的），您还需要从先前设置的父节点中删除当前节点。为此，您可能需要一种`removeChild(FamilyNode child)`方法。同样为了数据的一致性，这个方法可能还应该将子节点中的相应父字段设置为空。

# node.js - Node.js, nodetuts 教程 - 示例代码将运行，一段时间后超时，（分块 HTTP 编码）

> ID：11284229
> 
> 赞同：3
> 
> 时间：2012-07-01T17:36:27.053
> 
> 标签：node.js

这是针对初学者的节点教程。为什么我的代码不起作用？它与他的相同，我尝试了解决方法但没有成功。如果可以的话请帮忙。

[http://nodetuts.com/tutorials/2-webtail-nodejs-child-processes-and-http-chunked-encoding.html#video](http://nodetuts.com/tutorials/2-webtail-nodejs-child-processes-and-http-chunked-encoding.html#video)

在本教程中，他将一个日志/文本文件写入位于 localhost:4000 的网页中，之前的示例可以正常工作（教程 1），但是我根本无法让它做任何事情，它可以运行，仅此而已。

任何人都可以得到这个打印文件到网页。：） 谢谢！

```
var http = require('http');
var spawn  = require('child_process').spawn;

http.createServer(function(request, response){

    response.writeHead(200, {
        'Content-Type' : 'text/plain'
    });

    var tail_child = spawn('tail', ['-f', '/var/log/system.log']);

    request.connection.on('end', function(){
        tail_child.kill();
    });

    tail_child.stdout.on('data', function(data){
        console.log(data.toString());
        response.write(data);
    });

}).listen(4000); 
```

我尝试了以下方法，它们没有任何区别：

```
 console.log(data.toString());
    response.write(data);
    response.end(); 
```

和

```
 console.log(data.toString());
    response.end(data); 
```

* * *

`MiguelSanchezGonzalez`回答后编辑：

我添加`tail_child.stderr.pipe(process.stdout);`到正确的位置，这是我得到的回应：

```
CreateProcessW: The system cannot find the file specified. 
```

这里确实存在一个文件，我还测试了许多不同的路径，包括与脚本位于同一文件夹中的文本文件（`'/test.txt'`例如。所以也许我错了，我只是假设当它说文件时它在谈论我的文件。

* * *

编辑2：我还检查了路径是否存在（从这里粗略构建）：[检查NodeJs中是否存在文件的最快方法](https://stackoverflow.com/questions/8782908/fastest-way-to-check-for-existence-of-a-file-in-nodejs)，它确实说该文件确实存在。

这段代码：

```
var file = path.normalize = ('var/log/system.log');

    fs.exists(file, function(exists){
        util.debug(exists ? "yep, its there":"nope");
    });

    console.log(file); 
```

输出这个：

```
var/log/system.log
DEBUG: yep, its there 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T15:52:20.093

好的，我对此很陌生，它表明，感谢大家帮助我，我现在找到了原因。我很愚蠢，没有提到我在 Windows 上，我认为这无关紧要，因为我不知道这段代码正在对另一个程序进行外部调用。

是的，我知道，愚蠢的乔，我认为 tail 只是节点中的一个命令，并且没有正确思考。现在这个混乱是有道理的。

`var tail_child = spawn('C:/cygwin/bin/tail.exe', ['-f', 'var/log/system.log']);`

这修复了所有问题，安装 cygwin 并硬链接该二进制文件！我猜这段代码是为 linux/unix 环境设计的，所以我们只需要凑合着做。

我正在和 nodetuts 的作者 (Pedro) 交谈，我提到我在一个 windows 盒子上，Bam 这一切都说得通，代码现在对我来说也更有意义了（我在节点文档上搜索年龄`-f`并且不能'找不到很多。哈哈）

我应该把 windows 放在我的环境描述中。

那好吧。

傻乔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T21:56:27.473

你好约瑟夫，我建议你在你的代码中更改这一行，看看你有什么样的错误

```
http.createServer(function(request, response){

    response.writeHead(200, {
        'Content-Type' : 'text/plain'
    });

    var tail_child = spawn('tail', ['-f', '/var/log/system.log']);

    request.connection.on('end', function(){
        tail_child.kill();
    });

    tail_child.stdout.on('data', function(data){
        console.log(data.toString());
        response.write(data);
    });

    /* Add this line to see the error in your terminal */
    tail_child.stderr.pipe(process.stdout);

}).listen(4000); 
```

这将向您显示错误的描述，也许您的文件系统中没有此文件或者您无法打开它，请尝试将路径文件更改为您知道存在并且可以打开它的其他文件。

# zend-framework - 在 joomla 中使用 zend 框架

> ID：11284234
> 
> 赞同：0
> 
> 时间：2012-07-01T17:37:33.357
> 
> 标签：zend-framework, joomla, joomla1.5

那可能吗？我该怎么做？我已经尝试在插件管理器中安装，但它仍然没有反映在插件屏幕中。任何提示或指南将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T02:06:24.220

Zend 框架作为一个库和一个 MVC 框架工作。

您可以将 Zend Framework 库复制到您的项目中。然后你基本上可以包含你想使用的相关类。

这是一个使用 Zend_Json::encode() 函数的例子：

```
$zend_library_path = 'ZendFramework/library/Zend';
set_include_path ( get_include_path() . PATH_SEPARATOR . $zend_library_path);
include_once('Json.php');

echo Zend_Json::encode( array('hello'=>'world') ); 
```

# java - overridePendingTransition 仅显示进入动画

> ID：11284238
> 
> 赞同：3
> 
> 时间：2012-07-01T17:38:22.513
> 
> 标签：java, android, android-layout, android-activity, android-animation

当用户更改语言区域设置时，我想使用新的区域设置重新加载活动。我想在完成 Activity 并再次启动它时创建一个动画过渡。

过渡动画如下：

退出动画是将活动缩放到屏幕中心。进入动画是从屏幕中心缩放活动。

```
finish();
overridePendingTransition(0, R.anim.scale_to_center);
Intent intent =new Intent(SettingsActivity.this, SettingsActivity.class);
startActivity(intent);
overridePendingTransition(R.anim.scale_from_center, 0); 
```

我`scale_to_center.xml`的是：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <scale android:fromYScale="1.0" android:toYScale="0"
        android:fromXScale="1.0" android:toXScale="0" 
        android:pivotX="50%" android:pivotY="50%"
        android:duration="500"/>
</set> 
```

我`scale_from_center.xml`的是：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <scale android:fromYScale="0" android:toYScale="1.0"
        android:fromXScale="0" android:toXScale="1.0" 
        android:pivotX="50%" android:pivotY="50%"
        android:startOffset="500"
        android:duration="2000"/>
</set> 
```

问题是只有进入转换出现，退出转换不出现。我试图在退出转换中添加延迟，但它也不起作用。

但是，当我将代码更改为仅动画应用程序的退出时。有效。

```
finish();
overridePendingTransition(0, R.anim.scale_to_center); 
```

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T18:43:29.900

在方法上设置两个动画并在您`overridePendingTransition`调用完成**后**`startActivity`调用：

```
Intent intent = new Intent(SettingsActivity.this, SettingsActivity.class);
startActivity(intent);
overridePendingTransition(R.anim.scale_from_center, R.anim.scale_to_center);
finish(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T17:05:03.880

它在这里也不起作用。我修复了它，创建了一个 null_animation.xml：

```
<translate xmlns:android="http://schemas.android.com/apk/res/android"
android:duration="@android:integer/config_mediumAnimTime"
android:fromYDelta="0%p"
android:toYDelta="0%p" /> 
```

# java - 为什么在 Java 中将 Integer 添加到 String 数组不会产生编译错误？

> ID：11284243
> 
> 赞同：1
> 
> 时间：2012-07-01T17:38:43.390
> 
> 标签：java

为什么我尝试将 an 添加`Integer`到 Java 数组（声明为 an`Object[]`但实例化为 a `String[]`）不会产生编译错误？

```
Object[] ob = new String[1];
ob[0] = new Integer(1); // this shouldn’t compile but it does! 
```

当我运行它时，我得到一个运行时异常，而不是一个（非常喜欢的）编译时错误！这是正确的行为吗？我不应该得到一个编译时错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:45:38.287

这是 Java 设计人员做出的选择：`String[]`extends `Object[]`，但是除了 a 之外，您不能将任何其他内容添加到*具体*类型为没有运行时异常`String`的数组中。*`String[]`*

 *他们可能使无效的是以下内容：

```
Object[] ob = new String[1]; 
```

因为它有效地允许将任何类型的对象添加到数组中而不会出现任何编译器错误（如您所见），这是完全正常的，因为 Integer*是*Object，并且数组的*编译时*类型是`Object[]`.

他们没有为数组做出这个选择，但他们为泛型集合做了这个选择：

```
List<Object> ob = new ArrayList<String>(); 
```

生成编译器错误，因为`List<String>`不扩展`List<Object>`. 集合通常应该优先于数组，因为它们更安全，并且提供更多功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T18:46:44.410

您可能需要考虑的要点是引用数组的运行时类型 ( `String[]`) 与数组变量的编译时类型 ( `Object[]`)。编译器仅强制您放入数组的内容与引用它的数组变量的静态类型兼容。这个例子使它脱颖而出：

```
String[] strs = new String[1]; 
Object[] objs = strs; 
strs[0] = new Integer(1); /* error, says the compiler! */ 
objs[0] = new Integer(1); /* fine by me, says the compiler! */ 
```

现在，你理所当然地应该对你的第一行感到不安：`Object[] ob = new String[1];`这意味着它`String[]`与赋值兼容`Object[]`——换句话说，它的子类型。这与 CS 中众所周知的事实相反，即容器类型在其元素的类型上是逆变的。为什么Java不是这样？我曾经读过一个帐户，其中有人问 James Gosling，他回答说他们知道事实，但想要一种简单的方法让 Java 方法能够接受任何类型的数组（通过`Object[]`类型）。这源于对 Java 成为“蓝领语言”的要求，而不是陷入类型理论的精确性，这会带来自己的心理包袱。见证泛型`<? super String>`和 Scala 的协变/逆变位置规则。*

# ruby-on-rails - 如何保存用户偏好

> ID：11284246
> 
> 赞同：0
> 
> 时间：2012-07-01T17:39:15.030
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, devise, mongoid

我有一个应用程序，现在，我需要保存用户的偏好。
我做了以下事情：

```
class User
  include Mongoid::Document
  include Mongoid::Timestamps

  embeds_one :setting
end 
```

和

```
class Setting
  include Mongoid::Document
  include Mongoid::Timestamps

  belongs_to :user

  field :notify, type: Boolean
end 
```

问题是：如何制作表格来保存用户的偏好？我根本不知道......
任何事情都值得赞赏:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:52:51.753

```
form_for current_user.settings || current_user.build_settings 
```

同时创建控制器

```
class SettingsController < ApplicationController
  def create
    settings = Settings.new params[:settings]
    if settings.save
      flash[:notice] = 'Settings saved'
    else
      flash[:error] = 'Settings could not be saved'
    end
    redirect_to :back
  end

  def update
    settings = Settings.find params[:id]
    if settings.update_attributes params[:settings]
      flash[:notice] = 'Settings saved'
    else
      flash[:error] = 'Settings could not be saved'
    end
    redirect_to :back
  end
end 
```

# c++ - 填充未知大小的 std::vector 的最快方法

> ID：11284251
> 
> 赞同：1
> 
> 时间：2012-07-01T17:39:51.910
> 
> 标签：c++, memory-management, stdvector

我有一长串数据（*n 个*实体）。这个数组中的每个对象都有一些值（比如说，一个对象的*m*个值）。我有一个像这样的循环：

```
myType* A; 

// reading the array of objects   
std::vector<anotherType> targetArray;
int i, j, k = 0;
for (i = 0; i < n; i++)
     for (j = 0; j < m; j++)
     { 
         if (check((A[i].fields[j]))
         {
             // creating and adding the object to targetArray
             targetArray[k] = someGenerator(A[i].fields[j]);
             k++;
         }
     } 
```

在某些情况下，我有*n* * *m*有效对象，在某些 ( *n* * *m* ) /10 或更少。
问题是如何分配内存`targetArray`？

1.  > `targetArray.reserve(n*m);
    > // Do work
    > targetArray.shrink_to_fit();`

2.  在不生成对象的情况下计算元素，然后根据需要分配尽可能多的内存并再循环一次。

3.  在每次创建新对象的迭代中调整数组的大小。

我在我的每一种方法中都看到了一个巨大的战术错误。有另一种方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T17:55:56.650

您在这里所做的称为过早优化。默认情况下，`std::vector`它将以指数方式增加其内存占用，因为它耗尽内存来存储新对象。例如，第一个`push_back`将分配 2 个元素。第三个`push_back`将使大小加倍等。坚持`push_back`并让您的代码正常工作。

只有当上述方法证明自己是您设计中的瓶颈时，您才应该开始考虑内存分配优化。如果发生这种情况，我认为最好的办法是为许多有效对象提供一个很好的近似值，然后调用`reserve()`一个向量。类似于您的第一种方法。只需确保您的缩小以适应实现是正确的，因为向量不喜欢缩小。你必须使用`swap`.

在每一步都调整数组大小是不好的，`std::vector`除非你努力尝试，否则不会真正做到这一点。

对对象列表进行额外的循环可能会有所帮助，但也可能会造成伤害，因为您很容易浪费 CPU 周期、膨胀 CPU 缓存等。如果有疑问 - 对其进行分析。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T17:44:14.823

典型的方法是使用 targetArray.push_back()。这会在需要时重新分配内存，并避免两次通过您的数据。它有一个重新分配内存的系统，使其非常高效，随着向量变大，重新分配的次数更少。

但是，如果您的 check() 函数非常快，您可能会通过两次检查数据来获得更好的性能，确定您需要多少内存并让您的向量一开始就具有正确的大小。如果分析确定确实有必要，我只会这样做。

# php - PHP如何从右侧提取字符串？

> ID：11284255
> 
> 赞同：4
> 
> 时间：2012-07-01T17:40:38.930
> 
> 标签：php, regex

您好有这个 URL 字符串，我可能需要使用正则表达式来提取它，但需要从右侧到左侧进行提取。例如：

```
http://localhost/wpmu/testsite/files/2012/06/testimage.jpg 
```

我需要提取这部分：

```
2012/06/testimage.jpg 
```

如何才能做到这一点？提前致谢...

更新：由于只有 URL 中的“文件”是常量，我想提取“文件”之后的所有内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T17:55:04.187

您不一定需要使用正则表达式。

```
$str = 'http://localhost/wpmu/testsite/files/2012/06/testimage.jpg';
$result = substr( $str, strpos( $str, '/files/') + 7); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:51:50.693

这将为您提供文件后的所有内容：

```
$string = 'http://localhost/wpmu/testsite/files/2012/06/testimage.jpg';
preg_match('`files/(.*)`', $string, $matches);
echo $matches[1]; 
```

**更新：** 但我认为 Doug Owings 的解决方案会快很多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T17:45:54.977

使用 explode() 并选择最后 3 个（或基于您的逻辑）部分。零件的数量可以通过找到元素的数量来确定

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T17:46:01.560

```
$matches = array();
$string = 'http://localhost/wpmu/testsite/files/2012/06/testimage.jpg';
preg_match('/files\/(.+)\.(jpg|gif|png)/', $string, $matches);
echo $matches[1]; // Just the '2012/06/testimage.jpg' part 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T17:57:00.043

不需要正则表达式：

```
function getEndPath($url, $base) {
    return substr($url, strlen($base));
} 
```

此外，通过指定级别返回 url 路径的结尾部分的更通用的解决方案：

```
/**
 * Get last n-level part(s) of url.
 *
 * @param string $url the url
 * @param int $level the last n links to return, with 1 returning the filename
 * @param string $delimiter the url delimiter
 * @return string the last n levels of the url path
 */ 
function getPath($url, $level, $delimiter = "/") {
    $pieces = explode($delimiter, $url);
    return implode($delimiter, array_slice($pieces, count($pieces) - $level));
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-01T17:57:59.490

我喜欢爆炸的简单解决方案（如 knightrider 建议的那样）：

```
$url="http://localhost/wpmu/testsite/files/2012/06/testimage.jpg";
function getPath($url,$segment){
          $_parts = explode('/',$url);

                  return join('/',array_slice($_parts,$segment));
}

echo getPath($url,-3)."\n"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-01T17:43:24.807

您需要检查的是我认为的这个功能：

[http://php.net/manual/en/function.substr.php](http://php.net/manual/en/function.substr.php)

如果“http://localhost/wpmu/testsite/files/”部分是稳定的，那么你就知道要去掉哪个部分。

# asp.net - 使用 ksoap2 将 Android 应用程序连接到 ASP .NET Web 服务时出错

> ID：11284261
> 
> 赞同：0
> 
> 时间：2012-07-01T17:41:46.003
> 
> 标签：asp.net, web-services, soap, ksoap2, android-ksoap2

我正在尝试将我的应用程序连接到我在**ASP**中创建并且当前正在运行的 Web 服务`localhost`。该应用程序正在尝试访问`Coordonate`接受 3 个整数的方法。

我已经提供了代码和**LogCat**。我不得不提一下，我是 Web 服务的新手。

任何帮助将不胜感激！干杯!

**代码：**

```
package Dan.Denver.Nuggets.googleMaps;

import android.app.Activity;
import android.app.AlertDialog;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.SeekBar;
import android.widget.Toast;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.TextView;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

public class SlideBar extends Activity
{
SeekBar seekBar;
TextView textView;
Button sendButton;

private static final String SOAP_ACTION = "http://tempuri.org/Coordonate";
private static final String METHOD_NAME = "Coordonate";
private static final String NAMESPACE = "http://tempuri.org/";
private static final String URL = "http://localhost:49934/Service1.asmx";

SoapObject request;
SoapSerializationEnvelope soapEnvelope;
HttpTransportSE transport;
SoapPrimitive rezultat;

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.slidebar);
    textView = (TextView)findViewById(R.id.textView); 
    sendButton = (Button)findViewById(R.id.bSB);

    seekBar = (SeekBar)findViewById(R.id.sbSB);
    seekBar.setMax(100);
    seekBar.setProgress(1);

    seekBar.setOnSeekBarChangeListener(new OnSeekBarChangeListener() 
    {   
        public void onStopTrackingTouch(SeekBar seekBar)
        {
            // TODO Auto-generated method stub
        }

        public void onStartTrackingTouch(SeekBar seekBar)
        {
            // TODO Auto-generated method stub
        }

        public void onProgressChanged(SeekBar seekBar, int progress,
                boolean fromUser) 
        {
            textView.setText(String.valueOf(progress + "%"));
//              if(progress >= 25 && progress < 50)
//                  textView.setTextColor(R.color.Yellow);
//              else if(progress >= 50 && progress < 75)
//                  textView.setTextColor(R.color.Orange);
//              else if(progress >= 75 && progress <= 100)
//                  textView.setTextColor(R.color.Red);
//              else 
//                  textView.setTextColor(R.color.Green);   
        }
    });

    sendButton.setOnClickListener(new View.OnClickListener() 
    {   
        public void onClick(View v) 
        {
            // TODO Auto-generated method stub
            //Toast.makeText(getBaseContext(), "Drumul este congestionat in proportie de "+textView.getText().toString(), Toast.LENGTH_LONG).show();
            request = new SoapObject(NAMESPACE, METHOD_NAME);
            request.addProperty("latitudine", Main.latitudine);
            request.addProperty("longitudine", Main.longitudine);
            request.addProperty("procentTrafic", seekBar.getProgress());

            soapEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            soapEnvelope.dotNet = true;
            soapEnvelope.setOutputSoapObject(request);

            transport = new HttpTransportSE(URL);
            try
            {
                transport.call(SOAP_ACTION, soapEnvelope);
                rezultat = (SoapPrimitive)soapEnvelope.getResponse();
                Toast.makeText(getBaseContext(), rezultat.toString(), Toast.LENGTH_LONG).show();
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }           
        }
    });
}
} 
```

**日志猫：**

```
07-01 17:11:56.790: E/AndroidRuntime(1029): FATAL EXCEPTION: main
07-01 17:11:56.790: E/AndroidRuntime(1029): java.lang.NoClassDefFoundError: org.ksoap2.serialization.SoapObject
07-01 17:11:56.790: E/AndroidRuntime(1029):     at Dan.Denver.Nuggets.googleMaps.SlideBar$2.onClick(SlideBar.java:80)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.view.View.performClick(View.java:2408)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.view.View$PerformClick.run(View.java:8816)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.os.Handler.handleCallback(Handler.java:587)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.os.Looper.loop(Looper.java:123)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at android.app.ActivityThread.main(ActivityThread.java:4627)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at java.lang.reflect.Method.invokeNative(Native Method)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at java.lang.reflect.Method.invoke(Method.java:521)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-01 17:11:56.790: E/AndroidRuntime(1029):     at dalvik.system.NativeStart.main(Native Method)
07-01 17:12:00.229: I/Process(1029): Sending signal. PID: 1029 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T07:39:41.703

尝试在下一行中将 localhost 替换为您系统的 IP 地址。

```
private static final String URL = "http://localhost:49934/Service1.asmx"; 
```

这可能会帮助你。

即使您在同一系统上运行的模拟器上对其进行测试，那么在某些情况下，asp.net 和 android 的 localhost 也可能具有不同的 IP 可能为 10.0.2.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T02:25:01.047

我之前也遇到过类似的问题。请查看[How to call a local .NET web service from an Android Application](https://stackoverflow.com/questions/7860887/how-to-call-a-local-web-service-from-an-android-mobile-application)。

希望能帮助到你

# facebook-graph-api - 通过 php 将照片上传到相册和 facebook 中的墙。所以我们在墙上得到了一张大图

> ID：11284262
> 
> 赞同：2
> 
> 时间：2012-07-01T17:41:59.200
> 
> 标签：facebook-graph-api, facebook-php-sdk, photo

我设法将照片从我的服务器发送到 Facebook 上的用户相册。但是这张照片并没有自动出现在他的墙上。特别是它不被视为一张大照片，就像相册中的照片如何显示在墙上一样。

所以我想我必须做第二个请求，告诉 Facebook 把照片放在墙上。

我有这两个要求：

```
$ret_obj = $facebook->api('/me/photos', 'POST',
  array(
    'source' => '@/var/www/cover/test.jpg',
    'message' => $_POST['msg']
  )
); 
```

例如返回：[id] => 358313274248558 [post_id] => 100001736648729_358281023575116

```
$ret_obj = $facebook->api('/me/feed', 'POST',
  array(
    'message' => $_POST['msg'],
    'object_attachment' => $ret_obj['id']
  )
); 
```

我已经尝试过'object_attachment' 358313274238558、100001796648729_358281027575116 和 358281027575116。但 facebook 告诉我这些都不正确。

那么到底如何才能将照片添加到墙上，我们只是将其放入相册中，并且我们希望以大格式（而不是小缩略图）显示它。

如果有另一种方法，不使用专辑，那对我来说很好。

请帮忙。我知道已经有一些关于在 stackoverflow 上将照片上传到 facebook 的问题，我想我已经阅读了大约 10 次。似乎还没有答案。有人说我们可以发布到 /me/links 但 facebook 似乎无法处理像 http(s)://www.facebook.com/photo.php?fbid=358309510905631 这样的链接了。

我已经更改了这篇文章中的 ID，因此它们与实际内容无关，它们在这里作为示例。

谢谢

* * *

编辑：

> **好吧，如果用户允许应用程序执行公共内容**，则似乎将图像发布到相册也是将大图像发布到墙上。因为我在开发，所以我告诉这个应用不要做公开的东西，只向我个人展示东西。
> 
> 因此，无需执行 2 个请求，只需向相册添加一张照片就足以让它在用户墙上显得很大，如果用户允许公开应用活动。
> 
> 仍然有些令人困惑的是，第二个请求似乎也无法将大尺寸的照片添加到墙上。

# linux - sed 的奇怪输出

> ID：11284263
> 
> 赞同：0
> 
> 时间：2012-07-01T17:42:05.993
> 
> 标签：linux, bash, sed

我有一些 html 文件，并且只想提取包含这些标签的行：

```
head
p 
```

我用 sed 来提取这部分文件，如下：

```
grep "<head>" myfile.html | sed -e 's%\(head\)\(.*\)\(/head\)%title\2\/title%'

grep "<p>" myfile.html | sed -e 's%\(<p>\)\(.*\)\(</p\)\(>\)%\2\\%' 
```

一切都很好，但我在每行的末尾都有“\”字符。我怎样才能克服这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:48:14.813

在此命令中，您通过包含双反斜杠来告诉它添加反斜杠：

```
sed -e 's%\(<p>\)\(.*\)\(</p\)\(>\)%\2\\%' 
```

尝试删除反斜杠：

```
sed -e 's%\(<p>\)\(.*\)\(</p\)\(>\)%\2%' 
```

此外，您不需要`grep`：

```
sed -ne '/<p>/{s%\(<p>\)\(.*\)\(</p\)\(>\)%\2%;p}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T17:48:29.953

不要在替换字符串的末尾使用 \：

```
grep "<p>" myfile.html | sed -e 's%\(<p>\)\(.*\)\(</p\)\(>\)%\2%' 
```

# java - 尝试 getStringArray 时出现 NullPointerException

> ID：11284264
> 
> 赞同：0
> 
> 时间：2012-07-01T17:42:41.157
> 
> 标签：java, android, nullpointerexception

以下是相关代码：

```
...
Resources res;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.variable);

    res = getResources();
    ...
}

protected void setup() {
    String text = res.getStringArray(R.array.categories)[4];
} 
```

这可能是什么原因造成的？日志猫：

```
07-01 13:37:01.988: E/AndroidRuntime(13905): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.centauri.equations/com.centauri.equations.activity.physics.WorkActivity}: java.lang.NullPointerException
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.os.Looper.loop(Looper.java:137)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread.main(ActivityThread.java:4424)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at java.lang.reflect.Method.invokeNative(Native Method)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at java.lang.reflect.Method.invoke(Method.java:511)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at dalvik.system.NativeStart.main(Native Method)
07-01 13:37:01.988: E/AndroidRuntime(13905): Caused by: java.lang.NullPointerException
07-01 13:37:01.988: E/AndroidRuntime(13905):    at com.centauri.equations.activity.physics.WorkActivity.setup(WorkActivity.java:119)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at com.centauri.equations.activity.Categories.onCreate(Categories.java:95)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at com.centauri.equations.activity.physics.WorkActivity.onCreate(WorkActivity.java:34)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.Activity.performCreate(Activity.java:4465)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
07-01 13:37:01.988: E/AndroidRuntime(13905):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
07-01 13:37:01.988: E/AndroidRuntime(13905):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:57:40.910

> 似乎由于某种原因 res 为空

根据您发布的内容，我敢打赌您正在调用 setup() 以初始化 res ... 将您的代码更改为：

```
res = getResources();
setup(); 
```

# java - 序列化 CookieManager/CookieStore

> ID：11284266
> 
> 赞同：3
> 
> 时间：2012-07-01T17:43:03.460
> 
> 标签：java, cookies

我正在制作一个访问网站的 Java 程序，这取决于分发 cookie，以便我可以登录。我发现使用 CookieManager 将允许我的 URLConnection 至少收集这些 cookie，但是我怎么拥有当java程序关闭时，这些cookies仍然存在吗？

我已经有一个类来管理一些变量的序列化，那么如何在这个序列化过程中实现 cookie？默认情况下，Java 显然不允许我序列化 CookieManager 和 CookieStore。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T17:44:18.233

您可以扩展 CookieManager 并使其实现可序列化。然后使用您刚刚创建的扩展 CookieManager。

例如：

```
public class NewCookieManager extends CookieManager implements Serializable{
  //Code here...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-08T01:40:13.093

您可以使用 cookie 管理器将所有 cookie 标头保存在可序列化的映射中。您可以调用该`put`方法使其再次解析 cookie 标头。

```
public class KeepHeadersCookieManager extends CookieManager {

    private Map<URI, Map<String, List<String>>> cookieHeaders = new HashMap<>();

    public KeepHeadersCookieManager() {
    }

    public KeepHeadersCookieManager(Map<URI, Map<String, List<String>>> cookieHeaders) throws IOException {
        for (URI u : cookieHeaders.keySet()) {
            put(u, cookieHeaders.get(u));
        }
    }

    @Override
    public void put(URI uri, Map<String, List<String>> responseHeaders) throws IOException {
        super.put(uri, responseHeaders);

        Map<String, List<String>> uriCookiesHeaders = cookieHeaders.computeIfAbsent(uri, u -> new HashMap<>());
        List<String> uriSetCookieHeaders = uriCookiesHeaders.computeIfAbsent("Set-Cookie", h -> new ArrayList<>());
        List<String> uriSetCookie2Headers = uriCookiesHeaders.computeIfAbsent("Set-Cookie2", h -> new ArrayList<>());
        List<String> setCookieHeaders = responseHeaders.getOrDefault("Set-Cookie", new ArrayList<>());
        List<String> setCookie2Headers = responseHeaders.getOrDefault("Set-Cookie2", new ArrayList<>());
        uriSetCookieHeaders.addAll(setCookieHeaders);
        uriSetCookie2Headers.addAll(setCookie2Headers);
    }

    public Map<URI, Map<String, List<String>>> getCookieHeaders() {
        return cookieHeaders;
    }
} 
```

这样，您可以调用 getCookieHeaders() 来获取所有 cookie 标头的可序列化映射，并将其传递回构造函数以从先前的状态初始化 cookie 管理器。

# c++ - C ++在构造函数中更改类型？

> ID：11284268
> 
> 赞同：4
> 
> 时间：2012-07-01T17:43:05.493
> 
> 标签：c++, class, types, polymorphism

我有一个抽象类`Engine3D`，它的结构（`Vector3D`等）在头文件中。

现在，我有该类的实现，`ConcreteEngine3D : Engine3D`. 此外，我还有其他类似的类`ConcreteVector3D : Vector3D`具有将在内部使用的其他成员和方法`ConcreteEngine3D`（为了这个示例，假设它是`float length`and `calculateLength()`）。

在 main.cpp 我有代码：

```
#include "ConcreteEngine3D.h"
Engine3D * engine;
...
int main(){
    engine = new ConcreteEngine3D();
    Vector3D* vector = new Vector3D(engine, 10, 5, 2);
} 
```

**我希望变量`vector`是 type `ConcreteVector3D*`。**

我将需要该类型`ConcreteEngine3D`，但在 main.cpp 中，我什至不应该知道它是那种类型，也不必使用扩展字段，如`length`. 另外，我不能在 main.cpp 中使用任何具体来自 ConcreteEngine3D.h（仅 Engine3D.h）的东西 - 这是为了灵活，更改实现必须意味着仅更改包含和符合`new ConcreteEngine3D()`.

**我不想修改上面的代码或`Engine3D`.**

在我的构造函数中，`Vector3D`我总是放置一个指向`Engine3D`对象的指针（我在这里给出`ConcreteEngine3D`类型）。

**也许我可以在构造函数中做些什么`Vector3D`来改变它的类型？**

例如`Vector3D* Engine3D::convert(Vector3D v)`在构造函数内部调用，它将继承自`Engine3D`in `ConcreteEngine3D`（它创建一个`ConcreteVector3D`带有字段的新对象`Vector3D`并返回它）。

当然，该代码不起作用：

```
Vector3D::Vector3D(Engine3D *engine){
    //how to 'return' or 'convert' the type to the one that returns engine->convert(this);
} 
```

所以基本上，我想得到下面代码的效果，但没有`vector = engine->convert(vector)`or行`Vector3D* vector2 = new ConcreteVector3D(engine, 10, 5, 2)`。

```
#include "ConcreteEngine3D.h"
Engine3D * engine;
...
int main(){
    engine = new ConcreteEngine3D();
    Vector3D* vector = new Vector3D(engine, 10, 5, 2); //produces Vector3D, not ConcreteVector3D
    vector = engine->convert(vector); //cannot be here! but creates the right object
    Vector3D* vector2 = new ConcreteVector3D(engine, 10, 5, 2); //also creates rights object, but cannot be here!
} 
```

另外，我不想在`Engine3D`or中使用工厂`ConcreteEngine3D`。我想允许“用户”`Vector3D`按照我在第一个代码中编写的方式创建。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:53:13.990

听起来您想使用抽象工厂模式来实例化您的对象，这样您就不必直接调用具体类的构造函数。然后，如果您想更改实现接口的具体类型，您只需要链接到抽象工厂的不同实现，或者在运行时选择合适的工厂实现。

编辑：错过了“不想使用工厂”...无论如何，您将需要某种重定向，因为构造函数将返回您实例化的类型。您可以获得的最接近的可能是为类 Vector3D 创建一个静态工厂方法“create”，该方法返回一个指向 Vector3D 的指针，但在内部创建一个具体实现类的实例。如果您这样做，最好将 Vector3D 的构造函数设为私有，以防止以“错误的方式”创建向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T21:01:23.137

Andrew Tomazos，关于不清楚的文字 - 抱歉：/

我必须同意 Giraffe 船长的观点，即如果不对main.cpp进行**任何更改，我就无法实现它。**我使用了稍微修改的工厂模式：

我必须制作 Vector3D::create() 静态函数，它将调用 Engine3D::convert() 并返回它的结果。所以代码将是：

```
#include "ConcreteEngine3D.h"
Engine3D * engine;
...
int main(){
    engine = new ConcreteEngine3D();
    Vector3D vector = Vector3D::create(engine, 10, 5, 2);
} 
```

Vector3D::create 内部：

return engine->convert(new Vector3D(x,y,z));

这将产生 ConcreteVector3D（因为引擎是 ConcreteEngine3D 类型）。

main.cpp 中的最小更改，可接受（main.cpp 中未提及 ConcreteVector3D）。

再次**感谢大家的帮助，谢谢！**:-)

# php - PHP - 数组中的新对象

> ID：11284269
> 
> 赞同：0
> 
> 时间：2012-07-01T17:43:11.203
> 
> 标签：php, arrays, class

```
class Player 
{
    public $name;
    public $stack;
    public $action;

    public function __construct($stack, $action)
    {
        $this->action = $action;
        $this->stack = $stack;
    }

}

class Hand
{
    public $BB;
    public $SB;
    public $ante;
    public $isSB = TRUE;
    public $hero = 1;

    public $players = array(
        new Player(1800,200);
        new Player(2000,0);
        new Player(2400,100);
        new Player(2600,200);
    );

}

$h = new Hand();
echo $h->players[$h->hero]->stack; 
```

我得到了解析错误。解析错误：语法错误，意外的 T_NEW，期待 ')' in... 如何将对象添加到此数组？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:02:03.390

您需要将其移至构造函数

```
class Hand
{
    public $BB;
    public $SB;
    public $ante;
    public $isSB = TRUE;
    public $hero = 1;

    public $players ;

    public function __construct()
    {
        $this->players = array(
           new Player(1800,200),
           new Player(2000,0),
           new Player(2400,100),
           new Player(2600,200),
        );
    }

} 
```

# extjs - Ext JS 4：在 Ext JS 4 中重用 radiogroup 类

> ID：11284278
> 
> 赞同：0
> 
> 时间：2012-07-01T17:44:35.167
> 
> 标签：extjs, extjs4, radio-button, radio-group

我正在尝试重用我创建的 radiogroup 类，但我似乎无法让它工作。这是我的代码：

**应用程序.js**

```
Ext.Loader.setConfig({
  enabled: true
});

Ext.application({
  name: 'Test',
  appFolder: 'app',
  controllers: ['RadioController'],
  launch: function() {
    Ext.create('Ext.Viewport', {
      layout: 'border',
      items: [{
        xtype: 'panel',
        region: 'center',
        title: 'buttons',
        items: [{
          xtype: 'form',
          items: [{
            xtype: 'radiobuttons',
            fieldLabel: 'group 1',
            //name: '1',
            defaults: {
              name: 'button1'
            }
          }, {
            xtype: 'radiobuttons',
            fieldLabel: 'group 2',
            //name: '2',
            defaults: {
              name: 'button2'
            }
          }]
        }]
      }]
    });
  }
}); 
```

**RadioController.js**

```
Ext.define('Test.controller.RadioController', {
  extend: 'Ext.app.Controller',
  models: [],
  stores: [],
  views: ['RadioButtons'],
  init: function() {
  }
}); 
```

**RadioButtons.js**

```
Ext.define('Test.view.RadioButtons', {
  extend: 'Ext.form.RadioGroup',
  alias: 'widget.radiobuttons',
  items: [{
    boxLabel: 'radio 1',
    inputValue: 'radio 1'
  }, {
    boxLabel: 'radio 2',
    inputValue: 'radio 2'
  }]
}); 
```

发生的情况是，页面被加载，一切看起来都正确。但是，当我单击“组 1”中的单选按钮，然后单击“组 2”中的单选按钮时，我会丢失“组 1”中单击的按钮。我认为单选按钮使用“名称”属性，如果它们具有不同的名称属性，它们基本上会在不同的组中......因此，我不应该丢失组 1 的单击按钮。基本上，我试图通过重用我制作的类来创建[这个 jsfiddle 代码。](http://jsfiddle.net/JbUk8/3/)这可能吗？

值得注意的是，如果我使用类的代码代替使用类，我可以获得我的结果，但这不是好的做法，因为这是类试图消除的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:01:53.343

这对我有用……感谢 Sencha 论坛上的 bizcasfri。

**RadioButtons.js**

```
Ext.define('RadioButtons', {
  extend : 'Ext.form.RadioGroup',
  alias  : 'widget.radiobuttons',
  constructor: function (config) {
    Ext.apply(this, {
      defaults: {
        xtype: 'radio',
        name: config.name
      },
      items: [
        {
          boxLabel: 'Radio 1',
          inputValue: '1'
        },
        {
          boxLabel: 'Radio 2',
          inputValue: '2'
        }
      ]
    });
    this.callParent(arguments);
  }
}); 
```

**应用程序.js**

```
Ext.Loader.setConfig({
  enabled: true
});

Ext.application({
  name: 'Test',
  appFolder: 'app',
  launch: function() {
    Ext.create('Ext.Viewport', {
      layout: 'border',
      items: [{
        xtype: 'panel',
        region: 'center',
        title: 'buttons',
        items: [{
          xtype: 'form',
          items: [{
            xtype: 'radiobuttons',
            fieldLabel: 'group 1',
            name: 'radiogroup1'
          }, {
            xtype: 'radiobuttons',
            fieldLabel: 'group 2',
            name: 'radiogroup2'
          }]
        }]
      }]
    });
  }
}); 
```

请注意 RadioButtons 类中的构造函数方法……这就是诀窍！

# system.reactive - “速率限制”消耗 Observable 的最佳方法是什么？

> ID：11284279
> 
> 赞同：6
> 
> 时间：2012-07-01T17:44:45.917
> 
> 标签：system.reactive

我有一堆事件进来，我必须毫无损失地执行所有这些事件，但我想确保它们在适当的时间段被缓冲和消耗。有人有解决方案吗？

我在 Rx 中找不到任何可以在不丢失事件的情况下做到这一点的操作员（Throttle - 丢失事件）。我也考虑过缓冲、延迟等...找不到好的解决方案。

我试图在中间放一个计时器，但不知何故它根本不起作用：

```
GetInitSequence()
            .IntervalThrottle(TimeSpan.FromSeconds(5))
            .Subscribe(
                item =>
                    {
                        Console.WriteLine(DateTime.Now);
                        // Process item
                    }
            );

public static IObservable<T> IntervalThrottle<T>(this IObservable<T> source, TimeSpan dueTime)
    {
        return Observable.Create<T>(o =>
            {
                return source.Subscribe(x =>
                    {
                        new Timer(state => 
                            o.OnNext((T)state), x, dueTime, TimeSpan.FromMilliseconds(-1));
                    }, o.OnError, o.OnCompleted);
        });
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-01T21:55:07.900

这个问题不是 100% 清楚的，所以我在做一些假设。

`Observable.Delay`不是您想要的，因为这会在每个事件到达时产生延迟，而不是为处理创建均匀的时间间隔。

`Observable.Buffer`不是您想要的，因为这将导致每个给定时间间隔内的所有事件都传递给您，而不是一次一个。

因此，我相信您正在寻找一种解决方案，该解决方案可以创建某种*节拍器*，并在每个节拍时为您提供一个事件。这可以使用节拍器简单地构建并将**其**连接到您的源：`Observable.Interval``Zip`

```
var source = GetInitSequence();
var trigger = Observable.Interval(TimeSpan.FromSeconds(5));    
var triggeredSource = source.Zip(trigger, (s,_) => s); 
triggeredSource.Subscribe(item => Console.WriteLine(DateTime.Now)); 
```

这将每 5 秒触发一次（在上面的示例中），并按顺序为您提供原始项目。

此解决方案的唯一问题是，如果您在（例如）10 秒内没有更多源元素，则当源元素到达时，它们将立即被发送出去，因为一些“触发”事件正坐在那里等待它们. 该场景的大理石图：

```
source:  -a-b-c----------------------d-e-f-g
trigger: ----o----o----o----o----o----o----o
result:  ----a----b----c-------------d-e-f-g 
```

这是一个非常合理的问题。这里已经有两个问题可以解决：

[Rx IObservable 缓冲以消除突发事件](https://stackoverflow.com/questions/4505529/rx-iobservable-buffering-to-smooth-out-bursts-of-events)

[一种以均匀间隔推送缓冲事件的方法](https://stackoverflow.com/questions/4123178/a-way-to-push-buffered-events-in-even-intervals)

提供的解决方案是主要`Drain`扩展方法和次要`Buffered`扩展。我已将这些修改得更简单（不需要`Drain`，只需使用`Concat`）。用法是：

```
var bufferedSource = source.StepInterval(TimeSpan.FromSeconds(5)); 
```

扩展方法`StepInterval`：

```
public static IObservable<T> StepInterval<T>(this IObservable<T> source, TimeSpan minDelay)
{
    return source.Select(x => 
        Observable.Empty<T>()
            .Delay(minDelay)
            .StartWith(x)
    ).Concat();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T01:23:31.857

我知道这可能太简单了，但这行得通吗？

```
var intervaled = source.Do(x => { Thread.Sleep(100); }); 
```

基本上，这只是在值之间设置了最小延迟。太简单了？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-24T08:14:40.737

按照 Enigmativity 的回答，如果您只想将所有值延迟一个 TimeSpan，我不明白为什么`Delay`不是您想要的运算符

```
 GetInitSequence()
        .Delay(TimeSpan.FromSeconds(5)) //ideally pass an IScheduler here
        .Subscribe(
            item =>
                {
                    Console.WriteLine(DateTime.Now);
                    // Process item
                }
        ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T18:03:44.667

[Observable.Buffer](http://msdn.microsoft.com/en-us/library/hh229308%28v=vs.103%29.aspx)怎么样？这应该将 1s 窗口中的所有事件作为单个事件返回。

```
var xs = Observable.Interval(TimeSpan.FromMilliseconds(100));
var bufferdStream = xs.Buffer(TimeSpan.FromSeconds(5));
bufferdStream.Subscribe(item => { Console.WriteLine("Number of events in window: {0}", item.Count); }); 
```

这可能是你问的不是很清楚。你的代码应该做什么？看起来你只是通过为每个事件创建一个计时器来延迟。它还破坏了 observable 的语义，因为下一个和完成可能发生在下一个之前。

请注意，这也仅在使用的计时器上同样准确。通常，计时器最多可精确到 16 毫秒。

**编辑：**

您的示例变为，并且 item 包含窗口中的所有事件：

```
GetInitSequence()
            .Buffer(TimeSpan.FromSeconds(5))
            .Subscribe(
                item =>
                    {
                        Console.WriteLine(DateTime.Now);
                        // Process item
                    }
            ); 
```

# powershell - 在 PowerShell 脚本中创建/销毁新环境

> ID：11284284
> 
> 赞同：2
> 
> 时间：2012-07-01T17:45:04.487
> 
> 标签：powershell, environment-variables, environment

我正在尝试找到一种方法，通过该方法可以执行 PowerShell 脚本，而不会在脚本和其他脚本/控制台之间来回“*泄漏”环境。*

即如果我在调用脚本之前设置了一个环境变量，我不希望脚本看到那个环境变量，如果我在脚本中设置了一个环境变量，我不希望能够从之后进行控制台。

我正在构建调用*vcvarsall.bat*的 PowerShell 构建/编译脚本（以将所有 Visual C++ 2010 变量等放入环境中），但我不希望*vcvarsall.bat*创建的环境“*泄漏*”回控制台-- 我想每次都重新开始，而无需关闭/重新打开 PowerShell 窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T05:43:09.883

您可以使用以下方法调用脚本：

```
powershell.exe -file <PS1 File> 
```

当前变量在 PS1 脚本中将不可用，并且在 PS1 脚本中创建的变量在退出后将不可用。

# google-apps-script - 从 Apps 脚本中的 URL 检索页面标题

> ID：11284285
> 
> 赞同：1
> 
> 时间：2012-07-01T17:45:15.477
> 
> 标签：google-apps-script

我需要使用 Apps 脚本从已有的 URL 中检索页面标题。

```
 var url= r.getValue();
  var title= magically_retrieve_title(url);
  setTitle(title) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T18:11:35.350

如果您想在“普通”URL 处获取页面标题，则可以使用 UrlFetchApp.fetch(url) 获取页面内容，然后解析标题标签。

如果不是，那么请提供更多信息 - 这里的 r 是什么？您正在使用哪种 URL？

# iphone - GLKit中iOS中质量差的图像

> ID：11284286
> 
> 赞同：0
> 
> 时间：2012-07-01T17:45:16.710
> 
> 标签：iphone, ios5, opengl-es, glkit

我通过本教程将精灵添加到场景中：[http ://www.raywenderlich.com/9743/how-to-create-a-simple-2d-iphone-game-with-opengl-es-2-0-and-glkit -第1部分](http://www.raywenderlich.com/9743/how-to-create-a-simple-2d-iphone-game-with-opengl-es-2-0-and-glkit-part-1)

但我的图像文件质量很差。如何解决问题？

![在此处输入图像描述](../Images/6fbd780a9cffc0908a74c3c27b5b9cc0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:13:12.460

这可能是由 PNG 文件的 xcode“压缩”引起的，它将它们转换为使用*预乘 alpha*。

您可以尝试替换该行：

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 
```

正如您在本教程中提到的那样，我想您有以下内容：

```
glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA); 
```

它允许在背景图像上合成一个预乘的 alpha 图像。

有关预乘 alpha 概念的更多信息，请查看[此处](http://home.comcast.net/~tom_forsyth/blog.wiki.html#%5B%5BPremultiplied%20alpha%5D%5D)。

如果您希望 xcode 停止弄乱您的 PNG 文件，您可以要求它停止：[如何跳过压缩一个 PNG？](https://stackoverflow.com/questions/2051947/how-can-i-skip-compressing-one-png)

# android - 应用程序重新启动后插入的行丢失

> ID：11284291
> 
> 赞同：0
> 
> 时间：2012-07-01T17:45:42.333
> 
> 标签：android, ormlite

我正在使用 ORMLite 使用以下代码进行插入：

```
protected void registerUser(EditText fullName, EditText email, EditText mobile, EditText username, EditText password) {
        //Perform DB Call to Insert Records                 
        User user = new User();
        user.setFullName(fullName.getText().toString());
        user.setEmail(email.getText().toString());
        user.setMobile(mobile.getText().toString());
        user.setUsername(username.getText().toString());
        user.setPassword(password.getText().toString());

        DBManager.getInstance().addUser(user);
    } 
```

但是重启应用后，上面的记录不见了，我的登录失败了。我使用以下代码进行身份验证，它适用于现有记录。

```
public boolean login(String username, String password) {
    boolean validLogin = false;
    try {           
        QueryBuilder<User, Integer> qb = getHelper().getUserDao().queryBuilder();           
        qb.where().eq("username", username).and().eq("password", password);         
        PreparedQuery<User> pq = qb.prepare();
        User user = getHelper().getUserDao().queryForFirst(pq);    
        if(user!=null){
            validLogin = true;
        }           
    } catch (SQLException e) {e.printStackTrace();}
    return validLogin;
} 
```

在我的 Helper 类中，我仅在不可用时创建表。

```
TableUtils.createTableIfNotExists(connectionSource, User.class); 
```

ORMLite 如何处理提交操作？我们必须手动提交吗？请建议如果我缺少一些东西，因为我是 Android 和 ORMLite 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T17:30:51.237

在评论中提供了更多信息之后，问题似乎是通过调用`dao.setAutoCommit(false)`或启动从未完成或回滚的事务来禁用自动提交。

推荐使用如下的 try/finally 模式。

```
try {
   dao.setAutoCommit(false);
   ...
   ...
 } finally {
   dao.setAutoCommit(true);
   dao.commit();
 } 
```

# android - 从我的应用 Android 启动 Dropbox

> ID：11284294
> 
> 赞同：0
> 
> 时间：2012-07-01T17:45:51.497
> 
> 标签：android, dropbox

我想使用 Intent 在我的应用 Android 中调用 Dropbox 应用。我该怎么办？？？

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:52:41.433

尝试使用`PackageManager`和[`getLaunchIntentForPackage()`](http://developer.android.com/reference/android/content/pm/PackageManager.html#getLaunchIntentForPackage%28java.lang.String%29)与 DropBox 的包名一起使用，即`com.dropbox.android`. 如果未安装 Dropbox，您将收到[PackageManager.NameNotFoundException 。](http://developer.android.com/reference/android/content/pm/PackageManager.NameNotFoundException.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T18:09:37.510

如果您想要通过启动 dropbox 来共享文件，您可以使用 ACTION_SEND ：

```
Intent intent = new Intent(Intent.ACTION_SEND);
startActivity(Intent.createChooser(intent, "title"); 
```

您还可以发送特定文件：

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.setType(fileType); 
intent.putExtra(Intent.EXTRA_STREAM, Uri.parse(file.getPath()));  
startActivity(Intent.createChooser(intent, "title")); 
```

请参阅[本文](http://www.androidguys.com/2009/11/02/a-call-to-action-action_send-that-is/)以了解 ACTION_SEND 背后的约定。

# c++ - 不能包含 DirectShow 示例并编译它（PushSourceDesktop）

> ID：11284296
> 
> 赞同：1
> 
> 时间：2012-07-01T17:45:56.180
> 
> 标签：c++, com, directshow

因此，我尝试将 PushSourceDesktop 示例与我的其他项目一起编译，这样我就可以使用“new”关键字直接创建对象而无需加载外部 dll。我已将所有文件包含在我的项目中，并将我的预编译头文件添加到 .cpp 文件中。即使在谷歌和其他各种搜索的帮助下，我也无法真正弄清楚这些错误。希望这里的人能够提供一些启示，在此先感谢！

```
Error   4   error C2065: 'm_pString' : undeclared identifier    c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    292 1   record3
Error   5   error C2065: 'm_pString' : undeclared identifier    c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    316 1   record3
Error   1   error C2146: syntax error : missing ';' before identifier 'm_pString'   c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    295 1   record3
Error   2   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    295 1   record3
Error   3   error C4430: missing type specifier - int assumed. Note: C++ does not support default-int   c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    295 1   record3
    8   IntelliSense: identifier "PTCHAR" is undefined  c:\program files\microsoft sdks\windows\v7.1\samples\multimedia\directshow\baseclasses\wxdebug.h    295 5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T10:57:24.960

该问题与 SDK 标头的包含顺序有关。您可能需要`#include <tchar.h>`在代码顶部添加某个位置，因为`PTCHAR`编译器无法找到。

因为 DirectShow Base Classes 是非常具体的类基础，所以我建议您不要将它与您拥有的其他 C++ 代码（例如 ATL、WTL 或 MFC）混合使用。这是可能的，但这可能会继续导致与您的问题类似的问题。

相反，您可以将过滤器保存在单独的 DLL 中，您可以通过[/](http://www.gdcl.co.uk/2011/June/UnregisteredFilters.htm)`CoCreateInstance`或私有地实例化它，并[通过私有接口](http://msdn.microsoft.com/en-us/library/windows/desktop/dd377627%28v=vs.85%29.aspx)与其通信。[`DllGetClassObject``CreateInstance`](http://www.gdcl.co.uk/2011/June/UnregisteredFilters.htm)

# drupal - Drupal 7 默认用户登录进程处理的属性

> ID：11284297
> 
> 赞同：0
> 
> 时间：2012-07-01T17:46:00.343
> 
> 标签：drupal, authentication, login, datasource

我是**Drupal 的新手，**但我只想破解/自定义 Drupal 7 的登录功能，比如硬编码。正如我发现的那样，Drupal 7 登录过程是由`user.module`及其相关文件处理的。

我只想知道当用户登录/身份验证过程通过仅提供用户名/密码来完成时返回或提供哪些类型的值或属性。

它返回的**最终属性，以提供回**我到目前为止刚刚注意到的 Drupal（在整个身份验证过程中）是：

*   尝试用户的 {uid}
*   {rid} 用户的角色 ID
*   用户电子邮件
*   用户是否被阻止
*   然后 .. ？

关键是..还有什么？
我可以替换/修改整个现有的身份验证过程吗？（根据我的需要）

例如，以下默认身份验证函数之一`user.module`：

```
function user_authenticate($name, $password) {
    ..
    return $uid;
} 
```

例如，**如果我修改（硬编码）该函数以连接到我的其他外部数据库并返回 {user id}，则 Drupal 将获得一个身份验证要求`{uid}`。那么还有什么要提供的呢？用户角色和..等等等等？**

像那样..在身份验证过程中，我还应该触摸哪些其他功能和属性并将其提供给 Drupal？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T01:30:52.740

*这不是一个实际的答案，但我不能将此作为评论发布。*

基本上我们不破解核心。因此，查看 user.module 的代码*不会*比学习钩子对您有太大帮助。例如，通过查看 hook_nodeapi() 的代码，很难了解如何在创建节点时添加一些魔法。但是，如果您检查文档和返回/输入参数，完成这项工作会容易得多。

我首先使用 hook_form_alter() 向登录表单添加一个额外的提交处理程序。我已经从您那里看到了一些关于您的用例的其他线程，但不幸的是，很难为您提供示例代码。您可以看到其他模块如何实现额外的身份验证（例如：[http](http://bit.ly/LdRcm6) ://bit.ly/LdRcm6 ）。（查看“记住我”模块如何将复选框添加到登录表单和允许 twitter 登录的 twitter 模块）。

然后，您可以让 Drupal 像往常一样对用户进行身份验证，并且*除了*Drupal 的身份验证之外，还可以使用新的自定义功能。

Drupal 甚至可以连接到外部数据库，无论它是否是 Drupal。

正如您在许多函数中看到的那样，它们返回一个布尔值，有时返回用户 ID。user_load() 是加载基本用户对象的函数。

记住它是模块化的。一些模块可以使用 hook_user_load() 包含/删除/更改这些值。用户条款模块和配置文件模块就是一个很好的例子。当其他模块需要用户信息时，它包括配置文件字段信息。

单个用户不仅仅是一组信息。它可以在过程的任何部分进行修改。就这样做吧。使用您的模块来提供您的外部站点所拥有的信息。

```
{uid} of the attempted user
{rid} role id of the user
user email
user is blocked or not
user last login time.
user register date.
... 
```

要查看*站点*的整个对象，请输入以下内容。

```
<pre>
<?php
$user_account = user_load (1);
print_r($user_account);
?>
</pre> 
```

您可以在使用 php 过滤器的节点创建页面中输入此代码。

如果没有硬编码，您可以允许其他模块使用这些值。即使您的源数据库没有角色 ID，您也可以为它们提供角色 ID、用户 ID 等。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:05:44.250

Drupal 是一个可扩展的系统。不需要像“用户”模块那样在核心模块中进行“硬编码”。您应该更愿意探索允许扩展核心（以及贡献）模块的钩子系统。

如果您想从不同的数据库中获取用户 ID（我不清楚这个用例），您仍然可以使用 Drupal 数据库中的角色和其他用户数据。

# perl - Perl - 在写入文件之前格式化文本数据

> ID：11284299
> 
> 赞同：2
> 
> 时间：2012-07-01T17:46:10.687
> 
> 标签：perl, text, format

我正在将数据写入文件。该文件将如下所示。

```
[section1] [section2] [section3]
[section1] [section2] [section3] 
```

我没有直接将数据写入文件。我首先在字符串中附加行，然后写入文件。

```
$str .= "section1_data  section2_data   section3_data\n";
$str .= "section1_more_data   section2_more_data   section3_more_data\n"; 
```

**现在我想要的是所有部分都应该是 30 个字符长。** 所有部分内的数据将始终小于或等于 30 个字符。

有没有办法在 perl 中做到这一点？

我正在使用以下语法写入文件

```
open FH,">>filename";
print FH $str;
close FH; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T17:47:58.370

```
$str .= sprintf("[%-30s] [%-30s] [%-30s]\n",
    $section1_data,
    $section2_data,
    $section3_data,
); 
```

# sql-server - 如果我在 GROUP BY 原因中包含一列，SQL 查询会变慢

> ID：11284300
> 
> 赞同：0
> 
> 时间：2012-07-01T17:46:13.947
> 
> 标签：sql-server, sql-server-2008-r2

我有以下查询，它执行得很好。不到 1 秒即可获得结果。

```
SELECT DISTINCT Items.ImageID AS ImgID, Items.AddDate, MIN(ra1.DescPriority) AS Pri
FROM            Items 
INNER JOIN      Attribs AS ra0 ON Items.ImageID = ra0.ImageID 
INNER JOIN      Attribs AS ra1 ON ra0.ImageID = ra1.ImageID 
LEFT OUTER JOIN v_priceOrder ON Items.ImageID = v_priceOrder.ImageID
WHERE        (Items.deleted NOT IN (1, 2)) 
GROUP BY Items.ImageID, Items.AddDate
ORDER BY pri, Items.AddDate DESC 
```

但是，如果我尝试在选择列表中添加 PriceOrder 视图中的列，则需要 10 秒才能获得结果。

```
SELECT DISTINCT Items.ImageID AS ImgID, Items.AddDate, MIN(ra1.DescPriority) AS Pri,
    v_priceOrder.PriceOrder
FROM            Items 
INNER JOIN      Attribs AS ra0 ON Items.ImageID = ra0.ImageID 
INNER JOIN      Attribs AS ra1 ON ra0.ImageID = ra1.ImageID 
LEFT OUTER JOIN v_priceOrder ON Items.ImageID = v_priceOrder.ImageID
WHERE        (Items.deleted NOT IN (1, 2)) 
GROUP BY Items.ImageID, Items.AddDate, v_priceOrder.PriceOrder
ORDER BY v_priceOrder.PriceOrder, pri, Items.AddDate DESC 
```

有没有办法改进这个查询？在执行计划中，我只看到 0 或 1% 的成本。我正在使用 MS SQL Server 2008 R2。

**更新：** 我的观点有问题。运行需要 8 秒...这是查询。

```
SELECT     dbo.Items.ImageID, 
                          CASE WHEN dbo.Items.SubcategoryID2 = 'STO' THEN dbo.v_DisplayStockPrice.DisplayPrice WHEN dbo.Items.SubcategoryID2 = 'ORD' THEN dbo.v_FinalPriceFactor.[14kyFactorOrder]
                          WHEN dbo.Items.SubcategoryID2 IS NULL THEN dbo.v_FinalPriceFactor.[14kyCustomLow] END AS PriceOrder
FROM       dbo.v_FinalPriceFactor RIGHT OUTER JOIN
                          dbo.Items ON dbo.v_FinalPriceFactor.ImageID = dbo.Items.ImageID LEFT OUTER JOIN
                          dbo.v_DisplayStockPrice ON dbo.Items.ImageID = dbo.v_DisplayStockPrice.ImageID
WHERE     (dbo.Items.deleted NOT IN (1, 2)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T20:56:35.267

我在我的视图中交叉加入导致不必要的循环......

# objective-c - 可达性未按预期工作

> ID：11284302
> 
> 赞同：16
> 
> 时间：2012-07-01T17:46:38.923
> 
> 标签：objective-c, ios, reachability

从 Apple 下载的可达性，使用此方法检查活动连接：

```
-(BOOL)isReachable{

    Reachability *r = [Reachability reachabilityWithHostName:@"http://www.google.com"];

    if(NotReachable == [r currentReachabilityStatus]) {
        NSLog(@"Not Reachable");
        return NO;
    }

    NSLog(@"Reachable");
    return YES;  

} 
```

尽管已连接，但每次都返回 NO？想不通为什么...

有任何想法吗？谢谢。

在旁注中，任何人都可以推荐一个好的干净的可达性单例类吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-01T17:53:37.807

**已编辑：**`http`您应该从`reachabilityWithHostName`通话中删除协议，因此将其更新为

```
 Reachability *reachability = [Reachability reachabilityWithHostname:@"www.google.com"];
 NetworkStatus netStatus = [reachability currentReachabilityStatus]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-03T05:41:14.270

使用此代码检查设备是否已连接到互联网

在 viewDidLoad 中使用此代码：

```
 Reachability* internetReachable; = [Reachability reachabilityForInternetConnection];
    [internetReachable startNotifier];

    hostReachable = [Reachability reachabilityWithHostName: @"www.apple.com"] ;
    [hostReachable startNotifier]; 
```

并将此函数添加到您的代码中：

```
-(void) checkNetworkStatus:(NSNotification *)notice
{
    recheabilityBool=FALSE;
    nonrecheabilityBool=FALSE;
    // called after network status changes
    NetworkStatus internetStatus = [internetReachable currentReachabilityStatus];
    switch (internetStatus)
    {
        case NotReachable:
        {
            nonrecheabilityBool=TRUE;
            internetCon=0;
            //NSLog(@"The internet is down.");

            break;
        }
        case ReachableViaWiFi:
        {
            NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
            internetCon=404;
            [prefs setInteger:internetCon forKey:@"conKey"];

            //NSLog(@"The internet is working via WIFI.");
            break;

        }
        case ReachableViaWWAN:
        {
            //NSLog(@"The internet is working via WWAN.");

            break;
        }
    }

    NetworkStatus hostStatus = [hostReachable currentReachabilityStatus];
    switch (hostStatus)
    {
        case NotReachable:
        {
            internetCon=0;
            if( nonrecheabilityBool==FALSE)
            {
                //NSLog(@"A gateway to the host server is down.");
            }
            break;

        }
        case ReachableViaWiFi:
        {
            if(recheabilityBool==FALSE)
            {

                recheabilityBool=TRUE;

                NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
                internetCon=404;
                [prefs setInteger:internetCon forKey:@"conKey"];

                //NSLog(@"The internet is working via WIFI.");
                break;
            }

            //NSLog(@"A gateway to the host server is working via WIFI.");

            break;
        }
        case ReachableViaWWAN:
        {
            //NSLog(@"A gateway to the host server is working via WWAN.");
            break;
        }
    }
}

- (BOOL)connected
{
    Reachability *reachability = [Reachability reachabilityForInternetConnection];
    NetworkStatus networkStatus = [reachability currentReachabilityStatus];
    return !(networkStatus == NotReachable);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-04T09:37:32.710

我对 Tony Million 的可达性有同样的问题：网络状态总是设置为 NotReachable。我通过添加 SystemConfiguration 框架来修复它

希望能帮助到你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T18:04:21.467

我使用[KSReachability](https://github.com/kstenerud/KSReachability)。它适用于 NSNotification、blocks、KVO，以及有无 ARC。

```
KSReachability *reachability = [KSReachability reachabilityToHost:@"www.google.com"];
reachability.onReachabilityChanged = ^(KSReachability* reachability) {
    NSLog(@"Update: network is %@", reachability.reachable ? @"up." : @"down.");
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-01T20:53:17.890

如果您尝试查看设备是否可以访问互联网，您可能应该使用reachabilityForInternetConnection 而不是reachabilityWithHostName:。此外，这两个调用都需要一点时间来启动（它仍然会以毫秒为单位，但比到达下一行的 if 条件所需的时间要长。）这是一个单例类的示例使用可达性。

```
static NetworkManager* sharedInstance = nil;

@interface NetworkManager()
@property (nonatomic, strong) Reachability* reachability;
@end

@implementation NetworkManager
@synthesize reachability;

+ (NetworkManager*)sharedInstance
{
    @synchronized(self) {
        if (sharedInstance == nil) {
            sharedInstance = [[NetworkManager alloc] init];
        }
    }
    return sharedInstance;
}

- (id)init
{
    reachability = [WYReachability reachabilityForInternetConnection];
}

- (BOOL)isNetworkReachable
{
    return ([self.reachability currentReachabilityStatus] != NotReachable);
}
@end 
```

要检查您可以使用的其他类中可访问的网络。

```
[[NetworkManager sharedInstance] isNetworkReachable]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-01T07:01:35.187

另一个完整的答案：

```
-(BOOL) isReachable:(NSString *)url
{
    //Retrieve the host name by given url address.
    NSString *hostName = [[NSURL URLWithString:url] host];
    Reachability *r = [Reachability reachabilityWithHostName:hostName];

    if(NotReachable == [r currentReachabilityStatus]) {
        NSLog(@"Not Reachable");
        return NO;
    }
    NSLog(@"Reachable");
    return YES;
} 
```

# magento - 如何在 Magento 模块中包含图像？

> ID：11284303
> 
> 赞同：0
> 
> 时间：2012-07-01T17:46:46.117
> 
> 标签：magento

我希望图像显示在网页上，但包含在 Magento 模块中。

1.  我将它们放在哪个文件夹中？
2.  我如何引用它们？*（我需要一个模块路径的变量。）*

文档、各种外部教程和谷歌搜索没有提供任何帮助。

我在`design/frontend/default/default`文件夹下看到的只是`etc` `layout` `locale` `template`没有放置图像的地方。

我把它们放在`skin/frontend/default`文件夹里吗？如果有，在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-01T19:06:45.830

假设您的模块适用于 Magento 1.4+，您的图像属于`./skin/frontend/base/default/images/`，理想情况下位于指示模块名称空间和名称的文件夹中，例如`namespace_module`. 然后可以通过以下方式引用它们：

*   模块 CSS 文件位于`base/default/css/namespace_module/file.css`：`url(../../images/namespace_module/image.jpg)`

*   模板（或块）：`$this->getSkinUrl('images/namespace_module/image.jpg')`

*   任何地方：`Mage::getDesign()->getSkinUrl('images/namespace_module/image.jpg');`

仅供参考，`./app/`浏览器直接访问（应该访问）目录下的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T08:23:42.583

将图像作为扩展的一部分发送的另一种方法是将其托管在您的网络服务器（*或其他人的*）上，然后通过 URL 将其包含在您的扩展中。

如果是这种情况，并且您希望图像显示在您的基本管理页面上，那么您只需将 html 直接放入您的 system.xml 中（先转义它）。否则，如果您将其包含在模板中，只需将其与`img`html 标记一起放入即可。

这种方法的几个好处：

1) 您可以每月查看您的 Apache 日志并查看您的图像被查看了多少次（即有多少人正在安装您的扩展程序），并且还可以从referer HTTP 标头中查看哪些站点也在使用它。

2) 当您非常成功的互联网公司被收购时，您可以轻松地在您的网络服务器上换入不同的 logo.jpg，而无需推出新版本的扩展程序。

所以这不是*正确的方法*，但它是一种简单的方法，有几个好处。

# android - 如何保留 EditText 的换行符？

> ID：11284306
> 
> 赞同：6
> 
> 时间：2012-07-01T17:47:14.143
> 
> 标签：android

当我显示它们时，以下内容会忽略新行

```
private void post() {
        String subject = "";
        String message = "";
        subject = etSubject.getText().toString();
        message = etMessage.getText().toString(); 
```

编辑：我的edittext已经设置为多行但是当我在其中写入多行文本时，它会作为单行返回，上面有封面

edit2：我从 editText 获取文本并将其显示在 textview

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-01T18:30:05.917

通过使用解决了它`replaceAll("\\n", "<br />")`

```
message = etMessage.getText().toString().replaceAll("\\n", "<br />") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:52:22.243

使用`android:inputType="textMultiLine"`属性...在 xml 或 Eclipse Gui 中设置它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T17:51:50.530

`android:inputType="textMultiLine"`如果您在 TextView 中显示它，请 尝试添加也添加`android:singleLine="false"`到您的 EditText 定义中。

**编辑 ：**

例如，您的 EditText 应该有`android:inputType="textMultiLine"`：

```
<TextView
        android:id="@+id/myDisplayingTextView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
/>
<EditText
        android:id="@+id/myEditText"
        android:inputType="textMultiLine"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text=""
       android:singleLine="false"
/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-21T20:59:18.920

这也有效：

```
editText.getText().toString().replaceAll("\\n", "\n"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-09T06:17:16.783

试试这个，应该可以的

```
message = etMessage.getText().toString().replaceAll("[\r\n]+", "\n"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-26T05:17:58.830

在科特林，试试这个， `val msg = evMsg.text.toString().replace("\\n".toRegex(), "<br />")`

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-04-05T05:25:48.053

```
String text=editText1.getText().toString().replace("\n", " ").trim(); 
```

# shell - 从具有 kerberos 身份验证的服务器下载文件

> ID：11284309
> 
> 赞同：5
> 
> 时间：2012-07-01T17:47:29.120
> 
> 标签：shell, https, download, kerberos

我正在尝试从 linux shell 编写脚本，通过 https 从 web 服务器下载文件，该文件受 kerberos 身份验证保护。我试过使用 wget 和 curl 但它们似乎都不支持 kerberos over https。

是否有支持 kerberos over https 的 linux 命令行实用程序？如果是这样，您将如何使用它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-09-27T19:06:04.677

如果 curl 具有 GSS-Negotiate，则完全有可能。检查`curl -V`它应该返回一个带有*GSS-Negotiate的**Features*行（Ubuntu 12.04 在包中有它）。您还需要 Kerberos 客户端工具（如在 Ubuntu 上）并使用 REALM 和 kdc 进行设置。参见[麻省理工学院文档](http://web.mit.edu/kerberos/krb5-devel/doc/admin/conf_files/krb5_conf.html)*`krb5-user``/etc/krb5.conf`*

 *首先，您必须能够从 Web 服务器使用的同一个 KDC 获得票证（忽略更复杂的可能性）。而且您要从中获取的域必须具有正确的反向指针或在您的配置中配置，`/etc/hosts`因此请检查您的 DNS。

从...开始`kinit <some user principal>`

然后，您可以通过 curl 方式访问您要检查的 URL。curl 需要一个*假*用户才能接受您的协商（但实际上并未使用，与用户名或密码无关。）我还使用 a`--trace-ascii-`来获取 Kerberos 错误。

例如：

```
 curl  --negotiate -u foo --trace-ascii -  http://intranet/ 
```

如果你看到：

```
== Info: gss_init_sec_context() failed: : Credentials cache file '/tmp/krb5cc_0' not found<= Recv header, 29 bytes (0x1d) 
```

然后你忘了`kinit`或者它没有成功。

如果您看到类似的内容，但使用`krb5kdc_err_s_principal_unknown`反向指针或主机条目构造的 kerberos 库在所联系的 KDC 上没有对应的主体。

否则，如果服务器发送正确的`HTTP/1.1 401: Authorization Required`并且`WWW-Authenticate: Negotiate`您获得身份验证。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T02:11:02.397

检查 curl 手册页。您可以使用 --negotiate 来使用 SPNego/GSSAPI/Kerberos。大多数网络服务器都支持 SPNego。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:32:26.997

`curl`如果你用 编译它有 SPNEGO 支持`fbopenssl`，没有内置支持。我已经做到了，并且有效。*

# ruby-on-rails - nil:NilClass 的未定义方法“[]”，在用户模型上创建

> ID：11284314
> 
> 赞同：1
> 
> 时间：2012-07-01T17:48:26.427
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

如何处理不提供某些价值的 Facebook 用户？我正在使用考拉宝石和omniauth。

我收到以下错误：

```
NoMethodError in SessionsController#create
undefined method `[]' for nil:NilClass

app/models/user.rb:14:in `block in from_omniauth'
app/models/user.rb:5:in `tap'
app/models/user.rb:5:in `from_omniauth'
app/controllers/sessions_controller.rb:3:in `create' 
```

我收到这个错误是因为我的应用程序试图验证的 facebook 用户有一些我的应用程序想要的数据值，比如位置、教育历史等。

一个新的用户进程，在 SessionsController 中开始：

```
class SessionsController < ApplicationController
  def create
    user = User.from_omniauth(env['omniauth.auth'])
    session[:user_id] = user.id
    redirect_to root_url, notice: "Signed in!"
  end
end 
```

然后在用户模型中：

```
def self.from_omniauth(auth)
where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|
  user.provider = auth["provider"]
  user.uid = auth["uid"]
  user.name = auth["info"]["name"] unless auth["info"].blank?
  user.first_name = auth["info"]["first_name"] unless auth["info"].blank?
  user.last_name = auth["info"]["last_name"] unless auth["info"].blank?
  user.image = auth["info"]["image"] unless auth["info"].blank?
  user.email = auth["info"]["email"] unless auth["info"].blank?
  user.gender = auth["extra"]["raw_info"]["gender"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"].blank?)
  user.location = auth["extra"]["raw_info"]["location"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"].blank? && !auth["extra"]["raw_info"]["location"].blank?)          
  user.token = auth["credentials"]["token"] unless auth["credentials"].blank?

    # highschool data
    user.highschool_name = auth["extra"]["raw_info"]["education"][0]["school"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"]["education"][0]["school"].blank?)
    user.highschool_year = auth["extra"]["raw_info"]["education"][0]["year"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"]["education"][0]["year"].blank?)
    # graduate school data
    user.graduateschool_name = auth["extra"]["raw_info"]["education"][1]["school"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"]["education"][1]["school"].blank?)
    user.graduateschool_year = auth["extra"]["raw_info"]["education"][1]["year"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"]["education"][1]["year"].blank?)

  user.add_friends
  user.save!
      user
 end 
end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:37:29.830

您也可以使用[Object.try](http://api.rubyonrails.org/classes/Object.html#method-i-try)方法。

```
user.first_name = auth["info"].try(:[], "first_name") 
```

但最好的方法应该是

```
unless auth["info"].blank? 
  user.first_name = auth["info"]["first_name"]
  user.last_name = auth["info"]["last_name"]
  user.image = auth["info"]["image"]
  user.email = auth["info"]["email"]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:01:49.987

错误在第 14 行为您提供用户模型文件，例如 if `auth["credentials"]`is nil`auth["credentials"]["token"]`将给出与您相同的错误。

在分配值时将检查放在一行中，例如，`user.token = auth["credentials"]["token"] unless auth["credentials"].blank?`

更新

```
 user.first_name = auth["info"]["first_name"] unless auth["info"].blank?
  user.last_name = auth["info"]["last_name"] unless auth["info"].blank?
  user.image = auth["info"]["image"] unless auth["info"].blank?
  user.email = auth["info"]["email"] unless auth["info"].blank?
  user.gender = auth["extra"]["raw_info"]["gender"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"].blank?)
  user.location = auth["extra"]["raw_info"]["location"]["name"] if (!auth["extra"].blank? && !auth["extra"]["raw_info"].blank? && !auth["extra"]["raw_info"]["location"].blank?)
  user.token = auth["credentials"]["token"] unless auth["credentials"].blank? 
```

# linux - gdb 会立即停止所有线程吗？

> ID：11284317
> 
> 赞同：0
> 
> 时间：2012-07-01T17:48:43.023
> 
> 标签：linux, multithreading, gdb

我有一个非常奇怪的情况，我无法解释。在代码中：

```
Env = Global.Queue2Ctrl.FIFO(100);//Wait for a msg for 100ms
if (Env == 0) continue; //Timeout
printf("i=%d %x\n",++i, (Env->Msg));
if (!Env->Msg)
  BreakP();
.... 
```

就本期而言：其他线程每 100 毫秒从池中获取并填充 Env 结构（包括指向 Msg 的指针）。然后它通过 FIFO 发送 Env 指针。该线程处理 Env 并将其返回到池中。

在数十万个周期中，我会遇到断点 - 好吧，我知道如果我有一些我正在寻找的错误，可能是这样。恕我直言，当我在 gdb 中查看（不踩！）Env-Msg 变量时，它不是零！！！！Printf 打印零，我输入 if 子句，但 gdb 显示“正常”值。我可以在 5-7 分钟内重现这种情况，并且 gdb 总是显示出良好的价值？如果这是竞速条件，当两个线程都基于超时时，如何在一个汇编程序命令中完全做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T05:05:26.413

> gdb 是否立即停止所有线程

不。在 Linux 上，一旦一个线程收到一个`SIGTRAP`（由于断点触发），GDB 必须停止所有其他线程（通过遍历 GDB 知道的线程列表，并发`SIGSTOP`送给每个线程）。

如果`Env`在两个线程之间共享，则很有可能`Env->Msg`在`NULL`评估条件时为非，但在 GDB 给您提示时`if`变为非。`NULL`

# java - 如何计算两个向量之间的间距？

> ID：11284318
> 
> 赞同：0
> 
> 时间：2012-07-01T17:48:50.420
> 
> 标签：java, math, trigonometry

好的，所以我有 2 个向量，敌人位置向量和玩家位置向量。我需要计算音高（我必须沿着 X 轴从敌人位置旋转某些东西以指向玩家的 Y 位置的度数。）

如何获得敌人位置和玩家位置之间的间距？

这是我最后一次尝试，它似乎卡在 0 度左右。

```
player_pos.normalise();
enemy_pos.normalise();

float dot = Vector3f.dot(player_pos, enemy_pos);

Vector3f rotationVector = new Vector3f(0,0,0);
rotationVector. x = (float) Math.toDegrees(Math.acos(dot)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:24:53.683

你不只是在寻找不同的角度吗？

```
double angle = Math.acos(Vector3f.dot(player_pos,enemy_pos) /
                         (player_pos.length() * enemy_pos.length())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T00:22:34.170

您在最初的尝试中缺少的东西是您试图指向新方向的当前方向。如果您想弄清楚某物需要以哪种方式旋转，您将需要它。

您绝对不想标准化职位。在这种情况下，该操作没有意义。两个向量之间的点积为您提供了它们之间的角度，但（标准化）实体位置之间的点积为您提供了从原点角度来看这两个项目之间的角度，因此这可能不是您想要的。

我建议在一张纸上画出你所拥有的信息，然后看看你想要什么信息。首先，在这种情况下，您想要什么和什么之间的角度？你想在哪个实体中改变什么？

您可能会发现，当您开始绘制所有内容时，您需要处理的数据以及进行该处理所需使用的操作变得显而易见。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T19:16:34.260

好吧，我不太清楚你的意思，如果枪在原点指向敌人和玩家之间的角度是多少，你似乎有什么。

我假设您想将敌人的枪转向玩家。

首先获取玩家相对于敌人的方向 //不要忘记检查零

```
dir = player_pos -enemy_pos
dir.normalize()

angle = asin(dir.y) or angle = acos(dir.z)
angle = Math.toDegrees(angle); 
```

你将不得不调整象限（asin）

```
if (z < 0) {
    if (y < 0) {
        angle = -180 - angle;
    }
    else {
        angle = 180 - angle;
    }
} 
```

我没有做太多的游戏开发，所以可能有一个更有效的方法，我也不确定这是否正是你想要的，如果我能画图会容易得多

那是围绕 x 轴，您可能是指围绕 z 轴将 z 替换为 x

# c# - 无法在 MVC3 的控制器中传递正确的 DropDownListFor<> 值

> ID：11284320
> 
> 赞同：1
> 
> 时间：2012-07-01T17:49:19.250
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, html.dropdownlistfor

我正在开发一个应用程序，其中我有一个下拉列表，我希望每当下拉列表的选择发生任何变化时，必须相应地选择相同的部分视图。

我使用下拉列表作为

```
 @Html.DropDownListFor(x => x.ID,
              new SelectList(new List<Object>{ new { value = 0 , text = "MCQ"  },new { value = 1 , text = "Rating Scale" },
                           new { value = 2 , text = "Comment Box"}}, "Value", "Text"),
            "Select Answer Type",
            new
            {
                id = "myddl",
                data_url = Url.Action("GetHtml", "Question")
            }) 
```

和**jQuery**代码来跟踪选择更改事件

```
 $(function () {
        $('#myddl').change(function () {
            var url = $(this).data('url');
            var value = $(this).val();
            $('#result').load(url)
        });
    }); 
```

我正在使用名为**GetHTML**的操作作为

```
public ActionResult GetHtml(string value)
        {

            if (value== "0")
           {
             return PartialView("_OAns");
           }
            else if (value== "1")
           {
               return PartialView("_RScale");
           }
            else if (value== "2")
           {
               return PartialView("_Comments");
           }
           else
           {                   
               return View("Index");
           }
        } 
```

上面的代码工作正常，但是当我在下拉框中选择一个值时，**它总是返回**这个，`View("Index")`即它可能永远不会采用与值 1、2 或 3 匹配的值

什么原因 ？我想应用选择更改，但这里没有发生。行动或传递价值有什么问题吗？

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:51:11.043

您已经`value`在回调中声明了这个变量，`change`但您似乎没有对它做任何事情。所以做一些事情，例如将其发送到服务器：

```
$(function () {
    $('#myddl').change(function () {
        var url = $(this).data('url');
        var value = $(this).val();
        $('#result').load(url, { value: value });
    });
}); 
```

注意函数的第二个参数[`.load()`](http://api.jquery.com/load/)。它允许您在 AJAX 请求期间将数据传递给服务器。

# ios - iPhone屏幕键盘的高度是多少？

> ID：11284321
> 
> 赞同：87
> 
> 时间：2012-07-01T17:49:21.740
> 
> 标签：ios, iphone, keyboard, height

纵向高度和横向高度以磅为单位。

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2014-03-28T17:14:18.360

我使用以下方法来确定 iOS 7.1 中的键盘框架。

在我的视图控制器的 init 方法中，我注册了`UIKeyboardDidShowNotification`：

```
NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
[center addObserver:self selector:@selector(keyboardOnScreen:) name:UIKeyboardDidShowNotification object:nil]; 
```

然后，我使用下面的代码`keyboardOnScreen:`来访问键盘的框架。此代码`userInfo`从通知中获取字典，然后访问`NSValue`关联的`UIKeyboardFrameEndUserInfoKey`. 然后，您可以访问 CGRect 并将其转换为视图控制器的视图坐标。从那里，您可以根据该框架执行所需的任何计算。

```
-(void)keyboardOnScreen:(NSNotification *)notification 
 {
        NSDictionary *info  = notification.userInfo;
        NSValue      *value = info[UIKeyboardFrameEndUserInfoKey];

        CGRect rawFrame      = [value CGRectValue];
        CGRect keyboardFrame = [self.view convertRect:rawFrame fromView:nil];

        NSLog(@"keyboardFrame: %@", NSStringFromCGRect(keyboardFrame));
 } 
```

**迅速**

以及 Swift 的等效实现：

```
NotificationCenter.default.addObserver(self, selector: #selector(keyboardDidShow), name: UIResponder.keyboardDidShowNotification, object: nil)

@objc
func keyboardDidShow(notification: Notification) {
    guard let info = notification.userInfo else { return }
    guard let frameInfo = info[UIResponder.keyboardFrameEndUserInfoKey] as? NSValue else { return }
    let keyboardFrame = frameInfo.cgRectValue
    print("keyboardFrame: \(keyboardFrame)")
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2015-01-06T12:28:58.557

请记住，在 iOS 8 中，屏幕键盘的大小*可能*会有所不同。不要假设屏幕键盘总是可见（具有*特定*高度）或不可见。

现在，在 iOS 8 中，用户还可以打开和关闭文本预测区域……当他们这样做时，它会*再次*`keyboardWillShow`启动应用程序的事件。

 *这*将*破坏许多遗留代码示例，建议编写一个`keyboardWillShow`事件，该事件仅测量屏幕键盘的当前高度，并将页面上的控件向上或向下移动这个（绝对）数量。

![在此处输入图像描述](../Images/81ee4e4ad09f2391df747f1097ed47bd.png)

换句话说，如果你看到任何示例代码，它只是告诉你添加一个`keyboardWillShow`事件，测量键盘高度，然后将控件的高度调整这个数量，这将不再有效。

在上面的示例中，我使用了来自以下站点的示例代码，它为垂直约束`constant`值设置了动画。

[练习自动布局](http://www.think-in-g.net/ghawk/blog/2012/09/practicing-auto-layout-an-example-of-keyboard-sensitive-layout/)

在我的应用程序中，我添加了一个约束到我的`UITextView`, 设置到屏幕的底部。当屏幕第一次出现时，我存储了这个初始垂直距离。

然后，每当我的`keyboardWillShow`事件开始时，我都会**将**（新的）键盘高度添加到这个原始约束值（因此*约束*会调整控件的高度）。

![在此处输入图像描述](../Images/cc2dcc216d09887351c6c74dfdb23338.png)

是的。它很丑。

我有点恼火/惊讶的是，Xcode 6 可怕的 AutoLayout 不仅允许我们将控件的底部附加到屏幕底部或屏幕键盘的顶部。

也许我错过了一些东西。

除了我的理智。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-07-01T17:49:23.597

纵向模式的键盘高度为 216pts，横向模式的键盘高度为 162pts。

[来源](http://www.idev101.com/code/User_Interface/sizes.html)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-03-23T15:01:04.670

**版本说明：这在 iOS 9 和 10 中不再有价值，因为它们支持自定义键盘尺寸。**

这取决于型号和 QuickType 栏：

![在此处输入图像描述](../Images/093cf9754af5b736967ec24242af5389.png)

[http://www.idev101.com/code/User_Interface/sizes.html](http://www.idev101.com/code/User_Interface/sizes.html)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-10-12T12:01:48.837

键盘高度取决于型号、QuickType 栏、用户设置……最好的方法是动态计算：

**斯威夫特 3.0**

```
var heightKeyboard : CGFloat?

override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)
    NotificationCenter.default.addObserver(self, selector: #selector(self.keyboardShown(notification:)), name: NSNotification.Name.UIKeyboardDidShow, object: nil)
}

func keyboardShown(notification: NSNotification) {
   if let infoKey  = notification.userInfo?[UIKeyboardFrameEndUserInfoKey],
       let rawFrame = (infoKey as AnyObject).cgRectValue {
       let keyboardFrame = view.convert(rawFrame, from: nil)
       self.heightKeyboard = keyboardFrame.size.height
       // Now is stored in your heightKeyboard variable
   }
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-10-11T05:37:15.830

我找不到最新的答案，所以我用所有 iOS 11.0 模拟器检查了它：

| iOS 11 设备 | 屏幕高度 | 肖像 | 景观 |
| --- | --- | --- | --- |
| iPhone 4s | 480.0 | 216.0 | 162.0 |
| iPhone 5、iPhone 5s、iPhone SE | 568.0 | 216.0 | 162.0 |
| iPhone 6、iPhone 6s、iPhone 7、iPhone 8、iPhone X | 667.0 | 216.0 | 162.0 |
| iPhone 6 加、iPhone 7 加、iPhone 8 加 | 736.0 | 226.0 | 162.0 |
| 第 5 代 iPad、iPad Air、iPad Air 2、iPad Pro 9.7、iPad Pro 10.5、iPad Pro 12.9 | 1024.0 | 265.0 | 353.0 |

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-26T16:57:45.043

我创建了这张表，其中包含 iPhone 和 iPad 键盘的高度，包括横向和纵向模式，工具栏都打开和关闭。

[我什至在这里](https://federicabenacquista.medium.com/list-of-the-official-ios-keyboards-heights-and-how-to-calculate-them-c2b844ef54b9)解释了如何在代码中使用这些维度。

请注意，如果您需要在布局视图之前知道键盘的尺寸，则应该只使用这些尺寸。否则，其他答案的解决方案效果更好。

[![在此处输入图像描述](../Images/d0129afedc370ea16438cdb7ffd7eab0.png)](https://i.stack.imgur.com/ekvhy.jpg)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-27T13:10:25.760

苹果手机

键盘尺寸：

1.  5S、SE、5、5C (320 × 568) 键盘尺寸 = (0.0, 352.0, 320.0, 216.0) 键盘尺寸 = (0.0, 315.0, 320.0, 253.0)

2.6S,6,7,8:(375 × 667) : 键盘大小 = (0.0, 407.0, 375.0, 260。

3.6+,6S+, 7+ , 8+ : (414 × 736) 键盘尺寸 = (0.0, 465.0, 414.0, 271.0)

4.XS, X :(375 X 812) 键盘尺寸 = (0.0, 477.0, 375.0, 335.0)

5.XR,XSMAX((414 x 896) 键盘尺寸 = (0.0, 550.0, 414.0, 346.0)*

# spring - java.sql.SQLException：访问数据库时没有合适的驱动程序

> ID：11284326
> 
> 赞同：3
> 
> 时间：2012-07-01T17:50:06.303
> 
> 标签：spring, hibernate, connection-pooling, tomcat7, c3p0

我创建了一个在 Tomcat 7 上运行的基本 Spring 3.1 - Hibernate 4 - Mysql 5.5 Web 应用程序。我正在通过 spring + C3PO 汇集连接。

更新：我也在发布我的代码。

我的 Spring 应用程序上下文：

```
<!-- Context -->
<context:component-scan base-package="com.yl.tomcat" />

<!-- AOP -->
<aop:aspectj-autoproxy />

<!-- Properties -->
<bean id="applicationProperties"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:applicationProperties.properties" />
</bean>

<!-- Data source -->
<!-- Have spring manage connection management along with connection pooling -->
<bean id="dataSourceGlobal" class="com.mchange.v2.c3p0.ComboPooledDataSource"
    destroy-method="close">
    <property name="driverClass" value="${driverClass}" />
    <property name="jdbcUrl" value="${jdbcUrl" />
    <property name="user" value="${user}" />
    <property name="password" value="${password}" />

    <!-- C3P0 Connection pool properties -->
    <property name="minPoolSize" value="${c3p0.min_pool_size}" />
    <property name="maxPoolSize" value="${c3p0.max_pool_size}" />
    <property name="unreturnedConnectionTimeout" value="${c3p0.timeout}" />
    <property name="idleConnectionTestPeriod" value="${c3p0.idle_test_period}"/>
    <property name="maxStatements" value="${c3p0.max_statements}"/>
    <property name="automaticTestTable" value="${c3p0.automatic_test_table}"/>
</bean>

<!-- JPA -->
<!-- Creates a EntityManagerFactory for use with the Hibernate JPA provider -->
<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="myPU" />
    <property name="dataSource" ref="dataSourceGlobal" />
</bean>

<!-- In order to enable EntityManager injection -->
<bean id="persistenceAnnotation"
    class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor">
    <property name="persistenceUnits">
        <map>
            <entry key="myPU" value="persistence/myPU" />
        </map>
    </property>
</bean>

<!-- Transactions -->
<tx:annotation-driven />

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
    <property name="dataSource" ref="dataSourceGlobal" />
</bean> 
```

如您所见，我使用 C3PO 数据源进行池化，由 spring 容器管理。

我的属性文件（来自 spring 容器）：

```
driverClass=com.mysql.jdbc.Driver
jdbcUrl=jdbc:mysql://localhost:3306/yl
user=root
password=pass

c3p0.min_pool_size=5
c3p0.max_pool_size=20
c3p0.timeout=5000
c3p0.idle_test_period=100
c3p0.max_statements=50
c3p0.automatic_test_table=test_table 
```

这是我的 POM 依赖项：

```
 <properties>
    <java-version>1.6</java-version>
    <org.springframework-version>3.1.0.RELEASE</org.springframework-version>
    <hibernate.version>4.1.4.Final</hibernate.version>
    <org.aspectj-version>1.6.9</org.aspectj-version>
    <org.slf4j-version>1.5.10</org.slf4j-version>
</properties>
<dependencies>
    <!-- Spring -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${org.springframework-version}</version>
        <exclusions>
            <!-- Exclude Commons Logging in favor of SLF4j -->
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-beans</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>
    <!--Transaction Management Abstraction (depends on spring-core, spring-beans, 
        spring-aop, spring-context) Define this if you use Spring Transactions or 
        DAO Exception Hierarchy(org.springframework.transaction.*/org.springframework.dao.*) -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-tx</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>
    <!--JDBC Data Access Library (depends on spring-core, spring-beans, spring-context, 
        spring-tx) Define this if you use Spring's JdbcTemplate API (org.springframework.jdbc.*) -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>
    <!--Object-to-Relation-Mapping (ORM) integration with Hibernate, JPA, and 
        iBatis.(depends on spring-core, spring-beans, spring-context, spring-tx) 
        Define this if you need ORM (org.springframework.orm.*) -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${org.springframework-version}</version>
    </dependency>

    <!-- DB Connection -->
    <dependency>
        <groupId>c3p0</groupId>
        <artifactId>c3p0</artifactId>
        <version>0.9.1.2</version>
        <type>jar</type>
        <scope>compile</scope>
    </dependency>

    <!-- MySQL database driver -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.20</version>
    </dependency>

    <!-- Hibernate -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.3.0.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${hibernate.version}</version>
    </dependency>
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
        <scope>provided</scope>
    </dependency>

    <!-- AspectJ -->
    <dependency>
        <groupId>org.aspectj</groupId>
        <artifactId>aspectjrt</artifactId>
        <version>${org.aspectj-version}</version>
    </dependency>

    <!-- Logging -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>${org.slf4j-version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${org.slf4j-version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.15</version>
        <exclusions>
            <exclusion>
                <groupId>javax.mail</groupId>
                <artifactId>mail</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.jms</groupId>
                <artifactId>jms</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.jdmk</groupId>
                <artifactId>jmxtools</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.jmx</groupId>
                <artifactId>jmxri</artifactId>
            </exclusion>
        </exclusions>
        <scope>runtime</scope>
    </dependency>

    <!-- @Inject -->
    <dependency>
        <groupId>javax.inject</groupId>
        <artifactId>javax.inject</artifactId>
        <version>1</version>
    </dependency>

    <!-- Misc -->
    <dependency>
        <groupId>commons-lang</groupId>
        <artifactId>commons-lang</artifactId>
        <version>2.6</version>
    </dependency>

    <!-- Servlet -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>

    <!-- Test -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.9</version>
        <scope>test</scope>
    </dependency>
</dependencies> 
```

我的 web.xml 是一个标准的 Spring MVC web.xml，并添加了我的持久性单元定义：

```
<persistence-unit-ref>
    <persistence-unit-ref-name>persistence/myPU</persistence-unit-ref-name>
    <persistence-unit-name>myPU</persistence-unit-name>
</persistence-unit-ref> 
```

我的 DAO 被注入了实体管理器：

```
@PersistenceContext
protected EntityManager entityManager; 
```

最后，这是我的 persistence.xml，它位于我的 META-INF 文件夹下：

```
<persistence-unit name="myPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.transaction.flush_before_completion"
            value="true" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLInnoDBDialect" />
        <property name="hibernate.show_sql" value="true" />
    </properties>
</persistence-unit> 
```

尝试访问数据库时出现 java.sql.SQLException：没有合适的驱动程序：

> java.sql.SQLException: 没有合适的驱动程序 java.sql.DriverManager.getDriver(DriverManager.java:289) com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:223) com.mchange.v2.c3p0.DriverManagerDataSource .getConnection(DriverManagerDataSource.java:119) com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:143) com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:132) com.mchange.v2 .c3p0.impl.C3P0PooledConnectionPoolManager.initializeAutomaticTestTable(C3P0PooledConnectionPoolManager.java:772) com.mchange.v2.c3p0.impl.C3P0PooledConnectionPoolManager.createPooledConnectionPool(C3P0PooledConnectionPoolManager.java:696) com.mchange.v2.c3p0.impl。C3P0PooledConnectionPoolManager.getPool(C3P0PooledConnectionPoolManager.java:257) com.mchange.v2.c3p0.impl.C3P0PooledConnectionPoolManager.getPool(C3P0PooledConnectionPoolManager.java:271) com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:70) org.hibernate.internal.AbstractSessionImpl$NonContextualJdbcConnectionAccess.obtainConnection(AbstractSessionImpl.java:281) org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.obtainConnection( LogicalConnectionImpl.java:297) org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.getConnection(LogicalConnectionImpl.java:169) org.hibernate.engine.jdbc.internal.proxy。ConnectionProxyHandler.extractPhysicalConnection(ConnectionProxyHandler.java:82) org.hibernate.engine.jdbc.internal.proxy.ConnectionProxyHandler.continueInvocation(ConnectionProxyHandler.java:138) org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler. java:81) $Proxy45.prepareStatement(未知来源) org.hibernate.engine.jdbc.internal.StatementPreparerImpl$5.doPrepare(StatementPreparerImpl.java:147) org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl .java:166) org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareQueryStatement(StatementPreparerImpl.java:145) org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1711) org.hibernate.loader.Loader.doQuery （加载器.java：第828章） org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections（Loader.java:289） org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:82) org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:72) org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister. java:3719) org.hibernate.event.internal.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:449) org.hibernate.event.internal.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:418) org.hibernate.event.internal.DefaultLoadEventListener。加载（DefaultLoadEventListener.java:204）组织。hibernate.event.internal.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:251) org.hibernate.event.internal.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:148) org.hibernate.internal.SessionImpl.fireLoad(SessionImpl.java:1079) org.hibernate.internal.SessionImpl.access$2200(SessionImpl.java:172) org.hibernate.internal.SessionImpl$IdentifierLoadAccessImpl.load(SessionImpl.java:2425) org.hibernate.internal.SessionImpl.get(SessionImpl.java:975 ) org.hibernate.ejb.AbstractEntityManagerImpl.find(AbstractEntityManagerImpl.java:807) org.hibernate.ejb.AbstractEntityManagerImpl.find(AbstractEntityManagerImpl.java:781) sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) sun.reflect.NativeMethodAccessorImpl。调用（NativeMethodAccessorImpl.java:57）sun.reflect。DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) java.lang.reflect.Method.invoke(Method.java:601) org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:365) $Proxy44.find (未知来源) sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) java.lang.reflect.Method .invoke(Method.java:601) org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240) $Proxy21.find(Unknown Source) com.yl.tomcat.dal.impl.BasicJpaDao.read (BasicJpaDao.java:48) com.yl.tomcat.app.bl.UserService.updateUserName(UserService.java:17) com.yl.tomcat.web.HomeController.String(HomeController.java:53) sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method ) sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) java.lang.reflect.Method.invoke(Method.java:601) org.springframework.web .method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:212) org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126) org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod .invokeAndHandle(ServletInvocableHandlerMethod.java:96) org.springframework.web.servlet.mvc。method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617) org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578) org.springframework.web.servlet.mvc.method. AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80) org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:900) org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827) org.springframework。 web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) javax.servlet.http.HttpServlet.service(HttpServlet.java:641) javax. servlet.http.HttpServlet。服务（HttpServlet.java:722）

在类似的线程（[this](https://stackoverflow.com/questions/5556664/how-to-fix-no-suitable-driver-found-for-jdbcmysql-localhost-dbname-error-w)和[this](https://stackoverflow.com/questions/11106279/java-sql-sqlexception-no-suitable-driver-when-starting-tomcat-server)）中，通过将 mysql 驱动程序 jar 放在服务器 lib 文件夹中来提供解决方案。($CATALINA_HOME/lib)。目前我的 jar 仅在我的应用程序类路径中，我想知道上述解决方案是否是唯一可用的解决方案（我不喜欢它，它将我的应用程序耦合到我的 tomcat 服务器，这在我看来不是最佳的）？

无论如何 - 即使我将 mysql jar 复制到 tomcat 的 lib 库，它也没有改变任何东西:(我一路上错过了什么吗？

任何帮助都非常感谢，Yogi

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T09:02:53.153

好，我知道了。

如此处所述：http: [//doc.51windows.net/mysql/?url=/mysql/ch23s03.html](http://doc.51windows.net/mysql/?url=/mysql/ch23s03.html) SQLException“没有合适的驱动程序”意味着驱动程序不在您的 CLASSPATH 中或您的 URL 格式不正确。

显然我在那里错过了一个括号：

```
<property name="jdbcUrl" value="${jdbcUrl" /> 
```

我经历了许多解决方案建议，例如：

*   将mysql jar 复制到tomcat。这不是必需的，因为它已经在我的类路径中。
*   安装一个不同的 mysql 连接器（5.1.2-bin 而不是 5.1.2），这也不是必需的。
*   将 Hibernate 版本从 4.1.4 降级到 4.1.1 - 也不需要。

所以我的网址格式不正确。解决此问题后，我遇到了其他一些问题。

例如，在某个时候，我决定将 persistence.xml 位置添加到我的 entitymanager 定义中：

```
<property name="persistenceXmlLocation" value="META-INF/persistence.xml"/> 
```

但后来得到：

> ContainerEntityManagerFactoryBean 在war文件中找不到persistence.xml

问题是我必须在我的路径之前添加类路径（因为 META-INF 自然是在标准 maven 项目格式的类路径下）：

```
<property name="persistenceXmlLocation" value="classpath:META-INF/persistence.xml"/> 
```

由于某种原因，我得到了：

> java.lang.ClassNotFoundException: org.aspectj.util.PartialOrder$PartialComparable

将 aspectjweaver 依赖项添加到我的 pom.xml 解决了这个问题：

```
 <dependency>
    <groupId>org.aspectj</groupId>
    <artifactId>aspectjweaver</artifactId>
    <version>1.6.6</version>
  </dependency> 
```

修复后我得到：

> 错误：org.hibernate.engine.jdbc.spi.SqlExceptionHelper - 用户'testUser'@'localhost'的访问被拒绝（使用密码：是）

我什至尝试重新安装mysql，但到目前为止没有成功。我想我会尝试为此打开一个不同的线程。

# javascript - 如何使搜索框中的单词可点击以使用 jquery 删除它们

> ID：11284327
> 
> 赞同：1
> 
> 时间：2012-07-01T17:50:11.340
> 
> 标签：javascript, jquery, html, textbox

我的网页上有一个搜索框，其中包含诸如“我有一只猫”之类的词，我需要使搜索框中的每个词都可点击。当用户单击该词时，它会被删除，例如用户单击“猫”，该词消失，仅在搜索框中留下“我有一个”。

这就像在创建问题时在 stackoverflow 上有带有标签的东西，它们被转换为带有 X 的可点击图块以丢弃它们。你能为我指出正确的方向吗？我似乎能够在网上找到的只是如何删除整个搜索框的内容，这不是我想要做的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T17:54:25.440

找到了一个起点： [https ://github.com/xoxco/jQuery-Tags-Input](https://github.com/xoxco/jQuery-Tags-Input)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T17:55:05.970

您可能有兴趣查看此[jQuery Tokeninput](http://loopj.com/jquery-tokeninput/)

# java - 如何多次从一个url获取一些文本？

> ID：11284328
> 
> 赞同：0
> 
> 时间：2012-07-01T17:50:37.503
> 
> 标签：java, android, url, web, connect

**这个问题解决了**

抱歉标题-_- 我正在尝试创建一个从网页获取一些文本的应用程序。当您单击“下一步”按钮时，您将转到下一页并更新文本。我遇到的问题是当您单击“下一步”按钮时，文本没有更新。最好我只想运行下面的代码来更新文本。我想我已经把它缩小到我建立连接的方式的问题上。

```
private static BufferedReader page;

public  void checkPage(String website, int number){

    URL url = null;
    HttpURLConnection connection = null;
    String line = "start";

    try {
        url = new URL(website + number);
        connection = (HttpURLConnection) url.openConnection();
        page = new BufferedReader(new InputStreamReader(connection.getInputStream()));

        while (line != null) {

            line = page.readLine();
            checkLine(line);    
        }
        connection.disconnect();

    }catch (IOException e){
        e.printStackTrace();
    }
} 
```

checkLine() 做了一些时髦的事情来获取我想要的文本..感觉就像我错过了一些明显的东西..

当前的设置是我有一个名为“GetDataFromPage”的类，它将数据保存在一些私有字符串变量中，然后我使用“GetDataFromPage”中的一些公共方法来提取数据以供使用..

问题是当我调用 data.checkPage(web, url+1); 时，“GetDataFromPage”类中的数据不想更新。其中数据是 GetDataFromPage

**更新**

我非常愚蠢..只是我忘记重置启用数据读取的一些布尔值。这就是你在深夜编写代码时发生的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:00:46.587

抱歉，我不知道你到底想要什么，因为目前你只是从页面中抓取 1 行，所以你最终只有 line 变量中的最后一行。你在哪里保存它，在你的检查行功能中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T17:58:47.063

尝试这个，

```
private BufferedReader page;       // changed

public  void checkPage(String website, int number){

    URL url = null;
    HttpURLConnection connection = null;
    String line = "null";       // changed

    try {
        url = new URL(website + number);
        connection = (HttpURLConnection) url.openConnection();
        page = new BufferedReader(new InputStreamReader(connection.getInputStream()));

        while ((line=page.readLine()) != null) {   // changed

                                                  // changed
            checkLine(line);    
        }
        connection.disconnect();

    }catch (IOException e){
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T20:51:19.427

将 BufferedReader 更改为非静态并没有真正帮助，但可能会更干净一些。

抱歉没有提到我是如何保存数据的。当前的设置是我有一个名为“GetDataFromPage”的类，它将数据保存在一些私有字符串变量中，然后我使用“GetDataFromPage”中的一些公共方法来提取数据以供使用..

问题是当我调用 data.checkPage(web, url+1); 时，“GetDataFromPage”类中的数据不想更新。其中数据是 GetDataFromPage

**更新**

我非常愚蠢..只是我忘记重置启用数据读取的一些布尔值。这就是你在深夜编写代码时发生的事情。

# javascript - 如何防止 Dojo 滑动手势冒泡？

> ID：11284333
> 
> 赞同：0
> 
> 时间：2012-07-01T17:51:24.610
> 
> 标签：javascript, dojo, dom-events, event-bubbling

我有一个看似简单的问题，但我似乎无法弄清楚我哪里出错了。我的技能在道场中确实缺乏，所以请原谅我的幼稚。

**我想要完成的事情**：我在 DOM 中有一个元素，我想响应**滑动**和**单击**事件。但是，当触发 swipe.end 事件时，也会触发 click 事件。`stopPropagation`我试图通过调用和直接调用事件来防止事件冒泡（我假设在这种情况下事件正在冒泡），`event.stop`但无济于事。您可以在下面查看代码片段，或查看[工作小提琴](http://jsfiddle.net/rtn8h/3/)。

**HTML**

```
<div id='testSwipe'>Swipe Me</div>​ 
```

**JS**

```
require({
}, [ 
    'dojo/dom', 
    'dojox/gesture/swipe',
    'dojo/on',
    'dojo/_base/event'
], function(dom, swipe, on, event) {
    var div = dom.byId('testSwipe');

    on(div, swipe.end, function(e) {
        console.log("### SWIPE");

        e.stopPropagation();  // Click event still fires
        event.stop(e);  // Click event STILL fires
    });

    on(div, 'click', function(e) {
        console.log("### CLICK");
    });
}); 
```

在此示例中，滑动事件将导致以下输出：

```
### SWIPE
### CLICK 
```

有什么建议么？​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T11:07:30.460

问题是两个不同的事件被触发：一个`event`(with `event.type == 'swipe'`) 用于滑动和一个`mouseEvent`用于单击。事件没有冒泡。

如果 swipe.end 事件刚刚触发，则实现您想要的一种方法是阻止 click 事件。感觉有点像黑客，但有效。请参阅[更新的 JSFiddle](http://jsfiddle.net/rtn8h/13/)。

附带说明：防止冒泡的 Dojo 方法似乎是`dojo.stopEvent(e)`按照[docs](https://dojotoolkit.org/reference-guide/1.8/dojox/gesture.html#id9)使用。我确实尝试过，但正如预期的那样，它没有效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T07:10:15.173

当您单击元素时，单击事件将始终触发。您可以使用[dojox/gesture/tap来使用点击手势，而不是使用点击事件](http://dojotoolkit.org/reference-guide/1.9/dojox/gesture.html#dojox-gesture-tap)

```
on(div, tap, function(e) {
    console.log("### CLICK");
}); 
```

更新了[小提琴](http://jsfiddle.net/rtn8h/18/)

# objective-c - Objective-c：执行多个transitionWithView动画块

> ID：11284341
> 
> 赞同：5
> 
> 时间：2012-07-01T17:52:36.013
> 
> 标签：objective-c, uiview, uiviewanimation, uiviewanimationtransition

我正在尝试制作一个简单的西蒙游戏（不断增加的颜色闪烁序列，用户必须尝试重复该序列）。我要解决的方法是拥有 4 个 UIViews 和 8 个图像。所以有一个用于红色、蓝色、绿色和黄色的 UIView。我有深绿色、浅绿色、深红色、浅红色等的 GIF。

所以在我的代码中，我使用 UIView 的 transitionWithView 动画块： UIView imageView.image 默认为深色图像，这个块正在转换为浅色图像，完成后返回深色图像（给它“点亮”的样子）。

```
- (void) animateColor:(NSString *)color
{
    ...
    //do stuff to default the dark and light image name and which UIView to animate based on the color parameter
    ...
    [UIView transitionWithView:imageView
                  duration:.5
                   options: UIViewAnimationOptionTransitionCrossDissolve | UIViewAnimationOptionAutoreverse
                animations:^{
                    imageView.image = [UIImage imageNamed:lightImage];
                } 
                completion:^(BOOL finished){
                    if (finished){
                        imageView.image = [UIImage imageNamed:darkImage];
                    }
                }];
} 
```

当我用一种颜色调用此代码的方法时，这很好用。

问题是，假设我有一个 NSArray 或想要按顺序制作动画的颜色。因此，如果我的数组是“蓝色”、“绿色”，我希望使用蓝色调用 transitionWithView，为蓝色视图设置动画，然后为绿色​​视图设置动画。现在，它将同时为绿色视图和蓝色视图设置动画。

我现在正在尝试使用 NSTimer，但运气不佳。

任何建议都将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T20:02:07.730

当我尝试连续执行多个转换时，我遇到了类似的问题。我通过简单地在完成块中设置一个状态变量来解决它。然后此状态变量启用下一次转换的条件。好吧，因为我使用的是带有 runloop 方法的计时器，所以我的工作在这里更容易：

```
- (void) runloop {

    static int step = 1;

    if (step == 1)
    {
        step = 0;
        [UIView transitionWithView:imageView
                          duration:1
                           options:UIViewAnimationOptionTransitionCrossDissolve
                        animations:^{ imageView.image = [UIImage imageNamed:lightImage]; }
                        completion:^(BOOL finished){ step = 2; }];
    }

    if (step == 2)
    {
        step = 0;
        [UIView transitionWithView:imageView
                          duration:1
                           options:UIViewAnimationOptionTransitionCrossDissolve
                        animations:^{ imageView.image = [UIImage imageNamed:darkImage]; }
                        completion:^(BOOL finished){ step = 0; }];
    }
} 
```

通过这种方式，您可以进行数十次转换，而不会迷失在嵌套块中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T02:09:17.963

好的，所以在玩了一些/很多之后，我找到了解决方案。首先，我将 transitionWithView 更改为如下所示：

```
[UIView transitionWithView:imageView
                  duration:1
                   options: UIViewAnimationOptionTransitionCrossDissolve
                animations:^{
                    imageView.image = [UIImage imageNamed:lightImage];
                } 
                completion:^(BOOL finished){
                    if (finished){
                        [UIView transitionWithView:imageView
                                          duration:1
                                           options:UIViewAnimationOptionTransitionCrossDissolve
                                        animations:^{
                                            imageView.image = [UIImage imageNamed:darkImage];
                                        }
                                        completion:^(BOOL done){
                                            if (done){
                                                // Do some program upkeep logic 
                                            }
                                        }
                         ];
                    }
                }
 ]; 
```

上面最大的变化是删除了我原来的 UIViewAnimationOptionAutoreverse，并在完成块中添加了从浅色图像到深色图像的动画。

然后调用上述方法 (animateColor:)，我循环遍历一个数组并使用具有递增 afterDelay 的执行选择器：

```
 for (NSString *color in self.randomPattern.patternArray) {
        [self performSelector:@selector(animateColor:) withObject:color afterDelay:1.5*self.counter];
        ++self.counter;
    } 
```

# java - 是否可以为不必依赖正确时间来实现正确功能的软件设计更好的方法？

> ID：11284346
> 
> 赞同：-1
> 
> 时间：2012-07-01T17:53:02.190
> 
> 标签：java, networking, time, udp, ntp

似乎很多软件，包括低级系统调用等，都依赖于获取并与正确的时间正确同步才能正常运行。我想知道是否可以实施更好的方法来避免这种依赖关系？..例如依赖硬件生成的固定周期（滴答声）等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:08:00.640

可以编写软件而不依赖于全局同步时间。如果您想了解更多信息，请阅读一本关于分布式编程的书籍，例如这本：[http ://www.amazon.com/Distributed-Systems-Algorithmic-Approach-Information/dp/1584885645/ref=sr_1_12?ie =UTF8&qid=1341166029&sr=8-12&keywords=分布式+系统](https://rads.stackoverflow.com/amzn/click/com/1584885645)

如果你没有时间看书，你可以看看 Vector Clocks：[http ://en.wikipedia.org/wiki/Vector_clock](http://en.wikipedia.org/wiki/Vector_clock)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-03T01:26:20.390

A. 当前的闰秒失败是因为内核错误。而已。

B. 大多数程序不关心时间。

C. 有些程序关心时间，但不关心实际的全球时间，只是一些本地参考。这里的合约是非常简单的*伪代码*：

> long timeFirst = System.GetTime;
> 
> long timeSecond = System.GetTime;
> 
> 断言（timeFirst <= timeSecond）；

D. 是的，有*一些*程序/子系统，正确的全球时间是必不可少的，它们通常为问题做好准备。（例如：您的 GPS 接收器会进行大量计算以找出正确的时间，如果失败，它不会显示您在月球上，但会给您一些不错的错误消息。）

* * *

总而言之：在最近的程序/系统中正确处理了时间。我们只是有一个内核错误。不要做一些 NTP-IS-INHERENTLY-EVIL 的炒作。:)

# algorithm - 分段树第 K 个最大值

> ID：11284349
> 
> 赞同：2
> 
> 时间：2012-07-01T17:53:17.363
> 
> 标签：algorithm, data-structures, segment-tree

嗨，我正在解决段树的问题，但是我无法对段树的查询功能进行一点修改。

实际上我想要的是我的查询函数应该返回索引 Qa 和 Qb 之间的 (int)(TotalArrayLength/3) th 最大元素。

我编写的查询函数返回 index[1-based] a_begin 和 a_end 之间的最大元素。

但我想返回 index[1-based] a_begin 和 a_end 之间的 (int)(TotalArrayLength/3)th 最大元素。

```
 int query(int Nodenumber,int t_begin,int t_end,int a_begin,int a_end)
    {
        if (t_begin>=a_begin && t_end<=a_end)
            return Tree[Nodenumber];
        else
        {
            int mid=((t_begin+t_end)/2);
            int res = -1;

            if (mid>=a_begin && t_begin<=a_end)
                res = max(res,query(2*Nodenumber,t_begin,mid,a_begin,a_end));

            if (t_end>=a_begin && mid+1<=a_end)
                res = max(res,query(2*Nodenumber+1,mid+1,t_end,a_begin,a_end));

            return res;
        }
    } 
```

注意进行查询，我将查询函数称为查询（1,0，N-1，QA，QB）。

我还实现了[以下](http://wcipeg.com/wiki/Segment_tree#Maximum.2Fminimum_prefix.2Fsuffix_sum)伪代码来编写上面的查询函数，

那么我应该如何修改以在 index[1-based] a_begin 和 a_end 之间找到 (int)(TotalArrayLength/3)th 最大元素。

基本上，我要解决的问题是：

最初，数组包含 0 个或更多元素。随机一些数据将被插入到数组的末尾，并且在任何时候都要做一个查询，返回 TotalArraySize/3 th Max Elements in Array build 到目前为止。

另外，我是否为此目的选择了正确的数据结构。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:49:15.930

我的第一个是：

您需要使用 K 大小的排序列表作为每个 query() 调用的返回值。如果查询完全位于中点的左侧或右侧，则返回该结果。如果查询跨越中点，则在每个子节点返回时合并它们的结果。一旦你回到根，然后你返回结果排序列表中的第 k 个元素。

方法签名（在 Java 中）将是：

```
List<Integer> query(int Nodenumber,int t_begin,int t_end,int a_begin,int a_end) 
```

最大堆数据结构可以完成相同的工作。只需从索引之间的项目构建最大堆并弹出头部 k 次。

段树将擅长多个查询，其中堆在整体内存和对数据的单个查询方面会更好。

# git - git pull 后如何查看代码变化？

> ID：11284350
> 
> 赞同：124
> 
> 时间：2012-07-01T17:53:34.890
> 
> 标签：git

我想在执行`git pull`. 目前它只是向我显示哪些文件发生了变化。如何查看更改的代码？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-07-01T17:55:29.917

```
git log --name-status -2 
```

将向您显示最近两次提交更改的文件的名称。

```
git log -p -2 
```

将向您展示更改本身。

拉之前，

```
git fetch
git log --name-status origin/master.. 
```

将显示您将要检索的提交以及文件的名称。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2012-09-27T23:10:59.093

## 拉动前

您可以按照@iblue 所说的在合并之前使用`fetch`and来查看更改：`diff`

```
$ git fetch
$ git diff master...origin/master 
```

请注意三重时期，这意味着与共享父级和原点/主控的差异（提交标记`x`如下）：

```
SP---o---o [master]
  \
   x---x [origin/master] 
```

## 就在拉动之后

拉取输出的第一行如下所示：

```
$ git pull
Updating 37b431a..b2615b4
... 
```

然后，您可以简单地执行以下操作：

```
$ git diff 37b431a..b2615b4 
```

或任何其他命令：

```
$ git log --name-status 37b431a..b2615b4 
```

## 稍后的

如果距您拉动已经有一段时间了，并且您想知道上次拉动带来了哪些变化，您可以通过以下方式查找：

```
$ git reflog | grep -A1 pull | head -2 
```

这将显示拉取之后的哈希，然后是拉取之前的哈希：

```
b2615b4 HEAD@{0}: pull : Fast-forward
37b431a HEAD@{1}: checkout: moving from v6.1 to master 
```

然后你可以用这两个哈希做同样的事情：

```
git diff 37b431a..b2615b4 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-07-01T18:01:37.747

因为`git pull`只是 and 的快捷方式`git fetch`，`git merge`您可以运行`git fetch`以从原点获取分支，然后在合并之前显示差异。像这样：

```
git fetch                      # Load changes from remote server
git diff master origin/master  # Show differences
git merge origin/master        # Merge remote changes with local changes 
```

*如果您在与master*不同的分支上运行，您当然应该在上面的命令中更改分支名称。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-01-26T06:13:12.347

您可以通过以下方式将提取的内容与之前提交的源进行比较，

```
git diff branch_name@{1} 
```

例如：

```
git diff master@{1} 
```

为了与后面的 n 个提交进行比较，

```
git diff branch_name@{n} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-01T18:02:01.127

您可以通过此检查在推拉时会发生什么变化...

```
git log --stat 
```

# css - 试图在 ul 中垂直居中图像

> ID：11284353
> 
> 赞同：1
> 
> 时间：2012-07-01T17:53:48.270
> 
> 标签：css, html-lists, image

只是一个关于在水平 ul 导航中垂直居中图像的快速方法

[http://i.imgur.com/GD7NQ.png](http://i.imgur.com/GD7NQ.png)

我希望 F 和 Twitter 垂直居中..

这是我的代码

```
<div id="nav" class="twelvecol last">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About Us</a></li>
            <li><a href="#">News</a></li>
            <li><a href="#">Gallery</a></li>
            <li><a href="#">Sponsors</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#"><img src="images/fb.png"></a></li>
            <li><a href="#"><img src="images/twitter.png"></a></li>             
        </ul>   
    </div>

#nav
{

}

#nav ul
{
    height:60px;
    text-align:center;
    background: #cc0000; /* Old browsers */
    background: -moz-linear-gradient(top,  #cc0000 0%, #7c0000 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#cc0000), color-stop(100%,#7c0000)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #cc0000 0%,#7c0000 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #cc0000 0%,#7c0000 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #cc0000 0%,#7c0000 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #cc0000 0%,#7c0000 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#cc0000', endColorstr='#7c0000',GradientType=0 ); /* IE6-9 */

}

#nav li
{
    display:inline-block;
    font-size:18px;

}

#nav li a
{
    color:#FFF;
    padding-top:20px;
    padding-left:20px;
    padding-right:20px;
    padding-bottom:20px;
    list-style-type:none;
    text-decoration:none;
}

#nav li a:hover{
    background:#F00;

} 
```

谢谢你尽你所能的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:37:24.577

对于 Facebook 和 Twitter 的图形链接，我个人会使用背景图片替换文本。

背景图像意味着您可以简单地使用`[background-position](http://w3.org/tr/css21/colors.html#propdef-background-position)`和/或`height`等来控制垂直放置。

[http://www.mezzoblue.com/tests/revised-image-replacement/](http://www.mezzoblue.com/tests/revised-image-replacement/)列出了很多方法，我更喜欢使用`text-indent`.

# python - 判断一个整数是否是圆素数

> ID：11284354
> 
> 赞同：2
> 
> 时间：2012-07-01T17:53:53.287
> 
> 标签：python, primes

我一直在尝试解决项目欧拉问题 35，并且需要创建一个函数来告诉我整数是否是循环素数。我有一个标准`isprime`函数和一个给出数字旋转列表的函数。我的旋转代码和`iscircularprime`代码在这里：

```
def rotate(n):
    rotlist = []
    m = str(n)
    counter = 0
    while counter < len(str(n)):
        m = m[1:] + m[0]
        rotlist.append(int(m))
        counter += 1
    return rotlist

def iscircularprime(n):
    np = [0,2,4,5,6,8]
    y = str(n)
    for j in y:
        if int(j) in np:
            return False
    if isprime(n)==False:
        return False
    m = rotate(n)
    for i in m:
        if isprime(i)==True:
            return True
        else:
            return False 
```

我没有包括我的`isprime`功能，因为它是相当标准的。我的函数将正确识别素数是否为圆形，例如 197，但也会将一些非圆形素数识别为圆形，例如 191，它不是圆形的，因为 119 不是素数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T17:58:21.790

旋转一圈后，您`return True`不会检查所有圆形素数。您应该将其更改为：

```
def iscircularprime(n):
    np = [0,2,4,5,6,8]
    y = str(n)
    for j in y:
        if int(j) in np:
            return False
    if isprime(n)==False:
        return False
    m = rotate(n)

    # new code here
    is_circ_prime = True
    for i in m:
        if not isprime(i):
            is_circ_prime = False
    return is_circ_prime 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:27:44.677

未经测试，但我认为这就是我几年前解决它的方法。

最简单的方法是快速帮手：

```
from collections import deque
def shifter(num):
 strnum = deque(str(num))
 for i in xrange(len(strnum)):
     yield int(''.join(strnum))
     strnum.rotate() 
```

然后：

```
sum(1 for i in xrange(1000000) if all(is_prime(p) for p in shifter(i)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-25T23:05:42.370

强制性低效的单线解决方案。语句的左侧是素数检查器，右侧是旋转生成器：

```
from math import factorial as f

def is_circular_prime(n):
    return (lambda s: all(f(i - 1) % i == i - 1 for i in (int(s[j:] + s[:j]) for j in range(len(s)))))(str(n))

for number in range(2, 10000):
    if is_circular_prime(number):
        print(number) 
```

**输出**

```
> python3 test.py
2
3
5
7
11
13
17
31
37
71
73
79
97
113
131
197
199
311
337
373
719
733
919
971
991
1193
1931
3119
3779
7793
7937
9311
9377
> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-15T17:44:02.803

这是一个循环任意数字的函数：

```
def circulate_number(A):
  for v in range(len(str(A))):
        a , i , s =  str(A), len(str(A)), ''
        for c in range(i):
              s += str(a[(v+c) % i])
        print(s)
        v+= 1

circulate_number(123456) 
```

# java - 使用 JPA 在 PostgreSQL 中持久化 UUID

> ID：11284359
> 
> 赞同：32
> 
> 时间：2012-07-01T17:54:35.160
> 
> 标签：java, hibernate, postgresql, jpa, uuid

我正在尝试在 PostgreSQL 中保留一个使用 UUID 作为主键的实体。我尝试将其作为普通 UUID 保存：

```
@Id
@Column(name = "customer_id")
private UUID id; 
```

有了上面，我得到了这个错误：

```
ERROR: column "customer_id" is of type uuid but expression is of type bytea
Hint: You will need to rewrite or cast the expression.
Position: 137 
```

我还尝试将 UUID 持久化为 byte[] 无济于事：

```
@Transient
private UUID id;

@Id
@Column(name = "customer_id")
@Access(AccessType.PROPERTY)
@Lob
protected byte[] getRowId() {
    return id.toString().getBytes();
}

protected void setRowId(byte[] rowId) {
    id = UUID.fromString(new String(rowId));
} 
```

如果我删除@Lob，我得到的错误与上面发布的错误相同。但是应用@Lob 后，错误会略微更改为：

```
ERROR: column "customer_id" is of type uuid but expression is of type bigint
Hint: You will need to rewrite or cast the expression.
Position: 137 
```

不能做这么简单的事情，我感觉非常糟糕！

我正在使用 Hibernate 4.1.3.Final 和 PostgreSQL 9.1。

我已经或多或少地看到了许多关于相同问题的问题，但它们都很老，似乎没有一个直接的答案。

我想以一种标准的方式来实现这一点，而不是诉诸丑陋的黑客。但是，如果这只能通过（丑陋的）黑客来实现，那么这就是我要做的。但是，我不想将 UUID 作为 varchar 存储在数据库中，因为这不利于性能。另外，如果可能的话，我不想在我的代码中引入 Hibernate 依赖项。

任何帮助将不胜感激。

*更新 1* (2012-07-03 12:15 pm)

嗯，嗯，嗯......这有点有趣，我使用 JTDS 驱动程序（v1.2.5）和 SQL Server 2008 R2 测试了完全相同的代码（纯 UUID，没有转换——上面发布的代码的第一个版本）和，你猜怎么着，它就像一个魅力（当然我必须在persistence.xml 中更改与连接相关的信息）。

现在，它是特定于 PostgreSQL 的问题还是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-10T17:16:40.003

不幸的是，PostgreSQL JDBC 驱动程序选择了一种表示非 JDBC 标准类型代码的方式。他们只是将所有这些映射到 Types.OTHER。长话短说，您需要启用特殊的 Hibernate 类型映射来处理 UUID 映射（到 postgres 特定的 uuid 数据类型的列）：

```
@Id
@Column(name = "customer_id")
@org.hibernate.annotations.Type(type="org.hibernate.type.PostgresUUIDType")
private UUID id; 
```

或更简洁地说：

```
@Id
@Column(name = "customer_id")
@org.hibernate.annotations.Type(type="pg-uuid")
private UUID id; 
```

另一个（更好的）选项是将 org.hibernate.type.PostgresUUIDType 注册为作为 java.util.UUID 公开的所有属性的默认 Hibernate 类型映射。这包含在文档@ [http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch06.html#types-registry](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch06.html#types-registry)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-06-26T15:12:55.300

JPA 2.1 提供了一种非常简单的方法来使用 PostgreSQL uuid 列类型并`java.util.UUID`作为相应实体字段的类型：

```
@javax.persistence.Converter(autoApply = true)
public class PostgresUuidConverter implements AttributeConverter<UUID, UUID> {

    @Override
    public UUID convertToDatabaseColumn(UUID attribute) {
        return attribute;
    }

    @Override
    public UUID convertToEntityAttribute(UUID dbData) {
        return dbData;
    }

} 
```

只需将此类添加到您的持久性配置中，并使用`@Column(columnDefinition="uuid")`.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-12-20T04:38:17.217

要让它与 Hibernate 5.1.x 一起使用，您可以[在此处关注 Steve Ebersole 评论](https://hibernate.atlassian.net/browse/HHH-9562?focusedCommentId=66756&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-66756)

```
@Id
@GeneratedValue
@Column( columnDefinition = "uuid", updatable = false )
public UUID getId() {
    return id;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-09T09:28:35.507

较新版本`>= 8.4-701`的 Postgresql JDBC 驱动程序正确处理`java.util.UUID`映射。休眠也是如此`>= 4.3.x`。

请参阅[https://stackoverflow.com/a/780922/173149](https://stackoverflow.com/a/780922/173149)上的详细信息：

```
Map the database uuid type to java.util.UUID.
This only works for relatively new server (8.3) and JDK (1.5) versions. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-30T08:27:39.407

Oleg 建议的解决方案对我来说并不完美（如果您尝试保留空值，它会失败）。这是一个经过调整的解决方案，也适用于空值。

在我的情况下，我使用的是 EclipseLink，所以如果你使用的是 Hibernate，你可能不需要这个。

```
public class UuidConverter implements AttributeConverter<UUID, Object> {
    @Override
    public Object convertToDatabaseColumn(UUID uuid) {
        PGobject object = new PGobject();
        object.setType("uuid");
        try {
            if (uuid == null) {
                object.setValue(null);
            } else {
                object.setValue(uuid.toString());
            }
        } catch (SQLException e) {
            throw new IllegalArgumentException("Error when creating Postgres uuid", e);
        }
        return object;
    }

    @Override
    public UUID convertToEntityAttribute(Object dbData) {
        return (UUID) dbData;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-07T11:17:13.053

在 postgresql url 连接上添加这个标志：?stringtype=unspecified

像那样

jdbc:postgresql://localhost:5432/yourdatabase?stringtype=unspecified

# c# - 在 OpenCL 中保存数据

> ID：11284360
> 
> 赞同：0
> 
> 时间：2012-07-01T17:54:55.363
> 
> 标签：c#, opencl

我需要在OpenCL中长时间处理一些数据，并且由于时间限制（驱动程序自动重启）我多次使用不同的参数启动内核。每次它必须处理相同的数据，大约 50 Mb，所以我只想复制一次。我已经阅读了很多关于 OpenCL 的文章和教程，但不知道如何做到这一点，以保持执行之间的数据。

如果它很重要，我会为 OpenCL 使用 C# 绑定，称为 OpenCLTemplate。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T16:26:20.677

您存储在全局内存缓冲区中的任何数据都将保留在 GPU 上。你不需要做任何特别的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T23:34:12.020

为什么不能只为所有内核执行保留一个只读缓冲区并将结果放在不同的缓冲区中？

是什么让你认为你必须写入你正在读取的同一个缓冲区？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T21:15:29.833

你有几个问题；

1）如何将 50MB 的数据传输到 GPU 2）在 Windows 上，当您运行长时间计算时，GPU 驱动程序会频繁重置 3）约 50MB 的持久性机制

可能的答案 1a) 创建一个 50M 的 OpenCL 内存缓冲区 1b) 将数据排队（写入）到 GPU 1c) 将内核 arg 设置到此缓冲区 1d) 作为内核 arg 访问 GPU 全局内存中的数据

2）当 OpenCL 驱动程序（图形）驱动程序重置时，您的应用程序将死机。您可以编写脚本在系统执行之前将其杀死，然后重新启动应用程序。该脚本应在终止应用程序之前回读中间结果。否则你永远无法控制。仅在 Windows 上使用 Nvida Tesla GPU 运行或在 Linux 上运行将避免 O/S 认为显示器无法正常工作并重置驱动程序。

3) 我会使用 MMAPed 文件来保存 50MB 的数据和任何中间结果。MMAPed 文件地址可用于为应用程序创建 OpenCL 缓冲区。

最后，我会质疑这种方法。在 Windows 和 Linux 上运行，由于驱动程序重置问题等等。即使使用 PostgreSQL 数据库和我自己的 PgOpenCL，我也找不到有效的解决方案来解决 Windows 上的驱动程序超时问题，这保证了所有 GPU 内核执行都是 ACID。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-01T23:29:31.847

正如我从在线阅读中了解到的那样，只能同时运行一个内核。这意味着您应该能够使用一组参数启动它，完成后可以启动一组新参数，然后在运行时您可以读出 50mb。

如果驱动程序重新启动 - 这可能是由于错误/异常？

# c# - 选定的选项卡索引 C#

> ID：11284364
> 
> 赞同：-3
> 
> 时间：2012-07-01T17:55:07.000
> 
> 标签：c#, .net

**我有一个私有数组，`TabPage[] tp = new TabPage[10]` 如何获取所选选项卡的索引**（数组索引，而不是选项卡索引）**？**

**数组索引**和**选项卡索引**之间的区别

 **示例：我选择了一个选项卡。**数组索引**可以是 1 但信息包含在 tp[8]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T17:59:04.317

```
var SelectedArrayTabIndex = Array.IndexOf(tp, SelectedTab); 
```**

# google-maps - 使用 LatLng 放置标记时出现奇怪的异常

> ID：11284367
> 
> 赞同：0
> 
> 时间：2012-07-01T17:55:30.053
> 
> 标签：google-maps, gwt, exception

我有这段代码应该使用 LatLng 在地图上放置一个标记

```
 ...
geocoder = Geocoder.create();
myOptions = MapOptions.create();        
myOptions.setZoom(18);
myOptions.setMapTypeId(MapTypeId.HYBRID);
myOptions.setMapMaker(true);
map = GoogleMap.create(
    Document.get().getElementById("map_canvas"),myOptions);  
location = LatLng.create(45.48592686713835,-73.49009937672122);
map.setCenter(location.getGeometry().getLocation());
marker = Marker.create();
marker.setMap(map);
marker.setPosition(location.getGeometry().getLocation());
    location = LatLng.create(45.48592686713835,-73.49009937672122);
    map.setCenter(location.getGeometry().getLocation());
    marker = Marker.create();
    marker.setMap(map);
    marker.setPosition(location.getGeometry().getLocation()); 
```

但相反，我得到了一个例外。`%20`经度前面好像有一个

有 StackTrace

```
Caused by: com.google.gwt.core.client.JavaScriptException: (Error): Invalid value for property <center>: http://127.0.0.1:8888/m3t/hosted.html?m3t
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:248)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeVoid(ModuleSpace.java:289)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeVoid(JavaScriptHost.java:107)
    at com.google.maps.gwt.client.GoogleMap$.setCenter$(GoogleMap.java)
    at com.tb.ttt.client.view.component.Map.setMarker(Map.java:121)
    at com.tb.ttt.client.view.component.Map.codeAddress(Map.java:110)
    at com.tb.ttt.client.view.component.Map.setData(Map.java:85)
    at com.tb.ttt.client.view.component.PopupMap.onAttach(PopupMap.java:95)
    at com.google.gwt.user.client.ui.Widget.setParent(Widget.java:475)
    at com.google.gwt.user.client.ui.Panel.adopt(Panel.java:127)
    at com.google.gwt.user.client.ui.ComplexPanel.add(ComplexPanel.java:97)
    at com.google.gwt.user.client.ui.AbsolutePanel.add(AbsolutePanel.java:97)
    at com.google.gwt.user.client.ui.PopupPanel$ResizeAnimation.onInstantaneousRun(PopupPanel.java:344)
    at com.google.gwt.user.client.ui.PopupPanel$ResizeAnimation.setState(PopupPanel.java:239)
    at com.google.gwt.user.client.ui.PopupPanel.show(PopupPanel.java:1010)
    at com.google.gwt.user.client.ui.PopupPanel.center(PopupPanel.java:523)
    at com.tb.ttt.client.view.component.PopupMap.<init>(PopupMap.java:65)
    at com.tb.ttt.client.presenter.HpParamImmPresenter$3.onClick(HpParamImmPresenter.java:140)
    at com.google.gwt.event.dom.client.ClickEvent.dispatch(ClickEvent.java:54)
    at com.google.gwt.event.dom.client.ClickEvent.dispatch(ClickEvent.java:1)
    at com.google.gwt.event.shared.GwtEvent.dispatch(GwtEvent.java:1)
    at com.google.web.bindery.event.shared.EventBus.dispatchEvent(EventBus.java:40)
    at com.google.web.bindery.event.shared.SimpleEventBus.doFire(SimpleEventBus.java:193)
    at com.google.web.bindery.event.shared.SimpleEventBus.fireEvent(SimpleEventBus.java:88)
    at com.google.gwt.event.shared.HandlerManager.fireEvent(HandlerManager.java:127)
    ... 31 more
[WARN] 404 - GET /(45.48592686713835,%20-73.49009937672122) (127.0.0.1) 1427 bytes
   Request headers
      Host: 127.0.0.1:8888
      User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20100101 Firefox/11.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-us,en;q=0.5
      Accept-Encoding: gzip, deflate
      Connection: keep-alive
      Referer: http://127.0.0.1:8888/m3t/hosted.html?m3t
      Cookie: JSESSIONID=1lkcmpo9v6f8j
   Response headers
      Content-Type: text/html; charset=iso-8859-1
      Content-Length: 1427 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:47:51.970

`map.Center()`需要 a `LatLng`，因此您不需要对现有的 进行任何转换`LatLng`：

```
map.setCenter(location.getGeometry().getLocation()); 
```

应该

```
map.setCenter(location); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-01T18:24:55.930

```
<link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css">
        <script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>
        <script type="text/javascript">
            var map;
            function initialize() {
                var mapOptions = {
                    center: new google.maps.LatLng(45.48592686713835,-73.49009937672122),
                    zoom: 18,
                    mapTypeId: google.maps.MapTypeId.SATELLITE,
                    heading: 90,
                    tilt: 45
                };
                map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
                var location = new google.maps.LatLng(45.48592686713835,-73.49009937672122);
                var marker = new google.maps.Marker({
                    position: location,
                    map: map
                });
                marker.setTitle("Title");
                var infowindow = new google.maps.InfoWindow(
                { content: "Message",
                    size: new google.maps.Size(50,50)
                });
                google.maps.event.addListener(marker, 'click', function() {
                    infowindow.open(map,marker);
                });
            }

            function rotate90() {
                var heading = map.getHeading() || 0;
                map.setHeading(heading + 90);
            }

            function autoRotate() {
                // Determine if we're showing aerial imagery
                if (map.getTilt() != 0) {
                    window.setInterval(rotate90, 3000);
                }
            }

            google.maps.event.addDomListener(window, 'load', initialize);
        </script> 
```

使用此脚本可能会对您有所帮助。这个对我有用..

# java - AutoCompleteTextView 强制显示所有项目

> ID：11284368
> 
> 赞同：19
> 
> 时间：2012-07-01T17:55:35.923
> 
> 标签：java, android, autocompletetextview

在我的应用程序中有一个时刻，无论用户输入什么，我都需要强制显示建议列表中的所有项目。我怎样才能做到这一点？

我尝试对过滤做一些事情，但对我来说，作为初学者过滤太复杂了，我尝试搜索初学者教程进行过滤，但没有任何运气。也许，有一种更简单的方法可以强制显示所有建议项？

编辑：基本上我的想法是，当用户键入列表中没有的内容时，它会显示他可以拥有的所有可用选项。

我找到了检查天气是否显示 ACTV 的最佳方法，但是 onTextChangeEvent 我将用户键入的文本与我的列表进行比较，然后如果没有找到任何元素则显示完整列表。

```
public void onTextChanged(CharSequence s, int start, int before, int count)
         {                
           final EditText editText = (EditText) findViewById(R.id.vardsUserInput);
            String strValue = editText.getText().toString().toUpperCase();
            String temp;
            int Cc=0; //my count variable
            for(int i=0; i<vardi.length; i++)
            {
                temp = vardi[i].toUpperCase();
                if(temp.startsWith(strValue.toUpperCase()))
                {
                    Log.d("testing",vardi[i]);
                    Cc++;                                                   
                }
            }               
        if(Cc == 0)
        {
        //Show all the available options
    textView.showDropDown();                    
         }                  
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-01T18:07:04.473

当您想要显示所有结果时，您没有定义“时刻”，所以我希望这适合。但是尝试这样的事情：

```
AutoCompleteTextView autoComplete;
String savedText;

public void showAll() {
    savedText = autoComplete.getText().toString();
    autoComplete.setText("");
    autoComplete.showDropDown();
}

public void restore() {
    autoComplete.setText(savedText);
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-11-08T09:13:25.247

这对我来说非常有效，这是解决问题的简单方法：

```
final ArrayAdapter<String> adapter = new ArrayAdapter<>(getContext(), android.R.layout.simple_dropdown_item_1line, usernameLists);
    etUsername.setThreshold(1);
    etUsername.setAdapter(adapter);
    etUsername.setOnTouchListener(new View.OnTouchListener() {

        @SuppressLint("ClickableViewAccessibility")
        @Override
        public boolean onTouch(View paramView, MotionEvent paramMotionEvent) {
            if (usernameLists.size() > 0) {
                // show all suggestions
                if (!etUsername.getText().toString().equals(""))
                    adapter.getFilter().filter(null);
                etUsername.showDropDown();
            }
            return false;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2020-02-14T09:38:53.917

要阻止适配器过滤，您可以在 textview 上设置足够高的阈值：

```
autoCompleteTextView.setThreshold(100); 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-07-03T00:03:26.970

基本上，经过 5-6 小时的实验以了解该死的过滤器是如何工作的，我编写了自己的适配器，它完全符合我的要求：

```
 public class burtuAdapteris extends ArrayAdapter<String> implements Filterable {

       ArrayList<String> _items = new ArrayList<String>();
       ArrayList<String> orig = new ArrayList<String>();

       public burtuAdapteris(Context context, int resource, ArrayList<String> items) {
           super(context, resource, items);    

           for (int i = 0; i < items.size(); i++) {
                orig.add(items.get(i));
            }
       }

       @Override
       public int getCount() {
           if (_items != null)
               return _items.size();
           else
               return 0;
       }

       @Override
       public String getItem(int arg0) {
           return _items.get(arg0);
       }

      @Override

      public Filter getFilter() {
          Filter filter = new Filter() {
              @Override
              protected FilterResults performFiltering(CharSequence constraint) {

                  if(constraint != null)
                      Log.d("Constraints", constraint.toString());
                  FilterResults oReturn = new FilterResults();

                /*  if (orig == null){
                    for (int i = 0; i < items.size(); i++) {
                        orig.add(items.get(i));
                    }
                  }*/
                  String temp;  
                  int counters = 0;
                  if (constraint != null){

                      _items.clear();
                      if (orig != null && orig.size() > 0) {
                          for(int i=0; i<orig.size(); i++)
                            {                           
                                temp = orig.get(i).toUpperCase();

                                if(temp.startsWith(constraint.toString().toUpperCase()))
                                {

                                     _items.add(orig.get(i));               
counters++;

                                }
                            }
                      }
                      Log.d("REsult size:" , String.valueOf(_items.size()));
                          if(!counters)
                          {
                             _items.clear();
                             _items = orig;
                          }
                      oReturn.values = _items;
                      oReturn.count = _items.size();
                  }
                  return oReturn;
              }

              @SuppressWarnings("unchecked")
              @Override
              protected void publishResults(CharSequence constraint, FilterResults results) {
                  if(results != null && results.count > 0) {
                        notifyDataSetChanged();
                        }
                        else {
                            notifyDataSetInvalidated();
                        }

              }

            };

          return filter;

      }

 } 
```

而且它使用简单，只需用这个替换原来的适配器：

```
final burtuAdapteris fAdapter = new burtuAdapteris(this, android.R.layout.simple_dropdown_item_1line, liste); 
```

在我的情况下，列表是：`ArrayList<String> liste = new ArrayList<String>();`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-25T11:43:34.900

方法强制显示下拉列表。

你需要调用 requestFocus(); 显示键盘，否则键盘不会弹出。

```
autocomptv.setOnTouchListener(new OnTouchListener() {

        @SuppressLint("ClickableViewAccessibility")
        @Override
        public boolean onTouch(View paramView, MotionEvent paramMotionEvent) {
            // TODO Auto-generated method stub
            autocomptv.showDropDown();
            autocomptv.requestFocus();
            return false;
        }
    }); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-15T22:48:27.467

正如“ArtOfWarfare”所建议的那样，您可以子类并覆盖 performFiltering()：

```
public class My_AutoCompleteTextView extends AutoCompleteTextView {
    public My_AutoCompleteTextView(Context context) {
        super(context);
    }
    public My_AutoCompleteTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }
    public My_AutoCompleteTextView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    protected void performFiltering(CharSequence text, int keyCode) {
        super.performFiltering("", 0);
    }
} 
```

我正在成功使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-20T12:42:12.403

如果您想立即显示建议，则必须覆盖`enoughToFilter()`以使其始终返回 true。要忽略作为文本输入给出的内容，您必须使用`performFiltering("", 0)`空过滤模式。AutoCompleteTextView 然后显示所有建议。

这是我从其他 StackOverflow 帖子中结合的解决方案：

```
public class InstantAutoComplete extends android.support.v7.widget.AppCompatAutoCompleteTextView {
    public InstantAutoComplete(Context context) {
        super(context);
    }

    public InstantAutoComplete(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public InstantAutoComplete(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    public boolean enoughToFilter() {
        return true;
    }

    @Override
    protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {
        super.onFocusChanged(focused, direction, previouslyFocusedRect);

        if (focused && getAdapter() != null) {
            performFiltering("", 0);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-05T10:17:56.363

这对我有用：

```
 public class CustomAutoCompleteTextView extends AutoCompleteTextView {
    public CustomAutoCompleteTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public boolean enoughToFilter() {
        return true;
    }

    @Override
    protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {
        super.onFocusChanged(focused, direction, previouslyFocusedRect);
        if (focused) {
            performFiltering(getText(), 0);
        }
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        this.showDropDown();
        return super.onTouchEvent(event);
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-01-10T11:55:48.577

简单易行的答案是：

`autoCompleteTextView.setText("")`像这样从适配器中删除过滤器后：

`autoCompleteTextView.adapter.filter.filter(null)`

就是这样，过滤消失了，整个下拉列表都显示出来了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-12-04T23:24:31.957

```
class InstantAutoComplete(context: Context?, attrs: AttributeSet?) : AutoCompleteTextView(context, attrs) {

override fun enoughToFilter(): Boolean {
    return true
}

override fun onFocusChanged(focused: Boolean, direction: Int, previouslyFocusedRect: Rect?) {
    super.onFocusChanged(focused, direction, previouslyFocusedRect)
    if (focused && filters != null) {
        performFiltering(text, 0)
    }
}

fun performFilter() {
    performFiltering(text, 0)
    showDropDown()
} 
```

}

单击按钮下拉（图像视图）后，我需要显示来自 autocompletetextview 的所有数据。使用类扩展 AutoCompleteTextView 并添加此功能，它就像魔术一样工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-30T09:26:23.063

1.  autoComplete.setText("")
2.  过滤器 { it.contains(constraint.trim(), true) } }

注意：您必须使用空格文本为自动完成设置文本，并且在过滤器中，您应该修剪约束文本输入，它将显示所有下拉列表。

# visual-studio-2010 - Git Extensions 或 Git Source Control Provider 可以与 AnkhSVN 一起工作吗？

> ID：11284370
> 
> 赞同：3
> 
> 时间：2012-07-01T17:55:52.823
> 
> 标签：visual-studio-2010, visual-studio, ankhsvn, git-extensions

我正在尝试将我的项目转移到 Git，但我对它还不是很满意。我想使用 Git Extensions 或 Git Source Control Provider，但我不确定它是否适用于 AnkhSVN。当然，我将在解决方案中仅使用其中一个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T18:17:17.950

是的，它可以与其他源代码控制提供程序 (SCP) 一起使用，但您需要确保您的`.sln`文件（解决方案）没有直接声明 SCP 要使用什么。

```
Microsoft Visual Studio Solution File, Format Version 9.00
# Visual Studio 2005
Project...
EndProject
Global
 GlobalSection(Subversion) = preSolution
 SourceControlProvider = Subversion
 EndGlobalSection
...
EndGlobal 
```

还要检查您的项目文件 ( `.proj`)：

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
 <PropertyGroup>
  ...
  <SccProjectName>Subversion</SccProjectName>
  <SccLocalPath>Subversion</SccLocalPath>
  <SccAuxPath>Subversion</SccAuxPath>
  <SccProvider>Subversion</SccProvider>
 </PropertyGroup>
... 
```

如果这些文件（`.sln`或`.proj`）明确提到了 SCP，那么即使您在选项中选择了正确的插件（请参阅“[将 Git 与 Visual Studio 2010 一起使用，介绍](http://blog.discountasp.net/using-git-with-visual-studio-2010-an-introduction-2/)”），您也可能会遇到问题：

![Visual Studio 中源代码管理的插件选择](../Images/ce9244ea4afa0581202d50ef2db38556.png)

当您打开其解决方案时，Visual Studio 仍会为您的项目使用 SVN（即所有 git 菜单和选项将立即停用）

# performance - 提高three.js中动画精灵的性能

> ID：11284372
> 
> 赞同：6
> 
> 时间：2012-07-01T17:56:03.443
> 
> 标签：performance, animation, three.js, sprite

现在我正在开发一款在线游戏，出于性能原因，我决定使用 webgl 而不是 HTML5 的画布。我正在使用three.js 框架，我的目的是让动画精灵移动。精灵本身被放置在精灵表上，我使用 UVOffset 和 UVScale 来使用正确的艺术并在经过的时间切换 Sprite 的艺术。我想知道是否有办法提高这段代码的性能，因为现在它开始放慢速度，同时在场上大约有 300 名“玩家”。

问候

以下是我的代码中最重要的部分：

```
var image = THREE.ImageUtils.loadTexture( "img/idlew.png" );

  function addPlayer(){
    var mesh = new THREE.Sprite({map:image});//, affectedByDistance: false, useScreenCoordinates: false});
    images.push(mesh);
    mesh.position.set(Math.floor(Math.random() * 500), Math.floor(Math.random() * 500), 10);
    scene.add(mesh);
    mesh.uvScale.x = 96/1152;
    mesh.scale.x = 0.1;
    mesh.scale.y = 0.1;
  }

var imgBackground  = new THREE.MeshLambertMaterial({
      map:THREE.ImageUtils.loadTexture('img/grass.jpg')
  });

   var background = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000),imgBackground);

  scene.add(background);

  scene.add(camera);
camera.rotation.x = -(Math.PI/2);
scene.add(new THREE.AmbientLight(0xFFFFFF));

addPlayer();

  renderer.render(scene, camera);
  var moveUp = false;
  tick();
  var ticker = 0;
  var usedOne = 0;

  function tick(){
    ticker++;
    if(ticker%10==0){
      for (var i = 0; i < images.length; i++) {
        images[i].uvOffset.x = usedOne * 0.0835;
      };
        usedOne++;
        if(usedOne == 12) usedOne = 0;
        addPlayer();
        addPlayer();
        addPlayer();
        console.log(images.length);
    }
    requestAnimationFrame( tick );

      renderer.render(scene, camera);
  } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-03T02:38:04.243

我编写了一个代码示例来显示动画纹理，现场示例位于：

[http://stemkoski.github.com/Three.js/Texture-Animation.html](http://stemkoski.github.com/Three.js/Texture-Animation.html)

来源：

[http://github.com/stemkoski/stemkoski.github.com/blob/master/Three.js/Texture-Animation.html](http://github.com/stemkoski/stemkoski.github.com/blob/master/Three.js/Texture-Animation.html)

有用的部分是我编写的用于自动处理偏移的函数。函数（摘自上面的链接）如下：

```
function TextureAnimator(texture, tilesHoriz, tilesVert, numTiles, tileDispDuration) 
{   
    // note: texture passed by reference, will be updated by the update function.

    this.tilesHorizontal = tilesHoriz;
    this.tilesVertical = tilesVert;

    // how many images does this spritesheet contain?
    //  usually equals tilesHoriz * tilesVert, but not necessarily,
    //  if there at blank tiles at the bottom of the spritesheet. 
    this.numberOfTiles = numTiles;
    texture.wrapS = texture.wrapT = THREE.RepeatWrapping; 
    texture.repeat.set( 1 / this.tilesHorizontal, 1 / this.tilesVertical );

    // how long should each image be displayed?
    this.tileDisplayDuration = tileDispDuration;

    // how long has the current image been displayed?
    this.currentDisplayTime = 0;

    // which image is currently being displayed?
    this.currentTile = 0;

    this.update = function( milliSec )
    {
        this.currentDisplayTime += milliSec;
        while (this.currentDisplayTime > this.tileDisplayDuration)
        {
            this.currentDisplayTime -= this.tileDisplayDuration;
            this.currentTile++;
            if (this.currentTile == this.numberOfTiles)
                this.currentTile = 0;
            var currentColumn = this.currentTile % this.tilesHorizontal;
            texture.offset.x = currentColumn / this.tilesHorizontal;
            var currentRow = Math.floor( this.currentTile / this.tilesHorizontal );
            texture.offset.y = currentRow / this.tilesVertical;
        }
    };
} 
```

您可以使用（例如）初始化材质：

```
var runnerTexture = new THREE.ImageUtils.loadTexture( 'images/run.png' );
// a texture with 10 frames arranged horizontally, display each for 75 millisec
annie = new TextureAnimator( runnerTexture, 10, 1, 10, 75 ); 
var runnerMaterial = new THREE.MeshBasicMaterial( { map: runnerTexture } ); 
```

并在每次渲染之前更新它：

```
var delta = clock.getDelta(); 
annie.update(1000 * delta); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:37:47.857

我通过意识到代码可以通过放置

```
renderer.render(scene, camera); 
```

代码在正确的地方，所以它只**在需要**时才被调用。

# c++-cli - C++/CLI：KeyValuePair<> 键和值不存在

> ID：11284376
> 
> 赞同：0
> 
> 时间：2012-07-01T17:57:23.240
> 
> 标签：c++-cli, managed

我正在使用 C++/CLI 编写我的第一个类库，并且在尝试访问 KeyValuePair 类的 Key 和 Value 属性时遇到错误。

```
KeyValuePair<String^, LONG>^ params = gcnew KeyValuePair<String^, LONG>(readerName, hContext); 
```

当我在其上设置断点并使用 Visual Studio 2010 检查`params`变量中的内容时，它正确显示了两个保存键和值的私有变量，但对于键和值属性，它显示错误，例如“键不存在”。

```
ошибка: "System::Collections::Generic::KeyValuePair<System.String ^,int>(params.Key" не существует 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:19:52.140

LONG 可能不是用作任何泛型类的参数类型的最佳选择。根据您的构建方式，它可能会也可能不会被定义。改用 int 或 long，或者更好的是 Int32 或 Int64。

最新版本的 Visual Studio 不支持 C++/CLI 的 Intellisense 并且经常观察变量根本无法破译，更不用说部分如您所见。

底线：不要指望 IDE/调试器完全适用于 C++/CLI 代码。只需输出到调试流或以其他方式在您自己的代码中测试变量以查看它是否按预期显示/工作。当涉及到托管 C++ 时，不要相信调试器。

# ruby - 如何在Ruby中将块传递给assert_raise？

> ID：11284382
> 
> 赞同：1
> 
> 时间：2012-07-01T17:58:27.380
> 
> 标签：ruby

使用 ruby​​-1.9.3...

我已经阅读了一些关于块和 Procs 主题的规范博客文章，但我不明白为什么这两种情况不同：

```
module TestHelpers
  def bad_arg_helper(&scenario)

    # this works fine, test passes (without the next line)
    assert_raise ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters", { Myclass.myfunc "bad" }

    # even though the exception is correctly raised in myfunc, this assert does not see it and the test fails
    assert_raise ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters", scenario.call
  end
end

class TestClass < Test::Unit::TestCase
  include TestHelpers

  def test_bad_args
    bad_arg_helper { Myclass.myfunc "bad" }
  end
end 
```

如何将块传递给另一个模块中的测试助手？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:17:43.423

请查看代码中的三个变体：

```
require 'test/unit'
class Myclass
  def self.myfunc(par)
    raise ArgumentError unless par.is_a?(Fixnum)
  end
end

module TestHelpers
  def bad_arg_helper(&scenario)

    # this works fine, test passes (without the next line)
    assert_raise( ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters") { Myclass.myfunc "bad" }

    # even though the exception is correctly raised in myfunc, this assert does not see it and the test fails
    assert_raise( ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters", &scenario)
    assert_raise( ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters") { yield }
    assert_raise( ArgumentError, "wrong type of arguments, pass Fixnum or Range parameters") { scenario.call }
  end
end

class TestClass < Test::Unit::TestCase
  include TestHelpers

  def test_bad_args
    bad_arg_helper { Myclass.myfunc "bad" }
  end
end 
```

# couchdb - Couchdb 计数唯一文档字段

> ID：11284383
> 
> 赞同：1
> 
> 时间：2012-07-01T17:58:43.653
> 
> 标签：couchdb

我将访问统计信息存储在 couchdb 文档中，并希望在一段时间内显示唯一 IP 的计数，我的设计文档是：

```
{
"unique": {
   "map": "function(doc){ if (doc.type=='stats'){ emit([doc.date], doc.ip); } }"
} 
```

我使用 startKey 和 endKey 来指示开始和结束日期，但我找不到如何计算唯一 IP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T21:00:09.540

获得唯一值的唯一方法是在键中设置您希望唯一的值，并对结果进行分组。

然后要获得计数，您需要创建一个 reduce 函数（尽管在这种特殊情况下，CouchDB 中已经内置了一个）。

所以你改变你的看法是这样的：

```
{
  "unique": {
    "map": "function(doc){if(doc.type=='stats'){emit([doc.date, doc.ip], 1);}}"
    "reduce": "_sum"
} 
```

（请注意，我使用了您的`doc.date`，它假设这仅具有您查找唯一 IP 计数所需的粒度，并且它将按合理的词汇顺序排序，例如，它的值类似于“2012-07-01 " 而不是像 "7/1/2012" 这样的值)

然后您可以使用以下内容运行此查询：

```
http://your.server/your_db/_design/your_views/_view/unique?startkey=["2012-07"]&endkey=["2012-08"]&group=true 
```

`[]"`（除非您使用浏览器（它为您完成），否则您需要对 s 进行 url 编码）

# php - 无法访问/读取mysql中的索引

> ID：11284386
> 
> 赞同：1
> 
> 时间：2012-07-01T17:58:51.883
> 
> 标签：php, mysql, indexing

所以这是罪魁祸首

```
mysql_query("UPDATE coordrating SET submissions = '2' WHERE rating = 2"); 
```

现在这工作正常，除非我尝试使用索引（这是我的表的索引）值。所以这不起作用：

```
mysql_query("UPDATE coordrating SET index = '2' WHERE rating = 2"); 
```

或者

```
mysql_query("UPDATE coordrating SET submissions = '2' WHERE index = 2"); 
```

这是我的数据库结构的截图

[http://imageshack.us/photo/my-images/694/problemmysql.png/](http://imageshack.us/photo/my-images/694/problemmysql.png/)

我完全感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:01:49.410

这些查询不起作用，因为`index`它是一个[保留字](http://dev.mysql.com/doc/refman/5.6/en/reserved-words.html)。您可以使用反引号引用该名称以告诉 MySQL 它应该被视为名称而不是保留字：

```
mysql_query("UPDATE coordrating SET `index` = '2' WHERE rating = 2");

mysql_query("UPDATE coordrating SET submissions = '2' WHERE `index` = 2"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:00:32.280

试试这个方法：

```
UPDATE `coordrating` SET `index` = '2' WHERE `rating` = 2 
```

反引号用于分隔表或字段名，因为有时表或字段名可以匹配 MySQL 运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T18:20:47.420

您的“索引”列（一种最佳做法是使用**id**作为用作主键的列的名称），如您的屏幕截图中所示，是主键。*Primary key*的一个成本约束是**唯一的**，因此您可能会有 2 行具有“rating = 2”，因此您的查询将由于唯一约束而失败。

另一个最佳实践是避免更改主键值，使用另一列。

# javascript - 使用 AngularJS 制作 gviz 图表

> ID：11284392
> 
> 赞同：0
> 
> 时间：2012-07-01T17:59:13.997
> 
> 标签：javascript, angularjs, google-visualization

我正在尝试从此处的示例[https://google-developers.appspot.com/chart/interactive/docs/quick_start](https://google-developers.appspot.com/chart/interactive/docs/quick_start) in angularjs 制作此 gviz 饼图。

我需要写什么服务？

上面的示例代码使用

1.  用于加载 gviz 库的 google ajax 库
2.  一个 gviz 数据表。
3.  gviz 饼图
4.  `document.getElementById`

似乎我需要为每个服务编写自己的服务，除了 `$document`. 这是真的？这似乎是一大堆样板=/（附带问题，为什么将这些作为服务包装是一件好事？）

有人可以尝试一下 dataTable 服务的外观吗？我真的不确定如何访问`google.visualization.DataTable()`“翻译”这一行。

```
var data = new google.visualization.DataTable(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T04:42:28.700

我必须仔细看看，但我会说你会想要创建一个指令。它看起来像很酷的图表包。如果您想了解在指令中包装组件的一些想法，请查看 github 上的 angularjs wiki 页面（1.0.0 版），然后我参与了一个分支组[angular-ui](http://angular-ui.github.com/) ，它正在包装和创建一些可重用的 angular 组件.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T20:47:46.963

这是一个可以完成这项工作的 plunker，以防万一有人需要这样做。

[http://plunker.no.de/edit/VB4tDV](http://plunker.no.de/edit/VB4tDV)

# node.js - 按日期（年和月）和 slug 查询帖子

> ID：11284394
> 
> 赞同：0
> 
> 时间：2012-07-01T17:59:44.707
> 
> 标签：node.js, mongodb, express

我正在尝试使用 Node.js 和 Express 创建一个博客系统。

每个`article`都有一个 slug，它被保存到数据库中。例如，`hello-world`。目前，我可以仅使用它的 slug 访问一个帖子，例如`/article/hello-world`.

但是，我希望 URL 看起来更像这样：`/article/:year/:month/:slug`. 例如，`/article/2011/07/hello-world`。我该怎么做？我`findOne`目前正在使用 MongoDB 的方法，并且在数据库中我在名为`created_at`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:39:40.407

您可以进行日期范围查询：

```
db. article.findOne({
    created_at: { $gte: ISODate("2012-04-01"), $lte: ISODate("2012-04-30") }, 
    slug: "hello-world"
}) 
```

您的特定客户端语言（在这种情况下为 node.js）我确信提供了更简单的方法来处理日期对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T23:12:29.767

这听起来像是给定带有年、月（作为 int？）和 slug 的 URL，您想查询匹配的第一篇文章。

如果年份是 YY，月份是 MM（1 到 12），则查询将是

```
db.article.findOne({slug: "slug", 
          created_at: {$gte: new Date(YY,MM-1), 
          $lt: new Date(YY, MM) }) 
```

Javascript Date 对象的月份是从零开始的，因此如果您在 1 月获得 01，则需要将 0 传递给 Date 以创建 1 月 1 日。

# sql - 当前会话的 IDENT_CURRENT 等效项

> ID：11284395
> 
> 赞同：1
> 
> 时间：2012-07-01T18:00:03.047
> 
> 标签：sql, sql-server, tsql

对于当前会话，我需要获取特定表中最后插入的行。我不能使用`@@IDENTITY`，`SCOPE_IDENTITY()`因为它们将返回任何表的最后插入的标识。问题`IDENT_CURRENT`在于它将返回特定表的最后插入的记录标识，但对于任何会话。这对我来说是个问题，因为`INSERT`它被多个会话调用，并且我特别需要我的特定会话的最后插入记录的标识。

任何指针如何做到这一点？

附言。该`INSERT`语句不在 SPROC 内，因此 SPROC 解决方案不可行。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T18:48:35.893

我知道这不是您似乎想听到的答案，但答案是使用`SCOPE_IDENTITY()`. *您正在考虑的问题（任何*表格都将在哪里）是我们使用`SCOPE_IDENTITY()`而不是`@@IDENTITY`. 考虑这样一种情况，您有一个带有`IDENTITY`列的表，并且该表上的插入触发器本身插入到带有`IDENTITY`列的表中。

```
CREATE TABLE dbo.Log(LogID INT IDENTITY(100,1), FooID INT);

CREATE TABLE dbo.Foo(FooID INT IDENTITY(1,1), name VARCHAR(32));
GO

CREATE TRIGGER dbo.Foo_Insert
ON dbo.Foo
FOR INSERT
AS
BEGIN
  SET NOCOUNT ON;
  INSERT dbo.Log(FooID) SELECT FooID FROM inserted;
END
GO 
```

现在，您的情况是您需要一种在插入后检索 ID 的可靠方法。`SCOPE_IDENTITY()`给你，因为它仅限于*你的范围*，`@@IDENTITY`而不限于你的范围（这意味着它将抓住最后一次`IDENTITY`发布，这发生在触发器的范围内，而不是你的范围内：

```
INSERT dbo.Foo(name) SELECT 'Bob';

SELECT
  @@IDENTITY,
  SCOPE_IDENTITY(); 
```

结果：

```
----  ----
100   1 
```

请注意，在插入多行的情况下，不应该使用`SCOPE_IDENTITY()`也不`@@IDENTITY`应该使用。这样做的方法是使用该`OUTPUT`子句。首先让我们放下触发器：

```
DROP TRIGGER dbo.Foo_Insert; 
```

现在让我们测试一个多行插入：

```
 INSERT dbo.Foo(name) 
    OUTPUT inserted.FooID, inserted.name
    SELECT 'Frank' UNION ALL SELECT 'Jim'; 
```

结果：

```
FooID  name
-----  -----
2      Frank
3      Jim 
```

如果您有条件插入，则没有区别。保留我们拥有的表格，让我们尝试此代码两次：

```
DECLARE @table SYSNAME;
SET @table = N'Log';

IF @table = N'Log'
BEGIN
    INSERT dbo.Log(FooID) SELECT 10;
END

IF @table = N'Foo'
BEGIN
    INSERT dbo.Foo(name) SELECT 'Tom';
END

SELECT SCOPE_IDENTITY(); 
```

结果：

```
----
101 
```

让我们再试一次`N'Foo'`：

```
DECLARE @table SYSNAME;
SET @table = N'Foo';

IF @table = N'Log'
BEGIN
INSERT dbo.Log(FooID) SELECT 10;
END

IF @table = N'Foo'
BEGIN
    INSERT dbo.Foo(name) SELECT 'Tom';
END

SELECT SCOPE_IDENTITY(); 
```

结果：

```
----
4 
```

如果它比这更复杂（例如，您可以插入多个表），您可以执行以下操作：

```
IF <some conditional>
BEGIN
    INSERT dbo.sometable ...
    SET @somevar = SCOPE_IDENTITY();
END
IF <some other conditional>
BEGIN
    INSERT dbo.some_other_table ...
    SET @some_other_var = SCOPE_IDENTITY();
END 
```

我不知道你为什么认为这行不通，我也不知道我为什么要花这么多时间来说服你它行得通。同样，如果您展示了一个不起作用的示例（或者您认为可能会干扰的“任何表格”），我们可能会发表评论。就目前而言，听起来您的意见`SCOPE_IDENTITY()`是基于您听说过的事情`@@IDENTITY`。这些假设很容易证明或反驳自己。

顺便说一句，`IDENT_CURRENT`在这次谈话中甚至不应该被提及。用于并发活动根本不安全，就我而言，您应该假装您从未听说过它。您还应该考虑相同的`@@IDENTITY`- 我想不出它的有效用途，除非您真的想从触发器外部捕获触发器`IDENTITY`内部生成的内容。

# c++ - c ++：在构造函数中定义类的问题

> ID：11284397
> 
> 赞同：0
> 
> 时间：2012-07-01T18:00:25.977
> 
> 标签：c++, constructor

在对象的构造函数中，我有以下代码：

```
ConfigReader::ConfigReader(){
    TiXmlDocument doc(CONFIGURATION_FILE_LOCATION);
    configDoc = TiXmlHandle(&doc);
} 
```

当我尝试编译时，我收到以下警告：

```
no matching funciton for call to 'TiXmlHandle::TiXmlHandle(); 
```

`configDoc`在我的 h 文件中`TiXmlHandle`定义为类的私有变量。这两个类都来自 TinyXML C++ 项目，但这几乎不相关。编译器没有默认构造函数是正确的`TiXmlHandle`。但是，由于我正在使用有效的构造函数构造 TiXmlHandle，因此理论上这无关紧要。

那么，如果有的话，告诉 C++ 不要费心尝试`TiXmlHandle`使用默认构造函数创建 的语法是什么，因为我只是要覆盖它？

我为这个简单的问题道歉，我知道这是我应该能够查找的东西，但我已经尝试过并且无法偶然发现答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:03:53.057

`configDoc`正在默认构造，然后，稍后，您尝试将其复制分配给`TiXmlHandle(&doc)`. A`TiXmlHandle`显然不能默认构造，所以这不起作用。默认构造是隐式发生的，因为您没有使用成员初始化列表覆盖它。

您可以像这样使用成员初始化列表：

```
ConfigReader::ConfigReader()
    : configDoc(/*args*/)
{
    // ...
} 
```

显然，要将正确的参数传递到`configDoc`该位置，您必须稍微重构代码。也许您`TiXmlDocument`也应该成为会员。有很多重构选项；你可以自己弄清楚那部分。

# django - Pagedown 使用 Django 转义代码段中的特殊字符

> ID：11284401
> 
> 赞同：1
> 
> 时间：2012-07-01T18:01:08.363
> 
> 标签：django, escaping, markdown, html-entities, pagedown

我正在使用 Stack Overflow 上使用的 Markdown 编辑器的 Pagedown 实现，而我的项目正在使用 Django。我遇到的问题是，像`<`Markdown 代码部分中的特殊字符被 Django 转义，但随后被 Pagedown 视为代码并显示为`&lt;`.

当我键入如下代码片段时：

```
 for(var i = 0; i < 10; i++) 
```

我在下面得到了正确的预览。`<`也正确保存在数据库中，而不是 HTML 实体中`&lt;`。

但是，当我在新页面上输出这条评论时，Django 会自动转义这些特殊字符。

```
 for(var i = 0; i &lt; 10; i++) 
```

我试过关闭自动转义，但这似乎是正确的行为，因为如果用户写

```
 <script>alert('hi');</script> 
```

作为代码注释，Django 并没有对此进行转义，它会执行这段 JavaScript 代码。但是，当 Pagedown 将其转换为代码标记时，它会`<pre>`在此部分周围添加标记，以便代码显示为

```
 for(var i = 0; i &lt; 10; i++) 
```

我怎样才能让代码部分显示正确的未转义字符，但还要安全地编写它，这样它就不会执行任意 JavaScript 代码？似乎我可以让 Django 输出保存的注释（转义），然后转义所有内容，然后重新转义所有非代码部分。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T22:08:05.173

该修复似乎将所有内容都`&amp;`变成了 simple `&`，因此 HTML 实体确实在代码部分中正确呈现。然而，在它看起来像`&amp;lt;`which 会呈现 as`&lt`而不是`&lt;`变成`<`.

使用了这个方法：

```
unhtmlEntityCode: function(code){
    code = code.replace(/&amp;/g, '&');
    return code;
}, 
```

# .net - .NET 库中是否有稀疏数组实现？

> ID：11284403
> 
> 赞同：8
> 
> 时间：2012-07-01T18:01:17.483
> 
> 标签：.net, data-structures

.NET 库中是否已经实现了数据结构，其行为类似于稀疏数组（其中大多数索引为空），通过索引进行 O(1) 访问，对下一个（和上一个）元素进行 O(1) 访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:05:42.783

我不知道您想要的任何内置容器，但作为一种解决方法，您可以使用`Dictionary`以下项目之一：

```
class Entry<T>
{
    int previdx, nextidx;
    T data;
} 
```

（.NET 中的字典具有 O(1) 查找，因为它是基于哈希表的）。对于 O(log n) 的插入，我们需要保留一个已存在索引的排序列表（这不存在开箱即用，但[可以很容易地模拟](https://stackoverflow.com/a/450856/276994)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-26T06:35:50.227

几年前，我基于我的[“AList”概念](http://core.loyc.net/collections/alists-part1.html)实现了一个稀疏集合。它被称为[SparseAList](http://core.loyc.net/collections/alists-part3.html)，它可能比您自己推出的任何“简单”解决方案都要好。例如，@NathanPhilips 的解决方案`Insert`具有`RemoveAt`调用`ToDictionary`. [`Enumerable.ToDictionary`](https://msdn.microsoft.com/en-us/library/system.linq.enumerable.todictionary%28v=vs.100%29.aspx?f=255&MSPPError=-2147217396)是一种 O(N) 方法-它“从头开始”重新生成整个字典-因此效率不高。

[相比之下， SparseAList](http://ecsharp.net/doc/code/classLoyc_1_1Collections_1_1SparseAList.html)基于[B+ 树](https://en.wikipedia.org/wiki/B%2B_tree)，因此它具有高效的 O(log N) 插入、查找和删除，并且还可以有效地使用内存。它包含在 LoycCore 的[Loyc.Collections.dll](http://loyc.net/doc/code/classLoyc_1_1Collections_1_1SparseAList_3_01T_01_4.html)中，可在 NuGet 上找到（搜索 Loyc.Collections）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T19:16:45.733

不久前，我在 dotnet 中整理了一个[列表。](http://www.selfelected.com/list-of-list-and-collection-classes-in-dotnet-11-45/)那里没有稀疏列表。
无论如何我都会提到它，因为如果您决定自己开发一个，它可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-28T22:50:13.227

这是一个基于 Dictionary 的稀疏数组（大部分未经测试，我只是在阅读此问题后将其放在一起）：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;

namespace NobleTech.Products.Library.Linq
{
    public class SparseList<T> : IList<T>
    {
        private T defaultValue;
        private Dictionary<int, T> dict;
        private IEqualityComparer<T> comparer;

        public SparseList(T DefaultValue = default(T))
            : this(DefaultValue, EqualityComparer<T>.Default)
        {
        }

        public SparseList(IEqualityComparer<T> Comparer)
            : this(default(T), Comparer)
        {
        }

        public SparseList(T DefaultValue, IEqualityComparer<T> Comparer)
        {
            defaultValue = DefaultValue;
            dict = new Dictionary<int, T>();
            comparer = Comparer;
        }

        public int IndexOf(T item)
        {
            if (comparer.Equals(item, defaultValue))
                return LinqUtils.Generate().First(i => !dict.ContainsKey(i));
            return dict.Where(kvp => comparer.Equals(item, kvp.Value))
                .Select(kvp => (int?)kvp.Key).FirstOrDefault() ?? -1;
        }

        public void Insert(int index, T item)
        {
            if (index < 0)
                throw new ArgumentOutOfRangeException("index", index, "index must be non-negative");
            if (index < Count)
                dict = dict.ToDictionary(kvp => kvp.Key < index ? kvp.Key : kvp.Key + 1, kvp => kvp.Value);
            this[index] = item;
        }

        public void RemoveAt(int index)
        {
            if (index < 0)
                throw new ArgumentOutOfRangeException("index", index, "index must be non-negative");
            dict.Remove(index);
            if (index < Count)
                dict = dict.ToDictionary(kvp => kvp.Key < index ? kvp.Key : kvp.Key - 1, kvp => kvp.Value);
        }

        public T this[int index]
        {
            get
            {
                if (index < 0)
                    throw new ArgumentOutOfRangeException("index", index, "index must be non-negative");
                if (dict.ContainsKey(index))
                    return dict[index];
                return defaultValue;
            }
            set
            {
                if (index < 0)
                    throw new ArgumentOutOfRangeException("index", index, "index must be non-negative");
                dict[index] = value;
            }
        }

        public void Add(T item) { this[Count] = item; }

        public void Clear() { dict.Clear(); }

        public bool Contains(T item)
        {
            return comparer.Equals(item, defaultValue) || dict.Values.Contains(item, comparer);
        }

        public void CopyTo(T[] array, int arrayIndex)
        {
            if (array == null)
                throw new ArgumentNullException("array");
            if (arrayIndex < 0)
                throw new ArgumentOutOfRangeException("arrayIndex", arrayIndex, "arrayIndex must be non-negative");
            for (int i = 0; i < array.Length - arrayIndex; ++i)
                array[arrayIndex + i] = this[i];
        }

        public int Count { get { return (dict.Keys.Max(i => (int?)i) ?? -1) + 1; } }

        public bool IsReadOnly { get { return false; } }

        public bool Remove(T item)
        {
            int index = IndexOf(item);
            if (index < 0)
                return false;
            RemoveAt(index);
            return true;
        }

        public IEnumerator<T> GetEnumerator()
        {
            return LinqUtils.Generate(i => this[i]).GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator() { return GetEnumerator(); }
    }
} 
```

的实现`LinqUtils.Generate`留给读者作为练习:-)

# php - 坚持使用肥皂和 PHP

> ID：11284418
> 
> 赞同：1
> 
> 时间：2012-07-01T18:03:22.890
> 
> 标签：php, soap

所以我试图通过php使用wsdl和soap访问一个简单的java方法。但是当我尝试运行 php 文件时，它会显示以下错误：

> 致命错误：未捕获的 SoapFault 异常：[WSDL] SOAP-ERROR：解析 WSDL：无法从“http://localhost:8080/WEB/services/SampleClass”加载：C:\ 中文档末尾的额外内容xampp\htdocs\abc.php:2 堆栈跟踪：#0 C:\xampp\htdocs\abc.php(2): SoapClient->SoapClient('http://localhos...') #1 {main} 抛出在第 2 行的 C:\xampp\htdocs\abc.php

这是我的代码：

```
<?php  
  $client = new SoapClient("http://localhost:8080/WEB/services/SampleClass");
 $name=15;
 $c=20;
  $response = $client->demo($name, $c);
  echo $response;
?> 
```

我无法弄清楚问题所在。`SoapClient`它是构造函数的参数吗？是否必须按照其他语法给出？

而且我是 Soap 和 WSDL 的新手，因此我们将不胜感激分步解决方案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:11:57.207

您必须将服务的 WSDL 传递给 SOAP 构造函数，也可以是 localhost 上的文件。通常简单地将 ?wsdl 添加到 che 服务 url。

```
<?php  
  $client = new SoapClient("http://localhost:8080/WEB/services/SampleClass?wsdl");
 $name=15;
 $c=20;
  $response = $client->demo($name, $c);
  echo $response;
?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-01T18:14:31.277

您的问题是您没有声明 wsdl 的文件扩展名，

改变这个，

```
$client = new SoapClient("http://localhost:8080/WEB/services/SampleClass"); 
```

对此，

```
$client = new SoapClient("http://localhost:8080/WEB/services/SampleClass.wsdl"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-06-02T13:38:35.013

我曾经也遇到过这个问题。来源是缺少的报价。

xmlns:myorder="应用/订单/

# c# - msmq over cluster，如何知道服务是否在集群下？

> ID：11284419
> 
> 赞同：1
> 
> 时间：2012-07-01T18:03:30.790
> 
> 标签：c#, windows-services, msmq, cluster-computing

我们开发了具有扩展和故障转移能力的产品。
为了持久性，服务器相互通信，我们`wcf`在`msmq`配置集群下使用窗口服务以使用集群 msmq 时遇到了麻烦。
答案是`Environment.SetEnvironmentVariable`在服务启动中配置如下`Environment.SetEnvironmentVariable(_CLUSTER_NETWORK_NAME_,"Cluster");`，然后集群 msmq 上的 wcf 正在工作，但问题是要知道服务何时在集群下，何时不在。
有什么办法知道吗？

**更新**

与微软协商后，我们得出的结论是，使用 MSMQ 的集群架构是错误的，MSMQ 是服务而不是服务器，因此作为队列主服务器的每个服务器都需要配置 msmq 作为自己的依赖项团体。msmq 将处理节点和服务器客户端之间的消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T11:55:15.533

我们将 WCF (netMsmqBinding) 与集群 MSMQ 结合使用。在故障转移群集管理器 (2008) 或群集管理员 (2003) 中添加 MSMQ 服务时

你有一个网络名称，比如说“MyNetworkName”，它有一个 IP。MSMQ 可在该网络名称上访问 - 因此您的配置中的队列定义应以 MyNetworkName\private... 开头，或者如果您的 WCF 服务也在集群中作为 Windows 服务运行，您可以选择资源选项“使用网络名称for comutername”，您可以在配置中使用“.\private....” - “备注：Windows 服务应该与 MSMQ 在同一资源组中运行”。

**编辑：所以如果我很好地理解了您的问题，当您在集群服务上选中“使用网络名称 ....”复选框时，相同的代码将使用集群 msmsq，但如果您没有在集群上运行或不在资源中运行组它将使用本地 msmq**

确保您的 MSMQ 以目录服务集成模式安装。

要组织群集 MSMQ，您可以使用 microsoft 的 mmcv.exe 工具（常规 mmc.exe 工具不够用）。

您可以在此处阅读有关 mmcv.exe 的信息：http: [//support.microsoft.com/kb/898701](http://support.microsoft.com/kb/898701)

# javascript - 如何在一个 javascript 切换中包含多个 div？

> ID：11284421
> 
> 赞同：0
> 
> 时间：2012-07-01T17:22:26.263
> 
> 标签：javascript

我正在尝试为响应式站点的“小型”或移动大小版本实现 javascript 切换效果。我正在使用我自己的自定义 WordPress 主题。

我正在尝试使用本文中的脚本：[http ://webdesignerwall.com/tutorials/mobile-navigation-design-tutorial/comment-page-1](http://webdesignerwall.com/tutorials/mobile-navigation-design-tutorial/comment-page-1)

棘手的部分是我试图包含几个 div，而不仅仅是一个导航。如果您现在查看该站点（仍在建设中），请访问：

```
http://66.147.244.81/~assureva/ 
```

并将您的浏览器窗口缩小到小于 540 像素，您会看到我已经设法让我的顶部导航栏 (smallnav)、2 个“登录”链接以及 facebook 和 LinkedIn 图标全部消失，并在按下时重新出现现在出现在顶部，徽标右侧的“主菜单”按钮。但我似乎无法在最后一部分添加，即构成主要“导航”的 4 个链接。我已经将整个区域包裹在一个 div (mobimenubg) 中，但是主导航栏的行为就像它不在那个 div 中一样，但是“smallnav”、“logins”和“socialcons”div 都根据需要在“mobimenubg”中组合“分区。

如果我继续将“导航栏”div 设置为“display:none”，它将消失，但当我单击“主菜单”按钮时它不会重新出现。

所以我*认为*要求javascript包含“mobimenubg”div和“navbar”div的答案（“navbar div是一个包含实际“nav”的容器）但我不知道如何正确编写它。

这是javascript：

```
<script type="text/javascript">
jQuery(document).ready(function($)
{/* prepend menu icon */
$('#mobimenuwrap').prepend('<div id="menu-icon">Main Menu</div>');
/* toggle nav */
$("#menu-icon").on("click", function(){
    $("#mobimenubg").slideToggle();
    $(this).toggleClass("active");
}); 
    }); 
   </script> 
```

有人可以告诉我如何添加导航栏 div 吗？我是否在之后添加另一行：

```
$("#mobimenubg").slideToggle(); 
```

或者我可以将它包含在括号中：

```
$("#mobimenubg" IN HERE?).slideToggle(); 
```

我不知道惯例-

帮助非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:17:28.240

> 我已经将整个区域包裹在一个 div (mobimenubg) 中，但是主导航栏的行为就像它不在那个 div 中一样，

您实际上拥有正确的代码，但您的 HTML 结构已关闭。导航栏 div 不包含在 mobimenubg div 中，这就是问题所在。只需确保将导航栏嵌套在那里，否则我认为您也可以在导航栏上调用该函数，例如：

```
$("#navbar").slideToggle(); 
```

![检查员截图](../Images/881d203acc50db45b98cd283caf6bb32.png)

# ssh - 使用 pythons pickle 通过 ssh 传输数据

> ID：11284424
> 
> 赞同：1
> 
> 时间：2012-07-01T18:04:10.813
> 
> 标签：ssh, python-3.x, pipe, pickle

我想使用 pythons pickle 和管道通过 ssh 中的管道发送一个 unicode 字符串：

```
import subprocess
import pickle

cmd=['ssh', 'user@host', '/usr/bin/env', 'python3', '-c', \
  '"import sys;import pickle;import os;os.mkdir(pickle.Unpickler(sys.stdin).load())"']

p = subprocess.Popen(cmd, stdout=subprocess.PIPE, stdin=subprocess.PIPE)

pickler = pickle.Pickler(p.stdin)

pickler.dump('äöü') 
```

这会产生以下错误：

```
>>> Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/usr/lib/python3.2/encodings/ascii.py", line 26, in decode
    return codecs.ascii_decode(input, self.errors)[0]
UnicodeDecodeError: 'ascii' codec can't decode byte 0x80 in position 0: ordinal not in range(128) 
```

我还注意到发送到子进程的 unicode 字符没有正确显示，相反我只看到它们的十六进制表示。有谁知道问题是什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T16:44:09.083

Pickle 需要二进制文件，并读取和写入字节数据，而为您的进程创建的 stdin/stdout`subprocess`处于二进制模式，而 sys.stdin 处于文本模式。

通过更改目标代码以使用`sys.stdin.buffer`上述代码可以正常工作。

# java - 我如何知道一个 tcp 连接是否在 java 中完成？

> ID：11284425
> 
> 赞同：2
> 
> 时间：2012-07-01T18:04:20.547
> 
> 标签：java, tcp

如何知道 TCP 连接是否终止？我有一个`AsynchronousSocketChannel`并且打开它后，每次我打电话`isOpen()`后结果都是`true`。

我正在接受来自网络浏览器的 TCP 连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T22:36:35.180

一个 TCP 连接会一直建立，直到您收到一个 IOException 写入它或一个 EOS 读取它。像 isOpen() 这样的 API 不会告诉您连接状态，它们会告诉您 Socket 或 Channel 状态，即您自己对它做了什么。

# asp.net - 两个外键引用同一个主键

> ID：11284428
> 
> 赞同：37
> 
> 时间：2012-07-01T18:04:41.860
> 
> 标签：asp.net, sql, vb.net, normalization, rdbms

一个表中有两个外键引用另一个表的一个主键可以吗？

EmployeeID 是员工表中的主键，在时间表表中作为外键出现两次。

很少有管理员用户代表其他员工填写时间表。

在 timsheet 表字段中，'TimsheetFor' 将具有从事项目工作的人员的员工 ID，而字段 'EnteredBy' 或 'FilledBy' 将具有已填写此时间表的人员的员工 ID。

以下哪个选项是正确的？

***注意：表格仅显示与此问题相关的字段。***

![在此处输入图像描述](../Images/548cdde47dd15b122e10bb0d9993f953.png)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-01T18:08:54.897

我会**选择选项 1**。让两个外键列引用不同表中的相同主键列是完全可以的，因为每个外键值将引用相关表中的不同记录。

我确信**选项 2**`TIMESHEET_TABLE`会起作用，但是您基本上会在and之间建立一对一的关系`TIMESHEET_FILLED_BY`，从而使两个表变得不必要且更难维护。

事实上，如果需要`ENTERED_BY`和`TIMESHEET_FOR`成对使用，则使用**选项 1**更有意义，因为这是由数据库和外键自动强制执行的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-12T08:57:49.840

选项 1 是一个完美的解决方案。您可以定义外键约束如下

Timesheet_For 列的第一个外键约束

```
ALTER TABLE TIMESHEETTABLE 
ADD CONSTRAINT fk_TimesheetTable_EmployeeTable
FOREIGN KEY (TIMESHEET_FOR)
REFERENCES EMPLOYEETABLE(EMPLOYEE_ID) 
```

Entered_By 列的第二个外键约束

```
ALTER TABLE TIMESHEETTABLE 
ADD CONSTRAINT fk_TimesheetTable_EmployeeTable_1
FOREIGN KEY (ENTERED_BY)
REFERENCES EMPLOYEETABLE(EMPLOYEE_ID) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T18:08:22.010

是的，这没有问题...您可以将另一个表中一个表的主键用作外键两次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-23T12:51:27.917

您的查询如下：

```
SELECT t.EMPLOYEE_ID, a.NAME as TimeSheetFor, b.NAME as EnteredBy 
FROM timesheet t
JOIN employee a ON t.timesheet_for =a.employee_id
JOIN employee b ON t.entered_by = b.employee_id 
```

使用此查询，您将获得所需的结果。

# iphone - 如何在 Windows AMD 上开发 iPhone 应用程序

> ID：11284432
> 
> 赞同：0
> 
> 时间：2012-07-01T18:05:34.337
> 
> 标签：iphone, windows, macos

我用谷歌搜索并打电话给 15 家计算机服务商店，但没有找到帮助。我需要开发一个 iPhone 应用程序，但我没有 Mac。我了解到，在 Windows 上安装虚拟 Mac 的唯一方法是您需要英特尔，而不是像我这样的 AMD。也许有人遇到了这个问题并且可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:09:32.400

这是一篇关于如何安装雪豹的帖子[http://www.sysprobs.com/mac-snow-leopard-amd-pc-vmware-image](http://www.sysprobs.com/mac-snow-leopard-amd-pc-vmware-image)你也可以查看这个[http://asendure.wordpress.com/2006/ 10/01/osx86-如何安装-mac-os-x-on-vmware-server-amd-64/](http://asendure.wordpress.com/2006/10/01/osx86-how-to-install-mac-os-x-on-vmware-server-amd-64/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T20:13:31.483

哇，这是自找麻烦。苹果在这方面并没有那么大，你将一路逆流而上。

我会在这里冒昧地说，如果你真的需要开发一个 iPhone 应用程序，那么如果你只需要一个 mac mini，你的头痛就会少得多。他们不花那么多钱。

让 OSX 在 OSX 以外的其他东西上的 VM 中运行并不容易。唯一合法的事情是您可以在 OSX 上的 VM 中运行其他版本的 OSX（使用 Fusion）。您应该关注该评论的所有主题到您的原始帖子..可能是重复的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T00:59:59.150

如果你只是想开发或学习iOS，你可以使用VMWare，但如果你想在App Store中提交你的应用程序，我不知道是否可以。也许您真的需要购买一台二手 Mac Mini。但是在我的笔记本电脑中，我使用 VMWare 只是为了尝试它，但我从未尝试过在其中开发我的应用程序。因为它有点慢，我认为你需要大量的 Ram 才能在 VMWare 中完美地运行它。或者尝试像 Hackintosh 这样的双启动，但不建议这样做。我不知道，这是你的电话，但如果你想在上面追求你的事业，我建议你买一台第二手 Mac Mini。:)

# java - 使用 gwt 更改 java 文件

> ID：11284435
> 
> 赞同：0
> 
> 时间：2012-07-01T18:05:46.357
> 
> 标签：java, gwt

我对 gwt 真的很陌生，但我已经发布了一个问题，但我不太明白。

我正在从事一个已经开发的项目。这个项目使用get，javascript来自java文件。我想对这些 java 文件之一进行一些更改。所以我被告知我需要下载get。这就是我所做的。

但是我的 php 和 html 文件是用 MAMP 处理的。

那么现在，如何更改 java 文件？我在哪里放置我的 php 和 html 文件以在我的本地服务器 MAMP 上运行它？我是否应该获取唯一的 java 文件，打开一个“WebApp”（如 get doc 中所示），运行它（使用 ant build 命令？），检索一些文件并将它们放在我的 MAMP 工作区中？

（我已经阅读了 gwt，但我并没有真正理解它。如果我的问题看起来太简单，我提前道歉）

谢谢， 迈赫迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:42:13.650

你描述的过程基本正确。您应该有一个包含 GWT 项目的目录。听起来您正在`git`用作版本控制系统，但如果您已经签出项目，请不要担心。现在，使用 Eclipse 打开您的项目（您应该首先在 Eclipse 中安装 GWT 插件，以便它为您设置所有依赖项）。完成更改后，您可以使用 Eclipse 或您提到的 ant 构建您的 GWT 项目。编译后的文件通常会放在一个 war 文件夹中（连同 index.html 或您正在使用的任何入口点 html 文件）。将这些编译后的文件复制到您的 PHP 项目并进行部署。

# c++ - 使用 MPI 和 C++ 从不同节点收集数据

> ID：11284441
> 
> 赞同：2
> 
> 时间：2012-07-01T18:06:44.693
> 
> 标签：c++, mpi

我正在开发一个包含多个从节点和一个主节点的项目。在某些时候，我需要从不同的从节点（主节点也可以被视为从节点）收集数据到主节点。数据可以是任何类型，但我们假设它是无符号整数。这就是数据在从节点上的样子：

节点0：|chunk01|chunk02|chunk03|chunk04|....

节点1：|chunk11|chunk12|chunk13|chunk14|....

...

节点：|chunkn1|chunkn2|chunkn3|chunkn4|....

数据应全部收集到 node0，如下所示：

节点0：|chunk01|chunk11|chunk21|....|chunkn1|chunk02|chunk12|...|chunkn2|...|chunknm|

这意味着我们将每个节点的第一个块连接在一起，然后将每个节点的第二个块连接在一起......

我不知道如何使用 MPI_Gatherv 来实现这一点，因为每个 chunkij 都有不同的大小，而且每个节点只知道自己的块大小和起始索引，而不知道其他节点的信息。

我对 MPI 不太熟悉，所以我想知道是否有任何 API 可以将不同大小的数据从各个节点收集到一个节点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:44:24.323

这是一个您可以编辑的示例，它应该可以工作。这几乎肯定不是解决问题的最佳方法 - 我需要您的代码的更多详细信息才能对此发表评论。我还没有检查它是否可以编译，但是如果你修正了任何错别字，我很乐意尝试修正任何未解决的错误。

我也不知道效率对你有多重要——这个操作是每秒完成数百次还是每天一次？如果是后者，那么这段代码可能没问题。我还假设 C/C++。

```
// Populate this on each node from MPI_Comm_rank.
int myRank; 
// Populate this on each node from MPI_Comm_size.
int P; 
// Num chunks per core.
const int M = 4;  

// I'm assuming 0 is the master.
int masterNodeRank = 0; 

// Populate this. 
// It only needs to have meaningful data on the master node. 
//If master node doesn't have the data, fill with MPI_GATHER.
int* sizeOfEachChunkOnEachRank[M]; 
// Populate this. 
//It needs to exist on every 'slave' node.
int sizeOfMyChunks[M]; 

// Assuming you already have this array
// it should be the contiguous store of each core's data.
unsigned* myData; 
// This is what we'll gather all the data into on master node only.
unsigned* gatheredData = new unsigned[totalDataSize];
// This array will keep all of the displacements from each sending node.
int* displacements = new int[P];

// This keeps track of how many unsigneds we've received so far.
int totalCountSoFar = 0;

// We'll work through all the first chunks on each node at once, then all
// the second chunks, etc.
for(int localChunkNum = 0; localChunkNum < M; ++localChunkNum)
{
  // On the receiving node we need to calculate all the displacements
  // for the received data to go into the array
  if (myRank == masterNodeRank)
  {
    displacements[0] = 0;

    for(int otherCore = 1; otherCore < P; ++otherCore)
    {
      displacements[otherCore] = displacements[otherCore-1] + sizeOfEachChunkOnEachRank[localChunkNum][otherCore-1];
    }
  }

  // On all cores, we'll need to calculate how far into our local array
  // to start the sending from.      
  int myFirstIndex = 0;

  for(int previousChunk=0; previousChunk < localChunkNum; previousChunk++)
  {
    myFirstIndex += sizeOfMyChunks[previousChunk];
  }

  // Do the variable gather
  MPI_Gatherv(&myData[myFirstIndex], // Start address to send from
              sizeOfMyChunks[localChunkNum], // Number to send
              MPI_UNSIGNED, // Type to send
              &gatheredData[totalCountSoFar], // Start address to receive into
              sizeOfEachChunkOnEachRank[localChunkNum], // Number expected from each core
              displacements, // Displacements to receive into from each core
              MPI_UNSIGNED, // Type to receive
              masterNodeRank, // Receiving core rank
              MPI_COMM_WORLD); // MPI communicator.

  // If this is the receiving rank, update the count we've received so far
  // so that we don't overwrite data the next time we do the gather.
  // Note that the total received is the displacement to the receive from the
  // last core + the total received from that core.
  if(myRank == masterNodeRank)
  {
    totalCountSoFar += displacements[P-1] + sizeOfEachChunkOnEachRank[localChunkNum][P-1];
  }
}

delete[] displacements;
delete[] gatheredData; 
```

# c# - 错误的 NewItemPlaceholder 行为

> ID：11284442
> 
> 赞同：1
> 
> 时间：2012-07-01T18:06:44.807
> 
> 标签：c#, wpf

我有一些问题`DataGrid`。当`DataGrid`设置为`CanUserAddRows`新的黑色行时，`DataGrid`这些行会出现意外行为，因为如果我只是单击新行并将焦点传递给另一个单元格，即使该行为空，也会创建该行。如果该行为空，我想通过改变行为来避免创建新项目，但如果在`RowEditEnding`我设置的情况下`e.Cancel=true`，那么`NewItemPlaceHolder`从那时起我将无法添加任何行。有没有人找到这些问题的答案？

```
protected override void OnRowEditEnding(DataGridRowEditEndingEventArgs e)
{
    if ((e.Row.Item as DataRowView).Row.ItemArray[0] == null || (e.Row.Item as DataRowView).Row.ItemArray[0].ToString() == String.Empty)
    {
        e.Cancel = true;

        IEditableCollectionView collection = Items as IEditableCollectionView;

        if (collection.IsAddingNew)
        {
            collection.CancelNew();
        }
    }            
    base.OnRowEditEnding(e);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T19:52:40.127

我刚刚通过刷新 CanUserAddRows 属性找到了一种方法

```
bool canUserAddRows = Datagrid.CanUserAddRows;

                //Makes the refresh for CanUserAddRows because when cancel the new adding then collapse the NewPlaceHolder item
                Datagrid.CanUserAddRows = !canUserAddRows;
                Datagrid.CanUserAddRows = canUserAddRows; 
```

# python - 我应该将客户端 IP 信息保存在数据库或缓存中还是其他任何替代方案中？

> ID：11284447
> 
> 赞同：1
> 
> 时间：2012-07-01T18:07:39.263
> 
> 标签：python, database, networking, ip

我正在用 python 编写一个 IM 服务器。为了能够将消息路由到客户端，我需要`client IP`并且`Id`我知道我将消息发送给谁。

我应该将它们保存到 SQL 数据库中还是访问速度太慢？有没有更好的方法来处理 IM 服务器中的 IP 地址？

# android - 在 textView 上更新 CPU 频率（如何？）

> ID：11284448
> 
> 赞同：2
> 
> 时间：2012-07-01T18:07:43.837
> 
> 标签：android, cpu, cpu-speed

```
private String ReadCPUMhz()
    {
     ProcessBuilder cmd;
     String result="";
     int resultshow = 0;

     try{
      String[] args = {"/system/bin/cat", "/sys/devices/system/cpu/cpu0/cpufreq/scaling_cur_freq"};
      cmd = new ProcessBuilder(args);

      Process process = cmd.start();
      InputStream in = process.getInputStream();
      byte[] re = new byte[1024];
      while(in.read(re) != -1)
       {
         result = result + new String(re);
       }

      in.close();
     } catch(IOException ex){
      ex.printStackTrace();
     }
     return result;
    } 
```

我使用 setText 将结果中的值写入 textView。所以它在应用程序启动时读出了当前的 cpu 频率并将其写入这个 textView。该应用程序在整个打开应用程序时显示 fe 1200Mhz。它没有更新值。

如何使用 Timer 或其他方法在 1s 或 250ms 后更新当前值并将其写入 textView？它应该显示当前的 CPU 频率。Fe: 300Mhz - 1200Mhz.. 1s 或 250ms 后更新..

请帮我 ：-）

此致

马库斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:12:57.170

尝试使用[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html)从 Thread 更新 Textview 为：

```
public void myThread(){
        Thread th=new Thread(){

         @Override
         public void run(){
          try
          {

           while(true)
           {

           Thread.sleep(100L); //SET INTERVAL TO UPDATE TEXTVIEW TEXT
           Activity.this.runOnUiThread(new Runnable() {

            @Override
            public void run() {

       String str=ReadCPUMhz();  //CALL YOUR METHOD HERE
            tvnn.setText(str);  SET TEXT HERE
           });
           }
          }catch (InterruptedException e) {
        // TODO: handle exception
       }
         }
        };
        th.start();
       }
//....YOUR CODE
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
myThread();
//YOUR CODE.. 
```

# java - 如何管理大型 JSF 应用程序中的许多导航规则？

> ID：11284453
> 
> 赞同：1
> 
> 时间：2012-07-01T18:08:43.273
> 
> 标签：java, jsf-2, navigation

我在以前的应用程序中使用了带有 JSP/JSTL 的 spring MVC。我正在为我的下一个项目使用 JSF。但现在我想知道如何使用许多导航规则来管理这一切。应用程序不会变得紧密耦合吗？我如何将它用于大型项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:12:55.600

只需使用隐式导航。如果您使您的导航案例`outcome`与 相同`to-view-id`，那么您根本不需要定义 a `<navigation-case>`。

对于简单的页面到页面导航，请使用[`<h:link>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/link.html)或[`<h:button>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/button.html)。

```
<h:link value="Go to page2" outcome="page2" /> 
```

链接的 URL 将隐式解析为`page2.xhtml`.

[`<h:commandLink>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/commandLink.html)对于由and执行的表单提交导航，[`<h:commandButton>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/h/commandButton.html)在 action 方法中返回正确的结果。

```
public String submit() {
     // ...

     return "page2";
} 
```

请注意，使用 POST 进行简单的页面到页面导航是不好的设计，因为这对用户和 SEO 不友好。

### 也可以看看：

*   [JSF 2.0 中的通信 - 隐式导航](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ImplicitNavigation)
*   [什么时候应该使用 h:outputLink 而不是 h:commandLink？](https://stackoverflow.com/questions/4317684/when-should-i-use-houtputlink-instead-of-hcommandlink)

# javascript - 如何将日期选择器添加到网站？

> ID：11284454
> 
> 赞同：0
> 
> 时间：2012-07-01T18:08:53.913
> 
> 标签：javascript, html, css, datepicker, rally

我正在使用拉力赛开发人员 (www.rallydev.com)，并希望使用日期选择器来插入日期和时间。但是，我无法将任何 zip 或图像文件上传到网站。我只能使用一个带有 css 和 javascript 的 html 页面。换句话说，我想找到一种方法来使用日期选择器，而不需要我正在开发的所有代码。

编辑：有人问日期选择器将用于什么。显然，答案是获取日期和时间。我想使用日期和时间作为输入，在我的代码中进行进一步处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:21:29.930

这是一些例子，[http://www.bitrepository.com/a-collection-of-free-javascript-date-pickers.html](http://www.bitrepository.com/a-collection-of-free-javascript-date-pickers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:31:05.690

遗憾的是，AppSDK 1.0 不包含 DatePicker 组件。我不相信有计划将 DatePicker 组件添加到 AppSDK 1.0。Rally 对 AppSDK 1.0 开发人员的建议通常是使用来自 JQuery 或类似的日历/选择器组件。当然，正如您所注意到的，由于您无法在 rally1 上托管这样的组件，您最终会引用主机外部的 javascript 库，这可能会在许多浏览器中产生安全警告。

Rally 的 AppSDK2 预览版基于 ExtJS 4 构建，包括一个完全集成的 DatePicker 组件：

[https://rally1.rallydev.com/apps/2.0p2/doc/#!/api/Rally.ui.DateField](https://rally1.rallydev.com/apps/2.0p2/doc/#!/api/Rally.ui.DateField)

您可能有兴趣开始在 AppSDK2 框架上开发您的应用程序，因为这将很快成为 Rally 的首选 Javascript 开发平台，一旦它不再预览。您可以在这里找到更多信息：

[https://rally1.rallydev.com/apps/2.0p2/doc/](https://rally1.rallydev.com/apps/2.0p2/doc/)

# android - 更改 ViewPager 最小投掷距离

> ID：11284457
> 
> 赞同：0
> 
> 时间：2012-07-01T18:09:06.380
> 
> 标签：android, android-layout, android-widget, android-viewpager

我需要“减慢” ViewPager，并且我想增加 MIN_DISTANCE_FOR_FLING。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:22:27.443

如果您需要更改 ViewPager 速度，您可以使用 java 反射 API。查看此主题： [Android 中 Viewpager 控制器的速度变慢](https://stackoverflow.com/questions/8155257/slowing-speed-of-viewpager-controller-in-android)

# node.js - Node.js：使用“fs”迭代目录时检查文件是否为符号链接

> ID：11284464
> 
> 赞同：21
> 
> 时间：2012-07-01T18:09:54.973
> 
> 标签：node.js, linux, fs, symlink-traversal, node-supervisor

Supervisor 是 Node.js 的一个包，用于监视应用目录中的文件是否有修改，并在发生修改时重新加载应用。

此脚本将符号链接解释为常规文件并注销警告。我想分叉主管，以便可以完全修复此问题或产生更具描述性的警告。

如何使用 Node.js 的文件系统模块来确定给定文件是否真的是符号链接？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-02T01:38:06.007

您可以使用[`fs.lstat`](http://nodejs.org/api/fs.html#fs_fs_lstat_path_callback)然后调用传递给您的 lstat 回调[`statis.isSymbolicLink()`](https://nodejs.org/api/fs.html#fs_stats_issymboliclink)的对象。[`fs.Stats`](http://nodejs.org/api/fs.html#fs_class_fs_stats)

```
fs.lstat('myfilename', function(err, stats) {
    console.log(stats.isSymbolicLink());
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-08-18T02:31:19.057

好像你可以使用[isSymbolicLink()](https://nodejs.org/api/fs.html#fs_dirent_issymboliclink)

```
const files = fs.readdirSync(dir, {encoding: 'utf8', withFileTypes: true});
files.forEach((file) => {
  if (file.isSymbolicLink()) {
    console.log('found symlink!');
  }
} 
```

# flash - 无物体移动动画

> ID：11284465
> 
> 赞同：0
> 
> 时间：2012-07-01T18:10:05.100
> 
> 标签：flash, object, actionscript-2, move

我最近开始闪存编程，我遇到了一个不显示运动的移动功能问题，

我使用的代码：

```
function cardmove(card){
    xDiff=(playerHand+space+card.width)-card._x;
    yDiff=(Stage.height/2+space)-card._y;
        speedx =xDiff/10;
        speedy =yDiff/10; 
    for (frame=0;frame<10;frame++){
         card._x+=speedx;
         card._y+=speedy;}
    playerHand = card._x ;
} 
```

卡就位，它应该在开始时就正确，并且没有显示任何移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T16:06:19.733

Flash 在循环期间不会刷新布局。如果你想移动一些东西，你必须让手在两步之间闪现。

您有两种主要方法，即 setInterval ：

```
// You need to declare this variables to access them in the function "applyMovement"
var _nInterval:Number;
var _nSteps:Number;

// Yout function
function cardmove(card){
    xDiff=(playerHand+space+card.width)-card._x;
    yDiff=(Stage.height/2+space)-card._y;
    speedx =xDiff/10;
    speedy = yDiff / 10; 

    // Set the steps to 10
    _nSteps = 10;
    // Before start the setInterval, you have to stop a previous one
    clearInterval(_nInterval);
    // You call the function each 41 ms (about 24 fps) with the parameters
    setInterval(this, "applyMovement", 41, card, speedx, speedy);
}
// This function apply the new coodinates
function applyMovement(mc:MovieClip, nX:Number, nY:Number) {
    if (_nSteps >= 0) {
        mc._x += nX;
        mc._y += nY;
    }else {
        clearInterval(_nInterval);
    }
    _nSteps --;
} 
```

或 onEnterFrame ：

```
// You need to declare this variables to access them in the function "applyMovement"
var _nSteps:Number;
var _mc:MovieClip;
var _nX:Number;
var _nY:Number;

// Yout function
function cardmove(card){
    xDiff=(playerHand+space+card.width)-card._x;
    yDiff=(Stage.height/2+space)-card._y;
    _nX =xDiff/10;
    _nY = yDiff / 10; 

    _mc = card;

    // Set the steps to 10
    _nSteps = 10;
    // You have to use the Delegate function to access to the "good" this in the function
    this.onEnterFrame = mx.utils.Delagate.create(this,applyMovement);
}
// This function apply the new coodinates
function applyMovement() {
    if (_nSteps >= 0) {
        _mc._x += nX;
        _mc._y += nY;
    }else {
        delete this.onEnterFrame;
    }
    _nSteps --;
} 
```

# javascript - 禁用 Chrome 扩展缩小

> ID：11284466
> 
> 赞同：0
> 
> 时间：2012-07-01T18:10:09.240
> 
> 标签：javascript, google-chrome, google-chrome-extension, minify

我一直在开发 Chrome 扩展程序，但在调试我的脚本时有点烦恼。我的背景页面是一个 Javascript 文件，它总是被 Chrome 自动缩小。您可以看到使用开发人员工具变得很痛苦，因为所有内容都在一行中。有人知道这是否可以禁用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T03:01:02.803

要正常查看您的 Chrome 扩展程序源：

1 打开 Chrome 的扩展管理页面
2 确保选中开发者模式

![在此处输入图像描述](../Images/52ad6c80b4ca0953ed82363719439e38.png)

3 检查视图后单击链接以在 chrome 开发人员工具窗口中打开扩展文件

![在此处输入图像描述](../Images/fd96fccd4d21bac56ebc9adbf47369b6.png)

4 单击后台页面中包含的脚本文件的链接以查看后台脚本

![在此处输入图像描述](../Images/f98abeba1d671b5bf8ecdd00ce200a71.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-10T22:17:16.270

也许这是相关的。

[http://www.elijahmanor.com/7-chrome-tips-developers-designers-may-not-know/](http://www.elijahmanor.com/7-chrome-tips-developers-designers-may-not-know/)

2.  漂亮打印（又名 unminify）JavaScript 源代码的能力

有时我试图找出一个错误，不幸的是，包含的 JavaScript 已被缩小。如您所知，尝试调试缩小文件几乎是不可能的。你如何在有无数个字符的行上设置断点？

值得庆幸的是，Chrome 有一个漂亮的打印功能，它将获取一个缩小的 JavaScript 文件并将其格式化为属性。您只需单击底部工具栏上的“{}”图标即可激活此功能。当然，名称仍然会被混淆（取决于首先是哪个程序缩小了 JavaScript），但您至少可以设置断点并调试代码。

# jquery - 将 ID 参数传递给函数

> ID：11284467
> 
> 赞同：1
> 
> 时间：2012-07-01T18:10:29.280
> 
> 标签：jquery, function, syntax

我希望这是一个简单的语法问题。
我在一个页面上有很多项目。单击时，应将每个项目的 id 传递给 jquery。这将导致出现具有更多细节的不透明层。我正在努力将 id 的值放入脚本中。

有人可以帮忙吗？
这是表格的一部分：

```
<ul class="foodmenu">
    <li class="foodmenuitems"><img src="images/classic.png" id="classic" /></li>
    <li class="foodmenuitems"><img src="images/blue.png"  id="blue"/></li>
</ul> 
```

和脚本：

```
$(document).ready(function() {
    $(".food-item-details").hide();
    $(".foodmenuitems").click(function() {
        $(".food-item-details").hide();
        var foodItem = $(this).value;
        $(foodItem).show('slow');
    });
    $(".close").click(function() {
        $(".food-item-details").hide('slow');
    });
}); 
```

任何建议都感激不尽！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:12:55.410

您可能想要的是`var foodItem = '#' + this.id;`- 只有表单输入具有`value`.

但是，这仍然行不通，因为 ID 需要是唯一的。您可以通过使用数据属性轻松修复它：

```
<ul class="foodmenu">
    <li class="foodmenuitems"><img src="images/classic.png" data-item="classic" /></li>
    <li class="foodmenuitems"><img src="images/blue.png"  data-item="blue"/></li>
</ul> 
```

```
$(document).ready(function() {
    $(".food-item-details").hide();
    $(".foodmenuitems").click(function() {
        $(".food-item-details").hide();
        var foodItem = $(this).data('item');
        $('#' + foodItem).show('slow');
    });
    $(".close").click(function() {
        $(".food-item-details").hide('slow');
    });
}); 
```

`data-item`现在，此代码在单击时显示具有指定 ID 的元素。

# spring-security - Spring security Remeber Me cookie为错误的路径创建

> ID：11284472
> 
> 赞同：0
> 
> 时间：2012-07-01T18:10:53.680
> 
> 标签：spring-security

我正在使用启用了“记住我”的 Spring Security 3.1.0。我注意到 SPRING_SECURITY_REMEMBER_ME cookie 在客户端的浏览器中出现了 2 或 3 次。具有相同值但具有不同路径的 Cookie：`Path=/`, `Path=/user`,`Path=/categories`

该应用程序在`/`上下文中运行，所以我不明白如何创建带有其他路径的 cookie。

它发生了不止一次，但我没有成功重现这种行为。

任何想法，我怎么可能导致它？

谢谢

亚历克斯

更新：Spring Security 版本 3.0.5 到 3.1.0

# wpf - 如何在 WPF 中进行布局（覆盖统一网格？）

> ID：11284474
> 
> 赞同：1
> 
> 时间：2012-07-01T18:11:06.410
> 
> 标签：wpf, layout

我正在尝试使用给定的布局创建一个窗口，我很好奇最好的方法。我已将窗口背景设置为较浅颜色的平铺图像。然后我想我会添加一个带有五列和一行的统一网格，其中第 5 列具有“橙色”略微透明的背景。然后，我将添加另一个具有 5 行和 1 列的统一网格，其中第 2 行和第 3 行具有相同的“橙色”颜色设置。最终，我将在左上角添加公司徽标，并在“橙色”的水平带中添加一些文本。我的方法似乎不起作用:-(我自己正在研究的任何指导将不胜感激。![例子](../Images/5571d65d8897fc82957f4de4b190e8fe.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:26:51.167

这对我很有效：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="5*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="0" Background="Yellow">
            <Image Source="http://www.google.com/images/srpr/logo3w.png"
                   HorizontalAlignment="Left"/>
        </Grid>
        <Grid Grid.Row="0" Grid.Column="1" Background="Orange"/>
        <Grid Grid.Row="1" Grid.Column="0" Background="Orange"/>
        <Grid Grid.Row="1" Grid.Column="1" Background="Red"/>
        <Grid Grid.Row="2" Grid.Column="0" Background="Yellow"/>
        <Grid Grid.Row="2" Grid.Column="1" Background="Orange"/>
        <TextBlock Grid.Row="1" Grid.ColumnSpan="2" Grid.Column="0">
            I am nice text spanning the whole row! Look, here's a lot
            of me in the cell.
        </TextBlock>
    </Grid>
</Page> 
```

如果你坚持半透明条纹，你可以做类似的东西

```
<Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="1"
      Background="Orange" Opacity="0.5"/> 
```

或者

```
<Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="1" Background="#80FF7F00"/> 
```

（包括颜色的不透明度）等。

例如，试试这个（你需要调整颜色）：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="5*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
              Background="Yellow" Opacity="0.5"/>
        <Grid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
              Background="Orange" Opacity="0.5"/>
        <Grid Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
              Background="Yellow" Opacity="0.5"/>
        <Grid Grid.Row="0" Grid.Column="0" Grid.RowSpan="3"
              Background="Yellow" Opacity="0.5"/>
        <Grid Grid.Row="0" Grid.Column="1" Grid.RowSpan="3"
              Background="Orange" Opacity="0.5"/>
        <Image Grid.Row="0" Grid.Column="0"
               Source="http://www.google.com/images/srpr/logo3w.png"
               HorizontalAlignment="Left"/>
        <TextBlock Grid.Row="1" Grid.ColumnSpan="2" Grid.Column="0">
            I am nice text spanning the whole row! Look, here's a lot
            of me in the cell.
        </TextBlock>
    </Grid>
</Page> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T20:28:23.257

简短的回答就是使用网格并将单元格的背景颜色设置为我选择的具有轻微透明度的颜色。然后我可以将相交的单元格设置为较深的颜色，或者将标签添加到具有相同背景和透明度的相交单元格。感谢大家的帮助。在过去的一个小时里，我学到了很多关于 xaml 和 WPF 的知识。

# xml - docbook 5 中的字符样式

> ID：11284476
> 
> 赞同：2
> 
> 时间：2012-07-01T18:11:25.147
> 
> 标签：xml, docbook, docbook-5

docbook 5 中的字符样式是什么？我知道有 sect1-title、sect2-title 等段落样式。我想知道有哪些字符样式。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T15:31:07.797

通过使用样式表，您可以定义任意数量的“字符样式”。大多数人使用的样式表集（可从[DocBook SourceForge 项目](https://sourceforge.net/projects/docbook/)获得）为许多内联元素提供默认样式。没有详细列出任何“标准”样式的详尽列表，但是根据自己的喜好自定义输出相当容易。

默认不支持“斜体+下划线”之类的样式，但你可以根据需要添加。按照惯例，该`role`属性用于为元素提供分类（“样式表提示”）。有关详细信息，请参阅[http://www.sagehill.net/docbookxsl/CustomInlines.html 。](http://www.sagehill.net/docbookxsl/CustomInlines.html)

* * *

值得强调的是，DocBook 标记（模式中定义的元素和属性）与“样式”无关。DocBook 是一种[语义标记语言](http://en.wikipedia.org/wiki/DocBook)，一个关键概念是您定义/描述某物是什么，而不是它应该是什么样子。

# vtd-xml - vtd-xml 替换整个元素

> ID：11284479
> 
> 赞同：1
> 
> 时间：2012-07-01T18:11:42.243
> 
> 标签：vtd-xml

我遇到了奇怪的问题，我在网上找不到任何东西。

我使用 xpath 来定位我的 xml 块，然后将其替换为其他内容，例如：

```
// input
<html>
    ...
    <style type="">
        background: yellow;
    </style> 
    <link href="path" /> 
</html>

// output
<html>
    ...
    <link href="pathToFileWithBackground" />
    <link href="path_other" /> 
</html> 
```

我使用 XMLModifier 来实际更新令牌（使用 updateToken 方法:]），它适用于属性操作或元素的文本（正文）。

我对样式元素有疑问，我想处理它的主体，然后用指向某个文件的链接替换整个元素。

显然，更新文本标记将导致其中带有链接标记的样式标记。

```
 <style type=""><link href="path" />
    </style> 
```

所以我尝试将导航器移动到样式元素并得到了这个

```
 <<link href="path" /> type="">
        background: yellow;
    </style> 
```

我还尝试在样式元素之前插入链接元素并将其删除，但是当我尝试保存修饰符的数据时，我从 XMLModifier 得到 ModifyException("Invalid insert/deletion condition detected between offset .. and offset")。这是代码

```
 ap.selectXPath("//style/text());
      vn.toElement(VTDNav.PARENT);                  
      modifier.insertBeforeElement(replaceString);  
      modifier.remove(); 
```

我尝试使用 remove(long l) 和 remove(int offset, int lengtt) 版本但得到了同样的异常

任何想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T19:05:39.163

好的，所以问题出在

```
vn.getElementFragment() 
```

返回错误的长度。可能是因为（在我的测试文件中）样式元素后跟注释，并且包含注释字符并且长度大于应有的长度

这解决了一切

```
int o = (int)vn.getElementFragment();
int l = (int)(vn.getElementFragment() >> 32);
final String s = new String(vn.getXML().getBytes(o, l));
l = s.substring(0, s.indexOf("</style>")+8).length(); // ;]
modifier.removeContent(o, l);
modifier.insertBeforeElement(replaceString); 
```

希望它会帮助某人

# delphi - 如何将 Delphi 应用程序转换为 Web 应用程序？

> ID：11284480
> 
> 赞同：4
> 
> 时间：2012-07-01T18:11:49.303
> 
> 标签：delphi, delphi-7

我们有一个使用 Delphi 7 开发的 POS 软件，我们想知道如何将这个 Delphi 应用程序转换为 Web 应用程序。我们做了很多研究，但大部分信息都是几年前的。也许有一些新的东西（2012）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T01:12:13.403

您不能将桌面 Delphi 应用程序转换为 Web 应用程序。你将不得不重写它。您可以使用 Delphi 编写 Web 应用程序，但您将使用的控件和策略与桌面应用程序完全不同。如果您选择 Delphi 作为您的 Web 开发环境，您将能够重用任何非可视代码。使用 Delphi 开发 Web 应用程序并不常见。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-31T14:29:48.857

是的你可以！ [http://www.athtek.com/web-application-kit.html](http://www.athtek.com/web-application-kit.html)

“它可以轻松地将您的C/S类型的软件转移到浏览器端成为一个有效的互联网应用程序”

在线演示： http: [//www.athtek.com/web-application-kit/demos.html](http://www.athtek.com/web-application-kit/demos.html)

# c# - 在 Crystal Reports 中合并数据表

> ID：11284485
> 
> 赞同：1
> 
> 时间：2012-07-01T18:12:31.970
> 
> 标签：c#, .net, crystal-reports, dataset

我正在尝试按照以下给出的步骤从表中查询记录来显示报告

[http://www.codeproject.com/Articles/166291/Generate-a-report-using-Crystal-Reports-in-Visual](http://www.codeproject.com/Articles/166291/Generate-a-report-using-Crystal-Reports-in-Visual)

我收到一条错误消息

**ds.Tables[0].Merge(dt);**

as 不包含“表”的定义，并且找不到接受第一个类型参数的扩展方法“表”（您是否缺少 using 指令或程序集引用？）

在下面的代码中。请帮忙。

Emp 是 Dataset 所在的 xsd 文件名 (Emp.xsd)

```
protected void Page_Load(object sender, EventArgs e)
    {
        ReportDocument rptDoc = new ReportDocument();
        Emp ds = new Emp(); // Emp is the xsd file name (Emp.xsd)
        DataTable dt = new DataTable();
        // Just set the name of data table
        dt.TableName = "EmployeeStats";
        dt = AB.GetEEmpStats((int)Session["EmpID"]); //Call function to get the     employee statistics

        ds.Tables[0].Merge(dt); <<<<<<<<<<<<<<<<<<< Error at this line

        // .rpt file path
        rptEmpStat.Load(Server.MapPath("EmpStats.rpt"));
        //dataset to the report viewer.
        rptDoc.SetDataSource(ds);
        Emp.ReportSource = rptDoc;
        Emp.RefreshReport();

    } 
```

GetEEmpStats 的代码如下

```
 public DataTable GetEEmpStats(int ID)
    {
        //Connection string 
        //string sqlCon = <***************>;

        SqlConnection Con = new SqlConnection(sqlCon);
        SqlCommand cmd = new SqlCommand();
        DataSet ds = null;
        SqlDataAdapter adapter;
        try
        {
            Con.Open();
            //Stored procedure 
            cmd.CommandText = "sp_getEmpDetails";
            cmd.CommandType = CommandType.StoredProcedure;
            // input parameter 

            SqlParameter parameter1 = new SqlParameter();
            parameter1.ParameterName = "@ID";
            parameter1.SqlDbType = SqlDbType.Int;
            parameter1.Direction = ParameterDirection.Input;
            parameter1.Value = ID;

            // Add the parameter to the Parameters collection. 
            cmd.Parameters.Add(parameter1);
            cmd.Connection = Con;
            ds = new DataSet();
            adapter = new SqlDataAdapter(cmd);
            adapter.Fill(ds, "EmpDet");
        }
        catch (Exception ex)
        {
            throw new Exception(ex.Message);
        }
        finally
        {
            cmd.Dispose();
            if (Con.State != ConnectionState.Closed)
                Con.Close();
        }
        return ds.Tables[0];
    } 
```

# jsf - 如何使用 OSGi 和 EE6 模块化企业应用程序？

> ID：11284491
> 
> 赞同：6
> 
> 时间：2012-07-01T18:13:12.273
> 
> 标签：jsf, jpa, osgi, java-ee-6, cdi

我知道已经有一些与该主题相关的问题，但我还没有找到真正的解决方案。

目前我正在使用 JPA、CDI、JSF 使用 EE6 开发应用程序。我想采用一种更模块化的方法，而不是将所有东西都打包到 WAR 或 EAR 中，然后将整个东西部署在 Application Server 上。

我试图通过将一个模块分成3个maven项目来尽可能地设计我的应用程序：

*   API - 包含（无状态）服务的接口
*   模型 - 包含特定模块的 JPA 实体
*   Impl - 包含 API 的实现，主要是 CDI bean

每个模块的视图逻辑目前都捆绑在一个大型 Web 项目中，这很丑陋。我已经想到了 web 片段，但是如果我在 jar 文件中传播我的 bean 类和 xhtml 文件，我将不得不实现一个挂钩，以便父 web 应用程序可以查找资源。这种解决方案至少使我能够为每个模块创建第四个项目，该项目将包含与模块相关的所有视图逻辑，这是一个好的开始。

我想要的不仅是我可以拥有这四种项目，而且每个项目都是可热插拔的。这让我想到了 OSGi，起初它真的很酷，直到我意识到 EE6 技术在 OSGi 容器中并没有得到很好的支持。

**JPA**

让我们先看看 JPA。有一些教程 [1] 解释了如何制作启用 JPA 的 OSGi Bundle，但这些教程都没有展示如何将实体分散到不同的包中（模块的模型项目）。例如，我想要三个不同的模块

*   核
*   用户
*   博客

博客模块的模型项目对用户的模型项目有（编译时）依赖。用户模块的模型项目对核心的模型项目有（编译时）依赖。

如何让 JPA 在这种情况下工作，而不必为模块的每个模型项目创建持久性单元？我想要一个知道运行时所有可用实体的持久性单元。实体所在的模型项目当然应该是可热插拔的。也许我需要为每个客户端创建一个单独的项目，该项目导入所有需要的项目实体并包含一个包含所有必要配置内容的 persistence.xml。是否有任何可用的 maven 插件来构建这样的项目，甚至有其他方法来解决这个问题？

**CDI**

CDI 非常好。我真的很喜欢它，我不想再错过它了！我使用 CDI 扩展，例如 MyFaces CODI 和 DeltaSpike，它们很棒！我将我的（无状态）服务注入到其他服务或视图层中，这非常棒。由于我的服务是无状态的，因此将它们用作 OSGi 服务应该没有问题，但是 OSGi 中的 CDI 集成呢？我发现了一个 glassfish CDI Extension[2]，它可以将 OSGi 服务注入 CDI bean，但我也希望 OSGi 服务可以是 CDI bean。我不完全确定如何实现这一点，可能我必须使用 BeanManager 来实例化实现，然后在 BundleActivator 中的 ServiceRegistry 中为其接口注册每个实现。有没有这样做的标准方法？我想避免对 OSGi 框架的任何（编译时）依赖。

我也想像现在使用我的服务一样使用我的服务，而不做任何更改（未注释的实现和未限定的注入点）。有一个 JBoss Weld 扩展/子项目 [3] 似乎针对该问题，但它似乎处于非活动状态，我找不到任何最佳实践或操作方法。我怎样才能让我的实现保持原样但仍然能够使用 OSGi？我的意思是向实现添加注释并不是什么大不了的事，因为每个实现都已经用原型注释进行了注释，无论如何我想防止这种情况发生。

**JSF**

如前所述，我希望能够明智地传播我的视图逻辑模块。据我所知，这并不是开箱即用的。Pax Web[4] 应该以某种方式解决这个问题，但我不熟悉它。

我想在包含 Facelet 模板的模块“core”中有一个项目“CoreWeb”，我们称之为“template.xhtml”。然后，模块“blog”中名为“BlogWeb”的项目中的 JSF 页面应该能够引用该模板并应用组合。

为了能够扩展视图，我将引入一个可以由模块的特定类实现的 java 接口“扩展”。然后，视图的控制器将注入扩展的所有实现。例如，扩展将提供将包含在主视图中的子视图列表。

所描述的扩展机制可以很容易地实现，但必须满足以下要求：

*   将新的 OSGi Bundle 添加到应用程序服务器时，可用扩展集可能会更改，这些扩展必须可用于视图的控制器。
*   应该包含在主视图中的子视图（来自单独的包）应该是可访问的。

Spring Slices[5] 的单宿主多切片应用的概念非常有趣，但似乎仅限于 Spring DM Server，并且该项目似乎也处于非活动状态。

**概括**

在我描述的所有示例和行为之后，我希望你知道我想要实现什么。它只是一个非常动态和模块化的 EE6 应用程序。

我最终寻找的至少是关于如何让所有东西按照我的预期运行的文档，或者甚至更好的已经工作的解决方案！

[1] [http://jaxenter.com/tutorial-using-jpa-in-an-osgi-environment-36661.html](http://jaxenter.com/tutorial-using-jpa-in-an-osgi-environment-36661.html)

[2] [https://blogs.oracle.com/sivakumart/entry/typesafe_injection_of_dynamic_osgi](https://blogs.oracle.com/sivakumart/entry/typesafe_injection_of_dynamic_osgi)

[3] [http://www.slideshare.net/TrevorReznik/weldosgi-injecting-easiness-in-osgi](http://www.slideshare.net/TrevorReznik/weldosgi-injecting-easiness-in-osgi)

[4] [http://team.ops4j.org/wiki//display/paxweb/Pax+Web](http://team.ops4j.org/wiki//display/paxweb/Pax+Web)

[5] [https://jira.springsource.org/browse/SLICE](https://jira.springsource.org/browse/SLICE)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T07:07:34.350

要回答您的一些问题，不建议使用单个持久性单元但将实体分散到多个捆绑包[中，但有时可能会起作用](http://mail-archives.apache.org/mod_mbox/aries-user/201009.mbox/%3CBLU128-W23FF762B1355954B4AFA4DF7D0@phx.gbl%3E)。但是，如果您的实体如此密切相关以至于它们需要共享一个持久性单元，那么将它们跨模块拆分可能没有意义。此外，不要忘记您可以通过分离每个实体的实现和接口来处理编译时依赖关系——接口和实现不必在同一个包中。

对于依赖注入，您可能喜欢 Blueprint。有多种实现可用，并且大多数具有企业 OSGi 支持的应用程序服务器都支持开箱即用的蓝图。它使用 XML 添加元数据，因此类本身不需要任何修改。

# c# - OpenGL ES 1.1 深度缓冲区无法在 iOS 5 上使用 MonoTouch

> ID：11284499
> 
> 赞同：1
> 
> 时间：2012-07-01T18:14:49.663
> 
> 标签：c#, ios, opengl-es, xamarin.ios, depth-buffer

我无法在 iOS 5 上使用 MonoTouch 使深度缓冲区工作。我正在使用标准的 MonoTouch“OpenGL 应用程序”模板并添加此代码来测试深度缓冲区（OpenGL ES 1.1）：

```
GL.Enable(All.DepthTest);
GL.DepthFunc(All.Greater);
GL.DepthMask(true);

// Shape A
GL.DrawArrays (All.TriangleStrip, 0, 4); 

// Shape B (should be behind Shape A)
GL.Translate (.5f,.5f,.5f);
GL.DrawArrays (All.TriangleStrip, 0, 4); 

// Shape C (should be in front of Shape A)
GL.Translate (-1f,-1f,-1f);
GL.DrawArrays (All.TriangleStrip, 0, 4); 
```

形状 B 和 C 都绘制在形状 A 的前面。即使使用“GL.DepthFunc(All.Never)”也会发生同样的事情。深度缓冲区被完全忽略。我还尝试使用以下代码手动创建深度缓冲区（而不是依靠 MonoTouch/OpenTK“iPhoneOSGameView”为我创建一个）：

```
protected override void CreateFrameBuffer()
{
    base.CreateFrameBuffer();    
    uint depthbuffer=0;
    GL.Oes.GenRenderbuffers (1, ref depthbuffer);
    GL.Oes.BindFramebuffer (All.RenderbufferOes, depthbuffer);
    GL.Oes.RenderbufferStorage (All.RenderbufferOes, All.DepthComponent16Oes, (int) 768, (int) 1024);
    GL.Oes.FramebufferRenderbuffer (All.FramebufferOes, All.DepthAttachmentOes, All.RenderbufferOes, depthbuffer);
} 
```

它仍然无法正常工作。你知道我怎样才能让深度缓冲区工作吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:33:08.917

感谢发布的[NeHe-Lesson](http://github.com/bholmes/NeHe-MonoTouch/blob/master/NeHe-Lesson5/NeHe-Lesson5/EAGLView.cs) holmes，我找到了一个解决方案：我使用“OpenTK.Graphics.ES20.GL”中的方法而不是“OpenTK.Graphics.ES11.GL.Oes”中的方法来创建深度缓冲区。创建缓冲区后，我可以在“OpenTK.Graphics.ES11”中为我的程序的其余部分使用标准的 OpenGL 1.1 方法。这是代码：

```
OpenTK.Graphics.ES20.GL.GenRenderbuffers (1,ref depthRenderBuffer);
OpenTK.Graphics.ES20.GL.BindRenderbuffer (OpenTK.Graphics.ES20.All.Renderbuffer, depthRenderBuffer);
OpenTK.Graphics.ES20.GL.RenderbufferStorage (OpenTK.Graphics.ES20.All.Renderbuffer, OpenTK.Graphics.ES20.All.DepthComponent16, Size.Width, Size.Height);
OpenTK.Graphics.ES20.GL.FramebufferRenderbuffer (OpenTK.Graphics.ES20.All.Framebuffer, OpenTK.Graphics.ES20.All.DepthAttachment, OpenTK.Graphics.ES20.All.Renderbuffer, depthRenderBuffer); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T16:24:17.910

试试下面的。

```
GL.ClearDepth(1.0f);    
GL.Enable(All.DepthTest);   
GL.DepthFunc( All.Lequal); 
```

也不要忘记清除每个渲染的深度。

```
GL.Clear((int)(All.ColorBufferBit | All.DepthBufferBit)); 
```

我在学习时使用 MonoTouch 在 Github 上发布了 NeHe 课程的代码。 [这](http://github.com/bholmes/NeHe-MonoTouch/blob/master/NeHe-Lesson5/NeHe-Lesson5/EAGLView.cs)是需要深度测试的第一课，我会为您提供更多信息。

# java - Java ME 默认模拟器文件存储

> ID：11284501
> 
> 赞同：2
> 
> 时间：2012-07-01T18:15:00.780
> 
> 标签：java, java-me, emulation

我创建了一个应用程序，其中创建了一个文件。我选择的文件目录是（WINDOWS 7）的`Pictures/`文件夹。`Library`

模拟器登记了创建的文件，但在我的硬盘`pictures/`目录中找不到它。

实际创建的文件在哪里，如何访问该文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T19:35:06.197

这在模拟器帮助文档（[也可在线获取](http://docs.oracle.com/javame/dev-tools/jme-sdk-3.0-win/html-helpset/z400000c31767.html)）中进行了解释。

> ## 文件连接 API
> 
> 在真实设备上，FileConnection API 通常提供对存储在设备内存或存储卡上的文件的访问。
> 
> 在 Java ME Platform SDK 仿真器中，FileConnection API 使 MIDlet 能够访问存储在计算机硬盘上的文件。
> 
> 可以使用 FileConnection 访问的文件存储在`USER_HOME/javame-sdk/3.0/work/emulator-instance/appdb/filesystem`. 例如，`DefaultCldcPhone1`模拟器皮肤附带了一个名为 的根目录`root1`，其中包含一个自述文件和一个名为 的空目录`photos`。该文件的完整路径为：`USER_HOME/javame-sdk/3.0/work/emulator-instance/appdb/filesystem\root1\photos`
> 
> ...文件系统的每个子目录都称为**root**。Java ME Platform SDK 提供了一种管理根的机制。在模拟器运行时，从模拟器窗口的菜单中选择 View > External Events Generator。将打开一个实用程序窗口。单击文件连接选项卡。
> 
> ![http://docs.oracle.com/javame/dev-tools/jme-sdk-3.0-win/html-helpset/figures/filesystem-roots.gif](../Images/88870115180ce4e99cf04cf53eb66625.png "选择了文件连接选项卡的外部事件生成器窗口")
> 
> 在“文件连接”面板中，您可以挂载、卸载或删除文件系统根...

# php - ftp_put 不将文件传输到 ftp

> ID：11284502
> 
> 赞同：1
> 
> 时间：2012-07-01T18:15:05.660
> 
> 标签：php, ftp

我在下面有以下代码，我不明白为什么它不起作用。

```
 $server=("ftp.blah.com");
    $connect=ftp_connect($server);
    $dest='/';
    $login_result=ftp_login($connect,"blah@blah.com","lol");
    if(!($login_result)||!($connect))
    {
        $error;
    } else {
        echo "success";
    }
    $file= 'Tiny-' . $time. '.txt';
    $upload=ftp_put($connect,$dest,$file,FTP_ASCII);
    if (!$upload)
    {
        echo "failed to upload";
    } else{
        echo "successfully uploaded";
    }
    ftp_close($connect); 
```

当我运行代码时，我收到错误“警告：ftp_put（Tiny-201201070758.txt）：无法打开流：没有这样的文件或目录

我已使 ftp 的目标文件夹可读写。我还尝试通过以下方式包含文本文件的完整路径：

```
$file= 'C:\xampp\htdocs\Tiny-' . $time. '.txt' 
```

或者

```
$file= 'C:\\xampp\\htdocs\\Tiny-' . $time. '.txt' 
```

我也尝试使用 FTP_Binary 而不是 ASCII，仍然没有运气。

没有任何作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:17:21.887

你`url_fopen`在你的服务器上活跃了吗？检查与`phpinfo()`。

# java - TableView JAVAFX 2.1 中的上下文菜单

> ID：11284503
> 
> 赞同：3
> 
> 时间：2012-07-01T18:15:10.800
> 
> 标签：java, javafx, javafx-2

我想在表格视图中添加一个上下文菜单，更具体地说，我想在右键单击时在表格行上显示上下文菜单。

我试过这段代码

```
 final EventHandler click = new EventHandler() {
           public void handle(MouseEvent t) {

           }

                @Override
                public void handle(Event arg0) {
                }
     };
            final Context menu = new ContextMenu();
     MenuItem item = new MenuItem("Add Image");
     item.setOnAction(new EventHandler() {
          public void handle(ActionEvent t) 
          {
           }
                @Override
                public void handle(Event arg0)
                {
                  //some code here   
          }});
     menu.getItems().addAll(item);
     EditingCell cellFactory = new EditingCell(click,menu); 
      TableColumn col = new TableColumn("column1");
     col.setCellFactory(cellFactory); 
```

上面的代码在 JAVAFX 2.0 中正常工作，我在右键单击时获得了一个上下文菜单，但是当我使用 JAVAFX 2.1 运行我的代码时，上下文菜单不起作用。

我尝试使用showingProperty（）方法获取上下文菜单的显示属性，它在JAVAFX 2.1中返回false，在JAVAFX 2.0中返回true

此外，我还尝试制作我的自定义 cellfactory 类，这是我的代码（我从官方 JAVAFX TreeView 上下文菜单示例中获取）

```
import javafx.event.Event;
import javafx.event.EventHandler;
import javafx.scene.control.*;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

class TextFieldTreeCellImpl extends TableCell<String,String> {

    private TextField textField;
    private ContextMenu addMenu = new ContextMenu();

    public TextFieldTreeCellImpl() {
        MenuItem addMenuItem = new MenuItem("Add Employee");
        addMenu.getItems().add(addMenuItem);
        addMenuItem.setOnAction(new EventHandler() {
            public void handle(Event t) {

            }
        });
        setContextMenu(addMenu);
    }

    @Override
    public void startEdit() {
        super.startEdit();

        if (textField == null) {
            createTextField();
        }
        setText(null);
        setGraphic(textField);
        textField.selectAll();
    }

    @Override
    public void cancelEdit() {
        super.cancelEdit();

        setText((String) getItem());
        //setGraphic(getTableCell().getGraphic());
    }

    @Override
    public void updateItem(String item, boolean empty) {
        super.updateItem(item, empty);

        if (empty) {
            setText(null);
            setGraphic(null);
        } else {
            if (isEditing()) {
                if (textField != null) {
                    textField.setText(getString());
                }
                setText(null);
                setGraphic(textField);
            } else {
                setText(getString());
                //setGraphic(getTreeItem().getGraphic());

            }
        }
    }

    private void createTextField() {
        textField = new TextField(getString());
        textField.setOnKeyReleased(new EventHandler<KeyEvent>() {

            @Override
            public void handle(KeyEvent t) {
                if (t.getCode() == KeyCode.ENTER) {
                    commitEdit(textField.getText());
                } else if (t.getCode() == KeyCode.ESCAPE) {
                    cancelEdit();
                }
            }
        });  

    }

    private String getString() {
        return getItem() == null ? "" : getItem().toString();
    }
} 
```

我将此自定义单元工厂添加为：

```
 final Callback<TableColumn, TableCell> cellFactory = 
new Callback<TableColumn, TableCell>() {
    public TableCell call(TableColumn p) {
        return new TextFieldTreeCellImpl();
}

};
col.setCellFactory(cellFactory); 
```

它在 JAVAFX 2.0 中仍然可以正常工作，但在 JAVAFX 2.1 中却不行

请帮助我，我很难...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T23:44:06.323

官方`TreeView`和`TableView`教程都适用于 JavaFX 2.1。问题是，您正在混合这些代码示例。您不能退回需要`TreeCell`的电池工厂。只需单独遵循 TableView 教程，并将 EditingCell 替换为以下具有 contextMenu 的内容：`TableColumn``TableCell`

```
import javafx.event.Event;
import javafx.event.EventHandler;
import javafx.scene.control.ContextMenu;
import javafx.scene.control.MenuItem;
import javafx.scene.control.TableCell;
import javafx.scene.control.TextField;
import javafx.scene.input.KeyCode;
import javafx.scene.input.KeyEvent;

class EditingCell extends TableCell<Person, String> {

    private TextField textField;
    private ContextMenu addMenu = new ContextMenu();

    public EditingCell() {
        MenuItem addMenuItem = new MenuItem("Print Me");
        addMenu.getItems().add(addMenuItem);
        addMenuItem.setOnAction(new EventHandler() {

            public void handle(Event t) {
                // Do something with current row
                Person curr = getTableView().getItems().get(getIndex());
                System.out.println(curr.getFirstName() + " " + curr.getLastName());
            }
        });
    }

    @Override
    public void startEdit() {
        super.startEdit();

        if (textField == null) {
            createTextField();
        }
        setText(null);
        setGraphic(textField);
        textField.selectAll();
    }

    @Override
    public void cancelEdit() {
        super.cancelEdit();
        setText((String) getItem());
        setGraphic(null);
    }

    @Override
    public void updateItem(String item, boolean empty) {
        super.updateItem(item, empty);

        if (empty) {
            setText(null);
            setGraphic(null);
        } else {
            if (isEditing()) {
                if (textField != null) {
                    textField.setText(getString());
                }
                setText(null);
                setGraphic(textField);
            } else {
                setText(getString());
                setGraphic(null);
                setContextMenu(addMenu);
            }
        }
    }

    private void createTextField() {

        textField = new TextField(getString());
        textField.setMinWidth(this.getWidth() - this.getGraphicTextGap() * 2);
        textField.setOnKeyReleased(new EventHandler<KeyEvent>() {

            @Override
            public void handle(KeyEvent t) {
                if (t.getCode() == KeyCode.ENTER) {
                    commitEdit(textField.getText());
                } else if (t.getCode() == KeyCode.ESCAPE) {
                    cancelEdit();
                }
            }
        });
    }

    private String getString() {
        return getItem() == null ? "" : getItem().toString();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T11:46:42.227

即使使用 setContextMenu() 方法，我也没有得到任何响应。

但是，这就是我解决问题的方法

我刚刚注册了一个鼠标事件并在指定位置显示了上下文菜单（在鼠标点击时）

```
this.setContextMenu(menu);
   this.getContextMenu().setAutoHide(true);

      EventHandler event = new EventHandler<MouseEvent>() {
@Override
public void handle(MouseEvent me) {
    if (me.getButton() == MouseButton.SECONDARY) {
  tableView.getContextMenu().show(tableView, me.getSceneX(), me.getSceneY());
    }
 }
};    
      this.addEventHandler(MouseEvent.MOUSE_CLICKED,event); 
```

# java - ANTLR：解析配置文件

> ID：11284504
> 
> 赞同：1
> 
> 时间：2012-07-01T18:15:26.593
> 
> 标签：java, antlr

我缺少一些基本知识。今天开始玩 ATLR 缺少任何来源告诉我如何执行以下操作：

我想解析我的程序当前以非常丑陋的方式读取的配置文件。基本上它看起来像：

```
A [Data] [Data]
B [Data] [Data] [Data] 
```

其中 A/B/... 是带有相关数据的对象（动态数量，只有简单的数字）。语法不应该那么难，但是现在如何使用 ANTLR？

*   仅词法分析器：A/B 是令牌，我要求他阅读的令牌。如何问这个以及如何检测格式错误的输入？
*   词法分析器和解析器：A/B 是解析器规则，并且...如何知道解析器成功处理了 A/B？同一个对象可能在文件中出现多次，我需要考虑每一个。它更像是在配置文件中列出实例。

**编辑**：我的问题不是语法，而是如何通过解析器/词法分析器了解他们实际发现/解析的内容？最好的办法是：在识别递归下降之类的规则时调用一个函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:49:50.837

ANTLR 生产规则可以有返回值，您可以使用它来获取配置文件的内容。

这是一个快速演示：

```
grammar T;

parse returns [java.util.Map<String, List<Integer>> map]
@init{$map = new java.util.HashMap<String, List<Integer>>();}
 : (line {$map.put($line.key, $line.values);} )+ EOF
 ;

line returns [String key, List<Integer> values]
 : Id numbers (NL | EOF)
   {
     $key = $Id.text;
     $values = $numbers.list;
   }
 ;

numbers returns [List<Integer> list]
@init{$list = new ArrayList<Integer>();}
 : (Num {$list.add(Integer.parseInt($Num.text));} )+
 ;

Num   : '0'..'9'+;
Id    : ('a'..'z' | 'A'..'Z')+;
NL    : '\r'? '\n' | '\r';
Space : (' ' | '\t')+ {skip();}; 
```

如果您运行以下课程：

```
import org.antlr.runtime.*;
import java.util.*;

public class Main {
  public static void main(String[] args) throws Exception {
    String input = "A 12 34\n" +
                   "B 5 6 7 8\n" +
                   "C 9";
    TLexer lexer = new TLexer(new ANTLRStringStream(input));
    TParser parser = new TParser(new CommonTokenStream(lexer));
    Map<String, List<Integer>> values = parser.parse();
    System.out.println(values);
  }
} 
```

以下将打印到控制台：

```
{A=[12, 34], B=[5, 6, 7, 8], C=[9]}
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:29:24.140

语法应该是这样的（它是伪代码而不是 ANTLR）：

```
FILE ::= STATEMENT ('\n' STATEMENT)*    
STATEMENT ::= NAME ITEM*
ITEM = '[' \d+ ']'
NAME = \w+ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:37:41.763

如果您正在寻找在解析某些内容时执行代码的方法，您应该使用操作或 AST（在文档中查找它们）。

# objective-c - 如何访问非重复 NSTimer 的剩余时间

> ID：11284506
> 
> 赞同：7
> 
> 时间：2012-07-01T18:16:05.673
> 
> 标签：objective-c, ios, uibutton, nstimer

我正在尝试访问 NSTimer X 的剩余时间。我想每秒更新一个按钮的标题以反映剩余时间`mm:ss`直到零。我在这里找不到任何东西。

例如：`[btY setTitle:[What to insert here?] forState:UIControlStateSelected];`

还是您宁愿以不同的方式解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-05-06T22:33:45.713

您可以使用 fireDate

```
NSTimer *timer = [NSTimer timerWithInterval:1.0 target:self selector:@selector(updateButton) userInfo:nil repeats:YES];

- (void)updateButton:(NSTimer*)timer
{
    float timeRemaining = timer.fireDate.timeIntervalSinceNow;
    // Format timeRemaining into your preferred string form and 
    // update the button text
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T18:17:48.710

这通常不是您解决此问题的方法。

创建一个重复的 NSTimer 设置为您想要更新按钮的分辨率。

因此，例如，如果您希望您的按钮每秒更改一次直到零，请创建一个 NSTimer，如下所示：

```
NSTimer *timer = [NSTimer timerWithInterval:1.0 target:self selector:@selector(updateButton) userInfo:nil repeats:YES]; 
```

然后执行`updateButton`；基本上有一个剩余秒数的计数器，每次`updateButton`被调用时，将计数器减一，并更新按钮的标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T18:18:13.067

您将无法获得此类信息，而是需要多次运行计时器，例如，如果您想每 30 秒更新一次带有文本的按钮，而不是启动 30 秒的计时器启动一个 1 秒的计时器并重复 30 次

# scala - 在akka中输入消息

> ID：11284507
> 
> 赞同：7
> 
> 时间：2012-07-01T18:16:15.660
> 
> 标签：scala, akka

Akka 框架建议仅将类型化的 Actor 用于与外部代码交互。但是，来自 akka 的标准演员是无类型的。有没有更好的方法来创建类型安全的演员？是否有其他一些演员框架或围绕 akka 的类型安全包装器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T22:27:00.773

如果您*真的*想要具有静态类型的演员，那么您不妨继续在整个代码中使用类型化的演员。出于几个原因，强烈建议不要这样做。

1.) 您冒着系统退化为一堆 RPC 的风险。演员的接收方法很明显，整个事情都是关于消息传递的，如果你只是在一个类型化的演员上调用方法，那就更不用说了。

2.) 演员真的没有类型。当它运行时，actor 能够处理的消息可能会根据所处的状态而改变，就像它对这些消息所做的那样。这是对许多协议进行建模的绝佳方式，Akka Actor 使用 FSM 对其提供一流的支持。

因此，如果您真的想这样做，您可以在任何地方随意使用类型化的 Actor，它会起作用，但您应该在这样做之前认真考虑您要解决的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-09T07:19:15.287

有关编译时检查，请参阅[SynapseGrid](https://github.com/Primetalk/SynapseGrid/)框架。它定义了一个构建 DataFlow 拓扑的 SystemBuilder。在构造时，保证检查通过的类型。然后将生成的系统转换为具有嵌套且正确互连的参与者的 RuntimeSystem。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T20:41:13.803

为什么这对你来说是个问题？具有仅针对它可以处理的消息调用`akka.actor.Actor`的类型的接收方法。`PartialFunction`为什么需要编译时检查？但是要回答您的问题：一种方法是-对于外部api-围绕您构建一个包装器`ActorRef`，然后将消息发送给演员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-25T21:07:23.307

事情进展得很快，我考虑过更新 1\. Typed Actors 已被[弃用2\. 相反，](http://doc.akka.io/docs/akka/snapshot/scala/typed-actors.html) [Akka Typed](http://doc.akka.io/docs/akka/snapshot/scala/typed.html#typed-scala) 的新概念正在开发中

据我了解，这应该是类型化参与者系统*的*最终解决方案。但由于这至少是 Akka 2.4 的第三次尝试和最早的计划，这一说法仍有待证实。

我个人确实期待这两种系统都可用：现有的用于更动态的用例，新的用于更强大的用例

# c - (a && b) 语句中有多少个分支？根据 gcov：4

> ID：11284508
> 
> 赞同：2
> 
> 时间：2012-07-01T18:16:19.940
> 
> 标签：c, gcc, code-coverage, gcov

我用“gcc -fprofile-arcs -ftest-coverage test.c”编译了以下程序：

```
int main() {
  int a = 1;
  int b = 1;
  a && b;
} 
```

运行程序后，调用“gcov -bc test.c”报告至少有 4 个分支中的 50% 被占用一次。为什么 gcov 说程序有四个分支，而不是两个？运行以下程序后，gcov 正确报告 50% 的 2 个分支至少被占用一次：

```
int main() {
  int a = 1;
  if (a)
    a = 0;
  else
    a = 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:19:02.447

显然`gcov`正在考虑`a&&b`如下：

```
if(a) { // branch 1
    if(b) { // branch 2
        1; 
    } else { // branch 3
        0;
    }
} else { // branch 4
    0;
} 
```

尽管我相当确定实际的 CPU 指令将转换为单个分支。

# mongodb - GORM继承和获取超类

> ID：11284523
> 
> 赞同：2
> 
> 时间：2012-07-01T18:18:36.577
> 
> 标签：mongodb, grails, groovy, grails-orm

我有以下 grails 域对象

```
abstract class A {
    String name
}

class B extends A {
    String propertySpecificToB
}

class C extends A {
    String propertySpecificToC
} 
```

我可以成功地将它们保存到我的数据库（在这种情况下是 MongoDB）。但是，我想列出数据库中所有行的名称，所以我执行以下操作：

```
A.list() 
```

但是，当它尝试创建抽象类 A 的实例时会引发 InstantiationException。我如何列出所有行（无论它是哪个类）。我可以使 A 成为非抽象的，但拥有 A 永远不会有效。另外，我想在 A 中放置一些抽象方法。

我真的很希望它返回一个 A 列表，该列表实际上包含 Bs 和 Cs。

我找到了一个[相关的帖子](https://stackoverflow.com/questions/1720533/abstract-classes-in-gorm-relationships)，但这并没有解决这个问题。

# git - 使用 SVN 分支 git 样式

> ID：11284524
> 
> 赞同：1
> 
> 时间：2012-07-01T18:18:40.223
> 
> 标签：git, svn, version-control

我已经使用 git 工作了几年，并且已经习惯了不断分支。每个 1-2 天的任务通常都有自己的分支，当然，如果有抢占任务，它们也会在单独的分支中开发。现在我加入了一个在 SVN 中管理的项目，几乎没有分支。我想知道是否有任何东西阻止我在 SVN 中进行分支，类似于我在 git 中的工作方式（由于本地政策，我不能使用 git）。我的意思是，是否有技术原因使得在 SVN 中一直创建和合并分支变得不切实际？

# php - 在视图加载器中加载 GET 字符串

> ID：11284529
> 
> 赞同：0
> 
> 时间：2012-07-01T18:19:02.417
> 
> 标签：php, codeigniter

我不断收到无法加载请求的文件错误。有人知道我如何将 GET 字符串添加到下面的视图加载器中吗？

```
if ($userType == 'regular') {

foreach ($query->result() as $row) {
   $data = array('firstname' => $row->firstname);
   $this->load->view('reg-user/dashboard.php?requestedPageType=wall_1', $data);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T23:01:50.240

哟。

您不能将查询字符串传递给视图。您的视图文件名必须以 .php 结尾

使用数据数组来传递您的附加信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:34:57.260

GET 字符串是问号后面的字符串（查询字符串）

如果你有

```
name=value
name2=value2 
```

只需将其添加到

```
$this->load->view('reg-user/dashboard.php?requestedPageType=wall_1&name=value&name2=value2'); 
```

所以你的陈述是

```
$this->load->view('reg-user/dashboard.php?requestedPageType=wall_1&name=value&firstname='.urlencode($row=>firstname)); 
```

我不确定您的循环，但我认为您希望将每一行封装到查询字符串中

所以如果这是你想要做的，试试这个作为你的代码：

```
if ($userType == 'regular') {

$data = array();
foreach ($query->result() as $row) {
   array_push($data, $row);
}

$query_string = http_build_query($data);
$this->load->view('reg-user/dashboard.php?requestedPageType=wall_1&'.$query_string);

} 
```

# php - 加载/设置 php 类 var 名称动态 ->{$}

> ID：11284533
> 
> 赞同：-4
> 
> 时间：2012-07-01T18:19:11.220
> 
> 标签：php, class

我如何设置 php 类 var 名称动态？

例子：

```
$var_name = "new_var";
$class->{$var_name} = "new value"; 
```

没关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:20:48.637

```
$class->$var_name = "new value"; 
```

[http://codepad.org/KKAwSQdA](http://codepad.org/KKAwSQdA)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:20:56.317

好的，可以。你至少试过了吗？

[http://php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

# android - 为“android update project -p ...”设置什么环境变量

> ID：11284534
> 
> 赞同：1
> 
> 时间：2012-07-01T18:19:35.783
> 
> 标签：android, windows, ant

我正在尝试为我的 Android 项目设置 ANT。根据Android网站，使用的命令是

```
android update project -p name 
```

不幸的是，我的命令行（Windows 7）上没有命令“android”。你能告诉我我必须设置什么样的环境变量吗？SDK 位于`C:\Program Files (x86)\Android\android-sdk`，我想我会需要它。

我只需要扩展“路径”还是需要创建新变量（类似于“JAVA_HOME”，但适用于android）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:25:30.850

C:\Program Files (x86)\Android\android-sdk\tools

C:\Program Files (x86)\Android\android-sdk\platform-tools

两者都是有价值的。我不记得哪个有`android`二进制文件，但是，两者都有，你肯定会得到它。使用两者，您还将获得`adb`和`progaurd`。

而且，扩展 PATH 不要创建一个新的。

# scala - Scala：具有类型参数的类的隐式证据

> ID：11284538
> 
> 赞同：10
> 
> 时间：2012-07-01T18:20:12.443
> 
> 标签：scala, implicit-conversion, type-parameter

这是一个具有两个特征的简单设置，一个具有由先前特征限制的协变类型参数的类，以及具有由另一个类限制的类型参数的第二个类。对于这两个类，只有当两个特征之一是类型参数的基础时，一个特定的方法才可用（通过隐式证据）。这编译得很好：

```
trait Foo
trait ReadableFoo extends Foo {def field: Int}

case class Bar[+F <: Foo](foo: F) {
  def readField(implicit evidence: F <:< ReadableFoo) = foo.field
}

case class Grill[+F <: Foo, +B <: Bar[F]](bar: B) {
  def readField(implicit evidence: F <:< ReadableFoo) = bar.readField
} 
```

但是，由于`Bar`在 中是协变的`F`，我不应该需要在 中的`F`参数`Grill`。我应该只要求它`B`是`Bar[ReadableFoo]`. 然而，这失败了：

```
case class Grill[+B <: Bar[_]](bar: B) {
  def readField(implicit evidence: B <:< Bar[ReadableFoo]) = bar.readField
} 
```

出现错误：

```
error: Cannot prove that Any <:< this.ReadableFoo.
  def readField(implicit evidence: B <:< Bar[ReadableFoo]) = bar.readField 
```

为什么不考虑隐含的证据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T23:39:48.303

0__ 的答案（使用隐含的证据参数`bar`转换为正确的类型）是我对您提出的具体问题的回答（尽管`implicitly`如果您有隐含的参数，我建议不要使用）。

值得注意的是，您所描述的情况听起来可能是通过类型类实现临时多态性的一个很好的用例。例如，假设我们有以下设置：

```
trait Foo
case class Bar[F <: Foo](foo: F)
case class Grill[B <: Bar[_]](bar: B) 
```

还有一个类型类，以及一些方便的方法，用于创建新实例和将`readField`方法添加到任何具有范围内实例的类型上：

```
trait Readable[A] { def field(a: A): Int }

object Readable {
  def apply[A, B: Readable](f: A => B) = new Readable[A] {
    def field(a: A) = implicitly[Readable[B]].field(f(a))
  }

  implicit def enrich[A: Readable](a: A) = new {
    def readField = implicitly[Readable[A]].field(a)
  }
}

import Readable.enrich 
```

还有几个例子：

```
implicit def barInstance[F <: Foo: Readable] = Readable((_: Bar[F]).foo)
implicit def grillInstance[B <: Bar[_]: Readable] = Readable((_: Grill[B]).bar) 
```

最后是可读的`Foo`：

```
case class MyFoo(x: Int) extends Foo

implicit object MyFooInstance extends Readable[MyFoo] {
  def field(foo: MyFoo) = foo.x
} 
```

这允许我们执行以下操作，例如：

```
scala> val readableGrill = Grill(Bar(MyFoo(11)))
readableGrill: Grill[Bar[MyFoo]] = Grill(Bar(MyFoo(11)))

scala> val anyOldGrill = Grill(Bar(new Foo {}))
anyOldGrill: Grill[Bar[java.lang.Object with Foo]] = Grill(Bar($anon$1@483457f1))

scala> readableGrill.readField
res0: Int = 11

scala> anyOldGrill.readField
<console>:22: error: could not find implicit value for evidence parameter of
type Readable[Grill[Bar[java.lang.Object with Foo]]]
              anyOldGrill.readField
              ^ 
```

这就是我们想要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-01T20:23:42.073

调用`bar.readField`是可能的，因为证据实例允许从到`<:<`的隐式转换。`B``Bar[ReadableFoo]`

我认为打电话给`readField`你的问题需要一个连续的证据参数`F <:< ReadableFoo`。所以我的猜测是，编译器并没有完全替换`Bar`隐式解析的第一个搜索阶段的类型参数（因为 find `readField`，它首先需要 any `Bar`）。然后它在第二个隐式解决方案上窒息，因为据我所知，没有任何形式的“回溯”。

反正。好消息是，您比编译器了解更多，您可以通过使用 的`apply`方法`<:<`或使用辅助方法显式地进行转换`implicitly`：

```
case class Grill[+B <: Bar[_]](bar: B) {
  def readField(implicit evidence: B <:< Bar[ReadableFoo]) = evidence(bar).readField
}

case class Grill[+B <: Bar[_]](bar: B) {
  def readField(implicit evidence: B <:< Bar[ReadableFoo]) = 
    implicitly[Bar[ReadableFoo]](bar).readField
} 
```

还有另一种可能是最干净的可能性，因为它不依赖于`<:<`@Kaito 建议的可能存在问题的实现：

```
case class Grill[+B <: Bar[_]](bar: B) {
  def readField(implicit evidence: B <:< Bar[ReadableFoo]) =
     (bar: Bar[ReadableFoo]).readField
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T00:09:41.350

这不是问题的答案，而是表明“类型约束”实际上只是一种隐式转换：

```
Welcome to Scala version 2.9.1.final (Java HotSpot(TM) 64-Bit Server VM, Java 1.6.0_33).
Type in expressions to have them evaluated.
Type :help for more information.

scala> trait A { def test() {} }
defined trait A

scala> class WhatHappens[T] { def test(t: T)(implicit ev: T <:< A) = t.test() }
defined class WhatHappens

scala> :javap -v WhatHappens
...
public void test(java.lang.Object, scala.Predef$$less$colon$less);
  Code:
   Stack=2, Locals=3, Args_size=3
   0:   aload_2
   1:   aload_1
   2:   invokeinterface #12,  2; //InterfaceMethod scala/Function1.apply:(Ljava/lang/Object;)Ljava/lang/Object;
   7:   checkcast   #14; //class A
   10:  invokeinterface #17,  1; //InterfaceMethod A.test:()V
   15:  return
...
  LocalVariableTable: 
   Start  Length  Slot  Name   Signature
   0      16      0    this       LWhatHappens;
   0      16      1    t       Ljava/lang/Object;
   0      16      2    ev       Lscala/Predef$$less$colon$less;
... 
```

# java - 为什么我在这个程序中得到 java.io.FileNotFoundException？

> ID：11284539
> 
> 赞同：0
> 
> 时间：2012-07-01T18:20:15.680
> 
> 标签：java

为什么我在以下程序中得到 java.io.FileNotFoundException？

```
import java.io.*;

class FisDemo {

    public static void main(String[] args)throws IOException{

        FileInputStream fis=new FileInputStream("abc.txt");
/* Here we are accessing file abc.txt statically. i.e abc.txt must exist in current class directory */

        int  data;

        while(( data=fis.read())!=-1){
            System.out.println((char)data);
      // here we are casting, because return type of read() is int
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:22:33.447

> FileInputStream fis=new FileInputStream("abc.txt");

很可能你有坏的`file path`。
所以首先你需要检查你的文件所在的位置，然后添加正确的路径。

另请参阅：[如何在 Java 中](http://www.mkyong.com/java/how-to-construct-a-file-path-in-java/)构造文件路径或[构造文件路径](http://www.java2s.com/Tutorial/Java/0180__File/Constructfilepath.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T18:24:29.670

程序找不到 abc.txt 文件。也许它不在您的输出/ bin 文件夹中。如果文件可以在 src 文件夹/资源文件夹中，或者必须在构建应用程序后复制到输出文件夹，这取决于您的 IDE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:22:02.057

原因是 abc.txt 不存在（在当前目录中）。

```
FileInputStream fis=new FileInputStream("abc.txt"); 
```

指定文件的全名

```
 String fileFullName="/home/abc.txt";
    FileInputStream fis=new FileInputStream(fileFullName); 
```

是的，是您第二个问题的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T12:38:41.510

该文件在当前 java 文件目录中不存在。在那里创建它然后尝试。

# r - 按函数应用于 lm()

> ID：11284544
> 
> 赞同：5
> 
> 时间：2012-07-01T18:21:16.163
> 
> 标签：r

我是 R 的新手，我只是在学习这些`apply`功能以及它们是如何工作的。我只是想从`lm`几年内按产品颜色和品牌对变量 x 的拟合中提取系数。

我知道我可以创建一个 for 循环并按型号年份对数据进行子集化并对其进行拟合，但我认为是时候开始使用更多内置函数了，所以我希望能够使用 by 函数或其中一个 apply 来完成功能。这就是我的想法。

```
#some made up data

x<-rnorm(50,13400,1200)
color<-sample(factor(c("Red","Black","Blue","Green","White")),50,replace=T)
year<-sample(factor(2006:2012),50,replace=T)
brand<-sample(factor(c("A","B","C","D")),50,replace=T)

d<-data.frame(x,color,year,brand)

#now I want to fit the model lm(x~color+brand) for each year level
#this is what I was thinking...

tmp<-with(d,by(x,year,function(y) lm(x~color,data=y)))
sapply(tmp,coef) 
```

> eval 中的错误（predvars，data，env）：数字“envir”arg 长度不为 1

我是根据我进入时 R 给出的例子`help(by)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T18:30:57.867

试试这个：

```
tmp <- by(d, year, function(d.subset) lm(x~color, data=d.subset)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-01T18:37:08.317

除了使用基本的 R 函数（这是了解它们如何工作的好主意）之外，还值得看看谁以前可能在这方面工作过。将线性模型拟合到数据集的每个子集是很多事情，事实证明人们已经专门为此构建了一些方便的工具。

尝试查看包**lme4**和 function `lmList`。从 中的示例`?lmList`，

```
(fm1 <- lmList(Reaction ~ Days | Subject, sleepstudy)) 
```

`Reaction ~ Days`它分别为每个拟合线性模型`Subject`。这很方便，因为提取器方法直接作用于`fm1`：

```
> coef(fm1)
    (Intercept)      Days
308    244.1927 21.764702
309    205.0549  2.261785
310    203.4842  6.114899
330    289.6851  3.008073
331    285.7390  5.266019
332    264.2516  9.566768
333    275.0191  9.142045
334    240.1629 12.253141
335    263.0347 -2.881034
337    290.1041 19.025974
349    215.1118 13.493933
350    225.8346 19.504017
351    261.1470  6.433498
352    276.3721 13.566549
369    254.9681 11.348109
370    210.4491 18.056151
371    253.6360  9.188445
372    267.0448 11.298073 
```

（行号是 的 id 值`Subjects`）请参阅帮助文件`?lmList`以查看还有哪些其他方法可用于置信区间、绘图等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-13T08:50:19.900

这在更现代的软件包中要容易得多，例如`data.table`：

```
library(data.table)
setDT(d)
d[ , .(reg = list(lm(x ~ color))), by = year]
#    year  reg
# 1: 2012 <lm>
# 2: 2006 <lm>
# 3: 2011 <lm>
# 4: 2008 <lm>
# 5: 2007 <lm>
# 6: 2010 <lm>
# 7: 2009 <lm> 
```

列`reg`有`lm`对象；请注意，我们需要换行`lm`，`list(.)`以免`data.table`混淆普通列表（注意`is.list(lm(x ~ color, data = d))`是`TRUE`.

# android - 您如何检查用户是否在 Google Play 上对您的应用进行了评分？

> ID：11284549
> 
> 赞同：79
> 
> 时间：2012-07-01T18:21:39.297
> 
> 标签：android, android-intent, google-play, rating

我想查看用户是否在 Google Play 上对我的应用进行了评分，而不是多少星，只要他们有。如果他们没有，我会通过一个对话框提示他们，要求他们使用以下代码对其进行评分：

```
startActivity( new Intent( Intent.ACTION_VIEW,
       Uri.parse("market://details?id=packagename") ) ); 
```

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-07-01T18:26:22.057

不，你不能这样做。这也是一件好事——否则你将能够通过给予评价它的人奖励等来影响评价。此外，如果这样的 API 可用，开发人员将能够对负面评论进行报复。如果 Google 开始披露这些数据，这也可能违反用户与 Google 之间的某些法律协议。

但是，这是我个人在我的应用程序中所做的：

1.  让用户使用该应用程序 5 次，以获得良好的感觉。
2.  在第六次运行时提示用户使用 和 的选项对其进行`Yes`评分。后来推迟了两天。`Later``Never`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-05-02T01:25:51.110

实际上你可以做到，你可以通过使用这个或类似的来获取用户名......

[如何在 Android 上获取 google 用户名？](https://stackoverflow.com/questions/2727029/how-can-i-get-the-google-username-on-android)

[然后在https://play.google.com/store/apps/details?id=X](https://play.google.com/store/apps/details?id=X) URL上触发解析器...

```
<span class="author-name"> <a href="/store/people/details?id=11">Andy Borris</a>  </span>

<div class="tiny-star star-rating-non-editable-container" aria-label=" Rated 1 stars out of five stars "> <div class="current-rating" style="width: 20%;"></div> </div> 
```

然后你可以弹出“给我打五颗星，否则我会与全世界分享你的照片”：P lol 开个玩笑

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-01T21:59:29.550

让用户对您的应用进行评分确实需要付出努力，尤其是如果他们喜欢它！不幸的是，负面评价似乎需要更少的说服力;-)

我尝试了一些事情，都涉及一个名为“给我评分！”的应用程序按钮。或类似的，单击时会在手机上打开市场应用程序。根据我的经验，大多数点击第一个“给我评分”按钮的用户会多花 5 秒给你一个星级评分（请记住，大多数用户不知道你的应用无法跟踪他们是否真的提供了评分或不）。他们可能不会给你一个冗长的评论，并将其限制在几个词（“伟大的应用程序”），但嘿，你能得到什么！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T16:40:05.870

正如其他用户之前提到的，您最好的选择是使用“评价我的应用程序”按钮或对话框。如果您使用分析，您可以跟踪按钮点击。如果使用 Google Analytics，您可以为对话框上显示的按钮分配事件值，并查看有多少用户点击了“评分”按钮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-14T15:19:42.657

无法自动知道您的应用程序的评分。我建议的一个好的做法是选择最好的妈妈来评分，以获得更好的评价。

1 - 首先，找到评分的最佳时刻。您可以通过选择解决用户痛苦的时刻来有效地做到这一点。例如，如果您是 uberlike 应用程序，那么最好的时刻就是用户安全乘车并给司机一个好评。

2 - 然后，用是、以后和从不选项编写一个对话框，并保存到您的数据库以便以后询问或不询问。

3 - 再次询问下一个最佳时刻。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-20T10:54:17.193

有一个名为 aurora store 的应用程序显示用户评分，可能代码中可能是这个问题的答案，但我不确定法律后果。见： [https ://gitlab.com/AuroraOSS/AuroraStore](https://gitlab.com/AuroraOSS/AuroraStore)

# ruby-on-rails - has_many 和 belongs_to 在视图中给出错误

> ID：11284551
> 
> 赞同：0
> 
> 时间：2012-07-01T18:21:55.467
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是 ruby​​ 和 rails 的新手，几天来一直在努力解决这个问题。我知道我在我的应用程序的其他地方有另一个这样的关联，但是这个关联不起作用。

我的游戏模型和角色模型之间有 has_many 和 belongs_to 关系。

*游戏.rb*

```
has_many :characters 
```

*字符.rb*

```
belongs_to :game, :foreign_key => 'game_id' 
```

我希望能够将 game_id 存储在角色中，然后在视图中显示游戏名称，如下所示：

```
<%= @character.game.name %> 
```

但我得到这个错误：

> 字符中的 NoMethodError#show
> 
> 显示 .../rpglegion/app/views/characters/show.html.erb 其中第 5 行提出：
> 
> nil:NilClass 的未定义方法“名称”
> 
> 提取的源代码（第 5 行附近）：
> 
> 5: <%= @character.game.name %>
> 
> 应用程序跟踪 | 框架跟踪 | 全跟踪
> 
> app/views/characters/show.html.erb:5:in >_app_views_characters_show_html_erb__872566584_80495980' app/controllers/characters_controller.rb:20:in `show'

_characters_controller.rb_

```
def show
  @character = Character.find(params[:id])
  respond_to do |format| #line 20
    format.html # show.html.erb
    format.xml  { render :xml => @character }
  end
end 
```

我无法弄清楚我到底做错了什么，协会不起作用。有人能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:36:29.773

首先，belongs_to 关联隐含了“game_id”，因此您可以删除 :foreign_key 部分。

其次，@character 实际上是否将 game_id 设置为游戏？如果没有，请打开控制台，找到您正在查看的角色，并将其 game_id 设置为现有游戏。例如：

```
character = Character.find_by_id(some_character_id)
character.game = Game.find_by_id(some_game_id)
character.save 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:49:42.117

验证您所做的是对还是错的最佳方法是通过 rails 控制台。所以在命令行输入 rails c。输入 Character.all 或 Character.find(character_id) 看看你的 game_id 是否有价值。如果没有你的问题....

# .net - TabControl DockStyle : 填充

> ID：11284557
> 
> 赞同：0
> 
> 时间：2012-07-01T18:22:38.833
> 
> 标签：.net, winforms

我有一个`TabControl`，当我选择 时`DockStyle: Fill`，它从 0,0 开始填充整个父级。我怎么能改变这个坐标`DockStyle: Fill`？

我使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:24:02.323

你不能。
`Fill`就是那个意思；；它将填满所有可用空间。

相反，你可以在`Anchor`所有 4 个方面。

如果您尝试在其旁边放置另一个控件，只需将该控件停靠在一侧即可。
（您可能需要发送到后面）

# html - 具有一定宽度的图像重叠

> ID：11284558
> 
> 赞同：0
> 
> 时间：2012-07-01T18:22:56.950
> 
> 标签：html, css

我正在尝试在设置为特定宽度的区域内将多个图像叠加在一起。我的问题是，当这些图像的组合宽度超过该区域的宽度时，一些图像被放置在下面的行上。我试图通过`left:-100px`使图像相互重叠并减小整体组合图像的宽度来解决此问题，但仍然存在相同的问题。

我知道一个解决方案可能是`boxC{top:-100px;}`，但这意味着在窗口中生成了一个额外的 100px。作为验证，您可以最小化浏览器的垂直高度，您会看到有一个看不见的间隙。[http://postimage.org/image/5s0o82f81/](http://postimage.org/image/5s0o82f81/)

我的问题是我如何能够在一定宽度内将多个图像叠加在一起，而无需将任何图像放置在下面的行上。

我目前拥有的：http: [//jsfiddle.net/xFkh6/2/](http://jsfiddle.net/xFkh6/2/)

我想要什么：http: [//jsfiddle.net/d9xh8/2/](http://jsfiddle.net/d9xh8/2/)（请注意，要实现这一点，我必须设置`#wrapper{width:600px}`。我想通过保留它来实现这种外观，`#wrapper{width:500px}`就像在之前的 jsFiddle 中一样。

HTML：

```
<div id="wrapper">
    <div id="boxA" class="box"></div>
    <div id="boxB" class="box"></div>
    <div id="boxC" class="box"></div>
</div> 
```

CSS：

```
#wrapper { border:black 5px solid; width:500px; height:100px; margin:0 auto;}
.box { float:left; position:relative; top:0;}
#boxA {width:200px; height:100px; background:rgba(250,100,100,0.6); left:0px; }
#boxB {width:200px; height:100px; background:rgba(150,140,200,0.6); left:-50px;}
#boxC {width:200px; height:100px; background:rgba(100,250,250,0.6); left:-100px; top:-100px;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:10:48.253

而不是这样的left和top使用边距，

```
<style>
#wrapper { border:black 5px solid; width:500px; height:400px; margin:0 auto;}
#wrapper div { float:left;position:relative;}
#boxA {width:200px; height:100px; background:rgba(150,20,0,0.6); margin:0 0 0 0}
#boxB {width:200px; height:100px; background:rgba(150,40,100,0.6); margin:50px 0 0 -50px;}
#boxC {width:200px; height:100px; background:rgba(150,60,200,0.6); margin:100px 0 0 -50px;}  ​
</style>
<div id="wrapper">
    <div id="boxA" class="box"></div>
    <div id="boxB" class="box"></div>
    <div id="boxC" class="box"></div>
</div>​ 
```

# php - .htaccess 重定向主域和附加域问题

> ID：11284565
> 
> 赞同：5
> 
> 时间：2012-07-01T18:24:07.173
> 
> 标签：php, .htaccess, url-redirection

我有一个域名 maindomain.com

在主域中，我有一个博客。主域现在不活动。因此，对站点根 index.php 的所有请求都使用 htaccess 重定向到 maindomain.com/blog。

我在 htaccess 中有这个用于重定向

```
Redirect /index.php http://www.maindomain.com/blog/
Options All -Indexes 
```

一切正常。

现在我添加了一个插件域。插件域根文件夹是 maindomain.com/addondomain.com

addondomain.com 文件夹有一个 index.php。当我在浏览器中访问 addondomain.com 时，它被重定向到[http://www.maindomain.com/blog/](http://www.maindomain.com/blog/)如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T04:18:05.833

我假设您的附加域有不同的主机： addondomain.com ？

在这种情况下，只需将此条件添加到您的 .htaccess 中：

```
RewriteCond %{HTTP_HOST} maindomain.com$ [NC] 
```

所以完整的重定向规则如下所示：

```
RewriteCond %{HTTP_HOST} maindomain.com$ [NC]
RewriteRule /index.php$ http://www.maindomain.com/blog/ [R] 
```

# android - 如何在android textview中显示\？

> ID：11284569
> 
> 赞同：-1
> 
> 时间：2012-07-01T18:24:44.093
> 
> 标签：android

我熟悉在 textview 中使用 \n 在第二行显示，但是我想在我的 textview 中显示 /。尝试显示“C:\directorya\directoryb\”时，我在 Eclipse 中遇到转义错误，是否有我应该用来显示 \ 的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:25:54.593

是的，使用`\\`. 一个`\`逃脱第二个，所以它显示一个`\`字符。

# scripting - 如何使用 vbs 通过 UNC 读取链接到共享打印机的打印机快捷方式的快捷方式路径？

> ID：11284573
> 
> 赞同：1
> 
> 时间：2012-06-29T10:03:00.593
> 
> 标签：scripting

如何使用 vbsripting 通过 UNC 读取链接到共享打印机的打印机快捷方式的快捷方式路径？

# html - 喜欢按钮没有出现

> ID：11284574
> 
> 赞同：1
> 
> 时间：2012-07-01T18:25:04.467
> 
> 标签：html, facebook, facebook-like, facebook-social-plugins

所以这对我来说有点奇怪，希望有人能帮助我。

当我将此代码添加到 html 页面然后打开它时，不会出现类似按钮。但是，当我在 jsfiddle 中执行此操作时，它可以工作[http://jsfiddle.net/wZFss/](http://jsfiddle.net/wZFss/)有人知道可能出了什么问题吗？

谢谢，J

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    </head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like" data-href="http://www.diabolotricks.net" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div>
<p>helloworld</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:19:50.257

您将文档类型设置为 xhtml 1.1 并使用 html5 按钮代码。

您将需要使用 iframe 按钮、xfbml 按钮或将您的文档类型更改为 html5。

参考：[http ://www.w3.org/QA/2002/04/valid-dtd-list.html](http://www.w3.org/QA/2002/04/valid-dtd-list.html)

参考：[https ://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

# c# - 这个小代码可以优化吗？

> ID：11284575
> 
> 赞同：1
> 
> 时间：2012-07-01T18:25:24.647
> 
> 标签：c#, entity-framework, optimization

这很简单。

```
List<string> stringArr = new List<string>();
foreach (var item in db.IconTags)
{
    stringArr.Add(item.Tag);
}
string outPut = string.Join(",", stringArr); 
```

我希望可以说例如：

```
string outPut = string.Join(",", db.IconTags.Select(t => t.Tag).ToTArray()); 
```

或者也许

```
string outPut = string.Join(",", db.IconTags, t => t.Tag); 
```

没有什么很酷的事情可以做吗？我可以制作自己的方法，但我希望有一些内置的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T18:27:24.827

在 .NET 4 或更高版本中，您可以这样编写：

```
string output = string.Join(",", db.IconTags.Select(t => t.Tag)); 
```

在 .NET 3.5 中，您需要添加对`ToArray`：

```
string output = string.Join(",", db.IconTags.Select(t => t.Tag).ToArray()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:36:02.857

是的，你可以这么做。

如果您的目标是您的第一个代码工作的框架版本，那么您的第一个愿望也可以工作。它甚至可以在没有 的情况下工作`.ToArray()`，因为该`String.Join`方法需要一个`IEnumerable<string>`.

在框架 3.5 中，您需要`.ToArray()`，但在框架 3.5 中，您的第一个代码也不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T18:38:45.163

如果您想减少对象实例化/ lambda 函数的数量，您也可以这样做

```
StringBuilder builder = new StringBuilder();
for(var item in db.IconTags) {
    builder.Append(item.Tag).Append(",");
}
// We have one extraneous , so remove it
if(builder.Length > 1) {
    builder.Remove(builder.Length - 1, 1);
}
String output = builder.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T18:45:21.683

根据您的替代方案，我假设优化意味着更少的代码行，而不是更有效的计算。

您的第二种选择应该使用 Linq 工作：

```
string.Join(",", db.IconTags.Select(iconTag => iconTag.Tag).ToArray()); 
```

**更新：**正如其他人所说，可以在 .NET 4 及更高版本中删除 ToArray。

# php - PHP中的简单邮件确认

> ID：11284576
> 
> 赞同：0
> 
> 时间：2012-07-01T18:25:26.230
> 
> 标签：php, email, identity

我基本上试图做的是通过使用邮件地址确认用户的身份，然后如果身份得到验证，则执行某些数据库操作。我想生成一个确认码并以 URL 的形式发送到电子邮件地址。但我不想维护确认码的数据库。我怎样才能使用加密来做到这一点。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:40:41.370

它应该看起来像：

```
 <?php

    $salt = "this is a secret key!!!";

    if(isset($_GET["confirm"]) && isset($_GET["email"])){
        $confirm = $_GET["confirm"];
        $to_email = $_GET["email"];

        if(sha1($salt.$to_email) == $confirm){
            // this mail is confirmed, now do some db work
            // update_db ... ();
        }else{
            die("error: mail not confirmed");
        }

    }elseif(isset($_GET["email"])){
        $to_email = $_GET["email"];

        $confirm_link = $_SERVER["PHP_SELF"]."?confirm=".urlencode(sha1($salt.$to_email))."&mail=".urlencode($to_email);
        $msg = "to confirm ... click the link: \n ".$confirm_link;
        mail($to_email,"pls. confirm your mail",$msg);
    }else{
        die("error message");
    }
    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:28:06.247

您可以使用一些秘密盐对有问题的电子邮件地址进行哈希处理，并将其作为链接中的令牌。然后，当您验证它时，重复相同的过程。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-01T18:35:20.317

最好的方法是在您的数据库中有一个名为“activation”的 varchar 字段。

所以你可以在那里保留“确认码”。当用户激活他的帐户时，您会将其更新为“1”。因此，如果该字段为“1”；用户已激活他的帐户。否则那里仍然会有确认码并且用户的帐户没有被激活。所以至少会有一列用于激活过程。

# java - 查找包含给定单词的句子的最短部分

> ID：11284581
> 
> 赞同：1
> 
> 时间：2012-07-01T18:26:24.653
> 
> 标签：java, string, algorithm

例如：如果给出一个句子：
`My name is not eugene. my pet name is not eugene.`
并且我们必须搜索包含给定单词 **my**和**eugene**的句子中最小的部分， 那么答案将是 `eugene. my`。
无需检查大写或小写或特殊字符或数字。
我已经粘贴了我的代码，但是对于某些测试用例得到了错误的答案。

任何人都可以知道代码有什么问题。我没有错误的测试用例。

```
import java.io.*;
import java.util.*;
public class ShortestSegment 
{
static String[] pas;
static String[] words;
static int k,st,en,fst,fen,match,d;
static boolean found=false;
static int[] loc;
static boolean[] matches ;
public static void main(String s[]) throws IOException
{
    BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
    pas = in.readLine().replaceAll("[^A-Za-z ]", "").split(" ");
    k = Integer.parseInt(in.readLine());
    words = new String[k];
    matches = new boolean[k];
    loc = new int[k];
    for(int i=0;i<k;i++)
    {
        words[i] = in.readLine();
    }
    en = fen = pas.length;
    find(0);
    if(found==false)
    System.out.println("NO SUBSEGMENT FOUND");
    else
    {
        for(int j=fst;j<=fen;j++)
            System.out.print(pas[j]+" ");
    }

}
private static void find(int min)
{
    if(min==pas.length)
        return;
    for(int i=0;i<k;i++)
    {
        if(pas[min].equalsIgnoreCase(words[i]))
        {
            if(matches[i]==false)
            {
                loc[i]=min;
                matches[i] =true;
                match++;
            }
            else
            {
                    loc[i]=min;
            }
            if(match==k)
            {
                en=min;
                st = min();
                found=true;
                if((fen-fst)>(en-st))
                {
                    fen=en;
                    fst=st;
                }
                match--;
                matches[getIdx()]=false;
            }
        }
    }
    find(min+1);
}
private static int getIdx()
{
    for(int i=0;i<k;i++)
    {
        if(words[i].equalsIgnoreCase(pas[st]))
            return i;
    }
    return -1;
}
private static int min()
{
    int min=loc[0];
    for(int i=1;i<loc.length;i++)
        if(min>loc[i])
            min=loc[i];
    return min;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:17:52.707

您给出的代码将为以下输入产生不正确的输出。我假设，当您想要“查找包含给定单词的句子的最短部分”时，单词长度也很重要

> 字符串：'我的名字是尤金。我的名字是尤金。
> 搜索字符串数：2
> string1: 'my'
> string2: 'is'
> 你的解决方案是：'My firstname is'
> 正确答案是：'My fn is'

您的代码中的问题是，它认为 'firstname' 和 'fn' 的长度相同。在比较中`(fen-fst)>(en-st)`，您只考虑字数是否最小化，而不是字长是否缩短。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T22:44:01.000

以下代码（junit）：

```
@Test
public void testIt() {
    final String s = "My name is not eugene. my pet name is not eugene.";
    final String tmp = s.toLowerCase().replaceAll("[^a-zA-Z]", " ");//here we need the placeholder (blank)
    final String w1 = "my "; // leave a blank at the end to avoid those words e.g. "myself", "myth"..
    final String w2 = "eugene ";//same as above
    final List<Integer> l1 = getList(tmp, w1); //indexes list
    final List<Integer> l2 = getList(tmp, w2);
    int min = Integer.MAX_VALUE;
    final int[] idx = new int[] { 0, 0 };

    //loop to find out the result
    for (final int i : l1) {
        for (final int j : l2) {
            if (Math.abs(j - i) < min) {
                final int x = j - i;
                min = Math.abs(j - i);
                idx[0] = j - i > 0 ? i : j;
                idx[1] = j - i > 0 ? j + w2.length() + 2 : i + w1.length() + 2;
            }
        }

    }

    System.out.println("indexes: " + Arrays.toString(idx));
    System.out.println("result: " + s.substring(idx[0], idx[1]));
}

private List<Integer> getList(final String input, final String search) {
    String t = new String(input);
    final List<Integer> list = new ArrayList<Integer>();
    int tmp = 0;
    while (t.length() > 0) {
        final int x = t.indexOf(search);

        if (x < 0 || x > t.length()) {
            break;
        }
        tmp += x;
        list.add(tmp);
        t = t.substring(search.length() + x);

    }
    return list;

} 
```

给出输出：

```
indexes: [15, 25]
result: eugene. my 
```

我认为带有内联注释的代码很容易理解。基本上，玩索引+字长。

**笔记**

*   “未找到”案例未实施。
*   代码只是展示这个想法，它可以被优化。例如，至少可以保存一个 abs()。ETC...

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T13:57:02.447

我认为可以换一种方式处理：首先找到一个匹配结果，并最小化与当前结果的绑定，然后从当前结果中找到一个匹配结果。可以编码如下：

```
/**This method intends to check the shortest interval between two words
 * @param s : the string to be processed at
 * @param first : one of the words
 * @param second : one of the words
 */
public static void getShortestInterval(String s , String first , String second)
{
    String situationOne = first + "(.*?)" + second;
    String situationTwo = second + "(.*?)" + first;

    Pattern patternOne = Pattern.compile(situationOne,Pattern.DOTALL|Pattern.CASE_INSENSITIVE);
    Pattern patternTwo = Pattern.compile(situationTwo,Pattern.DOTALL|Pattern.CASE_INSENSITIVE);

    List<Integer> result = new ArrayList<Integer>(Arrays.asList(Integer.MAX_VALUE,-1,-1));
    /**first , test the first choice*/
    Matcher matcherOne = patternOne.matcher(s);
    findTheMax(first.length(),matcherOne, result);
    /**then , test the second choice*/
    Matcher matcherTwo = patternTwo.matcher(s);
    findTheMax(second.length(),matcherTwo,result);

    if(result.get(0)!=Integer.MAX_VALUE)
    {
        System.out.println("The shortest length is " + result.get(0));
        System.out.println("Which start @ " + result.get(1));
        System.out.println("And end @ " + result.get(2));
    }else
        System.out.println("No matching result is found!");
}

private static void findTheMax(int headLength , Matcher matcher , List<Integer> result) 
{
    int length = result.get(0);
    int startIndex = result.get(1);
    int endIndex = result.get(2);

    while(matcher.find())
    {
        int temp = matcher.group(1).length();
        int start = matcher.start();
        List<Integer> minimize = new ArrayList<Integer>(Arrays.asList(Integer.MAX_VALUE,-1,-1));
        System.out.println(matcher.group().substring(headLength));
        findTheMax(headLength, matcher.pattern().matcher(matcher.group().substring(headLength)), minimize);
        if(minimize.get(0) != Integer.MAX_VALUE)
        {
            start = start + minimize.get(1) + headLength;
            temp = minimize.get(0);
        }

        if(temp<length)
        {
            length = temp;
            startIndex = start;
            endIndex = matcher.end();
        }
    }

    result.set(0, length);
    result.set(1, startIndex);
    result.set(2, endIndex);
} 
```

请注意，这可以处理两种情况，无论两个单词的顺序如何！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T10:45:41.650

您可以使用`Knuth Morris Pratt`算法来查找文本中每个给定单词的所有出现的索引。假设您有长度为 N 和 M 个单词的文本（w1 ... wM）。使用`KMP`算法，您可以获得数组：

```
occur = string[N];
occur[i] = 1, if w1 starts at position i
...
occur[i] = M, if wM starts at position i
occur[i] = 0, if no word from w1...wM starts at position i 
```

你遍历这个数组并从每个非零位置向前搜索其他 M-1 个单词。

这是近似的伪代码。只是为了理解这个想法。如果你只是在java上重新编码它肯定不会工作：

```
for i=0 to N-1 {
 if occur[i] != 0 {
  for j = i + w[occur[i] - 1].length - 1 { // searching forward
   if occur[j] != 0 and !foundWords.contains(occur[j]) {
    foundWords.add(occur[j]);
    lastWordInd = j;
    if foundWords.containAllWords() break;
   }
   foundTextPeaceLen = j + w[occur[lastWordInd]].length - i;
   if foundTextPeaceLen < minTextPeaceLen {
    minTextPeaceLen = foundTextPeaceLen;
    // also remember start and end indexes of text peace
   }
  }
 }
} 
```

# templates - 在地图中使用 if 语句播放 2.0 模板 html 选择

> ID：11284582
> 
> 赞同：1
> 
> 时间：2012-07-01T18:26:26.597
> 
> 标签：templates, select, playframework-2.0

我想在`<select>`不使用助手的情况下创建一个（因为选择助手会生成*很多*html）

因此，我从 Controller 中获得了一个城市列表，例如：

```
public static List<City> getAllSortedByNameAsc() {
    List<City> cities = new ArrayList<City>();
    cities.addAll(City.find.orderBy("name").findList());
    return cities;
} 
```

在我的模板中，我使用以下代码创建选项：

```
@cities.map { city =>
    <option value="@city.id">@city.name</option>
} 
```

哪个有效，但我也希望将所选城市作为所选值。我尝试了几件这样的事情：

```
@cities.map { city =>
    <option value="@city.id" selected="@if(offerForm("city.id").value == city.id){selected}">@city.name</option>
} 
```

但这不起作用。谁能给我一个提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:07:45.873

**配置文件：application.conf**

```
db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
ebean.default="models.*" 
```

**控制器类 => Application.java**

```
package controllers;

import play.*;
import play.mvc.*;
import models.City;
import play.data.Form;
import views.html.*;

public class Application extends Controller {

  final static Form<City> cityForm = form(City.class);

  public static Result index() {
    City pune=new City();
    pune.name="pune";
    pune.save();

    City mumbai=new City();
    mumbai.name="mumbai";
    mumbai.save();

    City city=City.get(2L);

    return ok(index.render(cityForm.fill(city),City.all()));
  }

} 
```

**模型类 => City.java：**

```
package models;

import javax.persistence.Entity;
import javax.persistence.Id;
import play.db.ebean.Model;
import java.util.List;
import com.avaje.ebean.validation.NotNull;

@Entity
public class City extends Model{

    @Id
    public Long id;

    @NotNull
    public String name;

    public static Finder<Long, City> find = new Finder(Long.class, City.class);

    public static City get(Long id){
        return find.byId(id);
    }

    public static List<City> all() {
        return find.all();
    }

} 
```

**模板文件 => index.scala.html**

```
@(cityForm: Form[City],cities: List[City])

<!DOCTYPE html>
<html>
    <head><title></title></head>

    <body>
        <div>
            <select>
                @for(city <- cities){
                    <option value="@city.id" @{if(city.id.toString().equals(cityForm("id").value)) "selected='selected'"}/>@city.name</option>
                }
            </select>
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T01:08:57.910

我对类型映射的工作方式并不肯定，但我会尝试

```
@cities.map { city =>
    <option value="@city.id" selected="@if(offerForm("city.id").value.equals(city.id)){selected}">@city.name</option>
} 
```

而不是使用`==`运算符。

您还应该考虑帮助器是否有充分的理由生成所有 HTML。它通常是一个非常智能的框架。

# c - 在 C 中创建我自己的 blob 检测

> ID：11284583
> 
> 赞同：2
> 
> 时间：2012-07-01T18:26:28.540
> 
> 标签：c, computer-vision, computer-science, blobs

我正在做一个小学校项目，为此我需要检测一张白纸。我试图看看我是否可以使用 OpenCV 进行 blob 检测，但 OpenCV 不是我的领域。我想对工作表进行自己的斑点检测。我试图搜索示例，但我找不到任何东西。

我想让我的斑点检测器做的是：检测白纸，然后给出纸的 4 个角的坐标，然后在上面画一个多边形。

即使白纸内有图纸，斑点检测器也必须检测到白纸。任何帮助都可能很棒，因为我只有一周的时间来完成这项工作。

# android - 创建一个返回 JSON 而不是 XML 的 ASP.net WebService

> ID：11284584
> 
> 赞同：6
> 
> 时间：2012-07-01T18:26:43.867
> 
> 标签：android, asp.net, xml, json, web-services

也许该方法正在返回它应该返回的方式，但我基本上只是做了一个看起来像这样的测试方法

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string TestJSON()
    {
        var location = new Location[2];
        location[0] = new Location();
        location[0].Latitute = "19";
        location[0].Longitude = "27";
        location[1] = new Location();
        location[1].Latitute = "-81.9";
        location[1].Longitude = "28";

        return new JavaScriptSerializer().Serialize(location);
    } 
```

当我从我的 android 应用程序中点击它时，我得到一个这样的异常

```
Value <?xml of type java.lang.String cannot be converted to JSONArray 
```

我以为这个方法会直接返回 JSON，但这就是 Web 服务方法返回的内容

```
<?xml version="1.0" encoding="utf-8"?>
<string xmlns="http://tempuri.org/">[{"Latitute":"19","Longitude":"27"},{"Latitute":"-81.9","Longitude":"28"}]</string> 
```

是不是应该是这样的？有没有办法删除 JSON 之外的 XML 内容？我不确定我必须在我的网络服务中做什么才能使其返回正确的数据格式

Android上调用Web服务的代码

```
 public String readWebService(String method)
{
    StringBuilder builder = new StringBuilder();
    HttpClient client = new DefaultHttpClient();
    HttpGet httpGet = new HttpGet("http://myserver.com/WebService.asmx/" + method);

    Log.d(main.class.toString(), "Created HttpGet Request object");

    try
    {
        HttpResponse response = client.execute(httpGet);
        Log.d(main.class.toString(), "Created HTTPResponse object");
        StatusLine statusLine = response.getStatusLine();
        Log.d(main.class.toString(), "Got Status Line");
        int statusCode = statusLine.getStatusCode();
        if (statusCode == 200) {
            HttpEntity entity = response.getEntity();
            InputStream content = entity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(content));
            String line;
            while ((line = reader.readLine()) != null) {
                builder.append(line);
            }

            return builder.toString();
        } else {
            Log.e(main.class.toString(), "Failed to contact Web Service: Status Code: " + statusCode);
        }
    }
    catch (ClientProtocolException e) {
        Log.e(main.class.toString(), "ClientProtocolException hit");
        e.printStackTrace();
    }
    catch (IOException e) {
        Log.e(main.class.toString(), "IOException hit");
        e.printStackTrace();
    }
    catch (Exception e) {
        Log.e(main.class.toString(), "General Exception hit");
    }

    return "WebService call failed";    
} 
```

然后我会在代码中的某处调用该方法，例如

```
try {
    JSONArray jsonArray = new JSONArray(readWebService("TestJSON"));
    Log.i(main.class.toString(), "Number of entries " + jsonArray.length());
        ....
}
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T06:02:28.617

试试这个代码。它会帮助你。

[http://www.codeproject.com/Articles/45275/Create-a-JSON-WebService-in-ASP-NET-2-0-with-a-jQu](http://www.codeproject.com/Articles/45275/Create-a-JSON-WebService-in-ASP-NET-2-0-with-a-jQu)

# python - 使用 ctypes 将 python IplImage 对象作为简单结构传递给共享 C 库

> ID：11284586
> 
> 赞同：2
> 
> 时间：2012-07-01T18:26:55.973
> 
> 标签：python, opencv, interface, wrapper, ctypes

我正在尝试为用 C/C++ 编写的应用程序创建一个 python 包装器，它广泛使用 OpenCV C API。我想为此使用[ctypes](http://docs.python.org/library/ctypes.html)，因为我已经在以前的程序中成功使用过它。但是当我尝试将 Python 中的 IplImage 作为参数传递给 c 库中的函数时遇到了问题。

我创建了一个示例测试库来演示该问题。以下是我想使用的库中的函数：

```
// ImageDll.h

#include "opencv2/opencv.hpp"

extern "C"  //Tells the compile to use C-linkage for the next scope.
{
    // Returns image loaded from location
    __declspec(dllexport) IplImage* Load(char* dir);

    // Show image
    __declspec(dllexport) void Show(IplImage* img);
} 
```

还有一个cpp文件：

```
// ImageDll.cpp
// compile with: /EHsc /LD

#include "ImageDll.h"

using namespace std;

extern "C"  //Tells the compile to use C-linkage for the next scope.
{
    IplImage* Load(char* dir)
    {
        return cvLoadImage(dir, CV_LOAD_IMAGE_COLOR);
    }

    void Show(IplImage* img)
    {
        cvShowImage("image", img);
        cvWaitKey(0);
    }
} 
```

这是python的初步尝试：

```
from time import sleep
from ctypes import *
from modules.acquisition import InitCamera, GetImage
from modules.utils import struct
import cv2.cv as cv

# load DLL containing image functions
print "Loading shared library with genetic algorithm...",
image_lib = cdll.LoadLibrary("OpenCV_test_DLL.dll")
print "Done."
# get function handles
print "Loading functions of library...",
image_load = image_lib.Load
image_show = image_lib.Show
# set return type for functions (because ctypes default is int)
image_load.restype = c_void_p
image_show.restype = None
print "Done."

# initialize source
print "Initializing camera",
source = struct()
InitCamera(source)
print "Done."

# show video
while (1):
    # get image as PIL image
    img = GetImage(source)
    # transform image to OpenCV IplImage
    cv_img = cv.CreateImageHeader(img.size, cv.IPL_DEPTH_8U, 3)
    cv.SetData(cv_img, img.tostring())
    # show image using OpenCV highgui lib
    image_show(pointer(cv_img)) 
```

如您所见，我从相机获取图像作为 PIL 图像，然后将其转换为 python IplImage。这适用于 100%，因为当我用cv2.cv 模块中的 python 绑定替换最后一行**image_show(pointer(cv_img))时：**

```
 cv.ShowImage("image", cv_img)
    cv.WaitKey(20) 
```

然后我得到正确的输出。

所以问题在于**image_show(pointer(cv_img))**失败并出现**TypeError: *type* must have storage info**。这是因为 cv_img 需要是有效的 ctypes IplImage 结构。我试图用 ctypes 模仿它，但收效甚微：

```
from ctypes import *
from cv2 import cv

# ctypes IplImage
class cIplImage(Structure):
    _fields_ = [("nSize", c_int),
                ("ID", c_int),
                ("nChannels", c_int),
                ("alphaChannel", c_int),
                ("depth", c_int),
                ("colorModel", c_char * 4),
                ("channelSeq", c_char * 4),
                ("dataOrder", c_int),
                ("origin", c_int),
                ("align", c_int),
                ("width", c_int),
                ("height", c_int),
                ("roi", c_void_p),
                ("maskROI", c_void_p),
                ("imageID", c_void_p),
                ("tileInfo", c_void_p),
                ("imageSize", c_int),
                ("imageData", c_char_p),
                ("widthStep", c_int),
                ("BorderMode", c_int * 4),
                ("BorderConst", c_int * 4),
                ("imageDataOrigin", c_char_p)] 
```

这是进行转换的函数：

```
# convert Python PIL to ctypes Ipl
def PIL2Ipl(input_img):

    # mode dictionary:
    # (pil_mode : (ipl_depth, ipl_channels)
    mode_list = {
        "RGB" : (cv.IPL_DEPTH_8U, 3),
        "L"   : (cv.IPL_DEPTH_8U, 1),
        "F"   : (cv.IPL_DEPTH_32F, 1)
        }

    if not mode_list.has_key(input_img.mode):
        raise ValueError, 'unknown or unsupported input mode'

    result = cIplImage()
    result.imageData = c_char_p(input_img.tostring())
    result.depth = c_int(mode_list[input_img.mode][0])
    result.channels = c_int(mode_list[input_img.mode][1])
    result.height = c_int(input_img.size[0])
    result.width = c_int(input_img.size[1])

    return result
                    ("imageData", c_char_p),
                    ("widthStep", c_int),
                    ("BorderMode", c_int * 4),
                    ("BorderConst", c_int * 4),
                    ("imageDataOrigin", c_char_p)] 
```

视频循环然后更改为

```
# show video
while (1):
    # get image as PIL image
    img = GetImage(source)
    # transform image to OpenCV IplImage
    cv_img = cIplImage()
    cv_img = PIL2Ipl(img)
    # show image using OpenCV highgui lib
    image_show(pointer(cv_img)) 
```

通过这种方式，数据被传递到库，但随后它为**OpenCV Error: Bad flag (parameter or structure field) (Unrecognized or unsupported array type) in unknown function**哭泣。所以创建的 ctypes 结构是无效的。有谁知道如何正确实施它？当它使我能够将*python IplImage 传递给 c 库*时，我什至会接受不使用 ctypes 的其他解决方案。谢谢。

**注意：**我在过去 2 天里试图找到这个问题的答案，但没有成功。OpenCV 1.0 有一些解决方案，但最近使用 numpy 数组的 Python 的 OpenCV 绑定几乎不可能使 Python 和 C 应用程序之间的接口正常工作。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T03:59:49.677

最后我找到了解决我的问题的方法。而不是使用默认的python函数

```
cv.CreateImageHeader()
cv.SetData() 
```

我使用了从 OpenCV C 库中导出的 C 函数。:) 我什至设法将颜色从 PILs RGB 转换为 IplImage BGR 格式。这是完整的来源：

**ImageDll.h**

```
#include "opencv2/opencv.hpp"

extern "C"  //Tells the compile to use C-linkage for the next scope.
{
    // Returns image loaded from location
    __declspec(dllexport) IplImage* Load(char* dir);

    // Show image
    __declspec(dllexport) void Show(IplImage* img);

    // Auxiliary functions
    __declspec(dllexport) void aux_cvSetData(CvArr* arr, void* data, int step);
    __declspec(dllexport) IplImage* aux_cvCreateImageHeader(int width, int height, int depth, int channels);
    __declspec(dllexport) IplImage* aux_cvCvtColor(const IplImage* src, int code);
    __declspec(dllexport) void aux_cvCopy(const CvArr* src, CvArr* dst);
    __declspec(dllexport) void aux_cvReleaseImage(IplImage** image);
    __declspec(dllexport) void aux_cvReleaseImageHeader(IplImage** image);
} 
```

**图像DLL.cpp**

```
#include "ImageDll.h"

using namespace std;

extern "C"  //Tells the compile to use C-linkage for the next scope.
{
    IplImage* Load(char* dir)
    {
        return cvLoadImage(dir, CV_LOAD_IMAGE_COLOR);
    }

    void Show(IplImage* img)
    {
        cvShowImage("image", img);
        cvWaitKey(5);
    }

    void aux_cvSetData(CvArr* arr, void* data, int step)
    {
        cvSetData(arr,data,step);
    }

    IplImage* aux_cvCreateImageHeader(int width, int height, int depth, int channels)
    {
        return cvCreateImageHeader(cvSize(width,height), depth, channels);
    }

    IplImage* aux_cvCvtColor(const IplImage* src, int code)
    {
        IplImage* dst = cvCreateImage(cvSize(src->width,src->height),src->depth,src->nChannels);
        cvCvtColor(src, dst, code);
        return dst;
    }

    void aux_cvCopy(const CvArr* src, CvArr* dst)
    {
        cvCopy(src, dst, NULL);
    }

    void aux_cvReleaseImage(IplImage** image)
    {
        cvReleaseImage(image);
    }

    void aux_cvReleaseImageHeader(IplImage** image)
    {
        cvReleaseImageHeader(image);
    }
} 
```

**运行.py**

```
# This Python file uses the following encoding: utf-8

from time import sleep
from ctypes import *
from modules.acquisition import InitCamera, GetImage
from modules.utils import struct
import cv2.cv as cv
from modules.ipl import *

# load DLL containing image functions
print "Loading shared library with C functions...",
image_lib = cdll.LoadLibrary("OpenCV_test_DLL.dll")
print "Done."
# get function handles
print "Loading functions of library...",
image_load = image_lib.Load
image_show = image_lib.Show
cvReleaseImage = image_lib.aux_cvReleaseImage
# set return type for functions (because ctypes default is int)
image_load.restype = c_void_p
image_show.restype = None
cvReleaseImage.restype = None
print "Done."

# initialize source
print "Initializing camera",
source = struct()
InitCamera(source)
print "Done."

# show video
while (1):
    # get image as PIL image
    img = GetImage(source)
    # transform image to OpenCV IplImage
    cv_img = PIL2Ipl(img)
    # show image using OpenCV highgui lib
    image_show(cv_img)
    # release memory
    cvReleaseImage(byref(cv_img)) 
```

**ipl.py**

```
from ctypes import *
from cv2 import cv

# ctypes IplImage
class cIplImage(Structure):
    _fields_ = [("nSize", c_int),
                ("ID", c_int),
                ("nChannels", c_int),
                ("alphaChannel", c_int),
                ("depth", c_int),
                ("colorModel", c_char * 4),
                ("channelSeq", c_char * 4),
                ("dataOrder", c_int),
                ("origin", c_int),
                ("align", c_int),
                ("width", c_int),
                ("height", c_int),
                ("roi", c_void_p),
                ("maskROI", c_void_p),
                ("imageID", c_void_p),
                ("tileInfo", c_void_p),
                ("imageSize", c_int),
                ("imageData", POINTER(c_char)),
                ("widthStep", c_int),
                ("BorderMode", c_int * 4),
                ("BorderConst", c_int * 4),
                ("imageDataOrigin", c_char_p)]

# load DLL containing needed OpenCV functions
libr = cdll.LoadLibrary("OpenCV_test_DLL.dll")
cvSetData = libr.aux_cvSetData
cvCreateImageHeader = libr.aux_cvCreateImageHeader
cvCvtColor = libr.aux_cvCvtColor
cvCopy = libr.aux_cvCopy
cvReleaseImage = libr.aux_cvReleaseImage
cvReleaseImageHeader = libr.aux_cvReleaseImageHeader
# set return types for library functions
cvSetData.restype = None
cvCreateImageHeader.restype = POINTER(cIplImage)
cvCvtColor.restype = POINTER(cIplImage)
cvCopy.restype = None
cvReleaseImage.restype = None
cvReleaseImageHeader.restype = None
#print "auxlib loaded"

# convert Python PIL to ctypes Ipl
def PIL2Ipl(pil_img):
    """Converts a PIL image to the OpenCV/IplImage data format.

    Supported input image formats are:
        RGB
        L
        F
    """

    # mode dictionary:
    # (pil_mode : (ipl_depth, ipl_channels)
    mode_list = {
        "RGB" : (cv.IPL_DEPTH_8U, 3),
        "L"   : (cv.IPL_DEPTH_8U, 1),
        "F"   : (cv.IPL_DEPTH_32F, 1)
        }

    if not mode_list.has_key(pil_img.mode):
        raise ValueError, 'unknown or unsupported input mode'

    depth = c_int(mode_list[pil_img.mode][0])
    channels = c_int(mode_list[pil_img.mode][1])
    height = c_int(pil_img.size[1])
    width = c_int(pil_img.size[0])
    data = pil_img.tostring()

    ipl_img = cvCreateImageHeader(width, height, depth, channels);
    cvSetData(ipl_img, create_string_buffer(data,len(data)), c_int(width.value * channels.value))
    brg_img = cvCvtColor(ipl_img,cv.CV_RGB2BGR)
    cvReleaseImageHeader(byref(ipl_img))
    return brg_img 
```

希望它会帮助某人:)

# java - GroupLayout：TextArea 中的 JScrollPane 不起作用

> ID：11284587
> 
> 赞同：0
> 
> 时间：2012-07-01T18:27:16.317
> 
> 标签：java, swing, jscrollpane, jtextarea, layout-manager

我是java新手，最近开始开发一个简单的应用程序。目前我对 JScrollPanne 有疑问，当 textarea 中的文本超过区域大小时，它无法向下（或向上）滚动。我已经查看了一些解决方案，但它们都适用于 FlowLayot（GridLayout 和 BoxLayout），而不适用于 GroupLayout。这是代码：

```
JPanel conent_p = new JPanel();
    conent_p.setBorder(new TitledBorder(null, "", TitledBorder.LEADING, TitledBorder.TOP, null, null));

    JLabel lblItemName = new JLabel("Item name:");
    itemField = new JTextField();
    itemField.setColumns(10);

    JLabel lblMxPrice = new JLabel("Max price:");   
    mpriceField = new JTextField();
    mpriceField.setColumns(10);

    JLabel lblQuantity = new JLabel("Quantity:");
    quanField = new JTextField();
    quanField.setColumns(10);

    JLabel lblDelivery = new JLabel("Delivery:");
    delivField = new JTextField();
    delivField.setColumns(10);

    JLabel lblLogcat = new JLabel("LogCat:");
    final JTextArea txtConsole = new JTextArea();
    txtConsole.setEditable(false);
    txtConsole.setLineWrap(true);
    txtConsole.setWrapStyleWord(true);

    sbrText = new JScrollPane(txtConsole);
    sbrText.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);

    // Now create a new TextAreaOutputStream to write to our JTextArea control and wrap a
    // PrintStream around it to support the println/printf methods.
    PrintStream out = new PrintStream(new TextAreaOutputStream(txtConsole));
    // redirect standard output stream to the TextAreaOutputStream
    System.setOut(out);
    // redirect standard error stream to the TextAreaOutputStream
    System.setErr(out);

    GroupLayout gl_conent_p = new GroupLayout(conent_p);
    gl_conent_p.setHorizontalGroup(
        gl_conent_p.createParallelGroup(Alignment.LEADING)
            .addGroup(gl_conent_p.createSequentialGroup()
                .addContainerGap()
                .addGroup(gl_conent_p.createParallelGroup(Alignment.LEADING)
                    .addComponent(lblMxPrice, Alignment.TRAILING)
                    .addComponent(lblItemName, Alignment.TRAILING)
                    .addComponent(lblLogcat, Alignment.TRAILING))
                .addGap(18)
                .addGroup(gl_conent_p.createParallelGroup(Alignment.LEADING)
                    .addGroup(gl_conent_p.createSequentialGroup()
                        .addGroup(gl_conent_p.createParallelGroup(Alignment.LEADING, false)
                            .addComponent(itemField, GroupLayout.PREFERRED_SIZE, 365, GroupLayout.PREFERRED_SIZE)
                            .addGroup(gl_conent_p.createSequentialGroup()
                                .addComponent(mpriceField, GroupLayout.PREFERRED_SIZE, 80, GroupLayout.PREFERRED_SIZE)
                                .addGap(18)
                                .addComponent(lblQuantity)
                                .addPreferredGap(ComponentPlacement.RELATED)
                                .addComponent(quanField, 0, 0, Short.MAX_VALUE)
                                .addGap(18)
                                .addComponent(lblDelivery)
                                .addPreferredGap(ComponentPlacement.RELATED)
                                .addComponent(delivField, GroupLayout.PREFERRED_SIZE, 80, GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(ComponentPlacement.RELATED)))
                        .addGap(100))
                    .addGroup(gl_conent_p.createSequentialGroup()
                        .addComponent(txtConsole, GroupLayout.PREFERRED_SIZE, 345, GroupLayout.PREFERRED_SIZE)
                        .addComponent(sbrText)
                        .addContainerGap())))
    );
    gl_conent_p.setVerticalGroup(
        gl_conent_p.createParallelGroup(Alignment.LEADING)
            .addGroup(gl_conent_p.createSequentialGroup()
                .addContainerGap()
                .addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
                    .addComponent(lblItemName)
                    .addComponent(itemField, GroupLayout.PREFERRED_SIZE, 20, GroupLayout.PREFERRED_SIZE))
                .addGap(20)
                .addGroup(gl_conent_p.createParallelGroup(Alignment.LEADING)
                    .addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
                        .addComponent(lblDelivery)
                        .addComponent(delivField, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                    .addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
                        .addComponent(lblMxPrice)
                        .addComponent(mpriceField, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblQuantity)
                        .addComponent(quanField, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)))
                .addGap(55)
                .addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
                    .addComponent(lblLogcat)
                    .addComponent(txtConsole, GroupLayout.PREFERRED_SIZE, 200, GroupLayout.PREFERRED_SIZE)
                    .addComponent(sbrText))
                .addContainerGap())
    );
    conent_p.setLayout(gl_conent_p);

    getContentPane().add(conent_p, BorderLayout.NORTH);

    JButton btnBuy = new JButton("Buy");
    btnBuy.addActionListener( new ActionListener() {
        public void actionPerformed(ActionEvent ev) {
            try {
                String title = itemField.getText().trim();
                String mprice = mpriceField.getText().trim();
                String quantity = quanField.getText().trim();
                String deliver = delivField.getText().trim();

                Item_CONCEPT item = new Item_CONCEPT();

                item.setName(title);
                item.setDelivery(Integer.parseInt(deliver));
                item.setStartPrice(0);
                item.setMaxPrice(Integer.parseInt(mprice));

                myAgent.existsSeller(item);

                Date date = new Date();
                DateFormat df = new SimpleDateFormat("dd.MM.yy HH:mm");
                System.out.println(df.format(date)+": Buyer orders an item: "+item.getName());

                //Clearing all fields
                itemField.setText("");
                quanField.setText("");
                delivField.setText("");
                //txtConsole.setText("");
                mpriceField.setText("");
            }
            catch (Exception e) {
                JOptionPane.showMessageDialog(BuyerGUI.this, "A field is filled incorrectly. "+e.getMessage()+" is invalid.", "Error", JOptionPane.ERROR_MESSAGE); 
            }
        }
    } );![enter image description here][1] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:36:25.213

不确定这是否是问题（因为您没有提供 SSCCE，只是一段代码），但您都添加了`txtConsole`和`sbrText`：

```
.addComponent(txtConsole, GroupLayout.PREFERRED_SIZE, 200, GroupLayout.PREFERRED_SIZE)
.addComponent(sbrText) 
```

当您将文本区域放在滚动窗格中时，添加滚动窗格就足够了。

此外，我建议设置滚动窗格的首选大小，如[滚动窗格教程中所示](http://docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T18:39:25.210

您观察到的问题来自两个事实：

*   您正在将内容面板添加到`BorderLayout.NORTH`
*   您将文本控制台和滚动窗格添加为单独的组件

对于第一个：替换

```
getContentPane().add(conent_p, BorderLayout.NORTH); 
```

和

```
getContentPane().add(conent_p, BorderLayout.CENTER); 
```

第二个：不要`txtConsole`单独添加，即

横向组内替代

```
.addGroup(gl_conent_p.createSequentialGroup()
  .addComponent(txtConsole, GroupLayout.PREFERRED_SIZE, 345, GroupLayout.PREFERRED_SIZE)
  .addComponent(sbrText).addContainerGap()); 
```

和

```
.addComponent(sbrText); 
```

在垂直组内

```
.addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
  .addComponent(lblLogcat)
  .addComponent(txtConsole, GroupLayout.PREFERRED_SIZE, 200, GroupLayout.PREFERRED_SIZE)
  .addComponent(sbrText)).addContainerGap())); 
```

和

```
.addGroup(gl_conent_p.createParallelGroup(Alignment.BASELINE)
  .addComponent(lblLogcat)
  .addComponent(sbrText)).addContainerGap())); 
```

# android - 将新元素添加到 ListView 的顶部

> ID：11284591
> 
> 赞同：3
> 
> 时间：2012-07-01T18:27:56.377
> 
> 标签：android, listview

我正在编写一个 IM 客户端，我需要下载（从文件系统或网络）并在 ListView 的顶部显示新元素（它是消息的历史——旧消息在顶部，新消息在底部）。我为 ListView 实现了自己的适配器，但我无法在列表的开头添加新元素并重绘它。（notifyDataSetChanged() 对我不好，因为 ListView 中的消息索引发生了变化，android 无法正常重绘它）。

其他应用程序如何做类似的事情？

我没有为它创建特殊代码，我只是为我的 ListView 创建新的适配器：

```
messagesListView.setAdapter(new MessagesListAdapter(this)); 
```

并在 MessagesListAdapter 中重新定义 getView() 和 getCount() 方法（现在扩展 ArrayAdapter）。

我的 ListView 的 XML 是

```
<ListView
  android:id="@+id/dialog_messages_list"
  android:layout_height="fill_parent"
  android:layout_width="fill_parent"
  android:layout_marginTop="@dimen/title_height">
</ListView> 
```

我的一个元素（一条消息）的 XML 是

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal" >

  <TextView
      android:id="@+id/dialogMessageText"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text=""
      android:background="@drawable/dialog_message_in"
      />

  <TextView
    android:id="@+id/dialogMessageDatetime"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text=""/>

</LinearLayout> 
```

可能你需要其他代码吗？

编辑：我试过

```
 messagesListView.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, arrayList));
    (new Thread() {
        public void run() {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            arrayList.add(0, "qwer");
        }
    }).start(); 
```

但这似乎也不太好。我试图调用`((ArrayAdapter<String>)messagesListView.getAdapter()).notifyDataSetChanged();`线程，但它产生了异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T20:30:14.243

我建议颠倒列表的顺序以首先显示最新结果。

运行此示例：

```
public class Example extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String[] array = {"oldest", "older", "old", "new", "newer"};
        List<String> list = new ArrayList<String>();
        Collections.addAll(list, array);
        Collections.reverse(list);

        // When you want to add new Strings, put them at the beginning of list
        list.add(0, "newest");

        ListView listView = (ListView) findViewById(R.id.list);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, list);
        listView.setAdapter(adapter);
    }
} 
```

您不必以这种方式覆盖 ArrayAdapter 或 ListView 中的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:34:52.770

您可以以编程方式在与列表视图关联的类中添加一些视图。例如：

将内容添加到布局并创建新元素：

```
TextView tv = new TextView(getApplicationContext());
EditText edit = new EditText(getApplicationContext());
relative.addView(tv);
relative.addView(edit); 
```

这是为了操作 xml 布局中的现有元素：

```
final TextView tv = (TextView) v.findViewById(R.id.listItem);
    tv.setText("This an item I am changing"); 
```

如果您查看一些相关问题，他们将为您提供更多信息。但您也可以在线查看其他人的自定义列表视图和适配器。这个真的很好：[http ://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

# emacs - 如何使 emacs 生成的后记文本变暗

> ID：11284592
> 
> 赞同：1
> 
> 时间：2012-07-01T18:28:00.823
> 
> 标签：emacs, postscript

我正在使用 emacs 命令 ps-spool-buffer-with-faces 命令来制作一些我正在处理的代码的后记文件。问题是字体颜色似乎是浅灰色而不是黑色。我已经浏览了 postscript 文件并在 Google 上搜索了一下，但没有找到任何解决方案。有谁知道如何将我的灰色字体变成黑色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T06:00:27.323

假设您只想以黑白打印，请尝试：

```
(setq ps-print-color-p nil) 
```

否则，您可能会查看 ps-print-color-p 的其他值：

> ```
> ps-print-color-p is a variable defined in `ps-print.el'.
> Its value is t
> 
> Documentation:
> Specify how buffer's text color is printed.
> 
> Valid values are:
> 
>    nil        Do not print colors.
> 
>    t      Print colors.
> 
>    black-white    Print colors on black/white printer.
>       See also `ps-black-white-faces'.
> 
> Any other value is treated as t.
> 
> You can customize this variable. 
> ```

您可以使用`M-x`**自定义变量**`RET`**ps-print-color-p进行自定义**`RET`

# php - 评分公式设计（概念而非编码）

> ID：11284595
> 
> 赞同：3
> 
> 时间：2012-07-01T18:28:40.123
> 
> 标签：php, sql, math, rating, logarithm

我的网站的一个元素是评级系统。我对如何最好地设置公式感到有些困惑，我希望有更多数学能力的人可以帮助我。

用户上传被其他用户评分为 1-10 的图片。用户评分是这些分数的平均值。

很简单。但是，我想添加一些系统来奖励用户上传更多图片。因此，该公式将是收视率的平均值 + 上传图片数量的某些函数。

例如，Rating = AVG + .05 * Count

这个公式对于上传 1-20 张图片的用户来说是公平的……但是，如果用户上传 2000 张图片，他们将通过整个评分系统并自动获得 10/10。

因此，我对后代数数学的有限知识正在失败。什么是会产生预期效果的公式？“日志”这个词一直在我的脑海里蹦蹦跳跳——但老实说，我不记得为什么...... :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:32:56.733

只需执行以下操作：

avg + numofpics*scale*(.9^numofpics)

这将使它做到这一点，因为他们上传更多的照片，他们得到的越来越少。您可以根据您希望普通用户上传多少张图片来更改 0.09（衰减率）。

这是用于半衰期衰减的方程

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T18:34:20.883

您可以执行以下操作：

```
Rating = Average + (\sum_{i=1}^numofuploads 1/i)*scalefactor 
```

尽管总和增长到无穷大 - 总和增长非常缓慢

## 编辑：

这个想法与@maxhud 的解决方案基本相同，您为每张图片的评分添加较少的分数，为简单起见，缩放比例为 1/3，现在我使用精确而不是浮点数学

```
1 -> avg + (1/1)*.3 = avg + 1/3
2 -> avg + (1/1+1/2)/3 = avg + (3/2)/3) = avg + 1/2
3 -> avg + (3/2+1/3)/3 = avg + (10/6)/3 = avg + 10/18 = avg + 5/9 ~ avg + .55555
4 -> ... 
```

从技术上讲，系列（1+1/2+1/3+…）将无限大，但你必须上传大量图片才能超过 50 - 所以你最好仔细选择你的比例因子并给出一个一点，思想。如果您想通过上传获得最多积分，这是错误的*解决*方案。你应该选择类似的东西

```
avg + scaling*(.9^n) 
```

`n`图片的数量在哪里。如果您可以上传无限多的图片，您将拥有

```
avg + scaling*(1/(1-.9)) = avg + 10*scaling 
```

对于您的评价：正如我评论的那样，这要好得多。

ps：我认为@maxhud 应该离开

```
avg + numofpics*scale*(.9^numofpics)
      ^^^^^^^^^ 
```

因为上传10张图片后，你已经超过了你的收缩增长功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T20:22:49.227

考虑一种替代方法 - 您希望通过增加上传图像来奖励用户，但也许用户正在上传许多评价不高的图像。如果他们的大多数图像都很差，你想奖励他们吗？以 stackoverflow 为例 - 您可以回答很多问题，但如果社区其他人认为它们不是“好”的，那么无论您提供多少答案，您的声誉都不会增加。

这可能不是您想要的方式，并且想要奖励数量而不是质量，但是如果您决定相反，您可以尝试类似

```
 UserRating = 10 * (AverageRating/10 + Scalefactor*((AverageRating/10)^2 * ImageUploadCount))) 
```

您选择比例因子作为您想要的，并且显然将评级限制为最大 10。这样，您奖励多个图像上传，但您也奖励具有更高质量图像上传的用户。考虑有人使用某种类型的网络机器人自动上传图像，并且所有图像都被用户认为很差 - 你想奖励它吗？通过这种方式，您可以奖励多次上传，但质量更好的上传会受到更优待。也许不是您想要的，但也许值得考虑 - 只有您可以决定....

# ruby-on-rails - 如何在 Rails 中添加用户可以删除自己的功能？

> ID：11284597
> 
> 赞同：0
> 
> 时间：2012-07-01T18:28:52.993
> 
> 标签：ruby-on-rails

我在 Rails 的用户控制器中有以下代码，让用户删除自己：

```
def delete_account
User.find(params[:id]).destroy
flash[:success] = "Your account has been deleted."
redirect_to root_path
end 
```

现在，我不确定如何将正确的路由添加到我的 route.rb 文件，然后将按钮正确添加到我的用户设置视图中。对于我的路由文件，我有以下代码：

```
match '/delete_account' to: 'users#delete_account' 
```

在我的设置视图文件中，我有以下代码为视图中的 delete_account 操作添加一个按钮：

```
<%= link_to class: "btn btn-danger", delete_account_path %>\ 
```

在我看来，您可以在实施正确的路线和嵌入式红宝石方面提供任何帮助，我们将不胜感激。抱歉，如果这是一个容易修复的错误；我是一名初学者，这给我带来了一些麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:44:15.457

我认为最好使用 RESTful 方式。

将您的方法重命名为`destroy`in 控制器。

在您的 routes.rb 中，

`resources :users`或者`match '/delete_account', to: 'users#destroy'`

在视图中，比如在 show.html.erb 中，

`<%= link_to 'Delete', @user, confirm: 'Are you sure?', method: :delete %>`

很明显，您的`show`操作应该找到合适的用户，

`@user = User.find(params[:id])`

# actionscript-3 - 如何使用 Facebook Graph API Flash AS3 从用户那里获得两个或更多权限

> ID：11284599
> 
> 赞同：1
> 
> 时间：2012-07-01T18:29:13.507
> 
> 标签：actionscript-3, flash, api, graph

我想从用户（`publish_stream`，`user_photos`）那里获得 2 个权限。

当我尝试这个

```
Facebook.login(handleLogin, {scope:’publish_stream’});
Facebook.login(handleLogin, {scope:’user_photos’}); 
```

然后它起作用了，但它显示了两次facebook登录弹出窗口:(
请帮助我，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T23:52:43.800

假设： [http ://code.google.com/p/facebook-actionscript-api/source/browse/trunk/source/api/com/facebook/graph/Facebook.as](http://code.google.com/p/facebook-actionscript-api/source/browse/trunk/source/api/com/facebook/graph/Facebook.as)

```
Facebook.login(handleLogin, {scope:'publish_stream,user_photos'}); 
```

[http://developers.facebook.com/docs/reference/javascript/FB.login/](http://developers.facebook.com/docs/reference/javascript/FB.login/)

# python - 测试 django 类中是否存在字段

> ID：11284600
> 
> 赞同：0
> 
> 时间：2012-07-01T18:29:13.890
> 
> 标签：python, django

给定一个 django 类和一个字段名，您如何测试该类是否具有给定名称的字段？

在这种情况下，字段名称是一个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:35:20.757

例如：

`field_name_exists = field_name in ModelName._meta.get_all_field_names()`

# azure - 在 Windows Azure VM (Windows) 上设置 Redis 并使其可访问同一云服务下的外部 VM

> ID：11284605
> 
> 赞同：1
> 
> 时间：2012-07-01T18:29:28.950
> 
> 标签：azure, redis, windows-server-2008-r2, azure-virtual-machine

这是我的场景：

我在 Windows Azure 上拥有三个 Windows VM（目前处于预览阶段），所有 VM 都相互连接，换句话说，它们位于同一个云服务下。我现在需要做的是，我将仅将一个 VM 用于 Redis，而另外两个 VM 需要与之对话。我不想向全世界开放 redis 有几个原因，其中之一是我不想通过负载均衡器与它交谈。我希望我的虚拟机直接与它交谈（如此处所述：[在相互通信服务器时绕过负载平衡器](http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforWindows/thread/9a1afea2-774c-464c-be8b-986abcba9def)）。

我考虑使用[Redis 的 MSOpenTech 实现](https://github.com/MSOpenTech/redis)。我知道如何配置这样的结构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T20:38:24.370

我通过尝试发现了这一点。这是解决方案：

[在 Windows Azure 虚拟机上运行 Redis 的 SignalR](http://www.tugberkugurlu.com/archive/singalr-with-redis-running-on-a-windows-azure-virtual-machine)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T18:54:38.633

在 Windows Azure 虚拟机（Windows 或 Linux）上运行 Redis 与任何其他机器完全相同，所以我认为您不会在那里遇到任何问题。

如果您有一个虚拟机实例，它不是通过负载均衡器配置的，您可以看到何时将端点添加到您的虚拟机。只有当您有超过 1 个虚拟机实例，然后添加端点时，您才有机会为该特定端点配置负载均衡器。在您的情况下，当您想在单个 VM 上运行 Redis 时，您实际上并不落后于负载均衡器。

如果您想让所有 3 台机器相互通信，您可以创建一个虚拟网络并使用此 VNET 配置所有 3 台机器，以便它们可以按照您想要的方式相互通信。

# java - 在Java中，从内部（类）对象访问“外部对象”？

> ID：11284608
> 
> 赞同：1
> 
> 时间：2012-07-01T18:29:56.307
> 
> 标签：java, reflection

当然有这种方式：`OuterClass.this`. 但这非常笨拙。理想情况下，会有一个关键字`outer`，就像`super`.

有什么方法可以反思吗？（我还没有找到任何方法，隐藏的`outer`引用似乎没有出现在结果中`Class#getFields()`。）

也许Java7中有一种方法？

编辑。考虑一下我刚刚发现的类似问题：

[是否有语法可以从另一个匿名内部类获取对匿名内部类的引用？](https://stackoverflow.com/questions/2930327/is-there-a-syntax-to-get-the-reference-to-an-anonymous-inner-class-from-a-furthe?rq=1)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-01T18:33:46.197

唯一的方法是使用`OuterClass.this`来引用包含的类。

这不是问题，如果您需要多次引用包含的类实例，您只需将其分配给局部变量，您不必多次处理此语法。`final OuterClass oc = OuterClass.this;`然后你只需`oc`在本地使用来做你需要做的任何事情。

使用另一个关键字 like`outer`只会混淆正在发生的事情。语法`OuterClass.this` **明确**定义了正在发生的事情，通用关键字将隐藏包含类的身份，特别是如果它嵌套在多个内部类中。`outer.this.outer.this.outer.this`太可怕了！

这不是任何想象力的负担。尤其是现代 IDE。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-08-22T20:43:24.837

## 请尝试此代码，它完全符合您的要求：

```
 Object innerClassInstance = null; //get an inner class instance from somewhere.

                Object outerClassInstance = null;
                Field[] fields = innerClassInstance.getClass().getDeclaredFields();
                for (Field field : fields) {
                    field.setAccessible(true);
                    String name = field.getName();
                    Object value = field.get(innerClassInstance);
                    if ("this$0".equals(name) && value != null) {
                        outerClassInstance = value;
                        break;
                    }
                }
                if (outerClassInstance != null) {
                    // now do something with your outer class instance
                } 
```

* * *

# javascript - Disqus 是否有要附加的公共事件？

> ID：11284609
> 
> 赞同：7
> 
> 时间：2012-07-01T18:30:00.277
> 
> 标签：javascript, events, disqus, mutation-events

在 disqus 表单获得更新后，我需要执行一些重新计算。一个新的评论，错误信息仅举几例。本质上，任何导致 Disqus iframe 垂直扩展的事件。检查了 API，但没有找到任何公共事件。似乎这些事件不是公开可访问的 atm。所以第一个问题是——Disqus 是否有任何公共活动可以附加？

第二个是——如果我无法附加到来自 Disqus 的事件，考虑到 Disqus 的东西在 iFrame 中，我想知道 MutationEvent 会为我解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T11:59:08.470

到目前为止我想出的最好的

```
function disqus_config() {
    this.callbacks.onNewComment = [function() { trackComment(); }];
} 
```

从这里： [http ://help.disqus.com/customer/portal/articles/466258-how-can-i-capture-disqus-commenting-activity-in-my-own-analytics-tool-](http://help.disqus.com/customer/portal/articles/466258-how-can-i-capture-disqus-commenting-activity-in-my-own-analytics-tool-)

在 chrome 控制台中执行 a`console.log(DISQUS)`会显示 disqus 对象，并且还提到了其他回调

```
_callbacks: Object
  switches.changed: Array[2]
  window.click: Array[2]
  window.hashchange: Array[2]
  window.resize: Array[2]
  window.scroll: Array[2] 
```

和`on`和`trigger`方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T18:23:28.420

我不确定 Disqus 的公共事件，但如果您只需要监视 iframe 高度的变化，这里有一种方法：

```
var iframe = document.getElementById('myIframe');
var iframeHeight = iframe.clientHeight;

setInterval(function() {
    if(iframe.clientHeight != iframeHeight) {
        // My iframe's height has changed - do some stuff!

        iframeHeight = iframe.clientHeight;
    }
}, 1000); 
```

当然，这基本上是一个黑客。但它应该工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-07T13:54:26.023

好吧，他们没有记录任何公共事件（据我所知）。但是，应用程序在其父窗口上触发了很多事件。因此，可以倾听他们的意见并采取一些行动。您可以使用以下代码段执行此操作：

```
window.addEventListener('message', function (event) {
    // if message is not from discus frame, leap out
    if (event.origin != 'https://disqus.com' && event.origin != 'http://disqus.com') return;

    // parse data
    var data = JSON.parse(event.data);

    // do stuff with data. type of action can be detected with data.name 
    // property ('ready', 'resize', 'fakeScroll', etc) 
}, false); 
```

在基于 webkit 的浏览器中它工作得很好。使用 Firefox 可能会有一些问题。使用 IE ......好吧，我手头没有任何 IE 来测试它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-12T20:32:43.800

[您可以在embed payload](https://discussdisqus.disqus.com/embed.js)中找到可用事件列表：

```
callbacks:{
    preData:[],
    preInit:[],
    onInit:[],
    afterRender:[],
    onReady:[],
    onNewComment:[],
    preReset:[],
    onPaginate:[],
    onIdentify:[],
    beforeComment:[]
} 
```

我没有找到任何文档（除了[的示例`onNewComment`](https://help.disqus.com/en/articles/1717088-capture-disqus-commenting-activity-via-callbacks)），因此您需要根据事件名称猜测它们是如何工作的。

您可以通过以下方式使用它们：

```
var disqus_config = function () {
    this.callbacks.onNewComment = [
        function() { 
            // your code
        }
    ];
}; 
```

或者

```
var disqus_config = function () {
    this.callbacks.onNewComment = this.callbacks.onNewComment || [];
    this.callbacks.onNewComment.push(function() { 
        // your code
    });
} 
```

* * *

在旁注中，我发现它们对于检测 iframe 评论高度的变化完全没用。我以使用`ResizeSensor`from结束[`css-element-queries`](https://github.com/marcj/css-element-queries)。

# javascript - 使用 Javascript 添加 CSS

> ID：11284613
> 
> 赞同：0
> 
> 时间：2012-07-01T18:30:20.277
> 
> 标签：javascript

我想添加一个外部 css 表，我使用这个 JS 代码：

```
 var link = document.URL;  

  if (link.indexOf('http://194.71.107.82/') != -1) 
  {

  document.write("<style>body { background-color:#000 }</style>");

  }
  else
  {
  window.location.replace('http://194.71.107.82/')
  } 
```

但是有一个问题：当他用 document.write 重写代码时，它开始重新加载，所以脚本再次启动并再次写入，所以它再次开始导航......它进入了一个循环......

那么我该怎么做才能不让它陷入循环呢？

**编辑**所以...现在我用

```
document.getElementById("fp").style.display = "none"; 
```

但是什么都没发生？Div 保持可见？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T18:33:28.763

而不是`document.write`使用`.style`.

例子：

```
document.getElementById("your-element").style.backgroundColor = "#fff"; 
```

[单击此处](http://www.comptechdoc.org/independent/web/cgi/javamanual/javastyle.html)查看您可以使用的属性。

如需更多功能，请使用 jQuery 的[.css()](http://api.jquery.com/css/)函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:38:55.573

如果您真的想通过 IP 地址进行测试，请在发送页面之前在服务器上进行

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-01T18:33:30.367

使用对 window.location 的哈希更改而不是完整的 URL 重写或使用 History API “推送” URL 更改

# macos - Mac LaunchAgent PLIST 未启动

> ID：11284614
> 
> 赞同：1
> 
> 时间：2012-07-01T18:30:28.407
> 
> 标签：macos, plist, launch-agent

我正在尝试开发一个 Mac LaunchAgent 并对此进行测试，它应该启动控制台：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
"http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>KeepAlive</key>
<true/>
<key>Label</key>
<string>com.depthmine.test</string>
<key>ProgramArguments</key>
<array>
    <string>/Applications/Utilities/Console.app/Contents/MacOS/Console</string>
</array>
</dict>
</plist> 
```

该文件似乎已加载（终端中没有错误），但控制台未启动，并且终端中似乎也没有进程。我还尝试了一个 PHP 脚本，但也没有启动。

# c++ - 我应该使用什么条件来停止文件读取循环？

> ID：11284615
> 
> 赞同：2
> 
> 时间：2012-07-01T18:30:49.807
> 
> 标签：c++, file-io, fstream

以下导致错误，因为`file.eof()`显然`true`直到文件末尾读取才返回。我应该怎么做？

```
std::ifstream file("something.stuff", std::ios::in|std::ios::binary);

while(!file.eof())
{
    double x, y, z;
    file.read(reinterpret_cast<char*>(&x), sizeof(x));  //  Do I need to check if(file) after every read?
    file.read(reinterpret_cast<char*>(&y), sizeof(y));
    file.read(reinterpret_cast<char*>(&z), sizeof(z));

    // Do something with xyz
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-01T18:37:19.143

您可以在所有读取后检查它，除非您打算对部分数据执行某些操作，因此：

```
while(true)
{
    double x, y, z;
    file.read(reinterpret_cast<char*>(&x), sizeof(x));
    file.read(reinterpret_cast<char*>(&y), sizeof(y));
    file.read(reinterpret_cast<char*>(&z), sizeof(z));

    if (!file)
        break;

    // Do something with xyz
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:34:00.427

`std::ifstream::read``eof`一旦你读到文件末尾，就应该设置标志。

所以，是的，你应该`file.eof()`在每次调用`file.read()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:35:33.923

或者，使用 seek 和 tell 预先找到文件的长度，然后计算应该执行多少次迭代。这样您就不必在每次读取后继续检查 eof 位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T18:39:11.977

是的，每次读取都可能到达流的末尾，因此您应该在继续之前检查每个读取是否成功

```
std::ifstream file("something.stuff", std::ios::in|std::ios::binary); 

while(!file.eof()) 
{ 
    double x, y, z; 
    if (!file.read(reinterpret_cast<char*>(&x), sizeof(x)) ||
        !file.read(reinterpret_cast<char*>(&y), sizeof(y)) ||
        !file.read(reinterpret_cast<char*>(&z), sizeof(z)))
    {
        // failure... perhaps check file.eof() and/or file.fail() for precise condition
        break;
    }
    else 
    {
        // Do something with xyz 
    }
} 
```

# android - 从 SurfaceView 转移到 GLSurfaceView？

> ID：11284620
> 
> 赞同：2
> 
> 时间：2012-07-01T18:31:49.137
> 
> 标签：android, surfaceview, glsurfaceview

我目前正在开发一款仅使用 2D 图形的游戏。

在游戏中，我广泛使用 android`SurfaceView`来显示我的图形。我听说它`GLSurfaceView`使用硬件加速图形，我可以使用它而不是当前的`SurfaceView`.

目前，我有一个类扩展`SurfaceView`，它更新和呈现游戏状态，当方法`update()`和`render()`由我自己的线程类调用时扩展`Thread`。线程基本上可以帮助我保持几乎恒定的 FPS。

现在的问题：我如何从 更改`SurfaceView`为`GLSurfaceView`，并调用方法从线程更新和渲染游戏状态，以仍然控制 FPS。我阅读了关于 OpenGL ES 的 android 文档，但我不太明白如何使用`GLSurfaceView.Renderer`.

如果有人可以解释我如何轻松地从 切换`SurfaceView`到`GLSurfaceView`，那将有很大帮助！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T03:26:16.510

显示您的游戏的类将扩展`GLSurfaceView`。您的渲染类将实现`Renderer`. 在您的`Renderer`课程中，您将需要添加这些未实现的方法： `onDrawFrame()`、`onSurfaceChanged()`、`and onSurfaceCreated()`。

希望这可以帮助。

# scala - 创建对象后是否可以获取类型字段的类型？

> ID：11284621
> 
> 赞同：0
> 
> 时间：2012-07-01T18:31:49.947
> 
> 标签：scala, types

创建对象后是否可以获取类型字段的类型？

我想做这样的事情：

```
scala> class A { type T = String }
defined class A

scala> val a = new A
a: A = A@591171

scala> a.T   
<console>:13: error: value T is not a member of A
           a.T
             ^ 
```

最后

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T19:22:47.350

你想对类型做什么？您可以通过类的类型（没有实例）以各种方式使用类型投影：

```
scala> class A { type T = String }
defined class A

scala> val x: A#T = "test"
x: java.lang.String = test

scala> def f(b: A#T) = b
f: (a: java.lang.String)java.lang.String 
```

或者，如果您启用`-Ydependent-method-types`，您可以从实例中获取类型成员：

```
scala> val a = new A
a: A = A@6a3de2df

scala> val x: a.T = "test"
x: a.T = test

scala> def f(b: a.T) = b
f: (b: a.T)a.T 
```

Scala 在 2.10 之前的反射 API 并没有真正以任何干净的方式对类型进行建模，所以如果你想从其他意义上“获取类型”，你可能不走运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T19:11:39.507

一种方法是反射（从 2.10M4 开始）：

```
// with static types
scala> class A { type T = String }
defined class A

scala> import reflect.runtime.{universe => u}
import reflect.runtime.{universe=>u}

scala> val t = u.typeOf[A]
t: reflect.runtime.universe.Type = A

scala> val types = t.declarations.filter(_.isType)
types: Iterable[reflect.runtime.universe.Symbol] = SynchronizedOps(type T)

scala> types.toList.head.typeSignature
res9: reflect.runtime.universe.Type = String

// with instances
scala> val a = new A
a: A = A@68d7c870

scala> import reflect.runtime.{currentMirror => m}
import reflect.runtime.{currentMirror=>m}

scala> m.reflect(a).symbol.asType // same type as t
res20: reflect.runtime.universe.Type = A 
```

# php - 使用 InstantPaymentOnly 安全处理 DoExpressCheckoutPayment 响应

> ID：11284623
> 
> 赞同：2
> 
> 时间：2012-07-01T18:32:03.083
> 
> 标签：php, paypal

我正在考虑在我的 Web 应用程序中实现 Paypal 的 ExpressCheckout API，因为我需要一个支付系统来立即告诉我交易是否成功，以便应用程序保留数量极其有限的物品。

我想我对系统的工作原理有基本的了解（我在沙盒中搞砸了），但我想确保我对 DoExpressCheckoutPayment 工作原理的理解是正确的。

（开始我的理解）

如果我在 SetExpressCheckout 和 DoExpressCheckout 中为 PAYMENTREQUEST_0_ALLOWEDPAYMENTMETHOD 指定 InstantPaymentOnly，我只需检查响应的 ACK 代码是否包含“成功”/“成功与警告”和 PAYMENTINFO_0_PAYMENTSTATUS 是否包含“已完成”，以确保资金已转移。此外，如果 ACK 代码失败或 PAYMENTINFO_0_PAYMENTSTATUS 不是“已完成”，我的应用程序可以安全地释放这些项目，因为交易的付款永远不会到来。

（结束我的理解）

我的理解是否正确，或者这些假设是否会导致我没有收到我已预订的物品的付款或释放我最终会收到付款的物品？

提前致谢。

# c - 在C中按不同索引对数组进行排序

> ID：11284624
> 
> 赞同：6
> 
> 时间：2012-07-01T18:32:07.823
> 
> 标签：c

假设我有一组数据点，它们表示为双精度数组的数组，所以

```
double **data; 
```

现在，如果我想按每个数据点中的某个字段对数据进行排序，比如^(第二)个字段，我会编写一个比较器，它会执行以下操作：

```
int compare_data_second_field(void *a, void *b) {
    double da = ((double *) a)[1];
    double db = ((double *) b)[1];
    if (da < db) return -1;
    else if (da > db) return 1;
    return 0;
} 
```

然后使用`qsort`按^(第二)个字段对它们进行排序。

我的问题是，如果我事先不知道要按哪个字段进行排序，我该如何概括这一点？就像我有时可能想按第 1 个字段和第 5 个字段排序^，等等^。我也希望它是线程安全的，所以我不想使用全局变量来跟踪要排序的字段因为其中多个可能同时进行。

在 C++ 中，我将只使用自定义排序类并在类中有一个实例变量来跟踪要排序的字段。我不知道如何在 C 中做这样的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T18:45:18.593

[`qsort_r`](http://www.ipnom.com/FreeBSD-Man-Pages/qsort_r.3.html)如果它在您的平台上可用，最好的方法是使用它。[`qsort_r`](http://www.ipnom.com/FreeBSD-Man-Pages/qsort_r.3.html)接受传递给比较器的附加参数，因此您可以使用它来传递要对数据进行排序的字段。

如果这在您的平台上不可用，那么确实没有一种简单的方法可以做到这一点。您可以使用全局变量来解决它，将数据包装在包含排序字段信息的结构中，或者滚动您自己的`qsort_r`类似函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T20:43:35.280

实际上，使用*嵌套函数*（这是 GCC 扩展）有一个非常巧妙的解决方案。
您可以做的是制作一个通用比较器：

```
int my_comparator(const void* a, const void* b, int n)
{
    double da = ((double*)a)[n];
    double db = ((double*)b)[n];
    return (da > db) ? 1 : ((da < db) ? -1 : 0);  /* Awesome */
} 
```

和一个包装原始的自定义排序函数`qsort()`：

```
void my_qsort(void* base, size_t num, size_t size,
    int (*comparator)(const void *, const void *, int), int field)
{
    /* Internal comperator */
    int my_qsort_comperator(const void* a, const void* b)
    {
        return comparator(a, b, field);
    }

    /* Invoke the base qsort function */
    qsort(base, num, size, my_qsort_comperator);
} 
```

这个函数的行为和原来的一样`qsort()`，除了它需要一个额外的参数`field`，它表示要排序的字段的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T19:45:15.813

您可以为 N = 0,1,2... 声明一大堆`compare_data_field_N`函数，然后声明一个`compare_data`用相应函数初始化的函数指针数组。然后，`qsort`在特定字段上，从数组中提取函数指针以传递给 qsort。您可以使用宏来简化函数和数组的生成：

```
#define REP10(M) M(0) M(1) M(2) M(3) M(4) M(5) M(6) M(7) M(8) M(9)
#define DECLARE_COMPARE(N)                                         \
    int compare_data_field_##N(void *a, void *b) {                 \
        double da = ((double *) a)[N];                             \
        double db = ((double *) b)[N];                             \
        if (da < db) return -1;                                    \
        else if (da > db) return 1;                                \
        return 0;                                                  \
    }
#define REF_COMPARE(N) compare_data_field_##N,

REP10(DECLARE_COMPARE)
int (*compare_data_field[])(void *, void *) = { REP10(REF_COMPARE) }; 
```

如果您需要超过 10 个潜在字段，则只需修改 REP10 宏。

# wix - Wix：单个 MSI 而不是 msi + cab

> ID：11284625
> 
> 赞同：177
> 
> 时间：2012-07-01T18:32:08.570
> 
> 标签：wix, windows-installer

我的 Wix 项目创建 install.msi 和 cab1.cab。我怎样才能让它把所有东西都捆绑到 msi 中？我可能会使用 7-zip SFX 来解决这个问题，但我见过其他只有一个 msi 的应用程序。

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-07-01T19:58:21.823

您没有发布任何来源，但我认为您的 wxs 文件具有 Media 元素。只需将 EmbedCab 属性设置为“是”，`MediaTemplate`例如

```
<MediaTemplate EmbedCab="yes" /> 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2016-10-24T06:34:24.950

设置`EmbedCab="yes"`。

从 WIX 3.8 开始：

```
<MediaTemplate EmbedCab="yes" /> 
```

在 WIX 3.8 之前：

```
<Media Id="1" Cabinet="cab1.cab" EmbedCab="yes" /> 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-05-01T07:28:08.053

像这样使用它：

```
<Media Id="1" Cabinet="CabFileName.cab" EmbedCab="yes" /> 
```

[本文](http://www.symantec.com/connect/forums/embed-cab-file-msi)还介绍了其他方法。

# java - 在 JINI 中实现 TransactionManager

> ID：11284626
> 
> 赞同：0
> 
> 时间：2012-07-01T18:32:09.040
> 
> 标签：java, distributed-transactions, transactionmanager, jini

我正在使用 JINI 实现两相锁。我已经按照算法定义完成了它。在我的实现中，我有一些 ArrayLists 和 HashMap 来跟踪哪些参与者已经提交或中止了事务。

每次我执行加入/提交/中止操作时，我的 ArrayLists 和 HashMap 都是空的（没有以前的参与者），并且我的 TransactionManager 的 HashCode 总是不同的。我花了 2 天时间寻找问题，但仍然无法理解为什么会这样。

```
// here is the implementation of join method of my TransactionManager
private HashMap<Long, ArrayList<TransactionParticipant>> _transactions = new HashMap<Long, ArrayList<TransactionParticipant>>();
private ArrayList<TransactionParticipant> _participantTest = new ArrayList<TransactionParticipant>();

    @Override
    public synchronized void join(long trxId, TransactionParticipant tp, long crashCount) throws UnknownTransactionException, CannotJoinException, CrashCountException, RemoteException {
        // add new participant to list of participants that belong to current trxId
        List<TransactionParticipant> participants = _transactions.get(trxId);

        _participantTest.add(tp);
        participants.add(tp);

        System.out.println("Test hash code " + this.hashCode());

        System.out.println("Number of participants is " + participants.size() + "for Trxid " + trxId);
        System.out.println("Number of participants in other is " + _participantTest.size() + "for Trxid " + trxId);
    } 
```

以下代码用于“发布”我的 TransactionManager

```
String[] groups = { "group" };
        ServiceInfo serviceInfo = new ServiceInfo(
                "twoPhaseTrxManager",
                "a",
                "b",
                "1.0",
                "Join Manager",
                "c");

        Entry[] entries = new Entry[] { serviceInfo };

        LookupDiscoveryManager lookupDiscoveryManager = new LookupDiscoveryManager(groups, null, null);
      // "this" (first argument) refers to Current instance of transaction manager (object being published)
        new JoinManager(this, entries, (ServiceIDListener)null, lookupDiscoveryManager, new LeaseRenewalManager() ); 
```

任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T01:40:42.870

我能够通过改变这个来解决这个问题：

```
new JoinManager(this, entries, (ServiceIDListener)null, lookupDiscoveryManager, new LeaseRenewalManager() ); 
```

对此：

```
new JoinManager(RemoteObject.toStub(this), entries, (ServiceIDListener)null, lookupDiscoveryManager, new LeaseRenewalManager() ); 
```

# macos - 在 Mac OS 上将 Node.js 升级到最新版本

> ID：11284634
> 
> 赞同：884
> 
> 时间：2012-07-01T18:33:31.910
> 
> 标签：macos, node.js, upgrade

目前我在 Mac OS X 10.7.4 上使用 Node.js v0.6.16。现在我想将它升级到最新的 Node.js v0.8.1。但是从 nodejs.org 下载并安装最新的包文件后，当我在终端中键入“node -v”时，我发现系统仍在使用 v0.6.16 而不是 v0.8.1。有没有我错过的步骤？或者，我应该在安装最新版本之前彻底卸载旧版本吗？

顺便说一句，我知道 nvm 可以帮助管理 nodejs 包

[https://github.com/creationix/nvm/](https://github.com/creationix/nvm/)

有什么方法可以在不使用 Node.js 的情况下升级它？

我已经用谷歌搜索了这个问题，但在我看来，对于最新的 Node.js，这个问题没有非常明确的答案。

* * *

## 回答 #1

> 赞同：1678
> 
> 时间：2013-10-12T11:36:37.400

以下是我如何成功升级`v0.8.18`到`v0.10.20` **没有任何其他要求**（如 brew 等）（在终端中键入这些命令）：

1.  `sudo npm cache clean -f`（强制）清除你的 npm 缓存
2.  `sudo npm install -g n`安装[n](https://www.npmjs.com/package/n)（这可能需要一段时间）
3.  `sudo n stable`升级到当前稳定版本

*请注意，`sudo`可能会提示您输入密码。*

*关于第 3 步的附加说明：`stable`可以换成`latest`, `lts`（长期支持）或任何特定版本号，例如`0.10.20`.*

如果键入时没有显示版本号`node -v`，您可能需要重新启动。

这些说明也可以在这里找到：[davidwalsh.name/upgrade-nodejs](https://davidwalsh.name/upgrade-nodejs)
关于**n**包的更多信息在这里找到：[npmjs.com/package/n](https://www.npmjs.com/package/n)
关于 Node.js 发布时间表的更多信息：[github.com/nodejs/Release](https://github.com/nodejs/Release#release-schedule)

* * *

## 回答 #2

> 赞同：927
> 
> 时间：2012-07-02T17:24:14.720

如果您最初使用[Homebrew安装了](http://brew.sh)[Node.js](https://nodejs.org/en/)，请运行：

```
brew update
brew upgrade node
npm install -g npm 
```

或作为单行：

```
brew update && brew upgrade node && npm install -g npm 
```

* * *

更改版本的一种便捷方法是使用[nvm](https://github.com/creationix/nvm)：

```
brew install nvm 
```

使用 nvm 安装最新版本的 Node.js：

```
nvm install node 
```

* * *

*如果您通过软件包安装，请从[nodejs.org](https://docs.npmjs.com/getting-started/installing-node)下载最新版本。请参阅[安装 Node.js 和更新 npm](https://docs.npmjs.com/getting-started/installing-node)。*

* * *

## 回答 #3

> 赞同：197
> 
> 时间：2013-12-27T06:36:09.877

因为在搜索如何在 mac 上升级 nodejs 时，这似乎是谷歌的首要任务，我将为将来出现的任何人提供我的提示，尽管它已经很老了。

**通过 NPM 升级**
您可以使用上面@Mathias 描述的方法，也可以通过终端选择以下更简单的方法。

```
sudo npm cache clean -f
sudo npm install -g n
sudo n stable 
```

之后您可以选择确认升级

```
node -v 
```

您的 nodejs 应该已经升级到最新版本。如果您想升级到特定版本，请说 v0.8.19，而不是

```
sudo n stable 
```

采用

```
sudo n 0.8.19 
```

**编辑** 除非需要，否则避免使用 sudo。请参阅评论中史蒂夫的评论

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2012-09-07T07:28:04.983

转到[http://nodejs.org](http://nodejs.org)并下载并运行安装程序。它现在有效 - 至少对我来说。

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2013-03-08T21:55:48.380

您可以安装[nvm](https://github.com/creationix/nvm)并安装多个版本的Node.js。

```
curl https://raw.github.com/creationix/nvm/master/install.sh | sh
source ~/.nvm/nvm.sh 
```

然后运行：

```
nvm install 0.8.22  #(or whatever version of Node.js you want) 
```

你可以看到你安装了哪些版本：

```
nvm list 
```

您可以在版本之间进行更改：

```
nvm use 0.8.22 
```

使用 NVM 的好处在于您可以同时测试不同的版本。如果不同的应用程序需要不同版本的 Node.js，您可以同时运行它们。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2016-07-22T12:47:48.507

我为此使用 Node 版本管理器（称为 n）。

```
npm install -g n 
```

然后

```
n latest 
```

或者

```
n stable 
```

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2016-10-11T14:03:53.710

## 只需转到 node JS 网站并安装最新版本。

> 请安装最新版本而不是推荐的稳定版本。它将让您自由地在节点上使用最新的 ES6 功能。

可以在这里找到[Node JS](https://nodejs.org/en/)。

### 还要更新**npm**，您必须使用此命令。

`sudo npm i -g npm@latest`

> 您的所有项目都会正常工作。

**更新：2020 年**另一个不错的选择是`nvm`用于节点，然后可以支持多个版本。用于`nvm install --lts`始终能够更新到最新的节点版本使用`nvm ls-remote`命令来检查节点的新版本。

* * *

mac的其他选项::`brew update && brew install node && npm -g npm`

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2015-01-06T07:14:12.880

在 macOS 上，自制软件推荐的方法是运行

```
brew install node
npm install -g npm@latest 
```

![终端命令截图](../Images/81df37d92657d9d01b8d703680eba58f.png)

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2020-11-25T15:23:01.613

**在不安装任何包**的情况下升级 node 的版本，甚至不安装 nvm 本身：

```
sudo npx n stable 
```

* * *

**说明**：
这种方法类似于`Johan Dettmar`'s answer。唯一的区别是这里的包[n](https://www.npmjs.com/package/n)没有安装在本地机器上。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-05-30T10:03:40.083

我可以使用以下命令升级节点

```
nvm install node --reinstall-packages-from=node 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2018-06-01T02:47:40.040

可悲的是，`n`对我不起作用。我使用`node version manager or nvm`它，它就像一个魅力。这是有关如何安装的链接`nvm`：[https ://github.com/creationix/nvm#installation](https://github.com/creationix/nvm#installation)

*   `nvm i 8.11.2`升级到最新的 LTS
*   `nvm use 8.11.2`用它
*   `node -v`检查您的最新版本

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-04-19T08:37:29.930

转到网站[nodejs.org](https://nodejs.org)并下载最新的 pkg 然后安装。这个对我有用

我使用 brew 来升级我的节点。它已经安装但它位于`/usr/local/Cellar/node/5.5.0`并且有一个`/usr/local/bin/node`困扰我的默认节点。我不想做软链接，因为我真的不知道 brew 是如何组织的。所以我下载了`pkg`文件，安装了，我得到了这个信息：

`Node.js`安装在

```
/usr/local/bin/node 
```

`npm`安装在

```
/usr/local/bin/npm 
```

确保它`/usr/local/bin`在您的 $PATH 中。

现在升级完成

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-04-15T13:39:57.680

你可以运行，但你不能隐藏......最后你还是会使用[NVM](https://github.com/creationix/nvm)。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-04-04T05:06:50.780

你可以去 nodejs.org 下载最新的包。它将为您适当更新。NPM 也将更新。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-04-10T12:18:59.773

我认为使用最新版本的 Node.js 最简单的方法是在网站[https://nodejs.org/en/download/current/](https://nodejs.org/en/download/current/)中获取最新的 Node.js pkg 文件， 如果您想使用不同版本的 Node .js 你可以使用 nvm 或 n 来管理它。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2018-10-05T12:43:05.377

我试过的这两种方法都不起作用：

1.  使用 npm

`sudo npm cache clean -f`

`sudo npm install -g n`

`sudo n stable`

2.  从官方网站手动安装节点（[https://nodejs.org/en/](https://nodejs.org/en/)）

尝试后，`node -v`仍然显示旧版本的node。

* * *

以下方法对我有用：

第 1 步：安装 nvm（更多详情：[https](https://github.com/creationix/nvm#installation) ://github.com/creationix/nvm#installation ）

打开终端并输入以下命令：

`curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash`

关闭终端并重新打开它。

键入此命令以检查是否安装了 nvm：

`command -v nvm`

[![在此处输入图像描述](../Images/fe478f6443e6443deafa7f5001d9db6d.png)](https://i.stack.imgur.com/HRGjQ.png)

第 2 步：要下载、编译和安装最新版本的节点，请输入：

`nvm install node`（“node”是最新版本的别名）

检查节点是否获取最新版本（v10.11.0）。

[![在此处输入图像描述](../Images/cc53de66045971d4e57341cdd8a2e809.png)](https://i.stack.imgur.com/xmrUF.png)

安装最新的节点也会安装最新的 npm。

检查 npm 是否获取最新版本（6.4.1）。

[![在此处输入图像描述](../Images/fac31b96add0f1833eb8c1111eac3c2b.png)](https://i.stack.imgur.com/DiIQ9.png)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2017-11-30T13:15:06.537

```
sudo npm install -g n 
```

进而

```
sudo n latest for linux/mac users 
```

对于 Windows，请重新安装节点。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-05-23T11:31:27.003

Nvm Nvm 是一个基于脚本的节点版本管理器。如文档中所述，您可以使用 curl 和 bash 单线轻松安装它。它也可以在 Homebrew 上找到。

假设您已成功安装 nvm。以下将安装最新版本的节点。

```
 nvm install node --reinstall-packages-from=node 
```

最后一个选项将所有全局 npm 包安装到您的新版本。这样像 mocha 和 node-inspector 这样的包可以继续工作。

N N 是一个基于 npm 的节点版本管理器。您可以通过首先安装某个版本的节点然后运行来安装它`npm install -g n`。

假设您已成功安装 n。以下将安装最新版本的节点。

```
sudo n latest 
```

Homebrew Homebrew 是两个流行的 Mac 包管理器之一。假设您之前使用 brew install node 安装了节点。您可以通过以下方式获取最新的公式并升级到最新的 Node.js 版本。

```
1 brew update
2 brew upgrade node 
```

MacPorts MacPorts 是 Mac 的另一个包管理器。以下将更新本地端口树以访问更新的版本。然后它将安装最新版本的 Node.js。即使您安装了以前版本的软件包，这也有效。

```
1 sudo port selfupdate
2 sudo port install nodejs-devel 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-10-24T23:41:37.387

对于最新版本： `nvm install node`

具体版本： `nvm install 6.14.4`

[https://github.com/creationix/nvm](https://github.com/creationix/nvm)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-08-16T05:37:57.247

**简单和安全的步骤**

第 1 步：安装 NVM

```
brew install nvm 
```

第 2 步：为 NVM 创建目录

```
mkdir ~/.nvm/ 
```

第 3 步：配置环境变量

```
nano ~/.bash_profile 
```

粘贴以下代码

```
export NVM_DIR=~/.nvm
source $(brew --prefix nvm)/nvm.sh

source ~/.bash_profile 
```

第 4 步：仔细检查您的工作

```
nvm ls 
```

第 5 步：安装节点

```
nvm install 9.x.x 
```

第六步：升级

```
nvm ls-remote

   v10.16.2   (LTS: Dubnium)
   v10.16.3   (Latest LTS: Dubnium) .......... 
```

**nvm 安装 v10.16.3**

**故障排除**

```
Error Example #1
rm -rf /usr/local/lib/node_modules
brew uninstall node
brew install node --without-npm
echo prefix=~/.npm-packages >> ~/.npmrc
curl -L https://www.npmjs.com/install.sh | sh 
```

[https://www.chrisjmendez.com/2018/02/07/install/](https://www.chrisjmendez.com/2018/02/07/install/)

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2022-02-01T03:40:52.430

在 Mac 上更新 Node.js 有五种不同的方法（并且还在计数？）：

1.  通过从 nodejs.org 下载安装较新的二进制文件

2.  通过 Homebrew 更新 Node.js

    命令：`brew update && brew upgrade node`

3.  使用节点版本管理器 (NVM) 更新 Node.js

    命令：`nvm install {version} && nvm use {version}`

4.  使用 n 包管理器更新 Node.js

    命令：`sudo n latest`

5.  通过 MacPorts 更新 Node.js

    命令（同版本更新）：`sudo port selfupdate && sudo port upgrade {version}`

如果您仍在使用旧的 MacOS 版本，最好使用轻量级的专用包管理器，例如`n`或`nvm`. 您可以参考此[示例用例](https://tech.amikelive.com/node-1340/how-to-update-node-js-on-macos-hindsight-on-old-mac/)在旧 Mac (High Sierra) 上更新 Node.js。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-02-05T05:02:59.607

根据项目要求使用 nvm 升级节点..

通过 homebrew 安装 nvm.. brew update brew install nvm mkdir ~/.nvm nano ~/.bash_profile

在您的 .bash_profile 文件中（根据您的 shell，您可能正在使用其他文件），添加以下内容：

导出 NVM_DIR=~/.nvm 源 $(brew --prefix nvm)/nvm.sh

源 ~/.bash_profile echo $NVM_DIR

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-04-16T14:58:26.263

您可以直接使用 curl 将 node 升级到最新版本。运行以下命令：

```
curl "https://nodejs.org/dist/latest/node-${VERSION:-$(wget -qO- https://nodejs.org/dist/latest/ | sed -nE 's|.*>node-(.*)\.pkg</a>.*|\1|p')}.pkg" > "$HOME/Downloads/node-latest.pkg" && sudo installer -store -pkg "$HOME/Downloads/node-latest.pkg" -target "/" 
```

参考：[https ://nodejs.org/en/download/package-manager/#macos](https://nodejs.org/en/download/package-manager/#macos)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-11-07T13:44:20.547

我有同样的问题。这对我有用，因为我从 node.js 网站**全局下载并安装了 node.js。**

我所做的是尝试 NVM（节点版本管理器）。请在终端中按以下顺序执行命令

1.  curl -o- [https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh](https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh) | 重击

2.  命令 -v nvm

3.  nvm 安装节点

4.  node -v（确认更新）

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-12-19T14:54:15.160

这只是为那些没有使用*Homebrew*安装 Node 但在*Mac OS X*上尝试使用*npm*安装软件包时遇到错误的人添加一些信息。

 *我发现这篇[很好的文章](https://stackabuse.com/how-to-uninstall-node-js-from-mac-osx/)解释了如何以最初安装的方式完全删除*Node 。*

在*node*、*npm*和*n*从我的机器中完全删除之后，我刚刚使用[Node 网站上](https://nodejs.org/en/download/)的官方*.pckg 安装程序*重新安装了*Node.js*，一切都恢复了正常。

 *希望这可以帮助某人。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2022-01-13T06:51:33.783

首先`nvm`使用以下命令安装：

`curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash`

归功于@Saviah Kao

然后安装节点：

`nvm install node --reinstall-packages-from=node`

归功于[@Elad](https://stackoverflow.com/questions/34810526/how-to-properly-upgrade-node-using-nvm)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2022-01-25T09:54:36.790

很简单。

```
 sudo npm i -g n 
```

然后你可以指定你想要的版本。

```
sudo n 12.8.0 
```

干杯！！

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2018-06-15T05:32:45.167

只需一行代码，我就能在大约 20 秒内完成更新

```
sudo n latest 
```

其他命令对我不起作用，但这个有效。希望它可以帮助某人。**

# android - 如何在 Android 的 OpenGL ES 中的特定时间旋转对象？

> ID：11284635
> 
> 赞同：-1
> 
> 时间：2012-07-01T18:33:43.047
> 
> 标签：android, opengl-es

在 Android 的 OpenGL ES 中，我有一个我想用 gl.glRotate 旋转的对象。但我希望这种轮换在`n`几秒钟内发生，而不是立即发生。我该如何实施？我希望这在几秒钟内发生，`n`以便用户可以看到旋转。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:54:44.803

您的对象在视图上渲染的速度有多快。假设一次更新需要时间 t，那么您应该旋转对象的量将是 (t/n)*r，r 是您想要在 n 秒内旋转的总量。所以在总共 n 秒内，有效的旋转将是 r。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T19:36:25.807

使用 System.currentTimeMillis(); 让时间过去。

```
 int seconds=5;//rotate in 5 seconds
    long rotatestarted;
    void  StartRotate()
    {
          rotatestarted=System.currentTimeMillis();
    }
    void Render()
    {
          if(rotatestarted+seconds*1000<System.currentTimeMillis()){
                 DoRotate();
          }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T21:17:13.427

OpenGL 和 OpenGL ES 不提供此类功能。他们提供的只是现在绘制和转换事物的方法*，*而不考虑时间。

你需要的是一些系统，你自己的或一些框架/库/引擎来处理时间，以及与它相关的状态。

在这方面 SteveL 的回答是正确的，你必须自己处理。

# css - 在 div 中居中图像？

> ID：11284637
> 
> 赞同：7
> 
> 时间：2012-07-01T18:33:49.713
> 
> 标签：css, centering

我在这样的 div 中有一个图像

```
<div><img /><div> 
```

图像是动态的，没有固定大小。div 的大小`200px by 200px`。事先不知道图像大小。如果图像的大小大于`190px by 190px`，则将其设置为`190px by 190px`（即`max-width:190px`, `max-height:190px`）。如何在满足这些需求的情况下使图像居中？我也需要在 Internet Explorer 7 中工作的解决方案。

[这里](https://stackoverflow.com/questions/2237636/how-to-center-image-inside-div)和[这里](https://stackoverflow.com/questions/11238759/center-an-image-inside-a-div-horizontally-and-vertically)的解决方案不能应用于我的问题，因为

1.  不确定图像是否会小于 200 像素。

2.  我也想要水平对齐。

3.  不支持 Internet Explorer 7。

（在 Stack Overflow 上已经提出了一些同样的问题，但我的情况不同，所以它们不适用于这个特定问题。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T19:30:47.830

解决方案是将 更改`div`为表格。通常，您不应该使用表格进行定位，但是当涉及到较旧的不符合标准的浏览器时，有时这是唯一的选择。 [演示在这里](http://jsfiddle.net/nhqsQ/)。作为记录，这也适用于 Internet Explorer 6。

代码：

**CSS**

```
#theDiv
{
    width: 200px;
    height: 200px;
    text-align: center;
    vertical-align: middle;
}
#theImg
{
    max-width: 190px;
    max-height: 190px;
}​ 
```

**​HTML**

```
<table id="theDiv" style="border: solid 1px #000">
    <tr>
        <td>
    <img id="theImg" src="http://cdn1.sbnation.com/community_logos/9156/gangreen-small.jpg" />
        </td>
    </tr>
</table> 
```

这是一个使用 CSS 而不是将标记更改为实际表的[更新](http://jsfiddle.net/nhqsQ/11/)：

```
#theDiv
{
    display: table;
    width: 200px;
    height: 200px;
    text-align: center;
    vertical-align: middle;
}
#theImg
{
    max-width: 190px;
    max-height: 190px;
}

.tr {
  display: table-row;
}
.td { 
  display: table-cell;
  vertical-align: middle;
}

<div id="theDiv" style="border: solid 1px #000">
    <div class="tr">
        <div class="td">
    <img id="theImg" src="http://lorempixel.com/100/100/" />
        </div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T19:33:45.300

看到这个小提琴：http: [//jsfiddle.net/ANwmv/](http://jsfiddle.net/ANwmv/)

按照以下建议解决居中问题：[http ://www.brunildo.org/test/img_center.html](http://www.brunildo.org/test/img_center.html)

```
<style type="text/css">
.wraptocenter {
    display: table-cell;
    text-align: center;
    vertical-align: middle;
    width: 200px;
    height: 200px;
    border: 1px solid red;
}
.wraptocenter img { max-width: 190px; max-height: 190px; }
.wraptocenter * {
    vertical-align: middle;
}
/*\*//*/
.wraptocenter {
    display: block;
}
.wraptocenter span {
    display: inline-block;
    height: 100%;
    width: 1px;
}
/**/
</style>
<!--[if lt IE 8]><style>
.wraptocenter span {
    display: inline-block;
    height: 100%;
}
</style><![endif]--> 
```

HTML：

```
<div class="wraptocenter"><span></span><img src="http://lorempixel.com/100/100" alt="..."></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T23:17:17.093

给父级一个与其自身高度相等的*line-height和一个 center 的**text-align*属性。给图像一个中间的*垂直对齐*属性，使其在其行高内居中：

**HTML：**

```
 <html>
        <body>
            <div>
                <img src="http://www.waleoyediran.com/wp-content/uploads/2011/04/stackoverflow.png"/>                
            </div>
        </body>   
    </html> 
```

**CSS：**

```
div, img {
 border: 1px solid black;  
}

div {
  width: 200px;
  height: 200px;
  text-align: center;
  line-height: 200px;
}

img {
  max-width: 190px;
  max-height: 190px;
  vertical-align: middle;    
} 
```

[JS 小提琴示例](http://jsfiddle.net/WEpet/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-01T18:58:19.473

你可以这样做：

```
<div style="text-align:center;vertical-align:middle;"> 
    <img style="margin:0 auto" /> 
</div> 
```

# mysql - MySQL 数据库效率 - GROUP BY 与单独的表

> ID：11284638
> 
> 赞同：0
> 
> 时间：2012-07-01T18:33:52.513
> 
> 标签：mysql, performance

我正在尝试使用列出的项目显示用户的购物车。我要避免的是 - 在 db_cartitems 变成 10,000 个项目之后，查询结果需要很长时间才能显示结果的 2、3 或 10 年。

在组织数据库表结构时，我是否应该有一个表列出以前订购的所有产品，然后按购物车令牌进行分组（我创建了一个 rand() 编号以确保每个购物车构建的购物车项目都唯一地相互关联）。

或者，还有更好的方法？还是我太担心了？列出要搜索的 50,000 个订购商品的响应时间是否相当不错？

商家每天可能会收到 50 个或更少的订单，我担心不会提前计划增长。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:42:42.557

您要问的是您是否应该对数据进行*非规范化*以便更有效地查询。我建议阅读一些有关数据库规范化的主题，以了解有关此类决策的更多背景信息。

要回答您的问题，您应该（通常）始终从规范化的表开始，如果您开始遇到性能问题，请考虑非规范化。我不会担心 2、3 或 10 年后会发生什么，因为你*今天*可能有很多问题要担心。

从规范化模型转移到非规范化模型并不困难，此外，如果遇到问题（例如归档旧数据），您可能还有其他选择来提高性能。

# sticky-footer - 防止粘性页脚覆盖具有背景大小的 div：封面；应用了 CSS

> ID：11284640
> 
> 赞同：0
> 
> 时间：2012-07-01T18:34:13.287
> 
> 标签：sticky-footer, css

客户不希望粘性页脚覆盖他的图像，但希望背景图像幻灯片随浏览器缩放。

可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:45:57.297

你应该能够简单地替换

```
background-size: cover; 
```

和

```
background-size: contain; 
```

图像中似乎有足够的空白，以使页脚不会以任何方式使用`contain`. `cover`, 另一方面, 尽可能多地拉伸图像以覆盖整个 ,`div`反过来又被拉伸以覆盖整个页面。

# python - BeautifulSoup 的 Python 高内存使用率

> ID：11284643
> 
> 赞同：9
> 
> 时间：2012-07-01T18:34:46.820
> 
> 标签：python, memory, beautifulsoup

我试图在 python 2.7.3 中使用 BeautifulSoup4 处理几个网页，但每次解析后内存使用量都会上升。

此简化代码产生相同的行为：

```
from bs4 import BeautifulSoup

def parse():
    f = open("index.html", "r")
    page = BeautifulSoup(f.read(), "lxml")
    f.close()

while True:
    parse()
    raw_input() 
```

在调用 parse() 五次后，python 进程已经使用了 30 MB 的内存（使用的 HTML 文件大约 100 kB）并且每次调用都会增加 4 MB。有没有办法释放该内存或某种解决方法？

**更新：** 这种行为让我头疼。即使 BeautifulSoup 变量应该被长期删除，这段代码也很容易占用大量内存：

```
from bs4 import BeautifulSoup
import threading, httplib, gc

class pageThread(threading.Thread):
    def run(self):
        con = httplib.HTTPConnection("stackoverflow.com")
        con.request("GET", "/")
        res = con.getresponse()
        if res.status == 200:
            page = BeautifulSoup(res.read(), "lxml")
        con.close()

def load():
    t = list()
    for i in range(5):
        t.append(pageThread())
        t[i].start()
    for thread in t:
        thread.join()

while not raw_input("load? "):
    gc.collect()
    load() 
```

这可能是某种错误吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-16T02:34:47.683

尝试使用 Beautiful Soup 的[分解](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#decompose)功能，它会在您处理完每个文件后破坏树。

```
from bs4 import BeautifulSoup

def parse():
    f = open("index.html", "r")
    page = BeautifulSoup(f.read(), "lxml")
    # page extraction goes here
    page.decompose()
    f.close()

while True:
    parse()
    raw_input() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-01T15:32:00.333

我知道这是一个旧线程，但是在使用 beautifulsoup 解析页面时还有一件事要记住。导航树时，如果要存储特定值，请确保获取字符串而不是 bs4 对象。例如，这在循环中使用时会导致内存泄漏：

```
category_name = table_data.find('a').contents[0] 
```

可以通过更改为：

```
category_name = str(table_data.find('a').contents[0]) 
```

在第一个示例中，类别名称的类型是 bs4.element.NavigableString

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T20:05:27.533

尝试垃圾收集：

```
from bs4 import BeautifulSoup
import gc

def parse():
    f = open("index.html", "r")
    page = BeautifulSoup(f.read(), "lxml")
    page = None
    gc.collect()
    f.close()

while True:
    parse()
    raw_input() 
```

也可以看看：

[Python 垃圾回收](https://stackoverflow.com/questions/1035489/python-garbage-collection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T20:18:00.210

垃圾收集可能是可行的，但上下文管理器似乎对我来说处理得很好，没有任何额外的内存使用：

```
from bs4 import BeautifulSoup as soup
def parse():
  with open('testque.xml') as fh:
    page = soup(fh.read()) 
```

此外，虽然不是完全必要的，但如果您在`raw_input`测试时使用让它循环，我实际上发现这个成语非常有用：

```
while not raw_input():
  parse() 
```

每次您按 Enter 时它都会继续循环，但是一旦您输入任何非空字符串，它就会为您停止。

# asp.net - Asp.Net / SignalR：Ajax 部分视图

> ID：11284645
> 
> 赞同：1
> 
> 时间：2012-07-01T18:34:56.227
> 
> 标签：asp.net, ajax, asp.net-mvc-3, partial-views, signalr

我对 SignalR 进行了大量研究和测试，但我遇到了问题。

我正在创建一个 .Net MVC3 Web 应用程序。用户界面是这样的：

我不允许发布图片，因此您可以在此链接查看用户界面：

[http://deasign.free.fr/InterfaceVadis.jpeg](http://deasign.free.fr/InterfaceVadis.jpeg)

**目标是：**

*   User1 进入 Webapp，点击一个 Item，然后看到 Editing 局部视图。
*   User2进入WebApp，点击同样的Item。我想为他锁定视图。

目标：一次只有一个用户可以编辑一个项目。

当用户 1 通过单击上一个/下一个/单击列表离开编辑视图时，注销或只是关闭他的浏览器，用户 2 必须立即（通过 SignalR）接收通知，并且编辑页面不再锁定

我尝试了几件事，但没有实现。

1°) 我必须在哪一部分声明 SignalR Hub？在右局部视图或父页面上？我都尝试了，但无法让 Disconnect 功能按我的意愿工作:(

我希望我已经清楚了，对不起我的英语

如果您需要其他信息，请不要犹豫

谢谢大家 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T16:32:58.687

对于所有用户操作（例如上一个/下一个/单击等），您只需调用集线器上的一个函数即可解锁该项目：

JS：

```
$("#Next").click(function(e) {
  myHub.next();
}); 
```

CS：

```
public class MyHub : Hub {
  public void next() {
    var itemId = ClientManager.GetCurrentEditedItemForClient(Caller.id);
    ItemManager.UnlockItem(itemId);
  }

  public void previous() {
    var itemId = ClientManager.GetCurrentEditedItemForClient(Caller.id);
    ItemManager.UnlockItem(itemId);
  }
} 
```

至于客户通过关闭离开，我知道您可以实现 IDisconnect 接口并从那里处理断开连接：

```
public class MyHub : Hub, IDisconnect {
    public void Disconnect()
    {
        var itemId = ClientManager.GetCurrentEditedItemForClient(Context.ClientId);
        ItemManager.UnlockItem(itemId);
    }
} 
```

但是，我也知道我在实现断开连接时运气不佳。也许是一个例行程序，可以定期检查每个客户端或 pinger 的状态，任何东西。其他人可能对此有更好的想法。

# c - 具有指针标记结构的 malloc

> ID：11284647
> 
> 赞同：1
> 
> 时间：2012-07-01T18:35:05.237
> 
> 标签：c

我正在创建一个带有节点和边的简单图。我得到了功能，但有一些内存错误。

我在头文件中有一个 typedef 结构：

```
typedef struct Graph_s* Graph; 
```

并在 c 中实现。文件：

```
struct Graph_s {
    Node* nodeArray;
    Edge* edgeArray;  
    size_t edges;
    size_t nodes;
}; 
```

和构造函数：

```
Graph create_graph() {
    Graph newGraph = malloc(sizeof(Graph)); 

    newGraph->edges = 0;
    newGraph->nodes = 0;
    return newGraph;
} 
```

该行`Graph newGraph = malloc(sizeof(Graph))`给出：`Invalid write of size 8`来自 Valgrind。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:39:54.727

`malloc(sizeof(Graph))`只是为指针分配足够的内存。将其更改为`malloc(sizeof(struct Graph_s))`.

# php - 如何使文件不可共享？

> ID：11284650
> 
> 赞同：0
> 
> 时间：2012-07-01T18:35:29.887
> 
> 标签：php, pdf, copy, drm, copy-protection

我正在开发一个关于上传和销售/购买 pdf 文档的 php 网站。当然，我需要以一种无法（或至少非常难以）复制购买的文件的方式对其进行编程。

你知道有什么机制可以做到这一点吗？这是编程问题还是pdf问题？此外，您推荐的其他文件类型是否比 pdf 更好？也许应该有另一种解决方案，而不是下载 pdf 文件，而只是在浏览器中查看它们？

谢谢！查尔斯

编辑

也许需要更多信息：网站上的用户将自己上传 pdf，因此无法仅在下载时创建 pdf，因为它们纯粹是用户生成的输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:42:40.543

我相信受密码/证书保护的 pdf 是一种选择，尽管 iirc 它们需要证书验证（因此 Adob​​e Acrobat 会加载证书并在每次查看时根据您的服务器验证它）。这可能需要购买者进行大量的工作，并且可能会使一些人退出服务。

我只是在购买时生成 pdf，并将购买者的详细信息（地址、电子邮件等）明显地嵌入到 pdf 中（不要偷偷地这样做，因为它可能会违反某些国家的隐私法，尽管你应该嵌入一个私人的“交易ID”），并在它的元数据中。这样，它既不利于共享（因为他们的详细信息将与其他人共享，或者他们必须努力删除它们（如果您在文件中放置编辑锁，这对于普通用户来说很困难） ））。如果您确实在网上找到了共享文档，它还可能允许您识别并阻止用户进行额外购买。

根据问题编辑...可以通过使用[Ghostscript](http://pages.cs.wisc.edu/~ghost/)对 pdf 文档进行自动编辑。（可能需要与 IMagick 或其他软件集成，具体取决于您希望应用的编辑类型）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:41:19.297

我会将它们嵌入到我的网页中。当用户下载文档时，您会失去对它的控制。（除非您实施一些花哨的 DRM 解决方案）

简单的方法是使用[Flex Paper](http://flexpaper.devaldi.com/)或其他在线查看器之类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:41:52.870

例如，创建一个验证用户是否已登录并有权下载 PDF 的页面。

在向用户提供文件时尝试这样的操作，例如，如果您使用的是 PHP：

```
header("Content-Type: application/force-download");
header("Content-Disposition: attachment; filename=\"file.pdf\"); 
```

# java - 如何在 Android 模拟器中获取错误堆栈

> ID：11284651
> 
> 赞同：1
> 
> 时间：2012-07-01T18:35:29.950
> 
> 标签：java, android, xml, button

您好，我使用 AVD，但当我得到 -> 应用程序停止工作强制退出时，我不知道如何出错堆栈...

我想编写简单的侦听器，但出现错误-> 我知道错误是由 setOnClick 侦听器引起的，这很可能是空指针异常，但我想在堆栈错误中看到它。请告诉我为什么会有例外。我附上XML的一部分

```
package com.example.pierwsza;

 import android.os.Bundle;
 import android.app.Activity;
 import android.content.DialogInterface;
 import android.content.DialogInterface.OnClickListener;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.support.v4.app.NavUtils;

class MainActivity extends Activity implements OnClickListener{
Button b;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    b = (Button) findViewById(R.id.button3);
   // b.setOnClickListener((android.view.View.OnClickListener) this); <--- ERROR
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void onClick(DialogInterface dialog, int which) {
    //b.setText("Ale to dziwne");

}

} 
```

* * *

该按钮的 XML

```
 <Button
    android:id="@+id/button3"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/linearLayout1"
    android:layout_marginBottom="29dp"
    android:layout_toLeftOf="@+id/textView1"
    android:text="Jakis przycisk" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:39:00.873

采用

```
b = (Button) findViewById(R.id.button3);
b.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
        }
    }); 
```

代替

```
b = (Button) findViewById(R.id.button3);
b.setOnClickListener((android.view.View.OnClickListener) this); 
```

或者

```
b = (Button) findViewById(R.id.button3);
b.setOnClickListener((this); 
```

将您的方法更改为：

```
public void onClick(View view) {
    //b.setText("Ale to dziwne");
} 
```

并且还进口

```
import android.view.View.OnClickListener; 
```

代替

```
import android.content.DialogInterface.OnClickListener; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T18:41:30.607

如果您使用 Eclipse 进行编码，请转到**Window -> Show View -> LogCat**以查看您的应用程序抛出的错误堆栈。

要修复此特定错误，请更改此：

```
public void onClick(DialogInterface dialog, int which) {
    //b.setText("Ale to dziwne");
} 
```

要像这样使用 View.OnClickListener()：

```
public void onClick(View view) {
    //b.setText("Ale to dziwne");
} 
```

然后按`Ctrl`++将导入语句从 DialogInterface.OnClickListener 更新为 View.OnClickListener `Shift`。`O`

# objective-c - iPhone 应用程序错误。带有空格的 NSString

> ID：11284653
> 
> 赞同：0
> 
> 时间：2012-07-01T18:35:48.780
> 
> 标签：objective-c, nsstring, whitespace

我的 iPhone 应用程序出现重大问题。我的问题似乎很基本，但我无法找出错误的原因。我有一个由用户输入设置的 NSString saveDescription。

```
 savede = civilsJobDescTb.text; 
```

然后我调用 NSLog 来检查字符串是否已设置，确实如此。所以我在那里没有问题。

稍后在程序中，我创建了一个包含多个详细信息的 PDF 文件。除了我之前设置的 NSString 之外，一切正常。似乎字符串不再存在。我从中得到一个错误。`EXC_BAD_ACCESS`或类似的东西。

现在来说奇怪的事情。仅当我在文本框中有空格时才会发生这种情况。例如：我输入“ok”，它将毫无问题地工作。但是，如果我输入“一切正常”，则会出现错误。

我看不出问题出在哪里。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:02:52.830

您没有指定您的“ `savede`”是否是 ivar（实例变量），但假设它是，

***如果您使用的是 ARC***，请为其设置一个强大的属性：

```
@property (nonatomic, strong) NSString * savede;

self.savede = civilsJobDescTb.text; 
```

***如果您不使用 ARC***，请确保`savede`在设置后保留您的 "" 字符串。就像是：

```
 savede = civilsJobDescTb.text;
 [savede retain]; 
```

（确保在你真正完成它时释放它）。

您还可以制作字符串的副本（以防它来自的标签消失，或被清除，或以某种方式消失）。

```
[savede setString: civilsJobDescTb.text];
[savde retain]; 
```

# python - Python 单元测试接口

> ID：11284654
> 
> 赞同：0
> 
> 时间：2012-07-01T18:35:54.870
> 
> 标签：python, unit-testing

这是一个扩展：[Python 中的单元测试接口](https://stackoverflow.com/questions/2915286/unit-testing-interfaces-in-python)

我的问题是满足接口的类的数量最终会达到数千个。不同的开发人员在不同的子类上工作。

我们不能对一个子类进行失败的单元测试，而对其他子类进行失败的测试。本质上，我需要为每个满足接口的子类创建一个新的 unittest.TestCase 类型。

能够在不必修改测试模块的情况下做到这一点会很好。（我想避免每次添加满足接口的新子类时更新单元测试模块）。

我希望能够为满足接口的类自动创建 unittest.TestCase 类类型。这可以使用元类来完成。

但是这些类需要添加到测试模块中进行测试。这可以在类定义期间完成而不需要修改测试模块吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:00:03.473

如果您正在编写单独的子类，除了它们成功实现接口之外，它们之间必须存在差异需要测试。编写一个称为`satisfies_the_thousand_class_interface`测试接口的方法，将其添加到您的自定义`TestCase`类中，然后让您的一千个测试用例中的每一个（每个子类一个）除了它们所做的所有专门测试之外也调用该方法。

# objective-c - iOS dispatch_async，在 iOS 4 上崩溃

> ID：11284656
> 
> 赞同：0
> 
> 时间：2012-07-01T18:36:03.537
> 
> 标签：objective-c, ios

我正在向不同线程上的服务器发出服务器请求。当它们完成加载时，我得到一个更新 tableView 的委托回调。起初，我注意到一些奇怪的行为，并认为这可能是因为某些 UI 元素没有在主线程上执行。

我添加了下面的代码，解决了问题，但是代码在 iOS 4 设备上崩溃了（原来 DISPATCH_QUEUE_PRIORITY_BACKGROUND 与 iOS 4 不兼容）

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND,0), ^(void) {
  dispatch_async(dispatch_get_main_queue(), ^(void) {
    //Update view code etc...
  });
}); 
```

如果我删除第一个`dispatch_async`，并且只调用`dispatch_get_main_queue`，代码运行良好：

```
dispatch_async(dispatch_get_main_queue(), ^(void) {
  //Update view code etc...
}); 
```

在向 Apple 发送更新之前，我想问一下这样可以吗？代码会在 iOS 4 设备上正确运行吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:39:46.427

`DISPATCH_QUEUE_PRIORITY_BACKGROUND`仅适用于 iOS 5 及更高版本

来自苹果文档

> DISPATCH_QUEUE_PRIORITY_BACKGROUND 分派到队列的项目以后台优先级运行；在调度所有高优先级队列并且系统在其优先级设置为后台状态的线程上运行项目之后，该队列被调度执行。这样的线程具有最低优先级，并且任何磁盘 I/O 都会受到限制，以尽量减少对系统的影响。在 iOS 5.0 及更高版本中可用。

因此，如果您也在考虑为 iOS 4 分发您的应用程序，那么您将无法使用它

源[苹果文档](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/constant_group/dispatch_queue_priority_t)

但是，如果您删除`DISPATCH_QUEUE_PRIORITY_BACKGROUND`，您当前的代码将仅在主 ui 线程中运行，这可能会导致您在执行远程请求时速度变慢

# c# - 初始化 List 时的 ArrayIndexOutOfBounds

> ID：11284662
> 
> 赞同：-2
> 
> 时间：2012-07-01T18:36:43.847
> 
> 标签：c#, list

我有以下 C# 代码：

```
List<int[,]> l1 = new List<int[,]>();
l1[0] = new int[1, 1]; 
```

它直接抛出 System.ArgumentOutOfRangeException。

怎么会？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:38:06.043

列表默认创建为空，替换`[]`为`Add()`

```
 List<int[,]> l1 = new List<int[,]>();
 l1.Add(new int[1, 1]); 
```

或使用 .NET 4.0 初始化程序（语义与上述相同）：

```
 List<int[,]> l1 = new List<int[,]>(){new int[1, 1]}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:37:40.777

您需要在列表上使用 [List.Add](http://msdn.microsoft.com/en-us/library/3wcytfd1.aspx)而不是索引访问`l1.Add(new int[1, 1]);`

# javascript - console.log() 在值实际改变之前显示变量的改变值

> ID：11284663
> 
> 赞同：92
> 
> 时间：2012-07-01T18:36:45.017
> 
> 标签：javascript, google-chrome, variables

这段代码我明白了。我们复制 A 并将其称为 C。当 A 更改时，C 保持不变

```
var A = 1;
var C = A;
console.log(C); // 1
A++;
console.log(C); // 1 
```

但是当 A 是一个数组时，我们有不同的情况。不仅C会改变，而且在我们接触A之前它也会改变

```
var A = [2, 1];
var C = A;
console.log(C); // [1, 2]
A.sort();
console.log(C); // [1, 2] 
```

有人可以解释第二个例子中发生了什么吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2018-02-25T02:21:56.800

`Console.log()`传递了对对象的*引用*，因此控制台中的值会随着对象的变化而变化。为避免这种情况，您可以：

```
console.log(JSON.parse(JSON.stringify(c))) 
```

[MDN 警告](https://developer.mozilla.org/en-US/docs/Web/API/Console/log)：

> 请注意，如果您在最新版本的 Chrome 和 Firefox 中记录对象，您在控制台上记录的内容是对该对象的引用，这不一定是您调用时对象的“值” `console.log()`，而是它是您打开控制台时对象的值。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2014-06-12T04:51:05.057

[Pointy 的答案](https://stackoverflow.com/a/11284675/1494616)有很好的信息，但它不是这个问题的正确答案。

OP 描述的行为是 2010 年 3 月首次报告的错误的一部分，并于 2012 年 8 月为 Webkit 进行了修补，但在撰写本文时尚未集成到 Google Chrome 中。该行为取决于将对象文字传递给时控制台调试窗口是**打开**还是**关闭**`console.log()`。

[原始错误报告（ https://bugs.webkit.org/show_bug.cgi?id=35801](https://bugs.webkit.org/show_bug.cgi?id=35801) ）的摘录：

> 来自 mitch kramer 的描述 2010-03-05 11:37:45 PST
> 
> 1) 创建一个具有一个或多个属性的对象字面量
> 
> 2）console.log 该对象但保持关闭（不要在控制台中展开它）
> 
> 3) 将其中一个属性更改为新值
> 
> 现在打开那个console.log，你会看到它出于某种原因有新的价值，即使它的价值在它生成的时候是不同的。
> 
> 我应该指出，如果您打开它，如果不清楚，它将保留正确的值。

Chromium 开发人员的回复：

> 评论 #2 来自 Pavel Feldman 2010-03-09 06:33:36 PST
> 
> 我认为我们永远不会解决这个问题。我们无法在将对象转储到控制台时对其进行克隆，我们也无法监听对象属性的更改以使其始终真实存在。
> 
> 我们应该确保现有的行为是预期的。

随之而来的是很多抱怨，最终导致了错误修复。

2012 年 8 月实施的补丁的变更日志注释 ( [http://trac.webkit.org/changeset/125174](http://trac.webkit.org/changeset/125174) )：

> 截至今天，将对象（数组）转储到控制台将导致对象的属性在控制台对象扩展时被读取（即延迟）。这意味着在改变它的同时转储同一个对象将很难使用控制台进行调试。
> 
> 此更改在记录时开始为对象/数组生成缩写预览，并将此信息传递到前端。这仅在前端已经打开时发生，它仅适用于 console.log()，不适用于实时控制台交互。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2019-11-15T23:10:32.170

[Mozilla](https://developer.mozilla.org/en-US/docs/Web/API/Console/log)截至 2022 年 2 月的最新指南：

> 不使用`console.log(obj)`，使用`console.log(JSON.parse(JSON.stringify(obj)))`。
> 
> 这样，您就可以确定您在`obj`记录时看到了 的价值。否则，许多浏览器会提供实时视图，该视图会随着值的变化而不断更新。这可能不是你想要的。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-07-01T18:38:09.307

数组是**对象**。变量**指**的是对象。因此，第二种情况下的赋值将数组的**引用**（地址）从“A”复制到“C”。之后，两个变量都引用同一个对象（数组）。

像数字这样的原始值在像您这样的简单赋值中完全从一个变量复制到另一个变量。“A++”；语句为“A”分配一个新值。

换一种说法：变量的值可以*是*原始值（数字、布尔值、`null`. 或字符串），也可以是对对象的*引用*。字符串原语的情况有点奇怪，因为它们更像对象而不是原始（标量）值，但它们是不可变的，所以可以假装它们就像数字一样。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-01T18:41:11.473

**编辑：**保留这个答案只是为了保留下面的有用评论。

@Esailija 实际上是正确的 -`console.log()`不一定会记录变量在您尝试记录它时所具有的值。在您的情况下，两次调用都`console.log()`将记录排序`C` **后的值。**

如果您尝试在控制台中将相关代码作为 5 个单独的语句执行，您将看到预期的结果（首先，`[2, 1]`，然后`[1, 2]`）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-26T04:24:02.283

虽然它不会在所有情况下都有效，但我最终使用了一个“断点”来解决这个问题：

```
mysterious = {property:'started'}

// prints the value set below later ?
console.log(mysterious)

// break,  console above prints the first value, as god intended
throw new Error()

// later
mysterious = {property:'changed', extended:'prop'} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-12T17:56:03.003

该问题也存在于 Safari 中。正如其他人在这个问题和类似问题中指出的那样，控制台传递了一个对对象的引用，它在控制台打开时打印对象的值。例如，如果您直接在控制台中执行代码，则值会按预期打印。我更喜欢传播数组（例如，在您的情况下为*console.log([...C]);*）和对象，而不是 JSON 字符串化：结果完全相同，但代码看起来更简洁。我有两个[VS 代码片段](https://code.visualstudio.com/docs/editor/userdefinedsnippets#_create-your-own-snippets)要分享。

```
 "Print object value to console": {
      "prefix": "clo",
      "body": [
         "console.log(\"Spread object: \", {...$0});"
      ],
      "description": "Prints object value instead of reference to console, to avoid console.log async update"
   },
   "Print array value to console": {
      "prefix": "cla",
      "body": [
         "console.log(\"Spread array: \", [...$0]);"
      ],
      "description": "Prints array value instead of reference to console, to avoid console.log async update"
   } 
```

为了获得与*console.log( JSON.parse(JSON.stringify(c)))*相同的输出，如果您愿意，可以省略字符串部分。顺便说一句，[扩展语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)通常可以节省时间和代码。

# jquery - 使用 jquery 和 css 定位 div 标签的值

> ID：11284664
> 
> 赞同：1
> 
> 时间：2012-07-01T18:36:59.737
> 
> 标签：jquery, css

在下面的函数中，我传递了一个包含位置 (x & y) 值的参数 pos。如您所见，我正在尝试使用这些值来放置 div 标签的输出。由于某种原因，它不起作用。任何人都可以看看我做错了什么吗？

此功能的目标是在您悬停的位置显示 div 中的 html...

目前，它正在网页底部显示悬停的输出。

谢谢克里斯

```
featureOver: function(ev,latlng,pos,data)   
{  
    var X = pos.x;  
    var Y = pos.y;  
    alert('X = ' + X + '  ' + 'Y = ' + Y);    
    document.body.style.cursor = "pointer";  
    $("div#over").css("top",  Y + "px");  
    $("div#over").css("left", X + "px");  
    $("div#over").html(data.name);  
}, 
```

### 代码

```
<table id=maptable border=2>
<th>
<div id="map_canvas" style="height:500px; width:700px; background-color:white; border:1px solid black; "></div>
<div id="over"></div>
</th> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:46:26.113

试试这个（使用`offset()`）：

```
featureOver: function(ev,latlng,pos,data)   
{  
    var X = pos.x;  
    var Y = pos.y;  
    alert('X = ' + X + '  ' + 'Y = ' + Y);    
    document.body.style.cursor = "pointer";  
    $("div#over").offset().top =  Y + "px";  
    $("div#over").offset().left =  X + "px";  
    $("div#over").html(data.name);  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:50:20.010

这取决于您的 div#over 的位置。有关位置：绝对和位置：相对的 CSS 中的“顶部”和“底部”属性如何工作的说明，请参见此处。

> 对于绝对定位的元素（具有 position : absolute 或 position : fixed 的元素），它指定元素的上边距边缘与其包含块的上边缘之间的距离。
> 
> 对于相对定位的元素（具有 position : relative 的元素），它指定元素在其正常位置下方移动的量。

[https://developer.mozilla.org/en/CSS/top](https://developer.mozilla.org/en/CSS/top)

# php - 如何在页面中显示和格式化 HTML 代码？

> ID：11284667
> 
> 赞同：-1
> 
> 时间：2012-07-01T18:37:17.120
> 
> 标签：php, javascript, html

我想显示 html 代码，就像您在此处看到的一样。

```
<textarea><script id="ff">gdgdgs</script></textarea> 
```

并在不更改页面的情况下显示它。把它放在这样的盒子里。

这是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:45:25.893

我认为最好的方法是实际看看 Stackoverflow 是如何做到的！:)

如果您右键单击 Chrome 中的代码框并选择检查元素，它将显示该框的标记。能够做到这一点非常有用，显然不是为了骗人，而是学习其他人如何将网站放在一起，以及他们如何实现代码框之类的酷炫效果！:)

不过有趣的是，如果您只是右键单击页面并转到*查看源代码*，您会看到一些稍微不同的东西：

```
<pre><code>&lt;textarea&gt;&lt;script id="ff"&gt;gdgdgs&lt;/script&gt;&lt;/textarea&gt;
</code></pre> 
```

所以我们可以在这里看到，这是该框的标记在页面加载和任何 JavaScript 运行之前的样子。当页面开始在客户端加载时，将运行一些 JavaScript，它采用上述标记并将其转换为您在右键单击代码框并在 chrome 中检查时看到的标记。这样做可以让您实时查看页面上的 HTML：

```
<pre class="lang-php prettyprint">
    <code>
        <span class="tag">&lt;textarea&gt;&lt;script</span>
        <span class="pln"></span>
        <span class="atn">id</span>
        <span class="pun">=</span>
        <span class="atv">"ff"</span>
        <span class="tag">></span>
        <span class="pln">gdgdgs</span>
        <span class="tag">&lt;/script&gt;&lt;/textarea&gt;</span>
        <span class="pln"><br></span>
    </code>
</pre> 
```

因此，如果您看一下，您会发现转换后的代码使用了一个*[pre](https://developer.mozilla.org/en/HTML/Element/pre "预")*标记。这基本上是说，在这里之间的任何内容都可以视为文字，或者换句话说，在我离开它们的地方保留换行符和空格！

除了使用*[pre](https://developer.mozilla.org/en/HTML/Element/pre "预")*标记来包装代码之外，您还可以看到它们使用不同的 CSS 类。这是为了实现你可以看到的颜色编码。

他们还使用了一个*[代码](https://developer.mozilla.org/en/HTML/Element/code "代码")*标签，据我所知，它与 pre 非常相似，只是它让你的标记更清晰一点，在这个标签中，你应该期望看到代码。它可能比任何东西都更具语义性，例如 HTML 标签*artical*。在大多数浏览器中，它还会将代码标签内的文本字体更改为单空格，这更像是代码！:)

你可以更深入地了解他们的 CSS 类是什么样子的，从这里你可以开始建立一个心理图景，看看他们的标记和 CSS 如何协同工作以产生他们漂亮的代码框。

当然，如果你不想自己推出这个功能，你可以使用别人的框架来实现。例如，如果广泛使用和推荐[SyntaxHighlighter 。](http://alexgorbatchev.com/SyntaxHighlighter/ "语法高亮")

使用 Syntax Highlighter，您只需引用 Syntax Highlighter CSS 和 javascript，然后只需将代码包装在一个 pre 标签中即可使其正常工作，如下所示：

```
<pre class="brush: xml">
     &lt;textarea&gt;&lt;script id="ff"&gt;gdgdgs&lt;/script&gt;&lt;/textarea&gt;
</pre> 
```

可能值得一看！

希望这可以帮助！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T18:38:53.077

你可以使用

```
&gt; 
```

>

和

```
&lt; 
```

<

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T18:41:34.103

这个网站可以帮助您解决您的特定问题[。](http://www.addressmunger.com/display_code/)它将您的标签/html/javascript 转换为 ASCII。如果你需要一个函数，这里就是。它将传递的标签/html/javascript 转换为 ASCII。ASCII 代码被转义并被浏览器视为文本。您可以稍后使用生成的 ASCII 并将其添加到框中。

```
function stringToAscii(s)
{
  var ascii="";
  if(s.length>0)
    for(i=0; i<s.length; i++)
    {
      var c = ""+s.charCodeAt(i);
      while(c.length < 3)
       c = "0"+c;
      ascii += c;
    }
  return(ascii);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T03:35:57.033

像这样使用编码版本：

```
&lt;textarea&gt;
    &lt;script id="ff"&gt;
        gdgdgs
    &lt;/script&gt;
&lt;/textarea&gt; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T18:38:53.870

你是这个意思吗？

```
&lt;textarea&gt;&lt;script id=&quot;ff&quot;&gt;gdgdgs&lt;/script&gt;&lt;/textarea&gt; 
```

查找 HTML 实体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-01T18:45:29.027

是的，只需像这样包含它：

```
$(document).ready(function(){
  var a = '<textarea><script id="ff">gdgdgs</scrip'+'t></textarea>';
  $("div").css('background','red').text(a);
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-01T18:52:38.763

我使用[`<xmp>`](https://developer.mozilla.org/en/HTML/Element/xmp)元素。

# php - 根据使用情况查询不同费率类别的合计金额

> ID：11284671
> 
> 赞同：1
> 
> 时间：2012-07-01T18:37:41.013
> 
> 标签：php, mysql, sum, multiplication, number-formatting

**场景**：我需要根据每个客户的小时费率和他们在不同费率类别中提供/接受服务的时间（分钟）来计算适用于每个客户的金额总和。

使用以下查询，我得到以下结果：

```
SELECT pc.client_id, pr.hourly_rate, (SUM(tt.time_end) - SUM(tt.time_start)) as Difference
FROM  track_time as tt, project_track as pt, project as pr, project_clients as pc, clients as cl
WHERE tt.track_id = pt.track_id
AND pt.project_id = pr.project_id
AND pr.project_id = pc.project_id
AND pc.client_id = cl.client_id 
GROUP BY hourly_rate 
```

**结果**

```
client_id   hourly_rate   Difference
1           50            6360
1           23            4080
1           43            5760
6           13            34680
7           60            32400
7           14            23340 
```

我试图弄清楚如何首先我需要使用函数将 DIFFERENCE 结果转换为可读小时，然后将转换后的结果乘以它各自的 hourly_rate，然后获取每个客户端的 SUM。

我首先尝试了这个（下），它非常接近，但它不准确。我认为它不准确，因为我需要先转换 DIFFERENCE 列。

```
SELECT SUM(Difference2) AS total
FROM (SELECT pc.client_id, pr.hourly_rate, (SUM(tt.time_end) - SUM(tt.time_start)) as Difference, ((SUM(tt.time_end) - SUM(tt.time_start)) * pr.hourly_rate) as Difference2
FROM  track_time as tt, project_track as pt, project as pr, project_clients as pc, clients as cl
WHERE tt.track_id = pt.track_id
AND pt.project_id = pr.project_id
AND pr.project_id = pc.project_id
AND pc.client_id = cl.client_id   
GROUP BY hourly_rate) AS table1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:53:33.140

这有效：

```
SELECT SUM(T) as YES FROM (
SELECT pc.client_id, pr.hourly_rate, ROUND((( SUM(tt.time_end) - SUM(tt.time_start))/3600),2) as Difference, (ROUND((( SUM(tt.time_end) - SUM(tt.time_start))/3600),2) * hourly_rate) as T
FROM track_time as tt, project_track as pt, project as pr, project_clients as pc, clients as cl
WHERE tt.track_id = pt.track_id
AND pt.project_id = pr.project_id
AND pr.project_id = pc.project_id
AND pc.client_id = cl.client_id
AND cl.client_id = " . $db->prep($client_id) . " GROUP BY hourly_rate) as table1 
```

# delphi - 如何开始使用 Delphi 创建我自己的类？

> ID：11284677
> 
> 赞同：6
> 
> 时间：2012-07-01T18:38:37.520
> 
> 标签：delphi, oop, class

几天前我发布[了一个问题，答案告诉我创建自己的课程。](https://stackoverflow.com/questions/11270972/declare-locally-or-globally-in-delphi)

我是 OOP 之前的老派程序员，我的编程结构良好、高效且有条理，但除了使用 Delphi 和 3rd 方对象之外，缺乏任何自定义 OOP。

当我开始使用 Delphi 2 时，我曾研究过 Delphi 的面向对象类是如何工作的，但它们对我的编程背景来说似乎很陌生。我了解它们对于设计组件和用户界面上的可视化控件的开发人员来说是如何并且非常出色。但是我从来没有发现需要在我的程序本身的编码中使用它们。

因此，15 年后，现在我再次回顾 Delphi 的课程和 OOPing。例如，如果我采用一个结构，例如：

```
type
  TPeopleIncluded = record
    IndiPtr: pointer;
    Relationship: string;
  end;
var
  PeopleIncluded: TList<TPeopleIncluded>; 
```

然后一个 OOP 倡导者可能会告诉我把它变成一个类。从逻辑上讲，我认为这将是一个从通用 TList 继承的类。我猜这将是这样完成的：

```
TPeopleIncluded<T: class> = class(TList<T>) 
```

但这就是我陷入困境的地方，并且没有关于如何做其余部分的良好说明。

当我查看 Delphi 在 Generics.Collections 单元中作为示例的某个类时，我看到：

```
TObjectList<T: class> = class(TList<T>)
private
  FOwnsObjects: Boolean;
protected
  procedure Notify(const Value: T; Action: TCollectionNotification); override;
public
  constructor Create(AOwnsObjects: Boolean = True); overload;
  constructor Create(const AComparer: IComparer<T>; AOwnsObjects: Boolean = True); overload;
  constructor Create(Collection: TEnumerable<T>; AOwnsObjects: Boolean = True); overload;
  property OwnsObjects: Boolean read FOwnsObjects write FOwnsObjects;
end; 
```

然后他们对构造函数和过程的定义是：

```
{ TObjectList<T> }

constructor TObjectList<T>.Create(AOwnsObjects: Boolean);
begin
  inherited;
  FOwnsObjects := AOwnsObjects;
end;

constructor TObjectList<T>.Create(const AComparer: IComparer<T>; AOwnsObjects: Boolean);
begin
  inherited Create(AComparer);
  FOwnsObjects := AOwnsObjects;
end;

constructor TObjectList<T>.Create(Collection: TEnumerable<T>; AOwnsObjects: Boolean);
begin
  inherited Create(Collection);
  FOwnsObjects := AOwnsObjects;
end;

procedure TObjectList<T>.Notify(const Value: T; Action: TCollectionNotification);
begin
  inherited;
  if OwnsObjects and (Action = cnRemoved) then
    Value.Free;
end; 
```

让我告诉你，这个“简单”的类定义对于那些在 Delphi 中使用 OOP 多年的人来说可能是显而易见的，但对我来说，它只为我提供了数百个关于我使用什么以及如何使用它的未回答的问题.

对我来说，这似乎不是一门科学。它似乎是一门如何将信息最好地构造成对象的艺术。

所以这个问题，我希望它不会被关闭，因为我真的需要帮助，我在哪里或如何获得关于使用 Delphi 创建类的最佳指导 - 以及如何以正确的 Delphi 方式进行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T21:39:18.970

> 对我来说，这似乎不是一门科学。它似乎是一门如何将信息最好地构造成对象的艺术。

嗯...是的。正式的要求真的不多。它实际上只是一组工具，可以帮助您组织您的想法，并在此过程中消除大量重复。

> 然后一个 OOP 倡导者可能会告诉我把它变成一个类。从逻辑上讲，我认为这将是一个从通用 TList 继承的类。

实际上，通用容器的全部意义在于您*不必*为每种类型的对象创建一个新的容器类。相反，您将创建一个新的内容类，然后创建一个`TList<TWhatever>`.

将类实例视为指向记录的指针。

现在：既然可以使用指向记录的指针，为什么还要使用类？几个原因：

*   **encapsulation**：您可以使用关键字隐藏实现的某些方面，`private`以便其他开发人员（包括您未来的自己）知道不要依赖可能更改或对于理解概念并不重要的实现细节。
*   **多态性**：您可以通过为每个记录提供一组指向函数的指针来避免许多特殊的调度逻辑。然后，不是有一个大的`case`语句来为每种类型的对象做不同的事情，而是循环遍历列表并向每个对象发送相同的消息，然后它遵循函数指针来决定要做什么。
*   **继承**：当您开始使用指向函数和过程的指针创建记录时，您会发现您经常需要一个新的函数调度记录，这与您已经拥有的非常相似，除了您需要更改一两个过程. 子类化只是实现这一目标的一种便捷方式。

因此，在您的另一篇文章中，您表示您的整体程序如下所示：

```
procedure PrintIndiEntry(JumpID: string);
  var PeopleIncluded : TList<...>;
begin      
   PeopleIncluded := result_of_some_loop;
   DoSomeProcess(PeopleIncluded);
end; 
```

我不清楚是什么`Indi`意思`JumpID`，所以我要假装你们公司做跳伞婚礼，`Indi`意思是“个人”，`JumpID`是数据库中的主键，表示所有这些人都参加婚礼的航班并计划从同一架飞机上跳下来......对于这对幸福的夫妇来说，了解他们至关重要，`Relationship`这样您就可以给他们正确的颜色降落伞。

显然，这与您的域不完全匹配，但是由于您在这里提出一般性问题，因此细节并不重要。

另一篇文章中的人试图告诉您的（无论如何我的猜测）不是用一个类替换您的列表，而是用一个替换 JumpID。

换句话说，不是传递`JumpID`给一个过程并使用它从数据库中获取人员列表，而是创建一个`Jump`类。

如果您的 JumpID 实际上表示如 in 中的跳转`goto`，那么您实际上可能会包含一堆类，它们都是同一事物的子类，并以不同的方式覆盖同一方法。

事实上，让我们假设您举办了一些不是婚礼的派对，在这种情况下，您不需要关系，而只需要一个简单的人员列表：

```
type TPassenger = record
   FirstName, LastName: string;
end;

type TJump = class
  private
    JumpID   : string;
    manifest : TList< TPassenger >;
  public
    constructor Init( JumpID: string );
    function GetManifest( ) : TList< TPassenger >;
    procedure PrintManifest( ); virtual;
end; 
```

所以现在`PrintManifest()`完成了你的工作`PrintIndyEntry()`，但它不是计算内联列表，而是调用`Self.GetManifest()`.

现在也许您的数据库没有太大变化，并且您的`TJump`实例总是短暂的，所以您决定只填充`Self.manifest`构造函数。在这种情况下，`GetManifest()`只需返回该列表。

或者您的数据库可能经常更改，或者`TJump`停留时间足够长以至于数据库可能会在其下更改。在这种情况下，`GetManifest()`每次调用时都会重建列表...或者您可能添加另一个`private`值来指示您上次查询的时间，并且仅在信息过期后更新。

关键是`PrintManifest`不必关心它是如何`GetManifest`工作的，因为你已经隐藏了这些信息。

当然，在 Delphi 中，您可以使用 a 来做同样的事情，在您的部分`unit`中隐藏缓存的乘客列表列表。`implementation`

但是，当需要实现婚礼派对特定的功能时，类会带来更多的好处：

```
type TWeddingGuest = record
  public
    passenger    : TPassenger;
    Relationship : string;
end;

type TWeddingJump = class ( TJump )
  private
    procedure GetWeddingManifest( ) : TList< TWeddingGuest >;
    procedure PrintManifest( ); override;
end; 
```

所以在这里， the`TWeddingJump`继承了`Init`and `GetManifest`，`TJump`但它也添加了 a `GetWeddingManifest( );`，它会`PrintManifest()`用一些自定义实现来覆盖 of 的行为。（你知道它这样做是因为`override`这里的标记，它对应`virtual`于`TJump`.

但是现在，假设这`PrintManifest`实际上是一个相当复杂的过程，并且当您只想在标题中添加一列，并在正文中列出关系字段的另一列时，您不想复制所有代码。你可以这样做：

```
type TJump = class
   // ... same as earlier, but add:
   procedure PrintManfestHeader(); virtual;
   procedure PrintManfiestRow(passenger:TPassenger); virtual;
end;
type TWeddingJump = class (TJump)
   // ... same as earlier, but:
   // * remove the PrintManifest override
   // * add:
   procedure PrintManfestHeader(); override;
   procedure PrintManfiestRow(passenger:TPassenger); override;

end; 
```

现在，你想这样做：

```
procedure TJump.PrintManifest( )
   var passenger: TPassenger;
begin;
   // ...
   Self.PrintManifestHeader();
   for guest in Self.GetManifest() do begin
      Self.PrintManifestRow();
   end;
   // ...
end; 
```

但是你还不能，因为`GetManifest()`return`TList< TPassenger >;`和 for `TWeddingJump`，你需要它来 return `TList< TWeddingGuest >`。

好吧，你怎么能处理呢？

在您的原始代码中，您有以下内容：

```
IndiPtr: pointer 
```

指向什么？我的猜测是，就像这个例子一样，你有不同类型的个体，你需要他们做不同的事情，所以你只使用一个通用指针，让它指向不同类型的记录，并希望你将它转换为以后做对的事。但是类为您提供了几种更好的方法来解决这个问题：

*   您可以创建`TPassenger`一个类并添加一个`GetRelationship()`方法。这将消除对 的需要`TWeddingGuest`，但这意味着该`GetRelationship`方法始终存在，即使您不是在谈论婚礼。
*   你可以`GetRelationship(guest:TPassenger)`在`TWeddingGuest`类中添加一个，然后在里面调用它`TWeddingGuest.PrintManifestRow()`。

但是假设您必须查询数据库来填充该信息。使用上述两种方法，您将为每位乘客发出一个新查询，这可能会使您的数据库陷入困境。您真的想一次性获取所有内容，在`GetManifest()`.

因此，相反，您再次应用继承：

```
type TPassenger = class
  public
    firstname, lastname: string;
end;
type TWeddingGuest = class (TPassenger)
  public
    relationship: string;
end; 
```

因为`GetManifest()`返回一个乘客列表，并且所有婚礼宾客都是乘客，所以您现在可以这样做：

```
type TWeddingJump = class (TJump)
  // ... same as before, but:
  // replace: procedure GetWeddingManfiest...
  // with:
  procedure GetManifest( ) : TList<TPassenger>; override;
  // (remember to add the corresponding 'virtual' in TJump)
end; 
```

现在，您为和填写`TWeddingJump.PrintManifestRow`相同版本的`PrintManifest`作品的详细信息。`TJump``TWeddingJump`

还有一个问题：我们声明`PrintManifestRow(passenger:TPassenger)`了，但实际上我们传入了一个`TWeddingGuest`. 这是合法的，因为`TWeddingGuest`它是`TPassenger`...的子类，但我们需要获取该`.relationship`字段，并且`TPassenger`没有该字段。

编译器怎么能相信在 a`TWeddingJump`中，你总是会传入 a`TWeddingGuest`而不仅仅是一个普通的`TPassenger`？您必须确保该`relationship`字段确实存在。

您不能仅仅将其声明为，`TWeddingJupmp.(passenger:TWeddingGuest)`因为通过子类化，您基本上承诺做父类可以做的所有事情，而父类可以处理*任何* `TPassenger`.

所以你可以回去手动检查类型并强制转换它，就像一个无类型的指针一样，但同样，有更好的方法来处理这个：

*   **多态方法：**将`PrintManifestRow()`方法移动到`TPassenger`类（删除`passenger:TPassenger`参数，因为这现在是隐式参数`Self`），覆盖该方法`TWeddingGuest`，然后`TJump.PrintManifest`调用`passenger.PrintManifestRow()`。
*   **泛型类方法：**使`TJump`自己成为泛型类（类型`TJump<T:TPassenger> = class`），而不是`GetManifest()`return a `TList<TPassenger>`，而是让它 return `TList<T>`。同样，`PrintManifestRow(passenger:TPassenger)`变成`PrintManifestRow(passenger:T)`;。现在您可以说：`TWeddingJump = class(TJump<TWeddingGuest>)`现在您可以自由地将覆盖的版本声明为`PrintManifestRow(passenger:TWeddingGuest)`.

无论如何，这比我想写的要多得多。我希望它有所帮助。:)

# design-patterns - Scala 对奇怪重复的泛型模式的扩展

> ID：11284679
> 
> 赞同：2
> 
> 时间：2012-07-01T18:38:49.673
> 
> 标签：design-patterns, scala, generics, self-type

在询问/编辑[这个问题](https://stackoverflow.com/questions/11276706/what-do-user-defined-value-classes-look-like-from-java)时，我注意到您可以这样做以完全静态安全地实现原始“奇怪重复的模板/通用模式”的要点：

```
trait MyTrait[This <: MyTrait[This]] { this: This =>
  def myBinOp(other: This): This
} 
```

这似乎让您消除了隐式转换和 Scala 的 ad-hoc 类型类模式的主要需求之一，因为 self-type 消除了声明的能力

```
class A extends MyTrait[Nothing] 
```

和类似的事情，这是我所知道的原始模式的唯一问题。有什么我错过的吗？为什么不是每个人（在 Scala 中）都开始使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T22:23:16.433

正如 Daniel C. Sobral 的评论所指出的那样，它实际上不起作用。我不知道为什么我错过了这个，因为事后看来这很明显：

```
class A extends MyTrait[A] {...} // Linearization:  A, MyTrait[A], AnyRef, Any
class B extends A {...} // Linearization:  B, A, MyTrait[A], AnyRef, Any 
```

最大的问题是它`B`的`myBinOp`回报`A`而不是`B`.

# php - 创建从数据库中提取的多维数据数组

> ID：11284685
> 
> 赞同：1
> 
> 时间：2012-07-01T18:39:22.067
> 
> 标签：php, codeigniter, multidimensional-array

我正在使用 codeIgniter。我需要创建一个数据库命名学院的数据的多维数组。该数据库有 3 列：id、OfID 和 name。OfID 列包含该学院家长的 ID。对于没有任何父母的大学，OfID 为 0。

该数组应包含以 OfID=0 作为第一维元素的大学的名称、ID 和 OfID。对于具有 OfID!=0 的大学，应将其 ID 为 OfID 的大学作为第二维数组（依此类推）。

我想递归地做到这一点，但我无法完成这个。我知道这有很多错误，请帮助。

模型类如下：（控制器调用 meth() 函数）

```
class Model extends CI_Model
{
var $return_this=array();
function meth()
{       
    $loop_id=0;
    getit($loop_id);
    var_dump($return_this);
}
function getit($loop_id)
{
    $index=0;
    $query = $this->db->query("select * from college where OfID=$loop_id ORDER BY `OfID` ASC;");
    if ($query->num_rows() > 0)
    {
        foreach ($query->result() as $row)
        {
            $pass=$row->id;
            $temp=getit($pass);
            if($temp==0)
            $return_this[$loop_id]= $query->result();
        }
    }
    else return 0;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:54:09.500

尝试这样的事情：

```
$rows = array();
foreach ($query->result() as $row)
    {
        $pass=$row->id;
        $rows[] = getit($pass);
    }
return $rows; 
```

无论如何，我发现自己进行递归的最佳方法是采用一些非常简单的递归函数，并且您了解它的各个方面，然后逐步构建它。“一步一步”我的意思是一开始你不会传递所有的值，而是将它们打印出来，只是为了看看你得到了什么、在哪里以及如何得到，然后尝试传递它们。如果你不了解它是如何工作的，那么像这样的递归函数会对大脑造成伤害。你的想法是，每次你偶然发现一所拥有子学院的大学时，都会得到一个数组。我可以看到你做对了，只要像我之前所说的那样尝试做这个 - 一步一步你就会掌握它。

# jquery - jQuery Image Slider - 在主图像的任一侧都有图像

> ID：11284687
> 
> 赞同：0
> 
> 时间：2012-07-01T18:39:31.920
> 
> 标签：jquery, image, slider

我意识到网上有数百个关于如何创建 jQuery 图像滑块的教程。但是，它们中没有一个与我正在尝试做的事情完全相关......

我有一组大约 350 像素高和 800 像素宽的图像。我真正想做的是将这些图像放在页面顶部，并让它们滑过（就像在许多滑块中看到的那样）。唯一的区别是，我真的希望主图像两侧的其他 2 个图像聚焦。因此，当图像滑入时，您可以从左侧看到它。而刚刚离开主焦点的图像仍然可以从右侧看到。显然，主图像两侧的左右图像会稍微偏离页面。

我想要这个的原因是我可以拥有一个适合所有分辨率的全尺寸网站。另外，我计划让这个网站具有响应性，这样当页面缩小时，两边的 2 张图片就不再需要了。我希望我已经说清楚了。我只是想知道是否有任何这样的例子？

作为一个“很高兴拥有”，拥有一个图像选择器也很棒！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T15:08:20.250

你可以试试这个......
[Hero Carousel](http://www.paulwelsh.info/jquery-plugins/hero-carousel/)
它可能符合你的描述。
这是另一个可能满足您需求的链接。
[http://jsfiddle.net/JCQ6Q/15/](http://jsfiddle.net/JCQ6Q/15/)
如果对您有帮助，请投票:) 一切顺利

# python - 如何在雪豹上安装lightblue（蓝牙）模块？

> ID：11284694
> 
> 赞同：1
> 
> 时间：2012-07-01T18:40:08.083
> 
> 标签：python, gcc, bluetooth, osx-snow-leopard

我正在尝试从[lightblue](http://lightblue.sourceforge.net/)安装蓝牙模块。

我的系统：Mac OS X Snow Leopard 10.6.8、Python 2.7、gcc 4.2 & 4.0、xcode v.3.2.3。我检查了，我的系统中也直接在 /Library/Python/ 下获得了 python 2.3/2.5/2.6 文件夹（这与位于 /Library/Frameworks/Python.framework/Versions/2.7/ 中的 2.7 不同）

当我使用 安装 lightblue 时`python setup.py install`，出现以下错误：

```
GCC 4.2 is not compatible with the Mac OS X 10.4 SDK (file BBBluetoothOBEXClient.m)
** BUILD FAILED ** 
```

所以我认为这是关于 gcc 版本的。所以我做了：'export CC=gcc-4.0' 或 'export CC=/usr/bin/gcc-4.0'（我的 Mac 上有 2 个版本的 gcc；4.2 和 4.0）。然后我检查了一下`gcc -v`，它已经从 4.2 切换到 4.0。但是当我重新运行时`python setup.py install`，它仍然显示 4.2：

```
GCC 4.2 is not compatible with the Mac OS X 10.4 SDK (file BBBluetoothOBEXClient.m)
** BUILD FAILED ** 
```

为什么它仍然显示 gcc 4.2？

有没有人有任何解决方案？我尝试使用 pip 但得到了相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T05:35:12.707

我不小心找到了解决方案，我从：[lightblue](http://lightblue.sourceforge.net/)

**对于 Mac OS 10.6 用户：**

1.  打开 src/mac/_lightblue.py 并将**signature="v@:@iB"**更改为**signature="v@:@iZ"**（第 468 行）
2.  下载并解压**LightAquaBlue-python-MacOS10.6.zip**，其中包含一个 LightAquaBlue 目录。将此目录移动到您的 python 站点包库中，例如 /Library/Python/2.6/site-packages
3.  下载并解压缩**LightAquaBlue-framework-MacOS10.6.zip**，其中包含一个（完全不同的）LightAquaBlue 目录。将此目录移动到 src/mac 以替换现有的 src/mac/LightAquaBlue 目录。这应该可以解决旧 LightAquaBlue xcode 项目中存在的架构/构建问题。
4.  正常运行**python setup.py install**进行安装。

现在运行时`python setup.py install`，我得到了这个：`** BUILD SUCCEEDED **` 使用 pip 将失败，除了我们如上所述更改了一些安装源文件夹。我得到了“构建成功”，但还没有测试模块，因为我需要完成其他安装步骤。我正在安装 nxt-python（python 接口来控制/编程我的乐高 mindstorm NXT -> [nxt-python](http://code.google.com/p/nxt-python/wiki/Installation)）。

# c# - C# 控制台程序，其中包含一个用于在输出主方法中显示文本的常量静态字段

> ID：11284695
> 
> 赞同：4
> 
> 时间：2012-07-01T18:40:19.150
> 
> 标签：c#

在 MicroSoft Visual Studio 2010 中使用 C# 作为控制台程序，在你们的帮助下，我对此进行了一些更改，并且该控制台程序运行正常；但是我需要实现一个常量静态字段，该字段将在 main 方法的输出部分显示座右铭“遵守女童子军法”。我知道这一定很简单，所以请多多包涵。当我在低音类中包含 public static const string Motto = "To Obey the Girl Scout Law" 时，我收到一条错误消息 - 常量 'DemoScouts.GirlScout.Motto' 不能是静态的。以下是该项目的完整代码：

公共课女童子军{

```
 public static const string Motto = "To Obey the Girl Scout Law";  

    public static string scoutName;
    public static string enterName()
    {
        return scoutName;
    }

    public static int duesOwed;
    public static int enterAmount()
    {
        return duesOwed;
    }

    public static int troopNumber;
    public static int enterNumber()
    {
        return troopNumber;
    }
}

class MainClass : GirlScout
{
    static void Main()
    {
        Console.WriteLine();
        Console.Write("Enter the Girl Scout's name: ");
        GirlScout.scoutName = Console.ReadLine();
        Console.WriteLine();

        Console.Write("Enter their Troop Number: ");
        string n = Console.ReadLine();
        GirlScout.troopNumber = Int32.Parse(n);
        GirlScout.enterNumber();
        Console.WriteLine();

        Console.Write("Enter the amount they Owe in Dues: $");
        string d = Console.ReadLine();
        GirlScout.duesOwed = Int32.Parse(d);
        GirlScout.enterAmount();
        Console.WriteLine();

        // Seperate the input from the output:
        Console.WriteLine();
        Console.WriteLine(GirlScout.Motto);
        Console.WriteLine("-----------------------------------------------");
        Console.WriteLine();

        // Display the new information:
        Console.WriteLine("The name of the Girl Scout is: {0}", GirlScout.scoutName);
        Console.WriteLine("The troop Number of the Girl Scout is:   {0}", GirlScout.troopNumber);
        Console.WriteLine("The amount of Dues Owed by this Girl Scout is: {0}", GirlScout.duesOwed);

        // Keep the console window open in debug mode.
        Console.ReadKey();
    }
} 
```

}

任何和所有的建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-01T18:42:45.770

您没有对用户输入的名称做任何事情：

```
Console.Write("Enter the Girl Scout's name: ");
Console.ReadLine(); 
```

应该是这样的：

```
Console.Write("Enter the Girl Scout's name: ");
GirlScout.scoutName = Console.ReadLine(); 
```

您还需要将类型更改`scoutName`为 a`string`而不是`int`.

* * *

你还应该重新设计你的班级。使用实例属性而不是静态字段。

```
public class GirlScout
{
    public string Motto { get; set; }
    public string ScoutName { get; set; }
    public int DuesOwed { get; set; }
    public int TroopNumber { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T18:42:31.403

您不会像处理其他数据那样存储用户输入的名称。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-01T18:43:45.083

我没有看到分配给`GirlScout.scoutName`...

旁注：请考虑不使用静态属性（除非它是分配的目标）。要么创建具有正常属性的对象，要么根本不使用它们......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T18:45:13.333

好吧，您从未初始化 scoutName 的值，那么您希望打印什么？

我认为您缺少这样的一行代码：

```
GirlScout.scoutName = Console.ReadLine(); 
```

不过，我不得不说，你的课程设计得很糟糕。你有公共数据成员，你的方法似乎没有目的或意义——你应该重温封装，并使你的变量私有。使用方法来更改/获取它们的值。

如果您需要任何帮助，请在评论或其他问题中提问。

# php - Google Drive PHP SDK 保存一个未命名的文件

> ID：11284700
> 
> 赞同：1
> 
> 时间：2012-07-01T18:40:57.173
> 
> 标签：php, google-drive-api

我正在使用以下函数插入文件：

```
function insertFile($service, $title, $description, $parentId, $mimeType, $filename) {
  $file = new DriveFile();
  $file->setTitle($title);
  $file->setDescription($description);
  $file->setMimeType($mimeType);
  if ($file->parentId != null) {
    $parentsCollectionData = new DriveFileParentsCollection();
    $parentsCollectionData->setId($file->parentId);
    $file->setParentsCollection(array($parentsCollectionData));
  }
  try {
    $datafile = file_get_contents($filename);
    $createdFile = $service->files->insert($file, array(
      'data' => $datafile,
      'mimeType' => $mimeType,
    ));
    print_r($datafile);
  return $createdFile;
  } catch (Exception $e) {
    print "An error occurred: " . $e->getMessage();
  }} 
```

该函数上传文件，但没有标题。它会在我的 Google Drive 中创建一个“无标题”文件。我正在使用 API v2。

打印_r（$文件）：

```
DriveFile Object
(
[mimeType] => text/plain
[thumbnailLink] => 
[__labelsType:protected] => DriveFileLabels
[__labelsDataType:protected] => 
[labels] => 
[__indexableTextType:protected] => DriveFileIndexableText
[__indexableTextDataType:protected] => 
[indexableText] => 
[etag] => 
[lastModifyingUserName] => 
[writersCanShare] => 
[id] => 
[title] => test.txt
[ownerNames] => 
[sharedWithMeDate] => 
[lastViewedByMeDate] => 
[__parentsType:protected] => ParentReference
[__parentsDataType:protected] => array
[parents] => 
[exportLinks] => 
[originalFilename] => 
[description] => Description
[editable] => 
[kind] => 
[quotaBytesUsed] => 
[fileSize] => 
[createdDate] => 
[md5Checksum] => 
[embedLink] => 
[alternateLink] => 
[permissionsLink] => 
[modifiedByMeDate] => 
[downloadUrl] => 
[__userPermissionType:protected] => Permission
[__userPermissionDataType:protected] => 
[userPermission] => 
[fileExtension] => 
[selfLink] => 
[modifiedDate] => 
) 
```

print_r($createdFile):

```
Array
(
    [kind] => drive#file
    [id] => 0B7fGO53dEJzbUVJwVEFRc09PMkk
    [etag] => "ia2FSHMEjvcFQvtI43H5NSXK_wk/MTM0MTI1MjU5MzA5Nw"
    [selfLink] => https://www.googleapis.com/drive/v2/files/0B7fGO53dEJzbUVJwVEFRc09PMkk
    [alternateLink] => https://docs.google.com/file/d/0B7fGO53dEJzbUVJwVEFRc09PMkk/edit
    [permissionsLink] => https://www.googleapis.com/drive/v2/files/0B7fGO53dEJzbUVJwVEFRc09PMkk/permissions
    [title] => Untitled
    [mimeType] => multipart/related; boundary=1411182904
    [labels] => Array
        (
            [starred] => 
            [hidden] => 
            [trashed] => 
            [restricted] => 
            [viewed] => 1
        )

    [createdDate] => 2012-07-02T18:09:53.402Z
    [modifiedDate] => 2012-07-02T18:09:53.097Z
    [modifiedByMeDate] => 2012-07-02T18:09:53.097Z
    [lastViewedByMeDate] => 2012-07-02T18:09:53.097Z
    [parents] => Array
        (
            [0] => Array
                (
                    [kind] => drive#parentReference
                    [id] => 0ALfGO53dEJzbUk9PVA
                    [selfLink] => https://www.googleapis.com/drive/v2/files/0B7fGO53dEJzbUVJwVEFRc09PMkk/parents/0ALfGO53dEJzbUk9PVA
                    [parentLink] => https://www.googleapis.com/drive/v2/files/0ALfGO53dEJzbUk9PVA
                    [isRoot] => 1
                )

        )

    [downloadUrl] => https://doc-14-4c-docs.googleusercontent.com/docs/securesc/6eprdcqtdmlpnd2gmvdr6jlnlagf8s6i/9fqrnka0tci3gs14tff8ur996h1b74ip/1341252000000/15694289178108491958/15694289178108491958/0B7fGO53dEJzbUVJwVEFRc09PMkk?h=16653014193614665626&e=download&gd=true
    [userPermission] => Array
        (
            [kind] => drive#permission
            [etag] => "ia2FSHMEjvcFQvtI43H5NSXK_wk/9STkNeCmz61YXorH3hoJimnEgfM"
            [id] => current
            [role] => owner
            [type] => user
        )

    [originalFilename] => Untitled
    [fileExtension] => 
    [md5Checksum] => 3e7959340ef7f8a8d24e5b9ad3daafe8
    [fileSize] => 407
    [quotaBytesUsed] => 407
    [ownerNames] => Array
        (
            [0] => Myszczuk
        )

    [lastModifyingUserName] => Myszczuk
    [editable] => 1
    [writersCanShare] => 1
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T21:29:27.817

照 Alain 说的去做，更新或签出来自 Google**的最新客户端库。**

# php - Chrome 中 move_uploaded_file 的 PHP 问题

> ID：11284708
> 
> 赞同：1
> 
> 时间：2012-07-01T18:41:47.080
> 
> 标签：php, file, upload, move

我对 Chrome 中的 move_uploaded_file 函数有疑问。

它在 IE 中完美运行。这是上传脚本（upload.php）：

```
<?php
session_start();
include "./global.php";

    $res = mysql_query("SELECT * FROM users WHERE id='".$_SESSION['uid']."'");
    $row = mysql_fetch_assoc($res);
    $userid = $row['id'];
    $targetFolder = "/var/www/picturebox/albums/$userid/";

    $tempFile = $_FILES['Filedata']['tmp_name'];
    var_dump($targetFolder.$userid."_");
    move_uploaded_file($tempFile,$targetFolder.$_FILES['Filedata']['name']);

?> 
```

的HTML：

```
<input type="file" name="file_upload" id="file_upload" /> 
```

读取 HTML 的函数：

```
$(function() {
    $('#file_upload').upload({
        'uploader' : 'upload.php'
    });
}); 
```

知道为什么它在 Chrome 中不起作用吗？在 Chrome 中，它将文件移动到“相册”，在 IE 中，它将文件移动到相册/用户 ID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:40:16.797

问题是我上周遇到了这个问题，这是一个新脚本，你通过 ajx 调用它，然后你得到一个新会话或错误的会话。尝试使用 php ajax 请求发送 session_id 并在另一端设置会话。

您可以通过参数发送 session_id。

```
$(function() {
    $('#file_upload').upload({
        'uploader' : 'upload.php?sid=<?php echo session_id(); ?>'
    });
}); 
```

您必须将实际会话 ID 写入脚本。您可以在脚本中设置一个 javascript 变量，然后在 javascript 中使用这是第二种可能性。

在您的 PHP 脚本中：

```
session_id($_GET['sid']); 
```

那么它的舒尔，你使用相同的会话。我希望它的工作。

# php - php的加密问题

> ID：11284712
> 
> 赞同：0
> 
> 时间：2012-07-01T18:42:19.500
> 
> 标签：php, ios, cakephp, cryptography, aes

在服务器上进行 AES256 加密，在 ios 上进行解密。很长一段时间都没有用，但我决定在加密之前对文本进行 64 位编码。

不小心我在 base64_encode($source) 周围放了大括号，然后就开始工作了。所以现在这个错误的代码有效（在 ios 上解密得很好）：

```
$ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, "base64_encode($source)", MCRYPT_MODE_CBC, $iv); 
```

正确的事情根本不起作用：

```
$ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, base64_encode($source), MCRYPT_MODE_CBC, $iv); 
```

如果这会有所作为，请使用 cake php。什么是错的，有什么区别？为什么大括号可以使事情正常工作而没有大括号它只会在解密时失败？对不起，如果这是一个非常愚蠢的问题，但我是密码学的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T23:50:22.460

您应该对纯文本进行字符编码（例如，使用 UTF-8，PHP 中有一个 utf8-encode 函数），然后如果要将结果作为字符串传输，则对结果进行 base64 编码。

请注意，mcrypt_encrypt() 的输出将无法与随机字节区分开来。这意味着可以输出任何字节，包括那些不是有效字符编码的字节（例如 00h 值字节或 C 中的 EOF）。由于 IV 是随机的（希望如此），有时一切看起来都很漂亮，有时您的解密会因为无效字符而失败。

使用加密，如果您不能完全控制（字符）编码/解码原则（没有那么多加密/解密），那么您可能偶尔会得到意想不到*的*结果——这正是您在编程时需要避免的事情。

# javascript - 一个 ajax 处理程序还是多个处理程序？

> ID：11284715
> 
> 赞同：0
> 
> 时间：2012-07-01T18:42:32.633
> 
> 标签：javascript, html, ajax

我的网页在使用时需要发送/接收几个ajax操作。目前我使用一个 ajax 处理程序来处理所有事件。所有 ajax 请求都使用这种格式“(type) | {json string}”发送/接收。

一段 js 代码将处理 ajax 请求/响应：解析响应文本 -> 获取类型 -> 选择...case 在每种类型的情况下做一些事情。

这可行，但随着 ajax 事件的增长，从 0 到 99 的情况太多了。那么维护或进一步开发不太可能是一件容易的工作。

也许我需要将单个 ajax 处理程序拆分为多个？那么浏览器如何知道应该将哪个 ajax 响应发送给特定的处理程序呢？

任何建议表示赞赏。

目前代码如下所示：（其中一个页面使用简单的 javascript，没有使用框架）

```
 xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    //alert(xmlhttp.responseText);
                    var reply = decodeArray(xmlhttp.responseText);  //convert to json object and some other stuff 
                    switch (reply.type) {
                          case 0:
                          case 1:
                          ....

                    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T18:56:54.337

这是软件工程面临的基本挑战之一。您有一项任务需要重复执行，但每个变化的细节都会略有变化，那么您如何重用代码并保持干净......每个实质性应用程序都有这个问题。

您需要使用一种设计方法来执行良好**的关注点分离**。我通常为我的应用程序开发与应用程序的其他部分完全分开的 API。我的 API 只做一件事和一件事——它与服务器通信。

**它没有特定于应用程序的代码**。

这意味着如有必要，我可以在不同的应用程序中重用我的 api。这也意味着我可以独立于应用程序测试我的 API。

所以可以说你需要做类似的事情`loadObject`。应用程序看到

```
App.API = {
    loadObject: function(params, onSuccess, onFail) {...}
} 
```

保持这种解耦的关键是`onSuccess`和`onFail`回调。使用 API 的应用程序传入这些函数；所以 API 对应用程序特定的逻辑一无所知——它只知道如果适当地触发这些回调。回调是接受作为响应数据的参数的方法；API 所做的只是将响应数据传递给回调。

因为大多数时候，你的 ajax 调用的细节有很多共同的项目，我也会创建一些`XhrWrapper`触发请求的类型。所以在你的`loadObjects`你会使用你的 xhr 助手来提出请求

```
xhr.sendRequest(url, method, onSuccess, onFail); 
```

这样就可以最大限度地减少烧制 xhrs 的所有乏味。

显然，您可以走得更远；例如，大多数时候失败是坏的，所以我的 xhr 包装器会有一个默认的 onFail 实现，并且特定的 API 方法可以传入一个覆盖，只有在有意义的情况下。

# ruby-on-rails - 如何将实例变量从 Rails 控制器发送到 BackBone 模型？

> ID：11284716
> 
> 赞同：0
> 
> 时间：2012-07-01T18:42:33.383
> 
> 标签：ruby-on-rails, backbone.js

假设我尝试在最终的 BackBone 视图中加载两个不同的对象。

**我的 Rails 控制器**

```
def index
  @visuals = Visual.all
  @words   = Word.all

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: [@visuals, @words] }
  end
end 
```

我可以在这里添加它：

**我的 Rails 视图：**

```
#visuals

:javascript
  $(function() {
    window.router = new AiProject.Routers.VisualsRouter({test_visuals: #{ @visuals.to_json.html_safe } });
    // AiProject.words = new Words(#{@words.to_json});
    //  ^^ Would this be the best place to insantiate my controller code's instance variable?
    Backbone.history.start();
  }); 
```

但其他人说把它放在你的模板中。这很奇怪，因为我认为我的 BackBone 的框架将它放在路由器中：

**咖啡BB路由器**

```
show: (id) ->
  visual = @visuals.get(id)

  @view = new AiProject.Views.Visuals.ShowView(model: visual)
  $("#visuals").html(@view.render().el) 
```

所以，如果是这样的话，也许我应该尝试在`@words`那里疯狂？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:46:03.780

编辑 - 这不是在谈论引导。

您需要在`index`某处调用该操作，可能直接通过`jQuery.ajax`，因为它不直接对应于单个主干模型或集合。

在您的 ajax 调用的成功处理程序中，您可以将返回的数据分配给您希望在主干中分配给它的任何内容。

我可能会有用于单一视觉效果和文字的模型，然后是每个模型的集合（在原始 javascript 中，因为我目前没有使用咖啡脚本）：

```
MyApp.Models.Visual = Backbone.Model.extend();
MyApp.Models.Word = Backbone.Model.extend();

MyApp.Collections.Visuals = Backbone.Collection.extend({
  model: MyApp.Models.Visual
});

MyApp.Collections.Words = Backbone.Collection.extend({
  model: MyApp.Models.Word
});

var visuals, words;

$.ajax({
  url: <path to index action>
  dataType: 'json',
  success: function (data) {
    visuals = new MyApp.Collections.Visuals(data[0]);
    words = new MyApp.Collections.Words(data[1]);
  }
}); 
```

在这一点上，你有你的`visuals`和`words`集合，并且可以对它们做任何你需要做的事情。

# mysql - 插入 PHP 时的 MySQL 编码

> ID：11284723
> 
> 赞同：0
> 
> 时间：2012-07-01T18:43:12.980
> 
> 标签：mysql, character-encoding

当我在 mySQL 表中插入名称时遇到编码问题，其中包含特殊字符，如“ö”、“ä”等。例如，单词“Öl”变为“Ã¶l”。

我试图将名称写入文本文件，然后它们会正确显示。

我尝试使用 SQL 语句在 phpMyAdmin 中插入名称，效果也很好。

现在我在`mysql_query('SET NAMES utf8;');`插入查询之前的设置中找到了解决方案。这是应该怎么做，还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:01:01.307

是的，运行 SET NAMES utf8；需要让 MySQL 在发送数据时知道客户端连接正在使用 ut8。您现在可以在 PDO 连接中定义它（如果您使用 PDO 连接到 MySQL）。

如果运行的 PHP 版本早于 5.3.6，则可以使用以下代码：

```
$pdo = new PDO(
'mysql:host=mysql.example.com;dbname=example_db',
"username",
"password",
array(PDO::MYSQL\_ATTR\_INIT\_COMMAND => "SET NAMES utf8")); 
```

否则使用以下内容：

```
$pdo = new PDO("mysql:host=localhost;dbname=world;charset=utf8", 'my_user', 'my_pass'); 
```

# c# - 完整（桌面）.NET 3.5 中的独立存储设置的模拟

> ID：11284724
> 
> 赞同：0
> 
> 时间：2012-07-01T18:43:14.523
> 
> 标签：c#, .net, silverlight, windows-phone-7

Desktop .Net 3.5 中是否有任何类似于 IsolatedStorageSettings（WP7、Silverlight）？

PS：我需要这个功能之王来工作。我必须从头开始实现这个文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T21:21:21.413

查看以下选项：[在 Windows 窗体应用程序中保存应用程序设置的最佳实践](https://stackoverflow.com/questions/453161/best-practice-to-save-application-settings-in-a-windows-application)

如果您需要移植应用程序，通过 IoC 解耦加载/保存设置可能更容易，然后只需使用上述问题中的选项实现接口即可。

# entity-framework - Visual Studio 2010 的 Db 上下文生成器缺少模板

> ID：11284725
> 
> 赞同：1
> 
> 时间：2012-07-01T18:43:18.140
> 
> 标签：entity-framework, entity-framework-5

我有 Vs2010 终极版。我安装了作为其中一部分的 asp.net mvc 4 和 EF 5。

Visual Studio 2010 的 EF 5 没有 db 上下文生成器模板。仅适用于下一个版本的 RC。

没有安装vs 2012。我有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T20:16:10.560

您可以在 VS 库中找到生成器 - [EF 5.x DbContext Generator for C#](http://visualstudiogallery.msdn.microsoft.com/da740968-02f9-42a9-9ee4-1a9a06d896a2)或[EF 5.x DbContext Generator for C# Web Sites](http://visualstudiogallery.msdn.microsoft.com/5d01a981-91b8-492c-b42c-c771c3f31e03)；两者都适用于 VS2012，但也许您可以使它们与 VS2010 一起使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T19:39:05.357

这是实现此目的的另一种方法：

*   在“**添加新项目”**对话框中，在您选择模板类型的左侧部分，单击“**在线模板”**，然后搜索您需要的内容。
*   在这种情况下，您将搜索**DbContext Generator**，您将获得许多类似于**EF 5.x DbContext Generator for C#**或**EF 4.x DbContext Generator for C# 的列表**。根据您安装的 EF 版本选择合适的版本。

这适用于 VS 2010 并且可以直接在 VS 2010 中使用，因此您无需人工处理任何事情。你应该准备好了。

干杯!

# javascript - 如何在 Opera 中从 Javascript 访问 8 位二进制数据？

> ID：11284728
> 
> 赞同：-3
> 
> 时间：2012-07-01T18:43:53.480
> 
> 标签：javascript, xmlhttprequest, opera, xmlhttprequest-level2

这个问题是关于 IE到 Opera 12 浏览器的[StackOverflow 问题](https://stackoverflow.com/questions/1919972/how-do-i-access-xhr-responsebody-for-binary-data-from-javascript-in-ie)的扩展。

根本问题是[geoxml3](http://code.google.com/p/geoxml3/issues/detail?id=63)处理kmz（压缩的kml）文件的问题。

[在 Opera 12 中失败的示例](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmztest_linkto.html)

二进制数据在 ZipFile.complete.js 的[修改版本中使用 TypedArrays进行处理](http://code.google.com/p/geoxml3/source/browse/branches/kmz/ZipFile.complete.js)

传输二进制文件后，Opera 12 中的 Uint8Array 未正确填充，就好像数据被导入为 16 位元素一样。

请求配置如下：

```
this.req.responseType = 'arraybuffer';
this.req.overrideMimeType('text/plain; charset=x-user-defined'); 
```

返回的值是这样处理的：

```
var fileContents = binStream.req.response;
binStream.length = fileContents.byteLength;
binStream.array = new Uint8Array(fileContents); 
```

在 Opera 12 中，前 8 个字节是这样填充的：

0x004B0050; 给出 4915280 的十进制值

但应该是：

0x4034B50; 十进制值 67324752。

这在 Firefox、Chrome 和 IE 中可以正常工作（有解决方法）。

有谁知道我如何说服 Opera 12 正确填充 Uint8Array？还是一种解决方法，以便它可以工作（某种方式将 16 位字节数组转换为 8 位字节数组，尽可能有效地丢弃不需要的高 8 位）？这是最近在 Opera 12 中实现 TypedArray/XmlHttpRequest 的已知错误吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T04:34:52.593

Opera 12.00 引入了对`responseType`; 不幸的是，其中有一个错误，这意味着给定一个`text/*`MIME 类型，您最终会将文件作为 16 位字。它已在 12.01 中修复，但最简单的修复方法是将覆盖类型设置为`application/octet-stream`. （这是 CORE-46938，适用于那些希望跟踪封闭错误跟踪器的人。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T21:20:21.470

这个“补丁”有效：

```
var fileContents = binStream.req.response;
binStream.length = fileContents.byteLength;
binStream.array = new Uint8Array(fileContents);

/* patch for Opera */
if (/opera/i.test(navigator.userAgent) && 
    // make sure it is still broken,
    // the first 4 bytes will contain the zip file signature
    // for the geoxml3 use case (so bytes 1 & 3 will not be 0)
    (binStream.array[1] == 0) && (binStream.array[3] == 0))
{    
    fixedArray = new Uint8Array(binStream.length/2);
    for (var i=0; i<binStream.length; i+=2) {
        fixedArray[i/2]=binStream.array[i];
    }
    binStream.array = fixedArray;
    binStream.length = binStream.length/2;
}
/* end patch for Opera */ 
```

有没有更有效的方法来做到这一点？有没有人知道不做浏览器特定测试的方法？

编辑：添加检查以确保行为仍然被破坏（以防它是一个错误并已修复）。在一般情况下可能不起作用，但对于 geoxml3 用例，前 4 个字节将包含 zip 文件签名，如果它正常工作，高位字节中不会有 0。

# javascript - 如何始终获取 JavaScript 中的最外层元素

> ID：11284729
> 
> 赞同：0
> 
> 时间：2012-07-01T18:43:53.130
> 
> 标签：javascript, html, events, dom

我有一堆 div 元素，都有一个特定的 id。这些div里面也是div。现在，如果我将 onclick 侦听器添加到最外层元素，它不会返回其 ID。也许一个例子可以更好地解释：

```
<div id="id1"><div id="bla1"></div></div>
<div id="id2"><div id="bla2"></div></div>
<div id="idn"><div id="blan"></div></div>

document.getElementById("id1").onclick = displayId;
document.getElementById("id2").onclick = displayId;
document.getElementById("idn").onclick = displayId;

function displayId(evt) {
    console.log(evt.target.id);
} 
```

如果我现在单击其中一个 div，它会显示内部 div 的 id。我怎样才能让它始终显示外部 dviv 的 id？

注意：内部 div 与外部 div 大小相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:49:28.567

使用`this`而不是`evt.target`引用处理程序绑定到的元素。

```
function displayId(evt) {
    console.log(this.id);
} 
```

# html - 干扰链接的 DIV 层

> ID：11284730
> 
> 赞同：0
> 
> 时间：2012-07-01T18:43:59.590
> 
> 标签：html, css

我有一些代码如下，我认为我的分层导致呈现的链接不可点击。这个例子中的一些我已经从外部 CSS 类转换为样式，以便于将其编写为一个小用例。这目前正在现代浏览器（最新稳定的 FF 和 Chrome）上进行测试。

```
<body>

<!-- whole container needs to be at z-index of -1 -->
<div id="container">

    <div class="corner" id="backgroundTopLeft"></div>
    <div class="corner" id="backgroundTopRight"></div>
    <div class="corner" id="backgroundBottomLeft"></div>
    <div class="corner" id="backgroundBottomRight"></div>

    <!-- whole container needs to be at z-index of 1 -->
    <div id="container2">

        <div id="headerSection"><img src="images/jClarity_logo.png" alt="logo" /></div>

        <div id="navigationSection">
            <a class="selected" href="#">Introduction</a><span class="menuDivider">|</span><a href="about.html">About</a>
        </div>

    </div>

</div> 
</body> 
```

和 CSS

```
@charset "utf-8";

/* Default margin, padding and font-family */
*
{
    font-family: Arial;
    margin: 0px;
    padding: 0px;
}

/* All images should have no borders by default */
img
{
    border: none;
}

/* Global styling for links, uses black as the color */
a
{
    color: #000000;
    text-decoration: none;
}

a.selected
{
    font-weight: bold;
}

a:hover
{
    color:#FF00FF;
}

#container
{
    position: relative;
    z-index: -1;
    height: 100%;
}

.corner
{
    position: absolute;
    height: 100px;
    width: 100px;
    background-color: #172944;
    z-index: -1;
}

#backgroundTopLeft
{
    top: 0px;
    left: 0px;
}

#backgroundTopRight
{
    top: 0px;
    right: 0px;
}

#backgroundBottomLeft
{
    bottom: 0px;
    left: 0px;
}

#backgroundBottomRight
{
    bottom: 0px;
    right: 0px;    
}

#container2
{
    position: relative;
    width: 100%;
    height: 100%;
    z-index: 1;
    opacity: 0.8;
    filter:alpha(opacity=80);
    background-image:url('../images/groovepaper.png');
}

/* The headerSection div, designed to fit in a centered logo */
#headerSection
{
    margin-left: auto;
    margin-right: auto;
    padding-bottom: 70px;
    padding-top: 54px;    
    height: 70px;
    width: 250px;
}

/* The navigationSection div, designed to fit in the menu */
#navigationSection
{
    padding-bottom: 15px;
    margin-left: auto;
    margin-right: auto;
    width: 600px;
    text-align: right;
}

.menuDivider
{
    color: #666666;
    padding-left: 5px;
    padding-right: 5px;
} 
```

一切看起来都很好（应用了许多其他纯颜色/字体大小的样式），但是 foobar.html 不可点击。

我很确定我在分层方面做错了什么，但我认为使用 z-indices 可以解决我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:01:24.087

工作正常[http://jsfiddle.net/hPkTu/](http://jsfiddle.net/hPkTu/)，如果问题出在 IE8 上，请使用 z-index:1; 众所周知，IE8 存在 z-index 的这个特殊问题。

**更新**你改变了你的问题，这里是你更新问题的工作 jsFiddle [http://jsfiddle.net/VjTXu/2/](http://jsfiddle.net/VjTXu/2/)。我将容器的 z-index 更改为 O，-1 使其位于正文下方，这就是为什么您的链接不可点击的原因，现在可以了。

# php - PHP-无法更改 xampp 中的 max_execution_time

> ID：11284731
> 
> 赞同：8
> 
> 时间：2012-07-01T18:44:01.050
> 
> 标签：php, time, web-crawler

我已经尝试了一切来更改`max_execution_time`php 爬虫脚本，以便它可以运行无限的时间。

我已将 php.ini 文件设置更改`max_execution_time`为`0`or`100000000`但没有更改

我也尝试通过使用从 php 脚本本身设置它`ini_set('max_execution_time', 0);`

所有 php 脚本都抛出相同的错误`Fatal error: Maximum execution time of 3000 seconds exceeded`，我可能会丢失什么以及如何确保没有最大执行时间限制？

**脚本**

```
<?php
ini_set('MAX_EXECUTION_TIME', -1);
error_reporting(E_ALL);  // turn on all errors, warnings and notices for easier debugging
//ini_set('max_execution_time', 123456);
ini_set('max_input_time', -1);
ini_set('memory_limit', '512M');
set_time_limit(0);
date_default_timezone_set('Europe/London');

/*code which scrapes websites*/

?> 
```

**phpinfo()**

```
max_execution_time  0   0
max_input_time     -1   -1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T06:44:31.163

尝试在php中关闭**安全模式**，然后尝试以下代码

```
if( !ini_get('safe_mode') ){ 
    set_time_limit(0); //this won't work if safe_mode is enabled.
} 
```

这应该允许您无限期地运行脚本。

在 Apache 中，您可以通过 .htaccess 使用此行更改最大执行时间

```
php_value max_execution_time 200 
```

[set_time_limit() php 手册参考。](http://php.net/manual/en/function.set-time-limit.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T06:50:57.997

[您不应该让您的爬虫在 apache 下运行，最好通过 cli 作为Gearman](http://gearman.org/)设置的一部分单独运行它。

这样它就不会占用你的网络服务器，它可以运行只要你想运行。您可以找到许多可以使用的 Gearman 绑定，当然包括 PHP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-10T12:10:22.317

利用

```
set_time_limit(0); 
```

在脚本的顶部

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T12:43:30.710

您也可以尝试`ignore_user_abort(TRUE);`在脚本中设置，因为它可能是浏览器超时而不是脚本。

来自 php.net 手册

```
<?php
// Ignore user aborts and allow the script
// to run forever
ignore_user_abort(true);
set_time_limit(0); 
```

请参阅此处了解更多信息

[http://www.php.net/manual/en/function.ignore-user-abort.php](http://www.php.net/manual/en/function.ignore-user-abort.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T19:14:32.660

在 WAMP 中有 3 个 PHP.ini 文件，因此您也可以在 xampp 中找到 3 个文件，因此只需使用 find 搜索它并替换`max_execution_time`为您正在设置的内容。但是你必须保持一些小而不是太大，以便快速运行你的应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-10T13:13:20.197

我在[xampp 文档](http://www.apachefriends.org/en/faq-xampp-windows.html#phpini)中找到了以下内容。也许您正在尝试编辑错误的 php.ini 文件？

> 为什么我的 php.ini 中的更改没有效果？
> 
> 从 XAMPP 1.7.1 开始，“php.ini”只在目录“\xampp\php”中。直到 XAMPP 1.7.0 位于目录“\xampp\apache\bin”中。
> 
> 如果“php.ini”中的更改无效，则 PHP 可能仍在使用另一个。您可以使用 phpinfo() 来验证这一点。转到 URI localhost/xampp/phpinfo.php 并搜索“加载的配置文件”。该值向您显示 PHP 真正使用的“php.ini”。
> 
> 信息：更改“php.ini”后，您必须重新启动 Apache，这样 Apache/PHP 才能读取新设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-08T14:49:15.140

如果您在 Windows 上，并且这是一个 CLI 运行脚本，则[可以阅读此](http://www.flipflops.org/2008/07/27/xampp-and-the-php-cli/).

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-13T12:47:23.497

您必须在 php.ini 中更改这两个（并通过在`phpinfo();`输出中查找位置来检查这是否是正确的 php.ini！）

```
max_execution_time = 0
max_input_time = 0 
```

然后检查是否某些 php 文件没有在本地覆盖这些变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-10T09:07:27.570

检查`phpinfo()`临时脚本并搜索`max_execution_time`. 确保它与您设置的值相同。默认应该是 30 秒。尝试将其更改为几个不同的值并重新启动 apache，然后检查该值`phpinfo()`以确认。

如果当您更改该值时，它会正确反映在 中，`phpinfo()`这意味着您的脚本中有一些代码正在更改该值。在您的代码中搜索两件事：

1.  搜索您的代码`ini_set()`并检查它是否已更改`max_execution_time`
2.  搜索`set_time_limit()`

这些函数可以更改脚本的最大执行时间限制。否则，您应该检查`.htaccess`可以设置此值的位置。但这也会影响`phpinfo()`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-12T16:58:02.753

您所做的只是将 设置为`max_execution_time`页面内的任何内容。您无法使用 ini_set 更改此设置。你可以改变`memory_limit`唯一的。

[在此处查看更多详细信息...](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time) 来自 php 官方网站。

如果您希望更改它们，请在 php.ini 中进行更改。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-18T11:58:39.800

打开php.ini记事本文件并搜索或查找`upload_max_filesize = 1000M`，您应该更改`Post_max_filesize = 1000M`然后重新启动您的xampp并刷新本地phpmyadmin ..

# batch-file - 如何使用批处理文件加入 2 行

> ID：11284732
> 
> 赞同：0
> 
> 时间：2012-07-01T18:44:03.633
> 
> 标签：batch-file

我有一个行数未知的文本文件，有些行以模式开头，我想将以模式开头的行与下一行连接起来，例如

```
name=jimmy
age=19 id=23423 site=www.xxx.com
bla bla
name=katy
age=15 id=234543 site=www.yyy.com
name=ross
age=29 id=54564 site=www.ZZZZ.com 
```

输出应该是

```
name=jimmy age=19 id=23423 site=www.xxx.com
 bla bla bla
name=katy age=15 id=234543 site=www.yyy.com
name=ross age=29 id=54564 site=www.ZZZZ.com 
```

所以模式是“名称”，它应该加入下一行我想使用 sed 但我不知道如何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T01:48:16.847

```
@echo off
setlocal EnableDelayedExpansion
set pattern=name
set patternLen=4
call :ProcessFile < input.txt > output.txt
goto :EOF

:ProcessFile
set line=
set /P line=
if not defined line exit /B
if "!line:~0,%patternLen%!" equ "%pattern%" (
   set /P nextLine=
   set "line=!line! !nextLine!"
)
echo !line!
goto ProcessFile 
```

以前的批处理文件的问题是它在输入文件的第一个空行处结束。但是，如果需要，可以修复此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T23:39:13.863

好吧，这是一个简单的脚本：

```
@echo off
setlocal enabledelayedexpansion
set "INPUT_FILE=input.txt"
set "OUTPUT_FILE=output.txt"
set prev=
for /f "tokens=*" %%f in (%INPUT_FILE%) do (
    for /f "tokens=1,2 delims==" %%g in ("%%f") do (
        if "!prev!" neq "" (
            echo !prev! %%f >>%OUTPUT_FILE%
            set prev=
        ) else (
            if "%%g" equ "name" (
                set prev=%%f
            ) else (
                echo %%f >>%OUTPUT_FILE%
                set prev=
            )
        )
    )
) 
```

# asp.net - 如何在 LINQ 中为值添加百分比？

> ID：11284734
> 
> 赞同：0
> 
> 时间：2012-07-01T18:44:17.317
> 
> 标签：asp.net, linq, linq-to-sql

如何使用 LINQ 将值的百分比添加到自身？例如，假设价格为 10 英镑。将这个价格的 6% 加到自身上可以得到 10.60 英镑。我的代码看起来像这样，尽管我想在`insert`语句中执行这个计算。

```
aPrice + aPercentage = bPrice 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:47:01.603

这样做的通常方法是

```
newPrice = price *1.06M; 
```

如果您有一个介于 0 和 100 之间的百分比值，请执行以下操作：

```
Decimal newPrice *= 1.0M + (PercentageVakye / 100M); 
```

注意：处理价格时始终使用 Decimal 而不是 Double。

# php - 如何访问 PHP 中的私有属性？

> ID：11284737
> 
> 赞同：0
> 
> 时间：2012-07-01T18:44:42.540
> 
> 标签：php, unit-testing, reflection, phpunit

> **可能重复：**
> [使用 PHPUnit 测试受保护方法的最佳实践](https://stackoverflow.com/questions/249664/best-practices-to-test-protected-methods-with-phpunit)

```
class Footer
{
  private $_isEnabled;

  public function __construct(){
    $this->_isEnabled = true;
  }

  public function disable(){
    $this->_isEnabled = false;
  }  
} 
```

当我在设置`_isEanabled`为 false 后为禁用功能编写单元测试时，我想断言它是否为 false。

但是我怎样才能访问`$_isEnabled`？

这是我的测试功能：

```
public function testDisable(){
  $footer = new Footer();
  $footer->disable();
  $this->assertFalse($footer->_isEnable);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:52:52.023

简短的回答：

你不能。这就是私人的意思...

长答案：

您可以使用反射来做到这一点：

[http://php.net/manual/en/book.reflection.php](http://php.net/manual/en/book.reflection.php)

但是，它有点复杂，并且添加了另一个容易失败的层，因此它不是测试的最佳方式......

我更喜欢创建一个 getter 函数：

```
public function getEnabled() {
   return $this->_isEnabled;
} 
```

但是，如果您还没有做到那么简单，我认为您不想创建它……但是考虑到其他选择，您可能会重新考虑它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:16:22.127

一个可访问的属性必须是公共的，我认为这是不言自明的。但是，您可能会遇到一些代码，其中受保护和私有属性似乎可以通过类似于访问公共变量的方式访问。

这是使用魔术 getter 方法完成的：

```
class Footer
{
    private $_isEnabled;

    public function __get($propName)
    {
        if (!isset($this->{$propName}))
        {
            throw new Exception($propName.' is not set');
        }
        return $this->{$propName};
    }
} 
```

每次您尝试访问不存在或不公开的属性时，都会调用此魔术方法。简而言之：

```
$instance->_isEnabled;//will work. 
```

您可以根据需要更改此方法，例如，不再需要下划线......您可以用它做很多事情。
请参阅[手册页](http://www.php.net/manual/en/language.oop5.magic.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T19:38:12.447

我怀疑由此获得积分：该课程不是“代数”完整的。A`public function isEnabled()`不见了。如果单元测试没有关于状态的信息，那么其他类客户端也会错过这个信息。

对私有内容的单元测试无助于在公共 API 上说明任何内容，但会检查*应该*很明显的内部操作。

一般来说，依赖于实现的单元测试是一件坏事；然后重新实现也使得维护单元测试。

# java - 将原始类型与 ClassLoader 一起使用

> ID：11284738
> 
> 赞同：5
> 
> 时间：2012-07-01T18:45:00.440
> 
> 标签：java, classloader, primitive-types

我有一段代码用于将传递的字符串表示形式`Class.getCanonicalName()`转换为相应的`Class`. 这通常可以使用`ClassLoader.loadClass("className")`. 但是，它在抛出`ClassNotFoundException`. 我遇到的唯一解决方案是这样的：

```
private Class<?> stringToClass(String className) throws ClassNotFoundException {
    if("int".equals(className)) {
        return int.class;
    } else if("short".equals(className)) {
        return short.class;
    } else if("long".equals(className)) {
        return long.class;
    } else if("float".equals(className)) {
        return float.class;
    } else if("double".equals(className)) {
        return double.class;
    } else if("boolean".equals(className)) {
        return boolean.class;
    }
    return ClassLoader.getSystemClassLoader().loadClass(className);
} 
```

这对我来说似乎*很*讨厌，所以有什么干净的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T18:57:48.700

既然你对此有一个例外：`Class.forName(int.class.getName())`，我会说这是要走的路。

检查 Spring 框架代码[http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/util/ClassUtils.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/util/ClassUtils.html) class, method `resolvePrimitiveClassName`，你会看到他们做同样的事情，但是带地图；）。源代码： http: [//grepcode.com/file/repository.springsource.com/org.springframework/org.springframework.core/3.1.0/org/springframework/util/ClassUtils.java#ClassUtils.resolvePrimitiveClassName%28java.lang .String%29](http://grepcode.com/file/repository.springsource.com/org.springframework/org.springframework.core/3.1.0/org/springframework/util/ClassUtils.java#ClassUtils.resolvePrimitiveClassName%28java.lang.String%29)

像这样的东西：

```
private static final Map primitiveTypeNameMap = new HashMap(16);
// and populate like this
primitiveTypeNames.addAll(Arrays.asList(new Class[] {
        boolean[].class, byte[].class, char[].class, double[].class,
        float[].class, int[].class, long[].class, short[].class}));
for (Iterator it = primitiveTypeNames.iterator(); it.hasNext();) {
    Class primitiveClass = (Class) it.next();
    primitiveTypeNameMap.put(primitiveClass.getName(), primitiveClass);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:50:21.987

只是为了让生活更有趣，你也会遇到数组问题。这解决了数组问题：

```
private Pattern arrayPattern = Pattern.compile("([\\w\\.]*)\\[\\]");

public Class<?> getClassFor(String className) throws ClassNotFoundException {
    Matcher m = arrayPattern.matcher(className);
    if(m.find()) {
        String elementName = m.group(1);
        return Class.forName("[L" + elementName + ";"); // see below
    }
    return Class.forName(className);
} 
```

[L(classname); 中的类名的包装；[- 我在这里](http://java.dzone.com/news/obtaining-array-class-java-ref)采购的。我看不到一种更清洁的方法，但我相信一定有一种。

当然，原始类型数组将需要一组进一步的特殊逻辑......

# google-apps-script - EventGuest getName() 方法不起作用

> ID：11284743
> 
> 赞同：1
> 
> 时间：2012-07-01T18:45:24.740
> 
> 标签：google-apps-script

我刚开始使用 Google Apps Script 进行编码。

我尝试编写一个简单的程序来从我的日历中提取事件并向这些事件中的所有客人发送电子邮件。

我遇到了2个问题：

1.  getName() 方法返回客人的电子邮件地址而不是姓名，即使该姓名是在我的 Google 联系人中定义的。（此外，如果没有定义名称，根据文档，它将返回 null）。

2.  我似乎无法使用 getCalendarsByName 方法。getCalendarByID 工作正常，但 getCalendarsByName 方法不返回所需的日历。我也尝试过 getOwnedCalendarsByName，但这也不起作用。

将不胜感激任何人的帮助。

**7/1 3.30pm 更新**：感谢@Serge insas，第二个问题已经解决。然而，第一个问题仍然存在。这是代码：

```
function myFunction() {
    var calendar = CalendarApp.getCalendarsByName('Test Calendar');
    Logger.log(calendar[0].getName());

    var today = new Date(); // get today's date
    Logger.log(today.toLocaleString());
    var endDate = new Date(); 
    endDate.setDate(today.getDate() +7); // set nextWeek's date to 7 days from today
    Logger.log(endDate.toLocaleString());

    var testEvents = calendar[0].getEvents(today, endDate);
    Logger.log(testEvents[0].getTitle());
    var guests = testEvents[0].getGuestList();
    Logger.log(guests[0].getName());
} 
```

这是日志输出：

```
Test Calendar
July 1, 2012 3:27:58 PM EDT
July 8, 2012 3:27:58 PM EDT
Test Event 1
duytri.nguyen07@gmail.com 
```

最后一行是我的电子邮件其他电子邮件地址，即使它已在我的联系人中命名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:09:48.947

该方法`getCalendarsByName()`返回一个数组（这就是日历上有一个“s”的原因），您是否在代码中通过在其后面添加 [0] 来考虑这一点（假设您只有一个具有此名称的 Cal 或者您想要它的第一个发生） ？

如果您提供一些您正在使用的代码，会更容易为您提供帮助。

（关于客人姓名，同样的评论：请提供您正在使用的代码。）

编辑：感谢您的代码。看来您是对的，*这似乎是一个问题；-/*

因为客人必须在联系人列表中才能获得他的名字我想你可以使用联系服务来获取客人的名字......作为一种解决方法......我会试着让你知道......

这应该可以，但是-我不知道为什么-它挂起而没有任何结果...也许您可以尝试一下？

```
var testEvents = calendar[0].getEvents(today, endDate);
Logger.log(testEvents[0].getTitle());
var guests = testEvents[0].getGuestList();
var guestmail = guests[0].getEmail();
Logger.log(guestmail);
var contact = ContactsApp.getContact(guestmail);
var name = contact.getFullName();
Logger.log(guestmail+'   '+name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T11:35:56.957

`ContactsApp`很棘手，它只能在用户运行脚本的联系人中搜索，而不是在全局联系人中搜索。在管理员帐户中仍然无法访问全局联系人列表。

# python - 如何在 Python 中创建静态框架 ASCII 接口？

> ID：11284748
> 
> 赞同：6
> 
> 时间：2012-07-01T18:46:03.087
> 
> 标签：python, terminal

当我`less`在我的 Mac 终端中使用该命令时，我会看到指定文件的 23 行切片。如果我向下移动文件，然后在终端窗口中向上滚动，我在当前切片之前看不到任何文件内容。相反，我看到了我在使用`less`.

我想使用这个或类似的效果来创建一个只显示当前屏幕，没有历史记录的 ascii 游戏界面。我会在屏幕上绘制我的框架并只更改这些框架中的文本或选项。这在大部分或完全在命令行环境中运行的旧系统中很常见。

是否有提供此功能的 Python 模块？这是我可以或应该自己实现的效果吗？

下面是一些可以从这种效果中受益的示例屏幕元素。

```
+-------------------------------------------------------------------+
|                                                                   |
| Dialog dialog dialog dialog dialog dialog dialog dialog dialog    |
| dialog dialog dialog dialog dialog dialog dialog dialog dialog    |
| dialog dialog dialog dialog dialog dialog dialog dialog dialog    |
| dialog dialog dialog dialog dialog dialog dialog dialog dialog    |
| dialog dialog dialog dialog.                                      |
|                                                                   |
|                                                                   |
|                                                                   |
+--------------------+---------------+------------------------------+
|   Attack           |     South     |            HP/Max   MP/Max   |
| > Cast Magic       |       -       |   Tom:    120/120   60/91    |
|   Use Item         |      New      | > Dick:    27/133   47/47    |
|   Tactics          |  Schwartzton  |   Harry:   87/104   16/113   |
+--------------------+---------------+------------------------------+ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-04-15T14:47:10.313

我也一直在为这个问题而苦苦挣扎。我想要一个简单的跨平台解决方案，所以我扩展[了 asciimatics](https://github.com/peterbrittain/asciimatics)以提供一组[小部件](http://asciimatics.readthedocs.org/en/stable/widgets.html)来创建这样的基于表单的 UI。例如：

[![文本 UI 小部件](../Images/beb51354844cbac4d4f50b540df0ac2d.png)](https://asciinema.org/a/45946)

生成的代码应该非常简洁，并且可以在任何现代操作系统（包括 Windows、Linux 和 OSX）上运行，而无需安装额外的本机库。正如您从[联系人列表示例](https://github.com/peterbrittain/asciimatics/blob/master/samples/contact_list.py)中看到的那样，标准小部件易于布局，应该可以满足您的大部分需求。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-01T18:55:39.230

我建议查看该[`curses`](http://docs.python.org/howto/curses.html)模块。它是库的一个接口`ncurses`，正是用于此目的（我相信许多终端应用程序都是用它编写的）。[文档](http://docs.python.org/library/curses.html)相当不错，并且有几个不错的教程[也](http://www.dev-explorer.com/articles/python-with-curses)应该让您朝着正确的方向前进。

（无论是那个还是自由使用`\r`。）我强烈推荐这个`curses`模块，因为它应该为你想要做的事情提供更多的灵活性。

编辑：如果您对创建跨平台应用程序感兴趣，请记住该`curses`模块仅在 *nix 系统上可用。根据文档：

> 没有人制作过 curses 模块的 Windows 端口。

该教程推荐在 Windows 上使用[这个库](http://effbot.org/zone/console-index.htm)，尽管如果下载页面上的日期有任何迹象，那么它在相当长的时间内还没有更新。您可以查看[这个模块](http://www.lfd.uci.edu/~gohlke/pythonlibs/#curses)，它看起来相当新。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T18:58:22.533

你说的是`curses`。它是一个与 ncurses 接口的 Python 模块。我发现使用的最好的教程`curses`是这个： http: [//www.dev-explorer.com/articles/python-with-curses](http://www.dev-explorer.com/articles/python-with-curses)

一些使用诅咒的流行程序（尽管来自另一种语言）是 aptitude 和 nano。

# android - 设置不会立即生效

> ID：11284752
> 
> 赞同：2
> 
> 时间：2012-07-01T18:46:40.747
> 
> 标签：android, android-activity, settings

每当我更改我的应用内设置（使用共享首选项）时，我都必须使用后退按钮并返回活动以使更改生效。我希望它们立即生效。我试着用

```
protected void onResume(){

super.onResume();

} 
```

但它不起作用。我究竟做错了什么？我的设置活动由菜单充气器调用，并在我单击保存按钮时完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:08:26.950

以下是一些需要注意的事项：

1.  您正在将新设置写入与正在使用的文件相同的文件，而不是不同的文件
2.  大多数人使用局部变量来存储运行到运行的设置。确保在更改设置后更新所有这些。一个很好的方法是有一个单独的方法，如 updateUserChoices()，并在`boolean sound = settings.getBoolean();`其中包含所有代码。然后只需在开始时调用此方法，并在更新设置后调用此方法。

# opengl-es - LibGDX - 精灵到像素图

> ID：11284755
> 
> 赞同：4
> 
> 时间：2012-07-01T18:47:02.477
> 
> 标签：opengl-es, sprite, textures, libgdx, pixmap

我正在将 LibGDX 用于一个小型应用程序项目，我需要以某种方式获取一系列精灵并将它们（或它们的像素）放入 Pixmap。基本思想是在应用程序运行时获取通过各种方式生成的随机精灵，并且仅在特定时间将其中的一些合并到单个背景精灵中。

我相信大部分这些都可以轻松完成，但是将精灵图像放入 Pixmap 的步骤对我来说并不是那么明显。精灵也有各种透明和半透明的像素，所以在每个像素都在同一个屏幕上时简单地抓取颜色也不是真正适用的，因为它显然不应该带上背景颜色。

如果有一个合适的替代方案可以完成我正在寻找的东西，我也很想听听。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T16:48:53.143

我认为您想将精灵渲染到屏幕外缓冲区（在 libgdx 中称为“FBO”或[FrameBuffer](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/FrameBuffer.html)）（在添加它们时将它们混合），然后将该屏幕外缓冲区作为单个绘图调用渲染到屏幕上？如果是这样，这个问题应该会有所帮助：[libgdx SpriteBatch render to texture](https://stackoverflow.com/questions/7551669/libgdx-spritebatch-render-to-texture)

这需要 OpenGL ES 2.0，这将消除对一些旧设备的支持。

# android - 有人可以解释一些关于在 Eclipse/Android 中启动活动的代码吗？

> ID：11284757
> 
> 赞同：0
> 
> 时间：2012-07-01T18:47:26.423
> 
> 标签：android, eclipse, android-activity

我正在尝试进入 Android 编程，但我无法理解[Google 教程](http://developer.android.com/training/basics/firstapp/starting-activity.html)

例如：

```
public void sendMessage(View view) {
    Intent intent = new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    String message = editText.getText().toString();
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
} 
```

我认为它`this`是一个变量还是为您的项目而改变？`=new intent(this....`

另外，有没有更简单的学习方法？理想情况下，我会有一些东西几乎可以从字面上解释围绕此的代码中的每个单词，我看过一本书，我认为这本书被称为“Head Start Android Programming”，它提供了相当丰富的信息。

总的来说，我只是对正确的做事方式感到非常困惑，以哪种方式开始活动，去哪里等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:54:56.403

> 我认为“这”是一个变量还是为您的项目而改变？

`this`是标准的 Java 语法，指的是正在执行其方法的对象。

> 另外，有没有更简单的学习方法？

首先，由于您似乎对 Java 不熟悉，因此我建议您先学习 Java，然后再尝试学习 Android 开发。有无数关于 Java 编程的书籍、Web 站点和培训课程。

其次，您上面的特定代码片段在学习 Android 开发方面相对较远——这应该是开发指南或教程集的几百页。

> 我看过一本书，我认为它被称为“Head Start Android Programming”，内容丰富。

你是相当幸运的，因为*Head First Android Development*似乎不再印刷，或者至少亚马逊不提供它。

# pycharm - pydev 调试器：严重警告：此版本的 python 似乎编译不正确

> ID：11284758
> 
> 赞同：0
> 
> 时间：2012-07-01T18:47:35.440
> 
> 标签：pycharm

我不知道如何解决这个 PyCharm 警告。将帐户迁移到新 Mac 后，我开始获得它。（我也刚刚更新了 PyCharm。）

另一个症状是 PyCharm 编辑器抱怨对诸如“logging.info()”之类的命令的方法的引用。即使当我运行我的应用程序时，它似乎运行良好。

而且......我也得到*PyCharm failed to generate skeletons*。我确实卸载并重新加载了 2.5 解释器，但仍然得到相同的结果。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:12:11.630

这可能是由损坏的 .pyc 文件引起的。有关详细信息，请参阅[http://bugs.python.org/issue1180193](http://bugs.python.org/issue1180193)。

您可以尝试从项目中删除所有 .pyc 文件并重新安装 Python。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:20:09.890

将我的整个存储库重新克隆到一个新位置，然后重新安装 Google 应用引擎导致此错误消失。另请注意，我尝试首先重新安装 OSX 以获得 Python 解释器的新副本，尽管它本身似乎并没有影响它。

编辑

切换到 2.7 和最终修复时遇到了同样的问题，正如我在这里找到的

[https://stackoverflow.com/a/11753554/497357](https://stackoverflow.com/a/11753554/497357)

是安装 Apple 的**命令行工具**（它似乎安装了显然已从标准 Mountain Lion 安装中删除的 Python 解释器源）。我从 Xcode 中安装

```
Xcode>Preferences>Downloads pane>Install. 
```

# java - 在 Eclipse 中，当我转到 File->New-Project 时没有 Android Project

> ID：11284763
> 
> 赞同：3
> 
> 时间：2012-07-01T18:49:05.577
> 
> 标签：java, android, eclipse, project

我已经下载了 Android SDK，设置了 AVD 并为 Eclipse 安装了必要的更新。我想我已经完成了所有工作，但是当我尝试单击文件-> 新项目时，我没有看到 Android 项目。有一个 Android 文件夹，其中包含以下内容：Android 应用程序项目、Android 测试项目、Android 示例项目等。我该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-01T19:18:03.740

[我以前回答过这个问题](https://stackoverflow.com/a/9257634/1029225)。基本上，您可以手动添加该选项，前提是您当然安装了 Android SDK：

> 窗口>自定义透视>菜单可见性>展开“文件”>展开“新建”>勾选“Android项目”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T22:04:56.900

是的，我试试看：

```
Window > Customize Perspective > Menu Visibility > Expand 'File' > Expand 'New' > Tick 'Android Project' is Visible, if not available "Android Project" please First Install ADT Plugin Don't Forget ... 
```

这里：http: [//developer.android.com/sdk/installing/installing-adt.html](http://developer.android.com/sdk/installing/installing-adt.html)

# c# - Gzipstream over tcp 不解压

> ID：11284764
> 
> 赞同：0
> 
> 时间：2012-07-01T18:49:11.523
> 
> 标签：c#, stream, compression, gzipstream

我正在尝试使用`protobuf-net`和 通过 tcp 连接发送序列化的压缩数据`GzipStream`

从 zipstream 中反序列化或读取只是阻塞并且没有完成。

为了测试它，我选择尝试使用更简单`FileStream`的方法来查看数据实际上正在被压缩和写入，事实就是如此。然而，该行`Console.writeLine(inPerson1.name)`抛出一个`Object reference not set exception`，因为它似乎没有从 zipstream 中读取任何数据。

关于为什么或我做错了什么的任何想法？

代码：

```
public void TestZipToFile(){
  var person1 = new Person { id = 1, name = "Pete" };
  var person2 = new Person { id = 2, name = "Sarah" };
  using (var file = File.Create("people.bin"))
  {
    GZipStream zs = new GZipStream(file, CompressionMode.Compress);
    Serializer.SerializeWithLengthPrefix<Person>(zs, person1, PrefixStyle.Fixed32);//.Serialize(file, foo);
    Serializer.SerializeWithLengthPrefix<Person>(zs, person2, PrefixStyle.Fixed32);//.Serialize(file, foo);
  }
  Person inPerson1 = null;
  Person inPerson2 = null;
  using (var file = File.OpenRead("people.bin"))
  {
    GZipStream ozs = new GZipStream(file, CompressionMode.Decompress);
    inPerson1 = Serializer.DeserializeWithLengthPrefix<Person>(ozs,PrefixStyle.Fixed32);//.Deserialize<Foo>(file);
    inPerson2 = Serializer.DeserializeWithLengthPrefix<Person>(ozs, PrefixStyle.Fixed32);//.Deserialize<Foo>(file);
  }
  Console.WriteLine(inPerson1.name);
  Console.WriteLine(inPerson2.name);
}

[ProtoContract]
public class Person
{
  [ProtoMember(1)
  public int id;
  [ProtoMember(2)]
  public string name;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T18:55:14.700

你永远不会关闭输出`GZipStream`，所以我怀疑它最终永远不会向底层流写入任何内容。您应该`using`为每个`GZipStream`以及`FileStream`.

# .net - 共享功能关注点

> ID：11284765
> 
> 赞同：2
> 
> 时间：2012-07-01T18:49:20.360
> 
> 标签：.net, vb.net

我正在使用以下内容`Shared Function`从 DB 中选择一个值。我担心的是，由于共享函数在所有对象之间共享，如果两个人几乎同时执行该函数，是否会发生这种情况，数据将被覆盖？

我的意思是从数据库返回的值将是最后（最近）执行的结果？

例如：

用户 1 执行函数，应该得到**“abcd”** 用户 2 执行函数，应该得到**“1234”**

用户 2 在用户 1 完成函数执行之前执行了函数。

但是两个用户都得到**“1234”**

```
Public Shared Function SelectScalar(ByVal _sql As String, ByVal _parameterNames() As String, ByVal _parameterVals() As String) As String
            Dim _returnVal As String
            Dim _connection As SqlConnection = Global.Connection.GetDbConnection()
            Dim _command As New SqlCommand(_sql, _connection)
            Dim _value As String

            Try
                If _parameterNames IsNot Nothing Then
                    For i = 0 To _parameterNames.Length - 1
                        _command.Parameters.AddWithValue(_parameterNames(i), _parameterVals(i))
                    Next
                End If

                _value = CStr(_command.ExecuteScalar)
                _returnVal = _value
            Catch ex As Exception
                _returnVal = Nothing
            Finally
                If _connection.State = ConnectionState.Open Then
                    _connection.Close()
                    _connection.Dispose()
                    _command.Dispose()
                End If
            End Try

            Return _returnVal
        End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:55:47.820

`Shared Function`s 不共享它们的“内部”状态，例如`_returnVal`. 每次调用方法时都会创建所有局部变量的单独实例，并且每次调用都会跟踪它们自己的变量集，当变量在`Shared Function`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:55:28.303

在这种情况下（数据访问方法的并发执行），决定用户将看到什么的不是代码——而是数据库的配置方式——查询的[隔离级别](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29)是什么。

我建议阅读MSDN 上的[SET TRANSACTION ISOLATION LEVEL (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms173763.aspx)以了解 SQL Server 中可用的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T18:55:53.430

在这种情况下，这不会是一个问题。这`_returnVal`是一个本地的，所以每个调用者都会得到它自己的`_returnVal`。他们是否同时运行并不重要，因为他们每个人都有自己的本地。

如果您将结果写入调用者共享的类字段，那么您可能会遇到您提到的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T06:47:27.440

假设`Global.Connection.GetDbConnection()` *没有*为两个并发呼叫提供相同的连接，正如所有其他答案所提到的，你会没事的。

如果多个调用获得相同的连接实例，您可能会出现一种竞争条件，即在另一个调用完成之前连接在一个调用上关闭。

# apache - Magento 媒体网址 - 摆脱 403 Forbidden

> ID：11284767
> 
> 赞同：0
> 
> 时间：2012-07-01T18:49:36.093
> 
> 标签：apache, magento, magento-1.4

在我的 Magento 网站（不是真正的 url ;) ）上，我有[http://magento.local.com/media/](http://magento.local.com/media/)作为 403 Forbidden 返回。

这似乎是所有 Magento 安装的标准配置，但我想更改它，并且不会为 /media/ 的请求返回 403。

我怎样才能做到这一点？

编辑：（添加更多信息和原因）

我希望 /media/ 不是 403，以便我可以将请求重定向到 /media/ 到 /media/index.html。

我认为一旦解决了 403，这个重定向会很容易，但不幸的是，事实并非如此。例如

```
RewriteRule ^$ /index.html [L,NC,R=301] 
```

根本不重定向/media/，并显示通常的“/索引”。

解决方案：将 DirectoryIndex 添加到 htaccess 文件

谢谢保罗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T19:07:10.993

将以下内容放入`.htaccess`您的目录：`media/`

```
Options All +Indexes
DirectoryIndex index.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T02:52:25.023

有什么要注意的。

媒体目录的标准 Magento .htaccess 如下：

```
Options All -Indexes
<IfModule mod_php5.c>
    php_flag engine 0
</IfModule>

# AddHandler cgi-script .php .pl .py .jsp .asp .htm .shtml .sh .cgi
Options -ExecCGI 
```

由于 Magento 期望在这个目录树上放宽权限，他们希望阻止执行和解释 php 和其他可能被恶意上传到目录树然后远程执行的脚本。只要保留此功能，您就可以进行修改。

# android - android中的应用程序启动过程..？

> ID：11284768
> 
> 赞同：0
> 
> 时间：2012-07-01T18:49:37.070
> 
> 标签：android

打开移动设备后（在启动过程之后），所有应用程序都将被加载，如系统应用程序、第 3 方应用程序等......这些应用程序是如何加载的意味着我想知道这方面的方式、程序或过程。谁能建议我任何网站或文档来了解这些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:55:39.180

这是使用 Android 中的 Intent 过滤器处理的。请参阅：http: [//developer.android.com/guide/components/intents-filters.html](http://developer.android.com/guide/components/intents-filters.html)

这个特定的过滤器是：

```
android.intent.action.BOOT_COMPLETED 
```

# string - scala string.split 不起作用

> ID：11284771
> 
> 赞同：35
> 
> 时间：2012-07-01T18:49:54.847
> 
> 标签：string, scala, split

以下是我的 REPL 输出。我不确定为什么 string.split 在这里不起作用。

```
val s = "Pedro|groceries|apple|1.42"
s: java.lang.String = Pedro|groceries|apple|1.42

scala> s.split("|")
res27: Array[java.lang.String] = Array("", P, e, d, r, o, |, g, r, o, c, e, r, i, e, s, |, a, p, p, l, e, |, 1, ., 4, 2) 
```

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-01T18:53:24.523

如果您使用引号，则您要求进行正则表达式拆分。 `|`是“或”字符，因此您的正则表达式不匹配或不匹配。所以一切都是分裂的。

如果你使用`split('|')`或者`split("""\|""")`你应该得到你想要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-01T18:56:34.030

`|`是一个特殊的*正则表达式*字符，用作操作的逻辑运算符*`OR`*。

由于[java.lang.String#split(String regex);](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29) 接受一个正则表达式，你用*"none OR none"*分割字符串，这是正则表达式分割的另一个特点，其中*none*本质上意味着*"在每个字符之间"*。

为了得到你想要的，你需要正确地转义你的正则表达式模式。要转义该模式，您需要在字符前面加上`\`and 因为`\`是一个特殊`String`字符（例如思考`\t`和`\r`），您实际上需要双重转义，以便最终得到`s.split("\\|")`.

有关完整的 Java 正则表达式语法，请参阅[java.util.regex.Pattern javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-01T18:55:56.490

Split 将正则表达式作为第一个参数，因此您的调用被解释为“空字符串或空字符串”。要获得预期的行为，您需要转义管道字符“\\|”。

# java - 收到错误 java.io.IOException：服务器返回 HTTP 响应代码：401

> ID：11284779
> 
> 赞同：7
> 
> 时间：2012-07-01T18:51:57.153
> 
> 标签：java, http-status-code-401

我正在尝试对 https url 进行身份验证，但我遇到了异常。下面是代码。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.io.StringWriter;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;

import javax.net.ssl.HostnameVerifier;
import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.SSLSession;

public class Authenticate {

    /**
     * @param args
     */
    public void authenticateUrl() {

        HostnameVerifier hv = new HostnameVerifier() {

            @Override
            public boolean verify(String urlHostName, SSLSession session) {
                System.out.println("Warning: URL Host: " + urlHostName
                        + " vs. " + session.getPeerHost());
                return true;
            }
        };
        // Now you are telling the JRE to trust any https server.
        // If you know the URL that you are connecting to then this should
        // not be a problem
        try {
            trustAllHttpsCertificates();
        } catch (Exception e) {
            System.out.println("Trustall" + e.getStackTrace());
        }
        HttpsURLConnection.setDefaultHostnameVerifier(hv);
        StringWriter sw = new StringWriter();
        PrintWriter pw = new PrintWriter(sw);
        try {
            URL url = new URL(
                    "www.stackoverflow.com");

            // Popup Window to request username/password password
            // MyAuthenticator ma = new MyAuthenticator();
            String userPassword = "user" + ":" + "pass";

            // Encode String
            String encoding = URLEncoder.encode(userPassword, "UTF-8");

            // or
            // String encoding = Base64Converter.encode
            // (userPassword.getBytes());

            // Need to work with URLConnection to set request property
            URLConnection uc = url.openConnection();

            uc.setRequestProperty("Authorization", "UTF-8" + encoding);
            InputStream content = (InputStream) uc.getInputStream();
            BufferedReader in = new BufferedReader(new InputStreamReader(
                    content));
            String line;
            while ((line = in.readLine()) != null) {
                pw.println(line);
            }
        } catch (MalformedURLException e) {
            e.printStackTrace();
            pw.println("Invalid URL");
        } catch (IOException e) {
            e.printStackTrace();
            pw.println("Error reading URL");
        } catch (Exception e) {
            e.printStackTrace();
        }
        sw.toString();
    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        Authenticate au = new Authenticate();
        au.authenticateUrl();
    }

    // Just add these two functions in your program

    public static class TempTrustedManager implements
            javax.net.ssl.TrustManager, javax.net.ssl.X509TrustManager {
        public java.security.cert.X509Certificate[] getAcceptedIssuers() {
            return null;
        }

        public boolean isServerTrusted(
                java.security.cert.X509Certificate[] certs) {
            return true;
        }

        public boolean isClientTrusted(
                java.security.cert.X509Certificate[] certs) {
            return true;
        }

        public void checkServerTrusted(
                java.security.cert.X509Certificate[] certs, String authType)
                throws java.security.cert.CertificateException {
            return;
        }

        public void checkClientTrusted(
                java.security.cert.X509Certificate[] certs, String authType)
                throws java.security.cert.CertificateException {
            return;
        }
    }

    private static void trustAllHttpsCertificates() throws Exception {

        // Create a trust manager that does not validate certificate chains:

        javax.net.ssl.TrustManager[] trustAllCerts =

        new javax.net.ssl.TrustManager[1];

        javax.net.ssl.TrustManager tm = new TempTrustedManager();

        trustAllCerts[0] = tm;

        javax.net.ssl.SSLContext sc =

        javax.net.ssl.SSLContext.getInstance("SSL");

        sc.init(null, trustAllCerts, null);

        javax.net.ssl.HttpsURLConnection.setDefaultSSLSocketFactory(

        sc.getSocketFactory());

    }
} 
```

**例外 ：**

```
java.io.IOException: Server returned HTTP response code: 401 for URL: 
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(Unknown Source)
    at Authenticate.authenticateUrl(Authenticate.java:62)
    at Authenticate.main(Authenticate.java:84) 
```

请任何人都可以建议如何解决此问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-01T19:24:34.130

401 错误代码表示“未经授权”。我相信您的代码没有正确编码 Authentication 标头。假设服务器需要*基本访问身份验证*，代码应如下所示：

```
String credentials = "ptt" + ":" + "ptt123";
String encoding = Base64Converter.encode(credentials.getBytes("UTF-8"));
URLConnection uc = url.openConnection();
uc.setRequestProperty("Authorization", String.format("Basic %s", encoding)); 
```

[RFC 2617](http://www.ietf.org/rfc/rfc2617.txt)中提供了 HTTP 基本和摘要身份验证方案的全面描述

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-16T10:05:22.410

另一种简单的方法是使用**Authenticator**。

从文档

> **Authenticator**类表示一个知道如何获得网络连接身份验证的对象。通常，它会通过提示用户输入信息来做到这一点。

```
URL url = null;
try {
    url = new URL("YOUR_URL");
    Authenticator.setDefault(new Authenticator() {
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication("YOUR_USERNAME","YOUR_PASSWORD".toCharArray());
        }
    });
}catch (MalformedURLException ex) {
        e = new WebServiceException(ex);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-25T14:15:51.550

在这里您可以处理错误代码 401。使用 HTTPURLCONNECTION 这是我的代码，请检查您是否可以帮助

```
URL Url = new URL(<your url string>);
HttpURLConnection connection = (HttpURLConnection) Url.openConnection();
connection.setRequestProperty(<your request header);
connection.setRequestMethod("GET");
connection.setDoInput(true);
connection.connect();

int responseCode = connection.getResponseCode();

if (responseCode == 200) 
    { InputStream is = connection.getInputStream();
      if (is != null) 
         { BufferedReader rd = new BufferedReader(new InputStreamReader(is));
                        response = rd.readLine();
                    }
} else { InputStream is = connection.getErrorStream();

          BufferedReader rd = new BufferedReader(new InputStreamReader(is));

      response = rd.readLine();

} if (response != null)
        AppLog.e("Response-->", response); 
```

# cuda - CUDA：为什么每个块有超过 8 个线程会有好处？

> ID：11284783
> 
> 赞同：4
> 
> 时间：2012-07-01T18:52:50.470
> 
> 标签：cuda

我是一名使用 CUDA 进行数值积分的数学家。我的理解是每个 Nvidia 流式多处理器都有 8 个 CUDA 内核。所以对我来说，每个块使用超过 8 个线程似乎没有任何好处。然而，当我运行我的代码时，通过使用每个块 32 个线程而不是每个块 8 个线程，我获得了巨大的性能提升。

我还注意到使用超过 12 个块可以获得巨大的收益（即使我的卡只有 12 个流式多处理器）。

是否有一个原因？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-01T23:07:47.277

talonmies 和 chaohuang 在评论中提供了很好的信息，你应该调查一下（不知道为什么这些不是答案，但这是他们的电话）。无论如何，我将提供一个简短的部分答案来解释您可能不会考虑的事情。

假设您有 8 个控制线程和 8 个处理器。如果所有 8 个线程中的所有指令都是片上指令，只需要一个周期，那么所有 8 个线程将在`n`周期内完成（假设`n`每个线程的总指令数）。

现在假设每个控制线程都由`n`指令组成，其中一小部分`r`是片外存储器指令，例如需要 100 个周期才能完成。这 8 个线程现在需要`[(1 - r) + 100r]n`循环才能完成。如果`r=0.1`，这大约是前一种情况的 11 倍。

现在假设我们有 16 个线程。当第一批 8 个线程在慢操作上阻塞时，其他线程可以执行；片上指令可以执行，片外指令可以启动。因此`2[(1 - r) + 100r]n`，您可能只需要多一点，而不是需要循环来完成所有线程`[(1 - r) + 100r]n`。本质上，因为您有一些空间可以将等待线程与其他线程重叠，所以您可以免费添加更多线程。

这就是 GPU 模型的强大之处：大规模并行性可以克服长延迟。做一点点工作需要很长时间，但做更多工作需要的时间不多。`r`请注意，当算术强度（与上述公式相关）很高时，占用率 - 与您准备隐藏延迟的工作量（在线程中）相关 - 对于峰值性能并不是那么重要。您可以使用 CUDA 占用计算器来查看我所描述的不同场景的效果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T17:50:15.217

简短的回答是延迟隐藏。

如果你的工作单元（线程和块）与你有核心工作一样多，并且执行会遇到需要数百个时钟周期才能完成的内存操作，那么 GPU 没有其他工作可做，所以核心处于空闲状态直到内存操作完成。那是在浪费计算周期。

如果您提供的工作单元多于您拥有的核心来完成工作，那么当其中一个工作单元遇到长延迟内存操作时，硬件调度程序可以将其他一些工作单元交换到核心中，以便当长延迟内存操作完成时，内核一直忙于进行生产性工作。当混合中存在长延迟内存操作时，过多的线程或块提供了使用所有计算周期的更好机会。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T02:42:24.037

基本上有两种方法可以隐藏 GPU 中的内存延迟：

1.  占用率增加，这意味着线程数超过了隐藏内存延迟所需的线程数。
2.  每个线程的独立操作增加。这会占用那些具有所需并行度的内核。

考虑这个计算机指令序列来计算大量元素。

```
a = b + c;
d = a + c; 
```

第二条指令将停止，因为它正在等待第一条指令的结果完成。

当您仅使用 8 个线程时，这些线程正在等待，GPU 内核处于空闲状态。但是，如果您有更多线程，GPU 可以在当前 warp 等待时安排其他元素的计算。这就是为什么当您增加线程数时，它的性能会更好。它更有效地利用 CPU 内核 =)

希望这会有所帮助~

# php - 保护 Web API 免受未经授权的使用

> ID：11284785
> 
> 赞同：2
> 
> 时间：2012-07-01T18:52:56.407
> 
> 标签：php, android, web-services, security, api

我想从一个新的 Android 项目开始，因此我需要一个集中式数据库。因为反编译java并获得数据库连接非常容易。对于我的项目，我需要读/写访问权限。

我的想法是用 php 创建一个 API 并从 Android 查询网站。

我看到的问题是，如果有人知道 API 的 url，他可以修改数据库......

所以我的问题是，如何保护基于 php 的 API 免受未经授权的访问？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T18:56:40.717

[查看请求签名，或像oAuth](http://oauth.net/)这样的预先存在的平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:02:10.933

您可以提供 OAuth 或 HTTP 签名等保护，这是最简单的方法，但 HTTP 签名在这里并不是很好，因为它太简单了。

您还可以使用设备已知的私钥，例如在您的应用程序中硬编码的内容。但是，如果有人找到此密码，您的保护就结束了。

您还可以检查 HTTP 标头以禁用某些用户代理，但它可以由“黑客”更改。

# python - 带有 python 2 的 Ubuntu

> ID：11284786
> 
> 赞同：1
> 
> 时间：2012-07-01T18:53:05.397
> 
> 标签：python, ubuntu, python-3.x, python-2.7

我很好奇——如果 Python 3 如此广泛传播，**为什么 Ubuntu 应用程序仍然使用 python 2？**

我已经开始学习这门语言，我很惊讶我看到的一些应用程序代码使用 python 2.7.x 并且在 python 3 解释器中运行时主要会导致致命错误。

我应该专注于学习 Python 2 还是我误解了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T18:55:52.100

许多拥有当前工作代码库的地方仍然使用 Python v 2.x，因为一些第三方软件/库尚未升级到 Python v3.x，但从长远来看，迁移到 v3 是不可避免的。

根据您的操作，您的 Python 2 代码可能无法在 v 3 下运行。这是[Python 3 中的新增功能，](http://docs.python.org/release/3.0.1/whatsnew/3.0.html)因此您可以自己查看其中的一些差异（还可以查看上面发布的有用链接 @Mark）。

如果您开始从头开始学习 Python，并且不需要访问仅适用于 v2 的 3rd 方库，我会继续学习 v3，否则学习 v2 很好。如果需要，可以在没有太多麻烦的情况下解决 v2 和 v3 之间的差异，因为您学到的关于 Python 编程的大部分内容仍然适用。

# javascript - 奇怪的 JavaScript 错误，由语法、Cytoscape Web 或 jQuery 引起

> ID：11284787
> 
> 赞同：3
> 
> 时间：2012-07-01T18:53:06.423
> 
> 标签：javascript, jquery, cytoscape-web

我正在使用 CytoscapeWeb 编写一个小型网络应用程序。它下载一个包含图形的 XML 文件，并显示它。我遇到了一个问题，它不会显示图表（而是显示一个空白图表），即使该文件已知是正确的。经过几天的代码搜索无济于事，我开始修改教程提供的示例代码以重现该问题。

此代码有效：

```
function get_network(filename)
{

    var output = "";

    $.ajax({url: filename, type: "GET", dataType: "text", success: function(result) { output = result; } });

    alert(filename);
    alert(output);

    return output;

} 
```

这段代码没有：

```
function get_network(filename)
{ 

    var output = "";

    $.ajax({url: filename, type: "GET", dataType: "text", success: function(result) { output = result; } });

    //alert(filename);
    //alert(output);

    return output;

} 
```

唯一的区别是两个 alert() 语句被注释掉了。当仅删除第一个语句 (alert(filename);) 时，警告框会显示一个空字符串。因此，空白图表似乎是由未正确设置输出变量的问题引起的。

我已经在 Firefox 和 Internet Explorer 中对此进行了测试。如果有一个警告语句打印字符串“ASDFSADF”而不是输出变量，它就会起作用。然而有趣的是，不使用 alert() 语句的代码，例如 'var junk = "ASDFSADF"' 不起作用。

所以在我看来，有三种可能性：

*   我犯了某种语法或逻辑错误，这使得解析的行数很重要
*   Cytoscape Web 以我无法想象的方式导致了这个问题
*   jQuery 没有调用“成功”函数

然而，我开始怀疑这个问题超出了我的专业知识，并且是由我没有考虑过的事情引起的。

然而，该语法错误可能在哪里超出了我的范围。我搜索了高低。有没有人见过这样的事情，或者知道正在发生这种情况？

非常感谢你的协助。

完整代码： [http](http://pastebin.com/rvcV3LFL)
://pastebin.com/rvcV3LFL XML 文件： http: [//pastebin.com/HCyuKQnx](http://pastebin.com/HCyuKQnx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T19:02:05.620

执行警报时未设置输出变量，因为 AJAX 调用是异步的（AJAX 中的 A 表示异步）。

AJAX 调用完成后需要发生的任何事情都需要作为回调传递。

因此，如果您的代码是这样的：

```
var graph = get_network(filename);
draw(graph); 
```

您需要将 get_network 更改为：

```
function get_network(filename,callback)
{ 

    var output = "";

    $.ajax({url: filename, type: "GET", dataType: "text", success: function(result) { 

    callback(result);
} 
```

然后调用代码将是

```
get_network(filename,draw); 
```

其中 draw 仍然是第一个示例中的函数

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T19:04:37.103

警报停止执行线程足够长的时间以使响应返回。如果您的服务器需要 10 秒来响应，而您在 5 秒后关闭警报，则它将无法正常工作。

jQuery ajax 函数并没有仅仅为了好玩而使用回调函数来使您的代码更丑陋，它之所以使用它是因为执行是异步的，并且响应仅保证在回调中可用。

在成功回调函数中运行您需要运行的任何代码，这取决于响应。

您已经使用`window.onload = function(){}`< 完成了此操作——只有该函数内的代码才能保证在窗口“加载”后运行。它外面的代码直接按顺序执行。对 ajax 做同样的事情。

# java - Java - IOException：无法打开文件：访问被拒绝

> ID：11284792
> 
> 赞同：3
> 
> 时间：2012-07-01T18:54:30.070
> 
> 标签：java, ioexception

我一直在用 Java 开发一些软件，这些软件将分发给 Windows 或 MacOS 使用。我目前正在 iMac 上编程（因为 Apple 的特定要求）。下面的方法是从资源中拖出一个帮助文件（.pdf），复制到本地，这样就可以在本地机器上显示了。

```
private void mHelpActionPerformed(java.awt.event.ActionEvent evt) {                                      
    String sourceFile = "resources/BRC2Help.pdf";
    String destFile = "brc2help.pdf";
    File f = new File (destFile);
    if (!f.exists()) {
            try {
            URL url = ClassLoader.getSystemResource(sourceFile) ;
            InputStream is = url.openStream();
            OutputStream os = new FileOutputStream(destFile);
            byte[] b = new byte[2048];
            int length;
            while ((length = is.read(b)) != -1) {
                os.write(b, 0, length);
            }
            is.close();
            os.close();
            System.out.printf("loaded pdf file from resources: %d bytes\n",f.length());
            } catch (IOException ex) {System.out.printf("loadPDF: %s\n",ex);}
    } else {
        System.out.printf("%s exists: %d bytes\n",destFile,f.length());
    }

    try {
        if (f.exists()) {
                f.setReadable(true);
                if (Desktop.isDesktopSupported()) {
                Desktop.getDesktop().open(f);
            } else {
                System.out.println("Awt Desktop is not supported!");
            }
        }
    } catch (Exception ex) {
        JOptionPane.showMessageDialog(this,
                String.format("%s\n",ex),
                "Helpfile Problem?",
                JOptionPane.ERROR_MESSAGE);
    }
} 
```

这一切在 Mac 上运行良好，但`IOException`在 Windows 7 上运行良好：

`java.io.IOException: Failed to open file:/C:/Program%20Files/BRC2/brc2help.pdf. Error message: Access denied.`

知道这里出了什么问题吗？我尝试将 .pdf 文件复制到其他位置，但结果是一样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:03:44.753

程序在 Windows 上运行时的工作目录是什么？运行程序的用户上下文可能没有写入权限`c:\Program Files\`。

您没有指定文件的路径，所以我假设这`c:\program files\brc\`是运行程序时的工作目录。从 Windows Vista 开始，您需要拥有完全的管理权限才能写入`Program Files`和其他目录。

**更新日期：2012 年 7 月 1 日**

好的，我能够存根您的程序并将其作为主类运行，并且能够`Desktop.getDesktop().open(f);`在 Windows 7 上打开 PDF 文件。我手动将 PDF 文件放入 Eclipse 将我的类文件编译到的 bin 目录中。

我现在需要尝试将类文件和 pdf 移动到的子目录中`c:\program files\`，看看是否收到您收到的拒绝访问异常。

`Desktop.getDesktop().open(f);`嗯，当 PDF 文件位于 时，我能够打开它`c:\program files\test\`，请参阅下面的输出：

```
C:\Program Files\test>"\Program Files (x86)\Java\jre7\bin\java.exe" MyTestClass
brc2help.pdf exists: 943123 bytes

C:\Program Files\test>dir
 Volume in drive C is OS
 Volume Serial Number is 2035-793F

 Directory of C:\Program Files\test

07/01/2012  10:25 PM    <DIR>          .
07/01/2012  10:25 PM    <DIR>          ..
07/01/2012  09:55 PM           943,123 BRC2Help.pdf
07/01/2012  09:57 PM             2,391 MyTestClass.class
               2 File(s)        945,514 bytes
               2 Dir(s)  567,516,254,208 bytes free 
```

你用的是什么JRE？我的是`java version "1.7.0_01" Java(TM) SE Runtime Environment (build 1.7.0_01-b08)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-06T23:28:13.453

I'm experiencing the same issue. Don't know the reason, but found a solution.

```
Runtime.getRuntime().exec("rundll32 SHELL32.DLL,ShellExec_RunDLL \"" + StringEscapeUtils.escapeJava(f.getAbsolutePath()) + "\""); 
```

you should use this only if the Desktop method fails, because this is only for Windows.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T19:28:05.810

我同意 HeatfanJohn 的观点，这绝对是一个权限问题。

尝试从命令行以管理员身份编译您的 java 代码。只需以管理员身份运行 cmd.exe，然后再次尝试编译/运行。

# javascript - 在 2 个浮动 div 之间创建一条线并适应移动

> ID：11284800
> 
> 赞同：1
> 
> 时间：2012-07-01T18:55:30.677
> 
> 标签：javascript, html, css

我有两个浮动 div，用户可以使用拖放重新定位它们。我想在两个 div 之间画一条线，让它根据 div 的移动自行调整（大小和位置）。

目标是在浏览器中获得某种类似图表流/图表的结构。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:19:30.840

如果您要做的不仅仅是*非常*基本的绘图/图形，那么我会推荐一个绘图库，例如 RaphaelJS。它为您大大简化了事情。看一个例子：http: [//jsfiddle.net/sveinatle/RVykE/1/](http://jsfiddle.net/sveinatle/RVykE/1/)

该示例不是一个完美的实现，但它显示了您从 Raphael 获得了多少帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:27:35.483

JS铅垂：

[http://jsplumb.org/jquery/demo.html](http://jsplumb.org/jquery/demo.html)

![在此处输入图像描述](../Images/f87c339097b01a561678f4d909d380fa.png)

SVG、画布或 VML

Jquery、Mootools 或 YUI

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T20:07:42.830

这是一个仅使用 HTML、jQuery 和一些三角函数的版本！
仍然需要一些调整，但大部分都在那里。

[http://jsfiddle.net/gKj35/2/](http://jsfiddle.net/gKj35/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T19:05:58.777

我可以想到三种方法：

1.  你可以使用 svg
2.  你可以使用 html 画布
3.  您可以使用纯 html（高度 = 1 的 div 将是水平线，而宽度 = 1 的 div 将是垂直线）。您可以组合这些线来创建线段。

# facebook - Facebook 在分享时不会加载正确的 META 标签

> ID：11284801
> 
> 赞同：1
> 
> 时间：2012-07-01T18:55:31.350
> 
> 标签：facebook, meta-tags

我在我的网站上为 Facebook 添加了 META 标签，根据[Object Debugger](https://developers.facebook.com/tools/debug) ，一切都像魅力一样。即使是抓取的页面对于网站上的特定页面也很好。

问题是，如果我将 URL 复制到照片（例如[P1220712](http://gallery.erik-edgren.nu/photo/P1220712)）并将其粘贴到“你在想什么？” 字段并等待它获取 META 标签，它显示[我网站首页](http://gallery.erik-edgren.nu/)的 META，而不是照片！

如果我在对象调试器中输入同一张照片的 URL 并等到它加载了包括照片在内的所有数据，然后对“你在想什么？”做同样的事情，它会加载照片的 META 标签和所有内容工作正常！

为什么会这样？它不应该在“你在想什么？”中从我的 URL 加载 META 标记吗？首先？

提前致谢。

# c - 使用 C 的硬件性能计数器

> ID：11284812
> 
> 赞同：0
> 
> 时间：2012-07-01T18:56:17.810
> 
> 标签：c, performance, hardware

> **可能重复：**
> [适用于 Windows 的硬件性能计数器 API](https://stackoverflow.com/questions/8764639/hardware-performance-counter-apis-for-windows)

我需要一些 C 示例代码来检索硬件性能计数器的值。我引用了 PAPI API，但它现在不支持 Windows。我的目标是检索在 Windows 系统中运行的每个进程的性能计数器。

提前致谢

# signal-processing - 初级 FFT 系数与低通滤波器

> ID：11284813
> 
> 赞同：0
> 
> 时间：2012-07-01T18:56:22.643
> 
> 标签：signal-processing, fft, feature-extraction, lowpass-filter

我正在研究信号处理问题。我正在提取一些特征来提供分类器。在这些特征中，有前 5 个 FFT 系数之和。如您所知，初级 FFT 系数实际上表明了信号的主要低频分量。这非常接近低通滤波器所提供的。

在这里，我怀疑计算 FFT 以获取前 5 个系数是否是不必要的任务。我认为应用低通滤波器只会消除低频分量，并且不会对初级 FFT 系数产生显着影响。然而，可能有一些其他方式与低通滤波器结合使用，以便在不使用 FFT 的情况下提取相同的信息（包含在前五个 FFT 系数中）。

您对这个问题有什么想法或建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T07:11:45.273

如果您只需要一个信号低频部分的指标，我建议您做一些非常简单的事情。只需使用一个普通的低通滤波器，例如二阶巴特沃斯，截止频率设置得当（如果我理解正确的话，在你的情况下为 5Hz）。然后计算窗口（长度 100）上的能量（平方和）或 rms 值。或者也许取低频能量与窗口总能量的比值，得到一个相对量度。这应该为您提供信号的低频贡献的一个很好的指标。

人们倾向于过度使用 fft 来完成各种非常简单的任务。在 90% 的用例中，fft 可以用更简单的算法代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T20:33:18.020

我似乎你应该看看[Goertzel Algorithm](http://www.mstarlabs.com/dsp/goertzel/goertzel.html)，至于你需要的看似有限的频率数量，它应该需要更少的计算。在更新每个样本的反馈部分后，您可以选择生成“特征度量”的频率或对结果进行一些额外的加权，可以产生可观的低通滤波器。

# iphone - 更改 UIImageView 的动画图像

> ID：11284819
> 
> 赞同：1
> 
> 时间：2012-07-01T18:57:34.713
> 
> 标签：iphone, objective-c, ios, cocoa-touch, sdk

在我的 iPhone 应用程序的 viewDidLoad 方法中，我有以下代码：

```
zombie[i].animationImages = zombieImages;
        zombie[i].animationDuration = 0.8/zombieSpeed[i];
        zombie[i].animationRepeatCount = -1; 
        [zombie[i] startAnimating]; 
```

稍后在应用程序中调用以下代码：

```
[zombie[i] stopAnimating];
                zombie[i] = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"zh.png"]];
                zombie[i].animationImages = flyingZombieImages;
                zombie[i].animationDuration = 0.8/zombieSpeed[i];
                zombie[i].animationRepeatCount = -1; 
                [zombie[i] startAnimating]; 
```

这会导致应用程序崩溃，EXC_BAD_ACCESS 在线`zombie[i].animationImages = flyingZombieImages;`

`flyingZombieImages`使用以下代码初始化：（`zombieImages`以相同的方式初始化）

```
NSMutableArray *flyingZombieImages = [NSMutableArray array];
    for (NSUInteger i=1; i <= 29; i++) {
        NSString *imageName = [NSString stringWithFormat:@"flzom%d.png", i];
        [flyingZombieImages addObject:[UIImage imageNamed:imageName]];
    } 
```

为什么会这样？有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:35:06.843

正如 Dima 提到的 flyZombieImages 可能没有正确初始化，这导致了崩溃。但是，当您创建 UIImageView 的新实例时，还有另一个问题：

```
zombie[i] = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"zh.png"]]; 
```

此时，您已经有了对存储在此变量中的旧 UIImageView 的引用。您正在丢失对它的引用，并且很可能会泄漏它的内存。您还希望从视图层次结构中删除旧的 UIImageView 并添加新的。

更好的方法是使用原始的 UIImageView 并通过将此行替换为以下内容来更改其图像：

```
zombie[i].image = [UIImage imageNamed:@"zh.png"]; 
```

# php - 解析随机stdClass

> ID：11284826
> 
> 赞同：2
> 
> 时间：2012-07-01T18:59:04.233
> 
> 标签：php

我似乎对此有点迷茫，我试图解析一些信息，但 stdClass 总是会发生变化，所以我不太确定该怎么做，可以使用来指导。

//询问

```
$query = new EntityFieldQuery;
$result = $query
  ->entityCondition('entity_type', 'taxonomy_term')
  ->propertyCondition('name', 'GOOG')
  ->propertyCondition('vid', '3')
  ->execute(); 
```

//这是输出

```
Array
(
    [taxonomy_term] => Array
        (
            [1868] => stdClass Object
                (
                    [tid] => 1868
                )

        )

) 
```

现在我可以使用 tid

```
$result['taxonomy_term']['1868']->tid 
```

但如前所述，stdClass 将始终在变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:03:35.323

您可以像这样使用递归数组搜索：

```
function array_searchRecursive( $needle, $haystack, $strict=false, $path=array() )
{
    if( !is_array($haystack) ) {
        return false;
    }

    foreach( $haystack as $key => $val ) {
        if( is_array($val) && $subPath = array_searchRecursive($needle, $val, $strict, $path) ) {
            $path = array_merge($path, array($key), $subPath);
            return $path;
        } elseif( (!$strict && $val == $needle) || ($strict && $val === $needle) ) {
            $path[] = $key;
            return $path;
        }
    }
    return false;
} 
```

**用法：**

```
$arr = (array) $yourObject;
$keypath = array_searchRecursive('tid', $arr); 
```

**例子：**

```
$class = new stdClass;
$class->foo = 'foo';
$class->bar = 'bar';
$arr = (array) $class;
$keypath = array_searchRecursive('foo', $arr);
print_r($keypath); 
```

**结果：**

```
Array
(
    [0] => foo
) 
```

所以现在要获得实际价值：

```
echo $keypath[0]; // foo 
```

# jsp - google map api 在第一个 jsp 页面加载时不显示

> ID：11284829
> 
> 赞同：1
> 
> 时间：2012-07-01T18:59:21.917
> 
> 标签：jsp, google-maps, jquery-mobile, web

我有一个为学校项目编写的 jsp 页面，我使用 jquery mobile 和 js 代码来显示业务位置....
我页面中的问题是，当控制器 servlet 指向时，用于显示地图的画布未显示那个页面。刷新后画布显示完全正常。有人可以帮我理解我做错了什么吗？
编码：

```
 <!DOCTYPE HTML>  
<%@page import="org.softwarelabs.mosheudi.hit.j2ee.db.Coupon"%>
<HTML>  
<head>  
<meta charset="UTF-8"> 
<title>coupon site</title> 
<% Coupon presentedCoupon = (Coupon)request.getAttribute("Requested coupon");
boolean addCalling = true;%> 
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>

    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>

<script type="text/javascript">
    if (screen.width > 699) {
        <%addCalling = false; %>
}</script>
<script>

var geocoder;
var map;
function initialize(myAddress) {
  geocoder = new google.maps.Geocoder();
  var latlng = new google.maps.LatLng(-34.397, 150.644);
  var myOptions = {
    zoom: 15,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  geocoder.geocode( { 'address': myAddress}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
}
function codeAddress(myAddress) 
{ 
  geocoder.geocode( { 'address': myAddress}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
      });
    } else {
      alert("Geocode was not successful for the following reason: " + status);
    }
  });
}
</script>

</head>
<body>

<div data-role="page" id="couponDetails" data-add-back-btn="true" style="background-color: #00B2EE"> 

    <div data-role="header">  
        <h1> Coupon information </h1>  

    </div> 

     <div data-role="content" data-inset="true" style="background-color: #00B2EE">

        <div class="ui-grid-b" id="couponInfo">

            <div class="ui-block-a" id="CtextDetails">  
            <h1> Coupon details </h1><br>
                <ul>
                    <h3> <%= presentedCoupon.getM_CouponName() %> </h3><br>
                    <p><strong> Price: <%= presentedCoupon.getM_CouponPrice() %>  </strong></p>
                    <p><strong> Expiration date:&nbsp;&nbsp; <%= presentedCoupon.getM_ExpireDate() %> </strong></p>
                </ul>
            </div>
            <div class="ui-block-b" id="couponImg">  
                <p><img src="<%=(presentedCoupon.getM_imgUrl() != null)?presentedCoupon.getM_imgUrl():"Images/pictures/question_mark.png" %>" alt="coupon photo" style="width: 80%"/></p>
            </div>
            <div class="ui-block-c" >
            <a href="#"  data-theme="e" ><img align="right" align="bottom" alt="buy" src="Images/pictures/buy-now.png" style="width: 40%"></a>
            </div>
        </div> <!-- couponInfo-->

                <img src="Images/pictures/line.png" alt="coupon photo" style="width: 100%"/>

        <div class="ui-grid-a" id="businessInfo">
            <div class="ui-block-a" id="BtextDetails">
            <h1> Business information </h1>  
                <ul>
                    <p><strong> <%=presentedCoupon.getM_Business().getBusinessName() %> </strong></p>
                    <p> <%=presentedCoupon.getM_Business().getM_BusinessAddress() %> </p>
                    <p>  Phone number : <%=presentedCoupon.getM_Business().getM_BusinessPhone() %></p>
                    <%if(addCalling){ %>
                    <a href="<%=presentedCoupon.getM_Business().getM_BusinessPhone() %>" data-mini="true" data-role="button" data-icon="info"> Call </a>
                    <%} %>
                    <div id="map_canvas" style="width: 300px; height: 300px;" onload="initialize('<%=presentedCoupon.getM_Business().getM_BusinessAddress()%>')"></div>
                </ul>
            </div>
            <div class="ui-block-b" id="businessImg">  
                <p><img src="<%=presentedCoupon.getM_Business().getM_imgUrl() %>" alt="business Image" style="width: 80%"/></p>
                <% if(addCalling){ %>
                <a href="useGPSHere"  data-role="button" rel="external" data-icon="search"> Navigate </a>
                <%}else{ %>
                <a href="https://maps.google.co.il/maps"  data-role="button" rel="external" data-icon="search"> Navigate </a>
                <%} %>
            </div>
        </div>
    </div><!-- content-->
</div>
<script>
    initialize('<%=presentedCoupon.getM_Business().getM_BusinessAddress()%>');
    </script>

</body>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T06:47:57.427

可能是加载问题，您是否尝试过将您的 google maps api 包含在您的头部的最顶部？顺便说一句，您不应该使用元素事件处理程序；而是退回到 jquery 方式，例如使用 jQuery(document).ready() 函数来监听页面的 onload 事件，如下所示：

```
 <!DOCTYPE HTML>  
<%@page import="org.softwarelabs.mosheudi.hit.j2ee.db.Coupon"%>
<HTML>  
<head>  
<meta charset="UTF-8"> 
<title>coupon site</title> 
<% Coupon presentedCoupon = (Coupon)request.getAttribute("Requested coupon");
boolean addCalling = true;%> 
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true"></script>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>

<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0; padding: 0 }
  #map_canvas { height: 300px; width: 300px; }
</style>

<script type="text/javascript">
    if (screen.width > 699) {
      <%var addCalling = false; %> //declare your variables with 'var'
    }

var geocoder;
var map;
function initialize(myAddress) {
  geocoder = new google.maps.Geocoder();
  var latlng = new google.maps.LatLng(-34.397, 150.644);
  var myOptions = {
    zoom: 15,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  geocoder.geocode({ 'address': myAddress}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
}
function codeAddress(myAddress) { 
  geocoder.geocode( { 'address': myAddress}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
      });
    } else {
      alert("Geocode was not successful for the following reason: " + status);
    }
  });
}
jQuery(document).ready(function() {
    var myAddress = '<%=presentedCoupon.getM_Business().getM_BusinessAddress()%>';
    initialize(myAddress); // call your init function from here
});
</script>

</head> 
```

Since there is no inline css style I suppose you were just setting the map_canvas size directly on the element by mistake (your style in the head says width 100%). You should put that in your head style as well. You can also remove the unnecessary closing/opening script tag before `var geocoder`.

# ios - 第一个视图中的委托方法不会从第二个视图中调用

> ID：11284831
> 
> 赞同：2
> 
> 时间：2012-07-01T19:00:06.510
> 
> 标签：ios, delegates, uinavigationcontroller

在一个视图中，我们称它为 firstView 我创建了一个 secondView，如下所示，如果在 firstView 中发生某些事情，则将其推送：

```
SecondViewController *secondVC = [[secondViewController alloc] initWithNibName:@"SecondViewController" bundle:nil];

    [self.navigationController pushViewController:secondVC animated:YES];
    [secondVC release]; 
```

现在，当我在 secondView 中时，如果假设按下按钮，我想返回到 firstView 并将一个值从 secondView 传递回 firstView（假设从 secondView 到 firstView 的文本字段的整数值）。

这是我尝试过的：

```
@protocol SecondViewControllerDelegate;

#import <UIKit/UIKit.h>
#import "firstViewController.h"

@interface SecondViewController : UIViewController <UITextFieldDelegate>
{
    UITextField *xInput;
    id <SecondViewControllerDelegate> delegate;
}

- (IBAction)useXPressed:(UIButton *)sender;

@property (assign) id <SecondViewControllerDelegate> delegate;

@property (retain) IBOutlet UITextField *xInput;

@end

@protocol SecondViewControllerDelegate
- (void)secondViewController:(SecondViewController *)sender xValue:(int)value;

@end 
```

并且在 m 文件中

```
- (IBAction)useXPressed:(UIButton *)sender
{
    [self.delegate secondViewController:self xValue:1234]; // 1234 is just for test
} 
```

然后在 firstView 我做了：

```
#import "SecondViewController.h"

@interface FirstViewController : UITableViewController <SecondViewControllerDelegate> {

}

@end 
```

并实施：

```
- (void) secondViewController:(SecondViewController *)sender xValue:(int)value
{
    [self.navigationController popViewControllerAnimated:YES];
} 
```

现在，问题在于 FirstViewController 中的一个我收到警告“没有找到协议“SecondViewControllerDelegate”的定义，并且对于两个委托方法（上面的最后一段代码）根本没有被调用。有人可以告诉我怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:08:13.043

在这条线之后

```
SecondViewController *secondVC = [[secondViewController alloc] initWithNibName:@"SecondViewController" bundle:nil]; 
```

添加

```
secondVC.delegate = self; 
```

也代替

```
- (void) secondViewController:(SecondViewController *)sender xValue:(int)value
{
    [self.navigationController popViewControllerAnimated:YES];
} 
```

你应该使用

```
- (void) secondViewController:(SecondViewController *)sender xValue:(int)value
{
    [sender popViewControllerAnimated:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:11:31.377

在`FirstViewController`.h 文件中：

```
#import "SecondViewController.h"

@interface FirstViewController : UITableViewController <SecondViewControllerDelegate> {

SecondViewController *secondViewController;

}

@end 
```

在实现文件中，您在其中初始化 SecondViewController 实例的下一行将 self 分配给委托属性：

```
secondViewController.delegate = self; 
```

接下来定义委托方法：

```
- (void)secondViewController:(SecondViewController *)sender xValue:(int)value
{
NSLog ("This is a Second View Controller with value %i",value)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T19:07:51.430

对于问题 1： 的`@protocol`定义`SecondViewControllerDelegate`看起来像在`secondViewController.h`; 你确定这个文件是导入的`firstViewController.h`吗？否则它不会知道协议。

问题2：它可能与问题1完全无关。你确定动作连接正确吗？您可以`NSLog()`在您的电话中调用`useXPressed:`以确保该方法实际上在您期望的时候被调用吗？

# php - 检查两个表中两列的值是否相等然后返回

> ID：11284836
> 
> 赞同：2
> 
> 时间：2012-07-01T19:01:04.203
> 
> 标签：php, mysql, sql, arrays, multidimensional-array

我有 2 个表如下： table1 有这些字段：

```
year,day,month,name 
```

table2 有这些字段：

```
years,gift 
```

我想返回年 = 年的行。这两个查询需要单独运行，这是一个条件。我不能将它们加入到 1 个查询中（我知道该怎么做，但不应该这样做）。有什么建议么？我想过使用 foreach 循环但未能实现，有什么想法吗？

```
$sql1 = " SELECT * FROM table1 ORDER BY id ASC";
  $result1 = mysql_query($sql1);
  $rows = mysql_fetch_array($result1);
    while($rows = mysql_fetch_array($result1))
  { 
  $year[]         = $rows['year'];
}

$sqlx = "SELECT * FROM table2";
  $result = mysql_query($sqlx); 

  while($row = mysql_fetch_array($result))
    {
$years[]         = $rows['years'];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:14:54.340

这是一个奇怪的要求，因为它*应该*通过连接来完成。在循环中使用多个查询执行此操作的效率远低于使用`JOIN`.

在任何情况下，如果您*必须*这样做，您已经从第一个查询中正确地将年份检索到一个数组中——使用该数组为第二个查询的每个循环迭代填充查询：

```
 $year = array();
  $sql1 = " SELECT * FROM table1";
  $result1 = mysql_query($sql1);
  if ($result1) {
    $rows = mysql_fetch_array($result1);
    while($rows = mysql_fetch_array($result1))
    { 
      $year[] = $rows['year'];
    }
  }

  // Will hold your output
  $gifts = array();
  // $year is now an array of years.
  // Loop over it to query table2:
  foreach ($year as $y) {
    // Make sure it is an integer...
    $y = intval($y);
    // And query table2 using $y as a WHERE condition
    $sql2 = "SELECT years, gift FROM table2 WHERE years = $y";
    $result2 = mysql_query($sql2);
    if ($result2) {
       while($row = mysql_fetch_array($result2)) {
         // Append all rows to the $gifts array
         $gifts[] = $row;
       }
    }
  }

  // They're now all in the array $gifts.
  var_dump($gifts); 
```

### 更新：

> 表 1 中的年份是以年为单位的期间。表中的年份是创建帐户的日期。所以我必须在table2上找到今天日期与年份的差异。然后查看它是否与 table1 上的任何行匹配。并返回匹配的结果

这可以通过`JOIN`使用日期函数的创意来完成。假设`table2.years`是`DATE`or `DATETIME`，用于`YEAR()`仅返回其中的年份部分，并将其`YEAR(CURDATE())`与当前年份进行比较。加入这个反对年数`table1.year`。

```
SELECT 
  table1.*, 
  table2.*
FROM 
  table1
  JOIN table2 
    ON table1.year = (YEAR(CURDATE()) - YEAR(table2.years)) 
```

# c# - 从类文件中捕获异常到 aspx.vb 页面

> ID：11284839
> 
> 赞同：0
> 
> 时间：2012-07-01T19:01:36.767
> 
> 标签：c#, asp.net, vb.net

此函数位于文件`App_Code`夹中的 Class 文件中

```
 Public Shared Function CRUD(ByVal _sql As String, ByVal _parameterNames() As String, ByVal _parameterVals() As String) As Integer
        Dim _noOfRowsAffected As Integer
        Dim _connection As SqlConnection = Global.Connection.GetDbConnection()
        Dim _command As New SqlCommand(_sql, _connection)

        Try
            If _parameterNames IsNot Nothing Then
                For i = 0 To _parameterNames.Length - 1
                    _command.Parameters.AddWithValue(_parameterNames(i), _parameterVals(i))
                Next
            End If

            _noOfRowsAffected = _command.ExecuteNonQuery()
        Catch ex As Exception
            'MsgBox(ex.Message)
            _noOfRowsAffected = -1
        Finally
            If _connection.State = ConnectionState.Open Then
                _connection.Close()
                _connection.Dispose()
                _command.Dispose()
            End If
        End Try

        Return _noOfRowsAffected
    End Function 
```

此代码在 aspx.vb 页面中

```
Protected Sub btnSave_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSave.Click
        Dim _parameterNames(6), _parameterVals(6) As String
        _parameterNames(0) = "@Name"
        _parameterVals(0) = txtCoachingName.Text
        _parameterNames(1) = "@Address"
        _parameterVals(1) = txtCoachingAddress.Text
        _parameterNames(2) = "@Mob1"
        _parameterVals(2) = txtCoachingMob1.Text
        _parameterNames(3) = "@Mob2"
        _parameterVals(3) = txtCoachingMob2.Text
        _parameterNames(4) = "@LLine"
        _parameterVals(4) = txtCoachingLLine.Text
        _parameterNames(5) = "@Established"
        _parameterVals(5) = ddlCoachingEstablished.SelectedValue
        _parameterNames(6) = "@DemoVideo"
        _parameterVals(6) = txtCoachingDemoVideo.Text
        _parameterNames(7) = "@Password"
        _parameterVals(7) = txtCoachingPassword.Text
         Try
        DataAccess.CRUD("UPDATE CoachingDetails SET Name=@Name,Address=@Address,Mob1=@Mob1,Mob2=@Mob2,L_Line=@LLine,Established=@Established,Demo_Video=@DemoVideo,Password=@Password,Step_Completed='True',Time_Stamp='" & Date.Now & "'", _parameterNames, _parameterVals)
    Catch ex As Exception

    End Try 
```

现在我想`Primary Key Violation`在我的页面中捕获异常`aspx.vb`..但是我没有在`aspx.vb`页面中得到异常，因为错误被类函数捕获。那么，我如何从类文件中获取异常到 aspx.vb 文件?? 结束子

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:05:17.637

[重新抛出](http://www.selfelected.com/rethrow/)。(http://www.selfelected.com/rethrow/)

```
Try
    ....
Catch ex As Exception 
    do some stuff with ex
    Throw    ' important to not use ex as parameter as that would start a new exception stack.
Finally
    do some other stuff
End Try 
```

由于您在 catch 中不做任何事情，因此请跳过它。

```
Try
    ....
Finally
    do some other stuff
End Try 
```

为了使代码更好地阅读[Using](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)。使用 Using，您可以让编译器为您隐式插入 Try/Finally。代码将类似于：

```
Using connection As SqlConnection = Global.Connection.GetDbConnection()
    Using command As New SqlCommand(sql, connection)
        If parameterNames IsNot Nothing Then
            For i = 0 To parameterNames.Length - 1
                command.Parameters.AddWithValue(parameterNames(i), parameterVals(i))
            Next
        End If
        noOfRowsAffected = _command.ExecuteNonQuery()
    End Using
End Using 
```

请注意，我将所有变量都设为本地。这对您来说可能是不可能的，因为您对代码的了解比我多得多......（但代码建议您的变量在类变量中，但无论如何您都将它们视为本地变量。）

另请查看[Dapper](http://code.google.com/p/dapper-dot-net/)。Dapper 是 Stack overflow 运行的。这是一个不错的小库，用于使编写 sql 调用更容易编写和阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:04:29.747

BCL 没有`PrimaryKeyViolationException`可以被捕获的。

最接近的方法是捕获`SqlException`并查看消息以查看 SQL Server 报告的问题是什么。这个`Catch`块应该在 catch 块*之上*`Exception`，因为它更具体。

```
Try
    If _parameterNames IsNot Nothing Then
        For i = 0 To _parameterNames.Length - 1
            _command.Parameters.AddWithValue(_parameterNames(i), _parameterVals(i))
        Next
    End If

    _noOfRowsAffected = _command.ExecuteNonQuery()
Catch ex As SqlException
    ' Do stuff - logging, checking the exception message etc...
    ' Rethrow exception if you want the exception to bubble up
Catch ex As Exception
    'MsgBox(ex.Message)
    _noOfRowsAffected = -1
Finally
    If _connection.State = ConnectionState.Open Then
        _connection.Close()
        _connection.Dispose()
        _command.Dispose()
    End If
End Try 
```

# java - 未捕获的异常：目标小程序或 JVM 进程突然退出 - 来自 firefox 扩展

> ID：11284843
> 
> 赞同：1
> 
> 时间：2012-07-01T19:02:13.157
> 
> 标签：java, firefox-addon, xul

我写了一个 Firefox 扩展。选择菜单项时，它会检查 Java 版本。当我尝试在 JavaScript 中调用 Java 类时，我遇到了这个异常：

> 未捕获的异常：目标小程序或 JVM 进程突然退出

这是在我休眠系统后发生的，如果我尝试使用我的 Firefox 扩展程序，则会收到此错误。如果我重新启动 Firefox，它会再次运行。我能做些什么呢？

Firefox 扩展 ( ) 的示例代码`overlay.xul`：

```
<?xml version="1.0"?>
<overlay id="RefMArc-overlay"
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
  <script>
    function onRclick_temp() {

        try {
            //chkJava: java.lang.String;
            var vers = java.lang.System.getProperty("java.version");
            var ind1 = vers.indexOf(".")+1;
            vers = vers.substring(ind1, vers.indexOf(".", ind1));

            if( vers < 5 ) {
                alert("You need to upgrade java");
                return;
            }

            // to do

        } catch(e) {
            alert("error:" + e);
        }

    }
    <menupopup id="menu_ToolsPopup">

      <menuitem id="helloworld-hello" label="helloworld" 
                oncommand="onMenuClick();" class="menuitem-iconic"/>
    </menupopup>
  </toolbox>
</overlay> 
```

# adt - 在 Eclipse ADT 中自定义 LogCat 列

> ID：11284844
> 
> 赞同：6
> 
> 时间：2012-07-01T19:02:16.807
> 
> 标签：adt, android-logcat

[这个 SO 线程](https://stackoverflow.com/q/10565001)表明可以从命令行自定义 LogCat 列。

是否可以对 Eclipse 中的 DDMS 视图执行相同的操作？

**更新：**我正在查看`ANDROID_LOG_TAGS`env var。看起来[很有希望](http://developer.android.com/tools/debugging/debugging-log.html#filteringOutput)。

# qt - OpenGL 上下文中的 Qt 对话框

> ID：11284846
> 
> 赞同：2
> 
> 时间：2012-07-01T19:02:49.203
> 
> 标签：qt, opengl, qwidget, qdialog

我从这个有点老的例子开始工作：http: [//doc.qt.nokia.com/qq/qq26-openglcanvas.html](http://doc.qt.nokia.com/qq/qq26-openglcanvas.html)

我理解该示例的方式是，使用窗口标志 CustomizeWindowHint 和 WindowTitle 提示添加到场景中的 QDialog 应该有一个类似于顶级对话框的标题栏。但是，当我运行该示例时，我没有标题栏。:(

我也尝试了其他几个标志，但我只看到一个没有标题栏的小 QLabel。

下面的代码：

```
QGraphicsView view;

view.setViewport(new QGLWidget(QGLFormat(QGL::SampleBuffers)));
view.setViewportUpdateMode(QGraphicsView::FullViewportUpdate);
view.setScene(new MyGLScene(0));

QDialog *dialog = new QDialog(0, Qt::CustomizeWindowHint | Qt::WindowTitleHint
                              | Qt::WindowCloseButtonHint | Qt::WindowMinimizeButtonHint);

dialog->setWindowOpacity(0.8);
dialog->setWindowTitle("Sample");
dialog->setLayout(new QVBoxLayout);

dialog->layout()->addWidget(new QLabel("Hello!"));
dialog->layout()->addWidget(new QPushButton("Ok", 0));

view.scene()->addWidget(dialog);
view.show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T16:24:05.367

我有同样的问题。该`addWidget`方法将小部件包装成一个`QGraphicsProxyWidget`. 由于某些原因，`QGraphicsProxyWidget`似乎忽略了标志或不通过它。

这就是我使用以下方法修复它的方式：

`view.scene()->addWidget(dialog, , dialog->windowFlags());`

您修改后的代码：

```
QGraphicsView view;

view.setViewport(new QGLWidget(QGLFormat(QGL::SampleBuffers)));
view.setViewportUpdateMode(QGraphicsView::FullViewportUpdate);
view.setScene(new MyGLScene(0));

QDialog *dialog = new QDialog(0, Qt::CustomizeWindowHint | Qt::WindowTitleHint
                              | Qt::WindowCloseButtonHint |         Qt::WindowMinimizeButtonHint);

dialog->setWindowOpacity(0.8);
dialog->setWindowTitle("Sample");
dialog->setLayout(new QVBoxLayout);

dialog->layout()->addWidget(new QLabel("Hello!"));
dialog->layout()->addWidget(new QPushButton("Ok", 0));

view.scene()->addWidget(dialog, , dialog->windowFlags());
view.show(); 
```

# mysql - 会话消息系统的表结构

> ID：11284858
> 
> 赞同：4
> 
> 时间：2012-07-01T19:04:57.140
> 
> 标签：mysql, database-design

我正在寻找一个消息系统来处理对话，就像 Facebook 的做法一样。我想知道关于表结构的最佳方法是什么。我会有一张像这样的桌子吗：

```
ID
reply_id - 开始对话的原始消息的 id
to_id
from_id
学科
内容
发送日期
读取状态

```

或两张表：

```
表 1 - 新消息的开始

ID
to_id
from_id
学科
内容
发送日期
读取状态

表 2 - 当有人回复消息时

ID
message_id
to_id
from_id
学科
内容
发送日期
读取状态

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:20:26.913

这取决于很多事情，但初步猜测可能是“消息”的自引用表。例如：

```
message:
  sender_id: User
  recipient_id: User
  in_reply_to_id: Message
  subject, content, etc 
```

消息如下所示：

```
 belongs_to :sender, :class => 'User'
  belongs_to :recipient, :class => 'User'
  has_many :replies, :dependent => :destroy
  belongs_to :in_reply_to, :class => 'Message' 
```

这将允许您建立一个回复树（因为一条消息可以是 in_reply_to 一条消息，而这条消息又可以是 in_reply_to 另一条消息）。您可能还想考虑使用类似[acts_as_ordered_tree](http://ordered-tree.rubyforge.org/)的东西来获得更大的灵活性和控制力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-01T19:16:30.117

我会说一张桌子。为什么要重复相同的数据？此外，当您的消息数据结构发生更改时，您将消除错误源，而不必关心另一个表与第一个表相同。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-07-01T19:50:57.150

真正的最佳答案是：MySQL 是构建电子邮件和聊天类型系统的极差工具。

消息系统已经存在。聊天系统已经存在。你为什么要重新发明轮子？

# function - 对 SAP 的 XML-RPC 调用

> ID：11284860
> 
> 赞同：1
> 
> 时间：2012-07-01T19:05:26.203
> 
> 标签：function, web-services, abap, xml-rpc

当客户端想要调用作为 Web 服务公开的功能模块或 BAPI 时，我试图弄清楚 SAP 期望的 XML-RPC 请求格式是什么。

例如，如果我试图在非 SAP java 对象上调用方法，则格式如下：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<methodCall>
    <methodName>Calculator.add</methodName>
    <params>
        <param>
            <value><i4>30</i4></value>
        </param>
        <param>
            <value><i4>9</i4></value>
        </param>
    </params>
</methodCall> 
```

我特别感兴趣`<methodName>`。在我的示例中，使用了典型的面向对象表示法，即`<object name>.<method name>`. 但是，SAP 函数模块和 BAPI 是平面函数调用，因此上述命名符号不适用。

有没有人有配置 SAP 系统以接受和响应此类 XMLRPC 调用的经验？`<methodName>`如果是这样，SAP 系统是如何准确配置的，为了正确地为调用者提供服务，它期望接收什么？或者换一种说法，调用者需要知道什么才能使用这样的服务？

如果调用者试图调用 ABAP 对象上的方法，而不是像 BAPI 那样的平面函数调用，该怎么办？

我没有 SAPNet 帐户，因此请不要将我引导至 SAP 文档，除非它是公开可用的 - 否则我将无法访问它。

此外，我无法访问 SAP 系统来测试所有这些，所以我试图在盲人的情况下理解和编码。如果您知道访问测试系统的*免费/非常便宜*的方法，请告诉我，这将非常有帮助。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T05:18:49.400

我之前已经将 SAP CRM 网络服务连接到 Android、java 和 .NET。我希望这个[链接](https://stackoverflow.com/questions/7433573/org-xmlpull-v1-xmlpullparserexception-expected-start-tag-error)有帮助。在那篇文章中，您可以看到集成 java 和 SAP webservice 的基本编码。如果您还有其他问题，我会尝试帮助。

希望对您有所帮助。

塔尔哈

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T09:11:30.570

There are multiple ways to communicate with an SAP system, but afaik XML-RPC is not one of them.

One way is to use SAP's own RFC protocol to perform function calls. SAP provides a library for various operating systems, and connectors for Java and .NET. There are also freely available connectors for PHP and Ruby (and maybe others, I don't know).

And then there's the business connector, PI, Gateway, Enterprise services, generated SOAP services, custom RESTful services, etc. etc.

# java - 解决快速排序算法时的堆栈溢出异常

> ID：11284867
> 
> 赞同：0
> 
> 时间：2012-07-01T19:07:10.057
> 
> 标签：java, quicksort, stack-overflow

我正在尝试用 Java 实现快速排序算法。但是每当我运行代码时，它都会给我一个 StackOverFlowException 运行时异常。我似乎无法弄清楚为什么我的界限会混乱。这是代码。

```
import java.util.Scanner;

class QuickSortOne
{
public static void main(String args[])
{
    int a[], n;

    Scanner sn = new Scanner(System.in);

    n = sn.nextInt();
    a = new int[n];
    for (int i = 0; i < n; i++)
    {
        a[i] = sn.nextInt();
    }

    QuickSort(a, 0, n-1);

    for (int i = 0; i < n; i++)
        System.out.println(a[i] + " ");

}

public static void QuickSort(int a[], int l, int r)
{
    if (l < r) //Checking for Base Case
    {
        int p = Partition(a, l, r);
        QuickSort(a, l, p);
        QuickSort(a, p+1, r);
    }
}

public static int Partition(int a[], int l, int r)
{
    int p = a[l];
    int i = l+1;
    for (int j = l+1; j <= r; j++)
        if (a[j] < p)
        {
            int temp = a[j];
            a[j] = p;
            p = temp;
            i++;
        }
    int temp = a[i-1];
    a[i-1] = p;
    p = temp;
    return i;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:59:20.933

您应该查看此算法的来源，因为您的分区方法与传统的分区方法几乎没有相似之处。

您肯定是在尝试就地分区，因此您可能想查看Wikipedia 上[的就地版本](http://en.wikipedia.org/wiki/Quicksort#In-place_version)，并尝试执行那里描述的操作。

此外，一旦您的分区正常工作，枢轴应该就位，并且可以在递归调用中跳过它的索引，而您的递归没有这样做。

# objective-c - 从模板数组中检测模板 OpenCV

> ID：11284869
> 
> 赞同：0
> 
> 时间：2012-07-01T19:07:13.580
> 
> 标签：objective-c, macos, image-processing, opencv, objective-c++

我已经设法在我的 xcode 项目中设置 OpenCV，第一个实验是成功的，我使用 OpenCV 将模板图片与最近的屏幕截图匹配，并获取该匹配的屏幕坐标。

如果我有一组图像，比如说，我希望我的应用程序单击不同的“x”框，那么使用 OpenCV 的最佳方法是什么？假设我有 4 张图片，“x1.jpg”、“x2.jpg”、“x3.jpg”和“x4.jpg”，每张图片都是相似但略有不同的图片（因此有 4 张图片）。

理想情况下，我希望我的程序检查 x1.jpg 在当前屏幕截图中是否可见，如果是，则返回坐标。如果不是，请检查 x2 是否可见。等等。

我该怎么做？

# ios - 在不停止视频的情况下停止视频的声音

> ID：11284870
> 
> 赞同：0
> 
> 时间：2012-07-01T19:07:19.650
> 
> 标签：ios, video

我有一个带声音的视频，我想在背景中播放其他声音。所以我想停止视频音乐以继续播放其他音乐。除了停止视频的音乐外，我必须为所有代码编写代码。可以建造吗？

# javascript - 执行 `typeof JSON` 比较

> ID：11284877
> 
> 赞同：4
> 
> 时间：2012-07-01T19:08:14.837
> 
> 标签：javascript, json, coffeescript

我有一个接收某些东西的方法，它需要确定接收到的值的类型。我可以使用这个`typeof`东西来执行常规比较，比如它是一个数字还是一个字符串。但是我怎样才能为 JSON 对象做到这一点呢？将它们与`JSON`带来的错误进行比较：

> 未捕获的类型错误：在 instanceof 检查中需要一个函数，但得到了 #< Object>

所以我猜想比较 JSON 对象类型`JSON`不是这样吗？

原代码如下：

```
check = (what) ->
  if what instanceof JSON
    alert "Yooo"

check({compare: "me"}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T19:11:20.600

类型将是`object`，不是`JSON`。要查看您正在使用的内容，您可以检查它是否具有您正在寻找的属性。检查长度，或者它是否有特定的键。

这是一个关于使用 JSON 的非常好的信息页面。[JavaScript 中的 JSON](http://www.json.org/js.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:18:22.650

第一个返回字符串，第二个，可能的返回值中`type of`没有类型之类的东西。[有关详细信息，请参阅此页面](https://developer.mozilla.org/en-US/JavaScript/Reference/Operators/typeof)`JSON``type of`

在您的情况下，您将收到`"object"`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T19:21:26.110

JSON 代表 JavaScript 对象表示法，它只是对象文字在 JavaScript 中编写方式的一个名称，它不是一种类型。

```
var a = {"foo":"My foo","bar" : 4};
var b = {"foo":"My foo","bar" : 0};
var c = {"foo":"My c foo","barella" : -1};
var d = '{"baz":"My baz","bar" : 4}'; 
```

a,b,c 和 d 都是对象类型的前三个对象字符串类型的第四个。从类型理论的角度来看，您可以说前两个具有相同的类型。如果你这样做`eval("var e =" + d)`了，那么将评估 d 中的字符串，并且由于 d 是一个序列化为 JSON 的对象，因此结果将是一个将分配给 e 的有效对象。

换句话说，JSON 不是类型，它是 JavaScript 语法的一部分，评估 JSON 的结果是一个对象，并且该对象的类型将根据对象文字而有所不同。在这样的对象上使用`typeof`将产生“对象”（较少考虑对象的类型理论类型）。

如果您希望针对特定类型进行测试和反对，则必须针对所有预期的属性和方法对其进行测试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-05T07:39:25.517

```
class JSON
   constructor: (@data) ->

   get: (key) ->
     @data[key]

   set: (key, value) ->
     @data[key] = value

a = new JSON "foo":"My foo", "bar" : 4

a.get('foo')
a.data.foo
a.data['foo']

console.log(a instanceof JSON) 
```

:D 你真的不应该这样做，至少不要创建 JSON 类型。但是您可以为几乎任何东西创建自己的包装器。将它与 Object.defineProperty 结合使用以基于 @data 设置 getter 和 setter，您可以做一些强大的事情。它没有 method_missing 方法，但您可以使用 Object.defineProperty 获得类似的结果

# android - 使用 gson 解析 json 文件

> ID：11284878
> 
> 赞同：5
> 
> 时间：2012-07-01T19:08:20.040
> 
> 标签：android, json, gson

我在为要使用 json 解析的 json 创建映射时遇到问题。它非常具体，它是关于一个 json 文件，其中包含一个包含对象的 json 数组。

我的 jsonfile 像这样开始：

```
 [
    {
        "venue": {
            "venue_seasons": [
                {
                    "created_at": "2011-12-25T23:00:28Z",
                    "updated_at": "2011-12-28T15:13:53Z",
                    "start_timestamp": 1293840000,
                    "id": 337,
                    "end": "2011-12-24T00:00:00Z",
                    "enabled": true,
                    "start": "2011-01-01T00:00:00Z",
                    "season_openings": [ … ],
                    "end_timestamp": 1324684800
                },
                { … }
            ],
            "address": "someadress",
            "city": "cityname",
            "name": "name",
            "created_at": "2011-03-31T07:55:33Z",
        etcetera
    }
    "venue":{another venue 
```

所以首先是一个数组，而不是一个包含很多对象的对象（场地）（我删除了其中的大部分，因为这对我的问题并不重要），还有一些数组（比如 season_openings）。

我的解析代码是这样工作的，我使用的是 gson。输入流工作正常。

```
Reader reader = new InputStreamReader(inputStream);
JsonResponse venueResponse = gson.fromJson(reader, JsonResponse.class);               
List<Venues> results = venueResponse.venue; 
```

使用 JsonResponse 类：

```
public class JsonResponse {
    public List<Venues> venue;  
} 
```

和场地.class：

```
public class Venues {

    public List<VenueSeasons> venue_seasons;

    @SerializedName("adress")
    public String getAdress;

    @SerializedName("city")
    public String getCity;

    @SerializedName("country")
    public String getCountry; etcetera 
} 
```

但是当我运行这段代码时，我得到一个错误：

```
Unable to start activity ComponentInfo{com.hera.android.JSON/com.hera.android.JSON.TestParser2Activity}: com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was BEGIN_ARRAY at line 1 column 2 
```

当然我可以阅读错误：它需要一个对象但得到一个数组。我使用不同的 jsonresponse.class 变化很大，甚至将整个 json 数组放在一个 json 对象中（这不是真正的解决方案，因为我需要使用这种类型的 jsonfile）。但每次我得到这个或类似的错误。

我想我已经接近解决方案了，谁能看到我看不到的东西并帮我一把？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T20:36:40.730

尝试像这样调用 Gson：

```
List<Venues> venues = gson.fromJson(reader, new TypeToken<List<Venues>>() {}.getType()); 
```

这是有效的，因为您的 JSON 文档是一个`List`，而不是一个将列表作为其属性之一的对象。

# grails - 在 grails 中使用 findBy() 时出错

> ID：11284881
> 
> 赞同：0
> 
> 时间：2012-07-01T19:08:53.870
> 
> 标签：grails, groovy, gsp, grails-controller

我有一个 GSP 页面：

```
<g:if test="freelancer">
        <g:each in="${ freelancer }" var="freelance">
            <a href="${ createLink(controller:'user', action:'homepage', id:freelance.user.username) }">${ freelance.firstName }</a>
        </g:each>
</g:if> 
```

和一个动作：

```
def homepage() {
    println(params.id)
    def user = User.find{
        username == params.id
    }
    if(user){
        println(user.username + "!")
        return[user:user]
    }
} 
```

和欢迎页面：

```
<body>
    Welcome ${ user.username }
</body> 
```

在第一个 GSP 页面中，我得到了 firstName 链接，当我点击它查看他的主页时，我得到一个错误：

```
Cannot get property 'username' on null object 
```

但是在我的 IDE 的控制台中，`println(params.id)`打印了一个用户名，但带有方括号。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T19:03:39.603

在您的“主页”操作中尝试

`def user = User.find{ it.username == params.id }`代替

`def user = User.find{ username == params.id }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T19:16:18.243

是的，您必须在标签中使用括号。那是第一名。

```
<g:if test="${freelancer}">

</g:if> 
```

否则，*groovy truth*将始终将非空字符串评估为 true，因此您的测试将有缺陷。

另外，我会使用 g:link 而不是 html 'a' 标签。

```
 <g:each in="${ freelancer }" var="freelance">
        <g:link controller='user', action='homepage', id="${freelance.user.username}">
            ${freelance.firstName}
        </g:link>
    </g:each> 
```

作为建议，请考虑使用 User.findByUsername() 而不是 find 闭包。

让我们知道这是否有效。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T05:41:00.190

这是我的用户域类：

```
class User {
String username
String passwordHash
byte[] passwordSalt
Profile profile

static hasMany = [ roles: Role, permissions: String ]

static constraints = {
    profile(nullable:false)
    username(nullable: false, blank: false, unique: true, size:3..15)
    passwordHash(nullable:false, blank:false, minSize:6)
}

static mapping = {
    profile lazy:false
} 
```

在 g:if 标签中，我将 freelancer 放在括号中并更改为`User.findByUsername()`. 但是有同样的错误。我不希望 params.id 作为列表。

# c# - 从 C# 在 android 上读取 logcat

> ID：11284882
> 
> 赞同：4
> 
> 时间：2012-07-01T19:08:59.897
> 
> 标签：c#, android, android-logcat

我正在研究制作 ac# 程序，该程序将从 android 设备读取 logcat 输出并将其读入 c# 程序。

最初它应该在手机连接时执行此操作，并且它不应该要求在手机上安装特定的应用程序以使 c# 程序能够检索 logcat 输出。此外，手机不应该需要root访问权限。

这是可能的吗？我在谷歌上找不到任何说它可能的东西，但我想我会在这里问一下，以防有人有一些有用的信息。

感谢您的任何帮助，您可以提供

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T15:43:18.520

最实用的答案是从您的 C# 程序中执行 shell 命令“adb logcat”并捕获其输出。

该设备的唯一要求是在设置菜单中启用 USB 调试。

主机 PC 需要为设备安装 android 开发者工具和适当的 USB 驱动程序。不幸的是，这可能会带来很多麻烦，尤其是为 Windows 主机找到合适的驱动程序。

更复杂的方法是在您的程序中复制 adb 程序（它是开源的）和/或 USB 驱动程序的功能，或者在设备上安装一个具有读取日志权限的应用程序，将它们发送给您 - 甚至运行应用程序用户 ID 下的 ssh 服务器，以便您可以连接并获取它们。

# php - 结果的 var_dump 给出空值。但更深入的检查返回一个整数

> ID：11284883
> 
> 赞同：2
> 
> 时间：2012-07-01T19:09:22.567
> 
> 标签：php, mysqli

> **可能重复：**
> [新的 Mysqli 对象为空](https://stackoverflow.com/questions/9302335/new-mysqli-object-is-null)

我刚开始为我的 MVC 框架构建我的数据库类。在构建它时，我正在尝试简单的查询和表以使其正常工作。

我试图查询以下内容：

> 选择 * 从 mvc_test

这应该返回 3 行：

> 1 | 测试
> 
> 2 | 测试2
> 
> 3 | 测试3

我使用以下方法查询：

```
<?php $this->result = $this->conn->query($this->q); ?> 
```

$this->conn 在哪里：

```
<?php 
 $this->conn = new mysqli($this->reg->conf->database['host'],
 $this->reg->conf->database['user'],
 $this->reg->conf->database['password'],
 $this->reg->conf->database['database']);
?> 
```

其中 $this->reg->conf->database 包含主机、数据库等的所有值。这有效，我有一个连接。

现在，当我 var_dump 的结果是这样的：

```
<?php var_dump($this->result); ?> 
```

我明白了：

> 对象（mysqli_result）[9]
> 
> 公共 'current_field' => 空
> 
> 公共'field_count' => null
> 
> 公共“长度”=> null
> 
> 公共'num_rows' => null
> 
> 公共'类型' => null

但是，如前所述，它应该至少包含 3 行，所以我希望 num_rows 为“3”。

现在，当我 var_dump num_rows 的结果是这样的：

```
<?php var_dump($this->result->num_rows); ?> 
```

我得到一个'int 3'作为回应。

结论：在第一个 var_dump 中它为空，但通过更深入的检查，我得到了 3。所以它读取 3 行。当我添加另一行（第 4 行）时，它按预期返回 4。

我的问题是：为什么 var_dump 不能正常工作？为什么一开始它说 null，但经过更深入的检查，它确实有价值。

在此先感谢，我真的很努力解决这个问题，因为我也没有收到任何错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T22:02:02.357

该对象是“惰性”实现的，即它在实际需要之前不会从服务器检索数据（即您从结果对象访问某些内容）。

`var_dump`似乎不会触发属性获取器，因此它们显示为`null`.

# c++ - C++ 如何获得 sizeof(enum) == sizeof(char)？

> ID：11284885
> 
> 赞同：2
> 
> 时间：2012-07-01T19:10:09.090
> 
> 标签：c++, enums, sizeof

我想知道怎么做。

我看过[这个话题](https://stackoverflow.com/questions/1113855/is-the-sizeofenum-sizeofint-always)，我明白“类型的选择是实现定义的。”，但我很想知道如何得到 1 而不是 4。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-01T19:12:29.290

C++11 引入了一种更改枚举基础类型的方法。

```
enum foo : char { ... };
enum class foo : char { ... }; 
```

`int`不过，在大多数情况下，使用默认值可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T03:16:55.923

在 GCC 上，您还可以使用 'packed' 属性告诉编译器您更关心空间而不是字对齐/访问速度：

```
enum foo { ... } __attribute__((packed)); 
```

其他编译器也有类似的提示。

（这在尝试避免编译器或 IDE 尚不支持的任何 C++11 功能时很有用。）

# mysql - 给定连接上的慢 MySQL 查询何时会影响其他连接？

> ID：11284886
> 
> 赞同：14
> 
> 时间：2012-07-01T19:10:40.210
> 
> 标签：mysql, performance

我想我对此有一个基本的了解，但我希望有人能给我更多的细节，因为我有兴趣了解更多关于数据库性能的信息。

假设我有一个非常大的数据库，有数百万个条目，该数据库支持许多连接。由于数据太多，对数据库进行简单查询会很慢。我试图准确了解给定连接上的查询何时开始对在其他连接上运行的查询的性能产生直接影响。

如果一个连接锁定了某些元素，我知道这将阻止运行需要这些元素的其他连接的查询。例如做：

```
SELECT FOR UPDATE 
```

将锁定您选择的内容。

当您执行以下简单操作时会发生什么：

```
SELECT COUNT(*) FROM myTable 
```

假设我们有一个包含十亿行的表，因此运行计数需要一些时间（在 innodb 上运行）。它会影响在其他连接上运行的查询吗？

如果您使用 SELECT 和 JOIN 选择大量数据怎么办，例如：

```
SELECT * FROM myTable1 JOIN myTable2 ON myTable1.id = myTable2.id; 
```

对其他查询有连接锁吗？

我发现很难知道哪些查询会对在其他连接上运行的查询的性能产生直接影响。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T19:35:31.047

有不同的角度：

*   行锁定：如果你调整你的架构，这不应该发生，所以你应该忘记它
*   实际性能问题和瓶颈。在我们的例子中，附带影响。

关于这第二点，问题主要分为3个方面：

*   磁盘读取
*   内存使用（缓冲区）
*   CPU使用率。

关于磁盘读取：您将检索的数据（以字节为单位）越多，硬盘驱动器就越忙，并且会减慢使用它的任何其他活动。减小选定行的大小以避免磁盘开销。

关于内存使用：mysql 管理一个内部缓冲区，在某些情况下可能会卡住。我对此知之甚少，无法给你一个正确的答案，但我知道这绝对是你应该关注的事情。

关于cpu使用：基本上cpu会忙的时候

*   必须计算（连接，准备语句，算术......）
*   必须做所有外围的事情：例如将字节从磁盘移动到内存。优化查询以减少 CPU 开销。（听起来很傻，但是，无论如何，它总是成为问题......）

那么，现在什么时候知道什么时候会产生附带效应呢？通过分析您的硬件... 如何分析？

*   绝对分析：使用`SHOW INNODB STATUS`或`SHOW PROFILE`获取有关主 mysql 硬盘、cpu 和内存监视的有用信息。
*   相对分析：使用您最喜欢的操作系统分析器。比如在windows xp下，你可以使用mysql进程的great `perfmon.exe`and watch for `PRIVATE BYTES`and `VIRTUAL BYTES`。我说的是相对的，因为毕竟如果查询在您的计算机上很耗时，那么它可能不在 NASA 系统上......

希望它有帮助，问候。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T19:35:08.507

读取查询仅受其他查询的隔离级别影响。**他们自己从来**没有挡住桌子。

隔离级别是指定的事务安全模式。如果*另一个*使用锁定的查询不允许*脏读*，则您的读取将被保留，直到*另一个*查询完成写入或解锁。

[MVCC](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)是一种允许数据库在需要更新或删除数据时创建新版本数据的机制。这意味着当您开始读取当前版本的数据时，它的数据不会被未来的更新/删除所污染。

当您开始写入当前数据时，尽管数据当前正在被另一个进程读取，您实际上是在其他地方写入新内容并将它们标记为最新版本。这最终意味着写入过程没有阻塞（至少不是因为读取过程）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T19:46:59.353

这是一个非常笼统的问题，因此很难给出准确的答案。

您可以将数据库视为共享资源池；特别是因为你的数据库运行的底层硬件有物理限制。大多数情况下，您看到诸如选择查询之类的东西会对其他查询造成性能影响的原因是，它们都在竞争使用诸如磁盘 IO 或 RAM 访问或 CPU 时间之类的底层物理资源，并且没有足够的时间来解决.

因此，您将看到的实际结果在很大程度上取决于数据库的物理硬件和配置设置。

例如，在您选择的示例中，变量可能是：查询需要的数据是否已经在 RAM 中？它可以通过索引有效地查找行吗？如果它必须做 IO，有多少其他查询要求从磁盘读取数据？您是否使用二级索引并且必须进行多次读取？数据库是否在进行预读以缓冲其他页面？查询是否导致顺序或随机 io？是否有任何更新锁定了数据？物理硬件能支持多少读IO？

您必须回答当前正在执行的所有查询的所有这些问题，以了解它们是否会影响其他查询的性能。

这就是 DBA 存在的原因。繁忙的数据库是一个复杂的系统，它是关于大量不同操作的交互，所有这些操作都有数以千计的可能变量影响它们。

所以你通常做的是优化你可以控制的东西以及你知道如何（硬件、mysql配置、模式和索引）然后在系统运行时开始测量系统以了解实际发生的情况。

因此，在您的情况下，我会说专注于简单地单独优化您的查询会更有帮助。他们执行得越快，他们可能使用的资源就越少，他们对其他人的影响就越小。然后你学会分析系统。只看一件很慢的东西，然后问“为什么这么慢？” 然后修复它。这就是优化过程。

但是，在第一种情况下，您使用 SELECT ... FOR UPDATE 显式锁可能并且将会是很大的性能问题。小心那些。

# ruby-on-rails-3.1 - Rails 每 5 分钟记录 127.0.0.1

> ID：11284888
> 
> 赞同：0
> 
> 时间：2012-07-01T19:11:04.187
> 
> 标签：ruby-on-rails-3.1, localhost, production-environment

我在生产 Rails 日志中注意到，每 5 分钟，我就会从 127.0.0.1 向我的根 url 发出 GET 请求，这显然是我的本地主机。

```
Started GET "/" for 127.0.0.1 at 2012-07-01 14:05:03 -0500
  Processing by ApplicationController#landing as */*
Rendered shared/_header.html.erb (0.9ms)
Rendered shared/_footer.html.erb (0.5ms)
Rendered application/landing.html.erb (5.7ms)
Completed 200 OK in 8ms (Views: 7.9ms) 
```

我从未在任何其他 Rails 应用程序中看到过这种情况。我正在使用 New Relic、MongoDB、Nginx 和 Unicorn。谁能告诉我为什么会发生这种情况或这意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T05:49:14.747

这很可能是一个监控应用程序，特别是因为它只检查根路径是否成功连接（即 HTTP 200）。有没有安装monit之类的工具？您使用的是哪个托管服务提供商？他们可能会在您不知情的情况下进行监控。

# java - Tomcat中奇怪的IP地址

> ID：11284889
> 
> 赞同：0
> 
> 时间：2012-07-01T19:11:16.833
> 
> 标签：java, apache, tomcat, networking, servlets

有些地方我在一些通用类中有这个。

```
public static String getRequestIp (HttpServletRequest request){
  String ipaddr = request.getHeader("X-FORWARDED-FOR");
  if (ipaddr == null)ipaddr = request.getRemoteAddr();
  return ipaddr;
} 
```

对于每个请求，我都会调用该方法，并在某个时刻在 mysql 数据库中插入一条记录。

在大多数情况下，它正常工作，我可以在正确的字段中看到每个请求的记录，其中包含有效的 IP 地址。但有时IP应该在哪里是这样的。"unknown, 93.186.30.120" or "10.0.1.169, 186.38.84.3" Apache 在前面监听端口 80 并用作监听端口 8081 的 Tomcat 的代理。我的路由器配置不允许传递任何连接通过 80 以外的任何端口。任何帮助？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T21:11:31.323

X-FORWARDED-FOR HTTP 标头的格式为：

```
X-Forwarded-For: client, proxy1, proxy2, ... 
```

因此

```
unknown, 93.186.30.120 
```

表示来自 93.186.30.120 代理的请求，来自未知的本地地址；和

```
10.0.1.169, 186.38.84.3 
```

同样意味着，来自 186.38.84.3 代理的请求，来自本地 ip 10.0.1.169

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-24T09:01:31.140

“未知” X-Forwarded-For 条目可能已由配置为不将原始客户端 IP 地址插入该字段的代理插入。

例如，Squid 配置指令 forwarded_for" 有各种选项，如果设置为 "on"，将附加客户端 IP 地址。如果设置为 "off"，它将显示为 "X-Forwarded-For: unknown"

# ruby-on-rails - after_create 来自模型的成就通知

> ID：11284891
> 
> 赞同：0
> 
> 时间：2012-07-01T19:11:29.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我正在构建一个成就系统，最后一部分是通知用户。在模型中创建成就后

```
class Achievement < ActiveRecord::Base

   def self.check_conditions_for(user)
     if user.month_views >= 30 and !user.views_awarded?(self)
      user.award(self)
     end
   end
end 
```

我需要向用户显示一个自定义通知，然后他们可以关闭。从模型中启动它的最佳方法是什么？我知道我只能从控制器调用 Flash 消息，但在这种情况下我需要一种解决方法。它看起来与堆栈溢出显示其徽章的方式非常相似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T20:08:55.787

好的，所以如果用户观看视频——大概是点击某个 url，你应该调用`Achievement.check_conditions_for(user)`相关的操作。`Achievement.check_conditions_for(user)`可以返回一些值 - 可能是通知消息 - 您可以将其作为普通的 flash 消息发送。如果仅在调用某些操作时执行此操作，则此处无需解决方法。

例如，如果您有一个控制器`Videos`并且您正在调用该操作`watch`：

```
def watch
  @video = Video.find(params[:id])
  @notice = Achievement.check_conditions_for(current_user)
  respond_to do |format|
    format.js
  end
end 
```

在 app/views/videos/watch.js.erb 中：

```
alert("<%= @notice %>"); 
```

# windows-7 - 批量拖放文件和文件夹

> ID：11284896
> 
> 赞同：0
> 
> 时间：2012-07-01T19:12:04.913
> 
> 标签：windows-7, batch-file

我正在尝试使用我认为应该如下所示的解决方案从拖放选择中复制多个文件和文件夹：

```
mkdir newdir
for %%a in ("%*") do (
echo %%a ^ >>new.set
)
for /f "tokens=* delims= " %%b in ('type "new.set"') do (
SET inset=%%b
call :folderchk
if "%diratr%"=="d" robocopy "%%b" "newdir" "*.*" "*.*" /B /E && exit /b
copy /Y %%b newdir
)

exit /b

:folderchk
for /f tokens=* delims= " %%c in ('dir /b %inset%') do (
set atr=%~ac
set diratr=%atr:~0,1%
) 
```

我尝试将以下示例中的代码放在一起，但我被卡住了：

[http://ss64.com/nt/syntax-dragdrop.html](http://ss64.com/nt/syntax-dragdrop.html)

[拖放多个文件的批处理文件？](https://stackoverflow.com/questions/1243240/drag-and-drop-batch-file-for-multiple-files)

[批量处理多个文件夹中的多个文件](https://stackoverflow.com/questions/6012650/batch-processing-of-multiple-files-in-multiple-folders)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T11:46:04.377

Handling of special characters with Drag&Drop is tricky, as doesn't quote them in a reliable way.

Spaces are not very complicated, as filenames with spaces are automatically quoted.
But there are two special characters, who can produce problems, the exclamation mark and the ampersand.

Names with an ampersand will not automatically quoted, so the batch can be called this way

```
myBatch.bat Cat&Dog.txt 
```

This produces two problems, first the parameters aren't complete.
In `%1` and also in `%*` is only the text `Cat` the `&Dog.txt` part can't be accessed via the normal parameters, but via the `cmdcmdline` variable.
This should be expanded via delayed expansion, else exclamation marks and carets can be removed from the filenames.
And when the batch ends, it should use the `exit` command to close the cmd-window, else the `&Dog.txt` will be *executed* and produce normally an error.

So reading the filenamelist should look like

```
@echo off
setlocal ENABLEDELAYEDEXPANSION
rem Take the cmd-line, remove all until the first parameter
set "params=!cmdcmdline:~0,-1!"
set "params=!params:*" =!"
set count=0

rem Split the parameters on spaces but respect the quotes
for %%N IN (!params!) do (

  echo %%N
)

pause
REM ** The exit is important, so the cmd.ex doesn't try to execute commands after ampersands
exit 
```

This is also described in the link you refereneced [Drag and drop batch file for multiple files?](https://stackoverflow.com/a/5370380/463115)

# c++ - 在 Qt 线程之间发送大量数据

> ID：11284898
> 
> 赞同：22
> 
> 时间：2012-07-01T19:12:22.363
> 
> 标签：c++, multithreading, qt, qthread

我有一个`QThread`定期生成大量数据（每秒几兆字节）的数据，它需要将其传输到父（GUI）线程。

恐怕我对内部运作不太确定，`QThread`所以我想寻求最佳实践。

显然，最直接的数据传输方式就是`emit`数组。然而，这效率如何？Qt 是否知道它在哪里使用并在发送和接收时避免对其进行深度复制？

如果没有，我可以很高兴地在主线程中分配内存并给一个指向子线程的指针，它将在其中写入数据（并且只有`emit`关于进度的短消息）。这对我来说似乎不是最优雅的解决方案，这就是我问的原因。

如果 Qt 在发送和接收时避免将数据复制到多个缓冲区中，是否在所有系统中都能保证？我没有资源尝试在各种操作系统下对其进行基准测试。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-02T03:29:28.050

`QThread`的内部工作无关紧要：它们对事件循环的工作方式没有任何作用。当`emit`a 中的信号位于`QObject`与插槽对象不同的线程中时，该信号将作为 a 发布`QMetaCallEvent`到接收线程的事件队列中。然后在接收线程中运行的事件循环将对该事件进行操作，并在连接到发出信号的插槽中执行调用。

因此，无论发生什么，您通过信号发送的任何数据最终都将作为有效负载出现在 QEvent 派生类的实例中。

问题的核心是当`QMetaCallEvent`到达事件循环并且容器作为参数传递到插槽中时。当然，在此过程中可以多次调用复制构造函数。下面是一些简单的代码，演示了复制构造函数和默认构造函数实际上被调用了多少次

*   在隐式共享的写时复制容器（QVector）的数据成员的元素上，

*   在代表容器的自定义类上。

你会惊喜的:)

由于 Qt 容器是隐式共享的写时复制，因此它们的复制构造的成本可以忽略不计：所做的只是引用计数器在构造时自动递增。例如，不会复制任何数据成员。

唉，11 之前的 C++ 显示了它丑陋的一面：如果插槽代码以任何方式修改容器，则无法以让编译器知道不再需要原始容器的方式传递对插槽的引用。因此：如果插槽接收到对容器的 const 引用，则可以保证不会制作任何副本。如果插槽接收到容器的可写副本*并且*您对其进行了修改，则将生成完全不必要的副本，因为不再需要调用站点上的活动实例。在 C++-11 中，您可以将右值引用作为参数传递。在函数调用中传递右值引用会结束调用者中传递的对象的生命周期。

示例代码输出：

```
"Started" copies: 0 assignments: 0 default instances: 0 
"Created Foo" copies: 0 assignments: 0 default instances: 100 
"Created Bar" copies: 0 assignments: 0 default instances: 100 
"Received signal w/const container" copies: 0 assignments: 0 default instances: 100 
"Received signal w/copy of the container" copies: 0 assignments: 0 default instances: 100 
"Made a copy" copies: 100 assignments: 1 default instances: 101 
"Reset" copies: 0 assignments: 0 default instances: 0 
"Received signal w/const class" copies: 2 assignments: 0 default instances: 1 
"Received signal w/copy of the class" copies: 3 assignments: 0 default instances: 1 
```

```
//main.cpp
#include <QtCore>

class Class {
    static QAtomicInt m_copies;
    static QAtomicInt m_assignments;
    static QAtomicInt m_instances;
public:
    Class() { m_instances.fetchAndAddOrdered(1); }
    Class(const Class &) { m_copies.fetchAndAddOrdered(1); }
    Class & operator=(const Class &) { m_assignments.fetchAndAddOrdered(1); return *this; }
    static void dump(const QString & s = QString()) {
        qDebug() << s << "copies:" << m_copies << "assignments:" << m_assignments << "default instances:" << m_instances;
    }
    static void reset() {
        m_copies = 0;
        m_assignments = 0;
        m_instances = 0;
    }
};

QAtomicInt Class::m_instances;
QAtomicInt Class::m_copies;
QAtomicInt Class::m_assignments;

typedef QVector<Class> Vector;

Q_DECLARE_METATYPE(Vector)

class Foo : public QObject
{
    Q_OBJECT
    Vector v;
public:
    Foo() : v(100) {}
signals:
    void containerSignal(const Vector &);
    void classSignal(const Class &);
public slots:
    void sendContainer() { emit containerSignal(v); }
    void sendClass() { emit classSignal(Class()); }
};

class Bar : public QObject
{
    Q_OBJECT
public:
    Bar() {}
signals:
    void containerDone();
    void classDone();
public slots:
    void containerSlotConst(const Vector &) {
        Class::dump("Received signal w/const container");
    }
    void containerSlot(Vector v) {
        Class::dump("Received signal w/copy of the container");
        v[99] = Class();
        Class::dump("Made a copy");
        Class::reset();
        Class::dump("Reset");
        emit containerDone();
    }
    void classSlotConst(const Class &) {
        Class::dump("Received signal w/const class");
    }
    void classSlot(Class) {
        Class::dump("Received signal w/copy of the class");
        emit classDone();
        //QThread::currentThread()->quit();
    }
};

int main(int argc, char ** argv)
{
    QCoreApplication a(argc, argv);
    qRegisterMetaType<Vector>("Vector");
    qRegisterMetaType<Class>("Class");

    Class::dump("Started");
    QThread thread;
    Foo foo;
    Bar bar;
    Class::dump("Created Foo");
    bar.moveToThread(&thread);
    Class::dump("Created Bar");
    QObject::connect(&thread, SIGNAL(started()), &foo, SLOT(sendContainer()));
    QObject::connect(&foo, SIGNAL(containerSignal(Vector)), &bar, SLOT(containerSlotConst(Vector)));
    QObject::connect(&foo, SIGNAL(containerSignal(Vector)), &bar, SLOT(containerSlot(Vector)));
    QObject::connect(&bar, SIGNAL(containerDone()), &foo, SLOT(sendClass()));
    QObject::connect(&foo, SIGNAL(classSignal(Class)), &bar, SLOT(classSlotConst(Class)));
    QObject::connect(&foo, SIGNAL(classSignal(Class)), &bar, SLOT(classSlot(Class)));
    QObject::connect(&bar, SIGNAL(classDone()), &thread, SLOT(quit()));
    QObject::connect(&thread, SIGNAL(finished()), &a, SLOT(quit()));
    thread.start();
    a.exec();
    thread.wait();
}

#include "main.moc" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-01T20:48:06.193

在通信大缓冲区时，生产者线程中的 new() 缓冲区对象是“传统的”，并且在加载时，将 *buffer 排队/发送/任何 *buffer 到消费者线程并立即 new() 另一个，（进入同一个 * buffer var)，用于下一次加载数据。

问题：如果您的 GUI 线程跟不上，除非您采取一些流量控制措施（例如，预先分配一个 *buffers 池并“循环”它们），否则您将获得内存失控。

我通常做的是在一个循环中预先分配一些缓冲区实例（在大型服务器中多达数千个），并将它们的实例推送到生产者-消费者“池队列”中。如果一个子线程想要将来自某个网​​络连接的数据加载到缓冲区中，它必须从池中弹出一个并加载它。然后，它可以将缓冲区排队/发送/任何缓冲区到消费者线程，并弹出另一个缓冲区以获取更多可能进入的数据。消费者线程获取缓冲区，处理数据并将“已使用”缓冲区推回池队列中重复使用。这提供了流控制：如果子线程加载缓冲区的速度比消费者线程处理它们的速度快，它会发现池为空并阻塞它，直到消费者线程返回一些已使用的缓冲区，因此限制缓冲区/内存的使用，（以及避免持续的新/处置，

我喜欢将池队列计数转储到 1 秒计时器上的 GUI 状态栏 - 这使我可以观察缓冲区的使用情况，（并快速发现是否有泄漏:)。

# php - Google 服务的网址名称

> ID：11284901
> 
> 赞同：1
> 
> 时间：2012-07-01T19:12:54.377
> 
> 标签：php, google-ads-api

我知道，为了使用 PHP 下载与帐户关联的 cookie，我们可以使用 CURL 来获取：

`https://www.google.com/accounts/ClientLogin?accountType=GOOGLE&Email=##youremail##&Passwd=##yourpassword##&service=##service-name##&source=test-test-v1`

但我不知道不同服务的 URL 代码是什么（我们将在上面的 URL 中用 ##service-name## 替换）。有谁知道不同服务的名称？更具体地说，有人知道 AdWords 和/或 AdWords 关键字工具的名称吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:15:07.153

[我在http://codecri.me/case/429/list-of-google-services-service-names/](http://codecri.me/case/429/list-of-google-services-service-names/)上发了一个非常适合这个的帖子

# opengl - SDL 不使用 OpenGL 驱动程序，默认为 DirectX

> ID：11284902
> 
> 赞同：1
> 
> 时间：2012-07-01T19:12:54.930
> 
> 标签：opengl, directx, sdl

我正在为一个项目使用 SDL 1.2。它渲染得很好，但我想做一些小的像素着色器效果。本演示的所有示例都使用 SDL 视频子系统的 OpenGL 驱动程序。

因此，我以 opengl 作为驱动程序启动视频子系统，并告诉 SDL_SetVideoMode() 使用 SDL_OPENGL。当我去运行程序时，它现在开始在 SetVideoMode() 调用上崩溃，它在不强制 OpenGl 的情况下运行良好）。

我回去运行程序而不强制 OpenGl 并转储 SDL_VideoDriverName()，它说我正在使用“directx”驱动程序。

我的问题有两个方面：它不喜欢 opengl 驱动程序有什么问题，以及如何让 SDL 在这里使用 opengl 没有问题？或者，如何将 SDL 表面导入 DirectX 以应用像素着色器效果？

我更喜欢使用 OpenGl，因为将代码移植到其他平台会更容易。

例如，我添加了这段代码，当我尝试使用 OpenGL 系统时会中断：

```
#define WIN32_LEAN_AND_MEAN
#include <windows.h>

#include <SDL.h>

INT WINAPI WinMain( HINSTANCE hInst, HINSTANCE, LPSTR strCmdLine, INT )
{
    SDL_putenv("SDL_VIDEODRIVER=opengl");
    SDL_Init( SDL_INIT_EVERYTHING );
    SDL_VideoInit("opengl",0);

    SDL_GL_SetAttribute( SDL_GL_DOUBLEBUFFER, 1 );  // crashes here
    SDL_Surface *mWindow = SDL_SetVideoMode(1024,768,32,SDL_HWSURFACE|SDL_HWPALETTE|SDL_DOUBLEBUF|SDL_OPENGL);

    SDL_Quit();

    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T20:15:50.473

不带 OpenGL 选项的 SDL 使用 DirectX 直接访问 3D 绘图表面。使用 OpenGL 会在 SDL 中触发完全不同的代码路径。并且将 OpenGL 与 SDL 一起使用，您**不再可以使用 SDL 表面直接访问像素**。您的程序很可能会崩溃，因为您仍在尝试直接访问表面。

无论如何，如果您想使用像素着色器，您不再必须使用普通 SDL 提供的直接像素缓冲区访问。然后你必须通过 OpenGL 做所有事情。

### 更新

您提供给 SDL 的某些参数是互斥的。此外，如果与 OpenGL 一起使用，赋予 SDL_VideoInit 的驱动程序名称也毫无意义（它仅与 DirectDraw 一起用于选择特定的输出设备）。

另外，因为您已经调用`SDL_Init(SDL_INIT_EVERYTHING)`了 to`SDL_VideoInit`是多余的，实际上可能有害。

有关完整工作的 OpenGL 示例，请参阅此内容：

[http://sdl.beuc.net/sdl.wiki/Using_OpenGL_With_SDL](http://sdl.beuc.net/sdl.wiki/Using_OpenGL_With_SDL)

# ruby - Ruby：方法不在定义的文件外部运行 - “无法将符号转换为整数（类型错误）”

> ID：11284904
> 
> 赞同：0
> 
> 时间：2012-07-01T19:13:13.440
> 
> 标签：ruby, mongodb

我是一个红宝石新手，这是我的第一个（现在是命令行）程序。首先，一些来源。

文件：AccessDb.rb

```
require 'mongo'
require 'json'
(...)

class AccessDb
  def initialize dbname, collection #, username, password
    @dbname = dbname
    @collection = collection
    @conn = Mongo::Connection.new
    @db   = @conn[dbname]
    @coll = @db[collection]
  end

  def upsert_by_meta json
    # print json
    @coll.update({ :hash_md5 => json[:hash_md5] }, json, :upsert => true)
  end
end 
```

使用

文件：下载器.rb

```
require 'curb'
require 'yaml'
require 'json'
(...)

class Downloader
  def initialize(directory)
    @PASS=nil
    @COOKIE=nil
    @filename=nil
    @full_file_location = nil
    @target_dir = directory
    File.exists? @target_dir # File.directory? @target_dir
    @c = Curl::Easy.new
    curl_setup
    @mongo = AccessDb.new "meta","meta"
  end

  def parse_link_info(url)
    json = {}

    json[:link_requested] = url
    if @c.last_effective_url != url
      then json[:link_final] = @c.last_effective_url end

    json[:link_filename_requested] =  @filename
    @final_filename = @c.last_effective_url.split(/\?/).first.split(/\//).last
    if @final_filename != @filename
      then json[:link_filename_delivered] = @final_filename end

    json[:link_filetime] = Time.at(@c.file_time).utc.to_s

    json[:content_lenght] = @c.downloaded_content_length
    json[:content_type] = @c.content_type

    @hash = MovieHasher::compute_hash(@save_location)
    @hash = MovieHasher::compute_hash(@save_location)

    if !@hash.nil?
      then json[:hash_bigfile] = @hash end

    json[:hash_md5] = Digest::MD5.hexdigest(File.read(@save_location))

    JSON.pretty_generate(json)
  end 
```

（json是一些生成的json文件）

在 AccessDb.rb 测试中使用来自 Downloader.rb 的代码可以完美运行，但是当在 Downloader.rb 中使用该方法时，我得到以下输出：

```
 D:/Dropbox/#code/PracaInz-Program/AccessDb.rb:20:in `[]': can't convert Symbol into Integer (TypeError)
from D:/Dropbox/#code/PracaInz-Program/AccessDb.rb:20:in `upsert_by_meta'
from D:/Dropbox/#code/PracaInz-Program/Downloader.rbw:158:in `block in add_links'
from D:/Dropbox/#code/PracaInz-Program/Downloader.rbw:148:in `each'
from D:/Dropbox/#code/PracaInz-Program/Downloader.rbw:148:in `add_links'
from D:/Dropbox/#code/PracaInz-Program/Downloader.rbw:189:in `<main>'
[Finished in 4.9s with exit code 1] 
```

在一个可以在一个文件中完美测试的方法代码中。我如何编写它以便它可以使用符号但在该特定文件之外工作。谢谢

```
def parse_link_info(url)
  json = {}

  json[:link_requested] = url
  if @c.last_effective_url != url
    then json[:link_final] = @c.last_effective_url end

  json[:link_filename_requested] =  @filename
  @final_filename = @c.last_effective_url.split(/\?/).first.split(/\//).last
  if @final_filename != @filename
    then json[:link_filename_delivered] = @final_filename end

  json[:link_filetime] = Time.at(@c.file_time).utc.to_s

  json[:content_lenght] = @c.downloaded_content_length
  json[:content_type] = @c.content_type

  @hash = MovieHasher::compute_hash(@save_location)
  @hash = MovieHasher::compute_hash(@save_location)

  if !@hash.nil?
    then json[:hash_bigfile] = @hash end

  json[:hash_md5] = Digest::MD5.hexdigest(File.read(@save_location))

  JSON.pretty_generate(json)
end

def add_links(url_array,cred=nil,ref=nil,cookie=nil)
  link_setup(cred,ref,cookie)
  url_array.each do |single_url|
    @c.url=single_url
    @filename = single_url.split(/\?/).first.split(/\//).last
    @save_location = @target_dir + '\\' + @filename
    # puts @save_location
    @c.perform
    File.open(@save_location,"wb").write @c.body_str

    json = parse_link_info single_url
    # puts json
    id = @mongo.upsert_by_meta json
    puts id
    json["_id"] = id
    File.open(@save_location + :"meta.json","w").write json
  end
end 
```

编辑：更多代码（json 定义），完整跟踪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:59:02.077

`parse_link_info`返回`JSON.pretty_generate(json)`，即一个字符串。

你将结果`upsert_by_meta`作为它的 json 参数传递给它，它试图将它作为一个哈希（你做`json[:hash_md5]`）访问它，你不能用一个字符串来做。String 的 [] 方法希望您传递一个整数（或一对整数），因此该方法无法将符号转换为整数

如果 parse_link_info 只是返回您的 json 对象而不是调用 JSON.pretty_generate，那么您显示的代码看起来会起作用

# c# - C# 中的文本翻译（Windows 和 Linux）

> ID：11284906
> 
> 赞同：1
> 
> 时间：2012-07-01T19:13:39.050
> 
> 标签：c#, php, mono, translation

我正在研究制作应该在 Windows 和 Linux (Mono) 上运行的 ac# 应用程序，并且正在研究制作一个自动翻译工具。我正在寻找一个免费的翻译服务来实现这一点，或者使用 ac# api（只要它是单声道兼容的）或 php api。我看过谷歌，但他们的服务不再免费，而且 bing 看起来也不再免费，或者至少在 2012 年 8 月不再免费，因为 AppID 已被弃用并通过 Windows Azure Marketplace 完成.

有没有其他可用的免费翻译工具可以做我想要实现的目标。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T20:56:31.987

我能想到的唯一免费替代方案是[WebServiceX.NET的翻译引擎](http://www.webservicex.net/ws/wsdetails.aspx?wsid=63)

# iphone - 使用 NSkeyedArchiver 在 Iphone 上分块加载大型数据集

> ID：11284909
> 
> 赞同：1
> 
> 时间：2012-07-01T19:13:50.597
> 
> 标签：iphone, objective-c, memory, nskeyedarchiver

我有一个使用 NSkeyedArchiver 写入磁盘的大型 NSDictionary。由于该字典可能/将非常大，因此将整个内容加载到内存中是不可行的。什么是分块加载字典的最佳方法，使用该块，然后继续下一个等，从而节省内存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T21:50:39.603

不要`NSkeyedArchiver`用来归档一个`NSDictionary`包含所有对象的大文件。

`encodeObject:forKey:`使用unarchive归档对象`decodeObjectForKey:`。
这样您就不需要`NSDictionary`为了检索一个对象而取消整个归档。

# c - C中的地址：&（数字）

> ID：11284910
> 
> 赞同：7
> 
> 时间：2012-07-01T19:13:55.353
> 
> 标签：c

我不明白这个程序的输出：

```
int arr[]={1,7,4,2,5,8};
int x=(&(arr[arr[1]-arr[4]])-arr);
printf("%d" ,x); 
```

`arr[arr[1]-arr[4]]`等于4。这是什么意思`&(4)`？为什么打印2？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-01T19:17:33.523

```
arr[1] - arr[4] 
```

这就像它看起来一样。`7 - 5 = 2`，所以让我们将其替换为`2`：

```
arr[2] 
```

这也是它看起来的样子。`4`. 获取它的地址，该`&`地址将是`int`距离数组开头的两个 s 偏移量，即`arr`.

```
&(arr[2]) - arr 
```

减去`arr`，所以你留下了 from 的偏移量`arr[2]`，`arr`即两个`int`s。你去吧。

[这是一个简化的示例。](http://codepad.org/OgM4mIiK)

* * *

如果您期望它是`8`，那么，指针算法就是这样。将它们都投射到`unsigned int`：

```
(unsigned int)&arr[2] - (unsigned int)arr 
```

将 yield `8`，至少当 an`int`是四个字节时。[（演示）](http://codepad.org/XQGzvR9f)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-01T19:23:51.727

查看 minitech 的答案，了解如何推断“2”的打印值。

但是，我认为在您的情况下，您只是误解了`&`操作员的工作方式。是的，`arr[arr[1]-arr[4]]`是`4`，但这并不意味着`&(arr[arr[1]-arr[4]])`正在做`&4`；它在做`&(arr[2])`；它取的是 的地址`arr[2]`，而不是 的值`arr[2]`，即`4`。

# c# - 为什么Task不返回null

> ID：11284913
> 
> 赞同：4
> 
> 时间：2012-07-01T19:14:21.810
> 
> 标签：c#, task-parallel-library

我正在使用新的[任务并行库](http://msdn.microsoft.com/en-us/library/dd460717.aspx)，今天去了这个案例：

此代码无法编译：

```
 internal Task<Guid?> SavePages(string[] pages)
    {
        return Task.Run(() =>
        {
            if (pages == null || pages.Length == 0)
                return null;

            .... 
```

除非我明确返回一个可为空的 Guid：

```
 internal Task<Guid?> SavePages(string[] pages)
    {
        return Task.Run(() =>
        {
            if (pages == null || pages.Length == 0)
                return (Guid?)null;

            // Check documents path access 
```

为什么这种行为，我做错了什么？我的意思是，我让代码与第二个选项一起使用，但不知道如果我在滥用库，我的意思是，null 始终为 null，不是吗？

编译错误：

> 无法将 lambda 表达式转换为委托类型“System.Func”，因为块中的某些返回类型不能隐式转换为委托返回类型

[http://msdn.microsoft.com/en-us/library/dd460717.aspx](http://msdn.microsoft.com/en-us/library/dd460717.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-01T19:22:10.463

这与编译器确定 lambda 类型的方式有关。当您返回一个 plain`null`时，编译器唯一可以暗示的是您正在返回一个对象。因此，您的无参数 lambda 与`Task<object>`. 但是，您的函数的签名表明您正在返回`Task<Guid?>`，因此编译器从您的代码中暗示的返回类型不兼容。当您将其`null`转换为 时`Guid?`，您向编译器 a 提供了使 lambda a 缺失的线索`Task<Guid?>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T21:08:07.003

这是 C# 编译器中类型推断的限制。这个问题与涉及三元运算符的问题不无关系：

```
int? num = a != null ? a.Value : null;         // Will not compile
int? num = a != null ? a.Value : (int?)null;   // Compiles
int? num = a != null ? (int?)a.Value : null;   // Compiles 
```

针对您的特定情况的另一种解决方法是明确指定泛型类型：

```
return Task.Run<Guid?>(() =>
{
    if (pages == null || pages.Length == 0)
        return null; 
```

# sql - 带有聚集索引的原始插入订单

> ID：11284917
> 
> 赞同：1
> 
> 时间：2012-07-01T19:15:06.280
> 
> 标签：sql, indexing, clustered-index

我有一个关于聚集索引的问题。

在聚集索引中，叶级节点本身按排序顺序保存数据，对吗？

也就是说，每次插入/更新/删除时，节点都会重新洗牌以保持排序顺序。

那么如何按照插入的顺序从中检索数据呢？

想象一下按照给定的顺序插入以下数据：`1,7,4,5,2`并在该字段上创建聚集索引。

那么数据将按顺序存储在内部`1,2,4,5,7`吗？

所以这可能有助于更快地查找特定值，但是如果用户想要按照他插入的顺序排列前 3 个值怎么办？

它们是否可以以某种方式检索，或者我是否必须为插入的每一行分配一个增量 id，在其上声明一个非聚集索引，并根据对该 id 字段上的记录进行排序来提供前 3 条记录的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:26:43.043

（基于 SQL Server 的答案 - 问题没有 100% 指定）

> 在聚集索引中，叶级节点本身按排序顺序保存数据，对吗？

这不太正确，数据可以以任何顺序存储在叶子上，但页面上的插槽数组实际上是从页面读取数据的顺序 - 而不是数据的物理顺序。

> 也就是说，每次插入/更新/删除时，节点都会重新洗牌以保持排序顺序。

节点（例如页面被拆分并且双链表上的前向/后向指针改变），但在页面内，槽数组仍然是保留顺序的实体，行本身不会被打乱以匹配槽数组顺序。

> 那么如何按照插入的顺序从中检索数据呢？

通常不保证它会按照确切的顺序 - 这往往发生在堆页面上，其中插槽数组更能代表顺序，但同样不能保证。

> 想象一下，按照给定的顺序插入以下数据：1、7、4、5、2，并在该字段上创建聚集索引。所以数据将按 1、2、4、5、7 的顺序在内部存储，对吗？

不，它将在页面上存储 1,7,4,5,2，但插槽数组会将页面上的地址读取为 7,5,4,2,1（它从页面末尾向后构造，所以你倒着读。）

> 所以这可能有助于更快地查找特定值，但是如果用户想要按照他插入的顺序排列前 3 个值怎么办？

在这种情况下有点无关紧要——除了没有关于排序的保证之外，SQL 会将整个页面读入内存。如果你想了解更多关于这种级别的 SQL 内部知识，我仍然会推荐 Kalen Delaneys SQL Internals 这本书作为最好的来源之一。

如果您想了解有关插入顺序的任何信息，我建议您使用某种 insert_timestamp

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T19:47:49.320

表数据按照聚集索引的顺序进行排序。每个表只能有一个聚集索引，如果你想按照他插入的顺序检查前 3 个值，

> 使用 AdventureWorks
> 
> 去
> 
> CREATE TABLE myTable99(
> Col1 int IDENTITY(1,1) PRIMARY KEY , Col2 Char(1) , Col3 datetime DEFAULT getdate()
> 
> ） 去
> 
> INSERT INTO myTable99(Col2) SELECT 'A' UNION ALL SELECT 'B' UNION ALL SELECT 'C' 去
> 
> SELECT * FROM myTable99 ORDER BY 3 GO
> 
> 删除表 myTable99 去

其他方法可能是：

> CREATE TABLE CounterData]( [CounterDataID] [bigint] IDENTITY(1,1) NOT NULL, [DateTimeID] [bigint] NOT NULL, [Value] [float] NULL ) ON [PRIMARY]
> 
> 在 [PK].[CounterData] 上创建唯一的聚集索引 [IX_DateTime_CounterDataID]
> 
> (
> 
> [DateTimeID] ASC，
> [CounterDataID] ASC
> 
> )
> 
> 和
> 
> （PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，SORT_IN_TEMPDB = OFF，IGNORE_DUP_KEY = OFF，DROP_EXISTING = OFF，ONLINE = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON） ON [PRIMARY] 开始

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-01T19:25:40.600

听起来你想在你的行上给我一个时间戳。我通常会在我创建的所有表上放置以下列（用于审计）：

```
timecreated
timemodified
createdby
modifiedby
deleted 
```

这些列让您知道谁创建了该行以及何时、何时最后修改以及由谁以及可选地“软删除”该行，方法是将已删除设置为 true。当然，系统中的所有其他查询都必须检查已删除的布尔值才能使软删除起作用。

# r - 基于查找表的批处理文件重命名

> ID：11284920
> 
> 赞同：-2
> 
> 时间：2012-07-01T19:15:35.070
> 
> 标签：r

大家好

我对 R 很陌生，我希望完成以下任务

我有很多文件需要执行此任务。我将情况简化为五个文件。他们的名字是

```
001 
232 
242 
123 
132 
```

我想将每个文件的名称（第 1 列）更改为下表第 2 列中的名称

```
column1    column2 
001            ewr 
232            eda 
242            gdg 
123            sgs 
132            ger 
```

我想知道是否有人可以指出一种方法来做到这一点。

非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:32:46.087

假设您的 data.frame 是

```
df<-data.frame(a=c("001","232","242","123","132"),b=c("ewr","eda","gdg","sgs","ger")) 
```

您可以使用

```
apply(df,1,function(x){file.rename(x[1],x[2])}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T19:37:38.240

或者简单到...

`with(df, file.rename(a,b))`

# iphone - 按下按钮时无法识别的选择器

> ID：11284927
> 
> 赞同：4
> 
> 时间：2012-07-01T19:16:28.287
> 
> 标签：iphone, objective-c, ios, button

我不敢相信我偶然发现了这么简单的事情：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {

        UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        [button setTitle:@"Tap me" forState:UIControlStateNormal];
        [button addTarget:self action:@selector(test) forControlEvents:UIControlEventTouchUpInside];

        button.frame = CGRectMake(50, 50, 120, 60);
        [self.view addSubview:button];

    }
    return self;
}

-(void)test {
    NSLog(@"Test");
} 
```

当我按下按钮时它会崩溃，并出现`unrecognized selector sent to instance`错误。

有人知道我在这里做错了什么吗？

编辑 - 错误消息：

```
-[__NSCFString test]: unrecognized selector sent to instance 0x29ee30
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString test]: unrecognized selector sent to instance 0x29ee30' 
```

编辑 - 它的呈现方式（ARC）：

```
DemoViewController *demoVC = [[DemoViewController alloc] init];
    [self.window addSubview:demoVC.view];

    [self.window makeKeyAndVisible]; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-01T19:29:37.323

如果您使用的是 ARC，那么 demoVC.view 将在函数结束后立即被重新调用，而不是像这样初始化

```
DemoViewController *demoVC = [[DemoViewController alloc] init]; 
```

在 demoVC 周围创建一个强大的属性并将其初始化为

```
self.demoVC = [[DemoViewController alloc] init]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-01T19:24:01.047

您的错误消息表明（很可能）您的视图控制器在按下按钮之前被释放。（这表明消息正在发送到一个 NSString，它可能占用了视图控制器曾经所在的内存。）

追捕此问题的最简单方法是使用[僵尸](https://stackoverflow.com/questions/5386160/how-to-enable-nszombie-in-xcode)来确认这一点并确定您的对象被提前释放的原因。

编辑：根据您的演示代码，您应该制作一个实例变量以保留对您的视图控制器的引用。您可能还想移动按钮初始化代码`viewDidLoad`以避免将来出现其他问题。（或者只是把按钮挂在笔尖上！）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-01T22:31:44.997

添加任何带有代码的 UI 组件时，需要在 viewDidLoad 或 loadView（如果您不添加 xib 文件）中添加覆盖方法。

并且您还需要为发件人添加参数（这是推荐）

ex ) - (void)test:(id)sender

并像这样添加目标.... [button addTarget:self action:@selector(test:) forControlEvents:UIControlEventTouchUpInside]

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-01T19:23:48.200

您可能会在代码中的某处为 NSString 调用“测试”方法。

# java - 如何使用“for”循环找到 28 之后的前 3 个完美数字？

> ID：11284929
> 
> 赞同：1
> 
> 时间：2012-07-01T19:16:32.043
> 
> 标签：java, math

如何使用“for”循环找到 28 之后的前 3 个完美数字？这是我正在使用的一些代码。

我似乎无法得到超过 2 个数字的任何东西。如果我尝试增加 i<= 2000000000 它告诉我整数太大。

```
public class JBaneling
{
    public static void main(String args[])
    {
        System.out.println("3 nearest Perfect numbers after 29 ");

        for (int i = 29; i <= 2000000000; i++) {
            test1(i);
        }
    }

    public static void test1(int number)
    {
        int sum = 0;

        for(int divisor=1; divisor < number; divisor++)
        {
            if ((number % divisor) ==0)
            {
                sum = sum + divisor;
            }
        }

        if(sum==number)
        {
            System.out.println(number + " is a perfect number");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T19:22:58.147

您确定代码实际终止了吗？我看不出实际计算有什么问题，但它的效率非常低，所以如果你只得到 2 个数字，那可能是因为你在程序到达第三个数字之前就停止了它。如果您想知道，它是 33550336，它远低于您设置的循环限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-01T19:23:16.327

计算第三个完美数只需要很长时间。下一个完美数之后`8128`是`33550336`。现在考虑您的代码通过计算每个整数的**每个**除数来测试之间的**每个整数。**`8128 ... 33550336`

 **还要考虑下一个完美数，`33550336`是您可以用 java 表示的最大完美数`int`：`Integer.MAX_VALUE`是 (2^31 - 1)。你会得到*更多*的`long`-`Long.MAX_VALUE`是 (2^63 - 1) - 但你会等待**很长时间**才能获得第 8 个完美数字。

请注意，您只需要考虑直到 的平方根的`number`除数，然后在平方根以上找到它们的匹配除数，但即便如此，您仍然需要等待很长时间才能获得下一个完美数字。**

# java - BeanCreationException NoSuchBeanDefinitionException 使用 Spring roo

> ID：11284935
> 
> 赞同：2
> 
> 时间：2012-07-01T19:17:23.607
> 
> 标签：java, spring, spring-roo, bean-validation

当我尝试访问我的服务时抛出异常，我使用 spring roo 创建了生成文件的 spring 数据 jpa 存储库`applicationContext-jpa.xml`

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/data/jpa"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd">

  <repositories base-package="org.bixin.dugsi" />

</beans:beans> 
```

我的 applicationContext.xml 在同一个目录中`META-INF/spring/`，我确保包含组件扫描

```
<context:component-scan base-package="org.bixin.dugsi">
    <context:exclude-filter expression=".*_Roo_.*" type="regex"/>
    <context:exclude-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
</context:component-scan> 
```

我如何使用它的测试用例如下：

```
@RooIntegrationTest(entity = UserAccount.class)
@ContextConfiguration(locations = { "classpath:META-INF/spring/applicationContext.xml" })
public class UserAccountIntegrationTest extends AbstractJUnit4SpringContextTests {

    @PersistenceUnit(unitName = "persistenceUnit")
    private EntityManagerFactory factory;
    PasswordService testsPasswordService = new CustomPasswordService();

    @Autowired
    private AccountSettingsRepository accountSettingsRepository;

    @Autowired
    private AccountService accountService;

    @Test
    public void testAccount(){

        accountService.saveAccountSettings(accountSettings);
        Assert.assertNotNull(accountSettings);
    } 
```

我不知道是什么导致了这个异常，我告诉它在哪里可以找到服务实现和存储库。完整的堆栈跟踪如下：

```
2012-07-01 14:11:06,661 [main] ERROR org.springframework.test.context.TestContextManager - Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@512d8ecd] to prepare test instance [org.bixin.dugsi.domain.UserAccountIntegrationTest@97d01f]
java.lang.IllegalStateException: Failed to load ApplicationContext
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:290)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'accountServiceImpl': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: org.bixin.dugsi.repositories.AccountSettingsRepository org.bixin.dugsi.service.AccountServiceImpl.accountSettingsRepository; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.bixin.dugsi.repositories.AccountSettingsRepository] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)
    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)
    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)
    ... 24 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: org.bixin.dugsi.repositories.AccountSettingsRepository org.bixin.dugsi.service.AccountServiceImpl.accountSettingsRepository; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.bixin.dugsi.repositories.AccountSettingsRepository] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 39 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [org.bixin.dugsi.repositories.AccountSettingsRepository] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:924)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:793)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 41 more
2012-07-01 14:11:06,666 [main] DEBUG org.springframework.test.context.support.DirtiesContextTestExecutionListener - After test class: context [[TestContext@1ebcda2d testClass = UserAccountIntegrationTest, testInstance = [null], testMethod = [null], testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6ee0a386 testClass = UserAccountIntegrationTest, locations = '{classpath:META-INF/spring/applicationContext.xml}', classes = '{}', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader']]], dirtiesContext [false]. 
```

帐户设置存储库

包 org.bixin.dugsi.repositories；

```
import java.util.List;

import org.bixin.dugsi.domain.AccountSettings;
import org.springframework.roo.addon.layers.repository.jpa.RooJpaRepository;

@RooJpaRepository(domainType = AccountSettings.class)
public interface AccountSettingsRepository {

} 
```

上下文应用程序Context-Jpa.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/data/jpa"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd">

  <repositories base-package="org.bixin.dugsi.repositories" />

</beans:beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T20:38:45.817

检查`applicationContext-jpa.xml`您的主要上下文是否已加载。

为此，请检查您的`applicationContext.xml`包含：

```
<import resource="applicationContext-jpa.xml"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T04:11:24.797

您没有在测试中加载 applicationContext-jpa.xml。修改 UserAccounIntegrationTest 的 ContextConfiguration 注释中的位置属性。

您最好让 Roo 在“实体”命令中使用“-testAutomatically”或使用“集成测试”命令来创建测试。

Roo 将在集成测试的 AspectJ 文件 (.aj) 中使用通配符创建适当的位置：“classpath:META-INF/spring/applicationContext*.xml”。

注意：如果你想在 test/resources 文件夹中添加你自己的 applicationContex-test.xml，你需要通过*在 classpath 之后添加一个''来修改位置：“classpath* :...”

# java - 从 double 中删除尾随零

> ID：11284938
> 
> 赞同：8
> 
> 时间：2012-07-01T19:17:42.017
> 
> 标签：java, double, decimalformat

如果没有任何数字，我想删除所有尾随零而不截断或舍入数字。例如，数字可能类似于`12.0`，在这种情况下，应删除尾随零。但这个数字也可能是一些**几乎**不合理的东西，比如`12.9845927346958762...`出现在屏幕边缘。有没有办法设置 DecimalFormat 或其他一些类来削减尾随零，同时保持非理性完好无损？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-01T19:27:40.373

如果您愿意切换到`BigDecimal`，可以使用[#stripTrailingZeroes()](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#stripTrailingZeros%28%29)方法来完成此操作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-01T19:52:55.160

您可以使用字符串操作来删除尾随零。

```
private static String removeTrailingZeros(double d) {
  return String.valueOf(d).replaceAll("[0]*$", "").replaceAll(".$", "");
}

System.out.println(removeTrailingZeros(1234.23432400000));
System.out.println(removeTrailingZeros(12.0)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T19:44:36.917

> private static String removeTrailingZeros(double d) {
> return String.valueOf(d).replaceAll("[0]*$", "").replaceAll(".$", "");
> }

或者

> 私有静态字符串 removeTrailingZeros(double d) {
> return String.valueOf(d).replaceAll(".?0*$", "");
> }

这些是错误的代码。

> System.out.println(removeTrailingZeros( *1234.23432* **400000** ));
> 返回：**1234.23432**
> 但必须返回：*1234.23432* **4**

* * *

> 私有静态字符串 removeTrailingZeros(double myDouble) {
> return (new BigDecimal(Double.toString(myDouble))).toPlainString().replaceAll("[0]
> *$", "").replaceAll(".$", "" );
> }

这个方法也出错了

> System.out.println(removeTrailingZeros( **472.304000** )); 返回**472.30** 而不是**472.304**
> 
> System.out.println(removeTrailingZeros( **472304000** )); 返回**47230** 而不是**472304000**

BigDecimal 的 #stripTrailingZeroes() 或 toPlainString() 是很好的方法，但也不是单独的。

**//----------------BigDecimal.toPlainString-------------** System.out.println((new BigDecimal(Double.toString( **4724** ) )).toPlainString());
System.out.println((new BigDecimal(Double.toString( **472304000** ))).toPlainString());

返回：
4724.0（这不好 - 我们不想要'.0'）**472304000**
（这很好） //----------------BigDecimal.stripTrailingZeros----

**---------** System.out.println((new BigDecimal(Double.toString( **4724** )).stripTrailingZeros()));
System.out.println((new BigDecimal(Double.toString( **472304000d** )).stripTrailingZeros()));

返回：
**4724.0** （这很好）
**4.72304E+8**（这不好 - 我们想要**472304000**）

当前主题“从双精度中删除尾随零”的完美解决方法是使用
.stripTrailingZeros().toPlainString()

例如：
**//---------BigDecimal.stripTrailingZeros.toPlainString----- ----------** System.out.println(new BigDecimal(Double.toString( **472.304000** )).stripTrailingZeros().toPlainString());
System.out.println((new BigDecimal(Double.toString( **4724** )).stripTrailingZeros().toPlainString()));
System.out.println((new BigDecimal(Double.toString( **472304000d** )).stripTrailingZeros().toPlainString()));

结果是：
**472.304** （正确）
**4724** （正确）
**472304000**（正确）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-02-19T00:01:05.040

```
double result = ...;
int intResult = (int)result;
if (result == intResult) {
    System.out.println(intResult);
} else {
    System.out.println(result);
} 
```

# php - 由于文件夹权限，php上传在生产中不起作用

> ID：11284939
> 
> 赞同：2
> 
> 时间：2012-07-01T19:17:51.890
> 
> 标签：php, windows-server-2003, iirf

我有一个 php 页面，它从用户那里接收带有附件的信息并上传它，该页面在本地完美运行，但是在生产时它不起作用，

服务器规格。windows server 2003 Iirf 安装在 IIS6 上，而不是 .htaccess

在寻求技术支持的解决方案时，我发现要上传的文件夹被标记为只读，

我回到我的本地主机并将要在我的机器上上传的文件夹标记为只读并且发生了同样的问题，技术支持代理看到这个问题没有造成问题并且它不影响上传过程和拒绝为我删除只读标志

问题是：这个标志是限制页面上传文件到这个文件夹还是不影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:52:12.913

[http://pt2.php.net/manual/pt_BR/function.sys-get-temp-dir.php](http://pt2.php.net/manual/pt_BR/function.sys-get-temp-dir.php)

您可以尝试上传到生产服务器的临时目录吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T19:49:21.423

您是否尝试过更改文件夹的所有者？我猜国际空间站无法访问它使用的帐户。

# zend-framework - 基于实体的密钥的人类可读表示的适当位置

> ID：11284944
> 
> 赞同：1
> 
> 时间：2012-07-01T19:18:17.773
> 
> 标签：zend-framework, doctrine-orm, entity, static-methods

首先是一些背景。我们最近从基于 Zend_Db_Table 的解决方案转换为基于实体的解决方案（Doctrine）。随着我们的应用程序的增长，表类变得越来越难看。一些表使用 ENUM 列来存储基于字符串的键，这些键通过静态方法转换为人类可读的字符串。像这样的东西：

```
public static function getProductType($productKey)
{
    if (!array_key_exists($productKey, self::$productTypes)) {
        return null;
    }
    return self::$productTypes[$productKey];
}

public static function getProductTypes()
{
    return self::$productTypes;
} 
```

在转向基于实体的系统时，我尽量避免使用静态方法。我将价值翻译的关键转移到一个视图助手中，并称之为一天。最后，我发现这还不够，因为我们需要以 JSON 对象的形式返回它们，这发生在表示层之外（即不能直接访问视图助手）。

有没有人对这些方法的适当位置有任何理论？我应该创建单独的对象来进行从键到人类可读值的转换，在实体对象上实现静态方法，还是其他什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T18:50:24.640

好吧，我的理论是这应该在模型本身中完成。但有时在处理复杂模型时，我喜欢创建一个单独的类来处理该模型的任何特殊“表示”。它将模型作为参数并封装表示逻辑。

所以使用你的例子，也许是这样的：

```
class Model_Product
{
    public static function getAllTypes()
    {
        return array(/* key-value pairs */);
    }

    //returns non human readable value
    public function getType()
    {
        return $this->_type;
    }
}

class Model_Product_Presenter
{
    protected $_model;

    public function __construct(Model_Product $model)
    {
        $this->_model = $model; 
    }

    //returns human readable value
    public function getType()
    {
        $types = $this->_model->getAllTypes();

        if (!array_key_exists($this->_model->type, $types)) {
            return null;
        }
        return $types[$this->_model->type];
    }

    public function getDateCreated($format = "Y-m-d")
    {
        return date($format,$this->_model->timestamp);
    }
} 
```

您可以更进一步，创建一个基本演示者类来定义任何常见任务，即将时间戳转换为日期、格式化数字等。

**更新：** 对于对产品类型列表的匿名访问，我认为通过静态方法使其成为产品模型的责任没有任何害处。并非所有静态方法都是邪恶的。在我看来，为此目的使用静态方法很好，因为它声明了一个全局常量。

在更复杂的场景中，我会将这个职责委托给一个单独的类，比如 Model_ProductType。以下是生产中这种复杂模型的示例：

[https://github.com/magento/magento2/blob/master/app/code/core/Mage/Catalog/Model/Product/Type.php](https://github.com/magento/magento2/blob/master/app/code/core/Mage/Catalog/Model/Product/Type.php)

# asp.net - GetMessageCount() 返回 0（零）

> ID：11284946
> 
> 赞同：0
> 
> 时间：2012-07-01T19:18:19.220
> 
> 标签：asp.net, gmail, openpop

```
public class _Variable
{
    public bool MailStat;
    public Pop3Client pop3;
    public int lastmailCount;
    public int currentmailCount;
    public Message msg;
    public MessagePart msgPart;
    public Timer _timer;        
}

public List<int> _MailReader()
{
    _Variable _var = new _Variable();
    try
    {
        //HttpContext.Current.Session["Pop3Client"]

        if (HttpContext.Current.Session["Pop3Client"] == null)
        {
            _var.pop3 = new Pop3Client();
            _var.pop3.Connect("pop.gmail.com", 995, true);
            _var.MailStat = _var.pop3.Connected;
            _var.pop3.Authenticate("nithin.testing1@gmail.com", "xxxxxxx");
            HttpContext.Current.Session["Pop3Client"] = _var.pop3;
        }
        else
        {
            _var.pop3 = (Pop3Client)HttpContext.Current.Session["Pop3Client"];
        }
        if (_var.MailStat)
        {

            //HttpContext.Current.Application["lastmailCount"] = _var.pop3.GetMessageCount();
            _var.currentmailCount = _var.pop3.GetMessageCount();
            _var.lastmailCount = _global.lastmailCount;
            if (_var.lastmailCount < _var.currentmailCount)
            {
                _global.lastmailCount = _var.currentmailCount;
                int _diff = _var.currentmailCount - _var.lastmailCount;
                for (int _loop = _var.currentmailCount; _diff > 0; _diff--)
                {
                    _var.msg = _var.pop3.GetMessage(_loop-(_diff-1));
                    _var.msgPart = _var.msg.MessagePart.MessageParts[0];
                    string bodyPart = _var.msgPart.BodyEncoding.GetString(_var.msgPart.Body).ToString().Trim();
                    int _result;
                    if (int.TryParse(bodyPart, out _result))
                    {
                        _global._vbill.Add(Int32.Parse(bodyPart));
                        _global._vDate.Add(_var.msg.Headers.DateSent.ToString());
                    }
                }
            }
        }
        _var.pop3.Dispose();
        return _global._vbill;
    }
    catch (Exception ex)
    {
        return _global._vbill;
    }
} 
```

我正在使用 OpenPop.dll 并且在以下代码中，即使我的帐户中有邮件，pop.getMessageCount 也会返回零。

_Variable 方法包含我在代码和 _MailReader 中使用的所有变量。我只是从我的应用程序中读取所有邮件并返回到列表中，但这是问题计数始终为零。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T12:00:32.540

这是 gmail pop3 服务器的一个功能。默认情况下，您只能接收未读消息。这意味着，如果您或其他人已经下载过某条消息，将无法再通过 pop3 协议接收该消息。

为避免这种情况，您必须配置您的 gmail 帐户。在 gmail 设置的“转发和 POP/IMAP”部分中选中“为所有邮件（已下载的事件邮件）启用 POP”。

截图：http: [//i.stack.imgur.com/UE7ip.png](http://i.stack.imgur.com/UE7ip.png)

# qt - 选择文件夹后 QFileDialog::getExistingDirectory 不关闭

> ID：11284948
> 
> 赞同：2
> 
> 时间：2012-07-01T19:18:43.790
> 
> 标签：qt, qfiledialog

在 Qt 中，

```
QFileDialog *dlg = new QFileDialog(); 
QDir dir = dlg->getExistingDirectory(this, tr("Choose folder"), qgetenv("HOME")); 
```

打开一个文件夹选择对话框。一旦我选择了一个文件夹（按选择按钮），该文件夹就不会自动关闭。所以我尝试了：

```
if(dlg->close() == true) delete(dlg); 
```

当我调试 dlg->close() 返回 true 并且代码 delete(dlg) 被命中。文件夹选择器对话框仍然没有关闭。

我正在使用 Ubuntu 11.10 64 位操作系统。使用存储库中的 Qt 库。

我的最终目标只是显示一个文件夹选择器对话框，一旦选择了文件夹，对话框就会关闭。之后处理应该继续。这该怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T00:04:15.610

即使`QFileDialog::getExistingDirectory`是静态的并且不需要`QFileDialog`对象来工作，它也应该在最终选择目录时关闭对话窗口。默认情况下，该函数会尝试打开本机文件对话窗口，这似乎会在某些平台上引起一些问题。

您应该尝试通过添加选项来强制非本地对话框`DontUseNativeDialog`：

```
QString dir = QFileDialog::getExistingDirectory(
    this, 
    tr("Choose folder"),
    QDesktopServices::storageLocation(QDesktopServices::HomeLocation),
    QFileDialog::ShowDirsOnly | QFileDialog::DontUseNativeDialog); 
```

并删除另外两行（使用`new QFileDialog`和`if(dlg->close()) ...`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-01T20:20:05.307

`getExistingDirectory(...)`是一个静态函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-10T20:58:20.367

要添加到 cmannett85 的答案：

您不应该创建`QDialog`. 如果你这样做了，你可以隐藏它。修改您的代码以读取

```
const QString home = QDesktopServices::storageLocation(QDesktopServices::HomeLocation);
const QDir dir = QFileDialog:getExistingDirectory(this, tr("Choose folder"), home); 
```

这段代码应该是相对可移植的。`qgetenv("HOME")`是 Unix 特定的。您不应该在基于 Qt 的项目中引入无偿的特定于平台的代码——它首先违背了使用 Qt 的目的。

# php - TYPO3：将插件渲染到映射区域（TemplaVoila）

> ID：11284953
> 
> 赞同：0
> 
> 时间：2012-07-01T19:21:51.567
> 
> 标签：php, typo3, typoscript, templavoila

我想通过`KickStart`扩展创建一个图像滑块插件。我已经安装`TemplaVoila`并映射了滑块的区域。

那么如何将我的插件连接到该映射区域。

我可以像这样在映射区域中插入静态文本

```
lib.slidercontent = TEXT
lib.slidercontent.value = Slider Images!!! 
```

那么我如何将我的滑块插件渲染到`lib.slidercontent`.

它应该是什么样的插件？像`Backend`, `Frontend`, `Frontend-plugin`.. 等

```
I want to show this slider in all pages 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T22:27:30.877

1.  创建一个扩展并在其中添加 FE 插件
2.  在您的 TS 模板中添加：

    ```
    lib.slidercontent < plugin.tx_myslider_pi1 
    ```

3.  在`TemplaVoila`添加新字段`DataStructure`

    *   名称即。：`field_slider`
    *   元素预设：`TypoScript Object Path`
    *   添加后使用`Typoscript`部分并在 `Object Path`字段中添加：`lib.slidercontent`
4.  保存
    *   将字段保存在 DS 中，
    *   将该字段映射到某些模板的块，
    *   保存 DS，
    *   清除缓存，检查FE

# r - 计算数据框中变量的重复次数并计算出其出现的比例

> ID：11284962
> 
> 赞同：0
> 
> 时间：2012-07-01T19:23:30.340
> 
> 标签：r

对 R 来说相对较新，所以提前为自己一无所知而道歉。

多年来，我正在一个国家的多个地点处理几个（非常大的）观测数据集。我需要计算在第 x 周提交观察的站点总数中在第 x 周注意到特定物种的站点的比例（基本上是存在/不存在数据。）我有一个数据集可以提供每个个体的详细信息物种观察，以及每周的观察总数。因此，我需要一些函数来计算该物种在该周记录的站点数量，然后将其除以在同一周内记录任何物种观察的站点总数。观察记录用一周（1-53）和一年（1995-2011）记录。

species.data 示例（为便于粘贴而列为 csv）：

```
SITE_ID, SPECIES, WEEKNO, YEAR
1289, Attenb., 1, 1995
1538, Attenb., 1, 1995
1894, Attenb., 2, 1995
1286, Attenb., 4, 1995
1238, Attenb., 7, 1995
1892, Attenb., 7, 1995 
```

以及 total.obs.data 的示例：

```
YEAR, WEEKNO, TOTALOBS,
1995, 1, 100
1995, 2, 780
1995, 3, 100
1995, 4, 189
1995, 5, 382
1995, 6, 100
1995, 7, 899
1995, 8, 129 
```

（所以在这里我不会在 1995 年第 1 周的比例是 2/100，并且能够构建 GLM 或 GAM）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T20:29:57.770

让我试一试，同时注意上面评论中已经说明的问题的所有限制

```
#Create the data frame with the total observations
tot.obs<-data.frame(year=rep(1995,10), weekno=1:10, obs=floor(runif(n=10,80,100)))
#Create the variable week-year
tot.obs$week.year<-paste(tot.obs$week,tot.obs$year,sep="-")

#Create the data frame species observations
species.data<-data.frame(site=factor(floor(runif(n=5,2000,3000))), week=c(1,1,2,4,7), year=rep(1995,5),observ=rep(1,5))
species.data$week.year<-paste(species.data$week,species.data$year,sep="-")
species.data$total.obs<-NA

#Match the total observations form the tot.obs data frame to the species data frame. You can probably do it much faster but here is a "quick and dirty way"

for (i in 1:dim(species.data)[1]){
  species.data$total.obs[i]<-tot.obs$obs[tot.obs$week.year==species.data$week.year[i]]  
}

#Calculates the percentage of the total observation that each center contributes
species.data$per.obs<-species.data$observ/ species.data$total.obs 

#For the presentation of the data, reshape is your friend
library(reshape)
species.data.melt<-melt(species.data,id.vars=c("site","week.year"), measure.vars="per.obs")

cast(species.data.melt,site~week.year, fun.aggregate=sum)

site     1-1995     2-1995     4-1995     7-1995
1 2436 0.00000000 0.00000000 0.01010101 0.00000000
2 2501 0.00000000 0.01123596 0.00000000 0.00000000
3 2590 0.00000000 0.00000000 0.00000000 0.01123596
4 2608 0.01030928 0.00000000 0.00000000 0.00000000
5 2942 0.01030928 0.00000000 0.00000000 0.00000000 
```

否则，如果您对每个中心的观察不感兴趣，事情会容易得多：

```
species.data.melt2<-melt(species.data,id.vars=c("week.year"), measure.vars="observ")
species.obs.total<-data.frame(cast(species.data.melt2,week.year~value, fun.aggregate=sum))
colnames(species.obs.total)[2]<-"aggregated.total"
species.obs.total$total<-NA

for (i in 1:dim(species.obs.total)[1]){
  species.obs.total$total[i]<-tot.obs$obs[tot.obs$week.year==species.obs.total$week.year[i]]  
}

species.obs.total$perc<-species.obs.total$aggregated.total/ species.obs.total$total
species.obs.total

  week.year aggregated.total total       perc
1    1-1995                2    97 0.02061856
2    2-1995                1    89 0.01123596
3    4-1995                1    99 0.01010101
4    7-1995                1    89 0.01123596 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T22:11:58.523

目前，数据过于简单，无法支持测试中的复杂性。该`xtabs`函数创建一个矩阵对象，可以除以该周的总数：

```
> xtblspec <-  xtabs( ~ SPECIES+ SITE_ID +WEEKNO + YEAR  , data=dat)     
> xtblspec
, , WEEKNO = 1, YEAR = 1995

         SITE_ID
SPECIES   1238 1286 1289 1538 1892 1894
  Attenb.    0    0    1    1    0    0

, , WEEKNO = 2, YEAR = 1995

         SITE_ID
SPECIES   1238 1286 1289 1538 1892 1894
  Attenb.    0    0    0    0    0    1

, , WEEKNO = 4, YEAR = 1995

         SITE_ID
SPECIES   1238 1286 1289 1538 1892 1894
  Attenb.    0    1    0    0    0    0

, , WEEKNO = 7, YEAR = 1995

         SITE_ID
SPECIES   1238 1286 1289 1538 1892 1894
  Attenb.    1    0    0    0    1    0
#-------------

weekobs <- totobs[ match( as.numeric(dimnames(xtblspec[ 1, ,  ,])$WEEKNO ) ,totobs$WEEKNO) ,
                  "TOTALOBS"]
#[1] 100 780 189 899 
```

要正确设置特定观察的矩阵，以便矩阵除法正常工作，您需要将 WEEKNO 作为第一个维度：

```
xtblspec <-  xtabs( ~ WEEKNO +SPECIES+ SITE_ID  + YEAR  , data=dat)
> xtblspec/weekobs
, , SITE_ID = 1238, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.000000000
     2 0.000000000
     4 0.000000000
     7 0.001112347

, , SITE_ID = 1286, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.000000000
     2 0.000000000
     4 0.005291005
     7 0.000000000

, , SITE_ID = 1289, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.010000000
     2 0.000000000
     4 0.000000000
     7 0.000000000

, , SITE_ID = 1538, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.010000000
     2 0.000000000
     4 0.000000000
     7 0.000000000

, , SITE_ID = 1892, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.000000000
     2 0.000000000
     4 0.000000000
     7 0.001112347

, , SITE_ID = 1894, YEAR = 1995

      SPECIES
WEEKNO     Attenb.
     1 0.000000000
     2 0.001282051
     4 0.000000000
     7 0.000000000 
```

# php - PHP 无法按索引提取数组值

> ID：11284964
> 
> 赞同：1
> 
> 时间：2012-07-01T19:23:44.660
> 
> 标签：php, arrays

好的，所以我现在正在开一家商店，以存储购物车，我使用了 $basketItems、$basketWeights 和 $basketQuantities 数组。每个索引将与篮子中的一个项目相关。

我的代码通过循环篮子中的每个项目（根据我拥有的数组）然后从数据库中提取相关信息来工作。

该代码适用于它从数据库中提取的第一行，但是一旦到达第二个项目就会失败，但我不知道为什么。

问题似乎出现在无法从 $weights 或 $prices 数组的正确索引处获取所需的值。您会在代码中注意到，为了检查数组 $weights 是否正确形成，我已经回显了它，还回显了我想要检索的索引，看起来不错，唯一的问题是它没有t echo任何东西（据我所知！）

代码如下

```
 <?
/*
$basketItems
$basketWeights
$basketProducts

are arrays, each value stores the index of the item relating to the product in the database */

//show basket, go through all the basket items, the retrieves relevant information from the database
for($index = 0; $index < sizeof($basketItems); $index++)
{
    //get product at this index
    $getProduct = mysql_query("SELECT * from shop_products where prid='".$basketItems[$index]."' limit 1") or die(mysql_error());
    $product = mysql_fetch_array($getProduct);
    //weights is an array for each product ie 100, 200, 500
    $weights = explode(",", $product['prweights']);
    $weightIndex = $basketWeights[$index];
    $prices = explode(",", $product['prprices']);
?> <tr>
<td><b><? print_r(array_values($weights)); ?></b></td>
</tr><tr>
    <td><? echo($product['prtitle']); ?></td>
    <td><? echo ("$weightIndex/$weights[$weightIndex]"); ?>g</td>
    <td><? echo($basketQuantities[$index]); ?></td>
    <td><? echo $prices[$weightIndex]; ?></td>
    <td><? echo ($prices[$weightIndex] * $basketQuantities[$index]); ?></td>
    <td>&nbsp;</td>
  </tr>
  <?

  }
?> 
```

结果可以在这里看到： [http ://www.jamesmoorhouse.co.uk/images/shop.png](http://www.jamesmoorhouse.co.uk/images/shop.png)

正如您从屏幕截图中看到的那样，它只是没有回显任何应该回显每个产品上方看到的数组的结果的地方。

第 2 列的测试格式为 arrayIndex/arrayValueAtIndex g

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T10:38:06.153

Just a couple of notes:

*   please move sizeof() out of for-loop. do the sizeof() calc before.
*   please remove () from echo. not needed.
*   you might do calculations before outputting
*   you might use unset() at the end of the for loop, on vars newly created inside the for-loop. that would prevent overwriting stuff or reusing data from iteration before.
*   i would remove the needs to use explode() when fetching them and implode() when updating/storing them. just store/fetch the data directly in the database.
*   you know all basketItem product ids (prids), just ask the database for the whole array of basketitems (prids=1,2,3,4,123) at once. mysql syntax: `WHERE prids IN('1','2','3')";` call the whole result set via `mysql_fetch_assoc()`. then foreach() the array. this reduces calls to the db.
*   to answer the question: i hope i'm not totally off track, but i would say that the error is `$weightIndex = $basketWeights[$index];` could you please provide the $basketWeights array data. the relationship does not fit: basketWeights must be assoc, i guess, like basketWeights[prdid][weights_index].

# c++ - 在 Visual C++ 2005 中编译

> ID：11284966
> 
> 赞同：1
> 
> 时间：2012-07-01T19:23:48.387
> 
> 标签：c++, visual-c++, visual-studio-2005

我写了一个 C++ DLL，它已经被编译了。它需要 Visual C++ 2010。如何为 Visual C++ 2005 编译它，它是否适用于 Windows XP、Windows Vista、Windows 7？

我的 DLL 使用 detours 1.5 和 windows 套接字。我使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T19:32:00.443

我猜你需要在同一台机器上安装 Visual C++ 2005，然后阅读这篇文章：

[http://weblogs.asp.net/israelio/archive/2009/10/20/enable-vs-2010-multi-targeting-also-for-vs2005-c.aspx](http://weblogs.asp.net/israelio/archive/2009/10/20/enable-vs-2010-multi-targeting-also-for-vs2005-c.aspx)

（我只为 VS 2008 工具链使用了 VS 2010 的多目标，但使用上面的补丁，它应该以类似的方式工作）。

# iphone - 如何有效地在合适的单元格中显示图像

> ID：11284971
> 
> 赞同：1
> 
> 时间：2012-07-01T19:24:41.070
> 
> 标签：iphone, objective-c, xcode

目前我有两种在单元格中显示图像的方式，哪种方式有助于表格顺利运行，我稍后会使用lazytable？在每个单元格中应该给按钮一个 setimage 还是添加一个带有 set image 的 imageview 一样好？同样在第一种方法中，我必须动态缩放每个图像。谢谢！

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];

UIImage *img = [UIImage imageWithData:"png image from url"];

[button setImage:img forState:UIControlStateNormal];

/// Or

UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];

UIImage *img = [UIImage imageWithData:"png image from url"];

UIImageView *imageView2 = [[UIImageView alloc] initWithImage:img];

[button2 addSubview:imageView2]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:34:35.823

既然按钮有图像属性，为什么要给按钮添加图像视图，推荐使用方法1

# php - PHP while循环生成KML文件

> ID：11284972
> 
> 赞同：2
> 
> 时间：2012-07-01T19:24:53.737
> 
> 标签：php, mysql, xml, kml

给定一个房地产数据的 MySQL 表，我想生成一个具有以下输出的 KML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
 <kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <Placemark>
      <name>Property Address Pulled from Address Field</name>
      <description>
      Some descriptive data pulled from table inserted here.
      </description>
      <Point>
        <coordinates>Latitude FROM Lat,Long FROM Lng</coordinates>
      </Point>
    </Placemark>
  </Document>
</kml> 
```

这是我到目前为止的代码。如您所见，我无法编写一个循环来构造我的 KML，如上所示。非常感谢任何帮助！

```
<?php 
require("phpsqlgeocode_dbinfo.php");

// Start XML file, create parent node
$dom = new DOMDocument('1.0', 'UTF-8');
$dom->formatOutput = true; //This was added from the PHP Doc. Nice output.

// Creates the root KML element and appends it to the root document.
$node = $dom->createElementNS('http://www.opengis.net/kml/2.2', 'kml');
$parNode = $dom->appendChild($node);

// Creates a KML Document element and append it to the KML element.
$dnode = $dom->createElement('Document');
$docNode = $parNode->appendChild($dnode);

// Opens a connection to a mySQL server
$connection=mysql_connect (localhost, $username, $password);
if (!$connection) {
  die("Not connected : " . mysql_error());
}

// Set the active mySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
  die ("Can\'t use db : " . mysql_error());
}

// Search the rows in the markers table
$query = sprintf("SELECT * FROM markers");
$result = mysql_query($query);
if (!$result) {
  die("Invalid query: " . mysql_error());
}

header("Content-type: application/vnd.google-earth.kml+xml");

// Iterate through the rows, adding KML nodes for each
while ($row = @mysql_fetch_assoc($result)){
  $dnode = $dom->createElement("Placemark");
  $newnode = $docNode->appendChild($dnode);
  $newnode = $newnode->createElement("Name");
  $newnode = $newnode->createElement("Description");  
  $newnode = $newnode->createElement("Coordinates");
  }
echo $dom->saveXML() . "\n";
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-01T19:32:27.147

`createElement()`据我所知（并且基于我对文档的阅读[）](http://www.php.net/manual/en/class.domdocument.php)`DOMDocument` ，它是类（根文档）的一种方法，`$dom`而不是.`DOMElement`

您已经创建了 3 个新元素，但您还没有将它们中的任何一个附加为`$dnode`. 用于`$dom->createElement()`每个并将其附加到正确的`$dnode (Placemark)`

```
// Iterate through the rows, adding KML nodes for each
while ($row = mysql_fetch_assoc($result)){
    $dnode = $dom->createElement("Placemark");
    $newnode = $docNode->appendChild($dnode);

    // Append each $newnode after creating from $dom
    // Set its nodeValue to a column from your fetch call
    // before appending it to the parent node
    // Substitute your correct column names from mysql_fetch_assoc()
    $newnode = $dom->createElement("Name");
    $newnode->nodeValue = $row['Name'];
    $dnode->appendChild($newnode);

    $newnode = $dom->createElement("Description");  
    $newnode->nodeValue = $row['Description'];
    $dnode->appendChild($newnode);

    //Coordinates are a child node of the 'Point' node       
    $pointnode = $dom->creteElement("Point");
    $dnode-appendChild($pointnode);

    $coordsnode = $dom->createElement("Coordinates");
    $coordsnode->nodeValue = $row['Coordinates'];
    $pointnode->appendChild($coordsnode);
}
echo $dom->saveXML() . "\n"; 
```

要强制使用 .kml 文件名，请使用`Content-Disposition`标头：

```
header("Content-type: application/vnd.google-earth.kml+xml");
header("Content-disposition: inline; filename=$somefilename.kml"); 
```

# android - 重复任务：更改 ListView 中的 TextView

> ID：11284977
> 
> 赞同：0
> 
> 时间：2012-07-01T19:26:24.907
> 
> 标签：android, listview

我有一个 ListView，在列表的每个项目中都包含一个 TextView。

```
<LinearLayout
......>
<i>//other views</i>
.....
<TextView android:id="@+id/frequently_changing" > <i>//updated every 1s</i>

</LinearLayout> 
```

如何从我的活动中更改 textView，例如 Timer、线程 .. 没有安全错误“只有创建视图的 UI 人线程有权更改它”

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:59:18.667

尝试使用[runOnUiThread](http://developer.android.com/reference/android/app/Activity.html)将 Textview 从 Thread 更新为

```
public void myThread(){
        Thread th=new Thread(){

         @Override
         public void run(){
          try
          {

           while(true)
           {

           Thread.sleep(100L); //SET INTERVAL TO UPDATE TEXTVIEW TEXT
           Your_Current_Activity.this.runOnUiThread(new Runnable() {

            @Override
            public void run() {

            TextView txt= (TextView) findViewById(R.id.textview); 
            txt.setText(str);  SET TEXT HERE
           });
           }
          }catch (InterruptedException e) {
        // TODO: handle exception
       }
         }
        };
        th.start();
       } 
```

# algorithm - 有多少可能的记分卡与输入记分卡一致？

> ID：11284978
> 
> 赞同：3
> 
> 时间：2012-07-01T19:26:28.517
> 
> 标签：algorithm, dynamic-programming

我一直在尝试解决面试街的以下问题。计分卡（30 分）

在一场锦标赛中，N 名玩家互相对战一次。每场比赛都会导致任一玩家获胜。没有关系。您已经给出了一张记分卡，其中包含每个玩家在比赛结束时的得分。玩家的得分是玩家在锦标赛中赢得的总局数。然而，一些球员的分数可能已经从记分卡中删除了。有多少可能的记分卡与输入记分卡一致？

输入：第一行包含案例 T 的数量。接下来是 T 案例。每个案例在第一行包含数字 N，然后在第二行包含 N 个数字。第 i 个数字表示 s_i，即第 i 个玩家的得分。如果第 i 个玩家的分数已被擦除，则以 -1 表示。

输出：输出 T 行，包含每个案例的答案。输出每个结果模 1000000007。

```
Constraints:
1 <= T <= 20
1 <= N <= 40
-1 <= s_i < N

Sample Input:
5
3
-1 -1 2
3
-1 -1 -1
4
0 1 2 3
2 
1 1
4
-1 -1 -1 2

Sample Output:
2
7
1
0
12 
```

解释：对于第一种情况，可能有 2 个记分卡：0,1,2 或 1,0,2。对于第二种情况，有效记分卡为 1,1,1, 0,1,2, 0,2,1, 1,0,2, 1,2,0, 2,0,1, 2,1,0 . 对于第三种情况，唯一有效的记分卡是 {0,1,2,3}。对于第四种情况，没有有效的记分卡。两个玩家都得 1 分是不可能的。

我试图提出通用函数方法，但我真的试图使用动态编程来解决这个问题。你怎么能想到这个问题的递归关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T06:50:41.343

这是上述问题的DP解决方案

```
 public static int[][] table;  // stores the result of the overlapping sub problems
private static int N;

public static void main(String args[]) {
    Scanner scanner = new Scanner(System.in);
    int testCases = scanner.nextInt();
    for (int i = 0; i < testCases; i++) {
        N = scanner.nextInt();
        int[] scores = new int[N];
        for (int j = 0; j < N; j++) {
            scores[j] = scanner.nextInt();
        }
        long result = process(scores) % 1000000007L;
        System.out.println(result );

    }

}

private static long process(int[] scores) {
    int sum = 0; 
    int amongPlayers = 0; //count no of players whose score has been erased(-1)
    for (int i = 0; i < N; i++) {
        if (scores[i] != -1) {
            sum += scores[i];
        } else {
            amongPlayers++; 
        }
    }

    int noGames = (N * (N -1)) /2;  // total number of games

    if (sum < noGames) {
        int distribute = noGames - sum;  // score needed to be distributed;
        table = new int[distribute + 1 ][amongPlayers + 1];
        for (int m = 0; m <= distribute; m++) {
            for (int n = 0; n <= amongPlayers; n++) {
                table[m][n] = -1;
            }
        }
        return distribute(distribute, amongPlayers); // distrubute scores among players whose score is erased(-1)
    }
    else if(sum == noGames){
        return 1;
    }

    return 0;
}

/**
 * Dynamic programming recursive calls
 * @param distribute
 * @param amongPlayers
 * @return
 */
private static int distribute(int distribute, int amongPlayers) {
    if(distribute == 0 && amongPlayers == 0)
        return 1;

    if (amongPlayers <= 0)
        return 0;

    if(distribute == 0)
        return 1;

    int result = 0;
    if (table[distribute][amongPlayers - 1] == -1) {
        int zeroResult = distribute(distribute, amongPlayers - 1);
        table[distribute][amongPlayers - 1] = zeroResult;
    }
    result += table[distribute][amongPlayers - 1];

    for (int i = 1; i < N ; i++) { // A person could win maximum of N-1 games
        if (distribute - i >= 0) {
            if (table[distribute - i][amongPlayers - 1] == -1) {
                int localResult = distribute(distribute - i,
                        amongPlayers - 1);
                table[distribute - i][amongPlayers - 1] = localResult;
            }
            result += table[distribute - i][amongPlayers - 1];
        }
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-01T08:13:58.587

观察：

序列 s[1], s[2], ..., s[n] 是一致的记分卡，这些属性必须满足：

1.  s[i1] + s[i2] + .. + s[ik] >= k * (k — 1) / 2，其中 i1 < i2 < .. < ik（即对于每个长度为 k 的子序列）
2.  s[1] + s[2] + .. + s[n] = n * (n — 1) / 2

首先，我们需要检查未擦除的分数，只需使用 1 个条件。然后使用动态编程放置擦除的分数。

让我们表示擦除分数 b[i]，而不是擦除分数 a[i]；

sum{i = 1 .. l} a[i] + sum{i = 1 .. k} b[i] >= (k + l) * (k + l - 1) / 2

sum{i = 1 .. l} a[i] + sum{i = 1 .. k} b[i] >= 0 + 1 + .. + (k + l - 1)

sum{i = 1 .. l} (a[i] - (k + i - 1)) + sum{i = 1 .. k} b[i] >= 0 + 1 + .. + (k - 1 )

所以我们可以预先计算每个 k 的最小值 sum{i = 1 .. l} (a[i] - (k + i - 1))/

动态规划：

状态：

dp[k][score][sum]：我们知道前k个最小擦除分数，它们的值不超过$score$，sum就是它们的总和。

过渡：

1.  跳过分数，dp[k][score][sum] += dp[k][score + 1][sum]；

2.  将 $i$ 的得分值 $score$ dp[k][score][sum] += C[m — k][i] * dp[k + i][score + 1][sum + i*score] ，其中 m 个已擦除分数，C[n][k] = 组合。

**[我的代码](http://pastebin.com/cPFDw1hK)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-09T17:58:21.227

尝试这个

```
import java.util.Scanner;

public class Solution {

final private static int size = 780;
private static long[][] possibleSplits = new long[size][size];

static {

    for(int i=0; i < size; ++i)
        possibleSplits[i][0] = 1;

    for(int j=0; j< size; ++j)
        possibleSplits[0][j] = j+1;

    for(int i=1; i< size; ++i)
        for(int j=1; j < size; ++j)
        {
            possibleSplits[i][j] = (possibleSplits[i-1][j] + possibleSplits[i][j-1]) % 1000000007;              
        }       
}

public long possibleWays = 0;

public Solution(int n, String scores)
{   
    long totalScores = 0;
    int numOfErasedScores = 0; 

    for(String str : scores.split(" "))
    {
        int s = Integer.parseInt(str);

        if (s < 0)
            ++numOfErasedScores;
        else        
            totalScores += s;
    }

    long totalErasedScores = ncr(n,2) - totalScores;

    if(totalErasedScores == 0)
        ++possibleWays;
    else if (totalErasedScores > 0)
        partition(n-1, totalErasedScores, numOfErasedScores);
}

private void partition(int possibleMax, long total, int split)
{       
    if (split == 0)
        return;

    possibleWays = possibleSplits[(int)total-1][split-1];       

    if (total > possibleMax)
        possibleWays -= split;      
}

public static void main(String[] args)
{
    Scanner in = new Scanner(System.in);

    int numberOfTestCases = Integer.parseInt(in.nextLine().trim());

    for(int i=0; i< numberOfTestCases; ++i)
    {
        String str = in.nextLine().trim();

        int    numberOfPlayers = Integer.parseInt(str);
        String playerScores    = in.nextLine().trim();

        long result = new Solution(numberOfPlayers, playerScores).possibleWays;

        System.out.println(result % 1000000007);
    }

    in.close();
}

public static long ncr(int n, int r)
{
    long result = 1;

    for(int i= Math.max(n-r, r)+1;i<=n;++i)
        result*= i;

    result/= fact(Math.min(n-r,r));

    return result;
}

public static long fact(int n)
{
    long result = 1;

    for(int i =2; i<= n; ++i)
        result *= i;

    return result;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-22T05:53:43.627

获胜的总和应该是（NC 2）

减去输入中给出的已知值。让剩余的总和 (NC 2) - x 称为 S。让输入中的 -1 的数量为 Q。

现在的问题归结为找到**Q 变量的积分解决方案的数量，范围从 0 到 N-1（可能的最大分数）并且总和为 S**

令 DP[q][s] 表示总和为 s 的 q 个变量的积分解数

然后我们有，

```
DP[q][s] = Sum (i=0 to N-1) DP[q-1][s-i] 
```

DP[Q][S] 给出解

编辑：
观察：对于剩余的 x 人，总获胜次数应至少为 x*(x-1)/2（当他们互相比赛时）。因此，在任何时候对于 q 个人，s 不能超过 (Nq)(Nq-1)/2 = M

当 s 大于 M 时，应该还有一个约束 DP[q][s] 应该等于 0

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T20:46:53.287

我也在尝试解决这个任务，并认为它应该是这样的：

给出了玩家的数量（=N），未知牌的数量（计算“-1”）和已知牌的总和（计算除“-1”之外的所有牌）。可能的游戏总数应该是 1 +2 +3 + ... + (players-1)：第一个玩家有 (players-1) 个对手，第二个玩家有 (players-2) 个等等。

现在您可以递归地计算可能的记分卡的总和：

以（玩家、未知牌、已知牌的总和）为键，以可能的记分牌的总和为值，初始化一个空的 hashmap。

如果定义了所有牌，则答案为 0（如果所有牌的总和等于可能的游戏总数）或 1（如果所有牌的总和不等于可能的游戏总数）。

如果未定义所有卡片，则运行 for 循环并将一张未知卡片设置为 0、1、2 ... (players-1) 并尝试从哈希图中读取结果。如果它不在 hashmap 中，则调用方法本身并将结果保存在 map 中。

递归代码应该是这样的：

```
def recursion(players: Int, games: Int, unknownCards: Int, knownScore: Int): Int = {
  unknownCards match {
    case 0 if knownScore != games => 0
    case 0 if knownScore == games => 1
    case _ =>
      map.get(players, unknownCards, knownScore) getOrElse {
        var sum = 0
        for (i <- 0 until players) sum += main(players, games, unknownCards - 1, knownScore + i)
        sum %= 1000000007
        map.put((players, unknownCards, knownScore), sum)
        sum
      }
  }
} 
```

# python - Python使用队列进行倒数看门狗定时器

> ID：11284980
> 
> 赞同：0
> 
> 时间：2012-07-01T19:26:45.297
> 
> 标签：python, queue, watchdog

我有一个产生 4 个线程的程序，这些线程需要无限期地保持运行，如果其中一个崩溃我需要知道以便我可以重新启动。

如果我使用一个包含 4 个数字的列表并通过使用队列将其传递给每个线程。然后每个线程所要做的就是在主线程倒计时时重置计时器中的部分。

所以队列永远不会是空的，只有一个值可以变为 0，然后如果发生这种情况，那么主线程知道它的子线程没有响应，它可以采取相应的行动。

但是每次我从队列中获取 .get() 时，它都会使其为空，所以我必须从队列中获取，存储到变量中，修改变量并将其放回队列中。

使用这样的队列作为看门狗可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:36:10.920

如果您使用`Thread`s，您可以定期检查[`threading.enumerate`](http://docs.python.org/library/threading.html#threading.enumerate)以确保您有正确数量和类型的线程正在运行。

但是，同样，将事物传递到从线程返回的队列中是一种我至少*见过*用于确保线程仍在运行的技术。因此，如果我对您的理解正确，那么您所做的并不是完全疯狂。

您的“线程必须偶尔重新设置其前哨”*可能*更有意义，将其作为每个都应尽快响应的`Queue`s列表。`Thread`这取决于您的线程是否实际上在执行进程密集型工作，或者它们是否只是出于界面原因而在后台运行。如果他们*没有*把所有时间都花在数学上，你可以这样做：

```
def guarded_thread(sentinal_queue, *args):
    while True:
        try:
            sentinal_queue.get_nowait()
            sentinal_queue.put('got it')
        except Queue.Empty:

            # we just want to make sure that we respond if we have been
            # pinged
            pass

        # do actual work with other args

def main(arguments):
    queues = [Queue() for q in range(4)]
    threads = [(Thread(target=guarded_thread, args=(queue, args)), queue)
               for queue, args in zip(queues, arguments)]

    for thread, queue in threads:
        thread.start()

    while True:
        for thread, queue in threads:
            queue.put(True)

        for thread, queue in threads:
            try:
                response = queue.get(True, MAX_TIMEOUT)
                if response != 'got it':
                    # either re-send or restart the thread
            except Queue.Empty:
                # restart the thread
        time.sleep(PING_INTERVAL) 
```

请注意，您还可以使用不同的请求/响应队列来避免使用不同类型的标记值，这取决于您的实际代码，哪个看起来不那么疯狂。

# javascript - Javascript - 轻微的除法错误

> ID：11284981
> 
> 赞同：-1
> 
> 时间：2012-07-01T19:27:19.230
> 
> 标签：javascript, math

> **可能重复：**
> [Javascript 数学错误：不精确的浮点数](https://stackoverflow.com/questions/3556789/javascript-math-error-inexact-floats)

我做了这个

```
this.cues = []
for(var i, i = 1; i <= 8; i++){
    cue = this.length * (i/8.0)
   this.cues.push(cue) 
```

this.length 是双精度数。我检查了除法，发现我偏离了 0.000002，直到大约第四个阵列单元。

1.  是否有任何人能想到的特定于 javascript 的原因？这可能只是环境，所以如果不是什么大不了的事
2.  如果是这样，我可以修复它吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T19:29:18.820

这是意料之中的。由于计算机内部存储的方式，计算机上的[浮点](http://en.wikipedia.org/wiki/Floating_point)运算具有像这样的[小精度误差。](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)有关更多信息，我建议您阅读[每个计算机科学家都应该了解的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

> 将无限多个实数压缩为有限位数需要近似表示。尽管整数有无限多，但在大多数程序中，整数计算的结果可以存储在 32 位中。相反，给定任何固定位数，大多数实数计算将产生无法使用那么多位精确表示的量。因此，浮点计算的结果必须经常四舍五入以适应其有限表示。这种舍入误差是浮点计算的特征。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T19:30:56.167

您应该阅读：*“[每个程序员都应该知道的关于浮点运算的知识](http://floating-point-gui.de/)”*。这就是浮点数在计算机上的简单表示方式。

# django - 使用 pycharm 调试 django heroku foreman

> ID：11284989
> 
> 赞同：4
> 
> 时间：2012-07-01T19:28:48.553
> 
> 标签：django, heroku, pycharm, foreman

我最近搬到 Heroku 来部署 Django 应用程序。它运行良好，但是我使用 Pycharm 进行调试并且最近遇到了一个问题，因为 Pycharm 不会使用 .env 文件环境变量进行调试。如何使用工头调试 Django 应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T21:49:28.233

不幸的是，尚不支持从 .env 文件加载环境变量。您可以为该问题投票[http://youtrack.jetbrains.com/issue/PY-5543](http://youtrack.jetbrains.com/issue/PY-5543)以获得有关进展的通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-04T23:55:09.183

您可以从 .env 文件中读取本地默认环境变量并将它们设置在您的环境中。这已在此处详细记录 - [http://www.wellfireinteractive.com/blog/easier-12-factor-django/](http://www.wellfireinteractive.com/blog/easier-12-factor-django/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T20:44:03.290

我使用调试时在文件顶部手动调用的代码块来解决此问题。这是一个相当蹩脚但有效的解决方案：

```
import os

def load_environment():
    env = {}
    with open('.env', 'r') as env_file:
        env_vars = env_file.readlines()
        for v in env_vars:
            v = v.strip().replace('"', '').replace("'", '')
            if v and v[0] != '#':
                v = v.split('=')
                env[v[0]] = v[1]

    os.environ.update(env) 
```

然后从我正在调试的任何应用程序或脚本中调用它，例如：

```
from debug.environment_loader import load_environment
load_environment() 
```

在访问任何环境变量之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-19T05:10:03.753

正如[Dmitry 的回答](https://stackoverflow.com/a/11285889/134610)中链接的[支持页面所记录的那样，现在有一个名为](https://youtrack.jetbrains.com/issue/PY-5543)[EnvFile](https://github.com/Ashald/EnvFile)的第 3 方 PyCharm 插件，它将在执行之前导入您的内容。`.env`

# actionscript-3 - AS3：获取 URL 名称

> ID：11284993
> 
> 赞同：0
> 
> 时间：2012-07-01T19:29:23.220
> 
> 标签：actionscript-3, url, embed

试图获取我发布了 flash 对象的网站的当前 URL，而不使用 Javscript 或 ExternalInterface 调用。

例如

我发帖的网站是[http://some.forum.com](http://some.forum.com)

swf 的网址是[http://uploaded.to/site/of/object.swf](http://uploaded.to/site/of/object.swf)

在我在 some.forum.com 的帖子中，我在帖子中包含：

> [flash=100,100]http://uploaded.to/site/of/object.swf[/flash]

不幸的是，它一直返回我最初上传到的网站的网址，而不是我链接它的当前论坛。

目前使用的方法有：

> var urlname:LocalConnection = new LocalConnection();
> 
> 跟踪（urlname.domain（））；

和

> var urlName:String = this.loaderInfo.url;
> 
> 跟踪（网址名称）

两者都返回 upload.to/site/of/object.swf，而不是 some.forum.com

如何获得我想要的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T23:48:40.697

不确定它是否适用于您的场景，但您是否尝试过 BrowerManager：[http ://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf64e50-7ff8.html](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf64e50-7ff8.html)

就像是

```
var browserManager:BrowserManager = BrowserManager.getInstance();
trace(browserManager.url); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T23:10:08.190

唔。好吧，我找到了一个小解决方法：推荐人。

我需要做的就是让 swf 请求另一个网站，该网站执行一些 javascript 或 php 以返回引荐网站的 URL。

```
var textLoader:URLLoader = new URLLoader()
var textReq:URLRequest = new URLRequest("http://my.site.com/findReferrer.html");
textLoader.load(textReq);
textLoader.addEventListener(Event.COMPLETE, trace(textLoader.data); 
```

不幸的是，referrer 完全依赖于浏览器，并且通常不适用于 https。所以回到第一方..

# c# - 如何在 GTK# Spin Button 中右对齐数字？

> ID：11284994
> 
> 赞同：0
> 
> 时间：2012-07-01T19:29:24.610
> 
> 标签：c#, mono, monodevelop, gtk#

谁能告诉我如何正确对齐 GTK# 旋转按钮控件中的数字？

我一生都无法弄清楚它是如何在那里工作的。文档很少，经过多次尝试，我只是画了一个空白。

提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-01T22:51:25.457

它是的子类`Gtk.Entry`- 您应该能够将`Xalign`属性设置为 false。

# c# - 通知图标气球提示未在 C# 中显示？

> ID：11284997
> 
> 赞同：12
> 
> 时间：2012-07-01T19:30:06.030
> 
> 标签：c#, winforms, notifications, notifyicon, visual-c#-express-2010

我在 form1_load 下使用此代码

```
notifyIcon1.Visible = true; 
notifyIcon1.ShowBalloonTip(5000, "Welcome", "Hello " + User, ToolTipIcon.Info); 
```

我什至检查了我的注册表，值为 1。为什么气球没有显示？我的通知图标确实有一个图标。它正在出现。气球不是！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-01T19:56:13.503

看起来你忘了像这样为它设置图标

```
notifyIcon1.Icon = SystemIcons.Exclamation;
notifyIcon1.Visible = true; 
notifyIcon1.ShowBalloonTip(5000, "Welcome", "Hello " + User, ToolTipIcon.Info); 
```

另请阅读有关 NI 问题的更多信息[http://www.csharp411.com/notifyiconshowballoontip-issues/](http://www.csharp411.com/notifyiconshowballoontip-issues/)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-01T19:41:36.007

您可能需要发布表单加载事件中的其余代码，但这里有一些建议：

1.  确保表单的 Load 事件实际上已连接。
2.  确保您已为通知图标分配了一个图标。

另外，请注意，不保证会显示气球提示。请参阅 msdn 的[NotifyIcon.ShowBalloonTip 方法](http://msdn.microsoft.com/en-us/library/ms160064.aspx)文章的备注部分：

> **备注**
> 最小和最大超时值由操作系统强制执行，通常分别为 10 秒和 30 秒，但是这可能因操作系统而异。将太大或太小的超时值调整为适当的最小值或最大值。此外，如果用户似乎没有在使用计算机（没有发生键盘或鼠标事件），则系统不会将此时间计入超时。
> 
> 一次只能在任务栏上显示一个气球提示。在任务栏上当前显示气球提示时尝试显示气球提示会导致超时值被忽略。行为略有不同，具体取决于操作系统以及气球提示是否来自另一个或相同的应用程序。当第二个气球提示来自另一个应用程序时，第一个气球提示将在第二个出现之前显示为最小超时值，而不管超时值如何。在大多数情况下，如果气球提示来自同一个应用程序，当再次调用 ShowBalloonTip 方法时，第一个气球提示会立即关闭。在某些情况下，第二个气球会在第一个气球的顶部打开。
> 
> 标题文本将在气球顶部附近以粗体显示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-01T19:53:40.057

这是@MetroSmurf 已经提到的一些示例代码。请注意，`this.InitializeComponent();`必须在`NotifyIcon`显示之前调用（通常在表单构造函数中）。

```
public Form1()
{
    this.InitializeComponent();
}

private void Form1_Load(object sender, EventArgs e)
{
    notifyIcon1.Icon = new Icon(@"C:\SomePath\MyIcon.ico");
    notifyIcon1.Visible = true;
    notifyIcon1.ShowBalloonTip(5000, "Welcome", "Hello " + User, ToolTipIcon.Info);
} 
```

还要确保将窗口配置为允许通知。在 Windows 7 中右键单击任务栏，单击通知区域中的*属性*、*自定义...*，勾选*始终在任务栏上显示所有图标和通知*选项，单击*确定*。

# azure - 无法在 SQL Azure 中的数据库之间进行查询

> ID：11284998
> 
> 赞同：73
> 
> 时间：2012-07-01T19:30:13.203
> 
> 标签：azure, azure-sql-database, azure-elastic-scale

我有一个 SQL Azure 数据库服务器，我需要在数据库之间进行查询，但不知道如何完成。

这是我的数据库的结构：

*   **服务器.X**
    *   **数据库.A**
    *   **数据库.B**
    *   **数据库.C**

在**Database.A**我有一个需要从**Database.B**检索数据的存储过程。通常，我会像这样引用数据库，`SELECT * FROM [Database.B].[dbo].[MyTable]`但这似乎在 SQL Azure 中是不允许的。

`Msg 40515, Level 15, State 1, Line 16 Reference to database and/or server name in 'Database.B.dbo.MyTable' is not supported in this version of SQL Server.`

有没有办法在数据库端做到这一点？

在最终版本中，数据库 A 和 C 都需要来自数据库 B 的数据。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-07-01T19:38:27.517

**更新：**

根据 Illuminati 的评论和回答，自从这个答案最初被接受以来，情况已经发生了变化，现在根据[https://azure.microsoft.com/en-us/blog/querying-remote-databases-支持跨数据库查询在-azure-sql-db/](https://azure.microsoft.com/en-us/blog/querying-remote-databases-in-azure-sql-db/)

***原始答案 (2013)：*** *SQL Azure 不支持跨数据库查询。这意味着您需要首先组合数据库以防止需要，或者独立查询两个数据库并基本上将数据连接到您的应用程序中。*

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-12-22T23:17:39.283

SQL Azure 现在支持跨数据库查询

[https://azure.microsoft.com/en-us/blog/querying-remote-databases-in-azure-sql-db/](https://azure.microsoft.com/en-us/blog/querying-remote-databases-in-azure-sql-db/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-07-08T05:39:11.907

Azure SQL DB 目前正在预览弹性数据库查询功能，这将帮助你在 Azure SQL DB 之间进行查询，但有一些限制。您可以在[此处](https://azure.microsoft.com/en-us/documentation/articles/sql-database-elastic-query-vertical-partitioning/)获取有关该功能的详细信息。