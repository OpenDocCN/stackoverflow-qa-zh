# StackOverflow 问答 11486000-11486999

# android - 未找到 Android 虚拟设备

> ID：11486000
> 
> 赞同：0
> 
> 时间：2012-07-14T17:51:13.220
> 
> 标签：android, eclipse, sdk, adb, avd

我安装了 Android SDK 和 Eclipse 以及一切。当我运行我的第一个 Android 应用程序时，出现以下错误：

SDK 管理器] 找不到 ABI armeabi 的“userdata.img”文件以复制到 AVD 文件夹中。

我该如何解决这个问题？ ![在此处输入图像描述](../Images/e2c8da19e92b52de657dacef71258144.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:44:51.787

按照此博客中的步骤操作：http: [//tech.thecoolblogs.com/2012/01/unable-to-find-userdataimg-file-for-abi.html](http://tech.thecoolblogs.com/2012/01/unable-to-find-userdataimg-file-for-abi.html)

# variables - Actionscript 3：如何使动画剪辑变量与舞台上的变量一起使用（Healthbar 帮助）

> ID：11486007
> 
> 赞同：0
> 
> 时间：2012-07-14T17:51:58.483
> 
> 标签：variables, actionscript, layer, movieclip

我在整个编程方面完全是新手，我真的需要帮助。所以基本上，我正在尝试制作一个会根据单击的按钮增加或减少的健康栏。我制作了一个 101 帧（我包括零帧）的 healthbar 影片剪辑，并将其放在影片剪辑的动作脚本层中：

```
var health:Number = 0;

if(health == 0)
{
        gotoAndStop("1")
}

if(health == 1)
{
        gotoAndStop("2")
}

if(health == 2)
{
        gotoAndStop("3")
} 
```

就这样继续下去。基本上，在舞台上，我有一个名为 fortyfiveup_btn 的按钮，用于执行此操作：

```
var health:Number = 0;

fortyfiveup_btn.addEventListener(MouseEvent.CLICK, fortyfiveupClick);
function fortyfiveupClick(event:MouseEvent):void{
    health = health+45
} 
```

我很快意识到两个健康变量，一个用于按钮的变量和一个用于健康栏的变量都不会交互。如果单击按钮，我该如何做到这一点，健康状况会转到相关的框架或百分比？

感谢您的任何回答，我很感激我能得到的所有帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:06:13.427

如果`answer == yes`对我的评论你应该这样做：

你需要给movieclip一个instancename（也许是lifebar），并且从stage你可以访问“lifebar”里面的健康`lifebar.health`。

所以你在你的舞台上需要这个：

```
//You can delete the var health:Number = 0;
fortyfiveup_btn.addEventListener(MouseEvent.CLICK, fortyfiveupClick);
function fortyfiveupClick(event:MouseEvent):void{
    //You can write this, too: lifebar.health += 45;
    lifebar.health = lifebar.health+45;
} 
```

您甚至可以优化您的生命条脚本，不要使用 101 次，`if(health == x)`您也可以使用它：

```
gotoAndStop(health + 1); 
```

（我认为这是在一个`ENTER_FRAME`事件中？）

**编辑：**

一些错误对策：

```
//Don't let health decrease below 0
if(health < 0) health = 0;
//And don't above 100
else if(health > 100) health = 100;
gotoAndStop(health + 1); 
```

当你不使用十进制数字和不使用负整数时使用`int`而不是（当数字可以下降到 0 以下时，这个错误，所以为了你的健康，我们采取）：`Number``uint``int`

```
health:int = 0; 
```

# jquery - JQGRID 基于下拉值填充文本框？

> ID：11486013
> 
> 赞同：1
> 
> 时间：2012-07-14T17:52:31.887
> 
> 标签：jquery, combobox, textbox, jqgrid

情况是我想在组合框中选择/更改值后在文本框中动态插入值。

我怎样才能做到这一点？我对 JQGrid 很陌生...

```
$(document).ready(function() {
  $("#datagrid").jqGrid({
      url: 'actionpo.php?vid=polpogridjq',
      datatype: 'xml',
      mtype: 'GET',
      colNames: ['List#', 'PO#', 'Item Code', 'Item Detail', 'Qty', 'Price', 'Tax'],
      colModel: [{
          name: 'polistno',
          width: 100,
          editable: true,
          editable: true,
          key: true
        },
        {
          name: 'polpono',
          index: 'polpono',
          width: 100,
          editable: true,
          key: false
        },
        {
          name: 'politemcode',
          index: 'politemcode',
          width: 100,
          align: 'right',
          sortable: true,
          editable: true,
          edittype: "select",
          editrules: {
            required: true
          },
          editoptions: {
            size: 1,

            dataUrl: 'actionpo.php?vid=populatesel',
            dataEvents: [{
                type: 'change',
                fn: function(e) {
                  var thisval = $(e.target).val();
                  $.get('actionpo.php?vid=getitemname&itemcode=' + thisval, function(data) {
                    var res = $(data).html();
                    alert(res)
                    $('#politemname').html(res);

                  }); // end get
                } //end func
              } // end type
            ] // dataevents
          } //edit options 
        },
        {
          name: 'politemname',
          id: "L1",
          width: 300,
          align: 'left',
          sortable: false,
          editable: true
        },
        {
          name: 'politemqty',
          width: 50,
          align: 'right',
          sortable: false,
          editable: true
        },
        {
          name: 'politemvalue',
          width: 80,
          align: 'left',
          sortable: false,
          editable: true
        },
        {
          name: 'politemtax',
          width: 50,
          align: 'right',
          editable: true
        }

      ],

      pager: $('#pager'),
      rowNum: 10,
      rowList: [10, 20, 30],
      sortname: 'polpono',
      sortorder: 'desc',
      shrinkToFit: false,
      rownumbers: false,
      multiselect: false,
      viewRecords: false,
      clearAfterAdd: true,
      caption: 'Itemised Quantity',
      editurl: "actionpo.php?vid=gridformcall",
    }
  ).navGrid('#pager', {
      edit: true,
      add: true,
      del: true,
      search: false,
      refresh: true
    }, {
      //Edit Options            
    }, { //Add Options
    }, {
      //Delete Options
      width: 350,
      caption: 'Delete User',
      msg: 'Are you sure you want to delete this User?\nThis action is irreversable.',
      onclickSubmit: function(rp_ge, postdata) {
        rp_ge.url = "actionpo.php?vid=gridformcall&delpono=" +
          $('#datagrid').getCell(postdata, 'polpono');
      }
    }, {} //Search options 
  );
}); 
```

文本框是“politemname”，下拉列表是“politemcode”。组合列表工作正常，只是我无法将从下面的代码中收到的值分配给文本框。

```
$.get('actionpo.php?vid=getitemname&itemcode='+thisval, function(data) 
```

还有一种方法可以从 JQgrid 中的模态表单中获取元素（我认为是 CSS）名称的 id 吗？

# javascript - 什么是闭包编译器？

> ID：11486022
> 
> 赞同：2
> 
> 时间：2012-07-14T17:53:13.700
> 
> 标签：javascript

如果您不知道我在说什么，请查看：[http](http://closure-compiler.appspot.com/home) : //closure-compiler.appspot.com/home（这是一个 JavaScript 压缩程序）

* * *

在他们的网站上，他们声明如下：

> Closure Compiler 将 JavaScript 编译成紧凑的高性能代码。编译器会删除死代码并重写并最小化剩下的代码，以便快速下载和运行。它还检查语法、变量引用和类型，并警告常见的 JavaScript 陷阱。这些检查和优化可帮助您编写错误更少且更易于维护的应用程序。

但是有人真的可以详细解释一下这个闭包编译器对我的代码做了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T17:56:36.187

闭包编译器将编译您的代码，并对您的代码执行标准优化技术。

从表面上看，生成的代码可能具有相似性，也可能不具有相似性，但通常工作方式完全相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T17:56:06.477

[https://developers.google.com/closure/compiler/docs/compilation_levels](https://developers.google.com/closure/compiler/docs/compilation_levels)

> ADVANCED_OPTIMIZATIONS 转换包括：
> 
> *   更激进的重命名：
>     使用 SIMPLE_OPTIMIZATIONS 编译只会重命名函数中的参数和变量。ADVANCED_OPTIMIZATIONS 还重命名全局变量、函数名和属性。
>     
>     
> *   死代码删除：
>     使用 ADVANCED_OPTIMIZATIONS 进行编译会删除可证明无法访问的代码。这在与大型库结合使用时特别有用。如果您只使用大型库文件中的几个函数，编译器可以从其输出中删除除这些函数之外的所有内容。
>     
>     
> *   全局内联：
>     使用 ADVANCED_OPTIMIZATIONS 的编译将一些函数调用替换为函数体。这种转换称为“内联”。编译器仅在确定内联是安全的并节省空间时才内联函数。当编译器确定它可以安全地这样做时，使用 ADVANCED_OPTIMIZATIONS 进行编译也会内联常量和一些变量。

# php - 使用 jquery 将数据发布到类

> ID：11486023
> 
> 赞同：1
> 
> 时间：2012-07-14T17:53:15.197
> 
> 标签：php, jquery, mysql, post

我正在尝试将一些数据发布到将执行 mysql 插入的函数。没什么好看的。但我可以让事情正常工作，我的问题是我应该告诉 jQuery 发布到哪里，它会尊重 php 包含的内容吗？

这就是我所拥有的

```
include_once 'modules/interviews/helper.php';

if($link == 'my_interviews'){
   include_once 'modules/interviews/my_interviews.php';
} elseif($link == 'interview_panel'){
   include_once 'modules/interviews/interview_panel.php';
} 
```

上面是我的index.php，在提交表单的页面加载

```
$('.addinote').click(function() {

var app = $(this).attr("data-app"),
user = $(this).attr("data-subi"),
txt = $('#' + app).val();

if(txt === ''){
alert('Whoops, did you enter something?');
}else{
   var  params = {};
   params['user_id'] = user;
   params['app_id'] = app;
   params['inote'] = txt;
   params['subinote'] = '1';

   $.post('http://localhost/gem/modules/interviews/index.php', params,            
       function(data){
           if(data){

           }
           else{
              alert('Whoops, there was a problem, please try again!');
           }
    });
} 
```

helper.php 包含这个...

```
if(isset($_POST['subinote'])){

    $apply->inote();

} 
```

并且该类包含这个....

```
function inote(){

$query = "INSERT INTO `app_notes` (`user_id`, `application_id`, `inote`) 
          VALUES ('{$_POST['user_id']}', '{$_POST['app_id']}', 
          '{$_POST['inote']}')";    

$GLOBALS['DB']->insertQuery($query);

} 
```

我应该在哪里发帖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T17:56:29.647

如果这是读取 $_POST 变量的那个，您应该发布到 index.php。

此外，您应该使用相对 url，例如，如果 helper.php 与您使用的 html 文件位于同一目录中，`./index.php`或者只是`index.php`作为您的帖子 url。我更喜欢前者，因为它明确说明了您的意图。

# ruby-on-rails - 合并来自同一模型的两个 has_many 关联的结果

> ID：11486027
> 
> 赞同：12
> 
> 时间：2012-07-14T17:53:32.920
> 
> 标签：ruby-on-rails

我有用户。用户可以戳其他用户，也可以戳自己。每个戳都是定向的，并且不存在组戳。我想列出给定用户的所有戳（传入或传出），而不重复自戳（作为传入_和传出_戳存在）。

这是我的模型：

```
class User < ActiveRecord::Base
  has_many :outgoing_pokes, :class_name => "Poke", :foreign_key => :poker_id
  has_many :incoming_pokes, :class_name => "Poke", :foreign_key => :pokee_id
end

class Poke < ActiveRecord::Base
  belongs_to :poker, :class_name => "User"
  belongs_to :pokee, :class_name => "User"
end 
```

我尝试在`User`模型中创建一个方法来合并戳：

```
def all_pokes
  outgoing_pokes.merge(incoming_pokes)
end 
```

但这只返回自戳（那些既是incoming_又是outgoing_pokes）。想法？有没有一种直接使用关联的干净方法？

此外，在合并列表中，最好为每个 poke 设置两个布尔值来记录它们与当前用户的关系。`outgoing`类似于和的东西`incoming`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-14T18:03:47.103

您的`all_pokes`方法仅返回自戳的原因`outgoing_pokes`是还不是数组，而是您可以链接的 AR 关系。`merge`，在这种情况下，在执行查询之前组合查询。

您想要的是实际执行查询并合并结果集：

```
def all_pokes
  (outgoing_pokes.all + incoming_pokes.all).uniq
end 
```

...或者您可以编写自己的查询：

```
def all_pokes
  Poke.where('poker_id = ? OR pokee_id = ?', id, id)
end 
```

### 判断是传入还是传出：

```
# in poke.rb
def relation_to_user(user)
  if poker_id == user.id
    poker_id == pokee_id ? :self : :poker
  elsif pokee_id == user.id
    :pokee
  else
    :none
  end
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-05-22T13:08:35.860

现在 Rails 5 有`OR`查询，有一个非常易读的解决方案。

```
def pokes
  outgoing_pokes.or(incoming_pokes)
end 
```

我`all`在方法名称中省略了，因为它现在返回一个 ActiveRelation 并且可以链接其他方法。

```
@user.pokes.where(...).includes(...) 
```

# java - Java - 类变量

> ID：11486029
> 
> 赞同：0
> 
> 时间：2012-07-14T17:53:38.227
> 
> 标签：java, class, variables, parameters, instance

我有一个变量：`Abstract a`. 它是一个扩展类的`Abstract`类。但是，我需要将此`Abstract`变量转换为扩展类的更具体的类变量`Abstract`。

我的情况：我有两个类，`Class1`它们`Class2`都扩展了`Abstract`类，每个类都实现了方法。我现在有一个`Abstract`类变量可以使用。我不知道它是`Class1`or `Class2`，所以我不能简单地做 a `(Class1) a`or a `(Class2) a`（铸造）。

那么我将如何成功地转换这个变量以便我可以使用内部方法呢？

我一直在考虑使用`a.getClass().getName()`来确定如何投射它，但我从这里开始就被困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:03:02.590

您的新问题似乎是在询问如何在运行时将变量动态转换为未知的任意类型。这可能是[java 的副本：如何将变量从一种类型动态转换为另一种类型？](https://stackoverflow.com/questions/2127318/java-how-can-i-do-dynamic-casting-of-a-variable-from-one-type-to-another)但总而言之，这是不可能的，不建议这样做，并且会涉及代码中的其他问题。

这样想，你可以使用什么变量来存储你的新铸造对象？想象一下，如果我们`(child)`在 Java 中有一个强制转换操作，它接受一个定义为父类的变量，并将其强制转换为它的子类（例如 List -> LinkedList）：

```
public static void func(Abstract a){
    ???? var = (child)a;
    // Do something with var?
} 
```

请注意 1) 您无法为 指定类型`var`，因为我们在运行时不知道它将是什么类型；和 2) 除了定义在任何情况下的行为之外，我们无法对 var 做任何事情`Abstract`，因为编译器无法预测`var`除了对`Abstract`.

如果您需要实现特定于类的行为，则应该在类内部进行。有一个每个类都必须实现的抽象方法，它可以做你需要他们做的任何事情。或者，如果您不能确保这一点，请不要定义以 an`Abstract`作为参数的函数；而是定义许多将`Class1`,`Class2`等对象作为参数的函数，如下所示：

**要求所有子类行为相似的抽象方法**

```
public abstract class Abstract{
  /** Do the class-specific behavior you want to do currently in func */
  public abstract void operation();

  public static void func(Abstract a){
    a.operation();
  }
} 
```

**仅适用于可以实际处理您想要的类的函数**

```
public static void func(Class1 a){
  // do something
}

public static void func(Class2 a){
  // do something
} 
```

同样，如果这些选项对您都不可行（当然，`instanceof`调用块是不可接受的），那么我愿意打赌，您使用 Java 的方式存在结构性问题，这从根本上是不正确的。如果您想发布一个代码示例，说明您正在尝试通过孩子铸造来完成什么，也许我们可以阐明问题所在。

* * *

**把这个留给后代**- OP 的原始问题询问了创建一个对象的新实例作为其抽象父对象。

很简单，获取对象的类对象，然后创建一个新实例。有关更复杂的构造函数，请参阅有关[动态创建新实例的 Java 文档](http://docs.oracle.com/javase/tutorial/reflect/member/ctorInstance.html)。

```
public class ClassVar
{
    public static abstract class Abstract
    {

    }

    public static class Class1 extends Abstract
    {

    }

    public static class Class2 extends Abstract
    {

    }

    /**
     * Given an instance of a child of Abstract, returns a new instance
     * of the same class
     */
    public static Abstract newInstance(Abstract obj) throws InstantiationException, IllegalAccessException
    {
        return obj.getClass().newInstance();
    }

    public static void main(String[] args) throws InstantiationException, IllegalAccessException
    {
        System.out.println(newInstance(new Class1()).getClass());
        System.out.println(newInstance(new Class2()).getClass());
    }
} 
```

结果：

```
class ClassVar$Class1
class ClassVar$Class2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T17:58:06.260

基本上你可以使用反射来使用

类 cl = ...

cl.newInstance()

您可以在[此处找到更“扩展”的答案](http://docs.oracle.com/javase/tutorial/reflect/member/ctorInstance.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T20:24:43.053

由于您在撰写本文时 3 小时前再次编辑了您的问题，这是我对我认为已解决的问题的第二个答案。很明显，没有人得到你真正想要的东西。尝试改进你提问的方式。
然而，答案很简单：

*   从面向对象的角度来看，您根本不应该这样做（里[氏替换原则](https://en.wikipedia.org/wiki/Liskov_substitution_principle)）。即使您对两个可能的实例有*确切的了解*，您也应该为您尝试建模的问题寻找更好的方法。

*   如果必须，确定类名并检查是否相等或携带一个额外的标识符并进行比较。实施再简单不过了。

# android - Android 2.2 appwidget 进度条滚轮导致小部件失败

> ID：11486032
> 
> 赞同：2
> 
> 时间：2012-07-14T17:53:45.247
> 
> 标签：android, android-widget, progress-bar, android-appwidget, android-2.2-froyo

我的小部件上有一个进度轮，默认情况下是不可见的，每当我的服务运行以在小部件上执行某些任务时，它首先将该轮设置为可见，然后使用包含此更改的远程视图调用 updateAppWidget。然后我继续做我需要做的所有事情，最后，在新的远程视图中，我再次将其设置为不可见，并再次调用 updateAppWidget。

我已经在 android 2.2 上的模拟器和我的姐妹 htc wildfire 上用 2.2.1 测试了这个。两者都使小部件失败（模拟器说“问题加载小部件”，而野火用丹麦语说“Søg”，因为语言设置为丹麦语，即使这样也很奇怪，说“Søg”，因为这意味着“搜索“），只要它应该显示轮子（试图只删除工作轮子的代码，然后它按预期工作。奇怪的是，在我的nexus上的android 2.3中，它工作得很好很好。一切都符合预期（也在 2.3 模拟器上）。我正在制作的小部件是朝着 2.2 构建的。

我试图搜索，但无法找到其他有此问题的人。2.2中的appwidgets不支持进度条还是什么？我不知道该怎么做：S

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T13:36:25.887

如果您尝试通过 RemoteViews 对象更改 ProgressBar 的可见性，则会出现一个**已知错误。**

**解决方案**：将进度条包装在 Layout 中并使用 setViewVisibility() 使 Layout 不可见/消失，而不是进度条。

**来源**：[官方问题](http://code.google.com/p/android/issues/detail?id=11040)和[错误详细信息](http://www.mail-archive.com/android-developers@googlegroups.com/msg50097.html)

# ruby-on-rails - bundle install -jailshell: bundle: 在共享主机上找不到命令

> ID：11486035
> 
> 赞同：0
> 
> 时间：2012-07-14T17:54:29.817
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, hosting, shared-hosting

捆绑安装不适用于共享主机，但是当我运行以下命令时，我安装了 gem bundle

我试过了

***捆绑安装***

```
-jailshell: bundle: command not found 
```

***所以我尝试评估以下命令***

**宝石列表捆绑器 -v 1.1.4**

```
*** REMOTE GEMS ***

bundler (1.1.4)
bundler-auto-update (0.0.4)
bundler-bootstrap (0.0.3)
bundler-bouncer (0.1.2)
bundler-fastupdate (0.0.3)
bundler-github (0.2.0)
bundler-maglev- (1.0.21)
bundler-talks (0.0.4)
bundler08 (0.8.5)
bundler_bash_completion (0.1.1)
bundler_geminabox (0.0.1)
bundler_local_development (0.3.0)
bundler_push_host (0.0.1)
bundler_timer (1.1.2) 
```

bundler 已安装，但我不知道为什么它不起作用？

当我跑的时候

**宝石环境**

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.15
  - RUBY VERSION: 1.8.7 (2011-02-18 patchlevel 334) [x86_64-linux]
  - INSTALLATION DIRECTORY: /home/username/ruby/gems
  - RUBY EXECUTABLE: /usr/bin/ruby
  - EXECUTABLE DIRECTORY: /home/username/ruby/gems/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /home/username/ruby/gems
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "gempath" => []
     - "gem" => "--remote --gen-rdoc --run-tests"
     - "gemhome" => "/home/username/ruby/gems"
     - "rdoc" => "--inline-source --line-numbers"
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

**回声 $PATH**

```
/usr/local/jdk/bin:/home/username/perl5/bin:/usr/kerberos/bin:/usr/lib/courier-imap/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin:/home/username/bin 
```

**unname -mrsn**

```
Linux osprey.arvixe.com 2.6.18-374.3.1.el5.lve0.8.44 x86_64 
```

**更多 /proc/version**

```
Linux version 2.6.18-374.3.1.el5.lve0.8.44 (mockbuild@buildfarm.cloudlinux.com)
(gcc version 4.1.2 20080704 (Red Hat 4.1.2-51)) #1 SMP Mon Oct 3 18:27:54 EEST 2
011 
```

**哪个宝石**

```
/usr/bin/gem 
```

**哪个红宝石**

```
/usr/bin/ruby 
```

**哪个轨道**

```
/usr/bin/rails 
```

**红宝石-v**

```
ruby 1.8.7 (2011-02-18 patchlevel 334) [x86_64-linux] 
```

**导轨-v**

```
Rails 2.3.14 
```

**宝石-v**

```
1.8.15 
```

**定位捆绑**

```
locate: can not open `/var/lib/mlocate/mlocate.db': Permission denied 
```

***伙计们请帮助我基本的捆绑安装命令不起作用，所以我不知道要做什么，而且我是 ruby​​ on rails 的新手。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T14:19:30.960

我解决了我的问题，托管人员需要给予一些权限。

您总是需要在我们的主目录上安装 gems，尤其是在共享主机中

```
bundle install --path /home/username/bundle 
```

# iphone - 防止 iPhone 进入睡眠状态

> ID：11486036
> 
> 赞同：2
> 
> 时间：2012-07-14T17:54:30.940
> 
> 标签：iphone, objective-c, ios, uiapplication

我在我的应用程序中使用加速度计，我正在使用`[UIApplication sharedApplication].idleTimerDisabled = YES;`它来防止设备进入睡眠状态。它工作正常，但是这样屏幕总是全亮，有办法防止设备休眠并保持节能模式吗？当`idleTimerDisabled`设置为 NO 时，设备在睡眠前进入节能模式，我只想阻止设备睡眠并保持节能。有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T18:03:44.573

有一个`UIScreen`实例属性`brightness`，这可能是您想要的。[在此处](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/doc/uid/TP40006903-CH3-SW19 "UIScreen Class Reference")`UIScreen`查看's `brightness`property的文档。

尝试：

```
[[UIScreen mainScreen] setBrightness: 0.3]; 
```

**注意：**正如我发布的那样，DarkXphenomenon 发布了一个指向[SO question](https://stackoverflow.com/q/1961783/1292061 "使 iPhone 屏幕变暗，但不要让它休眠")的链接，该问题的提问者给出了完全相同的解决方案。DarkXphenomenon 在平局上很快。

# linux - web：是否保留扩展图像

> ID：11486037
> 
> 赞同：0
> 
> 时间：2012-07-14T17:54:31.493
> 
> 标签：linux, image, html

我想知道保持图像的扩展是否有好处（在客户端，因为在服务器端（linux），我没有看到好处，知道扩展并不重要）。

有`<img src="/a" />`还是更好`<img src="/a.jpg" />`？

那么，存储在带有扩展名的服务器图像中？

* * *

信息：图像是用户的照片。图像的名称很复杂。

*我正在考虑保留扩展名，因为如果用户保存图像，他们就会有扩展名。*

但是保持扩展对于开发来说有点复杂。不延期会不会有好处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T17:57:30.080

通常，扩展名是 Web 服务器确定文件的 MIME 类型的方式，这是浏览器如何知道它是图像而不是文本或任意二进制数据或其他内容的方式。

因此，通常，您只是出于这个原因想要保留扩展名。可能有一些不寻常的情况可能不是真的，但在典型的 Web 服务器中，直接从文件系统中提供文件，就是这种情况。

如果您不需要服务器端的扩展，因为无论扩展如何，您都发送正确的 MIME 类型，那么是的，唯一明显的优势是在用户想要保存图像并且浏览器或操作系统不可用的情况下不够聪明，无法在没有扩展名的情况下对图像做正确的事情。在这个时代，我不知道这种情况有多普遍，但它肯定不像以前那么普遍了。

就个人而言，如果它会使您的开发变得复杂，我不愿意担心它（特别是如果您发现您确实出于某种原因确实需要它时可以随时返回并执行此操作）。不过，我要考虑的是，如果保留文件扩展名是一个大难题，那么应用程序架构中是否需要改进。看起来这不应该是一个大问题。当然，我是在不知道你的具体情况的情况下这么说的；我只是笼统地说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T17:59:26.223

只要您发送正确的 MIME 类型，不使用扩展名应该没问题。如果需要，浏览器会自动添加扩展。（证明：你的 Gravatar 图片：[http](http://www.gravatar.com/avatar/f1f8a3382d2946bd526dd629eaa29b2b?s=32&d=identicon&r=PG) ://www.gravatar.com/avatar/f1f8a3382d2946bd526dd629eaa29b2b?s=32&d=identicon&r=PG ）

基本上，只要 MIME 类型正确，您就可以使用任何扩展名。如果您使用扩展名静态地提供文件会更方便，因为大多数 Web 服务器使用基于扩展名的 MIME 类型猜测。从不使用扩展的数据库提供服务可能更方便......

# php - drupal 7中有新闻模块吗？

> ID：11486042
> 
> 赞同：1
> 
> 时间：2012-07-14T17:55:48.590
> 
> 标签：php, drupal, drupal-7, drupal-modules

我想在我的首页上发布新闻，但列表中只有新闻的标题，然后如果您单击其中一个，您可以转到单独的页面或直接在首页上显示该新闻文章（通过用其余文本扩展标题）。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T19:01:12.973

如果您可以使用[Views 模块](http://drupal.org/project/views)创建自己的视图，那就简单多了。

以下是一些[视频教程](http://drupal.org/node/1351076)，可帮助您开始使用视图。

希望这会有所帮助……穆罕默德。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T08:14:40.030

使用 simplenews 模块创建新闻。

[https://drupal.org/project/simplenews](https://drupal.org/project/simplenews)

但要获得更好的自定义新闻，请使用 Muhammad Reda 所说的视图。

# node.js - nodejs 中的 ejs 支持。我怎样才能开始学习ejs？

> ID：11486044
> 
> 赞同：0
> 
> 时间：2012-07-14T17:55:51.907
> 
> 标签：node.js, express, ejs

我想在 nodejs 中使用 ejs 框架，它通过 express 框架在 nodejs 中得到支持。有人知道任何让我看到代码的网站或地方，然后我就可以知道如何在 ejs 中编写东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:29:52.033

[http://embeddedjs.com/](http://embeddedjs.com/)
[https://github.com/visionmedia/ejs](https://github.com/visionmedia/ejs)

# cuda - CUDA 主机到设备的传输比设备到主机的传输更快

> ID：11486051
> 
> 赞同：4
> 
> 时间：2012-07-14T17:56:36.023
> 
> 标签：cuda

我正在研究一个简单的 cuda 程序，在该程序中我发现 90% 的时间都来自一个从设备到主机的 cudamemcpy 语句。该程序在 600-700 微秒内将大约 2MB 的数据从主机传输到设备，并在 10 毫秒内将 4MB 的数据从设备复制回主机。我的程序花费的总时间是 13 毫秒。我的问题是，为什么从设备到主机和主机到设备的两次复制存在不对称性。是不是因为 cuda 开发人员认为复制回来的字节数通常会更小。我的第二个问题是有什么办法可以规避它。

我正在使用具有 343 个内核和 1GB 内存的 Fermi GTX560 显卡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T16:23:39.130

CUDA 功能的时序与 CPU 有点不同。首先确保你没有在应用程序开始时调用 CUDA 函数来考虑 CUDA 的初始化成本，否则它可能会在你开始计时时被初始化。

```
int main (int argc, char **argv) {
   cudaFree(0);
   ....//cuda is initialized..

} 
```

像这样使用 Cutil 计时器

```
unsigned int timer;
cutCreateTimer(&timer);
cutStartTimer(timer);

//your code, to assess elapsed time..

cutStopTimer(timer);
printf("Elapsed: %.3f\n", cutGetTimerValue(timer));
cutDeleteTimer(timer); 
```

现在，在这些初步步骤之后，让我们看看问题所在。当一个内核被调用时，CPU 部分只会在调用被传递到 GPU 之前停止。GPU 将继续执行，而 CPU 也会继续执行。如果你调用 cudaThreadSynchronize(..)，那么 CPU 将停止直到 GPU 完成当前调用。cudaMemCopy 操作也需要 GPU 完成其执行，因为需要内核填充的值。

```
kernel<<<numBlocks, threadPerBlock>>>(...);

cudaError_t err = cudaThreadSynchronize();
if (cudaSuccess != err) {
  fprintf(stderr, "cudaCheckError() failed at %s:%i : %s.\n", __FILE__, __LINE__, cudaGetErrorString( err ) );
  exit(1);
}

//now the kernel is complete..
cutStopTimer(timer); 
```

所以在调用停止定时器函数之前放置一个同步。如果在内核调用之后放置内存副本，那么内存副本的经过时间将包括内核执行的某些部分。所以memCopy操作可能会放在定时操作之后。

还有一些分析器计数器可用于评估内核的某些部分。

[如何分析 cuda 内核的全局内存事务数量？](https://stackoverflow.com/questions/9826948/how-to-profile-the-number-of-global-memory-transactions-for-cuda-kernels)

[您如何分析和优化 CUDA 内核？](https://stackoverflow.com/questions/2204527/how-do-you-profile-optimize-cuda-kernels)

# php - 无法重新声明类

> ID：11486055
> 
> 赞同：1
> 
> 时间：2012-07-14T17:56:45.117
> 
> 标签：php, oop, redeclare

PHP 说“不能重新声明类 MyClass”。当然，类只定义一次。还有什么可能导致此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T17:58:51.727

一个类包括/需要不止一次。*始终*对类和函数文件 使用`include_once`/`require_once`语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:01:19.393

这是因为我的班级被命名为`Directory`. 它可能是一个库类。

# facebook - RestFB 发布自定义动作和对象

> ID：11486056
> 
> 赞同：1
> 
> 时间：2012-07-14T17:56:50.173
> 
> 标签：facebook, restfb

我刚刚开始使用 Facebbook API/OpenGraph 和 RestFB。

我在 Facebook 上创建了一个自定义对象和操作类型。

但是，我不太了解 RestFB 如何使用对象发布操作。

我可以像这样发布一个动作（完整）：

```
FacebookType publishMessageResponse =
facebookClient.publish("me/myapp:complete", Post.class, 
Parameter.with("mycustomobject", "http://samples.ogp.me/xxxxxxxxxxxxx"), 
```

我不明白的是如何创建一个具有所有必要参数的对象并将其传递给 publishMessage。在这种情况下，我只是链接到 Facebook 提供的用于说明的示例对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:46:53.390

> 我不明白的是如何创建一个具有所有必要参数的对象并将其传递给 publishMessage。

Open Graph 对象基本上只是 URL。

您将所有必要的信息放入此 URL 提供的 HTML 中，放入 Open Graph 元元素中。（有关此内容，请参见 OG 文档。）

然后，当您在对象上发布您的操作时，您只需提供该对象的 URL，Facebook 就会从那里获取数据。（除非您有一些额外的自定义属性，您也可以在发布操作时为其提供值）。

# sql - SQL Server，将值插入变量并排序

> ID：11486063
> 
> 赞同：0
> 
> 时间：2012-07-14T17:57:36.600
> 
> 标签：sql, sql-server-2008-r2

将值插入变量后，我需要对查询结果进行排序。我正在尝试根据“RowId”进行排序，但在我的情况下它无效。
以下是我的查询，我怎样才能使它工作？谢谢。

```
SELECT TOP 1 @NumOfProducts = ROW_NUMBER() OVER(ORDER BY Products.Id) AS RowId 
        FROM          Cities INNER JOIN
                      CitiesInLanguages ON Cities.Id = CitiesInLanguages.CityId INNER JOIN
                      ShopsInCities ON Cities.Id = ShopsInCities.CityId INNER JOIN
                      Categories INNER JOIN
                      ProductstInCategories ON Categories.Id = ProductstInCategories.CategoryId INNER JOIN
                      Products ON ProductstInCategories.ProductId = Products.Id INNER JOIN
                      ProductsInProdutGroup ON Products.Id = ProductsInProdutGroup.ProductId INNER JOIN
                      ProductsGroups ON ProductsInProdutGroup.ProductGroupId = ProductsGroups.Id INNER JOIN
                      ShopsInProductsGroup ON ProductsGroups.Id = ShopsInProductsGroup.ProductGroupId INNER JOIN
                      aspnet_Users ON ShopsInProductsGroup.ShopId = aspnet_Users.UserId ON ShopsInCities.ShopId = aspnet_Users.UserId INNER JOIN
                      ProductsNamesInLanguages ON Products.Id = ProductsNamesInLanguages.ProductId INNER JOIN
                      UsersInfo ON aspnet_Users.UserId = UsersInfo.UserId INNER JOIN
                      ProductOptions ON Products.Id = ProductOptions.ProductId INNER JOIN
                      ProductOptionsInLanguages ON ProductOptions.Id = ProductOptionsInLanguages.ProductOptionId INNER JOIN
                      ProductFiles ON Products.Id = ProductFiles.ProductId INNER JOIN
                      ProductsInOccasions ON Products.Id = ProductsInOccasions.ProductId INNER JOIN
                      Occasions ON ProductsInOccasions.OccasionId = Occasions.Id INNER JOIN
                      OccasionsInLanguages ON Occasions.Id = OccasionsInLanguages.OccasionId
WHERE     (Products.IsAddition = 0) AND (Categories.IsEnable = 1) AND (Products.IsEnable = 1) AND (ProductsGroups.IsEnable = 1) AND (Cities.IsEnable = 1) AND 
                      (ShopsInProductsGroup.IsEnable = 1) AND (CitiesInLanguages.CityName = @CityName) AND (ProductsNamesInLanguages.LanguageId = @languageId) AND 
                      (Categories.Id = @CategoryId) AND (ProductOptions.IsEnable = 1) AND (ProductFiles.IsEnable = 1)
                      group by Products.Id, ProductsNamesInLanguages.ProductName, UsersInfo.Name
                      Order By RowId 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:00:13.683

用编辑试试这个：

```
SELECT TOP 1 @NumOfProducts = ROW_NUMBER() OVER(ORDER BY Products.Id),
                              ROW_NUMBER() OVER(ORDER BY Products.Id) AS RowId 
```

或尝试

```
ORDER BY ROW_NUMBER() OVER(ORDER BY Products.Id) 
```

我必须进行测试，但我认为两者都可以。

* * *

问题是 rowid 不在任何 group by 项目中。

您可以按`Products.id`. 如果`rowid`每个您可以订购或添加到 group by 语句中的每个`max(rowid)`都`min(rowid)`相同`rowid`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:02:04.057

您是否要查找最近插入的行的 ID？你要

```
 SELECT Scope_Identity() 
```

**编辑** *我正在尝试获取 ROW_NUMBER()* 的最大行 ID

将您的查询包装在

```
 SELECT  @NumOfProducts = Max(RowID) FROM
 ( [your query here] ) v 
```

或者，一个`SELECT COUNT`... 查询可以提供答案

# javascript - Backbonejs 集合返回错误数据

> ID：11486065
> 
> 赞同：2
> 
> 时间：2012-07-14T17:57:48.973
> 
> 标签：javascript, backbone.js, tastypie

我将 Tastypie 用于我的 RESTful api 和 Backbonejs 用于前端。with 模型工作正常，`fetch`但是，`Backbone.Collection`我似乎得到了错误的响应：

```
_byCid: Object
  _byId: Object
  _callbacks: Object
  _onModelEvent: function () { [native code] }
  _removeReference: function () { [native code] }
  length: 1
  models: Array[1]
       0: d
       _callbacks: Object
       _changed: false
       _changing: false
       _escapedAttributes: Object
       _previousAttributes: Object
       attributes: Object
           cid: "c14"
           collection: d
               __proto__: o
               length: 1
               __proto__: Array[0]
               __proto__: o 
```

这是我的收藏：

```
define(
[
    'models/ad',
],
function(AdModel){
    return Backbone.Collection.extend({
        url: '/api/v1/ad',
        model: AdModel,

        initialize: function(){
            this.fetch({
                success: function(coll, resp){
                    console.log(coll);
                }
            });
        }
    });
} 
```

);

这是我的模型：

```
 define(
[],
function(){
    return Backbone.Model.extend({

    });
} 
```

);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T11:44:06.453

我必须改变的只是我的`Collection.parse`方法。

```
define(
   [
     'models/ad',
   ],
function(AdModel){
   return Backbone.Collection.extend({
      url: '/api/v1/ad',
      model: AdModel,
      parse: function(data){
          return data.objects;
      },
      initialize: function(){
        this.fetch({
            success: function(coll, resp){
                console.log(coll);
            }
        });
    }
  });
} 
```

一切正常。

# c# - 手动退出 WP7 中文本框的输入模式

> ID：11486066
> 
> 赞同：1
> 
> 时间：2012-07-14T17:57:52.093
> 
> 标签：c#, silverlight, windows-phone-7, xaml

我的 windows phone 7 应用程序中有一个场景。我有 panarama 控件，里面有 4 个项目。假设在第一个项目中，我有文本框，我的注意力集中在它上面意味着我的光标在里面，我在这个文本框上打字。但是，当我的焦点仍然在文本框中并且我更改全景项目时，输入意思是。我的文本框焦点仍然存在，并且仍然处于打字模式。如何在 panaroma 选择更改时从键入模式退出我的文本框。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T18:02:15.807

Windows Phone 无法隐藏键盘，只能专注于不同的元素。例如，如果您有一个隐藏按钮，请调用`button.focus();`以隐藏软键盘。

# android - 如何转换 ContentValues 对象以在 execSQL() 调用中使用？

> ID：11486070
> 
> 赞同：0
> 
> 时间：2012-07-14T17:58:25.703
> 
> 标签：android, sqlite

我希望能够获取一个 ContentValues 对象并在 sqlite 语句中使用它。

```
ContentValues cv;
cv.put( "id", 1 );
cv.put( "name", "Bob" );
cv.put( "isCEO", true ); 
```

通常，我会这样对请求进行硬编码：

```
db.execSQL( "Insert or replace into Employee (id, name, isCEO) values (1, 'Bob', true)" ); 
```

将 cv 转换为字符串“（id，name，isCEO）值（1，'Bob'，true）”的最佳方法是什么？另外，在这种情况下，有没有办法恢复 sqlite 操作的成功/失败状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:14:40.157

使用 SQLiteDatabase 的“替换”方法。例如

```
ContentValues cv;
cv.put( "id", 1 );
cv.put( "name", "Bob" );
cv.put( "isCEO", true );
db.replace(TABLE_NAME, null, cv); 
```

为此，“id”列必须是表中的主键列。

'replace' 方法的响应是一个长值：

```
the row ID of the newly inserted row, or -1 if an error occurred 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:27:07.860

与其将 ContentValues 转换为字符串，不如让框架为您完成。

db.insertWitOnConflict("雇员", null, cv, CONFLICT_REPLACE);

有关更多详细信息，请参见：

[http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict(java.lang.String](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict(java.lang.String), java.lang.String, android.content.ContentValues, int)

# css - 向现有阴影未知的元素添加额外的 box-shadow

> ID：11486071
> 
> 赞同：11
> 
> 时间：2012-07-14T17:58:26.550
> 
> 标签：css

我假设这个问题的答案是不可能的，但我还是在问，希望有人知道一个聪明的解决方法。

假设我有以下类`.left-inset`，它在元素左侧添加一个 1px 白色框阴影以赋予它一些深度：

```
.left-inset {
  box-shadow: inset 1px 0 0 rgba(255,255,255,.25);
} 
```

问题是，如果我添加这个类的元素已经定义了一个 box-shadow，这个 box-shadow 将覆盖现有的 box-shadow（或者这个阴影不会被应用，具体取决于级联）。我想找到一种方法来安全地添加这个类而不会发生冲突。

我希望将来有一些浏览器支持以下内容：

```
.left-inset {
  box-shadow: inherit, inherit, inherit, inset 1px 0 0 rgba(255,255,255,.25);
} 
```

继承在这里不是正确的词，因为继承意味着来自父级的值，但你明白了。

这种方法虽然不是完全证明，但至少可以让我知道我不会与现有的 box-shadow 冲突，除非它们定义了三个以上。在大多数情况下，这已经足够了。

有谁知道这样的事情是否可行，或者是否有建议的语法来为已经定义的阴影添加额外的阴影？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T18:20:01.747

一个绝对定位的伪元素（原始容器设置了位置）似乎是唯一的解决方案：

**[见小提琴。](http://jsfiddle.net/GP8RX/6/)**（我为视觉做了不同的尺寸/颜色）。

```
.test:before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    box-shadow:3px 3px rgba(275,0,0,.25);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:16:08.817

一种解决方案可能是使用伪元素：

```
.left-inset::after {
    content: '';
    width: 100%;
    height: 100%;
    display: block;

    box-shadow: 1px 0 0 rgba(255,255,255,.25);
} 
```

这有点 hacky，但只要元素还没有定义 ::after 伪元素，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:25:23.917

一种方法是确定当前的盒子阴影，将所需的部分叠加到它上面并应用回来（不确定它是否值得麻烦，但是..）。

`window.getComputedStyle(element).boxShadow`

会给你一个格式如下的字符串：

`<color> <left> <top> <softness> <spread>`- 例如：`rgb(102, 102, 102) 5px 5px 5px 0px`

在变量中包含上述字符串后：

1.  使用空格字符拆分它 -`s = s.split(' ');`
2.  取最后四个部分
3.  根据需要替换或保留数组中的单个值
4.  使用空格加入数组 -`s = s.join(' ');`
5.  将其应用回元素 -`elem.style.boxShadow = s;`

**注意**：这适用于 ff 和 chrome（因为返回的字符串格式相同）。但我认为这太过分了，无法在生产版本中实际尝试。此外，从你用 CSS 编写的类中叠加样式需要更多的工作。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-14T18:08:17.337

我认为这就是你想要的[http://www.css3.info/preview/box-shadow/](http://www.css3.info/preview/box-shadow/)

向下滚动以查找多个阴影。

# iphone - 获取 UITextView 中某个单词的 X 和 Y 坐标

> ID：11486072
> 
> 赞同：18
> 
> 时间：2012-07-14T17:58:34.277
> 
> 标签：iphone, objective-c, ios, uitextview, syntax-highlighting

我询问了一位开发人员（TwoLivesLeft，Codea 的创建者）他们是如何在他们的应用程序中进行语法高亮的。他回答 ：

> @TD2 Codea 编辑器是使用 UITextView 实现的。突出显示是通过在适当的位置覆盖子视图来完成的——通常是 UILabel。它们从重用池中出列，类似于 UITableViewCells 的工作方式。在滚动期间，需要重新突出显示的行将标记拉出池，而已移出屏幕的行会将其标记转回池中。

谁能解释我如何得到某个单词的 x 和 y ？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-14T20:22:59.990

UITextView 符合 UITextInput，详细说明可以看[这里](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextInput_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITextInput)。

查看 UITextInput 协议中所需的方法“textRangeFromPosition:toPosition:”、“positionFromPosition:offset:”、“positionFromPosition:inDirection:offset:”以及其他一些基于几何的方法。这些可能会提供您正在寻找的功能。

我实际上并没有尝试确保这些工作也按照您想要的方式工作，但这看起来就像您需要的那样。

如果您需要更多帮助，请告诉我！

* * *

更新：

这是一些有关如何执行此操作的示例代码。我最终得到了“firstRectForRange：”方法的工作。此代码基本上采用 UITextView“textStuff”的最后三个字母并将其突出显示为绿色。

```
UITextView *textStuff = [[UITextView alloc] init];
textStuff.frame = CGRectMake(2.0, 200.0, 200.0, 40.0);
textStuff.text = @"how are you today?";
textStuff.textColor = [UIColor blackColor];

UITextPosition *Pos2 = [textStuff positionFromPosition: textStuff.endOfDocument offset: nil];
UITextPosition *Pos1 = [textStuff positionFromPosition: textStuff.endOfDocument offset: -3];

UITextRange *range = [textStuff textRangeFromPosition:Pos1 toPosition:Pos2];

CGRect result1 = [textStuff firstRectForRange:(UITextRange *)range ];

NSLog(@"%f, %f", result1.origin.x, result1.origin.y);

UIView *view1 = [[UIView alloc] initWithFrame:result1];
view1.backgroundColor = [UIColor colorWithRed:0.2f green:0.5f blue:0.2f alpha:0.4f];
[textStuff addSubview:view1]; 
```

运行此代码的结果：

![在此处输入图像描述](../Images/3b30b70906e8a344823ab5631d9b3892.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-10T09:33:34.467

@bddicken 的[https://stackoverflow.com/a/11487125/3549781](https://stackoverflow.com/a/11487125/3549781)就像一个魅力。但问题是，如果文本包含换行符“\n”，它在 iOS 7+ 上不起作用。经过大量搜索，我找到了解决方案。

您必须在调用 firstRectForRange: 之前确保 textView 的布局：

```
[textView.layoutManager ensureLayoutForTextContainer:textView.textContainer]; 
```

礼貌：[当混合中有换行符时，UITextView firstRectForRange 不起作用](https://stackoverflow.com/questions/25604493/uitextview-firstrectforrange-not-working-when-theres-new-line-characters-in-the/25983067#25983067)

PS：起初我将此作为评论添加到@bddicken's answer。由于大多数人不阅读评论，我将其添加为答案。

# android - 隐形设备和ADB驱动

> ID：11486076
> 
> 赞同：1
> 
> 时间：2012-07-14T17:59:17.943
> 
> 标签：android

我正在尝试使用 ADB 连接到我的 Prestigo PMP3370B。但该设备未列在我的 W7 64 位连接硬件列表中（仅作为 U 盘）。我已经在手机的开发者选项中检查了设备选项。我也没有将它安装为 USB 光盘。
这种类型的设备也没有特定的 ADB 驱动程序（或者我找不到它），但我至少想尝试使用一些通用驱动程序 pro 这个设备。有人知道这样做的最佳方法是什么吗？如何使设备可见？
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T17:14:57.757

我联系了我当地的 Prestigio 用户支持，他们告诉我使用默认的 ADB 驱动程序，但没有成功。他们没有给我派任何特别的司机或不知道任何事情。
然后我联系了国际用户支持，他们告诉我他们没有向用户/开发人员提供这个 ADB 驱动程序。
我将此平板电脑退回给卖家。结束。

# java - 如何将 ExecutorService 用于带有爬虫的生产者消费者模式？

> ID：11486077
> 
> 赞同：0
> 
> 时间：2012-07-14T17:59:18.797
> 
> 标签：java, multithreading

在[关于 stackoverflow 的另一个问题中，](https://stackoverflow.com/questions/11485489/why-does-linkedblockingqueue-take-block-even-if-there-are-elements)我得到一个提示，我可以将线程池​​用于我的爬虫正在创建的生产者-消费者模式。

但是，我只是不知道如何实现它。

在[SO 上的生产者消费者线程中，](https://stackoverflow.com/questions/10392855/producer-consumer-executorservice-arrayblockingqueue)他们只使用生产者消费者**来管理生产者和消费者**（在我的情况下，这将是爬虫本身；这与我的 for 循环没有太大区别），但这似乎不是我文章中评论者的意图（因为他看不到我使用了 for 循环）。工作量仍然通过`queue`那里共享。

我还考虑过通过这个实现**传递一个`Website`对象**（并从中`ExecutorService.submit()`删除）：`Runnable``Crawler`

```
public class Website implements Runnable {
    private URL url;

    public Website(URL url) {
        this.url = url;
    }

    @Override
    public void run() {
        Crawler crawler = new Crawler();
        crawler.crawl(url);
    }
} 
```

但问题是

1.  我认为生成的爬虫太多了
2.  Crawler() 需要一个已经**访问过的网站队列**

如何在爬虫问题中正确实现生产者、消费者模式？我对这一切感到完全困惑。我在网上查了很多关于它的网站，而且似乎都以不同的方式使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:54:01.197

我想我需要查看更多代码才能理解。
但是，为了拥有生产者-消费者，您可以做的是让您的 Crawler 类成为消费者，
并让代码使用执行程序作为消费者。
Crawler 将从生产者和消费者之间的队列或其他共享数据结构（同步数据结构）中获取 WebSite 对象。
在选择数据结构时，您应该问自己以下一些问题 -
A. 要爬取的站点之间是否有优先级？
如果是这样 - 考虑使用[PriorityBlockingQueue](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/PriorityBlockingQueue.html)。

B. 爬取顺序重要但所有优先级都相同吗？
如果是这样 - 考虑使用[LinkedBlockingQueue](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/LinkedBlockingQueue.html)

C. 你能以某种方式对链接进行分类吗？
如果是这样，也许您可​​以拥有多个共享数据结构，并为其提供类别映射。

我相信你可以想出很多关于如何自己构建这个共享数据结构的想法，这些只是我的想法。

总结 -
1\. 让 Crawler 扩展 Runnable
2\. 让 Crawler 从共享数据结构（即阻塞队列）中提取“作业”（WebSite 类）。
3\. 让生产者在使用执行器之前将作业放到共享数据结构中。

# actionscript-3 - 拖放功能不起作用 - Flash

> ID：11486081
> 
> 赞同：0
> 
> 时间：2012-07-14T17:59:51.527
> 
> 标签：actionscript-3, actionscript, drag-and-drop, flash-cs4

我正在尝试在 ActionScript 中创建一个函数，该函数在将可拖动的山墙对象放在另一个对象上时触发一个事件。

```
var hits = 0;

// Register mouse event functions
answer_j.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);
answer_j.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_e.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_e.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_m.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_m.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_b.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_b.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_a1.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_a1.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_t.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_t.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_a2.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_a2.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

answer_n.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler); 
answer_n.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);

// Define a mouse down handler (user is dragging) 
function mouseDownHandler(evt:MouseEvent):void
{   
    var object = evt.target;    
    // limit dragging to the area inside the canvas     
    object.startDrag(); 
}

function mouseUpHandler(evt:MouseEvent):void {  
    var obj = evt.target;   
    // obj.dropTarget will give us the reference to the shape of    
    // the object over which we dropped the circle.     
    var target = obj.dropTarget;    
    // If the target object exists the we ask the test_match function   
    // to compare moved obj and target where it was dropped.    
    if (target != null)     
    {       
        test_match(target, obj);    
    }   
    obj.stopDrag(); 
}

function test_match(target,obj) {   
    // test if either one of the four pairs match   
    if ( (target == box_j && obj == answer_j) ||    
        (target == box_e && obj == answer_e) ||     
        (target == box_m && obj == answer_m) ||     
        (target == box_b && obj == answer_b) ||     
        (target == box_a1 && obj == answer_a1) ||   
        (target == box_t && obj == answer_t) ||     
        (target == box_a2 && obj == answer_a2) ||   
        (target == box_n && obj == answer_n) )  
    { // we got a hit       
        hits = hits+1;      
        textField.text = "Yes ! You got one !";         
        // make the object transparent      
        obj.alpha = 0.5;        
        // kill its event listeners - object can't be moved anymore         
        obj.removeEventListener(MouseEvent.MOUSE_DOWN, mouseDownHandler);                  
        obj.removeEventListener(MouseEvent.MOUSE_UP, mouseUpHandler);       
        // Test if we are done      
        if (hits == 8) {            
            textField.text = "Made it !!"; 
        } 
    } else {        
            textField.text = "Missed :(";
    } 
} 
```

box_j - box_n 是应作为可拖动对象的目标的对象。

但是，由于某些未知原因，上述代码无法正常工作。如果您知道如何解决，请告知。

所有对象均为“电影剪辑”类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:22:59.263

只需更改 mouseUpHandler 函数中的顺序即可。

当这不起作用时，在引用 dropTarget 之前停止拖动，您应该将 .parent 添加到 dropTarget：

```
function mouseUpHandler(evt:MouseEvent):void {  
    var obj = evt.target;   

    obj.stopDrag(); 
    // obj.dropTarget will give us the reference to the shape of    
    // the object over which we dropped the circle.   
    var target = obj.dropTarget;  
    //var target = obj.dropTarget.parent; 

    // If the target object exists the we ask the test_match function   
    // to compare moved obj and target where it was dropped.    
    if (target != null) { 
        test_match(target, obj); 
    } 
} 
```

编辑：

`.parent`这就是为什么你有时必须使用：

> 当您以创作模式而不是通过 AS 将目标放在舞台上时，dropTarget 属性将引用 Shape。要获取包含 Shape 的 MovieClip 或 Sprite 的实例，您需要使用 parent 参数。

# c# - 如何在c#中访问基类数据

> ID：11486082
> 
> 赞同：2
> 
> 时间：2012-07-14T17:59:52.450
> 
> 标签：c#, .net-4.0

我正在尝试将保存方法添加到可以调用并将对象序列化到文件的列表中。除了如何获取基类本身之外，我已经弄清楚了一切。

这是我的代码：

```
/// <summary>
/// Inherits the List class and adds a save method that writes the list to a stream.
/// </summary>
/// <typeparam name="T"></typeparam>
class fileList<T> : List<T>
{
    private static IFormatter serial = new BinaryFormatter();
    private Stream dataStream;

    /// <summary>
    /// path of the data file.
    /// </summary>
    public string dataFile { get; set; }
    /// <summary>
    /// Sets the datafile path
    /// </summary>
    public fileList(string dataFile)
    {
        this.dataFile = dataFile;
    }
    /// <summary>
    /// Saves the list to the filestream.
    /// </summary>
    public void Save()
    {
        dataStream = new FileStream(dataFile,
            FileMode.Truncate, FileAccess.Write,
            FileShare.Read);
        //Right here is my problem. How do I access the base class instance.
        serial.Serialize(dataStream, this.base); 
        dataStream.Flush();
        dataStream.Close();
        dataStream = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:02:34.480

线

```
serial.Serialize(dataStream, this.base); 
```

应该只是

```
serial.Serialize(dataStream, this); 
```

但是请注意（感谢@Anders）这也将序列化`string dataFile`。为避免这种情况，请使用[NonSerializedAttribute](http://msdn.microsoft.com/en-us/library/system.nonserializedattribute.aspx)装饰该属性。

话虽如此，我更喜欢将这种类型的功能实现为静态方法。随着扩展方法的出现，我创建了一个小型扩展类来处理任何可序列化类型：

```
static public class SerialHelperExtensions
{
    static public void Serialize<T>(this T obj, string path)
    {
        SerializationHelper.Serialize<T>(obj, path);
    }
}

static public class SerializationHelper
{
    static public void Serialize<T>(T obj, string path)
    {

        DataContractSerializer s = new DataContractSerializer(typeof(T));
        using (FileStream fs = File.Open(path, FileMode.Create))
        {
            s.WriteObject(fs, obj);
        }
    }

    static public T Deserialize<T>(string path)
    {
        DataContractSerializer s = new DataContractSerializer(typeof(T));
        using (FileStream fs = File.Open(path, FileMode.Open, FileAccess.Read))
        {
            object s2 = s.ReadObject(fs);
            return (T)s2;
        }
    }
} 
```

您当然可以替代`BinaryFormatter`并`DataContractSerializer`使用相同的模式。

# javascript - Eclipse 中的 Tomcat：无需重新部署即可编辑 Javascript

> ID：11486087
> 
> 赞同：2
> 
> 时间：2012-07-14T18:00:37.083
> 
> 标签：javascript, eclipse, tomcat, eclipse-wtp

我正在使用 Eclipse WTP 开发一个 Java 应用程序（在 Tomcat 上运行）。对于开发，我已经在 Eclipse 中配置了我的 tomcat 服务器并使用了“自动发布”功能。

这适用于 .java 文件（已编译的文件正在发布）。

它也适合在 jsp 中工作。在这种情况下，我编辑的 jsp 文件只是复制到服务器目录而无需重新部署我的应用程序。

但是它不适用于 javascript 文件。每次我更改 .js 文件时，我的应用程序都会重新部署，我必须等待几秒钟。

我缺少任何 tomcat 选项吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T18:10:08.267

在服务器视图中双击您的服务器，单击服务器属性窗口下界的选项卡*模块*，从列表中选择您的 Web 模块，单击编辑按钮，取消选中“启用自动重新加载”，单击确定，保存设置并重新启动服务器。

# php - 如何发布和获取广播组数组？

> ID：11486089
> 
> 赞同：-1
> 
> 时间：2012-07-14T18:00:56.897
> 
> 标签：php, mysql, html

如何以数组格式获取无线电组的值？这是我的发送者（game.php）和接收者（result.php）

我想用数据库中的正确答案检查无线电组元素（是或否），如果正确则增加分数。

游戏.php：

```
 $conn=  mysql_connect($servername,$username, $password)or die(mysql_error());
    mysql_select_db($database,$conn);

    $sql = "SELECT * from questions";
    $result=mysql_query($sql);
    $num=mysql_numrows($result);

    $i=0;
    echo("<FORM ACTION='./result.php' METHOD=GET>");
    while($i < $num){
        $field = array($i => mysql_result($result,$i,"question"));
        $j = $i + 1;
        echo "<b>[$j]  </b>$field[$i]<br>";
        echo ("<label>
      <input type='radio' name='radioGroup[$i]' value='yes' id='radioGroup_1'>
      Yes</label><label>
      <input type='radio' name='radioGroup[$i]' value='no' id='radioGroup_1'>
      No</label><br>");
    $i++;   
    }

    echo "<input type='submit'>"; 
    echo("</FORM>");
    echo("<br>"); 
```

结果.php：

```
 $conn=  mysql_connect($servername,$username, $password)or die(mysql_error());
    mysql_select_db($database,$conn);

    $sqlcode = "SELECT * FROM questions";
    $cal=mysql_query($sqlcode);
    $num = mysql_numrows($cal);
    $m=0;

    while ($m < $num){
        $user_answer = array($m => $_GET["radioGroup"]);    
        $m++;
    }

    $k = 0;
    $point = 0;
    $sql = "SELECT * from questions";
    $result=mysql_query($sql);
    while($k < $num){
        $answer = array($k => mysql_result($result,$k,"answer"));

        if ($answer[$k] == $user_answer[$k]){
            $point++ ;  
        }

        echo "puan:";
        echo $point;
        $k++;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:42:01.373

您不了解如何接收表单值。

在您的代码 ( `result.php`) 中，这`$_GET["radioGroup"]`是一个包含所有答案的数组。

试试这个简单的脚本来了解它是如何工作的：

```
<form>
    <input type='radio' name='radioGroup[1]' value='yes' checked="checked" />
    <input type='radio' name='radioGroup[1]' value='no'  />
    <br/>
    <input type='radio' name='radioGroup[2]' value='yes'  />
    <input type='radio' name='radioGroup[2]' value='no'  checked="checked"  />
    <br/>
    <input type='submit' name='submit' value='true' />
</form>

<pre>
<?php

    if( isset($_GET['submit']) )
    {   
        print_r($_GET);
    } 
```

输出是这样的：

```
Array
(
    [radioGroup] => Array
        (
            [1] => yes
            [2] => no
        )

    [submit] => true
) 
```

# google-apps-script - “安装”私有应用脚本

> ID：11486090
> 
> 赞同：1
> 
> 时间：2012-07-14T18:01:04.210
> 
> 标签：google-apps-script, google-sheets

在 Google 电子表格中，您可以转到工具 --> 脚本库，然后从库中“安装”任何公共脚本。

是否可以类似地“安装”不属于脚本库的脚本。或者我应该为此提交增强请求吗？

手头的问题是跨多个电子表格需要一个类似的脚本。一种选择是使用库，但这将再次需要在每个电子表格中编写或至少复制粘贴使用库的框架代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-21T07:44:03.703

是的，您应该在问题跟踪器上填写增强请求（我很乐意盯着它）。

现在，如果您不想公开共享您的脚本，但您需要为您的用户轻松安装（他们应该看不到代码），您可以：

*   在 Google 文档模板库中创建电子表格模板
*   创建 Chrome Web 应用并与特定群组共享
*   将您的脚本放入 Google 协作平台并添加一个 UI 以让用户选择应该在哪个电子表格上触发脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T18:26:14.640

您可以使用其 ID 轻松安装您的私有库

您可以在 Tools-Script Editor->File->Project Properties->Info->Project Key 下找到您的库的 ID

# python - 将高度嵌套的 MAT 文件加载到 Python 中

> ID：11486096
> 
> 赞同：1
> 
> 时间：2012-07-14T18:01:39.080
> 
> 标签：python, matlab, numpy

我正在尝试加载一个 MAT 文件，它是一个结构元胞数组。这些结构中的每一个都有许多字段，其中一些本身就是单元格。

一个典型的调用是：

```
 myCell{1}.myStructField{1}.myStructField 
```

如何将这样的嵌套结构加载到 Python 中？

谢谢你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:07:24.227

[`scipy.io.loadmat`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.io.loadmat.html)如果它是 v7.3 之前的，将加载 mat 文件；然后您可以像访问它一样访问它`matfile['myCell'][0]['myStructField'][0]['myStructField']`。

如果是 v7.3 或更高版本，您可以使用[`h5py`](http://h5py.alfven.org/); 打开它后，我认为它也会是`f['myCell'][0]['myStructField'][0]['myStructField']`，尽管您需要担心由于列主要/行主要差异而可能转置矩阵。

# c++ - 这些函数是怎么在定义之前被调用的？

> ID：11486100
> 
> 赞同：5
> 
> 时间：2012-07-14T18:01:58.013
> 
> 标签：c++

这是时间函数的 cpp。代码在这个 time.cpp 上定义了一个 time.h 文件的功能。我的问题是：如果这个 fct 中的函数是在之后定义的，那么这个函数定义怎么可能呢？谢谢

```
void Time::setTime(int hour, int minute, int second)
{
    sethour(hour);
    setminute(minute);
    setseconds(seconds);
}

void Time::sethour( int h)
{ .... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T18:03:21.917

调用函数不需要定义，只需要声明。编译器对单独的声明感到满意。链接器需要生成代码，并且需要定义，但是什么**时候**定义它们并不重要，只要你这样做。

在您的情况下，每个成员函数的声明对所有其他成员函数都是可见的，即使在类定义中它是在之后出现的：

```
class Time
{
   void setTime();  //setTime knows about sethour even if it's before
   void sethour();
}; 
```

在类之外，这不成立，这意味着您需要在使用方法之前进行声明。声明只是原型：

```
void foo();
void goo()
{
    foo(); //can call foo here even if it's just declared and not defined
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T18:03:15.820

大概是因为它们是在上面的某个地方**声明**的（例如在头文件中），这才是重要的。

最好想象编译器以“一次性”的方式运行；它从上到下线性处理您的代码。因此，在使用函数之前，它需要知道函数的存在（即它们的名称、参数和返回类型），以便确定调用者没有做一些无效的事情。但实际的函数定义（即它的主体）与此任务无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:06:13.600

您可以选择何时定义它们。

# jquery - flex 滑块 2 显示控制选项卡

> ID：11486108
> 
> 赞同：2
> 
> 时间：2012-07-14T18:03:05.253
> 
> 标签：jquery, html, css

我正在使用 woothemes [flex 滑块](http://www.woothemes.com/flexslider/)，到目前为止它很棒。我开箱即用，但我对如何自定义它感到非常困惑。一切正常，除了我希望控制导航（左箭头，右箭头）始终显示在滑块上，而不仅仅是当我将鼠标悬停在图像上时。如何使滑块箭头始终显示？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-14T18:07:56.900

在 CSS 中编辑这些行：

```
.flexslider:hover .flex-prev {
    opacity: 0.8;
    left: 5px;
} 
```

到：

```
.flexslider .flex-prev {
    opacity: 0.8;
    left: 5px;
} 
```

它将始终显示控制箭头。

# sql-server - 什么时候应该使用实体框架？

> ID：11486109
> 
> 赞同：2
> 
> 时间：2012-07-14T18:03:06.447
> 
> 标签：sql-server, entity-framework, entity-framework-4

我是 Entity Framework 的新手，当然，我在 SOF 上发现了一些关于目标用例的问题。

让我给你一些信息。我不是在与不同的数据库供应商或不同的数据库打交道；一个，而且只有一个，SQL Server 2008 和数据库有不到 30 个表。我真的需要重做一些事情并使用实体框架吗？

编辑：

感谢 James 解决了我的问题。所以我假设使用 EF 会增加开销并在后台做一些我不知道的工作。这是 MS 的工作方式，所以我想我的下一个问题是：

1.  它也会影响性能吗？

2.  它是否支持hierarchyid数据类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T18:05:28.693

使用实体框架（或任何其他对象关系映射器，例如 LINQ to SQL、NHIbernate 等）的主要原因是为了在您的应用程序中更轻松地访问数据。使用 EF，您只需将新值分配给 .NET 对象即可获得通过 LINQ 进行查询和简单更新的强大功能，而无需自己编写任何 SQL 代码。

就我个人而言，我使用 EF Code First 和 EF Migrations 进行绿地开发和 LINQ to SQL 在我有现有数据库可以构建的情况下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T03:57:05.497

**如果您正在执行交互式数据操作**，则应使用 ORM 对象关系映射器（例如 EntityFramework SQL 或使用存储过程调用）。ORM 确实有性能损失，但在交互式系统中，这种性能损失可以忽略不计，一方面是因为“繁重的工作”大大减少，另一方面是因为产生最大性能损失的元素是人与系统交互

另一方面，如果您需要对**复杂的东西进行大量的批处理，这些**东西将从一些表中取出东西并将其放入其他表中而无需任何交互式用户干预，那么在这种情况下，ORM 方法的性能损失就会变得很明显，避免从数据库内存空间中取出东西是值得的，使用存储过程的性能优势最终变得明显。

所以总的来说：

*   将 ORM 用于交互式内容
*   将存储过程用于非交互式批处理内容

# java - 搜索方法不起作用

> ID：11486120
> 
> 赞同：0
> 
> 时间：2012-07-14T18:04:08.637
> 
> 标签：java, hashmap

基本上我有一个哈希图，搜索方法缺少一个keyboard.next，它应该允许用户输入他们想要搜索的名称。没有错误。输出不允许用户输入他们想要搜索的名称。奇怪的是我可以使用 userInput 方法，而且效果很好。这是我的代码：商店声明

```
//Imports.
import java.util.Scanner;
//********************************************************************  
public class MainApp
{
    //The Scanner is declared here for use throughout the whole MainApp.
    private static Scanner keyboard = new Scanner(System.in);

    public static void main(String[] args)
    {
        new MainApp().start();

    }
    public void start()
    {
//Create a Store named Store and add Employee's to the Store.
        EmployeeStore Store = new EmployeeStore();
        Store.add(new Employee ("James O' Carroll", 18,"hotmail.com"));

        Store.add(new Employee ("Andy Carroll", 1171,"yahoo.com"));

        Store.add(new Employee ("Luis Suarez", 7,"gmail.com"));
//********************************************************************      

/*Test Code.
        Store.searchByName("James O' Carroll");
        Store.print();
        Store.searchByEmail("gmail.com");
        Employee andy = Store.searchByEmail("hotmail.com");
        System.out.println(andy);
        Employee employee = Store.searchByName("James O' Carroll");
        if (employee != null)
        {
            employee.setEmployeeName("Joe");
            employee.setEmployeeId(1);
            employee.setEmployeeEmail("webmail.com");
           Store.edit(employee);
           Store.print();
        }*/
//********************************************************************      

        int choice ;
        System.out.println("Welcome to the Company Database.");
        do
        {
         choice = MenuMethods.getMenuChoice(
                "1.\tView All" +
                "\n2.\tAdd" +
                "\n3.\tDelete" +
                "\n4.\tDelete All " +
                "\n5.\tEdit" +
                "\n6.\tSearch" +
                "\n7.\tPrint"+
                "\n8.\tExit", 8, "Please enter your choice:", "Error [1,8] Only");
         //String temp = keyboard.nextLine();  This prevented entering the choice.
        switch (choice) 
        {
            case 1:
                 System.out.println("View All");
                Store.print();

                break;

        case 2:
             System.out.println("Add");
                Employee employee = MenuMethods.userInput();
                Store.add(employee);

                break;

        case 3:
             System.out.println("Delete");
                //Store.delete();

                break;

        case 4:
                System.out.println("Delete All");
                Store.clear();

                break;
        case 5:
           System.out.println("Edit");
           Employee employee2 = MenuMethods.userInput();
           Store.searchByName(employee2.getEmployeeName());
         if (employee2 != null)
        {
            employee2.setEmployeeName("Joe");
            employee2.setEmployeeId(1);
            employee2.setEmployeeEmail("webmail.com");
           Store.edit(employee2);
           Store.print();
        }

            break;
        case 6:
             System.out.println("Search");
             Employee employee1 = MenuMethods.userInputByName();
             Store.searchByName(employee1.getEmployeeName());

            break;
        case 7:
             System.out.println("Print");
            Store.print();

            break;
        case 8:
             System.out.println("Exit");

            break;
        }

        } while (choice != 8);

     }
}

//Imports
import java.util.Scanner;
//********************************************************************

public class MenuMethods 
{
    private static Scanner keyboard = new Scanner(System.in);

    //Methods for the Company Application menu.
    //Method for validating the choice.
         public static int getMenuChoice(String menuString, int limit, String prompt, String errorMessage) 
         {
                System.out.println(menuString);
                int choice = inputAndValidateInt(1, limit, prompt, errorMessage);
                return choice;
         }
    //********************************************************************
    //This method is used in the getMenuChoice method.
            public static int inputAndValidateInt(int min, int max, String prompt, String errorMessage) 
            {
                int number;
                boolean valid;
                do {
                    System.out.print(prompt);
                    number = keyboard.nextInt();
                    valid = number <= max && number >= min;
                    if (!valid) {
                        System.out.println(errorMessage);
                    }
                } while (!valid);
                return number;
            }
    //********************************************************************
    public static Employee userInput()
    {
         String temp = keyboard.nextLine();
         Employee e = null;
         System.out.println("Please enter the Employee Name:");
         String employeeName = keyboard.nextLine();
         System.out.println("Please enter the Employee ID:");
         int employeeId = keyboard.nextInt();
         temp = keyboard.nextLine();
         System.out.println("Please enter the Employee E-mail address:");
         String employeeEmail  = keyboard.nextLine();
         return e = new Employee(employeeName , employeeId, employeeEmail);

    }
    //********************************************************************
    public static Employee userInputByName()
    {

         Employee e = null;
         System.out.println("Please enter the Employee Name:");
         String employeeName = keyboard.nextLine();
         System.out.println("Please enter the Employee Name:");

         return e =  new Employee(employeeName);

    }
    //********************************************************************

} 
```

mainApp中的搜索方法

```
case 6:
             System.out.println("Search");
             Employee employee1 = MenuMethods.userInputByName();
             Store.searchByName(employee1.getEmployeeName());

            break; 
```

实际的搜索方法。

```
public Employee searchByName(String employeeName) 
    {
        Employee employee = map.get(employeeName);    
        System.out.println(employee);
        return employee;
    }
//******************************************************************** 
```

userInputByName 方法。这就是问题所在。

```
 public static Employee userInput()
    {
         String temp = keyboard.nextLine();
         Employee e = null;
         System.out.println("Please enter the Employee Name:");
         String employeeName = keyboard.nextLine();
         System.out.println("Please enter the Employee ID:");
         int employeeId = keyboard.nextInt();
         temp = keyboard.nextLine();
         System.out.println("Please enter the Employee E-mail address:");
         String employeeEmail  = keyboard.nextLine();
         return e = new Employee(employeeName , employeeId, employeeEmail);

    }
    //********************************************************************
    public static Employee userInputByName()
    {

         Employee e = null;
         System.out.println("Please enter the Employee Name:");
         String employeeName = keyboard.nextLine();
         System.out.println("Please enter the Employee Name:");

         return e =  new Employee(employeeName);

    }
    //******************************************************************** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:53:51.693

让我尽力而为。

首先，为什么`println`您的 中有两个语句`userInputByName()`？

```
 public static Employee userInputByName()
    {
         Employee e = null; 
         System.out.println("Please enter the Employee Name:");
         String employeeName = keyboard.nextLine();
         System.out.println("Please enter the Employee Name:"); //!???

         return e =  new Employee(employeeName);
    } 
```

然后，在这种情况下`6`，您只需调用该方法`searchByName`，而不检查搜索是否成功。我建议：

```
case 6:
    System.out.println("Search");
    Employee employee1 = MenuMethods.userInputByName();
    Employee foundEmployee = Store.searchByName(employee1.getEmployeeName());

    if (foundEmployee != null) {
        System.out.println("Found employee!");
    } else {
        System.out.println("Not Found!");
    }

    break; 
```

# java - SQL 查询不会执行 SQLite，Java

> ID：11486122
> 
> 赞同：3
> 
> 时间：2012-07-14T18:04:17.577
> 
> 标签：java, sql, sqlite, jdbc

**问题概要：** 当尝试在 Java 中使用 SQLite 数据库执行 SQL 查询时，SQL 语句无法从 execute() 或 executeQuery() 方法返回。换句话说，系统在执行这条 SQL 语句时“挂起”。

**问题：** 我在解释为​​什么 ResultSet 永远不会“返回”时做错了什么？

**故障排除** 我试图缩小问题范围，问题似乎出在 Java 的 execute() 或 executeQuery() 上。ResultSet 似乎永远不会返回。例如，我尝试直接在 SQLite 中执行完全相同的查询（即使用 SQLite DB 管理器）。查询（在 Java 之外）在大约 5 毫秒内执行并返回有效的结果集。

注意：不会引发异常。该系统似乎只是“挂起”并且在手动杀死之前变得无响应。（等待超过 10 分钟。）

**代码：** 我对这段代码进行了大量编辑，以使问题更易于查看。（在生产中，这使用准备好的语句。但是，错误发生在两种方法中——直接声明和准备好的声明版本。）

基本上，SELECT 返回单个数据库项目，以便用户可以查看该项目。

```
Statement st = conn.createStatement() ;
ResultSet rs = st.executeQuery("SELECT DISTINCT  d1.id, d1.sourcefullfilepath, " +
    "d1.sourcefilepath, d1.sourcefilename, d1.classificationid, d1.classid, " +
    "d1.userid  FROM MatterDataset,   (SELECT MatterDataset.id, " + 
    "MatterDataset.sourcefullfilepath, MatterDataset.sourcefilepath, " +
    "MatterDataset.sourcefilename, MatterDataset.matterid   , " +
    "DocumentClassification.classificationid, DocumentClassification.classid," +
    " DocumentClassification.userid   FROM MatterDataset    " +
    "LEFT JOIN DocumentClassification ON " +
    "DocumentClassification.documentid = Matterdataset.id    " +
    "WHERE (   DocumentClassification.classid = 1 OR  " +
    "DocumentClassification.classid = 2 )   AND " +
    "DocumentClassification.userid < 0    AND " +
    "MatterDataset.matterid = \'100\'   ) AS d1    " +
    "LEFT JOIN PrivilegeLog ON " +
    "d1.id = PrivilegeLog.documentparentid AND " +
    "d1.matterid = PrivilegeLog.matterid  " +
    "WHERE PrivilegeLog.privilegelogitemid IS NULL  " +
    "AND MatterDataset.matterid = \'100\'   " +
    "ORDER BY d1.id  LIMIT 1 ;") ; 
```

**配置：** Java 6、JDBC 驱动程序 = Xerial sqlite-jdbc-3.7.2、SQLite 3、Windows

**更新** 次要修订：当我继续使用此功能时，将 MIN(d1.id) 添加到 SQL 语句的开头至少会返回一个 ResultSet（而不是“挂起”）。但是，这并不是我真正想要的，因为 MIN 消除了 LIMIT 函数。

```
Statement st = conn.createStatement() ;
ResultSet rs = st.executeQuery("SELECT DISTINCT  MIN(d1.id), d1.id,
    d1.sourcefullfilepath, " +
    "d1.sourcefilepath, d1.sourcefilename, d1.classificationid, d1.classid, " +
    "d1.userid  FROM MatterDataset,   (SELECT MatterDataset.id, " + 
    "MatterDataset.sourcefullfilepath, MatterDataset.sourcefilepath, " +
    "MatterDataset.sourcefilename, MatterDataset.matterid   , " +
    "DocumentClassification.classificationid, DocumentClassification.classid," +
    " DocumentClassification.userid   FROM MatterDataset    " +
    "LEFT JOIN DocumentClassification ON " +
    "DocumentClassification.documentid = Matterdataset.id    " +
    "WHERE (   DocumentClassification.classid = 1 OR  " +
    "DocumentClassification.classid = 2 )   AND " +
    "DocumentClassification.userid < 0    AND " +
    "MatterDataset.matterid = \'100\'   ) AS d1    " +
    "LEFT JOIN PrivilegeLog ON " +
    "d1.id = PrivilegeLog.documentparentid AND " +
    "d1.matterid = PrivilegeLog.matterid  " +
    "WHERE PrivilegeLog.privilegelogitemid IS NULL  " +
    "AND MatterDataset.matterid = \'100\'   " +
    "ORDER BY d1.id  LIMIT 1 ;") ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:44:31.417

我回去重新开始。SQL 语法虽然在 Java 之外工作，但对于 JDBC 驱动程序来说似乎过于复杂。这个清理后的修订似乎有效：

```
SELECT DISTINCT 
  MatterDataset.id, MatterDataset.sourcefullfilepath, MatterDataset.sourcefilepath,
  MatterDataset.sourcefilename
FROM MatterDataset , DocumentClassification 
  ON DocumentClassification.documentid = MatterDataset.id  
    AND MatterDataset.matterid = DocumentClassification.matterid
LEFT JOIN PrivilegeLog ON MatterDataset.id = PrivilegeLog.documentparentid 
  AND MatterDataset.matterid = PrivilegeLog.matterid
WHERE PrivilegeLog.privilegelogitemid IS NULL  
  AND MatterDataset.matterid = '100' 
  AND (DocumentClassification.classid = 1 OR DocumentClassification.classid = 2) 
  AND DocumentClassification.userid = -99
ORDER BY MatterDataset.id LIMIT 1; 
```

一个很好的教训：仅仅因为你可以在 SQL 中并不意味着你应该。

该语句的作用本质上是在 MatterDataset 表中定位不在 PrivilegeLog 表中的项目。LEFT JOIN 和 IS NULL 语法定位“丢失”的项目。也就是说，我想查找在 MatterDataset 但尚未在 PrivilegeLog 中的项目并返回这些项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:33:34.033

多么混乱的 SQL 语句（对不起）！我不知道 SQLite，但为什么不简化为：

```
SELECT DISTINCT md.id, md.sourcefullfilepath, md.sourcefilepath, md.sourcefilename, 
                dc.classificationid, dc.classid, dc.userid
FROM MatterDataset md
LEFT JOIN DocumentClassification dc
       ON dc.documentid = md.id
      AND (dc.classid = 1 OR dc.classid = 2 )
      AND dc.userid < 0
LEFT JOIN PrivilegeLog pl
       ON md.id = pl.documentparentid 
      AND md.matterid = pl.matterid
WHERE pl.privilegelogitemid IS NULL
  AND md.matterid = \'100\'
ORDER BY md.id LIMIT 1 ; 
```

我不确定您是要 LEFT JOIN 还是 INNER JOIN 到 DocumentClassification（使用 LEFT JOIN 然后在 WHERE 语句中对 classid 和 userid 提出要求 - 在我看来 - 是矛盾的）。如果 DocumentClassification 必须存在，则更改为 INNER JOIN 并将对 classid 和 userid 的引用放入 WHERE 子句中，如果 DocumentClassification 可能存在或可能不存在于您的结果集中，则按照我上面的建议保留查询。

# java - Android：按下按钮后，CheckBox onCheckedChange 不起作用

> ID：11486128
> 
> 赞同：0
> 
> 时间：2012-07-14T18:05:41.700
> 
> 标签：java, android, listview, checkbox

我创建了一个`ArrayList`with custom `ArrayAdater`。每个都`ListItem`包含 a`CheckBox`和 a `TextView`。

TextView 包含目录的名称，而 CheckBox 指示是否应扫描该目录。

我正在维护一个`ArrayList`存储所有已检查目录名称的目录。ListView 中有一些`buttons`向下。

最初，当我选中/取消选中应用程序时，ArrayList 工作正常并在其中添加/删除元素。

但是当我按下任何按钮时，ArrayList 会冻结并且不会添加/删除元素。

下面的代码：（***对不起，长度）***

MainActivity 类：

```
public class MainActivity extends ListActivity implements OnClickListener {

    Button done, cancel, selectAll, back;
    ListView listView;
    ArrayAdapter<Directory> adapter;
    List<Directory> list;
    ArrayList<String> checkedList;
    private final static String ROOT = "/";
    private String currentDir; // Used at the time of back button press

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        try {
            setContentView(R.layout.main);
            checkedList = new ArrayList<String>();
            done = (Button) findViewById(R.id.bDone);
            back = (Button) findViewById(R.id.bBack);
            cancel = (Button) findViewById(R.id.bCancel);
            selectAll = (Button) findViewById(R.id.bSelAll);
            done.setOnClickListener(this);
            back.setOnClickListener(this);
            cancel.setOnClickListener(this);

            currentDir = ROOT;
            new AsyncHandler(this, ROOT).execute();
        } catch (Exception e) {
            Toast.makeText(this, e.toString(), Toast.LENGTH_SHORT).show();
        }
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        // super.onListItemClick(l, v, position, id);
        try {
            Directory d = list.get(position);
            File f = d.getFile();
            if (f.isDirectory() && f.canRead()) {
                // Updating View on List TextView item click
                currentDir = f.getAbsolutePath();
                new AsyncHandler(this, f.getAbsolutePath()).execute();
            } else {
                Toast.makeText(this, f.getName() + " NOT READABLE",
                        Toast.LENGTH_SHORT).show();
            }
        } catch (Exception e) {
            Toast.makeText(this, e.toString(), Toast.LENGTH_SHORT).show();
        }
    }

    @Override
    public void onClick(View view) {
        switch (view.getId()) {
        case R.id.bDone:
            ArrayList<String> localCheckedList = checkedList;
            checkedList = filterCheckedList();
            String allCkecdDirs = "";
            for (int i = 0; i < checkedList.size(); i++) {
                allCkecdDirs = allCkecdDirs + "\n" + checkedList.get(i);
            }
            Toast.makeText(this, allCkecdDirs, Toast.LENGTH_LONG).show();
            break;
        case R.id.bBack:
            if(!currentDir.equals(ROOT)){
                /*
                 * here backtracking current directory one step
                 * if current die = /mnt/sdcard/music
                 * so now it will be /mnt/sdcard
                 * this is because if Back button is pressed, 
                 * in ElementAdapter while rendering elements 
                 * the currentDir will become /mnt/sdcard/music/music  
                 */
                currentDir = new File(currentDir).getParent();  
                new AsyncHandler(this, currentDir).execute();
            }else{
                Toast.makeText(this, "Listing already at Root Folder", Toast.LENGTH_LONG).show();
            }
            break;
        case R.id.bCancel:
            this.finish();
            break;
        }
    }

    private ArrayList<String> filterCheckedList() {
        /*
         * Removing duplicates
         */
        HashSet hs = new HashSet();
        hs.addAll(checkedList);
        checkedList.clear();
        checkedList.addAll(hs);

        /*
         * Deleting sub-folders if their parent folder has already been added in
         * the list
         */
        Collections.sort(checkedList);
        ArrayList<String> filteredList = new ArrayList<String>();
        for (int i = 0; i < checkedList.size(); i++) {
            File current = new File(checkedList.get(i));
            File parent = current;
            while ((parent = parent.getParentFile()) != null) {
                if (checkedList.contains(parent.getAbsolutePath())) {
                    current = parent;
                }
            }
            if (current != null
                    && !filteredList.contains(current.getAbsolutePath())) {
                filteredList.add(current.getAbsolutePath());
            }
        }
        checkedList = filteredList;
        return checkedList;
    }

    public class AsyncHandler extends AsyncTask {

        Context context;
        String currentFolder;
        private List<Directory> prevList;

        public AsyncHandler(Context c, String currentFolder) {
            this.context = c;
            this.currentFolder = currentFolder;
        }

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
        }

        @Override
        protected Object doInBackground(Object... arg0) {
            getList();
            return null;
        }

        @Override
        protected void onPostExecute(Object result) {
            /*
             * Checking if list does not contain any directory. If it does not
             * then the previous view's list is treated as current list and
             * rendered again.
             */
            if (list.size() == 0) {
                Toast.makeText(context, "No Sub Directory", Toast.LENGTH_SHORT)
                        .show();
                list = prevList;
            }
            setListAdapter(new ElementAdapter(context, list, checkedList, currentDir));
        }

        private void getList() {
            prevList = list;
            list = new ArrayList<Directory>();
            File root = new File(currentFolder);
            File[] files = root.listFiles();
            for (File f : files) {
                if (f.isDirectory() && !f.isHidden() && f.canRead()) {
                    list.add(new Directory(f, f.getName()));
                }
            }
        }
    }
} 
```

数组适配器类：

```
public class ElementAdapter extends ArrayAdapter {
    private Context context;
    private List<Directory> list;
    ArrayList<String> checkedList;
    public final String fileName = "AudioSessionFile";
    SharedPreferences sharedAudioPrefrences;
    private static String currentDir;   // This will be appended at the time when
                                        // chcing if the checkbox is aready
                                        // checked or not

    public ElementAdapter(Context c, List<Directory> list,
            ArrayList checkedList, String currentDir) {
        super(c, R.layout.row, list);
        this.context = c;
        sharedAudioPrefrences = c.getSharedPreferences(fileName,
                Context.MODE_PRIVATE);
        this.list = list;
        this.checkedList = checkedList;
        this.currentDir = currentDir;
    }

    static class ViewHolder {
        protected TextView textView;
        protected CheckBox checkBox;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder viewHolder = null;
        View view = convertView;
        if (view == null) {
            LayoutInflater inflator = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            view = inflator.inflate(R.layout.row, null);
            viewHolder = new ViewHolder();
            viewHolder.textView = (TextView) view.findViewById(R.id.tvElement);
            viewHolder.checkBox = (CheckBox) view.findViewById(R.id.checkBox1);
            viewHolder.checkBox
                    .setOnCheckedChangeListener(new OnCheckedChangeListener() {

                        @Override
                        public void onCheckedChanged(CompoundButton buttonView,
                                boolean isChecked) {
                            int getPosition = (Integer) buttonView.getTag();
                            list.get(getPosition).setSelected(
                                    buttonView.isChecked());

                            /*
                             * Code to check if checkbox is checked on
                             * unchecked. If checked then, the corresponding
                             * entry is made in the HashMap (which contains the
                             * state of directories to be scanned)
                             */
                            if (isChecked
                                    && !checkedList.contains(list
                                            .get(getPosition).getFile()
                                            .getAbsolutePath())) {
                                /*
                                 * Here we can also put condition &&
                                 * !checkedList
                                 * .contains(list.get(getPosition).getFile
                                 * ().getParent()) to avoid creating unnecessary
                                 * entries
                                 */
                                checkedList.add(list.get(getPosition).getFile()
                                        .getAbsolutePath());
                            } else if (!isChecked
                                    && checkedList.contains(list
                                            .get(getPosition).getFile()
                                            .getAbsolutePath())) {
                                checkedList.remove(list.get(getPosition)
                                        .getFile().getAbsolutePath());
                            }
                        }
                    });
            view.setTag(viewHolder);
            view.setTag(R.id.tvElement, viewHolder.textView);
            view.setTag(R.id.checkBox1, viewHolder.checkBox);
        } else {
            viewHolder = (ViewHolder) view.getTag();
        }
        viewHolder.checkBox.setTag(position);
        viewHolder.textView.setText(list.get(position).getName());
        viewHolder.checkBox.setChecked(list.get(position).isSelected());

        /*
         * checking if the directory is already selected earlier by the user
         */
        String absPath = currentDir + "/" +  viewHolder.textView.getText();
        if (checkedList != null
                && checkedList.contains(absPath)) {
            viewHolder.checkBox.setChecked(true);
        }

        return view;
    }
} 
```

**虽然代码确实进入了 ElementAdapter 中的 onCheckedChangeListener，但是当流返回到 Activity 类时，列表保持原样。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:34:15.023

尝试在语句`notifyDataSetChanged()` **之后添加。**`setListAdapter(new ElementAdapter(context, list, checkedList, currentDir))`

**例如：**

```
 ElementAdapter myAdpt = new ElementAdapter(context, list, checkedList, currentDir)
   setListAdapter(myAdpt);
   myAdpt.notifyDataSetChanged(); 
```

# mysql - 在 Rails 中使用变异元音作为数据库密码

> ID：11486130
> 
> 赞同：1
> 
> 时间：2012-07-14T18:05:54.430
> 
> 标签：mysql, ruby-on-rails, encoding, migration, yaml

我有一个带有 mySQL 数据库的 rails 应用程序，并且没有更改用户数据库密码的权限。问题是密码包含一个变异的元音，例如：`asÖs8ss`当我尝试运行`rake db:migrate`迁移失败并出现以下错误：

```
rake aborted!
special characters are not allowed 
```

我试图以`Ö`这种方式逃避：

```
\xC3\x96
\u00D6 
```

但这无济于事。我还添加`encoding: UTF8`到数据库连接和`#encoding: utf-8`顶部，`database.yml`但没有任何帮助解决我的问题。

有谁知道如何逃避`Ö`权利或以某种方式解决这个问题？

**更新**我正在使用 JRuby，如果这有帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:28:40.943

在我更新到最新版本的 JRuby 并运行后，`bundle update`我让它工作了。此外，您必须确保所有文件都`utf-8`在我的 windows 机器上，我必须配置我的编辑器，因为默认是`ANSI`.

我需要`db:migrate`使用以下命令运行：

```
jruby -J-Dfile.encoding=UTF-8 -S rake db:migrate RAILS_ENV=production 
```

# php - 在 PHP 中使用神经网络进行时间序列预测

> ID：11486131
> 
> 赞同：1
> 
> 时间：2012-07-14T18:06:05.357
> 
> 标签：php, neural-network

我目前正在建立一个网站，该网站将汇总新闻文章，然后根据其内容对其进行分类。但是，我想分析文章发表的时间，以便确定它们是否出现某种趋势，从而使我可以预测下一篇文章可能发表的时间，也无需用于频繁/不必要的爬行尝试。

我在互联网上看过，似乎神经网络可以用于分析时间序列'，但是我没有找到任何有益或易于初学者理解然后适应的示例/代码片段。

这些文章似乎还建议神经网络的输入应该是 0 或 1，因此您将如何在 PHP 中创建具有以下输入的神经网络，即 unix 时间戳和输出单个值的能力?

*   1332193520
*   1342194916
*   1342196716
*   1342197376
*   1352197856
*   1362198756

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:23:42.460

用 PHP 训练 NN 会很困难。这应该使用一些快速的非脚本语言离线完成。哦，神经网络参数的实现、训练，尤其是调整不是一项简单的任务。

如果我是你，我会选择在文本分类方面优于其他方法并且部署非常简单的线性 SVM（理论上很优雅——顺便说一句，NN 是老式的）。用多种语言编写的[SVM Light](http://svmlight.joachims.org/)和[LIBSVM](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)等 SVM 的实现非常出色 。

# python - Heroku 上的 Python 语言环境设置

> ID：11486133
> 
> 赞同：4
> 
> 时间：2012-07-14T18:06:07.283
> 
> 标签：python, localization, heroku, locale

我正在[Heroku](http://www.heroku.com/)上开发一个 python Web 应用程序，但我遇到了语言环境设置的问题。

我的目标是将python`datetime`对象格式化为这样的字符串

```
import datetime
now = datetime.datetime.now()
print now.strftime('%a %d %B %Y')  # output: Sat 14 July 2012 
```

但用不同的语言。

因此，在我的本地机器上，我使用：

```
import locale
locale.setlocale(locale.LC_ALL, '') 
```

或`locale.setlocale(locale.LC_ALL, 'de_DE.UTF-8')`特定语言。

在我的本地机器上这是可行的，我得到了正确语言的日期，但在 Heroku 上它失败了，我得到的只是一个`locale.Error: unsupported locale settings`.

我做错了什么还是允许在 Heroku 上的 python 应用程序中更改语言环境设置？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-11-17T22:00:40.543

您可以通过运行以下命令查看可用的语言环境：

```
$ heroku run "locale -a"
Running `locale -a` attached to terminal... up, run.5061
aa_DJ.utf8
aa_ER
aa_ER@saaho
aa_ET
af_ZA.utf8
am_ET
an_ES.utf8
ar_AE.utf8
ar_BH.utf8
ar_DZ.utf8
ar_EG.utf8
ar_IN
ar_IQ.utf8
ar_JO.utf8
ar_KW.utf8
ar_LB.utf8
ar_LY.utf8
ar_MA.utf8
ar_OM.utf8
ar_QA.utf8
ar_SA.utf8
ar_SD.utf8
ar_SY.utf8
ar_TN.utf8
ar_YE.utf8
as_IN
ast_ES.utf8
az_AZ
be_BY@latin
be_BY.utf8
ber_DZ
ber_MA
bg_BG.utf8
bn_BD
bn_IN
bo_CN
bo_IN
br_FR.utf8
bs_BA.utf8
C
ca_AD.utf8
ca_ES.utf8
ca_ES.utf8@valencia
ca_FR.utf8
ca_IT.utf8
crh_UA
csb_PL
cs_CZ.utf8
cy_GB.utf8
da_DK.utf8
de_AT.utf8
de_BE.utf8
de_CH.utf8
de_DE.utf8
de_LI.utf8
de_LU.utf8
dv_MV
dz_BT
el_CY.utf8
el_GR.utf8
en_AG
en_AU.utf8
en_BW.utf8
en_CA.utf8
en_DK.utf8
en_GB.utf8
en_HK.utf8
en_IE.utf8
en_IN
en_NG
en_NZ.utf8
en_PH.utf8
en_SG.utf8
en_US.utf8
en_ZA.utf8
en_ZW.utf8
eo_US.utf8
eo.utf8
es_AR.utf8
es_BO.utf8
es_CL.utf8
es_CO.utf8
es_CR.utf8
es_DO.utf8
es_EC.utf8
es_ES.utf8
es_GT.utf8
es_HN.utf8
es_MX.utf8
es_NI.utf8
es_PA.utf8
es_PE.utf8
es_PR.utf8
es_PY.utf8
es_SV.utf8
es_US.utf8
es_UY.utf8
es_VE.utf8
et_EE.utf8
eu_ES.utf8
eu_FR.utf8
fa_IR
fi_FI.utf8
fil_PH
fo_FO.utf8
fr_BE.utf8
fr_CA.utf8
fr_CH.utf8
fr_FR.utf8
fr_LU.utf8
fur_IT
fy_DE
fy_NL
ga_IE.utf8
gd_GB.utf8
gl_ES.utf8
gu_IN
ha_NG
he_IL.utf8
hi_IN
hne_IN
hr_HR.utf8
hsb_DE.utf8
ht_HT
hu_HU.utf8
hy_AM
ia
id_ID.utf8
ig_NG
is_IS.utf8
it_CH.utf8
it_IT.utf8
iu_CA
ja_JP.utf8
ka_GE.utf8
kk_KZ.utf8
km_KH
kn_IN
ko_KR.utf8
ks_IN
ks_IN@devanagari
ku_TR.utf8
kw_GB.utf8
ky_KG
la_AU.utf8
lg_UG.utf8
li_BE
li_NL
lo_LA
lt_LT.utf8
lv_LV.utf8
mai_IN
mg_MG.utf8
mi_NZ.utf8
mk_MK.utf8
ml_IN
mn_MN
mr_IN
ms_MY.utf8
mt_MT.utf8
nan_TW@latin
nb_NO.utf8
nds_DE
nds_NL
ne_NP
nl_AW
nl_BE.utf8
nl_NL.utf8
nn_NO.utf8
nr_ZA
nso_ZA
oc_FR.utf8
om_ET
om_KE.utf8
or_IN
pa_IN
pap_AN
pa_PK
pl_PL.utf8
POSIX
pt_BR.utf8
pt_PT.utf8
ro_RO.utf8
ru_RU.utf8
ru_UA.utf8
rw_RW
sa_IN
sc_IT
sd_IN
sd_IN@devanagari
se_NO
shs_CA
si_LK
sk_SK.utf8
sl_SI.utf8
so_DJ.utf8
so_ET
so_KE.utf8
so_SO.utf8
sq_AL.utf8
sr_ME
sr_RS
sr_RS@latin
ss_ZA
st_ZA.utf8
sv_FI.utf8
sv_SE.utf8
ta_IN
te_IN
tg_TJ.utf8
th_TH.utf8
ti_ER
ti_ET
tk_TM
tlh_GB.utf8
tl_PH.utf8
tn_ZA
tr_CY.utf8
tr_TR.utf8
ts_ZA
tt_RU
tt_RU@iqtelif
ug_CN
uk_UA.utf8
ur_PK
uz_UZ@cyrillic
uz_UZ.utf8
ve_ZA
vi_VN
wa_BE.utf8
wo_SN
xh_ZA.utf8
yi_US.utf8
yo_NG
zh_CN.utf8
zh_HK.utf8
zh_SG.utf8
zh_TW.utf8
zu_ZA.utf8 
```

要解决您的问题，请尝试

```
locale.setlocale(locale.LC_ALL, 'de_DE.utf8') 
```

或者

```
heroku config:add LANG=de_DE.utf8 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-09T01:09:49.440

默认情况下，Heroku 环境中仅安装英语语言环境。到目前为止，似乎没有办法安装额外的语言环境。您最好的选择是为您支持的语言实现自己的格式化功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-16T11:38:37.770

这是一个较老的问题，但我认为值得一提的是[Heroku 在 2018 年 9 月添加了对安装其他语言环境的支持](https://devcenter.heroku.com/articles/upgrading-to-the-latest-stack#locales)。

为此，请提交一个`.locales`包含您要设置的语言环境的文件：

```
de_DE
fr_FR 
```

然后添加语言环境构建包：

```
heroku buildpacks:add https://github.com/heroku/heroku-buildpack-locale 
```

有关更多信息，请查看[buildpack 的 GitHub 存储库](https://github.com/heroku/heroku-buildpack-locale)。

# c# - 使用 LINQ 查询从表中删除多行

> ID：11486134
> 
> 赞同：1
> 
> 时间：2012-07-14T18:06:08.200
> 
> 标签：c#, linq, entity-framework

> **可能重复：**
> [EF 代码首先从 IQueryable<T> 中删除批次？](https://stackoverflow.com/questions/8538899/ef-code-first-delete-batch-from-iqueryablet)

如何使用 LINQ 查询从表中删除多行。

我有如下代码：

```
var subjects = (from sub in db.Subjects select sub)
               .Where(sub => sub.title.StartsWith("ab")); 
```

我想用一个命令从我的表中删除所有这些主题，比如在 sql 中：

```
"Delete FROM table WHERE ..." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:09:29.140

为此，您需要一个一个`loop`删除所有实体，不幸的是，在 Linq to SQL 或实体框架中都没有批量删除这样的功能。

```
foreach(var subject in subjects)
{
    db.Subjects.Remove(subject);
}
db.SubmitChanges(); 
```

# fuelphp - Fuelphp 的炼油迁移命令失败

> ID：11486138
> 
> 赞同：0
> 
> 时间：2012-07-14T18:06:29.410
> 
> 标签：fuelphp

全新安装 Fuel 后，我在应用程序配置文件中设置了数据库配置，但是在运行 oil refine migrate 之后，我得到了

```
fuelphp oil refine migrate Error - invalid data source name in COREPATH/classes/database/pdo/connection.php on line 87 
```

这个问题刚刚开始发生，我不知道出了什么问题。这不是配置文件中的设置....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T07:37:27.773

我也遇到了这个问题，但我发现它是由 php-cli.ini 中缺少 PDO 扩展引起的，我使用的是 UniformServer，在我将它添加到它的配置中之后它起作用了。你应该检查你是否有 php cli 的配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T15:06:48.540

当无法建立连接时会发生此错误。在某些情况下，您需要将主机设置为`127.0.0.1`，这完全取决于您的开发设置。
如果您正在运行 MAMP，您还可以为 MySQL 套接字设置别名，如下所示：

```
$ sudo ln -s /Applications/MAMP/tmp/mysql/mysql.sock /var/mysql/mysql.sock 
```

正如故障排除部分所述，有时您需要先创建 MySQL 目录：

```
$ sudo mkdir /var/mysql
$ sudo ln -s /Applications/MAMP/tmp/mysql/mysql.sock /var/mysql/mysql.sock 
```

# javascript - Chrome 中的 YUI 富文本编辑器和同源策略

> ID：11486139
> 
> 赞同：0
> 
> 时间：2012-07-14T18:06:32.537
> 
> 标签：javascript, html, google-chrome

我正在尝试使用 YUI 3 富文本编辑器，遇到了一个我不明白的事件：

当我在可编辑区域内注入来自不同来源的 iframe 时，该 iframe 的内容可以像任何其他内容一样进行编辑。我可以将光标放入 iframe 区域，例如删除字符。

这仅在 Chrome 中发生，使用 Firefox 无法编辑 iframe。尽管内部 iframe 的 DOM 与 YUI 文本编辑器的页面来源不同，但它怎么可能被操纵？

这是示例编码：

```
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="http://yui.yahooapis.com/3.5.1/build/yui/yui-min.js"></script>
    <script>
     YUI().use('editor-base', function(Y) {
       var editor = new Y.EditorBase({content: '<strong>This is <em>a test</em></strong><strong>This is <em>a test</em></strong> '});
       //Add the BiDi plugin
       editor.plug(Y.Plugin.EditorBidi);
       //Focusing the Editor when the frame is ready..
       editor.on('frame:ready', function() {this.focus();});
       //Rendering the Editor.
       editor.render('#editor');
     });
    </script>
    <script>
     function inject() {
       var ifr = $('<iframe/>', {
         style: 'display: block; width: 300px; heigth: 200px;',
         src: 'http://demo.yarkon.de',
         frameBorder: 0, 
         scrolling: 'no'
       });
       $('#editor').find('iframe').contents().find('body').append(ifr);
     }
    </script>
    </head>
  <body>
    <button onclick='inject()'>Inject</button>
    <div id="editor"></div>
  </body>
</html> 
```

Google Chrome 20：iframe 是可编辑的

Firefox 13：iframe 不可编辑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T08:40:53.533

YUI 富文本编辑器为可编辑区域创建一个 iframe，并将文档的**designMode设置为****on**。这意味着这个 iframe 及其所有后代都处于可编辑模式。如果您将另一个 iframe 注入到可编辑区域，它将继承此属性并且也是可编辑的，与其来源无关。

因此，YUI 文本编辑器以某种方式操纵注入 iframe 的 DOM 的假设是不正确的：不涉及 JavaScript，它纯粹是与任何其他可编辑字段（如 textarea 或具有 contenteditable 属性的元素）上的用户交互。

# javascript - 在 js 文件中包含 jquery

> ID：11486141
> 
> 赞同：0
> 
> 时间：2012-07-14T18:06:40.700
> 
> 标签：javascript, jquery, ajax, google-chrome, include

我正在开发 chrome 扩展，它是一个简单的扩展，它调用 background.js 文件来完成简单的工作。在 background.js 我想包含 jquery.js 文件来调用 ajax 函数。但我无论如何都找不到在 background.js 中包含 jquery.js。可以这样做吗？

你知道，扩展调用 background.js，它不调用包含 background.js 的 php 或 html 文件，所以我不能使用任何涉及 php 或 html 的东西

提前致谢....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:14:18.403

听起来您使用的是 manifest_version 2，这意味着您只需添加`path-to-jquery.js`到 background.scripts 数组即可。

```
"background": {
    "scripts": ["jquery.js", "background.js"]
} 
```

这些文件都一起加载到生成的页面中，因此它们访问相同的全局范围——这意味着您可以`jQuery`照常使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:20:21.153

给你：

```
var jQueryElement=document.createElement('script');
jQueryElement.type = 'text/javascript';
jQueryElement.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js';
document.getElementsByTagName('head')[0].appendChild(jQueryElement); 
```

您必须将所有内容放在 onload 事件处理程序中，否则即使 jQuery 尚未加载，其余的 JavaScript 仍将继续运行。

```
var jQueryElement=document.createElement('script');
jQueryElement.type = 'text/javascript';
jQueryElement.onload = function () {
    alert('jQuery loaded');
};
jQueryElement.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js';
document.getElementsByTagName('head')[0].appendChild(jQueryElement); 
```

# jquery - 创建全局函数

> ID：11486142
> 
> 赞同：0
> 
> 时间：2012-07-14T18:06:46.537
> 
> 标签：jquery, global-variables, infinite-scroll

我正在使用一些 jQuery 和无限滚动，并且通过无限滚动引入的一些新内容使用一些简单的 jQuery 来实现一些悬停效果等。

```
$(".grid-landing-page a").hover(function () {
$(this).children('.preview-project-title').toggleClass("preview-project-title-on");
}); 
```

我需要将此添加到无限滚动的回调中，就像我已经完成了我正在使用的砌体一样：

```
function( newElements ) {
    var $newElems = $( newElements );
    $('.grid-landing-page-container').masonry( 'appended', $newElems );
} 
```

我很想知道将我的 toggleClass 代码变成一个全局变量是否是个好主意，这样我就可以在无限滚动 newElements 中调用它。如果是这样，对我如何做到这一点有任何帮助吗？或者，如果有更好的方法来做到这一点，任何帮助将不胜感激。

谢谢，R

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:15:42.073

尽可能避免使用全局变量。在您的情况下，事件委托是一个更好的选择。如果您对此不熟悉，那么这个想法是这样的：

不要将事件从字面上绑定到您感兴趣的元素，而是将一个事件绑定到一个相互容器，然后检查哪个元素实际触发了它。在涉及许多元素的情况下，这具有明显的性能优势。

```
$("body").on('hover', '.grid-landing-page a', function () {
    $(this).children('.preview-project-title').toggleClass("preview-project-title-on");
}); 
```

您可能更愿意将我对容器（主体）的选择更改为更具体的内容。

幕后发生的事情从技术上讲，每次鼠标悬停在身体​​上时都会触发该事件 - 但在该事件被认为已被元素匹配启动之前`.grid-langing-page a`，jQuery不会触发其回调代码。

**因为这个上下文检查是在事件触发点完成的，而不是在事件绑定点（您的原始代码），所以它适用于当前和未来的匹配元素。无需重新绑定。**

# c# - 设置最后访问时间

> ID：11486143
> 
> 赞同：1
> 
> 时间：2012-07-14T18:06:56.163
> 
> 标签：c#, permissions, filesystems

我正在尝试记录 PC 中安装的所有应用程序的最后访问时间，我有下一个代码：

```
System.IO.File.SetLastAccessTime(appList[offSet], DateTime.Now); 
```

我知道我需要授予执行此操作的权限，我已经尝试使用下一行的清单文件：

```
<requestedExecutionLevel  level="requireAdministrator" uiAccess="false" /> 
```

但是当我运行我的程序时，会出现下一个错误：

> 错误 ClickOnce 不支持请求执行级别 'requireAdministrator'

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:12:21.773

运行此应用程序的帐户是需要权限的帐户。

仅当帐户具有所需权限时，设置`requestedExecutionLevel`才会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:51:53.413

尝试转到 Visual Studio 中的项目属性，在安全选项卡中**取消选中**“启用 ClickOnce 安全设置”。我认为它会解决你的问题。

# c# - 带功能区的 wpf 富文本框的 Alt + 数字（ASCII 代码）输入

> ID：11486144
> 
> 赞同：1
> 
> 时间：2012-07-14T18:07:02.383
> 
> 标签：c#, wpf, input, keyboard, ribbon

我目前正在开发一个包含两个组件的项目。功能区和 RichTextBox (System.Windows.Controls.RichTextBox)。

我面临一个问题，即 ASCII 代码（例如 alt+123 是 '{'）输入没有得到反映，因为按下 Alt 会触发键提示命令。特别是使用 Ribbon，有一个由 Alt + 数字触发的快速访问工具栏。

有什么建议可以解决这个问题吗？或者我应该放弃 Richtextbox 的 ASCII 码输入吗？

非常感谢您提前。

编辑：这是我正在采取的方法

```
 protected override void OnKeyDown(KeyEventArgs e)
    {
        if (e.Key == Key.NumPad0 ||
            e.Key == Key.NumPad1 ||
            e.Key == Key.NumPad2 ||
            e.Key == Key.NumPad3 ||
            e.Key == Key.NumPad4 ||
            e.Key == Key.NumPad5 ||
            e.Key == Key.NumPad6 ||
            e.Key == Key.NumPad7 ||
            e.Key == Key.NumPad8 ||
            e.Key == Key.NumPad9)
        {
            if (Keyboard.IsKeyDown(Key.LeftAlt) || Keyboard.IsKeyDown(Key.RightAlt))
                return;
            if (Keyboard.IsKeyDown(Key.LeftCtrl) || Keyboard.IsKeyDown(Key.RightCtrl))
                return;
        }

        base.OnKeyDown(e);
    } 
```

Ctrl 部分会在调试时命中，但 Alt 部分不会命中。它工作了几次，让我兴奋。但是，只有当我破坏代码并即时修改并运行它时，它才有效。如果我重新编译所有内容并运行程序，它就会回到根本不点击代码的原始状态（弹出键提示）。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:25:08.750

我认为您最好的选择是覆盖**KeyDown**事件。当您评估**e.Key**时，请确保在您的 IF 语句中额外评估以下内容：

```
Keyboard.IsKeyDown(Key.LeftAlt) 
```

**Keyboard.IsKeyDown**提供了一种查看当前击键涉及哪些修饰符的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T09:11:49.333

这似乎适用于我刚刚拼凑起来尝试的应用程序：

```
 protected override void OnKeyDown(KeyEventArgs e)
    {
        if (e.Key == Key.NumPad0 ||
            e.Key == Key.NumPad1 ||
            e.Key == Key.NumPad2 ||
            e.Key == Key.NumPad3 ||
            e.Key == Key.NumPad4 ||
            e.Key == Key.NumPad5 ||
            e.Key == Key.NumPad6 ||
            e.Key == Key.NumPad7 ||
            e.Key == Key.NumPad8 ||
            e.Key == Key.NumPad9)
            {
                if (Keyboard.IsKeyDown(Key.LeftAlt) || Keyboard.IsKeyDown(Key.RightAlt))
                {
                    e.Handled = true;
                    return;
                }
            }

        base.OnKeyDown(e);
    } 
```

如果您仍在苦苦挣扎，我们可能需要查看更多代码 - 如果您可以使用相同的原理创建一个简单的应用程序并为我们提供 XAML 代码，它会有所帮助。

# python - python中未使用的变量命名

> ID：11486148
> 
> 赞同：38
> 
> 时间：2012-07-14T18:07:34.443
> 
> 标签：python, variables

> **可能重复：**
> [我怎样才能绕过在 for 循环中声明未使用的变量？](https://stackoverflow.com/questions/5477134/how-can-i-get-around-declaring-an-unused-variable-in-a-for-loop)

在 Python 中，命名不会使用的变量的最佳做法是什么？这肯定是一个奇怪的问题，但对于我的具体情况，我有一个 (key, value) 的元组，我只对值感兴趣。我的用例的基本演示：

```
some_stuff = [("key", "value"), ("key2", "value")]
for _, value in some_stuff:
    pass  # TODO: do something really important with value 
```

我在 Eclipse 中注意到，命名变量 _ 或带有 _ 前缀（例如 _k）不会显示未使用的变量警告，删除 _ 前缀会导致引发警告，但这可能只是一个奇怪/“功能”在 Eclipse 而不是 Python 最佳实践中..

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-14T18:12:22.900

不确定这是否是 Eclipse 的东西，但我通常`'_'`用来表示我不关心的值（即，元组中的返回值，或循环中的索引值`for`）。

当然，您始终可以使用旧的备用方法，例如命名变量`dummy`或`ignore`.

我不确定[PEP 8](http://www.python.org/dev/peps/pep-0008/)是否对此有任何提及，可能值得一看。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-14T18:21:02.590

这是一个 Python 编码约定，是的。最佳实践是`_`在您不关心设置的值的地方使用，例如[从 tuple 解包值](https://www.python.org/dev/peps/pep-3132/)时。然而，有时，需要这表明您可能正在以非 Python 的方式做其他事情。

`_`作为前缀用于表示“私有”方法和变量，就像 Phil Cooper 所说的那样。使用它来表示这些方法不是其他模块可以或应该依赖的任何公共合同的一部分。

一些参考资料：

*   [Python中单个下划线“_”变量的目的是什么？](https://stackoverflow.com/questions/5893163/underscore-in-python)
*   [下划线作为函数前缀](https://docs.python.org/3/reference/lexical_analysis.html#reserved-classes-of-identifiers)
*   [对象名称前的单下划线和双下划线是什么意思？](https://stackoverflow.com/questions/1301346/the-meaning-of-a-single-and-a-double-underscore-before-an-object-name-in-python)
*   [为什么 python 在某些事情上使用两个下划线？](https://stackoverflow.com/questions/3443043/why-does-python-use-two-underscores-for-certain-things)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-14T18:39:16.863

让我们从...

```
>>> import this
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
...
Readability counts.
Special cases aren't special enough to break the rules. 
```

我建议选择没有问题的方法。它通常意味着一些不言自明、简单易懂的东西。如果你坚持表达*不使用*，那么名称`unused`或`dummy`？

如果可能的话，是否应该`_`更*隐蔽*、隐藏甚至是被忽视的候选者？

对于 Perl 用户，这意味着*未使用*`_`的其他东西。即使您可能不关心 Perl 用户，如果您以前从未遇到过 Perl 用户，这对您意味着什么？*`_`*

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-14T18:12:36.487

你几乎得到了它`_1`：

*   一个前导下划线表示，是的，它存在，您可以查看它，但是您应该使用另一种方法或属性；查阅文档。
*   两个前导下划线表示，危险！请勿触摸，否则会严重破坏事物的状态和稳定性。请远离；如果你搞砸了，如果出了问题，那都是你自己的错。

*注意：* Using`__`不仅仅是一个命名约定，因为它会导致[name mangling](http://python.robasworld.com/private-member-name-mangling/)。这会将变量重命名为`_ClassName__var`. 这使得变量/方法更难在课堂之外使用。这样做主要是为了避免继承类意外覆盖父类中的方法。*

# javascript - 如何创建一个小的 Javascript 扩展语言？

> ID：11486152
> 
> 赞同：8
> 
> 时间：2012-07-14T18:08:07.203
> 
> 标签：javascript, coffeescript, namespaces, closures

我最近重构了我的 JS 代码并偶然发现了这种模式：

```
APP = (function() {
  var x,y,z;
  function foo() {}
  function bar() {}
  return {x:x, y:y, z:z, foo:foo: bar:bar};
})(); 
```

这样做的好处是它创建了非全局变量，函数可以访问`APP`. 所以无需输入,等就`APP.foo`可以访问`x, y, z`, 和 bar 。也可以使用,等全局访问所有内容。您还可以嵌套它们：`APP.bar()``APP.x``APP.bar()``APP.x`

```
APP = (function() {
  var x,y,z;
  function foo() {}
  function bar() {}

  var WIDGETS = (function() {
    var a,b,c;
    function hello() {}
    function world() {}
    return {a:a, b:b, c:c, hello:hello, world:world};
  })();

  return {x:x, y:y, z:z, foo:foo: bar:bar, WIDGETS:WIDGETS};
})(); 
```

因此`WIDGETS`可以访问 中的变量`APP`，但反之亦然（`APP.WIDGETS.hello`可以使用`foo()`，但`APP.foo`必须使用`WIDGETS.hello()`）。

我尝试使用 ERB（我在 Rails 上）创建这种模式，但结果很混乱。所以我正在考虑为此编写一个小的源到源编译器——比如 CoffeeScript（具有 SASS 的最小差异/扩展语言哲学），它只是将一些函数编译为替代 javascript。

我只是想要一个速记。

例如，这将编译为我上面的第二个代码块：

```
//NAMESPACE is a magical function I compile down to the long version in the second code block
APP = NAMESPACE(function() {
  var x,y,z;
  function foo() {}
  function bar() {}

  var WIDGETS = NAMESPACE(function() {
    var a,b,c;
    function hello() {}
    function world() {}
    //**notice the missing return statement that I don't need to manage and map to my variables**
  });
  //**notice the missing return statement that I don't need to manage and map to my variables**
}); 
```

简单而小巧——这样您就不需要跟踪变量了。也想像这样分离命名空间（所以我可以将它拆分为多个文件）：

```
APP = NAMESPACE(function() {
  var x,y,z;
  function foo() {}
  function bar() {}
  //**notice the missing return statement that I don't need to manage and map to my variables**
});
APP = NAMESPACE(function() {
  var WIDGETS = NAMESPACE(function() {
    var a,b,c;
    function hello() {}
    function world() {}
    //**notice the missing return statement that I don't need to manage and map to my variables**
  });
}); 
```

关于如何做到这一点的任何想法？我不确定一切，但我认为如果存在的话，我会更喜欢 Javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T23:45:27.457

您可能想要查看的内容：

*   水仙：[https ://github.com/mozilla/narcissus/](https://github.com/mozilla/narcissus/)
*   Traceur：[http ://code.google.com/p/traceur-compiler/](http://code.google.com/p/traceur-compiler/)
*   Reflect.js：[https ://github.com/zaach/reflect.js](https://github.com/zaach/reflect.js)
*   [http://www.mascaraengine.com/doc/languagewalk](http://www.mascaraengine.com/doc/languagewalk)
*   [https://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-c​​ompile-to-JS](https://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-compile-to-JS)

还有一个关于 EcmaScript 6 中的模块系统的提案，将来可能会可用：[http ://wiki.ecmascript.org/doku.php?id=harmony:modules](http://wiki.ecmascript.org/doku.php?id=harmony:modules)

现在，如果目标只是打字`foo()`而不是`APP.foo()`那么我认为创建 javascript 的语言超集有点牵强...

如果您使用 CoffeeScript 导出变量，则不那么冗长：

```
APP = do ->
  [x,y,z] = []
  foo = ->
  bar = ->

  WIDGETS = do ->
    [a,b,c] = []
    hello = ->
    world = ->
    { a, b, c, hello, world }

  { x, y, z, foo, bar, WIDGETS } 
```

实际上，您很少导出每个变量，实际上您中的一些变量是“私有的”。您还可以在对象本身内部定义函数：

```
APP = (function() {
  var x,y,z;

  var WIDGETS = (function() {
    var a,b,c;
    return {
      hello: function hello(){},
      world: function world(){}
    }

  })();

  return {
    foo: function foo(){},
    bar: function bar(){},
    widgets: WIDGETS
  }

})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:53:38.920

您所描述的是通常称为“模块模式”的内容。这很好，因为您可以定义“隐藏”且无法访问的内部方法和变量。它也不会污染全局命名空间。您可以[在此处](http://www.yuiblog.com/blog/2007/06/12/module-pattern/)阅读更多相关信息（我相信这是有关该技术的第一篇文章。）也可以[在此处](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth/)和[此处](http://www.klauskomenda.com/code/javascript-programming-patterns/#oldschool)。

但是，由于您将所有内容都“公开”，因此它没有那么有用。你可以这样做（包括测试代码）：

```
APP = function (me) {
      me.x = 0;
      me.y = 0;
      me.z = 0;
      me.foo = function () { alert(me.x); },
      me.bar = function () {};

      WIDGETS = function (me2) {
        me2.a = 0;
        me2.b = 0;
        me2.c = 0;
        me2.hello = function () {};
        me2.world = function () {};
        return me2;
      }({});

      return me;
   }({});

APP.x = 1;
APP.foo(); 
```

你可以用更少的语法得到同样的效果。

[http://jsfiddle.net/ZwCUh/](http://jsfiddle.net/ZwCUh/)

* * *

作为旁注，有一些方法可以在没有编译器的情况下编写代码，这些方法可以让您通过原型接近您正在寻找的内容。一个很好的例子是 jQueryUI 的源代码。我确信其他库（原型、moo 工具等）也可以用作示例。

# jquery - 如何使用 bootstrap-modal.js 提交带有 ajax 加载的表单 html 的 ajax 表单

> ID：11486154
> 
> 赞同：0
> 
> 时间：2012-07-14T18:08:44.617
> 
> 标签：jquery, twitter-bootstrap

首先，我定制了 bootstrap-modal.js 以加载远程 php 表单。这是自定义（感谢drawjoh，[https](https://gist.github.com/1688900) ://gist.github.com/1688900 ）：

```
 /*    
  $(function () {    
    $('body').on('click.modal.data-api', '[data-toggle="modal"]', function ( e ) {    
      var $this = $(this), href    
        , $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '')) //strip for ie7    
        , option = $target.data('modal') ? 'toggle' : $.extend({}, $target.data(), $this.data())    

      e.preventDefault()    
      $target.modal(option)    
    })    
  })    
  */    

  $(function () {    
      $('[data-toggle="modal"]').click(function(e) {    
        e.preventDefault();    
        var href = $(this).attr('href');    
        if (href.indexOf('#') == 0) {    
            $(href).modal('open');    
        } else {    
            $.get(href, function(data) {    
                $(data).modal();    
            }).success(function() { $('input:text:visible:first').focus(); });    
        }    
      });    
  }) 
```

该模式使用 form#email-entry-form 加载 email_ent.php：

```
<div class="modal fade in" id="contact-container">
    <form action="#" id="email-entry-form" style="margin:0">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">×</button>
          <h3 id="contact-title">Email Entry #{$entry_id}</h3>
        </div>
        <div class="modal-body">
            <textarea class="full focused" id="contact-email" name="email" tabindex="1003" max-length="199" rows="3"></textarea>
            <p class="help-block">Use commas to separate email addresses...</p>
            <input type="hidden" name="form_id" value="{$form_id}" id="form_id" />
            <input type="hidden" name="entry_id" value="{$entry_id}" id="entry_id" />
        </div>
        <div class="modal-footer">
            <button type="reset" data-dismiss="modal" class="btn">Cancel</button>
            <a id="contact-send" class="btn btn-primary" tabindex="1004" href="#">Send</a>
        </div>
    </form>
</div> 
```

这是我使用的 jQuery 函数，但无法得到任何响应。

```
(function($){

    $('#contact-send').click(function (e) {
        e.preventDefault();
        // validate form actions cleaned for clearity.
        $.ajax({
            url: 'email_ent.php',
            data: $('#email-entry-form').serialize() + '&action=send',
            type: 'post',
            cache: false,
            dataType: 'html',
            complete: function (xhr) {
                /*
                more code here...
                */
                alert('OK!');
            },
            error: contact.error
        });
    });

})(jQuery); 
```

jquery.js 和这个函数是从触发模式窗口的 view_ent.php 加载的，但是点击函数不起作用。我认为它无法到达模态窗口中的元素，然后用ajax加载......

我试图在这个点击函数中提醒输入的值并得到未定义的响应。我不想放弃并为 view_ent.php 中具有预定义表单值的每个模式窗口加载隐藏表单。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:57:40.973

如果我理解正确，您在加载表单之前绑定到“#contact-send”的点击事件。'contact-send' 元素不存在，因此没有任何约束。

尝试在加载表单后连接单击，例如在成功函数中输入焦点。

```
$.get(href, function(data) {    
    $(data).modal();    
}).success(function() { 
    $('input:text:visible:first').focus(); 
    $('#contact-send').click(function (e) {...});
}); 
```

虽然不是通用目的，但我希望这能传达这个想法。

此外，看起来模态插件有一个显示事件。在向用户显示表单后，您可以使用它来连接您的点击。

[http://twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

# python - 多处理环境中的python subprocess qsub命令

> ID：11486156
> 
> 赞同：2
> 
> 时间：2012-07-14T18:09:01.307
> 
> 标签：python, subprocess, multiprocessing, qsub

我有一个需要通过 lsf 场（使用`"qsub -I"`）运行的命令列表。假设命令列在 commands_l 中。我正在使用多处理模块尝试一次运行 2 个进程。（我使用的是linux）

这是代码：

```
import subprocess, multiprocessing
import os,sys,os.path

def execCmd(cmd):
  """ Executes the command """
  print "Executing:",cmd
  ret = subprocess.call(cmd,shell=True)
  return ret

if __name__=="__main__":
  commands_l = ['qsub -P test -I ls -l', 'qsub -P test -I df -kh', 'qsub -P test -I du -kh .']

  results_l = []
  errorcodes_l = []
  max_proc = 2
  pool = multiprocessing.Pool(processes=max_proc)
  for command in commands_l:
    print "# %s" % (command)
    errorcode = pool.apply_async(execCmd, (command,), callback=results_l.append)
    errorcodes_l.append(errorcode)
  pool.close()
  pool.join()
  print "Results:", results_l
  sys.exit(0) 
```

我面临的问题是执行被输出卡住了：

```
# qsub -P test -I ls -l
# qsub -P test -I df -kh
# qsub -P test -I du -kh .
Executing: qsub -P test -I ls -l
Executing: qsub -P test -I df -kh
Job <1683534> is submitted to queue <q_interactive>.
<<Waiting for dispatch ...>>
Job <1683535> is submitted to queue <q_interactive>.
<<Waiting for dispatch ...>>
<<Starting on machine-23>>
<<Starting on machine-20>> 
```

奇怪的是，当我使用相同的命令“qsub -P test -I ls -l”单独运行 execCmd 时，它工作正常。

```
>>> import multiprocess_qsub # my py file that contains the abovementioned code
>>> multiprocess_qsub.execCmd("qsub -P test -I ls -l")
Executing: qsub -P test -I ls -l
Job <1687635> is submitted to queue <q_interactive>.
<<Waiting for dispatch ...>>
<<Starting on machine-02>>
total 3
-rwx------  1 tully user 2959 Jul  5 14:54 functions.py
-rwx------  1 tully user 906  Jun 27 23:06 gui.py
-rw-------  1 tully user 1684 Jul 13 14:24 multiprocess_qsub.py 
```

在我看来，qsub 在多处理环境中运行时存在一些问题。我错过了什么吗？谢谢。

# iphone - iPhone 解析 XML 附件

> ID：11486164
> 
> 赞同：1
> 
> 时间：2012-07-14T18:10:23.137
> 
> 标签：iphone, xml, xcode, nsstring, xml-parsing

我正在使用附件标签解析 xml。我怎样才能做到这一点？我可以轻松地获取链接、guid、标题和 pubDate 标记并将它们解析为 NSString，但如果我尝试从附件标记创建字符串，它会返回 null。

我只需要在播客剧集的这一部分中找到的 URL：

```
<enclosure url="http://treymorgan.podbean.com/mf/feed/bf8mvq/Accommoditions.mp3" length="29865594" type="audio/mpeg"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:02:18.917

如果您使用的是 NSXMLParser，您可以像这样读取 url 属性（假设您有一个名为 podcastURL 的属性来存储解析后的 URL）：

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict {
   if ([elementName isEqualToString:@"enclosure"]) {
      self.podcastURL = [attributeDict objectForKey:@"url"];
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T20:38:11.253

这是对上述问题的直接答案。我遇到了同样的事情。得益于此[ATOM 数据解析与 GData 帖子的排序](https://stackoverflow.com/a/5292033/306212)

```
- (void)parseRss:(GDataXMLElement *)rootElement entries:(NSMutableArray *)entries
{

    NSArray *channels = [rootElement elementsForName:@"channel"];
    for (GDataXMLElement *channel in channels) {

        NSString *blogTitle = [channel valueForChild:@"title"];

        NSArray *items = [channel elementsForName:@"item"];
        for (GDataXMLElement *item in items) {
            NSString *podcastEnclosureUrl =  nil;

            NSString *articleTitle = [item valueForChild:@"title"];

            NSArray *enclosureArray = [item elementsForName:@"enclosure"]; //this is the code for what I needed
            for (GDataXMLElement *content in enclosureArray)
            {
                NSString *podcastEnclosureUrl = [[content attributeForName:@"url"] stringValue];
                NSLog(@"URL: %@", podcastEnclosureUrl);
            }
            NSString *articleDateString = [item valueForChild:@"pubDate"];
            NSDate *articleDate = [NSDate dateFromInternetDateTimeString:articleDateString formatHint:DateFormatHintRFC822];

            RSSPodcastFeed *entry = [[RSSPodcastFeed alloc] initWithBlogTitle:blogTitle
                                                     articleTitle:articleTitle
                                                       podcastEnclosureUrl:podcastEnclosureUrl
                                                      articleDate:articleDate];
            [entries addObject:entry];

        }
    }

} 
```

# javascript - 预加载 CSS 背景图像 [不能使用精灵]

> ID：11486172
> 
> 赞同：0
> 
> 时间：2012-07-14T18:11:52.073
> 
> 标签：javascript, css, background-image, preloader

我有这个网站，用户通过更改很多 div 的背景图像来生成预览。问题是我第一次将背景图像更改为其他内容时，图像加载需要一点时间，但在那之后，如果我改回来，一切看起来都很顺利。

我打算使用 CSS sprites 来解决这个问题，但是当我尝试它时，一些浏览器几乎冻结了，因为它们无法处理那么大的图像。

所以我的问题是，如何在不使用 CSS 精灵的情况下预加载这些特定的背景图像？

**编辑：**

如果我不清楚，我很抱歉。我正在创建的是一个角色创建屏幕。我想要做的是，当页面加载时，用户可以选择他们想要参加的比赛。当他们这样做时，我希望显示一个加载程序，并且我希望预加载与该比赛相关的所有图像。完成后，我想删除加载器，然后用户可以进一步自定义他们的角色。

当用户自定义他们的角色时，角色 div 上的背景图像会更改为预加载的图像之一。我尝试使用下面描述的**Rustam**方法使用 JavaScript 加载图像，但我得到了相同的结果。第一次显示背景图像时，加载需要一秒钟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:16:17.863

使用 js 页面加载后缓存它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:16:44.510

请参阅此处：[仅 CSS 图像预](http://css-tricks.com/snippets/css/css-only-image-preloading/)加载 - 关键是将所有需要的图像作为背景加载到其他 div 中，但 div 被“隐藏”在页面之外。

> 将图像加载到元素的常规状态，仅将其与背景位置移开。然后移动背景位置以在悬停时显示它。

```
#img1 { background: url(images/img1.png) no-repeat -9999px -9999px; }
#img2 { background: url(images/img2.png) no-repeat -9999px -9999px; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:15:03.617

如果您想在没有 javascript 的情况下执行此操作 - 放入 html invisible 的唯一方法`<img>`。像这样：

`<div style="overflow:hidden;height:0;"><img/><img/><img/><img/></div>`

但是 div 不能被**隐藏**，`display:none`因为`visibility:hidden`在这种情况下某些浏览器无法加载它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:24:01.657

预加载图像的 Javascript 方式：

```
var img = document.createElement("img");
img.setAttribute('src', 'image_path');

// Load event
img.onload=function(){ alert("It's loaded!") }; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-14T18:33:21.533

我会为此使用 Web Worker，并在单独的线程中在后台预加载所有图像。使用它您不会阻塞浏览器 UI，并且当工作人员完成后，您可以使用图像。

看看这里[http://www.html5rocks.com/en/tutorials/workers/basics/](http://www.html5rocks.com/en/tutorials/workers/basics/)

# android - Android - dispatchTouchEvent 给了我一个 StackOverflowError

> ID：11486178
> 
> 赞同：2
> 
> 时间：2012-07-14T18:12:47.150
> 
> 标签：android

在这里，我有一个带有 setOnTouchListener 的 ViewFlipper 可以正常工作。然后我为 ReLayNewsItem 充气，然后将其添加到 ViewFlipper。

现在我希望 WebView (web) 监听触摸事件并将它们传递给 ViewFlipper。

```
 final ViewFlipper VFnewsFeed = new ViewFlipper(this);

    VFnewsFeed.setOnTouchListener(new OnTouchListener(){
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if (gestureDetectorLR.onTouchEvent(event)) { return true; }
            else { return true; }
        }});

    ///////////////////

    LayoutInflater inflater = (LayoutInflater)this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    RelativeLayout ReLayNewsItem = (RelativeLayout) inflater.inflate(R.layout.newsitem, null); 

    final WebView web = (WebView)ReLayNewsItem.findViewById(R.id.NewsItemWv);

    web.setOnTouchListener(new OnTouchListener(){
        @Override
        public boolean onTouch(View v, MotionEvent event) {

            VFnewsFeed.dispatchTouchEvent(event); /// ERROR HERE!
            return false;
        }}); 
```

然而它给了我这个——

```
07-14 21:12:43.600: E/AndroidRuntime(14048): FATAL EXCEPTION: main
07-14 21:12:43.600: E/AndroidRuntime(14048): java.lang.StackOverflowError
07-14 21:12:43.600: E/AndroidRuntime(14048):    at life.iface.main$11.onTouch(main.java:1289)
07-14 21:12:43.600: E/AndroidRuntime(14048):    at android.view.View.dispatchTouchEvent(View.java:4605)
07-14 21:12:43.600: E/AndroidRuntime(14048):    at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1518)
07-14 21:12:43.600: E/AndroidRuntime(14048):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1320)
... 
```

有任何想法吗？谢谢！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:40:41.497

如果您返回`false`，则表示该事件**未处理**。

根据您的需要，尝试 return`true`或`VFnewsFeed.dispatchTouchEvent(event)`in`onTouch`方法而不是`false`.

[参考文档](http://developer.android.com/reference/android/view/View.OnTouchListener.html#onTouch%28android.view.View,%20android.view.MotionEvent%29)

# mysql - 为什么 mysql_config 添加 -fPIC？

> ID：11486183
> 
> 赞同：1
> 
> 时间：2012-07-14T18:13:06.467
> 
> 标签：mysql, c, gcc, compiler-flags

当我运行`mysql_config --cflags`时，输出是：

```
-I/usr/include/mysql  -DBIG_JOINS=1 -fPIC -fno-strict-aliasing 
```

我知道 -fPIC 做了什么，但我不明白为什么 mysql_config 输出这个标志，因为它可能是一个静态库或可执行文件，并且任何构建动态库的人很可能已经有了这个标志。我的想法是它要么是一个错误，要么是 libmysql 正在做一些非常奇怪的事情来要求它。

在可执行文件中是否需要 -fPIC 或者它只是一个错误？

# java - 将永远变化的随机生成的整数转换为字符串

> ID：11486185
> 
> 赞同：1
> 
> 时间：2012-07-14T18:13:15.557
> 
> 标签：java

[解决了]

我搜索了许多论坛以及 Stack Overflow 的关于将不断变化的随机数转换为字符串的问题，但我找不到针对我的具体问题的解决方案。

如何将 customerID 转换为字符串？

```
 public class UniqueCustomerNumber {

    private int customerID;

    public void setCustNum(int cNumber) {
        Random x = new Random();
        cNumber = x.nextInt(800000001) + 100000000;
        customerID = cNumber;
    }

    public int getCustNum() {
        return customerID;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:17:58.087

使用`Integer.toString(int i)`它是类中的一种静态方法`Integer`，它将一个`int`作为参数并将其文本表示形式返回为`String`.

```
public class UniqueCustomerNumber {

    private String customerID;

    public void setCustNum() {
        Random x = new Random();
        this.customerID = Integer.toString(x.nextInt(800000001) + 100000000);
    }

    public String getCustNum() {
        return this.customerID;
    }
} 
```

* * *

代码：

公共类 UniqueCustomerNumberTest {

```
public static void main(String[] args) {
    UniqueCustomerNumber uin = new UniqueCustomerNumber();
    uin.setCustNum();
    System.out.println("Unique Customer Number = " + uin.getCustNum());
} 
```

输出：

```
Unique Customer Number = 748816502 
```

附注：使用此方法可能不符合您的类名，`UniqueCustomerNumber`. 我知道概率非常小，但是如果您以这种方式生成 2 个客户，则理论上可能会发生 2 个客户具有相同的 ID。一个更简单的方法是从某个数字（例如 1）开始为客户分配他们的 ID。

在每次分配时，您都会将计数器增加 1。缺点是您需要将该计数器保存在某个位置（DB、txt 文件、w/e）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:25:31.613

有两种方法可以做到...

**1.**将它连接到一个字符串（可以是一个空字符串）。

**例如：**

```
int i =  5;
String s = i + "" ;    // i is now converted to String. 
```

**2.**使用**toString() 方法**，但这**仅适用于 Object 类型**。所以首先你需要将原始类型 int 转换为 Wrapper 对象 Integer

**例如：**

```
 int i = 5;
   Integer o = new Integer(i);
   o.toString() ; 
```

# javascript - 使用 javascript setInvertal 会增加 CPU 的内存消耗

> ID：11486186
> 
> 赞同：5
> 
> 时间：2012-07-14T18:13:48.787
> 
> 标签：javascript, cpu, setinterval

我正在开发一个 .NET Web 应用程序，我必须使用 javascript 函数 setInterval() 执行 ajax 请求以刷新某些页面的信息。

对于每个 ajax 请求，我都会收到大约 68 KB 的 xml 响应，我设法通过 jQuery 在 html 中进行视觉更改。我将间隔设置为 2000 毫秒，但我想，或者更确切地说，我需要将它减少到 1000 毫秒。

不幸的是，每次请求都会增加 CPU 的内存消耗，这会导致浏览器被阻塞，除非重新加载页面，否则用户无法使用它。我在 Firefox、Internet Explorer 和 Chrome 中对此进行了测试，但结果始终相同。如果我不执行 setInvertal()，问题就会消失。

另外，我一直在测试所有 javascript 变量的范围，但没有发现任何错误，我认为 Javascript 有一个高效的垃圾收集器来清理它们。

我希望我已经解释清楚了这个问题。有人有解决它的想法吗？

**修改：**我正在使用 jQuery 框架。我的代码是：

```
var tim;
$(document).ready(function () {
  tim = window.setInterval("refresh()", 2000);
});

function refresh() {
   $.post("procedures.aspx", $("#formID").serializeArray(), function (data) {
     if (data != ""){
       var xml = $.parseXML(data);

       ... (read and process xml to do changes in the html)

     }
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T18:35:58.783

您尚未发布任何代码片段以供检查，因此我的回答是基于创建此类“轮询”函数时经常出现的错误。我还假设您是手动执行操作，而不使用 jQuery 或 MooTools 等框架。

您的问题很**可能是由在每个轮询调用中创建新的 XMLHttpRequest 对象引起的**，而不是在 setInterval 之外创建一个这样的实例，然后一次又一次地打开和使用。

基本上，您可能正在编写这样的代码：

```
var pollInterval = setInterval(function() {
    var xhr = new XMLHttpRequest(); //ouch, this hurts!
    xhr.open('GET', 'url', true);
    xhr.send();
    //etc.
}, 2000); 
```

如果是这种情况，只需将 XMLHttpRequestObject 的创建移出轮询循环，以确保您一次又一次地使用同一个对象，从而防止各种内存泄漏（如果我可以这样称呼它）。

```
var xhr = new XMLHttpRequest(); //now we can re-use this!
var pollInterval = setInterval(function() {
    xhr.open('GET', 'url', true);
    xhr.send();
    //etc.
}, 2000); 
```

同样，您还没有发布任何代码片段或您可能正在使用的任何框架的详细信息。所以我的建议是基于我在检查轮询 ajax 代码时经常遇到的错误。希望这可以帮助。如果没有，请编辑问题并发布一些代码。

**免责声明**：为了简洁起见，我只使用了 XMLHttpRequest 对象，而不是对供应商的仇恨（或爱）。您显然会使用跨浏览器请求对象实例化函数，或者更好的是抽象出这些血腥细节的库。

**更新**

* * *

那么，您的代码需要每两秒更新一次 dom 吗？只要页面被加载？从来没有停下来？我以为我会在某处看到 clearInterval ，但无论如何。

这有点尴尬。我最接近这种情况的是，当我需要基于股票代码 API 编写脉冲线来显示实时（好的，1 秒的伪实时）图形时。在我的例子中，好的部分是 API 非常快，延迟超低，我收到的数据只是一个浮点数，我用它做的 dom 操作的时空复杂度可以忽略不计。

我在这里担心的是，如果服务器在两秒内没有响应，或者如果它接近两秒，那么你有一段复杂的代码已经在这两秒间隔的重要毫秒内吃掉了。dom*可能不会*每两秒更新一次！

1.  卫生提示：去掉 `window.setInterval("refresh()", 2000)`. 应该只是 `window.setInterval(refresh, 2000)`原因在这里：[javascript setInterval 的内存泄漏](https://stackoverflow.com/questions/5621231/memory-leak-for-javascript-setinterval)

2.  因此，根据代码，$.post 肯定会每两秒创建一次新的 XHR 对象。实际上，服务器响应时间是什么样的？setInterval 循环多少次？对于低计数，例如响应时间低于 10 秒，新的 XHR 不应该是“THE”问题。

3.  500 行 XML 解析？每个间隔？对我来说听起来很痛苦。您是否可以在服务器上将 XML 标记为 JSON 字符串，并将该字符串返回给 UI？它肯定会节省客户端 CPU 周期。

11000 行的 HTML。所以这是很多 dom 遍历和操作。这是一个小清单：

1.  你在使用最好的选择器吗？（您的 xpath 表达式的特殊性）。Shizzle 已经为您提供了保障，但请尽您所能。$('p *') 之类的东西可能会造成严重破坏。

2.  您是否已最小化文档重排？

3.  循环：在数组上使用 for 或映射函数是最好的（最有效的）

4.  属性访问：您是否减少了重复的嵌套属性访问，并使用一次性引用来提高效率？

5.  附加/操作效率：例如：您是否附加单个列表项？理想情况下，您应该一次性追加整个列表块。删除等也是如此。基本上，一次性操作而不是重复操作。

如果不了解用例的底层意图和机制，很难确定这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T08:29:52.613

最后，我已经解决了这个问题。总体而言，主要修复是将响应服务器更改为 JSON。我已将响应减少到 4KB。

此外，我更准确地操作 html 元素并将其附加到 DOM。

现在，webapp 可以运行几个小时，一切正常。

# php - PHP 流 mp3 文件

> ID：11486191
> 
> 赞同：0
> 
> 时间：2012-07-14T18:14:18.350
> 
> 标签：php, stream, mp3, filestream

我需要允许用户只流式传输它而不下载该文件我该怎么做？另一个问题这个代码我有问题文件先下载然后播放？

```
<?php $file = isset($_GET['q']) ? dirname(__FILE__) . base64_decode($_GET['q']) : false;
$file = urldecode(str_replace('/', '\\', $file));
$download = isset($_GET['d']) ? $_GET['d'] == 't' ? true : false : false;
if ($file) {
$disabelStr = 'DisableTrackDownload-';
$pattern = '/'.$disabelStr.'/';
$disableDownload = preg_match($pattern,$file);
$isFile = is_file($file);
// check if file exists
if($isFile){
    // Getting headers sent by the client.
    $headers = apache_request_headers();
    if(isset($headers['Connection'])){
        // stream audio files
        header("Content-Type: audio/mpeg");
        header('Content-Length:'.filesize($file));
        header('Content-Disposition: inline; filename="stream.file"');
        header('X-Pad: avoid browser bug');
        header("Cache-Control: no-store, no-cache, must-revalidate");
        header("Expires: -1");
        ob_clean();
        flush();
        readfile($file);
    }else{
        // disable download
        header ("HTTP/1.0 404 Not Found");
    }
    exit;
}
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:42:27.683

第 1 部分：一般流式传输。

“MP3 流”不同于 HTTP 下载。正确的流需要流媒体服务器（例如 Shoutcast），并且通常是直播的转码版本或大型音频文件的点播版本，可以立即开始播放，而不是等待整个文件下载。

通过 HTTP 提供 MP3 文件并不构成真正的“流媒体”，即使客户端（如 Winamp、Quicktime Player 等）能够在文件下载之前播放文件。

为此，您不能从 PHP 提供 MP3 流，原因应该很明显（即 PHP 是一个“短命”进程，不适用于长生命周期的请求，例如基于 HTTP 的流）。

您描述的场景是提供 MP3 文件的标准 HTTP 下载，但使用可以立即开始播放的客户端。请注意，由于客户端的工作方式（通常），您无法阻止人们保存下载的文件。

我想您可以限制对已知客户端的访问（通过`User-agent`标头），但这是邪恶的一个例子。请不要做这样的事情。

* * *

第 2 部分：您的代码

您的 PHP 代码使用`Content-disposition`标头向浏览器提示应将文件下载到文件系统，而不是将 URL 传递给外部程序或插件。删除标题，您会发现*一些*浏览器会启动 MP3 播放器，但其他浏览器仍会提示用户将文件保存到磁盘（通常是因为用户偏好，或者可能缺少安装的 MP3 播放器）。

此外，请勿使用 HTTP 404 拒绝请求。使用`HTTP 403 Forbidden`哪个更准确地描述您正在做的事情。

# json - 需要从 JSON 文件中提取 ID

> ID：11486192
> 
> 赞同：0
> 
> 时间：2012-07-14T18:14:31.267
> 
> 标签：json, parsing, extract

我刚刚开始编码，我需要从 JSON 文件中提取用户 ID。

ID 与用户名和评论混合在一起，我不完全确定如何提取它们，所以我只剩下：

> “PK”：12345678
> 
> “PK”：87654321
> 
> “PK”：12345678

这是我一直在尝试解析的 JSON 文件：http: [//pastebin.com/CXNe2DCT](http://pastebin.com/CXNe2DCT)

另外，我想知道是否可以仅解析用户 ID（遍历列表），因为每个其他“pk”值都是评论，我只需要用户 ID，而不是评论 ID。

注释“pk”值也更长。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:16:21.893

我强烈推荐使用像 jQuery 这样的库。

```
jQuery.getJSON("http://pastebin.com/download.php?i=CXNe2DCT", 
    function(data) {
        for (var i=0; i<data.items.length; i++) { 
            var userId = data.items[i].user.pk;
            console.log(userId);
        }
    } 
); 
```

# python - 为什么这段代码会无限循环？

> ID：11486193
> 
> 赞同：2
> 
> 时间：2012-07-14T18:14:35.287
> 
> 标签：python, infinite-loop

我正在为经验和知识编写一个搜索引擎。现在，我正在构建一个爬虫及其附带的实用程序。其中之一是 URL 规范化器。这就是我现在正在尝试构建的内容，更具体地说，我被困在我必须制定一种方法来获取 url，并将“%”符号后面的字母大写的地方。到目前为止我的代码：

```
def escape_sequence_capitalization(url):
        ''' The method that capitalizes letters in escape sequences.
        All letters within a percent - encoding triplet (e.g. '%2C') are case
        insensitive and should be capitalized.

        '''
    next_encounter = None
    url_list = []
    while True:
        next_encounter = url.find('%')
        if next_encounter == -1:
            break

        for letter in url[:next_encounter]:
            url_list.append(letter)

        new_character = url[next_encounter + 1].upper()
        url_list.append(new_character)
        url = url[next_encounter:]

    for letter in url:
        url_list.append(letter)

    return ''.join(url_list) 
```

有人可以指导我发现我的错误在哪里吗？我将感激不尽。谢谢你。

编辑：这就是我想要实现的目标：

```
http://www.example.com/a%c2%b1b → http://www.example.com/a%C2%B1b 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-14T18:22:27.690

通过静态分析，它永远循环，因为你`while True`永远不会中断。那么它在哪里可以打破呢？仅在`break`语句中仅当`next_encounter`等于 -1 时；所以你可以推断它永远不会。

为什么不呢？试一试。`print next_encounter`_ `url.find`你很快就会看到

```
url = url[next_encounter:] 
```

几乎完成了您希望的工作，只是它给您的角色比您希望的多一个。

为什么我以这种方式呈现它？主要是因为`print`学习语言的人经常低估 的价值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-14T18:34:31.810

@msw 做到了，并给出了合理的建议。

我的 $.02 是你永远不应该尝试这个循环

怎么样：

```
>>> re.sub('%..',lambda m: m.group(0).upper(),'http://www.example.com/a%c2%b1b')
'http://www.example.com/a%C2%B1b' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-14T18:21:34.027

这就是为什么：

```
>>> 'asd'.find('s')
1
>>> 'asd'[1:]
'sd' 
```

另外，考虑使用第二个参数来`str.find()`代替切片。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-15T07:27:17.690

我参加聚会有点晚了，但是您可能要考虑使用正则表达式而不是如此复杂的函数：

```
>>> import re
>>> url = "http://www.example.com/a%c2%b1b"
>>> result = re.sub("(?i)%[0-9A-F]{2}", lambda x: x.group(0).upper(), url)
>>> result
'http://www.example.com/a%C2%B1b' 
```

**解释：**

```
(?i)          # Make regex case-insensitive
%             # Match a %
[0-9A-F]{2}   # Match two hex digits 
```

`re.sub()` finds all these occurrences in the string and passes the result (the match object's `group(0)`) to the `.upper()` method, then replaces the original with the uppercased version of the match.

# ios - 错误链接按钮

> ID：11486195
> 
> 赞同：1
> 
> 时间：2012-07-14T18:14:57.650
> 
> 标签：ios, xcode4, xcode4.3, uialertview, alert

我整天都在努力解决这个问题，最后只有一个错误，这是一张图片。 ![在此处输入图像描述](../Images/369e59ae41370ba06859bd488082a8bf.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:44:18.017

`alertView`仍然缺少大括号。

此外，您不要使用`()`at`showAlert`的声明。

我可以建议您适当地使用标签，以便更容易看到丢失的大括号。从长远来看，它会对您有所帮助。此外，发布的代码本身而不是图像更有帮助，然后我们可以自己复制/粘贴来编辑它。

**编辑**

这是它应该看起来的样子，格式正确。另外我相信在这种情况下应该设置代表`self`而不是`nil`，所以我做对了。

您应该采用一种编程风格，让您可以轻松查看缺少大括号之类的内容。如果下面缺少任何大括号，由于标签样式，这将是非常明显的。

```
-(void)showAlert 
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"hello"
                                                    message:@"what's your name"
                                                   delegate:self
                                          cancelButtonTitle:@"Dismiss"
                                          otherButtonTitles:@"apple", @"google", @"yahoo", nil];
    [alert show];
}   

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if(buttonIndex == 1)
    {
        //...
    }
    else if(buttonIndex == 2)
    {
        //...
    }
    else if(buttonIndex == 3)
    {
        //...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:19:08.767

您没有在错误 (showAlert) 之前关闭方法的大括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:19:21.923

您缺少 showAlert() 的终止花括号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T19:00:15.510

```
-(void) showAlert {

}   

 -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

} 
```

# php - 会话和 php 重定向不起作用

> ID：11486197
> 
> 赞同：6
> 
> 时间：2012-07-14T18:15:07.353
> 
> 标签：php, session, redirect

我正在制作一个 PHP 脚本`check.php`来检查用户是否登录。只有一个用户，所以密码直接写在 php 代码中。包含在每个相关页面的`check.php`顶部（第 1 行），并带有`<? include "check.php"; ?>`。

## 编码

我已经删除了密码和域名。除此之外，以下是我的代码。这里的重点是您在登录页面输入密码，然后通过 POST 将其发送到此脚本。

如果**密码是正确**的 xxx，会话`login`将存储`true`.

如果**密码不正确**，但*已*设置，意味着用户输入了错误的内容，则任何现有会话都以 结束`session_destroy()`，这意味着他已注销。

如果他到达一个页面但**没有登录**，则会话`login`应该为 false 或未设置，这意味着`} elseif(!($_SESSION['login'])) {`将使用 。

最后，如果他单击**注销**按钮，他将使用 url: 发送到此脚本`check.php?logout=true`。`logout=true`应该在最后的 elseif 语句中捕获，`$_GET`并且会话应该在那里结束。

```
<?
ob_start();
session_start();

if($_POST['password'] == 'xxx') {   // Correct password

    $_SESSION['login'] = true;
    header("Location: http://www.url.com/administration/index.php");

} elseif (isset($_POST['password'])) {  // Wrong password

    session_destroy();
    header("Location: http://www.url.com/administration/login.php?true");

} elseif(!($_SESSION['login'])) {   // Check at every page

    header("Location: http://www.url.com/administration/login.php");

} elseif($_GET['logout']) { // Log out

    session_destroy();
    header("Location: http://www.url.com/");

}
ob_flush();
?> 
```

## 问题

在每个 if 语句中，我都尝试重定向。我使用`header("Location:...)`，但它在任何情况下都不起作用。因为该`header`命令必须是根据规范发送到浏览器的第一个请求，所以我使用了`ob_start();`and `ob_flush();`，如此[处所述](http://techblissonline.com/php-redirect-how-to-do-a-php-redirect/)。无论有没有这些，它都不起作用。

会话也存在不存储内容的问题。由于某种原因，我无法`true`在会话中存储。我的代码是否有问题导致它失败？

作为测试，我尝试`echo`在每个`if`/`ifelse`语句中编写一个命令。从那我发现脚本总是进入第三个语句 - 带有`!($_SESSION['login'])`.

## 问题

到现在为止还挺好。这告诉我脚本能够检测到会话未设置。
剩下的两个问题是：

*   为什么语句中的重定向不起作用，因为没有发生重定向，并且
*   为什么不能首先设置会话。

任何建议将被认真考虑。

* * *

## 更新 1

为了清楚地说明会发生什么（以及什么不会发生），我`echo`在不同的位置添加了一些 s。上面的代码片段带有一些额外`echo`的 s：

```
...
echo "Input: " . $_POST['password'];
echo "<br>Session before: " . $_SESSION['login'];

if($_POST['password'] == 'xxxx') {  // Correct password

    $_SESSION['login'] = true;
    header("Location: http://www.url.com/administration/index.php");
    echo "<br>Session after: " . $_SESSION['login'];
    echo "<br>The first if works";

} ... 
```

返回以下输出：

```
Input: xxxx
Session before:
Session after: 1
The first if works 
```

（xxxx 是密码，是正确的。）

这是您正在登录的情况。您刚刚写入密码并已发送到`check.php`.

所以，我可以在这里看到它`if`按预期访问第一个。并且会话正确设置为`true`（或`1`）。当我刷新页面时，会话不再设置。不应该吗？

并且`header`重定向显然没有做任何事情。

* * *

## 更新 2

因此，多亏了下面@EmilF 的回答，我发现我的会话 ID（我可以用它打印到屏幕上`echo session_id();`）在每次页面移动或页面刷新时都会更改为一些新的随机数。我看起来好像存储在会话中的数据随后被遗忘了，因为新的会话 ID 指向其他地方。

通过使用：

```
<?
session_id('cutckilc16fm3h66k1amrrls96');
session_start();
... 
```

where`cutckilc16fm3h66k1amrrls96`只是一个随机数，会话 id 是固定的，现在可以在页面刷新后再次检索存储的数据。这工作得很好；虽然仍然有点奇怪，但这是必要的。

现在我只需要标头重定向即可工作...

嗯，这闻起来像是被关闭的东西。会话和标头功能已更改。也许这是主机的一些 PHP 设置。阻止标头请求的东西。

*待续...*

## 更新 3 - 已解决

请看下面我的回答。

当我将文件更改为另一种编码格式时，文件开头会创建一些奇怪的符号，例如从 ANSI 到 UTF-8。创建的符号是`ï»¿`，我在自己的编辑器中看不到它们。因为它们在 php 脚本前面，所以它们阻止了`header`and`session_start()`正常工作。为什么它们被创造出来对我来说仍然是一个谜。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T20:19:36.463

好的，让我们在这里列出您可以调试的所有内容，同时提及您已经做过的事情（以便其他人可以阅读）：

*   您是否安装了[HTTP Header 之](https://addons.mozilla.org/en-US/firefox/addon/http-header/?src=search)类的东西？然后您可以查看`Location:`标头是否已发送到您的浏览器。
*   我想您没有收到任何错误消息，是吗？你定了`error_reporting(E_ALL);`吗？
*   尝试`var_dump()`为`$_POST`数组做。
*   您是否还可以在浏览器中检查 cookie？我通常使用 Firefox *web-developer 工具栏插件*，它有一个菜单*Cookie -> show cookie information*。在那里您应该看到一个`PHPSESSID`cookie（登录后）。如果没有，您的 URL 应该包含有关会话 ID 的一些信息（如下所示：）`?PHPSESSID=514515ca274866b9f0b5b2520b6fcbb4`。否则，PHP 找不到会话，因为它不知道哪个会话属于您。

如果这无助于检查是否设置了 cookie：

*   再次打开您的**标头插件**，然后执行登录。检查服务器是否向您发送 cookie。这必须在`Set-Cookie`命令中完成。它可能看起来像这样：`Set-Cookie: PHPSESSID=514515ca274866b9f0b5b2520b6fcbb4; path=/`
*   如果服务器没有设置 cookie，请检查`php.ini`. 必须有一个设置`session.use_cookies = 1`必须设置为`1`或`On`允许 PHP 使用 cookie。
*   如果服务器确实设置了 cookie，但您的浏览器不允许，请检查浏览器的 cookie 选项。还要检查`php.ini`. `session.use_only_cookies = 0`如果设置为`1`您禁止 PHP 在浏览器不接受 cookie 时使用 URL。出于安全原因，这通常是禁止的，因为人们将 URL 复制给朋友，然后这些朋友将接管登录的会话；）所以只需将其设置为`0`用于调试目的。
*   `var_dump()`的返回值`session_start()`。如果 PHP 无法正确启动会话，它将返回 false。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T16:00:49.973

谜团在这里解决： [字节顺序标记](http://en.wikipedia.org/wiki/Byte_order_mark)

![在此处输入图像描述](../Images/ed49ef1a5a5c773f934f9fbf0c5522f0.png)

你会发现最好的答案：

[https://stackoverflow.com/a/8028987/424004](https://stackoverflow.com/a/8028987/424004)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T22:27:22.753

尝试使用 session_id() 打印 PHPSESSID。如果你不断刷新，你会得到相同的输出吗？

如果不尝试设置 id： session_id('cutckilc16fm3h66k1amrrls96')

[http://php.net/manual/en/function.session-id.php](http://php.net/manual/en/function.session-id.php)

它现在应该可以工作，但所有用户都使用相同的会话。

问题可能是这样的： [PHP Session data not being saved](https://stackoverflow.com/questions/155920/php-session-data-not-being-saved)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-15T15:50:40.293

经过许多漫长的日日夜夜的测试、阅读和提问，并在参与者对这个问题的大力帮助下 -*非常感谢您的努力！*- 我慢慢地找到了这个问题的相当神秘的解决方案。
**我找到了一个解决方案，但我仍然没有解释......**

因此，如更新 2 中所述，我从@EmilF 的回答中发现会话 ID 不断变化。然后一个想法是怀疑服务器/主机问题。我联系了主机 - one.com - 一开始和我一样不明白为什么它不起作用。

但后来他告诉我，`check.php`文件开头有一些相当奇怪的符号。我无法在我自己的编辑器中看到它们。在我通过 one.com 提供的基于浏览器的 FileManager 软件访问文件之前，它们才可见。

## 问题及解决方案

文件的顶部如下所示：

```
ï»¿<?
ob_start();
session_start();

if($_POST['password'] == 'xxx') {   // Correct password

    $_SESSION['login'] = true;
... 
```

您可以在开头看到奇数符号`ï»¿`。正如我所说，它们在我自己的编辑器 Notepad++*中不*可见，在常规记事本中也不可见。我把文件发给一个朋友检查，他在他的编辑 Coda 中也看不到它们。

这些符号当然会作为浏览器的输出。`session_start()`因此，这是在和之前发生的对浏览器的请求`header(Location:...`。因为这两个命令**必须**在任何浏览器请求之前，所以在这种情况下，它们现在在符号存在的情况下不起作用。

删除符号后，会话和`header`命令现在可以完美运行。

## 还是没有解释...

我不知道他们为什么在那里，但经过更多测试后，我发现了他们是*如何*到达那里的：

在 Notepad++ 中，我可以更改菜单中的编码格式。当我从 fx ANSI 更改为 UTF-8 时，出现了符号。在普通记事本中，我可以将“另存为”窗口中的选项另存为 UTF-8。并且符号也出现在这种情况下。

无论如何`ï»¿`，当我通过直接从服务器获取文件的基于浏览器的编辑器查看代码时，我只能看到符号。无论是编辑器，它总是`ï»¿`被创建。

我对此没有任何解释。这可能是另一个 SO 问题的好话题。

感谢所有试图帮助我的人。我在这里回答这个问题，因为这*就是*答案。但是所有帮助和调试技巧都非常感谢并且非常有帮助。

非常感谢，祝大家夏天愉快。

# r - 在 R 中创建报告

> ID：11486198
> 
> 赞同：9
> 
> 时间：2012-07-14T18:15:27.960
> 
> 标签：r, graphics, pdf-generation, report, pdflatex

我在[Rstudio](http://support.rstudio.org/help/discussions/questions/773-circulating-reports)上发布了一个类似的问题，但我认为询问堆栈用户也会很有用。

我的问题基本上是这样的：您如何创建其他人可以轻松评论的带有嵌入式 R 图形的文档？

在过去的几个月里，我一直想知道如何在我的公司内快速传播 R 分析，而不必从 R 中粘贴大量图表和表格。我对嵌入 R 代码不感兴趣，但我确实希望能够自定义我的情节去哪里写文本（标题，标题和段落）来自R。包R2wd具有巨大的潜力，但Rstudio正在使HTML，pdf和Latex的高质量文档的整个生产更加直观。这些格式通常更灵活，看起来更好，并充分利用了 R 的功能。

通常（但不一定正确）与 Word 相关联的功能使我（我可能又错了）不太可能切换到这些其他格式。分析完成后，它会上传到公共驱动器上或以电子方式传播，然后同事/主管/可以：

1.  使用跟踪更改查看文档（即编辑文本，然后让您选择是否接受更改），以及
2.  评论文本的部分（评论）。

这两个功能在发布报告时绝对至关重要（尤其是以前没有审查过的新型分析），我想知道您将如何以 Rstudio 当前支持的格式（例如 HTML、latex , pdf)，或者只是您通常如何处理这些问题。我很想改用 pdf 等更好的格式，但我不知道这是否意味着失去上述两个功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T22:54:36.163

结合您讨论过的工具（rstudio 和 sweave/knitr），您可能希望查看`pandoc`将这些工具创建的格式转换为其他工具（包括 word .docx 文件（和其他））的程序。因此，一种选择是在 R 或 Rstudio 中创建一个基本模板文件，并在创建时使用内置工具来处理和查看它。然后，当您准备好共享文档（带有嵌入的图表、输出等）时，您可以将其转换为 .docx 文件，并且合作者可以评论和跟踪更改。

其他选项是使用 R2wd（如问题中所述，但请注意它使用非免费工具）或 R2HTML 或 rtf 包来创建也可以使用 ms word 读取的那些类型的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T18:16:39.673

看看 Sweave（以 R 为基础）和[knitr](http://cran.r-project.org/package=knitr) ——以及[CRAN Task View on Reproducible Research](http://cran.r-project.org/web/views/ReproducibleResearch.html)中的所有内容，这些内容都集中在同一主题上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T20:36:51.517

也许您可以将 knitr'ed HTML 导入 Google Docs。在那里，您不仅可以跟踪更改，还可以进行实时编辑。不过，我没有尝试过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T18:34:05.507

这是我对你的问题的看法。关于编写可重现的报告（或数据分析），正如 Dirk 建议的那样，我建议使用 knitr 或 Sweave（我个人更喜欢 knitr）。在我工作的公司中，我以可复制的格式编写所有报告，以便人们能够复制我的研究，并帮助我轻松更改一些参数{在我使用我们产品的情况下}并获得新报告等一下。

关于编辑和校对部分，您可以使用[http://www.mendeley.com/](http://www.mendeley.com/)。我和我的团队确实有一个关于 Mendeley 的私人小组，我与他们分享我的报告，他们可以轻松地对报告发表评论。我们还可以相互共享文档。这对我很有用。

# objective-c - 如何在两个视图控制器之间传递整数？

> ID：11486201
> 
> 赞同：1
> 
> 时间：2012-07-14T18:15:59.377
> 
> 标签：objective-c, ios

我正在用 Objective-C 创建一个石头剪刀布游戏，目前我遇到了将整数从一个视图控制器带到另一个视图控制器的问题。

我正在使用实用程序应用程序模板，并且我正在使用 FlipsideViewController 作为区域来设置最佳回合（3、5、7 等中的最佳）。但是，我无法将该整数带回 MainViewController 以使用它。我通读了有关此主题的其他问题，但无法正常工作。

这是 FlipSideViewController.h 文件中的协议

```
 @class FlipsideViewController;
 @protocol FlipsideViewControllerDelegate
  - (void)addItemViewController: (FlipsideViewController *)controller didFinishEnteringItem: (int)rounds;
 @end 
```

这是按下按钮以最终确定轮数时发生的动作

```
- (IBAction)submitBOO:(id)sender {
int rounds = 0;
rounds = _textField.text.intValue;

if (rounds % 2 ==0){ 
   _labelBOO.text = @"Pick an odd number!"; 

}   
else 
    [self.delegate addItemViewController:self didFinishEnteringItem:rounds];
} 
```

MainViewController.m 中切换到 FlipsideViewController 的按钮

```
- (IBAction)beginGame:(id)sender {
FlipsideViewController *controller = [[FlipsideViewController alloc]    initWithNibName:@"FlipsideViewController" bundle:nil];

controller.delegate = self;
controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:controller animated:YES];

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:23:10.353

为 int 声明属性与为 NSNumber 或 NSString 之类的对象声明不同。

您需要做的就是将其添加到您的标题中：

```
@property int someInt; 
```

并在您的实现中综合。您不需要释放此属性，因为它不是真正的对象。它没有任何保留。而且，如果您在 ARC 中，则无论如何都无需担心。

如果这不能回答您的问题，请发布您尝试过的内容（即给我们一些代码来使用），您可能会得到更明智的答案。更好的问题=更好的答案。

限定符强/弱不适用于 int 或其他原始数据类型，但您仍然可以明智地使用，并且如果您的目标是 iOS4 `(nonatomic)`，也可能如此。`(unsafe_unretained)`

# javascript - 如何为 Web 上的自定义 DSL 设计富编辑器

> ID：11486204
> 
> 赞同：2
> 
> 时间：2012-07-14T18:16:17.830
> 
> 标签：javascript, algorithm, web-applications, user-interface

我要解决的问题是自定义 SQL 类 DSL 的编辑器，它要求用户输入属性的唯一标识符，而不是正确的详细标题。想想 /obj/12075f8459499 之类的东西，而不是人类可读的“firstName”。有问题的应用程序在网络上，我想为用户提供一个很好的编辑器，它隐藏了具有唯一 URI 的对象的实现细节。

我把它想象成一个内容可编辑的 DIV，如果你开始输入一个字符串，它也是一个属性标题的开头，你会看到一个下拉菜单，以确认这个属性确实是你想要的。选择一个项目后，将插入一个占位符，然后应用程序知道如何将其序列化为我的 DSL 语法。您还可以从侧边栏中的列表中选择要插入可编辑区域的属性。

我的问题是如何解析用户输入，以便生成的界面具有合理的响应性。我应该从定义语法开始然后解析输入还是应该开始寻找其他地方？似乎这样的问题已经在许多应用程序中得到解决，所以我正在寻找通常如何实现的指针。

注意：我还需要对语言进行语法突出显示，因此无论如何可能都必须使用某种语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-30T06:02:12.997

最后，我使用了[CodeMirror](http://codemirror.net/) JavaScript 编辑器。它标记一系列文本并用其他一些 HTML 标记表示的能力被证明特别有用。我用它来显示“友好”的对象名称来代替 URI。

# php - 使用表单时生成干净的 URL

> ID：11486211
> 
> 赞同：1
> 
> 时间：2012-07-14T18:17:43.010
> 
> 标签：php, .htaccess, mod-rewrite

这是表格：

```
<form action='<?php echo $_SERVER['PHP_SELF'];?>'>
  <p><label>Movie Title:</label><input type='text' name='search'></p>
  <p><input id="submit" type='submit' value='Submit'></p>
</form> 
```

提交表单时，当前 URL 返回如下：

```
localhost/movie/index.php?search=ted 
```

我希望 URL 像这样返回：

```
localhost/movie/search/ted 
```

编辑：

现在我的 .htaccess 中有以下代码：

```
RewriteCond %{QUERY_STRING} ^search=(.*)$ [NC]
RewriteRule ^$ /search/%1 [NC,R,L] 
RewriteRule ^search/(.+)$ index.php?search=$1 [NC,L] 
```

这在您输入 URL时有效`/movie/search/ted`，但当您提交表单时，它仍然显示为`/movie/index.php?search=ted`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:22:54.893

重写规则不会更改 url，它们只是告诉您的服务器解释属于规则的 url，`^search/([a-zA-Z0-9]+)/$`例如`index.php?search=$1`.

如果要更改将使用的链接，则必须在 html 中进行更改`<form action=''`

# php - 如果我们想在 __destruct 中使用复杂的代码，我们是否应该尽快取消设置一个类？

> ID：11486213
> 
> 赞同：2
> 
> 时间：2012-07-14T18:17:49.157
> 
> 标签：php, class, destructor, unset

我有以下问题。我正在使用一个类，我想在 __destructor 方法中执行一些“事件保存（和日志记录）”，我需要确保我的数据库类仍然处于活动状态，甚至我的 memcache 类仍然处于活动状态。

我注意到析构函数方法调用得太晚了。（数据库类不再活动，memcache 类不再活动）

我发现的解决方法是...

```
$forum = new Forum_class();
$forum->output();
unset($forum) <-- unset it 
```

这是一个好习惯吗？或者我应该跳过使用析构函数来做依赖于其他活动的类的事情......（可用的数据库类，可用的内存缓存类......）

我很可能不应该尽快取消设置我的数据库和 memcache 类，但对于其他类，你应该尽快取消设置它们。（当页面上不再需要它们时）或者仅当您想使用 __destructor 函数时？

还是我做错了什么可怕的事情？总是必须确保取消设置课程似乎很奇怪。如果我忘记了一次，我的 __destructor 方法会产生错误......

**编辑**：我想我偶然发现了这个错误[https://bugs.php.net/bug.php?id=39381](https://bugs.php.net/bug.php?id=39381)。我的数据库类和 memcache 类使用全局变量...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:42:58.830

> 或者我应该跳过使用析构函数来做依赖于其他类处于活动状态的事情......

基本上，虽然您可以尝试混合方法：

```
class Foo
{
  protected $resource;

  public function close()
  {
    if ($this->resource)
    {
      $this->resource->foo();
      $this->resource = null;
    }  
  }

  public function __destruct()
  {
    $this->close();
  }
} 
```

这样，您可以显式地“关闭”您的资源，但也可以通过析构函数懒惰地执行此操作，以防万一。

如果清理（`close()`方法）很关键，那么如果没有清理，我会更改`__destruct`方法以记录到文件（例如，触发通知）。这样您就可以轻松找到并纠正这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:29:47.733

你做得对。但...

在对象的最后一个链接被销毁后，可能会调用析构函数。即使 unset($object) 也不能保证在 unset() 之后立即调用析构函数。

```
$forum = new Forum_class();
$forum->output();
$forumCopy = $forum;
unset($forum); // php doesnt even consider calling the destructor
unset($forumCopy); // now the destructor is going to be called... in some time 
```

# android - Android向viewpager添加了圆形指示器

> ID：11486218
> 
> 赞同：17
> 
> 时间：2012-07-14T18:18:35.807
> 
> 标签：android, android-viewpager

嗨，我创建了一个视图寻呼机，但有谁知道我如何在页面视图上显示代表分页的圆圈，我认为它暗示了一个指标，但我不完全确定？

继承人到目前为止包含我的视图寻呼机的代码

```
public class LevelSelect extends Activity {

    private ViewPager awesomePager;
    private static int NUM_AWESOME_VIEWS = 10;
    private Context cxt;
    private AwesomePagerAdapter awesomeAdapter;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_levelselect);
        cxt = this;

        awesomeAdapter = new AwesomePagerAdapter();
        awesomePager = (ViewPager) findViewById(R.id.viewpager);
        awesomePager.setAdapter(awesomeAdapter);
    }

    private class AwesomePagerAdapter extends PagerAdapter{

        @Override
        public int getCount() {
            return NUM_AWESOME_VIEWS;
        }

        @Override
        public Object instantiateItem(View collection, int position) {

            LayoutInflater mLayoutInflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            final View LeagueButtonView = mLayoutInflater.inflate(R.layout.ls_button, null);
            Button LeagueButton = (Button) LeagueButtonView.findViewById(R.id.league);
            LeagueButton.setBackgroundDrawable(getResources().getDrawable(R.drawable.ls_level_eng1_locked));
            ((ViewPager) collection).addView(LeagueButtonView,0);

            return LeagueButtonView;
        }

        @Override
        public void destroyItem(View collection, int position, Object view) {
            ((ViewPager) collection).removeView((View) view);
        }

        @Override
        public boolean isViewFromObject(View view, Object object) {
            return view==((View)object);
        }

        @Override
        public void finishUpdate(View arg0) {}

        @Override
        public void restoreState(Parcelable arg0, ClassLoader arg1) {}

        @Override
        public Parcelable saveState() {
            return null;
        }

        @Override
        public void startUpdate(View arg0) {}

    } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-14T18:47:53.520

You can use Jake Wharton's ViewPagerIndicator to add the titles or simple circles for each tab in your ViewPager.

Jake Wharton has supplied a bunch of sample code on [GitHub](https://github.com/JakeWharton/Android-ViewPagerIndicator), you can also refer to the [usage section](http://viewpagerindicator.com/#usage) on the Jake Wharton's site.

![enter image description here](../Images/205c9a6f965d677f7a75af60de37510b.png)

You can also use the ViewPager and PageIndicator of [Greendroid library](https://github.com/cyrilmottier/GreenDroid)

![enter image description here](../Images/27744948d5647ac42a56c1ad6c6a97bb.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-13T16:15:22.480

拍摄两个图像（圆形或任何其他形状的图像，一个用于关闭另一个用于打开）。采用一帧布局，在帧上显示图像（指示器）。当用户更改图像时，显示正确的指示器。

我已经实现了这一点并且工作正常。您可以[下载](http://javaant.com/viewpager-with-circle-indicator-in-android/#.VpZ1McB943g)代码并进行相应更改。 [![在此处输入图像描述](../Images/2185275c5b641fa4ef2039bc0ed686d2.png)](https://i.stack.imgur.com/NTsi7.png)

# spring-security - 我可以使用一个登录页面通过 Spring 3.0 Security 重定向不同的页面吗？

> ID：11486222
> 
> 赞同：0
> 
> 时间：2012-07-14T18:19:44.477
> 
> 标签：spring-security

> **可能重复：**
> [使用弹簧安全性根据用户角色设置自定义登录后目标](https://stackoverflow.com/questions/2818055/setting-custom-post-login-destinations-based-on-user-roles-using-spring-security)

我正在使用 Spring 在 Java 中做我的项目。我在我的项目中使用弹簧安全。

我的问题是，根据 ROLE_USER 或 ROLE_ADMIN 的角色，我想将它们重定向到不同的页面。这意味着如果管理员已登录，那么他应该重定向到一个页面，如果普通用户登录则到不同的页面，但是两个用户的登录页面相同。

现在我在 spring-servlet.xml 文件中使用下面的代码。所以请给我一些解决方案。

```
<security:http auto-config="true">
    <security:intercept-url pattern="/airline/*" access="ROLE_USER" />
    <security:form-login login-page="/login" default-target-url="/logout"
        authentication-failure-url="/login" />
    <security:logout logout-success-url="/logout" />
</security:http>

<security:authentication-manager>
   <security:authentication-provider>
    <security:jdbc-user-service data-source-ref="dataSrc"
       users-by-username-query="select username,password,enabled from spring_users where username=?" 
       authorities-by-username-query="select u.username, ur.authority from spring_users u, spring_roles ur where u.user_id=ur.user_id and u.username=?"/>
   </security:authentication-provider>
</security:authentication-manager> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T01:05:45.860

如果您想在认证成功后控制导航流程，您可以通过添加自己的 AuthenticationSuccessHandler 来实现。

将以下属性添加到您`<form-login> element`的引用 customAuthenticationHandler bean，

```
<form-login login-page="/login.xhtml" authentication-success-handler-ref="customAuthenticationHandler"/>
...
</http>
<beans:bean id="customAuthenticationHandler" class="com.examples.CustomAuthenticationHandler" /> 
```

CustomAuthenticationHandler 类如下所示：

```
public class CustomAuthenticationHandler extends SimpleUrlAuthenticationSuccessHandler{

@Override
public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
        Authentication authentication) throws ServletException, IOException {
        String userTargetUrl = "/welcome.xhtml";
        String adminTargetUrl = "/admin/welcome.xhtml";
        Set<String> roles = AuthorityUtils.authorityListToSet(authentication.getAuthorities());
        if (roles.contains("ROLE_ADMIN")) {
            getRedirectStrategy().sendRedirect(request, response, adminTargetUrl);
        }
        else if(roles.contains("ROLE_USER")) {
            getRedirectStrategy().sendRedirect(request, response, userTargetUrl);
        }
        else {
            super.onAuthenticationSuccess(request, response, authentication);
            return;
        }
 }

} 
```

# google-apps-script - 已删除 .gs 文件的修订历史记录

> ID：11486223
> 
> 赞同：0
> 
> 时间：2012-07-14T18:19:52.543
> 
> 标签：google-apps-script

我注意到编辑器中的“查看修订历史”是针对每个 .gs 文件的。如果我有一个项目删除了第二个 .gs 文件，则无法查看或恢复该已删除文件的任何修订历史记录，对吗？即使它仍在独立应用程序的已部署版本上使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:53:23.360

是的，这似乎是当前修订历史屏幕的限制。我可以看到访问已删除文件的修订历史记录并恢复它是多么有用，并且您可以在[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)上为此提出功能请求。

# java - 在 Spring 中实现一个简单的 GET 方法

> ID：11486228
> 
> 赞同：0
> 
> 时间：2012-07-14T18:20:47.363
> 
> 标签：java, spring, spring-mvc

我正在尝试使用 GET 方法创建一个简单的 Spring 项目，但无法访问它。这是我的控制器...

```
package controller;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.AbstractController;

public class IndexController extends AbstractController {

    @Override
    protected ModelAndView handleRequestInternal(HttpServletRequest arg0, HttpServletResponse arg1) throws Exception {
        String message = "Hello, World!";
        return new ModelAndView("index", "msg", message);
    }

    @RequestMapping(method = RequestMethod.GET)
    public ModelAndView setupForm(@RequestParam("name") String name) {
        return new ModelAndView("index", "msg", name);
    }
} 
```

例如，当我键入 URL：“http://localhost:8080/HelloWorld/index.htm?name=jon”时，它只返回顶部方法。有任何想法吗？

非常感谢，J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T21:17:13.663

尝试摆脱 AbstractController （不要扩展它）并遵循 Petter 给出的建议（顺便说一句，最好将 @RequestMapping 添加到这两种方法中）。相反，使用 @Controller 注释标记控制器。之后它应该工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T20:51:36.457

向您的方法添加请求映射，以将其映射到应用程序根 url 下的某个特定 url

```
@RequestMapping(value = "/something") 
```

# java - Swing 文本看起来很糟糕

> ID：11486234
> 
> 赞同：2
> 
> 时间：2012-07-14T18:21:28.347
> 
> 标签：java, swing, fonts, antialiasing

我正在覆盖 JCOmponent 的 paintComponent() 方法并在窗口中绘制文本。我在 Ubuntu 上运行并使用字体“Ubuntu Mono”（Ubuntu 文本编辑器的默认字体）。当我的 java 应用程序显示文本时，它看起来很软弱和模糊。我究竟做错了什么？

我正在画这样的文字：

```
graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
graphics.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
graphics.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
Font font = new Font("Ubuntu Mono", Font.PLAIN, 18);
fontMetrics = graphics.getFontMetrics(font);
graphics.setFont(font);
graphics.drawString(value, getX(), getY() + fontMetrics.getHeight()); 
```

在我的 java 应用程序中，它看起来像这样：

![Java 应用程序文本](../Images/40fd84d9e76d0741d4e02b14f8220ce3.png)

在 Ubuntu 文本编辑器中，它看起来像这样：

![在此处输入图像描述](../Images/528e33ecb33473ecccc77e3ce1bdbe5f.png)

编辑：如果`.png`使用图像而不是图像，性能会受到影响`drawText()`吗？这是一个商业应用程序，而不是一个需要流畅动画的游戏。

编辑：我更改了颜色以匹配 TextEditor 的颜色，这实际上对质量有所帮助，但字符仍然很薄......你几乎看不到“.”。在 gimp 中，我可以通过创建带有正确字体和抗锯齿功能的文本来重新创建 TextEditor 外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T13:31:03.457

奇怪的是，我尝试使用“Monospaced”而不是“Ubuntu Mono”：

```
graphics.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON); 
```

它看起来对我来说已经足够好了。这就是我要使用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T03:54:23.200

读取 .png 图像并将其缓存到 BufferedImage。性能不会受到影响 - 实际上使用这样的中间图像比首先绘制文本具有更好的性能。

确保将其设为兼容的图像，如下所示：

```
private Image getCompatibleImage(BufferedImage img) throws IOException {
        GraphicsConfiguration c = GraphicsEnvironment
                .getLocalGraphicsEnvironment().getDefaultScreenDevice()
                .getDefaultConfiguration();

        if (c.getColorModel().equals(img.getColorModel()))
            return img;

        BufferedImage compatible = c.createCompatibleImage(img.getWidth(),
                img.getHeight());
        Graphics cg = compatible.getGraphics();
        cg.drawImage(img, 0, 0, null);
        cg.dispose();

        return compatible;
    } 
```

这将在某些显示器上节省每像素转换以提高性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T18:37:29.280

你不一定做错了什么。`RenderingHints`来自（强调我的）的API ：

**这些键和值是提示，不要求给定的实现支持下面指出的所有可能的选择，或者它可以响应修改其算法选择的请求。**各种提示键的值也可以交互，这样虽然在一种情况下支持给定键的所有变体，但当修改与其他键关联的值时，实现可能会受到更多限制。[剪辑]

**实现可以完全忽略提示，但应尝试使用尽可能接近请求的实现算法。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T18:38:57.977

而不是强制呈现提示尝试使用本机桌面设置的字体，即：

```
Toolkit tk = Toolkit.getDefaultToolkit();
Map desktopHints = (Map)(tk.getDesktopProperty("awt.font.desktophints"));

...

if (desktopHints != null) {
    graphics.addRenderingHints(desktopHints);
} 
```

（*来源*-[*肮脏的富客户*](http://filthyrichclients.org/)）

编辑：

一定要尝试各种控制文本渲染质量的提示。这是[参考](http://docs.oracle.com/javase/tutorial/2d/advanced/quality.html)和[示例](http://docs.oracle.com/javase/tutorial/2d/text/renderinghints.html)。

# html - IE中div中未对齐的垂直寻呼机

> ID：11486238
> 
> 赞同：0
> 
> 时间：2012-07-14T18:22:02.123
> 
> 标签：html, css

我尝试了很多事情来解决，但不能，

链接：主页 html 中的多样化

请在链接的第一个和第三个空格中使用点，在第二个空格中使用斜线，它不允许发布有问题的整个链接....对不起这个见鬼...

在上面的链接中，主幻灯片中有一个寻呼机，请在 ie 和 firefox 中浏览链接，寻呼机在 firefox 中运行良好，但在 ie 中没有（未对齐）...

wt我可以做些什么来解决它，请给建议......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:40:10.370

看起来你在`index-slideshow-pager`div 中有一些空格。（源代码中的第 118 行）。尝试编辑它，使其中没有任何内容，即：

```
<div id="index-slideshow-pager"></div> 
```

希望这应该奏效。问题是 IE 会注意空格，即使其他浏览器会忽略空格。

# java - JPA/Eclipselink - 动态选择 DataSource/JDBC URL

> ID：11486239
> 
> 赞同：2
> 
> 时间：2012-07-14T18:22:02.327
> 
> 标签：java, jakarta-ee, jpa, eclipselink, multi-tenant

有没有一种方法可以让 JPA（特别是 Eclipselink）根据绑定到当前线程的某些属性来动态选择连接池？

我要解决的问题是扩展多租户系统，其中租户可能被拆分为多个数据库实例。每个数据库实例都是多租户的，但为了扩展，我可能无法将所有租户舒适地容纳在一个数据库实例中。

我熟悉`@Multitenant`支持单表多租户，并成功使用 Eclipselink 会话事件回调在 Eclipselink 中`Session`动态设置值。我正在尝试更改 EntityManager 将使用的下一步`DataSource`，因此我不必使用集群数据库。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:40:49.023

您可以使用一个`EntitiyManagerFactory`允许`EntitiyManager`为特定数据源（通过字符串属性）创建一个，如下所述

[http://foobar.lu/wp/2010/12/30/change-jpa-entitymanager-connection-properties-at-runtime/](http://foobar.lu/wp/2010/12/30/change-jpa-entitymanager-connection-properties-at-runtime/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T18:12:47.543

您可能想查看[这篇文章](https://stackoverflow.com/questions/7195556/how-to-manage-connections-to-dynamically-created-databases/7195687#7195687)。它可能会有所帮助或为您提供有关如何实现解决方案的线索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:34:06.347

看看这个

[http://code.google.com/p/jdbc-helper/wiki/LoadBalancingDataSource](http://code.google.com/p/jdbc-helper/wiki/LoadBalancingDataSource)

它创建一个负载平衡到后端数据源的数据源。

# javascript - 提供 jqBarGraph 数组中数据的链接

> ID：11486243
> 
> 赞同：0
> 
> 时间：2012-07-14T18:22:41.520
> 
> 标签：javascript, jquery, drupal

嗨，我正在为我的 drupal 网站使用企业清洁主题，因为我正在使用 jqBarGraph 插件，在该插件中我成功地获得了我想要的图表，但我想在此数据中添加的另一件事是为他们提供链接到另一个页面中的内容是可能的，这是我用来在我的页面中获取图表的数据数组：

```
arrayOfData = new Array(
  [32,'66','skyblue'],
  [32,'67','skyblue'],
  [43,'68','skyblue'],
  [131,'69','skyblue'],
  [101,'70','skyblue'],
  [125,'71','skyblue'],
  [62,'72','skyblue'],
  [67,'73','skyblue'],
  [59,'74','skyblue'],
  [95,'75','skyblue'],
  [92,'76','skyblue'],
  [74,'77','skyblue'], 
  [84,'78','skyblue'],
  [66,'79','skyblue']
); 
```

这里是中间元素，即 66、67，...我想提供指向另一个页面中数据的链接，即，如果我点击 66，它将带我到另一个页面中的数据，同样适用于 67....我怎么能做到这一点？？？

非常感谢任何帮助..在此先感谢...:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T10:01:39.750

据我所知，jqBarGraph 无法设置条形链接。您必须编写自己的 JavaScript 代码。

每个酒吧都有唯一的 ID。所以你的javascript代码应该类似于：

```
var links = {
  // bar id's                // links
  '#graphField0simpleGraph': 'node/123',
  '#graphField1simpleGraph': 'node/321'
};

for (id in links) {
  $(id).live('click', function() {
    document.location = links[id];
  });
} 
```

# carousel - 单个页面上的多个 Tiny Carousel 实例

> ID：11486244
> 
> 赞同：1
> 
> 时间：2012-07-14T18:22:43.247
> 
> 标签：carousel, tiny-carousel

我正在使用插件 Tiny Carousel ( [http://baijs.nl/tinycarousel](http://baijs.nl/tinycarousel) )，但我找不到让多个实例在单个页面上工作的方法 - 该网站似乎缺乏这方面的文档。

我在服务器上有我的例子。如您所见，只有第一个实例有效：http: [//irishhuddle.com/RSS/slider/slidertest.html](http://irishhuddle.com/RSS/slider/slidertest.html)。

如何修改我的 HTML 和 .js 文件以使其正常工作？我知道有人问过类似的问题......我花了很多时间阅读它们，但找不到将相同原则应用于我的代码的方法。

我的.js文件：

```
(function($){
$.tiny = $.tiny || { };

$.tiny.carousel = {
    options: {  
        start: 1, // where should the carousel start?
        display: 1, // how many blocks do you want to move at 1 time?
        axis: 'x', // vertical or horizontal scroller? ( x || y ).
        controls: true, // show left and right navigation buttons.
        pager: false, // is there a page number navigation present?
        interval: false, // move to another block on intervals.
        animation: true, // false is instant, true is animate.
        duration: 500, // how fast must the animation move in ms?
        callback: null // function that executes after every move.
    }
};

$.fn.tinycarousel = function(options) {
    var options = $.extend({}, $.tiny.carousel.options, options);
    this.each(function(){ $(this).data('tcl', new Carousel($(this), options)); });
    return this;
};
$.fn.tinycarousel_move = function(iNum){ $(this).data('tcl').move(iNum-1,true); };

function Carousel(root, options){
    var oSelf = this;
    var oViewport = $('.viewport:first', root);
    var oContent = $('.overview:first', root);
    var oPages = oContent.children();
    var oBtnNext = $('.next:first', root);
    var oBtnPrev = $('.prev:first', root);
    var oPager = $('.pager:first', root);
    var iPageSize, iSteps, iCurrent, oTimer, bPause, bForward = true, bAxis = options.axis == 'x';

    function initialize(){
        iPageSize = bAxis ? $(oPages[0]).outerWidth(true) : $(oPages[0]).outerHeight(true);
        var iLeftover = Math.ceil(((bAxis ? oViewport.outerWidth() : oViewport.outerHeight()) / (iPageSize * options.display)) -1);
        iSteps = Math.max(1, Math.ceil(oPages.length / options.display) - iLeftover);
        iCurrent = Math.min(iSteps, Math.max(1, options.start)) -2;
        oContent.css(bAxis ? 'width' : 'height', (iPageSize * oPages.length));
        oSelf.move(1);
        setEvents();
        return oSelf;
    };
    function setEvents(){
        if(options.controls && oBtnPrev.length > 0 && oBtnNext.length > 0){
            oBtnPrev.click(function(){oSelf.move(-1); return false;});
            oBtnNext.click(function(){oSelf.move( 1); return false;});
        }
        if(options.interval){ root.hover(oSelf.stop,oSelf.start); }
        if(options.pager && oPager.length > 0){ $('a',oPager).click(setPager); }
    };
    function setButtons(){
        if(options.controls){
            oBtnPrev.toggleClass('disable', !(iCurrent > 0));
            oBtnNext.toggleClass('disable', !(iCurrent +1 < iSteps));
        }
        if(options.pager){
            var oNumbers = $('.pagenum', oPager);
            oNumbers.removeClass('active');
            $(oNumbers[iCurrent]).addClass('active');
            document.getElementById('slidenum').innerHTML = iCurrent+1;             
        }           
    };

    this.move = function(iDirection, bPublic){
        iCurrent = bPublic ? iDirection : iCurrent += iDirection;
        if(iCurrent > -1 && iCurrent < iSteps){
            var oPosition = {};
            oPosition[bAxis ? 'left' : 'top'] = -(iCurrent * (iPageSize * options.display));    
            oContent.animate(oPosition,{
                queue: false,
                duration: options.animation ? options.duration : 0,
                complete: function(){
                    if(typeof options.callback == 'function')
                    options.callback.call(this, oPages[iCurrent], iCurrent);
                }
            });
            setButtons();
        }
    };
    return initialize();
};
})(jQuery); 
```

* * *

更新：我的 HTML 现在看起来像这样：

```
<script type="text/javascript">         
    $(document).ready(function(){               

        $('#slider-code').tinycarousel({ pager: true });
        $('#slider-code2').tinycarousel({ pager: true });

    });
    </script>

<div id="slider-code">
  <div class="viewport">
    <ul class="overview">
      <li><a rel="1" class="pagenum" href="#">Hi 1</a></li>
      <li><a rel="2" class="pagenum" href="#">Hi 2</a></li>
      <li><a rel="3" class="pagenum" href="#">Hi 3</a></li>
      <li><a rel="4" class="pagenum" href="#">Hi 4</a></li>
      <li><a rel="5" class="pagenum" href="#">Hi 5</a></li>
      <li><a rel="6" class="pagenum" href="#">Hi 6</a></li>       
      </ul>
  </div>

  <ul class="pager">
   <li><a href="#" class="buttons prev">left</a></li>
  <li id="slidenum">1</li><li> / 6</li>
  <li><a href="#" class="buttons next">right</a></li>
  </ul>
</div>
<div id="slider-code2">
  <div class="viewport">
      <ul class="overview">
      <li><a rel="1" class="pagenum" href="#">Hi 1</a></li>
      <li><a rel="2" class="pagenum" href="#">Hi 2</a></li>
      <li><a rel="3" class="pagenum" href="#">Hi 3</a></li>
      <li><a rel="4" class="pagenum" href="#">Hi 4</a></li>
      <li><a rel="5" class="pagenum" href="#">Hi 5</a></li>
      <li><a rel="6" class="pagenum" href="#">Hi 6</a></li>       
      </ul>
  </div>

  <ul class="pager">
   <li><a href="#" class="buttons prev">left</a></li>
  <li id="slidenum">1</li><li> / 6</li>
  <li><a href="#" class="buttons next">right</a></li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T16:02:44.853

你只需要调用`$('#slider1').tinycarousel();`你的另一个滑块

在你的情况下，类似：`$('#slider-code').tinycarousel();`和`$('#slider-code2').tinycarousel();`

这应该就是全部

**编辑**

只是对您的 html 的快速修复：

```
<div id="slider-code">
  <div class="viewport">
    <ul class="overview">
      <li><a rel="1" class="pagenum" href="#">Hi 1</a></li>
      <li><a rel="2" class="pagenum" href="#">Hi 2</a></li>
      <li><a rel="3" class="pagenum" href="#">Hi 3</a></li>
      <li><a rel="4" class="pagenum" href="#">Hi 4</a></li>
      <li><a rel="5" class="pagenum" href="#">Hi 5</a></li>
      <li><a rel="6" class="pagenum" href="#">Hi 6</a></li>       
      </ul>
  </div>

  <ul class="pager">
   <li><a href="#" class="buttons prev">left</a></li>
  <li id="slidenum">1</li><li> / 6</li>
  <li><a href="#" class="buttons next">right</a></li>
  </ul>
</div>
<div id="slider-code2">
  <div class="viewport">
      <ul class="overview">
      <li><a rel="1" class="pagenum" href="#">Hi 1</a></li>
      <li><a rel="2" class="pagenum" href="#">Hi 2</a></li>
      <li><a rel="3" class="pagenum" href="#">Hi 3</a></li>
      <li><a rel="4" class="pagenum" href="#">Hi 4</a></li>
      <li><a rel="5" class="pagenum" href="#">Hi 5</a></li>
      <li><a rel="6" class="pagenum" href="#">Hi 6</a></li>       
      </ul>
  </div>

  <ul class="pager">
   <li><a href="#" class="buttons prev">left</a></li>
  <li id="slidenum">1</li><li> / 6</li>
  <li><a href="#" class="buttons next">right</a></li>
  </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-09T08:07:43.820

我通过`#slider-code`将`.slider-code`. 将该更改应用于 CSS 和调用者函数。然后命名所有实例`.slider-code`。

# javascript - jQuery Mobile 中的中心控制组

> ID：11486248
> 
> 赞同：2
> 
> 时间：2012-07-14T18:23:09.063
> 
> 标签：javascript, jquery, html, jquery-mobile, footer

我在 jQuery Mobile 中有一个控制组，它是页脚的一部分：

```
<div data-role="controlgroup" data-type="horizontal">
  <a data-role="button" data-icon="toomanynotes-back" data-iconpos="notext"></a>
  <a data-role="button" data-icon="toomanynotes-play" data-iconpos="notext"></a>
  <a data-role="button" data-icon="toomanynotes-next" data-iconpos="notext"></a>
</div> 
```

它看起来不错，但它总是在页脚的最左边。我找到[了这个](http://forum.jquery.com/topic/how-to-horizontally-center-a-set-of-grouped-buttons)论坛帖子，但它对我不起作用。如何将控制组（水平）居中在页脚中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-30T23:09:54.117

在 jQuery Mobile 1.3.1 中，只需将这段代码放在你的 CSS 上：

```
.ui-field-contain .ui-controlgroup,
.ui-field-contain fieldset.ui-controlgroup {
    text-align: center;
}

.ui-field-contain .ui-controlgroup-controls {
    width: auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T11:33:56.840

这似乎在 jqm 1.1.1 中发生了变化。文本对齐：居中；工作，但现在没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:29:23.663

事实证明，其他一些 CSS 属性也有效：

```
#playdiv {
    font-size:1.0em;
    margin: 0 auto;
    width:100%;
    text-align: center;
    position:relative;
    left:50%
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T09:09:37.183

我在 1.2.0 中唯一要做的就是使用 text-align: center 将其居中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-16T01:33:33.370

我浪费了大约两个小时试图通过修改 CSS 来使按钮居中。我强烈建议改用布局网格。

```
<fieldset class="ui-grid-a">
<div class="ui-block-a"><button type="submit" data-theme="c">Cancel</button></div>
<div class="ui-block-b"><button type="submit" data-theme="b">Submit</button></div>     
</fieldset> 
```

来源：[http ://demos.jquerymobile.com/1.3.0-rc.1/docs/content/content-grids.html](http://demos.jquerymobile.com/1.3.0-rc.1/docs/content/content-grids.html)

# bash - bash循环更改权限

> ID：11486249
> 
> 赞同：2
> 
> 时间：2012-07-14T18:23:19.670
> 
> 标签：bash

我正在尝试更改 ~/Documents 文件夹中文件的所有权限，我认为下面的小循环会起作用，但它似乎不起作用。谁能帮我？这是循环：

```
files=~/Documents/*
for $file in $files {
   chmod 755 $file } 
```

我正在尝试将其直接写入 bash 命令行，但出现以下错误：

```
-bash: syntax error near unexpected token `chmod' 
```

感谢您的帮助/建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:26:32.677

使您的文档可执行是有风险的。除非您确切知道自己在做什么，否则我建议不要这样做。

我会大胆猜测您并不*想让*您的所有 Documents 文件夹都可执行，而您真正想要做的是标准化该文件夹中所有内容的用户可写其他所有人可读权限.

Note that (as someone mentioned in another answer) the `chmod` command has its own "recursive" option, `-R`. *Note also* that you can use "symbolic" permissions with chmod, you're not stuck with octal-only. So:

```
chmod -R go+r-wx ~/Documents/ 
```

will add Read and remove Write and eXecute functions from everything in and under `~/Documents/`.

Note that this will make *subdirectories* readable, but will not provide access to the files within them (because that's what the executable bit on a directory does). So you may want to use TWO commands:

```
find ~/Documents/ -type d -exec chmod 755 {} \;
find ~/Documents/ -type f -exec chmod 644 {} \; 
```

The first line only runs `chmod` on directories, making them both readable and accessible. The second line affects only your files, making them readable by the world.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T18:27:21.997

尝试

```
find . -exec chmod 755 {} +\; 
```

或者

```
find . -type f -exec chmod 755 {} +\; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T18:26:06.643

循环应该是：

```
for file in $files
do
   test -f "$file" && chmod 755 "$file"
done 
```

请注意，当您说哪个也将包含目录时，您依赖的是[globbing](http://tldp.org/LDP/abs/html/globbingref.html)，因此使用循环也会更改目录的权限。您可以添加一个简单的测试，以确保您只更新文件的权限。另请注意，可以关闭通配符，在这种情况下，其值可能不是文件名；这也不符合您的目的。 `files=~/Documents/*``~/Documents``set -f``files``<HOME_DIR>/*`

**更重要的是，正如[ghoti](https://stackoverflow.com/users/1072112/ghoti)在[评论](https://stackoverflow.com/questions/11486249/bash-loop-to-change-permissions/11486272#comment15170500_11486272)中指出的那样，依赖[globbing](http://searchsecurity.techtarget.com/definition/globbing)*并不是一个好主意*。当您使用带连字符的文件名通配符时，可能会出现未定义的行为，而带分号的文件名可能会导致安全漏洞。**除了与 globbing 相关的安全漏洞之外，还有[一些与之相关的](http://mywiki.wooledge.org/BashPitfalls/#for_i_in_.24.28ls_.2A.mp3.29) [常见](http://mywiki.wooledge.org/BashPitfalls/#cp_.24file_.24target) [陷阱](http://mywiki.wooledge.org/BashPitfalls/#Filenames_with_leading_dashes)。请查看[ghoti 提供的答案，](https://stackoverflow.com/a/11486763/925381)其中突出了您当前操作所涉及的一些风险。

您也可以使用`find`（这将对所有文件进行递归设置）：仅针对您可以使用以下选项
`find ~/Documents/ -type f -exec chmod 755 {} \;`
的文件设置权限：`~/Documents/``-maxdepth`
`find ~/Documents/ -maxdepth 1 -type f -exec chmod 755 {} \;`

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T18:41:37.517

为什么不：

```
chmod -R 755 ~/Documents 
```

# java - 如果我不导入 android.R 会出现语法错误（如果我导入则会出现语法错误）

> ID：11486253
> 
> 赞同：1
> 
> 时间：2012-07-14T18:23:47.463
> 
> 标签：java, android, eclipse, android-fragments

好的，我有一个问题我很困惑，无法正确提问，但这里是：

在android文档的某处它指出：

*注意：Eclipse 有时喜欢在使用资源的文件顶部添加“import android.R”语句，尤其是当您要求 eclipse 对导入进行排序或以其他方式管理导入时。这将导致您的制造中断。留意这些错误的导入语句并删除它们。*

我以前注意到这种行为。第一次是一次非常糟糕的经历，因为我无法理解发生了什么。无论如何，从那时起每当我注意到 import android.R; 我只是删除它。

我最近的项目使用了最新的 SDK，包括 Master - Detail Activity 向导（创建片段）。我注意到在我的 ListFragment 源文件 import android.R; 然后删除它破坏了它，因为它显然需要android.R在onCreate中使用内置布局“simple_list_item_activated_1”（http://developer.android.com/reference/android/R.layout.html#simple_list_item_activated_1）。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setListAdapter(new ArrayAdapter<DummyContent.DummyItem>(getActivity(),
            R.layout.simple_list_item_activated_1,
            R.id.text1,
            DummyContent.ITEMS));
} 
```

所以我把它加回来，没关系。问题在于包含的 android.R 我看不到任何我定义的 XML 内容。就我而言，我正在尝试使用我在 onCreateOptionsMenu 中创建的菜单。

```
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    super.onCreateOptionsMenu(menu, inflater);
    //MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu_checklist_list, menu);
    R.layout.
} 
```

所以我的问题是，如果我不导入 android.R，那么 onCreate 就会中断，如果我导入 android.R，那么 onCreateOptionsMenu 就会中断。如果我这样做该死，如果我不这样做该死。 *哭泣*

:'(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T18:32:15.770

这通常会发生，因为：

1.  带有 ADT 的 Eclipse 有一些错误。
2.  您正在使用 android.R 文件中的 R 资源。

要解决此问题，请删除该`import android.R`语句。现在会出现一些错误，如果错误是因为#2，就会出现一些新的错误。滚动到新错误。它们应该是这样的行：

```
R.layout.simple_list_item_activated_1 
```

现在只需为该 R 变量添加前缀`android.`，错误就会消失。

此外，每次发生与 R 文件相关的错误时，您都应该清理项目。

# javascript - 如何在返回响应之前获取 AJAX get-request 以等待页面呈现？

> ID：11486256
> 
> 赞同：7
> 
> 时间：2012-07-14T18:24:04.717
> 
> 标签：javascript, jquery, ajax, greasemonkey, tampermonkey

我正在[为此站点](http://www.livingsocial.com/cities/368-albany-capital-region/deals/382236-20-to-spend-on-food-and-drink)（Site1）中的页面编写 Greasemonkey 脚本。Site1 有各种交易和优惠，我的 GM 脚本旨在执行以下操作：

当访问 Site1 上的报价时，脚本会查询 [Site2](http://mpdining.rewardsnetwork.com/)以了解该酒店是否也在 Site2 上列出。如果是这样，则在 Site1 上显示来自 Site2 的搜索结果。

问题是 Site2 显示一个进度条（“加载结果”），然后显示结果。因此我的 Ajax 请求总是返回空结果，看起来像这样（见红框部分）：（
[点击查看大图）![未完成的结果](../Images/4587d317d805aee6d3f5e7251447d4bf.png)](https://i.stack.imgur.com/XNqB0.png)

但是，它实际上应该具有来自 Site2 的搜索结果的完整内容，如下所示：（
[点击查看大图）![完成的结果](../Images/dbd895641b59af91e1796bf6ac2fbf91.png)](https://i.stack.imgur.com/fYomL.jpg)

我尝试过同步 Ajax 请求，`GM_xmlhttpRequest`但无济于事。

这是站点 2 有问题的进度条：（
[点击查看大图）![状态栏](../Images/5c86ce7b662332ddc7811680b30180f4.png)](https://i.stack.imgur.com/HjssP.jpg)

在将响应返回给 Site1 之前，如何获取 AJAX 请求以等待 Site2 上的搜索完全呈现？

作为参考，[我的完整工作脚本代码位于 pastebin.com](http://pastebin.com/NC0cTmY9)。

这是相关的片段：

```
$(document).ready(function(){   
var rewardsSiteResults = $('<div class="panel deal-panel rc-lr"></div>').attr('id', "rewardsSiteResults")
        .html("<p>" + progressMessageText + "</p> ").append(spinnerGif);
$(insertSelector).after(rewardsSiteResults);

var addressMap = getAddressOfHotel();
var pinCode = addressMap[pinCodePlaceHolder];
var hotelName = addressMap[hotelNamePlaceHolder];
var queryURL = constructQueryURL(pinCode, hotelName);

$.ajaxSetup({async:true, timeout: 5000});
$.get(queryURL,null, function(response) {
    if(!displayed){
        displayed=true;
        //rewardsSiteResults.html("adfaasddsf");
        var text = $(response).find("#col2");
        $(text).find("script").remove();

        //console.log(text.html())
//          $('<iframe id="someId"/>').appendTo('#rewardsSiteResults')
//          .contents().find('body').append(response);
        rewardsSiteResults.html("<div class='panel deal-panel rc-lr'>" + text.html() +"</div>");
        //console.log(response);
    }
},'html');  
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-15T04:33:07.503

为了让 AJAX 能够“等待页面被渲染”，它实际上必须完全处理页面，获取*并运行*所有包含的 CSS 和 javascript 文件。这并不容易，也不推荐。幸运的是，无论如何您都不需要这样做。

以下是解决此类问题的三种更好的方法：

1.  ***资源页面***（mpdining.rewardsnetwork.com，对于这个问题）可能有一个 API。如果有，请找到并使用它。如果可用，这是您最好的选择。

2.  分析资源页面的 javascript 和/或 AJAX 请求。用于`GM_xmlhttpRequest()`直接获取有效负载数据，而不是尝试解析资源页面。

    有时这个过程相当简单，但有些网站需要复杂的交互和/或身份验证。

3.  在隐藏的 iframe 中加载资源页面；将您的 Greasemonkey 脚本设置为在资源页面和母版页上运行，并使用[`postMessage()`](https://developer.mozilla.org/en/DOM/window.postMessage).

    这种方法几乎总是有效的，尽管您可能必须防止某些页面试图“退出” iframe。

* * *

## 使用隐藏的 iframe 从跨域资源页面获取数据：

Greasemonkey 脚本将在普通页面和 iframe 内的页面上运行。事实上，您可以将相同的脚本设置为在两个域和多个域上运行。

如果***母版页***和 iframed***资源页***都在运行 GM 脚本，则脚本实例可以使用[`postMessage()`](https://developer.mozilla.org/en/DOM/window.postMessage).

例如，假设我们有一个站点[fiddle.jshell.net/9ttvF/show](http://fiddle.jshell.net/9ttvF/show/)，其中包含旅行数据，并且我们希望将该站点与来自***资源站点***[jsbin.com/ahacab](http://jsbin.com/ahacab)的匹配数据***混搭***，该资源站点使用 AJAX获取其有效载荷数据。

 *[目标（主）站点](http://fiddle.jshell.net/9ttvF/show/)如下所示：
![目标站点](../Images/e1d687071545b408a620f865de9d7b5b.png)

[资源站点](http://jsbin.com/ahacab)一开始是这样的：
![资源网站，开始](../Images/ead0435638ebbfb63fc5c03032cc02f0.png)

然后像这样结束： ![资源网站，完成](../Images/67a99aa0f978661163da198434d15b13.png)

以下脚本：

1.  在隐藏的 iframe 中加载资源页面。
2.  启动在 iframed 页面上运行的第二个自身实例。
3.  等待 iframed 页面完成，根据需要处理结果。
4.  将所需的有效负载数据发送到目标（主）页面上运行的 GM 脚本。
5.  然后目标页面的脚本插入有效负载数据以完成混搭。

```
// ==UserScript==
// @name     _Cross-site, AJAX scrape demo
// @include  http://fiddle.jshell.net/9ttvF/show/
// @include  http://jsbin.com/ahacab*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js
// @require  https://gist.github.com/raw/2625891/waitForKeyElements.js
// @grant    GM_addStyle
// ==/UserScript==

if (/fiddle\.jshell\.net/i.test (location.host) ) {
    console.log ("***Master-page start...");

    /*--- Inform the user.
    */
    $("#plainResults").before (
        '<div id="gmFetchRez">Greasemonkey is fetching results from jsbin.com...</div>'
    );

    /*--- Setup to process messages from the GM instance running on the iFrame:
    */
    window.addEventListener ("message", receiveMessage, false);

    /*--- Load the resource site in a hidden iframe.
    */
    $("body").append ('<iframe src="http://jsbin.com/ahacab" id="gmIframe"></iframe>');
}
else {
    console.log ("***Framed start...");
    /*--- Wait for the AJAXed-in content...
    */
    waitForKeyElements ("#results table.rezTable", sendResourcePageData);
}

function sendResourcePageData (jNode) {
    console.log ("Results found!  Sending them to the main window...");

    window.top.postMessage (jNode.html(), "*");
}

function receiveMessage (event) {
    if (event.origin != "http://jsbin.com")     return;

    $("#gmFetchRez").html (event.data);
}

//--- Use CSS to control appearances.
GM_addStyle ( "                                 \
    #gmIframe {                                 \
        display:            none;               \
    }                                           \
    #gmFetchRez {                               \
        background:         lightYellow;        \
        border:             3px double red;     \
        padding:            1em;                \
    }                                           \
" ); 
```

* * *

安装并运行脚本后，最终结果如下所示： ![混搭结果](../Images/f0348b7ea8d4bf8748f3459afa635365.png)*

# firefox - 为什么我的按钮在 Firefox 中看起来与 chrome/safari 不同？

> ID：11486257
> 
> 赞同：1
> 
> 时间：2012-07-14T18:24:11.447
> 
> 标签：firefox, google-chrome

我的按钮在 Firefox 中看起来很正常，但在 chrome（和 safari）中看起来很薄。

任何建议都会很棒。

![带有 firefox / chrome 的按钮比较](../Images/5cb3a1cf98c34d2f1acb8301eb1c04d1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:27:44.063

好吧，它们是不同的浏览器，这意味着它们使用不同的“小部件”集，包括按钮等等，操作系统也是如此。希望这有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:33:32.600

HTML/CSS 只告诉浏览器它需要在页面的某个位置显示什么。由浏览器在正确的位置显示适当的图形。该图形是什么样的取决于默认小部件的特定浏览器实现。

如果您需要它看起来相同的跨浏览器和跨操作系统，那么您需要考虑使用 css/images 来创建自定义按钮等，这基本上会覆盖默认浏览器实现。

您可以设置一个`height`css 属性以确保两个按钮的高度相同，并设置一个适当的`width`。请注意字体大小，尽管按钮的大小最终不会太小以至于您的文本在按钮上不再可见。

# c# - 如何在窗口关闭时立即结束程序

> ID：11486259
> 
> 赞同：-3
> 
> 时间：2012-07-14T18:24:19.297
> 
> 标签：c#, .net, visual-studio-2010

我是 C# 的新手，并创建了一个通过 Visual Studio 2010 运行的基本程序。当窗口关闭时，程序停止。但是，在 IDE 回到编辑模式之前会有几秒钟的延迟。关闭窗口后如何立即结束程序？

```
private void button1_Click(object sender, EventArgs e){
    While (Visible) {
        for (int c = 0; c < 254) {
            this.BackColor = Color.FromArgb(c, 255 - c, c);
            Application.DoEvents();
            System.Threading.Thread.Sleep(3);
        }
        for (int c = 254; c >= 0) {
            this.BackColor = Color.FromArgb(c, 255 - c, c);
            Application.DoEvents();
            System.Threading.Thread.Sleep(3);
        }
    }
} 
```

我试过删除“System.Threading.Thread.Sleep(3);” 来自循环，但这仍然无助于解决问题。我也能够在多台机器上重现它。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:54:55.870

当 Visual Studio 调试程序时，它通过代理应用程序执行程序。程序结束后，代理也必须停止，而且 Visual Studio 必须返回其编辑模式。这种转变不是立即的，很可能是您遇到的延迟。

您可以尝试在发布模式下构建程序并在不调试的情况下运行它。它应该能够快速关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:29:40.210

试试这个：

```
Application.Exit(); 
```

我怀疑是否有更快的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:53:05.257

要关闭正在运行的应用程序（无论哪个表单处于活动状态），您可以使用：

```
System.Environment.Exit(); 
```

您可以将其添加到表单的 onClose 事件中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-15T05:27:54.737

发生延迟是因为 for 循环需要在 while 循环检查 Visible 是否仍然为真之前完成。我可以通过在每个 for 循环中的条件测试中添加**&& Visible == true**来修复它。这样，只要 Visible 变为假，循环就会结束。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-14T18:30:37.523

只需使用`Ctrl.`+运行程序`F5`

# microsoft-metro - 如何调试此 ArgumentException？

> ID：11486262
> 
> 赞同：1
> 
> 时间：2012-07-14T18:24:39.980
> 
> 标签：microsoft-metro

我正在开发一个 C#/Metro 应用程序，并且在主页的 OnNavigatedTo 方法中，我将数据异步加载到设置为页面的 DataContext 的 ViewModel 中。随着 OnNaviagedTo 方法完成执行，此[异常发生](http://i49.tinypic.com/68fw9w.png)10 次中的 9 次。加载本身很好，当我在 OnNavigatedTo 的最后一个右括号上按 F5 时它失败了。

总结一下：

*   没有 InnerExceptiond 的 ArgumentException 和消息“值不在预期范围内”
*   没有堆栈跟踪
*   输出窗口中没有可以帮助我的调试输出

我该如何调试？我从哪说起呢？缺少描述性错误消息确实是有问题的。“值不在预期范围内”......哪个值？什么范围？哪一行代码或 XML 失败了？

# java - 创建 jar 文件后出现 NoClassDefFoundError 异常

> ID：11486264
> 
> 赞同：2
> 
> 时间：2012-07-14T18:24:52.277
> 
> 标签：java, jar, noclassdeffounderror

我创建了一个 jar 文件，其中包括一些包和一对文件。这个类文件使用了另一个我没有包含在 jar 文件中的包 - 我认为这就是我得到这个异常的原因：

```
Exception in thread "main" java.lang.NoClassDefFoundError: JigMonitorGUI (wrong name: org/w3c/jigmonitor/JigMonitorGUI) 
```

我该如何解决这个问题？

编辑

整个堆栈跟踪：

```
Exception in thread "main" java.lang.NoClassDefFoundError: JigMonitorGUI (wrong name:  org/w3c/jigmonitor/JigMonitorGUI)
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:480) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T19:26:58.543

我怀疑你没有完全正确地创建你的 JAR 文件。您的类文件有一个包，但您似乎试图在与该类的包匹配的目录结构中运行该类。

让我们演示如何重现此错误消息。假设我们有以下类：

```
package abc.def.ghi;

public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello");
    }
} 
```

请注意，此类在包中`abc.def.ghi`。假设我们将它保存`Hello.java`在一个目录中`C:\Users\Luke\Java`，然后从这个目录编译它：

```
C:\Users\Luke\Java>javac Hello.java 
```

然后我们使用该文件创建一个 JAR`Hello.class`文件：

```
C:\Users\Luke\Java>jar cf test.jar Hello.class 
```

最后，我们尝试从 JAR 中运行这个类：

```
C:\Users\Luke\Java>java -cp test.jar Hello
Exception in thread "main" java.lang.NoClassDefFoundError: Hello (wrong name: abc/def/ghi/Hello)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        ... 
```

这是您遇到的错误，但类名不同。

问题是该类`Hello`没有在与其包匹配的目录结构中编译。JVM 在 JAR 的根目录中找到了该类，因此它期望类文件中的类的完全限定名称为`Hello`. 但是，类文件中的完全限定名称是`abc.def.ghi.Hello`，这不是 JVM 所期望的，因此它引发了错误。

如果我们改为`Hello.java`在 subdirectories 内`abc\def\ghi`，匹配它的 package `abc.def.ghi`，事情会好一点：

```
C:\Users\Luke\Java>javac abc\def\ghi\Hello.java

C:\Users\Luke\Java>jar cf test.jar abc\def\ghi\Hello.class

C:\Users\Luke\Java>java -cp test.jar abc.def.ghi.Hello
Hello 
```

**编辑**：可以通过直接运行类来重现相同的错误，而无需创建 JAR。关键仍然是您试图从与其层次结构匹配的目录结构之外运行该类。

在这一点上，我`Hello.class`有`C:\Users\Luke\Java`和`C:\Users\Luke\Java\abc\def\ghi`：

```
C:\Users\Luke\Java>java Hello
Exception in thread "main" java.lang.NoClassDefFoundError: Hello (wrong name: abc/def/ghi/Hello)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        ...

C:\Users\Luke\Java>java abc.def.ghi.Hello
Hello 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:26:58.233

您必须在运行应用程序时传递丢失的 .class 文件。

```
java -jar -cp <path_to_missing_jars_here> yourJarName.jar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T19:30:48.783

与其调用`java -cp whatever -jar app.jar`您，不如编辑 jar 的清单文件。像这样的东西：

```
Manifest-Version: 1.0
Main-Class: abc.def.Whatever
Class-Path: jar1.jar jar2.jar jar3.jar 
```

（并且不要忘记清单末尾的空行......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:28:26.163

缺少的类需要在类路径上。如何做到这一点取决于您希望如何部署/运行您的应用程序。

# mysql - MySQL Group_Concat 重复值

> ID：11486266
> 
> 赞同：12
> 
> 时间：2012-07-14T18:25:21.430
> 
> 标签：mysql, group-concat

[我正在开发一个名为PHP-Bouncer](http://code.google.com/p/php-bouncer/)的开源项目，我正在为它编写的 MySQL 查询遇到问题。基本上我们有三个表：BouncerRoles、PageInRole 和 BouncerPageOverrides。BouncerRoles 包含访问级别，另外两个表通过外键链接回 BouncerRoles 并提供多个附加数据条目。我编写了以下查询来尝试一次提取我需要的所有角色数据：

```
select BouncerRoles.RoleID, BouncerRoles.RoleName, 
GROUP_CONCAT(PageInRole.PageName separator '|') as ProvidedPages, 
GROUP_CONCAT(CONCAT(BouncerPageOverrides.OverriddenPage,'&',BouncerPageOverrides.OverridingPage) separator '|') as OverriddenPages 
from BouncerRoles join PageInRole on BouncerRoles.RoleID = PageInRole.RoleID 
join BouncerPageOverrides on BouncerRoles.RoleID = BouncerPageOverrides.RoleID
group by BouncerRoles.RoleID; 
```

此查询的目标是提供 RoleID、RoleName、一个管道分隔的提供页面列表和一个管道分隔的覆盖列表（以 overriddenpage&overridingpage 的形式）。一切正常，除了查询的最后一列，它像这样一遍又一遍地重复它找到的条目（以 CSV 格式输出）：

```
RoleID,RoleName,ProvidedPages,OverriddenPages
2,Exchange,exchange-how.php|exchange-support.php|exchange.php|premium-promo.php|exchange-resorts.php|premiumplus-promo.php|exchange-deposit.php|exchange-requestdestination.php,whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php|whyexchange.php&exhange.php
3,Premium,premiumplus-promo.php|premium-cruises.php|premium-resorts.php|premium-condohome.php|premium-hotelaircar.php|premium.php|premium-restaurants.php|premium-overview.php,premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php|premium-promo.php&premium.php
4,"Premium Plus",premiumplus-exclusiveescapes.php|premiumplus.php|premiumplus-overview.php|premiumplus-concierge.php|premiumplus-airportlounge.php,premiumplus-promo.php&premiumplus.php|premiumplus-promo.php&premiumplus.php|premiumplus-promo.php&premiumplus.php|premiumplus-promo.php&premiumplus.php|premiumplus-promo.php&premiumplus.php 
```

我在查询中做错了什么导致这种情况吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-14T18:38:38.827

您可能在 1..n 关系上加入一个包含两个表的表，从而产生重复的结果。

*   使用`GROUP_CONCAT( DISTINCT ...)`或

*   使用两个子查询：在每个子查询中`GROUP_CONCAT()`，在 2 个表中的每一个上使用 group by。然后加入两个子查询和主表。

# ruby-on-rails - 路由错误：无法为用户调用自定义函数

> ID：11486274
> 
> 赞同：0
> 
> 时间：2012-07-14T18:26:26.983
> 
> 标签：ruby-on-rails, devise, routes

我正在使用 Rails 和 Devise gem。我想要支付宝账户。

我有功能：

```
 def verify_paypal
............
   end 
```

我把它放到user.rb中。在 routes.rb 中添加了路由：

```
devise_for :users do
  member do
  get 'verify_paypal'
  end
end 
```

并得到错误

```
 /mapper.rb:1189:in `member': can't use member outside resource(s) scope (ArgumentError) 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T01:30:20.597

首先，您不能在 上调用块`devise_for`，它不是以这种方式设置的。Devise 确实提供了一个辅助方法，您可以使用它来调用 Devise 路由上的块。请参阅[自述文件](https://github.com/plataformatec/devise/#configuring-routes)。

二、Devise routes 和scoping Devise routes，只针对Devise routes。您的方法不在任何设计控制器中，因此不能为设计调用它。您需要有一个单独`users_controller.rb`的方法来调用`verify_paypal`模型。然后，您可以在`resources users`. 有关 Rails 路由堆栈的更多信息，我建议阅读[Rails Routing From the Outside In](http://guides.rubyonrails.org/routing.html)。这应该为您提供调用自定义操作所需的所有信息。

# ios - iPhone 应用程序无法发布到 Facebook - 此消息包含被阻止的内容

> ID：11486275
> 
> 赞同：0
> 
> 时间：2012-07-14T18:26:54.323
> 
> 标签：ios, facebook, blocked

我们有一个 iPhone / iPad 应用程序，它的用户可以分享他们怀孕的各种经验，例如胎儿发育进展和里程碑、婴儿踢腿、宫缩等。该应用程序已经存在了几年，我们从来没有有任何问题。

然而，最近我们的用户开始联系我们，说他们无法发布他们的状态。测试应用程序后，我们发现没有收到以下错误消息：

“警告：此消息包含被阻止的内容：此消息中的某些内容已被 Facebook 用户报告为滥用。”

看来我们的整个应用程序都被阻止了，我们的客户无法从中发布任何消息。我们的用户对此感到非常沮丧，并导致对我们的 iPhone/iPad 应用程序的负面评价。

不幸的是，我们无法控制这一点，并且非常感谢有关如何解决此问题的任何建议。

谢谢！

# oop - 电晕sdk。我可以得到一个对象的父类吗？

> ID：11486278
> 
> 赞同：0
> 
> 时间：2012-07-14T18:27:03.097
> 
> 标签：oop, lua, addeventlistener, coronasdk

我有一个二维对象数组，这些对象包含一个文本对象和一个名为“hold”的布尔参数。当您单击文本时，我希望能够更改文本颜色并更改保持参数。目前我在所有文本对象上都有一个点击事件监听器，我可以使用 event.target 更改颜色没有问题，但是我如何能够更改作为文本对象兄弟的“hold”参数？有没有类似 event.target.parent 的东西？？？

这是相关的代码...

```
 --CONSTRUCTOR in dice.lua

    function dice.new(x, y) 

    local newdice = {hold = false, dicetext = display.newText(math.random(1,6), 50*x , 50*y , nil, 50)} 

    return setmetatable(newdice, dice_mt) 
    end

            --2d array (this and the rest of the code is from main.lua)

    mainarray = {}

    for x = 1, 5, 1 do
    mainarray[x] = {}

    for y = 1, 5, 1 do
    mainarray[x][y] = diceclass.new(x,y)

    end
    end

            --add event listeners to text

    for x = 1, 5, 1 do
    for y = 1, 5, 1 do
    mainarray[x][y].dicetext:addEventListener("tap", bloop)
    end
    end

            --function that is called

    function bloop(event)
    print("bloop")
    print(event.target)
    event.target:setTextColor(255,0,0)
    end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:48:13.313

好的，我只是为文本对象本身添加了一个保持参数！那成功了！

# html - 您如何将例如 960 像素宽的网站布局居中？

> ID：11486283
> 
> 赞同：1
> 
> 时间：2012-07-14T18:27:36.243
> 
> 标签：html, css, position, scrollbar, margin

...不使用 margin:0 auto;

为什么？它会导致带有滚动条的页面与没有滚动条的页面具有不同的中心位置，因此在浏览页面时，div 会跳跃。你们有什么建议，伙计们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:31:49.503

恐怕“跳跃”效果是不可避免的，因为滚动条会影响视口宽度，进而影响页面的中心线。无论技术如何（ 、 等），都会发生这种`text-align: center;`情况`position: -50%;`。

解决方法是强制垂直滚动条始终出现。用这个：

```
html { overflow-y: scroll; } 
```

[从这里开始](http://css-tricks.com/eliminate-jumps-in-horizontal-centering-by-forcing-a-scroll-bar/)，但您可以忽略该页面上的大多数示例并跳转到底部。

请注意，`overflow-x`and`overflow-y`最初是 Microsoft 对 CSS2.x 标准`overflow`属性的扩展。但是两者`overflow-x`都`overflow-y`在 CSS3 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T18:31:42.390

一种方法是给`overflow-y: scroll;`所有页面上的 HTML 标记，这样它们就会在右侧显示一个滚动条（对于不需要它的页面无效）。这样，所有页面的客户端宽度都相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:33:12.250

纯CSS？正如其他答案所说，只是为了强制滚动条始终出现。

另一条路线将通过 JavaScript - 在 DOM 就绪时检测页面是否有滚动条，并相应地轻推容器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:49:33.590

试试这个 ：

```
.width960container{
    width:960px;
    min-height:500px;
    position:absolute;
    left:50%;
    top:50%;
    margin:-250px 0 0 -480px;
} 
```

# c# - 用于动态属性的 Asp.Net MVC 3 编辑器

> ID：11486286
> 
> 赞同：12
> 
> 时间：2012-07-14T18:27:44.257
> 
> 标签：c#, asp.net-mvc, dynamic, editor

我们一直在尝试让 Editor-Template 与动态属性一起工作 - 无济于事。也许你们中的一个可以帮助我们。

我们的课程大致如下：

```
public class Criterion
{
    ...
    public string Text { get; set; }
    public dynamic Value { get; set; }
    public Type Type { get; set; }
    ...
} 
```

我们的 razor 视图获得了一个模型，其中包含一个部分列表，每个部分都包含一个标准列表。（我们在运行时获得这些信息。）所有这些标准都应该在编辑模式下显示 - 关于它们的实际类型：（摘录）

```
@for (int i = 0; i < model.Sections.Count(); i++)
{
    for (int j = 0; j < model.Sections[i].Criteria.Count(); j++)
    {
        var criterion = model.Sections[i].Criteria[j];
        var type = criterion.Type.Name;
        var name = "Sections[" + i + "].Criteria[" + j + "].Value";
        var criterionDisplayName = criterion.Text;
        <label for="Sections_@(i)__Criteria_@(j)__Value">@criterionDisplayName</label>
        @Html.Editor(name, type)
    }
} 
```

例如，这确实正确显示了一个复选框，但它不使用该值来正确设置复选框状态（检查条件。值是否为真）。其他类型也是如此，例如`ints`. （它确实在 POST 请求后正确填写表单，但那是因为 MVC 使用临时模型来重新创建用户输入。）

正如我们所尝试和研究的那样：是否可以使用带有 type 属性的 Editor 模板`dynamic`？如果是 - 我们怎样才能让它发挥作用？（我们不希望根据可能的类型来辨别。我们希望 MVC 框架根据实际类型使用正确的 Editor 模板。）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-15T08:16:00.887

动态不适合 ASP.NET MVC 的要求。它们让我想起`ViewBag`并且我讨厌`ViewBag`我身体的深层结构。所以我会采取不同的方法。

让我们以以下模型为例：

```
public class Criterion
{
    public string Text { get; set; }
    public object Value { get; set; }
} 
```

值可以是您希望处理的任何类型。

现在您可以拥有一个填充此模型的控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        var model = new[]
        {
            new Criterion { Text = "some integer", Value = 2 },
            new Criterion { Text = "some boolean", Value = true },
            new Criterion { Text = "some string", Value = "foo" },
        };
        return View(model);
    }
} 
```

然后是相应的视图：

```
@model IList<Criterion>

@using (Html.BeginForm())
{
    for (int i = 0; i < Model.Count; i++)
    {
        <div>
            @Html.LabelFor(x => x[i], Model[i].Text)
            @Html.EditorFor(x => x[i].Value, "Criterion_" + Model[i].Value.GetType().Name)
        </div>
    }

    <button type="submit">OK</button>
} 
```

现在，对于您要处理的每种类型，您都可以定义一个相应的编辑器模板：

`~/Views/Shared/EditorTemplates/Criterion_String.cshtml`：

```
@model string
@Html.TextBoxFor(x => x) 
```

`~/Views/Shared/EditorTemplates/Criterion_Boolean.cshtml`：

```
@model bool
@Html.CheckBoxFor(x => x) 
```

`~/Views/Shared/EditorTemplates/Criterion_Int32.cshtml`：

```
@model int
@{
    var items = Enumerable
        .Range(1, 5)
        .Select(x => new SelectListItem 
        { 
            Value = x.ToString(), 
            Text = "item " + x 
        });
}

@Html.DropDownListFor(x => x, new SelectList(items, "Value", "Text", Model)) 
```

显然在视图中显示这个模型只是第一步。我想您会想要获取用户在 POST 控制器操作中输入的值以进行某些处理。在这种情况下，一些小的调整是必要的。我们需要添加一个自定义模型绑定器，它能够在运行时实例化正确的类型，并将具体类型作为每行的隐藏字段包含在内。我已经在[`this post`](https://stackoverflow.com/a/6485552/29407). 另请注意，在此示例中，我使用了基类而不是直接使用`object`类型。

# apache - 使用 htaccess 重定向不起作用

> ID：11486289
> 
> 赞同：0
> 
> 时间：2012-07-14T18:28:27.273
> 
> 标签：apache, .htaccess, redirect

我正在使用以下代码将所有`sitename.com/en/`内部链接重定向到`sitename.com/ar/`相应的链接：

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule   ^en/(.*)?$  /ar/$1 [QSA,L] 
```

但它不起作用。它有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:14:12.107

尝试删除 RewriteCond 行。他们告诉请求的文件名不能是目录或文件。

# linux - rrdtool 使用 awk 和 sort 从多个平面文件更新

> ID：11486291
> 
> 赞同：2
> 
> 时间：2012-07-14T18:28:44.983
> 
> 标签：linux, bash, sorting, awk, rrdtool

正如标题所示，我将数据存储在多个平面文件中，格式如下：

```
215,,,215,16.4,0,2011/05/11 00:00:06
215,,,215,16.3,0,2011/05/11 00:00:23
217,,,217,16.3,0,2011/05/11 00:00:11
213,,,213,16.3,0,2011/05/11 00:00:17
215,,,215,16.3,0,2011/05/11 00:00:30 
```

我目前正在使用以下 awk 命令：

```
awk -F ',' '{gsub(/[\/:]/," ",$7); print mktime($7)":"$1":"$5}' MyFile 
```

这给了我如下输出（日期转换为纪元，冒号分隔符并移动了一点）：

```
1305068406:215:16.4
1305068430:215:16.3
1305068411:217:16.3
1305068417:213:16.3
1305068423:215:16.3 
```

由于在写入文件时出现了一些问题，输入文件可能没有按日期顺序排列，所以接下来我将上面的 awk 命令的输出通过管道传输到 a`sort -n`中，这将确保数据按数字排序，最旧的纪元时间在顶部。

```
1305068406:215:16.4
1305068411:217:16.3
1305068417:213:16.3
1305068423:215:16.3
1305068430:215:16.3 
```

然后我将排序后的输出传递到另一个 awk 命令中：

```
awk -F ':' 'BEGIN {ORS=" ";c="rrdtool update ccdata2.rrd"; print c} NR % 100 == 0 {print "&& "c} $1>p {print $0;p=$0}' 
```

这会生成下面的输出，并确保几个规则：

*   每 100 条记录，打印一个`&&`和一个新`rrdtool update ccdata.rrd`前缀（似乎 rrdtool 不喜欢有很多记录的更新）
*   如果纪元时间大于最后一个，则仅打印出 rrd 数据行

最终输出如下：

```
rrdtool update ccdata2.rrd 1305068406:215:16.4 1305068411:217:16.3 1305068417:213:16.3 1305068423:215:16.3 1305068430:215:16.3 
```

如果有 300 条记录，那就是（你明白了）

```
rrdtool update ccdata2.rrd x:x:x <100 times> && rrdtool update ccdata2.rrd x:x:x <another 100 times> 
```

然后我将命令的输出通过管道传输到`bash`，以便 shell 执行输出`rrdtool update`命令。

完整的命令是：

```
awk -F ',' '{gsub(/[\/:]/," ",$7); print mktime($7)":"$1":"$5}' MyFile | sort -n | awk -F ':' 'BEGIN {ORS=" ";c="rrdtool update ccdata2.rrd"; print c} NR % 100 == 0 {print "&& "c} $1>p {print $0;p=$0}' | bash 
```

如何改进上述过程？你将如何实现同样的目标？请在您的回答中说明原因。（即两个awk命令可以转换成一个）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:03:35.037

由于数据仅包含 [0-9:.] 和换行符，`xargs`应该可以安全使用（一次），因此您可以丢失第二个 awk 并执行以下操作：

```
awk -F ',' '{gsub(/[\/:]/," ",$7); print mktime($7)":"$1":"$5}' MyFile | 
sort -n | 
xargs rddtool update ccdata2.rrd 
```

xargs 将尽可能多地压缩到 rddtool 命令的参数，如果参数数量超过 ARG_MAX，它将运行更多命令，直到处理完所有输入。

**编辑：**

为了具有仅在纪元日期大于上一个日期时打印一行的功能，我已将 awk 命令更新为以下内容：

```
awk -F ',' '{gsub(/[\/:]/," ",$7)} $7>p {print mktime($7)":"$1":"$5;p=$7}' MyFile |
sort -n | 
xargs rddtool update ccdata2.rrd 
```

# jquery - 如何获取使用javascript插入的最后一个值

> ID：11486292
> 
> 赞同：1
> 
> 时间：2012-07-14T18:28:47.503
> 
> 标签：jquery

我有一个简单的输入标签

```
<input type="text" id="textb" name="textbox"/> 
```

jQuery是

```
$("document").ready(function(){

$("#textb").live("keyup",function(){
alert($(this).val());
//this gives me complete value inserted by user 
})
}) 
```

问题是如果用户输入（“hello”），我只想获取用户插入的最后一个值，而不是它应该显示警报（“o”）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T18:32:28.913

```
jQuery("document").ready(function($){
    $("input").bind("keyup",function(e){
        alert(String.fromCharCode(e.keyCode));
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T18:32:51.167

试试这个：

```
$("#textb").live("keyup",function(){
    alert($(this).val().slice(-1));
}) 
```

[http://jsfiddle.net/V3RAF/](http://jsfiddle.net/V3RAF/)

或者：

```
$("#textb").on("blur",function(){
    alert($(this).val().slice(-1));
}) 
```

[http://jsfiddle.net/V3RAF/1/](http://jsfiddle.net/V3RAF/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T18:33:56.230

你可以更新到这个：

```
alert($(this).val().substr($(this).val().length-1)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:48:06.423

我建议将输出放在 div 中，因为它对用户更友好。

```
 $( document ).ready( function() {
        $( 'input' ).keyup( function( evt ) {
            var val = $( this ).val(),
            newVal = val.substr( -1, 1 );

            $( '#output' ).empty();
            $( '#output' ).html( newVal );
        });
    }); 
```

或在此处查看用户友好版本[http://jsfiddle.net/wh1t3w0lf21/pUNXD/](http://jsfiddle.net/wh1t3w0lf21/pUNXD/)

# android - 如何将布局添加到 viewpager

> ID：11486294
> 
> 赞同：0
> 
> 时间：2012-07-14T18:29:08.000
> 
> 标签：android

如何向视图寻呼机添加多个布局？（每个布局都有不同的内容）

我只知道我应该使用 Fragment 和一些东西，但是我在整个互联网上寻找，我找不到任何东西......

预先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:39:03.873

在这里你有一个 viewpager 的例子：http: [//viewpagerexample.googlecode.com/svn/trunk/AwesomePager/src/com/geekyouup/paug/awesomepager/AwesomePagerActivity.java](http://viewpagerexample.googlecode.com/svn/trunk/AwesomePager/src/com/geekyouup/paug/awesomepager/AwesomePagerActivity.java)

# vim - 如何更有效地在 Vim 中更改模式

> ID：11486295
> 
> 赞同：-2
> 
> 时间：2012-07-14T18:29:13.497
> 
> 标签：vim

大多数建议都指向将 escape 更改为 jj。我通常通过反复按 j 来向下滚动文件。难道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T19:39:57.653

我认为您只想映射以**在插入模式下**`jj`转义。因此，除非您倾向于在插入文本时键入，否则这不应与正常使用冲突。标准的做法是：**`jj`**

 **```
 inoremap jj <Esc> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T18:43:56.270

您也可以使用`Ctrl`+`[`或`Ctrl`+`c`退出插入模式。我认为`Ctrl`+`c`并没有那么糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T18:37:57.377

我真的不明白你的问题，但是在 Vim 中移动可以非常有效地完成

*   您知道`h`、和`j`，但您可以输入任何数字 N，然后再输入动作来重复它。假设你输入你向下移动 100 行`k``l``100j`
*   您还可以使用`pg up`和`pg dn`
*   您可以使用标记轻松返回到您之前所在的位置：
    *   `:mark a`或`ma`创建书签（您可以创建任意数量的书签）
    *   `'a`：返回书签所在行。和`"a`：返回行*和*列。
*   `:100`您可以通过、`100G`或转到任何第 N 行，或`100gg`转到第 100 行。
*   如果要转到第 100 行，也可以从命令行打开`$ vi file +100`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-15T00:32:41.787

查看[此链接](http://vim.wikia.com/wiki/Avoid_the_escape_key)和[此图像](http://blog.jobbole.com/wp-content/uploads/2012/05/ADM3A-keyboard.jpg)。

图片只是为了说明为什么`ESC`被选中。**

# c# - 使用本机 .Net FTP 库进度条未显示正确进度

> ID：11486297
> 
> 赞同：1
> 
> 时间：2012-07-14T18:29:28.477
> 
> 标签：c#, ftp, webrequest, ftpwebrequest

为了确保我做的一切都是正确的，并希望帮助其他人，我决定创建一个测试应用程序来上传文件并将其发布在这里寻求帮助解决我的问题。希望在帮助我的同时帮助别人！;)

**值得注意的是：** - 我正在通过慢速连接进行测试，并将 ftp 用户帐户的速度限制在大约 10kb/s 以进行测试。

**问题：** 使用我新创建的线程（函数 UploadAFile->UF_Thread）上传文件时，我在下面的 snip-it 中发送了一个数据包，即使 requestStream.Write() 返回并允许线程继续，我的服务器也会显示数据包仍在发送。到发送 100 个数据包 3 秒时，在我的循环中发送所有数据包，而在服务器上大约需要 26 秒来上传文件（此时我的应用程序只是坐在那里等待它完成显示没有进展完全是因为 23 秒前它根据 GUI 完成）。

**预期结果：** 我需要找到一种方法将 bStillSending 设置为 true，直到数据包完成。我想等待每个数据包。

*开始剪辑*

```
DateTime startTimestamp = DateTime.Now;
requestStream.Write(buffer, 0, bytesRead);

//Wait for packet to get to server
bool bStillSending = false;
do
{
  Thread.Sleep(50);
} while (bStillSending);

bytesRead = sourceStream.Read(buffer, 0, ufParams.PacketSize);
lBytesSent += bytesRead;

TimeSpan tsUploadTime = DateTime.Now.Subtract(startTimestamp);
if (tsUploadTime.Milliseconds > 0) lstSpeedInBytesPerMillisecond.Add(bytesRead / tsUploadTime.Milliseconds);
else lstSpeedInBytesPerMillisecond.Add(bytesRead);
sSpeed = ConvertBytesToLargestType(lstSpeedInBytesPerMillisecond.Last());
Raise_UploadFile_Progress_Event(bytesRead, lBytesSent, sourceStream.Length, sSpeed); 
```

*结束剪辑*

*整个应用程序的开始*

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Net;
using System.Threading;
using System.Windows;

namespace WindowsFormsApplication1
{
    class UploadFile
    {
        #region Private class variables
        private ManualResetEvent m_MRE_StopUpload = new ManualResetEvent(false);
        #endregion

        #region Private class structures
        private class UploadFile_PARAMS
        {
            #region Local private class variables
            private int m_iThreadID = 0;
            private ManualResetEvent m_MRE_StopUpload = new ManualResetEvent(false);
            private string m_sServer = "";
            private string m_sUser = "";
            private string m_sPass = "";
            private string m_sSourcePath = "";
            private string m_sDestPath = "";
            private int m_iPacketSize = 512;
            #endregion

            #region Properties
            public int ThreadID
            {
                get
                {
                    return m_iThreadID;
                }
                set
                {
                    m_iThreadID = value;
                }
            }

            public ManualResetEvent MRE_StopUpload
            {
                get
                {
                    return m_MRE_StopUpload;
                }
                set
                {
                    m_MRE_StopUpload = value;
                }
            }

            public string Server
            {
                get
                {
                    return m_sServer;
                }
                set
                {
                    m_sServer = value;
                }
            }

            public string User
            {
                get
                {
                    return m_sUser;
                }
                set
                {
                    m_sUser = value;
                }
            }

            public string Pass
            {
                get
                {
                    return m_sPass;
                }
                set
                {
                    m_sPass = value;
                }
            }

            public string SourcePath
            {
                get
                {
                    return m_sSourcePath;
                }
                set
                {
                    m_sSourcePath = value;
                }
            }

            public string DestPath
            {
                get
                {
                    return m_sDestPath;
                }
                set
                {
                    m_sDestPath = value;
                }
            }

            public int PacketSize
            {
                get
                {
                    return m_iPacketSize;
                }
                set
                {
                    m_iPacketSize = value;
                }
            }
            #endregion
        }
        #endregion

        #region Public class methods
        //Public method UploadFile
        public void UploadSingleFile(string sServer, string sUser, string sPass, string sSourcePath, string sDestPath, int iPacketSize)
        {
            UploadFile_PARAMS ufParams = new UploadFile_PARAMS();
            ufParams.Server = sServer;
            ufParams.User = sUser;
            ufParams.Pass = sPass;
            ufParams.SourcePath = sSourcePath;
            ufParams.DestPath = sDestPath;
            ufParams.PacketSize = iPacketSize;
            ufParams.MRE_StopUpload = m_MRE_StopUpload;

            UploadAFile(ufParams);
        }

        //Public method CancelUpload
        public void CancelUpload()
        {
            m_MRE_StopUpload.Set();
        }
        #endregion

        #region Public class events
        //Public event UploadFile_Progress
        public delegate void UploadFile_Progress_EventHandler(long lBytesSent, long lTotalBytesSent, long lTotalFileSizeBytes, string sSpeed);
        public event UploadFile_Progress_EventHandler UploadFile_Progress;
        private void Raise_UploadFile_Progress_Event(long lBytesSent, long lTotalBytesSent, long lTotalFileSizeBytes, string sSpeed)
        {
            if (this.UploadFile_Progress != null)
            {
                //The event handler exists so raise the event to it
                this.UploadFile_Progress(lBytesSent, lTotalBytesSent, lTotalFileSizeBytes, sSpeed);
            }
        }

        //Public event UploadFile_Complete
        public delegate void UploadFile_Complete_EventHandler(long lTotalBytesSent, long lTotalFileSizeBytes, bool bError, string sAverageSpeed, TimeSpan tsTimeItTookToUpload);
        public event UploadFile_Complete_EventHandler UploadFile_Complete;
        private void Raise_UploadFile_Complete_Event(long lTotalBytesSent, long lTotalFileSizeBytes, bool bError, string sAverageSpeed, TimeSpan tsTimeItTookToUpload)
        {
            if (this.UploadFile_Complete != null)
            {
                //The event handler exists so raise the event to it
                this.UploadFile_Complete(lTotalBytesSent, lTotalFileSizeBytes, bError, sAverageSpeed, tsTimeItTookToUpload);
            }
        }

        //Public event UploadFile_Error
        public delegate void UploadFile_Error_EventHandler(string sErrorMessage);
        public event UploadFile_Error_EventHandler UploadFile_Error;
        private void Raise_UploadFile_Error_Event(string sErrorMessage)
        {
            if (this.UploadFile_Error != null)
            {
                //The event handler exists so raise the event to it
                this.UploadFile_Error(sErrorMessage);
            }
        }
        #endregion

        #region Private class functions
        //Private class function ConvertBytesToLargestType
        private string ConvertBytesToLargestType(long lBytesAMillisecond)
        {
            //Convert the byte count to the highest type
            double dKiloBytesAMillisecond = (double)lBytesAMillisecond / (double)1024;
            double dMegaBytesAMillisecond = dKiloBytesAMillisecond / (double)1024;
            double dGigaBytesAMillisecond = dMegaBytesAMillisecond / (double)1024;

            if (dGigaBytesAMillisecond >= 1)
            {
                return dGigaBytesAMillisecond.ToString("#.##") + "Gb/s";
            }

            if (dMegaBytesAMillisecond >= 1)
            {
                return dMegaBytesAMillisecond.ToString("#.##") + "Mb/s";
            }

            if (dKiloBytesAMillisecond >= 1)
            {
                return dKiloBytesAMillisecond.ToString("#") + "kb/s";
            }

            return lBytesAMillisecond.ToString("#") + "b/s";
        }
        #endregion

        #region Private class multi-threading functions
        //Thread creation for UploadAFile
        System.Threading.Thread threadUF;
        private void UploadAFile(UploadFile_PARAMS ufParams)
        {
            //Make sure to destory any old objects
            if (threadUF != null)
            {
                if (threadUF.IsAlive) threadUF.Abort();
                while (threadUF.IsAlive) Application.DoEvents();
                threadUF = null;
                GC.Collect();
            }

            //Make sure the params object is not null
            if (ufParams == null) return;

            //Create the new thread
            threadUF = new System.Threading.Thread(new System.Threading.ParameterizedThreadStart(UF_Thread));
            threadUF.IsBackground = true;
            ufParams.ThreadID = threadUF.ManagedThreadId;

            //Start the thread
            threadUF.Start(ufParams);
        }
        private void UF_Thread(Object oParameter)
        {
            //Extract (cast) the params
            UploadFile_PARAMS ufParams = (UploadFile_PARAMS)oParameter;

            FtpWebRequest request;
            FtpWebResponse response;

            Stream sourceStream = new MemoryStream();
            Stream requestStream = sourceStream;

            long lBytesSent = 0;
            string sSpeed = "";
            TimeSpan tsTimeToUploadFile;
            DateTime dtStartedUpload = DateTime.Now;
            List<long> lstSpeedInBytesPerMillisecond = new List<long>();

            try
            {
                request = (FtpWebRequest)WebRequest.Create("ftp://" + ufParams.Server + ufParams.DestPath);
                request.Method = WebRequestMethods.Ftp.UploadFile;
                request.Credentials = new NetworkCredential(ufParams.User, ufParams.Pass);

                sourceStream = new FileStream(ufParams.SourcePath, FileMode.Open);

                requestStream = request.GetRequestStream();
                request.ContentLength = sourceStream.Length;

                byte[] buffer = new byte[ufParams.PacketSize];
                int bytesRead = sourceStream.Read(buffer, 0, ufParams.PacketSize);

                do
                {
                    DateTime startTimestamp = DateTime.Now;
                    requestStream.Write(buffer, 0, bytesRead);

                    //Wait for packet to get to server
                    bool bStillSending = false;
                    do
                    {
                      Thread.Sleep(50);
                    } while (bStillSending);

                    bytesRead = sourceStream.Read(buffer, 0, ufParams.PacketSize);
                    lBytesSent += bytesRead;

                    TimeSpan tsUploadTime = DateTime.Now.Subtract(startTimestamp);
                    if (tsUploadTime.Milliseconds > 0) lstSpeedInBytesPerMillisecond.Add(bytesRead / tsUploadTime.Milliseconds);
                    else lstSpeedInBytesPerMillisecond.Add(bytesRead);
                    sSpeed = ConvertBytesToLargestType(lstSpeedInBytesPerMillisecond.Last());
                    Raise_UploadFile_Progress_Event(bytesRead, lBytesSent, sourceStream.Length, sSpeed);
                } while (bytesRead > 0 && ufParams.MRE_StopUpload.WaitOne(0) == false);

                if (ufParams.MRE_StopUpload.WaitOne(0)) throw new System.Net.WebException("Upload was canceled!");

                //Close the stream to show we are finished with the file
                requestStream.Close();

                response = (FtpWebResponse)request.GetResponse();
                if (lstSpeedInBytesPerMillisecond.Count > 0)
                {
                    sSpeed = ConvertBytesToLargestType(Convert.ToInt64(lstSpeedInBytesPerMillisecond.Average()));
                }
                else sSpeed = "0 b/s";
                tsTimeToUploadFile = DateTime.Now.Subtract(dtStartedUpload);
                Raise_UploadFile_Complete_Event(lBytesSent, sourceStream.Length, false, sSpeed, tsTimeToUploadFile);
            }
            catch (Exception ex)
            {
                Raise_UploadFile_Error_Event(ex.GetType().Name + ": " + ex.Message);
                if (lstSpeedInBytesPerMillisecond.Count > 0)
                {
                    sSpeed = ConvertBytesToLargestType(Convert.ToInt64(lstSpeedInBytesPerMillisecond.Average()));
                }
                else sSpeed = "0 b/s";
                tsTimeToUploadFile = DateTime.Now.Subtract(dtStartedUpload);
                Raise_UploadFile_Complete_Event(lBytesSent, sourceStream.Length, true, sSpeed, tsTimeToUploadFile);
            }
            finally
            {
                request = null;

                sourceStream.Close();
                sourceStream = null;

                requestStream.Close();
                requestStream = null;
            }
        }
        #endregion
    }

    public partial class Form1 : Form
    {
        //Define the upload object as a global form object
        UploadFile upload;

        public Form1()
        {
            InitializeComponent();
        }

        #region Buttons
        private void button1_Click(object sender, EventArgs e)
        {
            OpenFileDialog openFileDialog1 = new OpenFileDialog();

            openFileDialog1.InitialDirectory = "c:\\";
            openFileDialog1.Filter = "txt files (*.txt)|*.txt|All files (*.*)|*.*";
            openFileDialog1.FilterIndex = 2;
            openFileDialog1.RestoreDirectory = true;

            if (openFileDialog1.ShowDialog() == DialogResult.OK)
            {
                if (File.Exists(openFileDialog1.FileName))
                {
                    label1.Text = openFileDialog1.FileName;
                    listView1.Items.Add("Selected file to upload.");
                }
                else
                {
                    label1.Text = "";
                    listView1.Items.Add("File choosen does not exist!");
                }
            }
        }

        private void button2_Click(object sender, EventArgs e)
        {
            if (!File.Exists(label1.Text))
            {
                listView1.Items.Add(DateTime.Now.ToString("hh:mm:ss:f") + " Error!  File selected does not exist!");
                return;
            }

            listView1.Items.Add(DateTime.Now.ToString("hh:mm:ss:f") + " Starting the upload process...");

            progressBar1.Minimum = 0;
            progressBar1.Maximum = 100;

            upload = new UploadFile();
            upload.UploadFile_Progress += new UploadFile.UploadFile_Progress_EventHandler(upload_UploadFile_Progress);
            upload.UploadFile_Complete += new UploadFile.UploadFile_Complete_EventHandler(upload_UploadFile_Complete);
            upload.UploadFile_Error += new UploadFile.UploadFile_Error_EventHandler(upload_UploadFile_Error);
            upload.UploadSingleFile("ftp.xentar.com", "arvo", "S1mP13", label1.Text, "/arvo/" + Path.GetFileName(label1.Text), 1024);
        }

        private void button3_Click(object sender, EventArgs e)
        {
            listView1.Items.Add(DateTime.Now.ToString("hh:mm:ss:f") + " Canceling upload...");
            upload.CancelUpload();
        }
        #endregion

        #region UploadFile object events
        private void upload_UploadFile_Error(string sErrorMessage)
        {
            listView1.Items.Add(DateTime.Now.ToString("hh:mm:ss:f") + " Error!  " + sErrorMessage);
        }

        private void upload_UploadFile_Complete(long lTotalBytesSent, long lTotalFileSizeBytes, bool bError, string sAverageSpeed, TimeSpan tsTimeItTookToUpload)
        {
            if (bError)
            {
                AddItemToLog("Error uploading file!");
            }
            else
            {
                AddItemToLog("Upload complete!");
                AddItemToLog("It took " + tsTimeItTookToUpload.ToString("mm") + " minutes and " + tsTimeItTookToUpload.ToString("ss") + " seconds to upload the file.");
                UpdateProgressBar(100, lTotalBytesSent);
            }
        }

        private void upload_UploadFile_Progress(long lBytesSent, long lTotalBytesSent, long lTotalFileSizeBytes, string sSpeed)
        {
            int iProgressComplete = Convert.ToInt32(((double)lTotalBytesSent / (double)lTotalFileSizeBytes) * 100);
            UpdateProgressBar(iProgressComplete, lTotalBytesSent);
        }
        #endregion

        #region Thread-safe functions
        private void AddItemToLog(string sLogEntry)
        {
            //Send to tread safe call
            ThreadSafe_AddItemToLog(sLogEntry);
        }
        delegate void ThreadSafe_AddItemToLog_Callback(string sLogEntry);
        private void ThreadSafe_AddItemToLog(string sLogEntry)
        {
            if (this.InvokeRequired)
            {
                ThreadSafe_AddItemToLog_Callback d =
                    new ThreadSafe_AddItemToLog_Callback(ThreadSafe_AddItemToLog);
                try
                {
                    this.Invoke(d, new object[] { sLogEntry });
                }
                catch
                {
                    //ObjectDisposedException
                }
            }
            else
            {
                //Send the call on to the normal function
                ThreadSafe_AddItemToLog_Proc(sLogEntry);
            }
        }
        private void ThreadSafe_AddItemToLog_Proc(string sLogEntry)
        {
            listView1.Items.Add(DateTime.Now.ToString("hh:mm:ss:f") + " " + sLogEntry);
        }

        private void UpdateProgressBar(int iProgressBarValue, long lTotalBytesSent)
        {
            //Send to tread safe call
            ThreadSafe_UpdateProgressBar(iProgressBarValue, lTotalBytesSent);
        }
        delegate void ThreadSafe_UpdateProgressBar_Callback(int iProgressBarValue, long lTotalBytesSent);
        private void ThreadSafe_UpdateProgressBar(int iProgressBarValue, long lTotalBytesSent)
        {
            if (this.InvokeRequired)
            {
                ThreadSafe_UpdateProgressBar_Callback d =
                    new ThreadSafe_UpdateProgressBar_Callback(ThreadSafe_UpdateProgressBar);
                try
                {
                    this.Invoke(d, new object[] { iProgressBarValue, lTotalBytesSent });
                }
                catch
                {
                    //ObjectDisposedException
                }
            }
            else
            {
                //Send the call on to the normal function
                ThreadSafe_UpdateProgressBar_Proc(iProgressBarValue, lTotalBytesSent);
            }
        }
        private void ThreadSafe_UpdateProgressBar_Proc(int iProgressBarValue, long lTotalBytesSent)
        {
            label4.Text = lTotalBytesSent.ToString();
            progressBar1.Value = iProgressBarValue;
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T09:07:41.320

像这样人为地设置速度不会产生与慢速链接相同的效果。客户端中的限制限制了它从缓冲区读取的数量，但实际上不会改变它的发送速率，直到两端的缓冲区都被填满。

如果您尝试上传更大的文件，您应该会在缓冲区填满后看到上传停止，然后以预期的速度继续。

`.Write()`将阻塞直到它被写入套接字，如果你希望它是异步的，你需要使用异步`.BeginWrite()`调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T11:59:45.417

为什么不使用后台工作人员来处理进度条，然后如果您希望它等待，那么它不会让您的主线程陷入困境。

# scala - 如何在我的 Scala 程序中获得 Scala REPL :type 命令的功能

> ID：11486298
> 
> 赞同：4
> 
> 时间：2012-07-14T18:29:31.960
> 
> 标签：scala

在 REPL 中有一个打印类型的命令：

```
scala> val s = "House"
scala> import scala.reflect.runtime.universe._
scala> val li = typeOf[List[Int]]
scala> :type s
String
scala> :type li
reflect.runtime.universe.Type 
```

如何在我的 Scala 程序中获得这个 ":type expr" 功能来打印类型？

让我澄清一下我想要的“:type expr”功能，如下所示：

```
println(s.colonType)   // String
println(li.colonType)  // reflect.runtime.universe.Type 
```

如何`colonType`在 REPL 之外的 Scala 程序中获得这样的“”方法（我没有`:type`可用的命令）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T20:00:52.213

我查看了 REPL 的来源（或者更好的包含 REPL 的 scalac ）并发现了这个（[Source](https://github.com/scala/scala/blob/master/src/compiler/scala/tools/nsc/interpreter/ILoop.scala#L71)）：

```
private def replInfo(sym: Symbol) = {
  sym.info match {
    case NullaryMethodType(restpe) if sym.isAccessor => restpe
    case info => info
  }
} 
```

返回一个（[Source](https://github.com/scala/scala/blob/master/src/reflect/scala/reflect/internal/Symbols.scala#L1396)）的方法`info`。稍后在此类型上调用，因此如果您想要相同的类型信息，您应该执行相同的操作：`scala.reflect.internal.Symbols.Symbol``Type``toString`

```
scala> import scala.reflect.runtime.{universe => u}
import scala.reflect.runtime.{universe=>u}

scala> u.typeOf[List[String]].toString
res26: String = scala.List[String]

scala> u.typeOf[Int => String].toString
res27: String = Int => String 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-15T17:01:41.410

以下隐式转换应该为您解决问题：

```
import reflect.runtime.universe._

implicit class ColonTypeExtender [T : TypeTag] (x : T) {
  def colonType = typeOf[T].toString
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T18:32:32.247

这是你想要达到的吗？

```
val s = "House"
println(s.getClass.getName)       // java.lang.String
println(s.getClass.getSimpleName) // String 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-28T13:26:11.693

使用 Scala REPL 2.11 测试：

在函数名称后添加 _ 以将其视为部分应用的函数。

例子 ：

```
scala> def addWithSyntaxSugar(x: Int) = (y:Int) => x + y
addWithSyntaxSugar: (x: Int)Int => Int

scala> addWithSyntaxSugar _
res0: Int => (Int => Int) = <function1>

scala> 
```

# .htaccess - 更改绝对路径 htaccess

> ID：11486307
> 
> 赞同：1
> 
> 时间：2012-07-14T18:31:04.087
> 
> 标签：.htaccess, structure, markup

有没有办法可以更改.htaccess 中的绝对路径？

例如，当我在本地服务器上工作时，我的 url 是这样的：

> 本地主机：8888/网站/站点名称/

当我使用像 /assets/css/style.css 这样的绝对路径时，它会在以下位置查找它：

> 本地主机：8888/assets/css/style.css

但我需要它来查看：

> 本地主机：8888/网站/站点名称/资产/css/style.css

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T06:36:15.307

尝试：

```
RewriteEngine On
RewriteCond %{DOCUMENT_ROOT}/websites/sitename%{REQUEST_URI} -f
RewriteRule ^(.+)$ /websites/sitename/$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:00:45.687

这是通过在本地机器上设置虚拟主机来完成的，而不是通过 .htaccess。

# agile - 统一流程分析和软件百分比混淆

> ID：11486309
> 
> 赞同：-1
> 
> 时间：2012-07-14T18:31:08.350
> 
> 标签：agile, requirements, rational-unified-process

我想问一些关于统一流程的问题。在 UP 中，每个迭代都有自己的分析和实现步骤。

> ![在此处输入图像描述](../Images/778e294ad7b5b7b57ae53782ea1baf64.png)

但是上图显示了一些不同的东西。在第 5 次迭代之后，完成了 90% 的分析，但仅完成了 10% 的软件。我无法理解。在迭代中，代码是关于迭代的需求的。那么软件的完成率怎么可能是10%，需求的比例是90%呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T07:06:46.023

确实是个好问题。

我会尝试根据您提到的分析和实施图提供中立的观点。让我尝试用一​​个例子来解释这一点，以便我们可以进行上下文讨论。

假设您的组织已经提出了构建人力资源管理系统的需求，并且出于某种原因决定将在内部实施该产品。因此，工程和人力资源团队一起着手，首先制定*高层要求*，可能会在半天的快速研讨会上进行。团队通过在迭代期间进行详细分析以及随后的实施来向前迈进。例如，“系统需要有处理员工辞职的规定”可能是您的高级要求的一部分，而“经理批准、人力资源处理、到期结算等的规定”可能是您的分析。在这种情况下，您的分析和实施可能类似于：

迭代#1：10% 分析，0% 实施

迭代#2：20% 分析，0% 实施

迭代#3：40% 分析，10% 实施

.

.

.

同样，如果高级管理层要求您提供*“近似”*资源和成本估算（就像正式项目一样），这可能会有所不同。然后，您需要在第一次迭代期间执行*更详细的分析。*

现在，让我们假设同一个 HR System 项目来自其他组织，而您正在为他们提供 IT 服务。现在，你这次是从零开始吗？不会。您的客户会带着适当的需求文件来找您。您需要对估算和计划进行充分的分析。甚至在您开始进行高级设计之前，您就已经将系统分析到了一个不错的水平。这本身就是你分析的 60%。剩余的 % 是横向循环中在微观层面上分析的内容。[*在“迭代模型”的掩护下，你能不能去告诉你的客户，你会逐件估算（并据此收费）？没有。* ] 因为成本是这里的主要因素。（您的成本和客户的成本）

*因此，实际上，完成的分析百分比取决于您进入项目周期的阶段以及在它来到您之前已经完成的工作。*此外，您在资源/成本因素方面的带宽也将发挥作用。最后，没有*f(x)*公式，它是事实驱动的。

希望这可以帮助。

谢谢，

法伊兹

[http://beyondyourcode.com/](http://beyondyourcode.com/)

# ruby-on-rails - Rails：在多态辅助模型中存储多少信息？

> ID：11486314
> 
> 赞同：0
> 
> 时间：2012-07-14T18:31:58.350
> 
> 标签：ruby-on-rails, polymorphic-associations

我正在构建一个 Web 应用程序，并有一个名为“电影”和另一个“地方”的功能。他们都可以有一个视频文件。显然对于电影和“地点”的“电影”可以有该特定地点的录像的视频。

目前我有 2 个模型，“视频”和“PlacesVideo”，我认为这是不必要的，所以我想制作 1 个多态“视频”模型。

现在每个视频都可以有一个与之关联的“海报”，这是您在播放视频之前显示的图像。是否应该将其存储在 polym 中。视频模型，还是单独在“电影”或“地点”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T21:22:23.363

What i ended up doing is creating a "VideoAsset" model (because my feature is called Videos not "Movies") and storing the video file and poster inside that model.

# c# - 始终具有参数化构造函数的类

> ID：11486321
> 
> 赞同：1
> 
> 时间：2012-07-14T18:32:32.343
> 
> 标签：c#, oop, constructor

> **可能重复：**
> [定义构造函数签名的接口？](https://stackoverflow.com/questions/619856/interface-defining-a-constructor-signature)

我可以在接口中声明方法和属性，并强制实现它的类来实现这些方法和属性。同样，是否可以强加一个规则，使我所有实现某个接口的类都应该始终具有参数化构造函数？

我不确定这是否可能。只是一个想法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:35:28.893

> 同样，是否可以强加一个规则，使我所有实现某个接口的类都应该始终具有参数化构造函数？

不，不是通过接口声明。

你可以创建一个抽象类，*它*可以有一个参数化的构造函数——所有实现类型都将继承构造函数，并且能够使用`base`关键字链接到它。请注意，这不会阻止您从实现无参数构造函数中继承类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:06:02.923

不，但是如果您的目标是规范接口实例的构造方式，请定义另一个接口，它是第一个实例的工厂。在工厂界面中，您可以强加所需的构造参数。

```
interface IFoo
{
    ...
}

interface IFooFactory
{
    IFoo CreateFoo(string param1, string param2)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:46:41.990

A class have contructor and interface cannot. So you cannot in force classes that implement certain interface to have a parameterised contructor

But you can have a class with a multiple constructors and its children can have a choice which constructor they want to use

# webforms - 有没有办法向使用自定义 PageHandlerFactory 的 Web 表单 ASPX 页面添加路由？

> ID：11486322
> 
> 赞同：1
> 
> 时间：2012-07-14T18:32:35.387
> 
> 标签：webforms, asp.net-routing

我已经定义了一个自定义 HTTP 处理程序，即扩展`PageHandlerFactory`用于创建 Web 表单页面实例的 ASP .NET 类的“.aspx”路径。它为 Web 表单提供依赖注入。

但是，如果使用该`RouteCollection.MapPageRoute(...)`方法添加路由，则当路由 URL 调用页面时，ASP .NET 将使用默认页面处理程序工厂。

是否有其他方法可以将路由添加到将使用自定义页面处理程序工厂的 Web 表单？

我在集成模式下使用 .NET 4.0、IIS 7.5。

# c# - 如何在 Windows Phone 上创建 UDP 广播侦听器套接字

> ID：11486324
> 
> 赞同：0
> 
> 时间：2012-07-14T18:32:49.633
> 
> 标签：c#, windows-phone-7, sockets, udp

我正在尝试开发一个 Windows Phone 7.5 应用程序，我想创建一个侦听器套接字来侦听端口 8001 上的 UDP 广播消息。

我已经修改了示例[How to: Create and Use a UDP Socket Client Application for Windows Phone](http://msdn.microsoft.com/en-us/library/hh202864%28v=vs.92%29.aspx)，但我收到“无效参数异常”，但我修复了该错误。

这是我现在的代码：

```
 public String SecureRecive(int portNumber, bool isBroadcast)
    {
        SocketAsyncEventArgs socketEventArg;

        Send("melnibone", portNumber, " ", isBroadcast, out socketEventArg);
        Thread.Sleep(1000);

        if (!isHasSent) ;
        return Receive(portNumber, isBroadcast, socketEventArg);
    }

    private string Send(string serverName, int portNumber, string data, bool isBroadcast, out SocketAsyncEventArgs socketEventArg)
    {
        string response = "Operation Timeout";

        // We are re-using the _socket object that was initialized in the Connect method
        if (_socket != null)
        {
            socketEventArg = new SocketAsyncEventArgs();
            // Set properties on context object
            if (isBroadcast)
                socketEventArg.RemoteEndPoint = new IPEndPoint(IPAddress.Broadcast, portNumber);
            else
                socketEventArg.RemoteEndPoint = new DnsEndPoint(serverName, portNumber);

            // Inline event handler for the Completed event.
            // Note: This event handler was implemented inline in order to make this method self-contained.
            socketEventArg.Completed += new EventHandler<SocketAsyncEventArgs>(delegate(object s, SocketAsyncEventArgs e)
            {
                response = e.SocketError.ToString();

                // Unblock the UI thread
                _clientDone.Set();
                isHasSent = true;
            });
            // Add the data to be sent into the buffer
            byte[] payload = Encoding.UTF8.GetBytes(data);
            socketEventArg.SetBuffer(payload, 0, payload.Length);

            // Sets the state of the event to nonsignaled, causing threads to block
            _clientDone.Reset();

            // Make an asynchronous Send request over the socket
            _socket.SendToAsync(socketEventArg);

            // Block the UI thread for a maximum of TIMEOUT_MILLISECONDS milliseconds.
            // If no response comes back within this time then proceed
            //_clientDone.WaitOne(TIMEOUT_MILLISECONDS);
        }
        else
        {
            socketEventArg = null;
            response = "Socket is not initialized";
        }

        return response;
    }

    /// <summary>
    /// Receive data from the server
    /// </summary>
    /// <param name="portNumber">The port on which to receive data</param>
    /// <returns>The data received from the server</returns>
    private string Receive(int portNumber, bool isBroadcast, SocketAsyncEventArgs socketEventArg)
    {
        string response = "Operation Timeout";

        // We are receiving over an established socket connection
        if (_socket != null)
        {
            if (isBroadcast)
                socketEventArg.RemoteEndPoint = new IPEndPoint(IPAddress.Broadcast, portNumber);
            else
                socketEventArg.RemoteEndPoint = new IPEndPoint(IPAddress.Any, portNumber);

            // Setup the buffer to receive the data
            socketEventArg.SetBuffer(new Byte[MAX_BUFFER_SIZE], 0, MAX_BUFFER_SIZE);

            // Inline event handler for the Completed event.
            // Note: This even handler was implemented inline in order to make this method self-contained.
            socketEventArg.Completed += new EventHandler<SocketAsyncEventArgs>(delegate(object s, SocketAsyncEventArgs e)
            {
                if (e.SocketError == SocketError.Success)
                {
                    // Retrieve the data from the buffer
                    response = Encoding.UTF8.GetString(e.Buffer, e.Offset, e.BytesTransferred);
                    response = response.Trim('\0');
                }
                else
                {
                    response = e.SocketError.ToString();
                }

                _clientDone.Set();
            });
            // Sets the state of the event to nonsignaled, causing threads to block
            _clientDone.Reset();

            // Make an asynchronous Receive request over the socket
            _socket.ReceiveFromAsync(socketEventArg);

            // Block the UI thread for a maximum of TIMEOUT_MILLISECONDS milliseconds.
            // If no response comes back within this time then proceed
            //_clientDone.WaitOne(TIMEOUT_MILLISECONDS);
        }
        else
        {
            response = "Socket is not initialized";
        }

        return response;
    } 
```

但我不知道如何将套接字超时设置为无限。

是否可以在 Windows Phone 上创建这种套接字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:41:47.650

让我们按顺序进行：

1.  上面的代码有效吗？您说您修复了“无效参数异常”问题，但我的猜测是它仍然无法按预期工作，原因如下
2.  您不能在 Windows Phone 7 上的套接字上“侦听”，出于安全原因，您只能从您发起通信的 IP 接收，因此首先发送一个空数据包，然后侦听一段有限的时间。
3.  不支持 UDP 广播，仅支持 TCP、UDP 单播和 UDP 多播。

我希望以上三点总结了您代码的主要问题。

# google-chrome - 在特定网站上嵌入自定义样式表/JS

> ID：11486326
> 
> 赞同：3
> 
> 时间：2012-07-14T18:33:07.273
> 
> 标签：google-chrome, web, chromium

是否有适用于 Google Chrome / Chromium 的扩展程序允许我在打开特定网站时嵌入自定义样式表或执行自定义 JS 代码？

如果没有，是否可以开发一个？

当然，小书签可能会做同样的工作，但必须在每个条目上单击它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T18:51:06.447

[Stylebot](https://chrome.google.com/webstore/detail/oiaejidbmkiecgbjeifoejpgmdaleoha "风格机器人")是一个很好的修改 CSS 的扩展，但它不会帮助你处理 Javascript。您可能需要两个单独的扩展，用于 CSS 和 JS。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-14T18:38:15.927

[TamperMonkey](https://chrome.google.com/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo)使您能够在页面上运行自定义 javascript。据我所知，您可以将用于 firefox 的 GreaseMonkey 脚本导入其中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T18:38:25.607

GreaseMonkey 完全符合您的要求，但它是一个 Firefox 扩展。[我在这里](https://chrome.google.com/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo/details)找到了似乎与 Chrome 等效的东西，尽管我自己没有使用过。

# xcode4.3 - 存档警告：他捆绑的 iTunes 软件服务无法加载，因为它已损坏或缺少必要的资源

> ID：11486339
> 
> 赞同：1
> 
> 时间：2012-07-14T18:35:06.420
> 
> 标签：xcode4.3, app-store-connect, application-loader

在尝试存档以提交时，我收到此警告，如果我尝试进行验证或分发，它们会挂起。我正在使用 Xcode4.3.2 下面的消息建议：尝试重新安装捆绑包 - 怎么做？我在现有帖子中没有找到任何有用的建议

> 2012-07-14 14:15:00.935 验证 [1884:f07] 无法在“file://localhost/Applications/Xcode.app/Contents/Applications/Application%20Loader.app/Contents/Frameworks/ITunesSoftwareService. framework/” (err = Error Domain=NSCocoaErrorDomain Code=3587 "无法加载捆绑包“ITunesSoftwareService”，因为它已损坏或缺少必要的资源。" (dlopen_preflight(/Applications/Xcode.app/Contents/Applications/Application Loader .app/Contents/Frameworks/ITunesSoftwareService.framework/ITunesSoftwareService）：库未加载：@rpath/ITunesConnectFoundation.framework/Versions/A/ITunesConnectFoundation 引用自：/Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents /Frameworks/ITunesSoftwareService.framework/ITunesSoftwareService 原因：图片未找到) UserInfo=0x400419fe0 {NSLocalizedFailureReason=捆绑包损坏或缺少必要的资源。, NSLocalizedRecoverySuggestion=尝试重新安装捆绑包。, NSFilePath=/Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/Frameworks/ ITunesSoftwareService.framework/ITunesSoftwareService，NSDebugDescription=dlopen_preflight（/Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/Frameworks/ITunesSoftwareService.framework/ITunesSoftwareService）：库未加载：@rpath/ITunesConnectFoundation.framework/Versions/ A/ITunesConnectFoundation 引用自：/Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/Frameworks/ITunesSoftwareService.framework/ITunesSoftwareService 原因：找不到图像，NSBundlePath=/Applications/Xcode。app/Contents/Applications/Application Loader.app/Contents/Frameworks/ITunesSoftwareService.framework, NSLocalizedDescription=无法加载捆绑包“ITunesSoftwareService”，因为它已损坏或缺少必要的资源。}) 警告：已跳过应用程序验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:30:49.693

看起来重新安装 xcode（或升级它）可以解决问题。还是很疑惑为什么会这样。我忽略了升级的提议，将其推迟到提交完成几天，也许苹果更改了一些链接，因为它指的是 iTunes 捆绑包？无论如何它现在工作。

# javascript - 在数组中显示多个标记 - Google Maps API

> ID：11486341
> 
> 赞同：0
> 
> 时间：2012-07-14T18:35:14.820
> 
> 标签：javascript, google-maps-api-3

如何清理它以便代码更好地处理多个列表？我已经看到了一些从数组中提取标记信息的代码示例，但我似乎无法让它工作。

标记需要具有“icon:”、“url:”和“title:”属性。“图标：”以便我可以更改每个标记的外观，“url：”指向专用于每个标记的页面，“标题”只是在悬停时添加标记名称。

我还需要脚本中的数组，因为我不是从数据库或类似的东西中收集它。

当谈到 javascript 和 google maps api 时，我非常绿色，任何帮助将不胜感激。

```
function createMap(lat, lng, zoomVal) {
 var mapOptions = { center: new google.maps.LatLng(lat, lng),    
 zoom: zoomVal,   
 scrollwheel: false,  
 mapTypeId: google.maps.MapTypeId.ROADMAP 
}; 
map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

var myLatlnglow = new google.maps.LatLng(23.654332,-79.387867);

var markerlow1 = new google.maps.Marker({
    position: myLatlnglow,
    icon: 'images/map-dot.png',
    map: map,
    url: '#',
    title: 'Name'
});
google.maps.event.addListener(markerlow1, 'click', function() {
window.location.href = markerlow1.url;
});

var myLatlnglow = new google.maps.LatLng(23.688458,-79.300619);

var markerlow = new google.maps.Marker({
    position: myLatlnglow,
    icon: 'images/map-dot.png',
    map: map,
    url: '#',
    title: 'Name'
});
google.maps.event.addListener(markerlow, 'click', function() {
window.location.href = markerlow.url;
});

}

var map;
function initialize() { 
 createMap(23.668493, -29.410812,12);
  if(navigator.geolocation) {  
  success = function(position) {    
 createMap(position.coords.latitude, position.coords.longitude,13);  
};   
error = function() {
 createMap(23.648493, -29.410812,12); 
}    
 navigator.geolocation.getCurrentPosition(success, error);  
} 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T23:37:33.237

如果我是你，为了便于阅读，我会制作一个对象的对象。如果您必须有效率，并且希望节省空间和打字，请将对象替换为数组并按索引（0,1,2...）寻址数据

这是[**一个演示**](http://jsfiddle.net/yV6xv/166/)

```
 // inside function createMap(...)
      ...
    markerData = {
        bing: {
            lat: 23.654332,
            lng: -79.387867,
            icon: "http://labs.google.com/ridefinder/images/mm_20_red.png",
            url: "http://www.bing.com/",
            title: "some search engine"
        },
        yahoo: {
            lat: 23.688458,
            lng: -79.300619,
            icon: "http://labs.google.com/ridefinder/images/mm_20_blue.png",
            url: "http://www.yahoo.com/",
            title: "Great free games"
        }
    };

    for (markerId in markerData) {
        markers[markerId] = createMarker(markerData[markerId]);
    }

    markers['bing'].setTitle("new title");
}

function createMarker(data) {
    var myLatLng = new google.maps.LatLng(data.lat, data.lng);

    var marker = new google.maps.Marker({
        position: myLatLng,
        icon: data.icon,
        map: map,
        title: data.title
    });
    google.maps.event.addListener(marker, 'click', function() {
        window.location.href = data.url;
    });

    return marker;
} 
```

它还应该有助于稍后保存对创建标记的引用，我使用的是全局对象`markers`和相同的 ID。

```
var map;
var markers = {}; 
```

如果您以后需要更改标记属性，可以通过`markers`.

```
 markers['bing'].setTitle("new title"); 
```

# objective-c - 只有当用户使用 iPhone 和 iPad 时，我才能运行一段代码吗？

> ID：11486342
> 
> 赞同：1
> 
> 时间：2012-07-14T18:35:15.073
> 
> 标签：objective-c, xcode, xcode4.3, master-detail

我有一个非常适合 iPad 的主从应用程序。但是，iPhone 版本不起作用，因为`DetailViewController`在 iPad 版本中发送到 的变量不会发送到 iPhone `DetailViewController`。我可以在实现中用一行代码解决这个问题`MasterViewController`：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    self.detailViewController=segue.destinationViewController;
} 
```

不幸的是，当我实现该代码时，iPad 版本停止工作。当我从另一个视图控制器 ( `HomeViewController`) 返回到`DetailViewController`. 该错误日志是：

```
2012-07-14 14:29:12.924 46 Tracker[2772:11603] -[HomeViewController setDetailItem:]: unrecognized selector sent to instance 0x7cad4f0
2012-07-14 14:29:12.925 46 Tracker[2772:11603] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[HomeViewController setDetailItem:]: unrecognized selector sent to instance 0x7cad4f0'
*** First throw call stack:
(0x148a022 0x201acd6 0x148bcbd 0x13f0ed0 0x13f0cb2 0x2cb0 0x2d75c5 0x2d77fa 0xb6c85d 0x145e936 0x145e3d7 0x13c1790 0x13c0d84 0x13c0c9b 0x16a07d8 0x16a088a 0x246626 0x1fdd 0x1f45)
terminate called throwing an exception(lldb) 
```

那么，有什么方法可以让我只在用户使用 iPhone 时才运行第一个代码块？或者，我可以修复代码以使其在两个设备上都能正常工作吗？

这是我的 iPad 故事板的链接，以（希望）使其更清晰。`HomeViewController`当我点击表格单元格后，我遇到了问题：http `DetailViewController`: [//www.grapekeeper.com/storyboards.png](http://www.grapekeeper.com/storyboards.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:49:50.767

也许是以下？

```
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
    // perform iPad logic
} else {
    // perform iPhone logic
} 
```

# html - 为什么我的 CSS 精灵不起作用？

> ID：11486343
> 
> 赞同：2
> 
> 时间：2012-07-14T18:35:22.030
> 
> 标签：html, css

```
#border #header-wrapper #header-wrapper-upper #social-top a {
    float: left;
    background: url('../images/social_media.png') no-repeat;
    height: 35px;
    text-decoration: none;
    width: 35px;
}
#border #header-wrapper #header-wrapper-upper #social-top a.twitter {
    background-position: 0 0;
}

#border #header-wrapper #header-wrapper-upper #social-top a.twitter:hover {
    background-position: 0 - 35;
}

#border #header-wrapper #header-wrapper-upper #social-top a.facebook {
    background-position: -35 0;
}

#border #header-wrapper #header-wrapper-upper #social-top a.facebook:hover {
    background-position: -35 - 35;
}

#border #header-wrapper #header-wrapper-upper #social-top a.be {
    background-position: -70 0;
}

#border #header-wrapper #header-wrapper-upper #social-top a.be:hover {
    background-position: -70 - 35;
} 
```

这是我的css代码，但是当我查看页面时，它总是显示a.twitter，当我悬停时没有任何反应，它只是保持a.twitter。对于 a.facebook，它还显示 a.twitter ec

这是html代码 -

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>index</title>
        <link rel="stylesheet" href="css/stylesheet.css" />
    </head>
    <body>
        <!-- Header background starts -->
        <div id="header"></div>
        <!-- Header Background ends -->
        <!-- Middle content starts -->
        <div id="border">
            <!-- Header Wrapper starts -->
            <div id="header-wrapper">
                <!-- Header upper Part starts -->
                <div id="header-wrapper-upper">
                    <img src="images/logo.png" alt="Season Logo" title="Season logo" id="logo" />
                    <div id="social-top">
                        <a href="#" class="twitter">&nbsp;</a>
                        <a href="#" class="facebook">&nbsp;</a>
                        <a href="#" class="be">&nbsp;</a>
                    </div>
                </div>
                <!-- Header upper Part ends -->
            </div>
            <!-- Header Wrapper Ends -->
        </div>
        <!-- Middle Content ends -->
    </body>
</html> 
```

任何线索？第一次使用精灵，所以我不太确定。控制台中也没有任何显示。

JSfiddle - [http://jsfiddle.net/kEQUw/](http://jsfiddle.net/kEQUw/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T18:40:28.913

将“px”添加到背景位置

前任。

1.  0 -35 像素
2.  0 0
3.  0 35px ...等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:43:48.137

CSS中的减号和35之间真的有空格吗？您是否在验证器中检查了 CSS 和 HTML？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:54:31.060

只是为了记录。因为[你的精灵](http://desmond.imageshack.us/Himg546/scaled.php?server=546&filename=socialmedia.png&res=landing)的构建方式（图标之间有空格）你可以使用[spritecow 在线工具](http://www.spritecow.com/)来获取精灵每个元素的正确值。

所以你正确的代码应该是：

```
#border #header-wrapper #header-wrapper-upper #social-top a {
    float: left;
    background: url('../images/social_media.png') no-repeat;
    height: 32px; /* not 35 */
    width: 32px;
    text-decoration: none;
    display: block; /* NEW */
}
#border #header-wrapper #header-wrapper-upper #social-top a.twitter {
    background-position: -2px -3px;
}

#border #header-wrapper #header-wrapper-upper #social-top a.twitter:hover {
    background-position: -2px -38px;
}

#border #header-wrapper #header-wrapper-upper #social-top a.facebook {
    background-position: -52px -2px;
}

#border #header-wrapper #header-wrapper-upper #social-top a.facebook:hover {
    background-position: -52px -37px;
}

#border #header-wrapper #header-wrapper-upper #social-top a.be {
    background-position: -103px -2px;
}

#border #header-wrapper #header-wrapper-upper #social-top a.be:hover {
    background-position: -103px -37px;
} 
```

# r - R：将元素添加到列表中

> ID：11486348
> 
> 赞同：1
> 
> 时间：2012-07-14T18:35:48.453
> 
> 标签：r

我想问是否可以将元素添加到列表中。例如列表

```
L <- vector("list", 2)
L[[1]] <- vector("list", 2) 
```

我想成为

```
[[1]]
[[1]][[1]]
NULL

[[1]]            # add an element and it becomes [[1]]
[[1]][[2]]                                       [[1]][[2]][[3]]
NULL                                             NULL  

[[2]]
NULL 
```

谢谢大家

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:03:45.923

在列表“L”的代码中，

```
[[1]]
[[1]][[1]] 
```

表示列表中的第一项，`[[1]]`可由 . 引用`L[[1]][[1]]`。

```
[[1]]
[[1]][[2]] 
```

表示中的第二项，`[[1]]`可以被`L[[1]][[2]]`. 因此，要将新元素添加到列表中，您可以使用：

```
L[[1]][[3]] <- vector() 
```

就个人而言，我发现使用命名元素要容易得多，因为跟踪这些括号可能有点乏味。

# c++ - 多个来源中的模板实现

> ID：11486350
> 
> 赞同：2
> 
> 时间：2012-07-14T18:35:49.770
> 
> 标签：c++, templates, header-files, code-cleanup, multiple-definition-error

我使用以下模式将模板声明和实现分开：

* * *

## decl.h（声明）

```
template <typename T>
struct Foo
{
  void DoIt();
} 
```

* * *

## impl.cpp（实现）

```
template <typename T>
void Foo<T>::DoIt() { // impl code 
};

template class Foo<int>;
template class Foo<float>; 
```

* * *

现在我想给 Foo 添加一个新方法，但是 impl.cpp 文件已经很大了，所以我想把它移到一个单独的文件 impl2.cpp 中；

* * *

## decl.h（声明）

```
template <typename T>
struct Foo
{
  void DoIt();
  void RemoveIt();
} 
```

* * *

## impl.cpp（实现）

```
template <typename T>
void Foo<T>::DoIt() { // impl code 
};

template class Foo<int>;
template class Foo<float>; 
```

* * *

## impl2.cpp（实现）

```
template <typename T>
void Foo<T>::RemoveIt() { // impl code 
};

template class Foo<int>;
template class Foo<float>; 
```

* * *

这里主要关注的是重复的实例化，我该如何避免这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:53:37.597

您需要将通用模板参数的实现包含在标头中，并在源文件中包含`T`显式实例化。`int``float`

```
// decl.h
template <typename T>
struct Foo
{
  void DoIt();
  void RemoveIt();
}

#include "impl1.ipp"
#include "impl2.ipp"

// impl1.ipp
template <typename T>
void Foo<T>::DoIt() { // impl code 
};

// impl2.ipp
template <typename T>
void Foo<T>::RemoveIt() { // impl code 
};

// inst.cpp
#include "decl.h"
template class Foo<int>;   // explicit instantiation goes in source file
template class Foo<float>; // explicit instantiation goes in source file

// main.cpp
#include "decl.h"

int main()
{
    // call with concrete template arguments
    Foo<int>::DoIt();
    Foo<float>::RemoveIt();
} 
```

为什么？因为`DoIt`and是函数模板，而不是函数，并且在看到模板传递给它们`RemoveIt`之前无法编译它们。`T`因此，所有客户`Foo`不仅需要包含您的标头，还需要包含您的实现文件。最方便的方法是让标头包含实现。这就是为什么我将它们重命名为`.ipp`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T20:16:55.950

执行以下操作：

1.  将定义移动`Foo<T>::DoIt()`到名为 ImplDoIt.h 的头文件中（不一定与 decl.h 在同一目录中）
2.  相同的`Foo<T>::RemoveIt()`- ImplRemoveIt.h
3.  在您的 impl.cpp 中包含所有这些头文件并实例化模板。

# python - python中奇怪的递归行为

> ID：11486358
> 
> 赞同：2
> 
> 时间：2012-07-14T18:36:56.373
> 
> 标签：python, recursion

我的数独求解器完全按照它应该做的 - 除了*返回*正确的东西。它在返回之前*打印*它应该正确的内容（正确解决的网格），但随后它似乎继续运行一段时间并返回 None。我不知道发生了什么事。

网格是列表的列表。假设如果网格有效（解决与否），check_sudoku 返回 True，否则返回 False。

```
def solve_sudoku(grid, row=0, col=0):
    "Searches for valid numbers to put in blank cells until puzzle is solved."
    # Sanity check
    if not check_sudoku(grid): 
        return None
    # Sudoku is solved
    if row > 8: 
        return grid
    # not a blank, try next cell
    elif grid[row][col] != 0:
        next_cell(grid, row, col)
    else:
        # try every number from 1-9 for current cell until one is valid
        for n in range(1, 10):
            grid[row][col] = n
            if check_sudoku(grid):
                next_cell(grid, row, col)
        else:
            # Sudoku is unsolvable at this point, clear cell and backtrack
            grid[row][col] = 0
            return

def next_cell(grid, row, col):
    "Increments column if column is < 8 otherwise increments row"
    return solve_sudoku(grid, row, col+1) if col < 8 else solve_sudoku(grid, row+1, 0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T18:38:43.397

您正在调用`next_cell`递归，但从不返回它的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:14:47.147

在我看来，这似乎永远不会真正返回有用的东西。我们第一次输入您的`solve_sudoku`时，您检查网格是否已解决，如果已解决，则将其返回。在那之后，你开始了一堆递归，最终将在函数结束时返回并返回 None。无论如何，您总是返回 None 。您最终得到的唯一结果是`grid`您在开始时传入的修改过的参数。

```
def solve_sudoku(grid, row=0, col=0):
    # possible return at the first entry point
    if not check_sudoku(grid): 
        return None

    # only time you would ever NOT get None
    if row > 8: 
        return grid

    ...recurse...

    # come back out when the stack unwinds,
    # and there is no return value other than None 
```

我推测正在发生的事情是，您正在打印沿途的值，并且您确实在它发生的那一刻正确地看到了一个已解决的网格，但是您的函数没有设置为在完成后正确地完全中断。它会继续循环，直到耗尽某个范围，并且您会看到一堆额外的工作。

重要的是检查递归调用的返回值。如果未解决，或者已解决，您将返回 None `grid`。就目前而言，您永远不会关心调用范围内的递归结果。

因为我没有关于您的特定代码的所有详细信息，所以这里有一个简单的等价物：

```
def solver(aList):
    if aList[0] == 10:
        print "SOLVED!"
        return None

    print "NOT SOLVED..."
    return next(aList)

def next(aList):
    # do some stuff
    # check some stuff
    aList[0] += 1
    return solver(aList)

if __name__ == "__main__":
    data = [0]
    solver(data)
    print data 
```

请注意，间接递归调用`checker() -> solver()`的值一直沿链返回。在这种情况下，我们说的`None`是解决方法，否则它应该继续递归。您知道在递归堆栈深处的某个时刻，解决方案将得到解决。您需要立即将其传达回顶部。

通信如下所示：

```
aList == [0]
solver(aList)
  next(...)
    next(...)
      next(...)
        next(...) 
          #SOLVED
        <- next(...)
      <- next(...)
    <- next(...)
  <- next(...)
<-solver(aList)
aList == [10] 
```

如果应用于我的简单示例，您的版本可能如下所示：

```
aList == [0]
solver(aList)
  next(...)
    next(...)
      # SOLVED
      next(...)
        next(...) 
          ...
        <- next(...)
      <- next(...)
    <- next(...)
  <- next(...)
<-solver(aList)
aList == [10] 
```

# r - 以节省内存的方式增长 data.frame

> ID：11486369
> 
> 赞同：46
> 
> 时间：2012-07-14T18:39:02.760
> 
> 标签：r, memory, dataframe

根据[Creating an R dataframe row-by-row](https://stackoverflow.com/questions/3642535/creating-an-r-dataframe-row-by-row)，附加到`data.frame`using并不理想`rbind`，因为它每次都会创建整个 data.frame 的副本。我如何积累数据以`R`导致`data.frame`不产生这种惩罚？中间格式不需要是`data.frame`.

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-14T18:43:29.807

**第一种方法**

我尝试访问预先分配的 data.frame 的每个元素：

```
res <- data.frame(x=rep(NA,1000), y=rep(NA,1000))
tracemem(res)
for(i in 1:1000) {
  res[i,"x"] <- runif(1)
  res[i,"y"] <- rnorm(1)
} 
```

但是tracemem 变得疯狂（例如data.frame 每次都被复制到一个新地址）。

**替代方法（也不起作用）**

一种方法（不确定它是否更快，因为我还没有进行基准测试）是创建一个 data.frames 列表，然后将`stack`它们全部放在一起：

```
makeRow <- function() data.frame(x=runif(1),y=rnorm(1))
res <- replicate(1000, makeRow(), simplify=FALSE ) # returns a list of data.frames
library(taRifx)
res.df <- stack(res) 
```

不幸的是，在创建列表时，我认为您将很难预先分配。例如：

```
> tracemem(res)
[1] "<0x79b98b0>"
> res[[2]] <- data.frame()
tracemem[0x79b98b0 -> 0x71da500]: 
```

换句话说，替换列表的元素会导致列表被复制。我假设整个列表，但它可能只是列表中的那个元素。我对 R 的内存管理的细节并不十分熟悉。

**可能是最好的方法**

与当今许多速度或内存受限的进程一样，最好的方法可能是`data.table`使用`data.frame`. 由于`data.table`具有`:=`按引用分配的运算符，因此无需重新复制即可更新：

```
library(data.table)
dt <- data.table(x=rep(0,1000), y=rep(0,1000))
tracemem(dt)
for(i in 1:1000) {
  dt[i,x := runif(1)]
  dt[i,y := rnorm(1)]
}
# note no message from tracemem 
```

但正如@MatthewDowle 指出的那样，`set()`这是在循环中执行此操作的适当方法。这样做可以让它更快：

```
library(data.table)
n <- 10^6
dt <- data.table(x=rep(0,n), y=rep(0,n))

dt.colon <- function(dt) {
  for(i in 1:n) {
    dt[i,x := runif(1)]
    dt[i,y := rnorm(1)]
  }
}

dt.set <- function(dt) {
  for(i in 1:n) {
    set(dt,i,1L, runif(1) )
    set(dt,i,2L, rnorm(1) )
  }
}

library(microbenchmark)
m <- microbenchmark(dt.colon(dt), dt.set(dt),times=2) 
```

（结果如下所示）

**基准测试**

循环运行 10,000 次后，数据表几乎快了一个数量级：

```
Unit: seconds
          expr        min         lq     median         uq        max
1    test.df()  523.49057  523.49057  524.52408  525.55759  525.55759
2    test.dt()   62.06398   62.06398   62.98622   63.90845   63.90845
3 test.stack() 1196.30135 1196.30135 1258.79879 1321.29622 1321.29622 
```

![基准](../Images/78cbf87604de784012ee7a663784831a.png)

`:=`和与的比较`set()`：

```
> m
Unit: milliseconds
          expr       min        lq    median       uq      max
1 dt.colon(dt) 654.54996 654.54996 656.43429 658.3186 658.3186
2   dt.set(dt)  13.29612  13.29612  15.02891  16.7617  16.7617 
```

请注意，`n`这里是 10^6 而不是上面绘制的基准中的 10^5。因此，工作量增加了一个数量级，结果以毫秒而不是秒为单位。确实令人印象深刻。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-14T20:09:02.730

您还可以有一个空列表对象，其中元素填充有数据框；然后用 sapply 或类似的方法在最后收集结果。一个例子可以在[这里](http://menugget.blogspot.de/2011/11/another-aspect-of-speeding-up-loops-in.html)找到。这不会招致增长对象的惩罚。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-13T23:57:56.903

好吧，我很惊讶没有人提到转换为矩阵...

与[Ari B. Friedman定义的](https://stackoverflow.com/questions/11486369/growing-a-data-frame-in-a-memory-efficient-manner/11486400#11486400 "阿里·弗里德曼")**dt.colon**和**dt.set**函数相比，转换为矩阵的运行时间最好（比**dt.colon**稍快）。矩阵内的所有影响都是通过引用完成的，因此在此代码中没有执行不必要的内存复制。

 **代码：

```
library(data.table)
n <- 10^4
dt <- data.table(x=rep(0,n), y=rep(0,n))

use.matrix <- function(dt) {
  mat = as.matrix(dt)  # converting to matrix
  for(i in 1:n) {
    mat[i,1] = runif(1)
    mat[i,2] = rnorm(1)
  }
  return(as.data.frame(mat))  # converting back to a data.frame
}

dt.colon <- function(dt) { # same as Ari's function
  for(i in 1:n) {
    dt[i,x := runif(1)]
    dt[i,y := rnorm(1)]
  }
}

dt.set <- function(dt) { # same as Ari's function
  for(i in 1:n) {
    set(dt,i,1L, runif(1) )
    set(dt,i,2L, rnorm(1) )
  }
}

library(microbenchmark)
microbenchmark(dt.colon(dt), dt.set(dt), use.matrix(dt),times=10) 
```

结果：

```
Unit: milliseconds
           expr        min         lq     median         uq        max neval
   dt.colon(dt) 7107.68494 7193.54792 7262.76720 7277.24841 7472.41726    10
     dt.set(dt)   93.25954   94.10291   95.07181   97.09725   99.18583    10
 use.matrix(dt)   48.15595   51.71100   52.39375   54.59252   55.04192    10 
```

使用矩阵的优点：

*   这是迄今为止最快的方法
*   您不必学习/使用 data.table 对象

使用矩阵的缺点：

*   您只能处理矩阵中的一种数据类型（特别是，如果您在 data.frame 的列中有混合类型，那么它们都将按行转换为*字符*：**mat = as.matrix(dt) # conversion到矩阵**）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-14T19:46:24.763

我喜欢`RSQLite`这件事：`dbWriteTable(...,append=TRUE)`收集时`dbReadTable`的陈述，最后的陈述。

如果数据足够小，可以使用“:memory:”文件，如果数据大，可以使用硬盘。

当然，它无法在速度方面竞争：

```
makeRow <- function() data.frame(x=runif(1),y=rnorm(1))

library(RSQLite)
con <- dbConnect(RSQLite::SQLite(), ":memory:")

collect1 <- function(n) {
  for (i in 1:n) dbWriteTable(con, "test", makeRow(), append=TRUE)
  dbReadTable(con, "test", row.names=NULL)
}

collect2 <- function(n) {
  res <- data.frame(x=rep(NA, n), y=rep(NA, n))
  for(i in 1:n) res[i,] <- makeRow()[1,]
  res
}

> system.time(collect1(1000))
   User      System verstrichen 
   7.01        0.00        7.05  
> system.time(collect2(1000))
   User      System verstrichen 
   0.80        0.01        0.81 
```

但如果`data.frame`s 有不止一行，它可能看起来会更好。而且您不需要提前知道行数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-26T14:54:08.750

[这篇文章](http://www.win-vector.com/blog/2015/07/efficient-accumulation-in-r/)建议使用 剥离`data.frame`/`tibble`的类属性`as.list`，以通常的方式就地分配列表元素，然后再次将结果转换回`data.frame`/ `tibble`。该方法的计算复杂度呈线性增长，但增长率很小，小于 10e-6。

```
in_place_list_bm <- function(n) {
    res <- tibble(x = rep(NA_real_, n))
    tracemem(res)
    res <- as.list(res)
    for (i in 1:n) {
        res[['x']][[i]] <- i
    }
    return(res %>% as_tibble())
}

> system.time(in_place_list_bm(10000))[[3]]
tracemem[0xd87aa08 -> 0xd87aaf8]: as.list.data.frame as.list in_place_list_bm system.time 
tracemem[0xd87aaf8 -> 0xd87abb8]: in_place_list_bm system.time 
tracemem[0xd87abb8 -> 0xe045928]: check_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
tracemem[0xe045928 -> 0xe043488]: new_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
tracemem[0xe043488 -> 0xe043728]: set_tibble_class new_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
[1] 0.006
> system.time(in_place_list_bm(100000))[[3]]
tracemem[0xdf89f78 -> 0xdf891b8]: as.list.data.frame as.list in_place_list_bm system.time 
tracemem[0xdf891b8 -> 0xdf89278]: in_place_list_bm system.time 
tracemem[0xdf89278 -> 0x5e00fb8]: check_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
tracemem[0x5e00fb8 -> 0x5dd46b8]: new_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
tracemem[0x5dd46b8 -> 0x5dcec98]: set_tibble_class new_tibble list_to_tibble as_tibble.list as_tibble <Anonymous> withVisible freduce _fseq eval eval withVisible %>% in_place_list_bm system.time 
[1] 0.045 
```

这是原始文章中的图片： [![在此处输入图像描述](../Images/f8d20074e3777900f33520c314becccd.png)](https://i.stack.imgur.com/05Byq.png)**

# c# - 从Gridview的可见假BoundField中检索数据

> ID：11486372
> 
> 赞同：7
> 
> 时间：2012-07-14T18:39:11.847
> 
> 标签：c#, gridview, boundfield, rowcommand

我有`BoundField`这个`GridView`

```
<asp:BoundField DataField="ReportId" HeaderText="RId" Visible="false" /> 
```

但是当我尝试在该字段中获取文本时，它返回空。

```
protected void gvwReports_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "ViewSchedule")
    {
        int index = Convert.ToInt32(e.CommandArgument);
        GridViewRow row = gvwReports.Rows[index];
        string s = row.Cells[0].Text;
    }
} 
```

但是，如果我将`BoundField's` `.Visible`属性更改为`true`

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-14T18:52:23.987

尝试使用客户端 html 来隐藏这样的想法

```
<style type="text/css">
     .hidden
     {
         display:none;
     }
</style>

<asp:BoundField DataField="ReportId" HeaderText="RId" HeaderStyle-CssClass="hidden"   >

</asp:BoundField> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-14T06:54:21.427

虽然这是一个有年头的问题（实际上正好有年头），但这是另一个不使用 CssClass 的解决方法。

在数据绑定之后，将所需列的可见性设置为 false。

```
gridview1.databind()
gridview1.columns(i).Visibile = False 
```

这将在视图状态中维护数据，但不会为页面创建标记。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-03T11:50:30.107

第一个解决方案工作正常，但有必要添加**HeaderStyle** 隐藏此列的标题

```
<style type="text/css">
     .hidden
     {
         display:none;
     }
</style>

<asp:BoundField DataField="ReportId" HeaderText="RId"  >
    <ItemStyle CssClass="hidden"/>
    <HeaderStyle CssClass="hidden"/>
</asp:BoundField> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:58:03.770

根据我的知识，当您使绑定字段不可见时，您将无法访问它。尝试使用 TemplateField

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-20T11:24:57.587

我只是有同样的问题。

有趣的是，DataGrid 不会有这个问题，它允许您访问隐藏列中的数据，即使它甚至不会在客户端中呈现它们，因为它仍然会将隐藏列的信息添加到 ViewState。

另一方面，*即使您将 EnableViewState 属性设置为 true，* GridView 也会忽略隐藏字段。唯一的方法是将信息留在那里供客户使用样式属性隐藏，例如*display: none;* .

真的很不幸，我喜欢 DataGrid 的行为，但 GridView 还有其他优点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-14T16:06:08.993

似乎如果 GridView 列被标记为不可见，则它不会在运行时填充，因此它什么也不返回。所以，我只是从绑定到 Gridview 的 DataView 填充超链接，记住将 DataView 声明为共享。

我在 VB asp.net 中为 GridView 执行此操作，该 GridView 从日历数据库中查找搜索事件。

这对我很有用！

```
Private Sub GridView1_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound

  If (e.Row.RowType = DataControlRowType.DataRow) Then

    Dim ThisHyperLink As HyperLink = e.Row.Cells(0).Controls(0)
    Dim drvRow As DataRowView = dvFoundEvents.Item(e.Row.DataItemIndex)

    EventID = drvRow("EventID")
    ThisHyperLink.NavigateUrl = "<URL>?id=" + EventID

  End If

End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-15T15:55:35.973

这对我有用：

如果该列是网格上的命名 DataKeyValue，则可以将从该行发送的 e.Item 转换为 DataGridItem 并调用其 DataKeyValue。您需要将其转换为 Int、String 等，但即使该列是 visible=false，它也会存在。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-15T13:39:01.453

在 rowDataBound 事件中，您可以使用以下方式访问字段的值：

```
(((DataRowView)e.Row.DataItem)["your_boundField_dataFieldName"]).ToString(); 
```

即使您的边界域可见性设置为 false。

# jquery - jQuery - 附加列表，其中包含与 PHP 值一样多的选项

> ID：11486374
> 
> 赞同：1
> 
> 时间：2012-07-14T18:39:16.567
> 
> 标签：jquery, list, append

如果我有一个列表，例如：

```
<ol>
    <li></li>
</ol> 
```

我想附加一个 li 包含一个数字值范围的数字，所以输出是：

```
<? $number = "5"; ?>
<ol>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
</ol> 
```

我怎样才能在 jQuery 中做到这一点？

对于那些想知道我在用这段代码做什么的人，请查看这个 Fiddle：http: [//jsfiddle.net/dnLbV/19/](http://jsfiddle.net/dnLbV/19/)。我正在将 Fiddle 应用于最低的唯一一分钱拍卖，其中出价数量有限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:42:54.297

您不会在 jQuery 中执行此操作，而是在 php 中执行此操作。除非您正在执行 ajax 调用，否则您将在使用 jQuery 加载页面后追加。在 PHP 中你会这样做。

```
<?php $number = "5"; ?>
<ol>
<?php 
    for($index = 1; $index <= $number; $index++)
       echo "<li>$index</li>";
?>
</ol> 
```

除非它响应某种 ajax 请求，否则不要真正看到在 jQuery 中这样做的意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:42:55.737

试试这个：

```
for (var i = 1; i <= 5; i++){
  $('ol').append('<li>'+ i +'</li>')
} 
```

[http://jsfiddle.net/z4PSe/](http://jsfiddle.net/z4PSe/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:42:48.413

jQuery：

```
var li = "";
for(var i=0;i<<?php echo $number;?>;i++){
    li += "<li>" + (i+1) + "</li>";
}
$("#listID").append(li); 
```

HTML：

```
<ol id="listID">
</ol> 
```

请注意，完全有可能在纯 JavaScript 中通过替换`$("#listID").append(li);`为`document.getElementById("listID").innerHTML = li;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T18:44:35.223

```
for(var i =1; i <= <?php echo $number ?>; i++){
    $('<li />').html(i).appendTo('ol');
} 
```

# ember.js - 将普通 JS 对象数组转换为 Ember.js ArrayController

> ID：11486383
> 
> 赞同：2
> 
> 时间：2012-07-14T18:41:04.863
> 
> 标签：ember.js, javascript-objects

我刚刚开始使用 Ember.js 框架，我有一个简单的问题。我将我的数据初始化为普通 JS 对象（填充模板，由我的 PHP 脚本创建），我想在 Ember.Application 启动之前将它们转换为 Ember.js 对象（或者在它启动后立即，我不'还不知道区别）。

这样的事情可能吗？如果是，最好的方法是什么？

例子：

```
App.User = Em.Object.extend({
    id: null,
    avatar: "/path/to/default/avatar.jpg",
    name: null,
});
my_data = [
    {"id":1, "name":"John Doe"}, 
    {"id":2, "name":"Barrack Obama", "avatar":"/president/photo.jpg"}
];
App.usersController = Em.ArrayController.create({
    content: [],
    addUser: function(user) { ... },
}); 
```

我需要这样的东西：

```
App.usersController.initialize(my_data); 
```

编辑：还有一件事。我的数据与 Ember 对象的格式不完全相同，因此我需要进行一些转换。举个例子，假设我将头像和名字包裹在另一个对象中，如下所示：

```
{
  "id":2, 
  "info": {
      "name":"Barrack Obama", 
      "avatar":"/president/photo.jpg"
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T09:07:20.753

您可以使用该`map`函数来“转换”您的数组，请参阅[http://jsfiddle.net/pangratz666/agp8C/](http://jsfiddle.net/pangratz666/agp8C/)：

```
App.usersController = Em.ArrayController.create({
    content: [],
    initWithDataFromServer: function(hash){
        var users = hash.map(function(item){
            return App.User.create({
                id: item.id,
                name: item.info.name,
                avatar: item.info.avatar
            });
        });
        this.pushObjects(users);
    }
});
App.usersController.initWithDataFromServer(my_data); 
```

# selenium - 可以在 Jenkins 中安排 TestNG XML 构建文件吗？

> ID：11486384
> 
> 赞同：0
> 
> 时间：2012-07-14T18:41:25.247
> 
> 标签：selenium, jenkins, testng

我想使用 TestNG Build xml 文件在 Jenkins 中安排一个 TestNG 测试套件。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T06:25:13.907

最好的解决方案是通过 ant build.xml 文件调用您的 testng.xml，这在 Jenkins 中本机支持。[测试和蚂蚁](http://testng.org/doc/ant.html)

# android - 从 listview 中的 edittet 获取文本

> ID：11486390
> 
> 赞同：1
> 
> 时间：2012-07-14T18:42:11.310
> 
> 标签：android, listview, android-arrayadapter, android-edittext

我有一个带有按钮的微调器，下面有一个带有 textview 和 edittext 的列表视图。

当我单击按钮时，我将微调器值传递给 listview 内的 textview，然后我想捕获 edittext 行的文本。

当我失去对edittext的关注时，文本为空，为此我设置了onFocuChanged监听器，但我无法从edittext获取文本。我试图设置一个 TextChangeListener，但这不起作用。还有其他想法吗？

这是列表视图的数组适配器：

```
 public class gremioAdapter extends ArrayAdapter<Gremio> {

        Context context;
        int layoutResourceId;
        ArrayList<Gremio> data = null;
        protected String comentarioAlEdiText;

        public gremioAdapter(Context context, int layoutResourceId,
                ArrayList<Gremio> data) {
            super(context, layoutResourceId, data);
            this.layoutResourceId = layoutResourceId;
            this.context = context;
            this.data = data;
        }

        public void updateDataSet(Gremio objetoGremioAnadir) {
            this.data.add(objetoGremioAnadir);
            notifyDataSetChanged();

        }

        public void updateDataSet(Gremio objetoGremioAnadir, int posicion) {
            this.data.add(posicion, objetoGremioAnadir);
            notifyDataSetChanged();

        }

        public void updateDataSet(String comentario, int posicion) {
            this.data.get(posicion).comentario = comentario;
            notifyDataSetChanged();

        }

        @Override
        public View getView(final int position, View convertView,
                ViewGroup parent) {
            View row = convertView;
            GremioHolder holder = null;

            if (row == null) {
                LayoutInflater inflater = (LayoutInflater) context
                        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                row = inflater.inflate(layoutResourceId, parent, false);

                holder = new GremioHolder();
                holder.tvGremio = (TextView) row.findViewById(R.id.tvGremio);
                holder.etComentario = (EditText) row
                        .findViewById(R.id.etComentario);
                holder.cbActivo = (CheckBox) row
                        .findViewById(R.id.cbGremioActivo);

                row.setTag(holder);
            } else {
                holder = (GremioHolder) row.getTag();
            }

            Gremio gremioFinal = data.get(position);
            holder.tvGremio.setText(gremioFinal.literal);
            holder.etComentario.setText(gremioFinal.comentario);

            holder.etComentario
                    .setOnFocusChangeListener(new OnFocusChangeListener() {

                        @Override
                        public void onFocusChange(View v, boolean hasFocus) {

                            seteaTextoAlComentario(position);

                        }
                    });

            return row;
        }

        protected void seteaTextoAlComentario(int position) {
            data.get(position).comentario = comentarioAlEdiText;
            adaptadorListaGremios.notifyDataSetChanged();
        }

        public class GremioHolder {
            TextView tvGremio;
            EditText etComentario;
            CheckBox cbActivo;
        }
    }

} 
```

这是将微调器值添加到列表视图的代码

```
btnAnadirGremio.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                gremioQueQuiereAnadir = spinnerGremios.getSelectedItem()
                        .toString();
                codigoDelGremio = respuestaTerminar
                        .getListaGremiosDisponibles().get(gremioClickeado)
                        .getCodigo();
                Gremio objetoGremioAnadir = new Gremio();
                objetoGremioAnadir.setCodigo(codigoDelGremio);
                objetoGremioAnadir.setLiteral(gremioQueQuiereAnadir);
                objetoGremioAnadir.setCodigo(respuestaTerminar
                        .getListaGremiosDisponibles().get(gremioClickeado)
                        .getCodigo());
                objetoGremioAnadir.setComentario("");
                adaptadorListaGremios.updateDataSet(objetoGremioAnadir);

            }
        }); 
```

# javascript - HTML5 - 逐帧动画不起作用

> ID：11486395
> 
> 赞同：0
> 
> 时间：2012-07-14T18:42:44.693
> 
> 标签：javascript, html, canvas

我有这个帧动画，每帧每 1/30 秒调用一次。

画布根本没有被正确清除。为什么？

这是代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title></title>

<script src="http://code.createjs.com/easeljs-0.4.2.min.js" ></script>
<script src="http://code.createjs.com/tweenjs-0.2.0.min.js" ></script>

<script>
var canvas;
var stage;
var screen_width;
var screen_height;
var bmpAnimation;

// this is a list of keyframes for each image parameter to be animated
var beachX = new Array(102,130,140,200, 233, 211, 133, 455,222);
var beachY = new Array(52,120,240,400, 102,130,140,200, 233);
var beachRotation = new Array(102,30,140,200, 33, 211, 133, 355,222);
var beachOpacity = new Array(0, 0.5, 1, 0.3, 0.8, 0.3, 0.9, 0.3, 1);
var beachScaleX = new Array(0, 0.5, 0.7, 0.3, 0.8, 1, 0.9, 0.2, 1);
var beachScaleY = new Array(0.3, 0, 0.5, 0.7, 0.3, 0.8, 1, 0.9, 1);

var index = 0;

var beach;

var context;
var interval;

window.onload = init;

function make_beach()
{
  beach = new Image();
  beach.src = "beach.png"; // this can be any image that is large (at least 600 x 600 pixels)
  beach.onload = function(){
    context.drawImage(beach, 70,120);
  }
}

function init() {
        canvas = document.getElementById("myCanvas");
    context = canvas.getContext('2d');
    context.save();

    make_beach();

    interval = setInterval("tick()",33);

    stage = new Stage(canvas);

}

function degreesToRadians(num) {
    return num * 0.0174532925199432957;
}

function tick() {

    var numberOfFrames = beachX.length;
    if (index > (numberOfFrames -1)) {
            clearInterval (interval); // cancel the timer
        return;
    }

    context.restore();

    context.globalAlpha = 1;
    context.clearRect(0, 0, canvas.width, canvas.height);

    var beachMiddleX = beach.width * 0.5;
    var beachMiddleY = beach.height * 0.5;
    context.translate(beachX[index] + beachMiddleX, beachY[index] + beachMiddleY);
    context.scale(beachScaleX[index], beachScaleY[index]);
    context.rotate(degreesToRadians(beachRotation[index]));
    context.globalAlpha = beachOpacity[index];
    context.translate(-beachMiddleX, -beachMiddleY);
    context.drawImage(beach, beachX[index], beachY[index]);
    context.restore();

    index ++;
}

</script>
</head>

<body>
<div class="description">

    </div>
    <div class="canvasHolder">
        <canvas id="myCanvas" width="1024" height="768" style="background-color:#FFFFFF">
            Your browser doesn't support canvas. Please download a modern browser 
        </canvas>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:15:49.300

好吧，看起来非常奇怪的第一件事是您`context.save`在 init 函数中有一个单独的调用，而没有匹配的调用`restore`. 这是不好的。

然后在你的`tick`函数中你有两个调用`restore`！

所以你的程序保存一次，然后恢复一百万次。无论你试图做什么，这肯定不是你想要的。

这是您的固定代码，并且计时器减慢了很多。它似乎做了一些事情，虽然我不知道你的意图是什么，所以很难说它是否是你想要的：

[http://jsfiddle.net/simonsarris/LJQpM/](http://jsfiddle.net/simonsarris/LJQpM/)

# css - 如何更改所选内容的颜色

> ID：11486399
> 
> 赞同：1
> 
> 时间：2012-07-14T18:43:06.707
> 
> 标签：css, css-selectors

谁能告诉我如何更改所选内容的颜色？em 使用这个 css

```
::selection {
        background: #ffb7b7; /* Safari */
        }
::-moz-selection {
        background: #ffb7b7; /* Firefox */
} 
```

它工作得很好，但不是我想要的，它改变了所选文本的颜色，但没有选择空格/间隙，空格/间隙是用默认的蓝色选择的，有什么补救措施吗？检查我的博客并尝试选择空格/间隙然后你知道它有什么问题..等待你的帮助:) [http://kownleg.blogspot.com](http://kownleg.blogspot.com)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:01:36.667

有些区域以深蓝色突出显示，但老实说，我认为您对此无能为力。

实际上看起来 ::selection 伪元素只有少数浏览器实验性地支持，而且看起来它不会很快被添加到任何其他浏览器中。 [有关更多信息，请参阅此链接](https://developer.mozilla.org/En/CSS/%3a%3aselection)

# spring - 自动装配的 spring bean 不是代理

> ID：11486401
> 
> 赞同：9
> 
> 时间：2012-07-14T18:43:43.630
> 
> 标签：spring, service, proxy, target, autowired

我正在开发一个连接到 MySQL 数据库的非常小的应用程序。

我正在尝试创建表记录，但得到“没有正在进行的事务”。

我有所有正确的东西：

*   服务接口 MyService 及其实现 MyServiceImpl
*   我已经用@Service 注释了服务实现
*   在控制器中，我使用了 @Autowired MyService 字段的接口名称
*   我有正确的事务配置，因为它最初是由 roo 生成的
*   MyServiceImpl 实现了一个公共方法 MyService.create(...)

但，

当我远程调试并检查控制器的 myService 字段时，我看到的是 com.some.package.services.MyService@12345 （而不是 $Proxy73 之类的东西），这对我来说是不对的，因为应该自动连接的是代理不是他的目标豆（这就是我认为的）。如果我是正确的，那么没有事务是有道理的，因为只有在代理上调用使用 @Transactional 注释的公共方法时，注释才会生效。

请告诉我为什么 spring 在这个设置中注入目标 bean。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-14T21:32:46.810

如果您有启用 AspectJ 的事务管理 ( `<tx:annotation-driven mode="aspectj" .../>`)，事务的应​​用程序*就地发生*在同一个类中，无论是在构建期间（编译时编织）还是在启动时（加载时编织）。

没有创建新的类（比如使用[cglib](/questions/tagged/cglib "显示标记为“cglib”的问题")时），也没有代理（比如 Spring 中基于接口的普通 AOP）。相反，字节码`MyServiceImpl`被直接修改了，您甚至都没有注意到。不幸的是，查看 AOP 的唯一方法是反编译您的类。如果您使用`javap -c MyServiceImpl`，您会发现大量对 Spring 事务层的引用。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-10-15T06:45:41.447

如果您使用 Spring MVC，请确保仅在 servlet 上下文文件中扫描特定的控制器类。否则它将扫描 2 次并且事务在应用程序上下文中不可用。

# dns - 如何将子域重定向到另一个网站？

> ID：11486402
> 
> 赞同：2
> 
> 时间：2012-07-14T18:43:44.800
> 
> 标签：dns, subdomain, hosting

我从 godaddy.com 购买了域名 www.mydomain.com。我将它托管在 www.000webhost.com（免费的网络域托管站点）。我通过000webhost的ccpanel创建了一个子域subdomain.mydomain.com。

我希望将该子域转移到我的博客[http://myblog.blogspot.in/](http://myblog.blogspot.in/)

现在我的`subdomain`根文件夹中有一个文件夹。我应该在该文件夹中上传什么以便将其重定向到我的博客？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T18:51:47.670

大多数域名注册商都提供免费的重定向服务，我认为 GoDaddy 也提供。为什么不这样做呢？

如果您想获得更多技术知识，则可以通过几种方式（按难度顺序）（在代码中）完成重定向。

*   帧。欢迎回到 1999-2002。只需放置一个静态 HTML`<frameset>`页面并将您的目标页面加载到整个页面框架中。你的用户会讨厌你。
*   `<meta>`重定向。1990 年代后期网页设计学院的另一个主要内容。放入`<meta http-equiv="refresh" content="5;URL='http://example.com/'" />`您的 HTML 页面。
*   Javascript 重定向。`<script>`在您的页面调用中的一个块中`window.location = "http://www.example.com";`
*   服务器端重定向。所有服务器端重定向都是通过设置`Location:`HTTP 标头来完成的。如何执行此操作取决于您的服务器平台：
    *   PHP：`header('Location: [http://www.example.com](http://www.example.com)');`
    *   ASP：（`Response.Redirect("http://www.example.com")`也适用于 ASP.NET）
    *   ASP.NET MVC：（`return Redirect("http://www.example.com");`调用内部控制器操作方法）
    *   .htaccess：有点复杂。请参阅下面的链接。

这里有各种平台和语言的大量重定向：[http ://www.webconfs.com/how-to-redirect-a-webpage.php/](http://www.webconfs.com/how-to-redirect-a-webpage.php/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T18:07:56.203

从技术上讲，您可以从域管理器中使用 Go Daddy 子域转发功能。[http://support.godaddy.com/help/article/4040/managing-a-domain-names-forwarded-subdomains](http://support.godaddy.com/help/article/4040/managing-a-domain-names-forwarded-subdomains)

添加后，您需要将实际托管 DNS (www.000webhost.com) 的 A 记录子域指向 Go Daddy 转发 IP 64.202.189.170。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-14T18:46:42.443

Use either a .htaccess file or create a PHP script with the following:

```
<?php
header('HTTP/1.1 301 Moved Permanently');
header('Location: http://the-network-king.blogspot.in'); 
```

To create a 301 redirect.

and save the file under name `index.php` else it wont pick up file.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-21T07:37:06.210

我不熟悉 www.000webhost.com，但如果他们使用 cPanel，您应该可以在 cPanel 中轻松完成此操作。只需在“域”部分中选择“重定向”即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-08T00:28:52.713

让您的网站位于[CloudFlare](http://cloudflare.com)后面是一个好主意，但如果您只需要重定向，他们会提供“[页面规则](https://blog.cloudflare.com/introducing-pagerules-fine-grained-feature-co/)”

# c - Cross platform method of getting abbreviated weekday name

> ID：11486411
> 
> 赞同：1
> 
> 时间：2012-07-14T18:45:22.677
> 
> 标签：c, cross-platform

```
#include <langinfo.h>
#include <stdio.h>

int main(int argc, char **argv){

char *firstDayAb;
firstDayAb = nl_langinfo(ABDAY_1);
printf("\nFirst day ab is %s\n", firstDayAb);

return 0;
} 
```

This code works fine on Mac and Linux but it doesn't work on windows due to absence of langinfo.h. How to avoid using langinfo.h? Or maybe there is another way of getting abbreviated weekday name?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:04:14.817

```
#include <stdio.h>
#include <time.h>

int main ()
{
  struct tm timeinfo = {0};
  char buffer [80];
  timeinfo.tm_wday = 1;
  strftime (buffer, 80, "First day ab is %a", &timeinfo);
  puts (buffer);      
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:55:31.173

我发现[这里给出了头文件的链接代码](http://www.koders.com/c/fid9E9EC2584CF169CC6F2203C0C088282937E4B449.aspx?s=file%3awindows.h)。它在 Windows 上使用 KDE32。我希望这可以帮助你。

# php - How to check whether a user is logged in on another domain?

> ID：11486413
> 
> 赞同：0
> 
> 时间：2012-07-14T18:45:35.583
> 
> 标签：php, session, cookies

I would like to build a community page for a browser game community (the browser game is not mine, so I can not add any code). Now I would like to check on my website whether the user is logged in into the browser game. Only in that case the user should be able to see the content. Since you cannot read cookies, which were set on another domain, is there any possible way to achieve this?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:53:41.780

您可以使用 CAS 之类的东西。中央身份验证服务器，其中，当未为第一个域设置会话时，它将是这样的：

### 域`example.net`：

```
<?php
session_start();
if(!isset($_SESSION["user"]))
{
    header('Location: http://auth.example.com/?from=example.net');
    die();
}
// Rest of the content!
?> 
```

### 对于域`auth.example.com`：

```
<?php
session_start();
if(!isset($_SESSION["user"]))
{ ?>
    <!-- form to get login credentials -->
<?php } else {
     if(isset($_GET["from"]) && isset($_SESSION["user"]))
         header('Location: http://example.net/auth.php?authcode=' . yourEncryptFunction($_SESSION["user"]));
} ?> 
```

### 希望这可以帮助！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:56:31.620

如果您控制这两个域，则可以这样做。一种简单但不安全的方法是使用 JavaScript 来破坏同源策略。在浏览器游戏中运行一个简单的脚本，例如：

```
<?php
$info = array(
    'isLoggedIn' => $_SESSION['isLoggedIn'],
    'loggedInAs' => $_SESSION['userName']
    );
echo "gameInfo = ".json_encode($info).";"; 
```

在您的社区页面上，您可以使用 JavaScript 来确定他们是否已登录：

```
<script src="http://gamesite.com/jsGameStatus.php"></script>
<script>
alert(gameInfo.isLoggedIn 
    ? 'Logged In as '+gameInfo.loggedInAs 
    : 'Not logged in');
</script> 
```

同样，不是超级安全（有人可能会捏造这些值）。如果您想要更安全的东西，您将需要能够以某种方式将双方联系在一起 - 您的社区用户帐户将必须知道他们的游戏帐户 ID 是什么，然后您可以使用一个简单的从社区站点远程调用以了解游戏用户是否已登录。

# objective-c - Effectively sorting objects in an array using multiple NSSortDesciptors

> ID：11486416
> 
> 赞同：2
> 
> 时间：2012-07-14T18:46:05.940
> 
> 标签：objective-c, ios, arrays, sorting

I have an array of dictionaries. Each dictionary holds data about an individual audio track. My app uses a star rating system so users can rate track 1-5 stars. Each dictionary has its own rating data per track, as follows:

*   `avgRating` (ex: 4.6)
*   `rating_5_count` (integer representing how many 5-star ratings a track received)
*   `rating_4_count`
*   `rating_3_count`
*   `rating_2_count`
*   `rating_1_count`

I'm trying to create a Top Charts table in my app. I'm creating a new array with objects sorted by `avgRating`. I understand how to sort the objects using `NSSortDescriptors`, but here is where I'm running into trouble...

If I only use `avgRating` as a sort descriptor, then if a track only receives one 5-star rating, it will jump to the top of the charts and beat out a track that might have a 4.9 with hundreds of votes.

I could set a minimum vote count to prevent this in the Top Charts array, but I would rather not do this. I would then have to change the min vote count as I get more users.

This is a bit subjective, but does anyone have any other suggestions on how to effectively sort the array?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:16:11.883

是的，向您的类添加一个方法，该方法返回根据平均投票数和投票数计算的权重。显然，重量的神奇公式取决于您。像 avgRating * log2 (2 + number_of_votes) 这样的东西可能会做到这一点。然后使用按此方法排序的单个排序描述符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:21:13.110

有很多方法可以处理这种情况。

一种方法可能是将投票数视为对评级平均值的置信度的衡量标准。从平均设置为 3 开始（每个示例）。

```
const double baseConfidenceRating = 3;
NSUInteger averageRating = ...;
NSUInteger voteCount = ...;

const NSUInteger baseConfidence = log10( 1000 );
double confidence = log10( 1 + voteCount ) / baseConfidence;
double confidenceWeight = fmin( confidence, 1.0 );

double confidenceRating = (1.0 - confidenceWeight) * baseConfidenceRating + confidenceWeight * averageRating; 
```

现在根据`confidenceRating`而不是对数组进行排序`averageRating`。

您可以通过更改需要多少票来调整上面的算法，使 confidenceRating 等于 averageRating，当然，您可以更改我在示例中使用的函数。平方根也可以工作，或者为什么不是线性进展。你的来电。

当然，这只是一个例子，一个非常愚蠢的例子。投票的标准差可能会在算法中增加一些智能，不仅要考虑投票的数量，还要考虑投票的分布。100 票对 100 票 5 比 1000 票随机散布在 0 和 5 之间更“自信”。我想。

# java - How do I get Twitter4J to stream posts with a certain hashtag?

> ID：11486417
> 
> 赞同：3
> 
> 时间：2012-07-14T18:46:12.087
> 
> 标签：java, twitter, twitter4j

When I search for a given hashtag, I get the results for recent tweets containing that hashtag. This is what I want to stream, So if any new tweets with this hashtag are made I will know.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:55:03.890

```
Twitter twitter = new TwitterFactory().getInstance();
try {
    QueryResult result = twitter.search(new Query("#myhashtag"));
} catch (TwitterException te) {
    te.printStackTrace();
} 
```

[资源](https://github.com/yusuke/twitter4j/blob/master/twitter4j-examples/src/main/java/twitter4j/examples/search/SearchTweets.java)

您可能需要转义`#`符号

# c# - loading data into dataGridView from C structures

> ID：11486422
> 
> 赞同：1
> 
> 时间：2012-07-14T18:46:41.677
> 
> 标签：c#, datagridview, structure

I am trying to create a data visualizer in c# for an array of structures created in a C legacy app. I believe that the best way to do this is to use a winforms dataGridView. I am unable to find any examples here or on the Internet of doing such a thing.

Can anyone either point me to an example, or at least an example of where I might start?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-05T09:05:41.613

网上找不到例子。叹。

# ruby-on-rails - Accessing associations of a model

> ID：11486425
> 
> 赞同：0
> 
> 时间：2012-07-14T18:47:04.973
> 
> 标签：ruby-on-rails, ruby

assume you have a case like this

```
class Artist < ActiveRecord::Base
  has_many :albums
  belongs_to :record_label

  def albums
    return 5
  end
end 
```

Is it possible to access the albums relationship without using the Artist#albums, since it has been overridden?

This can happen with mixins or other random cases, it is mostly helpful for tests. Then you can say Artist#albums is actually a relationship to albums

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T22:13:57.693

使用[`association`](https://github.com/rails/rails/blob/v3.2.6/activerecord/lib/active_record/associations.rb#L152)，并检索其范围：

```
a = Artist.first
a.association(:albums).scoped 
```

请注意，`association`它没有记录，它返回的对象 ( [`ActiveRecord::Associations::Association`](https://github.com/rails/rails/blob/v3.2.6/activerecord/lib/active_record/associations/association.rb)) 也没有记录，这意味着[`scoped`](https://github.com/rails/rails/blob/v3.2.6/activerecord/lib/active_record/associations/association.rb#L86)也没有记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:02:35.563

请问-为什么需要覆盖`#albums`？这样做的缺点是违反了最小惊喜原则——每个人都希望`#albums`归还艺术家的专辑。

否则，我会简单地通过`Album.where(artist_id: artist.id)`.

# actionscript-3 - Check For Type with String in AS3

> ID：11486427
> 
> 赞同：1
> 
> 时间：2012-07-14T18:47:32.017
> 
> 标签：actionscript-3, types

Say you have an object,

> var obj:Object = someOtherObject;

And you need to check if it is of the type with the name stored in myString

> var myString:String = someOtherString; // ex. "int", "Number", "CustomClass"

I have tried:

> if(obj is getDefinitionByName(myString))

But that doesn't seem to work. How would you go about doing this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:56:36.760

这对我有用：

```
var obj:Object = 5;

var myString:String = "int";

var c:Class = getDefinitionByName(myString) as Class;
if (c && obj is c)
{
    trace("obj is of type "+myString);
} 
```

getDefinitionByName 的返回类型是 Object，因此将其转换为 Class 似乎可以解决问题。

# language-agnostic - Redis sorted set by string values

> ID：11486428
> 
> 赞同：2
> 
> 时间：2012-07-14T18:47:42.693
> 
> 标签：language-agnostic, redis, sorted

Suppose you have a hash 'users' whose entries map numeric IDs to JSON-encoded arrays, so, for instance, the integer 1 maps to the string {name: 'John', surname: 'Doe', occupation: 'plumber'}.

The numeric IDs of items in the hash are stored in various lists. Thus, if 'foobar' is one of these lists, to retrieve the actual data from it I would run a simple Lua script (implementing a server-side join operation). Or, as I've just learned, I could use something like

```
SORT foobar BY inexistent_key GET user:* 
```

but that implies storing each user's data into a separate key which seems expensive (in my case I have many small collections so I want to take advantage of Redis compression of hashes).

The question is finally this: I need to keep these lists ordered alphabetically by, say, each user's surname, then by name. What is the best way to achieve this, without changing too much the underlying data model (if possible)?

So far the best I could think of was using the SORT command together with the BY and STORE clauses, that is, running

```
SORT foobar BY surname:* STORE foobar 
```

whenever the list is changed, but that way I'd need many keys. If I could use a hash in the BY clause that would be the ideal solution, it seems to me.

If the fields I want to sort by were somehow limited (as in, just a couple hundred surnames) I could think of mapping strings to integers and use a Redis sorted set, but this doesn't seem to be the case.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T16:10:09.233

您可以按哈希键排序，而无需 Lua 脚本的复杂性，但您必须将 Json 结构中的键复制到 Redis 的哈希键。

以下示例具有以下结构：

**users**是查询中包含用户 ID 的集合。

**user:X**是包含重复*姓名*/*姓氏*数据的 Redis 哈希。

**userdata:X**是您的原始用户 Json 哈希。

* * *

```
redis> hmset user:1 name First surname User
OK
redis> set userdata:1 "{occupation: 'Tester'}"
OK
redis> hmset user:2 name Last surname Violet
OK
redis> set userdata:2 "{occupation: 'Bookseller'}"
OK
redis> hmset user:3 name Middle surname Veredict
OK
redis> set userdata:3 "{occupation: 'Judge'}"
OK
redis> hmset user:4 name Ultimate surname Veredict
OK
redis> set userdata:4 "{occupation: 'Ultimate Judge'}"
OK
redis> sadd users 1
(integer) 1
redis> sadd users 2
(integer) 1
redis> sadd users 3
(integer) 1
redis> sadd users 4
(integer) 1
redis> sort users by user:*->surname get user:*->name get user:*->surname get userdata:* alpha
1) "First"
2) "User"
3) "{occupation: 'Tester'}"
4) "Middle"
5) "Veredict"
6) "{occupation: 'Judge'}"
7) "Ultimate"
8) "Veredict"
9) "{occupation: 'Ultimate Judge'}"
10) "Last"
11) "Violet"
12) "{occupation: 'Bookseller'}" 
```

## 编辑

我忽略了多个`By`只考虑最后一个子句。因此，您不能在一个命令中按多个键进行排序。

此外，`SORT`用于词典排序的命令现在需要`alpha`修饰符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T08:31:54.113

最后，在我看来，解决我的问题的一种方法是使用 Lua 中可用的 table.sort() 函数。除了小散列“用户”和小 ID 列表“foobar”之外，我还引入了另一个小散列，比如“用户：排序字符串”，我在其中存储了我想在 ' 中对 ID 进行排序的字符串foob​​ar'（在虚构的例子中是姓氏和名字的组合）。为了对 'foobar' 进行排序，我将在 Redis 中运行以下 Lua 片段，作为键 'foobar'、'users:sort-strings' 和 'foobar:tmp' （临时键）传递。

```
local lst = redis.call('LRANGE', KEYS[1], 0, -1)
local sort_function = function (id0, id1)
   local s0 = redis.call('HGET', KEYS[2], id0)
   local s1 = redis.call('HGET', KEYS[2], id1)
   return (s0 < s1)
end
table.sort(lst, sort_function)
for key, value in ipairs(lst) do
   redis.call('RPUSH', KEYS[3], value)
end
redis.call('DEL', KEYS[1])
redis.call('RENAME', KEYS[3], KEYS[1]) 
```

# java - Start new activity in PagerAdapter

> ID：11486430
> 
> 赞同：1
> 
> 时间：2012-07-14T18:47:50.970
> 
> 标签：java, android, tabs, android-viewpager

I'm using [ViewPagerExtensions](https://github.com/astuetz/ViewPagerExtensions). I would like to start a new activity in each tab in the Pager Adapter class.

Right now this is the default code:

```
@Override
public Object instantiateItem(ViewGroup container, int position) {

    RelativeLayout v = new RelativeLayout(mContext);

    TextView t = new TextView(mContext);
    t.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.FILL_PARENT));
    t.setText(mData[position]);
    t.setTextSize(30);
    t.setGravity(Gravity.CENTER);

    v.addView(t);

    ((ViewPager) container).addView(v, 0);

    return v;

} 
```

I would like to do something as it is done for the android tabs:

```
@Override
public Object instantiateItem(View container, int position) {

    // Create an Intent to launch an Activity for the tab (to be reused)
        intent = new Intent().setClass(this, NewActivity.class);

} 
```

This throws the error: `The method setClass(Context, Class<?>) in the type Intent is not applicable for the arguments (PagerAdapter, Class<NewActivity>)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T14:34:45.363

恐怕你做不到。

如果您想要每个页面的不同布局：

```
View parent_view = null;

    if (position == 0) {
        parent_view = getViewForPageOne();

    } else if (position == 1) {
        parent_view = getViewForPageTwo();

    .........

    ((ViewPager) collection).addView(parent_view, 0);
    return parent_view;

} 
```

和

```
private View getViewForPageOne(){
    View v = getLayoutInflater().inflate(R.layout.layout_page_one, null);
     TextView whatText =(TextView) v.findViewById(R.id.idOfTextView);
     whatText.setText("Page One");
     ....
     ....

     return v;
} 
```

我认为您无法使用 ViewPagerExtensions 在每个选项卡中显示新活动

**更新**

如果你想开始新的活动。您可以使用[ActionBarSherlock](http://actionbarsherlock.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:15:27.773

您是否尝试过夸大这些活动的布局而不是？

```
@Override
public Object instantiateItem(View collection, int position) {
    View layout = inflater.inflate(R.layout.activity_layout, null);

    /** Find your layout Views. */
    TextView text= (TextView) layout.findViewById(R.id.any_id);

    // Set some values to your Views.

    ((ViewPager) collection).addView(layout);

    return layout;
} 
```

# android - web service response fails Soap 2

> ID：11486432
> 
> 赞同：0
> 
> 时间：2012-07-14T18:47:53.880
> 
> 标签：android, asp.net, android-ksoap2

```
package bt.Mobile.abc;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;

public class HelloAndroidActivity extends Activity {
    private static final String APP_TAG = "BT Android";

    // TO VALIDATE THE LOGIN
    private static final String SOAP_ACTION = "http://SmartApp.boothtracker.com/ValidateLogin";
    private static final String METHOD_NAME = "ValidateLogin";
    private static final String NAMESPACE = "*****.com/";
    private static final String URL = "*****.asmx";

    TextView tvUserName;
    TextView tvPassword;
    TextView tvStatus;
    ProgressBar progressBar1;

    /** SelectedBooth used to store the Selected Booths **/
    public String SelectedBooth;

    public String getSelectedBooth() {
        return SelectedBooth;
    }

    public void setSelectedBooth(String SelectedBooth) {
        this.SelectedBooth = SelectedBooth;
    }

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {           
        super.onCreate(savedInstanceState);

        new eula.OnEulaAgreedTo() {

            public void onEulaAgreedTo() {
                // TODO Auto-generated method stub

            }
        };

        // VALIDATE USER LOGIN
        try
        {
            setContentView(R.layout.main);

            // INITIALIZE CONTROLS USED IN FORM
            tvUserName=(TextView)findViewById(R.id.editText1);
            tvPassword=(TextView)findViewById(R.id.editText2);
            tvStatus=(TextView)findViewById(R.id.txtStatus);

            progressBar1 = (ProgressBar)findViewById(R.id.progressBar1);
            progressBar1.setVisibility(View.GONE);

            Button b = (Button)findViewById(R.id.btnSignIn);            
            b.setOnClickListener(new View.OnClickListener(){
                public void onClick(View arg0){ 

                    progressBar1.setVisibility(View.VISIBLE);
                    tvStatus.setText("Processing...");

                    try {
                        // INVOKE THE WS TO GET THE LOGIN VALIDATED 
                        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);                       
                        request.addProperty("UserName", tvUserName.getText().toString());`enter code here`
                        request.addProperty("Password", tvPassword.getText().toString());                   
                        Toast.makeText(getApplicationContext(), ("Connecting"), Toast.LENGTH_LONG).show();
                        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);                     
                        envelope.dotNet=true;
                        envelope.setOutputSoapObject(request);
                        Toast.makeText(getApplicationContext(), (URL), Toast.LENGTH_LONG).show();
                        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
                        androidHttpTransport.call(SOAP_ACTION, envelope);                   
                        Toast.makeText(getApplicationContext(), ("Sending"), Toast.LENGTH_LONG).show();
                        Object result = (Object)envelope.getResponse();

                        String strResult = result.toString();

                        progressBar1.setVisibility(View.GONE);

                        if  (strResult.equals("True"))
                        {
                            //LOGIN WAS SUCESSFULL - PROCED TO NEXT PAGE
                            tvStatus.setText("Login Successfull, Please Wait...");
                            tvPassword.setText("");
                            Intent i = new Intent(HelloAndroidActivity.this, newfile.class);
                            startActivity(i);
                            finish();
                        }
                        else
                        {
                            // LOGIN FAILED TO AUTHENTICATE
                            Toast.makeText(getApplicationContext(), ("Invalid Username and Password"), Toast.LENGTH_LONG).show();
                            tvStatus.setText("Invalid username & password");
                            tvPassword.setText("");
                        }

                    } catch (Exception e) {
                        // LOGIN FAILED; NOTIFY THE USER AND WAIT
                        Toast.makeText(getApplicationContext(), (e.getMessage()), Toast.LENGTH_LONG).show();
                        tvStatus.setText("Connection Failure");
                        tvStatus.setText(e.getMessage());
                        tvPassword.setText("");
                    }
                }
            });
        }
        catch (Exception e)
        {
            Log.e(APP_TAG, Log.getStackTraceString(e));
        }
    }
} 
```

I am new to Android, I created a small app and calling a web method. It was always working fine but all of a sudden stopped working,it does not connect to WS. I am using KSOAP2\. I am able to access WS through browser. I did not make any change to the code It was working all fine at the time of deliverable it stopped functioning.

Version- GingerBread, Using Eclipse, WS is asmx. I am using KOSAP2 with 2.6.5 jar..please help me it very critical

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:28:30.533

代替

```
 Object result = (Object)envelope.getResponse(); 
```

尝试使用

```
 SoapPrimitive result = (SoapPrimitive) envelope.getResponse(); 
```

# jquery - jQuery Tabs with MODx Revo Formit - on validation error, keep hash in URL

> ID：11486434
> 
> 赞同：0
> 
> 时间：2012-07-14T18:48:07.400
> 
> 标签：jquery, tabs, modx-revolution, formit

I'm trying for several hours to get my Contact-Form work correctly. The form itself has some tabs in it. The code for the tabs I'm using is from this site [http://jqueryfordesigners.com/jquery-tabs/](http://jqueryfordesigners.com/jquery-tabs/)

This is the script-code I'm using:

```
<script type="text/javascript" charset="utf-8">
    $(function () {
        var tabContainers = $('div.tabs > div');
        tabContainers.hide().filter(':first').show();

        $('div.tabs ul.tabNavigation a').click(function () {
            tabContainers.hide();
            tabContainers.filter(this.hash).show();
            $('div.tabs ul.tabNavigation a').removeClass('selected');
            $(this).addClass('selected');
            return false;
        }).filter(':first').click();
    });
</script> 
```

This works well so far. The tabs are being showed correctly as desired. The form I made with the FormIt-Package from Modx Revo works too!

Now the problem...when I click on submit and the validation fails (e.g. the user forgets to fill a mandatory field), the site will be refreshed and the last selected tab is not shown, the page always shows the first tab.

**I want to view the last visited tab on validation error->page reload.**

With this edit I can achieve that the desired tab gets opened via a hash-tag (ID of the tab) in the URL (e.g. www.xyz.com/contact.html?tab=#two):

```
 <script type="text/javascript" charset="utf-8">
        $(function () {
            var tabContainers = $('div.tabs > div');
            tabContainers.hide().filter(':first').show();

            $('div.tabs ul.tabNavigation a').click(function () {
                tabContainers.hide();
                tabContainers.filter(this.hash).show();
                $('div.tabs ul.tabNavigation a').removeClass('selected');
                $(this).addClass('selected');
                return false;
            }).filter(':first').click();

$(document).ready(function(){
     tabContainers.hide();
     tabContainers.filter(window.location.hash).show();
     $('div.tabs ul.tabNavigation a').removeClass('selected');
$(this).addClass('selected');
     return false;
}); 
```

If I enter the site with the above URL, I can view the second tab as desired.

When I finally submit the form and a mandatory field is missing, the page reloads and puts out the errors. But the last viewed tab is not opened, instead none of the tabs is opened, because the URL "looses" it's hash-tag.

**How can I achieve that the last visited/selected tab gets shown on page reload/refresh?**

I tried to add the ID of a tab to the URL with this code inbetween line 10 and 12 in the first script-code:

```
location.hash = this.pathname.substring(3) + this.hash; 
```

This has the effect that the ID gets added to the URL as a hash-tag by clicking on a tab. But on submitting the form, the URL "looses" the hast-tag and refreshes the page. On page load the URL is changed to www.xyz.com/contact.html#one. Whatever I try to type in like www.xyz.com/contact.html#two or www.xyz.com/contact.html#three the URL always changes back to www.xyz.com/contact.html#one

Any hints are appreciated! Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T14:32:57.007

所以现在我已经实现了一个 cookie 功能：

```
 <script type="text/javascript" charset="utf-8">
        $(function () {
            var tabContainers = $('div.tabs > div');
            tabContainers.hide().filter(':first').show();

            $('div.tabs ul.tabNavigation a').click(function () {
                tabContainers.hide();
                tabContainers.filter(this.hash).show();
                $('div.tabs ul.tabNavigation a').removeClass('selected');
                $(this).addClass('selected');
$.cookie("tab", (this.hash)); 
alert($.cookie("tab"));
//location.hash = this.pathname.substring(3) + this.hash;
                return false;
            }).filter(':first').click();
$(document).ready(function(){
     tabContainers.hide();
     tabContainers.filter(window.location.hash).show();
     $('div.tabs ul.tabNavigation a').removeClass('selected');
$(this).addClass('selected');
     return false;
});

        });
    </script> 
```

当我单击一个选项卡时，会设置一个新的 cookie，并且该值会显示在警报中。

**如何在页面加载时读取 cookie 并将 cookie 的值添加到 URL？**

# sorting - 组成两个比较函数？

> ID：11486436
> 
> 赞同：36
> 
> 时间：2012-07-14T18:48:27.157
> 
> 标签：sorting, haskell

我想先按一个属性排序，然后再按另一个（如果第一个属性相同。）

Haskell 中组合两个比较函数的惯用方式是什么，即使用 with 的函数`sortBy`？

给定

```
f :: Ord a => a -> a -> Ordering
g :: Ord a => a -> a -> Ordering 
```

组成`f`并将`g`产生：

```
h x y = case v of
          EQ -> g x y
          otherwise -> v
        where v = f x y 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-14T19:16:39.333

vitus 指出了 for 的一个非常酷的`Monoid`例子`Ordering`。如果你将它与实例结合起来，`instance Monoid b => Monoid (a -> b)`你的组合函数只是（准备好）：

```
mappend 
```

看看这个：

```
Prelude Data.Monoid> let f a b = EQ
Prelude Data.Monoid> let g a b = LT
Prelude Data.Monoid> :t f `mappend` g
f `mappend` g :: t -> t1 -> Ordering
Prelude Data.Monoid> (f `mappend` g) undefined undefined 
LT
Prelude Data.Monoid> let f a b = GT
Prelude Data.Monoid> (f `mappend` g) undefined undefined 
GT 
```

+1 用于强大而简单的抽象

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-12T15:17:07.943

您可以使用`<>`运算符。在此示例`bigSort`中，按字符串的数值对字符串进行排序，首先比较长度，然后按字典顺序进行比较。

```
import Data.List (sortBy)
import Data.Ord (compare, comparing)

bigSort :: [String] -> [String]
bigSort = sortBy $ (comparing length) <> compare 
```

例子：

```
bigSort ["31415926535897932384626433832795","1","3","10","3","5"] = 
        ["1","3","3","5","10","31415926535897932384626433832795"] 
```

`<>`是`mappend`来自`Data.Monoid module`（参见*jberryman*答案）的别名。

（免费）书*Learn You a Haskell for Great Good！*[在第 11 章](http://learnyouahaskell.com/functors-applicative-functors-and-monoids#monoids)中解释了它是如何工作的

> ```
> instance Monoid Ordering where  
>    mempty = EQ  
>    LT `mappend` _ = LT
>    EQ `mappend` y = y
>    GT `mappend` _ = GT 
> ```
> 
> 实例是这样设置的：当我们`mappend`有两个`Ordering`值时，左边的那个被保留，除非左边的值为`EQ`，在这种情况下，右边的就是结果。身份是`EQ`。

# javascript - Calling javascript

> ID：11486438
> 
> 赞同：0
> 
> 时间：2012-07-14T18:48:42.693
> 
> 标签：javascript, package

I am setting up a site that relies on a lot of javascript items and i want to try and set it up so the pages only call what they need. there are different types of functionality so i am goig to break them into their own js files to make it easy to use. For example if there is a drag and drop functionality then i will include the js file for drag and drop. within that will be a generic call using a class to turn on the functionality. This way it is only used on a page that uses drag and drop.

This gets more compacted when i have ajax calls some are on change events on a select for example while others are on a button. I could separate these into different files for each type perhaps.

my concern is if a call needs more parameters to be passed or a different url then where does this code go to make the call?

I don't really want to have code within the page itself if i can help it.

I would love to hear your thoughts on how to best set this up

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T18:51:20.477

[RequireJS](http://requirejs.org/)可能是你的答案：

> RequireJS 是一个 JavaScript 文件和模块加载器。它针对浏览器内使用进行了优化，但也可以在其他 JavaScript 环境中使用，例如 Rhino 和 Node。使用像 RequireJS 这样的模块化脚本加载器将提高代码的速度和质量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T18:51:39.900

这听起来类似于我正在做的事情，所以这里我做了什么：

*   一个包含几乎无处不在的函数的中心文件。
*   包含在多个地方使用但不值得在任何地方都包含的文件的文件夹。
*   包含仅在一页上使用的文件的文件夹。

然后，只需包含必要的`<script>`标签即可！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-14T19:09:57.010

嗯，你看过现有的框架[http://speckyboy.com/2010/05/17/15-javascript-web-ui-libraries-frameworks-and-libraries/](http://speckyboy.com/2010/05/17/15-javascript-web-ui-libraries-frameworks-and-libraries/)吗？

# python - dbus-python how to get response with native types?

> ID：11486443
> 
> 赞同：6
> 
> 时间：2012-07-14T18:49:06.390
> 
> 标签：python, casting, dbus

I'm playing with dbus-python and I need to get the reponses (f.e dbus.Dictionary - but generally any response) as native Python type. Yes, one can write recursive converter but I think I must have been missing something obvious? There must be a way how to convert these monstrosities back to Python native types using dbus. Or it is not?

```
dbus.Dictionary({dbus.String(u'CanGoNext'): dbus.Boolean(True, variant_level=1), dbus.String(u'CanPause'): dbus.String(u'MinimumRate'): dbus.Int32(14, variant_level=1) ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-31T16:01:53.477

虽然 Martin 是对的，但它不适用于由 python 转换为 int 的布尔值（因为 bool[不能被子类化](https://dbus.freedesktop.org/doc/dbus-python/api/dbus.Boolean-class.html)）。

```
In [3]: print(dbus.Boolean(False))
0 
```

不幸的是，递归转换器是保留布尔值的唯一方法。

这是一个示例实现：

```
import dbus

def python_to_dbus(data):
    '''
        convert python data types to dbus data types
    '''
    if isinstance(data, str):
        data = dbus.String(data)
    elif isinstance(data, bool):
        # python bools are also ints, order is important !
        data = dbus.Boolean(data)
    elif isinstance(data, int):
        data = dbus.Int64(data)
    elif isinstance(data, float):
        data = dbus.Double(data)
    elif isinstance(data, list):
        data = dbus.Array([python_to_dbus(value) for value in data], signature='v')
    elif isinstance(data, dict):
        data = dbus.Dictionary(data, signature='sv')
        for key in data.keys():
            data[key] = python_to_dbus(data[key])
    return data

def dbus_to_python(data):
    '''
        convert dbus data types to python native data types
    '''
    if isinstance(data, dbus.String):
        data = str(data)
    elif isinstance(data, dbus.Boolean):
        data = bool(data)
    elif isinstance(data, dbus.Int64):
        data = int(data)
    elif isinstance(data, dbus.Double):
        data = float(data)
    elif isinstance(data, dbus.Array):
        data = [dbus_to_python(value) for value in data]
    elif isinstance(data, dbus.Dictionary):
        new_data = dict()
        for key in data.keys():
            new_data[key] = dbus_to_python(data[key])
        data = new_data
    return data 
```

为了使它更容易在处理 dbus 源数据的类中使用，您可以使用装饰器：

```
def convert_to_python(func):
    def wrapper(*args, **kwargs):
        return dbus_to_python(func(*args, **kwargs))
    return wrapper
...

@convert_to_python
def dbus_method_call(self):
    return self.dbus_proxy.Method() 
```

这样，上面 dbus_method_call 返回的任何数据都将转换为原生 python。

请参阅此相关问题：[dbus Variant: How to preserve boolean datatype in Python?](https://stackoverflow.com/questions/5791095/dbus-variant-how-to-preserve-boolean-datatype-in-python)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:27:16.600

You don't need to. They are subclasses of the native types, so you just use them as if they were native types:

```
>>> import dbus
>>> v = dbus.Dictionary({dbus.String(u'CanGoNext'): dbus.Boolean(True, variant_level=1), dbus.String(u'CanPause'): dbus.Boolean(False, variant_level=1), dbus.String(u'MinimumRate'): dbus.Int32(14, variant_level=1)})
>>> print v['MinimumRate']
14
>>> if v['CanGoNext']: print 'Go'
... 
Go
>>> if v['CanPause']: print 'Pause'
... 
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T15:45:53.877

正如@Martin Vidner 所说，在您的代码中，您无需执行任何操作即可使用它们。

要漂亮地打印，您可以使用现有的“递归转换器”，例如`json`：

```
import json
print(json.dumps(d, indent=2)) 
```

### 输出

```
{
  "MinimumRate": 14, 
  "CanGoNext": 1, 
  "CanPause": 0
} 
```

它丢失了有关类型的信息。

# symfony-2.1 - Symfony2 作曲家添加自己的捆绑要求

> ID：11486446
> 
> 赞同：2
> 
> 时间：2012-07-14T18:49:29.697
> 
> 标签：symfony-2.1, composer-php

如何**通过 composer**将特定的 Bundle（例如 SonataGoutteBundle）安装到我的 Symfony2 项目中？

我试过这个，但它对我不起作用。有什么想法有什么问题吗？

```
"repositories": [
    {
        "type": "package",
        "package": {
            "name": "sonata-project/sonatagouttebundle",
            "version": "dev-master",
            "dist": {
                "url": "https://github.com/sonata-project/SonataGoutteBundle.git",
                "type": "git"
            }
        }
    }
],
"require": {
     "php": ">=5.3.3",
     [...],
     "sonata-project/sonatagouttebundle": "dev-master"
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T19:27:06.260

尝试类似的东西

```
{
    "repositories": [
        {
            "type": "vcs",
            "url": "https://github.com/sonata-project/SonataGoutteBundle.git"
        }
    ],

    "require": {
        "php": ">=5.3.3",
        "vendor/bundle": "dev-master"
    }
} 
```

SonataGoutteBundle**必须**有 composer.json

在这种特殊情况下，这将起作用：

```
"repositories": [
    {
        "type": "package",
        "package": {
            "name": "sonata-project/goutte",
            "version": "dev-master",
            "source": {
                    "url": "https://github.com/sonata-project/SonataGoutteBundle.git",
                    "type": "git",
                    "reference": "master"
                }
        }
    }
],
"require": {
     "php": ">=5.3.3",
     "sonata-project/goutte": "dev-master"
} 
```

有关所有选项，请参阅[文档](http://getcomposer.org/doc/04-schema.md#repositories)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:43:18.767

您应该在“dist”部分提供指向存档（如 zip）的链接。如果你想使用 git，你应该定义“源”部分：

```
{
    "repositories": [
        {
            "type": "package",
            "package": {
                "name": "sonata-project/sonatagouttebundle",
                "version": "dev-master",
                "source": {
                    "url": "https://github.com/sonata-project/SonataGoutteBundle.git",
                    "type": "git",
                    "reference": "master"
                }
            }
        }
    ],
    "require": {
        "php": ">=5.3.3",
        "sonata-project/sonatagouttebundle": "dev-master"
    }
} 
```

有关定义自定义存储库的更多信息：http: [//getcomposer.org/doc/04-schema.md#repositories](http://getcomposer.org/doc/04-schema.md#repositories)

# backbone.js - 更新集合中模型的索引

> ID：11486450
> 
> 赞同：0
> 
> 时间：2012-07-14T18:49:55.887
> 
> 标签：backbone.js

我有一个可通过 jQuery UI 的可排序库 (http://jqueryui.com/demos/sortable/) 排序的歌曲列表（每首歌曲都以专辑封面的形式）。所有歌曲都是驻留在单个集合中的模型。当触发“排序”事件时，我想重新计算歌曲的顺序并更新它们各自的索引。我知道如何在集合中获取模型的索引，但是是否可以更新/设置模型的索引？我意识到我可以在模型上设置一个“订单”属性并更新它，但似乎更新索引会更干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:55:11.637

听起来您需要在集合上定义一个[比较器](http://backbonejs.org/#Collection-comparator)，然后在触发小部件的 sorted 事件时对其调用[sort 。](http://backbonejs.org/#Collection-sort)

# java - 旋转玩家面对行星

> ID：11486453
> 
> 赞同：2
> 
> 时间：2012-07-14T18:50:42.533
> 
> 标签：java, rotation

所以我很难让我的砂矿面对一颗行星。我有玩家和星球之间的角度，我也有玩家当前所处的角度，现在我想要做的是让我的玩家面对星球，但有增量变化。（我这样做是因为我希望我的砂矿机能够绕地球运行）

问题在于数学，我增加玩家旋转以匹配玩家和行星之间的角度但是因为角度在 0 到 360 范围内工作，我的玩家不会绕轨道运行，因为玩家旋转可能是 2 但是到行星的角度是 280 所以游戏会让玩家转身，抱歉解释不好。

有谁知道如何让我的玩家成功环绕我的星球？

这是我的代码：

```
double rotation = Math.toDegrees(Math.atan2(currentPlanet.pos[1]-currentPlayer.pos[1], currentPlanet.pos[0]-currentPlayer.pos[0]));
if(rotation < 0)
{
    rotation += 360;
}

if(currentPlayer.rotation < rotation)
{
    currentPlayer.rotation += 0.15*delta;
}

if(currentPlayer.rotation > rotation)
{
    currentPlayer.rotation -= 0.15*delta;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:20:31.850

问题是350°也是-10°。你想要更小的绝对值。

解决方案非常简单。使用模运算将您的角度转换为正确的范围。

```
/* returns angle x represented in range -180.0 ... 180.0 */
double clampAngle(double x) {
    return (x%360.0+360.0+180.0)%360.0-180.0;
} 
```

将您的角度差传递给此函数。结果的标志将告诉您应该转向哪个方向：

```
double rotation = Math.toDegrees(Math.atan2(currentPlanet.pos[1]-currentPlayer.pos[1], currentPlanet.pos[0]-currentPlayer.pos[0]));
double diff =  ((rotation-currentPlayer.rotation)%360.0+360.0+180.0)%360.0-180.0;   

if(diff>0)
    turn right
else
    turn left 
```

`abs(diff)`如果非常小，您可能根本不想转动。

我不确定它是否会让你的玩家环绕你的星球。您将需要设置正确的角速度和线速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:19:42.833

你想要的是让你的玩家旋转面对你计算的行星和玩家之间角度的正负 90 度。当所有运动都与行星相切（90 度）时，就会发生轨道。

因此，计算角度，将播放器角度与 +90 和 -90 进行比较，然后将播放器旋转到两者中较近的位置。

# java - 斯坦福 NLP：加载解析模型失败

> ID：11486458
> 
> 赞同：0
> 
> 时间：2012-07-14T18:51:22.137
> 
> 标签：java, nlp, stanford-nlp

我从斯坦福 NLP 工具加载 Parse 模型时遇到问题。我像我应该的那样反序列化模型文件，但是当涉及到二进制语法部分时它失败了，除了这个例外：

```
Exception in thread "main" java.lang.NullPointerException
at edu.stanford.nlp.parser.lexparser.BinaryGrammar.init(BinaryGrammar.java:216)
at edu.stanford.nlp.parser.lexparser.BinaryGrammar.readObject(BinaryGrammar.java:203)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:974)
at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1849)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1753)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1329)
at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1947)
at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1871)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1753)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1329)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:351)
... 
```

有没有人遇到过类似的错误？可能是什么原因？

**编辑：**

这里是代码（没什么奇怪的，只是简单的反序列化）。

```
 ObjectInputStream in;
    InputStream is = null;
    try {
        is = aUrl.openStream();

        in = new ObjectInputStream(new BufferedInputStream(new GZIPInputStream(is)));

        ParserData parserdata = (ParserData) in.readObject();
        in.close();
        return parserdata;
    } catch (ClassNotFoundException e) {
        throw new IOException(e);
    } finally {
        is.close();
    } 
```

我不确定我使用的版本，因为我从私人存储库中获取库（就像我做模型一样），但我会检查那里有哪些版本。

**编辑2：**

检查版本后，我发现我使用了 2011 年的模型和 2012 年的解析器版本（仍然不确定这里使用了哪些版本）。使用较新的模型文件解决了问题，很抱歉打扰您。

# javascript - 为什么 JavaScript 不允许在函数上分配属性“名称”？

> ID：11486459
> 
> 赞同：6
> 
> 时间：2012-07-14T18:51:29.163
> 
> 标签：javascript, properties

请参阅下面的 Firefox 和 Chrome 控制台中发生的情况：

```
> var f = function() {}
undefined
> f.name = 'f'
"f"
> f.name
""
> f.id = 1
1
> f.id
1 
```

为什么`f.name = 'f'`是无操作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-14T18:55:06.840

可能取决于实施。

在一些实现中，`name`函数对象的属性被用作函数的名称（如果它有一个）。在这些情况下，这可能是只读的。

这是一个非标准功能。

例如：

```
var foo = function bar() {};

alert(foo.name); // will give "bar" in some cases. 
```

* * *

在 Firefox 和 Chrome 中，如果我尝试修改它，它不会改变......

```
var foo = function bar() {};

foo.name = "baz";
alert(foo.name); // still "bar" in Firefox and Chrome 
```

* * *

*   该 `name`属性的[MDN 文档。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/Name)

以下是文档中的一些关键点...

> “***非标准***”
> 
> *“name 属性返回函数的名称，或者匿名函数的空字符串”*
> 
> *“您不能更改函数的名称，此属性是只读的”*

# c++ - 为什么引用可能是一个对象？

> ID：11486463
> 
> 赞同：0
> 
> 时间：2012-07-14T18:51:50.100
> 
> 标签：c++, const-reference

目前正在学习 c++，没有比向 SO 的专家提问更好的地方了，我找不到比这里更完整和更好的答案。就这样。

```
DWORD dw = 5;
cout << &dw; 
```

显示存储值的地址`dw`。

但是为什么：

```
void Display(  DWORD &dwUserId )
{
    cout << dwUserId;
}

int _tmain( int argc, _TCHAR* argv[] )
{
    DWORD dw = 5;
    Display( dw );
} 
```

为什么在这个例子中显示的是值`dw`而不是`dw`地址？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:54:30.560

`&`在这种情况下有两种不同的含义：

*   放在声明中，这意味着变量是一个引用。在您的情况下，您通过引用传递参数。

*   在声明之外，在变量之前，它获取其地址。

除此之外，它还可以表示按位*与*运算符

```
int x;
int& y = x;  //y is a reference to x
int* z = &x; //& takes the address of x and assigns it to z
y & x;       //bitwise AND 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T18:57:10.387

`DWORD &dwUserId`作为函数的参数是**对 DWORD 的引用**。

在 C++ 中，`&`运算符根据上下文做了两件事：

*   在 r 值表达式中使用时，它返回值的地址。例如`void* ptr = &myObject;`
*   当在类型说明符中使用时，它将类型修改为“引用”类型。这类似于引用在 Java 和 .NET 中的工作方式。例如`int& ref = myInt;`

在您的情况下，您的`dwUserId`参数实际上是“对 DWORD 的引用”类型。

如果要更改它以获取地址，请执行以下操作：

```
void Display(DWORD* userId) {
    cout << userId;
}

Display( &dw ); 
```

另外，请取消 TCHAR 类型。MBCS 已弃用。Win32 Unicode`wchar_t`是未来 :) 还要避免使用匈牙利符号。这不是 1980 年代。我们现在有 IDE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T18:56:30.243

因为当您在函数定义的参数名称前使用 & 符号时，您是在告诉编译器将该参数作为引用传递，即不要复制它。

当您在代码中某处的变量名之前使用它时，您是在告诉编译器使用变量地址而不是他的值。

# permissions - 403 禁止图片

> ID：11486467
> 
> 赞同：3
> 
> 时间：2012-07-14T18:52:14.087
> 
> 标签：permissions, filesystems, http-status-code-403

我在 1and1 的虚拟主机上设置了三个子域，坦率地说，他们的支持还有很多不足之处。在所有三个上，我都无法显示图像。看起来它们都是“403 - Forbidden”，但我不知道为什么，也不知道为什么它只是图像目录。

子域是这些：

```
http://x1.keefermadness.com/
http://x2.keefermadness.com/ 
http://x3.keefermadness.com/ 
```

我已经在图像所在的目录和子目录上将权限设置为 777。网站上的其他外部文件（如 .js 文件）都显示得很好。主域上的图像也很好。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:04:07.843

似乎是您的 WebHost 的问题，因为该问题间歇性地发生。

这似乎解决了某些人的问题。当您请求图像时，添加一个随机字符串作为查询参数。

请求图像时，使用

```
home-featured01.jpg?(randomly generated string) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T19:45:57.713

这实际上是 .htaccess 文件的问题。

我早就将它设置为禁止盗链，但它是特定于域的，并没有考虑到子域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T11:06:04.717

我们删除了 .htaccess 文件的最后一行

```
RewriteEngine on 
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?zzz\.com [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?zzz\.co.uk [NC]
RewriteRule \.(gif|jpe?g|js|css|png)$ - [F,NC,L] 
```

这是返回图像和 css 的禁止操作

```
RewriteEngine on 
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?zzz\.com [NC]
RewriteCond %{HTTP_REFERER} !^http://(www\.)?zzz\.co.uk [NC] 
```

[https://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_f](https://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_f)

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-17T01:41:19.457

老问题，但图像上的 403 问题可能有点棘手。检查包含图像的所有文件夹和文件本身的权限。例子

> /images/theme1/bg.jpg

检查 /images 文件夹的属性，然后检查 theme1 文件夹和文件 bg.jpg 本身。**就我而言，一切都很好，但中间文件夹“无法访问”，`everyone`因此出现 403 禁止错误。**

[![在此处输入图像描述](../Images/86ef1abbe32dfa022b6a38d78cf6986f.png)](https://i.stack.imgur.com/ZQYul.png)

# github - Jenkins Github oAuth 404 回调错误

> ID：11486476
> 
> 赞同：3
> 
> 时间：2012-07-14T18:53:13.860
> 
> 标签：github, jenkins, jenkins-plugins

我正在尝试使用 Jenkins 的 Github oAuth 插件（https://wiki.jenkins-ci.org/display/JENKINS/Github+OAuth+Plugin）

```
Name: Name of app
URL: http://server:8080
Cacllback: http://server:8080/securityRealm/finishLogin 
```

当我启用 Github oAuth 时，它确实弹出说我是否要允许来自 Github 的此应用程序，然后我单击允许。

所以验证步骤通过了，但我点击了 404，因为**请求的资源 (/securityRealm/finishLogin) 不可用。**

Tomcat 管理器中没有任何内容显示 securityRealm，我还需要设置什么才能使用此插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-31T20:06:19.130

如果您没有在 server:port 上提供 jenkins，则回调将不存在。您很可能是从 server:port/jenkins 服务的，因为您使用的是 tomcat，这是 web.xml 中为 jenkins 战争指定的内容。

您的服务器的回调位置将是

```
服务器：端口/jenkins/securityRealm/finishLogin
```

如果您使用的是 Servlet 容器，例如 tomcat 或 jetty。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T15:25:49.463

确保在您的设置中正确配置了插件。输入客户端 ID 和客户端密码后，您从 github 获得并重新启动 Jenkins，它应该可以工作。我遇到了同样的问题，这对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-03T17:36:27.783

在设置 OAUTH 插件的过程中，我发现检查`/var/lib/jenkins/config.xml`文件是否正确设置很方便：

```
<securityRealm class="org.jenkinsci.plugins.GithubSecurityRealm">
  <githubWebUri>https://github.com</githubWebUri>
  <githubApiUri>https://api.github.com</githubApiUri>
  <clientID>3d404d2blah42ruSerious27</clientID>
  <clientSecret>{AQAwZXfnxuJQxEL9iEEXuXPmW5BdeadBeefBreDactedJMcw==}</clientSecret>
  <oauthScopes>read:org,user:email</oauthScopes>
</securityRealm> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-10T04:39:26.087

看来问题是您需要事先设置安全领域才能使路由可用。我执行了以下步骤以使其正常工作：

1.  安装 Github Oauth 插件（重新启动 Jenkins 以防万一）
2.  转到管理 Jenkins -> 配置全局安全性
3.  勾选启用安全并选择 Github Authentication Plugin
4.  在“授权”下，确保“任何人都可以做任何事”，然后点击底部的保存。（以前，我填写了所有设置并点击保存，但我仍然收到 404 并将自己锁定）。

此时，我尝试点击 http://:8080/securityRealm/finishLogin 并返回 HTTP/1.1 302 Found。

在我确认我不再收到资源的 404 后，我回到“配置全局安全”并使用客户端 ID 和客户端密码设置插件的其余部分，选择“Github Commiter Authorization Strategy”进行授权，添加我的用户名，已保存，现在可以通过 Github 进行身份验证。

希望这可以帮助。

Jenkins 版本：1.558 版
Github Auth 插件：0.14 版

# android - 如何将默认值查询到 Android ContentProvider

> ID：11486484
> 
> 赞同：0
> 
> 时间：2012-07-14T18:54:20.473
> 
> 标签：android, null, android-contentprovider

我正在为 Android 2.1 编写一个简单的音乐应用程序并偶然发现了这样一个问题：

在我的活动中，我有一个 ListView，其中包含专辑封面、专辑标题、艺术家和每行中的歌曲数量。我在 ContentProvider 中查询所有要放入 ListView 的值。但是 SDCARD 上的一些专辑没有专辑封面，我认为查询返回 NULL。结果在我的 ListView 中，我的专辑只有少数有封面。

我想做的是在查询 ContentProvider 时或在其他地方放置一些参数，如果查询返回 null 封面，则将我的默认图标作为专辑封面。我的意思是，如果 ContentProvider 没有返回任何内容作为封面，我想将我的默认图标放在这个地方。

也许我应该使用其他查询，而不是 ManagedCursor？

我看到了使用 IFNULL 子句（SELECT IFNULL(title, "------") AS title FROM books;）的类似数据库问题的解决方案。我认为它可以在某种程度上有所帮助，但是没有地方可以在 ContentProvider 查询中放置这样的子句。

有谁知道该怎么做？我在下面放了mu代码：

```
private void getAllAlbumsFromSDCARD() 
{
    String[] cols = { MediaStore.Audio.Albums.ALBUM, MediaStore.Audio.Albums.ALBUM_ART, MediaStore.Audio.Media.ARTIST, 
            MediaStore.Audio.Media._ID, MediaStore.Audio.Albums.NUMBER_OF_SONGS};        
    Uri allAlbumsUri = MediaStore.Audio.Albums.EXTERNAL_CONTENT_URI;
    albumsCursor = this.managedQuery(allAlbumsUri, cols, null, null, MediaStore.Audio.Media.ALBUM);
    // SELECT IFNULL(title, "------") AS title FROM books;
    Log.d(TAG, "" +albumsCursor.getCount());

    if(albumsCursor!=null)
    {
        Log.d(TAG, "Managing cursor");
        startManagingCursor(albumsCursor);

        //  
        String[] from = new String[] { MediaStore.Audio.Albums.ALBUM_ART, MediaStore.Audio.Albums.ALBUM, MediaStore.Audio.Media.ARTIST, 
                MediaStore.Audio.Albums.NUMBER_OF_SONGS };
        int[] to = new int[] { R.id.cover, R.id.album, R.id.artist, R.id.count };

        ListAdapter albums = new SimpleCursorAdapter(this, R.layout.album_row, albumsCursor, from, to);
        this.setListAdapter(albums);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T21:32:09.853

我发现我的问题的解决方案是自定义 CursorAdapter。我粘贴了一个完全符合我要求的代码：

```
public class MyCursorAdapter extends SimpleCursorAdapter{

private MainActivity mainActivity;
private int layout;

public MyCursorAdapter(MainActivity context, int layout, Cursor c, String[] from, int[] to) {
    super(context, layout, c, from, to);
    this.mainActivity = context;
    this.layout = layout;
}

public View getView(int position, View convertView, ViewGroup parent) {

     // Cursor to current item 
    Cursor cursor = getCursor();
    cursor.moveToPosition(position);

    View v = mainActivity.getLayoutInflater().inflate(layout, parent, false); 

    TextView albumTV = (TextView) v.findViewById(R.id.album); 
    if (albumTV != null) 
    { 
            int index = cursor.getColumnIndex(MediaStore.Audio.Albums.ALBUM); 
            String album = cursor.getString(index); 
            albumTV.setText(album); 
    } 

    TextView artistTV = (TextView)v.findViewById(R.id.artist); 
    if (artistTV != null) 
    { 
            int index = cursor.getColumnIndex(MediaStore.Audio.Albums.ARTIST); 
            String artist = cursor.getString(index); 
            artistTV.setText(artist); 
    } 

    TextView countTV = (TextView)v.findViewById(R.id.count); 
    if (countTV != null) 
    { 
            int index = cursor.getColumnIndex(MediaStore.Audio.Albums.NUMBER_OF_SONGS); 
            String count = cursor.getString(index); 
            countTV.setText(count); 
    }

    ImageView cover = (ImageView) v.findViewById(R.id.cover); 
    if (cover != null) 
    { 
            int index = cursor.getColumnIndex(MediaStore.Audio.Albums.ALBUM_ART);
            String path = cursor.getString(index); 
            Log.d("MCA", ""+path);

            if(path == null)
            {
                cover.setImageResource(R.drawable.no_cover_64);
                cover.setScaleType(ImageView.ScaleType.FIT_CENTER);
            }
            else 
            {
                BitmapDrawable icon = new BitmapDrawable(path);
                cover.setImageDrawable(icon);
            }
    } 
    return v; 
} 
```

}

# jpa - 性能上的 JDBC 与 JPA 原生查询

> ID：11486487
> 
> 赞同：0
> 
> 时间：2012-07-14T18:54:29.953
> 
> 标签：jpa, jdbc, eclipselink

对于选择查询，您认为在 JPA 原生查询（Hibernate 或 EclipseLink）和 JDBC 查询中哪一个执行起来会更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:01:14.660

JPA 使用 JDBC，因此两个查询将以完全相同的方式执行，并且具有相同的执行时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:01:38.420

JPA 是数据库的抽象层。它使您可以更少地考虑数据库结构，而更多地考虑您坚持的对象。

我敢肯定，如果您只使用来自 JPA 的本机查询，您将获得与使用普通 JDBC 几乎相同的性能，因为它直接传递给 JDBC 驱动程序。

# backbone.js - 骨干关系：从本地存储中删除嵌套数组属性的元素

> ID：11486489
> 
> 赞同：4
> 
> 时间：2012-07-14T18:54:30.307
> 
> 标签：backbone.js, backbone-relational

我有一个 RelationalModel “Todo”，其中“HasMany”注释（嵌套数组）。如何从此嵌套集合中删除特定评论？如果有人还可以提供如何向这个嵌套数组添加（和更新）“评论”的示例，那就太好了。这是[将](https://stackoverflow.com/questions/6879138/how-to-save-an-entire-collection-in-backbone-js-backbone-sync-or-jquery-ajax)[整个集合保存在本地存储中](https://stackoverflow.com/questions/5014216/best-practice-for-saving-an-entire-collection)的最佳方式吗？为什么没有现成的功能可以从嵌套集合中删除元素并保存它？

我试过了

> this.model.destroy()

和

> this.model.bind("销毁", this.remove)

在我的 CommentView 中，但这只会从 DOM 和主干“CommentCollection”中删除评论，而不是从本地存储中删除。所以，不知何故，它不会同步 CommentCollection 和本地存储。

localstorage 中的待办事项如下所示：

```
{"todo_1342290161303":{"content":"Hello Todo1","comments":[
{"id":"1","content":"Comment1","todo":"todo_1342290161303"},
{"id":"2","content":"Comment2","todo":"todo_1342290161303"}],"id":"todo_1342290161303"}
}

 //-------------------- Comment MODEL ----------------

 var Comment = Backbone.RelationalModel.extend({
     idAttribute: "_id",    
     initialize: function() {
         console.log("COMMENT MODEL: initialize()");        
     },
  });

  //-------------------- Comment Collection ----------------

  var CommentCollection = Backbone.Collection.extend({
     model: Comment,     
     localStorage: new Store("Todos-STORAGE-COMMENTS"),    
     initialize: function() {
         console.log("COMMENT COLLECTION: initialize()");
         //console.log(this.collection.get(1).get("content"));
     }     
  });

  //-------------------- Todo MODEL ----------------

  var Todo = Backbone.RelationalModel.extend({
     idAttribute: "id",    
     relations: [{
        type: Backbone.HasMany,
        key: "comments",
        relatedModel: Comment,
        collectionType: CommentCollection,
        reverseRelation: {
            key: "todo",
            includeInJSON: "id",
        },}],      

        initialize: function() {
            console.log("--TODO MODEL: initialize()");
        }, 
  }); 
```

评论视图：

```
var CommentView = Backbone.View.extend({
 tagName: "li",    
 template: _.template($("#comment-template").html()),
 events: {
     "click span.delete-comment": "deleteComment"
 },    
 initialize: function() {
     _.bindAll(this, "render", "remove", "deleteComment");
     this.model.bind("change", this.render);
     this.model.bind("destroy", this.remove);       
 },

 deleteComment: function(comment) {
     this.model.destroy();  
 },

 render: function() {
     this.$el.html(this.template(this.model.toJSON()));
     return this;
 },
}); 
```

# php - call_user_func 执行函数而不执行 __construct

> ID：11486496
> 
> 赞同：0
> 
> 时间：2012-07-14T18:55:17.253
> 
> 标签：php

我从调度程序类执行以下类，但 class_exists 和 call_user_func 都不执行该类， __controller 永远不会运行。会话没有开始。目前，作为解决方法，我`$i = new Admin();`在类减速之前添加，以便在加载页面时激活类。但这种行为对我来说很奇怪。

从调度程序类中提取：

```
 include $this->file;

        if (class_exists($this->controller, TRUE)) {

            if (!is_callable($this->controller, $this->action)) {
                header('Location: /404.php');
                exit;
            }
            call_user_func(array ($this->controller, $this->action), $this->route->values);
        }

<?php
class Admin
{

    public function __construct()
    {
        S::V()->title()->set('Admin');

        if (!isset($_SESSION))
            session_start();
        if (!isset($_SESSION['auth']))
            header('Location: /cp/login');      
    }

    public function lobby($args)
    {
        S::V()->title()->append(' Logger');
        if (isset($_REQUEST['clear'])) {
            S::L()->clear();
        }

        $data['raw'] = S::Logger()->gethtml('20');
        S::V()->addData($data);
        echo S::V()->fetch('admin.php', $data);
    }
?> 
```

# android - 如何让 MapView.setBuiltInZoomControls(true) 工作？

> ID：11486501
> 
> 赞同：3
> 
> 时间：2012-07-14T18:56:18.460
> 
> 标签：android, zooming, android-mapview

我正在尝试使用内置缩放控制器创建 MapView，这是代码：

```
MapView mMapView;
mMapView=new MapView(this, GMAPS_API_KEY);
mMapView.setBuiltInZoomControls(true);
mMapView.setSatellite(false);
mMapView.getController().setZoom(16);
someView.addView(mMapView); 
```

地图工作正常；我还在上面添加了一个 MyLocationOverlay ，它工作正常。但是，缩放控件不显示。对 setBuiltInZoomControls(true) 的调用被完全忽略。没有记录错误消息。

让 setBuiltInZoomControls 按预期工作需要什么？

是的，我的活动扩展了 MapActivity。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T02:51:57.590

尝试

```
mMapView.setClickable(true); 
```

我自己也遇到了这个问题，这就是我最终解决它的方法（尽管我是使用 XML 属性而不是在 Activity 代码中完成的）。

# java - 在 Java 中读取和修改 HTML 文件

> ID：11486508
> 
> 赞同：3
> 
> 时间：2012-07-14T18:57:21.683
> 
> 标签：java, html, arrays, string, file

我有一个 HTML 文件，我要做的就是将此文件存储到某个数组或大字符串中，然后进行所需的修改。我必须包含一些 Javascript 和其他一些具有属性的元素，并且还必须消除其中的一些。谁能帮我做这件事。感谢您！

```
<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml">  
<head>  
<meta http-equiv="Content-type" content="text/html;  charset=utf-8" />  
<title>eXe</title>  
<style type="text/css">  
@import url(base.css);  
@import url(content.css);  
</style>  
<script type="text/javascript" src="common.js"></script>
<!--HERE I NEED TO INCLUDE 3 MORE JAVASCRIPTS-->  
</head>  
<body>  
<div id="outer">  
<div id="main">  
<div id="nodeDecoration">  
<p id="nodeTitle">  
Part 1</p>  
</div>  
<div class="TrueFalseIdevice" id="id12">  
<script type="text/javascript" src="common.js"></script>  
<!--THIS JAVASCRIPT HAS TO BE ELIMINATED-->  
<script type="text/javascript" src="libot_drag.js"></script>  
<div class="iDevice emphasis1">  
<img alt="" class="iDevice_icon" src="icon_question.gif" />  
<span class="iDeviceTitle">True-False Question</span><br/>  
<div class="iDevice_inner">  
<div id="ta12_16" class="block" style="display:block">  

</div><div class="question">  
<br/><br/><div id="taquestion0b12" class="block" style="display:block">1><span style="color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: #ffffff; display: inline ! important; float: none"> SQL Stands for Structure Query Language?</span>   

<!--THIS ONCLICK EVENT HAS TO BE REMOVED-->  
</div><br/>True <input type="radio" name="option0b12" id="true0b12" onclick="getFeedback(0,2,'0b12','truefalse')"/>   
False <input type="radio" name="option0b12" id="false0b12" onclick="getFeedback(1,2,'0b12','truefalse')"/>  
<div id="s0b0b12" style="color: rgb(0, 51, 204);display: none;" even_steven="18">Correct! </div>  
<div id="s1b0b12" style="color: rgb(0, 51, 204);display: none;" even_steven="19">Incorrect! </div>  
<div id="sfbk0b12" style="color: rgb(0, 51, 204);display: none;"><div id="tafeedback0b12" class="block" style="display:block">  
<!--HERE I NEED TO INCLUDE A SUBMIT BUTTON-->
</div></div>  
</div>  
</div>  
</div>  
</body></html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:42:52.283

Java 已经有一个解析器，称为 DOM 可以帮助您。你可以使用这样的东西：

```
File theXML = new File("C:\\path\\to\\file.xml");
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
Document doc = builder.parse(theXML);
doc.getDocumentElement().normalize(); 
```

如果您曾经使用过 JavaScript DOM，您应该知道现在该做什么，使用 doc.getElementsByTagName 或类似的东西。如果没有，请查看[oracle 教程](http://docs.oracle.com/javase/tutorial/jaxp/dom/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:03:53.897

您可以使用[这种](https://stackoverflow.com/questions/11485311/how-can-a-fileinputstream-get-the-content-of-file/11485514#11485514)方式来读取您的 html （进入 a `String`）。之后，您的任务实际上是进行一些`String`拆分、替换和插入，最后，`html`使用与从 HDD 读取文件类似的方法将其全部写入 HDD 上的文件。

# iphone - 沿 x 轴和 y 轴移动 UIImage

> ID：11486509
> 
> 赞同：2
> 
> 时间：2012-07-14T18:57:24.660
> 
> 标签：iphone, ios, uigesturerecognizer

我创建了一个带有旋钮的控件。**该旋钮只能**沿 x 轴和 y 轴移动。
我已经实现了以下方法：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

我知道，必须在`touchMoved`. 当我限制沿例如 x 轴的移动时，一切都按预期工作。但是如何启用 y 轴的运动呢？当我启用第二个轴时，旋钮的移动不仅限于**这** 两个轴。这里是`touchMoved`实现的一部分：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [[event allTouches] anyObject];
    CGPoint currentLocation = [touch locationInView:self.view];
    CGPoint centerPoint = _triggerCap.center;
    CGPoint selectionTriggerCenter = _selectionTrigger.center;

    double distance = ({double d1 = centerPoint.x - selectionTriggerCenter.x, d2 = centerPoint.y - selectionTriggerCenter.y; sqrt(d1 * d1 + d2 * d2); });
    if (distance < 100.0) {
        if (fabsf(selectionTriggerCenter.y - currentLocation.y) > 5) {
            centerPoint.y = currentLocation.y;
            _triggerCap.center = centerPoint; 
```

有人可以给我一个提示如何**仅沿这****两个**轴移动吗？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T23:21:14.547

我能想到的最快方法是：

在`touchesBegan`中，记录第一次触摸在旋钮内的位置。然后，在 中`touchesMoved`，等到从第一次触摸开始至少有一个最小距离（可能是 15 像素 - 试一试，看看什么效果最好）。检查它是否在 x 方向或 y 方向上距离第一次触摸更远。这将确定当前触摸序列的其余部分应限制在哪个轴移动。设置一个标志来指示轴，然后使用您已经拥有的代码来限制单个轴的移动。`touchesEnded`在旋钮返回到距轴交点一定距离内时或当旋钮复位时重置标志。**

# android - 检查 Android Gridview 是否滚动到顶部

> ID：11486512
> 
> 赞同：5
> 
> 时间：2012-07-14T18:57:42.600
> 
> 标签：android, android-layout, android-gridview

我想确定我的 Gridview 是否滚动到顶部。

现在我正在使用 getChildAt(0).getTop() 来做到这一点。我在第一次绘制时保存 getChildAt(0).getTop() 的值，并在后续绘制时与 getChildAt(0).getTop() 进行比较。

但是，这似乎很老套，有时似乎会给我不正确的结果。

有更好的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T00:39:54.470

尝试使用`onScrollListener`

```
setOnScrollListener(this);

@Override
public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) {

    if(firstVisibleItem == 0){
        //do stuff here
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:25:05.070

返回给您 GridView的`getChildAt(0)`第一个可见项目，我猜这不是您想要的。

如果您使用`yourGridView.getFirstVisiblePosition()`方法，它将返回您的数据适配器的第一个可见位置，这就是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-07T05:37:21.050

希望这可以帮助，它对我有用，祝你好运。

`yourGridView.setOnScrollListener(new OnScrollListener() { @Override public void onScrollStateChanged(AbsListView view, int scrollState) { if(SCROLL_STATE_IDLE == scrollState) { View view = view.getChildAt(0); if(view != null) { float y = view.getY(); Log.d("Tag", "first view Y is " + y); if(y == 0) { // do what you want } } } }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-16T05:28:50.167

这是我的回答：

```
mLayoutManager = new GridLayoutManager(getActivity(), 2);
mListRV= (RecyclerView).findViewById(R.id.list_rv);
mListRV.setLayoutManager(mLayoutManager);

mListRV.setOnScrollListener(new RecyclerView.OnScrollListener() {
                @Override
                public void onScrollStateChanged(RecyclerView recyclerView, int newState) {
                    if (newState == RecyclerView.SCROLL_STATE_IDLE) {
                        View v = mLayoutManager.getChildAt(0);
                        int offsetTop = v.getTop();
                        int offsetBottom = v.getBottom();
                        int height = (offsetBottom - offsetTop);
                        if(offsetTop >= -height/2) {
                            mListRV.smoothScrollBy(0, offsetTop);
                        } else {
                            mListRV.smoothScrollBy(0, height + offsetTop);
                        }
                    } 
                }
            }); 
```

# android - 安卓：抓紧时间

> ID：11486513
> 
> 赞同：-1
> 
> 时间：2012-07-14T18:57:58.310
> 
> 标签：android, time, clock

我目前正在使用以下行来实现时间：System.currentTimeInMilis。我注意到它没有考虑时区，或者它与它自己的android手机不匹配，而在模拟器上它确实匹配.s 那么还有另一种方法来获取它自己的android时钟吗？那么当用户调整他的手机内置时钟时，它也会影响它吗？

```
float getTime()
    {
        Calendar cal = new GregorianCalendar();
        cal.setTimeInMillis(System.currentTimeMillis());
        cal.setTimeZone(TimeZone.getDefault());
        return cal.getTimeInMillis();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:11:50.520

阅读[currentTimeMillis](http://developer.android.com/reference/java/lang/System.html#currentTimeMillis%28%29)的文档。它*有*一个时区，恰好是 UTC（这是 Unix 时间戳的默认值）。

如果要将其转换为不同的时区，可以使用 Java Calendar 和 TimeZone 类：

```
Calendar cal = new GregorianCalendar();
cal.setTimeInMillis(System.currentTimeMillis());
cal.setTimeZone(TimeZone.getDefault()); 
```

或者，您可以只创建一个新的 GregorianCalendar 实例。默认情况下，它的时区将与本地时区（在设备上设置）匹配，时间将设置为“现在”。

还有其他方法可以根据当前时区和语言环境作为字符串检索当前时间。看看[DateUtils](http://developer.android.com/reference/android/text/format/DateUtils.html)。

**编辑解释日历的用法**

阅读 Calendar.getTimeMillis() 的文档。该方法再次返回恰好具有 UTC 时区的 Unix 时间戳。

您必须使用 Calendar.get() 方法来获取正确的值。请参阅以下示例以通过日历对象获取正确时区的当前时间：

```
int hour = cal.get(Calendar.HOUR_OF_HAY); 
```

阅读日历的文档。有很多字段，例如 HOUR_OF_DAY，可以帮助您获取年、月、分、秒等值。

# jquery - 单击同一页面上的图像时，左侧的图像和右侧的描述

> ID：11486515
> 
> 赞同：0
> 
> 时间：2012-07-14T18:58:15.690
> 
> 标签：jquery

我需要在我的网站中实现一个东西，即：如果我点击页面左侧的任何图像，它的描述应该出现在同一页面的右侧，而无需重新加载。即：在其他 div 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:20:29.043

为每个图像放置一个 div 元素并将其可见性设置为隐藏。然后将 onclick 侦听器附加到每个图像上，如下所示：

```
 <div>
        <img>
        <div>description</div>
    </div>

    $( document).ready( function() {
        $( ".myImages" ).click( function() {
            $( this ).next().css( 'visibility', 'visible' );
        });
    }); 
```

# python - MySQL 更新语句不起作用

> ID：11486520
> 
> 赞同：2
> 
> 时间：2012-07-14T18:58:54.637
> 
> 标签：python, mysql

我在 MySQL 中的更新语句似乎不起作用：

```
timeup = "UPDATE timeid set time=\"" + str(timeid) + "\""
c.execute(timeup) 
```

我已经尝试了所有我认为可能有问题的方法，包括更改变量的类型（如您在上面看到的，我将其作为字符串）以及使用和不使用引号。

我什至可以打印出语句变成了什么：

```
UPDATE timeid set time="224215313716215808" 
```

timeid 唯一的列和值分别是 time 和 0。

这个怎么不更新了 难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T18:25:30.017

你需要使用：

```
c.commit(); 
```

因为`MySQLdb`开始更新语句的事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:01:27.783

尝试：

```
timeup = "UPDATE `timeid` SET `time`='" + str(timeid) + "';"
c.execute(timeup) 
```

时间在 SQL 中可能是一个常数，因此使用简单的引号（我不知道它们是如何被调用的）确保您引用一个字段。并尝试`'`用于设置值并考虑添加分号。

你之前选择过数据库吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-14T19:03:32.223

尝试在查询末尾添加分号 (;) 并告诉我它是否有效。

# css - div 宽度自动调整到其内容

> ID：11486523
> 
> 赞同：1
> 
> 时间：2012-07-14T18:59:14.833
> 
> 标签：css, html

我有以下代码：http: [//jsfiddle.net/domoindal/fkcQK/](http://jsfiddle.net/domoindal/fkcQK/)

我需要的是边框适合菜单栏中的内容，所以如果有三个标签，那么这样的 div 的宽度应该适合这三个标签宽度的总和。我不希望标签周围的边框获得最大宽度。

后者，我想要的是在生成的不规则形状周围创建一个阴影，而不是一个盒子。

有没有可能按照我的意愿去做？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:07:43.637

摆脱 width: auto bits 并添加 display: inline-block 到你的菜单 div:-

[http://jsfiddle.net/fkcQK/2/](http://jsfiddle.net/fkcQK/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:03:24.443

尝试使用浮动

[http://jsfiddle.net/fkcQK/1/](http://jsfiddle.net/fkcQK/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T19:04:06.177

您的`width: auto;`属性将无济于事，因为`<div>`它是一个块元素并自动填充其父元素的宽度。在浏览器的内置样式表中，有一个定义说`div { width: auto; display: block; }`您的 CSS 不会改变任何东西。

你想要的就是在我刚刚找到的这个 jsFiddle 中完成的：http: [//jsfiddle.net/loktar/seB5F/](http://jsfiddle.net/loktar/seB5F/)

它在`position: absolute;`不定义任何位置坐标的情况下创建父级，因此元素的框适合其内容（因为它没有要填充的父级），但是这确实会从文档流中删除元素，因此您需要分配边距或填充到附近的元素来掩盖这一事实。

HTH。

一个小提示：将来，考虑制作导航菜单（概念上是列表）`<ul>`元素而不是通用的`<div>`.

# objective-c - MKAnnotationView 标注视图不出现

> ID：11486526
> 
> 赞同：0
> 
> 时间：2012-07-14T18:59:45.143
> 
> 标签：objective-c, ios, mkmapview, mkannotation, mkannotationview

所以我在我的应用程序的地图上有 MKAnnotationViews，但是，我似乎无法让注释显示标注。这是我尝试过的一些代码：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {

static NSString *identifier = @"Bar";   
if ([annotation isKindOfClass:[BarLocations class]]) {

    MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [self.mapView dequeueReusableAnnotationViewWithIdentifier:identifier];
    if (annotationView == nil) {
        annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
    } else {
        annotationView.annotation = annotation;
    }

    annotationView.enabled = YES;
    annotationView.canShowCallout = YES;
    annotationView.animatesDrop = YES;

//Doesn't work
    UIButton *button = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    button.frame = CGRectMake(0, 0, 23, 23);
    annotationView.rightCalloutAccessoryView = button;

//Doesn't work
    UIButton *leftButton = [UIButton buttonWithType:UIButtonTypeInfoLight];
    [leftButton setTitle:annotation.title forState:UIControlStateNormal];
    [annotationView setLeftCalloutAccessoryView:leftButton];
    annotationView.canShowCallout = YES;

//Doesn't work

    UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    rightButton.frame = CGRectMake(0, 0, 15, 15);
    [rightButton addTarget:self
                    action:@selector(showDetails:)
          forControlEvents:UIControlEventTouchUpInside];
    annotationView.rightCalloutAccessoryView = rightButton;

return annotationView; 
} 
```

注意 - 我分别尝试了其中的每一个 - 我只是在这篇文章中将它们放在一起以显示我已经尝试过的选项。

我究竟做错了什么？

**编辑**

我想我发现了问题的很大一部分：永远不会调用以下方法：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation 
```

但是，我认为`MkMapView`'s are like `UITableView`'s。那我怎么称呼它。我忘了指派代表吗？

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:44:42.693

所以问题原来是我忘记将`mapView's`委托链接到其实现的类。因此，即使方法存在并且正确，也从未调用过委托方法。一旦我连接了代表，它就完美地工作了。

# javascript - 重新加载浏览器不会将页面重置为顶部

> ID：11486527
> 
> 赞同：8
> 
> 时间：2012-07-14T18:59:45.477
> 
> 标签：javascript, jquery, accordion, jquery-ui-accordion

我以为当您单击刷新时，浏览器应该将您的页面重置为顶部？我正在使用`js`手风琴，当我刷新时，它会关闭手风琴，但不会将页面重新定位到顶部。

[http://imip.rvadv.com/index3.html](http://imip.rvadv.com/index3.html)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-14T19:01:43.613

好吧，正如你所看到的，它没有:)

但是你可以用一些简单的 jQuery 来强制它：

```
$(document).ready(function(){
    $(this).scrollTop(0);
}); 
```

**编辑：**

似乎在 IE 9、FF 12 和 Chrome 20.0 中有效的唯一方法如下：

```
$(document).ready(function(){
    $('html').animate({scrollTop:0}, 1);
    $('body').animate({scrollTop:0}, 1);
}); 
```

奇怪的是，当我尝试直接滚动元素而不应用任何动画（即`$('html').scrollTop(0)`）时，它不起作用。由于持续时间设置为 1 毫秒，因此用户不会注意到任何内容。

如果有人能对此有所了解，我会很高兴 - 为什么滚动只适用于动画？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-03-16T05:17:35.287

如果上述方法均无效，请尝试此操作。这将诱使浏览器认为它在刷新之前位于文档的顶部。

```
$(window).on('beforeunload', function() {
   $(window).scrollTop(0);
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-14T19:01:42.327

为了方便起见，浏览器将向下滚动到重新加载之前的位置。它只对过长的页面非常有用。

您可以像这样“修复”它：

```
window.onload = function() {document.body.scrollTop = document.documentElement.scrollTop = 0;}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-12T09:22:29.180

根据comonpyke的最后评论和我推荐的自己的测试

```
$(document).ready(function(){
    $('html, body').scrollTop(0);

    $(window).on('load', function() {
    setTimeout(function(){
        $('html, body').scrollTop(0);
    }, 0);
 });
}); 
```

*   第一个 scrollTop 提前滚动
    *   文件准备好后
*   第二个 scrollTop 滚动延迟
    *   加载事件后
        *   超时后

# java - Tomcat Eclipse 项目中的部署之战

> ID：11486529
> 
> 赞同：0
> 
> 时间：2012-07-14T19:00:00.060
> 
> 标签：java, eclipse, tomcat, deployment, webserver

我正在尝试将一些东西移到**Tomcat**上，它作为**服务在****Windows 服务器**上运行。所以我在**Eclipse**中创建了一个 Tomcat 项目，但是我没有看到任何地方可以让 Eclipse 为我生成一个**War 文件**，然后我可以**部署它吗？**

 ******* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:06:39.963

将自己定位到`{WORKSPACE}/{YOUR PROJECT}/web/{YOUR APP CONTEXT}/`.
输入这个：`jar -cvf {YOUR APP CONTEXT}.war *`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:09:52.223

在 Eclipse 上右键单击您的项目，从上下文菜单中选择**导出**，然后在即将出现的窗口中选择 War 文件。******

# python - 基于位置的 Python 推荐框架

> ID：11486531
> 
> 赞同：1
> 
> 时间：2012-07-14T19:00:01.597
> 
> 标签：python, django

我希望在 Python 中实现基于位置的推荐服务（作为 Django 应用程序），根据用户提供的位置（城镇、城市、国家），我可以检索位于用户 50 英里范围内的其他用户的记录. 是否有现有的框架可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:11:30.887

我不完全确定我知道你所说的框架是什么意思。获取用户位置是一项任务，获得推荐是另一项任务。获取位置将相当容易（HTML5、IP 查找等）。推荐系统是更个人化的选择。我推荐阅读[这篇](http://www.cs.umd.edu/~samir/498/Amazon-Recommendations.pdf)关于亚马逊的文章，然后在[这里](http://www.slideshare.net/100k100k/recommendations-with-hadoop-streaming-and-python?utm_source=Python+Weekly+Newsletter&utm_campaign=000b7d6a9b-Python_Weekly_Issue_36_May_24_2012&utm_medium=email)[查看](https://github.com/orf/MovieFinder?utm_source=Python+Weekly+Newsletter&utm_campaign=9dc22cf663-Python_Weekly_Issue_34_May_10_2012&utm_medium=email)教程和 github 项目。

# c - 如何在C中的char *字符串的末尾粘贴一个null

> ID：11486533
> 
> 赞同：-2
> 
> 时间：2012-07-14T19:00:06.720
> 
> 标签：c

```
char* s = (char*)malloc(5); 
```

一些处理将可变数量的字节（数字）添加到字符串。例如 *s = 50;

我现在需要空终止字符串。这行得通。

```
*(s+1) = 0; 
```

但是有没有更优雅的方式呢？

根据评论，这看起来像是这样做的方法

```
char* getvalue(char* str) {
   while((*str++ = getnextchar()) != 'H')
      ;

   *str = '\0'; /* null terminate */

   return str;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:05:54.923

使用`calloc`而不是`malloc`. 这会将内存设置为零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:06:22.683

假设您已经将某些内容`s[0]`作为“字符串”放入，您只需像这样终止：

```
s[1] = '\0'; 
```

但是，如果您发布更详尽的代码示例，通常有更好的方法将字符串复制到新缓冲区中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T19:11:12.763

假设 ASCII，你可以这样做：

```
snprintf(s = malloc(5), 5, "%s", "2"); 
```

的使用只是为了确保您的源字符串`snprintf`不会超出您的目标缓冲区，并且它总是会导致.`\0``s`

如果您必须使用整数常量（或者它不是 ASCII）：

```
snprintf(s = malloc(5), 5, "%c", 50); 
```

您建议的例程不会检查输入是否会超出`str`缓冲区。API 应该接受一个大小参数，因此您可以检查以确保写入的字节数不会超出您的预期。如果要返回字符串的结尾，可以在函数的另一个参数中执行此操作。然后，您可以允许该函数返回是否已看到终止字符的指示。

```
int getvalue (char *str, size_t sz, char **endp) {
   char *end = str;
   while (--sz > 0)
      if ((*end++ = getnextchar()) == 'H') break;
   *end = '\0'; /* null terminate */
   if (endp) *endp = end;
   return end[-1] == 'H';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T19:13:03.040

填充零(0) 和以 NULL('\0') 终止是两件不同的事情。如果您只想填零，请在 malloc 之后使用 memset 或只使用 calloc。

如果您希望字符串自动以 NULL 终止，请使用 strcpy/strncpy 将数据复制到其中。此函数将复制您的数据并添加终止 NULL。

# scala - Play Framework 2.0 BodyParser - 推送解析 XML 流

> ID：11486536
> 
> 赞同：5
> 
> 时间：2012-07-14T19:00:17.890
> 
> 标签：scala, xml-parsing, streaming, playframework-2.0, iterate

[尽管阅读了官方文档](https://github.com/playframework/Play20/wiki/Iteratees)和这些问题中链接的资源，但我觉得问这个问题有点离题了：

[如何理解 play2 中的“Iteratee”？](https://stackoverflow.com/questions/9858095/how-to-understand-iteratee-in-play2)

[Play 2.0中看不懂Iteratee、Enumerator、Enumeratee](https://stackoverflow.com/questions/10177666/cant-understand-iteratee-enumerator-enumeratee-in-play-2-0)

...我对迭代器、枚举器和 Play 2.0 的反应模型仍然很模糊。但无论如何，我想设置一个 Web 服务，允许我上传大型 XML (>100MB) 文件，挑选某些特定的（非交错的）NodeSeq，处理它们，并将结果流式传输回客户端。

我认为我需要做的第一件事是编写一个 BodyParser，它接收大块字节，将它们提供给 XML 解析器，然后`<doc>...</doc>`以一种懒惰的方式发出我想要的 NodeSeq 流。

任何人都可以提供任何指导和/或示例来说明如何实现这一点吗？

更新：更多背景：-

我的 XML 实际上是一个 Solr`add`文档，所以它看起来像：

```
<add>
    <doc>
        <field name="name">Some Entity</field>
        <field name="details">Blah blah...</field>
        ...
    </doc>
    ...
</add> 
```

我想以`<doc>`流的方式处理每一个，所以我的解析器显然必须等到它遇到一个`<doc>`开始事件，缓冲所有内容直到等效的`</doc>`结束事件，并发出一个已完成元素的 NodeSeq，然后刷新它的缓冲区。

这将如何与 Play BodyParser 一起工作，我不完全确定。如果我能进一步澄清我想要做什么，则会有更多更新！

尽管整个 XML 文件很大，但每个`<doc />`元素本身都非常小，尽管我显然必须检查字节缓冲区是否没有超过一定的大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T13:52:33.997

扫描文档，它似乎只是收集了这些信息，并为 Java 提供了一个完整的 org.w3c.Document ，为 scala 提供了一个 scala.xml ： [play xml requests](https://github.com/playframework/Play20/wiki/ScalaXmlRequests "播放 Scala Xml 请求")

这似乎不太可能对您的情况有所帮助，因为您最终会得到一个大内存模型。对于 100MB 的 xml，您可以期望解析多达 700MB 的使用量。

不幸的是，当前可用的（和已知的）xml 库都不支持按照 Iteratee 模型提供块。 [Scales Xml](https://github.com/chris-twiner/scalesXml "秤 Xml")提供了一种处理流中的块的方法（将拉解析器转换为枚举器） - 请参见[此处](http://scala-scales.googlecode.com/svn/sites/scales/scales-xml_2.9.2/0.3-RC7/RepeatedSections.html "拉解析重复部分")的示例。

因此，目前我建议采用普通的 InputStream（或 Reader）并将其输入类似于 Scales 的东西。也许 Play 专家可以推荐如何从框架内检索流（无需完全处理）。

注意：当前的最终版本即将发布，但下一个主要版本 (0.5) 将尝试利用[aalto-xml](https://github.com/FasterXML/aalto-xml "阿尔托 Xml")来允许双方进行这种部分流处理（非阻塞）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-09T16:26:06.567

这篇文章描述了您的问题的解决方案[http://petersiemen.net/parsing-large-xml-streams-with-enumerators-iteratees-and-enumeratees/](http://petersiemen.net/parsing-large-xml-streams-with-enumerators-iteratees-and-enumeratees/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-30T00:53:45.310

基于 XOM的[Nux](http://dst.lbl.gov/ACSSoftware/nux/)解析器将接受分块输入，并且专为流式传输大型 XML 文件而设计。这听起来正是你想要的。

# jquery - CSS、jQuery、Mosaic 组合问题

> ID：11486542
> 
> 赞同：0
> 
> 时间：2012-07-14T19:01:30.987
> 
> 标签：jquery, html, css, mosaic

我在这个 Web 项目中遇到了与 CSS 相关的问题。该网站是用 PHP 编码的，但在这个例子中，我只是发布了相关的 HTML。

我已经编译了我的 CSS（从 .SCSS 编译）并附加了整个 CSS 文件。

这是小提琴 - 整个 CSS 文件
第二个小提琴 - 只是马赛克 CSS

> [编辑]
> **澄清：**
> 这里有三个图像彼此相邻排列，间隔 10 像素。马赛克 jquery 插件，在悬停状态期间，向上动画标题文本并带入视图 ap 元素文本。此外，通过 css 悬停时还有一个灰度过滤器。
> 
> **问题是**我的 CSS 编辑出了点问题，现在图片甚至都不会显示。没有显示任何内容。
> 
> **什么 CSS 属性导致这些图像不显示？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:12:00.153

`display: none`从 CSS 中的马赛克背景中删除。这导致图像不显示：-

[http://jsfiddle.net/aTTL4/5/](http://jsfiddle.net/aTTL4/5/)

# css - div对齐创建新行

> ID：11486548
> 
> 赞同：2
> 
> 时间：2012-07-14T19:02:09.560
> 
> 标签：css, html, alignment

我正在使用下面的代码

```
​&lt;div align="left">
Line 1
</div>
<div align="right">
Line 2
</div> 
```

我期望在同一行`Line 1`的左侧和`Line2`右侧输出，但是我在两行中得到输出。我怎样才能在一行中得到这个？

## [jsfiddle](http://jsfiddle.net/7zqJY/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:04:07.220

```
<div style="float: left">Line 1</div>
<div style="text-align: right">Line 2</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:15:05.910

我假设你是 HTML/CSS 的新手，所以我建议你阅读一些关于样式如何工作的初学者教程。

默认情况下，div 元素设置为“显示：块”，因此您看到的是预期的行为。第一个 div 的宽度占据了父元素的整个宽度，因此当第二个 div 被渲染时，它会下降到下面的行（因为它不再适合第一个 div 的“旁边”。

正如其他答案所指出的，您希望将样式设置为向左或向右浮动（元素的宽度将相应改变）。

这是新的小提琴：http: **[//jsfiddle.net/7zqJY/3/](http://jsfiddle.net/7zqJY/3/)** ​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:05:44.423

```
<div style="float:left; width:100px;">
  Line 1
</div>
<div style="float:left; width:100px;">
  Line 2
</div>
​ 
```

# sql-server - 如何将 SELECT 和 INSERT 命令组合到 SQL Server 中不存在的表中？

> ID：11486550
> 
> 赞同：2
> 
> 时间：2012-07-14T19:02:36.440
> 
> 标签：sql-server, sql-insert, sql

如何组合`SELECT`and`INSERT INTO`命令并将结果插入到 SQL Server 中的临时表中？

像这样的东西：

```
INSERT INTO #TempTable 
    SELECT * FROM MyTable; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-14T19:18:10.763

你有两个选择。第一个是创建您的临时表，然后使用`INSERT INTO`... `SELECT`，如下所示：

```
CREATE TABLE #temp (
  Col1 ...
);

INSERT INTO #temp
SELECT * FROM OtherTable; 
```

第二个选项是直接插入一个新的临时表：

```
SELECT  *
INTO    #temp
FROM    OtherTable; 
```

最大的不同是使用方法1，您需要提前指定临时表中的所有列。方法 2 为您提供了一个临时表，该表自动包含`OtherTable`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-14T19:07:45.757

您想插入一个尚不存在的表中吗？你的语法很接近。见[这里](http://msdn.microsoft.com/en-us/library/ms188029.aspx)。

```
SELECT * INTO #BrandNewTempTable FROM MyTable 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T19:07:35.880

您的临时表需要与原始表具有相同的字段

如果不是，您需要指定所有字段，如下面的代码：

```
INSERT INTO TEMPORARY_TABLE (field1, field1, field1)
SELECT (field1, field1, field1) FROM YOUR_TABLE; 
```

# javascript - HighCharts 未捕获的异常

> ID：11486553
> 
> 赞同：6
> 
> 时间：2012-07-14T19:03:03.020
> 
> 标签：javascript, jquery, highcharts

我正在尝试在本地运行此[jsFiddle](http://jsfiddle.net/2qfgg/11/)中的相同代码，但我从 firebug 收到错误

```
uncaught exception: Highcharts error #13: www.highcharts.com/errors/13 
```

包含的脚本文件：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="http://highcharts.com/js/testing.js"></script>
<script type="text/javascript" src="test.js"></script>  // my js file 
```

[这个jsFiddle](http://jsfiddle.net/r6emu/448/)也会发生同样的事情。

有谁知道为什么会这样？

**编辑**：我找到了问题的原因。实际上我必须把标签放在`<script type="text/javascript" src="test.js"></script>`我的标签之后`<div id="container"></div>`，否则即使我把`<script>`标签放在`<head>`. 我以前从来没有把脚本文件放在`<body>`标签中，这是我第一次遇到这个问题。有人可以解释一下为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-14T19:32:21.500

这意味着加载了Highcharts并加载了配置，但是renderTo选项错误，或者页面中没有具有该id的div。请参阅[www.highcharts.com/errors/13](https://www.highcharts.com/errors/13)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T10:26:22.893

您尝试将图表呈现到的元素/div 丢失

我用来解决 highcharts 错误 #13 的一组标准日志是

```
 console.log("JSON: " + JSON.stringify(chartingOptions));
        console.log("Render to element with ID : " + chartingOptions.chart.renderTo);
        console.log("Number of matching dom elements : " + $("#" + chartingOptions.chart.renderTo).length); 
```

这些应该在调用 Highcharts 构造函数之前添加

```
 chart = new Highcharts.Chart(chartingOptions); 
```

如果一切顺利，您应该会看到正确的元素 ID，长度为 1。

[排查 highcharts 错误 #13 | Highchart & Highstock @ jsFiddle](http://jsfiddle.net/jugal/avz9x/)

这是上面演示的日志

> JSON: {"chart":{"renderTo":"container"...}}
> 渲染到具有 ID 的元素：容器
> 匹配 dom 元素的数量：1

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-03T12:58:43.130

我想我知道为什么要在 div /div 之后添加该标签。如果您使用的是 JSP 或任何其他服务器端 stuf。**您应该在声明 div 容器之后**添加您的 Highcharts 脚本，以便它可以识别您的 div 的 id，然后继续渲染它。就像我在下面的示例中所做的那样：

```
 <head>
    <title>HighCharts :D</title>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
</head>
<body>
<div id="container" style="width: 600px; height: 400px; margin: 0 auto">
</div>
<script type="text/javascript">
    var myChart = Highcharts.chart('container', {
        chart: {
            type: 'bar'
        },
        title: {
            text: 'Fruit Consumption'
        },
        xAxis: {
            categories: ['Apples', 'Bananas', 'Oranges']
        },
        yAxis: {
            title: {
                text: 'Fruit eaten'
            }
        },
        series: [{
            name: 'Jane',
            data: [1, 0, 4]
        }, {
            name: 'John',
            data: [5, 7, 3]
        }]
    });

</script>
</body> 
```

# matlab - matlab for循环蛮力

> ID：11486555
> 
> 赞同：0
> 
> 时间：2012-07-14T19:03:18.047
> 
> 标签：matlab, optimization, for-loop, indexing, brute-force

嗨，我正在使用下面代码中显示的蛮力方法。

PV_supply、WT_supply 和 Demand 的大小都是 48x1。

我要做的是分别计算 n = 1:24 和 n = 25:48 的“hourly_deficit”方程，以便输出 2 个“集”的“hourly_deficit”

我的代码是

```
for number_panels = 0:5
    for number_turbines = 0:3
      for n = 1:24:48 % number of hours per day

  hourly_deficit(number_panels + 1, number_turbines + 1, n) =...
 Demand(n) - (PV_supply(n)*number_panels) - (WT_supply(n)*number_turbines);

end 
 end 
  end 
```

我希望在我应该如何调整 for 循环以获得我正在寻找的结果方面得到一些帮助。就目前而言，for n = 1:24:48 实际上只上升到 n = 24

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:35:14.343

`1:24:48`表示“从 1 以 24 到 48 的增量”：因此，`1 25 49...`如果您保持系列继续，这些值将是。由于`49`超出了您定义的范围，因此它停在`25`.

做你想做的事情的一种解决方案如下：

```
for n = 1:24 % 1 by 1 to 24

    hourly_deficit_1(...,..., n)= Demand(n)-(PV_supply(n)... %# truncated
    n=n+24;
    hourly_deficit_2(...,..., n)= Demand(n)-(PV_supply(n)... %# truncated

end 
```

要概括任意天数，请在矩阵中添加第 4 个维度。第三维是小时（1:24），第四维是天。

```
for h=1:24 %# hours
    for d = 1:num_days %# which day
        n = h + 24*(d-1);
        hourly_deficit_1(...,..., h, d)= Demand(n)-(PV_supply(n)... %# truncated
    end    
end 
```

# ruby-on-rails - 通过计时器调用不显眼的 javascript

> ID：11486559
> 
> 赞同：1
> 
> 时间：2012-07-14T19:03:30.517
> 
> 标签：ruby-on-rails

我想在我的 Rails 应用程序的一页上动态更新一些列表。我知道不显眼的 javascript 以及如何通过链接和表单调用它。但是，有没有什么漂亮的方法可以通过计时器调用不引人注目的 javascript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:24:20.847

你可以有类似的东西

```
<ul data-behaviour='list-updater'>
 ...
</ul> 
```

并在 javascript 资产文件中

```
$.fn.updaterComponent = function() {
   var timer= function () { ... };
   setInterval(timer, 1000);
}

$( function() { 
  $("[data-behaviour='list-updater']").updaterComponent();
}); 
```

这将是相当不显眼的:)

# android - 每个进程的内存和 CPU ANDROID

> ID：11486570
> 
> 赞同：0
> 
> 时间：2012-07-14T19:04:12.477
> 
> 标签：android, android-intent, android-service

我正在开发一个 android 应用程序，我想在其中获取正在运行的进程或应用程序列表。我找到了一种使用活动管理器的方法。但我不知道如何让每个进程使用的处理器和内存。有谁知道我怎样才能实现这个目标。

获取正在运行的进程的代码是，

我从上面的代码中获得了所有正在运行的应用程序进程。请帮助我获取列表中每个进程的值。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-15T00:04:18.503

1.  CPU 负载 - 您需要阅读 /proc/[pid]/stat （参考[http://linux.die.net/man/5/proc](http://linux.die.net/man/5/proc)）。寻找 utime 和 stime，它们是进程在用户模式和内核模式上花费的时间。一个很好的例子来了解它是如何工作的，你可以找到 top 实用程序的源代码（查看 top.c 中的 read_stat 函数）。

2.  内存使用 - 传统上，人们再次读取 /proc/[pid]/stat 以获取 rss 字段。现在更流行的是使用 PSS。（参考[http://developer.android.com/reference/android/os/Debug.html#getPss%28%29](http://developer.android.com/reference/android/os/Debug.html#getPss%28%29)）。可以wiki 上关于RSS 和PSS 的定义和区别——这和全球共享库的大小有关。

# wordpress - Etsy.com 类型网站 CMS - wordpress 还是 drupal？

> ID：11486574
> 
> 赞同：-2
> 
> 时间：2012-07-14T19:04:35.353
> 
> 标签：wordpress, drupal

好的，所以我想建立一个类似于 Etsy.com 的网站，允许用户创建帐户并发布他们的商品进行销售。

通常我是从头开始构建的，但我想知道是否有一个好的 Wordpress 插件或 Drupal mod 可能更适合我使用，而不是重新发明轮子。

有任何想法吗？如果您有 drupal 建议，请列出任何有用的 mods 或有用的 wordpress 插件......或者如果您有另一个您喜欢的 CMS，那也很好。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:13:35.073

MarketPress，如果您尝试利用 Wordpress，可能是一个好的开始。它在 Wordpress 中与 BuddyPress（多用户）和 MultiSite 相关联。

[http://premium.wpmudev.org/project/e-commerce/](http://premium.wpmudev.org/project/e-commerce/)

# python - 函数、列表和正方形

> ID：11486575
> 
> 赞同：-1
> 
> 时间：2012-07-14T19:04:52.087
> 
> 标签：python, list

此过程的想法是转换“正方形”（列表列表）并将其翻转。例如，通过输入“正方形”

> [[1,2,3],[1,2,3],[1,2,3]]

程序应该返回

> [[1,1,1],[2,2,2],[3,3,3]]

```
def turn_square(list4)
  n_index = [0,1,2]
  turned = []
  blank = []
  turned_i = 0
  for k in n_index:
    turned.append(blank)
  for i in n_index:
    for j in n_index:
      turned[turned_i].append(list4[j][i])
    turned_i = turned_i + 1 
```

但是，不知道为什么，它又回来了

> [[1, 1, 1, 2, 2, 2, 3, 3, 3], [1, 1, 1, 2, 2, 2, 3, 3, 3], [1, 1, 1, 2, 2、2、3、3、3]]

任何想法为什么？请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T19:06:12.323

```
zip(*square) 
```

应该工作......这将转置一个二维数组

```
>>> square = [[1,2,3],[1,2,3],[1,2,3]]
>>> zip(*square)
[(1, 1, 1), (2, 2, 2), (3, 3, 3)] 
```

一个警告是，这会创建一个元组列表......这使得它们不可变......但也更快

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:13:55.667

我会用`zip`自己，但你的代码中的根本问题在这里：

```
blank = []
[...]
for k in n_index:
    turned.append(blank) 
```

您可能认为这会附加一个新的空列表，因此 turn 包含三个空列表。但是相反，它会将三个引用附加到*同一个*空列表，因此您对其中一个所做的一切都会发生在其中的“全部”上（“全部”用引号引起来，因为实际上只有一个。）

```
>>> blank = []
>>> a = [blank, blank]
>>> a
[[], []]
>>> a[0].append("fred")
>>> a
[['fred'], ['fred']] 
```

它们是内存中的同一个对象：

```
>>> a[0] is a[1]
True 
```

如果我们更改您的代码以创建新列表 [并添加`return turned`]，即

```
 turned.append([]) 
```

然后它工作：

```
>>> x = [[1,2,3], [1,2,3], [1,2,3]]
>>> x
[[1, 2, 3], [1, 2, 3], [1, 2, 3]]
>>> x = turn_square(x)
>>> x
[[1, 1, 1], [2, 2, 2], [3, 3, 3]]
>>> x = turn_square(x)
>>> x
[[1, 2, 3], [1, 2, 3], [1, 2, 3]] 
```

[我没有做任何其他错误测试，所以它仍然可能不正确，但这解释了你看到的奇怪症状。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:50:14.397

这似乎是数字数据，根据您的目标，numpy 数组数据类型（和转置操作）可能是您想要的。这将提高性能，这对于大型数据集可能很重要。

但是，如果您绝对必须将其作为 python 列表（例如，如果列表包含文本和数字数据的混合）并且如果上面的元组解决方案不能满足您的需求（例如，如果您需要进行进一步的操作来编辑结果稍后到位），您可以尝试嵌套列表推导。

```
>>> data = [[1,2,3],[1,2,3],[1,2,3]]

>>> [ [ j[i] for j in data ] for i in range( len(j) ) ]
[[1, 1, 1], [2, 2, 2], [3, 3, 3]] 
```

# ruby-on-rails - 本地文件上的 Carrierwave 自定义标头

> ID：11486576
> 
> 赞同：1
> 
> 时间：2012-07-14T19:05:04.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, carrierwave

我想使用自定义标头（特别是 content-disposition 标头）从某个上传者发送所有文件。我的文件没有存储在 Fog / S3 上，它们存储在本地。

所以我想知道，是否可以在文件上附加某些标题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T20:14:25.223

在文件本身没有。这取决于您如何提供这些文件。如果文件由您的网络服务器直接提供，您需要调整配置文件。如果文件由您的应用程序中的控制器提供服务，您可以修改处理它的操作的标题。

这里有一些提示

1.  对于 nginx [http://jeremywalworth.com/index.php?q=node/41](http://jeremywalworth.com/index.php?q=node/41)
2.  对于 apache [https://serverfault.com/questions/101948/how-to-send-content-disposition-headers-in-apache-for-files](https://serverfault.com/questions/101948/how-to-send-content-disposition-headers-in-apache-for-files)
3.  对于轻量级[http://azgtech.wordpress.com/2011/01/26/force-download-pdf-using-lighttpd/](http://azgtech.wordpress.com/2011/01/26/force-download-pdf-using-lighttpd/)
4.  如果您尝试使用 rails 控制器提供文件，您应该查看 ActionController::DataStreaming#send_data 文档。

# google-apps-script - 使用 html 服务无法正常工作的 html 文件

> ID：11486583
> 
> 赞同：0
> 
> 时间：2012-07-14T19:06:25.953
> 
> 标签：google-apps-script

我已经完全重复了 Google Html 服务[教程](https://developers.google.com/apps-script/html_service#CreatingHTML)中描述的所有步骤，唯一的区别是这是我的 html 文件：

```
<html>
  <a href="http://www.google.com">google</a>
</html> 
```

但是当我打开已部署脚本的 url 时，页面仅显示字符串“google”并且无法识别该链接。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:08:47.603

```
<html>
<head>
    <title>Title</title>
</head>
<body>
    <a href="http://www.google.com">google</a>
</body>
</html> 
```

您缺少头部和身体部位，请尝试添加它们，尽管据说它们只是可选的，看看它是否有效..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T02:20:13.780

那应该行得通。如果您在此处发布整个脚本，我可以自己尝试一下，看看会发生什么。

# android - 使用时间选择器制作闹钟

> ID：11486587
> 
> 赞同：0
> 
> 时间：2012-07-14T19:07:04.393
> 
> 标签：android, time, timepicker

所以我想做的是做一个闹钟。我无法获取当前时间并获取时间选择器的时间来比较它们。如果你能帮助我一点，只是让时间选择器的时间和当前时间在同一种测量中会很棒。

非常感谢=）这是我的代码：

```
public class AlarmlockActivity extends Activity implements OnClickListener {
    TimePicker tp;
    Button set;
    long currentTime;
    long alarmTime;
    long alarmHourmil;
    DigitalClock dc;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    tp = (TimePicker) findViewById(R.id.tpAlarmTime);
    set = (Button) findViewById(R.id.bSet);
    dc = (DigitalClock) findViewById(R.id.digitalClock1);
    currentTime = System.currentTimeMillis();
    set.setOnClickListener(this);
}

public void onClick(View v) {
    switch(v.getId()){
    case R.id.bSet:
        break;
    }
}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T22:09:32.127

我假设从当前时间中提取*小时*和*分钟*足以获得*“时间选择器的时间和当前时间在同一种测量*中。

如果是这种情况，您可以使用`Calendar`类（[请参阅文档](http://developer.android.com/reference/java/util/Calendar.html)）来提取有关当前时间的信息。这是一个示例代码，假设您想使用 default`Locale`和`TimeZone`，如果不是这种情况，请[参考其他](http://developer.android.com/reference/java/util/Calendar.html#getInstance%28java.util.Locale%29) `Calendar.getInstance()`方法。

```
// Get Calendar object with current date and time (assumes default Locale and TimeZone).
Calendar calendar = Calendar.getInstance()

// Retrieve info about current time.
int hour = calendar.get(Calendar.HOUR);
int minute = calendar.get(Calendar.MINUTE);

// Compare with values selected in TimePicker
if (tp.getCurrentHour().intValue() == hour) { // similar applies to 'minute'
    // do whatever you want
} 
```

# api - 通过 Graph API 发布喜欢

> ID：11486596
> 
> 赞同：0
> 
> 时间：2012-07-14T19:07:50.507
> 
> 标签：api, facebook-graph-api

Graph API 不起作用，并且在发布 /ID/likes 时出现错误代码 100，并且没有文档所述的参数。

有谁能够帮我？正如文档所说，这甚至可以做到吗？如果我尝试使用 Graph API Explorer，我会得到同样的错误。

[http://developers.facebook.com/tools/explorer](http://developers.facebook.com/tools/explorer)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:53:43.617

连接`likes`仅用于`GET`请求

> 该用户喜欢的所有页面。

你不能用它来发布喜欢。

您可以通过发出具有or权限的`HTTP GET`to来阅读用户喜欢的页面。`/PROFILE_ID/likes``user_likes``friends_likes`

[在http://developers.facebook.com/docs/reference/api/user/#likes](http://developers.facebook.com/docs/reference/api/user/#likes)阅读更多内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T08:11:08.500

您可以通过向具有 publish_stream 权限的 POST_ID/likes 连接发出 HTTP POST 请求来点赞帖子。不需要参数。

如果写入成功，您将获得以下返回。

```
Description         Type
If the like succeeded   boolean 
```

# javascript - 我无法使用 Graph Api 创建事件

> ID：11486597
> 
> 赞同：2
> 
> 时间：2012-07-14T19:08:05.723
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 Graph API 从 facebook 创建和获取事件。尝试各种方式，但总是得到相同的结果。在创建事件的情况下，我得到一个 ID，但该事件从未在我的帐户中看到。当试图让我的事件总是得到一个空数组。尝试使用 fql.query 进行查询但得到相同的结果，然后在以下查询中测试我的应用程序并得到他想要的。 [https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)

有人可以帮助我。非常感谢你。

这就是我正在做的

**创建活动**

```
FB.api('/me/events', 'POST', {
        name: "Evento desde mi app",
        start_time: d1,
        //end_time: d2,
        location: "En Quilmes"
    }, function (res) {
        console.log(res);

    }); 
```

**获取事件**

```
FB.api('me/events',function(data) { 
        console.log(data);
    });

FB.api({
            method: 'fql.query',
            query: 'SELECT name FROM event WHERE eid IN ( SELECT eid from event_member WHERE uid = xxxxxxx) AND creator = xxxxxxx'

        },function(response) { 
            console.log(response);
        }
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T13:48:43.597

我可以创建一个事件，但我仍然无法获取我的事件。尝试添加访问令牌，但我得到一个空数组。

这是创建事件的代码

```
 var accessToken =   FB.getAuthResponse()['accessToken'];
    var name = "My Event";
    var startTime = "07/29/2012 12:00 PM";
    var endTime = "07/29/2012 06:00 PM";
    var location = "Argentina";
    var description = "description";

    var eventData = {
        "access_token": accessToken,
        "start_time" : startTime,
        "end_time":endTime,
        "location" : location,
        "name" : name,
        "description":description,
        "privacy":"OPEN"
    };
    FB.api("/me/events",'post',eventData,function(response2){
        console.log(response2);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T21:02:00.437

> 来自 Graph API/FQL 的事件 GET 将需要访问令牌

所有从 Graph API 或 FQL 获取事件的调用现在都需要使用访问令牌。

**正如 Facebook 宣布的那样：** [https ://developers.facebook.com/blog/post/2012/06/20/platform-updates--operation-developer-love/](https://developers.facebook.com/blog/post/2012/06/20/platform-updates--operation-developer-love/)

# php - Symfony2：每次服务调用的新实例，而不是使用相同的

> ID：11486599
> 
> 赞同：3
> 
> 时间：2012-07-14T19:08:07.340
> 
> 标签：php, symfony

我创建了一个服务，但每次调用它时，它都会创建一个新实例，而不是使用同一个实例。这是我的 services.yml：

```
my.sessiondata:
    class: My\Bundle\Service\SessionData
    calls:
        - [ setServices, [@security.context, @service_container, @session, @doctrine.orm.entity_manager] ]
    scope: container 
```

我的服务：

```
namespace My\Bundle\Service;

class SessionData
{  
    protected $company;

    public function setServices($securityContext, $serviceContainer, $session, $em)
    {
        var_export($this->company);
        if (!$this->company)
        {
            $this->company = "TEST";
            var_export($this->company);
        }
    }
} 
```

我在这样的控制器中调用服务：

```
 $sessionData = $this->container->get('my.sessiondata'); 
```

每次我调用控制器时，视图都会显示 NULL'TEST'。

知道为什么实例丢失了吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-14T19:20:39.730

在一个请求期间，每次您调用

```
$this->container->get('my.sessiondata') 
```

只要范围设置为容器（这是默认设置），您就会得到相同的实例。

**容器不会在请求之间共享实例。**这就是 PHP 的工作原理。每个请求都是独立的。虽然您可以共享一些数据（例如在会话中），但在单个请求期间创建的所有对象在完成后都会被销毁。下次您访问服务器时，所有内容都需要重新创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-22T22:23:53.043

您必须与`scope`s 合作。`scope`服务的时间控制容器使用服务实例的时间。正如 Symfony2 文档所示：

`container`（默认）：每次从该容器请求时使用相同的实例。 `prototype`：每次请求服务时都会创建一个新实例。

```
services:
    my_service:
        class: YourClass
        scope: prototype 
```

更多关于范围[在这里](http://symfony.com/doc/current/cookbook/service_container/scopes.html)。

# php - 根据当前站点显示内容

> ID：11486600
> 
> 赞同：1
> 
> 时间：2012-07-14T19:08:11.537
> 
> 标签：php, javascript

是否可以使用 JavaScript 完成相同的操作？

```
<?php
$url = $_SERVER['PHP_SELF'];
$needle = 'php';

if(strstr($url, $needle)){
    $bool = true;
    }
else{
    $bool = false;
}

if($bool){
?>
    Text
<?php
}else{
?>
    Another text...
<?php
}
?> 
```

基本上我需要根据当前站点显示不同的 HTML 内容。一些部分被包含在不同的站点中。

***编辑：***

可以吗，这样做：

```
<script>
var url = document.URL;
var needle = 'test';
var bool = false;
if(url.indexOf(needle) != -1){
  bool=true;
}
document.write(bla);
</script>

<table border="1">
<script>
if(bool){
  document.write('<tr><td>abc</td><td>def</td></tr>');
}
</script>
  <tr><td>ghi</td><td>jkl</td></tr>
</table> 
```

我不确定表中的**JavaScript** ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:10:22.543

当然。只是`location.href.indexOf("php") > -1`用来看看它是否在那里。

# javascript - 原型 JavaScript Event.observe - 如何观察可能存在或不存在的元素

> ID：11486602
> 
> 赞同：1
> 
> 时间：2012-07-14T19:08:22.107
> 
> 标签：javascript, refactoring, prototypejs, dom-events, observers

我正在使用 Prototype JavaScript，我有一个按钮，我想使用 Event.observe 方法来观察点击操作。

问题是我想根据 PHP 代码中的 if 语句调用两个函数之一。我对 Javascript 和 Event.observe 方法的理解非常有限，但是在尝试观察不存在的元素时，代码似乎不起作用。我可以让它以一种非常hacky的方式工作，如下所示：

```
<?php if ($_type == "forward_second"):?>
    <input type="button" id="week_backward_second" value="&lt;&lt;" disabled/>
    <input type="hidden" id="week_backward" value="&lt;&lt;" />
<?php else: ?>
    <input type="button" id="week_backward" value="&lt;&lt;" disabled/>
    <input type="hidden" id="week_backward_second" value="&lt;&lt;" />
<?php endif; ?> 
```

在 JavaScript 中：

```
initialize: function {    
    Event.observe('week_backward', 'click', this.backward.bind(this));
    Event.observe('week_backward_second', 'click', this.backwardSecond.bind(this));
}, 
```

通过拥有一个隐藏字段，“不必要的”`Event.observe`有一个需要观察的元素并且代码可以工作。

任何人都可以提出更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:50:06.633

我希望我理解你的问题:)

```
var element = $('week_backward'),
    method = this.backward;

// Get a second element if first doesn't exist.
if (!element) {
    element = $('week_backward_second');
    method = this.backwardSecond;
}

element.observe('click', method.bind(this)); 
```

我使用了较短的 Prototype API - 除非您与我推荐的其他库没有冲突。

PS。我忘了说现在你只需要打印一个按钮，没有隐藏的按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T08:31:32.087

1.  没有隐藏字段。在观察之前检查元素的存在（如 Reinmar 所写）：

    ```
    initialize: function {    
        if ($('week_backward')) $('week_backward').observe('click', this.backward.bind(this));
        if ($('week_backward_second')) $('week_backward_second').observe('click', this.backwardSecond.bind(this));
    }, 
    ```

2.  没有隐藏字段。使用[事件委托](http://api.prototypejs.org/dom/Event/on/)：

    ```
    initialize: function {
        document.on('click', '#week_backward', this.backward.bind(this));
        document.on('click', '#week_backward_second', this.backwardSecond.bind(this));
    }, 
    ```

    观察者附加到`document`并接收`click`从您的元素冒泡的事件（如果存在）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-20T21:51:51.587

另一种处理方法是使用 $$ 并调用。这样，您将遍历一个包含一个元素或没有元素的数组，并在需要时应用该方法。

```
$$('#week_backward').invoke('observe', 'click', this.backward);
$$('#week_backward_second').invoke('observe', 'click', this.backwardSecond); 
```

# php - 从内部 php 函数调用变量以在外部函数中使用

> ID：11486604
> 
> 赞同：1
> 
> 时间：2012-07-14T19:08:28.710
> 
> 标签：php, nested-function

目前我有以下代码

在我的'function.php'里面是

```
function calcTime($database_name,$currentTime){

    global $startTime;
    global $endTime;

    ...calcutions

    return $startTime;
    return $endTime;
}//end calcTime() 
```

在我的主要'index.php'里面我有

```
include('/function.php');

$databaseName = foo;

$currentTime = 12.30;

function begin($database_name,$currentTime){

    ...some calculations

    calcTime($database_name,$currentTime); //calling the function from other file

echo $startTime;

echo $endTime;

}// end begin() 
```

我遇到的问题是在内部函数中声明的变量不会传递给外部函数。我已经声明了全局变量并返回了它们。不知道发生了什么。

不过有趣的是，如果我回显 calcTime($database_name,$currentTime); 返回 $startTime 但不返回 $endTime。

请帮忙。我有在我想以这种方式使用的其他函数中使用的函数。谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:17:35.377

第一个问题是`global`在 PHP 中有点违反直觉。我知道这让我很困惑。它不会使函数内部的变量在外部可访问；相反，它允许您在函数中使用在外部声明的变量，例如：

```
$foo = 'hello';
function bar() {
    global $foo;
    echo $foo;
} 
```

你想要做的是返回两个变量。但是，您只能`return`执行一次。一旦 PHP 到达一个`return`语句，它就会结束函数，所以第二个永远不会运行。

我建议做的是返回一个包含两个值的数组，例如：

```
return array('startTime' => $startTime, 'endTime' => $endTime); 
```

然后，您可以使用`extract`再次使它们成为变量：

```
extract( calcTime() );
echo $startTime;
echo $endTime; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:13:46.397

简单地说：调用作用域也不是`global`作用域......所以要让它工作，变量也*必须*在那里声明`global`。请注意，（过度）使用全局变量被认为是不好的做法，并且对于您的编码人员（甚至是您在一段时间过去后）进行调试是地狱。支持参数和返回。

** 请记住，每个函数在 php 上都是隔离的，当您在一个函数上设置全局或变量时，该函数仅在函数范围内可见

当然，您只能返回**一个**值，但这也可能是一个更复杂的值，例如：

```
return array('startTime' => $startTime,'endTime' => $endTime); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T19:20:58.213

PHP 中的`global`关键字用于访问在函数外部声明的全局变量。它是写作的语法糖`$var =& $GLOBALS['var']`。

至少有两个选项可以从函数中返回两个变量：按引用调用或返回数组：

```
function calcTime($database_name,$currentTime){
    return array('start' => $startTime, 'end' =>  $endTime);
}

$times = calcTime(…, …);
echo $times['start'], ' and ', $times['end'];
// or:
list($start, $end) = calcTime(…, …);
echo $start, ' and ', $end; 
```

或者，将参数作为引用传递：

```
function calcTime($database_name,$currentTime, &$startTime, &$endTime){
    $startTime = …;
    $endTime = …;
}

$startTime = 0;
$endTime = 0;
calcTime(…, …, $startTime, $endTime);
echo $startTime, ' and ', $endTime; 
```

# php - MySQL 查询和数据调试

> ID：11486610
> 
> 赞同：1
> 
> 时间：2012-07-14T19:09:49.010
> 
> 标签：php, mysql

我正在管理一个包含大约 140.000 个文档的网站。使用相同的设置，这个系统已经运行了两年多没有问题。我们不得不将我们的服务器迁移到一个新的基础设施，从那时起就出现了一些异常情况。

每个文档在数据库中都有一个状态。状态码 (int) 5 表示文档被删除/移除。

每隔一小时左右，大约 10 个文档的状态码会更改为 5。我们不会丢失实际文档，但最终用户无法使用它。我试图找出导致问题的原因，但找不到问题的根源。

我们有两个可以更改文档状态的查询。我暂时禁用了其中一个，并且在代码库中将已删除文档的状态码更改为 6。

但是，我们仍然遇到同样的问题，状态码变为 5，而不是 6。

我启用了查询日志，并花费了数小时，但对那些已删除的文档没有更新查询，除了 view_count 增加，这是一个非常短且简单的查询。该文档在被删除的同时被某人请求。但是，所有查询都是选择查询（view_count 除外），与其他文档没有区别。我们每秒有数百次页面浏览量。只有其中一个被随机删除。

因此，如果我可以在查询日志中看到，我可以尝试在代码库中找出该特定查询。但是，它甚至什么都没有显示。所以，我现在一头雾水。

你有什么建议吗？我必须解决这个问题，所以我可以尝试任何事情。

新系统是；

Debian 6.0.5 MySQL 5.5.24 - Percona 构建 PHP-NGINX-SOLR 框

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:29:11.153

[使用Jet Profiler](http://www.jetprofiler.com)或Percona [Toolkit](http://www.percona.com/software/percona-toolkit/)`UPDATE`分析查询，分析它们，您将找到答案。

[通用查询日志](http://dev.mysql.com/doc/refman/5.1/en/query-log.html)还可以帮助您找到特定的更新查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T18:21:42.227

Percona Toolkit 很棒，但它甚至没有显示与此问题相关的任何内容。（包括 tcpdump 等）

我已经安装了 Oracle build MySQL 5.5.25a，它工作正常。这是我整个职业生涯中见过的最奇怪的错误。

# mysql - MySQL DB 和两个单独的表 1:M

> ID：11486616
> 
> 赞同：0
> 
> 时间：2012-07-14T19:10:15.197
> 
> 标签：mysql

我已经创建了两个单独的表并填充了信息。第一个表有一个称为主机名的唯一字段。每个主机名在第二个表中可能有多个记录。我已经创建了它们，并且主机名已插入两个表中。现在，我该如何连接它们？

我正在使用 MySQL 工作台。我必须在 table2 中创建外键，这个键应该是主机名。现在，如果我想在插入 table1 之前插入 table2。这可能吗？即，我的程序以在table1 之前插入table2 的信息的方式运行。插入语句有什么变化吗？在 table2 中插入时，我是否必须指定有关 table1 的任何内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:16:22.030

如果您有外键，则它*必须*始终引用有效记录或为 NULL。如果需要插入`table2`before `table1`，必须先插入`table2`外键列NULL的记录，再插入`table1`记录，最后更新`table2`引用到的记录`table1`。

这是一个奇怪的类比，但可以把它想象成建造房子。如果你在打地基之前在现场建造它，你就有问题了。但是，你可以在某个地方建造它，然后建造地基，然后把房子搬到上面。

现在，在旁注中，我确实必须质疑您为什么要插入`table2`之前`table1`...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:17:23.047

FOREIGN KEY 约束用于阻止您的程序执行的操作。

它不允许您创建具有主主机名表（您的表 1）中不存在的主机名值的详细记录（您的表 2）。

您要么必须更改应用程序的工作方式，要么不连接这两个表。在后一种情况下，您必须自己维护它们之间的数据完整性。

您必须定期测试详细记录中的新主机名，如果不存在则创建它们。

我怀疑您一直在表中写入日志记录，但您还需要一个主机名“主文件”来保存每个主机的信息。

如果是这种情况（或类似情况），请不要连接表并手动维护主机名主文件（即使用一些计划运行并执行 table1 维护的存储过程）。

# android - android 市场：“从服务器获取身份验证失败 -> 使身份验证令牌无效”

> ID：11486619
> 
> 赞同：1
> 
> 时间：2012-07-14T19:10:34.493
> 
> 标签：android

有人知道如何解决这个问题吗？我有一台旧设备（Google I/O 手机），我发现无论我做什么，我都无法安装或升级任何应用程序。

我试过重启、清除所有缓存、删除应用程序以节省内存、安装 SIM 卡、移除 SIM 卡以及其他所有操作。

当我运行 logcat 时，每当我尝试安装应用程序时都会看到此消息：

```
com.android.vending.AsynchRequestRunner$1.runRequestRetryingFailure(): Got auth failure from server -> invalidating auth tokens. 
```

有人有什么想法吗？

更新：也在运行 1.5 的 Samsung Moment 上看到了这一点。Android Market 是否可能停止支持 1.5？

另一个更新；恢复出厂设置似乎已经解决了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-06T18:09:53.287

我的旧 T-Mobile G1 (Android 1.6) 也有同样的问题。我尝试清除各种缓存和同步数据，并使用 Google Talk 之类的。**最终解决的是卸载 Android Market 应用程序更新。**然后我只需要再次登录（使用特定于应用程序的 Google 帐户密码）并且应用程序的下载工作正常。

# content-type - Spring Integration http 入站网关映射响应标头 - 被重复？

> ID：11486620
> 
> 赞同：1
> 
> 时间：2012-07-14T19:10:40.877
> 
> 标签：content-type, spring-integration

我正在尝试为图像主机服务设置响应的内容类型，所以我有一个如下所示的 http:inbound-gateway：

```
<int-http:inbound-gateway request-channel="receiveChannel"
                          reply-channel="responseChannel"
                          path="/profile/photo"
                          mapped-response-headers="Content-Type"
                          message-mappers="messageConverterList"
                          supported-methods="GET"/> 
```

...和一个看起来像这样的服务激活器：

```
<int:service-activator 
    input-channel="receiveChannel" 
    output-channel="imageResponseChannel"
    expression="@profileService.getPhoto(payload.userId)"/> 
```

...它返回一个字节[]的JPEG图像数据。我有一个看起来像这样的标题丰富器：

```
<int:header-enricher
    input-channel="imageResponseChannel"
    output-channel="responseChannel">
    <int:header
        name="Content-Type"
        expression="'image/jpeg'"/>
</int:header-enricher> 
```

但是当我运行该项目时，我会收到带有如下标题的响应：

```
< HTTP/1.1 200 OK
< Set-Cookie: JSESSIONID=9uw5c136fia6s9ivxgivy1yc;Path=/
< Expires: Thu, 01 Jan 1970 00:00:00 GMT
< Content-Type: image/jpeg
< Content-Type: application/octet-stream
< Content-Length: 6563
< Server: Jetty(8.1.3.v20120416) 
```

请注意，内容类型是重复的，但我的理解是映射响应标头应该从消息中获取标头，而不是从有效负载中确定它。

有任何想法吗？提前致谢！

*编辑：我更改了入站网关以引用下面的自定义消息映射器，但我仍然得到相同的结果。

```
<util:list id="messageConverterList">
    <bean class="org.springframework.http.converter.ByteArrayHttpMessageConverter">
        <property name="supportedMediaTypes">
            <list><value>image/jpeg</value></list>
        </property>
    </bean>
</util:list> 
```

*编辑2：原来它应该是消息转换器，但我没有收到错误，因为我修改了目标文件而不是src。我进行了更正，这是我得到的输出：

```
< HTTP/1.1 200 OK
< Content-Type: image/jpeg
< Content-Type: image/jpeg
< Content-Length: 209582
< Server: Jetty(6.1.10) 
```

更好，但并不完美。这是该问题的简单再现项目：http: [//dl.dropbox.com/u/92800052/http.tar.gz](http://dl.dropbox.com/u/92800052/http.tar.gz)

你可以运行它

```
mvn package jetty:run 
```

并查看输出

```
curl -v http://localhost:8080/http/photo > /dev/null 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T21:05:53.943

默认情况下，为入站网关注册了几个 HttpMessageConverter（来自核心 Spring Web 库）。其中之一是 ByteArrayHttpMessageConverter，它的默认内容类型是“application/octet-stream”。您能否尝试在网关上设置“消息转换器”属性，使其引用包含单个 ByteArrayHttpMessageConverter 实例的列表类型 bean（例如，您可以使用 util:list） - 而不是依赖默认转换器，然后在该实例上，将supportedMediaTypes 属性设置为“image/jpeg”。

AFAIK，ByteArrayHttpMessageConverter 不应该尝试设置 Content-Type 标头，如果已经存在（即来自映射的响应标头），但我只想检查并查看该更改是否确实绕过了重复。

另外，您能否告诉我们您使用的是哪个版本的 Spring Integration？

谢谢，马克

# c++ - 如何在 C++ 中实现对私有变量的访问？

> ID：11486622
> 
> 赞同：13
> 
> 时间：2012-07-14T19:10:43.607
> 
> 标签：c++, memory-management, private-members, data-protection

编译器如何控制内存中变量的保护？内存中是否有与私有变量相关的标记位？它是如何工作的？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-14T19:12:02.607

如果您的意思`private`是实例的成员，那么在运行时没有任何保护。所有保护都发生在编译时，如果你知道它们在内存中的布局，你总是可以得到一个类的私有成员。这需要了解平台和编译器，在某些情况下甚至可能取决于编译器设置，例如优化级别。

例如，在我的带有 GCC 4.6 的 Linux/x86-64 上，下面的程序完全按照您的期望打印。它绝不是可移植的，并且可能会在异国情调的编译器上打印出意想不到的东西，但即使是那些编译器也会有自己特定的方式来获取私有成员。

```
#include <iostream>

class FourChars {
  private:
    char a, b, c, d;

  public:
    FourChars(char a_, char b_, char c_, char d_)
      : a(a_), b(b_), c(c_), d(d_)
    {
    }
};

int main()
{
    FourChars fc('h', 'a', 'c', 'k');

    char const *p = static_cast<char const *>(static_cast<const void *>(&fc));

    std::cout << p[0] << p[1] << p[2] << p[3] << std::endl;
} 
```

（存在复杂的转换是因为`void*`它是唯一可以将任何指针转换为的类型。`void*`然后可以在`char*`不调用[严格别名规则](https://stackoverflow.com/questions/6320789/c-aliasing-rules)的情况下转换为。也可以使用一个单一`reinterpret_cast`的 - 实际上，我从不玩这个一种肮脏的把戏，所以我不太熟悉如何以最快的方式做到这一点:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:15:58.170

编译器的工作是查看某些成员是私有的并禁止您使用它们。他们不是~~任何~~编译后与其他成员有很大不同。

然而，有一个重要的方面**是**，数据成员不需要按照它们在类定义中出现的顺序排列在内存中，但是对于具有相同访问级别的变量，它们是必需的。

# xaml - 在 WinRT XAML 应用程序中首次加载时未播放过渡

> ID：11486623
> 
> 赞同：1
> 
> 时间：2012-07-14T19:11:06.037
> 
> 标签：xaml, windows-8, microsoft-metro, windows-runtime, winrt-xaml

在我的 WinRT XAML 应用程序中，我的 Main.xaml 页面上有一个 EntranceThemeTransition，当您第一次加载应用程序时它不会播放（App.Xaml 执行 Main.xaml 的帧加载）。但是，一旦加载了应用程序并且我离开 Main 然后返回它就会播放。我在我构建的其他 WinRT 应用程序中注意到了这一点。

它是已知的错误还是允许更快启动的功能？我花时间做了一个很好的介绍过渡，遗憾的是大多数用户不会看到它。似乎转换在应用程序加载时在后台加载，当用户在页面上加载时，转换已完成。

目前，我正在使用 Thread.Wait 和其他一些技巧——但它们并没有使这成为一种“快速流畅”的体验，并且当您从另一个页面导航回它们时，它们会使过渡看起来很笨拙。还有其他人对此有问题吗？强制入口动画在首次加载时播放的最佳做法是什么？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-27T21:27:49.650

我相信这主要是因为元素已经在 XAML 树中创建，但是当您从 Web 服务加载数据时，这些元素所绑定的内容是唯一迟到的内容。所以从技术上讲，它是动画的，但你看不到它，因为它们没有内容。您可以使用 DeferredContentPresenter 来修复它，它将您的 XAML 作为等待 VM 指示它已加载数据的 DataTemplate。然后，您可以使用 DataTemplate 上的 LoadContent 函数来创建 XAML 树。现在，由于元素已创建并且数据也同时可用，您应该会看到入口动画。

您可以调整此处给出的代码：[延迟加载 XAML](https://stackoverflow.com/questions/26537300/deferred-loading-of-xaml)并添加 IsLoaded 属性并将其绑定到当 VM 完成从模型层加载数据时您将从 ViewModel 公开的 IsLoaded 属性。当 DeferredContentProvider 中的 IsLoaded 属性发生变化时，您将调用 LoadContent。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T16:44:07.840

当我在没有调试的情况下进行发布构建并运行应用程序时，我已经看到问题消失了，或者至少变得不那么明显了。

否则我会显示一个带有进度条的加载屏幕，并在应用程序启动之前预加载图像。

# ios - iOS 5.1 中的 CGGraphics 图像上下文动画旋转

> ID：11486625
> 
> 赞同：0
> 
> 时间：2012-07-14T19:11:17.543
> 
> 标签：ios, image, animation, rotation

我正在 iOS 中创建一个旋钮按钮。图形设计师给了我 png 图层，所以我使用图像上下文来允许图层的混合。

在旋转时，只有一些图层被旋转。我的目标是为这些旋转设置动画。

目前，我正在使用

```
- (BOOL)beginTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event
- (BOOL)continueTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event
- (BOOL)endTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event 
```

在这些方法中，我计算图像所需的旋转并绘制它。

这工作正常。我遇到的障碍是

```
- (BOOL)endTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event 
```

我想做一个“捕捉”动画。我怎样才能做到这一点？由于混合，我不确定在这种情况下如何使用仿射变换。以下方法是我构建图像的方式：

```
- (UIImage *)knobImageWithRadians:(float)radians
{
UIImage *i05 = [UIImage imageNamed:@"05 - Metal Over Empty Space - ROTATE ME.png"];
UIImage *i04 = [UIImage imageNamed:@"04 - Inner Knob.png"];
UIImage *i03 = [UIImage imageNamed:@"03 - Over Knob Metal - (OVERLAY BLEND)  - ROTATE ME.png"];
UIImage *i02 = [UIImage imageNamed:@"02 - Numbers and Dashes - ROTATE ME.png"];
UIImage *i01 = [UIImage imageNamed:@"01 - Reflective Overlay - (COLOR DODGE BLEND).png"];

CGSize size = i11.size;     

UIGraphicsBeginImageContext(size);
CGContextRef bitmap = UIGraphicsGetCurrentContext();
CGContextTranslateCTM(bitmap, size.width/2, size.height/2);

[i04 drawInRect:CGRectMake(-i04.size.width/2, -i04.size.height/2, i04.size.width, i04.size.height) blendMode:kCGBlendModeNormal alpha:1.0];

CGContextRotateCTM(bitmap, radians);
[i03 drawInRect:CGRectMake(-i03.size.width/2, -i03.size.height/2, i03.size.width, i03.size.height) blendMode:kCGBlendModeOverlay alpha:1.0];

[i02 drawInRect:CGRectMake(-i02.size.width/2, -i02.size.height/2, i02.size.width, i02.size.height) blendMode:kCGBlendModeNormal alpha:1.0];
CGContextRotateCTM(bitmap, -radians);

[i01 drawInRect:CGRectMake(-i01.size.width/2, -i01.size.height/2, i01.size.width, i01.size.height) blendMode:kCGBlendModeColorDodge alpha:1.0];

UIImage* blendedImage = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();

return blendedImage;
} 
```

更新：

现在，我只是让它直接拍摄，没有任何动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T20:37:28.007

您必须通过定期以新角度重绘图像来自己制作动画。或者提出仅使用源而不是合成的视觉效果，这样您就可以将每个图像放在单独的图层中。

# javascript - jQuery触发点击与点击（）？

> ID：11486630
> 
> 赞同：7
> 
> 时间：2012-07-14T19:11:57.640
> 
> 标签：javascript, jquery, jquery-events

我有这个简单的代码： **[这里](http://jsbin.com/ajepiv/edit#source)**

```
$(".btn").on('click',function () {

  $(".a").trigger('click');
});

$(".btn2").on('click',function () {

  $(".a")[0].click();
}); 
```

我正在尝试模拟按下 Anchor。

但是当我使用 jQuery 时`trigger`，它不起作用（为什么？）

当我使用`"jsobj".click()`func 时，它确实有效。

阅读 jQuery 文档后，我看不出有任何不应该这样做的理由。

帮助 ？

PS：我正在使用Chrome。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T19:56:09.713

实际上`$(".a").trigger('click');`触发了点击事件，但这并不意味着它会点击链接，而是如果你已经有一个事件处理程序，它会执行事件处理程序，即

```
$(".btn, .btn2").on('click',function () {
    $($(".a")[0]).trigger('click'); // first element
});

$(".a").on('click', function (e){
    alert(e.target);
});​ 
```

给定的示例将触发 的 click 事件，`a`并将执行已经为该事件注册的处理程序（匿名函数），使用

```
$(".a").on('click', function (e){...}); 
```

[**演示。**](http://jsfiddle.net/heera/Lrw9A/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:14:36.503

因为`$(".a")[0]`返回原始 JavaScript 节点，您不能为此使用 jQuery 对象方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-14T19:24:01.333

这是因为 JQuery`.trigger()`并没有真正触发原生事件。例如在你的脚本中试试这个：

```
$(".btn").on('click',function () {

  $(".a").trigger('click');
});
$(".a").click(function(){alert('triggered!')}); 
```

当您使用 JQuery 创建服装处理程序时，将使用该`.trigger()`方法触发事件。

**更新：**这很有趣，似乎只发生在`<a>`标签和`href`. [看一下这个](http://jsbin.com/ejoduw/edit)

# javascript - 从 SQL API 迁移到 Fusion Tables v1

> ID：11486633
> 
> 赞同：0
> 
> 时间：2012-07-14T19:12:19.510
> 
> 标签：javascript, jquery, oauth-2.0, google-fusion-tables

在 SQL API 被弃用后搜索解决方案从 SQL API 迁移 `https://www.google.com/fusiontables/api/query?sql=`到`https://www.googleapis.com/fusiontables/v1/query?sql=`喜欢[这里](https://developers.google.com/fusiontables/docs/v1/migration_guide)

我有：

```
var URLHead = 'https://www.google.com/fusiontables/api/query?sql='
var URLTable = encodeURI('SELECT id,COUNT() FROM TABLE_ID')
var URLTail = '&access_token='+ TOKEN +'&jsonCallback=?'
var queryURL = URLHead + URLTable + URLTail
var jqxhr = $.get(queryURL, myFT.TABLE, "jsonp")

this.myFT.TABLE = function (DATA) {
  var counter = parseInt(DATA.table.rows[0].toString().substr(1))
  alert(counter )
} 
```

我需要：

```
var URLHead = 'https://www.googleapis.com/fusiontables/v1/query?sql='
var URLTable = encodeURI('SELECT id,COUNT() FROM TABLE_ID')
var URLTail = '&access_token='+ TOKEN +'&jsonCallback=?'
var queryURL = URLHead + URLTable + URLTail
var jqxhr = $.get(queryURL, myFT.TABLE, "jsonp")

this.myFT.TABLE = function (DATA) {
  var counter = parseInt(DATA.table.rows[0].toString().substr(1))
  alert(counter )
} 
```

`SQL API`对我来说，从迁移到迁移似乎并不容易`/fusiontables/v1/`。

**编辑：** 1.尝试更改`jsonCallback`为`callback`- 没有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:48:58.810

**最后！**通过替换 jQuery 示例找到了纯粹而简单的解决方案。使用[google-api-javascript-client](http://code.google.com/p/google-api-javascript-client/wiki/GettingStarted)
不要忘记添加到 head 标签中
`<script src="https://apis.google.com/js/client.js?onload=load"></script>`

```
myTable1 = new FT('table1_id')
myTable1.run('SELECT * FROM ', myTable1, ' ORDER BY id ASC ')

function FT(table_id)
{
  this.counter = 0
  this.table = table_id
  //
  gapi.client.setApiKey('Api_Key')
  //
  this.run = function (q, cls, order)
  {
    gapi.client.load('fusiontables', 'v1', function(){
      var request = gapi.client.fusiontables.query.sqlGet({'sql': q + cls.table + order});
      request.execute(function(DATA){cls.exec(DATA)});
    });
  }
  //
  this.exec = function (DATA)
  { 
    alert(DATA.result.rows.length)
  }
} 
```

**编辑：**

或者就像在上面的第一个示例中一样将其更改
`var URLTable = encodeURI('SELECT id,COUNT() FROM TABLE_ID')`
为此
`var URLTable = encodeURI('SELECT COUNT() FROM TABLE_ID')`

# parent - 在 C# 中从 MDI Parent 调用 MDI Child 的方法

> ID：11486635
> 
> 赞同：1
> 
> 时间：2012-07-14T19:12:44.757
> 
> 标签：parent, mdi

我有两种形式。一个是 MDI 父级，另一个是 MDI 子级。单击父级上的按钮时，将打开子级的表单。我写了一个代码来防止表单重复。这些方法如下；

```
public Form IsFormAlreadyOpen(Type FormType)
    {
        foreach (Form OpenForm in Application.OpenForms)
        {
            if (OpenForm.GetType() == FormType)
                return OpenForm;
        }
        return null;
    }

public static Form1 f1;
public void open_Form1()
    {
        Form UForm = null;
        UForm = IsFormAlreadyOpen(typeof(Form1));

        if (UForm == null)
        {
            UForm = new Form1();
            UForm.MdiParent = this;
            UForm.Show();
        }
    } 
```

这段代码在 MDI 父窗体中可用。然后他们单击按钮，调用方法“open_Form1（）”并打开子表单。

但问题是如何访问以子表单编写的公共方法？在子表单上我有这个代码。

```
 public void somefunction()
    {
        /*code*/
    } 
```

我如何从 MDI 父级调用此方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:17:42.780

一旦获得对子表单的引用，您需要将其转换为适当的类型，然后调用该方法。例如：

```
class MyChildForm : Form {}

Form childForm = GetAChildFormInstance();
MyChildForm castForm = (MyChildForm)childForm;
castForm.MyMemberMethod(); 
```

作为旁注，您似乎没有命名约定。在 .NET 中，所有公共成员（属性、字段和成员）都应该是 PascalCased。Locals（方法变量和参数）应该是camelCase，私有字段可以是_underscorePrefixed。.NET 中的单词之间不应使用下划线。

# php - 是否使用 htmlentitiesdecode 渲染/解析 HTML？

> ID：11486638
> 
> 赞同：0
> 
> 时间：2012-07-14T19:13:04.663
> 
> 标签：php, html-entities

我有一个允许管理员发布 HTML 的论坛。这是一个自定义论坛，因此我们正在努力确保普通用户仍然可以发布 HTML 标记但不能呈现。

如果我将帖子存储为 htmlentities，然后显示带有 html_entity_decode 的帖子，它会使得他们在帖子中输入的任何 html 呈现并影响页面，还是会显示实际的标记，例如

```
<html>
<head> 
```

ETC..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:15:28.857

就个人而言，我存储原始帖子，然后`str_replace("<","&lt;",$post)`在显示之前应用。一个简单`if`的语句检查是否是我发布的，如果是，它会跳过转义，因此我可以发布 HTML，但其他用户不能。

更重要的是，存储原始帖子允许用户准确地编辑他们输入的方式。

# algorithm - 多变环境的寻路算法

> ID：11486639
> 
> 赞同：2
> 
> 时间：2012-07-14T19:13:08.923
> 
> 标签：algorithm, path-finding, a-star

我无法调整 A* 算法来处理不断变化的环境。举个最简单的例子，考虑这张类似流氓的地图：

```
######
#!   #
###  #
#S   #
##+###
##F###
###### 
```

目标是从`S`到`F`，但为了做到这一点，玩家必须踏上`!`去打开门。我遇到的问题是，在 A* 中，一旦访问了一个网格点，它就会“关闭”并且无法重新输入。如何修改算法来解决这个难题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:24:11.793

您可以运行 A* 两次：

1.  首先找到`!`门像墙的开关（ ）的最短路径
2.  然后找到从开关到门的最短路径，那里的门是空白瓷砖。

最短路径将是这两条路径的组合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:41:17.683

在您的问题中，在 A* 中，当您访问一个点（x，y 线）时，您不会再次访问同一点，这是不正确的。

原因是在您的问题中，状态是网格中的位置，并且每个门的状态（打开或关闭）。所以一开始，在你的例子中，初始状态是 (3,1,{false})。（false 表示门已关闭）。

当你到达'！位置，新状态将是 (1,1,{true}) 所以现在当你到达门口时，你将通过门。

# iphone - 分配给'UILabel *__weak'到'NSString *__strong'的不兼容指针类型？

> ID：11486641
> 
> 赞同：2
> 
> 时间：2012-07-14T19:13:19.283
> 
> 标签：iphone, objective-c, ios, xcode, string

我一直在这里使用objective-c做一件事，但我是这门语言的初学者，这就是我所做的：

有一个名为“firstviewclass”的类，它在我的第一个视图的控制中，在这个视图中有一个用户输入数字的文本字段。文本字段位于名为“setNumber”的 firstviewclass.h 中。还有另一个名为“secondviewclass”的类控制第二个视图，在这个视图中有一个标签位于 secondviewclass.h 中，我希望这个标签接收用户在文本字段中输入的值第一个视图。我的代码：

第一视图类.h：

```
#import <UIKit/UIKit.h>

@interface firstviewclass : UIViewController

@property (strong, nonatomic) IBOutlet UITextField *setNumber;

- (IBAction)gotonextview:(id)sender;

 @end 
```

secondviewclass.h：

```
#import <UIKit/UIKit.h>
#import "firstviewclass.h"

@interface secondviewclass : UIViewController

@property (weak, nonatomic) IBOutlet UILabel *labelthatrecivesthetextfieldvalue;

@end 
```

secondviewclass.m:

```
#import "secondviewclass.h"
#import "firstviewclass.h"

@implementation secondviewclass
@synthesize labelthatrecivesthetextfieldvalue;

-(void)viewDidLoad{
    [super viewDidLoad];

    firstviewclass *object = [[firstviewclass alloc] init];

    NSString *string = [[NSString alloc] initWithFormat:@"%i", [object.setNumber.text intValue]];

    labelthatrecivesthetextfieldvalue = string; //here is where that error appears "incompatible pointer types assigning to 'UILabel *__weak' to 'NSString *__strong'"

}

@end 
```

我已经更改了您告诉我要更改的内容，但是当我在模拟器上对其进行测试时，我在文本字段中输入的任何数字都会在标签中显示为 0 ...我真的不知道该怎么做！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-14T19:22:42.560

它应该是：

```
labelthatrecivesthetextfieldvalue.text = string; 
```

* * *

**引擎盖下：**

在您的 xib 实例化 an`UILabel`并使用`IBOutlet`关键字获取它的引用之后，您然后尝试使用`UILabel`指针指向为 a 分配和实例化的内存中的空间`NSString`，这就是您遇到此问题的原因。您可能还确实收到了有关您尝试执行的任务的警告：

```
labelthatrecivesthetextfieldvalue = string; 
```

您应该始终尝试修复警告。

**你想要什么：**

您只是希望`UILabel`显示`NSString`您刚刚创建的内容，为此您应该使用`UILabel's`text 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:18:46.237

您收到该错误是因为您将标签指向字符串。它们属于不同的类别，因此这是不允许的。您真正的意思是您希望标签上的文本采用字符串的值。所以需要设置标签的文本字段：

```
labelthatrecivesthetextfieldvalue.text = string; 
```

对于我之前的错误答案，我深表歉意。

顺便说一句，您还应该考虑使用 camelCase 命名变量。这是objective-c的约定。即`labelThatRecievesTheTextFieldValue`改为调用它。这不会影响您的代码工作的能力，只是约定。

# maple - Maple 中的符号限制与假设

> ID：11486647
> 
> 赞同：0
> 
> 时间：2012-07-14T19:14:33.147
> 
> 标签：maple, mathematical-expressions

在这里我找不到限制

极限(U0*(r^(n+1)-1)/(-1+r), n = 无穷大)

在枫树条件下 |r| < 1 这显然是 -U0/(-1+r)。

我如何告诉 Maple abs(r) <1 以便它自动计算限制。

PS 我试过 >assume(r <1); 另外（r> -1）；但没有用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T19:58:00.930

使用 Maple 15.01 (2011) 或 Maple 16.01 (2012) 我得到，

```
limit(U0*(r^(n+1)-1)/(-1+r), n = infinity) assuming abs(r)<1;

                            U0  
                        - ------
                          -1 + r 
```

我没有看到 Maple 14.01 (2010) 的相同行为。

# python - 接收重复参数的 Python 任务线程

> ID：11486651
> 
> 赞同：2
> 
> 时间：2012-07-14T19:14:47.660
> 
> 标签：python, multithreading

我正在编写一个多线程 Python 程序，其中我正在启动工作线程来处理输入数据列表。然后他们处理的数据需要网络操作，这有效地使他们受 I/O 限制（所以 GIL 对我来说不是问题）。

我遇到了一个问题，多个工作线程显然接收到相同的输入，但我不知道为什么。据我所知，我没有在线程之间共享任何线程不安全的数据。

我已经创建了我正在尝试做的最小化版本。该程序在不执行任何 I/O 或任何操作的情况下显示问题：

```
#!/usr/bin/env python

import threading
import logging
import time

logging.basicConfig(level=logging.DEBUG,
                    format="%(threadName)-10s %(levelname)-7s %(message)s")

sema = threading.Semaphore(10)

# keep track of already-visited data in worker threads
seen = []
seenlock = threading.Lock()

def see(num):
    try:
        logging.info("see: look at %d", num)

        with seenlock:
            if num in seen:
                # this should be unreachable if each thread processes a unique number
                logging.error("see: already saw %d", num)
            else:
                seen.append(num)

        time.sleep(0.3)

    finally:
        sema.release()

def main():
    # start at 1, so that the input number matches the log's "Thread-#"
    for i in xrange(1, 100):
        sema.acquire() # prevent more than 10 simultaneous threads
        logging.info("process %d", i)
        threading.Thread(target=lambda: see(i)).start()

if __name__ == '__main__': main() 
```

还有一些输出：

```
MainThread INFO    process 1
MainThread INFO    process 2
Thread-1   INFO    see: look at 2
Thread-2   INFO    see: look at 2
MainThread INFO    process 3
Thread-2   ERROR   see: already saw 2
MainThread INFO    process 4
Thread-3   INFO    see: look at 4
Thread-4   INFO    see: look at 4
MainThread INFO    process 5
Thread-4   ERROR   see: already saw 4
Thread-5   INFO    see: look at 5
MainThread INFO    process 6
Thread-6   INFO    see: look at 6
MainThread INFO    process 7
Thread-7   INFO    see: look at 7
MainThread INFO    process 8
Thread-8   INFO    see: look at 8
MainThread INFO    process 9
MainThread INFO    process 10 
```

我觉得我正在做的唯一可能奇怪的事情是在一个线程上获得一个信号量许可，而不是在它被释放的地方，但是信号量应该是线程安全的，并且不关心谁获得和释放许可，只要有每个相同的数量。

确认时间：

*   Python 2.7.3（Windows；从 python.org 构建）
*   Python 2.6.7（Windows；cygwin dist）
*   Python 2.6.6 (Linux; Debian dist)

我在做什么来使我的线程共享数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:36:45.167

这与线程无关。它与闭包的行为有关。

```
>>> funcs = []
>>> for x in range(10):
...     def foo():
...         return x
...     funcs.append(foo)
... 
>>> [f() for f in funcs]
[9, 9, 9, 9, 9, 9, 9, 9, 9, 9] 
```

当您定义一个函数并引用封闭范围内的变量时，该变量的值*始终*是封闭范围内该变量*在函数调用时的值*。由于这些函数都是在`for`循环结束后调用的，因此`x == 9`对于所有 10 次调用。

解决此问题的一种简单方法是使用默认值。简而言之，改变这个：

```
 threading.Thread(target=lambda: see(i)).start() 
```

对此：

```
 threading.Thread(target=lambda x=i: see(x)).start() 
```

或者，更好的是，使用`Thread`构造函数的全部功能（感谢 Joel Cornett 提醒我）：

```
 threading.Thread(target=see, args=(i,)).start() 
```

# php - 将XML文档保存到磁盘如何处理sitemap.xml中的&？

> ID：11486654
> 
> 赞同：0
> 
> 时间：2012-07-14T19:15:10.513
> 
> 标签：php, xml, sitemap

我有一个创建 XML 的 php 代码，它工作正常，但它搞砸了`&`并将其转换为`&amp;`

我使用此代码将我的 url 放入 xml：

> htmlentities($final_url);

当打开xml文件时，它显示

`index.php?route=product/product&amp;path=37&amp;product_id=1101515800&amp;pdescription`

如何正确格式化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T23:14:12.563

代码工作正常。XML 中的 & 符号必须始终编码为`&amp;`. 您无需担心，因为任何使用 XML 解析器读取文件的人都会将其自动解码为`&`. 您唯一需要担心的是，如果有人在不使用真正的解析器（例如使用正则表达式）的情况下读取文件，并且该论坛的普通追随者会知道这是一件非常危险的事情。

# asp.net-mvc-4 - 我可以使用条件语句将用户重定向到 MVC4 中的某个视图吗？

> ID：11486657
> 
> 赞同：0
> 
> 时间：2012-07-14T19:15:32.943
> 
> 标签：asp.net-mvc-4

我想知道是否可以使用 if 条件将用户重定向到 MVC4 C# 中的某个视图？

例如

```
 public ActionResult MyController()
    {
        if(this) {
            return View1();
        }
        else {
            return View2();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:17:34.847

您可以返回 a[`RedirectResult`](http://msdn.microsoft.com/en-us/library/system.web.mvc.redirectresult.aspx)以重定向到特定的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:21:58.497

您可以像这样调用命名视图：

```
public ActionResult MyController()
{
    if(true) 
    {
        return View("SomeViewA");
    }
    else {
        return View("SomeViewB");
    }

} 
```

# jquery - jquery UI datepicker不适用于动态插入的输入

> ID：11486660
> 
> 赞同：0
> 
> 时间：2012-07-14T19:15:52.393
> 
> 标签：jquery, jquery-ui, datepicker, dynamically-generated

我正在将输入字段动态添加到`td`元素

```
$('.edit_text').live('click',function(){
    $(this).html('<input type="text" value="'+$(this).text()+'" style="background:url(text_bx.gif) no-repeat bottom;display:inline;padding: 0; margin: 0;" class="editing" >');
    $(this).children('input').focus();
    if ($(this).attr('id')=='date'){
        $(this).children('input').datepicker( "refresh");//"option", "dateFormat","yy-mm-dd");
    }
}); 
```

但如果 td 有 id 日期，则 datepicker 不会出现。我在插入的输入字段上也有模糊功能，有问题吗？

```
$('.editing').live('blur',function(){
//did something
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-05T19:43:28.123

好吧，下面是`jquery date picker`带有可编辑文本框的动态，您可以相应地更新代码。

```
$(function(){

    $('#thedate').datepicker({
        dateFormat: 'dd-mm-yy',
         onSelect: function(dateText) {
   		$('#dateContainer').text(dateText);
        console.log(dateText);
        }

    });

});
```

```
<link href="http://code.jquery.com/ui/1.8.21/themes/base/jquery-ui.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script>
Shown Date : <div id="dateContainer" type="button" > currentData </div>
<input id="thedate" type="text" /><br />
<input id="thesubmit" type="button" value="Submit" />
```

***带有日期选择器的 JS Fiddle：-*** [http://jsfiddle.net/vikash2402/8w8v9/1989/](http://jsfiddle.net/vikash2402/8w8v9/1989/)

***带有日期选择器和 div 的 JS Fiddle：-*** [http://jsfiddle.net/vikash2402/8w8v9/1990/](http://jsfiddle.net/vikash2402/8w8v9/1990/)

***希望这会帮助你:)***

# php - Doctrine 实体删除 vs 删除查询，性能比较

> ID：11486662
> 
> 赞同：21
> 
> 时间：2012-07-14T19:15:55.440
> 
> 标签：php, performance, doctrine

在使用原则时，我注意到，要删除一个实体，我需要通过给定的参数（名称、id 等）检索该实体，然后调用 remove 方法。另一方面，在查询中，我可以只执行删除查询。

所以，看起来，使用 ORM 风格需要两次操作，而一般的 sql 操作需要一次操作。这就是为什么，我有点困惑，我们是否应该在 ORM 中使用删除（或更新）操作？性能不是更差吗？或者还有什么我想念的吗？可以以 ORM 风格以任何其他方式完成吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-07-14T20:45:13.083

在 Doctrine2 中，您可以对未从数据库加载的代理对象调用删除。只需创建一个“虚拟”对象，例如：

```
$user = $em->getPartialReference('model\User', array('id' => $id));
$em->remove($user); 
```

它不需要初始查询，但我不太确定 Doctrine 是否仍然在内部执行它*flush*。我在 SqlLog 中没有看到它。

补充一点，我认为这是任何体面的 ORM 的预期行为。它处理对象和关系。它必须在删除之前知道某些东西的存在。ORM 不仅仅是一个*查询生成器*。通常，原生查询在任何 ORM 中总是更快。任何 ORM 都会增加一个抽象层，执行它需要一些时间。这是一个典型的权衡，你得到一些花哨的特性和干净的代码，但在性能上有所松懈。

**编辑：**

我很高兴它对你有用。实际上我偶然发现了另一个问题，这让我意识到代理和部分对象实际上并不是一回事。部分对象实例化真实的模型类，并用您想要的值填充它。初始化部分对象后，延迟加载不再适用。因此，例如，如果您创建一个仅具有 id 的部分对象，并且仅在另一个对象字段满足某些条件时才想删除，则它将不起作用，因为该其他字段将始终为空。

另一方面，代理确实可以使用延迟加载，并且不会共享部分对象所具有的问题。所以我强烈建议不要使用`getPartialReference`方法，而是你可以这样做：

```
$user = $em->getReference('model\User', $id);
$em->remove($user); 
```

如果对象已经加载，则该`getReference`方法返回对象，否则返回代理。如果/当您需要它们时，代理可以延迟加载所有其他值。至于您的示例，它们的行为将完全相同，但代理肯定是更好的选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-02T18:23:25.757

完毕！对我来说，它像这样添加第 3 行：

```
$user = $em->getReference('model\User', $id);
$em->remove($user);
$em->flush(); 
```

# iphone - 无法在我的 ipod touch 上运行我的 iOS 应用程序

> ID：11486664
> 
> 赞同：0
> 
> 时间：2012-07-14T19:15:58.897
> 
> 标签：iphone, ios5, jailbreak, ipod-touch, ios5.1

我有一个使用 iOS 5.1 兼容性构​​建的应用程序。

我无法遵循像使用归档来构建它的路径 - 我一直在使用远程 Mac，并且一些问题一直限制我这样做。

所以我通过这样做准备了一个 .ipa 文件： - 有效负载文件夹 - 将 myapp.app 包复制到有效负载 - 压缩有效负载

现在我在另一台电脑上把这个 Payload 放到了我的 iTunes 上（因为 Mac 是远程的，所以无法从那里进入 ipod touch）

我的 ipod touch 显示的是最新的 iOS 版本 4.2.1。没有进一步的升级可用。型号为mb528zp。ipod 上的可用空间为 700 MB，超过了所需空间。

我可以在 iTunes 库应用程序部分下看到 myapp。

当我尝试从设备->应用程序下同步 myapp 时，它似乎确实同步了 - 但最后它没有同步。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T23:30:40.563

听起来您的部署目标设置为错误的 iOS 版本。尝试将您的项目 iOS 部署目标设置为 4.2 或更低版本，它应该可以工作（单击项目导航器中的项目，然后单击项目的名称，而不是目标，您应该会看到信息选项卡选择了那里的选项）

# c# - 使用 NAudio 播放（无效的）音频流

> ID：11486670
> 
> 赞同：0
> 
> 时间：2012-07-14T19:16:35.963
> 
> 标签：c#, streaming, naudio

我有一个通过 http 传输视频和音频的 DLink 网络摄像头 (DCS-932L)。

视频是 mjpeg（运动 jpeg），而音频是单声道的 16 位 PCM wav 音频。

我可以很好地阅读视频流，但我遇到了音频问题。根据接收到的标题，音频文件只有 30 秒长，但这是错误的，因为相机会永远发送数据（使用 wget 检查）。

NAudio、VLC、Windows 媒体播放器等都在 30 秒后停止，因为 wav 标头说它们应该。任何人都知道让 NAudio 丢弃流标头的长度属性的方法吗？或者我可以使用的任何其他库来处理这个问题？

我今天使用的播放 30 秒的代码是：

```
public void PlayWaveFromUrl(string url)
    {
        new Thread(delegate(object o)
        {
            var req = WebRequest.Create(url);
            req.Credentials = GetCredential(url);
            req.PreAuthenticate = true;

            var response = req.GetResponse();

            using (var stream = response.GetResponseStream())
            {
                byte[] buffer = new byte[65536]; // 64KB chunks
                int read;
                while ((read = stream.Read(buffer, 0, buffer.Length)) > 0)
                {
                    var pos = ms.Position;
                    ms.Position = ms.Length;
                    ms.Write(buffer, 0, read);
                    ms.Position = pos;
                }
            }
        }).Start();

        // Pre-buffering some data to allow NAudio to start playing
        while (ms.Length < 65536 * 10)
            Thread.Sleep(1000);

        ms.Position = 0;
        using (WaveStream blockAlignedStream = new BlockAlignReductionStream(WaveFormatConversionStream.CreatePcmStream(new WaveFileReader(ms))))
        {
            using (WaveOut waveOut = new WaveOut(WaveCallbackInfo.FunctionCallback()))
            {
                waveOut.Init(blockAlignedStream);
                waveOut.Play();
                while (waveOut.PlaybackState == PlaybackState.Playing)
                {
                    System.Threading.Thread.Sleep(100);
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T09:53:01.780

最简单的方法是使用 RawSourceWaveStream，然后传入一个已经跳过 WAV 标头的流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:49:02.847

有些人通过简单地每 30 秒启动一个新请求就取得了成功。

见： http://forums.ispyconnect.com/forum.aspx?g=posts& [m=2717#post2717](http://forums.ispyconnect.com/forum.aspx?g=posts&m=2717#post2717)

但是，如果您想自己破解它，您可以就地编辑 WAV 标头并设置初始 8 字节标头之后的所有数据的长度。初始标头中的第二组 4 个字节基本上是（总文件长度 - 8 个字节），并以小端字节顺序存储为 32 位无符号整数。

因此，在接收到前 8 个字节后，您可以尝试将 WAV 文件大小设置为更大的值，例如`UInt32.MaxValue - 8`. 但这在大约 4GB 之后仍然有限制，您最终将不得不重新启动您的请求。

您还需要围绕读取和写入添加一些锁定`ms`，我认为这是一个`MemoryStream`？`ms.Position = 0`我没有显示任何锁定，但我认为您在创建之前设置时会遇到问题，`blockAlignedStream`并且当 nAudio 类开始从流中读取时再次遇到问题，因为您还将同时写入请求线程中的流。这将表现为带有大量爆裂声的非常失真的声音。

如果不自行管理锁定，MemoryStream 对于多线程使用是不安全的，并且由于您无法在 NAudio 代码中控制流的锁定，因此您必须创建自己的流来分别管理读取和写入位置，并且处理内部锁定。

**请参阅[http://www.codeproject.com/Articles/16011/PipeStream-a-Memory-Efficient-and-Thread-Safe-Stre](http://www.codeproject.com/Articles/16011/PipeStream-a-Memory-Efficient-and-Thread-Safe-Stre)`PipeStream`上的课程。**

```
 ...
            byte[] buffer = new byte[65536]; // 64KB chunks 
            int read; 
            long totalRead; 
            int bufferPosition = 0;
            bool changedLength = false;

            while ((read = stream.Read(buffer, bufferPosition, buffer.Length)) > 0) 
            { 
                totalRead += read;
                if (!changedLength)
                {
                   if (totalRead < 8) 
                   {
                       // need more bytes
                       bufferPosition += read;
                       continue;
                   } 
                   else
                   {
                       const uint fileLength = uint.MaxValue - 8;

                       buffer[4] = (byte)(fileLength         && 0xFF);
                       buffer[5] = (byte)((fileLength >>  8) && 0xFF);
                       buffer[6] = (byte)((fileLength >> 16) && 0xFF);
                       buffer[7] = (byte)((fileLength >> 24) && 0xFF);

                       changedLength = true;
                       bufferPosition = 0;

                       var pos = ms.Position; 
                       ms.Position = ms.Length; 
                       ms.Write(buffer, 0, (int)totalRead); 
                       ms.Position = pos; 
                   }
                }                    
                else
                {
                    var pos = ms.Position; 
                    ms.Position = ms.Length; 
                    ms.Write(buffer, 0, read); 
                    ms.Position = pos; 
                }
            } 

    ... 
```

最终，如果您想无限制地永久阅读，您将不得不解释流的 RIFF 结构，提取样本数据，并使用原始样本而不是`WaveFormatConversionStream`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T20:04:54.293

围绕您从网络摄像头获得的另一个（子类）编写另一个`Stream`（子类），并就地更改 WAV 标头。它可能会起作用！

# c# - WebClient 和请求标头

> ID：11486671
> 
> 赞同：0
> 
> 时间：2012-07-14T19:16:37.637
> 
> 标签：c#, .net, http, httpwebrequest, webclient

考虑以下函数：

```
 public string Get(string url, string parameters = "", bool xml = false)
    {
        try
        {
            if(xml) { client.Headers["X-Requested-With"] = "XMLHttpRequest";
            return client.DownloadString(url + "?" + parameters);
        }
        catch (WebException ex)
        {
            System.Console.WriteLine(ex.Message);
            throw;
        }
    } 
```

和两个调用它：

```
Get("http://www.host.com", "", true);
Get("http://www.host.com", "", false); 
```

第二个 Get() 调用是否设置了 X-Requested-With 标头？每次调用 WebClient.DownloadString 函数后，这些标头是否会“重置”，或者我必须手动将它们恢复为默认值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:38:22.567

调试代码后，我得出结论，设置的标头仍然存在，并且在这种情况下需要手动将它们恢复为默认值。

# asp.net - 'Sys' 未定义 - 呈现的标记缺少对 ScriptResource.axd 的引用

> ID：11486673
> 
> 赞同：2
> 
> 时间：2012-07-14T19:16:50.057
> 
> 标签：asp.net, vb.net, iis, asp.net-ajax, scriptmanager

是的，著名的“'Sys' 未定义”Microsoft JS 问题。

我已经进行了大约 4 个小时的挖掘并尝试了我能找到的每一个建议，所以在你立即称它为重复之前，请先告诉我。

最终，这个问题*与*[这个](https://stackoverflow.com/questions/75322/sys-is-undefined)问题完全相同，但接受的答案与我的情况无关，并且 OP 不再是活跃成员。

* * *

### 背景

这个应用程序大约有一百页。它们中的每一个最终都继承自同一个基类。这个基类覆盖了该`Init`方法并动态地添加一个`ScriptManager`作为第一个`Form`控件。

在其中的一个页面上，我遇到了我链接的帖子中描述的问题。我提到接受的答案是相关的。原因如下：

1.  我不`Sys.`打电话
2.  我的页面上没有任何启用 AJAX 的控件
3.  我的页面上没有任何 JavaScript
4.  我的 web.config 是准确的，它包含正确的处理程序条目
5.  该问题在 IIS 6.0 和 IIS 7+ 上都可以重现
6.  如果我通过显式将 ScriptManager 添加到页面`<asp:ScriptManager />`，则 ScriptResource.axd 包含仍然不会呈现到输出页面
7.  我尝试清除浏览器历史记录、临时 ASP.NET 文件、重新启动等，但行为没有改变
8.  我们 UAT 环境中的旧版本应用程序可以正常运行；从那时起，基本页面代码和 web.config 文件都发生了变化

我完全被难住了。这是一个 ASP.NET 3.5*网站*项目，在带有 IIS 6.0（Prod 和 UAT）的 Win Server 2003 上运行。我的开发环境是带有 IIS 7.5 的 Win7。两种环境中的行为相同。

### 问题

有人有什么想法吗？我开始认为这是 ASP.NET 3.5.1 框架中的错误...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T04:18:44.503

我刚刚遇到了一个类似的问题，我似乎刚刚解决了。

**如果**您要覆盖页面上除 PageLoad 之外的任何其他页面生命周期事件，请确保触发事件的基本版本。例如我正在使用`OnPreRenderComplete`

```
protected override void OnPreRenderComplete(EventArgs e)
{
    base.OnPreRenderComplete(e); //ADDING THIS LINE FIXED THE PROBLEM

    //Add THEAD etc to Gridview
    if (gvQueue.Rows.Count > 0)
    {
            gvQueue.HeaderRow.TableSection = TableRowSection.TableHeader;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T22:37:11.480

由于您已经尝试了其他所有方法，并且因为它是可重现的，所以我可以想到 3 个可能的原因，您可以检查：

1) 元素定义不正确。

确保已 `runat="server"`指定 head 元素。我们总是提供一个`id`，虽然我不认为这是严格要求的：

```
<head id="HEAD1" runat="server"> 
```

2) 导致异常的代码在包含 ScriptResource.axd 之前被执行。

为了验证是否是这种情况，我查看了异常发生时页面中加载的内容。如果我没有看到被报告为丢失的资源，我知道我有订购问题。

我已经看到这是由继承树中的两个 Page.Init （或其他方法）挂钩引起的，当这种情况发生时，您无法保证执行顺序。

3) 无效的页面结构。

我见过很多这样的例子，其中一个放错位置、容易被忽略的字符，例如单引号、双引号或 < 会默默地破坏页面或 javascript 结构。

为了验证不是这样，我首先在设计模式（编辑、高级、验证文档）下验证页面并更正任何错误。

如果设计模式下没有错误，我会通过将渲染页面的源代码复制到项目内的空白页面中然后进行验证来验证渲染页面。这个过程在页面结构中发现了不止一个微妙的问题。

4) 如果以上方法都不能解决问题，则可能是框架存在问题。如果有，则可能是由页面中的元素名称或顺序引起的。您可以尝试删除或重新排序页面中的项目，直到问题消失。

希望这可以帮助。

# javascript - BMI计算

> ID：11486675
> 
> 赞同：-1
> 
> 时间：2012-07-14T19:17:04.740
> 
> 标签：javascript

体重指数的计算公式是体重*703/身高²。创建一个包含三个文本框的网页：体重（磅）、身高（英寸）和一个包含 BMI 结果的文本框。使用名为 calcBMI() 的函数创建一个脚本，该函数使用体重和身高文本框中的值执行计算，并分配 BMI 文本框的结果。使用 parseInt() 函数将结果转换为整数。使用每个文本框的文档对象、表单名称以及名称和值属性从函数内引用文本框（不要使用函数参数）。通过从按钮元素中的 onclick 事件调用函数来执行计算。

这是我能想到的：

```
<html><head>
<title>...</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<script type="text/javascript">
/*<CDATA[[*/

function calcBMI(){
var weight, height, total;
document.form.height.value = weight * 703;
document.form.weight.value = (height * height);
var total = weight / height;
document.form.result.value = total;
}
/*]]>*/
</script>
</head>
<body>
<form name="form">
Weight: <input type="text" name="weight" /><br />
Height: <input type="text" name="height" /><br />
Result: <input type="text" name="result" /><br />
<input type="button" value="BMI Result!" onclick="calcBMI()" />
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:21:17.090

您正在引用表单的文档模型来显示答案，而不是读取您需要的值。您也没有像问题要求的那样使用 ParseInt 。输入字段不需要像那样的 onClick，只需要您单击的按钮。

祝作业好运:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T22:06:06.283

通常，您面临的问题是您尝试为文本框分配值，而您应该尝试获取文本框的值。将您的代码更改为：

```
function calcBMI(){
  var weight, height, total;
  weight = document.form.weight.value; //take the value from the text box
  height = document.form.height.value; //take the value from the text box
  total = weight * 703 / height / height; //your formula
  document.form.result.value = parseInt(total); //assign the last text box the result
} 
```

# android - 如何在 30 秒后停止 android 通知铃声？

> ID：11486677
> 
> 赞同：10
> 
> 时间：2012-07-14T19:17:13.973
> 
> 标签：android, android-notifications

我正在编写一个应用程序来通知用户非常时间敏感的信息，我认为他们中的很多人会想要使用电话铃声而不是短的通知声音。我通过在我的PreainencesCreen中设置来启用此功能`android:ringtoneType="all"`，并且它运行效果很好，除非选择了电话铃声，否则它会永远播放，直到用户触摸通知栏...我该如何在30秒钟后将其关闭，不取消通知？

这是我在 C2DM 接收器中使用的代码：

```
NotificationManager nm = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
Notification notif = new Notification(....)
....
String ringtone = PreferenceManager.getDefaultSharedPreferences(context).getString("ringtone", "");
notif.sound = Uri.parse(ringtone);
notif.audioStreamType = AudioManager.STREAM_NOTIFICATION;
nm.notify(1, notif); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-21T17:36:37.987

这应该这样做。

```
....
mediaPlayer.start();
....
final Handler handler = new Handler();
    handler.postDelayed(new Runnable() {
        @Override
        public void run() {
            if (mediaPlayer.isPlaying())
                mediaPlayer.stop();
        }
    }, timeout); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-21T01:44:40.070

Android 不允许您干扰播放声音的通知，但如果您可以完全控制正在播放的铃声，那么您可以在 30 秒后停止它或做任何您想做的事情。

在这里，我假设您正在使用后台服务来执行通知。

作为初步步骤，您应该发出没有声音的通知。只是一个默认的简单任务栏通知。然后，我们将使用我们自己的[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)对象来播放铃声 30 秒。

1) 如果您正在现场执行通知：创建一个 MediaPlayer 对象，在您启动通知后立即开始播放用户选择的铃声。然后使用 Timer 和 TimerTask 计数 30 秒（[请参阅此处](http://enos.itcollege.ee/~jpoial/docs/tutorial/essential/threads/timer.html)有关如何使用它们的示例）或[ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)并调用 MediaPlayer stop() 以在 30 秒后停止铃声。

2) 如果您要在以后安排通知：设置通知后，请立即创建一个[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)并安排它，以便它与您的通知同时触发。您的警报可能会触发您编写的另一个后台服务，在该服务中，您使用 MediaPlayer 对象播放铃声 30 秒，如第 1 部分所述）。

在这两种情况下，通知仍然存在，您播放铃声的方式将完全独立于它。您将完全控制铃声。如果用户直到那个时间还没有检查通知，您甚至可以在某个预定时间后再重播 30 秒（因为您说通知提供了非常时间敏感的信息，否则我不会用铃声播放来打扰用户坚持）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T10:53:39.183

一个简单的解决方法是在 30 秒后取消通知并创建一个新通知。

您甚至可以克隆原始通知并删除新通知的铃声。

# jquery - 显示下一个类元素

> ID：11486678
> 
> 赞同：0
> 
> 时间：2012-07-14T19:17:20.883
> 
> 标签：jquery

我有可重复的元素

```
 <input style="display:inline" class="chkClass" type="checkbox" value="1"/>
     <div class="other">
 //something
     </div>

     <input style="display:inline" class="chkClass" type="checkbox" value="1"/>
     <div class="other">
 //something
     </div>
     .... 
```

随着复选框的更改，我只想显示下一个“其他”类。它不起作用：

```
 $('.other').hide(); //hide all "other" elements

         $('.chkClass').live('change', function(){
            if($(this).is(':checked')){
                $(this).next('.other').show();
        }
       }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:21:45.197

将 nextAll 与查询一起使用

```
$('.chkClass').on('change', function(){
       if($(this).is(':checked')){
          $(this).nextAll('.other:hidden:first').show();
       }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T11:06:34.483

我明白了，但我需要为每个元素设置 ID：

```
 $('.allOther').hide();

    $('.chkClass').on('change', function(){
            if($(this).is(':checked')){
                var array = $(this).attr('id').split('_');
                $('#other'+array[1]).show("slow");

            }
        });

        <input style="display:inline" class="chkClass" id="smthng_<?php echo $counter ?>" type="checkbox" value="1"/>
    <div id ="other<?php echo $counter ?>" class="allOther"> 
```

# javascript - 按 id 更新动态表列，对吗？

> ID：11486680
> 
> 赞同：1
> 
> 时间：2012-07-14T19:17:22.810
> 
> 标签：javascript, jquery, html, ajax, json

我对 Ajax/Json 有点陌生，所以我想知道以下是否至少接近最佳实践。目标是每 x 秒更新一次表的特定列（在本例中为数量和价格）。

我有一个这样定义的 HTML 表：

```
<table id="#edition_table>
    <tbody>
    <tr>
        <td class="name"><a href="?card=12345">Lightning Bolt</a></td>
        [...]
        <td class="qty">2</td>
        <td class="price">$4.99</td>
    <tr>
    <tr>
        <td class="name"><a href="?card=23456">Fireball</a></td>
        [...]
        <td class="qty">0</td>
        <td class="price">$0.07</td>
    <tr>
    [...]
    </tbody>
</table> 
```

和一个这样定义的 JS 函数：

```
function edition_update(edition)
{
    var table_rows = $('#edition_table').find('tbody tr td.name a');

    $.ajax({
    type: 'GET', url: 'ajax_edition_update.php', data: { edition : edition }, dataType: 'json',
    success: function(json_rows)
    {
          var new_qty, new_price;

          table_rows.each(function(index) {
                var td_id = $(this).attr('href').replace('?card=', '');

                for (i in json_rows) {
                    if (json_rows[i].card_id == td_id)
                    {
                        new_qty = json_rows[i].qty;
                        new_price = json_rows[i].low_price;
                        break;
                    }
                }

                var parent_tr = $(this).parent().parent();

                parent_tr.find('td.qty').text(new_qty);
                parent_tr.find('td.price').text(!isNaN(new_price) ? '$' + new_price : new_price);
          });
    }
    });

    setTimeout(edition_update, 30000, edition);
} 
```

PHP 文件返回一个 JSON，包括 card_id、qty 和 low_price。

这确实工作正常。我想我可以在 class=name td 上设置一个`data-id=[card_id]`来摆脱 .replace，但这有点炸毁 html 足迹，因为 id 已经存在。

真正的问题是任何性能改进（尤其是关于两个循环）是否可能或必要？当然，每个表的目标行数约为 500，内容和顺序是完全动态/不可预测的。

# c - 每个 udp 数据包有多个或单个请求？

> ID：11486681
> 
> 赞同：0
> 
> 时间：2012-07-14T19:17:34.123
> 
> 标签：c, database-design, networking, network-programming, memcached

我正在通过 UDP（在 Linux 下）为缓存应用程序（类似于 memcached）开发自己的协议，该应用程序仅对对象执行 INSERT/READ/UPDATE/DELETE 操作，我不确定哪种设计是最好的：

1.  **每个数据包发送一个请求**。（客户端准备好请求并立即发送到服务器）
2.  **每个数据包发送多个请求**。（客户端将请求排入数据包中，当它已满时（接近 MTU 大小）将其发送到服务器）

请求（即记录数据）的大小可以从32字节到1400字节，我不知道平均会是哪个，这完全取决于用户的应用程序。

1.  如果选择每个数据包单个请求，我将不得不管理很多小数据包，并且内核将被中断很多次。这将减慢操作，因为内核在从用户空间切换到系统时必须保存寄存器。数据传输也会有开销，如果用户的应用程序发送很多32字节的请求（udp的数据包开销约为28字节），网络流量会翻倍，对传输速度的影响很大。然而，高网络流量并不一定意味着低性能，因为 NIC 有自己的处理器并且不会使 CPU 停顿。如果出现网络瓶颈，可以安装额外的网卡。使用单个数据包的最大优势是服务器和客户端将非常简单，我将节省指令并提高速度，

2.  如果我对每个数据包使用多个请求，我将拥有更少但更大的数据包，因此可以通过网络传输更多数据。我将减少系统调用的数量，但服务器的复杂性将需要更多的内存和更多的指令来执行，因此我们不知道我们是否可以通过这种方式更快地执行。CPU可能会成为瓶颈，但加CPU或网卡哪个更便宜？

应用程序应该有大量的数据负载，例如在最新的 CPU 上每秒 100,000 个请求。我不知道该怎么做。我正在考虑“每个数据包单个请求”，但在我重写我已经为多个请求处理编写的所有代码之前，我想征求建议。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T09:39:26.830

你更关心什么：**延迟**还是**带宽**？

*   If latency, send the request as soon as possible even if that means a lot of "slack" at the ends of packets and more packets overall.
*   If bandwidth, bundle multiple requests to eliminate the "slack" and send fewer packets overall.

*NOTE: The network, not the CPU, will likely be your major bottleneck in either case, unless you are running over an extremely fast network. And even if you do, the INSERT/READ/UPDATE/DELETE in the database will likely spend more CPU and I/O than the CPU work needed for packets.*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:37:35.760

每个数据包发送多个请求的另一个权衡是

*   一方面，UDP 的不可靠特性可能会导致您一次丢弃多个请求，从而使重新传输的成本更高。
*   另一方面，内核将使用更少的缓冲区来传递数据，从而减少数据丢失的机会

但是，如果不了解部署架构（例如 NIC、交换机和路由器以及其他网络硬件的缓冲区大小），则分析是不完整的。

但建议从一个相对简单的实现开始（每个数据包一个请求），但是以这样的方式编写代码，以便在需要时增加更多复杂性不会太困难。

# c++ - 返回指向函数静态数据的指针是否合适？

> ID：11486687
> 
> 赞同：3
> 
> 时间：2012-07-14T19:17:52.163
> 
> 标签：c++, templates, pointers, c++11

好吧，我需要返回一个指向将在函数内创建的类的实例的指针。这合适吗？

这是示例代码：

```
template <typename T>
ImplicatedMembershipFunction<T>* 
TriangularMF<T>::minImplicate(const T &constantSet) const
{
    static ImplicatedType* resultingSet = new ImplicatedType();
    // do something to generate resultingSet...
    return resultingSet;
} 
```

我想返回指针，因为需要在容器中有基类的子类。在上面的代码`ImplicatedType`中是一个类定义`TriangularMF<T>`并派生自`ImplicatedMembershipFunction<T>`. 会有各种各样的模板类`TriangularMF`，比如有一个从中派生的嵌套类`ImplicatedMembershipFunction<T>`，我需要以同样的方式对待它们。例如，在图书馆之外，我可能想做一些类似的事情：

```
TriangularMF<double> trmf(0,1,2);
TrapesoidalMF<double> trpmf(0,1,3,2); // a class like TriangularMF but
                                      // ImplicatedType is different 
ImplicatedMembershipFunction<double>* itrmf = trmf.implicate(0.6);
ImplicatedMembershipFunction<double>* itrpmf = trpmf.implicate(0.6); // same as above.

// use them in the same way:
vector<ImplicatedMembershipFunction<double>*> vec;
vec.push_back(itrmf); 
vec.push_back(itrpmf); 
```

我不想使用移动语义等 C++11 特性的原因，或者`std::shared_ptr`我不想强迫我的队友在他们的计算机上安装更新版本的 g++。我不能给他们库的编译版本，因为它是大量模板化的。

**编辑** 该库将被线程化。特别是，`TriangularMF<T>::minImplicate`它将同时在多个线程中运行。所以，做`minImplicate`一个相互的任务，对性能没有意义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:40:11.103

这是单身人士常用的成语：

```
class CMyClass {};

CMyClass& MyClass() {
  static CMyClass mclass;
  return mclass;
} 
```

CMyClass 将在第一次 MyClass() 函数调用时构建。

它看起来很像您的代码，除了指针异常，它会导致销毁此类 crated 实例时出现问题。如果你不想在这里使用 shared_ptr，那么考虑编写你自己的 shared_ptr 样模板，那么它应该可以正常工作。

[编辑] 如果这段代码要在多线程环境中使用，那么在这里使用智能指针会很棘手

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:46:22.283

返回指针本身并不是问题，但您必须定义关于 whoi 创建和谁销毁的干净“策略”。

在您的代码中，您定义了一个静态指针，该指针`new`在第一次遇到其（指针）定义时使用对象进行初始化。

指针本身会在`main()`返回后被销毁，但是它指向的对象呢？如果您让其他东西来处理删除，即使对象不再存在，您的函数也会继续返回该指针。如果你让它在那里，它将在程序结束时被杀死（不是“危险”泄漏，因为它只是一个对象，但如果它的析构函数必须采取一些明智的行动呢？）

您最有可能声明的不是静态指针，而是静态 OBJECT，然后返回......它的地址或它的引用。

`main()`以这种方式，对象被授予在程序终止之前存在并在返回后被正确销毁。

```
template <typename T>
ImplicatedMembershipFunction<T>* 
TriangularMF<T>::minImplicate(const T &constantSet) const
{
    static ImplicatedType resultingSet(....);
    return &resultingSet;
} 
```

请注意，我消除了您的“做某事...”，因为它每次都会执行（不仅仅是第一次）要初始化`ImplicatedType`，您最好依赖构造函数。或者，如果您不能一次性构建它，请执行以下操作

```
template <typename T>
ImplicatedMembershipFunction<T>* 
TriangularMF<T>::minImplicate(const T &constantSet) const
{
    static ImplicatedType* resultingSet=0;
    static bool init=true;
    if(init)
    {
        init=false; 
        static ImplicatedType result;
        resultingSet=&result;
        // do something to generate resultingSet...
    }
    return resultingSet;
} 
```

如果您处于多线程情况，您还需要一个静态互斥锁，然后`if(init)`在返回时解锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T19:25:03.267

您可以使用此技术，但返回一个参考。如果调用者需要一个指针来存储，调用者可以获取结果的地址。

```
template <typename T>
ImplicatedMembershipFunction<T> &
TriangularMF<T>::minImplicate(const T &constantSet) const
{
    static ImplicatedType* resultingSet = new ImplicatedType();
    // do something to generate resultingSet...
    return *resultingSet;
} 
```

但是，代码的危险在于它本质上不是 MT 安全的。但是如果你知道里面的代码`minImplicate`是线程安全的，或者你的代码是单线程的，那就没有问题了。

# html - 根据值定位图像的特定部分

> ID：11486692
> 
> 赞同：1
> 
> 时间：2012-07-14T19:19:26.530
> 
> 标签：html, css, png

说我有以下 png

![星图](../Images/0e00941108b28d8fc60ebfec0b5e0775.png)

在我的 HTML 中，来自 Ruby，我得到一个特定的评级值 (0,1,2,3,4,5)。根据该值，我想显示 png 的特定行。

我正在考虑根据值分配一个特定的类，然后定义该类以专注于该 png 图像的特定部分（使用某个位置）。但是，我看不到如何做到这一点，以及这是否是解决此问题的最佳方法。

换句话说，如果我有以下内容：

```
<span id='rating'> 3 </span> 
```

我正在考虑做类似的事情：

```
<span id='rating' class='rating_3'> <img ..></img></span> 
```

其中`rating_3`class 将被定义为仅显示 3 颗星亮的行。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:22:53.753

这种东西是一个 spritesheet，通过指定一个正确大小的元素来实现，表单为`background-image`. 然后，`background-position`用于移动纸张以显示正确的图像。

因此，在您的情况下，您只需将每行的高度乘以评级并将其用作位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T21:08:00.133

我会使用 HTML5`data-*`属性来设置来自 Ruby 的特定评级值，例如（呈现的 html）：

```
<span class='rating' data-rating='3.5'></span> 
```

然后我会使用一些 javascript/jQuery 来动态设置 png sprite 文件的正确图像背景位置（如前所述）。

首先将css属性设置为`.rating`选择器以使用精灵图像。如果你想使用你的精灵中的大星星，你可以将一个分配`ID`给父容器，例如

```
#rateBig .rating  {
 background-image: url('images/rating.png'); 
 background-repeat: no-repeat;
 width: 84px; 
 height: 16px;
 display: block; 
} 
```

注意`width: 84px;`和`height: 16px;`值，它们对应于大星条的大小。

然后假设你有这个 html 来匹配我们的 css

```
<ul id="rateBig">
 <li>This line is rated 3.5 stars<br /><span class='rating' data-rating='3.5'></span></li>
</ul> 
```

的JavaScript：

```
<script>
var dataRating, bkPos;
// function to set the backgroundPosition based on the value of the data-* attribute
// for the BIG stars
function getRateImageBig(dataRating){
 switch(dataRating){
  case 1:   bkPos =  "0 -19px";  return bkPos; break;
  case 1.5: bkPos =  "0 -38px";  return bkPos; break;
  case 2:   bkPos =  "0 -57px";  return bkPos; break;
  case 2.5: bkPos =  "0 -76px";  return bkPos; break;
  case 3:   bkPos =  "0 -95px";  return bkPos; break;
  case 3.5: bkPos =  "0 -114px"; return bkPos; break;
  case 4:   bkPos =  "0 -133px"; return bkPos; break;
  case 4.5: bkPos =  "0 -152px"; return bkPos; break;
  case 5:   bkPos =  "0 -171px"; return bkPos; break;
  default:  bkPos =  "0 0"; return bkPos;
 }
}
// go through each selector and get the value of the data-rating attribute
// call the getRateImageBig function to set the proper background position
$(document).ready(function() {
 $("#rateBig .rating").each(function(i){
  var selector = $(this);
  dataRating = selector.data("rating"); 
  getRateImageBig(dataRating);
  selector.css({"backgroundPosition": bkPos});
 }); // each
}); //  ready
</script> 
```

基本上你可以对小星星做同样的事情。

顺便说一句，我使用[spritecow 在线工具](http://www.spritecow.com/)来获取精灵每个元素的正确背景位置。

在此处查看[演示](http://www.picssel.com/playground/jquery/CSS_spriteRating_14jul12.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T21:48:27.107

Alist Apart有一个很好的关于 css sprites [cssSprites的教程](http://www.alistapart.com/articles/sprites/)

# javascript - 有没有办法使用 js 清除浏览器缓存，至少我的域相关文件？

> ID：11486696
> 
> 赞同：1
> 
> 时间：2012-07-14T19:19:53.263
> 
> 标签：javascript, html

我有一个不需要每次都从服务器加载的 js 文件、css 和图像列表，但是如果文件中有任何更新或错误修复，只有在此期间我想从浏览器缓存中替换文件，我知道无法访问浏览器缓存，但是还有其他方法吗？我的应用程序将由特定用户（已知人）使用，我可以在他们的系统中安装任何程序，有人可以建议我这样做的有效方法吗？我不想每次都通过设置“无缓存”从服务器加载文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:24:50.407

强制浏览器在特定时间刷新特定文件的最有效方法是在链接中添加任意额外的查询字符串：

```
<script type="text/javascript" src="http://mywebsite.com/js/scripttoload.js"></script> 
```

然后更改为：

```
 <script type="text/javascript" src="http://mywebsite.com/js/scripttoload.js?V=2"></script> 
```

下次请求该页面时，浏览器会认为这是一个新文件。标题等还有很多其他方法，但这很好用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-14T19:26:46.180

一个常用的技巧是将文件的缓存设置为持续很长时间，这样就不会再次请求它们。但是，当您希望更新它们时，您可以在问号后的文件名后面附加时间戳。例如：

```
<link rel="stylesheet" href="style.css?123211212"/> 
```

每次数字变化时，浏览器都会认为它是一个不同的文件，并会重新下载它。如果数字没有改变，那么它使用缓存的版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-14T19:23:34.797

不，没有。

Javascript 无权访问缓存 - 浏览器不会将此信息公开给 javascript 引擎。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-14T19:52:02.010

我所做的是，作为构建过程的一部分，将所有静态引用的文件重命名为涉及其 md5 哈希的内容。然后我设置标题，以便它们在最长可能的时间内被缓存。一旦他们改变，他们就会得到一个新名字，所以从来没有问题。

# php - 从 Google Drive UI 调用应用程序时，为什么会修改 Google Drive 中的重定向 URL？

> ID：11486701
> 
> 赞同：0
> 
> 时间：2012-07-14T19:20:46.563
> 
> 标签：php, oauth, google-api, oauth-2.0, google-drive-api

我正在运行 PHP DrEdit 示例。

当我直接访问我的应用程序时，我可以通过 Google 进行身份验证。但是，当我尝试通过 Google Drive UI 访问它时：通过点击创建并选择应用程序，我收到 400 错误

```
Error: redirect_uri_mismatch
The redirect URI in the request: http://site.com did not match a registered redirect URI
Learn more 
```

我所有配置文件中的重定向 uri 实际上是[http://site.com/app](http://site.com/app)而不是[http://site.com](http://site.com)

唯一设置[http://site.com](http://site.com)的地方是“Javascript Origins”，它不会接受[http://site.com/app](http://site.com/app)作为有效的 url。

任何人都知道为什么重定向 url 被修改为[http://site.com](http://site.com)或者如果有什么地方我可以修改它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:31:00.417

DrEdit 示例使用[http://site.com](http://site.com)作为重定向 URI，因此您应该在配置文件中设置相同的值。

文档中列出了设置应用程序的所有步骤，请确保您遵循它们：

[https://developers.google.com/drive/examples/php#setting_up_this_sample_application](https://developers.google.com/drive/examples/php#setting_up_this_sample_application)

# c - C SQL 查询构建变得容易

> ID：11486704
> 
> 赞同：1
> 
> 时间：2012-07-14T19:21:06.663
> 
> 标签：在c, glib, c, glib, libmysql

[在c](/questions/tagged/c "显示标记为“c”的问题")中构建 SQL是一项痛苦的工作。构建这样的东西需要很多时间。我是[glib](/questions/tagged/glib "显示标记为“glib”的问题")新手。它有助于字符串操作。但我没有找到任何可以缩短查询构建代码的方法。在此处查看示例。

```
GString *acc_protocol = g_string_new(acc->prpl->name);
GString *acc_handle = g_string_new(acc->user);
GString *acc_password = g_string_new(acc->pass);
GString *acc_tag = g_string_new(acc->tag);
g_string_printf(q, "INSERT INTO accounts (user, protocol, handle, password, autoconnect, tag) values (%ld, ", user_id);
g_string_append(q,"'");
append_mysql_escaped_param(q, buf, acc_protocol);
g_string_append(q,"', '");
append_mysql_escaped_param(q, buf, acc_handle);
g_string_append(q,"', '");
append_mysql_escaped_param(q, buf, acc_password);
g_string_append(q,"', '");
g_string_append(q, atoi(acc->auto_connect));
g_string_append(q,"', '");
append_mysql_escaped_param(q, buf, acc_tag);
g_string_append(q,"') on duplicate key UPDATE password='");
append_mysql_escaped_param(q, buf, acc_password);
g_string_append(q,"', autoconnect='");
g_string_append(q, atoi(acc->auto_connect));
g_string_append(q,"', tag='");
append_mysql_escaped_param(q, buf, acc_tag);
g_string_append(q,"'");

g_string_free(acc_handle);
g_string_free(acc_password);
g_string_free(acc_protocol);
g_string_free(acc_tag);

mysql_real_query(mysql);
    num_rows =  mysql_affected_rows(mysql);
    ....
/// .... mysql processing here ... 
```

为了您的方便，这里是功能`append_mysql_escaped_param`

```
static void append_mysql_escaped_param(GString *query, GString *buffer, GString *param){
    g_string_set_size(buffer, param->len*2+1);
    mysql_real_escape_string(mysql, buffer->str, param->str, param->len);
    g_string_append(query, buffer->str);
} 
```

我怎样才能让它变小？这里有太多的冗余代码，足以让人头疼不已。有什么改进的办法吗？

我知道我可以使用准备好的语句。但是当我在准备好的语句上绑定值时，我也需要编写这样的批量代码。我只想摆脱容易出错的冗余代码。这尤其适用于 C。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T16:30:12.040

我会推荐[g_strdup_printf](http://developer.gnome.org/glib/2.28/glib-String-Utility-Functions.html#g-strdup-printf)。这使您可以摆脱与缓冲区相关的怪癖，并启用`printf`对字符串等的类似用法。您所要做的就是取消分配生成的缓冲区。

为了正确转义，我建议查看[g_strcanon](http://developer.gnome.org/glib/2.32/glib-String-Utility-Functions.html#g-strcanon)，它允许查找和替换字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:30:35.360

我只会回答您的最后一个问题（“有什么改进的想法吗？”）。

您在代码中所做的仅适用于某些一次性数据库访问或极不频繁的访问。每次新的请求文本到达数据库服务器时，它与任何缓存的字符串都不匹配，服务器将不得不花费大量时间准备执行语句。准备工作通常会占用查询总执行时间的 50-90%。

现在，我建议您做的改进是将您的数据库访问分为三个阶段：准备、绑定、执行：

*   *准备*是您将**常量**文本字符串发送到带有占位符的数据库服务器的地方，用于将实际值绑定到其中
*   *绑定*是您为这些占位符分配值的地方，绑定输入和输出参数。下次运行查询时，您只需将新值绑定到它并完全跳过第一步（！）
*   *可以多次调用此时的*Execute （如果出现可恢复的错误），而无需重复前两个步骤**

 *有关更多信息，请在 Google 中搜索目标数据库的“sql prepare bind execute”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T20:16:14.520

我建议您使用自定义占位符：

```
char querystring[]="INSERT INTO accounts (user, protocol, handle, password, autoconnect, tag) values ({param_user_id}, {param_protocol}, {param_handle}, {param_password}, {param_autoconnect}, {param_tag});"
parameterizeQuery(querystring, "user_id", user_id);
parameterizeQuery(querystring, "protocol", acc_protocol);
//do this for all remaining fields
g_string_printf(q, querystring); 
```

虽然`parameterizeQuery`可能看起来像这样：

```
void parameterizeQuery(char stringofquery[], char parameterstring[], char parametervalue[])
{
    //PSEUDO-CODE: stringofquery.str_replace("{param_"+parameterstring+"}", g_string_mysql_escape_param(parametervalue));
} 
```

这会有点短，但我不熟悉 glib。*

# objective-c - NSMutableArray removeObjectAtIndex 用法

> ID：11486706
> 
> 赞同：2
> 
> 时间：2012-07-14T19:21:25.120
> 
> 标签：objective-c, nsmutablearray

我正在尝试根据字符串的长度过滤掉一个字符串数组。一般来说，我对 Objective C 和 OOP 完全陌生。

```
wordList=[[stringFile componentsSeparatedByCharactersInSet:[NSCharacterSetnewlineCharacterSet]] mutableCopy];
for (int x=0; x<[wordList count]; x++) {
    if ([[wordList objectAtIndex:x] length] != 6) {
        [wordList removeObjectAtIndex:x];
    }else {
       NSLog([wordList objectAtIndex:x]);
    }
}

for (int x=0; x<[wordList count]; x++) {
    NSLog([wordList objectAtIndex:x]);
} 
```

else 语句中的 NSLog 只会输出 6 个字母的单词，但是第二个 NSLog 输出的是整个数组。我在这里想念什么？此外，任何清理/改进代码的通用指针都值得赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:39:27.653

根据您认为最容易理解的内容，您可以使用谓词过滤数组，也可以遍历数组并删除对象。您应该选择您最容易理解和维护的方法。

# 使用谓词过滤

谓词是过滤数组或集合的一种非常简洁的方法，但根据您的背景，使用它们可能会感觉很奇怪。你可以像这样过滤你的数组：

```
NSMutableArray * wordList = // ...
[wordList filterUsingPredicate:[NSPredicate predicateWithBlock:^BOOL(id evaluatedObject, NSDictionary *bindings) {
    NSString *word = evaluatedObject;
    return ([word length] == 6);
}]]; 
```

# 枚举和删除

枚举时不能修改数组，但可以记下要删除的所有项目，并在枚举整个数组后将它们全部删除，如下所示：

```
NSMutableArray * wordList = // ...
NSMutableIndexSet *indicesForObjectsToRemove = [[NSMutableIndexSet alloc] init];
[wordList enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
    NSString *word = obj;
    if ([word length] != 6) [indicesForObjectsToRemove addIndex:idx];
}];
[wordList removeObjectsAtIndexes:indicesForObjectsToRemove]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:25:02.350

您的代码的问题在于，当您删除 index 处的项目`x`并移至下一个 index`x++`时，`x+1`永远不会检查所在的项目。

过滤可变数组的最佳方法是使用该`filterUsingPredicate:`方法。以下是你如何使用它：

```
wordList=[[stringFile
    componentsSeparatedByCharactersInSet:[NSCharacterSetnewlineCharacterSet]]
    mutableCopy];
[wordList filterUsingPredicate:
    [NSPredicate predicateWithBlock:^BOOL(id evaluatedObject, NSDictionary * bindings) { 
        return [evaluatedObject length] == 6; // YES means "keep"
    }]]; 
```

# android - 以编程方式将 ImageView 添加到子活动

> ID：11486710
> 
> 赞同：0
> 
> 时间：2012-07-14T19:21:42.960
> 
> 标签：android, imageview, subactivity

我有一个带有 ImageView 的 main.xml 的 Activity。然后我启动另一个活动并用魔杖显示第一个活动中的相同图片。我的第二个活动的布局是使用线性布局（ll）以编程方式创建的。然后我使用以下内容：

```
 ImageView img = (ImageView) findViewById(R.drawable.logo);
    ll.addView(img);

    setContentView(ll); 
```

但我得到 img 为空，如果我将其更改为在 main.xml 中定义的 R.id.logo，它就不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T02:27:50.673

首先创建一个新的图像视图，`ImageView img = new ImageView(this);`然后将您的可绘制对象设置为“可绘制”文件夹中的任何图像，例如：`img.setImageResource(R.drawable.my_image);`

然后你可以像上面那样将它添加到你的线性布局中，然后 setContentView。

您在上面对 findViewById 所做的操作没有意义，因为您没有设置内容视图。因此，只需按照我上面概述的设置即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:23:58.340

如果您从 main.xml 调用 findViewByID，您首先需要将内容视图设置为 main.xml

# java - OSI 层与 Java 的关系

> ID：11486711
> 
> 赞同：2
> 
> 时间：2012-07-14T19:21:44.437
> 
> 标签：java, network-programming

这确实是一个理论问题。作为一名 Java 程序员，我需要关注哪一层来编写网络程序以及为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T21:54:59.707

您需要对所有层都有一定程度的了解（例如，了解第 3 层中的逻辑网络寻址非常有帮助）。

但通常，您将专注于高级层（第 5、6 和 7 层）。

说了这么多，根据我的经验，在 Java 开发项目中直接引用 OSI 层是比较少见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-30T23:43:23.123

你完全不必担心 OSI 层，因为在 Internet 商业化和 TCP/IP 的胜利之后，该项目在 1994 年左右崩溃了。OSI 现在仅具有历史意义。

您应该担心的是*TCP/IP*参考模型，它与 OSI 模型不同，但与 OSI 模型不同，它实际上描述了一些真实的东西。

从 Java 的角度来看，这两种模型几乎都不需要您关心，因为您只处理传输层的 TCP 和 UDP，以及您通过 API 使用的应用程序协议，例如 DNS，或自己编写。

# python - 构建 Python 类

> ID：11486713
> 
> 赞同：1
> 
> 时间：2012-07-14T19:21:52.497
> 
> 标签：python, class

我是 python 新手，完全是编程菜鸟，所以请耐心等待。

如果我正在构建显示人员类

```
 class Person:
      def __init__ (self, Name, Address, Phone, Height, Weight):
        self.name = Name
        self. Address = Address
        self.Phone = Phone
        self.Height = Height
        self.Weight = Weight
        self.PoundserPerInch = int(Height) / int(Weight) 
```

该函数究竟`__init__()`对代码做了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:22:51.977

该`__init__`方法是构造函数。它包含为从该类创建的每个对象运行的代码。它包含将对象初始化为适当状态的代码。

在您的情况下，您有一个`Person`可用于创建`Person`对象的类。如果你要写：

```
p = Person('John', '10 Foo Street', '1234567890', 70, 180) 
```

它将`Person`使用这些初始值创建一个对象。构造函数获取您传递的值，并将它们分配给该对象的变量。它还将计算一个名为 的值`PoundserPerInch`。

# android - Android SDK 单击按钮时更改文本

> ID：11486715
> 
> 赞同：2
> 
> 时间：2012-07-14T19:21:58.823
> 
> 标签：android, button, sdk

```
 package com.purelymean.earnings;
 import android.app.Activity;
 import android.os.Bundle;
 import android.widget.Button;
 import android.widget.TextView;

 public class Main extends Activity{
     /**Called when activity is first created. */
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);

         setContentView(R.layout.main);
         Button b = (Button) findViewById(R.id.button);
         TextView tx = (TextView) findViewById(R.id.textView1);
     }
 } 
```

我需要放什么，以便在单击按钮时它将更改`textview`为我放的任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:31:12.967

您应该添加一个`OnClickListener`到您的按钮和覆盖`onClick`功能以在您的`TextView`

```
Button b = (Button) findViewById(R.id.button);

b.setOnClickListener(new OnClickListener() {
   @Override
   public void onClick(View v) {
       TextView tx = (TextView) findViewById(R.id.textView1);
       tx.setText("yourtext");
   }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:32:47.907

将一个添加`OnClickListener`到您的按钮，这就是您所需要的。

```
b.setOnClickListener(new OnClickListener() {
   @Override
   public void onClick(View v) {
       tx.setText("It Works!");
   }
}); 
```

# android - 我的android webview上的后退按钮

> ID：11486718
> 
> 赞同：0
> 
> 时间：2012-07-14T19:22:13.473
> 
> 标签：android, button, webview, back

我试图向我的 android webview 添加一个后退按钮，但我遇到了这个错误：类型为 new WebViewClient(){} 的方法 onBackPressed() 必须覆盖或实现超类型方法

这是我的 Java 文件：

```
package sherdle.donald.duck.app;
import android.app.Activity;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;
public class WebPageLoader extends Activity
{
WebView webview;

final Activity activity = this;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
    setContentView(R.layout.main);
    WebView webView = (WebView) findViewById(R.id.webview);
    webView.getSettings().setJavaScriptEnabled(true);

    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress)
        {
            activity.setTitle("Loading...");
            activity.setProgress(progress * 100);

            if(progress == 100)
                activity.setTitle(R.string.app_name);
        }
    });

    webView.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedError(WebView view, int errorCode, String description,    String failingUrl)
        {
            // Handle the error
        }
        @Override
        public void onBackPressed() {
        // do something on back.
        return;
        }

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
    });

    webView.loadUrl("http://example.com");
   }
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:25:12.297

根据[文档](http://developer.android.com/reference/android/webkit/WebViewClient.html)，类中没有`onBackPressed`方法`WebViewClient`。你想在你的活动上覆盖它吗？尝试这样的事情：

```
package sherdle.donald.duck.app;
import android.app.Activity;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;
public class WebPageLoader extends Activity
{
WebView webView;

final Activity activity = this;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
    setContentView(R.layout.main);
    webView = (WebView) findViewById(R.id.webview);
    webView.getSettings().setJavaScriptEnabled(true);

    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress)
        {
            activity.setTitle("Loading...");
            activity.setProgress(progress * 100);

            if(progress == 100)
                activity.setTitle(R.string.app_name);
        }
    });

    webView.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedError(WebView view, int errorCode, String description,    String failingUrl)
        {
            // Handle the error
        }

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
    });

    webView.loadUrl("http://example.com");
   }
    @Override
    public void onBackPressed (){
        if(webView.canGoBack()) webView.goBack();
        else super.onBackPressed();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:27:11.857

试试这个

```
 package sherdle.donald.duck.app;
 import android.app.Activity;
 import android.os.Bundle;
 import android.view.Window;
 import android.webkit.WebChromeClient;
 import android.webkit.WebView;
 import android.webkit.WebViewClient;
 public class WebPageLoader extends Activity
 {
 WebView webview;

  final Activity activity = this;

@Override
public void onCreate(Bundle savedInstanceState)
{
super.onCreate(savedInstanceState);
this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
setContentView(R.layout.main);
webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(true);
webView.loadUrl("http://example.com");
webView.setWebChromeClient(new WebChromeClient() {
    public void onProgressChanged(WebView view, int progress)
    {
        activity.setTitle("Loading...");
        activity.setProgress(progress * 100);

        if(progress == 100)
            activity.setTitle(R.string.app_name);
    }
});

webView.setWebViewClient(new WebViewClient() {
    @Override
    public void onReceivedError(WebView view, int errorCode, String description,    String failingUrl)
    {
        // Handle the error
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url)
    {
        view.loadUrl(url);
        return true;
    }
});

  }

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    switch (keyCode) {
    case KeyEvent.KEYCODE_BACK:
             if(mWebView.canGoBack() == true)

              webview.goBack();
              else finish();
               break;

    default:
        break;
    }
    return super.onKeyDown(keyCode, event);
}
} 
```

并且这个方法应该在`Activty`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:33:09.583

您必须覆盖`onkeyDown()`Activity 中的方法。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if(event.getAction() == KeyEvent.ACTION_DOWN){
        switch(keyCode)
        {
        case KeyEvent.KEYCODE_BACK:
            if(mWebView.canGoBack() == true){
                mWebView.goBack();
            }else{
                finish();
            }
            return true;
        }

    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T16:58:16.593

```
WebView webView = (WebView) findViewById(R.id.webview); 
```

将其更改为：

```
webView = (WebView) findViewById(R.id.webview); 
```

然后使用第二个答案 - 就像一个魅力！

# linux - Orgmode 无法向 WebDAV 进行身份验证以进行移动组织“推送”

> ID：11486719
> 
> 赞同：3
> 
> 时间：2012-07-14T19:22:15.967
> 
> 标签：linux, webdav, org-mode

我正在为 orgmode MobileOrg 同步的 WebDAV 配置而苦苦挣扎。（Orgmode 文档建议使用 Dropbox 进行同步，但我上次检查时，这在我几乎全年居住的中国大陆不可用。本地连接具有不受外部当局阻止的优势。 )

Orgmode 在这方面的文档很少。

[http://orgmode.org/manual/Setting-up-the-staging-area.html](http://orgmode.org/manual/Setting-up-the-staging-area.html)

“[2] 如果您无法使用 Dropbox，或者您的 MobileOrg 版本不支持它，您可以使用 webdav 服务器。有关更多信息，请查看 MobileOrg 的文档以及此常见问题解答条目 [下一个链接]。”

[http://orgmode.org/worg/org-faq.html#mobileorg_webdav](http://orgmode.org/worg/org-faq.html#mobileorg_webdav)

在本节中，将讨论三种不同的方法：

*   将 webdav 服务挂载到文件系统位置，并将 orgmode 指向挂载位置。我尝试过这个。Orgmode 创建文件，但在几秒钟内，我系统中的某些东西将它们移动到 lost+found。没有机会同步到我的平板电脑。

*   使用*流浪汉*地址：`(setq org-mobile-directory "/scpc:user@remote.host:org/webdav/")`-- 尝试过，但`/scpc:my_web_userid@localhost:org/webdav/`身份验证失败。我可以使用 cadaver 以及 Nautilus 的“连接到服务器”进行身份验证（至少，它接受密码）。更多如下 [1]。

*   将 mobileorg 文件暂存到常规目录，并使用 orgmode 挂钩将它们放入 dav。也失败了——正确的密码没有通过身份验证。

[1] 但是，我刚刚用尸体再次尝试——试图“放置”一个文件。这就是“禁止”。因此，也许 orgmode 正在进行*身份*验证，但随后未能写入，并将其作为密码错误的情况报告给用户。

我有：

/etc/apache2/sites-available/默认值：

```
NameVirtualHost *
<VirtualHost *>
        ServerAdmin webmaster@localhost

        DocumentRoot /var/www/mobileorg/web/
        <Directory /var/www/mobileorg/web/>
                Options Indexes MultiViews
                AllowOverride None
                Order allow,deny
                allow from all
        </Directory>

        Alias /webdav /var/www/mobileorg/web

        <Location /webdav>
           DAV On
           AuthType Basic
           AuthName "webdav"
           AuthUserFile /var/www/mobileorg/passwd.dav
           Require valid-user
       </Location>
</VirtualHost> 
```

/etc/apache2/httpd.conf 为空。

所以，总结一下：

*   orgmode 以外的客户端：可以进行身份​​验证，不能将文件写入 webdav。
*   组织模式：密码被拒绝。

我可能缺少一些非常简单的东西，但我不是 Web 服务器配置方面的专家。

（这里还有一个关于“MobileOrg push 的 Emacs 错误”的问题，但这与我的问题不同。）

在此先感谢，詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:34:00.137

如果我错了，请原谅我，但听起来你对不同的运输方式感到困惑。WebDAV 仅用于为 MobileOrg 提供一种获取文件的方式。从桌面端，如果您通过传输方法使用*tramp*`scpc`，那么您应该使用您的**`ssh`**用户/密码，而不是您设置的任何 WebDAV 密码。这或许可以解释为什么您会看到密码从 orgmode 端不断被拒绝。

还要注意[http://orgmode.org/worg/org-faq.html#mobileorg_webdav](http://orgmode.org/worg/org-faq.html#mobileorg_webdav)中关于可能需要使用`scpx`而不是的警告`scpc`（碰巧，是我在文档中添加了该警告；-）。 [*tramp*提供了几种转移方法](http://www.gnu.org/software/tramp/#External-methods)，这些方法以微妙的方式变化。如果您仍然无法让*tramp*工作，请阅读其用户手册，其中详细说明了[如何调试连接过程](http://www.gnu.org/software/tramp/#Remote-shell-setup)。

最后，由于您没有提到您查看了服务器日志，如果上述方法没有帮助，我应该提醒您这样做，以防万一您还没有；-)

# python - 'LazySettings' 类型的 django 参数不可迭代；那么如何检查设置是否存在？

> ID：11486721
> 
> 赞同：7
> 
> 时间：2012-07-14T19:22:31.697
> 
> 标签：python, django, django-settings

```
from django.conf import settings

def my_view(self, request, *args, **kwargs):
    if 'LOCAL' in settings and settings.LOCAL:
        # do something 
```

> TypeError at ... 'LazySettings' 类型的参数不可迭代

那么如何检查设置是否存在？否则我得到一个属性错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-14T19:27:44.873

您可以使用以下[`hasattr`](http://docs.python.org/library/functions.html#hasattr)功能：

```
if hasattr(settings, 'name_of_setting'):
    # the setting exists
else:
    # the setting does not exist 
```

# java - 重写超类构造函数

> ID：11486723
> 
> 赞同：1
> 
> 时间：2012-07-14T19:22:42.843
> 
> 标签：java

我有两个类：**Year**和**LeapYear**在它们的构造函数中分别将一年中的天数设置为 365 和 366。我想在这里实现一些特定的东西。我想在 LeapYear 的构造函数中覆盖 Year 的构造函数以将天数设置为 366？或者，我做了以下事情。

```
public class Year {

private int days;

public Year() {
    this.days = 365;
}
public void setDays(int days) {
    this.days = days;
}

public int getDays() {
    return this.days;
} 
```

}

```
public class LeapYear extends Year {

public LeapYear() {
    setDays(366);
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T19:31:12.673

模型是错误的，这就是构造函数有问题的原因：366 天的闰年**是**365 天的一年根本不正确。但这就是你的模特试图告诉我们的。

你最好这样建模：

```
public abstract class PeriodOfDays {
   int days;
   public PeriodOfDays(int days) { this.days = days; }
}

public class StandardYear extends PeriodOfDays {
   public StandardYear() { super(365); }
}

public class LeapYear extends PeriodOfDays {
   public LeapYear() { super(366); }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:25:10.537

为什么不添加一个受保护的构造函数来接收它？

```
public class Year {

private int days;

protected Year(int days) {
   this.days = days;
}

public Year() {
    this(365);
}

public int getDays() {
    return this.days;
}
}

public class LeapYear extends Year {

public LeapYear()  {
  super(366);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:33:17.040

可能对丹尼尔的建议有所改进，因为`year.setDays()`感觉很“错误”。`final`使用字段 days制作公共构造函数。例如

```
public class Year {

private final int days;

protected Year(int days) {
   this.days = days;
}

public Year() {
   this(365);
}

public class LeapYear extends Year {

public LeapYear()  {
  super(366);
}

} 
```

注意：我同意@Andreas_D 的观点，即整个方法都是可疑的......

# google-app-engine - 在 appengine 数据存储上写入 blob 数据（字节数组）需要多少个 Write Ops？

> ID：11486729
> 
> 赞同：2
> 
> 时间：2012-07-14T19:23:12.817
> 
> 标签：google-app-engine, blob

我意识到创建许多新实体（和属性）非常昂贵，因此我决定将数据块（~50kb，压缩 Json）作为字节数组（blob）存储在一个实体中到 Datastore。

但是，我不知道写入/读取 blob 数据可能需要多少写入/读取操作。我想知道它是取决于 blob 数据的大小还是只是恒定的写入/读取操作。

先感谢您 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-14T22:26:41.520

**blobstore 数据是存储的数据**

> 存储的数据（可计费） 存储在数据存储实体和相应索引、任务队列和 Blobstore 中的数据总量。

因此，您喜欢按读取、写入而不是按大小付费的实体

[https://developers.google.com/appengine/docs/quotas#Datastore](https://developers.google.com/appengine/docs/quotas#Datastore)

**费用：** [https ://developers.google.com/appengine/docs/billing](https://developers.google.com/appengine/docs/billing)

*   实体获取（每个实体） 1 读取
*   新实体放置（每个实体，无论实体大小） 2 次写入 + 每个索引属性值 2 次写入 + 每个复合索引值 1 次写入
*   现有实体放置（每个实体） 1 次写入 + 每个修改的索引属性值 4 次写入 + 每个修改的复合索引值 2 次写入
*   实体删除（每个实体） 2 次写入 + 每个索引属性值 2 次写入 + 每个复合索引值 1 次写入
*   查询 1 次读取 + 1 次读取每个检索到的实体
*   查询（仅限键）1 读取 + 1 小每个检索到的实体
*   密钥分配（每个密钥） 1 小

    1.  每 10 万次操作写入 0.10 美元
    2.  每 10 万次操作读取 0.07 美元
    3.  每 10 万次操作小 0.01 美元

还要考虑存储成本

*   每月存储数据 (Blobstore) GB 0.13 美元 [免费限制 5 GB]

*   每月存储的数据 (Datastore) GB 0.24 美元 [免费限制 1 GB]

# struts2 - 没有动作映射等。在 Struts 2

> ID：11486731
> 
> 赞同：0
> 
> 时间：2012-07-14T19:23:17.467
> 
> 标签：struts2, web.xml, action-mapping

我知道还有另一个问题，但我只想说我看过其他所有东西或关于它的东西。所以，我目前正在构建我的 Struts 2 项目的结构。我使用 Struts 2.3.4、JBoss 7.1 和 Eclipse Indigo。我还将所有必要的 jar 包含到我的项目中。问题是当我运行我的应用程序（将项目添加到 Jboss，在服务器上运行）并转到“ [http://localhost:8080/booxstore/](http://localhost:8080/booxstore/) ”时，我得到了这个：

```
Etat HTTP 404 - There is no Action mapped for namespace [/] and action name [] associated with context path [/booxstore] 
```

![项目](../Images/a8daf88f97bac49b3837e61b07267368.png)

我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xmlns="http://java.sun.com/xml/ns/javaee" 
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" 
id="WebApp_ID" version="3.0">
  <display-name>Booxstore</display-name> 

  <filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>

</web-app> 
```

我的 struts.xml ：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
 "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
 "http://struts.apache.org/dtds/struts-2.0.dtd">

 <struts>
    <constant name="struts.devMode" value="false" />
    <package name="pages" namespace="/pages" extends="struts-default">
        <action name="afficher" class="com.booxstore.controller.DisplayAction" >
            <result name="SUCCESS">/center.jsp</result>
        </action>
    </package>
 </struts> 
```

我的行动：

```
/**
 * 
 */
package com.booxstore.controller;

import com.opensymphony.xwork2.Action;
import com.opensymphony.xwork2.ActionSupport;

public class DisplayAction extends ActionSupport {

    /**
     * 
     */
    private static final long serialVersionUID = 8199854978749642334L;

    public String execute() throws Exception{
        System.out.println("IN");
        return Action.SUCCESS;
    }
} 
```

我的 JSP 只有纯文本并导入了 struts 2 标记。基本上无论我做什么，我都无法获得资源。如果我转到“ [http://localhost:8080/booxstore/](http://localhost:8080/booxstore/) ”或“ [http://localhost:8080/booxstore/DisplayAction](http://localhost:8080/booxstore/DisplayAction) ”，我会得到“没有映射操作”，如果我尝试直接访问我得到的 jsp 404。请注意我的战争已在服务器上部署并启用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:47:16.970

放在文件夹`index.jsp`下`WebContent`，将文件夹移动`pages`到`WEB-INF`，然后将 struts.xml 更改为：

```
<struts>
 <constant name="struts.devMode" value="false" />
 <package name="pages" extends="struts-default">
    <action name="afficher" class="com.booxstore.controller.DisplayAction" >
        <result name="SUCCESS">/WEB-INF/pages/center.jsp</result>
    </action>
 </package>
</struts> 
```

我认为问题在于应用程序没有找到您放入配置文件的 jsps。如果`META-INF`您不想将它们公开，`WEB-INF`则文件夹不是放置 jsps 页面的地方，更适合此目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T13:01:10.157

为了防止对映射的误解，请将配置浏览器插件 jar 添加到您的应用程序中。它将允许您浏览所有页面。警告！仅在开发或测试中部署依赖项，而不是在生产中。使用 Maven 配置文件进行此限制。

[http://struts.apache.org/release/2.3.x/docs/config-browser-plugin.html](http://struts.apache.org/release/2.3.x/docs/config-browser-plugin.html)

# excel - 更新单元格后似乎没有应用条件格式

> ID：11486732
> 
> 赞同：1
> 
> 时间：2012-07-14T19:23:22.293
> 
> 标签：excel, conditional-formatting, vba

有没有办法使用 VBA 刷新单元格条件格式？

问题：我有一个单元格 (A1) 引用另一个单元格 (B1)，其中包含格式为“数字，小数点后 2 位”的 =SUM() 数值，但单元格 (A1) 有一个“单元格值> = 1000”的条件格式，并且我正在应用自定义格式，否则它使用欧元的货币格式。

我使用 VBA 更新值，然后执行

```
Application.CalculateFull 
```

它更新了我的公式，但是这种条件格式仅在值第一次超过 1000 时才应用......如果它小于 1000，它不会恢复到其原始格式。

以前有没有人遇到过这个问题并且知道如何更新条件格式？缺少使用 VBA 选择单元格并刷新它的一些方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T15:51:05.420

我决定选择单元格，重新应用公式，然后在每次 VBA 完成运行时激活它，下面修复了我的问题。

```
Range("A1").Formula = "=B1"
Range("A1").Select
Range("A1").Activate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-24T12:55:50.090

你也可以试试这个：

```
Sub refreshScreen()
  Application.Parent.Visible = False
  Application.Parent.Visible = True
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-21T16:23:19.370

如果使用自定义格式，这似乎是适用于 NumberFormat 属性以进行条件格式的错误（或不一致）。条件格式将应用自定义 NumberFormat，但在不再为 true 时不会恢复为默认值。仅使用字体/背景颜色时，使用 VBA 应用条件格式将按预期工作，但在应用自定义 NumberFormat 时将不再按预期工作。我通过为真假场景创建两种条件格式来解决这个问题。

条件为真时隐藏文本

```
.NumberFormat = ";;;" 
```

条件为假时显示文本

```
.NumberFormat = "General" 
```

设置了以下内容，但对行为没有影响：

*   EnableFormatConditionsCalculation 设置为 True
*   EnableEvents 设置为 True
*   计算设置为自动

这是一个链接，让我朝着正确的方向前进：

[http://www.mrexcel.com/forum/excel-questions/735479-conditional-formatting-not-updating.html](http://www.mrexcel.com/forum/excel-questions/735479-conditional-formatting-not-updating.html)

# c# - 使用 HtmlAgilityPack

> ID：11486733
> 
> 赞同：1
> 
> 时间：2012-07-14T19:23:24.317
> 
> 标签：c#, html-agility-pack

我正在尝试从 HTML 页面获取链接和另一个元素，但我真的不知道该怎么做。这就是我现在所拥有的：

```
var client = new HtmlWeb(); // Initialize HtmlAgilityPack's functions.
var url = "http://p.thedgtl.net/index.php?tag=-1&title={0}&author=&o=u&od=d&page=-1&"; // The site/page we are indexing.
var doc = client.Load(string.Format(url, textBox1.Text)); // Index the whole DB.
var nodes = doc.DocumentNode.SelectNodes("//a[@href]"); // Get every url.

string authorName = "";
string fileName = "";
string fileNameWithExt;

foreach (HtmlNode link in nodes)
{
    string completeUrl = link.Attributes["href"].Value; // The complete plugin download url.

    #region Get all jars

    if (completeUrl.Contains(".jar")) // Check if the url contains .jar
    {
        fileNameWithExt = completeUrl.Substring(completeUrl.LastIndexOf('/') + 1); // Get the filename with extension.
        fileName = fileNameWithExt.Remove(fileNameWithExt.LastIndexOf('.')); ; // Get the filename without extension.
        Console.WriteLine(fileName);
    }

    #endregion

    #region Get all Authors

    if (completeUrl.Contains("?author=")) // Check if the url contains .jar
    {
        authorName = completeUrl.Substring(completeUrl.LastIndexOf('=') + 1); // Get the filename with extension.
        Console.WriteLine(authorName);
    }

    #endregion
} 
```

我试图让所有文件名和作者彼此相邻，但现在一切都像随机放置，为什么？

有人可以帮我弄这个吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:26:16.807

如果您查看 HTML，很遗憾它的格式不正确。有很多打开的标签，HAP 的结构方式不像浏览器，它将文档的大部分解释为深度嵌套。因此，您不能像在浏览器中那样简单地遍历表的行，它比这要复杂得多。

在处理此类文档时，您必须对查询进行相当多的更改。而不是搜索子元素，您必须搜索调整变化的后代。

```
var title = System.Web.HttpUtility.UrlEncode(textBox1.Text);
var url = String.Format("http://p.thedgtl.net/index.php?title={0}", title);

var web = new HtmlWeb();
var doc = web.Load(url);

// select the rows in the table
var xpath = "//div[@class='content']/div[@class='pluginList']/table[2]";
var table = doc.DocumentNode.SelectSingleNode(xpath);

// unfortunately the `tr` tags are not closed so HAP interprets
// this table having a single row with multiple descendant `tr`s
var rows = table.Descendants("tr")
    .Skip(1); // skip header row

var query =
    from row in rows
    // there may be a row with an embedded ad
    where row.SelectSingleNode("td/script") == null
    // each row has 6 columns so we need to grab the next 6 descendants
    let columns = row.Descendants("td").Take(6).ToList()
    let titleText = columns[1].Elements("a").Select(a => a.InnerText).FirstOrDefault()
    let authorText = columns[2].Elements("a").Select(a => a.InnerText).FirstOrDefault()
    let downloadLink = columns[5].Elements("a").Select(a => a.GetAttributeValue("href", null)).FirstOrDefault()
    select new
    {
        Title = titleText ?? "",
        Author = authorText ?? "",
        FileName = Path.GetFileName(downloadLink ?? ""),
    }; 
```

所以现在您可以遍历查询并为每一行写出您想要的内容。

```
foreach (var item in query)
{
    Console.WriteLine("{0} ({1})", item.FileName, item.Author);
} 
```

# node.js - 如何使用 Mongo-Skin 在 MongoDB 对象中使用对象列表？

> ID：11486742
> 
> 赞同：0
> 
> 时间：2012-07-14T19:24:04.420
> 
> 标签：node.js, mongodb, mongoskin

我在 Node.JS 之上使用带有 mongoskin 的 mongoDB。

我有一个图像列表（集合“图像”），对于每张图像，我想保存一个评论列表。

我相信 mongodb 的正确方法是在每个 Image 文档中使用评论列表。

问题 - 我不知道该怎么做。如何在文档中使用列表？以及如何对它们执行 CRUD？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T09:00:01.863

没有直接的方法可以对嵌入式对象执行传统的 CRUD。您可以轻松地创建和阅读，但更新和删除，而且非常初级。您不能只选择一个嵌入对象；您只能选择父对象（具有_id 的对象）。嵌入对象列表是一个数组，其中对象是条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T09:29:07.413

这就是您使用驱动程序的方式（mongoskin 只是顶部的薄层）

```
var id = new ObjectId();
var image = {_id: id, title:"some title".......}
collection.insert(image, {safe:true}, function(err, result) {
  var comment = {title:'comment'}

  collection.update({_id:id}, {$push:{comments:comment}}, {safe:true}, function(err, nrofUpdated) {
  }
}) 
```

有用的链接

[http://docs.mongodb.org/manual/](http://docs.mongodb.org/manual/)

[http://mongodb.github.com/node-mongodb-native/](http://mongodb.github.com/node-mongodb-native/)

# html - 在 HTML/JSP 中引用 gzip 压缩的 CSS 和 JS

> ID：11486745
> 
> 赞同：6
> 
> 时间：2012-07-14T19:24:17.217
> 
> 标签：html, jsp, gzip

我正在使用[YUI 压缩器插件](http://alchim.sourceforge.net/yuicompressor-maven-plugin/compress-mojo.html)在我的 Java EE 应用程序中压缩和 gzip JS 和 CSS 文件。

但是，我不清楚如何在我的 HTML/JSP 文件中引用它们。

如果我只是使用 .gzip 参考，浏览器显然会抱怨说 -

`Resource interpreted as Script but transferred with MIME type application/x-gzip`

当前参考如下所示（引发上述错误）：

```
<script type="text/javascript" src="/scripts/home.js.gz"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-13T17:35:59.340

您看到的是浏览器中的警告，只要您以不同于返回的内容类型的方式解释数据，它就会显示此警告。

你真正想做的是：

```
Content-Type: text/javascript
Content-Encoding: gzip 
```

这将消除浏览器错误，但也会使浏览器认识到该文件必须在使用前解压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T21:06:51.513

您可以使用普通的 .js 和 .css 扩展名引用它们，并通过 firebug 或开发人员工具检查 CSS 和 JS 文件上的响应标头来检查 gzip 是否正常工作。

Gzipping 通常在 Web 服务器级别完成。

如果您使用的是 tomcat，则可以打开 Tomcat 安装的 conf/server.xml 并将以下内容添加到连接器定义中。

```
<Connector port="8080" protocol="HTTP/1.1" redirectPort="8443" connectionTimeout="20000"
           compressableMimeType="text/html,text/xml,text/css,text/javascript,text/plain,application/javascript,application/json" 
           compression="2048"/> 
```

对于 Apache 查找 mod_gzip 或 mod_deflate

这在您的根 .htaccess 文件中，但如果您可以访问 httpd.conf 那就更好了。

```
<ifModule mod_deflate.c>
<filesMatch "\.(js|css)$">
SetOutputFilter DEFLATE
</filesMatch>
</ifModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-17T10:14:15.323

虽然您可以配置 tomcat 为您执行所有 gzip，但我建议手动压缩您的静态资源，例如`js`和`css`文件并将它们保存在您的服务器上`css.gz`，`js.gz`然后您可以使用 servlet 将这些静态和预压缩文件发送到客户端，当一个请求进来时。

有关 servlet 实现，请参阅[https://gist.github.com/suprememoocow/1570654](https://gist.github.com/suprememoocow/1570654)。

如果您的服务器具有用于缓存 gzip 文件的内置机制，那么您可以使用它。据我发现tomcat（7）还没有这个功能。

# spring-roo - 用弹簧配置口水。xsd 错误

> ID：11486747
> 
> 赞同：2
> 
> 时间：2012-07-14T19:24:47.183
> 
> 标签：spring-roo, drools, applicationcontext

我正在尝试使用 Drools 创建 spring roo 应用程序。但是我在 applicationContext.xml 中遇到了错误。

错误：

> 在此行找到多个注释： - 无法找到架构命名空间“http://drools.org/schema/drools-spring”的元素“drools:execution-node”的 Spring NamespaceHandler - cvc-complex-type.2.4.c ：匹配的通配符是严格的，但找不到元素“drools:execution-node”的声明。

这是一段 applicationContext.xml：

```
<beans  xmlns="http://www.springframework.org/schema/beans" 
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:drools="http://drools.org/schema/drools-spring"
    xsi:schemaLocation="http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd         
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd         
      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd         
      http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd         
      http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd       
      http://drools.org/schema/drools-spring http://drools.org/schema/drools-spring.xsd"> 
```

在连接流口水时，我查看了以下来源： http: [//www.packtpub.com/article/drools-integration-modules-spring-framework-apache-camel](http://www.packtpub.com/article/drools-integration-modules-spring-framework-apache-camel) [http://blog.mersoft.com/2011/09/07/getting -started-with-drools-5-2](http://blog.mersoft.com/2011/09/07/getting-started-with-drools-5-2) [http://docs.jboss.org/drools/release/5.4.0.Final/droolsjbpm-integration-docs/html_single/index.html#d0e666](http://docs.jboss.org/drools/release/5.4.0.Final/droolsjbpm-integration-docs/html_single/index.html#d0e666)

也许他们会帮助某人。

听到的是流口水豆

```
 <drools:execution-node id="node1" /> 
```

```
 <drools:resources>

     <drools:resource  type="XSD" source="classpath:model.xsd"/>

     <drools:resource  type="DRL" source="classpath:test.drl"/>

  </drools:resources> 
```

请帮我配置名称空间。并给我更多关于 Drools spring 集成和 xml 命名空间的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-18T16:54:06.143

您收到错误的原因是因为[http://drools.org/schema/drools-spring.xsd](http://drools.org/schema/drools-spring.xsd)没有服务。如果你找到了一个正确服务它的 URI，你的错误应该会消失。我发现的一个示例 URI 是[http://grepcode.com/file_/repository.jboss.org/nexus/content/repositories/releases/org.drools/drools-spring/5.6.0.Final/org/drools/容器/spring/drools-spring.xsd/?v=source](http://grepcode.com/file_/repository.jboss.org/nexus/content/repositories/releases/org.drools/drools-spring/5.6.0.Final/org/drools/container/spring/drools-spring.xsd/?v=source)

我试图通过以下堆栈溢出问题找到更可靠的参考：[git hub 上 drools-spring.xsd 的位置](https://stackoverflow.com/questions/45172742/location-of-drools-spring-xsd-on-git-hub)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-10T16:15:55.417

我怀疑问题在于您使用的是 Spring 3.1，但使用了 drools-spring XML 配置，该配置加载了一些非常古老且过时的 Spring 依赖项。

我建议避免使用 drools-spring XML 配置。只需配置一个 Spring bean 来包含您的知识库并充当它的接口。

# regex - 将 Bash 数组元素传递给 Awk 正则表达式

> ID：11486749
> 
> 赞同：3
> 
> 时间：2012-07-14T19:24:54.877
> 
> 标签：regex, arrays, bash, variables, awk

我发现了几个关于如何将变量从`bash`into传递的问题`awk`，最值得注意的是`-v`命令，但我似乎无法让它们做我想做的事。

在脚本之外，我正在运行的命令是

```
awk '$2 ~ /^\/var$/ { print $1 }' /etc/fstab 
```

它只搜索`/etc/fstab`分区`/var`，并且应该打印出物理安装点，或者如果没有，则什么都没有。

现在在脚本中，我有一个包含许多分区的数组，我想做的是遍历该数组以搜索 fstab 中的每个物理挂载点。问题在于数组中的元素有一个`/`。

所以我想做的（在非常不正确的awk中）是：

```
PARTITIONS=(/usr /home /var tmp);
for ((n=0; n<${#PARTITION[@]}; n++)); do
    cat /etc/fstab | awk '$2 ~ /^\${PARTITIONS[$n]}$/ { print $1 }';
done 
```

但我知道那是不正确的。我现在最接近的是：

```
PARTITIONS=(/usr /home /var tmp);
for ((n=0; n<${#PARTITION[@]}; n++)); do
    cat /etc/fstab | awk -v partition="${PARTITIONS[$n]}" '$2 ~ /^\/var$/ { print $1," ",partition }';
done 
```

哪个至少将分区变量放入 awk，但根本无法帮助我匹配它。

所以基本上，我需要输入阵列，然后取出物理分区。最终结果将被分配给另一个数组，但是一旦我得到输出，我就可以从那里开始。

我也知道 awk 可以在一开始就消除对 cat 的需求，但是我对 awk 的了解还不够。:)

谢谢你的帮助。

**编辑**

```
cat /etc/fstab | awk -v partition="${PARTITIONS[$n]}" '$2 ~ partition { print $1 }' 
```

近似于我需要的足够有用的东西。我显然过于关注包含正则表达式。如果其他人可以清理它，将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T20:19:56.790

```
awk -v partition="${partitions[$n]}" '$2 ~ "^/" partition "$" { print $1 }' /etc/fstab 
```

您可以连接正则表达式字符（`^`- 字符串开头和`$`- 字符串结尾）和作为分区名称一部分的斜杠和包含分区名称的变量，方法是将它们彼此相邻放置。您不需要使用分隔硬编码正则表达式的斜线。

AWK 将接受文件名作为参数，而不使用`cat`管道或`<`重定向它。

我建议习惯于在 shell 中使用混合或小写的变量名，以避免与 shell 或环境变量的潜在名称冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T20:37:32.797

您还可以将整个数组传递给`awk`through `-v`，这假定目录名称不包含空格：

```
PARTITIONS=(/usr /home /var /tmp)
awk -v partition="${PARTITIONS[*]}" \
  '$2 != "" && partition ~ $2"\\>" { print $1 }' /etc/fstab 
```

这避免了`for`循环的需要。

### 解释

*   `partition="${PARTITIONS[*]}" 将整个数组作为空格分隔的字符串传递。
*   `$2 != ""`表示没有空行匹配。
*   `partition ~ $2"\\>"`匹配`$2`传入的字符串，`\\>`要求匹配位于单词的末尾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T20:11:41.243

首先，为了摆脱最烦人的事情（GUoC），`awk`可以像处理文件一样工作`cat`，所以直接传递它。您不能通过未展平的方式传递整个数组`-v`，但由于您正在迭代项目，所以没关系。如果你想避免`-v`，你可以通过直接将它们包含到 awk 脚本中来传递 bash 变量，你只需要小心引用（空格和 awk 自己的 $variable 用法）。例子：

```
awk '$2 ~ "'${PARTITIONS[$n]}'" { print $1 }' /etc/fstab 
```

或者带有软引号的更复杂的版本：

```
awk "\$2 ~ /${PARTITIONS[$n]//\//\\/}/ { print \$1 }" /etc/fstab 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T20:35:32.100

您可以使用 bash 的进程替换将数组作为附加文件传递给 awk。

```
partitions=( /usr /home /var /tmp )
awk '
    FNR==NR { partitions[$0]=""; next } 
    $1 !~ /^#/ && ($2 in partitions) { print $1 }
' <(printf '%s\n' "${partitions[@]}") /etc/fstab 
```

NR 保存当前读取的记录（行）数，FNR 保存当前文件中读取的当前记录数，所以 FNR==NR 只有在读取第一个文件时才成立，也就是本例中的进程替换。所以你填充了第一个文件的分区数组。

然后，对于第二个文件，您只需检查第二个字段是否在数组中......

不过，在这种情况下，我只使用 bash（版本 >= 4.0），因为`/etc/fstab`它通常相当小。

```
declare -A 'partitions=([/usr]= [/home]= [/var]= [/tmp]=)'
while read -r spec file vfstype mntops freq passno; do
    [[ $spec != \#* && ${partitions[$file]+set} ]] && echo "$spec"
done < /etc/fstab 
```

或者根据实际目标，您可以 parse `df`，它会告诉您目录所在的文件系统。

```
dirs=( /usr /home /var /tmp )
for dir in "${dirs[@]}"; do
    { read -r; read -r part _; } < <(df -P "$dir")
    echo "$part"
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-14T20:10:29.783

你可以这样做：

```
awk -v partitions="${PARTITIONS[*]}" '
    BEGIN { split(partitions,a," ") }
    { for (e in a) { if ($2 ~ a[e]) { print $1 } } }' /etc/fstab 
```

因此，您无需在`for`外部创建循环`awk`，这意味着更少的流程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-14T20:12:07.677

以下是一些可能有所帮助的观察结果。

如果输入只是一个文件，则不需要`cat`任何内容​​。那是：

```
$ cat file | program # would normally just be ...
$ program < file 
```

如果您需要将一些复杂的东西提供给`awk(1)`，那么也许您确实有一个用例`cat x | y`... 您可以执行类似 ...

```
(echo StartFlag ${PARTITIONS[*]}; cat /etc/fstab) | awk ... 
```

最后，为了在 SO 上获得最佳结果，请以如下格式询问...

1.  我的 PARTITIONS bash 变量包含*简化的示例内容*
2.  假设我的 /etc/fstab 包含*简化的示例 fstab*
3.  如何获得以下输出：*基于简化输入的确切期望输出*
4.  这就是我尝试过的：*有些人不仅会提供代码，还有助于在您试图找到解决方案的特定编程问题上寻求帮助*

# ruby-on-rails-3 - 向嵌套表单添加字段

> ID：11486753
> 
> 赞同：0
> 
> 时间：2012-07-14T19:25:08.820
> 
> 标签：ruby-on-rails-3, formbuilder

所以我有一个模型叫做 City and it `has_many :places`and it `accepts_nested_attributes_for :places`。每个地方`belongs_to :category`。当我为我拥有的城市渲染表单时`f.fields_for :places do |place|`，我会这样做：

```
<% f.fields_for :places do |place| %>
  <%= render "place_fields", :f => place
<% end %> 
```

我的 _place_fields.html.erb 包含以下内容：

```
<div class="place_header"><%= f.object.category.name %></div>
<div><%= f.label :name %>: <%=f.text_field :name %> </div>
<div><%= f.text_area :description %> </div> 
```

但是当我尝试添加一个新地方时，问题就出现了。首先，我想调出一个简单的选择表单来为新地点选择一个类别，然后根据 category_id 呈现相同的部分。我在同一个动作中这样做：

```
def add_place
  if params[:category_id]
    @place = Place.new(:category_id => params[:category_id])
    respond_to do |format|
      format.html { return nil }
      format.js {
        #here comes the render
      }
    end
  else
    render_message :header => "Choose category", :partial => "category_select", :over => 10
  end
end 
```

但是，如果我尝试这样做`$("#places_tab").append("<%= escape_javascript(render :partial => "place_fields", :f => @place %>");`，则会出现错误，这是意料之中的。

再一次：我需要为那个新地方渲染字段，只是不知道该怎么做。

**更新**

收到了一些关于将原始 City Formbuilder 传递给操作并直接从该构建器渲染该 Place 的建议，但不知道如何执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T02:49:50.190

问题是您将 Place 模型 (@place) 的实例作为表单构建器而不是表单构建器本身传递。

# html - 使用 BASH 和 AWK 创建 HTML 表

> ID：11486756
> 
> 赞同：3
> 
> 时间：2012-07-14T19:25:16.773
> 
> 标签：html, bash, function, awk, html-table

我在创建 html 表以显示文本文件中的统计信息时遇到问题。我确信有 100 种方法可以更好地做到这一点，但这里是：

**（以下脚本中的注释显示了输出）**

```
#!/bin/bash

function getapistats () {
    curl -s http://api.example.com/stats > api-stats.txt
    awk {'print $1'} api-stats.txt > api-stats-int.txt
    awk {'print $2'} api-stats.txt > api-stats-fqdm.txt
}

# api-stats.txt example
#    992 cdn.example.com
#    227 static.foo.com
#    225 imgcdn.bar.com
# end api-stats.txt example

function get_int () {

    for i in `cat api-stats-int.txt`;
        do echo -e "<tr><td>${i}</td>";
    done
}

function get_fqdn () {

    for f in `cat api-stats-fqdn.txt`;
        do echo -e "<td>${f}</td></tr>";
    done

}

function build_table () {

echo "<table>";
echo -e "`get_int`" "`get_fqdn`";
#echo -e "`get_fqdn`";
echo "</table>";
}

getapistats;

build_table > api-stats.html;

# Output fail :|
# <table>
# <tr><td>992</td>
# <tr><td>227</td>
# <tr><td>225</td><td>cdn.example.com</td></tr>
# <td>static.foo.com</td></tr>
# <td>imgcdn.bar.com</td></tr>

# Desired output:
# <tr><td>992</td><td>cdn.example.com</td></tr>
# ... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-14T21:34:36.500

这在纯 awk 中相当简单：

```
curl -s http://api.example.com/stats > api-stats.txt
awk 'BEGIN { print "<table>" }
     { print "<tr><td>" $1 "</td><td>" $2 "</td></tr>" }
     END   { print "</table>" }' api-stats.txt > api-stats.html 
```

awk 真的是为这种用途而设计的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-14T21:37:02.007

你至少可以用一个 awk 来做到这一点。

```
curl -s http://api.example.com/stats | awk '
    BEGIN{print "<table>"} 
    {printf("<tr><td>%d</td><td>%s</td></tr>\n",$1,$2)}
    END{print "</table>"}
' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:43:45.397

这可以用 bash 完成；）

```
    while read -u 3 a && read -u 4 b;do
      回声$a$b；
    完成 3</etc/passwd 4</etc/services

```

但我的经验是，在 bash/awk/etc 中做这样的事情通常是一件坏事

我在代码中使用的功能**深深地**隐藏在 bash 手册页中......

我建议使用一些真实的语言进行这种数据处理，例如：（ruby 或 python），因为它们更灵活/可读/可维护

# libreadline - 自动关闭 GNU Readline

> ID：11486757
> 
> 赞同：3
> 
> 时间：2012-07-14T19:25:17.840
> 
> 标签：libreadline

使用各种基于 GNU Readline 的 CLI，如果有一种方法可以在您键入时自动关闭括号和引号，这将大大加快我的速度。

因此，在 Bash（或其他 CLI）上键入`'`或`(`实际上会附加右引号或括号`''`，或者`()`将光标放在两者之间以进行书写。

我环顾四周，试图找出任何相关的东西（例如`~/.inputrc`设置），但没有找到任何东西，我想知道这是否可以实现。任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T02:54:47.400

这有点棘手，但可行。作为`bash`命令：

```
bind '"(" "\C-v()\e[D"'
bind '"\"" "\C-v\"\C-v\"\e[D"' 
```

作为设置`.inputrc`（因此任何使用的程序`readline`都会获得行为）：

```
"(": "\C-v()\e[D"
"\"": "\C-v\"\C-v\"\e[D" 
```

您可以在每个键前加上 Control-v 以键入“普通”引号和左括号，而不会触发自动关闭行为。

以上假设 Emacs 键绑定。对于 vi 绑定，使用

```
bind '"(": "\C-v()\ei"'
bind '"\"" "\C-v\"\C-v\"\ei"' 
```

或者

```
"(": "\C-v()\ei"
 "\"": "\C-v\"\C-v\"\ei" 
```

本质上，只需`[D`用`i`;替换 而不是发送转义序列向左移动光标，只需`\e`在插入括号/引号后发送回命令模式，然后重新进入插入模式，这应该将光标定位在刚刚输入的字符内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T16:10:29.660

完全按照自己的意愿去做是不可能的，但是有一种解决方法。把它放在 inputrc 中：

```
"\C-x\"": "\"\"C-b" 
```

跑：

```
info readline "comm" "readline init" "sample" 
```

对于整个样本。

# mysql - 在 MySQL 的同一个表上使用内部连接从两列中选择 DISTINCT 值

> ID：11486761
> 
> 赞同：0
> 
> 时间：2012-07-14T19:25:47.553
> 
> 标签：mysql, sql, database

我有一个查询，它从表中选择 20 行，循环并从同一个表中拉出位于所需分数范围内的单行。然后删除找到的行，这样就不会再次选择它。

user_id 是唯一的，有些行 col1=0，有些行 col1=1，因此第二个查询永远不会从第一个查询中选择一行。

临时表如下所示：

```
user_id  col1
-------------------
1        0
2        0
3        1
4        1 
```

用户表如下所示：

```
user_id   score
-----------------
1         1000
2         2000
3         3000
4         4000

$res = do_query("SELECT temp.user_id,user.score 
        FROM temp,user
        WHERE temp.col1=0 AND temp.user_id=user.user_id LIMIT 20");

while (($row = mysql_fetch_row($res))) {
    $score = $row[1];

    $alt_res = do_query("SELECT temp.user_id, user.score
        FROM temp,user
        WHERE temp.col1=1 AND temp.user_id=user.user_id 
        AND user.score<$score AND user.score>$score*0.66 LIMIT 1");

    $alt_row = mysql_fetch_row($alt_res)
    $user_id = $alt_row[0];

    do_query("DELETE FROM temp WHERE user_id=$user_id");
} 
```

这工作得很好，但是我试图把它变成一个单一的查询，但我不断得到重复的值，我似乎无法清除它们。

```
 SELECT temp.user_id,t1.user_id,t1.score FROM (
 SELECT temp.user_id,user.score
 FROM temp,user
 WHERE temp.col1=0 AND temp.user_id=user.user_id LIMIT 20) AS t1,temp,user
 WHERE temp.col1=1 AND temp.user_id=user.user_id 
 AND t1.score<user.score AND t1.score>user.score*0.66 GROUP BY temp.user_id 
```

我得到 20 行，其中 temp.user_id 是唯一的，但与 t1.user_id 重复。

例如：

```
temp.user_id    t1.user_id
----------------------------
1               6
2               7
3               7 
4               7
5               8 
```

而且我要：

```
temp.user_id      t1.user_id
-----------------------------
1                 6
2                 7
3                 8 
4                 9
5                 10 
```

知道如何做到这一点，以便在任一列中都没有重复 user_id 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:59:34.530

也许您可以更改`LIMIT 20`为`LIMIT 1`子查询？

# java - 使用 gson 反序列化时将 TypeToken 转换为 Type 时出错

> ID：11486764
> 
> 赞同：9
> 
> 时间：2012-07-14T19:26:33.827
> 
> 标签：java, eclipse, generics, casting, gson

我有一个类，它使用此函数反序列化泛型的 ArrayList，正如该线程的第一个答案中所述：[Java 抽象类函数泛型类型](https://stackoverflow.com/questions/8437121/java-abstract-class-function-generic-typej)

```
public <T> ArrayList<T> arrayType(String data){
    return g.fromJson(data,   TypeToken.get(new ArrayList<T>().getClass()));
} 
```

Eclipse 要求我转换 TypeToken 导致这个（sinde 函数 fromJson 需要一个类型，而不是一个 TypeToken）

```
public <T> ArrayList<T> arrayType(String data){
    return g.fromJson(data,  (Type) TypeToken.get(new ArrayList<T>().getClass()));
} 
```

结果我得到这个错误：

```
java.lang.ClassCastException: com.google.gson.reflect.TypeToken cannot be cast to java.lang.reflect.Type 
```

在[gson 用户手册](https://sites.google.com/site/gson/gson-user-guide)中，他们告诉您这是调用该函数的正确方法

```
Type collectionType = new TypeToken<Collection<Integer>>(){}.getType();
Collection<Integer> ints2 = gson.fromJson(json, collectionType); 
```

而且我看不出我做错了什么（如果这是一个有效的答案，为什么我会收到这个演员错误？）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-14T19:30:26.510

好吧，您正在调用`TypeToken.get`，它返回 a `TypeToken`- 而不是 a `Type`。在您展示的示例中，它正在使用`TypeToken.getType()`，它返回一个`Type`.

所以你*可以*使用：

```
return g.fromJson(data, TypeToken.get(new ArrayList<T>().getClass()).getType()); 
```

...这会给你一个`Type`，但它可能不是你真正想要的。特别是，由于类型擦除，无论`T`您从调用站点指定什么，都会返回相同的类型。如果您希望类型*真正*反映`ArrayList<T>`，则需要将类传递给方法，尽管我不完全确定从那里去哪里。（根据我的经验，在泛型方面，Java 反射 API 并不是很清楚。）

顺便说一句，我希望调用的方法`arrayType`与*数组*有关，而不是`ArrayList`.

# php - 亚马逊 MWS 状态为绿色但仍有错误

> ID：11486765
> 
> 赞同：1
> 
> 时间：2012-07-14T19:26:35.233
> 
> 标签：php, amazon-web-services, amazon

首先，对不起，我是亚马逊市场网络服务（MWS）的新手

我正在尝试位于[此处的用户订单库](https://developer.amazonservices.ca/doc/orders/orders/v20110101/php.html/187-5149453-8590134)

我配置了环境（.confic.php），并通过运行检查服务状态开始

`..\MarketplaceWebServiceOrders\Samples\GetServiceStatusSample.php`

状态是

> 绿色的

, 所以到现在为止

`GetOrderSample.php`当我在取消注释适当的服务 URL 后尝试运行时，我收到以下消息

> 捕获的异常：内部错误响应状态代码：403 错误代码：错误类型：请求 ID：XML：ResponseHeaderMetadata：RequestId：86358a3b-71ce-430f-8f91-c69003de099c，ResponseContext：Iqs86qjYVpx1jNRKOWhe5dPKVNBBHDjMtjf1oDNY6LGB+PMi9NLTCWh+O2-PM=7Times-:7 14T19:05:36.954Z 致命错误：第 0 行的 Unknown 中允许的内存大小为 268435456 字节已用尽（尝试分配 294415152 字节）

我检查了错误代码的文档，但是我找不到这样的错误，google了很多，但是失败了，

我检查了主机上的错误日志，错误日志有以下与我的问题相关的条目（我猜是因为我访问页面的时间相同）

[2012 年 7 月 14 日星期六 08:05:37] [错误] [client dummyIP.36.36333] 文件不存在：/home/myhomefolder/public_html/404.shtml，引用者：[http ://mydomain.com/src/MarketplaceWebServiceOrders/样品/GetOrderSample.php](http://mydomain.com/src/MarketplaceWebServiceOrders/Samples/GetOrderSample.php)

**在这之前**

我从我的本地主机上尝试过同样的方法，我在那里也没有成功

有谁能够帮我？有人可以帮我解决这个问题吗？

谢谢

# c# - 将数据从下拉列表保存到存储库

> ID：11486768
> 
> 赞同：0
> 
> 时间：2012-07-14T19:26:52.497
> 
> 标签：c#, asp.net-mvc

所以我有我的 Viewbag，它在我的创建剃刀视图中拉出一个下拉列表，该视图使用以下代码：

控制器

```
 ViewBag.ActionTypes = new SelectList(query.AsEnumerable(), "ActionTypeID", "ActionTypeTitle"); 
```

然后我的剃须刀会这样做；

```
 @Html.DropDownList("ActionTypeID", (IEnumerable<SelectListItem>)ViewBag.ActionTypes) 
```

我被困在我的 Post Method 中放置什么以及如何从下拉列表中获取值？

谁能指出我正确的方向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:30:35.277

假设您有一个名为 ActionType 的模型：

```
public class ActionType
{
    public int ActionTypeID { get; set; }

    ...
} 
```

由于您的 SelectList 使用相同的属性名称，因此 ModelBinder 将负责设置正确的 POSTed 值：

```
new SelectList(query.AsEnumerable(), "ActionTypeID", "ActionTypeTitle");
--------------------------------------------^ 
```

只需记住将同名的属性添加到您在 Action 中使用的 Model 类：

```
-------------------------------v  Add the property to this class.
[HttpPost]
public ActionResult Create(SomeModel model)
{
} 
```

* * *

这是一个例子。想象一下，您有以下实体框架已经生成的实体：

```
Person       Country
-------      -------
PersonID     CountryID
FullName     Name
CountryID

[HttpPost]
public ActionResult Create(PersonModel model)
{
    if (ModelState.IsValid)
    {
        DbEntities db = new DbEntities();
        Person person = new Person();
        person.FullName = model.FullName;
        person.CountryID = model.CountryID; // This value is from the DropDownList.

        db.AddToPersons(person);
        db.SaveChanges();

        return RedirectToAction("Index", "Home");       
    }

    // Something went wrong. Redisplay form.
    return View(model);
} 
```

只需将 POSTed ID 值设置为实体对象的外键属性即可。

# c - 对将字符串插入链表感到非常困惑

> ID：11486776
> 
> 赞同：-1
> 
> 时间：2012-07-14T19:27:57.040
> 
> 标签：c, string, linked-list

我已经在这个项目上工作了一天多，我真的很困惑。我祈祷有人帮助解决这个问题。我的功能有问题`insertItemList`。我不知道如何`String`将测试文件中的`linked list`. 这是一个家庭作业。这个项目比这大得多，但我把它简化为我需要帮助的地方。有人知道我做错了什么吗？

列表.h

```
 #ifndef _list_h
       #define _list_h

      /*
      * Defines a single list item.
      */

      typedef char *ListItemT;

      /*
      * Defines ListP to be a POINTER to a list struct.
      * (Define the list struct in the (.c) file.
      */

      typedef struct ListT *ListP;

      /*
      * Returns a pointer to a new empty list.
      * You may implement this list as a singly or doubly
      * linked list.
      */

      ListP newList();

      /*
      * Creates a new node, inserts the item into the
      * new node and inserts the new node into the list
      * after the current node.
      * Current in then moved to the newly inserted node.
      * NOTE: Impossible to insert at head of list.
      */

      void insertItemList(ListP, ListItemT);

      #endif 
```

列表.c

```
 #include <stdio.h>
      #include <stdlib.h>
      #include <string.h>
      #include "List.h"

      struct ListT
      { 
         char INFO[20]; 
         struct ListT *Next; 
      }*Head;

      /*
      * Returns a pointer to a new empty list.
      * You may implement this list as a singly or doubly
      * linked list.
      */

      ListP newList()

      {
      // allocate memory for new list 

      struct ListT *newnode = malloc(sizeof(struct ListT));

      return newnode; 
      }

      /*
      * Creates a new node, inserts the item into the
      * new node and inserts the new node into the list
      * after the current node.
      * Current in then moved to the newly inserted node.
      * NOTE: Impossible to insert at head of list.
      */

      //where I'm having trouble

     void insertItemList(ListP LOC, ListItemT DATA)

     {
     struct ListT *temp;

     temp=(struct ListT *)malloc(sizeof(struct ListT)); 

     strcpy(temp->INFO, DATA);
     } 
```

列表测试.c

```
 #include <stdio.h>
     #include <string.h>
     #include "List.h"

     int main()
     {
     // Create two lists
     ListP list1 = newList();
     ListP list2 = newList();
     printf("\nList Creation Successful!\n");

     // Insert one name into the first list
     insertItemList( list1, "Alice" ); //Ive never seen a parameter like this before.
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:47:51.707

您的代码中似乎没有任何内容可以设置`Next`列表节点的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-03T09:51:39.207

列表.c

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "List.h"

struct ListT { struct ListNodeT *head, *current; };
struct ListNodeT
{ 
    char INFO[20]; 
    struct ListNodeT *Next; 
};

/*
* Returns a pointer to a new empty list.
* You may implement this list as a singly or doubly
* linked list.
*/
ListP newList()
{
    // allocate memory for new list 
    struct ListT *newlist = malloc(sizeof(struct ListT));
    if (newlist) newlist->head = newlist->current = NULL;
    return newlist; 
}

/*
* Creates a new node, inserts the item into the
* new node and inserts the new node into the list
* after the current node.
* Current is then moved to the newly inserted node.
* NOTE: Impossible to insert at head of list.
*/
void insertItemList(ListP LOC, ListItemT DATA)
{
    struct ListNodeT *temp = malloc(sizeof(struct ListNodeT)); 
    if (!temp) abort();
    strncpy(temp->INFO, DATA, sizeof temp->INFO);
    if (LOC->current)
        temp->Next = LOC->current->Next,
        LOC->current->Next = temp;
    else
        temp->Next = NULL,
        LOC->head = temp;
    LOC->current = temp;
} 
```

# sql - SQLite 列 列中最常见的项目

> ID：11486777
> 
> 赞同：1
> 
> 时间：2012-07-14T19:28:04.497
> 
> 标签：sql, sqlite

我在 SQLite 中有一个表，我想获取具有最多计数元素的项目。SQL 让我发疯，给了我错误的答案。

桌子：

```
ItemNumber (int) 
totalPurchased (int) 
```

这些行看起来像这样。

```
 ItemNumber              TotalPurchased
        1                        7
        1                       10
        1                       20
        2                       40
        3                       32 
```

我想要返回的是 ItemNumber 的 2 整数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T19:31:58.787

你的意思是这样的：

```
SELECT ItemNumber
FROM myTable
WHERE TotalPurchased = (SELECT MAX(TotalPurchased) FROM myTable) 
```

关键是用简单的英语思考你想要什么。在这种情况下，它是“给我 TotalPurchased 最大行的 ItemNumber”。不幸的是，SQL 不理解“with”。但换个说法，我们得到“给我 TotalPurchased 是整个表中 TotalPurchased 最大值的行的 ItemNumber”，这就是这里的答案。

* * *

再想一想，我可能误解了你，你想要 TotalPurchased （TotalPurchased 不是总数？）......在这种情况下，试试类似的东西：

```
SELECT t1.ItemNumber, SUM(t1.TotalPurchased) AS TotalTotalPurchased
FROM myTable AS t1
GROUP BY ItemNumber
HAVING SUM(t1.TotalPurchased) =  (
    SELECT SUM(TotalPurchased)
    FROM myTable
    GROUP BY ItemNumber
    ORDER BY SUM(TotalPurchased) DESC  
    LIMIT 1
) 
```

[http://sqlfiddle.com/#!5/1cd57/3](http://sqlfiddle.com/#!5/1cd57/3)

请注意，这些查询的优点是，如果将多个 ItemNumber 绑定到最大值，您将获得所有结果。但是，如果您只想要一个最佳结果，请使用@DmitryOsinovskiy 的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:34:41.813

如果您需要按 ItemNumber 对所有内容求和，则取最大值，使用此

```
select ItemNumber from MyTable
group by ItemNumber
order by sum(TotalPurchased) desc
limit 1 
```

如果你不需要求和，试试这个

```
select ItemNumber from MyTable
order by TotalPurchased desc
limit 1 
```

无论如何，比较我的解决方案和 lc 解决方案的性能。（使用 max()）并选择更好的。

# javascript - 从 Mongodb 格式化 ISODate

> ID：11486779
> 
> 赞同：35
> 
> 时间：2012-07-14T19:28:27.070
> 
> 标签：javascript, node.js, mongodb, isodate

在 Mongodb 中，我以 ISODate 格式存储日期和时间。

看起来像这样

```
ISODate("2012-07-14T01:00:00+01:00") 
```

使用 nodejs/javascript，我怎样才能显示时间组件，所以我会得到这样的东西

```
Time : 01:00 
```

我正在使用 momentjs 使这更容易，但据我所知，momentjs 似乎确实支持 ISODate 格式。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-14T22:32:58.640

JavaScript 的 Date 对象支持 ISO 日期格式，所以只要你可以访问日期字符串，你就可以这样做：

```
> foo = new Date("2012-07-14T01:00:00+01:00")
Sat, 14 Jul 2012 00:00:00 GMT
> foo.toTimeString()
'17:00:00 GMT-0700 (MST)' 
```

如果您想要没有秒和时区的时间字符串，那么您可以调用 Date 对象上的 getHours() 和 getMinutes() 方法并自己格式化时间。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-07-14T23:10:43.980

MongoDB 的[ISODate()](http://www.mongodb.org/display/DOCS/Dates)只是一个帮助函数，它包装了一个 JavaScript 日期对象，使处理 ISO 日期字符串变得更容易。

您仍然可以使用[与使用普通 JS Date 相同的所有方法](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)，例如：

```
ISODate("2012-07-14T01:00:00+01:00").toLocaleTimeString()

// Note that getHours() and getMinutes() do not include leading 0s for single digit #s
ISODate("2012-07-14T01:00:00+01:00").getHours()
ISODate("2012-07-14T01:00:00+01:00").getMinutes() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-24T19:15:40.303

你可以像这样使用mongo查询 yearMonthDayhms: { $dateToString: { format: "%Y-%m-%d-%H-%M-%S", date: {$subtract:["$cdt",14400000] }}}

HourMinute: { $dateToString: { 格式: "%H-%M-%S", 日期: {$subtract:["$cdt",14400000]}}}

[![在此处输入图像描述](../Images/bf85716f8e51ac9d4e6c934edcc18e24.png)](https://i.stack.imgur.com/sDUAm.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-24T06:43:27.060

```
// from MongoDate object to Javascript Date object

var MongoDate = {sec: 1493016016, usec: 650000};
var dt = new Date("1970-01-01T00:00:00+00:00");
    dt.setSeconds(MongoDate.sec); 
```

# c - 结构类型/函数调用

> ID：11486786
> 
> 赞同：-2
> 
> 时间：2012-07-14T19:29:39.227
> 
> 标签：c, function, struct

我正在开发一个程序，但无法理解编译器错误。

```
arrays.c:12:21: error: flexible array member not at end of struct
arrays.c: In function 'insert':
arrays.c:22:4: warning: statement with no effect 
```

我知道这些是非常简单的事情，但我无法解决它们。我不确定我的插入功能是否正确。谁能帮帮我吗？谢谢

```
#include <stdio.h>

#define AMOUNT 7

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:18:49.443

用空方括号声明的结构成员`[]`称为*灵活数组成员*。这在[comp.lang.c FAQ](http://c-faq.com/)的问题 2.6 中有解释（一直滚动到底部）。灵活的数组成员可能仅作为结构的最后声明的成员出现，这是您的编译器所抱怨的。

但是将它移到结构的末尾并不是最好的解决方案；您可能根本不想使用灵活的数组成员。（你可以，但它引入了不必要的复杂性。）

正如 dasblinkenlight 所说，您可以使`name`成员成为指针：

```
struct person {
    char *name;
    int age;
}; 
```

`name`然后将指向一个代表人名的字符串——这意味着您需要分配内存来保存该字符串。

或者您可以制作`name`一个具有固定最大大小的 数组`char`：

```
#define MAX_NAME 50
struct person {
    char name[MAX_NAME];
    int age;
}; 
```

然后，您可以使用该`strcpy`函数将一个值复制到其中`name`——注意不要尝试复制超过`MAX_NAME`字节的内容。

在您的`insert`函数中，这些语句：

```
people[nextcell].names;
people[nextcell].ages; 
```

大概是为了初始化`names`and`ages`成员（更好的名字：`name`and `age`），但实际上它们什么都不做；他们指的是那些成员，但他们不对他们做任何事情。对于`age`，您可以简单地将`age`参数的值（您当前正在忽略）分配给`age`成员：

```
people[nextcell].age = age; 
```

分配值的方式`name`取决于您决定将其定义为指针还是数组。

# ajax - Rails - 尝试创建简单的 ajax 示例

> ID：11486796
> 
> 赞同：0
> 
> 时间：2012-07-14T19:30:56.363
> 
> 标签：ajax, ruby-on-rails-3

下面的代码由于某种原因不起作用。当我单击“测试”时，它会将我重定向到 /home/test 并且什么也没有显示。

**查看/home/index.html.erb**

```
<%= link_to "test", { :controller => "home", :action => "test" }, :remote => true %>
   <div id='test_div'>
</div> 
```

**查看/home/index.js.erb**

```
$("#test_div").html("some text"); 
```

**控制器**

```
class HomeController < ApplicationController
 def test
    "test123 test456"
    respond_to() do |format|
      format.js {render :layout => false}
    end
  end
end 
```

我应该怎么做才能使用 ajax 刷新 div_test？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:55:11.097

你的路由文件是什么样的？可以发在这里吗？做一个 rake 路由并发布输出。

以下是一些可能对您有所帮助的事情：

1.  [用于路由的 Rails 文档](http://guides.rubyonrails.org/routing.html)
2.  此外，请查看[Ajax on Rails 文档](http://guides.rubyonrails.org/ajax_on_rails.html)和关于 link_to_remote 的部分。该`link_to_remote`功能不在 Rails 中。你用的是什么版本的rails？重击：`$ rails -v`
3.  在 SO 上查看有关 AJAX on Rails 调用的[答案。](https://stackoverflow.com/questions/4766383/rails-3-link-to-to-call-partial-using-jquery-ajax)
4.  编辑：这是[另一个](https://stackoverflow.com/questions/9496172/how-to-use-link-to-with-ajax-in-rails-3-2-1)可能有帮助的答案。
5.  [SO更新现有元素的另一个答案](https://stackoverflow.com/questions/9655142/whats-the-correct-way-to-do-ajax-callback-with-rails-3-link-to)

编辑：再看一遍，我认为你不需要`()`after`respond_to`或`{...}`in `link_to`。看第三个链接。我认为您需要将页面放在一个部分并呈现它。它现在没有渲染，因为它`render :layout => false`

# php - 使用 PHP 从连接服务器的网络摄像头拍摄静态照片

> ID：11486800
> 
> 赞同：1
> 
> 时间：2012-07-14T19:31:36.247
> 
> 标签：php, png, webcam, photography

我有一个网络摄像头（Logitech Webcam Pro 9000）通过 USB 连接到网络服务器，我需要定期拍摄静态照片（严格在服务器端，不需要视频，不需要 Javascript）。到目前为止，这是通过一个名为 WebcamXP 的应用程序完成的，但这有点不稳定，有很多限制，而且完全不灵活。

相反，我可以使用 PHP - 以及一些轻量级扩展/插件 - 来完成捕获静止图像的这项工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:27:05.843

..对于那些喜欢“全方位服务”的人来说，这里是结构良好的 PHP 代码：

```
<?
$CaptureString='"C:\Program Files (x86)\VideoLan\VLC\vlc.exe"'.
' --dshow-vdev="Logitech Webcam Pro 9000" '.
'"dshow://" '.
':dshow-size="320x240" '.
'--run-time=1 '.
'--scene-ratio=24 '.
'--scene-path=C:\TestSite '.
'--scene-format=jpeg '.
'--scene-prefix=snap '.
'--no-audio '.
'--video-filter=scene '.
'-V dummy '. '--intf=dummy '.
'--dummy-quiet '.
'vlc://quit';
$last = exec($CaptureString, $output, $returnvar);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:54:05.240

扩展 Parahat 的信息。不，没有办法严格使用 PHP。但至少在大多数版本的 linux 中应该有办法做到这一点。

在此处查看可以执行此功能的终端程序的[答案](https://askubuntu.com/a/106773/13361)，安装一个（对于 apt-get 的 ubuntu）适用于您的网络摄像头（由于类似的标准，大多数程序应该适用于大多数网络摄像头），然后[执行终端命令](http://php.net/manual/en/function.exec.php)从相机中抓取静止图像。

希望这能让你走上正轨。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T20:49:33.320

我找到了！！！使用一个名为“VLC”的非常小巧方便的软件。就我而言，CLI 字符串是

```
C:\Program Files (x86)\VideoLAN\VLC>vlc --dshow-vdev="Logitech Webcam Pro 9000"
"dshow://" :dshow-size="320x240" --run-time=1 --scene-ratio=24 
--scene-path=C:\TestSite --scene-format=jpeg --scene-prefix=snap 
--no-audio --video-filter=scene
-V dummy --intf=dummy --dummy-quiet 
```

另请参阅[http://forum.videolan.org/viewtopic.php?f=2&t=63313](http://forum.videolan.org/viewtopic.php?f=2&t=63313)了解更多详情。

# jquery - 如何使用 Jquery 附加具有特定 ID 的标签？

> ID：11486801
> 
> 赞同：1
> 
> 时间：2012-07-14T19:31:45.357
> 
> 标签：jquery

我想将标签附加到具有不同 ID 的标签上，例如。

```
<div id="1"></div>
<div id="2"></div>
<div id="3"></div>
<div id="4"></div> 
```

如果我使用`$('div').append('<span>Hello World</span>);` ，那么它会将`<span>`标签附加到每个`<div>`，但我想根据它的 ID 将它附加到仅 1 个 div。例如一些时间到 4 一些时间到 3 等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T19:34:28.157

使用 JQuery 提供的美妙的 id 选择器:)

```
$("#1").append('<span>Hello World</span>'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T19:34:38.700

只需使用 ID 选择器：

```
$('#1').append('<span>Hello World</span>'); 
```

**编辑：*如果您不使用 HTML5：***

当 ID 或类不跟随字符时，您不能在它们中使用数字。所以你需要使用 id="div1" 代替：

```
$('#div1').append('<span>Hello World</span>'); 
```

# css - SVG设置属性填充不起作用

> ID：11486809
> 
> 赞同：0
> 
> 时间：2012-07-14T19:33:17.650
> 
> 标签：css, svg, smil

我希望我的 svg 在其内部的按钮悬停时更改其填充。

```
<set attributeName="fill" to="#AEAEAE" begin="button.mouseover" end="button.mouseout"/> 
```

我认为这会起作用，但它保留了 #FF702A 的原始填充

有人可以帮忙吗？

/////编辑//////

我对其进行了重构以使其更简单。除非我遗漏了一些主要概念，否则仅使用 css 应该是可能的？

这是html-

```
 <div id="button">show svg onhover
     <svg id="play" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="42px" height="62px" viewBox="0 0 24 32" style="enable-background:new 0 0 24 32;" xml:space="preserve" xmlns:xml="http://www.w3.org/XML/1998/namespace">
    <g id="Layer_1">
    </g>
    <g id="play">
      <polygon points="0,0 24,16 0,32  "/>      
    </g>
   </svg>
  </div> 
```

这是相关的CSS

```
#button {

height: 75px;
width: 275px;
font-size: 25px;
text-align: center;
background: #FF702A;
border-radius: 10px;
padding-top: 40px;
margin-top: 70px;
margin-left: 150px;
opacity: 0.7;
letter-spacing: 1px;
font-variant: small-caps;
color: #EEEEEE; 
```

}

```
#button:hover {
opacity: 1.0;
font-size: .01em; 
```

}

```
#play{
position: absolute;
margin-left: -90px;
margin-top: -10px;
visibility: hidden; 
```

}

```
#play:hover {
visibility: visible; 
```

}

在悬停时隐藏文本是一种技巧，但为什么 svg 的可见性在悬停时不起作用？很抱歉从原来的问题采取不同的方向，但希望这能澄清一点。希望用纯 css 完成..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T10:50:11.210

你也可以只用 CSS 做到这一点：

```
#button { fill: #FF702A; }
#button:hover { fill: #AEAEAE; } 
```

如果您想知道为什么它不起作用，则必须将带有 id="button" 的元素（及其子元素，如果有的话）添加到问题中。

# c++ - 函数调用中 * 和 & 运算符的区别

> ID：11486818
> 
> 赞同：1
> 
> 时间：2012-07-14T19:34:12.337
> 
> 标签：c++, function, dereference, address-operator

> **可能重复：**
> [C++ 函数：& 与星号](https://stackoverflow.com/questions/670101/c-functions-ampersand-vs-asterisk)
> [结合参数的各种符号（*、& 等）之间有什么区别？](https://stackoverflow.com/questions/9636903/what-are-the-distinctions-between-the-various-symbols-etc-combined-with-p)

我想知道C++ 函数调用中地址运算符`&`和引用运算符之间的区别。`*`例如采取以下功能

```
void foo (std::string& param)
{
     param = "Bar.";
     std::cout << param.size();
} 
```

让我们在我们的`main()`函数中这样调用它......

```
int main()
{
      std::string test;
      foo(test);          //Why not foo(&test)?
      std::cout << test;  //Prints out the value "Bar."
} 
```

首先，为什么`&`操作员允许我像指针一样分配一个值（当它不是指针时，分配一个在 RAII 和函数范围内幸存的值`foo()`），因为它可以在我的`main()`函数中打印出来即使不是`static`？我假设它不是指针，因为我可以`size()`通过使用`.`运算符而不是`->`用于指针的运算符来访问该方法。

`&`其次，在函数参数中使用运算符与使用运算符有什么区别`*`？它甚至与像这样的普通变量不同`std::string param`吗？它似乎被称为（`foo(test)`而不是`foo(&test)`）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T19:39:47.307

`&`函数参数特别表示此参数是通过**引用**传入的（传统上编译器将 this 实现为指针），这就是为什么您在`main()`. `static`与此无关。

`&`使用and向函数声明参数的区别`*`在于，第二个允许`nullptr`传入一个（或不存在或只是一个普通的无效地址），同时`&`保证此函数的参数引用了一个真实的对象. 除此之外，两者都提供了允许通过引用更改原始对象的类似功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:36:47.950

`test`它自己（没有`&`）会将字符串的副本传递给函数，而这`&`意味着它将传递引用。

仅供参考：当您不需要引用时，最佳实践要求将所有对象作为 const 引用传递。

# python - 避免在 Python IRC bot 中进行昂贵的计算

> ID：11486819
> 
> 赞同：2
> 
> 时间：2012-07-14T19:34:20.607
> 
> 标签：python, calculator, arbitrary-precision

我在公共 IRC 机器人中使用[这个计算器。](https://stackoverflow.com/questions/11419463/python-eval-not-working-within-a-function)鉴于 Python 默认使用任意精度，这将允许任何用户执行类似`calc 10000**10000**10000`或`calc factorial(1000000)`有效地“杀死”机器人的事情。

我想知道是否有某种方法可以避免这种情况。我已经尝试将表达式中的所有术语都转换为浮动，但`float(factorial(1000000)`在 Python 解释器中仍然需要很长时间才能完成，而且我不确定多线程方法是否是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:52:02.007

不是一个真正的答案，但我会这样做。您要运行的所有内容都应该在不同的进程中运行。据我所知，不可能限制进程中单个线程的 CPU 使用率或内存使用率。

也就是说，您必须创建一个新进程，与任务一样执行用户输入的内容并将其写入文件，例如。你可以这样做，使用`fork`创建一个新文件，`PID`并且主进程必须检查直到子进程死亡。一旦进程终止，打开文件“cool_calculator_[pid].out”并将其发送回`IRC`.

我想这很简单。

然后使用 ulimit 或其他工具，可以限制子进程，甚至使用主进程杀死它们。如果文件`pid`为空，只需回答存在错误或其他问题。我猜你甚至可以写一些错误，比如超出内存或超出 cpu 等。

这完全取决于您要如何杀死不良进程。

最后，您的主进程将负责生成子进程并在需要时杀死它们并发送回答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T21:26:41.973

看起来`float()`演员阵容毕竟是解决方案。

首先，反三角函数不会在其域之外取值，因此它们是完全安全的，并且可以捕获异常。

```
>>> acos(5e100)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: math domain error 
```

函数也会发生同样的事情`fmod()`。

“正常”三角函数似乎对大值没有任何问题，除非它们*真的*很大，这使得函数`ValueError`再次返回。

舍入函数 (`ceil()`和`floor()`)`round()`工作正常，`inf`如果值太大则返回。`degrees()`, `log()`, `log10()`, `pow()`, `sqrt()`, `fabs()`,`hypot()`和`radians()`函数也是如此。

双曲三角函数和`exp()`函数 throw`OverflowError`或 return `inf`。

该`atan2()`功能适用​​于大值。

对于简单的算术运算，浮点转换使函数抛出一个`OverflowError`（或一个`inf`）而不是进行计算。

```
>>> float(10) ** float(100) ** float(100) ** float(1000)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
OverflowError: (34, 'Numerical result out of range')
>>> float(5e500) * float(4e1000)
inf 
```

最后，有问题的 factorial() 函数。我所要做的就是以迭代的方式重新定义函数并将其添加到`safe_dict`.

```
import sys

def factorial(n):
    fact = 1
    while (n > 0):
        fact = float(fact) * float(n)
        n -= float(1)
        if float(fact) > sys.float_info.max:
            return "Too big"
    return str(fact)

print factorial(50e500) 
```

虽然这是一种非常丑陋且效率极低的阶乘计算方式，但足以满足我的需求。其实我觉得我加了很多不必要`float()`的s。

现在我需要弄清楚如何将`float()`s 放在表达式中的所有术语周围，以便自动发生。

# java - 创建jar文件时如何添加输入文件

> ID：11486820
> 
> 赞同：0
> 
> 时间：2012-07-14T19:34:22.970
> 
> 标签：java, netbeans, jar

对于我的 Java 应用程序，我在**src**文件夹中使用了一些输入文件。但是在我创建了jar文件并使用它之后，它给出了一个错误，说**找不到文件**。在 NetBeans 中创建 jar 文件时如何添加输入文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:37:42.170

您需要使用[`getResourceAsStream(String name)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29), 来获取文件的流：

```
InputStream is = MyClass.class.getResourceAsStream("fileName"); 
```

这会将输入流返回到`fileName`位于其中的目录内的文件`MyClass.class`。

# objective-c - 将 UIImagePickerController 与 Web 数据源一起使用

> ID：11486824
> 
> 赞同：0
> 
> 时间：2012-07-14T19:34:42.400
> 
> 标签：objective-c, ios, cocoa-touch, uiview, uiimagepickercontroller

是否可以使用 UIImagePickerController 或类似的东西从网络上挑选图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:01:33.187

我猜你需要将图像从网络下载到缓存目录，然后在你的 UIImagePickerController 中显示它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:15:07.710

不幸的是，除了内置的 Apple 提供的图像源之外，您将无法使用 UIImagePickerController 从任何东西中选择图像。即相机，相机胶卷，照片库。

那里有一些开源图像选择器，在 GitHub 上快速搜索找到了[JPImagePickerController](https://github.com/jeena/JPImagePickerController)

# iphone - 表视图滚动异步

> ID：11486828
> 
> 赞同：6
> 
> 时间：2012-07-14T19:35:48.450
> 
> 标签：iphone, objective-c, ios

我正在将图像加载到表格视图单元格中，每个单元格都有一个图像。我已经为下面的代码改编了几个教程，但我的速度仍然很慢。

我正在从文档目录加载这些图像。有关如何加快此过程的任何提示或想法？

编辑修改后的代码：

```
Beer *beer = (Beer *) [self.fetchedResultsController objectAtIndexPath:indexPath];
cell.displayBeerName.text = beer.name;

// did we already cache a copy of the image?
if (beer.image != nil) {
    // good.  use it.  this will run quick and this will run most of the time
    cell.beerImage.image = beer.image;
} else {
    // it must be the first time we've scrolled by this beer.  do the expensive
    // image init off the main thread

    cell.beerImage.image  = nil;   // set a default value here.  nil is good enough for now

    [self loadImageForBeer:beer atIndexPath:indexPath];
}
- (void)loadImageForBeer:(Beer *)beer atIndexPath:(NSIndexPath *)indexPath {

    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
    dispatch_async(queue, ^{

        UIImage *image = [UIImage imageWithContentsOfFile:beer.imagePath];
        beer.image = image;

        dispatch_sync(dispatch_get_main_queue(), ^{
            UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
            cell.beerImage.image = image;
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-16T06:14:02.203

你的算法看起来不错。您已经避免了许多典型的陷阱。如果您仍然遇到 UI 性能问题，我建议您做一些事情：

1.  您应该尝试将图像缓存在内存中。您可以使用`NSMutableArray`or `NSMutableDictionary`，但在[ios 应用程序上缓存图像的最佳方式是？](https://stackoverflow.com/questions/11511548/best-way-to-cache-images-on-ios-app/11511798#11511798)Caleb 讨论了该`NSCache`课程的优点，从而简化了流程。如果您缓存图像，请确保响应内存压力并在必要时清除缓存。您可以回复`didReceiveMemoryWarning`或将自己添加为通知中心的观察者`UIApplicationDidReceiveMemoryWarningNotification`。

2.  确保您的缓存图像是缩略图大小，否则您的 UI 中总会出现一点点卡顿（如果您需要调整大小算法，请告诉我们），这会不必要地占用内存；

3.  当您将图像更新发送回主队列时，您应该异步执行此操作（为什么该后台队列在等待将块发送回主队列完成时会挂起并占用资源......这个一旦您在快速滚动期间备份了几张图像，这尤其是一个问题）；和

4.  当您分派回主队列时，您应该检查以确保您从中获取的单元格`cellForRowAtIndexPath`不是`nil`（因为如果单元格加载逻辑得到太多备份（尤其是在较慢的设备上），理论上您可以让有问题的单元格滚动关闭屏幕和您的算法可能会崩溃）。

我使用的算法与您的算法非常相似，具有几乎相同的 GCD 结构（带有上述注意事项）并且滚动非常流畅，即使在旧设备上也是如此。如果您希望我发布代码，我很乐意。

如果您仍然遇到问题，CPU 分析器非常适合识别瓶颈并让您知道应该将注意力集中在哪里。网上有一些很棒的 WWDC 会议，它们专注于如何使用 Instruments 来识别性能瓶颈，我发现它们对于熟练使用 Instruments 非常有帮助。

这是我的代码。在`viewDidLoad`中，我初始化我的图像缓存：

```
- (void)initializeCache
{
    self.imageCache = [[NSCache alloc] init];
    self.imageCache.name = @"Custom Image Cache";
    self.imageCache.countLimit = 50;
} 
```

然后我在我的`tableView:cellForRowAtIndexPath`：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"ilvcCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // set the various cell properties

    // now update the cell image

    NSString *imagename = [self imageFilename:indexPath]; // the name of the image being retrieved

    UIImage *image = [self.imageCache objectForKey:imagename];

    if (image)
    {
        // if we have an cachedImage sitting in memory already, then use it

        cell.imageView.image = image;
    }
    else
    {
        cell.imageView.image = [UIView imageNamed:@"blank_image.png"];

        // the get the image in the background

        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

            // get the UIImage

            UIImage *image = [self getImage:imagename];

            // if we found it, then update UI

            if (image)
            {
                dispatch_async(dispatch_get_main_queue(), ^{

                    // if the cell is visible, then set the image

                    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
                    if (cell)
                        cell.imageView.image = image;

                    [self.imageCache setObject:image forKey:imagename];
                });
            }
        });
    }

    return cell;
} 
```

和

```
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];

    [self.imageCache removeAllObjects];
} 
```

顺便说一句，您可能考虑的进一步优化是将缓存的图像预加载到单独的队列中，而不是在单独的线程中即时加载图像。我认为没有必要，因为这对我来说似乎已经足够快了，但它是加快 UI 速度的另一种选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T20:57:08.223

缺少的步骤是使用获取的图像更新模型。实际上，您每次都在为每个单元进行新的加载。该模型是缓存相对昂贵的负载结果的正确位置。你可以添加一个 Beer.image 属性吗？

然后，您的配置代码将如下所示：

```
Beer *beer = (Beer *) [self.fetchedResultsController objectAtIndexPath:indexPath];
cell.displayBeerName.text = beer.name;

// did we already cache a copy of the image?
if (beer.image != nil) {
    // good.  use it.  this will run quick and this will run most of the time
    cell.beerImage.image = beer.image;
} else {
    // it must be the first time we've scrolled by this beer.  do the expensive
    // image init off the main thread

    cell.beerImage.image  = nil;   // set a default value here.  nil is good enough for now

    [self loadImageForBeer:beer atIndexPath:indexPath];
} 
```

为清楚起见，将加载程序逻辑移至此处...

```
- (void)loadImageForBeer:(Beer *)beer atIndexPath:(NSIndexPath *)indexPath {

    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);
    dispatch_async(queue, ^{

        UIImage *image = [UIImage imageWithContentsOfFile:beer.imagePath];
        beer.image = image;

        dispatch_sync(dispatch_get_main_queue(), ^{
            UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
            cell.beerImage.image = image;
        });
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-15T03:36:26.853

对于初始负载，您在这里可以做的不多，您的速度差不多。如果它仍然太慢，请尝试加载较小的图像，如果可以的话。

有几件事：

首先，小心使用 -imageWithContentsOfFile，它不会缓存任何内容。每次加载图像时都会受到全部打击，而不是 -imageNamed 会在某些缓存中保持图像温暖。您当然可以将其缓存在您的域对象中，但我个人强烈建议不要这样做。你的内存占用会飞涨，迫使你实现自己的缓存过期机制，而苹果通过 -imageNamed 有一个非常好的图像缓存。如果你能在所有 3 个系列的设备上做得比苹果更好，我会感到惊讶 :)

然后，您在这里打破了 UITableView 的享元模式：

```
dispatch_sync(dispatch_get_main_queue(), ^{
            cell.beerImage.image = image;
            beer.image = image;
            [cell setNeedsLayout];
        }); 
```

要求表格视图在给定索引处提供单元格，而不是捕获块中的单元格：在加载图像时，该单元格实例实际上可能已被重用于另一个索引路径，并且您将显示图像在错误的单元格中。

而且这里不需要 -setNeedsLayout ，只需要改变图像就足够了。

编辑：哎呀！我错过了表格视图中图像的明显之处。你的图片有多大，图片视图有多大，图片上的内容模式是什么？如果您的图像与图像视图的大小非常不同，并且您要求图像视图调整大小，这将发生在主线程上，并且您将在那里受到*巨大的*性能影响。加载后，将图像大小调整为关闭线程的图像视图（快速谷歌搜索将为您提供执行此操作的核心图形代码）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-14T19:45:26.973

你可以看看这个问题，以前在堆栈溢出时回答过。

[uitableViewcell 中的 UIImage 减慢滚动表](https://stackoverflow.com/questions/6408434/uiimage-in-uitableviewcell-slowdowns-scrolling-table?rq=1)

或者试试这个代码

```
- (void)configureCell:(BeerCell *)cell 
          atIndexPath:(NSIndexPath *)indexPath 
{
    Beer *beer = (Beer *) [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.displayBeerName.text = beer.name;

           UIImage *image = [UIImage imageWithContentsOfFile:beer.imagePath];

            cell.beerImage.image = image;
            [cell setNeedsLayout];
        } 
```

# javascript - 11天后

> ID：11486830
> 
> 赞同：0
> 
> 时间：2012-07-14T19:36:08.817
> 
> 标签：javascript, date

我知道关于这个主题有一些类似的帖子，但没有一个对我有太大帮助（或者这可能是因为我还是个新手）。

无论如何，我正在寻找的东西是一个脚本来显示我的日期和从现在开始的 11 天。

下面的脚本是我用来显示当前日期和日期的脚本。所以我认为必须在某处添加或修改一些简单的行？像“+11”

任何有用的答案将非常非常非常感谢！

* * *

```
var daynames = new Array( "Sunday", "Monday", "Tuesday", "Wednesday","Thursday", "Friday", "Saturday");

var months = new Array( "january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december");

var currentTime = new Date();

var dayname = currentTime.getDay();

var month = currentTime.getMonth();

var day = currentTime.getDate();

var year = currentTime.getFullYear();

document.write(daynames[dayname] + "<BR> " + day  + " " + months[month]  + " " + year); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T19:42:30.613

假设您正在使用 JavaScript，此代码段会将 d 设置为从当天起 +11 天 -

```
var d = new Date();
d.setDate(d.getDate()+11); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:44:22.253

假设 javascript 因为`document.write`

```
var yourDate=new Date();
yourDate.setDate(yourDate.getDate()+11); //11 is the number of days you want to add 
```

参考：[getDate](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getDate)和[setDate](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/setDate)

# mysql - 使用索引优化此查询的最佳方法是什么？

> ID：11486832
> 
> 赞同：1
> 
> 时间：2012-07-14T19:36:13.363
> 
> 标签：mysql, select, indexing, key, explain

我有一个包含大约 3000 万条记录的表，我需要对其执行查询。根据我的阅读，我认为使用最左边的前缀和我需要选择的所有字段的复合索引是正确的方法，但是当我对查询运行解释时，它甚至没有使用索引。

这是查询：

```
select distinct email FROM my_table 
WHERE `customer_id` IN(278,428,186,40,208,247,59,79,376,73,38,52,68,227) 
AND `company_id` = 4 
AND `active` = 1 
AND `date` > '2012-04-15'; 
```

解释看起来像这样

```
+----+-------------+--------+-------+---------------+-------+---------+------+----------+-------------+
| id | select_type | table  | type  | possible_keys | key   | key_len | ref  | rows     | Extra       |
+----+-------------+--------+-------+---------------+-------+---------+------+----------+-------------+
|  1 | SIMPLE      | emails | index | customer_id   | email | 772     | NULL | 29296705 | Using where |
+----+-------------+--------+-------+---------------+-------+---------+------+----------+-------------+ 
```

这些是字段

```
`id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`email` varchar(255) NOT NULL DEFAULT '',
`customer_id` int(10) unsigned DEFAULT NULL, 
`company_id` int(10) unsigned NOT NULL,
`active` tinyint(1) unsigned NOT NULL DEFAULT '1',                                                                                                                                            
`date` date DEFAULT NULL 
```

索引看起来像这样

```
PRIMARY KEY (`id`),                                                                                                                                                                                                                        
UNIQUE KEY `email` (`email`,`customer_id`),                                                                                                                                                                                                
KEY `customer_id` (`customer_id`,`company_id`,`active`,`date`) 
```

我不太确定优化它的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:54:35.533

`IN`MySQL 经常在索引的左侧挑剔。为每个尝试一个查询`customer_id`，看看它是否正在使用您的索引。您可以使用[`UNION`](http://dev.mysql.com/doc/refman/5.0/en/union.html)语法将它们连接在一起 另一种可能性是 MySQL 认为筛选 10% 的行的所有内容比尝试为它们使用索引更快。

# java - ice4j 有什么好的教程吗？

> ID：11486843
> 
> 赞同：5
> 
> 时间：2012-07-14T19:37:28.263
> 
> 标签：java, networking

我刚刚开始使用 ice4j 作为 ICE 客户端。我正在试验它，我想用它创建一个简单的聊天应用程序。问题是，我似乎找不到任何关于如何使用ice4j 的好的教程，而且我从源代码编译的Javadoc 似乎也没有帮助。我不想求助于必须通读所有源代码，因为那会很烦人。有什么可以帮助我学习ice4j的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T21:32:30.840

尝试阅读[测试](http://code.google.com/p/ice4j/source/browse/trunk/test/org/ice4j/)，通常它是最好的文档，尤其是当技术没有什么像样的时候

# javascript - Firefox Javascript 停止错误

> ID：11486851
> 
> 赞同：-1
> 
> 时间：2012-07-14T19:38:52.193
> 
> 标签：javascript, firefox

当我运行 Firefox 并打开任何网站时，一段时间后，我得到了`JavaScript Stop and continue error`，页面被挂断了。任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:58:35.753

如果您确实在每个页面上都有问题，那么问题很可能是由您损坏的 Firefox 配置文件或您安装的一些编写不当的插件/插件引起的。重置您的个人资料或禁用/卸载插件和插件，看看它是否有帮助。

# php - 从服务器编码的 JSON 数据出现问题，无法绘制图表

> ID：11486856
> 
> 赞同：1
> 
> 时间：2012-07-14T19:39:34.580
> 
> 标签：php, javascript, jquery, json, highcharts

我从服务器获取正确的 JSON 对象数组并将其分配给系列。chart_cfd.series 还在调试器中显示正确的对象，但图表绘制没有发生。

这里可能是什么问题？我需要更改数组成员的类型吗？

注意：如果我在 javascript 中本地提供系列数据，图表会完美填充（简单列类型）

Javascript：（我正在使用 highcharts 框架）

//series = [] 在图表对象中

```
function requestCFDStatusData(){

  $.post(
     'ajax/cfdUtil/cfd_status.php',

 function(response){
                       chart_cfd.series = response;
                       });
} 
```

PHP 代码

```
<?php
header("Content-type: text/json");
$cfdData = array(
    array(
'name' => 'A',
'data' => array(49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4,22,34,23,11)),
    array(
'name' => 'B',
'data' => array(83.6, 78.8, 98.5, 93.4, 106.0, 84.5, 105.0, 104.3, 91.2, 83.5, 106.6, 92.3,22,50,34,11)),
    array(
'name' => 'C',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,100,25,45,42)),
    array(
'name' => 'D',
'data' => array(42.4, 33.2, 34.5, 39.7, 52.6, 75.5, 57.4, 60.4, 47.6, 39.1, 46.8, 51.1,32,33,46,54)),
    array(
'name' => 'E',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'F',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'G',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'H',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'I',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'J',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50)),
    array(
'name' => 'K',
'data' => array(48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50))

);

$jsonEncoded = json_encode($cfdData);

echo $jsonEncoded;
?> 
```

注意：如果我在 javascript 中本地提供，以下数据可以正常工作

```
series: [{
            name: 'A',
   data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4,22,34,23,11]

        }, {
            name: 'B',
   data: [83.6, 78.8, 98.5, 93.4, 106.0, 84.5, 105.0, 104.3, 91.2, 83.5, 106.6, 92.3,22,50,34,11]

        }, {
            name: 'C',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,100,25,45,42]

        }, {
            name: 'D',
   data: [42.4, 33.2, 34.5, 39.7, 52.6, 75.5, 57.4, 60.4, 47.6, 39.1, 46.8, 51.1,32,33,46,54]

        },{
            name: 'E',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'F',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'G',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'H',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'I',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'J',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        },{
            name: 'K',
   data: [48.9, 38.8, 39.3, 41.4, 47.0, 48.3, 59.0, 59.6, 52.4, 65.2, 59.3, 51.2,12,12,44,50]

        }] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T20:08:30.907

在标头中使用内容类型作为 javascript

```
 header("Content-type: text/javascript"); 
```

然后使用 jquery 的 getJSON 方法作为

```
 $.getJSON('ajax/cfdUtil/cfd_status.php',function(response){
          chart_cfd.series = response;
                   }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T20:03:14.593

可能是你应该`application/json`在你的`php`文件中使用，或者你可以使用`text/plain`然后你可以使用`$.parseJSON`

```
function requestCFDStatusData(){
    $.post('ajax/cfdUtil/cfd_status.php', function(response){
        chart_cfd.series = $.parseJSON(response);
    });
} 
```

[**这可能对您有所帮助**](https://stackoverflow.com/questions/267546/correct-http-header-for-json-file)。

# titanium - 在滚动视图中特定滚动后停止滚动 - Titanium

> ID：11486857
> 
> 赞同：0
> 
> 时间：2012-07-14T19:39:40.290
> 
> 标签：titanium, scrollview

我只是在开发一个 Titanium 应用程序。我想在滚动后禁用滚动视图的滚动。换句话说，我希望滚动停止在屏幕的某个位置。假设我希望下面的 scrollView 在滚动 200px 的高度后停止滚动。我怎样才能做到这一点？

```
var containerScroll = Ti.UI.createScrollView({
    backgroundColor : 'transparent',
    opacity : 0.0,  
    showVerticalScrollIndicator : true,
    showHorizontalScrollIndicator : false,
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:53:08.977

你试试

```
scrollview.contentOffset="200"; 
```

这对我有用...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T14:48:57.403

看来这将是您的答案，但它是特定于 iOS 的。设置“scrollingEnabled：false”属性。我无法为您找到 Android 版本。

```
var scrollableView = Ti.UI.createScrollableView({
  views:[new generateVerifyView(),new generateUserView(),new generateAddrView()],
  showPagingControl : false,
  scrollingEnabled : false
}); 
```

[http://developer.appcelerator.com/question/122741/disable-scrolling-in-a-scrollableview](http://developer.appcelerator.com/question/122741/disable-scrolling-in-a-scrollableview)

# javascript - 用于 javascript 文本输入的简单 -+ 按钮

> ID：11486864
> 
> 赞同：1
> 
> 时间：2012-07-14T19:40:30.610
> 
> 标签：javascript, add, increment

我已经成功使用了这个脚本，但是我已经尝试过并且失败了，以使其在减去传递 0 时停止产生负数..

```
<script language="javascript" type="text/javascript">
currentvalue = 1;
function setUp() {
document.getElementById("qty").value = currentvalue;
}
function addOne() {
currentvalue++;
document.getElementById("qty").value = currentvalue;
}
function subtractOne() {
currentvalue--;
document.getElementById("qty").value = currentvalue;
}
</script>

<input type="text" name="qty" id="qty" maxlength="12" value="1" title="qyu" class="input-text qty" />
<div onload="setUp()">
<input class="qtyplus" type="button" value="" onClick="addOne()">
<input class="qtyminus" type="button" value="" onClick="subtractOne()">
</div> 
```

任何人都得到了表演在 0 处停止的神奇部分吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:45:01.177

只需在此处添加一个 if 语句[即可](http://jsfiddle.net/Gq4fd/)

这是你的减法函数

```
function subtractOne() {
    if(document.getElementById("qty").value !== '0') {
currentvalue--;
document.getElementById("qty").value = currentvalue;
    } 
```

# css - 什么是 CSS 中非常低效的规则

> ID：11486866
> 
> 赞同：5
> 
> 时间：2012-07-14T19:41:05.763
> 
> 标签：css

我在 Google 上进行了速度测试，我的 CSS 成绩有好有坏。糟糕的成绩是由于低效的 CSS。那是什么？我该如何纠正它？

```
Very inefficient rules (good to fix on any page):
#menu ul ul li:first-child a:after    Tag key with 4 descendant selectors
#menu ul ul li:first-child a:hover:after    Tag key with 4 descendant selectors 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-14T20:00:28.247

浏览器从右到左解析 CSS 选择器。因此，如果您的后代选择器较少，CSS 的解析速度会更快。

> 后代选择器效率低下，因为对于每个匹配键的元素，浏览器还必须遍历 DOM 树，评估每个祖先元素，直到找到匹配项或到达根元素。密钥越不具体，需要评估的节点数量就越多。

[使用高效的 CSS 选择器](https://developers.google.com/speed/docs/best-practices/rendering#UseEfficientCSSSelectors)

* * *

有关的：

[优化 css vs Google 页面速度让我很困惑](https://stackoverflow.com/questions/2612555/optimize-css-vs-google-page-speed-is-messing-with-me)

[为什么浏览器从右到左匹配 CSS 选择器？](https://stackoverflow.com/questions/5797014/css-selectors-parsed-right-to-left-why)

# c++ - SPOJ 的错误答案

> ID：11486868
> 
> 赞同：1
> 
> 时间：2012-07-14T19:41:14.690
> 
> 标签：c++, dynamic-programming

我在[SPOJ](http://www.spoj.pl/problems/ELIS/)上尝试了一个问题，我们必须简单地找到给定数组 A的[最长递增子序列的长度。](http://en.wikipedia.org/wiki/Longest_increasing_subsequence)

我已经使用动态编程 O(n^2) 算法解决了这个问题，并且该解决方案被接受了。这是被接受的代码：

```
void LIS(int *A,int A_Length)
{
    int Seq[MAX];
    for(int i=0;i<A_Length;++i)
    {
        int maxima=0;
        for(int j=0;j<i;++j)
        {
            if(A[i]>A[j])
            {
                maxima=max(Seq[j],maxima);
            }
        }
        Seq[i]=maxima+1;
        //cout<<Seq[i]<<endl;
    }
    cout<<*max_element(Seq,Seq+A_Length)<<endl;
} 
```

但是当我尝试使用第二种方法（[LINK](http://www.algorithmist.com/index.php/Longest_Increasing_Subsequence)）解决它时，它是::

```
A simple way of finding the longest increasing subsequence is
 to use the Longest Common Subsequence (Dynamic Programming) algorithm.
[1]Make a sorted copy of the sequence A, denoted as B. O(nlog(n)) time.
[2]Use Longest Common Subsequence on with A and B. O(n2) time. 
```

，我得到了错误的答案。

这是我的 C++ 代码

```
//Global Variable
int A[100],B[100];
int DP[100][100];

//This function Finds the Longest common subsequce of Array A[1,2,3...,N] and B[1,2,3...,N]
void LIS(int N)
{

    sort((B+1),(B+1)+N);//STL SORT sort from index 1 to N of Array B.
    int i,j;

    //Base Cases
    for(i=0;i<=N;++i)
        DP[i][0]=0;

    for(j=0;j<=N;++j)
        DP[0][j]=0;

    for(i=1;i<=N;++i)
    {
        for(j=1;j<=N;++j)
        {
            if(A[i]==B[j])
                DP[i][j]=DP[i-1][j-1]+1;
            else
                DP[i][j]=max(DP[i-1][j],DP[i][j-1]);
        }
    }
    printf("%d\n",DP[N][N]);
}
int main()
{
    int N,i;
    scanf("%d",&N);
    for(i=1;i<=N;++i)
    {
        scanf("%d",&A[i]);
        B[i]=A[i];
    }
    LIS(N);

    return 0;
} 
```

我不知道为什么我得到错误的答案。你能帮我找到错误吗？[或者站点](http://www.algorithmist.com/index.php/Longest_Increasing_Subsequence)中给出的 LIS by LCS Algorithm不正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T13:51:40.633

第二种方法是正确的，但不能直接应用于这个问题。那是因为在这个SPOJ问题中不保证序列中的数字是唯一的，目标是找到一个**严格的递增**子序列，而Your Second Method的输出在这里**是非递减**子序列。演示一个简单的测试用例`[1,2,2,3]`将帮助您找到不同之处。

这个解决方案也很简单：只需在排序后删除重复的元素。

# jquery - 如何在下划线/主干 .each 迭代之间等待/暂停？

> ID：11486870
> 
> 赞同：3
> 
> 时间：2012-07-14T19:41:38.743
> 
> 标签：jquery, backbone.js, underscore.js

在我的 Backbone 视图中，我想遍历一个集合，并为每个项目呈现一个新的子视图，但两者之间有一个小的延迟（大约 200 毫秒）。在示例中，Flock 是一个名为 Sheep 的 Backbone 模型的集合：）

```
render: function () {
  Flock.each(this.renderSheep)
},

renderSheep: function (mySheepModel) {
   var sheep = new SheepView({model:mySheepModel})
   $(sheep.render().el).appendTo('#field').fadeIn();
} 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T20:12:24.480

这应该有效：

```
render: function () {
    var i = 0,
        _self = this;

    (function renderSheepWithDelay(delay) {
        if (i <= Flock.length) {
        _self.renderSheep(Flock.at(i));
            i += 1;
        setTimeout(renderSheepWithDelay, delay);
        }
    })(200);
}, 
```

基本上，您使用递归函数在您传入的给定延迟后调用自身。该函数正在迭代集合中的模型，并且在集合用完时将停止递归调用自身。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-14T19:50:19.477

像这样将它包装在 setTimeout 函数中

```
renderSheep: function (mySheepModel) {
   setTimeout(function () {
   var sheep = new SheepView({model:mySheepModel})
   $(sheep.render().el).appendTo('#field').fadeIn();
 }, 3000);
} 
```

这将调用 3 秒超时。

# ssl - 密码短语存储在 PEM (SSL) 文件的什么位置？如果你在文本编辑器中打开一个 .pem 文件，你能窃取密码吗？

> ID：11486871
> 
> 赞同：0
> 
> 时间：2012-07-14T19:41:40.610
> 
> 标签：ssl, certificate, pem

我试图了解 .pem 文件的布局方式。密码是如何验证的？.pem 文件如何检查您尝试打开它的密码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T01:57:06.193

多种不同类型的数据存储在扩展名为 .pem 的文件中。所以你的问题不准确。但是假设它是一个受密码保护的私钥文件。为什么您认为密码存储在其中的任何位置？实际上它并没有存储在文件中。密码用于生成对称密钥，用于解密文件并检查解密文件的一致性。

# iphone - 声音不会在我的应用程序中播放

> ID：11486873
> 
> 赞同：0
> 
> 时间：2012-07-14T19:42:06.137
> 
> 标签：iphone, xcode, audio

我已经开始使用一个应用程序，我需要一个音频剪辑在您启动应用程序后立即播放。这是我的视图 controller.m 文件：

```
//
//  ViewController.m
//  audio test
//
//  Created by Kevin Patrick on 14/07/2012.
//  Copyright (c) 2012 Team Tops. All rights reserved.
//

#import "ViewController.h"
#import <AVFoundation/AVFoundation.h>

@interface ViewController ()

@end

@implementation ViewController

-(void)awakeFromNib {

NSString *path = [[NSBundle mainBundle]
                  pathForResource:@"CPOP MUSIC"ofType:@"mp3"];
AVAudioPlayer* theAudio = [[AVAudioPlayer alloc]
                           initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
[theAudio play];
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
}

@end 
```

但是当我模拟应用程序不播放任何声音时，它是空白的，什么也不做。我在支持文件夹中有音频文件，我看到一些关于最新 Xcode 有问题但文件仍然无法播放，我是初学者所以请放轻松，谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:48:56.953

尝试这个：

[http://mobileorchard.com/easy-audio-playback-with-avaudioplayer/](http://mobileorchard.com/easy-audio-playback-with-avaudioplayer/)

# android - 为什么图像没有从 android 应用程序的 url 加载？

> ID：11486874
> 
> 赞同：0
> 
> 时间：2012-07-14T19:42:05.793
> 
> 标签：android, image, web-services

我创建了一个从给定 url 加载图像的 android 应用程序。当我直接传递 url 时，图像正在加载。但是，当我在字符串变量中获取 url 并传递该变量时，图像没有加载。我的代码如下。

```
private Drawable ImageOperations(String url, String saveFilename) {
        try {
            String realImageUrl=url+"?  email="+Constants.email+"&proc_date="+Constants.proc_date+"&access_key="
            +Constants.ACCESS_KEY+"&version=1.00";

            String newUrl=realImageUrl.replace("https", "http");

            InputStream is = (InputStream) this.fetch(newUrl);

            Log.e("https,SubString http: ",realImageUrl+","+ a);
            Drawable d = Drawable.createFromStream(is, "src");

            return d;
        } catch (MalformedURLException e) {
            return null;
        } catch (IOException e) {
            return null;
        }
    }

    public Object fetch(String address) throws MalformedURLException,
            IOException {
        URL url = new URL(address);
        Object content = url.getContent();
        return content;
    } 
```

此代码不起作用。我的新网址是 newUrl。当我在日志中打印 newUrl 并直接提供该 url 而不是 newUrl 时，图像正在加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T17:37:52.120

我找到了解决方案。我已经更新了 fetch(String address) 方法。

```
public Object fetch(String address) throws MalformedURLException,
            IOException {
        try{
        URL url = new URL(address);
        URI uri = new URI(url.getProtocol(), url.getUserInfo(), url.getHost(), url.getPort(), url.getPath(), url.getQuery(), url.getRef());
        url = uri.toURL();
        Log.i("Url:", url+"");
        Object content = url.getContent();
        return content;
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
        return null;
    } 
```

# c# - 来自 WCF 服务的响应对象

> ID：11486884
> 
> 赞同：1
> 
> 时间：2012-07-14T19:44:36.763
> 
> 标签：c#, java, android, wcf

我有一个看起来像这样的 WCF 服务

```
 [OperationContract]
 [WebGet(ResponseFormat = WebMessageFormat.Xml)]
 CompositeType GetCompositeTypeForUser(int userid); 
```

...使用看起来像这样的 CompositeType 对象：

```
 [DataContract]
    public class CompositeType
    {
        bool boolValue = true;
        string stringValue = "Hello ";

        [DataMember]
        public List<string> stuffAroundMe = new List<string>();

        [DataMember]
        public bool BoolValue
        {
            get { return boolValue; }
            set { boolValue = value; }
        }

        [DataMember]
        public string StringValue
        {
            get { return stringValue; }
            set { stringValue = value; }
        }
    } 
```

每当我调用我的服务时，我都会返回一组描述特定 CompositeType 的 XML 数据。有没有办法让客户端返回一个 CompositeType 对象，而不必解析一堆 XML 并手动创建一个新的 CompositeType 对象？

此外，我的代码既存在于 Visual Studio 上的 C# 中，也存在于 Android 应用程序上的 Java 中（实际调用 Web 服务的代码）。当我可以控制从双方传递的对象时，有没有办法避免解析大量 xml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:51:45.713

使用 Web 服务客户端库而不是手动调用服务。对于 .NET，svcutil 工具将用于创建所需的客户端代码。看起来类似的东西可用于 java：[Java 中存在哪些与 .NET 的 svcutil.exe 等效的工具？](https://stackoverflow.com/questions/2020883/what-tools-exist-in-java-that-are-equivalent-to-svcutil-exe-for-net)

# java - 使用反射使用任何构造函数实例化任何类的 Java 通用方法

> ID：11486886
> 
> 赞同：1
> 
> 时间：2012-07-14T19:44:43.423
> 
> 标签：java, oop, generics, reflection

我们知道 Java 使用擦除，所以任何 Generic 类都做不到

```
T t = new T(); 
```

所以我尝试使用 Java 反射来创建一个带有静态方法的类，用任何构造函数实例化任何类。这是代码。

```
import java.lang.reflect.*;

public class GenericNewInstance {
    public static <T> T createInstance(Class<T> cObj) {
        try {
            return cObj.newInstance();
        } catch (InstantiationException e) {
            System.out.println("Instantiation Exception");
            return null;
        } catch (IllegalAccessException e) {
            System.out.println("Illegal Access Exception");
            return null;
        }
    }

    public static <T> T createInstanceUsingRelection(Class<T> c, Object... initArgs) {
        Constructor<T> cTor = null;
        Class<?>[] cObjs = new Class<?>[initArgs.length];
        int i = 0;

        for(Object o : initArgs) {
            cObjs[i++] = o.getClass();
        }

        try {
            cTor = c.getConstructor(cObjs);
        } catch (SecurityException e) {
            System.out.println("security exception. Cannot get Constructor");
            return null;
        } catch (NoSuchMethodException e) {
            System.out.println("NoSuchMethodException Cannot get constructor");
            return null;
        }

        try {
            return cTor.newInstance(initArgs);
        } catch (IllegalArgumentException e) {
            System.out.println("Illegal Argument Exception");
            return null;
        } catch (InstantiationException e) {
            System.out.println("Instantiation Exception");
            return null;
        } catch (IllegalAccessException e) {
            System.out.println("Illegal Access Exception");
            return null;
        } catch (InvocationTargetException e) {
            System.out.println("Invocation Target Exception");
            return null;
        }
    }
} 
```

使用此示例。

```
Integer i = GenericNewInstance.createInstanceUsingRelection(Integer.class, "0"); 
```

所以我的问题：

1.  这是实施它的正确方法吗？（或者它很冗长？）
2.  这样做的典型用例是什么？
3.  我们可以/应该在使用泛型时避免使用反射吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T19:57:09.960

您的代码将失败，`c.getConstructor(cObjs)`因为这没有考虑类型层次结构。如果任何参数是构造函数声明的参数类型的子类型，则此调用将不会返回它。您将需要更多的类型杂耍才能使其正常工作。我建议你看看[已经解决了这个问题的代码](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Reflector.java#L150)。也许您甚至可以选择按原样使用该库。它是 Clojure 的实现代码，一种基于 JVM 的动态语言，正是需要这些东西。该库可从 Maven 中央存储库获得。

顺便说一句，您的异常处理是多余的。要么只是声明`throws Exception`或捕获任何`Exception`并将其包装在`RuntimeException`. 当某事失败时，原始异常是最好的诊断。

# xml - XSLT 如果嵌套节点属性值小于 800

> ID：11486891
> 
> 赞同：0
> 
> 时间：2012-07-14T19:45:29.030
> 
> 标签：xml, xslt

鉴于此 XML

```
 <ContentBlock>
    <Content>
        <QuickStatus Balance="0" Credits="0" Trolley="600" Delivery="100" Available="-700" Pending="0" />
        <TrolleyItems>
            <TrolleyItem Description="Test Item 1" value="150" />
            <TrolleyItem Description="Test Item 2" value="150" />
            <TrolleyItem Description="Test Item 3" value="300" />
        </TrolleyItems>
    </Content>
</ContentBlock> 
```

我需要检查每个手推车项目的值属性是否低于 800，然后如果至少有一个项目低于 800，则显示最终交付属性。但只需要显示一次交付值。

我的 XSLT .xsl 文件代码如下所示。

```
<xsl:for-each select="Content/TrolleyItems/TrolleyItem">
    <xsl:if test="ContentBlock/Content/TrolleyItems/TrolleyItem/@value &lt; 800">
        <tr style="border-bottom: 1px dashed #000;">
            <xsl:for-each select="Content/Final">
            <td>Delivery Fee</td><td><xsl:value-of select="@Delivery"/></td>
            </xsl:for-each>
        </tr>
        </xsl:if>
        </xsl:for-each> 
```

我需要的是为@Delivery 属性输出一项。

它只会显示一次，例如答案是：“Delivery Costs: 100”。所以只在物品价值低于800时才收取运费

![在此处输入图像描述][1]

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:54:06.703

内部`xsl:if`不`xsl:for-each`应该有完整的路径。

中的所有节点`xsl:for-each`都相对于 中的 xpath `select`，并且因为您使用的是相对路径（它们不以`/`or开头`//`），所以您正在寻找

```
Content/TrolleyItems/TrolleyItem/ContentBlock/Content/TrolleyItems/TrolleyItem 
```

我认为你正在寻找的是这样的东西......

```
<xsl:for-each select="Content/TrolleyItems/TrolleyItem[@value">
  <xsl:if test="./@value &lt; 800">
    <tr style="border-bottom: 1px dashed #000;">
      <xsl:for-each select="/Content/Final">
        <td>Delivery Fee</td><td><xsl:value-of select="@Delivery"/></td>
      </xsl:for-each>
    </tr>
  </xsl:if>
</xsl:for-each> 
```

请参阅[此 xmlplayground](http://www.xmlplayground.com/1ZvILh)进行现场演示

**更新**

更有效率...

```
<xsl:for-each select="Content/TrolleyItems/TrolleyItem[@value &lt; 800]">
  <tr style="border-bottom: 1px dashed #000;">
    <xsl:for-each select="/Content/Final">
      <td>Delivery Fee</td><td><xsl:value-of select="@Delivery"/></td>
    </xsl:for-each>
  </tr>
</xsl:for-each> 
```

**更新**

根据 OP 的评论，可能更像这样（请记住，我假设您的实际 XML 将比您当前显示的要复杂得多，因此这可能不是您正在寻找的内容）。 ..

```
<xsl:if test="Content/TrolleyItems/TrolleyItem/@value &lt; 800">
  <tr style="border-bottom: 1px dashed #000;">
    <td>Delivery Fee</td><td><xsl:value-of select="/Content/Final/@Delivery"/></td>
  </tr>
</xsl:if> 
```

# security - Grails - 默认的安全编码

> ID：11486894
> 
> 赞同：1
> 
> 时间：2012-07-14T19:46:02.097
> 
> 标签：security, grails, groovy, xss, sql-injection

我将数据提交给 Grails 中的控制器并进行了有效的 javascript 注入。我很惊讶，因为我认为默认设置是在参数进入控制器时对其进行编码。我可以轻松设置它，以便所有参数在到达控制器时都被编码吗？另外，当文本出现时，我是否可以安全地对其进行 GORM `create`，或者这是否容易受到 SQL 注入的影响？我[在指南中](http://grails.org/doc/latest/guide/security.html)看到了如何防止`find`查询的 SQL 注入，但是对象创建呢？

我还看到有一种`encodeAsHTML`方法可以在返回客户端的途中调用以进行编码。我不想在它进入数据库之前这样做，这样我只需要编码一次吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-15T07:18:11.373

### 用户输入

“清理您的输入”（或预编码或预转义）您的内容的想法是一个糟糕的想法。当您真正需要它时，它实际上并不能保护您，并导致各种设计难题。甚至 PHP 也最终放弃了这项技术。

最好通过适当的 API 正确处理数据，从而消除风险。例如，使用准备好的语句或带有内容占位符的语句*绝对可以消除 SQL 注入。*这种技术已经存在了很长时间（只要我使用 Java 和 SQL）。

Grails (GORM) 自动处理通过对象保存的任何内容的编码，包括设置单个属性、创建新对象并保存它，或通过`obj.properties = params`或类似的方式设置属性。

只要你使用的是 GORM，就没有 SQL 注入的风险。

### 内容存储

此外，将已经编码的信息存储在数据库中通常被认为是不正确的，因为该编码仅对给定的显示类型（例如 HTML）是正确的。如果您想使用 JSON 来呈现它，则 HTML 编码不正确。XML 也略有不同，有时您也可能更喜欢纯文本。

相反，您通常应该将原始（UTF8 或类似）数据存储在数据库中，并在呈现以供显示时将其转换为正确的显示类型。请注意，它*在渲染时会被*转换——这并不一定意味着每次将其发送给客户端。您可以使用各种缓存技术来确保不会经常发生这种情况——包括[添加到 Grails 2.1 中的新缓存插件](http://grails.org/plugin/cache)。

### 防止[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)

然而，一种强烈推荐的技术是使用[`grails.views.default.codec`选项](http://grails.org/doc/latest/guide/conf.html#builtInOptions)将默认视图编解码器设置为 HTML，如下所示：

```
grails.views.default.codec = 'html' 
```

这只会影响 GSP，并且只会影响使用美元符号语法 ( `${foo}`) 回显的内容。`<%= %>`这使您可以灵活地使用标记（推荐的方式）或一次性情况的语法来覆盖此行为。但是，它应该提供一个不错的捕获来防止一般的 XSS 攻击。

### 性能注意事项

最后一点：将内容编码为 HTML 是性能问题的担忧将被视为*过早优化*。任何性能瓶颈出现在其他地方的可能性**非常高，而不是在内容的编码中。**首先构建您的应用程序 - 使用一个好的设计 - 然后在您可以对正在运行的应用程序进行基准测试和分析之后进行优化。

# hadoop - 在 hadoop 中有两个映射器的情况下，仅用于一个映射器的组合器

> ID：11486896
> 
> 赞同：2
> 
> 时间：2012-07-14T19:46:12.753
> 
> 标签：hadoop, mapreduce, combiners

我有两个映射器类，它们处理不同的输入，但它们的输出将采用相同的格式，并将转到同一个 reducer。是否可以只为两个映射器类之一实现组合器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T23:09:39.470

使用组合器，如果您将 Hadoop MR 设置为使用一个，它将处理来自所有映射器的输出。您不能指定特定的映射器。

也许考虑这两个选项：

1.  将组合器应用于所有输出 - 您将映射器的输出映射到通用类型，以便它们可以（加入？）由 Reducers 处理。考虑无论数据来自哪个映射器，组合是否都能正常工作。对这个想法的修改是在映射器输出的键或值中设置一个类型变量，并在组合中使用它来决定天气做任何事情。

2.  使用 Map 本地组合 - 如果您知道其中一个映射器的输出将很好地组合，您可以在映射器本身内进行一些聚合/组合，并且只定期写入输出。为使其正常工作，您需要对工作中的输入数据有一定的了解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T03:41:50.967

查询有点不清楚。我假设您问的是重用相同的组合器来组合两个不同映射器的输出。这应该是可能的，因为两个映射器的输出是相同的。

[使用MultipleInputs](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapreduce/lib/input/MultipleInputs.html)类可以在单个作业中使用两个映射器，也可以在两个不同的作业中使用两个映射器。在任何情况下，都必须在每个作业的基础上指定组合器。

另外，请注意

1）mapper的o/p要和reducer的i/p匹配。

2）mapper的o/p要和combiner的i/p匹配。

3）combiner的i/p和o/p应该是同一类型的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-24T13:04:20.783

组合器适用于最后一个链映射器，附上示例代码

```
ChainMapper.addMapper(job, SalesRecordMapper.class, LongWritable.class, Text.class, Text.class, DoubleWritable.class, configuration);

ChainMapper.addMapper(job, ItemDiscountMapper.class, Text.class, DoubleWritable.class, Text.class, DoubleWritable.class, configuration);

job.setCombinerClass(DoubleReducer.class); 
```

# objective-c - NSOperationQueue 指定线程

> ID：11486900
> 
> 赞同：8
> 
> 时间：2012-07-14T19:46:38.080
> 
> 标签：objective-c, cocoa-touch, cocoa, core-data

我想使用 an`NSOperationQueue`来调度 CoreData 操作。但是，操作队列的行为并不总是相同的（例如，它`libdispatch`在使用线程池的 iOS 4.0/OS 10.6 上调度）并且队列可能并不总是使用相同的线程（根据`NSManagedObjectContext`需要）。

我可以强制串行`NSOperationQueue`在单个线程上执行吗？还是我必须为此创建自己的简单排队机制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T02:27:45.823

> 我可以强制串行 NSOperationQueue 在单个线程上执行吗？还是我必须为此创建自己的简单排队机制？

你不应该做其中任何一个。Core Data 真正需要的是，您没有两段代码*同时*更改托管对象上下文。[在Concurrency with Core Data](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/coredata/Articles/cdConcurrency.html)的开头甚至有一个注释：

> **注意：**您可以使用线程、串行操作队列或调度队列进行并发。为了简洁起见，本文始终使用“线程”来指代其中的任何一个。

真正需要的是在给定的上下文中序列化操作。如果您使用单个线程，这自然会发生，但是如果您设置`maxConcurrentOperationCount`为 1，NSOperationQueue 也会对其操作进行序列化，因此您不必担心确保所有操作都发生在同一个线程上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T08:53:51.183

Apple 决定将托管对象绑定到真正的线程。在不同线程上访问上下文不再那么安全了——没有任何对象的上下文可能是安全的，但它的对象不是

# jquery - 表单提交两次

> ID：11486901
> 
> 赞同：0
> 
> 时间：2012-07-14T19:46:44.580
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, forms, double-submit-problem

我正在使用 simpleImageCheck 插件，由于某种原因，表单提交了两次。

下面是我的javascript：

```
<script type="text/javascript" language="javascript">
$(function() {
$('#pin_candle').simpleImageCheck({
    image: '/images/candle.png',
    imageChecked: '/images/one.png'
  })
$('#pin_rose').simpleImageCheck({
    image: '/images/rose.png',
    imageChecked: '/images/one.png'
  })
});
</script> 
```

这是我的导轨形式：

```
<%= form_for([@posts, @pin], :remote => true, :html => { :id => 'pinform' }) do |f| %>

  <%= f.check_box :candle, :onChange => "this.form.submit_button.click();" %>

  <%= f.check_box :rose, :onChange => "this.form.submit_button.click();" %>

  <%= f.submit :id => 'submit_button', :style => 'display: none;' %>
<% end %> 
```

我需要使用 this.form.submit_button.click(); 因为当我只使用标准 this.form.submit(); 它以 html 提交，而不是 js，所以 rails 不会让我进行 ajax 调用。

另一个问题是如果我在提交后禁用表单，我还有其他复选框，那么其他复选框不起作用。

有任何想法吗？

有没有办法阻止重复提交？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T07:44:54.553

改变你的看法 -

```
<%= form_for([@posts, @pin], :remote => true, :html => { :id => 'pinform' }) do |f| %>
  <%= f.check_box :candle %>
  <%= f.check_box :rose %>
  <%= f.submit :id => 'submit_button'%>
<% end %> 
```

并在脚本块中

```
 $("#pinform_candle").change(function () {
           submit_candle_or_rose("candle");
 });

 $("#pinform_rose").change(function () {
           submit_candle_or_rose("rose");
 });

 function submit_candle_or_rose(candle_or_rose)
 {
        $.ajax({
                        url: "/posts/pin?format=js&candle_or_rose="+ candle_or_rose,
                        beforeSend: function() {
                               //do something
                        },
                        success: function() {
                               alert("saved successfully");
                        },
                        error: function() {
                               alert("something failed");
                        }
         });
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T10:53:05.297

如果您的表单不是以 js 格式提交，请使用 :format => :js 和 form_tag 并尝试将 onclick 事件更改为 this.form.submit()

# php - PHP - 安全的 MySQL 登录

> ID：11486904
> 
> 赞同：0
> 
> 时间：2012-07-14T19:47:13.297
> 
> 标签：php, mysql, security

我有一个 PHP 函数，我的服务器上的任何其他函数都可以连接到全局 MySQL 数据库：

```
function connect_to_mysql_db() {

$con = mysql_connect("localhost", "user_name", "password");
if (!$con)
   {
      die('Could not connect: ' . mysql_error());
   }
mysql_select_db("db_name", $con);

} 
```

包含此功能的文件以及大多数其他功能位于我的 BlueHost 服务器上的以下位置：

```
/home3/username/includes/scripts.php 
```

该数据库目前仅包含一个包含电子邮件地址列表的表（我的订阅者的那些......）我只想知道数据库是否安全（为了我的订阅者）

如果没有，是否有人有任何其他想法（加密？）。我知道哈希不起作用，因为这通常是单向的......

**编辑**

仅供参考：**/includes/**目录不是**/public_html/**

**结论**

感谢所有帮助过我的人，但我决定无缘无故地承担太多责任，所以我不会在数据库中存储任何安全的东西。相反，我将使用外部服务！

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T15:16:17.117

我认为这不会给您任何额外的安全性。如果有人入侵您的服务器，读取脚本以获取数据库凭据，登录 mysql，读取 mailadressen 并仅获取加密数据，他可能会再次查看解密密钥的脚本......

所以，我认为这不会使它更安全。您最好专注于编写安全环境以防止对服务器的任何访问；-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T19:59:15.687

我认为它足够安全。无论如何，如果您想要更多，请尝试以下操作：

```
$crypted = openssl_encrypt ('myemail' ,'AES256', 'mypass') 
```

接着

```
$decrypted = openssl_decrypt ($crypted, 'AES256', 'mypass') 
```

参考 [这里](http://php.net/manual/en/function.openssl-encrypt.php)。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-14T19:57:53.827

您可以 AES 加密电子邮件地址。IE：

`$query = "INSERT INTO (table) AES_ENCRYPT('$email', '$salt')..."`

要以普通文本取回电子邮件：

`$query = "SELECT AES_DECRYPT('email', '$salt') FROM (table) WHERE 1..."`

$salt 将是您放入变量中的随机生成的密钥。

数据库表中的列必须是 blob。

# sql - Corona Lua SQLite

> ID：11486906
> 
> 赞同：1
> 
> 时间：2012-07-14T19:47:46.857
> 
> 标签：sql, select, lua, coronasdk

这是我在 stackOverflow 上的第一个问题。我正在使用 Corona，但在访问 SQLdb 时遇到问题（我有点 SQL 菜鸟。）

我正在尝试访问并返回我存储在数据库中的值。以下是一些代码示例：

```
print("---------------- How I Create New Player Save Data")
local entry = [[CREATE TABLE IF NOT EXISTS playerData (key STRING PRIMARY KEY, content INTEGER);]]
db:exec(entry)

entry = [[INSERT INTO playerData VALUES ("LastLoginTime", 0);]]
db:exec( entry )
entry = [[INSERT INTO playerData VALUES ("Credits", 1000);]]
db:exec( entry )
entry = [[INSERT INTO playerData VALUES ("Level", 1);]]
db:exec( entry ) 
```

现在这个函数可以工作了，它将打印数据库中的所有内容（我传入'dbName'）：

```
--print all the table contents
for row in db:nrows("SELECT * FROM "..dbName) do
  local text = row.key..":  "..row.content
end 
```

这不起作用，它返回“0”：

```
local grabCredits = "SELECT content FROM playerData WHERE key='Credits'"
  local credits = db:exec(grabCredits)
  print("-- value: "..credits) 
```

这也没有，也返回“0”：

```
local grabCredits = "SELECT key FROM playerData WHERE content>=10"
  local credits = db:exec(grabCredits)
  print("-- value: "..credits) 
```

我不明白我做错了什么。也许我需要在数据库上使用除 exec() 之外的另一个函数调用。我意识到每次我想访问单个条目时都可以遍历数据库，但这似乎效率低下。

很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:50:03.640

如果你想要结果，你必须使用某种形式的迭代器。SQLite 总是返回查询结果的*行*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-25T11:46:58.413

这类似于我用来从我的数据库中检索一个结果的方法，并且对我来说效果很好。

```
local query = "SELECT content FROM playerData WHERE key = 'Credits' LIMIT 1"

local queryResultTable = {}

local queryFunction = function(userData, numberOfColumns, columnValues, columnTitles)

    for i = 1, numberOfColumns do

        queryResultTable[columnTitles[i]] = columnValues[i]

    end

end

db:exec(query, queryFunction)

for k,v in pairs(queryResultTable) do

    print(k,v)

end 
```

# django - 共享主机上的 Django 更新 - 权限被拒绝

> ID：11486907
> 
> 赞同：0
> 
> 时间：2012-07-14T19:47:50.667
> 
> 标签：django, hosting, shared, fastcgi

我的共享主机计划中安装了 1.3.1 版 Django。它工作正常。问题是我需要将其更新到 1.4 但我收到一个错误

```
error: could not delete '/usr/lib/python2.6/site-packages/django/templatetags/__init__.py': Permission denied 
```

我联系了他们的支持，他们说他们无法更新它。他们说我应该检查 Django 论坛以获取任何可能的解决方案。

有人遇到过这样的问题并且能够解决吗？我正在托管 Hostgator。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T20:20:16.073

解决了：

```
python setup.py install --user 
```

# objective-c - .m 中的 Objective C“目标动作”和 .h 中的“出口”

> ID：11486913
> 
> 赞同：1
> 
> 时间：2012-07-14T19:48:37.487
> 
> 标签：objective-c, ios, cs193p

我目前正在参加斯坦福 CS193p iPhone 和 iPad 应用程序开发课程（[http://itunes.apple.com/itunes-u/ipad-iphone-application-development/id473757255](http://itunes.apple.com/itunes-u/ipad-iphone-application-development/id473757255)），在第二堂课中，当他连接时我被难住了将计算器的按钮连接到 .m 文件，他将显示标签（显示计算器上的值）连接到 .h 文件...

我对整个实现和头文件的理解是你在头文件中声明类成员并说明他们在实现中做了什么，这就是为什么这对我来说没有意义......

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:02:23.300

在 Objective-C 中，一个`.m`文件可能包含该类的`.h`文件未声明的类的方法。事实上，语言的类别特性可以有多个`.h`，并且`.m`定义了一个类的所有方法。

至于可以连接的内容，关键字`IBOutlet`标记属性或变量并`IBAction`标记动作方法。这些只是给编辑的提示；所有“连接”都是在运行时自动设置的。

# ajax - HTML5 表单，AJAX 验证

> ID：11486917
> 
> 赞同：0
> 
> 时间：2012-07-14T19:49:18.217
> 
> 标签：ajax, forms, html, jquery

我正在尝试开发一个 HTML5 联系表单，并使用 jQuery / AJAX 对其进行验证。

我能在网上找到的唯一帮助是[本教程](http://net.tutsplus.com/tutorials/html-css-techniques/build-a-neat-html5-powered-contact-form/)，它解释了如何在现代浏览器中为新的 HTML5 表单属性（必需和最小长度）执行此操作，以及在旧浏览器中使用 polyfill，尽管我的需求有点小不同的。

本质上，我希望人们要么请求三个复选框之一，要么输入一条消息。单独地，这些元素都不是必需的，但我希望其中至少一个在提交表单之前包含数据。

可以使用 PHP 执行此操作，例如：

```
if(empty ($checkbox1) && empty($checkbox2) && empty($checkbox3) && empty($message) ){
    $formok = false;
    $errors[] = "You need to either make a request for information, or ask a question.";
} 
```

如果有人知道如何为 jQuery / AJAX 编写它，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:52:41.203

如果信息是您在获取请求中不想要的信息，请查看 jQuery`$.post()`函数。文档[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)应该足以让您走上正确的道路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:15:04.637

```
 var $checkbx1 = $( '#checkbox1' ),
         $checkbx2 = $( '#checkbox2' ),
         $checkbx3 = $( '#checkbox3' ),
         formok = true,
         $msg = $( '#mymsg' ).val(); 
```

用户尝试提交表单：

```
 $( '#submitBtn' ).click( function() {
        if( ( $checkbx1.val() == '' && $checkbx2.val() == '' &&
              $checkbx3.val() == '' ) || $msg == '' ) {

            formok = false;

        }

        if( formok )
        {
            $.ajax({
                url: 'yourUrl',
                data: 'yourData',
                type: 'post',
                dataType: 'json',
                success: cb <-- your callback function
            });
        }
    }); 
```

# objective-c - 我如何从使用 api 登录 reddit 中获取 modhash 和 cookie？

> ID：11486921
> 
> 赞同：0
> 
> 时间：2012-07-14T19:50:04.183
> 
> 标签：objective-c, json, reddit

```
NSString *username = @"username";
NSString *password = @"password";
NSURL *loginurl = [NSURL URLWithString:[NSString stringWithFormat:@"http://www.reddit.com/api/login/%@",username]];
NSMutableURLRequest *loginrequest = [NSMutableURLRequest requestWithURL:loginurl];
[loginrequest setHTTPMethod:@"POST"];
NSData *loginRequestBody = [[NSString stringWithFormat:@"api_type=json&user=%@&passwd=%@",username,password] dataUsingEncoding:NSUTF8StringEncoding];
[loginrequest setHTTPBody:loginRequestBody];
NSURLResponse *loginResponse = NULL;
NSError *loginRequestError = NULL;
NSData *loginResponseData = [NSURLConnection sendSynchronousRequest:loginrequest returningResponse:&loginResponse error:&loginRequestError];
NSString *loginResponseString = [[NSString alloc]initWithData:loginResponseData encoding:NSUTF8StringEncoding];
NSLog(@"%@",loginResponseString); 
```

NSLog 打印：（替换了一些字母）

> {“json”：{“错误”：[]，“数据”：{“modhash”：“j5hq16ukw2f17a9c153xxxxxxxxxa72ad989c96c904d49a97e”，“cookie”：“13986184,2012-07-14T12:41:05,349f968b3089af75978xxx}xxx}xxx7ba

我如何访问 modhash 和 cookie？我试过

```
[loginResponseData valueForKey:@"json"]; 
```

但它表示该类不符合键 json 的键值编码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:03:43.290

loginResponseString 是一个 NSString ——它不知道里面是否有 JSON。您必须将此 JSON 解析为 NSDictionary，然后您可以使用它的方法来检索响应数据。试试我的 JSON 解析器：http: [//github.com/H2CO3/CarbonateJSON](http://github.com/H2CO3/CarbonateJSON)

使用我的 CarbonateJSON 库的示例：

```
NSDictionary *parsedResponse = [loginResponseString parseJson];
NSString *modhash = [[[parsedResponse objectForKey:@"json"] objectForKey:@"data"] objectForKey:@"modhash"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T21:59:16.177

对于任何在我之后查看此内容的人，您可以查看 H2CO3 的解决方案，但我发现最简单的解决方案是使用 NSJSONSerialization 以受支持的方式执行此操作。

```
NSError *error;
NSData *jsonData = [loginResponseString dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *loginResults = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error];
NSString *modhash = [[[loginResults valueForKey:@"json"] valueForKey:@"data"]valueForKey:@"modhash"]; 
```

为我工作。

# python - 需要尽可能快地反向迭代 Python 列表

> ID：11486922
> 
> 赞同：8
> 
> 时间：2012-07-14T19:50:05.047
> 
> 标签：python, list, python-3.x, iteration

我正在使用 Python 3.2.3。反向迭代列表的最快方法是什么？[::-1], reversed, list.reverse() 还是其他方式？我正在处理大约 5e6 个元素的列表，所以我真的需要避免复制列表。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-14T20:21:56.963

```
>>> from timeit import Timer
>>> t = Timer('[x for x in l[::-1]]', 'l = list(range(100000))')
>>> t.timeit(number=1000)
5.549649953842163
>>> t = Timer('l.reverse(); [x for x in l]', 'l = list(range(100000))')
>>> t.timeit(number=1000)
4.548457145690918
>>> t = Timer('[x for x in reversed(l)]', 'l = list(range(100000))')
>>> t.timeit(number=1000)
4.428632974624634 
```

结论： reversed() 在包含 100000 个项目的列表中略快于 l.reverse()。如果您实际上没有遍历整个列表，这当然更正确，如果您多次使用该列表，它就不再正确了。

`l[::-1]`自 2.4 引入`reversed()`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-14T19:51:46.897

`reversed`应该是最好的，因为它返回一个迭代器，所以它不复制列表，一次只产生一个元素。（`list.reverse()`也不会复制列表，但会对其进行变异，因此完成后列表将向后退，而`reversed`不会修改原始列表。）

# ruby-on-rails - Rails 3 & Cucumber - 创建关联的步骤定义

> ID：11486929
> 
> 赞同：2
> 
> 时间：2012-07-14T19:50:24.660
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cucumber, capybara

我有两个 Rails 资源：笔记和技术。

**备注型号：**

```
class Note < ActiveRecord::Base
  belongs_to :technology
end 
```

**技术模型：**

```
class Technology < ActiveRecord::Base
  has_many :notes
end 
```

**我想使用以下 Capybara 步骤：**

```
Scenario: Viewing notes and their technology association
    Given there are the following notes:
      | subject              |
      | recursive functions  |
    And the note "recursive functions" has the technology "JavaScript"
    And I am on the homepage
    Then I should see "recursive functions"
    And I should see "JavaScript" 
```

我用于该行的步骤：

```
 And the note "recursive functions" has the technology "JavaScript" 
```

是（**我怀疑问题出在以下**）：

```
Given /^the note "(.*?)" has the technology "(.*?)"$/ do |note, tech|
  @note = Note.find_by_subject!(note)
  @note.technology = Technology.find_or_create_by_name(tech)
end 
```

我希望它找到_or_create 给定技术对象的名称（名称是技术对象的参数）并创建关联，以便注释属于技术。

然后，最后一步：

```
And I should see "JavaScript" 
```

是为了验证 note.technology.name 是否显示在 Note#index 上的每个笔记实例旁边

```
 <% @notes.each do |note| %>
    <li>
      <%= link_to note.subject, note %> 
        <% if note.technology %>
          | Tech: <%= note.technology.name %>        
        <% end %>
    </li>
  <% end %> 
```

当我运行这个 Cucumber 功能时，这些步骤一直持续到最后，*我应该看到 "JavaScript"*，但出现错误：

```
expect there to be content "JavaScript" in "Note Index Page"
recursive functions \n \n recursive functions \n \n (RSpec:Expectations::ExpectactionNotMetError
./features/step_definitions/web_steps.rb:107 in '/^(?:|I )should see "([^"]*)"$/'
features\viewing_notes.feature:20:in 'And I should see "JavsScript"' 
```

我知道该关联正在工作，因为使用表单创建此关联是有效的（并在 Note#index 上显示@note.technology.name）。问题似乎与我的步骤定义有关。有没有更好的方法来测试它以查看发生了什么？也许写一个 Rspec 规范？感谢您花时间提供帮助。

（可能相关：）

```
gem 'rails', '3.0.0'

group :test do
  gem 'rspec-rails', '2.0'
  gem 'factory_girl', '2.6.4'
end

group :cucumber do
  gem 'cucumber-rails', '1.0.6'
  gem 'capybara'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T20:14:32.473

快速回答：

```
@note.technology = Technology.find_or_create_by_name(tech)
@note.save 
```

# javascript - 对象在 JavaScript 中不支持此属性或方法

> ID：11486931
> 
> 赞同：0
> 
> 时间：2012-07-14T19:51:11.853
> 
> 标签：javascript, html, activex, hta

好的，所以我想我又在这里 derping 了。我在 HTA（用于 Intranet 应用程序）中使用此代码，而不是仅使用普通的 HTML 页面。当我“提交”我的代码时，我收到错误消息“对象不支持此属性或方法在线：24（这是我关闭文件的位置（通过 activexobjects）

HTML 页面使用：

```
<input name="Button1" type="button" value="Submit" onclick="getFormContent()" /> 
```

我的 Javascript 文件（外部 .js 页面）：

```
// Global Variables First!
var AllFormContent
var ManagerValue
function managerValueTrue(ManagerValue) {
ManagerValue = "Yes"
}
function managerValueFalse(ManagerValue) {
ManagerValue = "No"
}

function getFormContent(ManagerValue) {
var Mudkips = document.getElementById('ManagerName');
var ManagerName = Mudkips.options[Mudkips.selectedIndex].text;
var RandomText = document.getElementById('RandomText').value;
var Comment = document.getElementById('Comments').value;
AllFormContent = ManagerName + ", " + ManagerValue + ", " + RandomText + ", " + Comments
writeMyFile();
}

 function writeMyFile(AllFormContent) {
var filesys = new ActiveXObject("Scripting.FileSystemObject");
var filetxt = filesys.OpenTextFile("C:\\MyFile.csv", 8) ;
filetxt.WriteLine(AllFormContent);
filetxt.Close;
} 
```

“第 24 行”指的是“filetext.close”，尽管我想它可能与“AllFormContent”或前一行有关？我已经测试了代码，我知道我可以使用 writeMyFile 函数，我知道 ActiveXObject 工作正常..关于我在这里使用什么的任何想法？谢谢 ：]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T02:36:52.073

正如每个人在评论中建议但没有回答的那样，只需在 writeMyFile() 处为 Close 添加括号即可。

```
function writeMyFile(AllFormContent) {
    var filesys = new ActiveXObject("Scripting.FileSystemObject");
    var filetxt = filesys.OpenTextFile("C:\\MyFile.csv", 8) ;
    filetxt.WriteLine(AllFormContent);
    filetxt.Close();
} 
```

`Close`是`Scripting.FileSystemObject`JavaScript 中的一种方法，而它更像是 VBScript 的子过程。要在 JavaScript 中调用函数和方法，您必须用括号关闭引用，而在 VBScript 中，没有必要`Sub`用括号调用 a 并且使用多个`params`它甚至会给出错误（我认为？）。

JScript 和 WScript 的 ActiveXObjects 的文档并不多，其中大部分都包含在 VBScript 中，因此在这方面经常存在混淆。

# javascript - 为什么这个 window.innerheight 的性能这么差？

> ID：11486933
> 
> 赞同：4
> 
> 时间：2012-07-14T19:51:41.290
> 
> 标签：javascript, performance, jsperf

我正在测试一个我的朋友注意到的测试用例。他在循环中使用 window.innerheight，并且 fps 出现了非常显着的下降。

这是我为测试它而创建的 jsperf 的链接[http://jsperf.com/innerheight](http://jsperf.com/innerheight)

我能想出的唯一解释是，这是一个吸气剂，每次调用都会计算实际高度。那正确吗？有什么文件可以验证吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-10-26T21:34:02.260

这个问题是几年前发布的，但以防其他人在这里遇到类似的结果。

从这个[博客](http://dcousineau.com/blog/2013/09/03/high-performance-js-tip/)：

> 问题是 WebKit 几乎每次使用类似于 getBoundingClientRect 的东西时都喜欢重新计算 dom 的布局。（即使获取 window.innerHeight/innerWidth 也会强制重新计算）......所有从 DOM 获取任何计算尺寸的调用都应该被缓存或避免。

在初始化和每次调整大小时缓存窗口尺寸一次显着提高了我的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T19:56:16.703

在您的第一个循环（innerheight）中，您正在访问一个 objects 属性并将其分配给`h`. 在第二个循环（缓存）中，您只有`h`. 当然，缓存的会更快。

# java - 通过在 Java DatagramSocket 中禁用 SO_RCVBUF 来读取最新的 UDP 数据包？

> ID：11486947
> 
> 赞同：1
> 
> 时间：2012-07-14T19:53:00.000
> 
> 标签：java, sockets, networking, udp

我需要读取最近传入的 UDP 数据包，无论读取之间丢弃的数据包如何。传入数据包的传入速度比最大应用程序处理速度快 3 倍。为了实现这一点，我使用`setReceiveBufferSize(int size)`Java 的`DatagramSocket`类将其设置为`SO_RCVBUF`与我预期的数据包相同的大小（以字节为单位）。

但是，在我得到最新的数据包之前仍然有 3 个数据包延迟（如果传入速率是接收速率的 10 倍，则有 10 个数据包延迟）。这表明它`SO_RCVBUF`包含的不仅仅是最新的数据包。

首先，单位是`setReceiveBufferSize(int size)`字节吗？[javadocs](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/DatagramSocket.html#setReceiveBufferSize%28int%29)中没有明确说明。其次，有没有办法禁用`SO_RCVBUF`，以便我只接收最近传入的数据包？例如，零是函数的非法参数，但理论上我可以将接收缓冲区大小设置为 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:31:51.567

这看起来像一个不寻常的问题；）

我建议将您的应用程序拆分为单独的线程：

*   接收者（最少的工作，没有解析/等）
    *   处理传入的数据包并将最后读取的对象放入异步变量中
*   处理（根据你写的，看起来这需要很长时间）
    *   从异步空间读取对象，并处理它（不要忘记忽略前面的）

如果你需要破解 SO_RCVBUF 之类的东西，我认为你应该更接近使用 C/C++ 的 io 处理子系统

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T23:57:02.317

你做错事了。将接收缓冲区设置得尽可能大。以 512k 为例。将其设置为低只会增加丢包的可能性。要么加快接收代码的速度，要么减慢发送代码的速度。发送无法接收的数据包是没有意义的。

# android - 耳机插入检测 - isWiredHeadsetOn() 仅适用于耳机

> ID：11486951
> 
> 赞同：5
> 
> 时间：2012-07-14T19:54:02.033
> 
> 标签：android, android-audiomanager

如果耳机当前插入，我有一个检测问题。我使用[Intent.ACTION_HEADSET_PLUG](http://developer.android.com/reference/android/content/Intent.html#ACTION_HEADSET_PLUG)并且效果很好。我启动了一项服务，并在 onCreate() 方法中通过 registerReceiver() 注册了我的接收器。大多数时候我会立即收到 ACTION_HEADSET_PLUG 广播，所以我知道耳机是否插入。

但有时（我不知道为什么）我在注册接收器后没有立即收到这个广播 - 所以我不知道耳机的当前状态。也许我可以假设在这种情况下它们没有连接 - 但我不确定它是否是 100% 真实的。所以我找到了[AudioManager#isWiredHeadsetOn()](http://developer.android.com/reference/android/media/AudioManager.html#isWiredHeadsetOn%28%29)方法，我还添加了所需的权限 MODIFY_AUDIO_SETTINGS。问题是它只能在耳机（耳机+麦克风）上正常工作，当只插入耳机时，它每次都会返回 false。请问，你知道如何解决这个问题吗？我正在为 android 2.1 开发。

# ios - 如何调试大的 UIView 内存分配

> ID：11486954
> 
> 赞同：2
> 
> 时间：2012-07-14T19:54:17.570
> 
> 标签：ios, debugging, memory, uiview, calayer

我正在尝试减少我的应用程序中的内存使用量，并且使用 Instruments 的分析表明 UIView drawLayer:inContext: 正在分配 2.25 MB。我假设分配是在调用我的代码之前完成的，并且是由于某处的 UIView 或 CALayer 大小不正确。但是我的代码都没有参与分配（见下图），因此我不知道如何调试它。我想我已经检查了我所有的视图和图层，我没有发现任何问题。

任何想法表示赞赏！

![在此处输入图像描述](../Images/4e201a19803ae1933b9aaf5c68c8db8d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T21:09:07.773

不用担心。系统正在为恰好为 640 * 960 * 4 字节的层分配后备存储。

如果您不泄漏图层或视图，那么您最终会在您的视图被卸载时取回您的字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T01:21:17.893

iOS 应用程序不会只是在内存不足时突然崩溃——它们会卸载不需要的视图并向视图控制器发送内存警告。如果您的应用程序崩溃似乎与内存有关，请确保您正确处理内存不足的情况：实施`-didReceiveMemoryWarning`并`-viewDidUnload`删除您不需要的数据。

视图会占用大量内存。`UIViewController`将在需要时释放其视图，但如果您有另一个指向同一视图的强/保留指针，您的视图控制器继承的功能将不知道释放它，并且即使不需要视图也永远不会被释放. 听起来这可能是您的情况，因为它是一大块内存，大小适合全屏视图。查看视图控制器以获取指向视图控制器视图（或任何其他视图）的其他指针，并确保将此类指针设置为 nil 或释放它们（取决于您是否使用 ARC）。

# image - 如何在 Matlab 中叠加多个图像？

> ID：11486956
> 
> 赞同：0
> 
> 时间：2012-07-14T19:54:24.113
> 
> 标签：image, matlab, image-processing, overlay

我有图像 A、B 和 C。如何使用 Matlab 叠加这些图像以产生 D？我至少要制作 50 张图片。谢谢。

[请在这里查看图片。](https://docs.google.com/open?id=0B5AOSYBy_josdEprb0VaRk15aTQ)

下载图片：

A：`https://docs.google.com/open?id=0B5AOSYBy_josQ3R3Y29VVFJVUHc`

乙：`https://docs.google.com/open?id=0B5AOSYBy_josTVIwWUN1a085T0U`

C：`https://docs.google.com/open?id=0B5AOSYBy_josLVRwQ3JNYmJUUFk`

丁：`https://docs.google.com/open?id=0B5AOSYBy_josd09TTFE2VDJIMzQ`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T20:05:29.933

**一起淡化图像：**

好吧，由于 matlab 中的图像只是矩阵，您可以将它们加在一起。

```
D = A + B + C 
```

当然，如果图像的尺寸不同，则必须将所有图像裁剪为最小的尺寸。

您应用此原则的次数越多，像素值就会越大。使用 显示图像可能是有益的`imshow(D, [])`，其中空矩阵参数告诉`imshow`将像素值缩放到 中包含的实际最小值和最大值`D`。

**要替换原始图像的更改部分：**

创建一个函数`combine(a,b)`。

伪代码：

```
# create empty answer matrix
c = zeros(width(a), height(a))

# compare each pixel in a to each pixel in b
for x in 1..width
    for y in 1..height
        p1 = a(x,y)
        p2 = b(x,y)

        if (p1 != p2)
            c(x,y) = p2
        else
            c(x,y) = p1
        end
    end
end 
```

像这样使用这个`combine(a,b)`函数：

```
D = combine(combine(A,B),C) 
```

或循环：

```
D = combine(images(1), images(2));
for i = 3:numImages
    D = combine(D, images(i));
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T22:40:54.527

从示例来看，在我看来，请求的操作是按指定顺序进行“ [alpha compositing ”的一个小例子。](http://en.wikipedia.org/wiki/Alpha_compositing)

像这样的东西应该可以工作 - 现在手边没有 matlab，所以这是未经测试的，但它应该是正确的或几乎是正确的。

```
function abc = composite(a, b, c)
  m = size(a,1); n = size(a,2);
  abc = zeros(m, n, 3);
  for i=1:3
    % Vectorize the i-th channel of a, add it to the accumulator.
    ai = a(:,:,i); 
    acc = ai(:);
    % Vectorize the i-th channel of b, replace its nonzero pixels in the accumulator
    bi = b(:,:,i); 
    bi = bi(:);
    z = (bi ~= 0);
    acc(z) = bi(z);
    % Likewise for c
    ci = c(:,:,i);
    ci = ci(:);
    z = (ci ~= 0);
    acc(z) = ci(z);
    % Place the result in the i-th channel of abc
    abc(:,:,i) = reshape(acc, m, n);
 end 
```

# php - Linux时间戳到PHP

> ID：11486957
> 
> 赞同：5
> 
> 时间：2012-07-14T19:54:33.593
> 
> 标签：php, timestamp

我有以下时间戳：

```
1342259667654 
```

当使用[http://www.epochconverter.com/](http://www.epochconverter.com/)转换时给出：

```
Assuming that this timestamp is in milliseconds:
GMT: Sat, 14 Jul 2012 09:54:27 GMT
Your time zone: 14\. juli 2012 11:54:27 GMT+2 
```

这是正确的时间，但是在使用时：

```
echo date("Y-m-d H:i:s", 1342259667654); 
```

我得到以下日期：

```
1904-07-24 10:22:47 
```

如何使用 PHP 从这个时间戳中获得确切的日期？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T19:57:40.280

您的时间戳需要除以 1000：

```
echo date("Y-m-d H:i:s", 1342259667654/1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T19:59:05.747

```
$timestamp = 1342259667; 
$dt = new DateTime("@$timestamp");  // convert UNIX timestamp to PHP DateTime
echo $dt->format('Y-m-d H:i:s'); 
```

你也可以这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T19:58:49.097

该值`1342259667654`实际上以毫秒为单位，而 PHP 的`date()`函数无法处理毫秒值。因此奇怪的输出。

# asp.net-mvc - 将 updatemodel 与 EF4.3.1 一起使用时出现 InvalidOperationException

> ID：11486959
> 
> 赞同：6
> 
> 时间：2012-07-14T19:55:00.630
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework

当我更新我的模型时，我也尝试更新一个子关系错误。

我的模型，说 Order 与 OrderItem 有关系。在我看来，我有订单的详细信息以及订单项的编辑器模板。当我更新数据时，指向 Order 的链接为空，但 orderid 已填充，因此它应该能够链接它， TryUpdateModel 返回 true，但保存失败并显示：

> InvalidOperationException：操作失败：无法更改关系，因为一个或多个外键属性不可为空。当对关系进行更改时，相关的外键属性将设置为空值。如果外键不支持空值，则必须定义新关系，必须为外键属性分配另一个非空值，或者必须删除不相关的对象。]

我的更新方法：

```
 public ActionResult ChangeOrder(Order model)
    {
        var order = this.orderRepository.GetOrder(model.OrderId);

        if (ModelState.IsValid)
        {
            var success = this.TryUpdateModel(order);
        }

        this.orderRepository.Save();

        return this.View(order);
    } 
```

我尝试了我在 SO 和其他来源上看到的所有解决方案，但没有一个成功。

我将 .Net MVC 3、EF 4.3.1 与 DBContext 一起使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T09:09:48.260

这里有许多代码异味，我会在更正时尽量保持优雅:)

我只能假设“订单”是您的 EF 实体？如果是这样，我强烈建议通过为表单创建视图模型并将数据复制到其中来将其与视图分开。您的视图模型实际上应该只包含您的表单将使用或操作的属性。

我还假设 orderRepository.GetOrder() 是从数据存储中检索订单的数据层调用？

您还声明了可能未使用的变量。`var order =`即使您的模型无效，“ ”也会被加载，并且“ `var success =`”永远不会被使用。

TryUpdateModel 和 UpdateModel 对于现实世界的编程来说不是很健壮。老实说，我并不完全相信他们应该在那里。我一般使用更抽象的方式，比如服务/工厂模式。这是更多的工作，但给你更多的控制。

在您的情况下，我会推荐以下模式。有最小的抽象，但它仍然比使用 TryUpdateModel / UpdateModel 为您提供更多控制：

```
 public ActionResult ChangeOrder(OrderViewModel model) {
        if(ModelState.IsValid) {
            // Retrieve original order
            var order = orderRepository.GetOrder(model.OrderId);

            // Update primitive properties
            order.Property1 = model.Property1;
            order.Property2 = model.Property2;
            order.Property3 = model.Property3;
            order.Property4 = model.Property4;

            // Update collections manually
            order.Collection1 = model.Collection1.Select(x => new Collection1Item {
                Prop1 = x.Prop1,
                Prop2 = x.Prop2
            });

            try {
                // Save to repository
                orderRepository.SaveOrder(order);
            } catch (Exception ex) {
                ModelState.AddModelError("", ex.Message);
                return View(model);
            }
            return RedirectToAction("SuccessAction");
        }
        return View(model);
    } 
```

不理想，但它应该为您提供更好的服务...

我推荐你看[这篇](https://stackoverflow.com/questions/7735635/real-example-of-tryupdatemodel-asp-net-mvc-3)文章，这是相似的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T10:43:32.270

我假设用户可以在您的视图中执行以下操作：

1.  修改订单（表头）数据
2.  删除现有订单项
3.  修改订单商品数据
4.  添加新的订单项

要正确更新已更改的对象图（订单 + 订单项列表），您需要处理所有四种情况。`TryUpdateModel`将无法正确更新数据库中的对象图。

我直接使用`context`. 您可以将上下文的使用抽象到您的存储库中。确保在以下代码中涉及的每个存储库中使用相同的上下文实例。

```
public ActionResult ChangeOrder(Order model)
{
    if (ModelState.IsValid)
    {
        // load the order from DB INCLUDING the current order items in the DB
        var orderInDB = context.Orders.Include(o => o.OrderItems)
            .Single(o => o.OrderId == model.OrderId);

        // (1) Update modified order header properties
        context.Entry(orderInDB).CurrentValues.SetValues(model);

        // (2) Delete the order items from the DB
        // that have been removed in the view
        foreach (var item in orderInDB.OrderItems.ToList())
        {
            if (!model.OrderItems.Any(oi => oi.OrderItemId == item.OrderItemId))
                context.OrderItems.Remove(item);
                // Omitting this call "Remove from context/DB" causes
                // the exception you are having
        }

        foreach (var item in model.OrderItems)
        { 
            var orderItem = orderInDB.OrderItems
                .SingleOrDefault(oi => oi.OrderItemId == item.OrderItemId);

            if (orderItem != null)
            {
                // (3) Existing order item: Update modified item properties
                context.Entry(orderItem).CurrentValues.SetValues(item);
            }
            else
            {
                // (4) New order item: Add it
                orderInDB.OrderItems.Add(item);
            }
        }

        context.SaveChanges();

        return RedirectToAction("Index"); // or some other view
    }

    return View(model);
} 
```

# javascript - JavaScript 画布可以像位图一样操作吗？它是否针对该用途进行了优化？

> ID：11486964
> 
> 赞同：1
> 
> 时间：2012-07-14T19:55:52.367
> 
> 标签：javascript, html, canvas, bitmap

可以像标准位图一样操作 JavaScript 画布（访问/修改像素并获取其大小）吗？这种使用是否经过优化，或者在需要时操作普通的二维像素数组并在画布上绘制会更快吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T20:00:20.847

绝对没错！请看这里： [https ://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Pixel_manipulation_with_canvas](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Pixel_manipulation_with_canvas)

至于您的第二个问题，根据像素文档，像素是一维数组。您需要以 2d 方式制作自己的 2 x 2 hoopla。

[取自I82Much](https://stackoverflow.com/users/155392/i82much)之前的 SO 回答（对我来说很有效）：

```
int row = i;
int col = j;
int offset = row * width + col;
color p = pixels[offset]; 
```

更多信息：[如何使用 2D 数组遍历像素？](https://stackoverflow.com/questions/5315265/how-to-loop-over-the-pixels-using-2d-array)
在这里： http: [//www.processing.org/reference/pixels.html](http://www.processing.org/reference/pixels.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T20:03:11.097

[您可以使用getImageData()](https://developer.mozilla.org/en/DOM/CanvasRenderingContext2D#getImageData%28%29)从画布上下文中获取像素数据数组。请记住，每个像素占用阵列中的 4 个空间（用于红色、绿色、蓝色和 alpha）。然后，一旦根据自己的喜好更改了数组，就可以使用[putImageData()](https://developer.mozilla.org/en/DOM/CanvasRenderingContext2D#putImageData%28%29)将数据放回原处。

# gwt - 将 clickhandler 添加到树中的小部件

> ID：11486965
> 
> 赞同：1
> 
> 时间：2012-07-14T19:56:05.343
> 
> 标签：gwt, event-handling, handler

我有一个 clickhandler 的问题，它是 treeitem 中小部件的一部分。

如果我在此小部件上单击第一次，则触发 treeItem 的处理程序。如果我第二次点击这个小部件，两个处理程序都会被触发。

有没有办法为一个 TreeItem 停用树处理程序？我有以下代码：

```
TreeItem subTree= new TreeItem(type.toString());
        ....
            HorizontalPanel panel= new HorizontalPanel();
            panel.setWidth("200px");
            Label folderLabel= new Label(folder);
            folderLabel.setWidth("200px");
            panel.add(folderLabel);
            Image choosen= new ChooseFolderImage(type, folder);
            choosen.setSize("20px", "20px");
            panel.add(choosen);
            choosen.addHandler(handler, ClickEvent.getType());
            subTree.addItem(panel);
        ....
        rootTree.addItem(subTree); 
```

问候，命运

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:12:36.307

实际上我做了以下事情：

1.  我创建了一个新的 GWT 项目
2.  我将您的代码复制粘贴`onModuleLoad()`到我的类中的方法中，该方法扩展`EntryPoint`
3.  我运行了这个项目

它工作得很好，你的代码肯定还有其他错误的地方。

# matplotlib - 应该如何构建 plot_surface 的数组？

> ID：11486973
> 
> 赞同：7
> 
> 时间：2012-07-14T19:57:44.827
> 
> 标签：matplotlib

我试图了解如何构建用于 plot_surface 的数组（在 Axes3d 中）。我试图构建一个简单的表面操作这些数组的数据：

```
In [106]: x
Out[106]: 
array([[0, 0],
       [0, 1],
       [0, 0]])

In [107]: y
Out[107]: 
array([[0, 0],
       [1, 1],
       [0, 0]])

In [108]: z
Out[108]: 
array([[0, 0],
       [1, 1],
       [2, 2]]) 
```

但我无法弄清楚它们是如何被解释的——例如，我的情节中 z=2 没有任何内容。任何人都请准确解释将采用哪些值来表示点，哪些值用于线，最后是曲面。

例如，我想构建一个与线点连接的表面：[0,0,0]->[1,1,1]->[0,0,2] [0,0,0]-> [1,-1,1]->[0,0,2] 和这些线之间的表面。数组应该是什么`plot_surface`样子才能得到这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-22T11:53:06.427

理解网格是如何`plot_surface`工作的并不容易。所以首先我会给出一个一般性的解释，然后我会解释如何在你的情况下转换数据。如果您有一个`N`x 值数组和一个`M`y 值数组，则需要创建两个分别具有 x 和 y 维度值的网格`(M,N)`。幸运的是`numpy.meshgrid`会有所帮助。使困惑？看一个例子：

```
x = np.arange(3)
y=np.arange(1,5)
X, Y = np.meshgrid(x,y) 
```

该元素`(x[i], y[j])`以`(X[j,i], Y[j,i])`. 当然，它的`Z`值是 ，`Z[j,i]`您还需要定义它。

`(0,0,2)`话虽如此，您的数据确实如预期的那样在 中产生了一个表面点。事实上，在那个位置有*两个*点，来自坐标索引`(0,0,0)`和`(1,1,1)`。

我附上绘制数组的结果：

```
fig = plt.figure()
ax=fig.add_subplot(1,1,1, projection='3d')
surf=ax.plot_surface(X, Y, Z) 
```

[![在此处输入图像描述](../Images/c2bf8be42e6ba150f3e4d5dcd642da8a.png)](https://i.stack.imgur.com/RvTUs.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T13:15:02.673

如果我对您的理解正确，您会尝试通过一组点对曲面进行插值。我不认为 plot_surface 是正确的功能。但如果我错了，请纠正我。我认为您应该寻找插值工具，可能是 scipy.interpolate 中的那些。然后可以使用 plot_surface 绘制插值的结果。

plot_surface 能够根据 x、y 坐标在 3D 空间中绘制网格（具有 z 值）。x 和 y 的数组是由 numpy.meshgrid 创建的。

plot_surface 示例：

```
import pylab as plt
import numpy as np
from mpl_toolkits.mplot3d import Axes3D

plt.ion()

x = np.arange(0,np.pi, 0.1)
y = x.copy()
z = np.sin(x).repeat(32).reshape(32,32)

X, Y = np.meshgrid(x,y)

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(X,Y,z, cmap=plt.cm.jet, cstride=1, rstride=1) 
```

# c# - 如何通过 wpf 中的代码更改系统的 COM 端口设置（位、数据位、奇偶校验、停止位和流控制）？

> ID：11486974
> 
> 赞同：0
> 
> 时间：2012-07-14T19:57:52.020
> 
> 标签：c#, wpf, serial-port

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        this.InitializeComponent();

                SerialPort MySerialPort = new SerialPort();

                txt_1.Text = MySerialPort.BaudRate.ToString();
                txt_2.Text = MySerialPort.DataBits.ToString();
                txt_3.Text = MySerialPort.Parity.ToString().ToUpper();
                txt_4.Text = MySerialPort.StopBits.ToString().ToUpper();
                txt_5.Text = MySerialPort.Handshake.ToString();
    }
} 
```

它的输出将是这样的。 ![输出1](../Images/7da9227941d0b1b20a6dc5d5166b1239.png)

然后我只修改文本框值，例如**7200,7,Odd,2 & Hardware .**如果单击更新按钮，这些值应该在我的系统中更改（下图）。 ![在此处输入图像描述](../Images/61a91f7b2c2fb0817aa17f66d967a6fe.png)

最后，我想在单击更新按钮后通过文本框值更改端口设置。我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T22:10:41.537

这些设置存储在注册表中

`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports`

这些值作为逗号分隔的字符串存储在单个键中。

你可以使用这样的东西：

**阅读**_

 **```
 Microsoft.Win32.RegistryKey myKey = 
                Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports", true);
            string settings = myKey.GetValue("COM3:"); 
```

**写**_

 **```
 Microsoft.Win32.RegistryKey myKey = 
                Microsoft.Win32.Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports", true);
            myKey.SetValue("COM3:", "9600,n,8,1"); 
```

`"9600,n,8,1"`但是，您可以从文本框中的用户提供的值构造一个值，而不是编写硬编码值。****

# git - Shell 因 [进程完成] 而崩溃

> ID：11486989
> 
> 赞同：1
> 
> 时间：2012-07-14T20:00:31.293
> 
> 标签：git, terminal, zsh

我正在为 Z-Shell 编辑点文件别名。这是我从 dotfiles repos 中找到的别名。

```
function gch() {
    git clone git://github.com/$USER/$1.git
} 
```

然后当我去 zsh 时，运行如下命令：

```
gch benhoskings dot-files 
```

我期望发生的是

```
git clone https://github.com/benhoskings/dot-files 
```

运行该命令后，它只输出

```
[Process completed] 
```

外壳冻结，^C 也不起作用。我启动了一个新的 shell，我所有的 git 命令都被粉碎了，就像我执行一样`git status`，它显示`[Process completed]`并且 shell 运行速度非常慢。

我知道修复别名函数需要什么，所以我可以传递两个参数，比如这些

```
     函数 gch() {
         git clone git://github.com/$1/$2.git
     }

```

如何杀死在后台运行的进程？它减慢了一切，无法运行任何 git 命令。我通过采购.zshrc重新加载zsh，并尝试重新启动计算机以清除当前会话，但仍然无法摆脱在后台运行的进程。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T21:09:23.897

好吧，我已经编辑了多个别名。导致 [Process completed] 的真正问题不是执行的功能。这是我添加的这个功能

```
    gls() {
        查询="$1"
        转移
        glog --pickaxe-regex "-S$query" "$@"
    }

```

我不知道为什么它会导致外壳中断，但是我删除了该功能，一切都恢复了正常。当我看到 [Process completed] 错误时，我吓坏了很长时间。好吧，谁能告诉我为什么这个坏了？

或者另一个问题，我从 github 上其他人的 dotfiles 中找到的。有时它使用这种格式：

```
    git_current_branch() {
        cat "$(git rev-parse --git-dir 2>/dev/null)/HEAD" | sed -e 's/^.*refs\/heads\///'
    }

```

有时，它使用这种格式和 function 关键字：

```
    功能 git_current_branch() {
        cat "$(git rev-parse --git-dir 2>/dev/null)/HEAD" | sed -e 's/^.*refs\/heads\///'
    }

```

他们都有效。这两种格式有什么区别？这是您在 CLI 中调用的方式吗？

# regex - 与蒙版文本一样，如何用文本填充占位符，并删除文本以返回占位符？

> ID：11486990
> 
> 赞同：0
> 
> 时间：2012-07-14T20:00:46.637
> 
> 标签：regex, actionscript-3, replace

我希望能够合并两个（可能是三个）字符串，如下所示。这可以使用正则表达式吗？（我使用的基本语言是 Actionscript 3.0，但我可以使用更通用的正则表达式解决方案。）

这个想法是`XYZ`（非破折号）字符固定到位，根据需要用新字符替换破折号。添加任何添加都好像一个跳过固定字符的堆栈。我想使用第三个字符串：`---XYZ---`来维护占位符。

## 回复评论

蒙面文本输入是我正在寻找的，但从右侧而不是左侧添加。下划线代表添加字符的占位符。它们实际上会在屏幕上看到（当然，除非被替换）。

一个广泛的例子：

准备工作：设置字符串长度：`---------`

准备：设置固定：`---XYZ---`

添加字符：`---XYZ--a`

添加字符：`---XYZ-ab`

添加字符：`---XYZabc`

添加字符：`--aXYZbcd`

添加字符：`-abXYZcde`

添加字符：`abcXYZdef`

删除字符：`-abXYZcde`

删除字符：`--aXYZbcd`

删除字符：`---XYZabc`

添加多个字符：`abcXYZmno`

删除多个字符：`---XYZabc`

## 回答

根据@Charmander 的建议，这里有一个完整的例子：

```
var carr:Array = [];

function fillMaskChars(maskText:String, chars:String, pop:Boolean = false):String
{
    var maskLen:int = maskText.match(/-/g).length;

    if (pop)
    {
        carr.pop();
    }
    else if (carr.length < maskLen)
    {
        carr = carr.concat(chars.split('', maskLen - carr.length));
    }

    if (carr.length == 0)
    {
        return maskText;
    }

    var i = carr.length - maskLen - 1;

    return maskText.replace(/-/g, function()
        {
            return carr[++i] || '-';
        });
} 
```

一些测试：

```
var characters:String = "oed";
var curMask:String = "--W-RK---";

var outText:String = maskChars(curMask, characters);
trace(outText);

characters = "!";
outText = maskChars(curMask, characters);
trace(outText);

characters = "abcdefghij";
outText = maskChars(curMask, characters);
trace(outText);

outText = maskChars(curMask, "", true);
trace(outText);

outText = maskChars(curMask, "", true);
trace(outText);

outText = maskChars(curMask, "", true);
trace(outText);

outText = maskChars(curMask, "", true);
trace(outText); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T23:06:52.453

我想你会发现一个更合适的数组。恐怕我没有 ActionScript 的经验，但从 JavaScript 翻译过来应该不难。

```
function fillMaskWithCharacters(mask, characters) {
    var masked = mask.match(/-/g).length;
    var i = 0;

    return mask.replace(/-/g, function() {
        return characters[--i + masked] || '-';
    });
} 
```

它传递了一个字符数组，您可以根据需要对其进行操作。例如：

```
fillMaskWithCharacters('--w-rk---', ['!', 'd', 'e', 'o']); // "--worked!" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T21:44:56.223

我真的不明白为什么这应该非常有用，但我想这可以通过替换子字符串和 lastindexof 来完成

```
var myChars:String = _abXYZcd;
var seperator:String = XYZ;

var stringToAdd:String = ee;

var pos:int = _myChars.lastIndexOf(seperator);
var newString = myChars.substring(0, pos) + myChars.substring( (pos+seperator.length), myChars.length)
newString += seperator;
newString += stringToAdd; 
```

但我认为使用数组或其他东西会更有用。像。我也不知道是否应该有有限的字符，在这种情况下，替换和子字符串的所有位置只能计算一次......我没有测试它，但我想你明白了。

# android - Android：在 PreferenceActivity 中编辑自定义首选项视图的子项

> ID：11486992
> 
> 赞同：3
> 
> 时间：2012-07-14T20:01:25.590
> 
> 标签：android, android-preferences

所以我为我的偏好活动中的一个偏好构建了一个自定义偏好视图：

```
<Preference 
      android:key="facebook_sharing"
      android:layout="@layout/fb_pref_item"/> 
```

我希望能够以编程方式编辑该自定义首选项布局中的 ImageView（基于首选项本身的值。

它看起来像这样：

```
Preference facebookItem = (Preference)findPreference("facebook_sharing");
facebookItem.setOnPreferenceChangeListener(this);

RelativeLayout rl = //get relative layout someway or another...

mFacebookIcon = (ImageView)rl.findViewById(R.id.fb_imgview);
if(!mFacebookConn.isSessionValid())
    mFacebookIcon.setColorFilter(R.color.transparent_black); 
```

我不知道如何取消注释行。我尝试了以下方法：

```
RelativeLayout rl = (RelativeLayout)facebookItem.getView(null, null); //dont know what the params ought to be...

RelativeLayout rl = (RelativeLayout)findViewById(facebookItem.getLayoutResource()); 
```

都不工作。我四处寻找，但似乎找不到任何尝试过这个的人。有任何想法吗？谢谢！

编辑：提供 fb_pref_item：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fb_view"
    android:layout_width="match_parent"
    android:layout_height="68dp" >

    <TextView android:id="@+id/fb_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="15dp"
        android:layout_marginTop="8dp"
        android:layout_marginBottom="2dp"
        android:layout_alignParentTop="true"
        android:text="@string/facebook"
        android:textSize="20sp"
        android:textColor="@color/item_view_text_color" />

    <TextView android:id="@+id/fb_description"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="15dp"
        android:layout_marginTop="4dp"
        android:layout_marginBottom="8dp"
        android:layout_alignParentBottom="true"
        android:layout_below="@id/fb_title" />

    <ImageView android:id="@+id/fb_imgview"
        android:src="@drawable/facebook64"
        android:layout_width="42dp"
        android:layout_height="42dp"
        android:layout_centerVertical="true"
        android:layout_margin="12dp"  
        android:layout_alignParentRight="true" 
        android:scaleType="centerInside"
        android:contentDescription="@string/cd_icon"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T01:02:56.937

根据迄今为止提供的信息（请参阅上面的评论，我建议在其中发布`fb_pref_item.xml`来源——您也没有说明您是否有多个`ImageView`s 或只有一个），在我看来，您似乎不是在寻找正确的视图. 而不是这个：

```
RelativeLayout rl = //get relative layout someway or another...
mFacebookIcon = (ImageView)rl.findViewById(R.id.fb_imgview); 
```

看起来你应该能够`RelativeLayout`完全忽略这个不必要的，直接去`fb_imgview`：

```
mFacebookIcon = (ImageView) this.findViewById(R.id.fb_imgview); 
```

请注意，在这种情况下，您将使用继承的[`findViewById(int)`](http://developer.android.com/reference/android/app/Activity.html#findViewById%28int%29)方法，它`PreferenceActivity`直接继承自`Activity`，而不是试图找到第`RelativeLayout`一个。

您不能使用该`Preference#getView()`方法，因为它用于**生成**视图（然后将在`PreferenceActivity`. 它不用于在已经渲染后*获取视图。*

# android - JPCT 加载多个对象

> ID：11486994
> 
> 赞同：2
> 
> 时间：2012-07-14T20:01:50.037
> 
> 标签：android, 3d, jpct

我目前正在学习适用于 Android 的 JPCT。在阅读了一些教程和示例之后，我注意到每个人都将他们的对象和纹理一一加载到场景中，如下所示：

```
cube = loadModel(getAssets().open("cube.3ds"), 1);
TextureManager.getInstance().addTexture("tex", new Texture(getAssets().open("text.png")));
cube.setTexture("tex");
cube.build();
world.addObject(cube); 
```

这应该加载一个 3ds 文件（我在 Blender 上创建的），对其应用纹理，然后将其放在世界上。如果这个 3ds 文件有多个对象，它会将纹理应用到所有对象。好的，到目前为止还不错。

但是，如果我在同一个文件中有数百个对象来为游戏创建一个场景，每个对象都有自己的纹理怎么办？

我必须一一加载它们和它们的纹理吗？

有没有办法自动化这个？也许一些已经拥有纹理关系的文件格式或类似的东西？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T05:59:45.723

自己找到了解决办法！

您实际上不必手动加载纹理，如

```
cube.setTexture("tex"); 
```

只要您在将纹理文件名添加到 TextureManager 时保持纹理文件名与 Blender 中指定的相同：

```
TextureManager.getInstance().addTexture("text.png", new Texture(getAssets().open("text.png"))); 
```

通过这样做，Load 方法将自行应用纹理！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T18:10:49.760

你应该这样做：

`Texture texture = new Texture(BitmapHelper.rescale(BitmapHelper.convert(getResources().getDrawable(R.drawable.image)), 64, 64)); TextureManager.getInstance().addTexture("texture", texture);`

# android - 在 Facebook 中阅读消息

> ID：11486995
> 
> 赞同：3
> 
> 时间：2012-07-14T20:02:09.007
> 
> 标签：android, facebook, api, facebook-graph-api

我一直在尝试阅读来自特定用户（朋友）的消息。

我在图形 API 中找不到关于在 Facebook 消息中查询消息或线程的适当文档。

谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T20:06:13.640

您只能为使用您的应用程序的用户阅读消息，而不能为他的朋友阅读消息。（这是一件好事……）

要为当前用户执行此操作，请参见此处：[https](https://developers.facebook.com/docs/reference/api/user/) ://developers.facebook.com/docs/reference/api/user/ （收件箱和发件箱连接）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:36:24.000

目前很难做到这一点，因为您必须从`me/inbox`

如果您事先知道线程 ID，您可能*会*得到它，但`/thread_id`似乎效果不佳。

因此，要当前获取它，请检查`to`每个线程对象响应中字段中的朋友 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T11:27:55.020

你可以像这样使用它：

```
https://graph.facebook.com/fql?q=select thread_id,subject,recipients, snippet, snippet_author from thread where folder_id = 0 and [FRIEND_ID] in recipients 
```

然后你得到你朋友所在的所有线程。然后，您可以从那些线程中检查只有您和这个朋友是收件人的线程。

然后您可以使用以下方法获取消息：

```
https://graph.facebook.com/fql?q=SELECT message_id, thread_id, author_id, body, created_time, attachment, viewer_id FROM message WHERE thread_id = [THREAD_ID] 
```

# java - 在 JVM 应用程序中托管非 JVM 语言

> ID：11486998
> 
> 赞同：2
> 
> 时间：2012-07-14T20:02:29.490
> 
> 标签：java, networking, messaging, rpc, mud

我正在寻找一些方向来学习如何从 Java 托管其他语言。到目前为止，我已经找到了 JSR 223 和 Bean Scripting Framework 之类的东西，但我的知识和经验不足以告诉我这些是否是合适的起点。

该应用程序是一个泥浆，其中游戏系统作为连接（通过套接字）到基于 JVM 的服务器的服务运行。

理想情况下，我希望我的泥浆能够处理所有网络，因此我正在考虑编写一个小型网络模块，它可以从任何语言或至少一些流行语言加载代码。当有人想编写游戏模块时，他们会使用我的网络模块并将其与他们的代码打包在一起。在启动时，我的网络模块加载他们的代码并与我的服务器对话。

例如，一个游戏开发者在 Lua 中编写了一个战斗程序。我希望连接到我的服务器的网络程序通过“加载”它（以某种方式）来“托管”这个 Lua 代码。我不希望将 Lua 嵌入到我的 Java 程序中（Jython、JRuby 等也是如此），因为我寻求更通用的解决方案，但是我理解这是否不切实际。

我正在使用这种方法，因此开发人员可以用任何语言编写游戏系统。

我也考虑过诸如 Bridge RPC 之类的服务，但我更喜欢不依赖于特定供应商的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T21:06:36.990

除非您希望您的有线协议非常复杂，否则我建议您：

1.  大量记录有线协议
2.  提供一个简单的开源、基于 java 的客户端参考库

因此，客户端开发人员既可以在 Java 程序中使用您的库，也可以用另一种语言编写自己的版本。拥有文档化的协议和参考库应该足以让任何开发人员用他们选择的语言重新实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T21:16:58.460

一些选项：

*   为了获得良好的性能，我建议使用二进制格式：类似于 Google 的[Protocol Buffers](http://code.google.com/p/protobuf/)。
*   对于一般的灵活性和许多不同的语言实现可能值得看看[Apache Thrift](http://thrift.apache.org/)
*   实现自己的 REST 或基于文本的服务也是可行的。您可能会考虑使用 JSON 作为消息格式。

# objective-c - 目标 c 中原始 C 类型的内存管理

> ID：11486999
> 
> 赞同：1
> 
> 时间：2012-07-14T20:02:34.180
> 
> 标签：objective-c, memory-management, primitive-types

如果我在我的程序中分配一个对象，那么我需要释放它。如果我创建一个 int，那么我需要调用 free(myint) 还是该变量会在我的函数结束时自动销毁？另外，如果我向我的对象添加 int、long 或 bool 属性，那么我是否需要在 dealloc 中处理 then 或者当我正在使用的函数完成时它们也会被销毁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T20:08:53.107

> If I create an int, then do I need to call free(myint) or will the variable be destroyed automatically at the end of my function?

It depends on how you do it: automatic variables of primitive types are deallocated when they do out of scope:

```
if (a == b) {
    int sum = 0;
    sum = a + b;
    NSLog(@"%d", sum);
} 
```

If you allocate your primitive using `malloc` or `calloc`, you must use `free` at the end (I don't know why you'd want to use primitives like this, though):

```
if (a == b) {
    int *sumPtr = malloc(sizeof(int));
    *sumPtr = a + b;
    NSLog(@"%d", *sumPtr);
    free(sumPtr);
} 
```

Same rules are followed when you add primitive fields to your objects: if you use `malloc` in the `init`, then you must use `free` in `dealloc`. Otherwise, the value is allocated "in line" with the rest of your object, and do not need separate deallocation.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-14T20:04:49.927

作为 C 的超集，自动堆栈变量的规则是相同的。因此，`int x;`在函数中定义意味着您不必做任何事情来清理它，因为它在堆栈上。诸如在某些时候需要清理的堆`int *x = malloc(...);`分配`free(x);`。如果这些步骤发生在一个对象内部（例如 in `init`），那么这是同一个想法；一个`int`字段可以单独存在，但分配需要通过`dealloc`类方法中的释放来平衡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T21:39:35.753

内存管理的基本要点（没有任何更深入的细节），您必须`release`将您创建的每个对象都设置为`new`,`alloc`或`copy`; 或者在你增加`retain`了当前对象的计数器之后。

在所有其他情况下，您无需担心调用该`release`方法并且您不应该这样做，这会导致崩溃的高风险。

*（这只是没有 ARC 的内存管理的粗略基础）*

您无需担心原语，除非您之前使用`alloc(...);`or为它们分配了内存`malloc(...);`；在这种情况下，您必须`free(...);`在完成使用它们后分配内存。