# StackOverflow 问答 12321000-12321999

# sql - 在计算中使用 SQL 别名创建其他别名

> ID：12321002
> 
> 赞同：1
> 
> 时间：2012-09-07T15:21:31.293
> 
> 标签：sql, sql-server, sql-server-2008

我有以下 SQL 语句：

```
SELECT id  + 100000000000000000 AS id,  
    a.external_code + CAST(id AS varchar(15)) as crUniqueId,  
    m.check_amount,  
    'C' as crType,  
    m.postprint_date as activationDate,  
    m.postprint_date as creationDate,  
    m.memo_explanation as reasonLine1,  
    m.check_no, 
    m.check_amount - sh.sumAmount As dispositionAmount 
    FROM md_master m 
    Join accounts a on m.account_tag = a.acct_id 
    LEFT JOIN (SELECT master_id,  
                SUM(md_cr_pending.current_amount) as sumAmount  
                FROM md_cr_pending 
                Group BY master_id) sh ON master_id = m.ID 
    WHERE (m.postprint_tag = 2) OR (m.postprint_tag = 4) OR  
          (m.postprint_tag = 5) OR (m.postprint_tag = 7) 

    UNION ALL  

    SELECT id + 200000000000000000 as id,  
    'PERCHK' + CAST(id AS varchar(15)) as crUniqueId,  
    check_amount,  
    'P' as crType,  
    business_date as activationDate,  
    business_date as creationDate,  
    identify_description as reasonLine1,  
    check_no, 
    check_amount - sh.sumAmount As dispositionAmount 
    FROM cd_personal_checks  
    LEFT JOIN (SELECT cd_personal_checks_id,  
                SUM(md_cr_pending.current_amount) as sumAmount  
                FROM md_cr_pending 
                Group BY  cd_personal_checks_id) sh  
                ON sh.cd_personal_checks_id = cd_personal_checks.ID 
```

我想在 UNION 的每个 select 语句中添加一个附加列。但是，我需要使用作为上一列创建的别名。

例如。我想做以下事情

```
m.check_amount - sh.sumAmount As dispositionAmount, m.check_amount-dispositionAmount AS openBalance 
```

和

```
check_amount - sh.sumAmount As dispositionAmount,  check_amount-dispositionAmount AS openBalance 
```

分别

这可以做到吗？目前，按照我上面的做法，我得到一个“无效的列名'dispositionAmount'”

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:22:43.787

不，它不能处于同一级别，因为您在选择中给出的别名仅在 Order By 部分中“可用”。这是因为逻辑查询处理。

为此，您应该构建更多级别，或再次使用该表达式。

我不知道，你想这样做：

```
m.check_amount - sh.sumAmount As dispositionAmount, 
m.check_amount - dispositionAmount AS openBalance 
```

因为它是相等的：

```
m.check_amount - sh.sumAmount As dispositionAmount, 
m.check_amount - m.check_amount + sh.sumAmountAS AS openBalance 
```

这是：

```
m.check_amount - sh.sumAmount As dispositionAmount, 
sh.sumAmountAS AS openBalance 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:24:24.087

不，这做不到。您需要重复计算`dispositonAmount`.

```
...
m.check_amount - sh.sumAmount As dispositionAmount, 
m.check_amount - (m.check_amount - sh.sumAmount) AS openBalance
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:26:22.103

表达式`check_amount-dispositionAmount`与 相同`check_amount-(check_amount - sh.sumAmount)`，与 相同`(check_amount-check_amount) + sh.sumAmount`，所以就是`sh.sumAmount`。

所以：

```
check_amount - sh.sumAmount As dispositionAmount, sh.sumAmount AS openBalance 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-30T20:16:59.707

您可以使用 CROSS APPLY CROSS APPLY

```
SELECT my_num, my_num*5 AS another_number FROM table CROSS APPLY (SELECT 5 AS my_num) X 
```

# c++ - C++ std::stringstream >> std::string 只存储第一个条目？

> ID：12321003
> 
> 赞同：1
> 
> 时间：2012-09-07T15:21:35.860
> 
> 标签：c++, stringstream

> **可能重复：**
> [如何强制 std::stringstream 运算符 >> 读取整个字符串？](https://stackoverflow.com/questions/1136359/how-to-force-stdstringstream-operator-to-read-an-entire-string)

我正在尝试将结构转换为字符串，类似于 toString() 对 Java 或 C++ 中的对象的工作方式。为此，我将格式化数据写入 std::stringstream，然后将其写入 std::string。

这是我所拥有的：

```
std::stringstream ss;
std::string       packet;

ss <<  "Packet Length: " << p->header->len
   << " (" << p->header->caplen << ")" << std::endl
   << "Collected: " <<  timedate << "."
   << std::dec << p->header->ts_usecs << std::endl
   << "Eth:\tFrom: " << to_address(p->from) << std::endl
   <<     "\tTo:   " << to_address(p->to)  << std::endl
   <<     "\tType: " << to_hex(p->type, false)
   << " (" << p->type_name << ")" << std::endl; 
```

但是由于某种原因，当我将此流写入 std::string 数据包时：

```
ss >> packet; 
```

然后打印数据包的值：

```
cout << "Packet X " << packet << endl; 
```

我只看到文字`"Packet"`，没有别的。

我在这里有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T15:24:16.793

您应该使用[`stringstream ::str`](http://www.cplusplus.com/reference/iostream/stringstream/str/)成员获取值，而不是读回字符串：

```
string p = ss.str(); 
```

否则，读取遵循将空格视为分隔符的通常模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:24:14.410

如果你想`std::string`摆脱 a `stringstream`，你可以这样做：

```
packet = ss.str(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:25:52.870

StringStream 运算符 >> 与任何其他流运算符 >> 一样工作。因此，对于参数字符串（>> 到字符串），它会将数据提供给第一个白色字符（空格、换行符、文件结尾等）

# mapreduce - 失败的任务和终止的任务尝试之间的区别？

> ID：12321006
> 
> 赞同：0
> 
> 时间：2012-09-07T15:21:47.490
> 
> 标签：mapreduce

失败的任务尝试是否引发未处理的异常？谁将终止被杀死的任务尝试？被杀死的任务尝试是否会引发任何异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T15:23:49.993

例如，如果 Hadoop 有资源，并且当前运行的 map 任务执行速度非常慢，Hadoop 将再次启动 map 任务 -> 如果正在运行的 map 任务有可能失败，它会尝试启动第二个实例任务（推测执行）。这使您有两个关于工作结果的选择。较早开始的地图任务最终将完成并且hadoop将杀死第二个地图任务（这将使您有一个被杀死的任务），因为不再需要它或者第一个任务将失败然后（希望）第二个一个会成功（这会让你有一个失败的任务）。至少这是我从 google-ing 中了解到的。这是书中此解释的链接： [Hadoop：推测执行](https://www.inkling.com/read/hadoop-definitive-guide-tom-white-3rd/chapter-6/task-execution)

希望我有所帮助！

干杯

# ruby-on-rails - Rails 3.2.8：ActionDispatch::Routing::RouteSet::Mapper，它存在吗？

> ID：12321013
> 
> 赞同：0
> 
> 时间：2012-09-07T15:22:35.790
> 
> 标签：ruby-on-rails, ruby, gem

我正在为 Comatose 开发一个 Rails 3.2.8 引擎，用于开发 Rails 引擎的一些练习。我遇到了一个奇怪的问题，我想知道是否还有其他人也遇到过。主要问题在于**ActionDispatch::Routing::RouteSet#eval_block**。当方法调用 Mapper.new 时，出现“参数数量错误（0 为 1）”的异常。这是当前定义：

```
def eval_block(block)
  if block.arity == 1
    raise "You are using the old router DSL which has been removed in Rails 3.1\. " <<
              "Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/"
  end
  mapper = Mapper.new(self)
  if default_scope
    mapper.with_default_scope(default_scope, &block)
  else
    mapper.instance_exec(&block)
  end
end 
```

从调试器断点来看，Mapper 是 ActionDispatch::Routing::RouteSet::Mapper，而不是 ActionDispatch::Routing::Mapper。但是，我在任何地方都找不到 ActionDispatch::Routing::RouteSet::Mapper 定义。

我不知道是否正在发生一些动态的 Ruby/Rails 魔术，其中 Mapper 实际上是由某个 gem 在 RouteSet 中定义的。我似乎无法追踪它，我已经在整个 gemset 中搜索了“Mapper”，但找不到任何东西。

实际上，我必须在我的代码中使用 test/dummy/config/initializer 中的初始化程序创建一个解决方法，以便 Mapper 完全合格。

```
::ActionDispatch::Routing::RouteSet.class_eval do
    def eval_block(block)
      if block.arity == 1
        raise "You are using the old router DSL which has been removed in Rails 3.1\. " <<
                  "Please check how to update your routes file at: http://www.engineyard.com/blog/2010/the-lowdown-on-routes-in-rails-3/"
      end
      mapper = ::ActionDispatch::Routing::Mapper.new(self)
      if default_scopeSo, 
        mapper.with_default_scope(default_scope, &block)
      else
        mapper.instance_exec(&block)
      end
    end
end 
```

我以前在其他项目中从未遇到过这个错误。这是我在框架内测试引擎的第一次尝试，但我之前在其他项目中使用过引擎。代码在 Rails 3.2.7 中看起来也一样。

有没有其他人遇到问题或者我做错了什么？我正在使用 Ruby 1.9.3-p194、Rails 3.2.8，当然还有很多 gem。我在完全更新的 Ubuntu 12.04 上，并使用 RVM。捆绑器中的宝石说我正在使用如下：

```
Using rake (0.9.2.2) 
Using RedCloth (4.2.9) 
Using i18n (0.6.1) 
Using multi_json (1.3.6) 
Using activesupport (3.2.8) 
Using builder (3.0.1) 
Using activemodel (3.2.8) 
Using erubis (2.7.0) 
Using journey (1.0.4) 
Using rack (1.4.1) 
Using rack-cache (1.2) 
Using rack-test (0.6.1) 
Using hike (1.2.1) 
Using tilt (1.3.3) 
Using sprockets (2.1.3) 
Using actionpack (3.2.8) 
Using mime-types (1.19) 
Using polyglot (0.3.3) 
Using treetop (1.4.10) 
Using mail (2.4.4) 
Using actionmailer (3.2.8) 
Using arel (3.0.2) 
Using tzinfo (0.3.33) 
Using activerecord (3.2.8) 
Using activeresource (3.2.8) 
Using acts_as_list (0.1.8) 
Using acts_as_tree (1.1.0) 
Using acts_as_versioned (0.2.3) 
Using bundler (1.2.0) 
Using cocaine (0.3.0) 
Using columnize (0.3.6) 
Using rack-ssl (1.3.2) 
Using json (1.7.5) 
Using rdoc (3.12) 
Using thor (0.16.0) 
Using railties (3.2.8) 
Using jquery-rails (2.1.1) 
Using rails (3.2.8) 
Using comatose (0.0.1) from source at . 
Using daemons (1.1.9) 
Using debugger-ruby_core_source (1.1.3) 
Using debugger-linecache (1.1.2) 
Using debugger (1.2.0) 
Using eventmachine (0.12.10) 
Using liquid (2.4.1) 
Using paperclip (3.1.4) 
Using responds_to_parent (1.1.0) 
Using sqlite3 (1.3.6) 
Using test-unit (2.5.2) 
Using thin (1.4.1) 
```

这是用 Rails 提出的问题吗？如果是，我在哪里做？对于我不理解的Ruby，这是一个被误解的范围规则吗？比如，为什么 Mapper 引用 ActionDispatch::Routing::RouteSet 模块中不存在的类而不是引用 ActionDispatch::Routing 模块中的 Mapper 类？

谢谢，-极地

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:33:55.903

我刚刚遇到了同样的问题。

就我而言，它是由具有以下代码的旧插件（savage-beast）引起的：

```
class ActionController::Routing::RouteSet::Mapper
  def from_plugin(name)
    eval File.read(File.join(RAILS_ROOT, "vendor/plugins/#{name}/routes.rb"))
  end
end 
```

这导致了问题。也许这会有所帮助。我认为问题的出现是因为旧的 RAILS_ROOT 而不是 Rails.root

# facebook - 无法从 URL 检索数据

> ID：12321015
> 
> 赞同：1
> 
> 时间：2012-09-07T15:22:39.330
> 
> 标签：facebook, debugging

我有很多使用相同 CMS 的网站，它们托管在 3 个单独的服务器中，只有其中一个服务器在检索任何 url 的标题、描述和图像时出现问题，并且在 FaceBook 调试器中我得到这个错误：`Could not retrieve data from URL.`

从之前的问题中，我了解到原因可能是**HTML 错误**，但正如我之前所说，在其他服务器上使用相同的 CMS 没有问题。您可以尝试[将此](http://www.shaharah.net/2010/news-10054.htm)URL 例如放在调试器中

此外，同一服务器上使用另一个 CMS 或只是 HTML 页面的其他网站也不会被检索。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:36:26.677

Apache 正在发送无效的内容类型字符串：（`Content-Type: text/html; charset=**DEFAULT**`在[W3C Validator](http://validator.w3.org/check?uri=http%3A%2F%2Fwww.shaharah.net%2F2010%2Fnews-10054.htm&charset=%28detect+automatically%29&doctype=Inline&group=0&user-agent=W3C_Validator%2F1.3)上检查）

[本文](http://www.w3.org/International/O-HTTP-charset.en.php)介绍了如何在您的服务器上进行设置。

# c++ - 为什么这种 int-to-binary 尝试在 16 之后失败，我该如何清理它？

> ID：12321017
> 
> 赞同：0
> 
> 时间：2012-09-06T15:42:33.217
> 
> 标签：c++, bit-manipulation

我需要这个函数来完成一些个人工作，虽然这样做通常是微不足道的，但我之前并没有真正玩过移位。我有以下代码，它试图将整数转换为无符号整数的向量，其中每个是 1 或 0（代表位）。我可以假设整数总是大于或等于 0。这是我的代码：

```
vector<unsigned int> toBinary(int x)
{
    stack<unsigned int> s;
    vector<unsigned int> ret_val;

    for (unsigned i = 0; i < sizeof(x); ++i)
    {
        int z = ((x >> i) & 1) ? 1 : 0;
        s.push(z);
    }

    unsigned num_bits = s.size();
    for (unsigned i = 0; i < num_bits; ++i)
    {
        ret_val.push_back(s.top());
        s.pop();
    }

    return ret_val;
} 
```

这适用于最大 16 的整数，然后失败。我使用堆栈来反转位的顺序，因此最重要的位在最终返回值的左侧。为什么这个坏了，我该如何清理它？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T17:19:21.003

x 是一个 int - 大小大概是 32 位，*即*4 个字节。sizeof x = 4，4 位允许数字 0..15

你想要的是 8*sizeof x，因为一个字节中有 8 位 - 尽管有更好的方法（见下文）。

向上清理：

1.  避免`using namespace std`，如果您必须使用它，则将其缩小到一次性使用（*例如* `using std::vector`）。这意味着用 来装饰东西`std::`，但为了可读性，这是值得的。

2.  使用`unsigned int`而不是`int`，明确说明您正在使用什么。

3.  返回一个向量`bool`似乎更有意义。

4.  无符号整数中的位数由`std::numeric_limits<unsigned int>::digits`( `#include <limits>`) 给出。

5.  您可以通过`std::reverse`在向量 ( `#include <algorithm>`) 上使用来轻松避免使用堆栈。

把它们放在一起，你的函数可能看起来像：

```
std::vector<bool> toBinary(unsigned int x)
{
    std::vector<bool> ret_val;

    for ( unsigned int z = x; z > 0; z /= 2 ) {

        bool r = ( ( z & 1 ) == 1 );
        ret_val.push_back(r);
    }

    int bits = std::numeric_limits<unsigned int>::digits;
    ret_val.resize(bits);

    std::reverse( ret_val.begin(), ret_val.end() );

    return ret_val;
} 
```

# sql-server - 有没有更好的方法来做到这一点？

> ID：12321021
> 
> 赞同：1
> 
> 时间：2012-09-07T15:22:51.780
> 
> 标签：sql-server, tsql

我的 SQL 有点生疏，只是好奇是否有更好的方法来执行此 WHERE 子句？假设有一种方法，我确信有。它的运行速度非常快，但我只是不喜欢它，想知道它是否可以改进。

```
SELECT DISTINCT p.firstname              ,
            p.middlename             ,
            p.lastname               ,
            p.gender                 ,
            p.dob                    ,
            p.id      AS patientid   ,
            pr.id     AS practiceid  ,
            pr.[name] AS practicename,
            pr.parentaco             ,
            pp.encounterdate
FROM            ((aco.patients_practices patients_practices
            LEFT OUTER JOIN aco.patients p
            ON              (
                             patients_practices.patientid = p.id
                            )
            )
            LEFT OUTER JOIN aco.practices pr
            ON              (
                             patients_practices.practiceid = pr.id
                            )
            )
            INNER JOIN aco.patientpreferences pp
            ON              (
                             pp.patientid = p.id
                            )
WHERE           (
                            pr.parentaco =
                            (SELECT parentaco
                            FROM    aco.practices
                            WHERE   master_companyid = 763
                            )
            OR              pr.id =
                            (SELECT parentaco
                            FROM    aco.practices
                            WHERE   master_companyid = 763
                            )
            )
AND             pp.encounterdate IS NOT NULL 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:33:02.943

您可以先从子查询中获取值并将其放入变量中。

```
DECLARE @P INT

SELECT @P = parentaco
FROM aco.practices
WHERE master_companyid = 763 
```

在查询中使用变量

```
WHERE (pr.parentaco = @P or pr.id = @P) AND
      pp.encounterdate IS NOT NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T17:25:57.223

由于在子句中引用它们的方式，`LEFT OUTER JOIN`s 被有效地转换为s。我想你会发现这在逻辑上是等价的：`INNER JOIN``WHERE`

```
select distinct p.firstname, p.middlename, p.lastname,
  p.gender, p.dob, p.id as patientid,
  pr.id as practiceid, pr.[name] as practicename, pr.parentaco,
  pp.encounterdate
  from aco.patients_practices as patients_practices inner join
    aco.patients as p on p.id = patients_practices.patientid inner join
    aco.practices as pr on pr.id = patients_practices.practiceid inner join
    aco.patientpreferences as pp on pp.patientid = p.id
  where pp.encounterdate is not null and
    ( pr.parentaco = ( select parentaco from aco.practices where master_companyid = 763 ) or
    pr.id = ( select parentaco from aco.practices where master_companyid = 763 ) ) 
```

关于`WHERE`子句中的重复子查询：查询优化器应该识别重复并相应地处理它。您可以通过检查执行计划来确认这一点。使用 Mikael Eriksson 的建议来捕获`parentaco`变量应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:34:10.323

为什么在 where 条件下两次使用相同的条件？您的意思是第二次使用不同的 ID 吗？

为什么不直接加入实践表，然后在没有子选择的情况下在那里做一个 where 条件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T16:50:07.073

这可能不是 100%，但希望能引导您进入正确的状态。

```
SELECT DISTINCT p.firstname          ,
            p.middlename             ,
            p.lastname               ,
            p.gender                 ,
            p.dob                    ,
            p.id      AS patientid   ,
            pr.id     AS practiceid  ,
            pr.[name] AS practicename,
            pr.parentaco             ,
            pp.encounterdate
FROM        aco.patients_practices pp
            LEFT OUTER JOIN aco.patients p
              ON  pp.patientid = p.id  
            LEFT OUTER JOIN aco.practices pr
              ON  pp.practiceid = pr.id
              AND ( pr.parentaco = pp.parentco or pr.id = pp.parentco )
WHERE    pp.encounterdate IS NOT NULL
         AND pp.master_companyid = 763 
```

# html - 在 Outlook 电子邮件中显示的 HTML 电子邮件中的额外空间

> ID：12321022
> 
> 赞同：0
> 
> 时间：2012-09-07T15:22:52.480
> 
> 标签：html, html-email, email-client

我创建了一个 html 电子邮件，它在所有浏览器客户端（如 hotmail 和 gmail）中看起来都很棒。在 Entourage 中也很有效。它唯一不能很好地工作的地方是 Outlook。

这是来自 Outlook 和其他电子邮件客户端的电子邮件的屏幕截图： [http ://www.theadamgrp.com/client-demos/vanguard/email-screenshot.png](http://www.theadamgrp.com/client-demos/vanguard/email-screenshot.png)

这是我的代码的链接： [http ://www.theadamgrp.com/client-demos/vanguard/email-04.html](http://www.theadamgrp.com/client-demos/vanguard/email-04.html)

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:13:57.687

尝试将此样式添加到您的单元格

```
border-collapse: collapse; 
```

# php - 从 PHP 调用 asp.net 网络服务

> ID：12321024
> 
> 赞同：1
> 
> 时间：2012-09-07T15:22:56.943
> 
> 标签：php, asp.net, web-services, soap, web

我制作了 ASP.NET Web 服务，其中包含一个名为 HelloWorld 的初始方法。我想使用 php 和以下代码访问上述方法：

```
$client = new SoapClient("http://localhost:4925/Service1.asmx?WSDL");

$result = $client->HelloWorld()->TestMethodResult;
echo $result; 
```

当我运行 php 脚本时，出现以下错误：

```
***Notice: Undefined property: stdClass::$TestMethodResult in C:\wamp\www\probe\servis.php on line 8*** 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:29:54.583

由于 HelloWorld 是您尝试调用的方法，请尝试：

```
$result = $client->__soapCall('HelloWord', $params); 
```

或者

```
$result = $client->HelloWorld($params); 
```

`$params`您需要为该方法发送的任何参数在哪里。

# java - import 不支持“as”属性

> ID：12321027
> 
> 赞同：0
> 
> 时间：2012-09-07T15:23:15.643
> 
> 标签：java, ant, build

我正在使用 Apache Ant 在 Ubuntu 虚拟机上构建一些东西。

当我做蚂蚁时，我收到以下错误：

```
Buidling failed:import does not support the "as" attribute 
```

我的java版本是1.7，ant也是1.7

有什么线索吗？百万感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:40:26.330

确保 javac 是 1.7 版`javac -version`，这就是解析`as`关键字的问题，而不是 java JVM 应用程序。Ubuntu 12.10 中的默认值仍然是 1.6，因此您需要手动安装 1.7 JDK，然后通过运行`sudo update-alternatives --config java`. 本页[描述](https://help.ubuntu.com/community/Java)了您可以在 Ubuntu 中运行的不同 JVM 以及如何选择一个。

# winapi - 将 exe 转换为 Metro App

> ID：12321028
> 
> 赞同：0
> 
> 时间：2012-09-07T15:23:15.943
> 
> 标签：winapi, microsoft-metro

我使用 Win32 C++ API 开发了一个应用程序（大约 2 年前，它适用于 XP、Vista 和 Windows 7）。对于 Windows 8，我希望在 Metro Style 中拥有相同的应用程序。

详细地说，我希望我的应用程序以 Metro App 风格运行，而不是回到桌面并从那里执行。

我在谷歌上搜索了很多，但找不到任何可以节省精力的东西。看来，我将不得不为 Metro 风格重新编写我的应用程序。

如果有任何设置或任何工具，我错过了，请建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:23:40.953

根据您的应用程序的功能及其要求，它可能需要大量重写。没有工具可以转换。开发、部署和 UI/UX 范式都与传统的 Win32/桌面应用程序有很大不同。您不能轻易地使用 Win32 应用程序并让它在基于触摸的 Modern UI/Metro shell 中运行，这有点刻意。

甚至您的 C++ 业务逻辑代码也可能需要重构，具体取决于它所做的事情，因为 Windows 8 Modern UI 应用程序比桌面应用程序更多地被沙盒[化](http://msdn.microsoft.com/en-US/library/windows/apps/br205757)。

关于如何使用 C++ 创建现代 UI 应用程序的文档没有 C#/XAML 和 JavaScript/HTML 那么多。在 MSDN 上的本[教程/演练](http://msdn.microsoft.com/en-us/library/windows/apps/hh465045.aspx)中有一个相当不错的过程概述（以及新的和不同的东西） 。

[这是](http://msdn.microsoft.com/en-US/library/windows/apps/hh699871)WinRT C++ 应用程序所需的 C++/CX（C++ 组件扩展）的语言参考。

老实说，根据您创建的内容以及可以重用的数量，切换平台可能更容易（例如切换到 C#/XAML）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:41:45.123

您也许可以重用一些业务逻辑，但整个 UI 将需要手动重写。Metro UI 是基于 xaml 或 html 的，因此如果您使用 WPF，您可能会获得部分重用，但否则无法将旧 UI 转换为 Metro。

# velocity - 在速度模板中创建对象

> ID：12321029
> 
> 赞同：6
> 
> 时间：2012-09-07T15:23:19.550
> 
> 标签：velocity

我已经看过这个问题，但它谈论的是生命射线速度，并且似乎可以访问我无法访问的这个“$portal”对象。

[在速度模板中创建对象](https://stackoverflow.com/questions/9826547/create-object-in-velocity-template)

具体来说，我正在尝试在模板中创建一个 Locale 对象，以将其传递给 $dateTool.format 调用，以获取特定语言的输出。

我无法创建语言环境对象并将其预先传递给模板，因为该代码可以调用各种模板，每个模板都可以使用不同的语言。

我试过了

```
#set($localeClass = $portal.getClass().forName("java.util.Locale"))
$localeClass.getName 
```

但这只是输出 '$localeClass.getName' （我不确定 $portal 是否是一些神奇的预设变量或其他东西）。

我也试过

```
#set($localeClass = java.util.Locale.class)
$localeClass.getName 
```

但是当我尝试处理模板时，这给了我一个运行时异常。

我在 Velocity 中看到了[ClassTool](http://velocity.apache.org/tools/devel/javadoc/org/apache/velocity/tools/generic/ClassTool.html)，但它不支持代码的反身执行。我想我可以尝试类似的东西`$classTool.inspect("java.util.Locale").getType.getConstructor([$classTool.inspect("java.util.String"),$classTool.inspect("java.util.String")]).newInstance(["es","ES"])`。

我会尝试一下，但与此同时，我会看看其他人是否有更好的主意。

**编辑**

自发布以来，我意识到velocity 有一个 ConversionTool（没有在他们的 GenericTool 概述页面上列出），它有一个我可以调用的 toLocale 函数。所以我可以使用

```
$dateTool.format('dd-MMM-yyyy', $date, $conversionTool.toLocale("es_ES")) 
```

但是我仍然很好奇是否有一种方法可以通过反射来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T09:36:47.143

你做得很好，但你应该使用`$localeClass.getName()`or`$localeClass.name`而不是`$localeClass.getName`. 请参阅 Velocity 用户指南中的[属性查找规则](http://velocity.apache.org/engine/devel/user-guide.html#propertylookuprules)。

这个：

```
#set($localeClass = $portal.getClass().forName("java.util.Locale"))
$localeClass.getName() 
```

为我正确输出字符串“java.util.Locale”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T19:39:33.377

据我了解，您也可以使用

```
$localeUtil.fromLanguageId("es_ES") 
```

用于在 Velocity 模板中获取语言环境。

至于我，我最近也尝试使用反射来获取语言环境，但没有成功。所以我很好奇它是否也有可能。

# excel - 我正在尝试复制工作表 1 中的第 2 行并将其粘贴到下一个空行的工作表 2 中。

> ID：12321031
> 
> 赞同：2
> 
> 时间：2012-09-07T15:23:26.943
> 
> 标签：excel, vba

我正在尝试复制工作表 1 中的第 2 行并将其粘贴到下一个空行的工作表 2 中。然后我更改第 2 行中的数据并再次运行宏以将此数据添加到工作表 2 的下一行。

这就是我所拥有的，但它会覆盖表 2 中的数据：

```
Sub transfer()

Dim LastRow As Integer

'Where is the last cell with data?
LastRow = Worksheets("Database").Range("A65536").End(xlUp).Row

'Transfer data
Sheets("Shadow").Range("A2:N2").Copy Worksheets("Database").Cells(LastRow + 1, "A")
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:51:47.477

假设“阴影”是 Sheet1 而“数据库”是 Sheet2，这似乎对我有用。

### 编辑

根据我们下面的对话，如果问题与参考有关，您始终可以粘贴确切的值而不是参考。尝试这个：

```
Sub transfer()

Dim LastRow As Integer

'Where is the last cell with data?
LastRow = Worksheets("Database").Range("A65536").End(xlUp).Row

'Transfer data
Sheets("Shadow").Range("A2:N2").Copy
Worksheets("Database").Range("A" & LastRow + 1 & ":N" & LastRow + 1).PasteSpecial _
    Paste:=xlPasteValues
End Sub 
```

# c# - 以下代码是否存在内存泄漏？

> ID：12321035
> 
> 赞同：0
> 
> 时间：2012-09-07T15:23:45.663
> 
> 标签：c#

我有以下代码：

```
 Dictionary<string, Setup> dictSetups = new Dictionary<string, Setup>();
    Setup setup1 = new Setup();
    dictSetups.Add("setup1", setup1);

    using (MySetupForm myForm = new MySetupForm())
    {
        myForm.Setup = dictSetups["setup1"];
        if (myForm.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        {
            dictSetups["setup1"] = myForm.Setup;
        }                
    } 
```

这是`MySetupForm`：

```
 public partial class MySetupForm : Form
    {
        public MySetupForm()
        {
            InitializeComponent();
        }

        public Setup Setup { get; set; }
    } 
```

在上面的代码中，我传递了`dictSetups["setup1"]`to的引用，`MySetupForm`然后显示了表单。

如果对话结果是`OK`我正在更新我的字典中的引用，我的问题是我什么时候不再使用该方法`MySetupForm myForm`，但是

`dictSetups["setup1"]` 持有来自 的引用`myForm.Setup;`，所以会不会是内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:26:17.743

通过您发布的代码几乎不可能确定。

您应该掌握一个内存分析工具并分析您的应用程序。这是了解是否存在内存泄漏、它在哪里以及修复它的最佳方法的唯一真正方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:31:46.657

这里没有内存泄漏。

当您说`dictSetups["setup1"] = myForm.Setup;`您正在获取正在引用的`Setup`对象并将对该对象`myForm`的引用存储*在*字典中时。它没有保留对`myForm`. 需要有一个 lambda 或类似的东西来生成一个闭包以实现这一点。

内存泄漏是指对象超出范围，从而阻止释放它的内存，在必须手动释放内存的对象上。这在 C# 中几乎是不可能的，因为垃圾收集器负责为您回收内存。如果程序在不再需要时保留对具有大量内存占用的对象的引用，则程序可能会降低内存效率（我们无法判断您是否在代码中执行此操作；我们不知道以后实际需要引用哪些对象，不需要引用哪些对象），但这实际上并不是内存泄漏。

虽然在 C# 中*可能*会导致内存泄漏，但这*真的*很难。实际上，您必须积极尝试使其发生在几个狭窄范围之外。如果您正在与非托管代码进行互操作，那么您可能需要处理该代码的内存管理，并且如果您处于不安全的块中，您可能会导致各种破坏。除此之外，您实际上无法做太多事情来导致内存泄漏。您通常不能在 C# 中分配垃圾收集器无法回收的内存，而且我知道没有任何错误会阻止 GC 在应该回收内存时进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:27:15.483

我会说，是的。**在提供的代码的上下文中**，这存在内存泄漏。我的意思是这`Dictionary<string, Setup> dictSetups` 是全局变量，它在应用程序工作流程中保持其恒定的生命周期。

一般来说，仅从提供的代码，从*程序*上下文的角度来看，很难说。

# ios - iOS - UITextView 中的换行符

> ID：12321053
> 
> 赞同：0
> 
> 时间：2012-09-07T15:24:44.727
> 
> 标签：ios, uitextview, newline

从数据文件中读取文本。我怎样才能让换行符起作用？我试过\n，但它只是将“\n”放入字符串中，而不是创建一个新行。

编辑：文本来自网络服务，该服务在文本中没有真正的换行符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:56:16.307

我不明白你的问题，这样做我得到了这个结果：

创建测试文件的脚本：

```
#!/bin/sh
(cat <<- EOF
i am
a
test file
EOF
) > /tmp/test.txt 
```

目标c代码：

```
NSString *str = [NSString stringWithContentsOfFile:@"/tmp/test.txt" encoding:NSASCIIStringEncoding error:nil];
NSLog(@"%@", str); 
```

我的输出：

```
i am
a
test file 
```

我希望你能有用。

# java - Java：抛出异常而不是特定异常的原因是什么？

> ID：12321056
> 
> 赞同：4
> 
> 时间：2012-09-07T15:25:02.247
> 
> 标签：java, design-patterns, exception-handling

您是否有理由要这样做：

```
void foo() throws Exception
{
    // Do something potentially exceptional
} 
```

而不是抛出现有的或自定义的异常？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T15:28:17.550

我可能会想到两种情况——我能想到的第一个类似情况是在实施时`finalize()`，你必须抛出`Throwable`：

```
@Override
protected void finalize() throws Throwable {
    super.finalize();
} 
```

...尽管请记住，有些人认为应该不鼓励使用 finalize 本身。

潜在的第二种情况是当使用一个（写得不好的）库时，它的方法可能会抛出一个`Exception`.

不过就个人而言，如果那是我，我很可能会在那时和那里将它包装在 RuntimeException 中：

```
public void doSomething() {
    try {
        int x = libraryThing.badMethod(); //Library method that throws "Exception"
    }
    catch(Exception ex) {
        throw new RuntimeException("Couldn't do something", ex);
    }
} 
```

但是，在这种情况下，构造函数的第二个参数`RuntimeException`很重要，因为如果抛出它，则会将堆栈跟踪上的原始异常保留为 ("Caused by: x")。当然，如果你能找到一个更具体的 RuntimeException 子类，你可以保证它在那个上下文中是相关的（`IllegalArgumentException`例如），那么使用它会更好。

然而，就普通代码而言，不——我认为它几乎总是一种反模式（通常是由于懒惰引起的！）

作为一个侧面，抛出 a`RuntimeException`并不是那么糟糕 - 它仍然非常不具体，但至少不会强制调用者明确地捕获所有内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:28:19.983

我不会这样做的。它提供了关于所发生事件的最少信息。

我认为当前的最佳做法是更喜欢未经检查的异常（这是 C# 方式）。foo() 方法将捕获已检查的异常并将它们包装在 RuntimeException 中。

我要么拼出异常，将它们包装在更特定于业务的自定义异常中，要么包装 RuntimeException。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T15:30:03.833

它允许该方法抛出任意异常。

这可以在框架上下文中找到，其中任意代码在具有已知签名的方法中运行。在那种情况下它是否“好”......嗯。我宁愿看到特定于框架的或运行时异常。

除此之外，它通常是一种反模式，IMO。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-07T15:31:49.423

我经常在我的测试方法中这样做。

```
@Test
public void testSOmething() throws Exception { 
```

这是我的标准签名，用于不专门测试是否抛出异常的单元测试（这是大多数测试。）

在这些测试之外，我不在乎我的测试可能会抛出什么异常，因为在这些情况下抛出异常代表被测方法的失败。

不过，我从不在生产代码中这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-07T15:29:29.000

您可以声明`throws Exception`实际列表是否很长且不有趣。例如，当通过反射调用方法时，这可能会导致很多异常。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-07T15:34:45.840

您可能正在实现 Java 自己的[Callable](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Callable.html)接口！大概就是这样总结。如果您提供了一些上层结构，其他人的代码可以在其中运行，但您不想限制他们被迫捕获内部的任何和所有检查异常。有人可以断言，这不是您自己的库本身的糟糕设计，而是首先检查受检异常的糟糕设计的危险（但我们将有一场圣战，而不是一个 SO 问题。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-07T15:28:08.353

通常，这意味着代码设计不佳或底层库设计不佳。如果您发现自己无缘无故地声明“抛出异常” - 请考虑改为抛出 RuntimeException。特别是在库代码中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-07T16:01:59.107

一般来说，我发现“抛出异常”对于在接口中声明的方法是可以接受的，这些方法将由其他人实现并且可以有非常不同的实现（你不想限制它们可能抛出的可能实现）。

当一个方法抛出大量异常时，我发现它也是可以接受的。

我不会认为它是一种反模式，而是出于懒惰而经常使用的成语。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-07T16:48:01.660

根据业务规则定义您自己的例外

```
public void doSomething() {
    try {
        int x = 10/0; //Library method that throws "Exception"
    }
    catch(Exception ex) {
        throw new Exception("this doesn;t work.there is exception", ex);
    }
} 
```

这会覆盖 Exception 方法；

```
class Exception
{
   Exception()
   {
   }

   Exception(String msg)
   {
      this.msg=msg;      
   }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-07T16:58:50.220

它通常在测试/快速而肮脏的代码中完成，这是非常合理的。

有时会在`throws`列表冗长乏味时完成 - 半合理

一些开发人员/项目对所有事情都这样做，因为他们对“已检查”异常有不同的理念，如果他们不打算与“世界其他地区”。

# javascript - 使用 Ember 的 Web 应用架构。动画逻辑应该放在哪里？

> ID：12321057
> 
> 赞同：1
> 
> 时间：2012-09-07T15:25:06.177
> 
> 标签：javascript, architecture, web, ember.js

我正在使用 Ember 构建一个 Web 应用程序。拖放（以及其他动画，例如自动滑动）是用户如何与应用交互的重要部分。

我已经决定所有动画逻辑都将在 Ember mixin 类中单独放置，请参阅此博客：

[http://www.dynopia.com/index.php/en/blog/article/771/ember-js-animations-with-jquery-animate](http://www.dynopia.com/index.php/en/blog/article/771/ember-js-animations-with-jquery-animate)

但是，我有点困惑每个可拖动元素是否应该有两个视图，一个用于渲染元素，一个用于处理动画逻辑？

此外，动画完成后，元素的当前css属性应该在其对应的模型中更新。我可以通过视图和模型之间的简单两种方式绑定来解决这个问题，即：

```
/** element view **/
App.elemOneView = Ember.View.create({
 name: 'element One',
 cssAttr: {},
 ...

});

/** element controller**/
App.elemController = Ember.ArrayController.create({
 content: [],
  ....

});

/** element model **/
App.elemOneModel = Ember.Model.create({
 name: 'element one',
 cssAttrBinding: 'App.elemOneView.cssAttr'
 ...
}); 
```

我的问题是它不赞成该模型直接绑定到视图，即使它们之间有一个控制器层？我应该将视图和模型都同步到中间对象吗？

注意：目前，我计划为页面上出现的每个元素声明视图（用于动画逻辑）和模型（用于存储 css 属性等），因此会有很多视图和模型。我应该问这是否也很糟糕？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:29:15.850

我不认为您正在做的事情是一件坏事，请记住，在 javascript 应用程序中，我们已经看到 MVVM 的流行度上升，请注意最后两个字母 - 'ViewModel'。

出于这个原因，我不认为这种关系是坏的。但肯定有人可以说不一样。

# java - Java：如何在char之前返回字符串

> ID：12321060
> 
> 赞同：1
> 
> 时间：2012-09-07T15:25:13.540
> 
> 标签：java, string

我有以下字符串

```
String name = "John - Paul" 
```

所以我想要做的是检索`John`（所有之前`-`）。这就是我正在尝试的，但我无法从之前的`-`唯一之后检索

```
String parseName = name.substring(name.indexOf(" - ", -1), name.indexOf(" - ", 0)); 
```

你是怎么做到的，有人可以解释一下吗（注意：我不想使用正则表达式）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:26:12.837

您正在混合开始和结束索引 - 您需要从第一个字符（索引 = 0）到索引的子字符串`" - "`：

```
String parseName = name.substring(0, name.indexOf(" - ")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:27:24.767

String.substring 方法的参数是字符串的开头和结尾。因此，当第一个为 0 时，您从头开始选择。

```
String parseName = name.substring(0, name.indexOf(" - ")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:58:40.297

我感谢您对*(注意：我不想使用正则表达式)*的评论，但我仍然会使用 split() 来写这个 - 尽管它需要一个正则表达式字符串作为它的参数 - 因为这就是它的用途。

```
String name = "John - Paul";
String firstName = name.split(" - ")[0]; 
```

而且，在这种情况下，正则表达式并不比 indexOf() 的参数复杂。

使用 substring() 的答案仍然完全有效。

# c# - 在 GridView 下对齐 Asp.net 按钮

> ID：12321063
> 
> 赞同：1
> 
> 时间：2012-09-07T15:25:44.203
> 
> 标签：c#, asp.net, user-interface

我有一个 GridView，下面有三个按钮。我试图弄清楚如何对齐它们，使第一个按钮的左边缘与 GridView 的左边缘对齐，第二个按钮在 GridView 下方居中，第三个按钮的右边缘与 GridView 的右边缘对齐. 如果 GridView 的宽度扩大，我希望按钮与 GridView 保持对齐。现在，按钮水平“聚集”在一起，向左对齐。这是我想要的粗略草图。

![.](../Images/d6422a443dbf734b01dd539e3ad8d988.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:33:04.413

有很多方法可以做到这一点。您可以将按钮放在网格的页脚中，或者在网格下方放置一个与网格宽度相同的大 div 或表格。

我会将它们放在页脚模板中，如下所示：（伪）

```
div width 100%
   div  33%
     button 1 (align it to left)
   div 33%
     button 2 (align it to center
   div 33%
     button 3 (align it to right 
```

如果您知道它们，您可以使用固定尺寸

**编辑：** 刚刚注意到网格下的大间隙，你可以这样说

```
div 100%
   grid  (assuming 100% also)
   div  (100%)
     and div 33% with buttons go here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:33:53.190

您可以尝试使用此代码

```
<FooterTemplate>
  <table>
      <tr>
          <td class=""><asp:Button ID="Btn1" runat="server" Text="Btn1"/>
          </td> 
          <td class=""><asp:Button ID="Btn2" runat="server" Text="Btn2"/>
          </td> 
          <td class=""><asp:Button ID="Btn3" runat="server" Text="Btn3"/>
          </td> 
      </tr>
  </table>
</FooterTemplate> 
```

您可以将样式属性添加到表格单元格

```
text-align: center;

text-align: left;

text-align: right; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:52:03.673

如何将 Gridview 和 Buttons 放在表格的单独行中？

这是一个内联样式的示例：

```
<table>
    <tr>
        <td colspan="3" style="width: 100%">
            <asp:GridView ID="GridView1" ShowHeader="false">
                 ...
            </asp:GridView>
        </td>
    </tr>
    <tr>
        <td style="width: 33%; text-align: left">
            <asp:Button ID="button1" runat="server" />
        </td>
        <td style="width: 33%; text-align: center">
            <asp:Button ID="button2" runat="server" />
        </td>
         <td style="width: 33%; text-right">
            <asp:Button ID="button3" runat="server" />
        </td>
    </tr>
</table> 
```

# python - Django 与 Heroku 上的 PostgreSQL 应用程序不同步

> ID：12321064
> 
> 赞同：5
> 
> 时间：2012-09-07T15:25:45.170
> 
> 标签：python, django, postgresql, heroku

我正在尝试按照以下教程在 Heroku 上运行 Django：

[Heroku 上的 Django 入门](https://devcenter.heroku.com/articles/django)

在我进入 syncbd 部分之前，一切都运行良好：

[同步数据库](https://devcenter.heroku.com/articles/django#syncing-the-database)

当我运行:`heroku run python manage.py syncdb`时，我收到以下错误：

```
psycopg2.OperationalError: could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"? 
```

我目前正在使用 Homebrew 的 PostgreSQL，它运行良好：

```
LOG:  database system is ready to accept connections
LOG: autovacuum launcher started 
```

应用服务器也在本地运行：

```
Validating models...

0 errors found
Django version 1.4.1, using settings 'hellodjango.settings'
Development server is running at http://127.0.0.1:8000/
Quit the server with CONTROL-C. 
```

我正在使用 Mac OS 10.7。

我部署到 Heroku 的代码在这里可用：

[链接到我的代码](https://dl.dropbox.com/u/2490888/heroku.zip)

我已经尝试了很多可能的解决方案，例如：

[http://jeffammons.net/2011/09/fixing-postgres-on-mac-10-7-tiger-for-django/](http://jeffammons.net/2011/09/fixing-postgres-on-mac-10-7-tiger-for-django/)

但似乎没有任何效果。

编辑：

环顾四周，我找到了这段代码，并将其添加到 settings.py 文件中，它似乎解决了我的问题：

```
# Register database schemes in URLs.
urlparse.uses_netloc.append('postgres')
urlparse.uses_netloc.append('mysql')

try:
    if 'DATABASES' not in locals():
        DATABASES = {}

    if 'DATABASE_URL' in os.environ:
        url = urlparse.urlparse(os.environ['DATABASE_URL'])

        # Ensure default database exists.
        DATABASES['default'] = DATABASES.get('default', {})

        # Update with environment configuration.
        DATABASES['default'].update({
            'NAME': url.path[1:],
            'USER': url.username,
            'PASSWORD': url.password,
            'HOST': url.hostname,
            'PORT': url.port,
        })
        if url.scheme == 'postgres':
            DATABASES['default']['ENGINE'] = 'django.db.backends.postgresql_psycopg2'

        if url.scheme == 'mysql':
            DATABASES['default']['ENGINE'] = 'django.db.backends.mysql'
except Exception:
    print 'Unexpected error:', sys.exc_info() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T18:18:11.403

在您[链接](https://dl.dropbox.com/u/2490888/heroku.zip)`settings.py`到的原始代码中，您的设置似乎有两个相互矛盾的声明：`DATABASES`

1) 第 3 行：

```
DATABASES = {'default': dj_database_url.config(default='postgres://localhost')} 
```

2）第16行：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'traineeworld',                      # Or path to database file if using sqlite3.
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

3）此外，您最新编辑的附加代码看起来像是另一种指定连接参数的方法，这可能再次否定先前声明的效果。

这些方法并不意味着相互叠加。您只想选择一个。

此外，从技术上讲，作为与 db 服务器的客户端连接的发起者，您应该**知道**服务器是通过 TCP（在这种情况下是其主机名或 IP 地址加上端口）还是通过Unix 域套接字文件，在这种情况下，它的完整目录路径（以斜杠开头）。在这两种情况下，这都`HOST`属于连接参数的一部分。

Postgres 为所有这些都提供了默认值，但是一旦您混合和匹配来自不同来源的不同软件部分，这些默认值就不再有帮助，并且给出明确的值成为一种要求。

当对socket的路径有疑问时，在`psql`以postgres用户连接时，可以通过SQL命令获取该路径：

```
SHOW unix_socket_directory; 
```

此设置也存在于服务器端`postgresql.conf`配置文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-10T23:56:18.013

我刚刚使用 posgresql 在 Heroku 中部署了 Django 应用程序，这是我的代码，它运行良好，希望对您有所帮助：

要求.txt

```
Django==1.7.4
dj-database-url==0.3.0
dj-static==0.0.6
gunicorn==19.2.1
psycopg2==2.6
six==1.9.0
static3==0.5.1
wsgiref==0.1.2 
```

wsgi.py

```
import os
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "<PROJECT_NAME>.settings")

from django.core.wsgi import get_wsgi_application
from dj_static import Cling

application = Cling(get_wsgi_application()) 
```

档案

```
web: gunicorn <PROJECT_NAME>.wsgi 
```

确保你的 Heroku 上有 Postgres：

```
heroku addons:add heroku-postgresql:dev 
```

找出数据库 url 环境变量。它看起来像这样：HEROKU_POSTGRESQL__URL

```
heroku config | grep POSTGRESQL 
```

设置.py

```
import dj_database_url
POSTGRES_URL = "HEROKU_POSTGRESQL_<DB_NAME>_URL"
DATABASES = {'default': dj_database_url.config(default=os.environ[POSTGRES_URL])}

# Honor the 'X-Forwarded-Proto' header for request.is_secure()
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')

# Allow all host headers
ALLOWED_HOSTS = ['*']

# Static asset configuration
import os
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
STATIC_ROOT = 'staticfiles'
STATIC_URL = '/static/'

STATICFILES_DIRS = (
    os.path.join(BASE_DIR, 'static'),
) 
```

之后，我只是将所有内容推送到主服务器并运行 syncdb

```
heroku run python manage.py syncdb 
```

这可能[对 Heroku 上的 Django 入门](https://devcenter.heroku.com/articles/getting-started-with-django)很有帮助。让我知道我是否有任何问题或您是否需要其他东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:41:19.497

您可能没有将 PORT 加载到数据库中。加载数据库连接的代码是什么样的？

# c# - 创建唯一的 URL 安全哈希

> ID：12321069
> 
> 赞同：1
> 
> 时间：2012-09-07T15:25:55.803
> 
> 标签：c#, encryption, hash

我想散列/编码一个唯一的整数（数据库 ID）来创建一个类似的唯一字符串。

它需要满足以下要求：

1.  必须以字母或数字开头，并且只能包含字母和数字。
2.  容器名称中的所有字母都必须小写。
3.  长度必须为 3 到 63 个字符（尽管越短越好）

结果不需要是可逆的，只是可重复的 - 所以单向哈希就可以了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:30:36.570

一个简单的解决方案是 base 36 编码。输出将是一到六个字符之间的字符串。

```
public static string EncodeBase36(int i)
{
  Contract.Requires<ArgumentException>(i>=0);
  //Base conversion
  string s="";
  while(i!=0)
  {
    int digit = i % 36;
    i/=36;
    if(digit<10)
      s=((char)('0'+digit)).ToString()+s;
    else
      s=((char)('a'+digit-10)).ToString()+s;
  }
  // Enforce minimum length
  while(s.Length<3)
  {
    s = "0" + s;
  }
  return s;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:36:27.313

为什么不能使用 Class 使用 base 64 编码的 MD5 或使用 Class 的[SHA1](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1cryptoserviceprovider.aspx)[`MD5CryptoServiceProvider`是否](http://msdn.microsoft.com/en-us/library/system.security.cryptography.md5cryptoserviceprovider.aspx)有原因？我不知道基于 36 的密码分析，但我猜想 MD5 或 SHA1 的碰撞率可能更好。[`SHA1CryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1cryptoserviceprovider.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:25:36.327

如果您对可逆（如 Base36）感到满意，那么已经内置了 Base16（十六进制）格式，这可能也可以稍微隐藏普通人的数字：`String.Format("{0:x}", 1235)`或`12345.ToString("x")`

# c# - 如何为我的列表视图中的第一个项目设置不同的样式

> ID：12321070
> 
> 赞同：0
> 
> 时间：2012-09-07T15:25:55.577
> 
> 标签：c#, listview

我有一个绑定到列表视图的新闻列表。我需要让头条新闻的风格与其他故事不同。它的风格非常不同，所以我真的不想在一个 div 上隐藏做可见 = false 然后让另一个 div 以不同的方式设置其他的样式。

真的，我想我想要一个自定义的第一个模板。我只有 4.5 岁，拥有所有新模型绑定等。但我想不出最好的方法。建议我该怎么做？谢谢

代码更新：

我要问的是我怎样才能去做这样的事情，或者，更好的事情？

```
<listview>

  <FirstItemTemplate>

    Lots of text
    Big Image / maybe a video

  <FirstItemTemplate>
  <ItemTemplate>

     Summary
     thumbnail
     tagged caterogires

  </ItemTemplate>
</listitem> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:44:16.137

最干净的方法是为此使用 CSS。`li`您的列表视图在页面上呈现为一堆。假设您的`listview`渲染为：

```
​&lt;ul id="someid">
 <li> one </li>
 <li>more </li>
 <li>more </li>
 <li>more </li>
</ul> 
```

您可以创建以下 CSS 规则：

```
#someid li:nth-child(1){
    color:red;
    height:50px;
    /*or whatever style you need */   
} 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:27:56.207

我不知道我是否对你有好处，但也许它就像

```
li>element 
```

在你的 CSS

# python - 通过 os.system() 杀死在进程中启动的脚本

> ID：12321077
> 
> 赞同：5
> 
> 时间：2012-09-07T15:26:18.103
> 
> 标签：python, process, os.system

我有一个启动多个进程的 python 脚本。每个进程基本上只是调用一个 shell 脚本：

```
from multiprocessing import Process
import os
import logging

def thread_method(n = 4):
    global logger
    command = "~/Scripts/run.sh " + str(n) + " >> /var/log/mylog.log"
    if (debug): logger.debug(command)
    os.system(command) 
```

我启动了其中几个线程，这些线程旨在在后台运行。我想在这些线程上有一个超时，这样如果超过超时，它们就会被杀死：

```
t = []
for x in range(10):
    try:
        t.append(Process(target=thread_method, args=(x,) ) )
        t[-1].start()
    except Exception as e:
        logger.error("Error: unable to start thread")
        logger.error("Error message: " + str(e))
logger.info("Waiting up to 60 seconds to allow threads to finish")
t[0].join(60)
for n in range(len(t)):
    if t[n].is_alive():
    logger.info(str(n) + " is still alive after 60 seconds, forcibly terminating")
     t[n].terminate() 
```

问题是在进程线程上调用 terminate() 并不会终止启动的 run.sh 脚本——它会继续在后台运行，直到我从命令行强制终止它，或者它在内部完成。有没有办法让终止也杀死由 os.system() 创建的子shell？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:29:38.550

您应该使用一个事件来通知工作人员终止，使用`subprocess`模块运行子进程，然后使用`Popen.terminate()`. 调用`Process.terminate()`将不允许它的工作人员进行清理。请[参阅`Process.terminate()`](http://docs.python.org/library/multiprocessing.html#multiprocessing.Process.terminate).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:34:24.907

在 Python 3.3 中，子进程模块支持超时：[http ://docs.python.org/dev/library/subprocess.html](http://docs.python.org/dev/library/subprocess.html)

有关 Python 2.x 的其他解决方案，请查看此线程：[Using module 'subprocess' with timeout](https://stackoverflow.com/questions/1191374/subprocess-with-timeout)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T15:36:56.407

改为使用[`subprocess`](http://docs.python.org/library/subprocess.html#replacing-os-system)，其对象有一个明确的[`terminate()`方法。](http://docs.python.org/library/subprocess.html#subprocess.Popen.terminate)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T16:57:23.827

基于[停止在 Python 中读取进程输出而不挂起？](https://stackoverflow.com/a/4418891/4279)：

```
import os
import time
from subprocess import Popen

def start_process(n, stdout):
    # no need for `global logger` you don't assign to it
    command = [os.path.expanduser("~/Scripts/run.sh"), str(n)]
    logger.debug(command) # no need for if(debug); set logging level instead
    return Popen(command, stdout=stdout) # run directly

# no need to use threads; Popen is asynchronous 
with open('/tmp/scripts_output.txt') as file:
    processes = [start_process(i, file) for i in range(10)]

    # wait at most timeout seconds for the processes to complete
    # you could use p.wait() and signal.alarm or threading.Timer instead
    endtime = time.time() + timeout
    while any(p.poll() is None for p in processes) and time.time() < endtime:
        time.sleep(.04)

    # terminate unfinished processes
    for p in processes:
        if p.poll() is None:
            p.terminate()
            p.wait() # blocks if `kill pid` is ignored 
```

`p.wait(timeout)`如果可用，请使用。

# sql - 在这种情况下是否应该组合 SQL 命令

> ID：12321080
> 
> 赞同：1
> 
> 时间：2012-09-07T15:26:29.323
> 
> 标签：sql, c#-4.0

我有以下 c# 代码：

基本上我从 TableA/Database1 中选择一行并将其插入到 TableA/Database2 中。

然后我再次打开连接并从 TableB/Database1 中选择多行（使用从 TableA/Database1 检索到的 newID）并插入 TableB/Database2。

我的问题是这样做的正确方法吗？还是应该将这些结合起来？如果这些应该结合起来，任何人都可以告诉我实现这一目标的最佳方法吗？

```
int newID = 0;
using (var con1 = new SqlConnection(conString1))
using (var con2 = new SqlConnection(conString2))
{
    con1.Open();
    con2.Open();
    using (var selectCommand = new SqlCommand(sqlSelect, con1))
    {
        using (var reader = selectCommand.ExecuteReader())
        {
            try
            {
                if (reader != null)
                    if (reader.Read())
                    {
                        using (var insertCommand = new SqlCommand(sqlInsert, conTarget))
                        {
                            for (int i = 0; i < reader.FieldCount; i++)
                            {
                                insertCommand.Parameters.AddWithValue(
                                    "@" + reader.GetName(i), reader[i]);
                            }
                            newID = (int)insertCommand.ExecuteScalar();
                        }
                    }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            finally
            {
                reader.Close();
            }
        }
    }
} 
```

我将 newID 作为选择示例之一的值传递：

`Select Id, student as newID, Class from Student where class = 10`

```
using (var con1 = new SqlConnection(ConString1))
{
    con1.Open();               
    var cmd = new SqlCommand(query , con1);
    var reader = cmd.ExecuteReader();

    using (var con2 = new SqlConnection(conString2))
    {
        con2.Open();

        using (var sbc = new SqlBulkCopy(conString2))
        {
            sbc.BulkCopyTimeout = 2000;
            sbc.DestinationTableName = "student";
            try
            {
                if (reader != null) 
                    sbc.WriteToServer(reader);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            finally
            {                            
                reader.Close();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:34:09.080

我会做的是这样的：

1.  打开 connection1 并从第一个数据库中选择您需要的所有数据。将此数据存储在某个对象中。
2.  打开连接 2 并根据存储在步骤 1 中创建的对象中的值更新第二个数据库。

这将使您能够对每个数据库使用一个连接并完成与上面所做的相同的事情。

如果您需要进一步的帮助，请告诉我。

# css - 在实现手风琴以动态加载 div 时遇到问题

> ID：12321082
> 
> 赞同：0
> 
> 时间：2012-09-07T15:26:34.943
> 
> 标签：css, jquery

我正在实现用于动态加载 div 的手风琴。问题是具有此脚本和 html 编码的脚本文件是异步加载的。

```
 $("#leftNavBusinessCounts").append('<div class="SearchDetails"><strong> One-Stop Services  </strong><br></br>View Centers by specific services.</div>');
        $("#leftNavBusinessCounts").append('<div class="sliding-drawer one-stop-details"><h2>Business Services</h2><div>');
        $(xml).find('FilterSection').eq(2).find("FilterItem").each(function() {
             $("#leftNavBusinessCounts").append('<div>HI</div>');
          });
        $("#leftNavBusinessCounts").append('</div></div>');//this is closing even before the <div>HI</div> is loaded ,so its outside. 
```

![在此处输入图像描述](../Images/9a99cc83762d838b12720cf81bfc49a7.png)

正如您在图像中看到的，这些值在手风琴之外，当我打开和关闭手风琴时它是空的。问题是：

萤火虫代码就像![在此处输入图像描述](../Images/afe27d9c4568321df236d5cda46d768d.png)

所以我不确定 div 之前是如何关闭的。请查看我正在使用的 jquery 脚本和 css：

```
<style type="text/css">
    .one-stop-details h2 { 
        display: block; 
        padding: 10px 0px 10px 30px; 
        background-image: url('/COSImages/expanding_section_background_closed.png'); 
        background-position: right; 
        border: 2px solid #ededed; 
        -moz-border-radius: 8px; 
        border-radius: 8px; 
        cursor: pointer; 
        margin: 0px;
    }

    div.sliding-drawer { 
        margin: 10px 0px 10px 0px; 
    }

    .sliding-drawer div {
         display: none; 
         padding: 5px;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        $('.sliding-drawer h2').click(function () {
            $(this).parent().children('.sliding-drawer div').slideToggle('slow');
            if ($(this).css("background-image").indexOf('/COSImages/expanding_section_background_closed.png') == -1) {
                $(this).css("background-image", "url('/COSImages/expanding_section_background_closed.png')");
            }
            else {
                $(this).css("background-image", "url('/COSImages/expanding_section_background_open.png')");
            }
        });
    });

</script> 
```

我错过了什么重要的东西吗？谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-07T15:31:22.500

为动态生成的元素尝试[live()事件](http://api.jquery.com/live/)`click`

```
$('.sliding-drawer h2').live('click',function () { 
```

# php - PHP 等待 PDF 被创建然后通过邮件发送？

> ID：12321083
> 
> 赞同：4
> 
> 时间：2012-09-07T15:26:35.393
> 
> 标签：php, jquery, phpmailer, delayed-execution

我编写了这个脚本，向客户发送他们的订单收据，但它有一个问题：

**它不会等待 PDF 脚本。**

所以它只需要 PDF 脚本，并在 PDF 脚本仍在处理 PDF 时开始执行它并发送邮件。我确信有一种方法可以延迟电子邮件脚本，但会使事情变得更复杂：

**整个 order.php 使用 jquery ajax 调用执行，脚本将等待 php 完成，然后报告浏览器请求成功。所以它可能会等待超过五分钟，而客户会想知道为什么要花这么长时间。**

所以我需要它等待 PDF 被创建然后发送邮件，但它不应该让客户等待。

这是我的代码：

```
<?php 
    $addid = "orderid.txt";
    $current = file_get_contents($addid) + 1;
    echo $current;
    file_put_contents($addid, $current);
?>
<?php
// Lue tilauksen ID sähköpostia varten
$orderid = "orderid.txt";
$ordernumber = file_get_contents($orderid);

// Kirjoita kuitti
require('receipt.php');
?>
<?php   
//Lähetä tilausvahvistus
require_once('mail/class.phpmailer.php');
$path = "kuitit/kuitti".$orderid.".pdf";
$bodytext = '
Olemme vastaanottaneet tilauksenne '. $ordernumber .'. 
Tilaamanne tuotteet löytyvät liitteestä.'
  ;
$email = new PHPMailer();
$email->From      = 'no-reply@coverlinefilms.fi';
$email->FromName  = 'no-reply@coverlinefilms.fi';
$email->Subject   = 'Olemme vastaanottaneet tilauksenne ' . $ordernumber;
$email->Body      = $bodytext;
$email->AddAddress('christian.nikkanen@gmail.com');
$email->AddAttachment($path, 'kuitti777.pdf');
return $email->Send();

?> 
```

[PDF 脚本](http://pastebin.com/muYhhg0x)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:35:52.153

在您的情况下（以及在大多数 CPU 密集型活动中），我通常使用**带有两个 cronjobs 的队列**：第一个将生成 pdf 文件，并在数据库表中将它们标记为就绪。第二个 cronjob 将查询数据库以检查 pdf 是否处于“就绪”状态，然后发送带有附件的电子邮件。

这样做，在最好的情况下，您将拥有一个空队列：所有收据在准备好后立即发送，在最坏的情况下，系统将加速发送所有电子邮件，直到 PDF 队列为空。

希望这种方法是明确的。[您可以在此处](http://kevin.vanzonneveld.net/techblog/article/create_daemons_in_php/)找到有关 PHP 守护程序的一些参考资料（恕我直言，这是一种比普通 PHP 脚本更好的作业管理方式）。

# php - 单击时设置 SESSION 变量

> ID：12321090
> 
> 赞同：0
> 
> 时间：2012-09-07T15:27:02.060
> 
> 标签：php, session, post, href

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:31:12.890

如果我理解正确，您希望将会话设置为调用 nextpage 时`$table_list[$i]`的会话。`$_SESSION["tablename"]`

只需将链接写如下：

```
echo "<a href=\"nextpage.php?table=" . urlencode($table_list[$i]) . "\">" . $table_list[$i] . "</a>"; 
```

所以`nextpage.php`你有`$_GET["table"]`然后你可以这样做：

```
$_SESSION["tablename"] = $_GET["table"] 
```

我希望我理解你的问题是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:31:16.630

您可以通过将查询字符串附加到链接来传递所需的值。就像是：

```
echo "...nextpage.php?tablename=$table_list[$i]..."; 
```

然后在 中`nextpage.php`，获取 的值，`$_GET['tablename']`放入用户的会话中。

```
$_SESSION['tablename'] = $_GET['tablename']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:32:41.733

有几种不同的方法可以做到这一点。最简单的方法是在 nextpage.php 的标头中包含一段代码，用于设置会话变量。

当前页面上的代码应更改为以下内容：

```
echo "<link><a href=\"nextpage.php?tablename=$table_list[i]\">$table_list[$i]</a><br>"; 
```

然后在 nextpage.php 上，您可以使用`get`请求来提取 session_var 的值并将其设置为您的会话 var。

```
$tablename = $_GET['tablename'];
$_SESSION['tablename'] = $tablename; 
```

现在显然您必须在设置会话数据之前清理获取数据。不这样做将是危险的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T15:32:46.720

您可以通过 GET 传递变量：

```
//...
echo"<a href=\"nextpage.php?value=$table_list[$i]\">$table_list[$i]</a><br>";
//... 
```

并检索它：

```
$_SESSION['tablename']=$_GET["value"] 
```

# c# - SignalR 停止为某些用户工作

> ID：12321111
> 
> 赞同：0
> 
> 时间：2012-09-07T15:28:24.537
> 
> 标签：c#, asp.net, signalr

我们有一个 SignalR 应用程序已启动并正在运行，并且迄今为止非常可靠。一个新用户开始访问它并发现在页面加载后大约 1-2 分钟停止接收更新（它们在前 1-2 分钟内确实有效）。浏览器是IE9，其他用户也可以正常使用。用户在 LAN 上（这是一个内部应用程序），因此不存在连接问题。

哪些环境问题可能会导致 SignalR 出现这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T20:43:57.950

这归结为 IE9 被设置为 Intranet 站点的兼容模式。我不确定它*为什么*会导致这个特定问题，但改变它可以解决它。

# azure - 复制 Azure Blob 并注入 azure 媒体服务会产生 System.Data.Services.Client.DataServiceQueryException

> ID：12321114
> 
> 赞同：1
> 
> 时间：2012-09-07T15:28:28.993
> 
> 标签：azure, azure-storage, azure-blob-storage

对于从另一个 blob 存储帐户将资产摄取到媒体服务，请按照以下步骤 操作[http://social.msdn.microsoft.com/Forums/en-US/MediaServices/thread/9bcaf96d-3a47-4e76-8c95-3bd9200ba432](http://social.msdn.microsoft.com/Forums/en-US/MediaServices/thread/9bcaf96d-3a47-4e76-8c95-3bd9200ba432) 我的代码是：

```
CloudStorageAccount storageAccount = Microsoft.WindowsAzure.CloudStorageAccount.Parse(RoleEnvironment.GetConfigurationSettingValue("AzureStorageString"));
private static readonly string _accountName = ConfigurationManager.AppSettings["accountName"];
private static readonly string _accountKey = ConfigurationManager.AppSettings["accountKey"]; 
```

* * *

```
 public ActionResult UploadData(IEnumerable<HttpPostedFileBase> files)
    {
        CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();
        CloudBlobContainer blobContainer = blobClient.GetContainerReference("rawvideos");
        if (blobContainer.CreateIfNotExist())
        {
            blobContainer.SetPermissions(new BlobContainerPermissions
            {
                PublicAccess = BlobContainerPublicAccessType.Blob
            });
        }

        CloudMediaContext _context = new CloudMediaContext(_accountName, _accountKey);
        Guid g = Guid.NewGuid();
        IAsset assetToBeProcessed = _context.Assets.CreateEmptyAsset("YourAsset_" + g.ToString(), AssetCreationOptions.None);
        IAccessPolicy writePolicy = _context.AccessPolicies.Create("Policy For Copying", TimeSpan.FromMinutes(30), AccessPermissions.Write | AccessPermissions.List);
        ILocator destinationLocator = _context.Locators.CreateSasLocator(assetToBeProcessed, writePolicy, DateTime.UtcNow.AddMinutes(-5));
        CloudBlobContainer sourceContainer = blobContainer;
        CloudBlobContainer destinationContainer= blobClient.GetContainerReference("rawvideocopy");
        if (destinationContainer.CreateIfNotExist())
        {
            blobContainer.SetPermissions(new BlobContainerPermissions
            {
                PublicAccess = BlobContainerPublicAccessType.Blob
            });
        }

        foreach (var file in files)
        {

          CloudBlockBlob rawVideoFileRef= blobContainer.GetBlockBlobReference(file.FileName);
          rawVideoFileRef.UploadFromStream(file.InputStream);

         CloudBlob sourceFileBlob = sourceContainer.GetBlobReference(file.FileName);
         sourceFileBlob.FetchAttributes();
         long sourceLength = sourceFileBlob.Properties.Length;
         CloudBlob destinationFileBlob= destinationContainer.GetBlobReference(file.FileName);
         destinationFileBlob.CopyFromBlob(sourceFileBlob);
         destinationFileBlob.FetchAttributes();
         long destLength = destinationFileBlob.Properties.Length;
         assetToBeProcessed.Publish(); 
         assetToBeProcessed = RefreshAsset(_context,assetToBeProcessed);
        }

        return View();
        } 
```

* * *

assetToBeProcessed.Publish(); 给出一个错误：

```
 System.Data.Services.Client.DataServiceQueryException was unhandled by user code
  HResult=-2146233079
  Message=An error occurred while processing this request.
  Source=Microsoft.Data.Services.Client
InnerException: System.Data.Services.Client.DataServiceClientException
       HResult=-2146233079
       Message=<?xml version="1.0" encoding="utf-8" standalone="yes"?><error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"><code>Internal Server Error</code><message xml:lang="en-US">Asset has no files uploaded.</message><innererror><message>Asset has no files uploaded.</message><type>System.ArgumentException</type><stacktrace>   at Microsoft.Cloud.Media.Vod.Rest.Data.Repository.AssetRepository.InitMainFile(IDataStore dataStore, AssetRecord asset) in d:\Builds\100\IISMediaServices\Release_Official\Sources\Nimbus\Release\src\Vod\Rest\Data\Repository\AssetRepository.cs:line 346&#xD; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:17:56.047

您需要从destinationLocator 获取destinationFileBlob 的URL。

# sql - SQL查询比较日期时间重叠并显示它们

> ID：12321117
> 
> 赞同：1
> 
> 时间：2012-09-07T15:28:39.203
> 
> 标签：sql, sql-server-2008

我有董事根据助手是否工作而向其支付报酬。

有2个观点如下：-

**导向器**

```
Name    TimeIn                      TimeOut

Bob     2012-07-17 07:00:00.000     2012-07-17 16:00:00.000
Sam     2012-07-17 10:00:00.000     2012-07-17 20:00:00.000
Beatly  2012-07-17 14:00:00.000     2012-07-17 23:00:00.000
Mac     2012-07-17 21:00:00.000     2012-07-18 07:00:00.000 
```

**帮手**

```
Name    TimeIn                      TimeOut
Fred    2012-07-17 15:59:00.000     2012-07-18 00:19:00.000 
```

现在弄清楚谁在那段时间工作并不是困难的部分，或者至少这不是我遇到问题的部分。什么是找到最小的时间和时间以及由谁重叠。并按使用的时间将它们组合在一起。因为他们都会和抄写员分摊每小时的工资。所以理想情况下，结果如下。

```
DirName HelperStart                 HelperEnd
Bob     2012-07-17 15:59:00.000     2012-07-17 16:00:00.000
Sam     2012-07-17 15:59:00.000     2012-07-17 16:00:00.000
Beatly  2012-07-17 15:59:00.000     2012-07-17 16:00:00.000
Sam     2012-07-17 16:01:00.000     2012-07-17 20:00:00.000
Beatly  2012-07-17 16:01:00.000     2012-07-17 20:00:00.000
Beatly  2012-07-17 20:01:00.000     2012-07-17 21:00:00.000
Beatly  2012-07-17 21:01:00.000     2012-07-17 23:00:00.000
Mac     2012-07-17 21:01:00.000     2012-07-17 23:00:00.000
Mac     2012-07-17 23:01:00.000     2012-07-18 00:19:00.000 
```

使用SQL server 2008。我希望简单的简单分解就足够了。找到足够多的查询来查看是否有人与时间冲突，但没有细分上述内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:48:37.097

如果我理解正确，这只是一个“简单”连接，您使用的是重叠的时间间隔。第二部分是测量助手与董事时间重叠的时间段。这段时间从导演和助手 TimeIn 的较晚开始，到他们的 TimeOut 的较早结束。

我认为以下查询捕获了这个逻辑：

```
select d.name as DirectorName, h.name as HelperName,
       (case when d.timeIn > h.timeIn then d.timeIn else h.timeIn end) as HelperStart,
       (case when d.timeOut > h.timeOut then h.timeOut else d.timeOut end) as HelperEnd
from director d join
     helper h
     on d.timeIn < h.timeOut and
        d.timeOut >= h.timeIn 
```

# android - 将广告投放到免费的 Android 应用程序

> ID：12321119
> 
> 赞同：2
> 
> 时间：2012-09-07T15:28:49.013
> 
> 标签：android, ads

嗨，我刚刚完成了我的 android 应用程序的制作，并希望作为免费应用程序发布到 android 市场，底部有一个广告。有哪些必要的步骤和要求的注册？

1.  发布免费应用程序需要支付 25 美元的费用吗？
2.  我需要告诉谷歌一个银行账户，然后谷歌会处理税款，并在税后和谷歌收取的费用后将剩余的给我们账户吗？（我在香港）
3.  admob 似乎是将广告投放到应用程序的广告管理器。网站还要求我提供银行信息，这些是做什么用的？是 google 还是 admob 或两者都给我收入？
4.  收入如何计算？
5.  会不会有税务问题？
6.  我完成的代码是否有必要的代码修改？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:46:09.737

1.  是的。这是一次性的 Android 应用发布者注册费。
2.  如果您只分发免费应用程序，则在注册为应用程序发布者时无需提供银行帐户。但是在 Admob 注册时需要提供。
3.  Admob 需要您的银行帐户，以便在您获得足够的点击次数时向您付款。Admob 归 Google 所有，但我认为是 Admob 负责付费。
4.  据我所知，Admob 没有透露收入是如何计算的。查看此[论坛主题](http://forum.unity3d.com/threads/73123-AdMob-statistics)以获取有关其他人获得多少收入的一些示例。
5.  这取决于您所在国家/地区的税法。
6.  是的，当您添加 Admob 时，您需要向您的应用添加一些代码。

# boolean-logic - 布尔逻辑哪里出错了？

> ID：12321121
> 
> 赞同：0
> 
> 时间：2012-09-07T15:28:52.283
> 
> 标签：boolean-logic, boolean-expression, circuit

对于小型数字系统，我被要求“当驾驶员下车（b = 车内驾驶员）但钥匙仍在车内（c = 钥匙内）发动机，即使驾驶员已关闭车门锁杆。（d = 锁杆已关闭）。注意：如果驾驶员在车内 (b) 并要求锁定车门 (d)，则车门必须锁定（a）“。

我认为这可以分为两部分（其中整体表达是 1\. 第一组要求和 2.“注意”部分，所以 1 + 2？）

对于第一部分，我认为布尔表达式应该是这样的：

```
a' = b' AND c AND d. 
a' = b'cd. 
```

然后我尝试取两边的补码： (a')' = (b'cd)'

...并使用德摩根定律... a = (b'c)' + d' ...然后再次使用德摩根定律... a = b + c' + d'。

但这是否意味着“当驾驶员在车内或钥匙不在车内或门锁杆未接合时，车门应锁定。” 这根本没有意义。

在第二部分（注意：）中，我得到了 a = bd。那么，整体表达是否应该是这个与之前听起来不正确的部分的补充？然后我有：a = b + c' + d' + bd。通过类中给出的一个棘手的分配属性，我想我可以将 c' + bd 组件简化为 (c' + b)(c' + d)。那么我有 a = (c' + b)(c' + d) + b + d'。

这越来越令人困惑；如果更多，我可以简化吗？（嗯，实际上，它可能一开始就不正确！）我哪里出错了，我该在哪里停下来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:38:25.407

我认为你最初的假设有问题，然后一切都崩溃了。你所拥有的是一个不完整的真值表：

```
a  b  c  d
?  0  0  0
?  0  0  1
?  0  1  0
0  0  1  1  <<< - this is the only data you have
?  1  0  0
?  1  0  1
?  1  1  0
?  1  1  1 
```

实际上，如果你仔细阅读问题陈述，看起来 d 真的是一个“不关心”（因为它说“即使......”），所以你的真值表中实际上可能有两个条目：

```
a  b  c  d
?  0  0  0
?  0  0  1
0  0  1  0
0  0  1  1
?  1  0  0
?  1  0  1
?  1  1  0
?  1  1  1 
```

另一个可能的问题是您对 a 的解释。a 并不意味着“门应该锁定”，而是意味着“门*可以*锁定”，因为您正在指定一个不应锁定门的*情况。*

如果我们假设对于上述所有未知情况 a 为真（即在所有其他情况下门*可以*被锁定），那么我们有：

```
a  b  c  d
1  0  0  0
1  0  0  1
0  0  1  0
0  0  1  1
1  1  0  0
1  1  0  1
1  1  1  0
1  1  1  1 
```

可以表示为：

```
a = (b' AND c') OR b 
```

即，只有在以下情况下，车门才能被锁定：(i) 司机在车外，钥匙不在车内；或 (ii) 司机在车内。

# wpf - wpf奇怪的生成文件错误

> ID：12321123
> 
> 赞同：0
> 
> 时间：2012-09-07T15:29:02.370
> 
> 标签：wpf, visual-studio-2010, xaml

在我的开发机器上从 Windows XP 迁移到 Windows 7 后，我遇到了一些奇怪的行为。

我有一个在 Visual Studio 2010 中创建的 WPF 4 解决方案。解决方案中有 3 个项目 - Common、MyApp 和 Infrastructure。我正在使用 Prism 4。最初的解决方案是在 Windows XP 上创建的，出于各种原因，我将其重建为一个新的解决方案。我添加了 Common 和 MyApp 并且都独立成功构建。问题在于基础设施。

为了重建项目，我创建了项目文件夹并添加了现有代码文件。当我开始时，我测试了构建，它在一定程度上很好。输入所有文件后，我现在在尝试构建时收到这样的错误（Resharper 建议一切都很好）；

```
The type or namespace name 'Windows' does not exist in the namespace 'Infrastructure.System' (are you missing an assembly reference?) CircularProgressBar.g.cs
The type or namespace name 'Windows' does not exist in the namespace 'Infrastructure.System' (are you missing an assembly reference?) CircularProgressBar.xaml
The type or namespace name 'Delegate' does not exist in the namespace 'Infrastructure.System' (are you missing an assembly reference?)  SearchView.g.cs
The type or namespace name 'CodeDom' does not exist in the namespace 'Infrastructure.System' (are you missing an assembly reference?)   CircularProgressBar.g.cs 
```

共同的主题是列出的所有文件都与 XAML 相关。Infrastructure项目是WPF用户控件之一，所有的xaml文件都有Page的Build Action。

现在真的很奇怪。为了尝试确定问题出在哪里，我开始从项目中一一排除文件夹。我从 InteractionRequests 开始，因为我一直在这里遇到麻烦。不用找了。然后我排除了下一个（系统）和低，看到解决方案构建并显示主窗口。因此，我开始将它们一一添加回来 - 例如，如果我添加 UserType

```
namespace Infrastructure.System
{
  public enum TypeOfUser
  {
    User,
    Admin    
  }

  public enum TypeOfTrialUser
  {
    User,
    Admin
  }

  public enum UserAccessStatus
  {
    Granted,
    Revoked
  }
} 
```

错误返回。再次排除它，它们就消失了。其他文件也有同样的故事，所以它与文件本身无关（正如你所期望的那样）。当错误返回时，它仍然引用相同的 xaml 相关文件列表（*.xaml 或 *.g.cs）。

有任何想法吗？我不得不承认我对此完全感到困惑！可能与文件权限有关？智商到头了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:54:52.487

好吧，我解决了它，但我不确定为什么会出现问题。关键是命名空间 Infrastructure.System - 将其重命名为 Infrastructure.Sys，更新了 using 语句并且所有构建都成功。某种故障？

# css - CSS让输入消耗可用宽度

> ID：12321125
> 
> 赞同：2
> 
> 时间：2012-09-07T15:29:14.100
> 
> 标签：css, text, input

我有以下标记作为基础：

```
<div>
    <span>some dynamic text</span>
    <input type="text" />
</div> 
```

我希望输入与文本（始终是单行但长度不同）显示在一行中，并根据文本长度消耗可用宽度。如果需要，可以更改标记。两个元素都应该是父元素宽度的 100%。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:38:51.807

## 我能想到的两种方法：

### 第一个：

您可以使用 CSS 模拟表格的行为；

HTML：

```
<div class = "container">
    <div class = "text">Glee is awesome!</div>
    <div class = "inputtext"><input type="text" /></div>
</div> 
```

CSS：

```
.container {
    display: table;
    width: 100%; /*how much should both the text and the input take*/
}
.container .text {
    white-space: nowrap;
    display: table-cell;
    width: 1px; /*make sure it's only as wide as needed*/
}
.container .inputtext {
    display: table-cell;
}
.container input {
    width: 100%; /*let the input take all available space*/
} 
```

小演示：[小链接](http://jsfiddle.net/qRwGa/)。

### 第二个：

此方法依赖于浮动：

HTML：

```
<div class = "text">Glee is awesome!</div>
<div class = "inputtext"><input type = "text" /></div> 
```

CSS：

```
.text {
    float: left;
}
.inputtext {
    overflow: hidden; /*this is the key here*/
}
input {
    width: 100%;
} 
```

另一个小演示：[小链接](http://jsfiddle.net/aY6Wf/)。

# sql - 多连接查询返回多个结果且匹配不正确

> ID：12321127
> 
> 赞同：1
> 
> 时间：2012-09-07T15:29:23.507
> 
> 标签：sql, database, oracle

我在 Oracle 中有以下最小架构： [http ://sqlfiddle.com/#!4/c1ed0/14](http://sqlfiddle.com/#!4/c1ed0/14)

我运行的查询产生了太多结果，这个查询：

```
select cat.*, status.*, source.*
from cats cat, status status, source source
Left OUTER JOIN source source2
on source2.sourceid = 1
Right OUTER JOIN status status2
on status2.isStray =0
order by cat.name 
```

会产生不正确的结果。我期待的是一个如下所示的表，但是我似乎无法提出正确的 SQL。

```
NAME    AGE     LENGTH  STATUSID    CATSOURCE   ISSTRAY     SOURCEID    CATID
 Adam    1        25     null         null         null       1             2
 Bill    5        1      null         null         null       null          null
 Charles 7        5      null         null         null       null          null
 Steve   12       15     1            1            1          1             1 
```

用简单的英语，我正在寻找的是返回所有已知的猫 + 它们相关的猫源 + 它们的猫状态，同时保留空值。我将拥有的唯一信息是我很好奇的来源。我也只想要状态为 STRAY 或 UNKNOWN (null) 的猫

**更新**

为了澄清 Cats 的映射如下所示：

Cat 的 id 存储在 Source 表中 catId 列下。
Status 表引用了 Source 的 PK 作为标记为 catSource 的列。

在实践中，要获取当前猫的状态，查询将是：

```
select cat.* from cats cat, status status, source source  
where cat.id = source.catId  
and source.sourceId = status.catSource 
```

**最终查询**

```
select *
from source
    inner join cats on source.catid = cats.id
and source.sourceid = 1
    left join status on source.sourceid = status.catsource 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:36:32.937

```
select *
from source
    inner join cats on source.catid = cats.id
    left join status on source.sourceid = status.catsource
         and statusid=1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:45:43.073

预期的数据似乎有点偏离。检查此查询（使用 oracle 语法）。

```
select c.name,
       c.age,
       c.length,
       s.*,
       src.*
  from cats c,
       status s,
       Source src
  where c.id = s.StatusId(+)
     and c.id = src.sourceId(+)
  order by c.name

Adam    1   25              2   2
Bill    5   1                   
Charles 7   5                   
Steve   12  15  1   1   1   1   2
Steve   12  15  1   1   1   1   1 
```

# r - R 中的子集（）返回不正确值的问题

> ID：12321128
> 
> 赞同：1
> 
> 时间：2012-09-07T15:29:26.333
> 
> 标签：r, dataframe, subset

我试图通过其染色体和位置信息对遗传数据区域进行子集化。不幸的是，我的结果不在我的参数范围内。任何帮助，将不胜感激。

这是我的代码：

```
 subset.by.region<- function(df,region.info, expansion=0){
     MBstart = as.numeric(region.info[[3]]) - expansion
     MBend = as.numeric(region.info[[4]]) + expansion
     chrom =as.numeric(region.info[[2]])
     print(chrom)
     print(MBstart)
     print(MBend)
     BPstart <- MBstart  * 1e6
     BPend <- MBend  * 1e6
     sub_results <- as.numeric(df$CHR) == chrom & as.numeric(df$BP) >= BPstart & as.numeric(df$BP) <= BPend;
     print(head(sub_results))
     region_results <- subset(results, sub_results)
     return(region_results)
    } 
```

以下是包含正在使用的区域信息的控制台打印：

```
[1] 1
[1] 113.308
[1] 115.158 
```

这是子集 (region_results) 的打印结果：

```
 GENE CHR     SNP    EMP1  NP        BP          SNP_IM  SNP_LZ
3238 AP3S1   5    rs26538 1.00000   6 115178395         rs26538    rs26538
3239 AP4B1   1  rs1217401 1.00000  46 114438951 imm_1_114240474  rs1217401
3240 AP4B1   1  rs1217402 1.00000  41 114440258 imm_1_114241781  rs1217402
3241 AP4B1   1  rs3789613 1.00000 297 114443035 imm_1_114244558  rs3789613
3242 AP4B1   1  rs7523862 1.00000 297 114443419 imm_1_114244942  rs7523862
3243 AP4B1   1 rs17464525 1.00000 148 114443899 imm_1_114245422 rs17464525 
```

如您所见，子集中有一行包含 5 号染色体中的标记。我做错了什么？先感谢您。编辑：这是对该函数的调用，其中包含前面的内容：

```
 write.genelist <- function(table_loc, region.info, out_folder,yank_loc){
      region.ID = as.character(region.info[[1]])
      out_name = paste0(region.ID,"_genes.list")
      region_folder = file.path(out_folder, region.ID)
      out_loc <- file.path(region_folder,out_name, fsep = .Platform$file.sep)
      results <- read.table(table_loc, T,strip.white = TRUE)
      gene_region_results <- subset.by.region(results,region.info)
      ...
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:46:29.903

我会`[`在函数中使用子集 not `subset()`。看看`?subset`为什么。

```
subset.by.region<- function(results, df, region.info, expansion=0){
    MBstart = as.numeric(region.info[[3]]) - expansion
    MBend = as.numeric(region.info[[4]]) + expansion
    chrom =as.numeric(region.info[[2]])
    print(chrom)
    print(MBstart)
    print(MBend)
    BPstart <- MBstart  * 1e6
    BPend <- MBend  * 1e6
    sub_results <- as.numeric(df$CHR) == chrom & 
        as.numeric(df$BP) >= BPstart & as.numeric(df$BP) <= BPend
    print(head(sub_results))
    results[sub_results, ]
} 
```

我也会通过`results`不依赖它在全球环境中找到它。

# django - 如何覆盖 Django 管理员的视图？

> ID：12321130
> 
> 赞同：17
> 
> 时间：2012-09-07T15:29:34.663
> 
> 标签：django, admin

我想给默认的Django admin添加一个上传按钮，如下图：

![在此处输入图像描述](../Images/477b328c22f3f8a5645c51c6f2096981.png)

为此，我覆盖了 admin/index.html 模板以添加按钮，但是如何覆盖管理视图以处理它？

我想要实现的是在文件上传后显示成功消息或错误消息。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-07T16:28:59.907

索引视图位于`AdminSite`实例上。要覆盖它，您必须创建一个自定义`AdminSite`子类（即不再使用`django.contrib.admin.site`）：

```
from django.contrib.admin import AdminSite
from django.views.decorators.cache import never_cache

class MyAdminSite(AdminSite):
    @never_cache
    def index(self, request, extra_context=None):
        # do stuff 
```

您可能想在以下位置引用原始方法：[https ://github.com/django/django/blob/1.4.1/django/contrib/admin/sites.py](https://github.com/django/django/blob/1.4.1/django/contrib/admin/sites.py)

然后，您创建此类的一个实例，并使用此实例，而不是`admin.site`注册您的模型。

```
admin_site = MyAdminSite() 
```

然后，稍后：

```
from somewhere import admin_site

class MyModelAdmin(ModelAdmin):
    ...

admin_site.register(MyModel, MyModelAdmin) 
```

您可以在以下位置找到更多详细信息和示例：[https ://docs.djangoproject.com/en/dev/ref/contrib/admin/#adminsite-objects](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#adminsite-objects)

# random - 如何正确播种随机数生成器

> ID：12321133
> 
> 赞同：202
> 
> 时间：2012-09-07T15:29:44.270
> 
> 标签：random, go

我正在尝试在 Go 中生成一个随机字符串，这是我到目前为止编写的代码：

```
package main

import (
    "bytes"
    "fmt"
    "math/rand"
    "time"
)

func main() {
    fmt.Println(randomString(10))
}

func randomString(l int) string {
    var result bytes.Buffer
    var temp string
    for i := 0; i < l; {
        if string(randInt(65, 90)) != temp {
            temp = string(randInt(65, 90))
            result.WriteString(temp)
            i++
        }
    }
    return result.String()
}

func randInt(min int, max int) int {
    rand.Seed(time.Now().UTC().UnixNano())
    return min + rand.Intn(max-min)
} 
```

我的实施非常缓慢。播种 using`time`会在一定时间内带来相同的随机数，因此循环一次又一次地迭代。如何改进我的代码？

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2012-09-07T15:33:05.050

每次设置相同的种子时，都会得到相同的序列。因此，当然，如果您将种子设置为快速循环中的时间，您可能会多次使用相同的种子调用它。

在你的情况下，当你调用你的`randInt`函数直到你有一个不同的值时，你正在等待时间（由 Nano 返回）改变。

[对于所有伪随机库](http://en.wikipedia.org/wiki/Pseudorandom_number_generator)，您只需设置一次种子，例如在初始化程序时，除非您特别需要重现给定的序列（通常仅用于调试和单元测试）。

之后，您只需调用`Intn`以获取下一个随机整数。

将`rand.Seed(time.Now().UTC().UnixNano())`行从 randInt 函数移动到 main 的开头，一切都会更快。并失去了`.UTC()`电话，因为：

> UnixNano 返回 t 作为 Unix 时间，即自 1970 年 1 月 1 日 UTC 以来经过的纳秒数。

另请注意，我认为您可以简化字符串构建：

```
package main

import (
    "fmt"
    "math/rand"
    "time"
)

func main() {
    rand.Seed(time.Now().UnixNano())
    fmt.Println(randomString(10))
}

func randomString(l int) string {
    bytes := make([]byte, l)
    for i := 0; i < l; i++ {
        bytes[i] = byte(randInt(65, 90))
    }
    return string(bytes)
}

func randInt(min int, max int) int {
    return min + rand.Intn(max-min)
} 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2019-02-02T09:38:16.503

我不明白为什么人们用时间价值播种。根据我的经验，这从来都不是一个好主意。例如，虽然系统时钟可能以纳秒表示，但系统的时钟精度不是纳秒。

[这个程序](https://play.golang.org/p/yXff-pLwtwC)不应该在 Go 操场上运行，但如果你在你的机器上运行它，你会粗略估计你可以期望的精度类型。我看到增量约为 1000000 ns，因此增量为 1 ms。那是未使用的 20 位熵。*一直以来，高位大多是恒定的！？*一天内大约有 24 位熵，这是非常暴力的（可能会产生漏洞）。

`crypto/rand.Read`这对您的重要性会有所不同，但您可以通过简单地使用作为种子的源来避免基于时钟的种子值的陷阱。它将为您提供您可能在随机数中寻找的非确定性质量（即使实际实现本身仅限于一组不同且确定性的随机序列）。

```
import (
    crypto_rand "crypto/rand"
    "encoding/binary"
    math_rand "math/rand"
)

func init() {
    var b [8]byte
    _, err := crypto_rand.Read(b[:])
    if err != nil {
        panic("cannot seed math/rand package with cryptographically secure random number generator")
    }
    math_rand.Seed(int64(binary.LittleEndian.Uint64(b[:])))
} 
```

作为旁注，但与您的问题有关。您可以使用此方法创建自己的`rand.Source`方法，以避免使用锁保护源代码的成本。包`rand`实用程序功能很方便，但它们也在引擎盖下使用锁来防止源被同时使用。如果您不需要它，您可以通过创建自己的`Source`并以非并发方式使用它来避免它。无论如何，您不应该在迭代之间重新播种随机数生成器，它从未被设计为以这种方式使用。

* * *

编辑：我曾经在 ITAM/SAM 工作，我们构建的客户端（然后）使用基于时钟的种子。在 Windows 更新后，公司机队中的许多机器几乎同时重新启动。这导致对上游服务器基础设施的恶意 DoS 攻击，因为客户端正在使用系统运行时间来播种随机性，而这些机器最终或多或少地随机选择相同的时间段进行报告。它们的目的是在一段时间内涂抹负载一个小时左右，但那没有发生。负责任地播种！

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-09-07T17:09:31.983

只是为了后代把它扔掉：有时最好使用初始字符集字符串生成随机字符串。如果字符串应该由人手动输入，这很有用；排除 0、O、1 和 l 有助于减少用户错误。

```
var alpha = "abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789"

// generates a random string of fixed size
func srand(size int) string {
    buf := make([]byte, size)
    for i := 0; i < size; i++ {
        buf[i] = alpha[rand.Intn(len(alpha))]
    }
    return string(buf)
} 
```

我通常将种子设置在一个`init()`块内。它们记录在这里： http: [//golang.org/doc/effective_go.html#init](http://golang.org/doc/effective_go.html#init)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-10-20T11:23:27.020

好吧，为什么这么复杂！

```
package main

import (
    "fmt"
    "math/rand"
    "time"
)

func main() {
    rand.Seed( time.Now().UnixNano())
    var bytes int

    for i:= 0 ; i < 10 ; i++{ 
        bytes = rand.Intn(6)+1
        fmt.Println(bytes)
        }
    //fmt.Println(time.Now().UnixNano())
} 
```

这是基于dystroy的代码，但适合我的需要。

它死了六（兰特整数`1 =< i =< 6`）

```
func randomInt (min int , max int  ) int {
    var bytes int
    bytes = min + rand.Intn(max)
    return int(bytes)
} 
```

上面的函数是完全一样的。

我希望这些信息有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-08T02:19:20.073

我尝试了下面的程序，每次都看到不同的字符串

```
package main

import (
    "fmt"
    "math/rand"
    "time"
)

func RandomString(count int){
  rand.Seed(time.Now().UTC().UnixNano()) 
  for(count > 0 ){
    x := Random(65,91)
    fmt.Printf("%c",x)
    count--;
  }
}

func Random(min, max int) (int){
 return min+rand.Intn(max-min) 
}

func main() {
 RandomString(12)
} 
```

我的控制台上的输出是

```
D:\james\work\gox>go run rand.go
JFBYKAPEBCRC
D:\james\work\gox>go run rand.go
VDUEBIIDFQIB
D:\james\work\gox>go run rand.go
VJYDQPVGRPXM 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-11T09:53:43.063

是纳秒，两次获得相同种子的机会是多少。
无论如何，感谢您的帮助，这是我基于所有输入的最终解决方案。

```
package main

import (
    "math/rand"
    "time"
)

func init() {
    rand.Seed(time.Now().UTC().UnixNano())
}

// generates a random string
func srand(min, max int, readable bool) string {

    var length int
    var char string

    if min < max {
        length = min + rand.Intn(max-min)
    } else {
        length = min
    }

    if readable == false {
        char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    } else {
        char = "ABCDEFHJLMNQRTUVWXYZabcefghijkmnopqrtuvwxyz23479"
    }

    buf := make([]byte, length)
    for i := 0; i < length; i++ {
        buf[i] = char[rand.Intn(len(char)-1)]
    }
    return string(buf)
}

// For testing only
func main() {
    println(srand(5, 5, true))
    println(srand(5, 5, true))
    println(srand(5, 5, true))
    println(srand(5, 5, false))
    println(srand(5, 7, true))
    println(srand(5, 10, false))
    println(srand(5, 50, true))
    println(srand(5, 10, false))
    println(srand(5, 50, true))
    println(srand(5, 10, false))
    println(srand(5, 50, true))
    println(srand(5, 10, false))
    println(srand(5, 50, true))
    println(srand(5, 4, true))
    println(srand(5, 400, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
    println(srand(6, 5, true))
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-16T01:51:51.500

如果您的目标只是生成一串随机数，那么我认为没有必要通过多次函数调用或每次都重置种子来使其复杂化。

最重要的一步是在实际运行之前只调用一次种子函数`rand.Init(x)`。[Seed](https://golang.org/pkg/math/rand/#Seed)使用提供的种子值将默认 Source 初始化为确定性状态。因此，建议在实际函数调用伪随机数生成器之前调用它一次。

这是创建一串随机数的示例代码

```
package main 
import (
    "fmt"
    "math/rand"
    "time"
)

func main(){
    rand.Seed(time.Now().UnixNano())

    var s string
    for i:=0;i<10;i++{
    s+=fmt.Sprintf("%d ",rand.Intn(7))
    }
    fmt.Printf(s)
} 
```

我使用[Sprintf](https://golang.org/pkg/fmt/#Sprintf)的原因是它允许简单的字符串格式化。

此外，In `rand.Intn(7)` [Intn](https://golang.org/pkg/math/rand/#Intn)以 int 形式返回 [0,7) 中的非负伪随机数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-04T15:19:56.310

@[Denys Séguret] 已正确发布。但在我的情况下，我每次都需要新的种子，因此下面的代码；

如果您需要快速功能。我是这样用的。

```
 func RandInt(min, max int) int {
    r := rand.New(rand.NewSource(time.Now().UnixNano()))
    return r.Intn(max-min) + min
}

func RandFloat(min, max float64) float64 {
    r := rand.New(rand.NewSource(time.Now().UnixNano()))
    return min + r.Float64()*(max-min)
} 
```

[来源](https://golang.org/pkg/math/rand/#example__rand)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-10T09:37:48.240

每次在 for 循环中调用 randint() 方法时，都会设置不同的种子，并根据**时间**生成一个序列。**但是，由于 for 循环在您的计算机中快速运行，种子几乎是相同的，并且由于时间**原因，生成的序列与过去的序列非常相似。所以在 randint() 方法之外设置种子就足够了。

```
package main

import (
    "bytes"
    "fmt"
    "math/rand"
    "time"
)

var r = rand.New(rand.NewSource(time.Now().UTC().UnixNano()))
func main() {
    fmt.Println(randomString(10))
}

func randomString(l int) string {

    var result bytes.Buffer
    var temp string
    for i := 0; i < l; {
        if string(randInt(65, 90)) != temp {
            temp = string(randInt(65, 90))
            result.WriteString(temp)
            i++
        }
    }
    return result.String()
}

func randInt(min int, max int) int {
    return min + r.Intn(max-min)
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-06-27T08:09:06.047

由于 golang api 更改导致的小更新，请省略 .UTC() ：

现在的时间（）。**UTC()** .UnixNano() -> time.Now().UnixNano()

```
import (
    "fmt"
    "math/rand"
    "time"
)

func main() {
    rand.Seed(time.Now().UnixNano())
    fmt.Println(randomInt(100, 1000))
}

func randInt(min int, max int) int {
    return min + rand.Intn(max-min)
} 
```

# ruby-on-rails - 是否有一个 Sublime Text 2 包可以找到对 Rails 视图部分渲染的调用？

> ID：12321136
> 
> 赞同：3
> 
> 时间：2012-09-07T15:29:55.893
> 
> 标签：ruby-on-rails, partial-views, sublimetext2

有时我会在我的 Rails 项目中使用 Sublime Text 2 打开一个局部视图文件，并想知道它的调用`render`来自哪里（通常是通过调用局部视图的视图来调试我的方式，这些视图调用局部视图......）。是否有一个包可以让您找到调用文件列表（或者如果只有一个，则直接打开调用文件），与[Sublime Text 2 Ruby Tests](https://github.com/maltize/sublime-text-2-ruby-tests#usage)中的“在代码和测试之间切换”热键相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:04:33.187

你的 rails 日志可能是你最好的选择。当您试图找出哪个代码调用了什么时，您的 rails 日志会显示类似`Processing SomeController#some_action ...`的内容，它会告诉您处理了哪个操作。

之后它还会说`Rendering template...`模板的名称。

我想我要说的是，除了简单地使用带有正则表达式的 find 来查找 的所有实例之外，我认为没有其他插件可以工作`render`，但即使它也可能会错过包含哪些部分，等等。

我会根据日志所说的 Rails 实际在做什么进行调试——我认为，这将是唯一可靠的事实来源，并且它总是包含足够的信息来找出“刚刚发生了什么？”的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:19:54.610

您还可以在文件夹树中搜索对该渲染部分的调用。使用 ctrl+shift+f (cmd+shift+f) 并选择您想要的文件夹树，然后您可以通过正则表达式或文本进行搜索。然后，您可以搜索您正在寻找的部分。这不会为您找到树，因此您必须继续搜索对其呈现的部分的调用（如果您有嵌套的部分），但它非常彻底

# c# - 如何等待表单加载，然后启动方法？

> ID：12321138
> 
> 赞同：2
> 
> 时间：2012-09-07T15:29:58.610
> 
> 标签：c#, wpf, multithreading

我有一个 WPF 应用程序，它在加载时执行一个方法来检查某些文件是否存在，如果不存在，则下载它们。它还下载一个字符串用作消息，并输出到`in-app`控制台。

但是，当我启动程序时，我看到白屏几秒钟，然后窗口加载，一切都完成了。所以看起来该方法是在窗口加载之前执行的。

如何等待窗口加载，等待大约 2 秒，然后运行该方法？

这是我尝试运行的方法的代码：

```
consolemessage("STARTUP", "Verifying existence of essential files...");
if(!File.Exists("Interop.NATUPNPLib.dll"))
    Download("link here", "Interop.NATUPNPLib.dll");
if(!File.Exists("LICENSE.txt"))
    Download("link here", "LICENSE.txt");
consolemessage("STARTUP", "Essential file validation completed!"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:56:57.713

如果您看到白屏几秒钟，这意味着您的任务（下载文件）需要几秒钟。您可以在窗口加载后通过订阅窗口的“Loaded”事件来启动此任务，但它仍会冻结应用程序 3 秒。

您必须创建一个适合您需要的解决方案，以便以用户友好的方式处理此任务。

如果您想在检索此信息之前阻止用户使用应用程序，您可以创建一个带有加载动画或进度条的弹出窗口。您可以为这些设置动画，因为您的任务有时间完成。

如果您希望用户能够在后台加载信息时使用您的应用程序，则需要使用诸如 BackgroundWorker 或其他异步设计之类的东西将信息加载到另一个线程上，然后在信息加载时回调主线程准备好并加载。如果您正在使用 Web 请求，您通常可以通过使用诸如“BeginGetResponse”之类的异步重载将它们转换为异步 Web 请求。这取决于您的代码。

**编辑**：

您可以像这样在 Window 范围内创建 BackgroundWorker：

```
public partial class MainWindow : Window
{
    private BackgroundWorker worker;

    public MainWindow()
    {
        InitializeComponent();

        Loaded += MainWindow_Loaded;
    }

    void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        worker = new BackgroundWorker();
        worker.DoWork += worker_DoWork;
        worker.RunWorkerCompleted += worker_RunWorkerCompleted;
        worker.RunWorkerAsync();
        consolemessage("STARTUP", "Verifying existence of essential files...");
    }

    void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        if (!File.Exists("Interop.NATUPNPLib.dll"))
            Download("link here", "Interop.NATUPNPLib.dll");

        if (!File.Exists("LICENSE.txt"))
            Download("link here", "LICENSE.txt");
    }

    void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        // Signal your UI that the files are now available here if needed.
        consolemessage("STARTUP", "Essential file validation completed!");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:00:36.427

您还可以在您的事件中启动一个单次计时器，`Form.Loaded`延迟 100 毫秒左右，然后在其中运行您的方法。这就是我过去所做的，以便在我运行我的代码之前让表单完全加载。

例子：

```
public partial class MainWindow : Window
{
    System.Windows.Threading.DispatcherTimer oneShot = new System.Windows.Threading.DispatcherTimer();
    public MainWindow()
    {
        InitializeComponent();
        oneShot.Interval = new TimeSpan(0, 0, 0, 0, 100);
        oneShot.Tick += new EventHandler(oneShot_Tick);
    }

    void oneShot_Tick(object sender, EventArgs e)
    {
        oneShot.Stop();

        // Your Code or Method here
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        oneShot.Start();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:31:39.550

您可以将代码放在`Window_Loaded`事件中。这是一个快速而肮脏的实现，不会冻结您的 UI（请记住，如果用户可以做一些尝试在它们实际完成之前引用这些东西的事情，它可能会引发异常，在这种情况下使用 Moozhe 的解决方案来创建某种加载屏幕）

在顶部使用：

```
using System.Threading; 
```

简单的代码：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    Thread t = new Thread( YourMethod);
    t.IsBackground = true;
    t.Start();
}
void YourMethod()
{
    consolemessage("STARTUP", "Verifying existence of essential files...");
    if (!File.Exists("Interop.NATUPNPLib.dll"))
        Download("link here", "Interop.NATUPNPLib.dll");
    if (!File.Exists("LICENSE.txt"))
        Download("link here", "LICENSE.txt");
    consolemessage("STARTUP", "Essential file validation completed!");
} 
```

# java - SWT - 从按钮打开对话框的最佳代码过程

> ID：12321143
> 
> 赞同：0
> 
> 时间：2012-09-07T15:30:11.400
> 
> 标签：java, swt

在我的主 GUI 应用程序上，有一个按钮可以打开单独的对话框。新对话框有一个带有打印机列表的表格。我无法让它工作。我很确定它可以填充表格。下面是我用来尝试完成这项工作的代码。

```
Button plotButton = new Button(composite, SWT.PUSH);
   plotButton.setText("Select Plotter");
   plotButton.addSelectionListener(new SelectionAdapter() {
       public void widgetSelected(SelectionEvent e) {
          startPrinterListOperation();              
          showFooBarDialog();
       }
  }); 
```

这是 showFooBarDialog() 方法

```
private void showFooBarDialog() {
  apd = new FooDialog(null);
  apd.create();
  apd.getShell().setSize(700, 400);
  apd.open();      
} 
```

在 FooDialog 中，我试图用从服务器端调用累积的打印机填充一个表。

```
private void startPrinterListOperation() {
  listOp = new AplotPrinterListOperation(appReg.getString("aplot.message.GETPRINTERLIST"), session);
  listOp.addOperationListener(new MyOperationListener(this) {
     public void endOperationImpl() {
        try {
            printers = (ArrayList<PrinterProfile>) listOp.getPrinters();
        }
        finally {
           listOp.removeOperationListener(this);
           listOp = null;
        }
     }
  });
  session.queueOperation(listOp);
} 
```

该方法基本上启动了一个操作，该操作转到服务器并收集可用的打印机，然后将它们存储在 ArrayList 中，这个过程可能需要一两秒钟。

因此，当 FooDialog 尝试打开并填充表时，我立即在此行上收到空指针错误

```
 viewer.setInput(parentDialog.getPrintersArray()); 
```

我认为这是`ArrayList`尚未完成的地方，所以它返回 Null。

1.  还有其他地方我应该打电话`startPrinterListOperation()`而不是点击按钮吗？

2.  有没有办法让`showFooBarDialog();`直到某个关闭时间才执行？

3.  我可能完全不知道我是如何做到这一点的。该`startPrinterListOperation()`方法是否应该在`FooDialog`而不是 Main Gui 中？

4.  作为 SWT 程序员，您将如何解决这个问题？

**编辑** 添加表代码

```
private TableViewer createPlotterTable(Composite parent) {
  Composite composite = new Composite(parent, SWT.NONE); 

  viewer = new TableViewer(composite, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION | SWT.BORDER);
  createColumns(parent, viewer);
  Table table = viewer.getTable();
  table.setHeaderVisible(true);
  table.setLinesVisible(true);
  viewer.setContentProvider(new ArrayContentProvider());
  viewer.setInput(parentDialog.getPrintersArray());

  // Layout the viewer
  GridData gridData = new GridData();
  gridData.verticalAlignment = GridData.FILL;
  gridData.horizontalSpan = 2;
  gridData.grabExcessHorizontalSpace = true;
  gridData.grabExcessVerticalSpace = true;
  gridData.horizontalAlignment = GridData.FILL;
  viewer.getControl().setLayoutData(gridData);

  return viewer;
} 
```

**编辑**

表代码在单独的类中，不在主 GUI 类中。

```
public class AplotPlotterDialog extends TitleAreaDialog {
   private AplotBaseDialog parentDialog = null; 
```

# ember.js - 如何控制 Ember.js 将呈现的应用程序模板附加到何处？

> ID：12321145
> 
> 赞同：9
> 
> 时间：2012-09-07T15:30:22.493
> 
> 标签：ember.js

我正在尝试将我的 Ember 应用程序切换为使用 Ember.Router，但在应用程序模板的附加位置存在问题。当我调用 App.initialize() 时，它会在文档末尾呈现模板。有没有办法指定渲染的应用程序模板附加到哪里？

我的应用程序是一个 Rails 应用程序，我正在尝试在我的一个页面上嵌入一个 Ember 应用程序。我不想更改当前页眉和页脚的呈现方式，因此理想情况下我可以指定 ember 呈现模板的位置。

这是一个[jsfiddle](http://jsfiddle.net/rtremaine/vAxkL/2/)示例。你可以看到它呈现：

```
标题内容
页脚内容
测试 1
测试 2
测试 3

```

我正在尝试的是：

```
标题内容
测试 1
测试 2
测试 3
页脚内容

```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-07T16:01:15.020

设置`rootElement`属性：http `Ember.Application`: [//jsfiddle.net/vAxkL/3/](http://jsfiddle.net/vAxkL/3/)

文档：[http ://docs.emberjs.com/symbols/Ember.Application.html](http://docs.emberjs.com/symbols/Ember.Application.html)

**编辑**——通过锚定到 1.0.pre 版本来修复小提琴：http: [//jsfiddle.net/vAxkL/11/](http://jsfiddle.net/vAxkL/11/)

# gitweb - GITWEB - 显示分支上的所有差异

> ID：12321147
> 
> 赞同：1
> 
> 时间：2012-09-07T15:30:23.717
> 
> 标签：gitweb

我们刚刚实现了 gitweb。在摘要页面上有一个分支列表。我希望在一个差异中查看给定分支中所做的所有更改。我可能在该分支中进行了多次提交。

如果我在 gitweb 中单击该分支的链接，它会将我带到最后一次提交。我可以为那个 diff 做一个 commitdiff 并继续往回走，直到父级是我从 master 分支出来的地方。然而，我真正想做的是将它与我​​一枪分离大师时的差异。

我可以修改 url 中的 hp 标签来更改源提交。然而，这是因为我知道正确的父提交。但是，我希望我们的 QC 小组能够在他们不知道实际提交标识符的情况下拉出一个分支并返回到我们分歧的地方。那可能吗？

[https://code.dev.company.com/gitweb?p=the/rules.git;a=commitdiff;h=c013f71861af95a43dd0d6587e2d2334ca4baba2;hp=c065c006a02eeb63d8740832c915c0d254081c30](https://code.dev.company.com/gitweb?p=the/rules.git;a=commitdiff;h=c013f71861af95a43dd0d6587e2d2334ca4baba2;hp=c065c006a02eeb63d8740832c915c0d254081c30)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T13:43:40.000

这是服务器设置错误

# sql-server - 使用 CSLA 将文本文件中的数据导入 sql DB

> ID：12321149
> 
> 赞同：0
> 
> 时间：2012-09-07T15:30:26.770
> 
> 标签：sql-server, import, text-files, csla

我正在尝试使用 CSLA 将数据从 ~ 分隔文本文件导入 SQL Server。我的文本文件中有 92,000 条记录。这是我在导入时遇到的问题

1.  当我创建一个 BusinnessListBase .new 并将我的所有记录添加到其中时，它给了我一个“内存不足异常”。所以要修复它，我创建一个新的 businessbase 对象并保存它。这很好用，而且速度也快得多。需要 15 分钟
2.  我必须再次运行我的程序并检查是否有任何更改并因此更新它们，这是需要太多时间的地方。
3.  有没有其他方法可以加快我的导入速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T17:40:22.983

一个完美的方法是在 Microsoft SQL Server 中使用 OpenRowSet 或 LinkedServers。OpenRowSet 非常方便。参考请看这里：http: [//msdn.microsoft.com/en-us/library/ms190312.aspx](http://msdn.microsoft.com/en-us/library/ms190312.aspx)

另外在我看来15分钟也不是什么好表现！它应该更快。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:33:02.953

我不知道为什么同时使用 CSLA 和实体框架要花这么多时间。但是我更改了我的程序以使用 SQL 批量复制，因为我还必须检查现有记录，所以我创建了另一个临时表并将我的记录导入其中，他们在 SQL 存储过程中执行了 Upsert。整个过程不到一分钟就处理了 92,000 条记录。

# php - JQuery 对话框未出现在当前屏幕中心

> ID：12321152
> 
> 赞同：0
> 
> 时间：2012-09-07T15:30:47.063
> 
> 标签：php, jquery, html, jquery-ui

我有一个测试 php 文件，它在一个表中有 50 个按钮（只是为了制作一个大表）。单击第一个按钮时，我想要一个 JQuery 对话框，其中有一个通过 JQuery 打开的 html 文本框。目前，代码打开文本框，但位于屏幕底部。那是在桌子下面。我的目标是在当前屏幕的中心打开，即不被用户向下滚动。这是我的代码：

```
 <html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.js"></script>
       <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.js">
**<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" />**
</script>
        <script type="text/javascript" >
         $(document).ready(function(){
                  showClick();
        });

        function showClick(){ $('#comment0').click(function(ez) {
        $('#0').dialog('open');
        ez.preventDefault();
        return false;
    });
    $('#0').dialog({
        autoOpen: false,
        modal: true,
        resizable: false,
        title: 'haha',
        height: 'auto',    
        draggable: true,
        position: 'center'
    }); }

    </script>
    </head>
    <body>
    <?php
        ?><div id="0"><input type="text" ></div>
        <?php
        echo "<table>";
        for($i=0; $i<50; $i++) {?>
            <tr>
            <td><input type="button" class="comment0" value="Comment" id="comment0"></td>
            </tr>
            <!--div id="<?php echo $i; ?>" style="display :none"><input type="text" ></div-->       
            <?php
        } ?>
    ​
    <?php
        echo "</table></body></html>";
    ?> 
```

注意：这是一个快速的脏代码，我只是在测试 JQuery 的大表行为。我在这里做错了什么？

谢谢你的帮助！

**编辑**：原来你必须导入 JQuery CSS。现在的问题是，对话框在**表格**的中心打开。对话框是否可以在当前屏幕的中心打开？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:37:47.327

添加 jquery UI 样式表

`<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" />`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-10T13:17:24.680

我终于弄清楚我的程序出了什么问题。在 HTML 中，我没有提供

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

给出这个之后，对话框就在当前屏幕居中了！

# django - 模型实例上的 Django 模型表单错误

> ID：12321153
> 
> 赞同：1
> 
> 时间：2012-09-07T15:30:47.267
> 
> 标签：django, django-forms

试图在 django 中实例化一个模型表单，我传入了一个实例并且我得到了验证错误，尽管数据是从几分钟前从同一个表单输入的。忽略我尝试删除的额外字段，问题仍然存在。它从单独的键值表中添加额外的字段。

Django 1.3 版

```
def edit(request,company_uuid,contact_uuid,address_uuid):
    mcompany = get_object_or_404(models.Company, uuid = company_uuid)
    extra_questions, extra_ids = get_questions(request, 2)
    if request.method == 'POST': # If the form has been submitted...
        form = forms.EditCompanyForm(request.POST,instance=mcompany, extra=extra_questions, extra_ids=extra_ids)
        if form.is_valid():
            fModel = form.save(commit = False)
            for (question, answer) in form.extra_answers():
                save_answer(request, question, answer, mcompany.uuid, 2)
            form.save()    
            url = reverse('contacts_details',kwargs={'company_uuid':mcompany.uuid,
                                                                   'address_uuid':address_uuid,
                                                                   'contact_uuid':contact_uuid})
            return HttpResponseRedirect(url)
    else:
        form = forms.EditCompanyForm(request.POST,instance=mcompany, extra=extra_questions, extra_ids=extra_ids)
    return share.output_page(request,'contacts/edit.html',{'form': form,
                                                            'company_uuid':mcompany.uuid,
                                                            'address_uuid':address_uuid,
                                                            'contact_uuid':contact_uuid}) 
```

* * *

```
class EditCompanyForm(jsforms.JMSModelForm):
    """
    The Company form with the contacts fields included
    """
    name = forms.CharField(label = _('Company Name'),widget = forms.TextInput(attrs={'class':'large-input-box'}))
    discount=forms.FloatField(widget = jsforms.StandardUnit("PC"),required=False)
    allow_download = forms.BooleanField(required=False,label=_('Allow download'))

    def __init__(self, *args, **kwargs):

        extra = kwargs.pop('extra')
        extra_id = kwargs.pop('extra_ids')
        super(EditCompanyForm, self).__init__(*args, **kwargs)

        for i, question in enumerate(extra):
            settings = ExtraFieldSetup.objects.get(uuid=extra_id[i])
            if settings.type == 2:
                list = []
                list_partial = str(settings.extra).split(':')
                for choice in list_partial:
                    x = choice, choice
                    list.append(x)
                self.fields['custom_%s' % i] = forms.ChoiceField(choices=list, label=question, required=False)
            else:
                self.fields['custom_%s' % i] = forms.CharField(label=question, required=False)

    def extra_answers(self):
        for name, value in self.cleaned_data.items():
            if name.startswith('custom_'):
                yield (self.fields[name].label, value)

    class Meta:
        model = models.Company
        exclude = ('company', 'otherdetails', 'jms_code', 'logo', 'hidden', 'user') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:13:44.393

即使在视图的 GET 阶段，您也会传入 request.POST （在 之后`else)`，当 POST 字典为空时，自然会出现验证错误。

# c++ - Visual Studio 目录和包含路径

> ID：12321154
> 
> 赞同：0
> 
> 时间：2012-09-07T15:30:55.387
> 
> 标签：c++, visual-studio-2010

有人请帮我解决这个问题，我认为我没有清楚地理解这一点：

在 Visual Studio 中，当我创建解决方案时，它会询问我创建它的路径

说要创建的目录，我说 c:\work\，我说“sol1”作为目录的名称。

我看到的是在 c:\work\ 中创建了一个名为“sol1”的目录，在“sol1”中还有另一个导演“sol1”，在里面我看到了“Debug”、“sol1”、sol1.sln 等文件夹。

现在说我在 c:\work\codes\code1.cpp 中有一些预先存在的代码

我将code1.cpp添加到visual sudio项目“sol1”adn然后说我在code1.cpp的第一行中有类似#include“codes\code2.h”的东西

那么现在应该如何指示额外的包含目录？如果我对其他包含目录说“../..”之类的话，会发生什么。我的参考目录是什么，从其他目录应该可见。

澄清这个问题将是非常好的人。请详细解释一下。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:35:43.057

如果你使用例如

```
#include "code2.h" 
```

那么预处理器（处理`#include`指令的程序）*应该*`code2.h`在与源文件相同的目录中查找`#include`.

因此，在您的情况下，由于您在其中执行此操作`#include`，`code1.cpp`并且似乎`code2.h`在同一目录中，因此您应该`#include`像上面那样。

# javascript - 从应用程序到 android 浏览器的超链接不加载 javascript

> ID：12321155
> 
> 赞同：1
> 
> 时间：2012-09-07T15:30:58.937
> 
> 标签：javascript, android, browser, refresh

我创建了一个基本的 html css 应用程序，其中包含指向包含照明计算器的移动网页的链接。奇怪的是，当您首先通过浏览器直接访问移动网页时，计算器（使用 javascript）工作正常。另一方面，如果您启动应用程序并单击链接以转到启动浏览器的计算器，除非您刷新页面，否则计算器将不起作用。有没有人对这里发生的事情有任何想法或建议。下面是我正在使用的计算器页面的链接。

[EverLast 计算器网页](http://www.everlastlight.com/lightingcalc/docs/about/costwait.html)

[EverLast 计算器应用程序下载](http://www.everlastlight.com/downloads/app.apk)

# android - XML布局文件Android上的错误空指针异常

> ID：12321160
> 
> 赞同：0
> 
> 时间：2012-09-07T15:31:19.590
> 
> 标签：android, xml, classnotfoundexception

我对 android XML 文件有疑问。我创建了一个名为 profile_page.xml 的布局，并从另一个名为 profile_table_layout.xml 的文件中引用了表格边框的布局；下面是 profile_page.xml 文件的代码....

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal">
    <include
    android:id="@+id/header_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    layout="@layout/header_master" />
    <LinearLayout
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_marginTop="40dp"
    >
    <TableLayout android:id="@+id/table_userDesc" 
                android:layout_height="match_parent" 
                android:layout_width="match_parent" 
                android:background="@drawable/profile_table_layout" >
                <TableRow android:id="@+id/tableUserDesc" 
                          android:layout_width="match_parent" 
                          android:layout_height="wrap_content">

                    <TextView android:padding="5dp" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>
                    <TextView android:padding="5dp" android:id="@+id/textView2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>
                    <TextView  android:padding="5dp" android:id="@+id/textView3" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>

                </TableRow>

                <TableRow android:id="@+id/tableRow2" 
                          android:layout_width="match_parent" 
                          android:layout_height="wrap_content">                    

                    <TextView android:padding="5dp" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>
                    <TextView android:padding="5dp" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>
                    <TextView android:padding="5dp" android:id="@+id/textView1" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textAppearance="?android:attr/textAppearanceMedium" android:text="TextView"></TextView>

                </TableRow>
            </TableLayout>
    </LinearLayout>
</LinearLayout> 
```

我只是有错误代码：

```
 error!
   NotFoundException: null
   Exception details are logged in Window > Show View > Error Log
   The following classes could not be found:
   - TextView 
```

如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:45:20.647

如果不知道您的应用程序代码在做什么，很难说，但从该错误看来，您可能需要将 android.widget.TextView 导入到您的 .java 文件中。

# android - 为 ContentProviderOperation 实现替换

> ID：12321163
> 
> 赞同：1
> 
> 时间：2012-09-07T15:31:24.557
> 
> 标签：android, sqlite, android-contentprovider

我目前正在使用`SQLiteDatabase.replace`更新我的数据库中的某些行。我正在迁移到 ContentProvider 并尝试将这些语句替换为等效的`ContentProviderOperation`. 有更新、删除和插入的工厂方法，但没有`newReplace`. 我猜那是因为文档说这`SQLiteDatabase.replace`是一种方便的方法，它仅在主键匹配时替换该行，否则它会添加一个新的。但是，我不明白引擎盖下到底发生了什么。我假设如果我只是做了 a`delete`那么`insert`它的效率会低于 a `replace`，对吗？

如何模仿`SQLiteDatabase.replace`using的功能`ContentProviderOperation`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:56:24.553

这看起来很有希望（至少对于我的用例而言）：[Android Contentprovider - update within an insert method](https://stackoverflow.com/questions/4285266/android-contentprovider-update-within-an-insert-method)。基本上我需要更改`insert()`我的 ContentProvider 以在失败时进行更新。

# scala - Scala 2.10 中的 Option.fold

> ID：12321164
> 
> 赞同：4
> 
> 时间：2012-09-07T15:31:25.097
> 
> 标签：scala, scala-2.10

在与 scala 2.10.0-M7 的以下会话中：

```
scala> trait A
defined trait A
scala> class B extends A
defined class B
scala> class C extends A
defined class C
scala> Some(0).fold(new B){_=>new C}
<console>:11: error: type mismatch;
 found   : C
 required: B
              Some(0).fold(new B){_=>new C} 
```

我希望编译器找到共同的超类型（即 A）而不是抱怨。它是一般类型推断限制，还是 Option.fold 定义方式的结果？

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T15:36:03.773

Scalas 类型推理算法和方式如何`Option.fold`定义的结合的问题结果。

Scalas 类型推断从左到右工作，这意味着它从最左边的符号开始搜索表达式的可能类型。此外，对于方法参数列表，这意味着泛型类型绑定到由最左侧参数列表填充的类型：

```
scala> def meth[A](a1: A, a2: A) = (a1, a2)
meth: [A](a1: A, a2: A)(A, A)

scala> meth(1, "")
res7: (Any, Any) = (1,"")

scala> def meth[A](a1: A)(a2: A) = (a1, a2)
meth: [A](a1: A)(a2: A)(A, A)

scala> meth(1)("")
<console>:10: error: type mismatch;
 found   : String("")
 required: Int
              meth(1)("")
                      ^ 
```

可以看出，在第一种情况下`Any`是推断出来的，而在第二种情况下，会抛出编译器错误，因为类型`A`受第一个参数列表的约束，而第二个不能再更改它。

但是为了使问题中的方法调用正常工作，`Option`可能直到到达第二个参数列表时才定义结果的类型。因为这需要从右到左的类型推断，因此会出现错误。这有点等同于`List.fold`：

```
scala> List(1).foldLeft(Nil)((xs,x) => x::xs)
<console>:8: error: type mismatch;
 found   : List[Int]
 required: scala.collection.immutable.Nil.type
              List(1).foldLeft(Nil)((xs,x) => x::xs)
                                               ^ 
```

要使代码正常工作，必须明确指定结果集合的类型，请参阅[@rks 答案](https://stackoverflow.com/a/12321634/465304)以获取示例。

[请参阅此处](https://groups.google.com/forum/#!topic/scala-language/35EcioxSQ50)的讨论以获取完整解释为什么它被定义为定义。简而言之：`Option`在很多方面都遵循集合的设计——因此当它的行为方式与集合相同时会更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:00:40.590

我觉得 sschaef 版本不够精确。我不太了解 scala（事实上，我从未使用过它）但我认为这并不取决于函数的实现方式。我也不明白“打字机从左到右”的事情。

我没有最新版本的 Scala，所以我无法在您的示例 venechka 上进行测试，但我认为可以通过添加一些类型注释来规避输入错误/限制。例如，这里是 sschaef 的示例：

```
scala> List(1).foldLeft(Nil)((xs,x) => x::xs)
<console>:8: error: type mismatch;
 found   : List[Int]
 required: scala.collection.immutable.Nil.type
              List(1).foldLeft(Nil)((xs,x) => x::xs)
                                               ^

scala> List(1).foldLeft(Nil : List[Int])((xs,x) => x::xs)
res1: List[Int] = List(1) 
```

而且我相信您可以通过执行以下操作在您的示例中做同样的事情：

```
Some(0).fold(new B : A){_=>new C} 
```

同样，我认为这是 Scala 类型器的限制（可能是由于子类型的存在），但在强烈确认之前我必须环顾四周。

无论如何，在这里和那里添加类型注释应该对你有用，所以享受吧！

编辑：哦，sschaef 编辑了他的答案以做出一些解释，这可能会使我所说的关于这种行为的原因无效。但这并没有改变类型注释将解决您的问题的事实。所以我会让这个消息到位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T16:02:20.087

这是类型推断算法的一般限制。跨列表折叠也有同样的限制。引用*[Scala 中的编程](http://www.artima.com/pins1ed/working-with-lists.html)*：

> 请注意，两个版本的 flatten 都需要在作为折叠起始值的空列表上添加类型注释。这是由于 Scala 类型推断器的限制，它无法自动推断列表的正确类型。

Scala 的类型推断算法在具有多个参数列表的方法中以增量方式工作。第一个中指定的类型可用于第二个中的推理，第三个中的第二个等。[如样式指南中所述](http://docs.scala-lang.org/style/declarations.html#multiple_parameter_lists)，这允许您在`fold`函数中使用更简单的语法，因为推理引擎知道列表的类型和第一个参数列表中的累加器类型。

但是，由于它在连续参数列表中以增量方式工作，因此推理引擎在将函数参数的类型推断为`fold`. 相反，您会收到类型错误。

在上面的示例中，只需在累加器值上添加类型注释即可：

```
Some(0).fold(new B: A){_=>new C} 
```

# shell - 为找到的每个 .txt 文件创建单独的 zip 文件并在之后移动它们的脚本

> ID：12321167
> 
> 赞同：17
> 
> 时间：2012-09-07T15:31:27.537
> 
> 标签：shell, unix

我需要一个基本上可以做到这一点的shell脚本：

*   在文件夹中搜索所有 txt 文件，并为找到的每个文件创建一个单独的 zip 文件，该文件与找到的 txt 文件相同 + .zip。
*   之后将创建的 zip 文件移动到 txt 文件。

基本上，它是一个脚本，用于将 txt 文件列表替换为其 zip 等效文件但保持相同的名称。

我已经使用 find 来查找要压缩的文件：

```
find . -name '.txt.' -print 
```

结果是：

```
./InstructionManager.txt.0
./InstructionManager.txt.1 
```

这些是我想单独压缩的文件（当然它们会更多），但不知道如何将它们单独用作 make 命令的参数，例如：

```
zip ./InstructionManager.txt.0.zip ./InstructionManager.txt.0
mv ./InstructionManager.txt.0.zip ./InstructionManager.txt.0
zip ./InstructionManager.txt.1.zip ./InstructionManager.txt.1
mv ./InstructionManager.txt.1.zip ./InstructionManager.txt.1 
```

有任何想法吗？不，我不想要包含所有文件的 zip：S 谢谢

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-07T16:47:32.800

```
find . -name '*.txt.*' -print -exec zip '{}'.zip '{}' \; -exec mv '{}'.zip '{}' \; 
```

*   查找`.txt`文件
*   第一个`-exec`压缩文件
*   第二个`-exec`将压缩文件重命名为原始名称

请注意，此过程会覆盖原始文件。为确保新文件是实际的 zip 文件，您可以执行以下操作：

```
file InstructionManager.txt.* 
```

哪个应该返回：

```
InstructionManager.txt.0: Zip archive data, at least v1.0 to extract
InstructionManager.txt.1: Zip archive data, at least v1.0 to extract 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-07T16:45:55.493

使用查找和压缩：

```
find . -name '*.txt.*' -exec zip '{}.zip' '{}' \; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T17:12:24.893

使用`find`and `xargs`, 接受带空格的文件名：

```
find . -name '*.txt.*' -print0 | xargs -0 -r -n1 -I % sh -c '{ zip %.zip %; mv %.zip %;}' 
```

文件被压缩，然后重命名为其原始名称

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-10T15:34:24.963

如果要在单独压缩所有内容后删除原始文件，则可以使用以下命令。

```
$ find . -name '*.txt.*' -print -exec zip '{}'.zip '{}' \; -exec rm '{}' \; 
```

# php - 一个更简单的方法来删除之前的所有内容，包括第一次出现的字符？

> ID：12321172
> 
> 赞同：3
> 
> 时间：2012-09-07T15:31:53.583
> 
> 标签：php

正如标题所说，这真的是出于兴趣，我的文件名格式为`1347020478_Workbook1 12.19.19.csv`- 我想要做的是将时间戳从文件名的开头移开并返回其他所有内容，所以`Workbook1 12.19.19.csv`

我有以下代码可以正常工作：

```
$original_filename = explode('_', $list->file);
$timestamp         = array_shift($original_filename);
$original_filename = implode('_', $original_filename); 
```

正如我所说，上面的代码有效，但我想知道是否有更简单的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T15:34:09.657

您可以使用[`stristr()`](http://php.net/manual/en/function.stristr.php)和的组合[`ltrim()`](http://php.net/manual/en/function.ltrim.php)来避免生成数组：

```
$original_filename = ltrim(stristr($list->file, '_'), '_'); 
```

请参阅手册：`stristr`返回从第一次出现的 needle 到结束的所有 haystack。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T15:35:33.600

您可以使用字符串函数，例如[`strpos()`](http://php.net/manual/en/function.strpos.php)和[`substr()`](http://php.net/manual/en/function.substr.php)：

```
$original_filename = '1347020478_Workbook1 12.19.19.csv';
echo substr( $original_filename, strpos( $original_filename, '_') + 1); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-07T15:53:44.030

如果你知道长度是固定的，你可以使用 substr。如果没有，您可以先使用 strpos 。下面给了我 1-2 ms 用于固定长度的“substr”方法，4ms 用于“shift-implode”方法，以及 1-2 ms 用于可变长度“substr”方法。（如果我让数组更大，它会耗尽内存，但你明白了。）

```
$loops=1000000;

$filename="1347020478_Workbook1 12.19.19.csv"; 
for ($i=0;$i<$loops;$i++){
    $fn[$i]=$filename;
}

$start1=time();
for ($i=0;$i<$loops;$i++){
    $newname=substr($fn[$i],11);    
}
$end1=time();
echo $newname." time=".($end1-$start1)."<br><br>";

$filename="1347020478_Workbook1 12.19.19.csv"; 
for ($i=0;$i<$loops;$i++){
    $fn[$i]=$filename;
}

$start1=time();
for ($i=0;$i<$loops;$i++){
    $original_filename  = explode('_', $fn[$i]);
    $timestamp          = array_shift($original_filename);
    $original_filename  = implode('_', $original_filename);    
}
$end1=time();
echo $original_filename." time=".($end1-$start1)."<br><br>";

$filename="1347020478_Workbook1 12.19.19.csv"; 
for ($i=0;$i<$loops;$i++){
    $fn[$i]=$filename;
}

$start1=time();
for ($i=0;$i<$loops;$i++){
    $st=strpos($fn[$i],"_");
    $newname=substr($fn[$i],$st+1);    
}
$end1=time();
echo $newname." time=".($end1-$start1); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-07T15:56:29.273

滥用时间戳将长时间固定长度这一事实，只要您的所有时间戳都位于格林威治标准时间**2001 年 9 月 9 日**星期日 01:46:40 格林威治标准时间和格林威治标准时间**2286 年 11 月 20 日**星期六17:46:39 之间，最简单的方法是：

```
$original_filename = substr($list->file, 11); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-07T15:34:12.290

尝试：

```
preg_replace('/^[0-9]+_/', '', $filename); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T15:33:57.110

对于您的文件名列表`foreach`，请执行 aa `preg_replace`。同样的结果，少了 2 步。

# bash - 如何更安全地阅读 bash 脚本样式的配置？

> ID：12321174
> 
> 赞同：1
> 
> 时间：2012-09-07T15:31:56.020
> 
> 标签：bash, config

简单的方法：

```
# Read environment from config file

set -o allexport
source my_config_file.conf
set +o allexport 
```

配置文件的格式是这样的：

```
VAR1=eee
VAR2="dsfsdf sd fsdf"
VAR3=$VAR1
# comment 
```

如何更安全地做到这一点（允许一些扩展，但没有实际执行配置文件中的命令）。“安全”应该防止偶尔将错误的片段插入配置，而不是防止特制的攻击。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:53:25.197

`VAR1=eee`是一个命令，那么你要停止哪些命令？假设它是外部程序。

一种方法是丢弃 PATH：

```
oldPATH="$PATH"
PATH=
set -o allexport 
source /full-path-name/my_config_file.conf 
set +o allexport 
PATH="$oldPATH" 
```

可是等等！命令是“散列”的，因此您还需要先清除散列，所以添加`hash -r`. 您可能还需要清除别名，例如`ls`通常是别名。

这很容易通过提供命令的完整路径名来解决，例如`/usr/bin/man`，但这是您可以做的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T18:49:33.660

如果您想将 .conf 文件限制为仅允许某些允许的模式，您可以执行以下操作：

```
eval `awk -v FS="=[\"]*" -v RS="[\"]*\n" '/^[A-Z0-9]+=/ { printf("export %s=\"%s\"; ", \$1, \$2); }' my_config_file.conf`; 
```

awk scriptlet 中的正则表达式可以灵活或严格，类似于`^((VAR1)|(VAR2)|(VAR3))=`.

`.`仍用于“运行”分配，但仅从 .conf 文件运行“可接受”行。上面的模式过滤了所有看起来不像由大写字母和数字字符组成的变量的简单赋值的行。更高级的正则表达式可以允许更多的情况或灵活性。上面的 RS 表示忽略尾随引号。FS 说，如果在 = 之后有一个引号，那么它会被忽略。FS/RS 组合导致从值中去除引号。输出仅转换为语句，例如`export VAR="VALUE"`.

This does not protect from "attacks" as the value is not parsed at all, but such filtering could be added easily enough.

# java - Java 中的 ArrayList 或 List 声明

> ID：12321177
> 
> 赞同：77
> 
> 时间：2012-09-07T15:32:03.067
> 
> 标签：java, arraylist

这两个声明有什么区别？

**声明一：**

```
ArrayList<String> arrayList = new ArrayList<String>(); 
```

**声明 2：**

```
List<String> arrayList = new ArrayList<String>(); 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-09-07T15:32:58.687

```
List<String> arrayList = new ArrayList<String>(); 
```

是通用的，您希望在将实现细节返回给客户端时隐藏实现细节，稍后您可以将实现从透明更改`ArrayList`为`LinkedList`透明。

这种机制在您设计库等的情况下很有用，这可能会在某个时间点更改它们的实现细节，而客户端的更改最少。

```
ArrayList<String> arrayList = new ArrayList<String>(); 
```

这要求您始终需要返回`ArrayList`。在某个时间点，如果您想将实现细节更改为`LinkedList`，客户端也应该进行更改以使用`LinkedList`而不是`ArrayList`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-04-23T09:03:45.310

`List`是一个接口，`ArrayList`是 List 接口的一个实现。除了 List 接口中可用的方法之外，该类`ArrayList`只有几个方法`(i.e clone(), trimToSize(), removeRange() and ensureCapacity())`。这没有太大区别。

```
 1\. List<String> l = new ArrayList<>();
   2\. ArrayList<String> l = new ArrayList<>(); 
```

如果使用第一个，您将能够调用 List 接口中可用的方法，而不能调用`ArrayList`类中可用的新方法。`ArrayList`如果你使用第二种方法，你可以自由使用所有可用的方法。

我会说第一种方法更好，因为当您开发 Java 应用程序时，当您应该将集合框架对象作为参数传递给方法时，最好使用第一种方法。

```
List<String> l = new ArrayList<>();
doSomething(l); 
```

将来由于性能限制，如果您要更改要使用的实现`LinkedList`或其他实现`List`接口的类，而不是`ArrayList`，您只需在某一点进行更改（实例化部分）。

```
List<String> l = new LinkedList<>(); 
```

否则，您将应该在所有地方进行更改，无论您使用特定的类实现作为方法参数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-07T15:33:51.963

不同之处在于变体 1 强制你使用`ArrayList`while 变体 2 只保证你有任何实现的东西`List<String>`。

稍后您可以轻松地将其更改为`List<String> arrayList = new LinkedList<String>();`。变体 1 可能不仅需要更改该行，还需要更改其他部分（如果它们依赖于使用`ArrayList<String>`.

因此，我`List<String>`几乎在任何情况下都会使用，除非我需要调用`ArrayList`提供的附加方法（迄今为止从未如此）：`ensureCapacity(int)`和`trimToSize()`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-07T15:34:13.710

第一个声明必须是 ArrayList，第二个可以轻松更改为另一种 List 类型。因此，第二个是首选，因为它清楚地表明您不需要特定的实现。（有时您确实需要一种实现，但这种情况很少见）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-04-23T08:36:42.717

基本上，它允许 Java 通过泛型类型声明（如 ）在一个结构实现中存储多种类型的对象`class MyStructure<T extends TT>`，这是 Java 的主要特性之一。

面向对象的方法基于关注点分离的模块化和可重用性 - 能够将结构与任何类型的对象一起使用（只要它遵守一些规则）。

您可以按如下方式实例化事物：

```
ArrayList list = new ArrayList(); 
```

代替

```
ArrayList<String> list = new ArrayList<>(); 
```

例如，通过声明和使用泛型类型，您将告知结构它将管理的对象类型，并且编译器将能够通知您是否将非法类型插入该结构。比方说：

```
// this works
List list1 = new ArrayList();
list1.add(1);
list1.add("one");

// does not work
List<String> list2 = new ArrayList<>();
list2.add(1); // compiler error here
list2.add("one"); 
```

如果您想查看一些示例，请查看文档[文档](https://docs.oracle.com/javase/tutorial/java/generics/types.html)：

```
/**
 * Generic version of the Box class.
 * @param <T> the type of the value being boxed
 */
public class Box<T> {
    // T stands for "Type"
    private T t;

    public void set(T t) { this.t = t; }
    public T get() { return t; }
} 
```

然后你可以实例化类似的东西：

```
class Paper  { ... }
class Tissue { ... }

// ...
Box<Paper> boxOfPaper = new Box<>();
boxOfPaper.set(new Paper(...));

Box<Tissue> boxOfTissues = new Box<>();
boxOfTissues.set(new Tissue(...)); 
```

从中得出的主要结论是，您要指定要装箱的对象类型。

至于 using `Object l = new ArrayList<>();`，您没有访问`List`or`ArrayList`实现，因此您无法对集合做太多事情。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-11T11:42:22.183

很容易将实现更改`List`为`Set`：

```
Collection<String> stringList = new ArrayList<String>();
//Client side
stringList = new LinkedList<String>();

stringList = new HashSet<String>();
//stringList = new HashSet<>(); java 1.7 and 1.8 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-07T15:33:32.723

List 是接口，ArrayList 是实现的具体类。始终建议使用。

```
List<String> arrayList = new ArrayList<String>(); 
```

因为这里的列表引用是灵活的。它也可以容纳`LinkedList or Vector`物体。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-07T15:36:32.573

在某些情况下，您可能更喜欢第一种来（稍微）提高性能，例如在一些[没有 JIT 编译器的](http://developer.android.com/guide/practices/performance.html#myths)JVM 上。

在那种非常具体的上下文中，您应该使用第一个。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-07T15:39:47.147

可能你可以参考这个链接 [http://docs.oracle.com/javase/6/docs/api/java/util/List.html](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)

List是一个接口。ArrayList，LinkedList等是实现list的类。当你使用List接口时，你必须使用ListIterator迭代元素并且可以向前和向后移动，在List中就像在ArrayList中使用Iterator迭代并且它的元素可以访问单向方式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-27T18:18:12.050

每当您看到来自 Guava 等开源社区和 Google Developer（Android 库）的编码时，他们都会使用这种方法

```
List<String> strings = new ArrayList<String>(); 
```

因为它对用户隐藏了实现细节。你正是

```
List<String> strings = new ArrayList<String>(); 
```

这是通用方法和这种专门的方法

```
ArrayList<String> strings = new ArrayList<String>(); 
```

供参考：Effective Java 2nd Edition：Item 52：通过接口引用对象

# python - Flask - Apscheduler 无法调用执行数据库命令的函数

> ID：12321178
> 
> 赞同：4
> 
> 时间：2012-09-07T15:32:10.923
> 
> 标签：python, flask, scheduler

```
Python: 2.7.3

Flask: 0.9 
```

你好，我想用`Apscheduler`. 每辆车`distance`在数据库中都有将定期增加的列。

这是导入部分

```
from __future__ import with_statement
from flask import Flask, request, session, g, redirect, url_for, \
    abort, render_template, flash, views
from sqlite3 import dbapi2 as sqlite3
from contextlib import closing
from apscheduler.scheduler import Scheduler 
```

这是代码片段：

```
sched = Scheduler()
sched.add_interval_job(moveAllCars, seconds = 5)
sched.start()

def moveAllCars():
    print "debug 1"
    dbCommand = g.db.execute('SELECT CarID FROM Car')
    print "debug 2"
    #and so on 
```

我没有编写完整的代码，因为错误发生在“调试 1”之后，并显示错误消息：找不到记录器“apscheduler.scheduler”的处理程序。谷歌并没有太大帮助。

但调度程序仍在运行，每 5 秒仅打印一次“debug1”。错误消息仅在第一个循环期间出现。

有人知道解决方案吗？之前谢谢

[更新]

使用后`logging`，我发现它是 RunTimeError: working outside of request context。除了使用 with 之外还有其他解决方案`app.test_request_context`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T17:19:13.123

`g`大概是一个`threading.local()`。不同的线程在其中看到不同的值。

`g.db`可能会为每个请求分配一个新的数据库连接。没有当前请求 - 没有连接。

您可以在 move_all_cars() 中创建数据库连接或将其作为参数显式传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T08:41:00.407

```
from os import getcwd
import logging
logging.basicConfig(
        filename=''.join([getcwd(), '/', 'log_file_name']),
        level=logging.DEBUG,
        format='%(levelname)s[%(asctime)s]: %(message)s'
) 
```

以上对我的情况确实有帮助。

*凯珀*

# c++ - 我如何控制野牛将 C++ 代码放在哪里？

> ID：12321179
> 
> 赞同：0
> 
> 时间：2012-09-07T15:32:10.917
> 
> 标签：c++, header, bison

我试图控制野牛在c ++模式和定义模式下使用它时输出代码序言部分的位置（即写出标题）

基本上，我有：-

```
%{
  // stuff that should go into the parser.tab.hxx
%}
%{
  // stuff that should go into the parser.tab.cxx
%} 
```

我正在使用野牛 2.3，并且无法轻松访问野牛 2.5（它似乎具有某种功能可以做同样的事情）。

我也知道这可以做到，因为网上的一些例子似乎能够做到这一点......有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:01:31.053

简单的解决方法：在具有您希望源文件具有的名称的文件中，放入

```
#include "parser.tab.cxx" 
```

没有别的了。对于`.hxx`文件也是如此。（确保您的构建系统不会尝试构建`.cxx`目录中的所有文件。）

# xml - 从 XML 在数据库中创建测试数据

> ID：12321183
> 
> 赞同：0
> 
> 时间：2012-09-07T15:32:41.297
> 
> 标签：xml, junit, test-data

我正在寻找一个允许我使用 XML 来设置单元测试数据的框架。

我做了很多开发，其中 Web 前端与一个或多个后端数据库服务器上的多个表连接。出于单元测试的目的，我将数据插入到内存中的 HSQLDB 表中，并针对它运行数据库操作。它速度很快，并提供了相当好的单元测试环境。

Hibernate 也可以很好地配合它。我只是告诉它我在单元测试中使用 HSQLDB 方言，在生产中使用 DB2 方言，它处理了它们之间的差异。

我经常使用在 SQL 广泛使用之前在生产环境中使用的遗留表。很多`decimal(7,2)`领域。很多（我的意思是很多）复合键和索引。我有一些情况，这个表有一个由这两个字段组成的复合 PK，这实际上是另一个表的复合 PK 的 FK，加上这个表特定的几个其他字段。我们有`decimal(8,0)`实际上是 YYYYMMDD 值的字段。后者实际上是复合 PK 的一部分。

我不会修改这个环境。其中一些表格已经在生产中使用了几十年。

HSQLDB 可以很好地处理这一切。它可以模拟所有这些东西。我什至可以创建上述`decimal(8,0)`-cum-date 字段之一，在其中获取当前日期，在其中添加/减去多天，然后将其转换为`decimal(8,0)`值。

我通过创建多个 SQL 文件来做到这一点。一个包含`create table`一个表的语句，一个包含一堆`insert`将数据插入该表的语句。JUnit 执行这些以设置上下文，然后针对上下文运行实际的单元测试。任何使用 JUnit 和 Spring 的人都可能熟悉这种设置。

问题是我最终不得不在一个文件中硬分配 PK 值，然后与其他文件中的记录保持参照完整性。

用手。

保持这一点令人头疼。仅仅因为我想添加另一个测试用例或修改现有的测试用例，我已经失去了维护跨多个文件的引用所花费的时间。

我想要一个可以读取/解析这些`create table`语句的框架，或者从创建的表中提取模式数据，并且可能需要一些额外的配置来告诉它表 B 中的这些字段实际上是表 A 中复合 PK 的 FK。

然后，如果我想创建一个类似于以下内容的 XML 文件：

```
<table_A field1="value" field2="value" pkField1="value" pkField2="value">
  <table_B field1="value" field2="value" pkField3="value" />
  <table_B field1="value" field2="value" pkField3="otherValue" timeField="+5 minutes"/>
</table_A> 
```

并让它在表 A 中创建一条记录，根据需要记下 PK 值，然后在表 B 中创建两条记录，并使用适当的 FK 值，并且表 B 中的第二条记录具有`time`比前一条晚 5 分钟的字段。除非我想要/需要，否则我不必在一个表或另一个表中明确列出参考字段值。系统可以根据需要自动生成字段，并根据需要将它们转发给 FK。

我希望能够嵌套任意多层次的深度。在我的脑海中，我可以想象：

```
<table_a ...>
  <table_b ... />
  <table_b ... />
  <table_b ... />
  <table_c ... />
  <table_c ... />
  <table_d ...>
    <table_e ...>
      <table_f ...>
        <table_g ... />
        <table_g ... />
        <table_h ...>
          <table_i ... />
          <table_i ... />
        </table_h>
      </table_f>
    </table_e>
  </table_d>
</table_a> 
```

在我现有的一个项目中。

我希望能够在一个文件中指定整个数据集，而不是九个。很容易看到哪些数据与哪些其他数据相关联。所有这些都被插入到适当的表中，这些表可能并不都在同一个数据源上。

我们过去常常用模拟对象做很多事情，在单元测试阶段用这些代替数据库操作。当代码进入动手测试阶段并且必须与数据库交互时，我们遇到了问题。因此，模拟对象是不够的；数据必须写入数据库，系统确保 PK 和 FK 都正确地相互引用。

简而言之，问题是：有没有人知道可以实现上述所有功能的框架？包括做日期/时间数学的能力？并转换成其他格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:37:52.330

我不确定它是否会完全消除您对复杂测试数据的痛苦，但我认为[DBUnit](http://www.dbunit.org/)至少会减轻一点。值得一看和尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:38:04.730

我不知道有什么工具可以完全符合要求，但是，您看过[Red Gate 的 SQL 数据生成器](http://www.red-gate.com/products/sql-development/sql-data-generator/)吗？Red Gate 制作了非常好的 SQL 工具。

我认为您在单元测试中使用模拟对象的问题：

> 因此，模拟对象是不够的；数据必须写入数据库，系统确保 PK 和 FK 都正确地相互引用。

可以改进。如果业务对象具有基于对象关系的适当验证，那么单元测试将更加有用。

# jquery - 从 jQuery 托管在 IIS 中的简单 WCF 调用出现 404 错误

> ID：12321189
> 
> 赞同：0
> 
> 时间：2012-09-07T15:33:00.607
> 
> 标签：jquery, ajax, wcf, http-status-code-404

这听起来像是一篇非常熟悉的帖子，但我正在尝试从本地 IIS 托管的 ASP.NET WebApp 调用本地 IIS 托管的 WCF 服务。本地 Web 应用程序可以从下面的 AJAX 调用中成功“调用” .svc 文件，但只要我添加 /GetData?value=2，我就会开始收到 404 错误。

WCF 服务和 Web 应用程序都托管在 IIS7 的 localhost 上，因此我不应该遇到任何跨域问题。

很抱歉，同样的问题已经被问了大约 1 亿次，而我只是另一个试图让它工作的 WCF 菜鸟，但我们将不胜感激任何帮助。我已经在谷歌上搜索并尝试了大约一天的不同事情，我终于提交了。

谢谢，杰森

这是我的服务合同：

```
namespace WcfService1
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the interface name "IService1" in both code and config file together.
    [ServiceContract]
    public interface IService1
    {

        [OperationContract]
        [WebInvoke(Method="GET", ResponseFormat=WebMessageFormat.Json)]
        string GetData(int value);

        [OperationContract]
        CompositeType GetDataUsingDataContract(CompositeType composite);

        // TODO: Add your service operations here
    }

    // Use a data contract as illustrated in the sample below to add composite types to service operations.
    [DataContract]
    public class CompositeType
    {
        bool boolValue = true;
        string stringValue = "Hello ";

        [DataMember]
        public bool BoolValue
        {
            get { return boolValue; }
            set { boolValue = value; }
        }

        [DataMember]
        public string StringValue
        {
            get { return stringValue; }
            set { stringValue = value; }
        }
    }
} 
```

这是服务实现：

```
namespace WcfService1
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "Service1" in code, svc and config file together.
    [AspNetCompatibilityRequirements(RequirementsMode=AspNetCompatibilityRequirementsMode.Allowed)]
    public class Service1 : IService1
    {
        public string GetData(int value)
        {
            return string.Format("You entered: {0}", value);
        }

        public CompositeType GetDataUsingDataContract(CompositeType composite)
        {
            if (composite == null)
            {
                throw new ArgumentNullException("composite");
            }
            if (composite.BoolValue)
            {
                composite.StringValue += "Suffix";
            }
            return composite;
        }
    }
} 
```

这是服务 web.config：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>

  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="default">
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true" />
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
        <endpointBehaviors>
            <behavior name="httpEndPoint">
                <webHttp />
                <!--<enableWebScript />-->
            </behavior>
        </endpointBehaviors>
    </behaviors>
      <services>
          <service behaviorConfiguration="default" name="Service">
              <endpoint address="" binding="webHttpBinding" contract="WcfService1.IService1" behaviorConfiguration="httpEndPoint"></endpoint>
              <endpoint address="mex" binding="webHttpBinding" contract="IMetadataExchange" behaviorConfiguration="httpEndPoint"></endpoint>
          </service>
      </services>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>

 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
        <defaultDocument>
            <files>
                <add value="Service1.svc" />
            </files>
        </defaultDocument>
  </system.webServer>

</configuration> 
```

这是我的 AJAX 调用：

```
 $(document).ready(
        function()
        {
            $.ajax(
                {
                    type: "GET",
                    url: "http://localhost/testservice/GetData?value=2",
//                    contentType: "application/json; charset=utf-8",
//                    DataType: "jason",
                    success: function() { alert("success"); },
                    error: function(result) { alert(result.status + " " + result.statusText); }
                }
            );
        }
    ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T00:22:34.193

由于配置中的 webHttp 标签，您已经设置了休息服务。

代替

```
http://localhost/testservice/GetData?value=2 
```

做

```
http://localhost/testservice/GetData/2 
```

# iphone - 在 iOS 上使用 phonegap 打开 Web 链接

> ID：12321193
> 
> 赞同：0
> 
> 时间：2012-09-07T15:33:08.923
> 
> 标签：iphone, ios, cordova

好的，我想这应该很简单。我四处寻找，但一切都在我头上。我只是想在应用程序中放置一个超链接。这个应用程序是由第三方编写的，我没有使用 phonegap 的经验。当我单击链接时，它会改变颜色，但什么也不做。它不会在应用程序中打开链接，也不会在浏览器中打开。所以这就是我尝试过的，认为它会像看起来一样简单。

```
html: '<center><a href="http://www.somesite.com" target="_blank">poo</a></center>' 
```

如果有帮助，这是它所在的全部代码。

```
try {
    Ext.define("app.view.login", {
        extend: "Ext.Panel",
        id: "login",
        xtype: "login",
        requires: ["app.widget.entry", "app.widget.loader", "app.widget.notification"],
        config: {
            fullscreen: true,
            background: "white",
            layout: {
                type: "vbox",
                align: "center",
                animation: {
                    type: "slide"
                }
            },
            defaults: {
                width: "90%"
            },
            items: [{
                flex: 1,
                layout: {
                    type: "vbox",
                    align: "center",
                    pack: "justify"
                },
                items: [{
                    xtype: "spacer"
                }, {
                    xtype: "component",
                    width: "100%",
                    html: '<center><a href="http://www.somesite.com" target="_blank">poo</a></center>'
                }, {
                    xtype: "spacer"
                }, ]
            }, {
                flex: 1,
                layout: {
                    type: "vbox",
                    align: "center"
                },
                defaults: {
                    width: "96%"
                },
                items: [{
                    xtype: "entry",
                    label: "User Name",
                    testExists: true
                }, {
                    flex: 1,
                    height: "0.5em"
                }, {
                    xtype: "entry",
                    label: "Password",
                    type: "password",
                    testExists: true
                }, {
                    flex: 1,
                    xtype: "spacer"
                }, {
                    xtype: "button",
                    text: "Login",
                    width: "50%"
                }, {
                    flex: 1,
                    xtype: "spacer"
                }, ]
            }, ]
        },
    })
} 
```

显然我不明白一些事情。任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T07:39:56.347

要在 Phonegap 中打开 url，您应该首先将其添加到白名单（cordova.plist 中的外部主机），除非您在那里添加 url，否则您将面临白名单拒绝错误（请参阅您的日志文件）以获取更多信息，请访问：[域白名单指南](http://docs.phonegap.com/en/1.9.0/guide_whitelist_index.md.html)

# c++ - 矢量格式化 C++

> ID：12321195
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:33:16.817
> 
> 标签：c++, vector

我是矢量新手，我正在尝试在正方形中显示矢量，就像您可以在正方形中显示数组一样。这是可能的还是您必须显示多个向量，如下所示：

```
#include <iostream>
#include <vector>

using namespace std;

int main()
{
    vector<int>v(3);
    vector<int>w(3);
    vector<int>x(3);
    for(int i = 0; i < 2; i++)
    {
        v[i] = i;
        w[i] = i;
        x[i] = i;
        cout << v[i] << " " << w[i] << " " << x[i] << endl;

    }
    return 0;
} 
```

展示：

```
0 0 0 
1 1 1 
2 2 2 
```

如何在正方形中显示一个矢量？请记住，在此阶段显示很重要，而不是向量的值！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:34:57.783

不，你的代码不正确。向量和 C++ 中的所有数组一样，都是从 0 开始索引的；因此有效索引从`0`到`size() - 1`。您的代码使用 index `size()`，因此具有未定义的行为。

与您坚持的不同，当您将它们用作向量的索引时，这些值非常重要*。*如果您只是想显示数字，则根本不需要任何向量（您可以随意选择范围）：

```
for (int i = 1; i <= 3; ++i)
    std::cout << i << ' ' << i << ' ' << i << '\n'; 
```

不，您不需要多个向量来显示“平方值”。如果你想将单个向量的内容输出到多行，你所要做的就是决定你想要在一行上有多少个元素，然后在每这么多元素之后输出一个换行符，即

```
std::vector<int> vec = { 1, 3, 5, 7, 9, 2, 4, 6, 8 };
int elements_on_this_line = 0,
    elements_to_output_per_line = 3;
for (int i: vec) {
    std::cout << i;
    elements_on_this_line++;
    if (elements_on_this_line == elements_to_output_per_line) {
        std::cout << '\n';
        elements_on_this_line = 0;
    } else {
        std::cout << ' ';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:58:19.417

> 我正在尝试在正方形中显示矢量，就像您可以在正方形中显示数组一样。那可能吗

当然，为什么不呢？

```
#include <iostream>
#include <vector>

int main()
{
    std::vector<int> vec { 1, 3, 5, 7, 9, 2, 4, 6, 8};
    auto it = vec.begin();
    for (int y = 0; y < 3; ++y)
    {
        for (int x = 0; x < 3; ++x)
        {
            std::cout << *it++ << ' ';
        }
        std::cout << '\n';
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:11:22.840

我修复了执行以下操作的代码：

```
#include <iostream>

#include <vector>
using namespace std;
int main()
{
  vector<vector<int> > v;
  int k = 0;
  for ( int i = 0; i < 5; i++ ) {
    v.push_back ( vector<int>() );
    for ( int j = 0; j < 5; j++ )
    v[i].push_back ( k++ );
}
for ( int i = 0; i < 5; i++ ) 
{
  for ( int j = 0; j < 5; j++ )
    cout<<v[i][j] <<' ';
    cout<<'\n';
}
} 
```

谢谢您的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:43:35.093

由于值相同，您可以这样做：

```
int main() {
    std::vector<int>v = {1,2,3};
    for(auto& i : v)
        std::cout << i << " " << i << " " << i << std::endl;
} 
```

# java - 检测鼠标点击小程序外的java

> ID：12321197
> 
> 赞同：0
> 
> 时间：2012-09-07T15:33:17.300
> 
> 标签：java, applet, mouse, awt, mouselistener

> **可能重复：**
> [如何在Java中获取我的窗口外的鼠标点击坐标](https://stackoverflow.com/questions/2419555/how-to-obtain-mouse-click-coordinates-outside-my-window-in-java)

无论您在什么应用程序中，都可以使用 java 检测鼠标点击吗？

例如，现在我在浏览器中，很快我点击了“发布您的问题”

我想注册那个鼠标点击。

如果可能的话，鼠标左右键之间的检测会更好。

可能的？

编辑：

不是浏览器！！

我想在玩第三人称射击游戏时跟踪我的鼠标行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:47:38.210

我不知道是否有一个 Java 库可以让您记录键盘/鼠标输入然后重放它们，但是，您可以使用 java.awt.Robot 编写任何鼠标/键盘行为的脚本：

[http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html](http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html)

这是一个为您键入“Hi buddy”的示例：

[http://www.javalobby.org/java/forums/t84094.html](http://www.javalobby.org/java/forums/t84094.html)

我用过的唯一一个允许您记录键盘/鼠标输入然后将它们回放给您的软件是 IBM Functional Tester。

# asp-classic - 带有撇号的值被截断

> ID：12321198
> 
> 赞同：1
> 
> 时间：2012-09-07T15:33:27.157
> 
> 标签：asp-classic

我有一个问题，我从数据库中提取值。这些值中有撇号，但是当它们显示在页面上时，字符串会在撇号处停止（即今天显示为今天）。

如何让整个字符串显示？

这是我显示字符串的地方：

代码：

```
<h1 class='tabletitle'><%=rs("FloorName")%> & nbsp;(<%=dspLayoutName%>)</h1> 
```

包含撇号的变量是“dspLayoutName”。它可以来自数据库或传递给页面。我正在使用 asp 经典。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T09:44:24.560

好吧，我建议您执行以下操作

使用 ' 并输入 ';' 之后，这肯定对你有用。

<%=替换 (rs("FloorName"), "'", "& #39;")%> 而不是使用 <%=rs("FloorName")%>

我在替换函数中的 & 和 # 之间放置了空格，因为它返回单引号。

快乐编码！！！

# database - 数据库行快照/修订

> ID：12321200
> 
> 赞同：9
> 
> 时间：2012-09-07T15:33:39.517
> 
> 标签：database, temporal-database

我正在寻找一个合适的过程来保存数据库中行（及其关系）的修订或快照。

以电子商务平台为例-

*   客户创建订单。订单与帐单地址和送货地址相关联。
*   所述客户然后在他们的个人资料中更改他们的地址簿中的地址。
*   原始订单的地址不应更改。

我看过一些概念，一个是重复表，另一个是临时数据库，另一个是保留修订 ID 和活动标志。

虽然我很感激没有人能真正告诉我最好/最适合我的应用程序的解决方案，因为这是一个开放的意见等问题，我希望有人能够通过比较来证明优点/缺点。我已经阅读了很多关于 SO 的问题，以及一些关于各种实现的文章，但没有人真正比较每个想法或指出它们最适合的地方。下面我概述了我对每个概念的理解。

## 重复表

将信息存储在与需要与之生成快照的数据相关的行中。即在在线商店的订单表的列中保留地址。

### 好处

*   数据被分割成明确相关的表，不需要连接等。
*   无需按照以下概念的要求仅选择活动行。
*   假设行带有时间戳，则保留时态数据库的大部分好处

### 缺点

*   复制
    *   模式（当多个表向上修订时特别有问题）
    *   使用 ORM 时的模型。
    *   如果快照片段数据没有更改并且被重用，则数据的数量。即下单10次，地址存储11次（订单+当前）
*   处理插入相关表所需的额外代码。

## 时态数据库/活动或当前行标志

“时间感知”的数据库行，即它们的上下文是两个日期时间之间的时间。可以在时间上下文位于时态表之间的位置连接数据。

### 好处

*   没有模式或模型的重复。在一处进行的更改。
*   ORM 模型可以无缝地处理新行的创建、标记为活动等。
*   不复制未进行更改的行。即 10 个订单到 1 个地址存储一次地址。

### 缺点

*   查询变得更加复杂，因为连接/where 子句需要选择“活动”行。
*   表格被未定期选择/调用的历史数据堵塞。

## 仅存储更改的列，时间。

有一个表来跟踪所有表的更改，并注意它所涉及的行以及它在时间方面何时有效。

### 好处

*   在修订方面优化存储，因为未复制未复制的未更改数据。

### 缺点

*   将列的版本与其他数据结合起来的查询要复杂得多。

我已经在 SO 上查看了以下问题，以及这些其他资源

编辑：我没有用特定的 DBMS 标记这篇文章的原因是我希望这个概念尽可能多地与平台一起工作，目前是 DBMS 独立的，抽象层允许它与 MySQL 和MSSQL，但希望将来会支持其他人。

*   [用于修订的数据库设计？](https://stackoverflow.com/questions/39281/database-design-for-revisions)
*   [Fowler 时间表达式的关系模式](https://stackoverflow.com/questions/310963/relational-schema-for-fowlers-temporal-expressions#312534)
*   [文本修订的数据库设计](https://stackoverflow.com/questions/750782/database-design-for-text-revisions)
*   [以有效的方式存储关系对象的修订](https://stackoverflow.com/questions/1762694/storing-revisions-of-relational-objects-in-an-efficient-way)
*   [保留页面更改历史记录。有点像 SO 对修订所做的](https://stackoverflow.com/questions/3481392/keeping-page-changes-history-a-bit-like-so-does-for-revisions)
*   [在数据库中维护历史](https://stackoverflow.com/questions/739623/maintain-history-in-a-database)
*   [http://en.wikipedia.org/wiki/Temporal_database](http://en.wikipedia.org/wiki/Temporal_database)
*   [http://www.simple-talk.com/sql/database-administration/database-design-a-point-in-time-architecture/](http://www.simple-talk.com/sql/database-administration/database-design-a-point-in-time-architecture/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T21:08:53.590

我最终使用了一个时态数据库，它的实现导致了 FuelPHP 中的时[态](http://www.fuelphp.com)[模型](http://fuelphp.com/docs/packages/orm/model/temporal.html)。

我现在可以配置我的模型以将行视为时间敏感实体。更改会导致创建新行并相应地设置原始行的结束时间。

这允许我在某个时间点检索一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:39:59.697

还有另一个选项（至少在 Oracle 上），您可以在其中设置时间点并运行您喜欢的任何查询。

我相信它可以使用大量的闪回恢复空间，但如果你只对跟踪几个表感兴趣，这可能是矫枉过正。

# c++builder - 从 tdbmemo 中删除行

> ID：12321209
> 
> 赞同：0
> 
> 时间：2012-09-07T15:34:05.187
> 
> 标签：c++builder

如果它包含特定字符串，我想从我的 TDBMemo 字段中删除行。

如何在 C++ Builder XE 版本中进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T19:22:51.783

试试下面的。我是如何处理普通备忘录的

```
UnicodeString KeyPhrase = "the str your looking for";
for (int i = 0; i < DBMemo1->Lines->Count ; i++)
{
UnicodeString LineToCheck = DBMemo1->Lines->Strings[i];
if( LineToCheck.Pos( KeyPhrase ) )
        {
    DBMemo1->Lines->Delete(i);
            }
} 
```

# javascript - 将数组拼接分配给自身时，Javascript控制台打印不起作用

> ID：12321210
> 
> 赞同：19
> 
> 时间：2012-09-07T15:34:05.860
> 
> 标签：javascript, arrays

当我这样做时：

```
var testArray  = ["a","b","c"];
console.log(testArray);
console.log("size:" + testArray.length); 
```

我这个打印在我的控制台中：

```
["a", "b", "c"]
size:3 
```

哪个好。但是现在当我开始用这个拼接时：

```
var testArray  = ["a","b","c"];
console.log(testArray);
console.log("size:" + testArray.length);
testArray = testArray.splice(0,1); 
```

这恰好显示在我的控制台中：

```
["b", "c", undefined × 1]
size:3 
```

所以第一个问题是为什么它会弄乱我的阵列打印，即使拼接是在打印之后？大小显示正确，但“a”消失了，最后我得到一个未定义的。

所以我想做的是删除数组中的第一项。基本上是一个转变。所以我这样做：

```
var testArray  = ["a","b","c"];
console.log(testArray);
console.log("size:" + testArray.length);
testArray = testArray.splice(0,1);
console.log(testArray);
console.log("size:" + testArray.length); 
```

这就是输出的内容：

```
["b", "c", undefined × 1]
size:3
["a"]
size:1 
```

不仅大小减少了 2，它还删除了除“a”之外的所有内容。到底是怎么回事？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-07T15:38:49.737

不要将 testArray 分配给自身。只需这样做：

```
var testArray  = ["a","b","c"];
console.log(testArray);
console.log("size:" + testArray.length);
testArray.splice(0,1);
console.log(testArray);
console.log("size:" + testArray.length); 
```

# android - Android Activity 与 Tab 通信：Tab 为空

> ID：12321211
> 
> 赞同：0
> 
> 时间：2012-09-07T15:34:06.223
> 
> 标签：android, tabs, android-fragments, android-tabs

对于我最新的 Android 应用程序（API 级别 15），我使用了新架构，其中 GUI 中的每个选项卡都由在 PagerAdapter 注册的 Fragment 类表示，并且 Tab 事件由 TabListener 处理。

但是，当我想在两个选项卡之间发送数据时，我遇到了问题。我使用[此页面](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)中的代码示例并编写了以下代码以将数据从选项卡发送到我的活动：

```
@Override
public void onDataReceived(Map<String, List<Map<Integer, String>>> receivedData) {

    Log.i("CarerActivity:onDataReceived", "Map received by Fragment.");
    Log.i("CarerActivity:onDataReceived", receivedData.toString());
    Log.i("Fragment ID", ""+R.id.configurationfragment);

    TabConfiguration configurationFragment = (TabConfiguration) getSupportFragmentManager().findFragmentById(R.id.configurationfragment);

    if(configurationFragment != null){
        Log.i("CarerActivity:onDataReceived", "Fragment not null.");
    }else{
        Log.i("CarerActivity:onDataReceived", "Fragment null!");
    }
} 
```

receivedData.toString() 显示正确，因此 Tab 将其数据发送到 Activity。还会显示片段 ID。之后，输出始终为“CarerActivity：onDataReceived Fragment null！” 这使我无法调用 Fragment 的任何方法（因为它为空）。

在我的 R.java 中

```
public static final int configurationfragment=0x7f080001; 
```

可以在下面找到

```
 public static final class id{ 
```

.

任何人都知道我做错了什么或在哪里寻找错误？

设置：三星 Galaxy Nexus，Android 4.0.3，API 级别 15，Java 1.6，Mac OS 10.8，Eclipse Juno。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:42:07.083

这是一篇关于[FragmentPagerAdapter的有趣文章](http://android-developers.blogspot.fr/2011/08/horizontal-view-swiping-with-viewpager.html)

> 当您在列表中滑动时，FragmentPagerAdapter 将分离每个片段，但将它们保存在内存中，以便在用户向后滑动时可以简单地重新连接它们。如果您有大量的 Fragment，则值得考虑使用 FragmentStatePagerAdapter，因为它将删除它们，缺点是当用户滑回它们时需要重新构建它们。因此，如果您有更少、更复杂的片段，则 FragmentPagerAdapter 是有意义的，但请考虑将 FragmentStatePagerAdapter 用于更大的集合。

基本上，当您从一个片段滑动到另一个片段时，前一个片段被破坏（= null）。

解决此问题的一种方法是将新数据保存在第三方类或您的活动中。然后，当重新创建片段时，将包含新数据的包传递给它。

这是一个例子：

```
public class PagerUserAdapter extends FragmentStatePagerAdapter
{
    private final static String titles[] = {"Profile", "Badges", "Skills", "Accomplishments"};

    private Bundle args;

    public PagerUserAdapter(FragmentManager fm, CWUser u) 
    {
        super(fm);

        this.args = new Bundle();
        args.putSerializable(Constants.BUNDLE_USER, u);
    }

    public void refresh(CWUser u)
    {
        args.putSerializable(Constants.BUNDLE_USER, u);
        this.notifyDataSetChanged();
    }

    @Override
    public CharSequence getPageTitle(int position)
    {
        return titles[position];
    }

    @Override
    public Fragment getItem(int position) 
    {
        switch(position)
        {
        case 0:
            return ProfileFragment.newInstance(args);
        case 1:
            return BadgesFragment.newInstance(args);
        case 2:
            return SkillsFragment.newInstance(args);
        case 3:
            return AccomplishmentsFragment.newInstance(args);
        default:
            return ProfileFragment.newInstance(args);
        }
    }

    @Override
    public int getCount() 
    {
        return titles.length;
    }

    @Override
    public int getItemPosition(Object object) 
    {
        return POSITION_NONE;
    }
} 
```

* * *

```
public class BadgesFragment extends BaseFragment
{    
    public static BadgesFragment newInstance(Bundle args)
    {
        BadgesFragment f = new BadgesFragment();
        f.setArguments(args);
        return f;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) 
    {
        super.onActivityCreated(savedInstanceState);

        CWUser u = (CWUser) getArguments().get(Constants.BUNDLE_USER);
            //do what you want with your new data   
    }
} 
```

在您的活动中，当您获取新数据时，您所要做的就是使用新数据调用适配器的刷新方法。我就是这样做的，它可能有更优雅的解决方案，我愿意接受任何建议。该示例基于我的一个开源应用程序，如果您想挖掘，这里是包含完整代码的[项目。](https://github.com/florianmski/Coderwall-Android)

# angularjs - AngularJS 中 $routeChangeSuccess 的对面

> ID：12321218
> 
> 赞同：9
> 
> 时间：2012-09-07T15:34:22.823
> 
> 标签：angularjs, routes, angularjs-routing

我只是想知道是否有办法知道是否有人正在更改 URL 的路由。

例如，我的 html 中有这样的内容：

```
<a ng-href="#/somewhere">To somewhere</a> 
```

我*正在*使用这个：

```
$scope.$on('$routeChangeSuccess', function (scope, next, current) {
    //Some code
}) 
```

但是，我刚刚意识到我需要在更改 URL 之前运行此代码。有没有办法做到这一点，也有同样的方法`next`，并`current`知道我将被重定向到哪里以及从哪里？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-07T17:38:25.437

在`$routeChangeStart`路线更改之前会触发事件。它支持 next 和 current 参数，就像您期望的那样。因此，为了涵盖您的用例，您可以编写：

```
$scope.$on('$routeChangeStart', function(scope, next, current){
        console.log('Changing from '+angular.toJson(current)+' to '+angular.toJson(next));
}); 
```

这是完整的 jsFiddle 说明了这一点：http: [//jsfiddle.net/pkozlowski_opensource/9MnE9/](http://jsfiddle.net/pkozlowski_opensource/9MnE9/)

您可能还想查看 $route 文档 ( [https://docs.angularjs.org/api/ngRoute/service/$route](https://docs.angularjs.org/api/ngRoute/service/$route) ) 以查看 $route 服务发出的其他事件。

# java - 我应该什么时候在我的 Android 视图中初始化我的图块？

> ID：12321223
> 
> 赞同：0
> 
> 时间：2012-09-07T15:34:41.213
> 
> 标签：java, android

我的瓷砖的尺寸取决于屏幕的宽度和高度。

我什么时候应该给他们他们的尺寸？

如果我在 OnSizeChanged 中初始化它们，那么我需要一个布尔值来知道它是否是第一次发生 onSizeChanged。

将我的图块尺寸存储在相对值中是否更合适？

这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:42:30.590

当我这样做时，我使用 a `GlobalLayoutListener`，如下所示：

```
final ViewGroup myViewGroup = (ViewGroup) findViewById(R.id.my_viewgroup);
ViewTreeObserver vto = myViewGroup.getViewTreeObserver();
vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
    @Override
    public void onGlobalLayout() {
        //myViewGroup should now have dimensions, but sometimes
        //it takes two passes, so...
        if(myViewGroup.getWidth() == 0) return;

        //Set whatever stuff here
        myTileSizes = whateverSize;

        //Remove this listener -- no longer needed
        myViewGroup.getViewTreeObserver().removeGlobalOnLayoutListener(this);
    }
} 
```

就个人而言，我喜欢你的想法，即你是否已经完成了测量，只保留一个布尔值。应该一样有效。

# .net - .NET Thread.Sleep() 随机不精确

> ID：12321225
> 
> 赞同：4
> 
> 时间：2012-09-07T15:34:47.640
> 
> 标签：.net, multithreading

在我的 .NET 应用程序中，我必须重放一系列传感器事件。所以我创建了一个线程来触发这些事件（通常大约每 1-4 毫秒）。我在这个线程中实现了一个循环，并用来`Thread.Sleep(...)`让线程在事件之间休眠。

基本上它看起来像这样：

```
void RunThread() {
  var iter = GetAllEvents().GetEnumerator();
  if (!iter.MoveNext()) {
    return;
  }

  DateTime lastEventTime = iter.Current.Timestamp;
  FireEvent(iter.Current);

  while (iter.MoveNext()) {
    MyEvent nextEvent = iter.Current;

    int timeout = (int)(nextEvent.Timestamp - lastEventTime).TotalMilliseconds; 
    Thread.Sleep(timeout);

    FireEvent(nextEvent);
    lastEventTime = nextEvent.Timestamp;
  }
} 
```

**现在，我的问题是`Thread.Sleep()`有时会遵守指定的超时时间，有时则不会。**

我添加了一个检查（使用`StopWatch`，在上面的代码中不可见）关于睡眠实际花费了多长时间。以下是一些结果：

```
Expected timeout of 1 ms but got 15 ms.
Expected timeout of 2 ms but got 13 ms.
Expected timeout of 3 ms but got 15 ms.
Expected timeout of 2 ms but got 13 ms.
Expected timeout of 1 ms but got 13 ms.
Expected timeout of 1 ms but got 15 ms.
Expected timeout of 2 ms but got 13 ms.
Expected timeout of 2 ms but got 40 ms. 
```

为什么`Thread.Sleep()`行为“随机”？

笔记：

*   此线程运行时，Window 任务管理器不显示任何 cpu 使用情况。
*   行为随机变化，但至少持续几秒钟。例如，有一次我启动线程时，它运行良好。下一次它一直运行缓慢。下一次它快速运行几秒钟，然后减速或相反。

**更新：**这是一些显示`Sleep`行为方式的伪代码：

```
bool ChooseRespectTimeout() {
  if (this.notYetChosen) {
    this.respectTimeout = ChooseRandomly()
    this.notYetChosen = false
    reset this.notYetChosen after random time period
  }
  return this.respectTimeout
}

void Sleep(int timeout) {
  if (ChooseRespectTimeout())
    Thread.Sleep(timeout)
  else
    Thread.Sleep(timeout * 10)
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T17:05:16.257

`Thread.Sleep`真的只是调用 win32 [Sleep 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)，其文档详细说明了不准确之处。

真正做的是在*大约*指定的毫秒内`Thread.Sleep`放弃控制。[睡眠](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)功能的细节可能或多或少。操作系统交还控制权的速率由系统时间片决定，即 10-15 毫秒。所以，实际上只能精确到最近的量子。但是，正如其他人指出的那样，如果 CPU 处于重负载下，时间会更长。另外，如果您的线程的优先级低于所有其他线程，它可能没有时间。*`Thread.Sleep`*

 *在负载方面，它与可能发生切换时的负载有关。您说的是 1ms 超时（实际上大约是 15，正如您所见，由于系统量子或计时器的准确性），这意味着操作系统实际上只需要忙 15-30 毫秒就可以了太忙了，无法将控制权交还给线程，直到未来的量子。这不是很多时间。如果在这 15-40 毫秒内有更高优先级的东西需要 CPU，则更高优先级的线程会获得时间片，可能会使放弃其控制权的线程饿死。

真正的意思（对于`Thread.Sleep`大于 1 的超时值）是它告诉操作系统该线程的优先级低于系统中的*所有其他线程**，至少*在超时值内，直到线程重新获得控制权。 `Thread.Sleep`不是一种计时机制，它是一种放弃控制的手段。他们真的应该将“睡眠”重命名为“产量”。

如果你想设计一些定期做某事的东西，请使用计时器。如果您需要非常精确，请使用多媒体计时器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:40:30.097

Windows 不是实时操作系统。

调度程序可能会等待比请求的睡眠持续时间更长的时间来执行一个线程，尤其是在另一个线程仍然很忙的情况下。

如果您想要更高的可靠性，请尝试使用多媒体计时器。[这里](http://www.codeproject.com/Articles/5501/The-Multimedia-Timer-for-the-NET-Framework)有一个 .NET 包装器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T15:38:15.247

您的程序不能保证是 CPU 的唯一用户。

其他进程获得 CPU 切片 -`Thread.Sleep`将尽*最大努力*在超时后恢复，但如果 CPU 忙，则必须等待。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T15:38:26.147

`Thread.Sleep`仅保证线程将*至少*休眠指定的时间间隔。它不提供准确性保证——实际上它不能这样做，因为它是 OS 调度程序决定何时应该为每个阻塞线程提供 CPU 时间。

如果线程可以*要求*它们在特定时间点再次运行，那么抢占式多任务处理将是不可能的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-07T15:38:36.607

Windows 不是实时操作系统，因此您不会得到这些保证。基本上，Thread.Sleep*至少*会休眠 几毫秒，但它可能会更长，尤其是对于非常小的值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-07T15:38:36.643

`Thread.Sleep()`不精确。你给它的数字是*最小*的睡眠时间，而不是确切的睡眠时间。此外，Thread.Sleep 也有一个最小粒度，我认为是 10ms IIRC 左右。

如果您需要更精确的计时，那么您可能想要使用计时器。但是，请注意，尤其是 Windows 和 .NET 不是“实时”的，因此它们无法为您提供精确的准确性。

例如，如果垃圾收集器启动，处理计时器可能需要更长的时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-07T16:56:40.957

您不是最近唯一指出这一点的人。自 XP 以来，一定发生了一些变化。Sleep() 然后在有用的时间间隔内非常可靠，并且确实准确，例如。秒或分钟。正如其他人指出的那样，4ms 完全超出了 Sleep() 可用的时间。

现在看来，随着后来的操作系统，一些额外的不确定性不知何故潜入了，尽管我自己还没有测试过。

在有用的长时间内，您应该提高睡眠线程的优先级，以便它在睡眠间隔到期时准备好后立即被调度。

对于 4 毫秒，请查看多媒体计时器，如科幻小说 (+1) 所建议的那样。*

# c++ - 序列点与运算符优先级

> ID：12321228
> 
> 赞同：7
> 
> 时间：2012-09-07T15:35:16.877
> 
> 标签：c++, sequence-points

> **可能重复：**
> [未排序的值计算（又名序列点）](https://stackoverflow.com/questions/3852768/unsequenced-value-computations-a-k-a-sequence-points)
> [未定义的行为和序列点](https://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points)
> [运算符优先级与评估顺序](https://stackoverflow.com/questions/5473107/operator-precedence-vs-order-of-evaluation)

我仍在努力思考以下表达式如何导致未定义的行为：

```
a = a++; 
```

在对此进行搜索时，我发现了以下问题：

[序列点和运算符优先级之间的区别？0_o](https://stackoverflow.com/questions/7506704/difference-between-sequence-points-and-operator-precedence-0-o)

我通读了所有答案，但我仍然对细节有困难。其中一个答案将我上面的代码示例的行为描述为模棱两可，就如何`a`修改而言。例如，它可能归结为以下任何一种：

```
a=(a+1);a++;
a++;a=a; 
```

究竟是什么让`a`' 的修改模棱两可？这是否与不同平台上的 CPU 指令有关，以及优化器如何利用未定义的行为？换句话说，由于生成的汇编程序，它似乎未定义？

我看不出编译器使用的理由`a=(a+1);a++;`，它看起来很古怪而且没有多大意义。什么将拥有编译器使其行为如此？

编辑：

为了清楚起见，我确实了解正在发生的事情，但我只是不明白当有运算符优先级规则时（它本质上定义了表达式的评估顺序），它怎么可能是未定义的。在这种情况下，分配发生在最后，因此`a++`需要首先进行评估，以确定要分配给的值`a`。所以我期望的是`a`在后修复增量期间首先修改它，然后产生一个值来分配回`a`（第二次修改）。但是运算符优先级的规则似乎使我的行为非常清楚，我找不到任何“摆动空间”让它具有未定义的行为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T15:47:26.393

[您链接到的问题中的第一个答案](https://stackoverflow.com/a/7506801/734069)准确地解释了发生了什么。我会尝试改写它以使其更清楚。

运算符优先级定义了通过表达式计算值的顺序。表达式的结果`(a++)`很好理解。

***但是***，变量的修改`a` *不是表达式的一部分*。对真的。这是您难以理解的部分，但这只是 C 和 C++ 定义它的方式。

表达式会产生值，但某些表达式可能会产生副作用。该表达式`a = 1`的值为`1`，但它也具有将变量设置为的*副作用*。至于 C 和 C++ 如何定义事物，这是*两个不同的步骤*。同样，具有价值和副作用。`a``1`*`a++`*

 *序列点定义在这些序列点之后计算的表达式何时可见副作用。运算符优先级与序列点无关。这就是 C/C++ 定义事物的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:43:24.107

这可能是一个过于简单的解释，但我认为这是因为当代码用“a”“完成”时没有办法解决。它是在增量之后完成的，还是在分配之后完成的？决议最终是圆形的。增量后的赋值改变了应用增量值时的语义。也就是说，在“a”递增之前，代码不会用“a”完成，但在赋值完成之前，a 不会递增。这几乎是死锁的语言版本。

正如我所说，我确信这不是一个很好的“学术”解释，但这就是我把它塞进我自己的耳朵里的方式。希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T15:47:08.193

优先级规则指定表达式的计算顺序，但在计算期间不必发生副作用。它们可以在下一个序列点之前的任何时间发生。

在这种情况下，增量的副作用既不在赋值之前也不在赋值之后排序，因此表达式具有未定义的行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T16:17:02.103

让我来看看语句中的基本问题`a = a++`。我们希望实现以下所有目标：

*   确定值`a`（的返回值`a++`，#1）

*   增量`a`（的副作用`a++`，#2）

*   将旧值分配给`a`（分配的效果，#3）

有两种可能的排序方式：

1.  将原件存储`a`到`a`（无操作）；然后递增`a`。与 相同`a = a; ++a;`。这是序列#1-#3-#2。

2.  评估`a`、增加`a`、分配原始值给`a`. 与 相同`b = a; ++a; a = b;`。这是序列#1-#2-#3。

由于*没有规定的顺序*，因此这些操作中的任何一个都是允许的。但他们有不同的最终结果。两个序列都不比另一个更自然。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T15:58:32.860

该语句`a=a++`有两个结果和两个赋值：

```
a=a 
```

（因为它是一个后增量）和

```
a=a+1 
```

这些分配显然会导致不同的最终值`a`。

c 标准的起草者没有指出两个赋值中的哪一个应该首先写入`a`，哪个第二个，因此编译器编写者可以在任何给定情况下自由选择他们喜欢的任何一个。

结果是，它（这个特定的语句）不会崩溃，但是您的程序不能再依赖具有特定值的 a。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T15:50:46.300

这里的重点是，在某些 CPU 架构上，比如 Intel Itanium，这两个操作可以由编译器在指令级并行化——但是让你的构造定义良好会禁止这样做。在序列点规范时，这些架构大多是假设性的，而且由于 Itanium 失败了，因此到 2012 年，这在很大程度上是语言中不必要的复杂性，这是有争议的。任何仍然常用的架构基本上都没有可能的缺点——即使对于安腾来说，性能优势也很小，编写一个甚至可以利用它的编译器的头痛是巨大的。

另请注意，在 C++11 中，序列点被替换为先排序后排序，这使得更多类似的情况得到了很好的定义。*

# wordpress - Wordpress 电子商务灯箱说明

> ID：12321230
> 
> 赞同：1
> 
> 时间：2012-09-07T15:35:26.347
> 
> 标签：wordpress, e-commerce, lightbox

我在网站上使用 WP-Ecommerce 插件。

简单的问题，当您单击放大图像时，我需要在灯箱下方显示产品描述。

有什么想法我可以如何去做吗？

谢谢大家:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:51:48.397

您是否尝试过将 title="Your Description Text Here" 添加到灯箱超链接？

# asynchronous - 如何在 Play 2.0 框架中使用 Promise

> ID：12321232
> 
> 赞同：0
> 
> 时间：2012-09-07T15:35:34.223
> 
> 标签：asynchronous, akka, future, promise, play2-mini

我正在使用 java 玩 2.0 应用程序。我正在使用 promise 异步发送电子邮件。为此，我遵循[http://www.playframework.org/documentation/2.0/JavaAsync](http://www.playframework.org/documentation/2.0/JavaAsync)

我试过这样：

```
Promise<Result> promiseOfInt = Akka.future(
        new Callable<Result>() {
        public Result call() {
        try {
        sendMail(form,to,sub,msg);
        } catch (MessagingException e) {
        e.printStackTrace();
        }
        return null; }  }  ); 
```

然后我得到了这个错误：[WARN] [09/07/2012 19:34:40.737] [New I/O worker #14] [Dispatchers] Dispatcher [akka.actor.promises-dispatcher] 未配置，使用默认调度程序

我是异步编程的新手。我不知道如何处理承诺。任何人都可以帮助我。请提供示例。感谢进阶。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T12:35:13.170

这只是一个警告，但如果它给您带来麻烦（就像我一样），您需要将 Akka 配置添加到您的 Play 项目中。

有关文件 akka.conf 的示例，请参见此处的[Akka 配置文档](http://doc.akka.io/docs/akka/snapshot/general/configuration.html)。将其放入 /conf 文件夹并添加`include "akka.conf"`到 application.conf

为了配置 promises dispatcher，确保你的包含：

```
akka { actor {
 ...
 promises-dispatcher = {
  throughput = 10 # For example
 }
 ...
}} 
```

[在Akka Dispatcher Docs](http://doc.akka.io/docs/akka/snapshot/scala/dispatchers.html#Setting_the_dispatcher_for_an_Actor)中查看其他设置

# jquery - 使用 google apis for jquery ui

> ID：12321235
> 
> 赞同：1
> 
> 时间：2012-09-07T15:35:43.150
> 
> 标签：jquery, google-api

也许这很愚蠢，但如果我使用谷歌托管的 jqueryui api，我还需要加载各个库吗？例如，如果我想使用 jquery ui 对话框，我是否还必须引用 js 文件的本地路径，或者链接到 jquery ui api 会加载所有库本身？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:38:17.030

如果您正在谈论使用 Google CDN (https://developers.google.com/speed/libraries/devguide#jquery-ui) 链接到 jQuery UI 库，则无需费心引用任何其他 js 文件它在本地。只需链接到 Google 托管的 jQuery UI 库，您就可以开始了 :) 确保您也链接到 jQuery 库：

[https://developers.google.com/speed/libraries/devguide#jquery](https://developers.google.com/speed/libraries/devguide#jquery)

# java - 列表与数组 - 何时使用什么？

> ID：12321242
> 
> 赞同：5
> 
> 时间：2012-09-07T15:36:23.383
> 
> 标签：java, collections

我对 Java 比较陌生，多年来我不得不解决各种编程问题，其中需要收集的数据数量对于程序员来说真的是未知的。

当程序员无法知道需要收集的变量数量时，使用列表收集字符串或整数值是否是一个好的约定？或者有没有更好的方法来使用 Java 中的动态数组来处理这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:39:16.077

如果有疑问，即使您知道长度，使用 List 也可能是更好的选择。

使用数组可以更好地提高性能，但您需要成为专家才能知道什么时候这是一个好主意，什么时候它只会使您的解决方案更加复杂。

顺便说一句：Java 中没有这样的东西`dynamic arrays`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:48:13.640

你做得对。

List 是一个接口，ArrayList 是实现。如果您不太关心 OO mambo-jumbo，那么您可以通过以下方式理解它。

列表是您要处理“系统”的方式。你对其他任何事情都不太关心。

但是“系统”可以自由地以多种方式实现它！ArrayList、LinkedList、Vector 等

一旦你理解了这种分离，然后尝试收集这些实现之间的差异和细微差别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:47:25.160

列表（以及它们的表亲，Map 和 Set）对于几乎任何用例来说都是一个不错的选择。与数组相比，它们占用了更多内存并增加了少量开销，但提供了*更*丰富的 API，并且通常使用接口编写的代码比使用静态类型数组的代码具有更好的可重用性/灵活性。

java.util.Collections 可能会增加不可接受的开销的一种情况是，当您想要存储*原始*数据类型（例如 int、float 等）时，因为要存储此类类型，您需要使用包装器（集合类仅处理对象） . 包装可以大部分留给自动装箱，但需要注意内存开销。Apache commons（可能还有其他库）也提供直接使用原语的集合实现。

如果无法避免，您只想使用数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:48:02.640

如果您唯一担心的是不知道您需要多少元素，例如列表。通过动态数组，我假设您想管理自己的数组并自己调整大小？除非您想了解它的工作原理，否则我不会浪费精力。

Java 的好处在于 List 是一个接口，根据您的需要具有不同的实现（如 ArrayList、LinkedList、Stack、Vector）。

看起来[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)可能适合你。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-07T15:37:28.357

如果您提前知道元素的大小并且元素的类型相同，那么数组是最佳选择。

否则列表是最好的选择。

# foreach - Wordpress 获取数据并推入数组

> ID：12321243
> 
> 赞同：0
> 
> 时间：2012-09-07T15:36:23.203
> 
> 标签：foreach, wordpress

我想从 WordPress DB 中获取数据，将它们推送到数组中并将数据传递给 JS。

除了将数据推入`foreach ($posts as $post)`.

完整方法：

```
 $array = array(); 
        $category_name = "locations";
        $args = array(
            'numberposts' => -1,
            'category_name' => $category_name
        );

        $posts = get_posts($args);      
        foreach ($posts as $post){
            array_push( $array, array(

                "title" => the_title($post->ID),
                "cnt" => the_content($post->ID),
                "id" => the_ID($post->ID),
                "link" => the_permalink($post->ID)

            )); 
        } 
```

当我这样做时，`print_r($array)`我得到以下组合：

```
Post 39http://localhost:8080/testing/post-3/Post 27http://localhost:8080/testing/post-2/Post 15http://localhost:8080/testing/post-1/Array
(
    [0] => Array
        (
            [title] => 
            [cnt] => 
            [id] => 
            [link] => 
        )

    [1] => Array
        (
            [title] => 
            [cnt] => 
            [id] => 
            [link] => 
        )

    [2] => Array
        (
            [title] => 
            [cnt] => 
            [id] => 
            [link] => 
        )

) 
```

**到底是怎么回事？为什么数据没有正确放入数组？** 任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:43:59.977

这些函数（the_title、the_content 等）不返回值，而是将`echo`它们输出。他们也不接受 ID 参数。您需要使用`get_the_title`,`get_the_content`等返回字符串的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:44:17.257

这些模板标签需要将其 echo 变量设置为 false 才能在该上下文中工作。他们也不将帖子 ID 作为变量，如果设置了 postdata，他们会假定当前帖子。尝试：

```
the_title('','',false) 
```

[https://codex.wordpress.org/Function_Reference/the_title](https://codex.wordpress.org/Function_Reference/the_title)

* * *

## -~ -~ -~ -~ -~ -~ -~ -~ 澄清编辑 -~ -~ -~ -~ -~ -~ -~ -~

这个问题最整洁的解决方案其实就是直接寻址 wp`$post`对象。所以对于标题字符串`$post->post_title`和内容`$post->post_content`

`$post`此处列出了对象中可用的字段：

[http://codex.wordpress.org/Function_Reference/get_post#Return](http://codex.wordpress.org/Function_Reference/get_post#Return)

# c# - How can i remove the last part in a string

> ID：12321253
> 
> 赞同：1
> 
> 时间：2012-09-07T15:36:42.720
> 
> 标签：c#, html, xml

I have a dynamic generated string as /directory/folder/filename.html

How can i remove the last part i.e /filename.html.

I want my output as /directory/folder/.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T15:38:58.817

Use the [`Path.GetDirectoryName`](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx) method in `System.IO`:

```
string path = "/directory/folder/filename.html";
path = Path.GetDirectoryName(path); 
```

This *may* change the path seperator to the system default. If you want to preserve the slashes, use the following instead:

```
path = path.Substring(0, path.LastIndexOf('/')); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T15:42:32.033

You can use `substring` *without using IO classes/method*.

```
string str = "/directory/folder/filename.html";
int endIndex = str.LastIndexOf("/");
endIndex = endIndex !=-1 ? endIndex : 0;
result = str.Substring(0,endIndex); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T15:38:55.733

If you want only the path part use

```
string result = Path.GetDirectoryName(inputName); 
```

If you want the filename and not the path

```
string result = Path.GetFileName(inputName); 
```

Also I see that you use the forward slash. The methods above will give in output a folder separator correct for your operating system (forward or back slashes)

# android - Android 持续崩溃 - NullPointerException

> ID：12321255
> 
> 赞同：0
> 
> 时间：2012-09-07T15:36:50.267
> 
> 标签：android, nullpointerexception

我已经在许多设备上测试了我的应用程序，但这从未发生过，但是当我查看我的 Android 开发者控制台时，我看到了很多这样的情况：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.MyApp/com.MyApp.ProductMain}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1696)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1716)
at android.app.ActivityThread.access$1500(ActivityThread.java:124)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:968)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3806)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at com.MyApp.ProductMain.onCreate(Unknown Source)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1660)
... 11 more 
```

对我来说，这真的不能告诉我太多，但也许有人能比我读得更好？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:44:51.133

在 Google Play 上发布我的应用程序后，我发现有很多特定于手机制造商甚至特定型号的错误。有些手机型号需要额外的权限才能做事，有些手机会在其他手机运行没有任何问题时崩溃。我使用两个应用程序崩溃跟踪系统：[Bugsense](http://www.bugsense.com)和[ACRA](http://code.google.com/p/acra/)，它们提供比开发者控制台更详细的报告，例如设备型号、功能、Android 版本、详细的堆栈跟踪等。从那里您可以看到哪些特定设备出现故障并进行调试在他们。

# java - 在 Netbeans 中运行项目时传递存储在文件中的参数

> ID：12321256
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:36:50.253
> 
> 标签：java, netbeans, command-line-arguments

我的问题是我不记得在 netbeans 中运行项目时如何传递参数。如果有人可以提供帮助，网络上没有足够的文档将不胜感激。

这是我所知道的，您可以在运行>设置项目配置>自定义下更改运行配置有一个入口空间，您可以在其中输入要传递的参数。

我有一个名为**"AsciiShop.java"**的文件要运行，我需要传递存储在名为**"asciishop-A04-PP.i1"**的文件中的参数。当我使用终端或 cmd.exe 时，我可以使用

**java AsciiShop < asciishop-A04-PP.i1**

它完美无缺。我希望在 netbeans 上也能做到这一点。我已将文件放在包含 src 和 bin 文件夹的默认工作目录中。我应该在项目配置窗口的参数输入字段中写什么，以便它像**java AsciiShop < asciishop-A04-PP.i1 一样工作**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:00:18.923

如果您进入“运行”菜单并从下拉菜单中选择“项目配置”，您将看到具有默认配置和“自定义”选项的二级下拉菜单。选择“自定义”选项，您可以指定要在其中传递的参数。

# javascript - Cognos 10 - 如何在 Report Studio 中删除单选按钮提示底部的“取消选择”

> ID：12321258
> 
> 赞同：1
> 
> 时间：2012-09-07T15:36:51.447
> 
> 标签：javascript, radio-button, prompt, cognos

我有一个单选按钮提示。这是一个可选提示，因此“取消选择”出现在提示的底部。但我想从此单选按钮提示中删除或隐藏“取消选择”。

请让我知道我可以在 HTML 项目中为此提示使用的 Javascript。

我正在使用 Cognos 10。

![单选按钮提示 - 删除取消选择](../Images/44286f6f2c7326f651b33ea513930835.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T06:30:07.920

这是本机功能`10.1.1`

选择您的值提示，然后找到属性`Results Select All Text`。单击`ellipsis`，单击`Specified text`，然后单击`OK`。

对`Results Deselect All Text`属性重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:25:55.470

我真的很喜欢在 Cognos 中使用 jQuery。它使查找和操作 HTML 项目变得更加容易。
所以，说了这么多，让我们深入了解在 Cognos 10 上测试过的解决方案。我不确定它是否适用于 Cognos 8.X 报告。

在提示页面的底部添加 2 个 HTML 项。只到页面底部，否则你会得到脚本错误。
在第一个 HTML 项目引用 jQuery 库时：

```
 <script language="javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js" type="text/javascript">/**/</script> 
```

在本示例中，我引用了 Google URL，但您可以轻松下载 jQuery 库并在您的 Cognos Web 服务器上本地使用它。
第二个 HTML 是实际隐藏的地方：

```
<script language="javascript">$('a[id*=PRMT_SV_LINK_DESELECT]').hide();</script> 
```

这告诉 jquery ($) 选择其 id 属性包含 PRMT_SV_LINK_DESELECT 的所有 HTML 链接对象 (a)。
然后它激活隐藏功能来隐藏链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-26T06:40:52.820

您可以从“页面资源管理器”栏中转到“类”，然后从“全局类扩展”中选择“提示控件超链接”类对象，然后选择类属性“框类型”“无”，而不是 JavaScript。然后，您可以对 cognos 中的任何提示禁用“全选并取消全选”选项。

# c# - 检查 linq 语句中的某个索引是否为空的最快方法

> ID：12321259
> 
> 赞同：0
> 
> 时间：2012-09-07T15:36:52.943
> 
> 标签：c#, performance, linq

**基本细节**

我有一个 linq 语句，它从数据库中获取一些记录并将它们放入 System.Linq.Enumerable：

```
var someRecords = someRepoAttachedToDatabase.Where(p=>true); 
```

假设这抓取了吨（25k+）的记录，我需要对所有记录执行更新操作。为了加快速度，我必须决定使用分页并以 100 个块为单位执行所需的操作，而不是同时执行所有记录。

有问题的代码用于两个地方：更新数据库中大量值的服务方法，以及获取旧值和更新值以确保正确执行更新的集成测试。

**问题**

有问题的行是我计算子集中记录数以查看我们是否在最后一页的行；如果子集中的记录数小于分页的大小 - 那么这意味着没有更多的记录了。我想知道的是最快的方法是什么？

**有问题的代码**

```
int pageSize = 100;
bool moreData = true;
int currentPage = 1;
while (moreData)
{
   var subsetOfRecords = someRecords.Skip((currentPage - 1) * pageSize).Take(pageSize); //this is also a System.Linq.Enumerable
   if (subsetOfRecords.Count() < pageSize){ moreData = false;} //line in question
   //do stuff to records in subset
   currentPage++;
} 
```

**我考虑过的事情**

1.  subsetOfRecords.Count() < pageSize
2.  subsetOfRecords.ElementAt(pageSize - 1) == null （导致越界异常 - 可以捕获异常并将 moreData 设置为 false ）
3.  将 subsetOfRecords 转换为数组（由于 subsetOfRecords 的声明方式，将 someRecords 转换为数组将不起作用 - 但我愿意更改它）

我敢肯定还有很多其他的想法我错过了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:41:54.203

使用并行库。它将自动为您处理并行化和分页。处理记录的顺序重要吗？

```
var someRecords = someRepoAttachedToDatabase.Where(p=>true); 
Parallel.Foreach(someRecords, record=>DoSomethingWithRecord(record)); 
```

# c++ - 如何使用模板方法（c++）模拟类中的多态性？

> ID：12321260
> 
> 赞同：2
> 
> 时间：2012-09-07T15:36:52.990
> 
> 标签：c++, templates, polymorphism

在我面临的问题中，我需要一些或多或少类似于多态类的东西，但它允许虚拟模板方法。

关键是，我想创建一个子问题数组，每个子问题都通过在不同类中实现的不同技术解决，但保持相同的接口，然后传递一组参数（它们是函数/函子 - 这就是模板跳转）到所有子问题并获得解决方案。

如果参数是，例如，整数，这将是这样的：

```
struct subproblem
{
...
virtual void solve (double& solution, double parameter)=0; 
}
struct subproblem0: public subproblem
{
...
virtual void solve (double& solution, double parameter){...}; 
}
struct subproblem1: public subproblem
{
...
virtual void solve (double* solution, double parameter){...}; 
}

int main{
subproblem problem[2];
subproblem[0] = new subproblem0();
subproblem[1] = new subproblem1();
double argument0(0),
       argument1(1),
       sol0[2],
       sol1[2];
for(unsigned int i(0);i<2;++i)
    {
    problem[i]->solve( &(sol0[i]) , argument0);
    problem[i]->solve( &(sol1[i]) , argument1);
    }
return 0;
} 
```

但问题是，我需要像这样的论点

```
Arg<T1,T2> argument0(f1,f2) 
```

因此解决方法类似于

```
template<T1,T2> solve (double* solution, Arg<T1,T2> parameter) 
```

显然不能声明为虚拟的（因此不能从指向基类的指针中调用）...

现在我很卡住，不知道如何继续......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:54:29.287

通常，此类问题通过公共函数模板和接受类型擦除对象的受保护虚函数来解决。对于您的具体问题，这可以转化为：

```
struct param_list_base {
  virtual double getParam(int i) const = 0;
};

template <typename ParamStorage>
struct param_list : param_list_base {
  const ParamStorage& params;
  param_list(const ParamStorage& aParams) : params(aParams) { };
  virtual double getParam(int i) const {
    return params[i];
  };
};

class subproblem {
  protected:
    virtual void solve_impl(double* sol, param_list_base* params) = 0;
  public:
    template <typename ParamStorage>
    void solve(double* sol, ParamStorage params) {
      param_list<ParamStorage> tmp(params);
      solve_impl(sol, &tmp);
    };
}; 
```

然后，您还可以将`param_list`模板专门用于不同类型的参数存储对象。对于函子，您也可以这样做。当然，这在一定程度上是有限的，但它通常可以在大多数情况下工作。否则，您仍然可以依赖类似的受保护函数与公共函数模式。例如，您可以在公共接口中拥有一组非模板虚函数，它们都只是调用一个私有函数模板（所有情况下的一个实现），这并不漂亮，但如果可能的模板数量多，它就可以工作论据有限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:43:20.117

声明一个抽象基类，并让您的模板继承自它。

# atlassian-fisheye - FishEye REST API 获取变更集的评论

> ID：12321262
> 
> 赞同：1
> 
> 时间：2012-09-07T15:36:59.267
> 
> 标签：atlassian-fisheye

我正在尝试使用 FishEye REST API 获取特定变更集的评论列表。

这是我的网址：

[http://fisheye.company.com/rest-service-fe/search-v1/reviewsForChangesets/NameOfRepository/](http://fisheye.company.com/rest-service-fe/search-v1/reviewsForChangesets/NameOfRepository/)

我使用带有以下请求正文的提琴手作曲家发布它：cs = 16964

这是我的回应：

```
<?xml version="1.0" encoding="UTF-8" standalone="true"?>
  <reviewsForChangesets>
     <changesets>
        <changeset>
           <reviews/>
           <changesetId>16964</changesetId>
        </changeset>
     </changesets>
</reviewsForChangesets> 
```

如您所见，它没有评论信息。但是，如果我转到以下网址，我可以看到 16964 变更集已分配给它的评论：

[http://fisheye.company.com/changelog/NameOfRepository?cs=16964](http://fisheye.company.com/changelog/NameOfRepository?cs=16964)

我也尝试使用：

[http://fisheye.company.com/rest-service-fe/search-v1/reviewsForChangeset/NameOfRepository/](http://fisheye.company.com/rest-service-fe/search-v1/reviewsForChangeset/NameOfRepository/)

我得到了同样的回应。我错过了什么吗？

# java - 在 Jenkins 下构建 Roo 项目

> ID：12321265
> 
> 赞同：0
> 
> 时间：2012-09-07T15:37:09.543
> 
> 标签：java, spring-roo

我正在用 Roo 做一些实验。现在我想用 jenkins 构建我的项目。由于 aj 文件是生成的而不是编码的，因此我不会将它们签入到 SVN。如前所述，Jenkins 构建时存在很多编译错误。

我怎样才能让我的构建作业教创建 aj 文件？这是 Jenkins 必须学习的东西，还是 maven 必须学习的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T19:27:40.760

在我从事的项目中，我总是检查 aj 文件，原因与 Jim 的[链接中给出的相同](https://stackoverflow.com/questions/5466152/spring-roo-project-what-should-be-kept-in-version-control)

# mysql - 根据频率计算所有行并返回值

> ID：12321268
> 
> 赞同：3
> 
> 时间：2012-09-07T15:37:29.827
> 
> 标签：mysql, count, group-by

我想做一个查询，计算我表中的所有“电子邮件”行，并根据频率返回所有值。我不想对结果进行分组，我想显示结果的每一个变化，这是我目前所拥有的，你可以看到它按频率排序，但按组合并，我只想显示它们都按频率顺序排列。

```
select email 
from uploads 
group by email
order by count(*) desc 
```

SQL -

```
CREATE TABLE uploads 
(
 email varchar(200)
);

INSERT INTO uploads
(email)
VALUES
('test@email.com'),
('test@email.com'),
('test@email.com'),
('test2@email.com'),
('test2@email.com'),
('test3@email.com'),
('test4@email.com'); 
```

这是我想要的结果

```
|              EMAIL |
----------------------
|    test@email.com  |
|    test@email.com  |
|    test@email.com  |
|    test2@email.com |
|    test2@email.com |
|    test3@email.com |
|    test4@email.com | 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T15:42:12.170

您可以加入一个子查询，该查询返回每封电子邮件的聚合`COUNT()`并按降序排列：

```
SELECT 
  uploads.EMAIL
FROM
  uploads 
  JOIN (
    /* subquery returns distinct emails and their aggregate COUNT() */
    /* JOIN matches every row in `uploads` to the email and count */
    SELECT EMAIL, COUNT(*) as num FROM uploads GROUP BY EMAIL
  ) c ON uploads.EMAIL = c.EMAIL
ORDER BY 
  c.num DESC, 
  EMAIL ASC 
```

实际上，这会产生如下结果，尽管您实际上并未`num`在列表中包含该列`SELECT`：

```
|              EMAIL | num |
----------------------------
|    test@email.com  | 3
|    test@email.com  | 3
|    test@email.com  | 3
|    test2@email.com | 2
|    test2@email.com | 2
|    test3@email.com | 1
|    test4@email.com | 1 
```

# qt - Qt 编译和样式表

> ID：12321274
> 
> 赞同：0
> 
> 时间：2012-09-07T15:38:04.253
> 
> 标签：qt, custom-build-step, qtstylesheets

每次我在修改我的 qss 样式表文件后编译我的 Qt 项目时，都不会考虑这些修改，除非我重建所有内容。

关于解决此问题的任何想法，这样我每次更改 qss 时都不必等待 5 分钟？

注意：我使用 Qt 4.8，并且我的样式表在资源文件 (qrc) 中声明。

编辑：正如**Luca Carlon**所建议的，当通过 .qrc 文件在项目中引用 qss 时，qss 中的更改不会影响 qrc，编译器会忽略它。为了避免这种情况，我在我的项目中添加了一个自定义构建步骤：

*   在 qmake 步骤之前！
*   调用不带任何参数的 .bat 文件
*   .bat 包含真正的命令*copy /b files.qrc +,,*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:49:29.100

我在 Qt 资源文件中的 QML 文件中遇到了同样的问题。Qt 的人告诉我，有时会发生这种情况：我想可能就是这样[。](https://bugreports.qt-project.org/browse/QTCREATORBUG-1627)

为了解决这个问题，我在构建过程中创建了一个自定义步骤：转到项目设置，在 Build Steps 下选择 Add Build Step -> Custom Build Step。这里添加一个命令作为一个触摸 qrc 文件并将这一步定位为第一步。如果您在 Windows 下工作，请使用相当于 touch 命令。

这将每次重新编译该 qrc 文件，但至少它是自动的。我当时找不到其他方法。如果您停止处理该文件，只需禁用该步骤。

# git - Git：拒绝通过推送删除远程分支（如receive.denyDeletes），但前提是分支未完全合并

> ID：12321277
> 
> 赞同：6
> 
> 时间：2012-09-07T15:38:09.193
> 
> 标签：git, merge, branch, push, branching-and-merging

`git branch -d mybranch`如果该分支未完全合并，Git 默认会拒绝删除本地分支（通过）。

但是，如果我通过 删除远程分支`git push origin --delete mybranch`，则如果分支未完全合并，则不会发出任何警告。

这似乎相当危险：自从我上次获取分支以来，其他人可能已经将更新推送到分支，因此远程分支似乎比本地分支更容易意外删除未合并的分支。

那么，如果我删除了一个远程未合并的分支，为什么 git 不会发出警告呢？有没有办法让它警告或拒绝删除？

*注意：*我意识到理想情况下我应该`git pull`在删除分支之前将其删除，并确保它已完全合并。但是，每个人都会犯错，我希望有一个安全网。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T18:39:17.677

> 但是，如果我通过 git push origin --delete mybranch 删除远程分支，则如果分支未完全合并，则不会发出任何警告。

我的回答是“与什么合并？” 遥控器`HEAD`？`master`分公司？还有什么？Git ref 匹配或多或少是无限可配置的。您可以配置多个遥控器。上游跟踪分支机构不需要与本地同行同名。如果您知道如何配置，您甚至可以配置*多个*上游跟踪分支（这被称为“章鱼”拉动，并且没有瓷器命令可以让您这样做）。

`git branch -d`检查分支是否尚未与其上游分支合并（远程存储库中不存在的东西），然后，如果不存在上游，`HEAD`. 对远程存储库的对应检查并不那么明显。

根据 kan 在下面的评论，人们还可以检查删除远程分支是否会生成悬空提交（因此更强大`git branch -d`）。我也不相信有任何这种类型的保护，并且在具有数十个或数百个分支的远程中验证可能不是一件容易的事情。

您可以做的最好的事情是完全使用`receive.denyDeletes`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T06:08:08.593

# java - AST 评估难题的 Java 解决方案

> ID：12321278
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:38:12.360
> 
> 标签：java, abstract-syntax-tree

我对[这个关于各种语言的 AST 构建和评估的讨论](https://gist.github.com/2934374)很感兴趣。我正在研究 Java 的解决方案，只是想看看我能从这个问题中学到什么。

我在下面的代码可以编译，但会产生不正确的结果（即“oops”异常）。它不起作用，因为 Java 缺少运行时调度。有什么简单的解决方法吗？复杂的解决方法怎么样？例如使用泛型给编译器提示？我只是在这里猜测。

我已经排除的一些想法：（1）在运行时使用 instanceof 按参数类型分派。(2) 建立一个查找表，将参数类型映射到适当的处理程序。(3) 在 E 的每个子类中放置一个评估函数，以适当地评估该子类。

我已经排除了（1）和（2），因为我想让编译器和/或运行时为我完成这项工作。我已经排除了（3），因为我想将评估代码与表达式表示分开；这个想法是表示可能有多个操作（重新排序、简化）。

这是我到目前为止所拥有的。如上所述，此代码会产生不正确的结果。

```
import java.util.*;

public class EV
{
    public static Integer ev (E e, Map <String, Integer> env) { throw new RuntimeException ("oops: " + e); }
    public static Integer ev (V e, Map <String, Integer> env) { return env.get (e.name); }
    public static Integer ev (C e, Map <String, Integer> env) { return e.value; }
    public static Integer ev (P e, Map <String, Integer> env) { return ev (e.a1, env) + ev (e.a2, env); }
    public static Integer ev (T e, Map <String, Integer> env) { return ev (e.a1, env) * ev (e.a2, env); }

    public static void main (String [] a)
    {
        E e = new P (new T (new C (2), new V ("a")), new V ("b"));
        Map <String, Integer> env = new Hashtable <String, Integer> ();
        env.put ("a", 123);
        env.put ("b", 456);
        System.out.println ("ev (e, env) => " + ev (e, env));
    }
}

class E {}

class V extends E
{
    String name;
    public V (String name) { this.name = name; }
}

class C extends E
{
    Integer value;
    public C (Integer value) { this.value = value; }
}

class P extends E
{
    E a1, a2;
    public P (E a1, E a2) { this.a1 = a1; this.a2 = a2; }
}

class T extends E
{
    E a1, a2;
    public T (E a1, E a2) { this.a1 = a1; this.a2 = a2; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T17:18:28.077

对于使用像 Java 这样的单调度 OO 语言执行此操作，这是[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的经典用例，特别是如果您也对评论中提到的漂亮打印操作感兴趣。它可能适用于您评论中提到的其他一些操作，尽管它们不太适合。

# c# - 无法为 ie8 生成 ical 事件：'无法从 mywebsite.com 下载 file.aspx。无法打开此 Internet 站点...'

> ID：12321282
> 
> 赞同：0
> 
> 时间：2012-09-07T15:38:21.713
> 
> 标签：c#, c#-4.0, internet-explorer-8, iis-7.5, icalendar

我正在尝试向我的用户发送一个 ical 约会作为 http 响应。它在 Chrome 和 IE9 中运行良好，但在 IE8 上（至少使用 windows xp）会引发弹出错误消息“无法从 mywebsite.com 下载 file.aspx。无法打开此 Internet 站点。请求的站点不可用或找不到。请稍后再试。'

我该如何解决这个问题？

我尝试过使用缓存控制标头和 MIME 类型，但还没有找到解决方案。

这是来自我的 Web 服务器的原始 HTTP 响应：

```
HTTP/1.1 200 OK
Cache-Control:  no-cache, no-store, must-revalidate
Pragma: no-cache
Content-Type:   text/calendar; charset=UTF-8
Content-Language:   en-US
Expires:    -1
Server: Microsoft-IIS/7.5
Set-Cookie: ASP.NET_SessionId=yndoq4voisfn03nkt1o3zluk; path=/; HttpOnly
Set-Cookie: VisitorStatus=11058043496; expires=Tue, 07-Sep-2032 15:16:44 GMT; path=/; HttpOnly
Content-Disposition:    attachment; filename=Webinar.ics
X-AspNet-Version:   4.0.30319
X-Powered-By: ASP.NET
Date:   Fri, 07 Sep 2012 15:16:44 GMT
Connection: close
Content-Length: 1409

BEGIN:VCALENDAR
VERSION:2.0
METHOD:PUBLISH
PRODID:-//ddaysoftware.com//NONSGML DDay.iCal 1.0//EN
BEGIN:VEVENT
DESCRIPTION:test1\ntest2
DTEND:20120914T160000
DTSTAMP:20120907T151644Z
DTSTART:20120914T150000
LOCATION:Webinar - See information below for the link and dial in informati
on
ORGANIZER:mailto:CommunityManager@mysite.net
SEQUENCE:0
SUMMARY:Charting Your Career Path Amidst Healthcare Reform.
UID:00000000-0000-0000-0000-000000000000
BEGIN:VALARM
ACTION:Display
DESCRIPTION:Reminder
DURATION:PT15M
TRIGGER:PT15M
END:VALARM
END:VEVENT
END:VCALENDAR 
```

我发现这在其他人的网站上确实有效......所以如果有帮助的话，这是他们的原始回复。

```
HTTP/1.0 200 OK
Date:   Fri, 07 Sep 2012 15:06:08 GMT
Server: Apache
Content-Language: en-US
Content-Disposition: attachment; filename=webinar.ics
Connection: close
Content-Type: text/calendar; charset=UTF-8

BEGIN:VCALENDAR
VERSION:2.0
METHOD:PUBLISH
BEGIN:VTIMEZONE
TZID:Pacific Time (US & Canada)
BEGIN:STANDARD
DTSTART:20061105T020000
RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11
TZOFFSETFROM:-0700
TZOFFSETTO:-0800
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:20070311T020000
RRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3
TZOFFSETFROM:-0800
TZOFFSETTO:-0700
TZNAME:Daylight Savings Time
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VEVENT
DTSTART;TZID=”Pacific Time (US & Canada)”:20120912T090000
DTEND;TZID=”Pacific Time (US & Canada)”:20120912T100000
LOCATION;ENCODING=QUOTED-PRINTABLE:Webinar - See conference call information below
UID:200000000013097050
DTSTAMP:20120907T150608Z
DESCRIPTION:1\. Click this link to start or to join the Webinar:\n\n       https://www3.gotomeeting.com/ojoin/\n\n\n2\. Choose one of the following audio options:\n\n   TO USE YOUR COMPUTER’S AUDIO:\n   When the Webinar begins, you will be connected to audio using your computer’s microphone and speakers (VoIP). A headset is recommended.\n\n\n   TO USE YOUR TELEPHONE:\n   If you prefer to use your phone, you must select “Use Telephone” after joining the Webinar and call in using the numbers below.\n\n\n   Toll-free: 1 877 568 4108\n   Toll: +1 (951) 266-6130\nAccess Code: 70\n   Audio PIN: Shown after joining the meeting\n\n\nGoToWebinar®\nWebinars Made Easy™\n
SUMMARY;ENCODING=QUOTED-PRINTABLE:Charting Your Healthcare Career
BEGIN:VALARM
TRIGGER:-PT15M
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
END:VEVENT
END:VCALENDAR 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T19:40:13.483

我一直在电子邮件中直接向用户发送此日历请求的链接。我无法弄清楚，所以我将其更改为链接到登录页面，然后用户可以单击链接以生成日历邀请。它解决了这个问题。欢迎其他解决方案！

# jquery - 没有父级调整大小的jQuery插入元素

> ID：12321295
> 
> 赞同：0
> 
> 时间：2012-09-07T15:38:50.767
> 
> 标签：jquery, css, dom

我有以下结构：

```
<td>
  <input name="foo" size="45"/>
</td> 
```

我想在那之后动态插入图像，然后将其**放置在 input**中，如下所示：

```
$j('<img class="icon-ketchup" style="display: none; position: relative; right: 35px; top: 7px;" src="http://localhost:82/pod/plugin_assets/webshop/images/icons/cross.png" />').show().insertAfter($j('input')); 
```

我`td`的大小与 相同`input`，我不想调整`td`元素的大小。这怎么可能实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:51:17.200

您需要将其定位为绝对值。不需要 Javascript，但仍然可以根据需要使用它。见[http://jsfiddle.net/C7trn/](http://jsfiddle.net/C7trn/)

HTML

```
<td style="position: relative; border: 2px solid black; padding: 5px;">
<input name="foo" size="45"/>
<img class="icon-ketchup" style="position: absolute; right: 5px; top: 7px;" src="http://localhost:82/pod/plugin_assets/webshop/images/icons/cross.png" />
</td>​ 
```

关键是做TD `position: relative;`，然后有形象`position: absolute`。这将使图像相对于`td`.

# c# - 该字符串未被识别为有效的日期时间。有一个从索引 0 开始的未知单词

> ID：12321299
> 
> 赞同：1
> 
> 时间：2012-09-07T15:38:58.923
> 
> 标签：c#

这是代码的一部分..

//这里是插入

```
OleDbCommand command = new OleDbCommand();

command.CommandText = "INSERT INTO tblUsersAccount (Username,[Password],Firstname,     MiddleName, Lastname,Birthday,ContactNo,DateCreated,DateModified) values (@Username,@Password,@Firstname,@MiddleName,@Lastname,@Birthday,@ContactNo,@DateCreated,@DateModified)";

command.Parameters.Add("@Username", OleDbType.Char).Value = tbUsername.Text;
command.Parameters.Add("@Password", OleDbType.Char).Value = tbPassword.Text;
command.Parameters.Add("@Firstname", OleDbType.Char).Value = tbFirstname.Text;
command.Parameters.Add("@MiddleName", OleDbType.Char).Value = tbMiddleName.Text;
command.Parameters.Add("@Lastname", OleDbType.Char).Value = tbLastname.Text;
command.Parameters.Add("@Birthday", OleDbType.Date).Value =DateTime.Parse(tbBirthday.Text);
command.Parameters.Add("@ContactNo", OleDbType.Char).Value = tbContactNo.Text;
command.Parameters.Add("@DateCreated", OleDbType.Date).Value = DateTime.Now;
command.Parameters.Add("@DateModified", OleDbType.Date).Value = DateTime.Now;
command.ExecuteNonQuery(); 
```

//这里是更新

```
OleDbCommand command = new OleDbCommand();

command.CommandText = "UPDATE tblUsersAccount SET Password = ?, Firstname = ?, MiddleName = ?, Lastname = ?, Birthday = ?, ContactNo = ? WHERE Username = ?";

connect.ConnectionString = connectionString;
connect.Open();
command.Connection = connect;

command.Parameters.Add("@Username", OleDbType.Char).Value = tbUsername.Text;
command.Parameters.Add("@Password", OleDbType.Char).Value = tbPassword.Text;
command.Parameters.Add("@Firstname", OleDbType.Char).Value = tbFirstname.Text;
command.Parameters.Add("@MiddleName", OleDbType.Char).Value = tbMiddleName.Text;
command.Parameters.Add("@Lastname", OleDbType.Char).Value = tbLastname.Text;
command.Parameters.Add("@Birthday", OleDbType.Date).Value =DateTime.Parse(tbBirthday.Text);
command.Parameters.Add("@ContactNo", OleDbType.Char).Value = tbContactNo.Text;
command.ExecuteNonQuery(); 
```

问题#1：更新部分出错。错误说，“该字符串未被识别为有效的日期时间。从索引 0 开始有一个未知单词。” 这是生日部分。即使日期格式正确，例如 09/08/11。它适用于插入部分。

问题 #2：当我尝试删除生日部分以查看除了问题 #1 之外是否还有其他错误时，出现错误“更新语句中的语法错误”。

对不起..我只是编程新手。并感谢您的帮助。上帝保佑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:45:32.940

更新失败，因为参数的顺序不正确。
OleDb ADO 提供程序要求您按照它们在 sql 更新字符串中出现的确切顺序将参数添加到集合中

尝试在最后移动 UserName 参数

```
OleDbCommand command = new OleDbCommand(); 

command.CommandText = "UPDATE tblUsersAccount SET [Password] = ?, Firstname = ?, " + 
                      "MiddleName = ?, Lastname = ?, Birthday = ?, ContactNo = ? " + 
                      "WHERE Username = ?"; 

connect.ConnectionString = connectionString; 
connect.Open(); 
command.Connection = connect; 

command.Parameters.Add("@Password", OleDbType.Char).Value = tbPassword.Text; 
command.Parameters.Add("@Firstname", OleDbType.Char).Value = tbFirstname.Text; 
command.Parameters.Add("@MiddleName", OleDbType.Char).Value = tbMiddleName.Text; 
command.Parameters.Add("@Lastname", OleDbType.Char).Value = tbLastname.Text; 
command.Parameters.Add("@Birthday", OleDbType.Date).Value =DateTime.Parse(tbBirthday.Text); 
command.Parameters.Add("@ContactNo", OleDbType.Char).Value = tbContactNo.Text; 
command.Parameters.Add("@Username", OleDbType.Char).Value = tbUsername.Text; 
command.ExecuteNonQuery(); 
```

现在参数的顺序与它们出现在更新字符串中的顺序相同，并且可以正确理解日期值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:49:29.160

日期问题可能是，而 ADO 正在使用当前语言环境将您的日期时间对象转换为字符串。我宁愿尝试

```
DateTime.Parse(tbBirthday.Text).Date 
```

正如用户指定的那样`leppie`。

对于问题 #2，查看用于插入和更新的 SQL 表达式。在 Insert 中，您正在使用`@columnName`，而在 update 中，您正在使用`?`sign。尝试使用参数的全名，如插入 SQL：`@columnName`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:42:50.037

如果您只对日期感兴趣（看起来如此）：

`DateTime.Parse(tbBirthday.Text).Date`

或者

`DateTime.Today`

在其他情况下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:43:43.557

尝试使用 DateTime 的 Date 属性

```
 command.CommandText = "INSERT INTO tblUsersAccount (Username,[Password],Firstname,     MiddleName, Lastname,Birthday,ContactNo,DateCreated,DateModified) values (@Username,@Password,@Firstname,@MiddleName,@Lastname,@Birthday,@ContactNo,@DateCreated,@DateModified)";

command.Parameters.Add("@Username", OleDbType.Char).Value = tbUsername.Text;
command.Parameters.Add("@Password", OleDbType.Char).Value = tbPassword.Text;
command.Parameters.Add("@Firstname", OleDbType.Char).Value = tbFirstname.Text;
command.Parameters.Add("@MiddleName", OleDbType.Char).Value = tbMiddleName.Text;
command.Parameters.Add("@Lastname", OleDbType.Char).Value = tbLastname.Text;
command.Parameters.Add("@Birthday", OleDbType.Date).Value =DateTime.Parse(tbBirthday.Text).Date;//<---
command.Parameters.Add("@ContactNo", OleDbType.Char).Value = tbContactNo.Text;
command.Parameters.Add("@DateCreated", OleDbType.Date).Value = DateTime.Now.Date; //<---
command.Parameters.Add("@DateModified", OleDbType.Date).Value = DateTime.Now.Date;//<--- 
```

# python - Python - 使用 AutobahnPython 通过 WebSocket 进行广播

> ID：12321301
> 
> 赞同：1
> 
> 时间：2012-09-07T15:39:14.240
> 
> 标签：python, websocket, broadcasting, autobahn

我从 AutobahnPython 读过这个例子：`https://github.com/tavendo/AutobahnPython/tree/master/examples/websocket/broadcast`

它看起来很容易理解和练习。但我想再补充一点。提交正确秘密字符串的成员可以发送消息，其他任何人只能查看发送的信息。任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:14:56.823

实际上，有一个准备运行的[示例](https://github.com/tavendo/AutobahnPython/tree/master/examples/wamp/authentication)，其中包括强大的客户端身份验证和对 PubSub 的细粒度、灵活的授权（发布和/或订阅权限？） - 也适用于 RPC 顺便说一句。

免责声明：我创建了 Autobahn 并为 Tavendo 工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T14:59:46.073

好吧，这纯粹是您在代码中的逻辑。当您收到消息时，您只是在广播它，您要做的就是将其传递给自定义函数，然后在那里进行检查：

创建一个临时数组，其中包含经过身份验证的活动用户列表。当用户登录时，它应该发送这个特殊的字符串，匹配它，如果OK，把这个用户添加到这个活动用户列表数组中，如果不是就不要添加它。稍后，调用 bradcast 函数而不是获取所有在线用户，而是使用此自定义数组。

这就是你所要做的。
确保当有人注销时，将他从该阵列中删除。

# xna-4.0 - 如何在 XNA 4.0 中将 Texture2D 对象传递给像素着色器？

> ID：12321307
> 
> 赞同：0
> 
> 时间：2012-09-07T15:39:27.770
> 
> 标签：xna-4.0, pixel-shader

我想捕获每一帧并根据查找表更改每个像素的位置。例如像素 (30,35) -> (40,50) 等等。

所以我所做的是通过 RenderTarget2D 捕获一帧并遍历每个像素并在新的位图数组中设置每个像素的新位置。但是由于 RenderTarget2D.GetColor 方法的影响，这降低了性能。

所以我认为Pixel Shader可能是解决方案：在Draw方法中：1.绘制一个简单的框架2.通过RenderTarget2D捕获它3.然后通过着色器绘制模型

但是在着色器内部，我需要访问刚刚捕获的 Texture2D 以及查找表以读取映射的像素位置。如何将这些变量传递给着色器？

编辑：这是 Draw() 方法中的代码，但我看不出为什么没有对模型应用任何更改

```
 protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Textures[0] = ShaderRenderTarget;
        GraphicsDevice.Textures[1] = LookupTexture;

        // Change to our offscreen render target. 
        GraphicsDevice.SetRenderTarget(ShaderRenderTarget); 
        // Render a simple scene.
        DrawAFrame(); 

        // Change back to the back buffer, and get our scene
        // as a texture. 
        GraphicsDevice.SetRenderTarget(null);

        waldramEffect.CurrentTechnique = waldramEffect.Techniques["Waldraam"];
        // Use Immediate mode and our effect to draw the scene
        // again, using our pixel shader. 
        GraphicsDevice.Clear(Color.CornflowerBlue);
        CreateViewMatrix();

        // Copy any parent transforms.
        Matrix[] transforms = new Matrix[myModel.Bones.Count];
        myModel.CopyAbsoluteBoneTransformsTo(transforms);

        // Draw the model. A model can have multiple meshes, so loop.
        foreach (ModelMesh mesh in myModel.Meshes)
        {
            // This is where the mesh orientation is set, as well 
            // as our camera and projection. 
            foreach (ModelMeshPart part in mesh.MeshParts)
            {
                part.Effect = waldramEffect;
                waldramEffect.Parameters["World"].SetValue(Matrix.CreateRotationY(modelRotation) * Matrix.CreateTranslation(modelPosition));
                waldramEffect.Parameters["View"].SetValue(lookAt);
                waldramEffect.Parameters["Projection"].SetValue(projection); 
            }
            // Draw the mesh, using the effects set above.
            mesh.Draw();
        } 
        base.Draw(gameTime);

        int i = 0;
        foreach (ModelMesh mesh in myModel.Meshes)
        {
            foreach (ModelMeshPart part in mesh.MeshParts)
            {
                part.Effect = basicEffects[i];
                i++;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:06:17.203

将查找表变成纹理，将 X 和 Y 偏移存储在两个纹理通道中（例如：红色和绿色）。

在图形设备上设置两个纹理（XNA 中的渲染目标*是纹理），如下所示：*

```
GraphicsDevice.Textures[0] = myRenderTarget;
GraphicsDevice.Textures[1] = myLookupTable; 
```

（请注意，如果您使用它，`SpriteBatch`它将在内部设置。）`Texture[0]`

在您的着色器中，为每个声明一个采样器：

```
sampler myRenderTarget: register(s0);
sampler myLookupTable: register(s1); 
```

然后通过对查找表进行采样来调制渲染目标中的采样位置：

```
tex2D(myRenderTarget, inTexCoord.xy + tex2D(myLookupTable, inTexCoord.xy).xy); 
```

请注意，我还没有测试过上面的 HLSL 代码。如果你想让你的偏移在像素坐标中工作并允许负偏移，你需要提供一些额外的数学。

# ios - Ipad 删除按钮在 UITextField 中不起作用

> ID：12321310
> 
> 赞同：0
> 
> 时间：2012-09-07T15:39:38.707
> 
> 标签：ios, xcode

我有一些 UItextfields 连接到委托，它们具有 deleteCharactersInRange 函数，用于删除昏迷。我刚刚发现，如果我开始编辑这些字段之一，写任何字符，然后我想删除它们，键盘上的 iPad 删除按钮就不起作用。它不会删除任何东西。

为什么？？

这是代码

```
- (BOOL)textField:(UITextField *)tf shouldChangeCharactersInRange:(NSRange)r replacementString:(NSString *)str
{
    if (tf == namegroup) {
        if ([str isEqualToString:@","]) {
            return NO;
        }
        return YES;
    }

    if ([[newmessagename text] length] + [str length] - r.length > 30) {
        return NO;
    } else {
        return YES;
    }

    if (tf != namegroup ||tf != newmessagename){
    return YES;
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:59:03.330

我修复了它，将代码更改为：

```
- (BOOL)textField:(UITextField *)tf shouldChangeCharactersInRange:(NSRange)r replacementString:(NSString *)str
{
if (tf == namegroup) {
    if ([str isEqualToString:@","]) {
        return NO;
    }
    return YES;
}

if (tf == newmessagename) {
if ([[newmessagename text] length] + [str length] - r.length > 30) {

    return NO;
    }

    return YES;
}
} 
```

# cakephp - CakePHP - 会话被写入，然后在页面刷新时丢失

> ID：12321314
> 
> 赞同：1
> 
> 时间：2012-09-07T15:39:48.270
> 
> 标签：cakephp, cakephp-1.3

这是 CakePHP 1.3

我有一个 5 步订单表格，在每一步之后存储新的会话数据。这在每一步都完美运行，直到用户完成订单的最后一步。

在最后一步，我保存订单，然后设置一个会话标志来表示它已经完成。这样，如果用户刷新页面，它就不会再次下订单。

问题是，我在会话中设置了标志，如果我调试会话，它就在那里。在页面刷新时，会话已完全恢复到以前的状态，没有新值。

```
// Controller action for step 5 of the form

public function step5() {

    // FIRST DEBUG
    debug($this->Session->read('order'));

    // Load from session so that the view can display the order information
    $this->data = $this->Session->read('order');

    // Save order if not already completed
    if (!$this->Session->check('order.complete')) {

        // Adds to the database
        if ($this->_saveOrder($this->data)) {

            // Set flag so if the user refreshes, it won't save again
            $this->Session->write('order.complete', true);

            // SECOND DEBUG
            debug($this->Session->read('order'));

        }
    }
} 
```

在页面加载时的第一次调试中，会话如下所示：

```
Array
(
    [Order] => Array
        (
            [value1] => 4566
            [value2] => 'test'
            [value3] => 0
            [value4] => 0
        )
    [Customer] => Array
        (
            [fname] => test
            [sname] => test
            [email] => test@torg.co.uk
            [tel] => 0123456789
        )

) 
```

然后第二个调试显示新的会话标志已写入会话：

```
 Array
(
    [Order] => Array
        (
            [value1] => 4566
            [value2] => 'test'
            [value3] => 0
            [value4] => 0
        )
    [Customer] => Array
        (
            [fname] => test
            [sname] => test
            [email] => test@torg.co.uk
            [tel] => 0123456789
        )
    ['complete'] => true

) 
```

但是，如果我刷新页面，`complete`标志消失了，会话完全恢复到以前的状态，并且保存再次运行，因为标志不存在。写入标志后没有代码，因此不会被删除。

```
Array
(
    [Order] => Array
        (
            [value1] => 4566
            [value2] => 'test'
            [value3] => 0
            [value4] => 0
        )
    [Customer] => Array
        (
            [fname] => test
            [sname] => test
            [email] => test@torg.co.uk
            [tel] => 0123456789
        )

) 
```

会话写作在所有其他步骤上都可以正常工作。我可以在页面之间添加/更新会话变量，它们可以正常工作并在页面和页面刷新之间持续存在。

我不知道这是否与我的配置设置或什么有关。我不知道为什么仅在此页面上会发生这种情况。我有时也注意到，非常罕见，在为 AGES 撕掉我的头发并清除缓存几次等之后。它似乎会短暂工作一次，然后再次停止工作。

这可能与我的配置设置有关吗？这是我`Config/core.php`的没有评论：

```
Configure::write('debug', 2);

Configure::write('log', true);

Configure::write('App.encoding', 'UTF-8');

Configure::write('App.baseUrl', 'components/com_cake/app');

//Configure::write('Routing.prefixes', array('admin'));

//Configure::write('Cache.disable', true);

//Configure::write('Cache.check', true);

define('LOG_ERROR', 2);

Configure::write('Session.save', 'php');

//Configure::write('Session.model', 'Session');

//Configure::write('Session.table', 'cake_sessions');

//Configure::write('Session.database', 'default');

Configure::write('Session.cookie', 'CAKEPHP');

Configure::write('Session.timeout', '120');

Configure::write('Session.start', true);

Configure::write('Session.checkAgent', true);

Configure::write('Security.level', 'medium');

Configure::write('Security.salt', 'd1a4bfb8a3cxxxxx47173663e9e2e9ea5');

Configure::write('Security.cipherSeed', '1269383xxxxxxxxxx3672219');

Configure::write('Asset.timestamp', 'force');

//Configure::write('Asset.filter.css', 'css.php');

//Configure::write('Asset.filter.js', 'custom_javascript_output_filter.php');

Configure::write('Acl.classname', 'DbAcl');
Configure::write('Acl.database', 'default');

//date_default_timezone_set('UTC');

Cache::config('default', array('engine' => 'File')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T11:50:13.607

我花了很长时间才弄明白，但问题实际上是我在 Joomla 框架中使用了 CakePHP 组件，我不得不使用 PHP 的本机 mysqli 函数而不是 Cake 的数据库抽象层来选择不同的数据库。

发生的事情是我更改了选定的 MySQL 数据库，这导致了许多来自 Joomla 但仅在 Cake 中明显的微妙且看似无法解释的问题。

解决方案是确保我在我的`AppController::beforeRender()`方法中切换回 Joomla 需要的数据库。

# android - Android - 3 列行布局 - 我如何让它占据屏幕的百分比？

> ID：12321315
> 
> 赞同：3
> 
> 时间：2012-09-07T15:39:52.217
> 
> 标签：android, android-layout

我有这个带有硬编码宽度的布局：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:paddingTop="4dip"
     android:paddingBottom="6dip"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:textSize="13sp"
     android:weightSum="1.0">

     <TextView android:id="@+id/TRAIN_CELL"
         android:layout_width="0dp"
         android:layout_height="wrap_content"
         android:layout_weight=".60"/>

      <TextView android:id="@+id/FROM_CELL"
         android:layout_width="0dp"
         android:textSize="20sp"
         android:textStyle="bold"
         android:gravity="center"
         android:textColor="@color/light_best_blue"
         android:layout_height="wrap_content" 
         android:layout_weight=".20"/>

     <TextView android:id="@+id/TO_CELL"
         android:layout_width="0dp"
         android:textSize="20sp"
         android:textStyle="bold" 
         android:gravity="center"
         android:layout_weight=".20"
         android:textColor="@color/light_best_blue"
         android:layout_height="wrap_content"  />

</LinearLayout> 
```

但是有没有办法给每列一个宽度的百分比？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:42:08.470

利用

```
layout_width="0dp"
layout_weight="x" 
```

`x`你在每个元素上的百分比在哪里。见[http://developer.android.com/guide/topics/ui/layout/linear.html](http://developer.android.com/guide/topics/ui/layout/linear.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:44:47.620

您的权重属性和宽度为 0dp 并在父项中指定 weightSum。

在您的情况下，将线性布局的 android:weightSum 设置为 1，然后将该权重分配给子项，例如 0.3、0.3 和 0.4。(android:layout_weight="0.3")。

编辑：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:paddingTop="4dip"
 android:paddingBottom="6dip"
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:textSize="13sp"
 android:weightSum="1.0"
 android:orientation="horizontal">

 <TextView android:id="@+id/TRAIN_CELL"
     android:layout_width="0dp"
     android:layout_height="wrap_content"
     android:layout_weight=".60"/>

  <TextView android:id="@+id/FROM_CELL"
     android:layout_width="0dp"
     android:textSize="20sp"
     android:textStyle="bold"
     android:gravity="center"
     android:layout_height="wrap_content" 
     android:layout_weight=".20"/>

 <TextView android:id="@+id/TO_CELL"
     android:layout_width="0dp"
     android:textSize="20sp"
     android:textStyle="bold" 
     android:gravity="center"
     android:layout_weight=".20"
     android:layout_height="wrap_content"  />

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-14T06:43:13.743

这篇文章与[这篇](https://stackoverflow.com/questions/29861418/android-measure-screen-in-percentage/29865460#29865460)文章类似。
您可以将每个列宽创建为所需的百分比宽度
检查此[Android 测量屏幕百分比](https://stackoverflow.com/questions/29861418/android-measure-screen-in-percentage/29865460#29865460)

# sql - 加入两个表和结果在结果中出现两次

> ID：12321319
> 
> 赞同：0
> 
> 时间：2012-09-07T15:40:18.660
> 
> 标签：sql, join

我的查询中有一个选择命令，它从两个表中获取数据，每行结果在结果中出现两次，我的查询是

```
Select  
  Driver.DriverID,
  Driver.FName,
  Driver.LName,
  Driver.SmartCardNumber,
  Driver.DriverState,
  Driver.DriverCity,
  Driver.DriverAddress,
  Driver.Mobile,
  Driver.Telephone,
  Driver.MelliCardNumber, 
  Driver.CertificatePublisher,
  Driver.addeddate,
  Driver.ContractorID,
  Driver.editeddate,
  Contractor.name  
From Driver,Contractor 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:42:13.633

如果 Driver 和 Contractor 表之间存在关系，则需要 where 条件。

就像是

```
Select  
  Driver.DriverID,
  Driver.FName,
  Driver.LName,
  Driver.SmartCardNumber,
  Driver.DriverState,
  Driver.DriverCity,
  Driver.DriverAddress,
  Driver.Mobile,
  Driver.Telephone,
  Driver.MelliCardNumber, 
  Driver.CertificatePublisher,
  Driver.addeddate,
  Driver.ContractorID,
  Driver.editeddate,
  Contractor.name  
From Driver,Contractor
    where Driver.ContractorID = Contractor.id 
```

假设 ContractorID 链接到 Contractor 的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:43:32.193

您可以尝试使用 DISTINCT。

```
SELECT DISTINCT  Driver.DriverID,
Driver.FName,
Driver.LName,
Driver.SmartCardNumber,
Driver.DriverState,
Driver.DriverCity,
Driver.DriverAddress,
Driver.Mobile,
Driver.Telephone,
Driver.MelliCardNumber,
Driver.CertificatePublisher,
Driver.addeddate,
Driver.ContractorID,
Driver.editeddate,
Contractor.name  

From Driver,Contractor 
```

或者，如果您不需要 CROSS 结果，那么如果您在两个表之间有引用，则可以尝试进行 LEFT 或 INNER JOIN

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:45:05.430

您需要告诉 dbms 如何连接 2 个表中的记录：

例如

```
Select 
  Driver.DriverID,
  Driver.FName,
  ...,
  Contractor.name  
  From Driver,Contractor
  Where Driver.ContractorID = Contractor.ID; 
```

或者

```
Select 
  Driver.DriverID,
  Driver.FName,
  ...,
  Contractor.name  
  From Driver inner join Contractor
  On Driver.ContractorID = Contractor.ID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:46:02.197

```
Select  Driver.DriverID,
Driver.FName,
Driver.LName,
Driver.SmartCardNumber,
Driver.DriverState,
Driver.DriverCity,
Driver.DriverAddress,
Driver.Mobile,
Driver.Telephone,
Driver.MelliCardNumber,
Driver.CertificatePublisher,
Driver.addeddate,
Driver.ContractorID,
Driver.editeddate,
Contractor.name  
From Driver,Contractor
where Driver.DriverId=Contractor.DriverId; 
```

（提到一些这样的条件来获取数据）

# facebook - API 错误描述：会话密钥无效或不再有效（错误 102）

> ID：12321320
> 
> 赞同：1
> 
> 时间：2012-09-07T15:40:20.213
> 
> 标签：facebook, session, publish

我不知道为什么 facebook 发布在这个网站上不起作用

我明白了

API 错误代码：102 API 错误描述：会话密钥无效或不再有效错误消息：必须使用会话密钥调用 Iframe 对话框

在将 stream.publish 方法调用为 iframe 时

```
<script type="text/javascript">

    (function() {
      var e = document.createElement('script'); e.async = true;
      e.src = document.location.protocol 
        + '//connect.facebook.net/fr_FR/all.js';
      document.getElementById('fb-root').appendChild(e);
    }());

    window.fbAsyncInit = function()
    {
      FB.init({     appId: '303380259758621',
            status: true,
            channelUrl: 'http://www.crabegame.com/channel.php',
            cookie: true,
            xfbml: true,
            oauth: true});

    }

    function PublishStream(score)
    {
        FB.ui(
        {
            method: 'stream.publish',
            display    : 'iframe',
            message    : '',
            attachment:
            {
            name: 'CrabeGame',
            caption: 'Essaye de battre mon score sur le Crabe Game !',
            description: "J'ai réalisé un score de " + score  +  "points au Crabe Game !",
            href: 'http://www.crabegame.com',
            media:
            [
                {
                type: 'image',
                src: 'http://crabegame.com/media/crabe_fb.png',
                href: 'http://www.crabegame.com'
                }
            ]
            },
            action_links:
            [
            {
                text: 'Play Crabe Game',
                href: 'http://www.crabe-game.com'
            }
            ],
            user_message_prompt: 'Publier sur votre mur'
        },
        function (response)
        {
            if (response && response.post_id)
            {

            }
        }
        );
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T09:50:19.437

您不需要登录用户，只需删除显示：“iframe”，为我工作。它仍会显示在 iframe 中，但不会出现错误。不要问我为什么，使用 1:1 相同的应用程序设置，它与我的另一个应用程序中的显示值一起工作......至少这对我来说适用于 apprequest 对话框，在这里可能是一样的。

我会使用“feed”而不是“stream.publish”。

见这里：[https ://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)

另外：[在同一页面上使用 Like Button 和 FB.ui (apprequests) 冲突](https://stackoverflow.com/questions/8110026/using-like-button-and-fb-ui-apprequests-on-the-same-page-conflicts/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:39:26.450

这意味着您没有当前用户。试试这个以调用 PublishStream：

```
 FB.login(function(response) {
         if (response.authResponse) {
             PublishStream();
         } else {
             console.log('Not logged in');
         }
      }); 
```

# asp.net-mvc-3 - 使用 asp.net MVC 在 LINQ 中加入 asp_Users 数据库表

> ID：12321321
> 
> 赞同：0
> 
> 时间：2012-09-07T15:40:25.623
> 
> 标签：asp.net-mvc-3, linq, entity-framework

我正在使用 MVC 开发一个示例 asp.net 项目，但我的数据库是一个实时数据库，我无法对其进行更改（从技术上讲，这是该数据库的测试版本，但我的观点是无法更改数据库） .

我使用 asp_Users 表中的 UserID 来存储谁对系统的各个方面进行了更改，并且我想开始在各种前端表中显示用户名，但是如何链接表以获取此用户名？

所以澄清一下，我打算对整个系统的几个表执行此操作，因此我希望我可以使用 LINQ 来执行此操作。

我可以使用连接查询获得我想要的信息，但是如何将它传递给我的视图以使用？

```
 var plans = from users in db.aspnet_Users
                           join import in db.Plan_Imports
                           on users.UserId.ToString()
                           equals import.User_ID

                           select new
                           {
                               Date = import.Date,
                               UserName = users.UserName
                           }; 
```

样品表

**asp_Users**

用户身份

用户名

...

**表格1**

ID

字段1

字段2

...

User_ID <--- 引用 asp_Users

**表2**

ID

字段1

字段2

...

User_ID <--- 引用 asp_Users

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:50:33.980

我会为每个视图创建一个**ViewModel**。

ViewModel 只是一个 POCO 类

```
public class PlanViewModel
{
  public string UserName { set;get;}
  public DateTime ImportDate { set;get;}
} 
```

然后使用查询中的 LINQ 投影将数据获取到此 ViewModel/ViewModel 集合。

```
public ActionResutl Show()
{
   var plans = (from users in db.aspnet_Users
                           join import in db.Plan_Imports
                           on users.UserId.ToString()
                           equals import.User_ID

                           select new PlanViewModel
                           {
                               ImportDate = import.Date,
                               UserName = users.UserName
                           }).ToList();
   return View(plans);    
} 
```

现在让我们将视图强类型化为我们的集合`PlanViewModel`

```
@model List<PlanViewModel>
@foreach(var plan in Model)
{
  <p>@plan.UserName</p>
  <p>@plan.ImportDate.ToString()</p>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:25:48.000

Shyju 提供的解决方案运行良好，而且操作起来并不复杂，但是我认为在这种情况下我认为使用 LINQ 不合适，因为对于应该是一个简单的调用，代码已经失控了。

我所做的是使用存储过程来获取信息，并将其保存到我传递给我的视图的复杂对象中。

代码现在更整洁，更易于管理，因为上面的代码变得只是

```
var plans = db.SP_SelectImports(); 
```

在此处阅读有关存储过程映射的更多信息：http: [//dotnet.dzone.com/news/mapping-stored-procedure](http://dotnet.dzone.com/news/mapping-stored-procedure)

# php - 为 Magento 生成数千个测试产品的脚本？

> ID：12321324
> 
> 赞同：0
> 
> 时间：2012-09-07T15:40:46.953
> 
> 标签：php, magento

正如标题所暗示的，我想知道是否有一种方法可以通过 PHP 脚本生成数千个简单的测试产品（用于本地开发商店）。我有一些加载不同产品集合的自定义扩展，它们可以很好地处理标准样本数据，但我想在更“真实世界”的环境中测试它们。因此，为此我希望商店中有大量产品（如数万）。他们不需要图像，名称/SKU 等可能只是增量值。

在此先感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:58:50.987

所以，这里是如何，由Fontis上的[这篇博客文章提供的：](http://www.fontis.com.au/blog/magento/creating-magento-products-script)

```
<?php
$i = 1;
$numberofprods = 100;
$numberofprods = range($i,$numberofprods);
foreach($numberofprods as $product) {
++$i; $name = "Product Number ".$i;
$product = Mage::getModel('catalog/product');
$product->setSku($i);
$product->setName($name);
$product->setDescription("This widget will give you years of trouble-free widgeting.");
$product->setShortDescription("High-end widget.");
$product->setPrice(99.99);
$product->setTypeId('simple');
$product->setAttributeSetId(4); // need to look this up
$product->setCategoryIds("3,8"); // need to look these up
$product->setWeight(1.0);
$product->setTaxClassId(2); // taxable goods
$product->setVisibility(4); // catalog, search
$product->setStatus(1); // enabled
// assign product to the default website
$product->setWebsiteIds(array(Mage::app()->getStore(true)->getWebsite()->getId()));
$product->save(); 
}; ?> 
```

最好分批执行此操作，因为这似乎是一项相当繁重的处理器任务，因此我将数量添加为一个范围 - 例如，您可以有*$i = 1;$numberofprods = 1000;* 然后当它完成时*$i = 1001;$numberofprods = 2000;* 等等。

为了运行它，我只是将它作为模板文件保存在*app/design/frontend/default/template/createproducts.phtml*中，然后从像*{{block type="core/template" template="createproducts. phtml"}}*。然后，每次您加载该页面时，它都会运行并创建您的产品。

# html - 在标题上插入图像

> ID：12321335
> 
> 赞同：1
> 
> 时间：2012-09-07T15:41:23.153
> 
> 标签：html, css

我正在尝试在标题中显示徽标。它有一个带有类bannerPicture的div，我在其中指定了徽标的位置：

```
.bannerPicture
    {
     width: 213px;
     height:128px;
     background: url(logo_uhhipl.gif) repeat 0px 3px;
    } 
```

我的html如下：

```
<header>
    <div id="showlogo" class="bannerPicture">
    </div>
</header> 
```

我的问题是，如果我在 div“showlogo” 中添加任何文本，则徽标会出现在文本后面，如果我像上面那样将其留空，则不会显示。任何建议表示赞赏。

是因为我没有里面的div吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:44:37.293

这是背景图像的正常行为。这就是名字的由来。如果要添加徽标，只需使用“img”标签即可。或者，如果您更喜欢使用 CSS，您可以使用带有指定背景图像的“a”标签 - 因为徽标通常是可点击的，并且会将您返回到主页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:44:51.443

由于它在 CSS 中，因此它显示为背景图像。此外，由于没有指定元素的宽度或高度，因此不会显示背景。在我看来，您的目标实际上是在 HTML 中声明图像，**而不是**在 CSS 中。

# css - Primefaces：splitButton 的菜单附加到正文

> ID：12321341
> 
> 赞同：1
> 
> 时间：2012-09-07T15:42:02.513
> 
> 标签：css, jsf, button, primefaces, split

**我的代码：**

```
<p:splitButton value="View">
    <p:menuitem value="Edit" icon="ui-icon-edit" />
    <p:menuitem value="Delete" icon="ui-icon-delete"/>
</p:splitButton> 
```

该代码正在呈现附加到正文的菜单，例如：

```
<body>
    <form>
        <table>
            <tr>
                <button id="splitbutton".../>
            </tr>
        </table>
    </form>
    <div id="menu-for-splitbutton">
        <a id="menu1"... >Edit</a>
        <a id="menu2"... >Delete</a>
    </div>
</body> 
```

我需要相对于拆分按钮或相邻的菜单，例如：

```
<body>
    <form>
        <table>
            <tr>
                <button id="splitbutton".../>
                <div id="menu-for-splitbutton">
                    <a id="menu1"... >Edit</a>
                    <a id="menu2"... >Delete</a>
                </div>
            </tr>
        </table>
    </form>
</body> 
```

我正在使用 :hover (CSS) 在光标悬停在一行上时显示拆分按钮，但在取消选择任何行时不会隐藏上下文菜单，因为菜单不在 TR 标签内...我如何解决这个？

# android - 现有活动实例必须处理隐式 NFC 意图

> ID：12321345
> 
> 赞同：3
> 
> 时间：2012-09-07T15:42:09.573
> 
> 标签：android, android-intent, android-activity, nfc

我正在编写一个类似信息亭的微型浏览器，它根据特定扫描的 RFID 标签的有效负载打开特定页面。

为了提供重新打开应用程序（该应用程序供公众使用）和处理所有 RFID 扫描的方法，我试图让我的应用程序`android.nfc.action.NDEF_DISCOVERED`通过一个主要活动的单个实例来处理所有操作。

目前，每次扫描一个新的 RFID tg 时，我的活动的一个新实例都会打开，无论是否已经打开。显然，这并不理想。一个活动的单个实例可以处理所有这些隐含的意图吗？

我已经研究过使用 singleTop 属性和标志，但我不知道如何为由外部系统生成的意图引起的隐式意图设置标志，即发现 NFC 标签。

这是我第一次在这里问自己的问题，所以如果这没有多大意义，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:00:56.557

这个链接为我回答了这个问题，正如我在评论中所解释的那样（在我自己回答之前）。

[http://www.java2s.com/Code/Android/Core-Class/AnexampleofhowtousetheNFCforegrounddispatchAPIs.htm](http://www.java2s.com/Code/Android/Core-Class/AnexampleofhowtousetheNFCforegrounddispatchAPIs.htm)

我的问题是我不知道/不使用 PendingIntent，这似乎是某种原型，您可以使用它来为以后的 Intent 类型指定属性（即同名标志）。

# git - 开始构建 webapps

> ID：12321348
> 
> 赞同：0
> 
> 时间：2012-09-07T15:42:18.347
> 
> 标签：git, deployment, build, automation, lamp

我在一个小团队中使用 LAMP、git 和 OSX。我们建立网站和网络应用程序。我对学习构建、持续集成、单元测试、缩小 JS/CSS、部署和自动化非常感兴趣——但不知道从哪里开始！

感觉就像是那些通过渗透学习的东西之一，具有很高的进入门槛，只能通过“知道自己在做什么”的大型团队的奢侈来规避。

从哪里开始是个好地方？我感兴趣的是：

*   特定工具和程序
*   琳达课程/视频/播客/等
*   图书

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:57:14.327

Martin Fowler 签名系列中的“持续交付”是一本非常值得一读的书，它概述了需要考虑的不同流程和模型：

[持续交付 - Martin Fowler 签名系列](http://martinfowler.com/snips/201006021426.html)

它将涵盖所有“理论”，并且在您陷入困境之前非常具有启发性。

# .net - WebAPI PUT 调用建议

> ID：12321350
> 
> 赞同：1
> 
> 时间：2012-09-07T15:42:30.610
> 
> 标签：.net, asp.net-web-api

因此，我正在使用 .NET 4 WebAPI 示例，并且我的大部分工作都正常，但我不确定如何将 PUT 带回数据库，其值将存储在基础表中。我有一个从表中提取所有数据的存储过程。我有一个名为 Setting.cs 的类，这基本上是基础表的对象表示。这个

```
// Model - Settings
public class Setting
{
    public int ID { get; set; }
    public string Category { get; set; }
    public string Sub_Category { get; set; }
    public int UnitSize { get; set; }
    public int UnitOfMeasureID { get; set; }
    public bool Facings { get; set; }
    public bool Quantity { get; set; }
    public double EverydayPrice { get; set; }
    public double PromotionPrice { get; set; }
} 
```

该接口确保实现了正确的方法

```
// We need to store a collection of settings.  It's a good idea to separate the collection from our service implementation.
// This allows the backing store to be changed without rewriting the service class.  This is a design pattern called REPOSITORY.
public interface ISettingRepository
{
    IEnumerable<Setting> GetAll();
    Setting Get(int id);
    Setting Add(Setting item);
    void Remove(int id);
    bool Update(Setting item);
} 
```

接下来我有实际的存储库

```
public class SettingRepository : ISettingRepository
{
    private List<Setting> settings = new List<Setting>();
    private int _nextId = 1;

    public SettingRepository()
    {
        SqlConnection conn = new SqlConnection(Security.Security.Decrypt(ConfigurationManager.ConnectionStrings["myDatabase"].ConnectionString, "passwordString"));
        SqlCommand cmd = new SqlCommand("sp_GetAllSettings", conn);
        cmd.CommandType = CommandType.StoredProcedure;

        SqlParameter param_category = cmd.Parameters.Add("CATEGORY", SqlDbType.VarChar);
        param_category.Value = "Salad";
        param_category.Direction = ParameterDirection.Input;

        SqlParameter param_sub_catgegory = cmd.Parameters.Add("SUB_CATEGORY", SqlDbType.VarChar);
        param_sub_catgegory.Value = "Clamshell";
        param_sub_catgegory.Direction = ParameterDirection.Input;

        SqlParameter param_unit_size = cmd.Parameters.Add("UNIT_SIZE", SqlDbType.Int);
        param_unit_size.Value = 5;
        param_unit_size.Direction = ParameterDirection.Input;

        SqlParameter param_unit_of_measure_id = cmd.Parameters.Add("UNIT_OF_MEASURE_ID", SqlDbType.Int);
        param_unit_of_measure_id.Value = 6;
        param_unit_of_measure_id.Direction = ParameterDirection.Input;

        SqlParameter param_facings_bool = cmd.Parameters.Add("FACINGS", SqlDbType.Bit);
        param_facings_bool.Value = true;
        param_facings_bool.Direction = ParameterDirection.Input;

        SqlParameter param_quantity_bool = cmd.Parameters.Add("QUANTITY", SqlDbType.Bit);
        param_quantity_bool.Value = true;
        param_quantity_bool.Direction = ParameterDirection.Input;

        SqlParameter param_everyday_price = cmd.Parameters.Add("EVERYDAY_PRICE", SqlDbType.Money);
        param_everyday_price.Value = 9.99;
        param_everyday_price.Direction = ParameterDirection.Input;

        SqlParameter param_promotion_price = cmd.Parameters.Add("PROMOTION_PRICE", SqlDbType.Money);
        param_promotion_price.Value = 8.95;
        param_promotion_price.Direction = ParameterDirection.Input;

        try
        {
            conn.Open();
            SqlDataReader dr = cmd.ExecuteReader();
            settings = Base.DataReaderMapToList<Setting>(dr);
            dr.Close();
            conn.Close();
        }
        catch (Exception ex)
        {
            ex.Message.ToString();
        }
    }
    public IEnumerable<Setting> GetAll()
    {
        return settings;
    }

    public Setting Get(int id)
    {
        return settings.Find(p => p.ID == id);
    }

    public Setting Add(Setting item)
    {
        item.ID = _nextId++;
        settings.Add(item);
        return item;
    }

    public void Remove(int id)
    {
        settings.RemoveAll(p => p.ID == id);
    }

    public bool Update(Setting item)
    {
        int index = settings.FindIndex(p => p.ID == item.ID);

        if (index == -1)
        {
            return false;
        }

        settings.RemoveAt(index);
        settings.Add(item);
        return true;
    }
} 
```

最后我有了 SettingsController

```
public class SettingsController : ApiController
{
    static readonly ISettingRepository repository = new SettingRepository();

    // GET /api/values
    /// <summary>
    /// Returns the entire list of settings as an IEnumerable<Setting> type.
    /// </summary>
    /// <returns></returns>
    public IEnumerable<Setting> GetAllSettings()
    {
        return repository.GetAll();
    }

    // GET /api/values/5
    /// <summary>
    /// Looks up a single setting by ID
    /// </summary>
    /// <param name="id"></param>
    /// <returns></returns>
    public Setting GetSettingById(int id)
    {
        Setting item = repository.Get(id);

        if (item == null)
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }

        return item;
    }

    /// <summary>
    /// Returns all settings with a specified category.
    /// </summary>
    /// <param name="category"></param>
    /// <returns></returns>
    public IEnumerable<Setting> GetSettingsByCategory(string category)
    {
        return repository.GetAll().Where(p => string.Equals(p.Category, category, StringComparison.OrdinalIgnoreCase));
    }

    /// <summary>
    /// Returns all settings with a specified category and subcategory.
    /// </summary>
    /// <param name="category"></param>
    /// <param name="subCategory"></param>
    /// <returns></returns>
    public IEnumerable<Setting> GetDefaultPriceSettingsByCategoryAndSubCategory(string category, string subCategory)
    {
        return repository.GetAll().Where(p => string.Equals(p.Category, category, StringComparison.OrdinalIgnoreCase)).Where(p => string.Equals(p.Sub_Category, subCategory, StringComparison.OrdinalIgnoreCase));
    }

    // TODO: Refactor
    // NOTE: By default, parameters with complex types are deserialized from the request body.
    // Therefore, we expect the client to send us a serialized representation of a product object,
    // using either XML or JSON for the serialization.
    // RESPONSE CODE: By default, the Web API framework sets the response status code to 200 (OK).
    // Per the HTTP/1.1 protocol, when a POST request results in the creation of a resource,
    // the server should reply with status 201 (Created).
    // LOCATION: When the server creates a resource, it should include the URI of the new resource in the Location
    // header of the response.
    // By returning an HttpResponseMessage instead of a Product, we can control the details of the HTTP response message
    // including the status code and the Location header.
    public HttpResponseMessage PostSetting(Setting item)
    {
        item = repository.Add(item);
        //var response = Request.CreateResponse(HttpStatusCode.Created);
        var response = new HttpResponseMessage<Setting>(item) { StatusCode = HttpStatusCode.Created };

        string uri = Url.Route("DefaultApi", new { id = item.ID });
        response.Headers.Location = new Uri(uri);
        return response;
    }

    // PUT /api/values/5
    // This method name starts with a "Put....", so Web API matches it to PUT requests.
    // The contact parameter is deserialized from the request body.  By default, the ASP.NET Web API framework
    // takes simple parameter types from the route and complex types from the request body.
    public void PutSetting(int id, Setting contract)
    {
        contract.ID = id;

        if (!repository.Update(contract))
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }
    }

    // DELETE /api/values/5
    // According to the HTTP specification, the DELETE method must be idempotent,
    // meaning that several DELETE requests to the same URI must have the same effect as a single DELETE request.
    // Therefore, the method should not return an error code if the contact was already deleted.
    //
    // If a DELETE request succeeds, it can return status 200 (OK) with an entity-body that describes the status,
    // or status 202 (Accepted) if the deletion is still pending, or status 204 (No Content) with no entity body.
    // In this example, the method returns status 204.
    public HttpResponseMessage DeleteSetting(int id)
    {
        repository.Remove(id);
        return new HttpResponseMessage(HttpStatusCode.NoContent);
    }
} 
```

这是我的存储过程，如果包含所有值，则允许插入一行，否则返回一个选择。ID 列是一个自动递增的标识值。

```
ALTER PROCEDURE [dbo].[sp_GetAllSettings]
@CATEGORY AS VARCHAR(10) = NULL,
@SUB_CATEGORY AS VARCHAR(10) = NULL,
@UNIT_SIZE AS INTEGER = NULL,
@UNIT_OF_MEASURE_ID AS INTEGER = NULL,
@FACINGS AS BIT = NULL,
@QUANTITY AS BIT = NULL,
@EVERYDAY_PRICE AS MONEY = NULL,
@PROMOTION_PRICE AS MONEY = NULL
AS

BEGIN
SET NOCOUNT ON;

IF NOT @CATEGORY IS NULL
    AND NOT @SUB_CATEGORY IS NULL
    AND NOT @UNIT_SIZE IS NULL
    AND NOT @UNIT_OF_MEASURE_ID IS NULL
    AND NOT @FACINGS IS NULL
    AND NOT @QUANTITY IS NULL
    AND NOT @EVERYDAY_PRICE IS NULL
    AND NOT @PROMOTION_PRICE IS NULL

    INSERT INTO Settings(Category,
                         Sub_Category,
                         UnitSize,
                         UnitOfMeasureID,
                         Facings,
                         Quantity,
                         EverydayPrice,
                         PromotionPrice)

    VALUES (@CATEGORY,
            @SUB_CATEGORY,
            @UNIT_SIZE,
            @UNIT_OF_MEASURE_ID,
            @FACINGS,
            @QUANTITY,
            @EVERYDAY_PRICE,
            @PROMOTION_PRICE)
ELSE
    SELECT [ID],
            Category,
            Sub_Category,
            UnitSize,
            UnitOfMeasureID,
            Facings,
            Quantity,
            EverydayPrice,
            PromotionPrice

    FROM Settings
END 
```

一个简单的执行语句将允许插入：

```
exec [sp_GetAllSettings] "Salad", "Clamshell", 4, 5, 1, 1, 3.99, 2.75 
```

我想弄清楚的是：使用这种方法时，允许将新设置存储在数据库中的最佳方法是什么？我`PUT`想最好打个电话。

似乎我需要一个新的存储过程，或者我可以使用具有默认`NULL`值的相同存储过程，如果传递了一个值，那么我将`INSERT`代替`SELECT`.

有什么建议么？

**更新**：我已经用最新的存储过程更新了我的代码。我真正缺少的部分是如何`PUT`在 URL 中创建调用，以便我可以发送您在上面的存储过程执行语句中看到的基本内容。我希望有类似的东西：

```
mysite:123/api/settings/salad/clamshell/4/5/1/1/3.99/2.75 
```

但是，我想这不是正确的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T19:47:53.717

您的 API 具有通过此处的存储库将新项目插入数据库的必要代码：

```
public HttpResponseMessage PostSetting(Setting item)
{
    item = repository.Add(item);
    //var response = Request.CreateResponse(HttpStatusCode.Created);
    var response = new HttpResponseMessage<Setting>(item) { StatusCode = HttpStatusCode.Created };

    string uri = Url.Route("DefaultApi", new { id = item.ID });
    response.Headers.Location = new Uri(uri);
    return response;
} 
```

我认为你的问题是，如何测试这个？什么是 URL？

您需要创建要测试的 Setting 类或项目的 JSON 表示，并使用[Fiddler](http://fiddler2.com/fiddler2/)之类的产品（现在是[Telerik](http://telerik.com)产品）并使用 Composer 选项卡。

接下来，您将要对以下 URL 执行 POST：

http://[您的基本网址]/api/settings

并传递 JSON 格式的设置类。

你可以在这里看到一个例子：[ASP.NET Web API - Scott Hanselman](http://www.asp.net/vnext/overview/videos/aspnet-web-api)

# javascript - 相当于 D3.js 中 jQuery 的“非”选择器？

> ID：12321352
> 
> 赞同：20
> 
> 时间：2012-09-07T15:42:33.340
> 
> 标签：javascript, jquery, d3.js

在 D3.js 中工作，我想选择与选择器匹配的所有元素，但当前元素*除外*。

原因是我想将鼠标悬停在一个圆圈上，并让具有相同类别的所有其他圆圈变为浅蓝色，但当前圆圈保持相同的阴影。

这是我目前拥有的：

```
vis.selectAll('circle.prospect')
.on("mouseover", function(d) { 
     console.log(d);
    d3.selectAll('circle.prospect').transition().style('opacity','0.5');
    d3.select(this).attr('opacity','1.0');
  }); 
```

在 jQuery 中，我[可以使用`not`](https://stackoverflow.com/questions/437958/jquery-exclude-this-from-selector). 任何人都知道 D3.js 等价物吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-07T21:45:29.567

如果您的元素具有唯一的 CSS 可访问标识符，*则可以*使用`:not()`选择器。一些潜在的例子：

```
d3.selectAll("circle.prospect:not(#" + this.id + ")");
d3.selectAll("circle.prospect:not(." + someUniqueClassFrom(d) + ")");
d3.selectAll("circle.prospect:not([uniqueAttr=" + this.getAttribute('uniqueAttr') + "])"); 
```

原因`d3.selectAll('circle.prospect:not(this)')`不起作用是因为它只是字面上说要过滤掉任何`<this></this>`元素——这显然不是你的意图，因为它已经只选择了`<circle></circle>`元素，无论如何都没有效果。

即使您通常不应用一些独特的 DOM 属性，也没有理由不能暂时设置一个：

```
vis.selectAll('circle.prospect')
.on("mouseover", function(d) {
    this.id = 'temp-' + Math.random();
    d3.selectAll('circle.prospect:not(#' + this.id + ')').transition().style('opacity','0.5');
    d3.select(this).attr('opacity','1.0');
    this.id = '';
  }); 
```

但是，如果您的元素尚未分配 ID，我认为 Ian Roberts 的解决方案可能是我会做的，而不是这个临时标识符黑客。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-07T15:52:06.530

您可以`filter`选择：

```
vis.selectAll('circle.prospect')
.on("mouseover", function(d) { 
     console.log(d);
    var circleUnderMouse = this;
    d3.selectAll('circle.prospect').filter(function(d,i) {
      return (this !== circleUnderMouse);
    }).transition().style('opacity','0.5');
    d3.select(this).attr('opacity','1.0');
  }); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-09-07T21:54:31.443

解决这个问题的更简单方法是使用 D3 运算符的强大功能：

```
vis.selectAll('circle.prospect').on("mouseover", function(d) {
    var circleUnderMouse = this;
    d3.selectAll('circle.prospect').transition().style('opacity',function () {
        return (this === circleUnderMouse) ? 1.0 : 0.5;
    });
}); 
```

这里有一个区别，与您的原始代码不同，`circleUnderMouse`元素的不透明度也将平滑动画。如果它已经完全不透明，那么可能没什么大不了的，否则您可以以类似的方式使用[.duration()](https://github.com/mbostock/d3/wiki/Transitions#wiki-duration)运算符将 circleUnderMouse 时间加速到 0，其他时间更长。

# exception - ibatis异常——数据库会话中断

> ID：12321353
> 
> 赞同：0
> 
> 时间：2012-09-07T15:42:38.253
> 
> 标签：exception, ibatis, mybatis

我使用 ibatis 将我的数据保存到数据库中。我有一个应用程序，它每隔几秒就经常使用应用程序中的值更新数据库。运行 ibatis 5 小时后抛出此异常：

数据库会话中断 - org.apache.ibatis.exceptions.PersistenceException 后来我看到

### 原因：com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException：表“updates_table”不存在。

它在同一张表中填充了 5 个小时，然后突然抛出了这个异常。我不知道可能是什么原因。谁能帮我解决这个问题。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:46:37.050

如果该表不再列出 - 然后在代码的其他部分查找 drop 语句，例如定期任务或其他内容。

另一个可能的原因可能是回滚的 DDL 语句上的事务。

# python - Mac OS X 上的 Python 安装问题

> ID：12321357
> 
> 赞同：1
> 
> 时间：2012-09-07T15:43:22.317
> 
> 标签：python, macos, pip

我一直在使用 OS X Lion (2.7.2) 附带的标准 python，但我想构建一个 UCS-4 版本来更好地处理 4 字节 unicode 字符。

我已经安装了 pip 和 pytz、virtualenv 和 virtualenvwrapper 等软件包，这些都安装在`/Library/Python/2.7/site-packages`. 我`$PATH`的是`/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin`。

为了在机器上构建一个新版本的 python（在任何项目特定的虚拟环境之外，稍后会出现），我按照[本文](http://webamused.wordpress.com/2011/01/31/building-64-bit-python-python-org-using-ucs-4-on-mac-os-x-10-6-6-snow-leopard/)的说明并设法在`/usr/local/bin`. 问题是当我启动一个新的 bash 窗口时，我得到了以下 virtualenvwrapper 错误：

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named virtualenvwrapper.hook_loader virtualenvwrapper.sh: There was a problem running the initialization hooks. 

If Python could not import the module virtualenvwrapper.hook_loader, check that virtualenv has been installed for VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python and that PATH is set properly. 
```

说明说要移到文件`/usr/local/bin`的顶部`/etc/paths`，从那以后我注意到了一些奇怪的问题。我将 pip 安装到了`/usr/local/bin`，现在我假设由于我在工作`/usr/local/bin`，并且新安装的 python 的站点包现在位于`/usr/local/lib/python2.7/site-packages`，当我这样做时`pip freeze`，它应该是空的，因为那里还没有安装任何东西。但是，`pip freeze`仍然报告旧（OS X）站点包文件夹中安装的东西。以下是构建后的一些信息：

```
$ which python
/usr/local/bin/python
$ which pip
/usr/local/bin/pip
$ echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin 
```

当我使用 pip 卸载 python 包时，它会按预期将其从旧的 site-packages 文件夹中删除。当我再次安装它时`/usr/local/lib/python2.7/site-packages`，它不会将其安装在 中，而是将其安装在中`/Library/Python/2.7/site-packages`（通过尝试再次安装并接收来验证`Requirement already satisfied (use --upgrade to upgrade): pytz in /Library/Python/2.7/site-packages` ）。如何获取旧站点包文件夹的路径？为什么它不会将它安装在它正在使用的 python 安装的正确位置？

自从升职以来，我遇到了其他几个问题，`/usr/local/bin`但我想如果我理解了这一点，我就能到达某个地方。

谁能看到发生了什么？如果您需要更多信息，我很乐意提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:16:26.570

由于您将使用自定义 python 安装作为主要安装，我建议您从系统 python 中卸载所有非标准包，并确保现有的 easy_install.py 已消失（可能通过手动删除它）。然后下载distribute 的distribute_setup.py 并使用新的解释器运行它。从那时起，一切都应该按预期工作。

# qt - 关闭小部件时出现嵌入式 Qt GUI 工件

> ID：12321360
> 
> 赞同：1
> 
> 时间：2012-09-07T15:43:31.950
> 
> 标签：qt, user-interface, transparency, embedded-linux, qwidget

我正在为嵌入式 Linux 设备开发一个触摸屏 GUI，该设备将位于视频源上。因此，我需要我的 GUI 透明并在超时后消失，以便用户可以查看视频源。我的 GUI 的 main.cpp 使用以下代码确保使用 -qws 选项运行的整个应用程序的背景是透明的：

```
QApplication a(argc, argv, QApplication::GuiServer);
QWSServer::instance()->setBackground(QBrush(Qt::NoBrush));
QWSServer::setCursorVisible (false); 
```

我有一个主要的底层小部件，它拥有 GUI 中的所有其他小部件。我使用以下与调色板相关的代码将背景设置为透明。

```
QPalette transparentPallete;
transparentPallete.setColor(QPalette::Window, Qt::transparent);
setAutoFillBackground(true);
setPalette(transparentPallete); 
```

我还覆盖了 paintEvent 方法以尝试确保背景始终处于干净透明的状态：

```
void MainWidget::paintEvent(QPaintEvent *event)
{
    QPainter p(this);

    // Fill background
    p.setPen(Qt::NoPen); // no outlines
    p.fillRect(0,0,width(),height(),QColor(255, 255, 255, 0)); // Fill rectangle with color

} 
```

现在我可以启动我的应用程序并通过原始视频源查看我的 GUI，我可以通过触摸进行交互以在 GUI 中显示不同的窗口并让它们消失。

我无法完成的是摆脱当我点击“取消”或命令 GUI 的某些部分消失时留下的工件。这些工件看起来非常难看（多条垂直线/错误的颜色），并且只有在调用 GUI 的另一部分来替换屏幕上的该位置时才会消失。无论我是否启用了视频源（无论如何它都存在于由处理器 dss 控制的不同叠加层上），它们都在那里。

如何摆脱一些小部件后留下的这些工件？

注意：这肯定与以下行相关：

```
QWSServer::instance()->setBackground(QBrush(Qt::NoBrush)); // Allows transparent pixels to be written to frame buffer 
```

如果我关闭这条线，我看不到底层覆盖，但我也没有任何奇怪的行为，我的表现变得更好。我怎样才能实现透明但又失去了奇怪的文物？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:14:03.370

那么以下显然有一个问题：

```
QWSServer::instance()->setBackground(QBrush(Qt::NoBrush)); 
```

但这解决了问题，我看到 0 个工件：

```
QWSServer::setBackground(QBrush(QColor(0, 0, 0, 0))); 
```

# css - CSS图像填充所有在图像中间具有透明元素的屏幕

> ID：12321363
> 
> 赞同：0
> 
> 时间：2012-09-07T15:43:36.683
> 
> 标签：css, image, fullscreen

我有这种情况使用CSS。

我希望图像位于屏幕中央，与屏幕大小无关，始终位于中间。这很容易做到。

但是，我想要在中间的图像（.png）是黑色的，里面有一些透明的字母。

所以，我希望整个屏幕都是黑色的，但屏幕中间仍然有透明的字母。

我想要透明字母的原因是因为我在页面加载时使用脚本来填充字母。这个想法是基于一个进度加载栏，但在这种情况下，使用字母作为“栏”。

我怎样才能做到这一点？我试过用 div 包围图像，但这不是最好的方法，因为根据屏幕大小，某些 div 可能无法到达图像并留下空白区域。

你有什么建议？我应该读什么？

以防我没有说清楚，这是一张图片：

![帮助图片](../Images/984d74ba67fb1c733b08af6e493b8073.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:10:26.780

我目前能想到的最好的选择，将中心周围的屏幕变黑`img`是使用`box-shadow`：

```
#main {
    position: absolute;
    top: 50%;
    left: 50%;
    margin: -250px 0 0 -250px;
    box-shadow: 0 0 0 500px #000;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/WmS26/)。

当然，这确实要求浏览器支持该`box-shadow`属性（或至少一种以供应商为前缀的实现），并且还需要一个相当任意的数字来“传播”模糊。

不幸的是，虽然我宁愿使用影响布局的`border`属性，`border`并且必须在定位 时进行补偿`img`，而`box-shadow`不会影响页面的布局。

显然，通过这个演示，`background-color`应该用`background-image`你用来表示加载条的替代品或任何替代品来代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:48:27.087

所以你想要整个屏幕变黑，但是你有透明的字母想要被看到？

如果我正确理解您想要什么，您能否将主体（或 html 对象）的背景颜色设为黑色，保留图像，但使用绝对定位将白色（或彩色）图像直接放在徽标后面。

我想我不明白你为什么想要透明字母，而是黑色背景。

# sql - NULLIF() 函数不适用于 WHERE 子句

> ID：12321366
> 
> 赞同：0
> 
> 时间：2012-09-07T15:43:45.927
> 
> 标签：sql, sql-server-2008

以下 Query 的实际结果为 NULL

```
select semid from programvariantterm where programvariantid = 240 
```

但是当我尝试以下语句时，它给出了 0 行：

```
declare @semid int
set @semid = -1
select semid from programvariantterm 
where programvariantid = 240 and semid = nullif(@semid,-1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:46:58.320

我觉得你有点`NULLIF`困惑。`ISNULL`

您的声明将适用于以下内容`ISNULL`：

```
where programvariantid = 240 and @semid = ISNULL(semid,-1) 
```

# android - 一起使用 android-support-v4.jar 和 ViewPagerExtensions.jar 会导致 jar 不匹配

> ID：12321368
> 
> 赞同：1
> 
> 时间：2012-09-07T15:43:51.800
> 
> 标签：android

如何解决我需要使用两个库的 jar 不匹配问题？我正在将 ViewPagerExtensions.jar 集成到我的项目库中，可从[https://github.com/astuetz/ViewPagerExtensions获得](https://github.com/astuetz/ViewPagerExtensions)

任何帮助或建议将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:47:18.250

此错误意味着您有两个不同版本的`android-support-v4.jar`，一个在您的项目中，一个在 ViewPagerExtensions 库中。只需将一个或两个 jar 替换为最新的`android-support-v4.jar`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:48:17.950

只需从其中一个 libs 文件夹中复制一个 .jar 并将其放在另一个库 libs 文件夹中。这样两个库都使用相同版本的支持库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T08:25:32.213

这是一个比删除和添加文件更优雅的修复！

你只需要：

右键单击项目应用程序免费转到“Android工具”>“添加支持库”批准权限并让它更新库对项目应用程序库重复此过程Android支持库将同步（：

# android - 在 Android 上打开特定文件类型

> ID：12321369
> 
> 赞同：0
> 
> 时间：2012-09-07T15:43:58.420
> 
> 标签：android, android-intent

我知道有很多像我一样的问题，但是，我无法按预期工作。我要做的就是将他的 txt 扩展名与我的应用程序相关联。

以下代码取自[Android Intent filter for a specific file extension？](https://stackoverflow.com/questions/1733195/android-intent-filter-for-a-particular-file-extension)不适合我

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.DeviceDefault" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />

            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />

            <data android:scheme="file" />
            <data android:mimeType="*/*" />
            <data android:pathPattern=".*\\.txt" />
            <data android:host="*" />
        </intent-filter>
    </activity>
</application> 
```

# php - 我是否必须 foreach 才能访问此值？

> ID：12321374
> 
> 赞同：2
> 
> 时间：2012-09-07T15:44:30.310
> 
> 标签：php, arrays, oop

> **可能重复：**
> [php中函数返回的访问数组](https://stackoverflow.com/questions/1459377/access-array-returned-by-a-function-in-php)

我在一个类中有一个函数，它返回单个项目的数据数组。

```
public function retrieveItemData($item_id) {

    $stmt   = parent::query("SELECT title FROM `item_main` WHERE `item_id` = $item_id");

    while($row = $stmt->fetch(PDO::FETCH_ASSOC)) :
        $item = array(
            'id' => $item_id,
            'title' => $row['title'],
            'url' => $item_id . '/' .$this->generate_seo_link( $row['title'], '-')
        );
    endwhile;

    return $item;
} 
```

在课堂上的其他地方我像这样调用函数

```
$this->return .= '<td>' . $this->retrieveItemData($rep['source']) . '</td>'; 
```

`$this->retrieveItemData($rep['source'])`显然正在打印“数组”，我如何从这里访问标题键？

我试过了

```
$this->retrieveItemData($rep['source'])['title'] 
```

和

```
$this->retrieveItemData($rep['source'])->title 
```

但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:48:55.823

```
$item_data = $this->retrieveItemData($rep['source']);

$item_data['title']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:06:52.210

函数调用的数组访问语法：`$this->retrieveItemData($rep['source'])['title']`在 PHP 5.4 之前是不可能的。

在早期版本中，您必须使用 Trevor 的答案中的临时变量。因此，您需要将调用函数的代码更改为：

```
$item_data = $this->retrieveItemData($rep['source']);
$this->return .= '<td>' . $item_data['title'] . '</td>'; 
```

# asp.net - 如何让浏览器始终提示输入客户端证书？

> ID：12321382
> 
> 赞同：1
> 
> 时间：2012-09-07T15:44:54.427
> 
> 标签：asp.net, iis, x509certificate

我已经设置了一个 IIS 服务器来要求客户端证书。但是浏览器从不询问用户，即使 IE 启用了“不提示选择客户端证书...”，它也会直接发送客户端证书信息

我的代码或 IIS 有什么可做的吗？

```
public partial class Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {

        Welcome.Text = "Hello, " + Context.User.Identity.Name;

        string userName;
        userName = User.Identity.Name;

        HttpClientCertificate cert = Request.ClientCertificate;
        if (cert.IsPresent)
            certDataLabel.Text = cert.Issuer;
        else
            certDataLabel.Text = "No certificate was found.";
    }

    protected void Signout_Click(object sender, EventArgs e)
    {
        FormsAuthentication.SignOut();
        Response.Redirect("Logon.aspx");
    }

} 
```

# c# - 无法从 C# 代码连接到我的 Tfs 服务器

> ID：12321387
> 
> 赞同：3
> 
> 时间：2012-09-07T15:45:07.527
> 
> 标签：c#, tfs, credentials, azure-devops

我们正在尝试使用 TeamFoundationServer .net 控件在 c# 中对我们托管的[TFS 服务帐户进行身份验证，这是我的代码：](http://tfspreview.com/)

```
NetworkCredential tfsCredential = new NetworkCredential(username, password);
TeamFoundationServer tfsServer = new TeamFoundationServer(tfsAddress, tfsCredential);

tfsServer.Authenticate(); 
```

请注意，这*不是*本地 TFS 服务器，它是[tfspreview.com](http://tfspreview.com/)上的托管 TFS 服务，我们尝试使用 Windows Live 帐户和备用身份验证凭据登录，但每次我们尝试进行身份验证时，Internet Explorer 都会打开一个新的窗口并要求提供凭据。

如果我们使用 IE 提示符连接它可以工作，但我们希望存储凭据并连接到服务器，而不是每次都询问凭据，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T23:13:03.780

您可以在配置文件下配置基本身份验证，也可以使用服务凭据。这完全取决于您需要什么样的权限。基本身份验证在用户帐户下运行，这往往是不好的做法，而服务帐户具有提升的权限。

**为 TF 服务配置基本认证**

对于基本用户身份验证，您应该连接到 TF 服务并按照指示打开您的个人资料。您的个人资料上有一个“凭据”选项卡，可让您配置这些凭据。这对于通过 API 进行的每个用户访问是好的，但如果您想通过服务器或服务运行事物，则不好。

![为 TF 服务配置基本认证](../Images/6283cac90a871558d665241c15359f90.png)

**检索 TFS 服务凭证**

我创建了一个名为[TFS 服务凭据查看器](http://nakedalm.com/tfs-service-credential-viewer/)的应用程序，它允许您检索 TF 服务实例的服务凭据。这与构建和测试服务器在本地配置它们以针对云工作时所做的事情相同。

![检索 TFS 服务凭证](../Images/f0b7836df326f45256569c26608ab967.png)

我希望这有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T14:58:25.713

Tfspreview.com 现在支持基本身份验证，这将完全消除 IE 的显示。有关如何为您的 tfspreview.com 进行设置的详细信息，请参阅[此处，然后使用您配置的用户名和密码。](http://tfspreview.com/en-us/learn/code/use-git-and-vs-with-tfs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:50:29.383

您可以根据服务器的模拟尝试使用此代码

```
var serverUrl  = "";

ICredentials credentials = new NetworkCredential(username, password, domain);
ICredentialsProvider TFSProxyCredentials = new NetworkCredentialsProvider(credentials);

TfsTeamProjectCollection currentCollection = new TfsTeamProjectCollection(new Uri(serverUrl), credentials);

// Get the TFS Identity Management Service
IIdentityManagementService identityManagementService = currentCollection.GetService<IIdentityManagementService>();
// Look up the user that we want to impersonate
TeamFoundationIdentity identity = identityManagementService.ReadIdentity(IdentitySearchFactor.AccountName, username, MembershipQuery.None, ReadIdentityOptions.None);

// Open collection impersonated
TfsTeamProjectCollection tfs = new TfsTeamProjectCollection(new Uri(serverUrl), credentials, TFSProxyCredentials, identity.Descriptor);

//For example we can access to service WorkItemStore 
var workItemStore = tfs.GetService<WorkItemStore>(); 
```

# performance - Haskell 中的函数调用有多少开销？

> ID：12321399
> 
> 赞同：17
> 
> 时间：2012-09-07T15:45:43.880
> 
> 标签：performance, haskell

我是 Haskell 的新手，我对函数调用的成本感到困惑，这对我来说似乎完全不合理，让我觉得我做的事情根本上是错误的。

考虑以下 Haskell 代码：

```
module Main where
logistic x = 4.0*x*(1.0-x)

lg :: Double -> Int -> Double
lg !x 0 = x
lg !x !n = lg (logistic x) (n-1)

main = putStrLn $ show $ lg 0.7861 100000000 
```

用命令编译它

```
 ghc -O3 -XBangPatterns -o tsths tst.hs 
```

并运行它，我得到：

```
real    0m15.904s
user    0m15.853s
sys     0m0.016s 
```

如果我不调用函数，`logistic`而是计算内联表达式：

```
module Main where

lg :: Double -> Int -> Double
lg !x 0 = x
lg !x !n = lg (4.0*x*(1.0-x)) (n-1)

main = putStrLn $ show $ lg 0.7861 100000000 
```

执行时间变为：

```
real    0m0.838s
user    0m0.828s
sys     0m0.004s 
```

这与等效的 C 程序完全相同，即

```
#include <stdio.h>

int main() {
   int i, num=100000000;
   double x=0.7861;
   for (i=0; i<num; ++i)
      x *= 4.0*(1.0-x);
   printf("%lg\n", x);
} 
```

我做错了什么吗？

非常感谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-07T16:21:02.493

这是 GHC-7.4.1 中的一个错误。查看生成的内核（只有函数的内核`lg`很重要，从GHC-7.4.2，我们得到

```
Main.lg3 :: GHC.Types.Double
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Arity=0, Value=False,
         ConLike=False, Cheap=False, Expandable=False,
         Guidance=IF_ARGS [] 30 0}]
Main.lg3 = GHC.Float.$w$cfromRational Main.lg4 Main.lg2

Main.lg1 :: GHC.Types.Double
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Arity=0, Value=False,
         ConLike=False, Cheap=False, Expandable=False,
         Guidance=IF_ARGS [] 30 0}]
Main.lg1 = GHC.Float.$w$cfromRational Main.lg2 Main.lg2

Main.$wlg :: GHC.Prim.Double# -> GHC.Prim.Int# -> GHC.Prim.Double#
[GblId,
 Arity=2,
 Str=DmdType LL,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Arity=2, Value=True,
         ConLike=True, Cheap=True, Expandable=True,
         Guidance=IF_ARGS [0 30] 158 0}]
Main.$wlg =
  \ (ww_s1Oy :: GHC.Prim.Double#) (ww1_s1OC :: GHC.Prim.Int#) ->
    case ww1_s1OC of ds_Xvs {
      __DEFAULT ->
        case Main.lg3 of _ { GHC.Types.D# x_awJ ->
        case Main.lg1 of _ { GHC.Types.D# x1_awV ->
        letrec {
          $wlg1_X1PF [Occ=LoopBreaker]
            :: GHC.Prim.Double# -> GHC.Prim.Int# -> GHC.Prim.Double#
          [LclId, Arity=2, Str=DmdType LL]
          $wlg1_X1PF =
            \ (ww2_X1Pv :: GHC.Prim.Double#) (ww3_X1PA :: GHC.Prim.Int#) ->
              case ww3_X1PA of ds1_Xwr {
                __DEFAULT ->
                  $wlg1_X1PF
                    (GHC.Prim.*##
                       (GHC.Prim.*## x_awJ ww2_X1Pv) (GHC.Prim.-## x1_awV ww2_X1Pv))
                    (GHC.Prim.-# ds1_Xwr 1);
                0 -> ww2_X1Pv
              }; } in
        $wlg1_X1PF
          (GHC.Prim.*##
             (GHC.Prim.*## x_awJ ww_s1Oy) (GHC.Prim.-## x1_awV ww_s1Oy))
          (GHC.Prim.-# ds_Xvs 1)
        }
        };
      0 -> ww_s1Oy
    } 
```

两个顶级`Double`s 和一个体面的循环。

GHC-7.4.1 有点太内联了，这产生了

```
Rec {
Main.$wlg [Occ=LoopBreaker]
  :: GHC.Prim.Double# -> GHC.Prim.Int# -> GHC.Prim.Double#
[GblId, Arity=2, Str=DmdType LL]
Main.$wlg =
  \ (ww_s1NS :: GHC.Prim.Double#) (ww1_s1NW :: GHC.Prim.Int#) ->
    case ww1_s1NW of ds_Xvb {
      __DEFAULT ->
        case GHC.Float.$wfromRat'' (-1021) 53 Main.logistic4 Main.logistic2
        of ww2_a1Mt { __DEFAULT ->
        case GHC.Float.$wfromRat'' (-1021) 53 Main.logistic2 Main.logistic2
        of ww3_X1Nq { __DEFAULT ->
        Main.$wlg
          (GHC.Prim.*##
             (GHC.Prim.*## ww2_a1Mt ww_s1NS) (GHC.Prim.-## ww3_X1Nq ww_s1NS))
          (GHC.Prim.-# ds_Xvb 1)
        }
        };
      0 -> ww_s1NS
    }
end Rec } 
```

并在每次迭代中给你两次调用`fromRational`工人。

现在，`fromRational`是一个相当复杂的功能。尽管在 7.2 系列中实现了更快的实现，但它仍然相当慢，因此这些调用非常耗时。

使用类型签名，不会`Rational`产生顶级常量，只有`Double`常量，然后使用这些常量，这当然不包括无缘无故的减速。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-07T16:10:00.273

正如 Dan Burton 所建议的，它实际上是多态函数的开销，因为 GHC 推断 type `logistic :: Fractional a => a -> a`。如果您明确指定类型，您通常会启用更好的检查和更好的优化。我认为明确指定函数类型是一种很好的做法。

如果你想拥有多态类型的函数但在特定用途的情况下拥有全速单态调用，你可以使用`SPECIALIZE`pragma，但我相信这是特定于 GHC 的。

```
{-# LANGUAGE BangPatterns #-}
module Main where
logistic :: Fractional a => a -> a
{-# SPECIALISE logistic :: Double -> Double #-}
logistic x = 4.0*x*(1.0-x)

lg :: Double -> Int -> Double
lg !x 0 = x
lg !x !n = lg (logistic x) (n-1)

main = putStrLn $ show $ lg 0.7861 100000000 
```

另请注意，您可以`LANGUAGE`在文件开头指定 pragma 以启用 bang 模式，而无需在命令行上启用它们。

我的机器上的时间是原始的 21 秒，显式类型的 0.67 秒，专门的 0.7 秒（基本相同）。

我相信专门调用的开销非常小，因为它只是一堆指令，无论如何都会被内联，但多态函数会导致调用。尽管尽管多态性，但 GHC 不能内联是很奇怪的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-07T15:58:35.430

添加类型签名`logistic`，您将看到加速。请允许我使用 CPP 来演示差异。

```
bash> cat tst.hs
module Main where

#if defined(SIG)
logistic :: Double -> Double
#endif
logistic x = 4.0*x*(1.0-x)

lg :: Double -> Int -> Double
lg !x 0 = x
lg !x !n = lg (logistic x) (n-1)

main = putStrLn $ show $ lg 0.7861 100000000

bash> ghc --version
The Glorious Glasgow Haskell Compilation System, version 7.4.1 
```

如果在未定义 SIG 的情况下编译（不包括类型签名）：

```
bash> ghc -O3 -XBangPatterns -XCPP -o tsths tst.hs
[1 of 1] Compiling Main             ( tst.hs, tst.o )
Linking tsths ...

bash> time ./tsths
0.34209286442469333

real    0m13.187s
user    0m13.177s
sys 0m0.008s 
```

现在让我们使用定义的 SIG 进行编译，以便包含签名：

```
bash> rm tsths *.o *.hi

bash> ghc -O3 -XBangPatterns -XCPP -DSIG -o tsths tst.hs
[1 of 1] Compiling Main             ( tst.hs, tst.o )
Linking tsths ...
bash> time ./tsths
0.34209286442469333

real    0m0.464s
user    0m0.440s
sys 0m0.020s 
```

不知道为什么 GHC 在没有签名的情况下不对其进行优化；单态性限制应将其限制为`Double -> Double`无论如何。

# c++ - 动态初始化

> ID：12321401
> 
> 赞同：4
> 
> 时间：2012-09-07T15:45:56.413
> 
> 标签：c++

C++03 标准*[basic.start.init] 第 3 点*状态：

> 命名空间范围的对象的动态初始化（8.5、9.4、12.1、12.6.1）是否在main的第一条语句之前完成是实现定义的。如果初始化延迟到 main 的第一个语句之后的某个时间点，它应该发生在第一次使用与要初始化的对象相同的翻译单元中定义的任何函数或对象之前。

Microsoft 编译器，根据[Additional Startup Considerations](http://msdn.microsoft.com/en-US/library/0e519f64%28v=vs.80%29)，在`main()`.

我一直无法获得说明 GNU 和 Sun Forte 编译器行为的文档。

任何人都可以：

1.  指向描述 GNU 和 Forte 编译器在动态初始化方面的行为的文档方向（我已经检查了 GCC 手册，没有发现与动态初始化相关的任何内容）。
2.  评论延迟动态初始化的线程安全（如果两个线程尝试从包含非本地对象的同一翻译单元调用函数）。

* * *

FWIW，我观察了 GNU 的 g++ 和 SUN 的 CC 的行为，并且都在 main 之前执行了初始化，尽管我不接受这是一个明确的答案。（*如果有人感兴趣，我可以发布我用来观察的非常简单的代码，但我觉得这个问题已经足够长了*）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:33:52.233

明确的答案是所有编译器都在之前进行静态初始化`main`，*除非*对象位于稍后加载的 DLL 中。在实践中，（几乎）不可能满足您引用的文本中的要求。（想想如果有一个循环会发生什么。）

# asp.net - 在 ASP.Net 中将别名列绑定到 gridview

> ID：12321402
> 
> 赞同：1
> 
> 时间：2012-09-07T15:45:58.353
> 
> 标签：asp.net, data-binding, gridview, .net-3.5, bind

我正在使用.Net 3.5。我有一个网站，我一直在使用 gridview 控件。基本上，它是一个标准的网格视图，但关闭了 AutoGenerateColumns 以支持通过 ItemTemplate 创建我们自己的列。这是我们的自定义列之一的示例：

```
<asp:TemplateField HeaderText="Physician" ItemStyle-Width="70px" HeaderStyle-Width="70">
    <ItemTemplate>                            
        <asp:Label ID="lblPhysician" runat="server" Text='<%# Bind("LastName") %>' ></asp:Label>                            
    </ItemTemplate> 
</asp:TemplateField> 
```

在后面的代码中，我根据 SQL 查询填充数据表，并将其设置为 gridview 数据源，并且通常在回发期间根据上面看到的 Bind 函数填充标签。但是，我现在有一个使用别名的 SQL 查询。查询相当大，但这里是一个示例：

```
SELECT LastName, COUNT(Case WHEN <condition> THEN 1 END) AS ABC 
FROM tablename WHERE <condition> Group By LastName 
```

问题是我不能在 ABC 上使用 Bind 命令，因为我将它用于 LastName。除了 LastName，gridview 中没有显示任何内容，即使为别名列返回了数据。如果我将 AutoGenerateColumns 设置为 true，gridview 将与所有正确的数据绑定，但这不是我们需要页面工作的方式。我错过了什么不允许我通过别名手动将列值绑定到控件？

谢谢，如果需要进一步澄清，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:04:09.357

您可以从数据绑定行中获取它；添加一个事件处理程序，在该处理程序中执行：

```
.. Grid_RowDataBound(..)
{
   var abc = DataBinder.Eval(e.Item.DataItem, "ABC")
   if (abc == null)
      ((Label)e.Item.FindControl("lblPhysician")).Visible = false;
} 
```

可能有一些语法不可用，但要点是您可以从数据项中提取字段，并以可编程的方式对其进行处理。

您还可以使用隐藏字段将其绑定到项目模板中，或者也将其粘贴到 DataKeys 集合中。

# c++ - Sizeof（）的VBA等价物？

> ID：12321404
> 
> 赞同：3
> 
> 时间：2012-09-07T15:46:04.210
> 
> 标签：c++, vba, sizeof

`C++` `sizeof`VBA中是否有等效的函数？

唯一远程相似的函数似乎是数组上的`Ubound`and运算符。`LBound`

```
Dim arr(1 to 4) as integer
MsgBox Ubound(arr) 
```

但这与 C++ 代码并不完全相同：

```
int arr[10];
std::cout << sizeof(std::string) << "\t" << sizeof(arr); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-01-06T16:45:24.033

我意识到这已经很晚了，但是......你想要的是`LenB()`

```
Public Type RECT
    Left As Long
    Top As Long
    Right As Long
    Bottom As Long
End Type

Debug.Print LenB("a") '==>2 i.e. ["a",0&]

Dim r as RECT
debug.print LenB(r) '==>16 i.e. 4 bytes for each long 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-14T19:30:35.020

会有**[Len 函数](http://msdn.microsoft.com/en-us/library/aa445063%28v=vs.60%29.aspx)**，但对于字符串，它将无法工作，`SizeOf`因为它会逐字检查字符串变量中包含的字符串的长度。

因此，要检查整数数组的字节大小：

```
Dim arr(1 To 4) As Integer
Debug.Print (UBound(arr) - LBound(arr) + 1) * Len(arr(LBound(arr))) 
```

立即窗口将显示： `8`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T01:45:23.543

可以在 VBA 中使用的几个与指针相关的函数位于：http: [//support.microsoft.com/kb/199](http://support.microsoft.com/kb/199824)`sizeof` ​​824虽然没有明显的等价物

对于数组，`VarPtr`如果您暂时将数组延长一项，然后将其缩小到所需的大小，您可能会做一些事情：

```
Sub foo()

Dim arr() As Integer 
Dim i As Integer

ReDim arr(1 To 5)
arr(1) = 12
arr(2) = 456
arr(3) = -41
arr(4) = 17

Debug.Print VarPtr(arr(1)) & "; " & VarPtr(arr(5)) & "; " & VarPtr(arr(5)) - VarPtr(arr(1))

ReDim Preserve arr(1 To 4)

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-13T16:53:57.863

[如VBA 参考手册](https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/len-function)中所定义。

您可以使用`LEN`或`LENB`

* * *

**示例`LEN`**

```
Type CustomerRecord    ' Define user-defined type.
    ID As Integer    ' Place this definition in a 
    Name As String * 10    ' standard module.
    Address As String * 30
End Type

Dim Customer As CustomerRecord    ' Declare variables.
Dim MyInt As Integer, MyCur As Currency
Dim MyString, MyLen
MyString = "Hello World"    ' Initialize variable.
MyLen = Len(MyInt)    ' Returns 2.
MyLen = Len(Customer)    ' Returns 42.
MyLen = Len(MyString)    ' Returns 11.
MyLen = Len(MyCur)    ' Returns 8. 
```

* * *

**示例`LENB`**

```
Function LenMbcs (ByVal str as String)
    LenMbcs = LenB(StrConv(str, vbFromUnicode))
End Function

Dim MyString, MyLen
MyString = "ABc"
' Where "A" and "B" are DBCS and "c" is SBCS.
MyLen = Len(MyString)
' Returns 3 - 3 characters in the string.
MyLen = LenB(MyString)
' Returns 6 - 6 bytes used for Unicode.
MyLen = LenMbcs(MyString)
' Returns 5 - 5 bytes used for ANSI. 
```

# android - 捕获 setOnClickListener() 和 setOnFocusChangeListener()

> ID：12321405
> 
> 赞同：0
> 
> 时间：2012-09-07T15:46:13.070
> 
> 标签：android

我正在为 Android 编写一个 API，我需要知道开发人员何时使用 API 调用`View.setOnClickListener()`和`View.setOnFocusChangeListener()`. 我不想重写，因为这意味着扩展`View`，我不想强​​迫开发人员使用我的子类——基本上是因为他不能使用 Eclipse 的 Android GUI 编辑器。

我试图覆盖`Activity.dispatchTouchEvent()`但我无法捕捉使用键盘/虚拟键盘完成的动作。

关于如何做到这一点的任何想法或指导方针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T07:33:26.743

我发现同时使用`Activity.dispatchTouchEvent()`和`Activity.dispatchKeyEvent()`是这样做的唯一方法。您必须跟踪先前具有焦点的视图（这样您就可以知道何时`onFocusChange()`触发）。`onClick()`可以使用操作和视图 ID 来检测`MotionEvent`。

# c++ - 无法使用带有 g++ 的 -std 标志进行编译

> ID：12321411
> 
> 赞同：0
> 
> 时间：2012-09-07T15:46:46.493
> 
> 标签：c++, gcc, c++11, g++, cygwin

我正在运行安装了 cygwin 的 Windows 7，并尝试使用一些较新的 C++ 功能。我知道，为了启用这些功能，我必须通过 g++ -std=c++0x 标志，但这给了我以下错误：

```
cc1plus: error: unrecognized command line option "-std=c++0x" 
```

我发出的导致该错误的命令行是：

```
g++-3 hello.cpp -std=c++0x -o hello 
```

g++-3的原因是因为windows的符号链接有问题。我在 cygwin 终端中使用了 g++，结果还是一样的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:27:48.817

您需要使用支持 C++ 2011 功能的 GCC 版本。

[此页面有一个编译器列表以及每个编译器支持的功能](http://gcc.gnu.org/projects/cxx0x.html)。如果我是你，我会尽可能使用 GCC 4.7。

# javascript - Ruby on Rails - Ajax 响应的问题

> ID：12321413
> 
> 赞同：0
> 
> 时间：2012-09-07T15:46:57.187
> 
> 标签：javascript, jquery, ruby-on-rails, ajax, ruby-on-rails-3

我在 Rails 中遇到了 Ajax 响应问题，我不知道如何调试它。

此代码按预期工作：

**看法**

```
 <div id="<%= dom_id(comment) %>_count">
   <%= Like.where("comment_id = ?", comment.id).count %>
 </div> 
```

**.js.erb 响应**

```
 $("#<%= dom_id(@comment) %>_count").html("<%= Like.where('comment_id = ?', @comment.id).count %>"); 
```

但是，如果我添加一个 link_to，则响应将停止工作。任何有关可能发生的事情的帮助将不胜感激。

**看法**

```
 <div id="<%= dom_id(comment) %>_count">
   <%= link_to Like.where("comment_id = ?", comment.id).count, "#" %>
 </div> 
```

**.js.erb 响应**

```
 $("#<%= dom_id(@comment) %>_count").html("<%= link_to Like.where('comment_id = ?', @comment.id).count, "#" %>"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:59:36.030

您的`Like.where(...).count`调用将从该`.count`方法返回一个整数，这将为您提供 HTML：

```
<a href="/">1</a> 
```

这相当于`http://yoursite.com/`带有视觉标签`1`。此链接将指向您应用的根路径。

那是你的意图吗？

# c# - C# - 使用样条图映射值

> ID：12321420
> 
> 赞同：1
> 
> 时间：2012-09-07T15:47:20.073
> 
> 标签：c#, charts, spline

我正在尝试使用 .Net Chart 对象以交互方式定义一个样条函数，该函数用于从一个值范围映射到另一个值。换句话说，我有一个 0-4095 范围（x 轴），我想使用样条曲线将其转换为 0-100 范围（y 轴）。我已经成功地建立了一个通过一组点绘制样条曲线的图表。用户可以交互地移动点以获得所需的功能形状。效果很好。

现在......一旦我拥有用户想要的样条，我如何（使用样条函数）找到任何 x 值对应的 y 值？

我似乎找不到办法做到这一点。我知道图表对象正在某处进行计算，因为它正在绘制样条曲线......也许他们不提供对它的访问。

另一种方法是自己进行样条计算……除非绝对必要，否则我不想去那里。

谢谢。

布莱恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:08:16.263

您需要找到产生所需 x 值的“t”（张力参数）值。如果您使用 0 到 1 的范围，则参数“t”值将接近 0.5。一旦知道 t，就可以计算 y 的对应值。求解一个三次方程，该方程将为“t”生成 3 个值，这将导致相同的 x 值。检查下面的链接。

[http://algorithmist.wordpress.com/2009/09/28/cardinal-splines-part-2/](http://algorithmist.wordpress.com/2009/09/28/cardinal-splines-part-2/)

基数样条基于从前一点到后一点的向量指定内部点的切线。每个切线都平行于这个向量，并且是它长度的某个倍数。例如，点 P1 的切线方向平行于向量 P2 – P0，或者我们可以简单地写成 T1 = s(P2 – P0)，其中 s 是实数。

检查下面的这部分代码，其中 xtarget 是输入值 x。

代码：

```
 for (Double t = 0; t<=1; t += 0.01)
  {
      s = (1 - t) / 2;
P(t)x = s(-t3 + 2t2 – t)P1X + s(-t3 + t2)P2X + (2t3 – 3t2 + 1)P2X + s(t3 – 2t2 + t)P3X + (-2t3 + 3t2)P3X + s(t3 – t2)P4X

P(t)y = s(-t3 + 2t2 – t)P1Y + s(-t3 + t2)P2Y + (2t3 – 3t2 + 1)P2Y + s(t3 – 2t2 + t)P3Y+ (-2t3 + 3t2)P3Y + s(t3 – t2)P4Y

if(P(t)x=>xtarget)
{
return P(t)y;
}
} 
```

上述方法将给出曲线上的近似点 P(t)y。

# deployment - 如何开发自下而上的 JAX-WS Web 服务引用包含在单独 jar 文件中的类？

> ID：12321421
> 
> 赞同：1
> 
> 时间：2012-09-07T15:47:19.710
> 
> 标签：deployment, jar, shared-libraries, classloader, external

我正在开发一个 Java EE 6 自下而上的 JAX-WS 来公开一个 EJB3.1 无状态会话 bean。WAR 中的 Web 服务无法在部署时安装，因为它引用了一个可以假设尚未加载的外部 jar（或共享库）。

常见的建议是将 jars 包含在 /lib 文件夹中，这确实可以解决问题，但是 jars 需要保留在此外部共享库位置而不是 ear 文件中，因为它们总计 30MB。

有哪些技术可以在 Websphere (WAS v.8) 环境或任何服务器环境中解决此问题。我发现的一些建议包括：

```
 1\. define classpath in META-INF file.    
   2\. define the resources in deployment.xml    
   3\. alter class loading order    
   4\. (from ibm) In the case where the jars are part of a Shared Library configured on WebSphere Application Server, then a User Library must be used to configure the project for development before generating the WebService. 
```

但是，我未能在这些领域在线找到任何帮助。是否有另一种技术，或者有没有人知道如何做到这一点？提前致谢。

编辑：如果我使用类路径在 META-INF 中指定库，它们会在扩展、共享库等之前加载，但它们仍然在 WAR 之后加载，这是不好的。同样，这不是运行时问题，因为 Web 服务是在部署时动态创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:42:39.147

我向 IBM 提交了一张票。Web 服务引用的库在部署期间是必需的，并且必须以某种方式捆绑到 Ear 中。我把它们扔进了 web-inf/lib 文件夹。但是，如果引用的库随后依赖于其他库，则可以将这些库放置在共享库中。对我来说似乎也很奇怪，但让我们都承认“共享库”无论如何都是一种黑客行为。

如果您仍然有问题，只需确保您的类加载设置为 parent_last。

# sql - SQL 从另一个表更新表

> ID：12321424
> 
> 赞同：0
> 
> 时间：2012-09-06T13:18:00.613
> 
> 标签：sql

在 Access 中使用 SQL，尝试使用用户名从另一个表“更新”一个表。下面的第 3 行 (SQLnm2...) 显示错误 2465 找不到字段“|”。我尝试过多种方式更改表达式，但没有成功。任何帮助将不胜感激。

```
Dim SQLnm As String  
Dim SQLnm2 As String  
SQLnm2 = SQLnm2 & "', '" & [Employees]![NBK] & "');"  
SQLnm = " Update tbl_DateTracking SET NBK = "  
SQLnm = SQLnm & "'" & SQLnm2 & "' WHERE "  
SQLnm = SQLnm & "CaseId = '" & CaseId & "' AND OCC_Scenario = '" & OCC_Scenario & "';"  
DoCmd.RunSQL SQLnm 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T13:30:59.850

你有一个右**括号**，它没有在你的第三行打开。

> SQLnm2 = SQLnm2 & "', '" & [员工]![姓名] & "');"

您也没有说明要更新哪一列。看来您要更新 2 列，第一列是 NBK，其值为空。第二个是棘手的，因为您要么想要更新名为 Name 的列，要么将另一列更新为 employee.name 的值。

您的代码连接到

> 更新 tbl_DateTracking SET NBK = '', 'Employee name' WHERE

您的代码需要说明哪一列是员工姓名。

例如

> 更新 tbl_DateTracking SET NBK = '', EnterColumnNameHere= 'Employee.Name' WHERE

或者你的意思是

> 更新 tbl_DateTracking SET NBK = 'Employee.Name' WHERE

在我知道您要填充多少列（以及使用什么值）之前，我无法提供 SQL 代码。

作为上下文指南：

```
UPDATE table_name
SET column1=value, column2=value2,...
WHERE some_column=some_value

UPDATE Persons
SET Address='Nissestien 67', City='Sandnes'
WHERE LastName='Tjessem' AND FirstName='Jakob' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T13:40:53.610

```
Dim SQLnm2 As String 
```

应该初始化`SQLnm2`为一个空字符串，所以

```
SQLnm2 = SQLnm2 & "', '" & [Employees]![name] & "');" 
```

会产生一个字符串`', '...');`。

```
SQLnm = " Update tbl_DateTracking SET NBK = "  
SQLnm = SQLnm & "'" & SQLnm2 & "' WHERE " 
```

然后将该字符串插入到`SQLnm`中，生成查询

```
Update tbl_DateTracking SET NBK = '', '...');' WHERE ... 
```

这可能应该是

```
Update tbl_DateTracking SET NBK = '...' WHERE ... 
```

# asp.net - FileHelpers 文件访问

> ID：12321428
> 
> 赞同：0
> 
> 时间：2012-09-07T15:47:36.057
> 
> 标签：asp.net, exception, filehelpers

我正在努力解决 FileHelpers 库并遇到主要的关键问题。当我尝试在我的网络应用程序中实现它，甚至使用在线演示时，我最终得到“FileNotFoundException”。正在我的 C: 驱动器上查找所选文件。如何使 FileHelpers 代码访问我的应用程序的相对路径而不是绝对路径？

![（来自在线演示的截图）](../Images/62614f6cf2763550d70885b9888b3c56.png)

问候，

巴托什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:52:05.393

使用该`Server.MapPath()`方法将相对路径（基于当前目录或网站根目录）映射到绝对可访问路径。

例如，如果`yourfile.txt`放置在`App_Data`您网站的文件夹中，那么您可以编写：

```
Customer[] customers =
    (Customer[])engine.ReadFile(Server.MapPath("~/App_Data/yourfile.txt")); 
```

波浪号字符代表您网站的根，如果您指定一个相对路径，那么它将被解析为相对于您的 ASP.NET 页面所在的目录。

# alert - SQL Server 2005 - 如何延迟第一个复制警报？

> ID：12321429
> 
> 赞同：1
> 
> 时间：2012-09-07T15:47:43.867
> 
> 标签：alert, merge-replication

我设置了 SQL Server 2005 合并复制，并且设置了一个订阅者作为请求订阅。它按每分钟一次的计划运行。

如果 SQL Server 复制代理失败了一段时间或尝试了一定次数，我想收到警报。例如，如果它失败了，然后很快又开始工作，那很好——我不想被提醒。

但是，如果 5 分钟或 5 次后仍然失败，那么我希望收到警报。

我查看了“响应之间的延迟”设置，但似乎这将始终发送初始警报，并且延迟仅对任何后续警报生效。

此外，我想知道单个合并是否需要超过 5 分钟。因此，如果它已经运行了 5 分钟或更长时间，我们就会收到警报。

# r - 图例颜色调用字典 R

> ID：12321430
> 
> 赞同：0
> 
> 时间：2012-09-07T15:47:56.040
> 
> 标签：r, legend

我有一个情节，它用特定的符号和颜色绘制点。我希望我的图例显示与图中完全相同的颜色和符号。我可以手动执行此操作，但我要生成 50 多个图，并且数据将不断更新，因此我想自动化该过程。我试图创建一个字典并想搜索字典。如果在 中找到该值`levels(Color_test)`，则将图例中的符号着色为与字典中概述的相同。我的图例代码如下：

```
legend(legend_X, legend_Y,
    xjust=x_adj, yjust=y_adj,
    levels(Color_test), 
    col=Labels.col,
    pch=Labels.sym,
    horiz=FALSE) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:16:56.763

您可能正在寻找某种将您的数据与字典合并的方法。这是仅使用颜色的方法，因为它只是一个示例

```
data <- data.frame(type = sample(letters[1:3],20,replace=T),
                   x = runif(20),
                   y = runif(20))
dict <- data.frame(type = letters[1:4],
                   color = c("red","green","blue","black"))
plot(data$x, data$y, col = merge(data,dict)$color)
legend("topleft",legend=dict$type, col=dict$color, pch=1) 
```

您可以轻松地修改图例，以便显示实际使用的颜色。

```
data_dict <- merge(data,dict)
plot(y~x, col=color, data=data_dict, pch=as.vector(type))
legend("topleft",legend=unique(data_dict$type), col=unique(data_dict$color), pch=1) 
```

# javascript - 布局引擎和javascript引擎的区别

> ID：12321434
> 
> 赞同：5
> 
> 时间：2012-09-07T15:48:08.610
> 
> 标签：javascript, browser, layout-engine

读了很多，似乎人们说浏览器引擎时，指的就是gecko或webkit之类的布局引擎。

我也知道布局引擎基本上负责“绘制”屏幕，而javascript引擎用于解释。

但问题是，对于一个对性能有更大影响的现代 Web 应用程序？这两者有什么关系？它们在浏览器之外的其他用途是什么。它们还有哪些其他功能。

非常感谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T17:03:09.133

无论您对内容征税最多的引擎，都会产生最大的影响。如果您有一个巨大、复杂的 HTML 文档，其中包含数千个复杂节点和复杂的 CSS，您将对布局/渲染引擎造成很大的负担，因此您可能会注意到各种浏览器之间的差异。但是，在大多数情况下，我认为您的内容必须非常复杂，才能体现出显着差异。

在 javascript 方面，如果您的页面是高度动态的，并且有大量回调处理许多快速事件并为响应这些事件对文档进行重大更改，则 javascript 引擎将对您的页面性能产生更大的影响。

在浏览器之外，有时布局/渲染引擎将用于“无头”程序，例如 PhantomJS。Javascript 引擎可用于在非浏览器环境中解释 javascript，就像使用 node.js、Rhino 等一样。

# java - 是否有任何替代 Java 属性来保存树状数据的方法？

> ID：12321436
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:08.860
> 
> 标签：java

我有 3 个项目数据应该保存在远程 PC 上。让它成为：ID，登录名，密码。如果只有 2 项，Java 属性将非常适合我，但我有某种树。在那台机器上安装任何数据库是不可能的，因此使用数据库的变体立即被拒绝。

我们是否有任何替代 Java 属性的方法来解决此任务？

PS>差点忘了，远程PC上只有JRE，我没有办法在那里安装JDK。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:50:24.473

考虑改用首[选项](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/prefs/Preferences.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T15:50:15.167

如果您想保留一棵属性树，我建议您使用 XML。

# java - 安装 Android SDK 时选择哪个 Android 平台？

> ID：12321437
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:12.587
> 
> 标签：java, android

安装Android SDK后，我注意到我需要单独选择平台，即Android 1.3一直到4.1。

我的问题是，这是否意味着如果我创建一个应用程序，我必须在每个平台上单独创建它？

我对Android开发完全是个菜鸟......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T15:54:36.590

基本上建议**选择您计划在应用程序中支持的最低 API**（除非您知道有理由对其进行不同的设置）。例如，如果您的应用仅适用于 Honeycomb 和更新版本，则选择 SDK 3.0 以访问您可能想要使用的 HC 中新引入的所有功能。但是，如果您的应用程序还应在具有旧版本 Android（如 2.0.1（如果您真的需要，甚至是 1.6））的旧设备上运行，请将其设置为所需的最低 API。因此，现在该规则对您来说已经足够了，并且可以让您确保不会意外使用任何在您的目标平台上不支持的 API 方法，这会导致您的应用程序崩溃。

[根据 Google 发布的平台版本细分统计数据](http://developer.android.com/about/dashboards/index.html)，如果不确定您想要什么 API，我建议您使用 2.x 并忽略任何较旧的 Android 版本，因为它基本上毫无意义。

我建议您阅读这篇[SDK 文章](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)，了解如何定义`minSdk`和`targetSdk`满足您的要求的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:54:01.340

一个简单的答案是否定的。

当您开发应用程序时，您可以指定要为其开发的最小平台。较新的 SDK 将具有更多旧版本可能不具备的功能，因此必须注意确保您的应用程序可用于特定平台。

我建议您为 developer.android.com 和 stakoverflow.com 网站添加书签，它们会非常方便 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:52:59.197

不可以。您可以在 Android Manifest 中为您的应用指定一个`minimumsdkversion`，以便它支持从该 API 级别到最新平台的所有平台。

请参阅[此处](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)了解更多信息。

编辑：当然，如果没有支持库或一些第三方库（例如操作栏、片段、可扩展通知等），您不能在旧 SDK 中使用一些较新的 API 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T15:53:07.387

看看[这里](http://developer.android.com/guide/components/fundamentals.html#Manifest) 基本上这意味着您的应用程序将与此 android 版本一起使用（但您也可以支持更高或更低的版本）。我强烈建议您阅读文档以更好地了解所有事情是如何工作的。

# c# - 在数据连接中对数据库进行 Linq 操作

> ID：12321441
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:20.560
> 
> 标签：c#, linq, visual-studio-2012

我正在使用 Visual Studo 2012 和 SQLExpress。

我正在尝试对数据连接中的数据库进行 Linq 操作。该数据库位于我计算机上的本地服务器上。它已经显示在 Server Explorer -> Data Connections 窗格中。

我如何实际获取数据源以在我的程序中对其进行操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:51:49.607

您必须添加 Linq-to-SQL 实体对象。在 Visual Studio 中：

1.  右键单击您的项目并*添加项目*
2.  *在数据*下添加*LINQ to SQL 类*
**   在 VS 中打开新的*DataClasses.dbml*项目文件*   将数据库对象（表、存储过程）拖到窗格中*   在您的代码中，实例化*DataContext*类，一切顺利。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:52:34.107

开始使用实体框架：http: [//msdn.microsoft.com/de-de/data/ee712907](http://msdn.microsoft.com/de-de/data/ee712907)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:18:10.060

您可以使用向导在项目中添加 ADO.Net 实体模型。它将创建一个包含数据库实体的 edmx 文件。您可以创建实体对象并直接在 LINQ 中使用这些表。*

# jquery - 滚动到另一个网页的特定部分 onclick

> ID：12321446
> 
> 赞同：1
> 
> 时间：2012-09-07T15:48:36.000
> 
> 标签：jquery, asp.net, html

所以我有一个链接到联系页面的自定义图像。在此页面上，当从主页单击联系人时，它会滚动到特定的 div（联系人表单）。

我一直在网上搜索并从这个[问题中偶然发现了一个](https://stackoverflow.com/questions/9652944/jquery-page-scroll-to-different-page)[scrollto](http://flesler.blogspot.ca/2007/10/jqueryscrollto.html)插件，但它似乎只进入同一页面的不同部分（不确定，但它对我不起作用）。

谁能指导我“创建一个遍历到另一个页面然后滚动到特定 div 的链接”谢谢。一个例子将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:54:27.990

您可能想要使用*锚点*，然后使用`#`in`href`来引用名称：

```
<a name="css-tutorials">CSS Tutorials</a>

<a href="#css-tutorials">Cascading Style Sheet Tutorials</a> 
```

示例取自[这里](http://www.expression-web-tutorials.com/anchor-tags.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:58:44.737

这是一个基于 URL 滚动到 div ID 的窗口的 JSfiddle。它可以修改为在点击事件时触发，或在页面加载时读取正在传递的 ID 的 URL。让我知道该示例是否需要一些调整。

这使用 jQuery

[http://jsfiddle.net/jmKUw/1/](http://jsfiddle.net/jmKUw/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:00:16.880

您需要将要滚动到的 div 的名称（可能作为查询字符串）传递到联系人页面，并将其存储在隐藏的输入中。

然后在 $(document).ready(function () {}); 块，调用你的scrollto函数，将隐藏输入的值传递给它。

# jquery - jQuery $.ajax 内存泄漏？

> ID：12321447
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:42.147
> 
> 标签：jquery, ajax, firefox, memory-leaks

为什么 jQuery ajax 会在 Firefox 和其他浏览器上导致可怕的内存泄漏？

jsfiddle：http: [//jsfiddle.net/Rqfz7/](http://jsfiddle.net/Rqfz7/)

如果你在 Firefox 之类的浏览器中运行它，这会导致内存攀升。有没有其他人看过这个？有没有办法用 jQuery ajax 阻止内存泄漏？谢谢

```
$.ajax({
    url: "http://ws.geonames.org/searchJSON",
    dataType: "jsonp",
    data: {
        featureClass: "P",
        style: "full",
        maxRows: 12,
        name_startsWith: "M"
    },
    success: function( data ) {
        setInterval(function() {
            get_some_stuff();
        }, 1000);
        load_count = load_count + 1;
        $('body h1').text('load_count: ' + load_count);             
    }
}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:52:12.240

这是因为您是`setInterval()`从`get_some_stuff()`函数内部调用的。`setInterval`用于以指定的时间间隔反复运行功能。您的问题是因为所有那些已注册的函数调用（通过`setInterval`）每秒都在执行，并且它们有很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T15:55:43.357

我认为你想做 SetTimeout 而不是 SetInterval。

尝试这个..

[http://jsfiddle.net/Rqfz7/2/](http://jsfiddle.net/Rqfz7/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:55:09.033

您正在递归调用`get_some_stuff()`ajax 请求成功。此外，每次 ajax 请求完成时，您都会设置一个循环，在 1 秒后调用该函数。每次调用 ajax 时，您都会调用另一个循环。如果这种情况持续 1000 个循环，那么您将有 1000 个循环都调用该`get_some_stuff()`函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T19:36:20.373

我最近有一个类似的问题，对 json Web 服务的重复 ajax 调用导致严重的内存泄漏，即使没有对 json 对象本身进行任何处理。

原来，我猜 jQuery 中有一个错误。将您的数据类型更改为“文本”，然后使用不使用 eval() 的库解析结果响应，这就是我认为导致泄漏的原因。

我在这里[json_parse.js](https://github.com/douglascrockford/JSON-js)找到了这个库。到目前为止，它运行良好，尽管它使用了更多的 CPU。

# asp.net - 我应该如何正确地从 Web 应用程序查询 SQL？

> ID：12321448
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:41.733
> 
> 标签：asp.net, sql

我正在制作一个 Web 应用程序，并且想知道使用 sql 查询中的值填充列表框的最佳方法，然后在选择列表框中的值之一时填充文本框。看起来慢得可怕。目前，我打开一个连接（来自一个 xml 文件）并进行查询，将 SSN 放入列表框中。然后，在 selectedindexchanged 上，重新打开并再次查询（相同的查询）以获取与该 SSN 关联的名称并将这些结果放入文本框中。有没有更好（更快）的方法来做到这一点？这是我目前拥有的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data;
using System.Data.SqlClient;
using System.Configuration;
using System.Xml;

namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        private SqlConnection Sqlconnection;//= new SqlConnection(ConfigurationManager.ConnectionStrings["xxxConnectionString"].ToString());
        private SqlCommand command;
        private string sqlQuery = "";
        private SqlDataReader reader;
        private static string configFile=@"C:\Documents and Settings\xxx\My Documents\Visual Studio 2010\Projects\WebApplication1\WebApplication1\Config.xml";

        protected void Page_Load(object sender, EventArgs e)
        {

        }

        /// <summary>
        /// Get connection info from config.xml
        /// </summary>
        private void ReadConnection()
        {
            string conn = String.Empty;

            //Create xml document
            XmlDocument xmlDoc = new XmlDocument();
            //Load the config file (hard-coded for now)
            xmlDoc.Load(configFile);
            XmlNodeList connection = xmlDoc.GetElementsByTagName("Connection");
            conn = connection[0].InnerText;
            Sqlconnection = new SqlConnection(conn);
            //return conn;
        }

        /// <summary>
        /// Get query from config.xml
        /// </summary>
        /// <returns></returns>
        private string ReadQuery()
        {
            if (string.IsNullOrEmpty(sqlQuery))
            {
                XmlDocument xmlDoc = new XmlDocument();
                xmlDoc.Load(configFile);
                XmlNodeList query = xmlDoc.GetElementsByTagName("Query");
                sqlQuery = query[0].InnerText;
            }

            return sqlQuery;
        }

        /// <summary>
        /// Populates textboxes on listBox index changed
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        protected void ListBox2_SelectedIndexChanged(object sender, EventArgs e)
        {
            try
            {
                ReadConnection();
                SqlCommand command = new SqlCommand("SELECT TOP (100) S.PlanID, S.EmployerID, S.VendorID, S.SSN, D.First, D.Middle, D.Last, D.State, S.NumLoans, S.TypeAcct, S.ERBalance, S.YTDEEContrib FROM SparkData AS S WITH(NOLOCK) INNER JOIN Demographics AS D WITH(NOLOCK) ON S.SSN = D.SSN ORDER BY S.SSN", Sqlconnection);
                command = new SqlCommand(ReadQuery(), Sqlconnection);
                Sqlconnection.Open();
                SqlDataReader reader = command.ExecuteReader();

                if (reader.HasRows)
                    {
                        while (reader.Read())
                        {
                            //Assign to textbox here
                            if (reader["SSN"].ToString() == ListBox2.SelectedValue)
                            {
                                TextBox1.Text = reader["First"].ToString();
                                TextBox2.Text = reader["Middle"].ToString();
                                TextBox3.Text = reader["Last"].ToString();
                            }
                        }
                    }
            }
            catch (SqlException ex)
            {
                Response.Write(ex.Message.ToString());
            }
            finally
            {
                Sqlconnection.Close();
                SqlConnection.ClearPool(Sqlconnection);
            }
        }

        /// <summary>
        /// Connect to sql and populate listbox
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        protected void Button1_Click(object sender, EventArgs e)
        {
            try
            {
                ReadConnection();
                command = new SqlCommand(ReadQuery(), Sqlconnection);
                Sqlconnection.Open();
                reader = command.ExecuteReader();

                if (reader.HasRows)
                {
                    while (reader.Read())
                    {
                        //Assign SSNs to listbox
                        ListBox2.Items.Add(reader["SSN"].ToString());
                    }
                }
            }
            catch (SqlException ex)
            {
                Response.Write(ex.Message.ToString());
            }
            finally
            {
                Sqlconnection.Close();
                SqlConnection.ClearPool(Sqlconnection);
            }
        }
    }
} 
```

和

```
 <%@ Page Title="xxx Home Page" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true"
    CodeBehind="Default.aspx.cs" Inherits="WebApplication1._Default" %>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <h2>
        Welcome to ASP.NET!
    </h2>
    <p>
        To learn more about xxx, Inc. <a href="http://www.tsacg.com/" title="xxx Website">www.xxx.com</a>
        <br />
        Here is the <a href="https://xxx-sql38.xxx.com/"
            title="xxx, Inc Intranet Portal">xxx Intranet Portal</a>.
    </p>
    <div align="center">
        <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Connect" 
            ToolTip="Click to populate the SSN ListBox"/>
    </div>
    <div align="center">
    <asp:ListBox ID="ListBox2" runat="server" AutoPostBack="True" EnableViewState="true"
        onselectedindexchanged="ListBox2_SelectedIndexChanged" Width="200px">
    </asp:ListBox>
    </div>
    <div align="center">
    <asp:TextBox ID="TextBox1" Width="125" runat="server">First Name</asp:TextBox>
    <asp:TextBox ID="TextBox2" Width="25" runat="server">MI</asp:TextBox>
    <asp:TextBox ID="TextBox3" Width="125" runat="server">Last Name</asp:TextBox>
    </div>
    <%--<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:xxxDataConnectionString %>"--%>

    <%--SelectCommand="SELECT TOP (100) S.PlanID, S.EmployerID, S.VendorID, S.SSN, D.First, D.Middle, D.Last, D.State, S.NumLoans, S.TypeAcct, S.ERBalance, S.YTDEEContrib FROM SparkData AS S WITH (NOLOCK) INNER JOIN Demographics AS D WITH (NOLOCK) ON S.SSN = D.SSN ORDER BY S.SSN">
</asp:SqlDataSource>--%>
    <%--<asp:ListBox ID="ListBox1" runat="server" DataSourceID="SqlDataSource1"
            DataTextField="SSN" DataValueField="SSN" Width="200px" EnableViewState="true" AutoPostBack="true"
        onSelectedIndexChanged="ListBox1_SelectedIndexChanged"></asp:ListBox>--%>
    </asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T15:59:10.623

关于您的代码的一些评论-

1.  为每个请求打开和关闭连接是非常低效的。我猜您遇到的延迟不是因为 SQL 查询，而是因为打开与数据库的连接的开销。
    您可能想看看连接管理/池解决方案（[小例子](http://betav.com/blog/billva/2007/05/managing_and_monitoring_net_co.html)；谷歌肯定有更多）。

2.  在初始化您的命令查询 ( `SqlCommand command = new SqlCommand("SELECT TOP (100) S.PlanID, S.EmployerID, S.VendorID, S.SSN, D.First, D.Middle, D.Last, D.State, S.NumLoans, S.TypeAcct, S.ERBalance, S.YTDEEContrib FROM SparkData AS S WITH(NOLOCK) INNER JOIN Demographics AS D WITH(NOLOCK) ON S.SSN = D.SSN ORDER BY S.SSN", Sqlconnection);`) 后，您立即使用`command = new SqlCommand...`. 这是为什么？

3.  继续我的第一句话——在代码中将查询写成字符串既低效又不安全。如果你有时间，我会读一些关于[OR/M](http://en.wikipedia.org/wiki/Object-relational_mapping)的文章（我最喜欢的是 nhibernate）
4.  我还想看看[n 层架构](http://en.wikipedia.org/wiki/N-tier)（取决于你的应用程序有多大）；我真的不喜欢表示层中的数据访问:)

如果您有任何更具体的问题，请随时在此处发布。
如果您正在寻找改进现有代码的评论和方法，堆栈交换现在有一个[代码审查站点](https://codereview.stackexchange.com/questions)。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T15:56:57.140

根据总数据大小，您可以在客户端缓存所有可能的组合，以便当它们更改选择值时，您可以更新文本框。如果所有可能的组合都小于 300KB，那么根据连接速度将其发送到客户端浏览器可能是合理的。

往返于服务器以填充文本框，如果期望它是即时反馈，总是会比你喜欢的要慢。当然，也可能是您的数据库查询由于某种原因很慢，所以也要调查一下。

其他注意事项：

*   如果这是针对客户端和服务器位于同一 LAN 上的内部应用程序，那么连接速度有望更快，因此根据您的用例，缓存更多数据（几 MB ?)
*   如果这是针对连接缓慢或不一致的应用程序，同样取决于您的需求和客户端浏览器的功能，最好限制您尝试发送到客户端的数据量。如果我了解您来自哪里，这听起来像是初始页面加载时间和页面加载后的响应能力之间的权衡（并且缓存数据，如果有的话，在客户端计算机上可用）。

# xml - 为什么 CFXML 不喜欢 &？

> ID：12321449
> 
> 赞同：2
> 
> 时间：2012-09-07T15:48:43.677
> 
> 标签：xml, coldfusion, ampersand

使用 CFXML，我收到此错误：

> 解析 XML 文档时发生错误。实体名称必须紧跟实体引用中的“&”。

转储显示像这样使用的 & 符号：

> 事物与事物

这是代码：

```
<cfxml variable="xml">
    <cfoutput>
        <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
            #xml#
        </urlset>
    </cfoutput>
</cfxml> 
```

为什么 CFXML 不喜欢这种与符号的格式，它们应该采用什么格式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T23:33:44.860

在数据周围使用 xmlFormat() ，它应该可以解决您的问题。

# css - CSS继承不应用样式

> ID：12321450
> 
> 赞同：0
> 
> 时间：2012-09-07T15:48:46.593
> 
> 标签：css, extjs4.1

所以我得到了以下 DOM 结构，我将重点放在突出显示的类上。

![在此处输入图像描述](../Images/f141e0589063f1441cdbcbb7f95af63a.png)

我想将文本“Contributing to Aggregate”的颜色更改为白色。我在顶层项目上放置了一个“标记”CSS 类（称为 fmg-white）（以从页面上的其他元素中识别此元素实例）。我创建了第二个 CSS 规则（.x4-form-field .fmg4-html-box .fmg-white），我认为它将“标记”类与较低级别的应用类（.x4-form-field）结合使用.fmg4-html-box) 专门针对 DIV 中的文本。但这并没有发生……（标记是由 extjs4 发出的）

任何帮助表示赞赏。

```
.fmg-white
{
    /* marker */
}

.x4-form-field .fmg4-html-box .fmg-white
{
    color: White !important;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:03:56.323

您错误地应用了选择器：

```
.fmg-white .x4-form-field.fmg4-html-box
{
    color: White !important;
} 
```

`.fmg-white`是的祖先`div.x4-form-field.fmg4-html-box`

如果您想要的项目有多个类，则将它们链接起来而不是将它们分开。

空格（在两个选择器之间）表示下一项将是前一项的后代。

IE`html div`将为页面上的所有 div 设置`#myDiv div`样式，但只会设置属于`#myDiv`

# html - HTML 电子邮件中的链接损坏

> ID：12321451
> 
> 赞同：3
> 
> 时间：2012-09-07T15:48:47.350
> 
> 标签：html, email, encoding, hyperlink, href

我正在发送一封嵌入 HTML 链接的电子邮件，如下所示：

```
<a href="https://mydomain.com/?d=zJBTDhP%2bZxolUHQ6qJ2yFA%3d%3d" target='_blank'>Link</a> 
```

当调用查询字符串参数“d”时，会先对 URL 进行解码，然后使用我们自己的函数进行解密 (Rijndael)。非常偶尔（1% 的情况），对于某些用户，这会失败，并且错误日志显示查询字符串值已演变为：

```
mWOGQuC%2oMkbyHUD6dW2lSN%3q%3q 
```

所以从：

```
zJBTDhP%2bZxolUHQ6qJ2yFA%3d%3d 
```

至：

```
mWOGQuC%2oMkbyHUD6dW2lSN%3q%3q 
```

由于这个问题的间歇性......这可能是一个过分热心的垃圾邮件过滤器还是我们这边的编码问题？

# http - 什么编码字符串告诉 Web 服务器不要发送 gzip 内容？

> ID：12321455
> 
> 赞同：39
> 
> 时间：2012-09-07T15:48:53.467
> 
> 标签：http, header, gzip

此编码标头告诉 Web 服务器发送 gzip 内容（如果可用）。

```
'accept-encoding': 'gzip,deflate,sdch', 
```

如何指示 Web 服务器发送纯文本而不是 gzip 内容？我知道如果 Web 服务器愿意，它可以简单地忽略这个请求。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2014-07-30T20:50:13.607

不包括`accept-encoding`标头意味着您可能需要默认编码，即`identity`. 这里需要注意的是，[RFC2616 sec 14.3](https://www.rfc-editor.org/rfc/rfc2616#section-14.3)允许服务器假设任何可用的编码都是可以接受的。

要*显式*请求纯文本，请设置`'accept-encoding: identity'`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-07T15:57:22.760

将编码排除在接受编码之外将不允许该编码（即gzip）。

如果要*明确*将其设置为不允许，可以将 a 设置`qvalue`为 0。

```
'accept-encoding': 'gzip;q=0,deflate,sdch' 
```

[您可以在RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3)中的 accept-encoding 下阅读更多内容，但简而言之，如果服务器在列出的编码中找不到可接受的编码（身份是一种特殊情况，请参阅链接），它应该发送 406（不可接受）响应并且不要使用任何其他编码回复您的请求。

# python - Python中的凸多面体交集

> ID：12321456
> 
> 赞同：2
> 
> 时间：2012-09-07T15:48:54.323
> 
> 标签：python, geometry, computational-geometry

> **可能的重复：**
> [用于表示 3D 多面体的库](https://stackoverflow.com/questions/3151524/library-for-representing-3d-polyhedra)

**是否有现成的 Python 库来测试两个凸多面体 (3D) 是否相交？**

作为输入，我有坐标，如果有必要，还有定义多面体的面。我花了一些时间研究[分离超平面](http://en.wikipedia.org/wiki/Hyperplane_separation_theorem)的数学、[Minkowski 加法](http://en.wikipedia.org/wiki/Minkowski_addition)和[Gilbert-Johnson-Keerthi 距离算法](http://en.wikipedia.org/wiki/Gilbert%E2%80%93Johnson%E2%80%93Keerthi_distance_algorithm)，我觉得我迷失了细节。如果可能的话，我宁愿不重新发明轮子并自己编写代码。如果已经存在健壮的库，则尤其如此。一个最小的工作示例将非常有帮助！

# bash - 超时重试 Bash 命令

> ID：12321469
> 
> 赞同：64
> 
> 时间：2012-09-07T15:49:46.407
> 
> 标签：bash, loops, timeout

如何重试 bash 命令直到其状态正常或达到超时？

我最好的镜头（我正在寻找更简单的东西）：

```
NEXT_WAIT_TIME=0
COMMAND_STATUS=1
until [ $COMMAND_STATUS -eq 0 || $NEXT_WAIT_TIME -eq 4 ]; do
  command
  COMMAND_STATUS=$?
  sleep $NEXT_WAIT_TIME
  let NEXT_WAIT_TIME=NEXT_WAIT_TIME+1
done 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-09-07T16:13:45.487

`command`您可以通过正确地进行测试并以不同的方式进行增量来简化事情。否则脚本看起来不错：

```
NEXT_WAIT_TIME=0
until [ $NEXT_WAIT_TIME -eq 5 ] || command; do
    sleep $(( NEXT_WAIT_TIME++ ))
done
[ $NEXT_WAIT_TIME -lt 5 ] 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2019-11-08T03:32:01.247

一条线，最短，也许是最好的方法：

```
timeout 12h bash -c 'until ssh root@mynewvm; do sleep 10; done' 
```

归功于[http://jeromebelleman.gitlab.io/posts/devops/until/](http://jeromebelleman.gitlab.io/posts/devops/until/)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-03-14T00:56:55.823

# 重试功能来自：

# [http://fahdshariff.blogspot.com/2014/02/retrying-commands-in-shell-scripts.html](http://fahdshariff.blogspot.com/2014/02/retrying-commands-in-shell-scripts.html)

```
#!/bin/bash

# Retries a command on failure.
# $1 - the max number of attempts
# $2... - the command to run
retry() {
    local -r -i max_attempts="$1"; shift
    local -r cmd="$@"
    local -i attempt_num=1

    until $cmd
    do
        if (( attempt_num == max_attempts ))
        then
            echo "Attempt $attempt_num failed and there are no more attempts left!"
            return 1
        else
            echo "Attempt $attempt_num failed! Trying again in $attempt_num seconds..."
            sleep $(( attempt_num++ ))
        fi
    done
}

# example usage:
retry 5 ls -ltr foo 
```

# 如果你想在你的脚本中重试一个函数，你应该这样做：

```
# example usage:
foo()
{
   #whatever you want do.
}

declare -fxr foo
retry 3 timeout 60 bash -ce 'foo' 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-03-26T19:39:31.577

把一些工具放在一起。

重试：[https ://github.com/kadwanev/retry](https://github.com/kadwanev/retry)

超时： http: [//manpages.courier-mta.org/htmlman1/timeout.1.html](http://manpages.courier-mta.org/htmlman1/timeout.1.html)

然后看看魔法

```
retry timeout 3 ping google.com

PING google.com (173.194.123.97): 56 data bytes
64 bytes from 173.194.123.97: icmp_seq=0 ttl=55 time=13.982 ms
64 bytes from 173.194.123.97: icmp_seq=1 ttl=55 time=44.857 ms
64 bytes from 173.194.123.97: icmp_seq=2 ttl=55 time=64.187 ms
Before retry #1: sleeping 0.3 seconds
PING google.com (173.194.123.103): 56 data bytes
64 bytes from 173.194.123.103: icmp_seq=0 ttl=55 time=56.549 ms
64 bytes from 173.194.123.103: icmp_seq=1 ttl=55 time=60.220 ms
64 bytes from 173.194.123.103: icmp_seq=2 ttl=55 time=8.872 ms
Before retry #2: sleeping 0.6 seconds
PING google.com (173.194.123.103): 56 data bytes
64 bytes from 173.194.123.103: icmp_seq=0 ttl=55 time=25.819 ms
64 bytes from 173.194.123.103: icmp_seq=1 ttl=55 time=16.382 ms
64 bytes from 173.194.123.103: icmp_seq=2 ttl=55 time=3.224 ms
Before retry #3: sleeping 1.2 seconds
PING google.com (173.194.123.103): 56 data bytes
64 bytes from 173.194.123.103: icmp_seq=0 ttl=55 time=58.438 ms
64 bytes from 173.194.123.103: icmp_seq=1 ttl=55 time=94.828 ms
64 bytes from 173.194.123.103: icmp_seq=2 ttl=55 time=61.075 ms
Before retry #4: sleeping 2.4 seconds
PING google.com (173.194.123.103): 56 data bytes
64 bytes from 173.194.123.103: icmp_seq=0 ttl=55 time=43.361 ms
64 bytes from 173.194.123.103: icmp_seq=1 ttl=55 time=32.171 ms
... 
```

检查最终通过/失败的退出状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-15T10:25:11.943

对于任何想要真正等到一段时间过去的人来说，考虑到你的命令时间可能很重要：

```
TIMEOUT_SEC=180
start_time="$(date -u +%s)"
while [ condition_or_just_true ]; do
  current_time="$(date -u +%s)"
  elapsed_seconds=$(($current_time-$start_time))
  if [ $elapsed_seconds -gt $TIMEOUT_SEC ]; then
    echo "timeout of $TIMEOUT_SEC sec"
    exit 1
  fi
  echo "another attempt (elapsed $elapsed_seconds sec)"
  some_command_and_maybe_sleep
done 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-10-16T05:09:50.353

[我对这个](https://stackoverflow.com/a/12321815/1054322)答案进行了一些调整，让您可以切换是否达到超时，或者命令是否成功。此外，在此版本中，每秒重试一次：

```
ELAPSED=0
started=$(mktemp)
echo "False" > $started
until the_command_here && echo "True" > $started || [ $ELAPSED -eq 30 ]
do
   sleep 1
   (( ELAPSED++ ))
done

if [[ $(cat $started) == "True" ]]                                                                                                                                                                                                                            
then                                                                                                                    
    echo "the command completed after $ELAPSED seconds"                                                                                              
else                                                                                                                    
    echo "timed out after $ELAPSED seconds"                                                                               
    exit 111                                                                                                            
fi 
```

# iphone - UITableViewCell 制作电话号码样式

> ID：12321472
> 
> 赞同：0
> 
> 时间：2012-09-07T15:50:00.283
> 
> 标签：iphone, ios, uitableview

在 iPhone 联系人 tableview 中有一个名为“电话”的单元格，当用户编辑此手机号码时，会变成这样：(251) 575-3621。我怎样才能制作这种细胞类型？

谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T18:09:14.040

```
- (BOOL)textField:(UITextField *)textField 
shouldChangeCharactersInRange:(NSRange)range 
replacementString:(NSString *)string {

NSUInteger currentLength = textField.text.length;

NSCharacterSet *numbers = [NSCharacterSet decimalDigitCharacterSet];

if (range.length == 1) {
    return YES;
}

if ([numbers characterIsMember:[string characterAtIndex:0]]) {

    if ( currentLength == 3 ) 
    {

        if (range.length != 1) 
        {

            NSString *firstThreeDigits = [textField.text substringWithRange:NSMakeRange(0, 3)];

            NSString *updatedText;

            if ([string isEqualToString:@"-"]) 
            {
                updatedText = [NSString stringWithFormat:@"%@",firstThreeDigits];
            }

            else 
            {
                updatedText = [NSString stringWithFormat:@"%@-",firstThreeDigits];
            }

            [textField setText:updatedText];
        }           
    }

    else if ( currentLength > 3 && currentLength < 8 ) 
    {

        if ( range.length != 1 ) 
        {

            NSString *firstThree = [textField.text substringWithRange:NSMakeRange(0, 3)];
            NSString *dash = [textField.text substringWithRange:NSMakeRange(3, 1)];

            NSUInteger newLenght = range.location - 4;

            NSString *nextDigits = [textField.text substringWithRange:NSMakeRange(4, newLenght)];

            NSString *updatedText = [NSString stringWithFormat:@"%@%@%@",firstThree,dash,nextDigits];

            [textField setText:updatedText];

        }

    }

    else if ( currentLength == 8 ) 
    {

        if ( range.length != 1 ) 
        {
            NSString *areaCode = [textField.text substringWithRange:NSMakeRange(0, 3)];

            NSString *firstThree = [textField.text substringWithRange:NSMakeRange(4, 3)];

            NSString *nextDigit = [textField.text substringWithRange:NSMakeRange(7, 1)];

            [textField setText:[NSString stringWithFormat:@"(%@) %@-%@",areaCode,firstThree,nextDigit]];
        }

    }
}

else {
    return NO;
}

return YES;
} 
```

# selenium - Selenium 2 - 从下拉列表中获取选定的选项

> ID：12321483
> 
> 赞同：0
> 
> 时间：2012-09-07T15:50:34.340
> 
> 标签：selenium, selenium-webdriver

```
<select class="selectCity">
<option></option>
<option value="Paris">Paris</option>
<option>New York</option>
<option>London</option>
</select>

    Select op1 = new Select(driver.findElement(By.xpath("(//*[@id='cityTable']//*[contains(@class,'selectCity')])")));
    List<WebElement> allSelectedOptions = op1.getAllSelectedOptions();
    WebElement firstSelectedOption = op1.getFirstSelectedOption();
    System.out.println("op1!!!!!"+firstSelectedOption.getText()); 
```

网页上用户选择的选项是伦敦。

把输出是op1！！！！！！

如何在网页上找到已选择的选项？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T10:55:14.223

`Selenium.getSelectedLabel("//string locator");`

上面的代码有助于了解当前选择的女巫选项并从下拉列表中可见。

下拉框的字符串定位器可以是任何东西，例如：-name、id、xpath

例如：`Selenium.getSelectedLabel("name=productIdxSel");`

# javascript - 使用主题标签

> ID：12321487
> 
> 赞同：0
> 
> 时间：2012-09-07T15:50:50.470
> 
> 标签：javascript, jquery, url, tags, hashtag

让我们认为我们的 URL 看起来像

www.domain.com **#CourseID#LessonID**

我想要做的是，当：

*   `CourseDivButton`如果当前 url 点击
    *   没有主题标签（www.domain.com），然后添加`$(this).data("id")`为主题标签（www.domain.com **#CourseID**）
    *   仅包含第一个主题标签 - `CourseID`(www.domain.com **#CourseID** ) 然后更改它 (www.domain.com **#NEWCourseID** )
    *   包含 2 个主题标签 -`CourseID`和`LessonID`(www.domain.com **#CourseID#LessonID** ) 然后删除第二个并先更改 (www.domain.com **#NEWCourseID** )
*   `LessonDivButton`如果当前 url 点击
    *   仅包含第一个主题标签 - `CourseID`(www.domain.com **#CourseID** ) 然后添加第二个 (www.domain.com **#CourseID#LessonID** )
    *   包含 2 个主题标签 -`CourseID`和`LessonID`(www.domain.com **#CourseID#LessonID** ) 然后更改第二个并保持原样 (www.domain.com **#CourseID#NEWLessonID** )

我的代码现在如下所示。无法弄清楚如何实现我想要的。

```
CourseDivButton.click(function(){
    var id=$(this).data("id");
    LoadLessons(id);
    window.location.hash = id;
});

LessonDivButton.live("click", function(){
    var id=$(this).data("id");
    LoadQuestions(id);
    window.location.hash = id;
}); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:50:32.930

您不能使用查询字符串而不是使用主题标签吗？我建议你像这样添加它们：

www.domain.com?course= **CourseID** &lesson= **LessonID**

使用下面的 javascript 函数，您可以从 URL 中获取变量，如下所示：

```
var courseID = urlParam('course');
var lessonID = urlParam('lesson');

function urlParam(name) {
    /// <summary>
    /// Gets the value of a parameter located within the url.
    /// </summary>
    /// <param name="name">The paramter to lookup.</param>
    /// <returns type="string">The value of the requested parameter, or undefined if the parameter is not present.</returns>
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.href);
    if (results == null)
        return undefined;
    else
        return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

如果您需要构建一个添加了查询字符串的新 URL，[请查看此](https://stackoverflow.com/a/487049/1654818)内容。

# git - 使用 Git Bash 删除远程文件

> ID：12321489
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:51:04.837
> 
> 标签：git, command-line

我正在使用带有 PHPFog 的 Git bash。在我的本地计算机上，我使用 Windows 资源管理器删除了一个 PHP 文件，我想从服务器中删除同一个文件，也许我与服务器创建了一个不同步的问题，不确定。

但是话虽如此，我如何从服务器中删除文件？

下面是到远程服务器的连接字符串：

```
git@git01.phpfog.com:MY_HOST_GOES_HERE.phpfogapp.com 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:55:12.307

您将要使用以下内容：

```
git rm --cached file_name_here.php (or other extension)
git commit -m "Removed [filename] for [reason]"
git push 
```

这将从远程服务器上的存储库中完全删除它。

# c# - 如何使用word interop判断两个word文档是否相同

> ID：12321490
> 
> 赞同：2
> 
> 时间：2012-09-07T15:51:14.703
> 
> 标签：c#, com, office-interop

有没有使用 interop 这个词来查看两个文档是否相同的好方法？

我试过使用类似的东西：

```
Word.Document tempDoc = app.CompareDocuments(document1, document2); 
```

我的问题是 tempDoc 如果它们相同则不为空，因此我不确定如何使用此结果来确定文档是否相同。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T16:03:17.153

它返回的文档是打开了跟踪更改的文档。所以你所要做的就是看看是否有任何变化。所以：

```
Document tempDoc = app.CompareDocuments(doc1, doc2);
bool anyChanges = tempDoc.Revisions.Count > 0; 
```

看：

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word._application.comparedocuments.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word._application.comparedocuments.aspx)

# macos - htaccess 重定向本地主机

> ID：12321491
> 
> 赞同：0
> 
> 时间：2012-09-07T15:51:16.383
> 
> 标签：macos, .htaccess, redirect

我有

```
<link href="/smarter-computing/us/en/sc-mobile.css" type="text/css"/>
<script src="/smarter-computing/js/sc-common.js?fileversion-r21" type="text/javascript">//</script> 
```

当我在本地处理这些文件时，我必须`//localhost/~vc/`在 JS 和 CSS 文件的路径之前保留 append 。我不想为以下和`<img>`我的代码中的每个链接继续复制/粘贴此路径。
如何使用 htaccess 重定向所有 url 指向`//localhost/smarter-computing/`或在我的路径之前`/smarter-computing/`附加此路径。`//localhost/~vc/``/smarter-computing`

谢谢，

维什瓦斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:20:50.387

您可以在 localhost 的 apache 配置中将文档根设为您的主目录，或者将其添加到页面的标题中：

```
<base href="/~vc/"> 
```

# objective-c - 导入 Box2D：找不到文件

> ID：12321494
> 
> 赞同：0
> 
> 时间：2012-09-07T15:51:22.193
> 
> 标签：objective-c, ios, xcode, include, box2d

我正在尝试导入 Box2D 库，但出现编译错误：找不到“Box2D/Box2D.h”文件。

我尝试了很多方法来解决这个问题，但没有任何成功。我没有使用 cocos2d，所以我没有任何模板。我只是在我的 Xcode 项目中拖放 Box2D 文件夹（尝试检查和取消选中“复制到目标文件夹”）。

试图检查“始终搜索用户路径”等...没有成功。

如果有人有解决方案：上帝保佑你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:55:33.750

只需将 Box2D.h/Bow2D.h 拖放到您的项目中。如果不是那么简单，我可以向您推荐本[教程](http://www.iforce2d.net/b2dtut/setup-ios)，该教程解释了在 XCode 中设置 Box 2D 所需了解的所有内容。

**编辑**

我刚刚在我引用的 tut 中尝试了这个项目，我相信你没有设置你的标题搜索路径。Box2D 文件旨在像这样包含：#include 因此您需要转到**Build Settings然后为****Header Search Paths**的 Debug 和 Release 键添加一个条目（在**Build Settings**下）

你看起来像这样：`Debug Box2D_v2.1.2/Box2D`

# php - 仅使用 PHP 进行 PHP/MySQL 性能测试

> ID：12321498
> 
> 赞同：2
> 
> 时间：2012-09-07T15:51:41.733
> 
> 标签：php, mysql, performance, apache2, webserver

我正在尝试诊断网站加载速度非常慢的服务器，但不幸的是我的客户端只为我提供了 FTP 访问权限。

我有 FTP 访问权限，所以我可以上传 PHP 脚本，但不能设置任何其他服务器端工具。

我可以访问 phpMyAdmin，但不能直接访问 MySQL 服务器。不幸的是，它也是一个 Windows 服务器（我们已经成为 Linux 商店十多年了）。

那么，如果我想在通用服务器上通过 PHP 评估 MySQL 和磁盘速度性能，那么最好的方法是什么？

已经有类似的工具： [https://github.com/raphaelm/php-benchmark](https://github.com/raphaelm/php-benchmark)或[https://github.com/InfinitySoft/php-benchmark](https://github.com/InfinitySoft/php-benchmark)

但令我惊讶的是，没有人已经设置和配置为只是运行并对服务器的响应能力进行一些基本测试。

每次我们评估一个新的服务器环境时，能够快速将其与现有的环境进行比较以查看是否存在任何异常情况是很方便的。我想我只是希望其他人已经编写了一个脚本来执行此操作。我知道我有，但那是在 Github 之前，当时有一个方便的地方可以发布这样的代码片段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T08:46:47.807

您可能已经这样做了，但以防万一……如果我站在您的立场，我首先要看的是 mysql 表上的索引和应用程序中的查询。我已经看到一些站点通过修复连接或添加丢失的索引来获得巨大的速度提升。

不要忘记检查代码是否存在性能问题或调用 sleep()。如果您还没有，让代码在本地运行可能会有所帮助，这样您就可以通过 xdebug 运行它。

# regex - 正则表达式 - 在带有新行的字符串之间搜索

> ID：12321499
> 
> 赞同：0
> 
> 时间：2012-09-07T15:51:43.373
> 
> 标签：regex

前提条件：

```
[numbers]
[vip]111,222[vip]
[standard]333[standard]
[numbers] 
```

我想要什么：找到[数字]之间的所有内容问题：当此文本在一行中时，解决方案很简单

```
(?<=\[numbers\])(.*?)(?=\[numbers\]) 
```

但是可以在前提条件中搜索新行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:00:01.367

在大多数正则表达式变体中，点 (.) 代表在线上的任何内容。

您可以使用“任何东西”的表达式来扫描行尾，例如：

(?<=\[numbers\]) ([\d\D]*?) (?=\[numbers\])

因为 [\d\D] 代表“任何是数字的东西，或者任何不是数字的东西”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:33:03.013

对于所提出的问题，您实际上并不需要正则表达式，`awk`只需设置记录分隔符即可：

```
 awk 1 RS='\\[numbers\\]\n' ORS='' 
```

输出：

```
[vip]111,222[vip]
[standard]333[standard] 
```

# android - 在 sdcard 上保存图像时权限被拒绝

> ID：12321503
> 
> 赞同：0
> 
> 时间：2012-09-07T15:51:51.330
> 
> 标签：android, file, permissions, sd-card

此功能用于将图像保存在 sdcard 上（我仅在模拟器上测试过）：

```
public String SaveImage(String URL,String imagename){

        Bitmap bitmap = null;
        InputStream in = null;
        String path = Environment.getExternalStorageDirectory().toString();
        File dir = new File(path + "/bh");
        if(!dir.exists())
             new File(path + "/bh").mkdir();
        Log.i("in save()", "after file");
        File mImageFile = new File(path+"/bh/"+imagename);

        if(mImageFile.exists())
            Toast.makeText(mContext, "Saved", Toast.LENGTH_LONG).show();

        try{
            in = OpenHttpConnection(URL);
            bitmap = BitmapFactory.decodeStream(in);
            FileOutputStream out = new FileOutputStream(mImageFile);
            bitmap.compress(CompressFormat.JPEG, 100,out);
            out.flush();
            out.close();
            in.close();
            return imagename+".jpg";
        }catch(IOException ex){
            Log.e("==== Error in saving image ====",ex.getMessage());
            return "";
        }
    } 
```

我添加了如下所需的权限：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="mobile.bh"
    android:versionCode="4"
    android:versionName="1.0.3" >

    <uses-sdk android:minSdkVersion="8" />

    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >
        <activity
            android:name="mobile.bh.activities.BHActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity
            android:name="mobile.bh.activities.RecipesListActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity
            android:name="mobile.bh.activities.RecipeInfoActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity
            android:name="mobile.bh.activities.IngredientsActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity
            android:name="mobile.bh.activities.MethodActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity
            android:name="mobile.bh.activities.SpicesListActivity"
            android:screenOrientation="portrait" >
        </activity>
        <activity android:name=".activities.SpicesCategoriesActivity" >
        </activity>
        <activity android:name=".activities.CategoryActivity" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:04:22.383

由于您要连接到 Internet，因此您还需要使用 Internet 权限。

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:41:08.780

你的模拟器支持 SDCard 吗？

看看这个很好的答案，这可能是问题[https://stackoverflow.com/a/11468278/1635817](https://stackoverflow.com/a/11468278/1635817)

# c# - 如何使用 Linq 从字符串中比较和选择值？

> ID：12321504
> 
> 赞同：0
> 
> 时间：2012-09-07T15:51:59.737
> 
> 标签：c#, linq, collections

上了一节课：

```
 class filedate
 {
      public int id;
      public string fname;
 } 
```

用值填写我的列表：

```
 List<filedate> List = ReadList(sqlFiles);
 string[] FolderFiles = System.IO.Directory.GetFiles(path2Copy); 
```

试图得到结果：

```
 var results = List.Where(filedate =>
        FolderFiles.Any(x=>Path.GetFileNameWithoutExtension(x) ==             
        Path.GetFileNameWithoutExtension(filedate.fname))); 
```

我在 和 中有相同的文件`List`，`FolderFiles`但在`results`. 我是Linq的新手。哪里有问题？

**更新：** 列表：（计数）> 1000 例如：<1023，'tr_F2opervag_2808_1644.dat'>

FolderFiles 示例：“\\domain.corp.dns\share\folder\tr_F2opervag_2808_1644.dat”

**更新2**：发现我的错误！与交叉点的评论很有帮助！此代码有效：

```
 var results = List.Where(
            (filedate x) =>
            {
                return ! FolderFiles.Any(xxx =>
                Path.GetFileNameWithoutExtension(xxx) ==
                Path.GetFileNameWithoutExtension(x.fname));
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:18:02.947

如果您需要找到差异，这应该有效。这可以通过[Enumerable.Except](http://msdn.microsoft.com/en-us/library/bb300779.aspx)获得。

```
var dbFiles = ReadList(sqlFiles);

var dbFilePaths =
    dbFiles.Select(fdate => 
       Path.GetFileNameWithoutExtension(fdate.fname).ToLower());

var fsFilePaths =
    Directory
    .GetFiles(path2Copy)
    .Select(filePath => 
        Path.GetFileNameWithoutExtension(filePath).ToLower());

var diff = 
    dbFilePaths
    .Except(fsFilePaths)
    .Join(dbFiles, 
       filePath => filePath, 
       fdate => fdate.fname, 
      (filePath, fdate) => fdate)
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:19:55.250

你的代码对我来说很好，所以从数据库返回的 List 中的数据格式有问题。

发布`fname`来自 filedata 对象的值的示例。它必须是有效的完全限定路径。

这对我来说很好。

```
public class FileData{
    public int id;
    public string fname;
}
void Main()
{
    List<FileData> list = new List<FileData>{
        new FileData { id=1, fname="C:\\install.res.1042.dll"},
        new FileData { id=2, fname="C:\\install.res.1041.dll" },
        new FileData { id=3, fname="C:\\install.res.9999.dll"}
    };

    string[] FolderFiles = System.IO.Directory.GetFiles("C:\\");

    var results = list
        .Where(fd => 
            FolderFiles.Any(x=>Path.GetFileNameWithoutExtension(x) ==             
            Path.GetFileNameWithoutExtension(fd.fname)));

    Console.WriteLine(results);
} 
```

# cakephp - 如何在 CakePHP 中查找用户是否是对象的粉丝？

> ID：12321508
> 
> 赞同：2
> 
> 时间：2012-09-07T15:52:05.477
> 
> 标签：cakephp, many-to-many, cakephp-2.0, cakephp-model

我的 CakePHP 应用程序中有两个模型：`Company`和`User`. 它们与 HABTM 关系相关联。这会创建一个“喜欢”，因此如果 a`User`链接到 a`Company`则该用户喜欢该公司。

如果查看公司简介页面，如何查看登录用户是否喜欢该公司？我在控制器操作中获取公司详细信息……</p>

```
<?php
class CompaniesController {

    public function view($slug) {
        $company = $this->Company->findBySlug($slug);
        $this->set(array(
            'company' => $company,
            'is_fan' => ($this->Auth->loggedIn()) ? $this->Company->isFan($this->Auth->user('id')) : false
        ));
    }
} 
```

我的想法是`isFan()`在我的模型中有一个方法`Company`——正如你在上面看到的——它将用户 ID 作为参数。但我对我在这种方法中实际投入的内容感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:57:53.937

```
class Company

    public function isFan($userId, $companyId) {

        $found = $this->Company->CompanyUsers->find('first', array(
            'conditions'=>array(
                'CompanyUsers.user_id'=>$userId,
                'CompanyUsers.company_id'=>$companyId
            )
        );

        return $found != false;

     }

} 
```

基本上，您查询 HABTM 连接表以确定连接是否存在。

# jquery - 切换案例与条件？

> ID：12321510
> 
> 赞同：0
> 
> 时间：2012-09-07T15:52:11.497
> 
> 标签：jquery, conditional, switch-statement

我找到了这篇文章：[Switch case with three parameters?](https://stackoverflow.com/questions/1328467/switch-case-with-three-parameters) 我正在考虑使用 switch case 传递多个参数，如下所示：

```
switch (array($var1, $var2, $var3)) {
case array(true, false, false):
    echo "hello";
    break;
} 
```

关于这是否是最有效的方法似乎存在一些问题。情绪似乎是 if 条件更合适。但是，当我看到我正在写的条件时，我不确定？例如，这感觉很乱（请注意，我已经删除了大约 6 个其他条件，以免让您感到无聊）：

```
if ( 
  csz == "google" || 
  csz == "bing" || 
  csz == "yahoo" || 
  csz == "dogpile" || 
  csz == "millionshort" && 
  cs == '' ) { 
    $("li.phone").replaceWith('<li class="phone">' + phoneNaturalSearch + '</li>');
}
else if ( 
  csz == "facebook" && 
  cs == '' ) { 
    $("li.phone").replaceWith('<li class="phone">' + phoneFacebook + '</li>');
}
else if ( 
  csz == "google-plus" || 
  csz == "plus" ) { 
    $("li.phone").replaceWith('<li class="phone">' + phoneGooglePlus + '</li>');
}
// Snipped out other conditionals
else { 
    $("li.phone").replaceWith('<li class="phone">' + phoneDefault + '</li>');
} 
```

在这里使用多个参数进行切换会更有效，还是会遇到性能下降？我想我应该编写代码，看看它是否真的不那么混乱，但我想我会先把它从大师那里反弹。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:17:32.007

我觉得如果你有这么多条件，我更喜欢使用 switch 语句，这使你的代码更清晰，更容易理解。你可以省略掉属于这个特定类别的条件的 break ......

```
var phoneType= '';

switch(csz){ 
  case "google" : 
  case  "bing" : 
  case "yahoo" :
  case "dogpile"  : 
  case "millionshort" : 
    if (cs==''){ 
        phoneType = phoneNaturalSearch ;
        break;
    }
    else {
        goto case "facebook";
    }
  case "facebook" :
    if (cs==''){ 
        phoneType = phoneFacebook  ;
        break;
    }
    else {
        goto case "google-plus";
    }
  case "google-plus" :
  case "plus"  : 
    phoneType = phoneGooglePlus ;
    break;
  default : 
    phoneType = phoneDefault  ;
    break;
}

$("li.phone").replaceWith('<li class="phone">' + phoneType + '</li>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T18:50:34.830

谈到更整洁的解决方案，另一种方法是将它们保存在二维数组中并检索元素索引。

看一下这个 ：

```
var csz= 'amazon';

var groups = [['google','yahoo','bing'],['facebook','orkut','hi5','zurker'],['amazon','bestbuy','sears']];
var groupIndex = getIndexOf(groups,csz);
if(groupIndex ==1){
    //code here
    alert("1");
}else if(groupIndex ==2){
    //code here
    alert("2");
}else if(groupIndex ==3){
    //code here
    alert("3");
}

function getIndexOf(myArray,element){
    for(var i=0;i<groups.length;i++){
        for(var j=0;j<groups[i].length;j++){
            if(myArray[i][j]==element){
                return i;  
            }
        }
    }        
    return -1;
} 
```

# jquery - 在jquery中的点击事件上获取段落中的当前单词

> ID：12321511
> 
> 赞同：5
> 
> 时间：2012-09-07T15:52:11.113
> 
> 标签：jquery, word

我正在尝试构建一个允许人们获取单词或短语（在选择时）的工具，选择部分已完成，但单词部分未完成。

当有人点击一个单词时，我需要能够获取当前单词，我找到了这个解决方案

[在段落中点击单词](https://stackoverflow.com/questions/4643432/get-word-click-in-paragraphs)

不幸的是，这段代码更改了所有单词并`<span>`为每个单词添加了一个，这导致了我这边的一个问题，因为我无法在文本中添加 html 标记（css 文件可以动态导入或添加）

如果可能的话，有没有更好的方法来实现这一点？

前任：

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Donec 拍卖前坐在 amet nisl consequat volutpat。

如果我点击“坐”，我会提醒“坐”

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-07T16:24:22.353

好吧，对于您的解决方案，您将需要使用`selections`和`doubleclick`事件作为一件棘手的事情，并通过双击事件在生成的范围内获取选定的单词。

*如果您不想引入新标签，则没有其他方法。*

* * *

尝试这个：

**现场演示：http:** [//jsfiddle.net/oscarj24/5D4d3/](http://jsfiddle.net/oscarj24/5D4d3/)

```
$(document).ready(function() {

    /* set hand cursor to let know the user that this area is clickable */
    var p = $('p');
    p.css({ cursor: 'pointer' });

    /* doubleclick event working with ranges */
    p.dblclick(function(e) {
        var selection = window.getSelection() || document.getSelection() || document.selection.createRange();
        var word = $.trim(selection.toString());
        if(word != '') {
            alert(word);
        }
        /* use this if firefox: selection.collapse(selection.anchorNode, selection.anchorOffset); */
        selection.collapse();
        e.stopPropagation();
    });

});​ 
```

希望这可以帮助 ：-）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-28T17:37:47.090

[Oscar Jara 的回答](https://stackoverflow.com/a/12321960/5025060)（上图）说，*如果您不想引入新标签，**则没有其他方法*[返回点击的词] 。 这在 2012 年可能是真的，但目前我们有[getSelection](https://developer.mozilla.org/en-US/docs/Web/API/DocumentOrShadowRoot/getSelection)：

 *> DocumentOrShadowRoot 接口的 getSelection() 属性返回一个 Selection 对象，表示用户选择的文本范围，或插入符号的当前位置。

我在 Windows Chrome 63.0.3239.84 和 Windows Firefox 56.0 下工作。要使用其他浏览器对其进行测试，请使用此[jsfiddle 示例](http://jsfiddle.net/Vap7C/1/)进行测试

```
 window.getSelection(); 
```

涉及 getSelection 的相关 SO 问题：

[一键获取单词](https://stackoverflow.com/q/8499865/5025060)

[检测文本中点击了哪个单词](https://stackoverflow.com/q/7563169/5025060)

[返回出现点击单词的句子](https://stackoverflow.com/q/16150780/5025060)*

# mfc - CDialog DoModal（对话框以键盘焦点打开，但不是鼠标焦点）

> ID：12321518
> 
> 赞同：1
> 
> 时间：2012-09-07T15:52:35.407
> 
> 标签：mfc, focus, mouse, cdialog, cricheditctrl

我有一个包含 CRichEditCtrl 控件的 CDialog 窗口 (CDrafter)。

我重写了 CDrafter::PreTranslateMessage 和 CDrafter::OnNotify 以允许我用鼠标单击 RichTextEdit 中的特殊单词，这又打开另一个对话框 (MyDialog)。

*注意：我这样做是因为我不喜欢 EN_LINK 样式的限制。*

**所以在 CDrafter::PreTranslateMessage 我有：**

它只是确定单击的位置和单词（仅此而已）（等待 OnNotify 对其进行处理）。

**所以在 CDrafter::OnNotify 我有：**

```
BOOL CSTANAGMessageDrafterDlg::OnNotify( WPARAM wParam, LPARAM lParam, LRESULT* pResult    )
{
    BOOL r = CDialog::OnNotify(wParam, lParam, pResult);

    //if (::PreTranslateMessage found a word clicked on ) {
    MyDialog dialog;
    dialog.DoModal();

    //}

    //Awesome my dialog opened and I can start editing the form (via the keyboard) no problems.
    //BUG: There is a problem as the mouse curser is still showing the 
    // move carpet position icon as if it is still focused on the RichTextEdit control.
    // If I click the mouse anywhere (in the MyDialog, or within the parent dialog)
    // the mouse icon, and focus correctly changes to MyDialog, then I can click OK or CANCEL. 

  return r;
} 
```

我已经尝试在 MyDialog::DoModal 之后调用“CDialog::OnNotify(wParam, lParam, pResult)” - 仍然看到同样的问题。MyDialog::DoModal 在与父对话框相同的线程中被调用。

我希望能够做到以下几点：

单击单词，MyDialog 打开，单击 MyDialog::Cancel 按钮，对话框关闭。

但是有一个问题，因为这是我的序列：

单击单词，打开 MyDialog，**单击 MyDialog::Cancel 按钮（不起作用 - 仅更改鼠标图标）**，单击 MyDialog::Cancel 按钮，对话框关闭

我需要（最初单击）鼠标才能在新打开的对话框中获得任何鼠标控制。即按钮等上的鼠标悬停事件在我（单击）之前什么都不做。

# ruby-on-rails - 没有路线匹配 [GET] "/signout"

> ID：12321519
> 
> 赞同：6
> 
> 时间：2012-09-07T15:52:40.040
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

我看到了一些与该主题相关的帖子，但给定的解决方案并没有真正为我澄清事情......

因此，我正在开发一个 Rails（版本 3.2.2）应用程序，该应用程序遵循 Michael Hartl 的 Ruby on Rails 教程中的设置。该应用程序有一个注销链接，直到最近它开始给我错误'没有路由匹配[GET]“/signout”'时运行良好。

这些是相关的部分：

**路线.rb**

```
match '/signout' => 'sessions#destroy', :via => :delete 
```

**session_controller.rb**

```
def destroy
  sign_out
  redirect_to root_path
end 
```

**session_helper.rb**

```
def sign_out
  current_user = nil
  cookies.delete(:remember_token)
end 
```

**_header.html.erb**

```
<li>
  <%= link_to "Sign out", signout_path, :method => :delete %>
</li> 
```

注销重新开始工作所需要的只是从路由文件中删除 ":via => :delete"。这是正确的方法还是有更好的方法？另外，为什么没有任何 Rails 更新，链接就停止工作了？

谢谢你，亚历山德拉

根据要求，我添加了 _header.html.erb 的完整代码：

**完整的_header.html.erb**

```
<!-- ***** Initialized: Listing 5.24 ***** -->
<!-- ***** Updated: Listing 8.24 ***** -->
<!-- ***** Updated: Listing 9.7 ***** -->
<!-- ***** Begin: Listing 9.28 ***** -->
<header>
<header class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <% if signed_in? %>
        <%= link_to "project manager", about_path, id: "logo" %>
      <% else %>
        <%= link_to "project manager", root_path, id: "logo" %>
      <% end %>
      <nav>
        <ul class="nav pull-right">
          <!--li><%= link_to "Home", root_path %></li-->
          <% if signed_in? %>

<% if Rails.env.development? %>
            <li><%= link_to "Overview", overview_path %></li> 
<% end %>         
<% if Rails.env.development? %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Projects <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
              <li><%= link_to "Status", projects_path %></li>
              <li><%= link_to "Dev View", dev_projects_path %></li>
              </ul>
            </li>
<% else %>
          <li><%= link_to "Projects", projects_path %></li>
<% end %>
<% if Rails.env.development? %>
            <li><%= link_to "Teams", teams_path %></li> 
<% end %>
<% if Rails.env.development? %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Tasks <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
              <li><%= link_to "Status", tasks_status_path %></li>
              <li><%= link_to "Tree", tasks_tree_path %></li>
              <li><%= link_to "Dev View", dev_tasks_path %></li>
              </ul>
            </li>
<% else %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Tasks <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
              <li><%= link_to "Status View", tasks_status_path %></li>
              <li><%= link_to "Tree View", tasks_tree_path %></li>
              </ul>
            </li>
<% end %>

<% if Rails.env.development? %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Reports <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
              <li><%= link_to "Project Progress", analysis_path %></li>
              <li><%= link_to "Revision History", history_path %></li>
              </ul>
            </li>              
<% else %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Reports <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
              <li><%= link_to "Revision History", history_path %></li>
              </ul>
            </li>
<% end %>
<% if Rails.env.development? %>
            <li><%= link_to "Help", help_path %></li>
<% end %>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Account <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
<% if current_user.admin? %>
                <li><%= link_to "Admin", users_path %></li> 
<% end %>
<% if Rails.env.development? %>
                <li><%= link_to "Profile", current_user %></li>
<% end %>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Sign out", signout_path, :method => :delete %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Sign in", signin_path %></li>
          <% end %>
        </ul>
      </nav>
    </div>
  </div>
</header>
<!-- ***** End: Listing 9.28 ***** --> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-06T10:35:15.330

这个线程有点旧，但我想我还是会分享一个解决方案，因为更多的人可能会遇到同样的问题。

在我们进行实际故障排除之前，以下是有关其工作原理的一些背景信息：

请注意，退出链接如下所示：

```
<%= link_to "Sign out", signout_path, :method "delete" %> 
```

如果您查看此标记生成的源代码，您将看到：

```
<a href="/signout" data-method="delete" rel="nofollow">Sign out</a> 
```

注意说的部分`data-method="delete"`。使用直接的 HTML，这是行不通的。如果您单击该链接，您的浏览器将简单地忽略 DELETE 指令，而是向您的服务器提交一个 GET 请求（这是您当前在日志中看到的内容）。要让您的浏览器提交 DELETE 请求，您需要使用一些 JavaScript 魔法。这是 jquery_ujs.js 文件的来源（您很可能通过在浏览器中查看源代码可以看到指向该文件的链接；它应该在标题中，靠近或包含在 application.js 文件中） . 如果您查看 jquery_ujs.js 文件的内部，朝向文件的中间，您将看到以下代码：

```
// Handles "data-method" on links such as:
// <a href="/users/5" data-method="delete" rel="nofollow" data-confirm="Are you sure?">Delete</a> 
```

换句话说，上面的代码确保您的浏览器确实提交了一个 DELETE 请求（我们不必在这里深入了解实际代码的细节）。

鉴于此背景信息，您收到错误的原因可能有两个。

1.  您只是缺少 jquery_ujs.js 文件

2.  您编写或包含的其他 JavaScript 代码干扰了 jquery_ujs.js 文件的所需行为

要进行故障排除，请执行以下操作：

1.  对于 1) 加载包含退出链接的页面，然后从浏览器中选择查看源代码。确保文件 jquery_ujs.js 位于标头中（或与其余 JS 文件连接到 application.js 文件中，具体取决于您的应用程序设置）

2.  对于 2) 在 application.js 中，删除该`//=require_tree .`指令。重新加载您的页面，然后单击退出链接。如果退出链接隐藏在仅适用于安装了 JavaScript 的菜单下，那么只需将退出链接的副本放在页面上其他无需 JavaScript 即可访问的位置。现在尝试点击链接——它应该可以工作。如果您不再收到路由错误，您就知道这是您的问题的原因。解决此问题的最简单方法是重新添加`//=require_tree .`指令，但随后从它们所在的文件夹中删除除 application.js 文件之外的所有 JavaScript 文件，然后在尝试退出链接时一一添加每个文件，直到它不再有效。这将允许您识别麻烦制造者 JavaScript 文件。确定此文件后，请尝试删除所有代码（在此链接应该再次工作），然后重新添加代码片段，直到它不再工作 - 瞧，您现在已经确定了问题的根源！请随时报告它是什么。我的猜测是，它可能是直接错误、`return false;`声明或`stopPropagation();`声明。

希望这会奏效！祝你好运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T19:08:24.947

由于我在 2012 年 9 月收到的答案并没有解决我的问题，因此我最终从路由文件中删除了 ":via => :delete"，这使得注销链接再次起作用。

在阅读了 eriklinde 的答案后，我回到了我的代码，看看他的答案是否有帮助。jquery_ujs.js 文件没有丢失。因此，我开始研究建议的第二个可能原因。然而，当我转到 routes.rb 文件并添加 "via: :delete" 以显示**"match '/signout', :to => 'sessions#destroy', via: :delete"**时，注销功能继续工作没有问题。由于**"via: :delete"与我之前删除的****":via => :delete"**不同，也许这是导致问题的原因？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T05:11:18.020

我遇到了同样的问题，并通过重新排列 application.js 文件中的需求顺序来解决它。我的订单是这样的：

```
//= require jquery_ujs
//= require jquery
//= require bootstrap
//= require_tree . 
```

现在像这样订购

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

我真的什么也没做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T15:57:51.510

我认为解决方案在这里： [Rails 3 link_to (:method => :delete) not working](https://stackoverflow.com/questions/4342083/rails-3-link-to-method-delete-not-working)

您的页面中是否缺少 <%= javascript_include_tag :all %> ？它应该在您的布局文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T16:02:33.400

尝试将 _header.html.erb 部分更改为

```
<li> 
  <%= link_to "Sign out", signout_path, :method "delete" %> 
</li> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T16:31:49.517

实际上，您可能缺少跨站点防伪标签。这可以解释无法通过 delete 方法删除。不知道为什么它以前工作。

将此添加到头部部分的布局文件中

火腿肠

```
= csrf_meta_tags 
```

对于erb

```
<%= csrf_meta_tags %> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-07T18:21:28.530

我的猜测是你没有安装/激活 jQuery UJS。

[此处](https://github.com/rails/jquery-ujs)列出的关键功能之一是“从超链接发出非 GET 请求”。尝试添加`gem 'jquery-rails'`到您的 gemfile，从命令行运行`bundle install`，重新启动您的服务器，看看它是否有效！

这应该在您的 application.js 文件中（上面没有不以 //! 开头的行）

```
//= require jquery
//= require jquery_ujs 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-04T18:49:58.333

尝试这个 ：

**只需添加到您的 application.js**

```
//= require jquery_ujs 
```

# asp.net-mvc - ASP.NET MVC 3 绑定不成功

> ID：12321525
> 
> 赞同：0
> 
> 时间：2012-09-07T15:53:36.407
> 
> 标签：asp.net-mvc

我无法让我的 ASP.NET MVC 3 视图将数据绑定回模型。

典型对象如`string ContactName`和`string Title`正在成功发送回来。

但是，由于某种原因，我的`public List<KeyValuePair<string, ListingTranslation>> ExpirimentToRemove`对象没有被退回。

以下是未成功绑定的特定对象的代码。

```
<div>
     <ul class="nav nav-tabs">
        @for (int i = 0; i < Model.ExpirimentToRemove.Count; i++)
        {
           <li class="@i == 0 ? 'active' : ''"><a href="#@Model.Translations.Keys.ToList()[i]" data-toggle="tab">@Model.Translations.Keys.ToList()[i]</a></li>
        }
     </ul>
     <div class="tab-content" style="overflow: visible;">
         @for (int i = 0; i < Model.ExpirimentToRemove.Count; i++)
         {
             <div class="tab-pane@i == 0 ? ' active' : ''" id="@@Model.Translations.Keys.ToList()[i]">
                @Html.TextBoxFor(m => Model.ExpirimentToRemove[i].Value.Title)
                @Html.TextBoxFor(m => Model.ExpirimentToRemove[i].Value.FullDescription)
                @Html.TextBoxFor(m => Model.ExpirimentToRemove[i].Value.PreviewDescription)
             </div>
          }
      </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T15:56:23.543

要绑定的项目列表的技巧是隐藏字段。

[这](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)是一篇很棒的文章，详细解释了它

例子：

```
<input type="hidden" name="products.Index" value="caliente" />
<input type="text" name="products[caliente].Name" value="Salsa" />
<input type="text" name="products[caliente].Price" value="1.23" /> 
```

唯一的另一种方法是手动操作与给定项目的对象路径对应的元素的名称属性`List<T>`。

# ruby-on-rails - Rails 设计 reset_authentication_token

> ID：12321527
> 
> 赞同：2
> 
> 时间：2012-09-07T15:53:46.097
> 
> 标签：ruby-on-rails, devise

我正在使用打开 token_authenticable 的 Rails 3.2.2 和 Devise 2.0.4，一切正常。现在我想做以下

> 当用户登录或注销时 reset_authentication_token 为用户

为此，我需要覆盖 SessionsController 但我不知道在哪里调用 reset_authentication_token

（注意，我只在用户成功登录或退出时才需要这个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T17:47:38.940

您可以在 ApplicationController 中覆盖 Devise 的 sign_in 助手：

```
def sign_in(resource_or_scope, *args)
  super
  current_user.reset_authentication_token!
end 
```

# asp.net - 使用 VBScript/WMI 配置 ASP.NET 应用程序设置

> ID：12321528
> 
> 赞同：0
> 
> 时间：2012-09-07T15:53:54.997
> 
> 标签：asp.net, vbscript, iis-6, wmi

我有一个用 VBScript 编写的旧网站创建脚本，它使用 WMI 在默认网站上配置许多虚拟目录。我现在需要为 ASP.NET 配置虚拟目录，但我一生都无法弄清楚如何编写此配置的脚本。

我正在尝试设置一些通过虚拟目录属性的“ASP.NET”选项卡访问的参数。特别是，我需要添加一些应用程序设置（键、值对）并设置全球化响应编码。

我在网上看到的任何地方都没有让我能够在 WMI/VBScript 中做到这一点。谁能把我从痛苦中解救出来？

谢谢，艾尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T04:58:11.693

如果您在系统上安装了 .NET 2.0，对于 IIS5.1/IIS6，您可以执行以下操作。
**1.**查询 ASP.NET 是否已安装：
`cscript "%windir%\system32\iisext.vbs" /ListExt`
**2.**如果 'ASP.NET v1.1.4322' 或 'ASP.NET v2.0.50727' 不存在，则安装 ASP.NET (eg for v2.0) 设置它被*“允许”*：
**启用 ASP.NET：** `cscript "%windir%\system32\iisext.vbs" /AddFile "%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe" 1 "ASP.NET v2.0.50727" 1 "ASP.NET v2.0.50727"`

**禁用 ASP.NET：3** `cscript "%windir%\system32\iisext.vbs" /AddFile "%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe" 0 "ASP.NET v2.0.50727" 1 "ASP.NET v2.0.50727"`
**.**创建一个 IIS 对象：`Set oIIS = GetObject("IIS://localhost/W3SVC/1/Root")`
**4** .创建一个虚拟目录对象：`Set oIIS.Create("IISWebVirtualDir",<PackageName>)`
**5.**设置一些虚拟目录设置：参考[http://msdn.microsoft。 com/en-au/library/ms524579(v=vs.90).aspx](http://msdn.microsoft.com/en-au/library/ms524579(v=vs.90).aspx) & [http://msdn.microsoft.com/en-au/library/ms525644(v=vs.90).aspx](http://msdn.microsoft.com/en-au/library/ms525644(v=vs.90).aspx)

另请查看之前的 Stackoverflow 帖子：
[我可以在 IIS 5 中自动创建 .NET Web 应用程序/虚拟目录吗？](https://stackoverflow.com/questions/371207/can-i-automate-creating-a-net-web-application-virtual-directory-in-iis-5)

希望这可以帮助 ;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T03:18:29.417

您可以从 VB 转移到命令行脚本并从 VB 启动它吗？

如何在 IIS7 中从命令行创建虚拟目录： [http ://technet.microsoft.com/en-us/library/cc771804%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/cc771804%28v=ws.10%29.aspx)

IIS6：

[http://ayesamson.com/2010/06/14/create-virtual-directory-in-iis-6-0-via-command-line/](http://ayesamson.com/2010/06/14/create-virtual-directory-in-iis-6-0-via-command-line/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T13:11:02.777

因此，在 IIS6 中没有遇到任何以编程方式设置 ASP.NET 内容的方法，我最终只是在 web.config 文件中写出适当的部分。出于我的有限目的，这没关系，因为 IIS6 通常不会为我的网站创建 web.config，因此我不必担心解析现有文件并将新内容按正确顺序放置。

不理想（甚至没有接近！），但它让我继续前进，因为未来是 IIS7+，我可以在其中做这种事情，我不会再为此失眠了 :-)

感谢所有输入。

铝。

# javascript - 无法序列化在控制器中使用两个参数的帖子

> ID：12321534
> 
> 赞同：2
> 
> 时间：2012-09-07T15:54:06.843
> 
> 标签：javascript, asp.net-mvc-3

我正在尝试将两个参数从 javascript 传递给 mvc 控制器。第一个是模型，第二个是字符串。

这是html：

```
<input type="button" onclick="save(Json.Encode(@Html.Raw(model)), @Html.Raw(object.Id))" /> 
```

这是javascript：

```
function save(model, id) {

      $.ajax({
          url: '@Url.Action("SaveModel", "Test")',
          type: "POST",
          datatype: "json",
          data: { model: model, id: id }
          }
      });

  } 
```

这是控制器：

```
[HttpPost]
    public ActionResult SaveModel(Model model, string id)
    {
        return null;
    } 
```

如果我只传递模型参数`data: { model: model }`，***它就可以工作***。请求的帖子变成了这样：

```
AProperty   value1
AnotherProperty value2
AnArray[0][Property...
AnArray[1][Property...
etc. 
```

但是如果我尝试传入两个参数`data: { model: model, id: id }`，请求的帖子就会变成

```
model[AProperty]    value1
model[AnotherProperty]  value2
model[AnArray][0][Property...
model[AnArray][1][Property...
etc. 
```

当请求到达控制器时，模型对象被实例化，但所有值都变为空。我猜序列化器失败了。

所有帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T13:52:29.013

我的同事解决了。您必须指定内容类型并在模型上进行字符串化，如下所示：

```
$.ajax({
      url: '@Url.Action("SaveModel", "Test")',
      type: "POST",
      contentType: "application/json",
      data: JSON.stringify({ model: model, id: id })
      }
  }); 
```

也许这将在未来对其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:02:13.790

您可以尝试使用这个[JSON 库](http://www.json.org/js.html)并利用`stringify()`

```
$.ajax({
      url: '@Url.Action("SaveModel", "Test")',
      type: "POST",
      datatype: "json",
      data: JSON.stringify({ model: model, id: id })
    }
}); 
```

# mysql - Mysql外键错误150

> ID：12321541
> 
> 赞同：2
> 
> 时间：2012-09-07T15:54:40.520
> 
> 标签：mysql, sql, foreign-keys

```
CREATE TABLE IF NOT EXISTS `questions` (
  `question_id` int(11) NOT NULL AUTO_INCREMENT,
  `createddate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updateddate` timestamp NULL DEFAULT NULL,
  `active_flag` tinyint(4) NOT NULL DEFAULT '0',
  PRIMARY KEY (`question_id`),
  UNIQUE KEY `id_UNIQUE` (`question_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE `alarts` (
  `alart_id` BIGINT(20) unsigned NOT NULL AUTO_INCREMENT,
  `alart_name` varchar(45) NOT NULL,
  `interval` int(10) unsigned NOT NULL,
  `alart_sent_counter` int(10) unsigned NOT NULL,
  `alart_types_id` BIGINT(20) unsigned NOT NULL,
  `contact_group_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`alart_id`),
  FOREIGN KEY (`alart_types_id`) REFERENCES alart_types(`alart_types_id`)
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=utf8; 
```

我想用两个 FOREIGN KEY 像这样创建新表：

```
CREATE TABLE `alart_question_mapping` (
`alart_question_mapping_id` BIGINT(20) unsigned NOT NULL AUTO_INCREMENT,  
`question_id` int(11) NOT NULL,
`alart_id` BIGINT(20) unsigned NOT NULL,
PRIMARY KEY (`alart_question_mapping_id`),
FOREIGN KEY (`question_id`) REFERENCES questions(`question_id`),
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`)
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=utf8; 
```

但我收到错误：错误代码：1005。无法创建表“alart_question_mapping”（错误号：150）

我怎样才能创建这个表？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:04:29.180

我唯一能看到的是你在你的`CREATE TABLE`声明中引用了一个你提供的表中没有的表：

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`) 
```

如果您删除此引用，该表将创建。请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/9a3f3)

编辑#1，根据您的更新，问题是您在最后一个表中引用了错误的字段：

改变这个：

```
CREATE TABLE `alart_question_mapping` (
`alart_question_mapping_id` BIGINT(20) unsigned NOT NULL AUTO_INCREMENT,  
`question_id` int(11) NOT NULL,
`alart_id` BIGINT(20) unsigned NOT NULL,
PRIMARY KEY (`alart_question_mapping_id`),
FOREIGN KEY (`question_id`) REFERENCES questions(`question_id`),
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`)
) 
```

对此：

```
CREATE TABLE `alart_question_mapping` (
`alart_question_mapping_id` BIGINT(20) unsigned NOT NULL AUTO_INCREMENT,  
`question_id` int(11) NOT NULL,
`alart_id` BIGINT(20) unsigned NOT NULL,
PRIMARY KEY (`alart_question_mapping_id`),
FOREIGN KEY (`question_id`) REFERENCES questions(`question_id`),
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_types_id`)
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=utf8; 
```

所以你正在改变这一行：

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`) 
```

对此：

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_types_id`) 
```

如果您要引用`alart_types`表格，那么您将要引用`alart_types_id`不是`alart_id`

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/7d9f4)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:10:30.240

更改声明：

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`) 
```

到

```
FOREIGN KEY (`alart_id`) REFERENCES alarts(`alart_id`) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:05:57.000

它找不到表`alart_types`。

**[来自 MySQL 外键约束](http://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html)**

> 如果您重新创建已删除的表，则它必须具有符合引用它的外键约束的定义。如前所述，**它必须具有正确的列名和类型，并且必须在引用的键上有索引。**如果这些不满足，MySQL 返回错误号 1005 并在错误消息中引用错误 150。

我想你的意思是

```
FOREIGN KEY (`alart_id`) REFERENCES alart(`alart_id`) 
```

代替

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`) 
```

希望这是有道理的。

![在此处输入图像描述](../Images/8f46cf783464c5a3a610792cf60db2b4.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T16:18:53.760

在这个表中

```
CREATE TABLE alart_types ( 
  alart_types_id BIGINT(20) unsigned NOT NULL AUTO_INCREMENT, 
  alarts_types_name varchar(45) NOT NULL,
  PRIMARY KEY (alart_types_id) 
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=utf8; 
```

如果没有对 alarts_types_name 的唯一约束，那么拥有一个自动增量 ID 号并没有真正的意义。如果没有该唯一约束，您几乎肯定会得到一个数据看起来像这样的表。

```
1  Warning
2  Critical
3  Warning
4  Warning 
```

此约束引用了一个不存在的列。

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_id`) 
```

它应该是

```
FOREIGN KEY (`alart_id`) REFERENCES alart_types(`alart_types_id`) 
```

# string - Powershell脚本总结字符串中的每个字符

> ID：12321544
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:54:45.980
> 
> 标签：string, parsing, powershell, character

寻找一种方法来总结字符串中的所有唯一字符，所以如果字符串是：

```
!#*@&$&$&@^$*%(%&# 
```

该脚本将输出

```
1 ! found

2 # found

2 * found

2 @ found

4 & found

3 $ found

1 ^ found 
```

ETC..

我发现了很多操作字符串的方法，但不是这个。任何帮助都会统治！谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T16:00:25.053

将字符串分成单独的字符并将它们分组：

```
PS> '!#@&$&$&@^$%(%&#'.ToCharArray() | Group-Object -NoElement | Sort-Object Count -Descending

Count Name
----- ----
    4 &
    3 $
    2 #
    2 @
    2 %
    1 !
    1 ^
    1 ( 
```

如果将结果保存到变量中，您可以稍后使用数组索引获取第一项（最常见的字符）（感谢@JNK）。

```
PS>  $chars = '!#@&$&$&@^$%(%&#'.ToCharArray() | Group-Object ...   
PS>  $chars[0]

Count Name
----- ----
    4 & 
```

# php - PHP - 喊话框接受 php 标签或 html 标签作为文本而不是代码

> ID：12321545
> 
> 赞同：2
> 
> 时间：2012-09-07T15:54:46.517
> 
> 标签：php

我正在开发一个有喊话框应用程序的网站，

我想要做的是如何接受用户或客人是否正在插入 php 标签作为他/她的消息或喊叫就像你可以在图像上看到的那样..

我正在使用 mysql_real_escape_string 作为来宾名称和消息..

我希望 php 将其视为文本并将其显示为文本而不是标签或代码..

当我输入这样的呼喊时，没有消息出现，就像（来宾：下午 3:34）没有显示消息的呼喊一样，当我检查我的数据库以查看是否插入了呼喊.. 消息列上没有插入数据我的 tb_shoutbox ..

我在 facebook 聊天中尝试过，我输入了一个 php 标签和 html 标签，它接受了那种消息.. 怎么做..

请帮忙..

![喊话箱](../Images/ab8281b197798a0e57ece12078dfdad4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:55:47.117

您需要将某些字符（例如“<”）转换为 HTML 实体。[htmlentities](http://php.net/manual/en/function.htmlentities.php)函数可以这样使用：

> echo htmlentities($guest_comment, ENT_QUOTES, 'utf-8');

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:30:04.540

建立在韦恩惠蒂完全正确的答案和你对他的答案的评论的回答：

[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php)用于使用 MySQL 查询将变量的数据插入 MySQL 数据库，而不用变量的内容破坏查询。

这可以防止人们在您的喊话箱上进行[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

另一方面，当您想阻止人们破坏您的 PHP 脚本时使用[htmlentities （这可能非常令人不快）。](http://php.net/manual/en/function.htmlentities.php)它将您提供的字符串编码为纯 html。就好像它告诉浏览器这个字符串，不管它是什么，都应该显示给用户。没有进行代码解析。

**因此，回答您的问题：**在您的代码中的某处，您有一条 PHP 行来回显来自数据库/文件的消息。您需要修改该行，使其首先使用 htmlentities 对消息进行编码，然后将其显示给用户

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T15:57:12.180

您应该使用[HTMLEntities](http://php.net/manual/en/function.htmlentities.php)以将标签显示为纯文本。

# ios - 使用 OSX 在虚拟机上运行 xcode

> ID：12321548
> 
> 赞同：1
> 
> 时间：2012-09-07T15:54:57.257
> 
> 标签：ios, xcode, macos, virtualbox

我想尝试为 OSX 和 iOS 开发应用程序，只是想看看我能学到什么。问题是我没有Mac，也没有钱买。我想知道是否可以在 virtualBox 上尝试 OSX 并运行 xcode 来开发甚至发布应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:56:39.597

是的，它是，但它是非法的。为什么不直接获取 Linux 发行版，[构建开放工具链](https://github.com/H2CO3/xchain-ios)并为 Cydia 开发？

# java - JDBCTemplate 在调试时返回数据，但在正常操作期间不返回

> ID：12321553
> 
> 赞同：1
> 
> 时间：2012-09-07T15:55:06.987
> 
> 标签：java, spring, jdbctemplate

`SELECT * FROM view_name`在 Web 应用程序中，Spring 的 JdbcTemplate 为一些简单的 sql（ --view_name 是一列的视图）返回一个空列表，其中存在已知数据。

当我将远程 java 应用程序调试器与 eclipse/tomcat 一起使用时，查询会按预期返回结果。

# Java 调用

```
List<String> results = new ArrayList<String>();
results = jdbcTemplate.queryForList("select * from view_name", String.class) 
```

我启用了 Spring 的 jdbc 日志记录（级别 DEBUG），调试或正常运行之间的输出没有区别，除了正常操作不返回结果。我正在寻找任何类型的指针或其他调试技巧来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:19:49.820

简单的解决方案是在查询中添加一个分号（例如`select * from view_name;`）。我猜这种特质更多的是 PostGRES 的功能而不是 Spring。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:07:45.547

您是否使用测试用例运行此查询，并且当您通常通过服务器运行时，您会得到结果？

如果是这种情况，那么我认为您需要查找连接池的 DataSource 配置。

但这是第一次听到这个问题，检查您的数据源配置可能会有所帮助。

# windows - Windows 中的控制台大小是否存在变量？

> ID：12321557
> 
> 赞同：0
> 
> 时间：2012-09-07T15:55:17.967
> 
> 标签：windows, console

Windows 是否有环境变量来指示控制台大小？就像 Unix 有 LINES 和 COLUMNS 一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:08:43.833

我只是用`set`命令快速检查了一下，没有 - 至少在 Windows 7 上没有包含窗口大小的变量。

您可以调用 GetConsoleScreenBufferInfo 来获取有关屏幕缓冲区的一些信息，包括其大小，但由于滚动，这不会是窗口的物理大小。

# reporting-services - 如何在新窗口中添加子报表？

> ID：12321561
> 
> 赞同：6
> 
> 时间：2012-09-07T15:55:40.933
> 
> 标签：reporting-services, charts

我正在开发一个带有图表的 SSRS 2008 R2 RDL。目前，我在这个图表中内置了一个子报表，如果他们点击一个饼图，它会直接进入这个子报表。它当前通过“转到报告”配置为对系列的操作。

但是，我的客户希望它改为打开一个新的浏览器窗口，以便他们仍然可以看到原始图表而无需重新运行我的报告。此外，此子报表需要几个输入参数。我尝试了“转到 URL”操作链接，并在那里输入了 URL。但这不起作用，因为我无法传入我的输入参数。我怎样才能做到这一点？

此子报表采用多个参数。我将其配置为：

```
="javascript:void(window.open('http://evolvdb/Reports/Pages/Report.aspx?ItemPath=%2fIncoming%2fCensus_by_Date_Range2_Subreport&rs:Command=Render&startdate="+Parameters!startdate.Value+"&enddate="+Parameters!enddate.Value+"&region="+Parameters!region.Value+"&state="+Parameters!state.Value+"&office="+Parameters!office.Value+"&status="+Parameters!status.Value+"&program_hyperlink="+Fields!program_code.Value+"&funding_source_param="+Parameters!funding_source.Value+"'))" 
```

但是当我尝试单击此子报告时，它是不可单击的。

我也试过这个，但这超过了 255 个字符数：

```
="javascript:void(window.open('http://evolvdb/Reports/Pages/Report.aspx?ItemPath=%2fIncoming%2fCensus_by_Date_Range2_Subreport&rs:Command=Render&startdate=" & Parameters!startdate.Value & "&enddate=" & Parameters!enddate.Value & "&region=" & Parameters!region.Value & "&state=" & Parameters!state.Value & "&office=" & Parameters!office.Value & "&status=" & Parameters!status.Value & "&program_hyperlink=" & Fields!program_code.Value & "&funding_source_param=" & Parameters!funding_source.Value & "'))" 
```

我也试过这个，但这也不能点击：

```
="javascript:void(window.open('http://evolvdb/Reports/Pages/Report.aspx?ItemPath=%2fIncoming%2fCensus_by_Date_Range2_Subreport&rs:Command=Render
&startdate="+Parameters!startdate.Value+"
&enddate="+Parameters!enddate.Value+"
&region="+Parameters!region.Value+"
&state="+Parameters!state.Value+"
&office="+Parameters!office.Value+"
&status="+Parameters!status.Value+"
&program_hyperlink="+Fields!program_code.Value+"
&funding_source_param="+Parameters!funding_source.Value+"'))" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-12-20T17:35:48.977

我正在查看您尝试的最后一个代码片段，这是我的反馈：

*   报告路径看起来不正确。应该是格式`http://evolvdb/ReportServer/Path/To/Report&Parameters=XX`
*   您不能将 SSRS 中的字符串与`+`并且需要改为使用`&`。

例子：

```
="javascript:void(window.open('http://evolvdb/ReportServer/Incoming%2fCensus_by_Date_Range2_Subreport&rs:Command=Render
&startdate=" & Parameters!startdate.Value & "
&enddate=" & Parameters!enddate.Value & "
&region=" & Parameters!region.Value & "
&state=" & Parameters!state.Value & "
&office=" & Parameters!office.Value & "
&status=" & Parameters!status.Value & "
&program_hyperlink=" & Fields!program_code.Value & "
&funding_source_param=" & Parameters!funding_source.Value & "'))" 
```

我对创建 SSRS 链接的一般建议是使用您的浏览器并从零编程开始。确保您的报表路径正确，然后手动添加参数并确保报表正确接受参数值。一旦你有一个有效的 URL 示例，在你的报告中创建一个文本框，它会输出你正在尝试创建的 URL 字符串。这是一种确保您获得预期输出的简单方法，并且您可以与您在第一步中手动制作的 URL 进行比较。最后，将完成的表达式放入“Go to URL”操作中，您应该很可能拥有一个可以按预期工作的链接。

# date - 使用 zsh 的日期命令

> ID：12321564
> 
> 赞同：12
> 
> 时间：2012-09-07T15:55:54.137
> 
> 标签：date, zsh

我正在尝试使用该`date`命令以格式输出今天的日期`%d.%m.%y-%H:%M:%S`。显然我只是这样做：

```
date +%d.%m.%y-%H:%M:%S 
```

这在 bash 中运行良好，我得到了我期望的输出，但是当我在 zsh 中执行此操作时，我得到了我期望的以 '7m' 为前缀的输出，例如

> 7m07.09.12-16:49:37

代替

> 07.09.12-16:49:37

我也从我的终端收到警报。这是由`%S`for seconds 引起的，因为当我从命令末尾删除它时，我没有得到“7m”（但显然我错过了日期结束后的秒数）。

谁能解释为什么会这样？

编辑：额外信息：我在 OS X 10.8 上并安装了 zsh 4.3.11，oh-my-zsh

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-31T12:28:09.770

一种解决方法是将代码包装在`echo $(...)`. 它产生正确的输出，对我来说是可以接受的。您的原始命令如下所示：

```
echo $(date +%d.%m.%y-%H:%M:%S) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T14:15:59.557

我有同样的问题，可以通过注释掉 .oh-my-zsh/lib/termsupport.zsh 的第 12 行来解决它，如[https://github.com/robbyrussell/oh-my-zsh/issues/521所建议的那样](https://github.com/robbyrussell/oh-my-zsh/issues/521)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-03T06:26:38.847

我确定您已经在某处复制了 CTRL 字符。7m 是复位控制码。编辑时查找 ^[[7m。

如果您只是想要时间，那么 ZSH 有一个不错的 %*

如果您想要日期和时间，请尝试 RPS1='%W %*'

如果你喜欢它，那就把它放在 PS1 或任何你喜欢的地方。

# ruby-on-rails - 具有 CROSS JOIN 的高级 Rails 3 范围

> ID：12321565
> 
> 赞同：1
> 
> 时间：2012-09-07T15:55:55.840
> 
> 标签：ruby-on-rails, join, scope

我想要一个范围，它会返回一个列表（例如）他们有章节的书籍。我找到[了这篇文章](https://stackoverflow.com/questions/8250451/rails3-scope-for-count-of-children-in-has-many-relationship/12252318#12252318)。

它帮助我选择有章节的书籍。但是，如果我想选择那些他们没有章节的人，例如：

```
 class Book
      scope :long, joins(:chapters).
        select('books.id, count(chapters.id) as n_chapters').
        group('books.id').
        having('n_chapters = 0')
    end 
```

这个范围没有给我任何回报。你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:30:32.707

使用`joins`导致与**已经有连接**的所有书籍+章节组合创建关系。这是通过`INNER JOIN`SQL 子句完成的。如果要`OUTER JOIN`创建所有可能的组合（包括书籍+无效章节），则必须进行。

代替

```
joins(:chapters). 
```

和

```
joins('LEFT OUTER JOIN chapters ON books.id=chapters.book_id'). 
```

**但**在这种情况下，请考虑改用`NOT IN`SQL 子句。像这儿：

```
scope :long, lambda { where('id NOT IN (%s)' % Chapter.select(:book_id).to_sql) } 
```

它是相当小/更快且更具可读性/可维护性的结构。

# visual-studio-2010 - C++/CLI 中的 Visual Studio 2010 状态栏

> ID：12321572
> 
> 赞同：0
> 
> 时间：2012-09-07T15:56:38.547
> 
> 标签：visual-studio-2010, loops, c++-cli

在 VS 2010 中，我试图在单击按钮时读取文本文件并将该值设置为状态按钮值。文本文件将始终包含一个数字介于 0 和 100 之间的单行。我正在尝试在 C++/CLI 中执行此操作，因为我熟悉 C++，但这似乎是一个完全不同的语言！这就是我所拥有的，但它会导致 GUI 崩溃。我知道这是循环错误，但我不知道为什么，解决这个问题的最佳（菜鸟）方法是什么？

```
 while (result<100)
    {
            StreamReader ^read=gcnew StreamReader("Status.txt");                    
            String ^x=read->ReadLine();
            read->Close();
            Int32::TryParse(x, result);
            progressBar1->Value= result;    
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T04:45:28.803

你还没有说你是使用 WPF 还是 WinForms 作为你的 GUI，但这个答案同样适用于任何一个。

如果您的 while 在按钮处理程序中循环，则该代码正在 UI 线程上运行。UI 线程还负责重绘 GUI。由于您的按钮方法没有返回，因此它永远不会进入“重绘”代码，并且 UI 只是停止。

您没有提到将这些整数 0 到 100 写入文件的原因。如果它是同一应用程序中的另一个线程，则有更好的方法来在线程之间传达进度。

我建议您用某种`Timer`对象替换该 while 循环。（有适当的类，取决于您使用的是 WPF 还是 WinForms。）将间隔设置为 500 毫秒，在后台任务开始时启动计时器，并在结束时停止计时器。在 timer 方法中，不要有 while 循环，只做一次。

# ios - 通过 QR 码从 iPhone 应用程序启动 Facebook 页面

> ID：12321579
> 
> 赞同：3
> 
> 时间：2012-09-07T15:57:00.423
> 
> 标签：ios, facebook, qr-code

我正在尝试创建一个 QR 码，从应用程序而不是 Android 和 iOS 上的浏览​​器启动 Facebook 页面。

使用 , 创建代码`fb://page/<page id>`在 Android 上完美运行。

这也应该适用于 iOS 的 Facebook 应用程序，但我认为自从 Facebook 最近将他们的应用程序从 HTML5 版本更新为完全原生的 iOS 应用程序后，该功能已经停止工作。它确实打开了 Facebook 应用程序，但没有转到该页面。

自几周前更新该应用程序以来，还有其他人看到过这种情况吗？我必须使用什么字符串来为 iOS 的 Facebook 应用程序创建一个有效的二维码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T01:07:41.727

我们终于想通了。FB 将其更改为 fb://profile/ 而不是“pages”。它适用于两个平台。

# eclipse - Eclipse 中的 plugin.xml 中的 AbstractUIPlugin 错误和缺少选项卡

> ID：12321580
> 
> 赞同：0
> 
> 时间：2012-09-07T15:57:01.410
> 
> 标签：eclipse, plugins

我从 svn 存储库签入了 eclipse/java 插件项目。Eclipse 自动构建代码以显示数百个错误。

![在此处输入图像描述](../Images/6903706d3d50932a389873573b7880ca.png) 似乎 eclipse 没有正确链接到插件库。谷歌搜索在 plugin.xml 中找到我需要依赖项和其他选项卡的[这个站点。](http://agile.csc.ncsu.edu/SEMaterials/tutorials/plugin_dev/)

![在此处输入图像描述](../Images/db4d3d24fc0b172ebfa588948e1393e9.png)

可能有什么问题？我在 Mac OS X 10.7.4 上使用 Indogo(3.7)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:08:09.730

看起来您获得了基本 XML 编辑器而不是 plugin.xml 编辑器。

这可能是由于您没有在新工作区中启用 Eclipse 插件开发环境 (PDE) 造成的。

尝试创建一个新的插件项目（这将启用必要的插件工具），或者转到首选项并启用“正确”功能。由于功能似乎随着版本的不同而变化，所以我总是使用第一种方法，然后删除新项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:16:59.090

我在我的 Mac 上使用了 Indigo (3.7)，但它发生了，所以插件是在 Helios (3.6) 上构建的。当我使用 Helios 运行插件时，我编译的项目没有错误。

似乎某些插件（严重）依赖于版本。

# scope - angularjs：从外部范围访问内部范围

> ID：12321586
> 
> 赞同：4
> 
> 时间：2012-09-07T15:57:26.657
> 
> 标签：scope, angularjs

我正在尝试从 angularjs 应用程序中的子控制器中的父控制器移动位，以免过多地污染主控制器。这是一个简化的小提琴： http: [//jsfiddle.net/terebentina/5RMPV/](http://jsfiddle.net/terebentina/5RMPV/) 因此，当我单击更改按钮时，第三个字母应更改为“X”。最初 item_change() 函数在主控制器内部并且正在执行`$scope.items[idx] = 'X'`，并且工作得很好。但是，由于我将它移到了 ItemCtrl 中，所以我不知道如何为第三个元素访问它。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T16:35:25.287

[将内容移出主控制器的一种方法是在服务或工厂内的控制器之间共享数据并对其进行所有更改（在本文](http://onehungrymind.com/angularjs-sticky-notes-pt-1-architecture/)中有很好的描述）。

这是一个[更新的小提琴](http://jsfiddle.net/Gloopy/nFgL9/)。您只需要将 注入`itemsService`到您想要访问项目数据的任何控制器中。

```
angular.module('test', [])
    .service('itemsService', function(){
        var items = ['A', 'B', 'C', 'D'];

        return{
            getItems: function(){
                return items;
            },
            changeItem: function(index, value){
                items[index] = value;
            }
        }
    })
    .controller('MainCtrl', function($scope, itemsService) {
        $scope.items = itemsService.getItems();       

        $scope.change = function(idx) {
            itemsService.changeItem(idx, 'X');
        }

    }) 
```

# telerik - 如何启用 Telerik Openaccess ORM 加载外部程序集？

> ID：12321587
> 
> 赞同：1
> 
> 时间：2012-09-07T15:57:27.083
> 
> 标签：telerik, telerik-mvc, telerik-open-access

我是 Telerik OpenAccess ORM 的新手，我使用其他程序集，如 CRISII（内部为模板构建）。我成功地将这些与其他 ORM 一起使用，如 SubSonic，但不能与 Telerik 一起使用。这是我的错误：

```
Error    73    Unable to load assembly 'WritingChallenge, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' : Could not load file or assembly 'CRISII, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b589e2deb0b5c884' or one of its dependencies. Operation is not supported. (Exception from HRESULT: 0x80131515)
ExceptionString:
System.SystemException: Unable to load assembly 'WritingChallenge, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' : Could not load file or assembly 'CRISII, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b589e2deb0b5c884' or one of its dependencies. Operation is not supported. (Exception from HRESULT: 0x80131515) ---> System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
   at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
   at System.Reflection.RuntimeModule.GetTypes()
   at System.Reflection.Assembly.GetTypes()
   at Telerik.OpenAccess.Metadata.MetadataAttributesReader.PrepareMetaModelTypes(Assembly assembly)
   --- End of inner exception stack trace ---
   at Telerik.OpenAccess.Metadata.MetadataAttributesReader.PrepareMetaModelTypes(Assembly assembly)
   at Telerik.OpenAccess.Metadata.MetadataAttributesReader.ReadMetaModel(Assembly assembly)
   at Telerik.OpenAccess.Metadata.AttributesMetadataSource.<>c__DisplayClass1.<FromAssembly>b__0()
   at Telerik.OpenAccess.Metadata.AttributesMetadataSource.CreateModel()
   at Telerik.OpenAccess.Metadata.MetadataSource.GetModelCore(MetadataContainer old)
   at Telerik.OpenAccess.Sdk.Enhancer.Enhancer.CrossDomainRunImpl(AssemblyLoader assemblyLoader)
   at Telerik.OpenAccess.Sdk.Enhancer.EnhancerBase.CrossDomainRun()    C:\SVNProjects\WritingChallenge\WritingChallenge\obj\Debug\WritingChallenge.dll    WritingChallenge 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T18:01:46.720

此问题的一个可能原因是您用于域模型的属性映射。您可以尝试[切换到 XML 映射](http://www.telerik.com/help/openaccess-orm/developer-guide-code-generation-xml-mapping.html)并将其用作您的映射方法。

# ruby-on-rails - Ruby Web 应用程序生命周期

> ID：12321590
> 
> 赞同：0
> 
> 时间：2012-09-07T15:57:35.477
> 
> 标签：ruby-on-rails, ruby, sinatra

我对一些我找不到的手册/教程很感兴趣。

Ruby Web 应用程序的生命周期是什么？Ruby 是一种脚本语言。与 PHP 相同。但正如我听说的那样，Ruby 在运行之前是经过预编译的。所以问题是：

*   什么时候预编译完成？
*   预编译如何适用于不同的文件和类？
*   预编译代码的生命周期是多少？
*   路由如何从 apache/nginx 传递到 ruby​​ 应用程序（示例可以基于 sinatra）？
*   也许有一个关于如何制作自己的简单 web 框架的教程，或者没有任何 web 框架但使用纯 ruby​​ 的网页。
*   会话对象在哪里？
*   等等

每本手册仅包含有关如何使用某些框架的信息，但它在内部是如何工作的，没有任何描述。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:29:15.833

Ruby 就像 PHP 一样被“解释”，但这也是一种编译形式。您可能会感到困惑的是，Ruby on Rails 和 Sinatra 与大多数基于 Ruby 的框架一样，都是作为持久进程托管的。PHP 倾向于针对每个请求进行解释，尽管加速器和 Web 服务器模块确实显着降低了此过程的开销。

我不建议尝试制作自己的框架，因为这是一项非常重要的任务，即使作为学术练习，其价值也是有限的。最好学习 Sinatra 之类的东西，看看它是如何实现的，以便学到更多东西，而不是从头开始。

Rails 有很好的文档记录。如果您有关于框架组件的特定问题，而无法通过简单地阅读源代码来回答，这些源代码通常组织得很好，您可以在此处发布。

# eclipse - 当我在项目资源管理器中选择文件时，如何让 Eclipse 自动打开/预览文件

> ID：12321591
> 
> 赞同：9
> 
> 时间：2012-09-07T15:57:38.950
> 
> 标签：eclipse

当我在 Project Explorer 中选择文件时，有没有办法让 Eclipse 自动打开/预览文件？我知道我可以双击，但我想在探索项目时快速向上/向下箭头。

我本质上是在寻找类似 Mac Finder 的 Quick Look 或 Windows 7 Explorer 的预览窗格之类的东西。IntelliJ IDEA 也具有此功能，并将其称为“自动滚动到源”。

Eclipse 有“链接到编辑器”，但这与我想要的相反（IntelliJ IDEA 称之为“从源代码自动滚动”） - 它从编辑器更新项目资源管理器。我希望编辑器从 Project Explorer 更新。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-07T16:01:46.093

```
Window -> Preferences -> General -> Open Mode (single click) 
```

此选项在新编辑器选项卡中打开新源文件。要禁用此功能并仅保留一个活动编辑器选项卡，请使用：

```
Window -> Preferences -> General -> Editors -> 
Select checkbox 'Close editors automatically' -> 
Set 'Number of opened editors before closing' to 1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-07T23:54:36.550

我认为将 mishadoff 的单击打开模式建议与“使用箭头键时打开”结合起来正好回答了 OP 的问题：

```
Window(or Eclipse on Mac) -> Preferences -> General: 
```

![在此处输入图像描述](../Images/6e96b8391af77b2aeeb62b3c39d4bc4b.png)

（我用的是朱诺版）

# vxworks - VxWorks 中 pciConfigTopoShow() 的输出中的“preMem”是什么？

> ID：12321596
> 
> 赞同：0
> 
> 时间：2012-09-07T15:57:57.420
> 
> 标签：vxworks

对于 P2P BRIDGE，pciConfigTopoShow() 的输出中的“mem”和“preMem”是什么？

这是我的目标的输出......

[1,0,0] type=P2P BRIDGE to [2,0,0] base/limit：mem= 0xa0000000/0x9fffffff preMem=0x0000000080000000/0x00000000800fffff I/O= 0xe8000000/0xe7ffffff status=0x0010（CAP DEVSEL=0x0010）命令=0x0007（IO_ENABLE MEM_ENABLE MASTER_ENABLE）[2,1,0] 类型=P2P 桥接至 [3,0,0] 基本/限制：mem= 0xa0000000/0x9ffffffff preMem=0x0000000080000000/0x00000000800fffff00000= 0xeffff 状态=e (CAP DEVSEL=0) command=0x0007 (IO_ENABLE MEM_ENABLE MASTER_ENABLE) [3,0,0] type=P2P BRIDGE to [4,0,0] base/limit：mem= 0xa0000000/0x9fffffff preMem=0x80100000/0x800fffff I/O= 0x0000/0xffff status=0x0010 (CAP DEVSEL=0) command=0x0007 (IO_ENABLE MEM_ENABLE MASTER_ENABLE) bar0 在可预取的 64 位内存空间 @ 0x800

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T13:56:44.563

“mem”和“preMem”值是由 pciConfigTopoShow() 函数通过多层函数调用产生的。“mem”是为桥映射的普通内存窗口，分别显示内存基数和内存限制，用“/”分隔。

如果设备支持，“preMem”用于可预取内存窗口，显示该设备的内存基础和内存限制。如果是 64 位机器，则这些值显示为 64 位数量。

最终，在文件 WIND_BASE/target/src/drv/pci/pciConfigShow.c 中找到的 pciConfigForeachShow() 函数会生成以下代码片段中与您的问题一起显示的输出：

```
if ( cmdReg & PCI_CMD_MEM_ENABLE )

{

     pciConfigInWord(bus,device,function,

                     PCI_CFG_MEM_BASE, &memBase);

     pciConfigInWord(bus,device,function,

                     PCI_CFG_MEM_LIMIT, &memLimit);

     printf("\tbase/limit:\n");

     printf("\t  mem=   0x%04x0000/0x%04xffff\n",

                 memBase & 0xfff0, memLimit | 0x000f);

     pciConfigInWord(bus,device,function,

                     PCI_CFG_PRE_MEM_BASE, &memBase);

     pciConfigInWord(bus,device,function,

                     PCI_CFG_PRE_MEM_LIMIT, &memLimit);

     if ( ( memBase & 0x000f ) == 0x0001 )

     {

         /* 64-bit memory */

         pciConfigInLong(bus,device,function,

                         PCI_CFG_PRE_MEM_BASE_U,

                         &memBaseU);

         pciConfigInLong(bus,device,function,

                         PCI_CFG_PRE_MEM_LIMIT_U,

                         &memLimitU);

         printf("\t  preMem=0x%08x%04x0000/"

                     "0x%08x%04xffff\n",

                      memBaseU, memBase & 0xfff0,

                      memLimitU, memLimit | 0x000f);

     }

     else

         printf("\t  preMem=0x%04x0000/0x%04xffff\n",

                     memBase & 0xfff0, memLimit | 0x000f);

     } 
```

# bash - printf“列”和换行符

> ID：12321598
> 
> 赞同：0
> 
> 时间：2012-09-07T15:58:09.730
> 
> 标签：bash, newline, printf

在我的程序中，我尝试为将在整个脚本中添加的文件设置列标题。

我用来创建标题的行是：

```
printf '%-10s' "csci" "csc" "Line #" "File Name" > "$1 3.txt" 
```

这就像我想要的那样创建标题，但是当我去添加下一行时，它被添加到这一行的末尾而不是下一行。

我一直在尝试在标题创建行中添加换行符，因此添加的下一行将是空行，但是我添加换行符的所有尝试都得到了奇怪的结果（或者我只是不想要的结果）。

我试过像这样添加 \n: `'%-10s\n'`，但这只会让我的标题显示在单独的行上（这是我所期望的，但无论如何都必须尝试）。

然后我尝试了: `printf '%-10s' "csci" "csc" "Line #" "File Name" "\n"> "$1 3.txt"`，但这只是按原样打印了 \n 而实际上没有给我一个换行符。

所以，如果我的问题现在还不明显，我怎么能在那里换行呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:01:22.643

在打印列后添加`echo`or`printf`语句，以便添加新行：

```
(printf '%-10s' "csci" "csc" "Line #" "File Name"; echo) > "$1 3.txt"
# or
(printf '%-10s' "csci" "csc" "Line #" "File Name"; printf '\n') > "$1 3.txt" 
```

或定义整行`printf`并`\n`在末尾添加：

```
printf '%-10s %-10s %-10s %-10s\n' "csci" "csc" "Line #" "File Name" > "$1 3.txt" 
```

* * *

这也应该有效，尽管它在**`Bash`**新行的末尾附加了一些空格：

```
printf '%-10s' "csci" "csc" "Line #" "File Name" $'\n' > "$1 3.txt" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:00:07.767

之后附加它。

```
echo >> "$1 3.txt" 
```

# php - 为什么我的 flashbag 物品不再存在？

> ID：12321599
> 
> 赞同：0
> 
> 时间：2012-09-07T15:58:11.393
> 
> 标签：php, session, redirect, symfony, symfony-2.1

我在我的请求内核事件侦听器中设置了我的会话，我在其中更新了一个`last_seen`会话变量，如下所示：

```
class RequestListener
{
    public $session;

    public function __construct( Session $session ) {
        //leave blank
        $this->session=$session;
    }

    public function onKernelRequest( GetResponseEvent $event ) {
        if ( HttpKernel::MASTER_REQUEST != $event->getRequestType() ) {
            // don't do anything if it's not the master request
            return;
        }
        else {

            $session      = $this->session;
            $current_time = time();

            //if they're logged in and it hasn't been more than an hour since their last request
            if ( $session->get( 'auth' ) ) {
                if ( ( (int) $session->get( 'last_seen' ) ) > ( $current_time - 10 ) ) {//timeout: half hour (temporarily changed to ten seconds)
                    //regenerate session ID:
                    $session->migrate();
                }
                else {
                    //destroy session
                    $session->invalidate();//shortcut for clear() & then migrate()

                    //set session variable to acknowledge timeout
                    $session->getFlashBag()->add( 'info', 'You were automatically logged out due to inactivity' );
                }
                $session->set( 'last_seen', $current_time );
            }
            else {
                $session->set( 'last_seen', $current_time );
            }
        }
    }
} 
```

* * *

为每个请求运行此代码。如您所见， flashbag info flash 消息设置为 hold `You were automatically logged out due to inactivity`，但这永远不会显示。

* * *

### 我的树枝模板：

我知道这应该没有什么问题，因为我在其他情况下看到其他闪光。

```
{# START info messages #}
{% set info_messages = app.session.flashbag.get('info') %}
{% if info_messages is defined and info_messages is not empty%}
    <div class="row alert alert-info alert-block">
        <ul>
            {% for info_message in info_messages %}
            <li>{{info_message | raw}}</li>
            {% endfor %}
        </ul>
    </div>
{% endif %}
{# END info messages #} 
```

* * *

所以我一直在测试的流程是这样的：

1.  用户来到登录页面
2.  提交登录表单（刷新登录路径）
3.  登录被视为成功，重定向到另一个页面（假设页面 B）
4.  等待十秒钟并刷新
5.  内核事件应该清除会话并将项目添加到 flashbag
6.  当到达页面 B 的路由的控制器时，它会检查会话以查看用户是否已登录，然后重定向到登录页面，因为他们没有
7.  登录页面只是渲染树枝模板，看不到flash

* * *

这是否与[文档](http://symfony.com/doc/master/components/http_foundation/sessions.html#flash-messages)中简要提到的 Flash 消息自动过期有关？

我怀疑这是一个简单的会话问题，可能会受到重定向和/或自动过期的影响。

* * *

## 编辑

我还尝试更改我的 onKernelRequest 函数，以便它为每个请求运行会话处理代码（已删除`MASTER_REQUEST`检查）

* * *

## 编辑 2

我已经尝试在我的侦听器和控制器中使用`$session->setFlash('info', '...message...')`而不是在我的模板中使用 #symfony IRC 频道中的建议，但仍然没有运气。`$session->getFlashBag()->add(...)``app.session.flashes('info')``app.session.flashbag.get('info')`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T11:56:26.990

## 这归结为 Symfony2.1 中的一个错误。

[文档](http://symfony.com/doc/master/components/http_foundation/sessions.html#session-api)说该功能与 a then`$session->invalidate()`相同，但这并不是因为我的示例中的 flash 消息是在使用后者而不是第一个时显示的。`$session->clear()``$session->migrate()`

请参阅 Symfony 的 Github 上的[问题](https://github.com/symfony/symfony/issues/5487)。

# coordinates - 从角度获取坐标

> ID：12321605
> 
> 赞同：0
> 
> 时间：2012-09-07T15:58:26.250
> 
> 标签：coordinates, formula, angle

给定一个角度并从边界框的中心绘制一条线，我们如何计算该线与边界框相交的坐标？

请看下图： ![在此处输入图像描述](../Images/db0b58263afde257dc98b6aa6c1f98ad.png)

如您所见，例如，在角度 0 处，线与点 (0.5, 1) 相交

我们如何将这个问题转化为一个接受角度并返回 x 和 y 坐标的可计算公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:52:08.550

您可以通过使用三角函数并分别处理每个 45 度部分来求解：

鉴于：

*   xmin, xmax（盒装区域的 x 轴限制）
*   ymin, ymax（盒装区域的 y 轴限制）
*   一个（角度）
*   x 和 y 的输出坐标
*   宽度 = (xmax - xmin)
*   高度 = (ymax - ymin):

角度范围；X; 是的

*   (0<= a <= 45); x = xmin + (tan(a)*(width/2) + width/2; y = ymax
*   (45<= 一个 <= 90); x = xmax; y = ymin + (tan(90-a)*height/2) + height/2
*   (90<= 一 <= 135); x = xmax;y = ymin + (tan(a-90)*height/2) + height/2
*   (135<= 一 <= 180); x = xmin + (tan(180-a)*width/2)+width/2; y = ymin
*   (180<= 一 <= 225); x = xmin - (tan(a-180)*width/2)+width/2; y = ymin
*   (225<= 一 <= 270); x = xmin; y = ymin -(tan(270-a)*height/2)+height/2
*   (270<= 一 <= 315); x = xmin; y = ymin + (tan(a-270)*height/2)+height/2
*   (315<= 一 <= 360); x = xmin -(tan(360-a)*width/2)+width/2; y = ymax

# php - 根据父类别排序 Wordpress 帖子

> ID：12321611
> 
> 赞同：5
> 
> 时间：2012-09-07T15:58:49.080
> 
> 标签：php, wordpress, post, categories

更新：我尝试使用以下代码：

```
<?php if (is_category(events)) { 
$posts = query_posts($query_string . '&orderby=event_date&order=desc'); 
} else {
    $posts = query_posts($query_string . '&orderby=title&order=asc'); 
    }
?> 
```

有什么理由不工作吗？按字母顺序组织帖子似乎可以正常工作，但在“事件”中的日期顺序仍然没有运气。

--

在搜索了各种现有问题后，我无法完全找到我正在尝试做的事情的解决方案。

目前我网站上的所有帖子都按字母顺序排列，这很好，除了我添加的一个新类别。对于这个类别，我想按我在自定义字段中输入的值对所有帖子进行排序。该字段称为“event_date” - 所以我想基本上按日期排序帖子，而不是帖子创建的日期，即用户手动输入此字段的日期。

我设法通过使用：

```
<?php if (is_category($events)) { $posts = query_posts($query_string . '&orderby=$event_date&order=asc'); } ?> 
```

但是，这会覆盖所有其他页面的 aphabetical 顺序。

对于我使用的字母顺序：

```
<?php if (is_category()) { $posts = query_posts( $query_string . '&orderby=title&order=asc' ); } ?> 
```

本质上，我想要一个声明，告诉页面以 aphabetical 顺序对所有帖子进行排序，除非类别是“事件”，我想按自定义事件日期对它们进行排序。

正如您可能会说的那样，我非常喜欢前端，而不是后端，所以很多这对我来说是相当新的，所以任何帮助或建议都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T12:38:31.677

要按自定义字段值排序帖子，您需要将自定义元字段添加到查询本身。`orderby=meta_value`除了`meta_key=metafieldid`将允许以这种方式订购。

如果（或类似的查询变量）返回所需的帖子类别，我将使用[`pre_get_posts`钩子](http://codex.wordpress.org/Plugin_API/Action_Reference/pre_get_posts)并修改查询对象。`get_query_var( "cat" )`

```
add_action( "pre_get_posts", "custom_event_post_order" );

function custom_event_post_order( $query )
{
    $queried_category = $query -> get_query_var( "cat" );

    /*
     * If the query in question is the template's main query and
     * the category ID matches. You can remove the "is_main_query()"
     * check if you need to have every single query overridden on
     * a page (e.g. secondary queries, internal queries, etc.).
     */
    if ( $query -> is_main_query() && $queried_category == 123 )
    {
        $query -> set( "meta_key", "event_date" ); // Your custom field ID.
        $query -> set( "orderby", "meta_value" ); // Or "meta_value_num".
        $query -> set( "order", "ASC" ); // Or "DESC".
    }
} 
```

请记住，这种方法会覆盖所有使用相关类别的查询。您可以构建使用自己的参数来构建循环的自定义 WP_Query 对象。

您还应该标准化将自定义字段数据保存到数据库的方式。对于日期，我更喜欢使用易于移动和操作的 UNIX 时间戳格式的时间。这样在查询时不会发生意外，并且某些数据以其他方式格式化。

免责声明：我没有时间测试上面的代码，但总体思路应该可以正常工作。

编辑：当然上面的代码应该插入到`functions.php`或类似的通用函数文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:04:02.570

希望我理解你的问题，使用`WP_Query`and 在`orderby`你的 order by 列之间添加一个空格：

```
$args = array(
    'posts_per_page' => 100,
    'orderby' => 'title',
    'order' => 'ASC',
);

if(is_category($events)){
    $args['orderby'] .= " meta_value_num";
    $args['meta_key'] = 'event_date';
}

$posts = (array) new WP_Query( $args ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:06:31.300

关于什么：

```
<?php $posts = query_posts($query_string . (is_category($events)?'&orderby='.$event_date:'&orderby=title') . '&order=asc');  ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T16:26:36.243

```
<?php
$recent = new WP_Query(“cat=ID&showposts=x”);
while($recent->have_posts()) : $recent->the_post();
?> 
```

# razor - 为什么在标题属性中使用 HTML.Raw 时 MVC 4 Razor 会转义与符号

> ID：12321616
> 
> 赞同：11
> 
> 时间：2012-09-07T15:59:12.060
> 
> 标签：razor, asp.net-mvc-4

我们最近升级到 MVC 4，现在我们的链接中的标题无法正确显示。问题出在 HTML.Raw 不会在我们的标题属性中转义 & 之前，但现在可以了。下面是我的示例代码：

```
<a title="@Html.Raw("Shoe Size 6&#189;-8")">Test</a> 
```

这会产生以下标记：

```
<a title="Shoe Size 6&amp;#189;-8">Test</a> 
```

到目前为止，我发现的唯一解决方案是将整个锚点放入一个字符串中，然后 HTML.Raw 那个字符串。

[为什么 Html.Raw 在 ASP.NET MVC 4 的锚标记中转义 & 符号？](https://stackoverflow.com/questions/11963453/why-is-html-raw-escaping-ampersand-in-anchor-tag-in-asp-net-mvc-4).

这是一个非常丑陋的解决方案，我希望有更好的选择。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T17:08:00.380

虽然它只是一个不那么丑陋的解决方法，但您可以简单地`@Html.Raw`使用完整的属性名称和值。

```
<a @Html.Raw("title=\"Show Size 6&#189;-8\"")>Test</a> 
```

结果是：

```
<a title="Show Size 6&#189;-8">Test</a> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-08T02:15:21.497

如果您不能执行上面列出的解决方法，我有一个修补的基类，您可以尝试通过 web.config 注入。查看[https://gist.github.com/4036121](https://gist.github.com/4036121)

# android-viewpager - Android ViewPager：移动任何页面以编程方式结束？

> ID：12321617
> 
> 赞同：9
> 
> 时间：2012-09-07T15:59:17.203
> 
> 标签：android-viewpager

在 Android 中使用`Viewpager`，是否可以以编程方式将任何页面移动到末尾？例如，我有五页，想将第 2 页移动到最后一个位置（第 5 个位置），所以第 3 页变成 2，4 变成 3，5 变成 4？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-11T22:24:57.520

是的。我将尝试通过展示我是如何做到的来回答您的案例，并且我将在我的代码示例下方展示您案例的示例。

基本上，要做到这一点，您必须跟踪片段的位置。下面是我用于 my 的实现`FragmentPagerAdapter`，它使用 ArrayList 作为其数据源。

```
public class MyFragmentPagerAdapter extends FragmentPagerAdapter {

    private HashMap<Long, Fragment> mItems
                    = new HashMap<Long, Fragment>();

    private ArrayList<MyObject> dataset;

    public MyFragmentPagerAdapter(ArrayList<MyObject> objects) {
        this.dataset = objects;
    }

    @Override
    public int getCount() {
        return dataset.size();
    }

    @Override
    public Fragment getItem(int position) {
        long id = getItemId(position);

        if(mItems.get(id) != null) {
            // caching to prevent multiple instances of the same fragment
            // for the same position/id
            return mItems.get(id);
        }

        Fragment f = Fragment.newInstance();

        mItems.put(id, f);

        return f;
    }

    @Override
    public long getItemId(int position) {
        // return a unique id
        return dataset.get(position).getUniqueId();
    }

    @Override
    public int getItemPosition(Object object) {
        /*
         * Purpose of this method is to check whether an item in the adapter
         * still exists in the dataset and where it should show.
         * For each entry in dataset, request its Fragment.
         * 
         * If the Fragment is found, return its (new) position. There's
         * no need to return POSITION_UNCHANGED; ViewPager handles it.
         * 
         * If the Fragment passed to this method is not found, remove all
         * references and let the ViewPager remove it from display by
         * by returning POSITION_NONE;
         */
        Fragment f = (Fragment) object;

        for(int i = 0; i < getCount(); i++) {

            Fragment item = (Fragment) getItem(i);
            if(item.equals(f)) {
                // item still exists in dataset; return position
                return i;
            }
        }

        // if we arrive here, the data-item for which the Fragment was created
        // does not exist anymore.

        // Also, cleanup: remove reference to Fragment from mItems
        for(Map.Entry<Long, MainListFragment> entry : mItems.entrySet()) {
            if(entry.getValue().equals(f)) {
                mItems.remove(entry.getKey());
                break;
            }
        }

        // Let ViewPager remove the Fragment by returning POSITION_NONE.
        return POSITION_NONE;
    }
} 
```

现在，如果您从数据集 ( `this.dataset`) 中删除一个项目并调用`notifyDataSetChanged()`的实例`MyFragmentPagerAdapter`，它将从 ViewPager 中删除该项目（即使当前正在查看它）。

假设`this.dataset`包含 5 个项目，并且您想将 #2 移动到 ViewPager 的末尾。为此，您必须将 item#2 定位到数据源的末尾（通过`Collection.Sort`或其他方式）。我只会告诉你简单的方法。

```
ArrayList<MyObject> list = new ArrayList<>();
MyFragmentPagerAdapter adapter = new MyFragmentPagerAdapter(list);
viewpager.setAdapter(adapter);

...

MyObject item = list.get(2);
list.remove(item);
list.add(item); // now it's positioned at the end of the list
adapter.notifyDataSetChanged(); // voilá, that should do the trick! 
```

`adapter.notifyDataSetChanged()`最终调用`viewpager.dataSetChanged()`，依次调用`adapter.getItemPosition(..)`它的每个页面。该方法调用的结果确定页面（在本例中为 Fragment）是否以及在何处显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T01:39:00.987

我刚刚阅读了这一切。

使用 ViewPager 的常用方法是拥有一个 PagerAdapter 类，该类在正确的时刻为其提供正确的页面。PagerAdapter、FragmentPagerAdapter 和 FragmentStatePagerAdapter 有很好的子类，它们更易于使用。

但是，为了能够更改页面顺序，您将不得不编写自己的 PagerAdapter 子类。基本上，ViewPager 有两种方法知道您在哪个页面上：页码和适配器给它的关键对象。因此，您应该能够在 ViewPager 不迷路的情况下更改顺序。

它是如何完成的血淋淋的细节在[这个页面上](http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html "寻呼机适配器（android 文档）")。我还没有尝试过，但我会在接下来的几周内尝试。我认为该页面并不能说明一切。它没有提到大多数适配器类必须具有的 getItem() 方法。所以我真的还没有看到页面是如何添加到 ViewPager 中的。

是时候查找并阅读一些示例代码了。

# c# - mvc 控制器中的可选布尔参数

> ID：12321618
> 
> 赞同：1
> 
> 时间：2012-09-07T15:59:28.473
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, optional-parameters

这是我想要的：

```
 [GET("page/{id}/")]
    public ActionResult Execute(Guid id, bool x = false, bool y = false, 
                                         bool z = false) 
```

我想让 bools 可选的原因是我以后可以像这样使用这个方法：

```
return RedirectToAction<SomeController>(c => c.Execute(id, y: true)); 
```

不幸的是，当我尝试构建解决方案时，出现以下错误：“表达式树可能不包含使用可选参数的调用或调用”和“表达式树可能不包含命名参数规范”。

我的问题是：有没有可能用控制器做类似的事情？路由中的可选参数呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:06:19.893

您可以改用模型类。就像是：

```
public class ExecuteModel
{
    public Guid id {get;set;}
    public bool x {get;set;}
    public bool y {get;set;}
    public bool z {get;set;}
} 
```

并将您的操作更改为：

```
public ActionResult Execute(ExecuteModel model)
{
   ...
} 
```

您的重定向将变为：

```
return RedirectToAction<SomeController>(c => c.Execute(
    new ExecuteModel{id=id, y=true})); 
```

# asp.net - UserControl 有 IsPostBack，但 Control 没有

> ID：12321621
> 
> 赞同：1
> 
> 时间：2012-09-07T15:59:39.433
> 
> 标签：asp.net, user-controls

我正在尝试解决 Visual Studio 中的错误，[建议停止使用`UserControls`并`Control`改用。](https://stackoverflow.com/questions/11658053/how-to-add-a-templating-to-a-usercontrol).

所以我将所有 my`UserControl`转换为 just `Control`，例如：

```
public partial class Controls_UserManagement_GroupManager : System.Web.UI.UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {
       if (!IsPostBack) 
```

变成

```
public partial class Controls_UserManagement_GroupManager : System.Web.UI.Control
{
    protected void Page_Load(object sender, EventArgs e)
    {
       if (!IsPostBack) 
```

除了没有`Control.IsPostBack`？

我该如何`UserControl`替换`Control`？

## 系列

这个问题是正在进行的 Stackoverflow 系列**“模板化用户控件”**中的一个：

*   [如何将模板添加到用户控件？](https://stackoverflow.com/questions/11658053/how-to-add-a-templating-to-a-usercontrol/11700540)
*   [如何从 Control 继承，而不是 UserControl？](https://stackoverflow.com/questions/12323303/how-to-inherit-from-control-rather-than-usercontrol)
*   [UserControl 有 IsPostBack，但 Control 没有](https://stackoverflow.com/questions/12321621/usercontrol-has-ispostback-but-control-does-not/12321692)
*   [UserControl 没有名为 ContentTemplate 的公共属性](https://stackoverflow.com/questions/11656637/usercontrol-does-not-have-public-property-named-contenttemplate)
*   [如何从 web.config 指定 CodeFileBaseClass？](https://stackoverflow.com/questions/12325192/how-do-i-specify-codefilebaseclass-from-web-config)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:05:11.180

`Control`有一个`Page`属性，它有一个`IsPostback`属性。这应该为您提供所需的价值。

```
public class MyControl : Control{
    protected override void OnInit( EventArgs e ){
        if( this.Page.IsPostBack ){
            // do something
        }
    }
} 
```

[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.web.ui.control.page.aspx)

# regex - 我的正则表达式不起作用

> ID：12321622
> 
> 赞同：-1
> 
> 时间：2012-09-07T15:59:59.990
> 
> 标签：regex

我有一个必须具有这种名称格式的 excel 文件，其中 xxx 是一个数字，Curr 是 EUR 或 GBP，yymmdd 是一个日期。

```
CDFSDDRCxxxCurryymmdd.xls(x) 
```

这是我正在使用的正则表达式。它不适用于 120920 或 121005 之类的日期。有什么想法吗？

```
Match nameIsValid = Regex.Match(activeWorkbook.Name,
                                      @"CDFSDDRC(?<xxx>\d+)(?<curr>EUR|GBP)(?<yymmdd>\d{2}(?:0[1-9]|1[12])(?:(?:0|1|2)[1-9]|3[0-2]))\.xls?"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:12:27.513

此正则表达式的快速修复将是以下一个：

```
CDFSDDRC(?<xxx>\d+)(?<curr>EUR|GBP)(?<yymmdd>\d{2}(?:0[1-9]|1[012])(?:(?:0|1|2)[0-9]|3[0-2]))\.xls? 
```

你可以在**[这里](http://regexr.com?3231i)**查看结果。

请注意，如果该月的日期为 ，则此选项将匹配`00`。

我的观点是，您不应该在您的正则表达式中检查有效的日期、月份和年份。您可以使用以下更简单的正则表达式匹配 6 位日期：

```
CDFSDDRC(?<xxx>\d+)(?<curr>EUR|GBP)(?<yymmdd>\d{6})\.xls? 
```

匹配后，您可以以编程方式检查它是否是有效日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:05:14.627

这比你所拥有的要简单一些

```
"CDFSDDRC(\d+)(EUR|GBP)(\d{2})(\d{2})(\d{2}).xls" 
```

# networking - 我需要什么样的技能来建立一个bittorrent客户端

> ID：12321626
> 
> 赞同：0
> 
> 时间：2012-09-07T16:00:07.703
> 
> 标签：networking, bittorrent

我刚刚完成了我的数据结构课程。现在我正在考虑建立一个有点洪流的客户端。

然而，当我用谷歌搜索这些东西时，我无法理解任何术语，例如套接字、端口等。

我只需要一个关于在哪里看的一般指导。书籍、教程以及其他一般情况下，我需要什么样的技能来制作一个 torrent 客户端，什么样的语言最适合这份工作，甚至为了实现我的目标，我应该学习什么样的课程。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:08:48.590

您的问题有两个部分：架构和编程。首先，您需要构建程序。架构是将大型“系统”可视化为子系统的过程，定义它们之间的接口，然后编写它们可以跳舞的“曲调”。

对于上述系统，这些是那些“子系统”：

*   存储管理器：您的 torrent 文件由多个块组成，可以以任意随机顺序收集、组装、验证并最终呈现为单个文件。存储管理器执行此操作。

*   传输管理器：该系统了解如何将洪流块传输进出。给定它发送的数据包或给定它接收的主机。

*   连接管理器：该系统建立连接以发送和接收

等等等等

一旦你定义了子系统，然后定义什么是输入和输出。然后你开发每个模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:13:58.917

我想说你需要知道的一件事是计算机网络是如何工作的。这包括数据包传输、套接字、端口、线程等......

计算机网络是一个如此广泛的主题，但我可以在这里留下我个人对我喜欢阅读和学习计算机网络的书的建议（有点网络介绍，但解释了很多，甚至教你如何使用套接字在 Java 中编程） .

> 计算机网络，一种以 Internet 为特色的自上而下的方法，James F. Kurose，Keith W. Ross，2005，Addison-Wesley

它解释了数据包传输、线程、套接字、端口等概念。我记得它甚至有一个关于种子的部分。

# opengl - 我可以在几何着色器中导出三角形而不是三角形条吗？

> ID：12321631
> 
> 赞同：0
> 
> 时间：2012-09-07T16:00:29.543
> 
> 标签：opengl, glsl, shader, geometry-shader

是否有可能只从几何着色器导出三角形而不是三角形条？这带来了一些有趣的可能性。OpenGL 3.3。

```
glProgramParameteriARB(mVoxelShd, GL_GEOMETRY_OUTPUT_TYPE_ARB, GL_TRIANGLE_STRIP); 
```

指定巫婆输出模式执行着色器。如果我尝试：

```
glProgramParameteriARB(mVoxelShd, GL_GEOMETRY_OUTPUT_TYPE_ARB, GL_TRIANGLES); 
```

它编译和工作正常，但它的表现形式与三角形条带相同。

还有 GLSL 语言规范 3.3：

> 几何着色器输出的布局限定符标识符是
> 
> *   布局限定符 id
> *   积分
> *   line_strip
> *   三角带
> *   max_vertices = 整数常量

这里似乎没有“三角形”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:18:28.607

我的错误，似乎可以在每个指定的三角形序列之后使用 EndPrimitive() 在几何着色器中导出独立的三角形。这似乎更加强大。三角形条带和独立三角形都可以从单个着色器创建，而无需更改几何输出类型。

# java - java.io.IOException: 传入 ByteArrayInputStream 时不是 GZIP 格式

> ID：12321637
> 
> 赞同：0
> 
> 时间：2012-09-07T16:00:54.307
> 
> 标签：java, jaxb, gzipinputstream

```
 final ByteArrayOutputStream stream = new ByteArrayOutputStream();
        try {
            jaxbContext.createMarshaller().marshal(proposal, stream);
            try {
                    stream.close();
            } catch (IOException e) {
                throw new PersistenceException("Failed to close output stream for " + proposal.getUniqueId());
            }
            // call persistenceService.put to send data to respective PersistenceServiceClass
            InputStream inputStream = new ByteArrayInputStream(stream.toByteArray());
            persistenceService.put(inputStream, proposal.getUniqueId()); 
```

`persistenceService.put`好像

```
public void put(@Nonnull final InputStream inputStream, @Nonnull final String uniqueId) throws PersistenceException {
        // a.) create xml.zip of inputStream as inputStream
        final GZIPInputStream zipInputStream;
        try {
            zipInputStream = new GZIPInputStream(inputStream);
        } catch (IOException e) {
            e.printStackTrace();
            throw new PersistenceException("Persistence Service could not received input stream to persist for " + uniqueId);
        }

        // b.) call amazonS3client.putObject() to put data
        final PutObjectRequest putObjectRequest = new PutObjectRequest(bucketName, getProposalName(uniqueId), zipInputStream, new ObjectMetadata());
    } 
```

当我运行此代码时，我看到以下堆栈跟踪

```
java.io.IOException: Not in GZIP format
    at java.util.zip.GZIPInputStream.readHeader(GZIPInputStream.java:141)
    at java.util.zip.GZIPInputStream.<init>(GZIPInputStream.java:56)
    at java.util.zip.GZIPInputStream.<init>(GZIPInputStream.java:65)
    at com.sunrunhome.sparrow.business.xml.persist.S3Service.put(S3Service.java:71)
    at com.sunrunhome.sparrow.business.ProposalManager.putDocument(ProposalManager.java:56)
    at com.sunrunhome.sparrow.business.ProposalManagerTest.testWriteToS3(ProposalManagerTest.java:165)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:46)
    at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:46)
    at org.junit.rules.RunRules.evaluate(RunRules.java:18) 
```

我在这里没有做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:11:09.540

```
private static void gzip(File file) {
    //logic to extract file
    GZIPInputStream in = null;
    FileInputStream fin = null;
    OutputStream out = null;
    int noread = 0;

    try {
        in = new GZIPInputStream(new FileInputStream(file));
        extractedFile = new File("C:\\DATA\\extracted.txt");
        out = new FileOutputStream(extractedFile);
        byte[] buffer = new byte[65536];
        noread = in.read(buffer);

        while(noread > 0) {
            out.write(buffer, 0, noread);
            System.out.println("done");
            break;
        }
    } 
```

您可能可以通过它`fileInputStream`并对其进行测试

# regex - 数字的正则表达式在特定位置不为零

> ID：12321640
> 
> 赞同：1
> 
> 时间：2012-09-07T16:01:16.233
> 
> 标签：regex

以下是数字应采用的格式：

```
123456789
$XXXX$$$X 
```

该数字的长度必须为 9 个字符。没有一个`$`位置可以是零。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T16:02:18.657

这应该可以解决问题：

```
[1-9]\d{4}[1-9]{3}\d 
```

在此处查看实际操作：[http ://regexr.com?3231o](http://regexr.com?3231o)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:03:17.080

有点难看，但应该可以：

```
[1-9][0-9]{4}[1-9]{3}[0-9] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T16:09:50.947

简单的正则表达式如下所示，它将为连续模式返回 2 个匹配项，例如`123456789123456789`

```
([1-9]\d{4}[1-9]{3}\d) 
```

如果您不需要连续的模式来匹配，那么

```
(?<=^|\D)([1-9]\d{4}[1-9]{3}\d)(?=\D|$) 
```

您可以在[Rubular测试正则表达式](http://rubular.com/r/qIPtWLUDUY)

# javascript - 如何在相同表单中的条卡验证之前部分验证表单字段

> ID：12321645
> 
> 赞同：1
> 
> 时间：2012-09-07T16:01:44.240
> 
> 标签：javascript, jquery, validation, stripe-payments

我有一个包含客户运输信息和卡详细信息的表格。我正在使用[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)进行验证。现在，所有表单字段都在表单提交时进行验证，包括条卡验证。问题是，如果客户正确输入了他/她的卡信息并且表格的其他区域没有经过验证，收费仍然会通过。我可以在使用一个提交按钮运行条带验证之前验证计费信息，而不必将其分解为两步过程吗？请参阅下面的代码。谢谢！

```
<div class="stripe-errors"><span class="payment-errors"></span></div>                
                <form action="charge.php" method="POST" id="payment-form" class="form"     >
                    <div class="pleft">
                        <label for="firstname">First Name</label>
                        <input type="text" size="20" value="<?php echo $_SESSION['sfirst'] ?>" name="fname" class="required" placeholder="First"/>
                        </label>
                        <label for="lastname">Last Name</label>
                        <input type="text" size="20" value="<?php echo $_SESSION['slast'] ?>" name="lname" class="required" placeholder="Last"/>           
                        <label for="email">Email</label>
                        <input type="text" size="20" value="<?php echo $_SESSION['semail'] ?>" name="email" class="required email" placeholder="email@address.com"/>
                        <label>Shipping Address</label>
                        <input type="text" size="20" value="<?php echo $_SESSION['saddress'] ?>" name="address" class="required" placeholder="Address"/>
                    </div>
                    <div class="pmiddle">
                        <label>City</label>
                        <input type="text" size="20" value="<?php echo $_SESSION['scity'] ?>" name="city" class="required" placeholder="City"/>
                        <label>State</label>
                        <select id="state" value="<?php echo $_SESSION['sstate'] ?>" name="state" class="required" >
                                <option value="">Select State</option>
                                <option value="AK">Alaska</option>
                                <option value="AL">Alabama</option>
                                <option value="AR">Arkansas</option>
                                <option value="AZ">Arizona</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DC">District of Columbia</option>
                                <option value="DE">Delaware</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="IA">Iowa</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MD">Maryland</option>
                                <option value="ME">Maine</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MO">Missouri</option>
                                <option value="MS">Mississippi</option>
                                <option value="MT">Montana</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="NE">Nebraska</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NV">Nevada</option>
                                <option value="NY">New York</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="PR">Puerto Rico</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VA">Virginia</option>
                                <option value="VT">Vermont</option>
                                <option value="WA">Washington</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WV">West Virginia</option>
                                <option value="WY">Wyoming</option>
                            </select>
                        <label>Zip Code</label>
                        <input type="text" size="20" name="zip" value="<?php echo $_SESSION['szip'] ?>" class="required" minlength="5" placeholder="Zip Code"/>
                        <label>Product Quantity</label>
                        <select id="orderquantity" name="orderquantity" >
                            <option value="1">1 Bottle (30 Day Supply)</option>
                            <option value="2">2 Bottles (60 Day Supply)</option>
                            <option value="3">3 Bottles (90 Day Supply)</option>
                            <option value="4">4 Bottles (120 Day Supply)</option>
                            <option value="5">5 Bottles (150 Day Supply)</option>
                            <option value="6">6 Bottles (180 Day Supply)</option>
                            <option value="7">7 Bottles (210 Day Supply)</option>
                            <option value="8">8 Bottles (240 Day Supply)</option>
                        </select>
                    </div>    
                    <div class="pright">
                        <label>Card Number</label>
                        <input type="text" size="20" autocomplete="off" class="card-number" />
                        <label>CVC Security Code </label>
                        <input type="text" size="4" autocomplete="off" class="card-cvc"/><a class="small-link" data-toggle="modal" href="#cvcs"/>What's this?</a>
                        <label>Card Expiration (ex. 01/2015)</label>
                        <select class="card-expiry-month required ">
                                <option value="">Month</option>
                                <option value="01">01 January</option>
                                <option value="02">02 February</option>
                                <option value="03">03 March</option>
                                <option value="04">04 April</option>
                                <option value="05">05 May</option>
                                <option value="06">06 June</option>
                                <option value="07">07 July</option>
                                <option value="08">08 August</option>
                                <option value="09">09 September</option>
                                <option value="10">10 October</option>
                                <option value="11">11 November</option>
                                <option value="12">12 December</option>
                        </select>
                        <select class="card-expiry-year required">
                                <option value="">Year</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                        </select>
                    </div>
                    <div class="checkbox">
                        <input type="checkbox" style="visibility:hidden;" value="checked" checked="yes"  name="agree" class="required">
                    </div>
                    <div class="purchasebutton">
                        <button type="submit" class="submit-button button green" onclick="return loadSubmit();">Purchase</button>
                    </div> 
                                <div class="cards">
            <img src="/images/trial/cards.png">
        </div>                        
                </form>                                  
    </div> 
```

表单 js 验证在这里：

```
<script src="/js/jquery.validate.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://js.stripe.com/v1/"></script>
    <script type="text/javascript" src="/js/modal.js"></script>
    <script type="text/javascript">
    //this validates customer information form fields
    $(document).ready(function() {
        $("#payment-form").validate();
    });
    </script>
    <script type="text/javascript">
        // this identifies your website in the createToken call below
        Stripe.setPublishableKey('<?PHP echo $publishable_api_key ?>');

        function stripeResponseHandler(status, response) {
            if (response.error) {
                // re-enable the submit button
                $('.submit-button').removeAttr("disabled");
                // show the errors on the form
                $(".payment-errors").html(response.error.message);
                document.getElementById("processing").style.visibility = "hidden";

            } else {
                var form$ = $("#payment-form");
                // token contains id, last4, and card type
                var token = response['id'];
                // insert the token into the form so it gets submitted to the server
                form$.append("<input type='hidden' name='stripeToken' value='" + token + "' />");
                // and submit
                form$.get(0).submit();
            }
        }

        $(document).ready(function() {
          $("#payment-form").submit(function(event) {
            if (!$("input[name=agree]").is(":checked")) {document.getElementById("processing").style.visibility = "hidden";
            return false;
          } else {
          $('.submit-button').attr("disabled", "disabled");
          // createToken returns immediately - the supplied callback submits the form if there are no errors
           Stripe.createToken({
              number: $('.card-number').val(),
              cvc: $('.card-cvc').val(),
              exp_month: $('.card-expiry-month').val(),
              exp_year: $('.card-expiry-year').val()
          }, stripeResponseHandler);
            return false;
                }
            });
            if (window.location.protocol === 'file:') {
                alert("stripe.js does not work when included in pages served over file:// URLs. Try serving this page over a webserver. Contact support@stripe.com if you need assistance.");
            }
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:11:32.833

这个怎么样 ：

```
 $("#payment-form").submit(function(event) {
        $("#payment-form").validate();

        if(!$("#payment-form").valid()){
            event.preventDefault();
            $('.submit-button').removeAttr("disabled");
            document.getElementById("processing").style.visibility = "hidden";
            return false;
        }    

        if (!$("input[name=agree]").is(":checked") ) {document.getElementById("processing").style.visibility = "hidden";
        return false;
        }... 
```

# javascript - 鼠标悬停在 asp.net 网络表单上

> ID：12321647
> 
> 赞同：0
> 
> 时间：2012-09-07T16:01:50.630
> 
> 标签：javascript, jquery, asp.net

我正在使用带有标签和文本框的 asp.net 网络表单，并希望在标签旁边包含帮助图像，以便当我将鼠标悬停在图像上时，它应该从数据库中的表中获取帮助描述。有人可以帮助我如何实现这一目标。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:43:51.563

有很多 Jquery 工具提示插件，从内置插件到外观精美的插件。你看过这些吗？

[http://www.1stwebdesigner.com/css/stylish-jquery-tooltip-plugins-webdesign/](http://www.1stwebdesigner.com/css/stylish-jquery-tooltip-plugins-webdesign/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:20:01.150

**请看这个链接：**

[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

[http://api.jquery.com/load/](http://api.jquery.com/load/)

```
$(".myDiv").live('keyup focus focusout change click mouseenter mouseover',function(){
         // Your command
}) 
```

# django - htsql django 和多对多关系

> ID：12321650
> 
> 赞同：2
> 
> 时间：2012-09-07T16:02:03.553
> 
> 标签：django, htsql

在 HTSQL 中，你可以查询多对多关系吗？

在我的 Django 项目（应用程序名称为`config`）中，我有一个`Chapter`与 具有 ManyToMany 关系的模型`FileName`。当我查看实际的 sqlite3 数据库时，我看到了 table `config_chapter_filenames`，（当然所有 django 管理的东西都按预期工作）。但是当我打开一个 HTSQL shell 会话时，该表没有列出：

```
htsql-ctl shell -E tweak.django sqlite:/mydb.sqlite  -E tweak.meta
/meta(/table) 
```

它列出了我的每个模型的表格，但没有列出多对多关系。

我一直无法找出一个查询来列出每一章的文件名。我猜如果 HTSQL 没有看到可以解释问题的多对多关系。

有任何想法吗？

在 htsql shell 中，我看到了模型：

```
config_chapter                         
config_chapter_filenames 
```

这是我的模型：

```
class Chapter(models.Model):
    book = models.ManyToManyField(Book, through='ChapterMembership')
    parent = models.ForeignKey(Book, related_name = '+')
    filenames = models.ManyToManyField(FileName) 
```

我正在尝试的网址是：

```
http://machinename/htsql/config_chapter{name,filenames} 
```

我收到此错误：

```
bind error: unrecognized attribute 'filenames' in scope of 'config_chapter':
    /config_chapter{name,filenames}
                     ^^^^^^^^^ 
```

否则，我可以查询并获取章节和父级的名称，但仍然不能获取文件名。我对 introspect.py 进行了更改，停止了我的 apache 服务器并重新启动。还有什么我想念的吗？

还有一件事，在 htsql shell 中：

```
describe config_chapter
Slots for `config_chapter` are:
     id                       integer
     parent_id                integer
     name                     string
     title                    string
     parent                   SINGULAR(config_book)
     config_chapter_filenames PLURAL(config_chapter_filenames) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T23:11:27.513

蒂姆，

感谢您的报告，我在以下位置修复了此错误： [https ://bitbucket.org/prometheus/htsql/changeset/d5dd4e95bcf31f5416b9e17187deebb329e9dd4f](https://bitbucket.org/prometheus/htsql/changeset/d5dd4e95bcf31f5416b9e17187deebb329e9dd4f)

# asp.net-mvc - 在单个事务上包装成员资格提供程序和 dbcontext

> ID：12321659
> 
> 赞同：4
> 
> 时间：2012-09-07T16:02:41.973
> 
> 标签：asp.net-mvc, entity-framework, asp.net-membership

MVC 项目首先使用 EF 5 代码和 .NET 4.5。

我正在寻找一种将 dbContext 和 SimpleMembershipProvider 包装在单个事务中的方法。我尝试使用 TransactionScope，但由于成员资格提供程序将打开另一个连接，我得到一个异常（服务器“服务器名”上的 MSDTC 不可用）。

所以我虽然可以使用 ObjectContext.Connection.BeginTransaction 来代替。成员资格提供者不会成为事务的一部分，但我们的想法是将它放在某个地方，如果它失败，则不会提交事务。

```
Book bk1 = default(Book);
Book bk2 = default(Book);

object obc = (IObjectContextAdapter)dbContext;

obc.ObjectContext.Connection.Open();
using (tx == obc.ObjectContext.Connection.BeginTransaction) {

    bk1 = new Book {
        Name = "Book 1 Name",
        Location = "USA"
    };
    dbContext.Books.Add(bk1);
    dbContext.SaveChanges();
    bk2 = new Book {
        Name = "Book 2 Name. Book one Id is: " + bk1.Id,
        Location = "USA"
    };
    dbContext.Books.Add(bk2);
    dbContext.SaveChanges();

    // this is not part of the transaction, 
    // however if it trhows an exception the transaction is aborted.
    // I'm assuming that if we got here, the commit won't fail...    
    // But is it really true?
    WebSecurity.CreateUserAndAccount("username", "123456");

    tx.Commit();
} 
```

无论如何，基于上面的代码：

*   如果 WebSecurity.CreateUserAndAccount 失败，那么整个事情都会失败，这是意料之中的。
*   如果 SaveChanges 方法中的任何一个失败，那么整个事情都会再次失败，因为我们没有到达执行 CreateUserAndAccount 的地方。

这整件事让我想到一个问题：它安全吗？我的意思是：

在我们成功执行 DbContext.SaveChanges 后，“提交”方法是否有可能抛出异常（以某种方式失败）？如果发生这种情况，我们将得到一个孤儿用户，因为提供者不是交易的一部分。

我很感激对此的任何意见或建议。

*快速说明：有这篇不错的文章解释了为什么我必须将 dbContext 强制转换为 IObjectContextadapter 而不是使用它自己的连接属性，但我再也找不到它了。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:20:19.713

是的，`Commit`当然可以扔。一个简单的例子是连接断开。当然，还有其他情况。

你有几个选择：

*   如果连接是共享的，同一数据库上的事务将不会升级为分布式。因此，您可以为 EF 和您的连接使用一个`WebSecurity`连接。
*   在服务器上启动分布式事务控制器并接受升级。不是世界上最糟糕的事情。
*   不要使用事务，而是更改操作的顺序，以便稍后可以完成或撤消部分成功的操作。例如，检测和清理“孤儿”用户。

# java - eclipse包资源管理器：文件节点重复类型节点？

> ID：12321666
> 
> 赞同：1
> 
> 时间：2012-09-07T16:03:35.380
> 
> 标签：java, eclipse

当您在 Eclipse 中为包资源管理器激活 Java 成员时，树层次结构将转到源文件夹 > 包 > java 文件 > 类型 > 方法。与 Mylyn 一起，这实际上非常方便。但是，我觉得Java文件节点是多余的。由于每个文件都包含一个“根”类型，因此在文件节点下总会有一个类型节点显示相同的名称。这只是占用空间并且不会添加任何信息。在此树中仅包含 Java 语言元素会更有意义：包 > 类型 > 成员。当您禁用成员时，将类型节点替换为文件节点以避免必须从文件加载附加信息是有意义的。但是，当启用成员时，它不会。

是否有一些选项可以使包资源管理器跳过文件节点，或者我在这里遗漏了一些基本原理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:24:27.840

我认为如果您探索源代码，**文件**是外观非常重要的一部分。它们不仅可以是 java 文件（不包含类型），还可以包含超过 1 种类型（具有非公共类的文件）等。如果您只是跳过文件名，您将在包级别下拥有一堆类并且不知道是什么类属于什么文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:55:28.883

@Wolfgang，我同意你的理由。在绝大多数情况下，.java 文件与其包含的类型之间存在一对一的映射。虽然在一个 .java 文件中可以有多个顶级类型，但这种做法并不常见，尤其是在内部类型出现之后。可以说，即使您使用多个顶级类型功能，与 .java 文件的显式关系也不是那么重要。如果您删除文件中的所有类型，该文件可能会消失。

不幸的是，没有抑制 .java 文件节点的选项。我怀疑这主要是出于历史惯性的原因。各种导航视图开始作为基本文件导航器可以追溯到很久以前。

我建议打开 Eclipse Java 开发者工具的增强请求。

[https://bugs.eclipse.org/bugs/enter_bug.cgi?product=JDT](https://bugs.eclipse.org/bugs/enter_bug.cgi?product=JDT)

# java - 根据自己的国家/地区显示时间（而不是根据服务器时间）

> ID：12321667
> 
> 赞同：0
> 
> 时间：2012-09-07T16:03:38.700
> 
> 标签：java, date, web-applications, timestamp, simpledateformat

我正在创建需要存储时间戳/日期的 Web 应用程序。

问题是我在其中一个托管站点上托管了我的站点，而托管站点基于美国。存储数据时，存储的是美国时间，而不是我自己国家的时间。

我相信我需要将托管服务器时间设置为我所在国家/地区的时间，或者我需要在保存之前转换时间。我尝试了一些代码，但我没有得到。

有人可以帮我如何在java中转换时间吗？

当我打印

```
 System.out.println(new Date()); 
```

我得到的是美国时间，而不是我现在的时间。我需要将此时间转换为按照我的国家时间（即科威特时间）显示。

## 编辑 1

当我将日期打印为`System.out.println(new Date());`时，我得到输出，`Thu Sep 06 11:07:49 EDT 2012`这意味着我正在获取服务器时间。

现在我想将此时间转换为某个国家/地区时间，比如说科威特或任何其他国家/地区，即同一时间应显示为当前国家/地区。

即国家科威特的时间应该是`Thu Sep 06 19:07:49 AST 2012`

对于印度来说应该是`Thu Sep 06 21:37:49 IST 2012`

## 编辑 2

**措辞更好的问题** ***希望如此***

我使用 JSF 创建了一个 Web 应用程序，我的服务器位于美国。我存储`timestamp`在数据库中。现在在打印时间时，我显然会得到数据库中的时间，即美国数据。

我正在准备要在其中显示数据以及时间的报告。

```
+++++++++++++++++++++++++++++++++++
+   Name    +      Time           +
+++++++++++++++++++++++++++++++++++
+ Name 1    +  10/09/2012 10:11   +
+ Name 2    +  10/09/2012 21:11   +
+ Name 3    +  10/09/2012 17:11   +
+++++++++++++++++++++++++++++++++++ 
```

现在的问题是这些时间是按照美国时间，因此我需要将这些美国时间转换为我所在的国家时间。我需要显示我访问互联网的时间，即如果我在科威特，我需要按照科威特时间安排这些时间。如果我在迪拜访问这些数据，我需要按照迪拜时间显示报告。

有人可以帮助我如何摆脱这些问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:18:49.650

您可能会查看与日期相关的国际化项目。这是一个很好的链接，可能有助于开始。 [国际化](http://java.sun.com/developer/technicalArticles/J2SE/locale/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:12:13.243

`java.util.Date`应该[总是给你 UTC](https://stackoverflow.com/questions/308683/how-can-i-get-the-current-date-and-time-in-utc-or-gmt-in-java)。当您将它放在对它的调用中时，`println`它会转换为本地时间（代码正在执行的地方），因为在`.toString()`对`.println()`.

确保您将日期存储为原始值，并且在此`.toString()`过程中没有被调用（例如当数据库将其转换为分阶段的时间戳时）等。

Jon Skeet（在我引用的答案中）还建议可能使用替代的 datetime 包，这并不完全是您所要求的，但可能至少提供了一些查看问题的替代方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:24:03.007

如果您正在使用时间操作，您应该使用[Calendar](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)对象获取具有 Calendar#getInstance(Timezone) 静态方法的实例，提供与您的时区相对应的 TimeZone 对象。

如果您必须打印具有已定义时区的 Date 对象，请获取[DateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)对象并将其时区设置为与您的喜好相对应的时区。

这是一个示例：

```
SimpleDateFormat dateFormat = new SimpleDateFormat(
                                "yyyy.MM.dd G 'at' HH:mm:ss z", Locale.UK);
dateFormat.setTimeZone(TimeZone.getTimeZone("GMT+1:00")); //London?

String fullDateUK = dateFormat.format(new Date());

System.out.println(fullDateUK); 
```

# javascript - Javascript 正则表达式从字符串中提取年份

> ID：12321672
> 
> 赞同：0
> 
> 时间：2012-09-07T16:03:53.847
> 
> 标签：javascript, jquery, regex, timestamp

我正在尝试使用正则表达式从时间戳中提取年份，但我不是很擅长，所以我的代码没有返回预期的内容。

那是字符串：' **Sun Jan 01 2012 00:00:00 GMT+0000 (GMT)** '

我需要提取“2012”这是我的代码：

```
var scrollDate = tl.getBand(0).getCenterVisibleDate(); // my timestamp

// regex function
function extractNumbers(str) {
     var m = /(^|\s)(\d{4})(\s|$)/.exec(str);
     return m;
}

// click event
$('.n-left').click(function(){
     alert(extractNumbers(scrollDate));
}); 
```

警报框返回：**2012 , ,2012,**

我究竟做错了什么？提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T16:12:27.140

```
var x = new Date("Sun Jan 01 2012 00:00:00 GMT+0000 (GMT)");

 alert(x.getUTCFullYear()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:09:14.627

该正则表达式使用捕获组。如果您查看 的返回值`exec()`，您会发现它看起来像这样：

```
[" 2012 ", " ", "2012", " "] 
```

所以，你可能想写这样的`extractNumbers()`东西：

```
function extractNumbers(str) {
     var m = /(^|\s)(\d{4})(\s|$)/.exec(str);
    if (m) {
        return m[2];
    }
} 
```

FWIW，您可以使用非捕获组对正则表达式的部分进行分组，但只捕获您需要的内容。像这样的正则表达式：

```
/(?:^|\s)(\d{4})(?:\s|$)/ 
```

将返回一个匹配数组，如下所示：

```
[" 2012 ", "2012"] 
```

编辑：……但[詹姆斯克利的回答](https://stackoverflow.com/questions/12321672/javascript-regex-to-extract-year-from-string/12321793#12321793)就像一个更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:11:56.203

首先，它与 RegexBuddy 一起工作（它成功返回组 #1）。

您可能想尝试的另一个正则表达式，对我来说看起来更简单：（`.+?\d\d (\d+)`然后选择第 1 组）

# java - Svnkit + ssh 认证错误 (E170001)

> ID：12321674
> 
> 赞同：1
> 
> 时间：2012-09-07T16:04:02.113
> 
> 标签：java, svnkit

我在这里有点新，但我的代码需要一些帮助。这里是：

```
SVNRepositoryFactoryImpl.setup(); 

    SVNURL url = 
      SVNURL. 
          parseURIEncoded("svn+ssh://xxx"); 
    File keyFile = 
          new File("C://Users/xxxx/Documents/priave_key/private_key.ppk"); 
    System.out.println("PPK file space:"+keyFile.getTotalSpace());
    SVNSSHAuthentication sshCredentials = 
         new SVNSSHAuthentication(Settings.name, keyFile, Settings.pass, 22, false, url, false); 
    System.out.println(sshCredentials.getPrivateKey()==null);
    System.out.println("hasPrivateKey(): "+sshCredentials.hasPrivateKey());
    SVNUserNameAuthentication authorNameCredentials = new SVNUserNameAuthentication(Settings.name, false); 
    SVNPasswordAuthentication passwordCredentials =  new SVNPasswordAuthentication(Settings.name, Settings.pass, false); 

    ISVNAuthenticationManager authManager = 
        new BasicAuthenticationManager(new SVNAuthentication[] { 
                     sshCredentials, 
                     authorNameCredentials, 
                     passwordCredentials}); 
    SVNRepository repository = SVNRepositoryFactory.create(url); 
    repository.setAuthenticationManager(authManager); 

    try { 

        SVNDirEntry info = repository.info("", -1); 
        System.out.println(info); 
    } finally { 
        repository.closeSession(); 
    } 
```

所以在运行这个之后我得到这个输出：

```
PPK file space:107374178304
false
hasPrivateKey(): true
Exception in thread "main" org.tmatesoft.svn.core.SVNAuthenticationException: svn:     E170001: Authentication required for 'xxx@svn+ssh://xxx'
    at     org.tmatesoft.svn.core.internal.wc.SVNErrorManager.authenticationFailed(SVNErrorManager.jav    a:47)
    at     org.tmatesoft.svn.core.internal.wc.SVNErrorManager.authenticationFailed(SVNErrorManager.jav    a:41)
    at 

org.tmatesoft.svn.core.auth.BasicAuthenticationManager.getNextAuthentication(BasicAuthentic    ationManager.java:223)
at     org.tmatesoft.svn.core.internal.io.svn.SVNSSHConnector.open(SVNSSHConnector.java:141)
at org.tmatesoft.svn.core.internal.io.svn.SVNConnection.open(SVNConnection.java:77)
at     org.tmatesoft.svn.core.internal.io.svn.SVNRepositoryImpl.openConnection(SVNRepositoryImpl.j    ava:1252)
at     org.tmatesoft.svn.core.internal.io.svn.SVNRepositoryImpl.info(SVNRepositoryImpl.java:1195)
    at SVNTestNew.main(SVNTestNew.java:40) 
```

我认为这可能是`SVNSSHAuthentication`类的问题，因为它为 null`getPrivateKey()`和 true `hasPrivateKey(`。）或者这是一个错误的想法？谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:28:57.417

根据我的说法，您的公钥和私钥不在适当的位置。

如果您使用的是 Linux 机器，那么对于私钥，您有默认路径：-

```
${USER_HOME}/.ssh/abc.rsa or abc.dsa 
```

你必须将你的公钥存储在服务器上：

默认路径：-

```
${USER_HOME}/.ssh/authorized_keys 
```

你可以改变你的路径`/etc/sshd_config file`

# android - 如何在不使用 XML 的情况下使用 Android R Drawables？

> ID：12321677
> 
> 赞同：0
> 
> 时间：2012-09-07T16:04:06.753
> 
> 标签：android, resources, system, drawable, r.java-file

[http://androiddrawableexplorer.appspot.com/](http://androiddrawableexplorer.appspot.com/) 我希望能够在我的项目中使用这些可绘制对象，但我的项目是在运行时生成的。我只使用 XML 来定义新的活动，因为坦率地说，我讨厌在 java 中使用 XML。我正在寻找与此类似的方法。一种不使用任何 XML 来“findByID”它需要的组件。谢谢你。可绘制的 foo = new Drawable(bar);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:11:07.373

那么，您到底在寻找什么？您想在没有 XML 的情况下在运行时构建活动吗？您是否只想能够操纵 android drawables？

好吧，这就是您使用 android drawables 的方式：

[如何使用默认的 Android 可绘制对象](https://stackoverflow.com/questions/3201643/how-to-use-default-android-drawables)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:07:47.000

你可以使用这个：

```
Drawable d = getResources().getDrawable(id) 
```

# javascript - 使用 javascript 更改表单元素的 ID 值

> ID：12321679
> 
> 赞同：0
> 
> 时间：2012-09-07T16:04:09.590
> 
> 标签：javascript, html

我需要动态更改表单元素的 id。例如，元素以id1、id2、id3、id4的形式排列（元素个数不固定为4个，可以多于4个）。我需要在 id1 之后添加一个元素作为 id2。发生这种情况时，已经在表单中的 id2 应该更改为 id3 并且 id3 应该更改为 id4 等等。我想把它放在一个带有javascript的递归函数中，但到目前为止还没有任何想法......请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:08:30.477

使用 jquery，您可以这样做：您有一些带有“listItem”类和 id 的 html 标签。

```
<div id="1" class="listItem">something </div>
<div id="2" class="listItem">something </div>
<div id="3" class="listItem">something </div> 
```

然后脚本

```
var i = 2;
$(".listItem").each(function() {
     $(this).attr("id", i++);
}); 
```

这应该将内容更改为

```
<div id="2" class="listItem">something </div>
<div id="3" class="listItem">something </div>
<div id="4" class="listItem">something </div> 
```

这将遍历所有具有类“listItem”的标签并更改 id。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:20:27.370

假设您的 html 是这样的：

```
<div id="id1" class="list"></div>
<div id="id2" class="list"></div>
<div id="id3" class="list"></div> 
```

您可以创建一个函数，在中间插入一个新元素，并分两步更新以下所有元素的 id，如下所示：

```
function(insertAfterId) {
  jQuery('#' + insertAfterId).insert('<div id="temp" class="list"></div>');
  var count = 1;
  jQuery('.list').each(function() {
    jQuery(this).attr("id", "id" + count);
    count++;
  });
} 
```

希望有帮助！

# ruby - 应用关闭后禁止对“/”的访问权限

> ID：12321681
> 
> 赞同：1
> 
> 时间：2012-09-07T16:04:23.087
> 
> 标签：ruby, heroku, jekyll, jekyll-extensions

本质上，当您在 Heroku 上的 Jekyll 应用程序一小时内没有访问时，您会在应用程序第一次重新启动时看到以下错误消息：

```
Forbidden

no access permission to `/'
WEBrick/1.3.1 (Ruby/1.9.2/2011-07-09) at franklovecchio.herokuapp.com:80 
```

然后，在页面重新加载后，一切都神奇地好起来了。我不记得在我的其他 Jekyll Heroku 应用程序中看到过这种情况。来源在这里：[https](https://github.com/franklovecchio/frank.lovecch.io) ://github.com/franklovecchio/frank.lovecch.io 。有人看到这个并知道问题是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T19:00:42.320

你只有一个网络工作者吗？只有一个进程的 Heroku 站点会在一个小时不活动后自动进入空闲状态。然后，当访问者访问您的站点时，Jekyll 服务器必须再次启动，但它实际上还没有生成根`index.html`文件，所以您会收到一个“禁止错误”（这是 Jekyll 的内置服务器在运行时返回的内容）尚未完全生成网站）。

# c++ - 如何在 Qt/C++ 中设置 Windows 文件权限

> ID：12321684
> 
> 赞同：3
> 
> 时间：2012-09-07T16:04:24.347
> 
> 标签：c++, winapi, file-permissions, qt4.7

在我在 Qt Creator 2.5.0 中构建的 Qt 4.7.4 x64 C++ 应用程序中，我想为每个人提供文件的完全访问权限。我正在使用`QFile::setPermissions`，我认为它适用于 Mac 和 Linux，但不适用于 Windows。根据[Qt setPermissions not setting permisions](https://stackoverflow.com/questions/5021645/qt-setpermissions-not-setting-permisions)，我应该使用

```
SetNamedSecurityInfoA("C:\file.txt", SE_FILE_OBJECT, DACL_SECURITY_INFORMATION, NULL, NULL, NULL, NULL); 
```

但我不知道如何#include 让它工作。我试过：

```
#ifdef Q_WS_WIN
#include "Windows.h"
#endif 
```

根据我在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379283(v=vs.85).aspx)找到的。但是当我编译时，我得到`C3861: 'SetNamedSecurityInfo': identifier not found`（以及其他一些新错误）。

当我将鼠标悬停在我的 上`#include "Windows.h"`时，我得到了工具提示： `C:\Program Files\Microsoft SDKs\Windows\v7.0\include\Windows.h`，我可以按 F2 并跳转到该文件。我们的项目中还有其他包含相同 Windows.h 的文件，它们编译得很好。

如何在 Windows 上设置文件权限以供所有人读取/写入？如果 SetNamedSecurityInfo 是我想要的（我猜 SetNamedSecurityInfoW 在我的情况下，因为我的用户可能正在运行任何语言的操作系统），我要#include 什么才能使用它？更好的是，我如何确定要#include 的内容，以便我知道下次需要使用 Windows API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:07:59.783

[设置命名安全信息](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379579%28v=vs.85%29.aspx)

> 头文件 Aclapi.h
> 
> 库 Advapi32.lib
> 
> DLL Advapi32.dll

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:08:09.823

在 Google 上进行快速搜索可能会使[该页面](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379579%28v=vs.85%29.aspx)成为热门搜索之一。在那里你可以看到你需要的头文件和库。

# java - 无法在 Rest Web 服务中调用 EJB

> ID：12321687
> 
> 赞同：2
> 
> 时间：2012-09-07T16:04:32.897
> 
> 标签：java, rest, jakarta-ee, dependency-injection, ejb

我有一个休息网络服务。在这个 REST Web 服务中，我`@EJB`用来注入一个 EJB。然后我想在我的 EJB 上调用一个函数。问题是，当我这样做时，整个事情都会爆炸。我创建了一个简单的示例来演示。

我有两个项目。一个是包含我的 EJB 的 ear 项目。

```
 import javax.ejb.Stateless;
import javax.ejb.LocalBean;

/**
 *
 * @author dan
 */
@Stateless
@LocalBean
public class DummyBean {

    public String dummMessage(){
        return "Hello World";
    }
} 

```

另一个是包含我的 Web 服务的战争。

```
 @Stateless
@Path("resources")
public class CasperMessage {

    private final Logger logger = Logger.getLogger(ServerMessageManager.class.getName());

    @Context
    private UriInfo context;

    @EJB
    DummyBean db;

    /**
     * Creates a new instance of CasperMessage
     */
    public CasperMessage() {
    }

    @PUT
    @Consumes("application/xml")
    @Produces("application/xml")
    @Path("/message/get")
    public String getMessage(String content) 
    {
       //Message retVal = serverMessageManager.getMessageRecieved(message);
       String retVal = db.dummMessage();
       return retVal;
    };

} 

```

运行代码时，出现以下异常：

```
 SEVERE: EJB5070: Exception creating stateless session bean : [DummyBean]
WARNING: EJB5184:A system exception occurred during an invocation on EJB DummyBean, method: public java.lang.String com.dv.business.messaging.server.DummyBean.dummMessage()
WARNING: javax.ejb.EJBException: javax.ejb.EJBException: javax.ejb.CreateException: Could not create stateless EJB
    at com.sun.ejb.containers.StatelessSessionContainer._getContext(StatelessSessionContainer.java:454)
    at com.sun.ejb.containers.BaseContainer.getContext(BaseContainer.java:2547)
    at com.sun.ejb.containers.BaseContainer.preInvoke(BaseContainer.java:1899)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:212)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy207.dummMessage(Unknown Source)
    at com.dv.business.messaging.server.__EJB31_Generated__DummyBean__Intf____Bean__.dummMessage(Unknown Source)
    at com.dv.ws.CasperMessage.getMessage(CasperMessage.java:62)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 

```

有什么想法或建议吗？这似乎是一个简单的想法，但它对我不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:43:46.163

我用你的课程创造了简单的战争——一切都很好。
**战争**结构

```
-META-INF/MANIFEST.MF  
-WEB-INF/sun-web.xml  
-WEB-INF/web.xml  
-WEB-INF/classes/com/package/CasperMessage.class  
-WEB-INF/classes/com/package/DummyBean.class  
-index.jsp 
```

**web.xml**

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

    <servlet>
        <servlet-name>ServletAdaptor</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>ServletAdaptor</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
        </welcome-file-list>
    </web-app> 
```

**sun-web.xml**

```
<sun-web-app>
    <context-root>/api</context-root>
</sun-web-app> 
```

*在Glass Fish 3.1*上部署，在*/api/resources/message/get*上发送 PUT 请求，获取响应

# android - AsyncTask 怎么可能正在运行但不工作？

> ID：12321689
> 
> 赞同：0
> 
> 时间：2012-09-07T16:04:39.730
> 
> 标签：android, android-asynctask

我有一个嵌套的 AsyncTask。这个简单的例子证明了它们是有效的：http: [//pastebin.com/0R9Cfxx1](http://pastebin.com/0R9Cfxx1)

但是，在我的生产代码中，我的嵌套 AsyncTask 返回 getStatus == AsyncTask.RUNNING 但 doInBackground() 不执行。

怎么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:24:39.390

我理解 AsyncTask 的方式，你应该从主应用程序线程运行它，这会创建一个单独的线程，在其中运行“doInBackground()”。现在，如果您在另一个 AsyncTask 中运行一个嵌套的 AsyncTask，您总共将至少有三个线程：主应用程序线程、第一个 AsyncTask 线程和第二个 AsyncTask 线程。它们都将并行运行，这打破了“嵌套”的想法。我相信最好的方法是重构您的代码以仅使用一个 AsyncTask。

# php - PHP urlExists 限制时间

> ID：12321690
> 
> 赞同：0
> 
> 时间：2012-09-07T16:05:08.420
> 
> 标签：php, url, time, limit, exists

我正在做一个简单的 web 应用程序，用于显示某些服务器的状态，包括服务器的状态（开/关）。为了检查服务器的状态，我使用了“urlExists”函数，所以如果它返回一个真值，我将该服务器设为在线，在另一种情况下离线。

当我检查服务器时，如果它在线，该功能执行速度很快，但是当我正在检查的服务器离线时，检查下一个服务器需要很长时间。所以我试图限制函数的执行时间，如下所示：

```
...
set_time_limit(1);
$exists = false;
$exists = urlExists($url);
set_time_limit();
... 
```

但是使用 set_time_limit() 的执行时间是相同的。我不知道 set_time_limit 是否用于做这种事情，但它是我唯一创立的。关于我该怎么做的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:23:04.227

试试这个使用 CURL 的函数：

```
function urlExists($url)
{
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 1);

    $exists = curl_exec($ch);
    curl_close($ch);

    // If exec returns boolean, it's false, therefore the server is down/url doesn't exist.
    return !is_bool($exists);
} 
```

如您所见，您可以使用 CURLOPT_CONNECTTIMEOUT 设置连接的时间限制。这样你就不需要 set_time_limit();

# wordpress - wp_enqueue_script 创建致命错误

> ID：12321696
> 
> 赞同：0
> 
> 时间：2012-09-07T16:05:24.473
> 
> 标签：wordpress, wordpress-theming

以下是我的自定义主题代码中的内容。但是，我在将 custom_script 附加到页脚时遇到问题。

```
09    <?php    
10    function my_scripts_method() {
11        wp_enqueue_script(
12            'custom-script',
13            get_template_directory_uri() . '/js/custom_script.js',
14            array('jquery')
15        );
16    }
17    add_action('wp_enqueue_scripts', 'my_scripts_method');
18    ?> 
```

为我产生以下错误。

致命错误：无法在第 10 行的***filename_removed* .php 中重新声明 my_scripts_method()（之前在*****filename_removed*** .php:12 中声明）

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:41:46.037

该错误告诉您您已经有一个名为`my_scripts_method`. 只需更改函数的名称：

```
function my2_scripts_method() {
    // blaa blaa blaa
}
add_action('wp_enqueue_scripts', 'my2_scripts_method'); 
```**

# google-maps - 我正在尝试开发一个房地产网站

> ID：12321699
> 
> 赞同：1
> 
> 时间：2012-09-07T16:05:46.860
> 
> 标签：google-maps, gwt, google-maps-api-3

我正在尝试开发一个房地产网站，并寻找一个地图工具，允许用户提交查询，无论是邮政编码还是地名，结果返回该区域的所有列表以及地图 - 类似于所有其他房产搜索网站。我还需要将搜索范围扩大 1 英里、2、3、5 等的设施

这是否可以通过谷歌地图的标准集成来实现，或者我是否需要绘制各个边界。如果我每天在网站上收到 10,000 个查询，这也是一种经济有效的解决方案吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:16:58.940

您的主要要求是首先根据半径检查位置：

（假设：该位置对一个州和一个国家有效）

您可以使用地点搜索来查找此链接[StakOverflow 中提到的位置：查找位置](https://stackoverflow.com/questions/5300375/to-find-locations-in-google-map-within-5-km-radius-of-a-given-point) ！

在此您可以使用[https://developers.google.com/places/documentation/search?hl=fr](https://developers.google.com/places/documentation/search?hl=fr)获取地点搜索列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:13:51.493

最好的方法是在您的服务器上执行属性搜索，而不是将所有属性加载到 Google 地图上进行搜索。通过将每个属性的纬度/经度存储在数据库中，您可以执行搜索，然后通过在地图上显示结果来返回结果。

# c# - 打印对话框中的页面方向不保留设置

> ID：12321700
> 
> 赞同：0
> 
> 时间：2012-09-07T16:05:48.013
> 
> 标签：c#, .net, vb.net, winforms

我正在做一个 VB 3.0 到 .Net 的转换项目，其中有一些打印活动。

现在，用户会看到一个打印设置对话框，他们可以在其中设置打印机的页面方向和其他设置。

这里的问题是，当应用程序关闭并再次打开时，从 .net printdialog 设置的页面方向似乎总是会重置。换句话说，用户打开应用程序，将打印方向设置为从纵向到**横向**，进行一些打印并关闭应用程序。现在，当重新打开应用程序时，打印方向又是**纵向**的！！（而用户期望它是横向的）。

在 vb 3.0 中，使用了带有一些标志的 commondialog，并且运行良好。

有人可以指导一下。

感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:26:28.963

我不确定 VB3，但你确定它没有在某处保存该设置吗？

您可以在代码中设置打印方向。

```
PrintDialog pDialog = new PrintDialog();
pDialog.PrintTicket.PageOrientation = PageOrientation.Lanscape; 
```

您还应该能够捕捉到用户是否更改了打印对话框上的方向，以便您可以保存他们选择的选项。

```
pDialog.PrintTicket.PropertyChanged += new PropertyChangedEventHandler(PrintPropertyChanged);

private void PrintPropertyChanged(object sender, EventArgs e){
    PageOrientation SelectedPageOrientation = pDialog.PrintTicket.PageOrientation;
    //save the orientation, or save the entire PrintTicket if you want.
} 
```

（我没有对此进行测试，但应该非常接近。）

# maven - scmCommentPrefix 换行

> ID：12321705
> 
> 赞同：3
> 
> 时间：2012-09-07T16:06:28.760
> 
> 标签：maven, maven-release-plugin

我正在尝试让 scmCommentPrefix 按照[http://maven.apache.org/plugins/maven-release-plugin/faq.html#scmCommentPrefix上的文档工作](http://maven.apache.org/plugins/maven-release-plugin/faq.html#scmCommentPrefix)

问题是您添加的任何前缀都连接到各种发布插件注释而没有空格，所以如果我有 scmCommentPrefix=ABCD-123，那么生成的注释看起来像（来自我的 dryRun 尝试）：

```
[INFO] Full run would be checking in 3 files with message: 'ABCD-123prepare for
next development iteration' 
```

文档中提到您可以在带有“ALT 10”或“ALT 13”的前缀中添加换行符 - 有人可以给我一个工作示例吗？因为如果我在引号中添加这些字符串中的任何一个，它们都会按字面意思添加，如果我省略引号，我会收到一个 Maven 错误，抱怨 ALT 的目标无效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T17:50:37.440

对于空格，将参数括在双引号中，例如`-DscmCommentPrefix="ABCD-123 "`. 注意第二个双引号之前的空格。

`-DscmCommentPrefix="ABCD-123\n"`对换行符有用吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-11T11:48:48.050

您可以使用 ${line.separator} 换行。情商

```
-DscmCommentPrefix="ABCD-123${line.separator} 
```

见评论[https://jira.codehaus.org/browse/MRELEASE-156](https://jira.codehaus.org/browse/MRELEASE-156)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-25T22:50:40.407

您可以尝试添加`xml:space="preserve"`为属性属性。这是插件配置示例：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-release-plugin</artifactId>
    <!-- ... -->
    <configuration>
        <scmCommentPrefix xml:space="preserve">ABCD-123 </scmCommentPrefix>
    </configuration>
</plugin> 
```

# iphone - 如何将 iOS 5 SDK 与 Theos 一起使用

> ID：12321707
> 
> 赞同：0
> 
> 时间：2012-09-07T16:06:34.550
> 
> 标签：iphone, objective-c, ios, xcode, tweak

我最近想做一个使用 iOS 5 Twitter 框架的调整，所以我从我的 Xcode.app 获取标题并将它们粘贴到 /opt/theos/include/Twitter/ 但是当我在我的 makefile ld 中添加 Twitter 作为框架时显示我关于找不到 twitter 框架的错误。我怎么解决这个问题？有没有办法将 iOS 5 SDK 移植到 theos 而不会搞砸事情？谢谢。

如果有人想看到这里正在编译的代码是一个 Github 项目，我试图编译但失败并出现同样的错误。链接是[https://github.com/mergesort/QuickTweet](https://github.com/mergesort/QuickTweet)

~iHackerMe

# android - c2dm 在 gcm 注册后收到 NotRegistered

> ID：12321708
> 
> 赞同：3
> 
> 时间：2012-09-07T16:06:37.733
> 
> 标签：android, android-c2dm, google-cloud-messaging

我在使用 c2dm 时遇到了一个非常奇怪的问题。看到它已被弃用，我已经开始迁移到 gcm 的过程。由于这个产品的设计，我不能简单地注册 gcm 并将新的注册 id 发送到我的后端而忘记 c2dm。我需要同时在手机上为我的应用注册 c2dm 和 gcm。我是两个独立的发件人帐户，一个用于 c2dm，一个用于 gcm。

问题是，如果有一个现有的 c2dm 注册，然后我注册 gcm，则进一步向 c2dm 注册 ID 推送通知将收到来自谷歌的 NotRegistered。如果我同时注册 c2dm 和 gcm，两者都可以正常工作大约一个小时，此时我突然开始在 c2dm 帐户上从谷歌获得 NotRegistered。gcm 推送继续正常工作。

有人遇到这样的事情吗？

# javascript - 如何检查功能是否将运行或可用？

> ID：12321709
> 
> 赞同：0
> 
> 时间：2012-09-07T16:06:37.230
> 
> 标签：javascript, jquery

我正在调用这样的函数：

```
$.myFunction 
```

根据用户可能拥有函数所在的 .js 文件的版本，函数可能无法成功调用，因为它不存在。如果这个函数没有运行，我只想忽略任何抛出的错误并继续执行。一种解决方法是将函数包装在 try/catch 中：

```
try {
$.myFunction
}
catch(e){
} 
```

但对我来说，以这种方式使用 try/catch 似乎是一种不好的做法。是否有 jQuery/javascript 方法在运行之前检查函数是否存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:09:52.787

在调用它之前检查：

```
typeof $.myFunction == 'function' && $.myFunction(); 
```

有条件地声明函数也很典型：

```
$.myFunction = $.myFunction || function () { ... }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:07:55.813

我假设您将函数称为

```
$.myFunction(); 
```

你可以测试

```
if ($.myFunction) { 
```

但是不得不在图书馆这样做有点奇怪。你自己不包括吗？尝试处理任何版本的库，就好像它是完整的一样，似乎很危险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:10:09.423

您可以使用 jQuery 函数: [`$.isFunction`](http://api.jquery.com/jQuery.isFunction/):

```
if($.isFunction($.myFunction)) {
    // it exists and it is function
} 
```

# c# - 从 dll 中捕获 C# 中的标准输出

> ID：12321720
> 
> 赞同：3
> 
> 时间：2012-09-07T16:07:22.710
> 
> 标签：c#, .net, threadpool, named-pipes

我正在尝试使用以下代码将盲 printf 从 dll 捕获/重定向到 WPF 文本框。

dll：

```
#include <stdlib.h>
#include <string.h>
#include "stdafx.h"
#define EXTERN_DLL_EXPORT __declspec(dllexport)

extern "C" EXTERN_DLL_EXPORT int startPipe()
{
    setvbuf(stdout, NULL, _IONBF, 0);
    printf("hey");
    return 20;
}

//Morepipe2, etc just return different test words. 
```

C#代码：

```
using System;
using System.Diagnostics;
using System.IO;
using System.IO.Pipes;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows;

namespace PipeTest {

public partial class MainWindow : Window {
    private NamedPipeServerStream serverPipe;
    private NamedPipeClientStream clientPipe;
    private int id;
    private StreamReader stm;
    private HandleRef hr11;
    private String txt;

    private delegate void updateCallback(string pipetext);

    [DllImport("kernel32.dll", SetLastError = true)]
    protected static extern bool SetStdHandle(int nStdHandle, IntPtr hConsoleOutput);

    public MainWindow() {
        InitializeComponent();

        id = Process.GetCurrentProcess().Id; // make this instance unique
        serverPipe = new NamedPipeServerStream("consoleRedirect" + id, PipeDirection.In, 1);
        clientPipe = new NamedPipeClientStream(".", "consoleRedirect" + id, PipeDirection.Out, PipeOptions.WriteThrough);
        ThreadPool.QueueUserWorkItem(state => {
            serverPipe.WaitForConnection();
            using (stm = new StreamReader(serverPipe)) {
                while (serverPipe.IsConnected) {
                    try {
                        txt = stm.ReadLine();
                        if (!string.IsNullOrEmpty(txt))

                            UpdateElement(txt + "\n");
                    } catch (IOException) {
                        break; // normal disconnect
                    }
                }
            }
        }, null);
        clientPipe.Connect();
        hr11 = new HandleRef(clientPipe,
         clientPipe.SafePipeHandle.DangerousGetHandle());
        SetStdHandle(-11, hr11.Handle); // redirect stdout to my pipe

        PipeServer.morePipe1();
        PipeServer.morePipe2();

        PipeServer.startPipe();
        PipeServer.morePipe1();
        PipeServer.morePipe2();
        Thread.Sleep(10000);
        PipeServer.startPipe();
        PipeServer.startPipe();
    }

    private void ender() {
        //clientPipe.Dispose();
        //serverPipe.Dispose();
    }

    private void button1_Click(object sender, RoutedEventArgs e) {
        PipeServer.startPipe();
    }

    private void button2_Click(object sender, RoutedEventArgs e) {
        PipeServer.morePipe1();
    }

    private void button3_Click(object sender, RoutedEventArgs e) {
        PipeServer.morePipe2();
    }

    private void UpdateElement(string pipetext) {
        if (textBox1.Dispatcher.CheckAccess() == false) {
            updateCallback uCallBack = new updateCallback(UpdateElement);
            this.Dispatcher.Invoke(uCallBack, pipetext);
        } else {
            textBox1.Text += pipetext;
        }
    }
}

public static class PipeServer {

     private const CallingConvention conv = CallingConvention.StdCall;

    [DllImport(@"PipeServer2.dll", CallingConvention = conv)]
    public static extern int startPipe();

    [DllImport(@"PipeServer2.dll", CallingConvention = conv)]
    public static extern int morePipe1();

}
} 
```

这段代码不能像现在这样工作。但是这些是我的问题：

1.  如果模块级别的私有变量被移动到 mainwindow()，它将工作并显示文本框的所有内容。只要它们在 mainwindow() 中，我就可以在 dll 中调用多个方法并显示输出。
2.  即使它确实有效，一旦 mainwindow() 完成，当我单击调用 dll 的按钮时，它不再记录任何输出。我的期望是按钮应该调用 dll，并且应该有数据写入标准输出/管道，并且线程仍然应该拾取它（我错了吗？）。我认为制作变量模块级别会有所帮助，但如果我这样做，我不会得到任何结果。

# bash - 为什么 grep 从 bash 脚本执行时会丢失彩色输出？

> ID：12321731
> 
> 赞同：16
> 
> 时间：2012-09-07T16:08:07.483
> 
> 标签：bash, colors, grep

> **可能重复：**
> [从 bash 脚本运行时 grep 失去颜色](https://stackoverflow.com/questions/9550885/grep-loses-coloring-when-run-from-bash-script)

`grep`我有一个简单的 bash 脚本来在我的结果之上打印一个标题：

```
#!/bin/bash

for var in "$@"
do
    if [[ $var != -* ]];
    then
        break 
    fi
done

echo
echo -en "\e[1;31m     ====== GREP $var ======\e[0m\n"
echo

grep $@ 
```

`grep`但是最终的命令在某种程度上与直接从提示符实际运行不同，因为结果中缺少颜色。直接执行时`grep`，结果以紫色显示文件名，以红色显示匹配项，但现在所有输出都是正常的终端文本颜色。有人可以告诉我如何从我的脚本中获取彩色版本吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-07T16:12:17.330

看起来 grep 在不处于交互模式时不会产生颜色。您可以强制它产生彩色输出：

```
grep --color=always $@ 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-07T22:24:43.980

Grep 有 3 种颜色模式，Auto、Always 和 Off。

Auto strips out the codes when it's connected to a non interactive output, such as a pipe (if you want to see why, try redirecting the output of `grep --color=always` into a file and then look at the file.. control codes everywhere)

# mysql - 如何查询结果以仅显示时间戳小于给定年份的用户 ID

> ID：12321735
> 
> 赞同：3
> 
> 时间：2012-09-07T16:08:12.053
> 
> 标签：mysql, sql, distinct

我有一个存储用户回答的所有数据的表。我试图找出自 2012 年 1 月 1 日以来哪些 user_id 没有更新系统中的任何内容。

每个用户在数据库中将有大约 500 个 item_id。我正在尝试处理的查询将返回自给定年份以来未更新其数据的每个用户的 DISTINCT user_id。并非所有 item_id 都必须更新，因此如果任何 item_id 的 dt 大于我试图查找的日期时间，那么我需要忽略它们，即使它是 1 条记录。我只想要自 2012 年以来未更新单个字段的 user_id。

任何帮助或推动正确的方向表示赞赏。

谢谢！

**桌子**

```
CREATE TABLE IF NOT EXISTS `item_results` (
`item_id` int(11) NOT NULL DEFAULT '0',
`user_id` int(11) NOT NULL DEFAULT '0',
`result` text NOT NULL,
`specifier` text NOT NULL,
`dt` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
UNIQUE KEY `item_id` (`item_id`,`user_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:13:42.553

怎么样？

```
select user_id, max(dt)
from item_results
group by user_id
having max(dt) < '2012-01-01' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:12:49.293

您需要创建一个子查询来获取它们的最新`dt`值（*MAX VALUE*），如下所示（*如果您想获取用户上次更新的**所有列***，它可以工作。 ）

```
SELECT  a.*
FROM item_results b
        INNER JOIN
        (
            SELECT user_id, MAX(`dt`) lastUpdated
            FROM item_results
            GROUP BY userID
        ) a ON a.user_ID = b.user_ID AND
               a.lastUpdated = b.`dt`
WHERE DATE(a.lastUpdated) < '2012-01-01' 
```

或者简单地说（*您正在寻找的那个。*）

```
SELECT user_id
FROM item_results
GROUP BY userID
HAVING DATE(MAX(`dt`)) < '2012-01-01' 
```

希望这可以帮助。

![在此处输入图像描述](../Images/f8278614b13f21576b9cb513378852b6.png)

# c++ - c++推导出函数指针类型

> ID：12321736
> 
> 赞同：1
> 
> 时间：2012-09-07T16:08:18.233
> 
> 标签：c++, templates, function-pointers

是否可以从函数参数中推导出~~非类型~~ *函数指针类型*模板参数~~（函数指针）~~？

```
template <void(*fptr)()>
  void test(void(*fp)()) { fp(); } 
```

要调用此函数，我必须显式声明函数模板参数：

```
test<somefunc>(somefunc); 
```

我知道我也可以这样做：

```
template <void(*fptr)()>
  void test() { fp(); }

test<somefunc>(); 
```

但我只是想知道是否可以这样做：

```
template <void(*fptr)()>
  void test() { fp(); }

test(somefunc); 
```

是否可以以编译器（GCC 4.7）将从函数参数中推断出来的方式声明？

非常感谢提前，真的想知道如何做到这一点。-布莱恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:10:07.620

> 是否可以从函数参数中推断出非类型模板参数（函数指针）？

不，函数参数是运行时实体，模板参数是编译时实体。要推断，必须在运行时推断出这样的模板参数，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:19:51.950

Bryan，这似乎是低级 C 和 C++ 的古怪组合。你为什么需要那个？为什么不使用函子？

```
struct clean
{
    void operator() () 
    {
        // do something here        
    }
};

template <typename FuncType> void call_func(FuncType func)
{
    func();
}

// here is how to pass 'clean' to be called
call_func(clean()); 
```

更多关于函子，例如，这里：[http ://www.cprogramming.com/tutorial/functors-function-objects-in-c++.html](http://www.cprogramming.com/tutorial/functors-function-objects-in-c++.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:31:44.973

我这可能会做你想要的：

声明一个还没有函数类型的基本模板：

```
template <typename T> void test(T fp) { printf("function signature not supported\n"); } 
```

专门用于函数类型（主要是参数数量）：

```
typedef void(fptr0)();
template <> void test(fptr0 fp) { fp(); }
typedef void(fptr1)(int);
template <> void test(fptr1 fp) { fp(1); } 
```

声明一些具有不同签名的测试函数：

```
void myfn0() { printf("hi 0\n"); }
void myfn1(int x) { printf("hi 1:%i\n",x); }
void myfnD(float y) { printf("hi D %f\n",y); } 
```

现在执行它们：

```
int main(int,char**) {
   test(myfn0);
   test(myfn1);
   test(myfnD);
   return 0;
} 
```

结果：

```
hi 0
hi 1:1
function signature not supported 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T16:46:31.270

这是你要找的吗？

```
#include <iostream>

typedef void (*fptr)();

void f() {
    std::cout << "hello, world\n";
}

template <class fptr> void g(fptr fp) {
    fp();
}

int main() {
    g(f);
    return 0;
} 
```

# php - 当他喜欢页面选项卡时将用户重定向到另一个页面

> ID：12321737
> 
> 赞同：1
> 
> 时间：2012-09-07T16:08:26.100
> 
> 标签：php, facebook, api

我有这个代码块工作，但不再......

索引.php

```
<!doctype html>
<?php
require 'php-sdk/src/facebook.php';
$facebook = new Facebook(array(
            'appId' => '453976824647366',
            'secret' => 'fe86f3b0b34b3ed6eXXXXXX',
            'cookie' => true,
        ));

$signedRequest = $facebook->getSignedRequest();
$liked = $signedRequest["page"]["liked"];

        if ($liked) {
            header('Location:youlike.php');
        } else {
            echo "you don't like";
        }
?>
<html lang="en" xmlns:fb="https://www.facebook.com/2008/fbml">
    <head>

    </head>
    <body>

    </body>

</html> 
```

你喜欢.php

```
You like! 
```

它总是显示“你不喜欢”，似乎它永远不会进入 youlike.php

再次感谢一些帮助！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T09:20:09.107

尝试这个：

```
<!doctype html>
<?php

if (!empty($_POST['signed_request'])) {
    list($sig, $payload) = explode('.', $_POST['signed_request'], 2);
    $decoded = json_decode(base64_decode(strtr($payload, '-_', '+/')), true);
    $liked = $decoded["page"]["liked"];
}

if ($liked) {
    header('Location:youlike.php');
    exit;
}
else {
      echo "you don't like";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:11:56.250

因为您在 iframe 中，所以您需要在最顶层的框架上执行重定向。

试试这个 JavaScript -

```
top.location.href = "youlike.php"; 
```

使用 php，您可以简单地回显出这样的代码 -

```
echo '<script type="javascript">';
echo 'top.location.href = "'.$youlike.'";';
echo '</script>';
exit(); 
```

根据您的前/后类似页面的复杂性，您可能希望将所有内容简单地放在一个页面上，并且仅在用户“喜欢”该页面时才显示其中的某些部分。

```
if ($liked) {
  // place like post page HTML here
} else {
  // place like pre page HTML here
} 
```

# javascript - 制作按钮切换 div 的类

> ID：12321738
> 
> 赞同：0
> 
> 时间：2012-09-07T16:08:27.427
> 
> 标签：javascript, class, html, twitter-bootstrap

我正在使用 Twitter Bootstrap 制作一些基本网站

我有一个 div 和两个要使用的类。我想实现将更改 div 的类的按钮，然后再次单击后将其更改回来。

找到了很多方法，但没有一个能改回来。最好的方法是使用 Bootstrap JS 或 Jquery

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:12:27.883

演示 1： http: [//jsfiddle.net/Jsqh4/](http://jsfiddle.net/Jsqh4/)
演示 2（单独的按钮）：http: [//jsfiddle.net/Jsqh4/1/](http://jsfiddle.net/Jsqh4/1/)

Bootstrap 使用 jQuery 作为其组件，因此 jQuery 解决方案对您来说可能是最简单的。

```
<style>
    .style1{ background-color: yellow; }
    .style2{ background-color: green; }​
</style>

<div id="div1" class="style1">
    Here is a div.
</div>

<input type="button" id="btn1" value="Click Me" />

<script>
    $("#btn1").click(function(){
        $("#div1").toggleClass("style2");
    });
</script> 
```

另见：[http ://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T09:13:27.603

不幸的是，没有足够的代表评论接受的答案......

我会切换这两个类以避免丢失某些未被覆盖的样式的风险。

```
<style>
    .style1{ background-color: yellow; }
    .style2{ background-color: green; }​
</style>

<div id="div1" class="style1">
    Here is a div.
</div>

<input type="button" id="btn1" value="Click Me" />

<script>
    $("#btn1").click(function(){
        $("#div1").toggleClass("style1");
        $("#div1").toggleClass("style2");
    });
</script> 
```

# phpunit - 使用 selenium2 和 phpunit 实现 selenium ide

> ID：12321745
> 
> 赞同：2
> 
> 时间：2012-09-07T16:09:09.277
> 
> 标签：phpunit, selenium-webdriver, selenium-ide

如何将 selenium ide 与 selenium2 和 phpunit 一起使用？有人可以给我一些建议吗？

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T14:46:28.740

有一个 PHPUnit 扩展：

[https://github.com/sebastianbergmann/phpunit-selenium](https://github.com/sebastianbergmann/phpunit-selenium)

但它几乎完全没有文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:10:02.927

一般步骤：

1.  安装 IDE。
2.  通过 IDE 运行并保存测试用例。
3.  [http://seleniumhq.org/download/](http://seleniumhq.org/download/)
4.  不幸的是，seleniumide1.9 支持 selenium2 命令，原生语言支持 ruby​​、java、c#、python 但不支持 php
5.  因此，您必须使用 php.ini 下载页面中提到的开源库之一。

# appfabric-cache - Windows 应用程序结构缓存

> ID：12321746
> 
> 赞同：0
> 
> 时间：2012-09-07T16:09:11.937
> 
> 标签：appfabric-cache

我正在使用带有多个命名缓存的 Windows AppFabric 缓存。可以为每个命名缓存设置单独的过期策略。

如果可能，请让我知道如何通过配置文件实现这一点。

示例代码

```
 <add name="AFCM" type="CelloSaaS.Library.Provider.AppFabricCacheManager, CelloSaaS.Library" RequestTimeout="600"
  RoutingClient="false" LocalCache="true" HostName="192.168.21.3"
  CachePort="22233" CacheHostName="DistributedCacheService" NamedCache="AFCM" InvalidationPolicy="TimeoutBased" DefaultTimeOut="86400"  SecurityMode="None" ProtectionLevel="None" MaxBufferSize = "10000000" />

  <add name="ICM" type="CelloSaaS.Library.Provider.AppFabricCacheManager, CelloSaaS.Library" RequestTimeout="600"
  RoutingClient="false" LocalCache="true" HostName="192.168.0.01"
  CachePort="22233" CacheHostName="DistributedCacheService" NamedCache="ICM" InvalidationPolicy="TimeoutBased" DefaultTimeOut="86400"  SecurityMode="None" ProtectionLevel="None" MaxBufferSize = "10000000" /> 
```

请注意，根据代码，我猜第三个标签中指定的策略是针对名为 AFCM 的命名缓存。请在这方面澄清我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:31:40.700

是的，有可能 ！我强烈建议尝试使用这个很棒的工具：[Appfabric 1.1 的 GUI 管理员](http://appfabricadmin.codeplex.com/)

如果你是 powershell 用户，你可以试试

```
Set-CacheConfig YourCacheNameHere -Expirable true -TimeToLive 5 
```

（取自[http://msdn.microsoft.com/en-us/library/ff921014.aspx](http://msdn.microsoft.com/en-us/library/ff921014.aspx)）

# java - Java 类加载器层次结构

> ID：12321749
> 
> 赞同：1
> 
> 时间：2012-09-07T16:09:40.470
> 
> 标签：java, classloader, hierarchy

关于类加载有非常好的[文章。](http://www.objectsource.com/j2eechapters/Ch21-ClassLoaders_and_J2EE.htm)但这在我脑海中打开了许多问题。

我了解类加载器（Bootstaper、Extension、System）的层次结构，但我的问题是它们是以这种方式扩展的真正类吗？如果是

1.  我可以查看这些类的 Java Doc 吗？
2.  这些类与“java.lang.ClassLoader”类有什么关系

如果不是，它们是什么（实例？）以及层次结构是如何定义的？

如果我错过了一个完整的大概念，你可能想引用我的一些好文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:14:40.213

正如您已经说过的，自定义类加载器只是 Java 对象的实例。

```
Can I see the Java Doc of these classes? 
```

是的，如果你有源代码或 JavaDocs，就像任何其他类一样。

```
What is the relationship of these classes with class "java.lang.ClassLoader" 
```

`ClassLoader`是所有具体类加载器扩展的抽象基类。这种类加载器的一个例子是`java.net.URLClassLoader`and `java.security.SecureClassLoader`。

# jquery - Jasmine maven 插件和 jasmine-jquery 不同的结果

> ID：12321752
> 
> 赞同：3
> 
> 时间：2012-09-07T16:09:52.227
> 
> 标签：jquery, maven, jasmine, jasmine-jquery, jasmine-maven-plugin

我的项目是标准的 maven java 项目。我正在尝试将 jasmine-maven 插件包含到我的 CI 中。但是当我运行 command 时`mvn clean install`，它会正确运行测试。但是，如果我`mvn jasmine:bdd`从浏览器运行并运行测试。我的 html 装置未加载。

这是我的项目结构。

```
 project
  |
  |-src
    |-main
    |-test
       |-java
          |-javascript
               |-jasmine
                    |-spec
                       |-spec.js
                       |-javascripts
                       |   |-fixtures
                       |       |-all_the_fixtures.html
                       |-lib
                          |-jasmine-jquery-1.3.1.js 

```

这是我的 pom.xml

```
 <plugin>
                    <groupId>com.github.searls</groupId>
                    <artifactId>jasmine-maven-plugin</artifactId>
                    <version>1.2.0.0</version>
                    <extensions>true</extensions>
                    <executions>
                        <execution>
                            <goals>
                                <goal>
                                 test
                                </goal>
                            </goals>
                        </execution>
                    </executions>
                    <configuration>
                        <skipTests>false</skipTests>
                        <jsSrcDir>${basedir}/src/main/webapp/static/js</jsSrcDir>
                        <jsTestSrcDir>${basedir}/src/test/java/javascript/jasmine/spec</jsTestSrcDir>
                        <sourceIncludes>
                            <include>jquery/jquery-min.js</include>
                            <include>src/source.js</include>
                            <include>src/source1.js</include>
                        </sourceIncludes>
                        <specIncludes>
                            <include>lib/*.js</include>
                            <include>**/*.js</include>
                        </specIncludes>
                    </configuration>
                </plugin> 
```

当我从浏览器运行测试时。所有的 html 固定装置都是 404。有没有办法让两种方式都起作用？

这就是我加载夹具的方式

```
 it("should get content group with one breadcrumb", function() {
    loadFixtures("all_the_fixtures.html");
}); 

```

这是我的 jasmine-jquery 路径配置

```
 this.fixturesPath = 'spec/javascripts/fixtures/'; 

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-22T21:28:30.663

我意识到这是一个老问题，只想在这里记录我的发现。我正在努力让一些相同的东西启动并运行自己。我发现运行 bdd 目标时路径是相对于项目的基础，而不是您创建的 jasmine 文件夹。这种结构可能会在 OP 的环境中工作。

```
project
|
|-spec
|  |-javascripts
|     |-fixtrues
|        |-all_the_fixtures.html
|-src
   |-main
   |-test
      |-java
      |-javascript
         |-jasmine
         |-spec
            |-spec.js
            |-javascripts
               |-lib
                  |-jasmine-jquery-1.3.1.js 
```

据我所知，这是一个[已知问题。](https://github.com/searls/jasmine-maven-plugin/issues/36)

[这是一篇关于如何使用配置文件解决它的帖子。](http://www.jayway.com/2012/04/17/configuring-jasmine-to-work-with-maven-and-jquery-fixtures/)基本上，您为 Jasmine 插件的每个目标创建一个配置文件。希望这可以帮助某人...

# c# - 静态对象的非静态方法的参数会被多个线程共享吗？

> ID：12321755
> 
> 赞同：5
> 
> 时间：2012-09-07T16:10:05.000
> 
> 标签：c#, multithreading

（为简洁起见，以下所有内容均已简化）

我有一个对处理对象的静态引用。

处理器包含一个函数，我可以将对象包传递给该函数，这是要处理的信息。

包来自应处理的大量包的列表。这些包是独一无二的；这里没有对同一个对象的多个引用。

我启动了许多线程，以便可以并行处理 toProcess 中的包。线程 Pop() 从 toProcess 堆栈中获取一个可用的包，直到堆栈为空。

我现在的问题是：我可以冒险`package`in`Check`被另一个线程覆盖，还是另一个线程会“创建一个副本” `Check`？

```
static class Program
{
    static Processor processor = new Processor();
    static Stack<Package> toProcess;
    static Object sync = new Object();

    static void RunThreads()
    {
        toProcess = GetPackages();
        //start many threads using the Work delegate
    }

    static void Work()
    {
        while(true)
        {
            Package p;
            lock(sync)
            {
                if(toProcess.Count == 0)
                   break;
                p = toProcess.Pop();
            }
            processor.Check(p);
        }
    }
}

class Processor
{
    public void Check(Package package)
    {
        //do many analyses on p and report results of p's analysis to elsewhere
    }
}

class Package
{
    //properties
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:18:32.787

> 我现在的问题是：我可以冒险检查 Check 中的包被另一个线程覆盖，还是另一个线程会“创建 Check 的副本”？

您的意思不是很清楚，但是每个独立的调用`Check`都会有自己的`package`变量。该变量不仅对于该线程是本地的，而且对于`Check`（因此递归调用也不会更改它）的调用是本地的。

现在，如果您在多个不同的线程中传递相同的`Package`引用`Check`，那么是的，它们都将处理同一个对象，这可能会导致问题。但是`package`变量*本身*在不同的调用中是独立的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:13:46.953

If`Package`是 a `class`，即引用类型，并且如果`Check`您执行一些写操作，是的 - 您*必须*使用锁定机制管理对它的访问。

另一方面：如果`Package`是值类型，它将*通过 value*传递给函数。如果`Check`只*读取*信息（即使`Package`是引用类型），则无需担心锁定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:19:23.713

由于您保证不能从多个线程中弹出堆栈的包，因此只要堆栈中的包都不相同，就不会有问题。

`Check`但是，如果方法更改了`Processor`' 状态，则应在方法中执行锁定。

# android - 如果存在导入，则出现 android.R 错误

> ID：12321761
> 
> 赞同：0
> 
> 时间：2012-09-07T16:10:18.480
> 
> 标签：android, mobile

我刚刚完成了我的一个应用程序的调试，因为我遇到了 R.layout 问题。

自然地，我去了我的 .xml 文件并清理了一些错误，一切都应该没问题，但事实并非如此。

出于某种原因，我仍然收到 R.layout 错误，说我的 .xml 文件无法解析为类型。

一旦我删除了 import android.R 语句，一切都消失了，我的程序编译正确。

据我所知，这与人们在这种情况下所说的相反。通常他们会告诉您添加该语句以消除任何错误，但我的情况恰恰相反。有没有人知道为什么会发生这种情况，这样当这种情况不可避免地再次发生时，我就不必花太多时间在上面了？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:16:46.487

您正在导入一个不包含应用程序布局资源的 R。相反，您正在导入 Android 框架的 R，从而导致名称冲突。但是，在某些情况下您可能需要 android.R。在这些情况下，您不应导入 android.R，而应在需要时显式使用 android.R.[whatever]。

您的应用程序拥有自己的 R，其中包含*您*应用程序的大部分资源。

android.R 包含各种*Android 框架*资源。

Android中关于R类的更多信息[：什么是R？](https://stackoverflow.com/a/4953282/1253844)问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:16:16.587

有两个`R`：你的项目一个和`android.R`一个。你导入错了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:16:45.173

不应导入 android.R。这是系统的 R.java 不是你的项目的。通过导入 android.R，您实际上隐藏了您自己的 R.java，这就是它无法解析其中的值的原因。因此，正如您（正确地）所做的那样，应该将 android.R 从您的导入列表中删除。如果您需要在您的应用程序中使用它，您可以像这样使用它：

```
android.R.layout.xxx 
```

# c++ - 测试opencv warpAffine异常值的数量

> ID：12321767
> 
> 赞同：1
> 
> 时间：2012-09-07T16:10:34.207
> 
> 标签：c++, opencv, affinetransform, outliers, ransac

我正在使用 opencv 来估计两个图像之间的仿射变换（我们称之为 A 和 B，我想从 A 估计到 B），我需要实现 RANSAC 以获得可能的最佳估计。到目前为止，我的 RANSAC 框架（考虑到我已经有了两个图像的关键点以及它们之间的匹配）：

1：选择3个随机匹配，将A和B的匹配点作为getAffineTransform函数的输入；

2：使用函数warpAffine对A的点进行warp，并将结果与​​B的点进行比较，得到异常值率：e；

3：考虑到我的样本大小是 3 个点（getAffineTransform 需要 3 个点才能找到变换），并且我有异常值 e 的比率，我可以找到我需要运行 RANSAC 的次数才能找到一个很高的概率好的估计，是N次；

4：重新运行第 1 步和第 2 步 N 次，保持具有最小异常值率的变换；

虽然基本的想法似乎很好，但我在执行时遇到了一些问题，特别是第 2 步。我的问题是，我不确定如何测试异常值的数量。我考虑过使用 warpAffine 将 A 的点映射到 B，但我几乎可以肯定它不会起作用，因为我相信该函数会解释我的点垫（这是一个 Mx2 垫，M 是点数，每个将点的坐标 x 和 y 列为图像，而不是我要映射的一组点。我怎样才能做到这一点？

我正在使用带有 c++ 的 opencv 2.4.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T20:20:53.253

回答我自己的问题，我实际上找到了一种方法。我不确定这是不是最好的方法，但根据我到目前为止所做的测试，它似乎工作正常。

正如这里所解释的

[http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html#warp-affine](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html#warp-affine)，

仿射变换是一种可以表示为矩阵相乘的变换。因此，应用转换只需将我的点乘以从 getAffineTransform 获得的矩阵。在映射单个点之前，我们需要在要映射的点上附加一个“1”并将其转置（因此我们有列向量），然后通过将其乘以变换矩阵进行映射。如果我们将 Mx2 点矩阵转换为以下形式的 3xM 点矩阵，我们可以轻松地为每个点扩展此映射：

```
|x1, x2, x3, ...., xM|
|y1, y2, y3, ...., yM|
| 1,  1,  1, ....,  1| 
```

并乘以变换矩阵！稍后我可能会使用一个简单的测试程序来编辑这篇文章，以展示它是如何工作的。

此外，为了附加这个向量并转置它，我正在执行以下操作：

```
1 - Create a new 3 x M matrix consisting of ones with Mat::ones, named newPtMat
2 - transpose my original point matrix, and keep it in a temp Mat
3 - use temp.copyTo(newPtMat.rowRange(0, 2) 
```

我不确定这是最有效的方法，所以如果有人有更好的建议，请发表评论！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-02T11:43:48.243

有一个名为“findTransformsECC”的新功能可用于查找两张图片之间的仿射变换扭曲矩阵，[http ://docs.opencv.org/3.0-beta/modules/video/doc/motion_analysis_and_object_tracking.html#findtransformecc](http://docs.opencv.org/3.0-beta/modules/video/doc/motion_analysis_and_object_tracking.html#findtransformecc)

我认为它在 Opencv 3.0 + 中可用

# php - 如何增加 Zend Java Bridge 日志的详细程度？

> ID：12321771
> 
> 赞同：1
> 
> 时间：2012-09-07T16:10:53.643
> 
> 标签：php, zend-framework, zend-server, php-java-bridge, java-bridge-method

是否可以使用 watchdog-jb.ini 中的一些指令来增加日志的详细程度？

我可以启用文件日志记录，将此指令的值从 0 更改为 1：-Dzend.javamw.log=0 并添加这个：-Dzend.javamw.logfile=/usr/local/zendsvr/var/log/javamw。日志

但记录的信息很差。

米尔科

# node.js - Mongoose 报告写入成功，数据库中没有任何内容

> ID：12321772
> 
> 赞同：1
> 
> 时间：2012-09-07T16:11:00.073
> 
> 标签：node.js, mongodb, express, mongoose

当我通过控制台与 Mongo 交互时，猫鼬成功回调正在运行，但我的数据库中没有出现任何内容。

任何人都可以帮助解释为什么数据库中没有出现任何内容吗？

应用程序.js

```
var express = require('express')
  , routes = require('./routes')
  , user = require('./routes/user')
  , http = require('http')
  , path = require('path')
  , mongoose = require('mongoose');

var app = express();

var TimesheetsController = require(__dirname + '/controllers/timesheets');
var UsersController = require(__dirname + '/controllers/users');

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('your secret here'));
  app.use(express.session());
  app.use(app.router);
  app.use(require('stylus').middleware(__dirname + '/public'));
  app.use(express.static(path.join(__dirname, 'public')));
});

app.configure('development', function(){
  app.use(express.errorHandler());
});

app.get('/', routes.index);

app.get('/timesheets', TimesheetsController.list);
app.post('/timesheets', TimesheetsController.add);
app.get('/users', UsersController.list)

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

timesheet.js 控制器

```
var TimesheetsModel = require('../models/timesheets');

var TimesheetsController = {

    list : function(req, res){
        TimesheetsModel.listTimesheetsByUser(function(){res.render('timesheets/index', { title: 'Timesheets',timesheets: {} });});
    },
    add : function(req, res){
        TimesheetsModel.newTimesheet(10, req.body, function(err){ 
                                                        if(err){
                                                            res.json({'message':'failed.'})
                                                        }else{
                                                            res.json({'message':'success!'})
                                                        }; 
                                                    });
    }
}

module.exports = TimesheetsController; 
```

timesheet.js 模型

```
var mongoose = require('mongoose')
  , Schema = mongoose.Schema
  , ObjectId = Schema.ObjectId;

var db = mongoose.createConnection('localhost', 'timetracker');

var TimesheetSchema = mongoose.Schema({
  'date': Date,
  'lines': [ {any: Schema.Types.Mixed} ],
  'user_id': ObjectId
});

var Timesheet = db.model('Timesheet', TimesheetSchema)

// Timesheet.virtual('id')
//   .get(function() {
//     return this._id.toHexString();
//   });

// Timesheet.pre('save', function(next) {
//   this.keywords = extractKeywords(this.data);
//   next();
// }); 

mongoose.model('Timesheet', Timesheet);

TimesheetsModel = {
    listTimesheetsByUser : function(callback){
    console.log('listing timesheets');
    callback();

    },

  newTimesheet : function(user,data,callback){

    var date = data.date;
    var lines = data.lines;
    var u = user;

    console.log(lines);

    var ts = new Timesheet({ "date": Date.now(),"lines":lines, "user_id":u });

    ts.save(function (err) {
        if (err) callback(err);
        console.log('adding new timesheet'); //this is output
        callback();
    });
  }
};

module.exports = TimesheetsModel 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T00:25:51.650

几个问题-我从您的代码中猜测您遇到了错误。你需要修复几件事：

a) 使用回调返回：

```
 if (err) return callback(err);
 console.log('adding new timesheet'); //this is output
 callback(); 
```

b) 我怀疑错误与您将“10”作为用户 ID 传递有关。您的架构设置为需要一个 ObjectId（24 个字符），因此会因此而失败。

# html - 在计算没有高度的父元素的高度时使用百分比表示法

> ID：12321773
> 
> 赞同：0
> 
> 时间：2012-09-07T16:11:03.863
> 
> 标签：html, css

我不想`body`明确设置`div`' 高度并以百分比设置孩子的高度。

```
<!doctype html>
<html>
<body>
    <div style="height:10%">
        fdjfdkjl
    </div>
    <div style="height:90%">
        dsds
    </div>
</body>
</html> 
```

但是，这不起作用。为什么？在规范中有行为描述：

> 当使用百分比表示法时，元素的高度是相对于父元素的高度计算的。如果没有明确设置父级，则使用浏览器的窗口。

好的，我可以将 100% 设置为`body`，但这也不起作用：它的高度只是包裹内容。为什么不使用浏览器的窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T00:21:58.333

正如@MattK 所说，

```
html, body { height: 100%; } 
```

解决问题。我认为这种方法有效，因为`div`s' 和`body`'s 的父母已经定义了大小。`html`没有父母，并且`height`使用了窗口。

# html - 如何在 Bootstrap 的轮播顶部添加播放按钮？

> ID：12321774
> 
> 赞同：1
> 
> 时间：2012-09-07T16:11:04.227
> 
> 标签：html, css, twitter-bootstrap, less

我正在使用 Bootstrap 的轮播进行幻灯片放映，以预览我的一些视频。我想在幻灯片顶部添加一个播放按钮，并在悬停时更改不透明度。（该按钮无法点击，因为`href`它位于幻灯片图片上。它只是在这里向我的用户展示它是一个播放器。）

但我无法让我的 div 在所有内容之上显示按钮。这是我的代码：

```
<div class="carousel slide">
   <div class="carousel-inner">
      <div class="item active"><a href="popup_video1.htm"><img src="thumbnail1.jpg" /></a></div>
      <div class="item"><a href="popup_video2.htm"><img src="thumbnail2.jpg" /></a></div>
      <div class="item"><a href="popup_video3.htm"><img src="thumbnail3.jpg" /></a></div>
   </div>
   <a class="carousel-control left" href=".carousel" data-slide="prev">&nbsp;</a>
   <a class="carousel-control right" href=".carousel" data-slide="next">&nbsp;</a>
</div> 
```

这是我的 CSS（它使用较少，但你明白了）：

```
.carousel {
width: 292px;
height: 163px;

  .playBtn {
    width: 292px;
    height: 163px;
    position: relative;
    opacity: 0.8;
    background-image: url('play_btn.png');
    background-position: center center;
    background-repeat: no-repeat;
    z-index: 999;

      &:hover{
        opacity: 1;
      }
  }

  img {
    width: 100%;
    height: 100%;
  }

  a.carousel-control {
    margin-top: 0;
    top: 0;
    right: 0;
    background: none;
    border: 0;
    width: 60px;
    height: 163px;

    &:hover.right {
      background-repeat: no-repeat;
      background-image: url('right_arrow.png');
    }

    &:hover.left {
      background-repeat: no-repeat;
      background-image: url('left_arrow.png');
    }
  }
} 
```

（请注意，我的播放按钮不是幻灯片的播放/暂停。）

我把我的放在哪里`<div class"playBtn"></div>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T02:15:59.607

Try using `position: absolute`, just like the carousel controls, and place the play button similarly in the markup. You shouldn't need to mess with `z-index` (besides if you were really in conflict with other Bootstrap elements with z-indices, they *start* at 1000).

If you want the play button's opacity to change based on it's own `:hover`, then you're going to have to deal with passing other mouse events it generates (i.e., clicks) onto the relevant elements. Otherwise, if you want it's opacity to change based on another element's `mouseenter` event (e.g., hovering anywhere on the slide), you could give the play button `pointer-events:none`, and toggle a class in the event handler.

# image - 如何使用 ActionScript 拖动图像以在屏幕上平滑移动？

> ID：12321780
> 
> 赞同：3
> 
> 时间：2012-09-07T16:11:26.483
> 
> 标签：image, actionscript-3, flash, apache-flex, drag

我以为这是一个简单的任务，但我错了。

我使用精灵来显示图像，当用户拖动它（MOUSE_DOWN 和 MOUSE_MOVE）时，我得到了位置`MOUSE_MOVE`并计算了偏移量：

```
 var current: Point = new Point(event.localX, event.localY);
 sprite.x = current.x - start.x;
 sprite.y = current.y - start.y; 
```

它有效但不流畅。有更好的解决方案吗？

* * *

**更新**

经过一天的调试，终于找到了原因。

更大的**fps**可以让它更流畅，但这不是这个问题的关键。

关键是我应该`stage`用来听`MOUSE_MOVE`，而不是图像本身。在获取鼠标位置时，我应该使用`event.stageX/Y`(or `stage.mouseX/Y`)，而不是`event.localX/Y`. 从`event.localX/Y`运动图像来看，既不稳定也不平滑，这导致了我的问题。

以下是我的工作代码，享受它:)

```
package {
    import flash.display.Bitmap;
    import flash.display.Loader;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.geom.Matrix;
    import flash.geom.Point;
    import flash.net.URLRequest;
    import flash.text.TextField;

    public class DragIssue extends Sprite {

        private static const URL: String = "assets/m1.jpg";

        private var self: DragIssue;

        private var sprite: Sprite;

        private var startPoint: Point;

        private var offsetX: Number = 0;
        private var offsetY: Number = 0;

        public function DragIssue() {
            self = this;
            init();
            loadImage();
        }

        protected function init(): void {
            if (stage == null) {
                this.addEventListener(Event.ADDED_TO_STAGE, on_addedToStage);
            } else {
                stage.addEventListener(MouseEvent.MOUSE_MOVE, onMouseMove);
            }

            function on_addedToStage(event: Event): void {
                self.removeEventListener(Event.ADDED_TO_STAGE, on_addedToStage);
                stage.addEventListener(MouseEvent.MOUSE_MOVE, onMouseMove);
            }
        }

        public function loadImage(): void {
            var loader: Loader = new Loader();
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, imageLoaded);
            loader.load(new URLRequest(URL));

            function imageLoaded(event: Event): void {
                var bitmap: Bitmap = event.target.content as Bitmap;

                self.sprite = new Sprite();
                sprite.addChild(bitmap);

                self.addChild(sprite);

                sprite.addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown);
                sprite.addEventListener(MouseEvent.MOUSE_UP, onMouseUp);
            }
        }

        private function onMouseMove(event: MouseEvent): void {
            if (startPoint) {
                sprite.x = offsetX + event.stageX - startPoint.x;
                sprite.y = offsetY + event.stageY - startPoint.y;
            }
        }

        private function onMouseUp(event: MouseEvent): void {
            startPoint = null;
            offsetX = sprite.x;
            offsetY = sprite.y;
        }

        private function onMouseDown(event: MouseEvent): void {
            startPoint = new Point(event.stageX, event.stageY);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:29:45.317

来，试试这个。它只是一个简单的黑色方块，但在你*真正*开始拖动它之前它看起来还不错。如前所述，将帧速率设置为更高的值是理想的。在这种情况下，出于内存原因，我决定在 MOUSE_DOWN 中将帧速率提高到 60fps，然后在 MOUSE_UP 中将其降低到 24。你显然可以随心所欲地改变它。

```
import flash.display.*;
import flash.events.*;

var startX:Number;
var startY:Number;
var shape:Sprite = new Sprite();
shape.graphics.beginFill(0x000000);
shape.graphics.drawRect(0,0,50,50);
shape.graphics.endFill();
this.addChild(shape);

shape.addEventListener(MouseEvent.MOUSE_DOWN,this.mouseDown);

function mouseDown(e:MouseEvent = null):void{
    stage.frameRate = 60;
    startX = stage.mouseX - shape.x;
    startY = stage.mouseY - shape.y;
    stage.addEventListener(MouseEvent.MOUSE_MOVE,this.mouseMove);
    shape.addEventListener(MouseEvent.MOUSE_UP,this.mouseUp);
}

function mouseMove(e:MouseEvent = null):void{
    shape.x = stage.mouseX - startX;
    shape.y = stage.mouseY - startY;
}

function mouseUp(e:MouseEvent = null):void{
    shape.removeEventListener(MouseEvent.MOUSE_UP,this.mouseUp);
    stage.removeEventListener(MouseEvent.MOUSE_MOVE,this.mouseMove);
    stage.frameRate = 24;
} 
```

确保您正在删除 MOUSE_UP 上的 MOUSE_MOVE 事件。那是关键。否则，您在每个 MOUSE_DOWN 上重新添加事件并最终同时重复运行相同的代码。抱歉，我的语法不是 100% 正确的；我在 CS5.5 中非常快速地将其组合在一起，而不是在 Flash Builder 中进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T17:04:51.373

如果您正在寻找流畅的拖动体验，可以使用以下方法：（假设您拖动的东西称为“dragee”，此代码在 Dragee 的父级范围内）

```
function startDragging():void {
    dragee.addEventListener(Event.ENTER_FRAME,dragUpdate);
}

function stopDragging():void {
    dragee.removeEventListener(Event.ENTER_FRAME,dragUpdate);
}

var decay:Number = .25; //1 is no decay, .1 would be cazy slow

function dragUpdate(e:Event):void {
    dragee.x += decay * (mouseX - dragee.x);
    dragee.y += decay * (mouseY - dragee.y);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:13:42.463

您必须使用高帧率才能平滑移动。最佳帧率是 60fps，因为它是大多数 LCD 显示器的默认值。

我手头没有代码，所以我把代码放在这里（未经测试）

```
yourClip.addeventListenner(MouseEvent.MOUSE_DOWN, startDrag);

function startDrag(e:MouseEvent = null):void{
    // record positon of the mouse relative to the clip
    deltaX=stage.mouseX-yourClip.x;
    deltaY=stage.mouseY-yourClip.y;
    // attach on mouse move event
    yourClip.addeventListenner(MouseEvent.MOUSE_MOVE, updateDrag);
    // attach stop event (on Stage)
    Stage.addeventListenner(MouseEvent.MOUSE_UP, stopDrag);
    }
function updateDrag(e:MouseEvent = null):void{
    yourClip.x=stage.mouseX-deltaX
    yourClip.y=stage.mouseY-deltaY
}

function stopDrag(e:MouseEvent = null):void{
   yourClip.removeEventListenner(MouseEvent.MOUSE_MOVE, updateDrag);
   stage.removeEventListenner(MouseEvent.MOUSE_UP, stopDrag);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-08T00:30:35.677

尝试调用`event.updateAfterEvent()`您的拖动处理程序。该函数告诉 Flash 立即重绘舞台，而不是等到下一帧。

# javascript - 在 WebGL 中绘制多个 2D 图像

> ID：12321781
> 
> 赞同：4
> 
> 时间：2012-09-07T16:11:30.483
> 
> 标签：javascript, html, canvas, webgl

我一直在关注一些关于 html5rocks 的教程，并且我设法制作了一个 javascript 程序，它使用 webGL 在画布上显示一个图像。我已经在下面发布了我的代码。

问题是，似乎没有人向您展示如何在 webGL 中绘制多个对象。我以前从未直接使用过 webGL，所以它对我来说不是很直观。

如何修改此代码以绘制每个对象`imageObjectArray`？（请注意，现在我只是在画画`imageObjectArray[0]`。

```
 function render(canvas, contextGL, imageObjectArray) { 
        vertexShader = createShaderFromScriptElement(contextGL, "2d-vertex-shader");
        fragmentShader = createShaderFromScriptElement(contextGL, "2d-fragment-shader");

        program = createProgram(contextGL, [vertexShader, fragmentShader]);
        contextGL.useProgram(program);

        var positionLocation = contextGL.getAttribLocation(program, "a_position");

        var texCoordLocation = contextGL.getAttribLocation(program, "a_texCoord");

        var texCoordBuffer = contextGL.createBuffer();
        contextGL.bindBuffer(contextGL.ARRAY_BUFFER, texCoordBuffer);

        contextGL.enableVertexAttribArray(texCoordLocation);
        contextGL.vertexAttribPointer(texCoordLocation, 2, contextGL.FLOAT, false, 0, 0);

        setRectangle(contextGL, 0.0, 0.0, 1.0, 1.0);

        var texture = contextGL.createTexture();
        contextGL.bindTexture(contextGL.TEXTURE_2D, texture);

        contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_WRAP_S, contextGL.CLAMP_TO_EDGE);
        contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_WRAP_T, contextGL.CLAMP_TO_EDGE);
        contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_MIN_FILTER, contextGL.NEAREST);
        contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_MAG_FILTER, contextGL.NEAREST);

        contextGL.texImage2D(contextGL.TEXTURE_2D, 0, contextGL.RGBA, contextGL.RGBA, contextGL.UNSIGNED_BYTE, imageObjectArray[0].displayObject.data);

        var resolutionLocation = contextGL.getUniformLocation(program, "u_resolution");
        contextGL.uniform2f(resolutionLocation, canvas.width, canvas.height);

        var buffer = contextGL.createBuffer();
        contextGL.bindBuffer(contextGL.ARRAY_BUFFER, buffer);
        contextGL.enableVertexAttribArray(positionLocation);
        contextGL.vertexAttribPointer(positionLocation, 2, contextGL.FLOAT, false, 0, 0);

        setRectangle(contextGL, imageObjectArray[0].x, imageObjectArray[0].y, imageObjectArray[0].width, imageObjectArray[0].height);

        // draw
        contextGL.drawArrays(contextGL.TRIANGLES, 0, 6);
    }

function setRectangle(gl, x, y, width, height) {
    var x2 = x + width;
    var y2 = y + height;
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(
                                        [x, y,
                                         x2, y,
                                         x, y2,
                                         x, y2,
                                         x2, y,
                                         x2, y2
                                        ]), gl.STATIC_DRAW);
} 
```

我的目标是开发一个（非常基本的）2d sprite 游戏。没有图书馆的舒适。（也许 glMatrix.js 除外）

[编辑] 我的渲染函数有错误，已修复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:45:33.110

以下代码执行以下操作：

1.  编译顶点和片段着色器
2.  将它们链接到一个着色器程序中
3.  创建一个顶点缓冲区来保存纹理坐标并填充它（texCoordBuffer）
4.  创建纹理 (createTexture)
5.  配置如何对纹理进行采样 (texParameteri)

以上5个步骤只需运行一次。

```
 vertexShader = createShaderFromScriptElement(contextGL, "2d-vertex-shader");
    fragmentShader = createShaderFromScriptElement(contextGL, "2d-fragment-shader");

    program = createProgram(contextGL, [vertexShader, fragmentShader]);
    contextGL.useProgram(program);

    var positionLocation = contextGL.getAttribLocation(program, "a_position");

    var texCoordLocation = contextGL.getAttribLocation(program, "a_texCoord");

    var texCoordBuffer = contextGL.createBuffer();
    contextGL.bindBuffer(contextGL.ARRAY_BUFFER, texCoordBuffer);

    contextGL.enableVertexAttribArray(texCoordLocation);
    contextGL.vertexAttribPointer(texCoordLocation, 2, contextGL.FLOAT, false, 0, 0);

    var texture = contextGL.createTexture();
    contextGL.bindTexture(contextGL.TEXTURE_2D, texture);

    contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_WRAP_S, contextGL.CLAMP_TO_EDGE);
    contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_WRAP_T, contextGL.CLAMP_TO_EDGE);
    contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_MIN_FILTER, contextGL.NEAREST);
    contextGL.texParameteri(contextGL.TEXTURE_2D, contextGL.TEXTURE_MAG_FILTER, contextGL.NEAREST);

    setRectangle(contextGL, 0.0, 0.0, 1.0, 1.0); 
```

必须为您要绘制的每个图像执行其余代码，它执行以下操作：

1.  将图像上传到纹理 (texImage2D)
2.  创建一个顶点缓冲区来保存位置并填充它（缓冲区）
3.  调用 drawArrays

```
    contextGL.texImage2D(contextGL.TEXTURE_2D, 0, contextGL.RGBA, contextGL.RGBA,contextGL.UNSIGNED_BYTE, imageObjectArray[0].displayObject.data);

    var resolutionLocation = contextGL.getUniformLocation(program, "u_resolution");
    contextGL.uniform2f(resolutionLocation, canvas.width, canvas.height);

    var buffer = contextGL.createBuffer();
    contextGL.bindBuffer(contextGL.ARRAY_BUFFER, 缓冲区);
    contextGL.enableVertexAttribArray(positionLocation);
    contextGL.vertexAttribPointer(positionLocation, 2, contextGL.FLOAT, false, 0, 0);

    setRectangle(contextGL, imageObjectArray[0].x, imageObjectArray[0].y, imageObjectArray[0].width, imageObjectArray[0].height);

    // 画
    contextGL.drawArrays(contextGL.TRIANGLES, 0, 6);

```

您需要将步骤 2 拆分为单独的步骤。第一步，为位置创建顶点缓冲区，应该只执行一次。第二步，填充图像的位置，需要对每一个要绘制的图像执行。

我应该说我的建议不会给出*最佳*实现，但它会让你绘制超过 1 个图像。为了达到最佳效果，您应该考虑这样做：

*   实现纹理图集（将所有图像打包到单个纹理中）。
*   只上传一次纹理和位置坐标。
*   使用更好的顶点和片段着色器来选择正在绘制的图像（纹理坐标偏移）、绘制位置（位置偏移）以及应该有多大（宽度和高度缩放）

# php - 在 php 中获取 textarea 值（由 ajax 调用填充）

> ID：12321783
> 
> 赞同：-1
> 
> 时间：2012-09-07T16:11:51.580
> 
> 标签：php, jquery, ajax, joomla

我的 Joomla 组件在按钮单击时进行 jquery 调用 (jquery.post) 并将结果填充到 textarea 中。

当我将表单提交到后端时，我想获取文本区域中存在的这些数据。我尝试了 JRequest::getVar 但没有返回所需的内容。$_GET 或 $_POST 也没有。我尝试在网上寻找解决方案，但没有一个太成功。

谁能帮帮我？

这是代码：

通过ajax调用获取内容

```
jQuery( "#btnGetContent" ).click(function(){

 jQuery("#txtArea").text("");
 var myVar = document.getElementById('var1');
 jQuery.post("https://www.domain.com/index.php?option=com_mycomponent&format=raw&task=ajax_get_content",
        {'myvar' : myVar.value,
        },
        (function(result) { jQuery("#txtArea").val(result); }),
        "html"
        );
   return false;
   }); 
```

后端 - 尝试获取 #txtArea 内容

...？

问候， 阿比

**编辑 1**

txtarea 的 HTML 代码：

```
<textarea style="width:600px;height:70px;" id="txtArea"><?php echo $this->record['recContent']; ?></textarea> 
```

这是我想要的工作流程：

1.  当页面加载时，它会检查 $record 是否有任何东西来填充文本区域。如果是，就去做。如果没有，请将其留空。
2.  btn 点击将通过 jquery ajax 调用发送一个变量并取回内容以填充 textarea。
3.  单击提交时，表单提交。后端php函数需要从textarea中获取最新的内容并保存到db。.

**解决方案 JRequest::getVar('txtArea') 有效。我忘记在 HTML 中包含 txtArea 的名称属性。谢谢杰伦！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T18:47:39.263

尝试将 textarea HTML 更改为：

```
<textarea name="mycontent" style="width:600px;height:70px;" id="txtArea"><?php echo $this->record['recContent']; ?></textarea> 
```

在表单提交时检索此内容的 PHP（假设表单是使用 POST 提交的）将是：

```
$content = $_POST["mycontent"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:20:52.297

如果您需要 textarea 内容服务器端，则需要将其添加到您的 ajax POST 中，如下所示：

```
jQuery.post("https://www.domain.com/index.php?option=com_mycomponent&format=raw&task=ajax_get_content", 
            {
                'myvar' : myVar.value,
                'txtarea' :  jQuery("#txtArea").val()
            }); 
```

该值将在`$_POST['txtarea']`（PHP 中的示例）中可用

# actionscript-3 - as3如何捕捉焦点选择事件？

> ID：12321787
> 
> 赞同：1
> 
> 时间：2012-09-07T16:12:02.200
> 
> 标签：actionscript-3, tabs, navigation, focus, accessibility

是否可以在影片剪辑上捕捉“焦点选择”（仅使用 TAB、ARROWS、ENTER 和 SPACE 键等辅助功能）？

在下面的示例中，我找不到捕捉蓝色方块上的“焦点选择”的方法。有什么建议么？

```
import flash.display.SimpleButton;
import flash.display.MovieClip;
import flash.events.MouseEvent;
import flash.events.Event;
import flash.display.Sprite;
import flash.events.FocusEvent;

// build red button
var btSprite:Sprite = new Sprite();
btSprite.graphics.beginFill(0xff0000);
btSprite.graphics.drawRect(0,0,20,20);
btSprite.graphics.endFill();
var redBtn:SimpleButton;
redBtn = new SimpleButton(btSprite, btSprite, btSprite, btSprite);
addChild(redBtn);
redBtn.x = redBtn.y = 0;

// build blue square
var blueSquare:MovieClip = new MovieClip();
blueSquare.graphics.beginFill(0x0000ff);
blueSquare.graphics.drawRect(0,0,20,20);
blueSquare.graphics.endFill();
addChild(blueSquare);
blueSquare.x = blueSquare.y = 100; // not sure it does not show over myBtn

// set blue square selectable using TAB key
blueSquare.tabEnabled = true;
blueSquare.focusRect = true;

// listen events
redBtn.addEventListener(MouseEvent.CLICK, onEvent);         // work click / tab select
blueSquare.addEventListener(Event.SELECT, onEvent);         // does not work
blueSquare.addEventListener(MouseEvent.CLICK, onEvent);     // works click only

// catch events on objects
function onEvent(event:Event){
    trace((event.target?event.target.name:'none') + " selected!");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:41:02.273

您是否尝试过使用焦点事件？

```
FocusEvent.FOCUS_IN 
```

这是一个很好的教程： [http ://www.kirupa.com/forum/showthread.php?311824-AS3-Simple-focus-example](http://www.kirupa.com/forum/showthread.php?311824-AS3-Simple-focus-example)

关于箭头键或空格键或回车，您需要使用按键侦听器：

```
blueSquare.addEventListner(KeyboardEvent.KEY_DOWN, keyDownHandler);

function keyDownHandler(event:KeyboardEvent):void {
    switch(event.keyCode){
        case Keyboard.SPACE:
        case Keyboard.ENTER:
            //do your select
            break;

        case Keyboard.DOWN:
            //do what you want when the down arrow is pressed
            break;

    }
} 
```

# r - 使用 data.table 包的笛卡尔积

> ID：12321797
> 
> 赞同：19
> 
> 时间：2012-09-07T16:12:32.100
> 
> 标签：r, data.table

使用 R 中的 data.table 包，我正在尝试使用合并方法创建两个 data.table 的笛卡尔积，就像在基础 R 中所做的那样。

在基地以下工作：

```
#assume this order data
orders <- data.frame(date = as.POSIXct(c('2012-08-28','2012-08-29','2012-09-01')),
                     first.name = as.character(c('John','George','Henry')),
                     last.name = as.character(c('Doe','Smith','Smith')),
                     qty = c(10,50,6))

#and these dates
dates <- data.frame(date = seq(from = as.POSIXct('2012-08-28'),
                               to = as.POSIXct('2012-09-07'), by = 'day'))

#get the unique customers
cust<-unique(orders[,c('first.name','last.name')])

#using merge from base R, get the cartesian product
merge(dates, cust, by = integer(0)) 
```

但是，相同的技术在使用 data.table 时不起作用，并且会引发此错误：

> ```
> "Error in merge.data.table(dates.dt, cust.dt, by = integer(0)) : 
>   A non-empty vector of column names for `by` is required." 
> ```

```
#data.table approach
library(data.table)

orders.dt <- data.table(orders)

dates.dt <- data.table(dates)

cust.dt <- unique(orders.dt[, list(first.name, last.name)])

#try to use merge (data.table) in the same manner as base
merge(dates.dt, cust.dt, by = integer(0)) 
```

> ```
> Error in merge.data.table(dates.dt, cust.dt, by = integer(0)) : 
>   A non-empty vector of column names for `by` is required. 
> ```

我希望结果反映所有日期的所有客户名称，就像在基础中一样，但是以以 data.table 为中心的方式进行。这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-07T17:17:21.900

如果您首先从`cust`-dataframe 中的第一个和最后一个构造全名，则可以使用`CJ`(cross-join)。您不能使用所有三个向量，因为会有 99 个项目，而且名字会与姓氏不恰当地混合在一起。

```
> nrow(CJ(dates$date, cust$first.name, cust$last.name ) )
[1] 99 
```

这将返回所需的 data.table 对象：

```
> CJ(dates$date,paste(cust$first.name, cust$last.name) )
            V1           V2
 1: 2012-08-28 George Smith
 2: 2012-08-28  Henry Smith
 3: 2012-08-28     John Doe
 4: 2012-08-29 George Smith
 5: 2012-08-29  Henry Smith
 6: 2012-08-29     John Doe
 7: 2012-08-30 George Smith
 8: 2012-08-30  Henry Smith
 9: 2012-08-30     John Doe
10: 2012-08-31     John Doe
11: 2012-08-31 George Smith
12: 2012-08-31  Henry Smith
13: 2012-09-01     John Doe
14: 2012-09-01 George Smith
15: 2012-09-01  Henry Smith
16: 2012-09-02 George Smith
17: 2012-09-02  Henry Smith
18: 2012-09-02     John Doe
19: 2012-09-03  Henry Smith
20: 2012-09-03     John Doe
21: 2012-09-03 George Smith
22: 2012-09-04  Henry Smith
23: 2012-09-04     John Doe
24: 2012-09-04 George Smith
25: 2012-09-05 George Smith
26: 2012-09-05  Henry Smith
27: 2012-09-05     John Doe
28: 2012-09-06 George Smith
29: 2012-09-06  Henry Smith
30: 2012-09-06     John Doe
31: 2012-09-07 George Smith
32: 2012-09-07  Henry Smith
33: 2012-09-07     John Doe
            V1           V2 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-07T17:01:37.193

`merge.data.table(x, y)`是一个包装对 的调用的便捷函数`x[y]`，因此合并需要基于两个`data.table`s 中的列。（这就是该错误消息试图告诉您的内容）。

一种解决方法是向两个 data.tables 添加一个虚拟列，其唯一目的是使合并成为可能：

```
## Add a column "k", and append it to each data.table's vector of keyed columns.
setkeyv(cust.dt[,k:=1], c(key(cust.dt), "k"))
setkeyv(dates.dt[,k:=1], c(key(dates.dt), "k"))

## Merge and then remove the dummy column
res <- merge(dates.dt, cust.dt, by="k")
head(res[,k:=NULL])
#          date first.name last.name
# 1: 2012-08-28     George     Smith
# 2: 2012-08-28      Henry     Smith
# 3: 2012-08-28       John       Doe
# 4: 2012-08-29     George     Smith
# 5: 2012-08-29      Henry     Smith
# 6: 2012-08-29       John       Doe

## Maybe also clean up cust.dt and dates.dt    
# cust.dt[,k:=NULL]
# dates.dt[,k=NULL] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T20:25:53.573

@JoshO'Brien 的解决方案使用`merge`但下面是一个类似的替代方案（AFAIK）。

`?data.table::merge`如果我正确理解文档，`X[Y]`应该比`data.table::merge(X,Y)`（从版本 1.8.7 开始）稍快。它参考了FAQ 2.12来解决这个问题，但是FAQ有点混乱。首先，正确的参考应该是 1.12，而不是 2.12。并且它们没有表明它们是指合并的基本版本还是 data.table 之一，或两者兼而有之。因此，这最终可能只是一个看起来更混乱的等效解决方案，或者它可能更快。

[**来自 Matthew 的编辑**] 谢谢：现在在 v1.8.7 中得到了改进（`?merge.data.table`，FAQ 1.12 并添加了新的 FAQ 2.24）

```
DT_orders<-data.table(date=as.POSIXct(c('2012-08-28','2012-08-29','2012-08-29','2012-09-01')),
                      first.name=as.character(c('John','John','George','Henry')),
                      last.name=as.character(c('Doe','Doe','Smith','Smith')),
                      qty=c(10,2,50,6),
                      key="first.name,last.name")

# Note that I added a second record to the orders table for John Doe, to make sure it could handle duplicate first/last name combinations.

DT_dates<-data.table(date=seq(from=as.POSIXct('2012-08-28'),
                              to=as.POSIXct('2012-09-07'),by='day'),
                     key="date")

DT_custdates<-data.table(k=1,unique(DT_dates),key="k")[unique(DT_orders)[,list(k=1,first.name,last.name)]][,k:=NULL] 
```

# actionscript-3 - 如何延迟while循环？

> ID：12321802
> 
> 赞同：2
> 
> 时间：2012-09-07T16:12:49.277
> 
> 标签：actionscript-3, loops, timer, while-loop

此代码会延迟每次触发循环之间的时间吗？

```
 while (coin.x > objYEnemy.x) {

    var delay:Timer = new Timer(100, 1);
    delay.addEventListener(TimerEvent.TIMER, runOnce);
    delay.start();
    function runOnce(event:TimerEvent):void {
            coin.x -= 1;
    delay.stop();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:21:06.930

并不真地。您的循环将不断运行（至少 100 毫秒，而您的计时器等待触发），每次创建一个新计时器并创建内存泄漏，因为您的计时器将永远不会因为它们的事件侦听器而被丢弃。由于您的 runOnce 是一个匿名函数，因此对于每个创建的计时器，它也会运行很多次。

在不确切知道您要完成的工作的情况下，您似乎想要做的是让计时器滴答处理程序成为循环函数。

```
var checkTimer:Timer = new Timer(100);
checkTimer.addEventListener(TimerEvent.TIMER, doCheck);
checkTimer.start();

function doCheck(e:Event):void {
    if(coin.x > objYEnemy.x){
        coin.x -= 1;
        //If you want this to only happen once, then add the following line:
        checkTimer.stop();       
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:26:16.087

不。第一个问题是，`runOnce`第一次运行循环时未定义，所以它甚至不会运行一次。第二个问题是这段代码的执行顺序：循环将启动大量计时器，直到满足中断条件，一旦某些计时器触发了`runOnce`. 使用 LondonDrugs_MediaServ 的代码，并在您不再需要计时器后取消注册事件侦听器，以便它可以收集垃圾。

# java - Android 版本检查和静态最终常量的内联

> ID：12321804
> 
> 赞同：5
> 
> 时间：2012-09-07T16:13:04.333
> 
> 标签：java, android, constants

我的理解是，`static final`在使用 Java 时，常量是在编译时内联的。

查看[使用版本感知组件 - 添加切换逻辑](http://developer.android.com/training/backward-compatible-ui/using-component.html#switching-logic)和使用[`Build.VERSION.SDK_INT`](https://developer.android.com/reference/android/os/Build.VERSION.html#SDK_INT)并使[`Build.VERSION_CODES`](https://developer.android.com/reference/android/os/Build.VERSION_CODES.html)我感到困惑，好像这两个常量值都在编译时内联，这种方法是无用的。我在这里想念什么？

谢谢 ：）

编辑：它们在抽象类中的静态方法中的事实是否会改变这种编译时内联？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:23:11.573

内联的是可以在编译时确定的常量，例如：

```
private final int CONST = 1; 
```

如果您检查[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.5_r4/android/os/Build.java#Build.VERSION)（它是一个旧版本，但我想它并没有太大变化），常量看起来像这样：

```
public static final String SDK = getString("ro.build.version.sdk"); 
```

这是`getString`方法：

```
private static String getString(String property) {
    return SystemProperties.get(property, UNKNOWN);
} 
```

所以无法在编译时确定常量。

# java - java中的iText ListItem和List类

> ID：12321806
> 
> 赞同：2
> 
> 时间：2012-09-07T16:13:10.700
> 
> 标签：java, list, itext

我想使用 iText 创建 PDF。我想创建一个有序列表。但是，我希望元素被标记为：

```
a)
b)
c)
d)
etc... 
```

iText 不支持这种标记，因为它有几个他自己的预定义。有没有办法创建我自己的标记（例如构造一串元素并将其传递给正确的方法/构造函数），或者是篡改 iText 核心文件的唯一方法？

我打算使用它的列表最多只有 5 个元素，所以字母表的长度不是问题......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:32:04.670

关于什么：

```
List list = new List(List.ORDERED, List.ALPHABETICAL); 
list.setLowercase(List.LOWERCASE);
list.setPostSymbol(") "); 
// use list 
```

见[`List`源](http://itext.svn.sourceforge.net/viewvc/itext/trunk/itext/src/main/java/com/itextpdf/text/List.java?revision=5373&view=markup)

# xna-4.0 - 可以从 XNA 4.0 中的 Pixel Shader 更改像素的位置吗？

> ID：12321818
> 
> 赞同：0
> 
> 时间：2012-09-07T16:13:52.610
> 
> 标签：xna-4.0, pixel-shader

我需要更改每个像素的位置：例如。(33,30) -> (40,55) 等等。可以在 XNA 4.0 的 Pixel Shader 中完成吗？

# webgl - 为什么我的 WebGL 应用程序在在线部署时会随机崩溃？（在本地主机上工作正常，使用 Three.js 和 Chrome）

> ID：12321821
> 
> 赞同：3
> 
> 时间：2012-09-07T16:14:04.257
> 
> 标签：webgl, three.js

我正在使用 Three.js 创建一个 3D 游戏。将其上传到我的网站并启动 Chrome 进行测试后，它会在一段时间后（几秒钟到几分钟之间）随机崩溃。这非常令人沮丧，因为它只说“Aww snap”。开发人员控制台窗口是空的，无法调试（至少我不知道）。

![Chrome WebGL 崩溃](../Images/474d3f83185f45bbf61d937c37a76134.png)

有趣的是，在我的本地主机上一切正常（使用 xampp）。知道我做错了什么，或者我如何调试这种情况？

这似乎不是因为内存泄漏。网页进程保持在 100-150mb 左右。（即使是这样，我也必须在我的本地主机上看到同样的崩溃）

* * *

**编辑**：错误是由使用带有 SIMPLE_OPTIMIZATIONS 的 Google 编译器服务引起的。我忘记了当我上传代码时脚本是自动编译的。然而仍然很奇怪，因为根本没有显示任何错误，只是发生了崩溃。我想知道为什么缩小的脚本会导致 WebGL 发疯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T20:23:25.987

您的浏览器崩溃，因为它有错误。通常，浏览器供应商负责修复这些错误或提供解决方法。这也可能是底层显卡的问题。stackoverflow.com 社区几乎无法为您提供帮助。

1.  使用最新的 Chromium nighlites 测试您的代码

2.  创建一个隔离的测试用例，在其中以可靠的方式重现崩溃

3.  将测试用例的错误报告给[http://code.google.com/p/chromium/issues/list](http://code.google.com/p/chromium/issues/list)

4.  `chrome://gpu/`在错误报告中添加建议的输入

5.  等待即将发布的 Chrome 版本中修复该错误 - 如果您的错误报告质量很高，则该错误很快就会得到修复，并且最新的 Chrome 不再在您的 HTML5 游戏发布时出现此错误

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:31:03.440

检查 chrome://gpu/ 可能有一些线索

# windows - 在 if 条件下批处理文件多个操作

> ID：12321822
> 
> 赞同：20
> 
> 时间：2012-09-07T16:14:05.610
> 
> 标签：windows, command-line

有没有办法将多个动作置于 if 条件下？像这样：

```
if not exist MyFolderName (
ECHO create a folder
mkdir MyFolderName
) 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-07T16:18:34.190

您可以使用`&`连接命令并在同一行上执行它们。

所以你的语法应该是这样的：

```
if not exist MyFolderName ECHO "Create a folder" & mkdir MyFolderName 
```

**更新**

或者您可以使用标签跳转到包含您要执行的命令的部分，例如：

```
if not exist MyFolderName GOTO DOFILESTUFF
:AFTER
...
EXIT

:DOFILESTUFF
ECHO "Create a folder"
mkdir MyFolderName
GOTO AFTER 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-18T17:03:42.973

正如 mjgpy3 所解释的那样，'&' 运算符可以完美地工作。此外，我们可以使用 & 添加超过 2 个语句。我已经检查了 3 个 ststement 并且它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-25T13:59:53.733

就在这里！

检查下面的链接，但请记住：您必须完全按照示例所示编写代码（所有空格和括号）。

[我可以在 DOS 批处理文件中有一个 IF 块吗？](https://stackoverflow.com/questions/4983508/can-i-have-an-if-block-in-dos-batch-file)

您可以在 if 语句中嵌套其他 if 语句，只要您遵循示例即可。它也可以正常工作`else`。

# c# - 如何在单触式中从 PerformSegue 传递数据

> ID：12321823
> 
> 赞同：5
> 
> 时间：2012-09-07T16:14:08.247
> 
> 标签：c#, ios, ios5, xamarin.ios

我有表源类，在行单击时，我正在调用下面的函数以移动到另一个控制器，但我想传递一些数据。

```
controller.PerformSegue("backtorootviewsague",controller); 
```

有谁知道我怎样才能实现它。我是monotouch和ios的新手。我无法弄清楚如何实现这一目标。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T17:23:37.067

`PrepareForSegue`是正确的地方。例如，如果创建的控制器 `CustomerViewController`被调用`CustomerListViewController`，则在该方法中覆盖，`CustomerListViewController`如下所示：

```
public override void PrepareForSegue (UIStoryboardSegue segue, NSObject sender)
{
    base.PrepareForSegue (segue, sender);

    // do first a control on the Identifier for your segue
    if (segue.Identifier.Equals("your_identifier")) {

        var viewController = (CustomerViewController)segue.DestinationViewController;
        viewController.MyData = dataToInject;
    }
} 
```

where`CustomerViewController`具有如下公共属性：

```
public SomeTypeData MyData { get; set; } 
```

[您可以在Xamarin 示例](https://github.com/xamarin/monotouch-samples/tree/master/WorldCities)中看到这一点。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-27T11:15:09.800

我是这样计算的：（Visual Studio/Xamarin-iOS/C#）

```
public override void PrepareForSegue(UIStoryboardSegue segue, NSObject sender)
        {
            base.PrepareForSegue(segue, sender);

            if (segue.Identifier.Equals("my Segue ID"))
            {
                var viewController = (MyDestinationViewController)segue.DestinationViewController;
                viewController.selectedItemInDestinationController = selectedControlStringFromViewController;
            }
        } 
```

执行转场：

```
this.PerformSegue("my segue ID", this); 
```

在目标 ViewController 上，添加：

```
public string selectedControlName;

protected ControlShowController(IntPtr handle) : base(handle)
{

} 
```

# python - 继承调用

> ID：12321832
> 
> 赞同：1
> 
> 时间：2012-09-07T16:15:06.153
> 
> 标签：python, class, inheritance

这是我的家庭作业：

> 问题的第一部分是定义`Worker`继承自`Employee`并包含一个属性的子类，该属性引用另一个员工，该员工是员工的经理。您应该定义一个`get_manager`返回工人经理的方法。
> 
> 例子：
> `worker = Worker("Fred", 52000, myboss)`
> 
> 问题的第二部分是定义`Executive`继承自`Employee`并包含引用年度奖金的属性的子类。
> 
> 您应该覆盖工资方法以根据他/她的薪水和奖金计算高管薪酬。您应该在类`Employee`的工资方法定义中使用工资方法`Executive`。
> 
> 例子：
> `executive = Executive("Kerry", 520000, 1040000)`

我提交了以下代码，但有人告诉我“你给高管的工资是错误的”。我看不出错误是什么。我该如何做对？

```
class Employee(object):

    def __init__(self, name, salary):
        self._name = name
        self._salary = salary

    def my_name(self):
        return self._name

    def wage(self):
        return self._salary/26   # fortnight pay

class Worker(Employee):
    def __init__(self, name, salary, manager):
        Employee.__init__(self, name, salary)
        self._manager = manager

    def getManager(self):
        return self._manager

class Executive(Employee):
    def __init__(self, name, wage, yearlyBonus):
        Employee.__init__(self, name, salary) 
        self._yearlyBonus = yearlyBonus

    def wage(self):
        return Employee.wage(self) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:15:55.347

您可以使用[`super()`](http://docs.python.org/library/functions.html#super)调用当前类的超类：

```
def __init__(self, name, salary, manager):
    super(Worker, self).__init__(name, salary)
    self._manager = manager 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:38:42.027

这两种方法`super(parent, self).method(...)`接近或`parent.method(self,...)`大致等效。在这两种情况下，它都允许您从父级调用 a`method`并将其应用于子级。

这种方法可以是`__init__`：初始化一个像它的父实例一样的子实例总是一个好主意：

```
class Worker(Employee):
    def __init__(self, *args):
        Employee.__init__(self, ...)
        finish_the_initialization_of_worker 
```

但方法可以是任何东西，比如，`wage`

```
class Executive(Employee):
    def wage(self):
        return Employee.wage(self) + self._yearly_bonus 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:24:19.810

你也可以使用：

```
class Worker(Employee):
    def __init__(self, name, salary, manager):
        Employee.__init__(self, name, salary)
        self._manager = manager 
```

如果您碰巧继承了一个，这也适用于旧式类。

# java - 如何使用 jericho html 解析器从网站获取数据？

> ID：12321833
> 
> 赞同：0
> 
> 时间：2012-09-07T16:15:07.107
> 
> 标签：java, web, jericho-html-parser

我在 java 中使用 jericho html 解析器。我想从网站获取数据。在网站html内容是这样的......

```
<div class="class_div">
   <div class="class_div2">All contents...</div>`
     <span class="equals">Content 1</span>
     <span class="equals">Content 2</span>
     <span class="equals">Content 3</span>
     <span class="equals">Content 4</span>
 </div> 
```

我想获取内容 1、内容 2、内容 3、内容 4。如何获取这个？

我正在使用此代码

```
String sourceUrlString="<website url>";
if (sourceUrlString.indexOf(':')==-1)
sourceUrlString="http:"+sourceUrlString;
Source source=new Source(new URL(sourceUrlString));
Element bodyContent = source.getElementByClass("equals");` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:14:45.470

问题出在哪里？使用您的代码，您可以获得每个`Element`- 使用那些您可以获得他们的文本：

```
Source source = new Source(/* ... */);
List<Element> elements = source.getAllElementsByClass("equals");

for( Element element : elements )
{
    /*
     * 'element.getTextExcrator().toString()' returns the text of the element
     */
    System.out.println(element.getTextExtractor().toString());
} 
```

**输出：**

> 内容 1
> 内容 2
> 内容 3
> 内容 4

# objective-c - Objective C GET 方法在 WI-FI 上工作，但不在蜂窝网络上工作

> ID：12321834
> 
> 赞同：0
> 
> 时间：2012-09-07T16:15:09.223
> 
> 标签：objective-c, get, twitter, httprequest

我有以下代码从 Twitter API 获取 twitter Id 和名称：

```
{

        NSString *StringUrl = [NSString stringWithFormat:@"https://api.twitter.com/1/users/show.json?screen_name=%@",account.username];

        @try {

                NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
                [request setHTTPMethod:@"GET"];
                [request setTimeoutInterval: 15];
                [request setURL:[NSURL URLWithString:StringUrl]];

                NSError *error = [[NSError alloc] init];
                NSHTTPURLResponse *responseCode = nil;

                NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&responseCode error:&error];

                if([responseCode statusCode] != 200){
                    NSLog(@"Error getting %@, HTTP status code %i", StringUrl, [responseCode statusCode]);
                }else{
                    NSLog(@"Good");
                    NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
                    NSString *twitterId = [json objectForKey:@"id_str"];
                    NSString *twitterName = [json objectForKey:@"name"];
                }

        }
        @catch (NSException *exception) {
            NSLog(@"No conection: %@",exception.name);
        }
} 
```

通过 wifi 网络测试时效果很好；但是通过蜂窝网络，它会响应：

```
Error getting https://api.twitter.com/1/users/show.json?screen_name=enf_4eva, HTTP status code 400 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T20:34:10.367

似乎这不是执行此类请求的最佳方式，因为请求必须通过 3G 进行身份验证。使用新的 SLRequest，我可以设置执行请求的帐户，使其运行良好。

# java - 为 Java 应用程序的执行保留一个计数器

> ID：12321837
> 
> 赞同：1
> 
> 时间：2012-09-07T16:15:39.667
> 
> 标签：java

这是场景：

我正在运行一个 Java 应用程序，它调用 REST 接口，并将变量的一些状态作为整数取回（基本上是最后一次成功的构建 #form Teamcity）

现在，由于我从 Jenkins 运行该实用程序，我想比较两个 REST 调用之间的 LastSuccessfulBuild Number。做这个的最好方式是什么 ？这是我在代码方面的内容。

```
import java.io.File;
import java.io.FileInputStream;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Properties;
import java.util.TimeZone;

import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.ClientResponse;
import com.sun.jersey.api.client.WebResource;
import com.sun.jersey.api.client.filter.HTTPBasicAuthFilter;
import org.apache.commons.configuration.PropertiesConfiguration;
import org.apache.commons.io.FileUtils;

public class LastSuccessBuildNum {

    private  final static String getDateTime()
    {
        DateFormat df = new SimpleDateFormat("yyyy-MM-dd_hh:mm:ss");
        df.setTimeZone(TimeZone.getTimeZone("EST"));
        return df.format(new Date());
    }

    public static void main(String[] args) {

        try {

            Client client = Client.create();
            Properties properties = new Properties();
            File f = File.createTempFile("default", ".properties");

            properties.load(new FileInputStream("config.properties"));

            String currentDir = System.getProperty("user.dir");

            String username = properties.getProperty("username");

            String pass = properties.getProperty("password");
            //System.out.println(pass);
            String buildNumber = properties.getProperty("buildNumber");

            client.addFilter(new HTTPBasicAuthFilter("username", "password"));

            WebResource webResource = client
                    .resource("http://a.b.c.d/teamcity/app/rest/buildTypes/id:bt26/builds/status:SUCCESS/number");
            ClientResponse response = webResource.accept("text/plain").get(
                    ClientResponse.class);

            if (response.getStatus() != 200) {
                throw new RuntimeException("Failed : HTTP error code : "
                        + response.getStatus());
            }

            /**
             * Prepend timestamp to latestBuildNum
             */

            System.out.println(getDateTime());
            String latestBuildNum_1 = response.getEntity(String.class);

            //System.out.println("Output from Server .... \n");

            /** 
             * Save latest build number to a local file
             */
            //System.out.println(latestBuildNum);

            String datelbn = (getDateTime() + "-" + latestBuildNum_1);
            //System.out.println(datelbn);
            //If latestBuildNumberLocal < latestBuildNum, then save to file latestBuildNum
            // Else do nothing
            FileUtils.writeStringToFile(new File("PreMDNSlatestSuccBuildNum.txt"), latestBuildNum_1);
            /**
             * Get Content from the file, which would be the LatestBuildNumber at LAST run.
             * SO the NEXT run, will save the number in a different file.
             * Then we compare the contents of these two files
             * using StringToInt() and compare
             */

        } catch (Exception e) {

            e.printStackTrace();

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:36:17.053

这是你想要的草图。有许多库可以减少“样板”的数量（例如 Apache Commons IO。Java 7 还整合了异常处理和资源清理。

此外，您还可以对这段代码做更多的事情以使其“准备好生产”（这只是一个草图）。对于初学者，我们应该使用日志库而不是 STDOUT（`java.util.logging`至少）。

最后，我的示例读取/写入原始 int，但您应该能够以几乎相同的方式读取/写入/解析字符串。

```
import java.io.*;
import java.util.concurrent.atomic.AtomicInteger;

public class GetLatestBuildNumber {

    private static final AtomicInteger number = new AtomicInteger();
    private static final String FILE_NAME = "latest_build_number.txt";

    public static void main(String[] args) {

        int latest = fetchLatestBuildNumber();
        writeLatestBuildNumber(latest);
        int next = fetchLatestBuildNumber();

        int previous;
        try {

            previous = readLatestBuildNumber();

            System.out.println("previous build number " + previous);
            System.out.println("current build number " + next);

        } catch (IOException ioe) {
            System.out.println("failed to read last build number " +
                        "from file " + FILE_NAME + ": " + ioe);
        } catch (NumberFormatException nfx) {
            System.out.println("failed to parse last build number: " + nfx);
        }

    }

    private static int fetchLatestBuildNumber() {
       return number.getAndIncrement();
    }

    private static void writeLatestBuildNumber(int number) {

        int latestBuildNumber = fetchLatestBuildNumber();
        FileWriter writer = null;
        try {
            writer = new FileWriter(FILE_NAME);
            writer.write(Integer.toString(latestBuildNumber));
        } catch (IOException ex) {
            System.out.println("failed to write build number "
                        + number + ", error: " + ex);
        } finally {
            try {
                if (writer != null) writer.close();
            } catch (IOException e) { /* we tried... */ }
        }

    }

    private static int readLatestBuildNumber() throws IOException  {
        BufferedReader reader = null;
        try {
            reader = new BufferedReader(new FileReader(FILE_NAME));
            String number = reader.readLine();
            return Integer.parseInt(number);
        } finally {
            try {
                if (reader != null) reader.close();
            } catch (IOException e) { /* we tried. */ }

        }

    }
} 
```

# javascript - 使用 jQuery 将点击绑定到页面的未使用部分

> ID：12321839
> 
> 赞同：0
> 
> 时间：2012-09-07T16:15:53.823
> 
> 标签：javascript, jquery

我一直试图将点击重定向绑定到页面上还没有另一个 div 的 body 标记。我有一个典型的页眉、容器和页脚布局，但我想在后台放置一个站点皮肤，供用户单击以进行注册。

到目前为止，这是我针对 body 元素的内容：

```
$('body').bind({
    click: function() {
        window.location = 'https://example.com/';
    },
}) 
```

背景图像显示正常并且重定向有效，但如果我单击页眉、容器或页脚中的某个位置，它将执行我不想要的重定向。为了重定向，我希望它忽略那些 div。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:22:17.110

我建议使用`on()`：

```
$('body').on('click', ':not(div)', function(e){
    window.location = 'https://example.com/';
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/EVE5Y/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:30:49.313

[小提琴](http://jsfiddle.net/Schlogen/rVBRy/)

```
$("body").click( function(e) {
    if(e.target == this)
    {
        window.location = 'https://example.com/';
    }
});​​​​​ 
```

# c# - 如何向一维数组添加更多“元素”或“维度”？

> ID：12321842
> 
> 赞同：0
> 
> 时间：2012-09-07T16:16:00.073
> 
> 标签：c#, visual-studio-2010

我希望我以正确的方式表达我的问题，并使用正确的术语。我有一组学生姓名，`arrSummary`，这是不同的（没有重复）。

然后，我有另一个数组 ，`arrTest1`其中包含相同学生的姓名和他们在 Test1 上的考试成绩的列表。然后我有第三个数组，`arrTest2`，其中包含他们的姓名和他们在 Test2 上的考试成绩的列表。

`arrTest1`并且`arrTest2`是这样的`arrTest1[0].Name = "Bob"`和`arrTest1[0].Score = "98"`。

我如何制作数组, `arrSummary`, 这样`arrSummary[0].Name = "Bob"`, `arrSummary[0].Score1 = "98"`, `arrSummary[0].Score2 = "76"`?

数组中有不同的类型（字符串、整数、整数）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:28:52.917

```
var arrSummary = arrTest1.Join(arrTest2, person => person.Name, person => person.Name
    , (first, second) => new
    {
        Name = first.Name,
        Score1 = first.Score,
        Score2 = second.Score,
    })
    .ToArray(); 
```

请注意，这是查询前两个数组并创建一个全新的数组。这里我对查询结果使用了匿名类型；如果查询结果将在此方法之外使用，您将希望使用这 3 个属性创建一个新类并将结果投影到该类型的实例（只需将该类型放在之后`new`）。

一旦创建了数组，您就无法更改其维度、类型甚至大小。如果摘要数组已经是具有所有三个属性的类型，那么理论上您可以遍历并填充它，但是从头开始生成摘要数组可能会更容易，这就是我在这里所做的原因.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:22:30.867

使用单个列表或数组将数据存储为类中的字段，而不是三个不同的数组，如下所示：

```
class TestResult {
    public String Name;
    public Int32 TestResult1;
    public Int32 TestResult2;
}

TestResult[] testResults = new TestResult[ numberOfStudents ];
testResults[0].Name = "Mr. Foo bar";
testResults[0].TestResult1 = 65;
testResults[0].TestResult2 = 76; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:22:45.363

您需要创建一个类型并在您的数组中使用它：

```
public class TestSummary {
  public string StudentName {get;set;}
  public int Score1 {get;set;}
  public int Score2 {get;set;}
} 
```

*或者*

你可以用正确的方式做到这一点：

```
public class Score{
   public int TestId {get;set;}
   public int StudentId {get;set;}
   public int Score {get;set;}
}

public class Student{
   public int ID {get;set;}
   public string FirstName {get;set;}
   public string LastName {get;set;}
   public List<Score> Scores;
} 
```

那么你应该有一个`List<Student>`而不是你的摘要数组的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T16:25:23.887

```
var scores1 = arrTest1.ToDictionary(score => score.Name);
var scores2 = arrTest2.ToDictionary(score => score.Name);
var output = arrSummary.Select(name=>new {Name=name, Test1 = scores1[name], Test2 = scores2[name]).ToArray(); 
```

（请注意，这仅在您的 arrTest 数组没有任何缺失条目时才有效。即 arrSummary 中没有不在 arrTest1 或 arrTest2 中的名称。）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-07T16:18:48.633

创建一个包含要存储的数据的类或结构，并创建这些对象的数组！更好的是，您可以考虑使用列表！

```
public class Student
{
    public string name {get;set;}
    public int score1 {get;set;}
    public int score2 {get;set;}
} 
```

...

```
List <Student> = new List<Student>();
List.Add({name="Len", score1=90, score2=100}); 
```

# ruby-on-rails-3 - 在我的显示视图中正确显示嵌套模型

> ID：12321845
> 
> 赞同：2
> 
> 时间：2012-09-07T16:16:27.507
> 
> 标签：ruby-on-rails-3, nested-forms, nested-attributes

我是 Rails 新手，我对如何在视图中正确显示嵌套模型属性有些困惑。

我正在使用 Rails 3.2.6。

我在这里的3个模型：

```
class Company < ActiveRecord::Base
  attr_accessible :name, :vehicles_attributes, :engines_attributes
  has_many :vehicles, :dependent => :destroy
  accepts_nested_attributes_for :vehicles, :allow_destroy => true,
    :reject_if => proc { |attrs| attrs.all? { |k, v| v.blank? } }
end

class Vehicle < ActiveRecord::Base
  attr_accessible :company_id, :engines_attributes

  belongs_to :company

  has_many :engines, :dependent => :destroy

  accepts_nested_attributes_for :engines, :allow_destroy => true,
    :reject_if => proc { |attrs| attrs.all? { |k, v| v.blank? } }
end

class Engine < ActiveRecord::Base
  attr_accessible :make, :model, :model_year, :vehicle_id

  belongs_to :vehicle

end 
```

我使用 simple_form_for 和 simple_fields_for 部分将这些模型置于嵌套形式中。这里是company_controller.rb

```
 def show
    @company = Company.includes(vehicles: :engines).find(params[:id])
    #added this, thanks to @achempion
  ...
  end

  def new
    @company = Company.new
    @company.addresses.build 
    @company.vehicles.build
    ...
  end 
```

我的节目视图：

```
 <% for vehicle in @company.vehicles %>
      <p>Make: <strong><%= h vehicle.make %></strong></p>
      <p>Model: <strong><%= h vehicle.model %></strong></p>
      <p>Odometer Reading: <strong><%= h vehicle.odometer %></strong></p>
      <p>Vehicle ID No. (VIN): <strong><%= h vehicle.vin %></strong></p>
      <p>Year: <strong><%= h vehicle.year %></strong></p>
  <% end %> 
```

但是我如何像处理车辆一样在循环中引用公司 -> 车辆 -> 引擎？我总是乐于接受建议！

目前我已经用@company.vehicles.engines 尝试了一堆语法，但我不断得到

```
undefined method `engines' for #<ActiveRecord::Relation:0x007fd4305320d0> 
```

我确定只是我不熟悉控制器和显示视图中的正确语法。

任何帮助表示赞赏=）

另外，是否有更好的方法来执行该循环？也许

```
<%= @company.vehicles.each |vehicle| %>
 <%= vehicle.make %>
 ...
<% end %> 
```

?? :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:13:31.010

我认为`@company = Company.includes(vehicles: :engines).find(params[:id])`这是一个好方法。[在这里](http://guides.rubyonrails.org/active_record_querying.html)查看更多

而且您的主要模型必须忘记`has_many :engines, :dependent => :destroy`，因为它是用于车辆模型的。祝你好运！

您还可以将引擎视为：

```
@company.vehicles.each do |vehicle|
  vehicle.engines.each do |engine|
    puts engine.id
  end
end 
```

编辑：修正小错别字。

# symfony - data_class 参数背后的基本原理是什么？

> ID：12321846
> 
> 赞同：0
> 
> 时间：2012-09-07T16:16:29.307
> 
> 标签：symfony

给定实体

```
User
Adress 
```

以及它们之间的一对一关系，我想知道为什么必须设置

```
public function getDefaultOptions(array $options) {
    return array('data_class' => 'My\Bundle\Entity\Address');
} 
```

在`AdressType`课堂上。否则，`User::setAdress(Adress $adress)`当我想从`UserType`.

对我来说，我必须声明实体并且这不是 symfony2 的“假设”，这似乎很奇怪。

有人能告诉我为什么做出这种设计选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:25:34.293

AddressType 应该作为独立的 FormType 处理，它可以完美地独立运行。您如何期望 FormBuilder 简单地猜测为通用表单类型加载哪个（如果有的话）实体类？

我猜 FormBuilder 可以查看具有自定义 FormType 的字段是否对应于实体字段并且该字段是关系实体，然后相应地重新映射数组数据，但为了避免写入 data_class 似乎是一个巨大的开销。

# jquery - 是否有一个 jquery ajax 函数会在等待错误、成功或完成时调用？

> ID：12321849
> 
> 赞同：1
> 
> 时间：2012-09-07T16:16:43.333
> 
> 标签：jquery, ajax

我打算调用一个 ajax 函数，并且正在查看 api。我很好奇是否有一个函数可以在等待成功、错误、完成等被调用时执行。

我希望有类似的东西：

$.ajax({ ..., waiting: function(){ //执行一些代码 } });

如果它不在那里，它真的应该。在调用ajax函数之前必须携带这些东西在我看来并不聪明......

waiting 可以轻松执行诸如显示加载 gif 之类的操作。

有什么东西可以做这种功能吗？我似乎找不到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:26:06.390

您在`$.ajax`通话后拥有的任何代码实际上都会在通话开始后立即开始运行。所以，如果你有这样的事情：

```
$ajax('someurl').done(function() { /*** success function ***/ });
someOtherFunctionCall(); 
```

`someOtherFunctoinCall()`实际上将在 ajax 调用开始后立即执行，并且无论调用成功/失败都会发生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:28:59.323

尝试这个

```
jQuery.ajax({
    url:"http://www.example.com/",
    beforeSend:function(){
        //show loading gif
    },
    success:function(resp){
        //handle response from server
        //hide or remove loading gif
    },
    error:function(msg){
        //show error message
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T16:21:34.123

您应该在启动请求的同时显示加载 GIF。除了 , 之外，没有真正的方法可以知道 AJAX 调用的实际进度，`readyState`这就是`onreadystatechange`目的（在纯 JS 中，我不知道/关心它在 jQuery 中的等价物是什么）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-07T16:23:46.337

在 ajax 调用完成之前显示微调器很容易。这是如何完成的示例：

```
loading = {
    count: 0
};

loading.finish = function() {
    this.count--;
    if (this.count==0) this.$div.hide();
};

// 
loading.start = function() {
    this.count++;
    if (!this.$div) {
        var html = '<div style="position: fixed;z-index:100;left:0;top:0;right:0;bottom:0;background: black;opacity: 0.6;">';
        html += '<table width=100% height=100%>';
        html += '<tr><td align=center valign=middle>';
        html += '<img src=img/loading.gif>';
        html += '</td></tr>';
        html += '</table></div>';
        this.$div=$(html);
        this.$div.prependTo('body');
    }
    setTimeout(function(){
        if (loading.count>0) loading.$div.show();
    }, 500);
};

// the function to call
askUrl = function(url, success) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onreadystatechange = function() {
        if (httpRequest.readyState === 4) {
            if (httpRequest.status === 200) {
                success(msg);
            }
            loading.finish();
        }
    };
    loading.start();
    httpRequest.open('GET', url);
    httpRequest.send();
}; 
```

如果您调用 askUrl 并且服务器在 500 毫秒内没有响应，则屏幕将变灰并显示一个微调器。

由于它是一个简短的代码，并且它实际上取决于所需的结果，我不确定这是否应该在 jQuery 甚至插件中可用。

我在[这里](http://ajaxload.info/)得到了我的 gif 微调器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-07T16:33:21.353

最好的方法是对 ajax 请求使用 beforeSend 和 complete 函数。

```
$.ajax({
          .. Your ajax settings..
          success : function(result){
             // do what you want with data here
          },
          beforeSend : function(){
            // Show a ajax gif here
          },
          complete : function(){
            // Hide the ajax gif here
          }
    }); 
```

发送ajax请求后立即触发beforeSend函数。当它超出成功函数时触发完成函数。因此您可以在请求完成时通知用户。

# sql - PostgreSQL 发现最后三个登录日期之间的差异

> ID：12321851
> 
> 赞同：1
> 
> 时间：2012-09-07T16:16:45.440
> 
> 标签：sql, postgresql, aggregate-functions, window-functions

我想为每个客户获取最后三个登录日期，并找到在上次登录 (login3) 和上次登录 (login1) 之前的时间超过 4 天的客户。

“活动”表包含：

*   用户身份
*   login_date 为 DATETIME 格式，但时间始终为 00:00:00
*   （以及其他一些与问题字段无关的）

我尝试了几个查询，但没有一个能正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T18:48:25.813

这是一种可以在 PostgreSQL 8.3 及更高版本中使用数组的解决方案。

生成测试数据。改变第二个参数`generate_series()`以添加更多活动记录：

```
create table activity (id serial primary key, user_id integer, login_date timestamp);
insert into activity (user_id, login_date)
  select * from
  (
   select round(random()*10)::integer as user_id, ('2012-01-01'::date + (round(random()*300))* '1 day'::interval) as login_date
   from
   (select generate_series(1,1000)) foo
  ) fooger order by login_date;

select * from activity; 
```

查询出想要的数据：

```
--show last three login dates per user:
select user_id, login[1] as login1, login[2] as login2, login[3] as login3
from
(
 select user_id, array_agg(login_date) as login from
 (select * from activity order by user_id,login_date desc) foo
 group by user_id
)  foo;

--shake out those who haven't been visiting frequently enough
select user_id, login[1] as login1, login[2] as login2, login[3] as login3, (login[1] - coalesce(login[3],login[2],login[1]))::interval as diff
from
(
 select user_id, array_agg(login_date) as login from
 (select * from activity order by user_id,login_date desc) foo
 group by user_id
)  foo
where login[1] - coalesce(login[3],login[2],login[1])  > '4 days'::interval; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T20:13:09.803

我使用并简化了@Joshua 提供的设置：

```
CREATE TEMP TABLE activity (id serial primary key, user_id integer
                                                 , login_date timestamp);
INSERT INTO activity (user_id, login_date)
SELECT * FROM  (
   SELECT round(random()*10)::int AS user_id
        , ('2012-01-01 0:0'::timestamp + random() * interval '365 days') AS ts
   FROM   generate_series(1,1000)
   ) g
ORDER  BY ts; 
```

您可以使用自 PostgreSQL 8.4 起可用的[窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html)：

```
SELECT user_id, login1, login3, (login1 - login3) AS time_span
FROM   (
   SELECT user_id, login_date
         ,first_value(login_date)      OVER w  AS login1
         ,COALESCE(lead(login_date, 2) OVER w 
                  ,lead(login_date)    OVER w) AS login3 
   FROM   activity
   WINDOW w AS (PARTITION BY user_id ORDER BY login_date DESC)
    ) x
WHERE  login_date = login1
AND    (login1 - login3) > interval '4d'; 
```

阅读 IMO 更容易，但在快速测试中，@Joshua 的查询*速度快*了约 30% 。

*   只有一个条目的用户永远不会有资格。
*   对于只有两个条目的用户，使用倒数第二个而不是倒数第三个。

除此之外，如果您的时间戳的时间部分始终是`00:00:00`您可能需要考虑使用[`date`列而不是`timestamp`](http://www.postgresql.org/docs/current/interactive/datatype-datetime.html).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T21:53:04.530

为了完整性：NAIVE 版本（查询计划显示 3 个 CTE 的三个单独的子计划；这很糟糕）（递归 CTE 也应该是可能的 ;-)

```
WITH l3 AS (
        SELECT a3.id, a3.user_id, a3.login_date
        FROM   activity a3
        WHERE NOT EXISTS ( SELECT *
                FROM activity nx
                WHERE nx.user_id = a3.user_id
                AND nx.login_date > a3.login_date
                )
        )
, l2 AS (
        SELECT a2.id, a2.user_id, a2.login_date
        FROM   activity a2
        JOIN l3 ON l3.user_id = a2.user_id AND l3.login_date > a2.login_date
        WHERE NOT EXISTS ( SELECT *
                FROM activity nx
                WHERE nx.user_id = a2.user_id
                AND nx.login_date > a2.login_date
                AND nx.login_date < l3.login_date
                )
        )
, l1 AS (
        SELECT a1.id, a1.user_id, a1.login_date
        FROM   activity a1
        JOIN l2 ON l2.user_id = a1.user_id AND l2.login_date > a1.login_date
        WHERE NOT EXISTS ( SELECT *
                FROM activity nx
                WHERE nx.user_id = a1.user_id
                AND nx.login_date > a1.login_date
                AND nx.login_date < l2.login_date
                )
        )
SELECT l1.user_id
        ,l1.id AS ii1, l1.login_date AS d1
        ,l2.id AS ii2, l2.login_date AS d2
        ,l3.id AS ii2, l3.login_date AS d3
FROM l1
JOIN l2 ON l2.user_id = l1.user_id
JOIN l3 ON l3.user_id = l1.user_id
WHERE l3.login_date - l1.login_date > '4 days'::INTERVAL
        ; 
```

# php - 制作分层列表php时避免嵌套的foreach循环

> ID：12321853
> 
> 赞同：1
> 
> 时间：2012-09-07T16:16:49.743
> 
> 标签：php, foreach, nested

我现在正在制作一个表格来显示会计数据，发票分为许可证、年、半年和季度。发票来自作为二维数组的查询，如下所示：

```
array(
    'invoice0' = array(data),
    'invoice2' = array(data),
    'invoice3' = array(data),
    'invoice4' = array(data),
    'invoice5' = array(data),
    'invoice1' = array(data)
) 
```

目前我一直在使用一个看起来相当邪恶的四深嵌套 foreach 循环来创建一个 5d 数组结构来组织行，每个级别都有数据行。例如：

```
'License' = array(
  'Year0' = array(
    'Half0' = array(
      'Quarter0' = array(
        'invoice0' = array(data),
        'invoice1' = array(data)
      ),
      'QData' = array(data)
    ),
    'HData' = array(data)
    'Half1' = array(
      'Quarter0' = array(
        'invoice3' = array(data),
        'invoice4' = array(data)
      ),
      'Quarter1' = array(
        'invoice5' = array(data),
        'invoice6' = array(data)
      ),
      'QData' = array(data)
    ),
    'HData' = array(data)
  ),
  'YData' = array(data)
) 
```

等等。每个级别的数据需要在每个发票的数据中包含一个金额的总和。我试图实现的最终产品只是一堆可扩展的表格行（或列表项；我仅限于该项目的表格结构）。所以：

```
<tr>License info</tr>
<tr>License info</tr>
<tr>License info</tr>
<tr>License info</tr> 
```

当您单击一个时：

```
<tr>License info</tr>
<tr>License info</tr>
<tr>Year1 Info</tr>
<tr>Year2 Info</tr>
<tr>Year3 Info</tr>
<tr>License info</tr>
<tr>License info</tr> 
```

最终：

```
<tr>License info</tr>
<tr>License info</tr>
<tr>Year1 Info</tr>
<tr>Year2 Info</tr>
<tr>Half1 Info</tr>
<tr>Quarter1 Info</tr>
<tr>Quarter2 Info</tr>
<tr>Invoice1 Info</tr>
<tr>Invoice2 Info</tr>
<tr>Invoice3 Info</tr>
<tr>Quarter3 Info</tr>
<tr>Quarter4 Info</tr>
<tr>Half2 Info</tr>
<tr>Year3 Info</tr>
<tr>License info</tr>
<tr>License info</tr> 
```

那么，有什么想法吗？有什么办法可以避免这种复杂的数据操作，同时还能让我得到一个 5 深的分层下拉列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:33:29.893

好的，我不完全明白你到底想要什么，但我这样做了，有点令人困惑，呵呵：

```
function get_data($data, $level = 0)
{
    $html = '';

    foreach ($data as $name => $val) {
        if (!is_int($name)) {
            if (!$level)
                $html .= '<tr>';
            $html .= '<ul>';
            $html .= '<li><span class="parent">'.$name.'</span>';
            $html .= get_data($val, $level + 1);
            $html .= '</li></ul>';
            if (!$level)
                $html .= '</tr>';
        } else {
            $html .= '<ul><li>'.$val.'</li></ul>';
        }
    }
    return $html;
} 
```

HTML 应该如下所示（使用 jQuery）：

```
<style>
span.parent {
    cursor:pointer;
}
ul ul {
    display:none;
}
</style>
<table>
<?php echo get_data($data) ?>
</table>
<script>
$('span.parent').click(function(){
    if ($(this).hasClass('open')) {
        $(this).parent().children('ul').hide();
        $(this).removeClass('open');
    } else {
        $(this).parent().children().show();
        $(this).addClass('open');
    }
})
</script> 
```

我用以下数组尝试了这个，并且......它工作得很好，但是，我不知道这是否是你要找的。

```
$data = array(
    'License' => array(
        'Year0' => array(
            'Half0' => array(
                'Quarter0' => array(
                    'invoice0' => array('data'),
                    'invoice1' => array('data')
                ),
                'QData' => array('data')
            ),
            'HData' => array('data'),
            'Half1' => array(
                'Quarter0' => array(
                    'invoice3' => array('data'),
                    'invoice4' => array('data')
                ),
                'Quarter1' => array(
                    'invoice5' => array('data'),
                    'invoice6' => array('data')
                ),
                'QData' => array('data')
            ),
            'HData' => array('data')
        ),
        'YData' => array('data')
    ),

    'License2' => array(
        'Year0' => array(
            'Half0' => array(
                'Quarter0' => array(
                    'invoice0' => array('data'),
                    'invoice1' => array('data'),
                ),
                'QData' => array('data')
            ),
            'HData' => array('data'),
            'Half1' => array(
                'Quarter0' => array(
                    'invoice3' => array('data'),
                    'invoice4' => array('data')
                ),
                'Quarter1' => array(
                    'invoice5' => array('data'),
                    'invoice6' => array('data')
                ),
                'QData' => array('data')
            ),
            'HData' => array('data')
        ),
        'YData' => array('data')
    )
); 
```

# c# - 如何在 Win8 Metro 应用程序的 Javascript 代码中捕获自己的 C# 事件？

> ID：12321864
> 
> 赞同：2
> 
> 时间：2012-09-07T16:17:30.897
> 
> 标签：c#, javascript, events, windows-8, microsoft-metro

我在 google 中找到了如何在 Javascript 代码中为 C# 事件实现事件侦听器的示例，但在我的情况下，似乎没有任何效果。

我的 C# 类：

```
namespace Engine
{

    public delegate void EventDelegate();

    public sealed class MyClass;
    {
        public event EventDelegate nowEvent;

        public void runJobs()
        {
           if (nowEvent == null)
           {
             Debug.WriteLine("What? Nobody subscribed???");
           }
        }
    }
} 
```

Javascript方面：

```
WinJS.Namespace.define("App", {
    myclass: new Engine.MyClass()
});

App.myclass.addEventListener("nowEvent", function onReady() {
            console.error("hello");
        });

App.myclass.runJobs(); 
```

将 onReady 函数附加到 nowEvent 事件并运行 runJobs() 后，MyClass.nowEvent 为空。

在 JS 中订阅自己的类的 C# 事件的工作语法是什么。有任何想法吗？

编辑：在 Gambit 的建议之后：

```
App.myclass.addEventListener("nowevent", function onReady() {
                console.error("hello");
            }); 
```

事件指针不再为空，但是当我触发事件时，我得到：

Engine.winmd 中发生了“System.InvalidCastException”类型的第一次机会异常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:57:33.067

您可能遇到的是投影更改所使用语言的名称大小写的方式。对于 Javascript，事件的约定是小写的。所以在 C# 中，您将事件定义为“nowEvent”，在 Javascript 中您将其称为“nowevent”。

```
App.myclass.addEventListener("nowevent", function onReady() {
        console.error("hello");
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:45:11.070

您可以使用该`WinJS.Application.queueEvent("myEvent")`功能。然后，您可以将事件侦听器添加到`WinJS.Application`via`WinJS.Application.addEventListener("myEevent",function(){});`

您还可以使用`WinJS.Utilities eventMixin`将事件添加到类。

```
WinJS.Class.mix(EventObject, eventMixin); 
```

然后，您可以在应用了 mixin 的类上使用 addEventListener、removeEventListener 等。

# java - 为什么 EclipseLink 为同一个实体查询两次？

> ID：12321866
> 
> 赞同：0
> 
> 时间：2012-09-07T16:17:39.057
> 
> 标签：java, jpa, eclipselink

我对 EclipseLink 有一个奇怪的行为。在这种情况下，我将@BatchFetch(value=BatchFetchType.IN) 添加到来自学生的地址的关系中。当我查询所有两个学生并且它查询相同的地址和学生两次时，我正在检查 EclipseLink 生成的 SQL：

EclipseLink 2.4.0 版

首先是没有 BatchFetch 的查询：

```
SELECT ID, NAME FROM STUDENT
SELECT ID, DESCRIPTION, STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID = ?)
    bind => [1]
SELECT ID, DESCRIPTION, STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID = ?)
    bind => [2] 
```

预期的 SQL，但现在当我将 BatchFetch 添加到地址关系时，会生成以下内容：

```
SELECT ID, NAME FROM STUDENT
SELECT ID, DESCRIPTION, STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID IN (?,?))
    bind => [1, 2]
SELECT ID, NAME FROM STUDENT WHERE (ID = ?)
    bind => [2]
SELECT ID, DESCRIPTION, STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID = ?)
    bind => [2] 
```

如果 EclipseLink 已经从第一个查询“SELECT ID, NAME FROM STUDENT”中获得了所有学生，为什么还要查询学生，如果它已经从 SELECT ID、DESCRIPTION、STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID) 中获得它，为什么还要查询 ADDRESS IN (1,2)) 这种奇怪的行为只有在添加 BatchFetch 注释时才会发生。

如您所见，它查询了两次学生和地址。

```
SELECT ID, NAME FROM STUDENT WHERE (ID = ?)
    bind => [2]

SELECT ID, DESCRIPTION, STUDENT_ID FROM ADDRESS WHERE (STUDENT_ID = ?)
    bind => [2] 
```

这些是类：

**学生.java：**

```
@Entity
public class Student implements Serializable {
    private Long id;
    private String name;
    private List<Address> addresses = new ArrayList<Address>();
    private List<Classroom> classrooms = new ArrayList<Classroom>();

    public Student() {

    }

    @Id
    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SEQSTUDENTID")
    @SequenceGenerator(name="SEQSTUDENTID", sequenceName="SEQSTUDENTID", allocationSize=1)
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @OneToMany(mappedBy="student", cascade=CascadeType.ALL, fetch=FetchType.EAGER)
    @BatchFetch(value=BatchFetchType.IN)
    public List<Address> getAddresses() {
        return addresses;
    }

    public void setAddresses(List<Address> addresses) {
        this.addresses = addresses;
    }

    @ManyToMany(mappedBy="students", cascade=CascadeType.ALL, fetch=FetchType.LAZY)
    public List<Classroom> getClassrooms() {
        return classrooms;
    }

    public void setClassrooms(List<Classroom> classrooms) {
        this.classrooms = classrooms;
    }

} 
```

**地址.java：**

```
@Entity
public class Address implements Serializable {
    private Long id;
    private Student student;
    private String description;

    @Id
    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="SEQADDRESSID")
    @SequenceGenerator(name="SEQADDRESSID", sequenceName="SEQADDRESSID", allocationSize=1)
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @ManyToOne
    public Student getStudent() {
        return student;
    }

    public void setStudent(Student student) {
        this.student = student;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }
} 
```

**测试**：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({"/META-INF/application-context-root.xml"})
@Transactional
public class TestingFetch {

    @PersistenceContext
    private EntityManager entityManager;
    private Student student1;
    private Student student2;

    @Before
    public void setUp() {
        List<Student> students = new ArrayList<Student>();

        student1 = new Student();
        student1.setName("Alfredo Osorio");

        Address student1Address1 = new Address();
        student1Address1.setDescription("FirstAddressStudent1");
        student1Address1.setStudent(student1);
        student1.getAddresses().add(student1Address1);

        Address student1Address2 = new Address();
        student1Address2.setDescription("SecondAddressStudent1");
        student1Address2.setStudent(student1);
        student1.getAddresses().add(student1Address2);

        students.add(student1);

        student2 = new Student();
        student2.setName("Jorge Ramirez");
        students.add(student2);

        Address student2Address1 = new Address();
        student2Address1.setDescription("FirstAddressstudent2");
        student2Address1.setStudent(student2);
        student2.getAddresses().add(student2Address1);

        Address student2Address2 = new Address();
        student2Address2.setDescription("SecondAddressstudent2");
        student2Address2.setStudent(student2);
        student2.getAddresses().add(student2Address2);

        Classroom classroom1 = new Classroom();
        classroom1.setName("Mathematics");

        Classroom classroom2 = new Classroom();
        classroom2.setName("Physics");

        Classroom classroom3 = new Classroom();
        classroom3.setName("Chemistry");

        classroom1.getStudents().add(student1);
        student1.getClassrooms().add(classroom1);
        classroom1.getStudents().add(student2);
        student2.getClassrooms().add(classroom1);

        classroom2.getStudents().add(student1);
        student1.getClassrooms().add(classroom2);

        classroom3.getStudents().add(student2);
        student2.getClassrooms().add(classroom3);

        for (Student student : students) {
            entityManager.persist(student);         
        }

        entityManager.flush();
        entityManager.clear();
    }

    @Test
    public void testFetch1() {
        String jpql = "select m from Student m";
        Query query = entityManager.createQuery(jpql);
        List<Student> list = (List<Student>)query.getResultList();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T17:50:04.907

从你的关系中删除渴望。EAGER 导致在第一个查询完成之前执行批处理查询，从而导致额外的选择。

（即，在构建第一个学生时，批量查询会选择所有地址，并且该地址有一个返回给 Student 的 ManyToOne，它也是 EAGER，因此会导致查询。

# excel - Excel -- 显示距今天 X 个月的日期

> ID：12321869
> 
> 赞同：3
> 
> 时间：2012-09-07T16:18:01.827
> 
> 标签：excel

有什么简单的方法可以做到这一点？在 VBA 中，我通常使用 dateadd() 但由于这是 Excel，我没有该功能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T16:24:42.127

以下函数完成了这项工作：

```
=DATE(YEAR(A2),MONTH(A2)+B2,MIN(DAY(A2),DAY(DATE(YEAR(A2),MONTH(A2)+B2+1,0)))) 
```

例如：

```
Date       Add Months   Result  
8/1/2012   6            =DATE(YEAR(A2),MONTH(A2)+B2,MIN(DAY(A2),DAY(DATE(YEAR(A2),MONTH(A2)+B2+1,0)))) 
```

结果：

```
Date       Add Months   Result  
8/1/2012   6            2/1/2013 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T16:46:02.457

您还可以使用 EDATE 工作表功能。例如 EDATE(DATE(2012,8,1),6) 返回 2013 年 2 月 1 日。

# javascript - Web浏览器内的离线应用程序存储数据并在之后上传

> ID：12321871
> 
> 赞同：0
> 
> 时间：2012-09-07T16:18:02.237
> 
> 标签：javascript, html, offline, offline-browsing

我需要构建一个应用程序以在离线工作（没有任何互联网连接）的网络浏览器中运行，并以我可以在连接互联网后将这些数据上传到服务器的方式存储数据。

例如 HTML 表单

```
<html>

<body>

    <form>

        Name: <input type="text" name="name" /><br />
        E-mail: <input type="text" name="email" /><br />

        <input type="submit" name="save" />
    </form>

</body> 
```

因此，当我提交此表单时，浏览器会将数据保存在某处，当我连接时，我可以将其上传到服务器...

有人知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:22:36.723

使用[本地存储](http://diveintohtml5.info/storage.html)来保存离线数据。您可以使用 AJAX（jQuery 使其变得简单：[请参阅此处](http://api.jquery.com/jQuery.ajax/)）尝试将本地存储数据发布到您的服务器。您可能需要设置一个时间间隔以发布到服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:22:48.000

保存到本地存储（在支持它的浏览器中）然后与网络服务器同步是我的做法。

这里真正的问题是浏览器并不是真正为此而构建的，因此您需要找到一些聪明的解决方案，并且只能在现代浏览器中使用。

原生应用程序可能是更好的选择。

# coldfusion - 使用 cachedwithin 重置缓存查询

> ID：12321874
> 
> 赞同：0
> 
> 时间：2012-09-07T16:18:27.497
> 
> 标签：coldfusion, coldfusion-9

在里面`cffunction`我有一个查询，我想通过将 设置`cachedwitin`为一个大的值来长期缓存。但是，我还想在某些情况下清除该缓存。

我在很多地方都这样做了，但是在其中一个地方，缓存永远不会更新，如果我要求它给我缓存的值，我总是会得到原始值。

[cfquery 文档](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html)指出：

> 要使用缓存数据，当前查询必须使用相同的 SQL 语句、数据源、查询名称、用户名和密码。

`cfqueryparam`查询就是这种情况，因为它是一条 sql 语句，除了;之外没有非 sql 语句。数据源和查询名称不变，用户名和密码未指定。

相关代码为：

```
<!--- Long cache the query since the values rarely change, but allow the cache to be cleared. --->
<cfif Arguments.ClearCache EQ false>
    <cfset local.CachedWithin = CreateTimeSpan(7,0,0,0)>
<cfelse>
    <cfset local.CachedWithin = CreateTimeSpan(0,0,0,-1)>
</cfif>

<cfquery name="local.qryName" datasource="#Variables.DSN#" cachedwithin="#local.CachedWithin#">
    SELECT
        [User].[Name]
    FROM
        [User]
    WHERE
        [User].[UserID] = <cfqueryparam value="#Arguments.UserID#" cfsqltype="cf_sql_integer">
</cfquery> 
```

为什么这在其他地方有效，而在这里却不行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:18:27.497

对于文档中未提及的缓存查询还有一个额外的“相同性”要求。该说明应以以下结尾：

> ...密码和任何 cfqueryparam 值的基础数据类型。

更改您的代码，以便`Arguments.UserID`强制为数据类型。在您的情况下，这可以通过将以下代码放在 cfquery 之前来完成：

```
<!--- Make sure data types used in query are consistent --->
<cfset local.UserID = Int(Arguments.UserID)> 
```

并将`cfqueryparam`值更改为`value="#local.UserID#"`。

我已将上述内容表述为文档中的一个遗漏，但我怀疑这是 CF9 中的一个错误。

# mysql - MySql varchar 类型的性能

> ID：12321885
> 
> 赞同：0
> 
> 时间：2012-09-07T16:18:55.313
> 
> 标签：mysql, sql, oracle, varchar, varchar2

据我了解，如果您将列声明为`varchar(15)`or `varchar(200)`，则内存大小没有区别。如果您存储 4 个字符的字符串，它应该只使用大约 4 个字节。这与 Oracle 中的 varchar2 相同。但是，对于 Oracle，它们的性能是不同的，因为您设置的大小越大，使用的开销就越多。

在 MySQL（或任何其他数据库）中是否相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:25:19.493

*   VARCHAR：

    1.  存储可变长度的字符串。
    2.  length 参数指定字符串的最大长度
    3.  它最多可存储 2000 个字节的字符
    4.  它将占用 NULL 值的空间
    5.  字符串的总长度是在创建数据库时定义的。
*   VARCHAR2：

    1.  存储可变长度的字符串。
    2.  length 参数指定字符串的最大长度
    3.  它最多可存储 4000 个字节的字符
    4.  它不会为 NULL 值占用空间
    5.  字符串的总长度是在给定字符串时定义的

# c# - 如何根据来自另一个下拉列表的选择填充下拉列表？

> ID：12321886
> 
> 赞同：0
> 
> 时间：2012-09-07T16:18:56.660
> 
> 标签：c#, asp.net, drop-down-menu

```
protected void ddlEnvironment_SelectedIndexChanged(object sender, EventArgs e)
{
    if (ddlEnvironment.SelectedIndex == 0)
    {
        ddlServers.Items.Add("item1");
    }

    if (ddlEnvironment.SelectedIndex == 1)
    {
        ddlServers.Items.Add("item2");
    }

    if (ddlEnvironment.Text == "Production")
    {
    }
} 
```

以上不起作用。当我在 ddlEnvironment 上进行选择并且它是列表中的第一项（索引 0）时，另一个下拉列表未使用“item1”进行更新。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:22:00.500

默认下拉列表不做回发可能有不同的原因。

*   检查你是否有`AutoPostBack="true"`
*   您将 ddlEnvironment 绑定在 !Page.IsPostBack 块中，以便它在回发时保持其状态

    ```
    if(!Page.IsPostBack)
    {
       ddlEnvironment.AuutoPostBack = true;
       ddlEnvironment.DataSource = datasource; 
       ddlEnvironment.DataBind();
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:24:49.300

我想你有`AutoPostBack=true`- 对吧？

如果您在 Page_Load() 事件处理程序中初始化 ddlEnvironment，它会在回发时被重置。

你需要做这样的事情：

```
If (!Page.IsPostback)
{ 
    // initialize ddlEnvironment here 
} 
```

# parallel-processing - 混合分布式和共享内存的混合 OpenMP + OpenMPI？

> ID：12321889
> 
> 赞同：4
> 
> 时间：2012-09-07T16:19:20.117
> 
> 标签：parallel-processing, openmp, openmpi

我正在开发一个代码来按照我的标准执行一些非常大的计算。根据单 CPU 估计，预期运行时间约为 10 个 CPU 年，内存需求约为 64 GB。几乎不需要 IO。我有问题的代码的串行版本（用 C 编写）运行良好，我必须开始考虑如何最好地并行化代码。

我可以访问具有 ~64 GB RAM 和每个节点 16 个内核的集群。我可能会限制自己使用例如 <= 8 个节点。我正在想象一个设置，其中内存在单个节点上的线程之间共享，不同节点上使用单独的内存，节点之间的通信相对较少。

从我目前阅读的内容来看，我提出的解决方案是使用混合 OpenMP + OpenMPI 设计，使用 OpenMP 管理各个计算节点上的线程，使用 OpenMPI 在节点之间传递信息，如下所示： [https：/ /www.rc.colorado.edu/crcdocs/openmpi-openmp](https://www.rc.colorado.edu/crcdocs/openmpi-openmp)

我的问题是这是否是实现这种并行化的“最佳”方式。我是一位经验丰富的 C 程序员，但在并行编程方面的经验非常有限（有点使用 OpenMP，没有使用 OpenMPI；我过去的大部分工作都是令人尴尬的并行）。作为替代建议，OpenMPI 是否可以在单个主机上有效共享内存？如果是这样，那么我可以避免使用 OpenMP，这会使事情变得更简单（一个 API 而不是两个）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-10T16:34:43.967

混合 OpenMP 和 MPI 编码最适用于可以清楚地识别两个独立并行级别的问题 - 粗粒度一级和嵌套在每个粗略子域内的细粒度一级。由于在使用消息传递实现时，细粒度并行需要大量通信，因此它无法扩展，因为通信开销可以与正在完成的工作量相当。由于 OpenMP 是共享内存范式，不需要数据通信，只需要访问同步，更适合更细粒度的并行任务。OpenMP 还受益于线程之间的数据共享（以及在现代多核 CPU 上共享最后一级缓存的相应缓存共享），并且通常比等效的消息传递代码需要更少的内存，其中一些数据可能需要在所有进程中复制。另一端的 MPI 可以跨节点运行，并且不限于在单个共享内存系统上运行。

您的话表明您的并行化非常粗粒度或属于所谓的尴尬并行问题。如果我是你，我会去混血儿。如果您只使用 OpenMP 编译指示而不使用运行时调用（例如`omp_get_thread_num()`），您的代码可以编译为纯 MPI（即使用非线程 MPI 进程）或混合编译，具体取决于您是否启用 OpenMP（您也可以提供一个虚拟的 OpenMP 运行时以使代码能够被编译为串行）。这将为您提供 OpenMP（数据共享、缓存重用）和 MPI（透明网络、可扩展性、轻松启动作业）的好处，并添加了关闭 OpenMP 并在仅 MPI 模式下运行的选项。作为额外的奖励，您将能够迎接未来，这看起来就像是让我们相互连接的多核 CPU。

# c - 哪个是在 C 中执行这些乘法的最佳方法

> ID：12321890
> 
> 赞同：3
> 
> 时间：2012-09-07T16:19:23.037
> 
> 标签：c

我使用 MAXIM 的[71M6511](http://www.maxim-ic.com/datasheet/index.mvp/id/6845)将这个函数形成一个示例代码，用于能量计设计，该 71M6511 旨在执行此计算。

```
E = W * 6.6972*10^-13 * VMAX * IMAX (Wh)

VMAX = 600 (but it is stored in the code with a resolution of 0.1 making it 6000)
IMAX = 208 (also stored as 2080) 
```

这里的 E 是瓦特小时的能量，

W是能量芯片测量的千瓦时的原始值。[计算根据能量芯片文档](http://pdfserv.maximintegrated.com/en/an/AN4740.pdf)（第 77 页）中提供的上述公式将其转换为瓦特小时，并将其作为带符号的 32 位整数返回。

这是代码

```
#define ONE_MILLION (1000000L)
#WATTSCALE 1885L        // 6.6972E-12 * 2^48.

 static U32 Whr (U08x *w)
{                                             // 'w' is a 8-byte quantity.

U08 xdata x[13], y[12];                  // Need extra digit for divide.
    U32 xdata scale;
    U08 xdata t[4+4+1];

    scale = (U32) Vmax * (U32) Imax;          //scale=[Vmax*10E+01] * [Imax*10E+01].
    multiply_8_4 (y, w,(U08x *)&scale);       // y = w * Vmax * Imax * 10E+02.
    scale = WATTSCALE;                        //[LSB * 2^48 * 10E+01]  (10E-03 Wh).
    multiply_8_4 (x + 1, y,(U08x *)&scale);   //[x*2^16] = [y/2^32]*[LSB * 2^48] (mWh)
                                              //..dropped low-order 4-bytes of 'y'.
    scale = ONE_MILLION;                      // Modulo ONE_MILLION.
    divide (x + 1, (U08x *) &scale, 10, 4, t);// x / 1,000,000;
    x[7] = 0;                                 //Clear high order of 4-byte result.
    return (* (U32x *) &x[7]);                // Return 32-bit answer (x % 1,000,000). 
} 
```

multiply_8_4() 是一个函数，它将一个 8 字节数据（这是 w 指向的数据）乘以一个 4 字节数据（缩放），并将结果放在另一个缓冲区（在本例中为缓冲区 x）

我只是想知道为什么简单的计算（在我看来）如此复杂，因为乘法和除法是 2^48 和 2^32 等等。

除了程序员的选择之外，还有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T16:53:00.650

看来他们使用的是不进行浮点计算的 8 位微控制器。他们还指出，从内存中获取数据以字节而不是短整数或整数形式完成时效率更高。您展示的代码实现了一个定点乘法，其中常量和值按比例缩放以在二进制点的两侧提供足够的空间，从而不会发生溢出，并且有足够的精度来满足他们的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:56:51.023

出于某种原因，程序员选择/不得不对整数而不是浮点值进行计算。所以：

1.  他不能对有太多有效数字低于 1 的值进行运算。如果您尝试将 6.6972*10^-13 存储为整数，您将得到 0。因此，6.6972*10^-13 乘以 2^48 得到 1885.094214 ...在点之后切割数字可能很好。

2.  不是

# javafx - JavaFX 自动滚动自动更新文本

> ID：12321892
> 
> 赞同：4
> 
> 时间：2012-09-07T16:19:29.090
> 
> 标签：javafx, javafx-2, processbuilder, fxml

我无法回答的关于 JavaFX 的新手问题，尽管我知道它必须非常简单，并且在我看过的任何地方都找不到任何资源（教程、许多 Oracle 在线文档、文章、以及知名 JavaFX 博主等）

我正在开发一个命令行（脚本）运行应用程序，并且我已经成功地从脚本中获得了输出（通过 ProcessBuilder），我可以以持续的方式显示，因为命令行上发生了一些事情。也就是说，我可以`System.out.println(line);`整天做，在控制台中显示输出，它只是从正在运行的“myProcess”返回的输入流中返回输出，创建如下：

```
BufferedReader bri = new BufferedReader(new InputStreamReader(myProcess.getInputStream())) 
```

所以我能够看到脚本返回的所有输出。

我想设置一个 JavaFX TextArea 或 ScrollPane 或者，不确定是什么，来显示这个输出文本（有很多，比如几千行）作为脚本中正在发生的事情的持续“进展”，当它发生的时候。我有一个场景，我有按钮并从该场景获取输入以启动脚本运行，但现在我想显示单击“运行此脚本”按钮的结果，可以这么说。

我假设我需要[按照此处所述创建一个 TextArea，](http://docs.oracle.com/javafx/2/api/javafx/scene/control/TextArea.html)或者[TextBuilder](http://docs.oracle.com/javafx/2/api/javafx/scene/control/TextAreaBuilder.html)可能对开始制作它很有用。没有把握。

我需要一些帮助来设置绑定或自动滚动/自动更新部分。

有人可以给我一个开始的地方，用 JavaFX 做这个吗？我宁愿不使用 Swing。

（我正在使用 JavaFX 2.2、JDK 1.7u7 和所有最新的东西，是的，这是一个 FXML 应用程序——所以最好这样做。）

更新： Sergey Grinev 的回答在绑定部分非常有帮助。但是这里有一些关于我要求“如何设置帮助”时的更多详细信息——基本上，我需要将控制权返回到主场景以允许用户取消脚本，或者以其他方式监控这是怎么回事。所以我想“生成”运行该脚本的进程（也就是说，有某种“自由运行的进程”），但仍然从中获得输出。（在我最初的问题中，我不是很清楚。）

我在这里使用的技术（见下文）是对进程执行 waitFor ，但这当然意味着在脚本执行时对话框/场景是“挂起”的。我想重新获得控制权，但是如何将“p”（进程）传递给其他控制器部分（或者，简单地启动传递参数的其他进程以启动脚本并让它启动脚本) 然后通过绑定 Sergey Grinev 提到的方式进行自动更新——而不“挂起”场景/窗口？另外：如果用户请求，我可以“停止”这个其他进程吗？

这是我当前的代码（“等待”脚本——运行需要 20-40 分钟！——完成；这*不是*我想要的，我希望将控制权返回给用户）：

```
public class MyController implements Initializable {  
  @FXML
  private void handleRunScript(ActionEvent event) throws IOException {

    ProcessBuilder pb = new ProcessBuilder("myscript.sh", "arg1", "arg2", ...);

    Process p = pb.start();
    try {
      BufferedReader bri = new BufferedReader
        (new InputStreamReader(p.getInputStream()));
      String line;

      while ((line = bri.readLine()) != null) {
        System.out.println(line);
        textAreaRight.setText(line);
      }
      bri.close();
      p.waitFor();
    }
    catch (Exception err) {
      err.printStackTrace();
    }    
  }

  @FXML
  private void handleCancel(ActionEvent event) {
    doSomethingDifferent();
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:35:56.673

1.  要记录字符串，您可以使用 TextArea
2.  为了使其异步，您需要为输出阅读器创建一个单独的线程。

* * *

```
public class DoTextAreaLog extends Application {

    TextArea log = new TextArea();
    Process p;

    @Override
    public void start(Stage stage) {
        try {
            ProcessBuilder pb = new ProcessBuilder("ping", "stackoverflow.com", "-n", "100");

            p = pb.start();

            // this thread will read from process without blocking an application
            new Thread(new Runnable() {
                @Override
                public void run() {
                    try {
                        //try-with-resources from jdk7, change it back if you use older jdk
                        try (BufferedReader bri = new BufferedReader(new InputStreamReader(p.getInputStream()))) {
                            String line;

                            while ((line = bri.readLine()) != null) {
                                log(line);
                            }
                        }
                    } catch (IOException ex) {
                        ex.printStackTrace();
                    }
                }
            }).start();

            stage.setScene(new Scene(new Group(log), 400, 300));
            stage.show();
        } catch (IOException ex) {
            ex.printStackTrace();
        }

    }

    @Override
    public void stop() throws Exception {
        super.stop();
        // this called on fx app close, you may call it in user action handler
        if (p!=null ) {
            p.destroy();
        }
    }

    private void log(final String st) {
        // we can access fx objects only from fx thread
        // so we need to wrap log access into Platform#runLater
        Platform.runLater(new Runnable() {

            @Override
            public void run() {
                log.setText(st + "\n" + log.getText());
            }
        });
    }

    public static void main(String[] args) {
        launch();
    }
} 
```

# git - git push 失败，除非我先在远程仓库上执行 gc

> ID：12321893
> 
> 赞同：5
> 
> 时间：2012-09-07T16:19:37.353
> 
> 标签：git

我在我的 Windows 7 机器上使用 git，推送到 Server 2008 机器上的共享文件夹。在过去的 6 个月里，这一直运行良好。但是，截至昨天，我无法再推送到远程仓库。每次我尝试，我都会得到以下信息：

```
$ git push
Counting objects: 39, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (23/23), done.
Writing objects: 100% (23/23), 8.42 KiB, done.
Total 23 (delta 15), reused 0 (delta 0)
Unpacking objects: 100% (23/23), done.
error: Couldn't set refs/heads/my-branch
To //my-server/Code/my-project.git
 ! [remote rejected] my-branch -> my-branch (failed to write)
error: failed to push some refs to '//my-server/Code/my-project.git 
```

谷歌搜索“未能推送某些参考”错误会给出关于没有先拉（我完全是最新的）和没有正确权限（我可以完全访问所有内容，并且可以创建/删除/编辑文件）的各种结果通过资源管理器在远程仓库中）。

然后，我偶然发现了这篇博客文章[http://henke.ws/post.cfm/error-failed-to-push-some-refs](http://henke.ws/post.cfm/error-failed-to-push-some-refs)，其中提到您可能必须在远程存储库上运行一些清理命令。所以我在远程存储库上运行了 git gc ：

```
$ git gc
Counting objects: 3960, done.
Compressing objects: 100% (948/948), done.
Writing objects: 100% (3960/3960), done.
Total 3960 (delta 2971), reused 3942 (delta 2964) 
```

你瞧，我又能推了！

```
$ git push
Counting objects: 39, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (23/23), done.
Writing objects: 100% (23/23), 8.42 KiB, done.
Total 23 (delta 15), reused 0 (delta 0)
Unpacking objects: 100% (23/23), done.
To //my-server/Code/my-project.git
   8153afd..1385d28  my-branch -> my-branch 
```

但是，问题是我现在**每次想要执行 push 时**都必须在远程存储库上运行 gc 。如果我不这样做，我会再次收到“无法推送一些参考”错误。

那么，为什么我的回购如此失败？我怎样才能永久解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T23:57:39.000

看来您正在推送 Windows 网络共享，而不是使用 ssh 或 git 协议。这意味着您的本地计算机必须将文件写入网络共享，因此可能会受到与该服务器相关的任何锁定文件或权限问题的阻碍。

推送分支时，在写入对象后，git 将通过写入文件 .git/refs/heads/my-branch 来更新分支的 ref。看来该文件当前不可从您的客户端写入。

当您执行 gc 时，将从 refs 目录中的松散文件中收集 refs 并将其放入文本文件 .git/packed-refs 中，然后删除单个 ref 文件。

我的理论是，当 ref 作为服务器上的松散文件存在时，您的推送失败，因为您无权覆盖现有文件，而您确实有权创建新文件。使用 gc 打包 refs 后，ref 文件不再存在，因此您可以再次推送一次。

我建议的修复是：

1.  验证您是否可以覆盖客户端的现有文件，如果不能修复权限或文件锁定问题
2.  切换到使用 git 协议，这个博客似乎很好地概述了 Windows 的选项[http://freshbrewedcode.com/derekgreer/2012/02/19/hosting-a-git-repository-in-windows/](http://freshbrewedcode.com/derekgreer/2012/02/19/hosting-a-git-repository-in-windows/)

作为最后的手段，如果你发现自己被 gc 选项卡住了，你可以尝试运行 'git pack-refs -all'。这将比每次使用 gc 解决问题要快。

# php - 如何防止字段数据被转义并在 CodeIgniter 中保留 html 和图像样式？

> ID：12321894
> 
> 赞同：1
> 
> 时间：2012-09-07T16:19:43.003
> 
> 标签：php, codeigniter, escaping, codeigniter-2, codeigniter-form-helper

我正在使用 CKEditor 和 KCFinder 构建一个相对简单的 CMS。目前，事情进展顺利。但是，当我开始将图像集成到混合中时，我注意到了一个问题。iamges 的链接返回错误。看起来 CKEditor 可能正在更改我的引号等。当我查看 mysql 时它看起来是正确的，但是当我查看编辑器时它看起来并不总是正确的，但绝对不是。大多数时候它确实如此，但这次它看起来像这样：

```
<img alt="" data-cke-saved-src="http://placekitten.com.s3.amazonaws.com/homepage-samples/200/287.jpg" 
     src="http://placekitten.com.s3.amazonaws.com/homepage-samples/200/287.jpg"
     200px;="" height:="" 287px;="" float:="" left;"="">i 
```

例如，在这里查看这个页面：http: [//testosm.phpfogapp.com/pages/index/1/3/](http://testosm.phpfogapp.com/pages/index/1/3/)

我在这里发布了所有代码：[https](https://github.com/jshultz/monkey-cms) ://github.com/jshultz/monkey-cms ，以防你想看看我在做什么？对于任何反馈，我们都表示感谢。

**更新：** 我打开了 global_xss_filtering 并且数据现在肯定更干净了。所有的样式都被删除了。很遗憾。这几乎是完美的。现在，如果我能保持图像样式就完美了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T02:17:57.383

我想到了。这是 XSS_Clean 函数。它正在剥离样式。很高兴知道。

# python - 如何使用 PIL 确定具有共享值的像素区域

> ID：12321899
> 
> 赞同：4
> 
> 时间：2012-09-07T16:19:53.930
> 
> 标签：python, numpy, scipy, python-imaging-library, cluster-analysis

我需要将图像划分为 RGB 值通过特定测试的像素区域。
我可以扫描图像并检查每个像素的值，但是将它们聚集成区域然后获取这些区域坐标（x，y，宽度，高度）的部分让我完全黑暗:)
这是我到目前为止的代码

```
from PIL import Image

def detectRedRegions(PILImage):
      image = PILImage.load()
      width, height = PILImage.size
      reds = []
      h = 0
      while h < height:
        w = 0
        while w < width:
          px = image[w, h]
          if is_red(px):
            reds.append([w, h])
            # Here's where I'm being clueless 
          w +=1
        h +=1 
```

我读了很多关于集群的文章，但无法理解这个主题，任何适合我需要的代码示例都会很棒（希望能启发

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T18:29:43.157

[编辑]

虽然下面的解决方案有效，但可以做得更好。这是一个名称更好、性能更好的版本：

```
from itertools import product
from PIL import Image, ImageDraw

def closed_regions(image, test):
    """
    Return all closed regions in image who's pixels satisfy test.
    """
    pixel = image.load()
    xs, ys = map(xrange, image.size)
    neighbors = dict((xy, set([xy])) for xy in product(xs, ys) if test(pixel[xy]))
    for a, b in neighbors:
        for cd in (a + 1, b), (a, b + 1):
            if cd in neighbors:
                neighbors[a, b].add(cd)
                neighbors[cd].add((a, b))
    seen = set()
    def component(node, neighbors=neighbors, seen=seen, see=seen.add):
        todo = set([node])
        next_todo = todo.pop
        while todo:
            node = next_todo()
            see(node)
            todo |= neighbors[node] - seen
            yield node
    return (set(component(node)) for node in neighbors if node not in seen)

def boundingbox(coordinates):
    """
    Return the bounding box that contains all coordinates.
    """
    xs, ys = zip(*coordinates)
    return min(xs), min(ys), max(xs), max(ys)

def is_black_enough(pixel):
    r, g, b = pixel
    return r < 10 and g < 10 and b < 10

if __name__ == '__main__':

    image = Image.open('some_image.jpg')
    draw = ImageDraw.Draw(image)
    for rect in disjoint_areas(image, is_black_enough):
        draw.rectangle(boundingbox(region), outline=(255, 0, 0))
    image.show() 
```

与`disjoint_areas()`下面不同，`closed_regions()`返回像素坐标集而不是它们的边界框。

此外，如果我们使用[泛洪](http://en.wikipedia.org/wiki/Flood_fill)算法而不是连接组件算法，我们可以让它更简单，速度大约是原来的两倍：

```
from itertools import chain, product
from PIL import Image, ImageDraw

flatten = chain.from_iterable

def closed_regions(image, test):
    """
    Return all closed regions in image who's pixel satisfy test.
    """
    pixel = image.load()
    xs, ys = map(xrange, image.size)
    todo = set(xy for xy in product(xs, ys) if test(pixel[xy]))
    while todo:
        region = set()
        edge = set([todo.pop()])
        while edge:
            region |= edge
            todo -= edge
            edge = todo.intersection(
                flatten(((x - 1, y), (x, y - 1), (x + 1, y), (x, y + 1)) for x, y in edge))
        yield region

# rest like above 
```

它的灵感来自[Eric S. Raymond 的 Floodfill 版本](http://mail.python.org/pipermail/image-sig/2005-September/003559.html)。

[/编辑]

一个人可能会使用floodfill，但我喜欢这个：

```
from collections import defaultdict
from PIL import Image, ImageDraw

def connected_components(edges):
    """
    Given a graph represented by edges (i.e. pairs of nodes), generate its
    connected components as sets of nodes.

    Time complexity is linear with respect to the number of edges.
    """
    neighbors = defaultdict(set)
    for a, b in edges:
        neighbors[a].add(b)
        neighbors[b].add(a)
    seen = set()
    def component(node, neighbors=neighbors, seen=seen, see=seen.add):
        unseen = set([node])
        next_unseen = unseen.pop
        while unseen:
            node = next_unseen()
            see(node)
            unseen |= neighbors[node] - seen
            yield node
    return (set(component(node)) for node in neighbors if node not in seen)

def matching_pixels(image, test):
    """
    Generate all pixel coordinates where pixel satisfies test.
    """
    width, height = image.size
    pixels = image.load()
    for x in xrange(width):
        for y in xrange(height):
            if test(pixels[x, y]):
                yield x, y

def make_edges(coordinates):
    """
    Generate all pairs of neighboring pixel coordinates.
    """
    coordinates = set(coordinates)
    for x, y in coordinates:
        if (x - 1, y - 1) in coordinates:
            yield (x, y), (x - 1, y - 1)
        if (x, y - 1) in coordinates:
            yield (x, y), (x, y - 1)
        if (x + 1, y - 1) in coordinates:
            yield (x, y), (x + 1, y - 1)
        if (x - 1, y) in coordinates:
            yield (x, y), (x - 1, y)
        yield (x, y), (x, y)

def boundingbox(coordinates):
    """
    Return the bounding box of all coordinates.
    """
    xs, ys = zip(*coordinates)
    return min(xs), min(ys), max(xs), max(ys)

def disjoint_areas(image, test):
    """
    Return the bounding boxes of all non-consecutive areas
    who's pixels satisfy test.
    """
    for each in connected_components(make_edges(matching_pixels(image, test))):
        yield boundingbox(each)

def is_black_enough(pixel):
    r, g, b = pixel
    return r < 10 and g < 10 and b < 10

if __name__ == '__main__':

    image = Image.open('some_image.jpg')
    draw = ImageDraw.Draw(image)
    for rect in disjoint_areas(image, is_black_enough):
        draw.rectangle(rect, outline=(255, 0, 0))
    image.show() 
```

在这里，同时满足的相邻像素对`is_black_enough()`被解释为图中的边。此外，每个像素都被视为自己的邻居。由于这种重新解释，我们可以将连通分量算法用于图，这很容易实现。结果是所有像素满足的区域的边界框的序列`is_black_enough()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T15:47:14.597

您想要的称为图像处理中的区域标记或连接组件检测。[scipy.ndimage](https://docs.scipy.org/doc/scipy/reference/ndimage.html)包中提供了一个实现。因此，如果您安装了 numpy + scipy，则以下内容应该可以工作

```
import numpy as np
import scipy.ndimage as ndi
import Image

image = Image.load()
# convert to numpy array (no data copy done since both use buffer protocol)
image = np.asarray(image)
# generate a black and white image marking red pixels as 1
bw = is_red(image)
# labeling : each region is associated with an int
labels, n = ndi.label(bw)
# provide bounding box for each region in the form of tuples of slices
objects = ndi.find_objects(labels) 
```

# sql-server - 为什么 SQL Server 向非唯一聚集索引添加 4 字节整数

> ID：12321905
> 
> 赞同：2
> 
> 时间：2012-09-07T16:20:22.080
> 
> 标签：sql-server, indexing, clustered-index, non-clustered-index

可以将非唯一列定义为聚集索引和非聚集索引。但是，在聚集索引的情况下，如果列未定义为唯一，SQL Server 会向索引列添加一个 4 字节整数。这样做是为了在内部保持记录的“唯一性”，即使两个或多个记录可能具有该列的值。为什么在非聚集索引的情况下不需要这个整数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T17:39:51.270

非聚集索引已包含聚集索引列，因此它可以引用与其关联的确切行。因此，对于聚集索引上的唯一标识符，非聚集索引也将包括唯一标识符。

这里有一个很好的解释：[Understanding and Examining the Uniquifier in SQL Server](http://www.mssqltips.com/sqlservertip/2082/understanding-and-examining-the-uniquifier-in-sql-server/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T17:41:02.323

我相信这与行定位器有关。

非聚集索引行的宽度 = 非聚集索引列的宽度 + 聚集索引列的宽度 = 列数据类型的大小 + 列数据类型的大小。

# tfs - 如何在 TFS 上设置构建并自动将项目上传到服务器

> ID：12321909
> 
> 赞同：0
> 
> 时间：2012-09-07T16:20:45.693
> 
> 标签：tfs, tfsbuild, tfs-sdk

是否有可能在 TFS 上设置将构建项目并将其自动上传到测试服务器的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:52:26.310

您可以使用 Cruisecontrol.net 之类的工具为您自动执行此操作。这里有很多阅读，但最重要的是，是的，这是可能的。

[http://cruisecontrolnet.org/projects/ccnet/documents](http://cruisecontrolnet.org/projects/ccnet/documents)

> 服务器应用程序，即自动集成服务器，是 CruiseControl.NET 项目的核心。服务器通过直接监控团队的源代码控制存储库来自动化集成过程。每次开发人员提交一组新的修改时，服务器都会自动启动集成构建以验证更改。构建完成后，服务器会通知开发人员他们提交的更改是否集成成功。实际上，集成变得像签入代码一样简单。使用自动集成服务器不仅使集成变得容易，而且还保证了集成构建的发生。没有开发人员在签入后忘记验证更改的危险。CCNet 服务器提供了几个关键功能：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T08:45:38.137

正如`paulsm4`评论中发布的那样。

> 微软的答案是“脚本 MSBuild”。

# java - 如何将我的 XML 更改为休眠以定义数据源

> ID：12321910
> 
> 赞同：0
> 
> 时间：2012-09-07T16:20:46.920
> 
> 标签：java, spring, hibernate, spring-mvc

有人可以告诉我如何将我的 XML 更改为休眠以定义数据源。我想看看它的好样本。下面是我的xml文件。有人可以发布 Hibernate 定义 DataSource 的样子：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jdbc="http://www.springframework.org/schema/jdbc"

    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/context 
                            http://www.springframework.org/schema/context/spring-context-3.0.xsd
                            http://www.springframework.org/schema/tx
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                            http://www.springframework.org/schema/jdbc
                            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd">

    <context:property-placeholder location="classpath:jdbc.properties" />
    <context:component-scan base-package="org.uftwf" />
    <tx:annotation-driven transaction-manager="hibernateTransactionManager" />

    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
        destroy-method="close">

        <!-- these are C3P0 properties --> 
        <property name="acquireIncrement" value="${database.acquireIncrement}" />
        <property name="minPoolSize" value="${database.minPoolSize}" />
        <property name="maxPoolSize" value="${database.maxPoolSize}" />
        <property name="maxIdleTime" value="${database.maxIdleTime}" />
        <property name="idleConnectionTestPeriod" value="300" />

        <property name="driverClass" value="${database.driver}" />
        <property name="jdbcUrl" value="${database.url}" />
        <property name="user" value="${database.user}" />
        <property name="password" value="${database.password}" />
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>org.uftwf.schoolvisit.model.VisitModel</value>
                <value>org.uftwf.schoolvisit.model.NameID_lookupModel</value>
                <value>org.uftwf.schoolvisit.model.School_lookupModel</value>
            </list>
        </property>

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
                <prop key="hibernate.use_sql_comments">${hibernate.use_sql_comments}</prop>
                <prop key="format_sql">${format_sql}</prop>
                <prop key="hibernate.c3p0.min_size">10</prop>
                <prop key="hibernate.c3p0.max_size">25</prop>
                <prop key="hibernate.c3p0.timeout">600</prop>
                <prop key="hibernate.c3p0.max_statements">0</prop>
                <prop key="hibernate.c3p0.idle_test_period">300</prop>
                <prop key="hibernate.c3p0.acquire_increment">5</prop>
            </props>
        </property>
    </bean>

    <bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>
</beans> 
```

这是有人对我的 XML 发表的评论，所以我想看看他在说什么：

***你应该通过使用那些hibernate来简化你自己的生活。*****属性来定义数据源，以便通过混合它们来避免维护噩梦。这将有助于避免这样的混乱。并且不要对具有数据属性的值进行硬编码。***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T01:21:26.067

应该是这样的：

src/main/resources/META-INF/persistence.xml：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.0" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
<persistence-unit name="persistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect"/>
        <!-- value="create" to build a new database on each run; value="update" to modify an existing database; value="create-drop" means the same as "create" but also drops tables when Hibernate closes; value="validate" makes no changes to the database -->
        <property name="hibernate.hbm2ddl.auto" value="update"/>
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.ImprovedNamingStrategy"/>
        <property name="hibernate.connection.charSet" value="UTF-8"/>
        <property name="show_sql" value="true"/>
        <!-- Uncomment the following two properties for JBoss only -->
        <!-- property name="hibernate.validator.apply_to_ddl" value="false" /-->
        <!-- property name="hibernate.validator.autoregister_listeners" value="false" /-->
    </properties>
</persistence-unit>
</persistence> 
```

src/main/resources/META-INF/spring/applicationContext.xml：

```
<bean class="org.springframework.orm.jpa.JpaTransactionManager" id="transactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>
<tx:annotation-driven mode="aspectj" transaction-manager="transactionManager"/>
<bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory">
    <property name="persistenceUnitName" value="persistenceUnit"/>
    <property name="dataSource" ref="dataSource"/>
</bean>

<bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" id="dataSource">
    <property name="driverClassName" value="${database.driverClassName}"/>
    <property name="url" value="${database.url}"/>
    <property name="username" value="${database.username}"/>
    <property name="password" value="${database.password}"/>
    <property name="testOnBorrow" value="true"/>
    <property name="testOnReturn" value="true"/>
    <property name="testWhileIdle" value="true"/>
    <property name="timeBetweenEvictionRunsMillis" value="1800000"/>
    <property name="numTestsPerEvictionRun" value="3"/>
    <property name="minEvictableIdleTimeMillis" value="1800000"/>
    <property name="validationQuery" value="SELECT 1"/>
    <property name="initialSize" value="1"/>
    <property name="minIdle" value="1"/>
    <property name="maxActive" value="10"/>
    <property name="poolPreparedStatements" value="true"/>
    <property name="maxOpenPreparedStatements" value="20"/>
</bean> 
```

# python - ftplib: socket.error during/after LIST // ssl._sslobj.shutdown() / 连接超时

> ID：12321915
> 
> 赞同：3
> 
> 时间：2012-09-07T16:21:16.073
> 
> 标签：python, python-2.7, ftplib

我尝试使用客户端证书连接到 FTPS 服务器。
我尝试了 2 台不同的服务器（我无法控制但应该非常相似）。

连接建立，PWD 命令成功。
在一台服务器上，LIST 命令成功，但在第二台服务器上，它会产生正确的结果（文件列表），但之后会产生错误（显然是在 SSL 关闭期间）。
在服务器端，他们告诉我：“您的 LIST 命令正确传递，但之后您在新的 SSL 重新协商期间失去了连接。”
知道为什么吗？

提前致谢。

.

建立连接的常用命令：

```
# Python 2.7.3rc2 (default, Apr 22 2012, 22:30:17)

>>> import ssl
>>> from ftplib import FTP_TLS

>>> ftps = FTP_TLS(keyfile="/path/to/***.key", certfile="/path/to/***.crt")
>>> ftps.set_debuglevel(2)
>>> ftps.ssl_version = ssl.PROTOCOL_TLSv1
>>> ftps.connect("***", 7806)
*get* '220 Welcome to Synchrony Gateway FTP server\r\n'
*resp* '220 Welcome to Synchrony Gateway FTP server'
'220 Welcome to Synchrony Gateway FTP server'

>>> ftps.auth()
*cmd* 'AUTH TLS'
*put* 'AUTH TLS\r\n'
*get* '234 AUTH command OK, waiting handshake\r\n'
*resp* '234 AUTH command OK, waiting handshake'
'234 AUTH command OK, waiting handshake'

>>> ftps.login("***", "***")
*cmd* 'USER ***'
*put* 'USER ***\r\n'
*get* '331 Send password please\r\n'
*resp* '331 Send password please'
*cmd* 'PASS ************'
*put* 'PASS ************\r\n'
*get* '230 User logged in, proceed\r\n'
*resp* '230 User logged in, proceed'
'230 User logged in, proceed'

>>> ftps.prot_p()
*cmd* 'PBSZ 0'
*put* 'PBSZ 0\r\n'
*get* '200 Command okay\r\n'
*resp* '200 Command okay'
*cmd* 'PROT P'
*put* 'PROT P\r\n'
*get* '200 Command okay\r\n'
*resp* '200 Command okay'
'200 Command okay'

>>> ftps.set_pasv(True)
>>> ftps.pwd()
*cmd* 'PWD'
*put* 'PWD\r\n'
*get* '257 "/" is current directory.\r\n'
*resp* '257 "/" is current directory.'
'/' 
```

.

失败的 LIST 命令：

```
>>> ftps.retrlines("LIST")
*cmd* 'TYPE A'
*put* 'TYPE A\r\n'
*get* '200 Command okay\r\n'
*resp* '200 Command okay'
*cmd* 'PASV'
*put* 'PASV\r\n'
*get* '227 Entering passive mode (212,63,***,**,30,131).\r\n'
*resp* '227 Entering passive mode (212,63,***,**,30,131).'
*cmd* 'LIST'
*put* 'LIST\r\n'
*get* '125 List started\r\n'
*resp* '125 List started'
total 3
dr-xr-xr-x   0 --NA--   --NA--            0 Apr 23 16:46 .
d---------   0 --NA--   --NA--            0 Jun  4 15:02 ..
dr-xr-xr-x   0 --NA--   --NA--            0 Apr 23 16:46 **
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/ftplib.py", line 721, in retrlines
    conn.unwrap()
  File "/usr/lib/python2.7/ssl.py", line 284, in unwrap
    s = self._sslobj.shutdown()
socket.error: [Errno 0] Error

>>> ftps.pwd()
*cmd* 'PWD'
*put* 'PWD\r\n'
*get* '226 List completed\r\n'
*resp* '226 List completed'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/ftplib.py", line 575, in pwd
    return parse257(resp)
  File "/usr/lib/python2.7/ftplib.py", line 839, in parse257
    raise error_reply, resp
ftplib.error_reply: 226 List completed

>>> ftps.quit()
*cmd* 'QUIT'
*put* 'QUIT\r\n'
*get* '257 "/" is current directory.\r\n'
*resp* '257 "/" is current directory.'
'257 "/" is current directory.' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T12:37:45.180

我们也面临同样的问题。在 SSL.PY 我们得到错误 0 异常

```
def unwrap(self):
    if self._sslobj:
        print "SSL Object Present"
        s = self._sslobj.shutdown()
        print "SSL Object Shoutdown"
        print "print s"
        print s
        self._sslobj = None
        return s
    else:
        raise ValueError("No SSL wrapper around " + str(self)) 
```

s = self._sslobj.shutdown() 在这行它抛出异常。你有这方面的最新消息吗？

我用下面的代码修改了 ftplib.py retrline 方法

```
 if isinstance(conn, ssl.SSLSocket):
     conn.close() 
```

它的工作没有任何错误。我不知道此更改对其他功能的影响

# stored-procedures - 从 COGNOS 调用 oracle 存储过程

> ID：12321918
> 
> 赞同：0
> 
> 时间：2012-09-07T16:21:26.207
> 
> 标签：stored-procedures, oracle11g, cognos-8

在[此链接](https://www-304.ibm.com/support/docview.wss?uid=swg21445524)中，IBM 他们解释了如何将 Oracle 存储过程与 COGNOS 一起使用。

他们在 ：

```
create or replace package body project_pk as
procedure project_sp (tproj IN numeric, result1 in out project_type1) is

begin
open result1 for
select projects.projectid, projects.projecttype
from projects
where projects.projecttype=tproj;
end;
end;
/ 
```

随着`open result1 for`他们明确地打开游标。但是，他们似乎没有关闭它。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T19:39:17.463

您必须将设置返回到 Cognos。如果你关闭光标，那么也没有结果，对吧？
Cognos 负责在完成从 SP 中提取数据后关闭游标。
为了让您 100% 确定是这种情况，请查看此链接（与 Cognos 完全无关）：
[Returning result Sets from SQL Server and Oracle](http://www.akadia.com/services/ora_return_result_set.html)

但是，您在链接中提供的示例看起来很复杂。这是我正在使用的：

```
CREATE OR REPLACE PROCEDURE "COGNOS_SP" (
case_id        in numeric,
po_refcur      out sys_refcursor) is
BEGIN
   open po_refcur for 
   select * FROM CASES WHERE CASE_ID = case_id;
END COGNOS_SP; 
```

# ruby-on-rails - Capybara::ElementNotFound：在没有 webrat 的情况下无法找到 xpath“/html”

> ID：12321921
> 
> 赞同：4
> 
> 时间：2012-09-07T16:21:46.917
> 
> 标签：ruby-on-rails, ruby-on-rails-3, capybara

我无法让 Capybara 在我的许多集成测试中工作。

当我访问某些页面时，我得到以下 html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> 
```

因此，当我尝试使用`have_content()`选择器时，会引发以下错误：

```
 Failure/Error: page.should have_content("HELLO")
 Capybara::ElementNotFound:
   Unable to find xpath "/html" 
```

我的应用程序的某些页面我可以正常访问，但其他一些我不能。甚至有些页面在某些地方有效，而在其他地方无效：

```
require 'spec_helper'

describe HomeController do

  it "shows the website description" do
    visit root_path
    puts page.html.length # ==> 108 (no html)
    ...
  end
end

require 'spec_helper'

describe FlowsController do

  it "should do stuff" do
    visit root_path
    puts page.html.length # ==> 4459, works even if the exact same one didn't work in home_controller_spec! 
    visit flows_path
    puts page.html.length # ==> 3402, works
    visit new_user_session_path
    puts page.html.length # ==> 3330, works
    within("form#new_user") do
      fill_in 'Email', :with => 'email@example.com'
      fill_in 'Password', :with => 'password'
      click_on 'Sign in'
    end
    puts page.html.length # ==> 108, No html
  end
end 
```

我在[这篇文章](https://stackoverflow.com/questions/10606150/capybaraelementnotfound-unable-to-find-xpath-html)中读到，这是同时使用 Capybara 和 webrat 时可能出现的错误。但我根本没有使用 webrat，我仍然得到错误......

这是我的 Gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'

gem 'pg'
gem 'thin'
gem 'devise'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  gem 'uglifier', '>= 1.0.3'
end

# Add rspec for testing
group :test, :development do
  gem "rspec-rails", "~> 2.0"
  gem "capybara"
  gem "factory_girl_rails"
end

gem 'jquery-rails' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T11:58:31.297

尝试传递一个字符串来描述，而不是控制器类

```
describe "whatever" do
  ...
end 
```

# javascript - AJAX HTTP 基本身份验证解决方法

> ID：12321923
> 
> 赞同：0
> 
> 时间：2012-09-07T16:22:09.903
> 
> 标签：javascript, ajax, rest, authentication

我正在开发一个用于 JavaScript 客户端的 RESTful API。所有 API 调用都经过身份验证。不幸的是，如果提供的凭据不正确，则会弹出可怕的浏览器提示。

现在，我知道没有办法在客户端抑制这种情况。幸运的是，我同时控制了客户端和 API。

我想尽可能地保持 API 的规范。所以我宁愿不将响应代码更改为 403。作为替代方案，我正在考虑允许客户端抑制 WWW-Authenticate 标头（通过请求中的自定义标头）。至少在最新版本的 Chrome 中，它似乎触发了提示，而不一定是 401 代码本身。

有人对此有任何见解吗？在其他浏览器中可靠吗？为什么我不应该走这条路？

谢谢，

肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:14:15.753

弹出窗口是一个`401 Unauthorized`答案，如果您使用的是 jQuery，您可以在`error()`回调中或在`statusCode`ajax 调用的属性中捕获它：

```
$.ajax({
    url : url,
    type : 'GET/POST/PUT/DELETE',
    data : { your data here },
    dataType : 'json/xml/html',
    statusCode : {

        200 : function(data, textStatus, jqXHR){

            // your logic here

        },                                  

        401 : function(jqXHR, textStatus, errorThrown){

            // your logic here

        }

    }

}); 
```

如果您需要对请求标头执行任何编辑，请`beforeSend()`在调用中使用回调，以便您可以在执行之前注入/删除内容。

# java - Java对bean集合进行排序的有效方法

> ID：12321924
> 
> 赞同：1
> 
> 时间：2012-09-07T16:22:11.443
> 
> 标签：java, sorting, collections

作为查询的结果，我有一个来自数据库的 bean 列表。

豆子如下：

```
 public class Employee implements Comparator<Employee> {

    protected String empId; //alphanumeric e.g.abc123
    protected String empFullName;   
    protected String empAddress;
    protected String dept;
    protected String project;

    public String getEmpId() {
        return empId;
    }
    public void setEmpId(String empId) {
        this.empId = empId;
    }
    public String getEmpFullName() {
        return empFullName;
    }
    public void setEmpFullName(String empFullName) {
        this.empFullName = empFullName;
    }
    public String getEmpAddress() {
        return empAddress;
    }
    public void setEmpAddress(String empAddress) {
        this.empAddress = empAddress;
    }
    public String getDept() {
        return dept;
    }
    public void setDept(String dept) {
        this.dept = dept;
    }
    public String getProject() {
        return project;
    }
    public void setProject(String project) {
        this.project = project;
    }

    @Override
    public int compare(Employee e1, Employee e2) {
        if (e1 == null && e2 == null) return 0; 

        if (e1 != null && e2 == null) return -1;
        if (e1 == null && e2 != null) return 1;

        return e1.empId.compareTo (e2.empId); 
    }

} 
```

我有比较器，它按字母数字的 empId 排序。

我想知道按 empId、dept、project 排序的最佳方法是什么。

在代码中，如果我执行以下操作，它会按 empId 排序。

```
 List<Employee> empList = someDao.getEmpList();
    Collections.sort(empList, new Employee()); 
```

有什么建议么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T16:25:22.640

这本身就是一个奇怪的声明：

```
public class Employee implements Comparator<Employee> 
```

更常见的是：

```
public class Employee implements Comparable<Employee> 
```

然后也许：

```
public class EmployeeByIdComparator implements Comparator<Employee> 
```

和

```
public class EmployeeByNameComparator implements Comparator<Employee> 
```

等等

实现类的实例`Comparable`知道如何将*自己*与另一个实例进行比较；通常这是为“自然”排序保留的。将其与 的实例进行比较`Comparator`，后者知道如何比较通常具有*不同类型的**两个实例*（指定为 的类型参数的实例）。*`Comparator`*

 *因此，如果您想要多种类型的比较，请创建多个比较器。然后您可能希望将它们链接在一起 - [Guava](http://guava-libraries.googlecode.com)提供了一种简单的方法来执行此操作。（请参阅[`ComparisonChain`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/ComparisonChain.html)。）为方便起见，您可能希望将比较器实现为内部的私有静态类`Employee`，然后通过公共静态最终字段公开它们的单个实例：

```
public class Employee
{
    public static final Comparator<Employee> BY_ID_COMPARATOR
        = new ByIdComparator();

    private static final class ByIdComparator : Comparator<Employee>
    {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:27:06.833

`public class Employee implements Comparator<Employee>`

这是对`Comparator`界面的错误（可能不是有意的）使用。我想你想要`Comparable`这里。

对于按 empId 排序，dept 和 project 创建一个自定义比较器来执行此操作并将其传递给`sort()`方法。然后，此比较器将按您需要的顺序检查您要比较的属性，并在第一次不为 0 时返回结果 - 或者如果所有属性都相等，则在最后返回结果。

例子：

```
new Comparator<Employee>() {
  public int compare(Employee e1, Employee e2) {
    //check if both are not null

    int result = e1.empId.compareTo( e2.empId );

    if( result == 0) {
      result = e1.dept .compareTo( e2.dept );
    }

    ...

    return result;
  }
} 
```*

# webserver - 网络服务器中别名的 URL 重写

> ID：12321926
> 
> 赞同：1
> 
> 时间：2012-09-07T16:22:17.017
> 
> 标签：webserver, websphere, url-rewrite-module, tuckey-urlrewrite-filter

我有两份我们的 XYZ 应用程序（测试、培训）。它们是 websphere 中的两个不同应用程序，具有两个不同的数据库。我们通常倾向于每个 websphere 应用程序有一个 webserver。虽然我知道我们可以有多个网络服务器。在我的网络服务器中，我们创建了一个名为 LoginExternal 的变量，如下所示，它指向应用程序服务器中同名的物理文件夹。别名/ **LoginExternal** //winxen90/LoginExternal$

我们通过我们的 HTML 引用 LoginExternal 变量，如下所示。

```
 <script type="text/javascript" language="JavaScript" src="/**LoginExternal**/Data/LoginAnnouncements.js"></script>
  <script type="text/javascript" language="JavaScript" src="/**LoginExternal**/Data/LoginForms.js"></script> 
```

href="JavaScript:LGNEXTUTILS_OpendExternalPage('/ **LoginExternal** /Pages/LoginAnnouncements.html');">

我们面临的问题是，通过这种设置，两个应用程序被迫使用来自一个名为 LoginExternal 的物理文件夹中的数据，因为网络服务器别名。我正在寻找一种解决方案，即使我们有两个物理文件夹 LoginExternal1 ， LoginExternal2 每个应用程序都有一个 每个应用程序的 HTML 文件应该引用正确的 LoginExternal 文件夹。我希望我们可以通过某种形式的 URL 重写来实现这一点。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:58:13.920

我要说的是，如果不使用单独的虚拟主机，这可能是不可能的，但是......

我认为您的 Rewrite 条件可以将 Referrer 标头与您的两个 Web 应用程序的上下文根进行比较。

# svn - Collabnet Subversion Edge Stack 软件更新的电子邮件通知

> ID：12321927
> 
> 赞同：0
> 
> 时间：2012-09-07T16:22:20.223
> 
> 标签：svn, stack, auto-update, subversion-edge

我正在寻找一种在 Collabnet Subversion Edge 堆栈有可用更新时接收电子邮件通知的方法。我刚刚登录 Edge 的 Web 界面，发现 8 月 29 日发布了更新。

我最初认为更新是“自动”的，因为 Chrome 有自动更新，但似乎[仍然需要用户干预。](http://subversion.open.collab.net/ds/viewMessage.do?dsForumId=3&dsMessageId=412766 "仍然需要用户干预。") 这很好，但我登录 Web 界面的频率不够高，无法及时收到更新通知。

在 Subversion Edge 中似乎会有一个邮件列表或一个选项，但我都没有找到。谁能指出我正确的方向？

我目前在 Windows Server 2008 r2 上运行版本 3.1.0-3220.94 的堆栈。

这是我关于stackoverflow的第一个问题，所以如果我做错了什么，请给我残酷的反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:38:35.467

这里有一个发布公告邮件列表：

[https://ctf.open.collab.net/sf/discussion/do/listForums/projects.svnedge/discussion](https://ctf.open.collab.net/sf/discussion/do/listForums/projects.svnedge/discussion)

您需要使用您创建的帐户登录才能下载 Subversion Edge。但是您应该能够“监控”发布公告列表，并且在发布发布时您会收到电子邮件。

电子邮件将发送到与您的帐户关联的电子邮件地址。

# exception-handling - 无法在 biztalk 编排中捕获 wcf 服务异常

> ID：12321930
> 
> 赞同：1
> 
> 时间：2012-09-07T16:22:30.230
> 
> 标签：exception-handling, biztalk

我正在尝试将异常处理放入我的工作编排中，并且无法捕获异常。它一直挂起消息而不是执行我的异常块来更优雅地处理它。

有什么建议么？

以下是我收到的事件日志消息：

```
A message sent to adapter "WCF-Custom" on send port "InsertOracleMasterPort" with URI "oracledb://svd0odbd01:1529/ebsdev/Dedicated" is suspended. 
 Error details: Microsoft.ServiceModel.Channels.Common.ConnectionException: ORA-1017: invalid username/password; logon denied ---> Oracle.DataAccess.Client.OracleException: ORA-1017: invalid username/password; logon denied
   at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure, Boolean bCheck)
   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)
   at Oracle.DataAccess.Client.OracleConnection.Open()
   at Microsoft.Adapters.OracleCommon.OracleCommonConnectionWrapper..ctor(String connectionString, OracleCommonExecutionHelper executionHelper)
   at Microsoft.Adapters.OracleDB.OracleDBConnection.Microsoft.ServiceModel.Channels.Common.IConnection.Open(TimeSpan timeout)
   --- End of inner exception stack trace ---

Server stack trace: 
   at Microsoft.Adapters.OracleDB.OracleDBConnection.Microsoft.ServiceModel.Channels.Common.IConnection.Open(TimeSpan timeout)
   at Microsoft.ServiceModel.Channels.Common.Design.ConnectionPool.GetConnection(Guid clientId, TimeSpan timeout)
   at Microsoft.ServiceModel.Channels.Common.Design.ConnectionPool.GetConnectionHandler[TConnectionHandler](Guid clientId, TimeSpan timeout, MetadataLookup metadataLookup, String& connectionId)
   at Microsoft.ServiceModel.Channels.Common.Channels.AdapterRequestChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open()

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at System.ServiceModel.ICommunicationObject.Open()
   at Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfClient`2.GetChannel[TChannel](IBaseMessage bizTalkMessage, ChannelFactory`1& cachedFactory)
   at Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfClient`2.SendMessage(IBaseMessage bizTalkMessage) 
 MessageId:  {1CC95FB3-E543-4011-9BDD-EABB50B75BC2}
 InstanceID: {EF352982-D16C-421E-806C-58E432049951} 
```

第二条消息：

```
xlang/s engine event log entry: Uncaught exception (see the 'inner exception' below) has suspended an instance of service 'Orchestrations.OracleInvoice(868ee765-7874-ec30-0cc7-f81ae5ebfb2b)'.
The service instance will remain suspended until administratively resumed or terminated. 
If resumed the instance will continue from its last persisted state and may re-throw the same unexpected exception.
InstanceId: 7eefaf7e-0e9c-4ee6-be6e-7030ece2058b
Shape name: 
ShapeId: 
Exception thrown from: segment -1, progress -1
Inner exception: An error occurred while processing the message, refer to the details section for more information 
Message ID: {1CC95FB3-E543-4011-9BDD-EABB50B75BC2}
Instance ID: {EF352982-D16C-421E-806C-58E432049951}
Error Description: Microsoft.ServiceModel.Channels.Common.ConnectionException: ORA-1017: invalid username/password; logon denied ---> Oracle.DataAccess.Client.OracleException: ORA-1017: invalid username/password; logon denied
   at Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure, Boolean bCheck)
   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)
   at Oracle.DataAccess.Client.OracleConnection.Open()
   at Microsoft.Adapters.OracleCommon.OracleCommonConnectionWrapper..ctor(String connectionString, OracleCommonExecutionHelper executionHelper)
   at Microsoft.Adapters.OracleDB.OracleDBConnection.Microsoft.ServiceModel.Channels.Common.IConnection.Open(TimeSpan timeout)
   --- End of inner exception stack trace ---

Server stack trace: 
   at Microsoft.Adapters.OracleDB.OracleDBConnection.Microsoft.ServiceModel.Channels.Common.IConnection.Open(TimeSpan timeout)
   at Microsoft.ServiceModel.Channels.Common.Design.ConnectionPool.GetConnection(Guid clientId, TimeSpan timeout)
   at Microsoft.ServiceModel.Channels.Common.Design.ConnectionPool.GetConnectionHandler[TConnectionHandler](Guid clientId, TimeSpan timeout, MetadataLookup metadataLookup, String& connectionId)
   at Microsoft.ServiceModel.Channels.Common.Channels.AdapterRequestChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open()

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at System.ServiceModel.ICommunicationObject.Open()
   at Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfClient`2.GetChannel[TChannel](IBaseMessage bizTalkMessage, ChannelFactory`1& cachedFactory)
   at Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfClient`2.SendMessage(IBaseMessage bizTalkMessage)

Exception type: XlangSoapException
Source: Microsoft.XLANGs.BizTalk.Engine
Target Site: Void VerifyTransport(Microsoft.XLANGs.Core.Envelope, Int32, Microsoft.XLANGs.Core.Context)
The following is a stack trace that identifies the location where the exception occured

   at Microsoft.BizTalk.XLANGs.BTXEngine.BTXPortBase.VerifyTransport(Envelope env, Int32 operationId, Context ctx)
   at Microsoft.XLANGs.Core.Subscription.Receive(Segment s, Context ctx, Envelope& env, Boolean topOnly)
   at Microsoft.XLANGs.Core.PortBase.GetMessageId(Subscription subscription, Segment currentSegment, Context cxt, Envelope& env, CachedObject location)
   at Orchestrations.OracleInvoice.segment2(StopConditions stopOn)
   at Microsoft.XLANGs.Core.SegmentScheduler.RunASegment(Segment s, StopConditions stopCond, Exception& exp) 
```

这是编排：

![编排错误处理块](../Images/9406ef5c686811701c2e5e2687a0140f.png)

catch 块使用这些类型的错误对象：

*   System.Web.Services.Protocols.SoapException
*   Microsoft.XLANGs.Core.XlangSoapException
*   Microsoft.XLANGs.BaseTypes.XLANGsException
*   一般例外
*   系统异常

我认为异常处理会冒​​泡并被 system.exception 或一般处理程序捕获，但这并没有发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T08:57:26.890

根据这些帖子，您似乎需要创建和捕获 **wcf 故障排除**

[示例 1](http://connectedpawns.wordpress.com/2009/09/17/catching-a-wcf-fault-in-a-biztalk-orchestration/)

[示例 2](http://shankarsbiztalk.wordpress.com/2011/09/16/consuming-wcf-services-in-biztalk-2010/)

# jquery - jQuery在ajax调用完成之前向元素添加CSS？

> ID：12321934
> 
> 赞同：3
> 
> 时间：2012-09-07T16:22:40.233
> 
> 标签：jquery, css

我正在使用 jquery 将由 javascript 打印的购物车发送到将创建 PDF 的 PHP 脚本。

我的问题是购物车没有附加任何样式，所以它看起来像这样：[http ://u31830.shellit.eu/kauppa/kuitit/kuitti63.pdf](http://u31830.shellit.eu/kauppa/kuitit/kuitti63.pdf)

我想简单地做一个 display:none 在一些元素上并在左边浮动一些元素，这样它看起来会很好。我知道这可以用 Attr() 来完成，但我不知道如何使用它。

这是我的ajax调用：

```
$(document).ready(function() {
$(function() {
    $(".submit").click(function() {
      var data = $('#yhteystiedot').serializeArray();
      //styling here?
      data.push( { name: 'cartContent', value: $('#emailedcart').html()}); // Read the cart, and send it to script
      //alert (data);return false;
     $.ajax({
    type: "POST",
    data: data,
    url: "order.php",
    dataType: "html",
    error: function(){ alert("Jotakin meni pahasti pieleen! Yritä uudelleen?");
 },
    success: function() {
 alert("Onnistui");
        }

  });
  return false;

    });
  });        
}); 
```

购物车在浏览器控制台上将如下所示：

```
<div class="simpleCart_items" id="emailedcart">
    <div>
        <div class="headerRow">
            <div class="item-name">Tuote</div>
            <div class="item-quantity">Määrä</div>
            <div class="item-price">Hinta</div>
            <div class="item-total">Yhteensä</div>
            <div class="item-remove"></div>
        </div>
        <div class="itemRow row-0 odd" id="cartItem_SCI-1">
            <div class="item-name">Teipit (Valkoinen hiilikuitu)</div>
            <div class="item-quantity">
                <input type="text" value="1" class="simpleCart_input">
            </div>
            <div class="item-price">48.00€&lt;/div>
            <div class="item-total">48.00€&lt;/div>
            <div class="item-remove"><a href="javascript:;" class="simpleCart_remove">Remove</a>
            </div>
        </div>
    </div>
</div> 
```

**我想在元素发送到 PHP 脚本之前将以下 css 添加到元素中**

```
.item-remove{display:none;}
.headerRow div{float:left;}
.itemRow div{float:left;} 
```

但是怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:25:08.293

```
$(document).ready(function() {
  $(function() {
    $(".submit").click(function() {

      //do the CSS here.
      $('.item-remove').css({'display':'none'});
      $('.headerRow div').css({'float':'left'});
      $('.itemRow div').css({'float':'left'});

      var data = $('#yhteystiedot').serializeArray();
      //styling here?
      data.push( { name: 'cartContent', value: $('#emailedcart').html()}); // Read the cart, and send it to script
      //alert (data);return false;
     $.ajax({
    type: "POST",
    data: data,
    url: "order.php",
    dataType: "html",
    error: function(){ alert("Jotakin meni pahasti pieleen! Yritä uudelleen?");
 },
    success: function() {
 alert("Onnistui");
        }

  });
  return false;

    });
  });        
}); 
```

我假设您想在单击之后但在 AJAX 之前更新这些 CSS 样式。正确的？否则，只需将那些 CSS jquery 行扔到上面`$(".submit").click(function() {`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:26:59.893

您可以使用 ajax 的 beforeSend 来做到这一点：这就是我的做法

```
 $.ajax({
            type: '...',
            url: '...',
            data: {
                ...
            },
            dataType: '...',
            beforeSend: function() {
                $('.item-remove').css('display','none');
                $('.headerRow div').css('float','left');
                $('.itemRow div').css('float','left');
            },
            success: function(result) {
                             .... 
```

# asp.net - aspnet webapi 将查询字符串绑定到对象

> ID：12321939
> 
> 赞同：0
> 
> 时间：2012-09-07T16:22:58.320
> 
> 标签：asp.net, asp.net-web-api, model-binding

```
<HttpGet()>
Public Function Search(<FromUri()> ByVal name As Name) As HttpResponseMessage
  // get params from complex type
  // or check for model validation
  name.firstName;
  name.lastName;
End Function

Public Class Name
 <Required()>
 Public firstName As String
 <Required()>
 Public lastName As String
End Class 
```

> /api/abc/search?firstName=jack&lastName=daniels

我正在尝试将复杂类型作为查询参数发送，但即使我使用 fromUri 属性，名称也始终为空。我错过了什么？

**编辑：**我也使用 System.ComponentModel.DataAnnotations 的 Required() 属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T22:51:18.007

我发现了问题。我的字段中缺少属性关键字。

```
Public Class Name
 <Required()>
 Public firstName As String
 <Required()>
 Public lastName As String
End Class 
```

因此，它适用于以下更改。

```
Public Class Name
 <Required()>
 Public Property firstName As String
 <Required()>
 Public Property lastName As String
End Class 
```

*问题解决了。我认为，没有属性，该类不会公开其字段，因此我无法从 uri 中读取它们。*

# android - ICS 上的 mkv 视频抖动

> ID：12321941
> 
> 赞同：1
> 
> 时间：2012-09-07T16:23:05.033
> 
> 标签：android, android-4.0-ice-cream-sandwich, android-videoview

我尝试使用该课程`Videoview`在我的 Archos 平板电脑上播放 MKV 文件。布局是：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
      xmlns:tools="http://schemas.android.com/tools"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" >
<VideoView
    android:id="@+id/intro_surface"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
     />  
</RelativeLayout> 
```

代码是：

```
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_splash_screen);
    VideoView l_tv = (VideoView) findViewById(R.id.intro_surface);
    Uri l_uri = Uri.parse("android.resource://"+ getPackageName() +"/" + R.raw.intro_mkv);
    l_tv.setVideoURI(p_uri) ;
    l_tv.start();
} 
```

视频播放但抖动，而当我使用外部视频播放器时它可以正常播放。我在清单中激活了硬件加速。我看到了一些相关的日志，`AwesomePlayer`但我在平板电脑上找不到这个播放器。

`Seek tolerance hit mTimeSourceDeltaUs=-593897 seek_tolerance=520500`.

我找到了关于 awesomeplayer 的这个[帖子](https://stackoverflow.com/questions/9230864/what-is-awesomeplayer-in-android)，但它没有帮助。

有解决这个问题的方法吗？

# java - “log4j:configuration”必须匹配“(renderer....loggerFactory)?)”

> ID：12321943
> 
> 赞同：33
> 
> 时间：2012-09-07T16:23:19.213
> 
> 标签：java, tomcat, maven, log4j

将我的war文件部署到tomcat时出现错误：

```
log4j:WARN The content of element type "log4j:configuration" must match "(renderer*,throwableRenderer?,appender*,plugin*,(category|logger)*,root?,(categoryFactory|loggerFactory)?)" 
```

我四处搜索，发现我的 log4j.xml 的排序可能是错误的，但它应该是正确的。

```
<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">  

  <appender name="console" class="org.apache.log4j.ConsoleAppender">  
    <param name="Target" value="System.out"/>  
    <layout class="org.apache.log4j.PatternLayout">  
      <param name="ConversionPattern" value="%-5p %d %c %x - %m%n"/>  
    </layout>  
  </appender>  

  <root>  
    <priority value ="error" />  
    <appender-ref ref="console" />  
  </root>  

  <category name="org.springframework" additivity="false">  
    <priority value="info" />  
    <appender-ref ref="console" />  
  </category>  

</log4j:configuration> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-09-07T16:27:42.490

根据错误消息，DTD 期望所有`category`元素都在`root`元素之前。你把它们弄错了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-07-04T23:22:12.643

按照这个顺序：

```
<renderer></renderer>

<appender></appender>

<plugin></plugin>

<logger></logger>

<category></category>

<root></root>

<loggerfactory></loggerfactory>

<categoryfactory></categoryfactory> 
```

# jquery - jQuery Mobile + phonegap：滚动方向突然改变导致滚动停止

> ID：12321944
> 
> 赞同：1
> 
> 时间：2012-09-07T16:23:29.950
> 
> 标签：jquery, ios, cordova, jquery-mobile

在 iOS 上，我有两个页面。两者都是带有图像和链接的大型列表。

在一个页面上，如果我快速向一个方向滚动，然后突然切换到另一个方向，滚动就会停止。我必须再次开始滚动才能继续。

在另一个页面上，具有相似的内容和几乎相同的 CSS，滚动工作就像在任何本机 iOS 应用程序上一样，没有任何问题。

我不确定要提供什么来帮助诊断。是否有为某种敏感性配置的变量？这是一个错误吗？

# c++ - 显式删除 shared_ptr

> ID：12321949
> 
> 赞同：31
> 
> 时间：2012-09-07T16:23:41.027
> 
> 标签：c++, boost, shared-ptr, boost-smart-ptr

这里有一个简单的问题：您是否允许自己显式删除 a `boost::shared_ptr`？你应该吗？

澄清一下，我并不是说删除`shared_ptr`. 我的意思是实际`shared_ptr`本身。我知道大多数人建议不要这样做，所以我只是想知道是否可以明确地这样做。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-07T16:33:42.197

你的问题不清楚。如果您已经`shared_ptr`动态分配了 a ，那么您当然可以随时使用`delete`它。

但是，如果您询问是否允许删除 由 管理的任何对象`shared_ptr`，那么答案是……这取决于。如果`shared_ptr::unique`返回 true，则调用`shared_ptr::reset`将删除托管对象。但是，如果`shared_ptr::unique`返回 false，则表示该对象有多个`shared_ptr`共享所有权。在这种情况下，调用`reset`只会导致引用计数减 1，当最后一个`shared_ptr`管理该对象超出范围或者是它本身时，将发生对象的实际删除`reset`。

编辑：
编辑后，您似乎在询问是否要删除动态分配的`shared_ptr`. 像这样的东西：

```
auto sp = new boost::shared_ptr<int>( new int(42) );

// do something with sp

delete sp; 
```

这是允许的，并且会按预期工作，尽管这将是一个不寻常的用例。唯一需要注意的是，如果在分配和删除之间`sp`创建另一个`shared_ptr`共享对象所有权的对象，则删除`sp`不会导致对象被删除，这只会在对象的引用计数变为 0 时发生。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-07T16:34:43.917

[编辑：`delete`当`shared_ptr`且仅当它是用`new`, 与任何其他类型一样创建时，您可以。我想不出你为什么要创建一个`shared_ptr`with `new`，但没有什么能阻止你。]

嗯，你*可以*写`delete ptr.get();`。

这样做几乎不可避免地会导致未定义的行为，或者当*其他*共享所有者使用他们`shared_ptr`访问现在已删除的对象时，或者该`shared_ptr`对象的最后一个被销毁，并且该对象再次被删除。

所以不，你不应该。

的目的`shared_ptr`是管理一个没有任何“人”有权或有责任删除的对象，因为可能有其他人共享所有权。所以你也不应该想要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T16:31:54.650

您不能将其引用计数强制为零，不。

想想它需要什么才能起作用。您需要去每个使用 shared_ptr 的地方并清除它。

如果您确实强制删除共享指针并将其设置为 NULL，那么它就像一个weak_ptr。但是，代码中使用 shared_ptr 的所有这些地方都没有为此做好准备，并且期望持有一个有效的指针。他们没有理由检查 NULL，因此这些代码会崩溃。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-22T06:20:14.763

如果要模拟计数递减，可以在堆上手动执行，如下所示：

```
int main(void) {
    std::shared_ptr<std::string>* sp = new std::shared_ptr<std::string>(std::make_shared<std::string>(std::string("test")));
    std::shared_ptr<std::string>* sp2 = new std::shared_ptr<std::string>(*sp);
    delete sp;

    std::cout << *(*sp2) << std::endl;    // test
    return 0;
} 
```

或者在堆栈上使用`std::shared_ptr::reset()`如下：

```
int main(void) {
    std::shared_ptr<std::string> p = std::make_shared<std::string>(std::string("test"));
    std::shared_ptr<std::string> p2 = p;
    p.reset();

    std::cout << *p2 << std::endl;    // test
    return 0;
} 
```

但它不是那么有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-24T00:53:19.643

Expliticly deleting comes in handy in some (very?) rare cases.

In addition to explicitly deleting, sometimes you HAVE to explicitly destruct a shared pointer when you are 'deleting' it!

Things can get weird when interfacing with C code, passing a shared_ptr as an opaque value.

For example I have the following for passing objects to and from the Lua scripting language which is written in C. (www.lua.org)

```
static void push( lua_State *L, std::shared_ptr<T> sp )
{
    if( sp == nullptr ) {
        lua_pushnil( L );
        return;
    }

    // This is basically malloc from C++ point of view.
    void *ud = lua_newuserdata( L, sizeof(std::shared_ptr<T>));

    // Copy constructor, bumps ref count.
    new(ud) std::shared_ptr<T>( sp );

    luaL_setmetatable( L, B::class_name );
} 
```

So thats a shared_ptr in some malloc'd memory. The reverse is this... (setup to be called just before Lua garbage collects an object and 'free's it).

```
static int destroy( lua_State *L )
{
    // Grab opaque pointer
    void* ud = luaL_checkudata( L, 1, B::class_name );

    std::shared_ptr<T> *sp = static_cast<std::shared_ptr<T>*>(ud);

    // Explicitly called, as this was 'placement new'd
    // Decrements the ref count
    sp->~shared_ptr();

    return 0;
} 
```

# asp.net-mvc - 如何处理用于输入/显示大数的逗号？

> ID：12321950
> 
> 赞同：1
> 
> 时间：2012-09-07T16:23:42.453
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery-ui

我记得几年前不得不处理这种情况，从我在网上的情况来看，它真的没有变得更容易。

我有两种可能的情况。一，是用户在退出输入框后希望看到刚刚输入的数字用逗号格式化的地方。另一个是用户想要实际输入逗号的地方。

这两种情况都使验证和处理将数据作为十进制传递到后端更有趣。我意识到这可以通过各种可能性来完成，例如 keyup/keydown/blur/focus 事件；使用自定义验证等修改 jQuery 验证器。但这似乎暗示了一堆潜在的新功能和新的地方，以便在不同的浏览器上出错。我们在处理这些事件的过程中获得了很多乐趣，比如模糊/keyup 在不同浏览器中的反应，这可能有点像噩梦一样。

我们当前的视图使用 HTML 5 。这有助于验证和输入，而无需大量编码。如果可能，我们希望继续使用这种类型的输入。

用户可能还希望不允许输入小数（对于某些类型的数量输入）。

此外，该解决方案需要同时适用于 IE8 和 Safari（适用于 iPad）。目前，我们对恰好适合 iPad 足迹的所有页面都有一个单一的视图。

是否有任何优雅而简单的解决方案来处理此类请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:10:47.990

Asp.Net MVC 允许您使用 jQuery 不显眼的验证，这将为您处理繁重的跨浏览器支持。

您可以使用 Remote 属性装饰您的视图模型属性，然后它会告诉浏览器验证脚本（同样，无需您编写代码）调用该字段的控制器/操作。然后，您创建该控制器/操作并在那里进行验证（您可以简单地尝试解析数字）并在失败时发回一条消息。

我建议这样做的原因仅仅是因为远程验证已经是一个已知的、可以工作的东西，而且你在服务器上写的任何东西都不会影响任何客户端。您可以在验证中随心所欲，而无需测试 JavaScript。

这是[远程验证的介绍](http://msdn.microsoft.com/en-us/library/gg508808%28v=vs.98%29.aspx)- 不要惊慌，有很多文本，代码的编写方式使它看起来比实际更复杂。

启动一个新项目，你应该在 15 分钟内完成它。

最好的祝福。

**编辑** 如果您*确实*想使用客户端解决方案，请尝试一些预先构建和社区支持的东西，例如[autoNumeric](http://decorplanit.com/plugin/)。

# php - 图像和基于浏览器的图表的图表框架

> ID：12321952
> 
> 赞同：2
> 
> 时间：2012-09-07T16:23:50.770
> 
> 标签：php, javascript, image, browser, charts

我非常了解大量图表渲染框架，一些 Javascript（如 Google Chart、ThreeD、HighCharts）、基于 PHP 的 jpGraph 和 pChart 以及在线 REST API，如 Google 的旧图表工具（将在 2015 年消失）。

他们似乎都专注于图形的一种特殊“风味”。使用 SVG、Canvas、Flash 等渲染图像或基于浏览器的图形。我希望能够在浏览器中呈现报告并导出为可打印的 PDF。可以使用许多框架（我更喜欢 mPDF）将静态 HTML 转换为 PDF，这样就不会有问题了。

我想要的是一个能够生成图像和基于浏览器的图形的单一框架。显然，它们应该与各种浏览器兼容，并且图表应该看起来相似（不一定相同）。最好使用 PHP 和/或 JS，但我愿意接受建议。

有谁知道一个可以呈现图像和基于浏览器的图表框架？

如果有多个框架具有几乎相同的 API 和图表，那也很好，但我怀疑这种组合是否存在。;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T07:30:58.303

我不知道有任何库能够渲染位图和 svg 或画布，支持所有图形和绘图功能。

如果我有这个问题，我会认真研究 phantomjs：

[http://code.google.com/p/phantomjs/wiki/QuickStart](http://code.google.com/p/phantomjs/wiki/QuickStart)

它是一个无头浏览器，可以渲染位图甚至 PDF。优点是，您只需要开发基于浏览器的渲染，而 phantomjs 就可以完成渲染图像的工作。

# ios - NSPersistentStoreCoordinator 有两种类型的持久存储？

> ID：12321954
> 
> 赞同：10
> 
> 时间：2012-09-07T16:23:53.363
> 
> 标签：ios, core-data

在 iOS 应用程序中，我想将 an`NSPersistentStoreCoordinator`与一个`NSIncrementalStore`子类一起使用，用于从 REST API 获取数据，还与一个 SQLite 存储一起使用，以保存到磁盘。但是，如果我将这两种类型的持久存储都添加到我的协调器中，则调用`save:`我的托管对象上下文没有任何效果。如果我只添加一个持久存储，而不是我的`NSIcrementalStore`子类的类型，那么保存会按预期工作。

有没有办法实现这个功能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-08T01:05:02.470

根据我的经验，最好的解决方案是拥有多个托管对象上下文，每个上下文都有自己的模型。

但是，有一种方法可以完成您想要的：

```
// create the store coordinator
NSPersistentStoreCoordinator *storeCoordinator = [[NSPersistentStoreCoordinator alloc] init];
// create the first store
NSPersistentStore *firstStore = [storeCoordinator addPersistentStoreWithType: NSIncrementalStore configuration:nil URL:urlToFirstStore options:optionsForFirstStore error:&error];
// now create the second one
NSPersistentStore *secondStore = [storeCoordinator addPersistentStoreWithType:NSSQLiteStore configuration:nil URL:urlToSecondStore options:optionsForSecondStore error:&error];

// Now you have two stores and one context
NSManagedObjectContext *context = [[NSManagedObjectContext alloc] init];
[context setPersistentStoreCoordinator:storeCoordinator];

// and you can assign your entities to different stores like this
NSManagedObject *someObject = [[NSManagedObject alloc] initWithEntity:someEntity insertIntoManagedObjectContext:context];
// here the relevant part
[context assignObject:someObject toPersistentStore:firstStore]; // or secondStore .. 
```

您还应该查看这些链接以更好地了解 Core Data 的工作原理：

[核心数据编程指南 - 持久存储协调器](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdBasics.html#//apple_ref/doc/uid/TP40001650-SW4)

[SO：一个托管对象上下文的两个持久存储 - 可能吗？](https://stackoverflow.com/a/5399543/719656)

[SO：两个托管对象上下文可以共享一个持久存储协调器吗？](https://stackoverflow.com/a/2990843/719656)

另请查看 TechZen 在第二个链接中关于配置的评论，并在此处阅读：

[核心数据编程指南 - 配置](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdMOM.html#//apple_ref/doc/uid/TP40002328-SW3)

这是一个很好的教程来管理两个对象上下文：

[具有核心数据的多个托管对象上下文](http://www.timisted.net/blog/archive/multiple-managed-object-contexts-with-core-data/)

# javascript - 我不知道我的编码有什么问题。(javascript)

> ID：12321957
> 
> 赞同：1
> 
> 时间：2012-09-07T16:24:02.910
> 
> 标签：javascript

```
function calculateBmr(){
var weight = prompt("Enter weight in pounds");
var height = prompt("Enter height in inches");
var age = prompt("Enter age");
var bmr = 655 + (4.35 * weight) + (4.7 * height) - (4.7 * age);
alert("Your BMR is" bmr " calories.");
}
calculateBmr(); 
```

我的代码有什么问题？它不会运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T16:25:59.707

```
alert("Your BMR is" bmr " calories."); 
```

应该

```
alert("Your BMR is" + bmr +" calories."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:26:27.473

尝试：

```
function calculateBmr(){
    var weight = parseFloat(prompt("Enter weight in pounds"));
    var height = parseFloat(prompt("Enter height in inches"));
    var age = parseFloat(prompt("Enter age"));
    var bmr = 655 + (4.35 * weight) + (4.7 * height) - (4.7 * age);
    alert("Your BMR is " + bmr.toString() + " calories.");
}
calculateBmr(); 
```

s将`parseFloat`确保用户输入的是数字并且`+`应该用于字符串连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:27:23.170

尝试这个

alert("你的 BMR 是" +bmr+ "卡路里。");

你必须使用运算符 +

> +bmr+

# matlab - 使用 Matlab 中的散射在原点（0,0）处相交 X 和 Y 轴

> ID：12321958
> 
> 赞同：1
> 
> 时间：2012-09-07T16:24:08.967
> 
> 标签：matlab, scatter-plot

我有2个矩阵：

```
X = [-1 -4 5 6]  ;
Y = [3 20 300 2] ;    %   Always > 0
scatter(x,y,4^2) 
```

默认情况下，Scatter 不会强制 X 和 Y 在原点 (0,0) 交叉。有没有办法做到这一点？请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:35:23.897

[没有内置函数可以做到这一点](http://www.mathworks.com/support/solutions/en/data/1-216M68/index.html?product=SL&solution=1-216M68)。

如果您不想使用上面链接提供的非常基本的工具，文件交换上有一些很好的解决方案，[一个更简单](http://www.mathworks.com/matlabcentral/fileexchange/22956-axescenter)，[一个更强大](http://www.mathworks.com/matlabcentral/fileexchange/30018)，尽管后者使用了一些未记录的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:35:11.600

如果您希望 x 和 y 网格线通过原点（如[本](http://www.mathworks.com/matlabcentral/newsreader/view_thread/85779)例中），我认为没有简单的方法可以做到（这里有关于类似问题的讨论[）](http://www.mathworks.com/matlabcentral/newsreader/view_thread/85779)。在 MATLAB 文件交换中，有[oaxes](http://www.mathworks.com/matlabcentral/fileexchange/30018-oaxes-central-axis-lines-through-an-origin)似乎可以满足您的需求。您必须参考其内部文档。

另一种方法是手动设置 x/y 限制并自己绘制一些轴：

```
%Set limits
xlim([-10 10]);
ylim([-300 300]);

hold on;
%Plot data
scatter(x, y);
%Plot axes
plot([0 0], [-300 300], 'k');
plot([-10 10], [0 0], 'k');
hold off; 
```

但这只会绘制一个黑色十字，没有刻度/数字等。

# wordpress - WordPress主页选择

> ID：12321968
> 
> 赞同：-1
> 
> 时间：2012-09-07T16:24:53.993
> 
> 标签：wordpress, subdomain

是否可以将 domain.com 的 index.php 作为下拉列表，根据用户是在城市 x 还是城市 y 来选择主页？然后，我希望设置一个记住用户选择的 cookie。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:35:52.037

在您的模板 header.php 中，您可以添加一段代码以从访问者国家/城市获取数据，然后使用标头位置 php 重定向到您希望他们去的地方。

或者你可以建立一个登陆页面并显示你想要的。

参考[登陆页面](http://xtremenews.info/2011/07/20/landing-pagesplash-page-en-wordpress-o-joomla/)

# css - 将鼠标悬停在图像框架效果上不适用于 Firefox .15

> ID：12321969
> 
> 赞同：1
> 
> 时间：2012-09-07T16:24:55.990
> 
> 标签：css

我使用了一个简单的 css 效果，它为图像加框并在悬停时更改框架颜色。尽管效果在 ie9 和 chrome 上完美运行，但在 firefox 上效果很差，它只是有点停留在悬停上，只有当你用鼠标从图像下方悬停时才有效？并且框架颜色变化坚持效果模式，看起来很凌乱。任何人都知道如何为 Firefox 更正此问题。CSS非常简单

```
.highlightit img{
    border: 4px solid #FFCCFF;
 }

.highlightit:hover img{
   border: 4px solid #f35c93;
   }

.highlightit:hover{
   color: red; /* Dummy definition to overcome IE bug */
 } 
```

抱歉，我尝试输入 html 代码，但没有被接受。

非常感谢

# wcf - WCF 中 ServiceContract 属性的工作

> ID：12321970
> 
> 赞同：0
> 
> 时间：2012-09-07T16:25:00.000
> 
> 标签：wcf, servicecontract

我刚开始阅读有关 WCF 的信息。作者在书中提到：

> 该`ServiceContract`属性将 CLR 接口/类映射为独立于该类型的可见性的 WCF 协定。

这怎么可能？给出的解释是：

> 类型可见性与 WCF 无关，因为可见性是 CLR 概念。

我真的不明白这怎么可能。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T09:26:36.587

无论类型的*CLR 可见性*如何，WCF 都可以[检索属性信息](http://msdn.microsoft.com/en-us/library/z919e8tw%28v=vs.71%29.aspx)以查明它实际上正在处理一个*协定*，并类似地找出该协定具有哪些*操作*。然后，WCF 可以决定将该合约及其操作公开（如“publicize”，而不是“CLR-public”），而不管底层类型的 CLR 可见性如何。

注意：鉴于 ASP.NET 和 MVC 的趋势，[对开源 WCF 的呼吁](http://aspnet.uservoice.com/forums/147206-wcf-web-services-/suggestions/2745145-open-source-the-whole-thing-so-i-can-decide-myself)可能会在未来某个时候成功。如果发生这种情况，它可能有助于更新此答案并添加指向各种实现的链接或引用以进一步说明这一点。

# c# - 从 DataReader 读取数据的通用方法

> ID：12321975
> 
> 赞同：7
> 
> 时间：2012-09-07T16:25:24.210
> 
> 标签：c#, sqldatareader

我目前正在使用这种方法从 DataReader 读取数据 -

```
private T GetValue<T>(object obj)
{
    if (typeof(DBNull) != obj.GetType())
    {
        return (T)obj;
    }
    return default(T);
} 
```

将上述方法称为 -

```
GetValue<int>(dataReader["columnName1"])
GetValue<string>(dataReader["columnName2"])
GetValue<float>(dataReader["columnName3"]) 
```

但是，当`columnName3`值`7200000`与错误一样时，这会失败
`Invalid Cast Exception.`

我正在考虑修改我的方法来替换 -

```
return (T)obj; 
```

和

```
return (T)Convert.ChangeType(obj, typeof(T)); 
```

但期待更好的方法，因为此更改将涉及两次类型转换。
有更好的想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:36:50.793

通用方法的优点是可以减少大量代码膨胀，但另外为每种数据类型生成自己的包装器可以让您灵活地进行自定义处理。与检索模式相比，您的数据库查询很可能对性能产生显着影响。

我建议您编写一组自己的扩展方法，而不是使用一种通用方法。扩展方法`IDataReader`给您带来的好处是不会在整个对象子类型上传播方法。我不得不单独处理类型，因为各种连接器的行为不同，尤其是`Guid`类型。也很难知道 datareader 是否读取了该值`0`，或者`DBNull`您何时返回`0`这两种情况。假设您的表中有一个具有空值的枚举字段。为什么你会希望它被阅读为第一个枚举？

只需致电：

```
dataReader.GetInt("columnName1")
dataReader.GetString("columnName3")
dataReader.GetFloat("columnName3") 
```

和方法：

```
public static int? GetInt(this IDataReader r, string columnName)
{
    var i = r[columnName];      
    if (i.IsNull())
        return null; //or your preferred value

    return (int)i;
}

public static bool IsNull<T>(this T obj) where T : class
{
    return (object)obj == null || obj == DBNull.Value;
} 
```

同样，

```
public static string GetString(this IDataReader r, string columnName)
{
}

public static float GetFloat(this IDataReader r, string columnName)
{
} 
```

如果你真的想要一个通用函数，你也可以拥有它。

```
public static T Get<T>(this IDataReader r, string columnName, T defaultValue = default(T))
{
    var obj = r[columnName];      
    if (obj.IsNull())
        return defaultValue;

    return (T)obj;
} 
```

所以叫它

```
dataReader.Get<int>(1); //if DBNull should be treated as 0
dataReader.Get<int?>(1); //if DBNull should be treated as null
dataReader.Get<int>(1, -1); //if DBNull should be treated as a custom value, say -1 
```

也就是说，错误是因为您没有像评论中指出的那样使用正确的类型进行投射。我本可以使用内置`DBNull`检查，但我不会避免从阅读器中多次读取数据，[灵感来自这个奇怪的微优化案例](https://stackoverflow.com/questions/221582/most-efficient-way-to-check-for-dbnull-and-then-assign-to-a-variable)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-12T08:44:54.703

从 .NET Framework 4.5 开始

```
static class SqlReaderExtension
{
    public static async Task<T> ReadAsync<T>(this SqlDataReader reader, string fieldName)
    {
        if (reader == null) throw new ArgumentNullException(nameof(reader));
        if (string.IsNullOrEmpty(fieldName))
            throw new ArgumentException("Value cannot be null or empty.", nameof(fieldName));

        int idx = reader.GetOrdinal(fieldName);
        return await reader.GetFieldValueAsync<T>(idx);
    }
} 
```

接着

```
string result = await reader.ReadAsync<string>("FieldName"); 
```

# javascript - 通过一系列对象方法处理 ajax 成功回调的干净方法是什么？

> ID：12321976
> 
> 赞同：1
> 
> 时间：2012-09-07T16:25:25.173
> 
> 标签：javascript, ajax, methods

所以，我正在努力提高我的 javascript 技能并更多地（并且正确地）使用对象，所以请耐心等待。

所以，举个例子：http: [//jsfiddle.net/rootyb/mhYbw/](http://jsfiddle.net/rootyb/mhYbw/)

在这里，我对以下每一项都有一个单独的方法：

*   加载ajax数据
*   使用加载的 ajax 数据

显然，我必须等到加载完成才能使用数据，所以我将其作为回调进行访问。

正如我现在拥有的那样，它可以工作。不过，我不喜欢将 initData 回调直接添加到 loadData 方法中。如果我想在使用数据之前加载数据并对其进行处理怎么办？如果我在处理数据时有更多方法可以运行怎么办？IMO，以这种方式链接会很快变得不可读。

有什么更好、更模块化的方式来做到这一点？

为了学习，我更喜欢不依赖 jQuery 的东西（如果有神奇的 jQuery 方式的话）。

（另外，我确定我在这个例子中做了一些可怕的事情。请随时指出我犯的其他错误。我正在阅读 Douglas Crockford 的 Javascript - The Good Parts，甚至是一个级别的业余爱好者，这很有意义，但我还没有完全理解它）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:49:05.107

我没有看到很多应该不同的地方。[我在这里](http://jsfiddle.net/mhYbw/1/)制作了小提琴的更新版本。我改变了几点：

*   对局部变量使用`var`关键字，例如`self`.
*   不要将临时状态添加为对象的状态，例如`ajaxData`，因为您可能只使用一次。
*   尽可能地封装：与其调用`loadData`对象`ajaxURL`，不如让对象决定它应该从哪个 URL 加载其数据。

最后一句话：不要试图满足你还没有的要求，即使它们将来可能会出现（我指的是你的“如果......怎么办？”问题）。如果您尝试，您很可能会发现您不需要该功能，或者需求与您过去的预期略有不同。如果您有新需求，您可以随时重构模型以满足它们。因此，为改变而设计，而不是为潜在的改变而设计。

# java - 学习线程 - 仅在另一个方法完成后运行一个方法

> ID：12321978
> 
> 赞同：1
> 
> 时间：2012-09-07T16:25:31.297
> 
> 标签：java, multithreading, swt

在我的按钮执行中，我调用了 2 个方法。

```
plotButton.addSelectionListener(new SelectionAdapter() {
    public void widgetSelected(SelectionEvent e) {
        startPrinterListOperation();  
        showAplotPlotterDialog();
    }
}); 
```

`startPrinterListOperation();`完成任务需要一些时间。但我不希望该方法 `showAplotPlotterDialog();`在第一个完成之前运行。所以我正在尝试使用线程管理来实现这一点。这是我尝试过的。

```
plotButton.addSelectionListener(new SelectionAdapter() {
    public void widgetSelected(SelectionEvent e) {
        Thread t = new Thread() {
            public void run() {
                startPrinterListOperation();  
            }
        };
        t.start();
        try {
            t.join();
        }
        catch (InterruptedException e1) {
            e1.printStackTrace();
        }

        showAplotPlotterDialog();

    }
}); 
```

但是第二种方法仍然在第一种方法完成之前开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T16:40:59.417

扩展我的评论：似乎`startPrinterListOperation`启动了一个异步操作并立即完成，`join`成功就证明了这一点。

如果启动的异步操作超出了您的控制范围，那么您可能能够通过一些回调、轮询等来观察它的完成情况。然后您可以使用以下内容`startPrinterListOperation`：

```
void startPrinterListOperation() {
    final CountDownLatch c1 = new CountDownLatch(1);
    launchTheAsyncOp(new SomeCallback() {
        void x() {
            c1.countDown();
        }
    });
    try {
        c1.await(999, TimeUnit.SECONDS)
    }
    catch (InterruptedException e) {
        throw new MyRuntimeException("user didn't finish the op in 999 seconds, fail");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:50:51.033

我不会打扰线程，这只会使您的程序过于复杂。

你可以编辑`startPrinterListOperation()`方法吗？

相反，我会添加`showAplotPlotterDialog();`到方法的末尾`startPrinter`，以及该方法所做的最后一件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T17:10:09.233

在标题中回答您的一般问题，您有一个主线程直接调用您的两个方法，以便第二个方法等待第一个方法完成。

我了解在您的具体情况下，第一种方法会运行一段时间，您希望用户不必等待。

`generatePrinterList()`在构建 GUI 时，您应该在单独的线程中调用方法。您这样做是因为您的 GUI 用户很可能会打印或绘图，并且当用户使用您的 GUI 时打印机列表不太可能更改。

奇怪的是，`generatePrinterList()`线程将在您的用户必须打印或绘图之前很久就完成。但是为了确定，线程必须有一种方法来报告线程已完成。我使用一个`boolean` `isCompleted`可以用公共`isCompleted()`方法读取的。

`isCompleted()`如果你愿意，该方法可以有一个线程睡眠循环，所以它总是返回 true。在这种情况下，该方法不必返回任何内容。

# php - 如何让一个数据库查询使用 pchart 库创建两个图表？

> ID：12321982
> 
> 赞同：0
> 
> 时间：2012-09-07T16:25:36.873
> 
> 标签：php, html, pchart

我对 pcharts 很陌生，并且了解其中的机制。`<img src='graph1.php'>`我很好地制作了一个页面，在其中使用逻辑在我的模板中显示了一个图表。

我现在有一个非常繁重的查询，它为我提供了创建 4 个图表的正确数据。我只想执行一次此查询（以最大程度地减少数据库负载），然后生成四个图表并将其加载到我的网页中。顺便提一句。查询性能无法提高，所以没办法。

我正在考虑生成 5 个数组的 query.php（一个用于公共 x 轴，4 个用于每个不同的图形 y 轴值）。

但是我不知道如何将这些数组传递给 graph1.php、graph2.php、graph3.php 和 graph4.php 文件，以便生成图表。

什么是聪明的方法来做到这一点？我宁愿不将（临时）文件写入服务器。

谢谢，

杰弗里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:31:17.253

强烈建议：创建一个临时表：

*   [http://www.tutorialspoint.com/mysql/mysql-temporary-tables.htm](http://www.tutorialspoint.com/mysql/mysql-temporary-tables.htm)

该表只会在会话期间持续存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:31:12.440

将查询结果写入会话中，并从相应的脚本中访问。（只需检查会话中是否存在数据，如果不存在，则只执行一次查询）

# c# - 当我知道它有一个带有键的条目时，C# hashtable ContainsKey 返回 false

> ID：12321986
> 
> 赞同：1
> 
> 时间：2012-09-07T16:25:55.943
> 
> 标签：c#, hashtable

```
 foreach (Ant ant in state.MyAnts)
        {
            if (m_foodTasks.ContainsKey(ant))
            {
... 
```

通过调试，我可以看到 m_foodTasks 中有一个蚂蚁，其值完全相同。所以我会假设它比较参考地址..（我是对的吗？）

我如何让它按价值进行比较？

阅读答案后编辑：

信息太多......我会花一些时间来研究这些，但这是蚂蚁班已经拥有的（我不能说所有这些东西是什么）：

```
public class Location : IEquatable<Location> {

    /// <summary>
    /// Gets the row of this location.
    /// </summary>
    public int Row { get; private set; }

    /// <summary>
    /// Gets the column of this location.
    /// </summary>
    public int Col { get; private set; }

    public Location (int row, int col) {
        this.Row = row;
        this.Col = col;
    }

    public override bool Equals (object obj) {
        if (ReferenceEquals (null, obj))
            return false;
        if (ReferenceEquals (this, obj))
            return true;
        if (obj.GetType() != typeof (Location))
            return false;

        return Equals ((Location) obj);
    }

    public bool Equals (Location other) {
        if (ReferenceEquals (null, other))
            return false;
        if (ReferenceEquals (this, other))
            return true;

        return other.Row == this.Row && other.Col == this.Col;
    }

    public override int GetHashCode()
    {
        unchecked {
            return (this.Row * 397) ^ this.Col;
        }
    }
}

public class TeamLocation : Location, IEquatable<TeamLocation> {
    /// <summary>
    /// Gets the team of this ant.
    /// </summary>
    public int Team { get; private set; }

    public TeamLocation (int row, int col, int team) : base (row, col) {
        this.Team = team;
    }

    public bool Equals(TeamLocation other) {
        return base.Equals (other) && other.Team == Team;
    }

    public override int GetHashCode()
    {
        unchecked {
            int result = this.Col;
            result = (result * 397) ^ this.Row;
            result = (result * 397) ^ this.Team;
            return result;
        }
    }
}

public class Ant : TeamLocation, IEquatable<Ant> {
    public Ant (int row, int col, int team) : base (row, col, team) {
    }

    public bool Equals (Ant other) {
        return base.Equals (other);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T16:27:13.230

检查相等性时需要重写 GetHashCode() 方法。

```
public class Ant : IEquatable<Ant>
{
    private string _someField;

    public Ant(string someField)
    {
        this._someField = someField;
    }

    #region Equality members

    public bool Equals(Ant other)
    {
        if (ReferenceEquals(null, other))
        {
            return false;
        }
        if (ReferenceEquals(this, other))
        {
            return true;
        }
        return string.Equals(_someField, other._someField);
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj))
        {
            return false;
        }
        if (ReferenceEquals(this, obj))
        {
            return true;
        }
        if (obj.GetType() != this.GetType())
        {
            return false;
        }
        return Equals((Ant) obj);
    }

    public override int GetHashCode()
    {
        return (_someField != null ? _someField.GetHashCode() : 0);
    }

    #endregion
} 
```

您可以选择创建一个 IEqualityComparer 类来为您进行比较。

```
 private sealed class SomeFieldEqualityComparer : IEqualityComparer<Ant>
    {
        public bool Equals(Ant x, Ant y)
        {
            if (ReferenceEquals(x, y))
            {
                return true;
            }
            if (ReferenceEquals(x, null))
            {
                return false;
            }
            if (ReferenceEquals(y, null))
            {
                return false;
            }
            if (x.GetType() != y.GetType())
            {
                return false;
            }
            return string.Equals(x._someField, y._someField);
        }

        public int GetHashCode(Ant obj)
        {
            return (obj._someField != null ? obj._someField.GetHashCode() : 0);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:27:47.403

您需要正确实现 GetHash 和 Equals 以使类在搜索/字典中表现为“比较值”而不是“比较参考”。

另一个（可能更好的选择）是在创建字典时提供[IEqualityComparer 。](http://msdn.microsoft.com/en-us/library/ms132151.aspx)

示例可以在文章中找到，这里是压缩版本：

```
Dictionary<Box, String> boxes = 
   new Dictionary<Box, string>(new BoxEqualityComparer());

class BoxEqualityComparer : IEqualityComparer<Box>
{
  public bool Equals(Box b1, Box b2)
  {
    return b1.Height == b2.Height;
  }

  public int GetHashCode(Box bx)
  {
    return bx.Height.GetHashCode();
  }
} 
```

# windows - VLC 媒体播放器的审查插件或扩展

> ID：12321988
> 
> 赞同：10
> 
> 时间：2012-09-07T16:26:03.503
> 
> 标签：windows, plugins, lua, vlc

我有一个想法为 VLC 播放器创建一个审查插件/扩展..

**问题场景：**

一部好电影中 1 分钟的成人场景使家庭无法观看。

**我的解决方案：**

创建执行以下操作的插件/扩展

*   从类似于字幕文件的文件中读取时间位置
*   玩时跳过这些时间位置（成人或不合适的）

**我需要的帮助：**

我在谷歌和videolan网站上搜索过，但找不到确切的解决方案

*   是否已经有类似的插件可用？
*   我应该从哪里开始？

如果可以的话，请帮助我..谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T10:55:36.353

同样寻找拥有/开发完全相同的解决方案。这可能对您有帮助。

[http://code.google.com/p/movie-content-editor/](http://code.google.com/p/movie-content-editor/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-19T13:38:59.200

github上也有类似的东西：

[https://github.com/rdp/sensible-cinema](https://github.com/rdp/sensible-cinema)

您可能还想阅读此讨论主题：

[https://forum.videolan.org/viewtopic.php?t=89466](https://forum.videolan.org/viewtopic.php?t=89466)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-03T12:10:47.607

[在这里](https://superuser.com/a/679434)找到类似的答案

* * *

如果您将随机字节切掉，则电影可能无法播放。播放器可能会崩溃或无法重新同步流 - 视频可能会停止。另外，可以这么说，您将很难弄清楚“成人”字节在哪里。

如果您已经知道要剪切的部分在哪里，我会在[众多视频编辑器](https://en.wikipedia.org/wiki/List_of_video_editing_software)中的任何一个中编辑该文件。甚至 Windows Movie Maker 或 iMovie 都可以完成这项工作，并且在两个主要操作系统上都可以轻松使用。

* * *

这是 VLC 要求的功能。那里没有任何用户友好的东西。尽管如此，VLC 提供了以某种格式创建播放列表的可能性，这些播放列表会静音或跳过文件的某些部分。这称为[XSPF](https://wiki.videolan.org/XSPF)。您也许可以为此找出正确的格式。

此外，还有[电影内容编辑器](https://code.google.com/p/movie-content-editor/)：

> 一个基于 VLC 的编辑器，内置在 python 中，允许用户创建和使用自定义过滤器文件，使电影更适合家庭。允许用户让播放器根据这些场景的内容自动静音特定单词或跳过某些场景。

和[明智的电影院](https://github.com/rdp/sensible-cinema)：

> Clean Editing Movie Player 允许您通过将删除列表 (EDL)（即“静音”或“剪切”场景）应用于 DVD/文件来观看编辑后的电影，初步支持也将它们应用于任意基于 Web/Internet 的播放器，如 netflix即时、hulu/hulu plus 等

另请参阅 VideoLAN 论坛上的这些主题：

*   [自动跳过视频中不需要的部分](https://forum.videolan.org/viewtopic.php?f=7&t=76253&start=0)
*   [Clearplay-like（内容过滤器）模块存在吗？](https://forum.videolan.org/viewtopic.php?f=32&t=89466)

# c# - Selenium 错误：服务器没有响应 url http://localhost:7055

> ID：12321991
> 
> 赞同：15
> 
> 时间：2012-09-07T16:26:23.783
> 
> 标签：c#, selenium, nunit

我正在使用 Selenium、C#、NUnit 编写测试，有时我会遇到以下错误：-

> OpenQA.Selenium.WebDriverException：服务器没有响应 url httр://lоcalhost:7055/hub/session/8dd13f5c-7ca6-4aa6-babc-f0ff6d940f0a/element

这是堆栈跟踪：

> OpenQA.Selenium.WebDriverException：在 OpenQA.Selenium.Remote.HttpCommandExecutor.CreateResponse(WebRequest request) 中的 url httр://localhost:7055/hub/session/8dd13f5c-7ca6-4aa6-babc-f0ff6d940f0a/element 没有来自服务器的响应c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\HttpCommandExecutor.cs:c:\Projects\WebDriver\trunk\dotnet\src 中 OpenQA.Selenium.Remote.HttpCommandExecutor.Execute(Command commandToExecute) 的第 115 行\WebDriver\Remote\HttpCommandExecutor.cs：OpenQA.Selenium.Firefox.Internal.ExtensionConnection.Execute(Command commandToExecute) 的第 96 行，位于 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Firefox\Internal\ExtensionConnection.cs ：OpenQA.Selenium.Remote.RemoteWebDriver.Execute（String driverCommandToExecute，Dictionary`2 参数）的第 128 行：\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs：c:\Projects\WebDriver\trunk\dotnet\ 中 OpenQA.Selenium.Remote.RemoteWebDriver.FindElement（字符串机制，字符串值）的第 795 行src\WebDriver\Remote\RemoteWebDriver.cs:第 836 行在 OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById(String id) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:line 431在 OpenQA.Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) in c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:OpenQA.Selenium.By.FindElement(ISearchContext context) 的第 102 行在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:line 272 at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by) in c:\Projects\WebDriver\trunk\dotnet\src\ WebDriver\Remote\RemoteWebDriver.cs：第 289 行Selenium.Remote.RemoteWebDriver.FindElement（字符串机制，字符串值）在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById 的第 836 行（字符串id) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:line 431 at OpenQA.Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) in c:\Projects\WebDriver\ trunk\dotnet\src\WebDriver\By.cs：OpenQA.Selenium.By.FindElement(ISearchContext context) 中的第 102 行，位于 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:OpenQA 的第 272 行.Selenium.Remote.RemoteWebDriver.FindElement(By by) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:line 289 atSelenium.Remote.RemoteWebDriver.FindElement（字符串机制，字符串值）在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById 的第 836 行（字符串id) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:line 431 at OpenQA.Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) in c:\Projects\WebDriver\ trunk\dotnet\src\WebDriver\By.cs：OpenQA.Selenium.By.FindElement(ISearchContext context) 中的第 102 行，位于 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:OpenQA 的第 272 行.Selenium.Remote.RemoteWebDriver.FindElement(By by) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs:line 289 at\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs：第 836 行，位于 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver 中的 OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById(String id) \Remote\RemoteWebDriver.cs:OpenQA.Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) 中的第 431 行在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:OpenQA 的第 102 行。 Selenium.By.FindElement(ISearchContext context) in c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:line 272 at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by) in c:\Projects \WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs：第 289 行\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs：第 836 行，位于 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver 中的 OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById(String id) \Remote\RemoteWebDriver.cs:OpenQA.Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) 中的第 431 行在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:OpenQA 的第 102 行。 Selenium.By.FindElement(ISearchContext context) in c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:line 272 at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by) in c:\Projects \WebDriver\trunk\dotnet\src\WebDriver\Remote\RemoteWebDriver.cs：第 289 行Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs：OpenQA.Selenium.By.FindElement(ISearchContext context) 的第 102 行 in c: \Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:第 272 行在 OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote \RemoteWebDriver.cs：第 289 行Selenium.By.<>c__DisplayClass2.b__0(ISearchContext context) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs：OpenQA.Selenium.By.FindElement(ISearchContext context) 的第 102 行 in c: \Projects\WebDriver\trunk\dotnet\src\WebDriver\By.cs:第 272 行在 OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by) 在 c:\Projects\WebDriver\trunk\dotnet\src\WebDriver\Remote \RemoteWebDriver.cs：第 289 行
> 
> .####.##.#####.#########.#####.ShareServicesTest.CreateShareWidget()

出现此错误的代码：

```
Driver.SwitchTo().Frame(frameElement);    
var wait = new WebDriverWait(parentContextable.Context.Driver, Timeout);
IWebElement element = wait.Until(d => Driver.FindElement(By.TagName(Tags.Body))); // error in this line 
```

我发现这个错误只能在这几行 Selenium 实现代码中抛出：

```
private static Response CreateResponse(WebRequest request)
        {
            Response commandResponse = new Response();

            HttpWebResponse webResponse = null;
            try
            {
                webResponse = (HttpWebResponse)request.GetResponse();
            }
            catch (WebException ex)
            {
                webResponse = (HttpWebResponse)ex.Response;
            }

            if (webResponse == null)
            {
                throw new WebDriverException("No response from server for url " + request.RequestUri.AbsoluteUri);
            }
            else
            { ... 
```

也许有人知道为什么 request.GetResponse() 返回 null，或者如果失败，为什么 ex.Response 也为 null？

(09.09.2012) 抱歉，也许我没有提供所有信息。我正在使用 FireFox 驱动程序、Win7、Selenium 2.25.1。我的测试有时会失败。在调试模式下测试失败的频率低于在发布模式下。

[在这里](https://groups.google.com/forum/#!msg/selenium-users/W7bYZIgOREA/tWzCCutVS8QJ)，我找到了发生这种情况的可能原因。如果我写这样的代码：

```
Driver.SwitchTo().Frame(frameElement);    
var wait = new WebDriverWait(parentContextable.Context.Driver, Timeout);
Tread.Sleep(250);
IWebElement element = wait.Until(d => Driver.FindElement(By.TagName(Tags.Body))); 
```

测试运行正常。但是 Thread.Sleep 是不好的解决方案。也许有人可以找到另一个更好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T17:15:24.857

在这里找到以下解决方法：

[https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/1im-LurjK5s](https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/1im-LurjK5s)

[http://watirmelon.com/2011/10/04/c-avoiding-the-webdriverexception-no-response-from-server-for-url/](http://watirmelon.com/2011/10/04/c-avoiding-the-webdriverexception-no-response-from-server-for-url/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:32:31.470

你用的是IE吗？我得到了这个，直到我发现我可以通过对象上的配置来设置基本 URL。否则，它带你到的第一页是由 Selenium 生成的，它似乎错过了“真实”请求的线索。

```
 var options = new InternetExplorerOptions()
 {
     InitialBrowserUrl = _baseUrl,
     IntroduceInstabilityByIgnoringProtectedModeSettings = true
 };

 _driver = new InternetExplorerDriver(_ieDriverServerPath, options); 
```

我`TextFixtureSetup`在测试中的一种方法中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T21:03:48.623

我有同样的问题并以这种方式解决：

a) 避免使用诸如'do wity retry'之类的方法来操作 IWebElements，因为这样测试需要花费很多时间来运行，这是不必要的，并且测试会间歇性地失败。

b) 将 Firefox 版本降级到 5（可能从 FF 3.6 到 6 可以正常工作，但新版本的 FF 会引发间歇性异常，例如“集线器/会话无响应...”

c) 如果您需要在页面上处理通过 Ajax 加载的测试中的元素，请务必提供一个可以停止元素加载的 js 函数，因此您应该在 FindElement 和`do what you want`.

# javascript - 当 window.location 执行时，window.open 不起作用

> ID：12321997
> 
> 赞同：0
> 
> 时间：2012-09-07T16:26:36.243
> 
> 标签：javascript

```
 $<input class="cartbutton" type="button" onclick="window.open='/cart.php?a=add&pid=1'" value="Order Now »"> 
```

不幸的是 window.open 不起作用，但是与 window.location 完全相同的代码可以正常工作。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T16:27:38.753

[window.open](https://developer.mozilla.org/en-US/docs/DOM/window.open)是一个方法调用。

```
window.open('example.com'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T16:28:42.153

window.open 是一个函数。做 window.open(youLocation);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T16:29:54.663

`open`是一种方法，因此您需要通过调用来调用它

```
window.open('/cart.php?a=add&pid=1'); 
```

window.open 还需要几个您可能想要[查看的](http://www.w3schools.com/jsref/met_win_open.asp)参数。