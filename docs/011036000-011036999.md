# StackOverflow 问答 11036000-11036999

# backbone.js - Backbone collection foreach rendering different with alert

> ID：11036005
> 
> 赞同：0
> 
> 时间：2012-06-14T15:05:26.147
> 
> 标签：backbone.js

My code work in three step:

*   I fetch a collection with a structure.
*   I populate the collection.
*   I render the collection with collectionView.

When i render the collection with cssElementListView,

*   if i let alert("toto"), it render me properly all the collection.
*   If not, it just render me [Object object].

What's wrong ?

```
 /************************************ Collection *******************************/

var cssElementList = Backbone.Collection.extend({
//on permet de charger different model de donnée
    initialize: function(props) {
        var self=this;

    // binding definition
        _.bindAll(this, "populate");
        this.bind('reset', this.populate);

        // get value from props
        this.url=(props.url==undefined)? "model.json" : props.url;
        this.elem=(props.elem==undefined)? "#age" : props.elem;
        this.model=(props.model==undefined)? cssElement : props.model;
        this.meta("result", "false");

    //fetch with url JSON file
        this.fetch();
    },

    populate: function(){
        var self=this;
        this.each(function(model){
            var mid=model.get('id');
            var mavaleur=$(self.elem).css(mid);
            model.set("value",mavaleur);
        });
    },
});

/************************************ CollectionView *******************************/
//Collection View
var cssElementListView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this, 'render');
        this.render();
    },
    render: function(){
        var self=this;
        //TROUBLE IS HERE
        alert("toto");
        this.collection.each(function(model){
            var view = new cssElementView({ el: this.el, model: model });
            $(this.el).append(view.render());
        },this);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:02:45.083

I suspect it is a problem with the asynchronous nature of fetch(). your call to alert gives it enough time to finish fetching the data from the server, but if you don't make the call, the collection is still empty when you try to render because the ajax for fetch hasn't returned from the server and called its success callback yet. (you can read through the code [here](https://github.com/documentcloud/backbone/blob/master/backbone.js), around line 758.)

You would be better off binding your render to a reset event (or [other event](http://backbonejs.org/#FAQ-events)) rather than rendering immediately when you initialize your view, like so:

```
// in cssElementListView.initialize 
this.collection.on('reset', this.render, this); 
```

# css - 使用过渡更改 CSS3 动画持续时间

> ID：11036007
> 
> 赞同：3
> 
> 时间：2012-06-14T15:05:41.513
> 
> 标签：css, css-transitions, css-animations

我尝试像这样减少动画持续时间。

```
@-webkit-keyframes rotate {
  from {
    -webkit-transform: rotate(0deg);
  }
  to { 
    -webkit-transform: rotate(360deg);
  }
}

#platines .disc {
  background: url(../img/disc.png) no-repeat;
  height: 86px;
  width: 86px;
  margin-top: 1px;
  position: absolute;
  z-index: 1;
  -webkit-animation-name:             rotate; 
  -webkit-animation-duration:         0.9s; 
  -webkit-animation-iteration-count:  infinite;
  -webkit-animation-timing-function:  linear;
}

#platines .disc.paused {
  -webkit-transition: -webkit-animation-duration 2s;
  -webkit-animation-duration:  60s; 
  -webkit-animation-iteration-count:  4;
} 
```

不幸的是，这不起作用。您是否已经找到解决此问题的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T23:47:42.283

不，这是不可能的。Animation-duration 是不可动画的。

[来源 MDN](https://developer.mozilla.org/en-US/docs/CSS/animation-duration)

如果在动画运行时更改此值，它将重新启动动画而不进行过渡。

# java - Amazon S3 Java API 仅下载 50 个对象

> ID：11036010
> 
> 赞同：1
> 
> 时间：2012-06-14T15:05:44.150
> 
> 标签：java, amazon-s3, amazon

这让我很头疼，所以我想我会发布简单的解决方案。我的问题是，在为 Amazon 的 S3 使用 Java API 时，我只能下载 50 个对象，然后它就会神秘地超时。代码看起来像这样：

```
int counter = 0;
AmazonS3Client s3 = new AmazonS3Client(propertiesFile);
while(objectList.isTruncated()){
for(S3ObjectSummary objectSummary : objectList.getObjectSummaries()){
    System.out.println(++counter);
    S3Object object = s3.getObject(new GetObjectRequest(bucketName, objectSummary.getKey()));
//do stuff
}
} 
```

它会运行并处理恰好 50 个对象的所有内容，然后超时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:05:44.867

无论出于何种原因，主要问题是我已将 s3 声明为`AmazonS3Client s3`. 它应该看起来像：

```
AmazonS3 s3 = new AmazonS3Client(propertiesFile); 
```

以防万一其他人遇到这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T05:55:43.377

希望虽然您可以调用 getObject 来下载它，但您并没有关闭 InputStream。这是通过调用 getObject() 来选择的；处理完每个对象后，您必须关闭 InputStream。

阅读更多详细信息：[http](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Client.html#getObject(com.amazonaws.services.s3.model.GetObjectRequest) ://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Client.html#getObject(com.amazonaws.services.s3.model.GetObjectRequest )

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-05T12:33:50.900

对于 Scala 开发人员，这里是使用官方[AWS SDK for Java](http://aws.amazon.com/sdkforjava/)执行 AmazonS3 存储桶内容的***完整扫描和映射的递归函数***

```
import com.amazonaws.services.s3.AmazonS3Client
import com.amazonaws.services.s3.model.{S3ObjectSummary, ObjectListing, GetObjectRequest}
import scala.collection.JavaConversions.{collectionAsScalaIterable => asScala}

def map[T](s3: AmazonS3Client, bucket: String, prefix: String)(f: (S3ObjectSummary) => T) = {

  def scan(acc:List[T], listing:ObjectListing): List[T] = {
    val summaries = asScala[S3ObjectSummary](listing.getObjectSummaries())
    val mapped = (for (summary <- summaries) yield f(summary)).toList

    if (!listing.isTruncated) mapped.toList
    else scan(acc ::: mapped, s3.listNextBatchOfObjects(listing))
  }

  scan(List(), s3.listObjects(bucket, prefix))
} 
```

要调用上述 curried`map()`函数，只需在第一个参数列表中传递已构建（并正确初始化）的 AmazonS3Client 对象（请参阅官方[AWS SDK for Java API 参考](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html)）、存储桶名称和前缀名称。还传递`f()`要应用的函数以映射第二个参数列表中的每个对象摘要。

例如

```
val tuple = map(s3, bucket, prefix)(s => (s.getKey, s.getOwner, s.getSize)) 
```

将返回该`(key, owner, size)`桶/前缀中的完整元组列表

或者

```
val totalSize = map(s3, "bucket", "prefix")(s => s.getSize).sum 
```

将返回其内容的总大小（注意`sum()`在表达式末尾应用的附加折叠函数；-）

您可以像在函数式编程中`map()`通常通过[Monads处理的那样与许多其他函数结合使用](http://en.wikipedia.org/wiki/Monad_%28functional_programming%29)

# trigger.io - 使用现有的 iOS 开发者证书进行 Trigger.io iphone 开发

> ID：11036011
> 
> 赞同：1
> 
> 时间：2012-06-14T15:05:44.277
> 
> 标签：trigger.io

我目前正在关注此链接以在我的 iphone 上测试 trigger.io iOS 版本，但遇到了问题。我在 iOS 配置门户中有一个现有的 IOS 开发人员证书，因此无法上传新证书？

我不想 rmeove 这个证书，因为我在应用商店中有现有的应用程序正在使用它。

所以我的问题是我可以使用我现有的证书来测试我的 iPhone 上的构建吗？当我下载并安装我的证书然后尝试导出它时，我无法以 .pfx 格式导出它？

编辑：我正在尝试在 Windows 机器上执行此操作。

谢谢，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:47:06.117

您为此使用Mac吗？在这种情况下，您根本不需要导出您的证书：我们会自动使用安装在您钥匙串中的证书。

默认情况下，我们会选择一个名称以“iPhone Developer”开头的名称，但您也可以使用`developer_certificate`参数覆盖它（如果您有多个证书）。

[http://docs.trigger.io/en/v1.3/tools/local-config.html#ios](http://docs.trigger.io/en/v1.3/tools/local-config.html#ios)

# java - 如何使用 JConsole 分析交换空间

> ID：11036014
> 
> 赞同：0
> 
> 时间：2012-06-14T15:05:45.323
> 
> 标签：java, memory-management, solaris, swap

我在远程 Solaris 机器上将 Java Web 应用程序 (WAR) 部署到 Tomcat，该机器抛出 IOExceptions 声称“空间不足”。在花了几天痛苦地研究这个问题之后，我发现我的代码中有一些进程分叉，需要 Solaris 将父/子进程都放在系统交换空间中，并且时不时地没有足够的交换空间来包含这两个过程。[这](http://wiki.hudson-ci.org/display/HUDSON/IOException+Not+enough+space)是一篇文章，它比我更雄辩/聪明地解释了正在发生的事情。但它绝对是罪魁祸首。

所以我需要向我们的系统管理员提交一张票以增加交换空间，但我一直试图弄清楚我需要多少空间。我可以使用 JConsole 来分析服务器上的内存使用情况，但在`VM Summary`选项卡上，使用的交换空间/可用信息似乎只有在 JConsole 启动并且不刷新时才会被读取。这使我无法在重现此分叉/内存问题时使用 JConsole 查看实时交换使用情况。

我可以访问的唯一服务器监视器是一个叫做`prstat`（我习惯`top`和`nmon`）的东西。

我需要给系统一个特定的数字（即，*请将 myserver.net 的交换空间增加 250M*等）。**我怎样才能获得这个号码？**服务器在 Java 1.6u25 上运行，所以可能有一些我不知道的 Java 工具，或者我可能可以使用一些 Solaris 分析器/监视器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:17:18.420

通常，您会使交换空间至少与主内存大小一样大。所以一台 16 GB 的机器可能有 16 GB 的交换空间。（以前的情况是swap是主存大小的很多倍）

对于 Java，除了“堆外”内存之外，它都必须在物理内存中。这是因为如果您执行 GC，它将检查所有内存，即使其中一些已被交换，您的应用程序也会一次挂起几秒钟或几分钟。

如果您的应用程序似乎需要更多交换空间，那么您真正需要的是更多主内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:30:01.297

如果您提供更多信息，例如当前 RAM 和交换大小、正在运行的 JVM 数量、它们的堆大小和虚拟内存使用情况以及这些分叉进程的预期并发级别，将会有所帮助。`prstat -Z`输出也会有所帮助。

在任何情况下，您都可以使用该`swap -s`命令监控虚拟内存使用情况，并确保最后一个值（...k 可用）总是足够大。

请注意，尽管人们普遍认为，交换太大完全没有问题，因此我建议您将当前交换区域大小简单地增加一倍作为第一种方法。

`swap -l`您使用该命令获得了当前交换区域的大小。

[这](http://developers.sun.com/solaris/articles/solaris_memory.html)是一篇关于 Solaris 应用程序内存管理的文章，可能也有帮助。

# jquery - jQuery 脚本突然失败 - 无法纠正问题

> ID：11036015
> 
> 赞同：0
> 
> 时间：2012-06-14T15:05:46.243
> 
> 标签：jquery, wordpress, jquery-plugins, easing, jquery-easing

我有一个**网站需要在星期一**之前上线，并且在主要主页组件中遇到了突然的问题。任何帮助将不胜感激！

昨天，一切正常。我撤消了昨天的更改，但即使清除了缓存，问题也没有自行纠正。

该网站是： http: [//pinnaclejobswinnipeg.com](http://pinnaclejobswinnipeg.com)

**问题一：** 首页中间区域有一个标签内容滑块。从今天开始（**尽管过去一个月运行良好**），当您单击选项卡时脚本会中断。

***错误是：***

> 未捕获的类型错误：对象# 的属性“未定义”不是函数

*   此错误发生在 jQuery.easing.1.3.js 中，它由页面顶部的 Wordpress 主题 (uDesign) 内容滑块加载。
*   顶部滑块继续正常工作，无论底部标签滑块是否损坏。
*   如果我删除标签滑块，错误就会消失。
*   如果我删除顶部滑块，选项卡滑块再次工作，没有错误（因为未加载缓动 JS）。

我一生都无法弄清楚出了什么问题，我在搜索时也找不到任何有用的东西。

**问题2：**

*   选项卡滑块脚本在每个浏览器中都可以正常工作，但在（惊喜...）IE7 中莫名其妙地中断。
*   ***注意：***站点元素实际上是两个选项卡滑块，它们本身由选项卡触发（选项卡：Executive Search - 调用一组滑动选项卡|| 选项卡：人员配备 - 调用另一组滑动选项卡）。每个选项卡集的脚本基本相同，具有不同的 CSS 调用。

**有问题的脚本：**

*   **选项卡滑块 1**

    var j = jQuery.noConflict();

j(文档).ready(函数(){

```
var doIsSliding;
var itemNumber;
var itemWidth = 750;
var holderLength = j(".changeme .changeContentItem");
var holderWidth = 200 * holderLength;
var animSpeed = 400;
var currentChange, currentChangeLink;

// init
j(".changeme .changeContent").css("width",itemWidth+"px");
j(".changeme .changeContentItem").css({"display":"none","position":"absolute"});
j(".changeme .changeContentItem:first").css("display","block").addClass("change-active");
j(".changeme .changing ul a:first").addClass("change-active");

j(".changeme .changing ul a").bind("click", function() {
    if (doIsSliding != true) {
        itemNumber = j(this).attr("rel");
        currentChange = j(".changeme #contentItem"+itemNumber);
        // if not current item
        if (!currentChange.hasClass("change-active")) {
            doIsSliding = true;
            // clear prev
            j(".changeme .changing ul a").removeClass("change-active");
            // slide down current
            currentChangeLink = j(this);
            currentChangeLink.addClass("change-active");
            currentChange.css({"opacity":"0","left":itemWidth+"px","display":"block"})
                .animate({
                    left: '20',
                    opacity: 1,
                },animSpeed,function(){
                    currentChange.addClass("change-active");
                    j(".changeme .changeContentItem").css("display","none");
                    j(".changeme .changeContent .change-active").css("display","block");
                    doIsSliding = false;
            });
            j(".changeme .changeContent .change-active").css({"opacity":"1","left":"0px","display":"block"}).addClass("last-active")
                .animate({
                    left: '-'+itemWidth,
                    opacity: 0
                },animSpeed,function(){
                    j(".changeme .changeContent .last-active.change-active").css("display","none").removeClass("last-active").removeClass("change-active");
                    doIsSliding = false;
            });
        }
    }
}); 
```

});

*   **选项卡滑块 2**

    var j = jQuery.noConflict();

j(文档).ready(函数(){

```
var doIsSliding;
var itemNumber;
var itemWidth = 750;
var holderLength = j(".change2 .changeContentItem");
var holderWidth = 200 * holderLength;
var animSpeed = 400;
var currentChange, currentChangeLink;

// init
j(".change2 .changeContent2").css("width",itemWidth+"px");
j(".change2 .changeContentItem").css({"display":"none","position":"absolute"});
j(".change2 .changeContentItem:first").css("display","block").addClass("change-active");
j(".change2 .changing ul a:first").addClass("change-active");

j(".change2 .changing ul a").bind("click", function() {
    if (doIsSliding != true) {
        itemNumber = j(this).attr("rel");
        currentChange = j(".change2 #contentItem"+itemNumber);
        // if not current item
        if (!currentChange.hasClass("change-active")) {
            doIsSliding = true;
            // clear prev
            j(".change2 .changing ul a").removeClass("change-active");
            // slide down current
            currentChangeLink = j(this);
            currentChangeLink.addClass("change-active");
            currentChange.css({"opacity":"0","left":itemWidth+"px","display":"block"})
                .animate({
                    left: '20',
                    opacity: 1
                },animSpeed,function(){
                    currentChange.addClass("change-active");
                    j(".change2 .changeContentItem").css("display","none");
                    j(".change2 .changeContent2 .change-active").css("display","block");
                    doIsSliding = false;
            });
            j(".change2 .changeContent2 .change-active").css({"opacity":"1","left":"0px","display":"block"}).addClass("last-active")
                .animate({
                    left: '-'+itemWidth,
                    opacity: 0
                },animSpeed,function(){
                    j(".change2 .changeContent2 .last-active.change-active").css("display","none").removeClass("last-active").removeClass("change-active");
                    doIsSliding = false;
            });
        }
    }
}); 
```

});

非常感谢您提供的任何帮助！

鲍比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:19:12.440

打开网站我直接收到以下错误：

$("a[rel^='wp-prettyPhoto'], a[rel^='prettyPhoto']").prettyPhoto 不是函数 [Parar en este error]

它生成到[http://pinnaclejobswinnipeg.com/wp-content/themes/u-design/scripts/prettyPhoto/custom_params.js?ver=3.1.3](http://pinnaclejobswinnipeg.com/wp-content/themes/u-design/scripts/prettyPhoto/custom_params.js?ver=3.1.3)文件的第 80 行。

执行选择器 $("a[rel^='wp-prettyPhoto'], a[rel^='prettyPhoto']") 后，我得到了 [] 作为结果。

如果这是您问题的根源，我不知道，但这是错误的。

亲切的问候

# jquery - elem.nodeName 返回未定义的 jQuery 错误？

> ID：11036017
> 
> 赞同：1
> 
> 时间：2012-06-14T15:05:54.280
> 
> 标签：jquery, validation

目前，我正在调整注册页面以使用 Ajax/jQuery。它处于简单阶段，只需输入用户名和密码。

我想使用 jQuery 告诉用户用户名文本框中的当前条目是否无效或已被使用。如果满足任一条件，则 div namemsg 将添加文本并执行fadeIn 事件。

页面加载时禁用了提交按钮，并在通过验证后启用了按钮。为此，我有以下 ajax 请求来处理用户名验证

```
$("#username").keyup(function(){
    //get current value
    thisVal = $(this).val();

    //execute request to see if current val exists in database
    $.ajax({
      type: "GET",
      url: "includes/phpscripts.php?action=checkUser",
      data: {username:thisVal},
      success: function(data){

        //if username is already taken, show warning and disable submit button
        if (data == 'true'){
          $("#namemsg").text("Username is already taken");
          $("#namemsg").fadeIn(100);
          $("#submit").attr('disabled', 'disabled');
        } 

        //otherwise, possible valid username
        else if (data == 'false'){

          //check if username is of the proper length.  If not, display
          //error and disable submit button
          if ($(this).val().length < 5){
            $("#namemsg").text("Invalid Username");
            $("#namemsg").fadeIn(100);
            $("#submit").attr('disabled', 'disabled');
          } 

          //valid username, enable submit button and hide any error messages
          else {
            $("#namemsg").hide();
            $("#submit").removeAttr("disabled");
          }

        }
      }

    });

    return false;
}); 
```

我的问题是请求从服务器获取了propper值，但是firebug抱怨`elem.nodeName`在jquery 1.7.2的第2368行未定义。那条线是

```
if ( elem ) {
  hooks = jQuery.valHooks[ elem.nodeName.toLowerCase() ] || jQuery.valHooks[ elem.type ]; 
```

当我在 处设置断点时`if (elem)`，`elem`有值

```
nodeName : INPUT
type : text 
```

并`hooks`返回未定义。这是 Firefox 特有的问题，还是我的代码或 jQuery 的问题？另外，是否有解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T15:13:33.913

在您的`success`处理程序中，`this`是 jqXHR 请求，而不是`$("#username")`字段，因此`$(this).val()`出错。

由于您已经缓存了值，因此最好使用`thisVal`而不是`$(this).val()`，但通常解决此问题的方法是将`context`选项设置为元素；

```
$.ajax({
    context: this,
    type: 'GET',
    // etc
}); 
```

您可以在页面上查看此方法的文档[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)（搜索“上下文”）。

您将看到的另一种方法是将`this`指向元素的 that 设置为另一个变量；

```
$("#username").keyup(function(){
    var that = this;

    $.ajax({
      type: "GET",
      url: "includes/phpscripts.php?action=checkUser",
      data: {username:thisVal},
      success: function(data){
          // use `that` and `$(that)` in here
      }    
    });

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:13:47.987

问题出在这一行

```
if ($(this).val().length < 5){ 
```

`this`不指`#username`异步回调的内部。

采用

```
if (thisVal.length < 5){ 
```

正如您之前缓存的那样。

# wpf - treeview 和 mvvm 我不填充树视图

> ID：11036020
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:02.017
> 
> 标签：wpf, mvvm, treeview

我有以下代码。

我的树视图项：

```
class ComponenteNodoViewModel : BaseViewModel
{
    public string Nombre { get; set; }
    private List<ComponenteNodoViewModel> _children;
    private bool _isExpanded;
    private bool _isSelected;

    public ComponenteNodoViewModel Parent { get; set; }

    public bool IsExpanded
    {
        get { return _isExpanded; }
        set
        {
            _isExpanded = value;
            base.RaisePropertyChangedEvent("IsExpanded");
        }
    }

    public bool IsSelected
    {
        get { return _isSelected; }
        set
        {
            _isSelected = value;
            base.RaisePropertyChangedEvent("IsSelected");
        }
    }

    public List<ComponenteNodoViewModel> Children
    {
        get { return _children; }
        set { _children = value; }
    }

} 
```

我拥有 treeView 的视图的 ViewModel。我在GUI中有更多的元素，还有一些底部等等，但我只放了与treeView有关系的代码。

```
public List<ComponenteNodoViewModel> ComponenteJerarquia { get; private set; }

...

private void componenteJerarquiaConstruirArbol(List<vComponentesEstructuras> paramNodos)
{

    List<ComponenteNodoViewModel> misNodos = new List<ComponenteNodoViewModel>();

    ComponenteNodoViewModel miNodo = new ComponenteNodoViewModel();
    miNodo.Nombre = "Prueba";
    misNodos.Add(miNodo);
    ComponenteJerarquia = new List<ComponenteNodoViewModel>(misNodos);
} 
```

最后是我的视图 xaml：

```
<UserControl x:Class="GTS.CMMS.Client.Views.ucMaquinasPrincipalView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:cmd="clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.WPF4"
             xmlns:ViewModels="clr-namespace:Project.ViewModel"
             mc:Ignorable="d"  d:DesignHeight="800" d:DesignWidth="1000">

    <Grid>
        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="232" />
                <ColumnDefinition Width="757" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="309*" />
                <RowDefinition Height="350*" />
            </Grid.RowDefinitions>

            <TreeView ItemsSource="{Binding ComponenteJerarquia}" Margin="6,6,8,5" Name="trvComponente" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                <HierarchicalDataTemplate DataType="{x:Type ViewModels:ComponenteNodoViewModel}" ItemsSource="{Binding Path=Children}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Path=Nombre}"/>
                    </StackPanel>
                </HierarchicalDataTemplate>

                <HierarchicalDataTemplate DataType="{x:Type ViewModels:ComponenteNodoViewModel}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Path=Nombre}"/>
                    </StackPanel>
                </HierarchicalDataTemplate>         
            </TreeView>                    
        </Grid>
    </Grid>
</UserControl> 
```

问题是当我调用 componenteJerarquiaConstruirArbol 方法时，树视图没有被填充。

我认为问题在于绑定，但我看不到问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:15:44.960

该`ComponenteJerarquia`属性只是一个普通属性，因此当您设置它时，不会通知绑定系统它需要更新绑定。您需要`INotifyPropertyChanged`在该类中实现并`PropertyChanged`在 setter 中引发事件。

好的，另一部分是您不应该将 HierarchicalDataTemplates 放在 TreeView 中 - 这使它认为您正在尝试将它们放在实际的树中。将这些模板移到您的资源中。

# javascript - 在 Zend 中生成控制器/动作

> ID：11036021
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:03.950
> 
> 标签：javascript, zend-framework, content-management-system

我打算编写一些基本的 cms 并有一些问题。

Imagen 你有一个这样的导航：

```
Home --> www.foo.com/home
About Us --> www.foo.com/about_us
Contact --> www.foo.com/contact 
```

它们中的每一个都是一个控制器，子导航可以是动作。Imagen 现在，您有一个“添加导航点”按钮，因此用户可以添加新页面。他将添加“新闻”页面，所以现在我需要创建一个控制器和一个索引操作，也许还有其他一些操作。

基本上，这没有问题。我可以生成一个字符串并创建文件。但是有什么好的方法吗？不知何故，我认为，这是错误的。

注意：我不想使用任何数据库。此外，我将尝试将视图从 .phtml 更改为 .html 并使用 js。将 json 从控制器传递到我的视图。

目标如下：用户应该能够添加一个新页面，输入该页面的模板，添加一个 css 和一些 js 文件。我会将整个主页结构保存在文件系统上。

我的想法是创建一个助手来检查例如是否存在相应的视图。所以我根本不需要控制器和动作。

无论如何，我很不确定，希望你能理解我。

我希望将所有内容都包含在 .html 文件中并使用 JS 进行模板化的原因是，我希望它可以实时编辑，并且大多数设计师不知道 PHP 语法。我真的很喜欢 mustache，既然 mustache 无论如何都需要 JSON，为什么不直接使用 JS。另外我真的更喜欢 JS 而不是 PHP。整个事情应该是一个小挑战，从来没有做过这样的事情。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:20:05.737

我建议不要为新的“用户提交”页面生成代码控制器/操作。

我建议使用单个控制器来呈现/创建任何“用户提交的”页面。

例如，网址可能如下所示：

`News --> www.foo.com/custom/render/news`

# sql - '不包含数字'的SQL，可能吗？

> ID：11036024
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:10.250
> 
> 标签：sql, teradata

我有一个满是行的表，每一行都有一个状态和一个序列 ID（还有一堆在这里不重要的超级机密的东西）。status 是一个字符串，表示记录的当前状态，或者是一个 id 号，表示它是具有该序列号的父级的子级，父级将包含树的状态。基本上，我们的表包含树，其中父母持有状态信息，所有孩子都包含向上的指针。（我知道它的设计很糟糕，但它是遗留的，还不值得改变。）

首先，我需要的是我们所有家庭的所有状态及其序列 ID 的列表。所以我需要类似的东西

```
SELECT UNIQUE status, seq_id FROM top_secret_database.government_secrets_table 
WHERE status <does not contain numerics> 
```

有谁知道在sql中完成这个的方法？

我可以

```
SELECT UNIQUE status, seq_id FROM top_secret_database.government_secrets_table 
WHERE status NOT IN (
    SELECT UNIQUE seq_id FROM top_secret_database.government_secrets_table
) 
```

但在这一点上，我只是好奇是否有任何方法可以在任何人都知道的 sql 中获取任何正则表达式，如“非数字”，因为这样做会很有用。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:13:26.040

如果您知道数字状态 ID 的可接受范围，则可以使用 Teradata 本机`CHAR2HEXINT()`函数来确定列的第一个字符是字符还是数字。

```
SELECT CHAR2HEXINT('A')
     , CHAR2HEXINT('Z')
     , CHAR2HEXINT('0')
     , CHAR2HEXINT('1')
     , CHAR2HEXINT('9')
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:09:34.303

你没有说你使用的是哪个 sql server，所以我假设[MySQL](http://dev.mysql.com/doc/refman/5.1/en/regexp.html#operator_regexp)：

```
SELECT ...
WHERE status NOT REGEXP '[0-9]' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:10:00.387

如果状态是不包含数字的字符串，或者是完全数字的 Id，则可以使用（至少在 TSQL 中）[ISNUMERIC](http://msdn.microsoft.com/en-us/library/ms186272.aspx)函数进行过滤。

# image - 所有数据的数据网格快照

> ID：11036026
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:13.667
> 
> 标签：image, actionscript-3, apache-flex, flex4, flash-builder

我正在寻找一种方法来拍摄所有数据网格内容的快照，以包括超出屏幕底部的数据（即需要向下滚动 DG 以查看更多数据）。

获取当前显示数据的快照非常简单：

```
ImageSnapshot.defaultEncoder = PNGEncoder;
var snap:ImageSnapshot = ImageSnapshot.captureImage(myDG);
var imageBytes:ByteArray = snap.data; 
```

我想出的唯一可能的解决方案是拍摄快照，检查数据网格是否可以滚动，滚动到下一个位置，拍摄另一个快照，第二个快照到第一个快照，重复直到数据网格结束。

该解决方案的问题是每个新快照都会显示标题。此外，最后一个快照很可能包含来自前一个图像的数据网格数据。

有没有人对如何做到这一点有任何其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:20:12.227

> 我正在寻找一种方法来拍摄所有数据网格内容的快照，以包括超出屏幕底部的数据（即需要向下滚动 DG 以查看更多数据）。

在基于 Flex 的列表类（包括 DataGrid）中，数据不会超出屏幕底部。dataProvider 中的每个项目都使用 itemRenderer 显示。itemRenderer 只会为显示的可视组件的数量创建，而不是为 dataProvider 中的每个项目创建。

当您滚动列表时，每个 itemRenderer 的 data 属性都会更改；从而改变显示。滚动实际上只是数据的模拟变化。我称整个过程渲染器回收。

如果要创建显示所有数据的 DataGrid 快照，则必须创建和呈现所有数据。在 MX DataGrid 中，您可以通过调整高度来做到这一点，以便所有项目都可见。在大多数 spark 布局中，有一个属性 useVirtualLayout 可以控制它。不过，我不知道它是否可以在 Spark DataGrid 中禁用。

# php - php到javascript代码

> ID：11036029
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:30.953
> 
> 标签：php, javascript

我需要帮助将此代码转换为 javascript。

```
<?php

$string = '7 Genesis 16:23';

if (preg_match('/^(.*?)\s+(\d+):(\d+)$/', $string, $match)) {
echo "You selected book {$match[1]}, chapter {$match[2]}, verse {$match[3]}!";
} else {
echo "I couldn't understand your input.  Please use 'Book chapter:verse' format.";
} 
```

这是我们以彼得一书 1:1 的形式将给定的经文分成 3 部分

```
[0] = 1 Peter
[1] = 1
[2] = 1 
```

代表书在圣经中的章节诗句

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:08:14.323

利用[`match`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)

```
"7 Genesis 16:23".match(/^(.*?)\s+(\d+):(\d+)$/)
Output: ["7 Genesis 16:23", "7 Genesis", "16", "23"] 
```

# iphone - removeTarget leftBarButtonItem 的问题 - 可能没有响应

> ID：11036034
> 
> 赞同：0
> 
> 时间：2012-06-14T15:06:51.627
> 
> 标签：iphone, uinavigationcontroller, uinavigationbar, uinavigationitem

我正在尝试为 leftBarButtonItem 交换操作

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    UIBarButtonItem *theButton = self.navigationItem.leftBarButtonItem;

    // 'UIBarButtonItem' may not respond to 'removeTarget:action:forControlEvents:'
    [theButton removeTarget:self action:@selector(revealToggle:)          forControlEvents:UIControlEventTouchUpInside];

    // 'UIBarButtonItem' may not respond to 'removeTarget:action:forControlEvents:'
    [theButton addTarget:self    action:@selector(closeToggle:) forControlEvents:UIControlEventTouchUpInside];

    // BUT THIS DOES WORK
    [theButton.target performSelector:theButton.action];

} 
```

根据我读过的内容，它应该可以工作-我做错了什么？

实际上，这是解决我不理解的更复杂的事情。

我想从 UINavigation Controller 中的当前 UIViewController 发送一条消息。

UINavigationController 有这个按钮

```
 self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"btnmenu.png"] style:UIBarButtonItemStylePlain target:self.navigationController.parentViewController action:@selector(revealToggle:)]; 
```

效果很好。我真正要做的是

```
[self.navigationController.parentViewController closeToggle]; 
```

从 didSelectRowAtIndexPath 函数中失败，但我设法用 [theButton.target performSelector:theButton.action] 实现了相同的效果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:50:09.893

正如我在评论中所说，`UIBarButtonItem`不继承`UIControl`方法，因此您对`addTarget`and的警告`removeTarget`。相反，您所做的是直接分配一个新的`UIBarButtonItem`：

```
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"btnmenu.png"] style:UIBarButtonItemStylePlain
                     target:self.navigationController.parentViewController action:@selector(clearToggle)]; 
```

此外，请注意您为目标`UIBarButtonItem` **closeToggle:**定义的选择器的不同之处。但是你说你想做的是向**closeToggle**的父控制器发送一条消息。那里的冒号与预期参数完全不同。`closeToggle:`如果您的方法是，则执行操作`closeToggle`将导致崩溃，反之亦然。

```
-(void)closeToggle:(id)sender // your UIBarButtonItem action.
-(void)closeToggle            // which is, [self.navigationController.parentViewController closeToggle]; 
```

决定你想要什么方法，然后按照上面的新签名`UIBarButtonItem`。

希望这可以帮助。

# asp.net - 针对不同场景配置 web.config

> ID：11036035
> 
> 赞同：1
> 
> 时间：2012-06-14T15:06:54.010
> 
> 标签：asp.net, web-config, settings

我有几个项目，我们有 3-5 个不同的 web.config.xxx 应该满足不同的场景，开发者计算机、构建服务器、测试服务器、生产服务器、生产内部、生产外部。xxx 只是描述它所属环境的标记。

这些 web.config 大多相同，连接字符串、集成点、邮件服务器等内容不同，但结构或多或少相同。因此，如果我在 web.config 中添加一个值，我必须将它写到几个文件中，如果我更改该值，我必须在解决方案中的所有 web.configs 中更改它......这很容易我想我以后会这样做，我可能会更改名称，我不确定这是否正确.. 所以我们有时在生产时会错过价值观，这很尴尬。问题是，这是一个应该很容易消除的问题。

如何处理这种情况？我开始研究可以检查构建配置并进行一些简单替换的“预构建事件”，如果我在调试中构建，请将 {db} 更改为 DevDB。如果我为构建服务器构建，我可以进行构建配置并为该环境进行合适的替换。

有没有首选的处理方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:23:22.257

听起来您将从配置转换中受益。

> 部署网站时，您通常希望已部署应用程序的 Web.config 文件中的某些设置与开发 Web.config 文件不同。例如，您可能想要禁用调试选项并更改连接字符串，以便它们指向不同的数据库。

下面的源代码说明了如何配置在部署期间自动应用的 web.config 转换文件，以便对 web.config 进行更改。

来源：[如何：在部署 Web 应用程序项目时转换 Web.config](http://msdn.microsoft.com/en-us/library/dd465318.aspx)

注意：此技术可以应用于任意数量的部署（Staging、Testing、Production、Foo、Bar 等）。

通常，在一个项目中，您将有 1 个 web.config 文件。与此相关的是，您可能有 web.production.config、web.staging.config 等。每个 web.*.config 文件都是一个转换，其中包含一些用于修改 web.config 中各种值的语言，比如连接字符串。这些转换文件中的每一个都与您通常在部署期间选择的部署选项相关联（Visual Studio 顶部的小下拉菜单，通常设置为“调试”）。

# javascript - 如何在网页上的鼠标单击或鼠标悬停时播放音频文件的一部分？

> ID：11036036
> 
> 赞同：2
> 
> 时间：2012-06-14T15:06:55.117
> 
> 标签：javascript, html, html5-audio

我正在创建一个网站来教一些阿拉伯语单词。我包括数字、序数、星期几等，我有一个包含所有这些的音频文件，我想用鼠标悬停或单击鼠标来播放它。现在，我不想将音频切割成许多片段来完成这项工作。有没有办法在鼠标单击或鼠标悬停时调用音频文件并且只播放部分文件？例如，我有一个数字从 1 到 10 的音频文件，假设每个都是一秒长。当用户单击数字 5 时，我希望能够调用数字音频文件并播放第 5 秒并停止。这可能吗？以下是我调用和播放整个音频的代码。谢谢！

```
<!DOCTYPE html>
<html>
<head>
    <title>Arabic Letters</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

<script language="javascript" type="text/javascript">
 function playSound(soundfile) {
 document.getElementById("dummy").innerHTML=
 "<embed src=\""+soundfile+"\" hidden=\"true\" autostart=\"true\" loop=\"false\" />";
 }
 </script>

</head>

<body>
     <span id="dummy"></span> 

<a href="#" onclick="playSound('1-001_page3.mp3');"><p dir="rtl" lang="ar"
class="letter">واحِد</p></a>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:04:54.220

我会使用一个全局变量来设置当前的停止点并绑定一个`timeupdate`监听器来检查是否到了时间：

```
var endTime = 0;
// do this binding once at page load time
myaudio.addEventListener("timeupdate", function() {
    if(this.currentTime >= endTime) {
        this.pause();
    }
}); 
```

对于每个事件，使用 设置开始时间`myaudio.currentTime`、使用 结束时间`endTime`和`play()`音频：

```
// plays the audioObj from start to stop times (in seconds)
// call this for each snippet you wish to play (e.g., in an onclick handler)
function playInterval (audioObj, start, stop) {
    audioObj.currentTime = start*1000;
    endTime = stop*1000;
    audio.play();
} 
```

# android - 如何在 Android.mk 中使用 makefile 语法

> ID：11036040
> 
> 赞同：0
> 
> 时间：2012-06-14T15:07:06.490
> 
> 标签：android, makefile

我想在 Android.mk 中使用**makefile**语法。因为我想生成一个特殊的 bin 文件。但我不知道该怎么做。我尝试了几种方法，但没有一种奏效。有人知道吗？谢谢。

现在，我的实现是：

```
include $(CLEAR_VARS)
INTERNAL_OBMRES_FILES := $(TOPDIR)frameworks/base/core/res/assets/images/android-logo-mask.png \
    $(TOPDIR)frameworks/base/core/res/assets/images/android-logo-shine.png

LOCAL_MODULE := obmRes.bin
LOCAL_MODULE_TAGS := optional
LOCAL_REQUIRED_MODULES := $(RGB2565)
BUILT_OBMRES_TARGET := $(PRODUCT_OUT)/obmRes.bin

obmRes.bin:$(BUILT_OBMRES_TARGET)
$(BUILT_OBMRES_TARGET): $(INTERNAL_OBMRES_FILES)
        $(hide) convert $(TOPDIR)frameworks/base/core/res/assets/images/android-logo-mask.png $(TOPDIR)frameworks/base/core/res/assets/images/android-logo-shine.png -compose dstover -size 256x64 -composite -depth 8 rgb:$(PRODUCT_OUT)/temp.bin
        $(hide) $(RGB2565) < $(PRODUCT_OUT)/temp.bin > $@
        $(hide) rm -f $(PRODUCT_OUT)/temp.bin

include $(BUILD_PHONY_PACKAGE) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:26:46.687

您想在编译时为您的 Android 项目组合两个 PNG，对吗？为什么要为此使用 NDK？为主机编写一个程序（您可以使用 Cygwin 和 GCC 与 ImageMagick），运行它，然后将生成的 PNG 放入项目中。不需要在 NDK 中这样做。

NDK（或任何其他 makefile）中的 Makefile 是您运行的，而不是用户运行的。makefile 中所做的一切都是在您发布应用程序之前完成的。

现在，如果您希望用户进行 PNG 组合，那么您不需要“特殊 bin”。您只需要一个常规的 NDK 项目，它会生成一个库 (.SO)，您的 Android 应用程序将调用该库 (.SO)，并将文件名作为参数传递。该应用程序一旦构建并发布它，就不会在其中包含生成文件 - 只是一个已编译的库。

从 OP 的问题编辑中编辑：不要在 Android NDK 上浪费时间。只需在 Cygwin（或 *nix shell）下运行相关命令。

# php - 在 MySQL 查询中合并多行

> ID：11036042
> 
> 赞同：1
> 
> 时间：2012-06-14T15:07:10.157
> 
> 标签：php, mysql

所以我有 2 张桌子、发票和发票项目。我想创建一个查询，将两者组合成一个报表的表。我遇到的问题是我的查询仅从 tblinvoiceitems 返回第一行，而不是所有适用的。请参阅下面的代码。谢谢！

以下是表格：

```
invoices
+------+----------+-------------+-------------+------------+----------+-------+---------+
|  id  |  userid  |   duedate   |  datepaid   |  subtotal  |  credit  |  tax  |  total  |
+------+----------+-------------+-------------+------------+----------+-------+---------+
| 662  | 436      | 2012-07-01  | 2012-06-05  | 1290.00    | 0.00     | 0.00  | 1290.00 |
+------+----------+-------------+-------------+------------+----------+-------+---------+
| 668  | 441      | 2012-07-01  | 2012-06-11  | 1290.00    | 0.00     | 0.00  | 1290.00 |
+------+----------+-------------+-------------+------------+----------+-------+---------+

invoiceitems
+------+-------------+----------+----------+---------+-----------------+----------+
|  id  |  invoiceid  |  userid  |   type   |  relid  |   description   |  amount  |
+------+-------------+----------+----------+---------+-----------------+----------+
| 1408 | 662         | 436      | Promo    | 436     | Setup Fee       | 295.00   |
+------+-------------+----------+----------+---------+-----------------+----------+
| 1409 | 662         | 436      |          | 0       | US Standard     | 995.00   |
+------+-------------+----------+----------+---------+-----------------+----------+
| 1425 | 668         | 441      | Promo    | 441     | Setup Fee       | 295.00   |
+------+-------------+----------+----------+---------+-----------------+----------+
| 1426 | 668         | 441      |          | 0       | US Standard     | 995.00   |
+------+-------------+----------+----------+---------+-----------------+----------+ 
```

我想要的表：

```
newtable
+------+----------+-------------+-------------+-------------+---------+-----------+------------+
|  id  |  userid  |  invoiceid  |   duedate   |  datepaid   |  setup  |  hosting  |  subtotal  |
+------+----------+-------------+-------------+-------------+---------+-----------+------------+
| 1    | 436      | 662         | 2012-07-01  | 2012-06-05  | 295.00  | 995.00    | 1290.00    |
+------+----------+-------------+-------------+-------------+---------+-----------+------------+
| 2    | 441      | 668         | 2012-07-01  | 2012-06-11  | 295.00  | 995.00    | 1290.00    |
+------+----------+-------------+-------------+-------------+---------+-----------+------------+ 
```

当前查询：

```
"INSERT INTO newtable SELECT
tblinvoices.id,
tblinvoices.userid,
tblinvoices.duedate,
tblinvoices.datepaid,
tblinvoices.subtotal,
tblinvoiceitems.invoiceid,
tblinvoiceitems.amount
FROM tblinvoices
INNER JOIN tblinvoiceitems ON tblinvoices.id = tblinvoiceitems.invoiceid"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:17:11.010

使用不同的 2 个 LEFT JOIN 和 WHERE 子句的组合。

```
SELECT DISTINCT <***>
LEFT JOIN invoiceitems ii0 ON ii0.id=i.invoiceid
LEFT JOIN invoiceitems ii1 ON ii1.id=i.invoiceid
WHERE ii0.description = 'Setup Fee'
  ANN ii1.description = 'US Standard' 
```

此外，您最好创建单独的描述表和 descriptionInvoiceItemRelation 表。

[http://en.wikipedia.org/wiki/Database_normalization](http://en.wikipedia.org/wiki/Database_normalization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:18:31.860

你可以试试：

```
SELECT 
  i.id AS InvoiceID, i.userid, ii.invoiceid, i.duedate, 
  i.datepaid, i.setup, i.hosting, i.subtotal
FROM
  invoices i 
INNER JOIN 
  invoiceitems ii ON i.id = ii.id 
```

# php - 如何使用 PHP 在 Joomla 2.5 中检查菜单项是否有子项

> ID：11036043
> 
> 赞同：0
> 
> 时间：2012-06-14T15:07:11.983
> 
> 标签：php, joomla

我需要检查活动菜单在 Joomla 2.5 中是否有子项

编辑：我有一些思考错误：我不想检查活动菜单是否有子菜单，我需要确定*子菜单是否显示*。计算子项的想法不起作用，因为如果子项处于活动状态，它可能没有子项，但仍会显示子菜单。

我试过这样的事情：

```
 if ($this->countModules('submenu')) $showSubmenu= true;
       else $showSubmenu = false;` 
```

但这不起作用，因为该模块在所有页面上都处于活动状态，即使它是空的。

如果有子菜单，是否有一种优雅的方式来获取布尔值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:14:04.477

Havent 在 2.5 中使用，但早期版本有“countMenuChildren”。从[Joomla1.6 Docs](http://docs.joomla.org/JDocumentHTML/1.6)有一个起点，可以查看它在 J2.5 中可能被调用或实现的内容。

# r - 有替换的数据子集

> ID：11036050
> 
> 赞同：2
> 
> 时间：2012-06-14T15:07:32.673
> 
> 标签：r

我正在尝试从具有替换的数据中采样一个子集，这里我展示了一个简单的示例，如下所示：

```
dat <- data.frame (
  group = c(1,1,2,2,2,3,3,4,4,4,4,5,5), 
  var = c(0.1,0.0,0.3,0.4,0.8,0.5,0.2,0.3,0.7,0.9,0.2,0.4,0.6)
) 
```

我只想根据组号对一个子集进行采样。如果选择了组，例如 group = 1，则将选择整个组（在我上面的简单示例中为两个组成员）。如果该组被多次选择，组号将被更改为一个新组，例如，1.1、1.1、1.2、1.2、...。新数据可能如下所示：

```
newdat <- data.frame (
  group = c(3,3,5,5,3.1,3.1,1,1,3.2,3.2,5.1,5.1,3.3,3.3,2,2,2), 
  var = c(0.5,0.2,0.4,0.6,0.5,0.2,0.1,0.0,0.5,0.2,0.4,0.6,0.5,0.2,0.3,0.4,0.8)
) 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:20:58.780

这是一个相当简单的解决方案，用于`make.unique()`在 中创建组的名称`newdat`：

```
## Your data
dat <- data.frame (
  group = c(1,1,2,2,2,3,3,4,4,4,4,5,5), 
  var = c(0.1,0.0,0.3,0.4,0.8,0.5,0.2,0.3,0.7,0.9,0.2,0.4,0.6)
) 
n <- c(3,5,3,1,3,2,5,3,2)

## Make a 'look-up' data frame that associates sampled groups with new names,
## then use merge to create `newdat`
df <- data.frame(group = n, 
                 newgroup = as.numeric(make.unique(as.character(n))))
newdat <- merge(df, dat)[-1]
names(newdat)[1] <- "group" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:22:46.093

选择`n`你喜欢的：

```
n <- 5 
```

然后运行它（或从中创建一个函数）：

```
lvls <- unique(dat$group)
gp.orig <- gp.samp <- sample( lvls, n, replace=TRUE ) #this is the actual sampling
library(taRifx)
res <- stack.list(lapply( gp.samp, function(i) dat[dat$group==i,] ))
# Now make your pretty group names
while(any(duplicated(gp.samp))) {
  gp.samp[duplicated(gp.samp)] <- gp.samp[duplicated(gp.samp)] + .1
}
# Replace group with pretty group names (a simple merge doesn't work here because the groups are not unique)
gp.df <- as.data.frame(table(dat$group))
names(gp.df) <- c("group","n")
gp.samp.df <- merge(data.frame(group=gp.orig,pretty=gp.samp,order=seq(length(gp.orig))), gp.df )
gp.samp.df <- sort(gp.samp.df, f=~order)
res$pretty <- with( gp.samp.df, rep(pretty,n))

   group var pretty
6      3 0.5    3.0
7      3 0.2    3.0
12     5 0.4    5.0
13     5 0.6    5.0
61     3 0.5    3.1
71     3 0.2    3.1
62     3 0.5    3.2
72     3 0.2    3.2
3      2 0.3    2.0
4      2 0.4    2.0
5      2 0.8    2.0 
```

应该很一般。如果您想要超过 10 个组，则必须使用基于文本的方法来计算“漂亮”版本，因为它是基于数字的，所以这将覆盖。例如，第 11 组 3 将计算为`3+10*.1=4`！

# android - Android 接听未接电话

> ID：11036055
> 
> 赞同：3
> 
> 时间：2012-06-14T15:07:55.850
> 
> 标签：android

所以我想获得未接来电的计数，例如通知栏中显示的电话应用程序

所以我想出了这段代码：

```
String[] projection = { CallLog.Calls.CACHED_NAME, CallLog.Calls.CACHED_NUMBER_LABEL, CallLog.Calls.TYPE };
String where = CallLog.Calls.TYPE+"="+CallLog.Calls.MISSED_TYPE;          
Cursor c = this.getContentResolver().query(CallLog.Calls.CONTENT_URI,projection,where, null, null);
c.moveToFirst();    
Log.d("CALL", ""+c.getCount()); //do some other operation

if(c.getCount() > 0)//...etc etc
    Toast.makeText(app.this,String.valueOf(c.getCount()), Toast.LENGTH_LONG).show(); 
```

这段代码给了我未接来电的总数，但我只想要通知栏中显示的最新来电

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:16:11.870

CallLog.Calls 也有 IS_READ 和 NEW 字段。

我相信你应该添加到你的 where 字符串 - IS_READ = 0 。

请注意，IS_READ 来自 API 级别 14，NEW 来自 API 级别 1，所以我会检查它们。

[http://developer.android.com/reference/android/provider/CallLog.Calls.html#IS_READ](http://developer.android.com/reference/android/provider/CallLog.Calls.html#IS_READ)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-08T13:03:59.150

```
String PATH = "content://call_log/calls";

String[] projection = new String[] { CallLog.Calls.CACHED_NAME,
                CallLog.Calls.NUMBER, CallLog.Calls.DATE, CallLog.Calls.TYPE };

String sortOrder = CallLog.Calls.DATE + " DESC";

StringBuffer sb = new StringBuffer();
sb.append(CallLog.Calls.TYPE).append("=?").append(" and ").append(CallLog.Calls.IS_READ).append("=?");

Cursor cursor = context.getContentResolver().query(
                Uri.parse(PATH),
                projection,
                sb.toString(),
                new String[] { String.valueOf(Calls.MISSED_TYPE), "0" },sortOrder); 
```

[https://play.google.com/store/apps/details?id=com.meaning36.msreminder](https://play.google.com/store/apps/details?id=com.meaning36.msreminder)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-15T21:40:27.007

gc hong 发布的代码如何显示最新的未接电话？它的工作非常正确，但它是如何做到的。

```
String PATH = "content://call_log/calls";

String[] projection = new String[] { CallLog.Calls.CACHED_NAME,
            CallLog.Calls.NUMBER, CallLog.Calls.DATE, CallLog.Calls.TYPE };

String sortOrder = CallLog.Calls.DATE + " DESC";

StringBuffer sb = new StringBuffer();
 sb.append(CallLog.Calls.TYPE).append("=?").append(" and 
").append(CallLog.Calls.IS_READ).append("=?");

Cursor cursor = context.getContentResolver().query(
            Uri.parse(PATH),
            projection,
            sb.toString(),
            new String[] { String.valueOf(Calls.MISSED_TYPE), "0" 
},sortOrder); 
```

# ruby-on-rails - NoMethodError：rspec 测试中未定义的方法“上下文”

> ID：11036058
> 
> 赞同：3
> 
> 时间：2012-06-14T15:08:06.477
> 
> 标签：ruby-on-rails, rspec

系统：rails 3.2.3

1.9.2p320

Ubuntu 12.04 32 位

我正在尝试将我的 rspec 测试拆分为不同路由到配置文件页面的上下文，但 rspec 不喜欢上下文。我是 Rails 和 Rspec 的新手，希望能得到一些帮助。

宝石文件：

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'
gem 'mysql2'
gem 'will_paginate', '3.0.3'
gem 'composite_primary_keys'
gem "nifty-generators", :group => :development

# Gems used only for assets and not required
# in production environments by default.
group :assets do
 gem 'sass-rails',   '~> 3.2.3'
 gem 'coffee-rails', '~> 3.2.1'

 gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'
gem 'devise'
gem "devise_openid_authenticatable"
gem 'savon'

# To use debugger
gem 'ruby-debug-base19'
gem 'ruby-debug19', :require => 'ruby-debug'
gem 'ruby-debug-ide19'

group :development, :test do
 # Read our readme for detail on our test environment.
 gem 'rspec-rails'
 gem 'capybara'
 gem 'launchy'
 gem 'spork', '~> 0.9.0.rc'
 gem 'guard'
 gem 'guard-rspec'
 gem 'syntax'
 gem "mocha"
 gem 'factory_girl_rails'
 gem 'faker'

# Guard-spork doesn't work with windows but it's
# awesome for other Operating System's.
gem 'guard-spork'

# Gnome notifications
gem 'libnotify'

end 
```

代码：需要'spec_helper'

```
describe "qm profile page" do    
 it "shows personalized header text for the profile route" do    
  user = login_user
  context "when using profile route" do
   get path "/profile"
   assert_select("html:root>head>title", "#{user.username}\'s Profile")
   assert_select("h1", "#{user.username}\'s QM Profile")
   end
  user.destroy
 end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:20:07.313

你不能有一个`context`内部`it`块。

# xml - matching a dynamic xslt template

> ID：11036059
> 
> 赞同：0
> 
> 时间：2012-06-14T15:08:07.147
> 
> 标签：xml, xslt, matching

OK so I have an xslt issue that I cannot seem to solve. This is my second attempt at asking the question please do not mark as duplicate.

My issue is that I would like to include some HTML after the fourth `<p>` tag in my document. The issue is that there can be `<p>` tags with the attribute `class="exclude"`

If the `<p>` tag has that class, I would like to not render that paragraph. At the same time, I would still like to render my included html after the 4th paragraph, regardless of the number of `<p class="excludes"` there are

EDIT:: Here is the xsl I had previously. This would slot my included html into the 4th paragraph.

```
<xsl:template match="content/p[position() = 4]">
     content include<xsl:apply-templates /></p>
</xsl:template> 
```

Here are some example inputs / outputs

First is the base example where there are no `<p class="excludes">` My input is:

```
<body>
<p></p>
<p></p>
<p></p>
<p></p>
include new HTML here
<p></p>
...
</body> 
```

In that example, the html renders nicely after the 4th paragraph after passing through my xslt.

However, I need to take into account `<p class="exclude">`

Here is a more complicated example with `<p class="exclude" being used >`

```
<body>
<p class="exclude"></p> (should not be rendering on page)
<p></p>
<p></p>
<p></p>
<p></p>
include new HTML here
<p></p>
...
</body> 
```

Notice that in this example, the included HTML is appearing after the 5th* paragraph because the first paragraph should not be rendering on the page, but at the same time I want the rendered HTML to be included after the 4th rendered paragraph. Lets look at one more example that is more complicated.

```
<body>
<p class="exclude"></p> (this should not be rendering on page)
<p></p>
<p class="exclude"></p> (this should not be rendering on page)
<p class="exclude"></p> ...
<p></p>
<p class="exclude"></p> ...
<p></p>
<p class="exclude"></p> ...
<p class="exclude"></p> ...
<p class="exclude"></p> ...
<p></p>
new HTML include here
<p></p>
...
<body>
<p class="exclude"></p> 
```

Now, in my final example you can see that multiple `<p class="excludes"` have been added and yes i still want the new html content to render after the 4th rendered paragraph, or in this example the 11th total over all paragraph.

If anyone has any xslt that could help me achieve this that would be great. Please keep in mind I am using xslt 1.0 Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:11:57.273

Here's another XSLT 1.0 stylesheet option.

In this one I tried to take into account the "normal processing" of the `p` elements that was mentioned in the comments.

In the example, I'm adding a processing instruction just to show that a `p` was processed. This can be replaced or removed depending on what you're doing in your XSLT.

**XML Input**

```
<body>
    <p class="exclude">delete1</p>
    <p>keep1</p>
    <p class="exclude">delete2</p>
    <p class="exclude">delete3</p>
    <p>keep2</p>
    <p class="exclude">delete4</p>
    <p>keep3</p>
    <p class="exclude">delete5</p>
    <p class="exclude">delete6</p>
    <p class="exclude">delete7</p>
    <p>keep4</p>
    <p>keep5</p>
    <p class="exclude">delete8</p>
</body> 
```

**XSLT 1.0** (Tested with Xalan and Saxon 6.5.5)

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <!--Strip p if class attribute value is exclude.-->
    <xsl:template match="p[@class='exclude']"/>

    <!--Special handling of the 4th non-exclude p. Call the "normal" template to 
        handle any other p processing and then output the additional HTML.-->
    <xsl:template match="p[not(@class='exclude')][count(preceding::p[not(@class='exclude')])+1=4]">
        <xsl:call-template name="normal"/>      
        <b>ADDITIONAL HTML HERE</b>
    </xsl:template>

    <!--This is the "normal" processing of "p". For the example, just adding a PI.-->
    <xsl:template match="p" name="normal">
        <xsl:copy>
            <xsl:processing-instruction name="processed">normally</xsl:processing-instruction>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>     
    </xsl:template>

</xsl:stylesheet> 
```

**Output**

```
<body>
   <p><?processed normally?>keep1</p>
   <p><?processed normally?>keep2</p>
   <p><?processed normally?>keep3</p>
   <p><?processed normally?>keep4</p>
   <b>ADDITIONAL HTML HERE</b>
   <p><?processed normally?>keep5</p>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:29:46.000

for each p you are processing, check...

```
<xsl:if test="count(preceding::p[not(@class='exclude')])=4">
   render your html here
</xsl:if> 
```

**Edit**:

Addtionally to do with your further question:

```
<xsl:apply-tempates select="p[not(@class='exlude')]"/>

<xsl:template match="p">
   <p>
     <xsl:if test="count(preceding::p[not(@class='exclude')])=4">
      render your html here
   </xsl:if>
   </p>
</xsl:template> 
```

if you don't want all the other p's you can put the count in the match.

**EDIT**:

I have looked at your updated question, and I am not sure how it works, as you have an unbalanced template (you have a closing p but not an opening one?) - I assume this is a typo. Also you say your p is within body, but you are matching on content/p. Where did the content tag come from.

Anyway, with the corrections, assuming your original template was:

```
<xsl:template match="content/p[position() = 4]">
    <p>content include<xsl:apply-templates /></p> 
</xsl:template> 
```

and it worked, just change it to

just change it to be

```
<xsl:template match="p[count(preceding::p[not(@class='exclude')])=4]">
    <p>content include<xsl:apply-templates /></p> 
</xsl:template> 
```

that would give you the right thing

# c# - 在没有包管理器控制台的情况下安装 C# 库

> ID：11036060
> 
> 赞同：1
> 
> 时间：2012-06-14T15:08:08.893
> 
> 标签：c#, facebook-c#-sdk, visual-studio-express, package-managers

除了使用包管理器控制台之外，还有其他方法可以安装 C# 库吗？我想使用[Facebook C# SDK](http://nuget.org/packages/Facebook)，但我使用的是 Visual Studio Express for WP，但我没有 PMC。我[在 nuget 上找到了本指南](http://docs.nuget.org/docs/start-here/using-the-package-manager-console)，但我将不得不以其他方式进行操作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T12:43:11.613

README.md 文件中提到了如何在`.dll`不使用 NuGet 包管理器控制台的情况下下载 Facebook C# SDK 文件，网址为[https://github.com/facebook-csharp-sdk/facebook-csharp-sdk](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk)

> Facebook C# SDK 的二进制文件仅通过 nuget 分发。对于那些使用不支持 NuGet 包管理器的旧版 Visual Studio 的用户，请下载 NuGet.exe 的命令行版本 ( [http://nuget.codeplex.com/releases/view/58939](http://nuget.codeplex.com/releases/view/58939) ) 并运行以下命令。
> 
> ```
> nuget install Facebook 
> ```
> 
> 如果您想获得旧版本的二进制文件，请使用以下命令。
> 
> ```
> nuget install Facebook -v 5.4.1 
> ```

[更新：您可以通过导航到http://nuget.org/api/v2/package/Facebook/6.4.0](http://nuget.org/api/v2/package/Facebook/6.4.0)将 .nupkg 重命名为 .zip 并使用您最喜欢的 zip 程序解压缩，直接从浏览器下载版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:14:00.460

有一个替代的开源 IDE sharpDevelop。它可以将包添加到您的项目中。它适用于 Visual Studio 文件！

在最新版本中，该插件甚至独立于 Visual Studio 的插件是否安装！ [SharpDevelop 中的 Nuget](http://community.sharpdevelop.net/blogs/mattward/archive/2011/01/23/NuGetSupportInSharpDevelop.aspx)

PS：与 VS 的插件相比，它确实有一些限制，复杂的包将无法完成他们应该做的所有事情。例如，与 IDE 的交互可能会失败。（因此，如果您使用 SharpDevelop 安装该软件包，则 MVC 3 模型生成将不起作用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:30:00.913

您可以[从 github 获取 Facebook SDK 源代码，](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/)并从您的解决方案中添加对 sdk 项目的引用。

或者只是从 Facebook SDK 解决方案构建库并在您的项目中引用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:28:27.637

VS 2012 有选项，在 Tools->Library Package Manager 下。

# wpf - 在 WPF 中创建动态计算字段

> ID：11036063
> 
> 赞同：0
> 
> 时间：2012-06-14T15:08:17.350
> 
> 标签：wpf, entity-framework, data-binding, ivalueconverter

我正在尝试在我的窗口上创建一系列动态的计算字段。

现在我让它在表单加载如下时工作......

```
<Window.Resources>
    <src:PaymentVarianceConverter x:Key="PaymentConverter" />
</Window.Resources>

<TextBlock Text="{Binding Path=., Converter={StaticResource PaymentConverter}, 
                  ConverterParameter=CASH, StringFormat={}{0:C}, Mode=OneWay}"/>
<TextBlock Text="{Binding Path=., Converter={StaticResource PaymentConverter}, 
                  ConverterParameter=CHECK, StringFormat={}{0:C}, Mode=OneWay}"/> 
```

这是转换器：

```
public sealed class PaymentVarianceConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (!(value is Route))
            return null;
        var route = value as Route;

        switch (parameter.ToString())
        {
            case "CASH":
                return route.CashTotal - route.TotalExpectedCash;
            case "CHECK":
                return route.CheckTotal - route.TotalExpectedCheck;
            default:
                return null;
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException("ConvertBack Not implemented");
    }
} 
```

所有这一切都很好，除了当基础值（即 route.CashTotal）发生变化时它不会刷新。

有什么办法可以让它动态刷新吗？我想避免在我的源对象上创建它们的属性并为它们中的每一个调用 OnPropertyChanged()，因为它们中有很多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:14:26.387

数据绑定需要在绑定值发生变化时得到通知。您必须实施[`INotifiyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged%28v=vs.100%29.aspx)才能做到这一点。（或依赖属性，但这需要代表您做更多的工作。）不幸的是，WPF 没有通灵能力。

# php - 无法激活 SSL 模式

> ID：11036065
> 
> 赞同：2
> 
> 时间：2012-06-14T15:08:49.987
> 
> 标签：php, openssl, lamp, ftps

我一直在尝试使用 PHP 将文件上传到 FTPS 服务器，但是我不断收到 SSL 错误。尝试的两种方法如下：

```
// METHOD 1
$url = 'ftps://username:pwd@ftpserver/filename.txt';
$context = stream_context_create(array('ftp' => array('overwrite' => true)));
$file_put_contents($url, 'FILE CONTENTS', 0, $context);

// METHOD 2
$ftph = ftp_ssl_connect('ftpserver', 21, 10);
ftp_login($ftph, 'username', 'password');
print ftp_pwd($ftph);
ftp_close($ftph); 
```

错误方法一：

> file_put_contents(ftps://...@ftpserver/filename.txt)：无法打开流：无法在第 X 行的 /php/file/directory/index.php 中激活 SSL 模式

错误方法二：

> ftp_login()：SSL/TLS 握手在第 X 行的 /php/file/directory/index.php 中失败

在 PHP 手册中，它指出`ftp_ssl_connect`如果 PHP 没有使用 OpenSSL 编译，则不会存在；PHP 并没有抱怨该函数不存在，而且来自 phpinfo 的所有指标都指向 OpenSSL 已启用。FileZilla 客户端使用默认端口 (21) 连接良好，并且加密：需要显式 FTP over TLS

在 Ubuntu 12.04 上运行 LAMP。

# perl - 主程序与子程序中的代码

> ID：11036066
> 
> 赞同：2
> 
> 时间：2012-06-14T15:08:51.340
> 
> 标签：perl

您如何决定是将代码放在子程序中还是放在 Perl 脚本的主要部分中？

我知道如果你需要重用代码，你会把它放在子程序中，但是如果你不重用怎么办？将子例程放入对代码进行分组并使其更易于阅读是一种好习惯吗？

**示例（主要）：**

```
my ($num_one, $num_two) = 1, 2;
print $num_one + $num_two;
print $num_one - $num_two; 
```

**示例（在子程序中）：**

```
 my ($num_one, $num_two) = 1, 2;
 add($num_one, $num_two);
 subtract($num_one, $num_two);

 sub add {
     my ($num_one, $num_two) = @_;
     return $num_one + $num_two;
 }

 sub subtract {
     my ($num_one, $num_two) = @_;
     return $num_one - $num_two;
 } 
```

我知道这是一个简单的例子，但是对于更复杂的代码（如果 sub add 和 subsubtract 有更多的代码），分组子程序是否有意义？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T16:14:18.143

我想补充一点，使用 subs 添加了一个自我文档的元素。通过创建一个三行子，可以替换

```
my $sum;
my $count;
for (@levels) {
   next if $_ >= 10;
   ++$count;
   $sum += $_;
}

my $avg = $sum / $count; 
```

和

```
my $avg = avg grep $_ >= 10, @levels; 
```

猜测“avg”的作用比一些循环要容易得多，而且您不会错过第二个版本中的过滤器。

顺便说一句，这个 subs 甚至适用于一小段代码，使用 subs 实际上可以减少代码，即使你只调用一次！在这种情况下，减少了两个非空行。

```
sub avg {
   my $acc;
   $acc += $_ for @_;
   return $acc / @_;
} 
```

* * *

PS - 除了初始化代码之外，我避免将代码放在顶层。我将顶级代码放在块中以限制词汇的范围并分离关注点。

```
{
   my ($num_one, $num_two) = (1, 2);
   add($num_one, $num_two);
   subtract($num_one, $num_two);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T15:37:54.450

You've pointed out that code is easier to reuse if it's in a subroutine. I think there are at least three other good reasons for using subroutines.

1.  If your subroutines are well-written (by which I mean that they don't use global variables, they have well-defined return points and they are small - certainly no more than a screen-full of code) then you can work on the code in the subroutine without caring about the rest of the code. And that makes your code easier to maintain.
2.  Well-named subroutines make your code easier to follow. If you main line of execution just calls half a dozen well-named subroutines then it is instantly obvious what your program does.
3.  Code in subroutines is far easier to test than code outside of subroutines. Even better if your subroutines are in a separate library. The test suite can just load the library and try each of the subroutines in turn, checking that it has the correct effect.

These points are obviously all simplifications. But they go some way towards explaining why the vast majority of my code is in subroutines.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T15:42:38.143

是的，即使子例程只被调用一次，将程序分解为子例程也是一种*很好的做法。*因为它提高了可读性。想象一下，你有一个“for”循环或一个“if”语句，其中的代码超过三页或更多......逻辑流程变得更难理解。但是，如果您有子例程（调用其他子例程）-您的主循环或 main if .. 可能很容易放在一页上-更易于阅读，更易于维护。

还要考虑到*今天*该代码只被调用一次，但在 6 个月后您可能会看到需要重用它 - 在这种情况下，您可以简单地解除子例程。

所以是的，如果可能的话，总是使用子程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-14T15:24:36.173

作为一般规则，如果您要多次重复一系列代码，请使用 sub。随着您的脚本或应用程序变得越来越复杂，您将在重构它以实现逻辑组织和可读性方面采取各种措施。提炼，提炼，提炼。:)

# lisp - Lisp 二进制大小

> ID：11036070
> 
> 赞同：14
> 
> 时间：2012-06-14T15:09:08.627
> 
> 标签：lisp, common-lisp

由于我对人工智能很感兴趣，所以我最近决定尝试一下 Lisp。在使用通用 lisp 编译器[sbcl](http://www.sbcl.org/)编译了一个非常[基本的应用程序](http://aichallenge.org/starter_packages/common_lisp_starter_package.zip)后，我注意到生成的二进制文件非常大（大约 43MB）。我对此的原因很感兴趣。这是（常见）lisp 的常见问题吗？这种行为的技术背景是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-14T15:39:02.733

Common Lisp 实现中有几种不同的架构：

*   口译员
*   字节码引擎（CLISP 就是一个例子）
*   通过 C 编译器编译（ECL 就是一个例子）
*   本机代码编译器（SBCL、LispWorks、Clozure CL）

通常解释器和字节码引擎使用最少的内存。因此 CLISP 非常小。SBCL OTOH 生成相对较大的本机代码。

其次，有几种不同的方式来创建**应用程序**：

1.  保存图像
2.  保存优化的图像
3.  编译成 C 代码

加上一些更像是编译为 DLL。

SBCL 基本上做了 1\. 它转储包含数据和代码的内存并包含运行时。因此，您在运行系统中的所有内容（文档、源代码链接、参数列表、符号名称、调试信息、编译器本身……）都将转储到映像+运行时。此外，SBCL 生成的本机代码很大，运行时内存中可能存在大量代码信息，并且 SBCL 包含其所有自己的功能（包括编译器）。

在开发过程中，经常使用此类未优化的应用程序或图像（使用外部运行时）来节省加载代码和数据的时间。我自己使用过大于 100MB 的图像。

例如，LispWorks 做了 1 和 2。它有一个交付过程，您可以在其中有选择地删除内容（如文档、编译器等某些功能、源代码引用等）。这也使用了 tree-shaker，它可以删除未使用的功能。

优化图像也可能意味着以某种压缩方式编写它并在启动时对其进行解压缩。例如，SBCL 允许这样做。

变体 3 过去已完成，但目前未使用（某些专用工具和应用程序除外）。Thinlisp、Stella、CycL……就是这样的交付工具。过去也有此类工具的商业供应商（但这已不复存在，IIRC 的最后所有者是/曾经是 Oracle）。更新：实际上[mocl](https://wukix.com/mocl)是一个最新的 iOS 和 Android 通用 Lisp 应用程序生成器。它采用 Common Lisp 的一个大子集并将其编译为小型的独立移动应用程序。例如，在 iOS 上，它为 Apple 提供的 C 编译器生成紧凑的 C 代码。

# printing - 在 IE9 中绕过打印对话框

> ID：11036074
> 
> 赞同：3
> 
> 时间：2012-06-14T15:09:15.150
> 
> 标签：printing, internet-explorer-9

你好，我正在寻找一种绕过 IE 9 中的 printdialog 的方法。我现在有一些适用于 ie 7/8 的方法，但它们在 ie9 对我不起作用

有人可以给我一个提示吗？

迎接马库斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-27T16:07:16.190

这里成功的关键组合似乎是在 onclick 事件中调用正确的函数（例如 Print() 而不是 window.print() ），以及在 IE9 中配置正确的安全设置（以及任何其他版本的IE）。

但是，如果通过受信任的安全 HTTPS 连接（具有受信任的 SSL 证书而不是自签名 SSL 证书的连接）访问具有打印对话框绕过 ActiveX 控件的页面，则似乎不需要配置安全设置.

如果通过本地文件路径访问页面，它根本不起作用。如果您打算针对无法控制其浏览器的用户，请记住这两点，但是如果确实是这种情况，您可能最好完全使用另一种方法，使用 Java 等技术或要求用户安装本机操作系统优惠券打印网站等使用的软件。

在任何情况下，通过适当的安全设置，IE9 应该允许您使用以下代码绕过打印对话框弹出窗口：

```
<!DOCTYPE html>
<html>
<head>
    <title>Print Test</title>
    <script language="VBScript">
        sub Print()
            OLECMDID_PRINT = 6
            OLECMDEXECOPT_DONTPROMPTUSER = 2
            OLECMDEXECOPT_PROMPTUSER = 1
            call WB.ExecWB(OLECMDID_PRINT, OLECMDEXECOPT_DONTPROMPTUSER,1)
        End Sub
        document.write "<object id='WB' width='0' height='0' classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2'></object>"
    </script>
</head>
<body>
    <object id="WebBrowser1" width="0" height="0" classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"> </object>
    <a href="#" onclick="Print()">Click Here to Print</a>
</body>
</html> 
```

这个确切的代码在 IE7、IE8 和 IE9 中对我有用。我还没有机会使用 IE10，但它也可能在那里工作。如果任何拥有 IE10 的人都可以测试，请务必报告。为获得最佳结果，请记住从托管源运行它，最好是受信任的 HTTPS 源，而不是在本地计算机上运行。

这是我必须在 IE9 中配置的设置才能使上述代码正常工作。同样，它仅在从 Web 提供页面时才有效。它用更少的唠叨工作。如果我尝试直接从本地计算机加载相同的 HTML 文件，即使配置了相同的安全设置，它也不起作用。

粉红色突出显示仅表示配置的此类设置不安全。注意：您也可以选择“提示”，它更唠叨，但被认为有点安全。

![IE9 安全设置](../Images/c4efba8ef04b58c06186c9b9c271253e.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-12T02:32:48.707

我真的只是想发表评论，但由于 IE 已经加速，这应该包括在这里。要获得多平台支持，我将其用于 javascript：

```
 function PrintWindow() {

        var isIE11 = !!navigator.userAgent.match(/Trident.*rv[ :]*11\./);
        if (navigator.appName == "Microsoft Internet Explorer" || isIE11== true) {

            var PrintCommand = '<OBJECT ID="PrintCommandObject" WIDTH=0 HEIGHT=0 ';
            PrintCommand += 'CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"></OBJECT>';
            document.body.insertAdjacentHTML('beforeEnd', PrintCommand);
            PrintCommandObject.ExecWB(6, 2); PrintCommandObject.outerHTML = "";
            window.close();

        }

        else {

              window.print();
        }

      } 
```

现在检查 IE 11。这是为 Microsoft 定义 userAgent 的一种新方法。还有其他关于此的[文章](https://stackoverflow.com/questions/17447373/how-can-i-target-only-internet-explorer-11-with-javascript)。

# android - “不幸的是，myapp 已停止” android 模拟器错误

> ID：11036075
> 
> 赞同：0
> 
> 时间：2012-06-14T15:09:22.543
> 
> 标签：android, android-layout, android-emulator

当我尝试打开通过 Eclipse 在 android 模拟器上安装的应用程序时，我收到错误“不幸的是，myapp 已停止”。这是我的文件

.java文件：

```
@Override
public void onStart() {
    super.onStart();
    try {
        // Initialized SDKs that need to; pass in publisher ids
        Map<SDKAdNetwork, String> publisherIds = new HashMap<SDKAdNetwork, String>();
        publisherIds.put(SDKAdNetwork.GREYSTRIPE, "486417");
        if (medialetsInitialized == false) {
            publisherIds.put(SDKAdNetwork.MEDIALETS,
                    "PutYourIDHere");
        }
        AdMarvelView.initialize(this, publisherIds, handler);

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    // your code
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();

    try {
        // Initialized SDKs that need to; pass in publisher ids
        Map<SDKAdNetwork, String> publisherIds = new HashMap<SDKAdNetwork, String>();
        publisherIds.put(SDKAdNetwork.GREYSTRIPE, "486417");
        publisherIds.put(SDKAdNetwork.MEDIALETS,
                "PutYourIDHere");

        AdMarvelView.pause(this, publisherIds);

        AdMarvelView adMarvelView = (AdMarvelView) findViewById(R.id.ad);
        if (adMarvelView != null) {
            adMarvelView.flush();
        }

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();

    try {
        // Initialized SDKs that need to; pass in publisher ids
        Map<SDKAdNetwork, String> publisherIds = new HashMap<SDKAdNetwork, String>();
        publisherIds.put(SDKAdNetwork.GREYSTRIPE, "486417");
        publisherIds.put(SDKAdNetwork.MEDIALETS,
                "PutYourIDHere");

        AdMarvelView.resume(this, publisherIds);

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

@Override
public void onStop() {
    super.onStop();

    try {
        Map<SDKAdNetwork, String> publisherIds = new HashMap<SDKAdNetwork, String>();
        publisherIds.put(SDKAdNetwork.GREYSTRIPE, "486417");
        if (medialetsInitialized == true) {
            publisherIds.put(SDKAdNetwork.MEDIALETS,
                    "PutYourIDHere");
            medialetsInitialized = false;
        }
        AdMarvelView.uninitialize(this, publisherIds);

    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    // your code
}

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    handler = new AdMarvelInitializedHandler();

    final Button button = (Button) findViewById(R.id.Button01);

    final EditText editText01 = (EditText) findViewById(R.id.EditText01);

    final EditText editText02 = (EditText) findViewById(R.id.EditText02);

    final EditText editText03 = (EditText) findViewById(R.id.EditText03);

    AdMarvelView adMarvelView = (AdMarvelView) findViewById(R.id.ad);
    adMarvelView.setEnableClickRedirect(true);
    adMarvelView.setDisableAnimation(false);
    adMarvelView.setListener(this);
    adMarvelView.setEnableInAppBrowser(true);

    editText01.setText(_partnerId);
    editText02.setText(_siteId);
    editText03.setText(_interstitialSiteId);

    adMarvelInterstitialAds = new AdMarvelInterstitialAds(this, 0,
            0x726D6D, 0x00FF00, 0x000000);

    button.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            try {
                Map<String, String> targetParams = new HashMap<String, String>();
                // targetParams.put("GEOLOCATION", "37.686668,-77.4510549");
                // targetParams.put("POSTAL_CODE", "94131");

                final EditText editText01 = (EditText) findViewById(R.id.EditText01);
                final EditText editText02 = (EditText) findViewById(R.id.EditText02);

                String partnerId = editText01.getText().toString();
                String siteId = editText02.getText().toString();

                AdMarvelView adMarvelView = (AdMarvelView) findViewById(R.id.ad);
                adMarvelView.requestNewAd(targetParams, partnerId, siteId);
            } catch (Exception e) {
                // TODO Auto-generated catch block

                Log.e("admarvel", e.getStackTrace().toString());
            }

        }

    });

    final Button button2 = (Button) findViewById(R.id.Button02);

    button2.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            Map<String, String> targetParams = new HashMap<String, String>();

            targetParams.put("SIZE", "VIDEOPRE");

            final EditText editText01 = (EditText) findViewById(R.id.EditText01);
            final EditText editText03 = (EditText) findViewById(R.id.EditText03);

            String partnerId = editText01.getText().toString();
            String interstitialSiteId = editText03.getText().toString();

            AdMarvelInterstitialAds
                    .setListener(AdMarvelHelloWorldDemo.this);
            AdMarvelHelloWorldDemo.this.adMarvelInterstitialAds
                    .requestNewInterstitialAd(AdMarvelHelloWorldDemo.this,
                            targetParams, partnerId, interstitialSiteId);

        }

    });

}

public void onClickAd(AdMarvelView adMarvelView, String clickUrl) {
    if (clickUrl != null) {
        Log.e("admarvel", "ClickUrl: " + clickUrl);
    }

}

public void onFailedToReceiveAd(AdMarvelView adMarvelView, int errorCode,
        ErrorReason errorReason) {
    Log.e("admarvel", "onFailedToReceiveAd; errorCode: " + errorCode
            + " errorReason: " + errorReason.toString());

}

public void onFailedToReceiveInterstitialAd(SDKAdNetwork sdkAdNetwork,
        String publisherid, int errorCode, ErrorReason errorReason) {

    Log.e("admarvel", "onFailedToReceiveInterstitialAd; errorCode: "
            + errorCode + " errorReason: " + errorReason.toString());

}

public void onReceiveAd(AdMarvelView adMarvelView) {
    Log.e("admarvel", "onReceiveAd");
}

public void onRequestAd(AdMarvelView adMarvelView) {
    Log.e("admarvel", "onRequestAd");

}

public void onRequestInterstitialAd() {
    Log.e("admarvel", "onRequestInterstitialAd");
}

public void onReceiveInterstitialAd(SDKAdNetwork sdkAdNetwork,
        String publisherid, AdMarvelAd adMarvelAd) {
    Log.e("admarvel", "onReceiveInterstitialAd");

    adMarvelInterstitialAds.displayInterstitial(this, sdkAdNetwork,
            publisherid, adMarvelAd);
    if (sdkAdNetwork.equals(SDKAdNetwork.ADMARVEL)) {
        // overridePendingTransition(R.anim.fadein, R.anim.fadeout);
    }
}

public void onCloseInterstitialAd() {
    Log.e("admarvel", "onCloseInterstitialAd");
    if (this.adMarvelActivity != null) {
        this.adMarvelActivity.finish();
    } else if (this.adMarvelVideoActivity != null) {
        this.adMarvelVideoActivity.finish();
    }

}

public void onAdmarvelActivityLaunched(AdMarvelActivity a) {
    Log.e("admarvel", "onAdmarvelActivityLaunched");
    this.adMarvelActivity = a;

}

public void onAdMarvelVideoActivityLaunched(AdMarvelVideoActivity a) {
    Log.e("admarvel", "onAdmarvelVideoActivityLaunched");
    this.adMarvelVideoActivity = a;

}

public void onExpand() {
    Log.e("admarvel", "onExpand");

}

public void onClose() {
    Log.e("admarvel", "onClose");

}

private class AdMarvelInitializedHandler implements
        AdMarvelInitializeListener {

    public void onInitialized(SDKAdNetwork adnetwork) {

        if (adnetwork.equals(SDKAdNetwork.MEDIALETS)) {
            medialetsInitialized = true;
        }

    }

}

    } 
```

这是清单文件

```
 <?xml version="1.0" encoding="utf-8"?>
     <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.admarvel.androidhelloworlddemo" android:versionCode="1"
android:versionName="1.5">

<application android:icon="@drawable/icon" android:label=""
    android:debuggable="true"  android:configChanges="orientation" >
    <activity android:name=".AdMarvelHelloWorldDemo"
        android:label="">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity android:name="com.admarvel.android.ads.AdMarvelActivity"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:configChanges="keyboard|keyboardHidden|orientation"
        >
    </activity>
    <activity android:name="com.admarvel.android.ads.AdMarvelVideoActivity"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
        android:configChanges="keyboard|keyboardHidden|orientation"
        >
    </activity>

    <provider android:name="com.admarvel.android.ads.AdMarvelLocalFileContentProvider"
      android:authorities="com.admarvel.androidhelloworlddemo.AdMarvelLocalFileContentProvider" />

    <!--
        ADMARVEL: If your integrating with Admob, please define this activity
    -->

    <activity android:name="com.google.ads.AdActivity"
          android:configChanges="keyboard|keyboardHidden|orientation"/>

    <!--
        ADMARVEL: If your integrating with Ivdopia, please define this activity
    -->

    <activity android:name="com.vdopia.client.android.VDOActivity"
        android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen"
        android:screenOrientation="landscape" android:configChanges="orientation|keyboardHidden" />

    <!--
        ADMARVEL: If your integrating with Greystripe, please define this
        provider
    -->
    <provider android:name="com.greystripe.android.sdk.AdContentProvider"
        android:authorities="com.admarvel.androidhelloworlddemo.AdContentProvider"
        android:multiprocess="true" android:exported="false" />

    <!--
        ADMARVEL: If your integrating with Medialets, please define this

    -->
    <service android:name="com.medialets.advertising.AdManagerService" />

    <!--
        ADMARVEL: If your integrating with Greystripe, please define this
        activity
    -->
    <activity android:name="com.greystripe.android.sdk.AdView"
        android:configChanges="keyboard|keyboardHidden|orientation">
        <intent-filter>
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <!-- 
        ADMARVEL:  If your integrating with Millennial, please define this
     -->

    <activity android:name="com.millennialmedia.android.MMAdViewOverlayActivity" 
                android:theme="@android:style/Theme.Translucent.NoTitleBar">
    </activity>        
    <activity android:name="com.millennialmedia.android.VideoPlayer" 
                android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
                android:configChanges="keyboardHidden|orientation|keyboard" >
    </activity>

    <!-- 
        ADMARVEL:  If your integrating with Rhythm, please define this
     -->
  <activity android:label="Rhythm Activity"
                        android:theme="@android:style/Theme.Translucent.NoTitleBar"
                        android:configChanges="keyboard|keyboardHidden|orientation"
                        android:name="com.rhythmnewmedia.sdk.RhythmActivity" />
  <activity android:label="Rhythm Video Activity"
                        android:theme="@android:style/Theme.Black.NoTitleBar"
                        android:configChanges="keyboard|keyboardHidden|orientation"
                         android:name="com.rhythmnewmedia.sdk.video.RhythmVideoActivity" />

</application>
<uses-sdk android:minSdkVersion="3" />

<supports-screens android:largeScreens="true"                  
              android:anyDensity="true" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<!-- REQUIRED BY GREYSTRIPE, MEDIALETS, RHYTHM AND MILLENNIAL  -->
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

<!-- REQUIRED BY MEDIALETS -->
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />

    </manifest> 
```

有人可以帮忙吗？

编辑：继承人logcat的链接

[日志文件](https://docs.google.com/document/pub?id=13E3q36C-NuxE39WC9oADv-SdgIeVcrXjSxFMuzIfMOc)

请帮忙！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T20:12:41.057

好像是根据这个消息在找内容提供者，但是找不到（ClassNotFound）

```
Unable to get provider com.greystripe.android.sdk.AdContentProvider 
```

您是否缺少 libs 文件夹中的 jar？

# c++ - 要写入输出迭代器的模板成员函数

> ID：11036076
> 
> 赞同：3
> 
> 时间：2012-06-14T15:09:25.713
> 
> 标签：c++, templates, iterator, virtual, member-functions

我以为我会很聪明，并创建接受输出迭代器的成员函数。这样，我可以避免返回集合或通过引用获取集合。例如：

```
template <typename TOutIterator>
void getHeaderNames(TOutIterator destination);

template <typename TOutIterator>
void getHeaderValues(std::string const& name, TOutIterator destination); 
```

这些函数会将它们的结果写入传入的任何迭代器。这样，我不必担心我是在写入集合、向量还是 ostream。

现在我感觉没那么聪明了。我想让这些函数虚拟化，这样我就可以在测试中删除实现。不幸的是，模板成员函数不能是虚拟的，这是有道理的。

有没有办法让这些函数保持通用（写入任何东西）并允许它们同时是虚拟的？我想避免将所有内容都写入向量只是为了转身并将其写入标准输出或其他内容。

如果我需要更清楚地解释我的情况，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:18:41.063

您可以使用[类型擦除](http://www.artima.com/cppsource/type_erasure.html)来操作多态迭代器，例如[`any_iterator`Thomas Becker 提出的](http://thbecker.net/free_software_utilities/type_erasure_for_cpp_iterators/any_iterator.html)（后来[在 Boost.Range 中实现](http://www.boost.org/doc/libs/release/boost/range/detail/any_iterator.hpp)）。你最终会得到一些类似的东西：

```
typedef any_iterator<
  std::string, // Value
  Writable,    // Access
  Forward,     // Traversal
> StringOutputIterator; // can represent any output iterator accepting strings

virtual void getHeaders(StringOutputIterator destination); 
```

类型擦除的想法是为一组原本不相关的类型（由于使用模板而在 C++ 中经常发生）拥有一个公共基类。例如`std::function`，通过允许以类似方式操作函数指针、仿函数或 lambda，将这个习惯用法应用于可调用对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:20:16.547

保持它们通用的一种方法，我通常在实践中看到这一点，是两个重载流输出运算符（如果有意义的话）或采用`std::ostream&`.

当然，这取决于您的具体情况：您是否正在编写迭代器更有意义的算法？或者只是想转储一个对象的内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-11T08:52:33.510

我遇到了类似的问题，我不想将 Boost 添加到我的项目中......所以我决定根本不使用迭代器。

我最终改用了`std::function`：

```
void getHeaderNames(std::function<void(std::string)> destination);

void getHeaderValues(std::string const& name, std::function<void(std::string)> destination); 
```

然后，`std::back_inserter`我提供了一个执行的 lambda ，而不是`push_back`：

```
std::vector<std::string> v;
getHeaderNames([&](auto name) { v.push_back(std::move(name)); }); 
```

# c# - 如何通过代码优先方法使用数据库迁移和 EF 4.3 创建关系表？

> ID：11036085
> 
> 赞同：3
> 
> 时间：2012-06-14T15:09:46.787
> 
> 标签：c#, asp.net-mvc-4, database-migration, entity-framework-4.3

正如 Scott Gu 在 Tech Days 上介绍的那样，我一直在尝试将 MVC 4.0 与 EF 4.3 和数据库迁移结合使用，并且遇到了在存在多对多关系时创建的数据库的问题。

[http://channel9.msdn.com/Events/TechDays/Techdays-2012-the-Netherlands/2364](http://channel9.msdn.com/Events/TechDays/Techdays-2012-the-Netherlands/2364)开始于 21:14

包括用于生成数据库的代码片段，如下图所示。

```
public class Trip    {
    public int ID { get; set; }
    public string Name { get; set; }
    public DateTime Begin { get; set; }
    public DateTime End { get; set; }
    public Location HomeCountry { get; set; }
    //public IList<Location> Itinerary { get; set; }

    public ICollection<Location> Itinerary { get; set; }

    public Trip()
    {
        this.Itinerary = new HashSet<Location>();
    }
}

public class Location
{
    public int ID { get; set; }
    public string Name { get; set; }

    public ICollection<Trip> Trips { get; set; }

    public Location()
    {
        this.Trips = new HashSet<Trip>();
    }

} 
```

这是生成的数据库。（我会发布图片，但我无法发布图片，仍然是新用户）

```
表
  地点
    PK ID（整数）
       名称（varchar）
       Trip_ID (int)
  旅行
    PK ID（整数）
       名称（varchar）
       开始（日期时间）
       结束（日期时间）
       HomeCountry_ID (int)

```

我想我希望为 Locations 和 Trips 之间的多对多关系创建第三个关系表（许多 Locations 可以应用于许多 Trips），而不是将 Trip_Id 列添加到 Locations 表中。有谁知道我在这里做错了什么？有没有办法让数据库自动化来正确创建这些表？

提前感谢您的所有帮助！

**更新：** 我找到了以下链接，但我仍然无法使用 EF 4.3 让它工作。我还编辑了我的代码片段以反映以下帖子。

[http://www.codeproject.com/Articles/234606/Creating-a-Many-To-Many-Mapping-Using-Code-First](http://www.codeproject.com/Articles/234606/Creating-a-Many-To-Many-Mapping-Using-Code-First)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T15:08:33.263

我终于能够使用我添加到更新问题中的链接正确创建表格，但仍然没有真正出售解决方案。在我的 Db Context 类中，我添加了方法 [protected override void OnModelCreating(DbModelBuilder modelBuilder)]。

```
public class MyTesterContext : DbContext
{
    public MyTesterContext () : base("name=MyTesterContext ")
    {
    }

    public DbSet<Trip> Trips { get; set; }
    public DbSet<Location> Locations { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Trip>().
          HasMany(t => t.Itinerary).
          WithMany(l => l.Trips).
          Map(
           m =>
           {
               m.MapLeftKey("TripID");
               m.MapRightKey("LocationID");
               m.ToTable("TripLocations");
           });
    }

} 
```

新数据库现在如下所示：

```
表
  地点
    PK ID（整数）
       名称（varchar）
  旅行地点
       旅行ID（整数）
       位置 ID（整数）
  旅行
    PK ID（整数）
       名称（varchar）
       开始（日期时间）
       结束（日期时间）
       HomeCountry_ID (int)

```

在代码项目讨论中它说： http:
[//www.codeproject.com/Articles/234606/Creating-a-Many-To-Many-Mapping-Using-Code-First](http://www.codeproject.com/Articles/234606/Creating-a-Many-To-Many-Mapping-Using-Code-First)

> 所以我们对现有的关系表有一个小问题。我们可以通过重写 OnModelCreating 方法并使用 Code First Fluent API 添加映射来解决该问题。

由于我没有现有的关系表，老实说，我不认为这一步是必需的，但我无法找到任何其他方法来创建正确的表结构。希望随着我越来越熟悉这项技术，我可以找到一种方法来绕过需要覆盖 OnModelCreating 方法的需要。

# c# - 通过反射分配给 System.Reflection.Missing 类型的属性会引发异常

> ID：11036086
> 
> 赞同：1
> 
> 时间：2012-06-14T15:09:47.100
> 
> 标签：c#, .net, reflection, properties

我需要通过反射为属性赋值，到目前为止测试的每个案例都可以，除了类型为`System.Reflection.Missing`. 例如这是一个类：

```
public class SomeClass
{
    public System.Reflection.Missing MissingProp { get; set; }
} 
```

这是通过反射分配给属性的代码：

```
var inst = new SomeClass();
var prop = typeof (SomeClass).GetProperty("MissingProp");
prop.SetValue(inst, Missing.Value, null); 
```

这是我收到的例外情况：

```
System.ArgumentException: Missing parameter does not have a default value.
Parameter name: parameters
   at System.Reflection.MethodBase.CheckArguments(Object[] parameters, Binder binder, BindingFlags invokeAttr, CultureInfo culture, Signature sig)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, BindingFlags invokeAttr, Binder binder, Object[] index, CultureInfo culture)
   at System.Reflection.RuntimePropertyInfo.SetValue(Object obj, Object value, Object[] index)
   at ClassesWithNoProperties.Program.Main(String[] args) in D:\Documents\Documents\Visual Studio 2010\Projects\C#\ClassesWithNoProperties\ClassesWithNoProperties\Program.cs:line 24 
```

我已经用太多案例测试了我的库，这些案例使用相同的代码为属性赋值，这是`System.Reflection.Missing`我观察到这种行为的唯一案例 ()。

如何在 C# 中完成这种任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:35:58.990

错误消息是不言自明的 - Missing.Value 只能用作具有可选参数的方法中的占位符。您尝试做的事情是在方法中使用它来使用 PropertyInfo 设置实例的值，这根本没有意义，而且 Missing.Value 知道这一点，因此它会引发异常。

奇怪的是，您可能可以使用 VB.Net 来实现它，因为 VB.Net 支持默认参数。C# 没有。

# c# - 我的搜索按钮不显示数据

> ID：11036089
> 
> 赞同：0
> 
> 时间：2012-06-14T15:09:55.540
> 
> 标签：c#, sql-server-2008

正在使用 VS2010 为诊所构建窗口表单应用程序。在表单上有一个搜索按钮，显示基于 RegistrationNo 的数据。
当我测试应用程序时，提供注册号并单击搜索
按钮没有显示任何内容，也没有显示错误消息。
这是我的代码

```
 string connectionstring = "Data Source=localhost;Initial Catalog=HMS;Persist Security Info=True;User ID=Developer;Password=abc@123";
        SqlConnection connection = new SqlConnection(connectionstring);

        string SelectStatement = "SELECT * FROM MyTable where RegistrationNo = '@RegistraionNo'";
        SqlCommand insertcommand = new SqlCommand(SelectStatement, connection);
        insertcommand.Parameters.AddWithValue("@RegistrationNo", txtsearch.Text);
        SqlDataReader reader;
        try
        {
            connection.Open();
            reader = insertcommand.ExecuteReader();

            while (reader.Read())
            {
                textBox3.Text = reader["RegistratioNo"].ToString();
                textBox1.Text = reader["FirstName"].ToString();
                textBox2.Text = reader["LastName"].ToString();
                genderOption.Text = reader["Sex"].ToString();
                textBox7.Text = reader["Contact"].ToString();
                textBox4.Text = reader["Age"].ToString();
                textBox5.Text = reader["Weight"].ToString();
                textBox6.Text = reader["Weight"].ToString();
                comboBox1.Text = reader["Tribe"].ToString();

            }//end while
            reader.Close();
        }
        catch (SqlException ex)
        {
            throw ex;

        }//end catch
        finally
        {
            connection.Close();
        }// end finally 
```

`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:12:07.660

你有一个错字

注册号而不是注册号

在

```
string SelectStatement = "SELECT * FROM MyTable where RegistrationNo = '@RegistraionNo'"; 
```

另一个在

```
textBox3.Text = reader["RegistratioNo"].ToString(); 
```

您将复制 100 行

> 我要注册，我要注册，我要注册。

# asp.net - ASP WebForms 路由

> ID：11036090
> 
> 赞同：1
> 
> 时间：2012-06-14T15:10:00.270
> 
> 标签：asp.net, .net, routes

我已经设置了一个路由，在`global.asax`其中可以正常工作到单个路由目的地。像 home.aspx

但我实际上想要做的是在定义的路由之后正常路由所有页面

`mysite.com/token/home.aspx?demo=yes`

点击链接到 Contact?target=main 我们去

`mysite.com/token/contact.aspx?target=main`

因为我总是想在所有页面上使用 {token}，但我希望网站像往常一样运行

目前，我单击联系人之类的链接，并且`mysite.com/token/contact.aspx?target=main`在 URL 栏中填充了 URL，但服务器说找不到资源；我假设在服务器级别它的路由到 /home.aspx/contact.aspx?target=main

是否有通配符或设置可以正常路由任何其他..或所有页面到实际请求的页面而不是静态路由 - 但仍然能够将令牌作为路由变量而不是查询上的参数访问?

*为澄清起见，这是 .NET4 上的 ASP WEB 表单，而不是 MVC*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T21:38:43.900

您可以定义通配符路由并使用 BuildManager 返回正确的文件。

例子：

```
public class TokenRoute : Route 
{
    class TokenRouteHandler : IRouteHandler
    {
        #region IRouteHandler Members

        public IHttpHandler GetHttpHandler(RequestContext requestContext)
        {
            var path = Convert.ToString(requestContext.RouteData.Values["path"]);
            if (string.IsNullOrEmpty(path))
            {
                path = "Default.aspx";
            }

            var vPath = "~/" + path;

            HttpContext.Current.Items[RoutingUtil.UrlRoutingVirtualPathKey] = vPath;

            return (IHttpHandler)BuildManager.CreateInstanceFromVirtualPath(vPath, typeof(IHttpHandler));
        }

        #endregion
    }

    public TokenRoute(string token) 
           : base(token + "/{*path}", null, new RouteValueDictionary(), new TokenRouteHandler())
    {
        DataTokens = new RouteValueDictionary { { "token", token } };
    }
} 
```

希望能有所帮助！

# powershell - 无人值守运行时缺少 GPG 输出

> ID：11036092
> 
> 赞同：2
> 
> 时间：2012-06-14T15:10:02.173
> 
> 标签：powershell, gnupg

我正在尝试通过在 powershell 2.0 中调用 gpg2.exe 的计划任务来加密文件

当我登录时，脚本/任务运行良好，无论是通过 ISE 还是通过在 Windows 任务调度程序中运行任务。我在 Windows Server 2008 上，使用的服务帐户不是管理员，但可以访问所有源文件夹和目标文件夹。

当任务在无人值守的情况下运行时，gpg 的输出不会显示在目标目录中，也不会返回任何错误。我已将用户添加到安全策略中，以允许其批量登录。它能够将当前存在的文件（源）写入目标文件夹，而不是 GPG 的输出。

奇怪的是行为不一致，如果我以该系统帐户登录和注销，有时作业会在无人看管的情况下成功运行，直到计划到期，然后在下一个计划中开始出错。

我相当肯定它是围绕会话设置的，因为它在我登录时一直有效，并且仅在某些情况下才有效。任何帮助，将不胜感激。

请参阅以下示例，了解我如何在 powershell 中调用 GPG（是的，我是菜鸟 :)）

$GPG_Prog='C:\Program Files\GNU\GnuPG\gpg2.exe'

$GPG_Encrypt='-e'

$GPG_Encrypt_to='-r XXXXXXXX'

&"$GPG_Prog" -o C:\location\$File.gpg --batch --quiet --yes "$GPG_Encrypt" "$GPG_Encrypt_to" \source location\$File

移动项目 \$File.gpg \network 输出位置

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-20T14:58:46.183

我们在解密时遇到了类似的问题，并发现真正的问题是，密钥默认存储在用户的漫游配置文件中。所以在我们的情况下，它与 DEP 无关，也与权限不足无关，因为用户已经拥有“批量执行”权限。

所以我们必须将密钥文件从漫游配置文件移动到本地目录。

基本上这些步骤是必要的： 1）找出你的关键目录实际在哪里（--list 命令） 2）从漫游目录复制/粘贴文件到你的路径（fi c：\winutil\library） 3）删除“旧”密钥 4) 使用 --homeDir 选项创建新密钥

请在 gpg 网站或此处找到说明： [http ://www.glump.net/howto/cryptography/practical-introduction-to-gnu-privacy-guard-in-windows#6.1_Preparing_a_Minimal_Copy_of_GPG](http://www.glump.net/howto/cryptography/practical-introduction-to-gnu-privacy-guard-in-windows#6.1_Preparing_a_Minimal_Copy_of_GPG)

在无人值守的情况下启动您的 Powershell 脚本并验证:-)。HTH，罗伯特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T19:19:13.767

好的，所以当我在等待回复时，我一直在解决这个问题。根据发布的其他问题的一些推论和研究从 GPG 返回的完全无用的错误代码，我认为可能是 Windows 中的 DEP 导致了问题。

为了测试它，我将 gpg 可执行文件添加到 DEP（不是推荐的 MS 解决方案）的例外列表中，然后安排所有加密任务在无人值守的情况下运行。他们开始启动并完美运行了一个多小时的测试期。

根据我所阅读和体验的内容，似乎由于 GPG 以无人值守的方式运行，因此如果它作为登录的实际用户配置文件运行，它不会获得分配的内存。一旦它开始加密任何文件合理的大小并尝试访问超出标记为可由 Windows 执行的设置限制的内存，DEP 立即使 GPG 实例崩溃，导致应用程序日志中的错误消息实际上没有帮助。

无论如何，希望这可以帮助那里的人！

干杯

# vb.net - 如何一次将 2 个或多个“USERCONTROL”添加到面板中

> ID：11036093
> 
> 赞同：0
> 
> 时间：2012-06-14T15:10:02.917
> 
> 标签：vb.net, visual-studio-2010

有什么方法可以一次将用户控件添加到面板...我正在使用此代码..

```
 Dim Project as New Usercontrol
    Panel1.Controls.Add(Project)
    Panel1.Controls.Add(Project) 
```

并且它只在该用户控件中添加了 1 个用户控件和编辑的文本，而不是创建一个新的用户控件...

任何答案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:14:30.693

在您的示例中，您将两次添加相同的用户控件实例。那是行不通的。您需要创建两个单独的控件实例，然后将它们都添加到面板中：

```
Dim Project1 as New Usercontrol
Panel1.Controls.Add(Project1)
Dim Project2 as New Usercontrol
Panel1.Controls.Add(Project2) 
```

# php - Codeigniter - 在同一模型中调用模型方法是错误的

> ID：11036095
> 
> 赞同：1
> 
> 时间：2012-06-14T15:10:14.223
> 
> 标签：php, sql, codeigniter, query-builder

我正在尝试在同一模型中调用模型方法，但它没有按预期工作。这是我的课，有两种不起作用的方法

```
class mymodel extends CI_Model{
    public function __construct(){
        parent::__construct();
        $this->tablea = 'tablea';
        $this->tableb = 'tableb';
    }

    public function saveData($data){
        $dataCopy['revisionkey'] = $this->getRevisionKey($data['id']);
        //check and condition revision key to be int with +1 from last one
        $this->db->insert($this->tableb, $dataCopy);
        $this->db->where('id', $id);
        return $this->db->update($this->user_table, $data) ? true : false;
    }

    public function getRevisionKey($id){
        $this->db->select($this->revision_tablea.'.revisions_number as revisions_number')
            ->from($this->revision_tablea)
            ->where($this->revision_tablea.'.id', $id)
            ->order_by($this->revision_table.'.revisions_number', 'asc')
            ->limit(1);
        $query = $this->db->get();
        if ($query->num_rows() > 0){
            return $query->row_array();
        }else{
            return 0;
        }
    }
} 
```

现在方法`getRevisionKey()`应该产生如下查询

```
SELECT `tableb`.`revisions_number` as revisions_number FROM (`tableb`) WHERE `tableb`.`id` = '26' ORDER BY `tableb`.`revisions_number` asc LIMIT 1 
```

但它会产生如下查询

```
SELECT `tableb`.`revisions_number` as revisions_number FROM (`tableb`) WHERE `id` = '26' AND `tableb`.`id` = '26' ORDER BY `tableb`.`revisions_number` asc LIMIT 1 
```

这当然是由于在模型中调用了相同的方法，如果在模型之外使用此方法可以正常工作。这个问题有什么解决办法吗？

**编辑** 重写此`getRevisionKey()`修复程序。这是新版本

```
 public function getRevisionKey($id){
        $sqlQuery = $this->db->select($this->revision_tablea.'.revisions_number as revisions_number')
            ->from($this->revision_tablea)
            ->order_by($this->revision_table.'.revisions_number', 'asc')
            ->limit(1);
        $query = $sqlQuery->where($this->revision_tablea.'.id', $id)->get();
        if ($query->num_rows() > 0){
            return $query->row_array();
        }else{
            return 0;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T05:58:18.457

这是一个简单的技巧，可以准确地告诉你你在哪里犯了错误。转到 system/database/DB_active_rec.php 从这些函数中删除 public 或 protected 关键字

```
public function _compile_select($select_override = FALSE)
public function _reset_select() 
```

并保存它。在运行函数之前，我的意思是调用

```
$this->db->get() // Use $this->db->from() instead 
```

利用

```
$query = $this->db->_compile_select() 
```

并回显$查询；

这两个函数还有助于在 codeigniter 活动记录中进行子查询。 [如何将此 SQL 重写到 CodeIgniter 的活动记录中？](https://stackoverflow.com/questions/10502778/how-can-i-rewrite-this-sql-into-codeigniters-active-records/10546395#10546395)

# c# - 在遍历 Xdocument 时获取 xDocument 元素的子节点

> ID：11036096
> 
> 赞同：1
> 
> 时间：2012-06-14T15:10:25.070
> 
> 标签：c#, asp.net, xml, linq, linq-to-xml

抱歉，如果我的问题不清楚。我从 xDocument 中获得了一堆元素和每个元素的属性。现在我希望在每次迭代中获得每个节点的更多死者并遍历它们并获取它们的所有属性。

结构体：

```
<Jobs>
     <Job attr1=val1 attr2=val2 attr3=val3>
          <InnerNode1 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode1>
          <InnerNode2 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode2>
          <InnerNode3 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode3>
     </job>
     <Job attr1=val4 attr2=val5>
          <InnerNode1 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode1>
          <InnerNode2 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode2>
          <InnerNode3 InnerAttr1=val6 InnerAttr2=7>
                     <InnerNodeChild1>
                        .........
                     </InnerNodeChild1>
                     <InnerNodeChild2>
                        ............
                     </InnerNodeChild2>
                     <InnerNodeChild3>
                        .......
                     </InnerNodeChild3>
          </InnerNode3>
     </Job>
     .....
     .....
     .....
     <OtherNodeInSameLevelAsJob>
     </OtherNodeInSameLevelAsJob>
</Jobs> 
```

好的，对于每个**作业节点**，只有一个**InnerNode1**，它具有自身的属性和内部节点。如果我想从每个 InnerNode1 中获取所有属性和 InnerNodeChilds，但是在通过作业运行时，就像在下一个示例中一样，我需要做什么？

```
 XDocument xDoc = XDocument.Load(xDr);
            var Jobs = from Job in xDoc.Descendants("Job")
                       select new {  
                            JobID = Job.Attribute("JobID").Value,
                            JobName = Job.Attribute("JobName").Value,
                            ........
                            ........
                            ........
                        }; 
```

进而：

```
 foreach(var Job in Jobs){
        string JobId = Job.JobID;
        string JobName = job.JobName;
        .........
        .........
        .........
 } 
```

谢谢你，埃雷兹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:52:30.400

Getting every `InnerNode1` is very simple, you just call `.Descendants("InnerNode1")` and you'll have a list of every one of them. Here's an example that might work for you. I call parent on the node to get its job name and id.

```
var innerchilds = xDoc.Descendants("InnerNode1").Select(x => new {
    JobID = x.Parent.Attribute("JobID").Value,
    JobName = x.Parent.Attribute("JobName").Value,
    ...
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:29:44.453

你的意思是选择里面的选择吗？

```
var Jobs = from Job in xDoc.Descendants("Job")
                   select new {  
                        JobID = Job.Attribute("JobID").Value,
                        JobName = Job.Attribute("JobName").Value,
                        InnerNode = from inner in Job.Elements("InnerNode")
                            select new
                            {
                               Name = inner.Attribute("Name")
                            }
                        ........
                        ........
                        ........
                    }; 
```

# math - Writing a division program for computer AIDJ

> ID：11036098
> 
> 赞同：0
> 
> 时间：2012-06-14T15:10:35.927
> 
> 标签：math

I'm writing a multiplication program for a virtual computer called AIDJ.

It supports any number of variables and is able to read and execute any sequence of operations (programme) of the form

```
mk: <operation> 
```

Where **mk** is the marker and **must only be taken from:**

 **```
Increment: x(i) = x(i) + 1 
Decrement: x(i) = x(i) - 1 
Conditional Jump: if x!=0 goto <mk>
Assignment: x(i) = c (where c is any natural number) 
```

Apart from potential conditional jumps - AIDJ evaluates the operations in the order described by the programme and stops when the programme is completely processed.

Take for example the programme ADD **with c >= 1**:

```
00: x(1) = c
01: x(2) = d
02: x(2) = x(2) + 1
03: x(1) = x(1) - 1
04: if x(1) != 0 goto 02 
```

Take for example the programme MULTIPLY **with c >= 2**:

```
00: x(1) = d
01: x(1) = d - 1
02: x(2) = c
03: x(3) = c
04: x(2) = x(2) + 1
05: x(3) = x(3) - 1
06: if x(3) =! 0 goto 04
07: x(1) = d - 1
08: if x(3) =! 0 goto 03 
```

I am making sure that c × d equals c + c + … + c (d summands) so I can use the programme ADD, and we make sure that ADD is executed d-1 times. When the computation stops, x(2) equals c × d.

This would produce following table of values if **c=3 and d=3**:

```
| Command                   | x(1) | x(2) | x(3) |
--------------------------------------------------
| 00: x(1) = d              | 3    | -    | -    |
| 01: x(1) = d - 1          | 2    | -    | -    |
| 02: x(2) = c              | 2    | 3    | -    |
| 03: x(3) = c              | 2    | 3    | 3    |
| 04: x(2) = c + 1          | 2    | 4    | 3    |
| 05: x(3) = d - 1          | 2    | 4    | 2    |
| 06: if x(3) =! 0 goto 04  | 2    | 4    | 2    |
| 04: x(2) = c + 1          | 2    | 5    | 2    |
| 05: x(3) = d - 1          | 2    | 5    | 1    |
| 06: if x(3) =! 0 goto 04  | 2    | 5    | 1    |
| 04: x(2) = c + 1          | 2    | 6    | 1    |
| 05: x(3) = d - 1          | 2    | 6    | 0    |
| 06: if x(3) =! 0 goto 04  | 2    | 6    | 0    |
| 07: x(1) = d - 1          | 1    | 6    | 0    |
| 08: if x(3) =! 0 goto 03  | 1    | 6    | 0    |
| 03: x(3) = c              | 1    | 6    | 3    | 
| 04: x(2) = c + 1          | 1    | 7    | 3    |
| 05: x(3) = d - 1          | 1    | 7    | 2    |
| 06: if x(3) =! 0 goto 04  | 1    | 7    | 2    |
| 04: x(2) = c + 1          | 1    | 8    | 2    |
| 05: x(3) = d - 1          | 1    | 9    | 1    |
| 06: if x(3) =! 0 goto 04  | 1    | 9    | 1    |
| 04: x(2) = c + 1          | 1    | 9    | 1    |
| 05: x(3) = d - 1          | 1    | 9    | 0    |
| 06: if x(3) =! 0 goto 04  | 1    | 9    | 0    |
| 07: x(1) = d - 1          | 0    | 9    | 0    |
| 08: if x(3) =! 0 goto 03  | 0    | 9    | 0    | 
```

How would I alter the the above program so that it divides instead of multiply?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:16:28.853

Multyplying is adding in a loop, right? Well, dividing is subtracting in a loop until what's left of the dividend is less than the divisor. In pseudocode:

```
# We're dividing a/b, getting the quotient c
c = 0
while a >= b
{
    a = a - b
    c = c+1
}
# End of loop
# The value of a is the remainder at this point 
```

So go with this. First, implement subtraction (which is decrement in a loop, on your VM). Then do the rest.

Since your conditionals are limited to comparing with zero, implement the logic of a>=b via subtraction (decrement in a loop). And don't be afraid to introduce extra variables. The architecture might be stunted, but there's no explicit limit on memory used, is there?

You can even combine the loop condition (which is decrement in a loop) with the loop body (also decrement in a loop). That's not how they'd do it in a high level language, and not even how a real CPU would do it - all modern CPUs have integer comparison as a primitive. Something along the lines of "decrement, if reached zero before the remain of the divisor reaches zero, then quit the loop and we're done". In real life, however, this kind of microoptimization (for a nonexistent architecture, no less) would be strongly recommended against.

Also, if this is homework, please add the tag "homework". Smells a lot like homework to me.

EDIT: here's the logic. We introduce three variables:

*   x(1) is the running copy of the dividend to be decremented
*   x(2) is the quotient - zero initially, to be incremented
*   x(3) is the running loop variable for the divisor.
*   d is the dividend
*   c is the divisor.
*   we can assign constants (like zero) to variables, can we?

Using a pseudocode that corresponds to the primitives of your VM. You translate it to AIDJ syntax - I mean, you have to do at least some work here. # marks comments. Labels (i. e. goto destinations) are marked with :

```
x(1) = d
x(2) = 0
x(3) = c

Main_Loop:

x(1) = x(1) - 1 # decrement the running copy of the dividend
x(3) = x(3) - 1 # decrement the running copy of the divisor
if x(3) != 0 goto Divisor_still_nonzero

# If we're here, this means we've reached the end of the divisor.
# Increment the quotient, reset the running divisor to the initial value

x(2) = x(2) + 1
x(3) = c

Divisor_still_nonzero:

# Now let's check if we've reached the zero on the dividend
if x(1) != 0 then goto Main_Loop

# If x(1) is zero then we end up here.
# Means we've exhausted the dividend.
# Now the value of x(2) is the quotient.
# The remainder is c minus x(3),
# but retrieving it was not a requirement. 
```

In real life, you should also check if c and d are zero or negative in the very beginning. If d is zero, the code will break - it'll go into negatives on the very first iteration, and will terminate only if the variables are subject to overflow. If c is zero, the whole division is illegal.

Extra handling for negatives is required, too.

Also, keep in mind that some professors are known to watch Stack Overflow.**

# api - 将动态生成的 KML 加载到谷歌地图 api 中

> ID：11036100
> 
> 赞同：0
> 
> 时间：2012-06-14T15:10:40.873
> 
> 标签：api, dynamic, kml

我在将动态生成的 KML 加载到谷歌地图 api 时遇到了一些问题。

KML 文件由 oracle 生成，格式为

```
http://server/oracleservioce.method?parm1=100&parm2=100 
```

如果我尝试加载该 uRL（编码或解码），我总是会得到一个 KMLLayerStatus 作为 INVALID_DOCUMENT。如果我将生成的文件保存到具有 KML 扩展名的本地文件中，它可以正常工作，否则我会出错。

我什至尝试将文件重命名为 .xml 和 .dat（任意名称），但它们都失败了。似乎 google api 需要该文件具有 .KML 扩展名。这在动态环境中不起作用。有人可以提出前进的道路吗？

谢谢，

PS：我需要使用 google maps API，我不能使用 openlayers 或任何其他解决方案。该文件需要加载到 google.maps.kmllayer 对象中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T15:35:23.140

无论扩展名如何，我都这样做了，但是您必须在 http 响应上设置 mimetype：[https ://developers.google.com/kml/documentation/kml_tut#kml_server](https://developers.google.com/kml/documentation/kml_tut#kml_server)

# sql-server-2008-r2 - 子表的正确主键？

> ID：11036101
> 
> 赞同：2
> 
> 时间：2012-06-14T15:10:44.410
> 
> 标签：sql-server-2008-r2, primary-key, query-performance

员工表中的主键应该是什么？

```
Table Stores
(PK) StoreID
{other store columns}

Table Employee
StoreID
EmployeeID
{other employee columns...} 
```

[编辑] 我们的设置是，员工将始终只属于一家商店。每个员工都应该有一个唯一的 ID（即，即使员工属于不同的商店，他们也不应该有相同的 ID）。

我认为 PK 应该只是 EmployeeID，因为它应该始终是唯一的。我的同事认为 PK 应该与 StoreID+EmployeeID 复合，但是（理论上）可能会有重复的员工 ID。我并不完全遵循他的推理，但他引用的一件事是性能。我不太担心查询性能，因为对于我们的数据库，Employee 表从未超过 5000 条记录。我们确实有其他更大的子表引用 StoreID，这是创建这样一个键的正当理由吗？

[编辑] 如果您还创建了一个仅对 EmployeeID 强制唯一性的内部密钥，那么复合 PK 是否可以？也许有多种方法可以做到这一点，但我想选择最被接受的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T17:41:03.127

> 我认为 PK 应该只是 EmployeeID，因为它应该始终是唯一的。我的同事认为 PK 应该与 StoreID+EmployeeID 复合，但是（理论上）可能会有重复的员工 ID。

你说的是两件略有不同的事情。

如果你只想*识别*员工，那么主键可能应该是employee_id，并且商店的id号根本不应该在那个表中。*但是*，另外，如果您想知道员工通常在哪个商店工作，您可以将 store_id 包含在 employees 表中（并使其成为`NOT NULL`），或者您可以创建一个单独的表。

In the 25+ years I've been doing this stuff, I've often had people tell me that an employee can work at *only* one store. That's almost always untrue, often even at the moment the managers are swearing it *is* true. One time, we were "discussing" this in a room with half a dozen employees who all worked at more than one store. One of them worked at five different stores every week. And *all* the managers knew this. When we pointed out all the people who worked at more than one store, the managers still insisted that everyone worked at only one store. (shrug)

I favor using a separate table to store employees current, paid work locations. The main reason is that management *always* want more information about that relationship besides *just* that bare fact. Always. Attendance, timekeeping, always something else.

In *that* table, you'll need a composite primary key of at least {store_id, employee_id}. You might need more columns (and sometimes more tables) than that, depending on what other information you want to store about that location relationship. You'll also need some kind of administrative procedure (which you might or might not be able to automate) to make sure every employee has at least one current, paid work location. (If you dbms ever supports assertions, you can get rid of the administrative procedure.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T17:54:26.520

If your EmployeeID is unique across all stores, then it should be the primary key of that table. Like you said, otherwise you would have duplicate EmployeeIDs. The only reason I can see to have StoreID + EmployeeID is that if each store had its own employee numbers. If a person worked in two differnet stores, he would then need two EmployeeIDs, one for each store. From your question though, I don't think that is the case.

The StoreID should, however, be setup with a Foreign Key relationship, assuming that the employee will always be assigned a StoreID.

Also, if your co-worker is mainly concerned with performance, you can add an EmployeeID, StoreID index to your table, that should clear up any slow queries (if you encounter any). Since you said the table was small, I would wait until a performance issue appeared before adding indexes. I think the primary key is always a logical organization decision, I wouldn't consider performance as part of that decision.

# jquery - 如何“停用”活动的导航栏按钮？(jQuery 移动)

> ID：11036105
> 
> 赞同：0
> 
> 时间：2012-06-14T15:10:51.827
> 
> 标签：jquery, jquery-mobile

如何`.ui-btn-active`在导航栏中的活动按钮上删除/覆盖类？当我点击按钮时，我运行一个 js 函数，最后我想删除该类或以某种方式停用该按钮。将 href 设置为 #nonexistent 似乎在桌面浏览器中可以解决问题，但在移动浏览器上，按钮仍然处于活动状态：-\

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-03T15:57:00.577

应该

```
$(".ui-btn-active").removeClass('ui-btn-active'); 
```

`removeClass`接受不带点的类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:18:29.317

我可能遗漏了一些东西，但是您是否尝试过删除课程？

```
$(".ui-btn-active").removeClass('.ui-btn-active'); 
```

# javascript - Three.js 投影仪和射线对象

> ID：11036106
> 
> 赞同：39
> 
> 时间：2012-06-14T15:10:51.840
> 
> 标签：javascript, 3d, three.js

我一直在尝试使用 Projector 和 Ray 类来做一些碰撞检测演示。我已经开始尝试使用鼠标来选择对象或拖动它们。我查看了使用这些对象的示例，但似乎没有一个注释可以解释 Projector 和 Ray 的某些方法到底在做什么。我有几个问题希望有人能轻松回答。

**到底发生了什么，Projector.projectVector() 和 Projector.unprojectVector() 之间有什么区别？**我注意到在所有使用投影仪和射线对象的示例中，似乎在创建射线之前调用了 unproject 方法。**什么时候使用 projectVector？**

我在这个**[演示](http://cmg0030.zxq.net/threejs/acclDemo7/)**中使用以下代码在用鼠标拖动时旋转立方体。**有人可以简单地解释一下当我用 mouse3D 和相机取消投影然后创建 Ray 时到底发生了什么。光线是否依赖于对 unprojectVector() 的调用**

```
/** Event fired when the mouse button is pressed down */
function onDocumentMouseDown(event) {
    event.preventDefault();
    mouseDown = true;
    mouse3D.x = mouse2D.x = mouseDown2D.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse3D.y = mouse2D.y = mouseDown2D.y = -(event.clientY / window.innerHeight) * 2 + 1;
    mouse3D.z = 0.5;

    /** Project from camera through the mouse and create a ray */
    projector.unprojectVector(mouse3D, camera);
    var ray = new THREE.Ray(camera.position, mouse3D.subSelf(camera.position).normalize());
    var intersects = ray.intersectObject(crateMesh); // store intersecting objects

    if (intersects.length > 0) {
        SELECTED = intersects[0].object;
        var intersects = ray.intersectObject(plane);
    }

}

/** This event handler is only fired after the mouse down event and
    before the mouse up event and only when the mouse moves */
function onDocumentMouseMove(event) {
    event.preventDefault();

    mouse3D.x = mouse2D.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse3D.y = mouse2D.y = -(event.clientY / window.innerHeight) * 2 + 1;
    mouse3D.z = 0.5;
    projector.unprojectVector(mouse3D, camera);

    var ray = new THREE.Ray(camera.position, mouse3D.subSelf(camera.position).normalize());

    if (SELECTED) {
        var intersects = ray.intersectObject(plane);
        dragVector.sub(mouse2D, mouseDown2D);
        return;
    }

    var intersects = ray.intersectObject(crateMesh);

    if (intersects.length > 0) {
        if (INTERSECTED != intersects[0].object) {
            INTERSECTED = intersects[0].object;
        }
    }
    else {
        INTERSECTED = null;
    }
}

/** Removes event listeners when the mouse button is let go */
function onDocumentMouseUp(event) {
    event.preventDefault();

    /** Update mouse position */
    mouse3D.x = mouse2D.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse3D.y = mouse2D.y = -(event.clientY / window.innerHeight) * 2 + 1;
    mouse3D.z = 0.5;

    if (INTERSECTED) {
        SELECTED = null;
    }

    mouseDown = false;
    dragVector.set(0, 0);
}

/** Removes event listeners if the mouse runs off the renderer */
function onDocumentMouseOut(event) {
    event.preventDefault();

    if (INTERSECTED) {
        plane.position.copy(INTERSECTED.position);
        SELECTED = null;
    }
    mouseDown = false;
    dragVector.set(0, 0);
} 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2014-05-06T10:58:35.540

我发现我需要更深入地了解表层才能在示例代码的范围之外工作（例如拥有不填满屏幕的画布或具有其他效果）。**[我在这里](http://barkofthebyte.azurewebsites.net/post/2014/05/05/three-js-projecting-mouse-clicks-to-a-3d-scene-how-to-do-it-and-how-it-works)**写了一篇关于它的博客文章。这是一个缩短版，但应该涵盖了我发现的几乎所有内容。

### 怎么做

以下代码（类似于@mrdoob 已经提供的代码）将在单击时更改立方体的颜色：

```
 var mouse3D = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1,   //x
                                    -( event.clientY / window.innerHeight ) * 2 + 1,  //y
                                    0.5 );                                            //z
    projector.unprojectVector( mouse3D, camera );   
    mouse3D.sub( camera.position );                
    mouse3D.normalize();
    var raycaster = new THREE.Raycaster( camera.position, mouse3D );
    var intersects = raycaster.intersectObjects( objects );
    // Change color if hit block
    if ( intersects.length > 0 ) {
        intersects[ 0 ].object.material.color.setHex( Math.random() * 0xffffff );
    } 
```

随着最近的 three.js 版本（大约 r55 和更高版本），您可以使用 pickRay 进一步简化事情，这样就变成了：

```
 var mouse3D = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1,   //x
                                    -( event.clientY / window.innerHeight ) * 2 + 1,  //y
                                    0.5 );                                            //z
    var raycaster = projector.pickingRay( mouse3D.clone(), camera );
    var intersects = raycaster.intersectObjects( objects );
    // Change color if hit block
    if ( intersects.length > 0 ) {
        intersects[ 0 ].object.material.color.setHex( Math.random() * 0xffffff );
    } 
```

让我们坚持使用旧方法，因为它可以更深入地了解幕后发生的事情。**[你可以在这里](http://barkofthebyte.azurewebsites.net/demos/projspikesfssimple.htm)**看到这个工作，只需点击立方体来改变它的颜色。

### 发生了什么？

```
 var mouse3D = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1,   //x
                                    -( event.clientY / window.innerHeight ) * 2 + 1,  //y
                                    0.5 );                                            //z 
```

`event.clientX`是点击位置的 x 坐标。除以`window.innerWidth`给出与整个窗口宽度成比例的点击位置。基本上，这是从从左上角 (0,0) 开始到右下角 ( `window.innerWidth`, `window.innerHeight`) 的屏幕坐标转换为中心为 (0,0) 且范围为 (-1,-1) 的笛卡尔坐标) 到 (1,1) 如下所示：

![从网页坐标翻译](../Images/95e8d2729f5f7c0b3831996f095b9fca.png)

请注意，z 的值为 0.5。在这一点上，我不会详细介绍 z 值，只是说这是我们沿 z 轴投影到 3D 空间中的远离相机的点的深度。稍后再谈。

下一个：

```
 projector.unprojectVector( mouse3D, camera ); 
```

如果您查看three.js 代码，您会发现这实际上是从3D 世界到相机的投影矩阵的反转。请记住，为了从 3D 世界坐标到屏幕上的投影，需要将 3D 世界投影到相机的 2D 表面（这是您在屏幕上看到的）。我们基本上是在做相反的事情。

请注意，mouse3D 现在将包含这个未投影的值。这是沿我们感兴趣的射线/轨迹在 3D 空间中的点的位置。确切的点取决于 z 值（我们稍后会看到）。

此时，查看下图可能会很有用：

![相机、未投影值和光线](../Images/8c1fea7b29df4776e9217e3075113a7d.png)

我们刚刚计算的点（mouse3D）由绿点表示。请注意，点的大小纯粹是说明性的，它们与相机或鼠标 3D 点的大小无关。我们对点中心的坐标更感兴趣。

现在，我们不仅想要 3D 空间中的单个点，而是想要一条射线/轨迹（由黑点显示），以便我们可以确定对象是否沿着该射线/轨迹定位。请注意，沿射线显示的点只是任意点，**射线是来自相机的方向，而不是一组点**。

幸运的是，因为我们沿着射线有一个点，并且我们知道轨迹必须从相机经过这个点，所以我们可以确定射线的方向。因此，下一步是从 mouse3D 位置中减去相机位置，这将给出一个方向向量，而不仅仅是一个点：

```
 mouse3D.sub( camera.position );                
    mouse3D.normalize(); 
```

我们现在有了从相机到 3D 空间中该点的方向（mouse3D 现在包含该方向）。然后通过对其进行归一化将其转换为单位向量。

下一步是从相机位置开始创建射线（Raycaster）并使用方向（mouse3D）投射射线：

```
 var raycaster = new THREE.Raycaster( camera.position, mouse3D ); 
```

其余代码确定 3D 空间中的对象是否与射线相交。令人高兴的是，我们在幕后使用`intersectsObjects`.

### 演示

好的，让我们看一下我网站上的一个演示，**[它](http://barkofthebyte.azurewebsites.net/demos/projspikes.htm)**显示了这些光线在 3D 空间中投射。当您单击任意位置时，相机会围绕对象旋转，以向您展示光线是如何投射的。请注意，当相机返回其原始位置时，您只会看到一个点。这是因为所有其他点都沿着投影线，因此被前面的点挡住了视线。这类似于当您向下看直接远离您的箭头线时 - 您所看到的只是底部。当然，在向下看直接朝你行进的箭头线时也是如此（你只能看到头部），这通常是一种糟糕的情况。

### z 坐标

让我们再看一下 z 坐标。当您阅读本节并尝试不同的 z 值时，请参阅**[此演示。](http://barkofthebyte.azurewebsites.net/demos/projspikesfs.htm)**

好的，让我们再看一下这个函数：

```
 var mouse3D = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1,   //x
                                    -( event.clientY / window.innerHeight ) * 2 + 1,  //y
                                    0.5 );                                            //z 
```

我们选择 0.5 作为值。我之前提到过，z 坐标决定了投影到 3D 的深度。所以，让我们看一下 z 的不同值，看看它有什么影响。为此，我在相机所在的位置放置了一个蓝点，并在相机到未投影位置放置了一条绿点。然后，在计算出交点后，我将相机向后移动到一侧以显示射线。最好看几个例子。

一、z值为0.5：

![z 值为 0.5](../Images/3e11759e691e044fb3d68da3b957e131.png)

注意从相机（蓝点）到未投影值（3D 空间中的坐标）的绿点线。这就像枪管，指向它们应该投射的方向。绿线本质上表示在归一化之前计算的方向。

好的，让我们尝试一个 0.9 的值：

![z 值为 0.9](../Images/589be7de624d2221d6fe1952a5dd452b.png)

如您所见，绿线现在已进一步延伸到 3D 空间。0.99 进一步扩展。

我不知道 z 的值有多大是否重要。似乎更大的值会更精确（如更长的枪管），但由于我们正在计算方向，因此即使很短的距离也应该相当准确。我看到的示例使用 0.5，所以除非另有说明，否则我将坚持使用。

### 画布未全屏时的投影

现在我们对正在发生的事情有了更多的了解，我们可以弄清楚当画布没有填满窗口并定位在页面上时应该是什么值。例如，说：

*   包含 three.js 画布的 div 是从屏幕左侧的 offsetX 和从屏幕顶部的 offsetY。
*   画布的宽度等于 viewWidth，高度等于 viewHeight。

代码将是：

```
 var mouse3D = new THREE.Vector3( ( event.clientX - offsetX ) / viewWidth * 2 - 1,
                                    -( event.clientY - offsetY ) / viewHeight * 2 + 1,
                                    0.5 ); 
```

基本上，我们所做的是计算鼠标点击相对于画布的位置（对于 x: `event.clientX - offsetX`）。然后我们按比例确定点击发生的位置（对于 x: `/viewWidth`），类似于画布填充窗口的时间。

就是这样，希望对你有帮助。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-06-14T17:41:49.010

基本上，您需要从 3D 世界空间和 2D 屏幕空间进行投影。

渲染器`projectVector`用于将 3D 点转换为 2D 屏幕。`unprojectVector`基本上是为了将 2D 点反向投影到 3D 世界中。对于这两种方法，您都可以通过您正在查看场景的相机。

因此，在此代码中，您将在 2D 空间中创建归一化向量。老实说，我从不太确定`z = 0.5`逻辑。

```
mouse3D.x = (event.clientX / window.innerWidth) * 2 - 1;
mouse3D.y = -(event.clientY / window.innerHeight) * 2 + 1;
mouse3D.z = 0.5; 
```

然后，此代码使用相机投影矩阵将其转换为我们的 3D 世界空间。

```
projector.unprojectVector(mouse3D, camera); 
```

将 mouse3D 点转换为 3D 空间后，我们现在可以使用它来获取方向，然后使用相机位置来投射光线。

```
var ray = new THREE.Ray(camera.position, mouse3D.subSelf(camera.position).normalize());
var intersects = ray.intersectObject(plane); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2015-03-22T10:54:30.190

从 r70 版开始，`Projector.unprojectVector`已`Projector.pickingRay`弃用。取而代之的是，我们可以`raycaster.setFromCamera`更轻松地找到鼠标指针下的对象。

```
var mouse = new THREE.Vector2();
mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
mouse.y = -(event.clientY / window.innerHeight) * 2 + 1; 

var raycaster = new THREE.Raycaster();
raycaster.setFromCamera(mouse, camera);
var intersects = raycaster.intersectObjects(scene.children); 
```

`intersects[0].object`给出鼠标指针下的对象，并`intersects[0].point`给出鼠标指针被点击的对象上的点.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-04T08:45:24.250

Projector.unprojectVector() 将 vec3 视为一个位置。在这个过程中，向量被翻译，因此我们在它上面使用***.sub(camera.position)***。另外，我们需要在此操作后对其进行规范化。

我将在这篇文章中添加一些图形，但现在我可以描述操作的几何形状。

我们可以将相机视为几何形状的金字塔。我们实际上用 6 个窗格来定义它——左、右、上、下、近和远（近是最靠近尖端的平面）。

如果我们站在某个 3d 中观察这些操作，我们会看到这个金字塔处于任意位置，并在空间中任意旋转。假设这个金字塔的原点在它的顶端，它的负 z 轴朝向底部。

如果我们应用正确的矩阵变换序列，那么最终包含在这 6 个平面中的任何内容都将最终呈现在我们的屏幕上。我的opengl是这样的：

```
NDC_or_homogenous_coordinates = projectionMatrix * viewMatrix * modelMatrix * position.xyzw; 
```

这将我们的网格从它的对象空间带入世界空间，进入相机空间，最后将它投影到透视投影矩阵中，该矩阵基本上将所有内容放入一个小立方体（NDC，范围从 -1 到 1）。

对象空间可以是一组整齐的 xyz 坐标，您可以在其中通过程序生成一些东西，或者说，一个 3d 模型，艺术家使用对称性建模，因此与坐标空间整齐地对齐，而不是从类似的东西获得的建筑模型REVIT 或 AutoCAD。

objectMatrix 可能发生在模型矩阵和视图矩阵之间，但这通常会提前处理。比如说，翻转 y 和 z，或者将远离原点的模型带入边界，转换单位等。

如果我们认为我们的平面 2d 屏幕好像有深度，它可以被描述为与 NDC 立方体相同的方式，尽管略有失真。这就是我们为相机提供纵横比的原因。如果我们想象一个与屏幕高度相同的正方形，则余数就是我们需要缩放 x 坐标的纵横比。

现在回到 3d 空间。

我们站在一个 3d 场景中，我们看到了金字塔。如果我们切割金字塔周围的所有东西，然后将金字塔连同其中包含的场景部分一起取出，并将其尖端放在 0,0,0 处，并将底部指向 -z 轴，我们将在此处结束：

```
viewMatrix * modelMatrix * position.xyzw 
```

将其乘以投影矩阵将与我们将尖端相乘，并开始将其在 x 和 y 轴上拉开，从该点创建一个正方形，并将金字塔变成一个盒子。

在这个过程中，盒子被缩放到 -1 和 1，我们得到了透视投影，我们在这里结束了：

```
projectionMatrix * viewMatrix * modelMatrix * position.xyzw; 
```

在这个空间中，我们可以控制二维鼠标事件。由于它在我们的屏幕上，我们知道它是二维的，并且它位于 NDC 立方体中的某个位置。如果它是二维的，我们可以说我们知道 X 和 Y，但不知道 Z，因此需要射线投射。

所以当我们投射光线时，我们基本上是通过立方体发送一条线，垂直于它的一个边。

现在我们需要确定该光线是否击中场景中的某物，为了做到这一点，我们需要将来自该立方体的光线转换为适合计算的空间。我们想要世界空间中的光线。

射线是空间中的一条无限线。它与向量不同，因为它有方向，并且必须通过空间中的一个点。事实上，这就是 Raycaster 的论证方式。

所以如果我们沿着线挤压盒子的顶部，回到金字塔中，线将从尖端开始向下延伸并与金字塔底部相交--mouse.x * farRange和-mouse.y * 远距离。

*（一开始是 -1 和 1，但视图空间是世界比例的，只是旋转和移动）*

由于这是相机的默认位置（它是对象空间），如果我们将它自己的世界矩阵应用于射线，我们将与相机一起变换它。

由于光线穿过 0,0,0，我们只有它的方向，而 THREE.Vector3 有一个转换方向的方法：

```
THREE.Vector3.transformDirection() 
```

它还在过程中对向量进行归一化。

**上述方法中的Z坐标**

这基本上适用于任何值，并且由于 NDC 多维数据集的工作方式，其行为相同。近平面和远平面投影到 -1 和 1。

因此，当您说时，向：

```
[ mouse.x | mouse.y | someZpositive ] 
```

你通过一个点 (mouse.x, mouse.y, 1) 向 (0,0,someZpositive) 方向发送一条线

如果您将此与盒子/金字塔示例相关联，则该点位于底部，并且由于该线源自相机，因此它也穿过该点。

但是，在 NDC 空间中，这个点被拉伸到无穷大，这条线最终与左、上、右、下平面平行。

使用上述方法取消投影本质上会将其转换为位置/点。远平面刚刚被映射到世界空间，所以我们的点位于 z=-1 的某个位置，在 X 上的 -camera aspect 和 + cameraAspect 以及 y 上的 -1 和 1 之间。

因为它是一个点，所以应用相机世界矩阵不仅会旋转它，还会平移它。因此，需要通过减去相机位置将其带回原点。

# unit-testing - 如何使用 LLBLGen 进行模拟

> ID：11036108
> 
> 赞同：3
> 
> 时间：2012-06-14T15:10:55.570
> 
> 标签：unit-testing, mocking, llblgen

你怎么能模拟 LLBLGen？我看到有一个 ILinqMetaData 接口，但它没有提供任何有用的方法来模拟。我假设您希望对 ILinqMetaData 接口以及生成的实体接口进行编程，以使对象与数据松散耦合。有没有人有任何简单测试/模拟的例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:19:01.030

我认为它不仅限于 LLBLGen，也许这会有所帮助：

[单元测试数据库驱动应用程序的最佳策略是什么？](https://stackoverflow.com/questions/145131/whats-the-best-strategy-for-unit-testing-database-driven-applications)

就个人而言，我通常不测试我的数据库访问或存储库，只测试在实体上运行的逻辑，或在整个堆栈（包括数据库）上运行的集成测试。

更新：这有帮助吗？它允许您通过模拟 IOrderRepository 来测试您的逻辑，而无需执行任何获取/持久性逻辑：

```
public class MyBusinessLogic 
{
    IOrderRepository orders;

    public MyBusinessLogic(IOrderRepository orders) 
    {
      this.orders = orders; 
    }

    public DoSomethingTestable(OrderEntity order)
    {
      order.Total = 100;
      orders.Save(order);
    }
} 
```

# facebook - 自动登录和喜欢android

> ID：11036111
> 
> 赞同：1
> 
> 时间：2012-06-14T15:11:12.127
> 
> 标签：facebook, facebook-like

我正在尝试制作一个可以获取我的帐户信息的小型应用程序，以便它可以自动登录并喜欢我提供给该应用程序的 Facebook 页面。

这甚至可能（没有外部api或某事）？用来实现这样的事情的逻辑是什么？

# ruby - 搜索文件的行并用数组中的值替换变量并循环直到数组没有更多值

> ID：11036113
> 
> 赞同：1
> 
> 时间：2012-06-14T15:11:19.687
> 
> 标签：ruby, arrays, substitution

我想我离这里很近，但有一个关键部分在躲避我。

### 模板.txt

> 我是一个@file
> ，需要 用数组中的每个值
> 替换单词文件

### 子值.txt

> 单词1
> 单词2
> 单词
> 3 单词4

所以我正在做的是打开一个文件附加到使用

```
filex = file.new ("outputfile.txt" "a") 
```

然后我用模板数据打开文件

```
data = file.open("template.txt") 
```

然后我将我的数据导入到一个数组中

```
array1 = File.readlines("subvalues.txt") 
```

这就是我卡住的地方。如何循环遍历数组，用数组中的第一个元素替换`@file`in `file1`，将输出写入`outputfile.txt`，再次用数组中的第二个元素替换`@file`in `file1`，将输出附加到`outputfile.txt`，然后继续直到数组没有更多值。

我发现了类似的帖子，但没有与我正在做的事情相匹配。我已经尝试将其中一些想法适应我​​正在尝试做的事情，但似乎我在做一些倒退的事情，我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:28:15.903

模板.txt：

```
I am a @file that needs the word file replaced with each value in an array 
```

子值.txt

```
word1
word2
word3
word4 
```

代码：

```
data = File.open('template.txt', &:read)
array = File.read('subvalues.txt').split
File.open('outputfile.txt', 'a') do |file|
  array.each do |value|
    file.write(data.gsub('@file', value))
  end 
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:29:56.870

好吧，如果你愿意的话，有一个简单的、hacky 的方法。

```
substitutions_array.each do |elt|
  big_file.sub('file', elt)
end 
```

这可能不是最好的方法，但它应该适合你。Sub 仅进行一次替换，因此您可以循环遍历数组。

编辑：我想我误解了你的问题，如果是这样，请参阅上面的答案。

# tcl - 你如何在 TCL 中为 Sublime Text 2 修复转义字符？

> ID：11036115
> 
> 赞同：0
> 
> 时间：2012-06-14T15:11:22.040
> 
> 标签：tcl, highlight, sublimetext2

似乎以下两行代码破坏了 TCL 中的语法着色。

```
regsub -all {/} $original {\\\\} target      # The last } is being escaped

set grep_keyword [string trim $grep_keyword {"}]   # The " character is starting a new quote 
```

当我打开文件时，这段代码是这样的。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T08:29:23.933

虽然从技术上讲问题出在 Sublime Text 2 上（在某些极端情况下正确突出显示 Tcl 并不是很简单，您已经发现），但将 Tcl 代码更改为语义等价的东西更容易。

```
regsub -all {/} $original "\\\\\\\\" target 
```

```
set grep_keyword [string trim $grep_keyword "\""] 
```

当然，您可以考虑使用`string map`第一个：

```
set target [string map {"/" "\\\\"} $original]
# or this:
#    set target [string map {/ {\\}} $original]
# but I'm not sure if the editor will like that... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T16:08:17.003

所以，我回到了这个问题，并努力解决我的问题。我更改了 TCL 的 tmLangauge 文件。} 字符被识别为结束大括号。我刚刚也将 \} 添加到了这个定义中。

```
<key>braces</key>
<dict>
    <key>begin</key>
    <string>(?:^|(?&lt;=\s))\{</string>
    <key>comment</key>
    <string>matches a single brace-enclosed word</string>
    <key>end</key>
    <string>\}([^\s\]]*)</string>
    <key>endCaptures</key>
    <dict>
        <key>1</key>
        <dict>
            <key>name</key>
            <string>invalid.illegal.tcl</string>
        </dict>
    </dict>
    <key>patterns</key>
    <array>
        <dict>
            <key>match</key>
            <string>\\[{}\n]</string>
            <key>name</key>
            <string>constant.character.escape.tcl</string>
        </dict>
        <dict>
            <key>include</key>
            <string>#inner-braces</string>
        </dict>
    </array>
</dict> 
```

在上面，我对 RegEx 进行了修改，如下所示：

```
<string>\}([^\s\]]*)|\\}\s</string> 
```

# apache-flex - 如何使用 compc 构建动态链接 Flex 组件的 swc？

> ID：11036116
> 
> 赞同：0
> 
> 时间：2012-06-14T15:11:29.303
> 
> 标签：apache-flex, flex3, flash-builder, swc, compc

在 Flash Builder 4.6 中，管理 Flex 项目时，在 Flex 库项目的构建路径选项下，我可以在“外部”和“合并到代码”框架链接之间进行选择，“外部”是默认值。

**直接调用compc时如何使用外部链接？**

似乎 compc 默认情况下将 Flex 组件放在`library-path`部分而不是`external-library-path`部分中（查看生成的`-dump-config`文件）。

似乎 Flash Builder 中可用的选项应该可以通过 compc 上的某些选项或通过某些参数组合访问。我查看了 compc 选项文档，但不幸的是空了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:10:35.370

首先看一下`flex-config.xml`文件。您会在`[flex_sdk_path]/frameworks/flex-config.xml`. 现在找到名为 的节点`runtime-shared-library-path`。在这里，您将找到使用 compc 编译时将合并的所有库的列表（调用节点是`runtime-shared-library-path`因为 RSL 是使用 mxmlc 时的默认链接）。这些是您需要从外部链接的文件。

您有两种选择：

1.  创建您自己的配置文件，在其中将所有这些`runtime-shared-library-path`节点转换为`external-library-path`节点。`-load-config=my-config.xml`通过添加到编译器命令来加载此文件而不是默认文件。
2.  保留默认配置文件，但使用命令选项覆盖链接。只需将每个 swc 添加到 external-library-path:`-external-library-path+=libs/framework.swc`等等。

但是，当您使用 mxmlc 编译应用程序时，默认链接是 RSL。您可能也想覆盖它并使其“合并”。在这种情况下，您首先必须重置 RSL 路径：（`-runtime-shared-library-path=`没错，在 之后什么都没有`=`）。然后将每个 swc 添加到 -library-path：`-library-path+=libs/framework.swc`

* * *

或者（警告！在路上无耻的自我推销），你可以使用一个名为[GradleFx](https://github.com/GradleFx/GradleFx)的构建工具。如果您仅使用此行创建构建文件：

```
type = 'swc' 
```

它将使用外部链接的框架编译您的库。如果需要，您可以覆盖此默认值：

```
type = 'swc'
frameworkLinkage = 'merged' 
```

# ms-access - 复杂访问查询运行缓慢、占用 CPU 且不返回预期结果

> ID：11036117
> 
> 赞同：0
> 
> 时间：2012-06-14T15:11:32.480
> 
> 标签：ms-access, ms-access-2007

这是我的访问查询。我返回的每个值都是必需的（不幸的是）。然而，这个查询最糟糕的部分。是它有时会错过符合 WHERE 子句中条件的行。我尝试进行的每项优化都无济于事，或者无法在 Access 中完成（了解 SQL）。如您所见，WHERE 子句在三个日期字段之间进行检查。这是棘手的部分。对于 Inventory Masterfile 中的每一行信息，Inventory Stores 中有五行（每个“BranchID”一个），并且我在 where 子句中检查的日期列可以在这五个中的任何一个中更新日期行，到 Inventory Masterfile 中的一行。有没有人有任何可以帮助我的建议？我已经调试了好几个星期，对此我束手无策。

```
SELECT a.Item1,im.Secondary,im.Description,im.Author_Artist,im.RetailPrice,im.CatalogID,im.Publisher, im.Binding,im.PubDate,im.Grouping,im.CategoryId,im.Alt_Category,

(SELECT MAX(ls.OnHand) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1 AND ls.BranchID = 5)) AS 1Stock,

(SELECT MAX(ls.OnHand) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1 AND ls.BranchID = 3)) AS 2Stock,

(SELECT MAX(ls.OnHand) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1 AND ls.BranchID = 4)) AS 3Stock,

(SELECT MAX(ls.Maximum) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1 AND ls.BranchID = 4)) AS Maximum,

(SELECT MAX(ls.LastSold1) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1)) AS LastSold1,

(SELECT MAX(ls.LastUpdate) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1)) AS LastUpdate,

(SELECT MAX(ls.LastReceived) FROM [Inventory Store] ls WHERE (ls.Item1 = a.Item1)) AS LastReceived

FROM [Inventory Store] AS a

INNER JOIN [Inventory Masterfile] im ON a.Item1 = im.Item1

WHERE (a.LastSold1 > #6/12/2012# OR a.LastUpdate > #6/12/2012# OR a.LastReceived > #6/12/2012#)

GROUP BY a.Item1, im.Secondary, im.Description, im.Author_Artist, im.RetailPrice, 
im.CatalogID,im.Publisher, im.Binding,im.PubDate,im.Grouping,im.CategoryId,im.Alt_Category 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:38:33.703

试试这个，你有子查询而且它们很慢。

```
SELECT a.item1,
       im.secondary,
       im.description,
       im.author_artist,
       im.retailprice,
       im.catalogid,
       im.publisher,
       im.binding,
       im.pubdate,
       im.grouping,
       im.categoryid,
       im.alt_category,
       z.[1stock],
       y.[2stock],
       x.[3stock],
       w.mmaximum,
       v.mlastsold1,
       u.mlastupdate,
       t.mlastreceived
FROM   (((((((([inventory store] AS a
               LEFT JOIN (SELECT ls.item1,
                                 Max(ls.onhand) AS [1Stock]
                          FROM   [inventory store] ls
                          WHERE  ls.branchid = 5
                          GROUP  BY ls.item1) AS z
                      ON a.item1 = z.item1)
              LEFT JOIN (SELECT ls.item1,
                                Max(ls.onhand) AS [2Stock]
                         FROM   [inventory store] ls
                         WHERE  ls.branchid = 3
                         GROUP  BY ls.item1) AS y
                     ON a.item1 = y.item1)
             LEFT JOIN (SELECT ls.item1,
                               Max(ls.onhand) AS [3Stock]
                        FROM   [inventory store] ls
                        WHERE  ls.branchid = 4
                        GROUP  BY ls.item1) AS x
                    ON a.item1 = x.item1)
            LEFT JOIN (SELECT ls.item1,
                              Max(ls.maximum) AS [mMaximum]
                       FROM   [inventory store] ls
                       WHERE  ls.branchid = 4
                       GROUP  BY ls.item1) AS w
                   ON a.item1 = w.item1)
           LEFT JOIN (SELECT ls.item1,
                             Max(ls.lastsold1) AS mLastSold1
                      FROM   [inventory store] ls
                      GROUP  BY ls.item1) AS v
                  ON a.item1 = v.item1)
          LEFT JOIN (SELECT ls.item1,
                            Max(ls.lastupdate) AS mLastUpdate
                     FROM   [inventory store] ls
                     GROUP  BY ls.item1) AS u
                 ON a.item1 = u.item1)
         LEFT JOIN (SELECT ls.item1,
                           Max(ls.lastreceived) AS mLastReceived
                    FROM   [inventory store] ls
                    GROUP  BY ls.item1) AS t
                ON a.item1 = t.item1)
        LEFT JOIN [inventory masterfile] im
               ON a.item1 = im.item1)
WHERE  ( a.lastsold1 > #2012/6/12#
          OR a.lastupdate > #2012/6/12#
          OR a.lastreceived > #2012/6/12# )
GROUP  BY a.item1,
          im.secondary,
          im.description,
          im.author_artist,
          im.retailprice,
          im.catalogid,
          im.publisher,
          im.binding,
          im.pubdate,
          im.grouping,
          im.categoryid,
          im.alt_category,
          z.[1stock],
          y.[2stock],
          x.[3stock],
          w.mmaximum,
          v.mlastsold1,
          u.mlastupdate,
          t.mlastreceived 
```

# asp.net - ASP.Net 构建错误 - 未引用程序集

> ID：11036118
> 
> 赞同：3
> 
> 时间：2012-06-14T15:11:50.167
> 
> 标签：asp.net, visual-studio-2010, .net-assembly

当我尝试构建我的 asp.net 应用程序时出现构建错误。错误是：

**'MediCare.Framework.Authentication.IUserAuthenticate' 类型在未引用的程序集中定义。您必须添加对程序集“MediCare.Framework, Version=1.0.1.95, Culture=neutral, PublicKeyToken=1999fa3c42b9”的引用。**

我可以在引用文件夹中的库中看到该类。我该如何调试这个问题？
我的意图是将引用文件夹指向库源代码的 bin 目录（因为 pdb 文件是在那里涂上的，并且对库的任何更新都将反映在应用程序中）。但是，当我将引用文件夹指向源代码的 bin 目录时，我收到上面的错误消息。

**更新**该应用程序最初是在 VS 2008 中开发的，我正在 2010 年对其进行修改。如果我使用的是 VS 2010（2.0 框架位置或 4.0 框架位置），我想我对 GAC 程序集的位置感到困惑？[.NET 4.0 有一个新的 GAC，为什么？](https://stackoverflow.com/q/2660355/165694)

**更新 (06-26-2012)**
GAC 中的文件 ("C:\Windows\assembly\") 已被删除。但是这个错误仍在发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T05:06:38.710

这可能是由于版本不一致造成的。意思是，为了解决这个问题，我将对您的程序集（以及可能嵌套在程序集中的程序集）进行完整的干净构建。刚出去，对所有组件进行新的构建。那应该行得通。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:14:23.193

进入 Windows 资源管理器，右键单击项目正在使用的包含此类的 DLL 文件，然后查看版本选项卡。确保版本号与您在错误消息中看到的一致。我的猜测是它不会。

如果确实匹配，则检查 GAC 并确保那里没有可能获取的不同版本的 DLL。为此，请转到 Windows 资源管理器，然后导航到 c:\windows\assembly。查看该程序集是否具有不同的版本号。如果是，您可能需要将其从 GAC 中删除（但请小心，因为其他应用程序可能依赖于它的存在）。

# php - 使用 php、apache 创建动态、可过期和可恢复的下载链接

> ID：11036120
> 
> 赞同：0
> 
> 时间：2012-06-14T15:11:59.443
> 
> 标签：php, apache, security, download

这是问题的详细信息：

1）我想创建动态（基于IP）下载链接。所以用户不能用相同的下载链接下载不同IP的文件。

2）在开始实际下载之前，我想使用 php 记录这个下载请求并执行一些检查（验证 http 引荐来源网址）以允许用户下载实际文件。

3）我还希望下载文件是可恢复的，并且可以使用下载管理器下载（具有多个下载实例）。还希望限制每次下载允许的最大实例数。

4) 文件大小可能超过 200 MB。

因此，我正在考虑的解决方案是使用用户 ip 的 md5 哈希创建下载链接。例如 [http://yourdomain.com/download.php?ip_hash=hash-of-the-ip&file=file-to-download](http://yourdomain.com/download.php?ip_hash=hash-of-the-ip&file=file-to-download)

*这只是一个示例，但我们也可以使用 htaccess 创建一个很好的链接。*

接下来我该怎么办？我试着用

```
header("Content-Type: $ctype");
header("Content-Length: " . filesize($file));
header("Content-Disposition: attachment; filename=\"$fileName\"");
readfile($file); 
```

但是使用这个下载不会对最终用户保持恢复。

使用这种方法发送大文件可以吗？

在做了一些研究之后，我才知道最终用户使用这种方式的 .exe 文件已损坏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T10:05:02.330

在做了更多的研究之后，我找到了我的问题的答案。我只是想我也应该与你们分享。

正如 rambo 所说，我们可以使用 apache 服务器的 mod_xsendfile 模块。如果它被禁用，我们需要启用它。

如果您的 apache 没有此模块，这里是下载模块文件的链接。它适用于几乎所有版本的 apache，并且适用于 x32 和 x64。
[https://github.com/nmaier/mod_xsendfile](https://github.com/nmaier/mod_xsendfile)

完成所有自定义验证后，您可以使用以下代码使用此 apache 模块发送文件。

```
<?php
//We want to force a download box with the filename hello.txt
header('Content-Disposition: attachment;filename=hello.txt');

//File is located at data/hello.txt
header('X-Sendfile: data/hello.txt');
?> 
```

我希望它会帮助你们:)

# javascript - 自动更新javascript中的实际参数

> ID：11036121
> 
> 赞同：4
> 
> 时间：2012-06-14T15:12:00.280
> 
> 标签：javascript

调用java脚本方法时如何通过引用传递原始变量（如字符串）？这相当于 C# 中的 out 或 ref 关键字。

我有一个变量，例如`var str = "this is a string";`并将 str 传递给我的函数，并且当我更改参数值时，它必须自动反映 str 的变化

```
function myFunction(arg){
    // automatically have to reflect the change in str when i change the arg value
    arg = "This is new string";
    // Expected value of str is "This is new string"
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:31:40.260

原始类型，即字符串/数字/布尔值是按值传递的。函数、对象、数组等对象是通过引用“传递”的。

因此，您想要的将是不可能的，但以下将起作用：

```
 var myObj = {};
        myObj.str = "this is a string";
        function myFunction(obj){
            // automatically have to reflect the change in str when i change the arg value
            obj.str = "This is new string";
            // Expected value of str is "This is new string"
        }
        myFunction(myObj);
        console.log(myObj.str); 
```

# javascript - Javascript中的函数声明

> ID：11036124
> 
> 赞同：1
> 
> 时间：2012-06-14T15:12:03.523
> 
> 标签：javascript, function

> **可能重复：**
> [函数表达式与 Javascript 中的声明有什么区别？](https://stackoverflow.com/questions/1013385/what-is-the-difference-between-a-function-expression-vs-declaration-in-javascrip)

以这些方式声明函数之间是否存在**主要**区别：

1.  ```
    function foo(){
         alert('BAR');
    } 
    ```

2.  ```
    var foo = function (){
         alert('BAR');
    } 
    ```

3.  ```
    var foo = function bar(){
         alert('BAR');
    } 
    ```

我在[这里](https://stackoverflow.com/questions/11035855/very-strange-javascript-scoping-issue/11035910#comment14431913_11035910)被告知：

> 它发生在不同的时间，并导致一个引用匿名函数的变量。函数声明发生在范围内执行任何逐步代码之前，并导致绑定和具有正确名称的函数。

我声明我的函数的方式真的会影响我的代码的效率吗？如果是的话，哪种方式最好使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T15:17:08.780

是的，有一个主要区别。

第一个是*函数声明*。它发生在进入执行上下文时，在处理任何分步代码之前。它不能在任何类型的控制块中（例如，它在`if`语句的主体中是不合法的；但是，如果您这样做，大多数浏览器会尝试适应它——有时会导致[**非常**令人惊讶的行为](http://jsbin.com/atusib/5) ——与规范不一致）。它产生一个命名函数。

第二个是*函数表达式*（特别是*匿名函数表达式*）。像所有表达式一样，它在代码的逐步执行中遇到它时会被处理。和所有表达式一样，它可以在控制块内。它导致一个没有名称的函数分配给一个有名称的变量。

第三个是*命名函数表达式*。这是一个像上面一样的函数表达式，但函数也被赋予了一个名称。你想在[IE8 和更早版本中避免这些](http://blog.niftysnippets.org/2010/09/double-take.html)，因为 IE 实际上会出错，创建两个单独的函数（在两个不同的时间）。（基本上，IE 将其视为函数声明*和*函数表达式。）IE9 终于做到了这一点。

请注意，您的第二个和第三个示例依赖于自动分号插入；因为它们都是赋值语句，所以它们应该以 a`;`结尾`}`（在函数结束之后）。

# windows-7 - 强制 Windows 7 在程序关闭之前不关闭

> ID：11036125
> 
> 赞同：0
> 
> 时间：2012-06-14T15:12:05.037
> 
> 标签：windows-7

当 Windows 7 关闭时，它会自动关闭打开的程序。我想指定我想在关机时确认的进程。这是因为我使用[Toggl Desktop](https://www.toggl.com/public/widgets)来跟踪我的项目的时间，但是当程序关闭时它不会停止计时器，所以当我再次启动 Windows 并运行 toggl 时，我看到很多小时都过期了。我几乎总是忘记停止计时器，所以我想停止关闭窗口，直到计时器停止并且我手动关闭 Toggl。

非常比你。

# c# - WPF：从模型 MVVM 关闭窗口

> ID：11036127
> 
> 赞同：0
> 
> 时间：2012-06-14T15:12:08.813
> 
> 标签：c#, .net, wpf, mvvm

我正在尝试从其 ViewModel 关闭一个窗口。我正在使用 MVVM 模式。我已经厌倦了使用窗户；

```
Window parentWindow = Window.GetWindow(this); 
```

但我不能这样做，我如何获得 ViewModel 的窗口，以便我能够关闭窗口。我希望能够在代码中做到这一点。

你能在代码中找到父窗口吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:46:02.600

`ViewModels`不应`View`以任何方式引用 MVVM，包括关闭窗口。

相反，`View`和之间的通信`ViewModel`通常是通过某种事件或消息系统完成的，例如[Microsoft Prism`EventAggregator`](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.20%29.aspx)或[MVVM Light 的`Messenger`](http://www.galasoft.ch/mvvm/)

例如，`View`应该订阅侦听类型的事件消息`CloseWindow`，并且当它收到这些消息之一时，它应该关闭自己。然后，只要它想告诉它关闭，它就必须随时`ViewModel`广播一条消息。`CloseWindow``View`

如果您有兴趣，可以在我关于[ViewModel 之间的通信](http://rachel53461.wordpress.com/2011/06/05/communication-between-viewmodels-with-mvvm/)的博客文章中简要概述 MVVM 中的事件系统和一些示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-17T01:11:58.277

是的，在视图模型中引用视图不是最佳实践。为什么？**因为当您对视图模型进行单元测试时，需要您实例化视图，对于小视图并不难做到这一点，但是对于具有复杂依赖树的复杂视图？那不会很好。**

对我来说，与视图进行通信的最简单方法是传递`IInputElement`视图模型构造函数。的好处`IInputElement`是路由事件主干，它具有路由事件所需的方法`RaiseEvent`。`AddHandler`因此，您可以自由地将事件冒泡/隧道/直接到应用程序上的任何视图或视图模型，而无需任何额外的库。

这是我在视图模型上的简化代码，**但请记住这种技术仅适用于视图优先方法**

```
public class MyViewModel : INotifyPropertyChanged
{
    public static readonly RoutedEvent RequestCloseEvent = EventManager.RegisterRoutedEvent("RequestClose",
        RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(MyViewModel));

    private IInputElement dispatcher;

    public MyViewModel(IInputElement dispatcher)
    {
        this.dispatcher = dispatcher;
    }

    public void CloseApplication()
    {
        dispatcher.RaiseEvent(new RoutedEventArgs(RequestCloseEvent));
    }
} 
```

简单地在您的视图上

```
DataContext = new MyViewModel(this)
//notice "this" on the constructor 
```

以及您的应用程序的根视图（窗口）

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        AddHandler(MyViewModel.RequestCloseEvent, new RoutedEventHandler(onRequestClose));
    }

    private void onRequestClose(object sender, RoutedEventArgs e)
    {
        if (MessageBox.Show("Are you sure you want to quit?", "Confirmation", MessageBoxButton.YesNo) == MessageBoxResult.Yes)
        {
            Close();
        }
    }
} 
```

并且因为`IInputElement`是接口而不是类，您可以轻松地为您的单元测试创​​建一个模拟类

```
var target = new MyViewModel(new DispatcherMock) 
```

或者你可以使用像 RhinoMocks 这样的模拟库

如需进一步阅读，您可以了解有关如何使用[路由事件的更多信息](http://msdn.microsoft.com/en-us/library/ms742806.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:25:45.330

您可以在 ViewModel 中定义一个操作

```
public Action CloseAction { get; set; } 
```

然后，在您的窗口中（例如在 DataContextChanged 中）您可以设置此操作：

```
((IClosable)viewModel.Content).CloseAction = () => System.Windows.Application.Current.Dispatcher.Invoke(Close()); 
```

好吧，所有这些都是更大的依赖注入模式的一部分，但基本原理在这里......接下来，您只需要从 VM 调用操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T17:58:31.897

此任务有一个有用的行为，它不会破坏 MVVM，这是一种在 Expression Blend 3 中引入的行为，允许 View 挂钩到完全在 ViewModel 中定义的命令。

> 此行为演示了一种允许 ViewModel 管理 Model-View-ViewModel 应用程序中 View 的关闭事件的简单技术。
> 
> 这允许您在视图 (UserControl) 中连接一个行为，该行为将提供对控件窗口的控制，允许 ViewModel 控制是否可以通过标准 ICommands 关闭窗口。
> 
> [使用行为允许 ViewModel 管理 MV-VM 中的视图生命周期](http://reedcopsey.com/2009/10/09/using-behaviors-to-allow-the-viewmodel-to-manage-view-lifetime-in-m-v-vm/)
> 
> [http://gallery.expression.microsoft.com/WindowCloseBehavior/](http://gallery.expression.microsoft.com/WindowCloseBehavior/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T15:14:43.290

如果确实需要，让 ViewModel 执行此操作。

例如，模型说，不再有有效数据

将该信息传递给 ViewModel

ViewModel 认识到，它不能再显示任何东西

然后关闭窗口。

空视图是表示没有更多数据的正常方式

# html - 如何命名表单元素以在 URL 中作为数组提交？

> ID：11036133
> 
> 赞同：0
> 
> 时间：2012-06-14T15:12:44.557
> 
> 标签：html, forms, url

我正在创建一个允许过滤结果的页面。提交表单后，我正在尝试创建一个看起来像这样的 URL：

```
/results/filtered?categories=[1,3,5]&types=[7,8,9] 
```

我有一个看起来像这样的表格：

```
<form action="/results/filtered" method="get">
  Category filters:
  <input type="checkbox" name="categories[]" value="1">
  ...
  <input type="checkbox" name="categories[]" value="5">

  Types:
  ... same sort of thing
  <input type="checkbox" name="types[]" value="9">

  <input type="submit" value="Go">
</form> 
```

但是，当我提交表单时，我得到一个如下所示的 URL：

```
/results/filtered?categories%5B%5D=1&categories%5B%5D=3&categories%5B%5D=5&types%5B%5D=7&types%5B%5D=8&types%5B%5D=9 
```

它有效，但它非常丑陋。如何更改我的表单以便获得漂亮干净的 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:16:34.910

除非您使用 javascript 创建自己的表单预处理器，否则您无法以这种方式控制 url 的格式。

# matlab - Matlab xlsread函数

> ID：11036134
> 
> 赞同：2
> 
> 时间：2012-06-14T15:12:45.607
> 
> 标签：matlab, xlsx

我有包含数字和字母单元格的“data.xlsx”文件。

当我运行这个命令时：

```
 [num,txt,raw] = xlsread('data.xlsx'); 
```

我有：

```
num =

NaN   NaN   NaN  
NaN   NaN     6  
NaN   NaN   NaN  
  4   NaN   NaN  

txt = 

'a'    'd'    'g'
'b'    'e'    '' 
'c'    'f'    'h'
''     ''      '' 
```

有没有办法获得一个包含两者的新变量？就像是：

原始=

```
'a'    'd'    'g'
'b'    'e'    '6' 
'c'    'f'    'h'
'4'     ''      '' 
```

也许通过使用num2str？

**我解决了我的问题，谢谢大家**

在 yuk 的解决方案中，我得到了： ![在此处输入图像描述](../Images/bcd412654a1c2115ebf27d66682314b4.png)

ps我的版本是Matlab 2010a。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:17:00.163

```
[~,~,raw] = xlsread('data.xlsx');
%# find numbers
containsNumbers = cellfun(@isnumeric,raw);
%# convert to string
raw(containsNumbers) = cellfun(@num2str,raw(containsNumbers),'UniformOutput',false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:35:24.173

除了 Alon 的[解决方案](https://stackoverflow.com/a/11036215/163080)`'NaN'`之外，如果输入文件中的单元格为空，则该解决方案将包含带有字符串的单元格。

只需在之后添加`xlsread`：

```
containsNaNs = cellfun(@isnan,raw);
raw(containsNaNs) = {''}; 
```

# java - Java中文件复制期间的异常

> ID：11036135
> 
> 赞同：1
> 
> 时间：2012-06-14T15:12:47.207
> 
> 标签：java, file-copying

我有一个复制二进制文件的功能

```
 public static void copyFile(String Src, String Dst) throws FileNotFoundException, IOException {
    File f1 = new File(Src);
    File f2 = new File(Dst);
    FileInputStream in = new FileInputStream(f1);

    FileOutputStream out = new FileOutputStream(f2);

    byte[] buf = new byte[1024];
    int len;
    while ((len = in.read(buf)) > 0) {
        out.write(buf, 0, len);
    }
    in.close();
    out.close();
} 
```

和第二个功能

```
 private String copyDriverToSafeLocation(String driverPath) {
    String safeDir = System.getProperty("user.home");
    String safeLocation = safeDir + "\\my_pkcs11tmp.dll";
    try {
        Utils.copyFile(driverPath, safeLocation);
        return safeLocation;
    } catch (Exception ex) {
        System.out.println("Exception occured while copying driver: " + ex);
        return null;
    }
} 
```

第二个函数针对系统中找到的每个驱动程序运行。驱动程序文件被复制，我正在尝试使用该驱动程序初始化 PKCS11。如果初始化失败，我会转到下一个驱动程序，我将其复制到 tmp 位置，依此类推。

初始化在 try/catch 块中第一次失败后，我不再能够将下一个驱动程序复制到标准位置。

我得到了例外

```
Exception occured while copying driver: java.io.FileNotFoundException: C:\Users\Norbert\my_pkcs11tmp.dll (The process cannot access the file because it is being used by another process) 
```

如何避免异常并安全地复制驱动程序文件？

对于那些好奇我为什么要复制驱动程序的人... PKCS11 有讨厌的BUG，它阻止使用存储在路径中具有“（”的位置的驱动程序...这是我面临的情况。

我会感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:28:18.947

或者有 Java 7 方式：

```
public static void copyFile(String src, String dst) throws FileNotFoundException, IOException {
  try (FileInputStream in = new FileInputStream(new File(src))) {
    try (FileOutputStream out = new FileOutputStream(new File(dst))) {
      byte[] buf = new byte[1024];
      int len;
      while ((len = in.read(buf)) > 0) {
        out.write(buf, 0, len);
      }
    }
  }
} 
```

编辑：还有 Java 7 NIO 方式。

```
public static void copyFile(String src, String dst) throws FileNotFoundException, IOException {
  copyFile(new File(src), new File(dst));
}

public static void copyFile(File src, File dst) throws FileNotFoundException, IOException {
  try (FileInputStream in = new FileInputStream(src)) {
    try (FileOutputStream out = new FileOutputStream(dst)) {
      copyFile(in, out);
    }
  }
}

public static void copyFile(FileInputStream in, FileOutputStream out) throws IOException {
  FileChannel cin = in.getChannel();
  FileChannel cout = out.getChannel();
  cin.transferTo(0, cin.size(), cout);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:20:19.620

我会将 try-catch 块移到`copyFile`方法中。这样您就可以正确处理关闭`InputStream`s （这可能导致 JVM 保留文件句柄）。像这样的东西：

```
public static void copyFile(String Src, String Dst) {
    try {
        File f1 = new File(Src);
        File f2 = new File(Dst);
        FileInputStream in = new FileInputStream(f1);

        FileOutputStream out = new FileOutputStream(f2);

        byte[] buf = new byte[1024];
        int len;
        while ((len = in.read(buf)) > 0) {
            out.write(buf, 0, len);
        }
    }
    catch(Exception e) {
        System.out.println("Exception occured while copying driver: " + ex);
    }
    finally {
        in.close();
        out.close();
    }
} 
```

然后，您可以从方法中删除 try-catch `copyDriverToSafeLocation`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:39:07.957

如果文件被其他进程使用并被锁定，则没有通用的解决方案可以访问它。你最好的机会是使用[FileLock](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileLock.html)，但它依赖于平台，阅读文档，它写的结果是“建议性的”，所以要小心。您还可以查看[ReentrantReadWriteLock 类](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:29:39.410

我不确定为什么一个文件的问题会阻止复制*另一个*文件。但是，发生异常时不关闭文件肯定会导致问题。使用 try...finally 确保在打开的每个文件上调用 close。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T15:23:30.663

我会选择使用 Apache Commons IO 和他们的 FileUtils.copyFile() 例程。

[用Java复制文件的标准简洁方法？](https://stackoverflow.com/questions/106770/standard-concise-way-to-copy-a-file-in-java)

# delphi - 更改 TAchart 系列的背景颜色

> ID：11036137
> 
> 赞同：2
> 
> 时间：2012-06-14T15:12:49.650
> 
> 标签：delphi, lazarus

我有这个代码来绘制一个平面图的轮廓。

```
 Chart1.Series.Clear;
  Lser:=TLineSeries.Create(Chart1);
  for x:= 1 to 20 do
  Lser.AddXY(strtofloat(stringgrid1.Cells[1,x]),strtofloat(stringgrid1.Cells[2,x]));
  chart1.AddSeries(Lser);
  lser.LinePen.Width:=2;
  lser.SeriesColor:=clred; 
```

现在，如何更改我的平面图的背景颜色？非常感谢

如果你看到图片，我只想画黄色区域（我把它填在窗户的油漆上） ![在此处输入图像描述](../Images/74bbd357bd0baddc0e465d70ebd2b0fb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:27:39.880

谢谢大家，我用 TAreaSeries 解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T17:25:47.237

```
chart1.Backwall.Transparent := False;
chart1.Backwall.Color := clgreen; 
```

# android - 有什么方法可以使用 java 代码读取出现在我的 android 主屏幕通知选项卡中的通知？

> ID：11036138
> 
> 赞同：0
> 
> 时间：2012-06-14T15:12:50.713
> 
> 标签：android, notifications

android 主页显示来自不同应用程序的通知。我想使用我的程序阅读这些通知。我试图在论坛和android帮助中找到相关信息，但我找不到任何信息。

我的实际目标是阅读通知，如果通知是关于来自某个人的电子邮件，那么我想在我的应用程序中执行一些操作。（我使用 touch down 为我的电子邮件）任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T06:13:29.867

您需要创建一个[AccessibilityService](http://developer.android.com/reference/android/accessibilityservice/AccessibilityService.html)并将其设置为侦听 TYPE_NOTIFICATION_STATE_CHANGED 事件。这样，每次在配置 AccessibilityService 时指定的任何应用程序包生成新通知时，都会调用您的服务的 onAccessibilityEvent 回调，其中包含有关通知的所有信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:17:59.373

由于安全原因，不可能。

如果你想响应事件，那么你应该尝试直接用意图来监听它们。

# iphone - Xcode 4 - 丢失的证书和配置文件，我该如何恢复

> ID：11036141
> 
> 赞同：1
> 
> 时间：2012-06-14T15:13:01.223
> 
> 标签：iphone, xcode4, sdk

我最近在我的 Macbook Pro 上崩溃了。光盘已损坏且无法启动。一张新光盘与 Snow Leopard 和 Xcode 4 一起安装。我还从备份中恢复了 4 个（已发布）应用程序和一个正在开发的应用程序。除了我没有开发证书和配置文件之外，一切都安全且正常工作。我已将 iPhone 连接到我的机器和 Team Provisioning Profile，目前正在开发的应用程序的特定配置文件似乎已从设备中恢复，但我不确定如何恢复证书，或者是否创建一个新的（已发布 - 分发 - 应用程序配置文件已过期，所以我不关心它们）一个。我目前收到每个配置文件的“未找到有效签名身份”消息。我需要一些帮助/建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:30:46.180

正如 Owl 所说，前往 developer.apple.com 上的 Developer Portal，然后单击 iOS Provisioning Portal。然后，您可以从左侧窗格重新下载您的证书和配置文件。通过 Keychain Access 安装您的证书，并将您的配置文件拖到 Xcode 中（它们应该出现在 Organizer 中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:16:11.840

转到 Apple Developer Portal 并再次下载您的证书。

# html - 如果加载第二个视频而两者之间没有黑框，如何更改 html5-video-source？

> ID：11036147
> 
> 赞同：0
> 
> 时间：2012-06-14T15:13:22.813
> 
> 标签：html, html5-video

我最近正在处理一个交互式视频项目，用户可以在其中与视频进行交互（在某个人的视频中单击，以查看新视频，用户要去那个人......）。更改视频源不是问题（检查下面的代码），但我的问题发生在步骤“A”和“C”之间

我正在清除当前源 (A)，创建一个新源 (B) 并开始新视频 (C)，它向我显示了“A”和“C”之间视频元素的黑色背景。不是很长，比方说<50ms，但它仍然让我很紧张。我唯一的想法是，如果下一个视频准备好播放，则使用两个视频元素并切换它们。有人有更好的主意吗？

```
playVideoElement:function( videoelement ){

    //empty current source nodes  (A)
    ($(this.videoPlayer).getChildren()).dispose();

    //set new source  (B)
    this.videoPlayer.adopt( new Element('source').setProperties( ... ) );

    //start new video  (C)
    this.videoPlayer.load();
    this.videoPlayer.play();

} 
```

所以基本上我的问题是：有没有办法为可以播放的视频元素设置一个新的源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T05:59:22.920

你能设置两个 div，一个用于当前源，另一个用于新源。使用 css 将第二个设置为隐藏，并将其 autoplay 设置为 false，preload 设置为 none。当你需要切换视频时，只需隐藏第一个（删除div也可以），显示第二个div，加上加载和播放第二个视频？

# jquery - jQuery UI 将类和属性添加到我不需要的 html 代码中

> ID：11036152
> 
> 赞同：0
> 
> 时间：2012-06-14T15:13:44.923
> 
> 标签：jquery, jquery-ui

我添加了对 jQuery UI 库的引用，它正在修改页面上的 html。只需添加对 jQuery-ui.min.js 文件的引用，我的 HTML 就会被修改。

即没有参考我看到这个：

`<div id="myMenu">`

在对 jQuery UI 库的 js 引用之后，我看到以下内容：

`<div id="myMenu" class="ui-menu ui-widget ui-widget-content ui-corner-all" role="listbox" aria-activedescendant="ui-active-menuitem">`

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:31:38.857

解决了。所以我创建了一个名为 menu 的插件，并通过类似 $('mymenu').menu({....}); 的方式将它应用到我的有序列表中。在我添加对 jquery-ui 的引用后，它还必须有一个插件“菜单”，因此它正在向我的列表 html 元素添加各种 css 类和属性。

我需要重命名我的自定义插件以更适合我（即 appmenu）。

# java - 当我们在父表中有一行时，使用 jpa 在子表中创建行

> ID：11036155
> 
> 赞同：0
> 
> 时间：2012-06-14T15:13:52.860
> 
> 标签：java, jpa, jpa-2.0

我有 2 张桌子：

```
CREATE TABLE `addr1` (
  `id` int(11) DEFAULT NULL,
  `addr2` varchar(20) DEFAULT NULL
) ENGINE=InnoDB;

CREATE TABLE `address` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `address` varchar(250) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB; 
```

的主键`addr1`是从地址表中设置的。我使用联合继承创建了我的实体

```
@Entity
@Table(name="addr1")
public class Addr1 extends Address {
    @Column(name="addr2")
    private String addr2;
    // getters and setters follows
}

@Entity
@Table(name = "address")
@Inheritance(strategy=InheritanceType.JOINED)
public class Address implements Serializable {

    @Id
    @GeneratedValue
    @Column(name = "id")
    private int id;

    @Column(name = "address", nullable = false, length = 250, insertable = true)
    private String address;
    // getters and setters follows
} 
```

现在我在地址表中有一行 ID 为 2。我想在 addr1 表中插入一行 ID 相同 (2)。我试过

```
Address addr = em.getReference(Address.class, new Integer(4));
Addr1 addr1 = new Addr1(addr);
addr1.setAddr2("dsdsd");
em.persist(addr1); 
```

但我收到一个错误

> javax.persistence.PersistenceException：org.hibernate.PersistentObjectException：分离的实体传递给坚持：Addr1

请帮我。

问候， 普拉文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T05:49:21.733

不可能。继承意味着一种*is-a*关系。因此，您的实体实例可以是裸机`Address`，也可以是`Addr1`. Java 对象不能改变它的类型。您不能获取 Object 类型的对象，并要求 JVM 更改其类型并使其成为 String 类型的对象。这里也一样。

如果你需要这样做，那么你应该使用组合，而不是继承：一个地址可以*有*一个 Addr1。因此，您应该在 Address 和 Addr1 之间有一个 OneToOne 关联，而不是继承关系。

# java - 正则表达式贪婪解析方向

> ID：11036156
> 
> 赞同：3
> 
> 时间：2012-06-14T15:13:57.800
> 
> 标签：java, javascript, python, regex, perl

我发现关于如何执行贪婪的正则表达式有两种不同的看法：

*   一种是，读取所有输入字符串并从后面匹配模式，首先匹配整个输入，第一次尝试是整个字符串。一些支持这种观点的文章是[Oracle 官方 Java 教程](http://docs.oracle.com/javase/tutorial/essential/regex/quant.html)：

> 贪婪量词被认为是“贪婪的”，因为它们强制匹配器在尝试第一次匹配之前读入或吃掉整个输入字符串。如果第一次匹配尝试（整个输入字符串）失败，匹配器将输入字符串回退一个字符并再次尝试，重复该过程直到找到匹配或没有更多字符可以回退。

另请参阅这篇文章：[贪婪与惰性正则表达式量词的性能](http://blog.stevenlevithan.com/archives/greedy-lazy-performance)

*   另一个是从前面匹配，第一次匹配尝试是从左边的 0 索引开始。当找到匹配时，引擎不会停止，继续匹配其余的，直到它失败然后它会回溯。文章支持我发现的这个观点是：

[与 Star 和 Plus](http://www.regular-expressions.info/repeat.html)的 重复`Looking Inside The Regex Engine`部分讨论`<.+>`：

> 正则表达式中的第一个标记是 <。这是字面意思。正如我们已经知道的，它将匹配的第一个位置是字符串中的第一个 <。

我想知道哪个是正确的？这很重要，因为它会影响正则表达式的效率。我添加了各种语言标签，因为我想知道每种语言的实现方式是否不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:18:31.440

假设它们在功能上是等效的（并且基于我的 Java 正则表达式使用，它们是），这只是引擎实现的不同。正则表达式在所有语言中的实现方式并不完全相同，并且根据您使用的语言可能或多或少地强大。

第二个链接描述了 Perl，所以我相信 Oracle 在 Java 方面。

两者都试图获得*最大*的匹配。

通过添加键使量词变得惰性`?`将尝试尽可能*小*的匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:25:26.123

在不同的环境和编程语言中实现正则表达式不必相同，因此您的问题没有确切的答案。

如果你使用**Perl**，那么你应该知道**正则表达式**的实现**是**非常**优化**的，因为这是这种编程语言最强大的特性之一。所以，不用担心效率:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:41:35.850

没有区别，也没有暗示“从背后匹配”。当第一个引用说“匹配器”时，它表示重复的正则表达式原子，而不是整个表达式 - 即当匹配`/ab+/`“方丈”时，我们不知道先验*不会*`b+`匹配整个字符串的其余部分。我认为 Java 教程可能正在讨论正则表达式匹配*流*的行为，并指出贪婪的重复会急切地消耗流的其余部分，而非贪婪的重复会根据需要懒惰地消耗流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T17:23:46.660

“匹配器将输入字符串回退一个字符并重试”只是描述回溯，因此“然后它会回溯”是说同样的事情。由于您关于贪婪的两个引述都说同样的话，因此两者都是正确的。（您的第三句话与贪婪无关。）

* * *

让我们举个例子。

```
'xxabbbbbxxabbbbbbbbb' =~ /([ab]*)bb/; 
```

1.  在位置 0 尝试。
    1.  `[ab]*`匹配 0 个字符“”。
        1.  在位置 0，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*`不能再匹配了⇒回溯。
2.  在位置 1 尝试。
    1.  `[ab]*`匹配 0 个字符“”。
        1.  在位置 1，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*`不能再匹配了⇒回溯。
3.  在位置 2 尝试。
    1.  `[ab]*`匹配 6 个字符“ `abbbbb`”。
        1.  在位置 8，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*`匹配 5 个字符“ `abbbb`”。（退一步）
        1.  在位置 7，`bb`匹配失败⇒ 回溯。
    3.  `[ab]*`匹配 4 个字符“ `abbb`”。（退一步）
        1.  在第 6 位，`bb`比赛。
            1.  成功。

所以 1 美元是“abbb”。（不是`abbbbbbb`。“贪婪”并不意味着“可能的最长匹配”。）

* * *

现在，让我们看看如果我们让“*”不贪婪会发生什么。

```
'xxabbbbbxxabbbbbbbbb' =~ /([ab]*?)bb/; 
```

1.  在位置 0 尝试。
    1.  `[ab]*?`匹配 0 个字符“”。
        1.  在位置 0，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*`不能再匹配了⇒回溯。
2.  在位置 1 尝试。
    1.  `[ab]*?`匹配 0 个字符“”。
        1.  在位置 1，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*`不能再匹配了⇒回溯。
3.  在位置 2 尝试。
    1.  `[ab]*?`匹配 0 个字符“”。
        1.  在位置 2，`bb`匹配失败⇒ 回溯。
    2.  `[ab]*?`匹配 1 个字符“ `a`”。（添加一个）
        1.  在位置 3，`bb`匹配。
            1.  成功。

所以 1 美元是“a”。

* * *

特定的实现可能会以不同的方式进行优化，只要它给出的结果与此处显示的相同。你可以看到 Perl 在工作中使用

```
perl -Mre=debug -E'say "xxabbbbbxxabbbbbbbbb" =~ /([ab]*)bb/;'
perl -Mre=debug -E'say "xxabbbbbxxabbbbbbbbb" =~ /([ab]*?)bb/;' 
```

# android - Android：用于布局的三星 Galaxy S3 屏幕尺寸

> ID：11036158
> 
> 赞同：18
> 
> 时间：2012-06-14T15:14:01.107
> 
> 标签：android, android-layout, android-screen

有人在测试三星 Galaxy S3 吗？具体来说，它是否具有用于布局目的的大屏幕或普通屏幕？我有 Galaxy Nexus，它采用正常布局，但我读到 Galaxy Note 被认为是大屏幕。提前致谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-25T13:53:18.633

作为三星 Galaxy S3 的所有者，我确认 - 这是“普通”屏幕，而不是“大”屏幕。在密度方面也是“xhdpi”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-09T12:02:28.750

三星 S3 仅从 drawable-sw360dp 中获取图像，从 layout-sw360dp 文件夹中获取布局文件...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-14T15:19:28.217

这是欧洲版三星 Galaxy S3 完整规格的[链接。](http://www.gsmarena.com/samsung_i9300_galaxy_s_iii-4238.php)屏幕为 720 x 1280 像素和 4.8 英寸对角线。就屏幕而言，美国版是相同的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:19:52.023

如果没有指定其他手机，默认情况下所有手机都会使用 drawable 文件夹，但官方应该使用 xhdpi 和 hdpi

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-22T16:10:50.570

为 Galaxy S3 创建一个指定布局。[Android S3 布局与 Galaxy Nexus 布局](https://stackoverflow.com/questions/11699761/android-s3-layout-vs-galaxy-nexus-layout/12557007#12557007)

# mysql - MySQL - 使用 CHAR_LENGTH 条件更新

> ID：11036159
> 
> 赞同：0
> 
> 时间：2012-06-14T15:14:02.210
> 
> 标签：mysql, sql-update

我有数千行包含一个包含`zipcode`四个整数的属性。有些行包含五个整数，而另一些包含两个或三个整数。

我想要做的是在**只包含四个整数的行**之前添加一个 0 。表名`zipcode`和属性也是。

**我想更新行而不是显示它们！**

我尝试了这段代码，但没有成功（不影响行）：

```
UPDATE zipcode
SET zipcode = CONCAT('0', zipcode)
WHERE CHAR_LENGTH(zipcode) = 4 
```

顺便说一句，我可以在简单的选择中使用 CHAR_LENGTH，它可以工作：

```
SELECT *
FROM zipcode
WHERE CHAR_LENGTH(zipcode) = 4 
```

所以，似乎在我的条款`CHAR_LENGTH`中不起作用。`WHERE`

编辑：`zipcode`是一个整数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:07:00.130

听起来您将邮政编码存储为 int，但您确实想将其视为 char。

在这种情况下，您有几个选择：

1) 更改列的数据类型，然后使用 0 对左填充执行更新：

```
alter table zipcode
  modify column zipcode char(5) not null;

update zipcode
set zipcode = lpad(zipcode,5,'0')
where char_length(zipcode) < 5; 
```

2) 保持数据类型不变，只需在 select 语句中通过左填充 0 格式化检索数据：

```
select lpad(zipcode,5,'0')
from zipcode; 
```

## [演示](http://sqlfiddle.com/#!2/30c4f/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:22:49.013

我相信变量的数据类型`zipcode`是 INT 并且您想以 5 位格式显示所有邮政编码。要做到这一点，请在下面使用。

```
SELECT zipcode as Actual, 
       CASE CHAR_LENGTH(zipcode)
       WHEN 1 THEN CONCAT('0000', zipcode)
       WHEN 2 THEN CONCAT('000', zipcode)
       WHEN 3 THEN CONCAT('00', zipcode)
       WHEN 4 THEN CONCAT('0', zipcode)

       END AS "Final"
FROM zipcode 
```

## [演示](http://sqlfiddle.com/#!2/30c4f/1)

# wpf - 如何修改 ControlTemplate 以将项目直接添加到我的自定义控件

> ID：11036162
> 
> 赞同：1
> 
> 时间：2012-06-14T15:14:04.423
> 
> 标签：wpf, wpf-controls, custom-controls, control-template

我为我的自定义控件定义了以下控件模板。

```
<ControlTemplate TargetType="{x:Type local:CustomControl}">
    <Grid x:Name="MainGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <local:CustomPanel x:Name="MyCustomPanel" Grid.Column="0" />
        <ScrollBar Grid.Column="1" Width="20" />
    </Grid>
</ControlTemplate> 
```

这里的 CustomPanel 派生自 Panel 类。现在我不能像这样直接将项目添加到我的 CustomControl

```
<local:CustomControl x:Name="CControl" Grid.Row="1">
    <Button/>
    <Button/>
    <Button/>
</local:CustomControl> 
```

如何直接从 XAML 将项目添加到我的自定义控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:26:38.377

在您的 CustomControl 上使用`[ContentProperty(`*PropertyName 。*`)]`

并且：确保内容属性初始化为一个空列表（不能是`null`）。

例如：

```
[ContentProperty("Items")]
public class CustomControl : UserControl
{

    public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(UIElementCollection), typeof(CustomControl), new UIPropertyMetadata(null)));

    public UIElementCollection Items     
    {     
        get { return (UIElementCollection) GetValue(ItemsProperty); }     
        set { SetValue(ItemsProperty, value); }     
    }   

    public CustomControl()
    {
        Items = new UIElementCollection();
    }

} 
```

**重要提示：**不要在依赖属性注册中创建空集合，即不要使用这个：

```
... new UIPropertyMetadata(new UIElementCollection()) 
```

这被认为是不好的做法，因为您会无意中创建一个单例集合。有关详细信息，请参阅[集合类型依赖属性。](http://msdn.microsoft.com/en-us/library/aa970563.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:29:28.870

这是一个示例控件，可让您以您所追求的方式直接添加内容。

这里感兴趣的行是 MyCustomControl 类顶部的属性，它告诉 XAML 编辑器应将任何直接添加的内容放在哪个属性中。

在 XAML 代码中，重要的一行是绑定到 Items 属性的 ItemsControl，它实际上显示了每个项目。

C＃

```
[ContentProperty("Items")]
public class MyCustomControl : Control
{
    public ObservableCollection<Object> Items
    {
        get { return (ObservableCollection<Object>)GetValue(ItemsProperty); }
        set { SetValue(ItemsProperty, value); }
    }

    public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(ObservableCollection<Object>), typeof(MyCustomControl), new UIPropertyMetadata(new ObservableCollection<object>()));        
} 
```

XAML

```
<Style TargetType="{x:Type local:MyCustomControl}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:MyCustomControl}">
                <ItemsControl ItemsSource="{TemplateBinding Items}"  />
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<local:MyCustomControl>
    <Button />
    <Button />
</local:MyCustomControl> 
```

# c# - 如何在 C# 中使用鼠标选择 PictureBox.Image 上的区域

> ID：11036168
> 
> 赞同：14
> 
> 时间：2012-06-14T15:14:27.940
> 
> 标签：c#, .net, winforms, system.drawing

我只是想在我的picturebox.image 上放一个选择，但这比一些烦人的情况更糟。我想到了主图片框上方的另一个图片框，但它对我来说似乎很懒惰。我需要知道是否有一种方法可以在图片框上创建一个选择区域（将是半透明的蓝色区域）。我要用鼠标绘制它，它不应该改变我正在处理的图像。

样本：

```
 // Start Rectangle
    //
    private void pictureBox1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        // Determine the initial rectangle coordinates...
        RectStartPoint = e.Location;
        Invalidate();
    }

    // Draw Rectangle
    //
    private void pictureBox1_MouseMove(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        if (e.Button != MouseButtons.Left)
            return;
        Point tempEndPoint = e.Location;
        Rect =
            new Rectangle(
                Math.Min(RectStartPoint.X, tempEndPoint.X),
                Math.Min(RectStartPoint.Y, tempEndPoint.Y),
                Math.Abs(RectStartPoint.X - tempEndPoint.X),
                Math.Abs(RectStartPoint.Y - tempEndPoint.Y));
        Invalidate(Rect);
    }

    // Draw Area
    //
    private void pictureBox1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
    {
        // Draw the rectangle...
        if (pictureBox1.Image != null)
        {
            Brush brush = new SolidBrush(Color.FromArgb(128, 72, 145, 220));
            e.Graphics.FillRectangle(brush, Rect);
        }
    } 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-18T06:07:04.450

我用了你的代码，你快到了。您需要使 pictureBox1 而不是矩形无效。我还添加了对 Rect 的检查，因此它在未初始化或没有大小时不会被绘制。

另一个重要的变化：我只创建了一次矩形，我调整了它的位置和大小。少清理垃圾！

**编辑**

我为矩形添加了鼠标右键单击处理程序。

```
private Point RectStartPoint;
private Rectangle Rect = new Rectangle();
private Brush selectionBrush = new SolidBrush(Color.FromArgb(128, 72, 145, 220));

// Start Rectangle
//
private void pictureBox1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e)
{
    // Determine the initial rectangle coordinates...
    RectStartPoint = e.Location;
    Invalidate();
}

// Draw Rectangle
//
private void pictureBox1_MouseMove(object sender, System.Windows.Forms.MouseEventArgs e)
{
    if (e.Button != MouseButtons.Left)
        return;
    Point tempEndPoint = e.Location;
    Rect.Location = new Point(
        Math.Min(RectStartPoint.X, tempEndPoint.X),
        Math.Min(RectStartPoint.Y, tempEndPoint.Y));
    Rect.Size = new Size(
        Math.Abs(RectStartPoint.X - tempEndPoint.X),
        Math.Abs(RectStartPoint.Y - tempEndPoint.Y));
    pictureBox1.Invalidate();
}

// Draw Area
//
private void pictureBox1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
{
    // Draw the rectangle...
    if (pictureBox1.Image != null)
    {
        if (Rect != null && Rect.Width > 0 && Rect.Height > 0)
        {
            e.Graphics.FillRectangle(selectionBrush, Rect);
        }
    }
}

private void pictureBox1_MouseUp(object sender, MouseEventArgs e)
{
    if (e.Button == MouseButtons.Right)
    {
        if (Rect.Contains(e.Location))
        {
            Debug.WriteLine("Right click");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-01-10T12:48:07.557

```
 private int xUp, yUp, xDown,yDown;
        private Rectangle rectCropArea;
   private void SrcPicBox_MouseUp(object sender, MouseEventArgs e)
        {
            //pictureBox1.Image.Clone();
            xUp = e.X;
            yUp = e.Y;
            Rectangle rec = new Rectangle(xDown,yDown,Math.Abs(xUp xDown),Math.Abs(yUp-yDown));
            using (Pen pen = new Pen(Color.YellowGreen, 3))
            {

                SrcPicBox.CreateGraphics().DrawRectangle(pen, rec);
            }
            rectCropArea = rec;
        }
 private void SrcPicBox_MouseDown(object sender, MouseEventArgs e)
        {
            SrcPicBox.Invalidate();

            xDown = e.X;
            yDown = e.Y;
        }
 private void btn_upload_Click(object sender, EventArgs e)
        {
            OpenFileDialog opf = new OpenFileDialog();
          //  PictureBox SrcPicBox = new PictureBox();
            opf.Filter = "ALL images(*.*)|*.*";
            if (opf.ShowDialog() == DialogResult.OK)
            {
                string name = opf.SafeFileName;
                string filepath = opf.FileName;
                File.Copy(filepath, name, true);
                SrcPicBox.Image = Image.FromFile(opf.FileName);
            }
 private void btn_crop_Click(object sender, EventArgs e)
        {
            pictureBox3.Refresh();
            //Prepare a new Bitmap on which the cropped image will be drawn
            Bitmap sourceBitmap = new Bitmap(SrcPicBox.Image, SrcPicBox.Width, SrcPicBox.Height);
            Graphics g = pictureBox3.CreateGraphics();

            //Draw the image on the Graphics object with the new dimesions
            g.DrawImage(sourceBitmap, new Rectangle(0, 0, pictureBox3.Width, pictureBox3.Height), rectCropArea, GraphicsUnit.Pixel);
            sourceBitmap.Dispose();
        } 
```

# batch-file - 确保应用程序在批处理文件中关闭

> ID：11036170
> 
> 赞同：0
> 
> 时间：2012-06-14T15:14:38.697
> 
> 标签：batch-file, video-processing

具体来说，我在批处理文件中使用 DGIndex 作为序列的一部分来进行一些视频编码。

尽管接受 CLI 参数，但 DGIndex 会弹出一个窗口来进行处理。完成后它会消失，但命令行会挂起，就好像它仍然打开一样。该进程不再运行。

是否有内置的东西可以确保它不会挂起，或者是否有第三方代理实用程序可以监视进程结束然后自行关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-01-29T19:05:15.103

我在批处理文件中遇到了与 DGIndex 相同的问题。我知道这是一个老问题，但似乎 DGIndex 从那时起就没有更新过，所以这可能仍然是相关的。

DGIndex 有 2 种不同的命令行“样式”，在手册中称为*legacy*（一种使用大写字母进行设置），另一种*UNIX 样式*（小写字母）。

对我来说，UNIX 风格命令行的“-exit”命令不起作用，因此批处理文件没有收到来自 DGIndex 的相应消息，即使它正确完成了它的工作。我改用*旧版*命令，问题就消失了。

“有趣”的是 Dan 对*遗留*命令有问题，所以反过来。

问候，迈克。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T18:41:33.847

如果使用`start`，批处理文件*应*在启动 dgindex 应用程序后立即返回。

您可以将**`/WAIT`**标志传递`start`给它，告诉它等到进程退出后再移动到批处理文件的下一行。

```
start /WAIT dgindex -BF=[vob.txt] -FO=0 -IA=2 -OM=2 -TN=0 -OF=[out] -HIDE -EXIT 
```

我知道这是旧的，但你有没有弄明白？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T10:49:48.723

你可以使用这样的东西：

```
@echo off
echo Running program
start dgindex -BF=[vob.txt] -FO=0 -IA=2 -OM=2 -TN=0 -OF=[out] -HIDE -EXIT
ping 127.0.0.1 -n 10
taskkill /im dgindex.exe /f
exit >nul 
```

这个批处理文件基本上运行 DGIndex 程序，然后在尝试关闭程序之前暂停 10 秒。只需将 10 替换为您选择的延迟，足够长的时间，如果程序仍在运行，则意味着它已崩溃，然后它将在延迟后关闭。

我很确定您无法判断程序是否已挂起（至少无论如何都不是批量）。如果它确实崩溃了，如果您需要再次运行它，这至少可以确保它没有运行。

希望这可以帮助！

# javascript - 使用命令检查 JavaScript 的语法

> ID：11036175
> 
> 赞同：12
> 
> 时间：2012-06-14T15:14:49.203
> 
> 标签：javascript, node.js

是否有相当于`perl -c`从命令对 JavaScript 进行语法检查的功能？鉴于我安装了 NodeJS？

不考虑 JSLint，因为它不是真正的解析器。我认为 YUI 压缩器是可能的，但我不想在生产机器上安装 Java，所以我正在检查 Node.JS 是否已经提供了这种语法检查机制。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T13:36:30.680

试试~~丑化~~。你可以通过 npm 安装它。

编辑：包名称已更改。它是**uglify-js**。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-24T22:02:08.783

@瑞安

如果您想像我们在 perl（另一种脚本语言）中那样执行语法检查，您可以简单地使用。节点-c

例如，一个 js 文件作为 test.js 有 -

```
let x = 30
if ( x == 30 ) {
  console.log("hello");
else {
  console.log( "world");
} 
```

现在输入`node -c test.js` 它会告诉你

```
test.js:5
 else {
 ^^^^
SyntaxError: Unexpected token else
    at startup (bootstrap_node.js:144:11)
    at bootstrap_node.js:509:3 
```

现在将语法问题修复为

```
let x = 30
if ( x == 30 ) {
  console.log("hello");
} else {
  console.log( "world");
} 
```

检查语法 -`node -c test.js`不会显示语法错误！！

**注意**- 我们甚至可以使用它来检查目录中所有文件的语法。-`node -c *.js`

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-03T05:36:24.597

经过进一步的研究，我很遗憾撤销了那次否决票。

```
nodejs --help 
```

解释 -p 开关：它评估提供的代码并打印结果。因此，使用 nodejs -p < /path/to/file.js 将是检查服务器上 node.js 代码有效性的灾难性方法。一种可能的解决方案是[此](https://stackoverflow.com/questions/20097761/in-node-js-how-do-you-check-whether-a-given-string-of-code-is-syntactically-cor)SO 线程中指示的解决方案。关于它的一件事不太好 - 它报告的语法错误消息并不是很有帮助。例如，它告诉你出了什么问题，但没有告诉你**哪里**错了。

# php - 查找由 php 函数创建的页面

> ID：11036182
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:15:05.257
> 
> 标签：php, html

我正在尝试使用在另一个页面上的表单中收集的数据生成一个 HTML 页面。我在 html 页面上有这个标签，格式如下：

```
<html>
<body>

<meta http-equiv="cache-control" content="private" > 
<link rel="stylesheet" type="type/css" href="vytran_css.css" />

<head> New Product Introduction </head>

<p> In order to begin the process of introducing a new product, please complete
the following form. Once you are satisfied with your responses to the various 
prompts, please click on the submit button at the bottom of the page. If you 
would like to start over, click the Reset button. If you have any questions, 
Please follow the link that says "Help".

<form action="html_data.php" id=from1 method="post"> 
Product Name: 
<input name="Name" size="20" type="text">
<br><br>

Project Lead Name:
<input name="PLname" size="20" type="text"> <br><br>

Team-members: <br>
<textarea name="Team-members" rows=10 cols=40 type="text"> </textarea> <br><br>

Product Type: <br>
<input name="Product Type" size="20" type="text"> <br><br>

Description: <br>
<textarea name="Description" rows=10 cols=40 type="text"> </textarea>
<br>

<br> <br>

<input value="Submit" type="submit" name="formSubmit">
<input value="Reset" type="reset">
<input value="Help" type="button" onclick="window.location.href='problems.html'">
</form>
</p>

</body>
</html> 
```

在 html_data.php 页面上，我有以下内容：

```
<?php 
    ob_start(); // start trapping output 
    $name = @$_POST['Name']; 
?> 
<html> 
<body> 
<p> 
Product Name: <?php echo $Name; ?><br> 
Project Lead: <?php echo $PLname; ?><br> 
Team Members: <?php echo $Team-members; ?><br> 
Description: <?php echo $Description; ?> 
</p> 
</body> 
</html> 
<?php 
    $output = ob_get_contents();  
    $newfile="output.txt";  
    $file = fopen ($newfile, "w");  
    fwrite($file, $output);  
    fclose ($file);   
    ob_end_clean();  
?> 
```

这应该做我要求它做的事情。表单提交没有问题，但提交后我找不到页面。知道我需要改变什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:01:28.167

**以你的形式**

从改变

`<textarea name="Team-members" rows=10 cols=40 type="text">`

至

`<textarea name="Team_members" rows=10 cols=40 type="text">`

在你的**html_data.php**

从改变

`<?php echo $Team-members; ?>` **至** `<?php echo $Team_members; ?>`

团队和成员之间的**冲刺显然存在问题。**

*   PHP 将连字符视为数学运算，即减号。

*   即：团队**减去**成员

然后，如果您希望`echo`在提交后筛选数据，请添加

```
echo $output; 
```

下`ob_end_clean();`

**这对我有用。**

# sql - sp_executesql 保护动态搜索关键字

> ID：11036183
> 
> 赞同：0
> 
> 时间：2012-06-14T15:15:09.523
> 
> 标签：sql, sql-server

我正在尝试将 SQL 语句转换为支持 sp_executesql 以使其安全，但我遇到了一个不安全的区域。希望你们能帮助我解决这个问题。我创建了临时表以便更容易地演示问题。

问题出在第 6 步。我可以使用第 5 步，但这并不安全，而且很容易被黑客入侵。由于系统性能，我真的不想破坏关键字并多次搜索。

MS SQL 2008 错误消息 4145，级别 15，状态 1，第 4 行 在预期条件的上下文中指定的非布尔类型表达式，靠近“ORDER”。

```
GO
/****** Object:  StoredProcedure [dbo].[ups_MultiWareHouse]    Script Date: 06/14/2012 09:12:38 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
create PROCEDURE ups_TestSearch(
@Keywords nvarchar(4000),
@SortColumns nvarchar(4000)
)
AS
--STEP #1 - Create Temp Table - Begin
    CREATE TABLE #TempTable 
    (
        ProductID uniqueidentifier,
        ProductName varchar(600),
        Price decimal(18,2),
        Active bit
    )

--STEP #2 - Insert couple records to search
    INSERT INTO #TempTable (ProductID,ProductName,Price,Active) VALUES(NEWID(),'Mouse','10.12','1')
    INSERT INTO #TempTable (ProductID,ProductName,Price,Active) VALUES(NEWID(),'Keyboard','20.45','1')
    INSERT INTO #TempTable (ProductID,ProductName,Price,Active) VALUES(NEWID(),'Monitor','150.87','0')--Disable this product

--STEP #3 - Display the current table data
        select 'STEP #3' as STEP,   * FROM #TempTable

--STEP #4 - SETTING UP sp_executesql to support parameter substitution
    --Set definition
    DECLARE @ParmDefinition nvarchar(4000);
    SET @ParmDefinition='
                        @Param1ProductName nvarchar(4000),
                        @Param2SortColumns nvarchar(4000)
                        '                   
    DECLARE @SQLString nvarchar(4000);

--STEP #5-  CONVERT THE @SQLString TO use @Keywords and @SortColumns
    --Run query for the below like this ups_TestSearch'ProductName=''Mouse'' OR ProductName=''Keyboard''', 'Price DESC, ProductName ASC'
    SET @SQLString = N'SELECT ''STEP #5'' as STEP, #TempTable.*  FROM #TempTable WHERE ('+@Keywords+') ORDER BY '+@SortColumns;--unsafe, open to hackers
    EXECUTE sp_executesql @SQLString, @ParmDefinition, @Param1ProductName = @Keywords, @Param2SortColumns=@SortColumns;

--STEP #6-  CONVERT THE @SQLString TO use @Keywords and @SortColumns
    --Run query for the below like this ups_TestSearch'ProductName=''Mouse'' OR ProductName=''Keyboard''', 'Price DESC, ProductName ASC'    
    SET @SQLString = N'SELECT ''STEP #6'' as STEP, #TempTable.*  FROM #TempTable WHERE (@Param1ProductName)  ORDER BY @SortColumns';--Safe but not working
    SELECT @SQLString AS SeeStatement
    EXECUTE sp_executesql @SQLString, @ParmDefinition, @Param1ProductName = @Keywords, @Param2SortColumns=@SortColumns;

--Drop temp table
DROP TABLE #TempTable 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:46:45.093

我认为问题在于在第 5 步中您没有使用参数替换——也就是说，您基本上是通过字符串连接来构建 SQL 语句。当您通过 sp_executesql 执行它时，您实际上可以这样做：

```
EXECUTE sp_executesql @SqlString 
```

第 6 步中的代码正在执行参数替换。但是，在这种情况下，您只能在“正常”SQL 表达式中允许使用参数的位置使用参数。例如，你不能在 T-SQL 中这样做：

```
DECLARE @Criteria NVARCHAR(500);
SET @Criteria = N' WHERE ProductName = ''Mouse'''
SELECT * FROM #MyTempTable + @Criteria 
```

根据您期望过滤器的复杂程度，您可能能够将条件写入临时表并与临时表执行连接以限制返回的结果数据。我不知道如何最好地对结果数据进行排序，除非你在调用代码中这样做了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T17:24:52.650

您的错误消息表明`WHERE`步骤 6 中的子句无效，该`ORDER BY`子句也是如此。这是因为您将字符串作为参数传递给`sp_executesql`并尝试将它们用作整个子句。此外，该语句引用了一个参数`@SortColumns`，但您似乎已经命名了该参数`@Param2SortColumns`。

阅读一些 SQL Server MVP 所写的内容：

[http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

更重要的是：http: [//www.sommarskog.se/dyn-search.html](http://www.sommarskog.se/dyn-search.html)

[http://www.sqlmag.com/article/tsql3/parameterizing-result-order](http://www.sqlmag.com/article/tsql3/parameterizing-result-order)

我没有看到一种简单的方法来更改您的过程以使其工作，因为您将整个`WHERE`和`ORDER BY`子句作为参数传递。你真正应该做的是重新设计过程。将每个`WHERE`标准作为单独的参数提供给`ups_TestSearch`。您以这种方式重新提供每个`WHERE`参数`sp_executesql`并构建初始 SQL 语句：

```
SET @SQLString = SELECT and JOIN portions of command
SET @SQLString = @SQLString + 'WHERE 1 = 1 '
  IF (@WhereParam1 IS NOT NULL)
    SET @SQLString = @SQLString + 'AND (SomeTable.SomeColumn = @WhereParam1) '
  IF (@WhereParam2 IS NOT NULL)
    SET @SQLString = @SQLString + 'AND (SomeTable.SomeColumn = @WhereParam2) '
  ... 
```

如有必要，您可以使用相同的结构将连接添加到语句中。

`ORDER BY`结构取决于这可能变得多么复杂，以及您是否知道所有可能涉及的列。如果它相对简单，您可以将其`CASE`写成如下的语句，或者将其分解为单独的参数，正如我对`WHERE`子句的建议。

```
ORDER BY
  CASE WHEN CHARINDEX(@SortColumns, 'SortCol1') > 0 THEN SortCol1 ELSE NULL END,
  CASE WHEN CHARINDEX(@SortColumns, 'SortCol2') > 0 THEN SortCol2 ELSE NULL END,
  ... 
```

在这里要做的最简单的事情可能是在应用程序级别而不是 DB 进行排序，但这可能`ORDER BY`与参数化复杂子句一样不可行。

# python - 从 QThread 生成的 QWidgets 的正确父级以插入到 QTreeWidget

> ID：11036184
> 
> 赞同：1
> 
> 时间：2012-06-14T15:15:24.283
> 
> 标签：python, multithreading, pyqt, widget

我有一个 QTreeWidget 需要填充大量信息。所以我可以设计它并按照我真正想要的方式设置它，我决定创建一个 QWidget，它的风格和穿着都非常漂亮。然后，我将使用通用 TreeWidgetItems 填充 TreeWidget，然后使用 setItemWidget 将自定义 QWidgets 粘贴在树中。这在主 PyQt 线程中调用 QWidgets 时有效，但由于信息量很大，我想在线程中创建和填充 QWidgets，然后稍后发出它们以添加到主线程中一旦他们都填写完毕。但是，当我这样做时，QWidgets 似乎没有正确设置它们的父母，因为它们都在自己的小窗口中打开。下面是一些重现此问题的示例代码：

```
from PyQt4.QtGui import *
from PyQt4.QtCore import *

class ItemWidget(QWidget):
    def __init__(self, parent=None):
        QWidget.__init__(self, parent)

        btn = QPushButton(self)

class populateWidgets(QThread):
    def __init__(self):
        QThread.__init__(self)

    def run(self):
        widget = ItemWidget()
        for x in range(5):
            self.emit(SIGNAL("widget"), widget)

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        QMainWindow.__init__(self, parent)

        self.tree = QTreeWidget(self)
        self.tree.setColumnCount(2)
        self.setCentralWidget(self.tree)

        self.pop = populateWidgets()
        self.connect(self.pop, SIGNAL("widget"), self.addItems)
        self.pop.start()

        itemWidget = QTreeWidgetItem()
        itemWidget.setText(0, "This Works")
        self.tree.addTopLevelItem(itemWidget)
        self.tree.setItemWidget(itemWidget, 1, ItemWidget(self))        

    def addItems(self, widget):
        itemWidget = QTreeWidgetItem()
        itemWidget.setText(0, "These Do Not")
        self.tree.addTopLevelItem(itemWidget)
        self.tree.setItemWidget(itemWidget, 1, widget)

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    ui = MyMainWindow()
    ui.show()
    sys.exit(app.exec_()) 
```

如您所见，在 MyMainWindow 中执行此操作很好，但是一旦在线程中处理并返回，事情就会出错。这可能吗？如果是这样，我如何正确地将 QTreeWidgetItem 中的 ItemWidget 类作为父级？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:47:31.717

AFAICT Qt 不支持在实例化 QApplication 对象的线程（即通常是 main() 线程）之外的线程中创建 QWidget。以下是一些关于该主题的帖子以及 Qt 开发人员的回复：

[http://www.qtcentre.org/archive/index.php/t-27012.html](http://www.qtcentre.org/archive/index.php/t-27012.html)

[http://www.archivum.info/qt-interest@trolltech.com/2009-07/00506/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-to-a-new-线程.html](http://www.archivum.info/qt-interest@trolltech.com/2009-07/00506/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-to-a-new-thread.html)

[http://www.archivum.info/qt-interest@trolltech.com/2009-07/00055/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-to-a-new-线程.html](http://www.archivum.info/qt-interest@trolltech.com/2009-07/00055/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-to-a-new-thread.html)

[http://www.archivum.info/qt-interest@trolltech.com/2009-07/00712/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-toa-new-thread。 html](http://www.archivum.info/qt-interest@trolltech.com/2009-07/00712/Re-(Qt-interest)-QObject-moveToThread-Widgets-cannot-be-moved-toa-new-thread.html)

（如果可能的话，这样做的方法是从主线程中调用 QWidgets 上的 moveToThread() 以将它们移动到主线程 - 但显然这种技术不能可靠地工作，就 QtCore对尝试这样做的人进行检查，向标准输出打印警告，告诉他们不要这样做）

# codeigniter - Codeigniter URL 重写 SSL HTTPS

> ID：11036188
> 
> 赞同：1
> 
> 时间：2012-06-14T15:15:38.197
> 
> 标签：codeigniter, mod-rewrite, ssl, https, url-rewriting

在 LAN 内部，我们可以开始了……人们使用 http:// Intranet 访问我们的 Intranet 所有链接和 URL 都可以正常工作（我使用 URL 重写从链接中删除了 index.php）。

我们需要向某些外部人员授予对 Intranet 的访问权限。我们使用 FTMG 完成此任务，与 Outlook Web Access 的工作方式相同。

现在，调用 https://intranet.domain.org 有效，但站点内的链接不起作用……例如：

*   https://intranet.domain.org 有效
*   https:// 内网有效
*   https://intranet.domain.org/homepage**失败**
*   https://intranet.domain.org/index.php/homepage 有效
*   https://intranet/index.php/homepage 有效

***（忽略 https:// 后的空格，我收到无效链接的错误）***

从 https 中删除 's'，整个站点正常运行。

困境应该很清楚了……实现 URL 重写不适用于 https……</p>

我如何使它工作？

注意：我的配置文件 =

```
$config['base_url'] = ''; 
```

我的 .htaccess 文件 =

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    Options +FollowSymLinks
    RewriteBase /

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1
</IfModule>

<IfModule !mod_rewrite.c>
    ErrorDocument 404 /index.php
</IfModule> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T00:18:08.587

也许这会对[HTTP/HTTPS 有一些帮助，没有 index.php，使用 htaccess](http://codeigniter.com/forums/viewthread/86113/)

# objective-c - 在 UIScrollView 中劫持“滑动到下一页”

> ID：11036192
> 
> 赞同：1
> 
> 时间：2012-06-14T15:16:07.327
> 
> 标签：objective-c, ios, uiscrollview

我想防止在我的 UIScrollview 的第三页上滚动并“劫持滑动”手势来触发某事。别的。在这个动作之后，我想进行反应滚动。

这不起作用。

```
- (void)scrollViewDidScroll:(UIScrollView *)sender
{
    if(scrollView.contentOffset.x == self.view.frame.size.width * 2  ) {
        // disable scrolling
        scrollView.scrollEnabled = NO;
    }
}

// hijack the next scrolling event
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView 
```

**当 scrollEnabled = NO 时不调用此委托**

感谢您的帮助

* * *

**EDIT** EventHandler is not called ;-(

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Default background color
    self.view.backgroundColor = [UIColor redColor];

    // Create scroll view
    scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    scrollView.pagingEnabled = YES;
    scrollView.showsHorizontalScrollIndicator = NO;
    scrollView.showsVerticalScrollIndicator = NO;
    scrollView.scrollsToTop = NO;
    scrollView.delegate = self;

    UISwipeGestureRecognizer *recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipeFrom:)];
    recognizer.direction = UISwipeGestureRecognizerDirectionLeft;
    [scrollView addGestureRecognizer:recognizer];
    [recognizer release];
    [scrollView delaysContentTouches];

    // Create subviews (pages)
    NSInteger numberOfViews = 4;
    for (int i = 0; i < numberOfViews; i++) {
        // x pos
        CGFloat yOrigin = i * self.view.frame.size.width;

        // Create subview and add to scrollView
        UIView *pageView = [[UIView alloc] initWithFrame:CGRectMake(yOrigin, 0, self.view.frame.size.width, self.view.frame.size.height)];
        pageView.backgroundColor = [UIColor colorWithRed:0.5/i green:0.5 blue:0.5 alpha:1];

        [scrollView addSubview:pageView];
        [pageView release];
    }

    // Set contentsize
    scrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfViews, self.view.frame.size.height);

    // Add scrollView to view and release
    [self.view addSubview:scrollView];
    [scrollView release];

}

-(void)handleSwipeFrom:(UISwipeGestureRecognizer *)recognizer {
    NSLog(@"swipe!!!!");
    scrollView.scrollEnabled = YES;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:25:42.443

如果禁用滚动视图：

```
 scrollView.scrollEnabled = NO; 
```

不调用委托方法是不可避免的，因此您需要另一种方法来处理劫持模式下的滑动。您可以尝试的一件事是使用`UISwipeGestureRecognizer`: 而不是简单地禁用滚动，您可以将 a 关联`UISwipeGestureRecognizer`到您的视图并处理来自处理程序方法的滑动：

```
UISwipeGestureRecognizer *recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipeFrom:)];
recognizer.direction = UISwipeGestureRecognizerDirectionRight;
[self.view addGestureRecognizer:recognizer]; 
```

并且`handleSwipeFrom`您将重新启用滚动：

```
-(void)handleSwipeFrom:(UISwipeGestureRecognizer *)recognizer {
    // do your hijack here
    scrollView.scrollEnabled = YES;
} 
```

# sql - 需要将数据字符串插入到具有 NUMBER 数据类型的表列中

> ID：11036196
> 
> 赞同：0
> 
> 时间：2012-06-14T15:16:15.090
> 
> 标签：sql, oracle

在 Oracle 中，我有一个数据类型为 NUMBER 的表。我需要在即将创建的新行中插入一个字符串。其他行当然可以保留 NUMBER，因为通常这就是我需要在其中插入的内容。那么有没有办法用这样的字符串插入一个新行（这对我不起作用）？

```
INSERT INTO keyboard_learning (emplid,wpm,date_completed,exercise,attempt)
VALUES (seq_keyboard_learning.nextval,to_char('LEVEL 3'),'14-JUN-2012','Meteor typing blast',1) 
```

我想创建一个新行，通常我会在 WPM 列的新行中放置一个数字，例如“23”。这次我想把'LEVEL 3'而不是数字23

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:21:11.907

假设这`WPM`是`NUMBER`我们正在谈论的列，不，没有办法在`"LEVEL 3"`不更改列定义的情况下将字符串插入到该列中。您可以将列转换为 a `VARCHAR2`，但是当您想像数字一样对待时，这会导致很多麻烦`WPM`（即，让它们按数字而不是字母顺序排序，计算百分比改进等）。

为什么要首先将字符串存储在`WPM`列中？问题似乎很可能是您需要一个新列，或者可能是数据模型中的一个新实体。

# core-data - 如何知道 NSPredicate 中抽象实体的类类型？

> ID：11036197
> 
> 赞同：9
> 
> 时间：2012-06-14T15:16:15.020
> 
> 标签：core-data, ios5, nspredicate, nsfetchrequest

使用核心数据我想获取一些数据。我的模型使用了一些抽象实体，见附图，其中 QuantifiedIngredient 是一个抽象类。我想获取至少具有一个 RecipeQuantifiedIngredients 的成分实体，但中间是 QuantifiedIngredient，它是一个抽象类。

我该怎么做，如何测试 NSPredicate 中抽象类的实际类型？有什么想法或建议吗？

![在此处输入图像描述](../Images/77983ce599f6b692842a895921029e52.png)

我发现的唯一线索是： [如何在谓词中引用子实体名称来获取父实体的请求？](https://stackoverflow.com/questions/1579337/how-can-you-reference-child-entity-name-in-a-predicate-for-a-fetch-request-of-th)

是否可以在我的 QuantifiedIngredient 中使用自定义属性来了解它是否是 RecipeQuantifiedIngredient？例如是RecipeQuantifiedIngredient？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T10:46:47.230

如果`recipe`中需要`RecipeQuantifiedIngredient`，您可以尝试进行提取，检查是否有`ingredient.recipe`. 我认为，这会奏效。

自定义属性（以标志形式存在）也适用于您。您只需在添加或删除所有`recipeQuantifiedIngredient`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T20:06:35.400

我不想花时间把它翻译成 CoreData-speak 所以这是我在 SQL 中的想法：

```
SELECT * FROM quantifiedIngredients WHERE recipe <> NULL 
```

或类似的东西。这本质上是 Nikita 关于使用标志的建议，只是“标志”是属性的存在。我不知道CoreData在遇到`GroceryQuantifiedIngredients`没有时会如何反应`recipe`，我认为KVO会抛出异常。您可能会大胆地添加一个类别：

```
@interface GroceryQuantifiedIngredients (KVOHack)
-(id)recipe;
@end

@implementation GroceryQuantifiedIngredients (KVOHack)
-(id) recipe { return nil; }
@end 
```

这当然需要 CoreData 枚举所有 quantifiedIngredients，但我认为无论如何它都必须这样做，并且`return nil`应该优化成微小的代码。另一个考虑因素是这是否会对您的其余代码产生不良影响；你必须打那个电话。

当我完成这件事时，另一个想到的想法是做这样的事情（我现在对我的伪代码变得*非常松散）：*

```
SELECT * FROM quantifiedIngredients WHERE [i respondsToSelector:@selector(recipe)]; 
```

明白了吗？我忘记了 CoreData 是否允许您在使用谓词或 fetchedThingamabobbers 时使用某种游标，如果可以的话，我认为这是您最好的选择。不管怎样，现在是星期天下午，所以这些东西留给读者作为练习。

+1 提出一个好问题。

# c++ - 手动打印一个 N 字节整数

> ID：11036198
> 
> 赞同：5
> 
> 时间：2012-06-14T15:16:23.710
> 
> 标签：c++, printing, integer, arbitrary-precision

什么是*手动*打印其值不适合的 N 二进制数字整数的可扩展算法`long long`。我认识`printf`和朋友，以及`<iostream>`（最有可能搭载的`<cstdio>`是标准类型的内置函数，但我想对由 N 个字节组成的整数执行此操作。

我已经考虑过这一点并在谷歌上搜索了一下，但它总是归结为使用预先存在的 bigint 库，如 GMP（我完全不熟悉的代码库）或“使用 printf”或最有用的“这很难” .

整数基本上是：

```
template<size_t N>
class Integer{
...
private:
    int8_t first;
    uint8_t rest[N-1];
} 
```

所以重新解释 a`Integer<4>`的字节会给你一个`int32_t`. 我想将其缩放到 N>8。目前，效率并不是我真正关心的问题。字节顺序也不是（这是针对 x86 的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T17:41:53.347

第 1 步：以字符串格式定义一个包含 2 的幂的查找表：

```
const char * const powers_of_two[] = {"1", "2", "4", "8", "16", "32", "64", ...}; 
```

第 2 步：编写一个函数，以字符串格式将两个数字相加。

第 3 步：遍历数字中的位并添加与 1 位对应的所有字符串。

第 4 步：打印结果。

我自己使用这种方法来打印非常大的浮点数，它对我来说效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:03:44.253

输出十进制数的基本递归算法：

```
void negate(Integer & number); // modifies the input
int divide_by_10(Integer & number); // modifies the input
bool is_zero(const Integer & number);

void output_number(Integer number)
{
    if (number.first < 0)
    {
        cout << "-";
        negate(number);
    }
    if (is_zero(number))
    {
        cout << "0";
        return;
    }
    int remainder = divide_by_10(number);
    if (!is_zero(number))
        output_number(number);
    char digit[] = {'0', 0};
    digit[0] += remainder;
    cout << digit;
} 
```

我暂时没有定义辅助函数，也许这已经足够了。

# php - 尝试从 gmail.com 发送电子邮件失败

> ID：11036199
> 
> 赞同：1
> 
> 时间：2012-06-14T15:16:24.940
> 
> 标签：php, smtp, pear

我有一个名为contact.php的文件，里面有表格：

```
<form method="post" name="kontakt" action="send_mail.php">
  <fieldset class="formularz_kontaktowy">
    <legend>Formularz kontaktowy</legend>
    <div><label id="lblStatus"></label></div>
    <div><input type="text" name="txtName" title="Imię i nazwisko" id="txtName" class="text"></div>
    <div><input type="text" name="txtEmail" title="Email" id="txtEmail" class="text"></div>
    <div><input type="text" name="txtTitle" title="Tytuł" id="txtTitle" class="text"></div>
    <div><textarea cols="30" rows="10" name="txtMessage" id="txtMessage" class="text" title="Treść wiadomości"></textarea></div>
    <input type="submit" name="btnSendmail" value=Send">
  </fieldset>
</form> 
```

发送邮件.php

```
<?php
  require_once "Mail.php";

    $from = "<mailaddress@gmail.com>";
    $to = "<mail2@gmail.com>";
    $subject = "Hi!";
    $body = "Hi,\n\nHow are you?";

    $host = "ssl://smtp.gmail.com";
    $port = "465";
    $username = "<mailaddress@gmail.com>";
    $password = "password";

    $headers = array ('From' => $from,
      'To' => $to,
      'Subject' => $subject);
    $smtp = Mail::factory('smtp',
      array ('host' => $host,
        'port' => $port,
        'auth' => true,
        'username' => $username,
        'password' => $password));

    $mail = $smtp->send($to, $headers, $body);

    if (PEAR::isError($mail)) {
      echo("<p>" . $mail->getMessage() . "</p>");
     } else {
      echo("<p>Message successfully sent!</p>");
     }

?> 
```

在浏览器中点击后`btnSendmail`，我有 URL，例如：`localhost/contact.php?txtName=Mary+Smith&txtEmail=mailMail%40gmail.com&txtTitle=dfd&txtMessage=fgdf&btnSendmail=Send`，但邮件没有发送，我没有消息。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:37:48.100

尝试改变

```
$username = "<mailaddress@gmail.com>"; 
```

到

```
$username = "mailaddress@gmail.com"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:43:12.153

我发现了问题。我有两个标签，一个在模板中，第二个，嵌套在contact.php 中。非常感谢您的帮助。

# javascript - Javascript 拆分函数不正确适用于特定的正则表达式

> ID：11036211
> 
> 赞同：0
> 
> 时间：2012-06-14T15:16:40.400
> 
> 标签：javascript, regex

我有个问题。我有一个字符串 -`"\,str\,i,ing"`我需要用逗号分隔，之前没有斜杠。对于我的字符串 - `["\,str\,i", "ing"]`。我正在使用下一个正则表达式

```
myString.split("[^\],", 2) 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:37:06.680

Well, this is ridiculous to avoid the lack of lookbehind but seems to get the correct result.

```
"\\,str\\,i,ing".split('').reverse().join('').split(/,(?=[^\\])/).map(function(a){
    return a.split('').reverse().join('');
}).reverse();

//=> ["\,str\,i", "ing"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:24:02.890

不确定您的预期输出，但您指定的字符串不是正则表达式，请使用：

```
var arr = "\,str\,i,ing".split(/[^\\],/, 2);
console.log(arr); 
```

要`split`使用正则表达式，请将您的正则表达式包装在`/..../`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:42:42.950

您选择了一个难以匹配的字符 - 逗号前面的正斜杠在字符串中传递时很容易消失，因为 '\,'==','...

```
var s= 'My dog, the one with two \\, blue \\,eyes, is asleep.';
var a= [], M, rx=/(\\?),/g;
while((M= rx.exec(s))!= null){
    if(M[1]) continue;
    a.push(s.substring(0, rx.lastIndex-1));
    s= s.substring(rx.lastIndex);
    rx.lastIndex= 0;
};
a.push(s);

/*  returned value: (Array)
My dog 
the one with two \, blue \,eyes 
is asleep.
*/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:38:49.287

这在 js 中是不容易实现的，因为它不支持lookbehind。即使您使用真正的正则表达式，它也会吃掉最后一个字符：

```
> "xyz\\,xyz,xyz".split(/[^\\],/, 2)
["xyz\\,xy", "xyz"] 
```

如果你不想`z`吃，我建议：

```
var str = "....";
return str.split(",").reduce(function(res, part) {
    var l = res.length;
    if (l && res[l-1].substr(-1) == "\\" || l<2)
//      ^                        ^^          ^
//  not the first         was escaped      limit
        res[l-1] += ","+part;
    else
        res.push(part);
    return;
}, []); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T15:38:49.847

在两行之间阅读，您似乎想用`,`前面没有字符的字符来拆分字符串`\`。

如果 JavaScript 有一个正则表达式lookbehind（和否定的lookbehind）模式，那就太好了，但不幸的是它没有。它*确实*有一个前瞻 ( `(?=)`) 和负前瞻 ( `(?!)`) 模式。请务必[查看文档](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。

如果您反转字符串，您可以使用这些作为后向：

```
var str,
    reverseStr,
    arr,
    reverseArr;
//don't forget to escape your backslashes
str = '\\,str\\,i,ing';

//reverse your string
reverseStr = str.split('').reverse().join('');

//split the array on `,`s that aren't followed by `\`
reverseArr = reverseStr.split(/,(?!\\)/);

//reverse the reversed array, and reverse each string in the array
arr = reverseArr.reverse().map(function (val) {
    return val.split('').reverse().join('');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-14T16:54:51.900

查找原始字符串中不存在的内容，例如`"@@@"`. 用它代替`"\\,"`。将结果字符串拆分为`","`. 换回. `"@@@"`_`"\\,"`

像这样的东西：

```
<script type="text/javascript">
   var s1 = "\\,str\\,i,ing";
   var s2 = s1.replace(/\\,/g,"@@@");
   console.log(s2);
   var s3 = s2.split(",");
   for (var i=0;i<s3.length;i++)
   {
       s3[i] = s3[i].replace(/@@@/g,"\\,");
   }
   console.log(s3);
 </script> 
```

见[JSFiddle](http://jsfiddle.net/zr45J/)

# extjs - 如何扩展 Ext.Ajax？

> ID：11036216
> 
> 赞同：0
> 
> 时间：2012-06-14T15:17:04.740
> 
> 标签：extjs, extjs4, extjs-mvc

我经常在我正在制作的应用程序中使用它，所以如果可以的话，我想缩短它并制作一个扩展类来在一个地方处理所有回调逻辑，我尝试像这样设置它但尝试时失败加载类：

```
Uncaught TypeError: Cannot read property 'isInstance' of undefined ext-all-debug.js:4136
ExtClass.registerPreprocessor.config ext-all-debug.js:4136
Ext.apply.doProcess ext-all-debug.js:4007
Manager.registerPostprocessor.uses ext-all-debug.js:6037
Ext.apply.require ext-all-debug.js:5771
Manager.registerPostprocessor.uses ext-all-debug.js:6004
Ext.apply.doProcess ext-all-debug.js:4007
Ext.apply.doProcess ext-all-debug.js:4008
Ext.apply.process ext-all-debug.js:3995
Ext.Class.ExtClass ext-all-debug.js:3911
Ext.ClassManager.create ext-all-debug.js:4676
Ext.apply.define ext-all-debug.js:5095
(anonymous function) Ajax.js:1 //My extended Ajax singleton 
```

**这是我尝试调用它的方式**

```
 var changes = e.record.getChanges();
    if (e.record.get('id'))
        changes.id = e.record.get('id');

    APP.ux.Ajax.request({
        url: '/admin/user/save/',
        params: changes,
        scope: this
    }); 
```

**更新** 这是有道理的，我不敢相信忽略了这一点，但我仍然得到上面未定义错误的相同读取属性“isInstance”。这是现在的样子

**这是简单的类（更新）**

```
Ext.define('APP.ux.Ajax', {
extend: 'Ext.data.Connection',
requires: [
    'APP.ux.Msg'
],
singleton : true,
autoAbort : false,
request: function(config) {
    var cfg = config;

    Ext.apply(cfg, {
        success: function(form, action) {
            APP.ux.Msg.alert('Success', action.result.msg);
            //TODO: Add more logic here
        },
        failure: function(form, action) {
            switch (action.failureType) {
                case Ext.form.action.Action.CLIENT_INVALID:
                    APP.ux.Msg.alert('Failure', 'Form fields may not be submitted with invalid values');
                    break;
                case Ext.form.action.Action.CONNECT_FAILURE:
                    APP.ux.Msg.alert('Failure', 'Ajax communication failed');
                    break;
                case Ext.form.action.Action.SERVER_INVALID:
                    APP.ux.Msg.alert('Failure', action.result.msg);
                    break;
            }
        }
    });
    this.callParent(cfg);
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:25:30.710

这不会像这样工作。如果你想在一个地方有失败/成功处理程序 - 你需要覆盖标准`request()`方法，像这样（这将转到你的 App.ux.Ajax 类）

```
request: function(config) {
  var cfg = config;

  Ext.apply(cfg, {
    success: function(form, action) {
       APP.ux.Msg.alert('Success', action.result.msg);
       //TODO: Add more logic here
    },
    failure: function(form, action) {
       switch (action.failureType) {
        case Ext.form.action.Action.CLIENT_INVALID:
            APP.ux.Msg.alert('Failure', 'Form fields may not be submitted with invalid values');
            break;
        case Ext.form.action.Action.CONNECT_FAILURE:
            APP.ux.Msg.alert('Failure', 'Ajax communication failed');
            break;
        case Ext.form.action.Action.SERVER_INVALID:
            APP.ux.Msg.alert('Failure', action.result.msg);
            break;
       }
    }
  });

  this.callParent(cfg);
} 
```

# java - I/O 上的事件处理

> ID：11036223
> 
> 赞同：1
> 
> 时间：2012-06-14T15:17:34.037
> 
> 标签：java, swing, events, io, actionlistener

我需要创建一个事件，以便每当附加或编辑文件时，都应该启动一个事件，该事件将告诉其所有侦听器在哪个文件和行中数据被编辑、删除、附加了哪些数据。

我想到的可能的解决方案是用线程和动作侦听器级联管道 I/0 流，但我无法以所需的速度、内存管理、同步紧凑的方式实现所需的解决方案。

示例：我正在 Windows 记事本中编辑“txt”文件；一旦我保存它，在后台运行的程序就会启动一个事件，告诉它的所有侦听器数据已被编辑并对更改的数据进行一些处理。

如果已经实施了解决方案，请提供参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:42:22.803

我没有尝试过，但是查看文档[`FileSystem#newWatchService`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileSystem.html#newWatchService%28%29)可能是您需要的。['Oracle](http://docs.oracle.com/javase/tutorial/essential/io/notification.html)[教程'](http://docs.oracle.com/javase/tutorial/essential/io/notification.html)`WatchService`中提供了其用法（和示例）。[`WatchService`](http://docs.oracle.com/javase/tutorial/essential/io/notification.html)

# c# - Telerik 网格自定义列构建/格式

> ID：11036227
> 
> 赞同：2
> 
> 时间：2012-06-14T15:17:55.520
> 
> 标签：c#, asp.net-mvc, telerik, telerik-grid

我有一个带有动态数据源的 Telerik 网格（网格最多可以使用大约 10 个完全不同的模型来存储它的数据），所以我也必须动态地构建列（显然）。网格中的一列（对于某些型号）是一个以毫秒为单位的时间跨度的双精度。***我想要做的是将这个双精度格式设置为时间跨度***。telerik 代码如下所示：

```
<% Html.Telerik()
     .Grid(Model.DynamicGridDataSource)
     .Name("statisticalGrid")
     .Columns(a => GridHelper.GenerateColumns(a, Model.SelectedReport))
     .DataBinding(dataBinding => dataBinding.Ajax().Select("_SelectGrid", "Reports", new { reportId = Model.ReportId, dateFrom = Model.DateFrom, dateTo = Model.DateTo, date = Model.Date, AvailablePlans = Model.AvailablePlans }))
     .Sortable(GridSortSettingsBuilder => GridHelper.SortColumns(GridSortSettingsBuilder,
                                            Model.DynamicGridDataSource.GetType(),
                                            Model.SelectedReport))
     .Filterable()
     .Pageable(page => page.PageSize(25))
     .Reorderable(reorder => reorder.Columns(true))
     .Groupable
     (
         groupingSettingsBuilder => GridHelper.GroupColumns(groupingSettingsBuilder,
                                    Model.DynamicGridDataSource.GetType(),
                                    Model.SelectedReport)
     )
     .ClientEvents(events => events
          .OnColumnReorder("onReorder"))
     .Render(); 
```

和 GridHelper.GenerateColumns 看起来像这样：

```
public static void GenerateColumns(GridColumnFactory<dynamic> columnFactory, Company.Product.Data.Entity.Report reportStructure)
        {
            foreach (var columnLayout in reportStructure.ReportCols.OrderBy(o => o.ColumnSequence))
            {
                var columnBuilder = columnFactory.Bound(columnLayout.ColumnType);

                if (columnLayout.ColumnType.Equals("SessionLength") ||
                 columnLayout.ColumnType.Equals("AverageTime") ||
                 columnLayout.ColumnType.Equals("TotalTime") ||
                 columnLayout.ColumnType.Equals("CallTime"))
                {
                    // disable grouping
                    columnBuilder.Groupable(false);
                    string dataBindProperty = columnLayout.ColumnType;
                    if (columnLayout.DataFormat == "{0:T}")
                    {
                        //Even though the format looks like time ({0:T}), its actually a double which needs to be formatted here to look like a TimeSpan
                    }

                }

                if (!string.IsNullOrEmpty(columnLayout.Label))
                {
                    columnBuilder.Title(columnLayout.Label);
                }

                if (columnLayout.DataFormat != null && columnLayout.DataFormat == "{0:P}")
                {
                    columnBuilder.Format("{0:P}");
                }

                if (columnLayout.SumIndicator)
                {
                    if (columnLayout.DataFormat == "{0:T}")
                    {
                        AddAggregateToColumnTimeSpan(columnBuilder, Aggregate.Sum);
                    }
                    else
                    {
                        AddAggregateToColumn(columnBuilder, Aggregate.Sum);
                    }
                }

                if (columnLayout.HideIndicator)
                {
                    columnBuilder.Column.Hidden = true;
                }

            }
        } 
```

我能够正确格式化页脚，但我不知道如何格式化列的其余部分，因为在 Telerik 代码的上下文之外，我无法访问`item`迭代器或任何东西。有什么建议/想法吗？也许`columnFactory.Bound(columnType).Format(/*something*/)`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T05:30:10.910

您说过，“网格最多可以使用大约 10 个完全不同的模型来存储其数据”，所以也许不是试图在一个网格中表示所有这些模型，而是每个模型都有一个网格。您可以使用某种机制将每个网格放在它自己的局部视图中，并使用一些机制来决定要加载哪个局部视图。这是一个简单的例子。

控制器

```
public ActionResult DynamicReport
{
    //Get your Model
    Model.model1 = model_01 = Model.DynamicGridDataSource.GetDynamicModel()
    //Get the name of what model is being returned so view knows which 
    //partial view to load
    ViewBag.Message = model_01.Name
    ...

    return View(model_01)
} 
```

在视图中有一些条件逻辑来选择要加载的部分视图。

看法

```
<h2>View</h2>
@{
  string pView = "~/Views/Grid/Partial_01.cshtml";
  switch(ViewBag.Message)
  {
      case "p02":
      pView =  "~/Views/Grid/Parital_02.cshtml"
      break;
      .....
  }
}

@Html.Partial(pView) 
```

部分视图_01

```
@model List<Models.Misc>
@(Html.Telerik().Grid(Model)
    .Name("Grid")
    .Columns(columns =>
    {
      columns.Bound(a => a.Id).Width(120);
      columns.Bound(a => a.Name).Width(100);
      columns.Bound(a => a.Value).Format("{0:#,##0.00}").Width(100).Title("Price");
    })
) 
```

部分视图_02

```
@model List<Models.Temp>
@(Html.Telerik().Grid(Model)
  .Name("Grid")
  .Columns(columns =>
  {
    columns.Bound(o => o.Name)
            .Aggregate(aggregates => aggregates.Count())
            .FooterTemplate(@<text>Total Count: @item.Count</text>)
            .GroupFooterTemplate(@<text>Count: @item.Count</text>);

    columns.Bound(o => o.Start)
            .Template(@<text>@item.Start.ToShortDateString()</text>)
            .Aggregate(aggreages => aggreages.Max())
            .FooterTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>)
            .GroupHeaderTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>)
            .GroupFooterTemplate(@<text>Max: @item.Max.Format("{0:d}")</text>);

    columns.Bound(o => o.Value)
            .Width(200)
            .Aggregate(aggregates => aggregates.Average())
            .FooterTemplate(@<text>Average: @item.Average</text>)
            .GroupFooterTemplate(@<text>Average: @item.Average</text>);

    columns.Bound(o => o.tsMilliseconds)
          .Width(100)
          .Aggregate(aggregates => aggregates.Sum())
          .Template(@<text>@TimeSpan.FromMilliseconds(@item.tsMilliseconds)</text>)
          .Title("TimeSpan")
          .FooterTemplate(
          @<text>
                <div>Sum: @TimeSpan.FromMilliseconds(@Convert.ToDouble(@item.Sum.Value.ToString())) </div>
            </text>)
      //header if you group by TimeSpan
          .GroupHeaderTemplate(@<text>@item.Title: @item.Key (Sum: @TimeSpan.FromMilliseconds(@Convert.ToDouble(@item.Sum.Value.ToString())))</text>)
      //footer for grouping
          .GroupFooterTemplate(@<text>Sum: @TimeSpan.FromMilliseconds(@Convert.ToDouble(@item.Sum.Value.ToString()))</text>);
  })
    .Sortable()
    .Groupable(settings => settings.Groups(groups => groups.Add(o => o.Start)))
) 
```

依此类推，对于每个不同的模型。每个模型都有自己的局部视图，您可以轻松地格式化每个网格以适合其模型，同时仍然只有一个主视图。

# ruby-on-rails-3 - 设计：如何访问所有控制器中的辅助方法

> ID：11036229
> 
> 赞同：3
> 
> 时间：2012-06-14T15:17:58.903
> 
> 标签：ruby-on-rails-3, methods, devise, twitter-bootstrap, undefined-reference

我正在尝试在导航栏标题（twitter bootstrap）中实现设计登录表单，但它只是告诉我资源不是定义的方法。

我是否需要以某种方式继承设计辅助方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:19:39.443

在创建自定义登录页面时，它与您的控制器没有任何关系，它与通过辅助方法的帮助程序访问视图中的内容有关。您想将它们添加到您的 application_helper.rb 文件中。这里有该方法的概述：

[https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app](https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app)

简而言之，您基本上想将其添加到您的 application_helper.rb

```
def resource_name
 :user
end

def resource
  @resource ||= User.new
end

def devise_mapping
  @devise_mapping ||= Devise.mappings[:user]
end 
```

当我使用 twitter bootstrap 时，我在所有项目中都多次使用它来在导航栏中制作自定义登录表单。它工作得很好，不需要您在其他任何地方更改任何其他代码。

# c++ - 轨迹插值和导数

> ID：11036231
> 
> 赞同：3
> 
> 时间：2012-06-14T15:18:02.587
> 
> 标签：c++, spline

我正在分析粒子在 2D 平面中的轨迹。该轨迹通常由 5 到 50 个（在极少数情况下更多）点（离散整数坐标）组成。我已经匹配了我的数据集的点以形成轨迹（因此我有时间分辨率）。
我想对这条轨迹的曲率进行一些分析，不幸的是我使用的分析框架不支持拟合轨迹。据我所知，可以使用样条曲线/贝塞尔曲线来完成这项工作，但我希望得到您的意见和/或建议使用什么。
由于这只是我工作的一个可选部分，我无法投入大量时间自行实施解决方案或理解复杂的框架。解决方案必须尽可能简单。

让我从一个可能的库中指定我需要的特征：
- 从不同数量的点创建轨迹
- 由于点是离散的，它应该插入它们的位置；只要轨迹和点之间的最终距离小于阈值，就不需要对所有点进行精确匹配
- 库必须为任何给定点生成轨迹的**导数**
- 如果库可以报告插值的质量水平（如拟合的 chiSquare）

**编辑：**阅读评论后，我想补充一些：
轨迹不必与点完全匹配。这些点是从像素矩阵的值创建的，因此它们形成一个离散的坐标矩阵，其空间分辨率受每个给定距离的像素数限制。因此，这些点（位于发射像素的中心）不（完全）匹配粒子的实际轨迹。只要解决方案可以处理可能/很可能既不是双射也不是单射的轨迹，插值或拟合对我来说都很好。
因此，大多数传统的拟合方法（例如使用最小二乘拟合拟合多项式或指数函数）无法满足我的标准。
另外，我尝试过的所有传统拟合方法都产生了一个似乎很好地描述轨迹的函数，但是当查看它们的一阶导数（或更高分辨率）时，可以发现许多“微振荡”（根据我的解释）是结果将非直线函数拟合到轨迹的（几乎）直线部分。

**Edit2：**评论中有一些讨论，这些轨迹可能是什么样子。本质上，它们可能具有任何形状、长度和“卷曲度”，尽管我试图排除在前面的步骤中重叠或交叉的轨迹。我在下面包含了两个示例；忽略彩色框，它们只是原始像素矩阵值的表示。黑色圆点是我想与轨迹匹配的点，如您所见，它们始终以像素为中心，因此可能只有离散（整数）值。

![前一](../Images/2c8670707e157120b8cae0fa082e8ff8.png)
![ex2](../Images/9af72f1e761fe363aba662955029796d.png)

提前感谢您的任何帮助和贡献！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:08:36.477

这可能是要走的路

[http://alglib.codeplex.com/](http://alglib.codeplex.com/)

根据您的描述，我会说参数样条插值可能适合您的要求。我自己没有使用过上述库，但它确实支持样条插值。使用插值意味着您不必担心拟合优度 - 曲线将通过您给出的每个点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:20:34.430

如果您不介意使用矩阵库，[线性最小二乘法](http://en.wikipedia.org/wiki/Linear_least_squares_%28mathematics%29)是最简单的解决方案（请查看一般问题部分的末尾以了解要使用的方程）。您还可以使用[线性/多项式回归](http://en.wikipedia.org/wiki/Linear_regression)来解决此类问题。

线性最小二乘法总是会给出最好的解决方案，但它不可扩展，因为矩阵乘法的成本适中。回归是一种迭代启发式方法，因此您可以运行它，直到获得“足够好的”答案。我已经在您的数据中看到了大约 1000-10000 维的截止准则。因此，对于您的数据集，我建议使用线性最小二乘法，除非您出于某种原因决定对其进行高度标注。

# matlab - 更改列表框中字符串的颜色 - MATLAB GUI

> ID：11036232
> 
> 赞同：2
> 
> 时间：2012-06-14T15:18:07.063
> 
> 标签：matlab, matlab-guide

我在列表框中有一个名称列表。当我单击一个按钮时，我想做的是让某个选定的名称更改颜色，从红色变为绿色。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:25:20.133

官方不支持。有一些未记录的功能可以做到这一点 - 请查看[http://www.undocumentedmatlab.com](http://www.undocumentedmatlab.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T01:00:29.417

您可能已经解决了这个问题，但我想我会稍微澄清一下安德烈。MATLAB GUI 组件可以在其属性中处理 HTML。所以，我想设置你的按钮回调来编辑你的列表框的属性，使用 HTML 来改变颜色将是一种合适的方式来继续这里。Yair Altman 在这里写得很好：http: [//undocumentedmatlab.com/blog/html-support-in-matlab-uicomponents/](http://undocumentedmatlab.com/blog/html-support-in-matlab-uicomponents/)

当然，该示例很简单，但是如果我正确理解了您的问题，您应该能够对其进行调整以满足您的需求。

# shell - 在 scp 中使用别名而不是 IP

> ID：11036234
> 
> 赞同：3
> 
> 时间：2012-06-14T15:18:18.303
> 
> 标签：shell, unix

我在办公室有一个桌面，我经常需要从家里访问并使用 scp 来复制文件。目前我正在这样做

```
scp username@x.x.x.x  ... 
```

我想要一种机制，每次我想要 scp 某些东西时我都不必输入 IP 地址。我试图通过创建别名来做到这一点，但它似乎不起作用。我可以给我的台式机起一个名字，这样我就可以使用机器的名称代替输入 IP 地址吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:35:24.543

处理此问题的一种方法是在您的 ssh 配置中创建一个条目。这可以在系统范围内完成，或者，如果您对此框没有 root 访问权限，则仅针对您的用户。

每个用户的配置文件是`~/.ssh/config`并使用以下格式

```
host my_desktop
    hostname 11.22.33.44 
```

这种方法也很好，因为您可以指定其他选项，例如用户名。要了解有关可用选项的更多信息，请尝试`man ssh_config`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T15:25:40.350

您的系统上应该有一个`HOSTS`专门用于执行此操作的文件。在我的 Linux 系统上，它位于`/etc/hosts`. 如果添加如下所示的行：

```
11.22.33.44   my_desktop 
```

那么对该名称的所有访问`my_desktop`都将映射到列出的 IP 地址。但是，此更改仅影响`HOSTS`文件被修改的机器。如果您想让*任何人*都可以使用特定名称访问 IP，那么您正在寻找更困难的东西（这是 DNS 服务器旨在解决的一般问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T15:48:46.383

使用环境变量来保存您的 IP 和用户名 - 然后在 scp 命令中使用该变量。

```
user@crunchbang:~$ export mypc='myuser@x.x.x.x'

user@crunchbang:~$ scp $mypc: ...... 
```

# php - facebook API 中的分页（照片）

> ID：11036235
> 
> 赞同：2
> 
> 时间：2012-06-14T15:18:19.120
> 
> 标签：php, facebook, api

我目前正在开发一个需要访问用户照片的 facebook 应用程序。它需要遍历所有用户的活动照片，但是我在提要的分页方面遇到了一些问题。我从 API 中得到结果，比如

```
stdClass Object
(
    [data] => Array
        (
            [0] => stdClass Object
                (
                    [id] => 10151796309135076
                    [from] => stdClass Object
                        (
                            [name] => Daniel Benzie
                            [id] => 762525075
                        )
                )
        )
) 
```

显然以上是摘录，然后在底部有一个用于下一页和上一页的部分。

```
[previous] => https://graph.facebook.com/762525075/photos?access_token=xxxxxxx&limit=25&since=1338985293&__previous=1
[next] => https://graph.facebook.com/762525075/photos?access_token=xxxxx&limit=25&until=1332002972 
```

这总是设置好的——有没有人知道在这种情况下循环浏览照片的最佳方式？提前致谢 （：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:35:44.903

继续调用`next`url 直到没有更多`data`

```
while ($some_photos['data'])
{
    $all_photos = array_merge( $all_photos, $some_photos['data'] );

    $paging = $some_photos['paging'];
    $next = $paging['next'];

    $query = parse_url($next, PHP_URL_QUERY);
    parse_str($query, $par);  

    $some_photos = $facebook->api(
        $user_id."/photos", 'GET', array(
            'limit' => $par['limit'],
            'until'  => $par['until'] ));
} 
```

# java - “Dispatcher”在 NewRelic 的 @Trace 注释上做了什么

> ID：11036236
> 
> 赞同：7
> 
> 时间：2012-06-14T15:18:20.137
> 
> 标签：java, newrelic

`dispatcher`New Relic的注解属性有什么作用`@Trace`？我能找到的所有示例都将其设置为`true`- 如果将其设置为 false 会发生什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-24T18:11:18.283

基本上，`dispatcher=true`意味着“将此方法视为我想要与其他类型的请求分开监控的请求的开始”。

从有关[使用 New Relic 监视 Java 后台进程的文档中](https://newrelic.com/docs/java/monitoring-java-background-processes)：

> 该`dispatcher=true`选项使带注释的方法被视为 Web 事务——代理将报告任务的错误和事务跟踪。

设置为`false`，跟踪的方法本身不会被视为事务，并且仅在从已报告的事务中调用时才会显示在 New Relic 中。

# php - 在日期之间从数据库中查询项目

> ID：11036243
> 
> 赞同：0
> 
> 时间：2012-06-14T15:18:39.637
> 
> 标签：php, sql, date

我正在使用 PHP 和 SQL 创建基于每周周期的统计摘要。

我最初认为所有项目都有相同的日期，下面的代码在这种情况下工作。

```
$result1 = mysql_query("SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate = '2012-06-6' ORDER BY wtcode "); 
```

但是现在我发现我需要查询的项目有不同的日子。

如何更改查询以获取 2012 年 6 月 6 日和 2012 年 6 月 12 日之间的日期，而不仅仅是 2012 年 6 月 6 日的日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:20:24.067

使用 SQL BETWEEN 子句：

```
SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND (saledate BETWEEN '2012-06-6' AND '2012-06-12') ORDER BY wtcode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:20:40.793

```
saledate between '2012-06-6' and '2012-06-12' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:22:51.303

```
$result1 = mysql_query("SELECT * FROM phoneappdetail WHERE salebarn = 'OSI' AND saledate > '2012-06-6' AND saledate < '2012-06-12' ORDER BY wtcode "); 
```

# java - Java：为什么即使在创建对象之后 JVM 堆大小也没有区别

> ID：11036244
> 
> 赞同：1
> 
> 时间：2012-06-14T15:18:40.293
> 
> 标签：java

我试图找出 JVM Heap Size 与 Object creation 有何不同。

例如，如果您看到我下面的程序，我在 for 循环中创建了 10000 个字符串对象，但在我的 JVM 环境中的堆大小仍然没有区别。

```
public class One {

    public static void main(String args[]) {

        long heapSizebefore = Runtime.getRuntime().totalMemory();
        System.out.println("heapSizebefore" + heapSizebefore);

        for (int i = 0; i <= 10000; i++) {
            String str = new String();

        }

        long heapSizeafter = Runtime.getRuntime().totalMemory();
        System.out.println("heapSizeafter" + heapSizeafter);

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:19:38.480

调用`totalMemory`just 会为您提供 Java 进程保留的内存量。这并不意味着它正在被堆上的对象主动填充。正如[javadocs](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#totalMemory%28%29)所说，它是当前*和未来*对象*可用*的内存总量。

 *事实上，Java 更愿意从底层操作系统请求大块内存，而不是`malloc`每次创建新对象时都必须调用（或等效）。

如果要跟踪堆的实际大小，可以使用 JConsole/JVisualVM 等工具简单地实时执行此操作，或者使用内存分析器更详细地执行此操作。如果您想以编程方式执行此操作，则需要为复杂的东西注册一个代理，但堆详细信息通过 JMX 公开。查看`java.lang:Memory`MBean 的`HeapMemoryUsage`属性（JConsole 使用它来显示内存图表）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:19:51.900

JIT 也可能会优化整个`for`循环，因为它没有副作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T15:20:59.823

两个原因：

1.  *您正在测量为堆保留*的内存量，而不是活动对象大小的总和。
2.  无论如何，您都不会保留对已分配字符串的引用，因此 JVM 可以随时对它们进行垃圾收集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:25:13.877

> 基本上我想知道为什么我们在 Java 中使用静态方法。

因为静态方法比实例方法简单。

> 所以我的问题是节省内存（从对象创建）我们使用静态方法？？

不，你应该有目的地编码，只创建你真正需要的东西。需要时创建实例，不需要时不要创建实例。这不是出于性能原因，而是为了减少代码的概念权重。如果您必须维护您的代码或其他一些代码，您需要找出为什么要做某事，并且需要更长的时间才能确定无意义的代码确实是无意义的。即寻找不存在的东西比寻找存在的东西要花更长的时间。

* * *

为了支持多线程内存分配，每个线程都有一个线程本地分配缓冲区或[TLAB](http://openjdk.java.net/groups/hotspot/docs/HotSpotGlossary.html)。

可用空间仅显示公共池中有多少可用空间，但不能显示每个线程的 TLAB 中可用的大小。如果您分配了足够多的字符串，您将看到内存使用量在加载另一个块时突然跳跃。

你可以做的是关闭它`-XX:-UseTLAB`

```
// -XX:+UseTLAB heapUsedBefore: 5,368,848 heapUsedAfter: 5,368,848
// -XX:-UseTLAB heapUsedBefore: 535,048 heapUsedAfter: 535,096

public class One {
    public static void main(String... args) {
        Runtime runtime = Runtime.getRuntime();
        long heapUsedBefore = runtime.totalMemory() - runtime.freeMemory();

        String str = new String();

        long heapUsedAfter = runtime.totalMemory() - runtime.freeMemory();
        System.out.printf("heapUsedBefore: %,d heapUsedAfter: %,d%n", 
                           heapUsedBefore, heapUsedAfter);
    }
} 
```*

# ios - 如何将图像插入由 UIViewController 创建的栏？

> ID：11036248
> 
> 赞同：0
> 
> 时间：2012-06-14T15:18:43.000
> 
> 标签：ios, rubymotion

可以创建选项卡 - 但是，如何将图形插入每个选项卡以及选项卡后，您如何将其称为新屏幕？

```
# Create a tabbar
tabbar = UITabBarController.alloc.init

# Each Tab has a view controller allocated

tabbar.viewControllers = [
    UIViewController.alloc.init,
    UIViewController.alloc.init, 
    UIViewController.alloc.init,
    UIViewController.alloc.init
]

# Selected index to 0
tabbar.selectedIndex = 0

# The root view controller also changed
@window.rootViewController = UINavigationController.alloc.initWithRootViewController(tabbar)

# We will force to use a full screen layout.
@window.rootViewController.wantsFullScreenLayout = true 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:51:47.550

[请参阅https://github.com/HipByte/RubyMotionSamples](https://github.com/HipByte/RubyMotionSamples)上的“Beers”示例项目

您走在正确的轨道上，唯一的区别是您需要列出特定的视图控制器类而不是通用的 UIViewController 类。从样本中：

```
tabbar.viewControllers = [BeerMapController.alloc.init,
                          BeerListController.alloc.init] 
```

然后在这些控制器的每一个`init`方法中，你设置它`tabBarItem`来给它一个标题和图像：

```
class BeerListController < UITableViewController
  def init
    if super
      self.tabBarItem = UITabBarItem.alloc.initWithTitle('List', image:UIImage.imageNamed('list.png'), tag:1)
    end
    self
  end
end 
```

或者，如果您还没有特定的视图控制器，我想您可以执行以下操作：

```
tabbar.viewControllers = [
  UIViewController.alloc.init,
  UIViewController.alloc.init
]
tabbar.viewControllers[0].tabBarItem = UITabBarItem.alloc.initWithTitle('List', image:UIImage.imageNamed('list.png'), tag:1)
# etc. 
```

# sql - 多连接子查询 SQL Server 2008

> ID：11036249
> 
> 赞同：0
> 
> 时间：2012-06-14T15:18:43.817
> 
> 标签：sql, sql-server-2008, tsql

![在此处输入图像描述](../Images/4429965744afcd95b17de35fb944fccb.png)

在左边你会看到我为一个表设计的，在右边你会看到下面 SQL 中子查询的结果。我正在尝试`patientID,claimsFromDate,claimsThroughDate`在 tblClaims 的三个字段上加入子查询，并让外部查询将正确`tblClaims.ID`的与三部分连接相关联。

我得到的错误：

> 第 3 行，关键字附近的`and`语法不正确 选择 ) 附近的语法不正确，第 12 行

```
select tblClaims.id, t.primaryCode
from t
(
select patientid, claimsfromdate, claimsthroughDate, primarycode from myTable
union
select patientid, claimsfromDate, claimsthroughDate, secondaryCode from myTable
union
select patientID, claimsfromdate, claimsthroughDate, tertiarycode from myTable

) as t
inner join t on tblclaims.patientid=t.patientid 
and tblclaims.claimsfromdate=t.claimsfromdate
and tblclaims.cllaimsthroughdate=t.claimsfromdate 
```

编辑：内部查询是协调多列字段。它返回 150 万行。我运行的固定查询返回 350 万，即

`select tblClaims.id, t.primarycode from ( select patientid, claimsfromdate, claimsthroughDate, primarycode from myTable ) as t inner join tblclaims on tblclaims.patientid=t.patientid and tblclaims.claimsfromdate=t.claimsfromdate and tblclaims.cllaimsthroughdate=t.claimsfromdate`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:22:40.290

尝试这个：

```
select tblClaims.id, t.primarycode 
from 
(
select patientid, claimsfromdate, claimsthroughDate, primarycode from myTable
) as t
inner join tblclaims on tblclaims.patientid=t.patientid 
and tblclaims.claimsfromdate=t.claimsfromdate
and tblclaims.cllaimsthroughdate=t.claimsfromdate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:20:05.670

你试过用`Distinct`吗？

```
select DISTINCT tblClaims.id, t.primarycode 
from 
(
    select patientid, claimsfromdate, claimsthroughDate, primarycode from myTable
) as t
inner join tblclaims on tblclaims.patientid=t.patientid 
and tblclaims.claimsfromdate=t.claimsfromdate
and tblclaims.cllaimsthroughdate=t.claimsfromdate 
```

# ruby-on-rails-3 - 将 CSV 文件作为参数传递给 rspec

> ID：11036254
> 
> 赞同：0
> 
> 时间：2012-06-14T15:19:06.173
> 
> 标签：ruby-on-rails-3, file-upload, csv, controller, rspec2

我的 users_controller 中有以下功能，可以从本地磁盘上传 csv 文件并将其中的用户详细信息导出到我的应用程序中。该代码在应用程序中正常工作，但我不确定如何在测试中通过 csv。我的功能如下：

```
def upload
  if request.post?
    if (params[:user].nil? || params[:user][:csv].blank?)
      flash[:notice] = "Please provide a csv file to upload."; return
    end 

    file = params[:user][:csv].read   
    CSV.parse(file, headers: true, header_converters: :symbol).each { |row| Cortex::User.create(row.to_hash) }

    respond_to do |format|
      format.html { redirect_to admin_engine.cortex_users_path }
      format.json { head :no_content }
    end    
  else
    # Provide upload view
  end     
end 
```

这是我试图在 rspec 测试中涵盖这一点的尝试。

```
it "should be a success" do
  post "admin/users/upload", :user => @user, :user_csv => fixture_file_upload(Admin::Engine.root.join('spec/dummy/tenants_sample.csv')), :session_token => @auth_token
  response.code.should eq("200")
end 
```

当我使用 coverage gem 检查 LOC 覆盖率时，我可以看到测试在退出之前进入了前两个 if 语句。

任何人都得到了关于如何传递这个文件的任何提示，以便函数的其余部分可以读取它。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:47:52.097

恕我直言，测试 CSV 组合或解析不属于您当前的测试。最终，所有这样的测试都会测试 CSV 模块或 CSV 文件的有效性——这是一个脆弱的测试，并且对您的应用程序的了解很少。

更好的测试实践是对*模型*进行测试以确保：

1.  格式正确的 CSV 将以您期望的方式导入。
2.  格式错误的 CSV 文件会针对您的应用程序进行适当处理。

控制器应该只是存根或模拟 CSV 解析，因为它与响应代码测试无关，而且逻辑无论如何都属于模型。YMMV。

# django - django admin登录后重定向到另一个页面

> ID：11036267
> 
> 赞同：5
> 
> 时间：2012-06-14T15:19:56.843
> 
> 标签：django, redirect, django-admin

我正在 Django 中制作自定义管理页面。我不想重新发明轮子，因此想使用 Django 管理员登录表单让员工登录，然后将他们重定向到 /my-url/。

但是，在 /admin/ 成功登录后，我找不到将用户重定向到自定义 url 的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-02T10:17:34.027

我遇到过同样的问题。*我没有在登录后*重定向，而是在我的视图中使用了@staff_member_required 装饰器，该装饰器`/my-url/`重定向到管理员登录

```
from django.contrib.admin.views.decorators import staff_member_required

@staff_member_required
def test_list(request):
    return HttpResponse('TEST') 
```

如果使用基于类的视图，请查看[method_decorator](https://docs.djangoproject.com/en/1.10/topics/class-based-views/intro/#decorating-class-based-views)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-01-29T16:57:34.823

因为我偶然发现了同样的问题，所以我注意到了默认登录页面的 url：

```
/admin/login/?next=/admin/ 
```

所以我将登录页面链接更改为

```
/admin/login/?next=/ 
```

指向主页

也适用于注销页面，很好很简单

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-14T16:11:07.740

Django auth 应用程序带有一个[登录视图](https://docs.djangoproject.com/en/1.5/topics/auth/default/#module-django.contrib.auth.views)，您可以连接到该视图`/accounts/login/`或您选择的任何其他 url。`admin/login.html`如果您不想自己编写，您可以使用管理员的登录模板。

通过使用登录视图，该`LOGIN_REDIRECT_URL`参数将起作用。该`/admin/`页面的目的是显示管理索引。我会避免尝试将其用作登录页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T15:24:59.213

`LOGIN_REDIRECT_URL`在你的`settings.py`文件中设置。记录[在这里](https://docs.djangoproject.com/en/dev/ref/settings/#login-redirect-url)。

# ios - 如何确定应用程序由于电话呼叫或由于用户按下主页按钮而进入后台状态

> ID：11036278
> 
> 赞同：1
> 
> 时间：2012-06-14T15:20:31.320
> 
> 标签：ios

当我的应用程序移动到后台时，我想执行不同的操作，具体取决于它是否因为有来电而移动到该状态，或者它是否因为用户点击了主页按钮而移动到该状态。

在这两种情况下，应用程序委托都会收到 willResignActive:，然后是 didEnterBackground: 调用。因此，仅从应用程序委托调用来看，似乎无法确定差异。有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:23:15.557

[UIApplicationDelegate 协议](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html)有多种方法用于`Monitoring Application State Changes`.

不幸的是（对你来说），*进入后台*就是*进入后台*，对于为什么没有区别。鉴于 Apple 的应用程序设计将一切都隔离开（出于安全原因），我看不到他们为您提供有关应用程序之外手机上发生的事情的详细信息。

我当然会质疑在这两种情况下需要不同的行为，但我不知道你的应用程序的细节。

# java - 使用 gzip 压缩 InputStream

> ID：11036280
> 
> 赞同：22
> 
> 时间：2012-06-14T15:20:40.237
> 
> 标签：java, gzip

我想使用 Gzip 压缩在 java 中压缩输入流。

假设我们有一个未压缩的输入流（1GB 的数据......）。因此，我想要来自源的压缩输入流：

```
public InputStream getCompressedStream(InputStream unCompressedStream) {

    // Not working because it's uncompressing the stream, I want the opposite.
    return new GZIPInputStream(unCompressedStream); 

} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-10-11T20:13:03.607

DeflaterInputStream 不是您想要的，因为它缺少 gzip 标头/预告片并且使用稍微不同的压缩。

如果您从 OutputStream（推）更改为 InputStream（拉），您需要做不同的事情。

GzipOutputStream 的作用是：

*   写一个静态 gzip 头文件
*   使用 DeflaterOutputStream 编写一个放气的流。写入流时，从未压缩的数据构建 CRC32 校验和，并计算字节数
*   写一个包含 CRC32 校验和和字节数的尾部。

如果你想对 InputStreams 做同样的事情，你需要一个包含以下内容的流：

*   标题
*   泄气的内容
*   拖车

最好的方法是提供 3 个不同的流并将它们合并为一个。幸运的是，有 SequenceInputStream 可以为您组合流。

这是我的实现加上一个简单的单元测试：

```
import java.io.ByteArrayInputStream;
import java.io.FileInputStream;
import java.io.FilterInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.SequenceInputStream;
import java.util.Enumeration;
import java.util.zip.CRC32;
import java.util.zip.Deflater;
import java.util.zip.DeflaterInputStream;
import java.util.zip.DeflaterOutputStream;

/**
 * @author mwyraz
 * Wraps an input stream and compresses it's contents. Similiar to DeflateInputStream but adds GZIP-header and trailer
 * See GzipOutputStream for details.
 * LICENSE: Free to use. Contains some lines from GzipOutputStream, so oracle's license might apply as well!
 */
public class GzipCompressingInputStream extends SequenceInputStream
{
    public GzipCompressingInputStream(InputStream in) throws IOException
    {
        this(in,512);
    }
    public GzipCompressingInputStream(InputStream in, int bufferSize) throws IOException
    {
        super(new StatefullGzipStreamEnumerator(in,bufferSize));
    }

    static enum StreamState
    {
        HEADER,
        CONTENT,
        TRAILER
    }

    protected static class StatefullGzipStreamEnumerator implements Enumeration<InputStream>
    {

        protected final InputStream in;
        protected final int bufferSize;
        protected StreamState state;

        public StatefullGzipStreamEnumerator(InputStream in, int bufferSize)
        {
            this.in=in;
            this.bufferSize=bufferSize;
            state=StreamState.HEADER;
        }

        public boolean hasMoreElements()
        {
            return state!=null;
        }
        public InputStream nextElement()
        {
            switch (state)
            {
                case HEADER:
                    state=StreamState.CONTENT;
                    return createHeaderStream();
                case CONTENT:
                    state=StreamState.TRAILER;
                    return createContentStream();
                case TRAILER:
                    state=null;
                    return createTrailerStream();
            }
            return null;
        }

        static final int GZIP_MAGIC = 0x8b1f;
        static final byte[] GZIP_HEADER=new byte[] {
                (byte) GZIP_MAGIC,        // Magic number (short)
                (byte)(GZIP_MAGIC >> 8),  // Magic number (short)
                Deflater.DEFLATED,        // Compression method (CM)
                0,                        // Flags (FLG)
                0,                        // Modification time MTIME (int)
                0,                        // Modification time MTIME (int)
                0,                        // Modification time MTIME (int)
                0,                        // Modification time MTIME (int)
                0,                        // Extra flags (XFLG)
                0                         // Operating system (OS)
        };
        protected InputStream createHeaderStream()
        {
            return new ByteArrayInputStream(GZIP_HEADER);
        }
        protected InternalGzipCompressingInputStream contentStream;
        protected InputStream createContentStream()
        {
            contentStream=new InternalGzipCompressingInputStream(new CRC32InputStream(in), bufferSize);
            return contentStream;
        }
        protected InputStream createTrailerStream()
        {
            return new ByteArrayInputStream(contentStream.createTrailer());
        }
    }

    /**
     * Internal stream without header/trailer  
     */
    protected static class CRC32InputStream extends FilterInputStream
    {
        protected CRC32 crc = new CRC32();
        protected long byteCount;
        public CRC32InputStream(InputStream in)
        {
            super(in);
        }

        @Override
        public int read() throws IOException
        {
            int val=super.read();
            if (val>=0)
            {
                crc.update(val);
                byteCount++;
            }
            return val;
        }
        @Override
        public int read(byte[] b, int off, int len) throws IOException
        {
            len=super.read(b, off, len);
            if (len>=0)
            {
                crc.update(b,off,len);
                byteCount+=len;
            }
            return len;
        }
        public long getCrcValue()
        {
            return crc.getValue();
        }
        public long getByteCount()
        {
            return byteCount;
        }
    }

    /**
     * Internal stream without header/trailer  
     */
    protected static class InternalGzipCompressingInputStream extends DeflaterInputStream
    {
        protected final CRC32InputStream crcIn;
        public InternalGzipCompressingInputStream(CRC32InputStream in, int bufferSize)
        {
            super(in, new Deflater(Deflater.DEFAULT_COMPRESSION, true),bufferSize);
            crcIn=in;
        }
        public void close() throws IOException
        {
            if (in != null)
            {
                try
                {
                    def.end();
                    in.close();
                }
                finally
                {
                    in = null;
                }
            }
        }

        protected final static int TRAILER_SIZE = 8;

        public byte[] createTrailer()
        {
            byte[] trailer= new byte[TRAILER_SIZE];
            writeTrailer(trailer, 0);
            return trailer;
        }

        /*
         * Writes GZIP member trailer to a byte array, starting at a given
         * offset.
         */
        private void writeTrailer(byte[] buf, int offset)
        {
            writeInt((int)crcIn.getCrcValue(), buf, offset); // CRC-32 of uncompr. data
            writeInt((int)crcIn.getByteCount(), buf, offset + 4); // Number of uncompr. bytes
        }

        /*
         * Writes integer in Intel byte order to a byte array, starting at a
         * given offset.
         */
        private void writeInt(int i, byte[] buf, int offset)
        {
            writeShort(i & 0xffff, buf, offset);
            writeShort((i >> 16) & 0xffff, buf, offset + 2);
        }

        /*
         * Writes short integer in Intel byte order to a byte array, starting
         * at a given offset
         */
        private void writeShort(int s, byte[] buf, int offset)
        {
            buf[offset] = (byte)(s & 0xff);
            buf[offset + 1] = (byte)((s >> 8) & 0xff);
        }
    }

} 
```

* * *

```
import static org.junit.Assert.*;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Arrays;
import java.util.zip.CRC32;
import java.util.zip.GZIPInputStream;

import org.junit.Test;

public class TestGzipCompressingInputStream
{

    @Test
    public void test() throws Exception
    {
        testCompressor("test1 test2 test3");
        testCompressor("1MB binary data",createTestPattern(1024*1024));
        for (int i=0;i<4096;i++)
        {
            testCompressor(i+" bytes of binary data",createTestPattern(i));
        }
    }

    protected byte[] createTestPattern(int size)
    {
        byte[] data=new byte[size];
        byte pattern=0;
        for (int i=0;i<size;i++)
        {
            data[i]=pattern++;
        }
        return data;
    }

    protected void testCompressor(String data) throws IOException
    {
        testCompressor("String: "+data,data.getBytes());
    }
    protected void testCompressor(String dataInfo, byte[] data) throws IOException
    {
        InputStream uncompressedIn=new ByteArrayInputStream(data);
        InputStream compressedIn=new GzipCompressingInputStream(uncompressedIn);
        InputStream uncompressedOut=new GZIPInputStream(compressedIn);

        byte[] result=StreamHelper.readBinaryStream(uncompressedOut);

        assertTrue("Test failed for: "+dataInfo,Arrays.equals(data,result));

    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-12T15:14:29.333

在流行的开源 ESB [Mule](https://en.wikipedia.org/wiki/Mule_%28software%29)中可以找到压缩输入流的工作示例：[`GZIPCompressorInputStream`](https://github.com/mulesoft/mule/blob/98e3a382bc9698d0a9503be3ecfda7e94f64888a/core/src/main/java/org/mule/util/compression/GZIPCompressorInputStream.java).

它使用[`DeflaterInputStream`](http://docs.oracle.com/javase/6/docs/api/java/util/zip/DeflaterInputStream.html)JRE 提供的压缩包，预先添加[gzip](https://en.wikipedia.org/wiki/Gzip)标头并附加 gzip 预告片（也称为页脚）。

不幸的是，它在[CPA License](https://en.wikipedia.org/wiki/Common_Public_Attribution_License)下，这似乎并不常见。此外，似乎没有单元测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-10T09:42:45.857

如果您不想将内容加载到大字节数组中并且需要真正的流式解决方案：

```
package x.y.z;

import org.apache.commons.io.IOUtils;

import java.io.*;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.zip.GZIPInputStream;
import java.util.zip.GZIPOutputStream;
import java.util.zip.ZipOutputStream;

/**
 * Stream Compression Utility
 *
 * @author Thamme Gowda N
 */
public enum CompressionUtil {
    INSTANCE;

    public static final int NUM_THREADS = 5;
    private final ExecutorService pool;

    CompressionUtil(){
        this.pool = Executors.newFixedThreadPool(NUM_THREADS);
    }

    public static CompressionUtil getInstance(){
        return INSTANCE;
    }

    /**
     * Supported compression type names
     */
    public static enum CompressionType {
        GZIP,
        ZIP
    }

    /**
     * Wraps the given stream in a Compressor stream based on given type
     * @param sourceStream : Stream to be wrapped
     * @param type         : Compression type
     * @return source stream wrapped in a compressor stream
     * @throws IOException when some thing bad happens
     */
    public static OutputStream getCompressionWrapper(OutputStream sourceStream,
                                     CompressionType type) throws IOException {

        switch (type) {
            case GZIP:
                return new GZIPOutputStream(sourceStream);
            case ZIP:
                return new ZipOutputStream(sourceStream);
            default:
                throw new IllegalArgumentException("Possible values :"
                        + Arrays.toString(CompressionType.values()));
        }
    }

    /**
     * Gets Compressed Stream for given input Stream
     * @param sourceStream  : Input Stream to be compressed to
     * @param type: Compression types such as GZIP
     * @return  Compressed Stream
     * @throws IOException when some thing bad happens
     */
    public static InputStream getCompressedStream(final InputStream sourceStream,
                                    CompressionType type ) throws IOException {

        if(sourceStream == null) {
            throw new IllegalArgumentException("Source Stream cannot be NULL");
        }

        /**
         *  sourceStream --> zipperOutStream(->intermediateStream -)--> resultStream
         */
        final PipedInputStream resultStream = new PipedInputStream();
        final PipedOutputStream intermediateStream = new PipedOutputStream(resultStream);
        final OutputStream zipperOutStream = getCompressionWrapper(intermediateStream, type);

        Runnable copyTask = new Runnable() {

            @Override
            public void run() {
                try {
                    int c;
                    while((c = sourceStream.read()) >= 0) {
                        zipperOutStream.write(c);
                    }
                    zipperOutStream.flush();
                } catch (IOException e) {
                    IOUtils.closeQuietly(resultStream);  // close it on error case only
                    throw new RuntimeException(e);
                } finally {
                    // close source stream and intermediate streams
                    IOUtils.closeQuietly(sourceStream);
                    IOUtils.closeQuietly(zipperOutStream);
                    IOUtils.closeQuietly(intermediateStream);
                }
            }
        };
        getInstance().pool.submit(copyTask);
        return resultStream;
    }

    public static void main(String[] args) throws IOException {
        String input = "abcdefghij";
        InputStream sourceStream = new ByteArrayInputStream(input.getBytes());
        InputStream compressedStream =
                getCompressedStream(sourceStream, CompressionType.GZIP);

        GZIPInputStream decompressedStream = new GZIPInputStream(compressedStream);
        List<String> lines = IOUtils.readLines(decompressedStream);
        String output = lines.get(0);
        System.out.println("test passed ? " + input.equals(output));

    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-03-31T13:55:42.110

这是我编写的一个版本，其中没有 CRC/GZIP Magic cookie，因为它委托给 GZIPOutputStream。它还具有内存效率，因为它只使用足够的内存来缓冲压缩（42MB 文件使用 45k 缓冲区）。性能与压缩到内存相同。

```
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.zip.GZIPOutputStream;

/**
 * Compresses an InputStream in a memory-optimal, on-demand way only compressing enough to fill a buffer.
 * 
 * @author Ben La Monica
 */
public class GZIPCompressingInputStream extends InputStream {

    private InputStream in;
    private GZIPOutputStream gz;
    private OutputStream delegate;
    private byte[] buf = new byte[8192];
    private byte[] readBuf = new byte[8192];
    int read = 0;
    int write = 0;

    public GZIPCompressingInputStream(InputStream in) throws IOException {
        this.in = in;
        this.delegate = new OutputStream() {

            private void growBufferIfNeeded(int len) {
                if ((write + len) >= buf.length) {
                    // grow the array if we don't have enough space to fulfill the incoming data
                    byte[] newbuf = new byte[(buf.length + len) * 2];
                    System.arraycopy(buf, 0, newbuf, 0, buf.length);
                    buf = newbuf;
                }
            }

            @Override
            public void write(byte[] b, int off, int len) throws IOException {
                growBufferIfNeeded(len);
                System.arraycopy(b, off, buf, write, len);
                write += len;
            }

            @Override
            public void write(int b) throws IOException {
                growBufferIfNeeded(1);
                buf[write++] = (byte) b;
            }
        };
        this.gz = new GZIPOutputStream(delegate); 
    }

    @Override
    public int read(byte[] b, int off, int len) throws IOException {
        compressStream();
        int numBytes = Math.min(len, write-read);
        if (numBytes > 0) {
            System.arraycopy(buf, read, b, off, numBytes);
            read += numBytes;
        } else if (len > 0) {
            // if bytes were requested, but we have none, then we're at the end of the stream
            return -1;
        }
        return numBytes;
    }

    private void compressStream() throws IOException {
        // if the reader has caught up with the writer, then zero the positions out
        if (read == write) {
            read = 0;
            write = 0;
        }

        while (write == 0) {
            // feed the gzip stream data until it spits out a block
            int val = in.read(readBuf);
            if (val == -1) {
                // nothing left to do, we've hit the end of the stream. finalize and break out
                gz.close();
                break;
            } else if (val > 0) {
                gz.write(readBuf, 0, val);
            }
        }
    }

    @Override
    public int read() throws IOException {
        compressStream();
        if (write == 0) {
            // write should not be 0 if we were able to get data from compress stream, must mean we're at the end
            return -1;
        } else {
            // reading a single byte
            return buf[read++] & 0xFF;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-01-21T16:46:07.627

看来我迟到了 3 年，但也许对某人有用。我的解决方案类似于@Michael Wyraz 的解决方案，唯一的区别是我的解决方案是基于`FilterInputStream`

```
import java.io.ByteArrayInputStream;
import java.io.FilterInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.zip.CRC32;
import java.util.zip.Deflater;

public class GZipInputStreamDeflater extends FilterInputStream {

    private static enum Stage {
        HEADER,
        DATA,
        FINALIZATION,
        TRAILER,
        FINISH
    }

    private GZipInputStreamDeflater.Stage stage = Stage.HEADER;

    private final Deflater deflater = new Deflater( Deflater.DEFLATED, true );
    private final CRC32 crc = new CRC32();

    /* GZIP header magic number */
    private final static int GZIP_MAGIC = 0x8b1f;

    private ByteArrayInputStream trailer = null;
    private ByteArrayInputStream header = new ByteArrayInputStream( new byte[] {
        (byte) GZIP_MAGIC, // Magic number (short)
        (byte) ( GZIP_MAGIC >> 8 ), // Magic number (short)
        Deflater.DEFLATED, // Compression method (CM)
        0, // Flags (FLG)
        0, // Modification time MTIME (int)
        0, // Modification time MTIME (int)
        0, // Modification time MTIME (int)
        0, // Modification time MTIME (int)
        0, // Extra flags (XFLG)
        0, // Operating system (OS)
    } );

    public GZipInputStreamDeflater(InputStream in) {
        super( in );
        crc.reset();
    }

    @Override
    public int read( byte[] b, int off, int len ) throws IOException {
        int read = -1;

        switch( stage ) {
            case FINISH:
                return -1;
            case HEADER:
                read = header.read( b, off, len );
                if( header.available() == 0 ) {
                    stage = Stage.DATA;
                }
                return read;
            case DATA:
                byte[] b2 = new byte[len];
                read = super.read( b2, 0, len );
                if( read <= 0 ) {
                    stage = Stage.FINALIZATION;
                    deflater.finish();
                    return 0;
                }
                else {
                    deflater.setInput( b2, 0, read );
                    crc.update( b2, 0, read );
                    read = 0;
                    while( !deflater.needsInput() && len - read > 0 ) {
                        read += deflater.deflate( b, off + read, len - read, Deflater.NO_FLUSH );
                    }
                    return read;
                }
            case FINALIZATION:
                if( deflater.finished() ) {
                    stage = Stage.TRAILER;

                    int crcVaue = (int) crc.getValue();
                    int totalIn = deflater.getTotalIn();

                    trailer = new ByteArrayInputStream( new byte[] {
                        (byte) ( crcVaue >> 0 ),
                        (byte) ( crcVaue >> 8 ),
                        (byte) ( crcVaue >> 16 ),
                        (byte) ( crcVaue >> 24 ),

                        (byte) ( totalIn >> 0 ),
                        (byte) ( totalIn >> 8 ),
                        (byte) ( totalIn >> 16 ),
                        (byte) ( totalIn >> 24 ),
                    } );

                    return 0;
                }
                else {
                    read = deflater.deflate( b, off, len, Deflater.FULL_FLUSH );
                    return read;
                }
            case TRAILER:
                read = trailer.read( b, off, len );
                if( trailer.available() == 0 ) {
                    stage = Stage.FINISH;
                }
                return read;
        }
        return -1;
    }

    @Override
    public void close( ) throws IOException {
        super.close();
        deflater.end();
        if( trailer != null ) {
            trailer.close();
        }
        header.close();
    }
} 
```

用法：

```
AmazonS3Client s3client = new AmazonS3Client( ... );
try ( InputStream in = new GZipInputStreamDeflater( new URL( "http://....../very-big-file.csv" ).openStream() ); ) {
    PutObjectRequest putRequest = new PutObjectRequest( "BUCKET-NAME", "/object/key", in, new ObjectMetadata() );
    s3client.putObject( putRequest );
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-09-08T15:18:41.597

[PipedOutputStream](https://docs.oracle.com/javase/8/docs/api/java/io/PipedOutputStream.html)允许您写入 GZIPOutputStream 并通过 InputStream 公开该数据。与将整个数据流缓冲到数组或文件的其他解决方案不同，它具有固定的内存成本。唯一的问题是你不能从同一个线程读取和写入，你必须使用一个单独的线程。

```
private InputStream gzipInputStream(InputStream in) throws IOException {
    PipedInputStream zipped = new PipedInputStream();
    PipedOutputStream pipe = new PipedOutputStream(zipped);
    new Thread(
            () -> {
                try(OutputStream zipper = new GZIPOutputStream(pipe)){
                    IOUtils.copy(in, zipper);
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
    ).start();
    return zipped;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-14T15:35:26.960

要压缩数据，您需要`GZIPOutputStream`. 但是由于您需要像从 InputStream 中一样读取数据，因此您需要将 OutputStream 转换为 InputStream。您可以使用 getBytes() 这样做：

```
GZIPOutputStream gout = new GZIPOutputStream(out);
//... Code to read from your original uncompressed data and write to out.

//Convert to InputStream.
new ByteArrayInputStream(gout.getBytes()); 
```

但是这种方法有一个限制，即您需要首先读取所有数据 - 这意味着您必须有足够的内存来保存该缓冲区。

此线程中提到了使用管道的替代方法 -[如何将 OutputStream 转换为 InputStream？](https://stackoverflow.com/questions/5778658/java-converting-from-outputstream-to-inputstream)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-14T15:43:39.173

JRE中没有`DeflatingGZIPInputStream`。要使用“deflate”压缩格式进行放气，请使用`java.util.zip.DeflaterInputStream`and `java.util.zip.DeflaterOutputStream`：

```
public InputStream getCompressedStream(InputStream unCompressedStream) {
    return new DeflaterInputStream(unCompressedStream); 
} 
```

您可以`java.util.zip.DeflaterInputStream`通过查看`java.util.zip.GZIPOutputStream`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-06-14T15:29:36.887

你不应该`GZIPOutputStream`在那种情况下看吗？

```
public OutputStream getCompressedStream(InputStream input) {
    OutputStream output = new GZIPOutputStream(new ByteArrayOutputStream()); 
    IOUtils.copy(input, output);
    return output;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-23T12:56:21.183

您可以使用[EasyStream](http://io-tools.sourceforge.net/easystream/)。

```
try(final InputStreamFromOutputStream<Void> isOs = new InputStreamFromOutputStream<Void>() {
    @Override
    protected void produce(final OutputStream dataSink) throws Exception {
        InputStream in = new GZIPInputStream(unCompressedStream);
        IOUtils.copy(in, dataSink);
    }
}) {        

    //You can use the compressed input stream here

} catch (final IOException e) {
    //Handle exceptions here
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-08T02:14:16.713

```
public InputStream getCompressed( InputStream is ) throws IOException
{
    byte data[] = new byte[2048];
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    GzipOutputStream zos = new GzipOutputStream( bos );
    BufferedInputStream entryStream = new BufferedInputStream( is, 2048);
    int count;
    while ( ( count = entryStream.read( data, 0, 2048) ) != -1 )
    {
        zos.write( data, 0, count );
    }
    entryStream.close();
    zos.close();

    return new ByteArrayInputStream( bos.toByteArray() );
} 
```

参考 : [zip 压缩](https://stackoverflow.com/questions/20221128/convert-zipoutputstream-to-bytearrayinputstream?answertab=votes#tab-top)

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2016-08-02T14:21:24.113

我建议使用来自[Apache Commons Compress的](https://commons.apache.org/proper/commons-compress/)[GzipCompressorInputStream](https://commons.apache.org/proper/commons-compress/apidocs/org/apache/commons/compress/compressors/gzip/GzipCompressorInputStream.html)。

# sql-server - 如何在 SQL Server 中创建 PDF 数据库图？

> ID：11036284
> 
> 赞同：12
> 
> 时间：2012-06-14T15:20:46.650
> 
> 标签：sql-server, pdf, er-diagrams

我有一个相对较小的数据库，我想为其生成图表，然后创建该图表的 pdf。我在 SQL Server 中创建了图表（所有表都适合 pdf 文档的一页），但无法弄清楚如何将其导出到文档中。这可能吗？我发现的唯一选择是将其复制到剪贴板，然后将其粘贴到 Word 文档中，但质量不是很好。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2017-05-05T06:24:52.433

使用 SQL Server Management Studio 2014：

1.  右键单击图表区域
2.  在菜单栏上选择“数据库图”>>“将图复制到剪贴板”
3.  打开 MS Word 并粘贴

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-14T15:27:15.560

我自己没有使用它，但[SchemaSpy](http://schemaspy.sourceforge.net/)似乎能够使用 Graphviz 绘制 ERD，它可以输出到 ps2（以及许多其他格式）并转换为 PDF。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-01-31T15:30:53.243

要以 PDF 格式显示图表，请执行以下步骤：

*   单击图表区域中的任意位置
*   右键单击->复制到剪贴板
*   将其粘贴到绘图窗口中
*   将其保存为 png 图像
*   打开浏览器并搜索png to pdf转换器在线工具
*   将其转换为 pdf

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-07T08:36:48.457

只需将其打印为 PDF 或另存为 PDF。

**步骤 1：**右键单击图表区域并**选择全部**

或者

拿着班次一一选择所有表

**文件 ---> 打印 ----> Adob​​e PDF / Microsoft to PDF ---> 打印按钮**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-11-12T09:53:57.877

为了更好的质量在sql server management studio中生成图表后

转到**文件 -> 页面设置**

将打印比例设置为 10 或更低。将纸张尺寸选择为小报 将方向设置为横向 设置打印机名称 microsoft print 为 pdf 之后按 ok [![在此处输入图像描述](../Images/0625f0a2393f8a8369d9279269cd669c.png)](https://i.stack.imgur.com/obIk3.jpg)

并返回生成的图表右键单击并选择查看分页符

[![在此处输入图像描述](../Images/950d6988dc66aae453ad884ee82bbe7c.png)](https://i.stack.imgur.com/29FaG.png)

现在您可以将每个表格拖放到您想要的页面内。

之后点击**文件 - >打印** 选择Microsoft打印到PDF并点击**打印**按钮。

您将获得 ER 图的 PDF

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-14T15:22:55.623

对于这类事情，我最喜欢的工具是[CutePDF](http://www.cutepdf.com/)。您可以只打印图表，然后您可以从打印机对话框中选择 CutePDF 编写器，它会将其打印为 PDF（您可以选择要打印的文件）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-04T14:48:16.923

步骤 1：右键单击图表区域，然后`SELECT ALL`

第2步：文件->打印->选择默认值：`Microsoft XPS Document Writer`

第 3 步：创建`*.oxps`的文件转换为`PDF`on`http://oxpstopdf.com/`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-01T21:45:29.110

打印到 OneNote，然后导出为 PDF。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-20T22:07:01.863

Akhil 的解决方案对我有用。也可以根据图修改分辨率的%

# objective-c - Xcode 截图 EAGLContext

> ID：11036288
> 
> 赞同：1
> 
> 时间：2012-06-14T15:20:59.693
> 
> 标签：objective-c, xcode, uiimage, screenshot, eaglcontext

> **可能重复：**
> [如何从 EAGLView 获取 UIImage？](https://stackoverflow.com/questions/1352864/how-to-get-uiimage-from-eaglview)

所以我只是想知道是否有人知道将存储在 EAGLContext 中的内容保存为 UIImage 的任何方法。

我目前正在使用：

```
UIGraphicsBeginImageContext(CGSizeMake(768, 1024));
[self.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

在我拥有的其他应用程序中，这工作正常，但显然，EAGLContext 没有 .layer 属性。我已经尝试投射到 UIView，但是这 - 不出所料 - 不起作用：

```
UIView *newView = [[UIView alloc] init];
newView = (UIView *)context; 
```

我正在使用 OpenGLES 1 绘制 UIView 上的 EAGLContext 属性（技术上是视图控制器上另一个 UIView 上的 UIView 上的 EAGLContext，但我认为这不应该有任何区别）。

如果有人对此有所了解，即使只是我完全在吠叫一棵不可能的树，也请告诉我！

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T15:30:06.600

几天后，我终于找到了一个可行的解决方案。Apple 提供了从 EAGLView 生成 UIImage 的代码。然后你只需要垂直翻转图像，因为 UIKit 是倒置的。我发现此方法的文档的链接不再存在。

捕捉EAGLView的方法：

```
-(UIImage *)drawableToCGImage 
{
    GLint backingWidth2, backingHeight2;
    //Bind the color renderbuffer used to render the OpenGL ES view
    // If your application only creates a single color renderbuffer which is already bound at this point,
    // this call is redundant, but it is needed if you're dealing with multiple renderbuffers.
    // Note, replace "_colorRenderbuffer" with the actual name of the renderbuffer object defined in your class.
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);

    // Get the size of the backing CAEAGLLayer
    glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &backingWidth2);
    glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &backingHeight2);

    NSInteger x = 0, y = 0, width2 = backingWidth2, height2 = backingHeight2;
    NSInteger dataLength = width2 * height2 * 4;
    GLubyte *data = (GLubyte*)malloc(dataLength * sizeof(GLubyte));

    // Read pixel data from the framebuffer
    glPixelStorei(GL_PACK_ALIGNMENT, 4);
    glReadPixels(x, y, width2, height2, GL_RGBA, GL_UNSIGNED_BYTE, data);

    // Create a CGImage with the pixel data
    // If your OpenGL ES content is opaque, use kCGImageAlphaNoneSkipLast to ignore the alpha channel
    // otherwise, use kCGImageAlphaPremultipliedLast
    CGDataProviderRef ref = CGDataProviderCreateWithData(NULL, data, dataLength, NULL);
    CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
    CGImageRef iref = CGImageCreate(width2, height2, 8, 32, width2 * 4, colorspace, kCGBitmapByteOrder32Big | kCGImageAlphaPremultipliedLast,
                                    ref, NULL, true, kCGRenderingIntentDefault);

    // OpenGL ES measures data in PIXELS
    // Create a graphics context with the target size measured in POINTS
    NSInteger widthInPoints, heightInPoints;
    if (NULL != UIGraphicsBeginImageContextWithOptions) {
        // On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
        // Set the scale parameter to your OpenGL ES view's contentScaleFactor
        // so that you get a high-resolution snapshot when its value is greater than 1.0
        CGFloat scale = self.contentScaleFactor;
        widthInPoints = width2 / scale;
        heightInPoints = height2 / scale;
        UIGraphicsBeginImageContextWithOptions(CGSizeMake(widthInPoints, heightInPoints), NO, scale);
    }
    else {
        // On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
        widthInPoints = width2;
        heightInPoints = height2;
        UIGraphicsBeginImageContext(CGSizeMake(widthInPoints, heightInPoints));
    }

    CGContextRef cgcontext = UIGraphicsGetCurrentContext();

    // UIKit coordinate system is upside down to GL/Quartz coordinate system
    // Flip the CGImage by rendering it to the flipped bitmap context
    // The size of the destination area is measured in POINTS
    CGContextSetBlendMode(cgcontext, kCGBlendModeCopy);
    CGContextDrawImage(cgcontext, CGRectMake(0.0, 0.0, widthInPoints, heightInPoints), iref);

    // Retrieve the UIImage from the current context
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    // Clean up
    free(data);
    CFRelease(ref);
    CFRelease(colorspace);
    CGImageRelease(iref);

    return image;
} 
```

垂直翻转图像的方法：

```
- (UIImage *)flipImageVertically:(UIImage *)originalImage 
{
    UIImageView *tempImageView = [[UIImageView alloc] initWithImage:originalImage];
    UIGraphicsBeginImageContext(tempImageView.frame.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGAffineTransform flipVertical = CGAffineTransformMake(
                                                           1, 0, 0, -1, 0, tempImageView.frame.size.height
                                                           );
    CGContextConcatCTM(context, flipVertical);

    [tempImageView.layer renderInContext:context];

    UIImage *flippedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    //[tempImageView release];

    return flippedImage;
} 
```

# asp.net - 如何更改此控制器以获取多个记录，使用 ASP.Net MVC Web API？

> ID：11036293
> 
> 赞同：0
> 
> 时间：2012-06-14T15:21:12.530
> 
> 标签：asp.net, asp.net-mvc, asp.net-web-api

我有一个预订应用程序，它接受一个“预订”对象，并且工作正常。我的问题是，如何将其转换为接受多个记录（来自 JSON）：

Booking.cs

```
namespace MvcApplication4.Models
{
    public class Booking
    {
        [Key()]
        public long ID { get; set; }
        public long? HID { get; set; }
        public long RID { get; set; }
        public string Occ { get; set; }
        public DateTime CI { get; set; }
        public DateTime CO { get; set; }
        public long? CID { get; set; }
    }
} 
```

BookingsContext.cs

```
namespace MvcApplication4.Models
{
    public class BookingsContext : DbContext
    {
    public BookingsContext() : base("name=BookingsContext")
    {
    }
    public DbSet<Booking> Bookings { get; set; }            
    }
} 
```

BookingsController.cs

```
 // POST api/Bookings
        public HttpResponseMessage PostBooking(Booking booking)
        {
            if (ModelState.IsValid)
            {
                    // Add the booking
                    db.Bookings.Add(booking);
                    db.SaveChanges();
                    HttpResponseMessage response = Request.CreateResponse(HttpStatusCode.Created, booking);
                    response.Headers.Location = new Uri(Url.Link("DefaultApi", new { id = booking.RID }));
                    return response;
                }
            } 
```

当前传递的 JSON 是：

```
var comment = {ID:0, HID: $('#HID').val(), RID:$('#RID').val(), Occ:$('#Occ').val(), CI:$('#CI').val(), CO:$('#CO').val(), CID:$('#CID').val()},{ID:0, HID: $('#HID').val(), RID:$('#RID').val(), Occ:$('#Occ').val(), CI:$('#CI').val(), CO:$('#CO').val(), CID:$('#CID').val()}; 
```

如何将多条记录传递给控制器​​，这样我就不必多次调用 JSON Post 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:24:50.833

您可以修改您的操作签名以进行预订数组：

```
public HttpResponseMessage PostBooking(Booking[] bookings)
{
    ...
} 
```

然后从客户端发送一系列预订：

```
var bookings =
    [
        {
            ID: 0,
            HID: 'hid1',
            RID: 'rid1',
            Occ: 'occ1',
            CI: 'ci1',
            CO: 'co1',
            CID: 'cid1'
        },
        {
            ID: 1,
            HID: 'hid2',
            RID: 'rid2',
            Occ: 'occ2',
            CI: 'ci2',
            CO: 'co2',
            CID: 'cid2'
        }
    ]; 
```

# mysql - 计算具有特定列的所有行并按周分组

> ID：11036294
> 
> 赞同：2
> 
> 时间：2012-06-14T15:21:14.970
> 
> 标签：mysql, sql

一段时间以来，我一直在尝试创建一个查询，该查询每天计算表中包含具有特定 ID 的列的所有行，然后根据 UNIX 时间戳列将它们分组为每周值。我有一个包含 3700 万行的中型数据集，并且一直在尝试运行以下类型的查询：

```
SELECT DATE(timestamp), COUNT(*) FROM `table` WHERE ( date(timestamp) 
between "YYYY-MM-DD" and "YYYY-MM-DD" and column_group_id=X ) 
group by week(date(startdate)) 
```

虽然我得到了奇怪的结果，并且查询没有正确分组计数，但在结果计数列上显示了太大的值（我通过查询非常小的特定数据集来验证值错误。）

如果我`date(startdate)`改为分组，则行数每天匹配，但我想将这些每日行数与每周数相结合。这怎么可能？需要以下格式的数据：

```
2006-01-01 | 5 
2006-01-08 | 10 
```

所以日期时间戳是第一列，第二列是每周的行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:48:44.083

您的查询是不确定的，因此您得到意想不到的结果也就不足为奇了。我的意思是您可以对相同的数据运行此查询 5 次并获得 5 个不同的结果集。这是由于您选择`DATE(timestamp)`但按 分组的事实`WEEK(DATE(startdate))`，因此查询将返回它在每个 startdate 周以**任何**顺序出现的第一行的时间。

考虑以下 2 行（为便于阅读，时间戳采用日期格式）：

```
TimeStamp       StartDate
20120601        20120601
20120701        20120601 
```

您的查询按 23 进行分组`WEEK(StartDate)`，因为两行的计算结果相同，因此您希望结果有 1 行，计数为 2。

**HOWEVER** `DATE(Timestamp)`也在选择列表中，由于没有`ORDER BY`语句，查询不知道返回“20120601”或“20120701”的时间戳。因此，即使在这个小结果集上，您也有 50:50 的机会获得：

```
TimeStamp       COUNT
20120601        2 
```

并有 50:50 的机会获得

```
TimeStamp       COUNT
20120701        2 
```

如果您像这样向数据集添加更多数据：

```
TimeStamp       StartDate
20120601        20120601
20120701        20120601
20120701        20120701 
```

你可以得到

```
TimeStamp       COUNT
20120601        2
20120701        1 
```

或者

```
TimeStamp       COUNT
20120701        2
20120701        1 
```

您可以看到，使用 37,000,000 行，您很快就会得到您不期望也无法预测的结果！

**编辑**

由于看起来您正在尝试在结果中获取 weekstart，而按周分组，您可以使用以下内容来获取一周开始（用您想要的任何列替换 CURRENT_TIMESTAMP）：

```
SELECT  DATE_ADD(CURRENT_TIMESTAMP, INTERVAL 1 - DAYOFWEEK(CURRENT_TIMESTAMP) DAY) AS WeekStart 
```

然后，您也可以按此日期分组以获得每周结果，并避免在您的选择列表中出现不在您分组依据的内容的麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:43:54.710

试试这个

```
SELECT DATE(timestamp), COUNT(week(date(startdate))) FROM `table` WHERE ( date(timestamp) 
between "YYYY-MM-DD" and "YYYY-MM-DD" and column_group_id=X ) 
group by week(date(startdate)) 
```

# sql - 基本 SQL Select 语句 - 如何找到总和？

> ID：11036299
> 
> 赞同：2
> 
> 时间：2012-06-14T15:21:55.137
> 
> 标签：sql, sum, aggregate-functions

我想在我的表中找到特定值的总和和计数。

在我的具体情况下，该表称为`product`. 表的列名是`'id`、`product_id`和。 `quantity``shipping_price`

该表包含：（基于`SELECT * FROM product;`）

```
product_id:1    quantity:1     end_price:15     shipping_price:1
product_id:2    quantity:2     end_price:15     shipping_price:0
product_id:1    quantity:1     end_price:15     shipping_price:1
product_id:2    quantity:1     end_price:15     shipping_price:0
product_id:1    quantity:1     end_price:15     shipping_price:1
product_id:3    quantity:1     end_price:15     shipping_price:0 
```

我需要一个 SQL 语句，它将选择具有相同 的行数，`product_id`得到 和 的总和。`quantity``end_price``shipping_price`

对于此示例，我希望 SQL 语句返回项目 1：

```
product_id:1    quantity:3    end_price:45    shipping_price:3 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T15:24:16.110

您可以使用`SUM`聚合函数，将结果按`product_id`.

```
SELECT  product_id,
        SUM(quantity) quantity,
        SUM(end_price) end_price,
        SUM(shipping_price) shipping_price
FROM    product
GROUP BY product_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:25:32.130

```
SELECT product_id, SUM(quantity), SUM(end_price), SUM(shipping_price) FROM product GROUP BY product_id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:24:16.780

```
SELECT product_id, sum(quantity), sum(end_price), sum(shipping_price) FROM product
group by product_id 
```

# oracle - ORA-01460: 请求的转换未实现或不合理

> ID：11036300
> 
> 赞同：8
> 
> 时间：2012-06-14T15:21:56.687
> 
> 标签：oracle, odp.net

当我运行以下 .Net 代码时：

```
using (var c = Shared.DataSources.BSS1.CreateCommand())
{
    c.CommandText = "\r\nSelect c1, c2, c3, rowid \r\nFrom someSpecificTable \r\nWhere c3 = :p0";
    var p = c.CreateParameter() as Oracle.DataAccess.Client.OracleParameter;
    c.Parameters.Add(p);
    p.OracleDbType = Oracle.DataAccess.Client.OracleDbType.Varchar2;
    p.DbType = System.Data.DbType.AnsiString;
    p.Size = 20;
    p.Value = "007";
    p.ParameterName = ":p0";
    using (var r = c.ExecuteReader())
    {
        r.Read();
    }
} 
```

我收到以下错误：

```
ORA-01460: unimplemented or unreasonable conversion requested
ORA-02063: preceding line from XXX 
```

这不是我的数据库，我无法控制我得到的选择语句，该表来自数据库链接。

有趣的是，如果我在 ExecuteReader 之前添加以下代码，它运行良好。

```
c.CommandText = c.CommandText.Replace("\r\n", " "); 
```

不幸的是，在我的情况下这不是一个好的解决方案，因为我无法控制 SQL，我也不能那样改变它。

至于表本身，列是：c1 Number(5) c2 varchar2(40) c3 varchar2(20)。

我知道之后出现的 ORA-02063 表示有关数据库链接的某些内容，但我查看了同义词表，它不是来自任何 database_link，而且我认为 \r\n 不会影响数据库链接。

我尝试在没有绑定参数的情况下运行查询，它确实有效 - 但笼统地说，这样做也是不好的做法。

问题是一个不基于.Net 的竞争工具正在工作，因此这不是一个普遍的问题。

我也无法在我自己的环境中重现该问题，这是一个客户数据库和站点。我正在使用即时客户端 11.1.6.20 并使用即时客户端 11.2.3.0 对其进行了测试

db 为 10，db 链接指向 oracle v8 数据库

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-01-12T09:14:37.417

可以通过直接的步骤重新创建此问题。也就是说，任何具有字符串文字的 SQL 查询，在 where 子句中，长度超过 4000 个字符都会给出错误“ORA-01704：字符串文字太长”

但是，当通过 JDBC 执行相同的查询时，它会给出“ORA-01460：未实现或不合理的转换请求”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-04T14:01:38.417

**Finally I found the answer!!!**

After investigating and reflecting into the code I found that by changing the Direction of the Parameter to input output - the problem was resolved.

```
p.Direction = ParameterDirection.InputOutput; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-10T08:11:47.780

经过大量调查，我发现这完全是因为我们绑定了从 ODP.NET 使用的参数，并将 DBLINK 中的表定位到 V8 Oracle 服务器。

一旦我消除了绑定参数，它就全部起作用了。

It was a while back, but I think it's had something to do with varying string lengths of the strings sent to the bound parameter. It seems that it ignored the size property, so if in the first query I sent a string with length 10 and in the second string I sent a string with length 12, I'll get that error.

I also found the oracle articles about it : [https://community.oracle.com/thread/2460796?tstart=0](https://community.oracle.com/thread/2460796?tstart=0)

and the patch for it: [https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=745005.1](https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=745005.1)

But - I found a fix in my code that actually solved it - see my next answer.

Hope this helps anyone.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-18T09:32:19.793

接受的答案对我不起作用。然而，在阅读了附加的链接之后，我应用了以下内容——尽管它确实涉及编辑 SQL。

就我而言，我知道绑定变量的最大左侧（第一次调用后长度减少是导致问题的原因）。所以我填充了 .NET 字符串，并`TRIM`在 SQL 中添加了一个。按照你的例子：

```
c.CommandText = "\r\nSelect c1, c2, c3, rowid \r\nFrom someSpecificTable \r\nWhere c3 = TRIM(:p0)";
...
p.Value = "007".PadRight(10); 
```

# objective-c - 获取 UIViewController 以编程方式重新加载不同的 UIView

> ID：11036303
> 
> 赞同：0
> 
> 时间：2012-06-14T15:22:08.077
> 
> 标签：objective-c, ios, uiview, uiviewcontroller

我正在覆盖 UIViewController 中的 loadView 方法，如下所示：

```
-(void)loadView
{
    NSLog(@"HPSFormController loadView starting"); 

    HPSFormView* viewForThisController = [ [ HPSFormView alloc ] initWithFrame:_frame ] ;
    self.view = viewForThisController;

} 
```

当在视图中按下某个按钮时，相同的 UIViewController 再次获得控制权，此时我希望完全更改控制器显示的视图。如下：

```
-(void)buttonTapped
{
    ABCFormView* newview = [ [ ABCFormView alloc ] initWithFrame:_frame ] ;
    self.view = newview;
} 
```

但是，buttonTapped 方法不会加载第二个视图。而是显示一个完全空白的视图。

按下按钮时，如何让视图控制器重新加载完全不同的视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:32:10.333

> 但是，buttonTapped 方法不会加载第二个视图。而是显示一个完全空白的视图。

问题不可能出在您创建的方式上`ABCFormView`吗？我的意思是，原来的视图似乎被一个空视图所取代，所以检查后者是如何创建的......

发表评论后编辑：

如果您说视图是“在视图控制器中的 viewDidLoad 方法中创建的”，那么您应该实例化您的视图控制器：

```
@property (...) ABCFormViewController* newviewController;

....

-(void)buttonTapped
{
    self.newviewController = [ [ ABCFormViewController alloc ] init] ;
    self.view = newviewController.view;
} 
```

请记住，`newviewController`只要您使用它的受控，它就必须在附近`view`，否则您会崩溃。这就是我将其引用存储在属性中的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T01:23:40.267

如果不知道 ABCFormViewController 内部是什么，就很难分辨。我曾经在视图控制器上遇到了一些计时问题，我只需要生成视图，因为我想捕获它的内容以创建一个 pdf 文件（它的视图永远不会显示在屏幕上）。在那种情况下，我需要插入这样的代码：

```
 [newviewcontroller.view setneedsrefresh]; 
```

在我做之前

```
 otherVC.view = newviewcontroller.view; 
```

否则我会得到一个空白页。我相信我明白了这一点，因为当一切都整理好时，ARC 会释放 newviewcontroller，因此视图为零。在您的情况下，这可能不是问题。您是否需要将第二个和第三个视图控制器放入您的视图中，因为这样做更简单的方法是通过模态、弹出视图或导航控制器将控制权转移到其他视图控制器。另一种更常用的方法是在 XIB 中创建多个视图，然后将其加载到空白视图中，而不是为每个视图创建视图控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T03:49:40.240

显然你不能通过简单地设置 self.view = newView; 来让你的新视图可见。因为 newView 从未作为子视图添加到任何其他视图中 - 即不在窗口中。

如果您需要切换到不同的视图，您可能应该将 APSFormView 作为子视图添加到您的 viewcontroller.view，当您需要切换时，从父视图中删除 APSFormView，然后将 ABCFormView 作为新的子视图添加到 viewcontroller.view。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T04:09:54.307

如果您的 loadView 实现不需要做太多其他事情，最好使用故事板进行初始设置。很容易错过，但您可以在情节提要中指定视图应该是自定义类型（在“身份检查器”中选择视图）。此外，可能值得评估为什么同一视图控制器实例需要完全不同的视图类别；对我来说，这可能是关于应用程序设计的一个危险信号。两个视图控制器之间的流程可能会更好地为您服务，或者在这个自定义 UIView 扩展类中编写一些状态更改逻辑。对我而言，将根据视图所代表的模型以及每个视图旨在促进的行为来做出决定。

如果模型不同（即您的第一个视图显示帐户列表，第二个视图显示一个帐户详细信息），或者行为明显不同（即第一个是查看帐户，第二个是创建一个新帐户），那么我将使用两个不同的视图控制器。

如果模型和行为相似，并且样式应该改变，那么我可能会在自定义视图类中编写状态更改代码来重新排列事物等。

如果你来自不同的平台，一开始可能看起来很傻，但我们确实会毫不犹豫地扔掉视图控制器。它们由框架优雅地处理，旨在管理“一屏内容”并轻松交换为另一屏。

# ruby - Rails 路由路径尾随斜杠

> ID：11036305
> 
> 赞同：0
> 
> 时间：2012-06-14T15:22:08.443
> 
> 标签：ruby, ruby-on-rails-3

有人可以告诉我为什么

```
<%= destroy_password_url @user.password_reset_token %> 
```

生成

```
http://localhost:3000/api/destroy_password.4G5EoRVYMUAtiIKqOerKsw 
```

路线.rb

```
get 'api/destroy_password' => 'services#destroy_password', :as => 'destroy_password' 
```

我只是关注[http://railscasts.com/episodes/274-remember-me-reset-password?view=asciicast](http://railscasts.com/episodes/274-remember-me-reset-password?view=asciicast)我什至不知道它为什么要添加 DOT。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:27:33.190

在您的路由文件中，您并不是说您接受参数。您可能应该像这样重写它：

```
get 'api/destroy_password/:id' => 'services#destroy_password', :as => 'destroy_password' 
```

# python - 在 Python 中使用 Mechanize 时解析错误

> ID：11036308
> 
> 赞同：2
> 
> 时间：2012-06-14T15:22:16.593
> 
> 标签：python, forms, mechanize, parse-error

我正在尝试在 Dell Kace 票务页面上选择一个表单，但出现解析错误。我正在用python编程并且一直在使用mechanize。我成功地能够登录到该站点。我读到您可能可以使用诸如 Beautiful soup 之类的 html 清洁器来解决此问题，但这些似乎都不起作用。

```
br = mechanize.Browser() #have tried the various html cleaner options in mechanize
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)
br.set_handle_equiv(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US;  
rv:1.9.0.1)Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')] 
....
url_ticket = 'http://kace-server/adminui/ticket.php?ID=%d' %(box1[sel+1])
url_org1 = "http://kace-server/common/switch_to_org.php?org=1"
br.open(url_org1)
br.open(url_ticket)
br.select_form(name="ticket_form")  
br.form['fields[owner_filter]']=current_user[0]
br.submit() 
```

该程序在 br.select_form 行失败并出现以下错误

```
line 39, in assign
  br.select_form(name="ticket_form")
....
File "C:\Python27\lib\site-packages\mechanize-0.2.5-py2.7.egg\mechanize\_form.py", 
line 760, in feed raise ParseError(exc)
ParseError: expected name token at '<!\xe2\x80\x94IE7 mode --\n  <' 
```

我在 html 中搜索了那个 '!\xe2... 字符串，但找不到它。我还为 select_form 尝试了 nr=0。任何帮助将不胜感激

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:36:58.553

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:34:17.803

"\xe2\x80\x94" 是字符“—”的 utf-8 编码形式（不是“-”！）。看起来这是 html 中的拼写错误（或者使用 msword 作为 html 编辑器的一些假人？），应该是“

# maven - weblogic-maven-plugin WS clientgen 创建 SequenceCodec 而不是类

> ID：11036315
> 
> 赞同：1
> 
> 时间：2012-06-14T15:22:43.537
> 
> 标签：maven, plugins, weblogic, codec

我正在将一个蚂蚁项目转换为 Maven。使用类 weblogic.wsee.tools.anttasks.ClientGenTask Ant 正在从 WSDL 生成类。示例：com.company.ArrayOfQualifyingActivity

但现在使用 Maven 插件，它正在创建 com.company.ArrayOfQualifyingActivitySequenceCodec

有没有其他人遇到过这个？

编辑：没关系。解决了这个问题。以前的 clientgen 将类数组（用于 QualifyingActivity[] ）包装在一个包装类中。maven clientgen 没有这样做。所以我可以按原样使用 QualifyingArray[] 或 String[] 等。

谢谢

# telerik - history.back 和 RadEditor 清除其他表单数据

> ID：11036316
> 
> 赞同：0
> 
> 时间：2012-06-14T15:22:43.707
> 
> 标签：telerik, browser-history

我有一个奇怪的场景：

我正在使用 asp.net mvc 并且我有一个表单，它结合了 HTML 输入字段和[Telerik RadEditor](http://www.telerik.com/products/aspnet-ajax/editor.aspx)。

当我的表单验证失败时，我有*history.back*让用户回到表单。如果 RadEditor 有一些文本并且验证失败，那么我将丢失 RadEditor 控件正下方的字段中的所有数据。知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T22:16:41.897

如果页面上没有 RadEditor，问题是否可以重现？您是否尝试将 RadEditor 的 ContentAreaMode 属性设置为 DIV 并进行测试？

# actionscript-3 - 如何为所有事件添加一个监听器？

> ID：11036318
> 
> 赞同：2
> 
> 时间：2012-06-14T15:22:46.513
> 
> 标签：actionscript-3, addeventlistener

`EventDispatcher.addEventListener()`期望事件类型的第一个参数（字符串类型的参数）。

但是当前对象可以产生多种类型的事件。

是否可以在一个处理程序中处理所有这些？可能我可以传递`null`类型参数或其他东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:37:02.873

**Yes, this is possible**.

If you use `getQualifiedClassName` of the Event class, you could get the types using `describeType`. Then you know all types that could be added, assuming you are using a custom event with public static types as strings in same event class. Then you could loop through all types, and add listeners with all those types to the dispatcher.

This idea is included in the [templelibrary](http://templelibrary.googlecode.com) (`EventUtils.addAll`), which I suggest to use.

*See documentation:* [http://templelibrary.googlecode.com/svn/trunk/doc/temple/utils/types/EventUtils.html](http://templelibrary.googlecode.com/svn/trunk/doc/temple/utils/types/EventUtils.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T19:50:16.287

您应该尝试让路并扩展 dispatchEvent 功能：

```
public override function dispatchEvent(evt:Event):Boolean {
     trace(evt.type);
     return super.dispatchEvent(evt);
} 
```

你可以把你的代码放在这里来处理在这个对象中调度的所有事件。

# python - Boost Python Hello World 示例在 Python 中不起作用

> ID：11036319
> 
> 赞同：7
> 
> 时间：2012-06-14T15:22:48.840
> 
> 标签：python, c++, boost, boost-python

我在 Python 中使用来自 Visual C++（由 boost 包装）的 c++ 代码时遇到了很多麻烦。

好的，所以我使用的工具是：Visual Studio 2010、BoostPro 1_47、Windows 7 和 Python 2.7（32 位）。

我有以下代码在 Visual Studio 2010 中编译得很好：

```
#define BOOST_PYTHON_STATIC_LIB
#include <boost/python.hpp>
using namespace boost::python;

struct World
{
    void set(std::string msg) { this->msg = msg; }
    std::string greet() { return msg; }
    std::string msg;
};

BOOST_PYTHON_MODULE(hello)
{
    class_<World>("World")
            .def("greet", &World::greet)
            .def("set", &World::set);
} 
```

它的格式为：Win32 控制台应用程序 >>> 空项目/DLL。

在“项目属性”中：

```
VC++ DIRECTORIES: 
  I added:  
  >>> INCLUDE DIRECTORIES:  C:\Program Files\boost\boost_1_47;C:\Python27\include        .  
  >>> LIBRARY DIRECTORIES:  C:\Program Files\boost\boost_1_47\lib;C:\Python27\libs 
```

所有这些都使 c++ 文件构建，但我无法从 Python 访问它。

这是我尝试使用该模块时 Python 所说的：

```
">>> import hello
 Traceback (most recent call last):
   File "<pyshell#0>", line 1, in <module>
     import hello
 ImportError: No module named hello 
```

所以我想我的问题是......我怎样才能让 Python 找到它？？？

当 c++ 代码编译时，它会创建一个 DLL 文件。我必须更改文件的位置吗？如果是这样，我应该把它放在哪里？

您的帮助将不胜感激

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-14T16:01:21.147

AFAIK，您必须将 DLL 的扩展名更改为，`.pyd`否则 Python 将无法加载它。我认为您可以设置一个构建选项以在 VS 中自动设置扩展名，但我不确定。

此外，确保创建的扩展位于[`PYTHONPATH`](http://docs.python.org/using/windows.html#excursus-setting-environment-variables)路径上的某个位置，python 将查找要加载的模块。

# javascript - Jquery NivoSlider 滑块不工作 $('#slider').nivoSlider(); 不是函数

> ID：11036321
> 
> 赞同：3
> 
> 时间：2012-06-14T15:22:55.067
> 
> 标签：javascript, jquery, asp.net, slider

我在我的 asp.net 应用程序中使用 nivo jquery 图像滑块，但是在页面加载后它不会更改图像并且只显示“loading.gif”图像，在 jquery 调试时我收到错误消息：$（'#slider'）。 nivoSlider(); 不是函数。

```
 <link href="css/NivoSlideThemes/default/default.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="css/NivoSlideThemes/nivo-slider.css" rel="stylesheet" type="text/css" media="screen"  />
    <script src="js/menu/jquery-1.7.2.min.js" type="text/javascript"></script>     
    <script src="js/jquery.nivo.slider.pack.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(window).load(function () {
            $('#slider').nivoSlider();
        });
        </script>
          <style>   

            .theme-default #slider {
                margin:1px auto 0 auto;
                width:674px; /* Make sure your images are the same size */
                height:311px; /* Make sure your images are the same size */
            }
            .theme-pascal.slider-wrapper,
            .theme-orman.slider-wrapper {
               /* margin-top:150px;  */
            }

            .clear {
                clear:both;
            }

      </style> 

       <div class="slider-wrapper theme-default"> 
            <div id="slider" class="nivoSlider">
                <img src="images/cfgSliderImages/1.gif" alt="" />
                <img src="images/cfgSliderImages/2.gif" alt="" title="Solar Power" />
                <img src="images/cfgSliderImages/3.gif" alt="" data-transition="slideInLeft" />
                <img src="images/cfgSliderImages/4.gif" alt=""   title="#htmlcaption" />
            </div>
            <div id="htmlcaption" class="nivo-html-caption">
                <strong>This</strong> is an example of a <em>HTML</em> caption with <a href="#">a link</a>.
            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-14T15:32:11.313

尝试这个：

也许和jQuery有冲突，所以使用`.noConflict()`：

```
var j = jQuery.noConflict();
j(document).ready(function () {
    j('#slider').nivoSlider();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:33:01.413

当我时不时地使用 Visual Studio 时，我会遇到这个问题。我没有在 中引用脚本`body`，而是将它们添加到`head`.

```
<head>
    <link href="css/NivoSlideThemes/default/default.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="css/NivoSlideThemes/nivo-slider.css" rel="stylesheet" type="text/css" media="screen"  />
    <script src="js/menu/jquery-1.7.2.min.js" type="text/javascript"></script>     
    <script src="js/jquery.nivo.slider.pack.js" type="text/javascript"></script>
</head> 
```

这尤其是 jQuery 的一个问题。

但是，您需要将您的 javascript 放入文档就绪函数中：

```
// When the page is ready to be manipulated
$(function() {
        $(window).load(function () {
            $('#slider').nivoSlider();
        });
}); 
```

# objective-c - 将元数据添加到 Objective-C 方法和属性

> ID：11036323
> 
> 赞同：4
> 
> 时间：2012-06-14T15:22:56.167
> 
> 标签：objective-c, reflection

如何向我的 Objective-C 方法和属性添加额外的自定义信息？我想稍后在运行时检索此元数据。

我知道objective-c不直接支持方法属性，就像在C#中一样，但这是我正在寻找的：

```
[MyCustomAttribute(true)]
public void MyAwesomeMethod(int arg) {
     // ...
} 
```

我最近发现的最接近的东西是`#define`UIKit 头文件中名为`UI_APPEARANCE_SELECTOR`. 显然，Apple 用它标记了某些方法，以便稍后阅读。

然后像这样定义方法和属性：

```
@property(nonatomic,retain) UIColor *tintColor UI_APPEARANCE_SELECTOR;

- (void)setBackgroundImage:(UIImage *)backgroundImage forState:(UIControlState)state barMetrics:(UIBarMetrics)barMetrics UI_APPEARANCE_SELECTOR; 
```

有人可以准确解释这是如何工作的吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:40:34.633

没有对标记元数据（.NET 中的属性、Java 中的注释等）的内置支持。Apple 的宏在这里完全是为了他们的开发人员工具的利益，您不能创建自己的在预处理器之后具有任何意义的宏。

GCC/LLVM 定义了一些可以附加到各种符号的属性。例如，您可以通过标记方法将其标记为已弃用，`__attribute__((__deprecated__))`但仍然无法创建有意义的自定义属性。

如果您告诉我们您要完成的工作，也许我们可以建议另一种解决问题的方法。

# linux - 使用 bash 计算最大增量（吞吐量峰值）

> ID：11036325
> 
> 赞同：2
> 
> 时间：2012-06-14T15:23:03.970
> 
> 标签：linux, bash, math

感谢 Dennis Williamson 的出色工作，我现在能够通过 ethtool -S 输出计算无限数量的 NIC 的平均吞吐量。可在此处找到其详细信息：

[计算滚动总数的吞吐量](https://stackoverflow.com/questions/10957483/calculate-throughput-on-a-rolling-total)

现在，平均吞吐量是一个非常有用的调整工具，但是我还需要确定同一时间段内的最大流量突发。占流量的 95% 一切都很好，但是如果我无法对每个 NIC 看到的最大突发量进行简单/准确的测量，我就无法占其他 5% 的时间。

Dennis 都是用 awk 写的，很遗憾我不太精通。我无法修改他现有的代码来做我想做的事。是否可以在 bash 中执行此操作？

作为参考，您可以在此处找到我们需要解析的示例日志文件：http: [//pastebin.com/p1pwZeBN](http://pastebin.com/p1pwZeBN)

丹尼斯的代码在这里：

```
awk '
BEGIN {
    OFMT = "%.4f"
}

/^[[:blank:]]*$/ { next }

! ($1 in prevrx) {
    prevrx[$1] = $2
    prevtx[$1] = $3
    next
}
{
    count[$1]++
    drx = $2 - prevrx[$1]
    dtx = $3 - prevtx[$1]
    rx[$1] += drx
    tx[$1] += dtx
    prevrx[$1] = $2
    prevtx[$1] = $3
}
END {
    for (iface in rx) {
        print iface, rx[iface] / count[iface], tx[iface] / count[iface]
    }
}' 
```

感谢您的所有帮助！:)

编辑:: 作为一个例子来帮助详细说明我想看到的内容。如果新脚本可以解析日志文件（例如，对于 DMZ 入站），它应该确定最大的 delta 在 IE 的第 121 行和第 113 行之间：

```
DMZ      36195731362 vs DMZ      36195255177
= 668659 / 131072 = 5.1~mbps 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:24:09.147

这是未经测试的，但一些小的更改应该可以工作：

```
awk '
BEGIN {
    OFMT = "%.4f"
}

/^[[:blank:]]*$/ { next }

! ($1 in prevrx) {
    prevrx[$1] = $2
    prevtx[$1] = $3
    next
}
{
    count[$1]++
    drx = $2 - prevrx[$1]
    dtx = $3 - prevtx[$1]
    rx[$1] += drx
    tx[$1] += dtx
    prevrx[$1] = $2
    prevtx[$1] = $3
    if (drx > maxdrx[$1]) {
        maxdrx[$1] = drx
    }
    if (dtx > maxdtx[$1]) {
        maxdtx[$1] = dtx
    }
}
END {
    for (iface in rx) {
        print iface, rx[iface] / count[iface], tx[iface] / count[iface], maxdrx[iface], maxdtx[iface]
    }
}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T22:02:15.637

为什么不将数据收集与处理分开。使用 bash 工具等获取数据。然后使用更适合数据可视化/处理等的工具进行分析。Matlab、Mathematica、Octave、R、Scipy，甚至 JMP。

并不是说这里的awk 不给力，只是当出现问题时你会怎么做，你必须调试那个脚本。如果/当您处于这种情况下，为数据处理和分析量身定制的语言将有更多工具来帮助您。

# c# - 如何使用正则表达式从一串数字中提取中间数字

> ID：11036330
> 
> 赞同：0
> 
> 时间：2012-06-14T15:23:18.450
> 
> 标签：c#, regex

我有一个数据字段，其中包含两种格式的大量数字：

```
553000.468...705.46.0000000        <- Format 1
553000.469.5501000.704.47.0000000  <- Format 2 
```

我只需要中间的三个数字，包括 703、704 或 705

我可以通过使用正则表达式来提取这些数字，如下所示：

```
Regex num = new Regex(@"(?<number>7\d+) ?");
Match number = num.Match(numb);
if (number.Success)
    Console.WriteLine(num.Match(numb).Result("${number}")); 
```

但是，只有在中间数字前面没有 7 时才有效

在我看来，处理它的最佳方法是关注“。”。问题是我不知道如何匹配“。”之后的字符。我可以拉出第一个“。”之前的数字。通过做这个：

```
Regex num = new Regex(@"(?<number>.\d+) ?");
Match number = num.Match(numb);
if (number.Success)
    Console.WriteLine(num.Match(numb).Result("${number}")); 
```

这将给我期间之前的一切。我正在使用[此处](http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet)找到的备忘单，但它没有显示如何匹配“。”之后的字符。如果我能弄清楚如何做到这一点，那么我可以重复这个模式，直到我得到我需要的数字，然后我可以使用上面的代码来摆脱之后的数字。这可能不是最有效的方法，但我以前从未使用过正则表达式，老实说，我觉得它很混乱。

编辑：

我被告知我需要提供更多示例或更好地解释它。我有一个数据库表，其中有一列名为 Glsec。该字段包含两种格式的数字；553000.468...705.46.0000000 和 553000.469.5501000.704.47.0000000 是这两种格式的示例。

在 553000.468...705.46.0000000 格式中，我只需要在...之后的第一组数字中找到的数字 703、704 或 705（左起第 14 个字符）

在 553000.469.5501000.704.47.0000000 格式中，我只需要从左侧算起的第 4 组数字（第 20 个字符）中的数字 703、704 或 705。

三组中的数字可能包含 000 到 999 之间的任何数字，但我只需要这三个数字。703、704、705 也有可能随机出现在其他数字组中，所以我必须确保我从正确的位置抓取数字。

我希望这能更好地解释它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T15:28:49.820

在?上使用[Split()](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)方法 `.`然后你可以得到你想要的数字，如果它总是有相同的位置，或者你可以循环遍历数组来找到你想要的数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T15:25:13.877

> 我只需要中间的三个数字，包括 703、704 或 705

你可以使用这个：

```
@"\.(70[3-5])\." 
```

如果这些是唯一有效的值。

**顺便说一句，谁说`regex`是解决您问题的最佳方法？**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T15:36:55.913

用于`String.Contains`测试三种情况。假设字符串是变量`s`：

```
s.Contains(".705.")
s.Contains(".706.")
s.Contains(".707.") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T15:48:09.517

如果你厌倦了正则表达式......

```
 string[] formats = new[] {"553000.468...705.46.0000000", "553000.469.5501000.704.47.0000000"};
    var results = from format in formats
                  from sub in format.Split('.')
                  where new[] { "703","704","705" }.Contains(sub)
                  select sub; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-14T15:31:52.117

您需要将句点转义为`\.`，因为`.`在正则表达式中表示“任何字符”。

您可以在所需数字之前匹配特定数量的可选数字 + 句点：

```
Regex num = new Regex(@"^(?:\d*\.){3}(?<number>\d+)"); 
```

或之后：

```
Regex num = new Regex(@"(?<number>\d+)(?:\.\d*){2}$"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-14T15:29:18.697

分两步做怎么样。首先，找到两个中间有三个数字的句点。然后，修剪周期。

```
Regex num = new Regex(@"\.\d{3}\.");
Match number = num.Match(numb);
if (number.Success)
    Console.WriteLine(number.Value.Trim('.')); 
```

您还可以捕获匹配的子集：

```
Regex num = new Regex(@"\.(\d{3})\.");
Match number = num.Match(numb);
if (number.Success)
    Console.WriteLine(number.Groups[1].Value); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-14T15:29:46.403

这 。是正则表达式的元字符，因此需要对其进行转义。以7开头的数字总是3位数吗？

您可以尝试以下方法：

```
 Regex num = new Regex(@"(?\.<number>\d+) ?");
   Match number = num.Match(numb);
   if (number.Success)
        Console.WriteLine(num.Match(numb).Result("${number}")); 
```

# scala - 无形：前置。未找到隐式

> ID：11036334
> 
> 赞同：7
> 
> 时间：2012-06-14T15:23:34.220
> 
> 标签：scala, functional-programming, shapeless

我正在尝试使用 shapeless 以类型安全的方式轻松地积累对象。

问题是当我想连接（`:::`）两个时`HList`。我遇到了一个新手（至少看起来）问题。它错过了`Prepend`上下文中的隐式实例。

但是，查看`hlist.scala`，我可以看到泛型`implicit def`在对象`Prepend`和`PrependAux`.

添加`import Prepend`和`import PrependAux`手动并没有改变任何东西（显然......）。

所以这里的代码减少到最低限度：

```
enter code here

import shapeless._
import HList._
import Prepend._
import PrependAux._

object test {

  val a:HList = 1 :: 4 :: "A" :: HNil
  val b:HList = "R" :: false :: HNil

  val c:HList = a ::: b   // <<<<<<<<<<< NEEDS A Prepend in the context 

} 
```

现在在控制台中：

```
[error]     test.scala:10: could not find implicit value for parameter prepend: shapeless.Prepend[shapeless.HList,shapeless.HList]
[error]     val c:HList = a ::: b   // this needs an implicit Prepend in the current context 
```

什么应该灼伤我的眼睛？

谢谢

**编辑**

稍微更新一下，把真正的问题重新复杂化了一点，因为之前要粗俗化是要强烈的。

这是我能做的事情：

```
case class A[L<:HList](a:L) { 
  def doSmth[C <:HList](c:C) = a ::: c 
} 
```

所以我无法访问真正的类型，只有我知道它们是*HList*。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T17:00:08.847

向上转换`HList`是这里的问题。几乎没有什么可以用普通的旧的`HList`（除了添加新元素）。

您可以提供更多信息的类型注释：

```
val a: Int :: Int :: String :: HNil = 1 :: 4 :: "A" :: HNil
val b: String :: Boolean :: HNil = "R" :: false :: HNil
val c: Int :: Int :: String :: String :: Boolean :: HNil = a ::: b 
```

或者只是让类型被推断出来，这通常更方便：

```
val a = 1 :: 4 :: "A" :: HNil
val b = "R" :: false :: HNil
val c = a ::: b 
```

* * *

作为对您的评论的回应：如果您确保获得所需的证据，您可以做您想做的事（请注意，我假设这`a: A`是一个错字`a: L`，并且您需要这样做`-Ydependent-method-types`）：

```
case class A[L <: HList](a: L) {
  def doSmth[C <: HList](c: C)(implicit p: Prepend[L, C]) = a ::: c
} 
```

一般来说，您可以只查看您正在使用的操作所必需的隐式，然后将它们包含在您的方法中。

# android-c2dm - C2DM - 在我获得 Update-Client-Auth 后使用新的 AuthToken 时出现问题

> ID：11036335
> 
> 赞同：1
> 
> 时间：2012-06-14T15:23:42.833
> 
> 标签：android-c2dm

我正在开发与谷歌的 C2DM 服务一起使用的推送通知服务器。

当我在响应标头中获得“Update-Client-Auth”时，我会替换以前的令牌，以用于下一个推送通知。

当我在获得新令牌后立即发送通知时，它失败 - 响应 - “InvalidRegistration”

我的问题是？

1.  如何避免这种情况？我应该在使用新令牌之前等待吗？

2.  我什么时候需要开始使用新令牌？是否应该使用标题中包含的到期日期？

我还没有发现任何地方提到的这种现象。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T10:15:06.890

我认为问题不在于您的身份验证。令牌。

“InvalidRegistration”表示您要向其发送 C2DM 消息的设备的注册令牌无效。如果设备发生更改（显然可以），您应该确保设备向您发送更新的注册 ID/令牌。

清除您的服务器缓存/数据库并重新开始，让设备重新向 Google 注册，然后将注册令牌发送到您的服务器，看看会发生什么。

当然，我猜你的数据库中没有很多注册，如果你还在开发中......

问候，

标记

# css - Galaxy S3 的 CSS 媒体查询

> ID：11036337
> 
> 赞同：25
> 
> 时间：2012-06-14T15:24:00.830
> 
> 标签：css, html, media-queries, responsive-design

有人知道如何通过媒体查询来定位三星 Galaxy S3 吗？

目前我使用：

# iPad

```
<link rel="stylesheet" media="all and (device-width: 768px)"                                                href="css/device-768.css"/> 
```

# 其他平板设备

```
<link rel="stylesheet" media="all and (max-device-width: 767px) and (min-device-width: 641px)" href="css/device-max767.css"/> 
```

# 电话（S3 没有使用这个 - 不知道为什么）

```
<link rel="stylesheet" media="all and (max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 1)"    href="css/phones.css"/> 
```

我也测试过

```
<link rel="stylesheet" media="all and (max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)"    href="css/phones.css"/> 
```

但它没有工作......

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-10-18T07:45:52.580

我设置了一个页面，通过给出媒体功能的值，向您展示任何设备将如何对媒体查询做出反应。只需使用您要测试的设备访问页面：

[http://pieroxy.net/blog/pages/css-media-queries/test-features.html](http://pieroxy.net/blog/pages/css-media-queries/test-features.html)

从那里，您可以根据不同设备报告的内容决定要使用的媒体查询。请记住，针对特定设备通常是个坏主意。您应该以显示尺寸和密度为目标，以使您的网站适应手头的表面。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-10-18T03:34:06.543

此时，移动设备已经有了很大的改进，以至于它们的屏幕分辨率与桌面屏幕分辨率相似，有时甚至更好。

例如三星的 Galaxy S4 有 1080X1920 像素 - 全高清屏幕！

但是在响应式设计中，我们会检查分辨率并需要根据分辨率进行调整，如果您尝试添加媒体查询，假设最小宽度为 1000px，然后在三星 Galaxy S4 上进行检查，您会发现没有任何反应。

原因是手机高密度屏有两个像素点。

真实分辨率 第一个分辨率是出厂真实分辨率，主要用于视频和图像。在三星 Galaxy S4 上，实际分辨率为 1080X1920。

CSS 分辨率 第二个分辨率是针对浏览器的。对于我们开发人员来说，这意味着我们需要采取不同的行动，而不是根据真实的屏幕分辨率。在三星 Galaxy S4 中，CSS 分辨率为 360X640。

三星 Galaxy S4 分辨率：真实分辨率：1080X1920 CSS 分辨率：360X640

如何获取 CSS 分辨率？在维基百科中，您拥有所有移动设备分辨率表（平板电脑和移动设备）。[http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density](http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density)

```
/*(ldpi) Android*/
@media only screen and (-webkit-device-pixel-ratio:.75){

  /*CSS  */
}

/*(mdpi) Android*/
@media only screen and (min-device-width : 480px) and (max-device-width : 800px) {

  /*CSS  */
}

/*(hdpi) Android*/
@media only screen and (-webkit-device-pixel-ratio:1.5){

  /*CSS  */

} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-15T09:23:33.107

我用它来只针对 s3 上的纵向视图：

```
@media only screen and (min-device-width : 719px) and (max-device-width : 721px) and (-webkit-min-device-pixel-ratio : 2) and (orientation : portrait) { 

} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-23T10:37:03.383

如前所述。在你的手机上使用这个[**媒体查询检测器**](http://pieroxy.net/blog/pages/css-media-queries/test-features.html)，并考虑使用更好的流体设计——CSS hacks 不好——如果你有一个好的流体设计，在 90% 的场景中你不应该真的需要它们。

# 三星Galaxy S3

```
@media only screen and (max-device-width: 720px) and (orientation:portrait) {
  .your-css{}
}

@media only screen and (max-device-width: 1280px) and (orientation:landscape) {
  .your-css{}
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-21T13:22:30.637

三星 Galaxy SI & II：320 x 533，纵向模式（CSS 像素密度为 1.5）

三星 Galaxy S III：**360 x 640**，纵向模式

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-07T03:42:48.043

在我的带有 Android 4.1.2 的三星 S3 上，虽然我尝试了所有媒体查询功能（最大高度、宽度、设备高度和宽度，甚至颜色：8），但除了本页**上面的第二个答案**之外，只有这对我有用：

# 三星 S3 默认浏览器

```
/* Samsung S3 default browser portrait*/
@media only screen and (device-width: 720px) and (device-height: 1280px) and (orientation: portrait) {
body { background:yellow;} 
}

/* Samsung S3 default browser landscape */
@media only screen and (device-width: 1280px) and (device-height: 720px) and (orientation: landscape)  {
body { background:#000;} 
} 
```

[这是](http://i.stack.imgur.com/rJ234.png "媒体查询诊断工具测试")[pieroxy](http://pieroxy.net/blog/pages/css-media-queries/test-features.html "媒体查询诊断工具测试")媒体查询诊断工具测试的屏幕截图。**请注意**，两者都可以在没有方向的情况下工作，但不要在没有加载/刷新的情况下更改适当性。

希望这有助于与您可能使用的任何其他查询不冲突

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-28T03:09:33.230

我认为这可以安全地适用于当今的大多数手机（HTC、iPhone、三星），同时避免常见的平板电脑宽度（iPad iPad 3/4 iOS 6 在纵向上有**672 像素**）。

```
<link rel='stylesheet' href='/Styles/device_phone.css' media='screen and (max-width: 640px)'/> 
```

这部手机将是奇怪的鱼：

*三星 Nexus S Android 2.3.6 股票浏览器*，宽度：480 像素，高度：**800**像素（最大宽度 800）

通常不建议针对特定设备，但如果您真的想针对奇怪的鱼，您可以，因为它具有其他独特的属性。我个人更喜欢使用 max-width，因为我可以直接在我的桌面和宽屏幕上进行测试，而且如果用户确实将浏览器的大小调整到小于 640 宽，我不会对看到移动视图的用户大惊小怪。

参考： http: [//pieroxy.net/blog/2012/10/18/media_features_of_the_most_common_devices.html](http://pieroxy.net/blog/2012/10/18/media_features_of_the_most_common_devices.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-21T05:48:54.497

这是经过测试和工作的。

```
@media only screen and
(device-width: 720px) and
(device-height: 1280px)  and
(-webkit-min-device-pixel-ratio: 2) 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-04-13T17:50:08.340

忘记所有这些“最大设备宽度”“最小高度”等，骗局！问题是你们不是为设备的尺寸设计的。此外，根据三星的 Galaxy S3 的像素密度为 2，这意味着物理屏幕将 1 个设备像素映射到 2 个 CSS 像素。如果这是真的，那么 720x1280 分辨率只是一个逻辑分辨率，而不是设备的真正物理分辨率！Apple iphone 4 也是这种情况，它的指定分辨率为 640x960px，这实际上是逻辑分辨率，而不是实际设备的真实分辨率。考虑到像素密度，iphone的实际物理分辨率是这个数字的一​​半，这意味着它的物理尺寸实际上是320x480，这是真的，因为我一直使用这个代码！

因此，如果 S3 的像素密度也为 2，那么其真正的原始分辨率实际上是 360x640 像素，而不是三星所说的 720x960。同样，设备将 2 个 CSS 像素映射到 1 个设备像素！另外，为什么人们使用可变媒体查询，我告诉你！

```
@media screen and (device-width: 360px) and (device-height: 640px) and (orientation: portrait) { 
```

样式在这里 }

```
@media screen and (device-width: 640px) and (device-height: 360px) and (orientation: landscape) { 
```

Styles here } OR：你可以说一下三星、DuH!、Rocket science 提供的逻辑解决方案，对吗？

```
@media screen and (width: 720px) and (height: 1280px) and (orientation: portrait) { 
```

样式 }

```
@media screen and (width: 1280px) and (height: 720px) and (orientation: landscape) { 
```

样式 } 很简单！这里的所有都是它的。人们想知道为什么他们不能让媒体查询工作，但他们使用所有这些变量值。尝试实际定位设备的分辨率。地球上没有理由使用变量值，例如“最大宽度”等。

# c# - C# .NET TableLayoutPanel 的最后一列被拉伸

> ID：11036338
> 
> 赞同：3
> 
> 时间：2012-06-14T15:24:01.763
> 
> 标签：c#, winforms, resize, size, tablelayoutpanel

我正在以编程方式创建一个 TableLayoutPanel。它有 2 行。列的数量由用户添加。

也可以一次删除 1 列。

但是每当我这样做并将所有控件移回 1 列以关闭空列时，最后一列都会被拉伸以填充剩余的空间，就好像它具有自动调整大小而不是绝对宽度一样。

**问题是：**我希望我的最后一栏和其他栏一样宽，但我不知道怎么做。

感谢阅读，丹尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T16:24:34.890

我也遇到了同样的问题，但是我的最后一个 ROWS 高度异常地大于其他高度。作者提供的解决方案也对我有用，即将您的 TableLayoutPanel 添加到 Panel 中，然后修改两者的属性：

控制板：

```
Autoscroll = true;
AutoSize = false; 
```

表格布局面板：

```
AutoScroll = false;
AutoSize = true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:04:01.117

看来我已经能够自己解决问题了。

**我的解决方案：**

我已将 TableLayoutPanel 放在 Panel 中，其中设置了以下参数：

**控制板：**

自动滚动=真；

自动尺寸 = 假；

码头=右;

**表格布局面板：**

自动滚动=假；

自动尺寸=真；

码头=左;

设置此设置后，您可以根据需要添加/删除尽可能多的列，而不会让最后一列令人讨厌地填满 TableLayoutPanel 的其余部分。

# tsql - SQL Server 2008 R2 T-SQL：关于重写代码以允许创建视图的建议

> ID：11036340
> 
> 赞同：0
> 
> 时间：2012-06-14T15:24:12.147
> 
> 标签：tsql, sql-server-2008-r2

我在 SQL Server 2008 R2 中创建了一个自定义的 T-SQL 查询。该代码非常适合用作 T-SQL 查询并返回正确的信息。作为编码新手，我对 SQL 为我的查询返回数据的方式感到满意。不幸的是，我开始写这篇文章时没有意识到如果你要创建一个视图，@variables 不能被声明。

因此，我无法创建视图并安排报告的自动执行。我正在寻找可以用来重写此查询的特定提示，如果它可以完成的话。该软件是vCM“VMware Configuration Manager”，我的T-SQL查询在创建的视图中查找信息并返回有关软件包安装进度的统计信息。

我已经搜索过，并与一些亲密的同事一起尝试在此处发布之前找到答案。有两个部分；一个有效的创建视图，它将我需要的所有信息放在一个视图中以便于访问。第二部分在 SQL Server Management Studio 查询窗口中运行良好。当我尝试创建视图时，我得到了这个特定的错误。

> 消息 156，级别 I5，状态 1，过程 ECMCUST_ProgressReport，第 3 行
> 关键字“声明”附近的语法不正确。

从我在网上找到的所有内容来看，似乎需要重写。在创建视图、存储过程等时也可以看到这个问题......

一个关于往哪个方向走的提示，会很棒。

**这将创建有效的 VIEW**

```
/* ------------------------------------------------------------*/
CREATE VIEW ECMCUST_emcmachineresults as
SELECT a.machine_id, a.machine_name, a.managed, a.[enabled],a.ignored, b.platform_id,    b.current_agent_version, c.data_value
FROM ecm_sysdat_machine_state a
JOIN ecm_dat_machines b
ON a.machine_id = b.machine_id
JOIN ecm_sysdat_asset_machine_data c
ON b.machine_id = c.machine_id
where property_id = 3 or property_id =1006
/* ------------------------------------------------------------*/ 
```

**这是在 T-SQL 中运行良好的代码，但我无法从中创建视图**

```
/* ------------------------------------------------------------*/
Declare @WinTotal1 as FLOAT
Declare @Ignored1 as FLOAT
Declare @IgnoredException1 as FLOAT
Declare @TotalsR1 as FLOAT
Declare @PercentComplete1 as DECIMAL(3,2) 
select @WinTotal1 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 5
select @Ignored1 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 5
and ignored = 1
select @IgnoredException1 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 5
and ignored = 1 
and data_value like '*%'
SELECT @TotalsR1 =
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 5) -
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 5
and ignored = 1
and data_value != '*%') 
SELECT @PercentComplete1 = @TotalsR1/@WinTotal1
/* ------------------------------------------------------------*/
Declare @ESXTotal2 as FLOAT
Declare @Ignored2 as FLOAT
Declare @IgnoredException2 as FLOAT
Declare @TotalsR2 as FLOAT
Declare @PercentComplete2 as DECIMAL(3,2) 
select @ESXTotal2 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 11
select @Ignored2 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 11
and ignored = 1
select @IgnoredException2 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 11
and ignored = 1 
and data_value like '*%'
SELECT @TotalsR2 =
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 11)-
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 11
and ignored = 1
and data_value != '*%')
SELECT @PercentComplete2 = @TotalsR2/@ESXTotal2
/* ------------------------------------------------------------*/
Declare @RHELTotal3 as FLOAT
Declare @Ignored3 as FLOAT
Declare @IgnoredException3 as FLOAT
Declare @TotalsR3 as FLOAT
Declare @PercentComplete3 as DECIMAL(3,2) 
select @RHELTotal3 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 2
select @Ignored3 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 2
and ignored = 1
select @IgnoredException3 = COUNT(machine_id) 
from [ECMCUST_emcmachineresults]
where platform_id = 2
and ignored = 1 
and data_value like '*%'
SELECT @TotalsR3 =
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 2)-
(SELECT COUNT(*) FROM ECMCUST_emcmachineresults WHERE platform_id = 2
and ignored = 1
and data_value != '*%')
SELECT @PercentComplete3 = @TotalsR3/@RHELTotal3
Select
'Windows' as [Machine Type],
@WinTotal1 AS [Total Servers],
@Ignored1 AS [Ignored Servers],
@IgnoredException1 AS [Ignored Exceptions Servers],
@TotalsR1 AS [Total Managed],
@PercentComplete1 AS [Percent Complete]
union 
Select
'ESX' as [Machine Type],
@ESXTotal2 AS [Total Servers],
@Ignored2 AS [Ignored Servers],
@IgnoredException2 AS [Ignored Exceptions Servers],
@TotalsR2 AS [Total Managed],
@PercentComplete2 AS [Percent Complete]
union 
Select
'RHEL' as [Machine Type],
@RHELTotal3 AS [Total Servers],
@Ignored3 AS [Ignored Servers],
@IgnoredException3 AS [Ignored Exceptions Servers],
@TotalsR3 AS [Total Managed],
@PercentComplete3 AS [Percent Complete]
union
select 
'All' as [Machine Type],
@WinTotal1 + @ESXTotal2 + @RHELTotal3 as [Total Servers], 
@Ignored1 + @Ignored2 + @Ignored3 as [Total Ignored],
@IgnoredException1 + @IgnoredException2 + @IgnoredException3 as [Total Ignored Exceptions],
@TotalsR1 + @TotalsR2 + @TotalsR3 as [Total Managed],
(@PercentComplete1+@PercentComplete2+@PercentComplete3)/3 as [Percent Complete] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:37:15.257

用你所有的代码创建一个存储过程应该是最简单的方法。

但是，如果您真的需要视图，则应该这样做（未经测试）

```
CREATE VIEW ECMCUST_emcmachineresults
AS
WITH cte1 AS
(
    SELECT 
        platform_id
        ,SUM(CASE WHEN machine_id IS NOT NULL THEN 1 ELSE 0 END) AS WinTotal
        ,SUM(CASE WHEN machine_id IS NOT NULL AND ignored = 1 THEN 1 ELSE 0 END) AS Ignored
        ,SUM(CASE WHEN machine_id IS NOT NULL AND ignored = 1 AND data_value LIKE '*%' THEN 1 ELSE 0 END) AS IgnoredException
        ,COUNT(*) AS Total
        ,SUM(CASE WHEN ignored = 1 AND data_value <> '*%' THEN 1 ELSE 0 END) AS R1
    FROM  [ECMCUST_emcmachineresults]
    WHERE platform_id IN (5,11,2)
    GROUP BY platform_id
)
, cte2 AS
(
    SELECT
       CASE 
        WHEN platform_id = 5 THEN 'Windows'
        WHEN platform_id = 11 THEN 'ESX'
        WHEN platform_id = 2 THEN 'RHEL'
       END                                  AS [Machine Type],          
       WinTotal                             AS [Total Servers],
       Ignored                              AS [Ignored Servers],
       IgnoredException AS [Ignored Exceptions Servers],
       Total - R1 AS [Total Managed],
       CAST((Total - R1) * 1.00 /WinTotal AS DECIMAL (3, 2))  AS [Percent Complete]
    FROM cte1
)
SELECT 
       [Machine Type],
       [Total Servers],
       [Ignored Servers],
       [Ignored Exceptions Servers],
       [Total Managed],
       [Percent Complete]
FROM   cte2
UNION ALL
SELECT 
       'ALL' AS [Machine Type],
       SUM([Total Servers]),
       SUM([Ignored Servers]),
       SUM([Ignored Exceptions Servers]),
       SUM([Total Managed]),
       SUM([Percent Complete])/3
FROM    cte2 
```

# javascript - 如何从另一个页面更改页面的 html 代码？

> ID：11036349
> 
> 赞同：1
> 
> 时间：2012-06-14T15:24:52.417
> 
> 标签：javascript, html, data-transfer

在页面 index.htm，我有这个列表：

```
<ul id="topic">
<li id="1">Thing1.</li>
<li id="2">Thing2.</li>
</ul> 
```

我想从其他页面（painel.htm）添加和删除li itens：

在页面painel.htm 我将有一个输入文本，用户在其中编写li 容器（thing1、2、3...）和一个添加或删除按钮（目前在javascript-jquery 中）。

我想知道将信息从painel提供给索引的过程。

最后，我可以使用 c# 将这些页面设为 asp。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:45:31.340

```
Generate navs through js!

<script>
/* 2 pages nav or define your own */
var pages = [ [ {id:'1',title:'Thing1'} , {id:'2',title:'Thing2'} ] , 
              [ {id:'3',title:'Thing3'} , {id:'4',title:'Thing4'} ]
            ];

/* set current page through asp.net or php like currentPage =0 for index.html and currentPage =1 for painel.htm */

var currentPage = 0;
function renderNavs()
{
     var data = pages[currentPage];
     for(var i=0; i<data.length ; i++)
     {
          $('#topic').append('<li id="'+data[i].id+'">' + data[i].title + '</li>');
');
     }
}

$('#topic').empty();
renderNavs();
</script> 
```

# macos - curl: (7) 当我尝试在 iMac 上安装 Homebrew 时出错

> ID：11036356
> 
> 赞同：0
> 
> 时间：2012-06-14T15:25:16.430
> 
> 标签：macos, terminal, homebrew

安装 iMac OSX 10.7.4，

你好呀，

我正在尝试在我的 iMac 上安装 Homebrew，但我不断收到错误消息。我正在按照[https://github.com/mxcl/homebrew/wiki/installation上的说明进行操作](https://github.com/mxcl/homebrew/wiki/installation)

我已经安装了 Xcode 和它在网站上指定的 Java Developer 更新。

我打开终端并粘贴

```
/usr/bin/ruby -e "$(/usr/bin/curl -fsSL https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)" 
```

但我不断收到错误

```
curl: (7) couldn't connect to host 
```

有人有什么建议吗？

编辑：

只是补充一下，我在大学网络上，以防它相关

编辑：我还重新安装了 Curl

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-17T08:50:30.583

对于我的具体情况，我对所有流量使用 SOCKS 代理。所以我的安装命令是：

```
 ruby -e "$(curl -fsSL --socks5 127.0.0.1:30000 https://raw.github.com/mxcl/homebrew/go)" 
```

`127.0.0.1:30000`SOCKS 代理在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:48:03.730

某些东西阻止了您与 github 的连接。尝试在浏览器中访问 URL [https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb 。](https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T11:30:59.287

我的问题是没有将 Curl 配置为绕过我的代理。

办公室里的一个人帮我解决了这个问题。据我了解，curl 的设置必须更改，而不是代理。

希望这将在未来对其他人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T14:55:47.987

我也有同样的问题。
代理的配方应该在声明`--noproxy`之后添加`curl`

```
ruby -e "$(curl --noproxy -fsSL https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-12T17:17:08.083

我也遇到了这个错误，在我的例子中，这是因为我的防火墙阻止或阻止了到日本的出站连接，它试图拉下 ruby​​ 版本。一旦防火墙规则调整为允许与该国家/地区的连接，一切正常。

# jackson - 使用 Jackson 的 BeanPropertyFilter 过滤嵌套对象

> ID：11036366
> 
> 赞同：10
> 
> 时间：2012-06-14T15:25:54.627
> 
> 标签：jackson

我有以下对象：

```
@JsonFilter("myFilter")
public class Person {
    private Name name;
    private int age;
    public Name getName() {return name;}
    public void setName(Name name) {this.name = name;}
    public int getAge() {return age;}
    public void setAge(int age) {this.age = age;}
}

@JsonFilter("myFilter")
public class Name {
    private String firstName;
    private String lastName;
    public String getFirstName() {return firstName;}
    public void setFirstName(String firstName) {this.firstName = firstName;}
    public String getLastName() {return lastName;}
    public void setLastName(String lastName) {this.lastName = lastName;}

} 
```

我写了一个方法来编组这样的 Person 对象：

```
@Test
public void test() throws Exception {

    Person person = new Person();
    person.setAge(10);
    Name name = new Name();
    name.setFirstName("fname");
    name.setLastName("lastname");
    person.setName(name);

    ObjectMapper mapper = new ObjectMapper();

    FilterProvider filters = new SimpleFilterProvider().addFilter("myFilter",
            SimpleBeanPropertyFilter.filterOutAllExcept("name.firstName"));

    System.out.println(mapper.filteredWriter(filters).writeValueAsString(person));

} 
```

我希望看到的是这样的 JSON：

```
{"name":{"firstName":"fname"}} 
```

这样的事情可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T18:20:01.580

好的，想通了。Varargs 会让这更漂亮一点，但是哦，好吧。只是希望我没有两个具有相同名称的属性的内部 bean。我将无法区分两者

```
 FilterProvider filters = new SimpleFilterProvider()
            .addFilter("myFilter", SimpleBeanPropertyFilter
                    .filterOutAllExcept(new HashSet<String>(Arrays
                            .asList(new String[] { "name", "firstName" })))); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-16T12:32:18.840

有一种更好的方法可以解决属性名称冲突的问题。只需将另一个过滤器添加到类名称（“nameFilter”）：

```
@JsonFilter("personFilter")
public class Person {
    private Name name;
    private int age;
    public Name getName() {return name;}
    public void setName(Name name) {this.name = name;}
    public int getAge() {return age;}
    public void setAge(int age) {this.age = age;}
}

@JsonFilter("nameFilter")
public class Name {
    private String firstName;
    private String lastName;
    public String getFirstName() {return firstName;}
    public void setFirstName(String firstName) {this.firstName = firstName;}
    public String getLastName() {return lastName;}
    public void setLastName(String lastName) {this.lastName = lastName;}
} 
```

然后添加 2 个过滤器，一个用于 Person，一个用于 Name：

```
FilterProvider filterProvider = new SimpleFilterProvider()
            .addFilter("personFilter", SimpleBeanPropertyFilter.filterOutAllExcept("name"))
            .addFilter("nameFilter", SimpleBeanPropertyFilter.filterOutAllExcept("firstName")); 
```

# file - 如何在 Drupal 7 中更新文件字段

> ID：11036367
> 
> 赞同：1
> 
> 时间：2012-06-14T15:25:59.133
> 
> 标签：file, drupal, field

在 hook_user_update 中，我正在检索 facebook 个人资料图片并将记录保存在 file_managed 表中。这一切进展顺利。但我还想为附加到用户实体的文件字段保存记录。通常我在这些钩子中所做的是将值分配给 $edit['field_something']，我认为这是正确的方法。这一直适用于其他字段类型，但不适用于文件字段。您可以在函数的末尾看到我转储变量以确认我有适合分配给 $edit['field_something'] 的东西——至少，我认为它是合适的。我没有收到任何错误，但在 field_data_field_image 表中没有创建任何记录。我错过了什么？谢谢！

```
/**
 *  Implementation of hook_user_update().
 *  
 */
function hifb_user_update(&$edit, $account, $category) {

  if (empty($account->field_image['und'])) {

    $fbid = $edit['field_facebook_id']['und'][0]['value'];

    if (!empty($fbid)) {

      $url = 'http://graph.facebook.com/' . $fbid . '/picture?type=large';

      if ($file_contents = file_get_contents($url)) {

        $size = getimagesize($url);
        $ext = image_type_to_extension($size[2]); 
        $filename = 'fb_' . $fbid . '_u_' . $account->uid . $ext;

        $uri = file_default_scheme() . '://' . $filename;

        // Saves the file to the default files directory and creates the record in files_managed table.
        $file = file_save_data($file_contents, $uri, FILE_EXISTS_REPLACE);

        //var_dump($file); die;
        /* Here's an example from the var_dump: object(stdClass)#120 (8) { ["fid"]=> string(3) "576" ["uri"]=> string(30) "public://fb_767816596_u_1.jpeg" ["filename"]=> string(21) "fb_767816596_u_1.jpeg" ["filemime"]=> string(10) "image/jpeg" ["uid"]=> string(1) "1" ["status"]=> int(1) ["timestamp"]=> int(1339686244) ["filesize"]=> int(2919) } */

        // Creates record in field_data_field_image table??
        $edit['field_image']['und'][0] = (array)$file;

      }
    }

  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:48:21.430

我相信它不起作用的原因是因为在 hook_user_update 中，更新已经发生。所以为 $edit 设置一个值是没有效果的。我在问题中发布的相同代码在 hook_user_presave 中运行良好。

# jar - 似乎无法在命令 promtp 中运行我的 jar 文件

> ID：11036369
> 
> 赞同：0
> 
> 时间：2012-06-14T15:26:19.150
> 
> 标签：jar

我在 NetBeans 中创建了一个项目，其中包括一个表单和一个用作数据库连接层的类。当我尝试通过 IDE 运行这个项目时，一切都启动得很好。当我尝试在命令提示符终端上启动 ide 创建的 jar 文件时，就会出现问题。什么都没发生？它只是移动到下一行。我有一个清单文件，其中指定了类路径和主类，它看起来像这样

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.8.3
Created-By: 1.6.0_22-b04 (Sun Microsystems Inc.)
Class-Path: lib/mysql-connector-java-5.1.13-bin.jar lib/mylib.jar
X-COMMENT: Main-Class will be added automatically by build
Main-Class: eopprototype.EOPPrototype 
```

当我查看编译器所说的要在没有 Ant 的情况下从命令行运行此应用程序时，请尝试： java -jar "/h/USERS/local/pagola/NetBeansProjects/EOPPrototype/dist/EOPPrototype.jar"

当我尝试键入该命令时，它只是转到第二行而没有任何事情发生。甚至没有任何错误。我应该将此 jar 文件分发到共享文件夹并让它运行，但我做不到，我不知道出了什么问题。我没有添加任何 JAVA_HOME 路径，因为我的 jdk 1,6 安装在 usr/bin 中，所以它应该在那里找到它，但我没有添加任何类路径（ide 显示两个运行时和可引导类路径）有人请帮助我，因为我是新手整个java虚拟机环境

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T18:24:10.257

我猜你的意思是标准输出，或者你从你的java程序打印到命令提示符的其他东西。要在命令 propmt 上打印它，您需要在调试模式下运行 java。

利用

```
java -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005 -jar myJar.jar 
```

在调试模式下运行 java 并在命令提示符下获取所有标准输出、异常等。

# javascript - 如何从 webview 返回到 android 活动页面

> ID：11036375
> 
> 赞同：1
> 
> 时间：2012-06-14T15:26:38.527
> 
> 标签：javascript, android, webview

因此，如果在 webview（这是一个 spring 应用程序）上单击注销按钮，该页面应该返回到 android 登录页面。这可能吗？代码位于 .js 文件中。我想要它喜欢

```
 if(btnlogout.clicked) then 
            go to Intent intent = new Intent(menuScreenActivity.this,
                        LoginActivity.class); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:42:28.973

嗯，也许你需要集成你的 webview 和你的 java 代码，你可以在这里看到：

[http://developer.android.com/guide/webapps/webview.html](http://developer.android.com/guide/webapps/webview.html)

将 JavaScript 代码绑定到 Android 代码

```
WebView myWebView = (WebView) findViewById(R.id.webview); 
WebSettings webSettings = myWebView.getSettings(); 
webSettings.setJavaScriptEnabled(true);
webView.addJavascriptInterface(new JavaScriptInterface(this), "Android"); 
```

因此，您在这里告诉您，您的 webview 可以使用运行 javascript，并且将能够访问 JavaScriptInterface 类中可用的 java 代码及其使用 js 的公共方法，如下所示：

```
<input type="button" value="Say hello" onClick="showAndroidToast('Hello Android!')" />

<script type="text/javascript">
    function showAndroidToast(toast) {
        Android.showToast(toast);
    }
</script> 
```

javascript 上的行是**Android.showToast(toast);** 而Android就是你这里选择的名字 **webView.addJavascriptInterface(new JavaScriptInterface(this), "Android");**

**showToast**是 JavaScriptInterface CLASS 上的公共方法，包含您需要的任何内容，在这种情况下：

```
**public void showToast(String toast) {
    Toast.makeText(mContext, toast, Toast.LENGTH_SHORT).show();
}** 
```

刚刚从该链接复制了所有这些...我认为这回答了您的问题，您可以创建名为 Logout 的方法来执行必要的操作，例如：

```
Intent intent = new Intent(menuScreenActivity.this,LoginActivity.class); 
```

# sql - 如何编写一个仅在 where 子句中使用的函数，该函数在没有比较运算符的情况下计算为真？

> ID：11036376
> 
> 赞同：8
> 
> 时间：2012-06-14T15:26:40.710
> 
> 标签：sql, oracle, plsql, where-clause, conditional-statements

**我的问题是：** 在 Oracle 中，regexp_like 在 where 子句中单独工作，而不必与 1 或 0 或字符串进行比较。该函数只能在评估 case 语句或 where 子句中的内容时调用。由于无法描述（尝试搜索数据字典），我想知道如何编写一个以相同方式工作的函数。

**例如：**

```
function is_prod
returns boolean
is 
  l_var boolean := false;
begin
  if sys_context('userenv','db_unique_name') = '"PROD_SERVER"' then
    l_var := true;
  end if;
return l_var;
end; 
```

该函数可以编译，但不能在 SQL 语句中使用，如下所示：

```
select *
from table t
where is_prod 
```

因为我收到以下错误：ORA-00920：无效的关系运算符。

将其与数字或 true 进行比较也不起作用。

**我在哪里可以找到 regexp_like 的代码库，或者我需要做什么才能像 regexp_like 一样工作？**

注意：我环顾了几个小时，发现 Oracle 的 regexp 函数实际上是 java 调用，但这意味着它们仍然需要一个 pl/sql 包装器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T15:39:34.683

基本上，oracle 具有**仅**用于 PLSQL 的布尔数据类型。因此，只要您留在 plsql 中，您就可以使用它们，但不能在 SQL 中使用。

从[文档](http://docs.oracle.com/cd/E11882_01/appdev.112/e25519/datatypes.htm#CJACJGBG)：

> 由于 SQL 没有与 BOOLEAN 等效的数据类型，因此您不能：
> 
> *   将 BOOLEAN 值分配给数据库表列
>     
>     
> *   选择或获取数据库表列的值到 BOOLEAN 变量中
>     
>     
> *   在 SQL 语句、SQL 函数或从 SQL 语句调用的 PL/SQL 函数中使用 BOOLEAN 值

如果您想查找有关内置函数的元数据，那么[这篇文章](https://stackoverflow.com/a/9942585/1083652)可能会有所帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T15:37:50.753

SQL Doesn't work like that. the where statement always looks for a function/column where something is. even if the function works you still have to tell the where statement which value you want True or False

I haven't used Oracle SQL, but looking at what you have there I think that if you write it like this

```
 select *
  from table t
  where is_prod = True 
```

it will work, if you change the Variable type in your function to something like a Varchar(5) or something similar.

you are actually asking that function to look at several records, so when you have it like you do it acts like a Select Statement and not like a where statement. it will give the value of the function but not filter the where. it will look like a column with `true` or `false` values.

When you use the function in a `Where` statement like this:

```
SELECT *
FROM table t
WHERE is_Prod 
```

it's like saying:

```
SELECT *
FROM table t
WHERE Column1 
```

you have to clarify for the `WHERE` Statement

```
SELECT *
FROM table t
WHERE Column1 = 'blue' or is_Prod = 'false' 
```

in C# you can use a String as a boolean, if it is null it returns false

in SQL Server it comes out like this

```
Column2 IS NULL 
```

you still need an operator

*** Separator ***

as I don't use Oracle I was unable to test this.

[http://docs.oracle.com/cd/B14117_01/server.101/b10759/conditions018.htm](http://docs.oracle.com/cd/B14117_01/server.101/b10759/conditions018.htm)

REGEXP_LIKE is a like Statement. so it uses a comparison operator.

you could probably write a regexp in a like statement, although I am sure that it is time consuming and monotonous so they made a function that does it for you.

in other words you still have to use the '= whatever' on the function that you created.

# ios5 - iOS App 中的 Twitter Feed（特定 hastag）

> ID：11036379
> 
> 赞同：0
> 
> 时间：2012-06-14T15:26:55.750
> 
> 标签：ios5, twitter

我想在 UIViewController 中显示特定主题标签的 twitter 提要。最好的情况是仅此提要的图像。有没有可能处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T15:42:12.317

[Twitter 搜索 API](https://dev.twitter.com/docs/api/1/get/search)不需要身份验证，因此这很容易做到。

您需要调用的查询是：

```
https://search.twitter.com/search.json?q=%23iPhone&rpp=100&include_entities=true&result_type=recent 
```

解释：

```
q=%23iPhone 
```

您的主题标签的 # 字符必须替换为 %23

```
rpp=100 
```

返回 100 个条目。

```
result_type=recent 
```

获取最新的推文。

```
include_entities=true 
```

这是重要的一个。如果您[include_entities](https://dev.twitter.com/docs/tweet-entities)，您将获得人们上传到 Twitter 的图像。

然后，您可以解析结果以在您的应用中显示图像。

# c# - 为什么我在 TabControl 的不同选项卡中的 TextBoxes 会丢失其撤消历史记录？

> ID：11036380
> 
> 赞同：1
> 
> 时间：2012-06-14T15:26:59.733
> 
> 标签：c#, wpf, data-binding, tabcontrol, undo

我`TabControl`在. `TextBox`_ `ContentTemplate`当我在一个选项卡中键入一些文本并切换到另一个选项卡时，当我返回时，原始选项卡中的撤消历史记录消失了。

出现的另一个问题是任何被选择的文本都被取消选择，并且插入符号移动到`TextBox`.

如果我只使用硬编码控件创建一个窗口，`TabItem`则会保留撤消历史记录。这个问题与我的绑定或模板有关。

这是我的主窗口的 XAML

```
<Window x:Class="TabbedTextAreaTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Button Command="{Binding AddNewTab}">Add Tab</Button>
        <TabControl ItemsSource="{Binding Tabs}" Grid.Row="1">
            <TabControl.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Header}"/>
                </DataTemplate>
            </TabControl.ItemTemplate>
            <TabControl.ContentTemplate>
                <DataTemplate>
                    <TextBox Text="{Binding Content, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </DataTemplate>
            </TabControl.ContentTemplate>
        </TabControl>
    </Grid>
</Window> 
```

有没有办法在切换选项卡时保留撤消/重做历史和选定的文本**而无需**手动捕获这些命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:37:14.887

当您使用`TabControl`通过数据绑定获取其选项卡的 a 时`ItemsSource`，WPF 不会在您切换时保留每个项目的可视化树。因此，当您从选项卡 1 切换到选项卡 2，然后再切换回选项卡 1 时，选项卡 1 上的控件实际上与您第一次在选项卡 1 上看到的控件实例不同。

有很多方法可以解决这个问题 -当您切换选项卡时`TabControl`，具有显式`TabItem`实例的 s 会保留其可视化树，因此最简单的方法可能是将您的选项卡项目集合包装在`TabItem`为它们制作 s 的东西中.

不幸的是，现在我找不到指向如何执行此操作的示例的链接。SO上有其他地方的文章参考，但它们似乎都指向不再存在的页面，我没有时间深入挖掘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:33:16.107

原因很简单。如果你认为你抱怨的两个操作都是严格的 UI 操作：撤消：用户在**UI 控件**上编辑，选择：选择**UI 控件**上的文本。

当您切换`Tab`到另一个并返回时，WPF 中发生的情况是所有控件都*重新绑定*到那里的数据（`ModelView`通常或只是`Model`），就好像您第一次显示它们一样。所以他们失去了他们的 UI 外观属性。

`Tab`要在环境中正确管理它，`WPF`您需要自己管理`Undo/Redo`堆栈。

祝你好运。

# simple-form - Rails simple_form 服务器端验证丢失 URL 参数

> ID：11036381
> 
> 赞同：2
> 
> 时间：2012-06-14T15:27:02.707
> 
> 标签：simple-form

我将 simple_form 用于表单并传入一些 URL 参数来预填充表单。

此代码工作正常

```
<%= f.input :first_name, :label => 'First Name', :input_html => { :value => params['first'] } %> 
```

使用网址

```
http://localhost:3000/charities/new?first=Bob 
```

输出这个 HTML

```
<input class="string required" id="charity_first_name" name="charity[first_name]" size="50" type="text" value="Bob" /> 
```

但是，如果表单服务器端验证失败，页面会重新加载但预填充值消失了？这是呈现的 HTML

```
<input class="string required" id="charity_first_name" name="charity[first_name]" size="50" type="text" /> 
```

如果服务器端验证失败并且页面重新加载，谁能帮助建议如何预填充 simple_form 并保留这些值？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T19:34:07.097

如果你想让它与验证一起工作，你应该在控制器中预设对象值，如下所示：

```
@charity = Charity.new
@charity.first_name = params[:first] 
```

# c# - 同一类中的单元测试（使用条件编译）？

> ID：11036389
> 
> 赞同：7
> 
> 时间：2012-06-14T15:27:38.390
> 
> 标签：c#, .net, unit-testing

我知道（并同意）将单元测试放在单独的程序集中的常见论点。但是，最近我遇到了一些我真的想测试私有方法的情况。所讨论的幕后逻辑非常复杂，以至于测试公共和内部接口并不能完全完成工作。对类的公共接口的测试感觉过度劳累，我看到一些针对私有的测试可以更简单有效地完成工作的地方。

`protected`在过去，我通过制作我需要测试的东西，并创建一个我可以在测试框架中使用它的子类来解决这些情况。但这在应该是`sealed`. 更不用说用所有的脚手架使测试框架膨胀了。

所以我正在考虑这样做：在课堂上放置一些测试，在那里他们可以得到私人成员。但是使用“#if DEBUG”将它们排除在生产代码之外。

这看起来是个好主意吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T15:36:24.047

### 在有人问之前...

*OP 问题的解决方案*是将 IoC 与 DI 正确结合，并完全消除测试私有方法的需要（正如[Joel Martinez 指出](https://stackoverflow.com/a/11036698/343266)的那样）。[正如多次](https://stackoverflow.com/a/250719/343266) 提到的[，](https://stackoverflow.com/a/9203039/343266)单元测试私有成员*不是要走的路*。

**但是**，有时您不能*更改代码*（遗留系统、破坏更改的风险 - 您可以命名），也不能使用允许私人成员测试的工具（例如 Typemock，它是付费产品）。对于这种情况，您要么*根本不测试*，要么偷工减料。我相信这是OP面临的情况。

* * *

### 将私有*方法测试讨论*放在一边...

请记住，您可以使用**反射**来访问和调用私有成员。

**在我看来，在**类本身中放置条件调试是一个相当糟糕的主意——它给类代码增加了*噪音*（比如，一些不相关的东西）。当然，它会在发布时消失，但您（可能还有其他程序员）将不得不在日常基础上处理它。

我意识到您的想法在纸上听起来可能不错 - 包含条件调试的简单测试。但实际上，测试很快就会使用**额外的变量**（这些也必须放在类代码中）、一些**实用程序**（额外的引用、自定义类型）、**测试框架**（甚至更多的引用）等等。这一切都必须以某种方式连接到类代码。把所有这些放在一起，你很快就会变成一个无法*维护的怪物*。

你确定要处理它吗？特别是考虑到将简单的基于反射的实用程序放在一起可能并不难。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-14T15:45:10.600

你所指的一切都可以用两个概念来解决：[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)和[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)。听起来你肯定需要简化你的课程。请注意，这并不意味着该类必须提供更少的价值，它只是意味着内部需要更简单，并且某些功能可能必须委托给其他人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-14T15:50:17.250

如果您需要独立于类的公共 API 测试此方法，那么听起来像是从类本身中删除的候选者。

您可以说该类***依赖***于私有方法（可以说需要将其与类公共 API 分开测试，这很明显）。

*如果仅*通过测试该类型的公共 API 无法满足此依赖关系，则让该类将此依赖关系委托给另一种类型。您可以在内部实例化此类型，也可以注入/解析此类型。

这种新类型可以*有*自己的单元测试，因为它的公共 API 将表达以前的私有方法。

# java - Java 异常的正则表达式模式

> ID：11036394
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:27:44.860
> 
> 标签：java, regex

我有一个接收一串日志消息的函数。我想确定传递的消息是否属于异常模式，以便我可以使用渲染颜色进行包装。

有谁知道是否有一个`Regular Expression`模式来处理这个？

已编辑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:31:02.740

异常类的名称传统上以“Exception”或“Error”为后缀，因此您可以查找它，但这不是必需的。如果您控制所有异常（或至少知道抛出的所有可能异常都符合本指南），则可以执行上述正则表达式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:29:59.490

你可以在异常跟踪中写任何你想要的东西......所以不，不是这个一般性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:30:35.997

这将是相当粗糙的......至少可以说。

另一个想法可能是更改日志附加程序的布局以在日志文件中包含颜色标记。或者可以将日志输出为（格式正确的）XML 记录，然后您可以使用 XSLT 呈现这些记录以供显示。

# html - 表格或 div 中所有 Td 的简单样式

> ID：11036395
> 
> 赞同：17
> 
> 时间：2012-06-14T15:27:45.743
> 
> 标签：html, css, html-table

有没有一种方法可以使用一个类别来对所有表格单元格进行样式化？我不能只使用

```
td{

} 
```

因为我在同一页面上有另一个表格，我不想要相同的样式。我想要风格化的表格有大约 40 个单元格，那么有没有办法在不复制粘贴类或 id 40 次的情况下统一设置它们的样式？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-14T15:30:42.427

在表格标签上放置一个选择器：

```
<table class="my-special-table">
<tr><td></td></tr>
</table>

table.my-special-table td { style it up! } 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-14T15:30:08.680

如果你的表有一个特定的属性，比如 ID，你可以在 CSS 中专门引用它：

```
<table id="myStyledTable">
    <tr>
        <td>... 
```

像这样：

```
#myStyledTable td {

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-14T15:36:40.440

用这个：

```
#table-id td {
 /* some css */ 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-14T21:34:47.400

或者 #table-id > tr > td { /* some css */ } 以防你在这个表中还有其他不应该应用这种样式的表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-14T15:30:10.837

您可以为该表提供一个 id/class 并执行以下操作：

```
#yourtable td { } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-09T03:38:38.423

id 或 class 都将允许将其单独设置为：

```
<table class="myclass"> 
```

或者

```
<table id="myid"> 
```

进而

```
.myclass td {} 
```

或者

```
#myid td {} 
```

分别。

# python - Fabric 不会将扭曲的应用程序作为守护进程启动

> ID：11036397
> 
> 赞同：0
> 
> 时间：2012-06-14T15:27:57.533
> 
> 标签：python, twisted, fabric, twistd

我编写了一个简单的自动化脚本，用于在远程 Debian 主机上部署和重新启动我的扭曲应用程序。但是我在开始使用 twistd 时遇到了问题。我有一个`run.tac`文件并在结构任务中按如下方式启动我的应用程序：

```
@task
def start():
    run("twistd -y run.tac") 
```

然后只是`fab -H host_name start`。它很好用，`localhost`但是当我想在远程主机上启动应用程序时，我什么也得不到。我可以在日志文件中看到应用程序实际上已启动，但未`factory`启动。我也检查过`netstat -l`- 没有任何东西在监听我的端口。我试过在非守护程序模式下运行，就像这样`twistd -ny run.tac`，瞧，工厂启动了，我可以`netstat -l`在远程主机上看到它。但这不是我希望它工作的方式，因为它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:28:25.130

以前报告了一个与此类似的问题。

*   [初始化脚本经常无法启动它们的守护进程](https://github.com/fabric/fabric/issues/395)
*   [初始化脚本不工作](https://github.com/fabric/fabric/blob/611133c88f7603d6f15bcf316cfe9e248b6858b8/docs/faq.rst#init-scripts-dont-work)

它还表明它似乎成功地选择了这个选项`pty=False`。你能试着检查一下吗？

```
run("twistd -y run.tac", pty=False) 
```

来自常见问题解答的更多提示：

*   [为什么-ti-run-programs-in-the-background-with-it-makes-fabric-hang](http://docs.fabfile.org/en/1.4.2/faq.html#why-can-t-i-run-programs-in-the-background-with-it-makes-fabric-hang)

# ms-access - 日期比较 - 条件失败，但返回 True

> ID：11036398
> 
> 赞同：1
> 
> 时间：2012-06-14T15:28:12.167
> 
> 标签：ms-access, vba

我正在尝试将日期与去年的下个月第一天进行比较。如果 date1 的日期小于去年下个月的第一天，那么我希望它返回 true。仅当我将日期设置为提前一年时，该条件似乎才会失败。

```
LastRightToKnow = 7/14/2011
Dim RTK As String
RTK = ""
If [NeedsRightToKnow] = -1 And [LastRightToKnow] < DateSerial(Year(Now() - 1), Month(Now() + 1), 1) Then
RTK = "Right-To-Know"
End If 
```

所以，根据我的理解，我认为如果`today = 6/14/2012`那时

```
DateSerial(Year(Now() - 1), Month(Now() + 1), 1)  = 7/01/2011 
LastRightToKnow = 7/14/2011 
```

因此`7/14/2011 < 7/01/2011`应该返回`False`。但是它会返回`true`......我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:50:06.863

由于括号的位置，您的公式已关闭：

```
? DateSerial(Year(Now() - 1), Month(Now() + 1), 1)
6/1/2012 
? DateSerial(Year(Now()) - 1, Month(Now()) + 1, 1)
7/1/2011 
```

编辑：需要在一个月内做同样的事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:45:48.150

```
Now() +1 = tomorrow 
```

我想你的意思是

```
DateSerial(Year(Now())-1, Month(Now())-1, 1)  = 7/01/2011 
```

# c++ - 单元测试、模拟和 unique_ptr

> ID：11036403
> 
> 赞同：6
> 
> 时间：2012-06-14T15:28:27.877
> 
> 标签：c++, c++11, mocking, smart-pointers, unique-ptr

有一个正在测试的类当前`unique_ptr< Interface >&&`在其构造函数中接受 a ，以表示它希望获得接口实现的单一所有权。当想要使用模拟来测试这个类时会出现问题`Interface`：模拟框架（HippoMocks）只给我`Interface*`我不拥有的，因此不能删除。

在测试作为参数的类之前，我遇到了同样的问题`const shared_ptr< Interface >&`，但通过提供自定义无操作删除器解决了这个问题：

```
template< class T >
void NoDelete( T* )
{
}

  //create a shared_ptr without effective deleter
template< class T >
std::shared_ptr< T > mock_shared( T* t )
{
  return std::shared_ptr< T >( t, NoDelete< T > );
}

Interface* iface = mocks.GetMeAMock< Interface >();
DoStuffWithSharedPtrOfInterface( mock_shared< Interface >( iface ) ); 
```

unique_ptr 的类似修复并没有真正奏效，因为删除器是模板参数：

```
template< class T >
struct NoDelete
{
  void operator ()( T* )
  {
  }
};

  //oops this is totally useless since std::unique_ptr< T, NoDelete< T > >
  //is not quite the same type as std::unique_ptr< T >
template< class T >
std::unique_ptr< T, NoDelete< T > > mock_unique( T* t )
{
  return std::unique_ptr< T, NoDelete< T > >( t, NoDelete< T >() );
} 
```

有解决方法吗？或者我不应该首先在这里使用 unique_ptr 吗？

**更新** 我试了一下；应该可以工作，但 sizeof( ptr ) 现在是 8，很难说它有什么影响。

```
 //use CustomUniquePtr::type instead of uniqe_ptr
template< class T >
struct CustomUniquePtr
{
  typedef typename std::unique_ptr< T, void (*) ( T* ) > type;
}

  //use everywhere
template< class T >
CustomUniquePtr< T >::type make_unique( T* p )
{
  return CustomUniquePtr< T >::type( p, Delete< T > );
}

  //use when mocking, doe not delete p!
template< class T >
CustomUniquePtr< T >::type mock_unique( T* p )
{
  return CustomUniquePtr< T >::type( p, NoDelete< T > );
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T17:05:25.793

`shared_ptr`将其删除器与其他簿记数据（引用计数等）一起存储在堆上；`unique_ptr`没有堆开销，因此删除器必须存储在对象中并成为类型的一部分。

您可以将构造函数模板化`Deleter`并将其转换`unique_ptr`为 a`shared_ptr`以擦除删除器类型。

更好的（取决于接口的大小）将提供一个代理`Interface`对象转发到 mocked `Interface *`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T07:04:32.930

我可以想到几个选项，没有特别的顺序：

*   在测试代​​码中（并且**仅**在测试代码中，您不希望在您的应用程序中这样做）专门`default_delete<Interface>`用于不实际删除任何内容。这将意味着永远不会删除它拥有的对象，如果您的对象即使在测试中也应该删除拥有的对象`unique_ptr<Interface>`，这可能是不可取的。`unique_ptr<Interface>`

*   创建一个实现`Interface`，将所有内容转发给提供给其构造函数的实例。然后，您可以在转发到模拟框架提供的接口的测试中动态分配一个实例。

*   更改模拟框架以动态分配接口，以便可以将其删除。

*   更改您的代码以使用 a`std::shared_ptr`以便您可以传递自定义删除器。但是，这会失去“唯一所有权”属性。

*   更改您的代码以使用根据构造参数删除或不删除的自定义智能指针。这可能只是 a 的包装`unique_ptr`，带有“是否删除”标志。在分配/销毁调用中，如果标志设置为“不删除”，那么只需调用`release()`包装`unique_ptr`而不是允许它删除对象。用户对自定义指针类型的熟悉程度低于标准指针类型，并且标志会占用空间。

*   使用类型生成器，就像你在“更新”中一样，所以到处都说`CustomUniquePtr<T>::type`，然后让类型生成器添加删除器。这里的缺点是用户代码必须知道删除器才能从原始指针创建该类型的新实例。这意味着用户代码`Interface`在不知道删除器的情况下无法轻松地创建您的实现（即使是一个简单的只记录调用并转发它们的实现）。

当然可能还有其他选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T09:47:22.517

Hippomock 已经为这个问题提供了解决方案。如果你有一个带有虚拟析构函数的接口，那么你需要做的就是为析构函数注册一个期望。模拟不会因调用其析构函数而被破坏，因为它是模拟析构函数，但必须设置对析构函数调用的期望。

```
MockRepository mocks;
// create the mock
std::unique_ptr<IFoo> foo( mocks.Mock<IFoo>() );

// register the expectation for the destructor
mocks.ExpectCallDestructor( foo.get() );

// call to mocks destructor ok, mock not destroyed
foo.reset( nullptr ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T11:36:27.403

在答案中给出的所有选项中，最合适的一个肯定是修改模拟框架，因为我可以继续使用 plain `unique_ptr`。我不知道如何让它动态分配模拟实例，但事实证明我可以让它模拟`delete`自己。这很 hacky，但它似乎工作正常。

基本上 hippomocks 直接更改 vtable，使条目指向检查期望等的函数。现在，据我所知，在 MSVC 上，具有虚拟析构函数的类的 vtable 中的第一个条目是标量删除析构函数。调用`delete ptr`. 而且，这通常是编译器生成并调用析构函数。因此，改变 vtable 并使第一个入口点指向其他东西，即无操作，解决了这个问题。

这是添加到 MockRepository 的代码，它只是更改的函数之一的副本`RegisterExpect_`ro 始终使用`void(void*)`签名：

```
template< int X >
void NoOp( void* )
{
}

  //make first vtable entry point to NoOp
template< int X, typename Z2 >
void DeleteExpect( Z2 *mck )
{
  const int funcIndex = 0; //index of scalar deleting destructor
  void (MockRepository::*mfp)(void*) = &MockRepository::NoOp< X >;
  BasicRegisterExpect( reinterpret_cast<mock<Z2> *>( mck ),
   funcIndex, reinterpret_cast<void (base_mock::*)()>( mfp ), X );
}

#define MockDelete( obj ) DeleteExpect< __COUNTER__ >( obj ) 
```

以下是它的使用方法：

```
MockRepository mocks;
Interface* p = mocks.InterfaceMock< Interface >();
mocks.MockDelete( p );

mocks.InterfaceMock< DataStitcher >( std::unique_ptr< Interface >( p ) ); 
```

# jquery - jQuery 错误 - 从下拉列表中选择的选项/值

> ID：11036404
> 
> 赞同：1
> 
> 时间：2012-06-14T15:28:28.647
> 
> 标签：jquery

我有一个下拉列表的代码。And when a certain option of the drop-down list is selected, its assigned DIV is shown with the other div's hidden. 如果选择了另一个选项，则隐藏现有 DIV 并显示其分配的 div。

但是，显示/隐藏的 div 不能正常工作。

Firebug 报告以下内容（箭头指向“$”）：

```
missing ( before switch expression
[Break On This Error]     

switch $(this).val(){ 
```

下面是jQuery代码：

```
$('#ddlOptions').change(function(){
    $('div.Results').hide();
    switch $(this).val(){
      case '1': $('#divResults1').show();break; 
      case '2': $('#divResults2').show();break;
      case '3': $('#divResults3').show();break;
    }
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:30:30.740

因为它应该是：`switch ($(this).val())`而不是`switch $(this).val()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:32:29.677

```
$('#ddlOptions').change(function(){
    $('div.Results').hide();
    $('#divResults'+($(this).val()*1)).show();
}); 
```

# html - CSS3：边框半径 div 上的边框

> ID：11036405
> 
> 赞同：1
> 
> 时间：2012-06-14T15:28:33.873
> 
> 标签：html, css

我正在尝试在使用边框半径属性的 div 上使用边框属性。

这是我的CSS：

```
#page {
    border: 1px solid #beb2b2;
    width: 732px;
    -webkit-border-radius: 15px;
    -moz-border-radius: 15px;
    border-radius: 15px;
} 
```

如您所见，我只是放置了一个边框半径（每个浏览器具有所有不同的属性）以及一个 1px 的边框。问题是两个顶角都没有绘制边框。它被绘制在其他任何地方，包括底角。我在谷歌上找了一些东西，但找不到任何东西......

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:33:34.620

其他标记和样式存在问题，因为**您的 css 是正确的**：[*testcase on dabblet*](http://dabblet.com/gist/2931000) ![在此处输入图像描述](../Images/82c423a62c3fa6b2a626e933a1be3658.png)

尝试添加一些边距：`#page { margin: 15px; }`可能是边框简单不**可见**或隐藏**容器**`#page``border`**`overflow: hidden;`**

**更新：**问题也可能存在于 inner`image`中，它可以覆盖或忽略某些父属性（例如`border-radius`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:33:24.857

页面高度未定义。这就是为什么它跨越整个窗口而您看不到其他边框的原因。

也许这就是它不起作用的原因。

我只是做了一些改变。见[小提琴](http://jsfiddle.net/aniketpant/5jGJj/)。

## HTML

```
<div id=page></div>​ 
```

## CSS

```
#page {
    border: 1px solid #beb2b2;
    width: 732px;
    -webkit-border-radius: 15px;
    -moz-border-radius: 15px;
    border-radius: 15px;
    margin: 10px auto; /* the extra line */
    height: 200px; /* the extra line */
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:35:01.720

我想由于高度的一些问题，底部会被隐藏，你能在上面设置一些高度吗？

# asp.net-mvc-3 - Razor 无法识别 List()？

> ID：11036412
> 
> 赞同：0
> 
> 时间：2012-06-14T15:29:13.580
> 
> 标签：asp.net-mvc-3, razor, generic-list

我的观点是这样开始的：

```
@using MyNamespace.Models.Mapping
@{
    PlacemarkKmlModel pmodel = new PlacemarkKmlModel();
    pmodel.Center.Latitude = 8.52115M;
    pmodel.Center.Longitude = -80.35981667M;
    pmodel.KmlObjectTokens kmlIDs = new List<string>();
    pmodel.KmlObjectTokens.Add("Sample1.kml");
    pmodel.KmlObjectTokens.Add("Sample2.kml");
}
@Html.Partial("_Mapping", @pmodel, @ViewData) 
```

Intellisense 在第三个 pmodel 语句“找不到类型或命名空间‘pmodel’”中给我一个红色下划线：

```
pmodel.KmlObjectTokens kmlIDs = new List<string>(); 
```

这很奇怪，因为它没有在 PlacemarkKmlModel pmodel 声明中给出错误，也没有在它甚至自动完成 KmlObjectTokens 的语句中使用相同的错误，但它在第 3 次失败？！。

当我执行视图时，我得到同样的错误：

```
CS0246: The type or namespace name 'pmodel' could not be found (are you missing a using directive or an assembly reference?) 
```

该错误在某种意义上具有误导性，因为它抱怨 pmodel 但它似乎不喜欢的是 List()。

我的模型如下所示：

```
public class PlacemarkKmlModel
{
    public ViewportCenterModel Center { get; set; }

    public List<string> KmlObjectTokens { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:30:50.973

试试这样：

```
@using MyNamespace.Models.Mapping
@{
    PlacemarkKmlModel pmodel = new PlacemarkKmlModel();
    pmodel.Center.Latitude = 8.52115M;
    pmodel.Center.Longitude = -80.35981667M;
    pmodel.KmlObjectTokens = new List<string>();
    pmodel.KmlObjectTokens.Add("Sample1.kml");
    pmodel.KmlObjectTokens.Add("Sample2.kml");
}
@Html.Partial("_Mapping", pmodel, ViewData) 
```

请注意，在您的代码中，您`@(`不必`@{`打开代码片段。

另请注意，以下是无效的 C#：

```
pmodel.KmlObjectTokens kmlIDs = new List<string>(); 
```

我猜你想简单地`KmlObjectTokens`在实例上分配属性，`pmodel`在这种情况下正确的语法是：

```
pmodel.KmlObjectTokens = new List<string>(); 
```

最后一点：视图不打算包含 C# 代码和初始化模型。这是控制器的责任。恐怕您混淆了 MVC 模式中的职责。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T07:24:01.297

您可以解决 razor 将 <string> 视为 HTML 标记的事实，如下所示：

1.  创建一个助手类，其中您有一个字符串列表工厂：

    ```
     public class Helpers
     {
        public static List<string> GetNewStringList()
        {
            return new List<string>();
        }
     } 
    ```

2.  在 razor 视图中使用该工厂创建一个新的字符串列表：

    @pmodel.KmlObjectTokens = Helpers.GetNewStringList();

但是，正如 Darin 所说，您不应该在 MVC 模式中混合职责，因此模型应该已经包含填充了数据的 KmlObjectTokens 列表。

# javascript - php脚本回显中的双引号

> ID：11036420
> 
> 赞同：19
> 
> 时间：2012-06-14T15:29:50.507
> 
> 标签：javascript, php, syntax, echo

我有一行看起来像这样的 php 代码：

```
echo "<script>$('#edit_errors').html('<h3><em>Please Correct Errors Before Proceeding</em></h3>')</script>"; 
```

我想知道如何正确地为文本添加字体颜色。如果我这样做：

```
echo "<script>$('#edit_errors').html('<h3><em><font color="red">Please Correct Errors Before Proceeding</font></em></h3>')</script>"; 
```

“红色”一词是黑色文本，编译器会抛出错误。

如果我在红色周围使用单引号，则文本根本不会显示。

任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-06-14T15:30:24.517

你需要 escape `"`，所以它不会被解释为字符串的结尾。用来`\`逃避它：

```
echo "<script>$('#edit_errors').html('<h3><em><font color=\"red\">Please Correct Errors Before Proceeding</font></em></h3>')</script>"; 
```

阅读更多：[字符串](http://php.net/manual/en/language.types.string.php)和[转义序列](http://php.net/manual/en/regexp.reference.escape.php)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-14T15:33:32.363

使用[HEREDOC](http://php.net/heredoc)，它消除了交换引用类型和/或转义它们的任何需要：

```
echo <<<EOL
<script>$('#edit_errors').html('<h3><em><font color="red">Please Correct Errors Before Proceeding</font></em></h3>')</script>
EOL; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-14T15:30:45.993

只是逃避你的报价：

```
echo "<script>$('#edit_errors').html('<h3><em><font color=\"red\">Please Correct Errors Before Proceeding</font></em></h3>')</script>"; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-14T15:31:27.990

您需要通过在 .`\`之前添加反斜杠来转义字符串中的引号`"`。

像：

```
"<font color=\"red\">" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-23T03:16:32.497

如果您需要在引号中访问变量以获取 echo 语句，请将变量放在大括号内

```
echo "i need to open my lock with its: {$array['key']}"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-19T19:11:14.370

您可以放弃字母数字属性的引号：

```
echo "<font color=red> XHTML is not a thing anymore. </font>";
echo "<div class=editorial-note> There, I said it. </div>"; 
```

在 HTML 中完全有效，尽管仍然被回避，但自 HTML5 以来绝对流行。

**注意事项**

*   它仅对大多数字母数字和破折号组合有效。
*   永远不要在用户输入附加到属性（那些需要引用和[`htmlspecialchars`](http://php.net/htmlspecialchars)/或一些白名单）的情况下这样做。
*   另请参阅：[当属性值在 HTML5 中不被引用时](https://stackoverflow.com/questions/5445385/when-the-attribute-value-can-remain-unquoted-in-html5)
*   在其他新闻中：`<font>`具体来说有点过时了。

# mysql - MySQL SELECT WHERE EQUALS 语法

> ID：11036422
> 
> 赞同：4
> 
> 时间：2012-06-14T15:29:56.447
> 
> 标签：mysql, syntax

我有一个名为 Participant 的 MySQL 数据库表，它看起来像这样：

```
(idParticipant) - (firstName) - (secondName) - (gender) - (dob)

118   John     Dunne         m    1944-04-01

117   Mary     Delaney       f    1955-05-03

116   Adam     Bermingham    m    1920-01-01

115   Eamonn   Reilly        m    1987-03-19

114   Aaron    Duane         m    1990-07-08

119   Sarah    Calvin        f    1977-07-17 
```

当我使用这个查询时：

```
SELECT * FROM `Participant` WHERE idParticipant = 118 OR 119; 
```

我想我应该得到以下结果：

```
118  John    Dunne       m    1944-04-01

119  Sarah   Calvin      f    1977-07-17 
```

但相反，它只返回整个表。我的 MySQL 语法哪里出错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T15:31:49.883

你需要使用`WHERE idParticipant IN (118, 119);`

我的猜测是 MySQL 隐式地将 119 的值转换为布尔真值，所以你说：`WHERE idParticipant = 118 OR TRUE;`，因此包括所有行。首先评估相等性，然后是 Boolean `OR`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-13T20:51:47.147

您应该单独查看`WHERE`作为布尔语句之后的语句。我的意思是，你的表达应该是这样的：

```
SELECT * FROM `Participant` WHERE idParticipant = 118 OR idParticipant = 119; 
```

# ruby-on-rails-3 - Rails 3 link_to 到没有模型的命名空间控制器操作

> ID：11036428
> 
> 赞同：0
> 
> 时间：2012-06-14T15:30:06.530
> 
> 标签：ruby-on-rails-3, namespaces

我有以下 Rails 控制器（此控制器没有模型）：

```
class Admin::AdminController < ApplicationController
  def login
  end
end 
```

我无法使用“link_to”链接到此控制器操作。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:14:45.027

在您的 routes.rb 中：

```
namespace :admin do
  resources :admin do
    collection do
      post :login 
```

您的链接到

```
<%= link_to "Anything", login_admin_admin_path %> 
```

试试这个。

# php - 检查所有函数参数

> ID：11036429
> 
> 赞同：0
> 
> 时间：2012-06-14T15:30:08.390
> 
> 标签：php

我一直想知道如何以简洁明了的方式在任何函数中有效地检查所有参数。我想出了：

```
function fooBar($myArg, $mySecondArg, $myOptionnalArg = "defaultValue"){
    if(!isset($myArg, $mySecondArg, $myOptionnalArg){
        die(__FUNCTION__ . ":missing parameter");
    }

    if(empty($myArg, $mySecondArg, $myOptionnalArg){
        die(__FUNCTION__ . ":empty parameter");
    }
    //Do stuff
} 
```

我正在寻找的更像是：

```
function fooBar($myArg, $mySecondArg, $myOptionnalArg = "defaultValue"){
    $argArray = func_get_args();
    foreach($argArray as $a){
        if(empty($a)){
            die(__FUNCTION__.":".get_arg_name($a)."is empty");
        }        
        if(!isset($a)){
            die(__FUNCTION__.":".get_arg_name($a)."is unset");
        }    
    }
    //Do stuff
} 
```

Wich 不起作用，因为`get_arg_name();`它是纯虚构`func_get_args();`的，它返回实际参数，而不是原型中定义的参数。

有人可以给我一个提示吗？任何其他好的/干净的方式来实现这一点也是受欢迎的。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:38:25.370

只有[反射](http://dk.php.net/manual/en/class.reflectionfunction.php)。一些例子：

```
function test($a, $b, $c) {
  $function = new ReflectionFunction(__FUNCTION__);
  $parameters = $function->getParameters();

  print_r($parameters);
}

test(0, 1, 2); 
```

你会看到这样的东西：

```
Array
(
    [0] => ReflectionParameter Object
        (
            [name] => a
        )

    [1] => ReflectionParameter Object
        (
            [name] => b
        )

    [2] => ReflectionParameter Object
        (
            [name] => c
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:37:15.387

使用 php 反射可以得到你需要的东西：

[http://php.net/manual/en/book.reflection.php](http://php.net/manual/en/book.reflection.php)

请阅读更多关于如何使用它的信息。

# android - 以编程方式切换键盘配置文件

> ID：11036435
> 
> 赞同：20
> 
> 时间：2012-06-14T15:30:27.547
> 
> 标签：android, android-softkeyboard

有什么方法可以以编程方式切换已安装的键盘（无需手动进入设置部分）？

我的要求是向用户展示手机上安装的所有键盘，并获得一个选择器对话框来切换到一个愿望？

（基本上我们想减少将他转移到设置页面的步骤）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-10-15T07:43:26.873

这段代码将满足您的要求：

```
InputMethodManager imeManager = (InputMethodManager) getApplicationContext().getSystemService(INPUT_METHOD_SERVICE);
imeManager.showInputMethodPicker(); 
```

正如 Commonsware 在他的回答中指出的那样，没有办法在用户背后做这件事。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-11-30T13:22:24.347

如果你的应用有系统权限，并且有权限

```
<uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS" /> 
```

您可以以编程方式启用键盘并将其设置为当前键盘，方法是使其成为默认键盘，**无需用户知识或干预！**

```
//get the old default keyboard in case you want to use it later, or keep it enabled
String oldDefaultKeyboard = Settings.Secure.getString(resolver, Setting.Secure.DEFAULT_INPUT_METHOD);

//enable your keyboard
Settings.Secure.putString(resolver, Settings.Secure.ENABLED_INPUT_METHODS, "com.my.keyboard/.full.path");

//set your keyboard as the new default keyboard
Settings.Secure.putString(resolver, Settings.Secure.DEFAULT_INPUT_METHOD, "com.my.keyboard/.full.path"); 
```

您可以通过向 提供键盘列表来启用多个键盘（例如默认键盘和您自己的键盘）`ENABLED_INPUT_METHODS`，以“：”分隔。查看[文档](http://developer.android.com/reference/android/provider/Settings.Secure.html#ENABLED_INPUT_METHODS)

`ime list -a`您可以通过调用来验证键盘的完整包和路径 ID`adb shell`

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-11-07T05:35:33.983

如果您有根设备，则可以使用`/system/bin/ime`实用程序。

列出所有已安装的输入法：`# ime list -a`

将谷歌的键盘设置为默认：
`# ime set com.google.android.inputmethod.latin/com.android.inputmethod.latin.LatinIME`

在 Java 端使用[Runtime.getRuntime().exec(...)](http://developer.android.com/reference/java/lang/Runtime.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-14T16:12:14.573

> 有什么方法可以以编程方式切换已安装的键盘（无需转到设置部分）？

幸运的是，不，出于安全原因。如果应用程序可以指定使用什么输入法编辑器，恶意软件会将输入法编辑器更改为他们的键盘记录器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-20T06:19:56.923

```
import android.content.Intent;

import android.view.inputmethod.InputMethodManager;

// To enable keyboard

startActivity(new Intent("android.settings.INPUT_METHOD_SETTINGS"));

// To activate the keyboard

InputMethodManager imeManager = (InputMethodManager) 
getApplicationContext().getSystemService(INPUT_METHOD_SERVICE);
imeManager.showInputMethodPicker(); 
```

# java - 如何将 shibboleth 从 cookie 更改为查询字符串？

> ID：11036438
> 
> 赞同：0
> 
> 时间：2012-06-14T15:30:32.630
> 
> 标签：java, .net, saml, shibboleth

如何让 shibboleth 改变它管理会话的方式（a la cookie）来使用查询字符串？

我看到了跨站点开发的问题，因为 IE 拒绝 cookie 而 FF 没有。

我尝试添加 p3p 标头无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:13:42.887

您是否尝试在 Session 标签中设置 relayState 值？您可以选择 URL 或 cookie 或其他。我不确定这是否能解决您的需求。

[https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPSessions](https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPSessions)

# matplotlib - Matplotlib wxWidget 在 Cygwin 上绘制缺少的按钮图像

> ID：11036439
> 
> 赞同：1
> 
> 时间：2012-06-14T15:30:34.963
> 
> 标签：matplotlib, cygwin, wxwidgets

截屏：

![在此处输入图像描述](../Images/aafccd13b0cfa1a0c7d76e7d31592fde.png)

这个问题可能是什么原因：是 Cygwin 问题，还是 wx/wxPython 问题，还是 Matplotlib 问题？

除了在每个情节上弹出有关缺少按钮图像的错误外，一切正常

* * *

后天：当我[编译](http://gnuradio.org/redmine/projects/gnuradio/wiki/WxPythonCygwin)wx 以使用本机 Windows 图形界面（无需安装 X 服务器和 gtk）时，它基本上是 Windows 编译（不是 Cygwin 编译），因此它不理解 Cygwin POSIX 路径，而 Cygwin 包可以使用它。

不仅仅是 MPL 有这种问题，任何将 Cygwin 资源作为文件名传递给 wx 的 wx 包都有问题。一种解决方法是传递 python 对象而不是路径，因此对于上面的示例，这可以是这样的解决方法：

Matplotlib 使用`_load_bitmap(filename as str)`函数将这些按钮图形通过`wx.Bitmap(filename)`. 像这样打补丁`backend_wx.py`：

```
#   bmp = wx.Bitmap(bmpFilename)

    wxf = open(bmpFilename, 'rb')
    bmp = wx.BitmapFromImage(wx.ImageFromStream(wxf, wx.BITMAP_TYPE_ANY))
    wxf.close() 
```

为 Matplotlib 解决了这个问题并且运行没有问题

我对适用于所有 wx 应用程序的更强大的解决方案感兴趣

# apache - Cisco ACE HTTP 日志记录

> ID：11036442
> 
> 赞同：1
> 
> 时间：2012-06-14T15:30:37.480
> 
> 标签：apache, http, logging, cisco

我有一个非常幼稚的问题。我知道 Cisco ACE 能够通过 syslog 记录事件，但它是否能够记录有关其处理的 HTTP 流量的详细信息？例如，我希望看到类似于 Apache 公共访问日志的内容，其中包含客户端 IP、时间、请求 URI、响应代码以及最重要的负载平衡信息，例如请求被转发到哪个后端服务器。

我想通过系统日志发送所有这些。有人熟悉这样做吗？提前致谢。

# xcode - 是否可以将 xcodeprojfile 与外部构建目标的 Makefile 放在同一目录中？

> ID：11036446
> 
> 赞同：0
> 
> 时间：2012-06-14T15:30:43.237
> 
> 标签：xcode, xcode4.3

我需要将 xcodeprojfile 放在与我的外部构建目标的 Makefile 相同的目录中，而不使用目录位置的绝对路径。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T15:08:38.777

事实证明，答案是肯定的！
首先，将您的 .xcodeproj 文件复制到与您的 makefile 相同的目录中。
然后在项目中添加对你的makefile的引用（确保你有一个makefile.in和一个makefile，makefile.in在项目项列表中的makefile之上。）
然后你需要设置外部构建源目录到 . 在哪里。表示当前目录。
我的项目构建得很好！

# android - android背景重复-y

> ID：11036447
> 
> 赞同：3
> 
> 时间：2012-06-14T15:30:43.503
> 
> 标签：android, background, gravity

我有一个图像，我想放在右边并在 y 轴上重复它。HTML中的“背景：url（img.png）右重复y”之类的东西。

可以在android中做到这一点吗？

当我将此位图设置为背景时，它不在右侧：

```
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
  android:src="@drawable/img_list"
  android:filter="true"
  android:dither="true"
  android:tileMode="repeat"
  android:gravity="right" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:47:01.153

我使用以下代码在 y 轴上重复图像作为背景：

```
 <bitmap xmlns:android="http://schemas.android.com/apk/res/android"
        android:src="@drawable/background"
        android:tileMode="repeat"
        android:antialias="true"
        android:dither="false"
        android:filter="false"
        android:gravity="left"
    /> 
```

对于 X 和 Y 的单独 TileModes，您需要在代码中执行此操作：

```
 BitmapDrawable TileMe = new BitmapDrawable(BitmapFactory.decodeResource(getResources(), R.drawable.listbackground));
      //TileMe.setTileModeX(TileMode.REPEAT);
      TileMe.setTileModeY(TileMode.REPEAT); 
```

# android - Android GridView 将某些项目设置为不可点击

> ID：11036452
> 
> 赞同：1
> 
> 时间：2012-06-14T15:31:02.880
> 
> 标签：android, gridview, android-gridview

我正在使用 GridView 实现自定义日历。对于这个日历，我有 3 种视图类型，{DAY, TITLE, BLANK}

有没有办法让 GridView 中的某些项目不可点击？

我要避免的是不可点击项目的按下状态动画。没关系，用户按下它们，我可以认识到它不是我的 onItemClickListener() 中的有效视图。这纯粹是出于 UI 目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T20:44:14.513

我找到了解决方案。不知道为什么我一开始没有搜索 ListViews。

您需要覆盖 isEnabled() 函数返回 false 将使其不可点击。True 将保持可点击。

```
@Override
public boolean isEnabled(int position) {
    switch(getItemViewType(position)) {
        case CellTypes.BLANK:
        case CellTypes.TITLE:
        default :
            return false;
        case CellTypes.DAY:
            return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:41:00.330

在 GridView 的适配器中，实现 get() 方法之一以返回对被单击对象的引用。我假设您的适配器包装了您的“日历”对象列表。

在 GridView 的 onItemClickListener 中，调用适配器上的 get(index) 或 get(id) 以获取对被单击对象的引用。检查其类型以查看它是否是您不希望可点击的类型，并在执行单击可点击项目时通常调用的逻辑之前返回。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-14T15:38:14.153

在 XML 中：android:clickable="false" 和在代码中：setClickable(false);

# android - Android - 如何在给定证书链的情况下为 SSL 身份验证构建密钥库

> ID：11036454
> 
> 赞同：1
> 
> 时间：2012-06-14T15:31:19.257
> 
> 标签：android, ssl, https, keystore, certificate

我需要使用所有需要的 SSL 证书构建一个密钥库，以使我的 Android 应用程序通过 https 连接到网络服务器。

这是我的证书链（用 获得`openssl s_client -connect www.myhost.com:443`）：

```
 0 s:/C=US/ST=State/L=Location/O=Organization/OU=Webserver Team/CN=www.myhost.com
   i:/C=US/O=Thawte, Inc./CN=Thawte SGC CA - G2
 1 s:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=(c) 2006 VeriSign, Inc. - For authorized use only/CN=VeriSign Class 3 Public Primary Certification Authority - G5
   i:/C=US/O=VeriSign, Inc./OU=Class 3 Public Primary Certification Authority
 2 s:/C=US/O=Thawte, Inc./CN=Thawte SGC CA - G2
   i:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=(c) 2006 VeriSign, Inc. - For authorized use only/CN=VeriSign Class 3 Public Primary Certification Authority - G5
 3 s:/C=US/O=thawte, Inc./OU=Terms of use at https://www.thawte.com/cps (c)06/CN=thawte Extended Validation SSL CA
   i:/C=US/O=thawte, Inc./OU=Certification Services Division/OU=(c) 2006 thawte, Inc. - For authorized use only/CN=thawte Primary Root CA
 4 s:/C=US/O=thawte, Inc./OU=Certification Services Division/OU=(c) 2006 thawte, Inc. - For authorized use only/CN=thawte Primary Root CA
   i:/C=ZA/ST=Western Cape/L=Cape Town/O=Thawte Consulting cc/OU=Certification Services Division/CN=Thawte Premium Server CA/emailAddress=premium-server@thawte.com 
```

我的问题是我不是 100% 确定如何创建密钥库以导入到我的 android 应用程序中。我只能从 Thawte 和 Verisign 网站下载`VeriSign Class 3 Public Primary Certification Authority - G5`和下载。`Thawte Primary Root CA`我找不到其他两个如果我没记错应该是`Thawte SGC CA - G2`和`thawte Extended Validation SSL CA`。

如果我拥有所有这些，我将继续使用此[答案](https://stackoverflow.com/a/3998257/608448)中解释的过程创建一个密钥库，以解决与此问题类似的问题。

我是不是误会了什么？我真的需要所有 4 个证书吗？我也不确定将这些证书添加到密钥库时应该使用的顺序（和别名）。有关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:16:08.727

如果您的服务器证书由 VeriSign 签名，则无需安装它，它很可能已经被 Android 信任。你有错误吗？在什么版本上？

通常，您只需在设备的信任库中安装根 (CA) 证书。如果配置正确，所有中间证书都应由服务器发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T09:18:36.500

最后，我的问题是服务器没有以正确的顺序发送证书（你可以从我在我的问题中发布的 openssl 输出中看到它）。解决方案是子类化`X509TrustManager`，并在方法上`checkServerTrusted`，在将证书链传递给超级实现之前重新排序。重新排序代码如下：

```
 int currIndex;
    for (currIndex = 0; currIndex < certificates.length; ++currIndex) {
        boolean foundNext = false;
        for (int nextIndex = currIndex + 1; nextIndex < certificates.length; ++nextIndex) {
            if (certificates[currIndex].getIssuerDN().equals(certificates[nextIndex].getSubjectDN())) {
                foundNext = true;
                // Exchange certificates so that 0 through currIndex + 1 are in proper order
                if (nextIndex != currIndex + 1)  {
                    X509Certificate tempCertificate = certificates[nextIndex];
                    certificates[nextIndex] = certificates[currIndex + 1];
                    certificates[currIndex + 1] = tempCertificate;
                }
                break;
             }
         }
         if (!foundNext) break;
     } 
```

# eclipse - 有没有办法让 Eclipse 的 Open Resource 对话框自动搜索文件名的中间？

> ID：11036466
> 
> 赞同：6
> 
> 时间：2012-06-14T15:31:55.183
> 
> 标签：eclipse

Eclipse 的 Open Resource 对话框允许您根据键入的查询搜索项目文件，但默认行为是只返回那些以给定查询开头的文件名。`*`如果要将查询解释为任意文件名子字符串，则必须在前面加上通配符。

我会说 95% 的时间，我想在前面加上通配符。类似对话框（例如 Visual Assist 或 Komodo 中的对话框）的默认行为是假设查询可以是文件名的任何部分。我想知道是否有办法强制 Eclipse 以同样的方式工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T14:40:26.443

我不这么认为。您正在谈论的 UI 使用 FileDialog 类，该类实际上无法按照您描述的方式进行配置。对我来说，这说明没有可以改变这种行为的偏好视图。我当然不知道，也找不到。

# facebook - 在头部之外使用 Facebook 共享元标签？

> ID：11036467
> 
> 赞同：3
> 
> 时间：2012-06-14T15:31:56.047
> 
> 标签：facebook, share, meta-tags

我们的网站文章后端不允许访问上述任何内容，`</head>`这会阻止我们的作者使用 facebook 元标记指定可共享的内容。任何人都知道在不访问的情况下指定共享文章的文章图像、标题和描述的替代途径`<head>`？我的搜索没有结果，如果已经回答，我很抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T19:27:10.270

您能否为您的作者提供一种在文章后端之外的其他单独页面中创建元标记的方法？

Facebook Open Graph 元标记内容不需要驻留在呈现赞按钮的同一页面中。可共享的内容（图像/标题/描述）将从 Facebook 按钮的 URL 参数中引用的页面的元内容中提取。因此，您可以创建与您的每篇文章相对应的单独页面，这些页面仅用于为 Facebook 新闻故事帖子提供元内容。只要占位符文件中的元“og:url”设置为您的文章 URL，Facebook 新闻故事帖子仍将链接回您的文章。

# mod-rewrite - 如何将子域映射到子目录？

> ID：11036468
> 
> 赞同：1
> 
> 时间：2012-06-14T15:31:58.933
> 
> 标签：mod-rewrite, subdomain, subdirectory

当有人点击特定子域时，我想显示子目录的内容。`http://my.example.us/`应该显示的内容`http://example.us/sync`。

编辑：这是我到目前为止所拥有的。它似乎根本不会影响我的 URL。

```
RewriteCond %{HTTP_HOST} ^(my)\.example\.us$
RewriteRule ^ http://example.us/sync/$1 [L] 
```

# code-generation - 如何使用 Acceleo 代码生成器保护我的方法主体（不是附加的 JavaDoc 和签名）

> ID：11036470
> 
> 赞同：0
> 
> 时间：2012-06-14T15:32:05.563
> 
> 标签：code-generation, eclipse-emf, acceleo

我使用 Acceleo 来使用我制作的模型生成代码。我设法保护我的方法，以便使用“@generated NOT”保护它们，以防我需要使用 Acceleo 重新生成我的代码。问题是添加@generated 并不能保护所有方法内容，即正文、签名和JavaDocs。

问题是我只需要保留方法体，或者至少保留方法体及其签名，但我需要更新文档。我怎样才能做到这一点 ？

仅供参考，这里是潜在生成类的示例：

```
/*
 * @generated
 */
public class ActeurRefEntrepriseServicesImpl implements ActeurRefEntrepriseServices {

    @Autowired
    HelloWorldService helloWorldService;

    /**
     * Service which say hello
     * 
     * @param name
     *           user name
     * @return print Hello username
     * 
     * @generated NOT
     */
    @Override
    public void sayHello(final String name) {
        helloWorldService.print(name);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T12:35:16.003

巴蒂斯特，

`@generated`标签使用标准的 EMF 保护规则：“ ”`@generated`表示将生成为其设置的块的*主体*，否则表示不重新生成。如果您`@generated`在任何元模型生成的代码中将某些内容设置为“”，您将在那里看到，无论您进行何种编辑，都会保留 javadoc。

简而言之，除了代码本身之外，您不能告诉 EMF 重新生成任何东西。

如果您需要保护正文而不是 javadoc，则必须从“@generated”保护转移到 Acceleo 的 [protected] 块。即，将您的模板从：

```
[template generatedMethod(methodName : String)]
    /**
     * Some doc.
     * @param param1
     *           param documentation.
     * @generated
     */
    [generateSignature(methodName)/] {
        [generateBody()/]
    }
[/template] 
```

使用受保护块的东西：

```
[template generatedMethod(methodName : String)]
    /**
     * Some doc.
     * @param param1
     *           param documentation.
     */
    [protected (methodName)]
    [generateSignature(methodName)/] {
        [generateBody()/]
    }
    [/protected]
[/template] 
```

使用这种范式，保护区*之外*的任何东西都将被再生，其他一切都将保持不变。

另请参阅[Acceleo 网站](http://www.eclipse.org/acceleo/documentation/)提供的完整文档。

如果您绝对需要`@generated`为您的模型使用 " " 保护方法，则需要篡改 EMF 中的[JMerger API](http://download.eclipse.org/modeling/emf/emf/javadoc/2.8/org/eclipse/emf/codegen/merge/java/JMerger.html#)并更改为您生成的启动器 Acceleo 以使用您自己的合并策略（请参阅该启动器中的 getGenerationStrategy 方法）。请注意，这绝不是一件容易的事。

# asp.net - 提交表单后出现RequiredFieldValidator error_message

> ID：11036475
> 
> 赞同：1
> 
> 时间：2012-06-14T15:32:13.860
> 
> 标签：asp.net, c#-4.0

我提交表单并从后面的代码中清除所有字段，当页面重新呈现时，RequiredFieldValidator 错误消息出现。我正在提交表单而不是使用按钮的单击事件。表单回发后如何避免看到验证器消息？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:19:00.997

您可以将 Response.Redirect 添加到“已成功保存”页面，而不是发回自身，除非您需要留在该页面上。但是如果你想留在这个页面上，我会在下面添加一个解决方案......

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {

        }
        else
        {
            SaveRecordToDB();
            Response.Redirect("/");
        }
    } 
```

假设提交页面是 Default.aspx，否则只需重定向回您自己的表单页面。

# php - 如果记录已存在，请检查 mysql 表

> ID：11036482
> 
> 赞同：0
> 
> 时间：2012-06-14T15:32:36.450
> 
> 标签：php, mysql

我正在使用以下内容将公司数据插入到 mysql 表中。是否可以先检查公司是否已经在数据库中，然后再尝试再次输入？php 变量`$company`是我要检查的。

```
 <?php
    require("database.php");
    // Opens a connection to a MySQL server
    $con = mysql_connect("localhost", $username, $password);

    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }

    mysql_select_db("medicom_wp", $con);

    $pages = get_posts(array(
        'orderby' => 'title', 
        'post_type' => 'members',
        'numberposts' => 300,
        'post_status' => 'any'  
        ));
        foreach($pages as $post) {
        setup_postdata($post);

        $company = get_field('company_name');
        $address = get_field('address');
        $city = get_field('city');
        $post_code = get_field('post_code');

        mysql_query("INSERT INTO markers (`name`, `address`, `lat`, `lng`, `type`) VALUES ('".$company."', '".$address.", ".$city.", ".$post_code."', '0.0', '0.0', '')");
        }
        wp_reset_query();

    mysql_close($con);
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:34:25.743

1.  在插入之前执行一个 select 语句以查看它们是否在其中

2.  （不推荐）将名称字段（或标识公司的任何其他字段）设置为唯一键，这样当您再次尝试输入时，它会被拒绝

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:41:33.730

试试下面的。基本上，发送另一个查询以检查具有相同公司名称的重复行，如果查询返回 0 行，则只运行插入命令。

```
<?php
require("database.php");
// Opens a connection to a MySQL server
$con = mysql_connect("localhost", $username, $password);

if (!$con)
{
    die('Could not connect: ' . mysql_error());
}

mysql_select_db("medicom_wp", $con);

$pages = get_posts(array(
    'orderby' => 'title', 
    'post_type' => 'members',
    'numberposts' => 300,
    'post_status' => 'any'  
    ));
foreach($pages as $post) {
    setup_postdata($post);

    $company = get_field('company_name');
    $address = get_field('address');
    $city = get_field('city');
    $post_code = get_field('post_code');

    // prepare query to check for duplicate company
    $sql = sprintf("select count('x') as cnt from markers where `name` = '%s'", mysql_real_escape_string($company));
    // run query
    $row_dup = mysql_fetch_assoc(mysql_query($sql,$conn));
    // if no row exist
    if ($row_dup['cnt'] == 0) {
        // insert new company
        // consider preparing this query using sprintf() and mysql_real_escape_string() as above
        mysql_query("INSERT INTO markers (`name`, `address`, `lat`, `lng`, `type`) VALUES ('".$company."', '".$address.", ".$city.", ".$post_code."', '0.0', '0.0', '')");
    }
}
wp_reset_query();

mysql_close($con);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:37:38.473

自然的解决方案是先运行另一个查询（例如，select count()）以检查标记是否存在，并从那里分支您的条件逻辑。

一个更有趣的解决方案是使用**UPSERT**（更新 + 插入）的概念。如果行不存在，则 upsert 插入该行，如果存在则更新它。因此，无论如何，最终只会有 1 行，但这是假设您不介意覆盖数据。[这是一个关于此的示例 SO 问题。](https://stackoverflow.com/questions/1218905/how-do-i-update-if-exists-insert-if-not-aka-upsert-or-merge-in-mysql)

另一种技术涉及创建主键列并利用 mysql 的完整性检查来强制每条记录保留 1 行。因此，每个主键的第一次插入都会成功，但所有其他的都会失败。

# jquery - jQuery队列方法

> ID：11036483
> 
> 赞同：0
> 
> 时间：2012-06-14T15:32:38.213
> 
> 标签：jquery, queue, logic

我在了解 jquery 队列方法时遇到了一些麻烦。我有下面的代码，基本上是想让函数textScroll的四个部分一个接一个地执行。任何帮助将非常感激。

```
 $.fn.pause = function (n) {
  return this.queue(function () {
    var el = this;
    setTimeout(function () {
  return $(el).dequeue();
    }, n);
  });
};

function textScroll(){

    $('#winner1, #winner2').css("display", "block")
    .pause(4000)
    .animate({left: '-1000px'}, 2000);

    $('#winner3, #winner4').fadeIn()
    .pause(4000)
    .animate({left: '-1000px'}, 2000);

    $('#winner5, #winner6').fadeIn()
    .pause(4000)
    .animate({left: '-1000px'}, 2000);

    $('.winner_scroll').css("display", "none")
    .pause(1000)
    .css("left", "1000px");
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T17:01:37.187

我不明白最后一部分将显示设置为无，然后在它不显示时移动它......看起来很奇怪，但无论如何：如果你愿意，你可以硬编码变量，但我创建它们是为了显示以简单的方式举例：这使用动画的回调来开始下一个。

```
var me = {
    left: "-1000"
};
var myani = 3000;
var mywait = 4000;

function textScroll() {
    $('#winner1, #winner2').css("display", "block").animate(me, myani, function() {
        $('#winner3, #winner4').fadeIn().delay(mywait).animate(me, myani, function() {
            $('#winner5, #winner6').fadeIn().delay(mywait).animate(me, myani, function() {
                $('.winner_scroll').css("display", "none").delay(1000).css("left", "1000px");
            });
        });
    });
} 
```

CSS 在这方面很糟糕：http: [//jsfiddle.net/MarkSchultheiss/q3s9s/](http://jsfiddle.net/MarkSchultheiss/q3s9s/)但它是一个工作示例。

# php - 输出变量名及其值（在函数中）

> ID：11036485
> 
> 赞同：1
> 
> 时间：2012-06-14T15:32:41.427
> 
> 标签：php, variables

我希望能够输出变量的名称以及该变量的值。我的用例类似于调试情况，但实际上我正在为其他开发人员和管理人员构建概念验证，以便我们可以讨论输入过滤之类的问题。反正...

输出 HTML 当前是一个表格，但这无关紧要。当然，我可以只打印名称，然后打印 HTML 中的内容，但这会变得乏味并且容易出现输入错误。我想要一个可以使用变量名或以变量名作为参数调用的函数，并让该函数生成适当的 HTML 以供显示。这似乎不起作用。

这有效：

```
<tr><td>$variable</td><td><?php print $variable?></td></tr> 
```

这不会：

```
function rowFromVar($varname) {
    $result  = "<tr>";
    $result .= "<td>\$$varname</td>";
    $result .= "<td>" . $$varname . "</td>";
    $result .= "</tr>";
    return $result;
}
// now in the HTML...
<table><?php print rowFromVar("variable");?></table> 
```

变量变量`$$varname`始终为空。请注意，我将变量的名称作为字符串传递，而不是尝试传递变量本身并使用它。我知道[那里有龙](https://stackoverflow.com/questions/255312/how-to-get-a-variable-name-as-a-string-in-php)。相反，我试图将变量的名称作为字符串传递，然后使用变量变量（是的，我知道）返回原始变量的值。这似乎也不起作用，我打赌这是一个范围问题。

有什么好方法可以完成我正在寻找的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:35:45.963

> 变量变量 $$varname 始终为空。请注意，我将变量的名称作为字符串传递，而不是尝试传递变量本身并使用它

**它应该是空的**

由于您`variable`作为值传递，因此：

```
$$varname 
```

变成：

```
$variable 
```

并且没有为它设置**值**。

换句话说，您只是创建了一个变量，其名称作为参数传递给函数，但您并没有为它创建值。

**解决方案：**

这会很好，但如果这是你想要做的：

```
function rowFromVar($varname) {
    $result  = "<tr>";
    $result .= "<td>\$$varname</td>";
    $result .= "<td>" . $varname . "</td>";
    $result .= "</tr>";
    return $result;
}

// now in the HTML...
<table><?php print rowFromVar("variable");?></table> 
```

`$`只需像上面那样从这一行的变量中删除：

```
$result .= "<td>" . $$varname . "</td>";
--------------------^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:36:41.530

您是否尝试使用`$GLOBALS[$varname]`而不是`$$varname`？此示例中的变量位于全局范围内，您不能直接访问函数内的全局变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:42:28.487

您需要`global`在函数中声明变量，以便它引用全局版本。在函数的开头添加这一行应该可以解决问题：

```
function rowFromVar($varname) {
    global $$varname;
    $result  = "<tr>";
    $result .= "<td>\$$varname</td>";
    $result .= "<td>" . $$varname . "</td>";
    $result .= "</tr>";
    return $result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:42:38.470

**请尝试以下代码：**

```
function rowFromVar($varname) {
    $result  = "<tr>";
    $result .= "<td>{$varname}</td>";
    $result .= "<td>".$varname."</td>";
    $result .= "</tr>";
    return $result;
}

<table><?php echo rowFromVar("variable");?></table> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T15:38:25.777

以下代码应该可以工作，因为您怀疑范围是这里的主要问题。

```
function rowFromVar($varname, $contents) {
    $result  = "<tr>";
    $result .= "<td>\$$varname</td>";
    $result .= "<td>" . $contents . "</td>";
    $result .= "</tr>";
    return $result;
}
// now in the HTML...
<table><?php print rowFromVar("variable", $variable);?></table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-04T12:27:04.380

我有一个类似的问题，我解决了如下。

```
function contents_of($string)
{
  eval("global $string; \$value = $string;");
  return "Variable $string has value $value";
}

$testing = 123;
echo contents_of('$testing');

// produces...
// Variable $testing has value 123 
```

# c - 如何遍历结构中的所有项目？

> ID：11036486
> 
> 赞同：2
> 
> 时间：2012-06-14T15:32:43.480
> 
> 标签：c, struct, structure

例如，我有这种结构格式

```
typedef struct{
  tMY_STRUCT2 my_struct2;
  u16 item1;
  u8 item2[20];      
  u32 item3;
}tMY_STRUCT; 
```

**我怎样才能通过结构？** 由于**对齐不是那么容易，我不能只计算从****SIZEOF(item)**开始的结构的偏移量。

有什么办法吗？

**原因：**我需要启动大结构，这有一些条件，所以我需要在一个FOR循环内完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T15:34:55.683

不要这样做。结构的要点是您*无法*统一处理其数据项。结构之于异构数据，就像数组之于同质数据。

在代码中一次初始化每个字段或将整个结构初始化为零。这些是唯一的良好实践选择。尤其是对齐将取决于机器架构、编译器等，因此如果您对代码进行看似微不足道的更改，例如重新排序声明中的字段，或者在不同的操作系统上运行或在其他地方编译，那么使用它的方法可能会中断.

选项：

```
memset(mystruct, 0, sizeof(mystruct)); 
```

或（我认为这是 C99） `mystruct_t foo = {0};`

或者只是初始化每个字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:42:08.893

我不太明白 for 循环如何在这里为您提供帮助......但是没有很好的方法来迭代结构。

你可以在你的结构中设置一个指向对象的指针结构，然后通过 sizeof(ptr) 跳过它，但这太可怕了，你的同事会私刑处死你。

# objective-c - NSWindow 下订单时使 App 失去焦点

> ID：11036491
> 
> 赞同：0
> 
> 时间：2012-06-14T15:33:07.693
> 
> 标签：objective-c, cocoa, nswindow

```
NSApplication *thisApp = [NSApplication sharedApplication];
[thisApp activateIgnoringOtherApps:YES];
[self.window orderFrontRegardless]; 
```

我使用上面的代码使我的应用程序在需要显示窗口时获得焦点，我想让应用程序在隐藏窗口时失去焦点。

```
[self.window orderOut:self];
[self.window resignMainWindow];
[self.window resignKeyWindow]; 
```

上面的代码不能解决问题。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:00:31.410

如果您乐于隐藏应用程序的所有窗口，您可以使用`[[NSApplication sharedApplication] hide:nil]`. 这将自动激活下一个应用程序。如果您想激活另一个应用程序但仍将您的应用程序保留在屏幕上，这有点困难。对于 Mac OS X 10.6+，您可以使用[NSRunningApplication](http://developer.apple.com/library/mac/#documentation/AppKit/Reference/NSRunningApplication_Class/Reference/Reference.html#//apple_ref/occ/cl/NSRunningApplication)类在激活之前找到当前应用程序，然后在完成后重新激活它。

# asp.net - 从 MVC 2.0 代码转换为 razor 语法

> ID：11036496
> 
> 赞同：1
> 
> 时间：2012-06-14T15:33:29.783
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-2, razor, migration

我正在尝试将流行的 asp.net MVC 2.0 solr.net 示例应用程序代码转换为 Razor 语法。我无法理解最后一行...请帮助

```
 <% Html.Repeat(new[] { 5, 10, 20 }, ps => { %>
            <% if (ps == Model.Search.PageSize) { %>
            <span><%= ps%></span>
            <% } else { %>
            <a href="@Url.SetParameters(new {pagesize = ps, page = 1})">@ps</a>
            <% } %>
  <% }, () => { %> | <% }); %> 
```

[更新] **Html.Repeat 扩展的来源**

[HtmlHelperRepeatExtensions.cs](https://github.com/paulbouwer/SolrNet/blob/master/SampleSolrApp/Helpers/HtmlHelperRepeatExtensions.cs)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:40:16.520

为此，您必须修改`Html.Repeat`扩展方法以利用Phil Haack 所说明的[Templated Razor Delegates 。](http://haacked.com/archive/2011/02/27/templated-razor-delegates.aspx)进而：

```
@{Html.Repeat(
    new[] { 5, 10, 20 }, 
    @<text>
        @if (item == Model.Search.PageSize)
        {
            <span>@item</span>
        }
        else
        {
            <a href="@Url.SetParameters(new { pagesize = item, page = 1 })">
                @item
            </a>
        }
    </text>,
    @<text>|</text>
);} 
```

* * *

更新：

根据您更新的问题，您似乎正在使用自定义 HTML 帮助程序，但正如我在回答中所述，如果您希望它工作，您需要更新此帮助程序以使用 Templated Razor Delegates 语法。例如，它的外观如下：

```
public static class HtmlHelperRepeatExtensions
{
    public static void Repeat<T>(
        this HtmlHelper html,
        IEnumerable<T> items,
        Func<T, HelperResult> render,
        Func<dynamic, HelperResult> separator
    )
    {
        bool first = true;
        foreach (var item in items)
        {
            if (first)
            {
                first = false;
            }
            else
            {
                separator(item).WriteTo(html.ViewContext.Writer);
            }

            render(item).WriteTo(html.ViewContext.Writer);
        }
    }
} 
```

或者如果你想让帮助方法直接返回一个 HelperResult ，这样你在调用它时就不需要使用方括号：

```
public static class HtmlHelperRepeatExtensions
{
    public static HelperResult Repeat<T>(
        this HtmlHelper html,
        IEnumerable<T> items,
        Func<T, HelperResult> render,
        Func<dynamic, HelperResult> separator
    )
    {
        return new HelperResult(writer =>
        {
            bool first = true;
            foreach (var item in items)
            {
                if (first)
                    first = false;
                else
                    separator(item).WriteTo(writer);
                render(item).WriteTo(writer);
            }
        });
    }
} 
```

然后在你的视野内：

```
@Html.Repeat(
    new[] { 5, 10, 20 }, 
    @<text>
        @if (item == Model.Search.PageSize)
        {
            <span>@item</span>
        }
        else
        {
            <a href="@Url.SetParameters(new { pagesize = item, page = 1 })">
                @item
            </a>
        }
    </text>,
    @<text>|</text>
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:36:22.763

可能是这样的：

`}, () => { <text>|</text> });`

# html - 从 Servlet 调用 JSP 页面

> ID：11036500
> 
> 赞同：0
> 
> 时间：2012-06-14T15:33:48.963
> 
> 标签：html, jsp, servlets

任何人都可以帮助我如何从 Servlet 调用 JSP 页面（只需调用，无需传递参数）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:36:55.493

使用( [Docu](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29) )的`forward()`or`include()`方法：`RequestDispatcher`

```
getServletContext().getRequestDispatcher( "yourJspPath" )
                   .forward(request, response); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:37:40.957

不确定“调用”应该是什么意思，但如果我们谈论重定向，可以这样做：

`response.sendRedirect("your.jsp");`

# redirect - Umbraco 自定义 404 错误页面不起作用

> ID：11036508
> 
> 赞同：2
> 
> 时间：2012-06-14T15:34:16.030
> 
> 标签：redirect, http-status-code-404, umbraco

我正在使用 Umbraco 4.7，而我的服务器是 IIS7，我想知道什么不适合我。我基本上想制作一个自定义错误页面（404）并且我尝试过的一切都不起作用，检查了论坛，但它仍然显示同样的问题。

我已经编辑了我的 umbracoSettings.config

```
<errors>
   <!-- the id of the page that should be shown if the page is not found -->
   <!-- <errorPage culture="default">1647</errorPage> -->
   <!-- <errorPage culture="en-US">1647</errorPage> -->
   <error404>1647</error404>
</errors> 
```

我还考虑过将其添加到 web.config 文件中。

```
<httpErrors errorMode="Custom" existingResponse="Replace">
   <remove statusCode="404" subStatusCode="-1" />
   <error statusCode="404" prefixLanguageFilePath="" path="/error.aspx" responseMode="ExecuteURL" />
</httpErrors> 
```

任何帮助将不胜感激。我是 IIS 和任何涉及网络设置的新手。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-15T06:42:01.057

确保 1647 是 404 页面的节点 ID。

`system.webServer`还要在 web.config的标记中添加以下代码。

```
<httpErrors>
    <remove statusCode="404" subStatusCode="-1" />
    <error statusCode="400" path="/404" responseMode="ExecuteURL" />
    <error statusCode="404" path="/404" responseMode="ExecuteURL" />
</httpErrors> 
```

希望这有效...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-25T11:58:35.380

以防有人像我在研究 Umbraco 7 的类似问题时那样偶然发现这一点，在 config/umbracoSettings.config 文件中将 trySkipIisCustomErrors 值设置为 true 为我做了这件事。

```
 <web.routing
    trySkipIisCustomErrors="true"
    internalRedirectPreservesTemplate="false">
  </web.routing> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-02T10:12:21.353

我遇到了同样的问题，Sobin P Samuel 建议的解决方案对我有用（只需将 httpErrors 元素直接复制并粘贴到 Web.Config 文件中的 system.webserver 部分），所以我想这也是解决它的方法对于 paulstewart185...

请注意，根据[http://our.umbraco.org/wiki/install-and-setup/configuring-404-pages，IIS](http://our.umbraco.org/wiki/install-and-setup/configuring-404-pages) 7.5 的解决方案是将以下内容添加到 system.webserver 部分：

```
<httpErrors existingResponse="PassThrough"/> 
```

# xslt - 当我有多个 .xsl 文件时如何使用 wicket XsltTransformerBehavior

> ID：11036510
> 
> 赞同：1
> 
> 时间：2012-06-14T15:34:23.610
> 
> 标签：xslt, wicket, xsl-fo

我正在处理需要显示带有 .xsl 文件的 .xml 文件的项目的一部分。以下是部分代码：

```
FILE_PATH = "myxsl.xsl"
...
Label content = new Label("content",xmlContent);
content.setEscapeModelStrings(false);
content.add(new XsltTransformerBehavior(FILE_PATH));    
add(content);
... 
```

目前，如果我只使用一个 .xsl 文件，该页面就可以工作。但是，因为我需要处理的 .xsl 文件可能非常长，所以它们被分成几个部分。例如，我将有 mymain.xsl、head.xsl、tables.xsl mymain.xsl 包含其他类似的

```
<xsl:include href="head.xsl"/>
<xsl:include href="tables.xsl"/> 
```

我尝试将 FILE_PATH 设置为 mymain.xsl，但没有成功。该程序可以找到 mymain.xsl 但无法编译样式表，因为它找不到 head.xsl 和 tables.xsl

我一直在寻找很长时间，但仍然不知道如何做到这一点。非常感谢任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:17:06.707

我查看了 XsltTransformerBehavior 的文档，看起来它没有公开设置自定义 URI 解析器的功能（这基本上是您想要做的）。

但是，如果没有其他人有更好的解决方案，我可以提出一个解决方法：编写一个 XSLT，将您的 XSLT 文件合并到一个文件中。有关执行此操作的 XSLT，请参见[此处](https://stackoverflow.com/a/70591/347964)。如果您使用 Maven 作为构建系统，您可以使用[Maven XML Plugin的](http://mojo.codehaus.org/xml-maven-plugin/transform-mojo.html)[转换目标](http://mojo.codehaus.org/xml-maven-plugin/transform-mojo.html)在generate-resources 阶段自动执行此操作。然后，您可以将 XsltTransformerBehavior 与将在运行时可用的单文件 XSLT 相关联。

# android - 关于 CursorLoader 和 LoaderManager android 的说明

> ID：11036513
> 
> 赞同：1
> 
> 时间：2012-06-14T15:34:29.457
> 
> 标签：android

美好的一天，我有一个实现 LoaderCallbacks 的类，因此覆盖了未实现的方法。onCreateLoader()、onLoaderFinshed() 和 onLoaderReset()；

在 Activity onCreate() 中，我准备了一个加载器：

```
getLoaderManager().initLoader(0, null, this); 
```

在 onCreateLoader() 中，我在这里返回了一个自定义加载器类，它扩展了 christain 的 SimpleLoader 类。

现在只是想知道，如果我在我的类中 onCreateLoader() 方法之外的某个地方执行此操作：

```
CursorLoader loader = new cursorLoader(
this,android.provider.ContactsContract.Contacts.CONTENT_URI, null,null,null,null);
loader.loadInBackground();
//cursor = loader.loadInBackground(); 
```

LoaderCallback 是否持有对它的引用并调用 onLoadFinished() 或者这完全是一个不同的实现。这到底是什么意思？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:03:27.313

创建新的 CursorLoader 与 LoaderManager 无关。

那么在创建新的 CursorLoader 时该`onLoadFinished()`方法将**不会被调用。**

## 如果数据发生变化怎么办：

如果Loader监控的数据发生变化，Loader会重新查询自己。但是`onLoadFinished()`如果这个 Loader 没有被该方法提供给 LoaderManager，则不会调用`onCreateLoader`。

## 总结一下：

想象一下，您或其他进程正在修改您正在通过加载程序监控的数据。

如果这个 Loader**已经被**提供给 LoaderManager，`onCreateLoader`那么 `onLoadFinished()`将被调用。

如果此 Loader**尚未**提供给 LoaderManager，**则**`onCreateLoader`不会 `onLoadFinished()`调用。

# asynchronous - 带有设置和拆卸的 QUnit 异步测试

> ID：11036514
> 
> 赞同：3
> 
> 时间：2012-06-14T15:34:30.680
> 
> 标签：asynchronous, installation, qunit, teardown

我需要一点帮助来理解 QUnit internas。我不时阅读它的源代码，但是当涉及到异步测试时，我仍在编写奇怪的测试。我了解异步测试的概念，以及 stop() 和 start() 方法（以及为什么需要它们），但是当我将它们与 setup 和 teardown 结合起来时，我会遇到很多奇怪的情况。

这是我的测试代码：

```
use(['Psc.Exception','Psc.Code'], function () {
  module("async", {
    setup: function () {
      console.log('setup');
    }, teardown: function () {
      console.log('teardown');
    }
  });

  asyncTest("test1", function () {
    expect(0);

    console.log('test1');
    start();
  });

  asyncTest("test2", function () {
    expect(0);

     console.log('test2');
     start();
  });

  asyncTest("test3", function () {
    expect(0);

    console.log('test3');
    start();
  });

  asyncTest("test4", function () {
    expect(0);

    console.log('test4');
    start();
  });

  asyncTest("test5", function () {
    expect(0);

    console.log('test5');
    start();
  });
}); 
```

尽管这些都是异步测试，但我想我会在控制台中得到类似的东西：

```
setup
test1
teardown
setup
test2
teardown
setup
test3
teardown
... 
```

因为我认为 qunit 会在测试机构周围调用 setup 和 teardown ？

但我把一切都搞混了，从请求到请求以另一种方式洗牌。

```
setup
test1
teardown
setup
setup
setup
setup
test5
teardown 
test4
teardown
test3
teardown
test2
teardown 
```

有人能够逐步解释吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T05:33:47.630

这是一个记录在案的问题：

[http://api.qunitjs.com/QUnit.config/](http://api.qunitjs.com/QUnit.config/)

建议在异步加载测试时将 QUnit.config.autostart 设置为 false。这是我的情况，因为“使用”是异步执行的。

头部看起来像这样：

```
QUnit.config.autostart = false;
use(['Psc.Exception','Psc.Code'], function () {

  QUnit.start();
  module("async", { 
```

所以它基本上就像做 stop() 和 start() 但加载测试本身。我对其进行了测试，现在拆解/设置/测试以正确的顺序正确执行

# jsp - Liferay 的 Tomcat 说 JSP 文件丢失

> ID：11036520
> 
> 赞同：0
> 
> 时间：2012-06-14T15:34:54.813
> 
> 标签：jsp, liferay, portlet, tomcat7, liferay-6

我正在使用 `Liferay`6.1.0-ce-ga1 和`Tomcat 7`.

从这个版本开始，当我部署我的 Liferay portlet 时，我经常会收到这个错误。

我错过了什么吗？对于不会讲法语的人，它基本上说 JSP 文件丢失了。

信息：

*   我的 JSP 文件位于**/jsp/EditorPortlet.jsp**
*   使用调度程序时，我使用**/jsp/EditorPortlet.jsp**作为路径
*   **我不会每次都收到这个错误**。如果我重新部署我的 .war，有时它可以解决问题。

相关代码：

```
PortletRequestDispatcher rd = getPortletContext().getRequestDispatcher(
            "/jsp/EditorPortlet.jsp"");
rd.include(request, response); 
```

> **错误 [render_portlet_jsp:154] javax.servlet.ServletException: Le fichier "/jsp/EditorPortlet.jsp" n'a pas été trouvé** 在 org.apache.jasper.servlet.JspServlet.handleMissingResource(JspServlet.java:412) 在 org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:379) 在 org.apache.jasper.servlet.JspServlet.service (JspServlet.java:334) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) 在 org.apache.catalina。 core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) 在 com.liferay.portal.kernel.servlet.filters.invoker.InvokerFilterChain.doFilter(InvokerFilterChain.java:72) 在 com.liferay.portal.kernel.servlet.filters。 com.liferay.portal.kernel.servlet.filters.invoker 上的调用者.InvokerFilterChain.doFilter(InvokerFilterChain.java:113)。InvokerFilter.doFilter(InvokerFilter.java:70) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org .apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684) 在 org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:593) 在 org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher .java:530) 在 com.liferay.portlet.PortletRequestDispatcherImpl.dispatch(PortletRequestDispatcherImpl.java:316) 在 com.liferay.portlet.PortletRequestDispatcherImpl.include(PortletRequestDispatcherImpl.java:134) 在 com.gui.portlet.Portlet.doViewPortlet( Portlet.java：194) 在 com.gui.portlet.Portlet.doView(Portlet.java:148) 在 com.app.management.model.server.portlet.Portlet.doView(Portlet.java:35) 在 javax.portlet.GenericPortlet.doDispatch (GenericPortlet.java:328)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T08:10:09.647

如果您的文件在 中`/WEB-INF/jsp/EditorPortlet.jsp`，您必须发送到该文件，而不是`/jsp/EditorPortlet.jsp`- 您尝试过吗？

根据您转发的上下文，它可能适用`jsp/EditorPortlet.jsp`（请注意缺少的根斜线，只是为了尝试解释为什么它可能更早地起作用）

而且，可能不是这里的情况，但为了完整性，正如我从远古时代记得的那样：

即使在 Windows 上，我也见过 tomcat 尊重文件名的大写。由于我已经有一段时间不再在 Windows 上开发了，所以我不在乎行为是否可配置，但鉴于 Windows 不支持大写，将名称更改为“同名”并不容易" 使用不同的大写字母（当时我必须完全重命名文件，然后将其重命名为正确大写的名称）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:56:58.717

通过查看异常跟踪，我认为您已经创建了一个 portlet，并且在该特定 portlet 的 Portlet.java 类的`doView()`方法中，您将请求转发到`EditorPortlet.jsp`，该请求未创建或丢失。

如果您没有直接转发请求，那么您必须将该部分作为一个放在 portlet.xml 中`init-param (view-template)`

# xmpp - 是否可以使用私钥解密我的 XMPP 服务器流量？

> ID：11036522
> 
> 赞同：0
> 
> 时间：2012-06-14T15:35:00.817
> 
> 标签：xmpp, rsa, ssl, encryption

如有必要，我可以提供更多细节，但我的问题基本上是这样的：

如果我正在运行使用我创建（并拥有）的 RSA pub/priv 密钥组合加密流量的 openfire 服务器，有没有办法（最好在 Java 中）从线路上嗅出数据包，然后使用我的私钥解密它们? 目前我可以使用以下方法加密/解密字符串：

```
public class TLSDecryptTest {

Cipher Ecipher;
Cipher Dcipher;

public TLSDecryptTest(String pubpath, String privpath){
    byte[] publicKeyContentsAsByteArray;
    RSAPublicKey pubKey;
    try {
    this.Ecipher = Cipher.getInstance("RSA");
    String path1 = new String("C:\\Users\\peter.marino\\Desktop\\javapub.key");
    File pubFile = new File(path1);
    publicKeyContentsAsByteArray = new byte[(int)pubFile.length()];

        BufferedInputStream bis = new BufferedInputStream(new FileInputStream(pubFile));
        publicKeyContentsAsByteArray = new byte[(int)pubFile.length()];
        bis.read(publicKeyContentsAsByteArray);
        bis.close();

        CertificateFactory certificateFactory = CertificateFactory.getInstance("X509");
        Certificate certificate = certificateFactory.generateCertificate(new ByteArrayInputStream(publicKeyContentsAsByteArray));
       pubKey = (RSAPublicKey) certificate.getPublicKey();
       this.Ecipher.init(Cipher.ENCRYPT_MODE, pubKey);
    } catch(Exception e) {
        System.out.println("Exception" + e);
    }

    try {
    this.Dcipher = Cipher.getInstance("RSA");
    String path2 = new String("C:\\Users\\peter.marino\\Desktop\\java.key");
    File privFile = new File(path2);
    byte[] privateKeyContentsAsByteArray = new byte[(int)privFile.length()];

        BufferedInputStream bis = new BufferedInputStream(new FileInputStream(privFile));
        privateKeyContentsAsByteArray = new byte[(int)privFile.length()];
        bis.read(privateKeyContentsAsByteArray);
        bis.close();

        KeyFactory keyFactory = KeyFactory.getInstance("RSA");

        KeySpec ks = new PKCS8EncodedKeySpec(privateKeyContentsAsByteArray);
        RSAPrivateKey privKey = (RSAPrivateKey) keyFactory.generatePrivate(ks);
        System.out.println("PRIVATE KEY:::: " + new String(privKey.getEncoded()).equals(new String(privateKeyContentsAsByteArray)));
        this.Dcipher.init(Cipher.DECRYPT_MODE, privKey);
    } catch(Exception e) {
        System.out.println("Exception" + e);
    }

}

 public byte[] en(byte[] decryptedMessage) throws Exception {
     byte[] encryptedMessage = this.Ecipher.doFinal(decryptedMessage);
     //byte[] encryptedMessage = this.Ecipher.doFinal(decryptedMessage);
     return (encryptedMessage);

 }

 public byte[] de(byte[] encryptedMessage) throws Exception {
     byte[] decryptedMessage = this.Dcipher.doFinal(encryptedMessage);
     return (decryptedMessage);

 }

public static void main(String args[]) throws Exception{
    TLSDecryptTest t = new TLSDecryptTest(null,null);
    String s = ("Testing decryption.1Testing decryption.2Testing decryption.3Testing decryption.4");
    System.out.println("S: " + s);
    byte[] todo = s.getBytes();
    byte[] e = t.en(todo);
    String es = new String(e);
    System.out.println("E: " + es);
    byte[] d = t.de(e);
    String ds = new String(d);
    System.out.println("D: " + ds);
} 
```

}

效果很好。但是，如果我从网络上嗅出几个数据包然后尝试解密它，我会得到错误。我什至尝试只解密它的前 256 个字节，因为这是我的 RSA 密钥的限制，但它仍然会引发错误。最值得注意的是，在 doFinal() 行出现了 BadPaddingException。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:51:17.657

如果您正在谈论受 SSL 保护的会话，那么如果您拥有合法服务器的私钥（并且无论如何都可以获得公开的证书），那么中间人攻击是可能的。出于实际目的，您应该能够使用 Wireshark 来监视您的流量。

但是您不能按原样解密流量。部分原因是它没有使用公钥加密进行加密 - 数据使用每个会话生成的对称密钥进行加密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:05:49.870

如果您拥有服务器的私钥，Wireshark 将允许您解密。文档在[这里](http://wiki.wireshark.org/SSL)。

首先，进入 Edit/Preferences/Protocols/SSL，点击 RSA Keys 旁边的 Edit 按钮：

![编辑 RSA 密钥](../Images/a7783ca62c222d3bccd27e8ae31f345e.png)

接下来，单击新建。用描述何时应该使用密钥的信息填写表格。这应该是**服务器**的 IP 地址和端口：

![RSA 密钥信息](../Images/d63683a3843177a0d4addb248619a1a7.png)

您的密钥文件可能需要也可能不需要密码。点击 OK 三次。照常抓拍。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-14T15:37:30.287

No. With public key encryption, you can only ever decrypt with the opposite key. e.g.

```
encrypted with private key => decrypt with public key
encryptd with public key => decrypt with private key 
```

consider the chaos that would happen if

```
encrypted with public key => decrypt with public key 
```

were possible - since the public key is floating around "in the open" for everyone to see, you'd essentially be giftwrapping your data in saran wrap, because everyone would have the key to decrypt it already. This would completely torpedo the entire SSL security model.

# tridion - Tridion 在内容移植后不发布

> ID：11036526
> 
> 赞同：1
> 
> 时间：2012-06-14T15:35:23.410
> 
> 标签：tridion

我在两个 Content Manager 服务器之间完成了一个据称成功的 Content Port。现在，当尝试发布页面时，我在所有页面上都收到以下错误。

```
(5) Invalid procedure call or argument
Unable to get rendered content of Page (tcm:54-18445-64).
Unable to read Page (tcm:54-18445-64).

URLConversion.PostProcessLocationInfo
PageBLST.Read
XMLState.GetXML
Page.GetXML
UtilitiesPublish.RenderPage
Page.Render
Request.Render 
```

即使尝试在内容管理器中打开页面，我仍然收到错误“无效的远程过程调用”

使用 IE 中的直接 TCM 链接，我得到以下内容：

```
<?xml version="1.0"?>
-<tcm:Error Severity="1" Source="Kernel" Category="7" ErrorCode="5" xmlns:tcm="http://www.tridion.com/ContentManager/5.0">-<tcm:Line ErrorCode="5" MessageID="16137" Cause="false">
<![CDATA[Unable to read Page (tcm:54-18445-64).]]>
<tcm:Token>RESID_4553</tcm:Token><tcm:Token>RESID_4442</tcm:Token><tcm:Token>tcm:54-18445-64</tcm:Token></tcm:Line>-<tcm:Line ErrorCode="5" Cause="true">
<![CDATA[Invalid procedure call or argument]]>
</tcm:Line>-<tcm:Details>-<tcm:CallStack><tcm:Location>URLConversion.PostProcessLocationInfo</tcm:Location><tcm:Location>PageBLST.Read</tcm:Location><tcm:Location>XMLState.GetXML</tcm:Location><tcm:Location>Page.GetXML</tcm:Location></tcm:CallStack></tcm:Details></tcm:Error> 
```

更新：

数据库提取如下，用于无法正常打开的页面

```
ID  ITEM_TYPE   ITEM_REFERENCE_ID   VERSION TITLE   SCHEMA_REFERENCE_ID APPROVAL_STATUS_ID  PUBLICATION_ID  CONTENT REVISION    TRUSTEE_ID  MODIFICATION_DATE   USER_COMMENT    SYSTEM_COMMENT  BINARY_ID   BINARY_SIZE FILE_NAME   IS_EXTERNAL_BINARY  PAGE_TEMPLATE_REF_ID    COMPONENT_PROCESS   FILE_EXT    PRIORITY    IS_SIMPLE   NAMESPACE_URI   ROOT_ELEMENT    SUB_TYPE    ALLOWED_ON_PAGE PUBLISH_TO_REPOSITORY   METADATA_SCHEMA_REFERENCE_ID    METADATA_XML    DYNAMIC_TEMPLATE    OUTPUT_FORMAT   DESCRIPTION KEY_VALUE   IS_ABSTRACT IS_ROOT
32638   64  18517   0   Web.sitemap NULL    -1  54  <tcm:ComponentPresentations xmlns:tcm="http://www.tridion.com/ContentManager/5.0"/> 0   14  2012-06-15 15:21:21.927     RESID_16442 NULL    NULL    Web NULL    8303    NULL    NULL    0   0   NULL    NULL    NULL    NULL    NULL    NULL        NULL    NULL        NULL    NULL    NULL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:50:11.027

您可能在某个地方有一个失败的项目，并且 CP 在您的某个模板中的某个地方留下了一个奇怪的指针，而不是一个 URI。这是发生在所有页面上还是仅发生在一些页面上？

您可以尝试使用协议处理程序打开其中一个页面（在 CMS 服务器上的 Internet Explorer 中键入页面的 URI）并查找任何奇怪的引用指针。我不记得确切的格式，但它们通常有几个 C 和 P。如果您找到了一些，或许可以在此处发布 XML，以便我们进一步提供帮助。

通常第二次导入项目可以解决循环引用引起的任何问题。

您说移植成功，但您是否检查了日志文件以查找任何警告？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:45:20.877

您是否使用任何 DWT 扩展方法？您似乎还没有迁移您的 DWT 扩展 dll 新系统。您能否成功预览您的页面？

# c# - DataGridColumn 与动态生成的数据绑定

> ID：11036533
> 
> 赞同：2
> 
> 时间：2012-06-14T15:35:40.520
> 
> 标签：c#, wpf, dynamic, binding, datagrid

我的程序中有大量从 Web 服务生成的数据。我需要在 DataGrid 中显示这些数据，但返回的数据集合都有不同的格式（一个可能是 3 列，接下来是 7 列），因此我无法创建特定对象来保存这些数据。我无法显示此信息。现在我正在尝试使用这种方法。我将数据放入 KeyValuePairs 的二维列表中。键是该数据所属的列，值是该行的输出。这就是我现在正在尝试的。

```
private void SetDataValuesExecute(List<List<KeyValuePair<string,object>>> Data)
    {
        ResultsCollection = Data;
        ValuesDataGrid.Columns.Clear();
        foreach (string colName in Data[0].Select(x => x.Key).ToList())
        {
            DataGridTextColumn tempCol = new DataGridTextColumn();
            tempCol.Header = colName;
            Binding bind = new Binding();
            bind.Source = ResultsCollection.Select(x => x.FirstOrDefault(y => y.Key == colName).Value.ToString()).ToList();
            tempCol.Binding = bind;
            ValuesDataGrid.Columns.Add(tempCol);         
        }
    } 
```

ResultsCollection 是一个非易失性变量，用作我的绑定源。它是构建 DataGrid 所需的所有二维列表数据的副本。

这将查看第一个条目并提取列标题值并基于该值创建新列。绑定语句查看每一行，获取指定列的数据，并尝试将其设置为列的绑定。这使我可以同时拥有列名和该列中所有数据的列表。不幸的是，将数据列表绑定到列最终不会显示任何数据。

所以我的问题是：我需要如何格式化我的数据才能让列绑定实际显示数据？我接近这种情况完全错了吗？任何帮助表示赞赏，因为我很难过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:22:40.060

这是一个完整的工作示例

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        var data = new MyViewModel();

        int columnIndex = 0;

        foreach (var name in data.ColumnNames)
        {
            grid.Columns.Add(
                new DataGridTextColumn
                {
                    Header = name,
                    Binding = new Binding(
                        string.Format("Values[{0}]", columnIndex++))
                });
        }

        DataContext = data;
    }
}

public class MyViewModel
{
    public MyViewModel()
    {
        Items = new List<RowDataItem>
            {
                new RowDataItem(),
                new RowDataItem(),
                new RowDataItem(),
            };

        ColumnNames = new List<string>{ "Col 1", "Col 2", "Col 3"};
    }

    public IList<string> ColumnNames { get; private set; }

    public IList<RowDataItem> Items { get; private set; }
}

public class RowDataItem
{
    public RowDataItem()
    {
        Values = new List<string>{ "One", "Two", "Three"};    
    }

    public IList<string> Values { get; private set; }
} 
```

Xaml

```
<Grid>
    <DataGrid x:Name="grid" ItemsSource="{Binding Items}" 
              AutoGenerateColumns="False"/>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T18:56:22.717

这是一个 GridView，但它可以工作。我认为您需要使用 bind.Path 但 KVP 不确定其余的语法。

[WPF - 使用动态列/行显示结果网格](https://stackoverflow.com/questions/6959600/wpf-display-grid-of-results-with-dynamic-columns-rows/6961874#6961874)

# javascript - 通过 ajax 更改页面时如何运行 Greasemonkey 脚本？

> ID：11036542
> 
> 赞同：2
> 
> 时间：2012-06-14T15:36:14.047
> 
> 标签：javascript, html, ajax, greasemonkey, userscripts

我有那个脚本：

```
// ==UserScript==
// @name     example
// @include  http://xxx*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js
// ==/UserScript==

var findElem = function(elems, text) {
    for (var i = 0; i < elems.length; i++) {
        if (elems[i].textContent == text) {
            return elems[i];
        } else {
            var result = findElem(elems[i].children, text);
            if (result != undefined) {
                return result;
            }
        }
    }
    return;
}

switch (document.getElementById('my_id').value) {
    case "1":
        findElem(document.documentElement.children, "blabla1").click();
        break;
    case "2":
        findElem(document.documentElement.children, "blabla2").click();
        break;
    case "3":
        findElem(document.documentElement.children, "blabla3").click();
        break;
    case "4":
        findElem(document.documentElement.children, "blabla4").click();
        break;
    default:
        break;
} 
```

它工作正常，但它只适用于主页加载。我想在通过 ajax 更改页面时运行它。我怎样才能做到这一点？

也请举例说明你的答案。我是新手。我不知道如何在你的答案中使用东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:39:52.317

由于浏览器的环境是事件驱动的，您必须设置一个计时器，绑定到您要查找的更新周围发生的一些事件。或者，您可以包装更新并在挂钩后调用您的代码的函数。显然，您需要将用户脚本代码包装在某个函数中以重复使用。

这是一个设置计时器的示例[`setInterval`](https://developer.mozilla.org/en/window.setInterval)（脚本顶部仍然相同）：

```
setInterval(function(){
    switch (document.getElementById('my_id').value) {
        case "1":
            findElem(document.documentElement.children, "blabla1").click();
            break;
        case "2":
            findElem(document.documentElement.children, "blabla2").click();
            break;
        case "3":
            findElem(document.documentElement.children, "blabla3").click();
            break;
        case "4":
            findElem(document.documentElement.children, "blabla4").click();
            break;
        default:
            break;
    }
}, 1000) // if AJAX updates happen with some specific interval, set same number here to minimize useless work 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T13:19:51.697

如果您的主机使用 jQuery，那么您可以使用[ajaxSuccess](http://api.jquery.com/ajaxSuccess/)或[ajaxComplete](http://api.jquery.com/ajaxComplete/)：

```
function mainCode(){
    // your script logic here ...
    switch (document.getElementById('my_id').value) {
        // truncated to save space
    }
}

$(document).ready(function(){
    mainCode();
    unsafeWindow.$(document).ajaxSuccess(function(e, xhr, opt) {
        mainCode();
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:43:46.817

每次更改 html 时，您都可以使用[突变事件处理程序来触发您的函数。](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mutationevents)但是，浏览器支持并不是最好的；）

# python - 为特定目录制作消息 i18n 或排除目录

> ID：11036543
> 
> 赞同：1
> 
> 时间：2012-06-14T15:36:19.037
> 
> 标签：python, django, terminal, internationalization

我的网站结构如下所示：

```
project
--apps
----app1
----app2
--docs
--templates
----module1
----module2
----module3 
```

我怎么跑

```
django-admin.py makemessages --locale=en 
```

在所有应用程序和模板目录上，但忽略模块 1 和模块 3？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T06:06:38.530

我编写了一个简短的脚本来遍历我的项目目录中的文件夹，并在文件夹包含语言环境文件夹时创建翻译。如果需要，可以轻松修改以排除应用程序/目录的脚本

我的项目文件夹结构是

```
Project
--App1
----locale
--App2
----locale
--ProjectRoot - settings.py file is in ProjectRoot folder
----locale
etc 
```

此脚本 ( `run_makemessages.py`) 位于`Project`文件夹中

```
import os
project_root = "/path/to/your/Project"
dirs = os.listdir(project_root)
for app in dirs:
    app_path = os.path.join(project_root, app)
    locale_path = os.path.join(app_path, "locale")
    if(os.path.exists(locale_path)): #modify this condition for exclusion of specific folders
        os.chdir(app_path)
        os.system("django-admin.py makemessages -a --no-wrap") 
```

并且被调用`python run_makemessages.py`- 即它被直接调用并且不使用 django-admin 或 manage.py

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:49:18.753

我认为你不能，除非你编写自己的命令，这可能会花费你更多的时间，然后通过访问所需应用程序的文件夹并`../manage.py makemessages -l XX`从那里运行来单独执行它们

# symfony - 迁移后 symfony2 错误 500

> ID：11036547
> 
> 赞同：0
> 
> 时间：2012-06-14T15:36:30.727
> 
> 标签：symfony

将我的网络迁移到在线服务器后，我几乎在每条路线上都收到 500 错误。我在 xampp 下开发我的网站没有问题（网站在 dev 和 prod 上工作）

我将该站点放在指向我项目的 web 文件夹的子域 (http://escritorio.gruposcout45.org.uy) 下。

这是我的错误日志：

```
[2012-06-14 10:24:26] security.DEBUG: Read SecurityContext from the session [] []
[2012-06-14 10:24:26] security.DEBUG: Reloading user from user provider. [] []
[2012-06-14 10:24:26] security.DEBUG: Username "admin" was reloaded from user provider. [] []
[2012-06-14 10:24:26] request.INFO: Matched route "socio" (parameters: "_controller": "Caro\SociosBundle\Controller\SocioController::indexAction", "_route": "socio") [] []
[2012-06-14 10:24:26] request.CRITICAL: Twig_Error_Syntax: The function "knp_menu_render" does not exist in "::base.html.twig" (uncaught exception) at /home/neuronas/public_html/gruposcout45.org.uy/escritorio/vendor/twig/lib/Twig/Node/Expression/Function.php line 28 [] []
[2012-06-14 10:24:26] security.DEBUG: Write SecurityContext in the session [] [] 
```

还有我的自动加载器：

```
$loader->registerNamespaces(array(
   'Symfony'          => array(__DIR__.'/../vendor/symfony/src', __DIR__.'/../vendor/bundles'),
    'Sensio'           => __DIR__.'/../vendor/bundles',
    'JMS'              => __DIR__.'/../vendor/bundles',
    'Doctrine\\Common' => __DIR__.'/../vendor/doctrine-common/lib',
    'Doctrine\\DBAL'   => __DIR__.'/../vendor/doctrine-dbal/lib',
    'Doctrine'         => __DIR__.'/../vendor/doctrine/lib',
    'Monolog'          => __DIR__.'/../vendor/monolog/src',
    'Assetic'          => __DIR__.'/../vendor/assetic/src',
    'Metadata'         => __DIR__.'/../vendor/metadata/src',
    'Knp\\Component'   => __DIR__.'/../vendor/knp-components/src',
    'Knp\\Bundle'      => __DIR__.'/../vendor/bundles',
    'Knp\Menu'   => __DIR__.'/../vendor/KnpMenu/src',
)); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:08:33.773

我没有把它放在我的 AppKernel 中：

```
new Knp\Bundle\MenuBundle\KnpMenuBundle(),
new Knp\Bundle\PaginatorBundle\KnpPaginatorBundle(), 
```

一旦我添加了这些行并清除了缓存，一切正常。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T11:37:51.300

您是否正确安装了供应商？Knp\Menu twig 函数有问题。

# java - Commons Lang HashCodeBuilder 与 Eclipse hashCode() 生成

> ID：11036548
> 
> 赞同：1
> 
> 时间：2012-06-14T15:36:31.207
> 
> 标签：java, eclipse, equals, apache-commons, hashcode

我见过 Apache Commons Lang 的 HashCodeBuilder 和 Eclipse hashCode() 生成。不得不说 Eclipse 的 hashCode() 非常丑陋，但是在性能方面使用 HashCodeBuilder 会更好吗（因为构建器需要额外的对象创建）？

我还想知道您对 equals() 一代和 Commons Lang 的 EqualsBuilder 的看法。

如果您有更好的解决方案，请也发布它们:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:39:22.890

这`HashCodeBuilder`比编写自己的哈希函数要慢得多。它使用反射来迭代每个字段。如果您经常调用此方法，您可能会看到性能下降，这对于您的情况可能是可容忍的，也可能是不可容忍的。

eclipse 生成的`hashCode`函数使用素数来帮助创建更好的哈希函数。[为什么在 hashCode 中使用素数？](https://stackoverflow.com/questions/3613102/why-use-a-prime-number-in-hashcode)有一些关于为什么会这样的细节

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:41:29.860

HashCodeBuilder 和 EqualsBuilder 比默认方法更好，但是如果你关心性能，最好自己编写 hashcode 和 equals 方法。这是因为它们使用反射方法。

规则是

相等的对象应该产生相同的哈希码，相等的哈希码并不意味着对象相等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T14:03:13.857

您必须在这里在性能和可维护性之间做出选择。commons 版本会适应类的变化，但速度较慢。Eclipse生成的版本很快，但是添加新字段后就不会更新了，维护起来比较困难。

# http - HTML href 中没有“http:”的绝对（完整）URL

> ID：11036551
> 
> 赞同：19
> 
> 时间：2012-06-14T15:36:44.810
> 
> 标签：http, url, href, relative-path, absolute-path

我最近经常看到这个，我找不到任何关于它的信息。

它有名字吗？
哪些浏览器支持这个？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-14T15:43:06.100

它与绝对 URL 相同，只是架构将用于基本 URL。因此，如果您说`//mysite.com/images/img.png`在 https 页面上，图像将被加载，`https`并且在“普通”http 页面上，它将使用`http`架构（以及分别使用不同的默认端口）加载。

当您通过安全页面加载不安全的内容（并且可以使用 http 和 https 协议加载页面）时，这种方法可以避免来自浏览器的安全警告。

# macos - 如何通过命令行在远程 Mac OSX 机器上安装 Mono Develop

> ID：11036552
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:36:45.547
> 
> 标签：macos, command-line, ssh, mono, monodevelop

我可以通过 SSH 访问我喜欢称之为开发机器的机器。我想做的是在那台机器上安装 Mono 开发，但由于我没有进入机器的 Gui 界面，我不知道该怎么做。将不胜感激有关如何实现这一点的任何信息。提前致谢。

对此进行了更改，以便我可以先获取 Mac 的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:39:21.657

你不能在这方面寻求一般的 Linux/Mac 帮助。在 Linux 中使用你的包管理器

对于 ubuntu：

sudo apt-get install monodevelop

Suse/RH/Fedora/Centos

须藤百胜安装monodevelop

告诉我们您的实际设置是什么，您可以获得更好的答案

# ruby-on-rails-3 - 序列化activerecord后如何访问列值

> ID：11036563
> 
> 赞同：12
> 
> 时间：2012-06-14T15:37:19.987
> 
> 标签：ruby-on-rails-3, activerecord

我有一个像这样的简单模型：

```
class User < ActiveRecord::Base
  serialize :preferences
end 
```

我想从 mysql 访问原始值，而不是序列化之前的值。是否可以？

我知道我可以使用

```
ActiveRecord::Base.connection.execute("select * from users") 
```

但我想从`User`模型中访问。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-14T16:46:24.433

**更新**

好的，这就是您要查找的内容：

```
User.find(params[:id]).attributes_before_type_cast["preferences"][:value] 
```

这将以序列化形式返回字符串。

这是我能找到的最接近的方法，如果您已经从数据库中提取了对象，它将无法工作。

很抱歉误读了您的问题。您也可以从 User 模型中使用它。

留下旧答案，以防万一其他方式对某人有帮助。

**旧答案**

只是为了确保我理解这个问题，您需要表格中的原始数据。rails 的数据序列化并放入数据库。

前任。您输入`['site_id','last_update','last_restart']`并获得`"---\n- site_id\n- last_update\n- last_restart\n"`，然后将其放入数据库并保存。你想检索这个：`"---\n- site_id\n- last_update\n- last_restart\n"`从数据库中。

好的，它从数据库中得到了一些狂热，但你可以这样做。

在一个项目中，我有一个序列化的数组调用`devise_table_preferences`，它列出了以特定顺序在表中显示的首选项，如下所示：

```
user.devise_table_preferences = ['site_id','last_update','last_restart'] 
```

它的序列化视图是这样的：

```
"---\n- site_id\n- last_update\n- last_restart\n" 
```

使用上面的方法，我进行了如下查询：

```
preference = ActiveRecord::Base.connection.execute("SELECT devise_table_preferences FROM users WHERE id = #{@user.id}") 
```

它在控制台中返回一个对象，如下所示：

```
preference = #<Mysql2::Result:0x007fe4cdf34850> 
```

跑步：

```
preference.first[0] 
```

给了我这个：

```
"---\n- site_id\n- last_restart\n" 
```

我知道这是一项很大的工作，但它肯定会以序列化的方式为您提供数据。希望它可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-12T09:01:29.853

attributes_before_type_cast 对我不起作用。

```
User.first.instance_variable_get(:@attributes)['preferences'].serialized_value 
```

即使加载了对象，这也有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-08T14:49:13.433

我想这些天你想说的是：

> User.find(params[:id]).typecasted_attribute_value('preferences')

# java - Java UDP socket client not blocking

> ID：11036566
> 
> 赞同：0
> 
> 时间：2012-06-14T15:37:28.990
> 
> 标签：java, sockets, blocking, broadcast

I'm trying to code a UDP client to receive packets from a server that is broadcasting on the local network. The problem is the `receive` method isn't blocking and waiting for a packet to arrive. Instead, it's receiving null or empty packets. I've tried to use `.setSoTimeout(0)`, which supposedly will tell the receive to block until it receives a packet, but it doesn't.

Does anyone know how to fix this?

Here's the code:

```
 while (search == true) {

                InetAddress addr = InetAddress.getByName("0.0.0.0");
                DatagramSocket sock = new DatagramSocket(1355);
                sock.setSoTimeout(0);
                byte[] recebe = new byte[1024];
                sock.setBroadcast(true);

                System.out.println("entrou1");
                DatagramPacket packet = new DatagramPacket(recebe, recebe.length);

                System.out.println("entrou2");
                sock.receive(packet);
                String info = new String(packet.getData());
                System.out.println("tamanho: " + info.length());

                if (info.trim().equals("") == false && info != null) {
                    System.out.println("entrou aqui");
                    System.out.println("info recebida:" + info + ":fsadfsfs");
                    String servs[] = info.split("\n");
                    list1.clear();
                    servidores.clear();

                    for (int i = 0; i < servs.length; i++) {
                        System.out.println("vec: " + servs[i]);
                        if (servs[i].trim().equals("")) {
                            System.out.println("break;");
                            break;
                        } else {
                            String aux = servs[i].substring(0, servs[i].lastIndexOf("->"));
                            System.out.println("aux: " + aux);
                            list1.add(aux);
                            servidores.add(servs[i]);
                        }
                    }
                }

                System.out.println("info:\n" + info);

                sock.close();

                synchronized (obj) {
                    try {
                        obj.wait();
                    } catch (InterruptedException ex) {
                        Logger.getLogger(AcederPartilhaGUI.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            } 
```

# sql-server - Get all items in folders and subfolders in SQL Server

> ID：11036572
> 
> 赞同：1
> 
> 时间：2012-06-14T15:37:41.970
> 
> 标签：sql-server, database

I have a table set up to hold folders. Each folder has an `ID`, a `ParentID` and a couple other columns.

```
 ID | ParentID | Name
   1    Null      Base Folder
   2    1         Folder 1
   3    2         Folder 2

   etc 
```

I'm working on a delete function but I'm running into issues getting everything nested inside a folder. Things can be nested ad infinitum.

So if I run my query on `Base Folder` I'd want to delete `Base Folder`, `Folder 1`, and `Folder 2`

Any ideas on how to go about doing this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:06:32.337

Take a look at `ON DELETE CASCADE` :

[http://msdn.microsoft.com/en-us/library/ms186973%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms186973%28v=sql.105%29.aspx)

Just make sure you read this carefully and are sure this is the behavior you want.

# java - 使用 RichFaces 选项卡面板提交表单时未更新数据模型

> ID：11036579
> 
> 赞同：0
> 
> 时间：2012-06-14T15:38:03.363
> 
> 标签：java, jsf, richfaces

我的页面中有以下布局（简化）

```
<h:form>
    <h:commandButton action="#{bean.save} value="Save"/>

    <rich:tabPanel switchType="ajax">
        <rich:tab name="one" switchType="client">

        </rich:tab>

        <rich:tab name="two" switchType="ajax">

        </rich:tab>

        <rich:tab name="three" switchType="client">

        </rich:tab>

    </rich:tabPanel>
</h:form> 
```

选项卡“一”和“三”有 switchType="client"，它们上有一些输入，绑定到 bean 属性。当按下“保存”时，我希望 bean 属性将从两个选项卡中的输入更新。但是，仅从当前选项卡上的输入更新属性。尽管提交了整个表单（我已在 HTTP 观察程序中检查过），但来自另一个选项卡的值会丢失。因此，用户必须在一个选项卡中输入数据，按“保存”，然后在另一个选项卡上更新值并按“保存”以保存所做的所有更改。如何一次从所有选项卡中传播值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T18:15:12.350

你可以用 javascript 很容易地做到这一点。您需要做的所有事情（一旦设置了选项卡）就是添加逻辑以显示和隐藏不同的选项卡式组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:31:22.120

首先，将 更改为`<h:commandButton />`，`<a4j:commandButton />`以便您的提交将通过 ajax 请求向服务器进行。此外，您可以在操作后重新呈现页面内容。

```
<h:form>
    <!-- RichFaces 3.3 -->
    <a4j:commandButton value="Save"
        action="#{bean.save}"
        reRender="tbpMyTabs" />
    <!-- RichFaces 4\. -->
    <a4j:commandButton value="Save"
        action="#{bean.save}"
        render=":tbpMyTabs" />

    <rich:tabPanel id="tbpMyTabs" switchType="ajax">
        <rich:tab name="one" switchType="client">
        </rich:tab>
        <rich:tab name="two" switchType="ajax">
        </rich:tab>
        <rich:tab name="three" switchType="client">
        </rich:tab>
    </rich:tabPanel>
</h:form> 
```

要发出成功的 action ajax 请求，请将`Save`方法更改为返回 void，这样 JSF 就不会遵循导航规则。如果您使用 JSF 2，您的 bean 应该有视图范围，否则它应该有请求范围和`KeepAlive`注释。

RichFaces 3.3 Bean 实现

```
@KeepAlive
public class Bean {
    public Bean() {
    }
    public void save() {
    }
} 
```

JSF 2 / RichFaces 4.x Bean 实现

```
@ManagedBean
@ViewScoped
public class Bean {
    public Bean() {
    }
    public void save() {
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T11:48:12.193

已找到解决方案：我已将 tabpanel 的 switchType 从“ajax”更改为“client”。谢谢大家的建议！

# java - 在没有html firebug扩展的javascript中调用java方法

> ID：11036581
> 
> 赞同：0
> 
> 时间：2012-06-14T15:38:08.443
> 
> 标签：java, javascript, applet, firebug

我正在尝试为 firebug 开发一个扩展。我想在这个扩展中调用一个 java 方法，但是里面没有 html，所以我不能使用 applet-html 解决方案。

这是我的java小程序：

```
import java.applet.Applet;
import javax.swing.JOptionPane;

public class MyApplet extends Applet {

    public void init() {
        super.init();
        System.out.println("init something");
    }

    public String jsCall(String hello) {
        System.out.println("this method is called by a js function and say :"
                + hello);
        Thread t = new Thread(new Runnable(){
            public void run(){
                JOptionPane jop1 = new JOptionPane();
                jop1.showMessageDialog(null, "Message informatif", "Information", JOptionPane.INFORMATION_MESSAGE);     
            }
        });
        t.start();

        return "lala";
    }

} 
```

我试试这个：

```
var applet = document.createElement("applet");
applet.setAttribute("code","file:///home/dacostam/z_test/firebug-extension-examples-0bdcf15/helloamd@janodvarko.cz/chrome/content/MyApplet.class");
applet.setAttribute("id","javaToJavascriptApplet");
applet.setAttribute("mayscript","true");
applet.jsCall("HelloWorld"); //jsCall not a function 
```

还有这个：

```
var dom = document.implementation.createDocument('http://www.w3.org/1999/xhtml', 'html', null);
dom.appendChild(applet);
dom.javaToJavascriptApplet.jsCall("HelloWorld"); //jsCall not a function 
```

该文档与往常不同，其中没有正文或 html。

有没有其他方法可以在 javascript 中调用 java 而不是 applet-html 解决方案？或者有没有办法用这种方法来做呢？

如果您需要更多信息，我在这里。

谢谢。

编辑：

向您解释程序的作用会很长，请记住它不可避免地在 java 中，我只需要调用一个带有参数字符串并返回字符串或最终为 void 的方法。

编辑2：

对不起，我没有想到，java需要在客户端运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:15:19.677

如果您的要求是从 JavaScript 调用 Java 应用程序，则需要明确 Java 应用程序需要在哪里运行。

如果 Java 需要在客户端（与您的 Firebug 相同的机器）上运行，看起来您要么被小程序卡住，要么您需要在 Java 中构建一个小型 Web 服务，以便您可以通过 localhost 上的 Web API 与其通信.

如果您的 Java 可以位于某处的服务器上，您可以通过 Web API 与您的 Java 应用程序通信（类似于上面的第二个选项）。

# jquery - 加载外部 html 后返回

> ID：11036584
> 
> 赞同：2
> 
> 时间：2012-06-14T15:38:12.453
> 
> 标签：jquery, upload, back

一直在为此绞尽脑汁（我是 jQuery 等新手）。

我已经设法在单击时将外部 html 文件加载到我的页面中，但无法弄清楚如何返回到该 div 中以前的内容。

我的代码：

```
$(document).ready(function(){
   $('.project').click(function(e){
      var link = $(this).attr('rel');
      event.preventDefault();
      $('#main').empty();
      $('#main').load(link);
   });
}); 
```

任何帮助将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:40:36.803

您可以克隆 div 并将其存储在变量中：

```
 var whatWas = $('#main').clone(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:44:58.330

`.load`将在加载新内容之前清空 div。但是，您可以尝试在之前克隆 div`.load`并根据需要使用克隆。

注意：`$('#main').empty();`then`$('#main').load(link);`是多余的，因为`.load`会清空 div。

尝试如下，

```
$(document).ready(function(){
   var $mainClone = null;
   $('.project').click(function(e){
      var link = $(this).attr('rel');
      event.preventDefault();
      $mainClone = $('#main').clone().prop('id', 'main-clone'); //clone and change ID
      $('#main').load(link);
   });      
}); 
```

稍后您可以`#main`使用以下内容替换内容，

```
$('#main').html($mainClone.html()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:44:03.760

在加载新的 HTML 之前，您需要存储 div 中的内容。您很可能需要将其存储在全局变量中。

```
<script type="text/javascript">
    var whatWas;

    $(document).ready(function(){
       $('.project').click(function(e){
          global whatWas;
          var link = $(this).attr('rel');
          whatWas = $('#main').clone();
          event.preventDefault();
          $('#main').empty();
          $('#main').load(link);
       });
    });

    ...
    //here you need to catch the event that you want to use to load the original content back into the div
</script> 
```

当您想返回时，可以将 div 替换为原始 HTML，如下所示：

```
$('#main').html(whatWas); 
```

# c++ - 试图让 XML 阅读器在 C++ 中工作

> ID：11036586
> 
> 赞同：0
> 
> 时间：2012-06-14T15:38:22.630
> 
> 标签：c++, xml, msxml

我正在尝试从网站读取一些 XML 代码，但在找出错误所在时遇到了一些麻烦。使用[这篇](https://stackoverflow.com/questions/5415788/read-write-xml-file-in-c)非常有用的帖子中的代码，我正在尝试读取已保存到桌面的文件（“H:\MyName\Desktop\secLendingXML.cfm.xml”）。代码如下：

```
#include "stdafx.h"
#include <stdio.h>
#include <tchar.h>
#include <windows.h>
#import <msxml6.dll> rename_namespace(_T("MSXML"))

int main(/*int argc, char* argv[]*/)
{
HRESULT hr = CoInitialize(NULL); 
if (SUCCEEDED(hr))
{
    try
    {
        MSXML::IXMLDOMDocument2Ptr xmlDoc;
        hr = xmlDoc.CreateInstance(__uuidof(MSXML::DOMDocument60), NULL, CLSCTX_INPROC_SERVER);
        // TODO: if (FAILED(hr))...
        if (xmlDoc->load(_T("H:\MyName\Desktop\secLendingXML.cfm.xml")) != VARIANT_TRUE)
        {
            printf("Unable to load input.xml\n");
        }
        else
        {
            printf("XML was successfully loaded\n");

            xmlDoc->setProperty("SelectionLanguage", "XPath");
            MSXML::IXMLDOMNodeListPtr wheels = xmlDoc->selectNodes("/Car/Wheels/*");
            printf("Car has %u wheels\n", wheels->Getlength());

            MSXML::IXMLDOMNodePtr node;
            node = xmlDoc->createNode(MSXML::NODE_ELEMENT, _T("Engine"), _T(""));
            node->text = _T("Engine 1.0");
            xmlDoc->documentElement->appendChild(node);
            hr = xmlDoc->save(_T("output.xml"));
            if (SUCCEEDED(hr))
                printf("output.xml successfully saved\n");
        }
    }
    catch (_com_error &e)
    {
        printf("ERROR: %ws\n", e.ErrorMessage());
    }
    CoUninitialize();
}
system("PAUSE");
return 0; 
```

}

消息“无法加载 input.xml”总是显示，所以我知道我没有错误，但代码无法加载我的 XML 文件。

我是否需要将 XML 文件保存在其他位置？“.xml”之前的“.cfm”是否与阅读过程有关？

为了说明我的预期方向，我希望能够从[纽约联储网站](http://www.newyorkfed.org/markets/seclend/sec_lendop.cfm)加载 XML 文件并将其读入某种数据文件中，我可以在其中自动执行数据检索过程。这样，每当网站更新时，我都会自动收到通知，这将反映在我将保存在计算机某处的数据文件的更改中。如果有人也想帮助我如何处理这部分 - 轮询间隔，跟踪网站更改等 - 那也将不胜感激。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:42:57.410

您是否需要转义路径字符串中的反斜杠？例如

```
xmlDoc->load(_T("H:\\MyName\\Desktop\\secLendingXML.cfm.xml") 
```

# c++ - C++ 字符串替换不能按预期工作

> ID：11036598
> 
> 赞同：3
> 
> 时间：2012-06-14T15:38:55.040
> 
> 标签：c++, string, replace

关于 C++ 替换函数的小问题。我正在逐行解析每一行文本输入。文本文件示例：

```
SF27_34KJ
EEE_30888
KPD324222
4230_333 
```

我需要删除每一行上的所有下划线并用逗号替换它。当我尝试这样的事情时：

> mystring.replace(mystring.begin(), mystring.end(), '_', ',');

在每一行 - 而不是“ **SF27,34KJ** ”，我得到 95x“ **，** ”char。有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:44:42.130

使用[`std::replace()`](http://en.cppreference.com/w/cpp/algorithm/replace)：

```
std::replace(mystring.begin(), mystring.end(), '_', ','); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:48:01.807

`basic_string::replace`不做你认为它做的事。

`basic_string::replace(it_a, it_e, ... )`用您指定的任何字符替换*所有*字符，`it_a`而`it_e`不仅仅是那些匹配的字符。

有一百种方法可以做你想做的事，但最简单的可能是使用`std::replace`from `<algorithm>`，它*可以*做你想做的事：

```
std::replace(mystring.begin(), mystring.end(), '_', ','); 
```

另一种方法是与[仿函数](http://en.wikipedia.org/wiki/Function_object)`std::transform`一起使用。这有一个优势，因为您可以在一次通过中执行多个替换。`std::replace`

这是一个可以做到这一点的 C++03 仿函数：

```
struct ReplChars
{
    char operator()(char c) const
    {
        if( c == '_' )
            return ',';
        if( c == '*' )
            return '.';
        return c;
    }
}; 
```

...以及它的用途：

```
std::transform(mystring.begin(), mystring.end(), mystring.begin(), ReplChars()); 
```

在 C++11 中，这可以通过使用 lambda 而不是仿函数来减少：

```
std::transform(mystring.begin(), mystring.end(), mystring.begin(), [](char c)->char
{
    if( c == '_' )
        return ',';
    if( c == '*' )
        return '.';
    return c;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:43:32.060

看[这里](http://www.cplusplus.com/reference/string/string/replace/)，没有替换方法需要两个迭代器，然后是两个字符。考虑到 '_' 的 ascii 值为 95，我猜你正在打这个：

```
string& replace ( iterator i1, iterator i2, size_t n2, char c ); 
```

因此，不是用 ',' 替换所有 '_' 的实例，而是将字符串 from `begin()`to替换为`end()`95 ','s。

请参阅[此处](https://stackoverflow.com/questions/2896600/how-to-replace-all-occurrences-of-a-character-in-string)了解如何替换字符串中的出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T15:44:16.023

这并不是 replace 的工作原理。查看 api [http://www.cplusplus.com/reference/string/string/replace/](http://www.cplusplus.com/reference/string/string/replace/)，您为开始和结束提供迭代器以及要复制的字符串，但另一个参数是该部分的最大长度.

要获得您想要的功能，请尝试查找子字符串并替换它（两次调用）。这里有详细说明：[Replace part of a string with another string](https://stackoverflow.com/questions/3418231/c-replace-part-of-a-string-with-another-string)。

# python - 蟒蛇，寻找，告诉，阅读。从巨型 csv 文件中读取行

> ID：11036603
> 
> 赞同：1
> 
> 时间：2012-06-14T15:39:05.447
> 
> 标签：python, csv, seek, tell

我有一个保存为 csv 文件的特征向量的巨大文件（1.2GB）。为了通过这些行，我创建了一个 python 类，它一次将一批行从巨型文件加载到内存中。

为了让这个类知道在文件中读取的确切位置以获得一批batch_size完整的行（比如说batch_size=10,000），在第一次使用一个巨大的文件时，这个类会遍历整个文件一次，并注册每行的偏移量，并将这些偏移量保存到帮助文件中，以便稍后它可以“file.seek(starting_offset); batch = file.read(num_bytes)”读取下一批行。

首先，我以这种方式实现了线偏移的注册：

```
 offset = 0;
    line_offsets = [];
    for line in self.fid:
        line_offsets.append(offset);
        offset += len(line); 
```

它与 Giant_file1 一起工作得很好。

但后来我处理了这些特征并创建了giant_file2（具有标准化特征），在我制作的这个类的帮助下。接下来，当我想从 Giant_file2 中读取成批的行时，它失败了，因为它将读取的批处理字符串不在正确的位置（例如，读取类似“-00\n15.467e-04,... " 而不是 "15.467e-04,...\n")。

所以我尝试将线偏移计算部分更改为：

```
 offset = 0;
    line_offsets = [];
    while True:
        line = self.fid.readline();

        if (len(line) <= 0):
            break;

        line_offsets.append(offset);
        offset = self.fid.tell(); 
```

主要变化是我注册的偏移量取自 fid.tell() 的结果，而不是行的累积长度。

这个版本在 Giant_file2 上运行良好，但在 Giant_file1 上失败了。

深入研究后，我发现函数 seek()、tell() 和 read() 彼此不一致。例如：

```
fid = file('giant_file1.csv');
fid.readline();
>>>'0.089,169.039,10.375,-30.838,59.171,-50.867,13.968,1.599,-26.718,0.507,-8.967,-8.736,\n'
fid.tell();
>>>67L
fid.readline();
>>>'15.375,91.43,15.754,-147.691,54.234,54.478,-0.435,32.364,4.64,29.479,4.835,-16.697,\n'
fid.seek(67);
fid.tell();
>>>67L
fid.readline();
>>>'507,-8.967,-8.736,\n' 
```

这里有一些矛盾：当我定位（根据 fid.tell()）在字节 67 时，一旦读取的行是一回事，而在第二次（再次当 fid.tell() 报告时，我定位在字节67) 读取的行不同。

我不能相信 tell() 和 seek() 将我放在所需位置以从所需行的开头读取。另一方面，当我使用（使用 Giant_file1）字符串长度作为 seek() 的参考时，我得到了正确的位置：

```
fid.seek(0);
line = fid.readline();
fid.tell();
>>>87L
len(line);
>>>86
fid.seek(86);
fid.readline();
>>>'15.375,91.43,15.754,-147.691,54.234,54.478,-0.435,32.364,4.64,29.479,4.835,-16.697,\n' 
```

那么发生了什么？

我能想到的giant_file1 和giant_file2 之间的唯一区别是giant_file1 中的值是用小数点写的（例如-0.435），而在giant_file2 中它们都是科学格式（例如-4.350e-01）。我不认为它们中的任何一个都是用 unicode 编码的（我认为是这样，因为我用简单的 file.read() 读取的字符串似乎是可读的。我怎样才能确定？）。

非常感谢您的帮助，包括解释、原因的想法以及可能的解决方案（或解决方法）。

谢谢你，约纳坦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:19:17.253

我认为你有一个换行问题。检查giant_file1.csv 是以\n 或\r\n 结尾的行如果您以文本模式打开文件，文件将返回以\n 结尾的行，并且丢弃多余的\r。因此，当您查看返回的行的长度时，它将与实际文件位置相差 1（这不仅消耗了 \n，而且还消耗了 \r\n）。当然，这些错误会随着您阅读更多行而累积。

解决方案是以二进制模式打开文件，而不是。在这种模式下，没有 \r\n -> \n 减少，因此您的行长计数将与您的文件 tell( ) 查询保持一致。

我希望这可以为您解决 - 因为它很容易解决。:) 祝你的项目好运，编码愉快！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:14:22.623

过去我不得不做类似的事情，并在标准库中遇到了一个叫做 linecache 的东西。你可能也想调查一下。

[http://docs.python.org/library/linecache.html](http://docs.python.org/library/linecache.html)

# activemq - ActiveMQ 5.x - XInclude 似乎在配置文件中不起作用

> ID：11036605
> 
> 赞同：0
> 
> 时间：2012-06-14T15:39:08.380
> 
> 标签：activemq

我正在使用 ActiveMQ 5.x，我想将 activemq.xml 代理中的一些内容提取到单独的文件中。注意：我不能使用`<import>`它不会工作。

我想在 activemq.xml 配置文件中使用 XInclude。

但是，当我尝试这样做时，出现错误“找不到元素 xi:include”

这是我正在使用的 activemq.xml 文件。你能帮我弄清楚如何包含外部文件吗？

**活动MQ.xml**

```
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<!-- START SNIPPET: example -->
<beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:amq="http://activemq.apache.org/schema/core"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xi="http://www.w3.org/2003/XInclude"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd">

    <!-- Allows us to use system properties as variables in this configuration file -->
    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <value>file:${activemq.base}/conf/credentials.properties</value>
        </property>      
    </bean>

    <!-- 
        The <broker> element is used to configure the ActiveMQ broker. 
    -->
    <broker xmlns="http://activemq.apache.org/schema/core" brokerName="localhost" dataDirectory="${activemq.base}/data" destroyApplicationContextOnStop="true">

        <!--
            For better performances use VM cursor and small memory limit.
            For more information, see:

            http://activemq.apache.org/message-cursors.html

            Also, if your producer is "hanging", it's probably due to producer flow control.
            For more information, see:
            http://activemq.apache.org/producer-flow-control.html
        -->

        <destinationPolicy>
            <policyMap>
              <policyEntries>
                <policyEntry topic=">" producerFlowControl="true" memoryLimit="1mb">
                  <pendingSubscriberPolicy>
                    <vmCursor />
                  </pendingSubscriberPolicy>
                </policyEntry>
                <policyEntry queue=">" producerFlowControl="true" memoryLimit="1mb">
                  <!-- Use VM cursor for better latency
                       For more information, see:

                       http://activemq.apache.org/message-cursors.html

                  <pendingQueuePolicy>
                    <vmQueueCursor/>
                  </pendingQueuePolicy>
                  -->
                </policyEntry>
              </policyEntries>
            </policyMap>
        </destinationPolicy> 

        <!-- 
            The managementContext is used to configure how ActiveMQ is exposed in 
            JMX. By default, ActiveMQ uses the MBean server that is started by 
            the JVM. For more information, see: 

            http://activemq.apache.org/jmx.html 
        -->
        <managementContext>
            <managementContext createConnector="false"/>
        </managementContext>

        <!-- 
            Configure message persistence for the broker. The default persistence
            mechanism is the KahaDB store (identified by the kahaDB tag). 
            For more information, see: 

            http://activemq.apache.org/persistence.html 
        -->
        <persistenceAdapter>
            <kahaDB directory="${activemq.base}/data/kahadb"/>
        </persistenceAdapter>

          <!--
            The systemUsage controls the maximum amount of space the broker will 
            use before slowing down producers. For more information, see:

            http://activemq.apache.org/producer-flow-control.html

        <systemUsage>
            <systemUsage>
                <memoryUsage>
                    <memoryUsage limit="20 mb"/>
                </memoryUsage>
                <storeUsage>
                    <storeUsage limit="1 gb"/>
                </storeUsage>
                <tempUsage>
                    <tempUsage limit="100 mb"/>
                </tempUsage>
            </systemUsage>
        </systemUsage>
        -->

        <!-- 
            The transport connectors expose ActiveMQ over a given protocol to
            clients and other brokers. For more information, see: 

            http://activemq.apache.org/configuring-transports.html 
        -->
        <transportConnectors>
            <transportConnector name="openwire" uri="tcp://0.0.0.0:61616"/>
        </transportConnectors>

        <xi:include href="transport-connectors.xml" parse="xml"/>
    </broker>

    <!-- 
        Enable web consoles, REST and Ajax APIs and demos

        Take a look at ${ACTIVEMQ_HOME}/conf/jetty.xml for more details 
    -->
    <import resource="jetty.xml"/>

</beans>
<!-- END SNIPPET: example --> 
```

**传输连接器.xml**

```
<transportConnectors>
            <transportConnector name="openwire" uri="tcp://0.0.0.0:61616"/>
</transportConnectors> 
```

这不起作用。这是我得到的错误。

> 原因：org.xml.sax.SAXParseException：cvc-complex-type.2.4.c：匹配的通配符是严格的，但找不到元素“xi:include”的声明。

我也尝试使用实体定义，只是不知道如何让它工作。

请建议对 activemq.xml 进行更改以使其正常工作。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T13:40:58.710

答案是——activemq 中不支持这个。

经过调查，我看到 Activemq 在 Spring 3.0 中不支持/打开 XInclude，它需要扩展 Spring XML 处理程序类来改变 DocBuilder 以允许 XIncludes。

我创建了一个新功能请求以建议添加此功能[https://issues.apache.org/jira/browse/AMQ-3886](https://issues.apache.org/jira/browse/AMQ-3886)

真可惜。

# android - 将 C2DM 与 OAuth2 一起使用 - 授权 API 时出错

> ID：11036606
> 
> 赞同：1
> 
> 时间：2012-06-14T15:39:13.047
> 
> 标签：android, oauth-2.0, android-c2dm

我正在尝试将 C2DM 与 OAuth2 一起使用。我已经关注了这篇文章：[http](http://www.roosmaa.net/getting-started-with-android-c2dm) ://www.roosmaa.net/getting-started-with-android-c2dm和另一个非常相似的，但每次我尝试授权范围“https://android .apis.google.com/c2dm”（在[https://code.google.com/oauthplayground/](https://code.google.com/oauthplayground/)中）我总是收到以下错误：

```
Error: redirect_uri_mismatch
  The redirect URI in the request: https://code.google.com/oauthplayground did not match a   registered redirect URI

  Request Detail:

  Request Details
  scope=https://code.google.com/oauthplayground
  response_type=code
  redirect_uri=https://code.google.com/oauthplayground
  access_type=offline
  approval_prompt=force
  client_id=xxxxxxxxxx.apps.googleusercontent.com 
```

有人可以给出一些提示如何解决这个问题吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T19:16:43.557

您必须授权**https://android.apis.google.com/c2dm**

# javascript - AJAX .responseText 想要分配给全局变量

> ID：11036609
> 
> 赞同：0
> 
> 时间：2012-06-14T15:39:25.900
> 
> 标签：javascript, jquery, ajax

对于 CORS AJAX 请求，据我所知，最好的和跨浏览器支持的示例是以下示例...

[http://saltybeagle.com/2009/09/cross-origin-resource-sharing-demo/](http://saltybeagle.com/2009/09/cross-origin-resource-sharing-demo/)

上述工作正常，但回调只返回局部变量而不是全局变量。有人可以告诉我如何从 AJAX 回调中返回全局变量。

在 jQuery 代码中，如果我想返回全局变量结果，我可以执行以下操作：

```
jQuery.ajax({
    type: 'POST',
    dataType: 'json',
    data: data,
    url: url,
    success: function(data){
        result = data;
    },
    error: function(xhr){
        alert("Request cannot complete");
    },
    async: false
}).responseText; 
```

但是上面的 jQuery.ajax() POST 示例并没有被 IE 完全支持。

# sharepoint-2010 - Sharepoint sp2010 _Layouts 映射文件夹

> ID：11036617
> 
> 赞同：5
> 
> 时间：2012-06-14T15:39:47.130
> 
> 标签：sharepoint-2010

我有一个可以为 SharePoint 2007 和 SharePoint 2010 部署的解决方案。有常见的文件，如 .css 文件和图像。当我为 SP2010 部署解决方案时，我使用映射文件夹 (_Layouts)。这个文件夹必须将我的文件复制到服务器。关键是我不想将相同的文件复制到这个文件夹。我将它们添加为链接。但 Visual Studio 不想将文件复制到目标文件夹。![在此处输入图像描述](../Images/12f65d72a6cdbc1bb4db0effe8167e62.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T03:15:37.057

如果我理解正确，您想要部署链接文件。这不仅是 SharePoint 限制，而且是 Web 项目的 Visual Studio 限制。我相信 SharePoint 项目也存在同样的限制。请参考以下链接：

[https://connect.microsoft.com/VisualStudio/feedback/details/665257/](https://connect.microsoft.com/VisualStudio/feedback/details/665257/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T07:26:58.280

我已经解决了这个问题。只是删除了链接并添加了真实文件。

# java - 如何访问“未命名”类的方法？

> ID：11036618
> 
> 赞同：1
> 
> 时间：2012-06-14T15:39:48.760
> 
> 标签：java, inheritance, abstract-class

```
public class Test {
    public static void main(String[] args) {
        DemoAbstractClass abstractClass = new DemoAbstractClass() {
            private String val;

            @Override
            public void runner() {
                val = "test";
                System.out.println(val);
                this.run();
            }

            public String getVal() {
                return val;
            }
        };

        abstractClass.runner();

        /**
         * I want to access getVal method here
         */
    }
}

abstract class DemoAbstractClass {
    public void run() {
        System.out.println("running");
    }

    public abstract void runner();
} 
```

在这里，我声明了一个抽象类 DemoAbstractClass。我显然可以创建一个扩展此类的新类并将此方法添加到其中。但是，我不希望在我的场景中这样做。有没有其他方法可以访问上述代码中的**getVal方法？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:44:11.953

你不能。您需要从中创建一个适当的（非异常）类。如果您想限制其范围，请将其设为内部私有类。

或者，您可以使用 StringBuffer 并在方法之间共享对它的引用。然而不是很干净。

相关问题：

*   [访问内部匿名类成员](https://stackoverflow.com/questions/319765/accessing-inner-anonymous-class-members)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:44:43.937

如果不使用反射，则不能，因为您无法访问对象的具体类型才能将方法调用绑定到

如果您不想以理智的方式做这样的事情，请声明一个命名类并将其用作`abstractClass`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T15:45:15.457

不幸的是，如果您无法命名类型，则无法访问语言级别的方法。

但是，您可以做的是使用反射 API 来获取一个`Method`对象并将`invoke`其放在该对象上。

然而，这相当缓慢。私有类或私有接口会快得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T15:48:37.613

*我显然可以创建一个扩展此类的新类并将此方法添加到其中。*

你已经这样做了；最终结果是一个匿名的内部类：`new DemoAbstractClass() { ... };`如果你只是将该声明移到它自己的类中——你甚至可以使它成为一个私有类——你可以访问 getVal。

根据您上面的示例：

```
public class Test {
    public static void main(String[] args) {
        DemoClass abstractClass = new DemoClass();

        abstractClass.runner();

        /**
         * I want to access getVal method here
         */
        abstractClass.getVal(); // can do this here now
    }

    private class DemoClass extends DemoAbstractClass {

            private String val;

            @Override
            public void runner() {
                val = "test";
                System.out.println(val);
                this.run();
            }

            public String getVal() {
                return val;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-14T15:52:13.667

另一种选择是让 StringBuilder 成为 main 方法的成员，并使用匿名内部方法的闭包特性：

```
public static void main(String[] args) {
    final StringBuilder value = new StringBuilder();
    DemoAbstractClass abstractClass = new DemoAbstractClass() {
        @Override
        public void runner() {
            value.append( "test" );
            System.out.println(val);
            this.run();
        }
    };

    abstractClass.runner();

    // use val here...
    String val = value.toString();
} 
```

# c# - 有没有更好的方法将 Lambda 与 N 组一起使用？

> ID：11036620
> 
> 赞同：4
> 
> 时间：2012-06-14T15:40:08.600
> 
> 标签：c#, lambda

我有一种方法`Process(IEnumerable<Record> records)`，一次最多可以记录但不超过 3 条记录。我有数百条记录，所以我需要分组传递。我这样做：

```
var _Records = Enumerable.Range(1, 16).ToArray();
for (int i = 0; i < int.MaxValue; i += 3)
{
    var _ShortList = _Records.Skip(i).Take(3);
    if (!_ShortList.Any())
        break;
    Process(_ShortList);
}
// TODO: finish 
```

它有效，但是......有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:46:48.283

你可以使用[MoreLinq](http://code.google.com/p/morelinq/)的`Batch`

```
var result=Enumerable.Range(1, 16).Batch(3); 
```

或者

```
var arrayOfArrays = Enumerable.Range(1, 16).Batch(3).Select(x => x.ToArray()).ToArray(); 
```

如果您想查看它，这里是[源代码。](http://code.google.com/p/morelinq/source/browse/MoreLinq/Batch.cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:02:39.037

您可以使用此扩展方法：

```
public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> source, int chunkSize)
{
    return source
        .Select((value, i) => new { Index = i, Value = value })
        .GroupBy(item => item.Index % chunkSize)
        .Select(chunk => chunk.Select(item => item.Value));
} 
```

它将项目的源集合拆分为具有给定大小的几个块。因此，您的代码将如下所示：

```
foreach (var chunk in Enumerable.Range(1, 16).Split(3))
{
    Process(chunk);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T16:18:08.453

这是另一种 LINQ-y 方法：

```
var batchSize = 3;
Enumerable.Range(0, (_Records.Length - 1)/batchSize + 1)
    .ToList()
    .ForEach(i => Process(_Records.Skip(i * batchSize).Take(batchSize))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T16:04:40.987

如果您需要在解决方案中多次“分页”，您可以考虑使用扩展方法。

在 LINQPad 中一起破解，它会成功的。

```
public static class MyExtensions {
    public static IEnumerable<IEnumerable<T>> Paginate<T>(this IEnumerable<T> source, int pageSize) {
        T[] buffer = new T[pageSize];
        int index = 0;

        foreach (var item in source) {
            buffer[index++] = item;

            if (index >= pageSize) {
                yield return buffer.Take(pageSize);
                index = 0;
            }
        }

        if (index > 0) {
            yield return buffer.Take(index);
        }
    }
} 
```

基本上，它预先填充一个大小的缓冲区，`pageSize`并在它满时产生它。如果还有`< pageSize`元素，我们也让它们产生。所以，

```
Enumerable.Range(1, 10).Paginate(3).Dump(); // Dump is a LINQPad extension 
```

将产生

```
{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}, {10}} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-14T16:11:52.827

```
var _Records = Enumerable.Range(1, 16).ToArray();

int index = 0;
foreach (var group in _Records.GroupBy(element => index++ / 3))
    Process(group); 
```

* * *

注意：上面的代码很短且相对高效，但仍然没有达到预期的效率（它本质上会在后台构建一个哈希表）。一个稍微麻烦但更快的方法是：

```
var _Records = Enumerable.Range(1, 16).ToArray();

var buff = new int[3];
int index = 0;

foreach (var element in _Records) {
    if (index == buff.Length) {
        Process(buff);
        index = 0;
    }
    buff[index++] = element;
}

if (index > 0)
    Process(buff.Take(index)); 
```

或者，将其打包成更可重用的形式：

```
public static class EnumerableEx {

    public static void Paginate<T>(this IEnumerable<T> elements, int page_size, Action<IEnumerable<T>> process_page) {

        var buff = new T[3];
        int index = 0;
        foreach (var element in elements) {
            if (index == buff.Length) {
                process_page(buff);
                index = 0;
            }
            buff[index++] = element;
        }

        if (index > 0)
            process_page(buff.Take(index));

    }

}

// ...

var _Records = Enumerable.Range(1, 16).ToArray();
_Records.Paginate(3, Process); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-14T16:13:21.627

您可以创建自己的扩展方法：

```
static class Extensions {

  public static IEnumerable<IEnumerable<T>> ToBlocks<T>(this IEnumerable<T> source, int blockSize) {
    var count = 0;
    T[] block = null;
    foreach (var item in source) {
      if (block == null)
        block = new T[blockSize];
      block[count++] = item;
      if (count == blockSize) {
        yield return block;
        block = null;
        count = 0;
      }
    }
    if (count > 0)
      yield return block.Take(count);
  }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-14T16:28:48.730

```
public static void ChunkProcess<T>(IEnumerable<T> source, int size, Action<IEnumerable<T>> action)
{
    var chunk = source.Take(size);

    while (chunk.Any())
    {
        action(chunk);

        source = source.Skip(size);
        chunk = source.Take(size);
    }
} 
```

你的代码是

```
ChunkProcess(_Records, 3, Process); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-19T00:54:41.407

此扩展方法工作正常。

```
public static class EnumerableExtentions
{
    public static IEnumerable<IEnumerable<T>> Chunks<T>(this IEnumerable<T> items, int   size)
    {
        return
            items.Select((member, index) => new { Index = index, Value = member })
                .GroupBy(item => (int)item.Index / size)
                .Select(chunk => chunk.Select(item => item.Value));
    }
} 
```

# mysql - 通过向 8 位字符集添加简单排序规则来更改默认排序

> ID：11036621
> 
> 赞同：3
> 
> 时间：2012-06-14T15:40:09.457
> 
> 标签：mysql, sorting, collation

之前发布的问题是零响应，因此我将根据此 MySQL 手册条目，用我的研究结果中的进一步说明和详细信息来替换它。

过去，我使用过允许我们指定备用默认排序的备用排序规则。Mysql 允许这到列级别，但我不明白让它工作的*东西。*

我们的客户在几乎所有对任何主表的引用中都使用一组标准的单个字符代码，并且按照他们需要的顺序呈现这些代码总是非常麻烦和困难的使用 PHP 中的函数和例程。

```
SELECT * FROM myTable order by my_code

NORMAL, default sorting would return this:      DESIRED, default sorting should return this:
my_code | Description                           my_code | Description
 1      | Grade 1                               P  | Pre-Kindergarten
 2      | Grade 2                               K  | Kindergarten
 3      | Grade 3                               1  | Grade 1
 A      | Adult                                 2  | Grade 2
 K      | Kindergarten                          3  | Grade 3
 P      | Pre-Kindergarten                      A  | Adult 
```

完成此操作的步骤[在 10.4.3 的文档中进行了描述。](http://dev.mysql.com/doc/refman/5.0/en/adding-collation-simple-8bit.html), 示例[在 10.1.78 的文档中显示](http://dev.mysql.com/doc/refman/5.0/en/charset-collation-effect.html)。

在这些步骤中，它显示了此表以及如何指定*权重*。我想这就是我迷路的地方。我改变了权重，如下所示，将“P”（x50P）和“K”（x4B）放在“0”（x30）之前，但它所做的只是改变排序，以便“1”（x31）出现在“P”和“K”，所有其他排序似乎保持不变。

```
<collation name="latin1_test_ci">
<map>
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F
50 4B 30 31 32 33 34 35 36 37 38 39 41 43 55 3A
3B 3C 3D 3E 3F 40 42 44 45 46 47 48 49 4A 4C 4D
4E 4F 51 52 53 54 56 57 58 59 5A 5B 5C 5D 5E 5F
60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F
80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F
90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F
A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF
B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D D7 D8 55 55 55 59 59 DE DF
41 41 41 41 5C 5B 5C 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5D F7 D8 55 55 55 59 59 DE FF
</map>
</collation> 
```

使用上面的备用排序规则对结果进行排序

```
Hex |my_code | Description
 32 |  2     |Grade 2
 33 |  3     |Grade 3
 41 |  A     |Adult Ed
 4B |  K     |Kindergarten
 31 |  1     |Grade 1
 50 |  P     |Pre-K 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T17:39:51.973

我知道您说过您想更改排序规则，但这不需要`ORDER BY`并且值得考虑。您可以将它们转换为[`ENUM`](http://dev.mysql.com/doc/refman/5.0/en/enum.html)类型，它们将按照它们在[`ENUM`](http://dev.mysql.com/doc/refman/5.0/en/enum.html).

```
CREATE TABLE myTable (
    my_code ENUM('P', 'K', '1', '2', '3', 'A'), 
    ...
) 
```

强烈建议不要在 ENUM 中使用数字，因此您必须小心。主要问题是数字可以被视为 ENUM 中的索引或值。所以它的行为取决于它的类型，导致意想不到的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T20:39:30.823

此表为权重表。如果您希望 P i 小于 K，则将 00 权重放在 P 上，将 01 权重放在 K 上。要放置权重，您应该在“字母位置”中指定一个值：对于 P 位置 50。`P`作为第一个字母放置的示例：

```
<collation name="latin1_test_ci">
<map>
FF FF FF FF FF FF FF 07 08 09 0A 0B 0C 0D 0E 0F
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F
30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F
40 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
50 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F
60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
00 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F   <-- first weight
80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F
90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F
A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF
B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF
41 41 41 41 5B 5D 5B 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5C D7 5C 55 55 55 59 59 DE DF
41 41 41 41 5B 5D 5B 43 45 45 45 45 49 49 49 49
44 4E 4F 4F 4F 4F 5C F7 5C 55 55 55 59 59 DE FF
</map>
</collation> 
```

**编辑：**添加测试和竞争表。

完整的表格应该是：

```
<collation name="latin1_test_ci">
<map>
 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F
 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F
 30 02 03 04 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F
 40 05 42 43 44 45 46 47 48 49 4A 01 4C 4D 4E 4F
 00 51 52 53 54 55 56 57 58 59 5A 5B 5C 5D 5E 5F
 60 41 42 43 44 45 46 47 48 49 4A 4B 4C 4D 4E 4F
 50 51 52 53 54 55 56 57 58 59 5A 7B 7C 7D 7E 7F
 80 81 82 83 84 85 86 87 88 89 8A 8B 8C 8D 8E 8F
 90 91 92 93 94 95 96 97 98 99 9A 9B 9C 9D 9E 9F
 A0 A1 A2 A3 A4 A5 A6 A7 A8 A9 AA AB AC AD AE AF
 B0 B1 B2 B3 B4 B5 B6 B7 B8 B9 BA BB BC BD BE BF
 41 41 41 41 5B 5D 5B 43 45 45 45 45 49 49 49 49
 44 4E 4F 4F 4F 4F 5C D7 5C 55 55 55 59 59 DE DF
 41 41 41 41 5B 5D 5B 43 45 45 45 45 49 49 49 49
 44 4E 4F 4F 4F 4F 5C F7 5C 55 55 55 59 59 DE FF
</map>
</collation> 
```

***测试：***

```
mysql> create table  b (a varchar(1) collate latin1_test_ci );

mysql> insert into b values
    -> ( 'P' ),
    -> ('K'),
    -> ('A'),
    -> ('1'),
    -> ('2'),
    -> ('3');

mysql> SHOW COLLATION LIKE 'latin1_test_ci';
+----------------+---------+----+---------+----------+---------+
| Collation      | Charset | Id | Default | Compiled | Sortlen |
+----------------+---------+----+---------+----------+---------+
| latin1_test_ci | latin1  | 56 |         |          |       0 |
+----------------+---------+----+---------+----------+---------+
1 row in set (0.00 sec)

mysql> select * from b order by a;
+------+
| a    |
+------+
| P    |
| K    |
| 1    |
| 2    |
| 3    |
| A    |
+------+
6 rows in set (0.00 sec) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T17:40:14.303

我认为您不需要自定义排序规则来实现您的目标。

**要对结果集进行排序：**

```
ORDER BY FIELD(my_code, 'P','K','1','2','3','4','5','6',
    '7','8','9','10','11','12','A') 
```

**要限制结果集：**

```
 WHERE my_code IN('K','1','2','3','4','5') 
```

如果您要将此类功能写入大量查询，**辅助函数可能是一个好主意：**

```
DELIMITER $$
CREATE FUNCTION `f_position`(in_char CHAR(1)) RETURNS INTEGER
BEGIN
    RETURN FIELD(in_char, 'P','K','1','2','3','4','5','6',
        '7','8','9','10','11','12','A');
END$$
DELIMITER ; 
```

只需确保在函数中引用了所有可能的代码，并按照您想要的顺序放置。

使用这样的辅助函数，您可以编写如下查询：

```
WHERE f_position(grade) BETWEEN f_position('K') AND f_position('5')
ORDER BY f_position(grade) 
```

使用辅助函数来限制这样的结果集（与 相对`WHERE grade IN(...)`）的唯一缺点是函数调用会阻止使用列“grade”上的任何索引。

# cakephp - 在 url 中包含 id 以传递给另一个模型

> ID：11036631
> 
> 赞同：0
> 
> 时间：2012-06-14T15:41:02.577
> 
> 标签：cakephp

我与 Product hasmany Page 有模型关系。当我添加一个新产品然后转到视图时，我可以向该产品添加一个新的产品页面。但是，单击该链接不会将当前产品 ID 传递到 prodpages/add 页面。我希望这样做，以便当您添加 prodpage 时，已经根据您正在查看的先前产品选择了关联的产品 ID。

我认为归结为在产品视图中编辑链接并将 id 传递到 prodpages/add/ 之后追加。那是对的吗？这里是：

```
<?php echo $this->Html->link(__('New Prodpage'), array('controller' => 'prodpages', 'action' => 'add'));?> </li> 
```

如何在其中包含产品 ID？

当涉及到 Prodpages 控制器时.. 这是我到目前为止的 add 功能..

```
public function add($product_id) {
        if ($this->request->is('post')) {
            $this->Prodpage->create();
            if ($this->Prodpage->save($this->request->data)) {
                $this->Session->setFlash(__('The prodpage has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The prodpage could not be saved. Please, try again.'));
            }
        }
        $products = $this->Prodpage->Product->find('list');
        $this->set(compact('products'));
        $this->data['Prodpage']['product_id'] = $product_id; 
    } 
```

这对控制器有用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:46:57.267

是的，只需将其添加到您的链接

```
echo $this->Html->link(__('New Prodpage'), array(
  'controller' => 'prodpages', 
  'action' => 'add',
  $product_id
)); 
```

您缺少更多视图，但这假设您的视图有一个变量`$product_id`。

# c#-4.0 - 试图简化代码

> ID：11036633
> 
> 赞同：0
> 
> 时间：2012-06-14T15:41:04.610
> 
> 标签：c#-4.0

有人建议我如何简化以下代码

```
 private bool isMethodCalled;
            private void CallMethod()
            {
                if (!isMethodCalled)
                {
                    this.CallCertainMethod();
                    isMethodCalled = true;
                }
            }

            private int field1;
            public int Property1
            {
                get
                {
                    CallMethod();
                    return this.field1;
                }
                set { this.field1 = value; }
            }

           private int field2;
            public int Property2
            {
                get
                {
                    CallMethod();
                    return this.field2;
                }
                set { this.field2 = value; }
            }

            private int field3;
            public int Property3
            {
                get
                {
                    CallMethod();
                    return this.field3;
                }
                set { this.field3 = value; }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:47:29.077

您可以简化以下内容：

```
private void CallMethod()
{
    if (!isMethodCalled)
    {
        this.CallCertainMethod();
        isMethodCalled = true;
    }
} 
```

至：

```
private void CallMethod()
{
    if (!isMethodCalled) this.CallCertainMethod();
    isMethodCalled = true;
} 
```

作为旁注：

我不知道有什么`CallCertainMethod()`作用。以防万一，不建议同时查询数据和变异状态。请参阅[Command Query-Separation](http://en.wikipedia.org/wiki/Command-query_separation)，它指出每个方法都应该是执行操作的命令，或者是向调用者返回数据的查询，但不能同时是两者。换句话说，问一个问题不应该改变答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:45:18.547

您可以使用 PostSharp 之类的 AOP 框架来创建一个属性，该属性将调用`CallMethod`并仅使用 和 的自动`Property1`属性。尽管除非有很多其他属性，否则它不会节省太多代码行数。`Property2``Property3`

# compression - 逆向工程 RLE 压缩算法的策略

> ID：11036635
> 
> 赞同：0
> 
> 时间：2012-06-14T15:41:06.223
> 
> 标签：compression, reverse-engineering

我试图用 Python 脚本在 RLE 流中破解我的方式，但到目前为止还不是很幸运。该流不是*Packbits*流，也不是我能找到的任何“记录在案”的 RLE 流。

有什么已知的策略可以让我尝试在这个二进制流中找到自己的方式吗？

事实上，我正在尝试破译`.fpc`我收到的一些文件的内容，这些文件是由*TerraExplorer*软件创建的，但我找不到任何格式规范。我不拥有该软件，因此无法压缩自己的文件。

这些文件是“压缩的”存档文件，包含一个 OpenFlight `.flt`3d 模型文件和几个相关的纹理。

到目前为止，我已经能够找到存档中的各个文件，但这些文件似乎是 RLE 压缩的，无法被传统软件读取。

我可以访问一些未压缩的文件，但不能访问它们的压缩文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:02:08.150

我不这么认为，但您可以尝试 bwt 或 mft 排序。当有字典时，您可以尝试各种 RLE，然后使用反向 bwt 或 mft 来破译文件。

# jquery - 使用 AJAX 发送表单：HTTP 响应的 DOM 和数据是否仍然加载？

> ID：11036636
> 
> 赞同：3
> 
> 时间：2012-06-14T15:41:10.297
> 
> 标签：jquery, ajax, forms

这是我的代码：

```
<script>

    function loadPage() {

        function sendFormHelper(callback) {
            var url = "/same-as-current-url";
            var serializedForm = $('#form').serialize();
            $.post(url, serializedForm, function(data) {
                callback(data);
            });
        }

        $('#form').off('submit').on('submit', function() {
            sendForm(function(data) {
                var mainResultCount = $(data).find('#main-result-count');
                var mainList = $(data).find('#main-list');
                $('#main-result-count').html($(mainResultCount).html());
                $('#main-list').html($(mainList).html());
                loadPage();
            });
            return false;
        });

    }

    $(function() {
        loadPage();
    });

</script>

<form id="form">
    <!-- some stuff -->
</form>

<div id="main-result-count">
    <!-- some stuff that can change -->
</div>

<div id="main-list">
    <!-- some stuff that can change -->
</div> 
```

如您所见，我不是在提交表单时重新加载页面，而是捕获事件并使用 AJAX 发送它。返回的数据是一个完整的 HTML 页面，与用户看到的几乎完全相同。从该页面，我使用可能更改的数据更新当前布局。

我在页面上还有其他几个 JS 脚本，运行*时间很长*，还有*很多*布局数据，如图像、CSS、菜单等。在获得 AJAX 的响应时，所有这些数据和 DOM 也会被加载请求即使该内容未显示，还是仅在浏览器解析时才加载此类内容，然后保留一种*大字符串*？

我找不到我应该实施什么样的测试来自己找到答案`:(`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:46:15.537

不，当你这样做时，其他东西不会被加载。ajax 请求只会获取标记本身。它也不会引入外部脚本、运行脚本等。只有加载 HTML 会话的浏览器才会这样做。

您可以使用 Firebug 之类的工具进行调查，以验证我在这里是否正确。

在您提出请求时，继续观看 Firebug 的网络 I/O。您会注意到没有加载任何 javascript/css 资源……只是来自 servlet 的标记。

希望这可以帮助。

# iphone - Xcode：使图像加速然后单击按钮？

> ID：11036637
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:41:10.330
> 
> 标签：iphone, xcode

我正在为我的 Xcode 项目寻求一些帮助。

我想让图像移动到特定位置，然后单击按钮。但它必须加速而不仅仅是移动（从开始位置消失并出现在结束位置）。所以它必须动画。

希望你能帮帮我！

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:58:04.493

您可以使用动画块轻松实现动画到新位置`UIView`。下面的例子..

```
-(void)buttonClick:(id)sender {

           UIButton *button = (UIButton*)sender;

           [UIView animateWithDuration:1 
                      delay:0
                    options:UIViewAnimationCurveLinear
                 animations:^{

           [button setFrame:CGRectMake(100,100,button.frame.size.width,button.frame.size.height)];

                 }
                 completion:^(BOOL finished){

                 }]

} 
```

上述方法将获取您的按钮并将其移动到`{100,100`其超级视图上的位置 }，持续时间为`1`秒，动画曲线为`UIViewAnimationCurveLinear`. [您可以在UIView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)文档中查看动画曲线的选项。

# javascript - 即时创建 json 键

> ID：11036644
> 
> 赞同：7
> 
> 时间：2012-06-14T15:41:58.393
> 
> 标签：javascript, jquery, json

我想创建一个`json`对象作为 post 数组发送，但我需要动态创建密钥

```
var id = $('#myInput').val();

var post = {
    'product[123]': 'myValue',     // this works fine - but isn't dynamic
    'product['+id+']': 'myValue'   // this does not work
} 
```

将其作为字符串发送可以正常工作，但是当我想让它更具动态性时会遇到问题。我在这里错过了一些非常简单的东西，还是我试图做一些Javascript不应该做的事情？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-14T15:43:43.417

*（请注意，这与 JSON 无关。您没有使用 JSON，您使用的是[对象初始化器](http://ecma-international.org/ecma-262/5.1/#sec-11.1.5)。JSON[是](http://json.org)一种文本（不是代码）格式，它是JavaScript 的对象初始化器语法的**子集。）***

在对象初始化器之外执行它，使用`[]`符号：

```
var id = $('#myInput').val();

var post = {};
post[product[id]] = 'myValue'; 
```

这将取值（在运行时）`product[id]`并将其用作属性的键。如果您希望键*字面上*是`product[123]`when `id`is `123`，则可以改用它：

```
post['product[' + id + ']'] = 'myValue'; 
```

更一般的讨论：

```
var a = "foo";
var obj = {};
obj[a] = "bar";
console.log(obj.foo); // "bar" 
```

JavaScript 允许您以两种方式指定属性键：使用点分表示法和文字 ( `obj.foo`)，或使用方括号表示法和字符串 ( `obj["foo"]`)。在后一种情况下，字符串不必是字符串文字，它可以是任何表达式的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:43:36.800

尝试

```
post['product[' + id + ']'] = 'myValue'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:50:14.270

为什么在对象的 id 中使用 '[ ]'？避免这样做。
在您的示例中，您可以通过以下代码执行此操作：

```
var id = $('#myInput').val();
var post = {
    '123': 'myValue',    
    id: 'myValue' 
} 
```

或者，如果你真的想使用一个数组（实际上，JavaScript 中的所有对象都是数组）。你可以这样写：

```
var product=[];
product['123']='something';
product[id]='another'; 
```

# asp.net-mvc - MVC 路由：“多个操作 id

> ID：11036648
> 
> 赞同：0
> 
> 时间：2012-06-14T15:42:10.117
> 
> 标签：asp.net-mvc, model-view-controller, asp.net-mvc-routing

我的 MVC 路由有问题。

我正在尝试访问以下网址...“ **http://localhost/api/Countries** ”

我按以下顺序定义了以下路线...

```
 RouteTable.Routes.MapHttpRoute(
        name: "Continents",
        routeTemplate: "api/countries/Continents",
        defaults: new { controller = "countries", Action="Continents" }
        );
    RouteTable.Routes.MapHttpRoute(
        name: "CountryRegions",
        routeTemplate: "api/countries/Regions",
        defaults: new { controller = "countries", Action = "CountryRegions" }
        );

    RouteTable.Routes.MapHttpRoute(
        name: "CountryByCodeApi",
        routeTemplate: "api/{controller}/{countryCode}",
        defaults: new { controller="countries", countryCode = System.Web.Http.RouteParameter.Optional }
        ); 
```

每当我转到所需的 URL 时，我都会收到错误“***找到与请求匹配的多个操作***”。如果 routeTemplate 属性的第三段是可选的，这将是有意义的，但我的理解是，通过不将其括在大括号中，它使其成为目标 URL 中的***必需***段。显然“http://localhost/api/countries”不包括“大陆”或“地区”，那么为什么它们会被识别为与请求匹配。

你知道的。这些路线看起来很简单，但是当你开始使用它时，它就像 RegEx 一样神秘！！！

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T17:16:01.760

最后一个路由定义不通过路由定义提供动作名称，也不通过路由默认值提供它。如果路由定义应该省略它，则将其添加到默认值，如下所示：

```
routes.MapRoute(
    "CountryByCodeApi",
    "api/{controller}/{countryCode}",
    new {
        controller="countries",
        countryCode = RouteParameter.Optional,
        action = "CountryCodes"
    }
); 
```

请注意，这只是最后一个路由定义。上层夫妇保持原样。

```
public ActionResult CountryCodes(string countryCode)
{
    // do whatever you please
} 
```

# c++ - 允许子面板处理鼠标运动事件

> ID：11036649
> 
> 赞同：0
> 
> 时间：2012-06-14T15:42:17.690
> 
> 标签：c++, wxwidgets

我有一个具有以下布局的 GUI 应用程序：

```
wxFrame --> wxBoxSizer --> wxImagePanel 
```

wxImagePanel 是一个自定义控件（可[在此处](http://wiki.wxwidgets.org/An_image_panel)获得）。我稍微修改了它以处理鼠标事件（使用 EVT_MOTION），例如允许我平移图像的拖动。

现在，不幸的是，这在 Windows 上看起来很丑 - 有一个深灰色的背景。推荐的方法是在 wxFrame 中[添加一个 wxPanel——](http://wiki.wxwidgets.org/WxFAQ#Why_are_backgrounds_of_windows_ugly.2C_dark_grey_on_Windows.3F_I_want_them_like_my_dialog_boxes.)这使得丑陋的背景消失了。该应用程序现在布局如下：

```
wxFrame --> wxBoxSizer --> wxPanel --> wxBoxSizer --> wxImagePanel (a custom control) 
```

它看起来好多了，但现在我添加的 wxPanel 正在抓取所有鼠标运动事件。他们没有通过子 wxImagePanel，所以我不能再平移我的图像了。

如何确保鼠标运动事件通过子 wxImagePanel？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:48:07.797

事情的正常顺序是

wxFrame --> wxPanel --> wxBoxSizer

我认为你会更好地使用它，就像这样

wxFrame --> wxImagePanel --> wxBoxSizer

或者

wxFrame --> wxPanel --> wxBoxSizer --> wxImagePanel

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T13:44:08.723

我通过在[wxWidgets 论坛](http://forums.wxwidgets.org/viewtopic.php?f=1&t=35264)上提问解决了这个问题。

基本上，我的问题是 wxImagePanel 是 wxFrame 的孩子，而它应该是 wxPanel 的孩子。

# java - Java EE：从 POST 获取登录表单的参数

> ID：11036651
> 
> 赞同：2
> 
> 时间：2012-06-14T15:42:23.323
> 
> 标签：java, html, xml, servlets

我正在尝试实现一个简单的登录 servlet，但它不能正常工作。

**我想知道**的是如何使用 HTTP POST 传递参数。它已经可以与 HTTP GET 一起使用，但用户名和密码可以从 URL 中看到。最好将它们隐藏在 POST 中。

```
<form method="post" action="home" >
  <input name="username" class="form-login" title="Username" value="" size="30" maxlength="2048" />
  <input name="password" type="password" class="form-login" title="Password" value="" size="30" maxlength="2048" />
  <input type="submit" value="Connect">
</form> 
```

**web.xml**

```
 <servlet>
    <servlet-name>home</servlet-name>
    <servlet-class>controller.HomeController</servlet-class>
  </servlet>

  <servlet-mapping>
    <servlet-name>home</servlet-name>
    <url-pattern>/home</url-pattern>
  </servlet-mapping> 
```

**小服务程序：**

```
public class HomeController extends HttpServlet {

    private HttpSession session;
    private UserBean userBean;

    public void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        UserBean user = new UserBean();
        String userName = request.getParameter("username");
        String password = request.getParameter("password");

        user.setUsername(userName);
        user.setPassword(password);

        user = UserDAO.login(user);

        dispatch(request, response, ApplicationRessource.getInstance().getHomePage());
    }

    protected void dispatch(HttpServletRequest request,
                HttpServletResponse response, String page)
            throws javax.servlet.ServletException, java.io.IOException {
        RequestDispatcher dispatcher = getServletContext()
                .getRequestDispatcher(page);
        dispatcher.forward(request, response);
    }
} 
```

问题是`userName`and`password`字符串总是空的，这意味着参数永远不会从 POST 中获取。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:49:12.040

它应该可以工作，您可以通过更改表单方法来检查并尝试，您应该在 url 中看到参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:39:13.577

请试试这个

在您的 doPost(..) 方法代码中仅 doGet(..) 并将所有逻辑放入 doGet(..) 并检查它是否仍然给出空白值。

让我知道输出是什么。

例子：-

```
public void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
           doGet(request,response);
}

public void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        UserBean user = new UserBean();
        String userName = request.getParameter("username");
        String password = request.getParameter("password");

        user.setUsername(userName);
        user.setPassword(password);

        user = UserDAO.login(user);

        dispatch(request, response, ApplicationRessource.getInstance().getHomePage());
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T05:43:21.480

这个简单的实现应该可以工作..但由于它没有，可能有一些代码正在操纵请求。您发布的代码不足以确定这一点。

我可以给出的一些指示是 -

1.  检查您`web.xml`是否有任何过滤器/拦截器正在操纵请求。

2.  您使用的是哪个网络/应用服务器？你检查过`service(Http...)`HttpServlet的方法实现吗？您可以`try placing a debug point in service(..) method`在这里查看请求对象是否具有所需的请求参数。如果没有，那么问题存在于某些过滤器或您的 jsp 本身中。

3.  做什么`dispatch(request, response, ApplicationRessource.getInstance().getHomePage());`？我知道问题出在这一行之前，但这不是标准的 HttpServlet 方法，所以我假设有更多的自定义代码，然后是上面问题中发布的内容。

# java - Java反序列化：从缓冲区读取时如何知道何时到达对象的末尾？

> ID：11036660
> 
> 赞同：3
> 
> 时间：2012-06-14T15:42:58.867
> 
> 标签：java, serialization, objectoutputstream, objectinputstream

我试图想出一个好的标题，但似乎失败了。这是我的问题：

我正在从套接字读取数据。缓冲区中包含的数据是一个序列化的对象。一旦数据被完全读取，我就可以创建一个 ObjectInputStream 并使用 readObject 来读取数据。

我的问题是，因为我的套接字类正在读取字节......我怎么知道我什么时候收到了完整的对象？对象指示器似乎没有结束，我尝试寻找序列化字节码的突破以查看是否可以找到长度字段，但序列化字节码在谷歌可以找到的任何地方都没有得到很好的解释。

我收到的对象是哈希映射（java.util.Map），如果这有区别的话。

这是我正在使用的部分代码：

```
long start = System.currentTimeMillis();
long end = start + (getTimeout() * 1000);   
m_Ipports.send(dataToSend);       
m_Waiting = true;        
while (m_Waiting) {
  // Data is read in a separate thread, and stored into the byte buffer m_DataIn
  if (System.currentTimeMillis() > end) {
    //throw new Exception("Timeout waiting for response.");             
    m_Waiting = false;  // hack to get it to work. Times out every time.
  }
  m_Ipports.doEvents();
}
ByteArrayInputStream bis = new ByteArrayInputStream(m_DataIn.toByteArray()); 
ObjectInputStream ois = new ObjectInputStream(bis);        
Object o = ois.readObject();             
Map m = (Map)o; 
```

所以，我的问题是，当我阅读 m_DataIn 时，我如何确定我已经到达对象的末尾？

注意：我不能以任何方式修改我从中接收这些对象的服务器。这不是我的代码。

谢谢。

查尔斯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:48:24.503

发送对象的流需要为您提供它将发送的字节数。当您读取指定的字节数时，您将知道您已完成读取对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T22:39:18.267

你为什么要从套接字读取字节？只需将 ObjectInputStream 直接附加到套接字并读取*对象*即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T20:58:29.603

好吧，IPWorks IPPortS (SSL) 类对于我需要它的几乎所有其他实例都非常有用。它使 SSL 通信变得轻而易举……就像 4 行代码和几个事件处理程序。一个问题是从流中读取对象。我没有使用 ssl 套接字实现自己的解决方案，而是实现了自己的输入流。希望有一天这对其他人有用。

输入流类：

```
class NetworkInputStream extends InputStream {
  private int m_Offset = 0;  
  private ByteArrayOutputStream m_Buffer = null;

  Ipports m_Ipports = null;
  public NetworkInputStream(Ipports ipport) {
    m_Ipports = ipport;
    m_Buffer = new ByteArrayOutputStream();
    try { m_Ipports.receiveStream(m_Buffer); } catch (Exception e) {}
    m_Offset = 0;
  }
  public void waitForData() throws Exception {  
    if (dataAvailable() == 0) { 
      m_Buffer.reset();
      m_Offset = 0;
    }
    while (dataAvailable() == 0 && m_Ipports.isConnected()) {      
      m_Ipports.doEvents();
    }
  }
  private int dataAvailable() {
    return m_Buffer.size() - m_Offset;  
  }
  public int read(byte[] buffer, int offset, int length) throws IOException, IndexOutOfBoundsException {
    try {
      waitForData();
    } catch (Exception e) { 
      throw new IOException(e.getMessage()); }
    int bytesRead = -1;
    int dataAvailable = dataAvailable();
    if (dataAvailable > 0) {
      bytesRead = Math.min(dataAvailable, length);
      m_Buffer.toByteArray();
      System.arraycopy(m_Buffer.toByteArray(), m_Offset, buffer, offset, length);      
      m_Offset += bytesRead;
    }
    return bytesRead;
  }
  @Override
  public int read() throws IOException {
    byte[] buf  = new byte[] { 0x00 };
    int rval = read(buf, 0, 1);
    if (rval == -1) return rval;
    int cast = (int)buf[0] & 0xff;
    return cast;
  }
} 
```

用法：

```
m_Ipports.setSSLStartMode(Ipports.sslImplicit);
m_Ipports.setTimeout(60);
m_Ipports.setRemoteHost(host);
m_Ipports.setRemotePort(port);
m_Ipports.setConnected(true);

NetworkInputStream nis = new NetworkInputStream(m_Ipports);
m_Ipports.setAcceptData(true);
m_Ipports.send(dataToSend);   
ObjectInputStream ois = new ObjectInputStream(nis);
Object resp = ois.readObject();
m_Ipports.setAcceptData(false);
m_Ipports.setReceiveStream(null);
Map m = (Map)o; 
```

我省略了 IPPortS 的事件处理程序，您真正需要的唯一一个是：

```
 public void SSLServerAuthentication(IpportsSSLServerAuthenticationEvent e) {
    e.accept = true;
  } 
```

现在，这假设您将获得一个完整的对象来响应请求。这就是我与之交互的服务器的工作方式。

查尔斯。

# sql - VBScript 通配符等同于 T-SQL "%"

> ID：11036661
> 
> 赞同：0
> 
> 时间：2012-06-14T15:43:00.033
> 
> 标签：sql, vbscript, wildcard

我试图基本上查看是否存在文件名中包含当前日期的文件。在 T-SQL 中，当我想在字符串中搜索某些内容时，我只需将其括在“%”字符中，如下所示：%June 14 2012%

我如何在 VBScript 中做类似的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:50:30.967

使用“*”，因为您正在查找文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T17:27:15.900

尝试类似：

```
Folder = "C:\" 

Set fso = CreateObject("Scripting.FileSystemObject") 
Set fold = fso.GetFolder(folder) 
For Each file in fold.Files 
    If Instr(file, "June") >0 Then
        Response.Write file.name & " got it in filename!"
    End if 
Next 
Set fold = Nothing
Set fso = Nothing 
```

# php - PHP 保护下载管理器

> ID：11036663
> 
> 赞同：0
> 
> 时间：2012-06-14T15:43:02.940
> 
> 标签：php, http, download

我正在为我目前正在处理的一个更大的项目构建一个小型下载模块，并且遇到了一些问题。尽管它非常适合小文件，但当浏览器（任何浏览器）开始下载较大的文件时，它会像任何页面一样简单地加载，然后在最后几秒钟内几乎立即“下载”整个文件（无论大小）。我一遍又一遍地浏览了 HTTP 1.1 标准，并且似乎一直在遵循它们。立即想到的一个想法是 PHP 实际上是在向客户端发送数据的时候。答案应该是脚本运行时 - 我在其他长脚本中使用此原理进行调试。

这是相关的代码（当然还有更多，但这是实际发送标头和输出的地方：

```
header("Content-Type: application/force-download");
header("Content-length: $size");
header('Content-Disposition: attachment; filename="'.$fileData['name'].'"');    
for ($i=0; $i<$size; $i+=$step)
{
    $content = fread($file, $step);
    if ($content === false)
        $content = "";

    echo $content;
}
die(); 
```

有任何想法吗？我有一种感觉，这是一个明显的问题，我长时间盯着这个街区看不到。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:59:31.733

在这里试试这个，如果传递的文件是目录或没有找到，这个函数将返回 false。它还将从文件名中删除空格，以免中断下载。它还可以通过更改来限制下载速度，`1024`它将处理超过 2GB 的文件。

```
<?php 
function download($file){
    if (file_exists($file)) {
        if(is_dir($file)){return false;}
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename="'.str_ireplace(' ','_',basename($file)).'"');
        header('Content-Transfer-Encoding: binary');
        header('Connection: Keep-Alive');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Pragma: public');
        header('Content-Length: '.sprintf("%u", filesize($file)));

        @ob_clean();
        $handle = fopen($file, "rb");
        $chunksize=(sprintf("%u", (filesize($file))/1024));

        set_time_limit(0);
        while (!feof($handle)) {
            echo fgets($handle, $chunksize);
            flush();
        }
        fclose($handle);
        die;
    }else{return false;}
    return;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:09:37.257

只需使用工具，停止重新发明轮子。[pecl_http](http://php.net/manual/fr/function.http-send-file.php)已经存在了一段时间了。

```
<?php
http_send_content_disposition("document.pdf", true);
http_send_content_type("application/pdf");
http_throttle(0.1, 2048);
http_send_file("../report.pdf");
?> 
```

此代码示例快速、健壮，它为您提供多种功能奖励：

*   带宽限制
*   缓存和标头管理
*   部分和可恢复下载

# requirejs - SpineJS 和 RequireJS

> ID：11036665
> 
> 赞同：0
> 
> 时间：2012-06-14T15:43:26.223
> 
> 标签：requirejs, spine.js

我正在使用 require.js 2.0。

我有以下最初由 require 调用的代码：`app.js`

```
requirejs.config({
   paths: {
           app: '..',
           spine: 'spine_src/spine',
           cs: "cs",
   },
   shim: {
        'spine_src/route': {
             deps: ['spine']
         }
    }
});

// Start the main app logic.
requirejs(['cs!app/StartApp_Admin', 'spine','spine_src/route'],
function (StartApp_Admin, Spine, Route) {
{
    new StartApp_Admin(); 
}
}); 
```

以及以下控制器：`StartApp_Admin`

```
define () ->
 class StartApp_Admin extends Spine.Controller
    constructor: ->
        @routes
            "/twitter/:id": (params) ->
                console.log("/users/", params.id)

        Spine.Route.setup() 
```

当我执行应用程序时，我的脊椎路由库文件 ( `route.js`) 中出现以下错误。当我调用 Spine.Route.setup() 时应用程序中断

> 未捕获的类型错误：对象函数（元素）{return element;} 没有方法“扩展”

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T15:13:10.883

让它工作。我不得不使用 require-jquery 库。Jquery 没有正确加载。

[http://requirejs.org/docs/jquery.html](http://requirejs.org/docs/jquery.html)

# security - 显示数据时的安全问题

> ID：11036675
> 
> 赞同：0
> 
> 时间：2012-06-14T15:43:51.623
> 
> 标签：security, encryption

我们是一家产生潜在客户的公司，并且开发了一个应用程序，我们的客户可以在其中管理他们的潜在客户和用户。我们的客户是使用我们的网络应用程序来管理他们的潜在客户的其他公司。

现在我们的客户希望使用我们的 Web 应用程序中的一些数据并将其显示在他们自己的网站上，因此我们开发了一个小型实用程序，在其中添加一些代码行，他们就能够从我们的 Web 应用程序在他们自己的网站上显示他们自己的数据。

现在我的问题是，当有人查看应用程序页面的源代码时，他们可以看到用户凭据，任何人都可以复制粘贴该代码并在浏览器中运行它并可以看到数据。

我们正在尝试做与 AdSense 相同的事情，唯一的区别是 AdSense 在这里显示任何广告，我们将只显示我们客户的数据。

如何停止这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:54:44.713

如果最终用户可以通过查看源查看登录信息，那么听起来您要么在浏览器中进行 ajax 调用，要么使用内联框架。

简短的回答：你无法挽救它。

正确的做法是让您的客户端 Web 服务器向您的 Web 服务器发出调用以提取所需的数据，然后对其进行格式化并将其呈现给浏览器。

这样，登录信息仅在服务器之间共享，最终客户端浏览器不知道它最终来自哪里。

关于 AdSense 的机制：他们真的不在乎任何人都可以单独访问数据。检查一下：他们*喜欢*任何人都可以访问这些数据的想法。这不仅是不安全的信息，他们还希望将其公开。考虑到这一点，他们的解决方案不是您应该追求的。

# java - 在 Java 持久性会话范围内使用 SQL Server 变量？

> ID：11036676
> 
> 赞同：1
> 
> 时间：2012-06-14T15:43:52.970
> 
> 标签：java, sql-server, hibernate, session, scope

我对具有 Java Hibernate 持久性的 MS SQL Server 还很陌生，而且我在会话范围方面遇到了一些问题。我知道 SQL Server 本地（会话）变量的作用域是存储过程或创建它的批处理。

但是当我像这样使用持久性会话时：

```
EntityManager entityManager = entityManagerFactory.createEntityManager();
Session session = entityManager.unwrap( Session.class );
session.createSQLQuery( " declare @bit int; set @bit = 3; " ).executeUpdate();
List obj = session.createSQLQuery( " select @bit; " ).list(); 
```

它抛出一个错误：

```
ERROR: Must declare the scalar variable "@bit". 
```

事实证明，每次执行`createSQLQuery( "..." )`都会创建一个全新的批次。

我的问题是：

是否有机会`createSQLQuery( "...")`在同一个`Session`实例的 1 次以上执行中使用 SQL Server 变量（或临时表）？我想避免创建数据库全局变量以及将临时会话数据存储在一些非临时表中。

提前感谢您的帮助！

# jquery - 带有隐藏溢出的 jQuery UI 可拖动容器

> ID：11036678
> 
> 赞同：1
> 
> 时间：2012-06-14T15:43:55.790
> 
> 标签：jquery, jquery-ui, draggable

我的 ul 比包装器大，我希望能够将它拖到最后一个孩子（包含容器）。

我有这个用于拖动 ul 的代码并且工作正常（没有包含）。

```
$( "#myList" ).draggable({ axis: "x" });​ 
```

这是工作页面：http: [//jsfiddle.net/Kxtvg/](http://jsfiddle.net/Kxtvg/)

但是我需要帮助来限制阻力，如果我使用

```
$( "#myList" ).draggable({ axis: "x", containment: '#width' });​ 
```

它的行为很有趣...... [http://jsfiddle.net/Z9UYA/](http://jsfiddle.net/Z9UYA/)

如何使用隐藏的溢出包装器和包含 div 的 ul 平滑拖动？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T06:14:33.677

尝试将“#width”元素的宽度设置为大于“#myList”元素的宽度，如下所示。

> #width {宽度：1200px; 高度：150px；溢出：隐藏；} #myList {宽度：600px；高度：150px；溢出：隐藏；}

# php - PHP Cookie 将过期时间设置为无

> ID：11036679
> 
> 赞同：3
> 
> 时间：2012-06-14T15:43:56.303
> 
> 标签：php, cookies

我正在设置一个 cookie，但有一些问题。目前cookie格式是这样的：

```
setcookie("company_id", $company_id, 0, '/'); 
```

所以过期时间设置为`0`意味着cookie永远不会过期，但是当我试图不设置任何过期时间时，我在第三个参数中传递了一个空参数，如下所示：

```
setcookie("company_id", $_POST["company_id"], "", '/'); 
```

但这不起作用，cookie没有得到，当我将空参数更改为`0`它而不是开始工作时。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:48:37.787

expire 参数以秒为单位。[设置cookie函数](http://php.net/manual/en/function.setcookie.php)

> 除了 name 参数之外的所有参数都是可选的。您也可以用空字符串 ("") 替换参数以跳过该参数。因为 expire 参数是整数，所以不能用空字符串跳过，请改用零 (0)。

因此，除非您希望它在会话结束时过期，否则您将需要一个非零值。

0 建议 cookie 应在会话结束时过期，如果您希望它“永不过期”，请使用很长时间。

```
setcookie("TestCookie", $value, time()+3600*24*365*10, '/') 
```

例如，那将是十年。

请记住，人们可以经常清除 cookie。所以你的可能会被删除。Cookies 也是特定于浏览器的，因此如果每次都需要存储在其中的数据，那么如果用户切换浏览器，除非您再次设置，否则它将不再可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-14T15:46:15.103

你问错问题了。没有办法将 cookie 设置为不过期；这不是 PHP 限制，它只是不是 cookie 规范的一部分 (http://www.faqs.org/rfcs/rfc2965.html)。

最好的选择是使用遥远的未来日期。例如，要设置一个 20 年后过期的 cookie：

```
setcookie(
  "CookieName",
  "CookieValue",
  time() + (20 * 365 * 24 * 60 * 60)
); 
```

# android - 在 Android ImageView 中使用 if 条件

> ID：11036680
> 
> 赞同：1
> 
> 时间：2012-06-14T15:43:59.313
> 
> 标签：android, button, if-statement, imageview

我正在为 android 开发一个游戏，我将在其中使用随机图像。我的问题是，只要该图像视图中有某个图像（例如，在 中随机生成的 Image1 id `ImageView`），我希望`TextView`显示一条消息，说明 Image1 现在可以在图像视图中看到。我知道可以使用 if 条件来完成，比如`if imageview=imageview1, textview1.settext "blah blah blah"`.

我们怎么能这样做。如果我的问题不清楚，请询问更多详细信息，请求！！！

```
package com.random.image;

import java.util.Random;

import android.app.Activity;

import android.app.AlertDialog;

import android.content.DialogInterface;

import android.os.Bundle;

import android.view.View;

import android.widget.Button;

import android.widget.ImageView;

import android.widget.TextView;

public class RandomImageActivity extends Activity {

    /** Called when the activity is first created. */

private static final Random rgenerator = new Random();

private ImageView iv;

private static final Integer[] mImageIds = 
    { R.drawable.tailss, R.drawable.headss, };

@Override
public void onCreate(Bundle savedInstanceState)

{
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    final TextView t=(TextView) findViewById(R.id.textView1);

    Integer q = mImageIds[rgenerator.nextInt(mImageIds.length)];
    iv = (ImageView) findViewById(R.id.imageView1);
    changeImageResource();

    final Button b=(Button) findViewById(R.id.button1);
    b.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            AlertDialog a=new AlertDialog.Builder(RandomImageActivity.this).create();
            a.setTitle("Flip the Coin");
             a.setMessage("Click the button below to find which side of the coin you got");
             a.setButton("Try Your Luck", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {
                  // here you can add functions

                 changeImageResource();

               }
            });
       a.setIcon(R.drawable.coin);
       a.show();

        }
    });
}

public void changeImageResource()
{

    int i = rgenerator.nextInt(2);
    iv.setImageResource(mImageIds[i]);

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:49:47.213

我假设您是从已知的图像列表中随机选择一个图像。您可以改为定义一个数据结构，将图像 id 与标题字符串的 id 分组：

```
ImageData {
    int imageId;
    int captionId;
} 
```

然后创建这些对象的数组（而不是图像 id 的 int 数组），当您随机选择一个时，使用 imageId 字段加载图像，使用 captionId 加载标题字符串。

编辑

你的代码有这个：

```
private static final Integer[] mImageIds = 
    { R.drawable.tailss, R.drawable.headss, }; 
```

我建议这样做：

```
private static final class ImageData {
    ImageData(int imageId, int captionId) {
        this.imageId = imageId;
        this.captionId = captionId;
    }
    int imageId;
    int captionId;
}

private static final ImageData[] mImageData = {
    new ImageData(R.drawable.tailss, R.string.tailss),
    new ImageData(R.drawable.headss, R.string headss)
}; 
```

然后，在您的代码中，您将执行以下操作：

```
public void changeImageResource()
{
    int i = rgenerator.nextInt(mImageData.length);
    ImageData data = mImageData[i];
    iv.setImageResource(data.imageId);
    t.setText(getString(data.captionId));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:25:44.710

只需在 ImageView 上使用 setTag 和 getTag 方法，然后执行条件语句。不需要额外的数据结构。

例子。

```
imageView.setImageResource(mImageIds[i]);
imageView.setTag(mImageIds[i]); 
```

然后做

```
if(imageView.getTag().equals(String.valueOf(mImageIds[i]))
{
    textView.setText("blabla");
} 
```

甚至更好

```
imageView.setImageResource(mImageIds[i]);
imageView.setTag(mImageIds[i]); 
```

然后

```
switch(Integer.valueOf(imageView.getTag()){
    case R.drawable.id1: textView.setText("bla1"); break;
    case R.drawable.id2: textView.setText("bla2"); break;
} 
```

# android - 如何使用phonegap（1.8.0）检测网络isReachable

> ID：11036684
> 
> 赞同：2
> 
> 时间：2012-06-14T15:44:06.177
> 
> 标签：android, cordova

我正在使用phonegap1.8.0，我想检测网络是否可用，然后是否可以到达。在 phonegap[文档](http://docs.phonegap.com/en/0.9.6/phonegap_network_network.md.html#Network)中公开以下 api

```
navigator.network.isReachable('www.facebook.com', reachCallBack, {}); 
```

但是，我得到了

```
Console(4820): Uncaught TypeError: Object #<Object> has no method 'isReachable' at file:///android_asset/www/index.html:71 
```

代码是：

```
 function netIsAvailable()
{
    var reachCallBack = function (reachability)
    {

        var networkState = reachability.code || reachability;

        var states = {};
        states[NetworkStatus.NOT_REACHABLE]                      = 'No network connection';
        states[NetworkStatus.REACHABLE_VIA_CARRIER_DATA_NETWORK] = 'Carrier data connection';
        states[NetworkStatus.REACHABLE_VIA_WIFI_NETWORK]         = 'WiFi connection';

        alert('Connection type: ' + states[networkState]);

    };
    alert(  navigator.onLine );
    navigator.network.isReachable('www.facebook.com', reachCallBack, {});
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:42:32.220

该`isReachable`功能自 v1 起已弃用，现在您必须使用`connection`或网络事件来执行类似的逻辑。

[连接信息](http://docs.phonegap.com/en/1.8.0/cordova_connection_connection.md.html#Connection)

[线上/线下活动](http://docs.phonegap.com/en/1.8.0/cordova_events_events.md.html#online)

更多详情请参考此[群帖](https://groups.google.com/d/msg/phonegap/Ez4nwwZaDXw/eJxjsxwP39IJ)

# vim - 如何使用修改 NERDCommenter 的行为来评论选定的 *ALL* 行

> ID：11036685
> 
> 赞同：1
> 
> 时间：2012-06-14T15:44:09.967
> 
> 标签：vim

在 Vim 中，当我使用 NERDCommenter 注释多行可视选择时，选择中的空白行不会被注释。在下面的示例中，我选择了所有 5 行并键入“\cl”（用于 NERDCommenterAlignLeft），但没有注释的第 3 行是空白的。

前：

```
" Normalize Markdown : Remove Trailing # From Headers
nnoremap <Leader>qq :%s/ \+#\+ *$//gc<CR>

" Normalize Markdown : Remove Trailing Whitespace
nnoremap <Leader>qw :%s/\s\+$//gc<CR> 
```

后：

```
" " Normalize Markdown : Remove Trailing # From Headers
" nnoremap <Leader>qq :%s/ \+#\+ *$//gc<CR>

" " Normalize Markdown : Remove Trailing Whitespace
" nnoremap <Leader>qw :%s/\s\+$//gc<CR> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T14:11:35.827

这就是它在 NERDCommenter 插件中的实现方式。如果您打开插件文件 (NERD_commenter.vim) 并查找名为 的函数`s:CanCommentLine`，您将看到它具有以下检查：

```
" make sure we don't comment lines that are just spaces or tabs or empty.
if theLine =~ "^[ \t]*$"
    return 0
endif 
```

因此，在插件继续注释一行之前，它会检查它是否为空行。如果是这样，插件不会评论它并跳到下一行。

一个快速修复方法是简单地从插件文件中删除这部分代码。

# c++ - 解决整数背包问题

> ID：11036689
> 
> 赞同：9
> 
> 时间：2012-06-14T15:44:28.520
> 
> 标签：c++, algorithm, dynamic-programming, knapsack-problem

我是动态编程的新手，并在 SPOJ [(http://www.spoj.pl/problems/KNAPSACK/](http://www.spoj.pl/problems/KNAPSACK/) ) 尝试过整数背包问题。但是，对于给定的测试用例，我的解决方案没有给出正确的输出。如果您能建议我的以下实施是否正确，我将不胜感激。请注意，该变量`back`用于回溯，我不知道该怎么做。我也希望在实施回溯方面得到您的帮助。谢谢。

```
#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <vector>
#include <string>
#include <iostream>

using namespace std;

int knapsack(int value[], int weight[], int n, int C,
         vector < int >&back)
{
    int *M = new int[C + 1];
    int k;
    int i, j, tmp, pos;
    for (i = 1; i <= C; i++) {
        M[i] = M[i - 1];
        pos = i - 1;
        for (j = 0; j < n; j++) {
            k = i - weight[j];
            if (k >= 0)
                tmp = M[k] + value[j];
            if (tmp > M[i]) {
                M[i] = tmp;
            }
        }
        back.push_back(pos);
    }
    int ans = M[C];
    delete[]M;
    return ans;
}

int main()
{
    int C, N;
    cin >> C >> N;
    int* value = new int[N+1];
    int* weight = new int[N+1];
    for ( int i = 0; i <= N; i++) {
        cin>>value[i]>>weight[i];
    }
    vector < int >back(N, 0);
    cout<<knapsack(value,weight,N,C,back)<<endl;
    return 0;
} 
```

以下是正确的输入/输出测试用例：

```
Input:
4 5
1 8
2 4
3 0
2 5
2 3

Output:
13 
```

但是，我得到的输出是`17`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T21:42:15.043

这是被称为 0-1 背包的背包问题的一个版本。

您在代码中犯了一些愚蠢的错误。

首先输入的第一个整数是权重，第二个是值。当您将第一作为价值，第二作为重量时。此外，您将 n+1 值作为输入 0 到 N 包括在内。

现在在您的算法中，您正在考虑可以携带任意数量的物品副本，这是不正确的，这是一个 0-1 背包。阅读此[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)。

我想出了这个算法，我提交并被接受了。所以这应该可以正常工作。

```
int M[2000][2000];
int knapsack(int value[], int weight[], int C, int n)
{      
  for(int i = 1; i <= C; i++){
    for(int j = 0; j <n; j++){
      if(j > 0){
        M[j][i] = M[j-1][i];
        if (weight[j] <= i)
          M[j][i] = max(M[j][i], M[j-1][i-weight[j]]+value[j]);
      }
      else{
        M[j][i] = 0;
        if(weight[j] <= i)
          M[j][i] = max(M[j][i], value[j]);
      }
    }
    //    cout << M[i][n-1] << endl;
  }        
  return M[n-1][C];
}  

int main()
{
    int C, N;
    cin >> C >> N;
    //    cout << C << endl;
    int* value = new int[N+1];
    int* weight = new int[N+1];
    for ( int i = 0; i < N; i++) {
        cin>>weight[i]>>value[i];
    }
    //   vector < int >back(N, 0);
    cout<<knapsack(value,weight,C,N)<<endl;
    return 0;
} 
```

顺便说一句，不要动态分配数组，只需使用向量

```
vector <int> My_array(n); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T16:05:48.060

在 Python中的[https://sites.google.com/site/mikescoderama/Home/0-1-knapsack-problem-in-p](https://sites.google.com/site/mikescoderama/Home/0-1-knapsack-problem-in-p)中有一个版本的背包问题有很好的记录。

编辑：没关系，我跳过了第一行输入定义 C 和 N 的部分。也就是说，您的输入示例似乎没有加载您提供的代码（由于<= N)。我希望循环应该是 < N，以获得 0..n-1 作为项目。

修复我得到 134516145 打印的结果，这是荒谬的。

# java - Java - 我是否可以反思地找出我是否从一个 catch 块中的函数中被调用以获得部分异常？

> ID：11036694
> 
> 赞同：3
> 
> 时间：2012-06-14T15:44:50.343
> 
> 标签：java, reflection

首先，在我被骂之前，我想澄清一点：我没有计划编写任何会使用这种控制流的代码；它显然很糟糕。忘记一个用例，这更像是一个关于它是否可能的问题：

我想知道是否有可能知道调用堆栈的某个地方是否正在为特定异常在 catch 块中调用函数。

假设我有一个功能：

```
foo() {
try {
    something
}
catch (SuperException s) {
    bar()
} 
```

因此，如果无法控制 bar 的方法签名，并且给定的 bar 也被许多其他函数调用，那么如果在 catch 块中调用捕获超级异常， bar 的行为会有所不同吗？（不，被 foo 调用不是充分条件，它是最重要的超级例外）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:50:59.373

您可以查看调用堆栈并获取每个调用的行号。

您可以读取字节码以确定 catch 块的位置以及这些块中的哪些代码行。

将两者匹配在一起以查看调用堆栈中的任何位置是否位于 catch 块中。

注意：这仅在您的代码中编译了调试信息时才有效。

# wordpress - 奇怪的 CSS 背景图像调整大小

> ID：11036695
> 
> 赞同：0
> 
> 时间：2012-06-14T15:44:55.403
> 
> 标签：wordpress, css, background, background-image

我的一个 Wordpress 登录页面上有一个自定义背景图像。升级到最新版本后，这个背景图像现在被压扁了，看起来很糟糕。

我在 CSS 中找不到任何问题 - 也许有某种类型的 background-width 或 background-height 属性？但是，如果有人能弄清楚那将是多么不可思议！

这是登录页面的链接：http: [//www.destinyislands.com/wp-login.php](http://www.destinyislands.com/wp-login.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:51:01.723

是的，在 wp-admin/css/wp-admin.css 中有一个新的 css 文件。

.login h1 a 元素的背景尺寸为 274px 63px。摆脱那条线，它看起来很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T15:48:25.977

你有一个背景尺寸属性“背景尺寸：274px 63px;” 如果删除它，则可以修复该图像。

或者添加这个来覆盖 wp-admin.css

```
background-size: 330px 128px; 
```

# windows - 通过 Windows 机器在 Mac OS X 上远程工作

> ID：11036696
> 
> 赞同：0
> 
> 时间：2012-06-14T15:44:58.337
> 
> 标签：windows, macos, remote-desktop

我有我的开发人员 Mac OS X 机器在我的工作。我家里有 Windows 机器。我如何通过留在家里的 Windows 机器在我的 Mac OS X 机器上远程工作？我的意思是有人可以建议我一个好的远程免费或付费程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:45:42.577

使用 VNC，很棒的软件并且可以跨平台工作。VNC 应该已经在 mac 上可用，只需启用它。在 Windows 上，您可以使用 RealVNC 提供的免费 VNC-Viewer。谷歌是你的朋友 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-21T07:04:33.577

与 Ryan 类似，我尝试从[https://www.realvnc.com/products/select/macosx/windows/下载 realvnc](https://www.realvnc.com/products/select/macosx/windows/)

在执行以下步骤后，我能够让它运行：

下载适用于 Windows 的 VNC 查看器（我使用的是 windows 10 联想笔记本电脑）下载适用于 mac 的 VNC 查看器和 VNC 服务器（我使用的是 Mac Mini）两台机器都在同一个网络上。

然后，在设置 VNC 服务器时，我不得不在 Mac Mini 上进行一些小配置。我不得不改变端口。这很简单，只需要 2 分钟，因为安装向导对此有所帮助。

在mac上安装并在PC上安装后，PC问我服务器名称。这在 VNC 服务器的“诊断”选项卡中可用。(知识产权)

在您将其输入 PC 后，它会提示您输入凭据，这对您有好处。希望这可以帮助。:)

对我来说，整个任务是确保我可以从 PC 笔记本电脑启动 XCode。

# forms - 验证器函数在文本字段中被触发两次

> ID：11036700
> 
> 赞同：4
> 
> 时间：2012-06-14T15:45:15.630
> 
> 标签：forms, validation, extjs, textfield, extjs4.1

以下代码使用 ExtJs 中文本字段的验证器配置：

```
Ext.onReady(function(){
    Ext.create('Ext.form.Panel', {
        title: 'Simple Form',
        width: 350,
        url: 'save-form.php',
        layout: 'anchor',
        defaults: {
            anchor: '100%'
        },
        defaultType: 'textfield',
        items: [{
            fieldLabel: 'First Name',
            validateOnBlur:true,//calling validator on blur
            validateOnChange:false,//not calling validator on change
            validator:function(){
                console.log('in validator');//printing to console whenever validator is called
                return true;
            }
        }],
        renderTo: Ext.getBody()
    });
}); 
```

在代码中，validateOnBlur 设置为 true，而 validateOnChange 设置为 false。

问题是，当用户第一次聚焦该字段并模糊时，验证器函数会被触发两次，如随附的屏幕截图所示。

如果用户第二次再次聚焦该字段并模糊，则验证器只会被触发一次，并且对于所有后续此类操作也是如此。

但是第一次，当用户聚焦该字段并模糊（通过鼠标单击或 Tab 退出）时，验证器函数会被触发两次。

任何人都可以指导这背后的可能原因是什么以及如何阻止这种情况，或者这是 ExtJs 4.1 版中的错误？

提前致谢

![在此处输入图像描述](../Images/863db045f19f769b053736128019158d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T07:19:20.350

我认为这将解决您的问题...模糊的工作方式不同..您可以使用模糊而不是更改，看看会发生什么以及您想要什么

```
items: [{
    fieldLabel: 'First Name',
    validateOnBlur: true, 
    listeners: {
        change: function (){
            console.log('in validator');
            return true;
        }
    }
}] 
```

# r - 在 [r] 中使用 mclapply、foreach 或其他东西并行操作对象？

> ID：11036702
> 
> 赞同：3
> 
> 时间：2012-06-14T15:45:18.923
> 
> 标签：r, memory, foreach, parallel-processing, fork

有没有办法`R`并行操作一个对象？我了解`mclapply`在`parallel`fork 进程中并将工作区内容复制到每个进程。相反，我希望让我的核心在一个对象上执行独立的工作，而不必拆分和组合结果。一个用例是将`numeric`data.frame 中的所有列`factor`并行更改为列。另一个用例是 data.frame 中具有大量级别的分箱因子。我尝试这样做的主要原因是 1）避免内存不足和 2）提高速度。

下面，object`b`是在 data.frame 中拆分列，`a`然后在 apply 后合并它们的结果`factor`。相反，我想直接对 object 进行操作`a`。在串行中，作为循环的副作用，我能够将列转换`a`为类型。同时，作为副作用，我无法将 的列转换为类型，因为（据我所知）内部的,指的是每个衍生进程的本地对象。`factor``foreach...%do%``a``factor``foreach...%dopar%``a`

里面有没有`R`可以让我这样做的包？

```
a <- data.frame(b=c(1,1,2,2), c=c(2,2,3,3))
str(a)

> str(a)
'data.frame':   4 obs. of  2 variables:
 $ b: num  1 1 2 2
 $ c: num  2 2 3 3

#serial
b <-
  foreach (i = iter(1:ncol(a)), .combine = data.frame) %do% {
    a[,i] <- factor(a[,i])
  }
str(a)
str(b)

> str(a)
'data.frame':   4 obs. of  2 variables:
 $ b: Factor w/ 2 levels "1","2": 1 1 2 2
 $ c: Factor w/ 2 levels "2","3": 1 1 2 2
> str(b)
'data.frame':   4 obs. of  2 variables:
 $ result.1: Factor w/ 2 levels "1","2": 1 1 2 2
 $ result.2: Factor w/ 2 levels "2","3": 1 1 2 2

#parallel
a <- data.frame(b=c(1,1,2,2), c=c(2,2,3,3))
b <-
  foreach (i = iter(1:ncol(a)), .combine = data.frame) %dopar% {
    a[,i] <- factor(a[,i])
  }
str(a)
str(b)

> str(a)
'data.frame':   4 obs. of  2 variables:
 $ b: num  1 1 2 2
 $ c: num  2 2 3 3
> str(b)
'data.frame':   4 obs. of  2 variables:
 $ result.1: Factor w/ 2 levels "1","2": 1 1 2 2
 $ result.2: Factor w/ 2 levels "2","3": 1 1 2 2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:20:50.793

首先，您必须知道 R 是 (generally) `call by value`，因此无论您做什么，最终都会得到数据框的临时副本。这也适用于 apply 系列的普通版本。一旦你改变了函数内部的东西，首先复制对象。

这就是说，`mclapply`不会将完整的工作区内容复制到子进程。据我了解，这些进程共享相同的内存内容，并且仅在对其进行修改后才复制内容。无论如何，这或多或少地归结为 R 所做的事情。

如果您仍然不相信这一点，您可以使用集群方法并尝试`parLapply`和朋友一起从`parallel`包中。这不是基于分叉，而是基于节点集群。您可以在此处将您的核心视为节点。在这种情况下，您必须使用`clusterExport()`. 我不确定这一点，但我怀疑这确实会创建一个副本。对于其余部分，`parLapply`仅将其处理的元素复制到不同的集群。同样，这与`lapply`默认情况下的相同。

使用您的数据框`a`，您可以执行以下操作：

```
> require(parallel)
> cl <- makeCluster(2)
> b <- parLapply(cl,a,as.factor)
> str(as.data.frame(b))
'data.frame':   4 obs. of  2 variables:
 $ b: Factor w/ 2 levels "1","2": 1 1 2 2
 $ c: Factor w/ 2 levels "2","3": 1 1 2 2
> stopCluster(cl) 
```

# android - 制作 Http 获取和发布请求

> ID：11036706
> 
> 赞同：1
> 
> 时间：2012-06-14T15:45:26.457
> 
> 标签：android, eclipse, web-services, http

我是 android 编程的新手，我正在尝试开发一个调用此 Web 服务的应用程序，传递值并以 xml 的形式获得返回，但每次发出请求时，我都会得到一个返回，因为数据输入无效。我尝试通过 Http get And Post 进行操作，但两者都没有工作。网址如下，

[http://hiscentral.cuahsi.org/webservices/hiscentral.asmx?op=GetSeriesCatalogForBox2](http://hiscentral.cuahsi.org/webservices/hiscentral.asmx?op=GetSeriesCatalogForBox2)

代码是，

```
HttpGet:

public class Main extends Activity implements OnClickListener   
{
 String xml=null;
 String responseBody;
 String text = null;
 @Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    findViewById(R.id.my_button).setOnClickListener(this);
}

public void onClick(View arg0) 
{
    Button b = (Button)findViewById(R.id.my_button);
    b.setClickable(false);
    new LongRunningGetIO().execute();
}

private class LongRunningGetIO extends AsyncTask <Void, Void, String> 
{

    @Override
    protected String doInBackground(Void... params) 
    {

try 
         {
        HttpClient httpclient = new DefaultHttpClient();  
         HttpContext localContext = new BasicHttpContext();
         HttpGet httpGet = new     HttpGet("http://hiscentral.cuahsi.org/webservices/hiscentral.asmx/GetSeriesCatalogForBox2?xmin=-100 &xmax=-90 &ymin=40 &ymax=55 &conceptKeyword=precipitation &beginDate=1/1/2009&endDate=1/1/2010 HTTP/1.1");
         HttpResponse response = httpclient.execute(httpGet, localContext);
          HttpEntity entity = response.getEntity();
          text = getASCIIContentFromEntity(entity);
         } 

         catch (Exception e) 
         {
             return e.getLocalizedMessage();
         }
         return text;
    }   

     catch (ClientProtocolException e)
                     {
                         e.printStackTrace();
                     } 
                     catch (IOException e)
                     {
                         e.printStackTrace();
                     }

                 } 
             catch (UnsupportedEncodingException e)
             {
              e.printStackTrace();
              }
             return responseBody;
    }
      protected void onPostExecute(String results) 
                    {
                        if (results!=null) 
                        {
                            EditText et = (EditText)findViewById(R.id.my_edit);
                            et.setText(results);
                        }
                        Button b = (Button)findViewById(R.id.my_button);
                        b.setClickable(true);
                    }
                }
            } 
```

而 HttpPost 是，

```
HttpPost
public class Main extends Activity implements OnClickListener   
{
String xml=null;
String responseBody;
String text = null;
@Override
public void onCreate(Bundle savedInstanceState) 
{
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
findViewById(R.id.my_button).setOnClickListener(this);
}

public void onClick(View arg0) 
{
Button b = (Button)findViewById(R.id.my_button);
b.setClickable(false);
new LongRunningGetIO().execute();
}

private class LongRunningGetIO extends AsyncTask <Void, Void, String> 
{

@Override
protected String doInBackground(Void... params) 
{
 HttpClient httpclient = new DefaultHttpClient();   
         String Url = "http://hiscentral.cuahsi.org/webservices/hiscentral.asmx?op=GetSeriesCatalogForBox2";
         if(!Url.endsWith("?"))
         {
                Url += "?";
         }
         HttpPost httppost = new HttpPost(Url); 
             // Add data   

             List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(5);   
             nameValuePairs.add(new BasicNameValuePair("xmin", "-100"));
             nameValuePairs.add(new BasicNameValuePair("xmax", "-90"));
             nameValuePairs.add(new BasicNameValuePair("ymin", "40"));
             nameValuePairs.add(new BasicNameValuePair("ymax", "55"));
             nameValuePairs.add(new BasicNameValuePair("networkIDs", ""));
             nameValuePairs.add(new BasicNameValuePair("conceptKeyword", "precipitation"));
             nameValuePairs.add(new BasicNameValuePair("beginDate", "1/1/2009"));
             nameValuePairs.add(new BasicNameValuePair("endDate", "1/1/2010"));
             try 
             {         
                      httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                     //  Log.d("myapp", "works till here. 2"); 
                      HttpResponse response = httpclient.execute(httppost);
                      responseBody = EntityUtils.toString(response.getEntity());
                     //    Log.d("myapp", "response " + response.getEntity());
                     // HttpEntity entity = response.getEntity();
                      //   xml = getASCIIContentFromEntity(entity);
                     } 
                     catch (Exception e) 
                     {
                         return e.getLocalizedMessage();
                     }
             return responseBody;
    }

                     protected void onPostExecute(String results) 
                    {
                        if (results!=null) 
                        {
                            EditText et = (EditText)findViewById(R.id.my_edit);
                            et.setText(results);
                        }
                        Button b = (Button)findViewById(R.id.my_button);
                        b.setClickable(true);
                    }
                }
            } 
```

请帮忙 ！！提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:57:32.580

您在 HttpGet 中缺少**networkIDs参数，因此请尝试以下操作：**

```
 http://hiscentral.cuahsi.org/webservices/hiscentral.asmx/GetSeriesCatalogForBox2?xmin=-100&xmax=-90&ymin=40&ymax=55&conceptKeyword=precipitation&
networkIDs=YOUR_NETWORK_IDS&beginDate=1/1/2009&endDate=1/1/2010 
```

代替

```
 http://hiscentral.cuahsi.org/webservices/hiscentral.asmx/GetSeriesCatalogForBox2?xmin=-100&xmax=-90&ymin=40&ymax=55&
conceptKeyword=precipitation&beginDate=1/1/2009&endDate=1/1/2010%20HTTP/1.1 
```

并在 **HttpPost**中将您的网址更改为：

```
String Url = "http://hiscentral.cuahsi.org/webservices/hiscentral.asmx/GetSeriesCatalogForBox2"; 
```

# jquery - jQuery ui un-hover 并不总是触发

> ID：11036715
> 
> 赞同：1
> 
> 时间：2012-06-14T15:45:57.877
> 
> 标签：jquery, jquery-ui

所以我在一个列表中有几个东西，当我将鼠标悬停在它们上时，我有一组应该显示的按钮，当我将鼠标悬停在它上面时会再次隐藏。到目前为止，我为此编写的 jQuery 看起来像这样：

```
 $('li.mine > div').hover(function () {
        $(this).children('span.button-pane').stop().show('clip', 200);
    }, function () {
        $(this).children('span.button-pane').stop().hide('clip', 200);
    }); 
```

如果用户将鼠标悬停，然后完全移出，这将非常有用。但是，如果用户将鼠标直接移动到 li.mine 的另一个 div 子项，它会显示新按钮并且不会隐藏旧按钮。我怎样才能得到它，以便在显示新按钮窗格之前隐藏上一个按钮窗格？

编辑：这是一些 HTML

```
<li id="list_g236c167c6515484db1a424867cdcb2cb" class="group mine ">
    <div>
        <span class="itemText" data-bind="textToTextbox: Description">Random Group A</span>
        <span class="button-pane align-right" style="float: right; display: block; ">
        <img onclick="JOURNAL.functions.deleteItem(this)" class="float-right hand-cursor delete-button" src="/Content/images/deletered.png" height="18" width="18">    
            <img data-bind="reminderModal: Reminder" class="float-right hand-cursor reminder-button" src="/Content/images/reminder.png">
        </span>
    </div>
    <ol>
        <li id="list_oc647c84fba4c4f5d91f8fdeccb538811" class="no-nest mine ">
            <div>
                <span class="itemText" data-bind="textToTextbox: Description">Random Objective 1</span>
                    <span class="button-pane align-right" style="float: right; ">
                    <img onclick="JOURNAL.functions.deleteItem(this)" class="float-right hand-cursor delete-button" src="/Content/images/deletered.png" height="18" width="18">    
                </span>
                <input type="text" style="display:none" class="itemTextBox">
            </div>
       </li>

       <li id="list_o42c8f0ab4839468b86996f3a3fcff4fa" class="no-nest mine ">
            <div>
                <span class="itemText" data-bind="textToTextbox: Description">Random Objective 2</span>
                <span class="button-pane align-right" style="float: right; display: block; ">
                <img onclick="JOURNAL.functions.deleteItem(this)" class="float-right hand-cursor delete-button" src="/Content/images/deletered.png" height="18" width="18">    
                </span>
                <input type="text" style="display:none" class="itemTextBox">
            </div>
       </li>

    </ol>
</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:32:38.450

问题是因为跨度仍在动画中。jQuery 在动画时使用 ui-effects-wrapper 类将 pan 粘贴到另一个 span 中。所以，如果它仍然是动画，我们需要捕捉到这个事实，并将其隐藏在 ui-effects-wrapper 下，如下所示：

```
$('li.mine > div').hover(function () {
        if ($(this).children('.ui-effects-wrapper').length > 0) { // we're still animating!
            $(this).children('.ui-effects-wrapper').children('span.button-pane').show('clip', 200);
        }
        $(this).children('span.button-pane').stop().show('clip', 200);
    }, function () {
        if ($(this).children('.ui-effects-wrapper').length > 0) { // we're still animating!
            $(this).children('.ui-effects-wrapper').children('span.button-pane').hide('clip', 200);
        }
        $(this).children('span.button-pane').stop().hide('clip', 200);
    }); 
```

# javascript - 智能设置div宽度

> ID：11036716
> 
> 赞同：1
> 
> 时间：2012-06-14T15:46:02.183
> 
> 标签：javascript, jquery, css, layout, html

一段时间以来，我一直在尝试找到一种方法，以`<div>`一种有吸引力的方式根据其内容设置 a 的宽度。我希望能够`<div>`根据段落中有多少单词，每隔一段时间告诉他们换行。例如，如果是一个 300 字的长段落，那么宽度是 500 像素，并且分成多少行，但如果是 10 个字，它只有 100 像素宽，并且分成两行？

我并不迫切需要它，但我已经放弃了谷歌搜索，并且很好奇这里是否有人有任何想法。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-14T19:06:20.793

也许你可以使用这个小脚本（垂直移动鼠标）。它最初是很久以前用 ActionScript2 编写的。

[http://jsfiddle.net/DXvXy/3/](http://jsfiddle.net/DXvXy/3/)

```
/*
outerNode : block element with a helper wrapper element inside
Fiddles with the width of outerNode until it reaches desired height (maxH)
Width is limited between minW and maxW
*/
var fitToHeight = function( outerNode, minW, maxW, maxH ){
    var L,H,A; // Lo,Hi,Actual width for binary search
    var $set = $(outerNode);       // new width will be applied to the outer node
    var $get = $($set).children(); // actual width / height readout

    // Set initial width to the longest non-wrapping word (
    $set.width( minW );
    L = H = Math.min( maxW, Math.max( minW, $get.width())); // longest word

    // grow the width until height falls below maxH
    while( $get.height() > maxH && H < maxW ){
        // remember the width of the last too high box: it will be the lower limit for bin.search
        L = H;
        H = Math.min( H*2, maxW ); // limited grow of upper limit
        $set.width( H );
    }
    H = Math.min( maxW, $get.width() );

    // binary search for the ideal width where height just falls below maxH
    do{
        A = Math.round( ( H + L )/2 );
        $set.width( A );
        if( $get.height() > maxH ) L=A; else H=A;
    }while( H - L > 1 );

    // width might be smaller by a subpixel, so increment it to guarantee maximum height
    if( $get.height() > maxH )
        $set.width( A+1 );

    // set block's height if necessary
    $set.height( maxH );
};

jQuery.fn.fitToHeight = function( minW, maxW, maxH ){
    this.each(function(){
        fitToHeight( this, minW, maxW, maxH );
    });
} 
```

​</p>

# c# - 与实体框架的多个一对多关系

> ID：11036720
> 
> 赞同：5
> 
> 时间：2012-06-14T15:46:18.883
> 
> 标签：c#, entity-framework, orm, entity-framework-4.1, entity-relationship

我正在使用 EntityFramework 4.1。

我有以下模型：

```
public class User 
{
   [Key]
   public int Id { get; set; }
   public string Username { get; set; } 
   public string Password { get; set; }

   public virtual User Creator { get; set; }
   public virtual User LastEditor { get; set; }
} 
```

当我尝试生成我的数据库时，我收到了这个错误：

> 无法确定类型“用户”和“用户”之间关联的主体端。此关联的主体端必须使用关系流式 API 或数据注释显式配置。

但我也有这个类：

```
public class Course 
{
   [Key]
   public int Id { get; set; }
   public string Name { get; set; } 

   public virtual User Creator { get; set; }
   public virtual User LastEditor { get; set; }
} 
```

它工作正常，我生成了这些外键：

```
Creator_Id
LastEditor_Id 
```

我是否需要在我的用户模型中添加任何内容以使其正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T16:08:41.420

EF 尝试 - 按照惯例 - 在 和 之间创建一对一的关系`User.Creator`，`User.LastEditor`因为它们都引用`User`它们自己所在的`Course`类。类的情况并非如此。For`Course.Creator`和`Course.LastEditor`EF 创建了两个与`User`. 为了实现相同的属性，`User`您必须配置与 Fluent API 的关系：

```
modelBuilder.Entity<User>()
    .HasOptional(u => u.Creator)     // or HasRequired
    .WithMany();

modelBuilder.Entity<User>()
    .HasOptional(u => u.LastEditor)  // or HasRequired
    .WithMany(); 
```

# javascript - 如何将 JavaScript forEach 循环/函数转换为 CoffeeScript

> ID：11036721
> 
> 赞同：32
> 
> 时间：2012-06-14T15:46:21.043
> 
> 标签：javascript, foreach, coffeescript, d3.js, crossfilter

**背景**：我正在尝试将一些使用带有[D3.js](http://d3js.org/)数据可视化库的[Crossfilter库的 JavaScript 代码转换为](https://github.com/square/crossfilter)[CoffeeScript](http://coffeescript.org/)。

将 JavaScript forEach 循环/函数转换为 CoffeeScript 的最佳方法是什么？

这是 JavaScript 代码：

```
// A little coercion, since the CSV is untyped.
flights.forEach(function(d, i) {
    d.index = i;
    d.date = parseDate(d.date);
    d.delay = +d.delay;
    d.distance = +d.distance;
}); 
```

CoffeeScript 可以在循环中执行内联函数吗？现在我猜我需要把它分解成一个函数和循环：

```
coerce = (d) ->
     d.index    = 1
     d.date     = parseDate(d.date)
     d.delay    = +d.delay
     d.distance = +d.distance

coerce(flights) for d in flights 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-14T15:51:08.963

使用*理解*

```
for d, i in flights
  console.log d, i 
```

上面的代码转换为

```
var d, i, _i, _len;

for (i = _i = 0, _len = flights.length; _i < _len; i = ++_i) {
  d = flights[i];
  console.log(d, i);
} 
```

所以你可以看到`d`并`i`成为你想要的样子。

[转到此处](http://coffeescript.org/)并搜索“forEach”以获取一些示例。

最后，查看第一条评论以获得更多有用的信息。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-14T15:53:54.560

直接翻译是：

```
flights.forEach (d, i) ->
  d.index = i
  d.date = parseDate(d.date)
  d.delay = +d.delay
  d.distance = +d.distance 
```

或者您可以使用惯用的版本：

```
for d,i in flights
  d.index = i
  d.date = parseDate(d.date)
  d.delay = +d.delay
  d.distance = +d.distance 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-25T00:10:40.557

forEach 具有将每次迭代包装在闭包中的优点。因此异步调用可以保留正确的值。这样做的咖啡脚本方式（没有实际使用forEach）是

```
for d,i in flights
  do (d, i)->
    d.index = i
    d.date = parseDate(d.date)
    d.delay = +d.delay
    d.distance = +d.distance 
```

这编译为与 OP 的示例非常相似的东西：

```
_fn = function(d, i) {
  d.index = i;
  d.date = parseDate(d.date);
  d.delay = +d.delay;
  return d.distance = +d.distance;
};
for (i = _i = 0, _len = flights.length; _i < _len; i = ++_i) {
  d = flights[i];
  _fn(d, i);
} 
```

如果您需要 < ie9 支持，请使用此功能（IE 开始版本 9 支持 forEach）

# java - 在类路径中找不到任何 META-INF/persistence.xml 文件

> ID：11036723
> 
> 赞同：0
> 
> 时间：2012-06-14T15:46:30.673
> 
> 标签：java, hibernate, maven, struts2, persistence

我正在使用 Struts 和 Cassandra DB 创建一个 Java Web 应用程序。这篇文章不是我的配置所独有的，因为许多 API/ORM 都在使用 persistence.xml。

所以，我已经建立了 1 个项目，我只是在我的数据库中插入/删除/更新/读取。对于这个项目，我需要 persistence.xml 并且运行良好。

但是现在，我加入了 2 个项目，并创建了一个 build.xml 用于在 tomcat 6 中创建我的项目。我将 /META-INF/persistence.xml 放在以下文件夹中：WEB-INF WEB-INF/ressources /

感谢您的帮助，对不起我的英语不好

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:50:12.727

简短的回答：

把它放在 WEB-INF/classes，而不是 WEB-INF/ressources

# jquery-ui - 使用 jQuery UI 在空的可排序中显示占位符文本

> ID：11036724
> 
> 赞同：4
> 
> 时间：2012-06-14T15:46:30.677
> 
> 标签：jquery-ui, jquery-ui-sortable, jquery-ui-draggable

是否有适当的非 hacky 方式在空的可排序中添加占位符文本？我不是指当您将项目拖到排序标签上时显示的占位符空白。我的意思是像“将物品放到这里”这样的文字。仅在列表为空时显示。

我试图显示我自己的占位符元素，但我未能正确更新它的可见性，因为当我将连接的可拖动对象拖入可排序对象时，jQuery UI 不会向我发送任何结束或结束事件。

编辑：示例代码：http: [//jsfiddle.net/RRnD8/](http://jsfiddle.net/RRnD8/)

出于某种原因，在此示例代码中，该`over`事件被触发。`out`仍然没有。但在实际代码中，我可以使用`change`而不是`over`.

编辑2：嗯，`out`事件*被*触发。但它是在拖动元素从可排序元素中移除之前触发的。我通过以下方式解决了这个问题：

```
e.sortable({out: function () {
    setTimeout(realOutHandler.bind(this), 0);
}}); 
```

有没有更清洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T16:26:33.803

使用`over`事件隐藏占位符文本，使用`out`事件显示它，以及`stop`删除它的方法。

```
$("#sortable").sortable({
    revert: true,
    over: function() {
        $('.placeholder').hide();
    },
    out: function() {
        $('.placeholder').show();
    },
    stop: function() {
        $('.placeholder').remove();
    }
});
$("#draggable").draggable({
    connectToSortable: "#sortable",
    helper: "clone",
    revert: "invalid"
}); 
```

**现场示例**- [http://jsfiddle.net/JfGxy/2/](http://jsfiddle.net/JfGxy/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-24T16:08:11.203

SASS方式：

```
#sortable
   &:empty {
      padding: 0;
      min-height: 50px;
      z-index: 999;
      margin-bottom: 10px;
      margin-right: 25px;
      border: 4px dashed #CCC;
      background-color: #F5F5F5;

      &:after {
        color: #888;
        content: "Drop items here";
        display: block;
        min-height: inherit;
        line-height: 50px;
        text-align: center;
        font-size: 18px;
        font-weight: 700;
   }
} 
```

# php - PHP 不为我的表单验证显示错误消息

> ID：11036736
> 
> 赞同：0
> 
> 时间：2012-06-14T15:47:06.527
> 
> 标签：php, validation

我不明白为什么该变量`$errorMessage`不会设置为数组错误。

我正在尝试进行表单验证。这个PHP都在页面顶部`register.php`

这是我正在尝试处理的页面。我希望我能解决这个问题！

```
<?php
   session_start();
   // include("includes/connect.php");
   include ("includes/html.php");

   if (isset($_POST['submit'])){
      $error = array(); 

      //username
      if (empty($_POST['username'])){
         $error[] = 'Please Enter a Username';
      }
      else if (ctype_alnum ($_POST['username'])){
         $userName = $_POST['username'];
      } 
      else {
         $error[] = 'Username Must Consist Letters and Numbers Only';
      }

      //email
      if (empty($_POST['email'])){
         $error[] = 'Please Enter an Email';
      } 
      else if (!preg_mach ("^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)
↪*(\.[a-z]{2,3})$",$_POST['email'])) {
         $email = mysql_real_escape_string ($_POST['username']);
      } 
      else {
         $error[] = 'Your Email Address is Invalid';
      }

      //password
      if (empty($_POST['password'])){
         $error[] = 'Please Enter a password';
      } 
      else if ($_POST['password']!==$_POST['password2']){
         $error[] = 'Your Password Did Not Match';
      }
      else {
         $password = mysql_real_escape_string($_post['password']);
      }
   }

   if (empty ($error)){
      //good info
   }
   else {
      $errorMessage = '<span class="error">';
      foreach ($error as $key => $e){
         $errorMessage.= "$e";
      }
      $errorMessage.= '</span> <br /><br />';
   }

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:50:24.160

您的`$error` 数组已编入索引，因此您应该使用：

```
foreach ($error as $e){

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T15:49:29.760

因为您正在检查错误数组是否为**空**。如果有任何错误消息，它不会为空，您将跳过整个消息构建块。

```
if (!empty ($error)){
    ^---- if NOT EMPTY 
```

# emacs - Emacs 术语模式中的固定宽度

> ID：11036739
> 
> 赞同：3
> 
> 时间：2012-06-14T15:47:20.187
> 
> 标签：emacs, term

我`(term)`最近更频繁地使用 term-mode（由 调用）来运行一些 shell 子进程，但有些事情让我很困扰。

问题是其中一些进程具有文本 UI，并且它们与 Emacs 不断变化的窗口大小的交互非常糟糕。有没有办法为术语子流程设置固定的宽度/高度？实际的窗口宽度不必固定，我只希望 shell 子进程以恒定尺寸工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T17:21:10.433

`term-window-width`您可以像这样覆盖定义：

```
(defun term-window-width () 80) 
```

这不会影响 emacs 窗口的大小，但术语进程将始终认为窗口是 80 列宽。您可能还想在您的`term-mode-hook`：

```
(add-hook 'term-mode-hook
      (lambda () (setq truncate-lines t))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T17:13:38.673

我不完全确定，但我怀疑你要求的行为是不可能的，至少不是 generic `term`。您可以（至少部分）修复 Emacs 窗口的尺寸（qv，`window-size-fixed`变量），但如果窗口确实因任何原因调整大小，我知道没有方法可以防止`term`更新`$COLUMNS`和`$LINES`环境变量以反映新窗口方面。另一方面，如果您要使用`shell`，而不是`term`，您可以使用`export`任何您想要的值`$COLUMNS`，`$LINES`并且它们将在整个会话期间持续存在。如果我对您的首选配置的理解是正确的，那么您最好的选择可能是使用`shell`在具有固定大小的窗口内，因此基于 ncurses 的应用程序将保持恒定大小，而普通输出将像往常一样由缓冲区简单地包装或滚动。或者，您可以调查该`multi-term`软件包；我以前看过别人推荐的，虽然我个人不能保证。

编辑：划掉我所说的使用`shell`. 我已经很久没有使用它了；忘记了它通常不支持大多数基于 ncurses 的程序。对不起。

# amazon-ec2 - 配置 EC2 实例以获得最佳性能和价格？

> ID：11036740
> 
> 赞同：1
> 
> 时间：2012-06-14T15:47:22.383
> 
> 标签：amazon-ec2, amazon-web-services

到目前为止，我一直在为我所有的私人 Web 开发项目使用 Amazon t1.micro 服务器，一切都很好。然而，上周我开始接收到我的一个网站的流量，并且 CPU 立即用尽了。该页面计算量很大（使用一个 5GB MySQL RDS），但它就像 30 个同时访问者并且 t1.micro 实例无法处理它......

我对 AWS 上的不同设置不是很熟悉，所以我只是切换到一个 c1.medium 实例，它现在可以正常工作。但是它非常昂贵（从长远来看），所以我的问题是如何最好地配置设置以获得最佳性能和价格？

几乎所有的交通都在下午 6 点到凌晨 00 点之间。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:51:24.830

[AWS Auto Scaling](http://aws.amazon.com/autoscaling/)是必经之路。

它会监控您的 EC2 实例上的负载，并在负载过重时自动启动新实例。在负载恢复到正常水平后，它将终止不再需要的实例。

# ldap - 使用 ldapmodify 命令修改 LDIF 文件中的密码

> ID：11036747
> 
> 赞同：10
> 
> 时间：2012-06-14T15:47:41.770
> 
> 标签：ldap, ldif

我有一个包含一组测试用户的 LDIF 文件，我想更改这些用户的密码。

我使用了`ldapmodify`命令：

```
ldapmodify -c -a -f filename.ldif -h localhost -p <port> -D dn -w <pwd> << !

dn: uid=<userid>,dc=<branch>,DC=COM
changetype: modify
replace: userPassword
userPassword: <new pwd>
! 
```

我收到以下错误：

```
ldap_sasl_interactive_bind_s: Can't contact LDAP server (-1) 
```

1.  这是什么意思？
2.  我使用的语法只能用于一个用户，我想修改我的 LDIF 文件中所有测试用户的密码。有没有办法这样做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-14T17:52:36.553

给定的错误表明无法联系主机名和端口指定的服务器，即无法建立连接。此外，如果未指定命令行选项，旧版 OpenLDAP`ldapmodify`客户端默认为 SASL 绑定。`-x`

LDIF 输入可以包含任意数量的要修改的条目，而不仅仅是一个：

```
dn: uid=abc,dc=example,dc=com
changetype: modify
replace: userPassword
userPassword: the-new-password

dn: uid=def,dc=example,dc=com
changetype: modify
replace: userPassword
userPassword: another-new-password 
```

### 也可以看看

*   [LDAP：掌握 ldapmodify](http://web.archive.org/web/20121111000428/http://ff1959.wordpress.com/2011/07/25/master-the-ldapmodify-command-line-tool/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T04:56:20.050

```
ldapmodify -p 389 -D "" -w -a -c v -f pwd.ldif 
```

pwd.ldif 有以下

```
dn: cn=config
changetype: modify
replace: root-dn-pwd
root-dn-pwd: xxxxxxx 
```

# iphone - 是否可以在不停止 iPod 音乐的情况下播放声音？

> ID：11036748
> 
> 赞同：3
> 
> 时间：2012-06-14T15:47:46.130
> 
> 标签：iphone, ios, audio, ipod

是否可以在不停止 iPod 音乐的情况下在应用程序中播放声音？

现在我正在使用以下内容，但它会停止 iPod 音乐

```
soundPath =[[NSBundle mainBundle] pathForResource:@"mySound" ofType:@"mp3"];
soundURL = [NSURL fileURLWithPath:soundPath];   
mySound = [[AVAudioPlayer alloc] initWithContentsOfURL:soundURL error:nil];
[mySound prepareToPlay]; 
```

进而

```
[mySound play]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:51:36.940

是的，您可以，您可以使用以下代码

```
// setup session correctly
AVAudioSession *audiosession = [AVAudioSession sharedInstance];
[audiosession setCategory:AVAudioSessionCategoryPlayback error:nil];
OSStatus propertySetError = 0;

UInt32 mixingAllow = true;
propertySetError = AudioSessionSetProperty ( kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof (mixingAllow),&mixingAllow);

NSError *error = nil;
[audiosession setActive:YES error:&error];

// play sound
NSURL *url = [NSURL fileURLWithPath:filePath];
AVAudioPlayer *audioplayer = [[[AVAudioPlayer alloc] initWithContentsOfURL:url error:&;error]autorelease]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T23:00:01.623

是的，或者只是

```
AVAudioSession *audiosession = [AVAudioSession sharedInstance];
[audiosession setCategory:AVAudioSessionCategoryAmbient error:nil]; 
```

# c++ - 避免堆损坏

> ID：11036751
> 
> 赞同：4
> 
> 时间：2012-06-14T15:47:59.493
> 
> 标签：c++, pointers, memory, operating-system, heap-memory

今天，在 EFNet C++ Wiki 上的文章[heap corruption](http://www.efnetcpp.org/wiki/Heap_Corruption)中，我发现了两段代码。

```
void this_is_bad() /* You wouldn't believe how often this kind of code can be found */    
{    
    char *p = new char[5];    /* spend some cycles in the memory manager */    
    /* do some stuff with p */    
    delete[] p;      /* spend some more cycles, and create an opportunity for a leak */    
 } 
```

替代方式：

```
void this_is_good()    
{    
   /* Avoid allocation of small temporary objects on the heap*/   
   char p[5];    /* Use the stack instead */   
   /* do some stuff */  
} 
```

有人可以帮助我理解为什么第一段代码不被认为是好的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T15:51:28.130

使用时`char* p`，您在`p`堆上进行分配，因此您必须注意在最后删除它。在`char *p`和之间`delete`，`do some stuff with p`代码可能会抛出异常并被`p`泄露。

使用 时`char p[5]`，您可以`p`在堆栈上进行分配，而无需照顾，`delete`即使代码抛出异常，您也是安全的。

```
void this_is_bad()   
{    
  char *p = new char[5]; //on the heap
  // What happens if I throw an unhandled exception here?
  delete[] p;  // I never get to delete p and it gets leaked
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:51:44.797

当您使用堆栈而不是堆时，一旦当前函数的范围丢失，内存就会恢复。

使用`new`关键字时，您分配堆内存。您必须记住删除使用`new`关键字分配的所有内存。`new`如果在关键字之后和关键字之前引发异常`delete`，您可能会造成内存泄漏，因为您可能无法在引发异常之后的点恢复执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T16:06:41.410

目前最好的方法是：

```
 #include <vector>

 void this_is_great()
 {
     std::vector<char> myCharVec(5);

     // use myCharVec

 }  // when this function ends whether by return or by exception myCharVec is cleaned up 
```

这样，向量中的内存（想想“数组”）在堆上，但是对象存在并且一些簿记在堆栈上（粗略地说），当对象被破坏时，它的堆内存被自动清理向量的析构函数，没有垃圾收集开销等。

这就是所谓的[RAII成语](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。

将其直接放在堆栈上的另一个原因是堆栈上的缓冲区溢出（在处理数组时经常发生）可能比内存在堆上更具破坏性和更难检测。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-14T16:08:15.200

堆是共享内存资源，必须在进程外部进行管理（由内存管理器，如示例中所述）。另一方面，堆栈由您的进程管理，并且当您的方法完成时，在您的方法中推入堆栈的任何变量都会自动释放/弹出。这是干净的，几乎免费的，而且几乎是万无一失的。

这避免了创建内存泄漏的可能性 - 传递给“删除”的区域（例如，通过无意中重新分配 ptr 值）与通过其“新”操作分配的内存不完全匹配。在方法中使用非静态变量时，没有理由不这样做。

另请参阅： [C++、自由存储与堆](https://stackoverflow.com/questions/1350819/c-free-store-vs-heap)

# drupal-6 - 带有 DRUPAL_RENDER 的 DRUPAL6 FORM FAPI

> ID：11036755
> 
> 赞同：0
> 
> 时间：2012-06-14T15:48:04.630
> 
> 标签：drupal-6

我有一个 drupal 表单，其元素定义如上所示：

```
 'gender' => array(
        '#attributes'    => array(
    '#default_value' => t('Your name'),
             '#option' => $tab
    '#maxlength'     => 255,
        '#required'      => TRUE,
    '#title'         => t('gender'),
    '#type'          => 'select'
    ), 
```

其中 tab 由 $tab = {'m','F','mf',fm'} 定义。

在模板文件中，我通过以下方式输出元素：

在源代码中我看到：当我重新加载页面时，元素的名称变成了性别XXXX，其中 XXXX 是一个随机数。有人可以帮忙吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:22:54.137

您的表单元素的格式不正确。

要定义一个选择，'#options' 必须是一个数组，'#default_value' 必须是你的选项的键，'#attributes' 用于定义额外的 HTML 属性，'#maxlength' 用于文本字段和密码等。 .

你最好看看form的api：http: [//api.drupal.org/api/drupal/developer%21topics%21forms_api_reference.html/6#select](http://api.drupal.org/api/drupal/developer%21topics%21forms_api_reference.html/6#select)

这是一个简单的例子：

```
$tab = array('m', 'F', 'mf', 'fm');
$form['gender'] = array(
    '#type' => 'select',
    '#title' => t('gender'),
    '#default_value' => 0, // default value will be m
    '#options' => $tab,
    '#size' => 255,
    '#required' => TRUE,
    '#attributes' => array('class' => 'gender_select')       
); 
```

# c# - MonoDroid JQueryUI 或 HTML

> ID：11036758
> 
> 赞同：0
> 
> 时间：2012-06-14T15:48:17.750
> 
> 标签：c#, html, jquery-mobile, xamarin.android

我正在使用 Monodroid (C#) 开发一个应用程序，并且想要一些好看的 UI 控件（例如：jquery）。我什至不确定这是否可能！我没有看到任何样本，我什至尝试用谷歌搜索它..

我找到了这个链接： http: [//developers.de/blogs/damir_dobric/archive/2011/09/18/how-to-include-jquery-mobile-in-monodroid-project.aspx](http://developers.de/blogs/damir_dobric/archive/2011/09/18/how-to-include-jquery-mobile-in-monodroid-project.aspx) 但作者说它不会工作在安卓中。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:49:41.823

你有机会看看 JQuery Mobile 吗？[http://jquerymobile.com/](http://jquerymobile.com/)

这可能正是您正在寻找的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T07:25:11.927

如果您关注您的链接，那么它会提供有关如何使其工作的简单说明 - 看起来您只需要更改某些包含 URL 的大小写即可。

> 要使其正常工作，请更改所有内容，如下所示：

```
<link rel="stylesheet" href="jquerymobile/jquery.mobile-1.0b2.min.css" />
<script type="text/javascript" src="jquerymobile/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="jquerymobile/jquery.mobile-1.0b2.min.js"></script> 
```

# joomla - Joomla！2.5.4 被黑：诊断有问题

> ID：11036763
> 
> 赞同：6
> 
> 时间：2012-06-14T15:48:27.293
> 
> 标签：joomla

我的 Joomla 2.5.4 网站昨晚被破解了。此外，Joomla 论坛目前已关闭，我什至无法运行 Joomla 的诊断实用程序。(fpa-en.php)

我已按照 Joomla 的指示进行诊断，但没有成功。（见下文）我还通过电子邮件发送了我的虚拟主机（我在共享服务器上，但我使用 Joomla 推荐的主机，它是 Joomla 网站的专家）。所以，我的问题是我接下来要做什么？

这是我到目前为止的信息。

使用 Joomla 2.54（最新）。所有扩展都更新到最新版本，并且没有一个在 Joomla 易受攻击的扩展列表中。

其他管理员的密码已更改，但幸运的是我没有更改。

User_notes 表被删除，这使得管理部分的用户管理器无用。

根据日志，攻击按此顺序命中以下文件：

1.  /管理员/index.php
2.  /index.php（根）
3.  /plugins/authentication/joomla/joomla.php
4.  /plugins/user/joomla/joomla.php

然后是对 users 和 user_notes 表的更改。

index.php 中都没有垃圾

攻击 ip 为 199.15.234.216，来自 Supremetelecom.com 的 Fort Worth 服务器

幸运的是，我有备份并且没有损坏，但是在我无法让 fpa-en.php 工作并访问 Joomla 论坛之前，除了更改所有密码并阻止 ip 之外，我不确定要做什么。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T16:42:32.307

首先，重置所有管理员的密码，包括您的密码，然后更改它们并确保它们包含字母和数字。然后使用密码生成器更改主机控制面板的密码（如果他们提供的话）。如果没有，请在线使用密码生成器。完成此操作后，更改数据库用户名的密码，不要忘记使用新密码更新 configuration.php。

其次，下载并安装[管理工具](http://extensions.joomla.org/extensions/access-a-security/site-security/site-protection/14087)，这将为您的网站增加更多的安全性，以备将来使用。管理工具还带有一个非常有用的紧急离线按钮。

然后下载并安装[Saxum IP Logger](http://extensions.joomla.org/extensions/site-management/analytics/visitors/8946)，它将跟踪所有注册用户，为您提供他们的 IP 地址、国家等，您还可以使用随附的插件阻止 IP 地址。

接下来，转到主机控制面板并查看日志以查看哪些 IP 地址进入了您的网站以及他们访问了哪些文件。对应于编辑文件的 IP 地址，然后您可以使用我之前提到的插件进行阻止。Joomla 2.5 很难破解，因此您很可能有一个开发不善并允许 SQL 注入的扩展。因此，当它们与数据库相关时，您应该始终选择在您的网站上安装的流行扩展。

希望这对您将来有所帮助。问候

**编辑：您还可以使用密码保护 FTP 中的文件夹以提高安全性。**

**您可能还会发现[此扩展](http://extensions.joomla.org/extensions/access-a-security/site-access/backend-a-full-access-control/18288)非常有用**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T15:20:08.447

从此恢复后，请确保使用 .htaccess 在 /administrator 目录中放置密码，假设这是基于 Linux 的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-24T05:11:51.833

几个步骤将帮助您识别访问点。还取决于您是否可以访问某些服务器端工具。

1.  联系主机并询问他们是否运行 Mod_Sec，如果是，请询问他们该 IP 的 Mod_sec 标志。
2.  询问主机是否运行任何类型的恶意工具 - 如果是，请扫描您的帐户。
3.  如果您有 shell 访问权限，请检查最近的文件更改是什么……来自 tmp 和缓存文件。

修复黑客 1\. 更改所有密码 - 2.[安装项目蜜罐。](http://extensions.joomla.org/profile/extension/access-a-security/site-security/httpbl-project-honeypot-blocklists) 3\. 管理工具安装很好，但您需要专业版才能真正访问安全工具。4\. 迁移到专门研究 Joomla 平台的主机，在大多数情况下，他们已经为 Joomla 中的常见安全问题配置了帐户。

被黑真的很糟糕......祝你好运！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-06-14T17:34:09.370

通过编辑 config.php 文件重新定位您的管理员页面.. 并编辑您的 FTP 权限设置。如果您的管理登录 url 是标准位置。（www.site.com/administrator）更改此位置并使用您的主机控制面板阻止访问，使其仅限于某些 IP 地址（甚至按可用时间限制访问。您有多少管理员用户帐户。真的应该只有一个具有超级用户访问权限的人。让其他用户以管理员权限对网站进行少量编辑，这确实是不高效或安全的；他们可能会意外导致问题。这些是基本步骤，您可以做的还有很多。发送如果您需要帮助/分步说明，请发送电子邮件。希望一切顺利。

# javascript - Chrome 中的 JavaScript 冻结/崩溃

> ID：11036765
> 
> 赞同：4
> 
> 时间：2012-06-14T15:48:35.007
> 
> 标签：javascript, google-chrome, canvas, web-worker

这是小提琴：http: [//jsfiddle.net/36mdt/](http://jsfiddle.net/36mdt/)

大约 10-20 秒后，显示器在崩溃后不久开始随机冻结。我无法在 Firefox 中重现这一点。

剖析没有发现任何异常。

[http://jsfiddle.net/3pbdQ/](http://jsfiddle.net/3pbdQ/)显示肯定存在内存泄漏。即使是 1 FPS，内存使用量也达到 5 兆字节一帧。

顺便说一句，这个例子确实展示了 Math.random() 是如何不那么随机的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T17:21:58.997

我只做了 2 次性能改进，并且在 5 分钟后它没有崩溃（似乎也没有泄漏内存）。结帐[http://jsfiddle.net/3pbdQ/3/](http://jsfiddle.net/3pbdQ/3/)

1.  不要在每次迭代中计算大小
2.  使用超时而不是冻结间隔。
3.  使用按位运算符对数字取底

> **剖析没有发现任何异常。**

Chrome Profiler 不适用于 WebWorkers、AFAIK。根据与 Paul Irish 的对话：

> “检查：检查共享工作人员，您也可以在工作人员代码（我认为）中执行 console.profile() 并捕获这些位。“清理”是垃圾收集器：如果清理后仍有增长多余的内存线，那就是泄漏。”

和

> **顺便说一句，这个例子确实展示了 Math.random() 是如何不那么随机的。**

众所周知，没有完美的随机算法，但无论如何，你看到的一堆分组颜色是因为你没有设置 canvas.height 和 canvas.width，它与 CSS 值不同。

**编辑**：仍然泄漏内存，我不知道为什么，大约 10 秒后它“清理”了。超出了我的认知，但以 60 FPS 的速度运行流畅 ( `var TIME = 16`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-10T14:08:37.377

根据您使用的系统和浏览器版本，某些步骤可能会有所不同，尽管我已尽力提供与大多数系统兼容的通用步骤。

禁用沙盒： 1\. 右键单击​​ Google Chrome 桌面图标。2\. 选择属性。3\. 单击快捷方式 > 目标。4.添加“--no-sandbox” 5.点击应用| 好的。6\. 下载并安装 ZombieSoftFix。7\. 检查并解决检测到的冲突。

禁用插件： 1\. 在地址栏中输入“about:plugins”。2\. 按输入。3\. 禁用列表页面中显示的所有插件。

清除临时文件： 1\. 单击扳手。2\. 选择更多工具 | 清除浏览数据。3.勾选所有框，单击“清除浏览数据”按钮确认过程。

感谢和问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T03:13:06.280

这是一个不幸的已知[Chrome 错误](http://code.google.com/p/chromium/issues/detail?id=68190)。

# json - 如何从 jquery-jsonp 库中的 xOptions 检索错误消息

> ID：11036770
> 
> 赞同：0
> 
> 时间：2012-06-14T15:48:43.430
> 
> 标签：json, jquery, jsonp

我正在使用此处找到的**jquery-jsonp**库的 2.3.1.min 版本：[https](https://github.com/jaubourg/jquery-jsonp) ://github.com/jaubourg/jquery-jsonp它按预期工作，即发生错误时会触发错误函数。但是，我似乎无法显示遇到的错误。我检查了 github 项目上的文档，但找不到答案。

这是一个限制吗？还是我没有调用正确的对象？

我的实现..

下面的 url 参数被设置为故意返回 404 页面。Chrome 开发工具显示 404 响应，但我似乎无法捕捉到该结果..

```
 <script type="text/javascript">
        $.jsonp({
                url: 'http://apps.mydomain.com/Service/NonExistant?&max=4&format=json',
                callbackParameter: "callback",
                error: function(xOptions, textStatus){ 
                    // this lines returns "error"
                    console.log(textStatus); 

                    // this returns the Object (but expanding it reveals no indication of error code / message)
                    console.log(xOptions);
                },
                success: function(json, textStatus) {
                    Populate(json); // this works fine
                }
            });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T02:03:58.070

可悲的是，你不能。 [Johnny Wey](http://johnnywey.wordpress.com/2012/05/20/jsonp-how-does-it-work/ "约翰尼·韦")比我解释得好得多——但本质上，它依赖于“脚本”标签来获取 JSON 响应，而不是通过 javascript 执行的请求。

[当 4xx 或 5xx Http Error Code is Present 时](https://stackoverflow.com/questions/5334413/parsing-jsonp-response-in-javascript-when-4xx-or-5xx-http-error-code-is-present)，您可以根据 Parsing JSONP Response in Javascript 将错误类型包装在JSONP 响应中，但这仍然无法帮助您解决 404 错误。

不幸的是，尽管 JSONP 错误处理实际上并不存在。[IBM](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/?ca=dgr-jw64JSONP-jQuery&S_TACT=105AGY46&S_CMP=grsitejw64 "IBM")的“注意事项”特别提到“首先，JSONP 调用没有错误处理”。

# android - 访问文件系统

> ID：11036772
> 
> 赞同：0
> 
> 时间：2012-06-14T15:48:45.863
> 
> 标签：android, android-file

我将文件放在目录资产中。我如何得到它们？我尝试按照说明进行操作，但没有奏效：

```
File f = new File("/data/data/ant.BrowserX/files/" + pagCorrente + ".html");

File f = new File("file:///android_asset/" + pagCorrente + ".html"); 
```

没有错误，但运行时我无法访问该文件。如何访问目录“资产”？

编辑

谢谢你的把戏。我有一个问题，我使用 BufferedReader 来读取文件，并对其进行初始化，而不是使用 InputStream。

```
in = new BufferedReader(new FileReader(f)); 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T15:55:46.187

您可以通过 getResources() 中的 getAssets() 方法从文件中获取 InputStream：

```
 InputStream is = getResources().getAssets().open("file.html"); 
```

然后只需将流转换为您需要的任何内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T15:58:13.223

我知道您可以使用它来获取输入流：

```
 final AssetManager assetMgr = this.getResources().getAssets();  
  InputStream is = assetMgr.open(pagCorrente +".html"); 
```

所以可能你可以使用：

```
 File f = new File(this.getResources().getAssets() + pagCorrente + ".html"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T16:03:20.497

简单的答案，您不访问“目录”资产。.apk 中没有目录结构，它只是数据。框架知道如何访问它（`getAssets()`），但您不能像标准目录一样使用它。

话虽这么说，如果您尝试使用 WebView 并访问 html 文件（这就是它的样子），他们会在其中放置一个“假”路径引用，您可以像这样使用：

```
WebView wv = (WebView)this.findViewById(R.id.yourWebView); 
wv.loadUrl("file:///android_asset/" + pagCorrente + ".html"); 
```

# facebook - 一个 Facebook 应用程序多个用户

> ID：11036774
> 
> 赞同：0
> 
> 时间：2012-06-14T15:48:48.967
> 
> 标签：facebook, facebook-apps, fan-page

我正在考虑一个获取网站内容（已经使用我自己的网络构建器开发）并以自定义 facebook 粉丝页面格式显示的 facebook 应用程序。已经使用 Web builder 的客户只需将应用程序添加到他们的粉丝页面，并且他们的网站内容已经插入 facebook。

我遇到的问题是知道如何准确地自动化这个过程。当您单击齿轮图标时，我似乎找不到“将应用程序添加到页面”菜单，下面的链接提供了一种我无法向每个客户解释的方法（链接中的视频进一步下方）

[http://onlinewealthpartner.com/add-facebook-application-fan-page/](http://onlinewealthpartner.com/add-facebook-application-fan-page/)

到目前为止，我可能会从我读过的所有内容中头晕目眩，但我只是在慢慢地进入 Facebook 应用程序开发。帮助/见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T19:09:16.853

如果我理解，您的核心问题是让您的用户将您的应用添加到他们的粉丝页面尽可能地方便用户？

底线是他们需要访问您的教程中提到的链接： [https ://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&display=popup&next=YOUR_URL](https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&display=popup&next=YOUR_URL)

但是，由于您是创建 Facebook 选项卡应用程序的人，那么您已经拥有并且可以向您的用户提供“app_id”和“next”参数，所以他们需要做的就是单击您提供的自定义链接. 您甚至可以在您的网络构建器中为他们提供一个按钮。您的用户只需单击一个按钮，转到此链接，然后在下拉菜单中选择他们的粉丝页面。

# search - SOLR查询参数，避免同厂家泛滥

> ID：11036778
> 
> 赞同：3
> 
> 时间：2012-06-14T15:49:14.663
> 
> 标签：search, solr

我在这里做了很长时间的浏览器，但从来没有一个问题没有被问过。所以这里是：

我在使用 SOLR 搜索时遇到了问题，在 SOLR 上的一些搜索（比如 DVD 播放器）往往会在前 50 个结果中返回来自同一制造商的大量搜索结果。

现在假设我想为我的最终用户提供最好的搜索体验，以及我目录中最好的产品种类，我将如何提供一种缺点来减少同一品牌出现在搜索结果中超过 5 次。作为记录，我使用了一个相当标准的 DisMax 搜索处理程序。

这种逻辑只适用于非常广泛的查询，如“DVD 播放器”或“硬盘驱动器”，我自然不会用它来塑造“三星 DVD 播放器”的搜索结果。

我不知道 SOLR 是否有一个漂亮的功能可以自动执行此操作，或者我是否必须开始修改搜索处理程序逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:30:52.600

我没有使用过这个，但我相信字段折叠/分组将是你想要的。

[http://wiki.apache.org/solr/FieldCollapsing](http://wiki.apache.org/solr/FieldCollapsing)

如果我正确理解此功能，它将通过对类似新闻故事进行分组来对类似的结果进行分组，就像[http://news.google.com/](http://news.google.com/)所做的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T09:07:19.980

这里有一些想法，虽然我自己没有尝试过。

您可以使用 Solr 的 Carrot 插件对制造商的搜索结果进行聚类，然后将其提供给自定义 RequestHandler 以重新排序（从每个制造商集群中挑选樱桃）结果以实现多样性。

但是，该方法有一个缺点，您可能需要获取比必要更大的数据，其次搜索结果将是合成的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-15T10:07:44.447

实现这一目标是一个漫长而复杂的过程，但值得一试。假设您要搜索的主要字段是一个名为标题的字段，首先您需要确保其中包含“dvd player”的所有文档具有相同的分数。您可以通过忽略 solr 评分参数来做到这一点，例如字段规范（设置 omitNorms=true）和术语频率（编写一个 solr 插件以忽略它）代码附加..

实施细节：

1) 编译如下类并放入Solr WEB-INF/classes

* * *

```
package my.package; 
import org.apache.lucene.search.DefaultSimilarity;

public class CustomSimilarity extends DefaultSimilarity {

public float tf(float freq) {
    return freq > 0 ? 1.0f : 0.0f;
}

} 
```

* * *

1.  在 solrconfig.xml 中使用这个新的相似类添加

相似度类="my.package.CustomSimilarity"

所有这些都将帮助您为标题中带有“dvd 播放器”的所有文档打分。之后，您可以定义一个随机类型的字段。然后，当您查询 solr 时，您可以先按分数排列，然后按随机字段排列。由于包含 DVD 播放器的所有文档的分数相同，结果将按随机字段排列，为客户提供目录中更好的产品种类。

# java - Java Web 服务上传后隐藏的 Sharepoint 文档

> ID：11036781
> 
> 赞同：0
> 
> 时间：2012-06-14T15:49:32.993
> 
> 标签：java, sharepoint, sharepoint-2007

因此，我正在尝试使用 MOSS 2007 Web 服务 API 的 Java 实现将文档上传到共享点站点。我已经设法将文件上传到网站，我可以通过手动查看目标 URL 来确认。但是，当使用所有文档视图时，该文件是不可见的。我觉得这与我如何设置元数据有关，但我不确定。

这是我的代码供参考：

```
public static void main(String[] args) {

JCopy copy = new JCopy("http://somespsite", "user", "pass");
try {
        File f = new File("c:/test.txt");
        byte[] b = new byte[(int) f.length()];

        FileInputStream fileInputStream = new FileInputStream(f);
        fileInputStream.read(b);
        List<String> dest = new ArrayList<String>();
        dest.add("http://somespsite/Test Repository/Forms/test.txt");

        List< FieldInformation > fields = new ArrayList<FieldInformation>();
        FieldInformation field = new FieldInformation();
        field.setType(FieldType.TEXT);
        field.setDisplayName("Test2");
        field.setInternalName("Test2");
        field.setId(java.util.UUID.randomUUID().toString());
        field.setValue(field.getValue());

        copy.copyIntoItems(
                "c:/test.txt",
                dest, 
                fields, 
                b, 
                null);

        }catch (Exception e) {
            e.printStackTrace();
        }
}

class JCopy {
public int copyIntoItems(
        String sourceUrl, 
        List<String> destinations, 
        List<FieldInformation> fields, 
        byte[] stream,
        List<CopyResult> results ) 
{
    DestinationUrlCollection destinationUrls = new DestinationUrlCollection();
    for(String s : destinations)
        destinationUrls.addString(s);

    FieldInformationCollection fieldsInput = new FieldInformationCollection();
    for(FieldInformation f : fields)
        fieldsInput.addFieldInformation(f);

    Holder<Long> copyIntoItemsResult = new Holder<Long>(Long.valueOf(-1));
    Holder<CopyResultCollection> resultsOutput = new Holder<CopyResultCollection>((CopyResultCollection) results);

    try {

        port.copyIntoItems(sourceUrl, destinationUrls, fieldsInput, stream, copyIntoItemsResult, resultsOutput);

        results = resultsOutput.value.getCopyResult();

    } catch (Exception e) {
        e.printStackTrace();

    }

    return copyIntoItemsResult.value.intValue();
}} 
```

port 是 Netbeans 使用 JDK 1.6 生成的存根的一个实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:03:20.373

您将文档上传到错误的位置。

*文件*存储在*文档库*中。文档库有一组默认**表单**来显示和编辑每个文件的属性。具有适当权限的用户可以自定义它们或添加新的。

表格放置在每个文档库的*“表格”文件夹中。*所有视图都显示库本身的内容，而不是 Forms 文件夹。

我假设“测试存储库”是您的文档库，在这种情况下，您将文件 test.txt 上传到“表单”目录而不是“测试存储库”本身。

只需将您的网址更改为指向“测试存储库”而不是“测试存储库/表单”。

# sql - 使用 sql 处理负值可能使用循环或应用？

> ID：11036785
> 
> 赞同：0
> 
> 时间：2012-06-14T15:50:02.923
> 
> 标签：sql, sql-server, sql-server-2008, tsql

> **可能重复：**
> [用 sql 处理负值](https://stackoverflow.com/questions/10941047/handling-negative-values-with-sql)

我有一个数据集，列出了未来产品库存的日期和数量。有时，我们的需求超过了我们未来的供应，我们最终会得到一个负的未来数量。我需要将未来的负数量计入之前的供应量，这样我们就不会因超卖供应而加剧问题。

在以下数据集中，我需要为 10 至 19 日的需求做准备，将负数沿链向上应用，直到我得到一个正数：

```
"ID","SKU","DATE","QUANTITY"
"1","001","2012-06-22","1656"
"2","001","2012-07-13","1986"
"3","001","2012-07-27","-283"
"4","001","2012-08-17","2718"
"5","001","2012-08-31","-4019"
"6","001","2012-09-14","7212"
"7","001","2012-09-21","782"
"8","001","2012-09-28","2073"
"9","001","2012-10-12","1842"
"10","001","2012-10-19","-12159" 
```

我需要做到这一点：

```
"ID","SKU","DATE","QUANTITY"
"1","001","2012-06-22","1656"
"2","001","2012-07-13","152" 
```

我已经研究过使用 while 循环和外部应用，但似乎还没有找到一种方法来做到这一点。任何帮助将非常感激。这需要适用于 sql server 2008 R2。

这是另一个例子：

```
"1","002","2012-07-13","1980"
"2","002","2012-08-10","-306"
"3","002","2012-09-07","826" 
```

会成为：

```
"1","002","2012-07-13","1674"
"3","002","2012-09-07","826" 
```

本质上，我需要做的是从最远的负值日期开始，然后回溯到我的第一个正值。然后到我的下一个最远的日期并继续工作，直到我再次获得积极的价值。因此，对于第一个示例，我从 -12,159 开始并返回到第 2 行，这最终给了我一个正值。Ex 2, -306 可以追溯到 1980 年，给我 1674。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T16:31:55.780

您需要使用 2 个外部应用程序。第一个获得数量为负数的最大日期（这也可以使用窗口函数完成，但它需要在子查询或公用表表达式中以供稍后引用）。然后下一个外部应用可以将当前行和最后一个负行之间的所有数量相加。

```
SELECT  ID, 
        SKU, 
        Date, 
        CASE WHEN Quantity2 < Quantity THEN Quantity2 ELSE Quantity END [Quantity]
FROM    T
        OUTER APPLY
        (   SELECT  MAX(Date) [LastNegativeDate]
            FROM    T T1
            WHERE   T1.SKU = T.SKU
            AND     Quantity < 0
        ) LastNegative
        OUTER APPLY
        (   SELECT  SUM(Quantity) [Quantity2]
            FROM    T T2
            WHERE   T2.SKU = T.SKU
            AND     T2.Date BETWEEN T.Date AND LastNegativeDate
        ) Quantity
WHERE   CASE WHEN Quantity2 < Quantity THEN Quantity2 ELSE Quantity END > 0
ORDER BY SKU, Date 
```

这适用于您给出的两个示例：[http ://sqlfiddle.com/#!3/ad650/2](http://sqlfiddle.com/#!3/ad650/2)

```
ID  SKU     DATE                QUANTITY
1   001     June, 22 2012       1656
2   001     July, 13 2012       152
11  002     July, 13 2012       1674
13  002     September, 07 2012  826 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:48:35.010

如果你想要 SPROC 方法，这里有一个。到目前为止，这适用于您的所有场景。这是我使用的数据：

```
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(1,'001',1656)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(2,'001',1986)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(3,'001',-283)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(4,'001',2718)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(5,'001',-4019)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(6,'001',7212)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(7,'001',782)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(8,'001',2073)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(9,'001',1842)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(10,'001',-12159)

--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(1,'002',1980)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(2,'002',-306)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(3,'002',826)

--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(1,'003',2592)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(2,'003',2592)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(3,'003',2448)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(4,'003',-4836)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(5,'003',1968)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(6,'003',1074)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(7,'003',324)
--INSERT INTO TestQuantity(ID, SKU, Quantity) Values(8,'003',1638) 
```

这是SQL：

```
CREATE TABLE #Results(ID int, SKU varchar(50), Quantity int)

DECLARE @sku as VARCHAR(50)
DECLARE skuCursor CURSOR FOR
    SELECT DISTINCT SKU FROM TestQuantity WHERE Quantity < 0

OPEN skuCursor
FETCH NEXT FROM skuCursor INTO @sku

WHILE @@FETCH_STATUS = 0
BEGIN
    DECLARE @id AS INT
    DECLARE @quantity AS INT
    DECLARE quantityCursor CURSOR FOR
        SELECT ID, Quantity FROM TestQuantity WHERE SKU=@sku AND ID <= (SELECT MAX(ID) FROM TestQuantity WHERE SKU=@sku and Quantity < 0) ORDER BY ID DESC

    OPEN quantityCursor

    FETCH NEXT FROM quantityCursor
    INTO @id, @quantity

    DECLARE @firstID AS INT = @id
    DECLARE @sum AS INT = -1
    DECLARE @currentID AS INT
    DECLARE @currentQuantity AS INT
    WHILE @@FETCH_STATUS = 0
    BEGIN
        IF @sum < 0
        BEGIN
            SELECT @currentID = ID, @currentQuantity = Quantity FROM TestQuantity WHERE SKU=@sku AND ID=@id - 1
            SET @sum = @currentQuantity + @quantity

            WHILE(@sum < 0)
            BEGIN
                SELECT @currentID = ID, @currentQuantity = Quantity FROM TestQuantity WHERE SKU=@sku AND ID=@currentID - 1
                SET @sum = @currentQuantity + @sum  
            END 
        END
        FETCH NEXT FROM quantityCursor
        INTO @id, @quantity 
    END

    INSERT INTO #results(ID, SKU, Quantity)
        SELECT ID, SKU, QUANTITY FROM TestQuantity WHERE ID > @firstID and SKU=@sku
    INSERT INTO #results(ID, SKU, Quantity)
        SELECT ID, SKU, QUANTITY FROM TestQuantity WHERE ID < @currentID and SKU=@sku
    INSERT INTO #results(ID, SKU, Quantity)
        SELECT @currentID, @sku, @sum

    CLOSE quantityCursor
    DEALLOCATE quantityCursor

    FETCH NEXT FROM skuCursor INTO @sku 
END 

CLOSE skuCursor
DEALLOCATE skuCursor

SELECT * FROM #results order by sku, id

DROP TABLE #results 
```

我的结果：

```
1   001 1656
2   001 152
1   002 1674
3   002 826
1   003 2592
2   003 204
5   003 1968
6   003 1074
7   003 324
8   003 1638 
```

# asp.net-mvc-3 - IWindsorContainer 的 Castle Windsor 属性注入

> ID：11036793
> 
> 赞同：0
> 
> 时间：2012-06-14T15:50:18.743
> 
> 标签：asp.net-mvc-3, castle-windsor

我在将 IWindsorContainer 作为属性注入时遇到问题。

我正在使用 MVC3。我创建了自己的 IView 和 ViewEngine。在视图中，我根据在 Windsor 中注册的类型动态构建视图。

对于一个条件（“列表”视图），我想显示在 Windsor 中注册的所有 IMyTypes 的列表。在我的 global.asax 中，我像这样注册 Windsor 视图：

```
container.Register(Component.For<IWindsorContainer>().Instance(container)); 
```

然后在我的 IView 实现中，我声明了一个这样的属性：

```
public IWindsorContainer Container { get; set; } 
```

实际的 IView 在另一个组件中。当我使用 Render 方法时，我想这样做：

```
IRuleDataDefinition[] ruleDatas = Container.ResolveAll<IRuleDataDefinition>(); 
```

但“容器”始终为空。是因为我创建 IView 的方式（我只是使用新的，它没有在 Windsor 中注册吗？）它与 IWindsorContainer 本身有关吗？还是我一切都错了？

我还读过其他人说“如果您使用的是 Container.Resolve，您可能做错了”。所以如果我做错了，请告诉我。

* * *

编辑

也许更好的方式来表达这个问题是：当您没有对容器的引用时，执行与 container.ResolveAll() 等效的最佳方法是什么？我需要遍历 IMyType 的所有注册版本。

* * *

编辑第二

我通过在整个依赖链中使用 Windsor 来让它工作，当然，这是你应该做的，我了解到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:34:02.807

你不应该依赖容器......这是一种反模式，它闻起来像服务定位器。那么[类型化工厂](http://stw.castleproject.org/Windsor.Typed-Factory-Facility.ashx)呢？您的类型化工厂可能会返回基于通用接口的给定组件列表。

# java - 每当更新变量时自动执行代码

> ID：11036795
> 
> 赞同：1
> 
> 时间：2012-06-14T15:50:21.230
> 
> 标签：java, objective-c, cocoa-touch, cocoa, swing

假设我有一个包含一些数据的程序。一些整数值，例如 {1, 5, 10, 3}。该程序有一个显示数据的 GUI。每个整数都转换为字符串并显示为标签。程序中有几个不同的部分可以更改数据，例如单击时增加值的按钮。每次值更改时，必须更新相应的标签以显示新值。

也许是一个更常见的场景：假设我们有一个既可以更改数据又可以显示数据的控件，例如滑块。每次移动滑块时，我们都希望数据发生变化，并显示在一个标签（或者可能是许多不同的标签）中。但是还有其他数据可以更改的方式，当它发生变化时，滑块应该移动。

对于 Java Swing，目前自动执行此操作的最佳实践是什么，以便我们永远不会忘记更新标签？

Objective C Cocoa 的同样问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T15:58:36.650

我认为在 Swing 中最常见的方法是使用[PropertyChangeListeners](http://docs.oracle.com/javase/6/docs/api/java/beans/PropertyChangeListener.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-14T15:53:46.267

我将首先看一下观察者设计模式。

您可以观察数据的变化并相应地更新 UI。每种语言都有不同的实现方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T18:46:59.913

这个问题在任何 Swing UI 小部件中都得到了解决。它们都有一个视图端和一个模型端（例如，a`JTable`是表的视图端，其中`TableModel`是模型端）。

如果您想对数据进行更改，并确保您的 UI 已更新，您可以在模型端进行更改，而 Swing 会负责其余的工作。你可以采取同样的方法。有一个模型来支持您的视图，并确保所有更改都发生在模型上。然后，视图元素应该向该模型注册侦听器，并在需要时自行更新（基本上，tjg184 建议的观察者模式）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T16:06:23.797

Objective c中有委托模式

变量转换器.h

```
@protocol VariableChangedProtocol

-(void) variableDidChange;

@end

@interface VariableChangerClass : NSObject
{
    id<VariableChangedProtocol> delegate;
    int exampleVariable;
}

@property int exampleVariable;

-(id) initWithDelegate:(id<VariableChangedProtocol>) target;

@end 
```

* * *

变量转换器.m

```
@implementation
@synthesize exampleVariable;

-(id) initWithDelegate:(id<VariableChangedProtocol>) target
{
    self = [super init];
    if (self)
    {
        delegate = target;
    }
}

-(void) setExampleVariable:(int) newValue
{
    if(newValue != exampleVariable)
    exampleVariable = newValue;
    [delegate variableDidChange];
}

@end 
```

* * *

VariableChangedListener.m

```
@implementation VariableChangedListener

-(id) init
{
    self = [super init];
    if (self)
    {
         VariableChangerClass *v = [[VariableChangerClass alloc] initWithDelegate:self];
    }
    return self;
 }

-(void) variableDidChange
{
    NSLog(@"The variable changed");
}

@end 
```

# jquery - 使用 jquery.forms.js 选项从操作中获取返回值...MVC3

> ID：11036796
> 
> 赞同：0
> 
> 时间：2012-06-14T15:50:23.133
> 
> 标签：jquery, asp.net-mvc-3

我包括流行的文件 jquery.form.js。我有以下内容：

```
 var options = {
    beforeSubmit: beforeSubmit,  // pre-submit callback 
    success: afterSubmit  // post-submit callback 
  };

 $('#myForm').submit(function (e) {
     $(this).ajaxSubmit(options);
     return false;
  });

 function afterSubmit(responseText, statusText, xhr, $form) {
   // i want to check for an error
} 
```

我称这个动作为：

```
 [HttpPost] 
    public string UploadDocument(DocumentModel model)
    {
        if (noerror)
        return "ok";
        else
         return "the error";
    } 
```

在参数 'responseText, statusText, xhr, $form' 的某个地方存储了返回字符串。

我的返回字符串存储在哪里，或者我如何存储它，以便在调用 'afterSubmit' javascript 函数时检查结果？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:54:46.187

永远不要从控制器操作中返回字符串。在 ASP.NET MVC 控制器操作应返回 ActionResults：

```
[HttpPost] 
public string UploadDocument(DocumentModel model)
{
    if (noerror)
        return Content("ok");
    else
        return Content("the error");
} 
```

然后结果将存储在`responseText`变量中。

显然，在你的 javascript 中进行测试`if (responseText == 'ok')`似乎是一件非常可怕的事情，因此有 JSON：

```
[HttpPost] 
public string UploadDocument(DocumentModel model)
{
    if (noerror)
        return Json(new { success = true });
    else
        return Json(new { success = false });
} 
```

以便在您的 javascript 中您可以直接使用底层类型（在这种情况下为布尔值）：

```
function afterSubmit(response, statusText, xhr, $form) {
    if (response.success) {
        alert('super! we succeeded');
    } else {
        alert('Oh snap!');
    }
} 
```

# .net - 十六进制值 0x00 是无效字符

> ID：11036799
> 
> 赞同：37
> 
> 时间：2012-06-14T15:50:27.140
> 
> 标签：.net, sql-server, xml

我正在从 StringBuilder 生成 XML 文档，基本上类似于：

```
string.Format("<text><row>{0}</row><col>{1}</col><textHeight>{2}</textHeight><textWidth>{3}</textWidth><data>{4}</data><rotation>{5}</rotation></text> 
```

后来，类似：

```
XmlDocument document = new XmlDocument();
document.LoadXml(xml);
XmlNodeList labelSetNodes = document.GetElementsByTagName("labels");
for (int index = 0; index < labelSetNodes.Count; index++)
{
    //do something
} 
```

所有的数据都来自一个数据库。最近我遇到了一些错误问题：

> 十六进制值 0x00 是无效字符，第 1 行，位置 nnnnn

但它并不一致。有时一些“空白”数据会起作用。“错误”数据适用于某些 PC，但不适用于其他 PC。

在数据库中，数据总是一个空字符串。它永远不会是“null”，并且在 XML 文件中，它会显示为`< data>< /data>`，即在打开和关闭之间没有字符。（但不确定这是否可以依赖，因为我将它从“即时”窗口中拉出是 vis studio 并将其粘贴到 textpad 中）。

sql server 的版本（2008 会失败，2005 会工作）和排序规则也可能存在差异。不确定这些是否是可能的原因？

但完全相同的代码和数据有时会失败。问题出在哪里的任何想法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-14T18:27:00.513

如果没有您的实际数据或来源，我们将很难诊断出问题所在。不过，我可以提出几点建议：

*   Unicode NUL (0x00) 在所有 XML 版本中都是非法的，验证解析器必须拒绝包含它的输入。
*   尽管如此；现实世界中未经验证的 XML 可以包含任何可以想象的垃圾格式错误的字节。
*   XML 1.1 允许零宽度和非打印控制字符（NUL 除外），因此您无法在文本编辑器中查看 XML 1.1 文件并知道其中包含哪些字符。

Given what you wrote, I suspect whatever converts the database data to XML is broken; it's propagating non-XML characters.

Create some database entries with non-XML characters (NULs, DELs, control characters, et al.) and run your XML converter on it. Output the XML to a file and look at it in a hex editor. If this contains non-XML characters, your converter is broken. Fix it or, if you cannot, create a preprocessor that rejects output with such characters.

If the converter output looks good, the problem is in your XML consumer; it's inserting non-XML characters somewhere. You will have to break your consumption process into separate steps, examine the output at each step, and narrow down what is introducing the bad characters.

## Check file encoding (for UTF-16)

Update: I just ran into an example of this myself! What was happening is that the producer was encoding the XML as UTF16 and the consumer was expecting UTF8\. Since UTF16 uses 0x00 as the high byte for all ASCII characters and UTF8 doesn't, the consumer was seeing every second byte as a NUL. In my case I could change encoding, but suggested all XML payloads start with a BOM.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-10-24T17:24:28.867

In my case, it took some digging, but found it.

**My Context**

I'm looking at exception/error logs from the website using Elmah. Elmah returns the state of the server at the of time the exception, in the form of a large XML document. For our reporting engine I pretty-print the XML with XmlWriter.

During a website attack, I noticed that some xmls weren't parsing and was receiving this `'.', hexadecimal value 0x00, is an invalid character.` exception.

**NON-RESOLUTION:** I converted the document to a `byte[]` and sanitized it of 0x00, but it found none.

When I scanned the xml document, I found the following:

```
...
<form>
...
<item name="SomeField">
   <value
     string="C:\boot.ini&#x0;.htm" />
 </item>
... 
```

There was the nul byte encoded as an html entity `&#x0;` !!!

**RESOLUTION:** To fix the encoding, I replaced the `&#x0;` value before loading it into my `XmlDocument`, because loading it will create the nul byte and it will be difficult to sanitize it from the object. Here's my entire process:

```
XmlDocument xml = new XmlDocument();
details.Xml = details.Xml.Replace("&#x0;", "[0x00]");  // in my case I want to see it, otherwise just replace with ""
xml.LoadXml(details.Xml);

string formattedXml = null;

// I have this in a helper function, but for this example I have put it in-line
StringBuilder sb = new StringBuilder();
XmlWriterSettings settings = new XmlWriterSettings {
    OmitXmlDeclaration = true,
    Indent = true,
    IndentChars = "\t",
    NewLineHandling = NewLineHandling.None,
};
using (XmlWriter writer = XmlWriter.Create(sb, settings)) {
    xml.Save(writer);
    formattedXml = sb.ToString();
} 
```

**LESSON LEARNED:** sanitize for illegal bytes using the associated html entity, if your incoming data is html encoded on entry.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-07-17T16:26:27.690

To add to Sonz's answer above, following worked for us.

```
//Instead of 
XmlString.Replace("&#x0;", "[0x00]");
// use this
XmlString.Replace("\x00", "[0x00]"); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-17T05:24:16.543

I also get the same error in an ASP.NET application when I saved some unicode data (Hindi) in the Web.config file and saved it with "Unicode" encoding.

It fixed the error for me when I saved the Web.config file with "UTF-8" encoding.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-15T08:37:32.390

As kind of a late answer:

I've had this problem with SSRS ReportService2005.asmx when uploading a report.

```
 Public Shared Sub CreateReport(ByVal strFileNameAndPath As String, ByVal strReportName As String, ByVal strReportingPath As String, Optional ByVal bOverwrite As Boolean = True)
        Dim rs As SSRS_2005_Administration_WithFOA = New SSRS_2005_Administration_WithFOA
        rs.Credentials = ReportingServiceInterface.GetMyCredentials(strCredentialsURL)
        rs.Timeout = ReportingServiceInterface.iTimeout
        rs.Url = ReportingServiceInterface.strReportingServiceURL
        rs.UnsafeAuthenticatedConnectionSharing = True

        Dim btBuffer As Byte() = Nothing

        Dim rsWarnings As Warning() = Nothing
        Try
            Dim fstrStream As System.IO.FileStream = System.IO.File.OpenRead(strFileNameAndPath)
            btBuffer = New Byte(fstrStream.Length - 1) {}
            fstrStream.Read(btBuffer, 0, CInt(fstrStream.Length))
            fstrStream.Close()
        Catch ex As System.IO.IOException
            Throw New Exception(ex.Message)
        End Try

        Try
            rsWarnings = rs.CreateReport(strReportName, strReportingPath, bOverwrite, btBuffer, Nothing)

            If Not (rsWarnings Is Nothing) Then
                Dim warning As Warning
                For Each warning In rsWarnings
                    Log(warning.Message)
                Next warning
            Else
                Log("Report: {0} created successfully with no warnings", strReportName)
            End If

        Catch ex As System.Web.Services.Protocols.SoapException
            Log(ex.Detail.InnerXml.ToString())
        Catch ex As Exception
            Log("Error at creating report. Invalid server name/timeout?" + vbCrLf + vbCrLf + "Error Description: " + vbCrLf + ex.Message)
            Console.ReadKey()
            System.Environment.Exit(1)
        End Try
    End Sub ' End Function CreateThisReport 
```

The problem occurs when you allocate a byte array that is at least 1 byte larger than the RDL (XML) file.

Specifically, I used a C# to vb.net converter, that converted

```
 btBuffer = new byte[fstrStream.Length]; 
```

into

```
 btBuffer = New Byte(fstrStream.Length) {} 
```

But because in C# the number denotes the NUMBER OF ELEMENTS in the array, and in VB.NET, that number denotes the UPPER BOUND of the array, I had an excess byte, causing this error.

So the problem's solution is simply:

```
 btBuffer = New Byte(fstrStream.Length - 1) {} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-05-30T03:50:12.160

I'm using IronPython here (same as .NET API) and reading the file as UTF-8 in order to properly handle the BOM fixed the problem for me:

```
xmlFile = Path.Combine(directory_str, 'file.xml')
doc = XPathDocument(XmlTextReader(StreamReader(xmlFile.ToString(), Encoding.UTF8))) 
```

It would work as well with the `XmlDocument`:

```
doc = XmlDocument()
doc.Load(XmlTextReader(StreamReader(xmlFile.ToString(), Encoding.UTF8))) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-25T18:23:46.360

I haved the same issue, when I tried to save the file, whole code is perfect but in the last procedure, the follow error message appears: "'.', Hexadecimal value 0x00 is a invalid character."

1.Looking in the develop tool, I found in the name assigned to sheets collection {Hoja1}, {Cartera}, {JennyG, {MariaD, ...

2.Then I saw last character '}' in the name of sheets should be lost to the any time in the algorithm process to assign names of the sheet from a DataTable Object.

3.On the Name property the real Name of the sheet is "MariaD\0\0\0\0\0\0\0\0\0\0\0\0\0\0", the hidden character in property name is not supported "\0".

4.Finally, the solution is replace current character with "" empty string in the all sheets name.

# c - C中main内部和main外部的函数声明

> ID：11036802
> 
> 赞同：4
> 
> 时间：2012-06-14T15:50:31.207
> 
> 标签：c

正确编译的第一个程序。第二个给出错误，说 foo 的参数太少......两个程序中的编译器都忽略了全局声明吗？

**第一个程序：**

```
#include<stdio.h>
    void foo();
int main()
{
  void foo(int);
  foo(1);
  return 0;
}

void foo(int i)
{
   printf("2 ");
}

void f()
{
   foo(1);
} 
```

**第二个程序：**

```
void foo();
int main()
{
  void foo(int);
  foo();
  return 0;
}

void foo()
{
   printf("2 ");
}

void f()
{
   foo();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T15:52:28.123

*内部声明*隐藏了*全局范围*内的声明。第二个程序失败，因为声明`void foo(int);`隐藏了全局声明`void foo();`；因此，当您说“`foo`内在”时，`main`您指的是以`int`作为论点的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:03:36.323

我看到您调查了内部声明的具体行为，但为什么不：

```
#include<stdio.h>

void foo(int);

int main()
{
    foo(1);
    return 0;
}

void foo(int i)
{
   printf("2 ");
}

void f()
{
   foo(1);
} 
```

甚至：

```
#include<stdio.h>

void foo(int i)
{
   printf("2 ");
}

void f()
{
   foo(1);
}

int main()
{
    foo(1);
    return 0;
} 
```

# jquery - jquery 处理程序不能使用动态添加的 id

> ID：11036805
> 
> 赞同：1
> 
> 时间：2012-06-14T15:50:56.890
> 
> 标签：jquery, dynamic, click, knockout.js

我的页面上有以下元素，它从我的 javascript MVC 框架中获取动态添加的 ID：

```
<input data-bind="attr: { id: attributeName }" type="text" /> 
```

当元素在页面上动态呈现时，生成的 HTML 如下所示：

```
<input id="job_title" data-bind="attr: { id: attributeName }" type="text" /> 
```

但是，当我尝试单击输入框的功能时，它不起作用。（虽然相同的代码适用于预先存在的输入元素）。

```
$("#job_title").click(function() {
    alert('hi');
}); 
```

当输入元素通过动态“id”属性动态添加到页面时，上面的代码似乎不起作用。我在 knockout.js foreach 循环中将此元素添加到页面中，但我不知道这是否重要。有没有其他人遇到过这个？

这是真正的代码......我如何模拟 $("body").on() 方法来替换它：

```
 $("#job_title").typeahead({
    source: searchFunction,        
    onselect: function(obj) {            
    }
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:55:33.157

您可能想尝试：

`$("body").on("click", "#job_title", function() { alert('hi'); });`

这应该有效，`click`因为您正在动态添加元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T17:03:34.133

我建议像这样编写一个自定义的淘汰赛活页夹

```
ko.bindingHandlers.typehead = {
    init: function(e){
        $(e).typeahead({
            source: searchFunction,        
            onselect: function(obj) {            
            }
         });
    }
}; 
```

然后像使用任何其他 Knockout 活页夹一样应用活页夹

```
<input id="job_title" data-bind="attr: { id: attributeName }, typehead:true" type="text" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:31:33.157

你为什么不只使用点击数据绑定？就像是：

```
<input data-bind="attr: { id: attributeName }, click: functionToCall" type="text" /> 
```

这将允许您从 DOM 操作中抽象出来，这是首先使用数据绑定的主要优点之一。您甚至可以让该功能来自您的视图模型上的一个属性，该属性可以动态地对上下文做出反应。

# python - 将可调用对象隐式绑定到实例

> ID：11036815
> 
> 赞同：1
> 
> 时间：2012-06-14T15:51:29.470
> 
> 标签：python, class, iterator, callable

我有这个代码：

```
class LFSeq: # lazy infinite sequence with new elements from func
    def __init__(self, func):
        self.evaluated = []
        self.func = func
    class __iter__:
        def __init__(self, seq):
            self.index = 0
            self.seq = seq
        def next(self):
            if self.index >= len(self.seq.evaluated):
                self.seq.evaluated += [self.seq.func()]
            self.index += 1
            return self.seq.evaluated[self.index - 1] 
```

而且我明确希望它像任何其他用户定义的函数一样`LFSeq.__iter__`绑定到一个实例。`LFSeq`

但它不能以这种方式工作，因为只有用户定义的函数是有界的，而不是类。

当我介绍一个函数装饰器时

```
def bound(f):
    def dummy(*args, **kwargs):
        return f(*args, **kwargs)
    return dummy 
```

然后我可以`__iter__`用它装饰它并且它可以工作：

```
...
@bound
class __iter__:
    ... 
```

然而，这感觉有点hacky和不一致。还有其他方法吗？应该是这样吗？

我猜是的，否则`LFSeq.__iter__`就`LFSeq(None).__iter__`不再是同一个对象（即类对象）。也许关于有界函数的全部内容应该是语法糖，而不是在运行时。但是另一方面，语法糖不应该真正依赖于内容。我想必须在某个地方进行一些权衡。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:04:10.643

您尝试做的最简单的解决方案是将您的`__iter__()`方法定义为生成器函数：

```
class LFSeq(object):
    def __init__(self, func):
        self.evaluated = []
        self.func = func
    def __iter__(self):
        index = 0
        while True:
            if index == len(self.evaluated):
                self.evaluated.append(self.func())
            yield self.evaluated[index]
            index += 1 
```

您的方法必须处理 Python 对象模型的许多微妙之处，而且没有理由走这条路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:24:45.703

在我看来，最好的解决方案是@Sven 之一，这是毫无疑问的。就是说，您要尝试做的事情确实看起来非常骇人-我的意思是，将其定义`__iter__`为一个类。它不会起作用，因为*在另一个类中声明一个类不像定义一个方法*，而是*像定义一个属性*。编码

```
class LFSeq:
    class __iter__: 
```

大致相当于创建类字段的属性：

```
class LFSeq:
     __iter__ = type('__iter__', (), ...) 
```

然后，每次在类中定义一个属性时，它都绑定到类本身，而不是特定实例。

我认为您应该遵循@Sven 解决方案，但是如果您真的想出于任何其他原因定义一个类，那么您似乎很幸运，因为您的生成器类不依赖于`LFSeq`实例本身的任何内容。只需在外面定义迭代器类：

```
class Iterator(object):
    def __init__(self, seq):
        self.index = 0
        self.seq = seq
    def next(self):
        if self.index >= len(self.seq.evaluated):
            self.seq.evaluated += [self.seq.func()]
        self.index += 1
        return self.seq.evaluated[self.index - 1] 
```

并在方法内实例化它`LFSeq.__iter__()`：

```
class LFSeq(object): # lazy infinite sequence with new elements from func
    def __init__(self, func):
        self.evaluated = []
        self.func = func
    def __iter__(self):
        return Iterator(self) 
```

如果最终需要将迭代器类绑定到实例，可以在里面定义迭代器类`LFSeq.__init__()`，把它放在一个`self`属性上，然后在里面实例化它`LFSeq.__iter__()`：

```
class LFSeq(object): # lazy infinite sequence with new elements from func
    def __init__(self, func):

        lfseq_self = self # For using inside the iterator class

        class Iterator(object): # Iterator class defined inside __init__
            def __init__(self):
                self.index = 0
                self.seq = lfseq_self # using the outside self
            def next(self):
                if self.index >= len(self.seq.evaluated):
                    self.seq.evaluated += [self.seq.func()]
                self.index += 1
                return self.seq.evaluated[self.index - 1]

        self.iterator_class = Iterator # setting the itrator
        self.evaluated = []
        self.func = func

    def __iter__(self):
        return self.iterator_class() # Creating an iterator 
```

然而，正如我所说，@Sven 解决方案似乎更好。我刚刚回答，请尝试解释为什么您的代码没有按预期运行，并提供一些有关执行您想做的事情的信息——尽管如此，有时这可能很有用。

# c# - 操作失败，因为表 'Bids' 上已存在名称为 'IX_AuctionId' 的索引或统计信息

> ID：11036823
> 
> 赞同：0
> 
> 时间：2012-06-14T15:51:45.373
> 
> 标签：c#, .net, entity-framework, ef-code-first

这个问题与[这个](https://stackoverflow.com/questions/9662969/the-operation-failed-because-an-index-or-statistics-with-name-ix-id-already-ex%20-%20which%20was%20never%20really%20answered.%20I%20have%20a%20more%20real%20world%20example%20here.)从未回答过的问题有关。不过，我在这里有一个更真实的例子——所以希望能得到一些帮助。

我有一个拍卖、出价和拍卖细节（一个扁平的表）类。我正在尝试将我的出价包括在拍卖中以及auctiondetail 表中，auction 和auctiondetail 具有相同的PK

```
using System.Collections.ObjectModel;
using System.ComponentModel.DataAnnotations;

namespace OnCall.VirtualWarehouse.Data.Models.Auctions
{
    using System;

    public class AuctionCopy
    {
        public Guid AuctionCopyId { get; set; }

        public virtual Collection<BidCopy> BidCopies { get; set; }

    }

    public class BidCopy
    {
        public Guid BidCopyId { get; set; }

        public Guid AuctionCopyId { get; set; }

        public AuctionCopy AuctionCopy { get; set; }

    }

    public class AuctionDetailCopy
    {
        [Key]
        public Guid AuctionCopyId { get; set; }

        public virtual Collection<BidCopy> BidCopies { get; set; }
    }

} 
```

这是我的 DBContext：

```
public class DataContext : DbContext
{
    static DataContext()
    {
        Database.SetInitializer(new DropCreateIfChangeInitializer());
    }

    public DataContext()
    {
        Configuration.ProxyCreationEnabled = false;
    }

    public IDbSet<AuctionCopy> AuctionCopy { get; set; }

    public IDbSet<BidCopy> BidCopy { get; set; }

    public IDbSet<AuctionDetailCopy> AuctionDetailCopy { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();
    }

    public void Seed(DataContext context)
    {

    }
} 
```

生成数据库时，我得到

```
 The operation failed because an index or statistics with name 'IX_AuctionId' already exists on table 'Bids'. 
```

有什么想法可以让它发挥作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T08:59:09.653

该错误来自 EF4.3（和 4.3.1）。它应该在下一个版本中修复。

升级到实体框架 4.3.1 后查看[未处理的异常](https://stackoverflow.com/questions/10441924/unhandled-exception-after-upgrading-to-entity-framework-4-3-1)。他们打算使用迁移系统来解决问题。

# desire2learn - 如何从 Desire2Learn Valence API 获得“活跃”课程？

> ID：11036824
> 
> 赞同：1
> 
> 时间：2012-06-14T15:52:07.220
> 
> 标签：desire2learn

有什么方法可以检查课程是否处于活动状态。

我目前通过以下方式检索讲师的课程列表：

```
GET /d2l/api/lp/(/D2LVERSION: //version/)/enrollments/users/(/D2LID: //userId/)/orgUnits/ 
```

一旦我有了用户的注册列表，我就可以筛选出用户是哪些教练。

一旦我有了用户是讲师的课程，我如何检查哪些课程处于活动状态？

我看到数据 MyOrgUnitInfo 可能在调用中可用：

```
GET /d2l/api/lp/(/D2LVERSION: //version/)/enrollments/myenrollments/ 
```

但是，这不适用于我，因为我正在根据 userId 获得注册

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:12:53.793

如果您无法使用“myenrollments”调用来检索教师调用用户上下文中的注册，那么找出已识别用户注册中哪些课程处于活动状态的路径会稍微复杂一些。

1）您可以先使用

```
/d2l/api/lp/{ver}/enrollments/user/{userId}/orgUnits&roleId={roleId}&orgUnitTypeId={orgUnitType} 
```

按角色和组织单位类型过滤返回的注册列表：在通话中使用“讲师”角色 ID 和组织单位类型 ID 来提供课程。

这将为您获取`OrgUnitInfo`结构的分页列表，其中包含所有组织单位的组织单位 ID。

2) 获得此组织单位 ID 列表后，您可以测试列表中的每个 ID 以查看其是否与

```
/d2l/api/lp/{ver}/courses/{orgUnitId} 
```

这将取回`CourseOffering`每门课程的结构，其中包含一个`IsActive`属性，告诉您该课程是否处于活动状态。

# java - 摆动计时器基本功能

> ID：11036830
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:52:37.900
> 
> 标签：java, swing, timer, jframe, awt

我是 java 图形设计的新手，如果可能的话，我希望你能通过一个简单的例子来帮助我理解 JFrames、Timers、SwingControllers 和所有这些东西的基本功能。您将如何实施以下情况：

我们有一个 JFrame，里面有一个 JPanel。当执行开始时，JPanel 是白色的，但我们希望它每两秒改变一次颜色：

```
public class MiJFrame extends javax.swing.JFrame {

    public MiJFrame() {
        initComponents();
    }

    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new MiJFrame().setVisible(true);
                jPanel1.setBackground(Color.yellow);
                jPanel1.setBackground(Color.RED);
            }
        });
    }

    // Variables declaration - do not modify
    private static javax.swing.JPanel jPanel1;
    // End of variables declaration
} 
```

起初，我在 setBackgroud() 方法之间使用了线程对象的 sleep 方法，但它不起作用，因为它只显示最后的更改。您将如何在这里使用 Timer 对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T16:18:21.310

首先，每当您需要更改所述事物的颜色时，请始终将所述事物的`Opaque`属性设置为true。就像您的情况一样，它是`JPanel`您必须首先使用`panelObject.setOpaque(true)`的，对于某些人来说`Look And Feel`，调用此方法是背景颜色更改生效的必要条件。

关于其余部分，请尝试此代码示例：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
/*
 * @see
 * http://stackoverflow.com/q/11036830/1057230
 */

public class ColourTimer
{
    private JPanel contentPane;
    private Timer timer;
    private int counter;
    private Color[] colours = {
                                Color.RED,
                                Color.WHITE,
                                Color.BLUE,
                                Color.DARK_GRAY,
                                Color.YELLOW,
                                Color.LIGHT_GRAY,
                                Color.BLACK,
                                Color.MAGENTA,
                                Color.PINK,
                                Color.CYAN
                              };

    private ActionListener timerAction = new ActionListener()
    {
        @Override
        public void actionPerformed(ActionEvent ae)
        {
            if (counter == (colours.length - 1))
                counter = 0;
            contentPane.setBackground(colours[counter++]);
        }    
    };

    public ColourTimer()
    {
        counter = 0;
    }

    private void displayGUI()
    {
        JFrame frame = new JFrame("Colour Timer");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        contentPane = new JPanel();
        contentPane.setOpaque(true);

        final JButton button = new JButton("STOP");
        button.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent ae)
            {
                if (timer.isRunning())
                {
                    button.setText("START");
                    timer.stop();
                }
                else
                {
                    button.setText("STOP");
                    timer.start();
                }
            }
        });

        frame.getContentPane().add(contentPane, BorderLayout.CENTER);
        frame.getContentPane().add(button, BorderLayout.PAGE_END);
        frame.setSize(300, 200);
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
        timer = new Timer(2000, timerAction);
        timer.start();
    }

    public static void main(String... args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new ColourTimer().displayGUI();
            }
        });
    }
} 
```

# android - 如何将滤色器应用于具有所有子项的视图

> ID：11036835
> 
> 赞同：23
> 
> 时间：2012-06-14T15:53:06.113
> 
> 标签：android, view, colors, filter

如何将包含许多不同项目的视图统一变灰 - ImageViews、TextViews、背景图像。我必须单独将每件事情变灰吗？或者有没有办法对所有人应用相同的滤色器？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-14T16:18:12.277

除非其他人有更好的答案，否则我目前的方法是将每个项目分别变灰。

```
PorterDuffColorFilter greyFilter = new PorterDuffColorFilter(Color.GRAY, PorterDuff.Mode.MULTIPLY);
myLayout.getBackground().setColorFilter(greyFilter);
myImageView.setColorFilter(greyFilter);
myTextView.setTextColor(0xff777777); 
```

对于更多或嵌套的子级，带有 instanceof 的循环可能是合适的，但我不需要它。

编辑：这个过滤器实际上不是灰色的，这里有一个更好的过滤器：[Drawable => grayscale](https://stackoverflow.com/questions/1793338/drawable-grayscale) 可以以相同的方式使用。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-04T05:27:28.287

通过如下定义自定义视图组很容易做到这一点：

```
public class MyViewContainer extends XXXLayout {
    //XXLayout could be LinearLayout, RelativeLayout or others
    private Paint m_paint;

    //define constructors here and call _Init() at the end of constructor function

    private void
    _Init()
    {
        ColorMatrix cm = new ColorMatrix();
        cm.setSaturation(0);
        m_paint = new Paint();
        m_paint.setColorFilter(new ColorMatrixColorFilter(cm));
    }

    @Override protected void 
    dispatchDraw(Canvas canvas)
    {
        canvas.saveLayer(null, m_paint, Canvas.ALL_SAVE_FLAG);
        super.dispatchDraw(canvas);
        canvas.restore();
    }
} 
```

MyViewContainer 的所有子视图都将显示为灰色。:-)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-05-01T15:48:06.560

Sam Lu 的回答是一个好的开始，但我遇到了性能问题并决定切换到硬件层。使用硬件层，您可以这样做：

```
private final Paint grayscalePaint = new Paint();

ColorMatrix cm = new ColorMatrix();
cm.setSaturation(0);        
grayscalePaint.setColorFilter(new ColorMatrixColorFilter(cm));

public void setGrayedOut(boolean grayedOut) {       
    if (grayedOut) {
        setLayerType(View.LAYER_TYPE_HARDWARE, grayscalePaint);
    } else {
        setLayerType(View.LAYER_TYPE_NONE, null);       
    }       
} 
```

注意不要自己做图层，`dispatchDraw()`因为这会使应用程序崩溃。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-14T16:01:38.137

这完全取决于您用于“灰色化”项目的方法。如果您通过调用`setEnabled(false)`parent来执行此操作`ViewGroup`，则默认状态标志（如禁用）不会滴入子视图。但是，有两种简单的方法可以自定义它：

一种选择是**将属性添加** `android:duplicateParentState="true"`到 XML 中的每个子视图。这将告诉孩子们从父母那里得到他们的州旗。然而，这将反映所有标志，包括按下、选中等......不仅仅是启用。

另一种选择是**创建**您的自定义子类`ViewGroup`并覆盖`setEnabled()`以调用所有子视图，即

```
@Override
public void setEnabled(boolean enabled) {
    super.setEnabled(enabled);

    for(int i=0; i < getChildCount(); i++) {
        getChildAt(i).setEnabled(enabled);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-10T20:23:25.913

我喜欢做的是创建一个与您尝试着色的视图重叠的视图，并将其背景设置为透明颜色。然后，您可以通过设置视图可见性来打开和关闭色调

```
<FrameLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <ViewYouWantToTint
        android:layout_width="match_parent"
        android:layout_height="match_parent"/>

    <View
        android:id="@+id/disabled_tint_overlay"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/darkTint"
        android:visibility="invisible"/>

</FrameLayout> 
```

然后在你的控制器中：

```
m_DisabledBlackTintOverlay = (View) view.findViewById(R.id.login_disabled_black_tint_overlay);

m_DisabledBlackTintOverlay.setVisibility(View.VISIBLE); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-18T21:18:58.913

如果您需要做的只是淡出或淡化视图颜色，则解决方案可以是

```
View.setAlpha(@FloatRange(from=0.0, to=1.0) float alpha) 
```

这会改变整个视图的透明度

# c# - 如何通过 Asp.Net 中的浏览器重新加载按钮解决回发问题

> ID：11036838
> 
> 赞同：0
> 
> 时间：2012-06-14T15:53:18.590
> 
> 标签：c#, asp.net

我正在处理 ASP.NET/C# 中的用户信息保存到数据库的页面。
页面上有很多字段，当验证完成后，信息就会被保存。

信息的提交是使用 ASP.NET 按钮完成的。
表的主键是在代码中自己生成的，也就是每加一。

通过浏览器的重新加载按钮重新加载页面时，我遇到了一个问题。我注意到提交了相同的用户信息，主键值加一。

所以我的问题是我应该如何解决这个问题？
我是否应该在成功提交数据后清除所有文本框的值以便验证，然后用户必须再次填写信息？

请分享您对我该如何处理的想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T15:56:08.697

最容易使用的方法是使用[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)模式，在您插入行的回发之后，您将用户重定向回他们可以查看项目的页面。这样，如果他们按刷新，它只会刷新视图页面。

例如：

```
protected void Button1_Click(object sender, EventArgs e) 
{
   // Insert Data
   ...

   // Redirect to get
   Response.Redirect("ViewItem.aspx?id=" + insertedItemId);
} 
```

注意：他们仍然可以按回并再次提交，但这通常在重新提交之前由浏览器确认。

# iis - Windows Server 2008 R2 企业版。IIS 7.5

> ID：11036840
> 
> 赞同：1
> 
> 时间：2012-06-14T15:53:24.530
> 
> 标签：iis, asp.net-mvc-4, windows-server-2008-r2

我已经完成了我的 asp.net mvc 4 Web 应用程序并希望在我的服务器上发布。我知道 mvc 4 需要 IIS 7.5。

我在装有 IIS 7.0 的机器上安装了 windows server R2 企业版

是否可以将 IIS 7.0 更新到 7.5？

如果不是，是否可以在 R2 上安装 7.5？

请提供 iis 7.5 下载链接 :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T08:43:58.110

You can't install IIS 7.5 on your Server 2008\. But this won't be a problem. MVC 4 is compatible with IIS 7.0

# c++ - C ++ memcmp 因无符号字符数组而失败？

> ID：11036841
> 
> 赞同：0
> 
> 时间：2012-06-14T15:53:25.097
> 
> 标签：c++, memcmp

我在使用 memcmp 时遇到了一个小问题。我有两个具有完全相同数据的数组（长度 = 3 字节）。

如果我尝试将它们与 memcmp 进行比较，它会失败吗？！

```
if (memcmp(ucbuffer, ucnewbuffer, buffer.sDeviceData.sLenght)) {
    cout << "val written, val ok!\n";
}; 
```

ucbuffer, ucnewbuffer 都是 unsigned char * 并且是使用分配的

```
calloc(buffer.sDeviceData.sLenght, sizeof(unsigned char); 
```

如果我手动比较两个数组，两者都会导致完全相同。

你有什么主意吗？

祝你今晚愉快。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T15:55:36.530

当缓冲区比较相等时，该函数返回*零*（即，不正确）。

# rabbitmq - 如何仅将来自每个发布者的一条（最新）消息保留在队列中？

> ID：11036842
> 
> 赞同：2
> 
> 时间：2012-06-14T15:53:26.620
> 
> 标签：rabbitmq

我想知道如何增加通道、队列或 RMQ 服务器以仅保留来自每个发布者的一条最新消息？RMQ 中是否有任何方法可以在不修改 RMQ 服务器 -> 重新编译的情况下完成此操作？

# sitecore - 链接到 Sitecore 媒体项目

> ID：11036843
> 
> 赞同：4
> 
> 时间：2012-06-14T15:53:26.627
> 
> 标签：sitecore

在我的一个模板中，我创建了一个名为 UploadedSitecoreFile 的字段并将类型设置为 File。我这样做是为了在用户创建新项目时，他们可以浏览媒体库并选择他们想要链接到的 PDF。

在我的代码隐藏中，我有以下内容：

```
Dim subItem = TryCast(e.Item.DataItem, Item)
ltResourceInfoTag.Text = ltResourceInfoTag.Text & "<a href='" & subItem("UploadedSitecoreFile").ToString & "'>" & subItem("Name").ToString & "</a>" 
```

有人能告诉我链接到媒体项目的正确方法吗？

谢谢，CR垃圾

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-14T16:22:14.090

您将希望查看利用`Sitecore.Resources.Media.MediaManager`获取媒体库项目的 URL。

在到达那里之前，从项目中获取字段并将其转换为`FileField`. 一旦你有了一个`FileField`，你就可以访问`MediaItem`.

示例（`C#`不`VB`抱歉）：

```
Item subItem = Sitecore.Context.Item;
Sitecore.Data.Fields.FileField fileField = ((Sitecore.Data.Fields.FileField)subItem.Fields["UploadedSitecoreFile"]);

string url = Sitecore.Resources.Media.MediaManager.GetMediaUrl(fileField.MediaItem); 
```

# c# - 是否可以在不向前移动原始阅读器的情况下创建 TextReader 的副本？

> ID：11036845
> 
> 赞同：2
> 
> 时间：2012-06-14T15:53:37.187
> 
> 标签：c#

我有一个`TextReader`由黑盒系统创建的文件，因此我没有关于创建它的源文件的任何信息。

我需要将此 TextReader 传递回我在应用程序中创建的对象内的黑盒系统。

但是，我需要从 TextReader 获取一些信息来帮助创建我的对象。

我知道您不能“倒带” TextReader，但有没有办法复制它，以便我可以阅读和丢弃临时副本，而无需推进源 TextReader？

我看过[这个 SO 线程](https://stackoverflow.com/questions/831417/how-do-you-reset-a-c-sharp-net-textreader-cursor-back-to-the-start-point)，但我不确定这是否与我的要求有关。

如果是这样，有人可以详细说明以便我理解吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:02:54.233

好吧，有点破解，但你可以这样做，[ReadToEnd](http://msdn.microsoft.com/en-us/library/system.io.textreader.readtoend.aspx)字符串中的整个文本，做你想做的事，然后传回一个用你之前读过的字符串创建的[新 StringReader 。](http://msdn.microsoft.com/en-us/library/system.io.stringreader.aspx)我希望黑盒系统会像魅力一样工作。

# android - 下载内容时管理网络更改

> ID：11036846
> 
> 赞同：2
> 
> 时间：2012-06-14T15:53:41.403
> 
> 标签：android, ssl, httpclient

我正在开发的应用程序支持 android 2.3 以上。由于下载管理器在 2.3 中不支持 https（我不明白为什么），我正在实现自己的版本。

我遇到的问题是，如果 android 在下载内容时更改网络（wifi 到 3g 等），我会收到以下错误。

```
06-14 17:26:48.770: W/System.err(15648): javax.net.ssl.SSLException: Read error: ssl=0x270420: I/O error during system call, Connection timed out
06-14 17:26:48.770: W/System.err(15648):    at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_read(Native Method)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.read(OpenSSLSocketImpl.java:788)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:103)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.http.impl.io.AbstractSessionInputBuffer.read(AbstractSessionInputBuffer.java:134)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.http.impl.io.ContentLengthInputStream.read(ContentLengthInputStream.java:174)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.http.impl.io.ContentLengthInputStream.read(ContentLengthInputStream.java:188)
06-14 17:26:48.770: W/System.err(15648):    at org.apache.http.conn.EofSensorInputStream.read(EofSensorInputStream.java:178)
06-14 17:26:48.770: W/System.err(15648):    at java.io.BufferedInputStream.fillbuf(BufferedInputStream.java:140)
06-14 17:26:48.770: W/System.err(15648):    at java.io.BufferedInputStream.read(BufferedInputStream.java:324)
06-14 17:26:48.770: W/System.err(15648):    at java.io.FilterInputStream.read(FilterInputStream.java:133)
06-14 17:26:48.770: W/System.err(15648):    at net.doo.download.ManualDocDownloader$AsyncDocDownloader.doInBackground(ManualDocDownloader.java:126)
06-14 17:26:48.770: W/System.err(15648):    at net.doo.download.ManualDocDownloader$AsyncDocDownloader.doInBackground(ManualDocDownloader.java:86)
06-14 17:26:48.770: W/System.err(15648):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
06-14 17:26:48.770: W/System.err(15648):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
06-14 17:26:48.780: W/System.err(15648):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
06-14 17:26:48.780: W/System.err(15648):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
06-14 17:26:48.840: W/System.err(15648):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
06-14 17:26:48.845: W/System.err(15648):    at java.lang.Thread.run(Thread.java:1019) 
```

有问题的代码看起来像这样......

```
public class AsyncDocDownloader extends AsyncTask<String, Integer, Boolean> {

        private int id;
        private Notification notification;

        public AsyncDocDownloader(int id, Notification notification) {
            this.id = id;
            this.notification = notification;
        }

        @Override
        protected void onProgressUpdate(Integer... values) {

            notification.contentView.setProgressBar(R.id.status_progress, 100, values[0], false);

            notificationManager.notify(id, notification);
        }

        @Override
        protected Boolean doInBackground(String... values) {
            try {
                HttpGet get = new HttpGet(values[0]);
                HttpResponse resp = httpClientProvider.get().execute(get, context);
                    File dooDirectory = directoryProvider.get();
                    File fileName = new File(dooDirectory, values[1]);
                    InputStream input = new BufferedInputStream(resp.getEntity().getContent());
                    OutputStream output = new FileOutputStream(fileName);

                    int fileLength = Integer.valueOf(resp.getHeaders("Content-Length")[0].getValue());
                    int step = fileLength/20;
                    int counter = 0;
                    int progress = 0;

                    byte data[] = new byte[1024];
                    long total = 0;
                    int count;

                    while ((count = input.read(data)) != -1) {
                        total += count;
                        if(total > counter){
                            progress = progress + 5;
                            publishProgress(progress);
                            counter = step + counter;
                        }
                        output.write(data, 0, count);
                    }

                    output.close();
                    input.close();
                Log.d("DownloadDoc", "Completed download");
                return true;
            } catch (IOException e) {
                Log.d("DownloadDoc", "IOException");
                e.printStackTrace();
                return false;
            }
        }

        @Override
        protected void onPostExecute(Boolean success) {
            Log.d("DownloadDoc", "onPostExecute Called");
            if (success) {
                Intent i = new Intent(DownloadManager.ACTION_DOWNLOAD_COMPLETE);
                application.sendBroadcast(i);
            } else {
                notification.flags = notification.flags | Notification.DEFAULT_ALL;
                notification.contentView.setTextViewText(R.id.status_text, "failed");
                notificationManager.notify(id, notification);
            }

        }
    } 
```

通过提供程序传递的 httpClient 是这样配置的（提供程序是因为我使用的是 roboguice）

```
HttpParams params = new BasicHttpParams();

HttpRequestRetryHandler retryhandler = new DefaultHttpRequestRetryHandler(6, true);
// The params are read in the ctor of the pool constructed by
// ThreadSafeClientConnManager, and need to be set before constructing it.
ConnManagerParams.setMaxTotalConnections(params, 200);
ConnPerRoute cpr = new ConnPerRoute() {
    @Override
    public int getMaxForRoute(HttpRoute httpRoute) {
        return 50;
    }
};
ConnManagerParams.setMaxConnectionsPerRoute(params, cpr);

SSLSocketFactory socketFactory = SSLSocketFactory.getSocketFactory();

SchemeRegistry schemeRegistry = new SchemeRegistry();
schemeRegistry.register(
        new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
schemeRegistry.register(new Scheme("https", SSLCertificateSocketFactory.getHttpSocketFactory(50000,
        new SSLSessionCache(context)), 443));

ClientConnectionManager conManager = new ThreadSafeClientConnManager(params, schemeRegistry);
DefaultHttpClient httpClient = new DefaultHttpClient(conManager, new BasicHttpParams());
httpClient.setHttpRequestRetryHandler(retryhandler); 
```

感谢您的任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T10:03:06.290

```
06-14 17:26:48.770: W/System.err(15648):    at net.doo.download.ManualDocDownloader$AsyncDocDownloader.doInBackground(ManualDocDownloader.java:126)
06-14 17:26:48.770: W/System.err(15648):    at net.doo.download.ManualDocDownloader$AsyncDocDownloader.doInBackground(ManualDocDownloader.java:86) 
```

这表明您的代码正在引发异常，然后您的 try{}catch() 会向上传播。

您应该尝试捕捉`SSLException`，`IOException`以便您可以优雅地恢复并重新启动您的`AsyncTask`

# c# - Exchange Web 服务托管 API：如何通过 FindItem 方法执行重复扩展？

> ID：11036847
> 
> 赞同：3
> 
> 时间：2012-06-14T15:53:45.220
> 
> 标签：c#, exchangewebservices, exchange-server-2010, ews-managed-api, appointment

我们目前正在使用 Exchange Web Services Managed API 在我们的产品和 Exchange 之间创建同步服务。具体来说，我们希望（按时间安排）在用户日历上来回同步特定的约会。作为同步的一部分，我们不一定要同步所有约会，而是建立了一些复杂的 SearchFilters 来只返回我们想要的约会。我们的问题是，为了使用 SearchFilters，我们需要使用 ExchangeService.FindItems 方法，但是这个方法只返回重复事件的 Master Recurrence。我们的另一个选择是使用 ExchangeService.FindAppointment，这将为我们执行 Recurrence Expansion，但有一个新问题是我们只能使用开始和结束日期来限制结果约会。看看 ExchangeService.FindAppointment 是如何实现的，

如何使用复杂的 SearchFilter 从交换中获取扩展约会列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:15:01.840

刚刚在 MSDN 上找到了这个：http: [//msdn.microsoft.com/en-us/library/hh148195 (v=exchg.140).aspx](http://msdn.microsoft.com/en-us/library/hh148195(v=exchg.140).aspx)

**搜索日历约会的注意事项**

日历约会是搜索的特例。某些日历约会（例如定期约会）可能有例外和已删除的事件。为确保 Exchange 服务器在搜索日历文件夹时扩展定期约会，您需要使用日历分页。但是，当您使用日历分页时，您不能使用任何其他搜索限制。这意味着，例如，如果您想要显示特定组织者本月的所有日历约会，则无法创建基于该组织者的搜索过滤器。相反，您可以使用 CalendarView 类来查询当月的所有约会，然后根据组织者在客户端过滤约会。以下示例显示如何使用日历视图在日历中搜索约会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-02T12:04:23.160

对于任何使用 FindAppointments/CalendarView 发现 guxiyou 的解决方案不切实际的人，我的解决方案如下。CalendarView 在自动同步的情况下特别不方便，您最好使用“上次修改”过滤器而不是检索所有内容并过滤客户端，这不是很有效。

我使用了支持过滤器的常规 FindItems 方式，并在迭代约会时检查了 AppointmentType，如果是 RecurrenceMaster 类型，它将找到链接的事件并将它们添加到要同步的列表中。

下面的方法可以随后获取这些约会的发生情况。没有结束日期的循环模式将被忽略，因为它们会使您的循环无限。除非您限制同步窗口，否则必须对这些重复进行不同的处理才能进行同步。

```
 private IEnumerable<Appointment> GetRecurrentAppointments(Appointment masterAppointment)
    {
        Recurrence recurrence = masterAppointment.Recurrence;

        if (recurrence == null || !recurrence.HasEnd)
            yield break;

        for (int i = 1; i <= recurrence.NumberOfOccurrences; i++)
        {
            Appointment occurrence = Appointment.BindToOccurrence(ExchangeServiceProxy, masterAppointment.Id, i);

            yield return occurrence;
        }
    } 
```

# html - 使用 .htaccess 删除文件扩展名：带有斜杠的错误

> ID：11036848
> 
> 赞同：0
> 
> 时间：2012-06-14T15:53:45.663
> 
> 标签：html, .htaccess, file-extension

我想使用 .htaccess 从我的网站中删除像 .html 这样的文件扩展名。最终的结构应该是这样的：

```
http://domain.com/file  --> http://domain.com/file.html
http://domain.com/file/ --> http://domain.com/file.html 
```

使用 .htaccess 中的现有代码，当末尾有斜杠时，我的浏览器上会出现“内部服务器错误”。我能做些什么？谢谢！

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^(.*)$ $1.html 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T18:35:18.873

```
RewriteEngine On
RewriteBase /
RewriteRule ^([a-zA-Z0-9-_]+)/?$ $1.html [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:06:47.640

我建议你改变你的 RewriteCond ：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule  ^(.*)(\.html){0}$ /$1.html [L] 
```

编辑：规则已编辑，我忘记了无限循环。

# javascript - 如何有一个浮动的垂直导航菜单并让它调整它的位置？

> ID：11036852
> 
> 赞同：1
> 
> 时间：2012-06-14T15:53:58.663
> 
> 标签：javascript, jquery, html, css, scroll

我已经有一段时间了，我只是卡住了。我正在使用 Win XP、IE8 和 JQuery 1.4.4。

我想要的是导航菜单从标题下开始。但是一旦标题不在视图中，导航菜单将停留在滚动窗口的顶部。当用户向上滚动并且标题重新出现时，导航菜单应该再次停留在标题下方。

现在，它是浮动的，但没有调整我想要的方式。

这是我尝试过的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Please make this scrolling work</title>
    <link href="Styles/Navigation.css" rel="Stylesheet" type="text/css" />
    <script src="Scripts/jquery-1.4.4.min.js" language="javascript" type="text/javascript"></script>
    <script language="javascript" type="text/javascript">
        $(document).ready(function () {
            $(window).scroll(function () {
                //var bottom = $('#contents').height() + 100;
                var bottom = $(window).height();
                var top = $('#header').height();
                var top_start = top + 1;
                var top_limit;
                if (document.body.scrollTop <= top_start) {
                    top_limit = top_start;
                }
                else {
                    top_limit = 0;
                }
                $('#menu-bar').css('top', (top_limit) + "px");
                //$('#menu-bar').css('bottom', (bottom) + "px");
            });
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div id="header" style="clear:both;height:40%;">
        stuff
        <br />
        <br />
        more stuff
        <br />
    </div>
    <div class="menu-bar" style="float:left;width:25%;" id="menu-bar">
            <ul>
                <li><a href="#mainpage">Main Page</a>
                    <ul>
                        <li><a href="#search">Search</a></li>
                        <li><a href="#foo">Foo</a></li>
                        <li><a href="#bar">Bar</a></li>
                        <li><a href="#baz">Baz</a></li>
                        <li><a href="#blah">Blah</a></li>
                    </ul>
                </li>
            </ul>
    </div>
    <div id="contents" style="float:left;margin-left:25%;">
        olwqfjapnwvqjpfqjwfeoqjfepqfewjqpfjnqpefpkqjmewpofqne
        <br />
        powjunvejpqlewkjrvqpnewkjmqwofvjnewpfoqewkjponqejpewfmqewp
        <br />
    </div> 
```

以及菜单的 CSS：

```
.menu-bar{  
    position: fixed;
    overflow:scroll;
    height:100%;
    /*top:0;
    bottom:0;*/
} 
```

**编辑：** 这是修复。

```
 <script language="javascript" type="text/javascript">
        $(window).scroll(function () {
            //var bottom = $('#contents').height() + 100;
            var bottom = $(window).height();
            var top = $('#header').height();
            var top_start = top + 1;
            var top_limit;
            if ($(window).scrollTop() <= top_start) {
                top_limit = top_start;
            }
            else {
                top_limit = 0;
            }
            $('#menu-bar').css('top', (top_limit) + "px");
            $('#menu-bar').css('bottom', (bottom) + "px");
        });
    </script>
    </div>
    </form>

</body>
</html> 
```

虽然我不太明白为什么：

```
top_limit = 0; //works but...
top_limit = $(window).scrollTop(); //doesn't work. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:20:35.630

我认为您需要计算用户屏幕上方有多少空间。你必须用

这个

```
$(document).height() // this will give you the size of the whole document 
```

这个

```
window.innerHeight // this will give you the size of the screen 
```

和这个

```
window.pageYOffset // this will give you how much you had scrolled vertically 
```

很长一段时间以来，为了制作您需要的类似效果，我需要一个功能，如果标题不在视线范围内，我需要菜单保持在顶部，标题为 200px

```
function scrollControl(){
    if(($(document).height() - (window.innerHeight + window.pageYOffset))<=500){
        //what to do if the space below is 500px or less, for the footer
    }else if(window.pageYOffset>=200){
        //what to do if the space above is 200px or more, for the header
    }else{
        //what to do if the element was in the rest of the space
    }
} 
```

这是旧代码，如果您认为有错误，请多多关照，希望对您有所帮助。

# c# - 有没有办法根据 2 列的值过滤 UltraGrids？

> ID：11036855
> 
> 赞同：4
> 
> 时间：2012-06-14T15:54:13.967
> 
> 标签：c#, winforms, infragistics, ultrawingrid

假设我有一个带有*Foo*和*Bar*`UltraGrid`列的 Infragistic 。是否可以过滤表格以便只显示*Foo*和*Bar*不相等的行？

 ***例如，如果我有这些数据：

```
Foo  Bar
--------
0.1  0.1
0.1  0.2
0.2  0.2 
```

过滤器将隐藏第一行和第三行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T08:43:34.337

它比看起来更简单，我相信您不必创建额外的列或其他东西：

```
UltraGridColumn fooColumn = Grid.DisplayLayout.Bands[0].Columns["Foo"];
UltraGridColumn barColumn = Grid.DisplayLayout.Bands[0].Columns["Bar"];
ColumnFilter fooColumnFilter = fooColumn.Band.ColumnFilters[fooColumn];
fooColumnFilter.ClearFilterConditions();
fooColumnFilter.FilterConditions.Add(FilterComparisionOperator.NotEquals, barColumn); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T19:23:34.277

您应该能够从 Grid 设计器中执行此操作；

1.  `[Foo]!=[Bar]`使用公式为您的数据源创建一个新的布尔列。
2.  将隐藏列添加到网格并设置网格的`DisplayLayout.Override.RowFilterMode = RowFilterMode.AllRowsInBand`.
3.  在 中`grid.DisplayLayout.Band[].ColumnFilters`，添加一个`FilterLogicalOperator.And`带有新列的`FilterConditions.Add(FilterComparisionOperator.Equals, true)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T20:35:05.227

由于您不允许用户切换此过滤器并且正在使用 DataTable，因此最简单的解决方案是过滤 DataTable 而不是网格。

例如，如果您的 DataTable 是 fooData，您将使用以下内容：

```
fooData.DefaultView.RowFilter = "Foo <> Bar"; 
```***

# javascript - jQuery UI 对话框不会关闭

> ID：11036856
> 
> 赞同：-1
> 
> 时间：2012-06-14T15:54:23.640
> 
> 标签：javascript, jquery, jquery-ui

我正在使用以下代码打开一个对话框：

```
<li>
     <input type="button" value="Preview" onclick="showPreview('EmailPreview');" />
</li>

<div id="dialog"> 
    </div>
    <script type="text/javascript"> 
      //<![CDATA[
        $(document).ready(function () {
                $('#dialog').dialog({
                autoOpen: false,
                modal: true,
                height: 525,
                resizable: false,
                width: 600,
                dialogClass: 'timer'
            });
        });
      //]]>
    </script> 
</div> 
```

在我的 .js 文件中：

```
function showPreview(action, id) {
    $.get("/Manage/Account/" + action + "/" + id, function (data) {
        $("#dialog").html(data);
        $('#dialog').dialog('open');
        $('#Area, #Exchange, #Number').autotab_magic().autotab_filter('numeric');
        $("#dialog input[type='button'], #dialog select,#dialog input:checkbox,#dialog input:radio,#dialog input:file").uniform();
    }); 
```

我在 3 个位置使用这个确切的代码。在一个位置，一切都完美无缺。在其他两个位置，完全相同，只是在不同的视图中，对话框将打开但不会关闭。我有什么明显的遗漏吗？

这是在对话框视图中：

```
 <div class="top"><a onclick="$('#dialog').dialog('close'); return false"><img src="/public/images/admin/btn-close.png" /></a></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T15:59:52.427

我没有看到任何对话框在任何地方关闭，您可以使用此功能关闭对话框：

```
$('#dialog').dialog('close'); 
```

有关它的更多信息：[jQueryUI 对话框](http://docs.jquery.com/UI/Dialog)

此外，任何元素都必须具有唯一的 ID，因此它应该类似于`#dialog-a`, `#dialog-b`，否则 id 选择器等会出现错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:30:56.547

您的对话框元素 ID 必须是唯一的，否则 jQuery 将找不到正确的 ID。

# jsf-2 - 在 primefaces 中突出显示托管 bean 中的选定节点

> ID：11036857
> 
> 赞同：2
> 
> 时间：2012-06-14T15:54:25.670
> 
> 标签：jsf-2, primefaces

我有一个要求，我必须将树中新添加的节点突出显示为某种不同的颜色。我正在使用 JSF2 和 Primefaces 树组件。我正在尝试这样的事情：-

在托管 Bean 中，

```
getSelectedNode().setStyleClass("ui-helper-clearfix ui-tree-node-content ui-corner-all ui-tree-selectable-node ui-state-highlight"); 
```

在 xhtml 中，

```
<p:treeNode id="privilegesTreeNode" styleClass="#{privilegesTreeBean.selectedNode.styleClass}">
                        <h:outputText value="#{node}" id="lblNode" />
                    </p:treeNode> 
```

但是这个css应用于所有节点..不是选定的节点..然后我想可能会在某些情况下填充，我试过这个： -

```
<p:treeNode id="privilegesTreeNode" styleClass="#{privilegesTreeBean.selectedNode.styleClass ne '' ? privilegesTreeBean.selectedNode.styleClass : ''}">
                        <h:outputText value="#{node}" id="lblNode" />
                    </p:treeNode> 
```

任何人都可以帮助我，因为我陷入了困境。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T23:29:17.180

你的想法对我来说很好，例如

```
<h:outputText style="#{node.name == 'NEW NODE' ? 'background-color: yellow;' : 'background-color: none;'}" value="#{node}" /> 
```

# c# - 有人看到此错误：无法加载文件或程序集“System.EnterpriseServices.Wrapper.dll”？

> ID：11036859
> 
> 赞同：1
> 
> 时间：2012-06-14T15:54:41.283
> 
> 标签：c#, .net, assemblies

“/”应用程序中的服务器错误。解析器错误描述：解析服务此请求所需的资源时发生错误。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：无法加载文件或程序集“System.EnterpriseServices.Wrapper.dll”或其依赖项之一。试图加载格式不正确的程序。

源错误：

第 1 行：<%@ Application Codebehind="Global.asax.cs" Inherits="Premier.Global" Language="C#" %>

源文件：/global.asax 行：1

版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

还有一件事。每当我尝试使用 gacutil 命令行工具安装 System.EnterpriseServices.Wrapper.dll 时，它都会失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T15:59:01.253

如果您使用 IIS，请确保在您的特定应用程序池中将 IIS 设置为“启用 32 位应用程序”

如果您使用 Visual Studio，请确保您的项目构建属性在 Visual Studio 中设置为“任何 CPU”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T18:57:21.657

在我下载并安装了 .NET 框架 4.0 即 4.0.3 的更新以及我在下面列出的一些其他更新之后，该项目终于工作了：

[Microsoft .NET 框架 4 KB2468871](http://www.microsoft.com/en-us/download/details.aspx?id=3556)

[Microsoft .NET Framework 4 可靠性更新 1 (KB2533523)](http://www.microsoft.com/en-us/download/details.aspx?id=27014)

[Microsoft .NET Framework 4 可靠性更新 2 (KB2600217)](http://www.microsoft.com/en-us/download/details.aspx?id=28936)

[Microsoft .NET Framework 4 更新 4.0.3 – 运行时更新 (KB2600211)](http://www.microsoft.com/en-us/download/details.aspx?id=29053)

我注意到 .NET 框架的版本信息和 ASP.NET 的版本信息在我页面上的错误下方（即 .272）之间的差异后这样做了

> 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

再次感谢您的聆听。

# mysql - Mysql JOIN 多个表并选择多个值

> ID：11036861
> 
> 赞同：2
> 
> 时间：2012-06-14T15:54:53.880
> 
> 标签：mysql, join, rows

首先，我想为我糟糕的英语道歉。我有多个表的问题。我在 mySQL 世界中并不完全是新手，但我无法找到解决此问题的方法。对于这个问题，我使用 4 个表。

1.  类别
2.  产品
3.  规格
4.  规格值

每个类别都有规格和产品，每个规格值都有产品和规格 ID。现在用户可以使用不同的值进行选择。这就是我的问题所在。当用户选择值“绿色”和腿“4”时，我想要所有有 4 条腿的绿色产品。所以我使用 JOIN （我认为的所有类型）来选择正确的产品（下面的示例）

```
SELECT DISTINCT products.id 
FROM products 
  LEFT JOIN specificationvalues ON specificationvalues.products_id = products.id 
  LEFT JOIN specifications ON specificationvalues.specifications_id = specifications.id 
WHERE specifications.name='materiaal' 
  AND specifications.name='kleur' 
  AND specificationvalues.id='77' 
  AND specificationvalues.id='78' 
```

问题是所有值都在单独的行中。这就是 WHERE 不起作用的原因。我没有得到 MySQL 错误。只是它返回 0 行。

我希望有一个人可以帮助我！我从这个论坛得到了很多好东西，所以我希望它能再次帮助我！

* * *

我不知道为什么我昨天的更改没有保存。但这是我的数据：

```
SPECIFICATIONS Table
ID   CATEGORIES_ID     NAME
38   297               Material
39   297               Measures
40   297               Color

SPECIFICATIONVALUES Table
ID   SPECIFICATIONS_ID  PRODUCTS_ID   VALUE
1    38                 988979        Masive wood 
2    39                 988979        24x57x98
3    40                 988979        Yellow
4    40                 988980        Black
5    39                 388980        24x57x98

PRODUCTS Table
ID         NAME
988979     Table
988980     Chair 
```

所以现在我想要所有尺寸为 24x57x98 的黑色产品。我希望你能帮帮我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T17:09:47.023

我见过许多表的实例，这些表具有模拟表示“列”的行，其中名称是描述符，而“id”或“值”是关联的所需值。

您需要考虑的是 ONE ROW 的外观。您从规格名称到规格值的连接。'77' 值是否仅对应于 'material' 规格、'kleur' 或两者……同样适用于 78。您可以有多种组合，例如

```
where ( specifications.name = 'material' and specificationValues.id = '77' )
  OR  ( specifications.name = 'kleur' and specificationValues.id = '78' ) 
```

或者，如果规范值 ID 与规范名称无关，则可以使用

```
where specifications.name in ('material', 'kleur' )
  AND speciificationValues.ID in ( '77', '78' ) 
```

***根据您修改后的样本数据...*** 在您想要的这种类型的标准中，我会通过应用双连接来表示您想要的每个标准，例如：

```
select p.*,
       sv1.Value as NameOfColor,
       sv2.Value as ProductMeasurement
   from
      Products p

         JOIN SpecificationValues sv1
            on p.ID = sv1.products_id
           AND sv1.Value = 'Black'
            JOIN Specifications s1
               on sv1.Specifications_ID = s1.ID
              AND s1.Name = 'Color'

         JOIN SpecificationValues sv2
            on p.ID = sv2.products_id
           AND sv2.Value = '24x57x98'
            JOIN Specifications s2
               on sv2.Specifications_ID = s2.ID
              AND s2.Name = 'Measures 
```

现在，可能看起来很复杂，但看看简单性（通过连接段之间的显式间距）。但是，如果您想添加更多“crieria”要求，只需通过创建类似的 sv3、sv4、sv5 集来复制...现在，也就是说，如果您正在动态构建它，用户可以选择更多东西，并且您正在提供某种可读描述（颜色、尺寸、材料）的“选择”，然后只保留 ID，这样您就不需要额外的连接，只需知道实际的 ID，它就会被简化为.. .

```
select p.*,
       sv1.Value as NameOfColor,
       sv2.Value as ProductMeasurement
   from
      Products p

         JOIN SpecificationValues sv1
            on p.ID = sv1.products_id
           AND sv1.Specifications_ID = 40
           AND sv1.Value = 'Black'

         JOIN SpecificationValues sv2
            on p.ID = sv2.products_id
           AND sv2.SpecificationsID = 39
           AND sv2.Value = '24x57x98' 
```

现在，回到原始答案，您可以获得相同的结果（前提是您的示例数据永远不会有“24x57x98”的颜色或“黑色”的测量值。您可以应用 IN（代码列表）和 IN（值列表）并使用 HAVING 子句确保找到正确计数的匹配元素。我的 FINAL 查询不会使用“产品”作为第一个表，而是第二个，因为您可以拥有 10,000 个产品，但只有 142 个属于给定大小...从较小集合的表/标准开始，并加入产品以获取名称。

```
select
      p.id,
      p.name
   from
      specificationValues sv
         join products p
            on sv.products_id = p.id
   where
          sv.specifications_ID IN ( 39, 40 )
      AND sv.value in ( 'Black', '24x57x98' )
   group by
      p.id
   having
      count(*) = 2 
```

确保您的 specificationValues 表在 (specifications_ID, value) 上有一个索引。这样，索引可以匹配您查找数据的方式。有些人甚至可能建议将所有 3 个部分都包含在 (specifications_ID, value, products_id) 的索引中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:00:22.963

那不是因为`all the values are in separate rows`，那是因为您的 WHERE 子句始终为 false ：

```
WHERE specifications.name='materiaal' AND specifications.name='kleur' 
AND specificationvalues.id='77' AND specificationvalues.id='78' 
```

你不能拥有和 id 等于 77 AND 78。

您必须使用这种代码：

```
WHERE (specifications.name='materiaal' OR specifications.name='kleur')
AND (specificationvalues.id='77' OR specificationvalues.id='78') 
```

编辑：我的最后一个`AND`可能也是一个`OR`，取决于你的表。

# openssl - 使用 OpenSSL 进行签名和验证

> ID：11036863
> 
> 赞同：1
> 
> 时间：2012-06-14T15:55:02.517
> 
> 标签：openssl, rsa, sign, verify

我正在尝试使用 OpenSSL 进行签名和验证签名的基本练习。签名工作正常

```
$ openssl pkeyutl -hexdump -sign -inkey id_rsa -in test.txt > test.sig
Enter pass phrase for id_rsa:
$ cat test.sig
0000 - 20 ab 34 00 ff 87 50 1e-de fb c9 3d 10 2f 7b fd    .4...P....=./{.
0010 - 99 a1 61 e0 3d 5f 93 82-63 e9 0a 6f 1a 22 4f 04   ..a.=_..c..o."O.
etc... 
```

但是，当我尝试验证该签名时，出现错误。

```
$ openssl pkeyutl -verify -pubin -inkey id_rsa.pub.pem -signature test.sig test.txt
unable to load Public Key 
```

我尝试使用的公钥是 PEM 格式的转换后的 SSH 公钥：

```
-----BEGIN RSA PUBLIC KEY-----
MIICCAKCAf8wxsGr3b/rR/BsRqRMBaKPEGATYhSNaqnThcx9YdA7jHcj1dK7Utmo
nXZz7WwB0W1vzADZpzX96UUX5OIn1iByZ3ZQZpkO6YApMYxo/oHyiBYiCyEhbqKR
TydzmXFGYJ6UtLBFLD1eKfJokhiqdRa1kVMdAd6nBT5JiNb0ADO3VisyPwQZpqyB
Izbq1643JT2PC1BYk1cqqxyTnY/kAEEQvcQwrd0y7p29slRHC6g77HToWJLzNdAj
b2rjkRIfMzDx0LwmCuEqh+9XfVYQFJyrqXTrcgQlKBQhTSneSnn/9SpqYs4ziOIR
4djO9BbhGb/09LSb31NFy6S99rXsElI2aSaaGz5y6/6wyYq+zMxmiS//iCV/heNv
i3PH+D2hxOdz+VEvAJ77x4cMOn3ovVW73aWoBsNP8c9ISKt6MSXClljskA1WFcYJ
9UuBicQ/FGL2j96lzQ2NZZrYru0gAOkj3WUF/z5ORGC7iRvgOc89oqUxKNG+N/RN
jrMbCBAN8hOlJCW0e7/MoangYtBtZ52ZSIxYACRRfKTUlKdjsE9UVYrqBtTeVDGp
Igb+0kuBD61XF6IpnHEX0OZeArL7FY1trDJ85lUU09qNbnlnxNAY2Qo3cZiXSRBW
ROBUxz0OzF2Gvj30BEiY1rshH+XtM5ViQo1nK+YkBQcrCbwfnCFBAgMBAAE=
-----END RSA PUBLIC KEY----- 
```

用命令生成

```
ssh-keygen -f key.pub -e -m pem 
```

根据我阅读过的有关此问题的讨论和文档，这*应该*可行。但事实并非如此。

有什么提示吗？

* * *

**编辑**：我刚刚尝试了使用 OpenSSL 生成的一对密钥而不是转换后的 SSH 密钥的相同过程。那只是默默地失败而不是产生错误（`openssl`给我`pkeyutl`使用信息而不是验证签名）。

**编辑 2**：使用二进制签名（省略`-hexdump`）对使用 OpenSSL 生成的密钥具有相同的效果。在转换后的 RSA 密钥上，我得到

```
unable to load Public Key
Error initializing context
[snip usage output] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-08T08:45:47.623

你给了不存在的选项`-signature`。正确的是`-sigfile`。以下作品：

```
$ openssl pkeyutl -sign -inkey key.pem -in data.txt > test.sig
$ openssl pkeyutl -verify -pubin -inkey pubkey.pem -sigfile test.sig -in data.txt
Signature Verified Successfully 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-11T00:59:15.620

我猜这个`-hexdump`选项是因为你不想得到一个二进制文件而被使用的？您可以使用`base64`将二进制 sig 编码为 ascii：

```
openssl pkeyutl -sign -inkey id_rsa -in test.txt | base64 > test.sig 
```

但是，当您验证这一点时，您将不得不在某个临时文件中将其转换回二进制文件：

```
cat test.sig | base64 -d > ~test.sig.bin 
```

您的公钥文件采用“rsa 公钥格式”，您可以在标题行“BEGIN RSA PUBLIC KEY”中看到。您可以将其转换为非 rsa 公钥格式，该格式将具有标头“BEGIN PUBLIC KEY”：

```
openssl rsa -in id_rsa.pub.pem -RSAPublicKey > id.pub.pem 
```

最后，使用 'PUBLIC KEY' pem 和二进制 sigfile，您可以验证：

```
openssl pkeyutl -verify -pubin -inkey id.pub.pem -sigfile ~test.sig.bin -in test.txt 
```

输出：

```
Signature Verified Successfully 
```

# java - 单元测试 Struts

> ID：11036867
> 
> 赞同：1
> 
> 时间：2012-06-14T15:55:28.840
> 
> 标签：java, unit-testing, struts

我有以下 Struts 动作：

```
 public ActionForward addSomething(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception {

    SomeForm sForm = (SomeForm) form;        
    Test t = testForm.toTest();

    if (tDao.checkExistsTest(t.getTest())) {            
        return mapping.findForward("failure");          
    } else {
        t.setType(new TestType(tess));
        t.setPassword(testForm.getPassword());

        tDao.add(t);

        return mapping.findForward("success");
    }        
} 
```

我做了以下代码来测试*testAddSomethingSuccess*方法：

```
 @Test
public void testAddSomethingSuccess() throws Exception {
    form.setTest("LOL");
    form.setTestName("lol");
    form.setPassword("12345");

    ActionForward forward = action.addSomething(mapping, form, request, response);

    assertEquals(tDao.getList().get(0).getTest(), "LOL");
    assertEquals(tDao.getList().get(0).getTestName(), "lol");
    assertEquals(tDao.getList().get(0).getPassword(), "12345");

    assertEquals("success", forward.getName());
} 
```

如何实现*testAddClientFailed()*？？？：

```
 @Test
public void testAddSomethingFailed() throws Exception {
    form.setTestName("lol");
    t.checkIfExists("lol");

    ActionForward forward = action.addSomething(mapping, form, request, response);

    assertEquals("failure", forward.getName());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:01:59.250

您需要模拟`tDao`并使`checkExistsTest`return false 。

在你的类中有方法

```
 public ActionForward addSomething(...) 
```

您应该注入（通过构造函数）或通过 setter 方法进行设置，`TDao`该方法的实现为该方法返回 false，例如

```
FakeDao implements TDao {
 public boolean checkExistsTest(...) {return false;}
} 
```

或子类化具体的 DAO 并覆盖此方法。

您还可以使用模拟框架来提供[JMock](http://www.jmock.org/)或[Mockito](http://code.google.com/p/mockito/)之类的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:02:06.853

通过实现一个 DAO，无论是具体的还是通过模拟的，它返回`false`for `checkExistsTest`，并像现在一样检查转发名称——还有什么？

这就是依赖注入/控制反转如此有用的原因之一。

在不了解您的测试方式、DAO 的实例化方式/等等的情况下。很难提供具体的帮助。最终（希望很明显）测试失败，你必须失败。

# iphone - 自定义 UITableViewCells 偶尔会保持突出显示并且不推送下一个视图

> ID：11036873
> 
> 赞同：0
> 
> 时间：2012-06-14T15:56:00.037
> 
> 标签：iphone, objective-c, ios5, uitableview

我有一个带有自定义 UITableViewCells 的 UITableView，大多数时候当它们被触摸时，didSelectRowAtIndexPath: 被调用，并推送了一个新视图。然而，有时当他们以某种方式被点击时（点击并按住大约一秒钟），他们将保持突出显示并且不会推动下一个视图，直到在屏幕上的其他任何地方检测到另一个点击。我尝试在 didSelectRowAtIndexPath: 中记录一条消息：并确认在这些情况下没有调用它。该方法中的代码是：

```
PortfolioVC *portfolioController = [self.storyboard instantiateViewControllerWithIdentifier:@"portfolioIdentifier"];
AccountInformationVC *accountController = [self.storyboard instantiateViewControllerWithIdentifier:@"accountIdentifier"];
[[Globals Variables] setIndex:indexPath.row];

if (indexPath.section == 0)
    [self.navigationController pushViewController:accountController animated:YES];
if (indexPath.section == 1)
    [self.navigationController pushViewController:portfolioController animated:YES]; 
```

通过将 selectedBackground 连接到包含突出显示的图像的 UIImageView，在自定义 UITableViewCell 的 xib 中设置突出显示的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:34:49.013

我解决了这个问题。我不得不重新连接自定义单元 xibs 中的背景 UIImageViews。之后，清理构建并删除应用程序，问题得到解决。我还尝试覆盖自定义 UITableViewCells 中的 setSelected 和 setHighlighted 方法，并删除了这些方法。

# asp.net-mvc-4 - ASP.NET MVC Web API 将 XML 粘贴为类型

> ID：11036875
> 
> 赞同：1
> 
> 时间：2012-06-14T15:56:07.000
> 
> 标签：asp.net-mvc-4

旧的[WCF Rest Starter Kit](http://aspnet.codeplex.com/releases/view/24644)有一个有趣的功能。它是`Edit`名为`Paste XML as Types`. [您可以在Tim Heuer 关于该工具的博客文章](http://timheuer.com/blog/archive/2009/04/29/paste-your-rest-api-as-strong-type-in-visual-studio.aspx)中看到这一点。

WCF REST Starter 工具包因[ASP.NET MVC Web API](http://www.asp.net/web-api)而被贬值，但该功能或类似功能是否仍然存在？或者，`Paste JSON as Types`？

在 Visual Studio 中有一个工具会很有用，您可以在其中粘贴 JSON 或 XML 示例并生成一个类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-30T06:04:51.213

这里有一篇关于这个问题/功能的博客文章：

[http://www.jphellemons.nl/post/Use-JSON-resource-in-AspNet-C-super-easy-and-fast.aspx](http://www.jphellemons.nl/post/Use-JSON-resource-in-AspNet-C-super-easy-and-fast.aspx)

Mads Kristensen 的 Web Essentials 包可以满足您的需求（除其他外）：

[http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6](http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6)

# iphone - 在objective-c中找出直角三角形的角度

> ID：11036877
> 
> 赞同：0
> 
> 时间：2012-06-14T15:56:33.900
> 
> 标签：iphone, objective-c, ios

我正在尝试计算与屏幕中间相关的点击角度。但也许我对应该如何`atanf`工作感到困惑。

```
CGPoint pt = [self convertTouchToNodeSpace:[touches anyObject]];
    float adj = pt.x - 512;
    float opposite = pt.y - 384;
    float combined = opposite / adj;
    float tan = atanf(combined); 
```

但是当我尝试使用 NSLog Tan 时，我会得到一些巨大的数字，比如`0.1253649`

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:05:15.013

将矢量转换为角度的正确方法是通过`atan2`函数：

```
float angle = atan2f (pt.y - 384, pt.x - 512) * 180 / PI; 
```

PS：你用的是`cocos2d`引擎吗？它有`ccpToAngle(...)`功能。

# php - 无法从 PDO 查询中获取数组

> ID：11036879
> 
> 赞同：0
> 
> 时间：2012-06-14T15:56:37.573
> 
> 标签：php, mysql, pdo

我正在尝试使用 pdo 从 SQL 查询中获取一个数组，例如我发送给它的方法`$connection->selectFrom('Person',array(1,2));`

当我尝试获取结果时，它返回一个空数组，这是我的代码：

```
public function selectFrom($table,$indexes){
    try{
        $pdo=$this->getPdo();
        // HERE I GET ALL THE COLUMN NAMES FROM THE TABLE I RECEIVE
        $columns = $this->getColumnNames($table);
        $finals = array();
        // IN THIS CICLE I GET THE COLUMNS THAT MATCH THE INDEXES I RECEIVE
        for($i=0;$i<count($indexes);$i++){
            $finals[$i] = $columns[$indexes[$i]];
        }
        // FROM HERE I GET THE QUERY STATEMENT WICH IS SELECT column1,column2 from $table 
        $query = $this->getSelectSQL($table, $finals);

        // ALL OF THE ABOVE WORKS BUT HERE IT STOPS WORKING
        $results =  $pdo->query($query);

        return $results;

    }catch(PDOException $ex){
        echo "EXCEPTION ".$ex;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:38:03.450

感谢@Cymbals 的回答，最终代码如下：

```
public function selectFrom($table,$indexes){
    try{
        $pdo=$this->getPdo();

        $columns = $this->getColumnNames($table);
        $finals = array();

        for($i=0;$i<count($indexes);$i++){
            $finals[$i] = $columns[$indexes[$i]];
        }

        $query = $this->getSelectSQL($table, $finals);
        $query.= " WHERE Available = 1";

        $stmt = $pdo->prepare($query);

        $stmt->execute();

        $results = $stmt ->fetchAll();
        return $results;            

    }catch(PDOException $ex){
        echo "EXCEPTION ".$ex;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:09:28.863

得到查询后试试这个，准备并执行

```
 $stmt = $pdo->prepare($query);
      var_dump($stmt);// if the prepare fails or sql query is messed up it will give false
      $results = $stmt->execute();
      return $results; 
```

# reportingservices-2005 - SSRS 2005 报告 - 使用列表的 2 页

> ID：11036883
> 
> 赞同：0
> 
> 时间：2012-06-14T15:56:53.503
> 
> 标签：reportingservices-2005

我有一份 SSRS 报告，我的任务是向其中添加第二页。第一页由列表定义。我扩大了报告的正文区域以容纳第二个列表。两个列表的大小均为 8.5 x 11。

我的问题是这个。

这是添加第二页的正确方法吗？如果是，我怎样才能让它在第一页的每条记录之后显示第二页？

谢谢！

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T06:53:37.377

据我了解，您希望在第一个列表的每条记录之后显示一条记录。如果是，请尝试执行以下操作：

1.  添加一个新报告，这将是第二页。

2.  在第一个列表页面中，将新报告作为子报告添加到列表中。

3.  现在，在列表 1 中的每条记录之后，您将看到来自第 2 页的记录。

4.  如果有要从 list1 发送到子报告的参数，请右键单击列表 1 中的子报告，从列表 1 添加适当的参数。

# python - 无法为 python 2.7.3 安装 xlrd 0.7.8

> ID：11036885
> 
> 赞同：0
> 
> 时间：2012-06-14T15:57:03.370
> 
> 标签：python, windows-7, installation, xlrd

对于当前版本，我找不到任何东西，但我的问题正是标题所说的。Python 已安装并可以正常工作，但是当我尝试使用上列出的说明安装 xlrd 时（在安装目录中打开 cmd，然后输入“python setup.py install”），但这给了我一个错误，说命令 python 没有'不存在。双击安装文件不起作用，黑色的cmd框在屏幕上快速闪烁，没有时间阅读它所说的内容，也没有在它们应该所在的目录中安装任何文件。

另外，因为它可能是相关的，我没有在这台计算机上安装程序的权限（IT 部门必须为我安装 python 和 N++ ......）。就 Windows 7 而言，我不知道这是否算作需要提升的软件安装。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:01:16.887

如果您的命令解释器在安装时告诉您“命令 python 不存在”，则表示它不在您的 PATH 环境变量中。

这是关于如何在 Windows 7 上执行此操作的小教程：http: [//www.windows7hacker.com/index.php/2010/05/how-to-addedit-environment-variables-in-windows-7/](http://www.windows7hacker.com/index.php/2010/05/how-to-addedit-environment-variables-in-windows-7/)

添加您的 python.exe 所在的路径。通常类似于*C:\Python27*

# javascript - 在Javascript中设置绝对位置不起作用

> ID：11036890
> 
> 赞同：1
> 
> 时间：2012-06-14T15:57:22.563
> 
> 标签：javascript, asp.net, css, css-position

当 gridview 延伸超过标准 960 像素时，我试图将我的 gridview (asp.net) 位置设置为绝对位置。

但是，我遇到了`left: 0`我想要的效果的问题，但是除此之外的任何东西都不起作用。

这是我的代码。它小于屏幕的部分不起作用，因为我试图将其置于屏幕中心。但是，由于它大于 0，所以 的绝对位置`Left: x`不起作用。任何帮助，将不胜感激！

```
 var gridview = document.getElementsByTagName("table");
            var fieldset = document.getElementsByTagName("fieldset");
            fieldset[0].style.position = "relative";
            for (var i = 0; i < gridview.length; i++) {
                var width = gridview[i].offsetWidth;
                var screenWidth = window.screen.width - 2;

                if (width > 940) {
                    gridview[i].style.position = "absolute";
                    if (width > screenWidth) {
                        gridview[i].style.left = 0;
                        alert('> screen');
                    }
                    else {
                        gridview[i].style.left = 50;
                        alert('< screen');
                    }
                }
            } 
```

编辑：修复是在值之后连接“px”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T12:59:03.833

还不足以继续下去，但可能是 gridview 的容器没有将它的位置设置为你的 css。

要使用`postion:absolute`上面的容器，应该设置为，`position:relative`否则它不会渲染 css。

还尝试将 px 添加到您的大小末尾，将 css 设置为 left:XXpx; 而不仅仅是一个数字。

# php - 为什么我不能在 MAMP 环境中使用 shell_exec 执行 ffmpeg？

> ID：11036895
> 
> 赞同：1
> 
> 时间：2012-06-14T15:57:38.973
> 
> 标签：php, ffmpeg, mamp

我试图在我的 MAMP 环境中从 php 运行 ffmpeg 命令，但它不起作用。我已经将它添加到我的路径中。我可以成功运行诸如 whoami 和 ls -la 之类的 shell 命令，但 ffmpeg 似乎不起作用。我还安装了 ffmpeg-php，但它不支持我需要的功能——视频 > 图像堆栈。

示例代码：

```
<?php
    if (shell_exec("/usr/local/bin/ffmpeg")) 
        { echo "Success"; }
        else 
        { echo "No good"; }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-05T01:33:28.527

您应该尝试打开文件 /Applications/MAMP/Library/bin/envvars 然后注释 if 和 else 的四行。这将如下所示：

```
#if test "x$DYLD_LIBRARY_PATH" != "x" ; then
#  DYLD_LIBRARY_PATH="/Applications/MAMP/Library/lib:$DYLD_LIBRARY_PATH"
#else
#  DYLD_LIBRARY_PATH="/Applications/MAMP/Library/lib" 
```

这对我来说可以！在我的情况下，我还设置了所有项目权限，如 777。如果你需要这样做，你需要执行终端命令

```
chmod -R 777 projectDirectory 
```

在文件 htdocs 目录上。我希望你能享受它。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-20T10:00:22.433

1.找到文件/Applications/MAMP/Library/bin/envvars_

2.将此文件重命名为/Applications/MAMP/Library/bin/envvars

3.注释此文件的所有行。

4.写这个：

```
PATH="/Applications/MAMP/bin/php5.6.10/bin:usr/local/bin:$PATH"

export PATH 
```

注意：php5.6.10 - 你必须写你当前的php版本

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-17T11:25:31.187

stackexchange 上的此链接有效[https://superuser.com/questions/404344/ffmpeg-works-on-terminal-not-with-php-exec](https://superuser.com/questions/404344/ffmpeg-works-on-terminal-not-with-php-exec)

像这样在命令的末尾添加 '2>&1'

```
<?php 
    $info = shell_exec('/usr/local/bin/ffmpeg -i '.$inputMp3Path.' 2>&1');
    var_dump($info);
?> 
```

# android - 填充没有哈希图的多列列表视图

> ID：11036896
> 
> 赞同：0
> 
> 时间：2012-06-14T15:57:39.417
> 
> 标签：android, android-layout, android-widget

我今天一直在阅读有关多列列表视图的信息。它们似乎是我需要的，但无法提供有关如何在不使用哈希映射的情况下填充它们的信息。我见过的所有示例都使用哈希映射来构建列表视图数据适配器，但是当隐含大量数据时，这太重了。无论如何要填充没有哈希列表的列表视图吗？

我见过的所有例子都使用这样的东西： [http ://saigeethamn.blogspot.com.es/2010/04/custom-listview-android-developer.html](http://saigeethamn.blogspot.com.es/2010/04/custom-listview-android-developer.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:17:19.903

是的，有可能。请查看代码。

```
public class List_view_ArrayAdapter extends ArrayAdapter<String> {
    private Context context;
    private String[] name;
    private String[] address;
    private String[] rating;
    private TextView nameTextView;
    private TextView addressTextView;
    private ImageView lisiconImageView;
    private AppManagers appManagers;

    public List_view_ArrayAdapter(Context context, String[] name,
            String[] address, String[] rating) {
        super(context, R.layout.list_layout, name);
        this.context = context;
        this.name = name;
        this.address = address;
        this.rating = rating;
        appManagers = new AppManagers();

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.list_layout, parent, false);
        nameTextView = (TextView) rowView.findViewById(R.id.nameTextView);
        addressTextView = (TextView) rowView.findViewById(R.id.addressTextView);

        lisiconImageView = (ImageView) rowView
                .findViewById(R.id.listiconImageView);
        nameTextView.setText(name[position]);
        addressTextView.setText(address[position]);

        lisiconImageView.setImageDrawable(appManagers
                .ImageOperations(rating[position]));
        // imageView.setImageResource(imageid[position]);
        return rowView;
    }

} 
```

这是这一行“R.layout.list_layout”的list_layout

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" android:background="#d9d9d9">

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical" android:layout_marginBottom="5dp" android:layout_marginTop="5dp">

        <ImageView
            android:id="@+id/listiconImageView"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:src="@drawable/ic_launcher" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" android:layout_marginLeft="5dp" android:gravity="center_vertical" android:layout_marginBottom="5dp" android:layout_marginTop="5dp">

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Name : "
                android:textColor="#2a170e" />

            <TextView
                android:id="@+id/nameTextView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="TextView"
                android:textColor="#2a170e" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:id="@+id/textView2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Address : "
                android:textColor="#2a170e" />

            <TextView
                android:id="@+id/addressTextView"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="TextView"
                android:textColor="#2a170e" />
        </LinearLayout>

    </LinearLayout>

</LinearLayout> 
```

最后你从你的主要活动中调用它。

```
new List_view_ArrayAdapter arrayAdapter= new List_view_ArrayAdapter(context, appManagers.getNameArray(cafeandbarsList), name, address, rating); 

listView.setAdapter(arrayAdapter); 
```

我认为它对你有帮助。

谢谢

# regex - 在一个表达式中使用正则表达式查找所有（大多数）html 代码

> ID：11036899
> 
> 赞同：1
> 
> 时间：2012-06-14T15:57:53.623
> 
> 标签：regex

我正在尝试搜索许多文档并查找指定 html 代码的所有实例，但使用 > 和 < 时除外。

以下搜索

```
&[a-z]*\; 
```

匹配所有 HTML 代码，例如 > 等。

我想修改这个搜索，所以我可以说，给我所有的 HTML 代码，除了 > 和 <。我需要能够在一个表达式中做到这一点。

使用[http://regexpal.com/](http://regexpal.com/)和以下作为示例文本：

```
&nbsp;&gt;&lt;&trade; 
```

只应突出显示第一个和最后一个代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:03:08.523

试试这个：`&[A-Za-z]+(?<!&gt|&lt);`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T16:06:43.250

第一个字母不是“g”或“l”，或者第二个不是“t”，或者超过 2 个字母。所以：

```
&([a-fh-km-z][a-z]|[lg][a-su-z]|[a-z]{3,})[a-z]*; 
```

如果您也需要匹配单个字母，则必须为此添加替代选项。

# iphone - 带有背景图片和动态高度的 UITableViewCell

> ID：11036900
> 
> 赞同：1
> 
> 时间：2012-06-14T15:57:57.073
> 
> 标签：iphone, objective-c, ios, uitableview

我有一个显示书籍列表的 tableView，每个表格单元格都包含“书籍名称”和“书籍描述”。单元格的高度由书籍描述的长度决定，因此单元格有不同的高度。

每个单元格也有一个背景图像，当然它会根据单元格的高度进行定型。

我正在单元格drawRect中绘制背景图像，如下所示：

```
- (void)drawRect:(CGRect)rect
{
    UIImage *bgImage = [UIImage imageNamed:@"cell_BG.png"];
    bgImage = [bgImage stretchableImageWithLeftCapWidth:60.0 topCapHeight:60.0];
    [bgImage drawInRect:rect];
} 
```

这段代码有效，问题是滚动性能，它不像我想要的那样流畅。
我注意到主要问题是高度变化，这似乎触发了对所有单元格的 drawRect 调用，包括可重复使用的单元格。
（当我尝试为所有单元格设置相同的高度时，滚动性能显着提高，但我必须使用动态高度......）

有没有更好的方法来做到这一点，所以表格滚动会得到改善？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:07:12.850

您可能不想覆盖 drawRect`UITableViewCell`的视图，因为 drawRect 非常昂贵。

尝试将 a`UIImageView`放在原型单元的顶部并设置其图像（您可以通过编程方式执行此操作，也可以直接拖入界面构建器）。然后，您可以设置图像视图的框架大小以匹配其各自的动态高度`UITableViewCell`。`UIImageView`针对图像进行了优化，因此这种方法应该运行得更顺畅。

您可以在您的 cellforRowAtIndexPath 方法中设置 imageView 的图像和帧大小`UITableViewController`。

更新：您可能还希望将内容模式设置为缩放并适合您的图像。

来自 UIView 类参考：“contentMode - 提供视图内容的布局行为，而不是视图的框架。此属性还影响内容如何缩放以适应视图以及是否缓存或重绘。”

例如，只要视图的框架发生变化，重绘就会调用 drawRect。

它可以通过编程方式设置：

```
UIView* view = [[UIView alloc] initWithFrame:CGRectMake...etc];
view.contentMode = UIViewContentModeRedraw; // for example 
```

或者只是通过在界面构建器中选择视图并在属性检查器中设置内容模式属性。我认为您正在寻找 UIContentModeScaleToFit 或类似的东西。此外，如果使用界面生成器，请在尺寸检查器中检查 UIImageView 的支柱和弹簧。

# apache-camel - 调用 webservice 方法时出现 LinkageError

> ID：11036901
> 
> 赞同：0
> 
> 时间：2012-06-14T15:58:02.033
> 
> 标签：apache-camel, cxf, linkageerror

我有一个调用 bean 的 apache servicemix (camel 2.9) 路由，它反过来发出 SOAP 请求。SOAP 代码是通过 wsdl2java 生成的并且工作正常（cxf 2.4.0）。我遇到的问题是当抛出 SOAP 错误时，我得到以下问题：

```
Caused by: java.lang.LinkageError: loader constraint violation: loader (instance of <bootloader>) previously initiated loading for a different type with name "javax/xml/soap/SOAPFault"
    at javax.xml.ws.soap.SOAPFaultException.<init>(SOAPFaultException.java:28)
    at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:156)[175:org.apache.cxf.bundle:2.5.0.fuse-7-061]
    at $Proxy120.catalogProductAttributeMediaRemove(Unknown Source)
    at com.boohoo.magento.MagentoProducts.deleteImageFromProduct(MagentoProducts.java:403)[769:magento-soap-api:1.0.0.SNAPSHOT]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.6.0_29]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)[:1.6.0_29]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)[:1.6.0_29]
    at java.lang.reflect.Method.invoke(Method.java:597)[:1.6.0_29]
    at org.apache.camel.component.bean.MethodInfo.invoke(MethodInfo.java:340)
    at org.apache.camel.component.bean.MethodInfo$1.proceed(MethodInfo.java:237)
    at org.apache.camel.component.bean.BeanProcessor.process(BeanProcessor.java:166) 
```

通过一些谷歌搜索（我的背景是 C#），错误似乎表明该类已被多次加载，但我看不出这是怎么可能的，因为 SOAPFaultException 不是我的类之一。

有任何想法吗？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T07:23:17.260

我发现这是 servicemix 配置的问题。见： http: [//fusesource.com/forums/thread.jspa?threadID=4016](http://fusesource.com/forums/thread.jspa?threadID=4016)

# java - 如何将组件添加到标签？

> ID：11036902
> 
> 赞同：4
> 
> 时间：2012-06-14T15:58:03.073
> 
> 标签：java, html, wicket, wicket-1.5

我有以下html：

```
<label wicket:id="drugSearchResult.row.item.label" for="drug_1">[Drug XYZ]  
    <span wicket:id="drugSearchResult.row.item.info">[Information, Price, Other]</span>
</label> 
```

但是标签元素不允许添加子组件。有什么办法可以实现这个 html 要求？

这是设计师的要求：

> Drug XYZ //**标签**
> 信息、价格、其他 //**跨度**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-14T19:46:25.500

Make sure you're using `FormComponentLabel` for the `<label>` element instead of `Label`.

[`Label`](http://wicket.apache.org/apidocs/1.4/org/apache/wicket/markup/html/basic/Label.html)'s purpose is to output text inside the associated element (it can be a `<span>`, `<div>` or almost any other tag).

[`FormComponentLabel`](http://wicket.apache.org/apidocs/1.4/org/apache/wicket/markup/html/form/FormComponentLabel.html)'s purpose is to model [`<label>`](http://www.w3.org/TR/html401/interact/forms.html#h-17.9.1) tags. They receive the [`FormComponent`](http://wicket.apache.org/apidocs/1.4/org/apache/wicket/markup/html/form/FormComponent.html) they're related to and automatically output the `for` attribute with the proper value for the dom `id` attribute.

Take a look at the Wicket wiki page on [Form control labels](https://cwiki.apache.org/confluence/display/WICKET/Form+control+labels). They're adding components to `FormComponentLabel` there.

If you'd like to avoid using `FormComponentLabel` at all, you shouldn't be giving it a `wicket:id` attribute, and manually set the DOM `id` attribute of the element the `<label>` is going to refer to. Then just use it in the `for` attribute of the `<label>`.

For instance:

**HTML**

```
<input wicket:id="drug">
<label for="drug_1">[Drug XYZ]  
    <span wicket:id="drugSearchResult.row.item.info">[Information, Price, Other]</span>
</label> 
```

**Java**

```
TextField drug = new TextField("drug");
drug.setMarkupId("drug_1"); // Make sure this ID is unique in the page!
drug.setOutputMarkupId(true);
add(drug);
Label drugDescription = new Label("drugSearchResult.row.item.label", aModel);
add(drugDescription); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-05T08:27:18.747

### 使用属性和`<wicket:message>`

对我来说，下面的方法很有用。
在我的项目中，我每页只有一个位置，其中`<label>`定义了 s 和验证消息的文本。它是网页的属性文件。

附加`<div>`的 s 及其类属性来自 Bootstrap。

```
<div class="form-group required">
    <label wicket:for="customer.name1">
        <wicket:message key="customer.name1"/>
    </label>
    <div class="controls">
        <input type="text" wicket:id="customer.name1" required class="form-control">
    </div>
</div> 
```

爪哇

```
add(new RequiredTextField<String>("customer.name1")
         .setLabel(new StringResourceModel("customer.name1"))); 
```

customerPage.properties

```
# siehe wicket-core-7.9.0-sources.jar!/org/apache/wicket/Application_de.properties
Required='${label}' ist erforderlich
customer.name1=Name 1
customer.name2=Name 2
customer.department=Abteilung
customer.phone=Telefon
customer.active=aktiv 
```

# trigger.io - 尝试运行新创建的应用程序时“没有这样的文件或目录”

> ID：11036904
> 
> 赞同：0
> 
> 时间：2012-06-14T15:58:09.760
> 
> 标签：trigger.io

我刚刚发现了 forge，并想立即尝试一下。我密切关注[http://docs.trigger.io/en/v1.3/getting-started.html#mac-and-linux-users](http://docs.trigger.io/en/v1.3/getting-started.html#mac-and-linux-users)上的教程，一切都很顺利，直到我尝试实际运行我的应用程序：

```
(forge-environment) forge run web
[   INFO] Forge tools running at version 3.3.2
[   INFO] Checking JavaScript files...
[   INFO] JavaScript check complete
[   INFO] Verifying your configuration settings...
[   INFO] Configuration settings check complete
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/usr/lib/python2.7/threading.py", line 551, in __bootstrap_inner
    self.run()
  File "/usr/lib/python2.7/threading.py", line 504, in run
    self.__target(*self.__args, **self.__kwargs)
  File "/home/mononofu/Programmieren/ArmorCalc/.template/generate_dynamic/utils.py", line     163, in runner
    state.proc = lib.PopenWithoutNewConsole(args, stdout=subprocess.PIPE,     stderr=subprocess.STDOUT, env=kw.get('env'))
  File "/home/mononofu/Programmieren/ArmorCalc/.template/generate_dynamic/lib.py", line 155,     in __init__
     self._old_popen.__init__(self, *args, **kwargs)
  File "/usr/lib/python2.7/subprocess.py", line 679, in __init__
     errread, errwrite)
  File "/usr/lib/python2.7/subprocess.py", line 1249, in _execute_child
     raise child_exception
OSError: [Errno 2] No such file or directory 
```

（它实际上并没有崩溃，只是挂了一会儿，然后以状态 131 退出）无论我如何尝试运行它（android，web），都会发生这种情况。我在 Ubuntu 12.04 上，一切都更新了。我没有改变任何默认值，只是`create`然后`build`

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T10:13:19.343

未发现与模拟器/设备交互的潜在错误`adb`：我们已在此处修复了糟糕的错误消息，以便其他 Linux 用户不会以同样的方式卡住！

# jquery - jQuery UI Slider - 需要记住浏览器“返回”上的值

> ID：11036905
> 
> 赞同：3
> 
> 时间：2012-06-14T15:58:09.743
> 
> 标签：jquery, jquery-ui, jquery-ui-slider

我在高级搜索表单中使用 jQuery UI 滑块（准确地说，我使用的是范围滑块）。我用它来按时长（按分钟）过滤视频。

到目前为止，它工作得很好。

默认值为 5 到 55。

现在我要做的是：当我将其更改为 20-30 时，提交表单，查看结果。当我在浏览器上点击“返回”时，我希望该值为 20-30，而不是默认值。所以，我基本上是想让滑块记住我回去时选择的值。

首先，是否有可能做到这一点？如果是这样，我需要帮助，因为我不知道如何！

这是一个工作小提琴，可以看到我的滑块在运行：http: [//jsfiddle.net/nbjgH/](http://jsfiddle.net/nbjgH/)

这是我的html表单：

```
<form id="advancedSearch" name="advancedSearch" class="search" action="/advancedsearchrun/">
    <input type="text" name="query" autofocus="autofocus" value="{{ query|default('') }}" >

    <div class="slider-time">
        <label for="timeRange">Filter by duration:</label>
        <input type="text" id="timeRange" />
        <input type="hidden" id="min_minutes" name="min_minutes" value="0" />
        <input type="hidden" id="max_minutes" name="max_minutes" value="5" />
    </div>

        <input class="not_rounded_right float-left" type="submit" value="Search">
</form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T16:22:17.893

您可以使用[jQuery cookie](https://github.com/carhartl/jquery-cookie)以一种非常简洁的方式实现此目的。

加载 cookie，如果为 null，则设置默认值：

```
if ($.cookie('min')==null){
    $.cookie('min',5);
}
if ($.cookie('max')==null){
    $.cookie('max',55);
} 
```

经过

```
values: [ $.cookie('min'), $.cookie('max')] 
```

到您的滑块构造函数

火

```
$( "#min_minutes" ).val(  ui.values[ 0 ] );
$( "#max_minutes" ).val(  ui.values[ 1 ] ); 
```

在幻灯片上

[演示](http://jsfiddle.net/nbjgH/2/)
如果您访问演示，更改滑块，然后再次访问，或刷新...它将保存值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:12:38.893

您可以使用 cookie、localStorage 或 sessionStorage 来保存最后提交的范围。您尝试先读取存储的值：

```
var getLastRange = function(){
    // return data from cookie/local or session storage
};

$( "#slider-range" ).slider({
    range: true,
    min: 0,
    max: 60,
    values: getLastRange() || [ 5, 55 ],
    ...
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T16:01:22.940

您没有指定所需解决方案的范围，但我会使用 PHP 来解决这样的问题。当您提交表单时，您可以将变量保存到 $_SESSION 中，然后在带有滑块的页面上您可以检查这些变量是否可用，如果是，您可以将它们传递给初始化滑块的 javascript .

# c# - 在 Visual Studio C# 和 ASP.NET 中使用弹出窗口 - 快速学习

> ID：11036907
> 
> 赞同：0
> 
> 时间：2012-06-14T15:58:26.073
> 
> 标签：c#, visual-studio-2008

每当在我的 Web 应用程序（带有 C#、Visual Studio 的 ASP.NET）中单击“保留”按钮时，应该会弹出一个小窗口，其中包含可供选择的详细选项（带有值、组合框等的下拉列表），带有“下一步”链接，最后是“完成”。更改这些控件中的值应该会更新我在数据库（Microsoft Sql Server）中的表。

你能给我指出一个详细而有用的资源/例子吗？我已经在使用以步骤/解释的形式编写的灵感书籍（Cristian Darie），但不包括刚刚描述的场景。我应该寻找什么？“在 Visual Studio 中使用弹出窗口”？我描述的是弹出窗口吗？

我不知道JavaScript，这里需要吗？最近在类、方法、存储过程、master、用户控件类型文件、通过 Visual Studio 类和方法处理 db 表等方面进行了很多练习，但对这些仍然很陌生（基本上一个月大）。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:33:35.420

没有必要使用 JavaScript，但如果你想要比普通的弹出窗口更花哨的东西，javascript 将是你的好朋友。在我看来，基本上有四种主要的方法：

1

使用“详细信息”创建一个新的 ASPX 文件，将查询字符串发送到详细信息视图的 url，以便将弹出窗口与主窗口中的数据连接起来。关键是html“a”标签的“target”属性。例如：

> ```
> <a href="mynewwindow.aspx?i=3" target="_NEW">Details</a> 
> ```

2

使用常规 javascript 创建一个带有一些自定义属性的弹出窗口（即弹出窗口的工具栏窗口大小等）。在 javascript 中查找 window.open。

例子：

```
<a href="#" onclick="window.open("details.aspx?i=3","mywindow","menubar=1,resizable=1,width=350,height=250");">Details</a> 
```

3

使用 jQuery 使用灯箱以模式对话框方式打开弹出窗口。对于这个替代方案，我没有任何示例，但是 google jQuery lightbox，有很多。将其与 AJAX 调用一起使用并实现您的目标。

4

最后，使用 ASP.NET AJAX Control Toolkit（看这里 ： [http](http://www.asp.net/ajaxlibrary/act.ashx) ://www.asp.net/ajaxlibrary/act.ashx ）下载并安装，使用 ModalPopupExtender（教程在这里：[http://www.asp。 net/ajaxlibrary/act_ModalPopup.ashx](http://www.asp.net/ajaxlibrary/act_ModalPopup.ashx)），在这种情况下，您在 <asp:Panel> 控件中设计“详细信息”视图，然后使用 CSS 和 ModalPopupExtender 显示和隐藏详细信息，看起来就像灯箱，但您不必为此选项创建单独的 ASPX 页面，但您可以使用相同的 ASPX。

我对所有四个选项都进行了很多工作，我倾向于最喜欢第 4 个选项，但我们都有自己的品味。

祝你好运，请随时询问更多详细信息。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T21:20:57.773

让我们一步一步来。为了发送该信息，我认为最简单的方法是将参数存储为会话变量，然后在弹出窗口关闭时重新加载它们，您可以使用 Javascript 中的“onunload”事件重新加载父窗口，例如

```
<body onunload="window.opener.location.reload(true);"> 
```

每当用户关闭弹出窗口时，这本身就会重新加载父窗口。如果您希望它在用户保存更改时关闭（并且您的会话变量已设置），请使用此代码重新加载父窗口并关闭弹出窗口。将此代码放在后面的代码中，就在保存数据的方法结束之前：

```
Page.ClientScript.RegisterStartUpScript(this.GetType(),"close","<script language=javascript>window.opener.location.reload(true);self.close();</script>"); 
```

要学习 javascript，请访问 codeproject.com，他们有很多关于 javascript（除其他外）的文章，通常带有示例代码。:)

我在这里做了一个简单的例子：[http ://www.4shared.com/zip/LPtR1gbx/pop.html](http://www.4shared.com/zip/LPtR1gbx/pop.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:54:34.113

我建议使用`<div>`元素而不是实际的新浏览器窗口。

它消除了将上下文信息从弹出窗口传递回原始窗口的需要，以及与之相关的所有复杂性（包括用户无意中单击弹出窗口、多次单击并因此弹出弹出窗口的多个副本，等等）。

通过使用`<div>`“弹出”，通过 CSS 或 JavaScript 的受控可见性，整个上下文保持在同一个网页上，使整体生活变得更加轻松。

# c# - JavaScriptSerializer, Parsing Json from HttpRequest, 把pars放到表格中显示

> ID：11036912
> 
> 赞同：0
> 
> 时间：2012-06-14T15:58:36.520
> 
> 标签：c#, asp.net, json, parsing, javascriptserializer

我调用了一个名为 Sample ApI 的 Web 服务器。我希望能够解析 json 或 xml 中的数据，要么很好，要么以表格格式显示。这就是我到目前为止所拥有的。

我想要的只是能够解析这个字符串中的数据`_responseAsString`并显示一个表格。我不知道如何开始，我只是知道`JavaScriptSerialzer parseXXX = new Java...lizer()`。请帮助我或协助正确的方向。

```
 public class Event
{
    public string event_key { get; set; }
    public string user_token { get; set; }
    public string event_set_key { get; set; }
    public string event_type { get; set; }
    public string event_date { get; set; }
    public string event_amount { get; set; }
    public string event_location_key { get; set; }
    public string event_location_name { get; set; }
    public string event_location_city { get; set; }
    public string event_location_state { get; set; }
    public string event_location_country { get; set; }
    public string event_acknowledged { get; set; }
}

     public ActionResult GetEvent()
     {
        try
        {

            string at = "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa";
            string et = "KI2XfwQNByLPFdK4i3a74slLT7sjjzYRi9RR7zEtCoQ%3D";
            string t = "20111128183020";
            string _checkingUrl = String.Format("http://172.22.22.10/SampleAPI/Event/GetEvents?at={0}&et={1}&t={2}&responseFormat=json", at, et, t);
            System.Net.HttpWebRequest request=System.Net.WebRequest.Create(_checkingUrl) as System.Net.HttpWebRequest;
            System.Net.HttpWebResponse response=request.GetResponse() as System.Net.HttpWebResponse;
            System.IO.StreamReader _readResponse=new System.IO.StreamReader(response.GetResponseStream());
            //The encrypted dynamics response in either xml or json
            string _responseAsString=_readResponse.ReadToEnd();
            JavaScriptSerializer parseResponse = new JavaScriptSerializer();
            List<Event> events = parseResponse.Deserialize<List<Event>>(_responseAsString);

         // this below is to make sure i was receiving my json data.       
     return Content(_responseAsString);

            _readResponse.Close();
        }
        catch (Exception e)
        {
            //log error
        }
        return View();
    } 
```

这是我发出 http 请求时收到的 json 数据：

> "[{\"event_key\":\"cc2a1802-2b04-4530-ad50-0d4f0ed19dd3\",\"user_token\":\"40e62a11-40c4-408d-8cdd-1293cbaf9a41\",\"event_set_key\":\ "615017f2-ae28-4b8d-9def-cf043642b928\",\"event_type\":\"到达\",\"event_date\":\"6/20/2011 4:15:28 PM\",\"event_amount \":\"100\",\"event_location_key\":\"50fc1c22-d77b-4a91-b31d-da036827060b\",\"event_location_name\":\"Store2\",\"event_location_city\":\"匹兹堡\",\"event_location_state\":\"PA\",\"event_location_country\":\"US\",\"event_location_lat\":\"\",\"event_location_long\":\"\",\ "事件描述\":\"\",\"event_acknowledged\":\"True\"},{\"event_key\":\"2ac9e25e-137c-4a72-8cc5-157d67ea66c1\",\"user_token\":\"58cb4fcd-e140-4232-88c9-06eecb95b63d\ ",\"event_set_key\":\"00710ca7-f5d7-4c7a-bbfb-95491ae278ef\",\"event_type\":\"到达\",\"event_date\":\"9/23/2011 4:15 :28 PM\",\"event_amount\":\"45\",\"event_location_key\":\"5a732dd5-9459-4cdd-a980-f3daf1a07343\",\"event_location_name\":\"Store4\", \"event_location_city\":\"匹兹堡\",\"event_location_state\":\"PA\",\"event_location_country\":\"US\",\"event_location_lat\":\"\",\"event_location_long \":\"\",\"event_description\":\"\",\"event_acknowledged\":\"False\"},{\"event_key\":\"386b1fa1-11b2-48d9-b7f1-4bbe21ced487\",\"user_token\":\ "c3d8b7ff-d85f-42a8-98f6-e091b48c2280\",\"event_set_key\":\"dc55843b-f8cf-4e8a-9091-188ce0609fe1\",\"event_type\":\"到达\",\"event_date\" :\"9/18/2011 4:15:28 PM\",\"event_amount\":\"100\",\"event_location_key\":\"be6d4fb4-c0e3-4303-b70d-7a22b721aa56\",\ "event_location_name\":\"Store1\",\"event_location_city\":\"Pittsburgh\",\"event_location_state\":\"PA\",\"event_location_country\":\"US\",\"event_location_lat \":\"\",\"event_location_long\":\"\",\"event_description\":\"\",\"event_acknowledged\":\"False\"}]"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:09:36.463

[JSON 网站](http://www.json.org/js.html)对此有一些很好的信息。

对于较旧的浏览器，您可以`eval`使用字符串（带有一些括号以使其工作）：

```
var myObject = eval('(' + myJsonText + ')'); 
```

而现在，我们倾向于使用

```
JSON.parse(myJsonText); 
```

和服务器端，在 C# 中

```
var serializer = new JavaScriptSerializer();
T obj = serializer.Deserialize<T>(myJsonText); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T17:32:48.497

**首先...**

如果您只是传递从其他 API 返回的 JSON 消息，为什么不逐字返回它们的响应字符串（换句话说，为什么要反序列化它）？

```
 public ActionResult GetEvent()
 {
        string at = "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa";
        string et = "KI2XfwQNByLPFdK4i3a74slLT7sjjzYRi9RR7zEtCoQ%3D";
        string t = "20111128183020";
        string _checkingUrl = String.Format("http://172.22.22.10/SampleAPI/Event/GetEvents?at={0}&et={1}&t={2}&responseFormat=json", at, et, t);
        System.Net.HttpWebRequest request=System.Net.WebRequest.Create(_checkingUrl) as System.Net.HttpWebRequest;
        System.Net.HttpWebResponse response=request.GetResponse() as System.Net.HttpWebResponse;
        using (var readResponse= new StreamReader(response.GetResponseStream()))
        {
             return Content(readResponse.ReadToEnd(), "application/json");
        }
} 
```

**然后继续阅读**

可以使用 JSON 文本阅读器将 JSON 消息分解为名称/值对表，但我认为这在您的情况下没有意义。如果消息是常量，只需创建一个表示 JSON 消息中每个元素的类并解析它。我使用[json2csharp](http://json2csharp.com/#)来存根这样的类：

```
public class Event
{
    public string event_key { get; set; }
    public string user_token { get; set; }
    public string event_set_key { get; set; }
    public string event_type { get; set; }
    public string event_date { get; set; }
    public string event_amount { get; set; }
    public string event_location_key { get; set; }
    public string event_location_name { get; set; }
    public string event_location_city { get; set; }
    public string event_location_state { get; set; }
    public string event_location_country { get; set; }
    public string event_location_lat { get; set; }
    public string event_location_long { get; set; }
    public string event_description { get; set; }
    public string event_acknowledged { get; set; }
} 
```

然后使用你最喜欢的 JSON 序列化器反序列化为这些对象的列表：

```
var serializer = new JavaScriptSerializer();
var events = serializer.Deserialize<List<Event>>(responseAsString); 
```

（我更喜欢 JSON.NET，这里相当于上面的块）

```
var events = JsonConvert.DeserializeObject<List<Event>>(responseAsString); 
```

如果您确实需要能够读取文本流并通常创建名称/值对表，我会使用[JSON.NET](http://json.codeplex.com/)的[LINQ-to-JSON 或 JsonTextReader](http://james.newtonking.com/projects/json/help/)。

# php - 我想将 php/mysql 应用程序转换为 wordpress 插件

> ID：11036916
> 
> 赞同：0
> 
> 时间：2012-06-14T15:58:51.473
> 
> 标签：php, wordpress, plugins

我有一个 php/mysql 网络应用程序。我想将其转换为 wordpress 插件。如何将一个 php 文件链接到另一个文件。例如我有插件 tw。tw.php 是它的索引文件，另一个文件名为 tw1.php。

第一页

```
/* plugin name:tw
 plugin url:httpL://csr.estheticsolutions.com.pk
*/

//tell wordpress to register the demolistposts shortcode
add_shortcode("demo-list-posts", "demolistposts_handler");

  function demolistposts_handler()  
    {
    //run function that actually does the work of the plugin
     $demolph_output = my_function();
     //send back text to replace shortcode in post
      return $demolph_output;
     }

 function my_function()
     {
?>
          <html>
          <body>          

               <form   action="tw1.php" method="post">
                       <input  type="text" name="fname"  >
                       <input type="submit" value="Submit" >
                </form>

          </body>
          </html>
 <?php

  }

 ?> 
```

第二页

```
<?php

 $First_Name=$_POST['fname'];
echo $First_Name;

?> 
```

当我在 tw.php 中提交值时，在 wordpress 文件夹中出现错误 tw1.php not found(404)，然后我将文件 tw1.php 粘贴到该（wordpress）文件夹中并提交，发布的值进入没有 wordpress 主题的新页面.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T02:33:50.840

创建一个 name=people 的表，列：id、firstname、lastname、DateofBirth、addressid、fatherid、motherid。每列都有合适的列属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-10T10:52:52.667

您可以使用插件 url 函数链接到第二个文件：

```
 <form   action="<?php echo plugins_url( 'tw1.php', dirname(__FILE__) ); ?>" method="post">
                   <input  type="text" name="fname"  >
                   <input type="submit" value="Submit" >
            </form> 
```

# xcode - Xcode如何添加外部项目

> ID：11036921
> 
> 赞同：8
> 
> 时间：2012-06-14T15:59:03.033
> 
> 标签：xcode, workspace, build-dependencies

我需要向我的 Xcode 项目添加一个外部项目，原因是我需要在该外部项目静态库上添加一个目标依赖项。

我似乎无法以我需要的方式添加它，我希望它是这样的：

![在此处输入图像描述](../Images/e08bb3c708946ba5b70c23a097a5223e.png)

但是，当我将另一个项目添加到我的实际 Xcode 项目中时，我得到以下内容，这不允许我从我的项目中探索该项目，因此我无法添加我需要的依赖项。

![在此处输入图像描述](../Images/9f31432d3137c7af604c744c99922e69.png)

请注意，这些屏幕截图来自两个不同的项目，其中一个向我展示了我想在自己的项目中重现的内容，拖入多个项目按预期工作。

也许我的项目中有一些设置错误？我所做的只是从 Xcode 获取模板详细信息主应用程序。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-14T16:35:55.153

你做对了。问题是 Xcode 不能将同一个项目打开两次。

`Serenity.xcodeproj`在重新打开您的父项目之前关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:15:16.900

是的，这是可能的，它被称为工作区。

在您的示例中：

*   打开你的两个项目
*   将 Serenity 项目拖到 Dependent 项目中

我认为您做错了什么是拖动 Xcodeproj，尝试打开该项目并改为拖动项目块（见图）

![在此处输入图像描述](../Images/9191079215432220ecfd750d93c582cc.png)

# sql-server - SQLException外键错误获取子表

> ID：11036923
> 
> 赞同：0
> 
> 时间：2012-06-14T15:59:10.303
> 
> 标签：sql-server, vb.net, ado.net, sqlexception

我目前正在尝试创建一个函数来解析错误消息，以使它们对最终用户更有帮助。目前我正在使用 SQLServer 和 VB.NET。

现在我提出错误 547，如下所示：

```
DELETE statement conflicted with COLUMN REFERENCE
constraint Constraint Name.  The conflict occurred
in database 'Database Name', table 'Table Name', 
column 'Column Name'. 
```

提出它的声明是

```
DELETE FROM parentTable WHERE primaryKey = 5 
```

我能够从错误消息中提取我需要的每条信息，除了 parentTable 的名称。我已经确定 SqlException 不存储导致异常的语句，据我所知，它不存储有关父表名称的信息，只存储试图引用它的表。

有没有一种简单的方法来获取父表的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:44:44.463

这是我几年前开发的一个例程，用于查询给定表的临时父/子关系：

```
---------------------------------------------------------------------
-- Name:    FKRelationships
-- Purpose: Map all parent/child relationships to the selected table
-- Date:    1/19/2009
-- Author:  John W. Dewey
-- Instructions:    1) Connect this script to the database containing
--                  the table you want to analyze
--                  2) Set the schema name and table name variables 
--                  Initializations section below. Be sure the table
--                  name variable does not contain the schema name
--                  3) You will get two result sets; the first will show
--                  the relational parent tables to your selected table, and
--                  the second will show the relational children to your
--                  selected table.
---------------------------------------------------------------------

---------------------------------------------------------------------
-- Declarations
declare @TableName nvarchar(128)
declare @SchemaName nvarchar(128)
declare @ParentTableSchema nvarchar(128)
declare @ParentTableName nvarchar(128)
declare @FKName nvarchar(128)
declare @Column nvarchar(128)
declare @Table nvarchar(128)
declare @Schema nvarchar(128)
declare @FKColumnString nvarchar(max)
declare @PKColumnString nvarchar(max)
declare @result table (
    [Parent Table] nvarchar(128)
    , [Child Table] nvarchar(128)
    , [Constraint] nvarchar(128)
    , [Relationship] nvarchar(max)
)
declare @FKTemp table (
    [id] int identity(1,1)
    , [Child Schema Name] nvarchar(128)
    , [Child Table Name] nvarchar(128)
    , [Child FK Name] nvarchar(128)
    , [Column Name] nvarchar(128)
)

---------------------------------------------------------------------
-- Initializations
set @SchemaName = 'dbo'
set @TableName = 'MyTable'

---------------------------------------------------------------------
-- Tables referenced by the specified table's FKs
declare c1 cursor for 
    select a.CONSTRAINT_NAME
    from INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS a
    inner join INFORMATION_SCHEMA.TABLE_CONSTRAINTS b
        on a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
    where b.TABLE_NAME = @TableName
    and b.CONSTRAINT_SCHEMA = @SchemaName
open c1
fetch next from c1 into @FKName
while @@fetch_status=0 begin

    -- Build a string of each FK's corresponding columns
    set @FKColumnString = @SchemaName+'.'+@TableName+'.'
    declare c2 cursor for 
        select a.COLUMN_NAME from INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE a
        inner join INFORMATION_SCHEMA.COLUMNS b
            on a.TABLE_NAME = b.TABLE_NAME
            and a.COLUMN_NAME = b.COLUMN_NAME
        where a.CONSTRAINT_NAME=@FKName
        and a.TABLE_SCHEMA = @SchemaName
        order by b.ORDINAL_POSITION
    open c2
    fetch next from c2 into @Column
    while @@fetch_status=0 begin
        set @FKColumnString = @FKColumnString + '+' + @Column
        fetch next from c2 into @Column
    end
    set @FKColumnString = replace(@FKColumnString, '.+', '.')
    close c2
    deallocate c2

    -- Build a string of each PK's corresponding columns
    declare c3 cursor for
        select distinct c.TABLE_SCHEMA
            , c.table_name as [Parent Table Name]
        from INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS a
        inner join INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE b
            on a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
        inner join INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE c
            on a.UNIQUE_CONSTRAINT_NAME = c.CONSTRAINT_NAME
        where b.table_name = @TableName
        and b.TABLE_SCHEMA = @SchemaName
        and a.CONSTRAINT_NAME = @FKName
    open c3
    fetch next from c3 into @ParentTableSchema, @ParentTableName
    while @@fetch_status=0 begin
        set @PKColumnString = @ParentTableSchema+'.'+@ParentTableName+'.'
        declare c4 cursor for
            select a.COLUMN_NAME from INFORMATION_SCHEMA.KEY_COLUMN_USAGE a
                inner join INFORMATION_SCHEMA.TABLE_CONSTRAINTS b
                    on a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
                    and b.CONSTRAINT_TYPE = 'PRIMARY KEY'
                where a.TABLE_NAME = @ParentTableName
                and a.TABLE_SCHEMA = @ParentTableSchema
                order by a.ORDINAL_POSITION
            open c4
            fetch next from c4 into @Column
            while @@fetch_status=0 begin
                set @PKColumnString = @PKColumnString + '+' + @Column
                fetch next from c4 into @Column
            end
            set @PKColumnString = replace(@PKColumnString, '.+', '.')
        close c4
        deallocate c4
        fetch next from c3 into @ParentTableSchema, @ParentTableName
        insert into @result ([Parent Table], [Child Table], [Constraint], [Relationship]) values (@ParentTableSchema+'.'+@ParentTableName, @SchemaName+'.'+@TableName, @SchemaName+'.'+@TableName+'.'+@FKName, @FKColumnString+' = '+@PKColumnString)
    end
    close c3
    deallocate c3
    fetch next from c1 into @FKName
end
close c1
deallocate c1

-- Display results
select 
    [Child Table] as [Selected Table as Child]
    , [Parent Table]
    , [Constraint] as [Child Constraint]
    , [Relationship] as [Relationship to Parent]
from @result

---------------------------------------------------------------------
-- FKs pointing to the specified table
delete from @result
insert into @FKTemp ([Child Schema Name], [Child Table Name], [Child FK Name], [Column Name])
select b.TABLE_SCHEMA as [Child Schema Name]
    , b.TABLE_NAME as [Child Table Name]
    , a.CONSTRAINT_NAME as [Child FK Name]
    , b.Column_Name as [Column Name]
from INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS a
inner join INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE b
    on a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
inner join INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE c
    on a.UNIQUE_CONSTRAINT_NAME = c.CONSTRAINT_NAME
        and c.TABLE_NAME = @TableName
        and c.TABLE_SCHEMA = @SchemaName
inner join INFORMATION_SCHEMA.COLUMNS d
    on d.TABLE_SCHEMA = c.TABLE_SCHEMA
        and d.TABLE_NAME = c.table_name
        and d.COLUMN_NAME = b.COLUMN_NAME
order by d.ORDINAL_POSITION

-- Selected table's PK
set @PKColumnString = @SchemaName+'.'+@TableName+'.'
declare c1 cursor for
    select a.COLUMN_NAME from INFORMATION_SCHEMA.KEY_COLUMN_USAGE a
        inner join INFORMATION_SCHEMA.TABLE_CONSTRAINTS b
            on a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
            and b.CONSTRAINT_TYPE = 'PRIMARY KEY'
        where a.TABLE_NAME = @TableName
        and a.TABLE_SCHEMA = @SchemaName
        order by a.ORDINAL_POSITION
    open c1
    fetch next from c1 into @Column
    while @@fetch_status=0 begin
        set @PKColumnString = @PKColumnString + '+' + @Column
        fetch next from c1 into @Column
    end
    set @PKColumnString = replace(@PKColumnString, '.+', '.')
close c1
deallocate c1

-- Child tables' FKs
declare c1 cursor for select distinct [Child Schema Name], [Child Table Name] from @FKTemp
open c1
fetch next from c1 into @Schema, @Table
while @@fetch_status=0 begin
    set @FKColumnString = @SchemaName+'.'+@Table+'.'
    declare c2 cursor for select [Child FK Name], [Column Name]
    from @FKTemp
    where [Child Table Name] = @Table
    open c2
    fetch next from c2 into @FKName, @Column
    while @@fetch_status=0 begin
        set @FKColumnString = @FKColumnString + '+' + @Column
        fetch next from c2 into @FKName, @Column
    end
    close c2
    deallocate c2
    set @FKColumnString = replace(@FKColumnString, '.+', '.') + ' = ' + @PKColumnString
    insert into @result ([Parent Table], [Child Table], [Constraint], [Relationship]) values (@SchemaName+'.'+@TableName, @Schema+'.'+@Table, @Schema+'.'+@Table+'.'+@FKName, @FKColumnString)
    fetch next from c1 into @Schema, @Table
end
close c1
deallocate c1

-- Display results
select 
    [Parent Table] as [Selected Table as Parent]
    , [Child Table]
    , [Constraint] as [Child Constraint]
    , [Relationship] as [Relationship Parent]
from @result 
```

# c++ - 使用路径变量时包含路径不扩展

> ID：11036924
> 
> 赞同：4
> 
> 时间：2012-06-14T15:59:14.857
> 
> 标签：c++, windows, eclipse

我创建了一个新的 c++ 项目。然后右键单击项目->属性->资源->链接资源，我在这里定义了一个路径变量：

```
MY_PROJ_ROOT   <some_correct_path> 
```

然后我去了编译器选项 - >包含选项，我尝试添加包含路径和路径变量，如下所示：

```
"${MY_PROJ_ROOT}/include" 
```

但包含目录未显示在项目菜单下的“包含”选项卡中。而不是显示完整的包含路径（如其他包含），我只得到这个 : `/include`。

那么，使用路径变量设置包含时我做错了吗？正确的方法是什么？

PS我检查了路径，以及我能想到的一切，但没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T06:18:09.053

最后我想通了：

打开项目属性 -> C/C++ Build -> Build Variables 选项卡，然后添加新变量：

```
MY_PROJ_ROOT   <some_correct_path> 
```

然后该变量将适用于包含选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:03:08.010

试试`${env_var:MY_PROJ_ROOT}`。Eclipse 带有自己的用于插入变量的模式。如果应该有一个“变量...”按钮，单击它，您将看到各种选项，其中一个是以`env_var`环境变量名称作为参数的选项。事实上，您可能想要使用`${project_loc}`而不是定义您自己的变量。

# cassandra - Cassandra CQL：如何从列中选择编码值

> ID：11036928
> 
> 赞同：1
> 
> 时间：2012-06-14T15:59:21.770
> 
> 标签：cassandra

我已将字符串和整数值插入到 Cassandra 列族的动态列中。当我查询 CQL 中的值时，它们显示为十六进制编码位。

我可以以某种方式告诉查询将值解码为字符串或整数吗？

如果这更容易，我也很乐意在 CLI 中执行此操作。在那里我看到你可以指定`assume <column_family> validator as <type>;`，但这适用于所有列并且它们具有不同的类型，所以我必须多次运行假设和查询。

（注意列是动态的，所以我在创建列族时没有指定验证器）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T17:17:30.820

您可以`ASSUME`像在 cassandra-cli 中一样在 cqlsh 中使用（尽管它仅适用于打印值，而不是发送它们，但这对您来说应该没问题）。您还可以按列使用它，例如：

```
ASSUME <column_family> ('anchor:cnnsi.com') VALUES ARE text; 
```

..虽然（a），我只是测试了它，这个功能在 cassandra-1.1.1 及更高版本中被破坏了。[我在CASSANDRA-4352](https://issues.apache.org/jira/browse/CASSANDRA-4352)发布了一个修复程序。并且（b），对于不止一些一次性使用，这可能不是一个非常通用或有用的解决方案。我强烈建议在这里使用 CQL 3，因为 CQL 直接支持像这样的宽存储引擎行已被弃用。您在此处的表肯定适用于（更易于使用）CQL 3 模型，但如果不了解更多有关您如何使用它的信息，我无法确切地说出它会是什么。

# ruby-on-rails - 如何将我的 Heroku OAuth/RoR 应用程序指向 curl-ca-bundle.crt？

> ID：11036930
> 
> 赞同：0
> 
> 时间：2012-06-14T15:59:25.867
> 
> 标签：ruby-on-rails, oauth, heroku, facebook-oauth

我正在使用 Oauth 连接到 facebook，它适用于本地开发。

然而，我想在 Heroku 上运行它，我得到了这个错误：

```
2012-06-14T15:50:16+00:00 app[web.1]: Errno::ENOENT (No such file or directory - Certificate file "/opt/local/share/curl/curl-ca-bundle.crt" does not exist!):
2012-06-14T15:50:16+00:00 app[web.1]:   app/controllers/sharing_controller.rb:138:in `facebook_callback' 
```

我已经在 Heroku 中配置了 SSL 端点，但这并没有改变任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:18:21.123

我想到了 -

我不得不更改考拉证书路径参数：

旧：Koala.http_service.ca_file = '/opt/local/share/curl/curl-ca-bundle.crt'

新：Koala.http_service.ca_file = '/usr/lib/ssl/certs/ca-certificates.crt'

# c# - 在我的 C# POCO 类上使用自定义属性

> ID：11036932
> 
> 赞同：1
> 
> 时间：2012-06-14T15:59:31.833
> 
> 标签：c#, asp.net, poco

在我的项目中，我有一个类`Area`，如下所示。属性“ `CodArea`”我想放置一个自定义属性，例如`[NaoSelecionarAttr(true)]`. 这工作正常，但是当我创建该类的一个实例时，我无法获得此自定义属性。像这样的东西：

```
Area areaPoco = new Area();
areaPoco.CodArea.GetType().GetCustomAttributes(typeof(NaoSelecionarAttr),true).ToList();

[Serializable]
public class Area
{
    #region Private Members     
    private decimal _numChave;
    private string _codArea;

    public Area()
    {
        _numChave = 0;
        _codArea = null;
    }

    public Area(decimal  pNumChave,     string pCodArea)
    {
        NumChave = pNumChave;
        CodArea = pCodArea;
    }
    public virtual decimal NumChave
    { get { return _numChave;}
      set { _numChave = value;}
    }

    [NaoSelecionarAttr(true)]
    public virtual string CodArea
    { 
            get {   return _codArea; }
            set   { _codArea = value;}
    }
}

public class NaoSelecionarAttr : Attribute
{
    public bool NaoSelecionar { get; set; }
    public NaoSelecionarAttr(bool pSim) { this.NaoSelecionar = pSim; }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:38:36.900

您的代码存在一些问题。

代码中的第一个问题是您正在调用默认构造函数 on `Area`，该构造函数初始化`_codArea`为 null。然后您尝试调用它，但正如预期的那样`GetType`，它失败了。`NullReferenceException`

第二个问题是你想要一个类的属性的属性。所以你必须检查（或反映）类，而不是属性。您会看到，当您编写`areaPoco.CodArea...`编译器时，会将其解析为`get`表达式的结果，在本例中为 field `_codArea`。通过调用`GetType()`on `_codArea`，您检索的是一个`String`类型，而不是您的`Area`类型。我知道这起初可能看起来令人困惑，但属性不是类型，所以你不能反思它们。

那么，你应该做的是：

```
Area areaPoco = new Area();
NaoSelecionarAttr attr = (NaoSelecionarAttr) (areaPoco.GetType().GetProperties().Single(p => p.Name == "CodArea").GetCustomAttributes(typeof(NaoSelecionarAttr), true).Single());
bool naoSelecionar = attr.NaoSelecionar; 
```

* * *

如果可以的话，我也想给你一些建议：

*   您对非默认构造函数的表示法似乎让人想起 C/C++。通常没有充分的理由在参数中添加“p”前缀。

*   我建议您使用“Selecionar”，而不是 NaoSelecionar，这是一个负面属性。交易是您可以很容易地将否定句与其对应的肯定句混淆。一个月后你会问，“好吧，参数是假的，我应该选择还是不选择这个属性？”。False 通常意味着 NOT，因此，您的默认解释是在属性为 false 时不选择某些内容。

*   您的默认构造函数正在将属性初始化为`null`. 正如我上面所描述的，这可能会导致错误。将其初始化为默认值 ( `string.Empty`)，或者删除默认构造函数并仅使用需要用户为字符串提供值的构造函数。并**验证**这些参数——用户可能会再次`null`向字符串提供 a 。（一个对象在第一次构造时应该是有效的）

*   最后一个提示。您的`NaoSelecionar`属性获取一个布尔参数。最后一个项目符号正是关于这一点 - 您可能会混淆属性的真实属性是否意味着“não”或“sim”。那么，为什么不简单地删除参数**然后**使用负参数呢？无需将**true**或**false**传递给`NaoSelecionar`，因为您需要做的就是遍历您的类并查找哪些属性应用了此属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:26:42.920

你为什么用`areaPoco.CodArea.GetType()`？我认为你应该使用`areaPoco.GetType()`. 因为您的自定义属性属于 Area 类，而不是字符串。

# c# - LINQ 查询无法识别重复项

> ID：11036935
> 
> 赞同：1
> 
> 时间：2012-06-14T15:59:42.170
> 
> 标签：c#, visual-studio-2010, linq

我有两个自定义类。

第一类包含基本数据：

```
public class Request
{
    public Request(int lineID, string partNo, int qty, int reasonID, int typeID)
    {
        LineID = lineID;
        PartNo = partNo;
        Qty = qty;
        ReasonID = reasonID;
        TypeID = typeID;
    }
    public int LineID { get; private set; }
    public string PartNo { get; private set; }
    public int Qty { get; internal set; }
    public int ReasonID { get; private set; }
    public int TypeID { get; private set; }
} 
```

第二个类包含这些请求对象的列表，其签名如下：

```
public class Requests : IEnumerable<Request>
{
    private List<Request> list;

    public Requests()
    {
        list = new List<Request>();
    }

    public int Add(Request item)
    {
        if (item != null)
        {
            foreach (var x in list.Where(r => 
              (r.LineID == item.LineID) &&
              (r.PartNo == item.PartNo) &&
              (r.ReasonID == item.ReasonID) &&
              (r.TypeID == item.TypeID)))
            {
                x.Qty += item.Qty;
                return list.IndexOf(x);
            }
            list.Add(item);
            return list.Count - 1;
        }
        return -1;
    }

    // other code 
} 
```

我正在测试我的代码并添加项目正在将新项目放入列表中，但是查找重复项的 LINQ 查询不起作用。

如果将 2 个相同的项目添加到列表中，我希望我的代码足够聪明，可以简单地更新数量，但它似乎不起作用。

有人可以告诉我 LINQ 查询有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:21:32.460

> 有人可以告诉我 LINQ 查询有什么问题吗？

理论上看起来还可以。我认为我们需要了解有关您的数据的更多信息，以便能够找出为什么它没有按您的预期工作。`LineID`, `PartNo`,`ReasonID`和的组合是否能`TypeID`唯一区分一个项目？由于`PartNo`是字符串，值是否不区分大小写（您的比较区分大小写）？

> 如果将 2 个相同的项目添加到列表中，我希望我的代码足够聪明，可以简单地更新数量，但它似乎不起作用。

为此，我建议采用不同的方法。考虑覆盖`Equals()`您的`Request`类型。然后您的`Add`方法可以检查列表是否已经包含该项目，如果是则增加数量，如果不是则添加它：

```
var idx = list.IndexOf(item);
if(idx != -1)
{
    list[idx].Qty += item.Qty;
}
else
{
    list.Add(item);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:14:28.610

制作`Request`工具`IEquatable<Request>`，因为[这是`IndexOf`使用](http://msdn.microsoft.com/en-us/library/e4w08k17.aspx)：

```
public bool Equals(Request other) {
    return other != null && (this.LineID == other.LineID) && (this.PartNo == other.PartNo) && (this.ReasonID == other.ReasonID) && (this.TypeID == other.TypeID);
} 
```

然后：

```
public int Add(Request item) {
    if (item != null)
    {
        int ind = list.IndexOf(item);

        if (ind == -1)
        {
            list.Add(item);
            return list.Count - 1;
        }
        else
        {
            list[ind].Qty += item.Qty;
            return ind;
        }                
    }
    return -1;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T16:36:15.807

您可以通过具体化 LINQ 查询来修改该方法。例如：

```
public int Add(Request item) {
    if (item != null) {
      foreach (var x in list.Where(r => 
        (r.LineID == item.LineID) &&
        (r.PartNo == item.PartNo) &&
        (r.ReasonID == item.ReasonID) &&
        (r.TypeID == item.TypeID)
        ).ToList()) {
        x.Qty += item.Qty;
        return list.IndexOf(x);
      }
      list.Add(item);
      return list.Count - 1;
    }
    return -1;
  } 
```

但是，因为您的请求必须是唯一的，所以您可以使用它

```
public int Add(Request item)
{
    if (item != null)
    {
        var req = list.SingleOrDefault(r =>
                              (r.LineID == item.LineID) &&
                              (r.PartNo == item.PartNo) &&
                              (r.ReasonID == item.ReasonID) &&
                              (r.TypeID == item.TypeID)
            );
        if(req!=null)
        {
            req.Qty += item.Qty;
            return list.IndexOf(req);
        }
        list.Add(item);
        return list.Count - 1;
    }
    return -1;
} 
```

# ajax - MVC4 - Ajax.BeginForm 和部分视图给出“未定义”

> ID：11036942
> 
> 赞同：3
> 
> 时间：2012-06-14T16:00:11.960
> 
> 标签：ajax, asp.net-mvc

我正在处理活动预订，但在使用带有部分视图的 ajax.beginform 时遇到问题。当我点击提交时，它只是进入一个新页面，左上角有一个“未定义”。我的布局页面中有“../../Scripts/jquery.unobtrusive-ajax.min.js”。我想要做的是当用户提交表单时，div“AjaxTest”会使用部分视图进行更新，并且表单位于搜索结果下方。

这是我到目前为止所拥有的（我去掉了所有的结构和样式，以便于阅读）：

**主视图 - 活动**

```
@model Project.Models.ActivityModel
<div id="AjaxTest"></div>

@using (Ajax.BeginForm(new AjaxOptions
  {
   UpdateTargetId = "AjaxTest",
   InsertionMode = InsertionMode.Replace, 
   HttpMethod = "POST"
  }))

  {
    @Html.ValidationSummary(true)
      @Html.TextBoxFor(x => x.Activity_CityName)
        <div class="editor-label">   
            <strong>@Html.LabelFor(x => x.Activity_StartDate)</strong>
        </div> 
        <div class="editor-field">
            <input id="checkin" type="text" name="Activity_StartDate" />
        </div>
      @Html.TextBoxFor(x => x.Activity_EndDate)
      @Html.DropDownListFor(x => x.Activity_NumAdults, AdultNum)
      @Html.DropDownListFor(x => x.Activity_NumChildren)
      @Html.DropDownListFor(x => x.Activity_ChildAge1, ChildAge)
      @Html.DropDownListFor(x => x.Activity_ChildAge2, ChildAge)
      @Html.DropDownListFor(x => x.Activity_ChildAge3, ChildAge)

     <div class="submitbutton"> 
        <input data-inline="true"type="submit" id="activity_search" value="Search" />
    </div> 
  } 
```

**控制器**

```
[HttpPost]
    public ActionResult Activities(ActivityModel activitysubmission) {
       return PartialView("PartialActivities_Success", activitysubmission);
    } 
```

**部分视图 - PartialActivities_Success**

```
@model Project.Models.ActivityModel

<p>City: @Model.Activity_CityName</p>
<p>StartDate: @Model.Activity_StartDate</p>
<p>EndDate: @Model.Activity_EndDate</p>

<div>
    <p><strong>Ticket</strong></p>
    <p>Number of Adults: @Model.Activity_NumAdults</p>
    <p>Number of Children: @Model.Activity_NumChildren</p>
    <p>Child 1 age: @Model.Activity_ChildAge1</p>
    <p>Child 2 age: @Model.Activity_ChildAge2</p>
    <p>Child 3 age: @Model.Activity_ChildAge3</p>
</div> 
```

**布局页面中的脚本**

```
 <script src="../../Scripts/jquery.unobtrusive-ajax.min.js" type="text/javascript"> </script>
    <script src="../../Scripts/xdate.js" type="text/javascript"></script>
    <script src="../../Scripts/xdate.i18n.js" type="text/javascript"></script>
    <script src="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Scripts/js")"></script>
    <script>
        $(document).bind("mobileinit", function() {
            // As of Beta 2, jQuery Mobile's Ajax navigation does not work in all cases (e.g.,
            // when navigating from a mobile to a non-mobile page, or when clicking "back"
            // after a form post), hence disabling it.
            $.mobile.ajaxEnabled = true; // originally false.
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:53:53.930

你在使用 MVC 4 吗？我会确保在您的 WebConfig 文件中将 UnobtrusiveJavaScriptEnabled 设置为 true。不过，我相信这是默认设置。我能想到的唯一另一件事是验证您是否拥有其他 jQuery 文件并且它们正在以正确的顺序加载。如果您在主文件之前加载您的不显眼的 jQuery 文件，那么它将无法工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T17:31:21.697

我注意到代码中有一个错误。您的 div 有一个 id `Ajaxtest`，但您传递给 BeginRequest 的参数是`AjaxTest`T 是大写

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T13:46:14.410

您尚未指定发布 Ajax 表单时要调用的操作。尝试将其更改为：

```
@using (Ajax.BeginForm("Activities", new AjaxOptions
  {
    UpdateTargetId = "AjaxTest",
    InsertionMode = InsertionMode.Replace, 
    HttpMethod = "POST"
  })) 
```

# python - 您如何在 Ruby 中进行与 python 等效的列表切片？

> ID：11036943
> 
> 赞同：1
> 
> 时间：2012-06-14T16:00:15.077
> 
> 标签：python, ruby, list, porting, slice

我正在尝试将一些 python 代码移植到 ruby​​，并且我做得很好，使用等效的 ruby​​ 函数，甚至删除/更改一些以更多地使用 ruby​​ 功能。然而，在一个核心点，我需要从 python 中的数组中获取切片，以下工作正常：

```
output=["Apple","Orange","Pear"]
team_slices=[(0,1),(1,2),(2,3)]
for start,end in team_slices:
    print output[start:end] 
```

将按预期输出：

```
['Apple']
['Orange']
['Pear'] 
```

而红宝石代码：

```
output=["Apple","Orange","Pear"]
team_slices=[[0,1],[1,2],[2,3]]
team_slices.each do |start,ending|
    print output[start..ending]
end 
```

将输出：

```
["Apple","Orange"]
["Orange","Pear"]
["Pear"] 
```

有什么方法可以让切片更等同于 python？我知道我可能在这里遗漏了一些简单的东西

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T16:10:19.290

似乎 python 的范围不包括最终值，所以只需`...`在 ruby​​ 中使用变体：

```
output=["Apple","Orange","Pear"]
team_slices=[[0,1],[1,2],[2,3]]
team_slices.each do |start, last|
  print output[start...last]
end 
```

PS：在 ruby​​ 中，如果您想遵守约定，您应该使用 2 个空格进行缩进；）

编辑| 由于 ruby​​ 将其用作语法关键字，因此不得不重命名`end`为。`last`

# c - 增加指针会导致内存泄漏吗？

> ID：11036948
> 
> 赞同：1
> 
> 时间：2012-06-14T16:00:46.317
> 
> 标签：c, pointers, memory-management

以下代码是否包含字符串中前三个字符的内存泄漏？

```
char * str = (char*)malloc(21 * sizeof(char));
strcpy(str, "01234567890123456879");
str = str + 3;
free(str); 
```

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T16:01:46.747

它比*泄漏*更糟糕，您不应该`free`使用未从`malloc`（或`realloc`/ `calloc`）返回的指针进行调用。您可能会发生泄漏，崩溃，或者谁知道还有什么……您所做的是*未定义的行为*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:03:25.263

是的，它会泄漏。

`free`需要一个由 . 返回的指针`malloc/realloc/calloc`。因为，你已经改变了，它肯定会泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:07:20.627

您可能想通过测试来证明这一点，但我相信您的问题的答案是增加指针会导致未定义的行为，尽管您会看到内存泄漏。

我这么说是因为在您的示例中，您似乎没有保留指向已分配内存的原始指针。指针指向基地址以外的某个位置时，free 可能会做错事。

为确保您需要

1) 查看系统上正在使用的 RAM，尽可能少地运行其他内存

2) 运行程序几次，然后

3）然后再次查看内存使用情况。

然后通过如下更改您的代码再次尝试所有这些：

```
char * mem_ptr = (char*)malloc(21 * sizeof(char));
char * str = mem_ptr;

strcpy(str, "01234567890123456879");
str = str + 3;
free(mem_ptr); 
```

# php - 递归数组结构化

> ID：11036950
> 
> 赞同：2
> 
> 时间：2012-06-14T16:01:04.233
> 
> 标签：php

> **可能重复：**
> [具有数组结构的字符串到数组](https://stackoverflow.com/questions/8537148/string-with-array-structure-to-array)

我有一个这样的数组

```
$foo = array();
$foo['/'] = 'value';
$foo['/foo'] = 'value';
$foo['/foo/bar'] = 'value';
$foo['/test'] = 'value';
$foo['/test/tester'] = 'value';
$foo['/hello'] = 'value';
$foo['/hello/world'] = 'value';
$foo['/hello/world/blah'] = 'value'; 
```

我需要做的是将这些子页面存储在树状结构中，因此需要自动将其转换为：

```
 $foo = array(
    '/' => array(
        'value' => 'value',
        'children' => array(
            '/foo' => array(
                'value' => 'value',
                'children' => array(
                    '/foo/bar' => array(
                        'value' => 'value',
                        'children' => array()
    ); 
```

我想我会做的事情是这样的：

```
$newArray = array();
foreach( $foo as $key => $val )
{
    $bits = explode('/', $key);

    foreach( $bits as $bit )
    {
        $newArray[$bit] = array('val' => $val);
    }
}

print_r($newArray); 
```

除了我以某种方式需要进入 newArray，并跟踪我在数组中的深度。有没有人有他们如何做到这一点的示例脚本，或者有任何时髦的阵列步行技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T17:38:36.703

该解决方案可以通过变量引用（又名“指针”）来实现，更多信息请参见[http://php.net/manual/en/language.references.php](http://php.net/manual/en/language.references.php)

```
<?php

$foo = array();
$foo['/'] = 'value';
$foo['/foo'] = 'value';
$foo['/foo/bar'] = 'value';
$foo['/test'] = 'value';
$foo['/test/tester'] = 'value';
$foo['/hello'] = 'value';
$foo['/hello/world'] = 'value';
$foo['/hello/world/blah'] = 'value';

function nest(&$foo)
{
    $new = array();
    foreach ($foo as $path => $value)
    {
        $pointer =& $new;
        $currentPath = '';
        if ($pathParts = explode('/', trim($path, '/'))) {
            while($nextKey = array_shift($pathParts)) {
                $currentPath .= '/' . $nextKey;
                if (!isset($pointer['children'][$currentPath])) {
                    $pointer['children'][$currentPath] = array();
                }
                $pointer =& $pointer['children'][$currentPath];
            }
        }
        $pointer['value'] = $value;
    }
    return $new ? array('/' => $new) : array();
}

print_r($foo);
print_r(nest($foo));

?> 
```

# javascript - 如何处理返回带有引号的字符串的javascript函数调用

> ID：11036951
> 
> 赞同：0
> 
> 时间：2012-06-14T16:01:08.173
> 
> 标签：javascript

我在对 NetSuite 中的 api 函数进行 javascript 调用时遇到问题，该函数返回一个带引号的字符串。每次调用都会抛出一个错误。

```
var selling_point_1 = "<%=getCurrentAttribute('item','custitemsellingpoint1')%>"; 
```

在调试器中查看时，计算结果为：

```
var selling_point_1 = "Product Dimensions: H:14" W:24""; 
```

对此的任何字符串函数（如 .length 或 charAt(0) ）也会引发错误。我无法控制函数调用返回的内容，所以我需要知道如何处理嵌入的引号。

任何帮助将不胜感激，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:14:54.670

虽然不是您可以使用的最可靠的方法：

```
var selling_point_1 = escape("<%=getCurrentAttribute('item','custitemsellingpoint1')%>"); 
```

这实际上是用于 URI 转义，但会去掉讨厌的双引号，而且您可以使用 unescape 来恢复原始格式。正如建议的那样

```
var selling_point_1 = '<%=getCurrentAttribute(\'item\',\'custitemsellingpoint1\')%>'; 
```

也应该适用于您的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T04:16:37.280

有关处理大致相同问题的人，请参阅[此线程。](http://www.velocityreviews.com/forums/t70655-escape-function-in-asp-net.html)*简短的回答是您需要在服务器端*代码中（即在块内）运行某种转义函数，`<%=...%>`以便只有转义值插入到客户端代码中。以下所有解决方案都可以处理无限数量的单引号和双引号。

我的第一个建议是尝试：

```
var selling_point_1 = decodeURI("<%=Server.URLEncode(getCurrentAttribute('item','custitemsellingpoint1'))%>"); 
```

这将生成如下所示的服务器端 JS：

```
var selling_point_1 = decodeURI("Product Dimensions: H:14%22 W:24%22"); 
```

`decodeURI`JavaScript 函数会将后面转换为引号，并且正确的`%22`字符串将存储在`selling_point_1`.

**如果失败**，您还可以尝试以下操作：

```
var selling_point_1 = unescape("<%=HttpServerUtility.HtmlEncode(getCurrentAttribute('item','custitemsellingpoint1'))%>"); 
```

它的操作类似，但是将您的引号转换为`\"`序列，这些序列将由 JavaScript 转换回普通引号`unescape`。

# javascript - 如何仅使用 Javascript 在 Backbone.js 中引导集合

> ID：11036952
> 
> 赞同：8
> 
> 时间：2012-06-14T16:01:09.120
> 
> 标签：javascript, backbone.js, backbone.js-collections

**背景：**我正在构建一个应用程序，该应用程序需要几个大型参考数据集合才能运行。我仅限于 HTML 和 Javascript（包括 JSON）。

**问题**：我如何在 Backbone.js 中引导一个集合，其中集合对象在服务器上是 JSON 格式并且我只使用 Javascript？

这是我已经知道的：

*   Backbone.js 引导最佳实践需要 Rails 或其他一些服务器端语言 ( [http://backbonejs.org/#FAQ-bootstrap](http://backbonejs.org/#FAQ-bootstrap) )。
*   大多数 Javascript I/0 操作都是异步的，例如从服务器加载 JSON。
*   在 Backbone.js 中，使用 fetch() 引导数据被认为是一种反模式。fetch() 也是一个异步操作。

到目前为止，这是我想出的：

```
ItemList = Backbone.Collection.extend({
  model: Item,
  url: 'http://localhost:8080/json/items.json'
});
var itemList = new ItemList;
itemList.fetch();
itemList.on('reset', function () { dqApp.trigger('itemList:reset'); }); 
```

*'dqApp' 是我的应用程序对象。我可以显示一个微调器，并在填充集合时通过向应用程序对象发送警报来更新加载状态。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:10:15.827

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T20:43:16.437

该[`fetch`函数](http://backbonejs.org/#Collection-fetch)接受一个选项参数，该参数可以有一个`success`回调：

```
var itemList = new ItemList;
itemList.fetch({success: function () {
    dqApp.trigger('itemList:reset');
}}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-08T08:28:49.867

一种可能的解决方案是使您的视图依赖于 的状态`fetch`，因此在您的模型/集合完成加载之前它不会被实例化。

请记住，这是一个 Backbone 反模式。使视图依赖于您的集合/模型可能会导致 UI 延迟。这就是为什么推荐的方法是通过直接在页面中内联 json 来引导数据。

但这并不能解决您的情况，您需要在无**服务器**情况下引导数据。使用几行 Ruby/PHP/etc 将 json 数据动态嵌入页面很容易，但如果您只在**客户端**工作，则使视图依赖于模型是可行的方法。

如果您使用 加载集合`fetch()`，则可以使用以下内容：

```
var Model = Backbone.Model.extend({});

var Collection = Backbone.Collection.extend({
    model: MyModel,
    url: 'http://localhost:8080/json/items.json'
});

var View = Backbone.View.extend({
    //code
});

var myCollection = new Collection();

myCollection.fetch({
    success: function () { 
        console.log('Model finished loading'); }
        myView = new View();
  }); 
```

我的首选方法是使用 ajax（例如 , `.getJSON`）`.ajax`并将返回的 jqXHR 对象（或 XMLHTTPRequest，如果您不使用 jQuery）保存到模型中的属性中。这样您就可以进行更精细的控制，并且可以在创建视图之前使用[延迟对象](https://stackoverflow.com/questions/4866721/what-are-deferred-objects)响应来检查调用的状态。

```
var Model = Backbone.Model.extend({});

var Collection = Backbone.Collection.extend({
    model: Model,
    status: {},
    initialize: function () {
        var _thisCollection = this;
        this.status = $.getJSON("mydata.json", function (data) {
            $.each(data, function(key) {
                var m = new Model ( {
                        "name": data[key].name,
                        "value": data[key].value,
                    } );
                _thisCollection.add(m);
            });
        });
    }
});

var View = Backbone.View.extend({
    console.log( "Creating view...");
    //code
});

var myCollection = new Collection();
var myView = {};
myCollection.status
    .done(function(){
        console.log("Collection successfully loaded. Creating the view");
        myView = new View();
    })
    .fail(function(){
        console.log("Error bootstrapping model");
    }); 
```

# ruby-on-rails - Rails / Haml：如何创建帖子表单？

> ID：11036954
> 
> 赞同：11
> 
> 时间：2012-06-14T16:01:15.460
> 
> 标签：ruby-on-rails, forms, haml

我正在尝试制作一个简单的表格，但效果不太好。这是我当前的表单代码：

```
%form{ :controller => 'tool', :action => 'activation', :method => 'post' }
  %table{ :border => 0, :width => "100%", :height => "100%" }
    %tr{ :align => "center", :valign => "center" }
      %td
        %input{ :type => "text", :name => "accountName" }
        %input{ :type => "submit", :name => "submit", :value => "login" } 
```

尝试通过表单发送数据时收到此网址：`10.0.0.2:3000/activation`。我知道我可以制定`tool#activation`激活路线，但这是一种错误的方式，我想将帖子查询发送到`10.0.0.2:3000/tool/activation`，但`:action => 'tool/activation'`据我了解也是一种不好的方式。

你能给我建议吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-14T16:09:15.630

您应该使用 rails 辅助标签。

```
= form_tag tool_activation_path, :method => :post do
    # The table
        # The row
            # The data
                = text_field_tag "accountName", ""
                = submit_tag "Submit" 
```

在这里查看更多信息：http: [//api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html)

此外，您应该尽量避免使用不必要的表格来设置布局样式。相反，请考虑使用 CSS。

# javascript - 在 Javascript 中，如果你有一个函数，你可以按名称获取参数吗？

> ID：11036961
> 
> 赞同：1
> 
> 时间：2012-06-14T16:01:23.577
> 
> 标签：javascript

假设你有

```
var funct=function(a,b){
    return a+b;
};
console.log(funct); 
```

有什么方法可以从函数中获取参数（a 和 b）的名称？如果您使用该功能，您可以访问它们吗？我知道“参数”为您提供了一个类似数组的对象，但是有没有什么可以为您提供类似地图或类似对象的参数表示，以便您可以在声明函数时获取它们的名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T16:05:10.557

不，你不能这样做。没有办法将变量的名称作为字符串获取。

如果你真的需要这个，我建议不要传递多个参数，而是传递一个对象。

```
var funct=function(args){
    var argsNames = Object.keys(args); // Get the keys of the args object
    console.log(argsNames); // ['a','b']
    return args.a + args.b;
}; 
```

然后像这样调用它：

```
funct({
    a: 12,
    b: 2
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:08:10.580

一种方法是将函数转换为字符串并解析出来

```
var funct=function(a,b){
    return a+b;
};
var re = /\(([^)]*)/;
var daArgs = funct.toString().match(re)[1].split(/,\s?/);
console.log(daArgs); 
```

[jsFiddle](http://jsfiddle.net/9DxLZ/)

仍然不知道为什么需要它。

# cocos2d-iphone - 在 iPhone 模拟器而不是 iPhone 4 上运行的代码块？(COCOS2D)

> ID：11036962
> 
> 赞同：1
> 
> 时间：2012-06-14T16:01:23.767
> 
> 标签：cocos2d-iphone

我正在使用 ccTouchBegan 和 ccTouchEnded，由于某种原因，有一段代码可以在 iPhone 模拟器上完美运行，而在 iPhone 4 上根本无法运行。这就是我的方法的样子：

```
-(BOOL)ccTouchBegan:(UITouch*)touch withEvent:(UIEvent *)event {

firstTouch = [self convertTouchToNodeSpace:touch];

if (!self.currentFootball.footballHasEmbarked) {

    //arrow.position = ccp(fPos.x, fPos.y);
    float newAnc = (120 + (self.currentFootball.contentSize.width * .5f) + (arrow.contentSize.width * .5f)) / arrow.contentSize.width;
    arrow.anchorPoint = ccp(-newAnc, .5);//self.currentFootball.position;
    arrow.position = self.currentFootball.position;//ccp(fPos.x-120, fPos.y);
arrow.rotation = 180;
arrow.visible = YES;
arrow.scale = 0.5f;

    //powerLevel.position = fPos;
    powerLevel.position = self.currentFootball.position;
    powerLevel.rotation = 180;
powerLevel.percentage = 0;
powerLevel.visible = YES;

    outLine.position = self.currentFootball.position;
    outLine.rotation = 180;
    outLine.visible = YES;

    CCProgressFromTo *powerBarGoUp = [CCProgressFromTo actionWithDuration:1.0f from:0.0f to:100.0f];

    CCProgressFromTo *powerBarGoDown = [CCProgressFromTo actionWithDuration:1.0f from:100.0f to:0.0f];

    id action = [CCRepeatForever actionWithAction:[CCSequence actions:powerBarGoUp, powerBarGoDown,  nil]];
    [powerLevel runAction:action];

    return YES;
}
else {
    return NO;
} 
```

}

```
-(void) ccTouchEnded:(UITouch*)touch withEvent:(UIEvent *)event {

const float max = 100;

CGPoint endTouch = [self convertTouchToNodeSpace:touch];

if (endTouch.x > firstTouch.x) {
endTouch = ccp(firstTouch.x, endTouch.y);
    //CCLOG(@"I ran");
}

arrow.visible = NO;
powerLevel.visible = NO;
    outLine.visible = NO;
self.currentFootball.footballHasEmbarked = YES;
self.currentFootball.spiraling = YES;

if (self.currentFootball) {

    [smgr addBody:self.currentFootball.body];

}

 if (CGPointEqualToPoint(endTouch, firstTouch)) {
    CCLOG(@" I have run");
    float   anchorPointDist = ccpLength(endTouch);

    float   distFactor = distFromFb + anchorPointDist;

    projectionAnchorPoint = ccp(firstTouch.x + distFactor,firstTouch.y);

}

    CGPoint diff = ccpSub(endTouch, projectionAnchorPoint);

    float len = powerLevel.percentage;

CGPoint norm = ccpNormalize(diff);

if (len > max){
    len = max;
}

[self.currentFootball applyImpulse:ccpMult(norm, (len * 300))];

pos = self.currentFootball.position.y;

[self schedule:@selector(newFootball)]; 
```

}

这是不会在我的 iPhone 上运行的代码块。

```
if (CGPointEqualToPoint(endTouch, firstTouch)) {
    CCLOG(@" I have run");
    float   anchorPointDist = ccpLength(endTouch);

    float   distFactor = distFromFb + anchorPointDist;

    projectionAnchorPoint = ccp(firstTouch.x + distFactor,firstTouch.y);

} 
```

我做的不对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T16:11:21.140

打印出 endTouch 和 firstTouch 的值。它们在设备上的差异可能很小，因为与鼠标指针相比，将手指保持在同一位置更难。如果是这种情况，您可能希望在第一次触摸的范围内接受结束触摸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:12:33.157

也许您正在比较的点有一些细微的差别，使得比较的结果总是错误的。尝试使用此方法而不是 CGPointEqualToPoint。

```
BOOL ccpFuzzyEqual(CGPoint a, CGPoint b, float variance); 
```

# web-services - 我应该使用网络服务吗？

> ID：11036965
> 
> 赞同：0
> 
> 时间：2012-06-14T16:01:37.137
> 
> 标签：web-services

有 3 个不同的应用程序的数据格式不正确。我打算在进入数据库之前编写一个应用程序来正确格式化这些数据。使所有应用程序调用此格式化应用程序的最佳方法是什么？格式化应用程序应该是所有其他应用程序调用的 Web 服务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:08:13.723

如果它们确实是不同的应用程序（而不是，比如说，三个控制器和/或单个 webapp 的操作），是的，webservice 会非常适合，我想。

还有另一种方法：您可以设置一个简单的应用程序，该应用程序将在 shell 上下文中调用。或者，如果所有这些应用程序都使用相同的平台，则只需创建一个将由该平台调用的“库实用程序类”。

# php - 查找一个键存在于数组的子键中？

> ID：11036969
> 
> 赞同：3
> 
> 时间：2012-06-14T16:01:49.320
> 
> 标签：php, multidimensional-array, array-key-exists

如何检查数组的子键中是否存在键？如果找到该项目的该键，则返回该项目？

例如，我有这个数组，

```
Array
(
    [0] => Array
        (
            [a] => Array
                (
                    [quantity_request] => 1
                    [time_created] => 1339688613
                    [variant] => Array
                        (
                        )

                )

        )

    [1] => Array
        (
            [b] => Array
                (
                    [quantity_request] => 1
                    [time_created] => 1339688631
                    [variant] => Array
                        (
                        )

                )

        )

    [2] => Array
        (
            [c] => Array
                (
                    [quantity_request] => 1
                    [time_created] => 1339688959
                    [variant] => Array
                        (
                        )

                )

        )

) 
```

我想找到键'b'并返回它下面的所有内容，就像这就是我所追求的，

```
[b] => Array
                (
                    [quantity_request] => 1
                    [time_created] => 1339688631
                    [variant] => Array
                        (
                        )

                ) 
```

我尝试了这个，但没有任何回报，

```
if (array_key_exists('b', $this->content)) {
                echo "The 'b' element is in the array";

} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T16:06:58.880

```
function get_letter($letter){
    foreach($this->content as $v){
        if(array_key_exists($letter, $v) {
            return $v[$letter];
        }
    }
    return false;
}

$array = get_letter('a'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:07:06.683

你不能只遍历外部数组，检查里面的每个数组的键吗？

```
foreach($this->content as $arr) {
  if(array_key_exists('b', $arr) {
    echo "Found it";
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:08:26.383

foreach() 根数组，然后是[array_key_exists()](http://php.net/manual/en/function.array-key-exists.php)。

```
foreach ($array as $key => $value) {
    if (array_key_exists('b', $array[$key])) {
        return $array[$key]['b'];
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-14T16:51:23.680

我实际上不会使用它，因为它不是清晰的代码，但是，它是 php 5.4 的一个很酷的内衬

```
$val = call_user_func_array('array_merge', $array)['b']; 
```

# cakephp - CAKEPHP：如何比较两个数组之间的共同项

> ID：11036974
> 
> 赞同：0
> 
> 时间：2012-06-14T16:02:18.977
> 
> 标签：cakephp, cakephp-2.1

如何比较两个数组并在第三个数组中列出常见项目。我想打印第三个数组。请帮助各位。我的结果出现在两个列表中。

```
<?php 

    $appsubjects = $this->ProgrammeChoice->
    ApplicantsDetail->ApplicantAlevelQualification->
    find('list',array('fields'=> array('subject_code'),
    'conditions'=>array('ApplicantAlevelQualification.applicants_detail_id'=>$app_id)));

     $progrequirements[] =
          $this->ProgrammeChoice->Programme->ProgrammeRequirementsSubject->
    find('all',array('fields'= >        array('programme_code','subject_code','programme_name','compulsory'),
    'conditions'=>
    array('subject_code'=>$s_code,'compulsory'=>'true')));

?> 
```

所以现在我不知道如何获得*Array(1)*和*Array(2)*`subject_code`相同的项目的第三个列表，其中是正确的。**`compulsory`**

 **我的课程的本质是希望申请人进入他们的学科，申请不同的学位课程。然后对于每个学位，都有必修科目（*Array(2)*），有些是必修科目。所以我的程序应该能够列出与输入的科目相匹配的所有学位课程。我希望你能理解我的问题。请帮助我卡住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T11:03:49.543

如果我理解了，我认为你做错了。您进行了两次数据库查询，然后您想要找到共同的项目。直接在查询中做呢？:) 有什么好的理由不这样做吗？

编辑：或在用户提交内容后进行第三次查询。一些 ajax 和瞧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T07:49:06.353

我不打算讨论为什么你可能想要比较数组。但确实，阵列操纵技能总能派上用场。

CakePHP 有[Set Array Management](http://book.cakephp.org/2.0/en/core-utility-libraries/set.html)类。查找数组差异可能需要的是[Set::diff](http://book.cakephp.org/2.0/en/core-utility-libraries/set.html#Set::diff)函数。它“计算一个集合和一个数组、两个集合或两个数组之间的差异”。以下示例来自 CakePHP 2.0 Book：

```
 <?php
    $a = array(
        0 => array('name' => 'main'),
        1 => array('name' => 'about')
    );
    $b = array(
        0 => array('name' => 'main'),
        1 => array('name' => 'about'),
        2 => array('name' => 'contact')
    );

    $result = Set::diff($a, $b);
    /* $result now looks like:
        Array
        (
            [2] => Array
                (
                    [name] => contact
                )
        )
    */
    $result = Set::diff($a, array());
    /* $result now looks like:
        Array
        (
            [0] => Array
                (
                    [name] => main
                )
            [1] => Array
                (
                    [name] => about
                )
        )
    */
    $result = Set::diff(array(), $b);
    /* $result now looks like:
        Array
        (
            [0] => Array
                (
                    [name] => main
                )
            [1] => Array
                (
                    [name] => about
                )
            [2] => Array
                (
                    [name] => contact
                )
        )
    */

    $b = array(
        0 => array('name' => 'me'),
        1 => array('name' => 'about')
    );

    $result = Set::diff($a, $b);
    /* $result now looks like:
        Array
        (
            [0] => Array
                (
                    [name] => main
                )
        )
    */
?> 
```

Set 还有其他强大的实用程序，我建议您检查一下。当需要在数据库层之外进行自定义数据操作时，我一直都在使用它。**

# c# - 多线程加速加载时间

> ID：11036975
> 
> 赞同：0
> 
> 时间：2012-06-14T16:02:20.770
> 
> 标签：c#, multithreading, load-time

我制作了一个加载一堆计算机信息的程序。在 Form_Load 事件中，我让它初始化 3 个（该数量会增加）信息面板。具有一堆单元信息的程序似乎使程序加载相当缓慢。我试图通过从 WMI 切换到使用本机调用来加速它，这帮助了很多。很快我也会发布网络信息。我曾经加载过该面板，但我将其禁用了一段时间，直到我解决了其他面板中的错误。因此，在学习如何使用单独的线程来更新我的电池信息时，我认为我可以在我的单元信息面板中创建单独的线程，以便它可以更快地加载。我不知道我的任何信息都会导致并发问题，但我可以解决这个问题。

我想从小处着手，所以如果我改变这个怎么办

```
 private void Form1_Load(object sender, EventArgs e)
    {
        unitInformationPanel1.PopulateUnitInformation();
        batteryInformationPanel1.InitializeBatteries();
        magStripeReaderPanel1.SetupPointOfSale();
    } 
```

对此

```
 private void Form1_Load(object sender, EventArgs e)
    {
        Thread infoThread = new Thread(new ThreadStart(unitInformationPanel1.PopulateUnitInformation));
        infoThread.Start();
        batteryInformationPanel1.InitializeBatteries();
        magStripeReaderPanel1.SetupPointOfSale();
    } 
```

填充单元信息完成后，信息线程会终止吗？还是将该线程创建移到 PopulateUnitInformation 中会更好？这是它的样子。

```
 public void PopulateUnitInformation()
    {
        unitModelLabel.Text = Properties.Settings.Default.UnitModelString;
        serialNumberLabel.Text = Properties.Settings.Default.UnitSerialString;
        biosVersionLabel.Text = UnitBios.GetBiosNumber();
        osLabel.Text = OS.getOSString();
        cpuLabel.Text = UnitCpu.GetCpuInfo();

        var hdd = HddInfo.GetHddInfo();
        diskNameLabel.Text = hdd.Name;
        diskCapacityLabel.Text = hdd.Capacity;
        diskFirmwareLabel.Text = hdd.Firmware;
        memoryLabel.Text = MemoryInformation.GetTotalMemory();
        NetworkPresenceInformation.GetAdapatersPresent();
        biometricLabel.Text = BiometricInformation.IsPresent ? "Present" : "Not Present";
        var networkAdaptersPresense = NetworkPresenceInformation.GetAdapatersPresent();
        bluetoothLabel.Text = networkAdaptersPresense[0] ? "Present" : "Not Present";
        wifiLabel.Text = networkAdaptersPresense[1] ? "Present" : "Not Present";
        cellularLabel.Text = networkAdaptersPresense[2] ? "Present" : "Not Present";
    } 
```

--

哇，我只是用信息线程运行它，它仍然需要一些时间来加载（可能是我在主线程中创建的 12 个面板。但它加载了 12 个帧，并且单元信息面板在加载所有内容后填充了它的信息。这很酷, 但它安全吗？为我的面板制作 12 个线程是否容易一些？还是很愚蠢？

**编辑**

这就是我为秒表所做的。

```
 Stopwatch programTimer;
    public Form1()
    {
        programTimer = Stopwatch.StartNew();
        InitializeComponent();
        SetupDebugWindow();
        TerminateKeymon();
        UnitModel.SetModel();
        UnitSerialNumber.SetSerialNumber();
    }
    private void Form1_Shown(object sender, EventArgs e)
    {
        audioBrightnessPanel1.UpdateBrightnessTrackbar();
        applicationLauncherPanel1.LoadApplications();
        programTimer.Stop();
        Console.WriteLine("Load Time: {0}",programTimer.ElapsedMilliseconds);
        timer1.Start();
    } 
```

这会准确吗？

**编辑 2 2012 年 6 月 18 日**

好吧，我接受了使用 backgroundworker 的建议。如果我做对了，请告诉我。

```
 private void Form1_Load(object sender, EventArgs e)
    {
        backgroundWorker1.RunWorkerAsync();
    }
    void BackgroundWorker1DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
    {
        unitInformationPanel1.PopulateUnitInformation();
        batteryInformationPanel1.InitializeBatteries();
        magStripeReaderPanel1.SetupPointOfSale();
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T16:11:11.253

You've asked a very broad question, but I'm going to give some general advice. If you want more specific information, you should consider deleting this question and posting more specific individual questions.

1.  First and foremost, you should very strongly consider using something like the `System.Threading.Task` class for your multithreaded operations. There is a ton of information online about how to get started with it and how you can use `Task`s to manage asynchronous operations. The short story is that if you're spinning up your own thread (as you're doing above), you almost *certainly* should be using something else to do that for you.

2.  Adding multithreading to your code will not, in the strictest sense of the word, make it any "faster"; they will always take the same amount of total processor time. What it can and will do is two things: free up the UI thread to be responsive and allow you to split that "total processor time" across multiple cores or processors, should those be available to the system. So, if you have operation X that takes 10 seconds to complete, then just shifting operation X to another thread will not make it complete any faster than 10 seconds.

3.  No, what you are doing above is **not** safe. I'm assuming that somewhere you've turned off checking for cross-thread communication errors in your app? Otherwise, that code *should* throw an exception, assuming this is a WinForms or WPF application. This is one reason to use `Task`s, as you can easily separate the part of your process that actually takes a long time (or isn't UI related), then add a task continuation that uses the results and populates the UI elements within a properly synchronized context.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-22T15:52:03.387

So my final approach this was as follows. I felt that my Main Form was doing more than it should. Sticking with the single responsibility principle I decided that MainForm should only be responsible for one thing, showing and displaying all 12 panels (now down to 11, i turned one into a menu item). So moved all the multithreading out of mainform and into program.cs. I found that this was even a little more difficult. What I did find though was a simple solution that allows me to not even worry about multithreading at all. It was the Idle event. Here is what i chose to do.

```
 [STAThread]
    static void Main()
    {
        DateTime current = DateTime.Now;
        DateTime today = new DateTime(2012,7,19);
        TimeSpan span = current.Subtract(today);
        if (span.Days<0)
        {
            MessageBox.Show("Please adjust Time then restart Aspects","Adjust Time");
            Process.Start("timedate.cpl").WaitForExit();
        }
        else
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Idle += new EventHandler(Application_Idle);

            mainForm = new MainForm();
            mainForm.Closing += new CancelEventHandler(mainForm_Closing);

            #if !DEBUG
            TerminateKeymon();
            StartSerial();
            SetupDefaultValues();
            EmbeddedMessageBox(0);
            #endif

            Application.Run(mainForm);
        }
    }

    static void Application_Idle(object sender, EventArgs e)
    {
        Application.Idle -= Application_Idle;
        mainForm.toolStripProgressBar1.Increment(1);
        UnitInformation.SetupUnitInformation();
        mainForm.toolStripProgressBar1.Increment(1);
        Aspects.Unit.HddInfo.GetHddInfo();
        mainForm.toolStripProgressBar1.Increment(1);

        for (int i = 0; i < mainForm.Controls.Count; i++)
        {
            if (mainForm.Controls[i] is AbstractSuperPanel)
            {
                try
                {
                    var startMe = mainForm.Controls[i] as AbstractSuperPanel;
                    startMe.StartWorking();
                    mainForm.toolStripProgressBar1.Increment(1);
                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.Message + mainForm.Controls[i].ToString());
                }
            }
        }
        mainForm.toolStripProgressBar1.Value = 0;
    } 
```

to sum up what that does is is I add a idle listener event. Once the thead goes idle (basically meaning that Mainform is finished drawing and making all 12 panels and is showing on my desktop) I then kill the idle event listener and tell all my panels and classes to start working one at a time, updating my progress bar as I go. It works great. The load time is still the same as it was before, but there is window visibile after only a few seconds. Maybe not the best use of resources, but i think the solution is simple and straight forward.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T19:35:08.147

I had a question somewhat related to this for Mobile app development a few months back (see [How to write a Trigger?](https://stackoverflow.com/questions/7153321/)), and Marc "the man" Gravell posted back with a simple class that I modified to return data to my main application whenever the thread was complete.

The actual class I put into use has loads of pointless data (for you), so I'm going to paste in a revised version of Mr. Gravell's code using techniques which I used to make them work:

First, I had to create my own `EventArgs` class:

```
public class SuperEventArgs : EventArgs {

  private object data;

  public SuperEventArgs(object data) : base() {
    this.data = data;
  }

  public object Data { get { return data; } }

} 
```

Using that, here is a class I created to pass my data back to the main thread:

```
public delegate event DataChangedHandler(object sender, SuperEventArgs e);

public class Simple1 {

  private object parameter1, parameter2;
  private Control parent;

  #if PocketPC
  public delegate void MethodInvoker(); // include this if it is not defined
  #endif

  public Simple1(Control frmControl, object param1, object param2) {
    parent = frmControl;
    parameter1 = param1;
    parameter2 = param2;
  }

  public event DataChangedHandler DataChanged;

  public void Start() {
    object myData = new object(); // whatever this is. DataTable?
    try {
      // long routine code goes here
    } finally {
      if (DataChanged != null) {
        SuperEventArgs e = new SuperEventArgs(myData);
        MethodInvoker methInvoker = delegate {
          DataChanged(this, e);
        };
        try {
          parent.BeginInvoke(methInvoker);
        } catch (Exception err) {
          Log(err); // something you'd write
        }
      }
    }
  }

} 
```

Back in the actual main thread of execution, you'd do something like this:

```
public partial class Form1 : Form {

  private Simple1 simple;

  public Form1() {
    object query = new object(); // something you want to pass in
    simple = new Simple1(this, query, DateTime.Now);
    simple.DataChanged += new DataChangedHandler(simple1_DataChanged);
    Thread thread = new Thread(simpleStart);
    thread.Start();
  }

  private void simpleStart() {
    if (simple != null) {
      simple.Start();
    }
  }

  private void simple1_DataChanged(object sender, SuperEventArgs e) {
    MyFancyData fancy = e.Data as MyFancyData;
    if (fancy != null) {
      // populate your form with the data you received.
    }
  }
} 
```

I know it looks long, but it works really well!

This is not anything I have actually tested, of course, because there isn't any data. If you get to working with it and you experience any issues, let me know and I'll happily help you work through them.

~JoeP

# rest - Nexus 获取依赖项 REST 或创建插件

> ID：11036978
> 
> 赞同：1
> 
> 时间：2012-06-14T16:02:29.287
> 
> 标签：rest, plugins, nexus, sonatype

Nexus 专业版显示了工件的依赖关系...

想要在社区版中做同样的事情。看起来不像标准的 REST API：

```
 https://repository.sonatype.org/nexus-core-documentation-plugin/core/docs/data_ns0.html 
```

为依赖项提供服务。已经在谷歌上搜索了创建插件的示例（现在对插件的 Nexus 文档不太收费），并尝试创建一个插件（基于 REST）来提取每个工件的依赖项。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T07:58:38.190

看看这个“无头”插件（为其他插件提供服务的插件，它自己没有任何功能或 UI）： [https ://github.com/sonatype/nexus/tree/master/nexus/nexus-core-plugins /nexus-maven-bridge-plugin](https://github.com/sonatype/nexus/tree/master/nexus/nexus-core-plugins/nexus-maven-bridge-plugin)

Nexus 使用纯 Aether，而不是（整个）Maven - 正如 Manfred 所说 - 来计算依赖树......再次，只需看看上面的那个插件，它就在那里；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T03:27:21.650

据我所知，Nexus 基本上会下载您感兴趣的项目的 pom.xml 并运行 maven 依赖插件的列表或树目标，然后很好地显示结果。

你当然可以在你自己的自定义插件中做同样的事情。您也可以直接使用 Aether API 和其他 API 在您的插件中进行依赖解析，而不是从外部调用插件然后显示结果.. 事实上 Nexus 可能只是这样做。

现实地自己写这个听起来像是在重新发明轮子，而我只会获得 Pro 许可证。除了这个最小的功能之外，pro 还有很多其他的好处。试一试。

# python - 关闭 TraitsUI 窗口而不单击确定

> ID：11036985
> 
> 赞同：4
> 
> 时间：2012-06-14T16:03:03.073
> 
> 标签：python, traits

我正在使用 TraitsUI 开发应用程序。

我需要弹出一个窗口来请求一些值。

会有类似 ProcessValues 按钮和 SaveValues 按钮的东西。

*   如果单击 ProcessValues，则应进行某些操作，然后应关闭窗口
*   如果单击 SaveValues，则应执行其他操作，窗口也应关闭。

应该没有确定按钮

在下面的示例代码中，单击按钮会打印处理程序中的消息，但除了单击框架中的 [x] 之外，我不知道如何使窗口自行关闭。

重载 close() 似乎不起作用，因为它在单击 OK 后被调用。也许有一种方法可以生成 close_window 事件，或者它可能是别的东西。

有人可以帮忙吗？

```
from enthought.traits.api import HasTraits, Instance, Str, Int, List, Any, DelegatesTo
from enthought.traits.ui.api import Handler, View, Item, Action

class MyPanelHandler(Handler):
    def _process_values(self, info):
        #>>>reach process_values() through info and call
        print 'values processed OK'
        #>>> what goes here so that the window is closed?
    def _save_values(self, info):
        #>>>reach save_values() through info and call
        print 'values saved OK'
        #>>> what goes here so that the window is closed?

class MyPanel(HasTraits):
    model = Any
    name = Str
    age = Int
    process_values_button = Action(name = 'Process Values', action = '_process_values')
    save_values_button = Action(name = 'Save Params', action = '_save_values')

    view = View( 'name', 'age', handler = MyPanelHandler(),
            buttons = [process_values_button, save_values_button],)

class MyApp(HasTraits):
    panel = Instance(MyPanel)

    def __init__(self):
        self.panel = MyPanel(model = self)
    def get_values(self):
        self.panel.configure_traits()
    def save_values(self, name, age):
        print '... doing whatever to save values'
    def process_values(self):
        print '... doing whatever to process values'

if __name__ == '__main__':
    a = MyApp()
    a.get_values() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T10:55:46.190

我在其他地方找到了解决方案。要关闭窗口，单击调用 Handler 中方法的 Action，请从 Handler 调用“info.ui.dispose()”（其中 info 是传递给处理程序方法的唯一参数，而不是 self）。

这是修正后的虚拟程序；当心“if not info.initialized”部分——没有它，如果由于某种原因 uiinfo 对象需要很长时间才能填充，则可能会引发异常。

```
from enthought.traits.api import HasTraits, Instance, Str, Int, List, Any, DelegatesTo
from enthought.traits.ui.api import Handler, View, Item, Action

class MyPanelHandler(Handler):
    def _process_values(self, info):
        if not info.initialized: 
            return # do this in case info takes long to initialize
        # invoke methods
        info.object.model.process_values(info.object.name, info.object.age)
        print 'values have been processed'
        info.ui.dispose() # THIS IS WHAT I WAS ACTUALLY ASKING FOR
    def _save_values(self, info):
        if not info.initialized: return
        info.object.model.save_values(info.object.name, info.object.age)
        print 'values have been saved'
        info.ui.dispose()

class MyPanel(HasTraits):
    model = Any
    name = Str
    age = Int
    process_values_button = Action(name = 'Process Values', action = '_process_values')
    save_values_button = Action(name = 'Save Params', action = '_save_values')   
    view = View( 'name', 'age', handler = MyPanelHandler(),
            buttons = [process_values_button, save_values_button],)

class MyApp(HasTraits):
    panel = Instance(MyPanel)
    def __init__(self):
        self.panel = MyPanel(model = self)
    def get_values(self):
        self.panel.configure_traits()
    def save_values(self, name, age):
        print '... saving (%s, %s)' % (name, age)
    def process_values(self, name, age):
        print '... processing (%s, %s)' % (name, age)

if __name__ == '__main__':
    a = MyApp()
    a.get_values() 
```

# r - 将所有 0 值替换为 NA

> ID：11036989
> 
> 赞同：183
> 
> 时间：2012-06-14T16:03:13.400
> 
> 标签：r, r-faq

我有一个带有一些数字列的数据框。某些行的值为 0，在统计分析中应视为空值。在R中将所有0值替换为NULL的最快方法是什么？

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2012-06-14T16:09:45.513

将所有零替换为 NA：

```
df[df == 0] <- NA 
```

**解释**

**1.**这不是`NULL`您应该想要替换零的东西。正如它所说`?'NULL'`，

> NULL 表示 R 中的空对象

这是独一无二的，我想，可以被视为最无信息和空洞的对象。¹那么就不足为奇了

```
data.frame(x = c(1, NULL, 2))
#   x
# 1 1
# 2 2 
```

也就是说，R 不为这个空对象保留任何空间。²同时，看着`?'NA'`我们看到

> NA 是长度为 1 的逻辑常数，其中包含缺失值指示符。NA 可以强制转换为除 raw 之外的任何其他向量类型。

重要的`NA`是，长度为 1，以便 R 为其保留一些空间。例如，

```
data.frame(x = c(1, NA, 2))
#    x
# 1  1
# 2 NA
# 3  2 
```

此外，数据框结构要求所有列具有相同数量的元素，这样就不会出现“漏洞”（即`NULL`值）。

现在，您可以在数据框中用零替换零，`NULL`即完全删除包含至少一个零的所有行。`var`例如，当使用 、`cov`或`cor`时，这实际上等同于首先将零替换为`NA`并将其值设置`use`为`"complete.obs"`。然而，这通常不能令人满意，因为它会导致额外的信息丢失。

**2.**`df == 0`在解决方案中，我使用矢量化，而不是运行某种循环。`df == 0`返回（尝试）一个与 相同大小的矩阵，其中包含和`df`的条目。此外，我们还可以将此矩阵传递给子集（参见参考资料）。最后，虽然结果非常直观，但给出预期效果可能看起来很奇怪。赋值运算符确实并不总是那么聪明，并且不能以这种方式与其他一些对象一起工作，但它可以与数据帧一起工作；见。`TRUE``FALSE``[...]``?'['``df[df == 0]``df[df == 0] <- NA``<-``?'<-'`

[¹集合论中的空集感觉有某种关联。]
[²与集合论的另一个相似之处：空集是每个集合的子集，但我们不为它保留任何空间。]

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2015-02-20T14:08:32.130

让我假设您的 data.frame 是不同数据类型的混合，并非所有列都需要修改。

仅修改第 12 到 18 列（总共 21 列），只需执行此操作

```
df[, 12:18][df[, 12:18] == 0] <- NA 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2018-07-04T16:52:53.947

`dplyr::na_if()`是一个选项：

```
library(dplyr)  

df <- data_frame(col1 = c(1, 2, 3, 0),
                 col2 = c(0, 2, 3, 4),
                 col3 = c(1, 0, 3, 0),
                 col4 = c('a', 'b', 'c', 'd'))

na_if(df, 0)
# A tibble: 4 x 4
   col1  col2  col3 col4 
  <dbl> <dbl> <dbl> <chr>
1     1    NA     1 a    
2     2     2    NA b    
3     3     3     3 c    
4    NA     4    NA d 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-01-06T11:56:46.587

`[<-`没有该功能的另一种方法：

一个示例数据框`dat`（无耻地从@Chase 的答案中复制）：

```
dat

  x y
1 0 2
2 1 2
3 1 1
4 2 1
5 0 0 
```

零可以用`NA`以下`is.na<-`函数替换：

```
is.na(dat) <- !dat

dat

   x  y
1 NA  2
2  1  2
3  1  1
4  2  1
5 NA NA 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-06-14T16:11:26.367

```
#Sample data
set.seed(1)
dat <- data.frame(x = sample(0:2, 5, TRUE), y = sample(0:2, 5, TRUE))
#-----
  x y
1 0 2
2 1 2
3 1 1
4 2 1
5 0 0

#replace zeros with NA
dat[dat==0] <- NA
#-----
   x  y
1 NA  2
2  1  2
3  1  1
4  2  1
5 NA NA 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-06-02T00:58:09.240

因为有人要求这个的 Data.Table 版本，并且因为给定的 data.frame 解决方案不适用于 data.table，所以我在下面提供了解决方案。

基本上，使用`:=`运算符 -->`DT[x == 0, x := NA]`

```
library("data.table")

status = as.data.table(occupationalStatus)

head(status, 10)
    origin destination  N
 1:      1           1 50
 2:      2           1 16
 3:      3           1 12
 4:      4           1 11
 5:      5           1  2
 6:      6           1 12
 7:      7           1  0
 8:      8           1  0
 9:      1           2 19
10:      2           2 40

status[N == 0, N := NA]

head(status, 10)
    origin destination  N
 1:      1           1 50
 2:      2           1 16
 3:      3           1 12
 4:      4           1 11
 5:      5           1  2
 6:      6           1 12
 7:      7           1 NA
 8:      8           1 NA
 9:      1           2 19
10:      2           2 40 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2020-04-18T05:09:35.937

如果有人通过谷歌到达这里寻找*相反*的东西（即如何用 0 替换 data.frame 中的所有 NA），答案是

```
df[is.na(df)] <- 0 
```

或者

使用 dplyr / tidyverse

```
library(dplyr)
mtcars %>% replace(is.na(.), 0) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-01-24T19:46:44.270

您只能在数字字段中替换`0`为`NA`（即排除因子之类的内容），但它可以逐列地工作：

```
col[col == 0 & is.numeric(col)] <- NA 
```

使用函数，您可以将其应用于整个数据框：

```
changetoNA <- function(colnum,df) {
    col <- df[,colnum]
    if (is.numeric(col)) {  #edit: verifying column is numeric
        col[col == -1 & is.numeric(col)] <- NA
    }
    return(col)
}
df <- data.frame(sapply(1:5, changetoNA, df)) 
```

尽管您可以将 替换为`1:5`数据框中的列数，或者替换为`1:ncol(df)`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-05-21T12:57:09.070

如果您像我一样，在想知道如何用 NA 替换数据框中的所有值时来到这里，那就是：

```
df[,] <- NA
```

# actionscript-3 - AS3 从具有 && 格式的 txt 文件加载变量

> ID：11036995
> 
> 赞同：0
> 
> 时间：2012-06-14T16:03:26.050
> 
> 标签：actionscript-3, flash, variables

我正在尝试将一个 txt 变量文件加载到我的 AS3 项目中。我遇到的问题似乎归结为 txt 文件（已预先格式化且无法更改）是使用双符号格式化的......例如

&name=mark&
&address=这里&
&tel=12345&

我正在使用以下代码加载 txt 文件

```
myLoader.addEventListener(Event.COMPLETE, onLoaded, false, 0, true);
myLoader.dataFormat = URLLoaderDataFormat.VARIABLES;
urlRqSend = new URLRequest(addressToTxt.txt);

public function onLoaded(e:Event):void {
trace(myLoader.data);
} 
```

使用 URLLoaderDataFormat.VARIABLES 会产生以下错误：

```
Error: Error #2101: The String passed to URLVariables.decode() must be a URL-encoded query string containing name/value pairs. 
```

如果我使用 URLLoaderDataFormat.TEXT 我可以成功加载数据，但我不能（或不知道如何）访问变量。

请问有人对此有任何想法或解决方法吗？

谢谢，

标记

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T16:26:43.897

我前段时间遇到过这样的问题。我建议您首先加载为文本，删除那些换行符，额外的＆符号并手动解析：

```
var textVariables:String;
var objectVariables:Object = new Object();
...
myLoader.addEventListener(Event.COMPLETE, onLoaded, false, 0, true);
myLoader.dataFormat = URLLoaderDataFormat.TEXT;
urlRqSend = new URLRequest(addressToTxt.txt);

public function onLoaded(e:Event):void {
    textVariables = myLoader.data;
    textVariables = textVariables.split("\n").join("").split("\r").join(""); // removing line breaks
    textVariables = textVariables.split("&&").join("&"); // removing extra amphersands

    var params:Array = textVariables.split('&');

    for(var i:int=0, index=-1; i < params.length; i++)
    {
        var keyValuePair:String = params[i];
        if((index = keyValuePair.indexOf("=")) > 0)
        {
             var key:String = keyValuePair.substring(0,index);
             var value:String = keyValuePair.substring(index+1);
             objectVariables[key] = value;
             trace("[", key ,"] = ", value);
        }
    } 

} 
```

我直接在这里写了那个代码，我这里没有任何 AS3 编辑器，所以，也许你会发现错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T16:26:37.053

如果您在 String 中有数据并且它的结构与您编写的一样，您可以采取一种解决方法：

```
dataInString = dataInString.split("\n").join("").split("\r").join(""); // removing EOL
dataInString = dataInString.slice(0,-1); // removing last "&"
dataInString = dataInString.slice(0,1); // removing first "&"

var array:Array = dataInString.split("&&");
var myVariables:Object = new Object();

for each(var item:String in array) {
    var pair:Array = item.split("=");
    myVariables[pair[0]] = pair[1];
} 
```

那应该使您成为具有适当变量的对象。

# php - 未收到php curl发布数据

> ID：11036997
> 
> 赞同：0
> 
> 时间：2012-06-14T16:03:28.070
> 
> 标签：php, curl

以下代码将数据发送到一个测试页面，该页面只是 var_dumps _REQUEST 变量。该页面没有获取 post 参数，而是获取了 get 参数。为什么会发生这种情况？

```
<?php
     $jsonData = '{"Page":"index.html","KeyNumber":12132321}';
     $timeout = 20; 
     $options = array(
       CURLOPT_URL => "http://myadmin/postdump.php?AID=100&age=5&ishide=0",
       CURLOPT_RETURNTRANSFER => true, 
       CURLOPT_CONNECTTIMEOUT => $timeout,
       CURLOPT_POST => true,
       CURLOPT_POSTFIELDS =>'jsonData='.$jsonData,
       CURLOPT_ENCODING=>"",
       CURLOPT_FOLLOWLOCATION=>true
       );

     $ch = curl_init();
     curl_setopt_array($ch, $options);
     $file_contents = curl_exec($ch);
     curl_close($ch);

     echo  $file_contents;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:39:30.150

尝试使用 urlencode 函数对字段的值进行编码，我还建议将标头添加到请求中以模拟表单请求，将带有标头的数组传递给 CURLOPT_HTTPHEADER 选项，例如

```
 $headers = array(
      'Host: domain.com',
      'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
      'Accept-Encoding: gzip, deflate',
      'Content-Type: application/x-www-form-urlencoded'
   ); 
```

最近，我还在下面附加的 curl 实用程序类中工作，以帮助测试某些表单，希望这会有所帮助：

```
<?php

define('CURLMANAGER_USERAGENT_MOZ4', 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)');
/**
 * 
 * Makes remote calls via http protocol
 * @author Alejandro Soto Gonzalez
 *
 */
class CURLManager {
    private $fields = array();
    private $headers = false;
    private $method = '';
    private $url = '';
    private $response = '';
    private $header = false;

    /**
     * 
     * Constructor
     * @return void
     */
    public function __construct() {

    }

    /**
     * 
     * Executes the http request
     * 
     * @param string $useragent Request user agent
     * @param string $fields Post values to be sent in the request body
     * @param array $headers Request headers
     * @param string $method Http method POST, GET, etc..
     * @param string $url Remote url
     * @param boolean $header true if the response should contain the http headers and  false if not
     * @return void
     */
    public function executeRequest($useragent, $fields, $headers, $method = 'POST', $url, $header = false) {
        $this->fields = $fields;
        $this->method = $method;
        $this->url = $url;
        $this->headers = $headers;
        $this->header = $header;
        $this->initializeCURL($useragent);
    }

    /**
     * 
     * Gets the response retrieved from the http request
     * @return void
     */
    public function getResponse() {
        return $this->response;
    }

    /**
     * 
     * Initializes curl and executes the request
     * @param string $useragent Request user agent
     * @return void
     */
    private function initializeCURL($useragent) {
        $ch = curl_init($this->url);
        $this->addFieldsToRequestBody($ch, $this->method);
        $this->addGenericOptions($ch, $useragent);
        $this->showResponseHeaders($ch, $this->header);
        $this->addRequestHeaders($ch, $this->headers);
        $this->response = curl_exec($ch);
        curl_close($ch);
    }

    /**
     * 
     * Adds generics options to the current curl object
     * @param curlObject $ch
     * @param string $useragent Request user agent
     * @return void
     */
    private function addGenericOptions($ch, $useragent) {
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
        curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
        curl_setopt($ch, CURLOPT_COOKIEFILE, '/var/www/sourceforge/bouncer-logger-tester/cookies.txt');
    }

    /**
     * 
     * Adds the data fields to request body
     * @param curlObject $ch
     * @param string $method Http method POST, GET, etc..
     * @return void
     */
    private function addFieldsToRequestBody($ch, $method) {
        if ($this->method=='POST') {
            curl_setopt($ch, $this->getCurlMethod(), true);
            curl_setopt($ch, $this->getCurlFieldsMethod(), $this->fields);
        }
    }

    /**
     * 
     * Adds headers to the current request
     * @param curlObject $ch
     * @param array $headers Array containing the http header
     */
    private function addRequestHeaders($ch, $headers) {
        var_dump($headers);
        if ($headers !== false) {
            curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
        }
    }

    /**
     * 
     * Gets the curl method id
     * @return integer
     */
    private function getCurlMethod() {
        switch ($this->method)  {
            case 'POST': return CURLOPT_POST;
            default: return CURLOPT_POST;
        }
    }

    /**
     * 
     * Show response headers in the full text response
     * @param curlObject $ch
     * @param boolean $show True to show headers and false to not
     * @return void
     */
    private function showResponseHeaders($ch, $show) {
        if ($this->header) {
            curl_setopt($ch, CURLOPT_HEADER, 1);
        }
    }

    /**
     * 
     * Gets curl fields option
     * @return void
     */
    private function getCurlFieldsMethod() {
        switch ($this->method)  {
            case 'POST': return CURLOPT_POSTFIELDS;
            default: return CURLOPT_POSTFIELDS;
        }
    }
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:20:08.717

[curl_setopt](http://es.php.net/manual/en/function.curl-setopt.php)手册页中解释了这些选项。提供的信息`CURLOPT_POSTFIELDS`是这样的：

> 在 HTTP“POST”操作中发布的完整数据。要发布文件，请在文件名前加上 @ 并使用完整路径。文件类型可以通过使用格式为“;type=mimetype”的文件名来明确指定。**此参数可以作为 urlencoded 字符串（如 'para1=val1¶2=val2&...'）或作为字段名称作为键和字段数据作为值的数组传递。如果 value 是一个数组，则 Content-Type 标头将设置为 multipart/form-data。**从 PHP 5.2.0 开始，如果文件以 @ 前缀传递给此选项，则 value 必须是数组。

所以我猜不是这样：

```
CURLOPT_POSTFIELDS =>'jsonData='.$jsonData, 
```

...你想要这样的东西：

```
CURLOPT_POSTFIELDS => array('jsonData' => $jsonData), 
```