# StackOverflow 问答 12273000-12273999

# jsp - JSP 页面 javax.el.PropertyNotFoundException

> ID：12273015
> 
> 赞同：1
> 
> 时间：2012-09-05T00:25:58.347
> 
> 标签：jsp, properties, javabeans, propertynotfoundexception

我的视图模型如下所示：

```
public class HomePageViewModel {
    private List<AlertViewModel> alertViewModels;
    public List<AlertViewModel> getAlertViewModels() { 
        return alertViewModels;
    }
    public void setAlertViewModels(List<AlertViewModel> alertViewModels) {
        this.alertViewModels = alertViewModels;
    }

    public HomePageViewModel(){
        alertViewModels = new ArrayList<AlertViewModel>();
    }
} 
```

AlertViewModel 看起来像这样：

```
public class AlertViewModel {
    private String id;
    public String getId(){
        return id;
    }
    public void setId(String id){
        this.id = id;
    }

    public AlertViewModel(){
        id = "";
    }
} 
```

JSP 看起来像这样：（viewModel 是一个 HomePageViewModel）

```
<table border="1">
    <tr>
    <th>Id</th>
    </tr>

    <c:forEach items="${viewModel.AlertViewModels}" var="alert">
      <tr>
      <td>${alert.Id}</td>
      </tr>
    </c:forEach>    
</table> 
```

但我得到这个错误：

```
HTTP ERROR 500

Problem accessing /. Reason:

Could not find property AlertViewModels in class viewmodels.HomePageViewModel
Caused by:

javax.el.PropertyNotFoundException: Could not find property AlertViewModels in class viewmodels.HomePageViewModel 
```

我究竟做错了什么？我认为我的获取/设置正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T00:29:08.977

吸气剂名称是`getAlertViewModels()`，因此您应该引用`alertViewModels`（小写 A）。

# jquery-mobile - jQuery Mobile - 1.7.1 的 .on('pageinit')

> ID：12273016
> 
> 赞同：0
> 
> 时间：2012-09-05T00:26:13.793
> 
> 标签：jquery-mobile

因此，我使用以下代码为我的各种 JQM 页面初始化动态内容，但是 pageinit 显然是用于 JQM 页面初始化的最佳方法，但它本身并没有清理干净。

例如）我有一个动态页脚。它打印今天的日期。在我的初始化代码中，我有以下内容：

```
 $(document).on('pageinit', '#dashboardPage', function() {

      var currentTime = new Date()
      var month = currentTime.getMonth() + 1
      var day = currentTime.getDate()
      var year = currentTime.getFullYear()
      var fullDate = month + "-" + day + "-" + year;

      $('#footer').append('<p>  Today: ' + fullDate + '</p>');

    }); 
```

**问题：**每次我离开并返回此页面时，pageinit 都会再次触发并向我的页面添加另一个页脚。清理是我的工作吗？JQM 不应该知道不要一次又一次地触发 pageinit 吗？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T12:11:31.070

恕我直言，OP的真正问题是每次返回页面时都会触发pageinit。这似乎发生在 ajax 加载的页面上，但不适用于链中的“第一个”页面：

```
Page one --(ajax)-->Page two--(ajax)-->Page three--(ajax)-->Back to page two 
```

在此序列中，每次返回第二页时都会触发第二页的 pageinit。

我试图通过指定来避免这种行为`data-dom-cache="true"`，但它没有帮助。恕我直言，这是 JQM 框架中的一个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T06:06:38.500

一起删除和追加怎么样？

```
 $('#footer').remove('p').append('<p>  Today: ' + fullDate + '</p>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T14:19:17.183

您应该创建一个专用于日期的跨度并仅更新此内容，例如通过添加`<p> Today: <span id="dateSpan"></span></p>`到您的页脚，并稍微修改您的代码

```
$(document).on('pageinit', '#dashboardPage', function() {

  var currentTime = new Date()
  var month = currentTime.getMonth() + 1
  var day = currentTime.getDate()
  var year = currentTime.getFullYear()
  var fullDate = month + "-" + day + "-" + year;

  $('#dateSpan').html(fullDate);

}); 
```

# java - 面向对象的 Java。尝试实现抽象方法时出错

> ID：12273018
> 
> 赞同：3
> 
> 时间：2012-09-05T00:26:52.313
> 
> 标签：java, oop, polymorphism

所以，这是我的抽象类的一部分：

```
abstract public void insert(Object obj); 
```

这是扩展它的类中的实现：

```
public void insert(User u){
    try{
        String sql = "INSERT INTO " + TABLE + " (username, assword) VALUES ("+u.getUsername()+", " +u.getPassword()+")";
        conn.execSQL(sql);
    }catch(Exception e){
        System.out.println(e.getMessage());
    }finally{
        conn.close();
    }
} 
```

这是错误：

*类型---必须实现继承的抽象方法---.insert(Object) userDAO.java*

基本上，它对我说，我没有实现任何称为“插入”并接收对象作为参数的方法。我的模型“用户”不算作一个对象吗？我在这里做错了什么？

感谢您的关注。

Ps.：开发 Android 应用程序时 Eclipse 上的错误消息（我不知道它是否改变了任何东西）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T00:28:41.843

查看方法签名，

```
void insert(Object obj); 
```

和

```
void insert(User u) 
```

不一样，所以你没有履行合同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T00:31:22.797

*方法签名必须完全*匹配。这包括方法名（ok）、返回类型（ok）和参数类型（not ok）。

`User`必须继承自没关系`Object`，它们都明确需要是相同的类型。想一想 - 否则有人可以用`Object`不是 a来调用您的方法`User`，那么子类将无法知道如何处理该参数。

如果您只想让某人使用`User`对象调用您的方法，而使用任何其他类型调用它会出错，您可以执行以下操作：

```
public void insert(Object o) {
    if(o instanceof User) {
        //Normal behaviour
    }
    else {
        throw new RuntimeException("Object must be of type user!");
    }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T00:35:59.300

显然方法签名是*不*一样的——抽象方法采用`Object`，但实现采用`User`。

但是，如果您想实现这样的模式，请尝试泛型：

```
public abstract class MyAbstractClass<T> {

    abstract public void insert(T t);

}

public class MyImpl extends MyAbstractClass<User> {

    public void insert(User t) {
        // compiles OK
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T00:38:53.877

您的方法签名不正确，基本方法和派生方法采用不同的对象。让我试着解释一下：

假设您有一个类 Base，它在其方法之一（例如 m1）中采用另一个类 B1 的实例。还假设您有一个派生类 Derived1，它使用参数 D1*覆盖*Base 中的方法 (m1)，类似地，还有一个派生类 Derived2，它使用参数 D2 覆盖基本方法。

D1 和 D2 都实现/扩展 B1。由于以下情况，这将是一个问题：

```
Base baseObj = new Derived1();
baseObj.m1(new D2()); // Should work if it is allowed to override a method in your way! 
```

上面的代码片段失败是因为 Derived1 中的 m1 方法需要一个 D1 类型的参数，但它得到了 D2。你现在明白为什么不允许这种类型的参数转换了吗？

注意：在基类中重写方法时使用 @override 注释是一种很好的做法（来自 Java 1.5 规范）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T00:31:53.467

覆盖方法必须有标题`public void insert(Object obj)`（例如：尝试覆盖`equals`类的方法）。您始终可以在方法主体中转换您的论点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-05T00:33:42.160

那是因为您的抽象方法 insert 有一个 Object 类型的参数，归结为 java.lang.Object 并且您实现该方法的尝试具有作为参数提供的 User 类型。您的抽象方法应使用泛型类型

# javascript - 在 Rails 3 中，放置 .js.erb 文件的位置

> ID：12273022
> 
> 赞同：3
> 
> 时间：2012-09-05T00:27:02.030
> 
> 标签：javascript, ruby-on-rails-3, erb

如果它们是 .erb 的一部分，即 foo.js.erb，我有一些更容易和更清晰的 javascript。我应该把这些文件放在哪里？如果我将相关行放在 .html.erb 文件中，我可以看到我的代码运行良好，但这可能不是一个好主意。换句话说，这不是一个好主意：

```
<script>
  $(function() {
    $('#reports').bind('show', function(e) {
      if ($(e.target).attr('id') == 'reports-navlist')
        $.ajax({
          url: '<%= program_reports_path(@program) -%>',
          data: { toggle: "tab" }, 
          success: function(html){
            $("div#report-html-content").html(html);
          }
        })
    });
  });
</script>

<div class="container">
  <div class="row">
    <div class="span2">
      <ul class="nav nav-pills nav-stacked" id="reports">
        <li>
          <a href="#" data-toggle="pill">Trend lines for all questions</a>
        </li>
        <li>
          <a href="#" data-toggle="pill" id="reports-navlist">Summart of all queries</a>
        </li> 
        <li class="active">
          <a href="#" data-toggle="pill">Trend lines for all questions</a>
        </li>
        <li>
          <a href="#" data-toggle="pill">Details on all questions</a>
        </li>
      </ul>
    </div>
    <div class="span10" id="report-html-content">
    </div>
  </div>
</div> 
```

这里的最佳做法是什么？谢谢！

# slimdx - SlimDX DirectX10 多重采样不起作用

> ID：12273025
> 
> 赞同：2
> 
> 时间：2012-09-05T00:27:29.897
> 
> 标签：slimdx, directx-10, multisampling

我正在 DirectX10 中设置我的 SlimDX 项目，但我无法让多重采样工作。这是我的设备初始化：

```
 // Create swap chain description
    DXGI.SwapChainDescription swapChainDesc = new DXGI.SwapChainDescription()
    {
        BufferCount = 1,
        Usage = DXGI.Usage.RenderTargetOutput,
        OutputHandle = Window.Handle,
        IsWindowed = true,
        ModeDescription = new DXGI.ModeDescription(0, 0, new Rational(60, 1), DXGI.Format.R8G8B8A8_UNorm),
        SampleDescription = new DXGI.SampleDescription(2, 0),
        Flags = DXGI.SwapChainFlags.AllowModeSwitch,
        SwapEffect = DXGI.SwapEffect.Discard
    };

    // Get device
    DX10.Device.CreateWithSwapChain(null, DX10.DriverType.Hardware, DX10.DeviceCreationFlags.None, swapChainDesc, out Device, out SwapChain);

    // Get back buffer
    using (DX10.Texture2D texture = DX10.Resource.FromSwapChain<DX10.Texture2D>(SwapChain, 0))
        BackBuffer = new DX10.RenderTargetView(Device, texture);

    // Set viewport
    var viewport = new DX10.Viewport(0, 0, Window.ClientSize.Width, Window.ClientSize.Height);
    Device.OutputMerger.SetTargets(BackBuffer);
    Device.Rasterizer.SetViewports(viewport);

    // Disable alt+enter
    using (var factory = SwapChain.GetParent<DXGI.Factory>())
        factory.SetWindowAssociation(Window.Handle, DXGI.WindowAssociationFlags.IgnoreAll);

    // Create depth buffer description
    DX10.Texture2DDescription depthDesc = new DX10.Texture2DDescription
    {
        Width = Window.ClientSize.Width,
        Height = Window.ClientSize.Height,
        MipLevels = 1,
        ArraySize = 1,
        Format = DXGI.Format.D24_UNorm_S8_UInt,
        SampleDescription = new DXGI.SampleDescription(1, 0),
        Usage = DX10.ResourceUsage.Default,
        BindFlags = DX10.BindFlags.DepthStencil,
        CpuAccessFlags = DX10.CpuAccessFlags.None,
        OptionFlags = DX10.ResourceOptionFlags.None
    };

    // Get depth buffer
    DX10.Texture2D depthStencilBuffer = new DX10.Texture2D(Device, depthDesc);
    DX10.DepthStencilView depthStencilView = new DX10.DepthStencilView(Device, depthStencilBuffer);
    depthStencilBuffer.Dispose(); 
```

我正在渲染一个简单的盒子。我也查了

```
Device.CheckMultisampleQualityLevels(DXGI.Format.R8G8B8A8_UNorm, 4) 
```

有 1、2、4、8 和 16 个样本。每次该函数返回 1。但是，当我将 1 放入 SwapChainDescription SampleDescription Quality 时，设备创建会抛出错误：

```
E_INVALIDARG：向返回函数传递了一个无效参数 (-2147024809)
```

我基本上只能将 0 用于质量计数。然而，在我的笔记本上，我可以选择不同的质量级别，但多重采样在那里也不起作用，而且 PC 和笔记本显卡都支持多重采样。

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T15:51:00.790

好的，现在似乎是一个菜鸟问题......我只是忘记初始化光栅化器：

```
SlimDX.Direct3D10.RasterizerStateDescription rasteriserDesc = new SlimDX.Direct3D10.RasterizerStateDescription()
{
    CullMode = SlimDX.Direct3D10.CullMode.Back,
    DepthBias = 0,
    DepthBiasClamp = 0,
    FillMode = SlimDX.Direct3D10.FillMode.Solid,
    IsAntialiasedLineEnabled = true,
    IsDepthClipEnabled = true,
    IsFrontCounterclockwise = false,
    IsMultisampleEnabled = true,
    IsScissorEnabled = false,
    SlopeScaledDepthBias = 0
};

Device.Rasterizer.State = SlimDX.Direct3D10.RasterizerState.FromDescription(device, rasteriserDesc); 
```

Now the Multisampling is working as it should.

# android - 清除地图叠加层

> ID：12273031
> 
> 赞同：0
> 
> 时间：2012-09-05T00:28:12.293
> 
> 标签：android, android-mapview

我在活动级别定义了一个名为 ArrowOverlays 的列表变量。我有以下方法可以在谷歌地图视图周围移动箭头......

```
 private void moveTheArrow(GeoPoint whereTo)
{
    if (ArrowOverlays.isEmpty() == false)
    {
        ArrowOverlays.clear();  //this gets a NullPointer exception
    }
    myMapView.getOverlays().clear();  //this works but clears all overlays
    ArrowOverlays = myMapView.getOverlays(); 
    Drawable drawable = getResources().getDrawable(R.drawable.arrow); 
    myItemizedOverlay itemizedoverlay = new myItemizedOverlay(drawable, PSContext);

    GeoPoint point = whereTo;
    OverlayItem overlayitem = new OverlayItem(point, "string1", "string2");

    itemizedoverlay.addOverlay(overlayitem);

    ArrowOverlays.add(itemizedoverlay);     

} 
```

除了这个之外，我在地图视图上还有其他几个叠加层。我想要做的是使用 ArrowOverlays.Clear() 指令清除 ArrowOverlays，但它会出现空指针异常。我不知道为什么会这样。MapView.GetOverlays().Clear() 工作正常，但它会清除地图上的所有叠加层。如何仅清除 ArrowOverllays 集合？谢谢，院长

# android - 在弧中心绘制位图？

> ID：12273040
> 
> 赞同：3
> 
> 时间：2012-09-05T00:29:23.030
> 
> 标签：android, android-canvas

在我的自定义视图中，我像这样绘制了多个填充`Arc`的 s：

```
canvas.drawArc(oval, startAngle, sweepAngle, true, sectorPaint); 
```

现在，我想在圆弧的中心画一个图标。我从这个开始：

```
Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.my_icon);
canvas.drawBitmap(bitmap, pointX, pointY, null); //pointX & pointY ?? 
```

但是，我不知道我应该为`pointX`and设置什么`pointY`。这是我拥有的数据：

*   椭圆中心坐标和半径。
*   startAngle 和 sweepAngle（因此可以导出 endAngle）

有没有办法知道这些值`pointX`并`pointY`给出这些输入？

* * *

编辑：插图草图：

![在此处输入图像描述](../Images/a511c90df955990e9c42d85c388c91d0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T08:47:43.890

[经过一些调整后，这个答案](https://stackoverflow.com/a/12280941/543711)对我帮助很大：

```
double radius = width/2;
double x = radius + (radius)*Math.cos(-angle);
double y = radius + (radius)*Math.sin(-angle); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-09T18:46:11.210

使用你的变量。

试试这个：

```
double x = C.x + r * Math.cos(theta * Math.PI / 180);
double y = C.y + r * Math.sin(theta * Math.PI / 180); 
```

-`theta`的端角在哪里`arc``start angle of arc`

# c++ - 在 C++ 中在图像周围填充黑色边框的最有效方法

> ID：12273047
> 
> 赞同：2
> 
> 时间：2012-09-05T00:30:04.140
> 
> 标签：c++, image, image-processing

我有一个 RGB 图像，这样：

```
Img[3*(row*imgWidth+column)+0], //R
Img[3*(row*imgWidth+column)+1], //G
Img[3*(row*imgWidth+column)+2]  //B 
```

表示每个 RGB 的每个像素的强度值。什么是在图像周围填充 0（0-255 比例）边框的干净方法？边框可以调整为任意宽度。

我唯一能想到的就是手动插入行和列，这变成了一段非常冗长的代码。

对不起，但图书馆不是我在这里寻找的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T00:49:03.577

您还没有提到该平台，但如果您使用的是 x86，[英特尔的集成性能基元 (IPP)](http://software.intel.com/en-us/intel-ipp)库，特别是其图像处理库，将在所选颜色的图像周围添加边框，或者在现有图像上就地，或作为复制、调整大小或其他几个操作的一部分。这是非常高效的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T01:26:53.470

这是我能想到的最易读的方式，这也是相当有效的。假设您有一个尺寸`Width`为、、和`Height`的所需边距的图像。分配一个用零填充的缓冲区。在 C++ 中，您可以使用一种方便的构造函数：`Left``Right``Top``Bottom``Width + Left + Right``Height + Top + Bottom``std::vector`

```
const auto Channels = 3;

const auto TargetWidth = Width + Left + Right;
const auto TargetHeight = Height + Top + Bottom;

std::vector<uint8_t> target(TargetWidth * TargetHeight * Channels); 
```

C 函数`calloc()`也是一个选项。接下来，将源图像中的每一行复制到目标图像，从垂直偏移量`Top`和水平偏移量开始`Left`。用于`std::copy()`复制行，并以行优先顺序运行外部循环以避免缓存未命中：

```
for (int y = 0; y < Height; ++y) {
    const auto* const source_row = &source[y * Width * Channels];
    auto* const target_row = &target[(y + Top) * TargetWidth * Channels + Left];
    std::copy(source_row, source_row + Width * Channels, target_row);
} 
```

如果您可以使用 32 位 RGB0 或 RGBA 而不是 24 位 RGB，您可能会看到更快的复制，这要归功于更一致的对齐方式，`std::copy()`或者`memcpy()`已经得到了很好的优化。如果您可以使用[OpenMP](https://computing.llnl.gov/tutorials/openMP/)，您还可以尝试并行化循环：

```
#pragma omp parallel for
for (int y = 0; y < Height; ++y) {
    // ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T02:01:32.983

如果您已经在使用图像处理库（Intel Performance Primitives、ImageMagick、Windows 等），请查找已经执行此操作的现有函数。如果作者不厌其烦地使用 MMX 或 SSE 指令，库的实现可能会更快。

如果做不到这一点，您可以使用类似于 Ed S. 的解决方案自行开发。这是一个草图。可以进行额外的微优化，例如将 memset 调用的数量减半。

```
unsigned char* padWithBlack(const unsigned char* in,
                            int inWidth, int inHeight,
                            int thickness)
{
    unsigned char* out = malloc((inWidth + thickness * 2) *
                                (inHeight + thickness * 2) * 3);

    // top border
    int topOrBottomOutBytes = (inWidth + thickness * 2) * thickness * 3;
    memset(out, 0, topOrBottomOutBytes);

    // middle section
    unsigned char* inRow  = in;
    unsigned char* outRow = out + topOrBottomOutBytes;
    for (int inY = 0; inY < inHeight; inY++) {
        // left border
        memset(outRow, 0, thickness * 3);
        outRow += thickness * 3;
        // center section
        memcpy(outRow, inRow, inWidth * 3);
        outRow += inWidth * 3;
        inRow  += inWidth * 3;
        // right border
        memset(outRow, 0, thickness * 3);
        outRow += thickness * 3;
    }

    // bottom border
    memset(out, 0, topOrBottomOutBytes);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T00:37:20.797

你看过任何预先构建的图像处理库吗？我过去使用过[ImageMagick](http://www.imagemagick.org/script/index.php) - 这不是最容易安装的东西，但一旦你让它工作，它可以做很多事情。包括[你想要](http://www.imagemagick.org/Usage/crop/#border)的。

如果你真的需要让你的程序进行图像处理，它是开源的。虽然我们说的是“超过 400,000 行 C 代码”，但如果可以避免的话，您可能希望避免接触它。

希望有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T01:47:32.787

一种考虑是生成的图像必须大于源图像，除非边框覆盖了原始图像。后一种情况只涉及覆盖有问题的像素，但是“更大的输出”情况将需要首先为新图像分配空间。一旦分配了新的（可能通过一些生成适当标题的库），您需要逐行 memcopy 旧的（以解决差距），使用复制矩形样本的快速 api，如 bitblt ，或使用本质上相同的库。该方法将取决于图像格式本身；简单的`bits[width*height-1] = {0};`位图等格式将与逐行 memcpy 或 bit blt 一起使用，但像 pngs 这样的压缩格式可能需要一个可以解释数据结构的库。如果您的环境已经有这些库（例如 MSVS 或 Qt），您也可以使用它。但如果这不是一个选项，您可以只使用其他海报推荐的第三方库。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-05T00:39:01.920

所以...我不会建议将库用于如此简单的事情。如果你以后需要进行更高级的操作肯定会考虑它，但是画一个边框？没门。

这是我周围的一些代码。它在给定位置绘制一个黑色矩形。如果您愿意，您可以轻松地将其更改为仅在边缘着色。请注意，它假定图像为 24 bpp。

```
void WriteDebugImage( const unsigned char* inImageBuf, int inImageWidth, int inImageHeight, int left, int top, int right, int bottom, unsigned char* outImage )
{   
    // copy the old image into the new one
    memcpy( outImage, inImageBuf, inImageWidth * inImageHeight * 3 );
    for( int x = left; x <= right; ++x )
    {
        outImage[3 * top * inImageWidth + 3 * x]     = 0;    //Top Edge
        outImage[3 * top * inImageWidth + 3 * x + 1] = 0;    //Top Edge
        outImage[3 * top * inImageWidth + 3 * x + 2] = 0;    //Top Edge

        outImage[3 * bottom * inImageWidth + 3 * x]     = 0; //Bottom Edge
        outImage[3 * bottom * inImageWidth + 3 * x + 1] = 0; //Bottom Edge
        outImage[3 * bottom * inImageWidth + 3 * x + 2] = 0; //Bottom Edge
    }

    for (int y = top; y <= bottom; ++y)
    {
        outImage[3 * y * inImageWidth + 3 * left]     = 0;  //Left Edge
        outImage[3 * y * inImageWidth + 3 * left + 1] = 0;  //Left Edge
        outImage[3 * y * inImageWidth + 3 * left + 2] = 0;  //Left Edge

        outImage[3 * y * inImageWidth + 3 * right]     = 0;  //Right Edge
        outImage[3 * y * inImageWidth + 3 * right + 1] = 0;  //Right Edge
        outImage[3 * y * inImageWidth + 3 * right + 2] = 0;  //Right Edge
    }
} 
```

# android - ksoap2 序列化错误“RuntimeException：无法序列化”

> ID：12273049
> 
> 赞同：1
> 
> 时间：2012-09-05T00:30:47.810
> 
> 标签：android, android-ksoap2

我正在尝试使用 android 应用程序调用 Web 服务。所有网络操作都在扩展 AsyncTask 类的单独类中完成。

```
package com.webservicedemo1;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.PropertyInfo;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;
import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class WebServiceDemoActivity extends Activity

{
/** Called when the activity is first created. */

private static String SOAP_ACTION1 = "http://tempuri.org/FahrenheitToCelsius";
private static String SOAP_ACTION2 = "http://tempuri.org/CelsiusToFahrenheit";
private static String NAMESPACE = "http://tempuri.org/";
private static String METHOD_NAME1 = "FahrenheitToCelsius";
private static String METHOD_NAME2 = "CelsiusToFahrenheit";
private static String URL = "http://www.w3schools.com/webservices/tempconvert.asmx?WSDL";

Button btnFar, btnCel, btnClear;

EditText txtFar, txtCel;

@Override
public void onCreate(Bundle savedInstanceState)

{

    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_web_service_demo);

    btnFar = (Button) findViewById(R.id.button1);

    btnCel = (Button) findViewById(R.id.button2);

    btnClear = (Button) findViewById(R.id.button3);

    txtFar = (EditText) findViewById(R.id.editText1);

    txtCel = (EditText) findViewById(R.id.editText2);

    btnFar.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v)

        {

            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME1);
            request.addProperty("Fahrenheit", txtFar.getText().toString());
            BackGround bg = new BackGround();
            bg.execute(request);
            //request.getP
        }

    });

    btnCel.setOnClickListener(new View.OnClickListener()

    {

        @Override
        public void onClick(View v) {

            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME2);
            request.addProperty("Celsius", txtCel.getText().toString());
            BackGround bg = new BackGround();
            bg.execute(request);

        }

    });

    btnClear.setOnClickListener(new View.OnClickListener()

    {

        @Override
        public void onClick(View v)

        {
            txtCel.setText("");
            txtFar.setText("");

        }

    });

}

private class BackGround extends AsyncTask<SoapObject, Object, SoapObject> {
    SoapObject result = null;

    @Override
    protected SoapObject doInBackground(SoapObject... req) {
        // TODO Auto-generated method stub
        // Initialize soap request + add parameters

        // Declare the version of the SOAP request
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
                SoapEnvelope.VER11);

        envelope.setOutputSoapObject(req);

        envelope.dotNet = true;

        try {

            PropertyInfo pi = new PropertyInfo();

            req[0].getPropertyInfo(0, pi);
            String type=pi.getName();

            HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
            if(type.equals("Fahrenheit")){
            // this is the actual part that will call the webservice
            androidHttpTransport.call(SOAP_ACTION1, envelope);
            }
            else if(type.equals("Celsius")){
                androidHttpTransport.call(SOAP_ACTION2, envelope);
            }
            // Get the SoapResult from the envelope body.
            result = (SoapObject) envelope.bodyIn;

        } catch (Exception e) {
            // TODO: handle exception
            e.printStackTrace();
        }
        return result;

    }

    @Override
    protected void onPostExecute(SoapObject res) {
        // TODO Auto-generated method stub
        super.onPostExecute(res);
        if (res != null) {

            // Get the first property and change the label text
            txtFar.setText(res.getProperty(0).toString());

        }

        else {

            Toast.makeText(getApplicationContext(), "No Response",
                    Toast.LENGTH_LONG).show();

        }
    }

}

} 
```

但我收到以下错误。

```
08-27 17:48:42.980: W/System.err(1014): java.lang.RuntimeException: Cannot serialize:      [Lorg.ksoap2.serialization.SoapObject;@412102b0
08-27 17:48:42.980: W/System.err(1014):     at   org.ksoap2.serialization.SoapSerializationEnvelope.writeElement(SoapSerializationEnvelope.java:708)
08-27 17:48:42.980: W/System.err(1014):     at org.ksoap2.serialization.SoapSerializationEnvelope.writeBody(SoapSerializationEnvelope.java:618)
08-27 17:48:42.990: W/System.err(1014):     at org.ksoap2.SoapEnvelope.write(SoapEnvelope.java:198)
08-27 17:48:42.990: W/System.err(1014):     at org.ksoap2.transport.Transport.createRequestData(Transport.java:111)
08-27 17:48:42.990: W/System.err(1014):     at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:119)
08-27 17:48:42.990: W/System.err(1014):     at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:95)
08-27 17:48:42.990: W/System.err(1014):     at com.webservicedemo1.WebServiceDemoActivity$BackGround.doInBackground(WebServiceDemoActivity.java:128)
08-27 17:48:42.990: W/System.err(1014):     at com.webservicedemo1.WebServiceDemoActivity$BackGround.doInBackground(WebServiceDemoActivity.java:1)
08-27 17:48:43.000: W/System.err(1014):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
08-27 17:48:43.000: W/System.err(1014):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-27 17:48:43.000: W/System.err(1014):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-27 17:48:43.000: W/System.err(1014):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
08-27 17:48:43.000: W/System.err(1014):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-27 17:48:43.000: W/System.err(1014):     at >java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-27 17:48:43.000: W/System.err(1014):     at java.lang.Thread.run(Thread.java:856) 
```

无法找出为什么会发生这种情况。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T06:43:15.960

我想您需要更改一行代码

```
envelope.setOutputSoapObject(req); 
```

至

```
envelope.setOutputSoapObject(req[0]); 
```

* * *

阅读有关 AsyncTask[的更多信息：开发人员站点](http://developer.android.com/reference/android/os/AsyncTask.html)

# java - 什么是最好的 3D java 渲染器？

> ID：12273051
> 
> 赞同：2
> 
> 时间：2012-09-05T00:31:03.783
> 
> 标签：java, 3d

我需要一个易于学习和现代风格的 3D 渲染引擎（不像 java3d）。我试过 lwjgl 和 jmonkeyengine 但我发现它们真的很混乱。还有什么好的引擎？

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:36:27.630

没有 3D 渲染器是容易的。不管你选择哪一个，你都会有很多东西要学。

您可能已经找到了最好的两个：

*   LWJGL 基本上是一个相当薄的 OpenGL 包装器。很多游戏开发者都喜欢使用 OpenGL，所以如果你在那个阵营中，它是一个不错的选择。如果您想要速度和控制，请使用它，并且不介意自己构建一些“引擎”部件。
*   jMonkeyEngine 是一个比较完善的游戏引擎。如果您想快速启动并运行完整的 3D 引擎，请使用它。它在下面使用 LWJGL，但在其顶部添加了图层（如场景图），因此您无需直接使用 OpenGL。

在你的情况下，我可能会选择 jMonkeyEngine - 我认为它有点“友好”。

或者，还有[Slick2D](http://slick.cokeandcode.com/)，如果您决定不想与 3D 的学习曲线搏斗，它非常适合制作 2D 游戏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T00:36:18.133

就 3D 库而言，JMonkeyEngine 实际上很容易学习，如果你正确地遵循它 - 你将很难找到一个更简单的功能齐全的 3D 引擎。

首先阅读场景图，正确理解它们对于理解 JME 的工作原理至关重要 - 然后尝试遵循一些[基本教程](http://jmonkeyengine.org/wiki/doku.php/jme3%3abeginner)（其中有很多）。

如果您仍然对此感到困惑，那么您可能需要更加熟悉 Java（或编程）。如果您想从 2D 游戏开始并开始工作，您可能想尝试一下[Greenfoot - 它提供了一个简单的 IDE/框架，用于在 Java 中创建和共享 2D 游戏。](http://greenfoot.org)

哦，我同意远离 Java3D——它现在已经很老了，而且很不支持。

# msdeploy - 整个包是否上传到 MsDeploy.axd？

> ID：12273055
> 
> 赞同：8
> 
> 时间：2012-09-05T00:31:45.717
> 
> 标签：msdeploy

任何人都可以确认（最好带有文档链接）是否在文件同步之前完整上传了 MSDeploy 包，还是在 msdeploy.exe 和 msdeploy.axd 之间发生同步（只上传修改过的文件）？

或者，换一种说法，如果我有一个 1GB 包 zip，其中仅包含 1MB 的更改文件，msdeploy 会将整个 1GB 包上传到 MsDeploy.axd 并在服务器上执行同步，*或者*它只会上传 1MB 的更改的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:13:40.777

该文档是否足够正式，足以让您相信您观察到的行为是确定性的？

[http://www.iis.net/learn/publish/using-web-deploy/introduction-to-web-deploy](http://www.iis.net/learn/publish/using-web-deploy/introduction-to-web-deploy)

“Web Deploy 与 FTP 相比如何？”部分，第 1 点：

> Web 部署比 FTP 快。Web 部署不会为每个操作发出不同的命令。相反，它会在同步开始时进行比较，并且只传输更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T18:01:15.710

这是微软员工对类似问题的回答：[http ://forums.asp.net/post/4361026.aspx](http://forums.asp.net/post/4361026.aspx)

此外，这是一个非常有用的文章，详细说明了包的组装过程：http: [//blog.winhost.com/using-msdeploy-to-publish-your-site/](http://blog.winhost.com/using-msdeploy-to-publish-your-site/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-16T12:07:29.333

由于很难让 MSDeploy 通过代理运行，因此我通过简单地使用一个大文件 (750MB) 使该过程更加明显。

对于代理服务 ( `http://localhost:80/MsDeployAgentService`)，我可以确认它**不会**上传整个包。如果我从服务器（本地主机）中删除文件，部署需要大约 25 秒。一旦文件已经存在，部署几乎是即时的。鉴于我的机器规格，当时它无法将 750mb 传输到内存中（更不用说通过 HTTP 传输了）。

**更新**我也可以在部署到远程（尽管相同的网络）`MsDeploy.axd`服务时确认相同的行为。初始部署时间为 50 秒，下一次部署时间小于 1 秒。

**IIS 团队的更新 2** Kristina Olson 在[她的评论](https://stackoverflow.com/a/12439782/3603)中证实了这一点：

> Web Deploy 分两部分进行增量同步，因此在第一部分中它仅发送有关包中文件内容的元数据以确定哪些文件实际需要更新，因此在第二部分中只有那些增量更新文件通过线路发送。基本上每个文件的元数据（如名称、大小、写入时间）都是通过网络发送的，但实际文件内容不是，除非文件需要更新

# gmp - GMP条件

> ID：12273056
> 
> 赞同：2
> 
> 时间：2012-09-05T00:31:53.213
> 
> 标签：gmp

我正在使用 libgmp 创建一个简单的程序。我可以 gmp_printf 所有 gmp 整数，所以我知道它们已正确初始化和分配。当我尝试一个简单的 if-else 条件时，就会出现问题。

```
mpz_t n;
mpz_t c;
mpz_t m;

mpz_init(n);
mpz_init(c);
mpz_init(m); 

mpz_set_str(c, "2", 10);
mpz_set_str(n, "2038074744", 10);

mpz_mod(m, n, c);

gmp_printf("\n%Zd\n%Zd\n%Zd\n", n, c, m);

if(m == 0)
{
printf("number is even\n");
}
else
{
printf("number is odd\n");
} 
```

实际数字打印为 0，但始终显示 else printf。

```
2038074744
2
0
number is odd 
```

有什么方法可以让这个工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T19:04:43.847

你不能直接比较，`m`因为`m`是（粗略地说）一个指针。您需要使用 GMP 中包含的比较功能。见[http://gmplib.org/manual/Integer-Comparisons.html#Integer-Comparisons](http://gmplib.org/manual/Integer-Comparisons.html#Integer-Comparisons)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T07:27:27.893

使用`mpz_cmp`代替`m == 0`：

```
if(mpz_cmp(m,0)  == 0)
    printf("number is even\n");
else
    printf("number is odd\n"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-18T01:29:19.713

答案“*你不能直接与 m 比较，因为 m 是（粗略地说）一个指针*”几乎是正确的，它`m`是一种`mpz_t`类型，它是一个定义在中的结构`gmp.h`：

```
typedef struct
{
  int _mp_alloc;
  int _mp_size;
  mp_limb_t *_mp_d;  /* Pointer to the limbs.  */
} __mpz_struct;

typedef __mpz_struct mpz_t[1]; 
```

但是您应该使用`mpz_cmp_ui(m,0UL)`or `mpz_cmp_si(m,0L)`，而*不是*`mpz_cmp`其他答案中建议的，因为它`m`与前面解释的零指针进行比较。

# database - 实体框架 - 查询远程数据库时性能不佳

> ID：12273058
> 
> 赞同：2
> 
> 时间：2012-09-05T00:32:15.483
> 
> 标签：database, performance, entity-framework

我为我们的新项目评估了几种 .NET 数据库访问技术，并发现使用 Entity Framework 查询远程数据库时性能不佳。Entity Framework 比 LinqToSql 或 SqlClient 慢 10 倍。也许你可以帮我解释或解决这个问题？

测试参数：

数据库：

*   SQL Server 2008 企业版
*   一张有 1000 条记录的表
*   表结构：

    ```
    [dbo].[Master](
           [Id] [int] IDENTITY(1,1) NOT NULL,
           [Value_Bit] [bit] NOT NULL,
           [Value_Float] [float] NOT NULL,
           [Value_DateTime] [datetime2](7) NOT NULL,
           [Value_Uniqueidentifier] [uniqueidentifier] NOT NULL,
           [Value_NVarchar100] [nvarchar](100) NOT NULL,
           [Value_NVarchar1000] [nvarchar](1000) NOT NULL,
           [InsertDate] [datetime] NOT NULL,
           [UpdateDate] [datetime] NOT NULL,
           [Version] [timestamp] NOT NULL) 
    ```

基准应用：

*   .NET 框架 4 和 4.5
*   作为 WinForms 应用程序托管

数据库访问技术：

*   实体框架 5.0 (RC) 和 4.3.1
*   LinqToSQL
*   SqlClient

计算机（客户端/服务器）：

*   三台具有相似硬件的不同计算机
*   A 和 B 在同一个子网中（例如 192.168.1.1 和 192.168.1.2）
*   C 与 A 和 B 在不同的子网中（例如 192.168.2.1）

`select * from Master`我在作为客户端或服务器的不同计算机上直接使用每种数据库访问技术执行 sql 查询。平均时间是 1000 次迭代的结果。

测试场景一：

*   客户：A
*   服务器：A

*   实体框架：平均时间：17 毫秒

*   LinqToSQL：平均时间：20 毫秒
*   SqlClient：平均时间：15 毫秒

测试场景二：

*   客户：A
*   服务器：B

*   实体框架：平均时间：144 毫秒

*   LinqToSQL：平均时间：141 毫秒
*   SqlClient：平均时间：140 毫秒

测试场景 3：

*   客户：A
*   服务器：C

*   实体框架：平均时间：2145 毫秒

*   LinqToSQL：平均时间：151 毫秒
*   SqlClient：平均时间：156 毫秒

测试场景4：

*   客户：乙
*   服务器：C

*   实体框架：平均时间：2060 毫秒

*   LinqToSQL：平均时间：141 毫秒
*   SqlClient：平均时间：178 毫秒

为什么测试场景 3 和 4 中的实体框架比 LinqToSQL 或 SqlClient 慢 10 倍？

我在 Entity Framework 4.3.1、5 (RC) 和 .NET Framework 4 和 4.5 下对其进行了测试，每次都得到相同的结果。我禁用了延迟加载和跟踪，使用编译查询和预生成视图，但没有区别。

我使用 SQL Profiler 调查执行的 SQL 查询，发现实体框架的查询在 SQL Server 中已经花费了两秒钟（测试场景 3）。如果我从计算机 A 上的 Management Studio 执行查询，只需要 100 毫秒。

我使用 dotTrace (http://www.jetbrains.com) 分析了我的基准应用程序，发现大部分执行时间都被方法消耗掉了`ToList`。如果我深入调用堆栈，我会看到该方法`System.Data.SqlClient.SqlDataReader.GetString(Int32)`，最后`SNINativeMethodWrapper.SNIReadSyncOverAsync(SafeHandle, IntPtr&, Int32)`会一直消耗。LinqToSql 也使用了 SqlClient，调用栈几乎一样，但是执行时间快了 10 倍。

我不知道引擎盖下发生了什么。也许它与计算机名称解析有关，但我可以通过 IP 地址及其计算机名称 ping 计算机 C。有没有人可以解释或建议如何加快执行速度？

提前致谢

马蒂亚斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T12:09:56.570

如果没有看到您的代码，很难给出任何明智的猜测，但是您可以大致了解 EF 的一些典型内容。

*   [通常，您可以使用Compiled Queries](http://msdn.microsoft.com/en-us/library/bb896297.aspx)显着加快处理速度。

*   在查看代码时，EF 查询的延迟执行可能是一个不明显的陷阱。

一个常见的错误是执行返回 IEnumerable 或 IQueryable 集合的查询，然后在循环中使用它：

```
// Execution will be deferred:
IEnumerable<person> peopleList = objectContext.People.Where(item => item.ID > 100);
foreach (person somePerson in peopleList)
{
  // do something here
} 
```

此代码将对数据库执行很多次往返，这可能会导致严重的性能问题。由于延迟执行和延迟加载，这将导致人员列表**中每个项目**的代码再次查询数据库。根据通过网络传输的数据量，仅此一项就可能严重损害性能。

您可以通过简单地在集合上调用 ToList() 方法来减少这种开销。这仅在一次往返中获取所有结果对象：

```
// Execution will be deferred:
List<person> peopleList = objectContext.People.Where(item => item.ID > 100)
                                              .ToList(); // Fetch objects NOW! 
```

MSDN 提供了一篇文章，其中包含一些建议，[Performance Considerations (Entity Framework)](http://msdn.microsoft.com/en-us/library/cc853327.aspx)：

> **提高性能的策略** 您可以通过使用以下策略来提高实体框架中查询的整体性能。
> 
> **预生成视图**
> 
> 在应用程序第一次执行查询时，基于实体模型生成视图是一笔巨大的开销。使用 EdmGen.exe 实用程序将视图预生成为可在设计期间添加到项目的 Visual Basic 或 C# 代码文件。您还可以使用文本模板转换工具包生成预编译视图。预生成的视图在运行时进行验证，以确保它们与指定实体模型的当前版本一致。有关更多信息，请参阅如何：预生成视图以提高查询性能（实体框架）和在实体框架中使用预编译/预生成的视图隔离性能 4\. 使用非常大的模型时，适用以下注意事项：. NET 元数据格式将给定二进制文件中的用户字符串字符数限制为 16 个，777,215 (0xFFFFFF)。如果您正在为一个非常大的模型生成视图并且视图文件达到此大小限制，您将得到“没有剩余逻辑空间来创建更多用户字符串”。编译错误。此大小限制适用于所有托管二进制文件。有关更多信息，请参阅演示如何在使用大型复杂模型时避免错误的博客。
> 
> **考虑对查询使用 NoTracking 合并选项**
> 
> 在对象上下文中跟踪返回的对象需要成本。检测对象的更改并确保对同一逻辑实体的多个请求返回同一对象实例需要将对象附加到 ObjectContext 实例。如果您不打算对对象进行更新或删除并且不需要身份管理，请考虑在执行查询时使用 NoTracking 合并选项。
> 
> **返回正确的数据量**
> 
> 在某些情况下，使用 Include 方法指定查询路径要快得多，因为它需要更少的数据库往返。但是，在其他情况下，额外往返数据库以加载相关对象可能会更快，因为具有较少连接的更简单查询会导致数据冗余较少。因此，我们建议您测试各种检索相关对象的方法的性能。有关更多信息，请参阅塑造查询结果（实体框架）。为避免在单个查询中返回过多数据，请考虑将查询结果分页到更易于管理的组中。有关更多信息，请参阅如何：浏览查询结果（实体框架）。
> 
> **限制 ObjectContext 的范围**
> 
> 在大多数情况下，您应该在 using 语句中创建一个 ObjectContext 实例（Visual Basic 中的 Using...End Using）。这可以通过确保在代码退出语句块时自动释放与对象上下文关联的资源来提高性能。但是，当控件绑定到由对象上下文管理的对象时，只要需要绑定并手动处理，就应该维护 ObjectContext 实例。有关详细信息，请参阅管理对象服务中的资源（实体框架）。
> 
> **考虑手动打开数据库连接**
> 
> 当您的应用程序执行一系列对象查询或频繁调用 SaveChanges 以持续对数据源进行创建、更新和删除操作时，实体框架必须不断打开和关闭与数据源的连接。在这些情况下，请考虑在这些操作开始时手动打开连接，并在操作完成时关闭或释放连接。有关更多信息，请参阅在实体框架中管理连接和事务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T11:44:00.890

问题分别巨大的时间间隔突然消失了。有人告诉我管理员更改了网络上的某些内容，因此我推断这与此有关，因为我没有更改测试参数的任何内容。

不幸的是，我不知道他们发生了什么变化，我猜我永远也无法找到答案。非常令人失望，因为我知道我不知道原因是什么。

谢谢你。

# hibernate - 将 grails 版本从 1.3.8 升级到 2.0.4 的 Hibernate 配置问题

> ID：12273059
> 
> 赞同：0
> 
> 时间：2012-09-05T00:32:15.623
> 
> 标签：hibernate, grails

我正在尝试将 grails 应用程序从 1.3.8 版本升级到 2.0.4

在处理了编译错误以处理更改的库等之后 - 我将它带到了它尝试启动的位置 - 但是它到达了它尝试配置休眠并且挂起的位置。这是来自 1.3.8 的日志部分：

> 2012-09-04 16:27:33,806 [main] INFO hibernate.ConfigurableLocalSessionFactoryBean - 构建新的 Hibernate SessionFactory 2012-09-04 16:27:33,941 [main] WARN config.ConfigurationFactory - 找不到配置。从类路径中的 ehcache-failsafe.xml 配置 ehcache：jar:file:/Users/userX/.ivy2/cache/net.sf.ehcache/ehcache-core/jars/ehcache-core-1.7.1.jar!/ ehcache-failsafe.xml 2012-09-04 16:27:34,718 [main] WARN hibernate.EhCacheProvider - 找不到名为 [common.SecRole] 的缓存的特定 ehcache 配置；使用默认值。2012-09-04 16:27:45,504 [main] WARN hibernate.EhCacheProvider - 找不到名为 [org.hibernate.cache.UpdateTimestampsCache] 的缓存的特定 ehcache 配置；使用默认值。2012-09-04 16:27:45,505 [主要] 警告休眠。EhCacheProvider - 找不到名为 [org.hibernate.cache.StandardQueryCache] 的缓存的特定 ehcache 配置；使用默认值。

从 2.0.4 中的非工作部分：

> 2012-09-04 17:16:49,488 [pool-4-thread-1] 信息 hibernate.ConfigurableLocalSessionFactoryBean - 构建新的 Hibernate SessionFactory 2012-09-04 17:16:49,619 [pool-4-thread-1] 警告配置。 ConfigurationFactory - 未找到配置。从类路径中的 ehcache-failsafe.xml 配置 ehcache：jar:file:/Users/userX/.grails/ivy-cache/net.sf.ehcache/ehcache-core/jars/ehcache-core-2.4.6.jar !/ehcache-failsafe.xml 2012-09-04 17:16:51,175 [pool-4-thread-1] 警告 hibernate.AbstractEhcacheRegionFactory - 找不到名为 [common.SecRole] 的缓存的特定 ehcache 配置；使用默认值。

有什么我想念的想法吗？它似乎只是在为 Hibernate 配置缓存。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T21:55:59.043

其中一个域对象在静态映射中有一个索引，它正在数据库中重新生成。由于表很大，重新生成索引需要很长时间 - 在此期间应用程序似乎只是挂起。

# c# - 试图将复选框控件的 Tag(String) 获取到新表单按钮单击

> ID：12273064
> 
> 赞同：0
> 
> 时间：2012-09-05T00:33:42.003
> 
> 标签：c#, winforms

我是 C# 和一般编程的新手，在春季开始上课之前尝试学习/练习一下。无论如何，我正在尝试将复选框控件的标签从表单 A 到表单 B 放入 FormB 上的文本框中（使用字符串生成器，因为文本框中还有其他信息也将进入 FormB 文本框）现在我可以让它正常工作表单 B 加载，但由于我的程序如何流动，我需要在单击按钮时实现这一点。以下是处理 FormB 加载的当前代码。抱歉，如果我在这里遗漏了一些基本的东西。

表格 B. 我省略了一些我的字符串生成器行以获得空间。

```
 public CodeBlueForm(List<string> ids, string custNameCb, string custWtnCb, string custCbrCb, string custNotesCb)
    {
        InitializeComponent();

        cbNameText.Text = custNameCb;
        cbWtnText.Text = custWtnCb;
        cbCbrText.Text = custCbrCb;
        cbNotesText.Text = custNotesCb;
        string checkBoxesLines = "Lights: ";
        foreach (string id in ids)
            checkBoxesLines += string.Format("{0}, ", id);
                System.Text.StringBuilder strBuilder = new System.Text.StringBuilder();
            strBuilder.AppendLine("Inet Notes: " + "\r" + ((checkBoxesLines) + cbNotesText.Text));

            cbViewText.Text = strBuilder.ToString();
        { 
```

我目前的表格 A

```
private void code_blue_link_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
    {
        var checkBoxIds = GetCheckBoxIds();

        tShootCb = tShootText.Text;
        svcsOfferedCb = svcsOfferedText.Text;
        otherNotesCb = otherNotesText.Text;
        custModemCb = custModemText.Text;
        //Opens CODE BLUE form and pushes text to it.
        CodeBlueForm cbForm = new CodeBlueForm(checkBoxIds, custNameText.Text, custCbrText.Text, custBtnText.Text, custModemCb + "\r\n" + tShootCb + "\r\n" + svcsOfferedCb + "\r\n" + otherNotesCb);

        cbForm.Show();

    }
    private List<string> GetCheckBoxIds()
    {
        List<string> checkBoxIds = new List<string>();
        foreach (Control control in pnlCheckBoxes.Controls)
        {
            if (control is CheckBox)
            {
                CheckBox checkBox = (CheckBox)control;

                if (checkBox.Checked && checkBox.Tag is string)
                    checkBoxIds.Add((string)checkBox.Tag);
            }
        }
        return checkBoxIds; 
```

正如我所说，这目前确实适用于 Form B 加载，但我需要弄清楚如何使其在 FormB 按钮单击中工作。这方面的任何方向都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:46:44.123

您可以在创建时将 FormA 的句柄传递给 FormB。然后可以使用该句柄在 FormB 中访问 FormA 上的所有项目。

```
public class FormA : Form
{
    public FormA()
    {
        InitializeComponent();
    }

    public void buttonClick(object sender, EventArgs e)
    {
        FormB formB = new FormB(this);
        formB.Show();
    }
} 
```

和

```
public class FormB : Form
{
    private FormA parent;

    public FormB(FormA parent)
    {
        InitializeComponent();
        this.parent = parent;
    }

    public void buttonClick(object sender, EventArgs e)
    {
        myTextBox.Text = parent.myCheckBox.Text;
    }
} 
```

在此示例中，您在 FormA 上调用了一个复选框`myCheckBox`，在 FormB 上调用了一个文本框`myTextBox`，每个表单上都有一个按钮。每个按钮都有一个`buttonClick`注册到点击事件的方法。FormA 上的按钮创建并显示 FormB 的一个实例，并将一个句柄传递给它自己 ( `this`)。然后，FormB 上的按钮可以使用句柄（`parent`在本例中调用）来访问 FormA 上的所有控件，如果您通过将属性更改为**IFF**使它们可以访问的话。（这不是一个好方法，但为了简单起见，我建议*现在这样做*`Modifiers``public`*. 一旦你理解了依赖关系，你应该继续创建公共 getter/setter 方法来准确封装应该更改的内容，而不是暴露整个控件。）*

# c# - 使用 Web 服务进行“超时”操作的最佳方式？

> ID：12273067
> 
> 赞同：0
> 
> 时间：2012-09-05T00:34:07.787
> 
> 标签：c#, web-services, timeout

我有一些 Web 服务将被 Web 应用程序用来从数据库中获取数据并写入数据库。有些操作一次只能由一个用户执行，因此数据库会跟踪是否有人在执行其中一项操作，如果是这样，则不会让其他人执行这些操作。我想实施超时。因此，如果用户锁定的时间超过 10 分钟，那么他们就会超时并且他们的锁定会被撤销。

想到的唯一方法是让服务/应用程序在服务器上运行，具有某种提升的权限，或者直接从数据库中删除锁，或者使用只有它有权访问的 Web 服务来删除说锁。不过，这对我来说似乎有点 hacky，所以我想我会问 SO 社区是否有更好/更清洁/更常见的方法可以实现这一点。

# javascript - 检查 id 标签中的文本并将类添加到另一个标签

> ID：12273069
> 
> 赞同：0
> 
> 时间：2012-09-05T00:34:26.120
> 
> 标签：javascript, jquery, sharepoint, sharepoint-2010

根据 id=section-name 中的文本，我有不同的页面需要不同的横幅图像。我想使用 Javascript 或 jQuery 检查页面使用的部分名称，然后将 CSS 类添加到横幅容器 ID。

这适用于 SharePoint 2010 网站，并将添加到母版页。

每个`aspx`页面显示以下`<div>`标签，并且部分名称正在动态写入页面。

```
<div id="section-name">*Section name goes here*</div> 
```

例如：`<div id="section-name">Toll Stadium</div>`

然后我在页面下方有一个`<div id="banner-container"></div>`标签。

我需要做的是`<div id="banner-container"></div>`根据部分名称添加一个类。

例如：

*   如果 section-name 等于 Toll Stadium，则添加 class banner-toll - `<div id="banner-container" class="banner-toll"></div>`；或者
*   如果 section-name 等于 Whats On，则添加 class banner-whatson - `<div id="banner-container" class="banner-whatson"></div>`；或者
*   如果 section-name 等于 Christmas Festival，则添加 class banner-xmas -`<div id="banner-container" class="banner-xmas"></div>`
*   等等等等

我根本不知道如何编写 javascript 或 jquery。但是，我确实在其他地方找到了一些代码，到目前为止我有以下代码。唯一的问题是每个页面都使用 case 0 类（banner-xmas）。

```
$(function() {
$('.container')
    .find('#banner-container').each(function(i) {
        switch(i) {
            case 0: 
                $(this).addClass('banner-xmas');
                break;
            case 1: 
                $(this).addClass('banner-whatson');
                break;
            case 2: 
                $(this).addClass('banner-toll');
                break;
            case 3: 
                $(this).addClass('banner-forum');
                break;
            case 4: 
                $(this).addClass('banner-esf');
                break;
            case 5: 
                $(this).addClass('banner-xmas');
                break;
            case 6: 
                $(this).addClass('banner-plan');
                break;
            case 7: 
                $(this).addClass('banner-contact');
                break;
        }
    }); 
```

我也尝试了以下方法，但这也不起作用：

```
var objSectionElement = document.getElementById('section-name')
if (objSectionElement != undefined) {
var objSection = objSectionElement.innerHTML.trim();
var objBody = document.body;
if (objSection != undefined && objBody != undefined) {
    if (objSection.startsWith('Default')) {
        objBody.className = objBody.className + " .banner-general";
    }
    else if (objSection.startsWith('What')) {
        objBody.className = objBody.className + " .banner-whatson";
    }
    else if (objSection.startsWith('Toll')) {
        objBody.className = objBody.className + " .banner-toll";
    }
    else if (objSection.startsWith('Forum')) {
        objBody.className = objBody.className + " .banner-forum";
    }
    else if (objSection.startsWith('Endless')) {
        objBody.className = objBody.className + " .banner-esf";
    }
    else if (objSection.startsWith('Christmas')) {
        objBody.className = objBody.className + " .banner-xmas";
    }
    else if (objSection.startsWith('Plan')) {
        objBody.className = objBody.className + " .banner-plan";
    }
    else if (objSection.startsWith('Contact')) {
        objBody.className = objBody.className + " .banner-contact";
    }
} 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T00:52:34.913

这似乎是应该在服务器上完成的事情，但是必须在客户端上完成，考虑如下：

```
function addClassBasedOnSection() {
  var classNames = {
    'Default':'banner-general',
    'What':'banner-whatson',
    'Toll':'banner-toll',
    'Forum':'banner-forum',
    'Endless':'banner-esf',
    'Christmas':'banner-xmas',
    'Plan':'banner-plan',
    'Contact':'banner-contact'
  };
  var sectionEl, sectionName, div;
  div = document.getElementById('banner-container');
  sectionEl = document.getElementById('section-name');

  if (sectionEl && div) {
    sectionName = sectionEl.textContent || sectionEl.innerText;
    div.className += ' ' + (classNames[sectionName] || '');
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T00:57:20.373

```
$(function(){
    //we pass through a reference to the text within the section name.
    addClassToBanner($('#section-name').text());
});

/*
 * This function needs to be outside of the .ready() scope
 */
function addClassToBanner(txt){
    //avoid assignment issues, create empty variable
    var bannerClass = '';
    switch(txt){
        case 'Toll Stadium':
            bannerClass = 'banner-toll';
            break;
        default:
            bannerClass = 'banner-default';
            break;
    }  
    $('#banner-container').addClass(bannerClass);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T00:55:53.073

我会做这样的事情。

```
<div id="section-name">Toll</div>

$(function(){
    var sectionName = document.getElementById("section-name").innerHTML;
    switch(sectionName) {
        case "xmas":
            $('#banner-container').addClass('banner-xmas');
            break;
        case "whatson":
            $('#banner-container').addClass('banner-whatson');
            break;
        case "toll":
            $('#banner-container').addClass('banner-toll');
            break;
    }

}); 
```

# c - 当您在 EditBox 中键入一个字符时 - MessagBox c 创建该字符

> ID：12273071
> 
> 赞同：0
> 
> 时间：2012-09-05T00:34:39.737
> 
> 标签：c, winapi

当您在 EditBox 中键入一个字符时 - MessagBox c 创建该字符。他无法理解-我将不胜感激。 [代码在这里](http://pastie.org/4665420)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:49:43.247

你必须抓住任何一个

**EN_CHANGE**：当用户采取了可能改变了编辑控件中的文本的操作时发送。与 EN_UPDATE 通知代码不同，此通知代码在系统更新屏幕后发送。

或者

**EN_UPDATE**：在编辑控件即将重绘自身时发送。此通知代码在控件格式化文本之后但在显示文本之前发送。这样可以在必要时调整编辑控制窗口的大小。

顺便说一句：您的编辑控件的父窗口通过 WM_COMMAND 消息接收此通知代码。

# iphone - 从 iPhone 应用程序转换为通用应用程序

> ID：12273072
> 
> 赞同：0
> 
> 时间：2012-09-05T00:34:43.777
> 
> 标签：iphone, objective-c, xcode, ipad

我为 iPhone 制作了一个应用程序，现在我想让它通用，以便能够在 iPad 上全屏运行。

该应用程序大小为 40MB，并显示捆绑包中存储的许多图像。它们的尺寸适合 iPhone 屏幕。管理此问题的最佳方法是什么？

如果我为 iPad 添加更大的图像，应用程序会非常大。我可以为 iPad 内容制作一个源文件夹，为 iPhone 内容制作一个源文件夹，然后在客户购买应用程序时下载正确的一个吗？我对这一切有点困惑，我的搜索并没有导致任何结果。

我还读到我可以为 iPhone 和 iPad 故事板场景使用相同的类 (.h/.m)。那么对于 iPad 不同的代码呢，如何管理呢？那可能是什么样的代码？我对此有点困惑，一些指导会很棒。

我使用带有故事板的 Xcode 4，该应用程序非常基础，只有一些带有按钮、文本字段、图像和标签以及一些操作表的 UITableView 和 UIView，仅此而已......还有一个 .plist 来管理数据。

到目前为止，我刚刚将目标更改为“通用”并为 iPad 添加了一个故事板文件，并在开始做某事之前等待一些基本指南。希望你能理解我的问题。谢谢。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T00:41:42.970

> 如果我为 iPad 添加更大的图像，应用程序会很大

它会，但它是易于管理的，您将在捆绑包中包含两个设备的所有图像，只需尝试尽可能地压缩它们而不会扭曲它们。

**注意：**减少应用程序消耗的存储量的一个非常好的策略是尽可能平铺背景图像……尤其是在 iPad Retina 上。

> 那么对于 iPad 不同的代码呢，如何管理呢？那可能是什么样的代码？我对此有点困惑，一些指导会很棒。

```
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
    //do something for iPad
}else{
    //do something for iPhone/iPod Touch
} 
```

这就是您可以分离只应在特定设备类型上运行的代码的方法。您不必在所有事情上都使用它，或多或少只是与对象尺寸或只能在特定设备上使用的对象有关的任何事情（例如：）`UIPopOverController`。

两个用户界面习惯用法是：`UIUserInterfaceIdiomPad` &`UIUserInterfaceIdiomPhone`

此外，这是您应该使用的图像命名方案：

*   ImageName.png - 适用于 iPhone/iPod
*   ImageName@2x.png - 适用于 iPhone/iPod 视网膜
*   ImageName~ipad.png -- 适用于 iPad
*   ImageName@2x~ipad.png -- 适用于 iPad 视网膜

如果所有这些图像都正确命名，这将大大简化您在应用程序中使用图像的方式。

```
UIImage *myImage = [UIImage imageNamed:@"ImageName"]; 
```

仅使用“ImageName”iOS 将根据设备类型和分辨率自动使用正确的图像。

# java - jsoup 检查链接是否存在

> ID：12273075
> 
> 赞同：0
> 
> 时间：2012-09-05T00:35:07.820
> 
> 标签：java, jsoup

我想检查链接是否存在，如果确实获得主页。

```
Document document = Jsoup.connect(link).get(); 
```

有时我得到的问题是：

```
Exception in thread "main" java.nio.charset.UnsupportedCharsetException: X-MAC-ROMAN
    at java.nio.charset.Charset.forName(Unknown Source)
    at org.jsoup.helper.DataUtil.parseByteData(DataUtil.java:86)
    at org.jsoup.helper.HttpConnection$Response.parse(HttpConnection.java:469)
    at org.jsoup.helper.HttpConnection.get(HttpConnection.java:147) 
```

我得到了balu回答的相关问题：

```
Document doc = Jsoup.parse(new URL(link).openStream(), "ISO-8859-1", link); 
```

当 char 编码不同时应使用。

但是在我想做页面验证的情况下，我怎样才能让它工作。

我将从用户那里获得链接：

比我尝试

```
Document document = Jsoup.connect(link).get(); 
```

当 char 编码不是默认值时，它会给出异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T11:04:54.237

为什么你不使用`Jsoup.parse(...)`呢？如果您的链接不存在，这将抛出一个`UnknownHostException`，否则它将返回您的`Document`.

但是，您可以`connect()`在 try/catch 块中使用，如果`UnsupportedCharsetException`抛出 an，您可以`parse()`在 catch 块中调用 - 方法。

# jquery - 如果首先单击任何列表项，请执行此操作，否则执行此操作

> ID：12273080
> 
> 赞同：3
> 
> 时间：2012-09-05T00:35:39.580
> 
> 标签：jquery, click

所以我有一个无序列的链接列表，我需要说“如果第一次点击这些链接中的任何一个，请执行此操作，否则执行此操作”，我并不是指列表中的任何单个链接，如果只是其中一个单击这些项目，即所有项目的第一次单击。

```
$('.idTabs li a').one("click", function() {
    do this;
}); 
```

这有效，但仅适用于列表中的每个单独链接。它将在单击 list-item-1 时起作用并且不会再次出现，如果我单击 list-item-2 它会执行一次并且不会再次出现。我需要的是单击 list-item-1 并让它不再出现在任何其他 list-item-# 中。

进一步了解背景：我有一个列表导航，当您单击一个项目时，它会展开隐藏的子导航，单击第一个项目后，子导航出现，并且在它出现后 - 单击任何其他父项打开它相应的子导航，如选项卡。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T00:39:16.303

你可以[`.data()`](http://api.jquery.com/jQuery.data/)用来存储一个布尔值，与无序列表相关联，指示它是否是第一次点击：

```
$('.idTabs li a').on("click", function() {
  var $idTabs = $(".idTabs");
  var clicked = $idTabs.data("clicked");
  if (!clicked) { // first click
    $idTabs.data("clicked", true);
    console.log('First click');
  } else {
    console.log('Not the first click');
  }
});​ 
```

**[演示](http://jsfiddle.net/zPSxq/)**。

# java - Java：如何在写入文件后正确关闭文件（我正在使用 RandomAccessFile）

> ID：12273081
> 
> 赞同：1
> 
> 时间：2012-09-05T00:35:47.960
> 
> 标签：java, file

我的应用程序“加密”文件（业余）......当它通过以下代码时，我无法打开它处理的文件（直到我关闭应用程序）如何正确释放文件？

```
SecureRandom random = new SecureRandom();
// file CAN be used
RandomAccessFile raf = new RandomAccessFile(file, "rw");
// since RandomAccessFile, file can't be used.. it's ok
FileChannel channel = raf.getChannel();
MappedByteBuffer buffer = channel.map(FileChannel.MapMode.READ_WRITE, 0, raf.length());
random.setSeed(key);
byte[] bytes = new byte[(int) raf.length()];
raf.read(bytes);
byte[] randomBytes = new byte[(int) raf.length()];
random.nextBytes(randomBytes);
for (int i = 0; i < bytes.length; i++)
    buffer.put((byte) (bytes[i] + randomBytes[i]));
buffer.force();
channel.close();
raf.close();
// fails to free the file... 
```

# django - 如何在 Django 中即时切换存储位置？

> ID：12273082
> 
> 赞同：1
> 
> 时间：2012-09-05T00:35:51.470
> 
> 标签：django, couchdb, storage

我将 CouchDB 用于我的 DEFAULT_FILE_STORAGE，但我最近获得了另一台服务器，该服务器具有一个单独的 CouchDB 实例，可用于需要长时间存储的重要文件（出于法律原因）。

大多数情况下，我将通过 default_storage 访问文件，但是当我需要访问新服务器中的文件时，如何即时切换到新存储？

我的设置目前看起来像这样：

```
DEFAULT_FILE_STORAGE = 'project_name.files.storage.CouchDBStorage'
COUCHDB_STORAGE_OPTIONS = {
    'server': 'http://mydomain.com:5984', 
    'database': 'storage'
} 
```

要访问当前服务器上的文件，我会这样做：

```
from django.core.files.storage import default_storage

my_file = default_storage.get_document(my_object.file.name) 
```

有没有人有这样的经验？这可能看起来不合常规，但获得第二台服务器超出了我的控制范围。

# php - php中的默认选择下拉菜单

> ID：12273088
> 
> 赞同：-1
> 
> 时间：2012-09-05T00:36:58.660
> 
> 标签：php, mysql

所以我有3个表，2个有数据，1个通过外键连接另外2个。是这样的：

```
student(ID_stud, etc)
specialization(ID_spec,spec_name)
study(ID_stud,ID_spec, etc) 
```

现在我正在使用 Edit.php 菜单（我用列表做了添加菜单），我需要在下拉菜单中使用已经选择的 mysql 值的专业化

这是我到目前为止所做的，但我只选择了正确的值，重复了 n 次

```
<select name="specialization" type="text">
        <?php
        $specialization=$_POST['specialization'];
        $list_spec=mysql_query("SELECT * FROM specialization, study, student WHERE $ID_stud=study.ID_stud and specialization.ID_spec=study.ID_spec ");
        $array_spec=mysql_fetch_array($list_spec);
        while ($array_spec = mysql_fetch_array($list_spec)){?>
        <option selected="<? echo $array_spec['ID_spec'] ?>"><?php echo $array_spec['spec_name'];?></option>
        <?php }?>
        </select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:44:01.723

您只需要设置`selected`所选项目的属性。所有其他人将没有`selected`属性。此属性的值无关紧要。

像这样的东西：

```
<option <? if(isSelected) echo 'selected' ?>><?php echo $array_spec['spec_name'];?></option> 
```

# python - 在 Python 的 Flask 中验证用户会话的全局函数

> ID：12273096
> 
> 赞同：2
> 
> 时间：2012-09-05T00:38:35.630
> 
> 标签：python, flask

每次在我的应用程序中访问页面时，我都希望对用户进行身份验证。

我为我的网络应用程序编写了一个会话处理类。它是这样称呼的：

```
s = Session(request.cookies.get('session_id'))

s.isValid()
>> True #The user is logged in

s.user_id
>> 21 #The ID of the user currently logged in.

u = User(s.user_id) 
```

我想将此逻辑包含在每次访问网页时都会调用的全局文件中。这样，在我的视图处理程序中，我可以检查用户是否已登录并访问基本用户信息。

例如，我想做这样的事情：

```
@app.route('/profile')
def profile():

  if logged:
    render_template('edit-profile.html', 
                     first_name=u.first_name)
  else:
    render_template('profile.html') 
```

这可能吗？代码会去哪里（哪个文件？）它会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T00:45:09.990

你应该做这样的事情......

```
@app.before_request
def before_request():
    try:
        g.user = User.query.filter_by(username=session['username']).first()
    except Exception:
        g.user = None 
```

登录页面将在会话中设置用户名字段。然后在每个页面加载时执行此代码。您可以在所有视图和模板中访问 g.user。

[http://flask.pocoo.org/docs/api/#flask.Flask.before_request](http://flask.pocoo.org/docs/api/#flask.Flask.before_request)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T06:16:59.823

您还可以查看[Flask-Login](http://packages.python.org/Flask-Login/)。也许你会在那里发现一些有趣的东西。

# jquery - PhoneGap + JqueryMobile 点击不适用于 android 模拟器

> ID：12273106
> 
> 赞同：1
> 
> 时间：2012-09-05T00:40:04.597
> 
> 标签：jquery, cordova, jquery-mobile, android-emulator

我在用

```
<link rel="stylesheet" href="css/jquery.mobile-1.1.0.min.css" />
<script type="text/javascript" charset="utf-8" src="js/cordova-1.7.0.js"></script>
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.1.0.min.js"></script> 
```

我可以在使用浏览器测试时单击 div，但如果我在我的 android 模拟器 4.0 中尝试它，它不会显示任何响应。我读到网上资料说 jquery mobile click 应该使用 $(document).live('click',function()..) 而我的代码是

```
<div data-role="content">             
        <p><img level='1' src="css/images/level1.png"/><a id="level" level="1" href="wordlist.html" data-role="button" data-theme="a">Home</a></p>
        <p><img level='2' src="css/images/level2.png"/><a id="level" level="2" href="wordlist.html" data-role="button" data-theme="a">School</a></p>
        <p><img level='3' src="css/images/level3.png"/><a id="level" level="3" href="wordlist.html" data-role="button" data-theme="a">Restaurant</a></p>

</div>

<script type="text/javascript" charset="utf-8">
$('a#level').live('click', function () {
    alert("XX"+ $(this).attr("level"));
    sessionStorage.StudyLevel = $(this).attr("level"); 
});
</script> 
```

我的浏览器中显示了警报，但我的模拟器中没有任何反应。其他在我的模拟器中未执行的滑动和点击事件也是如此。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T06:04:46.830

您是否尝试过使用 class 而不是 id：-

```
<div data-role="content">             
    <p><img level='1' src="css/images/level1.png"/><a id="level1" class='selCls' level="1" class="handler" href="wordlist.html" data-role="button" data-theme="a">Home</a></p>
    <p><img level='2' src="css/images/level2.png"/><a id="level2" class='selCls'  level="2" class="handler" href="wordlist.html" data-role="button" data-theme="a">School</a></p>
    <p><img level='3' src="css/images/level3.png"/><a id="level3" class='selCls'  level="3" class="handler" href="wordlist.html" data-role="button" data-theme="a">Restaurant</a></p> 
```

并且

```
 $('body').on('click', '.selCls', function(e) {
  e.preventDefault();
      e.stopImmediatePropagation();
      alert('clicked');
 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T07:06:32.980

尝试在标头中更改 jquery 文件中的序列，例如

```
<link rel="stylesheet" href="css/jquery.mobile-1.1.0.min.css" />
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/cordova-1.7.0.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.1.0.min.js"></script>
<script>
$(function() {
   $('a#level').bind('click', function(event, ui) {
     //code here.
   });
});
</script> 
```

让我知道这是否有效。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-05T01:09:32.770

根据 phonegap[文档](http://docs.phonegap.com/en/1.7.0/cordova_events_events.md.html#deviceready)，您应该先听此事件：

```
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
    // Now safe to use the Cordova API
    // Put your code here
} 
```

对于事件附件，您可以使用（推荐）jquery [.on()](http://api.jquery.com/on/)

您也有重复的 imgs id，不推荐。您可以使用虚拟类并搜索它，例如：

```
<div data-role="content">             
        <p><img level='1' src="css/images/level1.png"/><a id="level1" level="1" class="handler" href="wordlist.html" data-role="button" data-theme="a">Home</a></p>
        <p><img level='2' src="css/images/level2.png"/><a id="level2" level="2" class="handler" href="wordlist.html" data-role="button" data-theme="a">School</a></p>
        <p><img level='3' src="css/images/level3.png"/><a id="level3" level="3" class="handler" href="wordlist.html" data-role="button" data-theme="a">Restaurant</a></p>

</div>

<script type="text/javascript" charset="utf-8">
$('a.handler').on('click', function () {
    alert("XX"+ $(this).attr("level"));
    sessionStorage.StudyLevel = $(this).attr("level"); 
});
</script> 
```

# c - 获取 C 程序修改的所有内存位置的日志

> ID：12273110
> 
> 赞同：3
> 
> 时间：2012-09-05T00:40:37.637
> 
> 标签：c, debugging, memory, gdb, instrumentation

我需要一个 C 程序在执行期间修改的所有内存位置的日志。这个问题比使用*gdb/valgrind*观察内存区域要复杂一些，因为我没有内存区域的*开始*或*结束*地址。基本上，无论何时何地程序进行内存更新（以*push*、*移动*到内存操作数等的形式），我都需要该内存地址以及写入该地址的值。

有没有人有任何建议或意见？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T00:47:44.377

您可以使用英特尔创建的工具[Pin](http://www.pintool.org/)来监控内存存储、读取、寄存器内容等。这是[麻省理工学院的一个模拟处理器缓存](http://people.csail.mit.edu/rabbah/download/cache-pintools/)（指令和/或数据）的项目。Pin 用于创建详细的指令跟踪，然后将跟踪用作缓存模拟器的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T01:35:27.510

如果您可以在模拟器下运行程序，则可以使用模拟器记录您想要的数据。[您可以在 Wikipedia 上](http://en.wikipedia.org/wiki/Category%3aX86_emulators)找到几个X86 仿真器，包括 Bochs 和 QEMU。

我可以想到一个使用`mprotect()`和`SIGSEGV`处理程序的解决方案：受保护的内存将在您访问它时产生信号。如果处理程序记录地址并重新启用访问，则错误指令将恢复（并成功）。不过，我看不到您如何再次保护该段。

您可以编写自己的调试器（查看`ptrace()`手册页，它并不复杂），它只存在于`PT_STEP`您的程序中。您可能必须解析暂停的指令以确定它是否是内存访问，然后自己计算有效地址（使用 获取任何必要的寄存器`PT_ GETREGS`）。

# java - 我们可以在 Liferay 之外的独立服务中使用 Liferay jar 吗？

> ID：12273115
> 
> 赞同：0
> 
> 时间：2012-09-05T00:41:04.287
> 
> 标签：java, liferay

我们已经使用 liferay 5.2 构建了我们的 portlet，并且在我们的 portlet 中，我们在服务中使用了 TagService。我们现在正计划迁移到 SOA，并将服务移出 liferay 并将它们作为 RESTful 服务部署在单独的服务器中，只有 UI 控制器将保留在 liferay portlet 中，它们将使用 REST 服务。

我们遇到的问题是我们在搜索服务中使用标签服务，因此我们无法将其移出。

一种解决方案是重写标签服务，它将查询 liferay 数据库并为我们的服务获取数据。其他解决方案可能是包含 TagService 的 liferay-impl jars。我不确定这是否可行以及这会变得多么复杂？有没有人做过类似的事情？还是我错过了什么？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T13:22:48.547

为什么不使用 Liferay 网络服务并构建您的 TagServices？以下链接可能对 [访问 Liferay 网络服务有所帮助](http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/Web+services+-+Manage+Users,+Organizations,+User+Groups,+and+Roles+via+SOAP)

和

[使用 Lifeary Web 服务](http://www.liferay.com/web/antonio.junior/blog/-/blogs/12168124)

# java - 内部错误 (javaClasses.cpp:129)

> ID：12273118
> 
> 赞同：11
> 
> 时间：2012-09-05T00:41:08.547
> 
> 标签：java, eclipse, testing, junit

我正在尝试在 Eclipse 上使用 JUnit 4 和 Robolectric 运行测试，但我一直收到此错误：

```
Invalid layout of java.lang.String at value
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  Internal Error (javaClasses.cpp:129), pid=3546, tid=140317899335424
#  fatal error: Invalid layout of preloaded class
#
# JRE version: 7.0_07-b10
# Java VM: Java HotSpot(TM) 64-Bit Server VM (23.3-b01 mixed mode linux-amd64 compressed oops)
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
# 
```

我的测试很简单。它仅用于检查所有工作：

```
@RunWith(RobolectricTestRunner.class)
public class FormatTest {

    @Test
    public void getFormatElapsedTimeOnSecondsTest(){
        assertEquals("3seg","3seg");
    }
} 
```

我的系统上安装的 Java 是：

```
java version "1.7.0_07"
Java(TM) SE Runtime Environment (build 1.7.0_07-b10)
Java HotSpot(TM) 64-Bit Server VM (build 23.3-b01, mixed mode) 
```

我不明白发生了什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-26T18:49:38.323

这可能不是你的问题，但我能够通过使用 Run As -> Android Application 来解决这个问题。

但是，我不确定您是否使用的是android。可能检查运行配置是否存在其他问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-05T17:56:44.497

您需要更正运行配置。

如果你想运行一个 JUnit 测试

```
"right click on test class in the package explorer"->"Run As"->"JUnit Test" 
```

在 android 项目上，您需要将“Android JUnit Test Launcher”设置为启动器。即使您的启动配置具有“JUnit”类型，您也必须使用该 android 启动器。

您可以在以下位置找到它：

```
"right click on test class in the package explorer"->"Properties"->"Run/Debug Settings"->"Edit..." 
```

**示例**：

测试：

```
import junit.framework.TestCase;

public class ExampleTest extends TestCase{
public ExampleTest(String name){
    super(name);
}

protected void setUp() throws Exception{
    super.setUp();
}

protected void tearDown() throws Exception{
    super.tearDown();
}

public void testFoo(){
    fail("Not yet implemented");
} 
```

}

创建运行配置：

```
"Run"->"Run Configurations..."->"Right click on JUnit"->"New"->"Set project and Test class"->"Select Android JUnit Test Launcher"->"Run" 
```

注意：如果您使用的是 x86 jdk，如果您的 Launcher 设置为“Eclipse JUnit Launcher”，您将收到以下错误：

```
 Invalid layout of java.lang.String at value
    #
    # A fatal error has been detected by the Java Runtime Environment:
    #
    #  Internal Error (javaClasses.cpp:129), pid=3844, tid=4828
    #  fatal error: Invalid layout of preloaded class
    #
    # JRE version: 7.0_17-b02
    # Java VM: Java HotSpot(TM) Client VM (23.7-b01 mixed mode windows-x86 )
    # Failed to write core dump. Minidumps are not enabled by default on client versions of Windows 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-04T06:24:54.497

对我来说，解决方案是：**Run -> Run Configurations... ->**在选项卡 Test 单击**Select Preferred Launcher**并选择**Use configuration specific settings** with selection **Android JUnit Test Launcher**。

删除 JUnit 下的所有条目（运行配置对话框的左列；RightMouse - 删除）。

然后**Run as -> JUnit Test**并选择性地选择**Use configuration specific settings with Android JUnit Test Launcher**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-18T00:13:53.050

右键单击带有 main 的 java 类，运行配置，然后转到类路径选项卡，删除那里的 android 库。然后运行。

我希望这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-18T23:09:18.303

It goes easier. Got to Run->Configuration and look for JUnit and Android JUnit Tests. Delete your config if it is there. Then the next time you click on Run it will ask about the configuration. You choose first JUnit and then in the next dialog activate "Use configuration specific settings" and then choose Android JUnit Test Laucher.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T09:06:38.263

我也遇到了同样的问题，原因是我在我的 android 项目中添加了 main(String s[]) 方法。

所以只需从项目中删除 main(String s[]) 方法并作为 Android 应用程序运行。

# ios - 使用 iOS 的 UITableView，如果单元格在图像下载到其中之前已经出列怎么办？

> ID：12273122
> 
> 赞同：4
> 
> 时间：2012-09-05T00:41:47.267
> 
> 标签：ios, uitableview, asihttprequest, sdwebimage

无论使用什么方法：iOS 5 的`[NSURLConnection sendAsynchronousRequest]`,`SDWebImage`或`ASIHTTPRequest`, 如果在下载图像时，单元格 aleady 出列（`dequeueReusableCellWithIdentifier`调用时），因此，新标签现在可能被标记为“Mary”，而 Peter 的正在下载图像，下载完成后，Peter 的图像将填充到 Mary 的框中。

如果之后玛丽的图像也被下载并进入玛丽的牢房并掩盖彼得的照片会更好，但如果

1) Mary 的照片需要 1 或 2 秒才能下载（手机无线网络慢或延迟），还是此时网络阻塞？然后 Peter 的照片将在 Mary 的名字旁边显示 1 或 2 秒或 20 秒，如果这次网络请求失败，甚至永远显示。

2）如果玛丽的数据有“不显示我的照片”标志之类的隐私设置，那将是最糟糕的，那么`cellForRowAtIndexPath`可能实际上在玛丽的中设置了一个虚拟图像（虚拟头像）`imageView`，并且当彼得的图像被下载时，进入玛丽的细胞，永远不会被替换。

这可以优雅地处理或解决吗？

顺便说一句，如果我们使用`SDWebImage`or `ASIHTTPRequest`，问题会在那里还是已经由班级处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:55:20.277

该[`UITableViewCell`方法`-prepareForReuse`](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006938-CH3-SW33)是取消未完成的网络请求、丢弃不需要的缓存以及诸如此类的好机会。

`+[NSURLConnection sendAsynchronousRequest:queue:completionHandler:]`不直接提供取消请求的方法，但是如果您在开始请求之前设置一些属性或 ivar，然后检查完​​成处理程序以确保其当前值与您期望的匹配，您可以获得类似的影响。

# ios - iOS：viewWillDisappear 没有从另一个视图控制器调用 popViewControllerAnimated

> ID：12273123
> 
> 赞同：0
> 
> 时间：2012-09-05T00:41:52.743
> 
> 标签：ios, uiviewcontroller, popviewcontrolleranimated

我对 iOS 开发比较陌生，并且我遇到了弹出视图控制器的问题。`UIViewControllers`按下后退按钮时，我需要从导航堆栈中弹出两个（或更多） 。因为我不希望它们都被动画化，所以我首先弹出除了最后一个未动画的所有内容，然后将最后一个动画弹出，但`-viewWillDisappear`不会只为最后一个被调用。这是我的代码（这些是从 super 调用的`UIViewController`，所有其他代码都是从它扩展而来的）：

```
//popping all but last one - viewWillDisappear getting called for these
[self.navigationController popToViewController:[self.navigationController.viewControllers objectAtIndex:j] animated:NO];
//popping last one - viewWillDisappear not getting called for this one
[self.navigationController popViewControllerAnimated:YES];
//also tried this but with same result:
//[((UIViewController*)[self.navigationController.viewControllers objectAtIndex:j]).navigationController popViewControllerAnimated:YES]; 
```

有人知道我在这里做错了什么，或者你能指导我如何正确地实现我所需要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:44:01.390

viewWillDisappear 在加载新控制器时已被调用。副手我想只有顶级控制器 viewWillDissappear 在做这样的事情时会被调用。

另外，为什么不直接弹出所需的动画视图？

如果您将 nslog 放入视图中，您可能会发现被调用的等量视图将消失。

让我知道你发现了什么。希望有帮助。

# windows - 奇怪的 git 错误

> ID：12273124
> 
> 赞同：3
> 
> 时间：2012-09-05T00:41:56.630
> 
> 标签：windows, git, windows-8, dropbox, msysgit

我想要做的是，获取 Dropbox 项目的本地克隆，进行更改然后推送到该项目。

我的 PC 规格是：Os Win 8 X64，[Git-1.7.11](http://code.google.com/p/msysgit/downloads/list)

我做了以下步骤：

1.  将原始项目文件复制到 Dropbox 文件夹中
2.  在位于本地文件系统，Dropbox 文件夹的项目目录中初始化 git repo
3.  然后通过键入克隆此目录`git clone absolute/path/to/the/folder`
4.  对文件进行了一些更改，只是为了测试，提交..一切顺利
5.  当我尝试通过键入`git push origin master`获取此错误消息来推送此消息时

![在此处输入图像描述](../Images/97ae10bb68d73e2a714a577df5f499fd.png)

原始 TXT 看起来像这样

```
$ git push origin master
Counting objects: 5, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 322 bytes, done.
Total 3 (delta 2), reused 0 (delta 0)
Unpacking objects: 100% (3/3), done.
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare reposit
remote: error: is denied, because it will make the index and work tree incon
ent
remote: error: with what you pushed, and will require 'git reset --hard' to
h
remote: error: the work tree to HEAD.
remote: error:
remote: error: You can set 'receive.denyCurrentBranch' configuration variabl

remote: error: 'ignore' or 'warn' in the remote repository to allow pushing

remote: error: its current branch; however, this is not recommended unless y
remote: error: arranged to update its work tree to match what you pushed in

remote: error: other way.
remote: error:
remote: error: To squelch this message and still keep the default behaviour,

remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse
To F:\Cloud\Dropbox\Web Server\pcand.me
 ! [remote rejected] master -> master (branch is currently checked out)
error: failed to push some refs to 'F:\Cloud\Dropbox\Web Server\pcand.me' 
```

尝试使用清理痕迹完全卸载并重新安装 3 次，执行上述步骤 2-3 次。没有任何帮助

# 我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:00:49.850

通常，推送到非裸存储库不是一个好主意。

我要做的是：

创建一个空目录“/path/to/bare/repository” 输入该目录并执行

```
git init --bare 
```

这将初始化一个可以安全推入的 git 结构。不要将保管箱文件夹中的任何文件放在那里。

创建一个空目录“/path/to/working/folder”

将保管箱文件复制到那里，进入目录并键入以下命令

```
git init
git remote add origin /path/to/bare/repository
git commit -a -m 'Initial commit'
git push origin master 
```

该`git init`命令没有`--bare`参数，因此这将是一个工作文件夹，您可以在其中查看文件。将文件推送到“原始”存储库后，检查裸存储库的内容。你不会在那里找到任何可读文件，只有你的 git 索引。

# php - Wordpress comment_form() 问题

> ID：12273125
> 
> 赞同：1
> 
> 时间：2012-09-05T00:42:14.767
> 
> 标签：php, wordpress

我正在尝试使用 Theme Checker 插件“验证”一个 WP 主题，问题是我收到以下错误：

必需：找不到comment_form。见：comment_form `<?php comment_form(); ?>`

我`<?php comments_template(); ?>`用来生成表单，所以如果我包含`<?php comment_form(); ?>`它，它将复制评论表单的整个输入。

[这](https://github.com/milohuang/reverie/blob/master/comments.php)是我的comments.php

# php - 使用 WPAlchemy 显示多个 TinyMCE 编辑器的问题

> ID：12273132
> 
> 赞同：1
> 
> 时间：2012-09-05T00:43:41.240
> 
> 标签：php, wordpress, tinymce, admin, custom-post-type

我有一个带有 WPAlchemy 管理元框类的自定义帖子类型，包括多个带有 TinyMCE 编辑器的文本区域（用于向自定义帖子模板添加内容）。我已经让编辑器显示和运行良好，但是每个文本区域的左下角都有一个尴尬的 div，带有“路径”和冒号“：”

![在此处输入图像描述](../Images/ea5522764f64ff6ea5461e223ef33f08.png)

如果有人知道如何删除我猜测的编辑器的元信息（字数等），那就太好了，但它在保存时似乎无法正常运行。

这是我检查元素时得到的结果：

```
<div id="temp_options_desc-3_path_row" role="group" aria-labelledby="temp_options_desc-3_path_voice" tabindex="-1">
  <span id="temp_options_desc-3_path_voice">Path</span>
  <span>: </span><span id="temp_options_desc-3_path"></span>
</div> 
```

还有用于显示所见即所得编辑器的 textarea 和 TinyMCE javascript 函数：

函数.php：

```
add_action('admin_print_footer_scripts','admin_print_footer_scripts',99);
function admin_print_footer_scripts()
{
    ?><script type="text/javascript">/* <![CDATA[ */
        jQuery(function($)
        {
            var i=1;
            $('.temp_options_desc').each(function(e)
            {
                var id = $(this).attr('id');

                if (!id)
                {
                    id = 'temp_options_desc-' + i++;
                    $(this).attr('id',id);
                }

                tinyMCE.execCommand('mceAddControl', false, id);

            });
        });
    /* ]]> */</script><?php
} 
```

WPAlchemy 元框类文本区域：

```
<textarea cols="20" rows="20" class="temp_options_desc" name="<?php $mb->the_name(); ?>"><?php $mb->the_value(); ?></textarea> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:38:54.243

我通过 WP Alchemy 在元框中发布了多个 tinyMCE 文本编辑器的解决方案

[http://www.kathyisawesome.com/426/multiple-wordpress-wysiwyg-visual-editors/](http://www.kathyisawesome.com/426/multiple-wordpress-wysiwyg-visual-editors/)

我的代码在 github 上可用： [https ://github.com/helgatheviking/WP-Alchemy-Holy-Grail-Theme](https://github.com/helgatheviking/WP-Alchemy-Holy-Grail-Theme)

但最终你用绿色圈出的问题是 CSS 问题。您的新编辑器缺少一点点样式。我现在不记得了，但我确定我在我的示例主题中修复了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T08:57:00.243

您可以使用 tinymce 设置配置参数并在编辑器初始化时删除该 div

```
tinyMCE.init({
   ...
   setup : function(ed) {
      ed.onInit.add(function(ed, evt) {
          $('#'+ed.id+'_path_row').hide();
      });
   }
}); 
```

# java - 使用 Java 验证 PayPal 的 IPN 通知。如何用特殊字符编码“item_name”参数

> ID：12273134
> 
> 赞同：2
> 
> 时间：2012-09-05T00:44:20.960
> 
> 标签：java, encoding, paypal, paypal-ipn

我构建了一个 IPN 侦听器来验证 PayPal 通知。所有通知都验证良好，当参数 item_name 具有特殊字符时例外。项目名称示例：“Um mes”

我曾尝试在一些字符集中对 url 进行编码，但没有人工作。如果我删除 item_name 的特殊字符，IPN 验证将返回 VALID，但是当只放置一个简单的特殊字符时，我总是得到 INVALID 作为返回。

在执行请求之前我必须使用什么正确的编码？

这是我的代码：` public void verificaIPN(FacesContext fc) throws FalseINPException, IOException { ExternalContext externalContext = fc.getExternalContext(); 迭代器 requestParameterNames = externalContext .getRequestParameterNames();

```
 String requestUrl = Messages.getString("PayPalUtil.paypalURL"); //$NON-NLS-1$
 while (requestParameterNames.hasNext()) {
    String chave = requestParameterNames.next();
    String valor = externalContext.getRequestParameterMap().get(chave);

    //is this below right?
    requestUrl += "&" + chave + "=" + URLEncoder.encode(valor, "UTF-8");
 }

 URL urlConPayPal = new URL(requestUrl);
 URLConnection yc = urlConPayPal.openConnection();
 yc.setDoOutput(true);
 yc.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

 BufferedReader in = new BufferedReader(new InputStreamReader(yc.getInputStream()));
 String inputLine;

 while ((inputLine = in.readLine()) != null) {
    if (inputLine.equals("VERIFIED")) {
    } else {
       throw new FalseINPException("O paypal não confirma esta transação: "
           + inputLine);
    }
 }
 in.close(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:09:52.723

您是否尝试过更改您的帐户编码并仅在您的应用中进行 URL 编码？

所以 PayPal 隐藏了这个链接（不知道为什么）。您实际上无法通过在任何地方（我发现）在您的帐户中导航来访问它。因此，登录您的帐户并单击此：

[https://www.paypal.com/us/cgi-bin/webscr?cmd=_profile-language-encoding](https://www.paypal.com/us/cgi-bin/webscr?cmd=_profile-language-encoding)

点击更多选项

并将您的编码更改为您的语言所需的编码。

这应该为您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-18T14:03:25.570

问题在于您忘记了我们调用中的一个参数。看来您像我一样尝试发送葡萄牙语。:) 你需要：

```
 <INPUT TYPE="hidden" name="charset" value="utf-8"> 
```

（utf-8 或任何你想要的，根据你的编码）。然后你可以有它的名字，比如“Doação”等......

请参阅：[https](https://developer.paypal.com/docs/classic/paypal-payments-standard) : //developer.paypal.com/docs/classic/paypal-payments-standard/integration-guide/formbasics/#id08A6F0RK0PN

# javascript - jAlbum Gallery - 幻灯片无法正确显示

> ID：12273137
> 
> 赞同：1
> 
> 时间：2012-09-05T00:45:41.570
> 
> 标签：javascript, jquery

我正在使用带有 Lightflow 皮肤的[jAlbum](http://jalbum.net/)程序来创建画廊。效果很好，但是当我尝试在笔记本电脑上浏览图库时，图像会慢慢爬升，标题也会消失。我无法在我的桌面上复制此问题，但是，我的屏幕尺寸足够大，以至于最大图像尺寸不会覆盖屏幕尺寸。这仅在 Firefox（多个版本）中发生。在 Chrome 和 IE 中正确显示。此外，Close`X`偏向左侧有点太多（仅在笔记本电脑上的所有浏览器中）。

脚本似乎`top`错误地计算了属性。

这是一段代码：

```
<div id="lightwindow_container" style="height: 469px; width: 532px; left: -266px; top: -235px; display: block; visibility: visible;"> 
```

对于离开页面的照片，如果我更改`top`属性，我可以使其适合页面而不会出现问题。（通过在查看页面时在 Firebug 中更改它。）

这是显示该问题的屏幕截图：

![错误截图](../Images/5f726b4a12c7be911511c11ee1dfc9f0.png)

[这是有问题的页面。](http://www.ubhape2.com/examples/month-1/#align-page)

如何检查这是脚本错误还是只是本地浏览器问题，如果是脚本错误，我该如何解决？

注意：我会添加代码，但是代码太多，它将达到 SO 中允许的最大限制。

# javascript - js上传功能？

> ID：12273142
> 
> 赞同：0
> 
> 时间：2012-09-05T00:46:43.157
> 
> 标签：javascript, upload, chatroom

js中是否有内置函数可以将数据上传到服务器？

我有这个刚刚开始构建的在线聊天，我有文本输入，到目前为止它保存了数据，你可以和自己聊天。我真正想要的是将它上传到服务器以便可以下载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:57:46.643

查看 AJAX，它允许您将数据异步发送到服务器。了解 HTTP 的工作原理会有所帮助（它将帮助您更好地理解它），但这并不是绝对必要的 :)

# c# - WPF 窗口事件处理程序

> ID：12273143
> 
> 赞同：0
> 
> 时间：2012-09-05T00:47:25.620
> 
> 标签：c#, wpf

所以我们知道，如果您附加了一个事件处理程序，如果该对象不再被使用，我们应该在某个时候将其删除。这对 Window 对象有什么作用？

以Window的`Loaded`事件或`Closing`事件为例。如果我们在方法中注册 EventHandler 来处理这些事件`Initialize`，为什么我们不注销它们呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:54:07.720

因为这没什么大不了的。通常您在派生类本身中订阅事件，因此您不会因为杂散事件处理程序订阅而导致实例在内存中逗留。此外，您将需要`Closing`事件处理程序，直到 Window 的生命周期结束，取消订阅它是没有意义的。

# javascript - JavaScript 背景图片

> ID：12273145
> 
> 赞同：1
> 
> 时间：2012-09-05T00:47:30.707
> 
> 标签：javascript, jquery, css, html, background

猜测这对于有专业知识的人来说将是一个非常容易解决的问题。我仍在学习 JavaScript，并且一直在努力学习更多。

我目前有以下代码：

```
<script type="text/javascript">
$(window).load(function() {
$("#background").fullBg();
});
</script> 
```

这工作正常。目前#background是：

```
<img src="images/background.jpg" alt="" id="background" /> 
```

但是我希望能够将背景作为 div 背景而不是图像。

如何更改上面的脚本，以便该函数适用于将在 CSS 中设置的 div 的背景图像，而不是像当前那样指向 img 标签？

我试图在互联网上搜索解决方案；但是我在 JS 方面还不够好，还不能正确地用词来搜索我正在寻找的东西。

如果我的描述很差，请提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T00:52:43.507

如果我理解正确，您正在尝试将 css 属性分配给 DIV。然后你应该使用 .css('propertyName', 'value')。[您可以在jQuery .css()](http://api.jquery.com/css/)找到文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T00:49:59.493

`.css()`是你要找的（这个例子使用 jQuery）

```
<script type="text/javascript">
$(window).load(function() {
    $("#background").css({
        "background-image" : "url(images/background.jpg);",
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T00:54:04.193

您正在使用的插件 ( [fullBg](http://bavotasan.com/2011/full-sizebackground-image-jquery-plugin/) ) 旨在使用 img 元素，而不是背景图像。为什么你甚至需要一个div？如果您按照插件文档的建议使用 CSS 设置 img 样式，结果将是相同的。

# php - localhost 是，但 phpmyadmin 为空白

> ID：12273151
> 
> 赞同：2
> 
> 时间：2012-09-05T00:48:42.930
> 
> 标签：php, mysql, phpmyadmin, wamp

对 localhost 和 phpmyadmin 都有问题的 WAMP 人员加载空白，这通常是端口问题。我的只是 phpmyadmin 空白。sqlbuddy 和 phpinfo 没问题。

试过卸载重装wamp。试过xampp，同样的问题，一切正常，不是phpmyadmin。

mysql日志：

```
120905  8:03:08 [Note] Plugin 'FEDERATED' is disabled.
120905  8:03:08 InnoDB: The InnoDB memory heap is disabled
120905  8:03:08 InnoDB: Mutexes and rw_locks use Windows interlocked functions
120905  8:03:08 InnoDB: Compressed tables use zlib 1.2.3
120905  8:03:09 InnoDB: Initializing buffer pool, size = 128.0M
120905  8:03:09 InnoDB: Completed initialization of buffer pool
120905  8:03:09 InnoDB: highest supported file format is Barracuda.
120905  8:03:09  InnoDB: Waiting for the background threads to start
120905  8:03:10 InnoDB: 1.1.8 started; log sequence number 1595675
120905  8:03:11 [Note] Server hostname (bind-address): '(null)'; port: 3306
120905  8:03:11 [Note]   - '(null)' resolves to '::';
120905  8:03:11 [Note]   - '(null)' resolves to '0.0.0.0';
120905  8:03:11 [Note] Server socket created on IP: '0.0.0.0'.
120905  8:03:13 [Note] Event Scheduler: Loaded 0 events
120905  8:03:13 [Note] wampmysqld: ready for connections. 
```

阿帕奇日志

```
[Wed Sep 05 08:03:09 2012] [notice] Apache/2.2.22 (Win32) PHP/5.4.3 configured -- resuming normal operations
[Wed Sep 05 08:03:09 2012] [notice] Server built: May 13 2012 13:32:42
[Wed Sep 05 08:03:09 2012] [notice] Parent: Created child process 3812
[Wed Sep 05 08:03:09 2012] [notice] Child 3812: Child process is running
[Wed Sep 05 08:03:09 2012] [notice] Child 3812: Acquired the start mutex.
[Wed Sep 05 08:03:09 2012] [notice] Child 3812: Starting 64 worker threads.
[Wed Sep 05 08:03:09 2012] [notice] Child 3812: Starting thread to listen on port 80.
[Wed Sep 05 08:03:09 2012] [notice] Child 3812: Starting thread to listen on port 80.
[Wed Sep 05 08:04:14 2012] [error] [client 127.0.0.1] File does not exist: C:/wamp/www/favicon.ico
[Wed Sep 05 08:09:50 2012] [error] [client 127.0.0.1] File does not exist: C:/wamp/www/favicon.ico
[Wed Sep 05 08:41:03 2012] [error] [client 127.0.0.1] File does not exist: C:/wamp/www/phpMyAdmin 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:54:43.743

```
[Wed Sep 05 08:41:03 2012] [error] [client 127.0.0.1] File does not exist: C:/wamp/www/phpMyAdmin 
```

我想这说明了为什么你的 phpmyadmin 是空白的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T03:35:20.743

尝试使用 SQL Yog，它比 PHPmyadmin 更强大。网址：[http ://www.webyog.com/en/](http://www.webyog.com/en/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-22T15:53:08.830

好吧，在尝试了 2 天之后，我终于得到了一些答案，为什么我在安装 xampp 并尝试访问 phpMyAdmin 后总是得到一个空白页面。

请务必以管理员身份登录您的服务器！！！我在一家拥有 IT 团队的公司工作，该团队授予我的帐户管理员访问权限和权限，但它仍然无法正常工作。只有当我们以管理员身份登录服务器时，它似乎才有效。

或者

在服务器上安装 Chrome 或 firefox。如果您使用 Internet Explorer 默认浏览器，您会得到一个空白页面。

窗口服务器 2012

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T11:28:40.207

PHPMyAdmin 页面为空白或**错误​​页面（404、403、...）**？

PHPMyAdmin 文件夹不在 WampServer 的 www 文件夹内，因为 WampServer 使用**别名**指向`C:\wamp\apps\`. [您可以在本文](http://www.webtrunghieu.info/site/web/solve-the-denied-access-problem-when-using-wamp-server-2-on-windows-8-)中查看我的指南。希望这有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-27T14:14:55.170

如果您已经尝试过端口解决方案并且它不起作用，请先安装 Apache 服务然后启动它，然后转到 phpMyAdmin 页面！

# .net - 如何在 Lightswitch 中使用 Visual Studio 功能

> ID：12273152
> 
> 赞同：1
> 
> 时间：2012-09-05T00:48:42.310
> 
> 标签：.net, visual-studio, reference, visual-studio-lightswitch

我在使用 Lightswitch 中的 Visual Studio 功能时遇到问题。例如，添加 Web 引用在添加服务引用选项的高级选项卡中不可用（缺少该按钮）。并且添加服务引用似乎不适用于所有 ebay API 调用。此外，lightswitch 不允许我使用其他 Visual Studio 功能，如 system.windows.forms。

我在上一篇文章中看到，可以通过创建一个 silverlight 类库来解决这个问题。

[在 silverlight 中添加引用问题](https://stackoverflow.com/questions/4912306/add-refrence-problem-in-silverlight/12255780#12255780) 但是，我尝试创建一个 silverlight 类库，但注意到我仍然无法引用 Visual Studio 中可用的常用 .NET 函数或调用 Web 引用。除了点击开始新项目-->创建silverlight 类库：我还需要做什么才能使.NET 函数在silverlight 类库中工作？

我对编程很陌生，所以我希望能得到更多帮助。另外，在上面的链接中，建议我创建一个从 withing lightswitch 到外部程序的链接。有人可以帮助我理解这是什么意思以及我需要在 Visual Studio 中做什么才能做到这一点吗？

这几天一直在看，感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T12:30:59.780

Danny，欢迎来到编程，特别欢迎来到 LightSwitch。

在我看来，您可能拥有独立的 LightSwitch。LightSwitch 2011 是作为独立产品发布的，它可以单独工作，也可以集成到任何现有版本的 VS 2010 Pro（或更高版本）中。如果是这种情况，您只能在代码中访问 Silverlight 功能（除非您使用我在下面提到的“技巧”）。对于 LS V2，他们似乎停止了单机版，只是简单地使其在 VS 2012（Pro 或更高版本）的所有版本中可用。

正如您所发现的，即使您创建了一个 Silverlight 项目，它也不允许您使用 .NET 框架中可用的全部内容。Silverlight 是完整的 .NET 框架的子集，主要是为 Web 应用程序创建的（尽管后来添加了 OOB 或 Out Of Browser 功能）。

有一种方法可以绕过限制，我们称之为“命令表模式”（尽管它并不是真正的官方模式）。这篇文章解释了它是如何工作[的：认真对待命令表模式](http://blog.pragmaswitch.com/?p=332)

Beth Massi 的[How Do I 视频](http://msdn.microsoft.com/en-us/lightswitch/ff945359)是 LightSwitch 新手的绝佳资源，但她的许多内容已更新到 LS V2 (VS 2012)。官方的 LightSwitch 论坛，[Visual Studio LightSwitch - 一般问题](http://social.msdn.microsoft.com/Forums/en-US/lightswitch/threads)，也是提问的好地方（即使是新手）。

对于任何需要完整 .NET 框架的严肃编程，您需要 Visual Studio Professional（或更高版本）。

我不知道你读过哪 3 本书，但在我与 Tim Leung 合着的那本书中，应该已经涵盖了你最初的问题。

我希望我能帮助你更好地理解为什么你不能做你认为你可以做的事情。

# iphone - 在标签栏顶部而不是在标签栏内显示视图

> ID：12273157
> 
> 赞同：0
> 
> 时间：2012-09-05T00:49:43.190
> 
> 标签：iphone, ios, xcode, uitableview, uitabbarcontroller

我有一些标签栏应用程序，它们也使用标签栏中的导航控制器。我希望能够在单击表格视图中的单元格时呈现视图，但它不在选项卡栏控制器中。当从推文中单击链接时，这将类似于 Twitter 应用程序。这样，该链接的视图可以旋转，而标签栏中的其他所有内容都不会旋转。这是我的代码现在的设置方式：

```
 self.webViewController = [[[WebViewController alloc] initWithNibName:@"WebViewController" bundle:[NSBundle mainBundle]] autorelease];
[self.navigationController pushViewController:_webViewController animated:YES]; 
```

我只想让视图覆盖标签栏，因此，让它旋转而不需要让标签栏中的所有内容也旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:01:11.027

如果您想在屏幕上的所有其他内容之上呈现视图控制器，那么我建议您以模态方式呈现它。这是一个例子：

```
self.webViewController = [[[WebViewController alloc] initWithNibName:@"WebViewController" bundle:[NSBundle mainBundle]] autorelease];
[self presentViewController:self.webViewController animated:YES completion:nil]; 
```

# javascript - 是否可以使用 HTML5/javascript 播放此流？

> ID：12273161
> 
> 赞同：2
> 
> 时间：2012-09-05T00:50:11.227
> 
> 标签：javascript, html, html5-audio, jplayer, shoutcast

基本上试图在我移植到浏览器的应用程序中播放一些实时音频流。

流示例： http: [//kzzp-fm.akacast.akamaistream.net/7/877/19757/v1/auth.akacast.akamaistream.net/kzzp-fm/](http://kzzp-fm.akacast.akamaistream.net/7/877/19757/v1/auth.akacast.akamaistream.net/kzzp-fm/)

我尝试过 HTML5 音频标签和 jPlayer，但没有成功。我对流式音频几乎一无所知，但是，当我检查 HTTP 响应标头时，指定的内容类型是“audio/aacp”（不确定这是否有帮助）。

我希望对音频格式有更多了解的人可以在这里为我指明正确的方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T02:00:26.853

问题不在于 AAC+*可播放*，问题在于解码称为 ADTS 的**流式**ACC 包装器。[音频数据传输流 [pdf]](http://www.iis.fraunhofer.de/content/dam/iis/en/documents_ALT/AAC_Transport_FormatsR1.0-1tcm183-102284.pdf)或“使用 SHOUTcast 协议通过 HTTP 流式传输的包含 MP4 的 AAC”可以被解码，因此只能由几个媒体播放器（例如，foobar2000、Winamp 和 VLC）播放。

[在尝试使用 SHOUTcast API 为所有列出的电台播放 HTML5 音频时，我遇到了同样的问题](https://getsatisfaction.com/schillmania/topics/sm2_unable_to_play_shoutcast_stations)。不幸的是，从我们的角度来看，似乎没有什么可以做的，只有浏览器供应商可以决定添加对 ADTS 解码的支持。**这是[Chrome/WebKit 中记录的问题](http://code.google.com/p/chromium/issues/detail?id=40344)**。有 60 多人（包括我自己）关注该问题，标记为“WontFix”。

# java - 服务器，我到底需要什么？

> ID：12273162
> 
> 赞同：-1
> 
> 时间：2012-09-05T00:50:12.130
> 
> 标签：java, android

当人们谈论拥有一个接收请求的服务器时（比如更新数据库中的票证，或获取票证..等），我们在这里谈论的是哪种服务器？它只是一个网络服务器（比如来自主机 gator）和几个处理请求的 PHP 脚本，还是我们在谈论特定类型的服务器（不同于网络托管服务器）？

我的目的是拥有一个向服务器发送票证并跟踪状态的 android 应用程序。有点像错误跟踪器。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:57:46.467

好吧，通过“服务器”，人们谈论的是连接到网络的一堆软件（如在 Linux 上运行的 Apache+PHP（Web 服务器）和 MySQL（数据库服务器））和硬件（物理服务器或虚拟服务器）。这些都可以在一个盒子上（可能被称为网络服务器），或者它们可以代表一台更大的计算机的能力，它可以做很多其他事情（可能是一个“本地网络服务器”。通过“拥有”人员大部分意味着能够控制并期望它在请求时响应。他们可以通过向同意保持服务器在指定 IP 地址上运行的网络托管服务提供商付费或购买计算机并加载它来实现这种控制和期望与服务器软件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T01:30:25.073

（添加到 Jasons 关于“什么是服务器”的详细答案）

根据您对运行服务器的了解，无论是通过 ssh 连接到 shell 还是控制面板，我建议您购买一台非常便宜的低端服务器。

例如：ramhost.us 提供具有 root 访问权限的低端服务器，甚至为共享服务器提供更便宜的解决方案，在这些服务器中，您拥有“有限”数量的功能，例如，如果您希望一切都已经设置好，并且需要一个基本的控制面板（如 host gator），则有多少个 mysql 数据库给你。

假设您正在进行错误跟踪：尽管我自己没有调查过。如果您想要一个很酷的框架来处理错误和跟踪它们而不是编写自己的 php 脚本，您可以安装

螳螂错误跟踪： http: [//www.mantisbt.org/](http://www.mantisbt.org/)

并可能使用公钥/私钥加密连接并创建一个简单的 php 脚本以创建新的错误报告

资料来源：我是 ramhost 的客户，使用他们的服务器运行类似的设置，并通过带有公钥加密的自定义 php 脚本连接到“phpbb3”论坛框架，以在外部创建用户帐户

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T00:53:18.183

取决于你想做什么。您可以租用网络服务器并在那里运行一些脚本，或者例如您可以使用自己的计算机来运行数据库和脚本。

如果您有一台可以 24/7 开启的旧电脑，您可以制作自己的服务器！

# java - 移动的物体不会停留在设定的范围内？

> ID：12273164
> 
> 赞同：1
> 
> 时间：2012-09-05T00:50:26.843
> 
> 标签：java, swing, random, applet

我正在创建一个小程序，其中一只羊被一只狗放牧，两者都是对象，因为狗对象靠近羊，羊在随机方向上移开。（很抱歉，我知道我已经问了很多关于这个小程序的问题）。到目前为止一切正常，除了绵羊对象不会停留在我设置的范围内并最终完全从屏幕上消失。我尝试了很多不同的东西，但似乎没有任何效果。任何想法为什么绵羊对象不会停留在范围内？任何帮助将非常感激。这是代码，有两个单独的java文件：

主面板.java

```
import java.awt.Graphics;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;
import java.util.Random;

import javax.swing.JPanel;

public class MainPanel extends JPanel implements MouseMotionListener
{

    private static final long serialVersionUID = 1L;
    Dog dog;
    Sheep sheep;
    int[] directionNumbersLeft = {0, 1, 3};
    int[] directionNumbersRight = {1, 2, 3};
    int[] directionNumbersUp = {0, 1, 2};
    int[] directionNumbersDown = {0, 2, 3};
    int x;
    int selection;
    int xposR;
    int yposR;
    int sheepx;
    int sheepy;
    int sheepBoundsx;
    int sheepBoundsy;
    int MAX_DISTANCE = 50;
    int direction;
    int distance;

    public MainPanel()
    {

        addMouseMotionListener(this);
        sheepx = 175;
        sheepy = 75;
        dog = new Dog(22,22);
        sheep = new Sheep(sheepx, sheepy);
        sheepBoundsx = 30;
        sheepBoundsy = 30;

    }

    public void paintComponent(Graphics g)
    {
        super.paintComponent(g);
        dog.display(g);
        sheep.display(g);
        g.drawRect(20, 20, 600, 600);
    }

    public void mouseDragged(MouseEvent e)
    {
        xposR = e.getX();
        yposR = e.getY();
        dog.setLocation(xposR, yposR);
        sheep.setLocation(sheepx, sheepy);
        direction = (int)(Math.random()*4);
        Random rand = new Random();
        x = rand.nextInt(3);

        if (xposR > sheepx&& xposR < sheepx+sheepBoundsx && yposR > sheepy
                && yposR < sheepy+sheepBoundsy && direction == 0){
            sheepx = sheepx + 50;
        }
        if (xposR > sheepx&& xposR < sheepx+sheepBoundsx && yposR > sheepy
                && yposR < sheepy+sheepBoundsy && direction == 1){
            sheepy = sheepy + 50;
        }

        if (xposR > sheepx&& xposR < sheepx+sheepBoundsx && yposR > sheepy
                && yposR < sheepy+sheepBoundsy && direction == 2){
            sheepx = sheepx - 50;
        }

        if (xposR > sheepx&& xposR < sheepx+sheepBoundsx && yposR > sheepy
                && yposR < sheepy+sheepBoundsy && direction == 3){
            sheepy = sheepy - 50;
        }
        if (sheepx <= 20){
            direction = directionNumbersLeft[x];
        }
        if (sheepy <= 20){
            direction = directionNumbersUp[x];
        }
        if (sheepx >= 600){
            direction = directionNumbersRight[x];
        }
        if (sheepy >= 600){
            direction = directionNumbersDown[x];
        }
        if (xposR < sheepx){
            direction = directionNumbersLeft[x];
        }
        if (xposR > sheepx){
            direction = directionNumbersRight[x];
        }
        if (yposR > sheepy){
            direction = directionNumbersDown[x];
        }
        if (yposR < sheepy){
            direction = directionNumbersUp[x];
        }

        repaint();
    }

    public void mouseMoved(MouseEvent e) {

    }

} 
```

牧羊犬.java

```
import java.awt.Color;
import java.awt.Graphics;

import javax.swing.*;

public class SheepDog extends JApplet
{
    /**
     *
     */
    private static final long serialVersionUID = 1L;
    /**
     *
     */

    MainPanel mainPanel;

    public void init()
    {
        mainPanel = new MainPanel();
        add(mainPanel);

    }

}
class Dog
{
    int xpos;
    int ypos;
    int circleWidth = 30;
    int circleHeight = 30;

    public Dog(int x, int y)
    {
        xpos = x;
        ypos = y;

    }

    public void setLocation(int lx, int ly)
    {
        xpos = lx;
        ypos = ly;
    }

    public void display(Graphics g)
    {
        g.setColor(Color.blue);
        g.fillOval(xpos, ypos, circleWidth, circleHeight);
    }
}

class Sheep
{
    int xpos;
    int ypos;
    int circleWidth = 30;
    int circleHeight = 30;

    public Sheep(int x, int y)
    {
        xpos = x;
        ypos = y;

    }

    public void setLocation(int lx, int ly)
    {
        xpos = lx;
        ypos = ly;
    }

    public void display(Graphics g)
    {
        g.setColor(Color.green);
        g.fillOval(xpos , ypos, circleWidth, circleHeight);
        g.drawOval(xpos - 10, ypos - 10, 50, 50);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:11:51.653

尝试将 elses 添加到您的长字符串 if() 语句中，如下所示：

```
 if (sheepx <= 20){
        direction = directionNumbersLeft[x];
    } else if (sheepy <= 20){
        direction = directionNumbersUp[x];
    } else if (sheepx >= 600){
        direction = directionNumbersRight[x];
    } else ... 
```

以你之前的方式，如果sheepx 剩下20，并且小于狗的x，它仍然会远离狗，即使它应该担心边界。这是因为 if 语句都会触发和 modify `direction`，但是由于您首先检查了边界，因此它会被从狗身上逃跑的尝试覆盖。试试这个解决方案，告诉我它是如何工作的

# javascript - 如何使用 JavaScript 找到未定义的 CSS 属性的值？

> ID：12273167
> 
> 赞同：0
> 
> 时间：2012-09-05T00:51:03.583
> 
> 标签：javascript, html, css

例如，我想返回某个元素的宽度或高度，而无需事先使用 CSS 或 HTML 设置它们。这甚至可能吗？您是否*总是*必须先设置它们才能使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:16:15.170

对元素使用 getComputedStyle() 方法。浏览器之间在此方法的工作方式上存在一些细微差别，但对于高度和宽度属性，它的工作方式相同。

所以，一个例子是：

```
var el     = document.getElementById('el'),
    height = el.getComputedStyle('height'),
    width  = el.getComputedStyle('width'); 
```

这是一个小提琴：http: [//jsfiddle.net/joplomacedo/7Qr83/](http://jsfiddle.net/joplomacedo/7Qr83/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T00:54:28.843

您可以使用 jQuery 来获取任何元素的计算宽度和高度。

[http://api.jquery.com/height/](http://api.jquery.com/height/)
[http://api.jquery.com/width/](http://api.jquery.com/width/)

希望这可以帮助 ：）

# php - PHP数组不识别变量值

> ID：12273170
> 
> 赞同：1
> 
> 时间：2012-09-05T00:51:27.300
> 
> 标签：php

请阅读下面的代码和评论，看看我在做什么。很难用一段话来解释。

```
$url_fixx = 'home/sublink/group-view/product/catview1'; 
// What my variable holds. MY GOAL IS: I want to omit group-view, product and catview1 from this so I use the trick below. 
```

catview 末尾有一个随机数，因此我使用下面的代码查找末尾的数字，在这种情况下它输出“catview1”

```
$string = $url_fixx;
$matches = array();
if (preg_match('#(catview\d+)$#', $string, $matches)) {
    $catViewCatch = ($matches[1]);
 }
// I got this from http://stackoverflow.com/a/1450969/1567428

$url_fixx = str_replace( array( 'group-view/', 'product', 'catview1' ), '', $url_fixx );
// this outputs what I want. 
```

我的问题是：

```
//When I replace "catview1" with $catViewCatch, the whole str_replace doesnt work. 
$url_fixx = str_replace( array( 'group-view/', 'product', $catViewCatch), '', $url_fixx ); 
```

这是为什么？我做错了什么？

PS：我的网址有时也会变成这样。
$url_fixx = 'home/sublink/group-view/anotuer-sublink/123-article'

我该如何解决所有这些问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T01:24:36.283

您的两个示例都输出完全相同的内容。下面的代码演示了这一点：

```
<?php
$url_fixx = 'home/sublink/group-view/product/catview1';

$string = $url_fixx;
$matches = array();
if (preg_match('#(catview\d+)$#', $string, $matches)) {
    $catViewCatch = ($matches[1]);
}
echo str_replace( array( 'group-view/', 'product', 'catview1' ), '', $url_fixx );
echo '<br />';
echo str_replace( array( 'group-view/', 'product', $catViewCatch), '', $url_fixx );
?> 
```

此外，您可以考虑使用[preg_replace](http://php.net/preg_replace)代替，因为它可以用更少的代码完成任务：

```
echo preg_replace('#group-view/product/catview[0-9]+#','',$url_fixx); 
```

# php - PHP + 1 真的增加了两个

> ID：12273172
> 
> 赞同：2
> 
> 时间：2012-09-05T00:51:36.283
> 
> 标签：php, mysql

目前，每次刷新页面时，我都会加载以下 PHP 代码。每次加载页面时，我都会尝试更新视图列 +1。为此，我首先从表中检索先前的视图值，然后运行另一个查询以将 + 添加到该数字。发生的问题是每次我刷新页面时，代码以某种方式添加了两个而不是 1。因此，$viewsA 变量不是增加了 +1，而是增加了 +2。

```
$query = mysql_query("SELECT * FROM Games WHERE pagename = '$game' ");

WHILE($datarows = mysql_fetch_array($query)):

    $title = $datarows['title'];
    $description = $datarows['desc'];
    $img_url = $datarows['img'];
    $cat = $datarows['cat'];
    $pagename = $datarows['page'];
    $rating = $datarows['rat'];
    $viewsA = $datarows['view_count'];
    $gameid = $datarows['id'];

endwhile;

$updateviews = $viewsA +1;

mysql_query("UPDATE  `trainw_games`.`Games` SET  `view_count` =  '$updateviews' WHERE  `Games`.`id` = $gameid;"); 
```

我需要更改什么才能使其仅向视图列添加 +1？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T01:01:02.197

我认为`while`循环不适合这个问题。我建议`echo $viewsA . '-' . $updateviews;`查看添加前后的值。

但是，为什么不只运行一条`UPDATE`语句呢？

```
UPDATE Games SET view_count = view_count + 1 WHERE Games.id = $gameid 
```

当然，您应该停止使用`mysql_`函数并使用 MySQLi 或 PDO：

```
$stmt = $mysqli->prepare("UPDATE Games SET view_count = view_count + 1 WHERE Games.id = ?"); 
$stmt->bind_param($gameid);
$stmt->execute();
$stmt->close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:10:36.860

您的数据库中有多行吗？如果是，则可能是由覆盖先前的值引起的。

例如：-

如果第一行 view_count 为 1。而第二行 view_count 为 2。

用 2 + 1 = 3 覆盖第一行 这让你认为增加了 2？

更新1：好的，试试这个，把这个

```
$updateviews1 = $viewsA + 1;
if ($viewsA < $updateviews1) { //execute the viewsA + 1 } 
```

# javascript - JQueryUI 选择菜单 - 如何添加更多选项

> ID：12273176
> 
> 赞同：6
> 
> 时间：2012-09-05T00:51:48.587
> 
> 标签：javascript, jquery-ui, jquery-ui-selectmenu

通过javascript如何向下拉选择菜单添加更多选项？

目前尝试以下没有运气：

```
for (i = 0; i < json.powerDropDownItems.length; i++) {
    //$('#powerSelect').append($("<option></option>").attr("value", json.powerDropDownItems[i]).text(json.powerDropDownItems[i]));
    $('#powerSelect').selectmenu("value", "nice name");
    //$('#powerSelect').appendTo("<option>" + json.powerDropDownItems[i] + "</option>");
}
$('#powerSelect').selectmenu("refresh");​ 
```

**更新**

感谢 naveen，我得到了它的工作（还添加了代码以清除列表）。这是我的以下代码：

```
 service.getPowerDropDowns(productEC, $('#mountSelect').val(), function (response) {
       var json = $.parseJSON(response.value);

       var options = [];

       // Clear the options first   
       $("#powerSelect option").each(function(index, option) {
            $(option).remove();
       });
        options.push("<option value=''>Choose</option>");
        for (i = 0; i < json.powerDropDownItems.length; i ++)
        {
            options.push("<option value='" + json.powerDropDownItems[i] + "'>" + json.powerDropDownItems[i] + "</option>");
        }
        $('#powerSelect').append(options.join("")).selectmenu();
        $('#powerSelect').selectmenu('enable');
    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T02:31:50.733

This will work

```
$(function() {
    var options = []; 
    for (i = 0; i < json.powerDropDownItems.length; i++) {
        options.push("<option value='" + json.powerDropDownItems[i] + "'>" + json.powerDropDownItems[i] + "</option>");
    }
    //append after populating all options
    $('#powerSelect')
        .append(options.join(""))
        .selectmenu();
});​ 
```

Demo: [http://jsfiddle.net/codovations/p863Q/](http://jsfiddle.net/codovations/p863Q/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T10:10:39.363

取决于版本。

[https://github.com/jquery/jquery-ui/tree/selectmenu](https://github.com/jquery/jquery-ui/tree/selectmenu)使用刷新方法

[https://github.com/fnagel/jquery-ui/tree/selectmenu](https://github.com/fnagel/jquery-ui/tree/selectmenu)使用 selectmenu() 就像 naveen 描述的那样。

# path - .so 和 .h 文件在 Ubuntu 中的位置

> ID：12273177
> 
> 赞同：0
> 
> 时间：2012-09-05T00:51:53.633
> 
> 标签：path, header, shared-libraries

我正在尝试使用 make 文件在 Ubuntu 12.04 操作系统中编译 C++ 代码。我的代码需要`libxml2`和`sqlite3`. 我已经使用 Synaptics 包管理器安装了这些包。但是，现在我不知道头文件（.h）和共享对象库（.so）文件的路径。

这些有默认位置吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T00:53:56.783

有默认位置 -`/usr/include`用于标头，`/usr/lib`用于库 - 这意味着您*不必*在`Makefile`.

但*一定*要确保你有相应的`-dev`包`libsqlite3-dev`并`libxml2-dev`安装！

# jquery - jquery slidetoggle图像交换

> ID：12273179
> 
> 赞同：3
> 
> 时间：2012-09-05T00:52:05.230
> 
> 标签：jquery, image, swap, slidetoggle

我试图让 slideToggle 根据 div 是否展开或折叠来交换图像。我让它以一种方式工作，它将图像从正值更改为负值，但它只适用于一个 div，我有多个，它只能工作一次。它不切换。

这是jQuery：

```
$(".content").toggle(1);
$(".expand").click(function () {
    $(this).next(".content").slideToggle(400);

    if ($(".image1").attr('src', "../nathan/plus.png")) {
        $(".image1").attr(
            'src', 
            $(".image1").attr('src').replace('plus', 'minus')
        );
    } else {
        $(".image1").attr(
            'src', 
            $(".image1").attr('src').replace('minus', 'plus')
        );
    }
});
}); 
```

IndexOf() 有效，但如果我要复制 div，则单击它们时它们都会发生变化。这是HTML：

```
<div class="list">
<h2 class="expand">Title1<img class="image1" src="../nathan/plus.png"></h2>
<div class="content">
</div>
</div>

<div class="list">
<h2 class="expand">Title2<img class="image1" src="../nathan/plus.png"></h2>
<div class="content">
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:48:22.527

您正在使用 setter 方法检查您的 `src'

```
if ($(".image1").attr('src', "../nathan/plus.png")) 
```

改为使用

```
if ($(".image1").attr('src') == "../nathan/plus.png")) 
```

或者更好的是使用[indexOf()检查源是否包含图像](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)

```
if ($(".image1").attr('src').indexOf("plus.png") > -1) 
```

**编辑：**

您可能可以这样做以防止所有内容发生变化 - 这是查找图像的上下文

```
$(".expand").click(function() {
    $(this).next(".content").slideToggle(400);
    var $img = $(".image1", this);
    if ($img.attr('src').indexOf("plus.png") > -1) {
        $img.attr('src', $img.attr('src').replace('plus', 'minus'));
    } else {
        $img.attr('src', $img.attr('src').replace('minus', 'plus'));
    }
});​ 
```

所以

```
$(".image1", this); 
```

将与

```
$(this).find('.image1'); 
```

# c++ - 从 TC++PL 书中的练习中定位向量 ctor 中的错误

> ID：12273184
> 
> 赞同：3
> 
> 时间：2012-09-05T00:53:12.827
> 
> 标签：c++, stl, vector

我一直在研究 Bjarne Stroustrup 的“C++ 编程语言”一书中的所有练习。

我遇到了一个让我难过的特定练习**（E.8.4）**。
这是讨论标准库类中异常安全的附录.他说明了向量构造函数的一种可能实现，然后要求读者找出错误。提示表明它与析构函数有关（可能是双重释放？）但我只是没有看到他在追求什么.

据我所知，分配器可能会抛出 bad_alloc，从而终止 ctor。类似地，T 上的复制 ctor 可能会抛出 uninitialized_fill，这将破坏任何先前复制的元素并终止 ctor。如果那里有错误，那对我来说并不明显。

该练习的措辞如下：“在vector的构造函数**（E.3.1）**的'混乱'版本中找到错误并编写程序使其崩溃。提示：**首先实现vector的析构函数。**

这只是一个 1 分的练习，所以我一定遗漏了一些非常明显的东西。我认为这与抛出析构函数无关，因为在这种情况下所有赌注都没有了。也许在“space”和“last”字段中保持不变量存在问题？

我很想听听任何人的想法。

以下是相关代码：

```
template<class T, class A = std::allocator<T> >
class vector {
private:
    T* v;
    T* space;
    T* last;
    A alloc;

    void destroy_all();
public:
    typedef size_t size_type;

    explicit vector(size_type n, const T& val = T(), const A& = A());
    vector(const vector& a);
    vector& operator=(const vector& a);
    ~vector() { destroy_all(); alloc.deallocate(v, last-v); }
    size_type size() const { return space-v; }
    size_type capacity() const { return last-v; }
    void push_back(const T&);
};

template<class T, class A>
void vector<T,A>::destroy_all() {
    for(T* p = v; p != last; p++)
        alloc.destroy(p);
}

template<class T, class A>
vector<T,A>::vector(size_type n, const T& val, const A& a) : alloc(a) {
    v = alloc.allocate(n);
    try {
        std::uninitialized_fill(v, v + n, val);
        space = last = v + n;
    }
    catch(...) {
        alloc.deallocate(v, n);
        throw;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:23:34.690

问题是 for 的构造函数`T`可以抛出，这意味着 this 可以抛出：

```
std::uninitialized_fill(v, v + n, val); 
```

发生这种情况时，该子句会在不正确销毁任何可能已经构造的对象的`catch(...)`情况下释放内存。`T`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T13:18:50.290

[`allocator::allocate`](http://en.cppreference.com/w/cpp/memory/allocator/allocate)可以扔`std::bad_alloc`。在这种情况下，您未初始化`v`，即使您从内存不足中恢复，您也会在销毁时出现段错误。

另一个问题是[`std::initialized_fill`](http://en.cppreference.com/w/cpp/memory/uninitialized_fill). 如果它抛出，你释放内部存储而不将数据指针标记为无效。析构函数将再次释放相同的内存。

# php - wordpress - how to get an array of templates of an specific theme

> ID：12273196
> 
> 赞同：1
> 
> 时间：2012-09-05T00:55:04.113
> 
> 标签：php, wordpress

I am trying to update a wordpress plugin. At current time the plugin code displays:

```
$themes = get_themes();
$theme = get_current_theme();
$templates = $themes[$theme]['Template Files']; 
```

Here the problem is that `get_theme()` and `get_themes()` are deprecated, and I have tried to change it to `wp_get_theme()`, and `wp_get_themes()`, but it doesnt work.

Does anyone have any idea how to update this? Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:33:24.563

Owww... I found out how it is!!!...

```
 $theme = wp_get_theme();
  $templates = $theme->{'Template Files'}; 
```

hope it helps somebody else.

# ruby-on-rails-3 - 尝试在 Windows 上使用 ffi 和 typhoeus gem，但我需要 libcurl

> ID：12273197
> 
> 赞同：3
> 
> 时间：2012-09-05T00:55:10.643
> 
> 标签：ruby-on-rails-3, libcurl

我对 Rails 很陌生，我正在尝试让应用程序正常工作。它目前正在使用需要 libcurl 版本的 ffi 和 typhoeus。如何安装适用于 Windows 7 的 libcurl 版本。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T13:21:10.733

我实现了一个选项，但不能只安装 libcurl 包。Cygwin 提供了大量用于 Linux 开发的包和库，用于安装在 Windows 上（包括 curl、libcurl、libcurl-dev 等）。

[http://www.cygwin.com/](http://www.cygwin.com/)

它在 Windows 7 64 位操作系统中为我工作。

这是该特定宝石的另一种解决方案

[https://github.com/typhoeus/typhoeus/pull/151/files](https://github.com/typhoeus/typhoeus/pull/151/files)

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-04T16:58:40.787

对我有用的答案是：

1.  从以下 URL 下载 cURL：[https](https://curl.haxx.se/windows/) ://curl.haxx.se/windows/ （我选择了 64 位，因为这是我正在使用的系统）
2.  进入存档并浏览到`/bin`
3.  定位`libcurl_x64.dll`（可能只是`libcurl.dll`）
4.  提取到本地驱动器
5.  `libcurl.dll`如果有`_x64`后缀，则重命名为
6.  将文件剪切 + 粘贴到`/bin`Ruby 安装目录中

它应该在此之后工作

# javascript - 使用 javascript 从 HTML 网页中提取图像 url

> ID：12273199
> 
> 赞同：1
> 
> 时间：2012-09-05T00:55:30.540
> 
> 标签：javascript, string, parsing

我将 html 部分的源代码保存为字符串：

```
var str= '<div class="quizdisplay themestylename theme_db_primarykey">
        <h1>What Power Would Suit You Best</h1>
        <p class="inline_byline"">Created by <a class="url fn" href="/user/xQUANTUMNxNOVAx/profile">xQUANTUMNxNOVAx</a></p>

        <div class="metacrumb">

                  <dl>

                    <dt>Tagged:</dt>

                      <dd><a class="tag" rel="tag" href="/tags/dark" title="dark">dark</a></dd>, <dd><a class="tag" rel="tag"
 href="/tags/personality" title="personality">personality</a></dd>,
 <dd><a class="tag" rel="tag" href="/tags/air"
 title="air">air</a></dd>, <dd><a class="tag" rel="tag"
 href="/tags/power" title="power">power</a></dd>, <dd><a class="tag"
 rel="tag" href="/tags/fire" title="fire">fire</a></dd>, <dd><a
 class="tag" rel="tag" href="/tags/water" title="water">water</a></dd>,
 <dd><a class="tag" rel="tag" href="/tags/energy"
 title="energy">energy</a></dd>, <dd><a class="tag" rel="tag"
 href="/tags/earth" title="earth">earth</a></dd>, <dd><a class="tag"
 rel="tag" href="/tags/lightning" title="lightning">lightning</a></dd>,
 <dd><a class="tag" rel="tag" href="/tags/telekinesis"
 title="telekinesis">telekinesis</a></dd>

                   </dl>

                </div>

        <div id="itemresults" class="quidget">
            <p>
                5493 other people got this result!
                That's 34%
            </p>
                        <a class="button viewallresults">View all results</a>
                            <a href="/quizzes" class="button" style="line-height:23px;width:150px;">Take another quiz!</a>

        </div>

        <h3 class="aquestion">Water/Ice.</h3>

                <img src="/user_images/X/XQ/XQU/XQUANTUMNXNOVAX/1346304322_6798_full.jpeg"
 alt="result image" />

        <p>You go with the flow, following the motions of the world around you. You're calming and relaxing but have an aggressive side to
 you when necessary. You can be in tune with people easily, or can be
 completely cold hearted. People typically love you, and need you the
 most.</p>

 </div>'; 
```

如何使用 javascript 从此字符串中提取图像 url？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T01:31:45.483

### jQuery

```
var srcArray = [];
$(str).find('img').each(function(){
   src = $(this).attr('src');
   srcArray.push(src);
}); 
```

或者您可以使用正则表达式：

```
var regex = /(?<=<img src=").*?(?=")/gm;
src = regex.match(str);
alert(src); 
```

[这个链接](http://regexr.com?321t3)上的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:01:34.227

因为它是 HTML。您可以将全部内容插入 DOM（隐藏）并使用 jQuery 来获取图像 url，这有点 hacky，但可能是最简单的方法。

您还可以使用正则表达式来搜索图像标签并从中获取 url。

# node.js - Mongo 子查询嵌入式文档

> ID：12273200
> 
> 赞同：1
> 
> 时间：2012-09-05T00:55:37.403
> 
> 标签：node.js, mongodb

在 mongo db 我有以下内容： db.users：

```
{ username: "me", 
companies: {
 meco:
     {groups:
       ['addr1','addr2','addr3']
     }
 ,
 youco:
     {groups:
       ['addr1','addr4']
     }
},
 someco:
     {groups:
       ['addr8','addr9']
     }
} 
```

}

我正在尝试查找所有具有 (company=meco & group 有 'addr1') 或 (company=youco & group 有 addr4) 的用户。我该怎么做？谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T01:48:19.437

约翰，

首先，请注意“someco”文档不嵌套在公司中。

除了您所追求的基本语法之外，还有 "{"$or" : [{"companies.meco.groups" : "addr1"}, {"companies.youco.groups" : "addr4"}]}

请查看 Dotted Notation Docs： [http](http://www.mongodb.org/display/DOCS/Dot+Notation+(Reaching+into+Objects) ://www.mongodb.org/display/DOCS/Dot+Notation+(Reaching+into+Objects )

以及高级查询 $ 或文档 [http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24or](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24or)

干杯，

大卫

# python - 使用 PYTHON 进行替换匹配的字符串

> ID：12273201
> 
> 赞同：0
> 
> 时间：2012-09-05T00:55:39.480
> 
> 标签：python, regex

我有一个字符串，我需要将该字符串与一个序列匹配，并确定在该序列中找到匹配序列的次数但它具有以下条件序列只能包含 ACGT 有效字符，因此 seq 可以是 ACGTGTCTG

字符串可以是 ACGnkG 其中 n 可以替换为 A 或 G k 可以替换为 C 或 T

我们如何通过将有效值替换为 n 和 k 来查找字符串是否与序列匹配

有正则表达式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:13:08.577

`re.findall(pattern, string)`将返回一个包含所有匹配项的列表`pattern`in `string`。`len(...)`将返回列表中的项目数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T01:28:30.790

如果要计算模式的出现次数：

```
count_regex = sum(1 for _ in re.finditer(r'ACG[AG][CT]G', s)) 
```

如果要计算首先匹配模式的固定字符串的出现次数：

```
m = re.search(r'ACG[AG][CT]G', s)
count_fixed = s.count(m.group(0), m.start(0)) if m else 0 
```

# ruby - 仅当宽度超过 Graphics/Image Magick 时如何调整图像大小

> ID：12273203
> 
> 赞同：3
> 
> 时间：2012-09-05T00:56:01.497
> 
> 标签：ruby, image, imagemagick, graphicsmagick

如此处所示：[http](http://www.imagemagick.org/Usage/resize/#shrink) ://www.imagemagick.org/Usage/resize/#shrink选项：

```
-resize 64x64> 
```

仅当宽度和高度超过 64 像素时才调整大小。但是如果可行的话，如何做这样的事情：

```
-resize 64>x 
```

或者

```
-resize 64x'ignores'> 
```

换句话说，如果只有宽度超过这个大小。这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-05T01:27:28.637

您可以通过使用“不太可能大”的高度值轻松实现这一点：

```
convert  orig.png  -resize '64x10000>'  scaled.png 
```

仅当原始 PNG 的宽度大于 64 像素**或**高度大于 10 000 像素时，才会调整原始 PNG 的大小。但是该命令遇到高于 10 000 像素的输入的可能性非常低。所以它（几乎）只会遇到宽度值匹配的输入文件。

宽度低于 64 像素的原始 PNG 将保持不变（除非它们的高度高于 10 000 像素......）。

# php - 部署到 Heroku 时如何保留会话？

> ID：12273207
> 
> 赞同：4
> 
> 时间：2012-09-05T00:56:35.470
> 
> 标签：php, git, session, heroku

我正在使用 PHP 制作 Heroku FB 应用程序，每当我执行 git push 时，我的用户会话都会被破坏。为什么会发生这种情况？更重要的是，我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T12:16:53.263

另一个没有提到的选项是使用 Memcached 来存储会话。您可以使用 heroku 插件 Memcachier ( [https://addons.heroku.com/memcachier](https://addons.heroku.com/memcachier) )。

[要将 php 配置为使用 memcached 会话处理程序，请查看位于http://php.net/manual/en/memcached.sessions.php](http://php.net/manual/en/memcached.sessions.php)的扩展手册。基本上你设置 php.ini 指令：

```
session.save_handler = memcached
session.save_path = "localhost:11211" 
```

将 save_path 替换为安装插件时提供的 Memcachier 地址和端口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T15:56:31.483

您需要将会话存储在数据库中。您可以将它们存储在 Postgres 或 Redis 之类的东西中。这些将在部署期间保留。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-28T05:41:12.963

我用的是AppFog，Memcachier现在支持SASL了，但是不知道怎么继续。

```
session.save_handler = memcached 

session.save_path = "localhost: 11211"
```

现在缺少的是身份验证，我不知道该怎么说我发现了这个，但我不知道它是否会起作用以及如何使用
[http://php.net/manual/en/memcached.setsaslauthdata.php](http://php.net/manual/en/memcached.setsaslauthdata.php)
pd ：我无法在 appfog 中访问 php.ini，所以我需要通过 htaccess 执行此操作，你能给我一个如何在 htaccess 中执行此操作的示例吗？
[https://docs.appfog.com/languages/php#php_ini](https://docs.appfog.com/languages/php#php_ini)
谢谢

# r - 如果缺少某个预测变量的某些值，如何在 R 中使用线性回归？

> ID：12273208
> 
> 赞同：-1
> 
> 时间：2012-09-05T00:56:50.247
> 
> 标签：r, machine-learning, statistics, linear-regression

`y`预计是预测变量的线性函数`x1`, `x2`, ...，`xn` 所以我`glm`用来查找回归，但其中一个参数（`x1`例如）的某些值缺失（`NA`在输入数据中）它们是定义的，它们只是未知的将是`x1`在回归中使用的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T15:36:45.853

取决于问题的上下文。一些解决方案是：

*   省略 NA 或排除实例
*   按默认值替换（0，其他平均值）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-08T12:48:34.103

您可以使用以下代码将缺失值替换为零

```
myData[myData == ''] <- 0 
```

您也可以使用以下代码使用行均值或列均值替换它们

```
for(i in 1:nrow(myData)){
myData[i,is.na(myData[,i])] <- mean(myData[i,], na.rm = TRUE)
} 
```

或者

```
for(i in 1:ncol(myData)){
myData[is.na(myData[,i]), i] <- mean(myData[,i], na.rm = TRUE)
} 
```

如果您已经有 0 作为缺失值并且您想用 NA 替换它，请使用以下代码：

```
myData[myData == 0] <- NA 
```

如此处讨论的[将所有 0 值替换为 NA](https://stackoverflow.com/questions/11036989/replace-all-0-values-to-na)

# jquery - 如何在 JSF 中屏蔽未呈现的字段？

> ID：12273211
> 
> 赞同：3
> 
> 时间：2012-09-05T00:57:16.750
> 
> 标签：jquery, jsf-2, primefaces, mask

问题是我想知道如何屏蔽一个在我加载页面时未呈现的字段。例如：我有一个 h:inputText 仅在用户执行某些操作后才呈现。

如果在我加载页面时输入文本呈现=true，它工作正常，但我需要用户点击一个按钮，并根据条件，应用程序呈现 inputText 与否。

这是jQuery代码：

```
$('input[name*="preco"]').maskMoney({symbol:"R$",decimal:".",thousands:","}); 
```

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T01:47:20.353

要么也有条件地渲染脚本：

```
<h:inputText ... rendered="#{some condition}" />
<h:outputScript rendered="#{some condition}">maskMoney()</h:outputScript> 
```

或者，如果您使用 PrimeFaces 命令组件，请使用 PrimeFaces `oncomplete`：

```
<p:commandButton ... oncomplete="maskMoney()" /> 
```

或者，如果您正在使用`<f:ajax>`，请使用`onevent`：

```
<f:ajax ... onevent="function(data) { if (data.status == 'success') maskMoney() }" /> 
```

# php - jquery 表编辑 - 无法设置变量

> ID：12273213
> 
> 赞同：0
> 
> 时间：2012-09-05T00:57:24.287
> 
> 标签：php, jquery

更新：想通了...需要先在 DOM 中提升一个级别。

```
 var map_id = $(this).parent().find(".map_id").attr('value');
 var corrected_isin= $(this).parent().find(".corrected_isin").val();
 var corrected_cusip = $(this).parent().find(".corrected_cusip").val();
 var corrected_ticker = $(this).parent().find(".corrected_ticker").val(); 
```

我在让 jquery 为我工作时遇到了很多麻烦......我正在尝试更新数据表。我所有的更新代码都可以正常工作，但无论出于何种原因，我试图用 jquery 设置的变量都是未定义的。下面的代码没有设置变量。当我对变量进行硬编码时，它工作正常。我也尝试过使用 ID 而不是类，但无济于事。请帮忙！

谢谢你，大卫

```
 var map_id = $(this).children(".map_id").attr('value');
        var corrected_isin = $(this).children(".corrected_isin").val();
        var corrected_cusip = $(this).children(".corrected_cusip").val();   
        var corrected_ticker = $(this).children(".corrected_ticker").val(); 
```

完整代码：

```
<html>
<head>
<title>ISIN Editor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script>
$(document).ready(function(){
    $("form").submit(function() {
        var map_id = $(this).children(".map_id").attr('value');
        var corrected_isin = $(this).children(".corrected_isin").val();
        var corrected_cusip = $(this).children(".corrected_cusip").val();   
        var corrected_ticker = $(this).children(".corrected_ticker").val();

        $.ajax({
            type: "GET",
            url: "aj/table_edit_ajax.php",
            data: {corrected_isin: corrected_isin, corrected_cusip: corrected_cusip, corrected_ticker:  corrected_ticker,  map_id: map_id},
            cache: false,
            success: function(){
                alert(map_id + " " + corrected_isin + " " + corrected_cusip + " " + corrected_ticker );
            }
        });
       return false;
   });
});
</script>
</head>
<body>

<?php

include("aj/db.php");
$query = "SELECT map_id, ria_crd, position_cusip, position_ticker, position_description, position_first_date, position_last_date, map_corrected_isin, map_corrected_cusip, map_corrected_ticker FROM map_to_isin WHERE map_correct_status IN (2,5)";

$result = mysql_query($query,$bd);

?>
    <table>
    <tr>
    <th>map_id</th>
    <th>RIA CRD</th>
    <th>Reported CUSIP</th>
    <th>Reported Ticker</th>
    <th>Reported Description</th>
    <th>Date Range</th>
    <th>New isin</th>
    <th>New CUSIP</th>
    <th>New Ticker</th>
    <th>Submit Change</th>
    </tr>

<?php
$row_num = 1;
while($row = mysql_fetch_array($result))
  {

    echo "<tr"; 
    if($row_num%2) { 
        echo " bgcolor='pink'";
    }; 
    echo ">"; ?>

    <form id="form<? echo $row['map_id'] ?>"> 
    <input type="hidden" name="map_id" class="map_id" value="<? echo $row['map_id'] ?>"/>
    <td><? echo $row['map_id'] ?></td>
    <td><? echo $row['ria_crd'] ?></td>
    <td><? echo $row['position_cusip'] ?></td>
    <td><? echo $row['position_ticker'] ?></td> 
    <td><? echo $row['position_description'] ?></td>
    <td><? echo $row['position_first_date'] . " -> " . $row['position_last_date'] ?></td>
    <td><input type="text" name="corrected_isin" class="corrected_isin" value="<? echo $row['map_corrected_isin'] ?>"/></td>
    <td><input type="text" name="corrected_cusip" class="corrected_cusip" value="<? echo $row['map_corrected_cusip'] ?>"/></td>
    <td><input type="text" name="corrected_ticker" class="corrected_ticker" value="<? echo $row['map_corrected_ticker'] ?>"/></td>
    <td><input type='submit' value='Update' /></td>
    </form>
    </tr>
    <?php
    $row_num ++;
  }
echo "</table>";

mysql_close($bd);

?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:36:47.277

try to do:

```
 var map_id = $(this).parent().find(".map_id").val();
    var corrected_isin = $(this).parent().find(".corrected_isin").val();
    var corrected_cusip = $(this).parent().find(".corrected_cusip").val();   
    var corrected_ticker = $(this).parent().find(".corrected_ticker").val(); 
```

# matlab - 如何使用 MATLAB 填充网站上的文本框

> ID：12273214
> 
> 赞同：1
> 
> 时间：2012-09-05T00:57:36.190
> 
> 标签：matlab, internet-explorer, textbox, browser

我正在尝试使用 MATLAB 在 Internet Explorer 中的网页上填写文本框，而无需直接输入 URL。谁能向我解释如何做到这一点？我很迷茫。我真的很感激你能给我的任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:54:14.060

虽然我以前见过这样做（即运行一个自动填充 Internet Explorer 中的字段的 MATLAB 脚本），但据我所知，我不相信有一个实际的 MATLAB 命令可以直接与 IE 交互。

相反，您可以使用 MATLAB 命令`system`来调用实际与 IE 进行交互的外部程序。

例如，您可以制作一个通过 InternetExplorer 对象与 IE 交互的 Visual Basic 程序。我对 VB 不太熟悉，但这个[文档](http://msdn.microsoft.com/en-us/library/aa752084%28v=vs.85%29.aspx)可能会有所帮助。一旦你创建了这个程序，使用 MATLAB 的`system`命令来执行它（传递命令行参数来定义什么/如何填充文本框）。

查看[系统](http://www.mathworks.com/help/techdoc/ref/system.html)文档以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T06:50:14.890

[我用一个叫做Autohotkey](http://www.autohotkey.com/)的小程序做过很多次。使用此程序，您可以编写一个脚本，该脚本将移动鼠标/单击键盘。您可以传递字符串参数并在脚本中使用它。完成后，您可以从 matlab 调用此脚本。

# node.js - 使用 node.js 和 mongoose 和 expressjs 和 passportjs 进行身份验证

> ID：12273215
> 
> 赞同：1
> 
> 时间：2012-09-05T00:57:43.987
> 
> 标签：node.js, mongodb, authentication, passport.js

伙计们，我在哪里可以使用在文本字段中输入的用户名和密码获得使用节点 js 和 mongodb 和 passportjs 进行身份验证的示例。我无法弄清楚 passportjs 网站中给出的内容。我可以获得这种类型的简单运行示例从哪里来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T16:46:59.423

通过使用为护照、本地护照和猫鼬模型提供集成解决方案的护照[本地猫鼬](https://github.com/saintedlama/passport-local-mongoose)，您可以更轻松地实现此功能。您可以在 github 页面上找到文档和示例。

顺便说一句：我是这个模块的作者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T16:28:46.243

你看过passportjs指南的这个页面吗？

[http://passportjs.org/guide/username-password.html](http://passportjs.org/guide/username-password.html)

# javascript - 试图在javascript中舍入一个对象值

> ID：12273218
> 
> 赞同：0
> 
> 时间：2012-09-05T00:57:49.547
> 
> 标签：javascript, object, rounding

我似乎有一个非常简单的小脚本......

```
function speedcomp(obj) {
    obj.speedmile.value = 3600 / obj.timesec.value
}

function distcomp(obj) {
    if (obj.speed.value == "")
        obj.speed.value = ((1 * obj.distance.value) / obj.day.value) / 24;
    else if (obj.distance.value == "")
        obj.distance.value = distance.value;
    else if (obj.day.value == "")
        obj.day.value = ((1 * obj.distance.value) / obj.speed.value) / 24;
    obj.hour.value = ((1 * obj.distance.value) / obj.speed.value);
}​ 
```

我有 4 个输入类型的文本，它们的 id 分别是距离、速度、日期和小时。当我输入速度和距离并单击 onclick="distcomp(this.form)" 的按钮时，它很好地为我计算。

我遇到的问题是试图将天和小时的值四舍五入到最接近的第 100 位。因为我没有预设值，所以我发现自己在 Math.round 和 Math.floor 中挣扎。我相信答案将是使用 Math.round 但我可以使用一些。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:24:15.237

你可以使用[`toFixed`](http://ecma-international.org/ecma-262/5.1/#sec-15.7.4.5)：

```
var num = Math.random();
alert(num.toFixed(2)); 
```

IE 6 周围有一些错误的实现，并且 javascript 小数对于某些值并不精确，因此您可能会得到意想不到的结果：

```
(0.595).toFixed(2) // 0.59 in Firefox, 0.60 in IE 
```

如果您使用：

```
Math.round(num*100)/100 
```

那么您将无法获得正确的填充（0.59 => 0.6 而不是 0.60）。[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number/toFixed)还有一些其他有趣的片段。

似乎有一个合理的替代方法来`toFixed`回答[如何在 JavaScript 中为 Number.toFixed 编写原型？](https://stackoverflow.com/questions/337112/how-to-write-a-prototype-for-number-tofixed-in-javascript).

### 编辑

这是一个合理的 toFixed 函数，我将继续测试以确保它合理地兼容 ES5。因为`toFixed(0,2)`它返回`0.00`，而规范说`0`，但我认为前者更有用。

```
function toFixed(num, places) {

    var m, s = '', t;
    num = Number(num);

    if (isNaN(num)) return 'NaN';

    if (num < 0) {
      s = '-';
      num = num * -1;
    }

    m = Math.pow(10, places || 0);
    num = String(Math.round(num * m) / m).split('.');
    t = num[1] || '';
    num[1] = t + (new Array(places - t.length + 1)).join('0');

    return s + num.join('.');
}; 
```

Jasper 的评论似乎是一个很好的解决方案：

```
(Math.round(.595*100)/100).toFixed(2); 
```

虽然`(0).toFixed(2)`给出`0`（根据 EMCA-262）而不是更有用`0.00`，这就是为什么上面避免`toFixed`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:03:21.060

要四舍五入到最接近的第 100 位，请将数字乘以 100，调用`Math.round()`然后再除以 100。

```
num=210.653434343
Math.round(num*100)/100
210.65 
```

要四舍五入到 100 位，首先除法，四舍五入，然后乘法。您也可以将 100 更改为任何其他位置，它会为此工作。（第 10 和第 10 名将 100 更改为 10）

# c++ - C ++的向量或映射或哈希映射？

> ID：12273219
> 
> 赞同：4
> 
> 时间：2012-09-05T00:59:13.910
> 
> 标签：c++, map, vector, hashmap

我有大量记录，比如大约 4,000,000 条，我想反复处理它们并将信息放入与该记录链接的类中。我不确定我应该使用什么样的数据结构？我应该使用向量、映射还是哈希映射。我不需要插入记录，但我需要读取包含这些记录编号（或名称）集的表，然后获取一些链接到该记录的数据并对它们进行一些处理。在 map 上的发现是否足够快以至于不能在这个例子中使用 hashmaps？这些记录有一个类作为它的结构，并且我之前没有做过任何使用以类作为其值的映射或哈希映射（如果可能的话）。提前谢谢各位。

编辑：

我暂时不需要将所有记录同时保存在内存中>我需要先给它一个结构，然后从一些记录中获取数据。记录总数约为 2000 万条，我想读取这些原始记录中的每一个，然后如果我要创建的新地图或矢量中不存在其基本信息，然后将其余数据作为一个向量。因为我有 2000 万条记录，我认为每条记录都要经过 400 万条记录才能找到该记录的基本信息是否存在，这将是非常痛苦的。我有大约 400 万个类型的包，每个包都可以有不止一种类型的服务（每个包大约 5 (20/4) 个）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T01:16:18.037

这三种数据结构各有不同的用途。

A`vector`基本上是一个动态数组，适用于索引值。

A`map`是具有 O(log(n)) 检索和插入时间的排序数据结构（使用平衡二叉树实现，通常是红黑）。如果您找不到有效的哈希方法，这是最好的。

A`hash_map`使用哈希来检索对象。如果您有一个定义良好且冲突率低的哈希函数，您将获得恒定*的平均*检索和插入时间。`hash_map`s 通常比`map`但并非总是更快。它高度依赖于哈希函数。

对于您的示例，我认为最好使用 a `hash_map`where key 将是记录号（假设记录号是唯一的）。

如果这些记录数密集（意味着索引之间几乎没有间隙，例如：1,2,4,5,8,9,10...），您可以使用`vector`. 如果您的记录来自具有自动增量主键且删除次数不多的数据库，则通常应该是这种情况。

# networking - 浏览器 KB/s 是每秒 1000 字节还是 1024 字节？

> ID：12273221
> 
> 赞同：3
> 
> 时间：2012-09-05T00:59:46.843
> 
> 标签：networking, byte

您可能知道千字节可能指的是 1000 字节或 1024 字节，具体取决于上下文。更多信息[参见维基百科页面](http://en.wikipedia.org/wiki/Kilobyte)。

大多数浏览器以 KB/s 表示下载速度。

**问题**：您知道他们使用的是 1000 还是 1024 的约定千字节？如果您知道某个特定的浏览器（即 Firefox 或 Chrome）会有所帮助。

我在问，因为我正在开发一个需要准确测量下载速度的应用程序，这将有助于进行比较。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:22:05.343

感谢 Preet Kukreti 为我指明了正确的方向。根据[this Wikipedia page](http://en.wikipedia.org/wiki/Data_rate_units#Prefix%3a_k_vs_Ki)，答案是1000字节。

所以浏览器上的 KB/s 意味着每秒 1000 字节，而不是 1024。

# c# - 列表框中项目的第一次鼠标单击事件不会触发该功能

> ID：12273222
> 
> 赞同：1
> 
> 时间：2012-09-05T00:59:49.023
> 
> 标签：c#, winforms

我正在尝试做类似的事情：当用户在列表框中选择一个项目时，该功能`listboxClicked`将被触发。但是，第一次点击往往无法触发该功能。它仅在我第二次单击同一项目或另一个项目时触发该功能。

我可以知道我的代码有什么问题吗？谢谢你。

我的代码：

```
 private void listbox_SelectedIndexChanged(object sender, EventArgs e)
    {
        listbox.MouseClick += listboxClicked;
    }

    private void listboxClicked(object sender, EventArgs e)
    {
        if (listbox.SelectedIndex != -1)
        {
            //do something
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T01:03:30.353

试试这个：

```
Listbox1_SelectedValueChanged(object sender, EventArgs e)
{
    Listbox listbox = (Listbox)sender;
    MessageBox.Show(listbox.SelectedItem.ToString());
} 
```

# antlr - 如何在ANTLR中解决歧义而不回溯？

> ID：12273224
> 
> 赞同：0
> 
> 时间：2012-09-05T01:00:06.800
> 
> 标签：antlr

expr : 原子 | atom BINARY expr -> ^(BINARY atom expr) ;

如果可能的话，我想在不回溯的情况下解决这个问题。由于某种原因，使用回溯会破坏我的代码。关于句法谓词的文档不多，我想知道如何用谓词代替。

# php - 什么是 mysqli 等价于这个？

> ID：12273225
> 
> 赞同：0
> 
> 时间：2012-09-05T01:00:09.120
> 
> 标签：php, mysql, mysqli

在 php/mysql 方面，我似乎有点老派，老实说只是习惯了它，但现在我一直被告知使用**mysqli**而不是**mysql**，所以我一直在阅读一些帖子/文章以及包括 php.net 在内的关于它的内容，但对我来说没有任何意义，所以想也许如果有人能给我一个相当于我的片段的内容，我可能会开始更好地理解它......

这是一个简单的 mysql while 循环：

```
$query  = "SELECT * FROM foo ORDER BY id DESC LIMIT 10, 10";
$result = mysql_query($query);

while ($row = mysql_fetch_array($result)) {

$dog = $row['dog'];

  echo $dog;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:11:43.620

`mysqli`在程序样式中使用的等价物是：

```
$link = mysqli_connect("localhost", "user", "pass", "db");
$query = "SELECT * FROM foo ORDER BY id DESC LIMIT 10, 10";
$result = mysqli_query($link, $query) or die(mysqli_error($link));

while($row = mysqli_fetch_array($result, MYSQLI_BOTH)) {
    $dog = $row['dog'];
    echo $dog;
}

mysqli_free_result($result);
mysqli_close($link); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T01:11:45.430

尝试这个：

```
$query = "SELECT * FROM foo ORDER BY id DESC LIMIT 10, 10";
$result = mysqli_query($query) 或死 (mysqli_error());

而 ($row = mysqli_fetch_array($result, MYSQLI_ASSOC)) {

$dog = $row['dog'];

  回声$狗；

}

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T01:22:01.260

mysqli 有两种不同的接口，一种与老式 mysql 接口非常相似，另一种是面向对象的。

面向对象的版本是这样工作的：

```
/* establish connection */
$mysqli = new mysqli("localhost", "user", "password", "database");
if ($mysqli->connect_errno) {
    echo $mysqli->connect_error;
    return;
}

/* query & fetch-loop */
$result = $mysqli->query("SELECT * FROM foo ORDER BY id DESC LIMIT 10, 10");
if (!$result) {
    echo $mysqli->error;
    return;
}
while ($row = $res->fetch_assoc()) {
    $dog = $row['dog'];
    echo $dog;
} 
```

如您所见，代码长度与旧样式版本大致相同（只需忽略错误检查和打开连接）。

顺便说一句：mysqli 文档还不错，您只需跳过第一页，因为这一页真的很奇怪。我将从这里开始：[http](http://www.php.net/manual/en/mysqli.quickstart.connections.php) ://www.php.net/manual/en/mysqli.quickstart.connections.php 。

# javascript - display: none 更改为 display: inline 本身？

> ID：12273226
> 
> 赞同：0
> 
> 时间：2012-09-05T01:00:10.023
> 
> 标签：javascript, jquery, css, show-hide

我使用带有标签插件的 jQuery 1.7.2 和 UI 1.8.21。

我有三个选项卡，每个选项卡都有一个跨度表，我想根据一些 javascript 变量的值隐藏/显示。

它在第一个选项卡上工作正常，但第二个和第三个选项卡没有。我使用相同的功能来打开/关闭跨度。

我无法在 jsfiddle 上重现此问题。它工作正常。

```
function toggle_svn_user(codebase){

    if (codebase=="trunk" && user==trunk_svn_user){
        $('#'+codebase+"_svn_user").hide();
        $('#'+codebase+"_svn_relocate_cmd").hide();

        //$('#'+codebase+"_svn_user").css('display', 'none');
        console.log("hide "+codebase);
        console.log($('#'+codebase+"_svn_relocate_cmd").attr('style'));
    }else{
        $('#'+codebase+"_svn_user").show();
        $('#'+codebase+"_svn_relocate_cmd").show();
    }
 } 
```

其他两个选项卡还有两个 if 块。这适用于“分支”代码库。所以我开始使用“主干”代码库对其进行调试。

toggle_svn_user() 函数在`$(document).ready(function(){`块中运行。我还添加了按钮以随时触发该功能。这给了我同样的结果。console.log() 显示有什么奇怪的，`display: none;`但是当我使用 firebug 查看 html 时，我可以看到`display: inline;`。我可以单击按钮，console.log 和 html 不匹配。

我尝试使用 jQuery 的 .hide()，`.css('display', 'none');`也`.css('display', 'none !important');`没有任何帮助。我尝试将我的应用程序与具有相同结果的选项卡一起使用。

知道如何解决吗？或者如何显示/隐藏跨度？

```
<span class="" id="trunk_svn_user">svn user:<span id="trunk_svn_user_value"></span></span>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:09:29.617

我的猜测是其他`if`块之一可能会干扰 - 如果您注释掉其他情况，它会起作用吗？

在旁注中，您可以使用 jQuery 的`toggle`方法来简化您的代码。`.toggle( showOrHide )`见本页第三个用法：http: [//api.jquery.com/toggle/](http://api.jquery.com/toggle/)

这是一个例子：

```
function toggle_svn_user(codebase){

    if (codebase=="trunk"){
        var showUser = (user == trunk_svn_user)

        $('#'+codebase+"_svn_user").toggle(showUser);
        $('#'+codebase+"_svn_relocate_cmd").toggle(showUser);

        console.log($('#'+codebase+"_svn_relocate_cmd").attr('style'));
    }
} 
```

# java - 使用现有 App Engine 应用程序开发 Android 应用程序

> ID：12273231
> 
> 赞同：1
> 
> 时间：2012-09-05T01:01:21.357
> 
> 标签：java, android, google-app-engine

我有现有的 appengine 应用程序。我打算用那个现有的应用程序开发 android 应用程序。我只能找到有关开发带有新 appengine 应用程序的 android 应用程序的示例。为现有 appengine 项目开发 android 应用程序的任何参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:58:43.520

它没有什么特别之处。您必须添加某种 API，以便您的移动应用程序可以使用并以易于解析的格式（例如 JSON 或 XML）返回数据。您已经考虑过是否需要身份验证以及如何进行身份验证（Google 帐户已集成在 Android 中，但您需要额外的权限才能使用它们）。然后，您可以使用 HttpClient 或 HTTPUrlConnection 从 Android 访问它们。

这样做的“新”方法是使用 Goggle Cloud Endpoints，它负责身份验证并自动为您生成 Android 客户端。但是它仍处于“受信任的测试版”中，因此您可能无法使用它。

[http://endpoints-trusted-tester.appspot.com/](http://endpoints-trusted-tester.appspot.com/)

# sms - 从 Web 发送 SMS（是否有一些提供商）？

> ID：12273237
> 
> 赞同：4
> 
> 时间：2012-09-05T01:01:59.717
> 
> 标签：sms, saas, sms-gateway

我想要 app.net 网站所拥有的东西。您单击一个按钮，然后可以选择通过 SMS（或电子邮件）将链接发送到您的手机。实现 sms 方面有哪些选择，是否有提供此功能的服务或开源包？

[这是 app.net 中的一个随机示例](http://app.net/q99live)。单击“获取此应用程序”按钮以​​了解我的意思。

像这样的东西甚至对我`<a href="http://saasSMS.com?url=mycorp.com/test.html">Send link to Phone</a>`有用。“saasSMS.com”是一些处理整个短信方面的服务。理想情况下，可以通过链接或表单帖子来处理（并且它会在成功或其他情况下重定向回您的网站）。

**我不想要**的：一个下拉菜单让你选择你的运营商和一些试图通过电子邮件给你@vtext.com 或类似的 php 页面。这还不够光滑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-03T23:35:49.710

您可以使用[ViaNett HTTP API](http://www.vianett.com/en/developers/sms-api-overview/http-get-post-api)在全球范围内发送 SMS 消息，而无需指定运营商。

只要您的后端支持调用 HTTP 请求，它就可以工作。

这是一个用 PHP 编写的示例：

```
<?php

// Register here to get a username and password:
// http://www.vianett.com/en/free-demonstration-account

if (vianett_sendsms('username', 'password', 'example', '+4412345678', 'Hello world', $error)) {
    echo 'Success!';
} else {
    echo $error;
}

function vianett_sendsms($username, $password, $from, $to, $msg, &$response=null) {
    $url = 'https://smsc.vianett.no/v3/send.ashx';
    $data = array(
        'user'  => $username,
        'pass'  => $password,
        'src'   => $from,
        'dst'   => $to,
        'msg'   => $msg
    );
    $qs = http_build_query($data);
    $response = file_get_contents($url.'?'.$qs);
    return $response == '200|OK';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-08T16:41:44.593

我们从[http://www.twilio.com获得了很好的结果](http://www.twilio.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T23:54:19.950

对于直接 SMS，您可以尝试联系服务提供商并与其签订合同。如果是小型项目，并且服务器可以访问，您可以放置​​一个GPRS手机或调制解调器并与它一起发送。

# java - 从 32 位 BufferedImage 创建一个凹面（如果需要）

> ID：12273245
> 
> 赞同：1
> 
> 时间：2012-09-05T01:03:51.417
> 
> 标签：java, polygon, alpha, bufferedimage, outline

我什至如何开始编写一个将 RGBA BufferedImage 作为输入并将其转换为使用 alpha 表示图像“轮廓”的多边形的方法。请记住，我的 Polygon 类包含一个 ArrayList 点（可以具有浮点 x 和 y 值），如果需要，它们可能代表一个凹多边形。这些点必须按顺时针或逆时针顺序排列，并且多边形永远是闭合的。不需要孔。我怎样做？

# ios - Facebook SDK FBRequest requestForMe 指针类型不兼容

> ID：12273247
> 
> 赞同：7
> 
> 时间：2012-09-05T01:03:54.733
> 
> 标签：ios, facebook, sdk

我在尝试将我的 Facebook SDK 升级到最新的生产版本时遇到问题（FacebookSDK-3.0.8.pkg - 适用于 iOS 的 Facebook SDK 3.0（更新 1）[2012 年 8 月 21 日]）。

我正在关注[此页面](https://developers.facebook.com/docs/getting-started/getting-started-with-the-ios-sdk/#coding)上的教程。

我在尝试使代码正常工作时遇到了几个问题，这并不像教程中所说的那么容易。我可以让我的会话打开，但无法让请求工作。

```
- (IBAction)facebookTapped:(id)sender {
[FBSession openActiveSessionWithPermissions:nil allowLoginUI:YES completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
    if(error) {
        NSLog(@"Error opening session: %@", error);
        return;
    }

    if(session.isOpen) {
        NSLog(@"session is open");

        FBRequest *me = [FBRequest requestForGraphPath:@"me"];
        [me startWithCompletionHandler:^(FBRequestConnection *connection,
                                         NSDictionary<FBGraphUser> *my,
                                         NSError *error) {
            NSLog(@"My name: %@", my.first_name);
        }];
    }

    }];
    } 
```

如果我删除对 FBRequest requestforGraphpath 的调用，我的控制台会显示会话已打开。如果我把它留在里面，我会收到错误“初始化'void（^）（struct FBRequestConection *，struct NSDictionary*，struct NSError*）'的不兼容块指针类型，预期'FBRequestHandler'

现在让我感到困惑的是，这是教程中显示的确切代码，除了我尝试不同的方法更改了 [FBRequest requestForMe] 之外。没有工作。

任何人都可以为我阐明这一点吗？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T14:07:53.270

我能够通过在以下教程中更改其原始块来解决此问题：

```
if (session.isOpen) {
FBRequest *me = [FBRequest requestForMe];
[me startWithCompletionHandler: ^(FBRequestConnection *connection, 
                                  NSDictionary<FBGraphUser> *my,
                                  NSError *error) {
    self.label.text = my.first_name;
}];
} 
```

到

```
if(session.isOpen) {   
        FBRequest *me = [FBRequest requestForMe];
        [me startWithCompletionHandler:^(FBRequestConnection *connection,
                                         id result,
                                         NSError *error) {
            NSDictionary<FBGraphUser> *my = (NSDictionary<FBGraphUser> *) result;
           NSLog(@"My dictionary: %@", my.first_name);
        }];
    } 
```

# google-app-engine - AppEngine cpm_usd 更改

> ID：12273248
> 
> 赞同：3
> 
> 时间：2012-09-05T01:04:11.613
> 
> 标签：google-app-engine

AppEngine 在其日志中有一个名为`cpm_usd`. 据我了解，这是 1000 次此类请求的大致成本（以美元计）。

自 2012 年 8 月 16 日以来，这些数字对于我的应用程序（我没有更改我的应用程序）来说明显更小（因子 500）。我想知道这是关于什么的？

谷歌改变了他们计算这些成本的方式吗？

是否包括前端时间，还是仅包括对数据存储等服务的调用？

我唯一的答案是他们停止在计算中包括前端时间（我目前仍处于开发模式，因此积累了大量可能会扭曲原始/旧结果的空闲时间）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T02:46:41.323

我不确定为什么您的数字发生了变化，但我的理解是，从去年的定价变化开始，这个数字不再相关。

大约在您的数字发生变化时，Google 正在向 AppStats 工具添加成本跟踪功能。您现在可以做的是在 AppStats 中打开定价指标，并准确了解您的请求的 RPC 成本（这几乎涵盖了除实例小时数之外的所有成本）。

对我的一个应用程序上的一些请求进行快速测试表明，cpm_usd 和 AppStats 报告的成本根本不符合要求。根据 cpm_usd 为我刚刚测试的请求报告的数字，该数字不可能包含数据存储成本，这意味着它对我来说基本上没用。

查看 AppStats 可以提供的成本跟踪，看看您自己的数字是如何排列的：

*   [https://developers.google.com/appengine/docs/java/tools/appstats#cost](https://developers.google.com/appengine/docs/java/tools/appstats#cost)

**2012 年 9 月 5 日更新**：我在最近的 App Engine 办公时间视频群聊中询问了 cpm_usd 的当前相关性，虽然他们无法给出确切答案，但他们表示他们认为这仍然是一个相关数字。最好能更深入地了解 cpm_usd 当前代表的内容。这是艾米回答问题的录音：

*   [https://www.youtube.com/watch?v=W-YBnWdllfI&feature=player_detailpage#t=3127s](https://www.youtube.com/watch?v=W-YBnWdllfI&feature=player_detailpage#t=3127s)

# c++ - c++11 按值捕获 lambda 产生错误值

> ID：12273249
> 
> 赞同：2
> 
> 时间：2012-09-05T01:04:41.753
> 
> 标签：c++, c++11

我正在尝试将 lambda 存储在涉及多层间接的对象系统中。我正在使用 g++ 4.7.1。

根据我构造（等效）对象的精确程度，lambda 可能有也可能没有正确的值。

代码：

```
#include <iostream>
#include <functional> // used for std::function

using namespace std; // TODO nope

typedef function<int()> intf;

struct SaveLambda {
    const intf func;
    SaveLambda(const intf& _func) : func(_func) {}  
};

struct StoreSaved {
    const SaveLambda* child;
    StoreSaved(const SaveLambda& _child) : child(&_child) {
        cout << "Before returning parent: " <<  child->func() << endl;
    }
};

int main() {
    const int ten = 10;

    auto S = SaveLambda([ten](){return ten;});
    cout << "No indirection: " << S.func() << endl << endl;

    auto saved = StoreSaved(S);
    cout << "Indirection, saved: " << saved.child->func() << endl << endl;

    auto temps = StoreSaved ( SaveLambda([ten](){cout << "&ten: "<< &ten << endl; return ten;}) );
    cout << "***** what. *****" << endl;
    cout << "Indirection, unsaved: " << temps.child->func() << endl;
    cout << "***** what. *****" << endl << endl;

    cout << "ten still lives: " << ten << endl;
} 
```

编译为`g++ -std=c++11 -Wall -o itest itest.cpp`并运行：注意一行输出具有不同的值。

我究竟做错了什么？我假设按价值捕获将按价值捕获。（最令人不安的是，StoreSaved（第 15 行）中的打印产生了*正确*的值，这与第 34 行不同，尽管它们都指的是同一个对象。唯一的区别是添加了另一层间接。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T01:09:11.300

这是错误的：

```
auto temps = StoreSaved(
                /* This temporary value dies at the last semicolon! */
                SaveLambda([ten](){cout << "&ten: "<< &ten << endl; return ten;})
                ); 
```

`StoreSaved`然后有一个指向不存在对象的指针。使用它是UB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T04:39:21.557

正如其他人已经指出的那样，问题在于`temps`您以指向不存在的`SaveLambda`结构的指针结尾，因为它是临时的。

您可以使用 StoreSaved 中的 SaveLambda 结构而不是指针来保留副本：

```
struct StoreSaved {
   const SaveLambda child;
   StoreSaved(const SaveLambda& _child) : child(_child) {
       cout << "Before returning parent: " <<  child.func() << endl;
   }
}; 
```

您还必须更改所有`child->func()`to `child.func()`，因为您不再处理指针。

# apache - Apache 与 JKMount 和别名

> ID：12273251
> 
> 赞同：1
> 
> 时间：2012-09-05T01:05:52.503
> 
> 标签：apache

我目前对 JKMount 和 Alias 的 apache 配置有问题。

我用 JKMount 挂载了我的应用程序

```
 JkMount /app1/*.jsp app1
    JkMount /app1/* app1 
```

我的本地文件系统上有一些静态图像。

如果 url 像[http://testapp.com/app1/capture/testImg.jpg](http://testapp.com/app1/capture/testImg.jpg)那么我必须从我的 C:/capture/testImg.jpg 提供图像。

为此，我使用 AliasMatch

```
AliasMatch /app1/capture/(.*)$ C:/capture/img/$1 
```

这里的问题是我不能将 AliasMatch 与 JKMount 一起使用。

如果我评论 JKMount 部分，那么我可以访问图像。但我的应用程序不工作。

如果我取消注释 JKMount 部分，我的应用程序正在运行，但我无法访问图像。

这是我在 httpd.conf 中的配置

```
 NameVirtualHost testapp.com
   <VirtualHost testapp.com:80> 
        ServerName testapp.com
    DocumentRoot "Z:\TestApp\app1\src\main\webapp\public"
    AliasMatch /app1/capture/(.*)$ C:/capture/img/$1 
    #<Directory C:/capture/img/>
    #   Order Deny,Allow
    #   Allow from all
    #</Directory>
    RewriteEngine on   
        RewriteRule ^/(.*) http://testapp.com/$1 [R=301,L]
    JkMount /app1/*.jsp app1
        JkMount /app1/* app1

    <Directory  C:/capture/img/>
    Order Allow,Deny
    Allow from all
    </Directory>

       ErrorLog "z:\logs\apache_error_log"
       CustomLog "z:\logs\log_custom" combined
    </VirtualHost> 
```

任何人都可以帮我解决上述问题

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T02:01:20.840

我已经阅读了 Apache Tomcat 文档。

[http://tomcat.apache.org/connectors-doc/webserver_howto/printer/apache.html](http://tomcat.apache.org/connectors-doc/webserver_howto/printer/apache.html)

当 jk 和 alias/userdir URL 匹配时，您可以使用 no-jk env var 来解决 mod_alias 或 mod_userdir 指令的问题。

所以我的新 httpd.config 看起来像这样

```
NameVirtualHost testapp.com
<VirtualHost testapp.com:80> 
    ServerName testapp.com
    DocumentRoot "Z:\TestApp\app1\src\main\webapp\public"
    #AliasMatch /app1/capture/(.*)$ C:/capture/img/$1 

    RewriteEngine on   
    RewriteRule ^/(.*) http://testapp.com/$1 [R=301,L]
    SetEnvIf Request_URI "/app1/capture/*" no-jk
    Alias /app1/capture/ C:/capture/img/

    <Directory  C:/capture/img/>
        Order Allow,Deny
        Allow from all
    </Directory>

     JkMount /app1/*.jsp app1
     JkMount /app1/* app1

   ErrorLog "z:\logs\apache_error_log"
   CustomLog "z:\logs\log_custom" combined
</VirtualHost> 
```

一切对我来说都很好。

# string - SAS：如果字符串中的第一个单词等于另一个变量中的单词，如何删除它

> ID：12273252
> 
> 赞同：1
> 
> 时间：2012-09-05T01:06:08.203
> 
> 标签：string, word, sas

我有`variable1`字符串，例如`"asdfsad What do you do", "qwer What is your name", "Zebra"`

和`variable2`字符串`"asdfsad", "qwer", "Animal"`

我想从 variable1 中的字符串中删除第一个单词，如果它等于`variable2`. 到目前为止，我唯一能想到的就是分别替换每个单词：

即`variable1=tranwrd(variable1, "asdfsad", "");`等。但是我有很多词要替换。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:46:46.047

像这样的东西怎么样：

```
data sample;
  length variable1 variable2 $100;
  variable1= "asdfsad What do you do"; variable2 = "asdfsad"; output;
  variable1= "qwer What is your name"; variable2 = "qwer";    output;
  variable1= "Zebra"                 ; variable2 = "Animal";  output;
run;

data fixed;
  length first_word $100;

  set sample;

  first_word = scan(variable1,1);
  if first_word eq variable2 then do;
    start_pos = length(first_word) + 1;
    variable1 = substr(variable1,start_pos); 
  end;
run; 
```

这将适用于匹配整个第一个单词。它会在剩余文本中留下空格或其他标点符号，但如果您愿意，您应该能够轻松更改。

如果您的问题是逐个字符匹配而不是在整个第一个单词上匹配，那么这将是一个非常不同的问题，我建议您发布一个新问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:13:38.483

如果您对 tranwrd 的结果感到满意，您也可以使用它。你只需要注意空格

```
variable1 = strip(tranwrd(variable1, strip(variable2), '')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T10:21:24.400

```
if scan(variable1,1)=variable2 then
  variable1=substr(variable1,index(variable1," ")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T08:20:22.553

对于数千个单词，这可能不会有效或不可行，但您可以使用 Perl 正则表达式（例如`s/search/replacement/`）通过[`prxchange`](http://support.sas.com/documentation/cdl/en/lefunctionsref/63354/HTML/default/viewer.htm#n0r8h2fa8djqf1n1cnenrvm573br.htm)

```
/* words to match delimited by "|" */
%let words = asdfsad|qwer|Animal|foo|bar|horse;

/* example data */
data example;
  infile datalines dlm=',' dsd;
  input string: $256.;
datalines;
asdfsad What do you do
qwer What is your name
Zebra
food is in the fridge
foo    A horse entered a bar
;
run;

/* cleaned data */
data example_clean;
  set example;

  /*
    regular expression is:
      - created once on first row (_n_ = 1)
      - cached (retain regex)
      - dropped at the end (drop regex).
  */
  if _n_ = 1 then do;
    retain regex;
    drop regex;
    regex = prxparse("s/^(&words)\s+//");
  end;

  string = prxchange(regex, 1, string);  /* apply the regex (once) */
run; 
```

正则`^`表达式中的符号`prxparse`（构造在不匹配）。`|``\s+`

# apache - 从 https 子目录重定向到单独的 https 域

> ID：12273254
> 
> 赞同：0
> 
> 时间：2012-09-05T01:06:28.100
> 
> 标签：apache, .htaccess, webserver

我正在尝试通过 apache 2 conf 指令或 .htaccess 执行以下操作。

两个站点：1) www.myfirstsite.com 2) www.my99thsite.com

我想以以下方式重定向，但我不确定证书和重定向到底需要发生什么：

当用户访问[https://www.myfirstsite.com/mysubdir](https://www.myfirstsite.com/mysubdir)时，我想将他重定向到[https://www.my99thsite.com](https://www.my99thsite.com)。

mysubdir 只是一个空目录。

谢谢-

-KR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:17:38.800

尝试这个

```
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^([^\.]+[^/]) https://www.my99thsite.com [R] 
```

这将检查目录是否存在。如果它会重定向到[https://www.my99thsite.com](https://www.my99thsite.com)。这应该在您的 www.myfirstsite.com .htaccess 中

# php - 在 Mac 上使用 Pear 的 PHP 代码嗅探器和 MAMP Pro

> ID：12273255
> 
> 赞同：2
> 
> 时间：2012-09-05T01:06:58.163
> 
> 标签：php, macos, pear, mamp, codesniffer

我想寻求一些帮助来正确设置 Pear 的 PHP 代码嗅探器。

我在带有 PHP 5.3.6 的 Mac PB 10.7.4 上使用 MAMP pro 2.0.5。我确实安装了 Pear 并且可以运行 pear 命令，当我安装 PHP_CodeSniffer 通道时，我没有收到任何错误，但我无法触发任何命令。

这是我的命令行的屏幕截图： [https ://skitch.com/stephanief0042/etuck/alohamediaworks-bash-100x40](https://skitch.com/stephanief0042/etuck/alohamediaworks-bash-100x40)

我可以参考这篇文章： [Putting PEARs php_dir into include_path in php.ini](https://stackoverflow.com/questions/5831136/putting-pears-php-dir-into-include-path-in-php-ini)

但我的包含路径似乎是正确的： include_path = ".:/Applications/MAMP/bin/php/php5.3.6/lib/php:/Applications/MAMP/bin/php/php5.3.6/bin/pear"

当我追踪到 PHPCS 安装的路径时，我发现它是这个路径上的可执行文件：Users/alohamediaworks/pear/bin/phpcs

我不确定我是否是能够使用它的一个符号链接，欢迎任何帮助或建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T06:03:30.397

PEAR 会将诸如 PHPCS 之类的 bin 文件安装到可配置的位置。您可以通过运行来查看此位置`pear config-show | grep bin_dir`。

这里的值大概是目前`/Users/alohamediaworks/pear/bin`

您可能只想将其设置为`/Applications/MAMP/bin`Mac 上的本地位置或某个位置，例如`/usr/local/bin`.

在执行此操作之前，值得卸载 PHP_CodeSniffer，并检查 PEAR 是否通过运行`pear config-show | grep php_bin`.

我假设这两个值都需要改变：

```
pear uninstall PHP_CodeSniffer
pear config-set bin_dir /Applications/MAMP/bin/php/php5.3.6/bin
pear config-set bin_dir /Applications/MAMP/bin
pear install PHP_CodeSniffer 
```

（首先检查路径是否有效并且您没有更友好的符号链接版本）

您需要正确的 php_bin，因为 PEAR 会更改 #! 安装时所有 bin 文件（如 phpcs）的行以指向您的 PHP 可执行文件。bin_dir 对于确保将 bin 文件放入路径中的目录很重要。需要卸载 PHP_CodeSniffer，以免遗留旧文件（PEAR 不会移动它们）。

希望有帮助。

# c# - RestSharp：转换结果

> ID：12273256
> 
> 赞同：1
> 
> 时间：2012-09-05T01:07:07.467
> 
> 标签：c#, json, restsharp

我得到以下 JSON，我试图使用 RestSharp 将其转换为业务对象

```
 {
  "valid":true,
  "data":[
    {
       "dealerId":"4373",
       "branchId":"4373",
    }
  ]
  } 
```

我希望转换为：

```
public class Dealer
{
    public string dealerId ;
    public string branchId;
   } 
```

但这失败了，尽管 JSON 很好：

```
 var client = new RestClient("http://www.????.com.au");
        var request = new RestRequest(string.Format("service/autocomplete/dealer/{0}/{1}.json", suburb.PostCode, suburb.City.Trim().Replace(" ", "%20")), Method.GET);
        var response2 = client.Execute<Dealer>(request);
        return response2.Data; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:26:35.813

您的业​​务对象与您返回的响应 JSON 不匹配。如果您希望您的响应序列化，您的 C# 对象将类似于

```
public class DealerResponse
{
    public bool valid { get;set; }
    List<Dealer> data { get;set; }
}

public class Dealer
{
    public string dealerId;         
    public string branchId;   
} 
```

我没有测试过这段代码，但即使您只对“数据”中的信息感兴趣，您的响应 C# 对象仍然需要表示整个 JSON 响应才能正确序列化。

希望有帮助。

# jquery - 一个项目上的两个框架 jQuery 和 Prototype。

> ID：12273257
> 
> 赞同：0
> 
> 时间：2012-09-05T01:07:15.667
> 
> 标签：jquery, frameworks, prototype

目前支持一个包含两个框架的项目......

因此，对于这两种都有经验的人有一个问题：

1.  拥有这两个框架的任何优点和缺点，例如 jQuery 不能做什么，而 Prototype 可以？
2.  方法覆盖？我是否会遇到一种方法调用两个框架的情况:)
3.  建议

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:12:39.190

1.  优点：你喜欢这样做并且拥有两个框架。缺点：两个框架，所以一个客户端 javascript 线程可以做更多的事情
2.  Jquery 使用 $ 或 jQuery，Prototype 使用 Prototype - 不应该遇到麻烦 - 除非您尝试混合这些对象或其他东西。
3.  只使用一个框架，除非你有非常非常特殊的理由同时使用两者。我可能只使用 jQuery - 尽管您可以选择。

# java - 在添加 JFrame 事件处理程序之前滞后？

> ID：12273258
> 
> 赞同：1
> 
> 时间：2012-09-05T01:07:28.943
> 
> 标签：java, swing, netbeans, concurrency, event-dispatch-thread

我正在做一个简单的 Java swing 项目。这是主类的代码（名称已更改）：

```
public class MainProg
{
    private static MainProg program; 

    //mainWin is a JFrame
    private MainWindow mainWin;

    //Event handler class which extends MouseAdapter
    private TrayManager trayMgr;

    public static void main(String[] args)
    {                
        program = new MainProg();
    }

    public MainProg()
    {
        mainWin = new MainWindow();
        trayMgr = new TrayManager();

        mainWin.startBtn.addMouseListener(trayMgr);

        mainWin.setVisible(true);
    }
} 
```

很明显，当程序启动时，`main()`它会创建一个类的新实例`MainProg`，然后调用构造函数。在构造函数中，它创建了 JFrame 的一个新实例`mainWin`。然后它将事件处理程序附加到`mainWin`.

在事件处理程序类`trayMgr`中，唯一的方法是`mouseClicked()`除了`System.out.println('Clicked');`

问题是，当我在 Netbeans 中运行该程序时，会立即显示 JFrame，但我似乎必须单击按钮 2-3 次才能在控制台中打印消息。

这只是 Netbeans 特有的，还是我必须更改某些内容才能在窗口可见之前设置事件处理程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:07:34.650

您的线程问题不太可能导致您当前的问题，但理论上存在问题的可能性，而且我已经看到一些与一些更敏感的外观和感觉相关的实际问题。很简单，您应该将启动 GUI 的代码排入 Swing 事件线程。你这样做：

```
public void main(String[] args) {
  SwingUtilities.invokeLater(new Runnable(
    public void run() {
      program = new MainProg();
    }
  ));
} 
```

其他人建议使用`invokeAndWait(...)`而不是，`invokeLater(...)`但这可能会有风险，特别是如果您无意中从 Swing 事件线程本身进行了此调用。对于您的情况，您最好使用`invokeLater(...)`.

但同样，我认为您显示的代码的主要问题是不恰当地使用 MouseListener，而应该使用 ActionListener。学习编写任何 GUI 库的代码可能非常棘手，因此，您不能假设任何事情。查看教程并向专家学习。此外，如果您正在考虑长期编写 Swing 代码，请考虑放弃 NetBean 的代码生成实用程序，并首先学习手动编写 Swing 代码。你不会后悔这样做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T01:37:22.120

既然你问了，我在这里发布的代码是关于不同主题[的 Java SSCCE 。](https://stackoverflow.com/questions/10901352/navigating-between-multiple-panels/10902184#10902184)`invokeLater`是在 EDT 上运行计算的一种方式。（还有`invokeAndWait`，在这里可以正常工作，但在某些其他情况下可能会导致死锁。）

事实上，这个例子可能有点过于保守了。一些参考资料说您可以从调用`show()`或的主线程运行 Swing `setVisible()`。但是，当我尝试时，我有一个在 Java 7 下行为不端的程序。

# python - numpy 中的一维到二维数组

> ID：12273262
> 
> 赞同：1
> 
> 时间：2012-09-05T01:08:00.783
> 
> 标签：python, numpy

我在 numpy 中有一个一维数组，其形状为 (761,)，每个条目是一个 10 元组，其元素我无法独立访问。数据类型是

array1.dtype

```
dtype([('Name', '|S58'), ('Category', '|S32'), ('HQLocation', '|S34'),
       ('YearFounded', '<i8'), ('Latitude', '<f8'), ('Longitude', '<f8'), 
       ('TotalFundingAmount', '<i8'), ('LastFundingAmount', '<i8'), 
       ('Investors', '<i8'), ('NGrams', '|S98')]) 
```

示例行是 array1[578]

```
('"FoxyP2, Inc."', 'Education', '"Cuajimalpa, Mexico"', 2006, 19.3547, 
 -99.3001, 55317213, 42999977, 3, 
 'english;learning;reinvent;experience;english learning') 
```

我试图将其制成一个形状为 (761,10) 的二维数组，同时保留列名和数据类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T10:50:49.133

It's just impossible with your input, as the different columns don't have the same type: some of them are strings, some are floats, some integers.

NumPy arrays are homogeneous, meaning that **all** entries must have the same data type. This data type can be simple (`int`, `float`, ...) or complicated (like a tuple whose first element is a `"|S58"`, whose fourth is a `int`, whose fifth is a `float`...), but in any case, all the entries have the same type. You can get more information in the documentation, [here](http://docs.scipy.org/doc/numpy-1.6.0/user/basics.types.html) and [here](http://docs.scipy.org/doc/numpy-1.6.0/user/basics.rec.html#structured-arrays).

But why do you need a 2D array? You can access and manipulate each column independently with indexing (eg, `your_array[YearFounded]` will return your fourth column)...

# php - 有没有执行sql的函数？具体由 CakeSchema 生成的 sql？

> ID：12273267
> 
> 赞同：1
> 
> 时间：2012-09-05T01:08:31.697
> 
> 标签：php, sql, cakephp

有没有执行mysql的函数？具体是由 CakeSchema 生成的 mysql？

这是我要导入的数据的示例：

```
 $this->Schema = new CakeSchema();
    $Schema = $this->Schema->load();
    $db = ConnectionManager::getDataSource($this->Schema->connection);
    $contents = "\n\n" . $db->createSchema($Schema); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:26:44.490

如果它实际上是 MySQL，那么只需使用 query()

```
$this->MyModel->query("CREATE TABLE ...."); 
```

因为它可能并不真正适合您的一个模型，所以您总是可以制作一个“DataFunction”模型并告诉它`$useTable = false;`......然后将任何/所有这些“通用”函数存储在那里。然后加载模型并从您想要的任何操作中调用您的函数。

# c# - 异步方法不需要额外的线程？

> ID：12273268
> 
> 赞同：4
> 
> 时间：2012-09-05T01:08:37.427
> 
> 标签：c#, .net, async-await

在 MSDN 中有这样一段话：

> async 和 await 关键字不会导致创建额外的线程。异步方法不需要多线程，因为异步方法不在其自己的线程上运行。**该方法在当前同步上下文上运行，并且仅在该方法处于活动状态时才使用线程上的时间。**您可以使用 Task.Run 将受 CPU 限制的工作转移到后台线程，但后台线程对等待结果可用的进程没有帮助。

但看起来我需要更多关于粗体文本的帮助，因为我不确定它的确切含义。那么它怎么会变成`async`不使用`Threads`呢？

来源：http: [//msdn.microsoft.com/en-us/library/hh191443.aspx](http://msdn.microsoft.com/en-us/library/hh191443.aspx)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T01:12:42.077

有许多异步操作不需要使用多个线程。诸如异步 IO 之类的事情是通过在数据可用时发出信号的[中断来工作的。](http://en.wikipedia.org/wiki/Asynchronous_I/O#Signals_.28interrupts.29)这允许您进行不使用额外线程的异步调用 - 当信号发生时，操作完成。

`Task.Run`可用于创建自己的基于 CPU 的异步方法，这些方法将在自己的单独线程上运行。然而，该段落旨在表明这不是*唯一*的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T01:20:17.220

async/await 不仅仅是使用更多线程。这是关于更有效地使用您拥有的线程。当操作阻塞时，例如等待下载或文件读取，异步/等待模式允许您将现有线程用于其他事情。编译器处理所有底层的神奇管道，使其更容易开发。

有关问题描述和白皮书，请参见[http://msdn.microsoft.com/en-us/magazine/hh456401.aspx ，网址为](http://msdn.microsoft.com/en-us/magazine/hh456401.aspx)[http://www.microsoft.com/en-us/download/details.aspx?id= 14058](http://www.microsoft.com/en-us/download/details.aspx?id=14058) .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T01:25:07.353

不是 async 和 await 关键字本身生成的代码，不。他们创建在当前线程上运行的代码，假设它具有同步上下文。如果没有，那么您实际上确实获得了线程，但这是没有充分理由使用该模式。*await 表达式*，您在 await 关键字右侧编写的内容会导致线程运行。

但是那个线程通常是不可观察的，它可能是一个设备驱动线程。它报告它是通过 I/O 完成端口完成的。很常见，I/O 始终是使用 await 的好理由。如果 WinRT 还没有强迫您，那么添加 async/await 的真正原因。

关于“具有同步上下文”的说明。如果 SynchronizationContext.Current 属性不为空，则线程上有一个。这几乎只发生在 gui 应用程序的主线程上。也是您通常担心延迟不会冻结您的用户界面的唯一地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T01:16:02.747

`async`本质上，当您运行一个方法而不调用它时，它所做的是`await`：

1.  启动该方法并尽可能同步执行。

2.  必要时，暂停该方法并将其其余部分继续。

3.  当异步部分完成（不再等待）时，安排继续在同一个线程上运行。

4.  你想要的任何东西都可以在这个线程上正常运行。您甚至可以检查/操作`Task`从异步方法返回的内容。

5.  当线程可用时，它将运行您的方法的其余部分。

“异步部分”可以是文件 IO、Web 请求或几乎任何东西，只要调用代码可以等待此任务完成即可。这包括但不限于单独的线程。正如 Reed Copsey 所指出的，还有其他方法可以执行异步操作，例如中断。

# sql - 使用 IF 条件在 MS Access 中插入行

> ID：12273279
> 
> 赞同：0
> 
> 时间：2012-09-05T01:10:47.223
> 
> 标签：sql, database, ms-access, ms-access-2007, vba

我有一年中每天的每小时数据（24 小时）。没有数据时会丢失一些小时。当缺少数据时，我需要插入一个值为零的行，以确保每个日期都有 24 小时的数据。我正在使用 Access 并使用 SQL 处理 VBAcode。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:40:54.087

像这样的事情会花费你的时间，并且每次检查它是否存在

```
Dim rs As Recordset
Dim datetime As Date
Dim stopdatetime As Date

Set rs = CurrentDb.OpenRecordset("MyData", dbOpenDynaset)

datetime = DateSerial(2011, 1, 1) + TimeSerial(9, 0, 0)
' #1/1/2011 @ 9AM
stopdatetime = DateSerial(2012, 1, 1)
' #1/1/2012 @ Midnight

While datetime < stopdatetime
    rs.FindFirst "MyDateTimeField=" & datetime ' formatting may be required
    If rs.NoMatch Then 
        'nomatch is true when time is not found, so add the missing record
        rs.AddNew
        rs!MyDateTimeField = datetime
        rs!Otherfileds = 0
        rs.Update
    End If
    datetime = datetime + TimeSerial(1, 0, 0)
    'add an hour
Wend 
```

# sed - 尝试从 Nmap 输出中提取部分

> ID：12273280
> 
> 赞同：1
> 
> 时间：2012-09-05T01:11:29.393
> 
> 标签：sed, awk, nmap

我有一些来自 Nmap 扫描的数据。它看起来像这样。

```
Nmap scan report for 10.16.17.34
Host is up (0.011s latency).
Not shown: 65530 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
23/tcp   open  telnet
80/tcp   open  http
| http-headers: 
|   Date: THU, 30 AUG 2012 22:46:11 GMT
|   Expires: THU, 30 AUG 2012 22:46:11 GMT
|   Content-type: text/html
|   
|_  (Request type: GET)
443/tcp  open  https
| ssl-enum-ciphers: 
|   SSLv3
|     Ciphers (11)
|       TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA - unknown strength
|       TLS_RSA_EXPORT1024_WITH_RC4_56_SHA - unknown strength
|       TLS_RSA_EXPORT_WITH_DES40_CBC_SHA - unknown strength
|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - unknown strength
|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - unknown strength
|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - strong
|       TLS_RSA_WITH_AES_128_CBC_SHA - strong
|       TLS_RSA_WITH_AES_256_CBC_SHA - unknown strength
|       TLS_RSA_WITH_DES_CBC_SHA - unknown strength
|       TLS_RSA_WITH_RC4_128_MD5 - unknown strength
|       TLS_RSA_WITH_RC4_128_SHA - strong
|   TLSv1.0
|     Ciphers (10)
|       TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA - unknown strength
|       TLS_RSA_EXPORT1024_WITH_RC4_56_SHA - unknown strength
|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - unknown strength
|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - unknown strength
|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - strong
|       TLS_RSA_WITH_AES_128_CBC_SHA - strong
|       TLS_RSA_WITH_AES_256_CBC_SHA - unknown strength
|       TLS_RSA_WITH_DES_CBC_SHA - unknown strength
|       TLS_RSA_WITH_RC4_128_MD5 - unknown strength
|       TLS_RSA_WITH_RC4_128_SHA - strong
|     Compressors (1)
|       NULL
|_  Least strength = unknown strength
2023/tcp open  xinuexpansion3

Nmap scan report for 10.16.40.0
Host is up (0.00062s latency).
All 65535 scanned ports on 10.16.40.0 are closed

Nmap scan report for 10.16.40.1
Host is up (0.00071s latency).
All 65535 scanned ports on 10.16.40.1 are closed 
```

我正在尝试做的是使用 Awk、Sed 或 Grep 或其他东西来提取任何以 Nmap Scan 开头并以空白新行结尾并包含 ssl-enum-ciphers 的部分。我用 Awk 想出了如何打印每个部分，但我无法检查 ssl 行。我对此不以为然。
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:24:51.447

你所拥有的是空行分隔的记录。您可以使用`awk`检查您的 ssl-enum-ciphers：

```
awk -v RS='' '/ssl-enum-ciphers/' file.txt 
```

* * *

这将检查记录是否不包含短语“host down”：

```
awk -v RS='' '/ssl-enum-ciphers/ && !/host down/' file.txt 
```

您可以通过将字段分隔符更改为换行符来使其更加严格：

```
awk 'BEGIN { RS=""; FS="\n" } /ssl-enum-ciphers/ && $1 !~ /host down/' file.txt 
```

* * *

在记录之间添加一些换行符：

```
awk 'BEGIN { RS=""; FS="\n" } /ssl-enum-ciphers/ && $1 !~ /host down/ { printf "%s\n\n", $0 }' file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T14:46:38.737

处理 Nmap 文本输出非常棘手且充满危险，因为它可能会随着版本的变化而变化。要解析 Nmap 输出，请使用带有or参数的[XML 输出。](http://nmap.org/book/output-formats-xml-output.html)然后使用 XML 解析库或实用程序来提取您需要的信息。`-oX``-oA`

对于您的示例，使用[xmlstarlet](http://xmlstar.sourceforge.net/)提取`host`包含属性设置为“ssl-enum-ciphers”的`script`元素的元素。`id`此示例将输出目标的 IP 地址，然后是`ssl-enum-ciphers`脚本的输出：

```
xmlstarlet sel -t -m '//script[@id="ssl-enum-ciphers"]' \
-v '../../../address[@addrtype="ipv4"]/@addr' -v '@output' output.xml 
```

在 Nmap 的下一个版本中，脚本输出本身将被进一步分解为 XML 结构，从而更容易执行诸如仅输出使用中的弱密码列表之类的操作。

# excel - 打开包含多列的 Excel

> ID：12273290
> 
> 赞同：0
> 
> 时间：2012-09-05T01:13:03.650
> 
> 标签：excel, multiple-columns

基本上，我有一个想要打开的 Excel 2003 电子表格。但是，它给出了错误，因为它有太多的列。

打开此 Excel 文件以查看整个数据的方法是什么？

PS。我也安装了 Excel 2010，但无法打开该文件。

附加信息：Excel 文件是使用 SSRS -> Export to Excel 创建的。The number of columns in the report varies and when large report range is chosen, it will have "too many" columns.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:34:28.213

If you have more than 256 columns you won't be able to use versions of Excel prior to 2007.

It sounds like you're exporting to a pre-2007 workbook (xls) with more than that number.

in 2007+ you can have around 16 thousand columns.

This page has details about how to export to a 2007+ file format (xlsx):

[http://msdn.microsoft.com/en-us/library/dd255234(v=sql.110).aspx](http://msdn.microsoft.com/en-us/library/dd255234(v=sql.110).aspx)

**Note** I think your SQL server may need to be a certain version to use the 2007+ excel renderer, but I have little experience there.

# cassandra - Cassandra Hector 客户端：使用随机分区时是否可以在复合行键上使用 RangeSlicesQuery？

> ID：12273293
> 
> 赞同：4
> 
> 时间：2012-09-05T01:13:19.450
> 
> 标签：cassandra, range, composite, hector, composite-primary-key

使用随机分区时，有没有办法使用复合行键来范围查询行？

我正在使用通过 CQL v3 创建的列族，如下所示：

```
CREATE TABLE products ( rowkey CompositeType(UTF8Type,UTF8Type,UTF8Type,UTF8Type) 
PRIMARY KEY, prod_id varchar, class_id varchar, date varchar); 
```

表中的数据如下所示：

```
RowKey: 6:3:2:19
=> (column=class_id, value=254, timestamp=1346800102625002)
=> (column=date, value=2034, timestamp=1346800102625000)
=> (column=prod_id, value=1922, timestamp=1346800102625001)
-------------------
RowKey: 0:14:1:16
=> (column=class_id, value=144, timestamp=1346797896819002)
=> (column=date, value=234, timestamp=1346797896819000)
=> (column=prod_id, value=4322, timestamp=1346797896819001)
------------------- 
```

我试图找到一种方法来对这些复合行键进行范围查询，类似于我们如何对复合列进行切片查询。根据我选择的开始和停止键，以下方法有时实际上会成功返回有用的东西。

```
Composite startKey = new Composite();
startKey.addComponent(0, "3", Composite.ComponentEquality.EQUAL);
startKey.addComponent(1, "3", Composite.ComponentEquality.EQUAL);
startKey.addComponent(2, "3", Composite.ComponentEquality.EQUAL);
startKey.addComponent(3, "3", Composite.ComponentEquality.EQUAL);
Composite stopKey = new Composite();
stopKey.addComponent(0, "6", Composite.ComponentEquality.EQUAL);
stopKey.addComponent(1, "6", Composite.ComponentEquality.EQUAL);
stopKey.addComponent(2, "6", Composite.ComponentEquality.EQUAL);
stopKey.addComponent(3, "6" , Composite.ComponentEquality.GREATER_THAN_EQUAL);

RangeSlicesQuery<Composite, String, String> rangeSlicesQuery = 
HFactory.createRangeSlicesQuery(keyspace, CompositeSerializer.get(), StringSerializer.get(), StringSerializer.get());
rangeSlicesQuery.setColumnFamily(columnFamilyName);
rangeSlicesQuery.setKeys(startKey,stopKey);
rangeSlicesQuery.setRange("", "", false, 3); 
```

大多数情况下，数据库会返回：

```
InvalidRequestException(why:start key's md5 sorts after end key's md5.
this is not allowed; you probably should not specify end key at all,
under RandomPartitioner) 
```

有人知道是否可以在不使用顺序保留分区器的情况下实现这样的事情吗？我是否必须为此用例构建自定义行键索引？

非常感谢！

* * *

**附加信息：**

我想要做的是将销售交易数据存储在一个表中，该表使用复合行键来编码日期/时间/地点和复合列来存储有关已售商品的信息：

每笔交易的物品集大小不一，包括有关每件物品的尺寸、颜色和数量的信息：

```
{ ... items :
[ { item_id : 43523 , size : 050 , color : 123 , qty : 1 } ,
  { item_id : 64233 , size : 048 , color : 834 , qty : 1 } ,
  { item_id : 23984 , size : 000 , color : 341 , qty : 3 } ,
… ] } 
```

还有关于交易发生地点和时间的信息，包括唯一的交易 ID：

```
{ trx_id : 23324827346, store_id : 8934 , date : 20110303 , time : 0947 , … 
```

我最初的方法是将每个项目放在单独的行中，并让应用程序通过事务 ID 将项目重新组合在一起。这工作正常。但是现在我正在尝试利用复合列的结构化功能将嵌套的项目数据保留在这样的表示（每个项目）中：

```
item_id:’size’ = <value> ; item_id:’color’ = <value> ; item_id:’qty’ = <value> ; …
43523:size = 050 ; 43523:color = 123 ; 43523:qty = 1 ; … 
```

其余数据将被编码为复合行键，如下所示：

```
date : time : store_id : trx_id
20110303 : 0947 : 001 : 23324827346 
```

我需要能够运行以下查询：在 20110301 和 20110310 之间在 1200 和 1400 之间在 25 - 50 号商店中销售的所有商品。到目前为止，我使用复合列实现的是每家商店使用一个宽行并将所有其余数据为每个项目 3 个不同的复合列：

```
date:time:<type>:prod_id:transaction_id = <value> ; …
20110303:0947:size:43523:23324827346 = 050 ;
20110303:0947:color:43523:23324827346 = 123 ;
20110303:0947:qty:43523:23324827346 = 1 ; 
```

它正在工作，但看起来效率并不高。还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T14:13:10.537

您正在为每个分区创建一行，因此应该清楚 RandomPartitioner 不会为您提供有序范围查询。

您可以*在*一个分区内执行有序范围，这很常见，例如[http://rubyscale.com/blog/2011/03/06/basic-time-series-with-cassandra/](http://rubyscale.com/blog/2011/03/06/basic-time-series-with-cassandra/)和[http://www.datastax。 com/dev/blog/advanced-time-series-with-cassandra](http://www.datastax.com/dev/blog/advanced-time-series-with-cassandra)

# c# - yield return 和 try-catch。（C#）

> ID：12273298
> 
> 赞同：3
> 
> 时间：2012-09-05T01:14:09.860
> 
> 标签：c#, return, try-catch, yield

我遇到了一个非常奇怪的问题。以下代码未按预期运行。

```
static IEnumerable<int> YieldFun()
{
    int[] numbers = new int[3] { 1, 2, 3 };

    if(numbers.Count()==3)
        throw new Exception("Test...");

    //This code continues even an exception was thrown above.
    foreach(int i in numbers)
    {
        if(i%2==1)
            yield return numbers[i];
    }
}

static void Main(string[] args)
{
    IEnumerable<int> result = null;
    try
    {
        result = YieldFun();
    }
    catch (System.Exception ex) //Cannot catch the exception
    {
        Console.WriteLine(ex.Message);
    }

    foreach (int i in result)
    {
        Console.Write(" " + i);
    }
} 
```

两个问题。首先，即使抛出异常，YieldFun 似乎也能继续工作。其次，调用者的 try-catch 块无法捕获抛出的异常。

为什么这个？以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T01:18:05.050

这是由迭代器的延迟执行引起的。您的异常比您想象的要晚抛出：`foreach (int i in result)`尝试迭代并抛出，但您没有在那里捕获异常。

在尝试迭代项目之前，不会执行函数的主体。所以仅仅调用这个函数实际上并没有达到“throw ...”语句。您可以手动迭代结果以查看引发异常的确切点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T01:34:13.277

您可以这样做以分离出延迟部分（包含`yield`导致构建迭代器的范围）....并在分配发生时执行您的检查。

```
static IEnumerable<int> YieldFun()
{
    int[] numbers = new int[3] { 1, 2, 3 };

    if (numbers.Count() == 3)
        throw new Exception("Test...");

    return YieldFunImpl(numbers);
}

static IEnumerable<int> YieldFunImpl(int []numbers)
{
    //This code continues even an exception was thrown above.
    foreach (int i in numbers)
    {
        if (i % 2 == 1)
            yield return numbers[i];
    }
}

static void Main(string[] args)
{
    IEnumerable<int> result = null;
    try
    {
        result = YieldFun();
    }
    catch (System.Exception ex) //Cannot catch the exception
    {
        Console.WriteLine(ex.Message);
    }

    if (result != null)
    {
        foreach (int i in result)
        {
            Console.Write(" " + i);
        }
    }
} 
```

}

当异常消失时（因为您的 Count() == 3）....您的 catch 将被调用，并且您`result`将不会被设置....所以当 for 循环尝试迭代结果时...它将be `null`....您需要添加一个空检查。

# c# - 在 Java 中使用 DirectX 快速截屏（从 C# 中的现有代码重写为 Java）

> ID：12273300
> 
> 赞同：5
> 
> 时间：2012-09-05T01:14:37.940
> 
> 标签：c#, java, directx, rewrite, screenshot

我的目标是**在 Java 中使用 DirectX 捕获屏幕**。我发现该项目非常详细，并在 C# 中进行了[解释。](http://www.codeproject.com/Articles/274461/Very-fast-screen-capture-using-DirectX-in-Csharp)

不幸的是，我对升 C 语言一无所知。我不知道我是否可以在这里向那些处理这两种语言的人询问上面提到的从 C# 到 Java 的重写代码，但我想最终结果会引起很多人的兴趣。

无论如何，我提前感谢那些愿意帮助我的人。即使我从未尝试过，我也知道不建议使用 C# -> Java 转换软件（或任何其他语言），这解释了我的***重写***问题。

请在下面的相关代码中找到：

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using SlimDX.Direct3D9;

namespace KMPP
{
public class DxScreenCapture
{
    Device d;

    public DxScreenCapture()
    {
        PresentParameters present_params = new PresentParameters();
        present_params.Windowed = true;
        present_params.SwapEffect = SwapEffect.Discard;
        d = new Device(new Direct3D(), 0, DeviceType.Hardware, IntPtr.Zero, CreateFlags.SoftwareVertexProcessing, present_params);
    }

    public Surface CaptureScreen()
    {
        Surface s = Surface.CreateOffscreenPlain(d, Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, Format.A8R8G8B8, Pool.Scratch);
        d.GetFrontBufferData(0, s);
        return s;
    }
}
} 
```

* * *

PS：由于*Surface s*在这里是 DirectX 类型的图像，然后将其转换为 PNG 对我来说会很有趣。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-05T01:45:20.017

## Java 不是 C#

C# 与 java 完全不同。C# 可以使用`DirectX`但 java 不能使用它，因为 DirectX 在所有平台上都不可用。相反，您可以使用包中`Robot`存在的类`java.awt`。以下是如何获取`image`.

## 用机器人做

```
Dimension ss = Toolkit.getDefaultToolkit().getScreenSize();
Robot r = new Robot();
BufferedImage s = r.createScreenCapture(new Rectangle(ss)); 
```

它返回一个`BufferedImage`包含屏幕截图的内容。

# nhibernate - NHibernate 二级缓存不返回对象

> ID：12273302
> 
> 赞同：0
> 
> 时间：2012-09-05T01:14:59.267
> 
> 标签：nhibernate, caching, stored-procedures

我正在使用存储过程进行简单的 2 级缓存实验，并且收到表或视图不存在 Oracle 错误。

缓存正在检索我的 DTO 对象并尝试向数据库发出 SQL 语句。我猜这是一些配置错误。

这是 app.config

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
<session-factory name="NHibernate.Test">
  <property name="connection.driver_class">NHibernate.Driver.OracleDataClientDriver</property>
  <property name="show_sql">true</property>
  <property name="dialect">NHibernate.Dialect.Oracle10gDialect</property>
  <property name="query.substitutions">true 1, false 0, yes 'Y', no 'N'</property>
  <property name="cache.use_query_cache">true</property>
  <property name="cache.use_second_level_cache">true</property>
  <property name="cache.provider_class">NHibernate.Caches.SysCache.SysCacheProvider, NHibernate.Caches.SysCache</property>
</session-factory>
</hibernate-configuration> 
```

下面是要测试的代码： [TestMethod] public void GetNomHeaderInfo_TestingCache_BPNomHeaderShouldBeCached() { //Arrange DateTime StartTime; 日期时间结束时间；时间跨度第一次尝试；时间跨度第二次尝试；

```
 //Act
    using (var session = factory.OpenSession())
    {
        var query = session.GetNamedQuery("GetMyDTO");
        query.SetInt32("id", 1);
        query.SetCacheRegion("Id");
        query.SetCacheMode(CacheMode.Normal);
        query.SetCacheable(true);
        StartTime = DateTime.Now;
        myDTO DTO = query.UniqueResult<myDTO>();
        EndTime = DateTime.Now;
        FirstTry = EndTime - StartTime;
    }

    using (var session = factory.OpenSession())
    {
        var query = session.GetNamedQuery("GetMyDTO");
        query.SetInt32("id", 1);
        query.SetCacheRegion("Id");
        query.SetCacheMode(CacheMode.Normal);
        query.SetCacheable(true);
        StartTime = DateTime.Now;
        myDTO DTO = query.UniqueResult<myDTO>();
        EndTime = DateTime.Now;
        SecondTry = EndTime - StartTime;
    }

    //Test
    Assert.IsTrue(SecondTry < FirstTry);
} 
```

然后我在执行第二个查询时出错。UniqueResult(); 错误信息是：

```
SELECT blah blah_.blahblah, etc FROM MyDTO SomeAlias_ WHERE SomeAlias_.id=:p0 
```

但是没有 myDTO 表或视图。我不知道为什么 NHibernate 会认为从缓存 myDTO 中提取然后尝试创建 SQL 语句。

这是跟踪：

```
NHibernate.Cache.StandardQueryCache: DEBUG checking cached query results in region: 'Id'; sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}
NHibernate.Cache.StandardQueryCache: DEBUG checking cached query results in region: 'Id'; sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}
NHibernate.Caches.SysCache.SysCache: DEBUG Fetching object 'NHibernate-Cache:nomId:sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}@601355831' from the cache.
NHibernate.Caches.SysCache.SysCache: DEBUG Fetching object 'NHibernate-Cache:nomId:sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}@601355831' from the cache.
NHibernate.Cache.StandardQueryCache: DEBUG Checking query spaces for up-to-dateness [MyDTO]
NHibernate.Cache.StandardQueryCache: DEBUG Checking query spaces for up-to-dateness [MyDTO]
NHibernate.Caches.SysCache.SysCache: DEBUG Fetching object 'NHibernate-Cache:UpdateTimestampsCache:MyDTO@1270222867' from the cache.
NHibernate.Caches.SysCache.SysCache: DEBUG Fetching object 'NHibernate-Cache:UpdateTimestampsCache:MyDTO@1270222867' from the cache.
NHibernate.Cache.StandardQueryCache: DEBUG returning cached query results for: sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}
NHibernate.Cache.StandardQueryCache: DEBUG returning cached query results for: sql: { call SomePackage.MyProc(?) }; parameters: []; named parameters: {'id'='1'}
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG loading entity: [MyAssembly.MyDTO#1]
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG loading entity: [MyAssembly.MyDTO#1]
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG attempting to resolve: [MyAssembly.MyDTO#1]
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG attempting to resolve: [MyAssembly.MyDTO#1]
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG object not resolved in any cache: [MyAssembly.MyDTO#1]
NHibernate.Event.Default.DefaultLoadEventListener: DEBUG object not resolved in any cache: [MyAssembly.MyDTO#1]
NHibernate.Persister.Entity.AbstractEntityPersister: DEBUG Fetching entity: [MyAssembly.MyDTO#1]
NHibernate.Persister.Entity.AbstractEntityPersister: DEBUG Fetching entity: [MyAssembly.MyDTO#1]
NHibernate.Loader.Loader: DEBUG loading entity: [MyAssembly.MyDTO#1]
NHibernate.Loader.Loader: DEBUG loading entity: [MyAssembly.MyDTO#1]
NHibernate.AdoNet.AbstractBatcher: DEBUG Opened new IDbCommand, open IDbCommands: 1
NHibernate.AdoNet.AbstractBatcher: DEBUG Opened new IDbCommand, open IDbCommands: 1
NHibernate.AdoNet.AbstractBatcher: DEBUG Building an IDbCommand object for the SqlString: SELECT blah blah_.blahblah, etc FROM MyDTO SomeAlias_ WHERE SomeAlias_.id=:p0 
```

有人知道我在这里做错了什么吗？

谢谢，比尔 N

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:53:23.997

我看不到你的映射，但这里有一个解释。

*   您正在缓存查询结果，但不是您的实体（这些是单独的缓存）
*   缓存查询的结果只存储 ID；如果您也没有缓存实体，则会发出查询以加载每个返回的实体（这通常很糟糕）
*   MyDTO 类的默认表名是 MyDTO，这就是它要查找的位置
*   这看起来像一个 Query by ID，您不应该使用松散的命名查询，而是使用适当的查询`loader`（参见[17.4\. Custom SQL for loading](http://nhibernate.info/doc/nh/en/index.html#querysql-load)）。

一旦您设置了加载器和*实体*缓存，您就可以使用 just 检索您的对象`session.Get<MyDTO>(id)`，这将使用二级缓存，只要您在事务中完成所有工作，这是推荐的做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T13:09:25.730

对不起 Diego，你想看看我的映射是什么样子的可能是正确的。一旦我添加：

```
<cache usage="read-write"/> 
```

到 hbm.xml 文件一切正常。

# ruby-on-rails - 使用 Google Content API for Shopping 进行身份验证时遇到问题

> ID：12273305
> 
> 赞同：3
> 
> 时间：2012-09-05T01:15:54.103
> 
> 标签：ruby-on-rails, google-api, oauth-2.0

我正在尝试使用google [-api-client gem](http://code.google.com/p/google-api-ruby-client/)和 Ruby on Rails 3.2.5将[OAuth2 for Server to Server Applications](https://developers.google.com/accounts/docs/OAuth2ServiceAccount#libraries)与[Google 的 Content API for Shopping结合使用。](https://developers.google.com/shopping-content/)此外，我已经按照 Content API 文档中的规定设置了我的商家帐户。

这是我发现能够做到的最好方法：

*   在后台创建/更新产品
*   已创建属于我公司的 Google 产品“保护伞”的产品
*   不要求每个用户在其令牌过期时进行身份验证/授权

使用[此示例](http://code.google.com/p/google-api-ruby-client/source/browse/service_account/analytics.rb?repo=samples)中的第 1 - 23 行作为起点，我已经开始编写以下模块以用于后台作业：

```
require 'httparty'
require 'google/api_client'

module GoogleProducts
  GOOGLE_CONFIG = YAML.load_file(File.join(Rails.root, "config", "google.yml"))[Rails.env]

  CLIENT_ID = "XXXXXXXXXXXX@developer.gserviceaccount.com"
  MERCHANT_ID = "XXXXXXX"
  SCOPE = "https://www.googleapis.com/auth/structuredcontent"

  KEY_FILE_PATH = File.join(Rails.root, "config", "my-privatekey.p12")
  KEY_FILE_PASS = "XXXXXXXXXX"

  def self.add_item(item_id)
    self.fetch_token
    xml = self.gen_item_xml(item_id)
    headers = {"Content-type" => "application/atom+xml", "Content-Length" => xml.length.to_s}
    url = "https://content.googleapis.com/content/v1/#{MERCHANT_ID}/items/products/generic?access_token=#{$gp_token}"

    response = HTTParty.post(url, :body => xml, :headers => headers).parsed_response
  end

  def self.gen_item_xml(item_id)
    #building product xml
  end

  private
  def self.fetch_token
    api_client = Google::APIClient.new(:authorization => :oauth2)
    key = Google::APIClient::PKCS12.load_key(KEY_FILE_PATH, KEY_FILE_PASS)
    asserter = Google::APIClient::JWTAsserter.new(CLIENT_ID, SCOPE, key)

    begin
      api_client.authorization = asserter.authorize

      #todo - store in something other than a global
      $gp_token = api_client.authorization.access_token
    rescue Signet::AuthorizationError => e
      puts e.message
    ensure
      return $gp_token
    end
  end
end 
```

一切似乎都工作正常 - 身份验证，身份验证令牌的处理 - 直到我尝试实际添加一个项目，当我这样做时我得到以下信息：

```
<errors xmlns='http://schemas.google.com/g/2005'>
  <error>
    <domain>GData</domain>
    <code>ServiceForbiddenException</code>
    <internalReason>Could not find authenticated customer</internalReason>
  </error>
</errors> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T21:35:23.403

经过一番苦恼和脑力劳动，我终于解决了我的问题！

由于我使用的是[**OAuth 2 服务器到服务器身份验证**](https://developers.google.com/accounts/docs/OAuth2ServiceAccount#libraries)，因此 hjblok 给出的建议并不适用（不过，感谢您试一试！）。

我只是将与我的服务帐户密钥相关联的电子邮件地址从 Google API 控制台（例如`XXXXXXXXXXXX@developer.gserviceaccount.com`）添加到我的 Google Merchant 帐户（`Settings > Users`在商家管理页面上），并且它起作用了。

如果有任何需要澄清的地方，请随时发表评论！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:06:53.697

Google Content API 文档说您需要在 Google Merchant Center 的设置页面中进行设置：

[https://developers.google.com/shopping-content/getting-started/usingapi-products](https://developers.google.com/shopping-content/getting-started/usingapi-products)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T07:53:28.233

**EDIT**在深入了解 Google 的 API 文档后重写了答案

您是否已经尝试使用 Google 的[OAuth 2.0 Playground](https://developers.google.com/oauthplayground/)？我能够成功访问`https://content.googleapis.com/content/v1/#{MERCHANT_ID}/items/products/generic`.

1.  在“第 1 步”中，我选择了“Content API for Shopping”，然后使用我的帐户授权 API。
2.  然后在“第 2 步”中，我“为令牌交换了授权码”，这会产生一个“刷新令牌”和一个“访问令牌”。
3.  然后在“第 3 步”中，我调用了`GET`对`https://content.googleapis.com/content/v1/1234567/items/products/generic`. 因为`1234567`不是有效的`MERCHANT_ID`，所以它返回一个错误。但是错误消息包含一个`MERCHANT_ID`实际上属于您的帐户的内容。
4.  我重复了“第 3 步”，但现在使用了正确的`MERCHANT_ID`. 它在正文中返回`HTTP/1.1 200 OK`带有请求项目的 a。

此外，我不确定，但 Google API 不希望 Authorization 标头与`access_token`（`$gp_token`）一起出现吗？在[OAuth 2.0 Playground](https://developers.google.com/oauthplayground/)中，此 Authorization 标头用于发送`access_token`.

我还找到了结构化内容 API 演示页面 (https://google-content-api-tools.appspot.com/demo/demo.html)，它更具体地适用于 Content API for Shopping。

# php - 在不同页面中使用 php session 变量

> ID：12273311
> 
> 赞同：0
> 
> 时间：2012-09-05T01:16:55.037
> 
> 标签：php

我在 php 页面“session1.php”中创建了一个会话变量，如下所示

```
<?php
session_start();
$_SESSION['name']="piklu";
?> 
```

现在我想访问另一个页面中的会话值说'session2.php'。我需要建议。我在“session2.php”中所做的如下。

```
<?php
include('session1.php');
echo $_SESSION['name'];
?> 
```

上面的代码有效，但仅当 session1.php 和 session2.php 不包含任何 html 标签时。如果是，则“session1.php”中的所有 html 标签将被复制到“session2.php”。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T01:19:13.757

您不需要包括所有`session1.php`. 相反，只需`session_start()`在`session2.php`.

# firefox-addon - XMLHttpRequest() 在最新版本的 Firefox 中不起作用？

> ID：12273313
> 
> 赞同：-1
> 
> 时间：2012-09-05T01:17:05.257
> 
> 标签：firefox-addon, browser-addons

在我的插件中，我总是使用 new XMLHttpRequest () 并且它运行良好。现在所有请求 ajax 停止工作。

目前新的 XMLHttpRequest() 导致以下错误：ReferenceError: XMLHttpRequest is not defined

所以我将代码更改为：

```
try {
    var XMLHttpRequest;
    if (typeof(XMLHttpRequest) == "undefined")
        XMLHttpRequest = content.XMLHttpRequest;
}
catch (e) {
    alert(e);
}
var xmlhttp = new XMLHttpRequest();
... 
```

有时请求通常有效，但有时无效。

代码“alert(e);” 永远不会执行，那么那里就没有错误。

我不明白为什么有时它有效，有时无效。以前我只使用过*var xmlhttp = new XMLHttpRequest();* 并且一直在工作。

现在如何创建一个新的 ajax 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T07:32:03.047

正如我在评论中所说，当您在浏览器窗口的上下文中运行时（例如由覆盖加载到该窗口的代码），那么`XMLHttpRequest`绝对应该可用。我验证了以防万一，它对我有用。

但万一其他一切都失败了，您仍然可以直接实例化与 XMLHttpRequest 对应的 XPCOM 组件：

```
var xmlhttp = Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"]
                        .createInstance(Components.interfaces.nsIXMLHttpRequest);
xmlhttp.open(...); 
```

# php - Phpass - 如何根据数据库中的用户名和密码哈希检查登录用户名和密码

> ID：12273314
> 
> 赞同：2
> 
> 时间：2012-09-05T01:17:18.610
> 
> 标签：php, mysql, database, hash, phpass

我已经成功地使用 Phpass 对注册用户的密码进行哈希处理并将它们存储在数据库中，现在我被困在登录上，如何检查汇总的用户名和密码，检查用户名是否存在于数据库中，然后根据给定的密码检查哈希密码。

非常感谢任何帮助！！！谢谢！

这是我的代码：

```
<?php

// Inialize session
session_start();

// Include database connection settings
include('config.inc');

require("PasswordHash.php");
$hasher = new PasswordHash(8, false);

$username = $_POST['username'];
$password = $_POST['password'];

// Passwords should never be longer than 72 characters to prevent DoS attacks
if (strlen($password) > 72) { die("Password must be 72 characters or less"); }

$query = "SELECT * FROM user WHERE username = '$username'";

$query = mysql_query($query);
$numrows = mysql_num_rows($query);

if ($numrows = 1) {

$res = mysql_query("SELECT password FROM user WHERE username = '$username'"); 
$row = mysql_fetch_array($res); 
$hash = $row['password']; 
$password = $_POST['password'];

if ($hasher->CheckPassword($password, $hash)) { //$hash is the hash retrieved from the      DB 
        $what = 'Authentication succeeded';
    } else {
        $what = 'Authentication failed';
    }

} else {

 echo "No Such User";
include 'login.php';
exit();
}

echo "$what\n";
echo "<br />";
echo "$hash";

?> 
```

这是我为他人谋福利的工作准则：

```
<?php

// Inialize session
session_start();

// Include database connection settings
include('config.inc');

require("PasswordHash.php");
$hasher = new PasswordHash(8, false);

$username = $_POST['username'];
$password = $_POST['password'];

// Passwords should never be longer than 72 characters to prevent DoS attacks
if (strlen($password) > 72) { die("Password must be 72 characters or less"); }

$query = "SELECT * FROM user WHERE username = '$username'";

$query = mysql_query($query);
$numrows = mysql_num_rows($query);

if ($numrows = 1) {

$res = mysql_query("SELECT * FROM user WHERE username = '$username'"); 
$row = mysql_fetch_array($res); 
$hash = $row['password']; 
$password = $_POST['password'];

if ($hasher->CheckPassword($password, $hash)) { //$hash is the hash retrieved from the      DB 
        $what = 'Authentication succeeded';
    } else {
        $what = 'Authentication failed';
    }

} else {

 echo "No Such User";
include 'login.php';
exit();
}

echo "$what\n";
echo "<br />";
echo "$hash";

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:50:49.140

以下是[phpass](http://www.openwall.com/phpass/)的工作原理：当您保存用户密码（当他们创建密码时）时，您在保存之前对其进行哈希处理，如下所示：

```
$hash_iterations = 30;
$portable_hashes = FALSE;
$hasher = new PasswordHash($hash_iterations, $portable_hashes);
$hash_value = $hasher->HashPassword($actual_password); 
```

然后保存`$hash_value`在数据库中作为用户的密码。当您去验证用户时，按用户名查找用户。如果找到，将数据库中的实际密码（存储的散列）与用户输入的散列进行比较：

```
// $stored_hash is the value you saved in the database for this user's password
// $user_input is the POST data from the user with the actual password
$valid_password = $hasher->CheckPassword($user_input, $stored_hash); 
```

确保`PasswordHash`每次都以相同的方式初始化类，并使用相同的值`$hash_iterations`和`$portable_hashes`，否则比较将无法正常工作。

# haskell - 如何使用仅显示警告的 cabal 构建重新编译 Haskell

> ID：12273315
> 
> 赞同：13
> 
> 时间：2012-09-05T01:17:26.907
> 
> 标签：haskell, cabal

当我`cabal build`我的项目时，警告（尤其是`-Wall`）只在第一次显示。

在后续构建中，所有内容都被缓存。

**我想再次查看我的项目的所有警告。**

我可以`cabal clean`重新**编译**或使用`cabal build --ghc-options="-fforce-recomp"`，但这**需要的时间太长了**。

如何**尽可能快地**进行警告检查？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-05T01:17:26.907

**我可以通过约 10 倍跳过代码生成**来加快编译速度：

`cabal build --ghc-options="-fforce-recomp -fno-code"`

* * *

对于仅检查单个文件，您可以使用[ghc-mod](http://hackage.haskell.org/package/ghc-mod) : `ghc-mod check -g -Wall file.hs`。

# jquery - jQuery 输入触发器实时更改

> ID：12273317
> 
> 赞同：0
> 
> 时间：2012-09-05T01:17:47.690
> 
> 标签：jquery, input, triggers, live

当我单击单选按钮时，我成功地执行了更改，但问题是，当我重新加载页面时，单选按钮选择被保留，但更改不是。换句话说，如果我单击单选按钮 #1，它将降低某些字段的不透明度。当我回到这个页面时，所有的字段都是完全不透明的，直到我再次单击单选按钮，它才会执行这个机会。

这是我的代码：

```
(function($) {

    // Document Ready
    $(document).ready(function() {

        // trigger change on the radio list to show selected field
        $('#acf-feature_slide ul.radio_list li label input').trigger('change');

    });

    // Content Type change
    $('#acf-feature_slide ul.radio_list li label input').live('change', function() {

        // vars
        var value = $(this).val();

        // show the selected field
        if( value == "internal" ) {
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(3).css('opacity', '1.0');
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(4).css('opacity', '0.2');
        }
        else if( value == "external" ) {
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(3).css('opacity', '0.2');
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(4).css('opacity', '1.0');
        }
        else if( value == "none" ) {
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(3).css('opacity', '0.2');
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(4).css('opacity', '0.2');
        }
        else {
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(3).css('opacity', '1.0');
            $(this).parentsUntil('tr').find('div.row-layout-field').eq(4).css('opacity', '1.0');
        }

    });

})(jQuery); 
```

任何帮助是极大的赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:20:03.287

某些浏览器会保留您在重新加载时为某些按钮选择的选项（*不保证*始终工作或在每个浏览器上工作），但绝对不会保留触发事件等内容。换句话说，您需要以两种方式中的一种（或两种方式）存储您的单选按钮选择和不透明度选择，以便它们在重新加载时持续存在 1.）HTML5 localStorage（不建议为此使用cookie）2）服务器端。

您当前的代码不存储任何内容 - 您很幸运，您的浏览器碰巧在重新加载时保留了您的单选按钮选择。

**编辑：**所以你没有对单选按钮感到幸运......非常好！如果您可以确定单选按钮在重新加载时保持选中状态，那么是的，您可以验证它是否被选中。

假设您确切地知道要验证的单选按钮的 id - 并且您想知道它是否被选中。在您的文档加载时执行此操作： $('#myradiobutton').is(':checked'); 如果未选中将返回 false，如果选中则返回 true。然后你可以用 if 语句说

```
if( $('#myradiobutton').is(':checked') ){
   dothis();
} 
```

# macos - Mac OSX 提示 git 分支感知

> ID：12273319
> 
> 赞同：5
> 
> 时间：2012-09-05T01:18:18.857
> 
> 标签：macos, git, bash, command-prompt

我一直在玩我的主目录中的 .profile 文件，以便在提示符上显示 git 分支，并显示我当前所在的 rvm gemset 和 python 虚拟环境......大部分工作正常，我的问题我的优点是，为了根据分支的状态以不同的颜色显示分支，我每次都必须执行 source ~/.profile ，我也必须这样做才能在 CYAN 中显示 python virtualenv。

必须有一种方式或我缺少的东西，这样我就不必每次进入不同的文件夹时都运行 source ~/.profile ，以便分支颜色基于状态。

这是我的 .profile

[https://gist.github.com/3628788](https://gist.github.com/3628788)

感谢您帮助解决这个问题！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T02:07:09.643

使用 PROMPT_COMMAND 变量定义一个函数，`PS1`在每个命令之后设置你的。把它放在你的 .profile 文件的底部，代替分配给`PS1`：

```
prompt_cmd () {
    PS1="${PYTHON_VIRTUALENV}$PURPLE\$(set_rvm_prompt)$NO_COLOUR\u@\h:[\W]${B_STATE}\$(parse_git_branch)$NO_COLOUR\$ "
}

PROMPT_COMMAND=prompt_cmd 
```

现在，在显示提示之前，`bash`将执行函数，根据、和`prompt_cmd`更新`PS1`最新信息。`PYTHON_VIRTUALENV``set_rvm_prompt()``parse_git_branch()`

# c# - 如何在 WPF DataGrid 单元格中获取鼠标悬停单元格的行和列？

> ID：12273322
> 
> 赞同：1
> 
> 时间：2012-09-05T01:18:58.563
> 
> 标签：c#, wpf, datagrid

我正在使用 WPF 数据网格。我希望能够检测到我的鼠标当前悬停在哪个单元格（行和索引）上，然后设置焦点/突出显示该单元格。我能够找到有关如何查找行和索引的本[教程，但它似乎真的很复杂。](http://www.scottlogic.co.uk/blog/colin/2008/12/wpf-datagrid-detecting-clicked-cell-and-row/)还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-05T06:04:09.127

覆盖 DataGridCell 模板，然后重新设计它。比较简单，只需要为 IsMouseOver 添加新的触发器即可。

# prism - 跨 AppDomain 事件问题

> ID：12273323
> 
> 赞同：0
> 
> 时间：2012-09-05T01:19:00.433
> 
> 标签：prism, appdomain, marshalbyrefobject, pos-for-.net

我在 .Net 的 POS 中使用以下帮助程序类来获取对单独 AppDomain 中硬件的引用（绕过一些限制要求`<NetFx40_LegacySecurityPolicy enabled="true"/>`

```
public static class PosHelper
{
    private static AppDomain _posAppDomain { get; set; }

    private static AppDomain PosAppDomain
    {
        get
        {
            if (_posAppDomain == null)
            {
                AppDomainSetup currentAppDomainSetup = AppDomain.CurrentDomain.SetupInformation;
                AppDomainSetup newAppDomainSetup = new AppDomainSetup()
                {
                    ApplicationBase = currentAppDomainSetup.ApplicationBase,
                    LoaderOptimization = currentAppDomainSetup.LoaderOptimization,
                    ConfigurationFile = currentAppDomainSetup.ConfigurationFile
                };
                newAppDomainSetup.SetCompatibilitySwitches(new[] { "NetFx40_LegacySecurityPolicy" });

                _posAppDomain = AppDomain.CreateDomain("POS Hardware AppDomain", null, newAppDomainSetup);
            }
            return _posAppDomain;
        }
    }

    public static T GetHardware<T>() where T : PosHardware, new()
    {
        T hardware = (T)PosAppDomain.CreateInstanceFromAndUnwrap(Assembly.GetAssembly(typeof(T)).Location, typeof(T).FullName);

        hardware.FindAndOpenDevice();
        return hardware;
    }
} 
```

当 POS 扫描仪扫描数据时，我有一个基本类要处理。在该课程中，我有一个要在扫描数据时触发的事件。这是一个片段：

```
public class ScannerDevice : PosHardware
{
    public event Action<string> DataScanned;
    ...
        _scanner.DataEvent += new DataEventHandler(Scanner_DataEvent);
    ...
    private void Scanner_DataEvent(object sender, DataEventArgs e)
    {
        ASCIIEncoding encoder = new ASCIIEncoding();

        if (DataScanned != null)
            DataScanned(encoder.GetString(_scanner.ScanDataLabel));

        _scanner.DataEventEnabled = true; // enable for subsequent scans
    } 
```

请注意，PosHardware 抽象类继承`MarshalByRefObject`并标记`[Serializable]` 在我的主 AppDomain 中，我尝试像这样使用事件：

```
 Scanner = PosHelper.GetHardware<ScannerDevice>();
    Scanner.DataScanned += m =>
    {
        Debug.WriteLine(m);
    }; 
```

当它遇到尝试将 lambda 添加到 DataScanned 事件的行时，我收到此错误：

> 无法加载文件或程序集“MyAssemlyName，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

这必须与尝试在 AppDomain 之间进行通信有关。不太确定该怎么做。我是否需要在用于 Pos for .Net 的单独 AppDomain 中注册“MyAssemblyName”？

我使用棱镜，所以一些模块在运行时加载（在我的输出目录的子文件夹中）......包括我使用上面最后一个代码片段的那个（Scanner = PosHelper.GetHardware ....）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:32:08.713

I believe I solved my problem. Since my prism modules are loaded at runtime within a subdirectory I needed to add this to the AppDomain so that the AppDomain could find the assemblies in the subdirectories folder.:

```
PrivateBinPath = @"Modules" 
```

[http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpath.aspx](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.privatebinpath.aspx)

**Edit**

This only partially solved my problem. I also had to override InitializeLifetimeService() and return null so that my MarshalByRefObject's would not be disposed while the program is running (I believe the default timeout is 5 minutes).

Also , this now works:

```
Scanner.DataScanned += m =>
    {
        Debug.WriteLine(m);
    } 
```

but when I try something like this

```
Scanner.DataScanned += m =>
    {
        DoSomething(m);
    } 
```

Where DoSomething is not in a Serializable and MarshalByRefObject class, it craps out since all classes that are used in the communication between AppDomain's need to have those. So where I'm at now is looking at using WCF named pipes to pass data around... and other similar solutions.

# google-chrome-extension - 真的用 chrome.cookies.getAll 获取所有 cookie？

> ID：12273326
> 
> 赞同：4
> 
> 时间：2012-09-05T01:19:21.980
> 
> 标签：google-chrome-extension

我正在开发一个 chrome 扩展，我需要获取所有 cookie（至少在当前的 CookieStore 中）。第一遍，我用

```
chrome.cookies.getAll({}, function (cookies) {
    chrome.cookies.onChanged.addListener(function (changeInfo) {
        // do stuff with added/removed cookies here ...
    };

    // do stuff with all the original cookies here ...
}); 
```

但现在我认为这里可能存在一个缺陷：getAll 调用要求浏览器列出所有现有的 cookie。然后浏览器使用这些现有 cookie 的数组调用 getAll 回调。然后扩展注册以获取任何添加/删除/更改的 cookie 的更新。似乎浏览器在创建 cookie 数组之后（例如通过活动选项卡）但在 addListener 调用执行之前添加的任何 cookie 将丢失，直到更新。

有人对更好的方法有建议吗？

我开始查看 chrome 开发工具源代码以获取示例，但似乎 Resources > Cookies 表不使用此 API。

# vb.net - 如何在 foreach 循环中不处理任何内容

> ID：12273327
> 
> 赞同：2
> 
> 时间：2012-09-05T01:19:35.363
> 
> 标签：vb.net, foreach, nothing

我有以下功能：

```
 Public Sub performautowebrowserOperations()
    Try
        For Each link As HtmlElement In WebBrowser2.Document.GetElementsByTagName("input") 'sometimes throws a null reference exception
            If link.GetAttribute("value") IsNot Nothing Then
                If link.GetAttribute("value") = "Compare prices" Then
                    link.InvokeMember("click")
                End If
            End If
        Next
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
End Sub 
```

有时，注释行会引发 NullReferenceException。为什么，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:34:16.220

我会更改`GetElementsByTagName`它，使其位于 For Each 语句之外，这样可以更轻松地检查 Collection 是 Null 还是 Empty。

```
Public Sub performautowebrowserOperations()
    Try
        Dim elements As HtmlElementCollection = WebBrowser2.Document.GetElementsByTagName("input")
        If Not IsNothing(elements) And elements.Count > 0 Then
            For Each link As HtmlElement In elements
                If link.GetAttribute("value") IsNot Nothing Then
                    If link.GetAttribute("value") = "Compare prices" Then
                        link.InvokeMember("click")
                    End If
                End If
            Next
        End If
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
End Sub 
```

# c# - 在大型表单中管理 EventHandler

> ID：12273329
> 
> 赞同：0
> 
> 时间：2012-09-05T01:19:55.703
> 
> 标签：c#, winforms, event-handling, organization

我正在开发一个 WinForm 应用程序，到目前为止，我在管理大小和内容方面做得很糟糕。我希望有人能给我一个例子，说明如何打破我在主表单 cs 文件中的一些逻辑。

这是我在 MainWindow.cs 中的 EventHandler 函数的示例：

```
 private void GroupBoxRequestTypeCheckedChanged(object pSender, EventArgs pEventArgs)
    {
        RadioButton vRadioButton = pSender as RadioButton;

        if (vRadioButton != null)
        {
            this.fSelectedButton = vRadioButton.Checked ? vRadioButton : null;

            if (vRadioButton.Equals(this.RadioButton_Copy) || vRadioButton.Equals(this.RadioButton_Delete) || vRadioButton.Equals(this.RadioButton_Download)
                || vRadioButton.Equals(this.RadioButton_Move) || vRadioButton.Equals(this.RadioButton_Upload))
            {
                this.GroupBox_Files.Enabled = true;
                this.GroupBox_Variables.Enabled = false;
            }
            else
            {
                this.GroupBox_Files.Enabled = false;
                this.GroupBox_Variables.Enabled = true;
            }
            if (this.fSelectedButton != null)
            {
                if (this.fSelectedButton.Equals(this.RadioButton_Delete))
                {
                    this.TextBox_DestinationFile.Enabled = false;
                    this.Button_DestinationBrowse.Enabled = false;
                }
                else
                {
                    this.TextBox_DestinationFile.Enabled = true;
                    this.Button_DestinationBrowse.Enabled = true;
                }
            }
        }
    } 
```

所以这只是我在表单中拥有的众多 EventHandler 之一。我创建了一个 MainForm，它有一个选项卡式窗格，并且有一个选项卡集合，每个选项卡中都有按钮、文本框、复选框等。我处理的所有事件都进入 MainForm.cs 文件，现在这个文件中有近 1,000 行。

有人可以给我一个简单的例子（或文章/文档）详细说明良好的结构吗？我可以在一个单独的类中定义我的 EventHandler 函数吗（如果是这样，这将如何工作......）我是否创建某种静态 Helper 类，我只需传递我需要操作的对象的实例？IE

```
 private void GroupBoxRequestTypeCheckedChange(object pSender, EventArgs pEventArgs)
    {
        HelperClass.HandleGroupBoxRequestTypeCheckedChanged(pSender, pEventArgs, this);
    } 
```

'this' 是表单本身，它包含对我需要操作的对象的所有引用？

可能值得注意的是，我已经对跨线程调用有了一些了解，并且我已经开始为许多我需要的简单实例制作扩展方法。

另一个问题 - 我注意到可视化设计器默认情况下会自动将使用它创建的所有组件设为私有，将这些组件设置为内​​部组件并使用表单对象根据需要从类外部引用这些组件通常是个坏主意吗？如果这不是一个好主意，还有什么更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:54:33.710

首先，我建议将独立的用户界面部分分成用户控件或组件。然后 - 如果需要 - 使用事件连接它们（例如，您自己的专用事件和属性。

例如，您可以将主要内容（TabControl / Container）放置在 UserControl 中，并将该用户控件放置在主窗体中。所有选项卡/页面切换逻辑/UI 等都属于该用户控件。在该 UserControl 中，您可以定义例如您自己的事件，当用户切换选项卡时触发该事件。然后主窗体可以注册到这个事件 - 就像它可以注册其他 Winforms-control-events - 并做它的事情（例如，更改窗口标题以表示当前活动的选项卡）。

然后接下来您可以将每个选项卡的内容移动到它自己的用户控件中，并在您的新选项卡用户控件中使用这些用户控件。将逻辑下移到负责给定任务的 UserControl。

一些典型应用程序的表单/控件层次结构可能如下所示：

*   主窗体（窗体）
    *   MainTabContainerControl (用户控件)
    *   Page1Control（用户控件）
    *   Page2Control（用户控件）
        *   MyImprovedDbRowGridControl（用户控件或组件）
    *   Page3Control（用户控件）
    *   边栏控件（用户控件）
    *   搜索控件（用户控件）
        *   MyImprovedDbRowGridControl（用户控件或组件）
    *   快速帮助控件（用户控件）

接下来的事情就是让所有的 UI 事件处理程序尽可能小，并且只做 UI 的事情。将其他逻辑（如业务或数据访问逻辑）移至用户界面之外的其他类。

如果您在应用程序中有多次需要的控件组合：将它们移动到可重复使用的 UserControl。（例如面包屑）。

关于您的示例代码，您可以通过简化其逻辑使其更紧凑，因此可维护：

```
if (this.fSelectedButton.Equals(this.RadioButton_Delete))
{
    this.TextBox_DestinationFile.Enabled = false;
    this.Button_DestinationBrowse.Enabled = false;
}
else
{
    this.TextBox_DestinationFile.Enabled = true;
    this.Button_DestinationBrowse.Enabled = true;
} 
```

...可能：

```
 var delete = fSelectedButton == RadioButton_Delete;
    this.TextBox_DestinationFile.Enabled = !delete;
    this.Button_DestinationBrowse.Enabled = !delete; 
```

**更新：** 在重构和代码清理方面，一个非常有用的工具是[Resharper](http://www.jetbrains.com/resharper/) (R#)。我可以强烈推荐它。

希望这能给你一些从哪里开始的想法。

# iphone - 搜索后使用 TableView 滚动时隐藏键盘

> ID：12273334
> 
> 赞同：3
> 
> 时间：2012-09-05T01:20:21.087
> 
> 标签：iphone, ios, uitableview

我想在 TableView 上滚动时隐藏键盘。这意味着，我搜索一个项目并看到结果，当我在 TableView 上滚动时，键盘将隐藏或关闭。看看这张图片。

![在此处输入图像描述](../Images/2225448381d8d433602d54e5339b1824.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-05T04:17:14.733

您需要跟踪滚动 tableView 时运行的操作。`UITableView`是 的子类`UIScrollView`。因此，您可以使用`UIScrollViewDelegate`表中的所有方法。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
        [textfield resignFirstResponder];
} 
```

这将起作用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T01:27:09.833

在标题中设置滚动视图委托，然后在

```
- (void)scrollViewWillBeginDragging:(UIScrollView*)scrollview{
[self.textfield resignFirstResponder];} 
```

当他停止滚动

```
- (void)scrollViewDidEndDragging:(UIScrollView*)scrollview willDecelerate:YES{
//open keyboard back up} 
```

编辑：我的错，我混淆了滚动视图和表格视图。忽略那里的任何东西，我找不到任何可以解决您的问题的东西

# php - 如何通过 PHP 在 linux 中的共享文件夹之间共享或复制文件

> ID：12273343
> 
> 赞同：0
> 
> 时间：2012-09-05T01:22:26.750
> 
> 标签：php, file

我有一个非常艰巨的任务要完成。我们公司外部有一台专用服务器，公司内部也有两台服务器。我们需要通过 PHP 以编程方式将文件从服务器 1 复制到服务器 2，但这些文件位于 /home/server1/files 中，应该转到 /home/server2/files。

当用户根据某些标准选择 10 个文件进行分组时，这些文件必须发送到另一台服务器。

当我们只有一台服务器时，我们正在使用副本，一切都很好......但是现在，系统关闭了，因为我们有两台服务器......

使用一台服务器时，我可以使用它：

```
copy('/home/server/files/file.txt', '/home/server/files/group-1/file.txt'); 
```

现在它必须是：

```
copy('/home/server1/files/file.txt', '/home/server2/files/group-1/file.txt'); 
```

但我不知道如何通过服务器发送文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:43:14.683

在服务器之间复制文件有很多不同的方法。我可以想到以下几点：

1.  **通过 SSH 发送**。你可以使用[php 的 SCP 库](http://php.net/manual/en/function.ssh2-scp-send.php)

2.  **通过 SFTP 发送**。需要在 server2 上设置 FTP 服务器并更改代码以使用[ftp](http://php.net/ftp)。

3.  **[通过NFS](http://nfs.sourceforge.net/)****复制**。需要设置 NFS。一旦它是你可以将你的 server2 挂载到 /home/server2 并且希望不需要进行任何编程更改。

4.  **通过网络服务调用（REST 或 SOAP）发送**。需要在 server2 上设置代码以侦听文件发送。

# xcode4 - Rubymotion 要求 Xcode 4.x，但该版本已安装

> ID：12273344
> 
> 赞同：0
> 
> 时间：2012-09-05T01:22:37.980
> 
> 标签：xcode4, rake, rubymotion

我试图在 ruby​​motion 项目中运行 rake，他显示以下错误消息

> 错误！需要 Xcode 4.x 或更高版本

但是我的 Mac 上安装了 Xcode 4.3.2

我能做些什么？

PD：我安装了 Xcode 4.4.1，现在错误是这样的

```
 /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36: command not found: /Applications/Xcode 2.app/Contents/Developer/usr/bin/xcodebuild -version
     Build ./build/iPhoneSimulator-5.1-Development
sh: /Applications/Xcode: No such file or directory
sh: /Applications/Xcode: No such file or directory
sh: /Applications/Xcode: No such file or directory
   Compile ./app/app_delegate.rb
sh: /Applications/Xcode: No such file or directory
rake aborted!
Command failed with status (127): [/Applications/Xcode 2.app/Contents/Develop...]
Tasks: TOP => default => simulator => build:simulator
(See full trace by running task with --trace) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T10:02:40.703

也许您的系统上还安装了旧版本的 Xcode。从 RubyMotion 网站上的“入门”页面：

如果您在从 App Store 安装较新 Xcode 之前碰巧在您的机器上安装了较旧版本的 Xcode，您可能需要键入以下命令以正确设置默认 Xcode 路径。

```
$ sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer 
```

# r - 打开文件的独立于系统的方法

> ID：12273346
> 
> 赞同：0
> 
> 时间：2012-09-05T01:23:12.347
> 
> 标签：r

我想制作一个演示工具来为独立于操作系统的 R 用户加载文件。在我使用的 Windows 系统上，`shell.exec`但知道这对于 mac 和 Linux 是不一样的。我相信他们使用`system`但不知道如何使用，因为除了`shell.exec`. 这是迄今为止的功能：

```
open_file <- function(file.name) {
    if (Sys.info()["sysname"] == "Windows") {
        shell.exec(file.name)
    } else {
#insert linux and mac equiv here (I think they're the same)                                   
    }
} 
```

我可以在插入的 Linux 和 Mac OS X... 部分中添加什么以使其也可以在这些机器上运行？

编辑：在我的函数 shell.exec 中打开一个恰好是 docx 的文件，它使用 MS Word，但我希望这对于打开 txt csv xlsx 文件也是通用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-27T17:32:53.650

请注意，shell.exec() 是 R 的 Windows 版本中可用的函数，但在 MAC 版本中不可用。您可以使用以下代码来获得您想要的功能：

```
shell.exec  <- function(x)
{
      # replacement for shell.exe (doesn't exist on MAC)
      if (exists("shell.exec",where = "package:base"))
            return(base::shell.exec(x))
      comm <- paste("open",x)
      return(system(comm))
} 
```

`

这种方法的好处是它是透明的——在 Windows 机器上工作的代码将继续工作，现在也将在 Mac 机器上运行，只要文件类型是操作系统知道如何打开的东西。让它在 Unix 上工作也应该很简单。

# python - python在某些两个单词之间更改字符串

> ID：12273353
> 
> 赞同：2
> 
> 时间：2012-09-05T01:24:32.627
> 
> 标签：python, replace

我写了一个如下所示的脚本，我想 用另一个变量替换`StartNum`和之间的字符串。如何在 Python 中定义这两个字符串之间的位置？`/StartNum``n`

```
f1 = open('name.txt', 'r')
f2 = open('result.txt', 'w')
n=5000
for line in f1:
    f2.write(line.replace('(StartNum)(.*)(/StartNum)',str(n)))
    if "StartNum" in line:
        n=n+1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:35:22.397

```
import re
re.sub('(StartNum)(.*)(/StartNum)', r"\1boop\3", 'StartNumbworp/StartNum') 
```

这将替换`bworp`为`boop`，因此它返回的最终字符串是`StartNumboop/StartNum`。

# hibernate - Hibernate 中带有 where 子句的集合

> ID：12273357
> 
> 赞同：0
> 
> 时间：2012-09-05T01:25:09.650
> 
> 标签：hibernate

我的代码：

```
@Transactional
public List<Events> Read(long locationId) {
Session s = getSessionFactory().getCurrentSession();
Query q = s.createQuery("from events where locationId = :locationId");
q.setLong("locationId", locationId);
return q.list();
} 
```

我想知道上述方法或查询是否有任何问题？

我想在一对多的关系中使用它！

问题是，对于特定的 locationId，我可以有多个列，我需要在动态表中显示它们..我怎样才能实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T06:49:24.287

您应该使用以下查询：

```
select e.columnAttribute1, e.columnAttribute2 from Events e where e.locationId = :locationId 
```

from 子句中的事件应该是您的模型类名称。

# javascript - 如何在手机上显示1英寸的线？

> ID：12273358
> 
> 赞同：2
> 
> 时间：2012-09-05T01:25:10.347
> 
> 标签：javascript, android, css, ios, mobile-safari

我正在为汉堡店设计一个移动网站。他们有不同宽度的汉堡包，直径从 3 英寸到 3 英尺不等（不是开玩笑）。

当然，人们不希望“正常大小”的汉堡包有 10 英寸大（这是！），他们希望这里通常是 3-5 英寸。

所以我想做的是在屏幕上显示一两英寸（Android和iOS），在汉堡的图片下方显示一米。

如果可能的话，我不想构建一个移动应用程序，只是一个网页的“移动版”。

有任何想法吗？

# arrays - 我将如何完成这项任务-Matlab

> ID：12273359
> 
> 赞同：0
> 
> 时间：2012-09-05T01:25:49.263
> 
> 标签：arrays, matlab, for-loop, nested, element

> **可能重复：**
> [如何在 Matlab 中将嵌套 for 循环生成的值存储在数组中？](https://stackoverflow.com/questions/12272559/how-to-store-value-generated-from-nested-for-loop-in-an-array-in-matlab)

我有一个数字数组。例如 x = [4,9,8]。我用find(x)得到[1,2,3]，然后find(x)+length(x)得到[4,5,6]。

我希望这个（在这种情况下，将 3 添加到数组中，以生成 1,2,3 4,5,6 7,8,9...的序列）进行 n 次，所以我需要一个环形。

现在使用数组 x，我想将 [4,9,8] 添加到 [1,2,3] 中，得到 [5,11,11]。

我有 [1,2,3]...[10,11,12]...[n,n+1,n+2] 来自 find(x)+length(x) 循环，我想添加元素在 x 中对应位置的元素，在向上的数组中是三个。

因此，例如，[4,5,6] 5 位于位置 2。x=[4,9,8]。9 在 x 内的位置 2。因此，我想将 9 添加到 5。我想为每个元素（在本例中为三个元素中的每一个）执行此操作。我会将 9 加到 11 和 9 到 11，因为这两个数字在它们各自的数组中都位于位置“2”。

我正在考虑使用嵌套的 for 循环来处理 find(x)+length(x)。我只是不确定如何进行“位置添加”。

然后我想将添加的结果存储在一个单独的数组中。

提前感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T07:18:05.210

所以，我们从

```
x = [4,9,8] 
```

让我们添加`[1, 2, 3]`

```
x + [1, 2, 3]
ans =
     5    11    11 
```

更灵活的方式

```
x + (1 : length(x))
ans =
     5    11    11 
```

如果您不想从 1 开始，而是在`b`（例如，我们添加`[5, 6, 7]`到`x`）：

```
b = 5;
x + b + (0 : length(x) - 1)
ans =
     9    15    15 
```

我认为这应该让你继续前进，你现在可以添加你的循环。

**警告：**你有一种非常奇怪的使用方式`find()`。只是为了确保：`find(x)`返回非零条目的索引`x`。如果向量的所有元素`x`都不为零，则您有等式

```
find(x) == 1 : length(x) 
```

如果其中的任何元素`x`为零，则在将其添加到时会遇到问题`find(x)`：

```
x = [4, 9, 0, 8];
find(x)
ans =
     1     2     4

x + find(x)
Error using  + 
Matrix dimensions must agree. 
```

# php - 找不到意外的 '{'，期待 ',' 或 ';'

> ID：12273360
> 
> 赞同：0
> 
> 时间：2012-09-05T01:25:51.113
> 
> 标签：php, syntax

人们可以正常查看我的网站，但 Google 收到 500 错误。我打开了所有错误报告，我得到了这个：意外的'{'，期待'，'或';' 在第 6 行。

翻了好几遍，没发现有什么不对。希望有人可以提供帮助。如果我选择第 5 行，即 $(\'#js_terms_of_use\').click(function() 并删除这两个 \'，第 6 行的错误就会消失，但我逃脱了它们，所以我不明白问题是什么. 这是代码：

```
echo '
<script type=\"text/javascript\">
$Behavior.termsAndPrivacy = function()
{
    $(\'#js_terms_of_use\').click(function()
    {
        '; ?>

        tb_show('<?php echo extras::getPhrase('user.terms_of_use', array('extras_squote' => true)); ?>', $.ajaxBox('page.view', 'height=410&width=600&title=terms')); 
        <?php echo '
        return false;
    });

    $(\'#js_privacy_policy\').click(function()
    {
        '; ?>

        tb_show('<?php echo extras::getPhrase('user.privacy_policy', array('extras_squote' => true)); ?>', $.ajaxBox('page.view', 'height=410&width=600&title=policy')); 
        <?php echo '
        return false;
    });
}
</script>
'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T01:33:24.983

默认情况下，标签之外的任何内容都会`<?php ?>`被回显。使用它对您有利。多行单引号字符串是个坏主意。这是清理代码的尝试：

```
<?php 
$TOU  = extras::getPhrase('user.terms_of_use', array('extras_squote' => true));
$priv = extras::getPhrase('user.privacy_policy', array('extras_squote' => true));
?>
<script type="text/javascript">
$Behavior.termsAndPrivacy = function()
{
    $('#js_terms_of_use').click(function()
    {
        tb_show('<?php echo $TOU ?>', $.ajaxBox('page.view', 'height=410&width=600&title=terms')); 
        return false;
    });

    $('#js_privacy_policy').click(function()
    {
        tb_show('<?php echo $priv ?>', $.ajaxBox('page.view', 'height=410&width=600&title=policy')); 
        return false;
    });
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T01:37:01.223

如果您确实需要从 PHP 中的单个 echo 输出多行，请使用 heredoc 语法（如果可用，请使用 newdoc 语法）。如需复习，请访问[php.net](http://www.php.net/manual/es/language.types.string.php)

# https - 小书签在 HTTPS 网站上不起作用？

> ID：12273368
> 
> 赞同：0
> 
> 时间：2012-09-05T01:27:02.783
> 
> 标签：https, bookmarklet

这是我如何开发一个书签，获取网页上的输入控件值，我编写了一个javascript函数，将书签添加到我的浏览器中，加载我的测试网页，测试书签，结果是好的，但是我测试了HTTPS网站上的书签，书签无法获取输入控制值，为什么？小书签在 HTTPS 网站上不起作用？？有什么方法可以让小书签在 https 网站上工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T12:54:57.243

3个问题：

*   为什么你不能得到输入值：没有理由它不起作用，几乎可以肯定你正在寻找错误的 id。

*   小书签是否可以在 HTTPS 上工作：绝对，HTTPS 不是问题

*   我可以让它在 https 网站上运行吗：如果您提供代码示例，我们可能会告诉您它有什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T03:54:01.960

我知道这是一个很老的问题，但是由于我在搜索类似问题时遇到了它，所以我会添加我的想法。如果您编写了自己的书签，这很可能是由于您的书签试图访问不安全的内容。如果您的小书签在您自己的服务器上引用了其他静态内容，例如 HTML、JS、CSS 或图像文件，浏览器将阻止加载该内容。这是因为[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。这个问题也在[这个](https://stackoverflow.com/questions/14367711/bookmarklet-on-https-page)问题中讨论。如果您或查看此内容的其他人遇到相同问题，请尝试将您的内容提供为 https 或仅访问 https 的其他内容。

# node.js - 在终止之前无法从标准输出读取

> ID：12273375
> 
> 赞同：0
> 
> 时间：2012-09-05T01:27:31.940
> 
> 标签：node.js, coffeescript

```
bash = require('child_process').spawn '/bin/bash', []
console.log 'Spawned bash as pid ' + bash.pid
bash.stdout.on 'data', (data) ->
    process.stdout.write data 
```

我希望上面的代码会从 bash 读取并显示到进程标准输出。它没有。如果我替换`/bin/bash`为`/bin/bash -c /bin/ls`我将得到`ls`我期望的输出。显然，这与`bash`保持开放有关。

关于如何在`bash`不必终止进程的情况下读取输出的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:59:03.363

使用[https://github.com/chjj/pty.js/](https://github.com/chjj/pty.js/)

它就像一个魅力！

# google-maps - 我可以在 Google 地图上显示一些 KML 吗？

> ID：12273377
> 
> 赞同：2
> 
> 时间：2012-09-05T01:27:32.647
> 
> 标签：google-maps, google-maps-api-3, kml

是否可以将一些 KML 硬编码到一些 Html 页面中，并让谷歌地图将硬编码的 KML 显示为谷歌地图？

现在，我不断看到要求 KML 位于其他地方的文档 -> 某个网络服务器上的 HTTP 端点（这不是我想要的）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:06:50.177

geoxml3 [KML 解析器](http://code.google.com/p/geoxml3/)将解析嵌入在您的页面中的 KML 字符串并将其显示在地图上（作为本地 Google Maps API v3 对象，而不是 KmlLayer，它确实需要公开可用的 KML 文件）。

# cakephp - cakephp 分页器 -> 排序 - 模型选项

> ID：12273380
> 
> 赞同：2
> 
> 时间：2012-09-05T01:27:52.630
> 
> 标签：cakephp, pagination

我在按不同模型的字段对表数据进行排序时遇到一些问题。

从这里：[http ://book.cakephp.org/2.0/en/core-libraries/helpers/paginator.html](http://book.cakephp.org/2.0/en/core-libraries/helpers/paginator.html)

它说我可以添加“模型”选项，但是当我尝试时：

```
echo $this->Paginator->sort('unit', 'Unit', array('model' => 'Unit')); 
```

我收到此错误：

```
Warning (2): array_filter() expects parameter 1 to be array, null given [CORE/Cake/View/Helper/PaginatorHelper.php, line 395]

Warning (2): array_merge() [function.array-merge]: Argument #1 is not an array [CORE/Cake/View/Helper/PaginatorHelper.php, line 395] 
```

知道这里发生了什么吗？主要/默认模型是卡片，我需要按单元模型订购其中一个列标题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T06:44:40.963

如果您在某些表的列表中显示记录，那么您可以通过以下方式使用它：

```
<?php echo $this->Paginator->sort('Unit.unit', 'Unit'); 
```

`model`无需传递第三个参数选项，它将完美地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-26T15:17:47.710

只是对较新版本的提醒：关联模型不会自动加载到 CakePHP3s Paginator 中。确保包含“sortWhitelist”选项，请参阅[https://book.cakephp.org/3.0/en/controllers/components/pagination.html#control-which-fields-used-for-ordering](https://book.cakephp.org/3.0/en/controllers/components/pagination.html#control-which-fields-used-for-ordering)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T04:50:03.050

请尝试以下代码

```
echo $this->Paginator->sort('Unit.unit', 'Unit', array('model' => 'Unit')); 
```

让我知道是否有。

# curl - 使用 CURL 导航（Cruddy）HTTPS 站点

> ID：12273381
> 
> 赞同：0
> 
> 时间：2012-09-05T01:28:13.970
> 
> 标签：curl, https

我正在尝试使用 cURL 导航 HTTPS 页面。不过，我的问题不在于 cURL，而是通常与页面有关。问题是我登录后，想去某个页面，收集一些信息。但是，当我尝试直接访问该 URL 时，该站点会自动将我注销。这不仅是通过 cURL，而且在我使用网络浏览器时也会发生。访问我想要的页面的唯一方法是单击站点上的超链接（这似乎只是对我输入的 URL 的重定向）。我探索了 cookie 和会话（每次更改页面时会话 ID 似乎都会改变？）无济于事。我似乎找不到任何正在运行并影响“点击”的 Javascript，也找不到任何秘密 POST 字段，所以我的问题是：

是否有一种众所周知的方法可以让服务器“知道”我是否通过 URL 和超链接导航到那里？它与HTTPS有关吗？

我是网络编程的新手，所以我认为超链接或多或少只是自己输入 URL 的快捷方式。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T19:17:21.107

弄清楚了。

该站点正在标题中寻找“推荐人”请求。如果有人遇到这样的问题，FireFox 的 HttpFox 插件将非常有帮助。它将记录您发送和接收的所有 POST 和标头。然后，您需要做的就是在浏览器上导航并欺骗 cURL 中发生的内容。

# c++ - Windows 操作系统多久可以从唤醒计时器唤醒？

> ID：12273382
> 
> 赞同：4
> 
> 时间：2012-09-05T01:28:19.153
> 
> 标签：c++, winapi, sleep, power-management, wakeup

我正在使用 C++ 和 Win API 编写程序。我使用[SetSuspendState](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373201%28v=vs.85%29.aspx) () API 将系统发送到睡眠模式（有可能在唤醒计时器上唤醒，'DisableWakeEvent' 设置为 FALSE。）然后我使用 CreateWaitableTimer 和 SetWaitableTimer API 来设置实际计时器。问题是如果我在系统进入睡眠模式后过早设置唤醒定时器，有时系统不会唤醒。

所以我很好奇，自从系统进入睡眠模式后，是否必须经过最短时间才能通过唤醒定时器以编程方式唤醒它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T13:55:40.453

马上。您的 PC 可以使用计时器唤醒：

[安排机器唤醒](https://stackoverflow.com/questions/1141735/schedule-machine-to-wake-up)

C# 文章，如果你不介意的话：http: [//www.codeproject.com/Articles/49798/Wake-the-PC-from-standby-or-hibernation](http://www.codeproject.com/Articles/49798/Wake-the-PC-from-standby-or-hibernation)

```
using System;
using System.Text;
using System.Runtime.InteropServices;
using Microsoft.Win32.SafeHandles;
using System.ComponentModel;
using System.Threading;

namespace WakeUPTimer
{
    class WakeUP
    {
        [DllImport("kernel32.dll")]
        public static extern SafeWaitHandle CreateWaitableTimer(IntPtr lpTimerAttributes, 
                                                                  bool bManualReset,
                                                                string lpTimerName);

        [DllImport("kernel32.dll", SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool SetWaitableTimer(SafeWaitHandle hTimer, 
                                                    [In] ref long pDueTime, 
                                                              int lPeriod,
                                                           IntPtr pfnCompletionRoutine, 
                                                           IntPtr lpArgToCompletionRoutine, 
                                                             bool fResume);

        public event EventHandler Woken;

        private BackgroundWorker bgWorker = new BackgroundWorker();

        public WakeUP()
        {
            bgWorker.DoWork += new DoWorkEventHandler(bgWorker_DoWork);
            bgWorker.RunWorkerCompleted += 
              new RunWorkerCompletedEventHandler(bgWorker_RunWorkerCompleted);
        }

        public void SetWakeUpTime(DateTime time)
        {
            bgWorker.RunWorkerAsync(time.ToFileTime());
        }

        void bgWorker_RunWorkerCompleted(object sender, 
                      RunWorkerCompletedEventArgs e)
        {
            if (Woken != null)
            {
                Woken(this, new EventArgs());
            }
        }

        private void bgWorker_DoWork(object sender, DoWorkEventArgs e) 
        {
            long waketime = (long)e.Argument;

            using (SafeWaitHandle handle = 
                      CreateWaitableTimer(IntPtr.Zero, true, 
                      this.GetType().Assembly.GetName().Name.ToString() + "Timer"))
            {
                if (SetWaitableTimer(handle, ref waketime, 0, 
                                       IntPtr.Zero, IntPtr.Zero, true))
                {
                    using (EventWaitHandle wh = new EventWaitHandle(false, 
                                                           EventResetMode.AutoReset))
                    {
                        wh.SafeWaitHandle = handle;
                        wh.WaitOne();
                    }
                }
                else
                {
                    throw new Win32Exception(Marshal.GetLastWin32Error());
                }
            }
        }

    }
} 
```

或从控制面板：[http ://www.anuko.com/content/world_clock/faq/enable_wake_timers.htm](http://www.anuko.com/content/world_clock/faq/enable_wake_timers.htm)

# django - 如何调整 celery 设置以使 Redis 使用尽可能多的内存？CELERY_TASK_RESULT_EXPIRES？

> ID：12273384
> 
> 赞同：3
> 
> 时间：2012-09-05T01:28:34.227
> 
> 标签：django, redis, celery

有点像 Celery 菜鸟，但我想我有一个配置问题，Celery 在 Redis 中放了太多东西

如果可以的话，我的目标是尝试减少或优化 Redis 使用的内存量

我有一个相当大的 Django 生产设备，其中 Celery 作业运行“很多”。在我的 settings.py 我有

```
BROKER_BACKEND = "redis" 
```

从`top -p13907`Redis 使用大量内存（在仅由 Celery 使用的盒子上）：

```
 PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
13907 redis     20   0 10.5g 3.3g  532 S    0 42.8 109:38.94 redis-server 
```

我发现这个[CELERY_TASK_RESULT_EXPIRES](http://docs.celeryproject.org/en/latest/userguide/configuration.html#std:setting-result_expires)设置看起来像是我应该添加到我的设置文件中的东西。

默认情况下，从文档看来它设置为 1 天（86400 秒）

这是我想要改变的吗？还是我应该研究更多设置？我不确定的另一件事是如果我添加它，我应该如何决定将它设置为的“安全”秒数是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-10T02:09:19.117

我想也许你的 celery 调用者忘记清理结果，这些结果将存储在消息队列服务器中直到过期。在芹菜中，你必须打电话

`r.get()`

获取结果并将其清理到消息队列中。如果您只访问结果而不调用此函数：

`r.result`

结果仍将由消息队列服务器持有并大量消耗您的内存！

# bash - 是否可以使用命令行选项指定 bash 提示符？

> ID：12273393
> 
> 赞同：5
> 
> 时间：2012-09-05T01:31:02.707
> 
> 标签：bash, vim, command-line

我经常使用 vim，并且经常发现使用`!bash`. 但是，我需要输入`exit`才能返回 vim，有时我不确定我是否在子 shell 中，或者这是否会关闭我的会话。

我真正想做的是输入类似这样的东西，`!bash -prompt "subshell"`这样我就会得到这样的东西：

```
subshell$ <commands go here> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-05T01:38:42.180

最直接的方法是`PS1`在 vim 中设置环境变量：

```
:let $PS1="subshell$ " 
```

并使用命令`:shell`而不是`:!bash`.

使用`$`符号 with`let`修改环境变量。将此添加到您的*.vimrc*以保留设置。

或者，`:shell`您*可以使用**shell 选项*指定更具体的命令，包括参数，请参阅`help shell`和`help 'shell'`。

所以：

```
:set shell=bash\ --rcfile\ ~/.vimbashrc 
```

在*.vimbashrc*添加，并使用而不是`PS1="subshell "`调用子外壳。将此添加到您的*.vimrc*以保留设置。`:shell``!bash`

 *所以你有两个选择：

*   添加`let $PS1="subshell "`到您的*.vimrc*`:shell`中，并使用而不是启动子外壳`:!bash`。
*   为您的 vim 子外壳制作一个自定义 rc 文件，添加您的特定文件`PS1="subshell "`，并修改*.vimrc*`shell`中的选项：。*`set shell=bash\ --rcfile\ ~/.vimbashrc`*

 *最后，如果您必须使用`:!bash`来启动子 shell，还有其他几个选项。请注意，您还可以使用 传递更具体的命令行`!`，例如：

*   `:PS1="subshell$ " bash`应该管用。
*   `:!bash\ --rcfile\ ~/.vimbashrc`, 并`PS1`在*.vimbashrc*中设置如上

但是你每次都需要输入这些*，*或者为它定义一个映射。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T06:18:24.553

使用 shell 变量`$SHLVL`似乎是这里的另一种选择。添加`$SHLVL`你的`$PS1`：

```
export PS1="$PS1 $SHLVL" 
```

所以你的提示看起来像这样：

```
[tim@RackAblade47 ~]$ 2 
```

当你从 VIM 启动 shell 时，`$SHLVL`会增加：

```
[tim@RackAblade47 ~]$ 4 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T01:35:15.997

是的 - 您可以在运行命令之前更改 shell 内的提示

PS1="子壳"

查看本指南以了解所有选项[http://www.linuxselfhelp.com/howtos/Bash-Prompt/Bash-Prompt-HOWTO-2.html](http://www.linuxselfhelp.com/howtos/Bash-Prompt/Bash-Prompt-HOWTO-2.html)

如果您确实必须通过 bash 命令执行此操作，您可以使用“--rcfile”来指定为您运行 PS1 命令的 RC 文件（您通常将 PS1= 行放在您的 .bashrc 中以自定义登录时的提示）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T02:39:26.510

要回答您最初的问题，您可以在 Vim 内部说：

```
:!VIMPROMPT="(vim) " bash 
```

并从类似的东西更改您的提示（大概在您的.bashrc中）

```
PS1='\u@\h:\w\$ ' 
```

到

```
PS1='$VIMPROMPT\u@\h:\w\$ ' 
```

这将改变你的提示

```
me@host:~$ 
```

到

```
(vim) me@host:~$ 
```

如果在 Vim 中运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T10:47:04.390

我个人使用

```
case $(ps $PPID) in *vim|*bash)
  PS1="$(ps $PPID | awk '{print $NF}' | sed 1d) $PS1" ;;
esac 
```

在我的[.bashrc提供的](https://github.com/estebank/environment/blob/master/bashrc.sh)[提示脚本](https://github.com/estebank/environment/blob/master/fancy_prompt.sh#L124)中，取自[Triplee](https://stackoverflow.com/users/874188/tripleee)的[评论](https://stackoverflow.com/questions/12273393/is-it-possible-to-specify-the-bash-prompt-using-a-command-line-option#comment-16510910)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-16T09:40:37.380

我已经能够通过检查`MYVIMRC`在vim中导出的变量来更改vim子shell进程的提示，然后会`PS1`相应地更新。我用以下内容更新了我的`.bashrc`文件。

```
PS1='\$ '
# when in vim subshell change PS1 for clarity
if [[ $MYVIMRC ]]; then PS1='>> '; fi; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-05T01:56:03.583

将其放在您的`.bashrc`任何现有`PS1=`语句之后。

```
if ps | grep -q vim; then
  export PS1="[VIM]$PS1"
fi 
```

在 Ubuntu 上测试。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-02-04T13:04:13.100

您可以使用 CTRL+Z 将其发送到后台，然后使用命令将其带回`fg`。与`jobs`您一起看到您已停止的所有工作。

这是您可以并行拥有多个 vim 实例并选择要带回的实例。如果没有运行，你只会得到一个`no current job`错误，就是这样。

这并没有具体回答您的问题，而是解决了它下面的问题。**

# forms - 为什么我的网页在加载时提交表单，但没有点击提交按钮？

> ID：12273394
> 
> 赞同：0
> 
> 时间：2012-09-05T01:31:29.383
> 
> 标签：forms, submit

windows.pageload 事件处理程序在页面加载时提交页面。我的目的是在单击表单提交按钮时将事件处理程序连接到提交事件。我做错了什么？谢谢！

```
function submit_data () {

var parent1Phone =              $("parent1Phone").value;

var areaCode = parent1Phone.substring(0,3);

var prefix = parent1Phone.substring(4,7);

var suffix = parent1Phone.substring(8,12);

var firstName =                     $("firstName").value;
var lastName =            $("lastName").value;
var sportID =                       $("sportID").value;
var entryFrom =                     $("entryFrom").value;
var linkSource =                    codeSource;
var primaryEmail =              $("primaryEmail").value;
var graduationYear =            $("graduationYear").value;
var postalCode =                    $("postalCode").value;
var parent1FirstName =      $("parent1FirstName").value;
var parent1LastName =       $("parent1LastName").value;
var parent1Relationship =   $("parent1Relationship").value;
var parent1Phone1=        areaCode;
var parent1Phone2 =       prefix;
var parent1Phone3 =       suffix;
var parent1PhoneType =      $("parent1PhoneType").value;                    //No validation required. No non-choice allowed.
var parent1Email =              $("parent1Email").value;
var parent1EmailConfirm =   $("parent1Email").value;
var successDestination =    success;
var errorDestination =      failure;

var url =   "http://recruit-  match.ncsasports.org/fasttrack/saefentry/submitFullFormRemote.go?";

window.location.href = url + "firstName="+ firstName + "&lastName=" + "&lastName=" + lastName +"&sportID=" + sportID + "&entryFrom=" + entryFrom + "&linkSource=" + linkSource + "&primaryEmail=" + primaryEmail +"&graduationYear=" + graduationYear + "&postalCode=" + postalCode + "&parent1FirstName=" + parent1FirstName + "&parent1LastName=" + parent1LastName + "&parent1Relationship=" + parent1Relationship + "&parent1Phone1=" + parent1Phone1 + "&parent1Phone2=" + parent1Phone2 + "&parent1Phone3=" + parent1Phone3 + "&parent1PhoneType=" + parent1PhoneType + "&parent1Email=" + parent1Email + "&parent1EmailConfirm=" + parent1Email + "&successDestination=" + successDestination + "&errorDestination=" + errorDestination;
}

function prepareEventHandlers() {
    $("frmNcsa").onclick = submit_data();
}

window.onload = function() {
    prepareEventHandlers();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:38:48.083

你`submit_data`在做任务`$("frmNcsa").onclick = submit_data();`，应该是`$("#frmNcsa").click(submit_data);`

假设传递给 jQuery 函数的所有字符串都是元素的 id，它们应该以`#`.

# ios - 带有 Web 服务的 iOS CoreData - 如何将对象放入应用程序包以进行初始应用程序下载

> ID：12273395
> 
> 赞同：0
> 
> 时间：2012-09-05T01:31:40.510
> 
> 标签：ios, web-services, core-data, bundle

我计划将我的应用程序中的 CoreData 对象与[Parse](https://parse.com/)之类的 Web 服务同步。所以这些对象将存在于服务器上，但我也想将它们与应用程序一起提供，以便在用户安装它时它们已经存在。我不想依赖互联网连接在安装时下载所有内容。我只想通过 Web 服务对对象进行更新。那么如何将这些对象放入我的应用程序包中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:42:33.347

1.  向您的应用添加第二个“预填充”目标。设置此目标，以便它所做的只是从服务器下载/同步内容并将其加载到数据库中（即确保禁用任何用户详细信息提示，或任何将用户生成的内容插入数据库的提示）。

2.  使用 iOS 模拟器运行“预填充”目标。请注意应用程序文件的存储位置（最简单的方法是`NSLog`在应用程序中使用语句）。

3.  当“预填充”运行完成时，在您的文件系统中找到应用程序的数据库文件并将其复制到您的项目中。在尝试从服务器同步任何内容之前，请确保您的非预填充目标已设置为安装此预构建数据库（只需在应用程序第一次运行时将数据库文件复制到适当的位置）。

4.  利润！

# c# - 在另一个数组中搜索数据

> ID：12273397
> 
> 赞同：1
> 
> 时间：2012-09-05T01:31:55.253
> 
> 标签：c#

我想做的很简单，但很慢。基本上我正在循环数据（字节数组），将一些部分转换为 INT，然后将其与 RamCache 进行比较，这也是一个字节数组。我将它转换为 INT 的原因是因为它是 4 个字节，所以如果在 RamCache 数组的某些部分中 4 个字节相等，我知道它已经是 4 个长度相等。然后从那里我可以看到有多少字节是相等的。

简而言之，这段代码必须做什么：

循环遍历数据数组并取 4 个字节，然后查看它是否包含在 RamCache 数组中。目前，当数据数组和 RamCache 数组包含 65535 字节时，下面的代码很慢。

```
 private unsafe SmartCacheInfo[] FindInCache(byte[] data, Action<SmartCacheInfo> callback)
    {
        List<SmartCacheInfo> ret = new List<SmartCacheInfo>();

        fixed (byte* x = &(data[0]), XcachePtr = &(RamCache[0]))
        {
            Int32 Loops = data.Length >> 2;
            int* cachePtr = (int*)XcachePtr;
            int* dataPtr = (int*)x;

            if (IndexWritten == 0)
                return new SmartCacheInfo[0];

            //this part is just horrible slow
            for (int i = 0; i < data.Length; i++)
            {
                if (((data.Length - i) >> 2) == 0)
                    break;

                int index = -1;
                dataPtr = (int*)(x + i);

                //get the index, alot faster then List.IndexOf
                for (int j = 0; ; j++)
                {
                    if (((IndexWritten - j) >> 2) == 0)
                        break;

                    if (dataPtr[0] == ((int*)(XcachePtr + j))[0])
                    {
                        index = j;
                        break;
                    }
                }

                if (index == -1)
                {
                    //int not found, lets see how 
                    SmartCacheInfo inf = new SmartCacheInfo(-1, i, 4, false);
                    inf.instruction = Instruction.NEWDATA;
                    i += inf.Length - 1; //-1... loop does +1
                    callback(inf);
                }
                else
                {
                    SmartCacheInfo inf = new SmartCacheInfo(index, i, 0, true); //0 index for now just see what the length is of the MemCmp
                    inf.Length = MemCmp(data, i, RamCache, index);
                    ret.Add(inf);
                    i += inf.Length - 1; //-1... loop does +1
                }
            }
        }
        return ret.ToArray();
    } 
```

双循环是让它如此缓慢的原因。数据数组包含 65535 个字节，RamCache 数组也是如此。这段代码是我正在为我的 SSP 项目工作的缓存系统的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:48:55.330

对 RamCache 数组或数组副本进行排序并使用[Array.BinarySearch](http://msdn.microsoft.com/en-us/library/system.array.binarysearch.aspx)。如果无法排序，则创建 RamCache 的[HashSet](http://msdn.microsoft.com/en-us/library/bb495294.aspx)。

# mysql - MySQL 按共享 ID 对行进行分组

> ID：12273401
> 
> 赞同：-1
> 
> 时间：2012-09-05T01:33:13.277
> 
> 标签：mysql

说我有

```
ID | PRODUCT
 1 |  Apples
 1 | Oranges
 1 | Bananas
 2 | Walnuts
 2 | Almonds
 3 | Steak
 3 | Chicken 
```

这可以在 MySQL 中进行这种类型的设置吗？我创建了一个测试表，并创建了一个带有主索引和自动递增的 ID 列。当我尝试插入几行都具有相同的 ID 时，mysql 返回一个错误。

这可以在mysql中做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:36:08.970

当您设置为主键时，重复记录（*ID*）如何？基本上不会。主键是. 如果您希望记录是这样的，请创建另一列作为您的主键`INSERTED``ID``UNIQUE`

```
CREATE TABLE sampleTable
(
    ID INT NOT NULL AUTO_INCREMENT, 
    GROUP_ID INT NOT NULL, 
    PRODUCT VARCHAR(25),
    CONSTRAINT pk_name PRIMARY KEY (ID),
    CONSTRAINT uq_name UNIQUE (GROUP_ID, PRODUCT)
) 
```

添加了一个`UNIQUE`约束以避免重复的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:37:28.993

这是可能的，但它没有标准化，因为您有一个重复的主键。主键必须是唯一的，这意味着`1`只能出现一次。如果`ID`每个都有自定义`product`，则使用复合主键`(id, product)`或代理键。代理键将是唯一标识行的自动递增列。您的表格将如下所示：

```
CREATE TABLE fruits (
  auto_id int AUTO_INCREMENT PRIMARY KEY,
  id int,
  product varchar(15)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T01:38:03.327

您不能为 ID 列创建主键，因为这意味着它是唯一的。只需为您的示例使用普通索引即可。

另一方面，在大多数情况下，有一个主键是有意义的，所以我建议添加一个带有正常索引的第三行（GENRE？），并保持主键不变。

插入数据时，只需要插入GENRE和PRODUCT，ID就会自动填写。

# javascript - Javascript 两个日期选择器冲突

> ID：12273408
> 
> 赞同：0
> 
> 时间：2012-09-05T01:34:17.687
> 
> 标签：javascript, datepicker

这是我的代码完整代码：

```
<!doctype html>

<html>
<head>
    <meta charset="utf-8">
    <title>Date Picker</title>
</head>
<body>
<strong>Departing:</strong><br/>
<select name='dateSingleMonthDeparting' onChange='changeDate(this.options[selectedIndex].value);'>
    <option value='na'>Month</option>
    <option value='1'>January</option>
    <option value='2'>February</option>
    <option value='3'>March</option>
    <option value='4'>April</option>
    <option value='5'>May</option>
    <option value='6'>June</option>
    <option value='7'>July</option>
    <option value='8'>August</option>
    <option value='9'>September</option>
    <option value='10'>October</option>
    <option value='11'>November</option>
    <option value='12'>December</option>
</select>
<select name='dateSingleDayDeparting' id='day'>
    <option value='na'>Day</option>
</select>
<select name='dateSingleYearDeparting' id='year'>
    <option value='na'>Year</option>
</select><br/>

<strong>Returning:</strong><br/>
<select name='dateSingleMonthReturning' onChange='changeDate(this.options[selectedIndex].value);'>
    <option value='na'>Month</option>
    <option value='1'>January</option>
    <option value='2'>February</option>
    <option value='3'>March</option>
    <option value='4'>April</option>
    <option value='5'>May</option>
    <option value='6'>June</option>
    <option value='7'>July</option>
    <option value='8'>August</option>
    <option value='9'>September</option>
    <option value='10'>October</option>
    <option value='11'>November</option>
    <option value='12'>December</option>
</select>
<select name='dateSingleDayReturning' id='day'>
    <option value='na'>Day</option>
</select>
<select name='dateSingleYearReturning' id='year'>
    <option value='na'>Year</option>
</select>

<script>
function changeDate(i){
    var e = document.getElementById('day');
    while(e.length>0){
        e.remove(e.length-1);
        var j=-1;
        if(i=="na"){
            k=0;
        }else if(i==2){
            k=28;
        }else if(i==4||i==6||i==9||i==11){
            k=30;
        }else{
            k=31;
        }
    }
    while(j++<k){
        var s=document.createElement('option');
        var e=document.getElementById('day');
        if(j==0){
            s.text="Day";
            s.value="na";
            try{
                e.add(s,null);
            }catch(ex){
                e.add(s);
            }
        }
        else{
            s.text=j;
            s.value=j;
            try{
                e.add(s,null);
            }catch(ex){
                e.add(s);
            }
        }
    }
}
var currentTime = new Date();
y = currentTime.getFullYear()+1;
while (y-->1909){
    var s = document.createElement('option');
    var e = document.getElementById('year');
    s.text=y;
    s.value=y;
    try{
        e.add(s,null);
    }catch(ex){
        e.add(s);
    }
}
</script>
</body>
</html> 
```

我有两个日期选择器。当我更改第一个时，它可以完美运行，但是如果我更改第二个，则功能将在第一个 datepciker 中运行

我希望他们对每个日期选择器都有自己的功能。我将做些什么来实现这一点？我已经尝试过制作这样的东西，`getElementById('day day2')`但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T01:47:06.733

您`select`已在标记中分配了 id`day`和`year`两次。那是错的。ID 应该是唯一的。

请将这些 ID 更改为 day1、year1、day2 和 year2。然后将这些 id 作为参数传递给 this`changeDate(this.value, "day1", "year1")`和 this 这样的函数`changeDate(this.value, "day2", "year2")`。

现在将 changeDate 定义为

```
function changeDate(i, day, year) {
    var e = document.getElementById( day ); // please note that day is the variable passed

    ...................
} 
```

作为一个不相关的旁注，`this.options[selectedIndex].value`与`this.value`

# iphone - iPhone SDK：冻结部分网页视图

> ID：12273409
> 
> 赞同：0
> 
> 时间：2012-09-05T01:34:20.230
> 
> 标签：iphone, objective-c, ios, facebook, uiwebview

我想知道是否有办法冻结 webview 的某个部分，这样当您滚动浏览 webview 时，webview 的一部分仍然显示而不是隐藏。例如，当在 webview 中使用 facebook 时，当向下滚动 webview 时，如何让带有通知、消息和好友请求的蓝条始终保持在顶部，就像在 facebook 应用程序中一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:24:31.853

如果您希望 webview 中的元素保持固定在屏幕上而不受滚动影响，您可以尝试在该 DOM 元素上应用*position:fixed CSS 样式。*

请注意，在 iOS5 之前不支持*position:fixed 。*

并且 UIWebView 的原生滚动弹跳效果也会影响固定位置的 DOM 元素，因此您可以确定是否还需要禁用该弹跳效果。

# mysql - mysql 先执行mysql orderby

> ID：12273414
> 
> 赞同：2
> 
> 时间：2012-09-05T01:35:07.010
> 
> 标签：mysql, sql, sql-order-by

我只是想问如何在实际的 select 语句之前先执行 order by 子句。

我在 PHP 下有查询：

```
mysql_query("SELECT  GROUP_CONCAT(sample_lang) AS locations 
             FROM postflight 
             WHERE rno='$cc' 
             ORDER BY sfno ASC") or die(mysql_error()); 
```

查询所做的是在对其进行排序之前先连接值。我想要的是在连接之前先升序对其进行排序。任何帮助将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T01:39:03.350

你可以使用`ORDER BY`内部`GROUP_CONCAT()`函数，试试

```
SELECT GROUP_CONCAT(sample_lang ORDER BY sfno ASC)
FROM ...
WHERE ... 
```

或者如果你想添加`SEPARATOR`

```
SELECT GROUP_CONCAT(sample_lang ORDER BY sfno ASC SEPARATOR '-')
FROM ...
WHERE ... 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/1f667/6 "点击澄清")

# objective-c - 为什么我的 NSArray 排序器不起作用？

> ID：12273416
> 
> 赞同：0
> 
> 时间：2012-09-05T01:35:12.383
> 
> 标签：objective-c

我有

```
 if (_sortedThemes == nil)
        {
            _sortedThemes = [[self.themes allKeys] sortedArrayUsingComparator:^NSComparisonResult(NSString *str1, NSString *str2)
                             {
                                 if ([str1 isEqualToString:@"Default"] && str1 != str2)
                                 {
                                     return NSOrderedAscending;
                                 }
                                 else
                                 {
                                     return [str1 compare:str2];
                                 }
                             }];                        
        }

        for (id d in _sortedThemes)
        {
            NSLog(@"%@",d);
        } 
```

_sortedThemes 确实是 nil 并且排序器返回：

蓝色，...，默认，...。

我希望 Default 作为第一个元素，其他所有元素都按常规顺序排列。

我改为

```
if (([str1 isEqualToString:@"Default"] || [str2 isEqualToString:@"Default"]) && str1 != str2) 
```

但是，Default 仍然不是第一个元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:39:42.187

```
 if ([str1 isEqualToString:@"Default"] && str1 != str2) 
```

“默认”也可以是 str2。您需要添加该案例，然后它可能有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:43:04.803

此示例代码可能会对您有所帮助

```
 NSMutableArray *list = [NSMutableArray arrayWithObjects:@"11",@"2",@"3",@"1", nil];
[list sortUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    NSInteger firstInteger = [obj1 integerValue];
    NSInteger secondInteger = [obj2 integerValue];
    if( firstInteger > secondInteger) return NSOrderedDescending;
    if( firstInteger == secondInteger) return NSOrderedSame;
    return NSOrderedDescending;
}]; 
```

# css - 将引导程序 tr 悬停效果应用于 div

> ID：12273420
> 
> 赞同：10
> 
> 时间：2012-09-05T01:35:32.210
> 
> 标签：css, twitter-bootstrap

我正在为我的 CSS 主题使用 Bootstrap。主题被编译并保存到数据库中以供以后使用。这意味着页面只能访问已编译的 css 而不是 less 文件。

鉴于此，我如何将 Bootstrap 的`tr:hover`效果应用于各种 div？我需要颜色与定义的颜色相同，`tr:hover`并且不能使用更少的变量。

Bootstrap 的风格：

```
.table tbody tr:hover td,
.table tbody tr:hover th {
  background-color: #f5f5f5;
} 
```

是否可以基于分配给 a 的另一个元素来定义一个 css 元素`tr`？有没有办法使用 jQuery 来获取样式？

有什么建议么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-05T17:25:18.607

### 纯 CSS 方式：

为此有一个`div`as`.hoverDiv`和 CSS 类：

```
.hoverDiv {background: #fff;}
.hoverDiv:hover {background: #f5f5f5;} 
```

### 小提琴：http: [//jsfiddle.net/bD5kS/](http://jsfiddle.net/bD5kS/)

### jQuery方式：

```
$(document).ready(function(){
    $(".hoverDiv").hover(function(){
        $(this).css("background", "#f5f5f5");
    }, function(){
        $(this).css("background", "#fff");
    });
}); 
```

### 小提琴：http: [//jsfiddle.net/KQzwc/](http://jsfiddle.net/KQzwc/)

### 要动态获取颜色，请使用`$(".table tbody tr:hover").css("background-color")`：

```
$(document).ready(function(){
    $(".hoverDiv").hover(function(){
        $(this).css("background", $(".table tbody tr:hover").css("background-color"));
    }, function(){
        $(this).css("background", $(".table tbody tr").css("background-color"));
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:59:24.577

这是不可能的 - 没有 javascript。

使用较少的变量将是一个不错的选择。但如果你不能这样做，这里是 javascript 解决方案：http: [//jsfiddle.net/joplomacedo/b5DMA/](http://jsfiddle.net/joplomacedo/b5DMA/)

```
var stylesheets = document.styleSheets,
    stylesheet, new_stylesheet, rules, rule, i = 0,
    max_i = stylesheets.length,
    j, max_j;

for (i = max_i; i--;) {
    stylesheet = stylesheets[i];
    rules = stylesheet.cssRules;
    j = 0;
    max_j = rules.length;

    for (j = max_j; j--;) {
        rule = rules[j];
        if (rule && rule.selectorText.indexOf('.table tbody tr:hover th') > -1) {
            new_stylesheet = document.createElement('style');
            new_stylesheet.innerText = ".el:hover{" + rule.style.cssText + "}";
            document.getElementsByTagName('head')[0].appendChild(new_stylesheet);
        }
    }
}​ 
```

# java - java.util.Collections.shuffle(List list) 能否以与“发送以进行混洗”相同的顺序返回列表？

> ID：12273421
> 
> 赞同：3
> 
> 时间：2012-09-05T01:35:43.627
> 
> 标签：java, arrays, collections, arraylist, shuffle

[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)说“所有排列发生的可能性大致相等。” 但我不知道这是否包括返回相同订单的（尽管很小）可能性。我有一个方法（见下文），在两次测试运行期间，可能会以原始顺序返回列表。其他因素可能有问题，比如可能选择了字谜，结果是一个词。词典大约是 300,000 个单词，所以我已将方法更改为更合适的测试，以防止出现这种情况。方法：

```
private static char[] nextScrambledWord(int wordLength) {

    String word;
    do {
        word = "ABCDEF"; //TODO Get a word from lexicon
    } while(word.length() != wordLength);

    ArrayList<Character> temp = new ArrayList<Character>(wordLength);
    for(int i = 0; i < wordLength; i++) {
        temp.add(word.charAt(i));
    }

    Collections.shuffle(temp);

    char[] result = new char[wordLength];
    for(int i = 0; i < wordLength; i++) {
        result[i] = temp.get(i);
    }
    return result;
} 
```

我也对方法本身很好奇。如果有人对如何改进这一点有任何建议，请随时分享。基本上，该方法将从集合中提取一个 wordLength 的单词，并返回一个混洗结果的 char 数组。我没有考虑轮询已知长度的单词，而是考虑根据单词长度将词典分成多个集合。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T01:41:43.793

是的，原始订单可能会被保留，但正如您所说，这对于较长的列表不太可能。尝试一个只有两个元素的列表，看看会发生什么。

# java - v4lvj 在网络摄像头图像上绘制线条

> ID：12273427
> 
> 赞同：0
> 
> 时间：2012-09-05T01:36:53.363
> 
> 标签：java, webcam, v4l

我正在关注 v4lvj 库上的教程，该库允许访问 linux 上的网络摄像头。[指向源代码的链接](http://code.google.com/p/v4l4j/wiki/Examples)我编写的示例程序基本上显示了您的网络摄像头的视频源。一切都按照程序描述的那样工作。当我尝试通过在视频源顶部添加一条绿线来更改程序时，问题就出现了。我只是以同样的方式抓取图形，设置线条颜色，然后绘制线条。

```
@Override
        public void nextFrame(VideoFrame frame) {
                // This method is called when a new frame is ready.
                // Don't forget to recycle it when done dealing with the frame.

                // draw the new frame onto the JLabel
                label.getGraphics().drawImage(frame.getBufferedImage(), 0, 0, width, height, null);
                label.getGraphics().setColor(Color.GREEN); //this line causes exceptions
                label.getGraphics().drawLine(0, 0, 640, 480); //this line causes exceptions 

                // recycle the frame
                frame.recycle();
        } 
```

但是，当我这样做时，会出现一些异常，前面是“您的 JVM 似乎无法解码此图像。支持的图像类型：BMP bmp jpg JPG ...”然后

```
javax.imageio.IIOException: Unsupported marker type 0x5a
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readImage(Native Method)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:1176)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:984)
    at javax.imageio.ImageIO.read(ImageIO.java:1438)
    at javax.imageio.ImageIO.read(ImageIO.java:1342)
    at au.edu.jcu.v4l4j.JPEGVideoFrame.refreshBufferedImage(Unknown Source)
    at au.edu.jcu.v4l4j.BaseVideoFrame.getBufferedImage(Unknown Source)
    at SimpleViewer.nextFrame(SimpleViewer.java:143)
    at au.edu.jcu.v4l4j.PushSource.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:679)
au.edu.jcu.v4l4j.exceptions.V4L4JException: Exception received while grabbing next frame
    at au.edu.jcu.v4l4j.PushSource.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:679)
Caused by: au.edu.jcu.v4l4j.exceptions.UnsupportedMethod: Unable to decode the image
    at au.edu.jcu.v4l4j.JPEGVideoFrame.refreshBufferedImage(Unknown Source)
    at au.edu.jcu.v4l4j.BaseVideoFrame.getBufferedImage(Unknown Source)
    at SimpleViewer.nextFrame(SimpleViewer.java:143)
    ... 2 more
Caused by: javax.imageio.IIOException: Unsupported marker type 0x5a
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readImage(Native Method)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.readInternal(JPEGImageReader.java:1176)
    at com.sun.imageio.plugins.jpeg.JPEGImageReader.read(JPEGImageReader.java:984)
    at javax.imageio.ImageIO.read(ImageIO.java:1438)
    at javax.imageio.ImageIO.read(ImageIO.java:1342)
    ... 5 more 
```

谁能告诉我为什么并帮我在视频提要上画一条线。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T10:03:28.900

您应该通过覆盖`paint(Graphics g)`方法进行绘画`JLabel`，然后进行铸造`Graphics2D g2d = (Graphics2D) g;`并`Graphics2D`用于绘画。

在代码中使用 JLabel 的方式不正确。

您也可以使用`BufferedImage`从框架中收到的，获取它们`Graphics`并在其上绘制

# javascript - 无法将高库存的时间转换为 UTC

> ID：12273430
> 
> 赞同：2
> 
> 时间：2012-09-05T01:37:08.230
> 
> 标签：javascript, jquery, date, timezone, highcharts

我最难尝试将此日期从 API 转换为 UTC 毫秒。截至目前，我正在显示日期，但它会提前 7 小时显示，并持续到第二天，我什至没有数据。这是示例格式：

> 2012 年 8 月 31 日上午 9:00:00

我目前有这个代码

```
var formattedDate = new Date(data[i].Time);
formattedDate = formattedDate.getTime(); 
```

这似乎返回了正确的值类型，但日期是错误的。我也试过 getUTCMilliseconds() 并返回 0。

编辑：jsfiddle 示例：http: [//jsfiddle.net/b2NK6/](http://jsfiddle.net/b2NK6/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:55:18.983

所以你想要UTC时间的原始时间戳，而不是本地时间？

比较：

```
(new Date(Date.UTC(2012, 7, 31, 9, 0, 0, 0))).getTime(); /* month 7 is August */ 
```

和

```
(new Date(Date.parse("8/31/2012 9:00:00 AM"))).getTime(); 
```

当您解析字符串（第二个示例）时，它会在创建日期对象时应用您的本地时区信息。如果您在时区 -0700，则创建的日期实际上对应于 UTC 下午 4:00。

但是，如果您通过明确说明您指定 UTC 值来创建日期对象，它将为您提供 UTC 上午 9:00，对应于时区 -0700 中的凌晨 2:00。

*编辑以提供更清晰和更正确的代码示例。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:14:58.333

```
var dateString = "8/31/2012 9:00:00 AM";  // assuming this is expressed in local time

var millisecondsSinceTheEpoch = (new Date(dateString)).valueOf();  // 1346418000000

var isoString = (new Date(millisecondsSinceTheEpoch)).toISOString();  // 2012-08-31T13:00:00.000Z

// Note: example return values from a computer on U.S. Eastern Daylight Time (-4:00). 
```

来自[W3Schools](http://www.w3schools.com/jsref/jsref_valueof_date.asp)：

> valueOf() 方法返回 Date 对象的原始值。
> 
> **注意：**原始值作为自 UTC 1970 年 1 月 1 日午夜以来的毫秒数返回。

另请参阅 W3Schools 以[全面了解 Date 对象](http://www.w3schools.com/jsref/jsref_obj_date.asp)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:52:17.410

HighStocks 希望其日期与 UTC-午夜日期边界对齐。

假设您的图表仅处理日期（没有时间组件），您可以使用以下技巧：

1.  `originalDate.getTime()`获取自 UTC 1/1/1970 午夜以来的毫秒数，例如`1362286800000`.
2.  将毫秒数除以`(1000*60*60*24)`得到自 UTC 1/1/1970 午夜以来的**天**`15767.208333333334`数，例如。
3.  将数字四舍五入`Math.round()`到最接近的 UTC 午夜，例如`15767`.
4.  将数字乘以`(1000*60*60*24)`使其回到毫秒级，例如`1362268800000`。

这是最终的公式：

```
var utcMidnight=new Date(Math.round(anyZoneMidnight.getTime()/86400000)*86400000) 
```

# c# - 解析唯一行（使用 linq）

> ID：12273435
> 
> 赞同：1
> 
> 时间：2012-09-05T01:38:08.790
> 
> 标签：c#, .net, linq

我有一个包含喜欢这样写的文件：

`[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].`

例如：

`[Person]: [Age]-[21], [HairColor]-[Turqoise], [Gender]-[Other].`

虽然我熟悉 Linq，但我在弄清楚如何使用 Linq 解析它时遇到了很多麻烦。

我希望能够遍历所有行：

```
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE].
[NAME]: [PROPERTY]-[VALUE], [PROPERTY]-[VALUE], [PROPERTY]-[VALUE]. 
```

...并对每个检索到的人做一些事情。

有任何想法吗？任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:41:03.240

你不会用 LINQ 解析它。您将使用正则表达式或类似的东西对其进行解析，然后使用 LINQ 对其进行操作。

例如，使用如下正则表达式：

```
\[(.*)\]: \[(.*)\]-\[(.*)\], \[(.*)\]-\[(.*)\], \[(.*)\]-\[(.*)\] 
```

并使用括号内的组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T01:53:49.167

这是一个例子，如果我有你需要的东西，当然：

```
 File.ReadAllLines("Utils.txt")
            .Select(s => new
            {
                Name = s.Substring(1, s.IndexOf("]:") - 1),
                Values = s.Substring(s.IndexOf(":") + 2)
                          .Split(new string[] { ", " }, StringSplitOptions.RemoveEmptyEntries)
                          .ToDictionary(l => l.Substring(1, l.IndexOf("]-") - 1),
                                        l => l.Substring(l.IndexOf("-[") + 2).Trim(']'))
            })
            .ToList()
            .ForEach(o =>
                {
                    Console.WriteLine(o.Name);
                    o.Values.ToList().ForEach(p => Console.WriteLine(string.Format("\t{0}:\t{1}", p.Key, p.Value)));
                }); 
```

所以，在这里你会得到一个具有两个属性的匿名对象列表：

1.  只命名一个字符串
2.  值 - 一对字典，其中键是您的属性，值是您的值

在我的示例中，我通过阅读的内容进行了一个简单的循环，将其打印到控制台中

测试文件（Utils.txt）的内容如下：

```
[NAME]: [PROPERTY1]-[VALUE1], [PROPERTY2]-[VALUE2], [PROPERTY3]-[VALUE3] 
[Person]: [Age]-[21], [HairColor]-[Turqoise], [Gender]-[Other] 
```

输出：

```
NAME
    PROPERTY1:  VALUE1
    PROPERTY2:  VALUE2
    PROPERTY3:  VALUE3
Person
    Age:    21
    HairColor:  Turqoise
    Gender: Other 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T08:22:34.230

LINQ 解析：

```
string input = "[Person]: [Age]-[21], [HairColor]-[Turqoise], [Gender]-[Other].";
var output = input.Split(new[] {':', '-', ','}, StringSplitOptions.RemoveEmptyEntries)
    .Select(s => s.Trim('[', ']', ' ', '.')).ToList();

var name = output.First();
var properties = output.Skip(1).ToList();

var propertyDic = Enumerable.Range(0, properties.Count()/2)
                         .ToDictionary(i => properties.ElementAt(2*i),
                                       i => properties.ElementAt(2*i + 1)); 
```

# python - 如何将我的程序的输出写入文件或列表

> ID：12273436
> 
> 赞同：0
> 
> 时间：2012-09-05T01:38:27.733
> 
> 标签：python, file-io

我的机器上有一个程序，它在我的终端窗口中运行，并返回信息列表。例如：

```
t000930_152536.SFTC   1369.000
t031109_124140.SFTC   1369.000
t140207_071131.SFTC   3094.000
t190222_011122.SFTC   1369.000
t100423_011232.SFTC   1369.000
t190423_021543.SFTC   1369.000
t190714_205113.SFTC   3094.000
t110115_085319.SFTC   3094.000 
```

我想做的就是用 Python 获取这些信息——无论是将其写入文件，还是将其设为列表..

这是我天真的尝试：

```
#!usr/bin/python
import os

os.chdir('./P574/J0998-1034')

f = open('1400list.txt','w')
os.system('vap -c freq *.SFTC') # this tells my other programme to create its list
f.close 
```

但是创建的文件仍然是空的。请在这个简单的问题上提供一些帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:47:28.423

尝试正常的文件重定向。假设，vap 在标准输出上打印它的信息，这种方法应该适合你：

```
#!usr/bin/python
import os

os.chdir('./P574/J0998-1034')
os.system('vap -c freq *.SFTC > 1400list.txt') 
```

# javascript - 带有嵌套 ajax 调用的 jQuery 延迟对象

> ID：12273437
> 
> 赞同：18
> 
> 时间：2012-09-05T01:38:35.387
> 
> 标签：javascript, jquery, jquery-deferred, promise

我有一种情况，我的 ajax 调用必须按特定顺序执行。我在其他情况下使用了 jQuery Deferred 对象，但似乎无法找到一种方法来使其行为适当。

我有一个函数可以在其生命周期内执行许多`ajax`请求。一些请求将在其他请求的成功回调期间执行。

我的问题：**有没有办法将所有嵌套的延迟对象返回到原始`$.when`调用？**

一个简化的例子是：

```
function nestedAjax() {
    $.get("/", function(){
        console.log("First ajax done.");
        $.get("/", function(){
            console.log("Second ajax done.");
        });
    });
}; 
```

我正在尝试使用这样的`nestedAjax`功能：`$.when()``$.done()`

```
$.when(nestedAjax()).done(function(){
    console.log("Complete");
});​ 
```

控制台输出读数：

```
> First ajax done.
> Second ajax done.
> Complete. 
```

我可以返回第一个`get`来实现这一点：

```
> First ajax done.
> Complete.
> Second ajax done. 
```

但显然这不是我所要求的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-05T13:50:48.683

It's actually quite simple. Though all the AJAX calls are Deferred objects, I still use one for the method itself.

```
function nestedAjax() {
    var dfd = $.Deferred();
    $.get("/echo/json/", function(){
        console.log("First ajax done.");
        $.get("/echo/json/", function(){
             console.log("Second ajax done.");
            dfd.resolve();
        });
    });

    return dfd.promise();
}; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-07T21:53:31.490

您实际上并不需要额外的延迟对象。您可以通过链接来做您想做的事情`then()`：

```
function nestedAjax() {
    return $.get("/echo/json/").then(function(result1){
        console.log("First ajax done.");
        if (result1) {
            return result1;
        } else {
            return $.get("/echo/json/").then(function(nestedResult){
                console.log("Second ajax done.");
                return nestedResult;
            });
        }
    });
}; 
```

我添加了一些逻辑，因为我认为这可能是您同步执行此操作的原因。之后，您可以`$.when`像这样使用结果：

```
$.when(nestedAjax(), $.get("/something/else")).then(function(nested, other) {
    console.log("Complete.", nested, other);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T09:23:06.747

由于某种原因，无法对上述答案添加评论。

所以我在这里添加我的评论。上面的答案只有在 ajax 调用很快并且在返回 dfd.promise() 之前返回时才有效。

我也有同样的问题。正如你所看到的。返回的延迟对象声明它是“待定的”：http: [//jsfiddle.net/BtEKa/](http://jsfiddle.net/BtEKa/)

# symbian - 为 Symbian OS v9.1、UIQ 3.0 开发应用程序

> ID：12273440
> 
> 赞同：1
> 
> 时间：2012-09-05T01:38:53.893
> 
> 标签：symbian

我对 Symbian 应用程序开发非常陌生。我正在谷歌搜索一些关于 Symbian 开发的初学者教程。由于版本多，手机厂商多，想请教一下已经在塞班开发实验的各位。。

我的目标是为使用 Symbian OS v9.1、UIQ 3.0 的索尼爱立信 w960i 手机开发小应用程序。

应用程序的目标是将所有传入/传出呼叫/消息保存为应用程序内某处（txt 文件或隔离存储）的备份。

例如：如果我打电话给某人，我的应用程序应该接收号码/联系人姓名的事件，以便我可以将其保存到其他地方。

有人可以帮我建议实现这一目标吗？

我可以使用诺基亚 Qt 为“索尼爱立信 w960i”开发应用程序吗？如果没有，我应该将哪个 SDK 用于我的应用程序？

诺基亚 Qt 能否用于访问呼叫触发器/消息？我读到 Qt 无法访问内部操作系统的东西，但不确定访问调用/消息是否可以被视为内部操作系统的东西。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T03:11:03.980

好吧，这里的主要问题是索尼爱立信和 UIQ 都不再存在了。

索尼吞下了第一家，第二家在诺基亚收购塞班后破产。

因此，无论您最终做什么，都不会得到官方支持。

您仍然可以使用 JavaME 为 w960i 开发应用程序，但它没有电话 API，因此它不会帮助您处理您描述的那种应用程序。

Qt 在 w960i 上根本不可用。

为了使用 Symbian OS C++ 开发应用程序，您需要 UIQ3 SDK。由于您无法再从任何官方来源下载它，您将不得不在网上搜索其他人上传的地方。希望您能找到一个具有合法且未经改动的 SDK 的 SDK。

SDK 中的文档将帮助您为应用程序创建特定于 UIQ 的 GUI。

对于您的应用程序的引擎，通用 Symbian OS C++ 就可以了。如果你是一个真正的初学者，我公认的有偏见的建议是购买一份[Symbian OS 上的快速食谱，](http://www.quickrecipesonsymbianos.com)因为你需要学习的内容基本上相当于阅读这本书的几个章节。书中的代码示例适用于 w960i，并将向您展示如何使用 Symbian 电话和消息传递 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T08:59:34.187

你对 UIQ 有绝对把握吗？这比塞班还要死。 [维基链接](http://en.wikipedia.org/wiki/UIQ#List_of_UIQ_3.x_Phones_and_its_Version)

顺便说一句，您也可以在 Qt 应用程序中使用 Symbian 代码。

# android - 在 Canvas 绘图中，如何移动由路径创建的 ShapeDrawble 对象？

> ID：12273450
> 
> 赞同：0
> 
> 时间：2012-09-05T01:41:21.170
> 
> 标签：android

在 Canvas 绘图中，如何移动由路径创建的 ShapeDrawble 对象才有效？

下面的代码貌似是通过新的路径来移动，所以每次都要重新创建ShapeDrawable对象。这非常浪费资源，有什么办法解决吗？

```
private void drawBitmapShape(Canvas canvas, Paint paint)
    {
         /*Draw a hollow triangle*/
        Path path=new Path();
        path.moveTo(10, 330);
        path.lineTo(70,330);
        path.lineTo(40,270);
        path.close();
        //canvas.drawPath(path, paint);

        /* create ShapeDrawable object and define the shape is elliptic */
        mShape = new ShapeDrawable(new PathShape(path, BitQQheight, BitQQheight));

        /* set up the ellipse things to draw for ShapeDrawable pictures */
        mShape.getPaint().setShader(mBitmapShader);
        /*set display area*/
        //BitQQheight=BitQQheight*2;
        mShape.setBounds(0,0, BitQQwidth, BitQQheight);

        /* draw ShapeDrawableQQ */
        mShape.draw(canvas);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T07:41:12.013

我想我已经解决了

```
private void drawBitmapShape(Canvas canvas, Paint paint)
    {
        canvas.save();
        canvas.translate(5, 5);
        // rotate
        //canvas.rotate(90, 60, 310);
         /*Draw a hollow triangle*/
        Path path=new Path();
        path.moveTo(10, 330);
        path.lineTo(70,330);
        path.lineTo(40,270);
        path.close();
        //canvas.drawPath(path, paint);

        /* create ShapeDrawable object and define the shape is elliptic */
        mShape = new ShapeDrawable(new PathShape(path, BitQQheight, BitQQheight));

        /* set up the ellipse things to draw for ShapeDrawable pictures */
        mShape.getPaint().setShader(mBitmapShader);
        /* set display area */
        //BitQQheight=BitQQheight*2;
        mShape.setBounds(0,0, BitQQwidth, BitQQheight);

        /* draw ShapeDrawableQQ */
        mShape.draw(canvas);
        canvas.restore();
    } 
```

# javascript - 如何修复javascript keydown中的延迟

> ID：12273451
> 
> 赞同：20
> 
> 时间：2012-09-05T01:41:23.300
> 
> 标签：javascript, html, canvas

> **可能重复：**
> [JavaScript 移动延迟和多次击键](https://stackoverflow.com/questions/11197220/javascript-move-delay-and-multiple-keystrokes)

我是新手，正在学习 HTML5 画布和 javascript。我创建了一个事件来左右移动对象，我的问题是每当您按住键或切换到另一个键时都会出现延迟。我知道下面的代码中缺少请帮助我。先感谢您。

```
c.addEventListener('keydown',this.check,true);
  function check(el) {
    var code = el.keyCode || el.which;
    if (code == 37 || code == 65){
    x -=1;
    }

    if (code == 39 || code == 68){
    x += 1;
    }

  el.preventDefault();
} 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-09-05T01:56:10.120

我建议您使用 keydown 和 keyup 事件来维护当前已关闭的键的列表，而不是尝试直接对 keydown 事件做出反应。然后实现一个“游戏循环”，每 x 毫秒检查哪些键按下并相应地更新显示。

```
var keyState = {};    
window.addEventListener('keydown',function(e){
    keyState[e.keyCode || e.which] = true;
},true);    
window.addEventListener('keyup',function(e){
    keyState[e.keyCode || e.which] = false;
},true);

x = 100;

function gameLoop() {
    if (keyState[37] || keyState[65]){
        x -= 1;
    }    
    if (keyState[39] || keyState[68]){
        x += 1;
    }

    // redraw/reposition your object here
    // also redraw/animate any objects not controlled by the user

    setTimeout(gameLoop, 10);
}    
gameLoop(); 
```

您会注意到，这可以让您一次处理多个键，例如，如果用户同时按下向左和向上箭头，并且当一个键被按住时后续 keydown 事件之间的延迟问题就会消失，因为您真正关心的只是是是否发生了keyup。

我意识到您可能没有实现游戏，但是这个“游戏循环”概念应该适合您，如这个非常简单的演示所示：http: [//jsfiddle.net/nnnnnn/gedk6/](http://jsfiddle.net/nnnnnn/gedk6/)

# objective-c - 使用 UIScrollView、UIImageView 和 Zooming 以及针对不同视图的单个代码

> ID：12273452
> 
> 赞同：1
> 
> 时间：2012-09-05T01:41:27.673
> 
> 标签：objective-c, uiscrollview, uiimageview, zooming

我对编程很陌生。我目前正在开发一个 iOS 应用程序，它使用 UIButtons 来访问不同的`UIViews`. 每个都包含一个`UIScrollView`包含一个`UIImageView`。目的是拥有可缩放、可滚动和可平移的图片。我找到了一个很好的例子来说明如何做所有这些，但是代码用 @ 声明了一个图像，所以我必须创建几个`UIViews`并为每个生成代码来管理特定的`UIImage`（因为它们都有不同的名称）和`UIScroll`. 这是不切实际的。我需要的是有一个`UIViewContoller`用于不同视图的单一代码和一个处理具有不同图片的视图的代码。

这是将图像设置为滚动和缩放并将其添加到滚动视图的代码（尽管我想通过情节提要直观地包含图像，而不是通过代码）。

```
- (void)viewDidLoad {
    [super viewDidLoad];

    // Title

    self.title = @"Image";

    // Set up the image to scroll & zoom and add it to the scroll view

    UIImage *image = [UIImage imageNamed:@"photo1.png"];

    self.imageView = [[UIImageView alloc] initWithImage:image];

    self.imageView.frame = (CGRect){.origin=CGPointMake(0.0f, 0.0f), .size=image.size};

    [self.scrollView addSubview:self.imageView]; 
```

请帮忙！！

谢谢你。

# java - Eclipse 4.2 桌面 MVC JavaFX 2.0

> ID：12273454
> 
> 赞同：1
> 
> 时间：2012-09-05T01:41:34.263
> 
> 标签：java, eclipse, swing, javafx-2

我现在正在使用 Eclipse 4.2 [Juno] 在我的桌面开发中迁移到 JavaFX。JavaFX 还很年轻，它的大部分文档仍在使用 Netbeans IDE，是否有 Eclipse IDE 的文档 [可能从 Helios 到现在]？但这不是我真正的问题。

Model-View-Controller 可以简化桌面和 Web 平台的开发。此外，在桌面开发中，我们可以通过实例化 a 来调用它（在我的 MVC 方法中）`View`。**我的问题是，如果我要迁移到 JavaFX，我是否仍会像在 Swing 中那样遵循创建表单的相同程序？**如果我的日常生活发生了很大的变化，请说明当时将如何做。通常在我的 MVC 方法中，它保存了如何在其中呈现的布局和方法。例如：`Controller`**`View``Model(s)`**

 **```
import javax.swing.*;
public class SampleView extends JFrame  {
   // javax.swing.* Components, i.e. JTextField, JPanel, etc.
   public SampleView() {
      initializeLayout();      
   }
   private void initializeLayout() {
      // How the components are to be placed using `GroupLayout`
   }
   // others methods for rendering Model(s) in this view
   // EventHandling of components are placed the Controller of this View.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T12:24:12.803

> JavaFX 还很年轻，它的大部分文档仍在使用 Netbeans IDE，是否有 Eclipse IDE 的文档 [可能从 Helios 到现在]？

不是官方的，但这里的插件[http://efxclipse.org](http://efxclipse.org)提供了很多很酷的特性和示例，可以简化在 Eclipse 上使用 JavaFX 2 进行编程的过程（至少在 3.X 中它很棒）。至于其余的（主要是部署它），*没有痛苦，没有收获*的思维方式获胜。

> 我的问题是，如果我要迁移到 JavaFX，我是否仍会像在 Swing 中那样遵循创建表单的相同程序？

**不**

顺便说一句，你真的可以坚持使用 swing，但 JavaFX 和它的新工具真的会说服你不要这样做。由于您正在谈论 MVC，您将很高兴看到 FXML 功能如何将视图与控制器清晰地分开，并使创建用户界面变得非常简单。如果您仍然不喜欢 FXML 语言，您可以使用[Scene Builder](http://docs.oracle.com/javafx/scenebuilder/1/overview/jsbpub-overview.htm "场景生成器")甚至以编程方式创建您自己的视图类（即使用 Java）。

无论如何，在 JavaFX 2 中编程用户界面比 java 容易得多，结果也更漂亮。**

# haxe - 使用 Awe6 游戏框架的动画精灵

> ID：12273457
> 
> 赞同：0
> 
> 时间：2012-09-05T01:41:51.560
> 
> 标签：haxe, nme

我正在寻找一种在我的游戏中添加动画角色的方法。我想在他跑步时有一个跑步动画循环，在他跳跃时有一个跳跃动画等。

awe6 框架是否提供了这样的功能？也许使用精灵表，或者为每一帧单独的图像。

如果我必须使用自己的系统，是否有任何流行的库可以帮助做到这一点，并且与 awe6 配合得很好？我将如何将它与框架一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T08:44:52.600

awe6 不是开箱即用的东西，而是供您构建的架构。它不是为了满足您的要求而设计的，无需您的工作，并且要求您至少有一个很好的理解来集成另一个框架/目标运行时来满足您的需求。他们确实有一个 wiki，但是您可以从[http://code.google.com/p/awe6/wiki/QuickStart](http://code.google.com/p/awe6/wiki/QuickStart)

有许多流行的框架进入门槛较低，例如 haxepunk.com、haxeflixel.com、[https:](https://github.com/aduros/flambe) //github.com/aduros/flambe，它们都有自己的优势/劣势等供您决定并且都可以轻松完成您的请求。

# ios - 如何快速读写浮点数据，而不是使用字符串？

> ID：12273459
> 
> 赞同：1
> 
> 时间：2012-09-05T01:42:04.127
> 
> 标签：ios

我有许多从图像生成的浮点数据。我想将它存储到一个文件中，比如 XX.dat （一般在 C 中）。我会再读一遍以做进一步的处理。

我有方法用 nsstring 表示浮点数并将其写入 .txt 文件。但它太慢了。是否有一些函数与 c 中的 fwrite( *data , *pfile) 和 fread(*buf, *pfile) 相同？还是一些新想法？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:04:50.827

在 iOS 中，您仍然可以使用标准的低级文件（和套接字等）API。因此，您可以像在任何其他 C 程序中一样使用`fopen()`、`fwrite()`、`fread()`等。

这个问题有一些在iOS上使用低级文件API的例子： [iPhone Unzip code](https://stackoverflow.com/questions/412982/iphone-unzip-code)

另一个要考虑的选择是将你的浮点数写入一个`NSMutableData`实例，然后将它写入文件。这将比将所有内容转换为字符串更快（您将获得二进制文件而不是文本文件），尽管可能仍然不如使用低级 API 快。而且您可能必须使用类似的东西[在](https://stackoverflow.com/questions/3606331/byte-array-to-double)浮点数和字节数组之间进行转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:00:35.440

如果您熟悉较低级别的访问，您可以映射您的文件，然后像访问任何已分配的内存一样直接访问数据。

# php - 选择全文检索语句

> ID：12273463
> 
> 赞同：0
> 
> 时间：2012-09-05T01:42:39.800
> 
> 标签：php, mysql, select

这是设置的方式，它将为`$term`变量中的多个单词提取结果。我希望它提取只匹配`$term`主列、辅助列、子列之间跨度内所有单词的结果。

现在如果`$term`是：“Hello World”，它将从数据库中提取结果：

```
编号 | 主要 | 中学 | 子

01 | 声明 | 你好世界| 废话
02 | 你好 | 这是怎么回事？| 什么都在这里
03 | 生命之石| 万维网| 这里还有什么
04 | 世界上哪里| 她说你好 | 呜呜
```

当我只想要结果 01 和 04 时，因为它们包含 Hello And World 的完整 $term

这是我的代码。我试过在这里和谷歌搜索。但事实上，我不知道要寻找什么。我找到的只是全文搜索文档，我已经在这里做了。我还没有找到任何人说如何得出确切的结果。（存在 sprintf 是因为我想我需要它才能在 JSON 响应中返回它？

```
$query = sprintf("SELECT id, main, secondary, sub, 
    MATCH(main, secondary, sub) AGAINST('". $term ."' IN BOOLEAN MODE) AS score 
    FROM list_genres 
    WHERE MATCH (main, secondary, sub) AGAINST('". $term ."' IN BOOLEAN MODE)
    ORDER BY score DESC LIMIT 15"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:52:37.360

如果我没记错的话，默认操作`BOOLEAN MODE`是`OR`. `+`在您要查找的术语前面添加符号应该可以解决问题。

```
$term = "+Hello +World" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:54:06.037

你的句子是错误的，首先**sprintf()**应该接收作为参数，术语，并在你想将它添加到 sql 的任何地方使用 %s ，对于多个单词，你需要`+`为每个单词添加一个。

代码应该是这样的：

```
$term = '+' . str_replace(' ',' +',$term); // Remove this line if you don't want search multiple terms
$query = sprintf("SELECT id,main,secondary,sub, MATCH(main, secondary, sub) AGAINST('&s' IN BOOLEAN MODE) as score 
    FROM list_genres WHERE MATCH (main, secondary, sub) AGAINST('%s' IN BOOLEAN MODE) 
    ORDER BY score DESC LIMIT 15", $term, $term); 
```

# jquery - jQuery更改标题/标题中第二个单词的颜色

> ID：12273465
> 
> 赞同：-1
> 
> 时间：2012-09-05T01:43:05.937
> 
> 标签：jquery, jquery-selectors

我目前正在使用这个 JavaScript 来更改每个小部件标题中第二个单词的颜色。但是使用这段代码，当它遍历每个小部件时，它最终会打印页面上所有小部件的所有标题，并在每个小部件标题中。例如，我有两个标题为“近期工作”和“近期新闻”的小部件。Work and Press 应该是橙色的。使用此代码，它会输出“Recent WorkRecent Press”，其中“Work”和“Recent”都是橙色的。这在两个小部件标题中打印相同。我怎样才能编辑它，使它成为第二个或最后一个，因为每个标题只有两个字长，橙色字？

```
var split = $("h4.widgettitle").text().split(" ");

if(split.length > 0) {
$("h4.widgettitle").html('').append("<span class='firstWord'>" + split[0] + "<span> ");

if(split.length > 1) {
    $("h4.widgettitle").append("<span class='secondWord'>" + split[1] + "<span> ");
    for(var i=2;i<split.length;i++) {
        $("h4.widgettitle").append(split[i] + " ");
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:52:55.470

最快的方法：

```
$('h4.widgettitle').each(function(){

    var text = $(this).text().split(' ');
    if(text.length < 2)
        return;

    text[1] = '<span class="secondWord">'+text[1]+'</span>';

    $(this).html( text.join(' ') );

}); 
```

[看到它运行](http://jsfiddle.net/tmz9t/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T01:55:33.303

这些方面的东西应该适合你。无论标题中有多少单词，它都会将所有 h4.widgettitle 元素中的第二个单词涂成红色。

```
$("h4.widgettitle").each(function(){
    var title_list = $(this).text().split(" ");
    var new_title = "";
    for (var i = 0; i < title_list.length; i++) {
        if (i == 1) {
            new_title += "<span class='secondWord'>" + title_list[i] + "</span> ";
        } else {
            new_title += "<span class='notSecondWord'>" + title_list[i] + "</span> ";
        }
    }
    $(this).html(new_title);
})​​ 
```

检查一下[小提琴哟](http://jsfiddle.net/b3zu2/)

# c# - 获取泛型参数实例的属性值

> ID：12273470
> 
> 赞同：1
> 
> 时间：2012-09-05T01:44:40.210
> 
> 标签：c#, generics, reflection

使用反射：

如果我有一个类型的实例`X<Y>`（我不知道到底`Y`是什么），因为`X`它是一个泛型类型 ( `X<T>`)，我如何获得一个属性的值`Y`？

就像是：

```
Type yType = currentObject.GetType().GetGenericArguments()[0];

// How do I get yInstance???
var yInstance = Convert.ChangeType(???, yType); 
```

我需要去：

```
object requiredValue = yType.GetProperty("YProperty").GetValue(yInstance, null); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:03:04.687

使用以下方法获取通用参数的 PropertyInfo 对象：

```
PropertyInfo myProperty = myGenericType.GetType().GenericTypeArguments[0].GetProperty("myPropertyName"); 
```

其中“0”是类定义中泛型类型的索引，“myPropertyName”是属性的名称。之后，像使用任何其他 PropertyInfo 对象一样使用它，例如：

```
myProperty.GetValue(obj); // Where obj is an instance of the generic type 
```

[编辑：下面的原始答案]

如果 Y 必须具有属性，则将类型 T 限制为必须实现包含该属性的接口的类型。例如：

```
public class MyGenericClass<Y> where Y:IMyInterface 
```

然后将泛型对象转换为接口并调用属性。

# version-control - 提醒在 Queue New Build 之前签入 TFS

> ID：12273472
> 
> 赞同：0
> 
> 时间：2012-09-05T01:45:07.017
> 
> 标签：version-control, build, tfs, msbuild

这让很多 TFS 的新手绊倒，我很想听听您的解决方案。

因此，您已经修复了一个错误，对其进行了测试，看起来不错，每个人都在您之上，以尽快将其解决，因此您将新的远程构建排队，耐心等待，然后将其投入测试/生产，只是发现出它实际上是一个旧版本 - 你在构建之前忘记签入！

好的，所以这是一个常见的疏忽，它会花费宝贵的时间。是否可以先弹出警告，或者是否有其他人发现了一些巧妙的技巧来避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T10:55:37.527

与其在签入后手动启动构建，不如设置“持续集成”构建，以便在您签入后自动启动构建？这样就不可能忘记签入您的更改。这是一篇关于如何设置它的文章：http: [//msdn.microsoft.com/en-us/library/bb668971.aspx](http://msdn.microsoft.com/en-us/library/bb668971.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T22:45:04.067

上面提到的持续集成是最好的解决方案！:)

但是您可以在构建定义中编写自定义活动，以检查自上次构建以来是否有任何新的变更集，如果没有新的变更集在构建日志或其他内容中显示警告消息，但开发人员必须再次阅读记录否则它没有用。

这样的事情我根本不会花时间，我宁愿每次他错过签到时都敲开发者的头！:}

# iphone - iPhone 应用程序的开发版本何时到期？

> ID：12273473
> 
> 赞同：2
> 
> 时间：2012-09-05T01:45:11.827
> 
> 标签：iphone, ios

如果一个应用程序通过调试运行安装在 iPhone 上，它什么时候会过期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:09:14.010

当其配置文件过期时，它将停止工作。您可以在 Apple 的配置门户或 Xcode 的管理器窗口中查找此日期（command+shift+2）

![在此处输入图像描述](../Images/1b7852cafb642f49867738734745fb19.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:09:22.250

正如@aroth 所说

> 当您的开发配置文件到期时，很有可能。

其中包括开发和分发（AppStore、Ad-Hoc）配置文件。您可以在以下位置查看到期时间

> Xcode -> 管理器 -> 设备 -> 你的设备 -> 配置文件 -> 你的开发配置文件 -> 过期

它也可能是一个像`iOS Team Provisioning Profile`. 在这种情况下，您不需要每次都为您的新应用创建开发配置文件。

# imagemagick - 将 ImageMagick 中的多个图像与相对（非绝对）偏移量相结合

> ID：12273479
> 
> 赞同：8
> 
> 时间：2012-09-05T01:46:10.973
> 
> 标签：imagemagick, imagemagick-convert

我正在寻找在 ImageMagick 中将多个图像拼接在一起的最有效方法，在背景图像之上，这样重叠图像之间的间距/填充是一致的？

我研究了 +append 的使用、转换 -composite 以及使用 -page 和 -layers 合并进行转换。

以下命令 (convert -composite) 有效，但需要预先计算图像尺寸以指定绝对偏移量。真的，我想要在第一个分层图像的结尾和第二个分层图像的开始之间有 10 像素的间隙，但我能看到的唯一方法是指定从画布左上角的绝对偏移量.

```
convert \
  background.jpg \
  first.jpg -gravity Northwest -geometry  +10+10 -composite \
  second.jpg                   -geometry +300+10 -composite \
  third.jpg                    -geometry +590+10 -composite \
  output.jpg 
```

我正在寻找某种运算符，以便可以相对于分层中的“最后一个”图像解释水平偏移量，因此我可以指定一个偏移量，而不是指定`+300+10`第二个图像和第三个图像。`+590+10``+10+10`

`-gravity Northwest`我认为重力可以让我以与 CSS 定位相同的方式实现 ( ) `float: left;`，但事实并非如此。

我在以下方面也取得了一些成功：

```
convert \
  -page  +10+10 first.jpg  \
  -page +300+10 second.jpg \
  -page +590+10 third.jpg  \
  -background transparent  \
  -layers merge \
   layered.png

convert background.jpg layered.png -gravity Center -composite output.jpg 
```

所描述的两种技术都需要预先计算绝对偏移量，这有点麻烦。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T03:28:10.780

你忽略了`montage`命令。

添加所需间距的最简单命令是`-frame 5`使用`-mattecolor none`. 这适用于不同宽度值的图像，并将它们全部分开 10 像素的距离：

```
montage             \
  -alpha on         \
  -background none  \
  -mode concatenate \
  -tile x1          \
  -frame 5          \
  -mattecolor none  \
   *.jpg            \
   output1.png 
```

但是，您会很容易注意到，生成的图像的边框在顶部、右侧、底部和左侧只有 5 个像素宽。要删除这 5 个像素，请使用：

```
convert  output1.png  -shave 5  output2.png 
```

要将此结果覆盖在您的 上`background.jpg`，请使用：

```
convert             \
  background.jpg    \
  output2.png       \
 -gravity Northwest \
 -geometry +10+10   \
 -composite         \
  final.jpg 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-24T21:52:02.523

你也可以使用 Kurt 的透明框架技巧和 append。使用附加而不是蒙太奇的优点是您可以使用重力设置来对齐图像顶部（北）底部（南）或中心。

这是一个示例，说明如何水平附加图像，它们之间有 10 像素的间隙，并且图像顶部对齐：

```
convert \
  -frame 5 \
  -mattecolor none \
  -background none \
  -gravity north \
  first.jpg second.jpg third.jpg \
  +append \
  png:- | convert - -shave 5
  output.png 
```

要垂直附加图像，请使用 -append 而不是 +append。我用过管道 | 在同一命令中刮掉外框。

# javascript - 动态添加哈希标签不起作用

> ID：12273480
> 
> 赞同：0
> 
> 时间：2012-09-05T01:46:37.073
> 
> 标签：javascript, jquery, hashtag

我正在使用脚本将哈希标记添加到页面的 URL。（我知道我可以将链接键入为 url.com/page.html#align-page 但对于没有哈希标签的用户，我会动态添加它以将他们引导到我想要的位置。）

我可以看到页面 URL 中添加的井号标签，但有时会转到正确的 div，有时则不会。

为什么这不能 100% 工作？

这是脚本（这个脚本在`<head>`）

```
var $j = jQuery.noConflict();
  $j(document).ready(function(){    

     window.location.hash = "align-page";

}); 
```

注意：该脚本包含在 中，`$j(document).ready(function(){`因为此处未列出的其他脚本也在`{ }`. 如果它需要放在`{ }`我可以移动它的外面。

此外，如果有更好的方法来使用 jQuery 或其他方法来做到这一点，我会欢迎的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:41:03.663

试试这个：

```
var $j = jQuery.noConflict();
  $j(document).ready(function(){    

     window.location = "#align-page";

}); 
```

# ruby - Sinatra 正确输出到控制台，但没有输出到浏览器

> ID：12273488
> 
> 赞同：0
> 
> 时间：2012-09-05T01:47:38.450
> 
> 标签：ruby, rss, sinatra

我想通过 Sinatra 输出 RSS。我写了下面的代码，但它什么也没输出。奇怪的是，当我之前写的`puts`时候`rss`，它正确地将 rss 输出到控制台！为什么我不能输出到浏览器？

```
#encoding: utf-8

require 'sinatra'
require 'rss'

...

get '/' do

  ...

  rss = RSS::Maker.make("2.0") do |rss|
    rss.channel.about = 'http://hoge/rss.xml'
    rss.channel.title = "hoge"

    ...

  end

  content_type = 'application/xml'  
  # puts rss # => output correctly to console
  rss # => output nothing
end 
```

整个代码：[https ://github.com/weed/p120905-rss-process-test/blob/master/app.rb](https://github.com/weed/p120905-rss-process-test/blob/master/app.rb)

谢谢你的好心。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T03:00:05.303

Sinatra 似乎不知道如何处理 RSS 对象。

如何将 get 块中的最后一行更改为

```
rss.to_s 
```

# php - 如何在 Zend Framework 中连接表？

> ID：12273493
> 
> 赞同：0
> 
> 时间：2012-09-05T01:48:30.767
> 
> 标签：php, mysql, zend-framework

嗨，我在 codeigniter 中有我的查询，因为我已经切换到 Zend 框架，我想在 zend 框架中进行查询：

这是我的示例查询：

```
$sql = "SELECT Mes.fromid, Mes.is_read AS is_read, Mes.id AS mesid, Mes.message AS message, 
                 max(Mes.date) AS date, User.username AS username, User.id AS Uid
                FROM  `messages` AS Mes
                LEFT JOIN users AS User ON User.id = Mes.fromid
                WHERE Mes.toid = ? AND Mes.fromid <> ?
                GROUP BY Mes.fromid ORDER BY date DESC"; 

        $query = $this->db->query($sql, array($fromid, $fromid));

        return $query->result(); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T16:21:24.310

```
$select = $this->select()
            ->setIntegrityCheck(false)
            ->from(
                array('Mes' => 'messages'), 
                array('fromid', 'is_read AS is_read', 'id AS mesid', 'message AS message', 
                    'max(Mes.date) AS date')
            )
            ->joinLeft(array('User' => 'users'), "User.id = Mes.fromid", array('username AS username', 'id AS Uid'))
            ->where('mes.toid = ? ', $toid)
            ->where('mes.fromid = ?', $fromid)
            ->group('mes.fromid')
            ->order('date DESC'); 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:32:39.847

```
 $sql =  $db ->select()
             ->from('messages as mes',array('fromid','is_read','id as mesid','message','max(date) as date'))
             ->join('users as user','user.id = mes.fromid',array('username','id as uid'))
             ->where('mes.toid = ? ', $toid)
             ->where('mes.fromid = ?', $fromid)
             ->group('mes.fromid')
             ->order('date DESC'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T01:58:33.047

查看[Zend_Db_Statement](http://framework.zend.com/manual/en/zend.db.statement.html)，看起来您只需进行很少的编辑即可完成这项工作。

可能只是将 Db 适配器更改为 Zend 适配器，它可能会工作。

# asp.net-mvc - MVC 会话到期但未进行身份验证

> ID：12273494
> 
> 赞同：10
> 
> 时间：2012-09-05T01:48:35.777
> 
> 标签：asp.net-mvc, forms-authentication, session-timeout

我正在开发一个 C# MVC 应用程序，我似乎无法让身份验证和会话超时同步。我有一个基本的表单身份验证设置和一些有限的会话值。我将身份验证超时设置为小于会话（28 分钟对 30 分钟），但针对开发 Web 服务器运行，会话将在服务器重新启动时被擦除，但身份验证仍然存在。我假设身份验证存储在一个显然在服务器重新启动后仍然存在的 cookie 中。

```
<authentication mode="Forms" >
  <forms loginUrl="~/Account/Login" timeout="28" />
</authentication>
<sessionState timeout="30" /> 
```

我想如果 Session 为空，我想强制身份验证超时，然后强制登录。

那是我真正想做的吗？如果是这样，我该如何以及在哪里执行此操作？

如果不是，那么处理此问题的正确方法是什么？

**编辑**

对于更多的观点，我还为同一个项目发布了这个问题：[登录为...最佳实践？](https://stackoverflow.com/questions/12281191/login-as-best-practices)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-12T17:27:21.740

我找到了我的答案。覆盖授权属性。这似乎是最优雅的方法：

```
public class AuthorizeWithSessionAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if (httpContext.Session == null || httpContext.Session["CurrentUser"] == null)
            return false;

        return base.AuthorizeCore(httpContext);
    }

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-05T04:28:21.023

您可以使用 PreRequestHandlerExecute 事件处理程序在 global.asax 中处理此问题

```
protected void Application_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        //Check if user is authenticated
        HttpCookie authCookie = Request.Cookies[FormsAuthentication.FormsCookieName];
        if (authCookie != null)
        {
            FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCookie.Value);
            if (!authTicket.Expired)
            {
                if (Session["XYZ"] == null)
                {
                    //Session is null, redirect to login page
                    FormsAuthentication.SignOut();
                    Response.Redirect(FormsAuthentication.LoginUrl, true);
                    return;
                }
            }
        }
    } 
```

或者，您可以编写一个 Httpmodule 并实现`context_AuthenticateRequest`以检查会话是否存在并相应地处理请求。

希望有帮助。

**瓦拉马斯编辑**

有关会话错误的帮助，请参阅答案[https://stackoverflow.com/a/1446575/511438 。](https://stackoverflow.com/a/1446575/511438)

# python - 从python数组中选择多个元素

> ID：12273495
> 
> 赞同：3
> 
> 时间：2012-09-05T01:48:42.413
> 
> 标签：python

如何从 python 数组中选择多个元素？我知道这在 numpy 数组中是可能的，但在这种情况下我不能使用 numpy 数组。我想选择类似于掩码数组用法的数组的某些元素，但在 python 中出现以下错误

```
 nonzero = numpyarray.nonzero()
 pythonarray[nonzero] = numpyarray[nonzero]
 *** TypeError: only integer arrays with one element can be converted to an index 
```

`numpyarray[nonzero]`工作正常，但我无法访问`pythonarray[nonzero]`. 有没有办法在 python 数组中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:54:10.450

只需使用一个循环：

```
for idx in nonzero:
    pythonarray[idx] = numpyarray[idx] 
```

Numpy 数组可能支持 n 元索引以最大化性能；Python 列表在优化方面并没有那么远，因此您必须使用更简单的方法。

# php - php登录脚本没有给出预期的结果，或者任何

> ID：12273501
> 
> 赞同：1
> 
> 时间：2012-09-05T01:49:52.727
> 
> 标签：php

我有一个 php 登录脚本，可以通过一个简单的表单访问它：

```
<?php
session_start();
try{
    $user = 'root';
    $pass = null;
    $pdo = new PDO('mysql:host=localhost; dbname=divebay;', $user, $pass);

    if(isset($_SESSION['loggedin'])){

        echo "1"; //already logged in
    }

    else{
        $username = $_POST['username'];
        $password = sha1($_POST['password']);

        $ucheck = $pdo->prepare('SELECT * FROM user WHERE username = ?');
        $ucheck->bindValue(1, $username);
        $ucheck->execute();

        if($ucheck->fetch(PDO::FETCH_OBJ)){
            $stmt = $pdo->prepare('SELECT * FROM user WHERE username = ? AND password = ?');
            $stmt->bindValue(1, $username);
            $stmt->bindValue(2, $password);

            if($stmt->fetch(PDO::FETCH_OBJ)){
                $row = $stmt->fetch(PDO::FETCH_ASSOC);

                $_SESSION['username'] = $row['username'];
                $_SESSION['loggedin'] = 'YES';
                $_SESSION['location'] = $row['location'];
                echo "2"; //logged in

            }
            else{
                echo "3"; //password incorrect
            }
        }
        else{
            echo "4"; //user does not exist
        }

    }
}catch(PDOException $e){
    echo $e->getMessage();
}

?> 
```

但是当我尝试使用我刚刚创建并已确认存在于数据库中的帐户运行它时，我没有从该脚本中得到任何响应。鉴于登录信息是正确的，我希望它回显 2，但我什么也没得到

谁能建议我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:57:35.360

您似乎忘记了`execute()`以下声明：

```
 if($ucheck->fetch(PDO::FETCH_OBJ)){
        $stmt = $pdo->prepare('SELECT * FROM user WHERE username = ? AND password = ?');
        $stmt->bindValue(1, $username);
        $stmt->bindValue(2, $password);

        // Execute it!!!
        if ($stmt->execute()) {
          $row = $stmt->fetch(PDO::FETCH_OBJ);

          if ($row) {
            // And don't call fetch() again, since you would already have advanced
            // the record pointer in the first fetch() above. If one record was returned,
            // this one would always be FALSE.
            //$row = $stmt->fetch(PDO::FETCH_ASSOC);

            $_SESSION['username'] = $row['username'];
            $_SESSION['loggedin'] = 'YES';
            $_SESSION['location'] = $row['location'];
            echo "2"; //logged in
          }
          // else execute failed...
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:17:51.987

你确定`session.use_cookies = 1`在 php.ini 中吗？

请确保名称是 PHPSESSION cookie。

# asp.net - ModelState.IsValid 返回 true，即使所需的字符串为 null

> ID：12273503
> 
> 赞同：6
> 
> 时间：2012-09-05T01:49:55.867
> 
> 标签：asp.net, linq-to-sql, webforms, model-binding

# 情况

我有一个包含三列的表的 LINQ-TO-SQL 模型。通常的*ID*（身份，自动生成），然后是*int类型**的 A*和*varchar(MAX)*类型的*B。*所有列都在数据库中定义为*NOT NULL*。

 ***在*WebForms*页面上，我声明了一个绑定到项目的 DetailsView：

```
<asp:ValidationSummary runat="server" ShowModelStateErrors="true" />
<asp:DetailsView DataKeyNames="Id" runat="server" ItemType="test.MyTable"
    SelectMethod="..." UpdateMethod="...">
      <Fields>
        <asp:DynamicField DataField="A" />
        <asp:TemplateField>
            <EditItemTemplate>
                <asp:TextBox ID="B" runat="server" TextMode="MultiLine" Columns="80" Rows="8" Text="<%# BindItem.B %>" />
            </EditItemTemplate>
            <ItemTemplate>
                <pre><asp:Label runat="server" Text="<%# Item.B %>"  /></pre>
            </ItemTemplate>
        </asp:TemplateField>
      </Fields>
</asp:DetailsView> 
```

所有这些代码都在 ASP.NET 4.5 上的 Visual Studio 2012 中运行。

# 怎么了

到目前为止，一切都很好。更新和查看作品。当我输入无效值时，问题就开始了。*对字段A*使用 ""会在页面顶部显示一个很好的错误消息。耶！但是，当我使用 "" 作为字段*B*的值时，会发生这种情况：

```
 public void DetailsView_UpdateItem(int id)
    {
      var item = db.MyTable.Where(row => row.Id==id).Single();
      TryUpdateModel(item);
      if (ModelState.IsValid)
        db.SubmitChanges();
    } 
```

1.  调用 UpdateItem 方法
2.  TryUpdateModel 工作并将表单值填充到*item*中。
3.  调试时，我可以看到*item.B*为*null*，正如预期的那样
4.  然后***ModelState.IsValid*返回*true* ?!?**
5.  *对db.SubmitChanges()*的调用失败并出现异常

# 问题

当数据模型指定*B*不能为*null*时，我不明白为什么*ModelState.IsValid*会返回*true*。有人可以解释一下吗？我究竟做错了什么？

 **# 解决方法

我尝试的一件事是通过包含以下代码向数据类添加数据注释。它没有用。

```
 [MetadataType(typeof(MyTableMetadata))]
  public partial class MyTable
  {
  }

  public class MyTableMetadata
  {
    [Required]
    [StringLength(255,MinimumLength=1)]
    public string B { get; set; }
  } 
```

很明显，我可以在*UpdateItem*方法中手动检查*null*或者我可以添加一个 RequiredFieldValidator - 但我不想这样做。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T09:39:54.850

只是一些随意的建议：确保您引用 System.ComponentModel.DataAnnotations 3.5。（不是 3.6）或其他一些正确的命名空间（据我所知，有一些仅用于 WCF RIA 服务）。尝试不同的设置 [DisplayFormat(ConvertEmptyStringToNull = ... )] 确保您正在执行 POST 请求 =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T09:18:29.300

为什么你认为你得到一个空值？空字符串不等同于 null。您可以通过手动检查 null 来确认这一点，就像您建议的那样。

除了非空约束之外，您还可以添加一个`StringLengthAttribute`以强制执行非空约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T18:26:05.113

TryUpdateModel() 方法本质上（简化了很多）使用模型类中的字段/属性的名称来在帖子的表单集合中查找发布的值。在 asp.net 网格的情况下，您为文本框指定 ID = B，控件的名称变为类似于 ctl00$B 的名称。模型绑定器将无法连接这些点并从表单集合中获取值，即使它存在于帖子中。

我觉得为您的可编辑字段使用“asp:BoundField”可能会解决您的问题。您也可以考虑编写自定义模型绑定器或自己分配值。更改模型中的属性名称以匹配生成的控件的名称是解决问题的另一种方法（请不要选择此选项。）

TryUpdateModel() 在找到帖子中的值但无法将值转换为模型中的类型时将返回 false。否则返回真。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-28T12:08:42.210

公共类 SecurityLayer { StringBuilder SB = new StringBuilder();

```
 public string SecurityValidate(object OBJ)
    {
        SB.Clear();
        var context = new ValidationContext(OBJ, serviceProvider: null, items: null);
        var results = new List<ValidationResult>();

        var isValid = Validator.TryValidateObject(OBJ, context, results);

        if (!isValid)
        {
            foreach (var validationResult in results)
            {
                //    Console.WriteLine(validationResult.ErrorMessage);
                SB.AppendLine(validationResult.ErrorMessage);
            }
        }

        return (SB.Length == 0 ? "SUCCESS" : SB.ToString());
    }
} 
```******

# haskell - 找到 n 使得 fn 在 Haskell 中最大化

> ID：12273504
> 
> 赞同：1
> 
> 时间：2012-09-05T01:50:14.800
> 
> 标签：haskell

我正在使用 Project Euler 问题来学习 Haskell，并且我在许多这些问题中发现了一个反复出现的主题，我需要找到一个值`n`来为函数提供一些属性（通常是最小值或最大值）`f n`。当我建立一个解决方案时，我经常发现创建一个对列表很方便`(n, f n)`。这有助于我快速查看我的逻辑是否有任何错误，因为我可以检查问题陈述中给出的示例。然后我“过滤”出给出解决方案的单对。我对问题 47 的解决方案就是一个例子：

```
-- Problem 47

import Data.List
import ProjectEuler

main = do
    print (fst (head (filter (\(n, ds) -> (all (==consecutiveCount) ds)) 
                       (zip ns (map (map length) 
                                    (map (map primeDivisors) consecutives))))))
    where consecutiveCount = 4
          consecutive n start = take n [start..]
          consecutives = map (consecutive consecutiveCount) ns
          ns = [1..] 
```

在我看来，有一个更“haskelly”的方式来做到这一点。在那儿？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T02:14:38.193

使用`maximumBy`from`Data.List`和`comparing`from `Data.Ord`，例如

```
maximumBy (comparing snd) [(n, f n) | n <- ns] 
```

这将为`f`每个`n`. 如果`f`计算成本低廉，您可以使用更简单的

```
maximumBy (comparing f) ns 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T14:27:31.043

好吧，你可以把你的函数写成

```
main = print $ fst $ head 
         [ (x,ds) | x <- [1..]
                  , let ds=map primeDivisors [x..x+3], all ((==4).length) ds] 
```

您可以认为使用`Control.Arrow`'s`(&&&)`或“扇出”“更像 Haskelly”

```
 filter (all ((==4).length).snd) 
          . map (id &&& (\x-> map primeDivisors [x..x+3])) $ [1..] 
```

为了能够调整代码以首先尝试简单的示例，您通常会将其设为函数，对感兴趣的变量进行抽象，如下所示：

```
test n m = [ x | x <- [1..], all (==n) $ map (length.primeDivisors) [x..x+m-1]] 
```

搜索`m`具有`n`不同质因数的连续数。实际上没有必要在最终代码中进行分解。

# java - LWJGL 仅在屏幕上旋转一个对象

> ID：12273506
> 
> 赞同：0
> 
> 时间：2012-09-05T01:50:41.097
> 
> 标签：java, 3d, rotation, lwjgl

我正在尝试旋转屏幕上的两个对象之一。我该怎么做？我只能让它旋转屏幕上的所有对象。代码：

```
 glColor3f(1, 0, 0);
        glBegin(GL_QUADS);
            glVertex3f(0f, 0f, 0f);
            glVertex3f(0f, .5f, 0f);
            glVertex3f(.5f, .5f, 0f);
            glVertex3f(.5f, 0f, 0f);
        glEnd();
        glRotated(.1, 0f, 1f, 0f);
        glRotated(.1, 1f, 0f, 0f);
        glRotated(.1, 0f, 0f, 1f);
        glBegin(GL_QUADS);
            glVertex3f(2f, 0f, 0f);
            glVertex3f(2f, .5f, 0f);
            glVertex3f(2.5f, .5f, 0f);
            glVertex3f(2.5f, 0f, 0f);
        glEnd(); 
```

我到目前为止的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T01:53:48.703

`glRotated`在不重置矩阵的情况下无休止地调用是一个坏主意。舍入误差会累积。您目前不调用`glIdentity`每一帧。按以下方式渲染每一帧：

1.  称呼`glIdentity`
2.  绘制第一个四边形
3.  旋转
4.  绘制第二个四边形

渲染事物的方式，两个四边形的旋转差异只有三个轴上的 1/10 度 - 这并不明显。

请务必阅读 OpenGL，了解当前的 OpenGL 编程方式并尝试改进您的代码。看起来好像你不太明白自己在做什么，没有冒犯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T06:44:04.207

使用 glPushMatrix(); 在您的旋转变换和 glPopMatrix(); 在渲染第二个四边形之后，只有第二个四边形会受到旋转变换的影响。

# cordova - Highcharts、Safari 6 和垂直对齐条形图的奇特案例

> ID：12273512
> 
> 赞同：1
> 
> 时间：2012-09-05T01:51:22.353
> 
> 标签：cordova, safari, webkit, highcharts

我最近更新了 Safari 6，发生的事情是 Highcharts（2.3.0+；2.2.3 根本不渲染该系列）现在垂直渲染我的动态条形图，并出现其他显示问题（标签定位不正确，当光标明显比元素更远时，将激活悬停在某些元素上）。

![条形图渲染不正确，悬停时标签位置不正确](../Images/1e8c27a32c76173ecce9d5a1816c34d4.png)

我已经尝试将东西剥离回来，但它仍然会呈现错误。我做了一个基本的 JSFiddle 图表，它似乎完美呈现。

我将 Safari 6 降级回 5.1.7（天哪，这很头疼）并且它可以正常呈现。我只是有点担心，因为我在 PhoneGap/Cordova 应用程序中使用它，如果 Webkit 与 iOS 的东西共享，那么当 Mobile Safari 更新到最新版本的 Webkit 时它可能会中断。有可能是因为图表位于受重要动态 CSS 样式影响的复杂视图中，可能 Safari/Webkit 正在改变某些东西，特别是 Highcharts 计算某些东西的方式。这实际上是一件很难弄清楚和调试的事情，我在网上没有找到太多有过同样经历的人，只是希望这里的人可能有同样的经历或提供一些有价值的见解。

编辑：我还应该提到我使用的其他图形类型（列、线）也呈现不正确，但没有像条形类型那样不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T04:04:16.547

推迟这个之后，我回到这个问题，发现我有一些 Highcharts/Safari 似乎不喜欢的 CSS 设置。

为了促进 PhoneGap 中的移动开发和渲染准确性/流畅性，我有一些广泛的 CSS 定义：

```
* {
    -webkit-touch-callout:  none;
    -moz-touch-callout:     none;
    touch-callout:          none;
    -webkit-user-drag:      none;
    -moz-user-drag:         none;
    user-drag:              none;
    -webkit-user-select:    none;
    -khtml-user-select:     none;
    -moz-user-select:       none;
    -ms-user-select:        none;
    user-select:            none;

    /* This stops the coloured overlay when a person clicks an element */
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);

    /* Stuff to do with positioning and utilising the 3D engine for rendering speed */
    -webkit-transform:      translateZ(0);
    -moz-transform:         translateZ(0);
    transform:              translateZ(0);
} 
```

当我删除转换声明时，Highcharts 工作正常。在其上运行如此广泛的选择器可能并不好，因为毫无疑问 3D 定位可能与 SVG 的东西混在一起。这是一个显示中断的[JSFiddle](http://jsfiddle.net/jcDcW/)（使用 Safari 6 查看——我一直在为 iOS 开发，还没有在其他任何东西上测试过）。

# objective-c - 关于在 MAC OS X 上的给定文件扩展名上从代码设置默认应用程序的一些问题

> ID：12273516
> 
> 赞同：1
> 
> 时间：2012-09-05T01:52:37.437
> 
> 标签：objective-c

我使用函数 LSSetDefaultRoleHandlerForContentType 将 DVDPlayer.app 设置为文件扩展名 .mkv 的默认应用程序。

右键单击 abc.mkv，在打开方式菜单中，DVDPlayer 已成为默认应用程序。下面的方法也返回 DVDPlayer.app：

LSCopyDefaultRoleHandlerForContentType

LSCopyAllRoleHandlersForContentType

LSGetApplicationForInfo

但是在Finder中查看abc.mkv的文件信息，默认还是QuickTime Player。

双击 abc.mkv 会启动 QuickTime Player。

为什么？双击还有什么可做的吗？

让我很困惑的是 LSGetApplicationForInfo 获得的信息与 Finder 的信息中显示的不同！使困惑...

# appfabric - AppFabric 扩展问题故障排除（间歇性错误代码） :子状态 错误）

> ID：12273519
> 
> 赞同：18
> 
> 时间：2012-09-05T01:53:17.093
> 
> 标签：appfabric, appfabric-cache

我们已经为我们的 Web 应用程序实现了 AppFabric Windows Server 缓存。最初，我们能够毫无问题地使用缓存。然后我们将流量增加了大约 100 倍，并开始遇到间歇性异常。异常大约每 2 天发生一次，每次大约一分钟。

我们的配置：

*   9 个 Web 服务器在缓存中插入/检索对象：
    *   主要是临时的 500 字节操作类型对象
    *   使用 1 个命名区域
    *   使用标签存储的对象
    *   为给定标签批量检索
*   缓存集群：
    *   1 台主机（领导）AppFabric 1.1（get-cachehost 报告的版本为 3）
    *   SQL 配置提供程序
    *   主机上 96GB 的 RAM，默认 50% (48GB) 分配给 AppFabric
    *   缓存主机[配置](http://pastebin.com/jNw5FxNX)
    *   缓存客户端[配置](http://pastebin.com/g8gh5fki)

错误发生的顺序（在 1 分钟内*，九个网络服务器中的每一个*都发生异常）：

*   System.Net.Sockets.SocketException：现有连接被远程主机强行关闭 Microsoft.ApplicationServer.Caching.DataCacheException：`ErrorCode<ERRCA0016>:SubStatus<ES0001>:The connection was terminated, possibly due to server or network problems or serialized Object size is greater than MaxBufferSize on server. Result of the request is unknown. ---> System.ServiceModel.CommunicationException: The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '00:15:00'. ---> System.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host --- End of inner exception stack trace --- at System.Runtime.AsyncResult.End[TAsyncResult](IAsyncResult result) at System.ServiceModel.Channels.FramingDuplexSessionChannel.EndReceive(IAsyncResult result) at Microsoft.ApplicationServer.Caching.WcfClientChannel.CompleteProcessing(IAsyncResult result) --- End of inner exception stack trace --- at Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ResponseBody respBody) at Microsoft.ApplicationServer.Caching.DataCache.GetNextBatch(String region, DataCacheTag[] tags, GetByTagsOperation op, IMonitoringListener listener, Byte[][]& state, Boolean& more) at Microsoft.ApplicationServer.Caching.CacheEnumerator.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator'2.MoveNext() at System.Linq.Enumerable.<ExceptIterator>d__99'1.MoveNext() at System.Collections.Generic.List'1..ctor(IEnumerable'1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable'1 source)`

*   Microsoft.ApplicationServer.Caching.DataCacheException： `ErrorCode<ERRCA0017>:SubStatus<ES0006>:There is a temporary failure. Please retry later. (One or more specified cache servers are unavailable, which could be caused by busy network or servers. For on-premises cache clusters, also verify the following conditions. Ensure that security permission has been granted for this client account, and check that the AppFabric Caching Service is allowed through the firewall on all cache hosts. Also the MaxBufferSize on the server must be greater than or equal to the serialized object size sent from the client.) at Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ResponseBody respBody) at Microsoft.ApplicationServer.Caching.DataCache.GetNextBatch(String region, DataCacheTag[] tags, GetByTagsOperation op, IMonitoringListener listener, Byte[][]& state, Boolean& more) at Microsoft.ApplicationServer.Caching.CacheEnumerator.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator'2.MoveNext() at System.Linq.Enumerable.<ExceptIterator>d__99'1.MoveNext() at System.Collections.Generic.List'1..ctor(IEnumerable'1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable'1 source)`

*   Microsoft.ApplicationServer.Caching.DataCacheException： `ErrorCode<ERRCA0018>:SubStatus<ES0001>:The request timed out. at Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ResponseBody respBody) at Microsoft.ApplicationServer.Caching.DataCache.GetNextBatch(String region, DataCacheTag[] tags, GetByTagsOperation op, IMonitoringListener listener, Byte[][]& state, Boolean& more) at Microsoft.ApplicationServer.Caching.CacheEnumerator.MoveNext() at System.Linq.Enumerable.WhereSelectEnumerableIterator'2.MoveNext() at System.Linq.Enumerable.<ExceptIterator>d__99'1.MoveNext() at System.Collections.Generic.List'1..ctor(IEnumerable'1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable'1 source)`

我们还在缓存服务器上创建了一个跟踪日志会话，以捕获更多信息以诊断问题 - 任何有关如何分析此问题的建议将不胜感激（如果需要，我可以提供）。

我们还监控了各种 AppFabric、CLR 和网络性能计数器，下面是事件发生时的屏幕截图：

![AppFabric 性能捕获](../Images/37608d60e7586189efc8f26cba7bb11b.png)

提前感谢您在解决此问题时可以分享的任何想法或建议。

## **更新 1**

以下是在间歇性错误期间 AppFabric 缓存**服务器**上连续发生的异常（从跟踪日志中提取）：

*   `System.ServiceModel.CommunicationException: The socket connection was aborted because an asynchronous send to the socket did not complete within the allotted timeout of 00:00:00.0082078\. The time allotted to this operation may have been a portion of a longer timeout. ---> System.ObjectDisposedException: The socket connection has been disposed. Object name: 'System.ServiceModel.Channels.SocketConnection'. --- End of inner exception stack trace --- at System.ServiceModel.Channels.SocketConnection.ThrowIfNotOpen() at System.ServiceModel.Channels.SocketConnection.BeginRead(Int32 offset, Int32 size, TimeSpan timeout, WaitCallback callback, Object state) at System.ServiceModel.Channels.SessionConnectionReader.BeginReceive(TimeSpan timeout, WaitCallback callback, Object state) at System.ServiceModel.Channels.SynchronizedMessageSource.ReceiveAsyncResult.PerformOperation(TimeSpan timeout) at System.ServiceModel.Channels.SynchronizedMessageSource.SynchronizedAsyncResult'1..ctor(SynchronizedMessageSource syncSource, TimeSpan timeout, AsyncCallback callback, Object state) at System.ServiceModel.Channels.FramingDuplexSessionChannel.BeginReceive(TimeSpan timeout, AsyncCallback callback, Object state) at Microsoft.ApplicationServer.Caching.WcfServerChannel.CompleteProcessing(IAsyncResult result)`

*   `System.ServiceModel.CommunicationObjectAbortedException: The communication object, System.ServiceModel.Channels.ServerSessionPreambleConnectionReader+ServerFramingDuplexSessionChannel, cannot be used for communication because it has been Aborted. at System.Runtime.AsyncResult.End[TAsyncResult](IAsyncResult result) at System.ServiceModel.Channels.FramingDuplexSessionChannel.OnEndSend(IAsyncResult result) at Microsoft.ApplicationServer.Caching.ReplyContext.EndSend(IAsyncResult result)`

*   `System.ServiceModel.CommunicationObjectFaultedException: The communication object, System.ServiceModel.Channels.ServerSessionPreambleConnectionReader+ServerFramingDuplexSessionChannel, cannot be used for communication because it is in the Faulted state. at System.ServiceModel.Channels.CommunicationObject.ThrowIfDisposedOrNotOpen() at System.ServiceModel.Channels.OutputChannel.Send(Message message, TimeSpan timeout) at Microsoft.ApplicationServer.Caching.ReplyContext.Reply(Message message, TimeSpan timeout)`

*   `System.TimeoutException: Sending to via http://www.w3.org/2005/08/addressing/anonymous timed out after 00:00:15\. The time allotted to this operation may have been a portion of a longer timeout. ---> System.TimeoutException: Cannot claim lock within the allotted timeout of 00:00:15\. The time allotted to this operation may have been a portion of a longer timeout. --- End of inner exception stack trace --- at System.ServiceModel.Channels.FramingDuplexSessionChannel.OnSend(Message message, TimeSpan timeout) at System.ServiceModel.Channels.OutputChannel.Send(Message message, TimeSpan timeout) at Microsoft.ApplicationServer.Caching.ReplyContext.Reply(Message message, TimeSpan timeout)`

## **更新 2**

经过一天的故障排除后，我们采取了以下措施，取得了一些改进：

1.  [在此](http://blogs.microsoft.co.il/blogs/applisec/archive/2012/08/02/explain-timeouts-on-windows-appfabric-cache.aspx)基础上，[我们](http://blogs.msdn.com/b/appfabriccat/archive/2010/09/20/appfabric-cache-peeking-into-client-amp-server-wcf-communication.aspx)增加到`maxConnectionsToServer`. `3`结果，**AppFabric Caching:Cache perf** counter 记录的客户端请求/秒增加了 50%，但间歇性错误并没有停止发生

2.  我们在**缓存服务器**配置上增加了`maxBufferSize`和`maxBufferPoolSize`到`2147483647`(int32.max) 。到目前为止，我们能够处理没有错误的 300 倍流量。我们将继续增加流量和监控。更多更新要关注

 **## **更新 3**

我们向集群添加了另外两台各 16GB 的主机，并启用了 HighAvailability 模式（通过`Secondaries=1`）。目前，原始主机保留在集群中，内存为 96GB - 所有主机都有`cacheSize = 12`GB。在缓存客户端上，我们将其`MaxConnectionToServer`增加到`12`（每个核心 1 个）。以下是我们的发现：

*   偶尔我们会得到（每 10 分钟一次或两次）：
    *   `ErrorCode<ERRCA0017>:SubStatus<ES0005>:There is a temporary failure. Please retry later. (There was a contention on the store.)`
    *   `ErrorCode<ERRCA0017>:SubStatus<ES0004>:There is a temporary failure. Please retry later. (Replication queue was full. This may happen during reconfiguration of cluster hosts.)`
*   如上所述，原来的 96GB 缓存主机仍然会出现 1 分钟的中断。新的缓存主机没有经历过中断

我们计划从原始缓存主机中移除 80GB 内存。更多更新。

## **更新 4**

通过将缓存主机中的 RAM 量减少到 16GB，似乎已经解决了这个问题。我们不再看到流量增加到 400 倍的间歇性错误。好像封号了。现在转到下一个问题：[高可用性](https://stackoverflow.com/questions/12377194/creating-a-high-availability-appfabric-cache-cluster)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T13:37:00.603

1.  您是否安装了[http://support.microsoft.com/kb/983182](http://support.microsoft.com/kb/983182)和[http://support.microsoft.com/kb/2527387](http://support.microsoft.com/kb/2527387)？
2.  在您的代码中，您是否检查异常和 retrylater bool？

    ```
     catch (DataCacheException ex2)
                {
                    if (ex2.ErrorCode == DataCacheErrorCode.RetryLater)
                    { 
    ```

    使用命名区域会强制服务器将该命名区域的值推送到单个服务器，而不是在所有缓存服务器中分散散列。（“为了提供这种添加的搜索功能，区域中的对象仅限于单个缓存主机。” [http://msdn.microsoft.com/en-us/library/ee790985(v=azure.10).aspx](http://msdn.microsoft.com/en-us/library/ee790985(v=azure.10).aspx)）

我建议您将命名区域分片到另外 2 台服务器上，并将它们放在一个集群中。通过这种方式，您可以在运行 GC 并尝试找到更多内存来放置和存储对象和标签时将异常限制在较小的服务器上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T21:53:31.620

**重新发布Jeff-ITGuy**在[social.msdn.microsoft.com](http://social.msdn.microsoft.com/Forums/en-US/velocity/thread/c893dcdb-385c-4856-9a82-9420ea5ff8b9)上给出的答案：

> 您遇到的问题似乎与我目前正在与 Microsoft 合作的问题几乎相同。如果是同样的问题，很可能是GC耗时过长导致AppFabric响应时间延迟造成的。从您的性能计数器来看，当您开始遇到问题时，GC 时间似乎增加了，所以它可能是同一个问题。
> 
> Microsoft 正在积极调查此问题。与此同时，为了缓解这个问题（至少从我们的发现来看），您可以使用更少的内存运行更多的服务器（缩小 GC 正在处理的内存空间的大小），并且您可以增加客户端上的 RequestTimeout。默认设置为 15000（15 秒），但我们尝试将其提高到 30000，这有助于消除一些问题。在我看来，这不是一个好的长期解决方案，只是传递信息。我已经看到只有 24gb 内存（12gb 用于缓存）的服务器的问题，当我们尝试将 4gb 设置为缓存的 8gb 服务器时，它才真正变得明显更好——这导致 GC 做得更好。
> 
> 希望这会有所帮助，但如果这是我认为的问题，还没有解决方案。

它确实有帮助，在我们将缓存主机 RAM 减少到 16GB 后，间歇性错误停止了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-17T09:19:42.853

此问题的修复程序当前可在此处获得：http: [//support.microsoft.com/kb/2787717](http://support.microsoft.com/kb/2787717)**

# c# - 无法使用 LINQ to XML 获取元素列表

> ID：12273523
> 
> 赞同：2
> 
> 时间：2012-09-05T01:53:53.490
> 
> 标签：c#, linq-to-xml

示例 XML：

```
<CONFIGURATION>
    <Files>
        <File>D:\Test\TestFolder\TestFolder1\TestFile.txt</File>
        <File>D:\Test\TestFolder\TestFolder1\TestFile01.txt</File>
        <File>D:\Test\TestFolder\TestFolder1\TestFile02.txt</File>
        <File>D:\Test\TestFolder\TestFolder1\TestFile03.txt</File>
        <File>D:\Test\TestFolder\TestFolder1\TestFile04.txt</File>
    </Files>
    <SizeMB>3</SizeMB>
    <BackupLocation>D:\Log backups\File backups</BackupLocation>
</CONFIGURATION> 
```

我一直在做一些教程，但我无法获取 files 元素中的所有文件列表。它只显示第一个 <File> 元素，不显示其余元素。这是我的代码：

```
var fileFolders = from file in XDocument.Load(@"D:\Hello\backupconfig1.xml").Descendants("Files")
                         select new
                         {
                             File = file.Element("File").Value
                         };

foreach (var fileFolder in fileFolders)
{
     Console.WriteLine("File = " + fileFolder.File);
} 
```

如何在 Files 元素、SizeMB 和 BackupLocation 中显示所有文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:19:54.267

[已编辑]

使用[SelectMany()](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.selectmany.aspx)：

```
IEnumerable<string> files = 
    XDocumentLoad(@"D:\Hello\backupconfig1.xml").Descendants("Files")
        .SelectMany(files => files.Descendants("File"))
        .Select(file => file.Value) 
```

SelectMany() 将多个枚举连接为一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:08:01.077

```
string xml = @"<CONFIGURATION> 
<Files> 
    <File>D:\Test\TestFolder\TestFolder1\TestFile.txt</File> 
    <File>D:\Test\TestFolder\TestFolder1\TestFile01.txt</File> 
    <File>D:\Test\TestFolder\TestFolder1\TestFile02.txt</File> 
    <File>D:\Test\TestFolder\TestFolder1\TestFile03.txt</File> 
    <File>D:\Test\TestFolder\TestFolder1\TestFile04.txt</File> 
</Files> 
<SizeMB>3</SizeMB> 
<BackupLocation>D:\Log backups\File backups</BackupLocation> 
</CONFIGURATION>";

var xdoc = XDocument.Parse(xml);
var configuration = xdoc.Element("CONFIGURATION");
string sizeMB = configuration.Element("SizeMB").Value;
string backupLocation = configuration.Element("BackupLocation").Value;
string[] files = configuration.Element("Files").Elements("File").Select(c => c.Value).ToArray();

Console.WriteLine(sizeMB);
Console.WriteLine(backupLocation);    
Console.WriteLine(string.Join("\r\n", files)); 
```

输出

```
3
D:\Log backups\File backups
D:\Test\TestFolder\TestFolder1\TestFile.txt
D:\Test\TestFolder\TestFolder1\TestFile01.txt
D:\Test\TestFolder\TestFolder1\TestFile02.txt
D:\Test\TestFolder\TestFolder1\TestFile03.txt
D:\Test\TestFolder\TestFolder1\TestFile04.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T03:36:16.140

您已经有一系列文件位置，就像`Aaron Anodide`推荐的那样。`for`在or`foreach`循环中使用此数组：

```
string[] files = configuration.Element("Files").Elements("File").Select(c => c.Value).ToArray();
for (int index=0; index<files.Length; index++)
{
    DoSomeStuffWithFileCLocation(files[i]);
} 
```

或者

```
forach(string file in files)
{
    DoSomeStuffWithFileCLocation(file);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T02:33:04.440

执行以下操作可能会更高效：

```
XDocument doc = XDocument.Load(@"D:\Hello\backupconfig1.xml");
var fileFolders = doc.Root.Element("Files").Elements("File"); 
```

`Descendants()`将返回文档中所有节点的集合。在上面的示例中，这没什么大不了的，但是如果您构建一个适当大的文档，这可能会减慢速度。相反，如果您知道您只需要文件，那么直接导航到它`Element()`会更快（并且可以说更具可读性）。

# jquery - 如何使用 jQuery 获取 CSS 样式的值

> ID：12273525
> 
> 赞同：39
> 
> 时间：2012-09-05T01:54:06.067
> 
> 标签：jquery, css

我想知道我应该使用什么类型的方法来获取 CSS 样式的值。我想将它设置为 jQuery，以便我可以创建匹配 CSS“左”值的条件。

这是带有样式属性的 CSS 和 HTML 标签。

```
<div class="items" style="left: -900px"> <span>some content here</span> </div> 
```

这是我获取值的 jQuery 代码。

```
<script>
  var n = $("items").css("left");
  if(n == -900){
    $(".items span").fadeOut("slow");
  }
</script> 
```

我想知道这种方法是否正确，因为它最终不起作用。提前感谢您的帮助。

注意：左值是动态的，它正在更改为以下值：-900px，-1800px，-2700px，-3600px，-4500px...

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-05T02:06:25.303

我怀疑css`left`自己理解。您需要使用它指定位置。您使用`.css()`正确

```
position: relative/absolute/whatever;
left: 900px; 
```

这是它的工作原理

[https://jsfiddle.net/gFLZe/](https://jsfiddle.net/gFLZe/)

如果没有这个职位，这就是你得到的

[https://jsfiddle.net/gkkm5/](https://jsfiddle.net/gkkm5/)

将您的 if 语句更改为这样 - 带有引号`-900px`

```
var n = $("items").css("left");

if(n == '-900px'){
    $(".items span").fadeOut("slow");
} 
```

[https://jsfiddle.net/gFLZe/1/](https://jsfiddle.net/gFLZe/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T02:00:00.010

你的代码是正确的。用 .items 替换项目，如下所示

```
<script>
  var n = $(".items").css("left");
  if(n == -900){
    $(".items span").fadeOut("slow");
  }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T01:58:50.277

你是对的。使用该`css()`方法，您可以检索存储在 DOM 中的所需 css 值。您可以在以下位置阅读更多相关信息：[https ://api.jquery.com/css/](https://api.jquery.com/css/)

但是如果你想获得它的位置，你可以检查[offset()](https://api.jquery.com/offset/)和[position()](https://api.jquery.com/position/)方法来获得它的位置。

# css - Chrome中的尾随边框线

> ID：12273528
> 
> 赞同：1
> 
> 时间：2012-09-05T01:54:24.580
> 
> 标签：css, google-chrome

当我从左到右水平滚动时，一些尾随边框线仅出现在 Chrome 中。请查看屏幕截图以进行视觉演示。当我滚动时，如何摆脱这些线条的出现？

![在此处输入图像描述](../Images/08f8231e9e8fc4168a926dc4a76a054c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T02:15:42.830

没有任何我想说的例子添加

```
-webkit-backface-visibility: hidden; 
```

到那里的容器，假设它类似于 .header

# javascript - HTML5 Canvas 访问控制允许来源错误

> ID：12273537
> 
> 赞同：6
> 
> 时间：2012-09-05T01:56:04.663
> 
> 标签：javascript, html, canvas

当我尝试从画布元素获取数据时，出现以下 javascript 错误：

> 错误：不支持 canvas.toDataURL()。[例外……“操作不安全。” 代码：“18” nsresult：“0x80530012（安全错误）”...

画布是从不同域提供的图像中绘制的，但我使用代理将这两行添加到图像响应标头中：

> 访问控制允许来源：*
> 
> 访问控制允许凭据：真

我错过了什么？

谢谢，
特德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T02:19:07.197

要发出正确的 CORS 请求，您必须将图像的[跨源属性](http://www.whatwg.org/specs/web-apps/current-work/multipage/embedded-content-1.html#attr-img-crossorigin)设置为“匿名”。 [这个例子](https://developer.mozilla.org/en-US/docs/HTML/CORS_Enabled_Image?redirectlocale=en-US&redirectslug=CORS_Enabled_Image)来自 Mozilla 开发者网络。

```
var img = new Image,
    canvas = document.createElement("canvas"),
    ctx = canvas.getContext("2d"),
    src = "http://example.com/image"; // insert image url here

img.crossOrigin = "Anonymous";

img.onload = function() {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage( img, 0, 0 );
    localStorage.setItem( "savedImageData", canvas.toDataURL("image/png") );
}
img.src = src;
// make sure the load event fires for cached images too
if ( img.complete || img.complete === undefined ) {
    img.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
    img.src = src;
} 
```

浏览器支持不包括任何已知版本的 IE 和未发布的 Safari 版本。Firefox 和 Chrome 拥有多年的支持。

# php - 蛋糕php，sql错误150

> ID：12273539
> 
> 赞同：0
> 
> 时间：2012-09-05T01:56:18.107
> 
> 标签：php, mysql, database, cakephp, web-applications

在我发布我的问题/代码之前，我将为我正在做的事情提供一些背景故事。目前我正在开发一个使用 cakephp 和 mysql 的网站。我有一个用户可以登录的登录系统，每个用户都可以创建一个团队。当用户创建团队时，他们被视为团队负责人。我的数据库中有两个表。一种用于用户，另一种用于团队。在 team 表中有一个名为 user_id 的字段，它代表创建团队的用户。它是一个外键，链接到 User 表中名为 id 的字段。

因此，当用户创建团队时，我希望我的程序能够自动识别领导者的 id 并将其保存为团队模型中的 user_id 进入我的表。

这是我在团队模型类中的代码

```
<?php
class TeamsController extends AppController {

public $name = 'Teams';

public function add() {
    if ($this->request->is('post')) {

                    //THIS LINE SETS THE TEAM LEAD
        $this->Team->set('user_id', $this->Auth->user('id'));

        echo $this->Auth->user('id');
        if ($this->Team->save($this->request->data)) {
            $this->Team->set('user_id', $this->Auth->user('id'));
            $this->Session->setFlash('The team  has been saved');
            $this->redirect(array('controller' => 'Users','action' => 'index'));
        } else {
            $this->Session->setFlash('The team could not be created. Please, try again.');
        }

    }
} 
```

如您所见，我正在从当前用户模型中获取 user_id 并将其放入团队模型中。

但是，当我这样做时，我不断收到 mysql 错误 150，这与外键约束有关。我不确定为什么会这样。我检查并交叉引用了两个表中的所有数据，数据在两个表中！两个表都是 Innodb 并且两个字段都是整数并且不带空值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T04:08:14.220

您的代码应如下所示：

您的控制器代码：

```
<?php
class TeamsController extends AppController {

public $name = 'Teams';

public function add() {
  if ($this->request->is('post')) {
    $team_details = $this->request->data;
    $team_details['Team']['user_id'] = $this->Auth->user('id');
    if ($this->Team->save($team_details)) {
        $this->Session->setFlash('The team  has been saved');
        $this->redirect(array('controller' => 'Users','action' => 'index'));
    } else {
        $this->Session->setFlash('The team could not be created. Please, try again.');
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:17:19.263

```
<?php
   class TeamsController extends AppController {

    public $name = 'Teams';

   public function add() {
    if ($this->request->is('post')) {

                //THIS LINE SETS THE TEAM LEAD
    $this->request->data['Team']['user_id']= $this->Auth->user('id');

    if ($this->Team->save($this->request->data)) {
        $this->set('user_id', $this->Auth->user('id'));
        $this->Session->setFlash('The team  has been saved');
        $this->redirect(array('controller' => 'Users','action' => 'index'));
    } else {
        $this->Session->setFlash('The team could not be created. Please, try again.');
    }

   }
} 
```

# jquery - jQuery - 从 iframe 绑定到父页面上的事件

> ID：12273540
> 
> 赞同：2
> 
> 时间：2012-09-05T01:56:39.433
> 
> 标签：jquery, html, iframe, javascript-events

> **可能重复：**
> [如何在 jQuery“window.parent.document.getElementById('parentPrice').innerHTML”中写这个？](https://stackoverflow.com/questions/726816/how-to-write-this-in-jquery-window-parent-document-getelementbyidparentprice)

我有一个应用程序要移植到浏览器以进行演示。

基本上我有一个包含实际应用程序的 iframe 的父页面。在父页面上，我有一些按钮来模拟设备控制。

基本上我需要一些方法来让 iframe 中运行的应用程序捕获这些父页面按钮的点击。

我尝试在父页面上创建全局函数来设置绑定，例如：

```
// parent document
var bindLeftArrow = function (callback) {
    $("div#controls button#left-arrow").on("click", function () {
        callback();
    });
};

// app initialization within iframe
parent.bindLeftArrow(function () {
    console.log("Left arrow pressed!");
    // do stuff
}); 
```

这不起作用，因为“按下左箭头”永远不会转储到我的控制台中。我认为我可以做的另一件事是：

```
// parent document
$("div#controls button#left-arrow").on("click", function () {
    $(document).trigger("LEFT_ARROW_PRESSED");
});

// app in iframe
$(<parent document selector>).bind("LEFT_ARROW_PRESSED", function () {
    console.log("Left arrow pressed!");
    // do stuff
}); 
```

只有我不知道我会把什么作为选择器而不是“父文档选择器”。

谁能告诉我我将如何做到这一点？

# php - 将计算的 PHP 变量传递给 jQuery/Ajax 表单

> ID：12273542
> 
> 赞同：1
> 
> 时间：2012-09-05T01:57:07.283
> 
> 标签：php, javascript, jquery, ajax

我的初始表单计算变量 $finallowamount 和 $finalhighamount，但我似乎无法将这些变量的值传递给我的 jQuery 联系人 javascript 文件（下面的代码）。任何帮助将不胜感激。谢谢。

```
 $(function() {
$('a.email').click(function(event) {
    event.preventDefault();

    $('body').append('<div id="popupshadow"></div><div id="popup"></div>');
    $('#popupshadow').css({opacity:0}).animate({opacity:0.7},1000);
    $('#popup').css({opacity:0}).delay(1200).animate({opacity:1},800);
    $('#popup').html('<form class="contact" action="#" method="post"><table class="contact"><tr><td class="input-name">Name:</td><td><input type="text" name="name" size="25" /></td></tr><tr><td class="input-email">Email:</td><td><input type="email" name="email" size="25" /></td></tr><tr><td class="input-phone">Phone:</td><td><input type="phone" name="phone" size="25" /></td></tr><tr><td></td><td><input type="submit" value="Send" /></td></tr></table><input type="hidden" name="to" value="noahldavis@gmail.com"></form>');
    $('form.contact').submit(function(event) {
        $('form.contact td').css('color','#000000');

        var name = $('form.contact input[name="name"]').val();
        var email = $('form.contact input[name="email"]').val();
        var phone = $('form.contact input[name="phone"]').val();
        var to = $('form.contact input[name="to"]').val();

        var valid = true;
        if(name == "") 

        {
            valid = false;
            $('td.input-name').css('color','#FF0000');
        }
        if(email == "" && phone == "")
            valid = false;
        if(email == "")
            $('td.input-email').css('color','#FF0000');
        if(phone == "")
            $('td.input-phone').css('color','#FF0000');

        var message = 'message';
        var paymentstreamtype = $("#ssq_rc_general input[type=radio]:checked").val();
        var finallowamount = $("#finallowamount").html();
        var finalhighamount = $("#finalhighamount").html();

        if(valid) {
            $.ajax({url : 'contact.php',
                    data : {name : name,
                            email : email,
                            phone : phone,
                            message : message,
                            paymentstreamtype : paymentstreamtype,
                            finallowamount : finallowamount,
                            finalhighamount : finalhighamount,
                            to : to},
                    type : 'post',
                    success : function(data) {
                        $('#popup').html('<p style="text-align:center;">Your message has been sent.</p>');
                        $('#popup, #popupshadow').delay(1000).animate({opacity:0},500).delay(500).queue(function() { $(this).remove(); });
                    }
            });
        }
        event.preventDefault();
        return false;
    });
    $('#popupshadow, a.cancel').click(function(event) {
        $('#popup, #popupshadow').animate({opacity:0},500).delay(500).queue(function() { $(this).remove(); });
    });
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:28:27.057

首先，javascript 在 web 客户端中运行，而 php 在您的服务器上运行。

如果您不想使用 php var，则必须让 source 将这些 var 替换为实际值。

如果这是一个 js 文件，您可以使用 php 包含此文件：

```
//loadjs.php
public function loadJs()
{
    if(extension_loaded('zlib')) {
        //check gzib
        ob_start('ob_gzhandler');
    }

    header ("content-type: application/javascript; charset: UTF-8");
    header ("cache-control: must-revalidate");
    $offset = 60 * 60 * 24;
    $expire = "expires: " . gmdate ("D, d M Y H:i:s", time() + $offset) . " GMT";
    header ($expire);
    ob_start("compress");
    $js = array(
        '0'=>array('/js/swf/swfupload.js'),
    );

    foreach($js as $key=>$value){
        foreach($value as $v){
            include $v;
        }
    }

    if(extension_loaded('zlib')){
        ob_end_flush();//flush all buffer content
    }
}
loadJs()

//then,load this js file in your html file:
<script src="loadjs.php" /> 
```

# android - 支持 v4 CursorLoader - 仅在少数设备上出现非常奇怪的错误

> ID：12273543
> 
> 赞同：0
> 
> 时间：2012-09-05T01:57:13.177
> 
> 标签：android

只有少数用户出现以下错误，我真的不知道在哪里寻找这个错误，因为sql数据库文件在正确的位置，sql管理器打开它然后找不到那里的表！

我注意到这只是在使用支持 V4 库的 CursorLoader 时发生的，可能错误在该代码中？

任何建议或答案都会有所帮助。

```
java.lang.RuntimeException: An error occured while executing doInBackground()
    at android.support.v4.b.r.done(SourceFile:137)
    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
    at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
    at java.lang.Thread.run(Thread.java:856)Caused by: android.database.sqlite.SQLiteException: no such table: records: , while compiling: SELECT _id, name, isbackground FROM records ORDER BY _id ASC
    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:68)
    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:143)
    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:361)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:127)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:94)
    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:53)
    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:47)
    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1564)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:354)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:291)
    at com.voicepro.db.RecordsContentProvider.query(SourceFile:289)
    at android.content.ContentProvider$Transport.query(ContentProvider.java:178)
    at android.content.ContentResolver.query(ContentResolver.java:311)
    at android.support.v4.b.f.loadInBackground(SourceFile:49)
    at android.support.v4.b.f.loadInBackground(SourceFile:35)
    at android.support.v4.b.a.onLoadInBackground(SourceFile:240)
    at android.support.v4.b.b.doInBackground(SourceFile:51)
    at android.support.v4.b.b.doInBackground(SourceFile:40)
    at android.support.v4.b.q.call(SourceFile:123)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305) android.database.sqlite.SQLiteException: no such table: records: , while compiling: SELECT _id, name, isbackground FROM records ORDER BY _id ASC
    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:68)
    at android.database.sqlite.SQLiteProgram.compileSql(SQLiteProgram.java:143)
    at android.database.sqlite.SQLiteProgram.compileAndbindAllArgs(SQLiteProgram.java:361)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:127)
    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:94)
    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:53)
    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:47)
    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1564)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:354)
    at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:291)
    at com.voicepro.db.RecordsContentProvider.query(SourceFile:289)
    at android.content.ContentProvider$Transport.query(ContentProvider.java:178)
    at android.content.ContentResolver.query(ContentResolver.java:311)
    at android.support.v4.b.f.loadInBackground(SourceFile:49)
    at android.support.v4.b.f.loadInBackground(SourceFile:35)
    at android.support.v4.b.a.onLoadInBackground(SourceFile:240)
    at android.support.v4.b.b.doInBackground(SourceFile:51)
    at android.support.v4.b.b.doInBackground(SourceFile:40)
    at android.support.v4.b.q.call(SourceFile:123)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
    at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:56:21.097

可能是损坏或不完整的数据库。检查发生这种情况的设备，并可能尝试获取数据库的副本。不直接相关，但尽量不要混淆支持库，一些代码依赖子类/方法名。

# jquery - 编辑主题标签后重新加载页面按回车

> ID：12273544
> 
> 赞同：0
> 
> 时间：2012-09-05T01:57:15.147
> 
> 标签：jquery, html, ajax

我做了一个有两个标签的页面。登录并注册。我愿意在主 url 之后为特定主题标签打开特定标签。就像，如果我写， [http://someurl.com/user.html#login](http://someurl.com/user.html#login) 它应该打开登录选项卡，如果我写， [http://someurl.com/user.html#register](http://someurl.com/user.html#register) 当我来到 user.html 页面从另一个页面使用 url，它工作正常。但是，当我在 user.html 中并且我只是编辑主题标签并按 ENTER 时，第一次它不起作用。但是，它第二次起作用了。另外，如果我重新加载页面，它工作正常。问题在于按 ENTER。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:02:53.453

您没有向我们展示您正在使用什么代码，但您可以使用类似[`window.onhashchange`](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)的方式在哈希更改时随时收到通知，然后您的代码可以根据新的哈希值执行您想要的任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:19:48.220

您可以尝试使用`window.onhashchange`. 但是，它不支持旧类型的浏览器，例如 IE 6/7。

如果你想让它跨浏览器，你可以使用这个[jQuery 插件](http://benalman.com/projects/jquery-hashchange-plugin/)。`setInterval`基本上，如果浏览器不支持，插件使用`window.onhashchange`

# objective-c - 从 PID 中获取名称？

> ID：12273546
> 
> 赞同：8
> 
> 时间：2012-09-05T01:57:20.353
> 
> 标签：objective-c, c, macos, unix, process

我在 OSX Mountain Lion 上，正在尝试使用其 PID 检索进程的名称。

以下是我正在使用的代码：

```
pid_t pid = 10687;
char pathBuffer [PROC_PIDPATHINFO_MAXSIZE] = "";
char nameBuffer [256] = "";

int sizeOfVal = sizeof(nameBuffer);
proc_pidpath(pid, pathBuffer, sizeof(pathBuffer));
proc_name(pid, nameBuffer, sizeof(nameBuffer));

NSLog(@"Path: %s\n Name: %s\n", pathBuffer, nameBuffer); 
```

上面的代码能够正确检索名称，但是它只检索前 15 个字符并“忽略”其余字符。请注意，这不是显示名称的问题，而是*检索*它的问题。问题不在于我的应用程序的其余部分，因为我正在独立应用程序中测试上述代码。另请注意，我尝试更改 PID，但无论我尝试什么 PID，代码仅检索名称的前 15 个字符。路径检索工作完美。

有人对我做错了什么有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-05T04:43:11.133

该函数查看的值是 struct `proc_bsdshortinfo`。它仅限于返回一个 16 字节的字符串，或包含空终止符时的 15 个可读字符。

来自`sys/param.h`：

```
#define MAXCOMLEN   16      /* max command name remembered */ 
```

来自`sys/proc_info.h`：

```
struct proc_bsdshortinfo {
        uint32_t                pbsi_pid;       /* process id */
        uint32_t                pbsi_ppid;      /* process parent id */
        uint32_t                pbsi_pgid;      /* process perp id */
    uint32_t                pbsi_status;        /* p_stat value, SZOMB, SRUN, etc */
    char                    pbsi_comm[MAXCOMLEN];   /* upto 16 characters of process name */
    uint32_t                pbsi_flags;              /* 64bit; emulated etc */
        uid_t                   pbsi_uid;       /* current uid on process */
        gid_t                   pbsi_gid;       /* current gid on process */
        uid_t                   pbsi_ruid;      /* current ruid on process */
        gid_t                   pbsi_rgid;      /* current tgid on process */
        uid_t                   pbsi_svuid;     /* current svuid on process */
        gid_t                   pbsi_svgid;     /* current svgid on process */
        uint32_t                pbsi_rfu;       /* reserved for future use*/
}; 
```

编辑：要解决这个问题，请获取最后一个路径组件：

```
pid_t pid = 3051;
char pathBuffer [PROC_PIDPATHINFO_MAXSIZE];
proc_pidpath(pid, pathBuffer, sizeof(pathBuffer));

char nameBuffer[256];

int position = strlen(pathBuffer);
while(position >= 0 && pathBuffer[position] != '/')
{
    position--;
}

strcpy(nameBuffer, pathBuffer + position + 1);

printf("path: %s\n\nname:%s\n\n", pathBuffer, nameBuffer); 
```

# objective-c - NSFileVersion 调用 removeOtherVersionsOfItemAtURL 期间的 EXC_BAD_ACCESS：在协调写入块内

> ID：12273548
> 
> 赞同：5
> 
> 时间：2012-09-05T01:57:35.653
> 
> 标签：objective-c, ios, xcode

我正在使用*似乎*是在协调写入块中对`NSFileVersion`类方法的简单调用，以解决某些 iCloud 冲突。`removeOtherVersionsOfItemAtURL:`

当我的设备进入“spaz 模式”时，这是一个技术术语，用于在一些设备上重复打开和关闭应用程序，`EXC_BAD_ACCESS`内部会引发异常。代码片段：

```
- (void)compareVersionChanges:(NSFileVersion *)version {
    if (![DataLoader iCloudPreferenceEnabled]) {
        NSLog(@"Ignoring iCloud changes (version comparison) based on user preference");
        return;
    }
    NSLog(@"compareVersionChanges");
    dispatch_queue_t aQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_async(aQueue, ^(void) {
        NSError *readError = nil;
        NSFileCoordinator *coordinator = [[NSFileCoordinator alloc] initWithFilePresenter:(id)self];
        [coordinator coordinateReadingItemAtURL:[version URL] options:0 error:&readError byAccessor:^(NSURL *newURL) {
            DataContext *loadedContext = nil;
            NSData *data = [NSData dataWithContentsOfURL:newURL];
            NSError *e = nil;
            loadedContext = [self convertXmlDataToContext:data error:&e];
            if (e) {
                NSLog(@"Done loading, error: %@", e);
                [[DataLoader applicationDelegate] displayError:e];
                loadedContext = nil;
            }

            if (!loadedContext) {
                return;
            }

            id appDelegate = [DataLoader applicationDelegate];
            DataContext *inMemoryContext = nil;
            if (appDelegate != nil && [appDelegate respondsToSelector:@selector(context)]) {
                inMemoryContext = [appDelegate performSelector:@selector(context)];
            }

            if (inMemoryContext) {
                NSLog(@"Performing iCloud context synchronizating...");
                DataContextSynchronizer *synchronizer = [[DataContextSynchronizer alloc] init];
                ChangeSet *changes = [synchronizer compareLocalContext:inMemoryContext andRemoteContext:loadedContext];
                if ([[changes changes] count] > 0) {
                    [SelectionManager disable];
                    @synchronized(appDelegate) {
                        NSLog(@"Applying synchronization changes...");
                        [synchronizer applyChangeSet:changes toDataContext:inMemoryContext];
                        NSLog(@"Synchronization changes applied");
                    }
                    [SelectionManager enable];
                    if ([appDelegate respondsToSelector:@selector(setSkipRefreshSave:)]) {
                        [appDelegate performSelector:@selector(setSkipRefreshSave:) withObject:[NSNumber numberWithBool:YES]];
                    }
                    dispatch_queue_t mainQueue = dispatch_get_main_queue();
                    dispatch_async(mainQueue, ^(void) {
                        [SelectionManager notifyListeners];
                    });
                    if ([appDelegate respondsToSelector:@selector(setSkipRefreshSave:)]) {
                        [appDelegate performSelector:@selector(setSkipRefreshSave:) withObject:[NSNumber numberWithBool:NO]];
                    }
                    [self save:[[DataLoader applicationDelegate] context]];
                } else {
                    NSLog(@"No sync changes applicable.");
                }
                NSError *coordinateWriteRemoveError = nil;
                [coordinator coordinateWritingItemAtURL:newURL options:NSFileCoordinatorWritingForDeleting error:&coordinateWriteRemoveError byAccessor:^(NSURL *theURL) {
                    theURL = [theURL copy];
                    NSError *removeOtherVersionsError = nil;
                    [NSFileVersion removeOtherVersionsOfItemAtURL:theURL error:&removeOtherVersionsError];
                    if (removeOtherVersionsError) {
                        NSLog(@"Error removing other versions: %@", removeOtherVersionsError);
                    }
                }];
                if (coordinateWriteRemoveError) {
                    NSLog(@"Error occurred coordinating write for deletion of other file versions: %@", coordinateWriteRemoveError);
                }
            }
        }];

        if (readError) {
            NSLog(@"Done loading (outside block) error: %@", readError);
        }
    });
} 
```

我认为一点语法突出显示可能会使这更容易检查：

[**链接到 Xcode 中的代码片段和故障堆栈的图像**](http://i.stack.imgur.com/hagUk.png)

该错误实际上发生在**第 1404 行**，从下面的屏幕截图中可以看出，它在 Apple 代码领域很深。

[**链接到调试器的图像**](http://i.stack.imgur.com/DXTDQ.png)

在提交雷达之前，我想我会在这里检查一下我是否做错了什么？第 1402 行的额外`[... copy]`内容只是一个快速检查，以确保我不会丢失对块提供参数的引用，并将被删除。

**编辑：**重要提示！我正在使用ARC。

**编辑2：**我注意到打电话时：

`[NSFileVersion otherVersionsOfItemAtURL:theURL]`

返回值为`nil`，这表明（通过文档）：

> ...如果没有这样的文件，则为 nil。该数组不包含 currentVersionOfItemAtURL: 方法返回的版本对象。

因此，通过在调用*之前*检查此方法的返回值`removeOtherVersionsOfItemAtURL:`，它已经缓解了这个问题。但是我仍然觉得奇怪的是抛出了 EXC_BAD_ACCESS，而不是正确处理它的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T11:57:53.473

我在打电话时注意到：

`[NSFileVersion otherVersionsOfItemAtURL:theURL]`

在调用 之前`removeOtherVersionsOfItemAtURL:`，返回值为 nil，这表明（通过文档）：

> 返回：文件版本对象的数组，如果没有这样的文件，则返回 nil。该数组不包含 currentVersionOfItemAtURL: 方法返回的版本对象。

So by checking the return value of this method before I make the call to `removeOtherVersionsOfItemAtURL:`, it has alleviated the issue. But I still find it strange that an `EXC_BAD_ACCESS` is thrown by `removeOtherVersionsOfItemAtURL:`, rather than that method simply returning `NO`, or simply populating the provided `NSError` object.

I'll be filing a Radar and will update here when I hear back.

# loops - Powershell - 将 Active Directory 用户名与电子邮件地址进行比较

> ID：12273551
> 
> 赞同：1
> 
> 时间：2012-09-05T01:57:44.690
> 
> 标签：loops, powershell, foreach, where

我目前正在尝试查找使用模型“firstname@domain.com”与我们的新标准“FirstInitialLastName@domain.com”创建的所有 AD 用户。我正在使用 Quest ActiveRoles 模块，专门`Get-QADUser`用于下拉我的用户详细信息：

```
Get-QADUser -enabled -IncludedProperties PrimarySMTPAddress | ?{$_.Type -match "User"} | Select-Object FirstName,PrimarySMTPAddress ... 
```

这让我得到了一个用户名和他们的 SMTP 地址的列表。我难过的是如何比较结果。

我认为规范化值（将“@domain.com”添加到名字字符串或从 SMTP 字符串中删除“@domain.com”）然后进行 -ieq 测试将是最好的方法。我发现我可以做第一个：

```
%{ $address=$($_.FirstName + "@domain.com";) } 
```

但我不知道如何针对 PrimarySMTPAddress 字符串测试 $address 。我可以创建第二个变量：

```
%{ $smtp=$($_.PrimarySMTPAddress); } 
```

并得到结果：

```
[PS] C:\>$addy -ieq $smtp
True 
```

我只是不清楚如何在流中完成所有操作，以便我可以一次处理我的树。如果这是比单行更适合脚本的东西，那也很好。来自 BASH 的辉煌世界，我的大脑只想把它排成一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:14:10.963

```
Get-QADUser -Enabled -Email * -SizeLimit 0 | 
Where-Object {$_.Email.Split('@')[0] -eq $_.FirstName } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:20:15.767

试试这个：

```
Get-QADUser -enable -IncludedProperties PrimarySMTPAddress |
? { $_.PrimarySMTPAddress -match ("^"+[regex]::escape("$($_.firstname)")+"@domain.com") } 
```

# php - 如何使用 1 个 mysql 查询执行 2 个 php while 循环？

> ID：12273552
> 
> 赞同：1
> 
> 时间：2012-09-05T01:58:06.920
> 
> 标签：php, mysql

是否可以使用 php 和 mysql 只运行一个查询，然后执行两个具有不同结果的 while 循环。一世

```
//this is the query
$qry_offers = mysql_query("SELECT * FROM offers ORDER BY offer_end ASC"); 
```

在第一个循环中，我想显示“end_date”小于或等于今天的任何结果

```
<div id="current">
<?
while($row_offers = mysql_fetch_assoc($qry_offers)) {
    if ( (date("Y-m-d H:i:s")) <= ($row_offers['offer_end']) ) {
        echo '<li><a href="#">'.$row_offers['offer_name'].'</a></li>';
    }
}
?>
</div><!-- END OF CURRENT --> 
```

在第二个循环中，我想显示“end_date”大于今天的任何结果

```
//this is where i would have the 2n while loop
<div id="inactive">
<?
   while($row_offers = mysql_fetch_assoc($qry_offers)) {
    if ( (date("Y-m-d H:i:s")) > ($row_offers['offer_end']) ) {
        echo '<li><a href="#">'.$row_offers['offer_name'].'</a></li>';
    }
}
?>
</div><!-- END OF INACTIVE --> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:13:58.417

解决方案是保存每个循环的结果，然后在最后将它们放在一起。

```
$offers_current = array();
$offers_inactive = array();

while($row_offers = mysql_fetch_assoc($qry_offers)) {
    if ( (date("Y-m-d H:i:s")) <= ($row_offers['offer_end']) )
        $offers_current[] = '<li><a href="#">'.$row_offers['offer_name'].'</a></li>';
    if ( (date("Y-m-d H:i:s")) > ($row_offers['offer_end']) )
        $offers_inactive[] = '<li><a href="#">'.$row_offers['offer_name'].'</a></li>';
}

?>
<div id="current">
    <ul>
    <?php echo implode("\n", $offers_current) ?>
    </ul>
</div>
<div id="inactive">
    <ul>
    <?php echo implode("\n", $offers_inactive) ?>
    </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T02:06:47.730

你可以这样做：

```
$itemsArray = mysql_fetch_assoc($qry_offers);
foreach ( $itemsArray as $row_offers ) {
    // ... Code in here for less than 'offer_end'
}
foreach ( $itemsArray as $row_offers ) {
    // ... Code in here for greater than 'offer_end'
} 
```

# android - 可运行文件中的 SetText 视图无法正常工作

> ID：12273553
> 
> 赞同：1
> 
> 时间：2012-09-05T01:58:10.443
> 
> 标签：android

我希望每 0.75 秒更新一次我的 UI，我不想使用 AnsyTask。但是 TextView 只设置在 for 循环的末尾，知道为什么吗？

```
...

robotWords = "........Hey hello user!!!";
        wordSize = robotWords.length();
        mHandler.postDelayed(r, 750);
    }

    private Runnable r = new Runnable()
    {
        public void run()
        {
            for(int i=0; i<wordSize; i++)
            {           
                robotTextView.setText("why this words only display on the textView at last operation on this for loop?");
                Log.i(TAG, robotWords.substring(0, i));
                try
                {
                    Thread.sleep(750);
                } catch (InterruptedException e)
                {
                    e.printStackTrace();
                }
            }

        }
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:34:40.863

**Try this, call "doStuff()" when you want the operation to take place**

```
public void doStuff() {
    new Thread(new Runnable() {
        public void run() {

    for(int i=0; i<wordSize; i++) {           
        robotTextView.setText("why this words only display on the textView at last operation on this for loop?");
        Log.i(TAG, robotWords.substring(0, i));

                robotTextView.post(new Runnable() {
                    public void run() {
                           robotTextView.setText("why this words only display on the textView at last operation on this for loop?");
                    }
                });

        try {
            Thread.sleep(750);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

            }
        }
    }).start();
} 
```

Hope this helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:13:13.830

由于这一行，TextView 仅设置在 for 循环的末尾`Thread.sleep(750);`

您的线程将在文本真正设置为您的 textview 之前休眠。我认为您应该每 750 毫秒调用一次 Handler.postDelayed 而不是使用 `Thread.sleep(750);`或使用 CountDownTimer

```
new CountDownTimer(750 * wordSize, 750) {

 public void onTick(long millisUntilFinished) {
     robotTextView.setText("why this words only display on the textView at last operation on this for loop?");
            Log.i(TAG, robotWords.substring(0, i));
 }

 public void onFinish() {         
 } 
```

}。开始（）;

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T02:15:19.450

您不应该从另一个线程调用 UI 线程。使用[倒计时](http://developer.android.com/reference/android/os/CountDownTimer.html)

```
 new CountDownTimer(wordSize*750, 750) {

         public void onTick(long millisUntilFinished) {
             robotTextView.setText("...");
         }

         public void onFinish() {

         }
    }.start(); 
```

# php - 我可以通过数字索引访问关联数组吗？

> ID：12273562
> 
> 赞同：0
> 
> 时间：2012-09-05T01:59:21.643
> 
> 标签：php, arrays, key-value, keyvaluepair

我想知道是否可以在可变变量数组引用中获取 x 值位置（即第二个）。

下面的代码适用于第一个数组，但不适用于第二个。

```
// WORKS FINE //
$my1stArray= array( 'red', 'green', 'blue');
$var_1st = 'my1stArray';

// for each lopp of var var works fine
echo " - my1stArray Values - <br>";
foreach ($$var_1st as $k => $v){
echo $k." : ".$v." <br>";
}
// direct access also works
echo "my1stArray 3rd value: ".${$var_1st}[2]."<br>";

// Not so good! //
$my2ndArray = array(
    'color' => '#ff0000',
    'face' => 'helvetica',
    'size' => '+5',
);
$var_2nd = 'my2ndArray';

// for each lopp of var_2nd works fine
echo "<br> - my2ndArray Values - <br>";
foreach ($$var_2nd as $k => $v){
echo $k." : ".$v." <br>";
}
/** try to access 2nd value in array with position **/
echo "my2ndArray 2rd value: ".${$var_2nd[1]}[0]."<br>";
echo "my2ndArray 2rd value: ".${$var_2nd}[1][0]."<br>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:30:20.870

Your last example in your code is not working for the same reason that the following code does not work:

```
$a = array('akey'=>'a','bkey'=>'b');
echo $a[0]; 
```

The reason is the key is set to a string and must be accessed as such. To fix my example I would need to change it to:

```
$a = array('akey'=>'a','bkey'=>'b');
echo $a['akey']; 
```

To fix your example you need to change your last echo so that it references the key as a string:

```
echo "my2ndArray 2rd value: ".${$var_2nd}['color']."<br>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:57:55.160

好吧，在评论中我说“不，你不能”，但实际上有一种方法。这是一个示例（没有变量）：

```
$my2ndArray = array(
    'color' => '#ff0000',
    'face' => 'helvetica',
    'size' => '+5',
);
$keys = array_keys($my2ndArray);
echo "my2ndArray 2nd value: " . $my2ndArray[$keys[1]]  . "<br>"; 
```

看起来不是很好，但应该可以。并不是说如果你对数组进行排序，键索引就会改变。

另一种方法是使用我在评论中提到的计数器和循环。但这会更难看……

# sql - Oracle 触发器——更新行而不是删除

> ID：12273564
> 
> 赞同：3
> 
> 时间：2012-09-05T01:59:44.487
> 
> 标签：sql, oracle, triggers

我如何编写 Oracle 触发器，而不是当用户删除某个记录时，删除实际上并没有发生，而是对这些行执行更新并将记录的状态设置为“D”？

我试过了：

```
create or replace
trigger DELFOUR.T4M_ITEM_ONDELETE
before delete on M_ITEM_H
FOR EACH ROW
BEGIN
  UPDATE
    M_ITEM_H
  SET
    ITEM_STAT = 'D'
  WHERE
    CUST_CODE = 'TEST'
    AND ITEM_CODE = 'GDAY'
  ;

  raise_application_error(-20000,'Cannot delete item');
END; 
```

但是我遇到了变异表错误。这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:20:09.227

如果你真的需要一个触发器，更合乎逻辑的方法是创建一个视图，`INSEAD OF DELETE`在视图上创建一个触发器，并强制应用程序对视图而不是基表发出删除。

```
CREATE VIEW vw_m_item_h
AS
SELECT *
  FROM m_item_h;

CREATE OR REPLACE TRIGGER t4m_item_ondelete
  INSTEAD OF DELETE ON vw_m_item_h
  FOR EACH ROW
AS
BEGIN
  UPDATE m_item_h
     SET item_stat = 'D'
   WHERE <<primary key>> = :old.<<primary key>>;
END; 
```

更好的是，您将省去触发器，创建一个`delete_item`您的应用程序将调用的过程而不是发出一个`DELETE`过程，并且该过程将简单地更新行以设置`item_stat`列而不是删除行。

如果您真的，真的，真的想要一个涉及表本身触发器的解决方案，您可以

1.  `m_item_h`创建一个包含一个成员的包，该成员是映射到表中数据的记录集合
2.  创建清空此集合的删除前语句级触发器
3.  创建一个删除前的行级触发器，将`:old.<<primary key>>`和所有其他`:old`值插入到集合中
4.  创建一个 after delete 语句级触发器，该触发器遍历集合，将行重新插入表中，并设置`item_stat`列。

这将比 a 涉及更多的工作，`instead of trigger`因为您必须删除然后重新插入该行，并且它会涉及更多的移动部分，因此它会不那么优雅。但它会起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T02:17:34.963

首先，您编写的触发器会引发变异表错误。从技术上讲，您要问的是不可能的，即删除不会删除而是更新，除非您在中间引发异常，这可能是一种丑陋的做法。我认为用户使用某种应用程序前端，它允许他们`delete`使用删除按钮来获取数据，因此您可以在那里使用更新语句而不是`delete`语句。

另一种选择是创建一个日志表，您可以在其中插入记录，然后将其从实际表中删除，然后将日志表与实际表连接以检索已删除的记录。就像是-

```
 CRETAE TABLE M_ITEM_H_DEL_LOG as SELECT * FROM M_ITEM_H WHERE 1=2; 
```

接着

```
create or replace
trigger DELFOUR.T4M_ITEM_ONDELETE
before delete on M_ITEM_H
FOR EACH ROW
BEGIN
  INSERT INTO
    M_ITEM_H_DEL_LOG
  VALUES (:old.col1, :old.col2,.....) --col1, col2...are columns in M_ITEM_H
  ;
END; 
```

# haskell - 无法将预期类型“Int”与实际类型“Integer”匹配

> ID：12273566
> 
> 赞同：11
> 
> 时间：2012-09-05T02:00:06.490
> 
> 标签：haskell

我有以下 Haskell 代码：

```
-- Problem 69

import ProjectEuler

phi :: Integer -> Integer
phi n = n * product [p - 1 | p <- primeDivisors n] `div` product [p | p <- primeDivisors n]
-- primeDivisors n is a list of the prime divisors of n

maxRatio :: (Int, Int, Double) -> (Int, Int, Double) -> (Int, Int, Double)
maxRatio t1@(_, _, x) t2@(_, _, y)
  | x > y = t1
  | otherwise = t2

main = print (foldl
                maxRatio
                (0, 0, 0.0)
                [(n, phi n, ratio) | n <- [2..max], let ratio = fromIntegral n / (fromIntegral (phi n))]
              )
    where max = 1000 
```

这给出了以下错误：

```
Couldn't match expected type `Int' with actual type `Integer'
In the expression: n
In the expression: (n, phi n, ratio)
In the third argument of `foldl', namely
  `[(n, phi n, ratio) |
      n <- [2 .. max],
      let ratio = fromIntegral n / (fromIntegral (phi n))]' 
```

我怀疑三元组`(0, 0, 0.0)`中的 0 是 type `Int`。`0`在这种情况下，始终是类型`Int`还是 ghci 推断类型`Int`？如果是后者，我该如何强制它输入`Integer`呢？还是有其他原因导致此错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-05T02:32:39.477

Haskell can generally infer the type of numeric literals such as `0` as whatever appropriate type you need them to be. This is because it knows what functions you pass them to; if I have a function `phi :: Integer -> Integer`, and I call `phi 0`, Haskell knows that that particular `0` must have been an `Integer`. It's also fine if I call a function `pho :: Int -> Int` with `pho 0`; *that* particular `0` is inferred to be an `Int`.

However `Int` and `Integer` are different types, and there's no way one particular `0` can be passed to both `phi` and `pho`.

Your issue is simply that the tuples that `maxRatio` deals with are typed (by you) `(Int, Int, Double)`, but that one such tuple is constructed as `(n, phi n, ratio)`. Since `phi` takes and returns `Integer`, the `n` in that expression has to be an `Integer`. But then that doesn't work for `maxRatio`, so you get the error.

Depending on which type you actually wanted (`Int` or `Integer`), all you need to do is change the type signature of `phi` or `maxRatio` so that they're working with the same kind of number. Haskell will decide that your literally written `0`s are whatever numeric type is necessary to make that work, *provided* there is one that **can** make it work!

Note that the error messaged *specifically* told you that it was `n` in `(n, phi n, ratio)` that was expected to be an `Int` and was actually an `Integer`. The `(0, 0, 0.0)` tuple is never mentioned. Often type errors originate somewhere other than where the compiler points you (since all the compiler can do is spot that different chains of inference produce inconsistent requirements on the type of something, with no way to know which part of the whole process is "wrong"), but in this case it did pretty well.

Haskell gets a (fairly justified) bad rep for inscrutable error messages, but it can help a lot to start from what the compiler is telling you is the problem and try to figure out **why** the facts it's complaining about arise from your code. This will be painful at first, but you'll quickly develop a basic literacy in Haskell's error messages (at least the more straightforward ones) that will help you spot these kinds of errors really quickly, which makes the compiler a very powerful error-detection system for you.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T02:10:13.077

`n`被推断为`Int`由于的类型`maxRatio`，而类型`phi`表示它应该是`Integer`。最简单的解决方法是更改`maxRatio`​​要使用的类型，`Integer`甚至只是`a`因为它不触及这些值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-05T02:25:43.063

它正在被推断，因此您只需更改`maxRatio`. 不过，如果您需要将显式更改`Int`为`Integer`，请使用`toInteger :: (Integral a) => a -> Integer`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T15:02:10.640

您的类型签名不一致 - 全部替换`Int`为`Integer`。

# c# - 访问 Web 控件值

> ID：12273571
> 
> 赞同：0
> 
> 时间：2012-09-05T02:01:20.803
> 
> 标签：c#, asp.net

我在 ASP.NET 3.5 中有两个页面，我需要从第一页但在第二页访问/读取 Web 控件值。第二页显示的是一个链接，没有发布事件或类似的东西。

我想我应该使用 ViewState，但是对于这个任务来说它看起来很复杂，所以请告诉我一个更好的方法来实现这个。

PS 我正在使用 C# 和 Visual Studio 2010

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T02:25:10.403

如果我理解正确，您有两个 .aspx 页面，并且您希望一个页面与另一个页面共享信息。第一页是否链接到第二页？

我问是因为您可以采取几种方法。您可以将参数添加到第二页链接中的查询字符串中，其中包含您尝试发送的信息。您还可以使用会话来临时存储信息。

例如：

```
<asp:HyperLink NavigateUrl="www.<yoursite>.com/firstpage.aspx?eggs=1&bacon=yum" Text="Awesome Site" runat="server" /> 
```

在第二页中，您将在 Page_Load 的代码隐藏中拥有它

```
string eggs = Request.QueryString["eggs"];
string bacon = Request.QueryString["bacon"]; 
```

现在，您在第二页中获得了第一页中的值。

另一种方法可能是像这样使用 Session ：

第一页：

```
Session["bacon"] = "Yum"; 
```

第二页：

```
string bacon = (string)Session["bacon"]; 
```

但是，我建议不要过度使用会话在页面之间传递信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T03:40:27.317

有一种更好的方法是使用 QueryString 杂耍和 Session 值。
您可以只使用在跨页发布期间设置的上一页属性。

使用 asp 链接按钮：

```
<asp:LinkButton runat="server" id="myLink"
  NavigateUrl="~/Page2.aspx"
  target="_blank" Text="Go to page 2"></asp:LinkButton> 
```

然后在**Page2.aspx.cs**上：

从[Page.PreviousPage](http://msdn.microsoft.com/en-us/library/system.web.ui.page.previouspage.aspx)中获取值，如下所示：

```
TextBox txtUser = (TextBox)Page.PreviousPage.FindControl("txtUser");
TextBox txtSomeValue = (TextBox)Page.PreviousPage.FindControl("txtSomeValue"); 
```

在第二页中根据需要使用这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T02:10:20.453

Quick & “Dirty”：保存要传递的信息的会话变量。

在第一页：

```
Session["ValueToPassToOtherControl"] = "The value"; 
```

在第二页：

```
var value = Session["ValueToPassToOtherControl"]; 
```

优雅：您需要以任何方式管理您的状态（通过一个静态管理器，其功能是存储和检索该信息，但这也是变量）。问题是[HTTP 是无状态的](http://en.wikipedia.org/wiki/Stateless_protocol)。所以你需要通过某种数据的存储和检索来绕过这个限制。

您建议使用[ViewState](http://msdn.microsoft.com/en-us/library/ms972976.aspx)但忘记了，ViewState 是 ASP.NET 网页使用的一种技术，用于在回发期间持久更改 Web 窗体的状态，这不是您的场景中发生的情况。

# mysql - **[Err] 1416：数据库查询中的 GEOMETRY 字段

> ID：12273572
> 
> 赞同：0
> 
> 时间：2012-09-05T02:01:22.113
> 
> 标签：mysql, database, insert

我想在我的数据库表中插入一些数据。我的名为 PatientInfo 的表包含列**PName、DOfBirth、Telephone、Sex**

我试过这个查询：INSERT INTO PatientInfo (PName, DOfBirth, Telephone, Sex) VALUES ('XXXX', 28, 0111000000, 'Female');

但出现此错误： **[Err] 1416 - 无法从您发送到 GEOMETRY 字段的数据中获取几何对象**

有人可以帮我吗...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:26:21.373

LINESTRING 数据类型用于存储空间数据。PName 和 Sex 列的数据类型应该是文本类型；VARCHAR 可能是他们最好的数据类型。

# java - Java中的线程行为

> ID：12273574
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:01:59.510
> 
> 标签：java

我正在运行下面的程序，但由于某种原因，它看起来不像我正在使用 run() 方法。基本上我试图发现线程的行为。我得到以下结果：

pqni392fr8dchsdmajglvuqsof
pqni392fr8dchsdmajglvuqsof has wake up
l79uho1tjtot7pcmk4vhh5t8qc
l79uho1tjtot7pcmk4vhh5t8qc has wake up
adfapus6g1fst56daimrudkgji
adfapus6g1fst56daimrudkgji has wake up
iqfo9knc99kcb622g36c77m62
iqfo9knc99kcb622g36c77m62 has wake up
67vdpghqit1a4iv3593451ps0a
67vdpghqit1a4iv3593451ps0a has wake up

如您所见，我没有进入线程应该休眠的 run() 方法。有什么问题？还有一个问题，线程是否可以从程序的第一次运行开始执行 run()，因为我注意到输出的第一行总是来自 main()。

谢谢你。

* * *

```
import java.math.BigInteger;
import java.security.SecureRandom;
import java.util.Random;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.logging.Level;
import java.util.logging.Logger;

class myThread implements Runnable {

    @Override// method run is to be executed by a new thread
    public void run() {
        System.out.println("I am here");
        int timeRandom = new Random().nextInt(50);

        try {
            String ThrName = Thread.currentThread().getName();
            Thread.sleep(timeRandom);
            System.out.println("Thread " + ThrName + " sleeping " + timeRandom);
            } catch (InterruptedException ex) {
            Logger.getLogger(myThread.class.getName()).log(Level.SEVERE, null, ex);
        }
        //      throw new UnsupportedOperationException("Not supported yet.");

    }
}

class myClass {

    static int nthread = 5;

    public static void main(String[] args) {
        ExecutorService myService = Executors.newFixedThreadPool(nthread);
        while (nthread != 0) {
            Thread.currentThread().setName(new BigInteger(130, new SecureRandom()).toString(32));
            System.out.println(Thread.currentThread().getName());
            myService.submit(Thread.currentThread());

            System.out.println(Thread.currentThread().getName() + "  has wake up");
            //
            nthread -= 1;
        }
        myService.shutdown();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:16:38.760

你永远不会将一个实例传递`myThread`给你的 ExecutorService，而是你正在执行与当前线程相关的所有事情。

你的代码：

```
Thread.currentThread().setName(new BigInteger(130, new SecureRandom()).toString(32));
System.out.println(Thread.currentThread().getName());
myService.submit(Thread.currentThread()); 
```

创建预期结果的代码：

```
Thread myThread = new Thread(new myThread());
myThread.setName(new BigInteger(130, new SecureRandom()).toString(32));
System.out.println(myThread.getName());
myService.submit(myThread); 
```

另外，作为旁注，Java 约定规定类名用大写字母声明。myClass 应该是 MyClass，而 myThread 应该是 myThread。不过，这与运行时问题无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T02:10:48.060

您正在重复提交应用程序的主线程`Runnable`。`ExecutorService`我不确定`run()`在主线程上调用的定义行为（如果有的话，可能是未定义的）是什么，但这肯定是不正确的。您想创建新`myThread`对象并将它们提交给`ExecutorService`。

# jquery - jQuery 水平列表滑块

> ID：12273578
> 
> 赞同：0
> 
> 时间：2012-09-05T02:02:26.447
> 
> 标签：jquery, slider

我创建了以下列表滑块：http: [//jsfiddle.net/XNBMr/5/](http://jsfiddle.net/XNBMr/5/)

我希望“蓝色”元素是“可滑动的”。目前，我只能通过单击每个单独的 LI 在选项之间进行更改。

我希望它在选择“蓝色”并向左或向右移动时滑动。

我希望这是可能的，因为我希望它可以在触摸屏上工作。

# nio - 如何使用 Java nio 从 ServletInputStream 写入上传的图像？

> ID：12273579
> 
> 赞同：0
> 
> 时间：2012-09-05T02:02:48.883
> 
> 标签：nio

我已经使用 ByteArrayOutputStream 完成了上传，现在我想使用 nio 从 ServletInputStream 将图像写入硬盘中的文件，我尝试了几种方法，但到目前为止没有运气，现在我有了：

```
 @Override
public void doPost(final HttpServletRequest request, final HttpServletResponse response)

throws IOException, ServletException {

    final String fileName = "img_" + UUID.randomUUID().toString() + ".jpg";

    final String filePathName = "E:\\tmp\\" + fileName;

    final FileChannel outChannel = new FileOutputStream(filePathName).getChannel();

    final ReadableByteChannel inChannel = Channels.newChannel(request.getInputStream());

       outChannel.transferFrom(inChannel, 0, request.getContentLength());

    inChannel.close();
    outChannel.close();

} 
```

生成的指定文件与原始文件大小相同，但无法打开。请问我在这里做错了什么？什么是正确的方法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T02:13:13.173

我不明白为什么将“--”放入文件中，除非将其发送给您，但您需要`transferFrom()`循环调用。您不能假设在一次调用中传输了整个文件。它返回每次调用传输的字节数，因此您可以跟踪传输的总数：如果完成，则中断，否则将其添加到偏移量，从长度中减去，然后重复。

# api - Google Maps API 上的雷达图像

> ID：12273581
> 
> 赞同：15
> 
> 时间：2012-09-05T02:02:55.043
> 
> 标签：api, google-maps, weather, weather-api

经过多次搜索，我一直在努力寻找解决方案。我正在寻找一种网络服务或 API 或其他东西，它可以让我获取美国的**平滑**NEXRAD（天气雷达）数据并将其显示在谷歌地图上。我只能找到非商业或纯（未平滑）数据。我正在进行的项目需要与您通过 WeatherBug 看到的相媲美的雷达图像。

有没有人对这样的数据有任何经验或知道任何可用的 API？

我什至找不到可以将来自国家气象局的原始数据处理成平滑的雷达图像的程序，我可以将其切片并在谷歌地图叠加层中使用......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T05:03:57.667

试一试。这是我正在使用的，而且效果很好。

这是数据来源页面的链接，他们还提供其他几种产品。

> [http://mesonet.agron.iastate.edu/ogc/](http://mesonet.agron.iastate.edu/ogc/)

```
tileNEX = new google.maps.ImageMapType({
    getTileUrl: function(tile, zoom) {
        return "http://mesonet.agron.iastate.edu/cache/tile.py/1.0.0/nexrad-n0q-900913/" + zoom + "/" + tile.x + "/" + tile.y +".png?"+ (new Date()).getTime();
    },
    tileSize: new google.maps.Size(256, 256),
    opacity:0.50,
    name : 'NEXRAD',
    isPng: true
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T13:47:29.147

如果你还在寻找... [http://www.eldoradocountyweather.com/scripts/weather-scripts.php](http://www.eldoradocountyweather.com/scripts/weather-scripts.php)有一些好东西。

# ruby - 将“ls -l”输出转换为类似于 File 的对象

> ID：12273583
> 
> 赞同：3
> 
> 时间：2012-09-05T02:03:02.250
> 
> 标签：ruby

我最近开始使用 Ruby，想知道是否有办法将列表输出转换为对象，以便我可以访问属性。

为了更清楚一点，这是我的输出

```
find ./* -type f | xargs ls -l
-rw-r--r--  1 ncktrnl  staff  0 Sep  4 18:52 ./dir1/file3
-rw-r--r--  1 ncktrnl  staff  0 Sep  4 18:52 ./file1
-rw-r--r--  1 ncktrnl  staff  0 Sep  4 18:52 ./file2 
```

现在我想将上面的列表转换为 File 或 Dir 对象，以便我可以轻松访问属性。

例如：

```
output = `find ./* -type f | xargs ls -l`
out_arr = output.split("\n")
out_arr.each do |line|
  f = File.new(line)
  puts "#{f.mtime}" # => prints mtime after parsing the line
end 
```

我`File.new`以示例为例，但我认为它不是这样工作的，所以我想知道是否有办法做到这一点。我可以编写自己的解析器，但不确定是否已经存在某些东西。我无法创建实际文件的文件对象，因为我通过在不同主机上运行远程 ssh 命令来获取列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:07:06.323

最明显的方法是使用[pathname](http://ruby-doc.org/stdlib-1.9.3/libdoc/pathname/rdoc/index.html)或[find](http://ruby-doc.org/stdlib-1.9.3/libdoc/find/rdoc/index.html) from std-lib 来处理这个问题。使用该`each_child`方法或类似的方法，以及任何过滤，您可以做到这一点，而根本不需要使用外部命令。

您也可以在不触及标准库、使用`File`和`Dir`对象的情况下执行相同操作。

尽管您可以（仅）提取路径并手动创建文件实例，但您无法创建具有所需详细信息的 File 对象。但实际上，完全避免使用外部 shell 命令是最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T18:11:18.440

有[net-ftp-list](http://rubygems.org/gems/net-ftp-list) gem，它可以解析来自不同远程系统的 ls 输出。

# css - 标签下所有类的 CSS

> ID：12273585
> 
> 赞同：1
> 
> 时间：2012-09-05T02:03:38.943
> 
> 标签：css, class

我有这样的html

```
<div>
    <ul class="reportTable reportTableSum">
        <li class="rowW">
            <ol class="class_one">1</ol>
            <ol class="class2">2</ol>
            <ol class="classiii">3</ol>
            <ol class="class4">4</ol>
            <ol class="classfive">5</ol>
            ...[and more class]
         </li>
    </ul>
</div> 
```

我需要为那些 html 设置像这样的 css 部分。类名是随机的，不是按数字顺序排列的。

```
.reportTable li ol.class_one,
.reportTable li ol.class2,
.reportTable li ol.classiii,
.reportTable li ol.class4,
...,
.reportTable li ol.classfive{
    display:block;
    min-height:15px;
    padding:1px 15px 1px 2px;
    margin:0;
    width:auto;
    overflow:hidden;
} 
```

我尝试将 css 重写为类似或类似的内容以申请所有课程，但它似乎不起作用

```
.reportTable li ol.*{
    ...
} 
```

我怎样才能使这项工作。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:06:08.443

您不需要通配符`*`。此外`ol.*`是无效的语法。

使用以下内容：

```
.reportTable li ol {
  // add declarations
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T04:24:51.383

如果您真的希望在给定的上下文中将规则应用于`ol`具有`class`属性的所有此类元素，无论其值是什么，请使用[属性选择器](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)：

```
.reportTable li ol[class] 
```

这种选择器得到了很好的支持（甚至是 IE 7）。

# google-app-engine - 将 100 万张图片上传到 BlobStore

> ID：12273587
> 
> 赞同：2
> 
> 时间：2012-09-05T02:03:54.063
> 
> 标签：google-app-engine, blobstore

总的来说，我对 GAE 和 Web 开发还很陌生，我正在尝试使用 GAE BlobStore。我正在使用 python 似乎无法找到将大量文件上传到 BlobStore 的任何资源。

我已经阅读了许多资源和示例，但似乎没有一个对这个特定问题有帮助。

有没有人有这方面的资源或经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T04:11:19.523

我们将根据您计划使用图像的方式将它们上传到 Google 存储并使用[gsutil](https://developers.google.com/storage/docs/gsutil)从您的 AppEngine 应用程序访问它们。如果具有可恢复上传和[多线程](https://developers.google.com/storage/docs/gsutil_reference_guide#multithreading)以加快上传速度。

[否则，由于此](http://code.google.com/p/googleappengine/issues/detail?id=8032)错误，您需要使用[create_upload_url](https://developers.google.com/appengine/docs/python/blobstore/functions)并自己进行批处理，一次批处理少于 500 个文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T11:17:40.197

从专用服务器迁移到 appengine 时，我的项目中有类似的要求。我们不必移动 100 万，但大约是 100000。

花了一些时间，但最后完成了。

这是使用非常简单的解决方案完成的。刚刚创建了一个文件上传服务，就像[blogstore docs 上](https://developers.google.com/appengine/docs/python/blobstore/overview#Uploading_a_Blob)的示例一样。

```
class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
  def get(self):
    upload_url = blobstore.create_upload_url('/upload')
    self.response.write(upload_url)

  def post(self):
    upload_files = self.get_uploads('file')
    blob_info = upload_files[0]
    self.response.write(blob_info.key()) 
```

然后使用上传脚本从本地主机上传文件。

这样的脚本可以用 python 编写，甚至可以用 shell 脚本编写，通过组合`find`,`curl`和`xargs`.

为了加速使用多个线程并并行执行 32 次上传有帮助。

For robustness, after uploading a file, we can try to download it and compare the sizes/md5, and re-uploading if something went wrong.

# twitter-bootstrap - 使用 Twitter Bootstrap 添加垂直空格？

> ID：12273588
> 
> 赞同：166
> 
> 时间：2012-09-05T02:03:57.317
> 
> 标签：twitter-bootstrap, whitespace, vertical-alignment, twitter-bootstrap-2

使用 Twitter 的 Bootstrap 添加垂直空白的最佳方法是什么？

例如，假设我正在创建一个登录页面，并且希望在某个按钮的上方和下方有一点（100 像素）空白。显然，我可以为那个特定的按钮创建一个特定的类。但是，我认为 Bootstrap 应该有一种添加垂直空格的[DRY方式。](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-05T02:07:28.760

在 v2 中，没有针对这么多垂直空间的任何内置功能，因此您需要坚持使用自定义类。对于较小的高度，我通常只`<div class="control-group">`在一个按钮周围扔一个。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2015-06-03T23:53:20.703

包装工作，但当你只想要一个空间时，我喜欢：

```
<div class="col-xs-12" style="height:50px;"></div> 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2017-01-26T21:21:36.240

在**Bootstrap 4/5**中有间距实用程序（[BS4](https://getbootstrap.com/docs/4.0/utilities/spacing/)，[BS5](https://getbootstrap.com/docs/5.0/utilities/spacing/)）。

文档摘录：

> 适用于所有断点的间距实用程序 from `xs`to`xl`中没有断点缩写。这是因为这些类是自上而下应用的`min-width: 0`，因此不受媒体查询的约束。但是，其余断点确实包含断点缩写。
> 
> `{property}{sides}-{size}`这些类使用for`xs` 和`{property}{sides}-{breakpoint}-{size}`for `sm`、`md`、`lg`和的格式命名`xl`。
> 
> 财产是*以下*之一：
> 
> *   `m`- 对于设置的类`margin`
> *   `p`- 对于设置的类`padding`
> 
> 其中*边*是其中之一（**请注意 BS4 和 BS5 的差异**）：
> 
> *   `t`- 对于设置`margin-top`或`padding-top`
> *   `b`- 对于设置`margin-bottom`或`padding-bottom`
> *   `l`- 对于设置`margin-left`或`padding-left` **(Bootstrap 4)的类**
> *   `s`- 对于设置`margin-left`或`padding-left` **(Bootstrap 5)的类**
> *   `r`- 对于设置`margin-right`或`padding-right` **(Bootstrap 4)的类**
> *   `e`- 对于设置`margin-right`或`padding-right` **(Bootstrap 5)的类**
> *   `x`- 对于同时设置`*-left`和`*-right`
> *   `y`- 对于同时设置`*-top`和`*-bottom`
> *   空白 - 对于在元素的所有 4 个边上设置 a`margin`或的类`padding`
> 
> 其中*size*是以下之一：
> 
> *   `0`- 对于通过将其设置为来消除边距或填充的类`0`
> *   `1`- （默认情况下）用于设置`margin`or`padding`的类`$spacer * .25`
> *   `2`- （默认情况下）用于设置`margin`or`padding`的类`$spacer * .5`
> *   `3`- （默认情况下）用于设置`margin`or`padding`的类`$spacer`
> *   `4`- （默认情况下）用于设置`margin`or`padding`的类`$spacer * 1.5`
> *   `5`- （默认情况下）用于设置`margin`or`padding`的类`$spacer * 3`

* * *

因此，要在元素上方和下方有一些额外的垂直空间，您将使用`my-5`class.

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2015-08-06T00:27:17.340

抱歉在这里挖了一个旧坟墓，但为什么不这样做呢？

```
<div class="form-group">
    &nbsp;
</div> 
```

它将添加一个正常表单元素高度的空间。

似乎表单上的 1 行大约是 50 像素（我刚刚检查的元素上是 47 像素）。这是一个横向的表格，左边 2col 有标签，右边 10col 有输入。所以你的像素可能会有所不同。

因为我的基本上是 50 像素，我会创建一个 50 像素高的间隔，没有边距或填充；

```
.spacer { margin:0; padding:0; height:50px; }
<div class="spacer"></div> 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2015-11-16T18:12:04.853

我知道这是旧的，但我来到这里寻找同样的东西，我发现 Bootstrap 有帮助块，在这些情况下非常方便：

```
<div class="help-block"></div> 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2015-02-18T13:30:31.237

对于版本 3，似乎没有“引导”方式来巧妙地实现这一目标。

A `panel`， a`well`和 a`form-group`都提供了一些垂直间距。

显然，更正式的特定垂直间距解决方案在 bootstrap v4 的路线图上

[https://github.com/twbs/bootstrap/issues/4286#issuecomment-36331550](https://github.com/twbs/bootstrap/issues/4286#issuecomment-36331550) [https://github.com/twbs/bootstrap/issues/13532](https://github.com/twbs/bootstrap/issues/13532)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-11-24T02:04:40.460

我只是使用不同的高度创建了一个 div 类，即

```
<div class="divider-10"></div> 
```

CSS是：

```
.divider-10 {
    width:100%; 
    min-height:1px; 
    margin-top:10px; 
    margin-bottom:10px;  
    display:inline-block; 
    position:relative;
} 
```

只需为需要的高度创建一个分隔器类。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2017-02-04T03:17:57.633

我的把戏。不优雅，但它有效：

```
<p>&nbsp;</p> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-03-02T19:52:55.050

我知道这很旧，并且已经发布了几个很好的解决方案，但是一个对我有用的简单解决方案是以下 CSS

```
<style>
  .divider{
    margin: 0cm 0cm .5cm 0cm;
  }
</style> 
```

然后在你的 html 中创建一个 div

```
<div class="divider"></div> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2017-08-08T19:14:23.033

只需使用`<br/>`. 我发现自己在这里寻找这个问题的答案，然后觉得有点愚蠢，因为没有考虑使用用户 JayKilleen 在评论中建议的简单换行符。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-01-16T19:12:39.747

我尝试使用`<div class="control-group">`它并没有改变我的布局。它没有增加垂直空间。对我有用的解决方案是：

```
<ol style="visibility:hidden;"></ol> 
```

如果这不能为您提供足够的垂直空间，您可以通过添加嵌套`<li>&nbsp;</li>`标签逐步获得更多空间。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-13T11:41:44.000

```
<form>
 <fieldset class="form-group"><input type="text" class="form-control" placeholder="Input"/></fieldset>
 <fieldset class="form-group"><button class="btn btn-primary"/>Button</fieldset>
</form> 
```

[http://v4-alpha.getbootstrap.com/components/forms/#form-controls](http://v4-alpha.getbootstrap.com/components/forms/#form-controls)

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2014-09-18T10:19:39.787

没有什么比 DRY 更干燥了

```
.btn {
    margin-bottom:5px;
} 
```

# .net - 使用自动配置的 localdb 进行单元测试；我该如何清理？

> ID：12273591
> 
> 赞同：15
> 
> 时间：2012-09-05T02:04:19.587
> 
> 标签：.net, sql-server, localdb

我已经配置了一个`.mdf`文件以及一个用于单元测试的 localdb 连接字符串，如下所示：

```
<connectionStrings>
        <add name="TestData" providerName="System.Data.SqlClient" connectionString="Data Source=(localdb)\v11.0; AttachDBFilename='|DataDirectory|\TestData.mdf'; Integrated Security=True"/>
</connectionStrings> 
```

一旦我为我的测试正确配置了部署文件，它就会很好地工作：.mdf 的副本附加到 LocalDB 的默认实例，并且`SqlClient`无需任何配置即可连接到它。它只是工作。

但是之后怎么清理呢？在我的本地机器上，我可以定期使用 SSMS 手动分离旧的测试数据库，但在 CI 服务器上，显然最好让单元测试自行清理。

是否有类似的自动方法可以使 localdb 数据库从实例中分离出来？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:32:32.070

这就是我删除 localDB 数据库的方式。我不喜欢的是 .mdf 也被删除了。我通过首先将其复制到 tem 目录并使用副本创建数据库来克服这个问题。

```
var sc = new Microsoft.SqlServer.Management.Common.ServerConnection(your localDB SqlConnection here);
var server = new Microsoft.SqlServer.Management.Smo.Server(sc);
server.KillDatabase(dbName here); 
```

希望这有助于菲尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-14T15:23:56.173

是的，但您可能不需要它。

我目前正在使用一个过程，我按照 wbx911/Tim Post 在他们的答案中的方式附加附加数据库。但是，如果您要附加原始数据库的副本（例如由项目/解决方案构建创建的副本），则不需要分离它们。如果没有连接到数据库，它将在下一次测试运行时被覆盖。

如果您有很多附加的数据库副本，或者只是不想清理附加的所有内容，那么您可以使用如下所示的存储过程，附加到 localDb 实例的主数据库（例如我个人使用）：

```
CREATE PROCEDURE [dbo].[DettachTestDatabases]
AS

BEGIN
DECLARE  @imax INT, 
         @i    INT 
DECLARE  @Name VARCHAR(255)

DECLARE  @DbsToDrop TABLE(RowID INT IDENTITY ( 1 , 1 ), 
                          name VARCHAR(255)
                         ) 

INSERT @DbsToDrop
SELECT [name]
  FROM [master].[sys].[databases]
  WHERE 
    --Remove all local dbs with *SomeText*.mdf or SomeOtherTextin name
    (name like '%SomeText%.mdf' or name like '%SomeOtherText%')
    -- Exclude VS test dbs (add more as required...)
    and (name not like '%TESTS.%');

SET @imax = @@ROWCOUNT 
SET @i = 1 

WHILE (@i <= @imax) 
  BEGIN 
        SELECT @Name = name 
        FROM   @DbsToDrop 
        WHERE  RowID = @i

        EXEC master.dbo.sp_detach_db @dbname = @Name;

        PRINT 'Dettatched ' + @Name;

        SET @i = @i + 1;
  END   --while

END --sp
GO 
```

我正在使用命名约定来确定要删除哪些数据库（因此类似语句）。Visual Studio 附加了几个 db（或者至少我认为它们属于 VS）来管理我不想分离的测试结果（因此是“不喜欢”条件）。有一个 master.dbo.sp_detach_db 按名称分离，因此您实际上只需要引用名称，但由于 localdb 名称可能有点狂野，因此查找将很有用。

在我的测试结束时我还没有自动化这个，因为我觉得没有必要（因为覆盖工作正常），但我可以在我想要或需要的任何时候在 SSMS 中执行它。但是，如果您觉得有必要，您只需要从您的清理代码中管理对 SP 的调用。

附加数据库有点昂贵的过程。我选择了一种清理方法/SP，它删除任何可变数据并重新填充表以使数据库处于一致状态，这非常快，而不是重新附加数据库。

如果您发现任何改进点，我真的很想了解它们！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-26T17:40:00.683

您正在使用的单元测试框架是否允许您附加清理方法（即MS Test 中的 AssemblyAttribute、NUnit 3 中的 OneTimeTearDown、[XUnit](https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assemblycleanupattribute.aspx)中的[共享](https://github.com/nunit/docs/wiki/SetUpFixture-Attribute)[上下文](http://xunit.github.io/docs/shared-context.html)）？如果是这样，您可以像下面这样连接，以便在测试结束时自动分离数据库。

```
public static void CleanUp()
{
    using (var connection = new SqlConnection(ConnectionString))
    {
        connection.Open();

        using (var command = connection.CreateCommand())
        {
            var sql = "DECLARE @dbName NVARCHAR(260) = QUOTENAME(DB_NAME());\n" +
                "EXEC('exec sp_detach_db ' + @dbName + ';');";
            command.CommandText = sql;
            command.ExecuteNonQuery();
         }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T07:36:48.353

如果您正在谈论单元测试，例如 xUnit，您可以将一些属性添加到测试本身，以对任何涉及数据库的内容进行回滚。

实际上，它在企业级事务中运行测试。这样可以使每个测试的数据保持稳定，并且您不需要模拟数据库；它可以成为有效的验收测试。

例如（在 xUnit 中）：

```
[Fact]
[AutoRollback]
public void Should_Insert_Valid_Data()
{
    // Arrange: presume there's an object, sut, that supports insert,
    // and you have some data

    // Act:
    int key = sut.Insert(data);

    // Assert:
    Assert.True(key > 0, "Expected a primary key to be returned");
    var inserted = sut.Get(key);
    Assert.Equal<DataClassName>(data, inserted, CompareAllButKey);
} 
```

（仅供参考：“sut”是“正在测试的情况”或“正在测试的主题”）

阅读这篇关于“[在测试中隔离数据库的策略](http://lostechies.com/jimmybogard/2013/06/18/strategies-for-isolating-the-database-in-tests/)”的文章可能会有所帮助。那篇文章的末尾还有一些其他不错的链接。

顺便说一句，我使用 xUnit 作为示例，但其他测试框架具有类似的属性来控制回滚。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-02-04T05:36:51.040

像这样 ：

```
 // ProjectPath/bin/Debug/dbfile.mdf

 [TestInitialize]
 public void SetUp()
 {           
    AppDomain.CurrentDomain.SetData(
      "DataDirectory", Path.Combine(AppDomain.CurrentDomain.BaseDirectory, ""));
  } 
```

# node.js - node.js + mongo + 多个实体的原子更新 = 头痛

> ID：12273596
> 
> 赞同：5
> 
> 时间：2012-09-05T02:04:56.333
> 
> 标签：node.js, mongodb, concurrency

**我的设置：**

1.  节点.js
2.  蒙古人
3.  一个包含两个集合的简单数据库 - 库存和发票。
4.  用户可以同时创建发票。
5.  一张发票可能涉及多个库存项目。

**我的问题：**

保持库存完整性。想象一个场景，两个用户提交两张带有重叠项目集的发票。

一个天真的（和错误的）实现会执行以下操作：

1.  对于发票中的每个项目，从库存集合中读取相应的项目。
2.  固定库存物品的数量。
3.  如果任何项目数量低于零 - 放弃请求并向用户发送相关消息。
4.  保存库存项目。
5.  保存发票。

显然，这种实现方式很糟糕，因为两个用户的行为会相互交错并相互影响。在典型的阻塞服务器 + 关系数据库中，这是通过复杂的锁定/事务方案解决的。

解决这个问题的 nodish + mongoish 方法是什么？node.js 平台是否为此类事情提供了任何工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T04:02:40.403

您可以查看 MongoDB 的两阶段提交方法，或者您可以完全忘记事务并通过服务总线方法解耦您的流程。以亚马逊为例 - 他们将允许您提交订单，但在他们能够保护您的库存物品、从您的卡中扣款等之前，他们不会确认。这一切都不会发生在单笔交易中 - 这是一个可以单独发生的一系列步骤，并且可以在必要时应用补偿步骤。

一个简单的总线实现会执行以下操作（请记住，这只是一个通用的建议，供您使用，具体的实现将取决于您对并发的特定需求等）：

1.  将订单放在队列中。此时，您可以继续让您的客户等待，或者您可以感谢他们的订单，并让他们知道他们会在处理完成后收到一封电子邮件。
2.  “库存工作人员”将抓取订单并锁定需要保留的库存项目。这可以通过许多不同的方式来完成。使用 Mongo，您可以创建一个集合，其中每个 orderid 都有一个文档。该文档的 ID 是库存项目 ID 和一个合理的 TTL（比如 30 秒）。只要工人有锁，它就可以管理它有锁的物品的库存水平。一旦进行了更改，它就可以删除“锁定”文档。
3.  如果另一个工作人员出现想要在锁定时管理相同的项目，您可以将被阻止的工作人员置于睡眠模式 X 秒，然后重试，或者更好的是，您可以将请求放回消息总线上以被拾取后来由另一名工人。
4.  一旦工作人员解决了所有库存项目，它就可以在服务总线上放置另一条消息，指示应该对卡进行收费，或者处理应该收到通知以提取库存，或者可以向制作人发送电子邮件订单等

听起来很复杂，但是一旦您设置了消息总线，它实际上就相对简单了。 [可以在此处找到节点消息总线实现的列表。](https://github.com/joyent/node/wiki/modules#wiki-message-queue)

一些开发人员甚至会完全跳过正式的消息总线并使用数据库作为他们的消息传递引擎，它可以在简单的实现中工作。谷歌 Mongo 和队列。

如果您不希望超过 1 个服务器并且消息总线实现过于庞大，节点可以为您处理锁定和消息传递。例如，如果您真的想用节点锁定，您可以创建一个存储库存项目 ID 的数组。虽然，坦率地说，我认为消息总线是最好的方式。不管怎样，这里有一些我过去用来处理简单的外部资源锁定的代码。

```
// attempt to take out a lock, if the lock exists, then place the callback into the array.
this.getLock = function( id, cb ) {

        if(locks[id] ) {
            locks[id].push( cb );
            return false;
        }
        else {
            locks[id] = [];
            return true;
        }
    };

// call freelock when done
 this.freeLock = function( that, id ) {
            async.forEach(locks[id], function(item, callback) {
                item.apply( that,[id]);
                callback();
            }, function(err){
                if(err) {
                  // do something on error
                }

                locks[id] = null;

            });
        }; 
```

# c# - 如何在 WPF 的 RichTextBox 中添加表情符号

> ID：12273597
> 
> 赞同：2
> 
> 时间：2012-09-05T02:04:58.150
> 
> 标签：c#, wpf

> **可能重复：**
> [如何将表情符号（笑脸）添加到 WPF 富文本框中](https://stackoverflow.com/questions/3674733/how-to-add-emoticonssmileys-into-wpf-richtext-box)

现在，我想知道，如何在 WPF 的 RichTextBox 中添加表情。例如：当我输入 hi :) 时，它将在 RichTexBox 中返回为图像（微笑图像）。我希望，你会帮助我。如果有人知道解决方案或示例代码

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:27:31.920

对此没有预构建的解决方案，但是，当您使用 WPF 时，您可以通过 TextChanged 事件或通过您的 PropertyChanged（如果它是 MVVM）对 RichTextBox 内的文本更改做出反应。

一旦你知道文本发生了变化，你就可以通过简单的搜索给它通过（有更好的方法来做这个解析，但为了一个简单的例子，只需使用简单的字符串搜索）。如果你找到你想要的文本，我的意思是，与你的笑脸相对应的标记，`hi :)`那么你可以通过在 RichTextBox 中使用 FlowDocument 将图像插入该位置

**解析前**

```
 <RichTextBox>
    <FlowDocument>
     <Paragraph>
      <Run>Hello :) world!</Run>
     </Paragraph>
    </FlowDocument>
 </RichTextBox> 
```

**解析后**

```
<RichTextBox>
    <FlowDocument>
     <Paragraph>
      <Span>
         <Run Text="Hello"/>
         <Image Width="16" Source="Your emoticon source"/>
         <Run Text=" world"/>
       </Span>
     </Paragraph>
    </FlowDocument>
 </RichTextBox> 
```

这应该让你知道如何开始。

# c++ - 结果向量上的错误

> ID：12273598
> 
> 赞同：0
> 
> 时间：2012-09-05T02:05:02.377
> 
> 标签：c++, cuda

我的问题是，当我进行乘法运算时，它仅将矩阵的第一行与向量的第一个元素相乘，而下一个元素使它们为零，因此结果向量给出了错误的结果。

```
using namespace std;
#define N 100
#define F 3
#define X 7
__global__ void matvec(int *MAT, int *VEC, int *SOL) {
  int bx = blockIdx.x;
  int tx = threadIdx.x;
  int i = 32*bx+tx;
  for (int j = 0; j < X; j++) {
    SOL[i] = ((MAT[i * X + j] * VEC[j]) +SOL[i]) % 2;
  }
}
int main () {
int i, j;
int MAT[N][N], VEC[N], SOL[N];
int *MAT_dev, *VEC_dev, *SOL_dev;
size_t nBytes = X * X * sizeof(int);

cout << "\t- - - - - MATRIX - - - - -\n\n";
for (i = 0; i < X; i++) {
  for (j = 0; j < X; j++) {
      cout << "Element [" << i << "][" << j << "]: ";
      cin >> MAT[i][j];
  }
 }
cout << endl << endl;
for (i = 0; i < X; i++) {
  for (j = 0; j < X; j++) {
    cout << MAT[i][j] << " ";
    if (j == (X - 1))
        cout << endl;
  }
 }
cout << endl << endl;
cout << "\t- - - - - VECTOR - - - - -\n\n";
for (i = 0; i < X; i++) {
  cout << "Element [" << i << "]: ";
  cin >> VEC[i];
}
cout << endl << endl;
for (i = 0; i < X; i++) {
  cout << VEC[i] << " ";
}
cout << endl << endl;

cudaMalloc((void**)&MAT_dev, nBytes);
cudaMalloc((void**)&VEC_dev, nBytes);
cudaMalloc((void**)&SOL_dev, nBytes);

cudaMemcpy(MAT_dev, MAT, nBytes, cudaMemcpyHostToDevice);
cudaMemcpy(VEC_dev, VEC, nBytes, cudaMemcpyHostToDevice);

dim3 dimBlock(X,X);
dim3 dimGrid(1,1);

matvec<<<dimGrid,dimBlock>>>(MAT_dev, VEC_dev, SOL_dev);

cudaMemcpy(SOL, SOL_dev, nBytes, cudaMemcpyDeviceToHost);

cout << "\t- - - - - RESULT - - - - -\n\n";
for (i = 0; i < X; i++)
{
  cout << SOL[i] << " ";
}
cout << endl << endl;

cudaFree(MAT_dev);
cudaFree(VEC_dev);
cudaFree(SOL_dev);

system("PAUSE");
return 0;
} 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:30:35.187

这是因为 的大小`MAT`远大于应有的大小。基本上你需要`N == X`，这不应该是一个问题，因为两者在编译时都是已知的。2D 数组的内存布置在一个连续的块中，C 的主要行 - 所以在你的情况下，第一行对应于前 400 ( `sizeof(int)*N`) 个字节，第二行对应于第二个 400，等等。 row 被称为'stride' 但是，`cudaMemcpy`不知道stride 是什么或`MAT`已经填充了哪些元素，它只是将第一个`nBytes`字节从`MAT`into复制`MAT_DEV`。因为`nBytes`is `sizeof(int)*X*X`and `X`== 7 <<`N`你的矩阵的第二行和后续行永远不会被复制。只有前 196 个字节`MAT`被复制，解释为什么你的第二行都是零。

# sql - MS Access 中的左连接

> ID：12273602
> 
> 赞同：4
> 
> 时间：2012-09-05T02:06:01.313
> 
> 标签：sql, ms-access, join, left-join

我正在尝试解决其他人的 MS Access 查询并不断收到无效操作错误。帮助似乎不适用，因为我只是在运行查询。一切正常，`INNER JOINS`但是当我切换回`LEFT JOIN`错误时。

* * *

```
SELECT *
 FROM ((((orders 
 INNER JOIN orders_customers ON orders.CUST_ORDER_ID = orders_customers.ID) 
 LEFT JOIN quoted_theory ON orders.PART_ID = quoted_theory.PART_ID) 
 LEFT JOIN conversions ON orders.PART_ID = conversions.PART_ID) 
 LEFT JOIN dbo_WO_Header ON orders.CUST_ORDER_ID = dbo_WO_Header.PPC_Number) 
 INNER JOIN lines_qry ON orders.CUST_ORDER_ID = lines_qry.WORKORDER_BASE_ID 
```

* * *

我可以得到一个级别`LEFT JOIN`，但每次我添加一秒`LEFT JOIN`时都会弹出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:24:52.160

混合 INNER 和 LEFT 联接时，Access' db 引擎经常停止。如果该查询在没有最后一个内部连接的情况下工作......

```
SELECT *
FROM
    (((orders INNER JOIN orders_customers
    ON orders.CUST_ORDER_ID = orders_customers.ID)
    LEFT JOIN quoted_theory
    ON orders.PART_ID = quoted_theory.PART_ID)
    LEFT JOIN conversions
    ON orders.PART_ID = conversions.PART_ID)
    LEFT JOIN dbo_WO_Header
    ON orders.CUST_ORDER_ID = dbo_WO_Header.PPC_Number 
```

...然后您可以尝试将该部分作为子查询和子查询的内部连接`lines_qry`。它可能会克服错误。

```
SELECT *
FROM
    (
        SELECT *
        FROM
            (((orders INNER JOIN orders_customers
            ON orders.CUST_ORDER_ID = orders_customers.ID)
            LEFT JOIN quoted_theory
            ON orders.PART_ID = quoted_theory.PART_ID)
            LEFT JOIN conversions
            ON orders.PART_ID = conversions.PART_ID)
            LEFT JOIN dbo_WO_Header
            ON orders.CUST_ORDER_ID = dbo_WO_Header.PPC_Number
    ) AS sub
    INNER JOIN lines_qry
    ON sub.CUST_ORDER_ID = lines_qry.WORKORDER_BASE_ID 
```

如果任何其他表除了`orders`包含一个名为 的字段`CUST_ORDER_ID`，您将需要`SELECT *`在子查询中以外的其他内容以避免歧义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T15:44:00.823

```
SELECT *
FROM
    (
        SELECT *
        FROM
            (((orders INNER JOIN orders_customers
            ON orders.CUST_ORDER_ID = orders_customers.ID)
            LEFT JOIN quoted_theory
            ON orders.PART_ID = quoted_theory.PART_ID)
            LEFT JOIN conversions
            ON orders.PART_ID = conversions.PART_ID)
            LEFT JOIN dbo_WO_Header
            ON orders.CUST_ORDER_ID = dbo_WO_Header.PPC_Number
    ) AS sub
    INNER JOIN lines_qry
    ON sub.CUST_ORDER_ID = lines_qry.WORKORDER_BASE_ID 
```

# grep - python中的egrep

> ID：12273605
> 
> 赞同：0
> 
> 时间：2012-09-05T02:06:45.903
> 
> 标签：grep

所以感谢这个论坛，我目前有这段代码，它从我拥有的程序中获取输出并将其保存在一个文件中：

```
#!usr/bin/python
import os

os.chdir('./P574/J0998-1034')
os.system('vap -c freq *.SFTC > 1400list.txt') 
```

我想添加一个过滤器（所以只取包含“1369.000”的行，所以我将最后一行修改为：

```
os.system('vap -c freq *.SFTC | egrep 1369.000 > 1400listfilt.txt') 
```

但我真的希望它包含包含“1369.000”或“1433.000”的行。我试过了：

```
os.system('vap -c freq *.SFTC | egrep 1369.000|1433.000 > 1400listfilt.txt' ) 
```

但我收到错误消息：“sh: 1433.000: command not found egrep: write error: Broken pipe”

我怎样才能让它检查两个值？另外..这是做我想做的最好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:11:29.717

我会用单引号将参数括起来，如下所示：

```
egrep '(1369.000|1433.000)' 
```

shell 告诉您它无法将输出重定向到不存在`egrep`的程序。`1433.000`

# spring - Spring RestTemplate postForObject 的大小是否有限制？

> ID：12273607
> 
> 赞同：1
> 
> 时间：2012-09-05T02:06:47.620
> 
> 标签：spring, resttemplate

例如，如果帖子网址是：

> [http://www.wolf.com/pcap/search?stime=](http://www.wolf.com/pcap/search?stime=) {stime}&etime=${etime}&bpf=${bpf}

那么我们可以这样做：

```
Map<String, String> vars = new HashMap<String, String>();
vars.put("bpf", bpf);

...
responseString = restTemplate.postForObject(url, null, String.class,vars); 
```

如果 bpf 是 String，那么 bpf 的大小是否有限制？可以是任意大小吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:05:22.770

Unfortunately the answer is: "It depends".

More precisely: as you append the `bpf` as a parameter to the URL it does not really matter if you are doing a POST or a GET. Sometimes there are restrictions on the length of an URL a server will handle, but that depends on what the server accepts, and cannot be determined from the RestTemplate, which is the client.

For example if the server you send the REST request to is a tomcat, then the maximal value of the complete header (URL, HTTP-Header etc) is by default 8kB for tomcat 6.0 or higher; see e.g. [https://serverfault.com/questions/56691/whats-the-maximum-url-length-in-tomcat](https://serverfault.com/questions/56691/whats-the-maximum-url-length-in-tomcat)

Just in case if you have control over the server side, too, you can change the expected interface by not sending the `bpf` as parameter, but as request body, like:

```
Map<String, String> vars = new HashMap<String, String>();
// vars.put("bpf", bpf); <--- not needed
responseString = restTemplate.postForObject(url, bpf, String.class, vars); 
```

(and then of course get the `bpf` on the server from the request body instead).

Otherwise you are out of luck and have to limit the length of the URL. Maybe use a proxy or network sniffer to see what extra Headers are actually send and subtract that from the 8kB limit to get the maximal length of the URL.

# ruby-on-rails - 为什么我的 rgeo / postgis 距离离现实如此之远？

> ID：12273612
> 
> 赞同：0
> 
> 时间：2012-09-05T02:07:06.520
> 
> 标签：ruby-on-rails, postgis

我正在尝试获取给定的帖子记录的英里数...

```
 class Post < ActiveRecord::Base
      attr_accessor :lat, :lng
      set_rgeo_factory_for_column(:location, RGeo::Geographic.spherical_factory(:srid => 4326))

      def distance_from(current_location)
        rgeo_factory.point(current_location[:lng], current_location[:lat]).distance(location) / 1.60934
      end 

    private

      def update_location!
        self.location = rgeo_factory.point(lng, lat) if lat && lng
      end

      def rgeo_factory
        Post.rgeo_factory_for_column(:location)
      end 

    end 
```

如果我创建一个位置为内华达州拉斯维加斯（纬度：36.255123，lng：-115.238348）的帖子，并且我验证了它——

```
1.9.3p125 :018 > p.lat = 36.255123
 => 36.255123 
1.9.3p125 :019 > p.lng = -115.238348
 => -115.238348
1.9.3p125 :019 > p    
#<Post id: 133, location: #<RGeo::Geographic::SphericalPointImpl:0x81d7130c "POINT (-115.238348 36.255123)"> 
```

当我试图获得那个职位和加利福尼亚某个地点之间的距离时，我得到了一个疯狂的英里数......

```
1.9.3p125 :027 > p.distance_from(:lat => 34.019454, :lng => -118.491191)
=> 240327.390598477 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T05:28:59.750

你确定距离（）返回公里吗？您转换为里程似乎是这样认为的。PostGIS 本机距离以米为单位返回。是否有可能正确的英里数约为 240？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-05T19:26:51.613

RGeo 球形工厂确实以米为单位返回距离结果。大多数坐标系以米为单位（或其一些失真）。如果你想要里程，你可以乘以一个转换因子（大约 0.000621371）。

# objective-c - 无像素化的 CAEmittercell 放大

> ID：12273620
> 
> 赞同：1
> 
> 时间：2012-09-05T02:09:09.870
> 
> 标签：objective-c, ios

当我使用 CAEmittercell 时，如果我要求一个比例因子，内容图像将在逐渐缩放时被像素化。有没有办法可以避免这种情况，即在出生时显示较小的图像，然后让它增长到实际大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:56:04.360

将该`scale`属性设置为一个较小的值（小于 1）应该使单元格在生成时以该比例显示。您可以使用该`scaleSpeed`属性将它们放大到更大的尺寸；只要生成的比例在单元格的生命周期内不超过 1，您就不会看到像素化。

# sql-server - 使用 Filestream 创建数据库时出错

> ID：12273626
> 
> 赞同：2
> 
> 时间：2012-09-05T02:09:36.987
> 
> 标签：sql-server, sql-server-2008, filestream, sql-server-2012

我正在使用 sql server 2012 express 在 Windows 7 操作系统上执行以下 sql。

```
CREATE DATABASE Archive 
ON
PRIMARY ( 
    NAME = Arch1,
    FILENAME = 'c:\data\archdat1.mdf'),
FILEGROUP FileStreamGroup1 CONTAINS FILESTREAM
( 
    NAME = Arch3,
    FILENAME = 'c:\data\filestream1')
LOG ON  ( NAME = Archlog1,
    FILENAME = 'c:\data\archlog1.ldf')
GO 
```

我收到此错误：

消息 5120，级别 16，状态 106，第 1 行无法打开物理文件“c:\data\filestream1”。操作系统错误 259：“259（没有更多数据可用。）”。

这是我来这里之前所做的：

*   启用服务以允许来自“sql server configuration manager”的文件流。
*   启用实例以允许文件流。
*   将 'c:\data\' 文件夹完全控制给运行 sql server 服务的“NT Service\MSSQL$SQLEXPRESS2012”帐户

在这一点上，我完全不知所措，任何帮助将不胜感激。

**更新 1**

我正在新的 Windows 7 安装上安装 sql server express，看看这是否能解决任何问题。

**更新 2**

尝试在安装了 sql server 2008 的 windows xp 机器上运行相同的 sql 并收到此错误：

无法打开物理文件“c:\data\filestream1”。操作系统错误 -2147024891：“0x80070005（访问被拒绝。）”。

**更新 3**

在干净的 Windows 7 机器上安装给了我完全相同的错误：

消息 5120，级别 16，状态 106，第 1 行无法打开物理文件“c:\data\filestream1”。操作系统错误 259：“259（没有更多数据可用。）”。

**更新 4**

通过将“登录为”更改为本地系统，我能够使其在 windows xp 框中工作。

**更新 5**

我尝试在 Windows 7 框中执行相同的操作（将“登录身份”更改为本地系统），但仍然出现相同的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T21:57:00.857

我解决了这个问题。原来是我们的内部磁盘加密软件导致了这个错误。禁用该软件是不够的。它必须被完全删除。

# java - JSOUP 只返回一些 div 标签

> ID：12273630
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:10:39.483
> 
> 标签：java, html, parsing, jsoup, htmlunit

我正在尝试使用 JSOUP 从该 URL 获取所有带有类的 div 标签。我想列出每种产品的所有名称和价格。具体来说，我正在寻找具有 class="item-name" 和 class="item-price" 的 div 标签。

```
public static void main(String[] args) throws IOException {

        Document doc = Jsoup.connect("http://www.games-workshop.com/gws/catalog/listProducts.jsp?catId=cat440176a").get();

        Elements content = doc.select("div[class]");

        for(Element src : content) {

                System.out.println(src.text());

        }

} 
```

当我运行此代码时，它不会返回所有带有类属性的 div 标签，它只返回页面顶部的一些标签和页面底部的一些标签。我假设这与他们处理网页的方式有关，因为我得到了一些 div 标签。我希望有人能够解释为什么我只得到一些 div 标签。

* * *

**编辑**

好的，在查看了其他人的 html 页面不一致的其他文章后，我决定尝试一种新方法。在我看来，这与生成我正在寻找的 html 的脚本有关。目前我正在尝试让 htmlUnit 生成页面，然后我想使用 JSOUP 来解析它。

```
public static void main(String[] args) throws IOException {
                    WebClient webClient = new WebClient();
        webClient.setCssEnabled(true);
        webClient.setAppletEnabled(true);
        webClient.setJavaScriptEnabled(true);
        webClient.setTimeout(7000);
        WebRequest request = new WebRequest(new URL("http://www.games-workshop.com/gws/catalog/listProducts.jsp?catId=cat440176a"));
        Page page = webClient.getPage(request);
                    String webpage = page.getWebResponse().getContentAsString();

                    System.out.println(webpage);
}

} 
```

当我运行这段代码时，我得到了很多红色错误。以下是错误[http://pastebin.com/LHr7R7U1](http://pastebin.com/LHr7R7U1)。我希望有人可以帮助我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T04:56:15.523

我发现在我的示例中没有呈现 javascript。我还没有找到渲染javascript的方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-16T16:05:20.197

尝试`WebClient webClient = new WebClient(BrowserVersion.FIREFOX_10);`

# sql - 仅查找并显示 sql 中相同的值

> ID：12273633
> 
> 赞同：3
> 
> 时间：2012-09-05T02:11:42.130
> 
> 标签：sql

我正在根据游泳事件进行查询。有独特的事件代码，以及独特的游泳者代码，以及它们的位置。我目前有一个问题，因为我只想显示在同一事件中并列的游泳者（例如，我只想显示在 100 米接力赛中并列的游泳者）。

是否有一些语法可以做到这一点？

我正在做类似的事情

```
SELECT Swimmers, Eventid, Place
FROM Results
WHERE Place=Place
AND Eventid=Eventid 
```

但这甚至包括没有打领带的游泳运动员。

任何建议都会很棒

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:16:23.397

尝试这个，

```
SELECT Swimmers, 
       Eventid, 
       Place
FROM  Results a INNER JOIN
        (
            SELECT EventID, Place ,COUNT(Place) totalPlace
            FROM Results
            GROUP BY EventID, Place
            HAVING COUNT(Place) > 1
        ) b ON a.eventID = b.EventID AND
                a.Place = b.Place
-- WHERE -- add extra conditions here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:16:46.257

你可以做这样的事情

```
 SELECT Swimmers, EventId, Place
    FROM Results r JOIN
      (SELECT EventId, Place
       FROM Results
       GROUP BY EventId, Place
       HAVING COUNT(*) > 1) t ON (r.EventId = t.EventId AND r.Place = t.Place) 
```

# ruby-on-rails - 有 n，属于 Sinatra 和 DataMapper

> ID：12273634
> 
> 赞同：2
> 
> 时间：2012-09-05T02:12:30.637
> 
> 标签：ruby-on-rails, ruby, sinatra, datamapper

在 O'Reilly 书籍的帮助下，我正在使用 Sinatra 和 DataMapper 构建一个 url 缩短服务的克隆。当我通过提交用于缩短的 url 对其进行测试时，出现此错误

```
NoMethodError - undefined method `visits' for nil:NilClass: 
```

对于第 31 行。似乎 Link 类没有访问属性，但是，正如您从下面的类定义中看到的那样，这种关系是我应该能够调用的`link.visits`

我正在使用最新版本的 DataMapper。任何人都可以建议解决这个问题吗？

```
get '/:short_url' do 
  link = Link.first(:identifier => params[:short_url])
  link.visits << Visit.create(:ip => get_remote_ip(env))   #this is line 32
  link.save
  redirect link.url.original, 301
end 
```

**课程**

```
Class Url
  include DataMapper::Resource
  property  :id,          Serial
  property  :original,    String, :length => 255   
  belongs_to  :link
end

class Link
  include DataMapper::Resource
  property  :identifier,  String, :key => true
  property  :created_at,  DateTime 
  has 1, :url
  has n, :visits

class Visit
  include DataMapper::Resource

  property  :id,          Serial
  property  :created_at,  DateTime
  property  :ip,          IPAddress
  property  :country,     String
  belongs_to  :link

  after :create, :set_country 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T17:49:26.907

创建新访问的更好方法：

```
link.visits.new(:ip => get_remote_ip(env))
link.save 
```

或者：

```
Visit.create(:ip => get_remote_ip(env), :visit => visit) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:40:15.260

我相信这是您的问题所在：

```
link = Link.first(:identifier => params[:short_url]) 
```

我打赌`link`是`nil`

当您收到类似的错误时

```
NoMethodError - undefined method `visits' for nil:NilClass: 
```

这是说您试图调用`visits`对象上的方法`nil`。您期望`visits`在`Link`对象上调用该方法。

如果要查找记录（如果存在）或创建新记录，请尝试以下操作：

```
Link.first_or_create(:identifier => params[:short_url]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T02:43:52.883

问题不在于 Link 没有访问属性。问题是你的线路

```
Link.first(:identifier => params[:short_url]) 
```

返回零。

所以它没有找到任何与您的搜索匹配的记录。

为了证明这一点，尝试做

```
link = Link.get(1) 
```

你应该找到一个结果。

# ios - 不能让 AVFoundation 有正确的方向

> ID：12273635
> 
> 赞同：1
> 
> 时间：2012-09-05T02:12:30.940
> 
> 标签：ios, uiimage, avfoundation

在拉了这么多头发想弄清楚这件事后，我几乎秃顶了。我正在尝试使用 avFoundation 拍摄照片，但方向几乎总是一团糟。我的 ViewWillAppear 中有以下函数来捕获设备方向：

```
- (void)deviceOrientationDidChange { 
  UIDeviceOrientation deviceOrientation = [[UIDevice currentDevice] orientation];

  if (deviceOrientation == UIDeviceOrientationPortrait)
    orientation = AVCaptureVideoOrientationPortrait;
  else if (deviceOrientation == UIDeviceOrientationPortraitUpsideDown)
    orientation = AVCaptureVideoOrientationPortraitUpsideDown;
  // AVCapture and UIDevice have opposite meanings for landscape left and right (AVCapture orientation is the same as UIInterfaceOrientation)
  else if (deviceOrientation == UIDeviceOrientationLandscapeLeft)
    orientation = AVCaptureVideoOrientationLandscapeRight;
  else if (deviceOrientation == UIDeviceOrientationLandscapeRight)
    orientation = AVCaptureVideoOrientationLandscapeLeft;

// Ignore device orientations for which there is no corresponding still image orientation (e.g. UIDeviceOrientationFaceUp)
} 
```

此代码似乎工作正常并捕获了正确的方向。然后我运行以下代码来生成图像：

```
 [myConnection setVideoOrientation:self.orientation];
    //THIS IS THE CORRECT ORIENTATION
    NSLog(@"ORIENTATION %d",myConnection.videoOrientation);

[self.stillOutput captureStillImageAsynchronouslyFromConnection:myConnection completionHandler:^(CMSampleBufferRef imageSampleBuffer, NSError *error)
 {
         if (imageSampleBuffer != nil) {
         NSData *jpeg = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageSampleBuffer]; //jpeg image in binary format

         UIImage *image = [[UIImage alloc] initWithData:jpeg];

         NSLog(@"IMAGE ORIENTATION: %d", image.imageOrientation);

         postProcessingBlock(image, mutable);

         [mutable release];
         [image release];
     }
     else {
         NSLog(@"AVCapture ERROR:%@", [error localizedDescription]);
     }
 }]; 
```

当我使用后置摄像头（按下按钮）以纵向模式拍照时，我的日志显示：

```
ORIENTATION 1
IMAGE ORIENTATION 3 
```

我究竟做错了什么？为什么它向我显示错误的方向？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-15T18:12:43.960

不知道你是否明白这一点，但你没有做错任何事。需要注意的是，`AVCaptureVideoOrientation`实际上`UIImageOrientation`是指不同的方向！

`UIImageOrientationUp`实际上是指横向模式下的设备，音量控件指向地面。`UIImageOrientationLeft`电源按钮指向天空的人像照片的正确方向也是如此。

# android - 检查 android sqlite 和 IntelliJ

> ID：12273638
> 
> 赞同：7
> 
> 时间：2012-09-05T02:13:08.170
> 
> 标签：android, sqlite, intellij-idea, adb

我从一个使用以编程方式创建的 sqlite db 的小应用程序开始。当应用程序在模拟器上运行时，有没有办法检查该数据库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T02:28:14.340

您可以将数据库文件从设备下载到您的 PC，然后使用任何 SQLite 浏览器/工具来检查数据库。

通过`adb`Android SDK 工具中的命令行工具

```
adb pull /data/data/your.app.package.here/databases/yourdatabasefile.db 
```

或通过 Eclipse 中的设备浏览器（文件资源管理器）在 DDMS 透视图中（也许 IntelliJ 中也存在，Idk）

或者新的 Android SDK 工具通过新的设备监视器工具`android-sdk/tools/monitor.bat`（

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-14T16:24:37.797

IntelliJ IDEA 14 现在可以做到这一点：

[https://www.jetbrains.com/idea/help/accessing-android-sqlite-databases-from-intellij-idea.html](https://www.jetbrains.com/idea/help/accessing-android-sqlite-databases-from-intellij-idea.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-06T20:38:15.897

一位合作伙伴找到了一个更动态的解决方案，使用 ADB 插件，您可以简单地选择数据库并随时刷新检查器

首先，你需要下载插件 jar [https://github.com/tklerx/android-sqlite-browser-for-eclipse](https://github.com/tklerx/android-sqlite-browser-for-eclipse) （去releases并选择最新的）

然后将 jar 放入 [YourAndroidSdkDirectory]/tools/lib/monitor-x86_64/plugins/

重启亚行

完毕！现在运行一个模拟器，创建您的数据库并在 ADB 中浏览以在 data/data/ 上找到它...选择它并单击右上角的新建数据库按钮（在选择数据库文件之前您可能看不到该按钮）

[![预览](../Images/cab840cda9d3744f94d33708279c371a.png)](https://i.stack.imgur.com/3peR6.png)

来源：[https ://groups.google.com/forum/#!msg/adt-dev/Jqw9VslC_Vw/YOXWQa1ozmAJ](https://groups.google.com/forum/#!msg/adt-dev/Jqw9VslC_Vw/YOXWQa1ozmAJ)

# sql-server - 无法连接到我们数据库中的成员资格表

> ID：12273642
> 
> 赞同：0
> 
> 时间：2012-09-05T02:14:03.280
> 
> 标签：sql-server, configuration, asp.net-membership, website-admin-tool

我们使用 aspnet_regsql.exe 工具将成员表添加到我们现有的数据库中，并将以下 LocalSqlServer 行添加到我们的 Web.config 文件中：

```
<clear/>

<add name="Dorknozzle"
     connectionString="Server=OUR-PC;Database=Dorknozzle;Integrated Security=True"
     providerName="System.Data.SqlClient" />

<add name="LocalSqlServer"
    connectionString="Server=OUR-PC;Database=Dorknozzle;Integrated Security=True"
    providerName="System.Data.SqlClient" /> 
```

当我们单击网站管理工具的安全选项卡时，我们会收到以下错误：

```
There is a problem with your selected data store. 
```

服务器和数据库名称是正确的，因为 Web 表单确实显示来自 Dorknozzle 数据库的数据，并且我确保成员资格表驻留在 Dorknozzle 数据库中。

我们还单击了 Provider 选项卡，但只能在我们期望看到 Dorknozzle 时看到 AspNetSqlProvider。

你能告诉我让网站管理工具连接到 dorknozzle 中的数据存储我们缺少什么吗？

更新：感谢 Jon 指导我们解决这个问题。我在 Web.config 文件的 system.web 部分添加了以下代码，现在我们可以在网站管理工具的安全选项卡中看到信息：

```
<membership>
  <providers>
    <clear />
    <add name="AspNetSqlMembershipProvider" 
         type="System.Web.Security.SqlMembershipProvider"
         connectionStringName="Dorknozzle" 
         enablePasswordRetrieval="false" 
         enablePasswordReset="true"
         requiresQuestionAndAnswer="false" 
         requiresUniqueEmail="false" 
         maxInvalidPasswordAttempts="5"
         minRequiredPasswordLength="6" 
         minRequiredNonalphanumericCharacters="0" 
         passwordAttemptWindow="10" 
         applicationName="/" />
  </providers>
</membership> 
```

# iphone - 如何像在 iOS 中一样制作清晰的按钮

> ID：12273645
> 
> 赞同：2
> 
> 时间：2012-09-05T02:14:37.290
> 
> 标签：iphone, ios, uibutton, uikeyboard

我正在做一个自己的数字键盘。我想像在 iphone 中一样在文本字段上添加清除按钮。我怎样才能做到这一点 ？

我想要这张图片中的清除按钮：

![清除按钮](../Images/46ff6afbf0d33236f19654b46fa29e40.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T02:16:59.270

如果您在代码中创建字段，您可以使用：

```
[textField setClearButtonMode:UITextFieldViewModeWhileEditing]; 
```

选项是

1.  `UITextFieldViewModeWhileEditing`
2.  `UITextFieldViewModeUnlessEditing`
3.  `UITextFieldViewModeAlways`
4.  `UITextFieldViewModeNever`

或者，如果您使用的是界面生成器：

![在此处输入图像描述](../Images/74bfad1027810458685470c6928c66d5.png)

# python - Python过滤器脚本

> ID：12273649
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:15:20.860
> 
> 标签：python, linux

在我的 ftp 服务器中包含一个日志文件记录所有下载记录，我想使用 Python 获取此文件并输出一个包含最近一周或 7 天记录的简化文件。/CliMb/xxx 中的 .. 等日志文件。

```
Sat Jun  2 03:32:13 2012 [pid 12461] CONNECT: Client "66.249.68.236"
Sat Jun  2 03:32:13 2012 [pid 12460] [ftp] OK LOGIN: Client "66.249.68.236", anon     password "gxxglxxxxt@google.com"
Sat Jun  2 03:32:14 2012 [pid 12462] [ftp] OK DOWNLOAD: Client "66.249.68.236",   "/pub/10.5524/100001_101000/100022/readme.txt", 451 bytes, 1.39Kbyte/sec
Sat Jun  2 03:32:22 2012 [pid 12677] CONNECT: Client "66.249.68.236"
Sat Jun  2 03:32:23 2012 [pid 12676] [ftp] OK LOGIN: Client "66.249.68.236", anon password "xxxxxbot@google.com"
Sat Jun  2 03:35:27 2012 [pid 12706] [ftp] FAIL DOWNLOAD: Client "66.2 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:40:32.483

```
import time
lines = []
with open("somelog.txt") as f:
      lines = [line for line in f]
def OnlyRecent(line):
      return time.strptime(line.split("[")[0].strip(),"%a %b %d %h:%m:%s %Y") < (time.time()-(60*60*24*5)) #5 days old
print "\n".join(filter(OnlyRecent,lines)) 
```

至少是这样的……

# python - Python - 在涉及多重继承时调用祖先方法

> ID：12273651
> 
> 赞同：0
> 
> 时间：2012-09-05T02:15:28.060
> 
> 标签：python, inheritance, multiple-inheritance

编辑：我正在使用 Python 3（有人问）。

我认为这只是一个语法问题，但我想确保我没有遗漏任何东西。请注意 Foo 和 Bar 如何实现的语法差异。他们实现了同样的目标，我想确保他们真的在做同样的事情。输出表明只有两种方法可以做同样的事情。是这样吗？

代码：

```
class X:

    def some_method(self):
        print("X.some_method called")

class Y:

    def some_method(self):
        print("Y.some_method called")

class Foo(X,Y):

    def some_method(self):
        X().some_method()
        Y().some_method()
        print("Foo.some_method called")

class Bar(X,Y):

    def some_method(self):
        X.some_method(self)
        Y.some_method(self)
        print("Bar.some_method called")

print("=== Fun with Foo ===")
foo_instance = Foo()
foo_instance.some_method()

print("=== Fun with Bar ===")
bar_instance = Bar()
bar_instance.some_method() 
```

输出：

```
=== Fun with Foo ===
X.some_method called
Y.some_method called
Foo.some_method called
=== Fun with Bar ===
X.some_method called
Y.some_method called
Bar.some_method called 
```

PS - 希望这是不言而喻的，但这只是一个抽象的例子，让我们不要担心*为什么*我想在**两个**祖先上调用 some_method，我只是想在这里理解语言的语法和机制。谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:26:01.017

1.  您应该使用新型类。如果这是 Python 3，那么您就是；如果您使用的是 Python 2，您应该继承自`object`（或其他一些新样式的类）。
2.  调用祖先方法的常用方法是使用`super`. 在标准文档中阅读它，以及其他关于它如何运作的优秀文章。永远不建议以您正在执行的方式调用方法，因为（a）面对进一步的继承，它会变得脆弱；(b) 通过硬编码对类的引用来增加维护工作量。

更新：这是一个示例，展示了如何使用它`super`来实现这一点：http: [//ideone.com/u3si2](http://ideone.com/u3si2)

另请参阅：[http ://rhettinger.wordpress.com/2011/05/26/super-considered-super/](http://rhettinger.wordpress.com/2011/05/26/super-considered-super/)

更新 2：这是一个用于 python 2 的小库，它为每个方法添加了一个`__class__`变量和一个无参数`super`，以避免对当前名称进行硬编码：[https ://github.com/marcintustin/superfixer](https://github.com/marcintustin/superfixer)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T02:17:47.123

他们不一样。 `X()`创建一个类的对象`X`。当您`X().someMethod()`创建一个新对象时，然后在该对象上调用该方法，而不是在`self`. `X.someMethod(self)`是你想要的，因为它调用了同一个对象上的继承方法。

如果您的方法实际上对`self`对象做了任何事情，您将看到差异。例如，如果你放入`self.blah = 8`你的方法，那么在`X.someMethod(self)`你调用它的对象之后将`blah`设置属性，但在`X().someMethod()`它之后不会。（相反，您将创建一个新对象，`blah`对其进行设置，然后在不使用它的情况下丢弃该新对象，使原始对象保持不变。）

这是一个修改代码的简单示例：

```
>>> class X:
... 
...     def some_method(self):
...         print("X.some_method called on", self)
... 
... class Y:
... 
...     def some_method(self):
...         print("Y.some_method called on", self)
... 
... class Foo(X,Y):
... 
...     def some_method(self):
...         X().some_method()
...         Y().some_method()
...         print("Foo.some_method called on", self)
... 
... class Bar(X,Y):
... 
...     def some_method(self):
...         X.some_method(self)
...         Y.some_method(self)
...         print("Bar.some_method called on", self)
>>> Foo().some_method()
('X.some_method called on', <__main__.X instance at 0x0142F3C8>)
('Y.some_method called on', <__main__.Y instance at 0x0142F3C8>)
('Foo.some_method called on', <__main__.Foo instance at 0x0142F3A0>)
>>> Bar().some_method()
('X.some_method called on', <__main__.Bar instance at 0x0142F3C8>)
('Y.some_method called on', <__main__.Bar instance at 0x0142F3C8>)
('Bar.some_method called on', <__main__.Bar instance at 0x0142F3C8>) 
```

请注意，当我使用 时`Foo`，打印的对象是不一样的；一个是 X 实例，一个是 Y 实例，最后一个是我调用该方法的原始 Foo 实例。使用时`Bar`，在每个方法调用中都是同一个对象。

（在某些情况下，您也可以使用来避免`super`显式命名基类；例如，`super(Foo, self).someMethod()`或者在 Python 3 中只是通常针对每个方法只调用一次的情况，将控制权传递给继承链中方法的下一个版本，然后将其传递给下一个版本，等等）`super().someMethod()``super``super`

# javascript - 从javascript中的对象方法返回一个对象

> ID：12273655
> 
> 赞同：0
> 
> 时间：2012-09-05T02:16:05.420
> 
> 标签：javascript

```
A = {
    f1: function() {
        return {
            a: function(){ alert('sss'); }
        }
    }
}

A.f1().a(); 
```

为什么以这种方式使用它？

为什么方法`a()`绑定到 A.f1()？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:29:15.450

`f1`的成员函数`A`返回一个对象字面量，其成员`a`设置为一个函数。它也可以写成：

```
A = {
   f1: {
        a: function() { alert('sss'); }
    }
}

A.f1.a(); 
```

在这种情况下，返回对象可能是个人喜好。这两个示例在功能上没有区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:54:24.710

当您执行以下操作时：

```
var x = A.f1(); 
```

你得到的 x 是 f1 函数返回的对象。这是：

```
{
   a: function(){ alert('sss'); }
} 
```

现在对象'x'上面有函数a()。您可以将该函数称为：

```
x.a(); 
```

这与以下内容非常相似：

```
A.f1().a(); 
```

# ruby - 在 Mac 上运行 64 位 dylib 和 32 位 ruby

> ID：12273662
> 
> 赞同：0
> 
> 时间：2012-09-05T02:16:23.347
> 
> 标签：ruby, 64-bit, 32bit-64bit, dynamic-library, ruby-llvm

我试图安装[ruby​​-llvm](https://github.com/jvoorhis/ruby-llvm)。

我可以用 llvm 安装`brew install llvm -shared`，也可以`ruby-llvm`用`sudo gem install ruby-llvm`命令安装。

但是，当我尝试运行[示例](https://github.com/jvoorhis/ruby-llvm/samples)时，我收到了这些错误消息。

```
/Users/smcho/.rvm/gems/ruby-1.9.3-p194/gems/ffi-1.1.5/lib/ffi/library.rb:121:in `block in ffi_lib': 
Could not open library '/DIR/.rvm/gems/ruby-1.9.3-p194/gems/ruby-llvm-3.0.0/lib/libRubyLLVMSupport-3.0.0.dylib': 
dlopen(/DIR/.rvm/gems/ruby-1.9.3-p194/gems/ruby-llvm-3.0.0/lib/libRubyLLVMSupport-3.0.0.dylib, 5): no suitable image found.  Did find: (LoadError)
/DIR/.rvm/gems/ruby-1.9.3-p194/gems/ruby-llvm-3.0.0/lib/libRubyLLVMSupport-3.0.0.dylib: mach-o, but wrong architecture 
```

我检查了动态库是64位的。

```
file /DIR/.rvm/gems/ruby-1.9.3-p194/gems/ruby-llvm-3.0.0/lib/libRubyLLVMSupport-3.0.0.dylib 
libRubyLLVMSupport-3.0.0.dylib: Mach-O 64-bit dynamically linked shared library x86_64 
```

似乎 ruby​​ 正在 32 位模式下运行。`ruby 1.9.3p194 (2012-04-20 revision 35410) [i386-darwin11.4.0]`.

我该如何解决这个问题？有没有办法下载32位版本`ruby-llvm`或64位版本的`ruby`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T11:55:31.613

看来您已经以 32 位模式安装了 ruby​​。在 64 位模式下安装 ruby​​ 会解决问题吗？

要强制使用 64 位，您可以使用最新版本的 RVM 尝试以下操作：

```
$ rvm install 1.9.3 --64 
```

或 $ rvm install 1.9.3 --with-arch=x86_64

（来自：[http](http://www.engineyard.com/blog/2012/rvm-stable-and-more/) ://www.engineyard.com/blog/2012/rvm-stable-and-more/ ）

为了在 OS X 上编译 32 位模式 ruby​​，我们有 --32、--64 和 --universal 标志：

```
$ rvm install 1.9.3 --universal # to build fat binary including both 32 and 64 bit binaries
$ rvm install 1.8.7 --32 # to build only 32 bit ruby
$ rvm install 1.8.7 --with-arch=i386 # is equivalent to the 32 bit one, but is available only via RVM, ruby 1.8.7 sources do not support it. 
```

# php - 使用 PDO 搜索重复条目

> ID：12273664
> 
> 赞同：0
> 
> 时间：2012-09-05T02:16:45.307
> 
> 标签：php, mysql

我在使用一些代码来查找名称的重复项以及平台时遇到了麻烦。这也将适用于稍后查找唯一 ID。

因此，例如，如果 Xbox 上有一个名为“Apple”的服务器，并且您尝试在同一平台上插入一条名为“Apple”的记录，它将拒绝它。但是，允许使用其他同名平台，例如 PS3 中的“Apple”。

我已经尝试过提出想法并寻找答案，但是对于检查重复项的最佳方法是什么我有点摸不着头脑。

到目前为止，这就是我所拥有的：

```
$nameDuplicate_sql = $db->prepare("SELECT * FROM `servers` WHERE name=':name' AND platform=':platform'");
$nameDuplicate_sql->bindValue(':name', $name);
$nameDuplicate_sql->bindValue(':platform', $platform);
$nameDuplicate_sql->execute(); 
```

我尝试了很多不同的解决方案，其中一些来自这里，另一些来自 PHP 手册等。但似乎都没有。

我试图坚持使用 PDO，但是，这是我无法弄清楚转向何处的一个实例。如果这是在 mysql_* 中，我可能只使用 mysql_affected_rows，但对于 PDO，我不知道。rowCount 看起来很有希望，但它总是返回 0，因为这既不是 INSERT、UPDATE 或 DELETE 语句。

哦，我已经在 phpMyAdmin 中尝试过 SQL 语句，它可以工作；我用一个简单的名称/平台尝试了它，它正确地找到了行。

如果有人可以在这里帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:20:12.330

> 对于大多数数据库，PDOStatement::rowCount() 不返回受 SELECT 语句影响的行数。相反，使用 PDO::query() 发出 SELECT COUNT(*) 语句，其谓词与预期的 SELECT 语句相同，然后使用 PDOStatement::fetchColumn() 检索将返回的行数。然后，您的应用程序可以执行正确的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T02:21:24.857

为什么不直接在数据库表上强制执行，而不是检查重复项？创建一个复合键，如果它们已经存在，将禁止进行输入？

```
CREATE TABLE servers (
    serverName varchar(50),
    platform varchar(50),
    PRIMARY KEY (serverName, platform)
) 
```

这样，您将*永远不会*得到重复，并且它还允许您使用 mysql`insert... on duplicate key update...`语法，这听起来对您来说可能相当方便。

如果您已经有一个主键或者您不想创建一个新表，您可以使用以下内容：

```
ALTER TABLE servers DROP PRIMARY KEY, ADD PRIMARY KEY(serverName, platform); 
```

编辑：主键是单行或必须在其中具有唯一数据的多*行*。单行不能有两次相同的值，但是复合键（这是我在这里建议的）意味着在两列之间，不能出现相同的数据。

在这种情况下，您想要做的是添加服务器名称并将其与平台相关联 - 该表将允许您添加包含相同服务器名称的尽可能多的行 - 只要每个都有一个与相关联的唯一平台它 - 反之亦然，只要所有服务器名称都是唯一的，您就可以根据需要多次列出平台。

如果您尝试在存在相同服务器名称/平台组合的位置插入一条记录，则数据库根本不会让您这样做。不过，还有另一个黄金好处。由于这个键约束 - mysql 允许使用特殊类型的查询。它是`insert... on duplicate key update`语法。这意味着如果您尝试两次插入相同的数据（即数据库拒绝），您可以捕获它并更新表中已有的行。例如：

您有一行`serverName=Fluffeh`并且它已打开，`platform=Boosh`但您现在不知道它，因此您尝试插入一条记录以更新服务器 IP 地址。

通常你会简单地写这样的东西：

```
insert into servers (serverName, platform, IPAddress) 
values ('$serverName', '$platform', '$IPAddy') 
```

但是如果确定了一个很好的主键，您可以这样做：

```
insert into servers (serverName, platform, IPAddress) 
values ('$serverName', '$platform', '$IPAddy') 
on duplicate key update set IPAddress='$IPAddy'; 
```

如果该行尚不存在，则第二个查询将插入包含所有数据的行。如果确实如此，Bam！它将更新服务器的 IP 地址，这一直是您的意图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T02:19:27.837

从参数标记的查询中删除单引号......一旦绑定它们就会被引用......这是准备好的语句的部分原因。

```
$nameDuplicate_sql = $db->prepare("SELECT * FROM `servers` WHERE name= :name AND platform= :platform"); 
```

# javascript - 我的 HTML5 游戏时常卡顿，如何判断是不是垃圾回收造成的？

> ID：12273667
> 
> 赞同：3
> 
> 时间：2012-09-05T02:17:07.210
> 
> 标签：javascript, html, garbage-collection

我的 HTML5 游戏时常卡顿，如何判断是不是垃圾回收问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:29:34.817

对于 Chrome，您可以在控制台中检查 Timeline 标签并检查内存使用情况。如果您看到较大的锯齿形图案，这可能意味着 GC 导致了卡顿。

本文还深入介绍了如何优化 javascript 游戏

[http://www.scirra.com/blog/76/how-to-write-low-garbage-real-time-javascript](http://www.scirra.com/blog/76/how-to-write-low-garbage-real-time-javascript)

# javascript - 在 setTimeout 内调用函数时出现引用错误

> ID：12273668
> 
> 赞同：0
> 
> 时间：2012-09-05T02:17:28.893
> 
> 标签：javascript, jquery

我在 setTimeout 函数中不断收到参考错误。
下面是javascript文件中的代码

```
( function( $, undefined ) {

  $( document ).ready( init );

  function init() {
    registerEventListeners();
  }

  function registerEventListeners() {
    $( '.start_countdown').click( handleStart );
    $( '.end_countdown').click( handleEnd );
  }

  var countdown;
  var countdown_number;

  function handleStart() {
    countdown_number = 11;
    countdown_trigger(countdown_number);
  }

  function countdown_trigger() {
    if (countdown_number > 0) {
      countdown_number --;
      document.getElementById('countdown_text').innerHTML = countdown_number;
      if (countdown_number > 0) {
          countdown = setTimeout('countdown_trigger()', 1000);
      }
    }
  }

  function handleEnd() {
    clearTimeout(countdown);
  }

})( jQuery ); 
```

在jade.js 文件中：

```
extends layout

append scripts
  script(src='/javascripts/countDownRedirect.js')

block content
  h1= title

  p Redirecting you to your documents shortly

  div
    button.start_countdown#start Start Countdown
    button.end_countdown#end End Countdown

  div#countdown_text Placeholding text 
```

参考错误：“countdown_trigger()”未定义

加载页面后，一切似乎都可以正常工作。
单击开始按钮会显示 10，但随后会引发引用错误。有什么建议么？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:24:18.237

当您`setTimeout`在调用中使用引号时，`eval`这不是一个好主意。尝试传递对函数的引用而不是字符串：

```
countdown = setTimeout(countdown_trigger, 1000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:33:36.813

为了解释发生了什么以及为什么它不起作用 - 当您将字符串传递给 时，该字符串在全局范围内`setTimeout()`由 by 评估。`eval()`这意味着在该全局范围内没有可用的局部函数或变量。由于您的`countdown_trigger()`函数是在另一个函数中声明的，因此它不在全局范围内，因此无法使用`eval()`，因此当您将其传递给`setTimeout()`.

这是从不将字符串传递给`setTimeout()`.

而是传递一个真实的函数引用，该引用在您当前的范围内进行评估，如下所示：

```
setTimeout(countdown_trigger, 1000); 
```

# php - PHP 脚本看门狗定时器

> ID：12273674
> 
> 赞同：2
> 
> 时间：2012-09-05T02:18:20.320
> 
> 标签：php, web-services, timer, watchdog, chunking

对于社区，我目前正在编写一个 PHP 脚本来使用标准块提供文件，如下所示：

```
set_time_limit(0);
ob_clean();
ob_start();
while (SoapService->nextChunk()) {
     $chunk=SoapService->chunk();
     print $chunk;
     ob_flush();
     flush();
} 
```

我想做的是在 flush() 之后添加某种方法，例如 timerReset(); 然后在某种计时器循环中：

```
while (True) {
   Sleep(0.30);
   if (timerCheckandIncrement() > 100) {
      SoapService->notifyClose();
      exit(0);
      /*  or  */
      SoapService->takeSomeAction();
   }
} 
```

这样，如果远端停止接收数据包和/或无法跟上流，我将能够执行以下操作： a) 更改编码比特率。b) 停止脚本并清理/释放资源。

我知道 Apache / PHP 可以协商诸如 Keep-Alive 等标头，但我不知道如何准确地利用它们，和/或真正利用它们。
使用 AJAX 服务是不可取的。这里的目标是使用应用服务器通过互联网将媒体内容从文件服务器流式传输到移动设备。我也考虑过编写一个“应用程序”，但是跨平台编码（android/bb/iOS/W7M）以及我对 SmallTalk（ObjectiveC）的极其有限的知识会增加不必要的复杂性。

# jquery - 如何使用 jQuery 删除大写单词之间的空格？

> ID：12273681
> 
> 赞同：1
> 
> 时间：2012-09-05T02:20:05.520
> 
> 标签：jquery

我有以下选择：

```
<option value="Kabardino-Balkar Republic">Kabardino-Balkar Republic</option>
<option value="Karachay-Cherkess Republic">Karachay-Cherkess Republic</option>
<option value="Karelia Republic">Karelia Republic</option>
<option value="Komi Republic">Komi Republic</option>
<option value="Mari El Republic">Mari El Republic</option>
<option value="Mordovia Republic">Mordovia Republic</option> 
```

..我希望它们采用以下格式：

```
<option value="Kabardino-BalkarRepublic">Kabardino-Balkar Republic</option>
<option value="Karachay-CherkessRepublic">Karachay-Cherkess Republic</option>
<option value="KareliaRepublic">Karelia Republic</option>
<option value="KomiRepublic">Komi Republic</option>
<option value="MariElRepublic">Mari El Republic</option>
<option value="MordoviaRepublic">Mordovia Republic</option> 
```

如何删除`value`属性中大写单词之间的空格，同时保持连字符完好无损？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T02:24:40.100

```
$('option').val(function(i, val){
  return val.split(" ").join("")
}) 
```

[→](http://jsfiddle.net/6yG6h/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T02:25:40.140

只需将正则表达式与字符串替换方法一起使用？

```
$('option').each(function(){
   var $this = $(this);
   $this.val($this.val().replace(/\s/g,'')); // <-- replace a space with no space
});​ 
```

[http://jsfiddle.net/XgNJV/](http://jsfiddle.net/XgNJV/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:45:45.443

在这里，我为上述问题做了垃圾箱。您也可以查看演示链接。

**演示：** [http ://codebins.com/bin/4ldqp7o](http://codebins.com/bin/4ldqp7o)

**HTML**

```
<select id="demo">
  <option value="Kabardino-Balkar Republic">
    Kabardino-Balkar Republic
  </option>
  <option value="Karachay-Cherkess Republic">
    Karachay-Cherkess Republic
  </option>
  <option value="Karelia Republic">
    Karelia Republic
  </option>
  <option value="Komi Republic">
    Komi Republic
  </option>
  <option value="Mari El Republic">
    Mari El Republic
  </option>
  <option value="Mordovia Republic">
    Mordovia Republic
  </option>
</select> 
```

**jQuery**

```
$(function() {
    $("#demo option").each(function() {
        var $option = $(this);
        $option.val($option.val().replace(/([A-Za-z0-9-_])\s([A-Z]{1})/g, '$1$2'));
    });
}); 
```

**演示：** [http ://codebins.com/bin/4ldqp7o](http://codebins.com/bin/4ldqp7o)

# html - 告诉我 vbscript 中的错误

> ID：12273686
> 
> 赞同：0
> 
> 时间：2012-09-05T02:20:40.423
> 
> 标签：html, vbscript

```
<script language="vbscript">

Function getActivity(ID)
    Option explicit
    Response.Buffer = true
    dim conn, sql, rs,rs1,Action, UserID, strHolder,                
    Set conn = Server.CreateObject("ADODB.Connection")
    conn.open Application("Database4_ConnectionString")
    sql = ""
    sql = "Select DateShown, Title, TextBody from Activity where ActID = "& ID
    set rs = Conn.Execute(sql)
    strHolder = rs("TextBody")
    If InStr(strHolder, "</font>") > 0 or InStr(strHolder, "</p>") > 0 or InStr(strHolder, "<br>") > 0 Then
        TextBody = strHolder
    Else
        TextBody = Replace("" & strHolder, chr(13) & chr(10), "<br>")
    End if
End Function
</script> 
```

我尝试在 html 中使用这个 vbscript 函数如下，但它没有显示预期的输出。我想使用文本正文中的内容

```
<div class="modal-body">  
        <h4>Text in a modal</h4>  
        <p>You can add some text here too.</p>
        <p><script type="vbscript">getActivity(216)</script></p>                
    </div> 
```

请告诉我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T07:14:18.300

从文档：

> 如果使用，Option Explicit 语句必须出现在脚本中的任何其他语句之前。

由于您没有看到错误消息，我假设`On Error Resume Next`您的代码中有一条松散的声明，或者您的 IE 设置中激活了“不要因错误而打扰我”选项。禁用它们以便能够找到并纠正更多错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T10:01:04.770

恐怕您将无法在客户端 vbscript 中使用 ADODB.Connection。您应该在服务器端执行此操作（使用 classic-asp、asp.net 或任何其他服务器端脚本语言）。

# algorithm - 生成字符串列表及其子字符串排列的算法

> ID：12273688
> 
> 赞同：5
> 
> 时间：2012-09-05T02:20:48.670
> 
> 标签：algorithm, list, permutation

这个算法已经逃离了我一段时间了。假设我得到了字符串“cccaatt”。我正在尝试生成每个重复字母子串的所有可能变体。例如，“cccaatt”作为输入将返回：

猫, 猫, caat, caatt, ccat, ccatt, ccaat, ccaatt, cccat, cccatt, cccaat, cccaatt

结果的顺序无关紧要，只要它返回所有结果即可。一般来说，输入是一个字符串，由g组重复的字母组成，每组k_n个字母长。

我的直觉是，这是一个递归算法，但它的确切结构一直很难理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T07:42:52.737

如果您存储每个字母的字母表和最大出现次数（正如评论中所提到的），您可以这样做：

```
function variations(letter_type, current string) {
    if (letter_type is in the alphabet) {
        while (string has fewer than the max amount of that letter) {
            add one of that letter to current string
            variations(next letter, current string)
        }
    } else {
        print current string // since there are no more letters to add
    }
} 
```

在 Java 中：

```
public class Variations {

    static String[] alphabet = {"c","a","t"};
    static int[] maximums = {3, 2, 2};

    public static void main(String[] args) {
        variations(0, "");
    }

    public static void variations(int letter_type, String curr) {
        if (letter_type < alphabet.length) {
            for (int i = 1; i <= maximums[letter_type]; i++) {
            curr += alphabet[letter_type];
            variations(letter_type+1, curr);
            }
        } else {
            System.out.println(curr);
        } 
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T05:29:50.817

将字符串分解为数字列表和重复次数，即“cccaatt” => [(c,3), (a,2), (t,2)]。然后可以递归地定义问题。

```
Let xs = [(a_1, n_1), (a_2, n_2), (a_3, n_3), ... (a_k, n_k)]
define Perm(xs):
    if len(xs) == 1:
        return all length variations of xs
    else:
        return every sequence in Perm(x[:-1]) appended with one or more from x[-1] 
```

我很快就会有一个 python 示例。

```
> perm("cccaatt")
> ['cat', 'ccat', 'cccat', 'caat', 'ccaat', 'cccaat', 'catt', 'ccatt', 'cccatt', 'caatt', 'ccaatt', 'cccaatt'] 
```

附上代码

```
def perm(xs):
    if not xs:
        return []

    # group them into the correct format, probably should have used groupby + zip
    l = [(xs[0],1)]
    for x in xs[1:]:
        last, num = l[-1]
        if last == x:
            l[-1] = (last, num+1)
        else:
            l.append((x, 1))

    # print(l)
    print(recurse(l))

# this is where the real work is done.
def recurse(xs):
    if len(xs) == 1:
        return [ xs[0][0] * x for x in range(1, xs[0][1] + 1) ]

    prev = recurse(xs[:-1])
    char, num = xs[-1]
    return [ y + x * char for x in range(1,num + 1) for y in prev ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T19:26:52.407

Python itertools 模块具有强大的工具来分组，然后迭代导致以下程序的组成员。

我已经展示了一些中间结果并使用 pprint 模块来漂亮地打印答案：

```
Python 2.7.3 (default, Aug  1 2012, 05:16:07) 
[GCC 4.6.3] on linux2
Type "copyright", "credits" or "license()" for more information.
>>> import itertools
>>> instring = "cccaatt"
>>> [(x[0], list(x[1])) for x in itertools.groupby(instring)]
[('c', ['c', 'c', 'c']), ('a', ['a', 'a']), ('t', ['t', 't'])]
>>> xx = [list(x[0]*n for n in range(1, len(list(x[1]))+1)) for x in itertools.groupby(instring)]
>>> xx
[['c', 'cc', 'ccc'], ['a', 'aa'], ['t', 'tt']]
>>> list(itertools.product(*xx))
[('c', 'a', 't'), ('c', 'a', 'tt'), ('c', 'aa', 't'), ('c', 'aa', 'tt'), ('cc', 'a', 't'), ('cc', 'a', 'tt'), ('cc', 'aa', 't'), ('cc', 'aa', 'tt'), ('ccc', 'a', 't'), ('ccc', 'a', 'tt'), ('ccc', 'aa', 't'), ('ccc', 'aa', 'tt')]
>>> from pprint import pprint as pp
>>> pp(list(itertools.product(*xx)))
[('c', 'a', 't'),
 ('c', 'a', 'tt'),
 ('c', 'aa', 't'),
 ('c', 'aa', 'tt'),
 ('cc', 'a', 't'),
 ('cc', 'a', 'tt'),
 ('cc', 'aa', 't'),
 ('cc', 'aa', 'tt'),
 ('ccc', 'a', 't'),
 ('ccc', 'a', 'tt'),
 ('ccc', 'aa', 't'),
 ('ccc', 'aa', 'tt')]
>>> 
```

或者作为一个函数：

```
>>> def stringexpand(instring):
    xx = [list(x[0]*n for n in range(1, len(list(x[1]))+1)) for x in itertools.groupby(instring)]
    return list(itertools.product(*xx))

>>> pp(stringexpand("cccaatt"))
[('c', 'a', 't'),
 ('c', 'a', 'tt'),
 ('c', 'aa', 't'),
 ('c', 'aa', 'tt'),
 ('cc', 'a', 't'),
 ('cc', 'a', 'tt'),
 ('cc', 'aa', 't'),
 ('cc', 'aa', 'tt'),
 ('ccc', 'a', 't'),
 ('ccc', 'a', 'tt'),
 ('ccc', 'aa', 't'),
 ('ccc', 'aa', 'tt')]
>>> 
```

你似乎需要从它们的部分连接起来的字符串。这可以在这个轻微的 mod 中完成：

```
def stringexpand(instring):
    xx = [list(x[0]*n for n in range(1, len(list(x[1]))+1)) for x in itertools.groupby(instring)]
    return [''.join(parts) for parts in itertools.product(*xx)] 
```

返回：

```
['cat',
 'catt',
 'caat',
 'caatt',
 'ccat',
 'ccatt',
 'ccaat',
 'ccaatt',
 'cccat',
 'cccatt',
 'cccaat',
 'cccaatt'] 
```

# java - 将文件从 Javascript 传递到 Java Uploader Applet

> ID：12273694
> 
> 赞同：0
> 
> 时间：2012-09-05T02:21:50.740
> 
> 标签：java, javascript, file, applet

我有一些 Java Applet，我想用它来将文件/文件上传到 FTP 服务器。最重要的方法是上传（字符串 ftpServer、字符串用户名、字符串密码、字符串文件路径、文件源文件）。在 JS 代码中，我存储了从 input="file" 获取的数组数据（用户可以将文件附加和删除到他之前创建的不同对象，所以我必须将这些数据存储在某个地方）。

问题是文件数据由 JS File 对象表示，当调用上传函数时被识别为 sun.plugin2.main.client.MessagePassingJSObject （尝试初始化新的 java.io.File 对象时也是如此）。

所以问题是：是否有可能以某种方式将与 java.io.File 兼容的对象或有关文件的数据（我猜只有完整路径）传递给 Java 小程序？

如果没有，有没有办法从使用 FileReader 读取的 Java 代码文件上传到字符串（例如使用 .readAsBinaryString 方法）？

或者是否存在针对我的问题的任何其他解决方案？

编辑：

更多上下文：

Ftp 上传小程序是应用程序的一部分，它使用 canvas 元素（具体来说是 fabric.js 库）。将新元素添加到画布区域后，用户可以选择一个元素并向该元素添加/分配一些文件（任何图像文件）。图像不必加载到Canvas区域，只需在选择特定元素时，它们的名称应显示在Canvas下面的列表中。当然，它们也可以被删除。

用户确认完成后，将一些数据发送（发布）到服务器端以准备控制文件，然后将该文件上传到 ftp 服务器。控制文件中所需的有关选定文件的唯一信息是文件名，因此我认为可以将文件选择器添加到小程序而不是 JS 代码，而不是从小程序发送数据或将其传递给 javascript，然后发送。在发布控制文件数据之前或之后，用户选择的所有文件也应上传到 ftp 服务器。

不幸的是，有一种情况是必须将文件加载到画布中并在确认后发送到 ftp 服务器 - 背景图像文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:50:36.957

我不知道通过[Live Connect 将](http://docs.oracle.com/javase/6/docs/technotes/guides/plugin/developer_guide/java_js.html)HTML5 创建的 ArrayBuffer 传递给小程序的任何方法，但是可以（并且可能稍微更兼容跨浏览器）使用小程序（使用[JNLP FileOpenService](http://docs.oracle.com/javase/1.5.0/docs/guide/javaws/developersguide/examples.html#FileOpenService) ）生成 Java 文件选择器并从磁盘读取文件你可以在不签署小程序的情况下做到这一点）。

# jquery - 在 jquery ajax 请求中使用 & 符号

> ID：12273695
> 
> 赞同：0
> 
> 时间：2012-09-05T02:22:03.227
> 
> 标签：jquery, special-characters

我在表格行中有表单输入，我想通过 ajax 提交。

```
$(this).closest("tr").find("input,select,textarea").each(function(){$data+=$(this).attr('name')+'='+encodeURIComponent($(this).val())+'&'; 
```

我让一切工作正常 - 直到其中一个输入的值中有一个＆符号。我在[这篇文章](https://stackoverflow.com/questions/4226480/ampersand-character-inside-a-value-of-jquery-ajax-request-data-option)中找到了一些信息，这对我很有帮助 - 并且使用 encodeURIComponent（如上所示）我能够毫无问题地提交表单。我的问题是-在那篇文章中，@TJ Crowder 提到了他将如何“强烈推荐”使用@Darin Dimitrov 的解决方案：

```
data: { id: thisId, value: thisValue } 
```

我将如何在我当前的代码中实现这一点？另外 - 使用第二个代码有什么好处，还是 encodeURIComponent 一样好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:32:06.217

您可以使用本机 Javascript“对象”伪类。我不太了解您的代码的目的；但是，假设它是正确的，应该是这样的：

```
$data = new Object;
$(this).closest("tr").find("input,select,textarea").each(function(){
  $data[$(this).attr('name')] = $(this).val();
}); 
```

希望这可以帮助。

# python - python中的小端

> ID：12273698
> 
> 赞同：0
> 
> 时间：2012-09-05T02:22:33.553
> 
> 标签：python

Mysystem 字节序很小，

```
>>> struct.pack('i',70691357)
'\x1d\xaa6\x04'
>>> int("0x436aa1d",16)
70691357 
```

推翻0x436aa1d是`1d a a6 43`不是 `1d a a6 04`，是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:38:44.487

打印出来的字符串应该被解释为`0x1d` `0xaa` `ord('6')` `0x04`, where `ord('6') = 0x36`。反转字节并将其放在一起会产生 0x0436aa1d。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:25:55.923

如果你想要一个漂亮的打印输出，你可以使用`binascii.hexlify()`

```
>>> import binascii
>>> binascii.hexlify(struct.pack('i',70691357))
'1daa3604' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T09:55:23.250

您可以使用这样的单行符以十六进制显示字符串的字节，而不管它们的值如何：

```
def hexify(s):
    return ''.join(map(lambda c: '\\x{:02x}'.format(ord(c)), s))

print hexify(struct.pack('i', 70691357))  # \x1d\xaa\x36\x04 
```

# css - 如何在 Twitter Bootstrap 图标和 Font Awesome 图标之间实现对等

> ID：12273699
> 
> 赞同：1
> 
> 时间：2012-09-05T02:22:36.483
> 
> 标签：css, ruby-on-rails, twitter-bootstrap, sass, font-awesome

在 Ruby on Rails 3.2 应用程序中，我使用 Twitter Bootstrap-Sass v 2.0.3 和[Font Awesome](http://fortawesome.github.com/Font-Awesome/)，两者都作为 Gems 安装。

我正在使用“Font Awesome”，因为我想更改引导图标的颜色。

我的问题是我的图标在彼此对齐方面完全关闭：

![在此处输入图像描述](../Images/2c1955c2e43f86b3e5b03b3d6495abc3.png) ![在此处输入图像描述](../Images/7efaa2b8ecb385527441d2ba83e7319b.png)

发生的事情是它在不同的位置呈现原始的黑色图标和较新的图标。

在 Font Awesome 上，它说“这套巨大的新图标是在 Font Awesome GitHub 项目中请求的，包括与 Bootstrap 2.0.3 的图标奇偶校验。”

如何对齐图标以使形状相同但仍然通过字体操纵颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T10:59:19.760

这就是我之前处理相同问题的方式。由于本机引导图标是背景图像，而 Font Awesome 图标是文本内容，我只是像这样覆盖引导样式（例如在 application.scss 中）：

```
[class^="icon-"], [class*=" icon-"] {
  background-image: none;
} 
```

# java - 适当的秋千设计

> ID：12273700
> 
> 赞同：1
> 
> 时间：2012-09-05T02:22:46.780
> 
> 标签：java, swing, user-interface, layout

我听说将同级组件放在另一个同级组件之上是不好的做法。

在这种情况下，我说的是 JPanels。我目前将所有内容分成单独的 JPanel，每个 JPanel 都有自己的布局，然后我将它们添加到主内容窗格 (JPanel)。我觉得这种方式比必须配置一个适用于我所有可能遍布各处的组件的布局要容易得多。我的逻辑有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T05:49:44.100

在面板内部放置面板并没有错。但是，如果您经常这样做，您可能需要考虑一个布局管理器（我最喜欢的是[MiGLayout](http://www.miglayout.com/)），它支持相当复杂的控件排列，而无需使用大量嵌套面板。

归根结底，使用一种可以让您更轻松地维护代码的组合。如果您有一组相互独立的控件，那么将它们放在单独的面板中是很好的设计 - 它允许您将该面板拆分出来（用于测试，甚至用于 UI 中的创意窗口）。如果控件集本质上是相互关联的，请考虑使用具有高级布局管理器的单个面板。

在某些情况下，您将在两个面板之间进行少量绑定（经典示例是一个面板具有列表，另一个面板具有列表中所选项目的详细视图）。在这种情况下，我一般使用两个单独的面板，以及两个单独的展示模型，然后将一个模型中的当前选中项绑定到检查器面板的父级。但是，如果您发现您正在使用来自多个面板的值来进行验证、数据存储等操作……那么您可能会将事情分成太多的面板。

这些年来我做了很多这样的事情，我已经确定的立场是按照支持视图的底层表示模型的逻辑线来组合我的 UI。我很少让 UI 的布局驱动我使用多少个面板，等等...... - MigLayout（我相信还有其他的）使甚至复杂的 UI 布局也相当简单，并且设计类要好得多视图和模型的方式使代码更易于测试和维护。

# javascript - 使用Javascript将多行变量转换为单行变量？

> ID：12273701
> 
> 赞同：0
> 
> 时间：2012-09-05T02:22:46.843
> 
> 标签：javascript, jquery

我有一个变量：

```
 var remoteControlPage = '
        <table>
            <tr>
                <td class="stats">sadfsadf</td>
            </tr>
        </table>
    '; 
```

我想在这样的 Jquery`.html`函数中使用它：

```
 $("div.devices div.devicePage").html(remoteControlPage); 
```

问题是除非新内容在单行中，否则 html 函数将不起作用。这在编写 html 时是不可取的。

所以我想知道是否有办法将其`var remoteControlPage`转换为单行变量？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:25:23.930

这个问题不仅限于`.html()`一个人——相反，如果没有一些帮助，JS 将不支持多行字符串。

有许多模板解决方案可以为您处理这个问题，但一个常见的纯 JS 解决方案是`join`字符串数组：

```
var remoteControlPage = [
    '<table>',
      '<tr>',
        '<td class="stats">sadfsadf</td>',
      '</tr>',
    '</table>'
].join(''); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:00:05.897

您不能像这样定义变量：

```
var remoteControlPage = '
    <table>
        <tr>
            <td class="stats">sadfsadf</td>
        </tr>
    </table>
'; 
```

在任何情况下，您都可以拥有一个由用户填充文本的文本区域

```
<table>
    <tr>
        <td class="stats">sadfsadf</td>
    </tr>
</table> 
```

然后你明白了：

```
var remoteControlPage = mytextarea.value; 
```

但是当你这样做时，文本将更改为

```
var remoteControlPage = "<table>\n    <tr>\n        <td class=\"stats\">sadfsadf</td>\n    </tr>\n</table>" 
```

然后，如果你想删除换行符，你可以这样做

```
remoteControlPage = remoteControlPage.replace(/\s*\n\s*/g,"") 
```

但你不需要那个。如果您说用户将编写 HTML，您可以使用`<textarea>`, ...

```
<textarea id="txt">
<table>
    <tr>
        <td class="stats">Cell 1</td>
        <td class="stats">Cell 2</td>
    </tr>
</table>
</textarea> 
```

...一个按钮， ...

```
<button id="button">Click me!</button> 
```

...和一个输出 HTML 查看器：

```
<div id="output">Here will go the output</div> 
```

然后你只需要

```
$('#button').click(function(){
    $('#output').html($('#txt').val());
}); 
```

[**演示**：http://jsfiddle.net/bYsTy/6/](http://jsfiddle.net/bYsTy/6/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T02:27:12.867

在 JS 中，您必须像这样正确连接这些字符串：

```
var remoteControlPage = 
    '<table>'
      +'<tr>'
        +'<td class="stats">sadfsadf</td>'
      +'</tr>'
    +'</table>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T03:07:29.620

你提到 html 在本地存储中，所以不要使用 JS 变量，直接从存储中设置它。

```
 $("div.devices div.devicePage").html(localStorage["bar"]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T02:42:02.050

您必须更换`\n`.

```
remoteControlPage = remoteControlPage.replace(/\n/g, '');
console.log(remoteControlPage);
// output: "<table>        <tbody><tr>            <td class="stats">sadfsadf</td>        </tr>    </tbody></table>" 
```

或者，如果您不想要空格，可以使用以下`regex`命令将其删除。
`/\n|\s(?![^\s]*<\/td>)/g`

**说明**：

*   `\s`: 匹配空白
*   `|`: 用于匹配`\n`或`\s`
*   `[^\s]`: 匹配除空白以外的所有内容
*   `<\/td>`：匹配结尾或您的`td`
*   `*`: 匹配前面的元素 0 次或多次
*   `\s(?![^\s]*<\/td>)`: 仅当后面跟一个不是 which 空格后面跟结尾的东西时才匹配空格`td`

所以你的代码如下：

```
remoteControlPage.replace(/\n|\s(?![^\s]+<\/td>)/g, '');
console.log(remoteControlPage);
// output: <table><tbody><tr><tdclass="stats">sadfsadf</td></tr></tbody></table> 
```

**注意**：它不会删除里面的空格`td.stats`。

[**演示**](http://jsfiddle.net/bYsTy/1/)

# php - substr_count 问题，或者可能使用正则表达式

> ID：12273704
> 
> 赞同：1
> 
> 时间：2012-09-05T02:22:58.077
> 
> 标签：php, regex

这就是我现在所拥有的：

```
$text = "test"; 
$count = substr_count($text, "Hello Everyone this is a 
                                  test test test that im testing"); 
```

$count 的值是 4。我想说 3，因为测试这个词与测试不同。如果它更好/更容易，我愿意使用正则表达式来做到这一点？请有任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:31:47.620

`\b`在 中使用单词边界转义序列`preg_match_all()`：

```
$count = preg_match_all('/\btest\b/', "Hello Everyone this is a 
                              test test test that im testing"); 
```

另请参阅：[转义序列](http://www.php.net/manual/en/regexp.reference.escape.php)

# bash - 解析来自“文件夹项”请求的响应以查找文件

> ID：12273706
> 
> 赞同：0
> 
> 时间：2012-09-05T02:23:07.397
> 
> 标签：bash, box-api

使用 box api 的 v2，我使用文件夹项请求来获取有关文件夹中文件的信息：http: [//developers.box.com/docs/#folders-retrieve-a-folders-items](http://developers.box.com/docs/#folders-retrieve-a-folders-items)

我正在考虑尝试解析响应数据。有什么想法可以在 bash 中执行此操作以轻松找到用户帐户中的文件吗？我想找到文件的名称，我也可以在其中获取文件的 ID。

响应看起来像这样：

```
{
    "total_count": 25,
    "entries": [
        {
            "type": "file",
            "id": "531117507",
            "sequence_id": "0",
            "etag": "53a93ebcbbe5686415835a1e4f4fff5efea039dc",
            "name": "agile-web-development-with-rails_b10_0.pdf"
        },
        {
            "type": "file",
            "id": "1625774972",
            "sequence_id": "0",
            "etag": "32dd8433249b1a59019c465f61aa017f35ec9654",
            "name": "Continuous Delivery.pdf"
        },
        { ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T11:16:00.913

对于 bash，您可以使用 sed 或 awk。查看[Parsing JSON with Unix tools](https://stackoverflow.com/questions/1955505/parsing-json-with-sed-and-awk)。

此外，如果您可以使用编程语言，那么 python 可能是您最快的选择。它有一个不错的模块 json [http://docs.python.org/library/json.html](http://docs.python.org/library/json.html)。它有一个简单的解码 API，它将给出一个 dict 作为输出

然后

```
import json
response_dict = json.loads(your_response) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-09T18:24:05.877

我建议使用[jq](http://stedolan.github.io/jq/)在 bash 中解析/处理 json。这比尝试使用 sed 或 awk 解析它要好得多。

# matplotlib - matplotlib xticks 标签重叠

> ID：12273712
> 
> 赞同：14
> 
> 时间：2012-09-05T02:24:49.257
> 
> 标签：matplotlib, bar-chart

我无法使用以下代码在 xticks 之间获得更好的空间：

```
import random
import matplotlib.pyplot as plt

coverages = [random.randint(1,10)*2] * 100
contig_names = ['AAB0008r'] * len(coverages)
fig = plt.figure()
fig.clf()
ax = fig.add_subplot(111)

ax.yaxis.grid(True, linestyle='-', which='major', color='grey', alpha=0.5)

ind = range(len(coverages))
rects = ax.bar(ind, coverages, width=0.2, align='center', color='thistle')
ax.set_xticks(ind)
ax.set_xticklabels(contig_names)
#function to auto-rotate the x axis labels
fig.autofmt_xdate()

plt.show() 
```

如何在 xticks 之间获得更多空间，使它们看起来不再重叠？

先感谢您。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-05T07:51:11.687

您可以尝试更改图形大小、xticklabels 的大小、它们的旋转角度等。

```
# Set the figure size
fig = plt.figure(1, [20, 8])

# Set the x-axis limit
ax.set_xlim(-1,100)
# Change of fontsize and angle of xticklabels
plt.setp(ax.get_xticklabels(), fontsize=10, rotation='vertical') 
```

# c# - 创建用于上传图像的 ViewModel 的正确方法是什么？

> ID：12273717
> 
> 赞同：3
> 
> 时间：2012-09-05T02:25:32.743
> 
> 标签：c#, asp.net-mvc-4

我的视图模型如下所示：

```
public class UploadImageForm
{
    public string Name { get; set; }
    public HttpPostedFileBase Image { get; set; }
} 
```

但它呈现为：

```
<img src="http://i.imgur.com/E4sRP.png" /> 
```

当`.cshtml`看起来像这样时：

```
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>ImageMeta</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Image)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Image)
            @Html.ValidationMessageFor(model => model.Image)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
} 
```

如何让它显示一个标准的`<input type="file">`上传控件？我不确定如何自定义“编辑器”，或者它是否会正确上传。

* * *

通过智能感知发现了这些`Html.IdFor`和`.NameFor`助手。现在我可以这样做：

```
<input id="@Html.IdFor(m => m.Image)" type="file" name="@Html.NameFor(m => m.Image)"/> 
```

我非常喜欢它，因为它避免了创建映射的魔术字符串。仍在试图弄清楚是否有完整输入的 Html 助手，如果没有，如何创建一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:59:58.020

不太确定是否有用于文件输入（上传）的 razor html 助手。但是您可以使用纯 html 输入语法。

```
@using (Html.BeginForm("Create", "ImageFile", FormMethod.Post, new {enctype = "multipart/form-data"})) {
    <input type="file" name="file1" id="file1" />
} 
```

**编辑：** ImageFileController 动作看起来像这样：

```
[HttpPost]
public ActionResult Create(HttpPostedFileBase file) {

  if (file.ContentLength > 0) {
    string name = Path.GetFileName(file.FileName);

    // HINT: Im uploading to App data folder!
    string path = Path.Combine(Server.MapPath("~/App_Data/uploads"), fileName);
    file.SaveAs(path);
  }
  return RedirectToAction("Index");
} 
```

此外，您可以从[这里找到](http://msdn.microsoft.com/en-us/library/microsoft.web.helpers.fileupload)*Microsoft.Web.Helpers*命名空间中的一些剃刀助手。

# ruby-on-rails - 如何配置 queue_classic 日志记录

> ID：12273719
> 
> 赞同：6
> 
> 时间：2012-09-05T02:25:42.067
> 
> 标签：ruby-on-rails, ruby, task-queue, worker-process

我在任何地方都找不到关于如何使 queue_classic 将日志写入文件的解决方案。Queue_Classic 用于记录的 Scrolls 似乎也没有任何示例。

有人可以提供一个工作示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T14:50:58.943

QC 调用的方法中的日志记录将成为日志记录的来源。例如，在铁轨中。对 Rails.logger 的任何调用都将转到适合您的 RAILS_ENV 的日志文件。来自滚动的日志数据进入标准输出，因此您可以在启动队列时将标准输出从队列传输到日志文件。

您可以使用 god.rb 控制您的队列，并提供与此类似的 god.rb 配置实例（我已将队列、目录等数量的配置留给您）：

 `````
number_queues.times do |queue_num|
  God.watch do |w|
    w.name = "QC-#{queue_num}"
    w.group = "QC"
    w.interval = 5.minutes
    w.start = "bundle exec rake queue:work" # This is your rake task to start QC listening
    w.gid = 'nginx' 
    w.uid = 'nginx'
    w.dir = rails_root
    w.keepalive
    w.env = {"RAILS_ENV" => rails_env} 
    w.log = "#{log_dir}/qc.stdout.log"  # Or....    "#{log_dir}//qc-#{queue_num}.stdout.log"

    # determine the state on startup
    w.transition(:init, { true => :up, false => :start }) do |on|
      on.condition(:process_running) do |c|
        c.running = true
      end
    end
  end
end 
```` 

`FWIW，我发现 STDOUT 日志数据没有多大帮助，最终可能只是将其发送到 bitbucket。`

 `如果日志数据无用，我们应该考虑将其删除。

当我从命令行运行它时，DEBUG 非常好。有时我试图弄清楚我做了什么来搞砸一切（通常是捆绑问题、路径问题等）。或者我要演示队列中发生的事情的时候。

对我来说，INFO 日志记录包括标准的 lib=queue_classic level=info action=insert_job elapsed=16 消息以及来自分叉执行或 PostgreSQL 的任何 STDOUT/STDERR。我没有扩展任何日志记录类，因为滚动转到 STDOUT 并且我的任务位于提供日志记录的环境中。

当然，它可以被删除。我认为这真的取决于环境和队列在做什么。如果我要做一些没有 Rails.logger 的事情，那么我会使用 QC.log 并更有效地滚动并以这种方式检测我的任务。

当我使用它时，我可能会保持我的配置不变，因为输出来自任务本身调用的方法/应用程序。我可能决定覆盖 QC.log 代码以添加日期/时间。我仍在努力确定适合我的需求。

抱歉，我的最后一行非常关注我给出的环境示例。

原文在这里：在此处[输入链接描述](https://github.com/ryandotsmith/queue_classic/issues/101)``

# css - 使用 CSS 等距空间对象

> ID：12273721
> 
> 赞同：2
> 
> 时间：2012-09-05T02:25:52.160
> 
> 标签：css, html-lists, text-align, text-justify

我正在尝试将 UL 等距隔开：[http ://cssdesk.com/jMSsr](http://cssdesk.com/jMSsr)

第一行完全隔开，但第二行没有隔开，因为只有 2 个项目。

我正在使用 text-align:justify 来均匀地分隔列表，但这会导致第二行出现问题，因为当行短时 justify 会恢复为左对齐。

关于如何修复第二行的任何想法？

干杯，合资企业

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:28:20.183

解决方法其实很简单：把要对齐的元素放在一个固定宽度的div中，然后将它们的左右边距设置为`auto`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:35:24.733

给**li**的宽度大于**输入的 text**。宽度：210px；

看到这个[链接](http://jsfiddle.net/venkateshwar/QE9Hg/)

# powershell - 如何在PowerShell中遍历包含大量文件的文件夹？

> ID：12273724
> 
> 赞同：8
> 
> 时间：2012-09-05T02:26:07.667
> 
> 标签：powershell

我正在尝试编写一个脚本，该脚本将遍历文件夹中的 160 万个文件，并根据文件名将它们移动到正确的文件夹中。

原因是 NTFS 无法在不降低性能的情况下处理单个文件夹中的大量文件。

脚本调用“Get-ChildItem”来获取该文件夹中的所有项目，正如您所料，这会消耗大量内存（大约 3.8 GB）。

我很好奇是否有任何其他方法可以遍历目录中的所有文件而不会占用太多内存。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-05T04:20:12.110

如果你这样做

```
$files = Get-ChildItem $dirWithMillionsOfFiles
#Now, process with $files 
```

您将面临记忆问题。

使用 PowerShell 管道处理文件：

```
Get-ChildItem $dirWithMillionsOfFiles | %{ 
    #process here
} 
```

第二种方式将消耗更少的内存，理想情况下不应超过某个点。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-05T04:24:14.067

如果您需要减少内存占用，您可以跳过使用`Get-ChildItem`，而直接使用 .NET API。我假设您使用的是 Powershell v2，如果是这样，请先按照[此处](https://stackoverflow.com/questions/2094694/how-can-i-run-powershell-with-the-net-4-runtime)的步骤启用 .NET 4 以在 Powershell v2 中加载。

在 .NET 4 中有一些很好的 API 用于*枚举*文件和目录，而不是在数组中返回它们。

```
[IO.Directory]::EnumerateFiles("C:\logs") |%{ <move file $_> } 
```

通过使用这个API，而不是`[IO.Directory]::GetFiles()`，一次只处理一个文件名，所以内存消耗应该是比较小的。

**编辑**

我还假设您尝试过一种简单的流水线方法，例如`Get-ChildItem |ForEach { process }`. 如果这足够了，我同意这是要走的路。

但我想澄清一个常见的误解：在 v2 中`Get-ChildItem`（或者实际上是 FileSystem 提供程序）并**没有**真正的流式传输。该实现使用 API`Directory.GetDirectories`和`Directory.GetFiles`，在您的情况下，它将在任何处理发生之前生成一个 1.6M 元素数组。完成此操作后，是的，管道的其余部分正在流式传输。是的，这个初始的低级部分的影响相对较小，因为它只是一个字符串数组，而不是丰富`FileInfo`对象的数组。但是声称`O(1)`在这种模式中使用了内存是不正确的。

相比之下，Powershell v3 是基于 .NET 4 构建的，因此利用了我上面提到的流 API（`Directory.EnumerateDirectories`和`Directory.EnumerateFiles`）。这是一个不错的更改，并且在像您这样的场景中有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-25T14:13:45.860

这就是我在不使用 .Net 4.0 的情况下实现它的方式。只有 Powershell 2.0 和老式的 DIR 命令：

这只是两行（简单）代码：

```
cd <source_path>
cmd /c "dir /B"| % { move-item $($_) -destination "<dest_folder>" } 
```

我的 Powershell 进程仅使用 15MB。旧的 Windows 2008 服务器没有任何变化！

干杯!

# jsp - JSP - 如何基于枚举选择单选按钮

> ID：12273725
> 
> 赞同：0
> 
> 时间：2012-09-05T02:26:25.123
> 
> 标签：jsp, enums, radio-button

我的视图模型有一个包含三个可能值的枚举：

```
public enum PollFrequency {
    SixHours, TwentyFourHours, Weekly
}

public class AlertViewModel {
    private PollFrequency pollFrequency;
    public PollFrequency getPollFrequency(){
        return pollFrequency;
    }
    public void setPollFrequency(PollFrequency pollFrequency){
        this.pollFrequency = pollFrequency;
    }

    public AlertViewModel(){
        pollFrequency = PollFrequency.TwentyFourHours;
    }
} 
```

我的 JSP 页面有一组三个单选按钮：

```
<input checked="<c:if test="${viewModel.pollFrequency eq 'SixHours'}">checked</c:if>" type="radio" name="checkEvery" value="checkEvery6Hours" /> 6 Hours<br />
<input checked="<c:if test="${viewModel.pollFrequency eq 'TwentyFourHours'}">checked</c:if>" type="radio" name="checkEvery" value="checkEvery24Hours" /> 24 Hours<br />
<input checked="<c:if test="${viewModel.pollFrequency eq 'Weekly'}">checked</c:if>" type="radio" name="checkEvery" value="checkEveryWeek" /> Weekly 
```

我想根据枚举值设置单选按钮的选中属性，但目前总是选中最后一个单选按钮。我发现了一些关于如何使用 springsource 进行操作的线程，但我没有使用它。有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:02:50.127

尝试这个，

```
<input type="radio" <c:if test="${model.thing eq 'Thing1'}">checked</c:if> name="thing" value="thing1" /> Thing1<br />
<input type="radio" <c:if test="${model.thing eq 'Thing2'}">checked</c:if> name="thing" value="thing2" /> Thing2<br />
<input type="radio" <c:if test="${model.thing eq 'Thing3'}">checked</c:if> name="thing" value="thing3" /> Thing3 
```

# python - Python - 多重继承：是否存在一个关键字来执行所有祖先的方法？

> ID：12273727
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:27:00.377
> 
> 标签：python, inheritance, multiple-inheritance

考虑：

```
class X:

    def some_method(self):
        print("X.some_method called")

class Y:

    def some_method(self):
        print("Y.some_method called")

class Foo(X,Y):

    def some_method(self):

        super().some_method()
        # plus some Foo-specific work to be done here

foo_instance = Foo()
foo_instance.some_method() 
```

输出：

```
X.some_method called 
```

将 Foo 的类声明改为：

```
class Foo(Y,X): 
```

将输出更改为：

```
Y.some_method called 
```

如果我想调用两个祖先方法，我可以将 Foo 的实现更改为：

```
def some_method(self):

    X().some_method()
    Y().some_method()
    # plus some Foo-specific work to be done here 
```

这引出了我的问题。有没有什么超级秘密的方法可以让 Python 在所有祖先上调用该方法，而无需我像代码一样明确地这样做，例如（我在这里编造了 all_ancestors 关键字 - 这样的事情真的存在吗？）：

```
def some_method(self):

    all_ancestors().some_method()
    # plus some Foo-specific work to be done here 
```

预期输出为：

```
X.some_method called
Y.some_method called 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:30:22.510

不，没有秘密的方法可以做到这一点。正如我在您的另一个问题中提到的那样，通常的方法是不要从单个后代类中调用所有祖先方法。相反，每个类应该`super`只调用*一个*祖先方法，即继承链上的下一个方法。如果树中的每个类都这样做（除了最顶层的基类），那么所有方法都将按顺序调用。换句话说， Foo 应该使用`super()`，这将调用`X`' 方法；然后`X`也应该使用`super()`，这将调用`Y`' 方法。

为了使这项工作正确，通常最好在继承树中有一个最顶层的类。在您的示例中，这将是一个作为 X 和 Y 基础的类。您需要这样一个类作为`super`调用序列的最后一站；这个基类不应该*调用*super。如果你只是不停`super`地到处调用，最终它会尝试调用基`object`类，然后失败，因为`object`没有提供你试图调用的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:27:46.053

如果您可以提供`X`&`Y`一个通用的基类或混合，这应该工作：

```
class ISomeMethod:
    def some_method(self):
        pass

class X(ISomeMethod):
    def some_method(self):
        print("X.some_method called")
        super(X, self).some_method()

class Y(ISomeMethod):
    def some_method(self):
        print("Y.some_method called")
        super(Y, self).some_method() 
```

`some_method`然后应该按照您在 中声明基类的顺序调用`Foo`。

# c# - 如何使用与父视图不同的模型处理 PartialView

> ID：12273731
> 
> 赞同：1
> 
> 时间：2012-09-05T02:27:12.330
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, partial-views

我将 VS2012 RC 与 MVC4 一起使用，机器人用于所有意图和目的，让我们假装它是 MVC3。我想知道关于如何使用与父视图使用不同模型的表单来处理 PartialViews 的标准最佳实践是什么。

例如，这是一个显示所有可用角色的表格的视图，并且还有一个允许用户添加更多角色的表单。

主视图 - Roles.cshtml：

```
@model IEnumerable<RobotDog.Models.RoleModel>

<table>
    @foreach(var role in Model) {
        <tr>
            <td class="roleRow">@role.Role</td>
        </tr>
    }
</table>
<div class="modal hide">
    @Html.Partial("_AddRolePartial")
</div> 
```

_AddRolePartial.cshtml

```
@model RobotDog.Models.RoleModel

@using(Html.BeginForm("AddRole","Admin", FormMethod.Post)) {
    @Html.TextBoxFor(x => x.Role, new { @class = "input-xlarge", @placeholder = "Role"})
    <input type="submit" value="Submit" class="btn btn-primary btn-large"/>
} 
```

模型：

```
public class RoleModel {
    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Role")]
    public string Role { get; set; }
} 
```

视图控制器：

```
public ActionResult Roles() {
    var model = from r in System.Web.Security.Roles.GetAllRoles()
                select new RoleModel {Role = r};
    return View(model);
} 
```

部分视图的控制器：

```
[HttpPost]
public ActionResult AddRole(RoleModel model) {
    try {
        System.Web.Security.Roles.CreateRole(model.Role);
        RedirectToAction("Roles");
    } catch(Exception) {
        ModelState.AddModelError("", "Role creation unsuccessful.");
    }

    return ????; // not sure how to pass ModelState back to partialView
} 
```

我考虑过创建一个持有的 ViewModel，`RoleModel`但`IEnumerable<RoleModel>`似乎会有一种更流线型的方式来完成我想要的，而不必每次我想使用这个 PartialView 时都创建一个 ViewModel。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T05:46:33.387

我想您是在问如何将 RoleModel 传递给 add RoleModel 模式弹出窗口。由于您正在创建一个新角色，我假设您需要一个空模型。您可以像下面这样传递它：

```
<div class="modal hide">
    @Html.Partial("_AddRolePartial", new RoleModel())
</div> 
```

或者只是`@Html.RenderAction("AddRole")`使用控制器的支持 GET 方法来支持填充项目。

```
public ActionResult AddRole() {
    var model = new RoleModel();
    //populate with any items needed for the Add Role Model View
    return View(model);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:12:21.827

如何将表单帖子更改为带有目标更新部分 id 的 ajax 表单帖子`div`，您将添加到父视图（有效地围绕 Roles.cshtml）。

添加一个新动作`public ActionResult _Roles()`，它将`return PartialView("Roles", model)`

接下来，在 Post Action中，`Return RedirectToAction(...Roles Partial Action ...)`最后并删除`try`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T05:57:53.730

我个人不喜欢在表单中使用局部视图，因为局部视图不能正确渲染子模型（即，它们没有考虑模型的层次结构）。

这就是存在 Display 和 EditorTemplates 的原因。它们适用于呈现特定的数据类型。

但是，在您的情况下，由于您的视图没有自己的任何形式，并且最终结果只是父模型集合的单个项目，因此 Partial View 实际上是一种更好的方法，因为您可以通过与视图使用的模型不同的模型。

正如其他人指出的那样，您可以轻松地将空模型作为第二个参数传递给部分。我不喜欢在视图中更新新对象，但看起来那里没有很多选择，因为替代方案会非常混乱。

# html - 在表单中使用 HTML 选择

> ID：12273733
> 
> 赞同：0
> 
> 时间：2012-09-05T02:27:27.277
> 
> 标签：html, css

由于某种原因，我无法在 share-actions-left div 内使 Select 选项与选择文件内联。我究竟做错了什么？

[http://jsfiddle.net/Ey9vA/](http://jsfiddle.net/Ey9vA/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:24:45.953

我相信您希望通过使元素内联块类似于@Daniil 所说的来处理。要让您的代码按原样工作，请添加此

```
#share-actions-left *{
    display:inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:47:21.860

添加以下 CSS 以使选择与上传按钮位于同一行：

```
#share-action{float: left;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T02:49:49.723

`#share-action`应该是内联块

```
#share-action {
    display: inline-block;
} 
```

# jquery - jQuery轮播定位问题

> ID：12273741
> 
> 赞同：0
> 
> 时间：2012-09-05T02:28:31.107
> 
> 标签：jquery, css

我正在尝试做一些相当简单的事情，但有一些问题。我想在轮播模式下使用 BX-Slider ( [www.bxslider.com](http://www.bxslider.com) )。我可以安装并运行它，但滑块的 CSS 定位确实不正确。您可以在我的[FIDDLE](http://jsfiddle.net/a59ne/1/)（附加插件）中看到，缩略图从屏幕上消失了，它们应该在灰色框中！我真的很感激一些关于如何纠正这个问题的建议。

这是我的 JS：

```
$(document).ready(function() {
    // start article gallery slider
    var main_gallery_slider = $('#main_gallery_slider').bxSlider({
        auto: true,
        controls: false,
        displaySlideQty: 4
    });

}); 
```

这是我的 HTML/滑块：

```
<div class="main_gallery" style="width:600px; background:#333; padding:10px;">
    <ul id="main_gallery_slider" style="width:600px;">
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
        <li><img src="myImage.jpg" width="90" height="60" /></li>
    </ul>
</div> 
```

除了我在内联添加的小部分之外，没有任何 CSS 可以使用，这里是[JSFiddle](http://jsfiddle.net/a59ne/1/) ( [http://jsfiddle.net/a59ne/1/](http://jsfiddle.net/a59ne/1/) )。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:42:34.617

问题是`li`标签应用了宽度，如果你在css中设置宽度。

```
#main_gallery_slider li { width: 90px; } 
```

假设您希望它们都具有相同的宽度，那将解决它。

# windows-7 - xampp 版本在 windows 7 32 位中支持 joomla 2.5

> ID：12273745
> 
> 赞同：1
> 
> 时间：2012-09-05T02:29:28.227
> 
> 标签：windows-7, xampp, joomla2.5

我需要下载什么版本的 Xampp 才能在 Windows 7 32 位中运行 Joomla 2.5 包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T05:23:49.367

您必须使用 xammp `1.6.6a`版本在您的机器上运行 joomla 2.5...

# javascript - 如何使用 SmartGWT 更新客户端 javascript 缓存？

> ID：12273746
> 
> 赞同：1
> 
> 时间：2012-09-05T02:29:30.633
> 
> 标签：javascript, gwt, smartgwt

在独立登录页面上轻松实现延迟 javascript 文件加载：

```
<script type="text/javascript" defer="defer" src="<c:url value='/etgcrm/sc/modules/ISC_Core.js'/>"></script>
<script type="text/javascript" defer="defer" src="<c:url value='/etgcrm/sc/modules/ISC_Foundation.js'/>"></script>
<script type="text/javascript" defer="defer" src="<c:url value='/etgcrm/sc/modules/ISC_Containers.js'/>"></script> 
```

等等。

在您决定更新 SmartGWT javascript 库之前，它可以正常工作。

因为 SmartGWT 本身是通过原始名称链接 .js 文件，所以您不能只将版本参数添加到登录页面上的脚本路径中，例如

```
ISC_Core.js?ver=123 
```

这是没用的，因为您的浏览器将使用来自

```
ISC_Core.js 
```

作为 SmartGwt 的命令。

克服这个问题的最优雅的方法是什么？

PS 解决方案包括使用 FileLoader 和其他 Power 功能不适合我，我只有 PRO lecense。

# css - 没有悬停的css3过渡？

> ID：12273753
> 
> 赞同：0
> 
> 时间：2012-09-05T02:31:17.983
> 
> 标签：css, css-transitions

我正在关注 CSS3 过渡教程：[这里](http://thecreativeservicesblog.com/2011/10/css3-animations-using-transition-tranform-and-keyframes/)

我无法在不悬停的情况下让它工作。有谁知道我如何从本教程中获得同样的效果而不必将鼠标悬停在身体​​上？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T17:57:38.413

您可以通过简单地将“测试”类直接放在标记中来简化@Rufus 的答案。以后没有理由用 javascript 添加它。

如果您使用的是 css3 过渡，那么您需要在页面加载后添加过渡类，但由于您使用的是关键帧动画，因此您无需等待即可添加它。

这是@Rufus 修改后的示例，以显示我在说什么：http: [//jsfiddle.net/mALEC/2/](http://jsfiddle.net/mALEC/2/)

# c# - create login page that have 2 buttons, "Admin" and "Member" button

> ID：12273763
> 
> 赞同：0
> 
> 时间：2012-09-05T02:32:47.673
> 
> 标签：c#, sql-server-2008, asp.net-4.0

I am new in asp.net 4.0. I want to create login page that have 2 buttons, "Admin" and "Member" button. I want to ask, how can I connect to database both this button?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T06:10:39.737

像这样使用开始形式

```
 @using (Html.BeginForm("PostLogin", "Account", FormMethod.Post, new { enctype = "multipart/form-data" })) 
```

# mysql - mysql select from 3 tables not working

> ID：12273766
> 
> 赞同：0
> 
> 时间：2012-09-05T02:33:55.547
> 
> 标签：mysql

I have 3 tables on my database with the following data:

tb_collection: id_collection, name

tb_collection_product: id, id_collection, id_product

tb_product: id_product, photo

Here's what I'm trying to do:

Select the last 2 products of each collection...I've tried group by with no luck.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T13:17:49.873

刚刚开始执行以下操作：

添加了一个名为“show”的新列作为 tinyint 字段，默认为 0 和 1 为选中状态。然后，下面的mysql：

选择 tb_product.photo, tb_collection_product.* 从 tb_product,tb_collection_product WHERE tb_collection_product.show=1 AND tb_collection_product.id_product = tb_product.id_product

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:50:11.007

试试这个查询

```
SELECT   tb_collection.id_collection,tb_collection.name , 
         tb_collection_product.id , tb_collection_product.id_collection, 
         tb_collection_product.id_product, tb_product.id_product, 
         tb_product.photo 
FROM     tb_collection 
             INNER JOIN tb_collection_product 
                    ON tb_collection.id_collection=tb_collection_product.id_collection 
             INNER JOIN tb_product 
                    ON tb_collection_product.id = tb_product.id_product 
ORDER BY tb_collection.id_collection DESC limit 2 
```

# sql-server - 禁用 LocalDB 自动升级

> ID：12273767
> 
> 赞同：0
> 
> 时间：2012-09-05T02:33:57.797
> 
> 标签：sql-server, sql-server-2012, localdb

使用 LocalDB (SQL Server 2012) 连接到 SQL Server 2008 R2 数据库后，现在我无法从 SQL Server 2008 R2 连接：

> 无法打开数据库“Northwind”，因为它是版本 706。此服务器支持版本 663 和更早版本。不支持降级路径。

显然 LocalDB 执行了自动升级。

是否有禁用自动升级的连接字符串参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T05:25:48.507

不，SQL Server 总是在附加格式较低的数据库时执行升级。为了避免升级，您必须使用 SQL Server 2008 R2 中的 LocalDB，因为 LocalDB 是在 SQL Sever 2012 中引入的，所以它不存在。

**更新 1**

提供一个完整的答案：理论上你可以将数据库附加为只读，这**应该**会阻止它被升级（我不是 100% 确定，需要测试和验证）。显然，这至少存在两个大问题。首先，数据库是只读的，这意味着在大多数情况下不是很有用。其次，我认为没有任何连接字符串属性会强制`AttachDbFileName`将数据库附加为只读。您需要通过 T-SQL 脚本显式附加它，如果目标是简单性，这可能会破坏目的。

# c# - 在 c# 中编写 C++ 代码

> ID：12273769
> 
> 赞同：0
> 
> 时间：2012-09-05T02:34:27.577
> 
> 标签：c#, c++

> **可能重复：**
> [你能在 C# 中编写一段 C++ 代码吗？](https://stackoverflow.com/questions/196390/can-you-write-a-block-of-c-code-inside-c)

是否可以在纯`C++`内部编写代码？`C#`

例如：

```
class MyClass
{
    public void MyCSharpFunction(){Console.WriteLine("Hello World!");}
    public void MyCPlusPlusFunction(){std::cout<<"Hello World"<<std::endl;}
} 
```

我知道你可以通过 DLL 来做到这一点，但是，我找不到任何关于*不*使用 DLL 是否可以做到这一点的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:38:38.557

您可以使用[不安全](http://msdn.microsoft.com/en-us/library/chfa2zb8%28VS.71%29.aspx)的代码，但不能直接使用 C++：

```
// cs_unsafe_keyword.cs
// compile with: /unsafe
using System;
class UnsafeTest 
{
   // unsafe method: takes pointer to int:
   unsafe static void SquarePtrParam (int* p) 
   {
      *p *= *p;
   }
   unsafe public static void Main() 
   {
      int i = 5;
      // unsafe method: uses address-of operator (&)
      SquarePtrParam (&i);
      Console.WriteLine (i);
   }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-05T02:36:41.410

不，当然不是。[30 个字符]

# html - 元素忽略容器元素的填充

> ID：12273774
> 
> 赞同：7
> 
> 时间：2012-09-05T02:35:15.923
> 
> 标签：html, css

我有以下 HTML/CSS 代码：

```
<div id="container" style="padding:5px; width:600px;">  
    <div id="panel">
        <a style="padding:5px; color:#ffffff; background-color:#000000;">Page 1</a>

        <!-- Other anchor elements -->
    </div>

    <!-- Other panels -->
</div> 
```

我很难理解为什么该`#panel`元素舒适地位于`#container`; 遵守它的填充规则，而在`#panel`重叠的锚元素的填充`#container`。有人介意解释为什么会这样，这样做，也许会提出解决办法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T02:53:53.637

我认为这是因为它是一个内联元素，如果您将其显示更改`inline-block`为填充不再重叠。[演示](http://jsfiddle.net/mowglisanu/cajH6/)

# java - 比较Java中的字符

> ID：12273777
> 
> 赞同：0
> 
> 时间：2012-09-05T02:35:34.003
> 
> 标签：java, comparison, character

我在比较 Java 中的字符时遇到问题。我试图找到一个有效的二进制数，所以我将一个带有二进制数字的字符串传递给一个函数，并确保它们是 0 或 1。我遍历并检查字符串中的每个字符，但是，我的函数告诉我它很糟糕（即使我知道我已经给它一个正确的二进制数）。

这是功能：

```
public boolean isValidBinary(String s) {
    //First we get the string length
    int strLen = s.length();
    //Now we loop through each character of the string
    for(int x = 0; x < strLen; x++) {
        //Assign the character to a variable each loopthrough
        char c = s.charAt(x);
        //Check if it's either a 0 or a 1
        if(c != '0' || c != '1') {
            return false;
        }
    }
    //This is reached when all char's have been evaluated as 0 or 1
    return true;
} 
```

我已经盯着这个问题很长一段时间了，一直无法弄清楚，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:39:29.973

这是一个逻辑错误。你的意思是`&&`代替`||`.

无论如何，您都可以为此使用正则表达式：

```
// must contain at least one digit, and only 0 or 1
public boolean isValidBinary(String s)
{
    return s.matches("^[01]+$");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:40:40.973

重新思考你内在条件的逻辑：`if(c != '0' || c != '1')`。您想在此处使用 AND `if ((c != '0') && (c != '1'))`：。这意味着如果*两个*条件都为真，那么输入应该被认为是无效的，即，如果它*不是 0****也不****是 1*`c` ，那么它就是一个无效字符。

 **考虑您的代码检查`1`字符的情况：它从 test: 的左侧开始`c != 0`。这是`true`，并且由于 OR 短路，整个条件的结果是`true`，并且您的函数返回`false`，即使当前正在测试的字符`1`，*也不应该*使输入无效。**

# crash - jvmti agent fatal error on linux: C [libc.so.6+0x7ae68] strcpy+0x18

> ID：12273779
> 
> 赞同：5
> 
> 时间：2012-09-05T02:36:01.003
> 
> 标签：crash, strcpy, jvmti

I have written a jvmti agent to trace method invocations. I code it with C and jvmti and jni functions. Our os is Fedora 15 and the agent is compiled into a `.so` file. When I test it with a non-trivial java program, it crashes and gives the following error message:

```
A fatal error has been detected by the Java Runtime Environment:
  SIGSEGV (0xb) at pc=0x4e8e4e28, pid=24294, tid=3065949040.
  JRE version: 6.0_32-b05.
  Java VM: Java HotSpot (TM) Server VM (20.7-b02 mixed mode linux-x86).
  **Problematic frame:
    C [libc.so.6+0x7ae68] strcpy+0x18.** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T21:48:31.073

> [IGSEGV](http://en.wikipedia.org/wiki/SIGSEGV)是 Signal Segmentation Violation 的缩写。**[在 POSIX 兼容的平台上，SIGSEGV 是当进程进行无效内存引用或分段错误](http://en.wikipedia.org/wiki/Segmentation_fault)**时发送给进程的信号。

您必须检查 JVMTI 代理中的指针。您很可能会进行一些不干净的指针操作。

# javascript - IE 9 compresses white space within XML DOM

> ID：12273780
> 
> 赞同：9
> 
> 时间：2012-09-05T02:36:04.887
> 
> 标签：javascript, xml, internet-explorer

I have a javascript routine that grabs an XML stream via AJAX and then parses it. It works fine in FF and Chrome but in IE 9, if there are consecutive Line Feeds within a node, IE compresses them into a space and one line feed.

Specifically, where retNode is an xml node, retNode.text has the compressed white space in IE, but includes all the characters in FF and Chrome.

I have tried writing my own routine to parse the XML, but that seems fragile and a waste of time. I tried using the PreserveWhitespace property, but that does not seem to be available in javascript. I tried using retNode.nodeValue instead of retNode.text, but nodeValue had no value.

I'd prefer a solution that does not use jquery because I don't know jquery, and I am not sure what other code I would need to add to make jquery work.

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T09:59:01.963

`preserveWhiteSpace`在 JavaScript 中可用。

您是否尝试过以下代码？

```
var xhr = new XMLHttpRequest();
xhr.responseXML.preserveWhiteSpace = true;
… 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:51:33.687

它应该只是您丢失的标签之间的空格。非标签之间的空格（例如一对标签中的字符串之间）应始终保留。

换句话说`<tag> </tag>`，将变为`<tag></tag>`而`<tag>foo bar</tag>`将保持不变。

如果您需要保留两个标签之间的空格，并且`preserveWhiteSpace`由于某种原因不适合您，那么我认为您必须尽可能放入`&#160;`您的 XML 源代码（`&nbsp;`您不能使用的数字版本，因为它是正常情况下的非法 XML 字符，即除非您定义了实体）

# java - StackOverflowError and random numbers

> ID：12273782
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:36:15.267
> 
> 标签：java, random, error-handling

I have a collection: [1, 2, 3, 4, 5, 6, 7, 8, 9] from which I need to generate a random number of unique elements e.g. 5, 3, 7, 9, next time: 4, 8\. My function works well but sometimes throws StackOverflowError because of recursive call on a function that generates random numbers and checks if there is no duplicates already. I wonder how I can prevent this from happening.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:39:08.243

One solution is to use iteration (a `for` or `while` loop) rather than recursion.

Another solution is to start by making a mutable copy of your collection, and whenever you select an element from it, *remove* that element so that there's no risk of re-selecting it. (But be sure you're making an actual copy of your collection, e.g. `new ArrayList<Integer>(originalCollection)`, so that you aren't removing elements from the original.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T02:39:57.727

您可能应该在不使用递归的情况下执行此操作。可能会更好的算法的粗略草图：

1.  创建一个空列表
2.  遍历源数组并将每个元素以 50% 的概率添加到列表中
3.  将列表转换为数组
4.  在数组上使用 Arrays.shuffle() 随机重新排序元素

那应该做的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T12:10:12.530

完整列表中的每个元素在特定元素集合中存在或不存在。这告诉我们使用二进制。

`0b000000000`映射到 [ ] 即所有数字都不存在。

`0b111111111`映射到 [1, 2, 3, 4, 5, 6, 7, 8, 9] 即所有数字。

两者之间的任何数字（被视为二进制）都将映射到整个集合的子集。

`0b001010101`映射到 [3, 5, 7, 9]

范围内的每个二进制数都将映射到一个唯一的子集。您的示例暗示排序可能很重要。如果是，那么您将不得不单独处理它。此方法最多可为您提供 2^9 = 512 种不同的组合。

# java - ActionListener only works for part of the method

> ID：12273785
> 
> 赞同：1
> 
> 时间：2012-09-05T02:36:48.933
> 
> 标签：java, swing, jpanel, listener, border-layout

Currently I have a JFrame 'window' with the layout set to BorderLayout. I have a panel for the west and center sections, with two alternating panels for south. In the west section I have 5 labels. In the center section I have 5 JTextField components. And in the south section i want to alternate between two panels (both FlowLayout) &(each one holds 2 separate buttons).

Right now I initialize and the south section has the correct two buttons, but when i call my event action listener only half of the method is called correctly. Behind the scenes i have the menu item connected to the listener, and it seems to work correctly. the clear text method works but changing the south panel does not

here are the panels and frame being initialized(they are initialized in the class constructor):

```
 myWindow = new JFrame();
    myWindow.setLayout(new BorderLayout());
    myWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    sPanel1.add(prevButton);
    sPanel1.add(nextButton);
    sPanel2.add(okButton);
    sPanel2.add(cancelButton);

    myWindow.add(sPanel1, BorderLayout.SOUTH);
    myWindow.add(wPanel, BorderLayout.WEST);
    myWindow.add(cPanel, BorderLayout.CENTER);
    //so here, at this line, i have tried the adding sPanel2 at the south position,
    //after i have added sPanel1\.  The result is that sPanel2 overrides sPanel1 (like i 
    //assumed it would).  However, the same doesnt work in the editAddEvent method    
     //below. both lines are called but only the cleartextfields method works.  
     //why is this?

  public class myEvent implements ActionListener{   
     @Override
     public void actionPerformed(ActionEvent arg0) {
        myWindow.add(sPanel2, BorderLayout.SOUTH);
        clearTextFields();  
        myWindow.revalidate();
        myWindow.repaint();
        Container content = myWindow.getContentPane();
        content.revalidate();
        content.repaint();
     }
}

public void clearTextFields(){
    fNameTxt.setText("");
    mNameTxt.setText("");
    lNameTxt.setText("");           
} 
```

the clear textfields method works perfectly, it clears my JTextFields

# javascript - Tricky screen sizing and scaling (on Javascript)

> ID：12273787
> 
> 赞同：0
> 
> 时间：2012-09-05T02:37:03.733
> 
> 标签：javascript, html, canvas, websocket

I have a tricky question that might just have a simple solution, although I trully don't see it now.

So, I've been working around HTML5 element and, obviously, doing the interaction methodology in JavaScript.

One of the objectives of this work is to be able to use a mobile device [MD] (iOS or Android, phone or tablet) as a remote controller for an application that will be served by another machine (eg. a laptop or external display) and both will be showing the same thing on each of the screens on different scales.

So, I wanna have an event occur when the canvas is 80% filled (or in this case, "erased" (which I already have by calculating the total number of [initial] pixels) and each device has a different count since the screen sizes/resolutions are different.

This is the tricky part: How will I be able to "scale" the MD pixel count and mirror that to the bigger screen?

For concrete measures, how will I be able to implement the following example:

I draw a line on the MD that goes for 300px wide, and for simplicity, let's say that this represents 10% of the MD canvas (which on both the screens is in fullscreen). I want the external monitor (which has a higher resolution) to mirror this event but on an appropriate scale so that those 10% on the MD represent the same (scaled) 10% of "canvas real estate"

Just in case the text is too confusing, I'll leave the code bellow:

```
function totalPix(x, y) {
    var total = x * y;
    var objective = (total * 80) / 100;
}

function canvasApp() {

//prevent from scrolling (no bouncing)
document.body.addEventListener('touchmove', function(event){
    event.preventDefault();
}, false);

if(!canvasSupport()) {
    alert("No canvas support on this device!");
    return;
} else if(!socketSupport) {
            alert("No websocket support on this device!");
        } else {

    //create canvas on every load (//TODO)
    var elemDiv = document.getElementById("content");
    var newElem = document.createElement("canvas");
    newElem.setAttribute("id", "frontscreen");
    elemDiv.appendChild(newElem);

    drawScreen();

    function drawScreen() {

        //Setup canvas
        var canvas = document.getElementById("frontscreen");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        totalPix(canvas.width, canvas.height);

        ctx = canvas.getContext("2d");

        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();

        //Foreach touchmove event, send position to server
        canvas.addEventListener('touchmove', function(event) {
            for (var i = 0; i<event.touches.length; i++) {
                var touch = event.touches[i];
                ctx.globalCompositeOperation = "destination-out";
                ctx.fillStyle = "white";
                ctx.beginPath();
                ctx.arc(touch.pageX, touch.pageY, 30, 0, 2*Math.PI, false);
                ctx.fill();
                ctx.stroke();
            }
        }, false); 
    window.onresize = function resizeCanvas() {drawScreen();};
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:48:09.783

如果我理解正确，这就像更改`<canvas>`元素的 HTML 样式属性的 size 属性一样简单。例如，假设您填写 300 x 300 像素。显示器 A 上的正方形，它占据了 10% 的屏幕空间（我知道，大显示器）。然后你在监视器 B 上加载相同的页面，它的大小是监视器 A 的两倍。（真的很大的监视器，请耐心等待。这是一个例子。）自然它只会占用屏幕空间的 5%。

如果您希望 300px 在所有屏幕上始终占据相同百分比的大小（但在画布上仍然是 300px），您可以执行以下操作：

```
var canvas = document.getElementById("mycanvas");
var heightAsPercent = 10;
var widthAsPercent = 10;
canvas.style.height = (heightAsPercent / 100) * screen.height;
canvas.style.width = (widthAsPercent / 100) * screen.width; 
```

这样，画布将*始终*占据屏幕的 10%，无论显示器宽度是 3000px 还是 6000px。为了清楚起见，我显然选择了非常冗长的变量名称，因此可以根据需要随意修改它们。

这样做的原因是您只是在修改画布的 CSS 属性，这只会影响它的呈现方式，而不是实际`<canvas>`数据。我偶然发现了这个小技巧，它让我发疯，直到我弄清楚它为什么这样做。现在它实际上派上了用场。:)

# java - 扫描器 nextLine() NoSuchElementException

> ID：12273794
> 
> 赞同：2
> 
> 时间：2012-09-05T02:38:31.020
> 
> 标签：java, minecraft, bukkit

我已经编写 Bukkit 插件有一段时间了，这个问题让我很困惑。我正在尝试使用扫描仪从文件中读取一行，并将“：”之前的行中的所有内容添加到 HashSet。每次尝试时，我都会收到 NoSuchElementException，如下所示：

```
21:01:01 [SEVERE] Could not pass event PlayerLoginEvent to ServerProtect
org.bukkit.event.EventException
        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.ja
va:341)
        at org.bukkit.plugin.RegisteredListener.callEvent(RegisteredListener.jav
a:62)
        at org.bukkit.plugin.SimplePluginManager.fireEvent(SimplePluginManager.j
ava:477)
        at org.bukkit.plugin.SimplePluginManager.callEvent(SimplePluginManager.j
ava:462)
        at net.minecraft.server.ServerConfigurationManagerAbstract.attemptLogin(
ServerConfigurationManagerAbstract.java:273)
        at net.minecraft.server.NetLoginHandler.d(NetLoginHandler.java:112)
        at net.minecraft.server.NetLoginHandler.c(NetLoginHandler.java:41)
        at net.minecraft.server.DedicatedServerConnectionThread.a(DedicatedServe
rConnectionThread.java:44)
        at net.minecraft.server.DedicatedServerConnection.b(SourceFile:29)
        at net.minecraft.server.MinecraftServer.q(MinecraftServer.java:578)
        at net.minecraft.server.DedicatedServer.q(DedicatedServer.java:213)
        at net.minecraft.server.MinecraftServer.p(MinecraftServer.java:474)
        at net.minecraft.server.MinecraftServer.run(MinecraftServer.java:406)
        at net.minecraft.server.ThreadServerApplication.run(SourceFile:539)
Caused by: java.util.NoSuchElementException: No line found
        at java.util.Scanner.nextLine(Unknown Source)
        at com.gmail.thecotlsdragon98.ServerProtect.AltAccounts.CheckForUsedIP(A
ltAccounts.java:49)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.bukkit.plugin.java.JavaPluginLoader$1.execute(JavaPluginLoader.ja
va:339)
        ... 13 more 
```

这是我尝试做我上面解释的课程。

```
package com.gmail.thecotlsdragon98.ServerProtect;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.HashSet;
import java.util.Scanner;
import org.bukkit.ChatColor;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerLoginEvent;
import org.bukkit.event.player.PlayerLoginEvent.Result;
import org.bukkit.event.server.PluginDisableEvent;
import org.bukkit.event.server.PluginEnableEvent;

public class AltAccounts implements Listener
{
    ServerProtect plugin;
    public AltAccounts(ServerProtect instance){
        plugin = instance;
    }
    File usersFile;
    FileWriter outputFile;
    PrintWriter out;
    Scanner in;
    HashSet<String> players = new HashSet<String>();
    StringBuffer buffer = new StringBuffer();
    @EventHandler
    public void newUsersFile(PluginEnableEvent event) throws IOException{
        if(event.getPlugin() == plugin){
            usersFile = new File("plugins\\ServerProtect\\users.yml");
            if(!usersFile.exists()){
                usersFile.createNewFile();
            }
        }
    }
    @EventHandler
    public void CheckForUsedIP(PlayerLoginEvent event) throws IOException{
        outputFile = new FileWriter(usersFile, true);
        out = new PrintWriter(outputFile);
        in = new Scanner(new FileReader(usersFile));
        String[] nameandIP;
        String name;
        String IP;
        String line = in.nextLine();
        while(in.hasNextLine() && !in.nextLine().isEmpty()){
            players.add(line.split(": ")[0]);
            if(!players.contains(event.getPlayer().getName())){
                out.println(event.getPlayer().getName() + ": " + event.getAddress().getHostAddress());
                out.close();
            }
        }
        if(!in.hasNextLine() || in.nextLine().isEmpty()){
            if(!players.contains(event.getPlayer().getName())){
                out.println(event.getPlayer().getName() + ": " + event.getAddress().getHostAddress());
                out.close();
                players.clear();
            }
        }
        if(!plugin.getConfig().getBoolean("alts.kick-on-login")){
            while(in.hasNextLine()){
                nameandIP = in.nextLine().split(": ");
                name = nameandIP[0];
                IP = nameandIP[1];
                if(event.getAddress().getHostAddress().equals(IP) && !event.getPlayer().getName().equals(name)){
                    for(final Player player : plugin.getServer().getOnlinePlayers()){
                        if(player.hasPermission("serverprotect.alts.notify")){
                            player.sendMessage(ChatColor.RED + event.getPlayer().getName() + " has the same IP as " + name + " (" + event.getAddress().getHostAddress() + ")");
                        }
                    }
                }
            }
        }
        else if(plugin.getConfig().getBoolean("alts.kick-on-login")){
            while(in.hasNextLine()){
                nameandIP = in.nextLine().split(": ");
                name = nameandIP[0];
                IP = nameandIP[1];
                if(event.getAddress().getHostAddress().equalsIgnoreCase(IP)){
                    event.setKickMessage("The IP address you've logged in with is used. Alternate account?");
                    event.setResult(Result.KICK_OTHER);
                }
            }
        }
    }
    public void Disable(PluginDisableEvent event)throws IOException{
        if(event.getPlugin() == plugin){
            in.close();
        }
    }
} 
```

我被告知我要调用 in.nextLine() 两次，当我询问如何修复它的建议时，他只是忽略了我。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:52:04.200

试试这个：

```
import java.io.*;
import java.lang.*;
import java.util.*;
public class test {
    public static void main(String[] args) {
        Scanner in = new Scanner(System.in);
        while(in.hasNextLine()) {
            String line = in.nextLine();
            String parse = line.substring(0, line.lastIndexOf(':'));
            System.out.println(parse);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T02:39:57.023

`in.nextLine()`您调用了两次，但只检查`hasNextLine()`了一次。

在第二次通话中，您可能有可用的线路。

玩家.add( `in.nextLine()`.split(":")[0]);

**怎么修？**

```
String tempLine = in.nextLine(); 
```

然后对这个字符串进行操作

# mysql - mysql utf8mb4 turkish character confusion

> ID：12273800
> 
> 赞同：0
> 
> 时间：2012-09-05T02:39:11.377
> 
> 标签：mysql, turkish

I am inserting some datas including turkish characters into a table and when I insert a data appearance of turkish characters confused me. For example for the character 'ğ', appearance on database is 'ð'. But when I get data and print it on the browser for testing this character shows up to be correct 'ğ' character. Do I have to worry about the situation ? (Btw I am using utf8mb4 as described in title)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T09:31:03.663

如果您使用 phpmyadmin 查看数据库条目，这是一个常见的误解。

您不必担心，您可以从 php.ini 和 phpmyadmin 的设置中进行配置。但正如你所说，这不是什么大问题。我建议您使用 toad 或 navicat for mysql 以获得更好的结果。

# android - 如何在android中组织这样的UI？

> ID：12273801
> 
> 赞同：0
> 
> 时间：2012-09-05T02:39:25.483
> 
> 标签：android, android-ui

我当前的 UI 包含 3 个活动/对话框
1\. 活动 A --- 一个列表视图和一个“添加”按钮，单击按钮时会显示活动 B。
2\. 活动 B --- 有关其布局，请参见[http://img835.imageshack.us/img835/9872/9120120905101922.png](http://img835.imageshack.us/img835/9872/9120120905101922.png)。选择“选择”时，将显示对话框C.
3\. 对话框 C --- 一个微调器或列表视图，供用户选择一个项目。

我想让流程更加紧凑和专业，因为整个流程包含 3 个活动/对话框的呈现，（实际上有 4 个活动/对话框，因为在活动 A 之前有一个活动 M！）

我现在选择的是把activity B改成一个对话框，把对话框C改成一个popup。但是正如我之前提到的，改变之后，总共还有4个activity/dialogs，所以这些改变没有多大意义.

我该怎么办？是否可以用单个对话框 D 替换活动 B 和对话框 C？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:51:59.100

为什么不能在活动 B 的确定/取消按钮下显示活动 C 的微调器/列表视图？最好我能说活动 C 只有一个元素，所以它会浪费很多空间（而 B 有很多可用空间）。

无论如何，我不会太担心在您的程序中有四个活动并强调将其优化到三个的复杂性。几乎任何设备都应该能够轻松处理这么多活动。

# iphone - sizewithfont:forwidth:linebreakmode

> ID：12273804
> 
> 赞同：3
> 
> 时间：2012-09-05T02:39:36.683
> 
> 标签：iphone, objective-c, ios, nsstring

Why doesn't this work? It always returns 18 no matter the length of the string. There is [this thread](https://stackoverflow.com/questions/3640558/always-getting-the-same-height-using-sizewithfontminfontsizeactualfontsizefor), but not a definitive answer.

```
 NSString * t = @"<insert super super long string here>";

    CGSize size = [t sizeWithFont:[UIFont systemFontOfSize:14.0] forWidth:285 lineBreakMode:UILineBreakModeWordWrap];

    NSLog(@"size.height is %f and text is %@", size.height, t); 
```

Thanks,

Todd

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T03:03:43.177

改为使用`sizeWithFont:constrainedToSize:lineBreakMode:`。

```
NSString * t = @"<insert super super long string here>";
CGSize constrainSize = CGSizeMake(285, MAXFLOAT);
CGSize size = [t sizeWithFont:[UIFont systemFontOfSize:14.0] constrainedToSize:constrainSize lineBreakMode:UILineBreakModeWordWrap];
NSLog(@"size.height is %f and text is %@", size.height, t); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-30T06:17:52.143

**弃用方法：NS_DEPRECATED_IOS(2_0, 7_0)**

```
- (CGSize)sizeWithFont:(UIFont *)font forWidth:(CGFloat)width lineBreakMode:(NSLineBreakMode)lineBreakMode NS_DEPRECATED_IOS(2_0, 7_0, "Use -boundingRectWithSize:options:attributes:context:"); 
```

例子

```
CGSize titleTextSize = [self.titleLabel.text sizeWithFont:self.myLabel.font forWidth:myLabelWidth lineBreakMode:NSLineBreakByTruncatingTail]; 
```

**新的方法**

利用 ：

```
- (CGRect)boundingRectWithSize:(CGSize)size
                       options:(NSStringDrawingOptions)options
                    attributes:(NSDictionary<NSString *,
                                        id> *)attributes
                       context:(NSStringDrawingContext *)context 
```

例子：

```
 // Create a paragraph style with the desired line break mode
    NSMutableParagraphStyle *paragraphStyle = [[NSMutableParagraphStyle alloc] init];
    paragraphStyle.lineBreakMode = NSLineBreakByTruncatingTail;

    // Create the attributes dictionary with the font and paragraph style
    NSDictionary *attributes = @{
                                 NSFontAttributeName:self.myLabel.font,
                                 NSParagraphStyleAttributeName:paragraphStyle
                                 };

    // Call boundingRectWithSize:options:attributes:context for the string
    CGRect textRect = [self.countLabel.text boundingRectWithSize:CGSizeMake(widthOfMyLabel, 999999.0f)
                                           options:NSStringDrawingUsesLineFragmentOrigin
                                        attributes:attributes
                                           context:nil]; 
```

[见苹果文档](https://developer.apple.com/library/ios/documentation/UIKit/Reference/NSString_UIKit_Additions/index.html#//apple_ref/occ/instm/NSString/boundingRectWithSize:options:attributes:context:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T07:56:14.223

```
CGSize size = [t sizeWithFont:[UIFont fontWithName:@"Arial-BoldMT" size:16.0] constrainedToSize:CGSizeMake(220,500) lineBreakMode:UILineBreakModeWordWrap]; 
```

# java - 为什么几乎所有数据库都不实现行缓存？

> ID：12273808
> 
> 赞同：2
> 
> 时间：2012-09-05T02:39:56.183
> 
> 标签：java, mysql, database, database-design, innodb

我注意到几乎所有数据库都没有在内部实现行缓存。我问这个问题是因为我发现有人[为 innodb 添加行缓存补丁](http://code.google.com/p/row-cache-for-innodb/)。至少，除了性能增益之外，它还有一个优势，即它对客户端是透明的。

是否有任何困难的技术原因阻止这样做，或者仅仅因为它对非常特定的访问模式有用？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T02:46:49.940

坦率地说，如果您多次获得同一行的相同版本，那么您做错了。作为一般规则，如果数据不太可能更改并且需要多次访问，则应缓存数据。鉴于此规则，如果在服务器端缓存数据库行有帮助，则意味着您为感兴趣的数据对数据库进行了太多往返。您应该在*客户端*缓存它以减少在往返旅行中。如果数据经常更改，因此您需要经常访问它，缓存*仍然*无济于事，因为缓存的数据已过期，必须重新执行查询。仅获取与缓存数据不同的数据无济于事；你必须弄清楚有什么不同，你'

最重要的是，大多数数据库都是为高并发性能而设计的。缓存一个人的大量结果集会消耗下一个人的大量结果集的可用资源，依此类推。在高用户数的情况下，构建缓存可能只会导致缓存数据被丢弃，以便为更多缓存数据腾出空间；它不能停留足够长的时间来使用。

# ios - 如何在 itunesconnect 上查看我的 ios 应用版本历史详细信息

> ID：12273811
> 
> 赞同：4
> 
> 时间：2012-09-05T02:39:59.723
> 
> 标签：ios, state, app-store-connect

现在我的应用程序已更新到 1.4 版，所以在 itunesconnect 上找不到我的应用程序的 1.0 版状态。现在我真的需要我的 1.0 版的详细信息，例如应用程序创建日期或……有没有人可以帮助我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T21:19:27.243

现在，任何应用程序的版本历史记录都可以在应用程序页面的版本历史记录下的 iTunes 应用程序中找到。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-01-04T15:48:32.160

如果有人想知道像 sensortower 这样的服务是如何获取这些数据的：

不幸的是，没有用于此的 API。iTunes 应用程序页面似乎从`versionHistory`内部的数组中获取了这些信息`its.serverData`。

对于包含此内容的响应，请求需要以下 HTTP 标头：

```
X-Apple-Store-Front : 143445-2,32
apple-originating-system : MZStore 
```

这里链接示例请求和响应：[https ://gist.github.com/catlan/30b2e87dedb00733e4e223e60fd08c63](https://gist.github.com/catlan/30b2e87dedb00733e4e223e60fd08c63)

关于注意事项`X-Apple-Store-Front`：

```
iTunes: 143445-2,32
Mac App Store: 143445-2,13
Volume Purchase Programme for Business: 143445-2,14
Volume Purchase Programme for Education: 143445-2,11
JSON: 143445-2,20 
```

这也应该回答（关闭？）问题：[App Store API for release notes/updates](https://stackoverflow.com/questions/24838765/app-store-api-for-release-notes-updates/28849246#28849246)和[How to access complete version history of iOS App](https://stackoverflow.com/questions/27141573/how-to-access-complete-version-history-of-ios-app)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-09T12:49:23.907

您可以使用 Sensortower 之类的服务。它定期列出每个应用程序的特性，因此您可以从那里获取这些信息。这可能特别有趣，如果您正在寻找第三方应用程序的信息，而您不可能登录到苹果开发中心或类似网站以获取有关*您的*应用程序的详细信息。

例如 Evernote 的详细信息：[https ://sensortower.com/ios/de/evernote/app/evernote/281796108](https://sensortower.com/ios/de/evernote/app/evernote/281796108)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T17:26:39.510

其实你可以通过一个中文网站[xinyou.com](http://xinyou.com)。

在顶部搜索框中按应用名称搜索，然后在应用页面上，在右侧向下滚动，您将看到按日期列出的更新历史记录。
单击版本号（其中任何一个）以查看历史记录。

也就是说，我不确定每个应用程序是否存在，并且仍在寻找等效的英文网站，并且某些版本更新以中文显示（这些可能是实际的中文更新，因为我只在真正流行的国际应用程序上看到它们（即[印象笔记](http://apps.xinyou.com/ios/subject/evernote/version)）。

希望这会有所帮助，并希望有人有更好的本地站点选项。

# ruby-on-rails - 无法在 Mountain Lion 上安装 pg gem

> ID：12273815
> 
> 赞同：8
> 
> 时间：2012-09-05T02:40:34.873
> 
> 标签：ruby-on-rails, macos, postgresql, osx-mountain-lion

升级到 Mountain Lion 后，我在使用 Rails 时遇到了很多麻烦。

到目前为止，尝试解决这些问题并在互联网上搜索了几个小时，我已经完成了以下操作，以确保我的系统在升级后具有运行 rails 的所有依赖项：

1.  我更新了我的 Homebrew 安装
2.  我更新了我的 RVM 安装
3.  我安装了 XCode 命令行工具
4.  [如前所述，](https://www.wheelhousecms.com/blog/2012/7/installing-ruby-rails-and-mongodb-on-mountain-lion)我安装了 GCC
5.  我将我的 Ruby 版本升级到

    > ruby 1.9.2p290（2011-07-09 修订版 32553）[x86_64-darwin10.8.0]

6.  我的 Rails 版本被验证为 Rails 3.2.6
7.  我还发现 Mountain Lion 在 Postgres 上有一些问题，所以我看到了[这篇文章](https://stackoverflow.com/questions/6770649/repairing-postgresql-after-upgrading-to-osx-10-7-lion?rq=1)，发现我需要将这一行添加到我的 Bash 配置文件中：

    ```
    export PATH="/usr/local/bin:/usr/bin:$PATH" 
    ```

现在我转到我升级之前在 Snow Leopard 上运行良好的 Rails 应用程序，当我`rails s`在命令行运行时，我收到以下错误：

```
AM@~/Documents/RailsWS/app0815 >gem install pg
 Building native extensions.  This could take a while...
 ERROR:  Error installing pg:
 ERROR: Failed to build gem native extension.
 /Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb
 checking for pg_config... yes
 Using config values from /usr/bin/pg_config
 checking for libpq-fe.h... *** extconf.rb failed ***
 Could not create Makefile due to some reason, probably lack of
 necessary libraries and/or headers.  Check the mkmf.log file for more
 details.  You may need configuration options.

 Provided configuration options:
--with-opt-dir
--with-opt-include
--without-opt-include=${opt-dir}/include
--with-opt-lib
--without-opt-lib=${opt-dir}/lib
--with-make-prog
--without-make-prog
--srcdir=.
--curdir
--ruby=/Users/AM/.rvm/rubies/ruby-1.9.2-p290/bin/ruby
--with-pg
--without-pg
--with-pg-dir
--without-pg-dir
--with-pg-include
--without-pg-include=${pg-dir}/include
--with-pg-lib
--without-pg-lib=${pg-dir}/lib
--with-pg-config
--without-pg-config
--with-pg_config
--without-pg_config
 /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:368:in `try_do': 
 The complier failed to generate an executable file. (RuntimeError)
 You have to install development tools first.
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:452:in `try_cpp'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:853:in `block in   find_header'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:693:in `block in checking_for'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:280:in `block (2  levels) in postpone'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:254:in `open'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:280:in `block in postpone'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:254:in `open'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:276:in `postpone'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:692:in `checking_for'
from /Users/AM/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/mkmf.rb:852:in `find_header'
from extconf.rb:41:in `<main>'

 Gem files will remain installed in /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.14.1 for inspection.
 Results logged to /Users/AM/.rvm/gems/ruby-1.9.2-p290/gems/pg-0.14.1/ext/gem_make.out 
```

当我去 Rails 应用程序并尝试`bundle install`在 pg 安装时失败。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-05T03:05:29.130

[从http://www.enterprisedb.com/products-services-training/pgdownload#osx](http://www.enterprisedb.com/products-services-training/pgdownload#osx)下载 postgresSQL 安装程序

然后让你的路径看起来像这样：

```
PATH=$PATH:/Library/PostgreSQL/9.0/bin/ gem install pg 
```

这样就行了！

**注意：**请在路径中正确指定您的 postgreSQL 安装版本。

### 更新（10/11/2015）（取自[Heroku](https://devcenter.heroku.com/articles/getting-started-with-rails4)）

**在带有 Homebrew 的 OS X 上：**

1.  使用以下命令安装 postgresql：

    `brew install postgresql`

2.  然后使用以下命令安装 gem：

    `gem install pg -- --with-pg-config=/usr/local/bin/pg_config`

**在带有 MacPorts 的 OS X 上：**

`gem install pg -- --with-pg-config=/opt/local/lib/postgresql84/bin/pg_config`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-08T05:41:46.763

正如 banditKing 在他的回答中所说，需要告诉 gem 在哪里可以找到 postgres 二进制文件。[您可以使用 Heroku ( http://postgresapp.com](http://postgresapp.com) ) 中出色且简单的 postgres.app 随附的二进制文件来安装此 gem 而不是 EnterpriseDb 版本。EnterpriseDB 版本很棒，但是对于开发机器来说是一个复杂的安装。

在您的系统上下载*Postgres.app*并将内部 bin 目录添加到您的路径。我把它放进去`/Applications/Postgres.app`，所以我用

```
gem install pg -- --with-pg-config=/Applications/Postgres.app/Contents/MacOS/bin/pg_config 
```

在 10.8.2、Ruby 1.9.3、pg-0.14.1 和 XCode CLI 工具上为我工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-14T18:38:46.923

或者，使用 Postgres 应用程序。IMO，这是在 Mac 上启动和运行 PostgreSQL 和 Rails 的最简单和最快的方法。

有关详细说明：[http ://blog.parsalabs.com/blog/2013/09/14/installing-postgresql-don-mac-os-x-and-using-it-as-your-rails-apps-database/](http://blog.parsalabs.com/blog/2013/09/14/installing-postgresql-don-mac-os-x-and-using-it-as-your-rails-apps-database/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-09T17:39:29.123

安装 Mavericks 后`bundle update`，在 pg gem 上抛出错误。

我使用 Brew 管理我的软件包，并且已经安装了 postgresql，但我仍然收到“no pg_config”错误。

解决方法是`brew uninstall postgresql`，然后`brew install postgresql`。之后我立即能够成功运行`bundle update`。

# javascript - 可排序和可删除的淘汰赛列表

> ID：12273818
> 
> 赞同：3
> 
> 时间：2012-09-05T02:40:45.200
> 
> 标签：javascript, jquery-ui, knockout.js

我有一个需要可拖动的列表。为简单起见，让项目只有“男孩”和“女孩”。我有另一个列表“朋友”，您可以将“男孩”和“女孩”拖入其中，然后设置名称、年龄、身高等属性。该列表还需要可排序（拖放）。

基本上我想通过拖入“男孩”或“女孩”来将项目添加到“朋友”列表中，但我不确定如何使用淘汰赛让两个列表进行交互。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T06:36:07.053

~~Ryan Niemeyer 写了一篇关于用淘汰赛拖放的精彩文章：~~

~~[http://www.knockmeout.net/2011/05/dragging-dropping-and-sorting-with.html](http://www.knockmeout.net/2011/05/dragging-dropping-and-sorting-with.html)~~

Ryan Niemeyer 为此目的编写了一个 Knockout 插件：

*   [https://github.com/rniemeyer/knockout-sortable](https://github.com/rniemeyer/knockout-sortable)

这是更新的博客条目：

*   [http://www.knockmeout.net/2012/02/revisiting-dragging-dropping-and.html](http://www.knockmeout.net/2012/02/revisiting-dragging-dropping-and.html)

# html - 如何绘制圆角朝向div内侧的div

> ID：12273821
> 
> 赞同：-1
> 
> 时间：2012-09-05T02:41:57.117
> 
> 标签：html, css

如果可能的话，这是我想使用 html5 和 css 创建的内容：

![红色对象是形状，其他一切都必须是透明的，所以背景将在它后面可见](../Images/fe7b630562be0c11fc9c2bd5999dd50b.png)

红色对象是形状，其他一切都必须是透明的，因此背景将是可见的。我想它可以使用 css 蒙版或圆角，但我无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T04:13:54.240

## 编辑：^([*建议透明背景解决方案*])

**CSS：**

```
.outer{
    width: 240px;
    background: rgba(0,0,0,0.0);
    height:240px;
    border-right: 120px solid red;
    border-bottom: 30px solid red;
    position: relative;
    z-index:1;
}

.outer:after {
    content: '';
    width: 240px;
    height:240px;
    border-radius: 0px 0px 50px 0px;
    -webkit-border-radius: 0px 0px 50px 0px;
    -moz-border-radius: 0px 0px 50px 0px;
    -o-border-radius: 0px 0px 50px 0px;
    -khtml-border-radius: 0px 0px 50px 0px;
    background: rgba(0,0,0,0.0);
    position: absolute;
    top: -30px;
    left: -30px;
    z-index:2;
    border: 30px solid #ccc;
} 
```

**​HTML**

 **```
<div class="outer"></div>​ 
```

[**一个工作演示**](http://jsfiddle.net/akhurshid/Nzjzj/embedded/result/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-05T14:08:13.983

这是使用 css 掩码解决此问题的有效解决方案。[工作示例](http://www.bozioko.cz/en)。单击左下角的“共享”或“新闻”以查看它的运行情况。从元素 ispector 禁用 #smallScaleHolder 的掩码图像以注意差异。

好的……这里有更好的解释……我做了一个这样的面具……![在此处输入图像描述](../Images/62910803a0fca734fe1bf3a8e151c4b4.png)

这是CSS：

```
 -webkit-mask-image: url(../img/sliders/mask.png);
    -o-mask-image: url(../img/sliders/mask.png);
    -moz-mask-image: url(../img/sliders/mask.png);
    mask-image: url(../img/sliders/mask.png);
     -webkit-mask-composite: copy; 
     overflow:hidden; 
```

现在它的所有子元素在黑色区域之外都不可见。

注意：css 掩码仅在 chrome 、 safari 和 ios 中受支持。**

# c# - C# process.start，我怎么知道进程是否结束？

> ID：12273825
> 
> 赞同：32
> 
> 时间：2012-09-05T02:42:37.670
> 
> 标签：c#, process

在 C# 中，我可以启动一个进程

> 进程.启动（程序.exe）；

如何判断程序是否仍在运行，或者是否已关闭？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-09-05T02:45:12.790

[MSDN System.Diagnostics.Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

*如果您现在*想知道，可以查看该`HasExited`属性。

```
var isRunning = !process.HasExited; 
```

如果这是一个快速的过程，请等待。

```
process.WaitForExit(); 
```

如果您在后台启动一个，请在将 EnableRaisingEvents 设置为 true 后订阅 Exited 事件。

```
process.EnableRaisingEvents = true;
process.Exited += (sender, e) => {  /* do whatever */ }; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-05T02:46:56.237

```
Process p = new Process();
p.Exited += new EventHandler(p_Exited);
p.StartInfo.FileName = @"path to file";
p.EnableRaisingEvents = true;
p.Start();

void p_Exited(object sender, EventArgs e)
{
    MessageBox.Show("Process exited");
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-05T02:46:31.853

`Process`如果您使用静态`Process.Start()`调用（或使用创建实例），请确保保存对象`new`，然后根据您的需要检查`HasExited`属性或订阅事件。`Exited`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-05T02:44:51.403

将事件处理程序分配给[Exited](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)事件。

该 MSDN 链接中有示例代码 - 我不会在这里重复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-05T02:46:40.157

查看[Process 类的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)。

特别是您可以收听一个事件（ [Exited ）。](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)

# python - 如何在for循环中删除列表中的元素

> ID：12273828
> 
> 赞同：0
> 
> 时间：2012-09-05T02:42:54.950
> 
> 标签：python, list

如何在for循环中删除列表中的元素？变量 a 不应该被重新分配。修改它但不要创建新的。下面的代码不能正常工作

```
a = [1,2,2,3,2,1,4]
i = 0
for j in a:
    print(j)
    if(j<=2):
        print('deleting ',i)
        del a[i]
    else:
        i+=1     
print(a) #[3, 2, 1, 4] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T02:44:55.743

您可以遍历列表的*副本*

```
for j in a[:]: 
```

解决您问题的另一种方法是

```
a[:] = [j for j in a if j>2] 
```

这里`a[:]`表示`a`应该用列表推导替换的内容

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T02:45:06.690

```
a[:]=filter(lambda x:x<=2,a) 
```

使用过滤器...

或列表理解

```
a[:] = [itm for itm in a if itm > 2] 
```

\编辑不破坏原始指针......虽然我不知道为什么......似乎不太完美的设计

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T02:46:58.950

您不应该删除当前正在迭代的列表的元素。它可能会弄乱迭代的索引 - 如果列表在 python 迭代它时任意更改，它如何知道哪个元素应该是下一个迭代的“正确”元素？

相反，使用 filter() 或列表推导，就像 Joran 建议的那样，或者遍历列表的副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T03:00:56.477

如果从列表中过滤元素是您在循环中唯一要做的事情，那么其他答案中的建议可能是最好的，但如果您正在做很多其他事情并且最后只是偶然删除了一些项目，迭代列表的索引可能是比`filter`列表理解更好的方法：

```
for i in range(len(a)-1, -1, -1): # iterate in reverse order
    val = a[i]

    # do a bunch of stuff with val and/or i

    if (some_condition(val)):
        a.pop(i) 
```

迭代是反向的，因此我们不必担心删除项目时索引会混乱。

# asp.net-mvc-3 - 如何防止 Html.ActionLink 在 URL 中编码非 ASCII 字符

> ID：12273829
> 
> 赞同：0
> 
> 时间：2012-09-05T02:43:03.030
> 
> 标签：asp.net-mvc-3, routes, url-encoding

在我下面的代码中，当 postSummary.SEOFriendlyTitleInURL 包含中文字符时，这些字符将被编码在 url 中。

```
@Html.ActionLink(
    postSummary.Title,
    "View",
    new
    {
        id = postSummary.Id,
        friendlyTitle = postSummary.SEOFriendlyTitleInURL
    }) 
```

尽管该 url 在 Google Chrome 和 Firefox 中会显示为原始字符，但在 IE 中它是一个编码字符串。我想阻止 ActionLink 方法的默认编码行为，因为我可以直接在地址栏中输入那些未编码的字符。所以我认为它们在 URL 中是合法的。

我可以简单地手动构建链接，但最好是生成一致性：

```
<a href="/post/@postSummary.SEOFriendlyTitleInURL/@postSummary.Id">@postSummary.Title</a> 
```

**编辑：**

我当前的解决方案：通过使用 Html.ActionLink 和 Server.UrlDecode 方法，我告诉它不要编码任何字符，而不是阻止框架只编码非 ASCII 字符。如果某些字符确实需要进行百分比编码，它们只能出现在“friendlyTitle”片段中。因为该片段仅用于提高可读性，所以我将此类字符替换为破折号。

此类替换字符包括

*   URI 中保留字符的列表。见[https://www.rfc-editor.org/rfc/rfc3986#section-2.2](https://www.rfc-editor.org/rfc/rfc3986#section-2.2)
*   单引号和双引号
*   制表符

尽管如此，非 ASCII 字符在某些时候应该进行百分比编码，因为它们在 URI 中无效，最好在生成 URL 时完成。但是通过观察 Fiddler 在通过包含中文字符的 URL 请求页面时，似乎该 URL 将被自动编码（可能通过网络浏览器）。为了可读性，我选择让 Web 浏览器完成编码工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:28:27.503

`<a>`就标签中生成的内容而言，浏览器之间没有区别；唯一的区别在于浏览器的显示方式。这里没有什么可以改变的；`Html.ActionLink()`正确编码/未编码。

# java - Git 中的签署者、执行者、帮助者和改进者

> ID：12273831
> 
> 赞同：0
> 
> 时间：2012-09-05T02:43:37.913
> 
> 标签：java, git

我正在研究 Git 存储库，我需要为每个提交获取所有开发人员的姓名。我知道要获取作者姓名和提交者姓名，我们使用`--pretty="format:%an - %cn"`. 但是，还有其他开发人员的名称，例如签名者，代理者，帮助者帮助者和改进者；我怎样才能得到这些数据，如果还有其他功能？

我想将每个提交的作者姓名和提交者姓名保存在 Java 变量中。此外，如果此提交有以前的功能之一，我也想保存它。是否有可能做到这一点，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T07:16:35.740

这通常保存在您的问题跟踪系统中（例如 Jira）。您通常可以查看工单的历史记录，看看谁选中了哪个复选框并将问题转移到新状态。Git 只跟踪提交者和作者。

如果您已将此信息存储在提交消息本身中，您应该能够在 git log 输出中使用 grep 来提取该信息。如果您对提交消息使用一些约定以使其更容易，这将有所帮助。

# java - Java interface - Generics

> ID：12273834
> 
> 赞同：3
> 
> 时间：2012-09-05T02:44:08.657
> 
> 标签：java, generics

I have two interfaces. An interface A, and interface B, which extends interface A. Now, I have class which likes to keep reference of object that either implements A or B. And I would like to provide setter for it. I tried below, but getting type mis match exception.

```
public interface A {
}

public interface B extends A {
}

public class AB {
private Class<? extends A> object;

public void setObject(Class<? extends A> o){
   this.object = o;
}
} 
```

So basically, I would like setObject method to accept an object that either implements interface A or B.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T02:48:30.887

Simple answer:

Type it as `A`: `setObject(A a)`.

A class that implements `B` also implements `A`. Full code:

```
public class UsesA {
  private A a;

  public void setObject(A a){
    this.a = a;
  }
} 
```

Now, if you really want to work with `B`, you'd type it as `B`, which would also allow you to treat it as an `A`, since `B` inherits from it:

```
public class UsesB {
  private B b; // can call A's methods on this field

  public void setObject(B b) {
    this.b = b;
  }
} 
```

But now you can't pass an `A` (static) reference to `setObject`. If you really want to do this, then you'd need to first downcast it as a `B`, which could fail at runtime. Generics will not improve on this.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T02:49:17.337

If you have an object implementing `B`, it will also be an instance of `A`. Because of this, you can make `setObject` accept any `A`, which will allow instances of `A` or `B` to be passed to it.

```
public void setObject(A a){
    this.object = a;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T03:07:39.720

Your code doesn't actually match up with your question. You've stated that

> I have class which likes to keep reference of object that either implements A or B

but the field (called `object`) is actually a Class, not an Object (instance of a Class).

*Your code works* if you were truly trying to have your setter accept any interface that extends A. But as you probably realize now from the other answers, you actually want an instance of A :)

```
public class AB {
    private Class<? extends A> type; // renamed from object for clarity

    public void setObject(Class<? extends A> type) {
        this.type = type;
    }

    @Test
    public void testSetter() {
        setObject(A.class); // no errors
        setObject(B.class); // no errors
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T02:53:37.647

As suggested earlier if you will use (A a) it will work since B is a type of A. Hence child class can always be represents it's parent.

# azure - Azure 虚拟机/Windows Server 2012 和“此网页不可用”错误

> ID：12273835
> 
> 赞同：0
> 
> 时间：2012-09-05T02:44:23.133
> 
> 标签：azure, azure-virtual-machine

我刚刚创建了一个 azure 虚拟服务器 2012 并制作了一个简单的 html 页面。我在上面安装了 IIS，并在我的门户中添加了一个端点，将其命名为 web 并将其设置为 tsp、80、80，没有负载平衡。

但是当我尝试访问我的域时，我收到一条错误消息，提示页面不可用。我可以登录到我的虚拟服务器并在里面运行页面。所以它有效。但它阻止了外部访问。

服务器上还有一条防火墙规则，允许端口 80 上的传入流量。

我可能在某处遗漏了一步，但我找不到任何有关如何执行此操作的说明。这主要是我这边的猜测工作。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T05:53:45.153

您很可能忘记在 Windows Server 的本地防火墙上允许端口 80 用于传入连接。

**更新**

您是否将“您的域”正确映射到 VM 实例的 canapp.net 域？还是您直接使用 yourname.cloudapp.net ？

# regex - Regex to remove special characters. Can't get rid of trailing ellipsis

> ID：12273836
> 
> 赞同：1
> 
> 时间：2012-09-05T02:44:33.203
> 
> 标签：regex, postgresql

In the context of a postgres query, this -

```
lower(regexp_replace('If...', '[^\w\s]', '')) 
```

gives me this -

`'if..'` (quotes mine)

As you can see, only one of the three periods gets trimmed. Can someone tell me what I must add to my regexp to get rid of the other two or any other special characters that might be trailing in this way?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T02:54:41.983

You are probably looking for the fourth, optional parameter of [`regexp_replace()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER):

```
SELECT regexp_replace('If...', '[^\w\s]', ''**, 'g'**);
```

`g` .. for "globally", i.e. replace every match in the string, not just the first.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-25T11:56:14.773

```
SELECT regexp_replace('If, stay real....', '[.]{2,}$', '.', 'g'); 
```

> {m,} a sequence of m or more matches of the atom.

More than 2 dot in the string will be replaced with one dot.
further reference: [https://www.postgresql.org/docs/current/functions-matching.html](https://www.postgresql.org/docs/current/functions-matching.html)

# mysql - 为什么分开写和读更好？

> ID：12273844
> 
> 赞同：2
> 
> 时间：2012-09-05T02:46:11.907
> 
> 标签：mysql, mongodb, cluster-computing

我不明白为什么单独的读写比在一台服务器上读写更好。

比如我有一个mysql集群，有三台机器：node1、node2、node3。

一种可能的架构是：

*   所有对 node1 的写请求，但对 node2 和 node3 的所有读请求。

第二种可能的架构是：

*   所有这三个节点都处理写入和读取。

我们可以在架构一中看到对 node1 的写入压力非常大，所以我更喜欢架构二。

另外，mongodb为什么要分离对主节点的写入和对辅助节点的读取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:27:50.133

这是 MySQL 和 MongoDB 的规模问题。在具有小数据集和低流量的最简单应用程序中，将所有写入和读取都转到一个服务器为您提供了一个简单的架构。在具有低容量写入的高容量读取应用程序中，复制到多个读取节点的单个写入节点使您能够通过添加另一个节点来扩展读取。在高读写量的应用程序中，您可能会考虑分片（在 MySQL 中您可以自己完成或找到帮助工具），在 mongodb 中您运行 mongos 为您处理分片。分片将根据您定义的某些键将记录放在特定实例上。该键将确定每条记录应存储在哪个实例上。您可以想象，分片管理比单个服务器进行读/写访问更复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T19:41:31.973

MySQL Cluster 还支持自动分片——默认情况下对主键进行散列，但用户可以输入自己的键以提供更多的分布意识。集群中的每个节点都是master，内部负载均衡会将负载分布到节点之间

虽然水平很高，但此处发布的简短演示向您介绍了 MySQL 集群中分片的概念： [http ://www.oracle.com/pls/ebn/swf_viewer.load?p_shows_id=11464419](http://www.oracle.com/pls/ebn/swf_viewer.load?p_shows_id=11464419)

# android - 切换音乐的 mc 播放/暂停按钮不起作用。音乐库中为导出 (AS) 链接的音乐

> ID：12273845
> 
> 赞同：0
> 
> 时间：2012-09-05T02:46:27.750
> 
> 标签：android, actionscript-3, button, mp3

我是 Actionscript 3 和使用 Flash CS6 的新手。

-我正在尝试播放/暂停名为 countrymeadow 的 20 分钟 mp3

-countrymeadow.mp3 链接到库中的 Export for actionscript (countrymeadow)。

*   playpause mc 按钮在按钮内的第 1 帧（播放）和第 10 帧（暂停）停止。

*   AS3 在下面，但它不起作用，因为 mc 播放暂停按钮在测试时不断在“播放”和“暂停”之间切换，而且没有播放声音。

任何帮助表示赞赏，并提前非常感谢。

```
//set appearance of button, mode to true
playpause_mc.gotoAndStop("play");
playpause_mc.buttonMode = true;

//sound is stopped after loaded
var isPaused:Boolean = true;

//saves current position of sound
var currPos:int = 0.00;

var theSound:countrymeadow = new countrymeadow();
snd.play(); 

var soundCnl:SoundChannel = new SoundChannel();

//Listener updates after sound loads, and stops           soundtheSound.addEventListener(Event.COMPLETE, onComplete, false, 0, true);
function onComplete(evt:Event):void {
    //Stop loaded sound
    soundCnl.stop();
}

// movie clip button control
playpause_mc.addEventListener(MouseEvent.CLICK, clickHandler);
function clickHandler(event:MouseEvent):void {

    if(isPaused){
        //change state to playing, and play sound from position
        isPaused = false;
        soundCnl = theSound.play(currPos); 

        //reverse the appearance of the button
        playpause_mc.gotoAndStop("pause")

        //if sound completes while playing, run function
        soundCnl.addEventListener(Event.SOUND_COMPLETE, soundCompleteHandler);

    }else{
        //it's playing, so save position and pause sound
        currPos = soundCnl.position;
        isPaused = true;
        soundCnl.stop();

        //change the appearance of the buttons
        playpause_mc.gotoAndStop("play")
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:07:48.037

SoundChannel`position`是一个`Number`变量。那是范围 0 到 1。但是你设置了`int`变量。`int`不是浮点类型。因为您已明确声明为`int`类型。即使当你变成浮点初始化，转换为`int`类型。

![在此处输入图像描述](../Images/bc2b4dc7a500ae77e897965adb53a79e.png)

你应该遵循这个。并且您的 clickHandler 函数进行了一些更正。

```
var currPos:Number = 0.0;

soundCnl.addEventListener(Event.SOUND_COMPLETE, soundCompleteHandler);
function clickHandler(event:MouseEvent):void {

    if(isPaused){
        //change state to playing, and play sound from position
        isPaused = false;
        soundCnl.play(currPos); 

        //reverse the appearance of the button
        playpause_mc.gotoAndStop("pause")

    }else{
        //it's playing, so save position and pause sound
        currPos = soundCnl.position;
        isPaused = true;
        soundCnl.stop();

        //change the appearance of the buttons
        playpause_mc.gotoAndStop("play")
    }
} 
```

* * *

测试代码：

```
var n:int = 0.0;

n = 0.5;

trace("n: " + n); //you may expected 0.5, but return 0. 
```

# java - AbstractStringBuilder 类中的 expandCapacity 方法

> ID：12273850
> 
> 赞同：3
> 
> 时间：2012-09-05T02:46:42.413
> 
> 标签：java

我正在查看这个类的源代码，我从被调用的 append 方法开始`StringBUffer.append();`

```
public AbstractStringBuilder append(String str) {
   if (str == null) str = "null";
       int len = str.length();
   if (len == 0) return this;
   int newCount = count + len;
   if (newCount > value.length)
      expandCapacity(newCount); // newcount is the new volumn of a char array
    str.getChars(0, len, value, count);
    count = newCount;
    return this;
  } 
```

然后我更深入地研究`enpandCapacity`方法

```
void expandCapacity(int minimumCapacity) {
    int newCapacity = (value.length + 1) * 2; //here value is a char array 
    if (newCapacity < 0) { // Why is newCapacity less than 0?
                           // Is that possible? When it will be possible?
        newCapacity = Integer.MAX_VALUE;
    } else if (minimumCapacity > newCapacity) {
        newCapacity = minimumCapacity;
    }
    value = Arrays.copyOf(value, newCapacity);
} 
```

为什么`newCapacity`小于0？那可能吗？什么时候可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:51:42.573

是的; *一旦超过 int 类型 ( 2^31 - 1* )的最大值，有符号整数就会变为负数。如果你看一下，他们基本上将容量限制在`Integer.MAX_VALUE`. 类似的问题[在这里](https://stackoverflow.com/questions/12270788/whats-causing-java-hailstone-sequence-to-crash-in-my-program/12270870#12270870)。

# vb.net - 在这种情况下我将如何实现多线程？可能吗？

> ID：12273851
> 
> 赞同：0
> 
> 时间：2012-09-05T02:46:45.807
> 
> 标签：vb.net, multithreading, visual-studio-2010, backgroundworker

我有一个带有列表视图的表单，用户也可以添加任务。然后用户可以单击一个按钮，然后应用程序会逐个执行列表视图中的每个任务并执行它。

这些任务更像是实际完成任务的指令。我通过在其中包含一个循环的类来执行此操作，该循环遍历每个项目，然后它完成我为每个项目（指令）设置的任务。为了开始解析，我在调用该函数的表单上有一个按钮。IE: RunTask(listview1, 1) - 基本上所有这些都启动了我在课堂上的循环，指定了列表视图和从哪个项目开始。

除了屏幕锁定外，一切都很完美，所以我无法实现停止功能来阻止应用程序解析这些列表视图项目。我只是不明白如何在没有交叉线程的情况下实现这一点，因为我想单独运行的线程将始终访问此列表视图。重新设计程序以摆脱列表视图是不可行的。我尝试了 application.doevents 虽然它引起了太多人的错误。我一直在研究如何解决这个问题，但我不知道。希望有人能有所启发。

此外，我已经添加了一个后台工作人员来解决这个问题，尽管我显然必须设置 checkforillegalcrossthreadcalls = false 并且我知道这并不聪明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T05:11:23.237

尝试做这样的事情。将您的列表视图转换为一组与 UI 无关的值。像这样：

```
 string[] values =
            this
                .listView1
                .Items
                .Cast<ListViewItem>()
                .Select(x => x.Text)
                .ToArray(); 
```

然后您可以使用并行任务库在后台运行您的任务：

```
 var tokenSource = new System.Threading.CancellationTokenSource();
        var token = tokenSource.Token;

        var task = System.Threading.Tasks.Task.Factory
                .StartNew(() => RunTasks(values, 1), token); 
```

如果您需要取消任务，您可以这样做：

```
 tokenSource.Cancel(); 
```

但是要在任务完成时处理 UI 更新，请执行以下操作：

```
 task.ContinueWith(r =>
        {
            /* When compete code */
        }); 
```

确保调用 UI 更新，以便它们在 UI 线程上运行。

抱歉，我没有在 VB.NET 中编写此代码。我的 VB 生锈了。

# css - 如何使 WebGL 画布透明

> ID：12273858
> 
> 赞同：19
> 
> 时间：2012-09-05T02:47:04.987
> 
> 标签：css, canvas, transparency, webgl, alpha

是否可以使用具有透明背景的**WebGL 画布？**我想通过画布看到网页的内容。

这就是我现在所拥有的：http: [//i50.tinypic.com/2vvq7h2.png](http://i50.tinypic.com/2vvq7h2.png)

如您所见，WebGL 画布后面的文本是不可见的。当我在 CSS 中更改 Canvas 元素的样式并添加

```
opacity: 0.5; 
```

该页面将如下所示：http: [//i47.tinypic.com/302ys9c.png](http://i47.tinypic.com/302ys9c.png)

这几乎是我想要的，但不完全是 - 由于 CSS alpha 设置导致的文本颜色当然不是黑色，蓝色形状的颜色与第一张图片中的蓝色不同。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-05T22:14:43.080

WebGL 默认是透明的。这是一个示例

```
const gl = document.getElementById("c").getContext("webgl");
gl.clearColor(0.5, 0, 0, 0.5);
gl.clear(gl.COLOR_BUFFER_BIT);
```

```
pre {
    padding-left: 50px;
    font-family: sans-serif;
    font-size: 20px;
    font-weight: bold;
}

canvas {
    z-index: 2;
    position: absolute;
    top: 0px;
    border: 1px solid black;
}
```

```
<pre>
Some 
text
under
the
canvas
</pre>
<canvas id="c"></canvas>
```

请注意，浏览器假定画布中的像素代表 PRE-MULTIPLIED-ALPHA 值。这意味着例如，如果您将清除颜色更改为 (1, 0, 0, 0.5)，您将获得在 HTML 中其他任何地方都看不到的东西。

我的意思是预乘 alpha 意味着 RGB 部分已经乘以 alpha 值。因此，如果您为 RGB 开始 1,0,0 并且您的 alpha 为 0.5。然后，如果将 RGB 乘以 alpha，RGB 将得到 0.5、0、0。这就是浏览器默认的期望。

如果 WebGL 中的像素是 1,0,0,0.5，这对浏览器来说毫无意义，你会得到奇怪的效果。

参见例如

```
const gl = document.getElementById("c").getContext("webgl");
gl.clearColor(1, 0, 0, 0.5);
gl.clear(gl.COLOR_BUFFER_BIT);
```

```
pre {
    padding-left: 50px;
    font-family: sans-serif;
    font-size: 20px;
    font-weight: bold;
}

canvas {
    z-index: 2;
    position: absolute;
    top: 0px;
    border: 1px solid black;
}
```

```
<pre>
Some 
text
under
the
canvas
</pre>
<canvas id="c"></canvas>
```

请注意黑色文本已变为红色，即使您认为 0.5 的 alpha = 黑色文本的 50% 和红色 WebGL 画布的 50%。那是因为红色没有被预乘。

您可以通过确保在 WebGL 中创建的值表示预乘值来解决此问题。或者您可以告诉浏览器您的 WebGL 像素在创建 webgl 上下文时未预乘

```
const gl = canvas.getContext("webgl", { premultipliedAlpha: false }); 
```

现在 1,0,0,0.5 像素再次起作用。例子：

```
const gl = document.getElementById("c").getContext("webgl", {
  premultipliedAlpha: false,
});
gl.clearColor(1, 0, 0, 0.5);
gl.clear(gl.COLOR_BUFFER_BIT);
```

```
pre {
    padding-left: 50px;
    font-family: sans-serif;
    font-size: 20px;
    font-weight: bold;
}

canvas {
    z-index: 2;
    position: absolute;
    top: 0px;
    border: 1px solid black;
}
```

```
<pre>
Some 
text
under
the
canvas
</pre>
<canvas id="c"></canvas>
```

采用哪种方式取决于您的应用程序。许多 GL 程序需要非预乘 alpha，而 HTML5 的所有其他部分都需要预乘 alpha，因此 WebGL 为您提供了两种选择。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-05T16:56:51.180

WebGL 默认支持 alpha 透明度，但您必须使用它。`gl.clearColor(0, 0, 0, 0)`最重要的是，在您`gl.clear`操作之前，请确保您已将透明颜色设置为透明。

如果要绘制半透明对象，则需要进行混合操作和排序绘制，但看起来您只希望未绘制区域是透明的，以上就足够了。

# javascript - 获取来自 jquery 的数据

> ID：12273863
> 
> 赞同：2
> 
> 时间：2012-09-05T02:47:37.443
> 
> 标签：javascript, jquery, ajax

我想在网页上显示数据，假设我在服务器上有一个跟踪器，可能需要很长时间，但我想显示数据。

如果我这样做：

```
 $.ajax({
         url: '/cgi-bin/trace.cgi',
         dataType: 'text',
         async: true,
         cache: false,
         success: function (response) {
           $('#traceOut').append(response);
         }
        }); 
```

只有当我们完成 cgi 请求时才会调用它。

我可以直接使用 XMLHttpRequest、onreadystatechange 和 xmlhttp.readyState==3 来完成这在 Firefox 中可以正常工作，但在 Chrome 中它只会在达到 2k 时转储数据。

我如何在 jQuery 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T07:25:03.327

这是可能的，通过轮询。棘手的部分将是协调服务器端多个用户的过程。我将在下面解释工作流程。

### 方法

```
/**
 * Polls a URL until server indicates task is complete,
 * then sends a final request for those results.
 * 
 * Requires jQuery 1.4+.
 */
function poll(params) {

    // offer default params
    params = $.extend({
        error: function(xhr, status, err) {
            console.log('Network error: ' + status + ', ' + err);
        },
        progress: function(prog) {
            console.log(prog);
        },
        timeoutMillis: 600000,    // 10 minutes
        intervalMillis: 3000      // 3 seconds
    }, params);

    // kickoff
    _poll(params);

    function _poll(params) {
        $.ajax({
            url: params.url,
            type: 'GET',
            dataType: 'json',
            timeout: params.timeoutMillis,
            data: 'action=poll',
            success: (function(response, status, xhr) {
                if ('progress' in response) {
                    params.progress('Progress: ' + response.progress);
                }
                if ('status' in response) {
                    if (response.status == 'pending') {
                        // slight delay, then poll again
                        // (non-recursive!)
                        setTimeout((function() {
                            _poll(params);
                        }), params.intervalMillis);
                    }
                    else if (response.status == 'cancelled') {
                        params.progress("Task was cancelled");
                    }
                    else {
                        params.progress("Task complete");
                        // done polling; get the results
                        $.ajax({
                            url: params.url,
                            type: 'GET',
                            timeout: params.timeoutMillis,
                            data: 'action=results',
                            success: params.success,
                            error: params.error
                        });
                    }
                }
            }),
            error: params.error
        });
    }
} 
```

### 示例用法

```
poll({
    url: '/cgi-bin/trace.cgi',
    progress: function(prog) {
        $('body #progress').text(prog);
    },
    success: function(response, status, xhr) {
        $('body').html(response);
    }
}); 
```

### 工作流程

此方法将向服务器发送请求，参数“action”设置为“poll”。CGI 脚本应该启动它的后台任务，在用户会话中保持一些状态，并使用 JSON 格式的字符串进行响应：

```
{"status": "pending", "progress": "0%"} 
```

浏览器将重复发出这些“action=poll”请求，直到响应指示完成。CGI 脚本必须跟踪任务的进度并相应地响应浏览器。这将涉及会话处理和并发：

```
{"status": "pending", "progress": "25%"}
{"status": "pending", "progress": "50%"}
{"status": "pending", "progress": "75%"}
{"status": "complete"} 
```

然后浏览器将发出“action=results”请求以接收后台任务的最终有效负载。在这个例子中，它只是 HTML：

```
"<p>The answer is: 42</p>" 
```

# google-chrome - 山狮“三指点按查找字典”在 Chrome 上的某些站点中不起作用

> ID：12273864
> 
> 赞同：2
> 
> 时间：2012-09-05T02:47:46.977
> 
> 标签：google-chrome, web, osx-mountain-lion

山狮支持通过用三个手指敲击单词来查找字典。我们的网站（[http://www.imeigu.com](http://www.imeigu.com)、[http://xueqiu.com](http://xueqiu.com)）在 Google Chrome 中不支持此功能，但其他网站（例如 stackoverflow）确实支持。我们网站中是否有任何错误配置破坏了这一点？

Hackernews 也不支持这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T14:57:28.543

我注意到这些网站都是中文的，您是否从系统偏好设置/语言和文本/输入法安装了中文输入法？

此外，词典应用程序仅支持简体中文作为语言类型。

# windows - 有没有办法仅将 stderr 重定向到 stdout（而不是将两者结合起来），以便可以通过管道传输到其他程序？

> ID：12273866
> 
> 赞同：33
> 
> 时间：2012-09-05T02:47:50.690
> 
> 标签：windows, batch-file

我在 Windows`CMD.EXE`环境中工作，并希望更改 的输出`stdout`以匹配的输出，`stderr`这样我就可以在没有文件中介的情况下将错误消息传递给其他程序。

我知道这个`2>&1`符号，但它结合`stdout`并`stderr`成为一个单一的流。

我在想的是这样的：

```
program.exe 2>&1 | find " " 
```

但这结合了 stdout 和 stderr 就像：

```
program.exe | find " " 2>&1 
```

我意识到我可以做...

```
program 2>file
type file | find " "
del file 
```

但这不具备`program | find " "`某种符号的灵活性和力量。这样做需要`program`在可以处理该输出之前完成其输出。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-05T03:34:09.257

有趣的问题:-)

CMD 处理从左到右的重定向。您想首先将 2 (stderr) 重定向到 &1 (stdout)，然后将 1 (stdout) 重定向到其他东西。此时stderr仍将被重定向到之前的stdout定义。管道仍然可以使用标准输出的旧定义（现在包含标准错误）。

如果您不关心标准输出，那么您可以重定向到 nul

```
program.exe 2>&1 1>nul | find " " 
```

如果要将标准输出捕获到文件，然后重定向到文件

```
program.exe 2>&1 1>yourFile | find " " 
```

如果您仍想在控制台上看到标准输出，但您只想通过管道将标准错误传送到 FIND，那么您可以将 1 重定向到 con：

```
program.exe 2>&1 1>con: | find " " 
```

请注意，stdout 和 con: 的原始定义之间存在细微差别。例如，`cls >con:`不清除屏幕，而是在屏幕上打印一个有趣的字符。

如果您使用第三个（最初未使用的）文件句柄，则可以真正交换 stdout 和 stderr。1 和 3 将包含 stderr 的原始定义，2 将包含 stdout 的原始定义。

```
program.exe 3>&2 2>&1 1>&3 | find " " 
```

实际上，每次执行重定向时都会定义一个额外的文件句柄。原始定义保存在第一个可用的未使用文件句柄中。假设在发出上述命令之前没有任何重定向。`3>&2`不保存 3 的原始定义，因为 3 之前没有定义。但是`2>&1`将stderr的原始定义保存在4中（3已经用过），`1>&2`将stdout的原始定义保存在5中。

所以从技术上讲，不需要 3 的显式重定向来交换 stderr 和 stdout

```
program.exe 2>&1 1>&3 | find " " 
```

`2>&1`将 stderr 保存在 3 中，并将 2 重定向到 &1（stdout）。`1>&3`将标准输出保存在 4 和 1 被重定向到 &3 (stderr)。

但是，只有在您确定在发出命令之前尚未定义 3 时，上述操作才能正常工作。在我之前的代码示例中明确定义 3 会更安全。

请参阅[为什么我的 stderr 重定向在命令完成后没有结束？我该如何解决？](https://stackoverflow.com/questions/9878007/how-to-permanently-redirect-standard-error-back-to-the-console-again/9880156#9880156)对于一些非常疯狂的重定向冒险:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T03:34:37.420

从查看[http://support.microsoft.com/kb/110930](http://support.microsoft.com/kb/110930)看来您想要`2>&1 1>NUL`. 因此，以下内容应该适合您：

```
test.exe 2>&1 1>NUL | find "someErrorString" 
```

# c# - Visual Studio 可扩展性包 2010 和 2012。有没有办法为两者提供一个包？

> ID：12273867
> 
> 赞同：1
> 
> 时间：2012-09-05T02:47:55.180
> 
> 标签：c#, visual-studio-2010, visual-studio-2012

不久前，我为 Visual Studio 2010 创建了一个 Visual Studio 包/插件（对于那些好奇的人：http: [//visualstudiogallery.msdn.microsoft.com/ea23f9a7-a942-45b2-87e6-5df6ff0444ff](http://visualstudiogallery.msdn.microsoft.com/ea23f9a7-a942-45b2-87e6-5df6ff0444ff)）。如果我尝试下载它并将其安装在 Visual Studio 2012 中，它不起作用，我收到版本错误。

所以我的第一个想法是看看如果我尝试将它移植到 2012 会发生什么。我下载并安装了 VS2012 RC SDK，基本上在一个单独的解决方案中重新创建了整个东西，一切正常。我注意到，我必须引用的许多程序集 (Microsoft.VisualStudio.*) 现在都是版本 11，而不是版本 10（原因很明显）。复制并粘贴所有代码后，我让它在 Visual Studio 2012 中正常工作。

我现在的问题是：是否可以为多个版本的 Visual Studio 提供一个 .vsix 文件（我猜不是。）如果没有，那么上传不同版本的正确方法是什么？我可以上传 .vsix 的两个版本吗？Visual Studio 中的加载项管理器会自动选择正确的管理器吗？我是否需要创建一个新包，例如“Visual Pastie 2012”？只是寻求一些指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T04:25:44.110

重命名 VSIX 包以为其提供 ZIP 扩展名并打开它。您会找到一个名为 extension.vsixmanifest 的文件。在这个 XML 文件中，您会发现一个名为 SupportedProducts 的元素，它应该类似于以下内容，以便在 VS2012 中工作。

```
 <SupportedProducts>
    <VisualStudio Version="11.0">
      <Edition>Pro</Edition>
    </VisualStudio>
  </SupportedProducts> 
```

高温高压

# c# - 如何foreach所有控制器和动作？

> ID：12273868
> 
> 赞同：0
> 
> 时间：2012-09-05T02:47:54.833
> 
> 标签：c#, asp.net, .net, asp.net-mvc

如标题

我想使用这样的语法：

```
allControllers.Find(x=>x.Name=="HomeController") 
```

我想在应用程序启动时使用 LINQ 向操作添加属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T06:45:11.797

我认为您可以使用反射来获取所有控制器。[此](https://stackoverflow.com/questions/3680609/reflect-over-list-of-controllers)链接可能会有所帮助。然后使用反射来获取该类型的实例（请参阅激活器）。

# scala - Scala：将 span 与模运算一起使用

> ID：12273872
> 
> 赞同：0
> 
> 时间：2012-09-05T02:48:17.517
> 
> 标签：scala, math, modular

我有一个`List[Int]`从 1 到 10 的列表，并且想要制作一个`List[List[Int]]`包含两个`List[Int]`的列表：一个包含偶数的列表，另一个包含奇数的列表。结果应该是这样的：

```
List(List(2,4,6,8,10),List(1,3,5,7,9)) 
```

我尝试了这些事情：

```
1.to(10).toList.span((x:Int) => x % 2 == 0) 
```

和

```
val lst = 1.to(10).toList; lst span (_%2==0) 
```

然而，这些都不起作用。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:50:40.030

您需要使用的方法是`partition`，而不是`span`：

```
scala> (1 to 10).partition(_ % 2 == 0)
res0: (IndexedSeq[Int], IndexedSeq[Int]) = (Vector(2, 4, 6, 8, 10),Vector(1, 3, 5, 7, 9)) 
```

既然你想要一个`List[List[Int]]`，你可以这样做：

```
val lst = (1 to 10).toList
val (evens, odds) = lst.partition(_ % 2 == 0)
val newList = List(evens,odds) // List(List(2, 4, 6, 8, 10), List(1, 3, 5, 7, 9)) 
```

该`span`方法只能用于在单个点拆分序列：

```
scala> (1 to 10).span(_ < 5)
res1: (Range, Range) = (Range(1, 2, 3, 4),Range(5, 6, 7, 8, 9, 10)) 
```

当您尝试`lst.span(_ % 2 == 0)`时，程序发现第一项 1 没有通过测试 ( `_ % 2 == 0`)，因此所有元素都放在了第二个列表中，第一个没有留下。

# android - 在 Android 中监控传入的 SMS 消息

> ID：12273875
> 
> 赞同：1
> 
> 时间：2012-09-05T02:48:45.313
> 
> 标签：android, sms

我有这个程序将尝试监控传入的 SMS 消息。但是当我尝试在模拟器中运行我的程序并尝试发送 SMS 消息时，它可以工作。但是当我在手机中安装我的程序时，它不起作用。

问题是什么？

我也想在后端运行程序。怎么做？

顺便说一句，以下是此示例应用程序的全部代码。

谢谢

RJ

* * *

```
import java.io.BufferedWriter;
import java.io.FileWriter;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.SmsMessage;
import android.util.Log;

public class MySMSMonitor extends BroadcastReceiver
{
    private static final String ACTION = "android.provider.Telephony.SMS_RECEIVED";

    @Override 
    public void onReceive(Context context, Intent intent) 
    {
        if(intent!=null && 
                intent.getAction()!=null && 
                ACTION.compareToIgnoreCase(intent.getAction())==0)
        {
            Object[]pduArray= (Object[]) intent.getExtras().get("pdus");
            SmsMessage[] messages = new SmsMessage[pduArray.length];

            for (int i = 0; i<pduArray.length; i++) {
                messages[i] = SmsMessage.createFromPdu ((byte[])pduArray [i]); 
            }
            Log.d("MySMSMonitor","SMS Message Received.");
        }
    }
} 
```

* * *

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="spy.Frandy.com"
      android:versionCode="1"
      android:versionName="1.0">
    <uses-sdk android:minSdkVersion="6" />
    <uses-permission android:name="android.permission.SEND_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".TelephonyDemo"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <receiver android:name=".MySMSMonitor"> <intent-filter>
            <action android:name="android.provider.Telephony.SMS_RECEIVED"/> </intent-filter>
        </receiver>

    </application>
</manifest> 
```

* * *

```
import android.app.Activity; 
import android.os.Bundle; 
import android.telephony.SmsManager; 
import android.view.View; 
import android.view.View.OnClickListener; 
import android.widget.Button; 
import android.widget.EditText; 
import android.widget.Toast;

public class TelephonyDemo extends Activity
{
    @Override 
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main); 
        Button sendBtn = (Button)findViewById(R.id.sendSmsBtn);

        sendBtn.setOnClickListener(new OnClickListener(){
            @Override public void onClick(View view) {
            EditText addrTxt = (EditText)TelephonyDemo.this.findViewById(R.id.addrEditText);

            EditText msgTxt = (EditText)TelephonyDemo.this.findViewById(R.id.msgEditText);
            try { 
                sendSmsMessage(
                        addrTxt.getText().toString(),msgTxt.getText().toString()); 
                Toast.makeText(TelephonyDemo.this, "SMS Sent",
                        Toast.LENGTH_LONG).show(); 
            } catch (Exception e) {
                Toast.makeText(TelephonyDemo.this, "Failed to send SMS", Toast.LENGTH_LONG).show();
                e.printStackTrace();
            }
        }});
    }

    @Override 
    protected void onDestroy() {
        super.onDestroy();
    }

    private void sendSmsMessage(String address,String message)throws Exception {
        SmsManager smsMgr = SmsManager.getDefault(); 
        smsMgr.sendTextMessage(address, null, message, null, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:42:43.463

我将假设您提供的小细节是它在模拟器而不是您的实际手机上工作的原因；可能是另一个冲突的应用程序在将消息广播到您的应用程序之前拦截了这些消息。

尝试`android:priority="1000"`在您的应用清单中添加接收器的意图过滤器（一千是您认为必要的任何数字，如果需要可能会更高）

```
<intent-filter android:priority="1000" >
            <action android:name="android.provider.Telephony.SMS_RECEIVED" />
</intent-filter> 
```

有关 -[意图过滤器优先级的更多信息](http://developer.android.com/guide/topics/manifest/intent-filter-element.html#priority)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T04:48:51.933

我只是坚持你使用`ContentObserver`和注册`content://sms`Uri 并`type`使用

```
cusor.getString(cusor.getColumnIndex("type")); // 1 = SMS Received 
                                               // 2 =  SMS Sent 
```

此外，您可以轻松地从您获取的游标中获取所需的数据。[`Here`](http://katharnavas.wordpress.com/2012/01/18/listening-for-outgoing-sms-or-send-sms-in-android/)是相同的博客。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T04:25:26.043

试试这个：

```
<receiver android:name=".MySMSMonitor"
              android:permission="android.permission.BROADCAST_SMS">

      <intent-filter android:priority="2">
        <action android:name="android.provider.Telephony.SMS_RECEIVED" />
      </intent-filter>
    </receiver> 
```

# android - 如何在 Android 查询中使用子字符串

> ID：12273876
> 
> 赞同：0
> 
> 时间：2012-09-05T02:48:59.640
> 
> 标签：android, android-contentprovider

我需要比较此类代码中电话号码的最后 10 位数字：

```
String selectionClause =  ContactsContract.CommonDataKinds.Phone.NUMBER+ " = ?";
String[] selectionClauseArgs = { callerId };
Cursor people = resolver.query(
ContactsContract.CommonDataKinds.Phone.CONTENT_URI, projections,
            selectionClause, selectionClauseArgs, null); 
```

所以`selectionClause`应该像

```
String selectionClauseArgs = "substr("+CommonDataKinds.Phone.NUMBER+",-1,10) = ?"; 
```

但我不确定在`SQLLite`查询时是否可以使用此类查询`ContentProviders`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T01:30:15.510

试试这个解决方案，我自己测试过，应该可以工作。

```
//substr(string,-10, 10) take last 10 characters.
String selectionClause = "substr(" + ContactsContract.CommonDataKinds.Phone.NUMBER + ",-10, 10) =?";
String[] selectionClauseArgs = { callerId };
Cursor people = resolver.query(
ContactsContract.CommonDataKinds.Phone.CONTENT_URI, projections,
            selectionClause, selectionClauseArgs, null); 
```

也可以`substr(COLUMN_NAME,-10)`用来取最后 10 个字符。

注意：对于 function `substr(x,y,z)`，`y`是开始字符，如果 y 为负数，则从 . 的右侧开始计数`x`。`z`是从 y 位置开始的字符数。

# .htaccess - .htaccess RewriteRule 正在更改地址栏中的 URL，而我不希望它这样做

> ID：12273881
> 
> 赞同：3
> 
> 时间：2012-09-05T02:49:53.020
> 
> 标签：.htaccess, mod-rewrite

好的，首先，我想使用 .htaccess 使我的 URL 更漂亮，而我以前从未这样做过。（我正在本地机器上开发一个网站并使用 EasyPHP 12.1 查看页面）

如果我输入 **/localhost/me/about/**我希望它在 不更改地址栏中的 URL 的情况下提供**/localhost/me/about.php的内容。**

如果我输入 **/localhost/me/about.php**我希望它提供该文件的内容，然后更改地址栏以读取 **/localhost/me/about/**

到目前为止，这是我的整个 .htaccess 文件，是的，它位于我目录的根目录中，与所有 .php 文件位于同一目录中：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^(.*)/$ http://localhost/me/$1.php 
```

这成功地从**localhost/me/about/**重定向到**localhost/me/about.php**（它也适用于我的所有其他页面）。问题是，我不希望在地址栏中更改 URL。我在网上看到的任何地方，我都看到如果我确实想要更新地址栏，我应该在第三行的末尾添加 [R] 标志。我没有标志，但地址栏中的 URL 仍在更改。我错过了什么？有没有我可以添加的标志来强制它不改变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:58:43.450

您必须`[L]`在第三行末尾使用标志。该链接将在内部转发，因此您可以保留`localhost/me/about/`在地址栏中。

# mysql - MySQL Group_Concat 按 ID 区分

> ID：12273884
> 
> 赞同：3
> 
> 时间：2012-09-05T02:50:32.327
> 
> 标签：mysql, sql, distinct, group-concat

是否可以`group_concat`按不同的 ID 记录：

`GROUP_CONCAT(Column2 BY DISTINCT Column1)`

我需要从`column2`不同的值中获取值`column1`。因为第 2 列中有重复值，所以我不能使用 distinct on `column2`。

对此有什么想法吗？谢谢！

**编辑 1**

样本表记录：

```
ID  Value
1   A
1   A
2   B
3   B
4   C
4   C 
```

使用`GROUP_CONCAT`我想要的 [ `GROUP_CONCAT(Value BY DISTINCT Id)`]，我将有一个输出：

`A, B, B, C`

**编辑 2**

不知何故让我的`group_concat`工作：

`GROUP_CONCAT(DISTINCT CONCAT(Id, '|', Value))`

这将通过不同的 id 显示连接的值，只需要在某处摆脱 Id。您可以在没有该`concat`功能的情况下执行此操作，但我需要分隔符。这可能不是一个好的答案，但无论如何我都会发布它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T02:59:13.047

试试这个，（*最简单的方法*）

```
SELECT GROUP_CONCAT(VALUE)
FROM
(
    SELECT DISTINCT ID, VALUE
    FROM TableName
) a 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/6c058/3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:03:48.147

`GROUP_CONCAT`函数支持`DISTINCT`表达式。

```
SELECT id, GROUP_CONCAT(DISTINCT value) FROM table_name GROUP BY id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T03:00:29.643

这应该有效：

```
SELECT GROUP_CONCAT(value) FROM (SELECT id, value FROM table GROUP BY id, value) AS d 
```

# python - 计算 Python Flask 中每个页面的执行时间

> ID：12273889
> 
> 赞同：20
> 
> 时间：2012-09-05T02:51:17.747
> 
> 标签：python, flask

使用 Python 的 Flask 库计算每个页面加载的执行时间的好方法是什么？

我正在考虑在 views/__ init__.py 中放置一个启动计时器：

```
@app.before_request
def before_request():
  g.start = time.time() 
```

但是我会将计时器的末尾部分放在哪里来计算差异，以及如何将它放入我的 html 模板的页脚中？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-05T03:08:03.923

把它放在`teardown_request`函数中：

```
@app.teardown_request
def teardown_request(exception=None):
    diff = time.time() - g.start
    ... 
```

在`teardown_request`您不允许更改响应中，如果您想在响应中使用计算出的字符串，请使用`after_request`：

```
@app.after_request
def after_request(response):
    diff = time.time() - g.start
    if (response.response):
        response.response[0] = response.response[0].replace('__EXECUTION_TIME__', str(diff))
    return response 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-08-16T10:15:38.110

其他答案基本上是正确的，但现在已经过时了。

以下适用于 Python 3.6 / 3.7 和 Flask 1.0.2：

```
import time
from flask import g

@app.before_request
def before_request():
    g.start = time.time()

@app.after_request
def after_request(response):
    diff = time.time() - g.start
    if ((response.response) and
        (200 <= response.status_code < 300) and
        (response.content_type.startswith('text/html'))):
        response.set_data(response.get_data().replace(
            b'__EXECUTION_TIME__', bytes(str(diff), 'utf-8')))
    return response 
```

通过使用`response.set_data`，Flask 将正确更新内容长度。另请注意字节字符串的使用和编码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-23T15:33:24.177

您还需要更新 content-length 标头，否则浏览器会感到不安（Chrome 似乎会给出不可预测的结果）。

```
@app.after_request
def after_request(response):
    diff = time.time() - g.start
    if app.debug:
        print "Exec time: %s" % str(diff)

    if (response.response):
        response.response[0] = response.response[0].replace('__EXECUTION_TIME__', str(diff))
        response.headers["content-length"] = len(response.response[0])

    return response 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T14:55:49.220

我在使用 Peter Farmer 的回答提供静态文件时遇到了“管道损坏错误”，以及重定向问题（HTTP 301），所以我调整了提供的代码，如果有帮助的话。

```
@app.after_request
def after_request(response):
    diff = int((time.time() - g.start) * 1000)  # to get a time in ms

    if (response.response and response.content_type.startswith("text/html") and response.status_code==200):
        response.response[0] = response.response[0].replace('__EXECUTION_TIME__', str(diff))

    return response 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-13T04:52:55.873

试试这个：[https ://code-maven.com/flask-display-elapsed-time](https://code-maven.com/flask-display-elapsed-time)

```
import time
from flask import Flask, request, render_template, g
app = Flask(__name__)

@app.before_request
def before_request():
   g.request_start_time = time.time()
   g.request_time = lambda: "%.5fs" % (time.time() - g.request_start_time)

@app.route("/")
def main():
    return render_template('main.html') 
```

和模板html，如：

```
<html>
<head>
</head>
<body>
<h1>Show elapsed time</h1>

<hr>
Elapsed time: {{ g.request_time() }}
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-03-31T15:04:07.207

[这个 elapsed 属性在这里](https://docs.python-requests.org/en/latest/api/#requests.Response.elapsed)怎么样？

这是解决方案

```
>>> import requests
>>> r = requests.get('https://google.com')
>>> r.elapsed.total_seconds()
0.216452
>>> r.elapsed.seconds
0
>>> r.elapsed.microseconds
216452 
```

# struts2 - Strut2：这里不是根据请求创建动作吗？

> ID：12273890
> 
> 赞同：1
> 
> 时间：2012-09-05T02:51:25.787
> 
> 标签：struts2

将 Struts 2.1.6 与 Tiles 一起使用。

我注意到我的 Struts 2 操作中有一些奇怪的行为。我在其中一个操作中设置了一个断点（比如 view()）。当我第一次启动应用程序服务器时，单击我的 Web 应用程序中执行此操作的链接，调试器在断点处停止，我可以解决问题，发生异常并在 UI 上显示消息。

但是，当我再次单击同一个链接时，调试器不会命中断点，并且 UI 会显示相同的错误消息。我单击其他链接和其他调试点工作完全正常。当我再次单击相同的 URL 时，会显示相同的消息。我必须重新启动服务器并再次重复该过程。

有什么东西被缓存在某处吗？您认为没有创建新的 struts 动作实例吗？我该如何解决这个问题？我还没有发布任何代码，因为我不确定您可能需要哪些具体信息......

我为了分页目的在会话中存储了一些对象，这可能是问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:16:08.023

好吧，我从您的描述中读到的似乎问题出在您的代码中。每个请求 struts2 创建一个新的动作类实例以及请求和响应并将它们放在值堆栈中，所以无论上次执行的结果是什么，一个新的请求总是会创建一个新的实例。

根据框架架构创建新实例，因为 Action 也可用作数据传输对象（模型）。

我建议你检查你的配置，看看究竟是哪里出了问题。

作为旁注，您是否使用 Strts2-spring 插件，使用您需要设置的插件，`scope=prototype`否则 spring 默认情况下将创建单例动作实例，并且将一次又一次地使用相同的动作实例

# parsing - Common Lisp 的词法分析器和解析器生成器

> ID：12273892
> 
> 赞同：8
> 
> 时间：2012-09-05T02:51:58.820
> 
> 标签：parsing, common-lisp, lex

你能推荐 Common Lisp 的词法分析器和解析器生成器吗？我在 CLiki 上看到了以下列表，但列表中的大多数似乎都处于 alpha 阶段：

*   [http://www.cliki.net/LEXER](http://www.cliki.net/LEXER)
*   [http://www.cliki.net/parser%20generator](http://www.cliki.net/parser%20generator)

因此，如果您可以与他们中的任何一个分享您的好或坏经验或推荐其他替代方案，这将是有帮助的。我更喜欢与其他语言的传统 lex/yacc 工具类似的工具，但也欢迎其他方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T02:58:54.200

有[smug](https://github.com/drewc/smug) ([文档](http://common-lisp.net/~dcrampsie/smug.html))，它提供了“功能性”解析器，据说类似于 Haskell 的一些解析库。

此外，如果您正在寻找 Lex/Yacc 风格的解析，请查看[lispbuilder](http://code.google.com/p/lispbuilder/wiki/Welcome)，它具有看起来成熟的 lexer 和 yacc 包。

# jquery - Primefaces 回调发送带有“&”的 JSON 数据失败

> ID：12273894
> 
> 赞同：0
> 
> 时间：2012-09-05T02:52:01.477
> 
> 标签：jquery, json, primefaces

在测试期间，如果带有 JSON 数据的 HTTP 响应包含“&”，primefaces 会失败，如果我删除“&”它可以工作。我发送的数据是一个 URL，我需要以编码格式发送 url 吗？如果任何数据（不是 url）包含“amp”或任何类型的此类字符，是否会发生此问题？在这种情况下，最好的方法是什么。

# 带有回调的命令链接

```
<h:form prependId="false" id="getAllTopics" style="display:none;">
        <p:commandLink action="#{topicController.listAllTopics}" id="topicListAllCmdLink" value=""
            oncomplete="javascript:renderTopic(xhr, status,args)" />
    </h:form> 
```

# JS函数

```
function renderTopic(xhr,status,args){
        jsonArray=[];
        console.log(args.topicJSON);
        jsonArray = $.parseJSON(args.topicJSON);
   .....
} 
```

来自 Google 开发者工具包的响应

```
<partial-response><changes><update id="javax.faces.ViewState"><![CDATA[4297043168621098325:5437886159631978839]]></update><extension ln="primefaces" type="args">{"topicJSON":"[{\"topicBody\":\"http://www.youtube.com/watch?v=m3ZyU98N3Fk&feature=relmfu \",\"videoAudioUrl\":\"\",\"topicGuid\":5600,\"userGuid\":0,\"imageURL\":\"\",\"topicOwnUserName\":\"srikanth marni\",\"topicCommentList\":[],\"topicUpdateTime\":1346817736000}]"}</extension></changes></partial-response> 
```

# 控制台错误

```
Uncaught TypeError: Cannot read property 'topicJSON' of undefined circle_topic.js.jsf:150
renderTopic circle_topic.js.jsf:150
PrimeFaces.ab.oncomplete circle.jsf:175
k.complete primefaces.js.jsf:1
b.Callbacks.bv jquery.js.jsf:16
b.Callbacks.bE.fireWith jquery.js.jsf:16
bF jquery.js.jsf:23
b.ajaxTransport.send.bv 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-17T09:54:32.237

目前（v.5.2）primefaces 部分响应编写器不会为 XML 转义 JSON，这会导致字符 '<'、'>'、'&' 等出现问题。

为了让它工作，我修补了 org.primefaces.context.PrimePartialResponseWriter 中的 encodeCallbackParams 方法，如下所示，而 XML 是 org.json.XML：

```
private void encodeCallbackParams(Map<String, Object> params) throws IOException, JSONException {

if (params != null && !params.isEmpty()) {

    startExtension(CALLBACK_EXTENSION_PARAMS);
    write("{");

    for (Iterator<String> it = params.keySet().iterator(); it.hasNext();) {
    String paramName = it.next();
    Object paramValue = params.get(paramName);

    if (paramValue instanceof JSONObject) {
        String json = ((JSONObject) paramValue).toString();
        json = XML.escape(json);
        write("\"");
        write(paramName);
        write("\":{");
        write(json.substring(1, json.length() - 1));
        write("}");
    } else if (paramValue instanceof JSONArray) {
        String json = ((JSONArray) paramValue).toString();
        json = XML.escape(json);
        write("\"");
        write(paramName);
        write("\":[");
        write(json.substring(1, json.length() - 1));
        write("]");
    } else if (isBean(paramValue)) {
        String json = new JSONObject(paramValue).toString();
        json = XML.escape(json);
        write("\"");
        write(paramName);
        write("\":");
        write(json);
    } else {
        String json = new JSONObject().put(paramName, paramValue).toString();
        json = XML.escape(json);
        write(json.substring(1, json.length() - 1));
    }

    if (it.hasNext()) {
        write(",");
    }
    }

    write("}");
    endExtension();
}
} 
```

# macos - 在 Mac OS X 中轻松进行 GUI 编程。针对 Windows 平台

> ID：12273896
> 
> 赞同：1
> 
> 时间：2012-09-05T02:52:13.483
> 
> 标签：macos, user-interface

我有一个朋友有入门级的编程背景，正在寻找一个免费的**GUI 框架**（IDE、GUI 工具包和 GUI 设计器）：

*   他可以在**Mac OS X**上使用来构建**Windows**应用程序
*   它非常**易于**使用。

他对成为程序员不感兴趣，但想为他的工作构建一个应用程序（与 CS 无关）。

什么是一些好的 GUI 框架/程序。他可以使用的语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:54:39.967

在 Mac 上，我不得不推荐在 Xcode 中用 Objective-C 编写 Cocoa 应用程序。Xcode 可以免费下载和使用，如果您想将应用程序提交到 Mac App Store，您需要付费。

我个人每天都使用 Xcode，我认为它是一个很棒的 IDE。目前编译器支持 Obj-C、C++、C 甚至更多（不确定）。更重要的是，为了满足您的需求，Xcode 很好地将您的代码与其内置的“界面构建器”集成在一起，以帮助您快速轻松地创建一个漂亮的 UI。

**注意：** Xcode 包含一个新的编译器功能 (ARC) 自动引用计数，它是为新用户创建的。您可以学习该语言，而不必担心手动内存管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T06:27:59.480

[Qt 包括 Qt Creater 和 Qt Designer](http://qt.nokia.com/products/)值得一试。

特别是，如果您的应用最终应该跨平台运行，在手机或其他嵌入式设备上运行。Qt 本身支持 C++，但也可以与 Python ( [PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro) ) 和可能其他语言的 3rd-party 扩展一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T14:08:35.570

你的朋友应该考虑使用[PySide](http://www.pyside.org/) ，它是已经提到的[Qt GUI 框架](http://qt.nokia.com/)的 Python 绑定。

使用 PySide，您可以使用 Qt 工具以交互方式创建 GUI 元素并在 Python 中编写应用程序逻辑，Python 因其简单性和直观性而经常受到非程序员（以及程序员！）的青睐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T02:58:33.590

Xcode 包括一个用于本机控件和视图的 WYSIWYG 编辑器。这以前是一个名为 Interface Builder 的单独程序，但编辑器在版本 4 中被移至 Xcode IDE。

AppKit 是它在大多数情况下使用的框架——这就是 Objective-C。它得到了很好的支持。您的朋友也可以使用它来编辑源代码以及构建和调试应用程序。如果他想以编程方式编写 UI，Xcode 和 AppKit 也是不错的选择。

# jquery - Jquery自动完成和全局数组

> ID：12273898
> 
> 赞同：3
> 
> 时间：2012-09-05T02:52:34.647
> 
> 标签：jquery, jquery-ui, jquery-autocomplete, jquery-widgets

您好，我正在尝试使用 Jquery UI Autocomple，但遇到了一些问题。我正在使用一个由函数填充的全局数组。但是自动完成功能无法使用。这是我想如何使用这个小部件的一个小例子。

```
 <!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="plugins/jquery-ui-1.8.23.custom/css/ui-lightness/jquery-ui-1.8.23.custom.css"/>
        <script type="text/javascript" src="plugins/jquery-ui-1.8.23.custom/js/jquery-1.8.0.min.js"></script>
        <script type="text/javascript" src="plugins/jquery-ui-1.8.23.custom/js/jquery-ui-1.8.23.custom.min.js"></script>
        <script type="text/javascript">
            var data = [];
            $(document).ready(function(){
                //var data1 = ["Luis","DJ","Jon","Les","Jimmy"];
                $("#autocomp").autocomplete({
                    source: data
                });
            });
            function Load(){
                data =  ["luis","dj","jon","les","jimmy"];
            }
            function Alert(){
                alert(data);
            }
        </script>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body onload="Load()">
        <div>
            Type:<input type="text" id="autocomp"/>
            <button onclick="Alert()">test</button>
        </div>
    </body>
</html> 
```

感谢您的回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:08:22.430

初始化后修改源需要重新设置，所以你的Load函数变成这样：

```
 function Load(){
            data =  ["luis","dj","jon","les","jimmy"];
           $('#autocomp').autocomplete("option","source",data);
 } 
```

[带有演示的 jsfiddle](http://jsfiddle.net/nPZRc/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T03:10:44.187

`<body onload="Load()">` 使用 jquery 的 .ready() 或 Load()。两者都做只会让你感到困惑，因为它们确实发生在不同的时间。[.ready 文档](http://api.jquery.com/ready/)提到两者都使用不是一个好主意，前两段进一步解释了它们确实发生在不同的时间。

[自动完成文档](http://jqueryui.com/demos/autocomplete/#option-source) 提到，如果您更改数据列表，则需要重置它。

话虽如此，请决定您是要 onload 还是 .ready() 并在其中设置数据列表变量:)

```
$(document).ready(function(){
  if(!data){
data = ["Luis","DJ","Jon","Les","Jimmy"];
}
 $("#autocomp").autocomplete({
   source: data
   });
}); 
```

# git - 使用 Git 将文件的不同版本保存在本地与主存储库中

> ID：12273904
> 
> 赞同：9
> 
> 时间：2012-09-05T02:53:53.347
> 
> 标签：git, github, gitignore

我有一个 PHP 配置文件，我想在本地操作，但在`git commits`我的主存储库期间忽略这些更改。我有一个`.gitignore`文件曾经忽略此 PHP 文件，但发生了不好的事情，现在该`config.php`文件不再被忽略，我不记得如何重新忽略它。

我知道 SO 上的人说要使用[`git rm --cached <filename>`](https://stackoverflow.com/questions/3258638/apply-git-gitignore-rules-to-an-existing-repository)，但我一生都无法弄清楚如何不`git rm...`继续删除我的 config.php 文件。

我想知道是否有人可以列出如何忽略我的 config.php 以便我可以继续在本地对其进行编辑，但这些更改不会添加到存储库中。

这是我的全部内容`.gitignore`：

```
application/config.php 
```

这是我的一些 php 代码，我`config.php`想保留在本地，而**不是**进入我的主仓库：

```
$config['base_url'] = "http://localhost/";
//$config['base_url'] = "http://mysite.com/"; // this is the code and NOT
// "http://localhost" that i'd like to keep in my repo 
```

这就是删除我的文件的原因：

1.  `git rm --cached application/config.php`
2.  更改`application/config.php`文件和另一个文件（作为控件）
3.  `git commit -m 'config.php shouldn't be changed'`

    结果：（`2 files changed, 1 insertions(+), 370 deletions(-)`是`config.php`370 行长）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-05T03:19:13.950

我解决了我自己的问题。我实际上需要这个：

[`git update-index --assume-unchanged <filename>`](http://gitready.com/intermediate/2009/02/18/temporarily-ignoring-files.html)

假设在我的问题中如上所述指定了 .gitignore 和 config.php 文件，这是完整的工作流程：

1.  `git update-index --assume-unchanged application/config.php`
2.  `git add -A`
3.  `git commit -m 'now config.php will be ignored'`
4.  `git push origin master`

现在`http://localhost`将保留在我的本地仓库副本的`http://my-site.com`config.php 中，并将保留在我的主仓库的 config.php 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:05:20.330

你需要`config.php`在你的 .gitignore 文件中。

但是，如果您实际上已将 config.php 添加到您的存储库中，您将需要`git rm`它然后提交，然后重新创建它（或者您可以制作一个副本然后再复制回来）。

# javascript - 如何确定我的 HTML5 javascript 游戏中过多垃圾收集的来源？

> ID：12273906
> 
> 赞同：0
> 
> 时间：2012-09-05T02:54:15.323
> 
> 标签：javascript, html, garbage-collection

如何确定 HTML5 游戏中过多垃圾收集的来源？

这是我在 chrome 中拍摄的堆快照的结果：![堆快照](../Images/f7a6f60b1da17b8f2b88abdf0cbfaa6f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:01:00.453

Chrome 开发者工具支持堆分析。您可以参考[https://developers.google.com/chrome-developer-tools/docs/heap-profiling](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)

# android - 以编程方式检测应用程序是否安装在 Android 上

> ID：12273907
> 
> 赞同：4
> 
> 时间：2012-09-05T02:54:20.983
> 
> 标签：android, url-scheme, installed-applications

我已经为我的 Android 应用程序注册了一个 url 方案（比如说 myapp://host）。

在我的另一个应用程序上，我可以使用 Intent 启动该应用程序，但是如何检查第一个应用程序是否已安装而不启动它？

在 iOS 中，它就像

```
[[UIApplication sharedApplication] canOpenUrl:@"myapp://"]; 
```

Android中是否有等价物？（简单的方法）

我想使用 url 方案进行检查。我知道如何使用包名称进行检查，但我也不知道如何从 PackageInfo 获取 url 方案......（更难的方式）

```
 PackageManager pm = m_cContext.getPackageManager();
    boolean installed = false;
    try {
        @SuppressWarnings("unused")
        PackageInfo pInfo = pm.getPackageInfo(szPackageName, PackageManager.GET_ACTIVITIES);
        installed = true;
    } 
    catch (PackageManager.NameNotFoundException e) {
        installed = false;
    } 
```

提前致谢！

注意：这是适用于 iOS 的同一问题的 Android 版本： [Detecting programmatically if an app is installed on iPhone](https://stackoverflow.com/questions/3808691/detecting-programmatically-whether-an-app-is-installed-on-iphone/3808757#comment16408047_3808757)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T03:08:19.970

如果您知道如何启动应用程序，则创建启动应用程序的意图，然后调用 queryIntentActivities

```
 Intent intent = //your app launching intent goes here
 PackageManager packageManager = mContext.getPackageManager();
 List<ResolveInfo> resolvedActivities = packageManager.queryIntentActivities(intent,0);
 if(resolvedActivities.size() >0)
     \\present 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-27T16:53:31.423

我在静态方法中使用类**PackageManager中的****queryIntentActivities ：**

 **```
public static boolean canOpenIntent(Context context, Intent intent)
{
    boolean canOpenUrl = false;
    PackageManager    packageManager     = context.getPackageManager();
    List<ResolveInfo> resolvedActivities = packageManager.queryIntentActivities(intent, 0);
    if(resolvedActivities.size() > 0)
        canOpenUrl = true;
    return canOpenUrl;
} 
```**

# callback - 如何在 Coffeescript 中制作回调函数

> ID：12273908
> 
> 赞同：11
> 
> 时间：2012-09-05T02:54:36.193
> 
> 标签：callback, coffeescript

我不知道如何制作一个最后调用另一个函数的函数。

我希望能够做这样的事情：

```
book.save (err) ->
  MyFunc param1, param2, (callbackParam) ->
    # some code using callbackParam

MyFunc = (param1, param2) ->
  # some other code that defines callbackParam
  ?.call(callbackParam) 
```

必须调用什么以及它如何接收数据？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-05T03:05:24.477

如果您想调用`MyFunc`为：

```
MyFunc param1, param2, some_function 
```

然后它应该看起来像这样：

```
MyFunc = (param1, param2, callback) ->
    # some code that defines callbackParam
    callback callbackParam 
```

如果你想`callback`选择：

```
MyFunc = (param1, param2, callback) ->
    # some code that defines callbackParam
    callback? callbackParam 
```

如果你想提供一个特定的`@`（AKA `this`），那么你会使用[`call`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)或[`apply`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)就像在 JavaScript 中一样：

```
MyFunc = (param1, param2, callback) ->
    # some code that defines callbackParam
    callback?.call your_this_object, callbackParam 
```

这些`(callbackParam) -> ...`东西只是一个函数文字，其作用类似于任何其他参数，没有像 Ruby 中那样的特殊块处理（您的标签表明 Ruby 块是您混淆的根源）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-09-02T14:43:04.247

这是一个更简洁、更易于阅读和理解的示例：

```
some_function = (callback) ->
  param1 = "This is param1"
  param2 = "This is param2"
  callback(param1, param2)

callback = (param1, param2) ->
  console.log(param1)
  console.log(param2)

@tester = ->
  some_function(callback)
  "done" 
```

现在加载您的网站，转到控制台，然后调用该函数：

```
> tester()
  This is param1
  This is param2
< "done" 
```

# vb.net - “对象引用未设置为对象的实例”同时创建人员使用应用程序的授权

> ID：12273912
> 
> 赞同：0
> 
> 时间：2012-09-05T02:56:01.527
> 
> 标签：vb.net

我正在尝试创建如下代码并错误提示“对象引用未设置为对象的实例”。

```
Public Shared Function bGetStaffCode(ByVal strUserName As String, ByVal conn As SqlConnection, ByRef strErr As String) As Boolean
    ' TODO: NotImplemented statement: ICSharpCode.SharpRefactory.Parser.AST.VB.OnErrorStatement
    Try

        'Dim bStaffCode As Boolean
        Dim strSQL As String = "select count(*) from portal_BillFinderAccess  where loginID = 'Elvis Tan '"

        Dim myCommand As New SqlCommand
        myCommand.Connection = conn
        myCommand.CommandText = strSQL

        'If CInt(myCommand.ExecuteScalar) = 0 Then

        Dim myDA As New SqlDataAdapter(strSQL, conn)
        Dim myDS As New DataSet
        myDA.Fill(myDS, "count")
        If myDS.Tables(0).Rows(0).Item(0).ToString = "0" Then
            MessageBox.Show("You are not authorized to use this application!")
            Return False
        Else
            Return True

        End If

    Catch err As Configuration.ConfigurationException
        MessageBox.Show(err.Message)
    Finally
    End Try

End Function` 
```

# android - 警报对话框中的多项选择

> ID：12273915
> 
> 赞同：0
> 
> 时间：2012-09-05T02:56:28.350
> 
> 标签：android, listview, checkbox, android-alertdialog

我使用“lv_del_transl.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE)”来设置这个选项。

创建 AlertDialog 的代码：

```
Al_tr.setTitle("Title");

RelativeLayout view_T = (RelativeLayout)getLayoutInflater().inflate(R.layout.listofword_cmenu_del_transl, null);
Al_tr.setView(view_T);

TextView del_transl = (TextView)view_T.findViewById(R.id.del_transl);
ListView lv_del_transl = (ListView)view_T.findViewById(R.id.lv_del_transl);
Button del_transl_OK = (Button)view_T.findViewById(R.id.del_transl_OK);
Button del_transl_Cancel = (Button)view_T.findViewById(R.id.del_transl_Cancel);

al_del_tr=Al_tr.create();

Del_transl.setText("word");

Cursor c_adap_tr=cur_del_tr(......);
startManagingCursor(c_adap_tr);

String[] from_r = new String[]{NAME};
int[] to_r = new int[] {R.id.transl };
scAdapter_transl = new SimpleCursorAdapter(this, R.layout.listofword_cmenu_del_transl_item, c_adap_tr, from_r, to_r);
lv_del_transl.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); // for set Multiple property

lv_del_transl.setAdapter(scAdapter_transl);

del_transl_OK.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        String sel="0";

        SparseBooleanArray sbArray = lv_del_transl.getCheckedItemPositions();
        for (int i = 0; i < lv_del_transl.getCount(); i++) {

            if (sbArray.get(i))
                sel+=Integer.toString(lv_del_transl.getCheckedItemPosition())+" ";
        }
        Toast.makeText(getApplicationContext(), Integer.toString(lv_del_transl.getCount())+" "+sel, Toast.LENGTH_SHORT).show();

    }
});    
al_del_rt.show(); 
```

ListView 的 XML 文件

```
 <LinearLayout
        android:id="@+id/lv_del_translation"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="5dp" >

        <TextView
            android:id="@+id/del_translation"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:text="@string/text_del_translation"
            android:textSize="20dp" />

        <TextView
            android:id="@+id/del_transl"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="28dp"
            android:text="@string/text_del_transl"
            android:textSize="20dp" />
    </LinearLayout>

    <ListView
        android:id="@+id/lv_del_transl"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/lv_del_translation"
        android:layout_marginTop="10dp"
        android:layout_weight="1"
        android:choiceMode="multipleChoice" />

    <LinearLayout
        android:id="@+id/l_del_buttons"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_gravity="center"
        android:background="@drawable/gradient_box"
        android:orientation="horizontal"
        android:padding="5dp" >

        <Button
            android:id="@+id/del_transl_OK"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/text_del_word_OK" />

        <Button
            android:id="@+id/del_transl_Cancel"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/text_del_word_Cancel" />
    </LinearLayout>

</RelativeLayout> 
```

其中 listofword_cmenu_del_transl_item.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="match_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal">

<TextView
 android:id="@+id/transl"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_marginLeft="20dp"
 android:layout_centerVertical="true"
 android:textSize="19sp">
</TextView>

<CheckBox 
android:id="@+id/checbox_id"
android:layout_marginRight="10dp"
android:layout_alignParentRight="true"
android:layout_width="wrap_content"
android:layout_height="wrap_content"/>

 </RelativeLayout> 
```

但是 SparseBooleanArray sbArray 没有效果。我无法定义检查位置。请帮我找出一个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:54:46.433

```
private void showPopUp()
{
    final AlertDialog.Builder helpBuilder = new AlertDialog.Builder(this);
    helpBuilder.setTitle("");

    LayoutInflater inflater = getLayoutInflater();
    final View PopupLayout = inflater.inflate(R.layout.jobselection, null);
    helpBuilder.setView(PopupLayout);

    final AlertDialog helpDialog = helpBuilder.create();
    helpDialog.show();

    okbtn           =   (Button)PopupLayout.findViewById(R.id.okBtn);
    caneclbtn       =   (Button)PopupLayout.findViewById(R.id.cancelBtn);
    selectallbtn    =   (Button)PopupLayout.findViewById(R.id.selectBtn);
    clearallbtn     =   (Button)PopupLayout.findViewById(R.id.clearallBtn);

    jobList         =   (ListView)PopupLayout.findViewById(R.id.list);

    mylist          =   new ArrayList<HashMap<String, String>>();

    for(int i=0;i<Punchedjobs.size();i++)
    {
        map = new HashMap<String, String>();
        map.put("name", Punchedjobs.get(i));
        mylist.add(map);
    }
    sd = new SimpleAdapter(StaffTimeClock.this,mylist,R.layout.jobslist,
                new String[]{"name"},new int[]{R.id.jobText});
    jobList.setAdapter(sd);

    okbtn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) 
        {
            //ur code
        }
    });

    caneclbtn.setOnClickListener(new OnClickListener() 
    {
        public void onClick(View v) 
        {
            helpDialog.dismiss();
        }
    });

    selectallbtn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) 
        {
            CheckBox job_chk;
            for(int i=0;i<Punchedjobs.size();i++)
            {
                job_chk= ((CheckBox)jobList.getChildAt(i).findViewById(R.id.chk));
                job_chk.setChecked(true);
            }
        }
    });

    clearallbtn.setOnClickListener(new OnClickListener() {

        public void onClick(View v) 
        {
            CheckBox job_chk;
            for(int i=0;i<Punchedjobs.size();i++)
            {
                job_chk= ((CheckBox)jobList.getChildAt(i).findViewById(R.id.chk));
                job_chk.setChecked(false);
            }
        }
    });

} 
```

**工作选择.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center"
android:orientation="vertical"
tools:context=".StaffTimeClock" >

  <TextView
    android:id="@+id/img"
    android:layout_width="fill_parent"
    android:text="@string/selectjob"
    android:gravity="center"
    android:textSize="30dp"
    android:textColor="#fff"
    android:background="#203C56"
    android:padding="10dp"
    android:layout_height="wrap_content"/>

 <ListView
     android:id="@+id/list"
     android:layout_weight="1"
     android:layout_width="fill_parent"
     android:layout_height="0dp"
     android:cacheColorHint="#222000" />

 <View 
     android:layout_width="fill_parent"
     android:layout_height="3dp"
     android:background="#000"/>

 <LinearLayout android:id="@+id/lin00"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#fff"
    android:orientation="horizontal">

     <Button 
      android:layout_weight="0.1"
      android:contentDescription="@string/ok"
      android:id="@+id/okBtn"
      android:layout_gravity="center"
      android:layout_margin="10dp"
      android:padding="10dp"
      android:textSize="25dp"
      android:background="@drawable/toolbar_background"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/ok"/>

 <Button 
      android:layout_weight="0.1"
      android:contentDescription="@string/ok"
      android:id="@+id/selectBtn"
      android:layout_gravity="center"
      android:layout_marginTop="10dp"
      android:layout_marginBottom="10dp"
      android:padding="10dp"
      android:textSize="25dp"
      android:background="@drawable/toolbar_background"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/selectall"/>

  <Button 
      android:layout_weight="0.1"
      android:contentDescription="@string/ok"
      android:id="@+id/clearallBtn"
      android:layout_gravity="center"
      android:layout_margin="10dp"
      android:padding="10dp"
      android:textSize="25dp"
      android:background="@drawable/toolbar_background"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/clear"/>

  <Button 
      android:layout_weight="0.1"
      android:contentDescription="@string/cancel"
      android:id="@+id/cancelBtn"
      android:layout_gravity="center"
      android:layout_marginTop="10dp"
      android:layout_marginBottom="10dp"
      android:padding="10dp"
      android:textSize="25dp"
      android:background="@drawable/toolbar_background"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/cancel"/>

  </LinearLayout>
  </LinearLayout> 
```

**工作列表.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@+id/lin01"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:background="#fff"
android:padding="10dp"
android:orientation="horizontal">

        <ImageView 
            android:id="@+id/image"
            android:contentDescription="@string/staff"
            android:src="@drawable/logo2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"/>
        <TextView
            android:id="@+id/jobText"
            android:layout_width="0dp"
            android:text="@string/jobtype"
            android:layout_weight="1"
            android:gravity="left|center_vertical"
            android:layout_marginLeft="10dp"
            android:textSize="25dp"
            android:textColor="#000"
            android:layout_height="50dp"/>

        <CheckBox 
            android:id="@+id/chk"
            android:layout_width="wrap_content"
            android:text=""
            android:gravity="center_vertical|right"
            android:button="@drawable/checkbox_selector_green"
            android:layout_height="wrap_content"/>

        </LinearLayout> 
```

# magento - Magento 整页缓存和主题

> ID：12273916
> 
> 赞同：1
> 
> 时间：2012-09-05T02:57:01.893
> 
> 标签：magento, caching, themes

我正在使用 magento 全页缓存，EE 1.11.2。出于某种原因，我的辅助移动主题显示在我的一些目录页面上。例如，六分之二。这只发生在 FPC 开启的情况下。它正在重复发生并且发生在相同的页面上。缓存可以是有效的，也可以是无效的。我还没有找到与此类似的主题的任何信息。关于如何解决这个问题的任何想法或建议？

# ruby-on-rails - 设置 Rails 模型属性顺序

> ID：12273917
> 
> 赞同：7
> 
> 时间：2012-09-05T02:57:02.140
> 
> 标签：ruby-on-rails

在定义依赖于要设置的另一种方法的虚拟设置方法时，似乎在哈希中设置属性的顺序很重要。有没有办法在仍然大量分配属性的同时解决这个问题？

[https://gist.github.com/3629539](https://gist.github.com/3629539)

编辑

实际代码中的条件（未在示例中显示）是检查关联对象的存在。如果对象存在，则设置一个值。如果没有，忽略传入的值。但是，我也在使用accepts_nested_attributes_for。因此，属性散列可能包含关联的属性。在这种情况下，该对象将存在。

```
{:name => 'Fred', :nested_attributes => {:color => 'red'}} 
```

由于模型不存在，因此不会设置名称。

```
{:nested_attributes => {:color => 'red'}, :name => 'Fred'} 
```

Accepts_nested_attributes_for 将构建一个嵌套实例，然后设置属性。当要设置名称时，实例将存在并设置嵌套属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-24T20:03:23.120

有一个类似的问题，我得出了以下合理通用的解决方案：

```
def assign_attributes(new_attributes)
  assign_first = new_attributes.extract!(:must_be_set_first, :must_also_be_set_first)
  super(assign_first) unless assign_first.empty?
  super(new_attributes)
end 
```

使用`super`您需要首先设置的提取参数值确保您处理属性分配的所有奇怪的特殊情况（它是一个引用吗？一个参数哈希？一个多值参数？）。用部分散列重复调用`assign_attributes`确实应该与用整个散列调用一次具有相同的效果——这应该是相当安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T03:03:26.527

我现在能想到的唯一解决方案是覆盖属性设置器......

```
def attributes=(attrs)
    self[:dont_set_name] = attrs.delete(:dont_set_name)
    super
end 
```

# php - PDO 检查数据库中是否存在 300 多个值的最佳方法

> ID：12273926
> 
> 赞同：1
> 
> 时间：2012-09-05T02:58:50.043
> 
> 标签：php, mysql, caching, optimization, pdo

我正在处理一个依赖时间的脚本，并使用 microtime() 来查找瓶颈。我确定时间增加是由于对 300 多个值进行检查，以查看它们是否存在于数据库中，每次查询时间为 0.04 秒。

脚本的背景是它是一个缓存脚本。我需要查看它是否存在于数据库中，所以我需要一个真/假（由 rowCount 获得），但我还需要一种将假与值相关联的方法，以便我可以更新它。我知道使用 WHERE 标记 IN (:ARRAY) 会比单独调用更快，但我想不出一种方法将真/假关联应用于此方法中的值。

我当前的代码如下：

```
//loop through all our values!
    //prepare out reusuable statement
$stmt = $db->prepare("SELECT * from cache WHERE value=?");

foreach($values as $tempVal)
{
    //find if its in the database
    try
    {
        $stmt->execute(array($tempVal));
        $valCount = $stmt->rowCount();
    } catch(PDOException $ex) {
        echo "PDO error send this to us: " . $ex->getMessage();
    }

    //update flag
    $addToUpdate = 1;

    //if its in the database
    if($valCount > 0)
    {
        //get the tag data
        $valRes= $stmt->fetch();

        //check if cache expired
                    $addToUpdate = 0;
    } 

    //add to update list
    if($addToUpdate)
    {
                    //needs updating
        $updateList[] = $tempVal;

        //add to not in DB list to minimize queries
        if($tagTCount == 0)
        {
            $notInDB[$tempVal] = $tempVal;
        }
    } 
```

有什么建议么？如果有什么不清楚的地方，我可以解释更多。

谢谢你，尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:10:36.633

因此，您只需使用`IN (?,?,?,?,?...)`列表发出带有完整数组的查询：

```
// abstract, use a PDO wrapper of your choosing
$query = db("SELECT * FROM cache WHERE value IN (??)", $values); 
```

然后遍历结果列表。只有匹配的 $values 才会返回。因此，从中构建您的第一个列表：

```
foreach ($query as $row) {
     $updateList[] = $row["value"];
} 
```

要获取缺失条目的列表，只需将其与原始数组进行[比较](http://php.net/array_diff)：

```
$notInDB = array_diff($values, $updateList); 
```

您当然可以使用第二个`NOT IN`查询。但是在 PHP 中进行这种区分更简单。

# javascript - 在 rhino 中从 orientDB 中选择

> ID：12273939
> 
> 赞同：2
> 
> 时间：2012-09-05T03:00:46.913
> 
> 标签：javascript, rhino, orientdb

我正在尝试从[rhino script](https://github.com/wholcomb/tip/blob/master/test/orientDB/rhino)访问 orientDB 。我收到错误

```
js: Can't find method com.orientechnologies.orient.core.db.ODatabaseRecordWrapperAbstract.query(com.orientechnologies.orient.core.sql.query.OSQLSynchQuery) 
```

当我执行以下代码时：

```
var System = java.lang.System
var OSQLSynchQuery = Packages.com.orientechnologies.orient.core.sql.query.OSQLSynchQuery
var ODatabaseDocumentTx = Packages.com.orientechnologies.orient.core.db.document.ODatabaseDocumentTx
var ODocument = Packages.com.orientechnologies.orient.core.record.impl.ODocument
var File = java.io.File

var user_home = System.getProperty( "user.home" )
var db_path = user_home + "/.testdb"
var db_url = "local:" + db_path + File.separator + "db"
if( ! new File( db_path ).exists() ) {
    new File( db_path ).mkdirs()
    new ODatabaseDocumentTx( db_url ).create()
}
var db = new ODatabaseDocumentTx( db_url ).open( "admin", "admin" )
db.getStorage().getConfiguration().txSegment.setSynchRecord( true )

print( 'Select From TestObj' )

if( db.getMetadata().getSchema().getClass( 'TestObj' ) != null  ) {
    var result = db.query( new OSQLSynchQuery( "select * from TestObj" ) )
    print( "# of Entries: " + result.size() )
}
db.close() 
```

我正在访问一个已经创建和填充的数据库。选择从控制台工作。

我检查了 javadoc 和 ODatabaseRecordWrapperAbstract.query 方法采用 OSQLSynchQuery 实现的 OQuery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:27:28.377

[查询方法](http://www.orientdb.org/releases/latest/javadoc/com/orientechnologies/orient/core/db/ODatabaseComplex.html#query%28com.orientechnologies.orient.core.query.OQuery,%20java.lang.Object...%29)使用可变参数。犀牛可能无法处理。尝试传入一个额外的空对象数组：

```
 var result = db.query(
     new OSQLSynchQuery( "select * from TestObj" ), [] ) 
```

# c# - 如何防止滑块拉伸？

> ID：12273941
> 
> 赞同：1
> 
> 时间：2012-09-05T03:00:57.990
> 
> 标签：c#, jquery, css, asp.net-mvc-3, slider

刚刚熟悉 jQuery UI。所以，在我看来，这是一段代码：

```
<label id="min">
    5000</label>
<div id="slider">
</div>
<label id="max">
    9000</label> 
```

以及脚本的一部分：

```
 $('#slider').slider({
        animate: true,
        range: true,
        min: 5000,
        max: 9000,
        values: [5000, 9000],
        slide: function (event, ui) {
            //doing smth
        }
    }); 
```

一切正常，但滑块被拉伸并占据整条线。标签在它的下方和下方。我希望他们都排成一行。

我应该怎么做才能实现它？

**编辑**

这是我所期待的：

![正确的](../Images/d747dbb83a95e88357a9389f7568f80b.png)

这就是我所拥有的：

![错误](../Images/f81bbad15f28f1d058c48405908979be.png)

**编辑**

我试图通过将以下代码添加到我的*Site.css*文件来覆盖滑块 css：

```
.ui-slider .ui-slider-handle
{
    position: absolute;
    z-index: 2;
    width: 0.5em !important;
    height: 1.2em !important;
    cursor: default;
} 
```

但没有任何改变。如何让 jQuery 使用这个 CSS？

**另一个注意事项**：原始的 css 看起来像这样：

```
.ui-slider .ui-slider-handle
{
    position: absolute;
    z-index: 2;
    width: 1.2em;
    height: 1.2em;
    cursor: default;
} 
```

那么，这里是css的问题吗？或者其他什么让我的滑块伸展？

**更多的**

这是生成的html：

```
<div id="slider" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
    <div class="ui-slider-range ui-widget-header" style="left: 25.95%; width: 74.05%;">
    </div>
    <a href="#" class="ui-slider-handle ui-state-default ui-corner-all" style="left: 25.95%;">
    </a>
    <a href="#" class="ui-slider-handle ui-state-default ui-corner-all" style="left: 100%;">
    </a>
</div> 
```

**最后**

我必须覆盖`.ui-slider`类，而不是`.ui-slider .ui-slider-handle`. 这就是问题所在。

Rajesh Rolen- DotNet De，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T04:41:54.940

您可以设置滑块的宽度。 [更改jquery滑块的宽度和高度](https://stackoverflow.com/questions/8417955/change-the-width-and-height-of-jquery-slider)

```
.ui-slider .ui-slider-handle {
  position: absolute;
  z-index: 2;
width:1em !important;
height:1em !important;
 cursor: default;
} 
```

[http://tycoontalk.freelancer.com/css-forum/200419-jquery-css-slider-width-100-problem.html](http://tycoontalk.freelancer.com/css-forum/200419-jquery-css-slider-width-100-problem.html)

# bash - bash脚本将文件变量读入局部变量

> ID：12273948
> 
> 赞同：7
> 
> 时间：2012-09-05T03:02:17.850
> 
> 标签：bash, variables, file-io

我有一个包含以下内容的配置文件：

味精配置：

```
tmsg:This is Title Message!
t1msg:This is T1Message.    
t2msg:This is T2Message.    
pmsg:This is personal Message! 
```

我正在编写一个 bash 脚本，它读取 msgs.config 文件变量并将它们存储到局部变量中。我将在整个脚本中使用这些。由于许可，我不想使用该`.`方法（来源）。

```
tmsg
t1msg
t2msg
pmsg 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-05T05:04:34.227

您可以使用：

```
oldIFS="$IFS"
IFS=":"
while read name value
do
    # Check value for sanity?  Name too?
    eval $name="$value"
done < $config_file
IFS="$oldIFS" 
```

或者，您可以使用关联数组：

```
declare -A keys
oldIFS="$IFS"
IFS=":"
while read name value
do
    keys[$name]="$value"
done < $config_file
IFS="$oldIFS" 
```

现在您可以参考`${keys[tmsg]}`etc 来访问变量。或者，如果变量列表是固定的，您可以将值映射到变量：

```
tmsg="${keys[tmsg]}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T03:16:42.440

读取文件并存储值-

```
i=0
config_file="/path/to/msgs.config"

while read line
do
  if [ ! -z "$line" ]  #check if the line is not blank
  then
   key[i]=`echo $line|cut -d':' -f1`  #will extract tmsg from 1st line and so on
   val[i]=`echo $line|cut -d':' -f2`  #will extract "This is Title Message!" from line 1 and so on
   ((i++))
  fi
done < $config_file 
```

访问数组变量为`${key[0]}`, `${key[1]}`,.... 和`${val[0]}`, `${val[1]}`...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T12:03:17.320

如果您改变主意`source`：

```
source <( sed 's/:\(.*\)/="\1"/' msgs.config ) 
```

如果您的任何值有双引号，这将不起作用。

# c++ - 为什么 C++ 不知道 TIMESTAMP_STRUCT 类型？

> ID：12273949
> 
> 赞同：0
> 
> 时间：2012-09-05T03:02:24.580
> 
> 标签：c++

我使用 Visual Studio 2005

当我编译时，我得到这个错误：

> 错误 1 ​​错误 C2146：语法错误：缺少 ';' 在标识符“mDropEndTime”之前
> 
> 错误 2 错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

```
struct MB_SYN_DROPITEM_UPDATE : MSGBUF
{
    long                    mCid;           // Index
    unsigned long           mItemIdx;       // idx
    TIMESTAMP_STRUCT        mDropEndTime;   // This is error line
}; 
```

为什么 C++ 不知道`TIMESTAMP_STRUCT`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T03:08:35.000

`TIMESTAMP_STRUCT`是在 sqlext.h 中定义的东西

您必须添加

```
#include <sqlext.h> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T03:06:36.413

因为 TIMESTAMP_STRUCT 不是 C++ 标准的一部分。

# svn - 如何将项目导入 SVN？

> ID：12273956
> 
> 赞同：0
> 
> 时间：2012-09-05T03:03:33.090
> 
> 标签：svn, tortoisesvn

我刚刚开始使用 SVN，并已将其安装在 SME 服务器上，并在我的 PC 上安装了[TortoiseSVN 。](http://en.wikipedia.org/wiki/TortoiseSVN)[我已经通过PuTTY](http://en.wikipedia.org/wiki/PuTTY)为 SVN 设置了用户。

现在，据我了解，下一步是导入项目，但我真的不知道如何导入项目。在 TortoiseSVN 中，我需要一个指向存储库的 URL，但我不知道这是什么（服务器的本地 IP 地址是 192.168.100.1）。最好通过 TortoiseSVN 做到这一点吗？存储库的 URL 是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:26:39.923

简而言之，这些是基本步骤：

1.  [在服务器上创建存储库](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.create.html)
2.  使用 TortoiseSVN 回购浏览器并连接到`svn://192.168.100.1/your-repo`（或`http`）
3.  使用 TortoiseSVN 创建一个基本的存储库结构，例如 /trunk、/tags（参见[存储库组织](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.planning.html)）
4.  使用 TortoiseSVN 导入你的项目到`svn://192.168.100.1/your-repo/trunk`

对于您首选的 svn 协议，请阅读此问答：[哪种协议？svn:// 还是 http(s)://？](https://stackoverflow.com/q/2140954/256544)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-05T14:24:47.507

您打算为 SVN 存储库使用什么协议？

通常你会在它前面放置一个 Apache Web 服务器。那么当你在你的SME服务器上安装SVN时你做了什么？只安装了客户端可执行文件还是 svnadmin？

URL 因您选择的协议而异。可能是`http://192.168.0.1/svn/reponame/`您在服务器上创建了一个 SVN 存储库“repositoryname”。

我建议阅读[http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.serverconfig](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.serverconfig)开始。

# haskell - 在 cabal 中使用“共享”/“动态”是否实用？

> ID：12273960
> 
> 赞同：2
> 
> 时间：2012-09-05T03:04:45.010
> 
> 标签：haskell, cabal

一旦我改变 ~/.cabal/config 如下，我不能（重新）安装许多软件包。

```
shared: True
executable-dynamic: True 
```

请照亮我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T06:15:56.953

我实际上不知道这里是否是这种情况，但与其他此类阴谋集团旗帜一样，在你这样做之后，你必须“从头开始”手动重新安装所有包，可以这么说，在一切开始工作之前再次。您可以尝试这样的命令（未经测试）：

```
cabal install --reinstall `ghc-pkg list --user | grep '^  '` 
```

这列出了本地（用户）数据库中的所有包，并要求 cabal 重新安装它们。

# c# - 使用它的指针从托管 C# 中释放非托管内存

> ID：12273961
> 
> 赞同：11
> 
> 时间：2012-09-05T03:04:47.117
> 
> 标签：c#, c++, memory-leaks, buffer, pinvoke

简而言之，问题是：如何在托管代码中释放从 Native DLL 作为 ItrPtr 返回的内存？

详细信息：假设我们有一个简单的函数，有两个参数作为 OUTPUT，第一个是指向字节数组的引用指针，第二个是引用 Int。该函数将根据一些规则分配字节数，并返回内存指针、字节大小和返回值（1 表示成功，0 表示失败）。

下面的代码工作正常，我可以正确获取字节数组以及字节数和返回值，但是当我尝试使用指针 (IntPtr) 释放内存时出现异常：

> Windows 在 TestCppDllCall.exe 中触发了一个断点。
> 
> 这可能是由于堆损坏，这表明 TestCppDllCall.exe 或其已加载的任何 DLL 中存在错误。
> 
> 这也可能是由于用户在 TestCppDllCall.exe 具有焦点时按 F12。
> 
> 输出窗口可能有更多诊断信息。

为了清楚起见：

1.  下一个 C# 代码与具有相同签名的其他 DLL 函数一起正常工作，并且释放内存工作没有任何问题。

2.  如果您需要更改分配内存方法或添加任何其他代码，则接受 (C) 代码中的任何修改。

3.  我需要的所有功能是 Native DLL 函数通过引用接受两个参数（字节数组和 int，在 c# [IntPtr of byte array and int]）根据一些规则用一些值填充它们并返回函数结果（成功或失败） .

* * *

**CppDLL.h**

```
#ifdef CPPDLL_EXPORTS
#define CPPDLL_API __declspec(dllexport)
#else
#define CPPDLL_API __declspec(dllimport)
#endif

extern "C" CPPDLL_API int writeToBuffer(unsigned char *&myBuffer, int& mySize); 
```

**CppDll.cpp**

```
#include "stdafx.h"
#include "CppDll.h"

extern "C" CPPDLL_API int writeToBuffer(unsigned char*& myBuffer, int& mySize)
{
    mySize = 26;

    unsigned char* pTemp = new unsigned char[26];
    for(int i = 0; i < 26; i++)
    {
        pTemp[i] = 65 + i;
    }
    myBuffer = pTemp; 
    return 1;
} 
```

**C#代码：**

```
using System;
using System.Text;
using System.Runtime.InteropServices;

namespace TestCppDllCall
{
    class Program
    {
        const string KERNEL32 = @"kernel32.dll";
        const string _dllLocation = @"D:\CppDll\Bin\CppDll.dll";
        const string funEntryPoint = @"writeToBuffer";

        [DllImport(KERNEL32, SetLastError = true)]
        public static extern IntPtr GetProcessHeap();
        [DllImport(KERNEL32, SetLastError = true)]
        public static extern bool HeapFree(IntPtr hHeap, uint dwFlags, IntPtr lpMem);
        [DllImport(_dllLocation, EntryPoint = funEntryPoint, CallingConvention = CallingConvention.Cdecl)]
        public static extern int writeToBuffer(out IntPtr myBuffer, out int mySize);

        static void Main(string[] args)
        {
            IntPtr byteArrayPointer = IntPtr.Zero;
            int arraySize;
            try
            {
                int retValue = writeToBuffer(out byteArrayPointer, out arraySize);
                if (retValue == 1 && byteArrayPointer != IntPtr.Zero)
                {
                    byte[] byteArrayBuffer = new byte[arraySize];
                    Marshal.Copy(byteArrayPointer, byteArrayBuffer, 0, byteArrayBuffer.Length);
                    string strMyBuffer = Encoding.Default.GetString(byteArrayBuffer);
                    Console.WriteLine("Return Value : {0}\r\nArray Size : {1}\r\nReturn String : {2}",
                        retValue, arraySize, strMyBuffer);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("Error calling DLL \r\n {0}", ex.Message);
            }
            finally
            {
                if (byteArrayPointer != IntPtr.Zero)
                    HeapFree(GetProcessHeap(), 0, byteArrayPointer);
            }
            Console.ReadKey();
        }
    }
} 
```

当我调试此代码时，我在行中设置断点（返回 1），缓冲区的值为：

```
myBuffer = 0x031b4fc0 "ABCDEFGHIJKLMNOPQRSTUVWXYZ‎‎‎‎««««««««î‏&quot; 
```

当函数调用返回并且值为：

```
52121536 
```

结果我得到了正确的内存指针，我能够得到字节数组值，如何在 C# 中用这个指针释放这些内存块？

如果有什么不清楚或有任何错别字，请告诉我，我不是以英语为母语的人。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-05T03:11:44.263

简短的回答：您应该在 DLL 中添加一个单独的方法来为您释放内存。

长答案：有不同的方式可以在 DLL 实现中分配内存。释放内存的方式必须与分配内存的方式相匹配。例如，用`new[]`（带方括号）分配的内存需要用`delete[]`（而不是`delete`or `free`）释放。C# 没有为您提供执行此操作的机制；您需要将指针发送回 C++。

```
extern "C" CPPDLL_API void freeBuffer(unsigned char* myBuffer) {
    delete[] myBuffer;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-05T03:44:50.073

如果您在本机代码中分配自己的内存，请使用[`CoTaskMemAlloc`](http://msdn.microsoft.com/en-us/library/ms692727.aspx)并且您可以使用[`Marshal.FreeCoTaskMem`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freecotaskmem). `CoTaskMemAlloc`被描述为“在基于 COM 的应用程序中共享内存的唯一方法”（参见 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa366533(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366533%28v=vs.85%29.aspx)）

如果您需要使用`CoTaskMemAlloc`与本机 C++ 对象一起分配的内存，您可以使用*placement new*来初始化内存，就像使用了`new`运算符一样。例如：

```
void * p = CoTaskMemAlloc(sizeof(MyType));
MyType * pMyType = new (p) MyType; 
```

这不会分配内存，`new`只需调用预分配内存上的构造函数。

调用`Marshal.FreeCoTaskMem`不会调用该类型的析构函数（如果您只需要释放内存，则不需要）；如果您需要通过调用析构函数来做更多的事情，那么您必须提供一个执行此操作的本机方法并 P/Invoke 它。无论如何都不支持将本机类实例传递给托管代码。

如果您需要使用其他 API 分配内存，则需要通过 P/Invoke 在托管代码中公开它，以便在托管代码中释放它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-05T03:27:36.923

```
 HeapFree(GetProcessHeap(), 0, byteArrayPointer); 
```

不，那行不通。堆句柄错误，CRT 使用 HeapCreate() 创建自己的堆。它隐藏在 CRT 数据中，您无法访问它。从技术上讲，您可以从 GetProcessHeaps() 中找到句柄，但您不知道它是哪一个。

指针也可能是错误的，CRT 可能从 HeapAlloc() 返回的指针中添加了一些额外的信息来存储调试数据。

您需要导出一个调用 delete[] 来释放缓冲区的函数。或者编写一个 C++/CLI 包装器，以便您可以在包装器中使用 delete[]。额外要求 C++ 代码和包装器使用*完全相同*版本的 CRT DLL（需要 /MD）。这几乎总是要求您可以重新编译 C++ 代码。

# php - htmlspecialchars() 抛出错误

> ID：12273963
> 
> 赞同：-1
> 
> 时间：2012-09-05T03:05:11.477
> 
> 标签：php, htmlspecialchars, elgg

我已经安装了 elgg 并且所有链接都不起作用。在错误日志中，我看到了这些错误消息：

> htmlspecialchars() 最多需要 3 个参数，给定 4 个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T03:15:27.537

您需要 PHP 5.2.3 或更高版本。那`htmlspecialchars`是添加第 4 个参数的时候。

5.2.3 发布 5 年多了！！那么你的 PHP 版本是多少年了？？？

当前的旧版本是 5.3.16，而 5.4.6 是您真正应该使用的版本。

# scala - 试图找到更简单的方法来从 trait 引用子类的类型

> ID：12273969
> 
> 赞同：3
> 
> 时间：2012-09-05T03:05:30.027
> 
> 标签：scala, inheritance, types, covariance

所以，这里有一个人为的例子：

```
trait MyTrait { 
  type T <: MyTrait
  val listOfT:List[T]
  def getFirst:T
  //def getOne:T = if( listOfT.length > 0 ) { getFirst } else { this }
}

class MyClass extends MyTrait {
  type T = MyClass
  override val listOfT:List[T] = List[MyClass](this)
  override def getFirst:T = listOfT.head
} 
```

问题类型有两个部分：

是否有其他方法可以做到这一点，其中 MyClass 中的返回类型可能只是 "MyClass" 而不必指定 "type T = MyClass" ？基本上我希望能够将这个特性添加到一个类中，而不必让子类显着改变它的实现或考虑类型系统......只返回它自己的成员，并让特性接受任何东西，只要它在子类型上是协变的。这甚至有意义吗？

在 MyTrait 中，如果未注释，getOne 方法将给出错误“type mismatch:” found : MyTrait.this.type (withunderlying type MyTrait) required: MyTrait.this.T

如果我将返回类型更改为 this.type，我会得到相反的发现/所需类型不匹配。任何一个返回值实际上都具有相同的类型（并且实际上是相同的对象）。

处理这些情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T03:11:48.850

这是你想要的吗？

```
trait MyTrait[T <: MyTrait[T]] { self: T =>
  val listOfT: List[T]
  def getFirst: T
  def getOne: T = if (listOfT.length > 0) getFirst else self
}

class MyClass extends MyTrait[MyClass] {
  override val listOfT: List[MyClass] = List[MyClass](this)
  override def getFirst: MyClass = listOfT.head
} 
```

它摆脱了`type T = MyClass`（允许您只`MyClass`输入返回类型）并修复`getOne`.

# c# - 尽管绑定到 DataTable，ListView 不会更新

> ID：12273972
> 
> 赞同：1
> 
> 时间：2012-09-05T03:06:09.370
> 
> 标签：c#, wpf, data-binding, ado.net

像往常一样，我做了一些研究，但在网站或其他地方找不到答案。如果您能指出我现有的问题，我将不胜感激。否则，这是一个问题：

我有一个`ListView`对象绑定到一个`DataTable`对象。请参阅以下定义：

```
<ListView Name="MyList">
        <ListView.View>
            <GridView>
                <GridViewColumn x:Name="Column1Name" DisplayMemberBinding="{Binding Path=Column1}" />
                <GridViewColumn x:Name="Column2Name" DisplayMemberBinding="{Binding Path=Column2}" />
                <GridViewColumn x:Name="Column3Name" DisplayMemberBinding="{Binding Path=Column3}" />
                <GridViewColumn x:Name="Column4Name" DisplayMemberBinding="{Binding Path=Column4}" />
            </GridView>
        </ListView.View>
    </ListView> 
```

绑定代码如下：

```
DataTable items = new DataTable();
items = DatabaseService.GetMyItems(20, true, items);
Binding binding = new Binding();
binding.Source = items.DefaultView;
binding.Mode = BindingMode.OneWay;
MyList.SetBinding(ListView.ItemsSourceProperty, binding); 
```

执行查询的实际代码如下：

```
/** Parameters: commandText = <sql>, table = items */    
using (DbConnection connection = new SqlConnection(Project.Properties.Settings.Default.ConnectionString))
        {
            using (DbCommand command = connection.CreateCommand())
            {
                command.CommandText = commandText;
                command.CommandType = CommandType.Text;

                using (DbDataAdapter dataAdapter = new SqlDataAdapter())
                {
                    dataAdapter.SelectCommand = command;
                    dataAdapter.Fill(table);
                }
            }
        } 
```

此代码第一次工作，但是当我`GetMyItems`在数据更改后再次调用该方法时，数据不会刷新。

***我究竟做错了什么？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T03:13:23.737

如果它第一次工作是从构造函数工作，一旦加载了你的视图，那么你需要[通知你的属性 change](http://msdn.microsoft.com/en-us/library/ms743695.aspx)。

在您的 GetMyItems 方法中使用：

```
OnPropertyChanged("items"); 
```

然后声明方法：

```
 // Create the OnPropertyChanged method to raise the event 
  protected void OnPropertyChanged(string name)
  {
      PropertyChangedEventHandler handler = PropertyChanged;
      if (handler != null)
      {
          handler(this, new PropertyChangedEventArgs(name));
      }
  } 
```

如果您没有使用预构建的 MVVM 框架从 NotifyPropertyChanged 对象继承以便在 ViewModels 中获取 OnPropertyChanged 方法，这很常见。

在 DataTable 中有一个可观察的属性并不重要，问题在于更改通知。你需要一个**ObservableCollection**。您可以将 DataTable（DataSet 由一个或多个 DataTable 构造）转换为 ObservableCollection，然后[将 ObservableCollection 绑定到 UI 元素](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/94238dc4-00c4-4af4-afb9-195f89ece621/)。

# android - 安卓相机教程（使用surfaceview）

> ID：12273976
> 
> 赞同：20
> 
> 时间：2012-09-05T03:06:39.780
> 
> 标签：android, surfaceview

这是我的示例代码：

```
package newslab.video.server;

import android.app.Activity;
import android.hardware.Camera;
import android.os.Bundle;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class VideoServer extends Activity implements SurfaceHolder.Callback {
    TextView testView;

    Camera camera;
    SurfaceView surfaceView;
    SurfaceHolder surfaceHolder;

    private final String tag = "VideoServer";

    Button start, stop;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        start = (Button)findViewById(R.id.btn_start);
        start.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View arg0) {
                start_camera();
            }
        });

        stop = (Button)findViewById(R.id.btn_stop);
        stop.setOnClickListener(new Button.OnClickListener() {
            public void onClick(View arg0) {
                stop_camera();
            }
        });

        surfaceView = (SurfaceView)findViewById(R.id.surfaceView1);
        surfaceHolder = surfaceView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    private void start_camera() {
        try{
            camera = Camera.open();
        }catch(RuntimeException e){
            Log.e(tag, "init_camera: " + e);
            return;
        }
        Camera.Parameters param;
        param = camera.getParameters();
        //modify parameter
        param.setPreviewFrameRate(20);
        param.setPreviewSize(176, 144);
        camera.setParameters(param);
        try {
            camera.setPreviewDisplay(surfaceHolder);
            camera.startPreview();
        } catch (Exception e) {
            Log.e(tag, "init_camera: " + e);
            return;
        }
    }

    private void stop_camera() {
        camera.stopPreview();
        camera.release();
    }

    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
        // TODO Auto-generated method stub
    }

    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
    }
} 
```

但是，它只显示预览并停止相机。
是否有任何其他教程来教授进一步处理，例如如何保存图像或使用位图处理图像？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-05T04:03:37.840

行。所以这里是解决方案：

我没有添加任何尝试捕获。这只是为了捕获图像并将其存储到 sdcard 中。

```
public class VideoServer extends Activity implements SurfaceHolder.Callback {
    TextView testView;

    Camera camera;
    SurfaceView surfaceView;
    SurfaceHolder surfaceHolder;
    PictureCallback rawCallback;
    ShutterCallback shutterCallback;
    PictureCallback jpegCallback;
    private final String tag = "VideoServer";

    Button start, stop, capture;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        start = (Button)findViewById(R.id.btn_start);
        start.setOnClickListener(new Button.OnClickListener()
        {
            public void onClick(View arg0) {
                start_camera();
            }
        });
        stop = (Button)findViewById(R.id.btn_stop);
        capture = (Button) findViewById(R.id.capture);
        stop.setOnClickListener(new Button.OnClickListener()
        {
            public void onClick(View arg0) {
                stop_camera();
            }
        });
        capture.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                captureImage();
            }
        });

        surfaceView = (SurfaceView)findViewById(R.id.surfaceView1);
        surfaceHolder = surfaceView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        rawCallback = new PictureCallback() {
            public void onPictureTaken(byte[] data, Camera camera) {
                Log.d("Log", "onPictureTaken - raw");
            }
        };

        /** Handles data for jpeg picture */
        shutterCallback = new ShutterCallback() {
            public void onShutter() {
                Log.i("Log", "onShutter'd");
            }
        };
        jpegCallback = new PictureCallback() {
            public void onPictureTaken(byte[] data, Camera camera) {
                FileOutputStream outStream = null;
                try {
                    outStream = new FileOutputStream(String.format(
                            "/sdcard/%d.jpg", System.currentTimeMillis()));
                    outStream.write(data);
                    outStream.close();
                    Log.d("Log", "onPictureTaken - wrote bytes: " + data.length);
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                } finally {
                }
                Log.d("Log", "onPictureTaken - jpeg");
            }
        };
    }

    private void captureImage() {
        // TODO Auto-generated method stub
        camera.takePicture(shutterCallback, rawCallback, jpegCallback);
    }

    private void start_camera()
    {
        try{
            camera = Camera.open();
        }catch(RuntimeException e){
            Log.e(tag, "init_camera: " + e);
            return;
        }
        Camera.Parameters param;
        param = camera.getParameters();
        //modify parameter
        param.setPreviewFrameRate(20);
        param.setPreviewSize(176, 144);
        camera.setParameters(param);
        try {
            camera.setPreviewDisplay(surfaceHolder);
            camera.startPreview();
            //camera.takePicture(shutter, raw, jpeg)
        } catch (Exception e) {
            Log.e(tag, "init_camera: " + e);
            return;
        }
    }

    private void stop_camera()
    {
        camera.stopPreview();
        camera.release();
    }

    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
        // TODO Auto-generated method stub
    }

    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub
    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
    }

} 
```

**开始**前不要按**捕获**按钮，因为我没有检查它。我只是想向您展示如何捕获图像并将其存储到**sdcard**中。

 ***** * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-05T05:01:59.947

不要忘记在 Android Manifest 文件中获取使用相机的权限，

```
<uses-permission android:name="android.permission.CAMERA" ></uses-permission> 
```

此外，您必须获得在 SD 卡上存储图像的权限，

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"></uses-permission> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-20T05:53:39.170

文件中的相机权限`manifiest`：

```
<uses-feature android:name="android.hardware.camera" />
<uses-permission android:name="android.permission.CAMERA" /> 
```

`sdcard`从文件中存储图像的权限`manifiest`：

```
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-20T17:43:12.823

我在使用相机时遇到问题，正在弄清楚如何实施和使用并遇到以下资源：[相机预览](http://www.java2s.com/Code/Android/Hardware/Camerapreview.htm)。在页面底部，您有最常见场景的示例以及原始问题中的示例： [拍摄和预览照片](http://www.java2s.com/Code/Android/Hardware/TakeandpreviewPhoto.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-28T12:31:39.193

如果您使用的是 android 10 或更高版本，请不要忘记将其添加到清单文件中

```
android:requestLegacyExternalStorage="true"
android:grantUriPermissions="true" 
```****

# haskell - Haskell 中的编程类型注释

> ID：12273982
> 
> 赞同：14
> 
> 时间：2012-09-05T03:07:37.867
> 
> 标签：haskell, types, metaprogramming, type-systems, hindley-milner

在元编程时，将有关您的程序已知但在 Hindley-Milner 中无法推断的类型的信息传递给 Haskell 的类型系统可能是有用的（或必要的）。在 Haskell 中是否有一个库（或语言扩展等）提供了执行此操作的工具——即编程类型注释？

考虑一种情况，您正在使用异构列表（`Data.Dynamic`例如，使用库或存在量化实现）并且您希望将列表过滤为沼泽标准、同质类型的 Haskell 列表。你可以写一个函数

```
import Data.Dynamic
import Data.Typeable

dynListToList :: (Typeable a) => [Dynamic] -> [a]
dynListToList = (map fromJust) . (filter isJust) . (map fromDynamic) 
```

并使用手动类型注释调用它。例如，

```
foo :: [Int]
foo = dynListToList [ toDyn (1 :: Int)
                    , toDyn (2 :: Int)
                    , toDyn ("foo" :: String) ] 
```

这`foo`是清单`[1, 2] :: [Int]`；这工作得很好，你又回到了 Haskell 的类型系统可以做它的事情的坚实基础上。

现在想象你想做同样的事情，但是（a）在你编写代码时你不知道调用产生的列表的类型`dynListToList`需要是什么，但是（b）你的程序确实包含弄清楚这一点所需的信息，只有（c）它不是类型系统可以访问的形式。

例如，假设您从异构列表中随机选择了一个项目，并且您希望按*该*类型过滤列表。使用 提供的类型检查工具`Data.Typeable`，您的程序拥有执行此操作所需的所有信息，但据我所知——这是问题的本质——没有办法将其传递给类型系统。这是一些伪Haskell，说明了我的意思：

```
import Data.Dynamic
import Data.Typeable

randList :: (Typeable a) => [Dynamic] -> IO [a]
randList dl = do
    tr <- randItem $ map dynTypeRep dl
    return (dynListToList dl :: [<tr>])  -- This thing should have the type
                                         -- represented by `tr` 
```

（假设`randItem`从列表中选择一个随机项目。）

的参数上没有类型注释`return`，编译器会告诉你它有一个“不明确的类型”并要求你提供一个。但是您不能提供手动类型注释，因为类型在写入时未知（并且可能会有所不同）；然而，该类型在运行时*是*已知的——尽管它是类型系统无法使用的形式（这里，所需的类型由 value `tr`, a表示`TypeRep`——`Data.Typeable`详情请参阅）。

伪代码`:: [<tr>]`是我想要发生的魔法。有没有办法以编程方式为类型系统提供类型信息？也就是说，程序中的值中包含类型信息？

基本上，我正在寻找一个具有（伪）类型的函数，`??? -> TypeRep -> a`它采用 Haskell 的类型系统未知的类型的值和 a`TypeRep`并说：“相信我，编译器，我知道我在做什么。这东西有价值以此为代表`TypeRep`。” （请注意，这*不是*什么`unsafeCoerce`。）

还是有什么完全不同的东西让我在同一个地方？例如，我可以想象一个允许分配给类型变量的语言扩展，例如启用范围类型变量的扩展的增强版本。

（如果这是不可能的或非常不切实际的——例如，它需要将一个完整的类似 GHCi 的解释器打包到可执行文件中——请尝试解释原因。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-05T06:20:57.723

不，你不能这样做。总而言之，您正在尝试编写依赖类型的函数，而 Haskell 不是依赖类型的语言。你不能将你的`TypeRep`价值提升到一个真正的类型，所以没有办法写下你想要的函数的类型。为了更详细地解释这一点，我首先要说明为什么你对类型的表述方式`randList`没有真正意义。然后，我将解释为什么你不能做你想做的事。最后，我将简要提及一些关于实际操作的想法。

## 存在主义

你的类型签名`randList`不能代表你想要的意思。记住 Haskell 中的所有类型变量都是普遍量化的，它读取

```
randList :: forall a. Typeable a => [Dynamic] -> IO [a] 
```

因此，我有权称它为，比如说，`randList dyns :: IO [Int]`我想要的任何地方；我必须能够为*所有人* `a`提供返回值，而不仅仅是为*某些人* `a`提供。把它想象成一个游戏，它是*调用者*可以选择`a`的，而不是函数本身。您*想说*的（这不是有效的 Haskell 语法，尽管您可以使用存在数据类型¹将其转换为有效的 Haskell ）更像是

```
randList :: [Dynamic] -> (exists a. Typeable a => IO [a]) 
```

这保证列表的元素是*某种*类型`a`的，它是 的一个实例`Typeable`，但不一定是*任何*这种类型。但即使这样，你也会遇到两个问题。首先，即使你可以构建这样一个列表，你能用它做什么？其次，事实证明，你甚至不能一开始就构建它。

既然您对存在列表元素的所有了解都是它们是 的实例`Typeable`，那么您可以用它们做什么呢？ [查看文档](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Typeable.html)，我们看到只有两个函数²采用以下实例`Typeable`：

*   [`typeOf :: Typeable a => a -> TypeRep`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Typeable.html#v:typeOf)，来自类型类本身（确实是其中唯一的方法）；和
*   [`cast :: (Typeable a, Typeable b) => a -> Maybe b`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Typeable.html#v:cast)（这是用 实现的`unsafeCoerce`，否则不能写）。

`typeOf`因此，您对列表中元素类型的所有了解就是您可以调用`cast`它们。由于我们永远无法对它们有用地做任何其他事情，我们的存在主义也可能是（同样，不是有效的 Haskell）

```
randList :: [Dynamic] -> IO [(TypeRep, forall b. Typeable b => Maybe b)] 
```

`typeOf`如果我们对列表的每个元素应用和`cast`处理，存储结果并丢弃现在无用的存在类型的原始值，这就是我们得到的结果。显然，`TypeRep`这个列表的一部分没有用。列表的后半部分也不是。由于我们回到了一个普遍量化的类型，调用者`randList`再次有权请求他们为他们选择的任何（可键入的）获取 a `Maybe Int`、 a`Maybe Bool`或 a 。（事实上​​，它们比以前更强大，因为它们可以将列表中的不同元素实例化为不同的类型。）但是除非它们已经知道，否则它们无法确定要转换*的*类型——你仍然知道丢失了您试图保留的类型信息。`Maybe b``b`

 *即使抛开它们没有用的事实，您也根本无法在这里构造所需的存在类型。当您尝试返回存在类型列表 ( `return $ dynListToList dl`) 时会出现错误。你打电话的具体类型是什么`dynListToList`？回想一下`dynListToList :: forall a. Typeable a => [Dynamic] -> [a]`；因此，*负责*`randList`挑选要使用的。但它不知道该选哪个；再次，这就是问题的根源！因此，您尝试返回的类型未指定，因此不明确。³ *`a` `dynListToList``a`*

 *## 依赖类型

好的，那么什么*会使*这种存在主义有用（并且可能）？好吧，我们实际上有更多的信息：我们不仅知道有*一些* `a`，我们还有它的`TypeRep`。所以也许我们可以把它打包：

```
randList :: [Dynamic] -> (exists a. Typeable a => IO (TypeRep,[a])) 
```

但是，这还不够好；the`TypeRep`和 the`[a]`根本没有链接。这正是你想要表达的：某种方式来链接`TypeRep`和`a`。

基本上，您的目标是编写类似

```
toType :: TypeRep -> * 
```

这里，`*`是所有类型中的那种；如果您以前没有见过种类，那么它们就是类型，什么类型是值。 `*`对类型`* -> *`进行分类，对单参数类型构造函数等进行分类（例如，`Int :: *`、`Maybe :: * -> *`、`Either :: * -> * -> *`和`Maybe Int :: *`.）

有了这个，你可以写（再一次，这段代码不是有效的 Haskell；事实上，它实际上与 Haskell 只是有一点相似，因为你无法在 Haskell 的类型系统中编写它或类似的东西）：

```
randList :: [Dynamic] -> (exists (tr :: TypeRep).
                           Typeable (toType tr) => IO (tr, [toType tr]))
randList dl = do
  tr <- randItem $ map dynTypeRep dl
  return (tr, dynListToList dl :: [toType tr])
    -- In fact, in an ideal world, the `:: [toType tr]` signature would be
    -- inferable. 
```

现在，您承诺了正确的事情：不是存在某种类型对列表的元素进行分类，而是存在某种`TypeRep`类型使得其对应的类型对​​列表的元素进行分类。如果你能做到这一点，你就会被设置。但是在 Haskell 中编写`toType :: TypeRep -> *`是完全不可能的：这样做需要依赖类型的语言，因为`toType tr`它是一种依赖于值的类型。

这是什么意思？在 Haskell 中，值依赖于其他值是完全可以接受的。这就是函数。例如， value`head "abc"`取决于 value `"abc"`。同样，我们有类型构造函数，因此类型依赖于其他类型是可以接受的；考虑一下`Maybe Int`，怎么看`Int`。我们甚至可以拥有取决于类型的值！考虑`id :: a -> a`。这实际上是一系列函数：`id_Int :: Int -> Int`、`id_Bool :: Bool -> Bool`等。我们拥有哪一个取决于 的类型`a`。（真的，`id = \(a :: *) (x :: a) -> x`; 虽然我们不能在 Haskell 中编写这个，但我们可以使用其他语言。）

然而，至关重要的是，我们永远不能拥有依赖于值的类型。我们可能*想要*这样一个东西：想象一下`Vec 7 Int`，长度为 7 的整数列表的类型。这里，`Vec :: Nat -> * -> *`: 一个类型，其第一个参数必须是 type 的值`Nat`。但是我们不能在 Haskell 中编写这种东西。⁴ 支持这一点的语言被称为*依赖类型*`id`（我们可以像上面那样编写）；示例包括[Coq](http://coq.inria.fr/)和[Agda](http://wiki.portal.chalmers.se/agda/pmwiki.php)。（此类语言通常兼作证明助手，通常用于研究工作而不是编写实际代码。依赖类型很难，使它们对日常编程有用是一个活跃的研究领域。）

因此，在 Haskell 中，我们可以先检查关于类型的所有内容，*丢弃所有信息*，然后编译仅引用值的内容。事实上，这正是 GHC 所做的；因为在 Haskell 中我们永远无法在运行时检查类型，所以 GHC 在编译时擦除所有类型而不改变程序的运行时行为。这就是为什么`unsafeCoerce`易于实现（操作上）并且完全不安全的原因：在运行时，它是无操作的，但它取决于类型系统。`toType`因此，在 Haskell 类型系统中完全不可能实现类似的东西。

事实上，正如您所注意到的，您甚至无法写下所需的类型并使用`unsafeCoerce`. 对于某些问题，您可以摆脱它；我们可以写下函数的类型，但只能通过作弊来实现。这正是它的`fromDynamic`工作原理。但正如我们在上面看到的，在 Haskell 中甚至没有一个很好的类型可以解决这个问题。虚`toType`函数允许你给程序一个类型，但你甚至不能写下`toType`的类型！

## 现在怎么办？

所以，你不能这样做。你*应该*怎么做？我的猜测是您的整体架构对于 Haskell 来说并不理想，尽管我还没有看到它；`Typeable`并且`Dynamic`实际上并没有在 Haskell 程序中出现那么多。（正如他们所说，也许您“说的是带有 Python 口音的 Haskell”。）如果您只有一组有限的数据类型要处理，您也许可以将事物捆绑到一个普通的旧代数数据类型中：

```
data MyType = MTInt Int | MTBool Bool | MTString String 
```

然后您可以编写`isMTInt`，并且只需使用`filter isMTInt`, 或`filter (isSameMTAs randomMT)`。

虽然我不知道它是什么，但可能有一种方法*可以* `unsafeCoerce`解决这个问题。但坦率地说，这不是一个好主意，除非你真的、真的、真的、真的、真的、*真的*知道你在做什么。即便如此，也可能不是。如果你需要`unsafeCoerce`，你就会知道，这不仅仅是一件方便的事情。

我真的同意[Daniel Wagner 的评论](https://stackoverflow.com/questions/12273982/programmatic-type-annotations-in-haskell#comment16462140_12273982)：您可能想要从头开始重新考虑您的方法。不过，再一次，因为我还没有看到你的架构，我不能说这意味着什么。如果你能提炼出一个具体的困难，也许那里还有另一个 Stack Overflow 问题。

* * *

¹如下所示：

```
{-# LANGUAGE ExistentialQuantification #-}
data TypeableList = forall a. Typeable a => TypeableList [a]
randList :: [Dynamic] -> IO TypeableList 
```

但是，由于无论如何这些代码都没有编译，我认为用它写出来`exists`更清晰。

²从技术上讲，还有一些看起来相关的其他函数，例如[`toDyn :: Typeable a => a -> Dynamic`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Dynamic.html#v:toDyn)和[`fromDyn :: Typeable a => Dynamic -> a -> a`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Dynamic.html#v:fromDyn)。但是，`Dynamic`它或多或少是 s 的存在包装器`Typeable`，依赖于`typeOf`and `TypeRep`s 知道何时执行`unsafeCoerce`（GHC 使用一些特定于实现的类型 and `unsafeCoerce`，但你可以这样做，除了/*可能*例外），所以不做任何新的事情。并且并不真正期望它的参数 type ；它只是一个包装器。这些功能以及其他类似功能不提供任何额外的功能，而这些功能是 和 所不具备的。（例如，*回到*一个`dynApply``dynApp``toDyn``fromDyn``a``cast``typeOf``cast`*`Dynamic`对您的问题不是很有用！）*

 *³要查看实际的错误，您可以尝试编译以下完整的 Haskell 程序：

```
{-# LANGUAGE ExistentialQuantification #-}
import Data.Dynamic
import Data.Typeable
import Data.Maybe

randItem :: [a] -> IO a
randItem = return . head -- Good enough for a short and non-compiling example

dynListToList :: Typeable a => [Dynamic] -> [a]
dynListToList = mapMaybe fromDynamic

data TypeableList = forall a. Typeable a => TypeableList [a]

randList :: [Dynamic] -> IO TypeableList
randList dl = do
  tr <- randItem $ map dynTypeRep dl
  return . TypeableList $ dynListToList dl -- Error!  Ambiguous type variable. 
```

果然，如果你尝试编译它，你会得到错误：

```
SO12273982.hs:17:27:
    Ambiguous type variable `a0' in the constraint:
      (Typeable a0) arising from a use of `dynListToList'
    Probable fix: add a type signature that fixes these type variable(s)
    In the second argument of `($)', namely `dynListToList dl'
    In a stmt of a 'do' block: return . TypeableList $ dynListToList dl
    In the expression:
      do { tr <- randItem $ map dynTypeRep dl;
           return . TypeableList $ dynListToList dl } 
```

但是问题的重点是，您*不能*“添加修复这些类型变量的类型签名”，因为您不知道自己想要什么类型。

⁴大部分。GHC 7.4 支持将类型提升到种类和种类多态性；请参阅[GHC 7.4 用户手册中的第 7.8 节“种类多态性和提升”](http://www.haskell.org/ghc/docs/7.4-latest/html/users_guide/kind-polymorphism-and-promotion.html)。这不会使 Haskell 依赖类型化——类似`TypeRep -> *`example 的东西仍然没有^(5——)但您将能够使用*看起来*像值`Vec`的非常富有表现力的类型来编写。

 *⁵从技术上讲，您现在可以写下*看起来*具有所需类型的内容：`type family ToType :: TypeRep -> *`. 但是，这需要提升*kind*的*类型*，而不是*type的**值*；此外，您仍然无法实现它。（至少我不这么认为，我看不出你会怎么做——但我不是这方面的专家。）但在这一点上，我们还很遥远。 *`TypeRep` **`TypeRep`***

 **** * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-05T07:13:14.507

您观察到的是该类型`TypeRep`实际上并没有携带任何类型级别的信息。只有术语级别的信息。这是一种耻辱，但是当我们知道我们关心的所有类型构造函数时，我们可以做得更好。例如，假设我们只关心`Int`s、列表和函数类型。

```
{-# LANGUAGE GADTs, TypeOperators #-}

import Control.Monad

data a :=: b where Refl :: a :=: a
data Dynamic where Dynamic :: TypeRep a -> a -> Dynamic
data TypeRep a where
    Int   :: TypeRep Int
    List  :: TypeRep a -> TypeRep [a]
    Arrow :: TypeRep a -> TypeRep b -> TypeRep (a -> b)

class Typeable a where typeOf :: TypeRep a
instance Typeable Int where typeOf = Int
instance Typeable a => Typeable [a] where typeOf = List typeOf
instance (Typeable a, Typeable b) => Typeable (a -> b) where
    typeOf = Arrow typeOf typeOf

congArrow :: from :=: from' -> to :=: to' -> (from -> to) :=: (from' -> to')
congArrow Refl Refl = Refl

congList :: a :=: b -> [a] :=: [b]
congList Refl = Refl

eq :: TypeRep a -> TypeRep b -> Maybe (a :=: b)
eq Int Int = Just Refl
eq (Arrow from to) (Arrow from' to') = liftM2 congArrow (eq from from') (eq to to')
eq (List t) (List t') = liftM congList (eq t t')
eq _ _ = Nothing

eqTypeable :: (Typeable a, Typeable b) => Maybe (a :=: b)
eqTypeable = eq typeOf typeOf

toDynamic :: Typeable a => a -> Dynamic
toDynamic a = Dynamic typeOf a

-- look ma, no unsafeCoerce!
fromDynamic_ :: TypeRep a -> Dynamic -> Maybe a
fromDynamic_ rep (Dynamic rep' a) = case eq rep rep' of
    Just Refl -> Just a
    Nothing   -> Nothing

fromDynamic :: Typeable a => Dynamic -> Maybe a
fromDynamic = fromDynamic_ typeOf 
```

以上都是很标准的。有关设计策略的更多信息，您需要阅读 GADT 和单例类型。现在，您要编写的函数如下；这种类型看起来有点愚蠢，但请耐心等待。

```
-- extract only the elements of the list whose type match the head
firstOnly :: [Dynamic] -> Dynamic
firstOnly [] = Dynamic (List Int) []
firstOnly (Dynamic rep v:xs) = Dynamic (List rep) (v:go xs) where
    go [] = []
    go (Dynamic rep' v:xs) = case eq rep rep' of
        Just Refl -> v : go xs
        Nothing   ->     go xs 
```

在这里，我们选择了一个随机元素（我掷了一个骰子，结果是 1），并且只从动态值列表中提取了具有匹配类型的元素。现在，我们*可以*`Dynamic`对标准库中的常规无聊旧版本做同样的事情；但是，我们*无法*以有意义的方式使用 the `TypeRep`。我现在证明我们可以这样做：我们将在 上进行模式匹配`TypeRep`，然后在`TypeRep`告诉我们的特定类型处使用封闭的值。

```
use :: Dynamic -> [Int]
use (Dynamic (List (Arrow Int Int)) fs) = zipWith ($) fs [1..]
use (Dynamic (List Int) vs) = vs
use (Dynamic Int v) = [v]
use (Dynamic (Arrow (List Int) (List (List Int))) f) = concat (f [0..5])
use _ = [] 
```

请注意，在这些等式的右侧，我们使用*不同的具体类型*的包装值；上的模式匹配`TypeRep`实际上是在引入类型级别的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-05T12:51:10.000

您需要一个根据运行时数据选择不同类型的值返回的函数。好，太棒了。但是类型的全部*目的*是告诉您可以对值执行哪些操作。当你不知道函数会返回什么类型时，你会*如何*处理它返回的值？您可以对它们执行哪些操作？有两种选择：

*   您想读取类型，并根据它的类型执行一些行为。在这种情况下，您只能满足事先已知的有限类型列表，主要是通过测试“是这种类型吗？然后我们执行此操作......”。这在当前`Dynamic`框架中很容易实现：只需返回`Dynamic`对象，使用`dynTypeRep`过滤它们，然后将应用程序留给`fromDynamic`任何想要使用您的结果的人。`Dynamic`此外，如果您不介意在生产者代码而不是消费者代码中设置类型的有限列表，则很可能没有`data Thing = Thing1 Int | Thing2 String | Thing3 (Thing,Thing)`. 如果可能的话，后一种选择是迄今为止最好的。
*   您希望执行一些适用于一系列类型的操作，其中可能有一些您还不知道，例如通过使用类型类操作。这更棘手，在概念上也很棘手，因为您的程序不允许根据某些类型类实例是否存在来改变*行为*- 这是类型类系统的一个重要属性，即引入新实例可以使程序类型检查或停止类型检查，但它不能改变程序的行为。因此，如果您的输入列表包含不适当的类型，您就不能抛出错误，所以我真的不确定您可以做的任何事情本质上并不涉及在某个时候回退到第一个解决方案。*******

# html - 删除布局中的元素会破坏布局

> ID：12273984
> 
> 赞同：0
> 
> 时间：2012-09-05T03:07:47.523
> 
> 标签：html, css

当我从以下代码中删除注释部分时，它会破坏整个布局。这很奇怪，因为被注释掉的 div 和 table 不应该影响整个布局。为什么会这样？

```
<html>
<head>
<title> Packard Carburetors </title>
<link rel="stylesheet" type="text/css" href="css/reset.css" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
</head>
<body>

<div class="wrapper">

<div id="header">
    <h1 id="banner">Packard Carburetors</h1>
</div><!--Header-->

<div id="navbar" class="green">
    <ul id="navigation">
        <li>HOME</li>
        <li>PACKARD
            <ul class="sub-nav">
                <li>-1930 Speedster</li>
                <li>-1929-31 Super 8</li>
                <li>-Late 1931-32 Super 8</li>
                <li>-1929-31 Standard 8</li>
                <li>-Late 1931-32 Standard 8</li>
                <li>-Rare Parts</li>
                <li class="last">-745 Parts</li>
            </ul>
        </li>
        <li>CADILLAC
            <ul class="sub-nav">
                <li>-1932-33 V12 & V16</li>
                <li class="last">-1934-1937 V12 & V16</li>
            </ul>
        </li>
        <li>SHOPPING CART</li>
        <li>CHECK OUT</li>
        <li>CONTACT US</li>
    </ul><!--Navigation-->

    <img id="#navbar-logo" src="img/logo.png">
    <p id="nav-phone" class="black center bold">775.842.4282</p>
    <p class="black center nav-small bold">packardcarbs@gmail.com</p>
    <p class="black center nav-small bold">Sparks, NV USA</p>
</div><!--Navbar-->

<div id="content">

    <h1 class="home-banner green center bold">All Packard Carburetors 1929-'32</h1>
    <h2 class="home-banner green center bold">1930 Speedster <span class="black">|</span> 1929-32 Super 8 <span class="black">|</span> 1929-32 Standard 8</h2>
    <hr>
    <h1 class="home-banner green center bold">Cadillac Carburetors</h1>
    <h2 class="home-banner green center bold">1932 - 1937 V-12 & V-16</h2>

    <img id="detroit-lubricator" src="img./detroit-lubricator.png">

    <div id="middle-column">
        <ul id="feature-list-home">
            <li>Silicone Bronze Investment Casting</li>
            <li>Precision CNC Brass Machine Parts</li>
            <li>Viton-Tipped Needles</li>
            <li>Current Design
                <ul id="sub-feature-list-home">
                    <li>-Needle Seats</li>
                    <li>-Pressure Valves</li>
                </ul>
            </li>
            <li>Authentic Polished Brass Components</li>
            <li>Gasoline and Ethanol Proof Exterior Coating</li>
            <li>Exact Size as Original</li>
        </ul>

        <!--<img id="middle-bar-spacer" src="img/divider-bar.png">

        <div id="box-and-copy">
            <img id="boxes" src="img/packard-boxes.png">

            <p class="bold">All Components In-Stock!</p>
            <p>Your Carburetor will be professionally assembled, engine tested and shipped quickly worldwide.</p>
        </div><!-- Box and copy -->

    </div><!--Middle Column -->

    <div id="right-column">
        <!--<table>
            <tr>
                <td><img src="img/carb-1.png"></td>
                <td><img src="img/carb-1.png"></td>
            </tr>
            <tr>
                <td>1930 Speedster</td>
                <td>1929-1931 Super 8</td>
            </tr>
            <tr>
                <td><img src="img/carb-3.png"></td>
                <td><img src="img/carb-4.png"></td>
            </tr>
            <tr>
                <td>1932 Super 8</td>
                <td>1929-1931 Standard 8</td>
            </tr>
            <tr>
                <td><img src="img/box.png"></td>
                <td><img src="img/carb-5.png"></td>
            </tr>
            <tr>
                <td></td>
                <td>1932 Standard 8</td>
            </tr>
        </table>-->
    </div> <!--Right Column-->
    <div class="clear"></div>

    <img class="bottom-spacer" src="img/spacer-bottom.png">

</div><!--Content-->

</div><!--Wrapper-->

</body>
</html> 
```

CSS：

```
/*General styles*/

.wrapper {
    width: 940px;
    margin: 0 auto;
    text-align: left;
    background-image: url('../img/body-bg.png');
    background-repeat: repeat-y;
    overflow: auto;
}

body {
    font-family: Arial, "Helvetica Neue", Helvetica, sans-serif;
    font-size: 12px;
}

h1 {
    font-size: 3em;
}

h2 {
    font-size: 2em;
}

#content {
    float: left;
    width: 700px;
    padding: 10px 0px 0px 20px;

}

#banner {
    display: inline-block;
    text-indent: -9999px;
    width: 940px;
    height: 201;
    background-image: url('../img/banner.png');
}

.clear {
    clear: both;
}

/* Nav Stuff */

#navbar {
    width: 190px;
    font-weight: bold;
    font-size: 1.33em;
    padding: 20px 20px 0px 10px;
    float: left;
}

#navigation li {
    padding-bottom: 20px;
}

.sub-nav{
    font-size: .87em;
    padding-top: 20px;
    padding-left: 2.5em;
}

#navigation li ul.sub-nav li.last {
    padding-bottom: 0px;
}

#nav-phone {
    font-size: 1.19em;
    padding-top: 15px;
}

.nav-small {
    font-size: .75em;
    padding-top: 5px;
}

/* Middle Column */
#middle-column{
    width: 220px;
    float: left;
    padding-right: 20px;
    margin-top: 40px;
    border-right: 2px solid #000000;
}

#feature-list-home {
    list-style-image: url('../img/bullet.png');
    font-size: 1.17em;
    padding-left: 20px;
    font-weight: bold;
    padding-bottom: 40px;
}

#feature-list-home li {
    padding-bottom: 20px;
}

#sub-feature-list-home {
    padding-left: 10px;
}

#sub-feature-list-home li {
    padding-bottom: 0px;
}

#middle-bar-spacer {
    padding-bottom: 20px;
}

#boxes {
    padding-bottom: 10px;
}

#box-and-copy {
    font-size: 1.33em;
    line-height: 1.5em;
    text-align: center;
}

/* Home Page Right Column */

#right-column {
    float: left;
    width: 420px;
    padding-left: 30px;
    padding-top: 20px;
    overflow: hidden;
}

#right-column table {
    text-align: center;
    font-weight: bold;
    line-height: 3em;
}

#right-column table td {
    width:210px;
}

/* Home Content Banner Stuff */

.home-banner {
    line-height: 1.25em;
}

#detroit-lubricator {
    margin-top: 10px;
}

/* Footer */
.bottom-spacer {
    padding-bottom: 50px;
}

/* OOCSS properties */

.green{
    color: #117041;
}

.black{
    color: #000000;
}

.center {
    text-align: center;
}

.bold {
    font-weight: bold;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:42:44.320

这是由于导航栏中的某些内容溢出并破坏了布局造成的。当导航设置为溢出时它解决了：隐藏。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-05T03:12:09.897

这是由于没有关闭的开始评论标签`img`

```
<!--<img id="middle-bar-spacer" src="img/divider-bar.png"> 
```

# c++ - vim 插件，用于探索由 c/c++ 编写的宏

> ID：12273993
> 
> 赞同：2
> 
> 时间：2012-09-05T03:08:53.170
> 
> 标签：c++, c, vim, macros

有没有可以在 vim 中扩展 c/c++ 宏的插件？比如[Netbeans](http://netbeans.org/kb/docs/cnd/macro-features.html)呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T03:19:28.957

[Vim C++ 类宏扩展脚本](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CB4QFjAA&url=http://cs-haven.blogspot.com/2009/04/vim-c-macro-like-expansion-script.html&ei=CsRGUPboA8TQsgbWnoHoBg&usg=AFQjCNEWY7jteQxdo9zMzzAeIMJOyW8pEg&sig2=zirF13ExJHp_4pVqRKmMuQ)

# c# - 在 WCF 中运行批处理文件时，如何将登录身份验证属性添加到目录路径？

> ID：12273997
> 
> 赞同：0
> 
> 时间：2012-09-05T03:10:06.670
> 
> 标签：c#, process, file-permissions

我的 WCF 服务中有类来执行批处理文件。当我测试在共享目录中运行批处理文件时，一切都很好，批处理已执行，但是当我尝试从安全目录运行批处理文件时，我收到错误**"ACCESS DENIED"**。如何添加登录属性以便我可以访问我的安全目录来执行我的批处理文件？

这是我的代码：

```
public string ExecuteBat()
{   
  string hasil = "";
  ProcessStartInfo processInfo = new ProcessStartInfo(@"D:\Secure\command.bat");
  processInfo.CreateNoWindow = true;
  processInfo.UseShellExecute = false;
  Process process = Process.Start(processInfo);
  process.WaitForExit();
  if (process.ExitCode == 0) 
  { 
    hasil = "BAT EXECUTED!"; 
  }
  else 
  { 
    hasil = "EXECUTE BAT FAILED"; 
  }
  return hasil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T09:36:00.503

该类`ProcessStartInfo`具有 的属性`Domain`，`UserName`并且`Password`当设置时，在这些凭据下启动进程，如下所示：

```
ProcessStartInfo processInfo = new ProcessStartInfo(@"D:\Rpts\SSIS_WeeklyFlash_AAF_1.bat");
processInfo.CreateNoWindow = true;
processInfo.UseShellExecute = false;
processInfo.Domain= "MyCompanyDomain";
processInfo.UserName = "username";
//Secure string is an odd beast, so you need something like this:
SecureString ss = new SecureString();
string password = "p@$$w0rd";
foreach (char c in password)
{
  ss.AppendChar(c);
}
processInfo.Password = ss;
... 
```

# ruby-on-rails - Rails：在 URL 中传递变量

> ID：12273998
> 
> 赞同：1
> 
> 时间：2012-09-05T03:10:18.907
> 
> 标签：ruby-on-rails, url, variables, routes

我正在尝试访问我希望使用基于 URL 中的变量的信息填充的 rails 应用程序中的资源。给定网址：

```
someapp.com/resources/variable/resource 
```

我想将 传递`variable`给 Rails 以将元素添加到`resource`. 是否有任何快速的重新路由方式来实现这一目标？或者它非常复杂？

干杯!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-05T03:15:14.323

这其中的任何部分都不应该“非常复杂”，但是您要完成的工作还不是很清楚。

您可以尝试添加带有可变段的路线：

```
get "/resources/:variable/resource" => "controller#action" 
```

然后，在您的控制器中，访问`params[:variable]`.

* * *

如果您已经定义了资源，则可以通过以下方式添加额外的“成员”路由：

```
resource :resources do
  get :resource, on: member

  # or

  member do
    get :resource
  end
end 
```

前面的任何一个都将允许您的控制器路由`/resources/:resource_id/resource`到资源控制器的`resource`操作。

# asp.net-mvc-3 - MVC3 重置验证器.setDefaults({ onfocusout: false })

> ID：12273999
> 
> 赞同：0
> 
> 时间：2012-09-05T03:10:19.287
> 
> 标签：asp.net-mvc-3, validation, telerik, client

我正在使用 MVC3。在客户端验证时遇到问题。当我专注于某个输入字段并单击提交时，表单将验证并显示消息。但是，其他一些字段则没有。它只是为自己验证，当我单击提交时它捕获 onblur 事件并忽略提交事件（它处理此表单的有效（））而不是此表单中的所有字段。我不知道原因（顺便说一句，我正在使用 Telerik）

我的解决方案是：将 onfocusout 设置为 false 以使提交按钮工作并验证我的表单。（实际上，我没有更改调用`$('form').valid()`，在任何事件之前运行字段的 onblur。）提交后，我想将 setdefault 更改为 true为了在用户失去对某个领域的关注时实时验证。

所以，我的问题是。在这种情况下，我有任何解决方案。**如果没有，我如何重置默认验证器 onfocusout。**
提前致谢。

添加信息：如果我删除所有 CSS，它工作正常。问题是什么？

```
<link href="../../Assets/Css/Default.css" rel="stylesheet" type="text/css" />
<link href="../../Assets/Css/MenuStyle.css" rel="stylesheet" type="text/css" />
<link href="../../Assets/Css/ui-base/jquery.ui.all.css" rel="stylesheet" type="text/css" />
<link href="../../Assets/Css/telerik.vista.min.css" rel="stylesheet" type="text/css" />
<link href="../../Assets/Css/telerik.common.min.css" rel="stylesheet" type="text/css" />
<link href="../../Assets/Css/Custom.css" rel="stylesheet" type="text/css" />
<link href="../../Content/telerik-extensions.css" rel="stylesheet" type="text/css" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T02:14:34.387

谢谢，我发现问题是我的 css 类使错误位置显示消息太窄。错误消息以多行显示。当我单击提交按钮时，会触发 focusout 事件并显示错误，这会使我的提交按钮移出其位置并且不会执行单击事件。