# StackOverflow 问答 000052000-000052999

# string - 如何检查给定的字符串是否是回文？

> ID：52002
> 
> 赞同：57
> 
> 时间：2008-09-09T14:24:27.053
> 
> 标签：string, language-agnostic

**定义：**

*回文是一个单词、短语、数字或其他单位序列，具有在任一方向阅读相同的属性*

如何检查给定的字符串是否是回文？

这是前一段时间的 FAIQ [常见面试问题] 之一，但主要使用 C。

寻找任何和所有语言的解决方案。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-09T14:42:18.010

**PHP 示例**：

```
$string = "A man, a plan, a canal, Panama";

function is_palindrome($string)
{
    $a = strtolower(preg_replace("/[^A-Za-z0-9]/","",$string));
    return $a==strrev($a);
} 
```

删除任何非字母数字字符（空格、逗号、感叹号等）以允许使用上述完整句子以及简单单词。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-09-09T14:36:32.267

Windows XP（可能也适用于 2000）或更高版本的 BATCH 脚本：

```
@echo off

call :is_palindrome %1
if %ERRORLEVEL% == 0 (
    echo %1 is a palindrome
) else (
    echo %1 is NOT a palindrome
)
exit /B 0

:is_palindrome
    set word=%~1
    set reverse=
    call :reverse_chars "%word%"
    set return=1
    if "$%word%" == "$%reverse%" (
        set return=0
    )
exit /B %return%

:reverse_chars
    set chars=%~1
    set reverse=%chars:~0,1%%reverse%
    set chars=%chars:~1%
    if "$%chars%" == "$" (
        exit /B 0
    ) else (
        call :reverse_chars "%chars%"
    )
exit /B 0 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-09-09T14:29:58.880

语言不可知的元代码然后......

```
rev = StringReverse(originalString)
return ( rev == originalString ); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-09-09T14:38:07.270

**C#**就地算法。任何预处理，例如不区分大小写或去除空格和标点符号，都应在传递给此函数之前完成。

```
boolean IsPalindrome(string s) {
    for (int i = 0; i < s.Length / 2; i++)
    {
        if (s[i] != s[s.Length - 1 - i]) return false;
    }
    return true;
} 
```

* * *

**编辑：**删除了循环条件中不必要的“ `+1`”，并将保存的比较用于删除多余的长度比较。感谢评论者！

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-09-09T14:37:04.573

C#: LINQ

```
var str = "a b a";
var test = Enumerable.SequenceEqual(str.ToCharArray(), 
           str.ToCharArray().Reverse()); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-09T19:52:33.677

[Hal 的 Ruby 版本](https://stackoverflow.com/questions/52002/how-to-check-if-the-given-string-is-palindrome#52328)的更 Ruby 风格的重写：

```
class String
  def palindrome?
    (test = gsub(/[^A-Za-z]/, '').downcase) == test.reverse
  end
end 
```

现在您可以调用`palindrome?`任何字符串。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-09-09T14:34:32.067

未优化的 Python：

```
>>> def is_palindrome(s):
...     return s == s[::-1] 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-09-09T14:41:02.817

Java解决方案：

```
public class QuickTest {

public static void main(String[] args) {
    check("AmanaplanacanalPanama".toLowerCase());
    check("Hello World".toLowerCase());
}

public static void check(String aString) {
    System.out.print(aString + ": ");
    char[] chars = aString.toCharArray();
    for (int i = 0, j = (chars.length - 1); i < (chars.length / 2); i++, j--) {
        if (chars[i] != chars[j]) {
            System.out.println("Not a palindrome!");
            return;
        }
    }
    System.out.println("Found a palindrome!");
} 
```

}

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-09T22:01:54.647

C在屋子里。（不确定您是否不想要这里的 C 示例）

```
bool IsPalindrome(char *s)
{
    int  i,d;
    int  length = strlen(s);
    char cf, cb;

    for(i=0, d=length-1 ; i < length && d >= 0 ; i++ , d--)
    {
        while(cf= toupper(s[i]), (cf < 'A' || cf >'Z') && i < length-1)i++;
        while(cb= toupper(s[d]), (cb < 'A' || cb >'Z') && d > 0       )d--;
        if(cf != cb && cf >= 'A' && cf <= 'Z' && cb >= 'A' && cb <='Z')
            return false;
    }
    return true;
} 
```

对于“racecar”、“Racecar”、“race car”、“racecar”和“RaCe cAr”，这将返回 true。修改以包含符号或空格也很容易，但我认为只计算字母（并忽略大小写）更有用。这适用于我在此处的答案中找到的所有回文，并且我无法将其欺骗为假阴性/阳性。

此外，如果您不喜欢“C”程序中的 bool，它显然可以返回 int，返回 1 和返回 0 分别表示 true 和 false。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-09-09T14:38:26.020

使用良好的数据结构通常有助于给教授留下深刻印象：

将一半的字符压入堆栈（长度/2）。
弹出并比较每个字符，直到第一个不匹配。
如果堆栈有零个元素：回文。
*对于奇数长度的字符串，丢弃中间的字符。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-09-09T14:35:10.537

这是一种python方式。注意：这并不是真正的“pythonic”，但它演示了算法。

```
def IsPalindromeString(n):
    myLen = len(n)
    i = 0
    while i <= myLen/2:
        if n[i] != n[myLen-1-i]:
            return False
        i += 1
    return True 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-09-09T19:14:26.013

我在这里看到很多不正确的答案。任何正确的解决方案都需要忽略空格和标点符号（以及实际上任何非字母字符），并且需要不区分大小写。

一些很好的示例测试用例是：

“一个人，一个计划，一条运河，巴拿马。”

“丰田就是丰田。”

“一个”

“”

以及一些非回文。

C# 中的示例解决方案（注意：在此设计中，空字符串和空字符串被视为回文，如果不需要，很容易更改）：

```
public static bool IsPalindrome(string palindromeCandidate)
{
    if (string.IsNullOrEmpty(palindromeCandidate))
    {
        return true;
    }
    Regex nonAlphaChars = new Regex("[^a-z0-9]");
    string alphaOnlyCandidate = nonAlphaChars.Replace(palindromeCandidate.ToLower(), "");
    if (string.IsNullOrEmpty(alphaOnlyCandidate))
    {
        return true;
    }
    int leftIndex = 0;
    int rightIndex = alphaOnlyCandidate.Length - 1;
    while (rightIndex > leftIndex)
    {
        if (alphaOnlyCandidate[leftIndex] != alphaOnlyCandidate[rightIndex])
        {
            return false;
        }
        leftIndex++;
        rightIndex--;
    }
    return true;
} 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-09-09T14:33:44.973

```
Delphi

function IsPalindrome(const s: string): boolean;
var
  i, j: integer;
begin
  Result := false;
  j := Length(s);
  for i := 1 to Length(s) div 2 do begin
    if s[i] <> s[j] then
      Exit;
    Dec(j);
  end;
  Result := true;
end; 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2008-09-09T14:42:58.913

编辑：来自评论：

```
bool palindrome(std::string const& s) 
{ 
  return std::equal(s.begin(), s.end(), s.rbegin()); 
} 
```

* * *

c++方式。

我使用优雅的迭代器的幼稚实现。实际上，一旦前向迭代器超过了字符串的中间标记，您可能会检查并停止。

```
#include <string>
#include <iostream>

using namespace std;
bool palindrome(string foo)
{
    string::iterator front;
    string::reverse_iterator back;
    bool is_palindrome = true;
    for(front = foo.begin(), back = foo.rbegin();
        is_palindrome && front!= foo.end() && back != foo.rend();
        ++front, ++back
        )
    {
        if(*front != *back)
            is_palindrome = false;
    }
    return is_palindrome;
}
int main()
{
    string a = "hi there", b = "laval";

    cout << "String a: \"" << a << "\" is " << ((palindrome(a))? "" : "not ") << "a palindrome." <<endl;
    cout << "String b: \"" << b << "\" is " << ((palindrome(b))? "" : "not ") << "a palindrome." <<endl;

} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-09-09T14:29:51.860

```
boolean isPalindrome(String str1) {
  //first strip out punctuation and spaces
  String stripped = str1.replaceAll("[^a-zA-Z0-9]", "");
  return stripped.equalsIgnoreCase((new StringBuilder(stripped)).reverse().toString());
} 
```

爪哇版

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-06-24T16:44:02.627

## 红宝石：

```
class String
    def is_palindrome?
        letters_only = gsub(/\W/,'').downcase
        letters_only == letters_only.reverse
    end
end

puts 'abc'.is_palindrome? # => false
puts 'aba'.is_palindrome? # => true
puts "Madam, I'm Adam.".is_palindrome? # => true 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-09-09T14:30:30.533

这是我在 c# 中的解决方案

```
static bool isPalindrome(string s)
{
    string allowedChars = "abcdefghijklmnopqrstuvwxyz"+
        "1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    string compareString = String.Empty;
    string rev = string.Empty;

    for (int i = 0; i <= s.Length - 1; i++)
    {
        char c = s[i];

        if (allowedChars.IndexOf(c) > -1)
        {
            compareString += c;
        }
    }

    for (int i = compareString.Length - 1; i >= 0; i--)
    {
        char c = compareString[i];
        rev += c;
    }

    return rev.Equals(compareString, 
        StringComparison.CurrentCultureIgnoreCase);
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-09-09T14:39:02.213

这是我的解决方案，不使用 strrev。用 C# 编写，但它适用于任何具有字符串长度函数的语言。

```
private static bool Pal(string s) {
    for (int i = 0; i < s.Length; i++) {
        if (s[i] != s[s.Length - 1 - i]) {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-09-09T14:49:42.907

这是一个处理不同情况、标点符号和空格的 Python 版本。

```
import string

def is_palindrome(palindrome):
    letters = palindrome.translate(string.maketrans("",""),
                  string.whitespace + string.punctuation).lower()
    return letters == letters[::-1] 
```

**编辑：**无耻地从[Blair Conrad 的](https://stackoverflow.com/questions/52002/how-to-check-if-the-given-string-is-palindrome#52023)整洁答案中窃取，以删除我以前版本中略显笨拙的列表处理。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-09-16T21:46:55.840

一个混淆的 C 版本：

```
int IsPalindrome (char *s)
{
  char*a,*b,c=0;
  for(a=b=s;a<=b;c=(c?c==1?c=(*a&~32)-65>25u?*++a,1:2:c==2?(*--b&~32)-65<26u?3:2:c==3?(*b-65&~32)-(*a-65&~32)?*(b=s=0,a),4:*++a,1:0:*++b?0:1));
  return s!=0;
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-11-10T12:09:11.577

## C++

```
std::string a = "god";
std::string b = "lol";

std::cout << (std::string(a.rbegin(), a.rend()) == a) << " " 
          << (std::string(b.rbegin(), b.rend()) == b); 
```

## 重击

```
function ispalin { [ "$( echo -n $1 | tac -rs . )" = "$1" ]; }
echo "$(ispalin god && echo yes || echo no), $(ispalin lol && echo yes || echo no)" 
```

## 牛羚

```
/* obvious solution */
function ispalin(cand, i) { 
    for(i=0; i<length(cand)/2; i++) 
        if(substr(cand, length(cand)-i, 1) != substr(cand, i+1, 1)) 
            return 0; 
    return 1; 
}

/* not so obvious solution. cough cough */
{ 
    orig = $0;
    while($0) { 
        stuff = stuff gensub(/^.*(.)$/, "\\1", 1); 
        $0 = gensub(/^(.*).$/, "\\1", 1); 
    }
    print (stuff == orig); 
} 
```

## 哈斯克尔

在 Haskell 中做一些脑死的方法

```
ispalin :: [Char] -> Bool
ispalin a = a == (let xi (y:my) = (xi my) ++ [y]; xi [] = [] in \x -> xi x) a 
```

## 纯英语

`"Just reverse the string and if it is the same as before, it's a palindrome"`

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-09-12T15:45:58.657

**语言：**

```
(defun palindrome(x) (string= x (reverse x))) 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-09-16T21:56:53.367

请注意，在上述 C++ 解决方案中，存在一些问题。

一种解决方案效率低下，因为它通过复制传递了 std::string，并且因为它迭代了所有字符，而不是只比较一半字符。然后，即使发现字符串不是回文，它也会继续循环，在报告“假”之前等待其结束。

另一个更好，有一个非常小的函数，它的问题是它不能测试除了 std::string 之外的任何东西。在 C++ 中，很容易将算法扩展到一大堆相似的对象。通过将其 std::string 模板化为“T”，它可以在 std::string、std::wstring、std::vector 和 std::deque 上工作。但是由于使用了操作符 < 而没有进行重大修改，std::list 就超出了它的范围。

我自己的解决方案试图表明 C++ 解决方案不会停止在确切的当前类型上工作，而是会努力工作*任何*行为方式相同的东西，无论类型如何。例如，我可以在 std::string、int 向量或“Anything”列表上应用我的回文测试，只要任何东西都可以通过其运算符 =（内置类型和类）进行比较。

请注意，模板甚至可以使用可用于比较数据的可选类型进行扩展。例如，如果您想以不区分大小写的方式进行比较，或者甚至比较相似的字符（如 è、é、ë、ê 和 e）。

就像列奥尼达国王会说的那样：*“模板？这是 C++ ！！！”*

因此，在 C++ 中，至少有 3 种主要的方法可以做到这一点，每一种都导致另一种：

## 解决方案 A：以类似 c 的方式

问题是在 C++0X 之前，我们不能认为 std::string 字符数组是连续的，所以我们必须“作弊”并检索 c_str() 属性。由于我们以只读方式使用它，所以应该没问题...

* * *

```
bool isPalindromeA(const std::string & p_strText)
{
   if(p_strText.length() < 2) return true ;
   const char * pStart = p_strText.c_str() ;             
   const char * pEnd = pStart + p_strText.length() - 1 ; 

   for(; pStart < pEnd; ++pStart, --pEnd)
   {
      if(*pStart != *pEnd)
      {
         return false ;
      }
   }

   return true ;
} 
```

* * *

## 解决方案 B：更“C++”的版本

现在，我们将尝试将相同的解决方案应用于任何通过运算符 [] 随机访问其项目的 C++ 容器。例如，任何 std::basic_string、std::vector、std::deque 等。运算符 [] 是对这些容器的持续访问，因此我们不会失去过度的速度。

* * *

```
template <typename T>
bool isPalindromeB(const T & p_aText)
{
   if(p_aText.empty()) return true ;
   typename T::size_type iStart = 0 ;
   typename T::size_type iEnd = p_aText.size() - 1 ;

   for(; iStart < iEnd; ++iStart, --iEnd)
   {
      if(p_aText[iStart] != p_aText[iEnd])
      {
         return false ;
      }
   }

   return true ;
} 
```

* * *

## 解决方案 C：模板 powah ！

它适用于几乎任何具有双向迭代器的无序类 STL 容器。例如，任何 std::basic_string、std::vector、std::deque、std::list 等。因此，此函数可以应用于所有 STL - 具有以下条件的容器： 1 - T 是具有双向迭代器的容器 2 - T 的迭代器指向可比较的类型（通过运算符 =）

* * *

```
template <typename T>
bool isPalindromeC(const T & p_aText)
{
   if(p_aText.empty()) return true ;
   typename T::const_iterator pStart = p_aText.begin() ;
   typename T::const_iterator pEnd = p_aText.end() ;
   --pEnd ;

   while(true)
   {
      if(*pStart != *pEnd)
      {
         return false ;
      }

      if((pStart == pEnd) || (++pStart == pEnd))
      {
         return true ;
      }

      --pEnd ;
   }
} 
```

* * *

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-09-09T14:39:06.613

此 Java 代码应在**布尔**方法中工作：

**注意**：您只需要检查字符的前半部分与后半部分，否则您会重叠并加倍需要进行检查。

```
private static boolean doPal(String test) {
    for(int i = 0; i < test.length() / 2; i++) {
        if(test.charAt(i) != test.charAt(test.length() - 1 - i)) {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-09-09T15:19:38.560

Smalltalk 中的三个版本，从最愚蠢到正确。

* * *

在 Smalltalk 中，`=`是比较运算符：

```
isPalindrome: aString
    "Dumbest."
    ^ aString reverse = aString 
```

* * *

该消息`#translateToLowercase`以小写形式返回字符串：

```
isPalindrome: aString
    "Case insensitive"
    |lowercase|
    lowercase := aString translateToLowercase.
    ^ lowercase reverse = lowercase 
```

* * *

而在 Smalltalk 中，字符串是`Collection`框架的一部分，你可以使用 message `#select:thenCollect:`，所以这是最后一个版本：

```
isPalindrome: aString
    "Case insensitive and keeping only alphabetic chars
    (blanks & punctuation insensitive)."
    |lowercaseLetters|
    lowercaseLetters := aString
        select: [:char | char isAlphabetic]
        thenCollect: [:char | char asLowercase]. 
    ^ lowercaseLetters reverse = lowercaseLetters 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-09-09T15:27:03.050

另一个 C++ 的。针对速度和大小进行了优化。

```
`bool is_palindrome(const std::string& candidate) {
    for(std::string::const_iterator left = candidate.begin(), right = candidate.end(); left < --right ; ++left)
        if (*left != *right)
            return false;
    return true;
}`
```

* * *

 `## 回答 #27

> 赞同：2
> 
> 时间：2009-03-18T19:40:55.657

一个简单的Java解决方案：

```
public boolean isPalindrome(String testString) {
    StringBuffer sb = new StringBuffer(testString);
    String reverseString = sb.reverse().toString();

    if(testString.equalsIgnoreCase(reverseString)) {
        return true;
    else {
        return false;
    }
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-09-11T10:14:27.340

Python：

```
if s == s[::-1]: return True 
```

爪哇：

```
if (s.Equals(s.Reverse())) { return true; } 
```

PHP：

```
if (s == strrev(s)) return true; 
```

珀尔：

```
if (s == reverse(s)) { return true; } 
```

二郎：

```
string:equal(S, lists:reverse(S)). 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-09-16T02:29:55.463

珀尔：

```
sub is_palindrome {
    my $s = lc shift; # normalize case
    $s =~ s/\W//g;    # strip non-word characters
    return $s eq reverse $s;
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-09-09T22:35:29.010

珀尔：

```
sub is_palindrome($)
{
  $s = lc(shift); # ignore case
  $s =~ s/\W+//g; # consider only letters, digits, and '_'
  $s eq reverse $s;
} 
```

它忽略大小写并去除非字母数字字符（它是区域设置和 unicode 中性的）。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-09-09T23:34:51.100

使用 Java，使用[Apache Commons](http://commons.apache.org/) String Utils：

```
public boolean isPalindrome(String phrase) {
  phrase = phrase.toLowerCase().replaceAll("[^a-z]", "");
  return StringUtils.reverse(phrase).equals(phrase);
} 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2008-09-09T14:37:38.207

有很多方法可以做到。我想关键是以最有效的方式来做（不循环字符串）。我会将它作为一个可以轻松反转的 char 数组（使用 C#）。

```
string mystring = "abracadabra";

char[] str = mystring.ToCharArray();
Array.Reverse(str);
string revstring = new string(str);

if (mystring.equals(revstring))
{
    Console.WriteLine("String is a Palindrome");
} 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-09-09T16:47:15.183

在 Ruby 中，转换为小写字母并去除所有非字母：

```
def isPalindrome( string )
    ( test = string.downcase.gsub( /[^a-z]/, '' ) ) == test.reverse
end 
```

但这感觉像是作弊，对吧？没有指针或任何东西！所以这里也是一个 C 版本，但没有小写和字符剥离的优点：

```
#include <stdio.h>
int isPalindrome( char * string )
{
    char * i = string;
    char * p = string;
    while ( *++i ); while ( i > p && *p++ == *--i );
    return i <= p && *i++ == *--p;
}
int main( int argc, char **argv )
{
    if ( argc != 2 )
    {
        fprintf( stderr, "Usage: %s <word>\n", argv[0] );
        return -1;
    }
    fprintf( stdout, "%s\n", isPalindrome( argv[1] ) ? "yes" : "no" );
    return 0;
} 
```

嗯，这很有趣——我能得到这份工作吗 ;^)

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2008-09-10T06:08:15.367

我必须为编程挑战这样做，这是我的 Haskell 的片段：

```
isPalindrome :: String -> Bool
isPalindrome n = (n == reverse n) 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2015-03-20T19:37:30.430

Simple **JavaScript** solution. Run code snippet for demo.

```
function checkPalindrome(line){
      reverse_line=line.split("").reverse().join("");
      return line==reverse_line;
  }
alert("checkPalindrome(radar): "+checkPalindrome("radar"));
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-07-12T04:45:12.730

> **序言**

```
palindrome(B, R) :-
palindrome(B, R, []).

palindrome([], R, R).
palindrome([X|B], [X|R], T) :-
palindrome(B, R, [X|T]). 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2008-10-23T06:16:13.133

C++：

```
bool is_palindrome(const string &s)
{
    return equal( s.begin(), s.begin()+s.length()/2, s.rbegin());
} 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2011-12-29T19:57:25.613

还没有使用 JavaScript 的解决方案？

```
function palindrome(s) {
  var l = 0, r = s.length - 1;
  while (l < r) if (s.charAt(left++) !== s.charAt(r--)) return false;
  return true
} 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-06-24T16:31:53.253

我的2c。避免每次全字符串反转的开销，利用短路在确定字符串的性质后立即返回。是的，你应该首先调整你的字符串，但 IMO 那是另一个函数的工作。

**在 C# 中**

```
 /// <summary>
    /// Tests if a string is a palindrome
    /// </summary>
    public static bool IsPalindrome(this String str)
    {
        if (str.Length == 0) return false;
        int index = 0;
        while (index < str.Length / 2)
            if (str[index] != str[str.Length - ++index]) return false;

        return true;
    } 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2011-11-18T11:31:03.253

二郎棒棒哒

```
palindrome(L) -> palindrome(L,[]).

palindrome([],_) -> false;
palindrome([_|[]],[]) -> true;
palindrome([_|L],L) -> true;
palindrome(L,L) -> true;
palindrome([H|T], Acc) -> palindrome(T, [H|Acc]). 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-09-15T14:23:24.883

```
boolean IsPalindrome(string s) {
return s = s.Reverse();
} 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-01-10T01:15:14.677

Efficient C++ version:

```
template< typename Iterator >
bool is_palindrome( Iterator first, Iterator last, std::locale const& loc = std::locale("") )
{
    if ( first == last )
        return true;

    for( --last; first < last; ++first, --last )
    {
        while( ! std::isalnum( *first, loc ) && first < last )
            ++first;
        while( ! std::isalnum( *last, loc ) && first < last )
            --last;
        if ( std::tolower( *first, loc ) != std::tolower( *last, loc ) )
            return false;
    }
    return true;
} 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-01-10T01:47:01.043

Here are two more Perl versions, neither of which uses `reverse`. Both use the basic algorithm of comparing the first character of the string to the last, then discarding them and repeating the test, but they use different methods of getting at the individual characters (the first peels them off one at a time with a regex, the second `split`s the string into an array of characters).

```
#!/usr/bin/perl

my @strings = ("A man, a plan, a canal, Panama.", "A Toyota's a Toyota.", 
               "A", "", "As well as some non-palindromes.");

for my $string (@strings) {
  print is_palindrome($string)  ? "'$string' is a palindrome (1)\n"
                                : "'$string' is not a palindrome (1)\n";
  print is_palindrome2($string) ? "'$string' is a palindrome (2)\n"
                                : "'$string' is not a palindrome (2)\n";
} 

sub is_palindrome {
  my $str = lc shift;
  $str =~ tr/a-z//cd;

  while ($str =~ s/^(.)(.*)(.)$/\2/) {
    return unless $1 eq $3;
  }

  return 1;
} 

sub is_palindrome2 {
  my $str = lc shift;
  $str =~ tr/a-z//cd;
  my @chars = split '', $str;

  while (@chars && shift @chars eq pop @chars) {};

  return scalar @chars <= 1;
} 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-01-10T02:08:27.380

Easy mode in C#, only using Base Class Libraries

Edit: just saw someone did Array.Reverse also

```
public bool IsPalindrome(string s)
            {
                if (String.IsNullOrEmpty(s))
                {
                    return false;
                }

                else
                {
                    char[] t = s.ToCharArray();
                    Array.Reverse(t);
                    string u = new string(t);
                    if (s.ToLower() == u.ToLower())
                    {
                        return true;
                    }
                }

                return false;
            } 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2014-05-13T17:38:55.773

带有堆栈的 Java。

```
public class StackPalindrome {
    public boolean isPalindrome(String s) throws OverFlowException,EmptyStackException{
        boolean isPal=false;
        String pal="";
        char letter;
        if (s==" ")
            return true;
        else{   
            s=s.toLowerCase();
            for(int i=0;i<s.length();i++){

            letter=s.charAt(i);

            char[] alphabet={'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'};
            for(int j=0; j<alphabet.length;j++){
                /*removing punctuations*/
                if ((String.valueOf(letter)).equals(String.valueOf(alphabet[j]))){
                    pal +=letter;
                }

            }

        }
        int len=pal.length();
        char[] palArray=new char[len];
        for(int r=0;r<len;r++){
            palArray[r]=pal.charAt(r);
        }
        ArrayStack palStack=new ArrayStack(len);
        for(int k=0;k<palArray.length;k++){
            palStack.push(palArray[k]);
        }
        for (int i=0;i<len;i++){

            if ((palStack.topAndpop()).equals(palArray[i]))
                isPal=true;
            else 
                isPal=false;
        }
    return isPal;
    }
}
public static void main (String args[]) throws EmptyStackException,OverFlowException{

    StackPalindrome s=new StackPalindrome();
    System.out.println(s.isPalindrome("“Ma,” Jerome raps pot top, “Spare more jam!”"));
} 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2008-09-09T14:44:43.963

另一个来自 Delphi，我认为它比提交的另一个 Delphi 示例更严格。这很容易变成一场高尔夫比赛，但我试图让我的可读性。

*Edit0：我对性能特征很好奇，所以我做了一点测试。在我的机器上，我针对一个 60 个字符的字符串运行了这个函数 5000 万次，耗时 5 秒。*

```
function TForm1.IsPalindrome(txt: string): boolean;
var
  i, halfway, len : integer;
begin
  Result := True;
  len := Length(txt);

  {
  special cases:
  an empty string is *never* a palindrome
  a 1-character string is *always* a palindrome
  }
  case len of
    0 : Result := False;
    1 : Result := True;
    else begin
      halfway := Round((len/2) - (1/2));  //if odd, round down to get 1/2way pt

      //scan half of our string, make sure it is mirrored on the other half
      for i := 1 to halfway do begin
        if txt[i] <> txt[len-(i-1)] then begin
          Result := False;
          Break;
        end;  //if we found a non-mirrored character
      end;  //for 1st half of string
    end;  //else not a special case
  end;  //case
end; 
```

在 C# 中，这也是同样的事情，只是我给它留下了多个退出点，这是我不喜欢的。

```
private bool IsPalindrome(string txt) {
  int len = txt.Length;

  /*
  Special cases:
  An empty string is *never* a palindrome
  A 1-character string is *always* a palindrome
  */    
  switch (len) {
    case 0: return false;
    case 1: return true;
  }  //switch
  int halfway = (len / 2);

  //scan half of our string, make sure it is mirrored on the other half
  for (int i = 0; i < halfway; ++i) {
    if (txt.Substring(i,1) != txt.Substring(len - i - 1,1)) {
      return false;
    }  //if
  }  //for
  return true;
} 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2008-09-09T14:49:25.403

C#3 - 一旦从头开始计数的字符与结尾处的等价字符不匹配，就会返回 false：

```
static bool IsPalindrome(this string input)
{
    char[] letters = input.ToUpper().ToCharArray();

    int i = 0;
    while( i < letters.Length / 2 )
        if( letters[i] != letters[letters.Length - ++i] )
            return false;

    return true;
} 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2008-09-10T00:22:50.673

如果我们正在寻找数字和简单的单词，已经给出了许多正确的答案。

然而，如果我们正在寻找我们通常认为的书面回文（例如，“A dog, a panic, in a pagoda!”），正确的答案是从句子的两端开始迭代，*跳过单独的非字母数字字符*，如果发现任何不匹配则返回 false。

```
i = 0; j = length-1;

while( true ) {
  while( i < j && !is_alphanumeric( str[i] ) ) i++;
  while( i < j && !is_alphanumeric( str[j] ) ) j--;

  if( i >= j ) return true;

  if( tolower(string[i]) != tolower(string[j]) ) return false;
  i++; j--;
} 
```

当然，去除无效字符、反转结果字符串并将其与原始字符串进行比较也可以。这取决于您正在使用哪种类型的语言。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2008-09-12T09:47:43.947

OCaml：

```
let rec palindrome s =
  s = (tailrev s) 
```

[资源](http://www.cis.upenn.edu/~lhuang3/cse399-python/handouts/ocaml.ppt)

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2009-01-10T02:46:45.493

这是我在执行示例服务器控件时使用的另一个 C#。它可以在 ASP.NET 3.5 Step by Step (MS Press) 一书中找到。这是两种方法，一种是去除非字母数字，另一种是检查回文。

```
protected string StripNonAlphanumerics(string str)
{
    string strStripped = (String)str.Clone();
    if (str != null)
    {
        char[] rgc = strStripped.ToCharArray();
        int i = 0;
        foreach (char c in rgc)
        {
            if (char.IsLetterOrDigit(c))
            {
                i++;
            }
            else
            {
                strStripped = strStripped.Remove(i, 1);
            }
        }
    }
    return strStripped;
}
protected bool CheckForPalindrome()
{
    if (this.Text != null)
    {
        String strControlText = this.Text;
        String strTextToUpper = null;
        strTextToUpper = Text.ToUpper();
        strControlText =
                    this.StripNonAlphanumerics(strTextToUpper);
        char[] rgcReverse = strControlText.ToCharArray();
        Array.Reverse(rgcReverse);
        String strReverse = new string(rgcReverse);
        if (strControlText == strReverse)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2009-01-10T03:07:59.427

常量正确的 C/C++ 指针解决方案。循环中的最小操作。

```
int IsPalindrome (const char *str)
{
    const unsigned len = strlen(str);
    const char *end = &str[len-1];
    while (str < end)
        if (*str++ != *end--)
            return 0;
    return 1;
} 
```

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2015-04-12T08:44:50.537

```
public static boolean isPalindrome(String str) {
    return str.equals(new StringBuilder(str).reverse().toString());
} 
```

对于早于 1.5 的 Java 版本，

```
public static boolean isPalindrome(String str) {
    return str.equals(new StringBuffer().append(str).reverse().toString());
} 
```

或者

```
public static boolean istPalindrom(char[] word){
    int i1 = 0;
    int i2 = word.length - 1;
    while (i2 > i1) {
        if (word[i1] != word[i2]) {
            return false;
        }
        ++i1;
        --i2;
    }
    return true;
} 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2008-11-10T12:05:24.877

这一切都很好，但是有没有办法在算法上做得更好？我曾经在一次采访中被要求识别线性时间和*恒定空间*中的回文。

我当时什么都想不出来，现在还是想不出来。

（如果有帮助，我问面试官答案是什么。他说你可以构造一对散列函数，当且仅当该字符串是回文时，它们才能将给定的字符串散列到相同的值。我不知道如何你实际上会做这对功能。）

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2008-11-10T14:35:51.607

去除不属于 AZ 或 az 之间的任何字符的解决方案非常以英语为中心。带有 à 或 é 等变音符号的字母将被删除！

根据维基百科：

> 变音符号的处理方式各不相同。在捷克语和西班牙语等语言中，带有变音符号或重音符号（波浪号除外）的字母在字母表中没有单独的位置，因此无论重复的字母是否有装饰，都可以保留回文。但是，在瑞典语和其他北欧语言中，带环 (å) 的 A 和 A 是不同的字母，必须完全镜像才能被视为真正的回文。

因此，要涵盖许多其他语言，最好使用排序规则将变音符号转换为等效的非变音符号，或者酌情保留，然后仅在比较之前去除空格和标点符号。

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2008-12-16T14:44:13.380

```
set l = index of left most character in word
set r = index of right most character in word

loop while(l < r)
begin
  if letter at l does not equal letter at r
    word is not palindrome
  else
     increase l and decrease r
end
word is palindrome 
```

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2008-10-23T06:16:55.893

这里没有一个*解决*方案考虑回文也可以基于单词单元，而不仅仅是字符单元。

这意味着对于像“女孩，穿着比基尼洗澡，盯着男孩，看到男孩在洗澡的女孩身上盯着比基尼”这样的回文，没有一个给定的解决方案是正确的。

这是 C# 中的一个 hacked together 版本。我确信它不需要正则表达式，但它与上述比基尼回文一样有效，就像它与“一个男人，一个计划，一条运河-巴拿马！”一样。

```
 static bool IsPalindrome(string text)
    {
        bool isPalindrome = IsCharacterPalindrome(text);
        if (!isPalindrome)
        {
            isPalindrome = IsPhrasePalindrome(text);
        }
        return isPalindrome;
    }

    static bool IsCharacterPalindrome(string text)
    {
        String clean = Regex.Replace(text.ToLower(), "[^A-z0-9]", String.Empty, RegexOptions.Compiled);
        bool isPalindrome = false;
        if (!String.IsNullOrEmpty(clean) && clean.Length > 1)
        {
            isPalindrome = true;
            for (int i = 0, count = clean.Length / 2 + 1; i < count; i++)
            {
                if (clean[i] != clean[clean.Length - 1 - i])
                {
                    isPalindrome = false; break;
                }
            }
        }
        return isPalindrome;
    }

    static bool IsPhrasePalindrome(string text)
    {
        bool isPalindrome = false;
        String clean = Regex.Replace(text.ToLower(), @"[^A-z0-9\s]", " ", RegexOptions.Compiled).Trim();
        String[] words = Regex.Split(clean, @"\s+");
        if (words.Length > 1)
        {
            isPalindrome = true;
            for (int i = 0, count = words.Length / 2 + 1; i < count; i++)
            {
                if (words[i] != words[words.Length - 1 - i])
                {
                    isPalindrome = false; break;
                }
            }
        }
        return isPalindrome;
    } 
```

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2008-11-04T21:05:13.710

我还没有看到任何递归，所以这里......

```
import re

r = re.compile("[^0-9a-zA-Z]")

def is_pal(s):

    def inner_pal(s):
        if len(s) == 0:
            return True
        elif s[0] == s[-1]:
            return inner_pal(s[1:-1])
        else:
            return False

    r = re.compile("[^0-9a-zA-Z]")
    return inner_pal(r.sub("", s).lower()) 
```

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2010-05-01T22:14:01.277

C#版本：

假设 MyString 是一个 char[]，方法在验证字符串后返回，它忽略空格和 <,>，但这可以扩展为忽略更多，可能实现忽略列表的正则表达式匹配。

```
public bool IsPalindrome()
            if (MyString.Length == 0)
                return false;

            int len = MyString.Length - 1;

            int first = 0;
            int second = 0;

            for (int i = 0, j = len; i <= len / 2; i++, j--)
            {
                while (i<j && MyString[i] == ' ' || MyString[i] == ',')
                    i++;

                while(j>i && MyString[j] == ' ' || MyString[j] == ',')
                    j--;

                if ((i == len / 2) && (i == j))
                    return true;

                first = MyString[i] >= 97 && MyString[i] <= 122 ? MyString[i] - 32 : MyString[i];
                second = MyString[j] >= 97 && MyString[j] <= 122 ? MyString[j] - 32 : MyString[j];

                if (first != second)
                    return false;
            }

            return true;
  } 
```

快速测试用例

负 1\. ABCDA 2\. AB CBAG 3\. A#$BDA 4\. NULL/EMPTY

正面 1\. ABCBA 2\. A, man a plan a canal,,巴拿马 3\. ABC BA 4\. M 5\. ACCB

让我知道任何想法/错误。

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2009-07-03T08:53:44.453

**斯卡拉**

```
def pal(s:String) = Symbol(s) equals Symbol(s.reverse) 
```

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2013-02-08T12:45:48.077

```
public class palindrome {
public static void main(String[] args) {
    StringBuffer strBuf1 = new StringBuffer("malayalam");
    StringBuffer strBuf2 = new StringBuffer("malayalam");
    strBuf2.reverse();

    System.out.println(strBuf2);
    System.out.println((strBuf1.toString()).equals(strBuf2.toString()));
    if ((strBuf1.toString()).equals(strBuf2.toString()))
        System.out.println("palindrome");
    else
        System.out.println("not a palindrome");
    }
} 
```

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2010-01-12T13:46:55.193

```
 public bool IsPalindrome(string s)
    {
        string formattedString = s.Replace(" ", string.Empty).ToLower();
        for (int i = 0; i < formattedString.Length / 2; i++)
        {
            if (formattedString[i] != formattedString[formattedString.Length - 1 - i])
                return false;
        }
        return true;
    } 
```

这种方法适用于像“我看到的是老鼠吗”这样的刺痛。但我觉得我们需要通过正则表达式消除特殊字符。

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2011-03-31T00:38:45.120

```
public static boolean isPalindrome( String str ) {
    int count = str.length() ;
    int i, j = count - 1 ;
    for ( i = 0 ; i < count ; i++ ) {
        if ( str.charAt(i) != str.charAt(j) ) return false ;
        if ( i == j ) return true ;
        j-- ;
    }
    return true ;
} 
```

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2013-02-16T02:53:55.837

一个不区分大小写、`const`友好的纯 C 语言版本，它忽略非字母数字字符（例如空格/标点符号）。因此，它实际上会传承经典，例如“一个人，一个计划，一条运河，巴拿马”。

```
int ispalin(const char *b)
{
    const char *e = b;
    while (*++e);
    while (--e >= b)
    {
        if (isalnum(*e))
        {
            while (*b && !isalnum(*b)) ++b;
            if (toupper(*b++) != toupper(*e)) return 0;
        }
    }
    return 1;
} 
```

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2014-07-15T13:21:33.017

```
//Single program for Both String or Integer to check palindrome

//In java with out using string functions like reverse and equals method also and display matching characters also

package com.practice;

import java.util.Scanner;

public class Pallindrome {

        public static void main(String args[]) {
        Scanner sc=new Scanner(System.in);
        int i=0,j=0,k,count=0;
        String input,temp;
        System.out.println("Enter the String or Integer");
        input=sc.nextLine();
        temp=input;
        k=temp.length()-1;
        for(i=0;i<=input.length()-1;i++) {
            if(input.charAt(j)==temp.charAt(k)) {
                count++;
            }
            //For matching characters
            j++;
            k--;
        }
                System.out.println("Matching Characters = "+count);

        if(count==input.length()) {
            System.out.println("It's a pallindrome");
        }
        else {
            System.out.println("It's not a pallindrome");
        }

    }

} 
```

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2012-02-16T04:45:42.083

**常规方法：**

```
flag = True // Assume palindrome is true
for i from 0 to n/2 
 { compare element[i] and element[n-i-1] // 0 to n-1
   if not equal set flag = False
   break }
return flag 
```

有一种更好的机器优化方法，它使用 XOR，但具有相同的复杂性

**XOR 方法**：

```
n = length of string
mid_element = element[n/2 +1]
for i from 0 to n
{ t_xor = element[i] xor element[i+1] }
if n is odd compare mid_element and t_xor
else check t_xor is zero 
```

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2011-02-26T22:42:47.790

这个 PHP 示例怎么样：

```
function noitcnuf( $returnstrrevverrtsnruter, $functionnoitcnuf) {
    $returnstrrev  = "returnstrrevverrtsnruter";
    $verrtsnruter = $functionnoitcnuf;
    return (strrev ($verrtsnruter) == $functionnoitcnuf) ; 
} 
```

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2012-01-04T20:30:01.793

如果您可以使用 Java API 和额外的存储：

```
public static final boolean isPalindromeWithAdditionalStorage(String string) {
    String reversed = new StringBuilder(string).reverse().toString();
    return string.equals(reversed);
} 
```

In 可能需要 Java 的就地方法：

```
public static final boolean isPalindromeInPlace(String string) {
    char[] array = string.toCharArray();
    int length = array.length-1;
    int half = Math.round(array.length/2);
    char a,b;
    for (int i=length; i>=half; i--) {
        a = array[length-i];
        b = array[i];
        if (a != b) return false;
    }
    return true;
} 
```

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2013-11-10T18:50:18.303

面试官会寻找一些关于你将如何解决这个问题的逻辑：请考虑以下 java 代码：

1.  始终检查输入字符串是否为空
2.  检查你的基本情况。
3.  相应地格式化您的字符串（删除任何不是字符/数字的内容
4.  他们很可能不想查看您是否知道反向函数和比较，而是希望您是否能够使用循环和索引来回答问题。
5.  知道答案后立即返回，不要白白浪费资源。

    公共静态布尔 isPalindrome(String s) {

    ```
    if (s == null || s.length() == 0 || s.length() == 1)
        return false;

    String ss = s.toLowerCase().replaceAll("/[^a-z]/", "");

    for (int i = 0; i < ss.length()/2; i++) 
        if (ss.charAt(i) != ss.charAt(ss.length() - 1 - i))
            return false;
    return true; 
    ```

    }

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2015-09-13T13:42:37.897

```
// JavaScript Version.
function isPalindrome(str) { 
  str = str.replace(/[^a-zA-Z]/g, '')
  return str.split('').reverse().join('').toUpperCase() === str.toUpperCase()       
} 
```

# .net - Excel 中的数据透视表选项

> ID：52008
> 
> 赞同：0
> 
> 时间：2008-09-09T14:26:39.310
> 
> 标签：.net, excel, vsto, pivot-table

我需要设计一个在.NET 中生成excel 报告的小项目，发送给用户使用。

Excel 报表将包含数据透视表。

我对它们没有太多经验，但我可以想到三种实现方案：

1.  为它设置一个查询，填充它，断开它发送。这样，用户将能够对值进行分组并进行一些操作，但他将无法刷新数据。
2.  生成一个小型访问数据库并将其与excel文件一起发送，连接到它。
3.  将数据复制到 Excel（可能在其他工作表中）并连接到那里的数据。我认为这将使excel文件非常大。

就性能与可用性而言，最好的选择是什么？还有其他我不知道的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-09T14:36:53.357

您必须保持数据“离线”吗？

在这些有大量数据的情况下，我通常会使用网络上已经存在的 SQL 服务器。如果要在办公室使用，用户无论如何都会在线。

请记住在 SQL 服务器上为此报告创建一个具有受限访问权限的专用用户，并且不要将“sa”密码存储在 excel 文件中。

如果您通过“发送给用户”来指代办公室以外的用户，那么这不是一个好的解决方案。如果是这种情况，我会尝试将数据包含在 Excel 工作表中，看看它会变得多大。如果文件不是太大，那将是最用户友好的解决方案。

另外，我在网上找到了这个：[Microsoft Office Excel 2003 中使用 Web 查询的不同方法](http://msdn.microsoft.com/en-us/library/aa203721(office.11).aspx)。这将允许您将数据存储在公共网站上（如果需要，可以使用秘密 URL），然后让 Excel 提取数据。这样您就不必用大文件填充用户的收件箱，并且您也可以稍后更新数据而无需重新发送 Excel 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T14:40:32.380

@Espo

不，用户将无法访问原始数据源，这就是为什么我正在考虑使用报告所需的数据子集创建一个小型访问数据库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T16:12:49.867

选项 3 听起来最简单，我认为 Excel 在存储数据方面似乎并不比 Access 更有效。两个文件的问题是让它们之间的链接即使在不同的位置也能工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T17:09:02.243

@paulmorriss

也许......问题在于单张工作表可以包含多少数据存在限制......我在考虑选项2，除非有人告诉我这在性能方面不是一个好主意

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T07:56:35.063

由于它是一个小型项目，您可以依靠 Excel 来存储应用程序中的数据。它会更容易开发和测试，也更容易维护。

# .net - 获取应用程序所需的程序集列表

> ID：52022
> 
> 赞同：1
> 
> 时间：2008-09-09T14:34:29.010
> 
> 标签：.net, reflection, assemblies, dependencies, nsis

有没有办法将 .net 项目的所有必需程序集（不包括 .net 框架）放入准备打包到[nsis](http://nsis.sourceforge.net/Main_Page)作为安装文件的文件夹中？

我尝试编写一个小型控制台应用程序，该应用程序使用反射来获取 dll 列表，但一直坚持寻找一种确定 dll 是否来自 .net 框架的万无一失的方法。

答案可能是 Visual Studio 中的一个简单开关以输出所有依赖项，或者可以执行此操作的独立应用程序，或者 Nsis 的插件，或者我错过的一些关于反射的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T14:39:24.833

在 Visual Studio（至少 2005 年 - 我现在正在使用的）中，您与项目关联的每个引用都有一个名为“复制本地”的属性，可以将其设置为 true/false。如果为 true，它将为您将 dll 复制到当前配置目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T09:34:11.470

您可以为此使用[NDepend 。](http://www.NDepend.com)下载它，构建一个新的 NDepend 项目，在 Application Assemblies 数据网格视图中拖放您的程序集，您将看到 NDepend 立即解析您的一组应用程序程序集所需的层程序集。

您还可以提供一个文件夹列表来告诉 NDepend 在哪里查找。如果找不到层组件，则 NDepend 会将其标记为未找到，我认为这是一个有价值的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T14:42:56.667

[Dependency Walker](http://www.dependencywalker.com)是您所需要的。或者也许[Depends.Net](http://www.netomatix.com/Development/DependsNet.aspx)

# flash - 访问 Flash CS3 AS3 项目中的 Web 服务

> ID：52046
> 
> 赞同：2
> 
> 时间：2008-09-09T14:40:34.097
> 
> 标签：flash, actionscript-3, web-services

由于 CS3 没有 Web 服务组件，就像以前的版本一样，是否有一个好的、功能完整的、仅限 AS3（无 Flex 依赖项）的库来使用 AS3 访问 Web 服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T14:43:52.937

您可能想查看 [http://alducente.wordpress.com/2007/10/27/web-service-in-as3-release-10/](http://alducente.wordpress.com/2007/10/27/web-service-in-as3-release-10/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T10:32:59.780

您要使用哪种类型的服务？URLLoader 可以处理soap 请求（`urlRequest.requestHeaders.push(new URLRequestHeader("Content-Type", "application/soap+xml"));`），而NetConnection 可以处理大多数其他东西（AMF/Remoting）。

# windows - 有关 COM 错误代码的最佳信息来源是什么？

> ID：52059
> 
> 赞同：5
> 
> 时间：2008-09-09T14:47:49.417
> 
> 标签：windows, com

当您只有 HRESULT 时，我不知道从哪里获得有关解决 COM 错误的含义、可能原因和可能解决方案的最佳信息。

在 Google 上搜索“80004027”之类的术语几乎毫无用处，因为它会将您发送到 90% 的随机讨论组，问题是“80004027 是什么意思？” 没有回答。

这有什么好的资源？为什么 MSDN 不是 Google 的顶级搜索结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T21:12:49.860

我总是使用 WinError.h。这具有绝大多数的各种 Windows 错误代码。

需要注意的一个关键指标是代码的 Facility 部分：第二个最重要的字节。即 0x80nnmmmm，其中 nn 是 Facility。这会告诉您哪个组件生成了代码。设施为 7 的任何内容都是重新打包为 HRESULT 的 Windows 错误代码，您应该将低位字转换为十进制并在 WinError.h 中查找。还有一些错误范围出现在它们自己的标题中（例如，从 12000 到 12999 的任何内容都是 WinInet 错误代码，您应该在 WinInet.h 中查找它）。

查找错误代码将为您提供符号名称，它可能在比代码本身或错误消息的措辞更多的文档中找到。

FACILITY_ITF（其值为 4，因此这些 HRESULT 开始于 0x8004）表示错误是由您正在使用的接口定义的；您必须检查该界面以了解其含义。

最后，COM 还提供了接口 IErrorInfo 来检索扩展的错误信息：调用 GetErrorInfo 来检索错误对象。您必须查询 ISupportErrorInfo 并调用该接口的 InterfaceSupportsErrorInfo 方法来确定您调用的接口是否实际设置了错误对象（当然，如果它是模板代码，它可能是在撒谎）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T21:04:45.217

%PROGRAMFILES%[Some version of Visual Studio]\Tools Common7\ 文件夹中的错误查找 (ErrLook.exe) 会经常给您错误消息，但并非总是如此：

```
    |------------------------------------------------- --|
    | [] 错误查找 |
    |------------------------------------------------- --|
    | 值：[0x80004027] |
    | |
    | 错误信息 |
    | +---------------------------------------------+ |
    | |包含 | 的组件或应用程序 |
    | |组件已被禁用 | |
    | | | |
    | +---------------------------------------------+ |
    | [模块...] [查找] [关闭] [帮助] |
    |------------------------------------------------- ---

```

如果这不起作用，您可以从这里遵循一些想法：http: [//blogs.msdn.com/oldnewthing/archive/2008/09/01/8914664.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/09/01/8914664.aspx)

（错误查找只需使用 FORMAT_MESSAGE_FROM_SYSTEM 标志调用 FormatMessage()）

如果 COM 错误不是系统错误，您可能还必须检查引发错误的组件的文档。

如果您在代码中发现错误，您可以希望组件实现丰富的错误（GetErrorInfo()，与 VB 中的 Err 对象相同），这样您就可以获得描述问题的完整消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T14:49:01.393

## [COM 错误代码的结构](http://msdn.microsoft.com/en-us/library/ms690088.aspx)

COM 错误代码在 Google 结果中排名第二。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T14:59:43.770

来自 Prakash 的良好链接（我不知道 RCNr 的东西——我认为这些字节是设施的一部分——但这似乎只在 16 位 Windows 中是正确的。）

这些未知代码通常特定于您正在使用的接口/组件。该设施将设置为 FACILITY_ITF。我有一个解析 HRESULT 的旧程序 HRPlus（[链接？](http://www.simtel.net/product.php%5Bid%5D8407%5Bcid%5D228%5BSiteID%5Dsimtel.net)）。

# regex - 日期时间格式的动态正则表达式

> ID：52066
> 
> 赞同：5
> 
> 时间：2008-09-09T14:50:20.580
> 
> 标签：regex, datetime, information-retrieval

是否有现有的解决方案可以根据给定的日期时间格式模式动态创建正则表达式？支持的日期时间格式模式无关紧要（Joda`DateTimeFormat`或`java.text.SimpleDateTimeFormat`其他）。

作为一个具体的例子，对于给定的日期时间格式，如`dd/MM/yyyy hh:mm`，它应该生成相应的正则表达式来匹配指定格式内的日期时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-08T08:49:16.447

我猜您的时间格式可以由有限的字母构成。这意味着，`"HH"`将始终是 24 小时制的“小时”，`"dd"`始终是前导零的一天，依此类推。

由于时间格式的顺序性，您可以尝试将格式字符串标记`"dd/mm/yyyy HH:nn"`为数组`["dd", "/", "mm", "/", "yyyy", " ", "HH", ":", "nn"]`。然后继续并通过替换等从该数组中形成一个模式`"HH"`字符串`"([01][0-9]|2[0-3])"`。将这些模式原子预构建为查找表/数组。不在查找表中的数组的所有部分都是文字。根据正则表达式规则将它们转义并将它们附加到您的模式字符串中。

* * *

编辑：作为基于正则表达式的解决方案的副作用，当您将查找表的所有正则表达式“原子”放入括号中并在给定格式字符串中跟踪它们的顺序时，您将能够使用子匹配来提取匹配所需的组件并将它们提供给 CreateDate 函数，从而完全跳过 ParseDate 部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T15:28:41.290

如果您正在寻找基本的日期检查，此代码与此数据匹配。

```
\b(0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)?[0-9]{2}\b

10/07/2008  
10.07.2008
1-01/2008
10/07/08    
10.07.2008
1-01/08 
```

*通过[regexbuddy 编写代码](https://www.regexbuddy.com)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T15:24:51.980

`SimpleDateFormat`已经使用该`parse()`方法执行此操作。

如果您需要从单个字符串中解析多个日期，请从正则表达式开始（即使它匹配过于宽松），并使用`parse()`正则表达式找到的所有潜在匹配项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-28T13:42:34.803

下面给出的 js / jQuery 代码仅适用于 Date 格式的动态生成 RegEx，不适用于 DateTime（开发版本尚未完全测试。）

日期格式应为“ *DMY* ”。

例如

> *   DD-MM-YY
> *   DD-MM-YYYY
> *   YYYY-MM-DD
> *   YYYY-DD-MM
> *   MM-DD-YYYY
> *   月-日-年
> *   日/月/年
> *   日/月/年
> *   年年/月/日
> *   YYYY/DD/MM
> *   月/日/年
> *   月/日/年

或其他格式但使用“ *DMY* ”字符创建：

```
var dateFormat = "DD-MM-YYYY";
var order = [];
    var position = {"D":dateFormat.search('D'),"M":dateFormat.search('M'),"Y":dateFormat.search('Y')};
    var count = {"D":dateFormat.split("D").length - 1,"M":dateFormat.split("M").length - 1,"Y":dateFormat.split("Y").length - 1};
    var seprator ='';
    for(var i=0; i<dateFormat.length; i++){
  if(["Y","M","D"].indexOf(dateFormat.charAt(i))<0){
    seprator = dateFormat.charAt(i);
  }else{
    if(order.indexOf(dateFormat.charAt(i)) <0 ){
        order.push(dateFormat.charAt(i));
    }
  }
    }
    var regEx  = "^";
    $(order).each(function(ok,ov){
    regEx  += '(\d{'+count[ov]+'})'+seprator;
    });
    regEx = regEx.substr(0,(regEx.length)-1);
  regEx  +="$";
  var re = new RegExp(regEx);
  console.log(re); 
```

注意：月/日没有验证检查，例如月份应该在 01-12 或日期应该在 01-31

# .net - .NET 路径操作库

> ID：52071
> 
> 赞同：4
> 
> 时间：2008-09-09T14:50:57.473
> 
> 标签：.net, path

有谁知道以一种很好的方式抽象路径操作问题的任何好的库？我希望能够使用任意分隔符（例如“/”或“：”）组合和解析路径，而无需重新发明轮子。

遗憾的`System.IO.Path`是不能更可重用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T14:52:00.403

System.IO.Path.Combine 适用于许多不同类型的路径：

[http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)

System.IO.Path.Combine 使用当前平台标准分隔符来组合路径。这意味着在 Windows 上它使用“\”，而在 unix/linux (mono) 上它使用“/”。您能否提供一些示例，说明您正在尝试组合哪些路径以及在什么平台上？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T20:54:56.327

检查 Patrick 的库以处理路径操作[链接文本](http://codebetter.com/blogs/patricksmacchia/archive/2007/10/18/a-free-library-to-handle-common-path-operation.aspx)

这是[codeplex 项目](http://www.codeplex.com/FileDirectoryPath)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T15:11:19.250

你在描述正则表达式！用它作为你需要做的事情的基础。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-09T14:17:25.363

恐怕[您必须](https://stackoverflow.com/questions/2026302/is-there-a-class-for-holding-a-file-system-path)像我一样自己实现路径类。它具有以下优点：

*   你可以从类型安全中获益
*   您可以覆盖 operator/，这使得连接更容易
*   您可以添加便捷的成员函数，例如 GetParentPath() 和 GetLeafPart()

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-28T14:52:39.873

根据您的分隔符，我无法判断您可能正在使用什么环境，但我以前从未见过这样的库。

因此，使用反射器并`System.IO.Path`以此为基础，重新发明轮子并不难。

*   创建这个类的一个实例
*   在 CTor 中提供分隔符
*   `InvalidPathChars`如果需要，可以选择更改。

这几乎是框架使用的代码，因此它应该同样快或只有微不足道的差异。可能会或可能不会比 RegEx 快，但它可能值得一试。

```
class ArbitraryPath
{
    private readonly char _directorySeparatorChar;
    private readonly char _altDirectorySeparatorChar;
    private readonly char _volumeSeparatorChar;

    public ArbitraryPath(char directorySeparatorChar, char altDirectorySeparatorChar, char volumeSeparatorChar)
    {
        _directorySeparatorChar = directorySeparatorChar;
        _altDirectorySeparatorChar = altDirectorySeparatorChar;
        _volumeSeparatorChar = volumeSeparatorChar;
    }

    public string Combine(string path1, string path2)
    {
        if ((path1 == null) || (path2 == null))
        {
            throw new ArgumentNullException((path1 == null) ? "path1" : "path2");
        }
        CheckInvalidPathChars(path1);
        CheckInvalidPathChars(path2);
        if (path2.Length == 0)
        {
            return path1;
        }
        if (path1.Length == 0)
        {
            return path2;
        }
        if (IsPathRooted(path2))
        {
            return path2;
        }

        char ch = path1[path1.Length - 1];
        if (ch != _directorySeparatorChar && ch != _altDirectorySeparatorChar && ch != _volumeSeparatorChar)
        {
            return (path1 + _directorySeparatorChar + path2);
        }
        return (path1 + path2);
    }

    public bool IsPathRooted(string path)
    {
        if (path != null)
        {
            CheckInvalidPathChars(path);
            int length = path.Length;
            if (length >= 1 && (path[0] == _directorySeparatorChar || path[0] == _altDirectorySeparatorChar) || length >= 2 && path[1] == _volumeSeparatorChar)
            {
                return true;
            }
        }
        return false;
    }

    internal static void CheckInvalidPathChars(string path)
    {
        for (int i = 0; i < path.Length; i++)
        {
            int num2 = path[i];
            if (num2 == 0x22 || num2 == 60 || num2 == 0x3e || num2 == 0x7c || num2 < 0x20)
            {
                throw new ArgumentException("Argument_InvalidPathChars");
            }
        }
    } 

} 
```

# php - PHP的控制容器反转？

> ID：52072
> 
> 赞同：20
> 
> 时间：2008-09-09T14:51:12.857
> 
> 标签：php, frameworks

我正在尝试用 PHP 编写 TDD 风格，而我最大的绊脚石之一（除了缺乏像样的 IDE）是我必须制作自己的 IoC 容器，才能正确注入所有模拟对象。

有人在 PHP 中使用过 Ioc 容器吗？我所能找到的只是[一直烦人的 phpclasses.org 上的 PHP IOC，](http://www.phpclasses.org/browse/package/3382.html)而且它似乎几乎没有文档，也没有太多的追随者。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-09T15:41:47.413

我玩过一些 PHP 的 DI 框架，但我没有在生产中使用过。有一些链接：

1.  [http://www.stubbles.net/](http://www.stubbles.net)我认为这是我尝试过的最古老的
2.  [http://php.xjconf.net/](http://php.xjconf.net/)
3.  [FLOW3](http://flow3.typo3.org/) - 我相信这将成为一个非常好的框架（现在是测试版）

你提到你会将它用于 TDD - 所以也许看看[Dependency Injection for Unit Tests in PHP](http://techblog.tilllate.com/2007/08/21/using-dependency-injection-for-unit-tests/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-03T22:46:38.110

[Phemto](http://phemto.sourceforge.net/)正在再次开发中，恕我直言，看起来很有希望。

您可能想要查看的其他一些类似项目：

[桶](http://github.com/troelskn/bucket)（免责声明：我是这个的主要作者）

[picocontainer](http://fisheye.codehaus.org/browse/picocontainer/php/picocontainer/trunk/container)的php-port已经存在了很长时间。我认为它不再被积极开发，但另一方面，我相信它相当稳定。不过，我已经很久没有看它了。

~~我最近偶然发现的一个相当新的项目是[Crafty](http://phpcrafty.sourceforge.net/index.php)。虽然不知道有多少人使用它。~~

~~我也在看[sphicy](http://www.beberlei.de/sphicy/)，看起来很有趣。~~

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-27T11:33:24.840

您可能还想尝试以 Spring(tm) for Java 为模型的 Ding (http://marcelog.github.com/Ding)。它是一个完整的控制反转和依赖注入容器，也支持AOP

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-29T12:59:11.603

[Symfony 依赖注入](http://components.symfony-project.org/dependency-injection/)或symfony 2.0 项目中的 PHP 5.3+ 等效[组件](https://github.com/symfony/DependencyInjection)怎么样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-12T09:07:30.130

[PHP-DI](http://mnapoli.github.com/PHP-DI/)是另一个依赖注入容器。

它通过**注解**和**最小配置**实现依赖注入，这里是一个例子：

```
class Foo {
    /**
     * @Inject
     * @var Bar
     */
    private $bar;
} 
```

它非常易于使用，例如与 Zend Framework 集成。

（是的，我确实在这个框架上工作）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T10:20:16.847

在过去的六个月里，我一直在开发一个名为 Substrate 的[PHP IoC/DI 容器。](http://substrate-php.org/)它仍然是一项正在进行中的工作，但它已经[在生产中部署了](http://s3a.us/)一个半月，并且到目前为止运行良好。

Substrate 受到 Spring Framework 的启发，但在编写时考虑了 PHP 的优点和局限性。此时文档非常少，但有一些[示例代码](http://code.google.com/p/substrate-php/wiki/SampleCode)，包括单元测试示例。这是您认为可以用于 TDD 的东西吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-04T11:37:45.183

Laravel 4 拥有最好的 IoC 和 DI 框架。如果您不介意使用框架，Laravel 4 是您的最佳选择

# javascript - 如何在 JavaScript 中构建循环？

> ID：52080
> 
> 赞同：9
> 
> 时间：2008-09-09T14:55:10.413
> 
> 标签：javascript, loops

如何在 JavaScript 中构建循环？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-09T15:05:00.387

**对于循环**

```
for (i = startValue; i <= endValue; i++) {
    // Before the loop: i is set to startValue
    // After each iteration of the loop: i++ is executed
    // The loop continues as long as i <= endValue is true
} 
```

**For...in 循环**

```
for (i in things) {
    // If things is an array, i will usually contain the array keys *not advised*
    // If things is an object, i will contain the member names
    // Either way, access values using: things[i]
} 
```

使用`for...in`循环遍历数组是不好的做法。它违反了[ECMA 262](http://www.ecma-international.org/publications/standards/Ecma-262.htm)标准，并且在将非标准属性或方法添加到 Array 对象（例如通过[Prototype](http://www.prototypejs.org/api/array) ）时可能会导致问题。 *（感谢[Chase Seibert](https://stackoverflow.com/users/7679/chase-seibert)在评论中指出这一点）*

**While 循环**

```
while (myCondition) {
    // The loop will continue until myCondition is false
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T14:57:59.640

下面是一个 for 循环的例子：

**我们有一个 items节点**数组。

```
for(var i = 0; i< nodes.length; i++){
    var node = nodes[i];
    alert(node);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-02T14:27:40.170

除了内置循环（`while() ...`, `do ... while()`, `for() ...`）之外，还有一个自调用函数的结构，也称为**递归**来创建一个没有三个内置循环结构的循环。

考虑以下：

```
// set the initial value
var loopCounter = 3;

// the body of the loop
function loop() {

    // this is only to show something, done in the loop
    document.write(loopCounter + '<br>');

    // decrease the loopCounter, to prevent running forever
    loopCounter--;

    // test loopCounter and if truthy call loop() again 
    loopCounter && loop();
}

// invoke the loop
loop();
```

不用说，这种结构经常与返回值结合使用，所以这是一个小例子，如何处理不是在第一次可用，而是在递归结束时的值：

```
function f(n) {
    // return values for 3 to 1
    //       n   -n  ~-n   !~-n   +!~-n   return
    // conv int neg bitnot  not  number 
    //       3   -3   2    false    0    3 * f(2)
    //       2   -2   1    false    0    2 * f(1)
    //       1   -1   0     true    1        1
    // so it takes a positive integer and do some conversion like changed sign, apply
    // bitwise not, do logical not and cast it to number. if this value is then
    // truthy, then return the value. if not, then return the product of the given
    // value and the return value of the call with the decreased number
    return +!~-n || n * f(n - 1);
}

document.write(f(7));
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-09T14:55:34.373

JavaScript 中的循环如下所示：

```
for (var = startvalue; var <= endvalue; var = var + increment) {
    // code to be executed
} 
```

# sql-server - 在 SQLServer 2005 中查询 XML 列

> ID：52084
> 
> 赞同：3
> 
> 时间：2008-09-09T14:57:01.657
> 
> 标签：sql-server, xml, xquery

我公司的“联系人”表中有一个字段。在该表中，有一个 XML 类型的列。该列包含有关特定联系人的杂项数据。例如。

```
<contact>
<refno>123456</refno>
<special>a piece of custom data</special>
</contact> 
```

对于每个联系人，下面的标签`contact`可能不同，我必须在同一个表中的关系数据列旁边查询这些片段。

我使用了以下结构：

```
SELECT c.id AS ContactID,c.ContactName as ForeName,
c.xmlvaluesn.value('(contact/Ref)[1]', 'VARCHAR(40)') as ref,    
INNER JOIN ParticipantContactMap pcm ON c.id=pcm.contactid 
AND pcm.participantid=2140
WHERE xmlvaluesn.exist('/contact[Ref = "118985"]') = 1 
```

此方法可以正常工作，但是服务器需要一段时间才能响应。我还研究了使用 nodes() 函数来解析 XML 节点并使用 exists() 来测试节点是否包含我正在搜索的值。

有谁知道查询 XML 列的更好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T17:52:44.540

如果您正在执行一次写入和大量读取，请在写入时进行解析，并将该数据转换为更易于查询的格式。第一个建议是将它们解析成一个相关但单独的表，其中包含名称/值/联系人ID 列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T15:02:32.750

我发现 msdn xml 最佳实践有助于使用 xml blob 列，可能会提供一些灵感... [http://msdn.microsoft.com/en-us/library/ms345115.aspx#sql25xmlbp_topic4](http://msdn.microsoft.com/en-us/library/ms345115.aspx#sql25xmlbp_topic4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T15:26:17.373

除了@pauljette提到的页面，这个页面还有很好的性能优化建议：

[http://msdn.microsoft.com/en-us/library/ms345118.aspx](http://msdn.microsoft.com/en-us/library/ms345118.aspx)

您可以做很多事情来提高 XML 查询的性能，但它永远不会像正确索引的关系数据那样好。如果您选择一个文档然后只在该文档中查询，您可以做得很好，但是当您的查询需要扫描一堆相似的文档以查找某些内容时，它有点像关系查询计划中的键查找（也就是说，*慢*）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-13T07:12:53.890

如果你的 Xml 有一个 XSD，那么你可以将它导入到你的数据库中，然后你可以为你的 Xml 数据建立索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-30T10:24:31.103

试试这个

SELECT * FROM conversionupdatelog WHERE convert(XML,colName).value('(/leads/lead/@LeadID=''xyz@airproducts.com'')[1]', 'varchar(max)')='true'

# oop - 为什么声称 C# 的人没有获得面向对象的编程？（相对于面向类）

> ID：52092
> 
> 赞同：15
> 
> 时间：2008-09-09T15:00:13.253
> 
> 标签：oop, programming-languages

昨晚引起了我的注意。

在最新的[ALT.NET 播客](http://altnetpodcast.com/episodes/10-oop-in-ruby)中，Scott Bellware 讨论了与 Ruby 相比，c#、java 等语言如何。并不是真正的面向对象，而是选择“面向类”这个短语。他们用非常模糊的术语谈论这种区别，而没有深入细节或讨论利弊。

这里的真正区别是什么？它有多大关系？那么还有哪些其他语言是“面向对象的”？这听起来很有趣，但我不想学习 Ruby 只是为了知道我缺少什么。

**更新**：阅读下面的一些答案后，似乎人们普遍同意该参考是鸭式打字。我不确定我是否仍然理解的是，这最终会改变一切的说法。特别是如果你已经在做适当的 tdd 松耦合等等等等。有人可以向我展示一个我可以用 ruby​​ 做的奇妙事情的例子，而我不能用 c# 做这件事，并举例说明了这种不同的 oop 方法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-27T09:12:11.753

在面向对象的语言中，对象是通过定义对象而不是类来定义的，尽管类可以为给定抽象的特定、千篇一律的定义提供一些有用的模板。在面向类的语言中，例如 C#，对象必须由类定义，并且这些模板通常在运行前被封装和打包并使其不可变。对象必须在运行时之前定义并且对象的定义是不可变的这种任意约束不是面向对象的概念；它是面向班级的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-09T15:19:32.663

此处的鸭子类型注释更多地归因于 Ruby 和 Python比 C#更*动态*的事实。它与OO Nature 没有任何关系。

（我认为）Bellware 的意思是，在 Ruby 中，一切都是对象。甚至一堂课。类定义是对象的一个​​实例。因此，您可以在运行时向其添加/更改/删除行为。

另一个很好的例子是 NULL 也是一个对象。在 ruby​​ 中，一切都是一个对象。在整个存在中拥有如此深入的 OO 允许一些有趣的元编程技术，例如 method_missing。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-09T15:20:03.083

IMO，它确实过度定义了“面向对象”，但他们所指的是 Ruby 与 C#、C++、Java 等不同，它没有使用*定义*类——你真的只能直接使用对象. 相反，例如在 C# 中，您定义*类*，然后必须通过 new 关键字将其*实例化为对象。*关键是您必须在 C# 中*声明*一个类或对其进行描述。此外，在 Ruby 中，*一切*——例如偶数——都是对象。相比之下，C#仍然保留了对象类型和值类型的概念。事实上，我认为这说明了他们对 C# 和其他类似语言的看法——对象*类型*和值*type*意味着一个*类型*系统，这意味着您拥有一个*描述*类型的完整系统，而不仅仅是使用对象。

从概念上讲，我认为 OO*设计*提供了当今用于处理软件系统复杂性的抽象。该语言是一种用于实现 OO 设计的工具——有些使它比其他的更自然。我仍然认为，从更常见和更广泛的定义来看，C# 和其他语言仍然是*面向对象的*语言。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-09T15:16:47.847

OOP 的三大支柱

1.  封装
2.  遗产
3.  多态性

如果一种语言可以做这三件事，那么它就是一种 OOP 语言。

我很确定语言 X 的论点比语言 A 更好地进行 OOP 将永远持续下去。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-17T12:28:46.033

OO 有时被定义为*面向消息的*。这个想法是方法调用（或属性访问）实际上是发送给另一个对象的消息。接收对象如何处理消息是完全封装的。通常，消息对应于随后执行的方法，但这只是一个实现细节。例如，您可以创建一个包罗万象的处理程序，无论消息中的方法名称如何，该处理程序都会执行。

像 C# 中的静态 OO 没有这种封装。按摩*必须*对应于现有的方法或属性，否则编译器会抱怨。然而，像 Smalltalk、Ruby 或 Python 这样的动态语言确实支持“基于消息的”OO。

所以从这个意义上说，C# 和其他静态类型的 OO 语言不是真正的 OO，因为它们缺乏“真正的”封装。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T15:07:22.537

更新：它是新浪潮……这表明我们到目前为止所做的一切都已经过去了……似乎在播客和书籍中得到了很大的支持……也许这就是你所听到的。

到目前为止，我们一直关注静态类，并没有**释放出**面向对象开发的力量。我们一直在做“基于类的开发”。类是用于创建对象的固定/静态模板。一个类的所有对象都是平等的。

例如，为了说明我一直在喋喋不休...让我从我刚刚有幸观看的 PragProg 截屏视频中借用一段 Ruby 代码片段。“基于原型的开发”模糊了对象和类之间的界限。没有区别。

```
animal = Object.new                  # create a new instance of base Object

def animal.number_of_feet=(feet)     # adding new methods to an Object instance. What?
  @number_of_feet = feet
end
def animal.number_of_feet
  @number_of_feet
end

cat = animal.clone          #inherits 'number_of_feet' behavior from animal
cat.number_of_feet = 4

felix = cat.clone           #inherits state of '4' and behavior from cat
puts felix.number_of_feet   # outputs 4 
```

这个想法是它比传统的基于类的继承更强大的继承状态和行为的方式。它在某些“特殊”场景（我尚未理解）中为您提供了更大的灵活性和控制力。这允许诸如 Mix-ins 之类的东西（重新使用没有类继承的行为）..

通过挑战我们如何思考问题的基本原语，“真正的 OOP”在某种程度上就像“矩阵”......你继续在循环中进行 WTF。就像这个.. Container 的基类可以是 Array 或 Hash，取决于生成的随机数是 0.5 的哪一侧。

```
class Container < (rand < 0.5 ? Array : Hash)
end 
```

Ruby、javascript 和新的旅似乎是这方面的先驱。我还在研究这个……阅读并试图理解这种新现象。似乎很强大..太强大了..有用吗？我需要睁大眼睛。有趣的时间..这些。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-09T15:07:09.650

也许他们在暗示鸭子类型和类层次结构之间的区别？

*如果它像鸭子一样走路和像鸭子一样嘎嘎叫，就假装它是鸭子并踢它。*

在 C#、Java 等中，编译器会大惊小怪：你是否允许对那个对象执行此操作？

因此，面向对象与面向类可能意味着：语言是否担心对象或类？

例如：在 Python 中，要实现一个可迭代对象，您只需要提供一个方法，该方法`__iter__()`返回一个具有名为 的方法的对象`next()`。这就是它的全部内容：没有接口实现（没有这样的东西）。没有子类化。就像鸭子/迭代器一样说话。

**编辑：**当我重写所有内容时，这篇文章被投了赞成票。对不起，以后再也不会这样做了。原始内容包括建议学习尽可能多的语言，并且不必担心语言医生对语言的想法/说法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-09T15:32:58.557

我只听了引发您问题的播客的前 6-7 分钟。如果他们的意图是说 C# 不是纯粹的面向对象语言，那实际上是正确的。C# 中的一切都不是对象（至少原语不是，尽管装箱创建了一个包含相同值的对象）。在 Ruby 中，一切都是对象。Daren 和 Ben 在他们关于“duck-typing”的讨论中似乎涵盖了所有基础，所以我不再重复。

这种差异（所有对象与所有非对象）是否重要/重要是我无法轻易回答的问题，因为我没有足够的 Ruby 深度来将其与 C# 进行比较。那些知道 Smalltalk 的人（我不知道，虽然我希望我知道）可能一直在以某种乐趣看待 Ruby 运动，因为它是 30 年前第一个纯 OO 语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-09T15:53:29.693

那确实是一个抽象的播客！
但我明白他们在说什么——他们只是被 Ruby Sparkle 弄得眼花缭乱。Ruby 允许您做基于 C 和 Java 的程序员甚至不会想到的事情 + 这些事情的组合让您实现梦想不到的可能性。向内置的 String 类添加新方法，因为您喜欢它，传递未命名的代码块供其他人执行，mixins... 传统的人不习惯对象更改与类模板太远。它肯定是一个全新的世界。

至于 C# 的人还不够 OO……别把它放在心上……当你大吃一惊的时候，把它当作你说的话。Ruby 对大多数人都是这样做的。
如果我必须推荐一种语言供人们在当前十年学习......它会是 Ruby。我很高兴我做到了.. 虽然有些人可能会声称 Python。但它就像我的意见.. 伙计！:D

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-17T12:09:48.570

我不认为这与鸭子打字有关。例如，C# 已经支持有限的鸭子类型 - 例如，您可以在*任何*实现 MoveNext 和 Current 的类上使用 foreach。

鸭子类型的概念与 Java 和 C# 等静态类型语言兼容，它基本上是反射的扩展。

这确实是静态与动态类型的情况。两者都是正确的-OO，只要有这样的事情。在学术界之外，这真的不值得争论。

垃圾代码都可以写。伟大的代码可以写在任何一个。绝对没有任何功能是一种模型可以做到的，而另一种则不能。

真正的区别在于所完成编码的性质。静态类型降低了自由度，但优点是每个人都知道他们在处理什么。动态更改实例的机会非常强大，但代价是很难知道您在处理什么。

例如，对于 Java 或 C#，智能感知很容易 - IDE 可以快速生成可能性的下拉列表。对于 Javascript 或 Ruby，这变得更加困难。

对于某些事情，例如生成一个其他人将使用的 API，静态类型具有真正的优势。对于其他人，例如快速生产原型，优势在于动态。

值得在您的技能工具箱中了解两者，但远不如了解您已经真正深入使用的工具箱重要。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-17T14:42:17.877

面向对象是一个概念。这个概念是基于某些想法。这些想法的技术名称（实际上是随着时间的推移而发展起来的原则，从一开始就没有出现）上面已经给出了，我不会重复它们。我宁愿尽可能简单和非技术性地解释这一点。

OO 编程的思想是有对象。对象是小的独立实体。这些实体可能有嵌入信息，也可能没有。如果他们拥有此类信息，则只有实体本身可以访问或更改它。实体通过在彼此之间发送消息来相互通信。将此与人类进行比较。人类是独立的实体，内部数据存储在他们的大脑中，并通过交流（例如相互交谈）相互交互。如果你需要来自别人大脑的知识，你不能直接访问它，你必须问他一个问题，他可能会回答你，告诉你你想知道什么。

基本上就是这样。这是OO编程背后的真正想法。编写这些实体，定义它们之间的通信并让它们交互在一起以形成一个应用程序。这个概念不受任何语言的约束。这只是一个概念，如果您使用 C#、Java 或 Ruby 编写代码，这并不重要。通过一些额外的工作，这个概念甚至可以在纯 C 中完成，即使它是一种函数式语言，但它提供了该概念所需的一切。

现在不同的语言都采用了这种面向对象编程的概念，当然这些概念并不总是相同的。例如，某些语言允许其他语言禁止的内容。现在涉及的概念之一是类的概念。有些语言有类，有些则没有。类是对象外观的蓝图。它定义了对象的内部数据存储，定义了对象可以理解的消息以及是否存在继承（这对于 OO 编程*不是强制性*的！），类还定义了来自哪个其他类（或者如果允许多重继承，则为类）此类继承（如果存在选择性继承，则继承哪些属性）。一旦您创建了这样的蓝图，您现在可以根据该蓝图生成无限数量的对象。

但是，有些面向对象语言没有类。那么对象是如何构建的呢？好吧，通常是动态的。例如，您可以创建一个新的空白对象，然后向其动态添加内部结构，如实例变量或方法（消息）。或者您可以复制已经存在的对象及其所有属性，然后对其进行修改。或者可能将两个对象合并为一个新对象。与基于类的语言不同，这些语言是非常动态的，因为您可以在运行时动态生成对象，甚至开发人员在开始编写代码时都没有想到。

通常这种动态是有代价的：语言越动态，内存（RAM）对象将浪费的越多，一切变得越慢，因为程序流程也非常动态，如果编译器没有机会，编译器就很难生成有效的代码预测代码或数据流。JIT 编译器可以在运行时优化其中的某些部分，一旦他们知道程序流程，但是由于这些语言是如此动态，程序流程可以随时更改，迫使 JIT 丢弃所有编译结果并重新编译相同的代码一遍又一遍地。

但这是一个很小的实现细节——它与基本的 OO 原则无关。没有地方说对象必须是动态的或在运行时必须是可更改的。维基百科说得很好：

> 编程技术可能包括信息隐藏、数据抽象、封装、模块化、多态性和继承等特性。

[http://en.wikipedia.org/wiki/Object-oriented_programming](http://en.wikipedia.org/wiki/Object-oriented_programming)

他们*可能会*也*可能不会*。这一切都不是强制性的。强制性的只是对象的存在，并且它们必须有相互交互的方式（否则如果它们不能相互交互，对象将毫无用处）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-07-12T01:56:02.397

你问：“谁能给我展示一个我可以用 ruby​​ 做的奇妙事情的例子，而我不能用 c# 做，并举例说明了这种不同的 oop 方法？”

一个很好的例子是活动记录，即内置于 Rails 中的 ORM。模型类是在运行时根据数据库模式动态构建的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-09T15:13:00.837

我会试一试。

Python 和 Ruby 是鸭式的。要使用这些语言生成任何可维护的代码，您几乎必须使用测试驱动开发。因此，对于开发人员而言，无需创建庞大的支持框架即可轻松地将依赖项注入其代码中非常重要。

成功的依赖注入取决于拥有一个非常好的对象模型。两者是同一枚硬币的两个面。如果您真的了解如何使用 OOP，那么您应该默认创建可以轻松注入依赖项的设计。

因为依赖注入在动态类型语言中更容易，Ruby/Python 开发人员觉得他们的语言比其他静态类型语言更能理解 OO 的教训。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-09T15:23:22.043

这真的很可能归结为这些人看到其他人在 c# 和 java 中所做的事情，而不是 c# 和 java 支持 OOP。大多数语言可以用于不同的编程范例。例如，您可以使用 c# 和 scheme 编写过程代码，您可以使用 java 进行函数式编程。它更多的是关于你想要做什么以及语言支持什么。

# windows-mobile - 在没有 TAB 键的情况下，如何在 Windows Mobile 设备上导航出组合框？

> ID：52098
> 
> 赞同：0
> 
> 时间：2008-09-09T15:02:51.907
> 
> 标签：windows-mobile, mobile

我正在使用 Visual Studio .NET 2008 为 Windows Mobile 设备开发一个应用程序，其 UI 需要使用 ComboBox 控件。不幸的是，对于既没有硬件全尺寸键盘也没有触摸屏界面的设备，没有办法将（选项卡）从 ComboBox 控件移动到同一窗体上的另一个控件（例如，在 ComboBox 中指定一个产品，然后移动到一个文本字段添加数量）。

我尝试为 ComboBox 的 KeyPress 事件创建一个事件处理程序，并在用户按下右或左方向键时手动将焦点设置到下一个控件，但不幸的是事件处理程序没有捕获这些按键。

有任何想法吗？我强烈怀疑这是过度设计的，并且存在更适合我需要做的更好的控制；我觉得从 Combo Box 控件中跳出来会这么困难，这有点不可思议。

谢谢！

编辑：显然我可以捕获组合框上的 KeyDown 和 KeyUp 事件，这允许我将焦点或选项卡设置为下一个控件。仍然过度设计 - 仍在寻找想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T15:11:17.813

我相信方向仅在`KeyDown`and上捕获，而`KeyUp`不是在 上`KeyPress`。

作为使用 ComboBox 的替代方法，如果 ListItems 的数量是静态的且相对较小，您可以使用多个 RadioButtons。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-24T12:36:15.817

[http://msdn.microsoft.com/en-us/library/bb985500.aspx#GeneralRules](http://msdn.microsoft.com/en-us/library/bb985500.aspx#GeneralRules)提供 UI 导航规则。

# sql-server-2008 - 我可以将 SQL Server Management Studio 2005 用于 2008 DB 吗？

> ID：52103
> 
> 赞同：24
> 
> 时间：2008-09-09T15:05:53.210
> 
> 标签：sql-server-2008, sql-server-2005, ssms

我希望使用 Management Studio 2005 管理 SQL Server 2008 数据库。原因是我们的服务器是 64 位机器，而我们只有 64 位版本的软件。

这可能吗？

使用 Management Studio 2008 管理 SQL Server 2005 数据库怎么样？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-09T15:07:01.443

更新：您可以使用SQL Server 2005 Service Pack 2 的[累积更新包 5](http://support.microsoft.com/kb/943656)连接到 2008。

修复：50002151 946127 ( [http://support.microsoft.com/kb/946127/](http://support.microsoft.com/kb/946127/) ) 修复：在 SQL Server 2005 中使用 SQL Server Management Studio 连接到 SQL Server 2008 实例时可能会遇到问题

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-19T01:11:39.050

您问的另一个问题是关于使用 SSMS 2008 管理 2005 服务器 - 是的，您可以这样做。SSMS 2008 可以管理 2008、2005、2000。我实际上建议每个人都使用最新的 SSMS 2008 客户端，无论他们连接到什么服务器，因为它有一些不错的特权和升级，适用于您连接到的所有服务器版本。

请注意，SSMS 2008 具有 IntelliSense，但仅当您连接到 SQL 2008 服务器时。如果连接到 2005 服务器，则不会获得 IntelliSense。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-18T15:40:21.010

我发布这个是为了防止人们得到错误的希望（就像我一样）。您可以使用 SQL Server 2005 Management Studio 连接到 SQL Server 2008，但不能使用 SQL Server 2005 Management Studio **Express**。您会收到一条明确的错误消息，说明：

> 此版本的 Microsoft SQL Server Management Studio Express 只能用于连接 SQL Server 2000 和 SQL Server 2005 服务器。(Microsoft.SqlServer.Express.ConnectionDlg)

希望这将防止几个人浪费时间尝试以防万一。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-04-15T02:41:13.640

除非我弄错了并且事情发生了变化，否则您不能使用 sql server 2008 来保存恢复到 sql server 2005 的备份。我发现这一点很难:(

# visual-studio - 在 Visual Studio 2008 的解决方案中打开文件的快捷方式是什么？

> ID：52108
> 
> 赞同：5
> 
> 时间：2008-09-09T15:07:38.713
> 
> 标签：visual-studio, keyboard-shortcuts, resharper

在 Visual Studio 2008 (+ Resharper) 的解决方案中打开文件的快捷方式是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-09T15:15:01.800

`Ctrl`+ `T`(ReSharper, Goto, type) 将为您打开一个类文件。

看起来像`Ctrl`++`Shift`打开`T`文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T15:16:07.880

根据您的键盘映射，`Ctrl`++将打开解决方案中的任何文件，或者`Shift`+将打开任何类型。`N``Ctrl``N`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T04:04:48.177

如果标准工具栏可见，则以下将打开解决方案中的任何文件（不需要重新生成器）。

`Ctrl`+`D`将您置于“查找”文本框中。 `>of f`将提供一个下拉列表，其中包含以文件名后以路径信息开头的所有文件，`f`以区分名称冲突。完成文件名，或向下箭头到正确的文件名，然后按 Enter 在编辑器中打开它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T06:58:50.270

这取决于您设置的键映射。使用默认键盘映射：执行`Ctrl`+`T`打开类型，执行`Ctrl`+ `Shift`+`T`打开文件。与 IntelliJ 类似的映射：做`Ctrl`+`N`打开一个类型和`Ctrl`+ `Shift`+`N`打开一个文件。

访问以下链接以获取所有键映射。

ReSharper 4 默认键盘映射：Visual Studio 方案 [http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap.pdf](http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap.pdf)

ReSharper 4 默认键盘映射：ReSharper 2.x / IDEA 方案 [http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap2.pdf](http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap2.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-20T01:15:06.303

我最近参加了一个演讲，[Kirk Jackson](http://pageofwords.com/blog/default.aspx)展示了如何在 Visual Studio 的命令窗口中添加别名。忍受我，它会变得更好。所以它是这样的：

1.  打开命令窗口并输入

    > File.FileOpen 的别名

2.  现在在您的编辑器窗口中点击`Ctrl`+`/`将焦点放在工具栏上的“查找”框中

3.  如果您使用前缀`>`这是命令窗口（偷偷摸摸的吧？），请输入：

    > 佛

智能感知会启动并向您显示解决方案中文件夹和文件的名称。

别名在 Visual Studio 会话之间保持不变。

不完全是键盘快捷键，但使用此技术，您可以从键盘访问 Visual Studio 中的任何命令。

您还应该查看 Kirk 的基本[VS 提示和技巧列表](http://pageofwords.com/blog/2008/09/09/VisualStudioTipsNTricksDEV313.aspx)

# java - 用Java提取SVN数据

> ID：52112
> 
> 赞同：5
> 
> 时间：2008-09-09T15:09:08.087
> 
> 标签：java, svn

有谁知道一个很好的 Java 库可以连接到 SVN 以便我可以提取数据？我想要 SVN 评论、作者、路径等...希望有了这些数据，我可以构建一个更好的时间管理跟踪系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T15:10:48.923

你想要[SVNKit](http://svnkit.com/)。它是双重许可的，因此只有在使用它进行商业工作时才需要付费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-27T06:02:24.493

您可以尝试使用 SVNKit。它使用简单灵活。

# .net - 确定程序集是否是 .NET 框架的一部分

> ID：52134
> 
> 赞同：19
> 
> 时间：2008-09-09T15:18:14.583
> 
> 标签：.net, reflection, frameworks, assemblies

如何从程序集名称或程序集类（或其他类似名称）中判断程序集是否是[.NET](http://en.wikipedia.org/wiki/.NET_Framework)框架的一部分（即 .NET 框架`System.windows.Forms`）？

到目前为止，我已经考虑了 PublicKeyToken 和 CodeBase 属性，但对于整个框架来说，它们并不总是相同的。

我想要此信息的原因是获取我的 EXE 文件正在使用的程序集列表，这些程序集需要在客户端计算机上，因此我可以将正确的文件打包到安装文件中，而无需使用 Visual Studio 安装系统。问题是，我不想选择任何 .NET 框架程序集，我希望它是一个自动过程，只要完成主要更新就可以轻松推出。

最终的解决方案是有一个 IsFramework 属性...... :)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T22:02:58.467

不，它不是以“系统”开头的。您可以检查“WindowsBase”，它是一个框架程序集。

您也不能检查 PublicKeyToken，因为还有其他使用“默认”密钥签名的 Microsoft 程序集，但它们不是 .NET Framework（Visual Studio 程序集）的一部分。

最好的方法是获取已安装的 .NET 框架的集合并检查目标程序集是否是其 RedistList ( `RedistList\FrameworkList.xml`) 的一部分。

FrameworkList.xml 可以在以下位置找到：

*   .NET 2.0：C:\Windows\Microsoft.NET\Framework64\v2.0.50727\RedistList
*   .NET 3.x：C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\v *VersionNumber* \RedistList
*   .NET 4.x：C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v *VersionNumber* \RedistList
*   .NET Core：C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETCore\v *VersionNumber* \RedistList

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-12T21:14:51.167

为此，我通过 AssemblyProductAttribute 使用嵌入在程序集中的产品名称。

```
var attribute = assembly.GetCustomAttributes(typeof(AssemblyProductAttribute), false)[0] as AssemblyProductAttribute;
var isFrameworkAssembly = (attribute.Product == "Microsoft® .NET Framework"); 
```

我正在使用这种技术在应用程序的“关于”屏幕下按产品对程序集进行分组，这对我来说似乎工作得很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-08T09:42:17.663

我不得不处理完全相同的问题。不幸的是，到目前为止给出的所有答案都**不足以**安全地确定程序集是否是 .NET Framework 的一部分。

Microsoft 将一个名为的类`FXAssembly`放入每个框架程序集的全局命名空间中，并带有一个指示版本的 const 字符串：

```
.class private abstract auto ansi sealed beforefieldinit FXAssembly
    extends [mscorlib]System.Object
{
    .field assembly static literal string Version = string('2.0.0.0')

} 
```

使用此“标记”来检查程序集是否为框架程序集。检查公钥也不会受到伤害。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-09T15:30:19.640

我怀疑最可靠和最通用的方法将是 PublicKeyToken。是的，不止一个，但它将是一个有限的列表，并且不会经常更改。

就此而言，您可以只拥有一个程序集名称的白名单——该列表在框架版本之间也是有限的和静态的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-28T09:08:33.057

安装 Visual Studio 时，您会在表单的各个子文件夹中获得参考程序集`C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\{FrameworkName}\{FrameworkVersion}`- 最有趣的可能是`RedistList\FrameworkList.xml`包含与给定框架版本一起提供的所有程序集名称列表的文件。

例如`C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0\RedistList\FrameworkList.xml`，似乎包含所有 .NET 4.0 框架程序集的列表。

您可以轻松地使用这些文件来建立程序集的静态白名单。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-09T15:40:18.040

您可以使用反射来查看程序集的发布者，并将其与程序集的路径协调。如果您发现一个程序集的发布者是 Microsoft，并且它存在于下面`C:\Windows\Microsoft.NET\Framework`的某个位置，那么可以肯定它是运行时的一部分。

再想一想，出版商甚至可能没有必要。该路径下的任何内容都应该是运行时的一部分（除非行为不端的应用程序在不应该出现的地方玩弄）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-06T00:02:33.027

如果您知道您的任何 DLL 都不会在 GAC 中，您可以检查每个程序集是否在 GAC 中。如果是，请不要复制它。如果不是，请复制它。Assembly 类上有一个名为 GlobalAssemblyCache 的属性。这在某些情况下显然比在其他情况下更有效。

# ajax - Flash 与 AJAX/JS 的（技术）优缺点是什么？

> ID：52140
> 
> 赞同：6
> 
> 时间：2008-09-09T15:20:26.153
> 
> 标签：ajax, flash, ria

我们提供一个 Web 应用程序，其前端完全使用 Adob​​e Flash 开发。当我们 6 年前选择 Flash 时，我们这样做是因为它有大量的用户交互功能，比如拖动东西、打开和关闭菜单、树形导航元素、弹出对话框等。

今天很明显，AJAX/JS 提供了大致相同的可能性，并且由于现成的框架数量众多，实现它们非常可行。

是否有技术原因应该选择其中一种技术而不是另一种？“技术”是指性能、安全性、便携性/兼容性等。我并不是指诸如在 Flash 中完成非常非程序员的开发方式之类的方面，或者将应用程序从一个切换到另一个是否有意义。

正如我刚刚[在另一个问题](https://stackoverflow.com/questions/52094/which-ria-technology-has-the-biggest-market-share)中解释的那样，在我看来，JS 在市场份额方面遥遥领先，我想知道如果我们坚持使用 Flash，我们是否错过了一些重要的点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T15:38:01.213

除了其他人所说的，Flash被限制在“矩形”中，不能以不显眼的方式添加到普通的html页面中。

@Gulzar 我认为当更多的浏览器将支持像 mozilla 3.1 这样的视频标签时，我们会看到更多地采用 ajax/js 而不是 flash。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-09T15:44:37.500

*   Adobe Actionscript 是静态类型语言，Javascript 是动态类型。根据您的观点，这可能是好事也可能是坏事。
*   使用 Javascript/HTML/CSS，您将进入跨浏览器兼容性的地狱，尤其是如果您想支持旧版浏览器。这可以通过可用的库来缓解，但这仍然是一个令人头疼的问题。使用 Flash，您只需编写一次代码，它就可以在所有浏览器中运行。
*   即使有可用的库，Flash 用户控件也比您在 Javascript/HTML 世界中找到的任何东西都要先进。在 Javascript 中，您不会找到任何与 Flash 提供的数据绑定用户控件的简单性和强大功能相近的东西。

我看不出 Javascript 如何比 Flash 拥有更多的“市场份额”。几乎所有拥有网络浏览器的人都安装了 Flash 插件。我很想知道有多少人禁用了 Javascript 但有一个 Flash 插件。

另外请记住，如果您决定转换您的技术基础，那么您将面临巨大的学习曲线和大量的开发时间，因此您最好有充分的商业理由这样做。

这个决定也与你的应用程序做什么以及你的安装基础有很大关系。

**编辑：** 我看到人们提到 iPhone 不支持 Flash。我希望这会随着 iPhone 的安装基础而改变——Adobe 不支持它会疯的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-09T15:25:14.583

*   正确设计的 AJAX 应用程序比 Flash 更易于搜索
*   设计正确的 AJAX 应用程序比 Flash 更容易进行深度链接
*   AJAX 不需要插件（Flash 无处不在，所以没什么大不了的）*
*   AJAX 不像 Flash 那样由一家公司控制

编辑添加：* 正如 Abdu 指出的那样，iPhone 除外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T15:22:53.420

JS 和 Flash 在网络上都有很好的存在，具有重叠的功能。JS 仍然缺乏的一个领域是渲染视频。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T18:04:52.297

使用得当的 Flash 可以轻松实现本地化和国际化。

此外，以可访问的方式使用 Flash 要容易得多；您可以为屏幕阅读器提供正确的文本，而不是让它们遍历所有可能的表单元素。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-09T15:31:22.557

我认为Flash应该仅限于网络游戏、视频和动画。否则使用 html 和 Ajax。这是一个网络标准，几乎所有设备都支持。AFAIK，iPhone 不支持 Flash。这是一个快速增长的细分市场，你已经在屏蔽了。保持简单和高效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-09T15:33:54.063

尽管 Flash 在桌面浏览器上非常普遍，但移动支持非常有限（flash lite？是的，对）。我非常沮丧地在手机上查找餐厅，却发现整个网站都是基于闪存的，我什至无法获得电话号码或地址！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-09T15:42:50.140

Flash 的一个好处是它有一些工具可以帮助安全地进行跨域类型的操作，这很有帮助。Flash 还对某些硬件提供（有限的）支持，这在 Javascript 中是不可能的。

就个人而言，在转向 Flash 之类的东西之前，我会尝试尽可能多地使用 Ajax。从 UI 的角度来看，更好的是控件和基本创作更加发达。[Sound Manager](http://www.schillmania.com/projects/soundmanager2/)项目是一个很好的例子，它有效地使用了少量的 Flash，而其余部分则保留在 Javascript 中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T14:10:40.837

我怀疑 javascript 变得越来越流行的原因之一是它更容易改装到现有的应用程序中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-12T12:52:41.803

由于我不能接受两个答案，我将在我自己的帖子中合并[Christ Upchurch](https://stackoverflow.com/questions/52140/what-are-the-technical-pros-and-cons-of-flash-vs-ajaxjs#52150)和[26 个答案中的 17 个。](https://stackoverflow.com/questions/52140/what-are-the-technical-pros-and-cons-of-flash-vs-ajaxjs#52212)我想，这两者几乎总结了我想知道的。多谢你们！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-11-30T02:02:38.950

如果您经常处理多边形，那么 Flash 仍然更易于编程和调试。使用 AJAX 有很多库可以处理多边形，但是您的应用程序使用的库越多，运行速度就越慢。

# vb6 - VB6 运行时类型检索

> ID：52160
> 
> 赞同：6
> 
> 时间：2008-09-09T15:29:16.507
> 
> 标签：vb6, runtime

如何在运行时获取 VB6 中对象的类型（字符串形式的名称就足够了）？

即类似的东西：

```
If Typeof(foobar) = "CommandButton" Then ... 
```

**/编辑：**澄清一下，我需要检查动态类型对象。一个例子：

```
Dim y As Object 

Set y = CreateObject("SomeType")

Debug.Print( <The type name of> y) 
```

输出将是“CommandButton”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-09T16:04:01.043

我认为您正在寻找的是 TypeName 而不是 TypeOf。

```
If TypeName(foobar) = "CommandButton" Then
   DoSomething
End If 
```

编辑：你是什么意思动态对象？你的意思是用 CreateObject("") 创建的对象，因为它应该仍然有效。

编辑：

```
Private Sub Command1_Click()
    Dim oObject As Object
    Set oObject = CreateObject("Scripting.FileSystemObject")
    Debug.Print "Object Type: " & TypeName(oObject)
End Sub 
```

输出

`Object Type: FileSystemObject`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T04:29:24.190

TypeName 是你想要的......这是一些示例输出：

VB6 代码：

```
Private Sub cmdCommand1_Click()
Dim a As Variant
Dim b As Variant
Dim c As Object
Dim d As Object
Dim e As Boolean

a = ""
b = 3
Set c = Me.cmdCommand1
Set d = CreateObject("Project1.Class1")
e = False

Debug.Print TypeName(a)
Debug.Print TypeName(b)
Debug.Print TypeName(c)
Debug.Print TypeName(d)
Debug.Print TypeName(e)
End Sub 
```

结果：

```
String
Integer
CommandButton
Class1
Boolean 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T16:08:55.197

我手头没有 VB6 的副本，但我认为您需要

```
Typename() 
```

函数...我可以在 Excel VBA 中看到它，所以它可能在同一个运行时。*有趣的是，帮助似乎表明它不适用于用户定义的类型，但这是我*使用它的唯一方法。

帮助文件的摘录：

> 类型名称函数
> 
> 返回提供有关变量信息的字符串。
> 
> 句法
> 
> 类型名（变量名）
> 
> 所需的 varname 参数是一个 Variant，其中包含除用户定义类型的变量之外的任何变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T15:35:15.697

这应该证明是困难的，因为在 VB6 中所有对象都是 COM ( `IDispatch`) 事物。因此它们只是一个接口。

`TypeOf(object) is class`可能只进行 COM get_interface 调用（我忘记了确切的方法名称，抱歉）。

# unit-testing - BNF语法测试用例生成

> ID：52167
> 
> 赞同：10
> 
> 时间：2008-09-09T15:32:16.267
> 
> 标签：unit-testing, parsing

有没有人有使用从 BNF 语法生成测试字符串然后可以输入单元测试的工具的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T16:32:46.217

我没有工具问题的答案，但我会说在任何文本处理语言（perl/python/etc）中从 BNF 语法随机生成句子都相当容易，而在更大的语言中稍微冗长一些（ Java/C/etc），但自己动手应该不会太难。

这样做的问题当然是它只能在语法中生成字符串，而且除非你的语法很简单，否则测试空间是无限大的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T16:43:41.697

我已经完全按照 hazzen 评论的方式完成了（在脚本语言中使用嵌入式 DSL）。这是一个稍微有趣的练习，但除了最基本的解析测试之外，它并不是非常有用。我的大多数最有趣的测试都与比 BNF（或任何其他上下文无关语法）更复杂的关系有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:21:59.883

例如，如果您正在开发一个编译器，那么您可能有一个抽象语法树数据类型。如果是这样，那么您可以编写一个函数来生成一个随机 AST —— 这样，您可以将其打印到一个字符串并将其提供给您的单元测试。以这种方式保证它是一个有效的程序，因为你是从你的 AST*开始的。*

如果我在 Haskell 或 ML 中编写编译器，这就是我会做的，使用[QuickCheck](http://www.cs.chalmers.se/~rjmh/QuickCheck/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-17T01:49:45.723

[Gramtest](https://github.com/codelion/gramtest)就是这样一种工具，它可以从任意用户定义的 BNF 语法生成字符串。您可以在此处阅读有关 Gramtest 背后算法的更多详细信息，并[在](https://blog.srcclr.com/practical-tips-for-implementing-grammar-based-test-case-generation/)[此处](https://blog.srcclr.com/how-does-grammar-based-test-case-generation-work/)提供有关该工具的一些实用技巧。

# operating-system - 您希望操作系统具有哪些功能？

> ID：52168
> 
> 赞同：2
> 
> 时间：2008-09-09T15:32:18.403
> 
> 标签：operating-system

比方说，在一个一切皆有可能的完美世界里。一般来说，您希望您的操作系统、IDE、编译器或计算机具有哪些功能。

当然，每个人都希望减少启动时间和超级 faaaaaast 处理器，还有什么？我个人真的很想有人类语言识别。

这个问题可能听起来有点傻，但如果你没有远距离目标，你也不知道现在该去哪里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T15:35:57.413

我喜欢什么？调试时“倒退”的一种方式。那将是真棒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-21T21:42:45.027

True security.

I want to be able to run any program I download off the Internet and not have to worry about it being a virus. I want an operating system that has defined security so well that there doesn't need to be anti-virus or firewalls anymore.

Sandboxing is the key, but also fine level security. For example by default, a program should only receive keyboard or mouse input when it is in focus. A program, should never be able to change its own window state. A program cannot write or read from disk until told so by the user. A program cannot take a screen shot of your desktop. A program has no network access. A program has no hardware access. A program has limited memory and CPU usage.

Secure computing **by default**

Whenever you run or install anything, it should never "hook" into the OS. It should never replace a core function of the OS, this includes drivers.

The user should be able to control the OS at all times, and the OS in turn should be able to control all programs at all times. This way when a program fails, it doesn't crash the entire computer. The OS should never say "well, the program used our API improperly, therefore all we could do is crash".

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T15:36:12.777

我想要一种更好的方式来整理我的东西。文件和文件夹的概念可以追溯到几十年前，当您通过电传打字机与中央服务器进行交互时。是时候做些更好的事情了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T15:36:42.263

*   一切的键盘命令
*   “即时”睡眠/休眠功能
*   对多显示器和大显示器的良好支持（基本上内置了[Ultramon](http://realtimesoft.com/ultramon/)和[WinSplit Revolution ）](http://www.winsplit-revolution.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-21T21:47:18.793

I'd like to have a computer be able to read my current cognitive state wirelessly and predict in a non-deterministic way what I need in order to achieve the state of Nirvana and then deliver that experience instanteously.

(This is a bit geeky and has been played out in various films from Wall*E and Vanilla Sky to the Matrix and eXistenZ in varying degrees)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-21T22:25:18.327

Collab work. Share a window and work on it. Open a Word doc directly from the cloud and save it there in one step. Drag n drop a window from your computer to your coworker's computer. The window continue to run on your computer, but is shown on your coworker or both worker's computer.

Multiplelogin: the taskbar is organised by username and program/browsers are under it. Some usernames for work, some usernames for home. That way I could have two gmail open with two logins. Same for local apps.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-09T15:34:00.833

如果每次更新内核时不必重新安装图形驱动程序，我肯定会喜欢的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-09T15:58:26.983

呃......人们......显而易见的答案：矩阵式大脑插孔。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-09T16:28:16.350

一切都必须是可编写脚本的！

“后端”和“前端”之间更紧密的联系。例如，操作系统级别的宏允许我记录与任何应用程序的任何交互（与“所有内容的键盘命令”注释相关）。如果宏实际上只是对应用程序 API 的脚本语言调用，那就更好了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T05:12:27.977

我的 #1 缺少的操作系统功能是一个 2 部分的打击：

1) 分层任务管理器：不是管理运行中的应用程序的一长串 1 级列表，而是让我能够将多个应用程序嵌套到我自己定义的“应用程序组”中并在它们之间切换。我知道这可以通过虚拟桌面来完成，但没有一个做得对。我不需要完全独占的桌面“空间”，我只想要将正在运行的应用程序/文档/浏览器组织到定义的组中的能力。

2) 冻结/保持单个应用程序（或应用程序组）的整个状态并在以后恢复它们的能力。为什么每次重新启动时都必须关闭我需要的 15 个不同的正在运行的应用程序，然后又不得不浪费时间重新启动它们？为什么每次我想玩游戏或切换到完全不同的工作模式时，我必须关闭所有与我的“网络开发”工作模式相关的应用程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-21T21:59:15.227

I would like an operating system without the **bloat**. Windows XP ships with tons of bloat by default... I went from about a 50-60s boot time to a 20-30s, after getting rid of all the stuff I don't need that is enabled by default(this is without using something like nLite too). Not to mention my laptop actually runs super zippy now, and actually makes games playable that previously wouldn't even run. I was super surprised that spore and doom3 were playable..

Linux is no better at this either, I have a default Ubuntu install with dual-booting and it takes about a minute. I don't do too many "demanding" tasks with Linux but the boot time shows that their are many services and things running that are simply unnecessary.

If the "killer-apps" ran on dos or win98 I'd switch back in a minute.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-09T15:52:16.173

实用的高分辨率 3D 显示器

# sql-server - SQL Server2005内存锁定

> ID：52169
> 
> 赞同：-1
> 
> 时间：2008-09-09T15:32:27.343
> 
> 标签：sql-server

我注意到 SQL Server 2005 x64 似乎不像 SQL Server 2000 那样将页面锁定到内存中。在 2000 年，我可以很容易地从任务管理器中看到 SQL 用 AWE 锁定了 8GB 的​​内存。我相当确定我已经以等效的方式设置了 2005 年。

这是正常的 x64 差异还是我忘记了关键的设置选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T19:15:55.887

SQL Server 2005 x64 当然不需要或使用 AWE；AWE 仅允许它在 32 位系统上使用 > 4GB。

您*可以*使用旧的 lock-pages-in-memory 技巧，但正如此 KB 所示 ( [http://support.microsoft.com/kb/918483](http://support.microsoft.com/kb/918483) )：“注意对于 SQL Server 2005 的 64 位版本，只有 SQL Server 2005 Enterprise Edition 可以使用 Lock pages in memory 用户权限。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-19T00:43:18.247

我也看到过很多权限问题——如果您用于 SQL Server 服务的帐户没有正确的权限，即使您运行的是企业版，它也无法将页面锁定在内存中。PSS SQL Server 工程师的这篇博文非常有帮助：

[PSS 工程师：我是否必须为本地系统分配内存中的锁定页面权限？](http://blogs.msdn.com/psssql/archive/2007/10/18/do-i-have-to-assign-the-lock-privilege-for-local-system.aspx)

# windows - Windows XP 上的不可移动文件

> ID：52172
> 
> 赞同：3
> 
> 时间：2008-09-09T15:32:44.580
> 
> 标签：windows, filesystems

当我对我的 XP 机器进行碎片整理时，我注意到有一块“不可移动文件”。是否有文件属性可用于使我自己的文件不可移动？

澄清一下，我想要一种以编程方式告诉 Windows 我创建的文件应该是不可移动的方法。这可能吗，如果可以，我该怎么做？

谢谢，

特里

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T15:38:59.993

A lot of system files cannot be moved after the system boots, such as the page file and registry database files.

[This utility](http://technet.microsoft.com/en-us/sysinternals/bb897426.aspx) runs before Windows boots to defragment those files. I have it set to run at every boot, and it works well for me on several machines.

请注意，第一次启动并运行此实用程序时，碎片整理可能需要几分钟时间。不过，在第一次运行之后，它只需 3 或 4 秒即可完成。

*Edit0：为了回应您的澄清-该链接表示 Windows 已将页面文件和注册表文件标记为打开以供独占访问。因此，您应该能够使用[LockFile](http://msdn.microsoft.com/en-us/library/aa365202(VS.85).aspx) API 调用来做同样的事情。但是，这不是文件本身的属性。您必须实际运行一些后台程序来锁定文件以进行独占访问。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T18:14:51.023

There are no file attributes that you can place on your files to mark them as immovable. The only way that a file cannot be moved (I think) during defragmentation is to have some other process have the file open (for read or write, I'm not even sure that you need to have the file open in exclusive mode or not).

坦率地说，我想不出你不希望你的文件移动的原因，除非你对你的文件在磁盘盘片上的位置有特定的要求。碎片整理通常会导致更快的磁盘访问，这似乎在所有情况下都是可取的:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T15:36:29.953

This usually means that the file is in use by some process. If you're defragmenting, you'll likely see this with a lot of system files. If the file should legitimately be movable and is stuck (it's being held by a process that runs at startup but shouldn't be, for example), the most useful way of resolving the problem is to remove all permissions on the file, reboot, restore the permissions, and then get rid of the file/run the program that's trying to use it.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T15:48:45.527

我想丑陋的方法是在启动时启动应用程序，每隔几秒钟检查一次碎片整理是否正在运行，如果是，则以独占模式打开文件。

这真的很难看，除非没有更清洁的解决方案，否则我不推荐它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T15:49:23.650

特里，答案都提到了防止文件在碎片整理期间变得不可移动的方法。从您的问题看来，您实际上是*想让*您的个人文件无法移动。您能否澄清一下使您的文件无法移动的吸引力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-09T15:35:37.913

我假设您使用的是 Windows 附带的碎片整理程序。一些像 DiskKeeper 这样的商业软件可以移动其中的一些文件（通常是系统文件）。你可以试试他们的试用版。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-09T15:48:43.763

Contig 可能会满足您的目的[http://technet.microsoft.com/en-us/sysinternals/bb897428.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897428.aspx)

我相对确定我遇到了一些您可以通过编程方式访问的方法/属性来完全按照您的意愿行事。不过那是在NT4天，我的记忆力不是很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-09T16:14:25.930

For a little more complete solution try Raxco's PerfectDisk. While it is a commercial product it does a very good job and supports boot time defrag of system files. The first defrag takes longer than say DiskKeeper but its a single pass defragger and supports defragging with very little free space left on the drive. Overall its a much smarter defrag program then any other I've seen and supports systems of any size.

[http://www.raxco.com/](http://www.raxco.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-19T22:01:45.573

首先尝试在安全模式下移动（或删除）文件。如果不能，请尝试使用 linux 移动（或删除）文件。

但要小心，如果这些是 Windows 系统文件，那么你将无法启动你的 Windows。

文件无法移动的一些原因是：文件太大，文件处于打开/使用状态，安全权限不足，被其他计算机访问，以及许多其他原因。

# algorithm - 优秀的开发人员应该了解哪些核心数学概念？

> ID：52176
> 
> 赞同：62
> 
> 时间：2008-09-09T15:33:58.010
> 
> 标签：algorithm, math, language-agnostic

自从 2006 年从一所规模很小的学校毕业后，课程的形式很糟糕且过时（我是外国人，当时不知道更好的学校），我开始意识到我错过了很多基本概念数学和软件视角，主要是其他更高概念的基础。

即我试图听/看麻省理工学院关于[算法介绍](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/CourseHome/)的开放课件，但很快意识到我错过了几个数学概念以更好地理解这门课程。

那么一个优秀的软件工程师应该知道哪些核心数学概念呢？您会向我推荐哪些可能的书籍/网站？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-09-09T15:55:21.377

[程序员的数学](http://steve-yegge.blogspot.com/2006/03/math-for-programmers.html)。很好的阅读。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-09T16:57:00.820

布尔代数是理解控制结构和重构的基础。例如，我见过许多由不了解（或无法使用）德摩根定律的程序员引起的错误。再举一个例子，有多少程序员立即意识到

```
if (condition-1) {
    if (condition-2) {
        action-1
    } else {
        action-2
} else {
    action-2
} 
```

可以改写为

```
if (condition-1 and condition-2) {
    action-1
} else {
    action-2
} 
```

离散数学和组合学对于理解各种算法和数据结构的性能非常有帮助。

正如 Baltimark 所提到的，数学归纳法在推理循环和递归方面非常有用。

集合论是关系数据库和 SQL 的基础。

通过类比，让我指出木匠在建造屋顶和楼梯等东西时经常使用各种经验法则技术。但是，几何知识可以让您解决没有“固定”经验法则的问题。这就像通过语音学习阅读与基本词汇的视觉识别相比。90+%的时间没有太大区别。但是，当您遇到不熟悉的情况时，拥有自己制定解决方案的工具非常好。

最后，数学要求的严谨性/精度对于编程来说是非常有用的准备，无论具体技术如何。同样，我在职业生涯中看到的许多编程（甚至规范）错误的根本原因都是草率的思考。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-09T17:13:28.177

我会选择兰登所说的领域：

> 离散数学、线性代数、组合学、概率与统计、图论

并添加数学逻辑。

这将使您掌握 CS 的大多数领域。如果你想进入特殊领域，你必须深入一些领域，尤其是：

```
Computer graphics -> Linear Algebra
Gaming -> Linear Algebra, Physics
Computer Linguistics -> Statistics, Graph Theory
AI -> Statistics, Stochastics, Logic, Graph Theory 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-09T18:34:09.137

按重要性排序：

*   计数（循环所需）
*   加法、减法、乘法、除法。
*   代数（仅真正需要了解变量的使用）。
*   布尔代数、布尔逻辑和二进制。
*   指数和对数（即理解 O(n) 表示法）。

比这更高级的东西通常是特定于算法或特定于域的。根据您感兴趣的领域，以下内容也可能是相关的：

*   线性代数和三角学（3D 可视化）
*   离散数学和集合论（数据库设计、算法设计、编译器设计）。
*   统计（嗯，用于统计和/或科学/经济应用。也可能对算法设计有用）。
*   物理学（用于模拟）。

理解函数也很有用（不记得该领域的数学术语是什么），但如果你知道如何编程，你可能已经知道了。

我的观点是：一个十岁的孩子应该知道足够的数学知识才能理解编程。对事物的基本理解并不需要太多的数学知识。这都是关于逻辑的，真的。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-09T15:42:11.017

“归纳证明”是程序员要知道的核心数学概念。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-09T15:57:05.943

[一般算法分析中的大 O 表示法](http://en.wikipedia.org/wiki/Big_O_notation)，以及与标准集合相关的（排序、检索插入和删除）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-09T17:12:10.957

对于离散数学，[这](http://video.google.com/videoplay?docid=-2965569821331370765&ei=Ua3GSODbC5Gk-wH328G6Dg&q=arsdigita+discrete)是来自 Arsdigita 大学的一组很棒的 20 场讲座。每个大约有一个小时二十分钟。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-09T15:37:22.620

从我们 CS 人员所说的“离散数学”开始。微积分和线性代数也可以派上用场，因为它们可以让您踏入许多应用领域的大门。一旦你掌握了这三个，就去学习概率论。这 4 项将使您具备 95%（我编造的）应用领域的能力。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-09-09T19:52:41.430

[具体数学](http://www-cs-faculty.stanford.edu/~knuth/gkp.html)涵盖了大部分主要主题。一本关于离散数学的好书，如罗森的[离散数学及其应用](https://rads.stackoverflow.com/amzn/click/com/0072899050)，将填补任何空白。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-09T16:26:43.267

我认为这取决于你的注意力。几年前，我购买了 Donald Knuth 的《计算机编程艺术》。看了书后，我意识到几乎所有东西都是微积分证明。如果您有兴趣为它们开发自己的通用算法和证明，那么我建议您能够理解上述书籍，因为这是您在那个世界中要处理的内容。另一方面，如果您只想/需要使用各种排序/搜索/树/等...例程，那么至少大 O 表示法、布尔数学和一般代数就可以了。如果您正在处理 3D，那么几何和三角也是如此。

我更倾向于使用而不是做证明，虽然我想这些年来我做了一些聪明的事情，但我从来没有坐下来开发一个新的分类程序。我能给出的最好建议是了解你的领域需要什么，但要让自己接触更高的水平，这样你就知道它的存在以及还有多少要学，否则你不会有太多的成长。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-09T16:11:36.390

我会说布尔逻辑。与、或、异或、非。我发现作为程序员，我们比其他数学概念更频繁地使用它。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-09T15:40:50.817

基本代数和统计是很好的起点，也是许多其他领域的基础。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-09T17:13:47.880

当我看到不理解它的开发人员时，这是一个让我感到困惑的简单问题：
- 操作顺序

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-18T15:39:46.470

“计算机编程的艺术”的第 1 章旨在提供这一点。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-09T15:38:21.277

推荐了一本书……书名类似于《具体数学》。在几个问题中被推荐。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-24T20:36:38.047

回到学校，我的一位导师说，对于商业应用程序，所有你需要知道的加、减、乘和除。请求者将知道并告知您需要什么的所有其他公式。现在意识到这是为以报告和应用程序为重点的学校提供​​资金。直到今天，这对我来说都是正确的。我从来不需要知道更多。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-12-17T12:08:16.497

查看《[计算机科学基础》](http://infolab.stanford.edu/~ullman/focs.html)
这本书的作者：Al Aho 和 Jeff Ullman，整本书可在线获取。

这就是作者在他们的序言中对本书目标所说的话：

"*计算机科学基础*涵盖的科目通常分为
离散数学课程和数据结构中计算机科学的二年级序列
。我们的目的是选择数学
基础，着眼于计算机用户真正需要什么，而不是
数学家可能会选择什么。”

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-04-29T13:34:02.293

一个复习数学的网站： [http ://www.khanacademy.org/](http://www.khanacademy.org/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-09T15:39:51.070

我的数学背景真的很差（受过地质学家培训），但我在高中上过一[门离散数学](http://en.wikipedia.org/wiki/Discrete_mathematics)课，作为程序员，我每天都在使用这些概念。这可能是我所有教育中最有价值的课程，因为它与我目前的职业有关。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-09T17:03:47.967

离散数学
线性代数
组合
概率和统计
图论

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-09T17:38:12.657

*   布尔代数
*   集合论
*   离散数学

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-18T15:58:25.050

嗯，这取决于你的目标是什么。正如有人所说，如果你要解决难题，线性代数、组合学、概率统计和图论很重要。函数的渐近增长（bit-Oh 表示法）非常重要。如果您需要分析一些更复杂的算法，您还需要掌握求和和级数（参见 Cormen 和其他算法介绍的附录）。

即使你喜欢“企业级 Java”或“服务器端 PHP”，当你的老板希望你获得服务器时，你会发现一些统计和算法复杂性（因此是组合、归纳、求和、系列等）很有用更快地工作，添加新硬件似乎无济于事。:-) 我经历过一次。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-24T15:29:16.170

*   布尔代数
*   集合论

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-24T15:58:05.377

为什么每个人都将概率和统计列入金榜，却不提微积分？如果没有极限、导数、积分和级数的工作知识，就无法理解概率和统计是关于什么的。总而言之，微积分（连同线性代数）是*所有*数学的主力。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-11-13T07:25:14.847

我认为算法和理论非常重要。能够提出快速、*正确*的解决方案是优秀程序员与其他程序员的区别所在。此外，能够证明您的算法（使用标准证明技术——归纳、矛盾等）同样重要。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-04-14T17:08:42.933

是的，我想说对归纳的基本理解有助于你理解 n 在算法中代表什么。一些逻辑和离散结构也很有帮助。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-04-14T17:14:14.817

**如果您必须做任何类似于机器学习的事情，**概率和统计将非常有用。****

 **我在“[计算你的技能](http://www.moserware.com/2010/03/computing-your-skill.html)”博客文章中介绍了基础知识，其中讨论了 Xbox Live 的 TrueSkill 排名和匹配算法的工作原理。

# linux - Linux 的虚拟串行端口

> ID：52187
> 
> 赞同：159
> 
> 时间：2008-09-09T15:36:19.940
> 
> 标签：linux, serial-port, virtual-serial-port

我需要在 Linux 上测试一个串口应用程序，但是，我的测试机只有一个串口。

有没有办法将虚拟串行端口添加到 Linux 并通过 shell 或脚本模拟设备来测试我的应用程序？

注意：我无法重新映射端口，它在 ttys2 上硬编码，我需要在编写应用程序时对其进行测试。

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2013-11-01T19:07:15.883

补充@slonik的答案。

您可以通过以下步骤测试 socat 以创建虚拟串行端口（在 Ubuntu 12.04 上测试）：

**打开一个终端（我们称之为终端 0）并执行它：**

```
socat -d -d pty,raw,echo=0 pty,raw,echo=0 
```

**上面的代码返回：**

```
2013/11/01 13:47:27 socat[2506] N PTY is /dev/pts/2
2013/11/01 13:47:27 socat[2506] N PTY is /dev/pts/3
2013/11/01 13:47:27 socat[2506] N starting data transfer loop with FDs [3,3] and [5,5] 
```

**打开另一个终端并写入（终端 1）：**

```
cat < /dev/pts/2 
```

该命令的端口名称可以根据电脑进行更改。这取决于先前的输出。

```
2013/11/01 13:47:27 socat[2506] N PTY is /dev/pts/**2**
2013/11/01 13:47:27 socat[2506] N PTY is /dev/pts/**3**
2013/11/01 13:47:27 socat[2506] N starting data transfer loop with FDs 
```

您应该使用突出显示区域上可用的数字。

**打开另一个终端并写入（终端 2）：**

```
echo "Test" > /dev/pts/3 
```

现在回到 1 号航站楼，您将看到字符串“Test”。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2008-09-16T16:56:55.927

您可以为此使用 pty（“伪电传打字机”，其中串行端口是“真正的电传打字机”）。从一端打开`/dev/ptyp5`，然后将您的程序附加到`/dev/ttyp5`；`ttyp5`它将像一个串行端口一样工作，但会通过 /dev/ptyp5 发送/接收它所做的一切。

如果您真的需要它`/dev/ttys2`来`/dev/ttys2`与一个名为.`ptyp5``ttys2`

当然，您可以使用除 之外的其他数字`ptyp5`。也许选择一个数字大的以避免重复，因为您所有的登录终端也将使用 ptys。

维基百科有更多关于 ptys 的信息：[http ://en.wikipedia.org/wiki/Pseudo_terminal](http://en.wikipedia.org/wiki/Pseudo_terminal)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2012-05-11T17:21:02.337

为此使用 socat：

例如：

```
socat PTY,link=/dev/ttyS10 PTY,link=/dev/ttyS11 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-07-07T11:01:51.393

还有 tty0tty [http://sourceforge.net/projects/tty0tty/](http://sourceforge.net/projects/tty0tty/)这是一个真正的 linux 空调制解调器模拟器。

它是一个简单的内核模块——一个小的源文件。我不知道为什么它只对 sourceforge 表示不满，但它对我来说效果很好。最好的一点是它还模拟了硬件引脚（RTC/CTS DSR/DTR）。它甚至实现了 TIOCMGET/TIOCMSET 和 TIOCMIWAIT iotcl 命令！

在最近的内核上，您可能会遇到编译错误。这很容易解决。只需在 module/tty0tty.c 源代码的顶部插入几行（在包含之后）：

```
#ifndef init_MUTEX
#define init_MUTEX(x) sema_init((x),1)
#endif 
```

加载模块时，它会创建 4 对串口。这些设备是 /dev/tnt0 到 /dev/tnt7，其中 tnt0 连接到 tnt1，tnt2 连接到 tnt3，等等。您可能需要修复文件权限才能使用这些设备。

编辑：

我想我的热情有点快。虽然驱动程序看起来很有希望，但它似乎不稳定。我不确定，但我认为它使我在家工作的办公室中的一台机器崩溃了。直到我星期一回到办公室才能检查。

第二件事是 TIOCMIWAIT 不起作用。该代码似乎是从一些“微小的 tty”示例代码中复制而来的。TIOCMIWAIT 的处理似乎到位，但它永远不会唤醒，因为缺少对 wake_up_interruptible() 的相应调用。

编辑：

办公室的车祸真的是司机的错。缺少初始化，完全未经测试的 TIOCMIWAIT 代码导致机器崩溃。

我昨天和今天都在重写驱动程序。有很多问题，但现在对我来说效果很好。驱动程序管理的硬件流控制仍然缺少代码，但我不需要它，因为我将使用用户模式代码中的 TIOCMGET/TIOCMSET/TIOCMIWAIT 自己管理引脚。

如果有人对我的代码版本感兴趣，请给我发消息，我会发给你。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-01T10:58:32.877

您可能想查看使用内核驱动程序创建 linux 虚拟串行端口的[Tibbo VSPDL——](http://www.tibbo.com/vspdl.php)它看起来很新，现在可以下载（测试版）。目前不确定许可证，或者他们是否希望将来仅在商业上可用。

还有其他商业替代品，例如[http://www.ttyredirector.com/](http://www.ttyredirector.com/)。

在开源中，[Remserial](http://lpccomp.bc.ca/remserial/) (GPL) 也可以使用 Unix PTY 做你想做的事。它将“原始形式”的串行数据传输到网络套接字；创建端口时必须完成类似 STTY 的终端参数设置，稍后像 RFC 2217 中描述的那样更改它们似乎不受支持。您应该能够运行两个 remserial 实例来创建像 com0com 这样的虚拟 nullmodem，但您需要提前设置端口速度等。

[Socat](http://www.dest-unreach.org/socat/)（也是 GPL）就像 Remserial 的扩展变体，具有更多选项，包括用于将 PTY 重定向到其他东西的“PTY”方法，它可以是 Socat 的另一个实例。对于 Unit tets，socat 可能比 remserial 更好，因为您可以直接将文件放入 PTY。请参阅手册页上的[PTY 示例](http://www.dest-unreach.org/socat/doc/socat.html#EXAMPLE_ADDRESS_PTY)。“contrib”下存在一个[补丁，](http://www.dest-unreach.org/socat/contrib/socat-rfc2217.html)为协商串行线路设置提供 RFC2217 支持。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-02-25T18:46:02.210

使用先前答案中发布的链接，我使用虚拟串行端口在 C++ 中编写了一个小示例。我将代码推送到 GitHub：[https](https://github.com/cymait/virtual-serial-port-example) ://github.com/cymait/virtual-serial-port-example 。

该代码非常不言自明。首先，您通过运行 ./main master 创建主进程，它将打印到设备正在使用的 stderr。之后，调用 ./main slave device，其中 device 是第一个命令中打印的设备。

就是这样。您在这两个过程之间有一个双向链接。

使用此示例，您可以通过发送各种数据来测试您的应用程序，并查看它是否正常工作。

此外，您始终可以对设备进行符号链接，因此您无需重新编译正在测试的应用程序。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-09T15:55:47.613

您可以使用 USB->RS232 适配器吗？我有几个，他们只使用 FTDI 驱动程序。然后，您应该能够将 /dev/ttyUSB0 （或创建的任何内容）重命名为 /dev/ttyS2 。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-09T16:32:52.050

我可以想到三个选项：

## 实施 RFC 2217

[RFC 2217](http://www.rfc-archive.org/getrfc.php?rfc=2217)涵盖了 TCP/IP 标准的 com 端口，允许一个系统上的客户端模拟本地程序的串行端口，同时透明地发送和接收数据和控制信号到另一个系统上实际具有串行端口的服务器。这是一个[高级概述](http://pcmicro.com/support/rfc2217.html)。

您要做的是找到或实现一个客户端 com 端口驱动程序，该驱动程序将在您的 PC 上实现系统的客户端 - 看起来是一个真正的串行端口，但实际上将所有东西都穿梭到服务器上。您也许可以从 Digi、Lantronix 等公司免费获得此驱动程序，以支持他们真正的独立串行端口服务器。

然后，您将在另一个程序中本地实现连接的服务器端 - 允许客户端根据需要连接并发出数据和控制命令。

这可能很重要，但 RFC 已经存在，您可能会找到一个开源项目来实现连接的一侧或两侧。

## 修改linux串口驱动

或者，Linux 的串行端口驱动程序源很容易获得。拿那个，拆掉硬件控制部分，让一个驱动程序运行两个 /dev/ttySx 端口，作为一个简单的环回。然后将您的真实程序连接到 ttyS2 并将您的模拟器连接到另一个 ttySx。

## 在环回中使用两个 USB<-->串行电缆

但是现在最容易做的事情是什么？花 40 美元购买两个串行端口 USB 设备，将它们连接在一起（零调制解调器），实际上有两个真正的串行端口 - 一个用于您正在测试的程序，一个用于您的模拟器。

-亚当

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-11-29T09:32:32.330

```
$ socat -d -d pty,link=/tmp/vserial1,raw,echo=0 pty,link=/tmp/vserial2,raw,echo=0 
```

`/tmp/vserial1`将为生成的`/tmp/vserial2`虚拟串行端口生成符号链接`/dev/pts/*`

[资源](https://unix.stackexchange.com/questions/374916/how-to-use-virtual-serial-port-without-root-privileges?newreg=9b02ebd5b0f7498399a49b1ad51d558d)

# html - 浏览器刷新行为

> ID：52213
> 
> 赞同：20
> 
> 时间：2008-09-09T15:45:19.543
> 
> 标签：html, http, refresh

当用户在浏览器上点击刷新时，它会重新加载页面但保留表单字段的内容。虽然我可以看到这是一个有用的默认设置，但在某些动态页面上可能会很烦人，从而导致用户体验受损。

有没有办法在 HTTP 标头或等效项中改变这种行为？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-09T15:52:08.480

```
<input autocomplete="off"> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-09T15:53:32.097

这应该可以解决问题：

```
<body onload="document.FormName.reset();"> 
```

将 FormName 替换为您的表单名称，然后当用户在浏览器中单击刷新时，所有字段都将被重置。

或者，如果您只想重置某些字段，请将其添加到页面底部：

```
<script type="text/javascript">
    document.getElementById('field1').value ='';
    document.getElementById('field2').value ='';
    document.getElementById('field3').value ='';
</script> 
```

这将在用户每次进入页面时重置字段，包括刷新

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-28T16:44:28.480

将设置为“关闭”的自动完成属性添加到您不想刷新的输入。例如：

```
<input type="text" name="pin" autocomplete="off" /> 
```

参见 [W3C 参考](http://www.w3.org/Submission/web-forms2/#the-autocomplete)

尽管参考文献中没有提到，但它也适用于复选框，至少在 firefox 上是这样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T15:48:54.293

您可以从 html 文档的正文加载事件中调用表单对象的 reset() 方法来清除表单。

h1。参考

*   MSDN 重置方法 - [http://msdn.microsoft.com/en-us/library/ms536721(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536721(VS.85).aspx)
*   [Mozilla 开发者中心 form.reset](http://developer.mozilla.org/en/DOM/form.reset)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T15:49:56.990

我想知道，如果您将页面设置为不通过元标记进行缓存，那会解决问题吗？[http://lists.evolt.org/archive/Week-of-Mon-20030106/131984.html](http://lists.evolt.org/archive/Week-of-Mon-20030106/131984.html)如果是这样，它将有利于在禁用 Javascript 的浏览器上工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T19:09:23.057

表格上的数据不是 w3c 规范的一部分。这是一项让您的生活变得轻松的浏览器功能。因此，如果您不想在重新加载后保留数据，您可以在加载后将所有表单的值设置为 null，正如 Espo 所说。即使页面没有被缓存，它也会在表单上显示数据，因为数据不是页面 html 代码的一部分。你也可以试试这个（不知道能不能用）：

```
<input type="text" name="foo" value=""> 
```

# version-control - 使用 TFS 创建补丁

> ID：52234
> 
> 赞同：62
> 
> 时间：2008-09-09T15:57:38.017
> 
> 标签：version-control, tfs, patch

在 SubVersion 中创建补丁非常容易，使用 Tortoise，您可以右键单击并选择创建补丁。但是对于我的生活，我在 TFS 中找不到这个功能。这可能吗？

如果不是，那么在开源 TFS 托管项目（a la CodePlex）中提交补丁的标准方法是什么？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-09-09T16:03:42.667

```
tf diff /shelveset:shelveset /format:unified 
```

**编辑：**这写入标准输出。您可以将输出通过管道传输到文件。

有关更多选项，请参阅[差异命令](http://msdn.microsoft.com/en-us/library/6fd7dc73%28v=vs.100%29.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T07:30:25.390

因为 TFS 本身不支持补丁文件，所以我看到人们在 CodePlex 上做的最常见的事情就是简单地压缩修改后的文件并上传 zip。然后项目协调员对他们自己的结帐进行比较。

然而，由于 CodePlex 也支持 TortoiseSVN，越来越多的人使用它来创建他们的补丁文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-14T18:37:08.387

我写了一篇关于类似问题的博客文章，其中我使用 TF.exe 命令和 7Zip[创建了一个 TFS 补丁文件](http://codeblog.theg2.net/2014/09/create-tfs-patch-file-with-pending.html)，然后可以将其应用于另一个 TFS 服务器或工作区。[我在Github](https://github.com/gbrayut/CodeBlog/tree/master/20140914_TFS)上发布了 Powershell 脚本，该脚本可用于压缩一个工作区上的任何待处理更改，然后将它们应用到另一台服务器。必须修改它以使用变更集而不是挂起的更改，但这应该不会太难完成。

# javascript - 如何使用 Prototype 突出显示表格行？

> ID：52238
> 
> 赞同：10
> 
> 时间：2008-09-09T15:58:37.373
> 
> 标签：javascript, ajax, prototypejs

如何使用 Prototype 库并创建不显眼的 javascript 将 onmouseover 和 onmouseout 事件注入每一行，而不是将 javascript 放在每个表行标记中？

使用原型库（而不是 mootools、jQuery 等）的答案将是最有帮助的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-09T16:07:33.670

```
<table id="mytable">
    <tbody>
        <tr><td>Foo</td><td>Bar</td></tr>
        <tr><td>Bork</td><td>Bork</td></tr>

    </tbody>
</table>

<script type="text/javascript">

$$('#mytable tr').each(function(item) {
    item.observe('mouseover', function() {
        item.setStyle({ backgroundColor: '#ddd' });
    });
    item.observe('mouseout', function() {
        item.setStyle({backgroundColor: '#fff' });
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-09T16:07:00.973

您可以使用原型`addClassName`和`removeClassName`方法。

创建一个 CSS 类“hilight”，您将应用于 hilighted`<tr>`的。然后在页面加载时运行此代码：

```
var rows = $$('tbody tr');  
for (var i = 0; i < rows.length; i++) {  
    rows[i].onmouseover = function() { $(this).addClassName('hilight'); }  
    rows[i].onmouseout = function() { $(this).removeClassName('hilight'); }  
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-27T04:45:35.480

一点通用的解决方案：

假设我想要一种简单的方法来制作带有行的表格，当我将鼠标指针放在它们上面时会突出显示。在理想世界中，这将非常容易，只需一条简单的 CSS 规则：

```
tr:hover { background: red; } 
```

不幸的是，旧版本的 IE 不支持在 A 以外的元素上的 :hover 选择器。所以我们必须使用 JavaScript。

在这种情况下，我将定义一个表类“highlightable”来标记应该具有可悬停行的表。我将通过在表格行上添加和删除类“highlight”来进行背景切换。

**CSS**

```
table.highlightable tr.highlight { background: red; } 
```

**JavaScript（使用原型）**

```
// when document loads
document.observe( 'dom:loaded', function() {
    // find all rows in highlightable table
    $$( 'table.highlightable tr' ).each( function( row ) {
        // add/remove class "highlight" when mouse enters/leaves
        row.observe( 'mouseover', function( evt ) { evt.element().addClassName( 'highlight' ) } );
        row.observe( 'mouseout', function( evt ) { evt.element().removeClassName( 'highlight' ) } );
    } );
} ) 
```

**HTML**

您现在要做的就是将“highlightable”类添加到您想要的任何表中：

```
<table class="highlightable">
    ...
</table> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T16:19:13.393

我对[@swilliams](https://stackoverflow.com/questions/52238/how-can-i-highlight-a-table-row-using-prototype#52253)代码做了一点改动。

```
$$('#thetable tr:not(#headRow)').each( 
```

这让我有一个**没有**突出显示标题行的表格。

```
<tr id="headRow">
    <th>Header 1</th>
</tr> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T16:11:13.380

您可以对每一行执行一些操作，如下所示：

```
$('tableId').getElementsBySelector('tr').each(function (row) {
  ...
}); 
```

因此，在该函数的主体中，您可以访问“行”变量中的每一行，一次一行。然后您可以调用 Event.observe(row, ...)

所以，这样的事情可能会起作用：

```
$('tableId').getElementsBySelector('tr').each(function (row) {
  Event.observe(row, 'mouseover', function () {...do hightlight code...});
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-03T12:13:29.247

我为 Rows 背景找到了一个有趣的解决方案，鼠标悬停时突出显示的行，没有 JS。这是[链接](http://www.sopov.com/joomla-wordpress-tips-and-tricks/70-how-highlight-table-row-background.html)

适用于所有浏览器。对于 IE6/7/8 ...

```
tr{ position: relative; }
td{ background-image: none } 
```

对于 Safari，我为每个 TD 使用负背景位置。

# linux - 如何恢复或更改 Oracle sysdba 密码

> ID：52239
> 
> 赞同：15
> 
> 时间：2008-09-09T15:58:37.547
> 
> 标签：linux, oracle, login, passwords, sysdba

我们正在使用一个 oracle 数据库，其中设置它的人“早已不复存在”，因此不知道 sysdba 密码，但需要它。我们有这个盒子的 root 访问权限（它在 linux 上）。有没有办法恢复或更改系统密码？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-09T16:05:00.587

您是否尝试过以已安装的 Oracle 用户身份登录 Linux？

```
sqlplus "/ as sysdba" 
```

当您登录时，您将能够更改您的密码。

```
alter user sys identified by <new password>; 
```

祝你好运 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-18T06:42:17.727

您可以使用环境变量的组合在本地连接到数据库：

*   **ORACLE_HOME**
*   **ORACLE_SID**。

根据您的**操作系统**：

**Unix/Linux：**

```
export ORACLE_HOME=<oracle_home_directory_till_db_home>
export PATH=$PATH:$ORACLE_HOME/bin
export ORACLE_SID=<your_oracle_sid>
SQLPLUS / AS SYSDBA 
```

**视窗**

```
set ORACLE_HOME=<oracle_home_path_till_db_home>
set PATH=%PATH%||%ORACLE_HOME%\bin
set ORACLE_SID=<your_oracle_sid>
SQLPLUS / AS SYSDBA 
```

连接后，您可以**更改用户**以**修改密码**：

```
ALTER USER username IDENTIFIED BY password; 
```

# .net - 如何检查给定用户是否是内置管理员组的成员？

> ID：52256
> 
> 赞同：2
> 
> 时间：2008-09-09T16:09:23.043
> 
> 标签：.net, security

我需要以编程方式（在 .NET 中）检查给定用户（域帐户）是否是当前计算机（执行应用程序的计算机）上内置管理员组的成员。

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T16:13:38.867

我不了解.Net，但在win32 中，简单的方法是调用IsUserAnAdmin()。如果您需要更多控制权，您可以打开流程令牌并使用 CheckTokenMembership 检查您需要检查的每个组

**编辑：**请参阅[pinvoke.net](http://www.pinvoke.net/default.aspx/advapi32/CheckTokenMembership.html)以获取 .NET 示例代码（感谢 Chopeen）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T16:14:15.543

有一个 Win32 API 可以用于 P/Invoke：[IsUserAnAdmin](http://msdn.microsoft.com/en-us/library/bb776463(VS.85).aspx)

Vista 上的问题更为复杂……请参阅此[博客文章](http://blogs.msdn.com/cjacks/archive/2006/10/09/How-to-Determine-if-a-User-is-a-Member-of-the-Administrators-Group-with-UAC-Enabled-on-Windows-Vista.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T16:10:55.067

您可以像我在这个答案中所做的那样循环组：

[通过 C# 确定本地组的成员](https://stackoverflow.com/questions/45437/determining-members-of-local-groups-via-c#45458)

在阅读了更多内容之后，最简单的事情就是使用`System.DirectoryServices.AccountManagement`命名空间。以下是它的使用方法：

[http://www.leastprivilege.com/SystemDirectoryServicesAccountManagement.aspx](http://www.leastprivilege.com/SystemDirectoryServicesAccountManagement.aspx)

样本：

```
public static bool IsUserInGroup(string username, string groupname, ContextType type)
{
    PrincipalContext context = new PrincipalContext(type);

    UserPrincipal user = UserPrincipal.FindByIdentity(
        context,
        IdentityType.SamAccountName,
        username);
    GroupPrincipal group = GroupPrincipal.FindByIdentity(
        context, groupname);

    return user.IsMemberOf(group);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-21T20:41:30.003

如果您正在谈论当前正在运行的用户，那么

```
using System.Security.Principal;

WindowsIdentity identity = WindowsIdentity.GetCurrent();
WindowsPrincipal wp = new WindowsPrincipal(identity);

if (wp.IsInRole("BUILTIN\Administrators"))
   // Is Administrator
else
   // Is Not 
```

如果不是，那么我希望它可以为特定用户设置**身份**，但没有研究如何。

# powershell - 由于脚本而退出的 iTunes 警告消息

> ID：52286
> 
> 赞同：3
> 
> 时间：2008-09-09T16:27:56.070
> 
> 标签：powershell, itunes

在 PowersHell 中写了以下内容作为 iTunes 的快速演示：

```
$iTunes = New-Object -ComObject iTunes.Application
$LibrarySource = $iTunes.LibrarySource
foreach ($PList in $LibrarySource.Playlists)
{
  write-host $PList.name
} 
```

这很好用，可以拉回播放列表名称列表。但是在尝试关闭 iTunes 时会出现警告

> 一个或多个应用程序正在使用 iTunes 脚本接口。你确定你要退出吗？

显然，我可以忽略该消息并按 [退出] 或等待 20 秒左右，但是有没有一种干净的方法可以告诉 iTunes 我已经完成了它的工作？

```
Itunes 7.7.1, Windows XP 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T16:34:28.537

这是我在将播客添加到 iTunes 的 Powershell 脚本上所做的一件事。我在服务器上使用 Juice 下载我收听的所有播客。该脚本使用 .Net 方法来释放 COM 对象。当我编写我的 iTunes 脚本时，我已经阅读了几篇文章，这些文章指出您应该使用 .NET 发布您的 COM 对象。

```
 [void][System.Runtime.InteropServices.Marshal]::ReleaseComObject([System.__ComObject]$LibrarySource)
    [void][System.Runtime.InteropServices.Marshal]::ReleaseComObject([System.__ComObject]$iTunes) 
```

我也大部分时间从快捷方式运行我的脚本，而不是从 powershell 提示符。

根据您的评论，我进行了一些测试，并确定如果我以使 powershell 运行的方式运行我的脚本，我会在针对 iTunes 运行时收到该消息。iTunes 似乎会跟踪这一点。以在运行后退出其进程的方式运行脚本，消除了该消息。

从 powershell 运行脚本的一种方法是在脚本前面加上 powershell。

```
powershell .\scriptname.ps1
```

上面的命令将启动您的脚本，然后退出用于运行它的进程，但仍将您留在 powershell 提示符下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T13:13:39.930

您应该能够将 $itunes 设置为 $null。或者，$itunes 应该有一个可以调用的退出方法。$itunes.quit()

# project-management - 技术和功能规格模板

> ID：52290
> 
> 赞同：62
> 
> 时间：2008-09-09T16:28:27.520
> 
> 标签：project-management, specifications, specs

所以基本上我正在寻找好的模板来编写项目或工作请求的技术和功能规范。

你用什么？在编写规范时你能深入到什么程度？您可以提供的任何其他一般提示将不胜感激。

我的公司非常需要这些。我为承包商工作，现在我们根本不使用这些文件。

**编辑：**我读过 Joel 对[Painless Specification](http://www.joelonsoftware.com/articles/fog0000000036.html)的看法，我真的很喜欢它，但还有其他意见吗 :)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-09T18:00:49.780

关于一般提示；

我们正在实施一个流程

1) 业务需求声明 (BRS)

2) 功能规格

3) 技术规格

BRS 涵盖了业务问题，以及围绕解决方案、测试、安全性、可靠性和交付的要求。这定义了成功的解决方案。

功能规范详细说明了所需的内容、外观、字段长度等。

技术规范详细说明了数据的来源，可能需要考虑的任何棘手代码。

The customer owns the requirements. The developers own the tech specs, and the functional spec is a middle ground. Testing is done against the tech specs (usually unit testing) then against the functional specs (usually system testing) and then against the requirements (UAT).

The important part of this (and we are struggling with) is that the developers still need to deliver to the functional spec, and the original business requirements. In reality the functional and tech specs are just there for clarity.

In short, my main tip is to first work out the process you wish to implement. Then seek agreement from all parties involved in your proposed process, then work on the templates to fit. The templates themselves are only are a small part of the change you want to make.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-09T16:40:02.313

不是模板，但 Joel 写了[几篇](http://www.joelonsoftware.com/articles/fog0000000036.html)关于编写功能规范的文章。他这里也有[样品](http://www.joelonsoftware.com/articles/WhatTimeIsIt.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-09T16:39:31.393

你可以从 ieee 和其他地方购买模板，但我总是自己制作。

对于技术规范，Steve McDonnell 的“ [Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670) ”有一个很好的清单，您可以从中获取一些信息。在我的上一份工作中，我只是从他的部分标题中制作了一个模板，并从那里进行了调整。

就功能规范而言，重要的是定义所有接口：

1.  UI（屏幕模型）
2.  软件接口（插件等）
3.  硬件接口（如果适用）
4.  通信接口（服务、电子邮件、消息传递等）

还应该有一个业务规则部分，即在任何接口定义中都没有涵盖的重要功能。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-09T16:29:57.127

如果您想购买一本书，[Karl Wiegers 的 Software Requirements](https://rads.stackoverflow.com/amzn/click/com/0735618798)提供了一些文档的模板作为附录。不幸的是，我在工作，那本书在家里。如果有人方便的话，他们也许可以确认这一点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-09T16:56:30.527

我碰巧喜欢这个，其中包括：[ReadySet](http://readyset.tigris.org/)。

他也卖专业版。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-08-24T15:39:39.360

This is the best one I have found: [http://www.jiludwig.com/templates/FRDTemplate.doc](http://www.jiludwig.com/templates/FRDTemplate.doc)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-09T17:40:39.203

从简单开始，然后按照自己的方式工作。由于这是您第一次使用此功能，因此请使用带有项目符号的 word 文档。写下来，再读一遍，并提供足够的细节，让它有意义。对于技术规范，您可能希望引导开发人员找到解决方案，但对于功能规范，“如何”应该完全缺失。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-09T17:45:16.277

我建议在[这里](http://www.volere.co.uk/index.htm)查看 Roberston 的 Volere 模板。他们是大西洋系统协会的一部分，与 Tom DeMarco 和“Peopleware”成名的 Timothy Lister 等人一起。

由于模板是受版权保护的，我不会在这里复制它，但给你一些主要的标题：

1.  项目目的
2.  利益相关者
3.  强制约束
4.  命名约定和术语
5.  相关事实和假设
6.  工作范围
7.  业务数据模型和数据字典
8.  产品范围
9.  功能要求
10.  外观和感觉要求...

还有更多，但这应该给你一个想法。模板中最有趣的部分是需求外壳，它列出了一种提示卡上的功能需求。再次受版权保护，但真正有价值。

请看第 9 章[。](http://www.volere.co.uk/template.htm)

# asp.net - 通过 HttpModule 确定页面大小

> ID：52311
> 
> 赞同：4
> 
> 时间：2008-09-09T16:35:15.833
> 
> 标签：asp.net

这是一个简单的方法：

我目前正在通过 HttpModule 记录请求持续时间，我也想找出每个页面的字节数。

`HttpContext.Current.Response.OutputStream.Length`抛出一个`NotSupportedException`.

有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T17:07:47.830

我有一个实现流重写器的 HttpModule。它派生自 Stream 类。在我的 HttpModule 中，我有以下代码：

```
void app_PreRequestHandlerExecute(object sender, EventArgs e)
{
    HttpResponse response = HttpContext.Current.Response;
    response.Filter = new MyRewriterStream(response.Filter);
} 
```

在流类中，我有以下代码覆盖了默认的 Write 方法：

```
public override void Write(byte[] buffer, int offset, int count)
{
     string outStr;
     outStr = UTF8Encoding.UTF8.GetString(buffer, offset, count);
     //Do useful stuff and write back to the stream
} 
```

您可以在第二点取字符串的长度

# c# - C# 中 try/catch 的真正开销是什么？

> ID：52312
> 
> 赞同：97
> 
> 时间：2008-09-09T16:36:09.327
> 
> 标签：c#, .net, performance, optimization, try-catch

所以，我知道 try/catch 确实增加了一些开销，因此不是控制流程的好方法，但是这个开销来自哪里，它的实际影响是什么？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-09-09T17:19:01.173

这里要说明三点：

*   首先，在代码中实际使用 try-catch 块几乎没有或没有性能损失。当试图避免将它们包含在您的应用程序中时，这不应该是一个考虑因素。只有在抛出异常时才会对性能造成影响。

*   当除了其他人提到的堆栈展开操作等之外引发异常时，您应该知道会发生一大堆与运行时/反射相关的事情，以便填充异常类的成员，例如堆栈跟踪对象和各种类型的成员等。

*   我相信这就是为什么如果你要重新抛出异常的一般建议是只是`throw;`而不是再次抛出异常或构造一个新异常，因为在这些情况下，所有堆栈信息都被重新收集，而在简单的扔掉它全部保存下来。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-09-09T16:41:10.657

我不是语言实现方面的专家（所以对此持保留态度），但我认为最大的成本之一是展开堆栈并将其存储为堆栈跟踪。我怀疑这只发生在抛出异常时（但我不知道），如果是这样，每次抛出异常时这将是相当大的隐藏成本......所以这不像你只是从一个地方跳下来在另一个代码中，发生了很多事情。

只要您对异常行为使用异常（因此不是您通过程序的典型预期路径），我认为这不是问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-20T14:59:38.537

您是在询问未引发异常时使用 try/catch/finally 的开销，还是使用异常控制流程流的开销？后者有点类似于使用炸药棒点燃幼儿的生日蜡烛，相关的开销分为以下几个方面：

*   由于抛出的异常访问通常不在缓存中的常驻数据，您可能会遇到额外的缓存未命中。
*   由于抛出的异常访问应用程序工作集中不正常的非常驻代码和数据，您可能会遇到额外的页面错误。

    *   例如，抛出异常将需要 CLR 根据当前 IP 和每帧的返回 IP 找到 finally 和 catch 块的位置，直到处理异常加上过滤块。
    *   额外的构建成本和名称解析，以便创建用于诊断目的的帧，包括读取元数据等。
    *   上述两项通常都访问“冷”代码和数据，因此如果您有内存压力，则可能会出现硬页面错误：

        *   CLR 试图将不经常使用的代码和数据远离经常用于改善局部性的数据，因此这对您不利，因为您正在迫使冷变热。
        *   硬页错误的代价（如果有的话）将使其他一切相形见绌。
*   典型的捕获情况通常很深，因此上述影响往往会被放大（增加页面错误的可能性）。

至于成本的实际影响，这可能会因当时代码中发生的其他情况而有很大差异。Jon Skeet 在[这里有一个很好的总结](https://jonskeet.uk/csharp/exceptions2.html)，有一些有用的链接。我倾向于同意他的说法，即如果您遇到异常严重损害您的性能的地步，那么您在使用异常方面会遇到问题，而不仅仅是性能。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-09T16:48:49.763

以我的经验，最大的开销是实际抛出异常并处理它。我曾经参与过一个项目，其中使用类似于以下的代码来检查是否有人有权编辑某些对象。这个 HasRight() 方法在表示层的任何地方都使用过，并且经常为 100 多个对象调用。

```
bool HasRight(string rightName, DomainObject obj) {
  try {
    CheckRight(rightName, obj);
    return true;
  }
  catch (Exception ex) {
    return false;
  }
}

void CheckRight(string rightName, DomainObject obj) {
  if (!_user.Rights.Contains(rightName))
    throw new Exception();
} 
```

当测试数据库充满测试数据时，这会导致在打开新表单等时出现非常明显的减速。

所以我将它重构为以下内容，根据后来的快速“n脏测量”，它快了大约 2 个数量级：

```
bool HasRight(string rightName, DomainObject obj) {
  return _user.Rights.Contains(rightName);
}

void CheckRight(string rightName, DomainObject obj) {
  if (!HasRight(rightName, obj))
    throw new Exception();
} 
```

所以简而言之，在正常流程中使用异常比在没有异常的情况下使用类似流程要慢两个数量级。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-08-15T20:50:57.627

与普遍接受的理论相反，`try`/`catch`可能会对性能产生重大影响，这就是是否引发异常！

1.  **它禁用了一些自动优化（按设计）**，并且在某些情况下会注入*调试*代码，正如您可以从*调试辅助*工具中所期望的那样。在这一点上总会有人不同意我的观点，但是语言需要它并且反汇编显示它，所以这些人在字典定义中是[妄想](https://www.google.com/search?q=define%3A+delusional)的。
2.  **它会对维护产生负面影响。**这实际上是这里最重要的问题，但是由于我的最后一个答案（几乎完全集中在它上）被删除了，我将尝试关注不太重要的问题（微优化）而不是更重要的问题（宏观优化）。

* * *

多年来，Microsoft MVP 已在几篇博客文章中介绍了前者，我相信您可以轻松找到它们，但 StackOverflow 非常关心*内容*，*因此*我将提供其中一些链接作为~~补充~~证据：

*   [**`try`/ `catch`/`finally`**](https://blogs.msmvps.com/peterritchie/2007/06/22/performance-implications-of-try-catch-finally/)（[和第二部分）](https://blogs.msmvps.com/peterritchie/2007/07/12/performance-implications-of-try-catch-finally-part-two/)[**的性能影响**](https://blogs.msmvps.com/peterritchie/2007/06/22/performance-implications-of-try-catch-finally/)，作者 Peter Ritchie 探讨了`try`/`catch`/`finally`禁用的优化（我将通过引用标准进一步探讨）
*   [**Ian Huff 的Performance Profiling `Parse`vs. `TryParse`vs.`ConvertTo`**](https://blogs.msdn.microsoft.com/ianhu/2005/12/19/performance-profiling-parse-vs-tryparse-vs-convertto/)公然指出“异常处理非常缓慢”，并通过相互对抗来证明这一点`Int.Parse`......`Int.TryParse`对于任何坚持在幕后`TryParse`使用`try`/`catch`

还有[这个答案](https://stackoverflow.com/a/1352364/1989425)`try`显示了使用和不使用/的反汇编代码之间的区别`catch`。

似乎很明显，在代码生成中存在明显可见*的*开销，而且这种开销甚至似乎被微软重视的人所承认！然而我是，*重复互联网*......

是的，一行微不足道的代码有几十个额外的 MSIL 指令，这甚至不包括禁用的优化，所以从技术上讲，它是一种微优化。

* * *

几年前我发布了一个答案，因为它关注程序员的生产力（宏观优化）而被删除。

这是不幸的，因为没有节省几纳秒的 CPU 时间可能会弥补人类手动优化的许多累积小时。你的老板为哪一个付出更多：你的一个小时，还是电脑运行的一个小时？我们在什么时候拔掉插头并承认是时候*买一台更快的电脑了*？

显然，我们应该*优化我们的优先级*，而不仅仅是我们的代码！在我的最后一个答案中，我利用了两个代码片段之间的差异。

使用`try`/ `catch`：

```
int x;
try {
    x = int.Parse("1234");
}
catch {
    return;
}
// some more code here... 
```

不使用`try`/ `catch`：

```
int x;
if (int.TryParse("1234", out x) == false) {
    return;
}
// some more code here 
```

从维护开发人员的角度考虑，这更有可能浪费您的时间，如果不是在分析/优化（如上所述）中，如果不是因为`try`/`catch`问题，这可能甚至没有必要，然后滚动浏览源代码...其中之一有四行额外的样板垃圾！

随着越来越多的字段被引入到一个类中，所有这些样板垃圾都会累积（在源代码和反汇编代码中）远远超出合理水平。每个字段有四个额外的行，它们总是相同的行......我们没有被教导避免重复自己吗？我想我们可以将`try`/隐藏`catch`在一些自制的抽象后面，但是......那么我们不妨避免异常（即使用`Int.TryParse`）。

这甚至不是一个复杂的例子。我已经看到尝试在`try`/中实例化新类`catch`。考虑到构造函数内的所有代码可能会被取消某些优化的资格，否则这些优化将由编译器自动应用。有什么更好的方法来提出*编译器很慢*的理论，而不是*编译器正在做它被告知要做的事情*？

假设上述构造函数抛出异常，并因此触发了一些错误，那么糟糕的维护开发人员必须跟踪它。这可能不是一件容易的事，因为与*goto*噩梦的意大利面条代码不同，`try`/`catch`可能会导致*三维*混乱，因为它不仅可以将堆栈向上移动到同一方法的其他部分，还可以移动到其他类和方法，所有这些都将被维护开发人员观察到，*艰难的方式*！然而我们被告知“goto很危险”，呵呵！

最后我提到，`try`/`catch`有它的好处，*它旨在禁用优化*！如果您愿意，它是*调试辅助工具*！这就是它的设计目的，它应该被用作......

> 我想这也是一个积极的观点。它可用于禁用优化，否则可能会削弱多线程应用程序的安全、健全的消息传递算法，并捕获可能的竞争条件；）这是我能想到的使用 try/catch 的唯一场景。即便如此，也有其他选择。

* * *

**`try`做了哪些优化`catch`和`finally`禁用？**

又名

**作为调试辅助工具有什么`try`用处？`catch``finally`**

它们是写屏障。这来自标准：

12.3.3.13 Try-catch 语句

> 对于以下形式的语句*stmt*：
> 
> ```
> try try-block
> catch ( ... ) catch-block-1
> ... 
> catch ( ... ) catch-block-n 
> ```
> 
> *   *v在**try-block*开头的确定赋值状态与*v在**stmt*开头的确定赋值状态相同。
> *   *在catch-block-i*开头的*v*的明确赋值状态（对于任何*i ）与在**stmt*开头的*v*的明确赋值状态相同。
> ****   *当（*且仅当）*v*在 try-block 的端点和*每个**catch* - block *-i*（对于从 1 到*n的每个**i*）。***

 ***换句话说，在每个`try`语句的开头：

*   在进入语句之前对可见对象所做的所有分配都`try`必须完成，这需要一个线程锁才能开始，这对于调试竞争条件很有用！
*   编译器不允许：
    *   `try`消除在语句之前已经明确分配的未使用的变量分配
    *   重组或合并它的任何*内部任务*（即，如果您还没有这样做，请参阅我的第一个链接）。
    *   在这个障碍上提升分配，延迟分配到它知道以后不会使用的变量（如果有的话），或者先发制人地向前移动以后的分配以使其他优化成为可能......

每个`catch`陈述都有一个类似的故事；假设在您的`try`语句（或它调用的构造函数或函数等）中，您分配给那个原本毫无意义的变量（比如说，*`garbage=42;`*），编译器无法消除该语句，无论它与程序的可观察行为多么无关. 分配需要在进入块之前*完成。*`catch`

对于它的价值，`finally`讲述了一个类似的*有辱人格*的故事：

12.3.3.14 Try-finally 语句

> 对于以下形式的*try*语句*stmt*：
> 
> ```
> try try-block
> finally finally-block 
> ```
> 
> • *v在**try-block* 开头的确定赋值状态与*v在**stmt*开头的确定赋值状态相同。
> • *finally-block*开头的*v的确定赋值状态与**stmt*开头的*v*的确定赋值状态相同。 •在*stmt*的端点处 v*的明确**赋值状态当**（*且仅当）以下任一情况下是绝对赋值的*：* *********绝对分配在finally-block*的终点 如果进行的控制流转移（例如*goto*语句）从 try-block 开始，并在*try-block**之外*结束，那么*v*也被认为是绝对分配的如果*v在**finally-block*的终点明确分配，则控制流转移。（这不是唯一的，如果*v*在此控制流传输中出于其他原因被明确分配，那么它仍然被认为是明确分配的。）********

 **12.3.3.15 Try-catch-finally 语句

> *形式的try* - *catch* - *finally*语句的确定赋值分析：
> 
> ```
> try try-block
> catch ( ... ) catch-block-1
> ... 
> catch ( ... ) catch-block-n
> finally finally-block 
> ```
> 
> 就像语句是包含*try* - *catch语句的**try* - *finally*语句一样完成：
> 
>  **```
> try { 
>     try   
>     try-block
>     catch ( ... ) catch-block-1
>     ...   
>     catch ( ... ) catch-block-n
> } 
> finally finally-block 
> ```**

 *** * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-12T18:06:28.150

更不用说它是否在经常调用的方法中，它可能会影响应用程序的整体行为。
例如，我认为在大多数情况下使用 Int32.Parse 是一种不好的做法，因为它会抛出异常，否则很容易被捕获。

所以总结一下这里写的所有内容：
1）使用 try..catch 块来捕获意外错误 - 几乎没有性能损失。
2）如果可以避免，请不要对异常错误使用异常。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T00:17:35.927

前段时间我写了一篇关于这个的文章，因为当时有很多人问这个问题。[您可以在http://www.blackwasp.co.uk/SpeedTestTryCatch.aspx](http://www.blackwasp.co.uk/SpeedTestTryCatch.aspx)找到它和测试代码。

结果是 try/catch 块的开销很小，但太小了，应该被忽略。但是，如果您在循环中运行数百万次的 try/catch 块，则可能需要考虑将块移到循环之外。

try/catch 块的关键性能问题是当您实际捕获异常时。这会给您的应用程序增加明显的延迟。当然，当事情出错时，大多数开发人员（以及许多用户）都将暂停视为即将发生的异常！这里的关键是不要对正常操作使用异常处理。顾名思义，它们是特殊的，您应该尽一切可能避免它们被抛出。您不应将它们用作正常运行的程序的预期流程的一部分。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-09T17:06:47.303

去年我写了一篇关于这个主题的[博客文章。](http://freachable.net/2007/11/10/TryAssertTryBlocksExpensiveCatchExceptionExAssumptionreset.aspx)看看这个。底线是，如果没有发生异常，尝试块几乎没有成本 - 在我的笔记本电脑上，异常大约是 36μs。这可能比您预期的要少，但请记住，这些结果在浅堆栈上。此外，第一个例外真的很慢。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-22T21:06:16.847

编写、调试和维护没有编译器错误消息、代码分析警告消息和例行接受的异常（尤其是在一个地方抛出并在另一个地方接受的异常）的代码要容易得多。因为它更容易，所以代码平均会写得更好，错误更少。

对我来说，程序员和质量开销是反对使用 try-catch 处理流程的主要论据。

相比之下，异常的计算机开销微不足道，就应用程序满足实际性能要求的能力而言，通常微不足道。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T04:50:54.007

我真的很喜欢 Hafthor 的[博客文章](http://freachable.net/2007/11/10/TryAssertTryBlocksExpensiveCatchExceptionExAssumptionreset.aspx)，并且为了在这个讨论中添加我的两分钱，我想说的是，让数据层只抛出一种类型的异常 (DataAccessException) 对我来说总是很容易的。这样我的业务层就知道会发生什么异常并捕获它。然后根据进一步的业务规则（即，如果我的业务对象参与工作流等），我可能会抛出一个新异常（BusinessObjectException）或继续进行而不重新/抛出。

我想说不要犹豫，在必要时使用 try..catch 并明智地使用它！

例如，此方法参与工作流...

评论？

```
public bool DeleteGallery(int id)
{
    try
    {
        using (var transaction = new DbTransactionManager())
        {
            try
            {
                transaction.BeginTransaction();

                _galleryRepository.DeleteGallery(id, transaction);
                _galleryRepository.DeletePictures(id, transaction);

                FileManager.DeleteAll(id);

                transaction.Commit();
            }
            catch (DataAccessException ex)
            {
                Logger.Log(ex);
                transaction.Rollback();                        
                throw new BusinessObjectException("Cannot delete gallery. Ensure business rules and try again.", ex);
            }
        }
    }
    catch (DbTransactionException ex)
    {
        Logger.Log(ex);
        throw new BusinessObjectException("Cannot delete gallery.", ex);
    }
    return true;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-17T12:38:33.407

我们可以在 Michael L. Scott 的 Programming Languages Pragmatics 中读到，现在的编译器在常见情况下不会增加任何开销，这意味着当没有异常发生时。所以每一项工作都是在编译时完成的。但是当在运行时抛出异常时，编译器需要执行二进制搜索以找到正确的异常，并且这将发生在您所做的每一次新的抛出中。

但是例外就是例外，这个成本是完全可以接受的。如果您尝试在没有异常的情况下进行异常处理并改用返回错误代码，则可能您需要为每个子例程添加一个 if 语句，这将产生真正的实时开销。您知道 if 语句被转换为一些汇编指令，每次您进入子例程时都会执行这些指令。

对不起我的英语，希望它对你有帮助。此信息基于引用的书籍，有关详细信息，请参阅第 8.5 章异常处理。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2010-05-04T13:44:00.313

让我们分析一下在不需要使用它时使用 try/catch 块的最大可能成本之一：

```
int x;
try {
    x = int.Parse("1234");
}
catch {
    return;
}
// some more code here... 
```

这是没有 try/catch 的：

```
int x;
if (int.TryParse("1234", out x) == false) {
    return;
}
// some more code here 
```

不算微不足道的空白，人们可能会注意到这两个等效的代码段几乎完全相同的字节长度。后者包含少 4 个字节的缩进。那是一件坏事？

为了雪上加霜，一个学生决定循环，而输入可以被解析为一个 int。没有 try/catch 的解决方案可能类似于：

```
while (int.TryParse(...))
{
    ...
} 
```

但是当使用 try/catch 时，这看起来如何呢？

```
try {
    for (;;)
    {
        x = int.Parse(...);
        ...
    }
}
catch
{
    ...
} 
```

Try/catch 块是浪费缩进的神奇方式，我们甚至不知道它失败的原因！想象一下调试人员的感受，当代码继续执行超过一个严重的逻辑缺陷，而不是因为一个很好的明显异常错误而停止时。Try/catch 块是懒人的数据验证/清理。

较小的成本之一是 try/catch 块确实禁用了某些优化： http: [//msmvps.com/blogs/peterritchie/archive/2007/06/22/performance-implications-of-try-catch-finally.aspx](http://msmvps.com/blogs/peterritchie/archive/2007/06/22/performance-implications-of-try-catch-finally.aspx) . 我想这也是一个积极的观点。它可用于禁用优化，否则可能会削弱多线程应用程序的安全、健全的消息传递算法，并捕获可能的竞争条件；）这是我能想到的唯一使用 try/catch 的场景。即便如此，也有其他选择。

# c# - C# switch：case 没有落入其他 case 限制

> ID：52313
> 
> 赞同：5
> 
> 时间：2008-09-09T16:36:18.517
> 
> 标签：c#, switch-statement

这个问题是这个问题的附加[问题](https://stackoverflow.com/questions/44905/c-switch-statement-limitations-why)

在 C# 中，一个 switch case 不能落入其他 case，这会导致编译错误。在这种情况下，我只是在所选月份以及之后的每个月份的月份总数中添加一些数字。（简单的例子，并不意味着是真实的）

```
switch (month)
{
    case 0:
      add something to month totals
    case 1:
      add something to month totals
    case 2:
      add something to month totals
    default:
      break;
} 
```

在 C# 中是否有一个逻辑替代方案，而不必写出大量的 if 语句？

```
if (month <= 0)
   add something to month
if (month <= 1)
   add something to month
if (month <= 2)
   add something to month
.... etc 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-09T16:40:09.113

很多时候，当你看到一个巨大的 switch 语句或许多可能落入多个块的 if 语句的噪音时，你是在试图压制一个糟糕的设计。

相反，如果您实现规范模式以查看是否匹配，然后采取行动呢？

```
foreach(MonthSpecification spec in this.MonthSpecifications)
{
   if(spec.IsSatisfiedBy(month))
       spec.Perform(month);
} 
```

然后您可以添加与您尝试执行的操作相匹配的不同规格。

很难说出你的域是什么，所以我的例子可能有点做作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-09T17:18:43.187

在 C# switch 语句中，只有当没有您想要通过的案例的语句时，您才能通过案例

```
switch(myVar)
{
   case 1:
   case 2: // Case 1 or 2 get here
      break;
} 
```

但是，如果你想通过一个声明，你必须使用可怕的 GOTO

```
switch(myVar)
    {
       case 1: // Case 1 statement
               goto case 2;
       case 2: // Case 1 or 2 get here
          break;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T16:37:24.083

已经有一个问题解决了这个主题：

[C# switch 语句限制 - 为什么？](https://stackoverflow.com/questions/44905/c-switch-statement-limitations-why)

编辑：

绅士们，我指出这一点的主要目的是，两个名称几乎相同的问题给问题池增加了混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T16:42:42.573

你在添加常量吗？如果是这样，也许这样的事情会起作用（C语法）：

```
const int addToTotals[] = {123, 456, ..., 789};

for(i=month;i<12;i++)
   totals += addToTotals[i]; 
```

如果您需要更复杂的语句而不是在接下来的每个月的总计中添加常量，您可以使用变量或函数指针执行类似的操作。

-亚当

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-01T23:45:41.977

以相反的顺序编写开关案例

```
case 2:

case 1:

case 0:

break;

default: 
```

希望有帮助！

# sql - T-SQL 修剪（和其他非字母数字字符）

> ID：52315
> 
> 赞同：7
> 
> 时间：2008-09-09T16:39:17.290
> 
> 标签：sql, sql-server

我们有一些输入数据，有时会在末尾出现   字符。

数据来自源系统作为 varchar() 并且我们尝试转换为十进制失败 b/c 这些字符。

Ltrim 和 Rtrim 不删除字符，所以我们被迫做类似的事情：

```
UPDATE myTable
SET myColumn = replace(myColumn,char(160),'')
WHERE charindex(char(160),myColumn) > 0 
```

这适用于  ，但是对于任何非字母数字（或在这种情况下为数字）字符，是否有一种好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-18T18:02:01.200

这将删除所有非字母数字字符

```
CREATE FUNCTION [dbo].[fnRemoveBadCharacter]
(
    @BadString nvarchar(20)
)
RETURNS nvarchar(20)
AS
BEGIN

            DECLARE @nPos INTEGER
            SELECT @nPos = PATINDEX('%[^a-zA-Z0-9_]%', @BadString)

            WHILE @nPos > 0
            BEGIN
                        SELECT @BadString = STUFF(@BadString, @nPos, 1, '')
                        SELECT @nPos = PATINDEX('%[^a-zA-Z0-9_]%', @BadString)
            END

            RETURN @BadString
END 
```

使用如下功能：

```
UPDATE TableToUpdate
SET ColumnToUpdate = dbo.fnRemoveBadCharacter(ColumnToUpdate)
WHERE whatever 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-09T16:46:56.960

[此页面](http://www.lazydba.com/sql/1__4390.html)包含如何删除非字母数字字符的示例：

```
-- Put something like this into a user function:
DECLARE @cString    VARCHAR(32)
DECLARE @nPos    INTEGER
SELECT  @cString = '90$%45623 *6%}~:@'
SELECT  @nPos = PATINDEX('%[^0-9]%', @cString)

WHILE @nPos > 0
BEGIN
SELECT @cString = STUFF(@cString, @nPos, 1, '')
SELECT  @nPos = PATINDEX('%[^0-9]%', @cString)
END

SELECT @cString 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T17:03:35.907

表格是如何填充的？虽然可以在 sql 中清理它，但更好的方法是将列类型更改为 int 并在数据加载到数据库 (SSIS) 之前清理数据。这是一个选项吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-10T17:47:13.983

对于大型数据集，我对这个检查 ASCII 值的函数有更好的运气。我添加了基于参数仅保留字母、数字或字母数字的选项。

```
--CleanType 1 - Remove all non alpanumeric
--          2 - Remove only alpha
--          3 - Remove only numeric
CREATE FUNCTION [dbo].[fnCleanString] (
        @InputString    varchar(8000)
    ,   @CleanType      int 
    ,   @LeaveSpaces    bit 
)   RETURNS varchar(8000)
AS 
BEGIN

    -- // Declare variables
    -- ===========================================================
    DECLARE @Length     int
        ,   @CurLength  int = 1
        ,   @ReturnString varchar(8000)=''

    SELECT @Length = len(@InputString)

    -- // Begin looping through each char checking ASCII value
    -- ===========================================================
    WHILE (@CurLength <= (@Length+1))
    BEGIN
        IF  (ASCII(SUBSTRING(@InputString,@CurLength,1)) between 48 and 57      AND @CleanType in (1,3) )
        or  (ASCII(SUBSTRING(@InputString,@CurLength,1))    between 65 and 90   AND @CleanType in (1,2) )
        or  (ASCII(SUBSTRING(@InputString,@CurLength,1))    between 97 and 122  AND @CleanType in (1,2) )
        or  (ASCII(SUBSTRING(@InputString,@CurLength,1))    = 32    AND @LeaveSpaces = 1 )
        BEGIN
            SET @ReturnString = @ReturnString + SUBSTRING(@InputString,@CurLength,1)
        END
        SET @CurLength = @CurLength + 1
    END

    RETURN  @ReturnString
END 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-09T12:40:09.893

如果手机可以以加号（+）开头，我将使用这样的功能

```
CREATE FUNCTION [dbo].[Mobile_NoAlpha](@Mobile VARCHAR(1000)) 
RETURNS VARCHAR(1000) 
AS 
BEGIN
    DECLARE @StartsWithPlus BIT = 0

    --check if the mobile starts with a plus(+)
    IF LEFT(@Mobile, 1) = '+'
    BEGIN
        SET @StartsWithPlus = 1

        --Take out the plus before using the regex to eliminate invalid characters
        SET @Mobile = RIGHT(@Mobile, LEN(@Mobile)-1) 
    END

    WHILE PatIndex('%[^0-9]%', @Mobile) > 0 
        SET @Mobile = Stuff(@Mobile, PatIndex('%[^0-9]%', @Mobile), 1, '')  

    IF @StartsWithPlus = 1
        SET @Mobile = '+' + @Mobile
    RETURN @Mobile 
END 
```

# visual-studio - Tablet PC SDK (1.7) Merge Module + VS2008 + Windows Vista？

> ID：52319
> 
> 赞同：1
> 
> 时间：2008-09-09T16:40:16.697
> 
> 标签：visual-studio, windows-vista, windows-xp, sdk, tablet-pc

我有一个 VS2005 部署和设置项目，它使用 Tablet PC SDK 1.7 合并模块，因此 Windows XP 的用户可以使用托管的 Microsoft.Ink.DLL 库。现在我们已经转移到Vista/VS2008，我还需要安装TPC SDK（来获取合并模块）还是可以使用Vista的东西？

谷歌似乎被模糊的引用所困扰。如果我为 SDK 1.7 添加合并模块，这将如何影响当前的 Vista 用户（将内置 Tablet PC 功能）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-11T05:18:08.597

像往常一样，平板电脑开发最棘手的方面之一是部署：

*   [平板电脑功能没有内置在](http://en.wikipedia.org/wiki/Tablet_PC#Microsoft)Vista 的 Home Basic 或 Starter 版本中，因此如果您希望您的程序在这些功能上工作，您仍然需要 MSM。
*   在支持平板电脑的 Vista 版本上使用合并模块应该没问题。我的意思是，这相当于将 MSM 安装到已有组件的现有 XP 平板电脑上。如果它已经存在，它将不会添加它。
*   XP 2005 平板电脑包括 TPC 1.7。这些也安装在支持平板电脑的 Vista 版本上。如果您坚持使用这些核心功能，那么在任何地方都安装主要的 1.7 MSM 可能很酷。但是，Vista 还添加了[新的墨迹分析功能、一些手写笔输入 API](http://msdn.microsoft.com/en-us/library/ms699525(VS.85).aspx)和[新的 InkCanvas 控件](http://en.wikipedia.org/wiki/Windows_Flip_3D#Other_mobility_enhancements)，因此，如果您需要其中任何一个，如果您希望一切都在 XP 2005 上仍能正常工作，[是否需要安装额外的合并模块。](http://msdn.microsoft.com/en-us/library/ms701189(VS.85).aspx)

所以底线，如果你关心 XP 和/或 Home Basic Vista，你仍然需要处理合并模块......东西应该仍然可以在 Vista 上运行。如果您只是针对 Vista 的高级版本，则不再需要它们。

# .net - 在 Visual Studio 2005 中将旧代码从 System.Web.Mail 更新到 System.Net.Mail：发送电子邮件时出现问题

> ID：52321
> 
> 赞同：5
> 
> 时间：2008-09-09T16:41:00.923
> 
> 标签：.net, vb.net, email, visual-studio-2005, .net-2.0

使用过时的 System.Web.Mail 发送电子邮件可以正常工作，代码片段如下：

```
 Public Shared Sub send(ByVal recipent As String, ByVal from As String, ByVal subject As String, ByVal body As String)
        Try
            Dim Message As System.Web.Mail.MailMessage = New System.Web.Mail.MailMessage
            Message.To = recipent
            Message.From = from
            Message.Subject = subject
            Message.Body = body
            Message.BodyFormat = MailFormat.Html
            Try
                SmtpMail.SmtpServer = MAIL_SERVER
                SmtpMail.Send(Message)
            Catch ehttp As System.Web.HttpException
                critical_error("Email sending failed, reason: " + ehttp.ToString)
            End Try
        Catch e As System.Exception
            critical_error(e, "send() in Util_Email")
        End Try
    End Sub 
```

这是更新的版本：

```
Dim mailMessage As New System.Net.Mail.MailMessage()

        mailMessage.From = New System.Net.Mail.MailAddress(from)
        mailMessage.To.Add(New System.Net.Mail.MailAddress(recipent))

        mailMessage.Subject = subject
        mailMessage.Body = body

        mailMessage.IsBodyHtml = True
        mailMessage.Priority = System.Net.Mail.MailPriority.Normal

        Try

            Dim smtp As New Net.Mail.SmtpClient(MAIL_SERVER)
            smtp.Send(mailMessage)

        Catch ex As Exception

            MsgBox(ex.ToString)

        End Try 
```

我尝试了许多不同的变体，但似乎没有任何效果，我感觉它可能与 SmtpClient 有关，这些版本之间的底层代码是否发生了变化？

没有被抛出的异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T17:14:22.217

System.Net.Mail 库使用配置文件来存储设置，因此您可能只需要添加这样的部分

```
 <system.net>
    <mailSettings>
      <smtp from="test@foo.com">
        <network host="smtpserver1" port="25" userName="username" password="secret" defaultCredentials="true" />
      </smtp>
    </mailSettings>
  </system.net> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T17:10:26.437

您是否尝试过添加

```
smtp.UseDefaultCredentials = True 
```

在发送之前？

此外，如果您尝试更改会发生什么：

```
mailMessage.From = New System.Net.Mail.MailAddress(from)
mailMessage.To.Add(New System.Net.Mail.MailAddress(recipent)) 
```

对此：

```
mailMessage.From = New System.Net.Mail.MailAddress(from,recipent) 
```

——凯文·费尔柴尔德

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T17:13:46.583

我已经测试了您的代码，并且我的邮件已成功发送。假设您对旧代码使用相同的参数，我建议您的邮件服务器 (MAIL_SERVER) 正在接受该消息并且处理有延迟，或者它认为它是垃圾邮件并丢弃它。

我建议使用第三种方式发送消息（如果您感到勇敢，请使用 telnet），看看是否成功。

编辑：我注意到（从您随后的回答中）指定端口有所帮助。您还没有说您使用的是端口 25（SMTP）还是端口 587（提交）或其他。如果您还没有这样做，使用 sumission 端口也可能有助于解决您的问题。

[维基百科](http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)和[rfc4409](https://www.rfc-editor.org/rfc/rfc4409)有更多细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T17:13:59.923

您是否正在设置电子邮件的凭据？

```
smtp.Credentials = New Net.NetworkCredential("xyz@gmail.com", "password") 
```

我有这个错误，但我相信它引发了异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T17:23:36.640

你所做的一切都是正确的。这是我要检查的东西。

1.  仔细检查 IIS 中的 SMTP 服务是否正常运行。
2.  确保它没有被标记为垃圾邮件。

每当我们在发送电子邮件时遇到问题时，这些通常是最大的罪魁祸首。

另外，刚刚注意到你正在做 MsgBox(ex.Message)。我相信他们阻止 MessageBox 在服务包中工作 asp.net，所以它可能会出错，你可能不知道。检查您的事件日志。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-09T17:35:28.793

我添加了邮件服务器的端口号，它开始偶尔工作，这似乎是服务器的问题和发送消息的延迟。感谢您的回答，他们都很有帮助！

# xml - 如何使用 Visual Studio 2005 根据架构验证 XML 文件

> ID：52326
> 
> 赞同：3
> 
> 时间：2008-09-09T16:45:06.810
> 
> 标签：xml, visual-studio, xslt, visual-studio-2005

是否可以使用 Visual Studio 2005 IDE 针对其关联架构验证 xml 文件？

我只能看到基于当前文件创建模式的选项，或者显示 XSLT 输出

![替代文字](https://i.stack.imgur.com/x9mHo.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T16:52:33.233

它是自动完成的，错误在“错误列表”中显示为警告，并在源文件中用蓝色曲线加下划线。

不确定是否有另一种方法来验证文件，但现在可以这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T17:17:00.167

[XmlSchemaValidator](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemavalidator.aspx)

警告：使用起来并不美观。

# java - 是什么导致了 JVMTI_ERROR_NULL_POINTER？

> ID：52343
> 
> 赞同：2
> 
> 时间：2008-09-09T17:00:43.607
> 
> 标签：java, jvm

我的应用程序启动时出现错误。它似乎是在它初始化与数据库的连接之后。也可能是它开始产生线程的时候，但我无法故意让它发生。

整个错误消息是：
FATAL ERROR in native method: JDWP NewGlobalRef, jvmtiError=JVMTI_ERROR_NULL_POINTER(100) JDWP exit error JVMTI_ERROR_NULL_POINTER(100): NewGlobalRef

埃里克森：我对数据库代码不是很熟悉，但希望这个字符串会有所帮助：jdbc:sqlserver://localhost;databasename=FOO

Tom Hawtin：很可能我只是在调试时才得到这个错误，但它并没有足够的一致性让我注意到。

此外，我修复了一个错误，该错误导致多个线程尝试更新数据库中的同一行，但此后我没有收到 JVMTI... 错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T17:50:23.173

JVMTI 是调试和分析协议。所以，我猜这是您尝试运行应用程序的环境所特有的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T17:05:39.240

我猜您正在使用基于本机代码的数据库驱动程序（JDBC 驱动程序类型 1 或 2）。而且我猜那个驱动程序有问题。如果您可以提供有关驱动程序和数据源配置或连接字符串的更多信息，它可能有助于确定一些答案。

# javascript - 如果在浏览器上启用了 Javascript，如何检测（使用 .ASPX）

> ID：52344
> 
> 赞同：1
> 
> 时间：2008-09-09T17:01:00.377
> 
> 标签：javascript, asp.net

我认为这可能是一种快速简便的方法，可以稍微降低我们网站上的垃圾邮件表单。这个想法是（我已经阅读过）垃圾邮件发送者没有在启用 javascript 的情况下运行。（或者至少他们在没有运行 javascript 的情况下访问您的网站。也就是说，他们没有在 IE 或 FF 中浏览它。

我可以使用 .asp 或 .aspx。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T17:03:06.907

最简单的方法是通过 javascript 设置 cookie 并在回发时检查它。但是，如果您希望最大限度地减少垃圾邮件，您实际上应该让浏览器执行一个需要执行 javascript 的简单任务。请参阅 Phil Haack 的“Invisibile Captcha Validator”控件，该控件已包含在他的 Subkismet 库中：http: [//haacked.com/archive/2006/09/26/Lightweight_Invisible_CAPTCHA_Validator_Control.aspx](http://haacked.com/archive/2006/09/26/Lightweight_Invisible_CAPTCHA_Validator_Control.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T17:49:08.527

那么，您想强制用户使用 JavaScript 来使用您的网站吗？我宁愿只使用一个简单的验证码。如果您不是知名网站，则可以使用一些相对简单的验证码。

这就是我们减少网站垃圾邮件的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T17:16:41.460

在 .net 中，您可以使用`Request.Browser.JavaScript`来检测浏览器是否支持 JavaScript。但是，用户可能仍然禁用了 Javascript。检查是否启用了 Javascript 的一种丑陋方法是使用`window.location`重定向到 page.aspx?jscript=true，然后检查`Request.Querystring`该值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T10:14:04.967

老实说，您不需要使用服务器端语言来检测 javascript，而且垃圾邮件发送者不一定不运行 javascript。（对双重否定感到抱歉）您的目标是好的，但您的方法是错误的 - 正如我们的一些同行所建议的那样，实施 CAPTCHA 将是处理此问题的好方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T17:14:09.563

我看到您已经接受了`noscript`答案，但是您将如何使用它来对抗垃圾邮件？`noscript`将允许您为没有 JS 的用户添加特殊内容，但除非您在 JS 中生成站点的其余部分，否则没有 JS 的用户代理仍然可以使用它。

某种验证码仍然可能是最好的选择。最终，你试图让用户代理证明它是由人控制的，所以尽你最大的努力让它证明这个事实，而不是别的什么。视障人士的屏幕阅读器通常也没有 Javascript，而且许多从移动设备浏览的人禁用了 Javascript 以加快速度。

# java - 在 Java 中，确定对象大小的最佳方法是什么？

> ID：52353
> 
> 赞同：656
> 
> 时间：2008-09-09T17:07:03.323
> 
> 标签：java, memory

我有一个应用程序可以读取包含大量数据行的 CSV 文件。我给用户一个基于数据类型的行数总结，但我想确保我没有读入太多的数据行并导致`OutOfMemoryError`s。每行转换为一个对象。有没有一种简单的方法可以以编程方式找出该对象的大小？是否有一个参考定义了原始类型和对象参考的大小`VM`？

现在，我有代码说 read up to **32,000 rows**，但我也希望有代码说 read as many rows as possible 直到我使用了**32MB**内存。也许这是一个不同的问题，但我仍然想知道。

* * *

## 回答 #1

> 赞同：481
> 
> 时间：2008-09-09T19:24:37.863

您可以使用该[`java.lang.instrument`软件包](http://docs.oracle.com/javase/8/docs/api/java/lang/instrument/Instrumentation.html)。

编译这个类并将其放入一个 JAR 中：

```
import java.lang.instrument.Instrumentation;

public class ObjectSizeFetcher {
    private static Instrumentation instrumentation;

    public static void premain(String args, Instrumentation inst) {
        instrumentation = inst;
    }

    public static long getObjectSize(Object o) {
        return instrumentation.getObjectSize(o);
    }
} 
```

将以下内容添加到您的`MANIFEST.MF`:

```
Premain-Class: ObjectSizeFetcher 
```

使用`getObjectSize()`方法：

```
public class C {
    private int x;
    private int y;

    public static void main(String [] args) {
        System.out.println(ObjectSizeFetcher.getObjectSize(new C()));
    }
} 
```

调用：

```
java -javaagent:ObjectSizeFetcherAgent.jar C 
```

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2015-05-04T00:46:52.350

您应该使用[jol](http://openjdk.java.net/projects/code-tools/jol/)，这是作为 OpenJDK 项目的一部分开发的工具。

> JOL（Java Object Layout）是用于分析 JVM 中对象布局方案的微型工具箱。这些工具大量使用 Unsafe、JVMTI 和 Serviceability Agent (SA) 来解码实际的对象布局、占用空间和引用。这使得 JOL 比其他依赖堆转储、规范假设等的工具更准确。

要获取基元、引用和数组元素的大小，请使用`VMSupport.vmDetails()`. 在 64 位 Windows 上运行的 Oracle JDK 1.8.0_40（用于以下所有示例），此方法返回

```
Running 64-bit HotSpot VM.
Using compressed oop with 0-bit shift.
Using compressed klass with 3-bit shift.
Objects are 8 bytes aligned.
Field sizes by type: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes]
Array element sizes: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes] 
```

`ClassLayout.parseClass(Foo.class).toPrintable()`您可以使用（可选地将实例传递给`toPrintable`）来获取对象实例的浅大小。这只是该类的单个实例消耗的空间；它不包括该类引用的任何其他对象。它*确实*包括对象标头、字段对齐和填充的 VM 开销。对于`java.util.regex.Pattern`：

```
java.util.regex.Pattern object internals:
 OFFSET  SIZE        TYPE DESCRIPTION                    VALUE
      0     4             (object header)                01 00 00 00 (0000 0001 0000 0000 0000 0000 0000 0000)
      4     4             (object header)                00 00 00 00 (0000 0000 0000 0000 0000 0000 0000 0000)
      8     4             (object header)                cb cf 00 20 (1100 1011 1100 1111 0000 0000 0010 0000)
     12     4         int Pattern.flags                  0
     16     4         int Pattern.capturingGroupCount    1
     20     4         int Pattern.localCount             0
     24     4         int Pattern.cursor                 48
     28     4         int Pattern.patternLength          0
     32     1     boolean Pattern.compiled               true
     33     1     boolean Pattern.hasSupplementary       false
     34     2             (alignment/padding gap)        N/A
     36     4      String Pattern.pattern                (object)
     40     4      String Pattern.normalizedPattern      (object)
     44     4        Node Pattern.root                   (object)
     48     4        Node Pattern.matchRoot              (object)
     52     4       int[] Pattern.buffer                 null
     56     4         Map Pattern.namedGroups            null
     60     4 GroupHead[] Pattern.groupNodes             null
     64     4       int[] Pattern.temp                   null
     68     4             (loss due to the next object alignment)
Instance size: 72 bytes (reported by Instrumentation API)
Space losses: 2 bytes internal + 4 bytes external = 6 bytes total 
```

您可以使用 获取对象实例深度大小的摘要视图`GraphLayout.parseInstance(obj).toFootprint()`。当然，足迹中的某些对象可能是共享的（也从其他对象引用），因此当该对象被垃圾回收时，它是可以回收的空间的过度近似。对于`Pattern.compile("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$")`（取自[这个答案](https://stackoverflow.com/a/719543/3614835)）的结果，jol 报告了 1840 字节的总占用空间，其中只有 72 个是 Pattern 实例本身。

```
java.util.regex.Pattern instance footprint:
     COUNT       AVG       SUM   DESCRIPTION
         1       112       112   [C
         3       272       816   [Z
         1        24        24   java.lang.String
         1        72        72   java.util.regex.Pattern
         9        24       216   java.util.regex.Pattern$1
        13        24       312   java.util.regex.Pattern$5
         1        16        16   java.util.regex.Pattern$Begin
         3        24        72   java.util.regex.Pattern$BitClass
         3        32        96   java.util.regex.Pattern$Curly
         1        24        24   java.util.regex.Pattern$Dollar
         1        16        16   java.util.regex.Pattern$LastNode
         1        16        16   java.util.regex.Pattern$Node
         2        24        48   java.util.regex.Pattern$Single
        40                1840   (total) 
```

如果您改为使用`GraphLayout.parseInstance(obj).toPrintable()`， jol 将告诉您对每个被引用对象的字段取消引用的地址、大小、类型、值和路径，尽管这通常过于详细而无用。对于正在进行的模式示例，您可能会得到以下信息。（地址可能会在运行之间发生变化。）

```
java.util.regex.Pattern object externals:
          ADDRESS       SIZE TYPE                             PATH                           VALUE
         d5e5f290         16 java.util.regex.Pattern$Node     .root.next.atom.next           (object)
         d5e5f2a0        120 (something else)                 (somewhere else)               (something else)
         d5e5f318         16 java.util.regex.Pattern$LastNode .root.next.next.next.next.next.next.next (object)
         d5e5f328      21664 (something else)                 (somewhere else)               (something else)
         d5e647c8         24 java.lang.String                 .pattern                       (object)
         d5e647e0        112 [C                               .pattern.value                 [^, [, a, -, z, A, -, Z, 0, -, 9, _, ., +, -, ], +, @, [, a, -, z, A, -, Z, 0, -, 9, -, ], +, \, ., [, a, -, z, A, -, Z, 0, -, 9, -, ., ], +, $]
         d5e64850        448 (something else)                 (somewhere else)               (something else)
         d5e64a10         72 java.util.regex.Pattern                                         (object)
         d5e64a58        416 (something else)                 (somewhere else)               (something else)
         d5e64bf8         16 java.util.regex.Pattern$Begin    .root                          (object)
         d5e64c08         24 java.util.regex.Pattern$BitClass .root.next.atom.val$rhs        (object)
         d5e64c20        272 [Z                               .root.next.atom.val$rhs.bits   [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, false, true, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]
         d5e64d30         24 java.util.regex.Pattern$1        .root.next.atom.val$lhs.val$lhs.val$lhs.val$lhs.val$lhs.val$lhs (object)
         d5e64d48         24 java.util.regex.Pattern$1        .root.next.atom.val$lhs.val$lhs.val$lhs.val$lhs.val$lhs.val$rhs (object)
         d5e64d60         24 java.util.regex.Pattern$5        .root.next.atom.val$lhs.val$lhs.val$lhs.val$lhs.val$lhs (object)
         d5e64d78         24 java.util.regex.Pattern$1        .root.next.atom.val$lhs.val$lhs.val$lhs.val$lhs.val$rhs (object)
         d5e64d90         24 java.util.regex.Pattern$5        .root.next.atom.val$lhs.val$lhs.val$lhs.val$lhs (object)
         d5e64da8         24 java.util.regex.Pattern$5        .root.next.atom.val$lhs.val$lhs.val$lhs (object)
         d5e64dc0         24 java.util.regex.Pattern$5        .root.next.atom.val$lhs.val$lhs (object)
         d5e64dd8         24 java.util.regex.Pattern$5        .root.next.atom.val$lhs        (object)
         d5e64df0         24 java.util.regex.Pattern$5        .root.next.atom                (object)
         d5e64e08         32 java.util.regex.Pattern$Curly    .root.next                     (object)
         d5e64e28         24 java.util.regex.Pattern$Single   .root.next.next                (object)
         d5e64e40         24 java.util.regex.Pattern$BitClass .root.next.next.next.atom.val$rhs (object)
         d5e64e58        272 [Z                               .root.next.next.next.atom.val$rhs.bits [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]
         d5e64f68         24 java.util.regex.Pattern$1        .root.next.next.next.atom.val$lhs.val$lhs.val$lhs (object)
         d5e64f80         24 java.util.regex.Pattern$1        .root.next.next.next.atom.val$lhs.val$lhs.val$rhs (object)
         d5e64f98         24 java.util.regex.Pattern$5        .root.next.next.next.atom.val$lhs.val$lhs (object)
         d5e64fb0         24 java.util.regex.Pattern$1        .root.next.next.next.atom.val$lhs.val$rhs (object)
         d5e64fc8         24 java.util.regex.Pattern$5        .root.next.next.next.atom.val$lhs (object)
         d5e64fe0         24 java.util.regex.Pattern$5        .root.next.next.next.atom      (object)
         d5e64ff8         32 java.util.regex.Pattern$Curly    .root.next.next.next           (object)
         d5e65018         24 java.util.regex.Pattern$Single   .root.next.next.next.next      (object)
         d5e65030         24 java.util.regex.Pattern$BitClass .root.next.next.next.next.next.atom.val$rhs (object)
         d5e65048        272 [Z                               .root.next.next.next.next.next.atom.val$rhs.bits [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false]
         d5e65158         24 java.util.regex.Pattern$1        .root.next.next.next.next.next.atom.val$lhs.val$lhs.val$lhs.val$lhs (object)
         d5e65170         24 java.util.regex.Pattern$1        .root.next.next.next.next.next.atom.val$lhs.val$lhs.val$lhs.val$rhs (object)
         d5e65188         24 java.util.regex.Pattern$5        .root.next.next.next.next.next.atom.val$lhs.val$lhs.val$lhs (object)
         d5e651a0         24 java.util.regex.Pattern$1        .root.next.next.next.next.next.atom.val$lhs.val$lhs.val$rhs (object)
         d5e651b8         24 java.util.regex.Pattern$5        .root.next.next.next.next.next.atom.val$lhs.val$lhs (object)
         d5e651d0         24 java.util.regex.Pattern$5        .root.next.next.next.next.next.atom.val$lhs (object)
         d5e651e8         24 java.util.regex.Pattern$5        .root.next.next.next.next.next.atom (object)
         d5e65200         32 java.util.regex.Pattern$Curly    .root.next.next.next.next.next (object)
         d5e65220        120 (something else)                 (somewhere else)               (something else)
         d5e65298         24 java.util.regex.Pattern$Dollar   .root.next.next.next.next.next.next (object) 
```

“（其他）”条目[描述了堆中不属于此对象图的其他对象](https://stackoverflow.com/questions/30021092/what-is-something-else-in-jol-graphlayout-output)。

最好的 jol 文档是 jol 存储库中的[jol 示例](http://hg.openjdk.java.net/code-tools/jol/file/tip/jol-samples/src/main/java/org/openjdk/jol/samples/)。这些示例演示了常见的 jol 操作，并展示了如何使用 jol 来分析 VM 和垃圾收集器内部结构。

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2016-09-09T07:53:20.677

我无意中发现了一个 java 类“jdk.nashorn.internal.ir.debug.ObjectSizeCalculator”，已经在 jdk 中，它易于使用，并且对于确定对象的大小似乎非常有用。

```
System.out.println(ObjectSizeCalculator.getObjectSize(new gnu.trove.map.hash.TObjectIntHashMap<String>(12000, 0.6f, -1)));
System.out.println(ObjectSizeCalculator.getObjectSize(new HashMap<String, Integer>(100000)));
System.out.println(ObjectSizeCalculator.getObjectSize(3));
System.out.println(ObjectSizeCalculator.getObjectSize(new int[]{1, 2, 3, 4, 5, 6, 7 }));
System.out.println(ObjectSizeCalculator.getObjectSize(new int[100])); 
```

结果：

```
164192
48
16
48
416 
```

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2008-09-09T18:42:54.203

几年前 Javaworld 有[一篇关于确定复合和潜在嵌套 Java 对象的大小的文章](https://www.infoworld.com/article/2077408/sizeof-for-java.html)，他们基本上介绍了在 Java 中创建 sizeof() 实现。该方法基本上建立在其他工作的基础上，人们通过实验确定基元和典型 Java 对象的大小，然后将这些知识应用于递归遍历对象图以计算总大小的方法。

仅仅因为类的幕后发生的事情，它总是比原生 C 实现更不准确，但它应该是一个很好的指标。

或者，适当地称为[sizeof](http://sourceforge.net/projects/sizeof)的 SourceForge 项目提供了具有 sizeof() 实现的 Java5 库。

PS 不要使用序列化的方式，序列化对象的大小和它存活时消耗的内存量之间没有关联。

* * *

## 回答 #5

> 赞同：71
> 
> 时间：2008-09-09T17:22:37.907

首先，“对象的大小”在 Java 中不是一个定义明确的概念。您可能指的是对象本身，以及它的成员、对象和它引用的所有对象（参考图）。您可能是指内存中的大小或磁盘上的大小。并且允许 JVM 优化诸如字符串之类的东西。

因此，唯一正确的方法是使用良好的分析器（我使用[YourKit](http://www.yourkit.com)）询问 JVM，这可能不是您想要的。

但是，从上面的描述看来，每一行都是自包含的，并且没有大的依赖树，因此序列化方法可能是大多数 JVM 的一个很好的近似。最简单的方法如下：

```
 Serializable ser;
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
 ObjectOutputStream oos = new ObjectOutputStream(baos);
 oos.writeObject(ser);
 oos.close();
 return baos.size(); 
```

请记住，如果您有具有公共引用的对象，这*将不会*给出正确的结果，并且序列化的大小并不总是与内存中的大小相匹配，但它是一个很好的近似值。如果将 ByteArrayOutputStream 大小初始化为合理的值，则代码会更有效率。

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2008-09-09T17:19:28.130

如果您只想知道 JVM 中使用了多少内存，以及有多少是空闲的，您可以尝试以下操作：

```
// Get current size of heap in bytes
long heapSize = Runtime.getRuntime().totalMemory();

// Get maximum size of heap in bytes. The heap cannot grow beyond this size.
// Any attempt will result in an OutOfMemoryException.
long heapMaxSize = Runtime.getRuntime().maxMemory();

// Get amount of free memory within the heap in bytes. This size will increase
// after garbage collection and decrease as new objects are created.
long heapFreeSize = Runtime.getRuntime().freeMemory(); 
```

编辑：我认为这可能会有所帮助，因为问题作者还表示他希望拥有处理“在我使用 32MB 内存之前读取尽可能多的行”的逻辑。

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2015-04-09T11:07:01.830

当我在 Twitter 工作时，我编写了一个用于计算深度对象大小的实用程序。它考虑了不同的内存模型（32 位、压缩 oops、64 位）、填充、子类填充，可在循环数据结构和数组上正常工作。你可以只编译这个 .java 文件；它没有外部依赖：

[https://github.com/twitter/commons/blob/master/src/java/com/twitter/common/objectsize/ObjectSizeCalculator.java](https://github.com/twitter/commons/blob/master/src/java/com/twitter/common/objectsize/ObjectSizeCalculator.java)

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2015-03-06T14:07:34.547

许多其他答案提供了浅大小 - 例如没有任何键或值的 HashMap 的大小，这可能不是您想要的。

jamm 项目使用上面的 java.lang.instrumentation 包，但会遍历树，因此可以为您提供深度内存使用。

```
new MemoryMeter().measureDeep(myHashMap); 
```

[https://github.com/jbellis/jamm](https://github.com/jbellis/jamm)

> 要使用 MemoryMeter，请使用“-javaagent:/jamm.jar”启动 JVM

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2008-09-09T17:19:48.177

您必须使用反射来行走对象。这样做时要小心：

*   仅仅分配一个对象在 JVM 中有一些开销。数量因 JVM 而异，因此您可以将此值作为参数。至少让它成为一个常量（8 个字节？）并应用于任何分配的东西。
*   仅仅因为`byte`理论上是 1 个字节并不意味着它只需要一个内存。
*   对象引用中会有循环，因此您需要*使用 object-equals 作为比较器*`HashMap`来保持 a或 somesuch以消除无限循环。

 *@jodonnell：我喜欢您的解决方案的简单性，但是许多对象不是可序列化的（因此这会引发异常），字段可以是瞬态的，并且对象可以覆盖标准方法。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-09-09T17:20:40.187

您必须使用工具来测量它，或者手动估计它，这取决于您使用的 JVM。

每个对象有一些固定的开销。它是特定于 JVM 的，但我通常估计 40 个字节。然后你必须看看班级的成员。对象引用是 32 位（64 位）JVM 中的 4 (8) 个字节。原始类型是：

*   布尔值和字节：1 个字节
*   char 和 short：2 个字节
*   整数和浮点数：4 个字节
*   long 和 double：8 个字节

数组遵循相同的规则；也就是说，它是一个对象引用，因此在您的对象中占用 4（或 8）个字节，然后将其长度乘以其元素的大小。

由于对垃圾收集器的异步调用等，尝试通过调用以编程方式执行它`Runtime.freeMemory()`不会给您带来太多的准确性。使用 -Xrunhprof 或其他工具分析堆将为您提供最准确的结果。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2020-04-23T21:30:04.857

使用 JetBrains IntelliJ 时，首先在文件 | 中启用“附加内存代理”。设置 | 构建、执行、部署 | 调试器。

调试时，右键单击感兴趣的变量并选择“计算保留大小”：[![计算保留大小](https://i.stack.imgur.com/TvMel.png)](https://i.stack.imgur.com/TvMel.png)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-09-05T20:13:49.653

还有一个**Memory Measurer**工具（以前在[Google Code](http://code.google.com/p/memory-measurer/)上，现在在[GitHub 上](https://github.com/DimitrisAndreou/memory-measurer)），它很简单，并且在商业友好的**Apache 2.0 许可下发布，正如在**[类似问题](https://stackoverflow.com/questions/9368764/calculate-size-of-object-in-java)中所讨论的那样。

如果您想测量内存字节消耗，它也需要 java 解释器的命令行参数，但在其他方面似乎工作得很好，至少在我使用它的场景中。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2012-05-14T16:37:13.947

该类`java.lang.instrument.Instrumentation`提供了一种获取 Java 对象大小的好方法，但它需要您定义`premain`一个 Java 代理并使用 Java 代理运行您的程序。当您不需要任何代理时，这非常无聊，然后您必须为您的应用程序提供一个虚拟 Jar 代理。

因此，我`Unsafe`使用`sun.misc`. 因此，根据处理器架构考虑对象堆对齐并计算最大字段偏移量，您可以衡量 Java 对象的大小。在下面的示例中，我使用辅助类`UtilUnsafe`来获取对`sun.misc.Unsafe`对象的引用。

```
private static final int NR_BITS = Integer.valueOf(System.getProperty("sun.arch.data.model"));
private static final int BYTE = 8;
private static final int WORD = NR_BITS/BYTE;
private static final int MIN_SIZE = 16; 

public static int sizeOf(Class src){
    //
    // Get the instance fields of src class
    // 
    List<Field> instanceFields = new LinkedList<Field>();
    do{
        if(src == Object.class) return MIN_SIZE;
        for (Field f : src.getDeclaredFields()) {
            if((f.getModifiers() & Modifier.STATIC) == 0){
                instanceFields.add(f);
            }
        }
        src = src.getSuperclass();
    }while(instanceFields.isEmpty());
    //
    // Get the field with the maximum offset
    //  
    long maxOffset = 0;
    for (Field f : instanceFields) {
        long offset = UtilUnsafe.UNSAFE.objectFieldOffset(f);
        if(offset > maxOffset) maxOffset = offset; 
    }
    return  (((int)maxOffset/WORD) + 1)*WORD; 
}
class UtilUnsafe {
    public static final sun.misc.Unsafe UNSAFE;

    static {
        Object theUnsafe = null;
        Exception exception = null;
        try {
            Class<?> uc = Class.forName("sun.misc.Unsafe");
            Field f = uc.getDeclaredField("theUnsafe");
            f.setAccessible(true);
            theUnsafe = f.get(uc);
        } catch (Exception e) { exception = e; }
        UNSAFE = (sun.misc.Unsafe) theUnsafe;
        if (UNSAFE == null) throw new Error("Could not obtain access to sun.misc.Unsafe", exception);
    }
    private UtilUnsafe() { }
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-04-03T12:09:59.390

无需弄乱仪器等，如果您不需要知道对象的字节精确大小，您可以使用以下方法：

```
System.gc();
Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory();

do your job here

System.gc();
Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory(); 
```

通过这种方式，您可以在之前和之后读取已用内存，并在获取已用内存之前调用 GC，您可以将“噪音”几乎降低到 0。

为了获得更可靠的结果，您可以运行您的作业 n 次，然后将使用的内存除以 n，获得一次运行占用的内存量。更重要的是，您可以将整个过程运行更多次并取平均值。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-06-27T04:40:10.273

我正在寻找满足以下要求的对象大小的运行时计算：

*   在运行时可用，无需包含检测。
*   与 Java 9+ 一起工作，无需访问 Unsafe。
*   仅基于类。不是考虑字符串长度、数组长度等的深度 sizeOf。

以下内容基于原始 java 专家文章 ( [https://www.javaspecialists.eu/archive/Issue078.html](https://www.javaspecialists.eu/archive/Issue078.html) ) 的核心代码以及该问题的另一个答案中的 Unsafe 版本中的一些内容。

我希望有人觉得它有用。

```
public class JavaSize {

private static final int NR_BITS = Integer.valueOf(System.getProperty("sun.arch.data.model"));
private static final int BYTE = 8;
private static final int WORD = NR_BITS / BYTE;
private static final int HEADER_SIZE = 8;

public static int sizeOf(Class<?> clazz) {
    int result = 0;

    while (clazz != null) {
        Field[] fields = clazz.getDeclaredFields();
        for (int i = 0; i < fields.length; i++) {
            if (!Modifier.isStatic(fields[i].getModifiers())) {
                if (fields[i].getType().isPrimitive()) {
                    Class<?> primitiveClass = fields[i].getType();
                    if (primitiveClass == boolean.class || primitiveClass == byte.class) {
                        result += 1;
                    } else if (primitiveClass == short.class) {
                        result += 2;
                    } else if (primitiveClass == int.class || primitiveClass == float.class) {
                        result += 4;
                    } else if (primitiveClass == double.class || primitiveClass == long.class) {
                        result += 8;
                    }

                } else {
                    // assume compressed references.
                    result += 4;
                }
            }
        }

        clazz = clazz.getSuperclass();

        // round up to the nearest WORD length.
        if ((result % WORD) != 0) {
            result += WORD - (result % WORD);
        }
    }

    result += HEADER_SIZE;

    return result;
} 
```

}

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-06-26T05:36:47.960

这是我使用一些链接示例制作的实用程序，用于处理带有压缩 OOP 的 32 位、64 位和 64 位。它使用`sun.misc.Unsafe`.

它用于`Unsafe.addressSize()`获取本机指针`Unsafe.arrayIndexScale( Object[].class )`的大小和 Java 引用的大小。

它使用已知类的字段偏移量来计算对象的基本大小。

```
import java.lang.reflect.Array;
import java.lang.reflect.Field;
import java.lang.reflect.Modifier;
import java.util.IdentityHashMap;
import java.util.Stack;
import sun.misc.Unsafe;

/** Usage: 
 * MemoryUtil.sizeOf( object )
 * MemoryUtil.deepSizeOf( object )
 * MemoryUtil.ADDRESS_MODE
 */
public class MemoryUtil
{
    private MemoryUtil()
    {
    }

    public static enum AddressMode
    {
        /** Unknown address mode. Size calculations may be unreliable. */
        UNKNOWN,
        /** 32-bit address mode using 32-bit references. */
        MEM_32BIT,
        /** 64-bit address mode using 64-bit references. */
        MEM_64BIT,
        /** 64-bit address mode using 32-bit compressed references. */
        MEM_64BIT_COMPRESSED_OOPS
    }

    /** The detected runtime address mode. */
    public static final AddressMode ADDRESS_MODE;

    private static final Unsafe UNSAFE;

    private static final long ADDRESS_SIZE; // The size in bytes of a native pointer: 4 for 32 bit, 8 for 64 bit
    private static final long REFERENCE_SIZE; // The size of a Java reference: 4 for 32 bit, 4 for 64 bit compressed oops, 8 for 64 bit
    private static final long OBJECT_BASE_SIZE; // The minimum size of an Object: 8 for 32 bit, 12 for 64 bit compressed oops, 16 for 64 bit
    private static final long OBJECT_ALIGNMENT = 8;

    /** Use the offset of a known field to determine the minimum size of an object. */
    private static final Object HELPER_OBJECT = new Object() { byte b; };

    static
    {
        try
        {
            // Use reflection to get a reference to the 'Unsafe' object.
            Field f = Unsafe.class.getDeclaredField( "theUnsafe" );
            f.setAccessible( true );
            UNSAFE = (Unsafe) f.get( null );

            OBJECT_BASE_SIZE = UNSAFE.objectFieldOffset( HELPER_OBJECT.getClass().getDeclaredField( "b" ) );

            ADDRESS_SIZE = UNSAFE.addressSize();
            REFERENCE_SIZE = UNSAFE.arrayIndexScale( Object[].class );

            if( ADDRESS_SIZE == 4 )
            {
                ADDRESS_MODE = AddressMode.MEM_32BIT;
            }
            else if( ADDRESS_SIZE == 8 && REFERENCE_SIZE == 8 )
            {
                ADDRESS_MODE = AddressMode.MEM_64BIT;
            }
            else if( ADDRESS_SIZE == 8 && REFERENCE_SIZE == 4 )
            {
                ADDRESS_MODE = AddressMode.MEM_64BIT_COMPRESSED_OOPS;
            }
            else
            {
                ADDRESS_MODE = AddressMode.UNKNOWN;
            }
        }
        catch( Exception e )
        {
            throw new Error( e );
        }
    }

    /** Return the size of the object excluding any referenced objects. */
    public static long shallowSizeOf( final Object object )
    {
        Class<?> objectClass = object.getClass();
        if( objectClass.isArray() )
        {
            // Array size is base offset + length * element size
            long size = UNSAFE.arrayBaseOffset( objectClass )
                    + UNSAFE.arrayIndexScale( objectClass ) * Array.getLength( object );
            return padSize( size );
        }
        else
        {
            // Object size is the largest field offset padded out to 8 bytes
            long size = OBJECT_BASE_SIZE;
            do
            {
                for( Field field : objectClass.getDeclaredFields() )
                {
                    if( (field.getModifiers() & Modifier.STATIC) == 0 )
                    {
                        long offset = UNSAFE.objectFieldOffset( field );
                        if( offset >= size )
                        {
                            size = offset + 1; // Field size is between 1 and PAD_SIZE bytes. Padding will round up to padding size.
                        }
                    }
                }
                objectClass = objectClass.getSuperclass();
            }
            while( objectClass != null );

            return padSize( size );
        }
    }

    private static final long padSize( final long size )
    {
        return (size + (OBJECT_ALIGNMENT - 1)) & ~(OBJECT_ALIGNMENT - 1);
    }

    /** Return the size of the object including any referenced objects. */
    public static long deepSizeOf( final Object object )
    {
        IdentityHashMap<Object,Object> visited = new IdentityHashMap<Object,Object>();
        Stack<Object> stack = new Stack<Object>();
        if( object != null ) stack.push( object );

        long size = 0;
        while( !stack.isEmpty() )
        {
            size += internalSizeOf( stack.pop(), stack, visited );
        }
        return size;
    }

    private static long internalSizeOf( final Object object, final Stack<Object> stack, final IdentityHashMap<Object,Object> visited )
    {
        // Scan for object references and add to stack
        Class<?> c = object.getClass();
        if( c.isArray() && !c.getComponentType().isPrimitive() )
        {
            // Add unseen array elements to stack
            for( int i = Array.getLength( object ) - 1; i >= 0; i-- )
            {
                Object val = Array.get( object, i );
                if( val != null && visited.put( val, val ) == null )
                {
                    stack.add( val );
                }
            }
        }
        else
        {
            // Add unseen object references to the stack
            for( ; c != null; c = c.getSuperclass() )
            {
                for( Field field : c.getDeclaredFields() )
                {
                    if( (field.getModifiers() & Modifier.STATIC) == 0 
                            && !field.getType().isPrimitive() )
                    {
                        field.setAccessible( true );
                        try
                        {
                            Object val = field.get( object );
                            if( val != null && visited.put( val, val ) == null )
                            {
                                stack.add( val );
                            }
                        }
                        catch( IllegalArgumentException e )
                        {
                            throw new RuntimeException( e );
                        }
                        catch( IllegalAccessException e )
                        {
                            throw new RuntimeException( e );
                        }
                    }
                }
            }
        }

        return shallowSizeOf( object );
    }
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-09T17:15:40.120

如果那是您所要求的，则没有方法调用。通过一些研究，我想你可以编写自己的。特定实例具有从引用和原始值的数量以及实例簿记数据派生的固定大小。您只需遍历对象图。行类型的变化越少，就越容易。

如果这太慢或只是比它的价值更多的麻烦，总是有很好的老式行计数经验法则。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-11-16T03:34:24.200

我写了一个快速测试来即时估计：

```
public class Test1 {

    // non-static nested
    class Nested { }

    // static nested
    static class StaticNested { }

    static long getFreeMemory () {
        // waits for free memory measurement to stabilize
        long init = Runtime.getRuntime().freeMemory(), init2;
        int count = 0;
        do {
            System.out.println("waiting..." + init);
            System.gc();
            try { Thread.sleep(250); } catch (Exception x) { }
            init2 = init;
            init = Runtime.getRuntime().freeMemory();
            if (init == init2) ++ count; else count = 0;
        } while (count < 5);
        System.out.println("ok..." + init);
        return init;
    }

    Test1 () throws InterruptedException {

        Object[] s = new Object[10000];
        Object[] n = new Object[10000];
        Object[] t = new Object[10000];

        long init = getFreeMemory();

        //for (int j = 0; j < 10000; ++ j)
        //    s[j] = new Separate();

        long afters = getFreeMemory();

        for (int j = 0; j < 10000; ++ j)
            n[j] = new Nested();

        long aftersn = getFreeMemory();

        for (int j = 0; j < 10000; ++ j)
            t[j] = new StaticNested();

        long aftersnt = getFreeMemory();

        System.out.println("separate:      " + -(afters - init) + " each=" + -(afters - init) / 10000);
        System.out.println("nested:        " + -(aftersn - afters) + " each=" + -(aftersn - afters) / 10000);
        System.out.println("static nested: " + -(aftersnt - aftersn) + " each=" + -(aftersnt - aftersn) / 10000);

    }

    public static void main (String[] args) throws InterruptedException {
        new Test1();
    }

} 
```

一般概念是分配对象并测量空闲堆空间的变化。关键是`getFreeMemory()`，它**请求 GC 运行并等待报告的空闲堆大小稳定**。上面的输出是：

```
nested:        160000 each=16
static nested: 160000 each=16 
```

考虑到对齐行为和可能的堆块头开销，这是我们所期望的。

此处接受的答案中详述的检测方法最准确。我描述的方法是准确的，但仅在没有其他线程创建/丢弃对象的受控条件下。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-03-23T11:53:26.233

只需使用 java 可视 VM。

它拥有分析和调试内存问题所需的一切。

它还有一个 OQL（对象查询语言）控制台，允许您做许多有用的事情，其中​​之一是`sizeof(o)`

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-05-07T07:23:43.257

```
long heapSizeBefore = Runtime.getRuntime().totalMemory();

// Code for object construction
...
long heapSizeAfter = Runtime.getRuntime().totalMemory();
long size = heapSizeAfter - heapSizeBefore; 
```

size 为您提供由于创建对象而增加的 jvm 内存使用量，这通常是对象的大小。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-10-16T15:02:11.320

我的回答基于尼克提供的代码。该代码测量序列化对象占用的字节总数。所以这实际上测量了序列化的东西+普通对象的内存占用（例如，只是序列化`int`，你会看到序列化字节的总量不是`4`）。因此，如果您想获得完全用于您的对象的原始字节数 - 您需要稍微修改该代码。像这样：

```
import java.io.ByteArrayOutputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;

public class ObjectSizeCalculator {
    private Object getFirstObjectReference(Object o) {
        String objectType = o.getClass().getTypeName();

        if (objectType.substring(objectType.length()-2).equals("[]")) {
            try {
                if (objectType.equals("java.lang.Object[]"))
                    return ((Object[])o)[0];
                else if (objectType.equals("int[]"))
                    return ((int[])o)[0];
                else
                    throw new RuntimeException("Not Implemented !");
            } catch (IndexOutOfBoundsException e) {
                return null;
            }
        }

        return o;
    } 

    public int getObjectSizeInBytes(Object o) {
        final String STRING_JAVA_TYPE_NAME = "java.lang.String";

        if (o == null)
            return 0;

        String objectType = o.getClass().getTypeName();
        boolean isArray = objectType.substring(objectType.length()-2).equals("[]");

        Object objRef = getFirstObjectReference(o);
        if (objRef != null && !(objRef instanceof Serializable))
            throw new RuntimeException("Object must be serializable for measuring it's memory footprint using this method !");

        try {
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            ObjectOutputStream oos = new ObjectOutputStream(baos);
            oos.writeObject(o);
            oos.close();
            byte[] bytes = baos.toByteArray();

            for (int i = bytes.length - 1, j = 0; i != 0; i--, j++) {
                if (objectType != STRING_JAVA_TYPE_NAME) {
                    if (bytes[i] == 112)
                        if (isArray)
                            return j - 4;
                        else
                            return j;
                } else {
                    if (bytes[i] == 0)
                        return j - 1;
                }
            }
        } catch (Exception e) {
            return -1;
        }

        return -1;
    }    

} 
```

我已经用原始类型、字符串和一些琐碎的类测试了这个解决方案。也可能有未涵盖的情况。

**更新：**修改示例以支持数组对象的内存占用计算。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-03-03T07:04:58.477

这个答案与对象大小无关，而是当您使用数组来容纳对象时；它将为对象分配多少内存大小。

因此，所有这些集合的数组、列表或映射都不会真正存储对象（仅在基元时，需要真正的对象内存大小），它只会存储这些对象的引用。

现在`Used heap memory = sizeOfObj + sizeOfRef (* 4 bytes) in collection`

*   （4/8 字节）取决于（32/64 位）操作系统

**原语**

```
int   [] intArray    = new int   [1]; will require 4 bytes.
long  [] longArray   = new long  [1]; will require 8 bytes. 
```

**对象**

```
Object[] objectArray = new Object[1]; will require 4 bytes. The object can be any user defined Object.
Long  [] longArray   = new Long  [1]; will require 4 bytes. 
```

我的意思是说所有对象 REFERENCE 只需要 4 个字节的内存。它可能是字符串引用或双对象引用，但取决于对象的创建，所需的内存会有所不同。

例如）如果我为下面的类创建对象，`ReferenceMemoryTest`那么将创建 4 + 4 + 4 = 12 字节的内存。当您尝试初始化引用时，内存可能会有所不同。

```
 class ReferenceMemoryTest {
    public String refStr;
    public Object refObj;
    public Double refDoub; 
} 
```

因此，在创建对象/引用数组时，其所有内容都将被 NULL 引用占用。我们知道每个引用需要 4 个字节。

最后，以下代码的内存分配是 20 字节。

ReferenceMemoryTest ref1 = new ReferenceMemoryTest(); ( 4(ref1) + 12 = 16 字节) ReferenceMemoryTest ref2 = ref1; ( 4(ref2) + 16 = 20 字节)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-04-04T15:08:07.783

您可以生成堆转储（例如使用 jmap），然后分析输出以查找对象大小。这是一个离线解决方案，但您可以检查浅尺寸和深尺寸等。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-03-28T17:58:23.223

假设我声明了一个名为的`Complex`类：

```
public class Complex {

    private final long real;
    private final long imaginary;

    // omitted
} 
```

为了查看为此类的活动实例分配了多少内存：

```
$ jmap -histo:live <pid> | grep Complex

 num     #instances         #bytes  class name (module)
-------------------------------------------------------
 327:             1             32  Complex 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-23T02:32:50.650

如果您的应用程序将[Apache commons lang 库](https://www.baeldung.com/java-commons-lang-3)作为依赖项或正在使用[Spring 框架](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/SerializationUtils.html)，那么您还可以使用`SerializationUtils`该类来快速找出任何给定对象的近似字节大小。

```
byte[] data = SerializationUtils.serialize(user);
System.out.println("Approximate object size in bytes " + data.length); 
```

* * *

## 回答 #26

> 赞同：-5
> 
> 时间：2017-12-16T18:31:18.040

对于 JSONObject，以下代码可以帮助您。

```
`JSONObject.toString().getBytes("UTF-8").length` 
```

返回大小（以字节为单位）

我通过将 JSONArray 对象写入文件来检查它。它给出了对象的大小。

* * *

## 回答 #27

> 赞同：-6
> 
> 时间：2008-09-09T17:11:35.763

我怀疑您是否想以编程方式执行此操作，除非您只想执行一次并将其存储以备将来使用。这是一件代价高昂的事情。Java 中没有 sizeof() 运算符，即使有，它也只会计算对其他对象的引用的成本和原语的大小。

您可以这样做的一种方法是将事物序列化为文件并查看文件的大小，如下所示：

```
Serializable myObject;
ObjectOutputStream oos = new ObjectOutputStream (new FileOutputStream ("obj.ser"));
oos.write (myObject);
oos.close (); 
```

当然，这假设每个对象都是不同的，并且不包含对其他任何东西的非瞬态引用。

另一种策略是获取每个对象并通过反射检查其成员并将大小相加（布尔和字节 = 1 字节，短和字符 = 2 字节等），沿着成员资格层次结构向下工作。但这既乏味又昂贵，最终会做与序列化策略相同的事情。

# sql-server - SQL 2005 在数据库之间复制单列

> ID：52356
> 
> 赞同：2
> 
> 时间：2008-09-09T17:08:44.600
> 
> 标签：sql-server, tsql, copy

我对 T-SQL 和 SQL 2005 还很陌生。我需要将一列整数从 database1 中的表导入到 database2 中的相同表（仅缺少我需要的列）。两者都是 sql 2005 数据库。我已经尝试过 Server Management Studio 中的内置导入命令，但它迫使我复制整个表。由于约束和“只读”列（无论 sql2005 中的“只读”是什么意思），这会导致错误。我只想抓取一列并将其复制到表中。

必须有一个简单的方法来做到这一点。就像是：

```
INSERT INTO database1.myTable columnINeed
SELECT columnINeed from database2.myTable 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T17:18:52.877

插入不会这样做，因为它会尝试在表的末尾插入新行。听起来您尝试做的是在现有行的末尾添加一列。

我不确定语法是否完全正确，但是，如果我理解您，那么这将满足您的要求。

1.  在 database2 中创建允许空值的列。

2.  执行更新：

    更新 database2.dbo.tablename SET database2.dbo.tablename.colname = database1.dbo.tablename.colname FROM database2.dbo.tablename INNER JOIN database1.dbo.tablename ON database2.dbo.tablename.keycol = database1.dbo.tablename。关键点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T17:15:06.770

只要两个数据库都在同一台服务器上，就有一种非常简单的方法。完全限定名称是 dbname.owner.table - 通常所有者是 dbo，并且有一个“.dbo”的快捷方式。这是“..”，所以...

```
INSERT INTO Datbase1..MyTable
    (ColumnList)
SELECT FieldsIWant
  FROM Database2..MyTable 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T17:31:10.367

如果该列不存在，则首先创建该列：

```
ALTER TABLE database2..targetTable
ADD targetColumn int null -- or whatever column definition is needed 
```

由于您使用的是 Sql Server 2005，因此您可以使用新的[MERGE](http://msdn.microsoft.com/en-us/library/bb510625.aspx)语句。 **[MERGE](http://msdn.microsoft.com/en-us/library/bb510625.aspx)****语句的优点是能够在一个语句中处理所有情况，**例如源中丢失的行（可以执行插入）、目标中的丢失行（可以执行删除）、匹配的行（可以执行更新），并且一切都以原子方式完成在单笔交易中。例子：

```
MERGE database2..targetTable AS t
USING (SELECT sourceColumn FROM sourceDatabase1..sourceTable) as s
ON t.PrimaryKeyCol = s.PrimaryKeyCol -- or whatever the match should be bassed on
WHEN MATCHED THEN 
    UPDATE SET t.targetColumn = s.sourceColumn
WHEN NOT MATCHED THEN
    INSERT (targetColumn, [other columns ...]) VALUES (s.sourceColumn, [other values ..]) 
```

引入 MERGE 语句是为了解决像你这样的情况，我建议使用它，它比使用多个 sql 批处理语句的解决方案强大得多，这些语句基本上完成了 MERGE 在一个语句中所做的事情，而不会增加复杂性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T17:23:05.110

您也可以使用光标。假设您要迭代第一个表中的所有记录并用新行填充第二个表，那么这样的方法将是：

```
DECLARE @FirstField nvarchar(100)

DECLARE ACursor CURSOR FOR
SELECT FirstField FROM FirstTable 

OPEN ACursor
FETCH NEXT FROM ACursor INTO @FirstField
WHILE @@FETCH_STATUS = 0
BEGIN

   INSERT INTO SecondTable ( SecondField ) VALUES ( @FirstField )

   FETCH NEXT FROM ACursor INTO @FirstField

END

CLOSE ACursor   
DEALLOCATE ACursor 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T11:14:00.300

MERGE 仅适用于 SQL 2008 而不是 SQL 2005

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-09T17:13:33.107

插入 Test2.dbo.MyTable (MyValue) 从 Test1.dbo.MyTable 中选择 MyValue

这是一个很大的假设。首先，目标数据库为空。其次，其他列可以为空。您可能需要更新。为此，您需要有一个公用密钥。

# c++ - 堵塞的意义何在？

> ID：52357
> 
> 赞同：62
> 
> 时间：2008-09-09T17:08:47.987
> 
> 标签：c++, logging, log4cpp

我一直在想，堵塞有什么意义？据我所知， clog 与 cerr 相同，但具有缓冲功能，因此效率更高。通常stderr和stdout一样，所以clog和cout一样。这对我来说似乎很蹩脚，所以我想我一定是误解了它。如果我有日志消息发送到同一个地方，我有错误消息发送到（可能是 /var/log/messages 中的某些内容），那么我可能不会写太多（所以使用 non 不会丢失太多-缓冲 cerr）。根据我的经验，我希望我的日志消息是最新的（不是缓冲的），所以我可以帮助找到崩溃（所以我不想使用缓冲的阻塞）。显然我应该一直使用 cerr。

我希望能够在我的程序中重定向堵塞。重定向 cerr 会很有用，这样当我调用库例程时，我可以控制 cerr 和 clog 的去向。一些编译器可以支持这个吗？我刚刚检查了 DJGPP，stdout 被定义为 FILE 结构的地址，因此执行“stdout = freopen(...)”之类的操作是非法的。

*   是否可以重定向 clog、cerr、cout、stdin、stdout 和/或 stderr？
*   clog 和 cerr 之间的唯一区别是缓冲吗？
*   我应该如何实现（或找到）更强大的日志记录工具（请链接）？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-09T17:13:03.497

> 是否可以重定向 clog、cerr、cout、stdin、stdout 和/或 stderr？

是的。你想要这个[`rdbuf`](http://www.cplusplus.com/reference/iostream/ios/rdbuf.html)功能。

```
ofstream ofs("logfile");
cout.rdbuf(ofs.rdbuf());
cout << "Goes to file." << endl; 
```

> clog 和 cerr 之间的唯一区别是缓冲吗？

据我所知，是的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-09T17:16:52.350

如果您在 posix shell 环境中（我真的在考虑 bash），您可以将任何文件描述符重定向到任何其他文件描述符，因此要重定向，您可以：

```
$ myprogram 2>&5 
```

将 stderr 重定向到 fd=5 表示的文件。

编辑：再想一想，我更喜欢@Konrad Rudolph 关于重定向的回答。rdbuf() 是一种更连贯且可移植的方法。

至于日志记录，嗯......我从 Boost 库开始，用于所有不在 std 库中的 C++。看哪：[Boost Logging v2](http://www.torjo.com/log2/index.html)

**编辑**：Boost Logging*不是*Boost 库的一部分；它已经过审核，但没有被接受。

**编辑**：2 年后，早在 2010 年 5 月，Boost 确实接受了一个日志库，现在称为[Boost.Log](http://boost-log.sourceforge.net/libs/log/doc/html/index.html)。

当然，还有其他选择：

*   [Log4Cpp](http://log4cpp.sourceforge.net/)（用于 C++ 的 log4j 风格的 API）
*   [Log4Cxx](http://logging.apache.org/log4cxx/index.html)（Apache 赞助的 log4j 风格的 API）
*   [Pantheios](http://pantheios.sourceforge.net/)（已失效？上次我尝试无法在最近的编译器上构建它）
*   [谷歌的 GLog](https://github.com/google/glog)（帽子提示@SuperElectric）

还有 Windows 事件记录器。

还有几篇可能有用的文章：

*   [登录 C++（Dobbs 博士）](http://www.ddj.com/cpp/201804215)
*   [简化的日志记录和跟踪 (Sun)](http://developers.sun.com/solaris/articles/logging.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-05-25T20:00:44.537

由于这里有几个关于重定向的答案，我将添加我最近偶然发现的关于重定向[的这个不错的 gem ：](http://wordaligned.org/articles/cpp-streambufs)

```
#include <fstream>
#include <iostream>

class redirecter
{
public:
    redirecter(std::ostream & dst, std::ostream & src)
        : src(src), sbuf(src.rdbuf(dst.rdbuf())) {}
    ~redirecter() { src.rdbuf(sbuf); }
private:
    std::ostream & src;
    std::streambuf * const sbuf;
};

void hello_world()
{
    std::cout << "Hello, world!\n";
}

int main()
{
    std::ofstream log("hello-world.log");
    redirecter redirect(log, std::cout);
    hello_world();
    return 0;
} 
```

它基本上是一个重定向类，允许您重定向任意两个流，并在完成后恢复它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-08-01T17:53:50.967

## 重定向

关于如何重定向`std::clog`（`std::wclog`），康拉德鲁道夫（Konrad Rudolph）的回答很好。

其他答案告诉您各种可能性，例如使用命令行重定向，例如`2>output.log`. 使用 Unix，您还可以创建一个文件并将另一个输出添加到您的命令中，例如`3>output.log`. 在您的程序中，您必须使用`fd`数字 3 来打印日志。您可以继续`stdout`正常打印`stderr`。Visual Studio IDE 的命令具有类似的功能`CDebug`，可将其输出发送到 IDE 输出窗口。

> `stderr`是一样的`stdout`吗？

这通常是正确的，但在 Unix 下，您可以设置它`stderr`，`/dev/console`这意味着它会转到另一个`tty`（又名终端）。这些天很少使用它。我在 IRIX 上就是这样。我会打开一个单独的 X-Window 并查看其中的错误。

也有很多人向`/dev/null`. 在你写的命令行上：

```
command ...args... 2>/dev/null 
```

## 系统日志

没有提到的一件事，在 Unix 下，你也有`syslog()`.

Linux 下的最新版本（可能还有 Mac OS/X）的功能比以前要多得多。特别是，它可以使用身份和一些其他参数将日志重定向到特定文件（即`mail.log`）。syslog 机制可以在计算机之间使用，因此计算机 A 的日志可以发送到计算机 B。当然，您可以通过各种方式过滤日志，尤其是按严重性。

使用`syslog()`起来也非常简单：

```
syslog(LOG_ERR, "message #%d", count++); 
```

它提供了 8 个级别（或严重性）、一个 la 格式`printf()`以及该格式的参数列表。

`openlog()`以编程方式，如果您第一次调用该函数，您可能会调整一些东西。您必须在第一次调用之前调用它`syslog()`。

正如 unixman83 所提到的，您可能想要使用宏来代替。这样，您可以在消息中包含一些参数，而不必一遍又一遍地重复它们。也许是这样的（参见[Variadic Macro](https://en.wikipedia.org/wiki/Variadic_macro)）：

```
// (not tested... requires msg to be a string literal)
#define LOG(lvl, msg, ...) \
     syslog(lvl, msg " (in " __FILE__ ":%d)", __VA_ARGS__, __LINE__) 
```

您可能还会发现`__func__`有用。

重定向、过滤等是通过创建配置文件来完成的。这是我的 snapwebsites 项目中[的一个示例：](https://github.com/m2osw/snapwebsites/blob/master/snapbounce/conf/02-mail.conf)

```
mail.err /var/log/mail/mail.err
mail.* /var/log/mail/mail.log
& stop 
```

我在下面安装文件`/etc/rsyslog.d/`并运行：

```
invoke-rc.d rsyslog restart 
```

因此`syslog`服务器会处理该更改并将任何与邮件相关的日志保存到这些文件夹中。

*注意：我还必须创建`/var/log/mail`文件夹和文件夹内的文件以确保一切正常（因为否则邮件守护程序可能没有足够的权限。）*

## snaplogger（一个小插件）

我使用过[log4cplus](https://github.com/log4cplus/log4cplus)，从 1.2.x 版开始，它非常好。不过，我对此有三个缺点：

1.  如果我想以某种方式调用它需要我完全清除所有内容，`fork();`它不能`fork();`正常地在调用中存活......（至少在我使用线程的版本中）
2.  `.properties`在我喜欢管理员在不修改原始文件的情况下进行更改的环境中，配置文件 ( ) 不容易管理
3.  它使用 C++03，我们现在是 2019 年……我希望至少有 C++11

正因为如此，尤其是因为第 (1) 点，我编写了自己的版本[snaplogger](https://github.com/m2osw/snaplogger)。不过，这并不完全是一个独立的项目。我使用 snapcpp 环境中的许多其他项目（只需获取 snapcpp 并运行`bin/build-snap`脚本或[从 launchpad 获取二进制文件](https://launchpad.net/%7Esnapcpp/+archive/ubuntu/ppa)要容易得多。）

使用 snaplogger 或 log4cplus 等记录器的优势在于，您通常可以定义任意数量的目标和许多其他参数（例如 提供的严重性级别`syslog()`）。log4cplus 能够将其输出发送到许多不同的地方：文件、系统日志、MS-Windows 日志系统、控制台、服务器等。查看这两个项目中的附加程序以了解可能性列表。这里有趣的因素是任何日志都可以发送到所有目的地。这对于有一个名为 all.log 的文件很有用，所有服务都在其中发送它们的日志。这允许理解某些在并行运行许多服务时使用单独的日志文件并不容易的错误。

这是 snaplogger 配置文件中的一个简单示例：

```
[all]
type=file
lock=true
filename=/var/log/snapwebsites/all.log

[file]
lock=false
filename=/var/log/snapwebsites/firewall.log 
```

请注意，对于该`all.log`文件，我需要一个锁，因此多个编写者不会破坏彼此之间的日志。这`[file]`部分没有必要，因为我只有一个进程（没有线程）。

两者都为您提供了一种添加自己的附加程序的方法。因此，例如，如果您有一个带有输出窗口的 Qt 应用程序，您可以编写一个附加程序来将`SNAP_LOG_ERROR()`调用的输出发送到该窗口。

`snaplogger`还为您提供了一种方法来扩展消息中的变量支持（也称为格式）。例如，我可以使用`${date}`变量插入日期。然后我可以用一个参数来调整它。为了只输出年份，我使用`${date:year}`. 这种可变参数支持也是可扩展的。

`snaplogger`可以按严重性（如系统日志）、正则表达式和*组件*过滤输出。我们有一个`normal`和一个`secure`组件，默认是`normal`. 我希望将发送到`secure`组件的日志写入安全文件。这意味着在一个子目录中，它比大多数管理员可以查看的普通日志受到更多保护。当我运行我的 HTTP 服务时，有时我会发送信用卡的最后 3 位数字等信息。我更喜欢将它们保存在安全日志中。也可能是与密码相关的错误。任何我认为在日志中存在安全风险的东西，真的。同样，组件是可扩展的，因此您可以拥有自己的组件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-07-02T05:02:03.183

关于重定向器类的一点。它需要被正确地销毁，而且只需要一次。析构函数将确保在声明它的函数实际返回时会发生这种情况，并且对象本身永远不会被复制。

为确保它不能被复制，请提供私有复制和赋值运算符：

```
class redirecter
{
public:
    redirecter(std::ostream & src, std::ostream & dst)
        : src_(src), sbuf(src.rdbuf(dst.rdbuf())) {}
    ~redirecter() { src.rdbuf(sbuf); }
private:
    std::ostream & src_;
    std::streambuf * const sbuf_;
    // Prevent copying.                        
    redirecter( const redirecter& );
    redirecter& operator=( const redirecter& );
}; 
```

我通过将 std::clog 重定向到我的 main() 中的日志文件来使用这种技术。为了确保 main() 实际返回，我将 main() 的内容放在 try/catch 块中。然后在我的程序的其他地方，我可能会调用 exit()，我会抛出一个异常。这会将控制权返回给 main()，然后它可以执行 return 语句。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-18T01:39:02.320

## 基本记录器

```
#define myerr(e) {CriticalSectionLocker crit; std::cerr << e << std::endl;} 
```

用作`myerr("ERR: " << message);`或`myerr("WARN: " << message << code << etc);`

非常有效。

然后做：

```
./programname.exe 2> ./stderr.log
perl parsestderr.pl stderr.log 
```

**或者只是手动解析 stderr.log**

我承认这不适用于性能*极其*关键的代码。但无论如何，谁写的。

# javascript - 简单和基本的垃圾邮件减少：检查 Javascript？

> ID：52359
> 
> 赞同：5
> 
> 时间：2008-09-09T17:09:17.173
> 
> 标签：javascript, user-input

我正在尝试减少我们网站上的垃圾邮件。（它实际上是最近的）。

我似乎记得在某处读到垃圾邮件发送者没有在网站上执行 Javascript。

真的吗？如果是这样，那么您是否可以简单地检查是否禁用了 javascript，然后确定它*很可能*是垃圾邮件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-09T17:19:42.063

仍然有很多人在关闭 Javascript 的情况下运行。

或者，我在使用 CSS 阻止垃圾邮件方面取得了不错的成功。基本上，包括一个使用 CSS ( ) 隐藏的输入字段和标签，`display: none;`一旦提交，检查是否在该字段中输入了任何内容。

我通常将该字段标记为垃圾邮件过滤器，并指示*不要*在该字段中放置任何内容，但所有较新的浏览器都会正确隐藏该块。

*   更多：[使用 CSS 对抗垃圾邮件](http://www.modernblue.com/web-design-blog/fighting-spam-with-css/)

[reCAPTCHA](http://recaptcha.net/)也非常容易实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T11:52:25.363

检查[http://kahi.cz/wordpress/ravens-antispam-plugin/](http://kahi.cz/wordpress/ravens-antispam-plugin/)以获得很好的答案

如果放入

```
<noscript><p><label for="websiteurl99f">Please type "e73053": </label><input type="text" name="websiteurl99f" id="websiteurl99f" /></p></noscript>
        <script type="text/javascript">/* <![CDATA[ */ document.write('<div><input type="hidden" name="websiteurl99f" value="e' + '73053" \/><\/div>'); /* ]]> */</script> 
```

所以 javascript 用户什么都看不到，非 js 用户只需输入一个单词

如果垃圾邮件发送者专门针对您，他们不会花很长时间对其进行编码，但对于垃圾邮件发送者的驱动，它应该是好的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T17:16:53.927

您可以检查 - 让 JavaScript在页面加载*后*使用特定值填充隐藏的表单字段。然后，当页面回传到服务器时，检查隐藏表单字段的预期值。如果它不存在，则意味着 JavaScript 没有执行。

至于您是否应该假设它是垃圾邮件完全是另一回事，而且确实没有确定的答案。您可以简单地拥有一个`<noscript>`标签，并让它向用户表明除非他们启用 JavaScript，否则他们的提交不会被接受。

但是，一旦您运行了 JavaScript，垃圾邮件发送者就会为此使用另一种解决方法。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T17:19:59.330

同样，添加一个虚拟字段然后使用 CSS 隐藏它是欺骗机器人的好方法。如果该字段已提交，您就知道可能是非人类完成了该表单。

如果您按照**URL**或**website**的行标记/命名字段，则特别有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T17:16:43.847

我不记得我在哪里看到过这种方法，但垃圾邮件机器人喜欢填写表格。您是否考虑过放置一个用 javascript 隐藏的表单字段（并说如果用户没有 JavaScript，请不要填写此字段）。这样，如果此字段中有某些内容，您可以将其视为垃圾邮件而忽略。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-25T07:55:27.527

你有这个运气吗？我认为一些基于文本的浏览器已经实现了基本的 JavaScript 支持，所以也许垃圾邮件机器人也有？

否则，我正在考虑为没有 JavaScript 的用户使用验证码，并为其他用户使用一些自动 JavaScript 检查。

# .net - 如何确定系统上运行的 .NET 版本是什么？

> ID：52360
> 
> 赞同：13
> 
> 时间：2008-09-09T17:10:12.273
> 
> 标签：.net

确定系统上运行的 .NET 版本有哪些不同的方法（以编程方式和其他方式）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-09T17:13:12.653

直接从源头：

*[如何确定安装了 Microsoft .NET Framework 的版本和服务包级别](http://support.microsoft.com/kb/318785)*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T17:31:15.637

如果您想要使用当前的框架版本**，**那么您可以通过以下方式查看：

```
System.Environment.Version 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-01T20:28:40.077

我发现*[如何检查安装的 .NET Framework 版本](http://www.walkernews.net/2008/05/16/how-to-check-net-framework-version-installed/)*更有用。本质上，打开 Internet Explorer，然后将其粘贴到地址栏中：

```
javascript:alert(navigator.userAgent) 
```

我不知道它是否总是有效，或者它是否完整，但它适用于我的用途，不需要大量额外的阅读，并且无需安装任何额外的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T17:14:15.257

[获取最小的 .NET Framework 下载](http://www.hanselman.com/smallestdotnet/)，它将根据您发送的标头告诉您。它仅适用于 Internet Explorer 或安装了 Firefox 扩展程序。[Hanselman 的博客文章](http://www.hanselman.com/blog/SmallestDotNetOnTheSizeOfTheNETFramework.aspx)中的更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T17:22:47.093

如果您使用的是 IIS6 及更高版本，请打开 IIS 并单击 Web Service Extensions。它将列出安装的每个框架。当然，.NET 3.0 和 3.5 都基于 2.0 框架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-09T17:32:25.057

我会说它不一定会运行。因为您可以在同一台机器上安装 .NET 1.1、2.0、3.0 和 3.5，它们可以完美地并行运行。这意味着您的一个应用程序可以在 1.1 上运行，而另一个 Web 应用程序在 2.0 上运行。

在 IIS（对于 Web 应用程序）中，这很容易，只需转到虚拟目录/应用程序的属性并转到 ASP.NET 选项卡，您应该会看到您实际使用的 .NET 版本（或者更确切地说，是什么ASP.NET 版本，它几乎与 .NET Framework 版本相关联）。

附言。请记住，在 IIS 中，每个应用程序池只能运行 1 个版本的 .NET Framework。因此，如果您尝试使用相同的应用程序池来运行不同版本的框架，您会大吃一惊。解决方案是只创建一个特定于框架版本的应用程序池（即一个池用于所有 1.1 框架，另一个用于 2.0 框架）

# svn - 忽略SVN忽略...可能吗？

> ID：52398
> 
> 赞同：12
> 
> 时间：2008-09-09T17:21:46.037
> 
> 标签：svn

所以我有一些我想在 subversion 存储库中忽略的文件，但我不希望我的忽略模式将其传播到存储库。

换句话说，我在结帐时添加了一些我想保留的私人文件，但它们只对我存在，对每个人都没有意义，所以如果我使用 svn:ignore，这将适用于目录，我要么必须签入（我不想这样做），要么每次执行 svn 状态时都会看到该目录被修改。

所以，理想情况下，我想要一个 .svnignore 文件之类的文件，然后我可以将其标记为忽略自身以及其他一些文件（我认为这在 git 中是一种可能性，例如，使用 .gitignore 文件或任何名称） .

我猜它可能会忽略整个目录（也许），但我怀疑我不会在该目录中看到任何新文件，这也是不可取的。

那么有人知道在颠覆中做到这一点的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T18:44:40.343

Subversion**确实**有一个[每个用户的全局忽略设置](http://svnbook.red-bean.com/en/1.7/svn-book.html#svn.advanced.props.special.ignore)，这听起来像你想要的。查看您的`.subversion`目录（在您的*主*目录中找到）并找到`Miscellany`配置文件的部分。应该有一个名为 global-ignores 的条目。

对于 Windows 用户，此设置可在注册表中的 HKEY_LOCAL_MACHINE\Software\Tigris.org\Subversion 下找到。

更多信息可在[带有 Subversion 的版本控制（SVNBook）中获得](http://svnbook.red-bean.com/en/1.7/svn-book.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T17:24:20.880

我对两件事感到困惑：

*   为什么您有一些您不想签入而其他人*可能*想要签入的文件？如果发生这种情况，您似乎会发生冲突
*   人类意义上的“忽略”对你不起作用吗？

我只是很难看到你不想使用 svn:ignore 的场景......

# object - 两个对象重叠的图案

> ID：52400
> 
> 赞同：4
> 
> 时间：2008-09-09T17:22:31.680
> 
> 标签：object, design-patterns, intersection

我确定这已经被询问和回答了，所以我提前为此道歉，但我没有找到要搜索的正确关键字。搜索“模式”会遇到太多的问答，没有用处。

我正在开发一个回归测试应用程序。我在屏幕上显示一个表单，根据哪个用户登录到应用程序，一些字段应该是只读的。所以我可以抽象一个字段对象，也可以抽象一个用户对象，但是我应该用什么模式来描述这两个概念的交集呢？换句话说，对于字段 1 和用户 A，我应该如何描述该字段应该是只读的？似乎只读（或不是）应该是 Field 类的属性，但正如我所说，它取决于哪个用户正在查看表单。我考虑过一个简单的二维数组（例如 ReadOnly[Field,User] = True），但我想确保我选择了最有效的结构来表示它。

有没有关于这种数据结构的软件设计模式？我是不是把事情复杂化了——二维数组会是最好的方法吗？正如我所说，如果有人提出并回答了这个问题，我深表歉意。我在这里搜索并没有找到任何东西，谷歌搜索也没有找到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T18:01:48.340

表驱动设计可能是有效的。Steve Maguire 在*Writing* *Solid* *Code*中没有几个很好的例子。

它们也是捕获测试的好方法，看[合适](http://fit.c2.com/)。

在您的情况下，例如：

```
Field1ReadonlyRules = {
    'user class 1' : True,
    'user class 2' : False
}

field1.readOnly = Field1ReadonlyRules[ someUser.userClass ] 
```

As an aside you probably want to model *both* users and user classes/roles/groups instead of combining them. A user typically captures *who* (authentication) while groups/roles capture *what* (permissions, capabilities)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T17:26:16.180

乍一看，这听起来更像是您有两种不同类型的用户，并且他们具有不同的访问级别。这可以通过继承（PowerUser、User）或包含为用户设置级别的安全对象或令牌来解决。

如果您通常不喜欢继承，您可以在应用程序上使用状态模式、装饰用户对象（颤抖）或可能为不同的安全级别添加策略模式。但我认为现在还为时过早，我通常不会应用模式，直到我对项目将如何增长和维护有一个明确的想法。

# sql-server - SQL Server 计算当前行和下一行之间日期差异的最佳方法？

> ID：52430
> 
> 赞同：0
> 
> 时间：2008-09-09T17:33:28.737
> 
> 标签：sql-server, datediff

我有以下粗略的结构：

```
Object -> Object Revisions -> Data 
```

数据可以在多个对象之间共享。

我想要做的是清除旧的对象修订。我想保留第一个、活动的和广泛的修订，以便保留一段时间内的最后一次更改。数据可能会在 2 天内发生很大变化，然后单独放置几个月，所以我想保留更改开始之前的最后一次修订和新集的结束更改。

我目前正在使用光标和临时表来保存更改之间的 ID 和日期，这样我就可以选择要摆脱的低悬的果实。这意味着使用@LastID、@LastDate、更新和插入临时表等...

在不使用游标和临时表的情况下，是否有更简单/更好的方法来计算初始结果集中当前行和下一行之间的日期差异？

我在 sql server 2000 上，但会对 2005、2008 的任何新功能感兴趣，这也可以帮助解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T17:49:09.887

这是示例 SQL。如果您有一个 Identity 列，则可以使用它来代替“ActivityDate”。

```
SELECT DATEDIFF(HOUR, prev.ActivityDate, curr.ActivityDate)
  FROM MyTable curr
  JOIN MyTable prev
    ON prev.ObjectID = curr.ObjectID
  WHERE prev.ActivityDate =
     (SELECT MAX(maxtbl.ActivityDate)
        FROM MyTable maxtbl
        WHERE maxtbl.ObjectID = curr.ObjectID
          AND maxtbl.ActivityDate < curr.ActivityDate) 
```

我可以删除“prev”，但假设您需要其中的 ID 来删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T12:32:17.513

如果标识列是连续的，您可以使用这种方法：

`SELECT curr.*, DATEDIFF(MINUTE, prev.EventDateTime,curr.EventDateTime) Duration FROM DWLog curr join DWLog prev on prev.EventID = curr.EventID - 1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T18:22:09.353

嗯，有趣的挑战。如果您使用新到 2005 年的数据透视功能，我认为您可以在没有自加入的情况下完成此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T19:34:19.867

到目前为止，这是我所得到的，我想在接受答案之前再给一点时间。

```
DECLARE @IDs TABLE 
(
  ID int , 
  DateBetween int
)

DECLARE @OID int
SET @OID = 6150

-- Grab the revisions, calc the datediff, and insert into temp table var.

INSERT @IDs
SELECT ID, 
       DATEDIFF(dd, 
                (SELECT MAX(ActiveDate) 
                 FROM ObjectRevisionHistory 
                 WHERE ObjectID=@OID AND 
                       ActiveDate < ORH.ActiveDate), ActiveDate) 
FROM ObjectRevisionHistory ORH 
WHERE ObjectID=@OID

-- Hard set DateBetween for special case revisions to always keep

 UPDATE @IDs SET DateBetween = 1000 WHERE ID=(SELECT MIN(ID) FROM @IDs)

 UPDATE @IDs SET DateBetween = 1000 WHERE ID=(SELECT MAX(ID) FROM @IDs)

 UPDATE @IDs SET DateBetween = 1000 
 WHERE ID=(SELECT ID 
           FROM ObjectRevisionHistory 
           WHERE ObjectID=@OID AND Active=1)

-- Select out IDs for however I need them

 SELECT * FROM @IDs
 SELECT * FROM @IDs WHERE DateBetween < 2
 SELECT * FROM @IDs WHERE DateBetween > 2 
```

我正在寻找扩展它，以便我可以保持最多这么多的修订，并修剪旧的，同时仍然保持第一个、最后一个和活动的。通过 select top 和 order by 子句应该很容易，嗯...并将 ActiveDate 折腾到临时表中。

我得到了彼得的例子，但把它修改成了一个子选择。我搞砸了两者，sql跟踪显示子选择执行较少的读取。但它确实有效，当我的代表足够高时，我会投票给他。

# c++ - 如何使用 OpenGL、SDL 和 C++ 绘制文本？

> ID：52431
> 
> 赞同：10
> 
> 时间：2008-09-09T17:33:45.803
> 
> 标签：c++, opengl, sdl

[我听说过我在这里](http://www.gamedev.net/reference/articles/article1953.asp)读到的 SDL_TFF，但我不明白我应该如何连接 TrueType2 库。

也许那里有更好的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T14:57:34.753

我遇到了这个关于在 SDL 扩展中链接新 SDL 的[优秀指南，您可能会发现它很有用。](http://lazyfoo.net/SDL_tutorials/lesson03/index.php)

也就是说，当我遇到您的问题时，我最终选择了[FTGL](http://ftgl.sourceforge.net/docs/html/)，因为[SDL-ttf 生成 SDL-Surface 并在其上呈现字体的方式](http://wiki.gamedev.net/index.php/SDL_ttf:Tutorials:Basic_Font_Rendering)在我的情况下过于复杂。不过，您的情况可能并非如此

# c# - c#中的文字哈希？

> ID：52438
> 
> 赞同：30
> 
> 时间：2008-09-09T17:39:15.370
> 
> 标签：c#, ruby, hashtable, literals

我一直在做 c# 很长一段时间，从来没有遇到过一种简单的方法来新建一个哈希。

我最近熟悉了哈希的 ruby​​ 语法，并且想知道，有没有人知道一种将哈希声明为文字的简单方法，而无需执行所有的 add 调用。

```
{ "whatever" => {i => 1}; "and then something else" => {j => 2}}; 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-09T17:44:11.783

如果您使用的是 C# 3.0 (.NET 3.5)，那么您可以使用集合初始化程序。它们不像 Ruby 那样简洁，但仍然是一个改进。

此示例基于[MSDN 示例](http://msdn.microsoft.com/en-us/library/bb531208.aspx)

```
var students = new Dictionary<int, StudentName>()
{
    { 111, new StudentName {FirstName="Sachin", LastName="Karnik", ID=211}},
    { 112, new StudentName {FirstName="Dina", LastName="Salimzianova", ID=317, }},
    { 113, new StudentName {FirstName="Andy", LastName="Ruth", ID=198, }}
}; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-09T18:11:44.760

当我无法使用 C# 3.0 时，我会使用一个帮助函数将一组参数转换为字典。

```
public IDictionary<KeyType, ValueType> Dict<KeyType, ValueType>(params object[] data)
{
    Dictionary<KeyType, ValueType> dict = new Dictionary<KeyType, ValueType>((data == null ? 0 :data.Length / 2));
    if (data == null || data.Length == 0) return dict;

    KeyType key = default(KeyType);
    ValueType value = default(ValueType);

    for (int i = 0; i < data.Length; i++)
    {
        if (i % 2 == 0)
            key = (KeyType) data[i];
        else
        {
            value = (ValueType) data[i];
            dict.Add(key, value);
        }
    }

    return dict;
} 
```

像这样使用：

```
IDictionary<string,object> myDictionary = Dict<string,object>(
    "foo",    50,
    "bar",    100
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-13T05:45:57.093

由于可以像这样指定 C# 3.0 (.NET 3.5) 哈希表文字：

```
var ht = new Hashtable {
    { "whatever", new Hashtable {
            {"i", 1} 
    } },
    { "and then something else", new Hashtable { 
            {"j",  2}
    } }
}; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-12-08T00:40:54.330

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Dictionary
{
    class Program
    {
        static void Main(string[] args)
        {
            Program p = new Program();                
            Dictionary<object, object > d = p.Dic<object, object>("Age",32,"Height",177,"wrest",36);//(un)comment
            //Dictionary<object, object> d = p.Dic<object, object>();//(un)comment

            foreach(object o in d)
            {
                Console.WriteLine(" {0}",o.ToString());
            }
            Console.ReadLine();    
        }

        public Dictionary<K, V> Dic<K, V>(params object[] data)
        {               
            //if (data.Length == 0 || data == null || data.Length % 2 != 0) return null;
            if (data.Length == 0 || data == null || data.Length % 2 != 0) return new Dictionary<K,V>(1){{ (K)new Object(), (V)new object()}};

            Dictionary<K, V> dc = new Dictionary<K, V>(data.Length / 2);
            int i = 0;
            while (i < data.Length)
            {
                dc.Add((K)data[i], (V)data[++i]);
                i++;    
            }
            return dc;            
        }
    }
} 
```

# c - 是否有类似于 C++ 的 Boost 库的 C 库资源？

> ID：52445
> 
> 赞同：22
> 
> 时间：2008-09-09T17:44:26.993
> 
> 标签：c

我不记得遇到过任何与 C++ 的 Boost 库一样广泛的 C 语言。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-30T13:15:50.063

你可以看看 glib。它提供了很多有趣的东西，比如容器、unicode 支持、线程......

看看[它的文档](http://library.gnome.org/devel/glib/stable/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-09T18:41:51.210

我从来没有见过任何东西。确实，C++ 模板是 STL 和许多提升的支持技术，而 C 没有它们。我见过很多用于图像处理、3D 图形、网络等方面的 C 接口库，但从来没有像 boost 这样的真正的通用库。不过，您可以找到类似于 boost 部分的部分 - 线程库、字符串库等。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-30T13:03:16.287

APR（Apache Portable Runtime library）是构建 Apache http 守护程序的基础，具体取决于您要执行的操作

[http://apr.apache.org/](http://apr.apache.org/)

对于 GUI，有 wxWidgets（以前的 wxWindows）

[http://www.wxwidgets.org/](http://www.wxwidgets.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-23T22:04:13.373

Glib 确实以各种 unicode、字符串类型的形式对其进行了部分补偿。如果您添加 Gobject，您可以获得一些对象编程甚至一些垃圾收集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T13:43:47.597

有时会提到 ACE（自适应通信环境）。这不是一个苹果对苹果的比较。Boost 提供了更多的“基本构建块”，而 ACE 提供了更多面向电信产品的紧密集成框架。我已经广泛使用了这两种方法，我发现 Boost 非常优越。Boost 的一大优势是它的许多特性将出现在即将到来的 C++0x 标准的 STL 扩展中（例如，参见[http://en.wikipedia.org/wiki/Technical_Report_1](http://en.wikipedia.org/wiki/Technical_Report_1)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-16T02:47:36.913

或者您可以查看 ccan [http://ccan.ozlabs.org/](http://ccan.ozlabs.org/)

但是不，真的没有任何完整的包，glib 最接近

# visual-studio - 从 Visual SourceSafe 切换到 CVS：Visual Studio 中丢失了哪些功能？

> ID：52447
> 
> 赞同：2
> 
> 时间：2008-09-09T17:45:32.313
> 
> 标签：visual-studio, cvs, visual-sourcesafe

我的公司正在使用[Visual SourceSafe](http://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe) (VSS) 和 Visual Studio 2005（即将于 2008 年推出）。他们想切换到[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)，但开发人员不想失去我们与 VSS 和 Visual Studio 的集成。

我知道有 CVS 插件，但是 CVS 丢失了哪些功能（如果有的话）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T17:49:16.843

如果你要换，为什么不换更好的呢？CVS 与最先进的版本控制相距甚远。像 Subversion 或 Vault 这样更现代的系统不仅提供了更好的功能，而且还可以让您更好地集成 Visual Studio。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-09T17:53:28.127

对 VSS 大喊丢失源代码等。但说真的，它是一个非常不同的模型（[乐观锁定](http://en.wikipedia.org/wiki/Optimistic_replication#Examples)），所以你可能会在最初的一段时间内失去一些生产力。如果您使用的是 Visual Studio 2008（我拥有的所有 CVS 插件），我可能会考虑使用[TortoiseCVS](http://en.wikipedia.org/wiki/TortoiseCVS)和“在 Windows 资源管理器中打开文件夹”或[Visual Studio Explorer](http://www.mindscape.co.nz/blog/?p=199)插件而不是 CVS 插件尝试有严重的功能问题或严重的稳定性问题）。

VSS 确实是一个糟糕的源代码控制系统，从长远来看，转向现代风格（乐观锁定）的源代码控制系统将是一个巨大的福音。不过，您可能想一起跳过 1990 年代，转而使用[Subversion](http://en.wikipedia.org/wiki/Apache_Subversion) / [Git](http://en.wikipedia.org/wiki/Git_%28software%29) / [Mercurial](http://en.wikipedia.org/wiki/Mercurial)并进入 2000 年代。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:31:13.230

如果您必须切换到 CVS（Subversion 或分布式 VCS 会更好），那么可以在[此处](http://code.google.com/p/vsstocvs/)找到我们用来迁移和保留更改历史记录的脚本。

我们对 CVS 非常满意，尽管我们不使用 Visual Studio 集成，因为我们发现[TortoiseCVS](http://www.tortoisecvs.org/)和[SmartCVS](http://www.syntevo.com/smartcvs/index.html)更好。但是，如果我现在要切换，我会查看[Git](http://en.wikipedia.org/wiki/Git_%28software%29)或[Mercurial](http://en.wikipedia.org/wiki/Mercurial)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T12:51:37.647

我的黑客如下：

我主要是一名 Java 开发人员，我使用 Eclipse/RAD。对 CVS 的支持非常好，并且非常易于使用。

对于我所做的 C# 工作，我试图为 Visual Studio 找到一个 CVS 插件，但对我找到的那个不满意。最后，我决定使用 Eclipse 来处理我的 C# 项目的版本控制。

步骤：

1.  在 Eclipse 中创建一个简单的项目
2.  打开VS并将项目保存到Eclipse创建的目录中
3.  返回Eclipse，按**F5**刷新项目
4.  共享项目（即添加到CVS）
5.  将**.sln**添加到 Eclipse 设置中的外部处理文件列表中
6.  现在可以通过单击 .sln 文件直接从 Eclipse 打开 VS，该项目可以在 VS 中运行。从 VS 退出后，项目必须在 Eclipse 中刷新，并且可以与 CVS 同步

虽然我还没有使用过 Subversion 插件，但我想它会以类似的方式工作。

这个解决方案对我很有效，尤其是当我大部分时间都花在 Eclipse 上时。

我确实尝试过使用 TortoiseCVS，但发现它使用起来很棘手。Eclipse 是免费的，而且 CVS 界面非常好用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:54:43.130

Visual Studio 在 CVS 和 SVN 的 IDE 中集成不好。那些免费的不好用。我使用[Tortoise](http://en.wikipedia.org/wiki/TortoiseSVN)（在 Visual Studio 之外），它工作正常。如果你想要 Visual Studio 中的东西，你可以检查 not free plugin 或使用[TFS](http://en.wikipedia.org/wiki/Team_Foundation_Server)。

# c# - IQuery NHibernate - 它必须是一个列表吗？

> ID：52449
> 
> 赞同：4
> 
> 时间：2008-09-09T17:46:33.980
> 
> 标签：c#, .net, nhibernate

如果我正在做一个对象，我可以把它作为一个对象返回吗

```
Select OneItem from Table Where OtherItem = "blah"? 
```

有一个更好的方法吗？

我正在构建一个构造函数以根据其名称而不是其 ID 返回一个对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T17:56:06.420

`query.UniqueResult<T>()`只返回一个**T**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T01:05:17.973

如果有不止一个潜在的结果，那么`query.FirstResult()`可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T13:27:12.300

或者使用 LINQ 你可以有`query.First()`, `query.SingleOrDefault()`,`query.Min(predicate)`等等...

# sql-server - 升级 MS-SQLServer 版本时，如何查找实体并将其与证书分离？

> ID：52460
> 
> 赞同：1
> 
> 时间：2008-09-09T17:51:36.900
> 
> 标签：sql-server

在将 MS-SQL Server 2005 Express Edition 升级到 MS-SQL Server 2005 Enterprise Edition 的最后阶段，我遇到了这个错误：

> 无法删除证书，因为一个或多个实体已使用它进行签名或加密。要继续，请更正问题...

那么，**如何找到并解耦使用此证书签名/加密的实体，以便我可以删除证书并继续升级？**

我也有点期待/假设升级设置将提供一个新证书并将那些以前的实体与它重新耦合，否则我将不得不在设置后强行这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T20:58:30.707

Microsoft 论坛有以下代码片段来删除证书：

```
use msdb   
BEGIN TRANSACTION
declare @sp sysname
declare @exec_str nvarchar(1024)    
declare ms_crs_sps cursor global for select object_name(crypts.major_id) from sys.crypt_properties crypts, sys.certificates certs where crypts.thumbprint = certs.thumbprint and crypts.class = 1 and certs.name = '##MS_AgentSigningCertificate##'    
open ms_crs_sps    
fetch next from ms_crs_sps into @sp    
while @@fetch_status = 0  
begin    
if exists(select * from sys.objects where name = @sp) begin print 'Dropping signature from: ' + @sp set @exec_str = N'drop signature from ' + quotename(@sp) + N' by certificate [##MS_AgentSigningCertificate##]'   
Execute(@exec_str)
if (@@error <> 0)
begin
declare @err_str nvarchar(1024)
set @err_str = 'Cannot drop signature from ' + quotename(@sp) + '. Terminating.'
close ms_crs_sps
deallocate ms_crs_sps
ROLLBACK TRANSACTION
RAISERROR(@err_str, 20, 127) WITH LOG
return
end
end
fetch next from ms_crs_sps into @sp
end
close ms_crs_sps
deallocate ms_crs_sps
COMMIT TRANSACTION
go 
```

[http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3876484&SiteID=17](http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3876484&SiteID=17)

我没有尝试过该脚本，因此请在尝试之前备份您的数据和系统并在此处更新结果。

# asp.net - Visual Web Developer Express 和 .NET 等

> ID：52469
> 
> 赞同：1
> 
> 时间：2008-09-09T17:55:39.137
> 
> 标签：asp.net, visual-studio

我来自开源世界，并且有兴趣让 ASP.NET 有所作为。但是在许可方面，我在将工具与平台本身分开时遇到了一些麻烦。我已经下载了 Visual Web Developer 2008 Express，但不确定这与功能齐全的 Visual Studio 许可证之一有何不同——以及我的 Express 许可证是否会阻止我使用 ASP.NET 的所有功能。

Visual Studio 许可证只是一个 IDE，还是包含 Express 许可证不可用的 .NET 片段？IIS 和 SQL Server 等其他工具呢？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T18:00:45.660

.net SDK 中提供了所有 .net，因此理论上您根本不需要 Visual Studio。

现在，有些事情 Express 不会做。例如，数据库设计器不是很全面，添加不同的远程数据库不可能或几乎不可能。不过，在代码中你可以连接到所有东西。

也没有远程调试器，不支持创建设置文件（嗯，无论如何都不适用于 ASP.net），没有真正的发布网站功能（尽管可以[手动添加，](http://blogs.msdn.com/b/jamesche/archive/2007/09/27/automating-aspnet-compiler-in-visual-web-developer.aspx)因为它只是 SDK 工具的前端） ，没有集成单元测试（微软[喜欢威胁](http://weblogs.asp.net/nunitaddin/archive/2007/05/30/microsoft-vs-testdriven-net-express.aspx)添加它的人）等。

如需完整比较，请参见此处：

[Visual Studio 2008 版本](http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx)

但正如所说：.net 的功能全部在 SDK 中，Visual Studio 只是让它更容易使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T18:01:13.787

Visual Studio 只是一个 IDE，如果您愿意，您可以使用 SDK 和记事本进行所有 .NET 开发。事实上，以这种方式学习它有一些话要说，这样你就可以更好地理解这些部分是如何组合在一起的！

Microsoft 有一个可用的[版本比较矩阵](http://msdn.microsoft.com/en-us/vs2005/aa700921.aspx)，因此您可以准确查看每个版本包含的内容。

IIS 是一个 Windows 组件，被认为是操作系统的一部分，没有其他东西可以购买。

SQL Server 有多种版本，SQL EXpress 可以免费使用，虽然与您购买的版本相比有限，但对于开始使用 ASP.Net 来说已经绰绰有余了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T18:01:24.113

Visual Studio 是 IDE，不包括平台。

IIS 和 SQL Server 是独立的产品。IIS 可作为 Windows 安装的一部分使用，版本因您使用的 Windows 版本而异。

SQL Server 也有一个 express 产品，它的功能不如 SQL Server 的完整版，但它仍然非常有价值和有用，尤其是用于学习目的。

您可以从 asp.net 上的免费教程中学到很多东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T18:02:25.250

Visual Studio 只是 IDE。理论上，您可以在记事本中创建每个文件并仅使用 .net 框架手动编译。

IIS 是一种操作系统功能，SQL Server 具有不同的风格和不同的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T18:03:15.453

[SharpDevelop](http://sharpdevelop.net/OpenSource/SD/)是用于 C# 和 VB.net 的开源 IDE

# asp.net - ASP.NET ObjectDataSource 自动绑定到中继器 - 可能吗？

> ID：52485
> 
> 赞同：2
> 
> 时间：2008-09-09T18:04:24.730
> 
> 标签：asp.net, repeater, bind, objectdatasource

我有一个问题类：

```
class Question {
    public int QuestionNumber { get; set; }
    public string Question { get; set; }
    public string Answer { get; set; }
} 
```

现在，我通过 ObjectDataSource 使这些 ICollection 可用，并使用绑定到 DataSource 的 Repeater 显示它们。我使用**<%#Eval("Question")%>**来显示问题，并使用 TextBox 和**<%#Bind("Answer")%>**来接受答案。

如果我的 ObjectDataSource 返回三个 Question 对象，那么我的 Repeater 会显示三个问题，每个问题后面都有一个 TextBox 供用户提供答案。

到目前为止效果很好。

现在我想获取用户的响应并将其放回相关的问题类中，然后我会坚持下去。

当然，框架应该为我处理所有这些？我已经使用了 Bind 方法，我已经指定了一个 DataSourceID，我已经在我的 ObjectDataSource 类中指定了一个 Update 方法，但似乎没有办法真正启动整个事情。

我尝试在调用 MyDataSource.Update() 后面的代码中添加一个命令按钮，但它尝试在没有参数的情况下调用我的 Update 方法，而不是它期望的 Question 参数。

肯定有一种简单的方法可以在很少或没有代码隐藏的情况下实现所有这些吗？

似乎所有的碎片都在那里，但是缺少一些胶水将它们粘在一起。

帮助！

安东尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T18:16:42.237

您必须处理回发事件（按钮单击或其他），然后枚举转发器项目，如下所示：

```
foreach(RepeaterItem item in rptQuestions.Items)
{
   //pull out question
   var question = (Question)item.DataItem;
   question.Answer = ((TextBox)item.FindControl("txtAnswer")).Text;

   question.Save() ?  <--- not sure what you want to do with it
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T19:41:59.740

bind 方法实际上并不适用于转发器，它更适用于 formview 或 gridview，您只编辑列表中的一个项目，而不是列表中的每个项目。

在两者上，您都单击一个编辑按钮，然后为您提供绑定控件（使用绑定绑定），然后点击保存链接，该链接自动将项目保存回您的数据源，而无需任何代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T19:06:37.937

那么如果我必须在回发时手动绑定所有内容，那么 Bind 方法（而不是 Eval 方法）有什么意义呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T09:53:46.837

Ben：尝试过之后，item.DataItem 总是为空，根据下面的帖子，它不是为这样使用而设计的：

[http://www.netnewsgroups.net/group/microsoft.public.dotnet.framework.aspnet/topic4049.aspx](http://www.netnewsgroups.net/group/microsoft.public.dotnet.framework.aspnet/topic4049.aspx)

那么我到底该如何手动绑定它呢？

# emacs - 避免获得“Emacs Pinky”的最佳方法是什么？

> ID：52492
> 
> 赞同：41
> 
> 时间：2008-09-09T18:08:44.363
> 
> 标签：emacs, keyboard

我刚开始使用 GNU Emacs 作为我的文本编辑器，我担心会因为使用 Emacs 时需要用我的小指不断按下控制键而受到“ [Emacs Pinky ”的困扰。](http://en.wikipedia.org/wiki/Emacs#Emacs_pinky)我怎样才能避免可能出现这种类型的重复性劳损？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-09T18:12:08.347

制作`caps lock`另一个控制键是一个不错的起点。投资符合人体工程学的键盘。一些 emacs 用户甚至会为了控制和元...

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-01-20T02:09:20.090

配置使空格键兼作*空格*和控件；当`space`单独按下时，作为空格，并且与其他人一起按下时，作为`ctrl`。所以`Space`+`x`被视为`Ctrl`+ `x`。

你可以在 Windows 中使用 AutoHotKey，在 Linux 中使用 Xorg 中的“ [at-home-modifier](https://gitlab.com/at-home-modifier/at-home-modifier-evdev/wikis/home) ”。（X，但仅限 Linux。）您可以在 Mac中使用[Karabiner](https://pqrs.org/osx/karabiner/)（以前称为*keyremap4macbook ）。*（其实我**是**at-home-modifier的作者。=）

如果您的键盘周围有许多键，您可以做更多的事情，例如日文键盘：[日文键盘 http://www.owltech.co.jp/products/keyboard/KB86STD/KB86STD_B-320.jpg](http://www.owltech.co.jp/products/keyboard/KB86STD/KB86STD_B-320.jpg)

我的底行基本上是`Esc``BS``Space``Enter``Tab`，但是当用作修饰符时，它是`Alt``Shift``Ctrl``Shift``Alt`. （例如，如果你先按住`Esc`空格，然后是`Alt`+ `Space`，但空格后跟`Esc`，是`Ctrl`+ `Esc`。如果你按`Space`,`Esc`和`x`，然后是`ctrl`+ `alt`+ `x`。）*都*可以用*拇指*按下。您可以从 amazon.com 订购日语键盘。你不必说日语。

这非常方便。例如，对于 firefox（对不起，不是 emacs），聚焦一个链接，然后按 Ctrl + Enter；然后它将在新选项卡中打开。（同时按下 Shift 键，它会切换到新选项卡，而不是停留在当前选项卡上。）

（上图是[at-home-modifier作者](https://stackoverflow.com/users/780703/teika-kazura)使用的那张。不过，制造商不再销售这种型号了。）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-04-20T12:19:39.727

[替代文字 http://www.userfriendly.org/cartoons/archives/07sep/uf010710.gif](http://www.userfriendly.org/cartoons/archives/07sep/uf010710.gif)

[@熊嘉米奥夫](http://ars.userfriendly.org/cartoons/?id=20070910)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-15T22:56:48.440

来个脚踏板！（我有一个运动。）在你这样做之后，取消映射控制和大写锁定，这样你就可以强迫自己使用你的脚。

（仅供参考，重新映射大写锁定会有所帮助，但在一天内进行了足够的 emacsing 之后，这将不是一个完整的解决方案。）

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-01-10T15:44:21.367

看在上帝的份上 - 使用另一个文本编辑器！如果是需要**脚踏板**才能正常工作的东西，那么……好吧……坦率地说，我无语了。有许多功能强大的现代文本编辑器，它们不需要你记住大量的神秘击键或购买花哨的硬件。

你知道，我可以理解和接受很多东西，但是一个简单的文本编辑器的**脚踏板**确实是我划清界限的地方。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-06-03T19:51:54.043

我一直很好奇为什么这么大的程序员、作家、极客等社区还没有找到超级简单有效的解决方案。简单： 1）取一小张纸，把它做成纸球；2) 用 scotch 将它粘在你的左 ctrl 键上（暂时将其从原处移除）；3）书写时，用左手掌侧按那个键——现在这个键比其他键高，你可以轻松做到。这样你就不需要购买 uber ergo 键盘，或者将 ctrl 键重新映射到 capslock （无论如何你最终都会用你的小指推动）......

这么多关于这样一个小问题的讨论。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-09T18:40:54.003

重新映射`Left-Ctrl`，`Caps-Lock`因此它们应该在哪里：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout] "Scancode Map"=hex:00,00,00,00,00,00,00,00,03,00,00,00,3a,00,1d,00,1d,00,3a,00,00,00,00,00 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-06-04T18:19:01.500

我完全同意重新映射大写锁定解决方案，这很有帮助。为了更进一步，我尝试并喜欢[Ergoemacs 键绑定](http://code.google.com/p/ergoemacs/)。该项目正在积极开发中，并得到很好的支持。我个人不使用它，因为它没有与 Mac OS X 集成（一些 EMACS 键集成在 Cocoa 中），尽管似乎有人发布了一个带有 Ergoemacs 键绑定的 inputrc 文件。我一直在玩的另一个技巧是启用 StickyKeys。它在许多平台上得到支持，并缓解了一些特定于和弦的问题（而不是过度使用）：显然在 emacswiki 上推荐它：[http ://www.emacswiki.org/emacs/StickyModifiers](http://www.emacswiki.org/emacs/StickyModifiers)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2012-09-09T21:04:30.197

我将出色的[键和弦模式](http://emacswiki.org/emacs/key-chord.el)用于常见动作。你可以给它功能或按键序列来调用。

为了确保我不会过多地妨碍正常打字，我生成了字母统计数据以找到好的关键和弦。我将它们与[我的默认和弦](https://bitbucket.org/ArneBab/.emacs.d/src/fa39f444b3b3/lisplets/stenochords.el)一起录制。

除了更方便的命令调用之外，我还有用于插入诸如

```
Best wishes,
Arne 
```

我讨厌没有那个写电子邮件☺</p>

我还对flyspell之类的东西使用[控制锁定模式，我一直需要控制。](http://www.emacswiki.org/emacs/ControlLock)那是使用真正的 emacs 快捷方式进行模态编辑。

我用得最多的和弦是

```
; buffer actions
(key-chord-define-global "vg"     'eval-region)
(key-chord-define-global "vb"     'eval-buffer)
(key-chord-define-global "cy"     'yank-pop)
(key-chord-define-global "cg"     "\C-c\C-c")
(key-chord-define-global "äü"     'control-lock-toggle)

; frame actions
(key-chord-define-global "xo"     'other-window);
(key-chord-define-global "x1"     'delete-other-windows)
(key-chord-define-global "x0"     'delete-window)
(defun kill-this-buffer-if-not-modified ()
  (interactive)
  ; taken from menu-bar.el
  (if (menu-bar-non-minibuffer-window-p)
      (kill-buffer-if-not-modified (current-buffer))
    (abort-recursive-edit)))
(key-chord-define-global "xk"     'kill-this-buffer-if-not-modified)

; file actions
(key-chord-define-global "bf"     'ido-switch-buffer)
(key-chord-define-global "cf"     'ido-find-file)
(key-chord-define-global "zs"     "\C-x\C-s")
(key-chord-define-global "vc"     'vc-next-action) 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-03-30T13:34:28.990

首先，我想指出建议不要使用 Emacs，因为默认键绑定可能不适合所有人，这没有任何意义。Emacs 是有史以来最可配置的“文本编辑器”，因此，当然，像键映射这样的琐碎事情是完全可配置的。

关于“Emacs pinky”问题，我注意到有几个人在他们的*.emacs*中有“anti-Emacs-pinky”键绑定，比如这里的用户“Paul Nathan”（我输入这个是 17.5k 代表）：

[emacs 中有哪些好的自定义键绑定？](https://stackoverflow.com/questions/5682631/what-are-good-custom-keybindings-in-emacs)

然后众所周知，许多人更喜欢*vi*方式和用户 Emacs 的 viper 模式。

我认为 Emacs 的主要问题是，默认情况下，过度依赖 CTRL，更具体地说是 Cx 和 Cf / Cb。这三个真的很糟糕，因为这意味着，恕我直言，痛苦的手指扭曲。

所以对我来说，首先必须定义问题：问题是什么？问题是默认情况下对 CTRL 的过度依赖，事实上 CTRL 通常在大多数键盘上的位置很糟糕，而且大多数键盘（我估计超过 99.9% 曾经生产的所有键盘）都是垃圾。

那么*我的*解决方案是什么？

*   我使用一个好的机械键盘，我做触摸式。对此非常认真的人可能会为一个非常好的分体式和矩阵式键盘（如 Kinesis Advantage）掏出美元...因为从人体工程学的角度来看，分体式**和**矩阵式是唯一有意义的键盘（这个甚至不公开辩论）。可悲的是，我已经打字三年了，无法适应矩阵布局，所以我使用的是旧的（有缺陷的）交错键盘。如果您要使用交错键盘，至少要使用一个具有良好开关的键盘（例如 IBM Model M 或 Cherry MX 开关中的屈曲弹簧或 Happy Hacking Keyboard Pro 中的 Topres）。准备好花 500 美元甚至更多，如果您希望找到一个拆分 +“机械”交错的产品，例如 Cherry MX-5000 (*) 或 IBM M15。

*所以：简而言之，如果您对此非常认真，请选择 Kinesis Advantage（他们使用的是 Cherry MX 开关，如果我没记错的话，您甚至可以选择您的特定开关）。*

如果像我一样，遗憾地因为它们“太不同”而无法适应这些出色的键盘，那么请选择一个好的“机械”键盘。任何在打字时不允许“触底”的键盘都可以节省您的手指关节。经过数十年的编程后有所帮助。

如果您不想走“机械”路线并认为橡胶圆顶是很好的键盘（我认为它们是垃圾，但每个都是偏好），那么至少选择一个好的橡胶圆顶。MS 的 Ergo 4K 将是一个不错的选择（再说一次：它是橡胶圆顶，所以对我来说它是一个破坏手指的垃圾，但这是一个品味问题）。

*   使用好的键盘后，将 CAPS-LOCK 重新映射到 CTRL。可以在任何操作系统上完成。这很简单，并且有很多关于这个主题的链接。

*   重新映射 Emacs 的键以停止过度依赖 CTRL。首先 CTRL-x 很糟糕。它真的必须是有史以来最糟糕的捷径。但是您可以将 ctl-x-map 重新映射到您想要的内容。我在重新映射次要模式下执行此操作：

    (define-key my-keys-minor-mode-map (kbd "C-,") ctl-x-map)

C-，可能不适合你：选择别的东西......

然后是光标移动的问题。我认为这是“文本编辑器”的一大亮点。即使倾向于使用所有优秀的 Emacs 函数来快速移动文本缓冲区而不是“移动光标”，我仍然需要经常“手动”移动光标。

Cf / Cb 必须是移动光标的两个最愚蠢的快捷方式。

我使用 M-{i,j,k,l}。所以人们更喜欢 {hjkl} 而不是 {ijkl} 但我喜欢 {ijkl} 因为它再现了倒 T 箭头。我也喜欢这样一个事实，作为一个触摸打字员，当你在你的主行时，你已经在 {jkl} 上有了三个手指。没有疯狂的手指运动来达到“f”或“b”：没有意义。

最后但同样重要的是：当您不打字时，**请将**手指放在键盘上。为此，您当然需要一个带有良好开关的键盘，当您将按键放在键盘上时，它有足够的电阻不会激活。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-09T18:14:04.630

微软自然键盘对我来说非常非常好。我每天用 emacs 做 10 多个小时，没有任何问题。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-06T14:17:41.497

我的建议是**尝试使用您的拇指**在触手可及的情况下按下修饰键（控制、alt）。在空格键较短的键盘上，即使拇指不向内弯曲，也可以按 Alt (Meta)。您可以将例如右 Alt 重新映射到 Control，这样就可以方便地访问 Control 和 Alt。这在 MS 自然键盘上也是可能的。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-10T15:29:38.620

考虑一个[Kinesis Contoured](https://stackoverflow.com/questions/687/keyboard-for-programmers#2551)键盘。我花了大约一个月的时间来熟悉我的速度，现在我认为它是理想的 Emacs 键盘，即使没有脚踏板。

不是开玩笑。我用食物踏板订购了我的第一个，但发现我实际上并不能充分协调我的脚和手的时间，以充分利用它作为修饰键。有一段时间我用它来切换集成数字键盘，但当我意识到我没有使用它时我放弃了它，因为 Kinesis 上的数字行很容易够到。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-08-29T16:59:34.920

此处尚未提及的一种解决方案是使用**双手**进行组合键。

例如，假设您要按 <CTRL-K>。在 QWERTY 键盘上，<K> 位于右侧，因此**左手按 <CTRL>，****右手**按<K> 。一旦你习惯了这个系统，它就可以正常工作。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-09T19:39:12.727

根据@Alasdair，将 Ctrl 重新映射到“Caps Locks”或其他地方：[各种平台的说明](http://www.emacswiki.org/cgi-bin/wiki/MovingTheCtrlKey)。

PS 我有点惊讶这不能通过 elisp 函数来完成。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-25T00:09:35.400

另一种方法：如果您想避免获得“emacs pinky” *，请不要使用 pinky 来按下 control key*。

如果有必要按以下顺序重新映射键盘上的键：

**[Ctrl][Alt][空格][Alt][Ctrl]**

在任何标准键盘（对称放置修饰键，例如任何 MS 键盘）上，您现在可以用**无名指按 Ctrl 键，用****中指**按 Alt 键。这些手指比小指强壮得多，可以承受频繁使用。

在 Windows 上轻松重新映射键盘键的好工具是[AutoHotKey](http://www.autohotkey.com/)

在 Ubuntu 上，我设法做到了：键盘首选项/布局/其他选项

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-05-08T10:31:40.067

将修饰符放在它们[应该](http://world.std.com/~jdostale/kbd/SpaceCadet.html) [在的](http://world.std.com/~jdostale/kbd/SpaceCadet1.jpeg) [位置](http://www.asl.dsl.pipex.com/symbolics/photos/IO/index.html)：在空格键的任一侧，它们可以用拇指（或您选择的其他数字）在按下修改后字母的数字的另一只手上按下（以便 Cg是 Ctrl 上的右拇指和“g”上的左索引，Ck 是 Ctrl 上的左拇指和“k”上的右中间）。您会注意到，从内到外的正确顺序是 Ctrl Meta Super Hyper。

如何执行此操作取决于您的操作系统和键盘。对于 Windows，您可能想从[这里](http://blog.splittist.com/2007/07/23/emacs-newbies-dont-swap-ctrl-and-caps-lock/)开始。在 Mac OS X 中，您可以查看系统偏好设置 > 键盘和鼠标 > 修改键。对于 Linux，有一千个[xmodmap](http://www.xfree86.org/4.2.0/xmodmap.1.html)和[XKB](http://en.wikipedia.org/wiki/X_keyboard_extension)教程。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-12-03T20:49:01.100

试试*viper-mode*，它是 emacs 中的 vi 模拟器。作为一个在过去 25 年中多次在 vi/emacs/vim 之间来回切换的人，我现在终于在 emacs 中尝试 viper-mode，我喜欢它。我发现 vi 命令更舒服，但我仍然可以保留我喜欢的 emacs 的高级功能。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2009-12-03T21:04:15.240

我每天都在使用 emacs 和 bash，并且我有 capslock 作为额外的左控制键，就像 VT100 一样。还没有人提到在 X11 上做到这一点的最佳方式。（实际上，这是特定于 X.org/xfree86 X 服务器的，现在一切都在使用）：

```
setxkbmap -option ctrl:nocaps

 或编辑您的 xorg.conf 以拥有
“输入设备”部分
        标识符“通用键盘”
        驱动程序“kbd”
        选项“XkbRules”“xorg”
        选项“XkbModel”“pc105”
        选项“XkbLayout”“我们”
        选项“XkbOptions”“ctrl:nocaps”
        选项“自动重复”“200 40”
端部

```

（XkbOptions 和 Autorepeat 是我添加到预生成的。然后 X 每次都会以正确的键映射开始，并且您不必每次登录时都找到放置 setxkbmap 的位置并执行它启动你的窗口管理器。）

尽管 gno​​me 确实有一个键盘管理器，正如 boskom 所提到的。

仅供参考，emacs 最初是为带有[“space cadet”键盘](http://en.wikipedia.org/wiki/Space-cadet_keyboard)的 MIT lisp 机器编写的。X11 有 super、hyper、alt 和 meta 修饰键。有时，PC 键盘上的“windows 键”会映射到 Super。它们很容易绑定到窗口管理器的东西（例如切换虚拟桌面），因为几乎没有应用程序通常使用它们。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2010-06-17T10:20:42.127

对周，

昨天我找到了一个解决方案，我们可以在 mac 上进行系统范围的 ErgoEmacs 键绑定。

诀窍是使用 mac os x 的键绑定系统，以便您拥有系统范围的 ErgoEmacs 与 Control 键的键绑定。然后，在操作系统首选项中，交换 Control 和 Cmd 键。

这样，您就可以在空格键旁边使用修饰符获得 ErgoEmacs 键绑定系统范围。缺点当然是普通的 mac Cmd+key 现在位于键盘的角落。因此，关于您是使用大多数应用程序进行文本编辑还是应用程序的快捷方式，这是一个权衡。

可能会在这里试一试： [http ://code.google.com/p/ergoemacs/wiki/ErgoEmacs_keys_system_wide](http://code.google.com/p/ergoemacs/wiki/ErgoEmacs_keys_system_wide)

此外，几年前我尝试了 mac 的操作系统范围的自定义键绑定，一些可可应用程序仍然不支持它。见底部

•[如何在 Mac OS X 中创建键绑定](http://xahlee.org/emacs/osx_keybinding.html)

但也许现在情况好多了。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-09-09T18:22:25.547

我也有一个 MS 自然键盘，非常棒。我已经设法训练自己使用左手的一侧（小指下方）按下 Ctrl 键。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-07-09T22:36:48.997

即使在重新映射`capslock`成为之后`control`，你仍然必须用你的小指来按下它——至少我会这样做，因为我的无名指无法触及它来执行类似的命令`C-g`。根本不建议使用你的小指，对吧？

我在 MacBook Pro 上，我刚刚重新映射了`⌘</KBD> on the right side of the keyboard to become `control`. So that way, for instance, `C-g` becomes a keystroke I execute with both hands, my right-hand thumb on `⌘</KBD> and my left forefinger on `g`.``

我们会看看这对我的 RSI 是否有帮助。还有人这样做吗？

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-09-10T13:06:17.840

我在新机器上做的第一件事就是将 Caps Lock 重新映射到新的 Control。

谷歌，有很多`.reg`可用的文件可以在 Windows 上为您轻松完成这项工作。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-09-11T18:02:49.087

我开始用我的手边\手掌而不是我的小指来敲击控制键。我的理解是，在更符合人体工程学的键盘上，控制键按钮更大，这使得执行该动作更容易。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-09-16T06:23:07.340

我可以在西或西南的位置使用 Control 键，没有任何问题。许多 Emacsers 发誓控制键只属于西位和西位，其他任何东西都会毁了你的小指。我们唯一确定导致 RSI 输入的原因是输入过多。试试 type-break-mode 看看是否有一些常规的休息有帮助。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-09-17T15:23:59.747

购买一个在正确位置有 Ctrl 的[Happy Hacking 键盘](http://pfuca-store.stores.yahoo.net/haphackeylit1.html)（Caps Lock 移到其他地方）。它具有出色的响应能力，并可通过 DIP 开关进行配置，以最大限度地集成在 Mac、Windows 和 Linux 上（例如，您可以直接从键盘切换 Alt 键和 Windows 键，无需软件）。

如果适合您的喜好，它的占地面积也很小。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2010-08-30T18:12:38.393

由于该线程仍在进行中，因此我将加两分钱：

无论有没有 emacs，ctrl 键对 linux 或 windows 上的大量内容都很有用：复制、剪切、粘贴、查找、关闭、退出……我经常使用这些东西。所以正如其他人所建议的那样，我希望它靠近空格键，这样我就可以用我的拇指了。这就是 Mac 上默认的情况，所有这些东西都使用 cmd 键：

[ctrl] [alt] [cmd] [空格键]

所以，我在我的 linux 机器上使用 mac 键盘，并将 cmd 键设置为第二个 ctrl 键（在 Ubuntu Lucid 中：Keyboard Prefs > Layouts > Options > Alt/Win Key Behavior > Control is mapped to Win keys（并且常用的 Ctrl 键））

[ctrl] [alt] [ctrl] [空格键]

其他好处： * 当我有时需要使用 mac 时，剪切/粘贴/等都在我习惯的同一个地方。* ctrl+tab（使用真正的 ctrl 键）仍然在两个平台上通过浏览器和其他应用程序的选项卡移动。

这个计划的缺点是 alt 键移到了左边，所以 alt+tab 命令（我用来切换窗口）不再匹配 mac 等效的 cmd+tab。但我仍然可以用拇指敲打它，而且对我来说，它仍然比摧毁我的小指要小得多。是的，我知道我可以让 ctrl+tab 成为窗口切换器，但是真正的 ctrl 键不适用于选项卡切换。此外，随着应用程序进入浏览器，窗口/选项卡导航策略将在一段时间内不断变化——但像剪切/粘贴这样的基本功能不会随处可见，所以我希望它们被锁定。在我的拇指下。

（当然，如果你想在 mac 上使用 emacs，我想你会回到第一方......）

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2011-02-03T18:06:57.037

我实际上做了自己的破解以避免使用 ctrl 键。我现在使用空格键。 [这个](https://github.com/r0adrunner/Space2Ctrl)X 的小程序改变了空格键的行为，所以当它组合使用时，它会为其添加控制修饰符。单独使用时，它在释放时表现正常。这样你就不必使用你的小指了！非常适合我。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2013-11-16T15:20:21.773

我不是程序员，我也很难解释想法。我在戴尔迷你笔记本电脑上。鼠标触摸板在我的拇指休息的地方。我的左触摸板按钮充当控制键：用拇指的一侧按下它并像往常一样在 emacs 中进行编辑。我打算将右侧触摸板按钮映射到 alt，但我做了以下操作：我按下按钮，控制键被按下（锁定）。我再次按下它并释放控制。这不仅让我的小指感觉更好，还让我的编辑速度提高了一倍。（根据我的组织模式时钟）很难解释它的工作原理。为了做到这一点，我使用了以下两个应用程序： xbindkeys xdotool 我的 xbindkeys 配置文件：

```
###########################
# xbindkeys configuration #
###########################
# left mouse button ctrl key
"xdotool keydown ctrl"
b:1
"xdotool keyup ctrl"
control + b:1  +  Release
# vi wanna be style editing
"xdotool keydown ctrl"
release+b:3
"xdotool keyup ctrl"
release+control+b:3
# ------------------------- 
```

在尝试这些想法之前，请务必阅读手册页。不要打开任何重要的东西。在正确之前，我不得不杀死我的窗口管理器几次。注意：我使用 xmodmap 来做所有常规的事情，即 caps ---> control（不是完整的解决方案），交换 alt 和 control。（在笔记本电脑上没关系，但我的拇指抽筋）我使用窗口管理器配置文件（stumpwm）创建绑定以加载正确的键映射文件。（取决于我当天的心情）我相信这一切都可以在不同的环境中实现。我的粉红色疼痛消失了，我的编辑速度更快了。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2014-03-09T19:02:50.833

试试还不错的God-Mode插件。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2014-08-07T02:28:25.350

为了克服这个问题，我将所有的复制、粘贴、保存...等重新映射到小键盘中。为了进一步方便，我买了一个单独的小键盘并将其放在笔记本电脑键盘后面。

![](https://i.stack.imgur.com/zBQUO.jpg)

您可以使用 AHK（自动热键）轻松重新映射键。我正在使用以下键映射脚本，

```
NumpadIns::^s
NumpadEnd::^c
NumpadDown::^v
NumpadPgDn::^x
NumpadLeft::^+v
NumpadClear::Control
NumpadRight::^a
NumpadHome::q
NumpadUp::Tab
NumpadDel::^f
NumpadEnter::Space 
```

1：复制
2：粘贴
0：保存
等....

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2015-05-28T21:49:49.003

假设键盘左下角的键是控制键（适用于标准键盘），只需放下手掌就很容易按下 Ctrl 键。不涉及小指。它是如此简单和快速，我喜欢它。我只将小指用于 Ctrl 键上方的其他键（Shift、Caps 等）。对于左侧的 Alt、Windows 键、功能键（使用笔记本电脑时），我使用左手拇指（右手拇指用于空格）。对于包含 Ctrl 的热键组合，我使用 Ctrl 的方式相同。

我只使用右左 Ctrl 键。我使用 Right Ctrl 作为“超级”修饰符（在 autohotkey 中映射到 F23，然后在 emacs 中映射到 supper）。

起初按这种方式按 Ctrl 可能看起来很奇怪，但在使用之后变得非常容易（它只需要稍微降低手/手掌） - 对我来说，这几乎就像没有按下热键 (Ctrl) 时一样简单。我看到了这种差异，因为我现在正在学习 emacs 并学习在右侧做同样的事情（对于 AppKey 和 Right Control 键以及我的笔记本电脑的 Down 和 End）。

这是我的ahk代码：

```
#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
SendMode Input  ; Recommended for new scripts due to its superior speed and      reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.

^#e:: Gosub, start_emacs
^#c:: Gosub, start_capture

#IfWinActive emacs@ ahk_class Emacs

Up::Return ; to not interfere with pressing <Down>

; F21 = Alt
RAlt::F21

; F23 = Super
RCtrl::F23

#IfWinActive

exit

start_emacs:
IfWinExist emacs@ ahk_class Emacs
    WinActivate
else
    Run c:\bin\emacs\bin\runemacs.exe
    WinMaximize
return

start_capture:
    Gosub, start_emacs
    SendInput {Ctrl down}xf{Ctrl up} {ctrl down}{shift down}{backspace}{ctrl up}{shift up}
    SendInput ~/org/capture.org {enter}
    SendInput {Alt down}x{Alt up} org-capture {enter}
return 
```

这是我的 .emacs 中的内容：

```
 ; prevent single key press from activating the given key
;; http://emacs.1067599.n5.nabble.com/w32-pass-rwindow-to-system-td144902.html
(setq w32-pass-lwindow-to-system nil
  w32-pass-rwindow-to-system nil
  w32-pass-apps-to-system nil)
                ; make sure the given key is not used as a modifier
(setq w32-lwindow-modifier nil
  w32-rwindow-modifier nil
  w32-apps-modifier nil) ; Menu/App key
                ; misc
(setq w32-recognize-altgr nil) ; C+M works: http://www.gnu.org/software/emacs/manual/html_node/emacs/Windows-Keyboard.html
                ; A-alt
(define-key local-function-key-map (kbd "<f21>") 'event-apply-alt-modifier) ; RAlt in ahk
                ; H-hyper
(define-key local-function-key-map (kbd "<f22>") 'event-apply-hyper-modifier) 
(define-key local-function-key-map (kbd "<menu>") 'event-apply-hyper-modifier)
(define-key local-function-key-map (kbd "<apps>") 'event-apply-hyper-modifier) 
(define-key local-function-key-map (kbd "<lwindow>") 'event-apply-hyper-modifier)
(define-key local-function-key-map (kbd "<down>") 'event-apply-hyper-modifier)
                ; s-super
(define-key local-function-key-map (kbd "<f23>") 'event-apply-super-modifier) ; RCtrl in ahk
(define-key local-function-key-map (kbd "<right>") 'event-apply-super-modifier) 
(define-key local-function-key-map (kbd "<rwindow>") 'event-apply-super-modifier) 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-08-14T11:04:57.670

[我的键盘](https://i.stack.imgur.com/Hdsh1.jpg)

[![在此处输入图像描述](https://i.stack.imgur.com/Hdsh1.jpg)](https://i.stack.imgur.com/Hdsh1.jpg) 只需用短空格键制作键盘！

# c++ - C++ 模板歧义

> ID：52506
> 
> 赞同：8
> 
> 时间：2008-09-09T18:13:55.473
> 
> 标签：c++, templates, grammar

我和一个朋友正在讨论 C++ 模板。他问我这应该怎么做：

```
#include <iostream>

template <bool>
struct A {
    A(bool) { std::cout << "bool\n"; }
    A(void*) { std::cout << "void*\n"; }
};

int main() {
    A<true> *d = 0;
    const int b = 2;
    const int c = 1;
    new A< b > (c) > (d);
} 
```

main 中的最后一行有两个合理的解析。'b' 是模板参数还是`b > (c)`模板参数？

虽然编译它很简单，看看我们得到了什么，我们想知道是什么解决了歧义？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T18:57:00.283

AFAIK 它将被编译为`new A<b>(c) > d`. 这是解析它恕我直言的唯一合理方法。如果解析器在正常情况下不能假设 a > 结束一个模板参数，那将导致更多的歧义。如果你想要它，你应该写：

```
new A<(b > c)>(d); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T12:27:15.793

正如 Leon & Lee 所说，14.2/3 (C++ '03) 明确定义了这种行为。

C++ '0x 通过适用于`>>`. 基本概念是，在解析模板参数列表时，非嵌套`>>`将被视为两个不同的`>` `>`标记，而不是右移运算符：

```
template <bool>
struct A {
  A(bool);
  A(void*);
};

template <typename T>
class C
{
public:
  C (int);
};

int main() {
    A<true> *d = 0;
    const int b = 2;
    const int c = 1;
    new C <A< b  >>  (c) > (d); // #1
    new C <A< b > >  (c) > (d); // #2
} 
```

'#1' 和 '#2' 在上面是等价的。

这当然解决了必须在嵌套专业化中添加空格的烦恼：

```
C<A<false>> c;  // Parse error in C++ '98, '03 due to "right shift operator" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-09T20:50:28.793

C++ 标准定义，如果模板名称后跟 a `<`，`<`则始终是模板参数列表的开头，而第一个非嵌套`>`的则作为模板参数列表的结尾。

如果您打算将`>`运算符的结果作为模板参数，那么您需要将表达式括在括号中。`static_cast<>`如果参数是一个或另一个模板表达式的一部分，则不需要括号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T18:18:18.630

词法分析器的贪婪可能是没有括号使其明确的决定因素。我猜词法分析器并不贪婪。

# desktop-application - 云端桌面应用程序是否已死？

> ID：52520
> 
> 赞同：3
> 
> 时间：2008-09-09T18:21:12.460
> 
> 标签：desktop-application, cloud

[尽管与这个问题](https://stackoverflow.com/questions/4409/is-the-desktop-app-dead)有些相关，但我认为对此有不同的看法。

与“云”没有连接的桌面应用程序是否已死？我相信有些东西会继续在机器上运行（显然是操作系统、浏览器、一些轻量级应用程序），但越来越多的东西正在转向基于网络的应用程序（参见 Google Docs for office suites、GMail 和其他用于电子邮件的网络电子邮件客户端、用于照片管理的 flickr 等）。

那么，除了轻量级应用程序之外，5 到 10 年内，是否有任何东西会继续（出于必要或只是需求）保留在桌面和云端？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T18:35:59.600

10 年或更久以前，这会是“非互联网应用程序死了吗？”

云在某些方面比桌面应用程序做得更好，我相信在这些地方非云应用程序将变得越来越少。但是有很多应用程序你可能不想使用云，好处不超过成本，或者复杂性不值得。

它是一个新工具，在很多方面它都比桌面应用程序更好。但是，您购买螺丝刀时不会扔掉锤子，您只需保留它以备需要打钉子时使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-09T18:28:19.510

视频编辑和其他资源密集型任务可能会在很长一段时间内远离云端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-09T18:26:07.800

IDE 可能会在很长一段时间内“脱离云”，如果有的话……像 Emacs 这样强大的可定制编辑器也可能会在一段时间内“脱离云”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-09T18:29:02.270

如果我查看我们销售的应用程序以及我作为顾问编写的应用程序，我必须非常同意您的看法。如果没有互联网连接，它们中的大多数都是无用的。有些确实可以在断开模式下工作，有些则不能，但是如果您无法连接到隐藏在很远的大型支持系统，那么所有这些都将毫无用处。

另一方面，我不想说一切都将在 5 年内迁移到云中。移植工作太多。将会有桌面应用程序充当瘦且可脱机的客户端（例如，如果您安装了 Gears，Google Reader 就会这样做），并且将会有完全“云”的应用程序：) 应用程序。

我不知道10年后会发生什么。如果我把自己放回 10 年前（这很容易做到，因为当时我为当地的一家计算机杂志写了很多文章），我完全无法预测 2008 年计算机将如何依赖互联网。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-09T18:31:54.587

天哪，我希望这不是我的工作。

我编写的主要软件控制用于测试的电子硬件（PXI 板等）。没有“真正的”硬件，就没有什么可以测试的。甚至测试本身的本质也阻止了同时访问（一旦您设置了开关的状态，您就不想让其他人移动它）。

因此，只要您与任何硬件交互，您就在云端。

哦，有些公司在上网时会遇到安全问题；我会说安全性也会驱动没有连接的桌面应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-09T18:26:23.743

许多公司没有理由仅仅因为安全问题而转向在线系统。

例如，Outlook 的最大资产之一就是离线并继续工作。当然，Google Gears 具有类似的功能，但您信任 Google 以确保您的企业安全。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-09T18:30:29.020

自从 Sun 凭借其[JavaStation](http://en.wikipedia.org/wiki/JavaStation)获得市场领导地位以来，此类应用程序已经消亡了 15 年。

不，等等。他们没有。事情并没有“越来越”转向基于网络的应用程序。当然，有 Webmail，但即使是 GMail，也与现代 Outlook 或 Thunderbird 客户端的舒适度相去甚远。办公室也一样。Google Docs 是偶尔使用的好玩具，但它远​​不如传统的 Office 套件。

桌面没有死，也不会很快死。Internet 应用程序在某些情况下是替代品，但它才刚刚开始获得适当的功能和性能。让我们面对现实吧：JavaScript 性能仍然是个笑话，IDE 支持还没有，浏览器目前太不稳定。

谷歌 Chrome、IE8 和 Firefox 3.1 开始朝着更好的方向发展，但它们需要数年时间才能成熟到足以创建真正可以完全替代桌面应用程序的 JavaScript 应用程序。但这需要跨浏览器进行一些适当的标准化，我们都知道这在下一个千年左右之前不会发生。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-09T18:31:53.823

大约 1% 的用户实际上是全职使用 Google Docs&Spreadsheets。几乎所有其他人都使用 Microsoft Office。所以，不，云外应用程序不会仅仅因为谷歌办公套件的存在而消亡。实际上，这些是唯一的高调真正的 Web 应用程序，旨在替代桌面应用程序。

网络邮件是一个特例。使用这些而不是桌面应用程序实际上是有意义的，因为您的电子邮件在没有连接的情况下几乎是无用的。但大多数应用程序不需要全时 Internet 连接。文字处理器当然不会。

桌面上肯定会保留的内容：

1.  游戏
2.  小应用程序（计算器，记事本类型的东西）
3.  任何生成需要安全的数据的东西（例如，我不认为有很多人或公司希望将他们的会计详细信息信任给谷歌）
4.  网络浏览器（显然）
5.  IDE（通过 Ajax 的 Visual Studio？来吧...）
6.  辅助开发工具（SVN 等），因为良好的安全策略会禁止通过 Web 浏览器使用它们
7.  任何需要足够高的性能以使网络延迟成为障碍的东西

至少在未来 5 年内，可能主要保留在桌面上的内容：

1.  办公工具（除非可以解除基于 Web 的限制……这需要性能比我们现在更好的 Web 浏览器）
2.  Photoshop等工具
3.  聊天客户端（到目前为止，基于网络的等价物令人失望）

当然，这并不是说上述任何一个都不能具有基于 Internet 的组件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-09T19:39:26.907

我个人永远不会将我的东西留在网络上，由其他人控制。我所有的照片和电子邮件都保存在我控制的本地硬盘上。

我更喜欢在我自己的硬件上通过网络向我提供我自己的东西。离线时获得合理性能和高效的唯一方法是使用本地应用程序。

对我来说，未来将是本地的，但可以远程访问和同步。至少在接下来的 20 年左右。

我不仅认为它没有死，而且我认为一旦我们遇到一些灾难性的失败（例如，网站消失，用户内容没有在任何地方备份，或者由于某些大公司失去了严重的隐私权控制对他们正在保护的数据的访问）。

# c - 逗号运算符 , 有什么作用？

> ID：52550
> 
> 赞同：192
> 
> 时间：2008-09-09T18:34:09.777
> 
> 标签：c, operators, comma-operator

`,`运算符在 C 中做什么？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2008-09-09T18:37:07.133

表达方式：

```
(expression1,  expression2) 
```

首先计算表达式 1，然后计算表达式 2，并为整个表达式返回表达式 2 的值。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2008-09-09T18:56:52.373

我见过在`while`循环中使用最多：

```
string s;
while(read_string(s), s.len() > 5)
{
   //do something
} 
```

它将执行操作，然后根据副作用进行测试。另一种方法是这样做：

```
string s;
read_string(s);
while(s.len() > 5)
{
   //do something
   read_string(s);
} 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-08-26T12:29:31.643

[逗号运算符](https://en.wikipedia.org/wiki/Comma_operator)将评估左操作数，丢弃结果，然后评估右操作数，这将是结果。链接中提到的*惯用*用法是在初始化`for`循环中使用的变量时，它给出了以下示例：

```
void rev(char *s, size_t len)
{
  char *first;
  for ( first = s, s += len - 1; s >= first; --s)
      /*^^^^^^^^^^^^^^^^^^^^^^^*/ 
      putchar(*s);
} 
```

否则，*逗号运算符**的*用途并不多，尽管它很容易被滥用来生成难以阅读和维护的代码。

 *从[C99 标准草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)中，语法如下：

```
expression:
  assignment-expression
  expression , assignment-expression 
```

第*2段*说：

> 逗号运算符的**左操作数被评估为 void 表达式；**在其评估之后有一个序列点。然后对**右操作数求值；结果有它的类型和值。** ^(97))如果尝试修改逗号运算符的结果或在下一个序列点之后访问它，则行为未定义。

*脚注 97*说：

> 逗号运算符不会**产生左值**。

这意味着您不能分配给*逗号运算符*的结果。

重要的是要注意逗号运算符的[优先级最低](https://en.cppreference.com/w/c/language/operator_precedence)，因此在某些情况下 using`()`可以产生很大的不同，例如：

```
#include <stdio.h>

int main()
{
    int x, y ;

    x = 1, 2 ;
    y = (3,4) ;

    printf( "%d %d\n", x, y ) ;
} 
```

将有以下输出：

```
1 4 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-09-11T20:42:34.553

逗号运算符将其两侧的两个表达式组合为一个，以从左到右的顺序对它们进行计算。右侧的值作为整个表达式的值返回。 `(expr1, expr2)`就像`{ expr1; expr2; }`但你可以`expr2`在函数调用或赋值中使用结果。

在`for`循环中经常看到初始化或维护多个变量，如下所示：

```
for (low = 0, high = MAXSIZE; low < high; low = newlow, high = newhigh)
{
    /* do something with low and high and put new values
       in newlow and newhigh */
} 
```

除此之外，我只在另一种情况下“愤怒地”使用它，当包装两个应该始终在宏中一起使用的操作时。我们有将各种二进制值复制到字节缓冲区中以便在网络上发送的代码，并在我们已经到达的位置维护了一个指针：

```
unsigned char outbuff[BUFFSIZE];
unsigned char *ptr = outbuff;

*ptr++ = first_byte_value;
*ptr++ = second_byte_value;

send_buff(outbuff, (int)(ptr - outbuff)); 
```

在值是`short`s 或`int`s 的地方，我们这样做了：

```
*((short *)ptr)++ = short_value;
*((int *)ptr)++ = int_value; 
```

后来我们读到这不是真正有效的 C，因为`(short *)ptr`不再是左值并且不能递增，尽管我们当时的编译器并不介意。为了解决这个问题，我们将表达式一分为二：

```
*(short *)ptr = short_value;
ptr += sizeof(short); 
```

但是，这种方法依赖于所有开发人员记住始终将这两个语句都放入。我们想要一个函数，您可以在其中传递输出指针、值和值的类型。这是 C，而不是带有模板的 C++，我们不能让函数采用任意类型，所以我们选择了一个宏：

```
#define ASSIGN_INCR(p, val, type)  ((*((type) *)(p) = (val)), (p) += sizeof(type)) 
```

通过使用逗号运算符，我们可以在表达式中使用它，或者按照我们的意愿作为语句使用它：

```
if (need_to_output_short)
    ASSIGN_INCR(ptr, short_value, short);

latest_pos = ASSIGN_INCR(ptr, int_value, int);

send_buff(outbuff, (int)(ASSIGN_INCR(ptr, last_value, int) - outbuff)); 
```

我并不是说这些例子中的任何一个都是好的风格！事实上，我似乎记得 Steve McConnell 的*Code Complete*建议不要在循环中使用逗号运算符`for`：为了可读性和可维护性，循环应该只由一个变量控制，并且`for`行本身的表达式应该只包含循环控制代码，不是其他额外的初始化或循环维护。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-09T18:37:35.197

它会导致对多个语句的评估，但仅使用最后一个作为结果值（我认为是右值）。

所以...

```
int f() { return 7; }
int g() { return 8; }

int x = (printf("assigning x"), f(), g() ); 
```

应该导致 x 设置为 8。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-09T18:43:30.317

正如之前的答案所述，它评估所有语句，但使用最后一个作为表达式的值。就我个人而言，我只发现它在循环表达式中有用：

```
for (tmp=0, i = MAX; i > 0; i--) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-09T18:50:41.377

我看到它有用的唯一地方是当您编写一个时髦的循环时，您想在其中一个表达式中执行多项操作（可能是 init 表达式或循环表达式。类似于：

```
bool arraysAreMirrored(int a1[], int a2[], size_t size)
{
  size_t i1, i2;
  for(i1 = 0, i2 = size - 1; i1 < size; i1++, i2--)
  {
    if(a1[i1] != a2[i2])
    {
      return false;
    }
  }

  return true;
} 
```

如果有任何语法错误或者我混合了任何不严格的 C 语言，请原谅我。我并不是说 , 运算符是好的形式，但这就是您可以使用它的目的。在上述情况下，我可能会改用`while`循环，因此 init 和 loop 上的多个表达式会更明显。（而且我会内联初始化 i1 和 i2，而不是先声明然后初始化......等等等等。）

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-01-04T11:51:28.780

我恢复这个只是为了解决来自@Rajesh 和@JeffMercado 的问题，我认为这些问题非常重要，因为这是搜索引擎的热门搜索之一。

以下面的代码片段为例

```
int i = (5,4,3,2,1);
int j;
j = 5,4,3,2,1;
printf("%d %d\n", i , j); 
```

它会打印

```
1 5 
```

该`i`案例的处理方式如大多数答案所解释。所有表达式都按从左到右的顺序计算，但只有最后一个分配给`i`. `(` *表达式*) `is`1`的结果。

该`j`案例遵循不同的优先级规则，因为`,`具有最低的运算符优先级。由于这些规则，编译器会看到*assignment-expression, constant, constant ...*。表达式再次以从左到右的顺序进行评估，并且它们的副作用保持可见，因此，`j`是.`5``j = 5`

有趣的`int j = 5,4,3,2,1;`是，语言规范不允许。*初始化程序*需要一个赋值*表达式*`,`，因此不允许使用直接运算符。

希望这可以帮助。

# c++ - 配置文件引导优化 (C)

> ID：52557
> 
> 赞同：13
> 
> 时间：2008-09-09T18:36:49.833
> 
> 标签：c++, c, optimization, gcc, pgo

有人知道这个编译器功能吗？GCC 似乎支持这一点。它是如何工作的？潜在收益是多少？在什么情况下好？内循环？

（这个问题是具体的，而不是一般的优化，谢谢）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-11T20:34:45.913

它通过放置额外的代码来计算每个代码路径的使用次数。当你第二次编译时，编译器会使用之前只能猜测的关于程序执行的知识。PGO 可以做以下几件事：

*   根据调用频率决定哪些函数应该被内联或不被内联。
*   根据以一种方式或另一种方式进行的调用的百分比来决定如何放置关于“if”语句的哪个分支应该被预测的提示。
*   根据每次调用循环时进行的迭代次数来决定如何优化循环。

在您进行测试之前，您永远不会真正知道这些东西有多大帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T12:14:58.430

PGO gives about a 5% speed boost when compiling x264, the project I work on, and we have a built-in system for it (make fprofiled). Its a nice free speed boost in some cases, and probably helps more in applications that, unlike x264, are less made up of handwritten assembly.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T18:49:24.047

杰森的建议是正确的。您将获得的最佳加速来自“发现”您让 O(n ² ) 算法滑入某处的内部循环，或者您可以在昂贵的函数之外缓存某些计算。

与 PGO 可以触发的微优化相比，这些是最大的赢家。一旦您完成了该级别的优化，PGO 可能会提供帮助。不过，我们从来没有运气好过——仪器的成本使得我们的应用程序变得非常慢（几个数量级）。

我喜欢使用英特尔 VTune 作为分析器，主要是因为与检测分析器相比，它是非侵入性的，因为它会改变太多的行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T18:43:01.923

优化的有趣之处在于，在最不可能的地方发现速度增益。

这也是您需要分析器的原因，而不是猜测速度问题出在哪里。

我建议从分析器开始（`gperf`如果您使用的是 GCC），然后开始通过一些正常操作来查看运行应用程序的结果。

# iphone - iPhone 浏览器标签和优化的网站

> ID：52561
> 
> 赞同：3
> 
> 时间：2008-09-09T18:40:02.837
> 
> 标签：iphone, html, mobile, mobile-website

iPhone 的浏览器标签是什么以及 iPhone 优化的网站与通常的移动网站有何不同？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T15:18:02.033

Apple 在这里为 iPhone 网页开发提供了一些出色的指南：

[iPhone 版 Safari 网页内容指南](http://developer.apple.com/documentation/AppleApplications/Reference/SafariWebContent/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/TP40002079-SW1)

根据我对它的简短阅读，以下是需要注意的关键要素：

*   由于屏幕尺寸较小，“视口”和滚动的工作方式有些不同。有自定义 META 标签可让您在有人访问您的页面时自动调整此标签。
*   当心使用框架集或其他需要用户滚动页面上不同元素的功能的页面，因为 iPhone 不显示滚动条。
*   如果您希望人们在 iPhone 上为您的页面添加书签，则可以使用自定义 META 标签指定一个 53x53 的图标，该图标看起来比典型的 favorite.ico 更好。
*   避免依赖于鼠标移动或悬停动作来使事情发生的 javascript，它们在 iPhone 上无法正常工作。
*   有一些自定义 CSS 属性可让您调整 iPhone 上超链接的文本大小和突出显示颜色。
*   还有其他关键的 HTML/Javascript 功能，他们告诉你要么喜欢要么避免。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T18:43:06.167

Nettuts 对 iPhone 的 Web 开发有很好的介绍。[你在这里](http://nettuts.com/misc/learn-how-to-develop-for-the-iphone/)找到它

这是您要求的特定代码（取自该文章）：

```
<!--#if expr="(${HTTP_USER_AGENT} = /iPhone/)"-->   

<!--  
place iPhone code in here  
-->   

<!--#else -->   

<!--  
    place standard code to be used by non iphone browser.   
-->   
<!--#endif --> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T18:46:40.980

[Apple 在这里](http://developer.apple.com/documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/chapter_3_section_3.html)定义了用户代理。

该字段在“User-Agent”键下的 HTTP 标头中传输

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-25T17:15:01.090

更好的解决方案：

```
*

  (NSString *)flattenHTML:(NSString *)html {

  NSScanner *theScanner; NSString *text = nil;

  theScanner = [NSScanner scannerWithString:html];

  while ([theScanner isAtEnd] == NO) {

  // find start of tag
  [theScanner scanUpToString:@"<" intoString:NULL] ; 

  // find end of tag
  [theScanner scanUpToString:@">" intoString:&text] ;

  // replace the found tag with a space
  //(you can filter multi-spaces out later if you wish)
  html = [html stringByReplacingOccurrencesOfString:
                     [ NSString stringWithFormat:@"%@>", text]
               withString:@" "];

  } // while //

  return html; 
```

}

# html - 输入 type=text 填充父容器

> ID：52563
> 
> 赞同：36
> 
> 时间：2008-09-09T18:40:46.190
> 
> 标签：html, css

我试图让一个`<input type="text">`（以下称为“文本框”）通过将其设置为`width`来填充父容器`100%`。这一直有效，直到我给文本框一个填充。然后将其添加到内容宽度并且输入字段溢出。请注意，在 Firefox 中，这仅在将内容呈现为符合标准时才会发生。在 quirks 模式下，另一个盒子模型似乎适用。

这是在所有现代浏览器中重现该行为的最小代码。

```
#x {
  background: salmon;
  padding: 1em;
}

#y, input {
  background: red;
  padding: 0 20px;
  width: 100%;
}
```

```
<div id="x">
  <div id="y">x</div>
  <input type="text"/>
</div>
```

我的问题：**如何让文本框适合容器？**

*注意*：对于`<div id="y">`，这很简单：只需设置`width: auto`。但是，如果我尝试对文本框执行此操作，效果会有所不同，并且文本框将其默认行数作为宽度（即使我`display: block`为文本框设置了）。

编辑：大卫的解决方案当然会奏效。但是，我不想修改 HTML——我尤其不想添加没有语义功能的虚拟元素。这是我想不惜一切代价避免的典型的[葡萄膜炎。](http://en.wiktionary.org/wiki/Citations:divitis)这只能是最后的手段。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-03-23T13:19:56.877

使用 CSS3，您可以在输入中使用 box-sizing 属性来标准化它们的盒子模型。像这样的东西将使您能够添加填充并具有 100% 的宽度：

```
input[type="text"] {
    -webkit-box-sizing: border-box; // Safari/Chrome, other WebKit
    -moz-box-sizing: border-box;    // Firefox, other Gecko
    box-sizing: border-box;         // Opera/IE 8+
} 
```

不幸的是，这不适用于 IE6/7，但其余的都很好（[兼容性列表](http://www.quirksmode.org/css/user-interface/)），所以如果您需要支持这些浏览器，您最好的选择是 Davids 解决方案。

如果您想阅读更多内容，请查看[Chris Coyier 的这篇精彩文章](http://css-tricks.com/box-sizing/)。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-09T19:02:04.110

您可以用 a 包围文本框`<div>`并给出`<div>` `padding: 0 20px`. 您的问题是 100% 宽度不包括任何填充或边距值；这些值被添加到 100% 宽度之上，因此溢出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-09T22:45:50.063

由于[Box-Modell](http://reference.sitepoint.com/css/boxmodel)的定义和实现方式，我认为没有针对此问题的纯 CSS 解决方案。（除了[Matthew](https://stackoverflow.com/questions/52563/css-textbox-to-fill-parent-container#52896)所描述的：也使用百分比作为填充，例如宽度：94%；填充：0 3%；）

但是，您可以构建一些 Javascript 代码来动态计算页面加载时的宽度......嗯，当然每次调整浏览器窗口大小时也必须更新该值。

我做过的一些测试的有趣副产品：Firefox**确实**将输入字段的宽度设置为 100%，如果另外`width: 100%;`你也将 max-width 设置为 100%。这在 Opera 9.5 或 IE 7 中不起作用（尚未测试旧版本）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-12-29T15:32:56.650

**如何让文本框适合 2019 年的容器？**

只需使用 display: flex;

```
#x {
  background: salmon;
  padding: 1em;
  display: flex;
  flex-wrap: wrap;
}

#y, input {
  background: red;
  padding: 0 20px;
  width: 100%;
}
```

```
<div id="x">
  <div id="y">x</div>
  <input type="text"/>
</div>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-04T18:39:26.637

不幸的是，纯 CSS 无法做到这一点。对于任何重要的灵活但受限的 UI 行为，都需要修改 HTML 或 Javascript。CSS3 列在这方面会有所帮助，但在像您这样的场景中却没有。

大卫的解决方案是最干净的。这并不是一个真正的 divitis 的情况——你不会不必要地添加一堆 div，或者给它们像“p”和“h1”这样的类名。它服务于一个特定的目的，在这种情况下的好处是它也是一个可扩展的解决方案——例如，您可以随时添加圆角而无需进一步添加任何东西。可访问性也不受影响，因为它们是空的 div。

Fwiw，这是我实现所有文本框的方式：

```
<div class="textbox" id="username">
    <div class="before"></div>
    <div class="during">
        <input type="text" value="" />
    </div>
    <div class="after"></div>
</div> 
```

然后，您可以自由地使用 CSS 添加圆角、添加填充（如在您的情况下）等，但您也不必这样做——您可以完全隐藏这些侧 div 并且只有一个常规输入文本框.

其他解决方案是使用表格，例如亚马逊使用表格来获得灵活但受限的布局，或者使用 Javascript 来调整大小并在窗口调整大小时更新它们，例如 Google Docs、Maps 等。所有这些都是这样做的。

无论如何，我的两分钱：在这种情况下，不要让理想主义妨碍实用性。:) David 的解决方案很有效，几乎不会弄乱 HTML（事实上，使用语义类名，如“之前”和“之后”在 imo 中仍然非常干净）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-09T21:00:49.377

这种行为是由盒模型的不同解释引起的。正确的盒子模型声明宽度仅适用于内容，并且填充和边距添加到它。因此，您将获得 100% 加上 20px 左右填充，等于 100%+40px 作为总宽度。原始的 IE 框模型，也称为 quirks 模式，在宽度中包含 padding 和 margin。因此，在这种情况下，您的内容的宽度将是 100% - 40px。这就是为什么您会看到两种不同的行为。据我所知，没有解决方案，但是可以通过将宽度设置为 98% 并将填充设置为每侧 1% 来解决此问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-09T21:38:47.633

@Domenic 这不起作用。width auto 仅执行该元素的默认行为，因为 width 的初始值为 auto （请参阅第 164 页，级联样式表第 2 级修订版 1 规范）。分配块类型的显示也不起作用，这只是告诉浏览器在显示元素时使用块框，并且不会像 div 那样分配尽可能多的空间的默认行为（参见第 121 页，级联样式表 2 级修订 1 规范）。该行为由可视用户代理处理，而不是 CSS 或 HTML 定义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-09T18:45:56.003

我相信你可以用负边距来应对溢出。IE

```
margin: -1em; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-17T16:12:42.140

默认填充和边框将阻止您的文本框真正达到 100%，因此首先您必须将它们设置为 0：

```
input {
    background: red;
    padding: 0;
    width: 100%;
    border: 0; //use 0 instead of "none" for ie7 
} 
```

然后，将您的边框和任何您想要的填充或边距放在文本框周围的 div 中：

```
.text-box {
    padding: 0 20px;
    border: solid 1px #000000;
}

<body>
    <div id="x">
        <div id="y">x</div>
        <div class="text-box"><input type="text"/></div>
    </div>
</body> 
```

这应该允许您的文本框可扩展，并且无需 javascript 即可获得您想要的确切大小。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-19T08:44:50.400

要使输入填充父级的宽度，需要设置 3 个属性：宽度：100%，边距左：0，边距右：0。

我只是猜想零边距设置会有所帮助，并且我已经尝试过了，但是我不知道为什么边距（左右；当然顶部和底部边距在这里不受影响）应该为零才能使其起作用。:-)

```
input {
  width: 100%;
  margin-left: 0;
  margin-right: 0;
} 
```

注意：您可能需要将 box-sizing 设置为 border-box 以确保填充不会影响结果。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-12T07:03:11.900

我用纯 CSS 表来解决这个问题。一个有点长的例子，但对于所有想要为数据库的大量字段制作条目屏幕的人来说很重要......

// 生长激素

```
// NO JAVA !!! ;-)
```

```
html {
  height: 100%;
}

body {
  position: fixed;
  margin: 0px;
  padding: 0px;
  border: 2px solid #FF0000;
  width: calc(100% - 4px);
  /* Demonstrate how form can fill body */
  min-height: calc(100% - 120px);
  margin-top: 60px;
  margin-bottom: 60px;
}

/* Example how to make a data entry form */

.rx-form {
  display: table;
  table-layout: fixed;
  border: 1px solid #0000FF;
  width: 100%;
  border-collapse: separate;
  border-spacing: 5px;
}

.rx-caption {
  display: table-caption;
  border: 1px solid #000000;
  text-align: center;
  padding: 10px;
  margin: 10px;
  width: calc(100% - 40px);
  font-size: 2.5em;
}

.rx-row {
  display: table-row;
  /* To make frame on rows. Rows have no border... ? */
  box-shadow: 0px 0px 0px 1px rgb(0, 0, 0);
}

.rx-cell {
  display: table-cell;
  margin: 0px;
  padding: 4px;
  border: 1px solid #FF0000;
}

.rx-cell label {
  float: left;
  border: 1px solid #00FF00;
  width: 110px;
  padding: 4px;
  font-size: 1em;
  text-align: right;
  font-family: Arial, Helvetica, sans-serif;
  overflow: hidden;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.rx-cell label:after {
  content: " :";
}

.rx-cell input[type='text'] {
  float: right;
  border: 1px solid #FF00FF;
  padding: 4px;
  background-color: #eee;
  border-radius: 0px;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 1em;
  /* Fill the cell - but subtract the label width - and litte more... */
  width: calc(100% - 130px);
  overflow: hidden;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

input[type='submit'] {
  font-size: 1.3em;
}
```

```
<html>
<meta charset="UTF-8">

<body>

  <!--                                                                                                                                                                                                                                                                             
        G Hasse, gorhas at raditex dot nu                                                                                                                                                                                                                                            
        This example have a lot of frames so we                                                                                                                                                                                                                                      
        can experiment with padding and margins.                                                                                                                                                                                                                                     
    -->

  <form>

    <div class='rx-form'>

      <div class='rx-caption'>
        Caption
      </div>

      <!-- First row of entry -->

      <div class='rx-row'>

        <div class='rx-cell'>
          <label for="input11">Label 1-1</label>
          <input type="text" name="input11" id="input11" value="Some latin text here. And if it is very long it will get ellipsis" />
        </div>

        <div class='rx-cell'>
          <label for="input12">Label 1-2</label>
          <input type="text" name="input12" id="input12" value="The content of input 2" />
        </div>

        <div class='rx-cell'>
          <label for="input13">Label 1-3</label>
          <input type="text" name="input13" id="input13" value="Content 3" />
        </div>

        <div class='rx-cell'>
          <label for="input14">Label 1-4</label>
          <input type="text" name="input14" id="input14" value="Content 4" />
        </div>

      </div>

      <!-- Next row of entry -->

      <div class='rx-row'>

        <div class='rx-cell'>
          <label for="input21">Label 2-1</label>
          <input type="text" name="input21" id="input21" value="Content 2-1">
        </div>

        <div class='rx-cell'>
          <label for="input22">Label 2-2</label>
          <input type="text" name="input22" id="input22" value="Content 2-2">
        </div>

        <div class='rx-cell'>
          <label for="input23">Label 2-3</label>
          <input type="text" name="input23" id="input23" value="Content 2-3">
        </div>

      </div>

      <!-- Next row of entry -->

      <div class='rx-row'>

        <div class='rx-cell'>
          <label for="input21">Label 2-1</label>
          <input type="text" name="input21" id="input21" value="Content 2-1">
        </div>

        <div class='rx-cell'>
          <label for="input22">Label 2-2</label>
          <input type="text" name="input22" id="input22" value="Content 2-2">
        </div>

        <div class='rx-cell'>
          <label for="input23">Label 2-3</label>
          <input type="text" name="input23" id="input23" value="Content 2-3">
        </div>

      </div>

      <!-- And some text in cells -->

      <div class='rx-row'>

        <div class='rx-cell'>
          <div>Cell content</div>
        </div>

        <div class='rx-cell'>
          <span>Cell content</span>
        </div>

      </div>

      <!-- And we place the submit buttons in a cell -->

      <div class='rx-row'>

        <div class='rx-cell'>
          <input type="submit" name="submit1" value="submit1" />
          <input type="submit" name="submit2" value="submit2" />
        </div>

      </div>

      <!-- End of form -->
    </div>
  </form>

</body>

</html>
```

# sql-server - SQL Server 2000 - 调试死锁

> ID：52566
> 
> 赞同：3
> 
> 时间：2008-09-09T18:42:07.013
> 
> 标签：sql-server, tsql, sql-server-2000, debugging, deadlock

我正在寻找有关如何在 SQL Server 2000 数据库中调试和解决死锁问题的建议。有人建议我使用跟踪标志 1024 和 3605，我发现它们给了我以下信息：

1024 - 此跟踪标志返回参与死锁的锁类型和受影响的当前命令。

3605 - 此跟踪标志将跟踪输出发送到错误日志。

仍然需要发现特定的存储过程、表和索引，因此目标是使用这些跟踪标志来做到这一点。然后从那里我会更好地了解哪些索引需要调整、调整查询的锁定提示以及需要修复的潜在存储过程错误。

关于将这一切归结为常见问题的任何其他建议或快乐结局的战争故事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T18:51:03.997

这是关于死锁故障排除的圣经：http: [//blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx](http://blogs.msdn.com/bartd/archive/2006/09/09/Deadlock-Troubleshooting_2C00_-Part-1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T08:46:36.237

分析死锁的非常有用的脚本：http: [//www.sommarskog.se/sqlutil/aba_lockinfo.html](http://www.sommarskog.se/sqlutil/aba_lockinfo.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T18:48:14.610

一旦你知道所涉及的 sql 语句，代码分析肯定会有所帮助。一些经验法则正在检查访问行的顺序并检查用于 SQL 语句的隔离级别。探查器跟踪可以提供很大帮助。

大多数情况下，这是因为读取器试图获得对由写入器独占锁定的资源的共享锁。

# mysql - 同步 MySQL 数据库的最佳工具

> ID：52583
> 
> 赞同：14
> 
> 时间：2008-09-09T18:48:21.413
> 
> 标签：mysql, synchronization

我正在尝试合并两个 MySql 数据库的结构。Red-Gate 的 SQL Compare 有没有一个工具可以解决这个问题？有没有免费的替代品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T11:35:22.140

I've been using [SQLyog](http://www.webyog.com) for years now. Recently they released v8.0 which includes an updated interface and two very cool features the Query Profiler and SQL Formatter. The formatter was the reason I upgraded this year.

[http://www.webyog.com/en/sqlyog_feature_list.php](http://www.webyog.com/en/sqlyog_feature_list.php)

Blog post with video and animated gif of the SQL Formatter in action [http://www.webyog.com/blog/2009/02/02/profile-and-format-mysql-queries-with-the-new-sqlyog-80/](http://www.webyog.com/blog/2009/02/02/profile-and-format-mysql-queries-with-the-new-sqlyog-80/)

A few years ago I tried Navicat and the mysql manager but decided on SQLyog. I'm sure both products have been updated since but I'm still happy with SQLyog which is updated regularly.

[Update] - Just downloaded and installed [NaviCat 8](http://www.navicat.com/en/products/navicat_mysql/mysql_overview.html) for MySQL and was not impressed

After I added this post I reviewed and downloaded v8 of NaviCat for MySQL. In comparison with user interface of SQLyog there is no comparison. SQLyog is better and more intuitive. Especially with the two latest features mentioned earlier. Immediately I noticed how SQLyog keeps you in one window when trying to view the data of a table, while Navicat spawns a new window. The report builder and viewer is the only thing that would put Navicat above SQLyog IMHO, and I already have other means to handle reports using ASP.NET. Try both products and I think you'll agree with me.

![enter image description here](https://i.stack.imgur.com/kdvOR.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T19:14:43.953

虽然我没有任何经验，但我听说 Navicat 将是使用的工具：

[https://www.navicat.com/en/products/navicat-for-mysql](http://mysql.navicat.com/)

我也听说 mysql 的蟾蜍还不错：

[http://www.quest.com/toad-for-mysql/](http://www.quest.com/toad-for-mysql/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T01:15:55.170

[Toad for MySQL](https://mariadb.com/kb/en/library/toad-for-mysql-80/)可以进行“模式比较”和“数据比较”（以及更多）。

它曾经是免费软件，但[最新版本](http://toadformysql.com/index.jspa)不是。[您仍然可以找到旧版本](https://mariadb.com/kb/en/library/toad-for-mysql-80/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T10:53:37.380

我已经使用 Navicat 超过 3 年了。它提供了我需要的所有功能，并为我节省了大量管理和开发 MySQL 和 Oracle 的时间。

[你可以在http://support.navicat.com/visual_tutorial/data_sync.html](http://support.navicat.com/visual_tutorial/data_sync.html)找到关于 Navicat 的数据/结构同步的可视化教程。

# asp.net - 带有自定义验证器的 ASP.Net 字数统计

> ID：52591
> 
> 赞同：3
> 
> 时间：2008-09-09T18:50:45.260
> 
> 标签：asp.net, vb.net, .net-2.0, validation

我正在处理的 ASP.Net 2.0 项目的要求将某个字段限制为最多 10 个单词（不是字符）。我目前正在使用具有以下 ServerValidate 方法的 CustomValidator 控件：

```
Protected Sub TenWordsTextBoxValidator_ServerValidate(ByVal source As Object, ByVal args As System.Web.UI.WebControls.ServerValidateEventArgs) Handles TenWordsTextBoxValidator.ServerValidate
    '' 10 words
    args.IsValid = args.Value.Split(" ").Length <= 10
End Sub 
```

有没有人有更彻底/准确的方法来计算字数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T18:55:57.867

您可以将内置验证器之一与计算单词的正则表达式一起使用。

我对正则表达式有点生疏，所以请放轻松：

```
(\b.*\b){0,10} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T19:48:51.360

这个正则表达式似乎工作得很好：

```
"^(\b\S+\b\s*){0,10}$" 
```

**更新**：上面有一些缺陷，所以我最终使用了这个 RegEx：

```
[\s\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\xBF]+ 
```

我`split()`是那个正则表达式上的字符串，并使用`length`结果数组的 来获得正确的字数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T18:59:54.490

我投票支持 mharen 的答案，并对其进行了评论，但由于默认情况下评论是隐藏的，让我再次解释一下：

您希望使用正则表达式验证器而不是自定义验证器的原因是，正则表达式验证器还将使用 JavaScript 自动验证正则表达式客户端（如果可用）。如果他们通过了验证，那没什么大不了的，但是每次有人未能通过客户端验证时，您就可以避免服务器进行回发。

# .net - PDB 在调试时给了我什么，我怎么知道它在工作？

> ID：52600
> 
> 赞同：7
> 
> 时间：2008-09-09T18:52:52.073
> 
> 标签：.net, debugging, pdb-files

我必须使用没有源代码的第三方组件。我有发布 DLL 和发布 PDB 文件。我们称它为“CorporateComponent.dll”。我自己的代码从此 DLL 创建对象并调用这些对象的方法。

```
CorpObject o = new CorpObject();
Int32 result = o.DoSomethingLousy(); 
```

调试时，“DoSomethingLousy”方法会引发异常。PDB 文件对我有什么作用？如果它做得很好，我怎么能确定我正在使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-09T22:59:51.417

要确认您是否在使用提供的 PDB，CorporateComponent.pdb，在 Visual Studio IDE 中进行调试期间，请查看输出窗口并找到指示 CorporateComponent.dll 已加载并后跟字符串的行`Symbols loaded`。

从我的一个项目中说明：

```
The thread 0x6a0 has exited with code 0 (0x0).
The thread 0x1f78 has exited with code 0 (0x0).
'AvayaConfigurationService.vshost.exe' (Managed): Loaded 'C:\Development\Src\trunk\ntity\AvayaConfigurationService\AvayaConfigurationService\bin\Debug  \AvayaConfigurationService.exe', Symbols loaded.
'AvayaConfigurationService.vshost.exe' (Managed): Loaded 'C:\Development\Src\trunk\ntity\AvayaConfigurationService\AvayaConfigurationService\bin\Debug\IPOConfigService.dll', No symbols loaded. 
```

> `Loaded 'C:\Development\src...\bin\Debug\AvayaConfigurationService.exe', Symbols loaded.`

这表明 IDE 调试器找到并加载了 PDB。

正如其他人所指出的 在检查应用程序中的堆栈帧时，您应该能够看到 CorporateComponent.pdb 中的符号。如果您不这样做，那么第三方可能没有在发布 PDB 构建中包含符号信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-09T19:34:06.793

pdb 包含调试器正确读取堆栈所需的信息。您的堆栈跟踪将包含您拥有 pdb 的模块内的堆栈帧的行号和符号名称。

我将给出两个用法示例。第一个是显而易见的答案。第二个解释源索引 pdb。

第一个用法示例...

根据调用约定和编译器使用的优化，调试器可能无法通过您没有 pdb 的模块手动展开堆栈。某些第三方库甚至操作系统的某些部分都可能发生这种情况。

考虑在 Windows 操作系统内部遇到访问冲突的场景。堆栈跟踪不会展开到您自己的应用程序中，因为该操作系统组件使用了一种特殊的调用约定，这会使调试器感到困惑。如果您将符号路径配置为下载公共 OS pdb，那么堆栈跟踪很有可能会展开到您的应用程序中。这使您能够准确地看到您自己的代码传递给操作系统系统调用的参数。（以及 3rd 方库内部甚至您自己的代码内部的 AV 的类似示例）

第二个使用示例...

Pdb 有另一个非常有用的属性——它们可以使用微软称之为“源索引”的功能与一些源代码控制系统集成。源索引 pdb 包含源控制命令，这些命令指定如何从源控制获取用于构建组件的确切文件版本。Microsoft 的调试器了解如何在调试会话期间执行命令以自动获取文件。这是一个强大的功能，它使调试工程师不必手动将源代码树同步到给定构建的正确标签。它对于远程调试会话和事后分析崩溃转储特别有用。

“windows 调试工具”安装 (windbg) 包含一个名为 srcsrv.doc 的文档，该文档提供了一个示例，演示如何使用 srctool.exe 来确定在给定 pdb 中哪些源文件被源索引。

要回答您的问题“我怎么知道”，调试器中的“模块”功能可以告诉您哪些模块具有相应的 pdb。在windbg 中使用“lml”命令。在 Visual Studio 中，从调试菜单中的某处选择模块。（抱歉，我手边没有当前版本的 Visual Studio）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T18:55:22.237

PDB 是一个数据库文件，它将指令映射到原始代码中的行号，因此当您获得堆栈跟踪时，您将获得代码的行号。如果它是非托管 DLL，那么 PDB 文件还将为您提供堆栈跟踪中函数的名称，而该信息通常仅适用于没有 PDB 的托管 DLL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T18:56:11.457

我从 pdb 获得的主要信息是堆栈跟踪的行号和真实方法名称。

# sql-server - 使用 Windows XP 作为 SQL Server

> ID：52621
> 
> 赞同：4
> 
> 时间：2008-09-09T18:58:36.333
> 
> 标签：sql-server, windows-xp, sql-server-express

我想知道是否有人知道将 Windows XP 用作文件和 SQL 服务器的任何限制。我之所以问，是因为我们销售的其中一个应用程序要求客户设置服务器以进行文件共享并作为 SQL Server。我们已经允许他们使用 SQL Express，但我们想看看是否可以建议将 Windows XP 作为 Windows Server 的低成本替代品。如果对文件或数据库的并发连接数有限制，我可以看到的唯一潜在问题。我们只是考虑向拥有 10 到 15 个用户的小型公司推荐这个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T19:07:11.273

XP Professional上[的入站连接限制为 10](http://support.microsoft.com/default.aspx?kbid=314882)个，XP Home 上的入站连接限制为 5 个。所以它只适用于非常小的公司。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T19:10:07.523

从这篇 MS 知识库文章：

> 注意 对于 Windows XP Professional，允许同时通过网络连接的其他计算机的最大数量为 10。此限制包括所有传输和资源共享协议的组合。对于 Windows XP Home Edition，允许同时通过网络连接的其他计算机的最大数量为五台。此限制是允许系统托管的其他计算机的同时会话数。此限制不适用于从远程计算机附加的管理工具的使用。
> 
> 每次开发：连接限制是指基于重定向器的连接数，并针对任何文件、打印、命名管道或邮件槽会话强制执行。TCP 连接限制未强制执行，但可能会受到法律协议的约束，不允许超过 10 个客户端。

我建议阅读[kb 文章](http://support.microsoft.com/kb/314882)以获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T00:27:08.983

实际上，您可以在 Windows XP Pro 上运行 SQL Server Standard 或 Workgroup Edition。它不仅限于快递版...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T19:10:02.903

一种具有成本效益的替代方案是[Windows Small Business Server](http://en.wikipedia.org/wiki/Small_Business_Server)。 [SBS 2003 R2：功能概览](http://www.microsoft.com/windowsserver2003/sbs/evaluation/features/default.mspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T19:10:39.987

这将破坏 EULA。

这是相关的知识库[文章](http://support.microsoft.com/default.aspx?kbid=314882)。请注意，虽然XP*没有*强制执行 TCP 连接限制，但在法律上它们限制为 10 个连接。

小型企业服务器似乎更合适，如果您货比三家，则具有成本效益。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T03:15:34.517

Small Business Server 的问题在于它附带的所有功能，这对于简单的文件和 sql 服务器来说是不必要的；例如交换服务器、共享点等。我使用 Windows XP 作为小型企业 SQL/文件服务器，但正如其他人指出的那样，从法律上讲，您最多只能连接 10 个连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T02:25:58.997

Small Business Server 的另一个问题是它不能安装在现有域上。最好的办法是围绕正常的 Windows 服务器安装打包 SQL Server 部分。如果您正在查看 10-15 个用户，则无法保证他们拥有域。但如果他们不这样做，他们很可能已经在使用文件服务器上的用户名/密码与他们各自的工作站上相同的帐户来处理文件服务器问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-11-19T11:49:31.023

连接数与 SQL Server 版本无关，与操作系统有关。例如，Windows XP 只允许 10 个并发连接，Windows 7 20。对于 Windows Server OS [无需购买任何新的服务器机器]，连接数是无限的（但您可以限制使用终端服务）。达到连接限制时显示的错误消息类似于“已达到安全限制......并发连接尝试的数量”

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-10-09T11:35:56.657

大概你的意思是 SQL Express，因为你不能在 XP 上运行 SQL Server，它是一个服务器产品。

如果客户买得起您的产品，他们就可以买得起 Server 2003 的副本，或者其他任何内置的文件共享。诚然，SQL Server 相当昂贵，但如果您的产品需要它，那就是它的方式。如果成本是一个问题，您不应该使用 SQL Server 作为数据库平台。试图将基于服务器的解决方案强制用于客户端操作系统是没有意义的。你很快就会遇到各种各样的问题。

客户不是已经拥有基于域的基础架构了吗？

结果是，如果客户有 5-10 个软件用户，出于各种其他原因，他们无论如何都应该在 SBS 上。但是，您没有使用 SQL Server。

（Samba 将是文件共享的一个选项，但无疑比在这种情况下简单地购买 Server 2003 更昂贵）。

# sql-server - 从源代码管理自动化数据库对象迁移

> ID：52626
> 
> 赞同：2
> 
> 时间：2008-09-09T18:59:57.017
> 
> 标签：sql-server, version-control, build-automation, starteam

我正在寻找一些“最佳实践”，用于从源代码控制自动部署存储过程/视图/函数/表更改。我正在使用 StarTeam 和 ANT，因此标签得到处理；我正在寻找的是你们中的一些人如何从源头自动提取这些对象 - 不一定是 StarTeam。

我想最终得到一个可以执行、签入和标记的脚本。

我不是要求任何人写这些 - 只是一些过去已经（或没有）工作的想法或方法。

我正在努力收拾烂摊子，并希望确保我尽可能地接近“正确”。

我们将表/视图/函数等存储在 StarTeam 的单个文件中，我们的数据库是 SQL 2K5。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T19:23:19.177

我们使用 redgate ( [http://www.red-gate.com/](http://www.red-gate.com/) ) 的 SQL 比较。

我们有一个生产数据库，一个开发数据库，​​每个开发人员都有自己的数据库。

开发数据库与开发人员在签入更改时对其数据库所做的更改同步。

开发人员还签入同步脚本和 SQL Compare 生成的比较报告。

当我们部署我们的应用程序时，我们只需使用 SQL Compare 将开发数据库与生产数据库同步。

这对我们有用，因为我们的应用程序仅供内部使用。如果这不是您的情况，那么我会查看 SQL Packager（也来自 redgate）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T19:08:57.353

我更喜欢将视图、过程和触发器（可以随意重新创建的对象）与表分开。对于视图、过程和触发器，只需编写一个作业来检查它们并重新创建最新的。

对于表，我更喜欢只有一行的数据库版本表。使用该表来确定尚未应用哪些新更新。然后应用每次更新并更新版本号。如果更新失败，您只需检查该更新，并且您可以重新运行，知道之前的更新不会再次发生。

# asp.net - GridView 不会更新底层数据源

> ID：52634
> 
> 赞同：1
> 
> 时间：2008-09-09T19:02:14.983
> 
> 标签：asp.net, linq-to-sql, data-binding

所以我整天都在研究这个问题。我有一个指向我的模型的 LinqDataSource 和一个使用它的 GridView。当我尝试对 GridView 进行更新时，它不会更新底层数据源。我认为这可能与 LinqDataSource 有关，所以我添加了一个 SqlDataSource 并且发生了同样的事情。aspx如下（代码隐藏页面为空）：

```
 <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
      ConnectionString="Data Source=devsql32;Initial Catalog=Steam;Persist Security Info=True;" 
      ProviderName="System.Data.SqlClient" 
      SelectCommand="SELECT [LangID], [Code], [Name] FROM [Languages]" UpdateCommand="UPDATE [Languages] SET [Code]=@Code WHERE [LangID]=@LangId">
  </asp:SqlDataSource>
  <asp:GridView ID="_languageGridView" runat="server" AllowPaging="True" 
      AllowSorting="True" AutoGenerateColumns="False" DataKeyNames="LangId" 
      DataSourceID="SqlDataSource1">
      <Columns>
          <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" />
          <asp:BoundField DataField="LangId" HeaderText="Id" ReadOnly="True" />
          <asp:BoundField DataField="Code" HeaderText="Code" />
          <asp:BoundField DataField="Name" HeaderText="Name" />
      </Columns>
  </asp:GridView>
  <asp:LinqDataSource ID="_languageDataSource" ContextTypeName="GeneseeSurvey.SteamDatabaseDataContext" runat="server" TableName="Languages" EnableInsert="True" EnableUpdate="true" EnableDelete="true">
 </asp:LinqDataSource> 
```

我到底在这里想念什么？这个问题快把我逼疯了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T19:10:57.550

您缺少数据源的 <UpdateParameters> 部分。

[LinqDataSource.UpdateParameters](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linqdatasource.updateparameters.aspx)

[SqlDataSource.UpdateParameters](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sqldatasource.updateparameters.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T20:41:02.047

事实证明，我们在 aspx 文件的母版页的 Page_Load 中有一个 DataBind() 调用，这可能导致 GridView 的状态在每次页面加载时都被抛出。

请注意 - 不需要更新 LINQ 查询的参数，除非您想将它们设置为一些非空默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T19:09:12.097

因为我根本没有使用过 ASP，所以这完全是在黑暗中拍摄的。

我一直在学习 XAML 和 WPF，这似乎与您在上面发布的内容非常相似，而且我知道对于某些 UI 控件，您需要将绑定模式指定为双向，以便双向获取更新.

# php - 最佳实践：合法的跨站脚本

> ID：52646
> 
> 赞同：20
> 
> 时间：2008-09-09T19:09:56.603
> 
> 标签：php, javascript, xss

虽然跨站点脚本通常被认为是负面的，但我遇到了几种必要的情况。

我最近在一个非常有限的内容管理系统的范围内工作。我需要在页面中包含数据库代码，但托管服务器没有任何可用的东西。我在自己的服务器上设置了几个简单的脚本，最初认为我可以使用 AJAX 将脚本的内容直接导入到 CMS 的模板中（从而保留动态图像、菜单项、CSS 等）。我错了。

由于`XMLHttpRequest`对象的限制，不可能从不同的域中获取内容。所以我想到了*iFrame——*尽管我不喜欢框架，但我认为我可以创建一个与内容的宽度和高度相匹配的框架，这样它就会显得原生。再一次，我被跨站点脚本“保护”阻止了。虽然我确实可以将远程文件加载到*iFrame*中，但我无法执行 JavaScript 在主机页面或加载页面内修改其大小。

在这种特殊情况下，我无法将子域指向我的服务器。 **我也无法在 CMS 服务器上创建可以代理服务器内容的脚本，所以我最后的想法是使用远程 JavaScript。**

远程 JavaScript 工作。当用户禁用 JavaScript 时，它会中断，这是一个缺点；但它有效。我在使用远程 JavaScript 时遇到的“问题”是我必须使用 JS 函数`document.write()`来输出任何内容。任何不是 JS 的输出都会导致脚本错误。除了`document.write()`为每一行使用之外，您还必须确保内容被转义 - 否则您最终会遇到更多脚本错误。

我的解决方案如下：

我的脚本收到一个 GET 参数（“页面”），然后查找文件（`{$page}.php`），并将内容读入变量。但是，我不得不使用笨拙的缓冲技术来实际执行包含的脚本（用于数据库交互等），然后剥离所有换行符 ( `\n`) 的最终内容，然后转义所有必需的字符。最终结果是我的原始脚本（输出 JavaScript）访问了我服务器上看似“标准”的脚本，并将它们的标准输出转换为 JavaScript，以便在 CMS 模板中显示。

虽然这个解决方案有效，但似乎有更好的方法来完成同样的事情。使跨站点脚本专门用于包含来自完全不同域的内容的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-09T20:01:19.863

你有三个选择：

1.  创建[服务器端代理脚本](http://developer.yahoo.com/javascript/howto-proxy.html)。
2.  创建一个远程脚本以读取远程动态 HTML。使用像[jQuery](http://www.jquery.com)这样的库可以让这更容易。您可以使用[load 函数](http://docs.jquery.com/Ajax/load)在需要的地方注入 HTML。**编辑**我最初的意思是例如＃2 是利用[JSONP](http://en.wikipedia.org/wiki/JSON#JSONP)，这需要服务器端脚本识别“回调=？” 参数。

3.  使用[客户端 Flash 代理](http://www.adobe.com/devnet/flash/articles/external_interface.html)并在服务器的 Web 根目录上设置[crossdomain.xml文件。](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14213)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T19:12:55.300

就个人而言，我会调用*服务器上的*其他域并获取并解析那里的数据以在您的页面中使用。这样您就可以避免任何问题，并获得服务器端语言/平台的强大功能来获取和解析数据。

不确定这是否适用于您的特定场景...即使您的详细描述也很难知道...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-05T21:32:53.183

您可以尝试[easyXDM](http://easyxdm.net)，通过包含很少的代码，您可以在不同域的文档之间传递数据或方法调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T17:43:08.663

我以前遇到过那个[YDN 服务器端代理脚本](http://developer.yahoo.com/javascript/howto-proxy.html)。它说它是为与雅虎的搜索 API 一起工作而构建的。

如果您只是修剪雅虎 API 代码，它是否适用于任何域？或者您是否需要将其替换为您希望它使用的域？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-10T12:27:27.620

iframe 远程内容可以通过本地 javascript 访问。

远程服务器只需要设置`document.domain`页面。

**例如：**

站点 A 包含一个 iframe`src='Site B/home.php'`

home.php 看起来像这样：

```
[php stuff]...[/php]
[script type='text/javascript']document.domain='Site A'[/script] 
```

# python - Python中漂亮的图形和图表

> ID：52652
> 
> 赞同：130
> 
> 时间：2008-09-09T19:11:45.787
> 
> 标签：python, graphics

有哪些可用的库可用于在 Python 应用程序中创建漂亮的图表和图形？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-09-16T21:43:33.117

我是支持 CairoPlot 的人，我很自豪它出现在这里。当然 matplotlib 很棒，但我相信 CairoPlot 更好看。因此，对于演示文稿和网站来说，这是一个非常不错的选择。

今天我发布了1.1版本。如果有兴趣，请查看[CairoPlot v1.1](http://linil.wordpress.com/2008/09/16/cairoplot-11/)

编辑：经过漫长而寒冷的冬天，CairoPlot 正在重新开发。[在GitHub 上](https://github.com/rodrigoaraujo01/cairoplot)查看新版本。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-09-16T23:51:24.603

对于交互式工作，[Matplotlib](http://matplotlib.sourceforge.net/)是成熟的标准。它提供了 OO 风格的 API 以及 Matlab 风格的交互式 API。

[Chaco](http://code.enthought.com/chaco/)是来自 Enthought 的一个更现代的绘图库。它使用 Enthought 的 Kiva 矢量绘图库，目前仅适用于带有 OpenGL 的 Wx 和 Qt（Matplotlib 具有 Tk、Qt、Wx、Cocoa 和许多图像类型如 PDF、EPS、PNG 等的后端）。Chaco 的主要优势在于它相对于 Matplotlib 的速度以及它与 Enthought 的 Traits API 的集成以用于交互式应用程序。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-10T05:22:58.767

您还可以使用[pygooglechart](http://pygooglechart.slowchop.com/)，它使用[Google Chart API](http://code.google.com/apis/chart/)。这不是您一直想要使用的东西，但是如果您想要少量好的、简单的图表，并且始终在线，尤其是如果您无论如何都在浏览器中显示，那么它是一个不错的选择。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-29T13:42:20.177

您没有提到您需要什么输出格式，但reportlab 擅长创建pdf 和位图（例如png）格式的图表。

这是一个简单的 png 和 pdf 格式的条形图示例：

```
from reportlab.graphics.shapes import Drawing
from reportlab.graphics.charts.barcharts import VerticalBarChart

d = Drawing(300, 200)

chart = VerticalBarChart()
chart.width = 260
chart.height = 160
chart.x = 20
chart.y = 20
chart.data = [[1,2], [3,4]]
chart.categoryAxis.categoryNames = ['foo', 'bar']
chart.valueAxis.valueMin = 0

d.add(chart)
d.save(fnRoot='test', formats=['png', 'pdf']) 
```

[替代文字 http://i40.tinypic.com/2j677tl.jpg](http://i40.tinypic.com/2j677tl.jpg)

*注：图片已被图片宿主转换为jpg。*

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-09T20:05:13.567

[开罗图](http://linil.wordpress.com/2008/06/14/cairoplot-plotting-graphics-using-python-and-cairo/)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-07-03T14:40:17.293

我使用了pychart，认为它非常简单。

[http://home.gna.org/pychart/](http://home.gna.org/pychart/)

它都是原生的 python，没有大量的依赖。我确定 matplotlib 很可爱，但我会下载和安装好几天，我只想要一个 measley 条形图！

它似乎在几年内没有更新，但嘿，它有效！

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-04T09:43:10.483

如果您喜欢使用[gnuplot](http://www.gnuplot.info/)进行绘图，您应该考虑[Gnuplot.py](http://gnuplot-py.sourceforge.net/)。它为 gnuplot 提供了一个面向对象的接口，还允许您将命令直接传递给 gnuplot。不幸的是，它不再被积极开发。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-09T19:13:55.827

你看过[ChartDirector for Python](http://www.advsofteng.com/cdpython.html)吗？

我不能谈论这个，但我使用 ChartDirector for PHP，它非常好。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-09T19:13:56.530

[NodeBox](http://nodebox.net/code/index.php/Library)非常适合创建原始图形。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-09T22:11:56.447

来自[enthought的](http://www.enthought.com/)[Chaco](http://code.enthought.com/chaco/)是另一种选择

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-16T22:10:34.083

您还应该考虑 PyCha [http://www.lorenzogil.com/projects/pycha/](http://www.lorenzogil.com/projects/pycha/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-26T06:34:38.303

我是 PyOFC2 的粉丝：http: [//btbytes.github.com/pyofc2/](http://btbytes.github.com/pyofc2/)

它只是一个包，可以轻松生成 Open Flash Charts 2 所需的 JSON 数据，非常漂亮。查看上面链接中的示例。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-10-02T19:05:45.337

请查看 WHIFF 的 Open Flash Chart 嵌入 [http://aaron.oirt.rutgers.edu/myapp/docs/W1100_1600.openFlashCharts](http://aaron.oirt.rutgers.edu/myapp/docs/W1100_1600.openFlashCharts) 和 WHIFF 的 amCharts 嵌入[http://aaron.oirt.rutgers.edu/myapp/ amcharts/文档](http://aaron.oirt.rutgers.edu/myapp/amcharts/doc)。谢谢。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-22T16:34:04.447

[PLplot](http://plplot.sourceforge.net/) is a cross-platform software package for creating scientific plots. They aren't very pretty (eye catching), but they look good enough. Have a look at [some examples](http://plplot.sourceforge.net/examples.php) (both source code and pictures).

The PLplot core library can be used to create standard x-y plots, semi-log plots, log-log plots, contour plots, 3D surface plots, mesh plots, bar charts and pie charts. It runs on Windows (2000, XP and Vista), Linux, Mac OS X, and other Unices.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-10T05:49:11.403

你也可以考虑[谷歌图表](http://code.google.com/apis/chart/)。

从技术上讲，它不是一个 python API，但你可以从 python 中使用它，它的编码速度相当快，而且结果看起来不错。如果您碰巧在线使用您的地块，那么这将是一个更好的解决方案。

# linq - 人们如何对使用 Linq to SQL 的代码进行单元测试

> ID：52657
> 
> 赞同：58
> 
> 时间：2008-09-09T19:13:59.947
> 
> 标签：linq, unit-testing, linq-to-sql

人们如何对使用 Linq to SQL 的代码进行单元测试？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T05:32:03.767

更新：

Fredrik 在他的博客中提供了一个关于如何对 linq2sql 应用程序进行单元测试的示例解决方案。您可以在以下位置下载它：

[http://web.archive.org/web/20120415022448/http://iridescence.no/post/DataContext-Repository-Pattern-Example-Code.aspx](http://web.archive.org/web/20120415022448/http://iridescence.no/post/DataContext-Repository-Pattern-Example-Code.aspx)

我认为他发布了一个示例解决方案不仅很棒，而且他还设法为所有类提取了接口，这使得设计更加解耦。

我的旧帖：

*我发现这些博客是制作 DataContext 包装器的良好开端： [Link1](http://web.archive.org/web/20120414060200/http://iridescence.no/post/Linq-to-Sql-Programming-Against-an-Interface-and-the-Repository-Pattern.aspx) [Link2](http://nixusg.com/post/2008/08/05/The-Automated-Testing-Continuum-Part-2-(Unit-Testing-LinQ).aspx)

它们涵盖了几乎相同的主题，除了第一个实现了为表提取接口的方法。第二个更广泛，所以我也包括在内。 *

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-02-19T22:32:30.630

晚了 3 年，但这就是我的做法：

[https://github.com/lukesampson/LinqToSQL-test-extensions/](https://github.com/lukesampson/LinqToSQL-test-extensions/)

无需编写包装器或做大量的工作，只需将 T4 模板放在 .dbml 旁边即可：

1.  数据上下文的接口，例如 IExampleDataContext
2.  用于数据上下文的内存模拟，例如 MemoryExampleDataContext

两者都将自动使用您已经在 DBML 中配置的映射。

所以你可以做类似的事情

```
public class ProductRepo {
    IExampleDataContext DB { get; set };
    public ProductRepo(IExampleDataContext db) {
        DB = db;
    }

    public List<Product> GetProducts() {
        return DB.Products.ToList();
    }
} 
```

你可以用任何一个来调用它

```
new ProductRepo(new MemoryExampleDataContext()).GetProducts(); // for testing 
```

或者

```
new ProductRepo(new ExampleDataContext()).GetProducts(); // use the real DB 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T19:56:25.617

包装 DataContext，然后模拟包装器。这是完成它的最快方法，尽管它需要为测试编码，有些人认为这很奇怪。但有时，当您有无法（轻松）模拟的依赖项时，这是唯一的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T19:20:09.120

通常，您不需要测试使用 LINQ to SQL 的代码部分，但如果您真的想要，您可以使用您在服务器上查询的相同数据集并将它们转换为内存中的对象和对此运行 LINQ 查询（这将使用 Enumerable 方法而不是 Queryable）。

另一种选择是使用 Matt Warren 的可[模拟版本的 DataContext](http://blogs.msdn.com/mattwar/archive/2008/05/04/mocks-nix-an-extensible-linq-to-sql-datacontext.aspx)。

您还可以通过调试器（从 IQueryable 对象）获取 LINQ to SQL 使用的 SQL 语句，手动检查这些语句，然后将它们包含在自动化测试中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-09T19:23:26.913

Linq 使测试变得更加容易。Linq 查询在 Lists 上和在 Linq-to-sql 的东西上一样好。您可以将 Linq 换成 SQL 以获取列表对象并以这种方式进行测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-09T20:55:16.240

[The Wayward Web Log](http://blogs.msdn.com/mattwar/archive/2008/05/04/mocks-nix-an-extensible-linq-to-sql-datacontext.aspx)上的Mattwar有一篇很棒的文章，介绍了如何模拟可扩展的 Linq2Sql 数据上下文。看看[——MOCKS NIX——一个可扩展的 LINQ TO SQL DATACONTEXT](http://blogs.msdn.com/mattwar/archive/2008/05/04/mocks-nix-an-extensible-linq-to-sql-datacontext.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-05T11:36:18.063

LINQ to SQL 实际上非常适合进行单元测试，因为它能够根据 DBML 中定义的内容动态创建数据库。

通过通过 DataContext 创建 DB 并将其设为空来测试 ORM 层非常好。

我在这里的博客上介绍了它：http://web.archive.org/web/20090526231317/http: [//www.aaron-powell.com/blog/may-2008/unit-testing-linq-to-sql。 aspx](http://web.archive.org/web/20090526231317/http://www.aaron-powell.com/blog/may-2008/unit-testing-linq-to-sql.aspx)

# asp.net-mvc - ASP.NET MVC 快速入门——一站式教程？

> ID：52668
> 
> 赞同：29
> 
> 时间：2008-09-09T19:18:40.730
> 
> 标签：asp.net-mvc

有许多 ASP.MVC 博客文章零碎散布在不同的网站上，还有一些资源问题 - [ASP.NET 模型-视图-控制器 (MVC) - 我从哪里开始？](https://stackoverflow.com/questions/14599/aspnet-model-view-controller-mvc-where-do-i-start-from)和[MVC 学习资源](https://stackoverflow.com/questions/10425/mvc-learning-resources)

我想知道是否有关于 ASP.NET MVC 入门的一站式教程？

谢谢！

**编辑：**我可能需要澄清一下——一个一站式的教程，它有助于在一两个小时内开始学习，并在我学习的过程中学到更多……阅读书籍对我个人来说是一个非首发——需要更多的时间我能负担得起并从基础开始...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-09T19:22:09.413

你看过CodePlex上的[MVC 示例吗？](http://www.codeplex.com/mvcsamples)Rob Conery 有一些与网站创建相关的截屏视频，网址为[http://blog.wekeroad.com/mvc-storefront/](http://blog.wekeroad.com/mvc-storefront/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T21:52:42.450

Scott Guthrie 编写了使用 MVC 创建完整 Web 应用程序的免费完整端到端教程，它涉及 MVC 的大部分主要部分：

*   [NerdDinner.com](http://nerddinner.com/)
*   [如何构建 NerdDinner.com 的代码演练](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T19:51:44.693

不要忘记[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/)。关于 MVC 的最新消息。“官方”网站落后了两个版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T19:20:04.050

[http://www.asp.net/mvc](http://www.asp.net/mvc)

哎呀，在我完成之前提交。ASP.NET MVC 站点有大量关于 ASP.NET MVC 入门的视频/截屏视频。一定要先看斯科特汉塞尔曼的。

### 编辑

[@David 提供](https://stackoverflow.com/questions/52668/aspnet-mvc-quick-start-a-one-stop-tutorial#52675)的 Rob Conery 截屏视频也在[ASP.NET MVC 站点](http://www.asp.net/learn/mvc-videos/)的视频下提供。这将构成获取这些资源以及 ASP.NET MVC 团队推出的资源的地方。

关于您使用的任何资源的注释。您可能会遇到框架中不再可用的功能，因为它正在开发中。如果您使用随教程一起提供的资源，您将找到替代品或如何绕过它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T19:21:11.817

[快速入门](http://quickstarts.asp.net/3-5-extensions/mvc/MVCOverview.aspx)很好地概述了所有功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T16:17:55.420

希望随着我们接近发布，[http://asp.net/mvc](http://asp.net/mvc)将成为 ASP.NET MVC 相关问题的一站式商店。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T00:27:42.870

除了上面提到的：

*   [http://weblogs.asp.net/stephenwalther](http://weblogs.asp.net/stephenwalther)
*   [Asp.net MVC in Action](http://www.manning.com/palermo/)看起来是一本好书。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T17:29:06.170

我们最近刚刚发布了[TheBeerHouse MVC 版](http://www.codeplex.com/TheBeerHouse/SourceControl/ListDownloadableCommits.aspx)的测试版，它应该会给你一些很好的例子。还有一本书解释了一切，但你必须再等一会儿才能出来：D。

# makefile - 在make变量中反转字符串顺序的最简单方法

> ID：52674
> 
> 赞同：14
> 
> 时间：2008-09-09T19:21:23.127
> 
> 标签：makefile

假设您在 makefile 片段中有一个变量，如下所示：

```
MY_LIST=a b c d 
```

然后我如何颠倒该列表的顺序？我需要：

```
$(warning MY_LIST=${MY_LIST}) 
```

显示

```
MY_LIST=d c b a 
```

编辑：真正的问题是

```
ld -r some_object.o ${MY_LIST} 
```

产生`a.out`带有未定义符号的 an，因为其中的项目`MY_LIST`实际上是档案，但顺序错误。如果顺序`MY_LIST`颠倒，它将正确链接（我认为）。如果您知道正确获取链接顺序的更聪明的方法，请提示我。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-24T16:07:43.810

纯 GNU make 的解决方案：

> 默认：全部
> 
> foo = 请反转我
> 
> reverse = $(if $(1),$(call reverse,$(wordlist 2,$(words $(1)),$(1)))) $(firstword $(1))
> 
> all : @echo $(call reverse,$(foo))

给出：

> $ 制作
> 
> 请把我倒过来

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-10T14:59:40.200

对 GNU make 解决方案的改进：

> reverse = $(if $(wordlist 2,2,$(1)),$(call reverse,$(wordlist 2,$(words $(1)),$(1))) $(firstword $(1) ),$(1))

*   更好的停止条件，原来使用空字符串浪费了一个函数调用
*   与原始列表不同，不会在反向列表中添加前导空格

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T19:39:52.803

嗬！我本可以只使用一个 shell script-let：

`(for d in ${MY_LIST}; do echo $$d; done) | tac`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-09T21:04:44.003

您还可以使用 ld 定义搜索组：

```
ld -r foo.o -( a.a b.a c.a -) 
```

将遍历 aa、ba 和 ca，直到组中的任何对象都不能满足新的未解析符号。

如果您使用的是 gnu ld，您还可以执行以下操作：

```
ld -r -o foo.o --whole-archive bar.a 
```

稍微强一点，因为它将包含来自 bar.a 的每个对象，无论它是否满足来自 foo.o 的未解析符号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-28T15:10:38.020

根据[Ben Collins](https://stackoverflow.com/a/52722/309233)和[elmarco 的](https://stackoverflow.com/a/52697/309233)答案，这里有一个 bash 可以“正确”处理空格¹

```
reverse = $(shell printf "%s\n" $(strip $1) | tac) 
```

这样做是正确的，这要归功于`$(shell)`自动清除空格并`printf`自动格式化其 arg 列表中的每个单词：

```
$(info [ $(call reverse,  one two   three four  ) ] ) 
```

产量：

```
[ four three two one ] 
```

¹ ...根据我有限的测试用例（即`$(info ...)`上面的行）。

# windows - 最喜欢的 Windows 键盘快捷键

> ID：52676
> 
> 赞同：34
> 
> 时间：2008-09-09T19:22:18.460
> 
> 标签：windows, keyboard-shortcuts

我是一个键盘迷。我喜欢有一个键序列来做所有事情。你最喜欢的键盘快捷键是什么？

我将从命名我的几个开始：

1 - `Alt`-`Space`访问当前窗口的窗口菜单

2 -`F2`在 Windows 资源管理器中重命名文件

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-09T19:26:26.577

`Win`+`Pause/Break`调出计算机信息并访问*高级*选项卡下的环境变量。

`Win`+`R`直接进入运行框（尽管自从我开始使用[Launchy](http://www.launchy.net/)以来我几乎不再使用它）。

当然`Alt`+`Tab`但也`Alt`+ `Shift`+`Tab`用于倒退。

哦，就个人而言，我讨厌`Ctrl`+`F4`用于关闭标签 - 太多的小指伸展。

哦，在 Windows 7 上尝试`Win`+ （开启*[Aero](http://en.wikipedia.org/wiki/Windows_Aero)*）。`Tab`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-09T20:37:27.220

**`Win`+ `1`..`9`** -- 在该索引处启动快速启动快捷方式 (Windows Vista)。

**`Ctrl`+ `Scroll Lock`,`Scroll Lock`** -- 使您的计算机崩溃：*[Windows 功能允许您使用键盘生成内存转储文件](http://support.microsoft.com/kb/244139)*

@gabr - `Win`+`D`是*show desktop*，`Win`+`M`最小化所有窗口。点击`Win`+`D`两次可以恢复所有内容，因为它只在其他窗口前面显示了桌面窗口。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-09T19:25:50.527

*   `Alt`-`F4`关闭程序。
*   `WindowsKey`+`L`锁定我的工作站
*   `Ctr`- `Shift`-`Ins`从文本框中复制文本
*   `Alt`-`Print Screen`只拍摄一扇窗户的照片
*   `WindowsKey`+`R`打开“运行”对话框（仅限 XP Pro - 在 XP Home 上执行其他操作）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-09T19:26:59.260

*   `Win`-`D`最小化所有应用程序
*   `Ctrl`- `Shift`-`Esc`打开任务管理器

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-09T19:26:26.157

`Win`-`L`锁定计算机..

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-17T07:04:05.330

最大化窗口：`Alt`+ `Space`，`X`
恢复窗口：`Alt`+ `Space`，`R`
最小化窗口：`Alt`+ `Space`，`N`
关闭窗口：`Alt`+ `Space`，`C`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-09T19:28:26.417

*   `F4`在 Windows 资源管理器中轻松访问位置栏。
*   `Menu`键（在右侧的 windows 键旁边） + `W`+`F`在资源管理器中创建一个新文件夹。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-09T20:02:36.257

我也试着坚持我的键盘。我经常用...

*   `Win`+`L`锁定我的系统
*   `Alt`+`F4`关闭程序
*   `Win`+`R`从运行窗口启动（用于频繁的程序，而不是通过 QuickLaunch）
*   `F2`重命名文件
*   `Win`+`D`转到桌面
*   `Alt`+`Tab`和`Alt`++`Tab`循环`Shift`浏览打开的程序

## 视觉工作室

*   `Alt`, `D`(调试), `P`(进程), `W`(webdev 进程)
*   `Alt`, `T`(工具), `P`(进程), `W`(webdev 进程) 用于 VS 2008
*   `Alt`, `M`,`O`折叠到定义
*   `F5`推出
*   `F9`, `F10`, 和`F11`用于单步调试器
*   `Alt`+ `K`,`D`格式化文档
*   `Alt`+ `K`,`C`发表评论
*   `Alt`+ `K`,`U`取消注释

## 浏览器

*   `Alt`+`W`关闭标签
*   `F6`专注于地址栏

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-11-12T02:37:03.623

这怎么不在这里？

`![](https://farm6.staticflickr.com/5214/5472803412_953823394a_o.jpg)`+`Pause` 到**`System Information`**. 然后系统**`PATH`**变量只需单击 2 次即可（[高级系统设置](https://www.facebook.com/pages/Whole-Wide-World/237126446329079?ref=hl)，`Environment Variables...`）

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-09T19:24:15.617

1.  `Win`+`E`打开 Windows 资源管理器参考
2.  `Win`+`R`来自运行框
3.  `Ctrl`+`Esc`打开开始菜单

当然，还有`Alt`+`F4`来关闭事物。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-17T04:50:54.090

适用于大多数 Windows 程序的剪贴板操作、文本选择和导航的一些基本键盘快捷键：

**剪贴板**

*   `Ctrl`+ `X`- 剪贴板剪切
*   `Ctrl`+ `C`- 剪贴板复制
*   `Ctrl`+ `V`- 剪贴板粘贴

**选择文本**

*   `Ctrl`+ `A`- 全选（在当前字段或文档中）
*   `Shift`+[导航`▲</kbd>/`▼</kbd>, `Home`/`End`, or `Pg Up`/`Pg Dn`] - Select text between the caret's previous and new positions. Continue to hold `Shift` and navigate to select more text.``

**导航**

*   `Ctrl`+ `left arrow`/ `Ctrl`+ `right arrow`- 将插入符号移动到上一个/下一个单词
*   `Ctrl`+ `Home`/ `Ctrl`+ `End`- 转到当前字段或文档的开头/结尾

**奖金提示！**

*   在提交您已在文本字段中输入大量文本的 Web 表单之前（例如，基于 Web 的邮件客户端中的电子邮件 - 或 Stack Overflow 上的新问题或答案！），请快速执行`Ctrl`+ `A`, `Ctrl`+`C`在球场上。这样，如果提交出现问题（即使浏览器崩溃），您的工作并没有丢失——剪贴板上有一份副本。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-09-10T19:12:10.753

`Ctrl`++`Shift`直接`Esc`进入任务管理器，无需任何中间对话框。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-10T18:52:58.943

我使用免费的[AutoHotKey](http://www.autohotkey.com/)，然后定义自己的快捷方式：

*   dobule`F4`快速点击 => 关闭活动窗口（如 Alt+F4，但仅用一根手指）
*   快速双击`Right Alt`=>[查找并运行机器人](http://www.donationcoder.com/Software/Mouser/findrun/index.html)任务管理器
*   `F12`=> 打开 Find and Run Robot Locate32 插件（我使用它就像一个非常轻量级的桌面搜索）
*   `Ctrl`+ `Up`/`Down`在命令窗口中 => 像鼠标滚轮一样向后/向前滚动命令行
*   `Ctrl`+`w`在命令窗口中 => 关闭窗口

等等

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-10-28T14:39:31.623

在 calc, `F5`, `F6`, `F7`, `F8`Hex、Dec、Oct、Bin 模式之间循环。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-17T07:00:26.150

在 Windows Vista 上，如果您打开“开始”菜单并搜索程序，按`Ctrl`+ `Shift`+`Enter`将以管理员身份运行所选程序。因此，要打开管理员命令提示符：

`Windows`键，键入“cmd” ，`Ctrl`++`Shift``Enter`

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-12-20T12:19:16.333

当您有一个窗口卡在应用栏下并且无法访问该窗口的系统菜单来移动它时：

`alt`- `spacebar`-> `M`-> `arrow keys`->`return`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-09T19:28:28.710

1.  `![](https://farm6.staticflickr.com/5214/5472803412_953823394a_o.jpg)`+[type name of program] 在 Vista 中启动一个程序
2.  `![](https://farm6.staticflickr.com/5214/5472803412_953823394a_o.jpg)`+`E`探险家
3.  `![](https://farm6.staticflickr.com/5214/5472803412_953823394a_o.jpg)`+`F`用于查找
4.  `Alt`+`Tab`在程序之间交换
5.  `Ctrl`+`Tab`在标签之间切换

不是真正的“Windows”快捷方式，但使用[WinSplit Revolution](http://www.winsplit-revolution.com/)移动和调整窗口大小并将它们移动到另一台显示器的 ++ 和 ++[箭头`Ctrl`]绝对`Alt`很棒。没有它们，我永远不会使用大型或多台显示器。`numpad``Ctrl``Alt`

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-09T19:42:11.877

`win`+`M`最小化所有。对于快速访问桌面很有用。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-09-09T20:04:50.213

我个人最喜欢的是`WinKey`, `U`, `Enter`- 关闭 Windows！;-)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-09-27T12:15:45.913

*   `Win`+ `Pause`/`Break`系统属性
*   `Win`+ `E`: 打开 Windows 资源管理器
*   `Win`+ `F`: 查找
*   `Win`+ `R`：运行
*   `Win`+ `M`: 最小化所有窗口
*   `Win`+ `Shift`+ `M`: 恢复所有窗口
*   `Alt`+ `F4`: 关闭程序
*   `Alt`+ `Tab`: 在任务之间切换
*   `Ctrl`+ `Alt`+ `Del`: 任务管理器

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-12-20T12:03:15.010

1.  **`Ctrl`+ `Shift`+`ESC`**：*运行任务管理器*
2.  **`Ctrl`/ `Shift`+`Insert`** :*复制/粘贴*
3.  **`Shift`+`Delete`**：*剪切（文本）*
4.  **`Win`+`L`** :*锁定系统*
5.  **`Win`+`R`**：*运行*
6.  **`Ctrl`+`Pause Break`**：*中断循环（编程）*
7.  **`Ctrl`+`Tab`**：*标签更改*

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-09T19:31:58.250

重复`Ctrl`+ `Alt`+`Del`两次！

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-21T09:39:00.010

`Ctrl`+ `Shift`+ `Esc`-> 打开任务管理器

`Ctrl`+ `W`-> 关闭 MDI 中 Ctrl+F4 不起作用的窗口

那些和`Win`+`Number`是Vista经常使用。

还有一个不错的技巧是`Win`+ `Tab`-> 在 Windows Xp 和 Server 2003 的任务栏上循环浏览程序组。（即与没有预览的 Vista 相同）。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-05-09T19:19:35.113

许多人说`Win`-`D`最小化所有应用程序。不对。它只是显示桌面。使用 Win-M 最小化所有打开的窗口。使用 Win-Shift-M 将它们恢复到以前的状态。

顺便说一句，您是否注意到 Sift 键可以与大多数常用快捷键结合使用？例如 Alt+Tab ：循环浏览应用程序 1->2->3->4->...1 将 Shift 添加到快捷方式，您将在相反的方向循环 1<-2<-3<-4<- ...1

Control+Tab 在大多数 Windows 应用程序中的选项卡之间切换（遗憾的是在 Eclipse 中没有） - 您已经可以猜到 Ctr+Shift+Tab 会做什么。在 Firefox、IE 等中特别方便......您打开了多个选项卡并尝试转到前一个选项卡。非常便利。

还有一个提示，这**太方便**了，我喜欢它。几周前才发现：

**FireFox**用户：厌倦了`rightclick->Open Link in New Tab`？

使用鼠标中键单击链接，它将在新选项卡中打开（取决于您在工具->选项中的选项卡设置，但默认情况下会起作用）。神奇的是，它甚至适用于浏览器的后退按钮！此外，当您在 Google 框中（通常在右上角）中键入搜索词并中键单击搜索按钮时，搜索结果将在新选项卡中打开。使用鼠标中键关闭选项卡也容易得多（当然您可以使用 Ctrl+W，但有时鼠标就在您的手中）。您不必单击选项卡的红色按钮来关闭它。只需在选项卡上的任意位置单击鼠标中键即可将其关闭。

**编辑** 我刚刚尝试了 IE 7 中的中间按钮，并且似乎像在 FF 中一样工作，除了`Back`-button 和 Search 小部件。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-09T19:28:23.983

我在键盘快捷键中没有最爱——它们对我来说都是实用实体......

除了`![](https://farm6.staticflickr.com/5214/5472803412_953823394a_o.jpg)`+ `L`，这意味着另一个咖啡休息时间！

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-09T19:49:48.800

`Win`+`D`显示桌面，然后 Win+D 重新显示所有窗口。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-09T23:05:30.140

你们中所有提到的人`Alt`——`Tab`并且`Ctrl`——`Tab`也错过了班次版本

`CTRL`- `SHIFT`- `TAB`- 向后移动一个标签 `ALT`- `SHIFT`- `TAB`- 在任务切换器中向后移动一个窗口

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-17T05:01:28.900

`Win`+ `D`, `Win`+ `R`, `Win`+ `E`, `Win`+ `1`(火狐)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-09-17T07:16:39.277

最“重要”的快捷方式是Secure [Attention](http://en.wikipedia.org/wiki/Secure_attention_key) Sequence `Ctrl`++ 。`Alt``Del`

在 XP 上，您通常必须[启用它，](http://support.microsoft.com/kb/281980)否则它只会运行任务管理器。

登录后，SAS 会在其自己的[桌面](http://msdn.microsoft.com/en-us/library/ms681928(VS.85).aspx)上打开 Windows 安全对话框，这将使您摆脱几乎任何事情（例如挂起的全屏 DirectX 应用程序）。

任务管理器快捷方式现在（并且一直是）`Ctrl`+ `Shift`+ `Esc`。

（这个答案适用于 NT4、2000、XP 和 2003。我不能代表 Vista）

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-10-21T09:51:13.200

`Alt`+ `F4`
`Alt`+ `Tab`
`Ctrl`+ `Tab`
`Win`+ `Tab`
`Ctrl`+ `X`
`Ctrl`+ `V`
`Ctrl`+ `C`
`Alt`+ `R`
`Alt`+ `E`
`Alt`+ `D`
`Ctrl`+ `Space`(VS IDE)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-10-21T09:56:24.797

这不是键盘快捷键，但我最喜欢的技巧是绑定老鼠上的大拇指按钮来移动窗口，小拇指按钮来调整大小。这样，窗口可以非常轻松自然地移动和调整大小。你也可以在 Windows 中做到这一点。

至于*键盘*技巧，我使用右 ctrl+小键盘来选择（九个）虚拟屏幕。非常快速和自然。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-10-21T10:26:13.597

我映射了一些全局热键：

*   在 Winamp 中，我使用`Ctrl`+ `Alt`+ （对我来说与+`Backspace`相同）来暂停。如果有人在我戴上耳机时想引起我的注意，那么按几个按钮要比在大约 5 个像素宽的按钮上单击鼠标要容易得多。`AltGr``Backspace`

*   我使用`Ctrl`++`Alt`来`C`运行计算。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-10-28T14:41:02.370

在任何带有选项卡的对话框中，Ctrl-Page Up/Down 在选项卡之间循环。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-12-29T03:07:04.633

我习惯于在开始菜单中设置快捷键来编程快捷方式（标准 Windows 功能）。程序启动后，按下此类快捷方式会将焦点带到窗口，而不是启动另一个副本。

例如，要暂停 Winamp，我只需按`Ctrl`+ `Alt`+ `W`，`C`（我可以让它在没有托盘或任务栏图标的情况下工作）。

唯一的缺点是某些程序名称以相同的字母开头，因此我必须为它们选择其他字母。=)

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-05-01T20:24:58.560

[不是一个真正的答案，而是一个很好的来源的提示——如果没有人在维基百科](http://en.wikipedia.org/wiki/Windows_shortcuts)上面引用它的话（对于最重要的操作系统）——不是最好的

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-05-01T21:04:46.280

在任何 Windows 资源管理器窗口（包括常用对话窗口）中按该`Backspace`键可在文件夹层次结构中上一层。这是文件夹组合框旁边的按钮的快捷方式。Microsoft 在 Windows Vista 及更高版本中删除了此功能，以使 Windows Explorer 更像 Web 浏览器；现在该`Backspace`键用作“返回”按钮。（如果有人知道在 Vista 及更高版本中提升一级的方法，请发表评论！）

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-09-10T19:14:38.367

`F5`执行似乎是我使用最多的一个。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2015-02-15T18:49:02.573

**Windows**
Windows 右键单击​​键，右边的 alt 旁边可能非常有用。

对于新手，
`tab`和`shift`-`tab`循环输入
`alt`-`tab`和`alt`- `shift`-`tab`循环浏览窗口
`ctrl`-`tab`和`alt`- `shift`-`tab`循环浏览选项卡
`ctrl`-`printscreen`对整个屏幕
进行快照`alt`-对某些对话框窗口`printscreen`的当前窗口 进行快照-将复制消息
`ctrl``c`

**控制台** `alt`-`space`然后`e`，`p`粘贴到 Windows 控制台
`alt`-`space`然后`e`，`k`在控制台中标记并在控制台
`tab`中`shift``tab`循环自动完成

**Visual Studio** `ctrl` - `shift`-`f`在文件中搜索
`ctrl`-`f`搜索页面
`F12`转到当前单词的定义
`F2`重命名所选文本
`F4`打开属性选项卡以选择
突出显示部分和`tab`或`shift``tab`缩进一段文本
`ctrl`- `k`,`d`格式化文档
`ctrl`- `k`,`c`注释掉突出显示的文本
`ctrl`- `k`, `u`,取消`c`注释突出显示的文本
`ctrl`- `m`,`o`折叠到定义
`ctrl`- `m`，`m`切换打开和关闭当前方法/功能
`ctrl`- `alt`，`l`打开解决方案窗格
`ctrl`- `alt`，`o`打开输出窗格
，当然`ctrl`-`space`用于智能感知

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-04-14T12:19:36.740

我最喜欢的是以下（我无法在上面的回复中发现）：

*   `F12`在 Office 应用程序中另存为

*   `Ctrl`+`Home`在大多数应用程序中滚动到页面顶部或转到 Excel 中的单元格 A1

*   `Ctrl`+`Delete`返回 Word 文档中的光标或返回 Excel 中的活动单元格

*   `Ctrl`+ `Shift`+`End`从左上角选择 Excel 中的整个表格。如果桌子从 A1 开始，与上面结合使用，可以超快速的单手选桌

已经说过了，但我重复`F6`直接进入浏览器地址栏，因为它太棒了！

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2015-04-14T12:29:03.350

我还没有看到`Ctrl`+`Z`提到。这个救了我**很多**次。这是*撤消*命令，如果您刚刚删除了一段文本，或者不小心粘贴了刚刚编写的错误代码段，该命令非常有用。

其他类似的：
`Ctrl`+ `X`- 剪切
`Ctrl`+ `C`- 复制
`Ctrl`+ `V`- 粘贴

# ide - BlackBerry 开发使用 IntelliJ IDEA 7.0？

> ID：52698
> 
> 赞同：5
> 
> 时间：2008-09-09T19:29:06.790
> 
> 标签：ide, blackberry, intellij-idea

我知道 RIM 有自己的 IDE ( [BlackBerry JDE](http://na.blackberry.com/eng/developers/downloads/jde.jsp) ) 用于构建 BlackBerry 应用程序，但有人知道如何配置[IntelliJ IDEA](http://www.jetbrains.com/idea/index.html)来构建/调试 BlackBerry 应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:34:58.227

RIM 的编译器（构建 COD 文件的编译器）可以很容易地从命令行运行。您需要做的就是在 IDEA 中创建相应的构建步骤。

此外，为了让您在编辑代码时更轻松，您可能需要将 net_rim_api.jar（RIM JDE 附带的那个）添加到您的 IDEA 项目使用的 JAR 文件中。

至于调试器，RIM 的调试器应该支持标准的 Java 调试器接口。我不记得为此需要什么最低版本的 JDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T13:10:20.123

RE: Chris 关于有什么不同的问题... Blackberry 应用程序可以是标准的 MIDP 应用程序或使用 Blackberry 特定 API 的 CLDC 应用程序。大多数开发人员倾向于采用后一种方法，然后需要使用 Blackberry 的工具 - 特别是如果您使用他们的一些安全 API 并且必须签署您的部署文件以便它们在设备上运行。

对原始问题的一个潜在答案是使用[Blackberry ANT 工具](http://bb-ant-tools.sourceforge.net/)创建一个用于构建应用程序的 ANT 脚本，并从 IntelliJ IDEA 引用该脚本。当然，这只是成功的一半，要运行/调试应用程序，您需要将调试器连接到 IDEA，如上面 Alexander 所述。或者，您可以在 IDEA 中编码并在 JDE 中运行/调试，但至少可以这么说，这似乎不太理想。

我使用带有 Blackberry 插件的 Eclipse。也不理想，因为您被迫使用旧版本（且有缺陷）的 Eclipse，但至少我在一个 IDE 中并且可以逐步执行在模拟器中运行的代码。

Blackberry JDE 集成将是一个很棒的 IntelliJ 插件项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T10:52:49.863

不是真正的答案，而是更多地要求澄清黑莓开发与其他 J2ME 设备有什么不同......

我看到它是一个[MIDP J2ME](http://na.blackberry.com/eng/developers/downloads/jde.jsp)设备，因此标准的[Intellij J2ME](http://www.jetbrains.com/idea/webhelp2/creating-mobile-module.html)支持似乎提供了大部分所需的东西。

我想模拟器方面可能会有所不同......但也许你可以从IDEA调用jde模拟器......

问候，克里斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T02:40:23.450

我一直在使用 IntelliJ 开发 Blackberry 应用程序……有点。IntelliJ 非常擅长索引代码，您只需将其指向正确的方向。它的编辑能力远远超出了 JDE，在我看来，它比 Eclipse 更加灵活和用户友好（尽管 RIM 有一个 Eclipse 插件）。

我这么说是因为我只是在 IntelliJ 中编写代码，目前仍在通过 JDE 进行编译和调试。希望在这方面与 IntelliJ 更好地集成，但目前它是一个可以接受的工作环境。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:55:10.240

不确定这是否会有所帮助，但这里是[设置 Eclipse](http://www.blackberryforums.com/developer-forum/138210-setup-up-eclipse-blackberry-development.html)以进行黑莓开发的说明。

也许您可以使用该信息来确定需要在 IDEA 中进行哪些更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-23T18:28:48.600

鉴于上述建议（使用 bb ant 任务），将 IntelliJ 与 Blackberry 开发集成非常容易，但我还没有通过 IntelliJ 成功调试模拟器。它应该工作，但它没有。

因此，“整合”是不完整的。

# java - 为摩托罗拉手机构建应用程序

> ID：52701
> 
> 赞同：0
> 
> 时间：2008-09-09T19:32:34.847
> 
> 标签：java, mobile-phones

我有一部来自摩托罗拉的 L6 手机，一根 USB 线将它连接到我的电脑，还有手机工具软件，这样我就可以上传我自己的自定义铃声或从手机的相机下载图片。

我对我想在手机上运行的程序有一些想法，它支持 java，但我在上传它们的软件中看不到任何东西。即使他们这样做了，我也不知道从哪里开始。

有没有人知道如何开始为这款手机或类似手机构建应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T21:29:07.640

我从未使用过 Morotolla 的 SDK，但从我在 JME 的有限工作来看，第 3 方工具中真正的钩子是模拟器。快速设置 JME 开发环境是 Sun 出乎意料地正确的事情。只需获取带有 JME 包的 NetBeans，IDE 中就有一个常规仿真器，然后您可以挂接其他专有仿真器，例如来自 Motorolla 的仿真器。

不确定您要开发什么样的应用程序，但如果您对游戏感兴趣，我认为[开始手机游戏编程](https://rads.stackoverflow.com/amzn/click/com/0672326655)是一个很好的起点：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T19:36:21.717

也许摩托罗拉自己的网站

[关联](http://developer.motorola.com/?WT.mc_id=ca_hp_mdc)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T23:18:15.580

我没有使用新的摩托罗拉开发工作室，因为我对摩托罗拉开发工具的体验并不愉快。在使用摩托罗拉设备时，我倾向于坚持使用标准模拟器（或者有时是索尼爱立信模拟器，因为它们是我迄今为止使用过的最好的模拟器）。

摩托罗拉工具的问题在于，我似乎总是花费太多时间试图弄清楚如何解决它们。我会遇到模拟器特定的问题和错误，老实说，我没有时间浪费在试图弄清楚为什么应用程序在目标设备上运行但在模拟器上崩溃的原因。应该是相反的。

一个好的模拟器对于移动开发非常重要，因为您将在那里进行 90% 的开发、测试和调整，只是定期在手机上试用。

最后，我同意 bpapa...Netbeans 是用于 J2ME 开发的出色 IDE，这是我推荐的一本书（如果可能，请获取原版，而不是第二版，因为第二版过于关注 MIDP 2.0 并假设您了解基本情况）。

[http://www.amazon.com/J2ME-Game-Programming-Development/dp/1592001181/ref=pd_bbs_sr_3?ie=UTF8&s=books&qid=1221692983&sr=1-3](https://rads.stackoverflow.com/amzn/click/com/1592001181)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T20:29:13.993

是的，提出问题的行为为我指明了答案的方向，我发现了这一点：
[https](https://developer.motorola.com/docstools/motodevstudio/)
://developer.motorola.com/docstools/motodevstudio/ 我仍然可以使用来自某人的一些指针，如果有人的话以前做过。

# asp.net - 用于预览的 SharePoint 流文件

> ID：52702
> 
> 赞同：2
> 
> 时间：2008-09-09T19:32:41.010
> 
> 标签：asp.net, sharepoint, ssl, binary, streaming

我希望将 SharePoint 2003 文档库中的文件流式传输到浏览器。基本上，这个想法是将文件作为流打开，然后将文件流“写入”到响应中，指定内容类型和内容处置标头。内容配置用于保存文件名，内容类型当然是为了提示浏览器打开什么应用程序来查看文件。

这在开发环境和 UAT 环境中运行良好。但是，在生产环境中，事情并不总是按预期工作，但仅限于 IE6/IE7。FF 适用于所有环境。

请注意，在生产环境中启用并通常使用 SSL。（当生产环境中不使用 SSL 时，文件流，按预期命名，并正确显示。）

这是一个代码片段：

```
System.IO.FileStream fs = new System.IO.FileStream(Server.MapPath(".") + "\\" + "test.doc", System.IO.FileMode.Open);
long byteNum = fs.Length;
byte[] pdfBytes = new byte[byteNum];
fs.Read(pdfBytes, 0, (int)byteNum);

Response.AppendHeader("Content-disposition", "filename=Testme.doc");
Response.CacheControl = "no-cache";
Response.ContentType = "application/msword; charset=utf-8";
Response.Expires = -1;
Response.OutputStream.Write(pdfBytes, 0, pdfBytes.Length);
Response.Flush();
Response.Close();
fs.Close(); 
```

就像我说的，这个代码片段在开发机器和 UAT 环境中运行良好。将打开一个对话框并要求保存、查看或取消 Testme.doc。但仅在生产中使用 SSL 时，IE 6 和 IE7 不使用附件名称。相反，它使用发送流的页面名称 testheader.apx，然后引发错误。

IE 确实提供了高级设置“不要将加密的页面保存到磁盘”。

我怀疑这是问题的一部分，服务器告诉浏览器不要缓存文件，而 IE 启用了“不要将加密的页面保存到磁盘”。

是的，我知道对于较大的文件，上面的代码片段将是内存的主要拖累，并且这种实现将是有问题的。因此，真正的最终解决方案不会将整个文件打开为单个字节数组，而是将文件作为流打开，然后将文件以一口大小的块（例如大约 10K 大小）发送到客户端。

其他任何人都有类似的通过 ssl“流式传输”二进制文件的经验吗？有什么建议或建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T22:49:19.647

这可能非常简单，信不信由你我今天编写的代码完全相同，我认为问题可能是内容配置没有告诉浏览器它是一个附件，因此可以保存。

```
 Response.AddHeader("Content-Disposition", "attachment;filename=myfile.doc"); 
```

失败我已经在下面包含了我的代码，因为我知道它可以通过 https://

```
 private void ReadFile(string URL)
{
  try
  {
                string uristring = URL;
                WebRequest myReq = WebRequest.Create(uristring);
                NetworkCredential netCredential = new NetworkCredential(ConfigurationManager.AppSettings["Username"].ToString(), 
                                                                        ConfigurationManager.AppSettings["Password"].ToString(), 
                                                                        ConfigurationManager.AppSettings["Domain"].ToString());
                myReq.Credentials = netCredential;
                StringBuilder strSource = new StringBuilder("");

                //get the stream of data 
                string contentType = "";
                MemoryStream ms;
                // Send a request to download the pdf document and then get the response
                using (HttpWebResponse response = (HttpWebResponse)myReq.GetResponse())
                {
                    contentType = response.ContentType;
                    // Get the stream from the server
                    using (Stream stream = response.GetResponseStream())
                    {
                        // Use the ReadFully method from the link above:
                        byte[] data = ReadFully(stream, response.ContentLength);
                        // Return the memory stream.
                        ms = new MemoryStream(data);
                    }
                }

                Response.Clear();
                Response.ContentType = contentType;
                Response.AddHeader("Content-Disposition", "attachment;");

                // Write the memory stream containing the pdf file directly to the Response object that gets sent to the client
                ms.WriteTo(Response.OutputStream);
  }
  catch (Exception ex)
  {
    throw new Exception("Error in ReadFile", ex);
  }
} 

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T22:30:28.403

好的，我解决了这个问题，这里有几个因素在起作用。

首先，此支持 Microsoft 文章是有益的： [Internet Explorer 无法从 SSL 网站打开 Office 文档](http://support.microsoft.com/default.aspx?scid=kb;en-us;316431)。

> *为了让 Internet Explorer 在 Office（或任何进程外的 ActiveX 文档服务器）中打开文档，Internet Explorer 必须将文件保存到本地缓存目录并要求关联的应用程序使用 IPersistFile::Load 加载文件. 如果文件未存储到磁盘，则此操作失败。*
> 
> *当 Internet Explorer 通过 SSL 与安全网站通信时，Internet Explorer 会强制执行任何无缓存请求。如果存在一个或多个标头，Internet Explorer 不会缓存该文件。因此，Office 无法打开该文件。*

其次，页面处理的早期部分导致“no-cache”标头被写入。因此需要添加 Response.ClearHeaders，这清除了 no-cache 标头，并且页面的输出需要允许缓存。

第三，为了更好的措施，还添加到 Response.End，以便在请求生命周期中没有其他处理尝试清除我设置的标头并重新添加无缓存标头。

第四，发现IIS中已经启用了内容过期。我已经在网站级别启用了它，但是由于这个 aspx 页面将用作下载文件的网关，所以我在下载页面级别禁用了它。

所以这是有效的代码片段（我认为还有一些其他的小改动是无关紧要的）：

```
System.IO.FileStream fs = new System.IO.FileStream(Server.MapPath(".") + "\\" + "TestMe.doc", System.IO.FileMode.Open);
long byteNum = fs.Length;
byte[] fileBytes = new byte[byteNum];
fs.Read(fileBytes, 0, (int)byteNum);

Response.ClearContent();
Response.ClearHeaders();
Response.AppendHeader("Content-disposition", "attachment; filename=Testme.doc");
Response.Cache.SetCacheability(HttpCacheability.Public);
Response.ContentType = "application/octet-stream";
Response.OutputStream.Write(fileBytes, 0, fileBytes.Length);
Response.Flush();
Response.Close();
fs.Close();
Response.End(); 
```

也请记住，这只是为了说明。真正的生产代码将包括异常处理，并且可能一次读取文件一个块（可能是 10K）。

Mauro，感谢您也发现了代码中缺少的细节。

# php - php is_dir 为不存在的文件夹返回 true

> ID：52703
> 
> 赞同：2
> 
> 时间：2008-09-09T19:32:54.130
> 
> 标签：php

有没有人遇到过这种怪事？

我正在我的一个单元测试中检查是否存在多个目录。`is_dir`尽管该文件夹在调用时不存在，但仍报告为真 (1)。代码如下所示（带有一些无关的中间变量以方便调试）：

```
foreach($userfolders as $uf) {
    $uf = sprintf($uf, $user_id);
    $uf = ltrim($uf,'/');
    $path = trim($base . '/' . $uf);

    $res = is_dir($path); //returns false except last time returns 1
    $this->assertFalse($res, $path);
} 
```

运行 Ubuntu Linux 8.04 和 PHP 版本 5.2.4-2ubuntu5.3 的机器

我检查过的事情：

```
 - Paths are full paths
 - The same thing happens on two separate machines (both running Ubuntu)
 - I have stepped through line by line in a debugger
 - Paths genuinely don't exist at the point where is_dir is called
 - While the code is paused on this line, I can actually drop to a shell and run 
```

交互式 PHP 解释器并获得正确的结果 - 路径都在 256 个字符以下 - 我无法想象权限问题，因为该文件夹不存在！父文件夹不会导致权限问题，因为循环中的其他文件夹被正确报告为丢失。

对 PHP 文档的评论指出了一个奇怪的问题，`is_dir`但不是这个特定的问题。

我不是将其发布为“请帮我解决”，而是希望遇到同样事情的人可以在这里搜索，并*希望*看到其他人的回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T19:38:10.810

我认为这不会导致您的问题，但是 $path 确实有斜杠，对吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T19:37:17.363

对于它的价值，`is_readable`可以用作解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T19:39:41.507

```
$path = trim($base . '/' . $uf); 
```

这可能是造成它的原因。我假设 $base 是您正在搜索的某种根文件夹，所以如果 $uf 是类似 ''、'.' 或 '../' 的东西，它可能会返回 true。我们必须查看您在 foreach 中使用的值才能进一步了解。

[编辑]

多看一下上面的代码，在带有 PHP 5.2 的 OpenBSD 4.3 上运行良好。

# git - 如何丢弃 Git 中未暂存的更改？

> ID：52704
> 
> 赞同：5616
> 
> 时间：2008-09-09T19:33:59.133
> 
> 标签：git, version-control

如何丢弃工作副本中不在索引中的更改？

* * *

## 回答 #1

> 赞同：6376
> 
> 时间：2008-09-09T19:37:40.467

对于当前工作目录中的所有未暂存文件，请使用：

```
git checkout -- . 
```

对于特定文件使用：

```
git checkout -- path/to/file/to/revert 
```

`--`这里是为了消除歧义（这被称为 [参数消歧](https://git-scm.com/docs/git-checkout#_argument_disambiguation)）。

对于 Git 2.23 及以后版本，可能需要使用更具体的

```
git restore . 
```

分别

```
git restore path/to/file/to/revert 
```

与`git switch`替换重载的`git checkout`（[参见此处](https://stackoverflow.com/questions/58003030/what-is-the-git-restore-command-and-what-is-the-difference-between-git-restor)）一起，从而消除了参数消歧。

* * *

## 回答 #2

> 赞同：3045
> 
> 时间：2008-09-09T19:39:24.970

另一种更快的方法是：

```
git stash save --keep-index --include-untracked 
```

`--include-untracked`如果您不想彻底了解它，则不需要包括在内。

之后，您可以根据需要使用`git stash drop`命令删除该存储。

* * *

## 回答 #3

> 赞同：2129
> 
> 时间：2012-08-29T18:28:04.550

似乎完整的解决方案是：

```
git clean -df
git checkout -- . 
```

[`git clean`](https://git-scm.com/docs/git-clean)删除所有未跟踪的文件（**警告**：虽然它不会删除 .gitignore 中直接提到的被忽略的文件，**但它可能会删除位于文件夹中的被忽略的文件**）并`git checkout`清除所有未暂存的更改。

* * *

## 回答 #4

> 赞同：374
> 
> 时间：2009-06-20T10:28:04.730

这将检查当前目录的当前索引，从当前目录向下丢弃文件中的所有更改。

```
git checkout . 
```

或者这个从索引中检查所有文件，覆盖工作树文件。

```
git checkout-index -a -f 
```

* * *

## 回答 #5

> 赞同：276
> 
> 时间：2011-12-07T13:09:52.033

```
git clean -df 
```

从当前目录开始，通过递归删除不受版本控制的文件来清理工作树。

`-d`: 除未跟踪的文件外，删除未跟踪的目录

`-f`：强制（根据设置可能不需要 `clean.requireForce`）

运行`git help clean`看说明书

* * *

## 回答 #6

> 赞同：177
> 
> 时间：2019-09-11T01:30:29.573

### 2019 年更新

您现在可以通过以下方式丢弃**一个跟踪文件**中的未暂存更改：

```
git restore <file> 
```

并在当前目录（递归）中的**所有跟踪文件中：**

```
git restore . 
```

如果您从存储库的根目录运行后者，它将丢弃项目中所有跟踪文件中的未暂存更改。

### 笔记

*   `git restore`[于2019 年 7 月](https://github.com/git/git/commit/f496b064fc1135e0dded7f93d85d72eb0b302c22)推出，并在 2.23 版中发布，作为`git checkout`命令拆分`git restore`为文件和`git switch`分支的一部分。
*   `git checkout`仍然像以前一样运行，旧的答案仍然完全有效。
*   当`git status`在工作树中运行未暂存的更改时，这是 Git 现在建议用来丢弃它们的方法（而不是`git checkout -- <file>`以前 v2.23 之前的做法）。
*   与 一样`git checkout -- .`，这只会丢弃跟踪文件中的更改。所以[Mariusz Nowak 的回答](https://stackoverflow.com/a/12184274/9210961)仍然适用，如果你想放弃所有未暂存的更改，包括未跟踪的文件，你可以按照他的建议运行一个额外的`git clean -df`.

* * *

## 回答 #7

> 赞同：121
> 
> 时间：2014-10-10T12:31:28.063

我最喜欢的是

```
git checkout -p 
```

这使您可以有选择地还原块。

也可以看看：

```
git add -p 
```

* * *

## 回答 #8

> 赞同：119
> 
> 时间：2016-04-28T19:46:06.557

由于没有答案表明我使用的确切选项组合，这里是：

```
git clean -dxn .  # dry-run to inspect the list of files-to-be-removed
git clean -dxf .  # REMOVE ignored/untracked files (in the current directory)
git checkout -- . # ERASE changes in tracked files (in the current directory) 
```

这是所用`git clean`选项的在线帮助文​​本：

`-d`

除了未跟踪的文件之外，还删除未跟踪的目录。如果未跟踪的目录由不同的 Git 存储库管理，则默认情况下不会将其删除。`-f`如果您真的想删除这样的目录，请使用选项两次。

`-x`

不要使用从`.gitignore`(per directory) 和读取的标准忽略规则`$GIT_DIR/info/exclude`，但仍然使用`-e`选项给出的忽略规则。这允许删除所有未跟踪的文件，包括构建产品。这可以用于（可能与 结合使用`git reset`）来创建原始工作目录以测试干净的构建。

`-n`

实际上不要删除任何东西，只是显示将要做什么。

`-f`

如果 Git 配置变量`clean.requireForce`未设置为`false`，Git clean 将拒绝删除文件或目录，除非给定`-f`,`-n`或`-i`. Git 将拒绝删除`.git`子目录或文件中的目录，除非`-f`给出一秒钟。

* * *

## 回答 #9

> 赞同：78
> 
> 时间：2018-03-18T00:19:02.883

如果您只想**删除对现有文件的更改**，请使用`checkout`（[在此处记录](https://git-scm.com/docs/git-checkout)）。

```
git checkout -- . 
```

*   没有指定分支，所以它检查出当前分支。
*   双连字符 ( `--`) 告诉 Git 应该将后面的内容作为它的第二个参数（路径），即您跳过了分支的规范。
*   句点 ( `.`) 表示所有路径。

如果您想**删除**自上次提交后添加的文件，请使用`clean`（[在此处记录](https://git-scm.com/docs/git-clean)）：

```
git clean -i 
```

*   该`-i`选项启动交互式`clean`，以防止错误删除。
*   还有一些其他选项可用于更快地执行；请参阅文档。

如果您希望**将更改移动到保留空间以供以后访问**，请使用`stash`（[在此处记录](https://git-scm.com/docs/git-stash)）：

```
git stash 
```

*   所有更改都将移至 Git 的 Stash，以供以后访问。
*   有一些选项可用于更细微的存储；请参阅文档。

* * *

## 回答 #10

> 赞同：64
> 
> 时间：2017-04-12T09:27:15.937

最简单的方法是使用以下命令：

此命令用于丢弃工作目录中的更改 -

```
git checkout -- . 
```

[https://git-scm.com/docs/git-checkout](https://git-scm.com/docs/git-checkout)

在 git 命令中，未跟踪文件的存储是通过以下方式实现的：

```
git stash -u 
```

[http://git-scm.com/docs/git-stash](http://git-scm.com/docs/git-stash)

* * *

## 回答 #11

> 赞同：63
> 
> 时间：2012-08-13T21:31:04.630

我真的发现这篇文章有助于解释何时使用什么命令：[http ://www.szakmeister.net/blog/2011/oct/12/reverting-changes-git/](http://www.szakmeister.net/blog/2011/oct/12/reverting-changes-git/)

有几种不同的情况：

1.  如果您尚未暂存文件，则使用`git checkout`. 签出“更新工作树中的文件以匹配索引中的版本”。如果文件还没有被暂存（也就是添加到索引中）......这个命令基本上会将文件恢复到你上次提交的状态。

    `git checkout -- foo.txt`

2.  如果您已暂存文件，请使用 git reset。重置更改索引以匹配提交。

    `git reset -- foo.txt`

我怀疑使用`git stash`是一种流行的选择，因为它的危险性要小一些。如果您在使用 git reset 时不小心吹走太多东西，您可以随时返回它。默认情况下，重置是递归的。

请查看上面的文章以获取更多建议。

* * *

## 回答 #12

> 赞同：50
> 
> 时间：2011-07-28T05:27:18.057

如果您对保留未暂存的更改不感兴趣（特别是如果暂存的更改是新文件），我发现这很方便：

```
git diff | git apply --reverse 
```

* * *

## 回答 #13

> 赞同：45
> 
> 时间：2016-05-17T11:27:17.517

当您键入 git status 时， **（使用“git checkout -- ...”放弃工作目录中的更改）** 会显示。

例如`git checkout -- .`

* * *

## 回答 #14

> 赞同：43
> 
> 时间：2014-05-17T02:28:01.853

`git checkout -f`

* * *

`man git-checkout`：

`-f, --force`

切换分支时，即使索引或工作树与 HEAD 不同，也要继续。这用于丢弃本地更改。

从索引中检出路径时，不要在未合并的条目上失败；相反，未合并的条目将被忽略。

* * *

## 回答 #15

> 赞同：43
> 
> 时间：2015-09-11T11:59:41.843

您可以使用 git stash - 如果出现问题，您仍然可以从 stash 中恢复。与此处的其他答案类似，但此答案也删除了所有未暂存的文件以及所有未暂存的删除：

```
git add .
git stash 
```

如果您检查一切正常，请将藏匿处扔掉：

```
git stash drop 
```

Bilal Maqsood 的回答`git clean`也对我有用，但是有了藏匿处我有更多的控制权——如果我不小心做了某事，我仍然可以取回我的更改

**更新**

我认为还有1个变化（不知道为什么这对我有用）：

`git add . -A`代替`git add .`

没有`-A`删除的文件将不会上演

* * *

## 回答 #16

> 赞同：38
> 
> 时间：2015-08-07T21:15:47.867

我没有放弃更改，而是将遥控器重置为原点。注意 - 此方法是将您的文件夹完全恢复到存储库的文件夹。

所以我这样做是为了确保当我 git reset 时它们不会坐在那里（稍后 - 不包括 Origin/branchname 上的 gitignores）

注意：如果您想保留尚未跟踪的文件，但不在 GITIGNORE 中，您可能希望跳过此步骤，因为它将擦除在您的远程存储库中找不到的这些未跟踪文件（感谢@XtrmJosh）。

```
git add --all 
```

然后我

```
git fetch --all 
```

然后我重置为原点

```
git reset --hard origin/branchname 
```

这将使它回到原点。就像重新克隆分支一样，同时将我所有的 gitignored 文件保存在本地和适当的位置。

更新了下面的每个用户评论：将 重置为用户所在的任何当前分支的变体。

```
git reset --hard @{u} 
```

* * *

## 回答 #17

> 赞同：33
> 
> 时间：2011-10-14T21:07:27.213

尝试了上述所有解决方案，但仍然无法摆脱新的未暂存文件。

用于`git clean -f`删除那些新文件——*不过要小心！*注意强制选项。

* * *

## 回答 #18

> 赞同：30
> 
> 时间：2019-07-03T12:41:31.373

要永久丢弃： `git reset --hard`

要保存更改以备后用： `git stash`

* * *

## 回答 #19

> 赞同：23
> 
> 时间：2016-09-08T06:19:32.203

只需使用：

```
git stash -u 
```

完毕。简单的。

如果您*真的*关心您的存储堆栈，那么您可以使用`git stash drop`. 但那时你最好使用（来自 Mariusz Nowak）：

```
git checkout -- .
git clean -df 
```

尽管如此，我还是最喜欢它，因为它在*一个命令*`git stash -u`中“丢弃”了所有已跟踪和未跟踪的更改。然而，只丢弃跟踪的更改，只丢弃未跟踪的更改......并且输入这两个命令是*太多*的工作:)*`git checkout -- .``git clean -df`*

 *** * *

## 回答 #20

> 赞同：22
> 
> 时间：2015-04-24T12:19:34.237

简单地说

```
git stash 
```

它将删除您的所有本地更改。你也可以通过说稍后使用

```
git stash apply 
```

或 git stash pop

* * *

## 回答 #21

> 赞同：19
> 
> 时间：2019-08-27T07:58:23.397

你有一个非常简单的 git 命令`git checkout .`

* * *

## 回答 #22

> 赞同：16
> 
> 时间：2013-09-05T09:38:10.853

这甚至适用于以下目录；在正常的 git 权限之外。

```
sudo chmod -R 664 ./* && git checkout -- . && git clean -dfx 
```

最近发生在我身上

* * *

## 回答 #23

> 赞同：15
> 
> 时间：2014-05-30T09:26:00.053

```
cd path_to_project_folder  # take you to your project folder/working directory 
git checkout .             # removes all unstaged changes in working directory 
```

* * *

## 回答 #24

> 赞同：15
> 
> 时间：2016-02-05T00:59:53.027

无论您的仓库处于何种状态，您都可以随时重置为任何先前的提交：

```
git reset --hard <commit hash> 
```

* * *

这将丢弃该提交后所做的所有更改。

* * *

## 回答 #25

> 赞同：12
> 
> 时间：2016-07-14T07:03:45.053

在我看来，

```
git clean -df 
```

应该做的伎俩。根据[git clean 上的 Git 文档](https://git-scm.com/docs/git-clean/2.2.0)

> git-clean - 从工作树中删除未跟踪的文件

**描述**

> 从当前目录开始，通过递归删除不受版本控制的文件来清理工作树。
> 
> 通常，只删除 Git 未知的文件，但如果指定了 -x 选项，也会删除忽略的文件。例如，这对于删除所有构建产品很有用。
> 
> 如果给出任何可选的 ... 参数，则只有那些路径受到影响。

**选项**

> -d 除了未跟踪的文件之外，还删除未跟踪的目录。如果未跟踪的目录由不同的 Git 存储库管理，则默认情况下不会将其删除。如果您真的想删除这样的目录，请使用两次 -f 选项。
> 
> -f --force 如果 Git 配置变量 clean.requireForce 没有设置为 false，除非给定 -f、-n 或 -i，否则 git clean 将拒绝运行。

* * *

## 回答 #26

> 赞同：10
> 
> 时间：2012-06-15T08:55:35.303

摆脱比 git clean -df 更具体的新文件的另一种方法（它可以让您摆脱一些文件不一定全部），是首先将新文件添加到索引中，然后存储，然后删除藏。

当由于某种原因无法通过某种普通机制（如 rm）轻松删除所有未跟踪的文件时，此技术很有用。

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2014-01-05T04:53:14.947

如果您正在使用您定期与另一个存储库同步（例如拉取请求）的存储库的分支，那么接下来的内容实际上只是一个解决方案。简短回答：删除 fork 和 refork，但**请阅读 github 上的警告**。

我有一个类似的问题，也许不完全相同，我很遗憾地说我的解决方案并不理想，但它最终是有效的。

我经常会有这样的 git 状态消息（涉及至少 2/4 个文件）：

```
$ git status
# Not currently on any branch.
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#       modified:   doc/PROJECT/MEDIUM/ATS-constraint/constraint_s2var.dats
#       modified:   doc/PROJECT/MEDIUM/ATS-constraint/parsing/parsing_s2var.dats
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   doc/PROJECT/MEDIUM/ATS-constraint/constraint_s2Var.dats
#       modified:   doc/PROJECT/MEDIUM/ATS-constraint/parsing/parsing_s2Var.dats 
```

敏锐的眼光会注意到这些文件有一个单独的字母以防万一。不知何故，我不知道是什么导致我走上这条道路（因为我自己没有从上游仓库处理这些文件），我已经切换了这些文件。尝试此页面（和其他页面）上列出的许多解决方案似乎没有帮助。

**我能够通过删除我的分叉存储库和所有本地存储库并重新分叉来解决问题。仅此还不够；上游必须将相关文件重命名为新文件名。**只要您没有任何未提交的工作、没有 wiki 以及与上游存储库不同的问题，您应该没问题。至少可以说，上游可能对您不太满意。至于我的问题，这无疑是一个用户错误，因为我对 git 不是很精通，但它远非容易修复的事实也表明 git 存在问题。

* * *

## 回答 #28

> 赞同：9
> 
> 时间：2017-02-08T11:58:12.553

我有一个奇怪的情况，文件总是未暂存，这有助于我解决。

> git rm .gitattributes
> git add -A
> git reset --hard

* * *

## 回答 #29

> 赞同：8
> 
> 时间：2013-07-08T15:07:46.213

当您想将存储转移给其他人时：

```
# add files
git add .  
# diff all the changes to a file
git diff --staged > ~/mijn-fix.diff
# remove local changes 
git reset && git checkout .
# (later you can re-apply the diff:)
git apply ~/mijn-fix.diff 
```

[编辑] 如评论所述，可以命名 stash。好吧，如果您想分享您的藏匿处，请使用它；）

* * *

## 回答 #30

> 赞同：8
> 
> 时间：2017-06-05T04:44:48.030

您可以创建自己的别名，以描述性方式描述如何执行此操作。

我使用下一个别名来丢弃更改。

* * *

### 丢弃工作树中文件（列表）中的更改

```
discard = checkout -- 
```

然后您可以将其用作 next 来丢弃所有更改：

```
discard . 
```

或者只是一个文件：

```
discard filename 
```

* * *

否则，如果您想丢弃所有更改以及未跟踪的文件，我会混合使用 checkout 和 clean：

### 清理并丢弃工作树中的更改和未跟踪的文件

```
cleanout = !git clean -df && git checkout -- . 
```

所以使用很简单，如下所示：

```
cleanout 
```

* * *

现在可以在下一个 Github 存储库中使用，其中包含很多别名：

*   [https://github.com/GitAlias/gitalias](https://github.com/GitAlias/gitalias)

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2015-10-01T21:32:42.513

如果您遇到子模块并且没有其他解决方案有效，请尝试：

*   要检查问题所在（可能是“脏”案例），请使用：

    `git diff`

*   删除存储

    `git submodule update`

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2017-07-31T15:57:59.227

如果几乎不可能排除对文件的修改，您是否考虑过忽略它们？如果这个说法是正确的，并且您在开发过程中不会接触这些文件，那么这个命令可能很有用：

`git update-index --assume-unchanged file_to_ignore`

* * *

## 回答 #33

> 赞同：6
> 
> 时间：2015-03-20T15:38:49.457

如果实际提交了所有暂存文件，则可以简单地重置分支，例如从您的 GUI 中单击大约三下鼠标：**Branch**、**Reset**、**Yes**！

所以我在实践中经常做的恢复不需要的本地更改是提交所有好的东西，然后重置分支。

如果好东西是在一次提交中提交的，那么如果您最终希望以不同的方式提交它，则可以使用“修改最后一次提交”将其恢复为暂存或非暂存状态。

这可能不是您正在寻找的解决问题的技术解决方案，但我发现它是一个非常实用的解决方案。它允许您有选择地丢弃未暂存的更改，重置您不喜欢的更改并保留您所做的更改。

所以总而言之，我只是简单地**提交**、**分支重置**和**修改最后一次提交**。

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2015-11-23T04:30:57.040

如果您只是更改了文件的*权限*（这是在 DOS/Windoze 上） ，则任何解决方案都不起作用

```
星期一 23/11/2015-15:16:34.80 C:\...\work\checkout\slf4j+> git status
在分支 SLF4J_1.5.3
未为提交暂存的更改：
  （使用“git add ...”来更新将要提交的内容）
  （使用“git checkout -- ...”丢弃工作目录中的更改）

        修改：.gitignore
        修改：LICENSE.txt
        修改：TODO.txt
        修改：codeStyle.xml
        修改：pom.xml
        修改：version.pl

没有添加到提交的更改（使用“git add”和/或“git commit -a”）

星期一 23/11/2015-15:16:37.87 C:\...\work\checkout\slf4j+> git diff
差异 --git a/.gitignore b/.gitignore
旧模式 100644
新模式 100755
差异 --git a/LICENSE.txt b/LICENSE.txt
旧模式 100644
新模式 100755
差异 --git a/TODO.txt b/TODO.txt
旧模式 100644
新模式 100755
差异 --git a/codeStyle.xml b/codeStyle.xml
旧模式 100644
新模式 100755
差异 --git a/pom.xml b/pom.xml
旧模式 100644
新模式 100755
差异 --git a/version.pl b/version.pl
旧模式 100644
新模式 100755

星期一 23/11/2015-15:16:45.22 C:\...\work\checkout\slf4j+> git reset --hard HEAD
HEAD 现在位于 8fa8488 12133-CHIXMISSINGMESSAGES MALCOLMBOEKHOFF 20141223124940 已添加 .gitignore

星期一 23/11/2015-15:16:47.42 C:\...\work\checkout\slf4j+> git clean -f

周一 23/11/2015-15:16:53.49 C:\...\work\checkout\slf4j+> git stash save -u
在 SLF4J_1.5.3 上保存的工作目录和索引状态 WIP：8fa8488 12133-CHIXMISSINGMESSAGES MALCOLMBOEKHOFF 20141223124940 添加了 .gitignore
HEAD 现在位于 8fa8488 12133-CHIXMISSINGMESSAGES MALCOLMBOEKHOFF 20141223124940 已添加 .gitignore

星期一 23/11/2015-15:17:00.40 C:\...\work\checkout\slf4j+> git stash drop
删除 refs/stash@{0} (cb4966e9b1e9c9d8daa79ab94edc0c1442a294dd)

星期一 23/11/2015-15:17:06.75 C:\...\work\checkout\slf4j+> git stash drop
删除 refs/stash@{0} (e6c49c470f433ce344e305c5b778e810625d0529)

星期一 23/11/2015-15:17:08.90 C:\...\work\checkout\slf4j+> git stash drop
没有找到藏匿处。

星期一 23/11/2015-15:17:15.21 C:\...\work\checkout\slf4j+> git checkout -- 。

星期一 23/11/2015-15:22:00.68 C:\...\work\checkout\slf4j+> git checkout -f -- 。

星期一 23/11/2015-15:22:04.53 C:\...\work\checkout\slf4j+> git status
在分支 SLF4J_1.5.3
未为提交暂存的更改：
  （使用“git add ...”来更新将要提交的内容）
  （使用“git checkout -- ...”丢弃工作目录中的更改）

        修改：.gitignore
        修改：LICENSE.txt
        修改：TODO.txt
        修改：codeStyle.xml
        修改：pom.xml
        修改：version.pl

没有添加到提交的更改（使用“git add”和/或“git commit -a”）

星期一 23/11/2015-15:22:13.06 C:\...\work\checkout\slf4j+> git diff
差异 --git a/.gitignore b/.gitignore
旧模式 100644
新模式 100755
差异 --git a/LICENSE.txt b/LICENSE.txt
旧模式 100644
新模式 100755
差异 --git a/TODO.txt b/TODO.txt
旧模式 100644
新模式 100755
差异 --git a/codeStyle.xml b/codeStyle.xml
旧模式 100644
新模式 100755
差异 --git a/pom.xml b/pom.xml
旧模式 100644
新模式 100755
差异 --git a/version.pl b/version.pl
旧模式 100644
新模式 100755

```

解决此问题的唯一方法是手动重置更改文件的权限：

```
星期一 23/11/2015-15:25:43.79 C:\...\work\checkout\slf4j+> git status -s | egrep "^ M" | 切-c4- | for /f "usebackq tokens=* delims=" %A in (`more`) do chmod 644 %~A

星期一 23/11/2015-15:25:55.37 C:\...\work\checkout\slf4j+> git status
在分支 SLF4J_1.5.3
没有什么可提交的，工作目录干净

星期一 23/11/2015-15:25:59.28 C:\...\work\checkout\slf4j+>

星期一 23/11/2015-15:26:31.12 C:\...\work\checkout\slf4j+> git diff

```

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2020-09-18T06:03:21.137

提醒一下，较新版本的 git 具有 restore 命令，这也是在更改文件时键入 git status 时的建议：

（使用“git add ...”来更新将要提交的内容）

（使用“git restore ...”丢弃工作目录中的更改）

所以 git 'restore' 是解决这个问题的现代解决方案。在输入“git status”后阅读 git 的建议总是一个好主意:-)

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2021-07-08T15:36:13.813

如果要恢复未暂存的文件，请使用 git restore --staged 。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2016-12-23T17:33:37.223

只需使用：

```
git stash -k -u 
```

这将存储未**暂存的更改**和**未跟踪的文件（新文件）**并保留暂存文件。

它比`reset`/ `checkout`/好`clean`，因为您可能希望它们稍后回来（按`git stash pop`）。把它们藏起来总比丢弃它们好。

# sql-server - 什么导致这个 SqlException：从服务器接收结果时发生传输级错误

> ID：52711
> 
> 赞同：6
> 
> 时间：2008-09-09T19:36:57.770
> 
> 标签：sql-server, unit-testing, resharper, vmware-tools

这是完整的错误：`SqlException: A transport-level error has occurred when receiving results from the server. (provider: Shared Memory Provider, error: 1 - I/O Error detected in read/write operation)`

对于我的应用程序中的一些单元测试，我已经开始间歇性地看到此消息（有超过 1100 个单元和系统测试）。我正在使用 ReSharper 4.1 中的测试运行器。

另一件事：我的开发机器是 VMWare 虚拟机。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T19:44:50.420

我在很多个月前遇到了这个问题。底线是你的可用端口用完了。

首先确保您的调用应用程序启用了连接池。

如果确实如此，则检查 SQL Server 的可用端口数。

发生的情况是，如果池关闭，那么每个调用都会占用一个端口，默认情况下需要 4 分钟才能使端口过期，并且您的端口即将用完。

如果池已打开，那么您需要分析 SQL Server 的所有端口，并确保您有足够的端口并在必要时扩展它们。

当我遇到此错误时，连接池已关闭，并且只要在网站上施加了不错的负载，就会导致此问题。我们在开发中没有看到它，因为最大负载是 2 或 3 人，但是一旦数量增加到 10 人以上，我们就会一直看到这个错误。我们打开了池化，它修复了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T19:49:58.767

我在很多个月前也遇到过这个问题。但是，不要打折@Longhorn213s 的解释，但我们有完全相反的行为。我们在开发和测试中收到错误，但在负载明显更大的生产中没有收到。我们最终容忍了开发中的问题，因为它是零星的，并没有实质性地减慢进度。我认为这个错误可能有几个原因，但我自己一直无法确定原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T21:31:03.080

我们也遇到了这个错误，并发现我们正在从数据库服务器终止 SQL 服务器连接。客户端应用程序认为连接仍然处于活动状态并尝试使用该连接，但由于它被终止而失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T20:06:01.490

我们在我们的环境中看到了这一点，并将其中的一部分追溯到我们查询中的“NOLOCK”提示。我们删除了 NOLOCK 提示并将我们的服务器设置为使用快照隔离模式，这些错误的频率大大降低了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T22:37:38.950

我们已经多次看到此错误，并尝试了不同的解决方案并取得了不同的成功。一个常见的潜在主题是给出错误的系统内存不足。如果托管 Sql Server 的服务器正在运行任何其他非操作系统进程，则尤其如此。默认情况下，SQL Server 将获取它可以获取的任何内存，然后为其他进程/驱动程序留下很少的内存。这可能会导致行为不稳定和消息断断续续。如果有其他进程可能需要它，最好将 SQL Server 配置为留出一些空间的最大内存。示例：在同一台计算机上运行 SQL Server 开发人员版副本的开发计算机上的 Visual Studio。

# c++ - STL 矢量与地图擦除

> ID：52714
> 
> 赞同：14
> 
> 时间：2008-09-09T19:37:44.477
> 
> 标签：c++, stl

在 STL 中，几乎所有容器都有擦除功能。我的问题是在向量中，擦除函数返回一个指向向量中下一个元素的迭代器。地图容器不这样做。相反，它返回一个 void。有谁知道为什么会出现这种不一致？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-09T19:46:32.537

见[http://www.sgi.com/tech/stl/Map.html](http://www.sgi.com/tech/stl/Map.html)

> Map 有一个重要的属性，即在 map 中插入一个新元素不会使指向现有元素的迭代器失效。从映射中擦除元素也不会使任何迭代器无效，当然，除了实际指向正在被擦除的元素的迭代器。

在擦除时返回迭代器的原因是您可以随时迭代列表擦除元素。如果擦除项目不会使现有迭代器无效，则无需执行此操作。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T18:35:38.637

`erase``iterator`在 C++11 中返回一个。这是由于[缺陷报告 130](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2728.html#130)造成的：

> 表 67 (23.1.1) 说 container::erase(iterator) 返回一个迭代器。表 69 (23.1.2) 说除了这个要求之外，关联容器还说 container::erase(iterator) 返回 void。那不是补充。这是对需求的更改，其效果是使关联容器无法满足容器的需求。

标准委员会接受了这一点：

> LWG 同意返回类型应该是迭代器，而不是 void。（亚历克斯·斯捷潘诺夫也同意。）

（LWG = 图书馆工作组）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-09T19:48:23.280

不一致是由于使用。`vector`是一个对元素进行排序的序列。虽然确实 a 中的元素`map`也根据一些比较标准进行了排序，但这种排序从结构中并不明显。没有从一个元素到下一个元素的有效方法（高效 = 恒定时间）。事实上，遍历地图是相当昂贵的。迭代器的创建或迭代器本身都涉及遍历整个树。这不能在*O* ( *n* ) 中完成，除非使用堆栈，在这种情况下所需的空间不再是恒定的。

总而言之，根本没有便宜的方法可以在擦除后返回“下一个”元素。对于序列，有*一种*方法。

此外，Rob 是对的。Map 不需要返回迭代器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-09T19:58:16.737

顺便说一句，MS Visual Studio C++ (Dinkumware IIRC) 附带的 STL 提供了一个映射实现，该实现带有一个`erase`将迭代器返回到下一个元素的函数。

他们确实注意到这不符合标准。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T19:45:13.193

我不知道这是否是答案，但一个原因可能是定位下一个元素的成本。遍历地图本质上是“慢”的。

# php - 使用 SQL 查询时，对我的网站进行分页的最有效方法是什么？

> ID：52723
> 
> 赞同：0
> 
> 时间：2008-09-09T19:40:41.897
> 
> 标签：php, sql, sqlite, pdo

我正在尝试对 SQL 查询的结果进行分页以在网页上使用。语言和数据库后端是 PHP 和 SQLite。

我正在使用的代码是这样的（页码从 0 开始）

[http://example.com/table?page=0](http://example.com/table?page=0)

```
page = request(page)
per = 10 // results per page
offset = page * per

// take one extra record so we know if a next link is needed
resultset = query(select columns from table where conditions limit offset, per + 1)

if(page > 0) show a previous link
if(count(resultset) > per) show a next link

unset(resultset[per])

display results 
```

还有比这更有效的分页方法吗？

使用当前方法可以看到的一个问题是，在开始显示它们之前，我必须将所有 10 个（或许多）结果存储在内存中。我这样做是因为 PDO 不保证行数可用。

发出`COUNT(*)`查询以了解存在多少行，然后将结果流式传输到浏览器是否更有效？

这是“它取决于你的表的大小，以及`count(*)`查询是否需要在数据库后端进行全表扫描”，“做一些分析自己”之类的问题之一吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T04:30:53.947

我选择使用 COUNT(*) 两个查询方法，因为它允许我直接创建指向最后一页的链接，而另一种方法不允许这样做。首先执行计数还可以让我流式传输结果，因此应该可以很好地处理更多数量的记录和更少的内存。

页面之间的一致性对我来说不是问题。感谢您的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T13:37:23.763

在某些情况下，我有一个相当复杂的（9-12 表连接）查询，返回数千行，我需要对其进行分页。显然，要很好地分页，您需要知道结果的总大小。对于 MySQL 数据库，在 SELECT 中使用 SQL_CALC_FOUND_ROWS 指令可以帮助您轻松实现这一目标，尽管对于您这样做是否更有效尚无定论。

但是，由于您使用的是 SQLite，我建议坚持使用 2 查询方法。[这](http://marc.info/?l=sqlite-users&m=113579007126860&w=2)是关于这个问题的一个非常简洁的线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T19:50:59.437

我建议先进行计数。计数（主键）是一个非常有效的查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T19:52:10.683

我怀疑您的用户等待后端返回十行是否会成为问题。（您可以通过擅长指定图像尺寸来弥补它们，让网络服务器在可能的情况下协商压缩数据传输等）

我不认为最初做一个 count(*) 对你很有用。

如果您正在处理一些复杂的编码：当用户正在查看页面 x 时，使用类似 ajax 的魔法来预加载页面 x+1 以改善用户体验。

关于分页的一般说明：如果数据在用户浏览您的页面时发生变化，那么如果您的解决方案需要非常高的一致性，则*可能会出现问题。*我已经在[别处](http://troels.arvin.dk/db/rdbms/#select-limit-offset-note)写过关于这件事的说明。

# svn - 用 SVK 镜像 perforce？

> ID：52724
> 
> 赞同：3
> 
> 时间：2008-09-09T19:41:33.860
> 
> 标签：svn, perforce, svk

有人知道使用 SVK 和 perforce 的方法吗？文档[似乎暗示](http://svk.bestpractical.com/view/MirrorVCP)它曾经是可能的，但一些[邮件列表消息](http://lists.bestpractical.com/pipermail/svk-devel/2007-February/000604.html)声称不再是这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T08:23:00.443

对于私有存储库，您应该尝试[P5](http://www.releng.com/p5layer.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T09:22:37.660

为什么要使用 SVK 来镜像 Perforce？使用[Perforce 代理](http://www.perforce.com/perforce/products/p4p.html)肯定是使您的存储库分布式的最佳方式吗？

# .net - 使用 VS 构建后事件命令执行令牌替换？

> ID：52730
> 
> 赞同：1
> 
> 时间：2008-09-09T19:45:03.617
> 
> 标签：.net, visual-studio-2008, visual-studio-2005

我想“后处理”我的 app.config 文件并在项目构建后执行一些令牌替换。

有没有一种*简单*的方法可以使用[VS 构建后事件](http://msdn.microsoft.com/en-us/library/42x5kfw4(VS.80).aspx)命令来做到这一点？

*（是的，我知道我可能会使用 NAnt 或其他东西，寻找简单的东西。）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T19:51:10.903

看看[XmlPreProcess](http://xmlpreprocess.sourceforge.net/)。我们使用它为我们的测试和实时部署包生成不同的配置文件。我们从一个 nant 脚本执行它作为连续构建的一部分，但是，因为它是一个控制台应用程序，我看不出你为什么不能在项目的构建后事件中添加一个调用

# flash - 如何在 AS2 中动态创建 Video 对象并将其添加到 MovieClip？

> ID：52732
> 
> 赞同：2
> 
> 时间：2008-09-09T19:45:11.697
> 
> 标签：flash, video, actionscript-2

我需要在 ActionScript 2 中动态创建一个 Video 对象并将其添加到影片剪辑中。在 AS3 中，我只是这样做：

```
var videoViewComp:UIComponent; // created elsewhere    

videoView = new Video();
videoView.width = 400;
videoView.height = 400;
this.videoViewComp.addChild(videoView); 
```

不幸的是，我不知道如何在 AS2 中实现这一点。Video 不是 MovieClip 的子项，因此 attachMovie() 似乎没有得到任何帮助。我也没有看到任何与 AS3 的 UIComponent.addChild() 方法等效的方法。

有没有办法在 AS2 中动态创建一个实际出现在舞台上的 Video 对象？

* * *

不过，我可能一次需要多个视频。是否可以复制该视频对象？

我想我有另一个解决方案。它不是最佳的，但它适合我必须为其他组件做的一些事情，所以它在项目中并不太格格不入。一旦我弄清楚了，我会在这里发布我所做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T19:51:08.540

好的，我有一些工作。

首先，我创建了一个新的库符号并将其命名为“VideoWrapper”。然后，我向其中添加了一个 ID 为“video”的 Video 对象。

现在，任何时候我需要动态地将视频添加到我的状态中，我都可以使用 MovieClip.attachMovie() 添加视频对象的新副本。

为了让事情变得更简单，我编写了一个 VideoWrapper 类，它公开了基本的 UI 元素处理（setPosition()、setSize() 等）。因此，当在常规 UI 布局代码中处理视频时，我只使用这些方法，因此它看起来就像我的所有其他 UI 元素一样。在处理视频时，我只需访问班级的“视频”成员。

我的实际实现有点复杂，但这是我如何让事情工作的基础。我有一个测试应用程序正在播放 2 个视频，一个来自本地摄像头，一个来自 FMS，它运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-02T11:35:01.353

为了向您发送作为标签的行尾，我使用来自[w3schools的 HTML 符号实体](http://www.w3schools.com/tags/ref_symbols.asp)

取自项目的示例如下：

```
< asset path="library\video.swf" /> 
```

上面的行显示有一个名为 library 的目录，其中包含该文件`video.swf`

此外，目录库中还有文件video.xml。该文件包含行

```
<xml version="1.0" encoding="utf-8" >
<movie version="7">    
    <frame>
        <library>
            <clip id="VideoDisplay">
                <frame>
                    <video id="VideoSurface" width="160" height="120" />
                    <place id="VideoSurface" name="video" />
                </frame>
            </clip>
        </library>
    </frame>
</movie> 
```

很久以前，我儿子 Alex 从网上下载了 VideoDisplay 类的代码和目录库

我已经改进了 VideoDisplay 类的代码。

通过写 2 个成员

```
 public function pos():Number
{
    return ns.time;
}

     public function close():Void
{
    return ns.close();
} 
```

我创建的程序不仅仅是`.flv`文件的浏览器和呈现器

它也是每个`.flv`文件所选片段的浏览器和呈现器

现在 VideoDisplay 类的代码是：

```
class util.VideoDisplay
{
    //{ PUBLIC MEMBERS

    /**
    * Create a new video display surface
    */

    function VideoDisplay(targetURI:String, parent:MovieClip, name:String, depth:Number, initObj)

    {
        display = parent.attachMovie("VideoDisplay", name, depth, initObj);

        // create video stream
        nc = new NetConnection();
        nc.connect(targetURI);
        ns = new NetStream(nc);

        // attach the video stream to the video object
        display.video.attachVideo(ns);
    }

    /**
    * Video surface dimensions
    */
    function setSize(width:Number, heigth:Number):Void
    {
        display.video._width = width;
        display.video._height = heigth;
    }
    /**
    * Video clip position
    */
    function setLocation(x:Number, y:Number):Void
    {
        display._x = x;
        display._y = y;
    }

    /**
    * Start streaming
    * @param    url FLV file
    * @param    bufferTime  Buffer size (optional) 
    */
    public function play(url:String, bufferTime:Number):Void
    {
        if (bufferTime != undefined) ns.setBufferTime(bufferTime);
        ns.play(url);
    }
    /**
    * Pause streaming
    */
    public function pause():Void
    {
        ns.pause();
    }
    /**
    * Seek position in video
    */
    public function seek(offset:Number):Void
    {
        ns.seek(offset);
    }   

    /**
    * Get position in video
    */

     public function pos():Number
    {
        return ns.time;
    }

         public function close():Void
    {
        return ns.close();
    }

    //}

    //{ PRIVATE MEMBERS 

    private var display:MovieClip;
    private var nc:NetConnection;
    private var ns:NetStream;

    //}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T00:57:03.803

我建议您创建 Video 对象的单个实例，使其不可见（即`videoview.visible = false`），并在需要时加载剪辑，并在适当的时间显示它。`swapDepth()`如果有必要，您也可以使用。

AS2 中的视频处理并不是最好的。请放心，您会遇到很多小问题（无间隙循环等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T02:56:50.727

你的方法是我通常做的，因为其他选项是将 UIcomponent mediaDisplay 包含到库中，然后使用 attachMovie 附加该组件，但我发现 mediaDisplay 我有点小错误，所以我更喜欢使用原始视频实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-30T19:03:04.140

我希望下面的代码对您非常有用：

```
import UTIL.MEDIA.MEDIAInstances

class Main

{
    static function main() {

        var MEDIAInstancesInstance :MEDIAInstances  = new MEDIAInstances (); 

        _root.Video_Display.play ("IsothermalCompression.flv", 0);

        _root.VideoDisplayMC.onPress = function() { 

        _root.Video_Display.seek (0);        

        } // _root.displayMC.onPress = function() {

    } // static function main() 

} // class Main 

// 

import UTIL.MEDIA.VideoDisplay  

class UTIL.MEDIA.MEDIAInstances             

    {  

    function MEDIAInstances() 

    {

    //                                            depth  
    _root.createEmptyMovieClip ("VideoDisplayMC", 500);   
    //
    var Video_Display:VideoDisplay 
    = 
    new VideoDisplay(_root.VideoDisplayMC, "Video_Display", 1); 

    Video_Display.setLocation(400, 0); Video_Display.setSize (320, 240);      
    //    
    _root.Video_Display = Video_Display;  _root.VideoDisplayMC._alpha = 75;      

    } // MEDIAInstances()

} // class UTIL.MEDIA.MEDIAInstances

//

class UTIL.MEDIA.VideoDisplay

{
    private var display:MovieClip, nc:NetConnection, ns:NetStream;

    function VideoDisplay(parent:MovieClip, name:String, depth:Number)

    {
        display = parent.attachMovie("VideoDisplay", name, depth);

        nc = new NetConnection(); nc.connect(null); ns = new NetStream(nc);

        display.video.attachVideo(ns);
    }
    function setSize(width:Number, heigth:Number):Void

    { display.video._width = width; display.video._height = heigth;}

    function setLocation(x:Number, y:Number):Void { display._x = x; display._y = y;}

    public function play(url:String, bufferTime:Number):Void
    {
        if (bufferTime != undefined) ns.setBufferTime(bufferTime); ns.play(url);
    }
    //
    public function pause():Void { ns.pause();}
    //
    public function seek(offset:Number):Void { ns.seek(offset); }

} // UTIL.MEDIA.VideoDisplay 
```

# image - 有没有办法在不读取整个文件的情况下推断文件是什么图像格式？

> ID：52739
> 
> 赞同：12
> 
> 时间：2008-09-09T19:49:48.300
> 
> 标签：image, tiff

有没有一种好方法可以查看图像的格式，而无需将整个文件读入内存？

显然，这会因格式而异（我对 TIFF 文件特别感兴趣），但是哪种程序有助于确定文件是哪种图像格式而无需通读整个文件？

**奖励**：如果图像是 Base64 编码的字符串怎么办？在解码之前有什么可靠的方法来推断它吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-09T19:52:34.970

大多数图像文件格式在开始时都有唯一的字节。unix`file`命令查看文件的开头以查看它包含什么类型的数据。[请参阅有关文件](http://en.wikipedia.org/wiki/Magic_number_(programming)#Magic_numbers_in_files)和[magicdb.org](http://magicdb.org/)中的幻数的 Wikipedia 文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:35:50.333

当然有。就像其他人提到的那样，大多数图像都以某种“魔术”开头，它总是会转换为某种 Base64 数据。以下是几个例子：

位图将以`Qk3`

Jpeg 将以`/9j/`

GIF 将以`R0l`（第二个字符为零）开头。

等等。获取不同的图像类型并找出它们编码的内容并不难。只是要小心，因为有些魔法不止一种，所以你需要在你的 B64 '翻译代码'中说明它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T20:30:50.167

在 * nix`file`命令行上或读取文件的初始字节。大多数文件在前几个字节中都有一个唯一的标题。例如，TIFF 的标​​头看起来像这样：

```
0x00000000: 4949 2a00 0800 0000
```

有关 TIFF 文件格式的更多信息，特别是如果您想知道这些字节代表什么，请转到[此处](http://www.awaresystems.be/imaging/tiff/faq.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-12T09:41:13.043

TIFF 将以 II 或 MM（Intel 字节排序或 Motorolla）开头。
TIFF 6 规范可在[此处](http://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf)下载，并不难遵循

# .net - 我应该从 .NET 中的 Exception 或 ApplicationException 派生自定义异常吗？

> ID：52753
> 
> 赞同：74
> 
> 时间：2008-09-09T19:53:21.210
> 
> 标签：.net, exception

在 .NET 解决方案中创建异常类时的最佳实践是：从`System.Exception`还是从派生`System.ApplicationException`？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-09-09T20:02:36.180

根据框架设计指南书中的杰弗里·里希特（Jeffery Richter）：

> `System.ApplicationException`是一个不应属于 .NET 框架的类。

它旨在具有某种意义，因为您可以潜在地捕获“所有”应用程序异常，但是没有遵循该模式，因此它没有任何价值。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-07-06T12:12:28.513

您应该从`System.Exception`.

甚至 MSDN 现在都说要忽略`ApplicationException`：

> 如果您正在设计需要创建自己的异常的应用程序，建议您从 Exception 类派生自定义异常。最初认为自定义异常应该从 ApplicationException 类派生；然而，在实践中，这并没有增加显着的价值。有关更多信息，请参阅[处理异常的最佳实践](http://msdn.microsoft.com/en-us/library/seyhszts.aspx)。

[http://msdn.microsoft.com/en-us/library/system.applicationexception.aspx](http://msdn.microsoft.com/en-us/library/system.applicationexception.aspx)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-09T19:58:46.423

[`ApplicationException`认为无用](https://web.archive.org/web/20190904221653/https://blogs.msdn.microsoft.com/kcwalina/2006/06/23/applicationexception-considered-useless/)是反对`ApplicationException`.

结果：不要使用它。源自`Exception`.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-09T19:58:56.890

该框架的作者自己认为 ApplicationException 毫无价值：

[https://web.archive.org/web/20190904221653/https://blogs.msdn.microsoft.com/kcwalina/2006/06/23/applicationexception-considered-useless/](https://web.archive.org/web/20190904221653/https://blogs.msdn.microsoft.com/kcwalina/2006/06/23/applicationexception-considered-useless/)

这里有一个很好的跟进：

[https://web.archive.org/web/20190828075736/https://blogs.msdn.microsoft.com/kcwalina/2006/07/05/choosing-the-right-type-of-exception-to-throw/](https://web.archive.org/web/20190828075736/https://blogs.msdn.microsoft.com/kcwalina/2006/07/05/choosing-the-right-type-of-exception-to-throw/)

如有疑问，我会遵循他们的《框架设计指南》一书。

[http://www.amazon.com/Framework-Design-Guidelines-Conventions-Development/dp/0321246756](https://rads.stackoverflow.com/amzn/click/com/0321246756)

那里进一步讨论了博客文章的主题。

rp

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-06T12:07:49.053

我习惯这样做：

```
private void buttonFoo_Click()
{
    try
    {
       foo();
    } 
    catch(ApplicationException ex)
    {
      Log.UserWarning(ex);
      MessageVox.Show(ex.Message);
    }
    catch(Exception ex)
    {
       Log.CodeError(ex);
       MessageBox.Show("Internal error.");
    }
} 
```

它允许做以下区别：

*   我必须修复的 C# 代码系统错误。
*   不需要我更正的“正常”用户错误。

我知道不建议使用 ApplicationException，但它的效果很好，因为[很少有类](http://msdn.microsoft.com/en-us/library/system.applicationexception.aspx)不尊重 ApplicationException 模式。

# multiple-monitors - 是什么决定了我的应用程序在哪个监视器上运行？

> ID：52755
> 
> 赞同：78
> 
> 时间：2008-09-09T19:54:16.277
> 
> 标签：multiple-monitors

我使用的是 Windows，我有两台显示器。

某些应用程序将*始终*在我的主监视器上启动，无论我关闭它们时它们在哪里。

其他人将始终在*辅助*监视器上启动，无论我关闭它们时他们在哪里。

是否有隐藏在某处的注册表设置，我可以操纵它来控制默认情况下启动哪些监视器应用程序？

@rp：我有 Ultramon，我同意它是不可或缺的，以至于微软应该购买它并将其整合到他们的操作系统中。但是正如您所说，它不允许您控制程序启动的默认监视器。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-04T15:05:48.020

这是我发现的。如果您希望应用程序默认在辅助显示器上打开，请执行以下操作：

```
1\. Open the application.
2\. Re-size the window so that it is not maximized or minimized.
3\. Move the window to the monitor you want it to open on by default.
4\. Close the application.  Do not re-size prior to closing.
5\. Open the application.
   It should open on the monitor you just moved it to and closed it on.
6\. Maximize the window. 
```

默认情况下，该应用程序现在将在此监视器上打开。如果要将其更改为另一台显示器，只需再次执行步骤 1-6。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-09-09T23:56:07.833

正确编写的 Windows 应用程序想要保存其位置从运行到运行将保存[`GetWindowPlacement()`](http://msdn.microsoft.com/ru-ru/library/windows/desktop/ms633518%28v=vs.85%29.aspx)关闭前的结果，然后`SetWindowPlacement()`在启动时使用以恢复其位置。

通常，应用程序会将结果存储`GetWindowPlacement()`在注册表中`REG_BINARY`以方便使用。

与其他方法相比，该`WINDOWPLACEMENT`路线具有许多优点：

*   处理自上次运行以来屏幕分辨率发生变化的情况：`SetWindowPlacement()`将自动确保窗口不完全脱离屏幕
*   保存状态（最小化/最大化）但也保存恢复的（正常）大小和位置
*   正确处理桌面指标，补偿任务栏位置等（即使用“工作区坐标”而不是“屏幕坐标”——依赖于保存屏幕坐标的技术可能会遇到“窗口移动”问题，即窗口总是出现如果用户在屏幕顶部有一个工具栏，则每次都要低一点）。

最后，正确处理窗口恢复的程序将考虑`nCmdShow`从 shell 传入的参数。此参数在启动应用程序的快捷方式中设置（Normal、Minimized、Maximize）：

```
if(nCmdShow != SW_SHOWNORMAL)
    placement.showCmd = nCmdShow; //allow shortcut to override 
```

对于非 Win32 应用程序，重要的是要确保您用于保存/恢复窗口位置的方法最终使用相同的底层调用，否则（如 Java Swing 的`setBounds()`/`getBounds()`问题）您最终将编写大量额外代码重新实现功能中已经存在的`WINDOWPLACEMENT`功能。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-09T20:11:54.020

获取 UltraMon。迅速地。

[http://realtimesoft.com/ultramon/](http://realtimesoft.com/ultramon/)

它不允许您指定应用程序在哪个监视器上启动，但它允许您将应用程序移动到另一个监视器，并保持其纵横比不变，只需单击鼠标即可。这是一个非常方便的实用程序。

大多数程序将从您上次离开的地方开始。因此，如果您有两台显示器在工作，但家里只有一台，则可以在家中启动笔记本电脑，而看不到在另一台显示器上运行的应用程序（现在不存在）。UltrMon 还允许您快速轻松地将那些孤立的应用程序移回主屏幕。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-09-18T09:42:34.607

`Shift + Win + [left,right] arrow keys`这不完全是这个问题的答案，但我用捷径处理了这个问题。您可以使用它将当前活动窗口移动到另一个监视器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-09T20:04:11.697

我相当确定主显示器是默认的。如果应用程序编码得体，当它关闭时，它会记住它上次所在的位置并将在那里重新打开，但是 - 正如您所注意到的 - 这不是默认行为。

编辑：我通常这样做的方式是将位置存储在应用程序的设置中。加载时，如果它们没有值，则默认为屏幕中心。在关闭表格时，它会记录其位置。这样，每当它打开时，它就是最后一次打开的地方。但是，我不知道有一种简单的方法可以让它第一次自动启动到第二台显示器上。

——凯文·费尔柴尔德

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T15:55:41.957

重要提示：如果您记得应用程序的位置并关闭，然后在该位置重新启动，请记住，在您的应用程序关闭时，用户的监视器配置可能已更改。

例如，笔记本电脑用户经常更改他们的显示配置。对接时，可能会有第二台显示器在未对接时消失。如果用户关闭了在第二台监视器上运行的应用程序并在监视器断开连接时重新打开该应用程序，将窗口恢复到之前的坐标将使其完全脱离屏幕。

要弄清楚显示器到底有多大，请查看 GetSystemMetrics。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-31T20:27:24.633

所以我在使用 Adob​​e Reader 9.0 时遇到了这个问题。不知何故，程序忘记在我的右显示器上打开，并且一直在我的左显示器上打开。大多数程序允许您将其拖过，最大化屏幕，然后将其关闭，它会记住。好吧，使用 Adob​​e，我必须将它拖过去然后关闭它，然后再将其最大化，以便 Windows 记住下次在哪个屏幕中打开它。将其设置为正确的显示器后，您就可以将其最大化。我认为这是愚蠢的，因为几乎所有的 Windows 程序都会自动记住它，而无需尝试为 XP 提供一种记住的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-07T18:17:14.383

所以我同意有些应用程序可以配置为通过最大化或右键单击和移动/调整屏幕大小在一个屏幕上打开，然后关闭并重新打开。但是，还有一些只能在主屏幕上打开。

我所做的解决方法是：将您喜欢打开顽固应用程序的显示器设置为显示器 1，将另一台显示器设置为 2，然后将显示器 2 更改为主显示器 - 这样您的桌面设置和开始栏就会保留。希望这可以帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-09T20:05:07.390

不要强迫我这样做，但我很确定这取决于它本身的应用程序。我知道很多总是在主显示器上打开，有些会重新打开到之前运行的同一台显示器，有些你可以设置。例如，我知道我有打开特定目录的命令窗口的快捷方式，并且每个快捷方式在其属性中都有一个用于打开窗口位置的选项。虽然 Outlook 只记住并在最后一个屏幕中打开它。然后是其他应用程序在当前焦点所在的任何窗口中打开。

所以我不确定有没有办法告诉每个程序在哪里打开。希望对一些人有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-10T12:55:55.387

我注意到，如果我在一个屏幕上的桌面上放置一个快捷方式，则启动的应用程序可能会出现在该屏幕上（***如果***该应用程序没有自行重新定位）。

这也适用于从 Windows 资源管理器运行的东西——如果资源管理器在一个屏幕上，启动的应用程序将选择要使用的监视器。

再次 - 我认为这是启动应用程序指定默认（Windows 管理）位置的时候。大多数应用程序似乎以某种方式覆盖了这种默认行为。

像这样创建的一个简单窗口将执行此操作：

hWnd = CreateWindow(windowClass, windowTitle, WS_VISIBLE | WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, SW_SHOW, CW_USEDEFAULT, 0, NULL, NULL, hInst, NULL);

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2014-12-31T00:03:51.357

右键单击快捷方式并选择属性。确保您位于“快捷方式”选项卡上。选择运行下拉框并将其更改为最大化。

这可能有助于在主监视器上全屏启动程序。

# c++ - Qt中的多线程事件处理程序

> ID：52772
> 
> 赞同：1
> 
> 时间：2008-09-09T20:02:48.113
> 
> 标签：c++, qt, events

有谁知道事件处理程序如何管理发布的事件？

在我的应用程序中，我有两个线程（*guiThread*和*computeThread*）。引发异常后，我调用`postEvent(..)`现有对话框。Qt-Event-Handler 保留这个直到对话框关闭。

* * *

抱歉，我的问题有点模糊。如果我有时间，我会更准确地写它。我找到了解决办法。但对我来说，这个问题仍然很有趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T12:20:02.273

正如 Qt 文档中提到的[QCoreApplication::postEvent](http://doc.qt.io/qt-4.8/qcoreapplication.html#postEvent)：

> 当控制返回到主事件循环时，存储在队列中的所有事件都将使用 notify() 函数发送。

...这解释了为什么 Qt 事件处理程序会保留事件直到对话框关闭。

如果我正确理解您想要做什么，我会尝试使用[sendEvent](http://doc.qt.io/qt-4.8/qcoreapplication.html#sendEvent)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T20:31:59.960

我猜您创建的对话框是模态的，这意味着它正在运行自己的事件循环。在退出所有模式事件循环之前，不会处理发布到通用 guiThread 的事件。

或者，如果您需要对话框既是模态的又知道事件，您可以将事件直接发布到对话框。您需要弄清楚如何以共享方式处理指针，但如果没有发生任何复杂的事情，您也许可以使用 QApplication::activeWindow() 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T12:39:08.780

正如其他人已经写的那样，我相信这种行为是由对话框启动自己的事件循环这一事实引起的。

如果您使用 Qt4，您可以尝试使用[排队的信号/插槽连接](http://doc.qt.io/qt-4.8/threads-qobject.html#signals-and-slots-across-threads)作为发布事件的替代方法。

# version-control - 您如何制作仅包含众多待定更改之一的构建？

> ID：52778
> 
> 赞同：1
> 
> 时间：2008-09-09T20:04:54.927
> 
> 标签：version-control, testing, build-process

在我当前的环境中，我们有一个“干净”的构建机器，它拥有所有已提交更改的精确副本，仅此而已。

当然，我有自己的机器，有几十个文件处于“进行中”状态。

通常我需要构建我的应用程序，只需要进行一次更改。例如，我已经完成了任务 ABC，并且我想构建一个*只有*该更改的 EXE。

但是，在测试之前，我当然不能将更改提交到存储库。

为此，分支似乎过大了。您如何在您的环境中隔离测试构建和发布的更改？

@Matt b：所以当您等待有关更改的反馈时，您会做什么？你总是只做一件事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T11:19:21.140

所以你问的是如何同时处理多个“任务”，对吧？除了分支。

您可以在本地计算机上对源进行多次检出，并在目录名称后面加上您正在处理的票证名称。只需确保根据任务在正确的目录中进行更改...

在一个工作副本/提交中混合多个任务可能会变得非常混乱，尤其是当有人需要稍后查看您的工作时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T20:08:00.503

在提交或促进任何更改之前，我更喜欢在我的本地机器/环境上进行构建和测试。

对于您的具体示例，我会在开始任务 ABC 之前检查源的干净副本，并在实施 ABC 之后，在其中创建一个本地构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T20:08:03.343

类似的东西： git stash && ./bootstrap.sh && make tests :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-13T20:13:48.490

我努力让每个“提交”操作都代表一个单一的、有凝聚力的变化。有时它是一个完整的错误修复或整个功能，有时它是一个小的重构，正在走向更大的东西。没有简单的方法来决定这里的单位是什么，只是凭直觉。我也要求（请求！）我的队友也这样做。

如果做得好，您将获得许多好处：

*   您可以为更改编写高质量、详细的描述。
*   阅读每个更改描述的第一行可以让您了解代码的流程。
*   更改的差异很容易阅读和理解。
*   如果更改引入了错误/构建中断/其他问题，则很容易隔离、理解并在必要时退出。
*   如果我在改变中途并决定中止，我不会损失太多。
*   如果我不确定下一步如何进行，我可以在几种方法中的每一种上花几分钟，然后选择我喜欢的一种，丢弃其他的。
*   我的同事更快地接受了我的大部分更改，极大地简化了合并问题。
*   当我对一个大问题感到困惑时，我可以采取一些我有信心的小步骤，边走边检查，从而使大问题变得更小。

像这样工作可以帮助减少对小分支的需求，因为你采取了一个小的、自信的步骤，验证它，提交它，然后重复。我已经讨论过如何使步骤变得小而自信，但是要使其发挥作用，您还需要使验证阶段快速进行。拥有强大的快速、细粒度的单元测试 + 高质量、快速的应用程序测试是关键。

在签入之前需要进行代码审查之前我工作过的团队；这会增加延迟，这会干扰我的小步工作方式。使代码审查成为高紧急中断工作；切换到结对编程也是如此。

尽管如此，我的大脑似乎还是喜欢繁重的多任务处理。为了完成这项工作，我仍然希望进行多项正在进行的更改。我使用了多个分支、多个本地副本、多台计算机和[工具来备份挂起的更改](http://msdn.microsoft.com/en-us/library/ms181403(VS.80).aspx)。他们都可以工作。（而且它们都是等效的，以不同的方式实现。）我认为多个分支是我的最爱，尽管您需要一个源代码控制系统，该系统擅长快速轻松地启动新分支，而不会给服务器造成负担。我听说 BitKeeper 在这方面做得很好，但我还没有机会去看看。

# javascript - 如何将 div 添加到 DOM 并稍后将其拾取

> ID：52785
> 
> 赞同：2
> 
> 时间：2008-09-09T20:07:56.463
> 
> 标签：javascript, css, dhtml

我认为这是特定于 IE 6.0 但...

在 JavaScript 中，我将 a 添加`div`到 DOM。我分配一个`id`属性。当我后来尝试`div`通过`id`我得到的只是`null`。

有什么建议么？

例子：

```
var newDiv = document.createElement("DIV");
newDiv.setAttribute("ID", "obj_1000");
document.appendChild(newDiv);

alert("Added:" + newDiv.getAttribute("ID") + ":" + newDiv.id + ":" + document.getElementById("obj_1000") ); 
```

警报打印`"::null"`

似乎在 Firefox 2.0+ 中运行良好

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T20:17:49.433

除了其他答案的建议（您需要将元素实际插入 DOM 以便通过 找到它`getElementById()`）之外，您还需要使用小写的属性名称，以便 IE6 将其识别为`id`：

```
var newDiv = document.createElement("DIV"); 
newDiv.setAttribute("id", "obj_1000");
document.body.appendChild(newDiv);

alert("Added:"
   + newDiv.getAttribute("id") 
   + ":" + newDiv.id + ":" 
   + document.getElementById("obj_1000") ); 
```

...按预期响应：

```
Added:obj_1000:obj_1000:[object] 
```

* * *

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms536739(VS.85).aspx)，`setAttribute()`直到 IE8，还有一个可选的*第三个参数*，用于控制属性名称是否区分大小写。猜猜默认是什么...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T20:10:09.327

需要将 div 添加到元素中才能使其成为文档的一部分。

```
document.appendChild(newDiv);

alert( document.getElementById("obj_1000") ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T20:09:50.297

您必须将 div 添加到 dom。

```
// Create the Div
var oDiv = document.createElement('div');
document.body.appendChild(oDiv); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T20:10:22.260

newDiv.setAttribute("ID", "obj_1000");

应该

newDiv.id = "obj_1000";

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T20:20:40.020

嗯，谢谢你们让我走上正确的轨道……这很奇怪，但事实证明，如果我将大小写改为小写，一切都开始正常了……

完成结果：

```
var newDiv = document.createElement("DIV");
newDiv.setAttribute("id", "obj_1000");
document.appendChild(newDiv);

alert("Added:" +
      newDiv.getAttribute("id") + ":" +
      newDiv.id + ":" +
      document.getElementById("obj_1000")); 
```

奇怪...非常奇怪

# svn - 在 Subversion 中更改目录结构

> ID：52794
> 
> 赞同：6
> 
> 时间：2008-09-09T20:11:21.743
> 
> 标签：svn, branch, trunk

如何在 subversion 中创建一个比“分支”目录更深的分支？

我有标准`trunk`和结构`tags`，`branches`我想创建一个比“分支”标签更深的几个目录的分支。

使用标准的 svn move 方法，它给了我一个**找不到文件夹**的错误。我还尝试将它复制到分支文件夹中，检查出来，然后将它“svn move”到我想要的树结构中，但也出现“缺少工作副本管理区域”错误。

我需要做什么来创建这个？

为了说明起见，假设我想创建一个分支直接进入'branches/version_1/project/subproject'（尚不存在）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-09T20:13:06.263

```
svn copy --parents http://url/to/subproject http://url/to/repository/branches/version_1/project/subproject 
```

那应该创建您想要放置子项目的目录（`--parents`意思是“为我创建中间目录”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T20:18:53.333

由于 subversion 实际上并没有将分支视为除了更多目录之外的任何特殊内容，因此您始终可以创建您想要的目录树（使用 svn mkdir）然后将您想要的代码复制到树位置。

或者只是使用提到的 --parents 标志@BlairC。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T20:24:30.137

我第二次使用 TortoiseSVN，只需在目录上右击，进入 TortoiseSVN->Branch/tag... 即可在指定目录快速创建分支。请务必在生成的“复制（分支/标签）”对话框窗口中填写您想要的 URL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T20:17:35.817

如果你正在使用`TortoiseSVN`，你可以使用它的**Repository Explorer**来做这些事情。让这一切变得非常`WYSIWYG`简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T20:53:22.703

`SVN`并没有真正管理您的分支机构。它只是批发复制。由您决定如何管理它。

# c# - 如何获取代码所在程序集的路径？

> ID：52797
> 
> 赞同：877
> 
> 时间：2008-09-09T20:12:28.340
> 
> 标签：c#, .net, reflection, mbunit

有没有办法获取当前代码所在程序集的路径？我不想要调用程序集的路径，只想要包含代码的路径。

基本上我的单元测试需要读取一些相对于 dll 的 xml 测试文件。无论测试 dll 是从 TestDriven.NET、MbUnit GUI 还是其他东西运行，我都希望路径始终正确解析。

**编辑**：人们似乎误解了我的要求。

我的测试库位于说

> C:\projects\myapplication\daotests\bin\Debug\daotests.dll

我想得到这条路：

> C:\projects\myapplication\daotests\bin\Debug\

到目前为止，当我从 MbUnit Gui 运行时，三个建议都失败了：

*   `Environment.CurrentDirectory` 给出*c:\Program Files\MbUnit*

*   `System.Reflection.Assembly.GetAssembly(typeof(DaoTests)).Location` 给出*C:\Documents and Settings\george\Local Settings\Temp\ ....\DaoTests.dll*

*   `System.Reflection.Assembly.GetExecutingAssembly().Location` 给出与前一个相同的结果。

* * *

## 回答 #1

> 赞同：1136
> 
> 时间：2008-11-12T13:24:56.133

我已经定义了以下属性，因为我们经常在单元测试中使用它。

```
public static string AssemblyDirectory
{
    get
    {
        string codeBase = Assembly.GetExecutingAssembly().CodeBase;
        UriBuilder uri = new UriBuilder(codeBase);
        string path = Uri.UnescapeDataString(uri.Path);
        return Path.GetDirectoryName(path);
    }
} 
```

使用 NUnit（程序集从临时文件夹运行）时，该`Assembly.Location`属性有时会给您一些有趣的结果，因此我更喜欢使用`CodeBase`它为您提供 URI 格式的路径，然后`UriBuild.UnescapeDataString`删除`File://`开头的 ，并将`GetDirectoryName`其更改为正常的 windows 格式.

* * *

## 回答 #2

> 赞同：346
> 
> 时间：2008-09-09T21:26:52.093

这有帮助吗？

```
//get the full location of the assembly with DaoTests in it
string fullPath = System.Reflection.Assembly.GetAssembly(typeof(DaoTests)).Location;

//get the folder that's in
string theDirectory = Path.GetDirectoryName( fullPath ); 
```

* * *

## 回答 #3

> 赞同：345
> 
> 时间：2010-05-22T09:14:20.027

就这么简单：

```
var dir = AppDomain.CurrentDomain.BaseDirectory; 
```

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2010-04-02T14:43:27.357

与约翰的答案相同，但扩展方法稍微不那么冗长。

```
public static string GetDirectoryPath(this Assembly assembly)
{
    string filePath = new Uri(assembly.CodeBase).LocalPath;
    return Path.GetDirectoryName(filePath);            
} 
```

现在你可以这样做：

```
var localDir = Assembly.GetExecutingAssembly().GetDirectoryPath(); 
```

或者，如果您愿意：

```
var localDir = typeof(DaoTests).Assembly.GetDirectoryPath(); 
```

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2012-03-16T12:40:45.580

使用 CodeBase 和 UNC 网络共享时唯一对我有用的解决方案是：

```
System.IO.Path.GetDirectoryName(new System.Uri(System.Reflection.Assembly.GetExecutingAssembly().CodeBase).LocalPath); 
```

它也适用于普通的 URI。

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2008-09-09T20:14:36.807

这应该可以工作，除非程序集被*影子复制*：

```
string path = System.Reflection.Assembly.GetExecutingAssembly().Location 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2019-09-22T16:48:33.130

我相信这适用于任何类型的应用程序：

```
AppDomain.CurrentDomain.RelativeSearchPath ?? AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-09T21:40:06.367

那这个呢：

```
System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location); 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2010-06-16T08:07:46.710

```
AppDomain.CurrentDomain.BaseDirectory 
```

与 MbUnit GUI 一起工作。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2008-09-09T21:36:04.270

我怀疑这里真正的问题是您的测试运行程序正在将您的程序集复制到不同的位置。在运行时无法判断程序集是从哪里复制的，但您可以拨动一个开关来告诉测试运行程序从它所在的位置运行程序集，而不是将其复制到影子目录。

当然，对于每个测试运行者，这样的切换可能会有所不同。

您是否考虑过将 XML 数据作为资源嵌入到测试程序集中？

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2016-08-29T22:37:14.957

这个怎么样 ...

```
string ThisdllDirectory = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location); 
```

然后砍掉你不需要的东西

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2020-06-28T17:40:03.307

从 .net framework 4.6 / .net core 1.0 开始，现在有一个[AppContext.BaseDirectory](https://docs.microsoft.com/en-us/dotnet/api/system.appcontext.basedirectory)，它应该给出与 相同的结果`AppDomain.CurrentDomain.BaseDirectory`，除了 AppDomains 不是 .net core 1.x /.net standard 1.x API 的一部分.

```
AppContext.BaseDirectory 
```

编辑：文档现在甚至声明：

> 在 .NET 5.0 及更高版本中，对于捆绑程序集，返回的值是宿主可执行文件的包含目录。

事实上，[Assembly.Location doc](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.location?view=net-5.0)文档说：

> 在 .NET 5.0 和更高版本中，对于捆绑的程序集，返回的值是一个空字符串。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2014-06-16T18:13:53.053

据我所知，大多数其他答案都有一些问题。

[对于基于磁盘（相对于基于 Web）、非 GAC 程序集](http://blogs.msdn.com/b/suzcook/archive/2003/06/26/assembly-codebase-vs-assembly-location.aspx)执行此操作的正确方法是使用当前执行程序集的`CodeBase`属性。

这将返回一个 URL ( `file://`)。与其搞乱[字符串操作](https://stackoverflow.com/a/52996/14357)or ，[`UnescapeDataString`](https://stackoverflow.com/a/283917/14357)不如利用`LocalPath`.`Uri`

```
var codeBaseUrl = Assembly.GetExecutingAssembly().CodeBase;
var filePathToCodeBase = new Uri(codeBaseUrl).LocalPath;
var directoryPath = Path.GetDirectoryName(filePathToCodeBase); 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-09-09T21:32:28.960

```
var assembly = System.Reflection.Assembly.GetExecutingAssembly();
var assemblyPath = assembly.GetFiles()[0].Name;
var assemblyDir = System.IO.Path.GetDirectoryName(assemblyPath); 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-05-19T18:58:27.997

这是 John Sibly 代码的 VB.NET 端口。Visual Basic 不区分大小写，因此他的几个变量名与类型名冲突。

```
Public Shared ReadOnly Property AssemblyDirectory() As String
    Get
        Dim codeBase As String = Assembly.GetExecutingAssembly().CodeBase
        Dim uriBuilder As New UriBuilder(codeBase)
        Dim assemblyPath As String = Uri.UnescapeDataString(uriBuilder.Path)
        Return Path.GetDirectoryName(assemblyPath)
    End Get
End Property 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2021-07-02T10:05:30.993

## tl;博士

程序集和 DLL 文件的概念并不相同。根据程序集的加载方式，路径信息会丢失或根本**不可用**。不过，在大多数情况下，提供的答案都会起作用。

* * *

这个问题和之前的答案有一个误解。在大多数情况下，提供的答案可以正常工作，但在某些情况下，**无法**获得当前代码所在程序集的正确路径。

程序集（包含可执行代码）和 dll 文件（包含程序集）的概念不是紧密耦合的。程序集可能来自 DLL 文件，但并非必须如此。

使用`Assembly.Load(Byte[])`( [MSDN](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.load?view=netframework-4.7.2) ) 方法，您可以直接从内存中的字节数组加载程序集。字节数组来自哪里并不重要。它可以从文件加载，从互联网下载，动态生成，...

这是一个从字节数组加载程序集的示例。加载文件后路径信息会丢失。无法获取原始文件路径，并且所有先前描述的方法都不起作用。

此方法位于执行程序集中，该程序集位于“D:/Software/DynamicAssemblyLoad/DynamicAssemblyLoad/bin/Debug/Runner.exe”

```
static void Main(string[] args)
{
    var fileContent = File.ReadAllBytes(@"C:\Library.dll");

    var assembly = Assembly.Load(fileContent);

    // Call the method of the library using reflection
    assembly
        ?.GetType("Library.LibraryClass")
        ?.GetMethod("PrintPath", BindingFlags.Public | BindingFlags.Static)
        ?.Invoke(null, null);

    Console.WriteLine("Hello from Application:");
    Console.WriteLine($"GetViaAssemblyCodeBase: {GetViaAssemblyCodeBase(assembly)}");
    Console.WriteLine($"GetViaAssemblyLocation: {assembly.Location}");
    Console.WriteLine($"GetViaAppDomain       : {AppDomain.CurrentDomain.BaseDirectory}");

    Console.ReadLine();
} 
```

该类位于 Library.dll 中：

```
public class LibraryClass
{
    public static void PrintPath()
    {
        var assembly = Assembly.GetAssembly(typeof(LibraryClass));
        Console.WriteLine("Hello from Library:");
        Console.WriteLine($"GetViaAssemblyCodeBase: {GetViaAssemblyCodeBase(assembly)}");
        Console.WriteLine($"GetViaAssemblyLocation: {assembly.Location}");
        Console.WriteLine($"GetViaAppDomain       : {AppDomain.CurrentDomain.BaseDirectory}");
    }
} 
```

为了完整起见，`GetViaAssemblyCodeBase()`这两个程序集的实现是相同的：

```
private static string GetViaAssemblyCodeBase(Assembly assembly)
{
    var codeBase = assembly.CodeBase;
    var uri = new UriBuilder(codeBase);
    return Uri.UnescapeDataString(uri.Path);
} 
```

Runner 打印以下输出：

```
Hello from Library:
GetViaAssemblyCodeBase: D:/Software/DynamicAssemblyLoad/DynamicAssemblyLoad/bin/Debug/Runner.exe
GetViaAssemblyLocation:
GetViaAppDomain       : D:\Software\DynamicAssemblyLoad\DynamicAssemblyLoad\bin\Debug\
Hello from Application:
GetViaAssemblyCodeBase: D:/Software/DynamicAssemblyLoad/DynamicAssemblyLoad/bin/Debug/Runner.exe
GetViaAssemblyLocation:
GetViaAppDomain       : D:\Software\DynamicAssemblyLoad\DynamicAssemblyLoad\bin\Debug\ 
```

如您所见，代码库、位置或基本目录都不正确。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2015-09-30T15:27:55.303

这些年来，没有人真正提到过这个。我从令人敬畏的[ApprovalTests 项目](https://github.com/approvals/ApprovalTests.Net/blob/master/ApprovalUtilities/Utilities/PathUtilities.cs)中学到的一个技巧。诀窍是您使用程序集中的调试信息来查找原始目录。

**这不会在 RELEASE 模式下工作，也不会在启用优化的情况下工作，也不会在与编译它的机器不同的机器上工作。**

但这将为您提供**相对于您从中调用它的源代码文件的位置的路径**

```
public static class PathUtilities
{
    public static string GetAdjacentFile(string relativePath)
    {
        return GetDirectoryForCaller(1) + relativePath;
    }
    public static string GetDirectoryForCaller()
    {
        return GetDirectoryForCaller(1);
    }

    public static string GetDirectoryForCaller(int callerStackDepth)
    {
        var stackFrame = new StackTrace(true).GetFrame(callerStackDepth + 1);
        return GetDirectoryForStackFrame(stackFrame);
    }

    public static string GetDirectoryForStackFrame(StackFrame stackFrame)
    {
        return new FileInfo(stackFrame.GetFileName()).Directory.FullName + Path.DirectorySeparatorChar;
    }
} 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-09-09T21:50:49.523

我一直在使用 Assembly.CodeBase 而不是 Location：

```
Assembly a;
a = Assembly.GetAssembly(typeof(DaoTests));
string s = a.CodeBase.ToUpper(); // file:///c:/path/name.dll
Assert.AreEqual(true, s.StartsWith("FILE://"), "CodeBase is " + s);
s = s.Substring(7, s.LastIndexOf('/') - 7); // 7 = "file://"
while (s.StartsWith("/")) {
    s = s.Substring(1, s.Length - 1);
}
s = s.Replace("/", "\\"); 
```

它一直在工作，但我不再确定它是 100% 正确的。[http://blogs.msdn.com/suzcook/archive/2003/06/26/assembly-codebase-vs-assembly-location.aspx](http://blogs.msdn.com/suzcook/archive/2003/06/26/assembly-codebase-vs-assembly-location.aspx)上的页面说：

*“CodeBase 是指向文件所在位置的 URL，而 Location 是实际加载文件的路径。例如，如果程序集是从 Internet 下载的，则其 CodeBase 可能以“http://”开头, 但它的位置可能以“C:\”开头。如果文件是卷影复制的，则位置将是卷影复制目录中文件副本的路径。知道 CodeBase 也不能保证为 GAC 中的程序集设置。但是，将始终为从磁盘加载的程序集设置位置。* "

您*可能*想要使用 CodeBase 而不是 Location。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-09-09T20:16:04.463

您所在的当前目录。

```
Environment.CurrentDirectory;  // This is the current directory of your application 
```

如果您使用 build 复制 .​​xml 文件，您应该会找到它。

或者

```
System.Reflection.Assembly assembly = System.Reflection.Assembly.GetAssembly(typeof(SomeObject));

// The location of the Assembly
assembly.Location; 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-04-22T13:19:47.177

您可以通过 AppDomain.CurrentDomain.RelativeSearchPath 获取 bin 路径

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2016-09-17T16:24:17.927

当开发人员可以更改代码以包含所需的代码段时，所有建议的答案都有效，但是如果您想在不更改任何代码的情况下执行此操作，则可以使用 Process Explorer。

它将列出系统上所有正在执行的 dll，您可能需要确定正在运行的应用程序的进程 ID，但这通常并不太难。

我已经写了关于如何为 II 中的 dll 执行此操作的完整描述 - [http://nodogmablog.bryanhogan.net/2016/09/locating-and-checking-an-executing-dll-on-a-running-web -服务器/](http://nodogmablog.bryanhogan.net/2016/09/locating-and-checking-an-executing-dll-on-a-running-web-server/)

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2017-12-11T19:39:54.537

在 Windows 窗体应用程序中，您可以简单地使用`Application.StartupPath`

但对于 DLL 和控制台应用程序，代码更难记住......

```
string slash = Path.DirectorySeparatorChar.ToString();
string root = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);

root += slash;
string settingsIni = root + "settings.ini" 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-10-29T15:12:51.960

如果路径包含“#”符号，您将获得不正确的目录。因此，我使用了对 John Sibly 答案的修改，即 UriBuilder.Path 和 UriBuilder.Fragment 的组合：

```
public static string AssemblyDirectory
{
    get
    {
        string codeBase = Assembly.GetExecutingAssembly().CodeBase;
        UriBuilder uri = new UriBuilder(codeBase);
        //modification of the John Sibly answer    
        string path = Uri.UnescapeDataString(uri.Path.Replace("/", "\\") + 
          uri.Fragment.Replace("/", "\\"));
        return Path.GetDirectoryName(path);
     }
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-08-28T02:30:54.273

对于 ASP.Net，它不起作用。我在[Why AppDomain.CurrentDomain.BaseDirectory not contains "bin" in asp.net app?](https://stackoverflow.com/questions/8669833/why-appdomain-currentdomain-basedirectory-not-contains-bin-in-asp-net-app) . 它适用于 Win 应用程序和 ASP.Net Web 应用程序。

```
public string ApplicationPath
    {
        get
        {
            if (String.IsNullOrEmpty(AppDomain.CurrentDomain.RelativeSearchPath))
            {
                return AppDomain.CurrentDomain.BaseDirectory; //exe folder for WinForms, Consoles, Windows Services
            }
            else
            {
                return AppDomain.CurrentDomain.RelativeSearchPath; //bin folder for Web Apps 
            }
        }
    } 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-09-09T21:46:48.783

```
string path = Path.GetDirectoryName(typeof(DaoTests).Module.FullyQualifiedName); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-06-12T08:04:28.510

这应该有效：

```
ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
Assembly asm = Assembly.GetCallingAssembly();
String path = Path.GetDirectoryName(new Uri(asm.EscapedCodeBase).LocalPath);

string strLog4NetConfigPath = System.IO.Path.Combine(path, "log4net.config"); 
```

我正在使用它来部署 DLL 文件库以及一些配置文件（这是在 DLL 文件中使用 log4net）。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-07-03T05:20:50.563

这就是我想出的。**在 web 项目之间，单元测试（nunit 和 resharper 测试运行器）**；我发现这对我有用。

我一直在寻找代码来检测构建的配置，`Debug/Release/CustomName`. 唉，`#if DEBUG`. *所以如果有人可以改进它*！

随意编辑和改进。

**获取应用文件夹**。用于 web 根目录，单元测试以获取测试文件的文件夹。

```
public static string AppPath
{
    get
    {
        DirectoryInfo appPath = new DirectoryInfo(AppDomain.CurrentDomain.BaseDirectory);

        while (appPath.FullName.Contains(@"\bin\", StringComparison.CurrentCultureIgnoreCase)
                || appPath.FullName.EndsWith(@"\bin", StringComparison.CurrentCultureIgnoreCase))
        {
            appPath = appPath.Parent;
        }
        return appPath.FullName;
    }
} 
```

**获取 bin 文件夹**：对于使用反射执行程序集很有用。如果由于构建属性而将文件复制到那里。

```
public static string BinPath
{
    get
    {
        string binPath = AppDomain.CurrentDomain.BaseDirectory;

        if (!binPath.Contains(@"\bin\", StringComparison.CurrentCultureIgnoreCase)
            && !binPath.EndsWith(@"\bin", StringComparison.CurrentCultureIgnoreCase))
        {
            binPath = Path.Combine(binPath, "bin");
            //-- Please improve this if there is a better way
            //-- Also note that apps like webapps do not have a debug or release folder. So we would just return bin.
#if DEBUG
            if (Directory.Exists(Path.Combine(binPath, "Debug"))) 
                        binPath = Path.Combine(binPath, "Debug");
#else
            if (Directory.Exists(Path.Combine(binPath, "Release"))) 
                        binPath = Path.Combine(binPath, "Release");
#endif
        }
            return binPath;
    }
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-09-23T11:54:32.190

我发现我的解决方案足以检索该位置。

```
var executingAssembly = new FileInfo((Assembly.GetExecutingAssembly().Location)).Directory.FullName; 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-09-30T09:55:13.407

我`NUnit`过去也有同样的行为。默认情况下`NUnit`，将您的程序集复制到临时目录中。您可以在设置中更改此行为`NUnit`：

[![在此处输入图像描述](https://i.stack.imgur.com/VxmI7.png)](https://i.stack.imgur.com/VxmI7.png)

也许`TestDriven.NET`和`MbUnit`GUI 有相同的设置。

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2011-12-21T18:00:49.467

我用它来获取 Bin 目录的路径：

```
var i = Environment.CurrentDirectory.LastIndexOf(@"\");
var path = Environment.CurrentDirectory.Substring(0,i); 
```

你得到这个结果：

> “c:\users\ricooley\documents\visual studio 2010\Projects\Windows_Test_Project\Windows_Test_Project\bin”

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2014-06-18T10:34:01.177

Web应用程序？

```
Server.MapPath("~/MyDir/MyFile.ext") 
```

# php - 构造一个复杂的 SQL 查询（或多个查询）

> ID：52806
> 
> 赞同：1
> 
> 时间：2008-09-09T20:18:07.563
> 
> 标签：php, cakephp

作为一个更大的网络应用程序（使用 CakePHP）的一部分，我正在组合一个简单的博客系统。关系非常简单：每个用户都有一个博客，其中有许多条目，有许多评论。

我想加入的一个元素是“热门条目”列表。热门条目被定义为上个月评论最多的条目，最终需要按最近评论的数量排序。

理想情况下，我希望解决方案保留在 Cake 的 Model 数据检索设备（`Model->find()`等）中，但我对此并不乐观。

有人有聪明/优雅的解决方案吗？我正在为一些疯狂的 SQL hacking 来完成这项工作...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T20:35:30.157

嘿，我正要返回基本相同的答案（使用 Cake's Model::find）：

```
$this->loadModel('Comment');

$this->Comment->find( 'all', array(
    'fields' => array('COUNT(Comment.id) AS popularCount'),
    'conditions' => array(
        'Comment.created >' => strtotime('-1 month')
    ),
    'group' => 'Comment.blog_post_id',
    'order' => 'popularCount DESC',

    'contain' => array(
        'Entry' => array(
            'fields' => array( 'Entry.title' )
        )
    )
)); 
```

它并不完美，但它可以工作并且可以改进。

我做了一个额外的改进，使用 Containable 行为来提取条目数据而不是评论数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T20:22:30.033

应该不会太糟糕，你只需要一个 group by （这不是我的想法，所以请原谅语法错误）：

```
SELECT entry-id, count(id) AS c 
FROM comment 
WHERE comment.createdate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) 
GROUP BY entry-id 
ORDER BY c DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T20:49:06.970

如果您不关心评论的时间敏感性，您可以通过在条目表中添加“comment_count”字段来使用 CakePHP 的 counterCache 功能，配置 Comment belongsTo Entry 关联的 counterCache 键与该字段，然后在 Entry 模型上调用 find()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T20:32:32.380

您可能希望**WHERE**子句仅获得最近 30 天的评论：

```
SELECT entry-id, count(id) AS c 
FROM comment 
WHERE comment_date + 30 >= sysdate
GROUP BY entry-id 
ORDER BY c DESC 
```

# .net - .NET 生产调试

> ID：52808
> 
> 赞同：7
> 
> 时间：2008-09-09T20:19:37.090
> 
> 标签：.net, debugging

我已经在生产中使用了一段时间的 Windows 应用程序，并将其设置为在引发异常时向我们发送错误报告。其中大部分都具有相当的描述性，可以帮助我很快找到问题（我使用 MS 应用程序异常块）。

在某些情况下，我的报告是我无法重现的问题，并且似乎只发生在少数客户端计算机上。

我没有对这些客户端计算机的物理访问权限，我可以使用哪些策略进行调试？在代码中构建一些跟踪会更好，还是有其他替代方案？

谢谢你。

编辑：我应该更清楚：我得到的错误报告确实有堆栈跟踪，但由于它是生产代码，它并没有指出导致异常的确切行，只是它被抛出的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T20:27:17.133

你在正确的轨道上。您需要创建一个在本地记录操作/异常的跟踪模块。

然后，您可以有一个按钮或菜单选项，用户可以单击该按钮或菜单选项，以便在问题发生时自动通过电子邮件向您发送此信息，或者他们可以选择获取文件，以便他们可以在任何情况下将其传输给您另一种方式。

您甚至可以内置诊断代码以在系统上运行完整性检查并向您发送报告（也许它会运行您的所有单元测试以查看它们是否在该系统上工作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T20:28:27.617

一种选择是生成一个（小型）转储文件，使其尽可能靠近引发异常的点。本文[讨论](http://blogs.microsoft.co.il/blogs/sasha/archive/2008/05/28/programmatically-generating-a-dump-file.aspx)如何从托管代码执行此操作。

然后，您可以将转储文件加载到 Visual Studio 或 WinDbg 并在[SOS的帮助下对其进行检查](http://dotnetdebug.net/2006/03/20/loading-and-using-sos-from-within-visual-studio/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T20:22:13.433

我总是使用 Jeff 的这个[模块](http://www.codeproject.com/KB/exception/ExceptionHandling.aspx)来处理未处理的异常，给我发送一封包含堆栈跟踪等的电子邮件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T20:49:37.657

[Gurock Software](http://www.gurock.com/)的Smart Inspect多次为我派上用场。它很容易放入 .NET 应用程序中，并在分析日志文件时为您提供极其强大的控制。它具有日志级别，允许您关闭某些功能，除非在某些情况下，这样您就不会失去性能。

他们甚至拥有服务器软件，当您无法完全访问机器时，您的软件可以连接到该软件以保存日志。例如，您可以在 www.yourdomain.com 上运行服务器。您的软件将有一个配置选项来打开调试。Smart Inspect 将被配置为将日志数据发送到您的服务器（并且可以选择发送到本地文件），这样无论软件在哪里运行，您都可以获得实时日志记录。

Smart Inspect 非常易于配置，并且具有许多可用于帮助的功能。我用它来动态调试高影响力的多线程服务器应用程序，而无需关闭机器。它具有跟踪不同进程、线程和机器的所有钩子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T20:26:44.140

我会使用事件日志。看看这里：

[http://support.microsoft.com/kb/307024](http://support.microsoft.com/kb/307024)

# asp.net - iPhone网站优化帮助

> ID：52816
> 
> 赞同：4
> 
> 时间：2008-09-09T20:23:55.100
> 
> 标签：asp.net, iphone, dashcode

我们正在尝试为我们的一个 asp.net Web 应用程序制作移动版本，但是我们希望使 iPhone 成为特定的。

是否有任何资源可以提供最佳实践指南：

*   UI 指南，任何特定于 iPhone 的 .net 控件库。
*   安全准则 - iPhone 浏览器（移动 safari）具有的任何特殊功能。
*   可用性指南 - 导航提示、按钮大小等。

任何其他可以帮助我们组合一个看起来是 iPhone 原生的应用程序的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T20:41:58.660

A List Apart 上有几篇很好的文章：

*   [把你的内容放在我的口袋里](http://www.alistapart.com/articles/putyourcontentinmypocket)
*   [我口袋里的内容，第二部分](http://www.alistapart.com/articles/putyourcontentinmypocketpart2)

此外，Apple 有[Safari Web 内容指南](http://developer.apple.com/documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/chapter_4_section_1.html#//apple_ref/doc/uid/TP40006509-SW1)，其中包含在为 iPhone 设计 Web 内容时配置视口的大量宝贵信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T20:32:18.870

Apple 有一个[Web Apps Dev Center](http://developer.apple.com/webapps/)（需要免费的 ADC 帐户）。

此外，最新版本的 DashCode 具有适用于 iPhone 网站的内置模板。其中一些资源可能适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T20:43:22.587

以下是一些设计资源：

*   [Tutorialblog 的资源列表](http://tutorialblog.org/designing-for-the-iphone-resources/)
*   [Mashable 的资源列表](http://mashable.com/2007/08/03/iphone-toolbox/)

另外，我认为 facebook 开源了他们为制作 iphone.facebook.com 而构建的 javascript-API，但我目前找不到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T20:47:28.707

我忘了提一下，[iUI](http://www.joehewitt.com/blog/introducing_iui.php)是一个简洁的 CSS 和 JavaScript 包，专门针对 iPhone 网络应用程序。它可能会为您节省很多时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T12:52:39.053

您可以在 css-tricks.com 上查看本教程：[#38：iPhone 设计基础和技巧](http://css-tricks.com/video-screencasts/38-basics-tips-on-designing-for-the-iphone/)

# linq-to-sql - 在 LINQ to SQL 中，我怎样才能做到这一点，以便我可以在不先保存实体的情况下将项目添加到实体的集合中？

> ID：52821
> 
> 赞同：2
> 
> 时间：2008-09-09T20:25:10.570
> 
> 标签：linq-to-sql

```
var e1 = new E1();
e1.e2s.Add(new e2()); //e2s is null until e1 is saved, i want to save them all at the same time
context.e1s.imsertonsubmit(e1);
context.submitchanges(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T10:24:44.450

如果您为 DataClasses 提供这些类之间的关联，则子项将与主项一起保存，甚至身份也将正确设置。

您可以通过将 LoadOptions 添加到您的 O/R-Designer DataClasses 来做到这一点，如下所示：

```
 MyDataContext mydc = new MyDataContext();
  System.Data.Linq.DataLoadOptions lo = new System.Data.Linq.DataLoadOptions();
  lo.LoadWith<E1>(p => p.e2s);
  mydc.LoadOptions = lo; 
```

这样 LINQ 将负责添加子项，您不需要单独插入每个项。副作用：加载项目时，子项目也将被检索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T20:48:36.507

好吧 - 我不知道你的初始代码块是否可以工作，但我猜你必须在提交时将你的新 e2 标记为插入。因此：

```
var e1 = new E1();
var e2 = new e2();
e1.e2s.Add(e2); //e2s is null until e1 is saved, i want to save them all at the same time
context.e1s.insertonsubmit(e1);
context.e2s.insertonsubmit(e2);
context.submitchanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T22:10:00.443

好了，显然，当您创建另一个 ctor 时，您必须实际调用 no arg ctor 才能使 ctor 中的内容发生

# sql-server - 如何在 SQL Server 中导入 DBF 文件

> ID：52822
> 
> 赞同：17
> 
> 时间：2008-09-09T20:26:12.550
> 
> 标签：sql-server, foxpro, dbf

如何在 SQL Server 中导入 foxpro DBF 文件？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-09T20:28:35.680

使用链接服务器或使用 openrowset，例如

```
SELECT * into SomeTable
FROM OPENROWSET('MSDASQL', 'Driver=Microsoft Visual FoxPro Driver;
SourceDB=\\SomeServer\SomePath\;
SourceType=DBF',
'SELECT * FROM SomeDBF') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T16:51:11.207

我能够使用来自 jnovation 的答案，但由于我的字段有问题，我只是选择了特定字段而不是全部，例如：

```
select * into CERTDATA
from  openrowset('VFPOLEDB','C:\SomePath\CERTDATA.DBF';'';
    '','SELECT ACTUAL, CERTID,  FROM CERTDATA') 
```

感谢这里的每一个人，终于有一个可行的答案非常令人兴奋！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-14T16:10:13.630

最终对我们有用的是使用[FoxPro OLEDB 驱动程序](http://www.microsoft.com/download/en/details.aspx?id=14839)并使用以下语法。在我们的例子中，我们使用的是 SQL 2008。

```
select * from 
    openrowset('VFPOLEDB','\\VM-GIS\E\Projects\mymap.dbf';'';
    '','SELECT * FROM mymap') 
```

`\\VM-GIS...`用您的 DBF 文件的位置（UNC 或驱动器路径）替换。此外，`mymap`在 之后替换`FROM`为不带 .dbf 扩展名的 DBF 文件的名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-23T10:34:31.550

[http://elphsoft.com/dbfcommander.html](http://elphsoft.com/dbfcommander.html)可以从 DBF 导出到 SQL Server，反之亦然

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T20:31:32.240

此工具允许您导入和从 SQL Server 导入。

*   [http://www.download3000.com/download_17933.html](http://www.download3000.com/download_17933.html)

# version-control - TFS 中的跨分支合并？

> ID：52824
> 
> 赞同：20
> 
> 时间：2008-09-09T20:26:47.667
> 
> 标签：version-control, tfs, merge, branch

是否可以合并到 TFS 中不是直接父或子的分支？我怀疑答案是否定的，因为这是我在使用它时所经历的。但是，似乎在某些时候，当正在开发的不同功能可能具有不同的批准周期（即功能一**可能**在功能二之前获得批准）时，它会非常有用。当我们有生产分支时，这变得非常困难，我们必须将一些功能合并到以前的分支中，以便我们可以在下一个完整版本之前发布。

我们目前的分支策略是在主干（或我们称之为主线）中开发，并创建一个分支来稳定并发布到生产环境。然后，此分支可用于创建修补程序和其他内容，而主线可以针对即将推出的功能进行分歧。

可以使用哪些技术来缓解上述情况？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-09T21:06:57.570

我同意 Harpreet 的观点，您可能想重新审视您是如何设置分支结构的。但是，如果您真的想执行这种类型的合并，您可以通过一种称为无基础合并的方法。它从 tfs 命令提示符运行，

```
Tf merge /baseless <<source path>> <<target path>> /recursive 
```

可以在[此处找到有关无根据合并的其他信息](http://www.codeplex.com/VSTSGuidance/Wiki/View.aspx?title=How%20To%3A%20Perform%20a%20Baseless%20Merge%20in%20Team%20Foundation%20Server&referringTitle=View%20More)

[在构建我们的 tfs 分支结构Microsoft Team Foundation Server Branching Guidance](http://vsarbranchingguide.codeplex.com/)时，我还发现此文档非常有用

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-09T21:00:26.167

```
tf.exe merge /recursive /baseless $/TeamProject/SourceBranch $/TeamProject/TargetBranch 
```

*   MSDN：[如何：在 Visual Studio Team Foundation Server 中执行无基础合并](http://msdn.microsoft.com/en-us/library/bb668976.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T20:38:11.897

您可能需要重新审视您的分支策略。你如何获得生产分支？您是否正在合并来自开发分支、回归测试的所有代码，然后创建一个用于修复的生产分支？或者你是在主干上开发，然后创建生产分支来稳定和释放？第二种方法会产生您所描述类型的问题。如果您使用第一种方法 - 主干应该仅用于已构建在经过测试然后合并的分支上的东西，您将很少遇到这种情况。在这种方法下，如果您仍然遇到此问题，可能是因为您的开发工作量非常大，您可能需要一个相对复杂的分支策略，其中包含多个分支和提升层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T20:33:24.607

只要分支是从同一个原始文件夹创建的，AFAIK 就可以做到这一点。

*   树干/
*   分支/ -/feature1（从主干分支）-/feature2（从主干分支）

如果你这样做，那么你应该能够在 feature1 和 feature2 之间合并。

尽管我对 TFS 的分支/合并经验让我想要更多。我希望我们只有 SVN。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-09T21:00:32.780

是的，您可以进行无根据的合并，但只能从命令行 (tf.exe)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-09T21:05:50.647

TFS 将允许您与不是父/子的分支合并 - 这些称为无基础合并。请参阅以下链接：

[来自 MSDN](http://msdn.microsoft.com/en-us/library/bb668976.aspx)

[来自 TFS 团队，来自 CodePlex](http://www.codeplex.com/VSTSGuidance/Wiki/View.aspx?title=How%20To%3A%20Perform%20a%20Baseless%20Merge%20in%20Team%20Foundation%20Server&referringTitle=View%20More)

我们通常在开发分支上进行重大或不稳定的更改。如果接近我们产品之一的主要版本，几乎所有更改都将在分支上完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-31T15:07:14.187

我远不是 TFS 专家，但我认为你可以合并兄弟姐妹，而且我认为这不是毫无根据的合并。

我们从主分支（分支名称“main”）分支出一个功能（分支名称“feature”），然后我需要在一个分支中进行一些工作，该分支也从主分支分支出来（分支名称“dev”）。我认为 feature 和 dev 分支是兄弟姐妹，因为它们都来自同一个父级。我将功能合并到 dev 并且所有文件（14000）都被标记为合并，一些被标记为合并，编辑。我无法取消（visual studio 只会挂起），所以我接受了合并。然后我将 dev 合并到 main，然后我将 main 拉到 feature，再次标记了 14000 个文件进行合并。我真的很沮丧，害怕这种情况会继续下去。

此时我们做了一个测试项目。我们设置 main，然后从 main 分支 dev 和 feature。我们重复上述步骤，结果相同。一旦我们完成了从 main 到 feature 的合并，所有未来的合并只显示编辑过的文件。

在我们的小测试之后，我完成了从 main 到 feature 的合并。就像测试一样，我们的合并现在只显示编辑过的文件。我们可以将 dev 转到 feature，将 feature 转到 main，main 到 dev，等等。

我确实注意到分支所有文件日期都被修改了。也许这是一个问题？

# xss - 通知潜在客户有关安全漏洞的信息？

> ID：52830
> 
> 赞同：1
> 
> 时间：2008-09-09T20:29:15.133
> 
> 标签：xss, sql-injection

我们与潜在客户进行了很多公开讨论，他们经常询问我们的技术专长水平，包括我们当前项目的工作范围。为了衡量他们现在或以前使用过的员工的专业水平，我做的第一件事是检查 XSS 和 SQL 注入等安全漏洞。我还没有找到易受攻击的潜在客户，但我开始怀疑，他们是否真的认为这项调查有帮助，或者他们是否会认为，“嗯，如果我们不与他们做生意，这些人会破坏我们的网站。” 非技术人员很容易被这些东西吓到，所以我想知道这是一种善意的表现，还是一种糟糕的商业行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-09T20:36:32.823

我会说，突然对他们的软件进行渗透测试让人们感到惊讶，如果仅仅是因为他们没有提前知道这一事实，那么他们可能会打扰他们。我会说，如果您要这样做（我相信这是一件好事），请提前通知您的客户您将要这样做。如果他们似乎对此有点心烦意乱，请告诉他们在受控环境中从攻击者的角度检查人为错误的好处。毕竟，即使是最有安全感的人也会犯错误：Debian PRNG 漏洞就是一个很好的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T20:35:13.683

我认为这是一个相当主观的决定，如果你告诉他们，不同的潜在客户会有不同的反应。

我认为一个想法可能是在他们将业务交给其他人之后让他们知道。

至少这样，前潜在客户不会认为你是在试图向他们施压，让他们把生意交给你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T20:33:56.010

我认为这样做的问题是，如果不弄乱他们的网站，就很难对 XSS 进行检查。此外，诸如 SQL 注入之类的事情可能非常危险。如果你坚持附加选择，你可能不会有太多问题，但问题是，你怎么知道它甚至在执行注入的 SQL？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T13:41:48.703

从您描述的方式来看，这似乎是一种糟糕的商业实践，经过一些修改可能是有益的。

首先，您对客户进行的**任何漏洞评估或渗透测试都应得到该客户****的书面**同意。这合法地涵盖了您的行为。在没有书面协议的情况下，如果您在检查过程中无意造成损坏（应用程序崩溃、拒绝服务、数据泄露等），您将承担责任并可能被收费（根据美国法律；其他国家/地区有不同的标准）。

即使您没有造成损害，无知或潜在恶意的客户也可能将您告上法庭，要求赔偿；一个无知的法官可能只会判给他们。

如果您有这样做的书面授权，那么吸引潜在客户的免费漏洞评估听起来像是一种诚意的表现，并展示了您想要的东西——您的技能。

# .net - 排序 Directory.GetFiles()

> ID：52842
> 
> 赞同：65
> 
> 时间：2008-09-09T20:33:41.080
> 
> 标签：.net, .net-2.0

`System.IO.Directory.GetFiles()`返回一个`string[]`。返回值的默认排序顺序是什么？我是按名字假设的，但如果是这样的话，当前的文化对它有多大影响？您可以将其更改为创建日期之类的内容吗？

**更新：** MSDN 指出 .Net 3.5 不能保证排序顺序，但 2.0 版本的页面根本没有说明任何内容，而且这两个页面都不会帮助您按创建或修改时间等内容进行排序。一旦有了数组（它只包含字符串），该信息就会丢失。我可以构建一个比较器来检查它获取的每个文件，但这意味着当 .GetFiles() 方法可能已经这样做时重复访问文件系统。看起来效率很低。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-09-09T20:47:03.873

如果您对文件的属性（例如 CreationTime）感兴趣，那么使用 System.IO.DirectoryInfo.GetFileSystemInfos() 会更有意义。然后，您可以使用 System.Linq 中的一种扩展方法对它们进行排序，例如：

```
DirectoryInfo di = new DirectoryInfo("C:\\");
FileSystemInfo[] files = di.GetFileSystemInfos();
var orderedFiles = files.OrderBy(f => f.CreationTime); 
```

编辑 - 抱歉，我没有注意到 .NET2.0 标记所以忽略 LINQ 排序。使用 System.IO.DirectoryInfo.GetFileSystemInfos() 的建议仍然有效。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-10T20:57:43.973

在 .NET 2.0 中，您需要使用 Array.Sort 对 FileSystemInfos 进行排序。

此外，您可以使用 Comparer 委托来避免必须为比较声明一个类：

```
DirectoryInfo dir = new DirectoryInfo(path);
FileSystemInfo[] files = dir.GetFileSystemInfos();

// sort them by creation time
Array.Sort<FileSystemInfo>(files, delegate(FileSystemInfo a, FileSystemInfo b)
                                    {
                                        return a.LastWriteTime.CompareTo(b.LastWriteTime);
                                    }); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-29T15:12:40.323

这是我使用的 VB.Net 解决方案。

首先创建一个类来比较日期：

```
Private Class DateComparer
    Implements System.Collections.IComparer

    Public Function Compare(ByVal info1 As Object, ByVal info2 As Object) As Integer Implements System.Collections.IComparer.Compare
        Dim FileInfo1 As System.IO.FileInfo = DirectCast(info1, System.IO.FileInfo)
        Dim FileInfo2 As System.IO.FileInfo = DirectCast(info2, System.IO.FileInfo)

        Dim Date1 As DateTime = FileInfo1.CreationTime
        Dim Date2 As DateTime = FileInfo2.CreationTime

        If Date1 > Date2 Then Return 1
        If Date1 < Date2 Then Return -1
        Return 0
    End Function
End Class 
```

然后在对数组进行排序时使用比较器：

```
Dim DirectoryInfo As New System.IO.DirectoryInfo("C:\")
Dim Files() As System.IO.FileInfo = DirectoryInfo.GetFiles()
Dim comparer As IComparer = New DateComparer()
Array.Sort(Files, comparer) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-09T20:35:16.710

```
Dim Files() As String
Files = System.IO.Directory.GetFiles("C:\")
Array.Sort(Files) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-09T20:36:38.313

来自[msdn](http://msdn.microsoft.com/en-us/library/wz42302f.aspx)：

> 返回文件名的顺序不保证；如果需要特定的排序顺序，请使用 Sort() 方法。

[Sort()](http://msdn.microsoft.com/en-us/library/system.array.sort.aspx)方法是标准的Array.Sort()，它接受 IComparables（以及其他重载），因此如果您按创建日期排序，它将根据机器设置处理本地化。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-09T20:38:22.037

你是对的，默认是我的名字 asc。我发现更改排序顺序以从 FileInfo 集合创建数据表的唯一方法。

然后，您可以使用数据表中的 DefaultView 并使用 .Sort 方法对目录进行排序。

这是相当复杂而且相当缓慢，但我希望有人会发布一个更好的解决方案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-09T20:45:30.133

您可以实现自定义 iComparer 进行排序。阅读文件的文件信息并根据需要进行比较。

```
IComparer comparer = new YourCustomComparer();
Array.Sort(System.IO.Directory.GetFiles(), comparer); 
```

[msdn info IComparer 接口](http://msdn.microsoft.com/en-us/library/system.collections.icomparer(VS.80).aspx)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-12-12T16:14:52.047

一个更简洁的 VB.Net 版本……非常好。谢谢你。要以相反的顺序遍历列表，请添加 reverse 方法...

```
For Each fi As IO.FileInfo In filePaths.reverse
  ' Do whatever you wish here
Next 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-09T20:37:56.577

[MSDN 文档](http://msdn.microsoft.com/en-us/library/wz42302f.aspx)声明不保证返回值的任何顺序。您必须使用 Sort() 方法。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-09T20:41:17.990

您可以编写一个自定义 IComparer 接口以按创建日期排序，然后将其传递给 Array.Sort。您可能还想查看 StrCmpLogical，它用于进行 Explorer 使用的排序（使用文本正确排序数字）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-09T20:42:13.150

如果您想按创建日期之类的内容进行排序，您可能需要使用 DirectoryInfo.GetFiles，然后使用合适的谓词对结果数组进行排序。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-31T17:34:17.157

只是一个想法。我喜欢找到一个简单的出路，并尝试重新使用已经可用的资源。如果我要对文件进行排序，我将只创建一个进程并将 syscal 设置为“DIR [x:\Folders\SubFolders*.*] /s /b /on”并捕获输出。

使用系统的 DIR 命令，您可以按以下方式排序：

```
/O          List by files in sorted order.
sortorder    N  By name (alphabetic)       S  By size (smallest first)
             E  By extension (alphabetic)  D  By date/time (oldest first)
             G  Group directories first    -  Prefix to reverse order

The /S switch includes sub folders 
```

我不确定 D = By Date/Time 是否使用 LastModifiedDate 或 FileCreateDate。但是如果所需的排序顺序已经内置在 DIR 命令中，我将通过调用 syscall 来获得它。而且速度很快。我只是个懒惰的人；）

*经过一番谷歌搜索后，我发现 switch 按特定日期/时间排序：-*

```
/t [[:]TimeField] : Specifies which time field to display or use for sorting. The following list describes each of the values you can use for TimeField. 

Value Description 
c : Creation
a : Last access
w : Last written 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-21T10:04:08.217

一个更简洁的 VB.Net 版本，如果有人感兴趣的话

```
Dim filePaths As Linq.IOrderedEnumerable(Of IO.FileInfo) = _
  New DirectoryInfo("c:\temp").GetFiles() _
   .OrderBy(Function(f As FileInfo) f.CreationTime)
For Each fi As IO.FileInfo In filePaths
  ' Do whatever you wish here
Next 
```

# wxpython - 在 wxGenericDirCtrl 中隐藏目录

> ID：52844
> 
> 赞同：1
> 
> 时间：2008-09-09T20:34:02.627
> 
> 标签：wxpython, wxwidgets

我正在使用 wxGenericDirCtrl，我想知道是否有隐藏目录的方法，我特别想隐藏父节点的兄弟姐妹。

例如，如果我的目录结构如下所示：

```
+-a
  |
  +-b
  | |
  | +-whatever
  |
  +-c
  | |
  | +-d
  |   |
  |   +-e
  |   |
  |   +-f
  |   
  +-g
    |
    +-whatever 
```

如果我当前选择的目录是 /a/c/d 有没有办法隐藏 b 和 g，以便树在我的 ctrl 中看起来像这样：

```
+-a
  |
  +-c
    |
    +-[d]
      |
      +-e
      |
      +-f 
```

我目前正在使用一个目录结构，其中包含许多与大多数用户无关的目录，因此能够清理它会很好。

**编辑**：如果有什么不同，我正在使用 wxPython，到目前为止，我只使用 GTK 后端在 linux 上测试了我的代码，但我确实计划使它成为多平台并在 Windows 和 Mac 上使用本机后端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T16:08:01.200

在 Python 中列出/遍历目录非常简单，因此我建议尝试使用一种简单的树控件（例如 TreeCtrl 或 CustomTreeCtrl）“滚动你自己的”。当某个目录展开并返回结果时，调用目录列表代码应该非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-13T18:11:19.737

我不认为这是可能的。

将此功能添加到底层 C++ wxWidgets 控件相对容易，但由于您使用的是 wxPython，因此您还必须重新构建它，这是一个巨大的问题。

# debugging - 启动 windbg 用户模式远程调试会话的最佳技术

> ID：52855
> 
> 赞同：6
> 
> 时间：2008-09-09T20:39:04.250
> 
> 标签：debugging, windbg, remote-debugging

您最喜欢启动 windbg 用户模式远程调试会话的技术是什么？为什么你更喜欢这种技术而不是其他技术？（优点缺点）

至少有四种不同的方法可以使用 windbg 进行用户模式远程调试，如 windows 帮助文件的调试工具的“远程调试”部分所述。

1.  在目标上运行应用程序，然后从主机 windbg 附加到它
2.  让主机 windbg 使用 remote.exe 在目标上启动应用程序
3.  让“智能客户端”主机 windbg 通过在目标上运行的进程服务器在目标上启动应用程序
4.  使用选项“-server”在目标机器上运行windbg实例以自动启动服务器，然后从第二台机器连接到服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T20:49:19.343

选项 1 是我最喜欢的，因为它是最简单的。我可以以正常方式启动应用程序，而不必担心让 WinDbg 设置正确的工作目录、传递任何命令行参数等。

幸运的是，我没有遇到任何这不起作用的情况！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T23:02:28.370

我倾向于使用选项 4（-server），因为当您闯入内核调试器足够长的时间以使 TCP 连接超时时，它是唯一不会“弹出”的选项。但这更复杂，并不完全令人满意。所以我正在寻找“最佳实践”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-24T22:47:20.767

没有“最好的”解决方案。每种可能性都有优点和缺点，最好了解所有这些。这取决于几个因素，例如：

*   符号在哪里
*   哪台 PC 可以访问 Internet 以下载操作系统符号
*   您可以将多少数据复制到服务器（如果只是单个 Exe，客户端通常会更好地接受）
*   客户端和服务器之间的带宽是多少
*   您是否需要仅 CDB/WinDbg 的其他命令，例如访问 CMD，然后考虑 remote.exe
*   在服务器端可用的人，可以轻松说出许多神秘命令的调试专家或几乎不知道如何启动命令提示符的普通用户
*   双方都在专用网络中，因此您需要一个“中间人”服务器才能相互访问（或端口转发作为替代方案，这是 IT 人员不想要的，可能需要几天时间才能完成设置向上）

从这 4 个选项中，不要忘记客户通常希望确切地看到您所做的事情，因此他们需要 RDP 会话、Teamviewer 或类似工具。这是他们理解的。

# javascript - CSS溢出表行定位

> ID：52873
> 
> 赞同：8
> 
> 时间：2008-09-09T20:50:03.680
> 
> 标签：javascript, html, css, css-tables

我在 div 选项卡中有表格。该表有 40 行，并且 div 的高度设置为显示该表的 10 行。CSS 的溢出：自动让我滚动浏览 40 行。一切都很好。

我如何使用 JavaScript 使表格以编程方式定位到给定行（即以编程方式逐行向上或向下滚动表格）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-09T20:59:54.437

哪里`superHappyFunDiv`是容器 DIV 的 ID，而 rows 是从 0 开始的行索引：

```
function scrollTo(row)
{
   var container = document.getElementById("superHappyFunDiv");
   var rows = container.getElementsByTagName("tr");

   row = Math.min(Math.max(row, 0), rows.length-1);
   container.scrollTop = rows[row].offsetTop;
} 
```

将尝试将请求的行滚动到容器的顶部。在 IE6 和 FF3 中测试。

# java - 如何让机器保持清醒？

> ID：52874
> 
> 赞同：32
> 
> 时间：2008-09-09T20:50:12.430
> 
> 标签：java, windows, macos, cross-platform, operating-system

我有一个用 Java 编写的服务器式软件，可以在 Windows 和 OS X 上运行。（它不是在服务器上运行，而只是在普通用户的 PC 上运行 - 类似于 torrent 客户端。）我希望软件发出信号到操作系统以在机器处于活动状态时保持机器唤醒（防止其进入睡眠模式）。

当然，我不希望有一个跨平台的解决方案，但我希望我的应用程序可以生成一些非常小的 C 程序/脚本，以通知操作系统保持清醒。

有任何想法吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-09T21:31:14.920

我使用此代码来防止我的工作站被锁定。它目前只设置为每分钟移动一次鼠标，但您可以轻松调整它。

这是一个 hack，而不是一个优雅的解决方案。

```
import java.awt.*;
import java.util.*;
public class Hal{

    public static void main(String[] args) throws Exception{
        Robot hal = new Robot();
        Random random = new Random();
        while(true){
            hal.delay(1000 * 60);
            int x = random.nextInt() % 640;
            int y = random.nextInt() % 480;
            hal.mouseMove(x,y);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-09T21:05:24.813

在 Windows 上，使用[SystemParametersInfo](http://msdn.microsoft.com/en-us/library/ms724947.aspx)函数。这是一种瑞士军队风格的功能，可让您获取/设置各种系统设置。

要禁用屏幕关闭，例如：

```
SystemParametersInfo( SPI_SETPOWEROFFACTIVE, 0, NULL, 0 ); 
```

完成后请务必将其重新设置...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-23T11:59:37.700

添加到上述 Scarcher2 的代码片段中，并且仅将鼠标移动 1 个像素。我已经移动了两次鼠标，即使指针处于极端状态也会发生一些变化：

```
while(true){
            hal.delay(1000 * 30);       
            Point pObj = MouseInfo.getPointerInfo().getLocation();
            System.out.println(pObj.toString() + "x>>" + pObj.x + "  y>>" + pObj.y);
            hal.mouseMove(pObj.x + 1, pObj.y + 1);  
            hal.mouseMove(pObj.x - 1, pObj.y - 1);
            pObj = MouseInfo.getPointerInfo().getLocation();
            System.out.println(pObj.toString() + "x>>" + pObj.x + "  y>>" + pObj.y);
        } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-09T20:56:17.547

我有一种非常强力的技术，可以将鼠标沿 x 方向移动 1 点，然后每 3 分钟返回一次。

我可能有一个更优雅的解决方案，但它是一个快速修复。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-09T23:49:08.897

所有来回移动鼠标的建议不会让用户发疯吗？我知道一旦我可以隔离它，我会删除任何会这样做的应用程序。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-01-25T18:21:58.360

一个更简洁的解决方案是使用 JNA 来利用本机 OS API。在运行时检查您的平台，如果它恰好是 Windows，那么以下将起作用：

```
import com.sun.jna.Native;
import com.sun.jna.Structure;
import com.sun.jna.Structure.FieldOrder;
import com.sun.jna.platform.win32.WTypes.LPWSTR;
import com.sun.jna.platform.win32.WinBase;
import com.sun.jna.platform.win32.WinDef.DWORD;
import com.sun.jna.platform.win32.WinDef.ULONG;
import com.sun.jna.platform.win32.WinNT.HANDLE;
import com.sun.jna.win32.StdCallLibrary;

/**
 * Power management.
 *
 * @see <a href="https://stackoverflow.com/a/20996135/14731">https://stackoverflow.com/a/20996135/14731</a>
 */
public enum PowerManagement
{
    INSTANCE;

    @FieldOrder({"version", "flags", "simpleReasonString"})
    public static class REASON_CONTEXT extends Structure
    {
        public static class ByReference extends REASON_CONTEXT implements Structure.ByReference
        {
        }

        public ULONG version;
        public DWORD flags;
        public LPWSTR simpleReasonString;
    }

    private interface Kernel32 extends StdCallLibrary
    {
        HANDLE PowerCreateRequest(REASON_CONTEXT.ByReference context);

        /**
         * @param powerRequestHandle the handle returned by {@link #PowerCreateRequest(REASON_CONTEXT.ByReference)}
         * @param requestType        requestType is the ordinal value of {@link PowerRequestType}
         * @return true on success
         */
        boolean PowerSetRequest(HANDLE powerRequestHandle, int requestType);

        /**
         * @param powerRequestHandle the handle returned by {@link #PowerCreateRequest(REASON_CONTEXT.ByReference)}
         * @param requestType        requestType is the ordinal value of {@link PowerRequestType}
         * @return true on success
         */
        boolean PowerClearRequest(HANDLE powerRequestHandle, int requestType);

        enum PowerRequestType
        {
            PowerRequestDisplayRequired,
            PowerRequestSystemRequired,
            PowerRequestAwayModeRequired,
            PowerRequestMaximum
        }
    }

    private final Kernel32 kernel32;
    private HANDLE handle = null;

    PowerManagement()
    {
        // Found in winnt.h
        ULONG POWER_REQUEST_CONTEXT_VERSION = new ULONG(0);
        DWORD POWER_REQUEST_CONTEXT_SIMPLE_STRING = new DWORD(0x1);

        kernel32 = Native.load("kernel32", Kernel32.class);
        REASON_CONTEXT.ByReference context = new REASON_CONTEXT.ByReference();
        context.version = POWER_REQUEST_CONTEXT_VERSION;
        context.flags = POWER_REQUEST_CONTEXT_SIMPLE_STRING;
        context.simpleReasonString = new LPWSTR("Your reason for changing the power setting");
        handle = kernel32.PowerCreateRequest(context);
        if (handle == WinBase.INVALID_HANDLE_VALUE)
            throw new AssertionError(Native.getLastError());
    }

    /**
     * Prevent the computer from going to sleep while the application is running.
     */
    public void preventSleep()
    {
        if (!kernel32.PowerSetRequest(handle, Kernel32.PowerRequestType.PowerRequestSystemRequired.ordinal()))
            throw new AssertionError("PowerSetRequest() failed");
    }

    /**
     * Allow the computer to go to sleep.
     */
    public void allowSleep()
    {
        if (!kernel32.PowerClearRequest(handle, Kernel32.PowerRequestType.PowerRequestSystemRequired.ordinal()))
            throw new AssertionError("PowerClearRequest() failed");
    }
} 
```

然后当用户运行时，`powercfg /requests`他们会看到：

```
SYSTEM:
[PROCESS] \Device\HarddiskVolume1\Users\Gili\.jdks\openjdk-15.0.2\bin\java.exe
Your reason for changing the power setting 
```

你应该能够为 macOS 和 Linux 做类似的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-02-14T06:23:12.763

这里是完成生成java代码的批处理文件，编译它，清理生成的文件，并在后台运行..（你的笔记本电脑上需要jdk）

**只需将其保存并作为 Bat 文件运行即可。(somefilename.bat) ;)**

```
@echo off
setlocal

rem rem if JAVA is set and run from :startapp labeled section below, else the program exit through :end labeled section.
if not "[%JAVA_HOME%]"=="[]" goto start_app
echo. JAVA_HOME not set. Application will not run!
goto end

:start_app
echo. Using java in %JAVA_HOME%
rem writes below code to Energy.java file.
@echo import java.awt.MouseInfo; > Energy.java
@echo import java.awt.Point; >> Energy.java
@echo import java.awt.Robot; >> Energy.java
@echo //Mouse Movement Simulation >> Energy.java
@echo public class Energy { >> Energy.java
@echo     public static void main(String[] args) throws Exception { >> Energy.java
@echo         Robot energy = new Robot(); >> Energy.java
@echo         while (true) { >> Energy.java
@echo             energy.delay(1000 * 60); >> Energy.java
@echo             Point pObj = MouseInfo.getPointerInfo().getLocation(); >> Energy.java
@echo             Point pObj2 = pObj;  >> Energy.java
@echo             System.out.println(pObj.toString() + "x>>" + pObj.x + "  y>>" + pObj.y); >> Energy.java
@echo             energy.mouseMove(pObj.x + 10, pObj.y + 10); >> Energy.java
@echo             energy.mouseMove(pObj.x - 10, pObj.y - 10); >> Energy.java
@echo             energy.mouseMove(pObj2.x, pObj.y); >> Energy.java
@echo             pObj = MouseInfo.getPointerInfo().getLocation(); >> Energy.java
@echo             System.out.println(pObj.toString() + "x>>" + pObj.x + "  y>>" + pObj.y); >> Energy.java
@echo         } >> Energy.java
@echo     } >> Energy.java
@echo } >> Energy.java

rem compile java code.
javac Energy.java
rem run java application in background.
start javaw Energy
echo. Your Secret Energy program is running...
goto end

:end
rem clean if files are created.
pause
del "Energy.class"
del "Energy.java" 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-10T01:21:27.927

一段时间以来，我一直在使用[pmset](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/pmset.1.html)来控制 Mac 上的睡眠模式，而且它很容易集成。这是一个粗略的示例，说明如何从 Java 调用该程序以禁用/启用睡眠模式。请注意，您需要 root 权限才能运行 pmset，因此您需要它们来运行此程序。

```
import java.io.BufferedInputStream;
import java.io.IOException;

/**
 * Disable sleep mode (record current setting beforehand), and re-enable sleep
 * mode. Works with Mac OS X using the "pmset" command.
 */
public class SleepSwitch {

    private int sleepTime = -1;

    public void disableSleep() throws IOException {
        if (sleepTime != -1) {
            // sleep time is already recorded, assume sleep is disabled
            return;
        }

        // query pmset for the current setting
        Process proc = Runtime.getRuntime().exec("pmset -g");
        BufferedInputStream is = new BufferedInputStream(proc.getInputStream());
        StringBuffer output = new StringBuffer();
        int c;
        while ((c = is.read()) != -1) {
            output.append((char) c);
        }
        is.close();

        // parse the current setting and store the sleep time
        String outString = output.toString();
        String setting = outString.substring(outString.indexOf(" sleep\t")).trim();
        setting = setting.substring(7, setting.indexOf(" ")).trim();
        sleepTime = Integer.parseInt(setting);

        // set the sleep time to zero (disable sleep)
        Runtime.getRuntime().exec("pmset sleep 0");
    }

    public void enableSleep() throws IOException {
        if (sleepTime == -1) {
            // sleep time is not recorded, assume sleep is enabled
            return;
        }

        // set the sleep time to the previously stored value
        Runtime.getRuntime().exec("pmset sleep " + sleepTime);

        // reset the stored sleep time
        sleepTime = -1;
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T15:32:14.180

您可以使用程序 Caffeine [caffiene](http://lightheadsw.com/caffeine/)让您的工作站保持清醒。您可以通过 os X 中的 open 命令运行该程序。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-05-18T21:46:16.960

在 OS X 上，只需 spawn `caffeinate`。这将防止系统休眠，直到`caffeinate`终止。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-02T19:01:14.170

在 Visual Studio 中创建一个简单的表单。从工具栏中，将 Timer 控件拖到窗体上。在初始化代码中，将计时器间隔设置为 60 秒（60000 毫秒）。使用以下代码实现计时器回调“SendKeys.Send("{F15}");” 运行新程序。

无需鼠标移动。

编辑：至少在我的陆军工作站上，简单地以编程方式生成鼠标和按键消息不足以让我的工作站保持登录和唤醒。Java Robot 类的早期海报正走在正确的轨道上。JAVA Robot 在操作系统的 HAL（硬件抽象层）之上或之下工作，但是我重新创建并测试了 Java/Robot 解决方案，但它没有工作——直到我在代码中添加了 Robot.keyPress(123)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-09T20:55:21.030

禁用服务器上的电源管理不是更容易吗？可能有人认为服务器不应该进入省电模式？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-10-13T19:00:41.207

此代码将指针移动到它已经存在的相同位置，因此用户不会注意到任何差异。

```
while (true) {
    Thread.sleep(180000);//this is how long before it moves
    Point mouseLoc = MouseInfo.getPointerInfo().getLocation();
    Robot rob = new Robot();
    rob.mouseMove(mouseLoc.x, mouseLoc.y);
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-05-07T22:11:40.833

要使用用户 Gili 为 Windows 提供的使用 JNA 的解决方案，这里是适用于 MacOS 的 JNA 解决方案。

一、JNA库接口：

```
import com.sun.jna.Library;
import com.sun.jna.Native;
import com.sun.jna.platform.mac.CoreFoundation;
import com.sun.jna.ptr.IntByReference;

public interface ExampleIOKit extends Library {
    ExampleIOKit INSTANCE = Native.load("IOKit", ExampleIOKit.class);

    CoreFoundation.CFStringRef kIOPMAssertPreventUserIdleSystemSleep = CoreFoundation.CFStringRef.createCFString("PreventUserIdleSystemSleep");
    CoreFoundation.CFStringRef kIOPMAssertPreventUserIdleDisplaySleep = CoreFoundation.CFStringRef.createCFString("PreventUserIdleDisplaySleep");

    int kIOReturnSuccess = 0;

    int kIOPMAssertionLevelOff = 0;
    int kIOPMAssertionLevelOn = 255;

    int IOPMAssertionCreateWithName(CoreFoundation.CFStringRef assertionType,
                                    int assertionLevel,
                                    CoreFoundation.CFStringRef reasonForActivity,
                                    IntByReference assertionId);

    int IOPMAssertionRelease(int assertionId);
} 
```

下面是调用 JNA 方法来打开或关闭睡眠预防的示例：

```
public class Example {
    private static final Logger _log = LoggerFactory.getLogger(Example.class);

    private int sleepPreventionAssertionId = 0;

    public void updateSleepPrevention(final boolean isEnabled) {
        if (isEnabled) {
            if (sleepPreventionAssertionId == 0) {
                final var assertionIdRef = new IntByReference(0);
                final var reason = CoreFoundation.CFStringRef.createCFString(
                    "Example preventing display sleep");
                final int result = ExampleIOKit.INSTANCE.IOPMAssertionCreateWithName(
                    ExampleIOKit.kIOPMAssertPreventUserIdleDisplaySleep,
                    ExampleIOKit.kIOPMAssertionLevelOn, reason, assertionIdRef);
                if (result == ExampleIOKit.kIOReturnSuccess) {
                    _log.info("Display sleep prevention enabled");
                    sleepPreventionAssertionId = assertionIdRef.getValue();
                }
                else {
                    _log.error("IOPMAssertionCreateWithName returned {}", result);
                }
            }
        }
        else {
            if (sleepPreventionAssertionId != 0) {
                final int result = ExampleIOKit.INSTANCE.IOPMAssertionRelease(sleepPreventionAssertionId);
                if (result == ExampleIOKit.kIOReturnSuccess) {
                    _log.info("Display sleep prevention disabled");
                }
                else {
                    _log.error("IOPMAssertionRelease returned {}", result);
                }
                sleepPreventionAssertionId = 0;
            }
        }
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-09T20:54:07.460

在计时器内运行命令，例如 ping 服务器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-09T21:08:41.277

我只是做一个移动鼠标的功能（或下载免费赠品应用程序）。不优雅，但很容易。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-06-13T09:21:08.053

**这将起作用：**

```
public class Utils {
    public static void main(String[] args) throws AWTException {
        Robot rob = new Robot();
        PointerInfo ptr = null;
        while (true) {
            rob.delay(4000);  // Mouse moves every 4 seconds
            ptr = MouseInfo.getPointerInfo();
            rob.mouseMove((int) ptr.getLocation().getX() + 1, (int) ptr.getLocation().getY() + 1);
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2019-05-15T10:15:43.257

我用来避免“Windows 桌面自动锁定”的一种简单方法是每 6 秒“打开/关闭 NumLock”。

这是一个打开/关闭 NumLock 的 Java 程序。

```
import java.util.*;
import java.awt.*;
import java.awt.event.*;

public class NumLock extends Thread {
  public void run() {
    try {
    boolean flag = true;
    do {
        flag = !flag;

        Thread.sleep(6000);
        Toolkit.getDefaultToolkit().setLockingKeyState(KeyEvent. VK_NUM_LOCK, flag);
    }
    while(true);
    }
    catch(Exception e) {}
  }

  public static void main(String[] args) throws Exception {
    new NumLock().start();
  }
} 
```

在单独的命令提示符下运行这个 Java 程序；:-)

# api - 谷歌阅读器 API 未读计数

> ID：52880
> 
> 赞同：26
> 
> 时间：2008-09-09T20:53:57.337
> 
> 标签：api, google-reader

谷歌阅读器是否有 API，如果有，我如何获取知道其用户名和密码的特定用户的未读帖子数？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-24T15:06:23.323

此 URL 将为您提供每个提要的未读帖子计数。然后，您可以遍历提要并汇总计数。

[http://www.google.com/reader/api/0/unread-count?all=true](http://www.google.com/reader/api/0/unread-count?all=true)

这是 Python 中的一个极简示例……解析 xml/json 并对计数求和作为练习留给读者：

```
import urllib
import urllib2

username = 'username@gmail.com'
password = '******'

# Authenticate to obtain SID
auth_url = 'https://www.google.com/accounts/ClientLogin'
auth_req_data = urllib.urlencode({'Email': username,
                                  'Passwd': password,
                                  'service': 'reader'})
auth_req = urllib2.Request(auth_url, data=auth_req_data)
auth_resp = urllib2.urlopen(auth_req)
auth_resp_content = auth_resp.read()
auth_resp_dict = dict(x.split('=') for x in auth_resp_content.split('\n') if x)
auth_token = auth_resp_dict["Auth"]

# Create a cookie in the header using the SID 
header = {}
header['Authorization'] = 'GoogleLogin auth=%s' % auth_token

reader_base_url = 'http://www.google.com/reader/api/0/unread-count?%s'
reader_req_data = urllib.urlencode({'all': 'true',
                                    'output': 'xml'})
reader_url = reader_base_url % (reader_req_data)
reader_req = urllib2.Request(reader_url, None, header)
reader_resp = urllib2.urlopen(reader_req)
reader_resp_content = reader_resp.read()

print reader_resp_content 
```

以及有关该主题的一些其他链接：

*   [http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI](http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI)
*   [如何从（非网络）python 客户端访问经过身份验证的 Google App Engine 服务？](https://stackoverflow.com/questions/101742/how-do-you-access-an-authenticated-google-app-engine-service-from-a-non-web-pyt)
*   [http://blog.gpowered.net/2007/08/google-reader-api-functions.html](http://blog.gpowered.net/2007/08/google-reader-api-functions.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-09T20:55:41.247

它在[那里](http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI)。虽然仍处于测试阶段。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-08-18T23:40:35.620

这是[此答案的更新](https://stackoverflow.com/questions/52880/google-reader-api-unread-count/582108#582108)

```
import urllib
import urllib2

username = 'username@gmail.com'
password = '******'

# Authenticate to obtain Auth
auth_url = 'https://www.google.com/accounts/ClientLogin'
#auth_req_data = urllib.urlencode({'Email': username,
#                                  'Passwd': password})
auth_req_data = urllib.urlencode({'Email': username,
                                  'Passwd': password,
                                  'service': 'reader'})
auth_req = urllib2.Request(auth_url, data=auth_req_data)
auth_resp = urllib2.urlopen(auth_req)
auth_resp_content = auth_resp.read()
auth_resp_dict = dict(x.split('=') for x in auth_resp_content.split('\n') if x)
# SID = auth_resp_dict["SID"]
AUTH = auth_resp_dict["Auth"]

# Create a cookie in the header using the Auth
header = {}
#header['Cookie'] = 'Name=SID;SID=%s;Domain=.google.com;Path=/;Expires=160000000000' % SID
header['Authorization'] = 'GoogleLogin auth=%s' % AUTH

reader_base_url = 'http://www.google.com/reader/api/0/unread-count?%s'
reader_req_data = urllib.urlencode({'all': 'true',
                                    'output': 'xml'})
reader_url = reader_base_url % (reader_req_data)
reader_req = urllib2.Request(reader_url, None, header)
reader_resp = urllib2.urlopen(reader_req)
reader_resp_content = reader_resp.read()

print reader_resp_content 
```

谷歌阅读器在 2010 年 6 月左右删除了 SID 身份验证（我认为），使用来自 ClientLogin 的新身份验证是新方法，并且更简单（标题更短）。您必须添加`service`请求的数据，如果您不发送`Auth`，我注意到没有返回。`Auth``service=reader`

[您可以在此线程](http://groups.google.com/group/fougrapi/browse_thread/thread/e331f37f7f126c00/)中阅读有关身份验证方法更改的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-07T17:51:10.180

在 [1] 中发布的 API 中，“token”字段应为“T”

[1] [http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI](http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI)

# graph-theory - 图搜索算法

> ID：52883
> 
> 赞同：7
> 
> 时间：2008-09-09T20:54:55.617
> 
> 标签：graph-theory, graph-algorithm

我正在寻找具有一些不寻常属性的图形算法。

图中的每条边要么是“上”边，要么是“下”边。

一条有效的路径可以经过不定数量的“up”，然后是不定数量的“down”，反之亦然。但是，它不能多次改变方向。

例如，有效路径可能是 A “up” B “up” C “down” E “down” F 无效路径可能是 A “up” B “down” C “up” D

什么是找到两个节点之间最短有效路径的好算法？如何找到所有等长的最短路径？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-09T21:14:27.100

假设您没有任何启发式方法，[dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra's_algorithm)的变体应该就足够了。每次考虑新边缘时，存储有关其“祖先”的信息。然后，检查不变量（只有一个方向改变），如果违反则回溯。

这里的祖先是沿着最短路径遍历到当前节点的所有边。存储祖先信息的一个好方法是作为一对数字。如果 U 向上，D 向下，则特定边的祖先可能是`UUUDDDD`，这将是对`3, 4`。由于不变量，您不需要第三个数字。

由于我们使用了 dijkstra 算法，因此已经可以找到多个最短路径。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-09T21:15:55.630

也许您可以将您的图转换为正常的有向图，然后使用现有算法。

一种方法是将图拆分为两个图，一个具有所有上边，一个具有所有下边，并且在图 1 上的所有节点与图 2 上的相应节点之间具有有向边。

首先求解从图一开始到图二结束，然后反过来，然后检查最短的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T21:16:26.720

有人会认为您的标准[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)应该在这里工作。每当您将节点添加到打开列表时，您都可以将其包装到一个结构中，该结构包含它正在使用的方向（向上或向下）和一个布尔标志，指示它是否已经切换了方向。这些可用于确定来自该节点的哪些出边是有效的。

要找到所有相等长度的最短路径，请在结构中包含到目前为止遍历的边数。当您找到第一条最短路径时，记下路径长度并停止将节点添加到打开列表中。继续遍历列表中的剩余节点，直到检查完当前长度的所有路径，然后停止。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T21:22:44.753

具有特制成本（G 分数）和启发式（H 分数）功能的[A*可以处理它。](http://en.wikipedia.org/wiki/A*_search_algorithm)

对于成本，您可以跟踪路径中方向变化的数量，并在第二次变化时添加无限成本（即切断对这些分支的搜索）。

启发式需要更多考虑，尤其是当您想要保持启发式可接受（永远不要高估到目标的最小距离）和单调时。（保证 A* 找到最优解的唯一方法。）

也许有更多关于可用于创建启发式的域的信息？（即图中节点的 x,y 坐标？）

当然，根据您要解决的图形的大小，您可以首先尝试更简单的算法，例如广度优先搜索或 Dijkstra 算法：基本上每个搜索算法都可以，并且对于每个搜索算法，您都需要一个成本函数（或类似的）反正。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-12T09:32:59.187

如果你有一个标准的图形搜索功能，比如`Graph.shortest(from, to)`在一个库中，你可以循环和最小化，在 C#/pseudocode 中：

```
[ (fst.shortest(A, C) + nxt.shortest(C, B)) 
    for C in nodes , (fst, nxt) in [(up, down), (down, up)] ].reduce(min) 
```

如果您需要记住最小路径/路径并且碰巧您的标准函数返回数据，您也可以发音

```
[ [fst, nxt, C, fst.shortest(A, C), nxt.shortest(C,B)]
    for C in nodes , (fst, nxt) in [(up, down), (down, up)] ].reduce(myMin) 
```

where`myMin`应该比较两个`[fst, nxt, C, AC, BD]`元组并留下距离较短的元组，或者两者兼而有之，并假设`reduce`是一个智能函数。

如果我们的图很大并且根本不使用内存（如果它们是动态生成的，这可能会产生一些内存开销），但实际上没有任何速度开销，恕我直言。

# sql-server - sql语句中方括号[]有什么用？

> ID：52898
> 
> 赞同：197
> 
> 时间：2008-09-09T21:02:24.337
> 
> 标签：sql-server, syntax

我注意到 Visual Studio 2008 将方括号放在 sql 中的列名周围。括号有什么好处吗？当我手动编写 T-SQL 代码时，我从不理会它们。

例子：

视觉工作室：

```
SELECT [column1], [column2] etc... 
```

我自己的方式：

```
SELECT column1, column2 etc... 
```

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-09-09T21:03:57.483

如果在列名或标识符中使用关键字或特殊字符，则需要括号。您可以命名一列`[First Name]`（带空格）——但每次引用该列时都需要使用方括号。

为了以防万一或保持一致性，较新的工具将它们添加到任何地方。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-09T21:07:23.763

如果您的列与 SQL 关键字具有相同的名称，或者其中有空格，它们会很方便。

例子：

```
create table test ( id int, user varchar(20) ) 
```

不好了！关键字“用户”附近的语法不正确。但是这个：

```
create table test ( id int, [user] varchar(20) ) 
```

工作正常。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-09T21:08:10.093

例如，如果您（出于某种原因）使用带有某些字符的列名，它们会很有用。

```
Select First Name From People 
```

不起作用，但是在列名周围加上方括号会起作用

```
Select [First Name] From People 
```

简而言之，它是一种显式声明对象名称的方式；列、表、数据库、用户或服务器。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-11-07T05:34:03.873

无论遵循避免使用保留字的命名约定，Microsoft 都会添加新的保留字。使用方括号可以将您的代码升级到新的 SQL Server 版本，而无需首先从您的客户端代码中编辑 Microsoft 的新保留字。这种编辑可能是一个重大问题。这可能会导致您的项目过早退役......

当您想在脚本中全部替换时，括号也很有用。如果您的批处理包含一个名为@String 的变量和一个名为[String] 的列，您可以将该列重命名为[NewString]，而无需将@String 重命名为@NewString。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-09T21:04:36.233

列名可能包含会混淆查询执行引擎的字符和保留字，因此始终在它们周围放置方括号可以防止这种情况发生。我想比检查问题然后处理它更容易。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-06-05T13:17:08.793

在 1990 年代 SQL 的黑暗时代，这是一个很好的实践，因为 SQL 设计者试图将字典中的每个单词作为关键字添加到无休止的新功能雪崩中，他们称之为 SQL3 草案。

所以它保持前向兼容性。

而且我发现它还有另一个很好的副作用，当您在代码审查和重构中使用 grep 时，它会很有帮助。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-09T21:03:43.333

当列名是保留字时，可以使用方括号。

如果您是从您无法控制的列名集合中以编程方式生成 SQL 语句，那么您可以通过始终使用方括号来避免问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-22T20:50:34.197

此外，一些 Sharepoint 数据库的名称中包含连字符。在 SQL 语句中使用方括号可以正确解析名称。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-09T21:05:11.443

我相信它会在此处添加它们以保持一致性......仅当您在列名中有空格或特殊字符时才需要它们，但在 IDE 生成 SQL 时始终包含它们会更清晰。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-01-30T02:46:12.823

它们对于识别 SQL 中的每个元素很有用。

例如：

```
CREATE TABLE SchemaName.TableName ( 
```

这实际上会`SchemaName.TableName`在默认`dbo`模式下按名称创建一个表，即使目的可能是在`SchemaName`模式内创建表。

正确的方法如下：

```
CREATE TABLE [SchemaName].[TableName] ( 
```

现在它知道表名是什么以及应该在哪个模式中创建它（正确地在`SchemaName`模式中而不是在默认`dbo`模式中）

# ruby-on-rails - 如何在 Rails 中删除通配符 cookie？

> ID：52917
> 
> 赞同：13
> 
> 时间：2008-09-09T21:12:45.620
> 
> 标签：ruby-on-rails

如何删除使用通配符域设置的 Rails 中的 cookie：

```
cookies[:foo] = {:value => 'bar', :domain => '.acme.com'} 
```

当遵循[docs](http://api.rubyonrails.org/classes/ActionController/Cookies.html)时，您可以：

```
cookies.delete :foo 
```

日志说

```
Cookie set: foo=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT 
```

请注意，缺少域（似乎对所有内容都使用默认参数）。尊重 RFC，当然 cookie 还在那里，浏览器 -> `ctrl`/ `cmd`- `L`->

```
javascript:alert(document.cookie); 
```

瞧！

问：删除此类 cookie 的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-09T22:23:35.297

在删除时也传递 :domain 。这是该方法的来源：

```
# Removes the cookie on the client machine by setting the value to an empty string
# and setting its expiration date into the past.  Like []=, you can pass in an options
# hash to delete cookies with extra data such as a +path+.
def delete(name, options = {})
  options.stringify_keys!
  set_cookie(options.merge("name" => name.to_s, "value" => "", "expires" => Time.at(0)))
end 
```

如您所见，它只是使用您提供的名称设置了一个空 cookie，设置为在 1969 年到期，并且没有任何内容。但它确实合并了您提供的任何其他选项，因此您可以执行以下操作：

```
cookies.delete :foo, :domain => '.acme.com' 
```

你已经准备好了。

# css - 将 CSS 部署与站点的其余部分分开

> ID：52924
> 
> 赞同：5
> 
> 时间：2008-09-09T21:17:55.063
> 
> 标签：css, version-control, deployment, project-management

在我工作的地方，设计和开发部门是完全分开的，但是我们（设计部门）负责管理我们网站的 CSS。通常，新的 CSS 需要比新的网站代码更频繁地发布到生产服务器。因此，我们单独部署 CSS，它位于源代码控制之外。

然而，最近，我们遇到了一些新的 CSS 没有同步到网站发布的问题，总的来说，这个过程是一个非常令人头疼的问题。我一直在推动将 CSS 置于某种源代码控制之下，但很难找到一种让每个人都满意的好的部署方法。我们最大的问题是管理影响站点当前部分的更改，其中 CSS 更改需要在站点更改之前生效，但不会破坏现有站点上的任何内容。

我不会在这里详细介绍设计师和开发人员之间奇怪的文化，但我想知道其他人在管理需要不断处理的大量 CSS（50 多个文件，数千行）方面有什么经验更新和发布独立于网站发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T21:21:30.390

我将在这里提倡使用源代码控制。特别是如果开发团队使用分支来处理结构化版本。这样，无论 CSS 被签入到生产分支中，都应该被部署......如果它在中途更新，则由更新它的人（设计师？）负责使用贵公司的任何系统来推广该代码用于促进生产的变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T21:22:40.823

花哨的名字是“内容交付网络” [（维基百科）](http://en.wikipedia.org/wiki/Content_Delivery_Network)。

我们将 CSS 文件存储在数据库中，然后有一个单独的网站，只提供 CSS 资源。我们于 2007 年 5 月在 30 多个国家/地区的 1000 多个网站上实施了此功能。在过去的 15 个月里，它运行良好。

静态图像甚至 JavaScript 文件都以相同的方式处理。

# c# - Console.WriteLine 和通用列表

> ID：52927
> 
> 赞同：46
> 
> 时间：2008-09-09T21:19:44.060
> 
> 标签：c#, generics, console, list

我经常发现自己在编写这样的代码：

```
List<int> list = new List<int> { 1, 3, 5 };
foreach (int i in list) {
    Console.Write("{0}\t", i.ToString()); }
Console.WriteLine(); 
```

最好是这样的：

```
List<int> list = new List<int> { 1, 3, 5 };
Console.WriteLine("{0}\t", list); 
```

我怀疑有一些聪明的方法可以做到这一点，但我没有看到。有没有人有比第一个块更好的解决方案？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2008-09-09T21:22:46.253

做这个：

```
list.ForEach(i => Console.Write("{0}\t", i)); 
```

* * *

编辑：对于其他做出回应的人 - 他希望他们都在同一行，他们之间有制表符。:)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-09T21:33:04.963

一种不同的方法，只是为了踢球：

```
Console.WriteLine(string.Join("\t", list)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T11:29:50.253

如果有一段代码根据 Don't Repeat Yourself 一直重复，你应该把它放在你自己的库中并调用它。考虑到这一点，在这里获得正确答案有两个方面。首先是调用库函数的代码简洁明了。第二个是 foreach 的性能影响。

首先让我们考虑一下调用代码的清晰性和简洁性。

您可以通过多种方式执行 foreach：

1.  for 循环
2.  foreach 循环
3.  Collection.ForEach

在所有方法中，使用lamba 进行foreach List.ForEach 是最清晰和最简洁的。

```
list.ForEach(i => Console.Write("{0}\t", i)); 
```

所以在这个阶段它可能看起来像 List.ForEach 是要走的路。然而这有什么表现呢？确实，在这种情况下，写入控制台的时间将决定代码的性能。当我们对特定语言特性的性能有所了解时，我们当然至少应该考虑它。

根据[Duston Campbell 对 foreach 的性能测量，](http://diditwith.net/2006/10/05/PerformanceOfForeachVsListForEach.aspx)在优化代码下迭代列表的最快方法是使用 for 循环而不调用 List.Count。

然而，for 循环是一个冗长的结构。它也被视为一种非常迭代的做事方式，与当前的功能习语趋势不符。

那么我们能否获得简洁、清晰和性能？我们可以通过使用扩展方法。在理想情况下，我们会在 Console 上创建一个扩展方法，它接受一个列表并用分隔符写入它。我们不能这样做，因为 Console 是一个静态类，而扩展方法仅适用于类的实例。相反，我们需要将扩展​​方法放在列表本身（根据 David B 的建议）：

```
public static void WriteLine(this List<int> theList)
{
  foreach (int i in list)
  {
    Console.Write("{0}\t", t.ToString());
  }
  Console.WriteLine();
} 
```

这段代码将在很多地方使用，所以我们应该进行以下改进：

*   我们应该使用迭代集合的最快方法，而不是使用 foreach，这是一个带有缓存计数的 for 循环。
*   目前只有 List 可以作为参数传递。作为一个库函数，我们可以通过少量的努力来概括它。
*   使用 List 将我们限制为仅使用列表，使用 IList 也允许此代码与数组一起使用。
*   由于扩展方法将在 IList 上，我们需要更改名称以更清楚地显示我们正在写入的内容：

以下是函数代码的外观：

```
public static void WriteToConsole<T>(this IList<T> collection)
{
    int count = collection.Count();
    for(int i = 0;  i < count; ++i)
    {
        Console.Write("{0}\t", collection[i].ToString(), delimiter);
    }
    Console.WriteLine();
} 
```

我们可以通过允许客户端传入分隔符来进一步改进这一点。然后我们可以提供第二个函数，使用标准分隔符写入控制台，如下所示：

```
public static void WriteToConsole<T>(this IList<T> collection)
{
    WriteToConsole<T>(collection, "\t");
}

public static void WriteToConsole<T>(this IList<T> collection, string delimiter)
{
    int count = collection.Count();
    for(int i = 0;  i < count; ++i)
    {
         Console.Write("{0}{1}", collection[i].ToString(), delimiter);
    }
    Console.WriteLine();
} 
```

所以现在，考虑到我们想要一种简短、清晰的将列表写入控制台的高性能方式，我们有一个。这是完整的源代码，包括使用库函数的演示：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleWritelineTest
{
    public static class Extensions
    {
        public static void WriteToConsole<T>(this IList<T> collection)
        {
            WriteToConsole<T>(collection, "\t");
        }

        public static void WriteToConsole<T>(this IList<T> collection, string delimiter)
        {
            int count = collection.Count();
            for(int i = 0;  i < count; ++i)
            {
                Console.Write("{0}{1}", collection[i].ToString(), delimiter);
            }
            Console.WriteLine();
        }
    }

    internal class Foo
    {
        override public string ToString()
        {
            return "FooClass";
        }
    }

    internal class Program
    {

        static void Main(string[] args)
        {
            var myIntList = new List<int> {1, 2, 3, 4, 5};
            var myDoubleList = new List<double> {1.1, 2.2, 3.3, 4.4};
            var myDoubleArray = new Double[] {12.3, 12.4, 12.5, 12.6};
            var myFooList = new List<Foo> {new Foo(), new Foo(), new Foo()};
            // Using the standard delimiter /t
            myIntList.WriteToConsole();
            myDoubleList.WriteToConsole();
            myDoubleArray.WriteToConsole();
            myFooList.WriteToConsole();
            // Using our own delimiter ~
            myIntList.WriteToConsole("~");
            Console.Read();
        }
    }
} 
```

==================================================== =====

您可能认为这应该是答案的结尾。但是，可以进行进一步的概括。从 fatcat 的问题中不清楚他是否总是在向控制台写信。也许在 foreach 中还有其他事情要做。在那种情况下，Jason Bunting 的回答将给出一般性。这是他的回答：

```
list.ForEach(i => Console.Write("{0}\t", i)); 
```

除非我们对扩展方法进行进一步改进并添加 FastForEach，如下所示：

```
public static void FastForEach<T>(this IList<T> collection, Action<T> actionToPerform)
    {
        int count = collection.Count();
        for (int i = 0; i < count; ++i)
        {
            actionToPerform(collection[i]);    
        }
        Console.WriteLine();
    } 
```

***这允许我们使用尽可能快的迭代方法*对集合中的每个元素执行任意代码。**

我们甚至可以将 WriteToConsole 函数更改为使用 FastForEach

```
public static void WriteToConsole<T>(this IList<T> collection, string delimiter)
{
     collection.FastForEach(item => Console.Write("{0}{1}", item.ToString(), delimiter));
} 
```

所以现在整个源代码，包括 FastForEach 的一个示例用法是：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleWritelineTest
{
    public static class Extensions
    {
        public static void WriteToConsole<T>(this IList<T> collection)
        {
            WriteToConsole<T>(collection, "\t");
        }

        public static void WriteToConsole<T>(this IList<T> collection, string delimiter)
        {
             collection.FastForEach(item => Console.Write("{0}{1}", item.ToString(), delimiter));
        }

        public static void FastForEach<T>(this IList<T> collection, Action<T> actionToPerform)
        {
            int count = collection.Count();
            for (int i = 0; i < count; ++i)
            {
                actionToPerform(collection[i]);    
            }
            Console.WriteLine();
        }
    }

    internal class Foo
    {
        override public string ToString()
        {
            return "FooClass";
        }
    }

    internal class Program
    {

        static void Main(string[] args)
        {
            var myIntList = new List<int> {1, 2, 3, 4, 5};
            var myDoubleList = new List<double> {1.1, 2.2, 3.3, 4.4};
            var myDoubleArray = new Double[] {12.3, 12.4, 12.5, 12.6};
            var myFooList = new List<Foo> {new Foo(), new Foo(), new Foo()};

            // Using the standard delimiter /t
            myIntList.WriteToConsole();
            myDoubleList.WriteToConsole();
            myDoubleArray.WriteToConsole();
            myFooList.WriteToConsole();

            // Using our own delimiter ~
            myIntList.WriteToConsole("~");

            // What if we want to write them to separate lines?
            myIntList.FastForEach(item => Console.WriteLine(item.ToString()));
            Console.Read();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-09T21:29:00.683

```
List<int> list = new List<int> { 1, 3, 5 };
list.ForEach(x => Console.WriteLine(x)); 
```

编辑：该死！花了太长时间打开视觉工作室来测试它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-20T12:01:10.843

```
new List<int> { 1, 3, 5 }.ForEach(Console.WriteLine); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-09T21:23:19.933

```
 List<int> a = new List<int>() { 1, 2, 3, 4, 5 };
        a.ForEach(p => Console.WriteLine(p)); 
```

编辑：啊，他打败了我。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-09T21:23:33.350

```
list.ForEach(x=>Console.WriteLine(x)); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-06T23:42:17.900

你也可以加入：

```
var qwe = new List<int> {5, 2, 3, 8};
Console.WriteLine(string.Join("\t", qwe)); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T18:58:20.510

```
public static void WriteLine(this List<int> theList)
{
  foreach (int i in list)
  {
    Console.Write("{0}\t", t.ToString());
  }
  Console.WriteLine();
} 
```

然后，后来...

```
list.WriteLine(); 
```

# javascript - 开源 Actionscript 3 或 Javascript 日期实用程序类？

> ID：52931
> 
> 赞同：2
> 
> 时间：2008-09-09T21:19:53.857
> 
> 标签：javascript, apache-flex, actionscript-3

我想知道是否有人可以指出一个相当健壮的开源日期实用程序类。当我想做很多我认为在 C# 和 Java 中理所当然的事情时，我发现自己在做自己的事情。例如，我确实找到了一个很好的例子，即我撕开的 DateDiff() 函数和另一个 DatePart() 函数。另一个例子是解析不同的日期/时间格式。如果它已经建成，我试图避免重新发明一些东西。

另一种可能性可能是一组不错的 Javascript 文件，我可以将它们转换为 ActionScript 3。到目前为止，我已经找到[了 DateJS](http://www.datejs.com)，但我想对那里的内容有一个很好的了解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T21:24:23.517

[as3corelib](https://github.com/mikechambers/as3corelib)有[DateUtil](https://github.com/mikechambers/as3corelib/blob/master/src/com/adobe/utils/DateUtil.as)类，它应该非常可靠，因为它是由一些 Adob​​e 员工编写的。我没有遇到任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T21:59:22.343

还有[DP_DateExtensions](http://www.depressedpress.com/Content/Development/JavaScript/Extensions/DP_DateExtensions/Index.cfm)，虽然我相信 DateJS 更健壮。

# tfs - 如何修改工作项类型以在 TFS 中包含其他信息？

> ID：52933
> 
> 赞同：4
> 
> 时间：2008-09-09T21:20:38.800
> 
> 标签：tfs, workitem

TFS2008。我想跟踪任务工作项上的任务点，但没有任何地方（除了描述）可以记录这一点。我想添加一个包含 0、1、2、3、5、8 等的下拉列表，以便可以在报告中导出这些任务点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T21:26:39.987

使用作为[Visual Studio Team System 2008 Team Foundation Server Power Tools](http://msdn.microsoft.com/en-ca/tfs2008/bb980963.aspx)一部分提供的流程模板编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T22:47:38.253

不久前，我创建了一个演示此工具的网络广播。它涵盖了几个非常基本的场景。它可以在[这里](http://homepage.mac.com/stevevrporter/blog/Ta.html#vyk233532924)访问。

塔。

史蒂夫·波特

# windows - 如何让 git 忽略更改以防万一？

> ID：52950
> 
> 赞同：127
> 
> 时间：2008-09-09T21:24:53.300
> 
> 标签：windows, git

我不太确定这里发生了什么，但有时我的存储库中的特定文件会更改其名称的大小写。例如，：

前：`File.h`

后：`file.h`

我真的不在乎为什么会发生这种情况，但这会导致 git 认为它是一个新文件，然后我必须去改回文件名。你能让 git 忽略大小写变化吗？

**[编辑]** 我怀疑是 Visual Studio 对该特定文件做了一些奇怪的事情，因为它似乎最常发生在我打开并在更改后保存它时。但是，我没有任何方法可以修复 VS 中的错误，但我希望 git 应该更有能力。

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2008-09-09T23:14:28.667

从 1.5.6 版开始，`ignorecase`在`[core]``.git/config`

例如添加`ignorecase = true`

要仅将其更改为一个存储库，请从该文件夹运行：

```
git config core.ignorecase true 
```

要全局更改它：

```
git config --global core.ignorecase true 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-07-10T05:12:31.513

您可以使用以下命令强制 git 以仅区分大小写的方式重命名文件：

```
git mv --cached name.txt NAME.TXT 
```

请注意，这不会更改 Windows 分区上签出副本中文件的大小写，但 git 会记录大小写更改，您可以提交该更改。未来的结帐将使用新的外壳。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-11T05:54:13.850

在 Windows 的 git 版本 1.6.1.9 中，我发现默认情况下已经设置了配置中的“ignorecase=true”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-11-11T13:49:54.647

问题中描述的情况现在在 Mac OS X 上再次出现，git version >= 1.7.4（我认为）。解决方法是设置您的 ignorecase=false 并手动将小写文件（git 更改为这种方式，而不是 Visual Studio）重命名为它们的 UsualCase（即'mv myname MyName'）。

更多信息[在这里](http://tapestryjava.blogspot.com/2010/07/git-on-mac-os-x-dont-ignore-case.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-10-08T21:20:53.870

要强制 git 识别文件大小写的更改，可以运行此命令。

1.  随意更改文件大小写
2.  `git mv -f mynewapp.sln MyNewApp.sln`

以前的命令现在似乎已被弃用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-22T15:13:23.867

1.  从控制台： git config core.ignorecase true
2.  更改文件名大小写
3.  犯罪
4.  从控制台： git config core.ignorecase false

第 4 步修复了检查具有不同大小写的分支的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-29T21:04:08.033

`git mv FileName fileNameTemp`

然后

`git mv fileNameTemp fileName`

无需提交即可解决您的问题。

# c# - 在迭代之前检测 IDataReader 是否包含某个字段

> ID：52952
> 
> 赞同：8
> 
> 时间：2008-09-09T21:25:43.063
> 
> 标签：c#

所以我使用 IDataReader 来处理一些业务对象，但我不知道在运行时阅读器中究竟会有哪些字段。任何不在阅读器中的字段都将在结果对象上保留为空。您如何测试阅读器是否包含特定字段而不只是将其包装在 try/catch 中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-13T13:12:35.000

这应该可以解决问题：

```
 Public Shared Function ReaderContainsColumn(ByVal reader As IDataReader, ByVal name As String) As Boolean
        For i As Integer = 0 To reader.FieldCount - 1
            If reader.GetName(i).Equals(name, StringComparison.CurrentCultureIgnoreCase) Then Return True
        Next
        Return False
    End Function 
```

或（在 C# 中）

```
public static bool ReaderContainsColumn(IDataReader reader, string name)
{
    for (int i = 0; i < reader.FieldCount; i++) {
        if (reader.GetName(i).Equals(name, StringComparison.CurrentCultureIgnoreCase)) return true; 
    }
    return false;
} 
```

:o)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-13T13:25:21.247

您还可以使用`IDataReader.GetSchemaTable`来获取阅读器中所有列的列表。

[http://support.microsoft.com/kb/310107](http://support.microsoft.com/kb/310107)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-13T01:10:38.083

```
Enumerable.Range(0, reader.FieldCount).Any(i => reader.GetName(i) == "ColumnName") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T13:29:15.913

我用过的最好的解决方案是这样做的：

```
DataTable dataTable = new DataTable();
dataTable.Load(reader);
foreach (var item in dataTable.Rows) 
{
    bool columnExists = item.Table.Columns.Contains("ColumnName");
} 
```

尝试通过*reader["ColumnName"]*访问它并检查 null 或 DBNull 将引发异常。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-11-18T19:08:51.343

虽然我不同意这种方法（我认为在访问数据时，您应该事先知道形状），但我知道也有例外。

您始终可以使用阅读器加载数据表，然后对其进行迭代。然后，您可以检查该列是否存在。这会降低性能，但您不需要 try/catch 块（因此它可能更符合您的需求）。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-11-18T19:03:14.740

您不能只测试 reader["field"] 的 null 或 DBNull，因为如果列不在读取器中，则会引发 IndexOutOfRangeException。

我在映射层中用于创建域对象的代码和使用映射层的存储过程可能具有不同的列名，如下所示；如果未找到该列并返回 default(t) 或 null，您可以修改它以不引发异常。

我知道这不是最优雅或最佳的解决方案（实际上，如果您可以避免它，那么您应该），但是，遗留存储过程或 Sql 查询可能需要解决方法。

```
 /// <summary>
    /// Grabs the value from a specific datareader for a list of column names.
    /// </summary>
    /// <typeparam name="T">Type of the value.</typeparam>
    /// <param name="reader">Reader to grab data off of.</param>
    /// <param name="columnNames">Column names that should be interrogated.</param>
    /// <returns>Value from the first correct column name or an exception if none of the columns exist.</returns>
    public static T GetColumnValue<T>(IDataReader reader, params string[] columnNames)
    {
        bool foundValue = false;
        T value = default(T);
        IndexOutOfRangeException lastException = null;

        foreach (string columnName in columnNames)
        {
            try
            {
                int ordinal = reader.GetOrdinal(columnName);
                value = (T)reader.GetValue(ordinal);
                foundValue = true;
            }
            catch (IndexOutOfRangeException ex)
            {
                lastException = ex;
            }
        }

        if (!foundValue)
        {
            string message = string.Format("Column(s) {0} could not be not found.",
                string.Join(", ", columnNames));

            throw new IndexOutOfRangeException(message, lastException);
        }

        return value;
    } 
```

# ant - 如何让 javadoc 使用 Ant 任务链接到 Java API？

> ID：52954
> 
> 赞同：4
> 
> 时间：2008-09-09T21:26:33.920
> 
> 标签：ant, javadoc

现在我的蚂蚁任务看起来像。

```
<javadoc sourcepath="${source}" destdir="${doc}">
    <link href="http://java.sun.com/j2se/1.5.0/docs/api/" />
</javadoc> 
```

我收到了这个警告：

```
javadoc: warning - Error fetching URL: http://java.sun.com/j2se/1.5.0/docs/api/package-list 
```

如何让 javadoc 正确链接到 API？我在代理后面。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-10T14:55:32.790

您还可以在 ant 任务中传递参数

```
<arg value="-J-Dhttp.proxyHost=your.proxy.here"/>
<arg value="-J-Dhttp.proxyPort=##"/> 
```

如果走离线链接路线。通过转到 Java API 的 URL ( [http://java.sun.com/j2se/1.5.0/docs/api/package-list](http://java.sun.com/j2se/1.5.0/docs/api/package-list) ) 下载包列表并将其保存为文本文件，然后使用此 Ant任务。

```
<javadoc sourcepath="${source}" destdir="${doc}">
    <link offline="true" href="http://java.sun.com/j2se/1.5.0/docs/api/" packagelistloc="path-containing-package-list"/>
</javadoc> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-09T21:34:40.483

您可能需要设置[http.proxyHost 和 http.proxyPort 系统属性](http://java.sun.com/j2se/1.4.2/docs/guide/net/properties.html)。例如，`ANT_OPTS="-Dhttp.proxyHost=proxy.y.com" ant doc`

或者，您可以设置“离线”标志并提供一个包列表，但这对 Java 核心来说可能是一种痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T17:28:19.793

You can also use the "offline" mode that allows you to build (faster!) without accessing the internet. Please see this answer: [https://stackoverflow.com/a/24089805/366749](https://stackoverflow.com/a/24089805/366749)

# sql-server - SQL Server 随机排序

> ID：52964
> 
> 赞同：52
> 
> 时间：2008-09-09T21:31:07.933
> 
> 标签：sql-server

在存储过程中将 sql 查询的结果排序为随机顺序的最佳方法是什么？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-09-09T21:40:24.727

这是[SO# 19412](https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql)的副本。这是我在那里给出的答案：

```
select top 1 * from mytable order by newid() 
```

在 SQL Server 2005 及更高版本中，您可以使用 TABLESAMPLE 获取可重复的随机样本：

```
SELECT FirstName, LastName FROM Contact TABLESAMPLE (1 ROWS) ; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-09T21:35:16.457

```
select foo from Bar order by newid() 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-10-15T12:54:50.187

或者使用以下查询，它会返回更好的随机样本结果：

```
SELECT * FROM a_table WHERE 0.01 >= CAST(CHECKSUM(NEWID(), a_column) & 0x7fffffff AS float) / CAST (0x7fffffff AS int) 
```

0.01 表示总行数的约 1%。

引用 SQL 2008 联机丛书：

> 如果您真的想要单个行的随机样本，请修改您的查询以随机过滤掉行，而不是使用 TABLESAMPLE。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-09T21:36:40.307

如您所知，您不能只按 RAND() 排序，因为它只会产生一个值。因此，使用密钥作为种子值。

```
选择兰德（object_id），object_id，名称
  FROM 系统对象
 按 1 订购

```

# business-logic - 业务逻辑是主观的吗？

> ID：52965
> 
> 赞同：6
> 
> 时间：2008-09-09T21:31:12.643
> 
> 标签：business-logic

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T21:35:54.427

我真的认为你只需要就你所说的“业务逻辑”的含义达成一个明确的定义。如果您需要“政治敏感”，您甚至可以根据团队负责人的理解来制定定义，然后想出另一个术语（“域规则”？）来定义您想要谈论的内容。

词语和术语是相对主观的——当然，一旦你离开那家公司，你将需要“重新学习”行业标准，所以如果可以的话，最好还是坚持下去，但主要目标是清晰地沟通并获得完成工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-09T22:25:04.590

区分的一种方法是“业务逻辑”是客户关心的东西，可以向客户解释，而无需参考计算机特定的词。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T22:57:16.260

您可以尝试用一个定时示例来论证您的观点，对索引表运行 sql select，然后运行循环以在同一集合中找到完全相同的项目，但这次是在代码中。代码会慢很多。

让数据库做它设计的事情，选择数据集和子集:) 我认为现实地说，你所能做的就是让你的团队一起建立一套你将编码的标准，民主规则！

# database - 无法从数据库中删除...？

> ID：52981
> 
> 赞同：1
> 
> 时间：2008-09-09T21:36:35.267
> 
> 标签：database, db2

所以，我有 2 个数据库实例，一个用于一般开发，另一个从开发中复制用于单元测试。

开发数据库中发生了一些我无法弄清楚的变化，我不知道如何查看有什么不同。

当我尝试从特定表中删除时，例如：

```
delete from myschema.mytable where id = 555 
```

我从单元测试数据库中得到以下正常响应，表明没有删除任何行：

> SQL0100W 未找到 FETCH、UPDATE 或 DELETE 行；或者查询的结果是一个空表。SQLSTATE=02000

但是，开发数据库根本无法删除，并出现以下错误：

> DB21034E 该命令被作为 SQL 语句处理，因为它不是有效的命令行处理器命令。在 SQL 处理期间，它返回： SQL0440N 未找到具有兼容参数的名为“=”、类型为“FUNCTION”的授权例程。SQLSTATE=42884

我最好的猜测是添加或更改了一些触发器或视图导致问题，但我不知道如何去寻找问题......有没有人遇到这个问题或知道如何找出根源的问题是？

（注意这是一个 DB2 数据库）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T00:37:44.630

嗯，将伟大的预言应用于这个问题，我想出了：

[http://bytes.com/forum/thread830774.html](http://bytes.com/forum/thread830774.html)

似乎表明另一个表有一个指向有问题的表的外键，当另一个表上的 FK 被删除时，删除应该再次起作用。（大概您也可以重新创建外键）

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T21:53:22.543

您可能在 dev db 上有一个开放的事务......这有时会让我在 SQL Server 上

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T22:05:39.677

id的类型是否兼容555？还是改成非整数类型了？

或者，555 参数是否以某种方式丢失（例如，如果您使用 JDBC 并且准备好的语句在执行查询之前没有设置其参数）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-09T23:47:41.897

您可以在您的问题中添加更多内容吗？该错误听起来像 sql 语句解析器对您的语句非常困惑。您可以在该表上为 id = 555 的行进行选择吗？

您可以尝试在该表上运行 RUNSTATS 和 REORG TABLE，这些应该可以整理出不稳定的表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-09T23:59:37.403

[@抛弃](https://stackoverflow.com/questions/52981/cannot-delete-from-the-database#53169)

具有相同“位置”条件的选择可以正常工作，只是不能删除。runstats 和 reorg table 都不会对该问题产生任何影响。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T00:45:27.263

[@抛弃](https://stackoverflow.com/questions/52981/cannot-delete-from-the-database#53231)

我们实际上刚刚解决了这个问题，确实正如你所说（一位同事也发现了完全相同的页面）。

解决方案是删除外键约束并重新添加它们。

关于该主题的另一篇文章：

[http://www.ibm.com/developerworks/forums/thread.jspa?threadID=208277&tstart=-1](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=208277&tstart=-1)

这表明该问题是一个引用约束损坏，并且实际上或假定无论如何，已在更高版本的 db2 V9（我们尚未使用）中修复。

谢谢您的帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T16:37:20.063

请检查 1\. 您的触发器、过程、函数等参数。 2\. 参数的数据类型。

# ant - 如何使用 Ant 生成 Emma 代码覆盖率报告？

> ID：52984
> 
> 赞同：26
> 
> 时间：2008-09-09T21:37:43.813
> 
> 标签：ant, code-analysis, emma

如何设置 Ant 任务以生成[Emma](http://emma.sourceforge.net)代码覆盖率报告？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-09T21:48:46.703

要回答有关源目录和检测目录在哪里的问题（这些可以切换到您的标准目录结构）：

```
<property file="build.properties" />
<property name="source" location="src/main/java" />
<property name="test.source" location="src/test/java" />
<property name="target.dir" location="target" />
<property name="target" location="${target.dir}/classes" />
<property name="test.target" location="${target.dir}/test-classes" />
<property name="instr.target" location="${target.dir}/instr-classes" /> 
```

类路径：

```
<path id="compile.classpath">
  <fileset dir="lib/main">
    <include name="*.jar" />
  </fileset>
</path>

<path id="test.compile.classpath">
  <path refid="compile.classpath" />
  <pathelement location="lib/test/junit-4.6.jar" />
  <pathelement location="${target}" />
</path>

<path id="junit.classpath">
  <path refid="test.compile.classpath" />
  <pathelement location="${test.target}" />
</path> 
```

首先，您需要设置 Ant 可以在哪里找到 Emma 库：

```
<path id="emma.lib" >
    <pathelement location="${emma.dir}/emma.jar" />
    <pathelement location="${emma.dir}/emma_ant.jar" />
</path> 
```

然后导入任务：

```
<taskdef resource="emma_ant.properties" classpathref="emma.lib" /> 
```

然后检测代码：

```
<target name="coverage.instrumentation">
    <mkdir dir="${instr.target}"/>
    <mkdir dir="${coverage}"/>
    <emma>
        <instr instrpath="${target}" destdir="${instr.target}" metadatafile="${coverage}/metadata.emma" mode="copy">
            <filter excludes="*Test*"/>
        </instr>
    </emma>
    <!-- Update the that will run the instrumented code -->
    <path id="test.classpath">
        <pathelement location="${instr.target}"/>
        <path refid="junit.classpath"/>
        <pathelement location="${emma.dir}/emma.jar"/>
    </path>
</target> 
```

然后使用正确的 VM 参数运行目标，例如：

```
<jvmarg value="-Demma.coverage.out.file=${coverage}/coverage.emma" />
<jvmarg value="-Demma.coverage.out.merge=true" /> 
```

最后生成您的报告：

```
<target name="coverage.report" depends="coverage.instrumentation">
    <emma>
        <report sourcepath="${source}" depth="method">
            <fileset dir="${coverage}" >
                <include name="*.emma" />
            </fileset>
            <html outfile="${coverage}/coverage.html" />
        </report>
    </emma>
</target> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T15:36:51.943

用户指南有一个很好的[例子来说明如何设置你的构建脚本](http://emma.sourceforge.net/userguide_single/userguide.html#N10291)，这样你不仅可以将检测的代码与执行分开，而且它也都包含在同一个代码中，`<target>`这样你就不必运行一系列不同的目标，但是您可以执行类似的操作`ant emma tests`（例如，如果`ant tests`您通常是如何运行单元测试的）。

这是他们的例子：

```
<target name="emma" description="turns on EMMA instrumentation/reporting" >
    <property name="emma.enabled" value="true" />
    <!-- EMMA instr class output directory: -->
    <property name="out.instr.dir" value="${basedir}/outinstr" />
    <mkdir dir="${out.instr.dir}" />
</target>

<target name="run" depends="init, compile" description="runs the examples" >
    <emma enabled="${emma.enabled}" >
      <instr instrpathref="run.classpath"
             destdir="${out.instr.dir}" 
             metadatafile="${coverage.dir}/metadata.emma"
             merge="true"
      />
    </emma>

    <!-- note from matt b: you could just as easily have a <junit> task here! -->
    <java classname="Main" fork="true" >
      <classpath>
       <pathelement location="${out.instr.dir}" />
        <path refid="run.classpath" />
        <path refid="emma.lib" />
      </classpath> 
      <jvmarg value="-Demma.coverage.out.file=${coverage.dir}/coverage.emma" />
      <jvmarg value="-Demma.coverage.out.merge=true" />
    </java>

    <emma enabled="${emma.enabled}" >
      <report sourcepath="${src.dir}" >
        <fileset dir="${coverage.dir}" >
          <include name="*.emma" />
        </fileset>

        <txt outfile="${coverage.dir}/coverage.txt" />
        <html outfile="${coverage.dir}/coverage.html" />
      </report>
    </emma>
</target> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T08:04:32.770

Emma 2.1 引入了另一种获取运行时覆盖信息（.ec 文件）的方法。可以从运行检测应用程序的计算机的给定端口远程请求数据。所以没有必要停止VM。

要获取包含运行时覆盖率数据的文件，您需要在运行测试和生成覆盖率报告之间的 Ant 脚本中插入以下代码段：

```
<emma>
    <ctl connect="${emma.rt.host}:${emma.rt.port}" >
        <command name="coverage.get" args="${emma.ec.file}" />
        <command name="coverage.reset" />
    </ctl>
</emma> 
```

其他步骤与 Emma 2.0 类似。它们在[上一篇文章中得到了完美的描述](https://stackoverflow.com/questions/52984/how-do-i-generate-emma-code-coverage-raeports-using-ant#52994)

有关 Emma 2.1 功能的更多信息：http: [//sourceforge.net/project/shownotes.php ?group_id=108932&release_id=336859](http://sourceforge.net/project/shownotes.php?group_id=108932&release_id=336859)

# asp.net - 将泛型类与 ObjectDataSource 一起使用

> ID：52989
> 
> 赞同：9
> 
> 时间：2008-09-09T21:43:55.220
> 
> 标签：asp.net, generics, objectdatasource

我有一个要与 ObjectDataSource 一起使用的通用 Repository<T> 类。Repository<T> 位于一个名为 DataAccess 的单独项目中。根据[MS 新闻组的这篇文章](http://groups.google.com/group/microsoft.public.dotnet.framework.aspnet/browse_thread/thread/767f1a821d9b23da/b1e045958ae427a5?lnk=st#b1e045958ae427a5)（相关部分复制如下）：

> 在内部，ObjectDataSource 调用 Type.GetType(string) 来获取类型，因此我们需要遵循 Type.GetType 中记录的关于如何使用泛型获取类型的指南。您可以参考 MSDN Library on Type.GetType：
> 
> [http://msdn2.microsoft.com/en-us/library/w3f99sx1.aspx](http://msdn2.microsoft.com/en-us/library/w3f99sx1.aspx)
> 
> 从文档中，您将了解到您需要使用反引号 (`) 来表示使用泛型的类型名称。
> 
> 此外，这里我们必须在类型名称字符串中指定程序集名称。
> 
> 因此，对于您的问题，答案是使用如下类型名称：
> 
> TypeName="TestObjectDataSourceAssembly.MyDataHandler`1[System.String],TestObjectDataSourceAssembly"

好吧，有道理。但是，当我尝试它时，页面会引发异常：

```
<asp:ObjectDataSource ID="MyDataSource" TypeName="MyProject.Repository`1[MyProject.MessageCategory],DataAccess" /> 
```

> [InvalidOperationException：找不到 ObjectDataSource 'MyDataSource' 的 TypeName 属性中指定的类型。]

奇怪的是，这只发生在我查看页面时。当我从 VS2008 设计器打开“配置数据源”对话框时，它正确地向我显示了我的通用存储库类的方法。在调试时将 TypeName 字符串传递给 Type.GetType() 也会返回有效类型。那么给了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-09T23:08:12.020

做这样的事情。

```
Type type = typeof(Repository<MessageCategory);
string assemblyQualifiedName = type.AssemblyQualifiedName; 
```

获取 assemblyQualifiedName 的值并将其粘贴到 TypeName 字段中。注意Type.GetType(string)，传入的值必须是

> 要获取的类型的程序集限定名称。请参阅[AssemblyQualifiedName](http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname.aspx)。如果该类型在当前执行的程序集中或在 Mscorlib.dll 中，则提供由其命名空间限定的类型名称就足够了。

因此，它可以通过在代码中传递该字符串来工作，因为该类在当前执行的程序集中（您正在调用它），而 ObjectDataSource 不在。

您正在寻找的类型很可能是

```
MyProject.Repository`1[MyProject.MessageCategory, DataAccess, Version=1.0.0.0, Culture=neutral, PublicKey=null], DataAccess, Version=1.0.0.0, Culture=neutral, PublicKey=null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-21T16:58:03.067

我知道这是一篇旧帖子，但我最近自己也遇到了这个问题。另一种解决方案是用对象组合替换继承，例如

```
[DataObject]
public class DataAccessObject {
    private Repository<MessageCategory> _repository;

    // ctor omitted for clarity
    // ...

    [DataObjectMethod(DataObjectMethodType.Select)]
    public MessageCategory Get(int key) {
        return _repository.Get(key);
    }
} 
```

这样 ObjectDataSource 不知道存储库，因为它隐藏在类中。我的外观层中有一个类库，这是一个非常合理的地方，可以将此代码放入我正在处理的项目中。

此外，如果您使用 Resharper 和接口，则可以使用 Resharper 的“使用字段实现”功能让 Resharper 进行重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T17:45:22.570

达伦，

非常非常感谢您的帖子。我整天都在和这个作斗争。奇怪的是，就我而言，我需要将方括号加倍，例如对于您的一段代码：

MyProject.Repository`1[[MyProject.MessageCategory, DataAccess, Version=1.0.0.0, Culture=neutral, PublicKey=null]], DataAccess, Version=1.0.0.0, Culture=neutral, PublicKey=null

罗杰*************`