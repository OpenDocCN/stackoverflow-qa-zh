# StackOverflow 问答 000296000-000296999

# sql - 可读的 SQL 别名

> ID：296001
> 
> 赞同：1
> 
> 时间：2008-11-17T16:10:31.687
> 
> 标签：sql, oracle, alias

因为我确信很多人有不同的标准，所以我把这篇文章做成了一个社区维基。

我的问题是，表别名的好的命名方案是什么？我一直在使用表名中每个单词的第一个字母，但它变得非常难以阅读。这是一个简单的例子。

```
FROM incidents i
FROM cause_attack ca
FROM obscure_table ot 
```

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T16:13:34.240

别名的全部意义在于缩短名称，因此您不需要冗长。

它只需要在给定查询中是唯一的，因此不需要命名它们的方案。

编辑：此外，您使用的别名高度依赖于表命名方案。如果您的所有表都有一个由 5 部分组成的名称，其中前 4 个在查询中是通用的，那么将这些部分保留在别名中是很愚蠢的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T16:15:28.120

表名本身应该已经可读。因此，如果您想要一个可读的名称，请不要使用别名。

这意味着别名的目的与其他任何事情一样，都是为了避免您可怜的手指重新输入长名称。在这种情况下，简短的名称效果很好，特别是因为它们必须紧挨着全名声明。

这里唯一的例外是，如果您不止一次地加入一个表，在这种情况下，您需要一些东西来确定您需要的表的哪个实例，或者如果您正在为子查询设置别名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T16:17:32.203

通常我会尝试遵循表的命名结构。

我尝试使用说话的表格名称，例如`'RelObjectProperty'`，并始终如一地为它们起别名（对于此示例）`'rop'`：

```
SELECT
  p.Name    PropertyName,
  o.Name    ObjectName,
  rop.Value PropertyValue
FROM
  Property p
  INNER JOIN RelObjectProperty rop ON rop.PropertyId = p.Id
  INNER JOIN Object              o ON rop.ObjectId   = o.Id
WHERE
  o.Id = 10 
```

此首字母缩略词方案对于具有严格无冲突表名的数据库很有帮助，但不能始终保证这一点。

可能有一个 table `'RelObjectPresentation'`，在这种情况下，我很可能会破坏该方案并`'rop'`用于第一个和`'ropr'`后者。即使在这种情况下，我也会保持一致，至少在*任何地方都*`'ropr'`使用别名，而不仅仅是在我需要区分的查询中。*`'rop'`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T16:19:28.050

我通常和你做类似的事情，除了我只使用第一个字母，大写，直到我有多个以相同名称开头的表，或者同一个表的多个引用，然后我添加一个后缀来区分两者..任何让读者清楚的东西。如果我在子查询中使用与外部查询相同的表（比如 Employee 表），我可以使用前缀 i 或 o 来区分，如

```
-- Find Highest paid Emplyees in Each Division ..... 
Select * From Employee oE -- For outer Employee table
Where Salary = (Select Max(Salary) 
                From Employee iE
                Where DivisionId = oE.DivisionId) 
```

这样，当我阅读 SQL 时，我可以在内部将别名读取为“Inner Employee”或“Outer Employee”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T16:23:02.490

在数据仓库场景中，我通常使用第一个字符，但前缀为`fact_`、`dim_`或`cdim_`，以区分事实、维度或一致的维度表。我也会做`lkup_`查找（所以`LOOKUP_TRANSACTION_TYPE`会变成`lkup_TT`）。

查找技术也适用于 OLTP 类型的数据库。

通常，我在查询中没有大量的表，其中缩写词很难理解，而且表别名之间通常没有任何冲突（因为通常已经有一些分组，例如`SYSTEM_SUBSYSTEM_ENTITY_TYPE`），因此，实际上，表名始终具有相同的别名。

与 A、B、C 或 T1、T2、T3 技术相比，这是一个很好的优势，因为它是可遵循的并且有助于避免剪切和粘贴错误。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-17T16:23:35.547

虽然我不是 Oracle 人（实际上，这个问题应该适用于几乎所有 RDBMS），但我[对“您被迫遵循的最奇怪的编码标准规则是什么”的回答](https://stackoverflow.com/questions/218123/what-was-the-strangest-coding-standard-rule-that-you-were-forced-to-follow#218414)似乎在这里适用（编辑以使其在这篇文章的上下文）...

对我们来说，这都是关于表名的。我们从一个使用这个标准的客户那里得到这个想法，在我们都适应它之后，我们喜欢它。表名相当冗长，但由于它们都有唯一的助记前缀，我们总是有一组标准化的别名：只需使用前缀即可。一旦我们脱离了这个客户，我们就保留了新系统的命名方案，并且从那以后它一直非常成功。

方案如下：每个表都以大写字母命名，单词之间有下划线。每个表都有一个前缀（通常为 1 - 6 个字符），通常是主表名称的首字母缩写词或缩写。表的每个字段也都带有相同的前缀。在复杂查询中，前缀也用作别名。所以，假设你有一个简单的模式，人们可以拥有猫或狗。它看起来像这样：

```
PER_PERSON
    PER_ID
    PER_NameFirst
    PER_NameLast
    ...
CAT_CAT
    CAT_ID
    CAT_Name
    CAT_Breed
    ...
DOG_DOG
    DOG_ID
    DOG_Name
    DOG_Breed
    ...
PERCD_PERSON_CAT_DOG (for the join data)
    PERCD_ID
    PERCD_PER_ID
    PERCD_CAT_ID
    PERCD_DOG_ID 
```

同样，在构建连接时，前缀是为了提醒“推荐”（和强制！）表别名。前缀使大多数连接查询更容易编写，因为您必须在字段之前显式引用表是非常罕见的，因为即使相关的字段名称也有前缀，因此已经有点名称范围。

一个巧妙的副作用是，最终，您的开发人员可能能够通过前缀来开始引用对话中的表。可以肯定的是，后天的品味……但这对我们有用。

# sharepoint - 激活时将资源文件部署到 App_GlobalResource 文件夹

> ID：296003
> 
> 赞同：7
> 
> 时间：2008-11-17T16:11:19.563
> 
> 标签：sharepoint, resources

有谁知道激活功能时将资源文件部署到 Web 应用程序的 App_GlobalResource 文件夹的最佳方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-04-17T09:42:14.840

感谢大家的回答，但 SharePoint 2010 的最佳解决方案如下：

*   添加新项目 > 模块
*   复制（或）在那里添加您的资源文件
*   将每个资源文件的“部署类型”属性更改为 appGlobalResource
*   将“部署位置 > 路径”属性更改为空，以便资源文件正确部署到 Web 应用程序下的“App_GlobalResources”

![在此处输入图像描述](https://i.stack.imgur.com/C3Awv.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T17:41:28.610

因此，作为对这个问题的最后跟进，我们最终做了什么来完全自动化这个过程。

正如建议的那样，我们确实在清单文件中使用了 ApplicationResourceFile 元素。

```
<?xml version="1.0" encoding="utf-8"?>
<Solution SolutionId="{185E973C-3A10-4e2a-9E0F-DC14414551F9}"
          xmlns="http://schemas.microsoft.com/sharepoint/"
          DeploymentServerType="WebFrontEnd">
  <ApplicationResourceFiles>
    <ApplicationResourceFile Location="yourappname.resx"/>
    <ApplicationResourceFile Location="yourappname.en-US.resx"/>
  </ApplicationResourceFiles> ...
</Solution> 
```

实际上，这确实将文件放入“资源”文件夹中。因此，我们只需在代码中从那里访问资源，如下所示：

```
string appPath = HttpContext.Current.Request.MapPath(HttpContext.Current.Request.ApplicationPath);
ResourceManager resX = ResourceManager.CreateFileBasedResourceManager("ResourceFileName", appPath + "resources", null);

SPSecurity.RunWithElevatedPrivileges(delegate()
{
    AddResource(resX, "DefaultTextBoxLabelText"); 
```

我们在构造函数中运行此代码，并将资源文件中的条目添加到本地字典中。您必须使用 RunWithElevatedPrivileges，因为创建的新“资源”文件夹只能由 AppPool 帐户访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T18:54:29.360

除非您执行某些代码并启动将文件复制到每个 Web 前端服务器上的 App_GlobalResources 文件夹的 SharePoint 计时器作业，否则无法通过功能部署应用程序资源文件。

您应该让 SharePoint 解决方案框架将 .RESX 文件部署到每台服务器上的 App_GlobalResources 文件夹。您可以在 WSP 解决方案包的 manifest.xml 文件中指定应用程序资源文件，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Solution SolutionId="{185E973C-3A10-4e2a-9E0F-DC14414551F9}" 
          xmlns="http://schemas.microsoft.com/sharepoint/" 
          DeploymentServerType="WebFrontEnd">

  <ApplicationResourceFiles>
    <ApplicationResourceFile Location="yourappname.resx"/>
    <ApplicationResourceFile Location="yourappname.en-US.resx"/>
  </ApplicationResourceFiles>

 ...
</Solution> 
```

当您使用 STSADM 或管理中心部署 WSP 解决方案包时，SharePoint 解决方案框架将启动一个计时器作业，将这些文件部署到您决定将解决方案部署到的所有 Web 应用程序的 App_GlobalResources 文件夹中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-26T22:18:27.503

对于 SharePoint 2010，您需要更改 XML 节点名称，以便将其复制到新的 App_GlobalResources 文件夹，而不是 C:\inetpub\wwwroot\wss\VirtualDirectories\80 MSDN 链接中的 Resource 文件夹：http: [//msdn.microsoft.com/ zh-CN/图书馆/ms463158.aspx](http://msdn.microsoft.com/en-us/library/ms463158.aspx)

例子：

```
<Solution SolutionId="{8a2f91f2-db85-4eb3-8e7c-330f05246e1a}"
          DeploymentServerType="WebFrontEnd"
          xmlns="http://schemas.microsoft.com/sharepoint/">
    <ApplicationResourceFiles>
        <App_GlobalResourceFile Location="yourResourceFile.resx"/>
    </ApplicationResourceFiles> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T19:26:35.577

我们最近在农场安装中遇到了同样的问题。不幸的是，在清单中添加 ApplicationResourceFile 条目只会将您的资源添加到 Resources 文件夹中。

虽然您可以使用 stsadm -o copyappbincontent 手动将资源文件从 Resources 部署到 App_GlobalResources（必须在每个前端服务器上发出），但我们最终创建了一个计时器作业来手动复制文件，如下[所述](http://blog.mwiedemeyer.de/2008/05/25/DeployGlobalResourcesInASharePointFarm.aspx)：

# wpf - 使用访问键时，LostFocus 绑定不起作用

> ID：296015
> 
> 赞同：0
> 
> 时间：2008-11-17T16:15:31.913
> 
> 标签：wpf, events, data-binding, lost-focus

请考虑以下示例。请注意，在现实世界中，绑定源很可能是一个数据对象。为了简单起见，我使用 a `TextBlock`。

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel Margin="20">

        <Label>Enter a Name:</Label>
        <TextBox x:Name="txt_Name" Text="{Binding ElementName=display_name, Path=Text, UpdateSourceTrigger=LostFocus}" />

        <Label>The name you entered:</Label>
        <TextBlock x:Name="display_name" />

        <Button x:Name="btn_Save" Click="SaveClick">_Save</Button>

    </StackPanel>
</Window> 
```

```
Class Window1

    Private Sub SaveClick(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)
        MessageBox.Show("Saving your name as: " & display_name.Text)
    End Sub

End Class 
```

在上面的示例中，如果我在 中输入名称`"Joe"`并`TextBox`单击“保存”按钮，`TextBlock`则会更新`LostFocus`并正确“保存”数据。一切都很好。

但是，如果我随后输入`"Bob"`并`TextBox`使用我的访问密钥 (Alt-S) 进行保存，`TextBlock`则不会更新，因为不会触发`LostFocus`上的事件。`TextBox`结果，我的绑定源没有更新，并且`"Joe"`保存了错误的值（即 ）。

在大多数 WPF`TextBox`数据输入字段中，您需要在`LostFocus`(not `PropertyChanged`) 上进行验证；但是，如果在`LostFocus`使用访问密钥时事件没有触发（因此绑定没有更新），我们如何验证条目？在 WinForms 中我们有`Validating`and`Validated`事件，但在 WPF 中没有它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T16:35:29.610

您可以在保存之前手动执行此操作：

```
txt_Name.GetBindingExpression(TextBox.TextProperty).UpdateTarget(); 
```

有点难看，但它的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T08:23:49.540

您还可以在读取值之前更改单击处理程序中的焦点，例如将焦点强制到按钮或另一个文本框

这是另一个“丑陋但有效”的解决方案，如果您有很多控件或不想弄乱它们的绑定表达式，它可能是合适的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-22T22:15:57.707

好吧，如果您对现实世界的场景比这里的人为示例更感兴趣，您可以设置文本框上的绑定以更新数据更改而不是失去焦点，并且数据将在两种场景中保存而没有任何丑陋黑客。唯一的问题（在 Bindings 的 WPF 文档中提到）是这可能会影响应用程序的性能。如果您在任何一种甚至相对较新的机器上运行，您都不会注意到差异（我没有）。

# sql - 在 SQL Server 2005/2008 中存储历史数据的最佳方式是什么？

> ID：296017
> 
> 赞同：22
> 
> 时间：2008-11-17T16:16:42.393
> 
> 标签：sql, sql-server, performance, tsql, sql-server-2008

我的简化和人为的例子如下： -

假设我想每天测量和存储世界上所有城镇的温度（和其他值）。我正在寻找一种存储数据的最佳方式，以便获得所有城镇的当前温度，就像获得一个城镇历史上的所有温度一样容易。

这是一个很容易解决的问题，但我正在寻找最佳解决方案。

我能想到的两个主要选项如下：-

# 选项 1 - 同一张表存储当前和历史记录

将所有当前记录和存档记录存储在同一个表中。

IE

```
CREATE TABLE [dbo].[WeatherMeasurement](
  MeasurementID [int] Identity(1,1) NOT Null,
  TownID [int] Not Null,
  Temp [int] NOT Null,
  Date [datetime] NOT Null,
) 
```

这将使一切变得简单，但是获取城镇列表和当前温度的最有效查询是什么？一旦表中有数百万行，这会扩展吗？通过在表中添加某种 IsCurrent 标志有什么好处吗？

# 选项 2 - 将所有存档记录存储在单独的表中

将有一个表来存储当前的实时测量值

```
CREATE TABLE [dbo].[WeatherMeasurement](
  MeasurementID [int] Identity(1,1) NOT Null,
  TownID [int] Not Null,
  Temp [int] NOT Null,
  Date [datetime] NOT Null,
) 
```

还有一个存储历史存档日期的表（可能由触发器插入）

```
CREATE TABLE [dbo].[WeatherMeasurementHistory](
  MeasurementID [int] Identity(1,1) NOT Null,
  TownID [int] Not Null,
  Temp [int] NOT Null,
  Date [datetime] NOT Null,
) 
```

这样做的好处是保持当前主要数据精简，查询效率很高，但代价是架构更复杂，插入数据更昂贵。

哪个是最好的选择？有没有我没有提到的更好的选择？

注意：我已经简化了架构以帮助更好地集中我的问题，但假设每天都会插入大量数据（100,000 条记录），并且数据是一天的最新数据。当前数据与历史数据一样可能被查询。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-17T16:23:54.390

它取决于应用程序的使用模式...如果使用模式表明历史数据的查询频率高于当前值，则将它们全部放在一个表中...但是如果历史查询是例外，（或少于10% 的查询），并且更常见的当前值查询的性能会因将所有数据放在一个表中而受到影响，那么将这些数据分离到它自己的表中是有意义的......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-17T16:30:11.507

*除非*您对当前数据（使用量）或历史数据（量）有非常严重的偏差，否则我会将数据保存在一个表中。在大多数情况下，带有 DATE + TOWNID（按此顺序）的复合索引将消除性能问题（尽管显然我们目前没有数据来确定这一点）。

我想知道的一件事是，是否有人想要一个城镇的当前和历史数据中的数据。如果是这样，您刚刚创建了至少一个需要担心的新视图以及该方向上可能出现的性能问题。

不幸的是，这是您可能需要针对现实世界数据分析您的解决方案的事情之一。我个人在很多情况下都使用了上述指定的复合索引，但在少数极端情况下，我选择将历史记录分解到另一个表中。好吧，实际上是另一个数据文件，因为问题是历史记录*太*密集了，以至于我单独为它创建了一个新的数据文件，以避免膨胀整个主数据文件集。性能问题很少通过理论来解决。

我建议阅读有关索引使用的查询提示，并“覆盖索引”以获取有关性能问题的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T16:37:54.223

您的表非常狭窄，并且可能会在单个正确索引的表中执行，即使对于数百万行，它也永远不会超过传统规范化 OLTP 模型中 SQL Server 的容量。即使具有双表模型的优势，也可以通过在 SQL Server 中使用表分区来减轻。所以相对于单表模型没有太多的推荐。这将是一个 Inmon 风格或“企业数据仓库”的场景。

在更大的场景中，我会定期将数据传输到数据仓库（使用 Kimball 风格的维度模型建模）并简单地清除实时数据 - 在像您这样的一些简单场景中，实际上可能**没有**实时数据 -这一切都直接进入仓库。维度模型在以不同方式对数据进行切片和存储具有多种维度的大量事实时具有很多优势。即使在数据仓库场景中，事实表通常也是按日期分区的。

您的数据似乎没有这个（城镇和日期是您唯一的明确维度），但是，在大多数数据仓库中，维度可能会像雪花一样或可能存在冗余，因此在加载时存储的事实会有其他维度而不是为了提高效率而使用雪花——比如 State、Zip Code、WasItRaining、IsStationUrban（人为的）。

这可能看起来很愚蠢，但是当您开始在数据仓库中挖掘数据以获取结果时，就会提出诸如以下问题 - 在城市环境中下雨的一天，缅因州的平均温度是多少？- 在不加入一大堆表格的情况下更容易获得（即它不需要很多关于标准化模型的专业知识并且执行速度非常快）。有点像棒球中无用的统计数据 - 但有些显然是有用的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T16:20:29.563

我建议保留在同一张表中，因为历史数据被经常查询。除非您将向表中添加更多列。

当大小成为问题时，您可以按十年对其进行分区，并使用存储过程联合请求的行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T16:26:37.350

另一种选择可能是为所有数据使用一个表并查看当前温度。这不会提高性能，但可以很好地提高可读性/可维护性。如果您有适当的 sql 版本，您甚至可以使用索引视图来提高性能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T16:37:27.717

我会使用带有索引视图的单个表来为我提供最新信息。SQL 2005 和 2008 服务器是为数据仓库设计的，因此在这种情况下应该可以很好地执行。

如果您有一个需要经常写入数据库的数据模式，那么最好的选择是拥有一个活动表和存档表，您可以在某个时间间隔批量更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-27T08:11:56.473

如果您将所有内容存储在一张表中，您将如何制作关系数据库。

例子：

id-------------GUID----PK

record_id-------GUID

每次插入新记录时，[id] 都会更改，但 [record_id] 将保持不变。现在，如果您必须将其与地址表链接，您将如何做到这一点？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-03T14:05:59.890

与其尝试为此优化关系数据库，不如考虑使用[**时间序列数据库**](https://en.wikipedia.org/wiki/Time_series_database)。这些已经针对处理基于时间的数据进行了优化。它们的一些优点是：

*   更快地查询基于时间的键
*   大数据吞吐量
    *   由于默认操作只是一个附加操作，因此可以非常快速地完成。（[InfluxDb](https://www.influxdata.com/products/)支持**每秒****数百万**个数据点）。

***   能够更积极地压缩数据*   对时间序列数据更加用户友好。
    *   API 倾向于反映时间序列数据的典型用例
    *   可以自动计算聚合指标（例如窗口平均值）
    *   通常可以使用特定的可视化工具。**

 **我个人喜欢使用开源数据库[InfluxDB](https://www.influxdata.com/products/)，但也有其他不错的选择。

# javascript - 滚动时如何锁定表格的第一行和第一列，可能使用 JavaScript 和 CSS？

> ID：296020
> 
> 赞同：35
> 
> 时间：2008-11-17T16:17:26.213
> 
> 标签：javascript, css, excel, scroll, css-tables

当您激活“冻结窗格”时，如何创建一个第一行和第一列都被锁定的表，就像在 Excel 中一样？我需要表格水平和垂直滚动（存在很多解决方案，但只允许垂直滚动）。

因此，当您在表格中向下滚动时，第一行将保持不变，因为它将具有列标题。这可能最终会出现在 中`thead`，也可能不会出现在任何使解决方案更容易的情况下。

当您向右滚动时，第一列保持不变，因为它包含行的标签。

我很确定这仅靠 CSS 是不可能的，但谁能指出我的 JavaScript 解决方案？它需要在所有主流浏览器中工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-31T19:59:26.500

哦，好吧，我查找了带有固定列的可滚动表以了解此特定要求的需要，而您的问题就是其中之一，没有确切的答案..

我回答了这个问题[Large dynamicsized html table with a fixed scroll row and fixed scroll column](https://stackoverflow.com/questions/10838700/large-dynamically-sized-html-table-with-a-fixed-scroll-row-and-fixed-scroll-colu/10922732#10922732)这启发了我作为插件展示我的工作[https://github.com/meetselva/fixed-table-rows-cols](https://github.com/meetselva/fixed-table-rows-cols)

该插件基本上将格式良好的 HTML 表格转换为具有固定表格标题和列的可滚动表格。

用法如下，

```
$('#myTable').fxdHdrCol({
    fixedCols    : 3,       /* 3 fixed columns */
    width        : "100%",  /* set the width of the container (fixed or percentage)*/
    height       : 500      /* set the height of the container */
}); 
```

您可以在[此处查看演示和文档](http://meetselva.github.io/fixed-table-rows-cols/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-12T02:08:12.840

我通过以下组合做到了这一点：

*   使用多个表
*   固定大小的单元格
*   jQuery 的 scrollTop 和 scrollLeft 函数

这是一个[jsfiddle 示例](http://jsfiddle.net/software_christian/Fp9a3/8/)来演示。

尚未在所有浏览器上进行测试，但我想它在旧 IE 版本上不是很好。

```
$("#clscroll-content").scroll(function() {
    $("#clscroll-row-headers").scrollTop($("#clscroll-content").scrollTop());
    $("#clscroll-column-headers").scrollLeft($("#clscroll-content").scrollLeft());
});

$("#clscroll-column-headers").scroll(function() {
    $("#clscroll-content").scrollLeft($("#clscroll-column-headers").scrollLeft());
});

$("#clscroll-row-headers").scroll(function() {
    $("#clscroll-content").scrollTop($("#clscroll-row-headers").scrollTop());
});
```

```
.clscroll table {
    table-layout: fixed;
}

.clscroll td, .clscroll th { 
    overflow: hidden;
}

.corner-header {
    float: left;
}

.column-headers {
    float: left;
    overflow: scroll;
}

.row-headers {
    clear: both;
    float: left;    
    overflow: scroll;
}

.table-content {
    table-layout: fixed;
    float: left;
    overflow: scroll;
}

.clscroll td, .clscroll th { 
    width: 200px;
    border: 1px solid black;
}

.row-headers, .table-content {
    height: 100px;
}

.column-headers, .table-content, .table-content table, .column-headers table {
    width: 400px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="clscroll corner-header">
  <table>
      <tr>
          <th>&nbsp;</th>
      </tr>
  </table>
</div>
<div class="clscroll column-headers" id="clscroll-column-headers">
  <table>
      <tr>
          <th>Bus</th>
          <th>Plane</th>
          <th>Boat</th>
          <th>Bicycle</th>
      </tr>
  </table>
</div>
<div class="clscroll row-headers" id="clscroll-row-headers">
  <table>
      <tr>
          <th>Red</th>
      </tr>
      <tr>
          <th>Green</th>
      </tr>
      <tr>
          <th>Blue</th>
      </tr>
      <tr>
          <th>Orange</th>
      </tr>
      <tr>
          <th>Purple</th>
      </tr>
      <tr>
          <th>Yellow</th>
      </tr>
      <tr>
          <th>Pink</th>
      </tr>
      <tr>
          <th>Brown</th>
      </tr>
  </table>
</div>
<div class="clscroll table-content" id="clscroll-content">
  <table>
      <tr>
          <td>Red Bus</td>
          <td>Red Plane</td>
          <td>Red Boat</td>
          <td>Red Bicycle</td>
      </tr>
      <tr>
          <td>Green Bus</td>
          <td>Green Plane</td>
          <td>Green Boat</td>
          <td>Green Bicycle</td>
      </tr>
      <tr>
          <td>Blue Bus</td>
          <td>Blue Plane</td>
          <td>Blue Boat</td>
          <td>Blue Bicycle</td>
      </tr>
      <tr>
          <td>Orange Bus</td>
          <td>Orange Plane</td>
          <td>Orange Boat</td>
          <td>Orange Bicycle</td>
      </tr>
      <tr>
          <td>Purple Bus</td>
          <td>Purple Plane</td>
          <td>Purple Boat</td>
          <td>Purple Bicycle</td>
      </tr>
      <tr>
          <td>Yellow Bus</td>
          <td>Yellow Plane</td>
          <td>Yellow Boat</td>
          <td>Yellow Bicycle</td>
      </tr>
      <tr>
          <td>Pink Bus</td>
          <td>Pink Plane</td>
          <td>Pink Boat</td>
          <td>Pink Bicycle</td>
      </tr>
      <tr>
          <td>Brown Bus</td>
          <td>Brown Plane</td>
          <td>Brown Boat</td>
          <td>Brown Bicycle</td>
      </tr>
  </table>
</div>
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-13T13:06:01.323

您需要两个表，其中第一个是第二个的精确覆盖。第二个包含所有数据，其中第一个仅包含第一列。您必须同步它的宽度，并根据内容还同步它的行的高度。

除了这两个表之外，您还需要第三个表。那是第一行，正好位于其他两行之间，并且必须以相同的方式同步。

这里需要绝对定位。接下来，您将同步数据表的滚动与标题行和第一列表的滚动位置。

这在所有主流浏览器中都非常有效，除了一个问题：同步滚动会颤动。要解决这个问题，您需要两个外部 div 容器来保存标题行和第一列内容的克隆。垂直滚动时，显示标题行克隆以防止抖动，同时将原始行重新定位在背景中。水平滚动时，您将显示第一行克隆。这里也一样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-10-07T19:26:58.600

我在这里发布了我的 jQuery 插件解决方案：[Frozen table header inside scrollable div](https://stackoverflow.com/questions/486576/frozen-table-header-inside-scrollable-div/1533619#1533619)

它完全符合您的要求，并且非常轻巧且易于使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-10T12:11:03.737

今天有很多跨浏览器解决方案，其中有我喜欢的[SuperTable](http://www.matts411.com/post/super_tables/)，因为它的优雅和简单（现在继续使用 MooGrid）和[SlickGrid](https://github.com/mleibman/SlickGrid/wiki)的一组很棒的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T17:48:04.423

您必须对其进行测试，但是如果您在页面中嵌入了 iframe，然后使用 CSS 将 iframe 页面中的第一行和列绝对定位在 0,0，这会解决您的问题吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-23T06:22:33.970

这里有一个插件 JQuery：[https ://github.com/nitsugario/jQuery-Freeze-Table-Column-and-Rows](https://github.com/nitsugario/jQuery-Freeze-Table-Column-and-Rows)

这是一个 jQuery 插件，可以让表格的行和列不滚动。它可以获取给定的 HTML 表格对象并将其设置为可以冻结给定数量的列或行或两者，因此固定的列或行不会滚动。要冻结的行应该放在表头部分。它还可以结合使用 colspan 或 rowspan 属性来冻结行和列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T16:19:42.997

将表的实际“数据”放在自己的 div 中的解决方案怎么样`overflow: scroll;`？然后浏览器将自动为您不想锁定的“表格”部分创建滚动条，您可以将“表格标题”/第一行放在其上方`<div>`。

不知道这将如何与水平滚动一起工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-17T16:27:11.827

[排序和锁定表](https://jsfiddle.net/58szxy5o/1/)是我见过的唯一在 IE 以外的其他浏览器上工作的解决方案。（尽管这个“[锁定列 css](http://www.webdeveloper.com/forum/showthread.php?t=105305) ”也可以解决问题）。下面需要的代码块。

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <script type="text/javascript" src="/js/lib/dummy.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/result-light.css">
  <style type="text/css">
    /* Scrollable Content Height */
.scrollContent {
 height:100px;
 overflow-x:hidden;
 overflow-y:auto;
}
.scrollContent tr {
 height: auto;
 white-space: nowrap;
}

/* Prevent Mozilla scrollbar from hiding right-most cell content */
.scrollContent tr td:last-child {
 padding-right: 20px;
}

/* Fixed Header Height */
.fixedHeader tr {
 position: relative;
 height: auto;
}

/* Put border around entire table */
div.TableContainer {
 border: 1px solid #7DA87D;
}

/* Table Header formatting */
.headerFormat {
 background-color: white;
 color: #FFFFFF;
 margin: 3px;
 padding: 1px;
 white-space: nowrap;
 font-family: Helvetica;
 font-size: 16px;
 text-decoration: none;
 font-weight: bold;
}
.headerFormat tr td {
 border: 1px solid #000000;
 background-color: #7DA87D;
}

/* Table Body (Scrollable Content) formatting */
.bodyFormat tr td {
    color: #000000;
    margin: 3px;
    padding: 1px;
    border: 0px none;
    font-family: Helvetica;
    font-size: 12px;
}

/* Use to set different color for alternating rows */
.alternateRow {
  background-color: #E0F1E0;
}

/* Styles used for SORTING */
.point {
 cursor:pointer;
}
td.sortedColumn {
  background-color: #E0F1E0;
}

tr.alternateRow td.sortedColumn {
  background-color: #c5e5c5;
}
.total {
    background-color: #FED362;
    color: #000000;
    white-space: nowrap;
    font-size: 12px;
    text-decoration: none;
}
  </style>

  <title></title>
<script type='text/javascript'>//<![CDATA[

/* This script and many more are available free online at
The JavaScript Source :: http://www.javascriptsource.com
Created by: Stan Slaughter :: http://www.stansight.com/ */

/* ======================================================
Generic Table Sort

Basic Concept: A table can be sorted by clicking on the title of any
column in the table, toggling between ascending and descending sorts.

Assumptions:

* The first row of the table contains column titles that are "clicked"
  to sort the table

* The images 'desc.gif','asc.gif','none.gif','sorting.gif' exist

* The img tag is in each column of the the title row to represent the
  sort graphic.

* The CSS classes 'alternateRow' and 'sortedColumn' exist so we can
  have alternating colors for each row and a highlight the sorted
  column.  Something like the <style> definition below, but with the
  background colors set to whatever you want.

   <style>
   tr.alternateRow {
     background-color: #E0F1E0;
   }

   td.sortedColumn {
     background-color: #E0F1E0;
   }

   tr.alternateRow td.sortedColumn {
     background-color: #c5e5c5;
   }
   </style>

====================================================== */

function sortTable(td_element,ignoreLastLines) {

  // If the optional ignoreLastLines parameter (number of lines *not* to sort at end of table)
  // was not passed then make it 0
  ignoreLastLines = (typeof(ignoreLastLines)=='undefined') ? 0 : ignoreLastLines;

  var sortImages =['data:image/gif;base64,R0lGODlhCgAKAMQXAJOkk3mReXume3uTe3mieXGPcXOYc/Hx8Xadds/Wz9vg24ejh3GUcYOgg6a0pnGVcfP18+3w7c3TzdPY06u4q/r8+v///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAABcALAAAAAAKAAoAAAUz4IVcZDleixQIQjA1pFFZx2FVRklZvOWUl8LsVgBeFLyE8TLgDZYESISwvAAA1QvjAQwBADs=','data:image/gif;base64,R0lGODlhCgAKAMQXAJOkk3mReXume3uTe3mieXGPcXOYc/Hx8Xadds/Wz9vg24ejh3GUcYOgg6a0pnGVcfP18+3w7c3TzdPY06u4q/r8+v///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAABcALAAAAAAKAAoAAAUw4CVeDzOeFwCgIhFBBDtY1sAmtIIWFV0VJweNRhkZeoeDpWIQNSYBgSAgWYgQLGwIADs=','data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7','http://web.archive.org/web/20150906203819im_/http://www.javascriptsource.com/miscellaneous/sorting.gif'];

  // Get the image used in the first row of the current column
  var sortColImage = td_element.getElementsByTagName('img')[0];

  // If current image is 'asc.gif' or 'none.gif' (elements 1 and 2 of sortImages array) then this will
  // be a descending sort else it will be ascending - get new sort image icon and set sort order flag
  var sortAscending = false;
  var newSortColImage = "";
  if (sortColImage.getAttribute('src').indexOf(sortImages[1])>-1 ||
    sortColImage.getAttribute('src').indexOf(sortImages[2])>-1) {
    newSortColImage = sortImages[0];
    sortAscending = false;
  } else {
    newSortColImage = sortImages[1];
    sortAscending = true;
  }

  // Assign "SORTING" image icon (element 3 of sortImages array)) to current column title
  // (will replace with newSortColImage when sort completes)
  sortColImage.setAttribute('src',sortImages[3]);

  // Find which column was clicked by getting it's column position
  var indexCol = td_element.cellIndex;

  // Get the table element from the td element that was passed as a parameter to this function
  var table_element = td_element.parentNode;
  while (table_element.nodeName != "TABLE") {
    table_element = table_element.parentNode;
  }

  // Get all "tr" elements from the table and assign then to the Array "tr_elements"
  var tr_elements = table_element.getElementsByTagName('tr');

  // Get all the images used in the first row then set them to 'none.gif'
  // (element 2 or sortImages array) except for the current column (all ready been changed)
  var allImg = tr_elements[0].getElementsByTagName('img');
    for(var i=0;i<allImg.length;i++){
    if(allImg[i]!=sortColImage){allImg[i].setAttribute('src',sortImages[2])}
  }

  // Some explantion of the basic concept of the following code before we
  // actually start.  Essentially we are going to copy the current columns information
  // into an array to be sorted. We'll sort the column array then go back and use the information
  // we saved about the original row positions to re-order the entire table.
  // We are never really sorting more than a columns worth of data, which should keep the sorting fast.

  // Create a new array for holding row information
  var clonedRows = new Array()

  // Create a new array to store just the selected column values, not the whole row
  var originalCol = new Array();

  // Now loop through all the data row elements
  // NOTE: Starting at row 1 because row 0 contains the column titles
  for (var i=1; i<tr_elements.length - ignoreLastLines; i++) {

   // "Clone" the tr element i.e. save a copy all of its attributes and values
   clonedRows[i]=tr_elements[i].cloneNode(true);

   // Text value of the selected column on this row
   var valueCol = getTextValue(tr_elements[i].cells[indexCol]);

   // Format text value for sorting depending on its type, ie Date, Currency, number, etc..
   valueCol = FormatForType(valueCol);

   // Assign the column value AND the row number it was originally on in the table
   originalCol[i]=[valueCol,tr_elements[i].rowIndex];
  }

  // Get rid of element "0" from this array.  A value was never assigned to it because the first row
  // in the table just contained the column titles, which we did not bother to assign.
  originalCol.shift();

  // Sort the column array returning the value of a sort into a new array
  sortCol = originalCol.sort(sortCompare);

  // If it was supposed to be an Ascending sort then reverse the order
  if (sortAscending) { sortCol.reverse(); }

  // Now take the values from the sorted column array and use that information to re-arrange
  // the order of the tr_elements in the table
  for (var i=1; i < tr_elements.length - ignoreLastLines; i++) {

    var old_row = sortCol[i-1][1];
    var new_row = i;
    tr_elements[i].parentNode.replaceChild(clonedRows[old_row],tr_elements[new_row]);
  }

   // Format the table, making the rows alternating colors and highlight the sorted column
   makePretty(table_element,indexCol,ignoreLastLines);

  // Assign correct sort image icon to current column title
  sortColImage.setAttribute('src',newSortColImage);
}

// Function used by the sort routine to compare the current value in the array with the next one
function sortCompare (currValue, nextValue) {
 // Since the elements of this array are actually arrays themselves, just sort
 // on the first element which contiains the value, not the second which contains
 // the original row position
  if ( currValue[0] == nextValue[0] ) return 0;
  if ( currValue[0] < nextValue[0] ) return -1;
  if ( currValue[0] > nextValue[0] ) return 1;
}

//-----------------------------------------------------------------------------
// Functions to get and compare values during a sort.
//-----------------------------------------------------------------------------

// This code is necessary for browsers that don't reflect the DOM constants
// (like IE).
if (document.ELEMENT_NODE == null) {
   document.ELEMENT_NODE = 1;
   document.TEXT_NODE = 3;
}

function getTextValue(el) {
  var i;
  var s;
  // Find and concatenate the values of all text nodes contained within the
  // element.
  s = "";
  for (i = 0; i < el.childNodes.length; i++)
    if (el.childNodes[i].nodeType == document.TEXT_NODE)
      s += el.childNodes[i].nodeValue;
    else if (el.childNodes[i].nodeType == document.ELEMENT_NODE &&
             el.childNodes[i].tagName == "BR")
      s += " ";
    else
      // Use recursion to get text within sub-elements.
      s += getTextValue(el.childNodes[i]);

  return normalizeString(s);
}

// Regular expressions for normalizing white space.
var whtSpEnds = new RegExp("^\\s*|\\s*$", "g");
var whtSpMult = new RegExp("\\s\\s+", "g");

function normalizeString(s) {
  s = s.replace(whtSpMult, " ");  // Collapse any multiple whites space.
  s = s.replace(whtSpEnds, "");   // Remove leading or trailing white space.
  return s;
}

// Function used to modify values to make then sortable depending on the type of information
function FormatForType(itm) {
  var sortValue = itm.toLowerCase();

  // If the item matches a date pattern (MM/DD/YYYY or MM/DD/YY or M/DD/YYYY)
  if (itm.match(/^\d\d[\/-]\d\d[\/-]\d\d\d\d$/) ||
      itm.match(/^\d\d[\/-]\d\d[\/-]\d\d$/) ||
      itm.match(/^\d[\/-]\d\d[\/-]\d\d\d\d$/) ) {

    // Convert date to YYYYMMDD format for sort comparison purposes
    // y2k notes: two digit years less than 50 are treated as 20XX, greater than 50 are treated as 19XX
    var yr = -1;

    if (itm.length == 10) {
      sortValue = itm.substr(6,4)+itm.substr(0,2)+itm.substr(3,2);
     } else if (itm.length == 9) {
      sortValue = itm.substr(5,4)+"0" + itm.substr(0,1)+itm.substr(2,2);
    } else {
      yr = itm.substr(6,2);
      if (parseInt(yr) < 50) {
        yr = '20'+yr;
      } else {
        yr = '19'+yr;
      }
        sortValue = yr+itm.substr(3,2)+itm.substr(0,2);
    }

  }

  // If the item matches a Percent patten (contains a percent sign)
  if (itm.match(/%/)) {
   // Replace anything that is not part of a number (decimal pt, neg sign, or 0 through 9) with an empty string.
   sortValue = itm.replace(/[^0-9.-]/g,'');
   sortValue = parseFloat(sortValue);
  }

  // If item starts with a "(" and ends with a ")" then remove them and put a negative sign in front
  if (itm.substr(0,1) == "(" & itm.substr(itm.length - 1,1) == ")") {
   itm = "-" + itm.substr(1,itm.length - 2);
  }

// If the item matches a currency pattern (starts with a dollar or negative dollar sign)
  if (itm.match(/^[£$]|(^-)/)) {
   // Replace anything that is not part of a number (decimal pt, neg sign, or 0 through 9) with an empty string.
   sortValue = itm.replace(/[^0-9.-]/g,'');
   if (isNaN(sortValue)) {
     sortValue = 0;
   } else {
     sortValue = parseFloat(sortValue);
   }
}

  // If the item matches a numeric pattern
  if (itm.match(/(\d*,\d*$)|(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/)) {
   // Replace anything that is not part of a number (decimal pt, neg sign, or 0 through 9) with an empty string.
   sortValue = itm.replace(/[^0-9.-]/g,'');
 //  sortValue = sortValue.replace(/,/g,'');
   if (isNaN(sortValue)) {
     sortValue = 0;
   } else {
     sortValue = parseFloat(sortValue);
   }
  }

  return sortValue;
}

//-----------------------------------------------------------------------------
// Functions to update the table appearance after a sort.
//-----------------------------------------------------------------------------

// Style class names.
var rowClsNm = "alternateRow";
var colClsNm = "sortedColumn";

// Regular expressions for setting class names.
var rowTest = new RegExp(rowClsNm, "gi");
var colTest = new RegExp(colClsNm, "gi");

function makePretty(tblEl, col, ignoreLastLines) {

  var i, j;
  var rowEl, cellEl;

  // Set style classes on each row to alternate their appearance.
  for (i = 1; i < tblEl.rows.length - ignoreLastLines; i++) {
   rowEl = tblEl.rows[i];
   rowEl.className = rowEl.className.replace(rowTest, "");
    if (i % 2 != 0)
      rowEl.className += " " + rowClsNm;
    rowEl.className = normalizeString(rowEl.className);
    // Set style classes on each column (other than the name column) to
    // highlight the one that was sorted.
    for (j = 0; j < tblEl.rows[i].cells.length; j++) {
      cellEl = rowEl.cells[j];
      cellEl.className = cellEl.className.replace(colTest, "");
      if (j == col)
        cellEl.className += " " + colClsNm;
      cellEl.className = normalizeString(cellEl.className);
    }
  }

}

// END Generic Table sort.

// =================================================

// Function to scroll to top before sorting to fix an IE bug
// Which repositions the header off the top of the screen
// if you try to sort while scrolled to bottom.
function GoTop() {
 document.getElementById('TableContainer').scrollTop = 0;
}

//]]> 
</script>
</head>
<body>
  <table cellpadding="0" cellspacing="0" border="0">
<tr><td>
<div id="TableContainer" class="TableContainer" style="height:230px;">
<table class="scrollTable">
 <thead class="fixedHeader headerFormat">
  <tr>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort"><b>NAME</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort" align="right"><b>Amt</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort" align="right"><b>Lvl</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort" align="right"><b>Rank</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort" align="right"><b>Position</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
   <td class="point" onclick="GoTop(); sortTable(this,1);" title="Sort" align="right"><b>Date</b> <img src="data:image/gif;base64,R0lGODlhCgAKALMLAHaRdnCTcHegd7C8sNTa1Ku4q9vg24GXgfr8+uDl4P///////wAAAAAAAAAAAAAAACH5BAEAAAsALAAAAAAKAAoAAAQfcMlJq12hIHKoSEqIdBIQnslknkoqfedIBQNikFduRQA7" border="0"></td>
  </tr>
 </thead>
 <tbody class="scrollContent bodyFormat" style="height:200px;">
   <tr class="alternateRow">
    <td>Maha</td>
    <td align="right">$19,923.19</td>
    <td align="right">100</td>
    <td align="right">100</td>
    <td>Owner</td>
    <td align="right">01/02/2001</td>
   </tr>
   <tr>
    <td>Thrawl</td>
    <td align="right">$9,550</td>
    <td align="right">159</td>
    <td align="right">100%</td>
    <td>Co-Owner</td>
    <td align="right">11/07/2003</td>
   </tr>
   <tr class="alternateRow">
    <td>Marhanen</td>
    <td align="right">$223.04</td>
    <td align="right">83</td>
    <td align="right">99%</td>
    <td>Banker</td>
    <td align="right">06/27/2006</td>
   </tr>
   <tr>
    <td>Peter</td>
    <td align="right">$121</td>
    <td align="right">567</td>
    <td align="right">23423%</td>
    <td>FishHead</td>
    <td align="right">06/06/2006</td>
   </tr>
   <tr class="alternateRow">
    <td>Jones</td>
    <td align="right">$15</td>
    <td align="right">11</td>
    <td align="right">15%</td>
    <td>Bubba</td>
    <td align="right">10/27/2005</td>
   </tr>
   <tr>
    <td>Supa-De-Dupa</td>
    <td align="right">$145</td>
    <td align="right">91</td>
    <td align="right">32%</td>
    <td>momma</td>
    <td align="right">12/15/1996</td>
   </tr>
   <tr class="alternateRow">
    <td>ClickClock</td>
    <td align="right">$1,213</td>
    <td align="right">23</td>
    <td align="right">1%</td>
    <td>Dada</td>
    <td align="right">1/30/1998</td>
   </tr>
   <tr>
    <td>Mrs. Robinson</td>
    <td align="right">$99</td>
    <td align="right">99</td>
    <td align="right">99%</td>
    <td>Wife</td>
    <td align="right">07/04/1963</td>
   </tr>
   <tr class="alternateRow">
    <td>Maha</td>
    <td align="right">$19,923.19</td>
    <td align="right">100</td>
    <td align="right">100%</td>
    <td>Owner</td>
    <td align="right">01/02/2001</td>
   </tr>
   <tr>
    <td>Thrawl</td>
    <td align="right">$9,550</td>
    <td align="right">159</td>
    <td align="right">100%</td>
    <td>Co-Owner</td>
    <td align="right">11/07/2003</td>
   </tr>
   <tr class="alternateRow">
    <td>Marhanen</td>
    <td align="right">$223.04</td>
    <td align="right">83</td>
    <td align="right">59%</td>
    <td>Banker</td>
    <td align="right">06/27/2006</td>
   </tr>
   <tr>
    <td>Peter</td>
    <td align="right">$121</td>
    <td align="right">567</td>
    <td align="right">534.23%</td>
    <td>FishHead</td>
    <td align="right">06/06/2006</td>
   </tr>
   <tr class="alternateRow">
    <td>Jones</td>
    <td align="right">$15</td>
    <td align="right">11</td>
    <td align="right">15%</td>
    <td>Bubba</td>
    <td align="right">10/27/2005</td>
   </tr>
   <tr>
    <td>Supa-De-Dupa</td>
    <td align="right">$145</td>
    <td align="right">91</td>
    <td align="right">42%</td>
    <td>momma</td>
    <td align="right">12/15/1996</td>
   </tr>
   <tr class="alternateRow">
    <td>ClickClock</td>
    <td align="right">$1,213</td>
    <td align="right">23</td>
    <td align="right">2%</td>
    <td>Dada</td>
    <td align="right">1/30/1998</td>
   </tr>
   <tr>
    <td>Mrs. Robinson</td>
    <td align="right">$99</td>
    <td align="right">99</td>
    <td align="right">(-10.42%)</td>
    <td>Wife</td>
    <td align="right">07/04/1963</td>
   </tr>
   <tr class="alternateRow">
    <td>Maha</td>
    <td align="right">-$19,923.19</td>
    <td align="right">100</td>
    <td align="right">(-10.01%)</td>
    <td>Owner</td>
    <td align="right">01/02/2001</td>
   </tr>
   <tr>
    <td>Thrawl</td>
    <td align="right">$9,550</td>
    <td align="right">159</td>
    <td align="right">-10.20%</td>
    <td>Co-Owner</td>
    <td align="right">11/07/2003</td>
   </tr>
   <tr class="total">
    <td><strong>TOTAL</strong>:</td>
    <td align="right"><strong>999999</strong></td>
    <td align="right"><strong>9999999</strong></td>
    <td align="right"><strong>99</strong></td>
    <td > </td>
    <td align="right"> </td>
   </tr>
 </tbody>
</table>
</div>
</td></tr>
</table>
</body>
</html> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-13T07:45:50.053

它实际上可以在没有 JavaScript 的情况下使用，但使用带有粘性位置的纯 CSS + HTML。只需将“位置：粘性”添加到您要冻结的单元格中。

对于构建表格，您可以使用 CSS 网格或 CSS 网格，并且此技术适用于它们。

这是带有表格标签的示例格式（此处为[现场演示](https://codepen.io/tkirby/pen/gOMZJJB?editors=1100)）：

```
<table>
  <tr><th class="head"></th class="head"><th></th> ... </tr>
  <tr><th class="head"></th>             <th></th> ... </tr>
...
</table>
<style type="text/css">
  .head { position: sticky; top: 0; left: 0;}
</style> 
```

这是一个 CSS Grid 的例子（这里是[现场演示](https://codepen.io/tkirby/pen/rNLogXM?editors=1100)）：

```
<div class="grid">
   <!-- cells to freeze -->
   <div class="entry head"></div>
   <div class="entry head"></div>
   ...
   <!-- normal cells -->
   <div class="entry"></div>
   ...
</div>
<style type="text/css">
  .grid {
    display: grid;
    grid-template-columns: repeat(<your-cell-count>, <cell-size>); 
  } 
  .entry.head { position: sticky; top: 0; left: 0 }
</style> 
```

您可能需要处理水平和垂直冻结的单元格（例如，设置比其他更大的 z-index ），但它仍然是 CSS 的东西。

我认为这种方法的主要缺点可能是浏览器兼容性问题。在使用这些技术之前检查[我可以使用 CSS-sticky](https://caniuse.com/css-sticky)和[我可以使用 CSS 网格。](https://caniuse.com/?search=grid)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-10-14T02:54:32.563

这是我制作的一个纯 javascript/css。

[https://jsfiddle.net/KirbyLWallace/x5sbe0dk/5/](https://jsfiddle.net/KirbyLWallace/x5sbe0dk/5/)

它旨在用于全宽屏幕，但我已经修改以适合小提琴的特定宽度。

```
<body onResize="scaleElements()">

<div id="table-container-div">

<table id="data-table">
  <thead id="th-header">
    <tr id="th-header-row">
      <td>Column1</td>
      <td>Column2</td>
      <td>Column3</td>
      <td>Column4</td>
    </tr>
  </thead>

  <tbody id="tbl-body">
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
    <tr><td>a</td><td>b</td><td>c</td><td>d</td></tr>
    <tr><td>1</td><td>2</td><td>3</td><td>4</td></tr>
    <tr><td>h</td><td>i</td><td>j</td><td>k</td></tr>
  </tbody>

</table> 
```

javascript:

```
(() => {
        scaleElements();  
    })();

  function scaleElements() {

        // element() is just shorthand for document.getElementById().

        // scaleElements() scales a number of other things, not included here, 
        // that get rescaled any time the browser, or a container is resized.
        // the table header row here is just one of them...
        //
        // this thing includes checks to see if a table with the table & thead 
        // is on the page.  If it is, it checks to see if the span container is
        // here (it's not on the first run, but it is on subsequent calls.  So, 
        // it adds it if it needs it, or reuses it if it's there.

        if (element("data-table")) {

            if (element("th-span-container")) {
                element("th-span-container").parentElement.removeChild(element("th-span-container"));
            }

            var x = document.createElement("div");
                x.id = "th-span-container";
                x.style.cssFloat = "left";
                x.style.position = "fixed";
                x.style.top = "10px";

                // you will want to fiddle with your own particular positioning. 
                // this one is positioned to work on a table that is below a page 
                // logo banner.

            var tds = element("th-header-row").getElementsByTagName("td");

            for (i = 0; i < tds.length; i++) {

                let z = tds[i];
                let y = document.createElement("span");

                y.style.padding = "0px";
                y.style.margin = "0px";
                y.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
                y.style.fontSize = "13px";
                y.style.border = "0px";
                y.style.position = "absolute";
                y.style.color = "white";
                y.style.backgroundColor = "#3D6588";
                y.style.left = z.offsetLeft + "px";
                y.style.height = z.offsetHeight + "px";
                y.style.lineHeight = z.offsetHeight + "px";
                y.style.width = z.offsetWidth + "px";
                y.innerHTML = z.innerHTML;
                x.appendChild(y);

            }

            element("table-container-div").appendChild(x);
            element("th-header-row").style.visibility = "hidden";

        }

    }

function element(e) {
    return document.getElementById(e);
} 
```

CSS：

```
body {
  background: black;
}

#table-container-div {
            width: 310px;
            position: absolute;
            top: 10px;
            bottom: 10px;
            overflow-x: hidden;
            overflow-y: auto;
            min-width: 320px;
        }

        table {
            font-size: 13px;
            height: 120px;
            width: 300px;
            border: 0px solid red;
            background-color: #11171F;
        }

        tr {
            height: 22px;
            color: #cff3ff;
        }

            tr:hover {
                background-color: dimgrey;
            }

        td {
          color:white;
            border-right: 1px dotted #4F4F4F;
        }

        #th-header-row {
            background-color: #3D6588;
            color: white;
        } 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-11-17T16:42:21.343

几周前我跑过一个网站。这是第一列锁定的工作示例，但它与 Firefox 不兼容。我没有做很多检查，但它似乎只适用于 IE。作者提供了一些注释，您可以阅读。

锁定第一列： [http ://home.tampabay.rr.com/bmerkey/examples/locked-column-csv.html](http://home.tampabay.rr.com/bmerkey/examples/locked-column-csv.html)

如果您也需要 Javascript 来锁定表格标题，请告诉我。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-09-25T17:03:24.003

你可以做到，无需 javascript

看到这个链接：http: [//yonax73.blogspot.com/2014/09/tabla-con-cabecera-estatica-cuerpo-con.html](http://yonax73.blogspot.com/2014/09/tabla-con-cabecera-estatica-cuerpo-con.html)

或现场演示：http: [//jsfiddle.net/yonatanalexis22/aeeme8mt/7/](http://jsfiddle.net/yonatanalexis22/aeeme8mt/7/)

```
table{
border-spacing: 0;
display: flex;/*Se ajuste dinamicamente al tamano del dispositivo**/
max-height: 40vh; /*El alto que necesitemos**/
overflow-y: auto; /**El scroll verticalmente cuando sea necesario*/
overflow-x: hidden;/*Sin scroll horizontal*/
table-layout: fixed;/**Forzamos a que las filas tenga el mismo ancho**/
width: 98vw; /*El ancho que necesitemos*/
border:1px solid gray;} 
```

# video - 网站中的视频

> ID：296025
> 
> 赞同：3
> 
> 时间：2008-11-17T16:18:30.300
> 
> 标签：video

我正在为希望在其网站上发布视频的客户准备项目提案。我需要定义允许哪些视频格式、哪些视频大小以及转换和准备所需的工具。

我没有在网站中嵌入视频的经验，所以我需要哪些标记才能在线播放视频？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T16:28:09.000

您可以使用 Flash 播放器嵌入它们，例如 Youtube。

一个快速的方法是使用一些已经制作好的播放器，比如优秀的[JW FLV Player](http://www.jeroenwijering.com/?item=JW_FLV_Player)，非商业项目免费，商业项目非常便宜。

它支持 FLV 和 MP4 视频文件，您可以通过多种方式转换这种格式的视频，例如使用[ffmpegx](http://www.ffmpegx.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T16:28:15.897

对于您的大部分要求，我建议您查看 Camtasia：

[http://www.techsmith.com/camtasia.asp](http://www.techsmith.com/camtasia.asp)

如果您只需要嵌入 Flash。页面中的 FLV 文件，然后是 JW Media Player for Flash：

[http://www.jeroenwijering.com/](http://www.jeroenwijering.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T16:36:52.010

这里值得一提的是使用媒体播放器插件嵌入视频的示例。

`<embed src="http://aaa/bbb/ccc/myVideo.wmv" type="application/x-mplayer2" pluginspage="http://www.microsoft.com/Windows/MediaPlayer/" name="MediaPlayer" autostart="1" showcontrols="1" showstatusbar="0" autorewind="1" showdisplay="0" height="256" width="320">`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T16:51:37.580

顺便说一句，您可能想看看[Panda](http://pandastream.com/)。除了视频转码功能外，还有关于如何在您的网站上嵌入视频文件的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T16:58:07.600

查看[Microsoft Expression Studio 2](http://www.microsoft.com/expression/products/overview.aspx?key=encoder#page-top)。他们提供了一个编码器，可以对各种电影格式进行编码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T01:21:21.747

我支持 Davide Gualano 在上面的回答。

确保您让您的客户了解视频的大小（查看 vimeo，然后您可以了解大小、长度和质量），并计算出他们期望在视频上获得多少流量。

对于低估这一领域的人来说，带宽可能会成为一项巨大的成本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-11T04:19:57.150

使用 YouTube 或 Vimeo 作为您的主机。YouTube 或 Vimeo 的规格无关紧要。他们只接受大约类型的视频容器/编解码器。当他们说什么尺寸时……把你得到的最优质的东西发给我……把它上传到你的主机（youtube、vimeo），让他们施展魔法将它转换成适合用户的任何格式。始终为编码器提供最高质量的材料...一旦视频被压缩，您将永远无法取回该数据。

# python - python 是否会在多次导入模块时优化模块？

> ID：296036
> 
> 赞同：61
> 
> 时间：2008-11-17T16:21:43.257
> 
> 标签：python, python-import

如果您的代码的某个子模块加载了一个大模块，那么从该命名空间引用该模块而不是再次导入它有什么好处？

例如：我有一个模块MyLib，它广泛使用了ReallyBigLib。如果我有导入 MyLib 的代码，我应该像这样挖掘模块吗

```
import MyLib
ReallyBigLib = MyLib.SomeModule.ReallyBigLib 
```

要不就

```
import MyLib
import ReallyBigLib 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-11-17T16:27:04.760

Python模块可以被视为单例......无论您导入它们多少次，它们都只会被初始化一次，所以最好这样做：

```
import MyLib
import ReallyBigLib 
```

进口声明的相关文件：

[https://docs.python.org/2/reference/simple_stmts.html#the-import-statement](https://docs.python.org/2/reference/simple_stmts.html#the-import-statement)

> 一旦知道模块的名称（除非另有说明，术语“模块”将指包和模块），就可以开始搜索模块或包。检查的第一个地方是 sys.modules，之前已导入的所有模块的缓存。如果在那里找到模块，则在导入的步骤 (2) 中使用它。

导入的模块缓存在[sys.modules 中](https://docs.python.org/2/library/sys.html#sys.modules)：

> 这是一个将模块名称映射到已经加载的模块的字典。这可以被操纵以强制重新加载模块和其他技巧。请注意，从该字典中删除模块与在相应模块对象上调用 reload() 不同。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-11-18T08:01:14.123

正如其他人指出的那样，Python 维护了一个所有已导入模块的内部列表。当你第一次导入一个模块时，模块（一个脚本）在它自己的命名空间中执行直到结束，内部列表被更新，并在导入语句之后继续执行。

试试这个代码：

```
 # module/file a.py
   print "Hello from a.py!"
   import b

   # module/file b.py
   print "Hello from b.py!"
   import a 
```

没有循环：只有缓存查找。

```
>>> import b
Hello from b.py!
Hello from a.py!
>>> import a
>>> 
```

Python 的优点之一是如何将一切都转移到在命名空间中执行脚本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-17T16:27:44.570

它没有实质性的区别。如果已经加载了大模块，则第二个示例中的第二个导入除了将“ReallyBigLib”添加到当前命名空间之外什么都不做。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-04T21:50:58.507

警告：Python 不保证模块不会被初始化两次。我遇到过这样的问题。见讨论： [http ://code.djangoproject.com/ticket/8193](http://code.djangoproject.com/ticket/8193)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-19T09:00:41.897

导入模块的内部注册表是`sys.modules`字典，它将模块名称映射到模块对象。您可以在那里查看当前导入的所有模块。

您还可以通过猴子来获取一些有用的技巧（如果需要）`sys.modules`- 例如将您自己的对象添加为可以由其他模块导入的伪模块。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-17T16:24:20.023

在性能方面是相同的。Python 中还没有 JIT 编译器。

# alias - 在 IPython 中，如何为 %magics 创建别名？

> ID：296055
> 
> 赞同：7
> 
> 时间：2008-11-17T16:25:58.863
> 
> 标签：alias, ipython, magic-function

假设我想为 %edit -x 创建别名 %xed。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T12:01:15.957

上面给出的答案使用了旧的魔法系统。`get_ipython().expose_magic`死了。您现在只需为所有这些导入和使用装饰器。

有关更多详细信息，请参见[此处](http://ipython.org/ipython-doc/dev/api/generated/IPython.core.magic_arguments.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T17:55:39.853

**更新：**第一个响应（下面）不接受参数。所以把这个片段放在 ipy_user_conf.py 文件的末尾（它在你的主目录中）。

```
def ed_xed(self,arg):
    ip = self.api
    return ip.magic.im_class.magic_edit(ip.IP," -x %s "%arg)

ip.expose_magic('xed',ed_xed) 
```

**更新前：** 必须是 %magic 吗？您可以使用宏和存储魔术来重现此行为，而无需魔术 %。

```
In [5]: %edit -x
In [6]: macro xed 5
In [7]: store xed
In [8]: xed 
```

对于文档中的魔术别名（ %magic? ）：

> 您还可以为魔术函数定义自己的别名。在您的 ipythonrc 文件中，放置如下一行：
> 
> 执行**IPYTHON** .magic_pf = **IPYTHON** .magic_profile
> 
> 将 %pf 定义为 %profile 的新名称。

但我不知道如何添加参数。

# c# - 如何检查 asp:TextBox 不包含 html 标签

> ID：296065
> 
> 赞同：0
> 
> 时间：2008-11-17T16:27:46.037
> 
> 标签：c#, .net, validation

我有一个文本框，需要验证它是纯文本不包含 html 标签。

在.net中做这件事的最好方法是什么

奖励问题：如何用 javascript 做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T21:33:00.837

您可以允许输入它，然后在对输入进行任何操作之前，您可以使用 HttpServerUtility.HtmlEncode 类将其全部转换，这样当您重新渲染它时（如在评论中），它不会是原始的HTML，而是它的编码呈现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T21:29:21.793

为什么不转义/编码任何 html，您将获得 1001 种不同的方法来使用 RegEx 检测 html，但大多数都会在某些方面存在缺陷。如果转义不是一种选择，那么您最好的选择可能是在问题上加上 RegEx 标签并进入标题以吸引一些专家。

# php - 您可以使用 Doctrine 从现有表生成迁移吗？

> ID：296078
> 
> 赞同：1
> 
> 时间：2008-11-17T16:30:52.817
> 
> 标签：php, doctrine, migration

是否可以从 Doctrine 中的表模式自动生成迁移脚本？

例如，在新功能的大量开发过程中，我通常会在编写初始代码时首先构建我的表。我通常不会创建迁移来开始，因为表的定义可能会随着功能仍处于初级阶段而发生变化。一旦功能准备好提交，我将编写一个迁移来为新功能生成表结构。通常，会有几个新表。

叫我懒惰，但如果可以自动构建这些迁移，那就太棒了。

例如：

教义构建迁移表名

有什么东西可以完成这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:54:35.823

这（或类似的东西）出现在 Doctrine 1.1 中，您可以从教义网站获得预览版本。

见： http: [//www.doctrine-project.org/blog/new-to-migrations-in-1-1](http://www.doctrine-project.org/blog/new-to-migrations-in-1-1)

# asp.net - 是否可以使用标记将 ScriptReference 添加到母版页 CompositeScript？

> ID：296083
> 
> 赞同：1
> 
> 时间：2008-11-17T16:32:45.403
> 
> 标签：asp.net, master-pages

我想在我的母版页中使用 ScriptManager 和 CompositeScript 组件来包含站点范围的 javascript，但在我的“Web 内容表单”中添加到该列表中。我确信这可以在代码隐藏中完成，但最好我想在标记中完成。这种事情可以做吗？

在：MasterPage.master

```
<asp:ScriptManager ID="ScriptManager" runat="server" EnableScriptCombine="True">
    <CompositeScript>
        <Scripts>
            <asp:ScriptReference name="" Assembly="" Path="/client/js/main.js"/>      
        </Scripts>
    </CompositeScript>
</asp:ScriptManager> 
```

在：内容.aspx

```
<asp:ScriptReference name="" Assembly="" Path="/client/js/other.js"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T18:37:41.097

尝试使用`<asp:ScriptManagerProxy>`标签。它具有与脚本管理器相同的子标签，但它旨在用于内容表单。（您不会收到“每页只有一个 ScriptManager”错误）

我不确定这是否正是您要查找的内容，因为您通过 ScriptManagerProxy 添加的脚本仅在您添加它的 ContentForm 上可用（我认为）。它不会是网站范围的。但是，如果您需要它在站点范围内，为什么不直接将它添加到 MasterPage 中呢？

希望有帮助！

# ftp - 网络托管公司使用什么 FTP 协议/套件？

> ID：296089
> 
> 赞同：0
> 
> 时间：2008-11-17T16:34:10.860
> 
> 标签：ftp, sftp, shared-hosting

我最近遇到了一个奇怪的问题。

我的朋友聘请了一位设计师为他的公司设计一个网站。他向我推荐了一种允许网页设计师执行安全文件传输的工具，以便他可以更新网站。由于他在 Windows 2003 上托管，因此我立即建议启用 webdav，他确实这样做了，而且古老的“以 Web 文件夹形式打开”技巧运行良好。然而，Web desiner 就没有那么幸运了。他在 Vista 上工作，他们从 IE 中删除了“打开为 web 文件夹”选项，这也使得使用 webdav 变得非常困难。另一个问题是父亲证书已过期，而我尝试过的所有其他 3rd 方 webdav 解决方案并没有让我忽略这一事实，因此它使 webdav 通常不是将文件传输给外部承包商的好方法

我想，没有人会考虑传统的 FTP，因为它本质上是不安全的，并且需要 2 个端口，这是一开始就很糟糕的一个端口

我还评估了基于 ssh 的 SCP/SFTP。这些都很好，但是没有 chroot jail，它们可以访问整个文件系统。这对于 linux 是正确的，但对于基于 cygwin 的 openssh 安装似乎也是如此。

我尝试的最后一件事是 FileZilla。作为相当先进的 FTP 服务器，它显然不提供 SCP/SFTP 服务器功能。它允许通过 SSH 进行 FTP，但为此您需要再次购买证书。或者生成你的，但是你必须强迫你的承包商再次信任你的根，而不是安全选项

我想我们要问一个问题了——周围的人使用什么工具让他们的网络托管承包商（windows 或 linux）允许受控、安全的文件传输？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T17:26:16.637

很抱歉，但我不明白[创建用户、更改他们的 shell 并仅授予他们系统上的 SFTP 访问权限有](http://www.debian-administration.org/articles/94)什么问题。我过去这样做是为了让 Web 开发人员只能访问以在系统上上传文件，并且它工作得一尘不染。在 Windows 上，我倾向于使用[WinSCP](http://winscp.net/)通过 SFTP 上传文件（它也可以做普通的 FTP 和 SCP）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T17:05:31.017

SFTP 和 SCP 仅在该用户有权访问整个系统时才授予对整个系统的访问权限。您是给他自己的帐户还是让他以root身份登录？

我会在有问题的盒子上为开发人员提供他自己的帐户，然后根据他需要做的事情设置他的权限。

# c# - C# 创建隐藏事务

> ID：296090
> 
> 赞同：2
> 
> 时间：2008-11-17T16:34:22.920
> 
> 标签：c#, .net, dsl, dsl-tools

我正在为 VS2005 使用 C# 和 DSL 工具。

我需要创建事务来更改一些数据，但我希望它们对用户隐藏，这意味着不显示在 VS2005 的 UNDO 列表中。

我尝试禁用 UndoManager

```
store.UndoManager.UndoState = UndoState.Disabled; 
```

但是通过禁用它，撤消列表中所有现有的先前操作都将被清除。

事务有一个名为“isHidden”的属性，但它是只读的，我不知道如何将其设置为隐藏。我也尝试创建一个新的 UndoManager 但它也是一个只读属性......

如何创建未出现在撤消列表中的事务？

我很乐意写更多细节以澄清任何疑问，非常感谢你，Luís Filipe

[添加]

我根据属性值绘制每个形状的背景。例如，如果为真，则为绿色，如果为假，则为红色。我需要打开一个事务来绘制形状的背景，但对我来说它表现为一个计算的（只读）属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T11:52:22.857

`store.UndoManager.UndoState = UndoState.Disabled`;

几乎适合你想要的，

`store.UndoManager.UndoState = UndoState.DisabledNoFlush;`

这不会清除撤消列表的其余部分 :) Luis 午餐时的 cyas。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T22:36:17.053

恐怕我对你的问题没有确切的答案，但是......你确定你真的需要吗？大多数时候，您需要更改模型中的某些数据是为了对模型中的其他更改做出反应。如果是这种情况，您可能希望使用规则进行调查，以便在提交之前导致更改的规则上下文中获取现有事务，这样您就不需要首先创建新事务。

# java - 不兼容的类型错误 Java

> ID：296096
> 
> 赞同：0
> 
> 时间：2008-11-17T16:36:10.263
> 
> 标签：java, incompatibletypeerror

我正在使用 NetBeans IDE 用 Ja​​va 编写代码。我不断收到一些“不兼容的类型”错误。我将一个变量声明为字符串，然后将一个返回字符串的方法中的值分配给它。该错误表明应该有一种“String”类型，但找到了“...”，其中“...”是我调用的方法的名称。

例如，这是一条给我错误的行：

```
不兼容的类型
找到：encode_monoalphabetic_engine
必需：java.lang.String

编码 = encode_monoalphabetic_engine(string);

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T16:42:37.473

确保另一个方法也返回“java.lang.String”，而不是用户定义的对象“string”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T08:13:21.803

我认为编译器不会将 encode_monoalphabetic_engine 识别为方法/函数。也许你有一些命名冲突或错误的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T08:22:56.263

我同意 kd304，看起来程序无法识别方法调用。我假设“字符串”是您的字符串对象的变量名。只需确保您正确调用该方法并且该方法返回 String 数据类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T16:39:37.417

也许您可以发布更完整的代码片段？

看起来您的方法参数`string`不是`java.lang.String`?

# sql - 缓慢更新声明

> ID：296097
> 
> 赞同：3
> 
> 时间：2008-11-17T16:36:51.353
> 
> 标签：sql, oracle

我们正在处理 Oracle 项目中的一个非常缓慢的更新语句。

这是一个重现问题的小脚本：

```
drop table j_test;

CREATE TABLE J_TEST
(
  ID  NUMBER(10) PRIMARY KEY,
  C1   VARCHAR2(50 BYTE),
  C2   VARCHAR2(250 BYTE),
  C3   NUMBER(5),
  C4   NUMBER(10)
);

-- just insert a bunch of rows
insert into j_test (id)
select rownum 
from <dummy_table>
where rownum < 100000;

-- this is the statement that runs forever (longer than my patience allows)
update j_test
set C3 = 1,
    C1 = 'NEU'; 
```

在某些环境中，更新语句只需要大约 20 秒，而在某些环境中，语句会运行几分钟。当使用更多行时，问题会变得更糟。

我们不知道是什么导致了这种行为，并且希望在提出解决方案之前了解正在发生的事情。

有什么想法和建议吗？谢谢托尔斯滕

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T17:07:41.883

性能不佳的一个可能原因是行链接。您的所有行最初都有列 C3 和 C4 为空，然后您将它们全部更新为具有值。新数据不适合现有块，因此 Oracle 必须将行链接到新块。

如果您事先知道您将这样做，您可以像这样预先分配足够的可用空间：

```
CREATE TABLE J_TEST
(
  ID  NUMBER(10) PRIMARY KEY,
  C1   VARCHAR2(50 BYTE),
  C2   VARCHAR2(250 BYTE),
  C3   NUMBER(5),
  C4   NUMBER(10)
) PCTFREE 40; 
```

... 其中 PCTFREE 指定一定百分比的空间以保持可用更新。默认值为 10，这对于此示例是不够的，其中行的大小或多或少加倍（根据我的数据库，平均长度为 8 到 16 个字节）。

该测试显示了它的不同之处：

```
SQL> CREATE TABLE J_TEST
  2  (
  3    ID  NUMBER(10) PRIMARY KEY,
  4    C1   VARCHAR2(50 BYTE),
  5    C2   VARCHAR2(250 BYTE),
  6    C3   NUMBER(5),
  7    C4   NUMBER(10)
  8  );

Table created.

SQL> insert into j_test (id)
  2  select rownum 
  3  from transactions
  4  where rownum < 100000;

99999 rows created.

SQL> update j_test
  2  set C3 = 1,
  3      C2 = 'NEU'
  4  /

99999 rows updated.

Elapsed: 00:01:41.60

SQL> analyze table j_test compute statistics;

Table analyzed.

SQL> select blocks, chain_cnt from user_tables where table_name='J_TEST';

    BLOCKS  CHAIN_CNT
---------- ----------
       694      82034

SQL> drop table j_test;

Table dropped.

SQL> CREATE TABLE J_TEST
  2  (
  3    ID  NUMBER(10) PRIMARY KEY,
  4    C1   VARCHAR2(50 BYTE),
  5    C2   VARCHAR2(250 BYTE),
  6    C3   NUMBER(5),
  7    C4   NUMBER(10)
  8  ) PCTFREE 40;

Table created.

SQL> insert into j_test (id)
  2  select rownum 
  3  from transactions
  4  where rownum < 100000;

99999 rows created.

SQL> update j_test
  2  set C3 = 1,
  3      C2 = 'NEU'
  4  /

99999 rows updated.

Elapsed: 00:00:27.74

SQL> analyze table j_test compute statistics;

Table analyzed.

SQL> select blocks, chain_cnt from user_tables where table_name='J_TEST';

    BLOCKS  CHAIN_CNT
---------- ----------
       232          0 
```

如您所见，使用 PCTFREE 40 更新需要 27 秒而不是 81 秒，结果表使用 232 个没有链接行的块，而不是 694 个有 82034 个链接行的块！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T16:44:43.257

试试这个：

```
insert into j_test (id, C3, C4)
select rownum, 1, 'NEU'
from <dummy_table>
where rownum < 100000; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T17:01:26.657

您是否真的要使用“NEU”字符值更新数字字段 C4 NUMBER(10)？

假设您正在尝试执行以下操作：

```
UPDATE j_test
   SET c3 = 3
 WHERE c1 = 'NEU' 
```

您可能需要在搜索字段上创建索引并分析表以加快更新过程。如果您真的尝试更新整个表，那么更新速度可能会有所不同。这取决于内存、磁盘访问速度、重做日志的创建等。

此外，正如另一个答案中提到的，您需要为使用 PCTFREE 的更新保留一些空间，否则您将在表中获得很多影响更新速度的链接行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T18:36:38.070

您确定问题不是因为您将“NEU”插入到 Number(10) 字段中吗？在插入之前，它正在执行从“NEU”到数字（??）的即时转换。

我的意思是说真的，其他答案都是很好且有用的信息，但是完整更新的 100k 行应该很快。

请记住 - 索引往往会加快选择，并减慢插入/更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T18:23:27.317

[这与问题和我的](https://stackoverflow.com/questions/199537/oracle-sql-technique-to-avoid-filling-trans-log#202530)回答非常相似。

永远不要更新表中 100% 的行。只需按照该链接中的程序进行操作即可。将“正确答案”构建为新表，然后将该新表换成旧表。与删除大部分行相同。使用我概述的场景要有效得多。

编辑：如果这对你们中的某些人来说是个坏主意，请知道这是 Tom Kyte 推荐的技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T20:23:06.123

另一种可能性是一个 UPDATE 正在等待，因为表被锁定（例如，表上有另一个未提交的 UPDATE）
[这个链接](http://www.praetoriate.com/oracle_tips_find_locks.htm)有一个 SQL 语句来显示锁

# php - $_GET 参数未填充，即使 URL 具有适当的形式

> ID：296103
> 
> 赞同：0
> 
> 时间：2008-11-17T16:38:44.923
> 
> 标签：php, wordpress, url, get

我正在开发一个新的 Wordpress 网站，该网站表现出一些奇怪的行为。我向它传递了一个带有 GET 参数的 URL，并且`$_GET`没有填充该参数。我在`$_SERVER`参数中看到，`REQUEST_URI`那里有完整的 URL，与`?var=value`部分一起完成，但`$_GET`变量中没有爱。

URL 被重定向`mod_rewrite`，但鉴于`REQUEST_URI`显示完整的事实，我认为这不是可能的罪魁祸首。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T16:51:59.793

已搞定。这里变量的内容本身就是一个 URL，对其进行编码就足以让它通过。可能是服务器上的某种安全措施将其选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-26T11:28:42.347

抱歉，它已经过时了，但是对于任何可能阅读此内容的人来说：Wordpress 不会使用开箱即用的自定义 $_GET 变量：您需要先注册这些自定义变量，以便 WP 能够使用它们。

我不是这方面的专家，但我记得找到了非常好的教程。搜索“添加新的 WP 查询变量”

# java - RESTful 和 SOAP Web 服务在实践中有何不同？

> ID：296116
> 
> 赞同：7
> 
> 时间：2008-11-17T16:42:14.713
> 
> 标签：java, .net, php, web-services, nusoap

我正在为 PHP 应用程序实现 Web 服务，并试图了解标准 Web 服务和 RESTful Web 服务必须提供什么。我的意图是编写包装代码以抽象出 Web 服务细节，以便开发人员可以“实例化远程对象”并使用它们。这是我的想法，也许你们中的一些人可以添加您的经验并扩展它：

**RESTful Web 服务**

基本上只是“按需提供 XML”，因此例如，您可以为客户端应用程序编写包装器代码，以便它可以以这种方式查询服务器应用程序：

```
$users = Users::getUsers("state = 'CO'"); 
```

*   这将反过来从远程 URL 获取 XML 提要
*   $users 可以变成完整用户对象的集合，或者
*   保留为 XML，或
*   变成数组等
*   查询脚本 ("state = 'CO'") 将在服务器端被翻译成 SQL
*   从客户端的角度来看，RESTful Web 服务通常是只读的，尽管您可以编写可以使用 POST 或 GET 在服务器上进行更改的代码，例如传递加密令牌以确保安全，例如：

    $users = Users::addUser($encryptedTrustToken, 'jim',$encryptedPassword, 'James', 'Taylor');

这将在服务器应用程序上创建一个新用户。

**标准网络服务**

标准的 Web Servcies 最终基本上做同样的事情。他们拥有的一个优势是客户可以通过 WSDL 发现他们的详细信息。但除此之外，如果我想编写允许开发人员远程实例化、编辑和保存对象的包装器代码，我仍然需要实现包装器代码。SOAP 不会为我做任何这些，它可以做到这一点：

```
$soap = new nusoap_client('http://localhost/test/webservice_user.php?wsdl', true);
$user = $soap->getProxy(); 
$lastName = $user->lastName(); 
```

但如果我想编辑和保存：

```
$user->setLastName('Jones');
$user->save(); 
```

然后我需要例如处理服务器端的所有状态，SOAP 似乎没有为每个客户端在服务器端保存该对象。

也许我正在使用的 PHP SOAP 实现存在限制（nusoap）。也许 Java 和 .NET 实现做得更多。

会很高兴听到您的反馈以清除其中的一些乌云。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T17:01:02.100

它们是不同的模型... REST 是以**数据为中心**的，而 SOAP 是以**操作为中心的**。即使用 SOAP，您往往会有离散操作“SubmitOrder”等；但是使用 REST，您通常可以更加灵活地了解如何查询数据。

SOAP 也往往与更多的复杂性相关联（这有时是必要的） - REST 又回到了 POX 等和[YAGNI](http://en.wikipedia.org/wiki/You_Ain't_Gonna_Need_It)。

* * *

在 .NET 方面，“wsdl.exe”等工具将为您提供完整的客户端代理库来表示 SOAP 服务（或“svcutil.exe”用于 WCF 服务）：

```
var someResult = proxy.SubmitOrder(...); 
```

对于 .NET 的 REST，我想 ADO.NET 数据服务是最明显的参与者。在这里，工具 (datasvcutil.exe) 将为您提供具有 LINQ 支持的完整客户端数据上下文。LINQ 是 .NET 形成复杂查询的相对较新的方法。所以类似于（使用强/静态类型检查和智能感知）：

```
var qry = from user in ctx.Users
          where user.State == 'CO'
          select user; 
```

（这将转换为/从 ADO.NET 数据服务的适当 REST 语法转换）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T03:44:48.883

我在附和 Marc Gravell 提到的内容。当人们问我关于 REST 的问题（他们通常对 SOAP 和 SOA 有想法）时，我会告诉他们 REST = ROA，因为它是面向资源/数据的，它是一种不同的范式，因此具有不同的设计关注点。

对于您的情况，如果我没看错的话，您希望避免编写包装器代码并需要一个可以远程存储对象及其属性的解决方案（并让开发人员完全隐藏它们）。我真的无法提出更好的解决方案。嗯，如果其中任何一个接近满足您的要求，请告诉我：

1.  [EJB3/JPA](http://www.javabeat.net/articles/5-introduction-to-java-persistence-apijpa-1.html)
2.  [CouchDB](http://wiki.apache.org/couchdb/Basics) (REST/JSON)

如果我错误地解释了您的问题，也请告诉我。

如果我们比较 XML-RPC 和 SOAP，后者将为您提供更好的数据类型处理，因为前者虽然您将处理更简单的数据类型，但您必须编写一个层或适配器来将它们转换为您的域对象。

yc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T17:19:42.377

Soap 只是一组经过标准组织认可的 XML 模式。它的优势在于它专为互操作性而设计，并且支持许多企业级功能。任何平台上的肥皂都不会提供您正在寻找的操作。您需要设计和实施服务合同来获得这些功能。

听起来您想要 Soap 或 REST 都不是特别适合的远程对象。也许你最好看看[XML-RPC](http://www.xmlrpc.com/ "XML-RPC")。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T17:03:01.630

主要区别基本上是工具。

许多高端 SOAP 堆栈覆盖了从开发人员到您几乎只使用 DTO/文档和 RPC 的大量 SOAP 基础结构。

REST over HTTP 将更多的负担交给了开发人员（协商格式 [XML、JSON、HTTP POST]、解析结果 [DOM、地图、DTO 编组等]）。

显然，您可以编写一层逻辑来使处理这个细节更容易。一些 REST 框架的出现使这更容易，但目前，当您希望使用或使用此类服务​​时，它仍然是您的 TODO 列表中的一项任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T17:04:52.763

我的反馈是，如果你想要远程状态，你不是在谈论 Web 服务。我不知道任何处理远程状态的当代模型。我认为，如果您需要远程状态，则只能靠自己（没有宗教信仰）。只需将 xml 从这里扔到那里，不要介意这个理论。

我必须补充一点，远程状态是邪恶的。如果可以的话，避免它。

# java - 通用公共集合

> ID：296133
> 
> 赞同：13
> 
> 时间：2008-11-17T16:48:55.013
> 
> 标签：java, collections, upgrade, apache-commons, binary-compatibility

我很惊讶[Apache Commons Collections](http://commons.apache.org/collections/)项目仍然没有让他们的库泛型感知。我真的很喜欢这个库提供的功能，但是缺乏对泛型的支持是一个很大的障碍。Commons Collections的[Lavalabs fork 确实支持 generics](http://larvalabs.com/collections/index.html)，这似乎声称向后兼容，但是当我尝试更新到这个版本时，我的 Web 应用程序无法启动（在 JBoss 中）。

我的问题是：

*   是否有人已成功从 Commons Collections 更新到上述分叉
*   如果 Commons Collections 有任何计划增加对泛型的支持

顺便说一句，我知道 Google 集合，但在 API 稳定之前不愿意使用它。

干杯，唐

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-28T02:21:04.260

考虑[谷歌收藏](http://code.google.com/p/google-collections/)。从他们的[Javalobby 采访中](http://www.javalobby.org/articles/google-collections/)：

> [Google Collections] 使用 Java 5 特性构建：泛型、枚举、协变返回类型等。在编写 Java 5 代码时，您需要一个充分利用该语言的集合库。此外，我们付出了巨大的努力使该库完整、健壮并与 JDK 集合类保持一致。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T18:46:50.657

有贡献。查看[jira](https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&mode=hide&sorter/order=DESC&sorter/field=priority&resolution=-1&pid=12310465&fixfor=12312131)的

还有一个[JDK5 分支](http://svn.apache.org/repos/asf/commons/proper/collections/branches/collections_jdk5_branch/)。

我们确实想添加泛型并将 Commons Collections 更新到 1.5（和 1.6）。最大的问题是如何解决向后兼容性问题。人们对那里有非常不同的看法。对于某些 Commons 组件，较新的 JDK 几乎要求重写新的 JDK 恕我直言。

不过，在 ApacheCon 期间，我感到有几个人有推动这项工作的冲动。这只是一项艰巨的任务。

随意出现在 dev@commons.apache.org

干杯，托斯滕

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T16:50:48.253

鉴于 Jakarta[内部](http://www.jroller.com/scolebourne/entry/generics_and_commons_collections) [辩论](http://issues.apache.org/jira/browse/COLLECTIONS-110)的最后一句话是在 12 月 7 日，我会说 Apache 不会接受泛型，从而为像[Google Collections](http://code.google.com/p/google-collections/)这样的 Java5 友好型开放领域。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-09T09:52:22.220

我说，咬紧牙关并切换到 google-collections，至少对于新代码。

我知道您担心稳定性，但是 google-collections 库在 1.0 版本中非常接近稳定——在开发人员列表中闲逛或观看他们报告的问题，他们已经对更改非常谨慎，尤其是破坏性更改。当前版本和（似乎即将到来的）1.0 最终版本之间的任何不兼容都将非常小。

另外，如果您担心稳定性，请选择一个版本（例如当前版本，1.0 RC4），然后……不要升级。当然，您不会获得任何新功能，但 commons-collections 已经好*几年*没有以有意义的方式进行更新了，所以您的情况真的更糟吗？至少你对泛型和（恕我直言）更好的 API 感到困惑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-10T13:18:42.763

一般的 BC 问题是包`org.apache.commons.collections`已**重命名为** `org.apache.commons.collections15`. 我不知道这种变化的原因。尝试重命名它，重新编译库并再次运行您的应用程序。

我在（来自 Apache）和（来自 Lavalabs）上使用[Clirr](http://clirr.sf.net)工具发现了这个问题。`commons-collections-3.2.1.jar``collections-generic-4.01.jar`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T00:47:08.227

我无法想象你有什么理由不使用谷歌收藏。使用该库非常简单。

对于我的工作，我同时使用 apache 集合和 google 集合。

你能解释一下为什么你不能使用谷歌收藏吗？

问候

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-09T09:56:08.953

[这里](http://larvalabs.com/collections/)有一个通用的 Commons Collections 3.1 端口，我们已经使用了几年了。很好地完成了这项工作，并且由于它严格基于现有的 Commons 源，因此它具有稳定的 API。

不过，它可以使用更新来符合 Commons Collections 3.2。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-03T16:44:13.440

阅读收藏博客，它提供了对收藏框架的完整理解。 [http://tech.konnectingtheworld.com/2010/09/a-note-on-java-collections/](http://tech.konnectingtheworld.com/2010/09/a-note-on-java-collections/)

如果您觉得您的查询没有得到答复，请与我联系。我会尽力为您提供信息。

# perl - 为什么会泄漏？

> ID：296134
> 
> 赞同：3
> 
> 时间：2008-11-17T16:49:06.197
> 
> 标签：perl, memory, memory-leaks

为什么这会在 Perl 中泄漏？

```
$ perl -MDevel::LeakTrace::Fast -e 'our @a=(1);our @b=(1)'
leaked SV(0x0x84e053c) from -e line 1

$ perl -v
This is perl, v5.8.0 built for i386-linux-thread-multi
[...]

$ uname -a
Linux ant1 2.4.21-20.ELsmp #1 SMP Wed Aug 18 20:46:40 EDT 2004 i686 i686 i386 GNU/Linux 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T18:21:18.337

它没有。把它放在一个循环中，自己看看：进程内存不会随着每次循环迭代而增加。

```
for(1 .. 10_000_000)
{
  our @a = (1);
  our @b = (1);
} 
```

所有“泄漏”消息（可能）告诉您的是程序以未完成的变量退出。要使该消息静音，请在程序结束之前取消定义变量：

```
perl -MDevel::LeakTrace::Fast -e 'our @a = (1); our @b = (1); undef @a; undef @b;' 
```

FWIW，在 perl 5.10.0 下打印了相同的消息，所以我不确定升级 perl 是否是答案。

至于为什么在某些情况下会出现消息而在其他情况下不会出现，这可能是Devel::LeakTrace::Fast 的变幻莫测。许多 Perl 泄漏检测模块都有这样的“特质”（善意地说）。

底线：测试泄漏的唯一 100% 可靠方法是查看内存使用量是否随着重复执行相关代码而增加。如有疑问，请回过头来。

然而，各种 Devel::* 模块可以提供帮助。但首先最好隔离泄漏代码：禁用一半代码并查看泄漏是否仍然存在。现在您已将搜索范围缩小了一半。重复几次，您将很快找到泄漏的函数或语句。然后查看该代码在放入单独的脚本时是否仍然泄漏。[最后，要查看泄漏的原因，请使用 Devel:: 模块（例如，使用Devel::Cycle](http://search.cpan.org/dist/Devel-Cycle/)检查内存周期）。

# c# - 如何在 .NET 3.5 中控制音量？

> ID：296135
> 
> 赞同：3
> 
> 时间：2008-11-17T16:49:42.140
> 
> 标签：c#, .net

我想为我的应用程序创建一个音量滑块。我不介意它是控制主音量还是程序音量，但如果有其他选择，我不想使用 pinvoke。我将 C# 与 .NET 3.5 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T16:56:25.183

如[更改主音量级别](https://stackoverflow.com/questions/294292)问题中所述，有 2 种不同的 API，具体取决于您的操作系统（Xp 或 Vista）。

尽管如此，如果您可以从您的 .net 程序中调用该问题中提到的一些 winapi 函数，您应该能够实现您所要求的。

# sql - SQL 查询问题：SELECT ... NOT IN

> ID：296146
> 
> 赞同：50
> 
> 时间：2008-11-17T16:54:09.183
> 
> 标签：sql, sql-server

我肯定会犯一个愚蠢的错误，但我不知道是什么：

在 SQL Server 2005 中，我尝试选择除了在凌晨 2 点之前进行预订的客户之外的所有客户。

当我运行此查询时：

```
SELECT idCustomer FROM reservations 
WHERE idCustomer NOT IN 
  (SELECT distinct idCustomer FROM reservations 
   WHERE DATEPART ( hour, insertDate) < 2) 
```

我得到 0 个结果。

但

```
SELECT idCustomer FROM reservations 
```

返回 152.000 个结果和“NOT IN”部分：

```
SELECT distinct idCustomer FROM reservations 
WHERE DATEPART ( hour, insertDate) < 2 
```

仅返回 284 行

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-17T16:58:05.617

```
SELECT distinct idCustomer FROM reservations
WHERE DATEPART ( hour, insertDate) < 2
  and idCustomer is not null 
```

确保您的列表参数不包含空值。

这是一个解释：

```
WHERE field1 NOT IN (1, 2, 3, null) 
```

是相同的：

```
WHERE NOT (field1 = 1 OR field1 = 2 OR field1 = 3 OR field1 = null) 
```

*   最后一个比较结果为空。
*   该空值与布尔表达式的其余部分进行或运算，产生空值。(*)
*   null 被否定，产生 null。
*   null 不正确 - where 子句仅保留真实行，因此所有行都被过滤。

(*) 编辑：这个解释很好，但我想解决一件事，以避免未来的挑剔。(TRUE OR NULL) 将评估为 TRUE。例如，如果 field1 = 3，这是相关的。该 TRUE 值将被否定为 FALSE，并且该行将被过滤。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T18:40:51.447

`NULL`列在列表中总是很危险的`IN`——它的行为通常与预期的一样，`IN`但对于`NOT IN`:

```
IF 1 NOT IN (1, 2, 3, NULL) PRINT '1 NOT IN (1, 2, 3, NULL)'
IF 1 NOT IN (2, 3, NULL) PRINT '1 NOT IN (2, 3, NULL)'
IF 1 NOT IN (2, 3) PRINT '1 NOT IN (2, 3)' -- Prints
IF 1 IN (1, 2, 3, NULL) PRINT '1 IN (1, 2, 3, NULL)' -- Prints
IF 1 IN (2, 3, NULL) PRINT '1 IN (2, 3, NULL)'
IF 1 IN (2, 3) PRINT '1 IN (2, 3)' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T17:09:50.460

鉴于它是SQL 2005，你也可以试试这个它类似于Oracle的MINUS命令（与UNION相反）

但我也建议添加 DATEPART ( hour, insertDate) 列进行调试

```
SELECT idCustomer FROM reservations 
EXCEPT
SELECT idCustomer FROM reservations WHERE DATEPART ( hour, insertDate) < 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T17:19:13.500

```
SELECT Reservations.idCustomer FROM Reservations (nolock)
LEFT OUTER JOIN @reservations ExcludedReservations (nolock) ON Reservations.idCustomer=ExcludedReservations.idCustomer AND DATEPART(hour, ExcludedReservations.insertDate) < 2
WHERE ExcludedReservations.idCustomer IS NULL AND Reservations.idCustomer IS NOT NULL
GROUP BY Reservations.idCustomer 
```

[更新：添加了额外的标准来处理 idCustomer 为 NULL，这显然是原始海报的主要问题]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T17:21:18.207

抱歉，如果我错过了重点，但以下内容不会自己做你想做的事吗？

```
SELECT distinct idCustomer FROM reservations 
WHERE DATEPART(hour, insertDate) >= 2 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-01-19T05:46:42.973

```
SELECT MIN(A.maxsal) secondhigh
FROM (
      SELECT TOP 2 MAX(EmployeeBasic) maxsal
      FROM M_Salary
      GROUP BY EmployeeBasic
      ORDER BY EmployeeBasic DESC
     ) A 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-07-04T07:16:06.313

```
select * from table_name where id=5 and column_name not in ('sandy,'pandy'); 
```

# c# - MSBuild 条件编译

> ID：296147
> 
> 赞同：2
> 
> 时间：2008-11-17T16:54:16.560
> 
> 标签：c#, .net, msbuild

我有一个 web 服务类，框架的其余部分依赖它来获取它的数据，但是 web 服务类需要有不同的方法属性，具体取决于它所处的环境。例如......

```
[SoapDocumentMethodAttribute("https://example",...)]
public string Test()
{
    //doSomething
} 
```

看到那个“ [https://example](https://example) ”了吗？这需要根据环境而改变。AFAIK，您不能使该字符串在运行时动态，它必须以这种方式编译。所以我试图得到它，以便我有多个用于此 Web 服务的 CS 文件，这些文件中硬编码了不同的属性 URL，MSBuild 在预编译时交换它们。所以我有一个用于测试的基础“Service.cs”，用于生产环境的“Service.cs.production”等等。

*   这是做到这一点的最佳方法，还是我错过了可以让一个 CS 自行处理环境的东西？
*   为了保持具有相同的类名和 IntelliSense 不认为事情是模棱两可的，我搞砸了文件扩展名（“Service.cs”与“Service.cs.production”）。这是唯一的方法吗？
*   考虑到以上所有内容都可以，并且我正在针对“生产”配置进行编译，它可以编译 Service.cs.production**而不是**Service.cs 并且一切都变得很糟糕吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T17:06:51.340

你可以使用条件注释吗？

```
#if TESTING
        [SoapDocumentMethodAttribute(something)]
#else
        [SoapDocumentMethodAttribute(someotherthing)]
#endif 
```

对于您的测试配置，您将定义常量：

```
<DefineConstants>TESTING</DefineConstants> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T17:13:51.983

结合定义常量和使用#if 指令，

您还可以编写自定义构建任务 -> Target BeforeBuild，然后在 Project 对象中使用 Engine.GlobalEngine.GetLoadedProject("projpath")。

现在，您可以根据不同的环境来操作 Project 对象的属性。

如果您愿意，可以考虑在配置中为不同的环境添加平台。

这可能不是您正在寻找的答案，但是当您想要基于项目环境进行 fork 构建时需要考虑的问题。

# html - 导致垂直对齐问题的图像

> ID：296148
> 
> 赞同：0
> 
> 时间：2008-11-17T16:55:20.367
> 
> 标签：html, css

我有以下 div 布局：

![](https://i.stack.imgur.com/bZSnA.jpg)

当我将普通的 txt 元素放在蓝色和橙色 div 中时，一切都很好。但是，当我在橙色 div（即 31px）中放置图像时，蓝色 div 中的元素会被向下推大约蓝色 div 高度的一半。

（附加信息，当将鼠标悬停在萤火虫中橙色 div 的 html 上时，似乎只有一半的图像包含在其中，即使肉眼看起来很好）。

不胜感激，我对盒子模型还是有点生疏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T17:20:03.233

尝试浮动两个内部 div。

向左飘浮;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T17:25:56.857

您可能想尝试将图像浮动到文本的左侧。这样，文本将位于图像旁边，而无需定位。例如：

```
<style>
div {
position: absolute;
border: 1px solid blue;
}
div img {
height: 31px;
width: 50px;
float: left;
}
</style>

<div>
    <img src="myImage.gif">
    <p>Lorem ipsum dolor sit amet...</p>
</div> 
```

通过给你的容器 div 一些填充和/或图像一个边距来调整布局，你应该能够得到你想要的外观。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T17:00:28.233

我不太擅长 CSS 框，但可以添加： display:inline; 图像样式修复问题？和/或添加边距：0px；
哦，是在 Quirks 模式下渲染的 brwoser，因为不在 Quirks 模式下渲染也可以解决一些问题。

**编辑**
通过怪癖模式我的意思是，您的页面是否具有类似于下面的 DOCTYPE 声明（尽管您当然应该使用正确的 DOCTYPE）

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
```

更多关于 DOCTYPES 的信息：http: [//htmlhelp.com/tools/validator/doctype.html](http://htmlhelp.com/tools/validator/doctype.html)

# language-agnostic - 记录错误的最佳做法是什么？

> ID：296150
> 
> 赞同：17
> 
> 时间：2008-11-17T16:55:45.200
> 
> 标签：language-agnostic, logging, error-handling

很多时候我看到记录这样的错误：

```
System.out.println("Method aMethod with parameters a:"+a+" b: "+b);
print("Error in line 88"); 
```

所以.. 记录错误的最佳做法是什么？

**编辑：**

这是 java，但可能是 C/C++、基本等。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-17T17:14:52.667

直接登录到控制台是可怕的，坦率地说，这是一个缺乏经验的开发人员的标志。做这种事情的唯一原因是 1) 他或她不知道其他方法，和/或 2) 开发人员没有想过当他/她的代码部署到生产站点时会发生什么，和届时将如何维护应用程序。处理每天记录 1GB 或更多完全不需要的调试日志的应用程序令人抓狂。

普遍接受的最佳实践是使用具有以下概念的日志记录框架：

1.  不同的日志对象 - 不同的类/模块/等可以记录到不同的记录器，因此您可以选择将不同的日志配置应用于应用程序的不同部分。
2.  不同的日志级别 - 因此您可以调整日志配置以仅记录生产中的错误，在开发环境中记录各种调试和跟踪信息等。
3.  不同的日志输出 - 该框架应该允许您配置日志输出的发送*位置*，而无需对代码库进行任何更改。您可能希望将日志输出发送到的不同位置的一些示例是文件、基于日期/大小翻转的文件、数据库、电子邮件、远程接收器等。
4.  日志框架永远不应该*从* **日志**代码中抛出任何异常或错误。您的应用程序不应因为日志框架无法创建其日志文件或获取文件锁定而无法加载或无法启动（除非这是一项关键要求，可能出于法律原因，对于您的应用程序而言）。

您将使用的最终日志框架当然取决于您的平台。一些常见的选项：

*   爪哇：
    *   [Apache Commons 日志记录](http://commons.apache.org/logging/)
    *   [日志4j](http://logging.apache.org/log4j/ "日志4j")
    *   [回退](http://logback.qos.ch/)
    *   内置[java.util.logging](http://java.sun.com/j2se/1.4.2/docs/api/java/util/logging/package-summary.html)
*   。网：
    *   [log4net](http://logging.apache.org/log4net/index.html)
*   C++：
    *   [日志4cxx](http://logging.apache.org/log4cxx/index.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-17T17:10:41.597

Apache Commons Logging 不适用于*应用程序*的常规日志记录。它旨在供不希望对 API 用户强制执行日志记录的库或 API 使用。

Commons Logging 也存在类加载问题。

选择 [许多] 日志记录 API 之一，使用最广泛的可能是[log4j](http://logging.apache.org/log4j/)或[Java Logging API](http://java.sun.com/j2se/1.5.0/docs/api/java/util/logging/package-frame.html)。

如果您想要实现独立性，您可能需要考虑log4j 的原作者[SLF4J 。](http://www.slf4j.org/)

选择了一个实现，然后*一致*地使用该实现中的日志记录级别/严重性，以便更容易搜索/过滤日志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T17:08:01.010

以一致的格式记录错误的最简单方法是使用 Log4j 等日志框架（假设您使用的是 Java）。在您的代码标准中包含一个日志记录部分很有用，以确保所有开发人员都知道需要记录什么。大多数日志记录框架的好处是它们具有不同的日志记录级别，因此您可以控制在开发、测试和生产之间的日志记录的详细程度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T17:08:54.893

最佳实践是使用 java.util.logging 框架

然后您可以使用这些格式中的任何一种记录消息

```
log.warning("..");
log.fine("..");
log.finer("..");
log.finest(".."); 
```

或者

```
log.log(Level.WARNING, "blah blah blah", e); 
```

然后，您可以使用 logging.properties（下面的示例）在日志记录级别之间切换，并执行各种巧妙的操作，例如记录到文件、使用轮换等。

```
handlers = java.util.logging.ConsoleHandler

.level = WARNING

java.util.logging.ConsoleHandler.level = ALL

com.example.blah = FINE
com.example.testcomponents = FINEST 
```

我认为应该避免使用 log4j 和其他框架，Java 已经拥有你需要的一切。

**编辑**

这可以作为任何编程语言的一般实践。能够从单个属性文件控制所有级别的日志记录在企业应用程序中通常非常重要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T17:08:59.887

一些建议的最佳实践

*   使用日志框架。这将允许您：

    *   轻松更改日志消息的目的地
    *   根据严重性过滤日志消息
    *   支持国际化的日志消息
*   如果您使用的是 java，那么[slf4j](http://www.slf4j.org/)现在比[Jakarta commons logging](http://commons.apache.org/logging/)作为日志外观更受欢迎。

*   如前所述 slf4j 是一个门面，然后您必须选择一个底层实现。log4j、java.util.logging 或“简单”。

*   遵循您的框架的建议，以确保不会不必要地执行[昂贵的日志记录操作](http://www.slf4j.org/faq.html#logging_performance)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T17:11:09.023

上面提到的 apache 通用日志 API 是一个很好的资源。回到java，还有一个标准错误输出流（System.err）。

直接来自 Java API：

> 此流已经打开并准备好接受输出数据。
> 
> 通常，此流对应于主机环境或用户指定的显示输出或另一个输出目的地。按照惯例，此输出流用于显示错误消息或其他应立即引起用户注意的信息，即使主要输出流（变量 out 的值）已被重定向到文件或其他目标通常不会持续监控。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-03T14:50:58.257

除了来自其他答案的技术考虑之外，建议**记录有意义的消息**，并可能采取一些步骤来避免将来出现错误。当然，取决于错误。

当消息指出*“无法从文件 X 中读取，您没有适当的权限”之类的信息时，您可以从 I/O 错误中获得更多收益。*

[在SO](https://stackoverflow.com/q/194537/197574)上查看更多示例或[搜索网络](http://www.google.com/search?q=good+error+messages)。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-17T16:59:37.143

确实没有记录错误的最佳实践。它基本上只需要遵循一致的模式（在软件/公司/等内），提供足够的信息来跟踪问题。例如，您可能想要跟踪时间、方法、参数、调用方法等。

只要你不只是打印“错误”

# silverlight - 如何在 Silverlight 中正确地将基类序列化为 JSON？

> ID：296163
> 
> 赞同：0
> 
> 时间：2008-11-17T16:58:36.660
> 
> 标签：silverlight, json, serialization, silverlight-2.0

我有以下结构：

```
class Base
{
}

class Child : Base
{
} 
```

当我尝试执行以下操作时：

```
DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(Base));
serializer.WriteObject(stream, data); 
```

它失败并显示错误消息：

> 不应使用数据合同名称“Child: [http://schemas.datacontract.org/2004/07/MyNamespace](http://schemas.datacontract.org/2004/07/MyNamespace) ”键入“MyNamespace.Child”。将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。

有谁知道如何正确序列化子类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T02:00:07.987

如果将[KnownType 属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute(VS.95).aspx)（来自 System.Runtime.Serialization）添加到子类的基类，那么它将起作用：

```
[KnownType(typeof(Child))]
class Base
{}

class Child : Base
{} 
```

这是必需的，因为当您将序列化程序设置为序列化基类时，它不会加载您的子类型（至少这是我的理解）。

# python - 如何将具有特定文件扩展名的文件复制到我的 python（2.5 版）脚本中的文件夹中？

> ID：296173
> 
> 赞同：21
> 
> 时间：2008-11-17T17:02:43.360
> 
> 标签：python, file, copy

我想将具有特定文件扩展名的文件复制到新文件夹中。我知道如何使用`os.walk`，但具体来说我将如何使用它？我只在一个文件夹中搜索具有特定文件扩展名的文件（此文件夹有 2 个子目录，但我要查找的文件永远不会在这 2 个子目录中找到，因此我不需要在这些子目录中搜索） . 提前致谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-17T17:06:37.283

```
import glob, os, shutil

files = glob.iglob(os.path.join(source_dir, "*.ext"))
for file in files:
    if os.path.isfile(file):
        shutil.copy2(file, dest_dir) 
```

阅读 shutil 模块的[文档](http://www.python.org/doc/2.5.2/lib/module-shutil.html)以选择适合您需要的函数（shutil.copy()、shutil.copy2() 或 shutil.copyfile()）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T19:39:49.020

如果您不递归，则不需要 walk()。

Federico 对 glob 的回答很好，假设您不会有任何名为“something.ext”的目录。否则尝试：

```
import os, shutil

for basename in os.listdir(srcdir):
    if basename.endswith('.ext'):
        pathname = os.path.join(srcdir, basename)
        if os.path.isfile(pathname):
            shutil.copy2(pathname, dstdir) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T19:39:10.817

这将遍历带有子目录的树。您可以进行 os.path.isfile 检查以使其更安全一些。

```
for root, dirs, files in os.walk(srcDir):
    for file in files:
        if file[-4:].lower() == '.jpg':
            shutil.copy(os.path.join(root, file), os.path.join(dest, file)) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-18T18:32:59.077

这是一个非递归版本`os.walk`：

```
import fnmatch, os, shutil

def copyfiles(srcdir, dstdir, filepattern):
    def failed(exc):
        raise exc

    for dirpath, dirs, files in os.walk(srcdir, topdown=True, onerror=failed):
        for file in fnmatch.filter(files, filepattern):
            shutil.copy2(os.path.join(dirpath, file), dstdir)
        break # no recursion 
```

例子：

```
copyfiles(".", "test", "*.ext") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T13:41:45.630

将扩展名为“extension”的文件从 srcDir 复制到 dstDir...

```
import os, shutil, sys

srcDir = sys.argv[1] 
dstDir = sys.argv[2]
extension = sys.argv[3]

print "Source Dir: ", srcDir, "\n", "Destination Dir: ",dstDir, "\n", "Extension: ", extension

for root, dirs, files in os.walk(srcDir):
    for file_ in files:
        if file_.endswith(extension):
            shutil.copy(os.path.join(root, file_), os.path.join(dstDir, file_)) 
```

# c# - 如何在 .NET 中获取打印机信息？

> ID：296182
> 
> 赞同：49
> 
> 时间：2008-11-17T17:05:58.097
> 
> 标签：c#, .net, printing, printers, printdialog

在标准的 PrintDialog 中，有四个值与选定的打印机相关联：状态、类型、位置和注释。

如果我知道打印机的名称，如何在 C# 2.0 中获取这些值？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-17T18:11:53.410

正如[dowski 所建议](https://stackoverflow.com/questions/296182/how-to-get-printer-info-in-cnet#296232)的，您可以使用WMI 来获取打印机属性。以下代码显示给定打印机名称的所有属性。其中您会发现：PrinterStatus、Comment、Location、DriverName、PortName 等。

```
using System.Management; 
```

...

```
string printerName = "YourPrinterName";
string query = string.Format("SELECT * from Win32_Printer WHERE Name LIKE '%{0}'", printerName);

using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(query))
using (ManagementObjectCollection coll = searcher.Get())
{
    try
    {
        foreach (ManagementObject printer in coll)
        {
            foreach (PropertyData property in printer.Properties)
            {
                Console.WriteLine(string.Format("{0}: {1}", property.Name, property.Value));
            }
        }
    }
    catch (ManagementException ex)
    {
        Console.WriteLine(ex.Message);
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-17T17:42:47.243

这*应该*有效。

```
using System.Drawing.Printing; 
```

...

```
PrinterSettings ps = new PrinterSettings();
ps.PrinterName = "The printer name"; // Load the appropriate printer's setting 
```

之后，可以读取 PrinterSettings的各种[属性。](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printersettings_members(VS.80).aspx)

注意`ps.isValid()`可以查看打印机是否真的存在。

编辑：一条附加评论。Microsoft 建议您使用[PrintDocument](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument(VS.80).aspx)并修改其 PrinterSettings，而不是直接创建 PrinterSettings。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-17T17:32:44.253

查看[PrinterSettings.InstalledPrinters](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printersettings.installedprinters.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-13T21:32:33.007

仅供参考，[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394363%28v=vs.85%29.aspx)列出了打印机 ManagementObject 的所有可用属性。

```
usage: printer.Properties["PropName"].Value 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T17:23:09.607

自从我在 Windows 环境中工作以来已经有很长时间了，但我建议你看看[使用 WMI](http://msdn.microsoft.com/en-us/library/aa394363.aspx)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-14T19:51:42.000

请注意，***dowski***和***Panos***引用的文章( [MSDN Win32_Printer](http://msdn.microsoft.com/en-us/library/aa394363%28VS.85%29.aspx) ) 可能有点误导。

我指的是大多数数组的第一个值。有些以 1 开头，有些以 0 开头。例如，“ *ExtendedPrinterStatus* ”表中的第一个值是 1，因此，您的数组应该是这样的：

```
string[] arrExtendedPrinterStatus = { 
    "","Other", "Unknown", "Idle", "Printing", "Warming Up",
    "Stopped Printing", "Offline", "Paused", "Error", "Busy",
    "Not Available", "Waiting", "Processing", "Initialization",
    "Power Save", "Pending Deletion", "I/O Active", "Manual Feed"
}; 
```

另一方面，“ *ErrorState* ”表中的第一个值是 0，因此，您的数组应该是这样的：

```
string[] arrErrorState = {
    "Unknown", "Other", "No Error", "Low Paper", "No Paper", "Low Toner",
    "No Toner", "Door Open", "Jammed", "Offline", "Service Requested",
    "Output Bin Full"
}; 
```

顺便说一句，“ *PrinterState* ”已过时，但您可以使用“ *PrinterStatus* ”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-11-04T15:04:15.043

我知道这是一个旧帖子，但现在更简单/更快的选择是使用 WPF 框架提供的增强打印服务（非 WPF 应用程序可用）。

[http://msdn.microsoft.com/en-us/library/System.Printing(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/System.Printing(v=vs.110).aspx)

检索打印机队列和第一个作业状态的示例..

```
var queue = new LocalPrintServer().GetPrintQueue("Printer Name");
var queueStatus = queue.QueueStatus;
var jobStatus = queue.GetPrintJobInfoCollection().FirstOrDefault().JobStatus 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-27T12:43:44.540

作为 WMI 的替代方案，您可以通过访问 WinSpool.drv（即 Windows API）来获得快速准确的结果 - 您可以从 pinvoke.net 获取有关接口、结构和常量的所有详细信息，或者我已经将代码放在一起在[http://delradiesdev.blogspot.com/2012/02/accessing-printer-status-using-winspool.html](http://delradiesdev.blogspot.com/2012/02/accessing-printer-status-using-winspool.html)

# svn - 每一个小变化的分支？

> ID：296183
> 
> 赞同：18
> 
> 时间：2008-11-17T17:06:01.140
> 
> 标签：svn, version-control, branch

我们有一个客户（谁有一个客户，谁有一个客户），他对代码库（在 PHP 中）的更改请求让我们发疯。我们的第一反应是只在 SVN 的主干中工作，但客户端经常回来并请求需要尽快将某些更改推送到实时服务器。另一方面，其他更改的优先级突然降低，最初是与其他更改组合在一起的（似乎）。

我们正在考虑为**每个变更请求使用一个分支。**这是疯了吗？还有哪些其他解决方案可能有效？

谢谢！

**编辑**：这是一个很难选择正确答案的问题。感谢大家的精彩回答。

**编辑**：我知道我选择的最佳答案并不是特别受欢迎。我也想找到解决这个问题的技术方案。但是现在我认为如果客户想要的软件具有可以以模块化方式部署的功能......这个问题**不**应该在我们使用版本控制系统时解决。它必须被设计到软件中。

**编辑**：现在差不多一个月过去了，我的同事/客户已经说服我，多个分支机构是要走的路。这不仅是由于客户的精神错乱，而且还基于我们需要能够确定某个功能是否“准备就绪”或“需要更多工作”或其他什么。我没有 SVN，但我们使用 SVN Cookbook 中的建议进行合并：您将分支**从**它分支的修订版合并到头修订版。

此外，使用这个系统，我们在某个时候合并所有分支，这成为新的 QA，然后是实时构建。然后我们从那里分支。

**最后编辑（也许）：**几个月后，这个系统仍在为我们工作。我们为每张工单创建分支，很少出现问题。另一方面，我们确实尝试将事情分开，就人们的工作而言......

**两年后：**我们现在使用GIT，现在这个系统实际上是相当合理的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-17T17:16:15.847

也许这里的 Subversion 并不是完成这项工作的最佳工具。尽管在 SVN 中创建所有这些分支很便宜，但重新合并它们可能会变得耗时且痛苦。

如果你看一下 GIT 而不是 SVN，你会发现一个版本控制系统，它通常在合并方面更强大。除此之外，它还具有“樱桃采摘”的特殊功能。也就是说，可以轻松地从一个开发树中“挑选”单个提交并将其添加到另一个（实时分支）。此外，在 GIT 中将多个提交合并为一个非常方便（您甚至可以从另一棵树添加到特定提交）。

因此，构建单一功能提交然后挑选它们可能是您的解决方案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-17T17:11:36.557

为您的客户的实时版本创建一个分支，为您的新开发创建一个分支，为您正在进行的更改创建一个分支怎么样。

当您没有被任务淹没时，在新的开发分支中工作。

当您修复所有让您发疯的有趣内容时，请在正在进行的更改分支中工作。当你得到修复后，将它合并到“live”分支和“new development”分支。

这样，您的客户的分布就在它自己的世界中，您的新开发继续进行（并且可以在您需要时合并）并且您的维护也被捕获。

我们在一个新的开发分支中工作，然后每次我们决定制作补丁时，我们都会分支主干，然后将该补丁发送出去进行问答。如果它来回一段时间，我们会在该分支中工作以解决这些问题，并在必要时合并回主干，以确保一切同步。如果某些事情在需要在以前的版本中解决的事实很久之后又回来了，我们总是可以在那个分支中修复它，然后再次将它合并到主干中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T17:57:44.000

线程开启器解释的场景是功能分支模式的示例： http: [//svnbook.red-bean.com/en/1.5/svn.branchmerge.commonpatterns.html#svn.branchmerge.commonpatterns.feature](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.commonpatterns.html#svn.branchmerge.commonpatterns.feature)

当您必须保持主开发线（主干）稳定并且您必须开发许多可能会破坏主线的功能时，它们非常有用。

缺点是您必须使各个分支与主干保持同步：当功能 A 的分支正在开发中时，功能 B 的分支可能已经达到稳定状态并被关闭并合并到主干中：在这种情况下，您必须将B分支引入的更改从主干合并到A分支。因此，经常将分支与主干合并是一个好习惯，以避免在分支生命结束时出现独特的大合并的问题情况，并且有很多冲突需要追踪和解决。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T17:13:04.213

每个更改请求的分支听起来有点矫枉过正，以后可能会遇到麻烦。

尝试将更改请求分组到逻辑区域，以便您可以看到一组特定的更改对应用程序具有逻辑相关的影响。为这些创建分支。

我认为这个问题的真正答案是**修复客户端**。您需要通过合同明确这些任意更改请求将花费他们的钱，并且可能会减慢他们的速度。如果这种情况持续下去，您的 svn 存储库将是项目中最不麻烦的方面。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T17:15:22.993

每个变更请求的分支，以及相应增加客户额外管理的成本，是解决这个问题的好方法。

就时间、可用于处理其他功能的资源等而言，这将花费您更多的成本，但是由于有很多不相关的更改，或者项目功能停滞或取消，这可能是更好的方法之一。

这确实与 SCM 系统无关——但 Subversion 肯定可以做需要的事情。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-17T17:17:10.807

**每个测试的**分支，工作变化。
每个版本发布的标签。
在主干中开发。
重复。

:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-17T17:57:40.817

每个版本都有一个分支。将尽可能多的更改组合到一个版本中 - 拥有更多分支通常是好的，在大多数情况下您可以轻松地将它们组合起来，将它们分开则有点棘手。

每个版本都有一个分支意味着你也有一个当前生产的分支（或者当版本在合并之后但实际部署之前待发布时，即将发布的内容）。

无论如何，这就是我们所做的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-17T17:41:06.950

在我的工作场所，我们有以下系统：

*   稳定分支：这是经过测试和验证的稳定代码所在的位置。
*   维护分支：这是在 stable 中修复 bug 的地方。当事情被验证工作时，它被合并到稳定的分支。
*   项目特定分支：我们产品中的每个子项目都有一个分支。在一年中的特定时间，所有要包含在今年发布中的项目都合并到“发布分支”中。这样所有的合并和东西都没有在发布前一周完成。
*   发布分支：这是子项目合并后当前发布的所有混乱开发发生的地方。发布完成后与 stable 合并。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-09T14:47:18.497

使用 git，我*确实*为每一个小改动创建了一个分支，我喜欢它！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-17T17:22:51.853

在项目的“实时”分支中进行大量快速更改时，您需要有一个可靠的代码审查流程来减少破坏它的机会。代码审查必须在签入之前完成；并远离该分支的核心开发。

一旦更改被批准，您可以签入更改（和/或从您的工作分支合并）并在完成后创建一个新的“标签”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-10T12:52:20.793

当估计的小时数超过 8 时，请使用分支。

# .net - 无法让 .NET 应用程序跨域访问 AD 组

> ID：296193
> 
> 赞同：2
> 
> 时间：2008-11-17T17:08:31.323
> 
> 标签：.net, security, active-directory, active-directory-group

我有一个通过 .NET 分发的 .NET 应用程序`ClickOnce`。应用程序内的安全性是通过`WindowsPrincipal.IsInRole(GroupName)`使用一组组作为资源的方法来实现的。对于与组在同一域中的用户，这种结构非常适合我们。不幸的是，我们现在有用户需要使用在机器上运行的应用程序，并在我们的域信任但不在同一个林中的不同域中使用用户帐户。

似乎`IsInRole()`在本地计算机上查询 AD 票证以获取组成员身份。不幸的是，这张票只包含机器所在域的域本地组以及其他受信任域的全局和通用组，我们的组是第一个域中的域本地组。catch-22 的情况来自这样一个事实，即 AD 不允许全局组或通用组中的外部安全主体，因此虽然第二个域中的用户可以查询它，但他们不能成为它的成员（这有点毫无意义！ )

解释一下：有两个域：DOM1 和 DOM2，它们之间建立了信任关系，但它们不在同一个林中。

```
DOM1\User1
DOM2\User2 
```

是两个用户。

我想将两者都`User1`放在`User2`一个对两个用户都可见并且可以同时包含它们的组中。

我目前可以看到的唯一方法如下（其中 {} 表示组的成员，DL=Domain Local 和 GLO=GlobalGroup。）

在每个域中创建两个全局组：

```
DOM1\GLOGroup1 : {DOM1\User1}  
DOM2\GLOGroup1 : {DOM2\User2} 
```

和两个包含两个全局组的域本地组：

```
DOM1\DLGroup1 : {DOM1\GLOGroup1, DOM2\GLOGroup1}  
DOM2\DLGroup1 : {DOM1\GLOGroup1, DOM2\GLOGroup1} 
```

但这并不是真正可以接受的，因为我们实际上有两个以上的域和大约 70 个组要管理，包括组的层次结构，而且我们对其他域中组的管理没有太多直接控制。

我们还没有对使用 LDAP 的方法进行任何思考，但从我读过的少量内容来看，我认为通常不推荐用于此目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T04:44:23.040

您可以尝试使用 LDAP，但您必须知道要查询哪个 LDAP 服务器；有关示例代码，请参见此[答案](https://stackoverflow.com/questions/290548/c-validate-a-username-and-password-against-active-directory#290599)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T17:13:18.973

它不应该是一个允许来自多个受信任域的用户的通用组吗？

您检查广告的用户帐户还需要能够读取每个广告组。

毛罗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:49:04.373

文档状态（对于字符串重载）：

> 只能为当前主体的域确定角色。

但它并没有说明 SecurityIdentifier 重载。所以它可能会起作用（尚未测试过）。您可以使用 wmi 获取 sid。找不到例子。

# c++ - 是否有任何“开箱即用”的 C++ 2D/3D 绘图库？

> ID：296199
> 
> 赞同：76
> 
> 时间：2008-11-17T17:09:15.860
> 
> 标签：c++, graph, wxwidgets, plot

我查看了在交互式窗口中绘制函数（或其他类型的图表）的不同选项。我主要使用 wxWidgets，但我愿意接受任何其他“接口”。

## **查看可用的内容，这是我发现的内容**：

**wxPlot**：自 2006 年以来未更新。但如果它是...

**wxMathPlot**：非常新，不成熟，功能很少（仍然活跃？）

**libgraph**：已过时，不是 rebust，仅 2D 且仅输出图像。

**koolplot**：太基础了，无法控制创建的窗口。

**EasyBMP**：非常基本，只有图像输出。

**plotutils**：仅命令行。

**plplot**：几乎没有维护 C 和 C++ API。事实上，wxPlot 正是基于此。如果我们更新了 C 和 C++ 接口，也可能是候选者。

任何意见？想法？

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-05-13T09:21:07.193

即使这条线是旧的，但黄金。[QCustomPlot](http://www.qcustomplot.com/)也非常值得推荐以补充此列表。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-01-24T18:42:53.920

[MathGL](http://mathgl.sourceforge.net)有多种绘图类型、C/Fortran 接口和基本数据分析

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-19T20:57:42.653

对于这些需求，我全力以赴[。](http://root.cern.ch/)但是，如果您不需要所有的分析支持，那就太重了。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-01-24T18:46:19.867

你有成熟的[Qwt 。](http://qwt.sourceforge.net/)某处潜伏着一个 3D 版本。然而，我从来没有对审美结果感到满意。

可能值得等待[Qt3D](http://labs.qt.nokia.com/2009/11/18/qt3d-brings-qt-style-coding-to-3d/)出来，自己轻松编写更好的东西。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-24T10:36:49.970

[我以编程方式向GNUPlot](http://www.gnuplot.info/)可执行文件提供所需的输入文件，并使用`system()`函数调用它。它适合我的情况，因为我只想在研究期间可视化我的数据。但是，如果您希望将绘图功能集成到您的可执行文件中，也许这不适合您 :)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-03-24T08:36:56.260

你可以使用 [DISLIN](http://www.dislin.de/)

它很整洁！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-17T18:50:43.893

wxChart 可能[是](http://wxcode.sourceforge.net/components/wxchart/)一种选择吗？但是，我自己没有使用过它，而且看起来它已经有一段时间没有更新了。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-17T19:11:03.587

只是一个想法：使用 Python 作为可嵌入的脚本语言来绘制图表。Python 有大量的[绘图库](http://wiki.python.org/moin/NumericAndScientific/Plotting)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-18T23:23:23.920

我们使用一个古老版本的[ComponentOne Chart](http://www.componentsource.com/products/componentone-chart-activex-dll/index.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-24T10:19:37.713

嘿！我是[wxMathPlot](http://wxmathplot.sourceforge.net)的开发者！该项目是活跃的：我只是花了很长时间才获得一个新版本，因为代码需要部分重写以引入新功能。看看新的 0.1.0 版本：它比旧版本有了很大的改进。无论如何，它不提供 3D（即使我一直在考虑它......）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-19T10:44:10.643

反颗粒几何 (AGG)。 [http://www.antigrain.com/](http://www.antigrain.com/)。它是一个开源的 2D 矢量图形库。它是一个独立的库，没有额外的依赖项。有很好的文档。Python 绘图库 matplotlib 使用 AGG 作为后端之一。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-17T20:28:44.677

我发现游戏库 Allegro 在过去很容易使用。也许值得一瞧。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-13T12:39:31.377

看看[wxArt2d](http://wxart2d.org)，它是一个用于 2d 编辑和绘图的完整框架。有关更多示例，请参阅[屏幕截图](http://wxart2d.org/moin/WxArt2dScreenShots)。

一些有趣的功能：

*   读写 SVG 和 CVG
*   同一文档的多个视图
*   空闲时更新更改
*   优化二维对象的绘制

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-11-17T20:08:01.960

OpenGL。不过，这将很困难，并且可能会重写轮子。请记住，OpenGL 是一个通用的 3D 库，而不是特定的绘图库，但您可以基于它实现绘图。

# java - JAXM 肥皂消息解析

> ID：296202
> 
> 赞同：1
> 
> 时间：2008-11-17T17:10:43.080
> 
> 标签：java, web-services, jaxm

我从 .net 服务中获取以下 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
               xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <validateCredentialsResponse 
               xmlns="http://www.paragon.com/positionmonitor/PositionMonitor">
            <validateCredentialsResult>
                <ResultData xsi:type="ValidateCredentialsResultData">
                    <validated>true</validated>
                    <alreadyLoggedIn>false</alreadyLoggedIn>
                </ResultData>
                <Status>
                    <Condition xmlns="">SUCCESS</Condition>
                    <ErrorCode xmlns="">BO.00000</ErrorCode>
                    <ErrorDesc xmlns="">OK</ErrorDesc>
                </Status>
            </validateCredentialsResult>
        </validateCredentialsResponse>
    </soap:Body>
</soap:Envelope> 
```

...并且我正在尝试使用 JAXM 对其进行解析，但是以下始终计算为 null：

```
SOAPEnvelope env = reply.getSOAPPart().getEnvelope(); 
```

有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-01T18:50:37.887

我使用以下代码得到了不错的结果（至少需要 Java 1.5）：

```
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.List;

import javax.xml.soap.MessageFactory;
import javax.xml.soap.MimeHeaders;
import javax.xml.soap.SOAPBody;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPMessage;

import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class Jaxm {

  private static List<Element> elements(NodeList nodes) {
    List<Element> result = new ArrayList<Element>(nodes.getLength());
    for (int i = 0; i < nodes.getLength(); i++) {
      Node node = nodes.item(i);
      if (node instanceof Element)
        result.add((Element)node);
    }
    return result;
  }

  private static Element named(Element elem, String name) {
    if (!elem.getNodeName().equals(name))
      throw new IllegalArgumentException("Expected " + name + ", got " + elem.getNodeName());
    return elem;
  }

  @SuppressWarnings("unchecked")
  public static void main(String[] args) throws IOException, SOAPException {
    String xml = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n" +
    "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" \r\n" +
    "               xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \r\n" +
    "               xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\r\n" +
    "    <soap:Body>\r\n" +
    "        <validateCredentialsResponse \r\n" +
    "               xmlns=\"http://www.paragon.com/positionmonitor/PositionMonitor\">\r\n" +
    "            <validateCredentialsResult>\r\n" +
    "                <ResultData xsi:type=\"ValidateCredentialsResultData\">\r\n" +
    "                    <validated>true</validated>\r\n" +
    "                    <alreadyLoggedIn>false</alreadyLoggedIn>\r\n" +
    "                </ResultData>\r\n" +
    "                <Status>\r\n" +
    "                    <Condition xmlns=\"\">SUCCESS</Condition>\r\n" +
    "                    <ErrorCode xmlns=\"\">BO.00000</ErrorCode>\r\n" +
    "                    <ErrorDesc xmlns=\"\">OK</ErrorDesc>\r\n" +
    "                </Status>\r\n" +
    "            </validateCredentialsResult>\r\n" +
    "        </validateCredentialsResponse>\r\n" +
    "    </soap:Body>\r\n" +
    "</soap:Envelope>\r\n" +
    "";
    MessageFactory factory = MessageFactory.newInstance();
    SOAPMessage msg = factory.createMessage(new MimeHeaders(), new ByteArrayInputStream(xml.getBytes(Charset.forName("UTF-8"))));
    msg.saveChanges();
    SOAPBody soapBody = msg.getSOAPBody();
    for (Element response : elements(soapBody.getElementsByTagName("validateCredentialsResponse"))) {
      for (Element result : elements(response.getElementsByTagName("validateCredentialsResult"))) {
        List<Element> children = elements(result.getChildNodes());
        Element resultData = named(children.get(0), "ResultData");
        List<Element> resultDataChildren = elements(resultData.getChildNodes());
        boolean validated = Boolean.getBoolean(named(resultDataChildren.get(0), "validated").getTextContent());
        boolean alreadyLoggedIn = Boolean.getBoolean(named(resultDataChildren.get(1), "alreadyLoggedIn").getTextContent());
        Element status = named(children.get(1), "Status");
        List<Element> statusChildren = elements(status.getChildNodes());
        String condition = named(statusChildren.get(0), "Condition").getTextContent();
        String errorCode = named(statusChildren.get(1), "ErrorCode").getTextContent();
        String errorDesc = named(statusChildren.get(2), "ErrorDesc").getTextContent();

        System.out.printf("validated=%s alreadyLoggedIn=%s condition=%s errorCode=%s errorDesc=%s\n", validated, alreadyLoggedIn, condition, errorCode, errorDesc);
      }
    }
  }
} 
```

# c++ - 推荐的 C++ 数据库抽象层

> ID：296205
> 
> 赞同：8
> 
> 时间：2008-11-17T17:11:55.027
> 
> 标签：c++, database

您会推荐哪些数据库抽象层库与 C++ 一起使用？我对非 Windows 平台的解决方案更感兴趣，但这是个人喜好。你会推荐哪些图书馆，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T19:03:32.680

看看[SOCI](http://soci.sourceforge.net/)

显然，它是 Boost 的重要候选者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T18:57:09.153

就个人而言，我喜欢[数据库模板库](http://dtemplatelib.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T17:25:32.130

我建议使用[ODBC](http://en.wikipedia.org/wiki/Odbc)库。

这是我google时的前两个：

[libodbc++](http://libodbcxx.sourceforge.net/)

[sqlapi++](http://www.sqlapi.com/)

# javascript - 我可以对 DOM 进行单元测试吗？

> ID：296229
> 
> 赞同：3
> 
> 时间：2008-11-17T17:21:23.107
> 
> 标签：javascript, ruby-on-rails, unit-testing, dom

我们有一个 Ruby on Rails 应用程序，它在视图中使用了一些 javascript。由于我们对应用程序的其余部分有很好的测试覆盖率，我们想在这里继续。我们使用的 js 操作 DOM 以显示/隐藏 div 并执行增量搜索以从表中选择组合框。

有谁知道测试 DOM 操作的方法？

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T18:43:02.707

可以使用 java 库 HttpUnit 或 HtmlUnit 来测试被 JS 操作后完成的 DOM。

[http://htmlunit.sourceforge.net/javascript-howto.html](http://htmlunit.sourceforge.net/javascript-howto.html) [http://httpunit.sourceforge.net/doc/cookbook.html](http://httpunit.sourceforge.net/doc/cookbook.html)

两者都使用功能齐全的 JavaScript 引擎 Mozilla Rhino，然后添加自己的 DOM 实现。

这将允许您在后台自动运行这些测试，而不会产生任何浏览器或副作用。

奖励：您可以使用 JRuby 直接从 Ruby 调用这些库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T17:58:25.167

jQuery 库附带了一个非常好的单元测试库，您可以使用它来测试 dom 操作。该库称为 QUnit。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T18:19:26.623

您可以使用[YUI Test](http://developer.yahoo.com/yui/yuitest/)或[Selenium](http://selenium.seleniumhq.org/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T03:38:40.533

我刚刚[回答了一个类似的问题](https://stackoverflow.com/questions/300855/looking-for-a-better-unit-test-tool-for-javascript#300915)。简而言之：看一下[Dojo 的 DOH](http://dojotoolkit.org/book/dojo-book-0-9/part-4-meta-dojo/d-o-h-unit-testing)、[doh.robot](http://dojotoolkit.org/2008/08/11/doh-robot-automating-web-ui-unit-tests-real-user-events)和[dijit.robotx](http://blog.dojotoolkit.org/2008/10/31/doh-robot-part-2-automating-acceptance-tests-and-user-stories)（DOH 不需要使用 Dojo，它也不依赖于 Dojo）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T19:03:39.373

过去我用[jsUnit](https://github.com/pivotal/jsunit)完成了这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-07T14:53:24.727

将 capybara [https://github.com/jnicklas/capybara](https://github.com/jnicklas/capybara)与支持 JS 的驱动程序一起使用，例如 capybara-webkit 或 poltergeist。

# javascript - RegExp to match words wrapped in braces

> ID：296230
> 
> 赞同：2
> 
> 时间：2008-11-17T17:21:35.117
> 
> 标签：javascript, regex, arrays, templates, match

In javascript, I've got a block of HTML like this:

```
<h2>{title}</h2>
<p><a href="{url}">{content}</a></p> 
```

And I'm trying use regex "match" to spit out an array of all the {item}'s. So my output should look like:

```
['title', 'url', 'content'] 
```

I've gotten as far as:

```
var pattern = new RegExp("\{[a-zA-Z]+\}+");
var match = pattern.exec("{Sample} bob {text}"); 
```

But it's only returning the first tag.

This is just beyond my regex skills. Can anyone help?

Cheers!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T17:37:16.507

You need to create a pattern with the global flag:

```
var pattern = new RegExp("\{[a-zA-Z]+\}", "g"); 
```

or:

```
var pattern = /\{[a-zA-Z]+\}/g; 
```

Then you can call the match() method on your string to get a list of matches:

```
var matches = "{Sample} bob {text}".match(pattern); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T17:25:47.667

I think you want:

```
var pattern = new RegExp("\{[a-zA-Z]+\}+", "g"); 
```

The second option is a flag telling it to search the entire string and return all matches.

See: [http://www.evolt.org/article/Regular_Expressions_in_JavaScript/17/36435/](http://www.evolt.org/article/Regular_Expressions_in_JavaScript/17/36435/) for more details.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T17:49:09.587

Much as I like to roll my own RegExp (and you really just need the global flag), have you looked at [prototype templates](http://www.prototypejs.org/api/template), [Trimpath JST](http://code.google.com/p/trimpath/wiki/JavaScriptTemplates) or anything like that?

Because possibly rolling your own won't be as efficient for reuse as the above examples. EG:

```
String.prototype.template = function (obj) {
 return this.replace(/{([^{}]+)}/g,
  function (full, word) {
   return((typeof obj[word]==='string'||typeof obj[word]==='number')?obj[word]:full);
  }
 );
};

"The {adj1} {adj2} {noun}.".template({adj1: 'lazy',adj2: 'brown', noun: 'dog'})
==> "The lazy brown dog." 
```

This runs your regex each time, while I believe the prototype templates basically does it once.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T17:58:38.133

Have you tried this yet?

```
<script>
var text = '<h2>{title}</h2>\n<p><a href="{url}">{content}</a></p>';
var regex = /\{[a-z]+\}/ig;
var result = text.match(regex);
for (var i = 0; i < result.length; i++) {
    console.debug(i + ". " + result[i]);
}
/*
gives:
0\. {title}
1\. {test}
2\. {url}
3\. {content}
*/
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T17:42:29.473

I got off path by using `exec` for testing.

# apache-flex - 多语言 Flex 应用程序 - 用于嵌入特定语言的首选字体

> ID：296248
> 
> 赞同：1
> 
> 时间：2008-11-17T17:32:23.427
> 
> 标签：apache-flex

我正在开发一个使用 Flex 3 构建的协作 Web 应用程序，它需要支持多种语言。

有谁知道哪种字体最适合为中文、韩文、日文和俄文创建嵌入式字体库？我知道 Arial Unicode MS 会完成这项工作，但我不知道它是否能做得最好。

单靠本地化并不能解决整个问题：例如聊天输入和显示需要在同一个文本字段中支持多种语言——任何用中文输入的东西都需要用中文显示；用英文输入的任何内容都需要以英文显示。

使用 _sans 是一种选择，但远非首选。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-11T19:49:01.587

采用了一种基于 unicode 值切换字符 TextFormat 的方法。因此，主要语言中的字符以首选（嵌入）字体显示，而其他语言中的字符以 _sans 显示。

这效果非常好，但需要您检查添加到字段中的每个字符，并要求您在删除发生时检查所有内容。需要进行大量检查，我确信包含大量内容的文本字段会开始遇到性能问题，但这是针对聊天工具的，因此这对用例并不太重要。

# c# - 创建一个只知道类名的对象？

> ID：296251
> 
> 赞同：15
> 
> 时间：2008-11-17T17:32:43.630
> 
> 标签：c#, .net, reflection, configuration

我有一组课程，每个课程都有不同的[策略](http://en.wikipedia.org/wiki/Strategy_pattern)来完成相同的工作。

```
namespace BigCorp.SuperApp
{
    public class BaseClass { }
    public class ClassA : BaseClass { }
    public class ClassB : BaseClass { }
} 
```

使用哪种策略的选择是可配置的。我只想在 app.config 文件中配置类名“ClassB”而不是完整类型名“BigCorp.SuperApp.ClassB”。

```
<appConfig>
   <SuperAppConfig>
      <Handler name="ClassB" />
   </SuperAppConfig>
</appConfig> 
```

但是，反射调用会失败，因为它们需要完整的类型名称，尤其是

```
Type t = Type.GetType("ClassB"); // results in t == null
BaseClass c = Activator.CreateInstance(t) as BaseClass; // fails 
```

我怎样才能在只配置类名时让它工作？将命名空间连接到类名以获得完整类型名？是否有另一个有效的反射调用？

如果您认为这是无用的，并且我应该期望配置包含完整的类型名称，我愿意接受该解决方案！只要提供理由来说服我。

（我不会从这个程序集/命名空间之外加载类型）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-17T17:34:59.210

要么使用程序集限定名称，要么获取程序集并使用`Assembly.GetType(name)`. 在这种情况下，由于您需要配置文件中的类型，因此程序集限定是一种有效的方法 - 但因为您知道所有类型都在同一个程序集中：

```
Assembly assembly = typeof(SomeKnownType).Assembly; // in the same assembly!
Type type = assembly.GetType(name); // full name - i.e. with namespace (perhaps concatenate)
object obj = Activator.CreateInstance(type); 
```

静态`Type.GetType(string)`具有经常引起混淆的探测规则......它查看调用程序集和一些系统程序集 - 但不是所有加载的程序集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T18:24:22.933

由于您知道所有类都来自同一个命名空间，因此配置一次并使用它：

```
<appConfig>
   <SuperAppConfig handlerNamespace="BigCorp.SuperApp">
      <Handler class="ClassB" />
   </SuperAppConfig>
</appConfig> 
```

**编辑：**我将*名称*更改为*类*以更好地表示该属性的含义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-17T17:44:39.190

```
（我不会从这个程序集/命名空间之外加载类型）
```

由于上述行，可以安全地假设您知道命名空间是什么。你不能做这样的事情：

```
Type t = Type.GetType("Namespace." + className); 
BaseClass c = Activator.CreateInstance(t) as BaseClass; 
```

如果您希望将来能够添加要加载的其他策略类，也许通过额外的程序集，您将需要完全限定您的类名。无论如何都建议这样做，因为您将能够为您的应用程序提供增强的可扩展性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-18T15:07:26.057

我将在应用程序配置中使用完整的类型名称。下面是一个稍微完整但仍然很简单的示例

```
<SuperAppConfig>
   <ObjectConfig provider="BigCorp.SuperApp.ClassA">
      <add name="one" />
      <add name="two" />
   </ObjectConfig>
</SuperAppConfig> 
```

以及实际创建它的工厂类

```
private static Assembly a = typeof(IFactoryObject).Assembly;
public static IFactoryObject CreateObject(String providerName)
{
    Type t = a.GetType(providerName)
    IFactoryObject o = Activator.CreateInstance(t) as IFactoryObject;
    return o;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-25T10:59:14.793

```
BaseClass c = Activator.CreateInstance(t) as BaseClass; // fails 
```

也可能是因为 CreateInstance 不返回 BaseClass 的实例，而不是包装到 ObjectHandle 中的 BaseClass 的实例。

使用 UnWrap 方法后，将其转换为您的 BaseClass。

# c - 解析 C 文件

> ID：296256
> 
> 赞同：6
> 
> 时间：2008-11-17T17:34:22.503
> 
> 标签：c, parsing

我正在寻找一个基于 Windows 的库，它可用于解析一堆 C 文件以列出全局和局部变量。全局变量和局部变量可以使用 typedef 声明。然后可以将输出（即全局和局部变量列表）用于后处理（例如用新名称替换变量名称）。

有这样的图书馆吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-17T17:46:04.990

一些可用的方法：

*   [Elsa：基于 Elkhound 的 C/C++ 解析器](http://www.cs.berkeley.edu/~smcpeak/elkhound/sources/elsa/)
*   [CIL - C 程序分析和转换的基础设施](https://people.eecs.berkeley.edu/~necula/cil/)
*   [Sparse - C 的语义解析器](http://kernel.org/pub/software/devel/sparse/)
*   [clang：LLVM 的 C 语言家族前端](http://clang.llvm.org/)
*   [pycparser：用 Python 编写的 C 解析器和 AST 生成器](http://code.google.com/p/pycparser/)

[或者，您可以使用公共lex 规范](http://www.lysator.liu.se/c/ANSI-C-grammar-l.html)和[yacc 语法](http://www.lysator.liu.se/c/ANSI-C-grammar-y.html)编写自己的[lex 和 yacc](http://dinosaur.compilertools.net/)（或它们的 kinflex 和 bison）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T17:47:15.033

可能有点矫枉过正，但是有一个用 Boost.Spirit 编写的完整的 ANSI C 解析器：http: [//spirit.sourceforge.net/repository/applications/c.zip](http://spirit.sourceforge.net/repository/applications/c.zip)

也许您可以对其进行建模以满足您的需求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-14T04:39:40.203

当您考虑到不同的方言、预处理器指令、解析时对类型信息的需求等时，解析 C 比看起来要困难得多。那些告诉您“只使用 lex 和 yacc”的人显然没有做过生产 C 解析器。

可以做到这一点的工具是我们的[C 前端](http://www.semdesigns.com/Products/FrontEnds/CFrontEnd.html)

它解决了上述所有问题。

完成后，它有一个完整的、可导航的符号表，其中包含所有标识符和相应的类型信息。列出全局和局部变量将是微不足道的。

我是 Semantic Designs 背后的架构师。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T17:50:07.027

我不知道它是否提供图书馆，但看看[CTAGS](http://ctags.sourceforge.net/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T21:17:14.550

如果它是纯 C，`lex`并且`yacc`是您的朋友，但您需要考虑 C 预处理器 - 带有未扩展宏的源文件通常不符合 C 语法，因此使用 K&R 语法编写的解析器很可能会失败。

如果您决定解析预处理器的输出，请准备好您的解析器将由于特定编译器的“扩展”而失败，因为标准库头文件很可能使用它们。至少这是 GCC 的情况。

我在 GCC 上遇到了这个问题，最后决定使用不同的方法来实现我的目标。如果您只需要更改变量的名称，正则表达式就可以了，并且无需构建完整的解析器，恕我直言。如果您的目标只是收集数据，那么数据的最终来源就是调试信息。有一些方法可以从二进制文件中获取调试信息——对于带有 DWARF 的 ELF 可执行文件，有 libdwarf，对于 Windows-land（COFF ？）也应该有。可能您可以使用一些现有的工具来获取有关二进制文件的调试信息 - 再说一次，我对 Windows 一无所知，您需要进行调查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T02:47:28.863

我最近读到了一个基于 win32 的系统，它查看了 COFF dll 中的调试信息： [http ://www.drizzle.com/~scottb/gdc/fubi-paper.htm](http://www.drizzle.com/~scottb/gdc/fubi-paper.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-12T12:42:33.170

也许 gnu 项目 cflow [http://www.gnu.org/software/cflow/](http://www.gnu.org/software/cflow/)？

# c# - 使用 WPF 自定义控件，如何为自定义控件命名以通过后面的代码访问它？

> ID：296261
> 
> 赞同：5
> 
> 时间：2008-11-17T17:35:17.897
> 
> 标签：c#, wpf

当我尝试使用`Name="id"`and\or时`x:name="id"`出现编译器错误：

```
The Type 'MyName' was not found. Verify that you are not missing an assembly reference and that all referenced assemblies have been built. 
```

当我没有指定这个时，我的控件运行得很好。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-05T10:39:18.433

好吧，首先正确的语法是`x:Name`，尽管`Name`它本身通常（但并非总是）也有效。

`x:Class`根级元素上的是否与代码隐藏文件的名称（和命名空间！）匹配？我知道某些版本的 Blend 和 VS 没有正确插入默认命名空间，当然，如果您已将其更改为默认名称，则需要确保您也更改了其他文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T17:42:30.567

我以前遇到过这个问题，并认为这是一个编译器错误。我最终只是`ContentControl`在我的 XAML 中添加了一个名称，并将用户控件从后面的代码中添加到其中。希望有人可以为此分享一个实际的解决方法。

# oracle - Oracle SQL 中的“@”符号是什么意思？

> ID：296263
> 
> 赞同：16
> 
> 时间：2008-11-17T17:36:24.073
> 
> 标签：oracle, , oracle, syntax

[oracle](/questions/tagged/oracle "show questions tagged 'oracle'")`@`中的符号是什么意思？

例如：

```
select * from question_answer@abcd where id = '45' 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-17T17:54:31.603

它指的是一个非本地表，@后面的位是db描述符。

```
select * from question_answer@abcd where id = '45' 
```

表示不是从本地`question_answer`表中选择，而是从指定为 db 的表中选择`abcd`。谷歌搜索的关键字是`dblink`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-17T17:54:45.207

这是通过名为“abcd”的数据库链接访问表的语法 请参阅[CREATE DATABASE LINK](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_5005.htm#SQLRF01205)的文档，或查看定义的数据库链接：

```
SELECT * FROM all_db_links; 
```

# regex - 在 JSP EL 中使用正则表达式

> ID：296264
> 
> 赞同：11
> 
> 时间：2008-11-17T17:36:55.820
> 
> 标签：regex, jsp, el

在 jsp 页面中使用的 EL 表达式中，字符串是按字面意思获取的。例如，在以下代码片段中

```
<c:when test="${myvar == 'prefix.*'}"> 
```

如果 myvar 的值为“prefixxxxx”，则 test 不会评估为 true。有谁知道是否有办法将字符串解释为正则表达式？EL 是否有类似于 awk 的波浪号 ~ 运算符的东西？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-17T20:03:36.367

虽然可以使用 JSTL`fn:startsWith`函数处理这种特殊情况，但通常正则表达式似乎很可能是测试。不幸的是，JSTL 没有包含这些功能。

从好的方面来说，编写一个 EL 函数来做你想做的事情是很容易的。您需要函数实现和 TLD 来让您的 Web 应用程序知道在哪里可以找到它。将它们放在一个 JAR 中并将其放入您的 WEB-INF/lib 目录。

这是一个大纲：

com/x/taglib/core/Regexp.java：

```
import java.util.regex.Pattern;

public class Regexp {

  public static boolean matches(String pattern, CharSequence str) {
    return Pattern.compile(pattern).matcher(str).matches();
  }

} 
```

元信息/xc.tld：

```
<taglib xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd" version="2.0">
  <tlib-version>1.0</tlib-version>
  <short-name>x-c</short-name>
  <uri>http://dev.x.com/taglib/core/1.0</uri>
  <function>
    <description>Test whether a string matches a regular expression.</description>
    <display-name>Matches</display-name>
    <name>matches</name>
    <function-class>com.x.taglib.core.Regexp</function-class>
    <function-signature>boolean matches(java.lang.String, java.lang.CharSequence)</function-signature>
  </function>
</taglib> 
```

抱歉，我没有测试这个特定的功能，但我希望它足以为您指明正确的方向。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-23T00:50:27.410

只需将以下内容添加到 WEB-INF/tags.tld

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<taglib version="2.1"
        xmlns="http://java.sun.com/xml/ns/javaee"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
        http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd">

    <display-name>Acme tags</display-name>
    <short-name>custom</short-name>
    <uri>http://www.acme.com.au</uri>
    <function>
        <name>matches</name>
        <function-class>java.util.regex.Pattern</function-class>
        <function-signature>
            boolean matches(java.lang.String, java.lang.CharSequence)
        </function-signature>
    </function>
</taglib> 
```

然后在你的jsp中

```
<%@taglib uri="http://www.acme.com.au" prefix="custom"%>
custom:matches('aaa.+', someVar) } 
```

[这将与Pattern.match](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#matches%28java.lang.String,%20java.lang.CharSequence%29)完全相同

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-17T17:52:47.193

您可以像这样使用 JSTL 函数 -

```
<c:when test="${fn:startsWith(myVar, 'prefix')}"> 
```

看看：http: [//java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fn/tld-summary.html](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fn/tld-summary.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-05T14:54:18.963

对于在我的情况下在 jsp 页面中使用 Pattern.matches 来说，调用 java.util.regex.Pattern.matches(regexString,stringToCompare) 就足够了，因为你不能在 jsp 中导入包

# .net - .NET 和/或 ASP.NET 项目是否有推荐的、建议的或常规的结构？

> ID：296268
> 
> 赞同：6
> 
> 时间：2008-11-17T17:37:20.623
> 
> 标签：.net, asp.net, project-management

我正在考虑开始一个相当大规模的 .NET 或 ASP.NET 项目（我还没有决定，但很可能最终，它也可以从用 .NET 编写的桌面应用程序访问）作为 ASP.NET Web 应用程序）。但是，我不确定是否有传统的方式来构建项目。

该项目本身是一个资源/知识管理工具，可跟踪许多知识来源——人员、出版物（书籍、期刊、杂志）、网络资源、数字文档（包括 PDF、Word 文档、ODF 文档、MP3 等）等我认为合适。当然，因为它太大了，我希望能够一次实现和测试一个部分，但将它们集成到一个系统中。

一旦我完成并测试了一两个部分，我想将其作为开源工具发布。但是，如果其他人要为此工作，我想向他们展示一个易于理解的结构。但是，我从来没有参与过 ASP.NET 项目，而且自从 2.0 框架是新的时候，我就没有接触过 .NET。我正在寻找 .NET 社区中存在的任何约定，以及关于如何构建如此大规模的项目以使设计、开发、测试、使用和维护尽可能简单和轻松的任何一般约定使用或从事此项目的任何人。

**编辑 1：**我不仅在寻找模式（就像 Toran Billups 指出的那样），而且还在寻找目录结构、项目结构（如在 VisualStudio 项目中）和文档结构。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T17:46:11.403

如果您正在使用 Web 表单技术并希望能够使用相同的代码库创建桌面应用程序，我建议使用模型视图演示器模式将 UI 从业务编码中分离出来。除了这种方法，我建议创建一个服务层来处理 Presenter 类之外的逻辑（包括数据访问/业务逻辑）。

我发现创建一个类库来保存这个与 UI 无关的代码可以很容易地重用这个代码。如果您采用该路线，此架构还有助于简单的 Web 服务转换，因为您的服务输入/输出在您的类库中应该与它们在 Web 服务（WCF 或 ASMX）中的相同

我建议伟大的 JP Boodhoo 从 MSDN 撰写[这篇](http://msdn.microsoft.com/en-us/magazine/cc188690.aspx)出色的文章。我遵循相同的结构，最大的好处是我的 UI 不会驱动我的业务线应用程序。它们也更易于维护和重用。我可以让 Web 表单应用程序使用我的 WPF 应用程序使用的相同类库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T19:09:08.037

对于代码树布局，我通常会这样做：

```
projectname/
           /source/
           /source/projectname.sln
           /source/DataAccess/
           /source/DataAccess/DataAccess.csproj
           /database/schema/
           /database/schema/something.sql
           /database/testdata/
           /database/refdata/
           /tools/
           /COTS/
           /COTS/vendorname/
           /COTS/vendorname/somelib.dll
           /doc/
           /build/
           /installer/
           /projectname.build 
```

所以顶级目录包含项目的构建文件。这可以是ant、make等。我们使用FinalBuilder。然后你有每个源、数据库、工具、COTS、doc 等的子目录。你可能会想到其他的，但这些是显而易见的。

我通常包含一个构建文件夹，用于暂存构建的输出。这将是您的安装程序查找其文件的地方。

源代码树的顶部是我的 Visual Studio 解决方案文件。每个子项目都有自己的子目录，其中包含其 vs 项目文件和其他所有内容。我喜欢将东西封装在相当小的项目中，所以我可能在一个解决方案中有 10 个项目，每个项目在源代码下都有自己的子目录。

数据库脚本可以按你喜欢的方式分开，但尽量保持结构和数据分开。

工具用于构建此项目所需的杂项。

COTS 适用于您购买或下载的、您依赖但无法自行构建的外部事物。

# python - Python 中哪个更有效：标准导入还是上下文导入？

> ID：296270
> 
> 赞同：4
> 
> 时间：2008-11-17T17:37:44.647
> 
> 标签：python

如果这个问题似乎是补救措施，我提前道歉。

这在 Python 中会被认为更有效：

**标准进口**

```
import logging

try:
  ...some code...
exception Exception, e:
  logging.error(e) 
```

...或者...

**上下文导入**

```
try:
  ...some code...
exception Exception, e:
  import logging
  logging.error(e) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T17:45:08.470

上下文导入在技术上更有效，但我认为它们会产生其他问题。

稍后，如果您想添加类似的 except 子句，您现在有两个地方来维护相同的代码块。您现在还有测试异常的问题，以确保第一次导入不会在您的代码中导致任何不可预见的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T18:16:05.740

这取决于您执行上下文导入的频率。

一条`import`语句需要检查模块是否存在，它的成本不为零。

大量的上下文导入将成为性能损失，而不会真正获得简单性。没有什么好处，除非您真的确定很少或从不使用导入。

语句中的上下文导入`if`是有意义的，尤其是在顶层完成时，这意味着恰好一次。

```
if someConfig:
    import this as bigDeal
else:
    import that as bigDeal 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T18:51:53.953

这是一个微优化。别担心。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T17:42:01.550

它们本质上是一样的。Python 解释器只会加载使用过的模块*一次*，无论您导入多少次。更改 import 语句的位置只会影响名称的绑定位置——例如，如果您的`import`语句位于函数内部，则名称只能在该函数中使用。

不过，一般来说，导入通常在尽可能靠近文件“顶部”的地方进行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T22:22:26.290

The performance differences between these two approaches will be very small in practice. I have never seen a case where this has made a difference that was noticeable.

It is worth remembering that the python interpreter will only ever do the work of parsing the module once when it is 1st imported.

In general you will end up with more maintainable code it you just import all the modules you need at the top of the file.

# .net - Visual Studio 安装程序不包括附属资源程序集

> ID：296278
> 
> 赞同：1
> 
> 时间：2008-11-17T17:38:58.407
> 
> 标签：.net, visual-studio, installation, assemblies, satellite

我有一个安装 .NET Windows 服务的 VS2008 安装程序项目。该服务的依赖项之一是 .NET 程序集，它具有卫星程序集形式的本地化资源。由于某种原因，安装程序没有打包或安装卫星组件，因此服务将无法启动。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T18:03:00.010

如果您在解决方案资源管理器中右键单击项目并选择查看 > 文件，您可以看到哪些文件将安装到目标计算机。

它可能就像在目标机器的应用程序目录中添加本地化资源文件作为输出一样简单。

但是，请检查安装程序项目的依赖项并确保列出所有项目（主程序集和其他项目）。

希望有帮助！

# c++ - 如何制作从基类派生的 ATL COM 类？

> ID：296283
> 
> 赞同：9
> 
> 时间：2008-11-17T17:39:55.877
> 
> 标签：c++, visual-studio, com, atl, classwizard

“ATL 简单对象”向导不提供指定新类派生自现有 coclass 及其接口的方法。在 Visual Studio 2008 中，如何从现有的 ATL COM 类派生一个新的 ATL COM 类（即`Base`implements `IBase`，我想创建一个从该 implements`Derived`派生的新类，其中派生自。）`Base``IDerived``IDerived``IBase`

更新：听起来很简单，但是向导生成的 ATL 类最多有六个基类、一个 COM 映射和一个连接点映射。哪些基类和映射应该在派生类中重复？如果在派生类中重复映射，它们应该包含基类映射的内容还是仅包含附加项？基类的顺序重要吗？`FinalConstruct()`和怎么样`FinalRelease()`？是否应该在派生`DECLARE_PROTECT_FINAL_CONSTRUCT`类`DECLARE_REGISTRY_RESOURCEID`中重复？

这是一个除所有样板外为空的示例基类。现在派生类应该是什么样子？

```
class ATL_NO_VTABLE CBase :
    public CComObjectRootEx<CComSingleThreadModel>,
    public CComCoClass<CBase, &CLSID_Base>,
    public ISupportErrorInfo,
    public IConnectionPointContainerImpl<CBase>,
    public CProxy_IBaseEvents<CBase>,
    public IDispatchImpl<IBase, &IID_IBase, &LIBID_ExampleLib, /*wMajor =*/ 1, /*wMinor =*/ 0>
{
public:
    CBase()
    {
    }

DECLARE_REGISTRY_RESOURCEID(IDR_Base)

BEGIN_COM_MAP(CBase)
    COM_INTERFACE_ENTRY(IBase)
    COM_INTERFACE_ENTRY(IDispatch)
    COM_INTERFACE_ENTRY(ISupportErrorInfo)
    COM_INTERFACE_ENTRY(IConnectionPointContainer)
END_COM_MAP()

BEGIN_CONNECTION_POINT_MAP(CBase)
    CONNECTION_POINT_ENTRY(__uuidof(_IBaseEvents))
END_CONNECTION_POINT_MAP()
// ISupportsErrorInfo
    STDMETHOD(InterfaceSupportsErrorInfo)(REFIID riid);

    DECLARE_PROTECT_FINAL_CONSTRUCT()

    HRESULT FinalConstruct()
    {
        return S_OK;
    }

    void FinalRelease()
    {
    }
};

OBJECT_ENTRY_AUTO(__uuidof(Base), CBase) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T16:07:31.810

只是一个建议——如果你的 COM 对象不需要对 COM 相关的东西做任何特殊的事情，那么你可以实现代码，这样你的基本 COM 类所做的真正逻辑被封装在另一个普通的旧 C++ 类中，比如 CBaseLogic。

```
CBaseLogic : IBase

class ATL_NO_VTABLE CBase :
    public CComObjectRootEx<CComSingleThreadModel>,
    public CComCoClass<CBase, &CLSID_Base>,
    public ISupportErrorInfo,
    public IConnectionPointContainerImpl<CBase>,
    public CProxy_IBaseEvents<CBase>,
    public IDispatchImpl<IBase, &IID_IBase, &LIBID_ExampleLib
{
CBaseLogic m_LogicObj; /* Method calls are simply forwarded to this member */
};

CDerivedLogic : public CBaseLogic

class ATL_NO_VTABLE CDerived :
    public CComObjectRootEx<CComSingleThreadModel>,
    public CComCoClass<CDerived, &CLSID_Base>,
    public ISupportErrorInfo,
    public IConnectionPointContainerImpl<CDerived>,
    public CProxy_IBaseEvents<CDerived>,
    public IDispatchImpl<IBase, &IID_IBase, &LIBID_ExampleLib
{
CDerivedLogic m_LogicObj;
}; 
```

这实现了您正在尝试做的附加优势

1.  将您的真实程序逻辑与基础架构/打包 (COM) 分开
2.  使真正的逻辑平台独立。
3.  未来的维护者不需要了解你聪明的 COM hack
4.  使您的程序逻辑保持干净并远离 COM 语法，提高可读性
5.  使在其他形式的封装中更容易重用真实逻辑，例如作为 C DLL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T23:41:29.110

编辑向导生成的代码。如果您希望对象从其他接口派生，请将这些基类添加到生成的类声明中。

# asp.net-mvc - MVC 动态路由

> ID：296284
> 
> 赞同：3
> 
> 时间：2008-11-17T17:40:25.143
> 
> 标签：asp.net-mvc, model-view-controller, url, routes

我想创建动态 url，路由到具有 Id 值的控制器操作。我使用包罗万象的参数创建了以下路线

```
routes.MapRoute(
            "RouteName",                                                 
            "{id}/{*Url}",
            new { controller = "Controller", action = "Action", id = "" }
        ); 
```

这可以按预期工作，并允许我使用以下网址：

“ [http://website.com/1/fake/url/path](http://website.com/1/fake/url/path) ”（1 是传递给操作方法的 id）

有谁知道在不创建我自己的 http 模块的情况下以这种方式实现它的方法？：

“ [http://website.com/fake/url/path/1](http://website.com/fake/url/path/1) ”

谢谢 - 马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T00:11:07.583

无论如何，这对我来说真的很难。

给定以下路线：

```
routes.MapRoute("Default", "{*token}", 
    new { controller = "Home", action = "Index", token = 0 }); 
```

您的控制器和支持类将是这样的：

```
[HandleError]
public class HomeController : Controller
{
    public ActionResult Index([ModelBinder(typeof(IndexReqquestBinder))] IndexRequest request)
    {
        ViewData["Title"] = "Home Page";
        ViewData["Message"] = String.Format("We're looking at ID: {0}", request.ID);

        return View();
    }
}

public class IndexRequest
{
    public Int32 ID { get; set; }
    public IndexRequest(Int32 id)
    {
        this.ID = id;
    }
}

public class IndexReqquestBinder : IModelBinder
{
    public ModelBinderResult BindModel(ModelBindingContext bindingContext)
    {
        if ( null != bindingContext.RouteData.Values["token"] ) {
            foreach ( String v in bindingContext.RouteData.Values["token"].ToString().Split('/') ) {
                Int32 id = 0;
                if ( Int32.TryParse(v, out id) ) {
                    return new ModelBinderResult(new IndexRequest(id));
                }
            }

        }
        return new ModelBinderResult(new IndexRequest(0));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-18T08:04:18.610

路由重定向基于路由表中的路由条目。它必须以系统的方式进行。例如，如果您在 {controller}/{action}/{id}（mvc 的默认值）之后将路由作为“customurl/id”，当您在 url 框中输入“customurl”时，它将把它作为默认路由并且没有页面会发生发现异常。因此，如果您想使用自定义路由，请先删除默认路由。我喜欢这样做。

```
RouteCollection routes = RouteTable.Routes;
                    if (routes["rname"] != null)
                    {
                        RouteTable.Routes.Remove(routes["rname"]);
                    }
                         routes.Remove(routes["Default"]);                           
                        routes.MapRoute(
                            name: "newname",
                            url: url + "/{customId}",
                            defaults: new { controller = "Search", action = "Index", customId = UrlParameter.Optional }
                            );

                        //default route value
                        routes.MapRoute(
                            name: "Default",
                            url: "{controller}/{action}/{id}",
                            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
                            ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T08:18:25.220

我建议覆盖 DefaultControllerFactory

```
> public class CustomControllerFactory : DefaultControllerFactory
>   {
> public override IController
> CreateController(System.Web.Routing.RequestContext
> requestContext, string controllerName)
>         {
>             try
>             {
>                 return base.CreateController(requestContext,
> controllerName);
>             }
>             catch (Exception exception)
>             {
>                 // collect route data
>                 string id = (string)requestContext.RouteData.Values["id"];
>                 string action = (string)requestContext.RouteData.Values["action"];
>                 // set full path as routing "page" parameter
>                 VirtualPathData path = requestContext.RouteData.Route.GetVirtualPath(requestContext,
> requestContext.RouteData.Values);
>                 requestContext.RouteData.Values["id"]
> = path.VirtualPath; // or anything you need
>                 // use controller page by default
>                 controllerName = "MyController";
>                 // set basuc routing data
>                 requestContext.RouteData.Values["controller"]
> = controllerName;
>                 requestContext.RouteData.Values["action"]
> = "index";
>                 // call base method to create controller
>                 return base.CreateController(requestContext,
> controllerName);
>             }
>         }
>} 
```

而不仅仅是在 global.asax.cs 文件中将其注册为默认控制器工厂

```
protected void Application_Start()
        {
            ControllerBuilder.Current.SetControllerFactory(new MyNameSpace.CustomControllerFactory ());
            RegisterRoutes(RouteTable.Routes); // this already exists by default
        } 
```

# maven-2 - 使用 Maven 安装包

> ID：296294
> 
> 赞同：2
> 
> 时间：2008-11-17T17:42:08.850
> 
> 标签：maven-2

如何使用 Maven 安装特定的包，如 derbytools，而不将其指定为项目的依赖项？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T17:49:22.097

这是使用`mvn install`目标的示例。我使用 Windows 风格的环境变量代替您需要提供的参数。

```
mvn install:install-file -DgroupId=%DERBYTOOLS_GROUP_ID% \ 
    -DartifactId=%DERBYTOOLS_ARTIFACT_ID% \
    -Dversion=%DERBYTOOLS_VERSION% \
    -Dpackaging=jar \
    -Dfile=%DERBYTOOLS_FILE_PATH% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-19T23:11:41.763

# c# - 打开文件进行共享写入

> ID：296309
> 
> 赞同：4
> 
> 时间：2008-11-17T17:47:27.420
> 
> 标签：c#, .net, file-io, concurrency

以下代码只是演示我的问题的简化示例：

```
using System;
using System.IO;
using System.Diagnostics;
using System.Threading;

namespace ConsoleApplication5
{
    class Program
    {
        static string LogFile = @"C:\test.log";

        static void Main(string[] args)
        {
            for (int i = 0;i<10;i++)
            {
                new Thread(new ParameterizedThreadStart(DoWork)).Start(i);
            }
            Console.ReadKey();
        }

        static void DoWork(object param)
        {
            int count = (int)param;

            try
            {
                using (FileStream fs = new FileStream(LogFile, FileMode.Append, FileAccess.Write, FileShare.ReadWrite))
                using (StreamWriter sw = new StreamWriter(fs))
                {
                    sw.WriteLine(DateTime.Now + " - Start " + count.ToString());
                    Thread.Sleep(2000); // simulate doing some work
                    sw.WriteLine(DateTime.Now + " - End " + count.ToString());
                }
            }
            catch (Exception e)
            {
                Console.WriteLine(count.ToString() + ": " + e.Message);
                return;
            }
            Console.WriteLine(count.ToString() + ": Done.");
        }
    }
} 
```

这里的问题是通常只有一个条目进入文件，即使我调用该方法 10 次。该文件应打开以允许共享。据我所知，没有抛出异常。这是怎么回事？

在这个示例所覆盖的实际代码中，对 DoWork 的每次调用实际上都在一个单独的进程中，尽管测试表明结果是相同的——如果我可以在这里修复它，我可以在那里修复它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T18:05:48.197

这里没有什么奇怪的事情发生。想象一下，您有一个文件“a.txt”，您在记事本中打开它 10 次。之后，您更改文件的内容并将其保存在记事本的每个实例中。自然，您进行的最后一次保存是持久保存到文件中的那个，因为它会重写之前的 9 次保存。

我认为你在这里有同样的行为。所有文件同时打开，因为您在每个处理中都有一个 Thread.Sleep 。所以要保存的 i 文件会覆盖之前的保存 (i-1)。

编辑：尝试删除 Thread.Sleep(2000) ，您将在文件中有更多日志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T14:20:13.540

使用`SyncLock`它确保一次只有一个线程打开文件。同时，其他进程不会崩溃，而是在`queue`.

# java - 弹簧豆配置

> ID：296312
> 
> 赞同：5
> 
> 时间：2008-11-17T17:48:31.913
> 
> 标签：java, spring

我正在使用 Spring 的依赖注入，但在我的 Spring 配置文件中加载资源时遇到了困难。

该资源是一个 XML 文件，位于我的类路径上的一个 JAR 文件中。我尝试按如下方式访问它：

```
<import resource="classpath:com/config/resources.xml" /> 
```

但是我不断遇到以下错误：

> 无法从 URL 位置导入 bean 定义 [classpath:com/config/resources.xml]

JAR 文件位于 Java 项目的类路径上，而我的 Web 应用程序又使用了该类路径。我真的应该在 Web 项目中而不是 Java 项目中进行 Spring 配置，还是这有关系？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T18:03:18.717

如果它需要在您的 webapp 的类路径中，那么您应该将包含配置文件的 JAR 粘贴到您的 WEB-INF/lib 目录中。

如果您使用的是 webapp，那么常见的约定是使用 ContextLoaderListener 来确保将 WebApplicationContext 插入到 ServletContext 中的标准位置：

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath:/com/config/resources.xml</param-value>
</context-param> 
```

然后使用[WebApplicationContextUtils](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/context/support/WebApplicationContextUtils.html)将应用程序上下文从 servlet 上下文中提取出来，使用：

```
WebApplicationContext wac = WebApplicationContextUtils.getRequiredWebApplicationContext(getServletContext()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-19T19:42:23.950

我在使用 red5 插件时遇到了类似的问题。我是这样解决的：

```
try {
  subContext = new FileSystemXmlApplicationContext(new String[] { "classpath*:/myconfig.xml" }, true, context);
} catch (Exception fnfe) {
  subContext = new FileSystemXmlApplicationContext(new String[] { "plugins/myconfig.xml" }, true, context);
} 
```

这将首先查看类路径上的任何位置，包括在包含我的代码的 jar 中。如果发生异常，则检查插件目录。它可能不是最好的解决方案，但它确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T18:26:33.973

我真的不记得为什么这很重要，但是尝试*在冒号 (:) 类路径前加一个星号 ()*：/ 如果这不起作用，请尝试在冒号 (类路径：*) 后加一个星号，尽管我认为它在结肠之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T19:18:43.010

我只`<import>`在 J2SE 中使用过该指令，它没有`classpath:`前缀就可以工作，就像`<import resource="config/resources.xml" />`. 但是在 J2EE 中，如果您的所有文件都在 WEB-INF 中，它应该是相似的，只需 import resource="bla.xml" 就可以找到它，尽管在 J2EE 中您不需要这样做，因为在 web.xml 中您可以在 web.xml 中的 context 参数中定义多个文件`contextConfigLocation`，只需用空格或换行符分隔它们即可。

# .net - 在 VB.Net 中将您自己的自定义命名空间添加到我的命名空间

> ID：296318
> 
> 赞同：2
> 
> 时间：2008-11-17T17:50:14.203
> 
> 标签：.net, vb.net, my-namespace

我知道如何向 MY 命名空间添加方法，但我想做的是创建自己的命名空间。例如。My.Nation.State.City.Restraunt 之类的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T18:19:07.450

请参阅[msdn](http://msdn.microsoft.com/en-us/library/bb531245.aspx)或[codeproject](http://www.codeproject.com/KB/vb/myextensions.aspx)。我相信您想要的将属于“将自定义对象添加到我的命名空间”保护伞下。

# java - 除了 JSF/JSP for Java EE，还有其他强集成的表示层工具吗？

> ID：296325
> 
> 赞同：2
> 
> 时间：2008-11-17T17:52:49.017
> 
> 标签：java, jakarta-ee, presentation-layer

我在大学教 Java EE，这是一个学生问的问题。我说“不”，但我不太确定，所以我想我可能会问你们强大的开发人员。:)

基本上，我想做的是在我的上下文中使用实体：cat getter、setter 等，就像普通的 POJO 一样。如果我使用使用其远程接口的 EJB，实体将与核心基础设施分离，所以这是不行的。

我想过在我的硕士论文中写一个这样的层。如果这是一个死主意，请随时告诉我。如果不是，请告诉我你是否想要一个。

或者如果那里有这样的工具，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-19T21:14:12.120

在一个基本的现代世界 Java EE 应用程序中，它分为多个层，其中有 4 个基本层

```
+--------------------+
|   Presentation     |
+--------------------+
| Controller/Actions |
+--------------------+
| Business Delegate  |
|     (Service)      |
+--------------------+
|  Data Access Layer |
+--------------------+
|      Database      |
+--------------------+ 
```

您的应用程序应该从一开始就分成这些层，这样您就可以在任何给定的时间点替换任何层而不影响它的任何兄弟层。

例如，如果您将 JDBC 用于数据访问层，您应该能够将其替换为 Hibernate，而不会影响业务委托或数据库层。使用这种架构的好处是允许与多种技术进行协作。您的业​​务代表（服务层）应该能够与 Web 服务对话并处理应用程序处理，甚至无需使用浏览器！

关于使用 JSP 作为表示层，还有其他可用的技术，例如，[velocity](http://velocity.apache.org/)，[freemarker](http://freemarker.sourceforge.net/)，正如上面提到的 iberck，tapestry 也有它自己的渲染引擎。您也可以使用 XML + XSLT 来呈现 UI。还有一些 UI 管理应用程序，如[Tiles](http://tiles.apache.org/)和[sitemesh](http://www.opensymphony.com/sitemesh/)，可帮助您将各种技术集成为页面的不同组件并将它们显示为一个。

[您还可以使用结合JNLP](http://java.sun.com/javase/technologies/desktop/javawebstart/1.2/docs/developersguide.html)的轻量级 Swing 组件并开发桌面风格的企业应用程序。我们所需要的只是一点想象力和客户要求，我们可以使用任何东西作为表示层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T19:48:33.340

我从未尝试过，但是 JSF 应该与[Facelets](https://facelets.dev.java.net/)一起工作比与 JSP 一起工作得更好。

IBM 有[一篇](http://www.ibm.com/developerworks/java/library/j-facelets/)关于它的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T10:21:22.250

啊。看来您没有正确回答我的问题:)

Bean 用于在应用程序内部提供服务。假设我想开发一个带有 swing gui 的独立 java 应用程序，并且我想从该应用程序中使用存在于 java ee 应用程序范围内的实体。

这就是我想要无缝的：创建实体，修改它们，以直观的方式删除它们，而不关心 EntityManager 分离问题（如果你远程调用 EJB 并且它传回一个实体对象，它将被分离返回前）。

我不想开发 Web 应用程序。JSF/JSP 等是强集成的，但在许多环境中，独立的客户端应用程序会更好。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T21:13:34.790

在中间看到您的评论，我看到您想要一个基于 Java EE 的桌面框架。

这里的答案是 JSF 在 servlet api 上工作。而且绝对是用于网络的，但是等等，你仍然可以在你的应用程序中嵌入 tomcat 或 jetty！

可能性几乎是无限的，如果您的业务层定义明确，只需构建一个调用您的业务功能的摇摆层。

此外，Java EE 是一种 API，可以替换某些部分，或者您可以只使用其中的一部分。该容器主要用于处理 EJB、Servlets JNDI 和其他小东西。所有这些都可以被桌面应用程序使用。

因此，答案取决于您的具体目标和应用程序的实际设计/实现。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-17T18:35:14.580

一种替代方法是[Spring Framework](http://www.springframework.org/)。Spring 为将实体对象绑定到视图提供了自己的支持，并在连接后为您处理获取/设置。有许多 Spring 模块可供选择。Spring MVC 和 Spring Webflow 都值得一试。Spring MVC (IMO) 更容易上手，但 Sring Webflow 允许更复杂的导航和更多范围选项（例如：流范围）。如果您正在寻找一本书[Spring In Action](https://rads.stackoverflow.com/amzn/click/com/1933988134)是血统。为了使用 Spring，您需要处理一些概念（例如依赖注入），但值得花时间。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-17T19:35:08.950

另一种选择是[Tapestry5](http://tapestry.apache.org/tapestry5/)框架。Tapestry 是一个开源框架，用于在 Java 中创建动态、健壮、高度可扩展的 Web 应用程序。Tapestry 是对标准 Java Servlet API 的补充和构建，因此它可以在任何 servlet 容器或应用程序服务器中工作。

Tapestry 将 Web 应用程序划分为一组页面，每个页面都由组件构成。这提供了一致的结构，允许 Tapestry 框架承担关键问题的责任，例如 URL 构建和分发、客户端或服务器上的持久状态存储、用户输入验证、本地化/国际化和异常报告。开发 Tapestry 应用程序涉及使用纯 HTML 创建 HTML 模板，并将模板与少量 Java 代码组合。在 Tapestry 中，您根据对象以及这些对象的方法和属性来创建您的应用程序，而不是根据 URL 和查询参数。Tapestry 为 Java Web 应用程序带来了真正的面向对象开发。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-17T19:47:21.157

如今，bean 背后的意识形态存在于我所知道的任何适当的 Java 框架中。正如rich 所提到的，Spring 是一个很好/很棒的全方位业务逻辑框架（查看它的[jdbc 模板](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/package-summary.html)类，它们简直太棒了——另一个很棒的宝石是[applicationContext.xml](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html)），对于视图层，我个人更喜欢[Apache Wicket](http://wicket.apache.org/)。

我不认为您应该自己制作，而是找到一个适合您需求的框架并开始为其代码库做出贡献，这样您就可以从已经形成的用户群开始，并且您的代码将被更彻底地编写，这反过来又会会让你成为一个更好的程序员。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-19T10:41:54.563

grails ( [http://www.grails.org/](http://www.grails.org/) ) 或 griffon ( [http://griffon.codehaus.org/](http://griffon.codehaus.org/) ) 可能感兴趣

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-19T11:52:58.540

[StringTemplate](http://www.stringtemplate.org/)由 ANTLR 背后的人 Terrence Parr 编写。如果您对从模型生成某种文本表示感兴趣，这非常好。

使用它从同一模型生成 XML、网页和[点文件时，我取得了很好的效果。](http://www.graphviz.org)你编写一个模板来渲染一个对象。该模板可以根据从模型派生的数据调用其他模板（包括递归）。（qv[图片功能](http://www.fogcreek.com/FogBugz/blog/post/Wasabi-How-Do-I-Picture-Functions.aspx)）

Getter 和`map.get()`可直接从模板中调用。模型可以是任何 POJO。ST 以其与控制器的严格分离而自豪，因此模板本身允许的逻辑很少。

与所有这些小语言一样，它是新的学习内容，可能不是您想要的。这对我来说真的很合适。

# c# - 导入进程最大化 SQL 内存

> ID：296333
> 
> 赞同：0
> 
> 时间：2008-11-17T17:54:49.653
> 
> 标签：c#, sql-server-2005, nhibernate

我有一个作为 Windows 服务运行的导入程序进程（作为应用程序的调试模式），它处理各种 xml 文档和 csv 并导入到 SQL 数据库中。一切都很好，直到我不得不处理来自另一个表的大量数据（120k 行）（就像我处理 xml 文档一样）。

我现在发现 SQL 服务器的内存使用量达到了它刚刚挂起的程度。我的应用程序从未从服务器收到超时，一切都停止了。

我仍然可以单独调用数据库服务器，但是该应用程序线程只是卡在 SQL Activity Monitor 中没有明显的线程，并且 Profiler 中没有任何活动。

任何关于从哪里开始解决这个问题的想法都将不胜感激，因为我们已经为此苦苦挣扎了一个多星期。

基本架构是 c# 2.0，使用 NHibernate 作为 ORM 数据被拉入实际的 c# 逻辑并进行处理，然后连同日志一起返回到同一个数据库中。

* * *

有时会发生的唯一其他问题是，由于某种原因，游标正在这个庞大的表上打开，我只能假设它是从 ADO.net 生成的，正在调用像 exec sp_cursorfetch 180153005,16,113602,100 这样的语句根据 Profiler 数千次

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T23:39:06.087

你什么时候`COMMIT`做数据？是否有任何锁或死锁 (sp_who)？如果认为 120,000 行很大，那么 SQL Server 使用了多少 RAM？当应用程序挂起时，它的挂起点是否有任何信息（是`INSERT`、 查找`SELECT`还是什么？）？

在我看来，提交大小太小了。通常在 SSIS ETL 任务中，对于基数超过 1,000,000 的窄行，我将使用 100,000 的批处理大小，但即使对于非常宽的行，我也不会低于 10,000。

我不会将 ORM 用于大型 ETL，除非转换非常复杂且包含大量业务规则。尽管如此，对于大量相对简单的业务转换，我会考虑将数据加载到简单的临时表中，并使用 T-SQL 来完成所有的插入、查找等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T18:04:18.777

您是否使用 BCP 将其运行到 SQL 中？否则，事务日志可能无法跟上您的输入。在测试机器上，尝试将恢复模式设置为 Simple (non-logged) ，或使用 BCP 方法获取数据（它们绕过 T 日志记录）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T18:58:00.650

添加到 StingyJack 的答案...

如果由于处理要求而无法使用直接 BCP，您是否考虑过使用您的工具对单独的 SQL Server（单独的框）执行导入，然后运行 ​​BCP？

完成这项工作的关键是保持登台机器的清洁——也就是说，除了当前工作集之外没有任何数据。这应该可以将 RAM 使用量保持在足够低的水平以使导入工作，因为您不会使用 - 我认为 - 数百万条记录来访问表。最终结果将是第二个数据库中的单个视图或表，当所有处理完成后，可以轻松地将其 BCP 转换为真实的视图或表。

当然，缺点是有另一个盒子......还有一个更复杂的架构。这完全取决于您的架构，以及是否可以轻松支持这种事情......

我不得不用我自己的一些极其庞大和复杂的进口来做到这一点，而且它在过去运作良好。昂贵，但有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-20T23:30:34.763

我发现是 nHibernate 在大表上创建光标。我还不明白为什么，但同时我已经用直接的 ado.net 调用替换了大表数据访问模型

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-23T05:27:24.510

由于无论如何您都在重写它，您可能不知道您可以通过 System.Data.SqlClient.SqlBulkCopy 类直接从 .NET 调用 BCP。有关一些有趣的性能信息，请参阅[本文。](http://blog.stevienova.com/2008/01/16/net-fastest-way-to-load-text-file-to-sql-sqlbulkcopy/)

# lucene - 是否有一套从关系数据库构建 Lucene 索引的最佳实践？

> ID：296365
> 
> 赞同：2
> 
> 时间：2008-11-17T18:07:29.563
> 
> 标签：lucene, solr, rdbms

我正在研究使用[Lucene](http://lucene.apache.org/java/docs/)和/或[Solr](http://lucene.apache.org/solr/)在 RDBMS 驱动的 Web 应用程序中提供搜索。对我来说不幸的是，我浏览的所有文档都涉及如何从索引中获取数据。我更关心如何建立一个有用的索引。这样做有什么“最佳实践”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:05:41.367

多个应用程序会写入数据库吗？如果是这样，那就有点棘手了；您必须有一些机制来识别新记录以提供给 Lucene 索引器。

要考虑的另一点是您想要一个涵盖所有表的索引，还是每个表一个索引。一般来说，我推荐一个索引，该索引中有一个字段来指示记录来自哪个表。

[如果您想搜索持久对象而不是非结构化文档， Hibernate](http://www.hibernate.org/hib_docs/search/reference/en/html_single/)支持全文搜索。

您应该了解一个名为[Compass的 OpenSymphony 项目。](http://www.opensymphony.com/compass)我自己一直远离它，主要是因为它似乎比搜索需要的复杂得多**。**另外，从文档中我可以看出（我承认我没有时间阅读所有内容），它将 Lucene 段作为 blob 存储在数据库中。如果您熟悉 Lucene 架构，Compass 在数据库之上实现了一个 Lucene Directory。我认为这是错误的做法。我将利用数据库对索引的内置支持并实现 Lucene IndexReader。同样的批评适用于分布式缓存实现等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T22:12:30.833

我根本没有探索过这个，但是看看[LuSql](http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql)。

使用 Solr 也很简单，但是Solr schema.xml 和您的实际数据库架构会出现一些[DRY违规。](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)（仅供参考，Solr 确实支持通配符。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T19:04:39.340

作为介绍：

Brian McCallister 写了一篇不错的博客文章：[**Using Lucene with OJB**](http://kasparov.skife.org/blog/2004/09/11/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T02:37:39.487

我们今晚将推出我们的第一个使用 Solr 的应用程序。在 Solr 1.3 中，它们包含了 DataImportHandler，它允许您指定数据库表（它们称为实体）及其关系。定义后，一个简单的 HTTP 请求将触发数据的导入。

有关详细信息，请查看[DataImportHandler 的 Solr wiki 页面](http://wiki.apache.org/solr/DataImportHandler?highlight=(dataimporthandler))。

# regex - 如何从文件中提取文本行？

> ID：296366
> 
> 赞同：2
> 
> 时间：2008-11-17T18:08:34.587
> 
> 标签：regex, perl, sed, awk, grep

我有一个充满文件的目录，我需要从它们中提取页眉和页脚。它们都是可变长度的，所以使用 head 或 tail 是行不通的。每个文件都有一行我可以搜索，但我不想在结果中包含该行。

通常是

```
*** Start (more text here) 
```

并以

```
*** Finish (more text here) 
```

我希望文件名保持不变，所以我需要覆盖原件，或者写入不同的目录，我会自己覆盖它们。

哦，是的，它当然是在 linux 服务器上，所以我有 Perl、sed、awk、grep 等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T19:54:14.060

试试[人字拖！](http://perldoc.perl.org/perlop.html#Range-Operators)“..“ 操作员。

```
# flip-flop.pl
use strict;
use warnings;

my $start  = qr/^\*\*\* Start/;
my $finish = qr/^\*\*\* Finish/;

while ( <> ) {
    if ( /$start/ .. /$finish/ ) {
        next  if /$start/ or /$finish/;
        print $_;
    }
} 
```

然后你可以使用 -i perl 开关来更新你的文件，就像这样.....

```
 $ perl -i'copy_*' flip-flop.pl data.txt 
```

...这会更改 data.txt，但会事先将副本复制为“copy_data.txt”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T23:26:50.950

GNU coreutils 是你的朋友...

```
csplit inputfile %^\*\*\* Start%1 /^\*\*\* Finish/ %% {*} 
```

这会将您想要的文件生成为`xx00`. `--prefix`您可以通过选项、`--suffix`和更改此行为`--digits`，但请自行查看[手册](http://www.gnu.org/software/coreutils/manual/html_node/csplit-invocation.html#csplit-invocation)。由于`csplit`设计用于生成多个文件，因此无法生成没有后缀的文件，因此您必须手动或通过脚本进行覆盖：

```
csplit $1 %^\*\*\* Start%1 /^\*\*\* Finish/ %% {*}
mv -f xx00 $1 
```

根据需要添加循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T18:23:54.477

要获取**标题**：

```
cat yourFileHere | awk '{if (d > 0) print $0} /.*Start.*/ {d = 1}' 
```

要获取**页脚**：

```
cat yourFileHere | awk '/.*Finish.*/ {d = 1} {if (d < 1) print $0}' 
```

根据需要从**页眉到页脚**获取文件：

```
cat yourFileHere | awk '/.*Start.*/ {d = 1; next} /.*Finish.*/ {d = 0; next} {if (d > 0) print $0}' 
```

还有另一种方法，使用 csplit 命令，您应该尝试以下操作：

```
csplit yourFileHere /Start/ /Finish/ 
```

并检查名为 'xxNN' 的文件，其中 NN 是运行编号，还请查看[csplit 手册页](http://www.manpagez.com/man/1/csplit/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T18:17:15.177

也许？从不删除开始到完成。

```
$ sed -i '/^\*\*\* Start/,/^\*\*\* Finish/d!' * 
```

或者......不太确定......但是，如果它有效，也应该删除 Start 和 Finish 行：

```
$ sed -i -e '/./,/^\*\*\* Start/d' -e '/^\*\*\* Finish/,/./d' * 
```

`d!`可能取决于`sed`你的体型——不确定。
而且，我完全是在（可能很差）内存上写的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T18:34:51.333

一个快速的 Perl hack，未经测试。我在 sed 或 awk 方面不够流利，无法通过它们获得这种效果，但我会对如何做到这一点感兴趣。

```
#!/usr/bin/perl -w
use strict;
use Tie::File;
my $Filename=shift;  
tie my @File, 'Tie::File', $Filename or die "could not access $Filename.\n";  
while (shift @File !~ /^\*\*\* Start/) {};  
while (pop @File !~ /^\*\*\* Finish/) {};  
untie @File; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T19:37:24.297

覆盖原始文件的 Perl 解决方案。

```
#!/usr/bin/perl -ni
if(my $num = /^\*\*\* Start/ .. /^\*\*\* Finish/) {
    print if $num != 1 and $num + 0 eq $num;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T22:52:31.690

perlfaq5中的一些示例[：如何在文件中更改、删除或插入一行，或附加到文件的开头？](http://faq.perl.org/perlfaq5.html#How_do_I_change_dele)可能会有所帮助。你必须使它们适应你的情况。此外，Leon 的触发器运算符答案是在 Perl 中执行此操作的惯用方式，尽管您不必修改文件即可使用它。

# c++ - 用于将 DOC 和其他 MS-Office 文件转换为图像的开源库

> ID：296367
> 
> 赞同：2
> 
> 时间：2008-11-17T18:08:36.350
> 
> 标签：c++, image, ms-office, documents

你能推荐一个开源库（C 或 C++）来将 MS Office 文件转换成一组图像吗？

我正在评估 ImageMagick，虽然它确实支持 PDF 文件，但它不适用于 MS Office 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T18:21:41.673

这个库非常流行，被 abiword (gnome) 和 kword (kde) 使用：[wvWare](http://wvware.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T13:50:00.593

嗯，我已经看到 OpenOffice 在“翻译”Word 方面做得很好，那么如何安装 OpenOffice 并使用它的 C++ 的 UNO 模型来解决这个问题呢？

# sql - 如何在 H2 SQL 中查看属性

> ID：296372
> 
> 赞同：0
> 
> 时间：2008-11-17T18:10:03.100
> 
> 标签：sql, h2

如何使用 SELECT 查询查看属性？我有一些属性需要查看正在运行的 H2 DB 中的值。我已经启动并运行了控制台应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T18:19:08.183

好的，就像我想象的那样简单。假设属性是“SIZE”，那么

```
SELECT @SIZE 
```

德欧

# networking - 生成图形的图片/图形

> ID：296377
> 
> 赞同：3
> 
> 时间：2008-11-17T18:13:19.677
> 
> 标签：networking, drawing, visualization, graph-theory, shortest-path

在研究跨网络的最短路径算法时，我想生成网络的图片。我想表示节点（圆）、链接（线）、遍历链接的成本（链接线中间的数字）和链接的容量（链接线上它代表的节点旁边的数字）在图片里。是否有任何库/软件可以帮助自动创建此图片？

我可以在 Visio 或使用某些绘图应用程序中手动执行此操作，但我想在更改/调整网络时从代码生成它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T18:22:56.227

听起来像是[GraphViz](http://www.graphviz.org/ "图形可视化")的工作，它从一个简短的文本描述文件生成图形。我用它来生成连接节点图，我相信应该可以根据需要添加链接标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T18:16:24.600

如果您使用的是 python，[Nodebox 会](http://nodebox.net/code/index.php/Graph)绘制漂亮的图形。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T18:27:24.190

像这样显示网络的一个大问题是弄清楚将节点放在显示屏上的什么位置。如果根据您的网络安排节点在逻辑上很简单，那么现成的产品可能会满足您的需求。

如果安排要复杂得多，您可能必须接受一定程度的手动干预才能使其与现成的东西一起工作，或者自己咬紧牙关并自己编程整个事情。

.NET 是一种选择，一旦你掌握了 Graphics 类，它就很容易使用，而且速度很快。但是，对于像这样的面向图形的东西，可能有比 .NET 更好的语言/平台。

**更新**：.NET 对于 2D 图形比我知道的要好得多。关键是找到一个快速的解决方法来解决 Bitmap 类中慢得可怜的 GetPixel() 和 SetPixel() 方法。一旦您可以轻松快速地读取和写入单个像素，您就可以作为程序员做任何您想做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T18:18:00.153

您是否偶然检查了 R 编程语言？我不是很肯定，但我相信你可以用图表制作图像等。r-project.org

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-17T18:17:16.473

这里有一堆各种算法的可视化：[Algorithmics Animation Workshop](http://www.cse.yorku.ca/~aaw/)

# apache - 处理蠕虫 URL 的最佳实践

> ID：296389
> 
> 赞同：1
> 
> 时间：2008-11-17T18:18:12.710
> 
> 标签：apache, http

我们一直在收到表单的请求（来自蠕虫？）

```
http://www.example.com/MSOffice/cltreq.asp?...
http://www.example.com/_vti_bin/owssvr.dll?...

```

处理这些问题的最佳做法是什么？

我考虑过返回 404 或尝试终止连接，同时在另一端保持打开状态。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T18:22:31.673

我只是在类似的东西上返回一个 GONE，这样它就不会出现在我的 error_log 中。

# java - 在 JSP EL 中连接字符串？

> ID：296398
> 
> 赞同：15
> 
> 时间：2008-11-17T18:22:20.877
> 
> 标签：java, jsp, el, taglib

我有一个 bean 列表，每个 bean 都有一个属性，它本身就是一个电子邮件地址列表。

```
<c:forEach items="${upcomingSchedule}" var="conf">
    <div class='scheduled' title="${conf.subject}" id="scheduled<c:out value="${conf.id}"/>">
    ...
    </div>
</c:forEach> 
```

`<div>`这会在列表中为每个 bean呈现一个。

对于子列表，我想做的是将列表中的每个条目连接起来形成一个字符串，作为`<div>`'`title`属性的一部分显示。为什么？因为我们使用了一个javascript库（mootools）来把它`<div>`变成一个浮动的工具提示，并且这个库把它`title`变成了工具提示的文本。

所以，如果`${conf.subject}`是“主题”，最终我希望`title`是`<div>`“主题：blah@blah.com、blah2@blah2.com 等”，包含子列表的所有电子邮件地址。

如何使用 JSP EL 做到这一点？我试图避免将 scriptlet 块放入 jsp 文件中。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-17T20:17:13.220

执行此操作的“干净”方法是使用函数。由于 JSTL`join`函数在 a 上不起作用`Collection`，您可以编写自己的函数而不用太麻烦，并在所有地方重用它，而不是剪切和粘贴大量循环代码。

您需要函数实现和 TLD 来让您的 Web 应用程序知道在哪里可以找到它。将它们放在一个 JAR 中并将其放入您的 WEB-INF/lib 目录。

这是一个大纲：

com/x/taglib/core/StringUtil.java

```
package com.x.taglib.core;

public class StringUtil {

  public static String join(Iterable<?> elements, CharSequence separator) {
    StringBuilder buf = new StringBuilder();
    if (elements != null) {
      if (separator == null)
        separator = " ";
      for (Object o : elements) {
        if (buf.length() > 0)
          buf.append(separator);
        buf.append(o);
      }
    }
    return buf.toString();
  }

} 
```

元信息/xc.tld：

```
<taglib xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd" version="2.0">
  <tlib-version>1.0</tlib-version>
  <short-name>x-c</short-name>
  <uri>http://dev.x.com/taglib/core/1.0</uri>
  <function>
    <description>Join elements of an Iterable into a string.</description>
    <display-name>Join</display-name>
    <name>join</name>
    <function-class>com.x.taglib.core.StringUtil</function-class>
    <function-signature>java.lang.String join(java.lang.Iterable, java.lang.CharSequence)</function-signature>
  </function>
</taglib> 
```

虽然 TLD 有点冗长，但了解如何使用 TLD 对于任何使用 JSP 的开发人员来说都是一项很好的技能。而且，由于您选择了 JSP 之类的标准来进行演示，因此您很有可能拥有可以帮助您的工具。

与向底层模型添加更多方法的替代方法相比，这种方法具有许多优点。此函数可以编写一次，并在任何项目中重复使用。它与封闭源代码的第三方库一起使用。可以在不同的上下文中支持不同的分隔符，而不会使用新方法污染模型 API。

最重要*的是，它支持分离视图和模型控制器开发角色。*这两个领域的任务通常由不同的人在不同的时间执行。保持这些层之间的松散耦合可以最大限度地降低复杂性和维护成本。当即使是像在演示文稿中使用不同的分隔符这样的微不足道的更改也需要程序员修改库时，您将拥有一个非常昂贵且繁琐的系统。

`StringUtil`无论是否作为 EL 函数公开，该类都是相同的。唯一需要的“额外”是TLD，这是微不足道的；一个工具可以很容易地生成它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-17T18:34:30.493

想出了一个有点肮脏的方法来做到这一点：

```
<c:forEach items="${upcomingSchedule}" var="conf">
    <c:set var="title" value="${conf.subject}: "/>
    <c:forEach items="${conf.invitees}" var="invitee">
        <c:set var="title" value="${title} ${invitee}, "/>
    </c:forEach>
    <div class='scheduled' title="${title}" id="scheduled<c:out value="${conf.id}"/>">
    ...
    </div>
</c:forEach> 
```

我只是`<c:set>`重复使用，引用它自己的值，来附加/连接字符串。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T18:35:19.913

你能用这个吗？似乎它想要一个数组而不是一个列表..

```
${fn:join(array, ";")} 
```

[http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fn/join.fn.html](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fn/join.fn.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T18:50:50.663

如果您的子列表是 ArrayList 并且您这样做：

```
<div class='scheduled' title="${conf.subject}: ${conf.invitees}" id="scheduled${conf.id}"> 
```

你几乎得到你需要的东西。

唯一的区别是标题将是：“主题：[blah@blah.com, blah2@blah2.com, etc.]”。

也许对你来说已经足够好了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-23T00:20:23.060

我认为这就是你想要的：

```
<c:forEach var="tab" items="${tabs}">
 <c:set var="tabAttrs" value='${tabAttrs} ${tab.key}="${tab.value}"'/>
</c:forEach> 
```

在这种情况下，我有一个带有选项卡 ID（键）和 URL（值）的哈希图。在此之前未设置 tabAttrs 变量。所以它只是将值设置为 tabAttrs ('' to start) 的当前值加上键/值表达式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-27T18:01:57.017

只需将字符串放在服务器的 var 旁边，如下所示：

```
<c:forEach items="${upcomingSchedule}" var="conf">
    <div class='scheduled' title="${conf.subject}" 

         id="scheduled${conf.id}">

    ...
    </div>
</c:forEach> 
```

太晚了！！！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-17T11:12:32.427

自从最初发布此答案以来，实现标签库的方式似乎已经发生了很大变化，因此我最终做出了一些重大更改以使事情正常进行。我的最终结果是：

标记库文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<taglib version="2.1" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd">
  <tlib-version>1.0</tlib-version>
  <short-name>string_util</short-name>
  <uri>/WEB-INF/tlds/string_util</uri>
  <info>String Utilities</info>
  <tag>
    <name>join</name>
    <info>Join the contents of any iterable using a separator</info>
    <tag-class>XXX.taglib.JoinObjects</tag-class>
    <body-content>tagdependent</body-content>
    <attribute>
      <name>iterable</name>
      <required>true</required>
      <rtexprvalue>true</rtexprvalue>
      <type>java.lang.Iterable</type>
    </attribute>
    <attribute>
      <name>separator</name>
      <required>false</required>
      <rtexprvalue>false</rtexprvalue>
      <type>java.lang.String</type>
    </attribute>
  </tag>

  <tag>
    <name>joinints</name>
    <info>Join the contents of an integer array using a separator</info>
    <tag-class>XXX.taglib.JoinInts</tag-class>
    <body-content>tagdependent</body-content>
    <attribute>
      <name>integers</name>
      <required>true</required>
      <rtexprvalue>true</rtexprvalue>
      <type>java.lang.Integer[]</type>
    </attribute>
    <attribute>
      <name>separator</name>
      <required>false</required>
      <rtexprvalue>false</rtexprvalue>
      <type>java.lang.String</type>
    </attribute>
  </tag>
</taglib> 
```

JoinInts.java

```
public class JoinInts extends TagSupport {

    int[] integers;
    String separator = ",";

    @Override
    public int doStartTag() throws JspException {
        if (integers != null) {
            StringBuilder buf = new StringBuilder();
            if (separator == null) {
                separator = " ";
            }
            for (int i: integers) {
                if (buf.length() > 0) {
                    buf.append(separator);
                }
                buf.append(i);
            }
            try {
                pageContext.getOut().print(buf);
            } catch (IOException ex) {
                Logger.getLogger(JoinInts.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        return SKIP_BODY;
    }

    @Override
    public int doEndTag() throws JspException {
        return EVAL_PAGE;
    }

    public int[] getIntegers() {
        return integers;
    }

    public void setIntegers(int[] integers) {
        this.integers = integers;
    }

    public String getSeparator() {
        return separator;
    }

    public void setSeparator(String separator) {
        this.separator = separator;
    }
} 
```

要使用它：

```
<%@ taglib prefix="su" uri="/WEB-INF/tlds/string_util.tld" %>

[new Date(${row.key}), <su:joinints integers="${row.value}" separator="," />], 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-20T11:57:21.813

您可以使用 EL 3.0 Stream API。例如，如果您有一个字符串列表，

```
<div>${stringList.stream().reduce(",", (n,p)->p.concat(n))}</div> 
```

如果您有 ex 的对象列表。Person(firstName, lastName) 并且您希望仅连接其中的一个属性（例如 firstName），您可以使用 map，

```
<div>${personList.stream().map(p->p.getFirstName()).reduce(",", (n,p)->p.concat(n))}</div> 
```

在您的情况下，您可以使用类似的东西（也删除最后一个“，”），

```
<c:forEach items="${upcomingSchedule}" var="conf">
    <c:set var="separator" value=","/>
    <c:set var="titleFront" value="${conf.subject}: "/>
    <c:set var="titleEnd" value="${conf.invitees.stream().reduce(separator, (n,p)->p.concat(n))}"/>
    <div class='scheduled' title="${titleFront} ${titleEnd.isEmpty() ? "" : titleEnd.substring(0, titleEnd.length()-1)}" id="scheduled<c:out value="${conf.id}"/>">
    ...
    </div>
</c:forEach> 
```

**当心！**[EL 3.0 Stream API是在](https://tomcat.apache.org/tomcat-8.5-doc/api/index.html?org/apache/el/stream/Stream.html)[Java 8 Stream](https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html) API之前完成的，它与此不同。他们不能 sunc 两个 api，因为它会破坏向后兼容性。

# c++ - 如何在 C++ 中检查文件是 ASCII 还是二进制

> ID：296400
> 
> 赞同：0
> 
> 时间：2008-11-17T18:22:54.900
> 
> 标签：c++, file, binary, ascii

因此使用系统命令文件我们可以使用文件来确定文件是ASCII文本还是“数据”。我想知道是否有办法检查代码是哪一个？如果文件是“数据”，我想基本上抛出一个损坏的错误。我正在使用 ifstream 来读取文件。谢谢你的帮助！

**[这个问题](https://stackoverflow.com/questions/277521/how-to-identify-the-file-content-is-in-ascii-or-binary#277538)的重复。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T18:26:24.380

您可以遍历文件的字节并使用`std::isprint`from`<cchar>`来测试字符是否可打印。如果文件中有不可打印的字符，则很可能是二进制文件。请注意，这仅适用于遗留编码（例如您提到的 ASCII），不适用于 Unicode 编码的文件。

# graph-theory - 锦标赛图的支配集

> ID：296405
> 
> 赞同：0
> 
> 时间：2008-11-17T18:23:56.927
> 
> 标签：graph-theory, minimum-spanning-tree, tournament

我正在编写一个算法来找到锦标赛图的主导集。有向图的最小生成树是否等价于图的支配集？换句话说，如果我找到锦标赛图的最小 MST（通过遍历所有顶点），那么我可以说这相当于图的主导集吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:01:53.323

这篇[Wikipedia 文章](http://en.wikipedia.org/wiki/Dominating_set)指出，寻找支配集和寻找生成树的问题是等价的。给定一棵生成树，非叶子节点形成一个支配集，给定一个连通支配集，你可以很容易地得到原始图将它的一棵生成树与不属于它的顶点连接起来。但是，找到*最小*生成树和找​​到*最小*支配集是不同的问题。我想它们又是等价的，但我不确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T18:38:52.123

不，因为 MST 将包括图的所有顶点，而支配集可能不包括。

例如，请参见此处的图：[http ://en.wikipedia.org/wiki/Tournament `_`（图`_`论）](http://en.wikipedia.org/wiki/Tournament_%28graph_theory%29) 顶点 2 和 4 创建一个支配集，而不是生成树。

# asp.net-mvc - 如何在 ASP.NET MVC 中存根 User.Identity.Name？

> ID：296414
> 
> 赞同：5
> 
> 时间：2008-11-17T18:27:39.477
> 
> 标签：asp.net-mvc, tdd

我正在尝试在我的 ASP.NET MVC 应用程序中对一个页面进行单元测试，当发布到该页面时，它将删除用户的项目。我想限制此页面，使其只能由该项目的所有者发布。最初，我想在控制器中快速检查一下，检查 HttpContext.Current.User.Identity.Name 是否等于项目的所有者，但我很快意识到单元测试会很困难。

我应该创建一个界面来提供访问当前登录用户名的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-19T19:26:22.677

您可以使用此代码

```
Controller CreateControllerAs(string userName) {

  var mock = new Mock<ControllerContext>();
  mock.SetupGet(p => p.HttpContext.User.Identity.Name).Returns(userName);
  mock.SetupGet(p => p.HttpContext.Request.IsAuthenticated).Returns(true);

  var controller = new SomeController();
  controller.ControllerContext = mock.Object;

  return controller;
} 
```

它使用[最小起订量](https://code.google.com/p/moq/)库

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T18:53:15.837

您问题的最后一行可能是最快的解决方案，但是，我认为您不需要创建界面，`HttpContext.Current.User`已经是`IPrincipal`并且`HttpContext.Current.User.Identity`已经是`IIdentity`.

如果您的检查逻辑使用这些接口中的任何一个，则可以模拟控制器以传递您创建的 IIdentity 而不是 HttpContext.Current.User.Identity

希望有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T18:51:25.950

我使用 Thread.CurrentPrincipal.Identity.Name。为单元测试创​​建一个 GenericPrincipal 并附加它是微不足道的。

# .net - DataGridview 列调整大小问题

> ID：296418
> 
> 赞同：1
> 
> 时间：2008-11-17T18:29:33.373
> 
> 标签：.net, winforms, datagridview

我有一个datagridview，用户可以在其中选择要查看的列子集。我遇到的问题是，当我更改显示的列时，列宽仅由标题单元格的宽度决定，而不是其中的数据。我确实将每列设置为 AutoSizeMode = AllCells。

如果添加了新行，则列将变为正确的宽度。但是当列集改变时，宽度是错误的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T18:33:48.497

嗯...不能说我自己见过，但是（作为一种解决方法）您可以在更改列后尝试切换调整大小模式：

```
dgv.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.None;
dgv.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells; 
```

值得一试...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T14:40:04.177

更简单的选择不是删除和添加列，而是添加所有列，然后选择性地隐藏/显示所需的列集。尽管另一种方法确实有效。

# mfc - WinPE 中的 ULONGLONG 值损坏

> ID：296438
> 
> 赞同：0
> 
> 时间：2008-11-17T18:35:22.440
> 
> 标签：mfc, winpe

我有一个在 WinPE（Windows 预安装环境）中运行的 MFC 应用程序，我正在尝试使用 ULONGLONG 中的 64 位值作为参数进行方法调用。我已经确定该值在调用之前是正确的（即 0x1b432d6000），但在调用内部是损坏的（即 0x432d60000000000a）。该值最初是在调用之前立即在堆栈上分配的，我尝试通过值、引用和指针传递它。

该调用在我的开发机器上的调试器中正常工作。

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T18:42:58.540

检查函数签名 - 听起来您可能使用不正确的调用约定来调用函数。

# perl - 如何用 Perl 判断文件是否在远程文件系统上？

> ID：296455
> 
> 赞同：11
> 
> 时间：2008-11-17T18:41:26.127
> 
> 标签：perl, shell, filesystems, nfs

是否有一种快速而简单的方法来以编程方式（在 shell 脚本或 Perl 中）判断路径是位于远程文件系统（nfs 等）还是本地文件系统上？或者是解析 /etc/fstab 并检查文件系统类型的唯一方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-17T19:12:22.553

`stat -f -c %T <filename>`应该做你想做的。你可能还想要`-l`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T19:02:24.633

您可以使用“df -T”获取目录的文件系统类型，或使用 -t 选项将报告限制为特定类型（如 nfs），如果返回“未处理文件系统”，则它不是一个您正在寻找的那些。

```
df -T $dir | tail -1 | awk '{print $2;}' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T20:15:48.043

如果您`df`在目录上使用仅获取其所在设备的信息，例如当前目录：

```
df . 
```

然后，您可以只解析输出，例如

```
df . | tail -1 | awk '{print $1}' 
```

获取设备名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-24T16:49:01.427

我在solaris7,8,9 & 10 上测试了以下，它似乎是可靠的

```
/bin/df -g <filename> | tail -2 | head -1 | awk '{print $1}' 
```

应该为您提供 fs 类型，而不是尝试匹配挂载点中的“主机：路径”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T19:50:54.240

在某些系统上，NFS 文件的设备编号为负数。因此，

```
print "remote" if (stat($filename))[0] < 0 
```

# c# - 类型化的 DataSet 连接 - 需要在 .xsd 文件中有一个？

> ID：296458
> 
> 赞同：6
> 
> 时间：2008-11-17T18:41:46.360
> 
> 标签：c#, .net, vb.net, dataset

在 .NET 中类型化 DataSet 的 .xsd 文件中，有一个`<Connections>`部分包含我用来设置 DataTables 和 TableAdapter 的所有数据连接的列表。

有时我不想在那里有那些。例如，有时我更喜欢将连接字符串传递给自定义构造函数并使用它，而不是在设置、.config 等中查找。

但似乎如果我从该部分中删除连接字符串（将其留空），或完全删除该部分，DataSet 代码生成工具就会崩溃。然而，如果我*不*删除它们，当我将它放在另一个项目中时，DataSet 会发牢骚，因为它找不到这些连接字符串的设置。

有什么方法可以告诉类型化的 DataSet 不要担心任何连接？（显然，如果我更改任何 TableAdapter SQL 或存储过程，我将不得不给它一个连接，但这应该是*我的*问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T22:27:16.417

这也困扰了我很长时间，最近我做了一些测试。这是我想出的。作为记录，我使用的是 VS 2008 SP1。

*   无论您是否愿意，数据集*都将存储连接字符串信息。*
*   您*可以*确保数据集不会在其连接字符串中存储密码。
*   您可以将连接字符串存储在 .xsd 文件的“连接”部分，也可以将其存储在 app.config 文件中并从 .xsd 文件的“连接”部分引用。无论哪种方式，“连接”部分似乎都是必需的。

如果您找到了使其工作的方法，请在此处发布。目前，我将连接字符串存储在 xsd 文件中，并确保我没有存储密码。然后，当我使用它的代码时，我总是创建自己的连接并且从不使用存储在数据集中的连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T18:43:05.633

在类似的情况下，我将数据集的连接字符串存储在设置文件/app.config（Visual Studio 中创建数据集时的默认行为）中，并与本地开发数据库集成了安全性。为了能够从外部项目访问它，我将设置文件更改为`public`默认值`internal`（在可视化设计器中）。这导致代码如下（在 Properties\Settings.Designer.cs 中）：

```
public sealed partial class Settings
{
    [...]
    [global::System.Configuration.DefaultSettingValueAttribute
            ("Data Source=.;Initial Catalog=MyDb;Integrated Security=True;")]
    public string MyConnectionString
    {
        get
        {
            return ((string)(this["MyConnectionString"]));
        }
    }
} 
```

然后我手动修改了属性以包含一个公共设置器：

```
public string MyConnectionString
{
    get
    {
        return ((string)(this["MyConnectionString"]));
    }
    set
    {
        this["MyConnectionString"] = value;
    }
} 
```

最后，我设置了来自外部项目的连接字符串，例如：

```
MyDataAccessLibrary.Properties.Settings.Default.MyConnectionString = ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:19:25.213

最好的方法是在运行时使用您的首选连接字符串创建一个连接，并将其分配给 TableAdapter.Connection。这在过去对我有用。

其次，如果您`<connections>`从 xsd 中删除该部分，它肯定会引发错误，因为它不仅在运行时使用，而且 Visual Studio 数据集设计器在设计时也使用它来获取底层数据库的数据库模式，以便您可以在设计器中设计类型化数据集。所以`<connections>`最好为数据集设计者服务！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-11T14:49:15.720

使用 TableAdapterManager 可能对您有用。请阅读更多内容：[http ://rajmsdn.wordpress.com/2009/12/09/strongly-typed-dataset-connection-string/](http://rajmsdn.wordpress.com/2009/12/09/strongly-typed-dataset-connection-string/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-25T23:47:52.007

要回答你的问题，

您不必在连接字符串中指定数据库名称即可使数据集 IDE 正常工作。您只需要指定一个工作服务器。

我们使用以下连接字符串指向我们的本地服务器，而不指定数据库。

```
<add name="MyConnectionString" connectionString="data source=.;Integrated Security=SSPI" providerName="System.Data.SqlClient" /> 
```

这将允许您使用数据集、更改查询、编辑/删除列，而无需连接到真实数据库。某些功能仍然需要您指定数据库，但您可以做的比以前更多。试一试。

# c# - C#中如何获取登录用户的OU？

> ID：296466
> 
> 赞同：2
> 
> 时间：2008-11-17T18:45:11.813
> 
> 标签：c#, adsi

我正在寻找一种方法来获取当前登录用户的完整 Active Direcory LDAP 路径。例如

```
LDAP://CN=john.smith,OU=UK,OU=Sales,DC=Company,DC=local 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T18:48:52.600

使用此过滤器查询 LDAP 目录（例如 AD）：

```
(&(objectCategory=user)(sAMAccountName=<user-logon-name-here>)) 
```

返回的对象的 DN 就是您要查找的内容。

像这样的东西：

```
DirectorySearcher ds = new DirectorySearcher();
string userName = WindowsIdentity.GetCurrent().Name;
string userFilter = "(&(objectCategory=user)(sAMAccountName={0}))";

ds.SearchScope = SearchScope.Subtree;
ds.PropertiesToLoad.Add("distinguishedName");
ds.PageSize = 1;
ds.ServerPageTimeLimit = TimeSpan.FromSeconds(2);
ds.Filter = string.Format(userFilter, userName);

SearchResult sr = ds.FindOne();
// now do something with sr.Properties["distinguishedName"][0] 
```

# python - 如何使用 python（2.5 版）删除特定数量的文件？

> ID：296490
> 
> 赞同：0
> 
> 时间：2008-11-17T18:56:12.727
> 
> 标签：python, file

我想在脚本结束时从文件夹中删除两个文件。我是否需要创建一个负责删除这两个特定文件的函数？我想详细了解如何正确使用 os.remove （如果那是我应该使用的）。在我的脚本结束时，这两个文件将始终被丢弃（它将一系列文件以 zip 格式打包在一起）。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T19:08:30.550

听起来你真正想要的是一个临时文件： [http ://docs.python.org/library/tempfile.html](http://docs.python.org/library/tempfile.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T18:59:19.180

在脚本末尾调用“cleanup()”函数是完全可以接受的，它将在文件中调用“os.remove()”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-17T18:58:58.587

只要打电话`os.remove("path/to/file")`。例如，要删除文件`.emacs`，请调用

```
os.remove(".emacs") 
```

路径应该是`str`文件的路径名。它可能是相对的，也可能是绝对的。

# winforms - 击键时隐藏自身的窗口的预期行为是什么

> ID：296497
> 
> 赞同：2
> 
> 时间：2008-11-17T18:59:11.193
> 
> 标签：winforms, keyboard

这是一个主观问题，但我需要意见。

我有一个 WinForms C# 应用程序，其窗口在特定击键（Enter 或 Escape）后隐藏，并带有可能的修饰符（例如 Ctrl-Enter）。当隐藏在 KeyDown 或 KeyPress 上时，在我的窗口隐藏后变为活动状态的其他应用程序会收到该击键的 KeyUp 事件。通常，它不应该影响其他应用程序，但其中一些对 KeyUp 有反应。例如，TweetDeck 在“Enter”KeyUp 上发送当前正在编辑的消息，即使它没有收到 KeyDown/KeyPress。

所以我想，好吧，我会成为一个好公民，我会躲在 KeyUp 上。但这感觉不对。如果我只寻找钥匙，我正在做我责怪别人做的事情！如果我尝试创建匹配 KeyDown/KeyUp 的历史记录，那么我的代码过于复杂（修饰符会生成自己的密钥）。

我该怎么办？一个执行良好的应用程序应该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:06:37.963

这是一个 hack，但您可以在收到按键时将程序的状态设置为“等待隐藏”。然后，当您为该序列准备好密钥时，重置“待定状态”，然后隐藏。

或者，您可以在收到密钥后将密钥从消息队列中“吃掉”吗？

我不会太担心应用程序处理按键而不是按键 - 正如您所指出的那样 - 这是一个问题的唯一原因是因为您的应用程序在按键序列的中间更改了活动窗口。您也有责任（IMO）“吃掉”关键信息。您可以只处理向上键而不是向下键，而不会产生不利的副作用。

编辑

进一步考虑这一点 - 当执行 alt-tab 转到新窗口时 - 直到按键才会发生该操作。与此同时，它显示了一个可能要更改的应用程序的窗口。你可以做类似的动作并且这种行为是有先例的。

所以： On key down：显示窗口，表明应用程序将隐藏。上键：隐藏窗口

这是“有状态的”——只有当你收到钥匙放下和钥匙向上时，你才能隐藏起来——至少我会这样做。99.9999%（猜想）不处理按键是可以的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T19:24:21.640

我想不出任何在 KeyUp 事件上实现键盘快捷键的程序。该标准是很久以前使用 Windows TranslateAccelerator() API 函数设定的。它翻译 WM_KEYDOWN。Windows 窗体使用 ProcessCmdKey() 实现相同的行为。

听起来你发现了一个笨蛋。它是否正确处理 Alt+F4？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-17T19:08:19.490

好吧，我会说“别担心，直到它成为一个问题”，但我想它现在是一个问题......

在这种情况下，我会隐藏在 KeyPress 上（预期的用户体验），但要抓住焦点，直到您获得 KeyUp（或直到短暂的超时）。

# python - 如何使用 python（2.5 版）压缩文件夹的内容？

> ID：296499
> 
> 赞同：28
> 
> 时间：2008-11-17T19:00:07.807
> 
> 标签：python, file, zip, python-2.5

在特定文件夹中拥有所需的所有文件后，我希望我的 python 脚本压缩文件夹内容。

这可能吗？

我该怎么做呢？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-09T09:04:52.463

在 python 2.7 上，您可以使用：[shutil.make_archive(base_name, format[, root_dir[, base_dir[, verbose[, dry_run[, owner[, group[, logger]]]]]]])](http://docs.python.org/library/shutil#shutil.make_archive)。

**base_name**档案名称减去扩展名

**归档的**格式格式****

 ****root_dir**目录进行压缩。

例如

```
 shutil.make_archive(target_file, format="bztar", root_dir=compress_me) 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-11-17T20:07:58.790

[脚本](http://mail.python.org/pipermail/python-list/2006-May/384142.html)的改编版本是：

```
#!/usr/bin/env python
from __future__ import with_statement
from contextlib import closing
from zipfile import ZipFile, ZIP_DEFLATED
import os

def zipdir(basedir, archivename):
    assert os.path.isdir(basedir)
    with closing(ZipFile(archivename, "w", ZIP_DEFLATED)) as z:
        for root, dirs, files in os.walk(basedir):
            #NOTE: ignore empty directories
            for fn in files:
                absfn = os.path.join(root, fn)
                zfn = absfn[len(basedir)+len(os.sep):] #XXX: relative path
                z.write(absfn, zfn)

if __name__ == '__main__':
    import sys
    basedir = sys.argv[1]
    archivename = sys.argv[2]
    zipdir(basedir, archivename) 
```

例子：

```
C:\zipdir> python -mzipdir c:\tmp\test test.zip 
```

它使用目录的内容创建`'C:\zipdir\test.zip'`存档`'c:\tmp\test'`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-17T19:19:01.073

这是一个递归版本

```
def zipfolder(path, relname, archive):
    paths = os.listdir(path)
    for p in paths:
        p1 = os.path.join(path, p) 
        p2 = os.path.join(relname, p)
        if os.path.isdir(p1): 
            zipfolder(p1, p2, archive)
        else:
            archive.write(p1, p2) 

def create_zip(path, relname, archname):
    archive = zipfile.ZipFile(archname, "w", zipfile.ZIP_DEFLATED)
    if os.path.isdir(path):
        zipfolder(path, relname, archive)
    else:
        archive.write(path, relname)
    archive.close() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-05T16:44:07.813

jfs 的解决方案和 Kozyarchuk 的解决方案都适用于 OP 的用例，但是：

*   jfs 的解决方案将源文件夹中的所有文件压缩，并将它们存储在根级别的 zip 中（不保留 zip 结构中的原始源文件夹）。
*   Kozyarchuk 的解决方案无意中将新创建的 zip 文件放入自身，因为它是一种递归解决方案（例如，使用此代码创建新的 zip 文件“myzip.zip”将导致存档“myzip.zip”本身包含一个空文件“myzip.zip”。压缩”）

因此，这是一个解决方案，只需将源文件夹（以及任何深度的任何子文件夹）添加到 zip 存档。这是因为您不能将文件夹名称传递给内置方法`ZipFile.write()`- 下面的函数`add_folder_to_zip()`, 提供了一种简单的方法来将文件夹及其所有内容添加到 zip 存档中。下面的代码适用于 Python2 和 Python3。

```
import zipfile
import os

def add_folder_to_zip(src_folder_name, dst_zip_archive):
    """ Adds a folder and its contents to a zip archive

        Args:
            src_folder_name (str): Source folder name to add to the archive
            dst_zip_archive (ZipFile):  Destination zip archive

        Returns:
            None
    """
    for walk_item in os.walk(src_folder_name):
        for file_item in walk_item[2]:
            # walk_item[2] is a list of files in the folder entry
            # walk_item[0] is the folder entry full path 
            fn_to_add = os.path.join(walk_item[0], file_item)
            dst_zip_archive.write(fn_to_add)

if __name__ == '__main__':
    zf = zipfile.ZipFile('myzip.zip', mode='w')
    add_folder_to_zip('zip_this_folder', zf)
    zf.close() 
```

# asp.net - 动态添加的控件不进行回发

> ID：296501
> 
> 赞同：1
> 
> 时间：2008-11-17T19:00:40.673
> 
> 标签：asp.net, vb.net, web-controls

我正在覆盖一个网格，添加一些客户功能。其中一项功能是用于调整页面大小的下拉菜单。我正在使用客户服务器控件扩展网格，这对于我迄今为止所做的工作非常有用。但是，现在我在让动态添加的控件进行回发时遇到了一些麻烦。启动回发的 javascript 不存在。

```
Protected Overrides Sub OnPreRender(ByVal e As System.EventArgs)
    Dim pageSizePanel As New Panel
    ...
    Dim countList As List(Of String) = GetCountList()
    Dim pageSizeDropdown As New DropDownList()
    pageSizeDropdown.ID = "pageSizeDropdown"
    pageSizeDropdown.DataSource = countList
    pageSizeDropdown.DataBind()

    AddHandler pageSizeDropdown.SelectedIndexChanged, _
               AddressOf HandlePageSizeChange

    pageSizePanel.Controls.Add(pageSizeDropdown)
    ...
    MyBase.Controls.AddAt(0, pageSizePanel)
    MyBase.OnPreRender(e)
End Sub 
```

HTML是

```
<select name="tab$grid1Tab$RadGrid1$pageSizeDropdown" 
    id="tab_grid1Tab_RadGrid1_pageSizeDropdown">
        <option selected="selected" value="10">10</option>
        <option value="20">20</option>
        <option value="40">40</option>
        <option value="80">80</option>
        <option value="All">All</option>

    </select> 
```

那么，这与我“注入”控件时有关系吗？它与控件的动态添加有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:03:23.697

我注意到的第一件事是你会错过这个：

```
pageSizeDropdown.AutoPostBack = true 
```

但我不确定这是否就是它工作所需要的全部

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T19:02:25.633

您需要将“AutoPostBack”设置为 true 才能使下拉列表回发。否则，另一个控件将不得不发回表单（但是，当发生这种情况时，SelectedIndexChanged 事件将触发）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T19:17:34.277

我认为需要创建控件 pageSizeDropdown 并在页面生命周期的早期连接事件，请参阅[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。需要在页面 LoadComplete 事件之前创建动态添加的控件，以便触发其控件事件。

# wpf - WPF 用户控件的 DataContext 为 Null

> ID：296503
> 
> 赞同：19
> 
> 时间：2008-11-17T19:01:25.837
> 
> 标签：wpf, wpf-controls

我有一个用户控件，其中控件的 XAML 可以像正常一样绑定到父数据上下文中的适当属性（数据上下文在 xaml 中传播）。

例如，我有一个窗口，我将其 DataContext 设置为 ObjectA。然后我在窗口中的用户控件尝试访问 dataContext 中的属性

所以我的窗口的 xaml 和后面的代码都可以看到一个非空的 DataContext。

我的 DataContext 传播到的控件可以在 Xaml 中看到非 null DataContext，但在后面的代码中看不到。

处理这个的正确方法是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-18T16:20:53.367

如果您需要检查是否正在设置 DataContext 失败，则可以使用 DataContextChanged

```
public partial class UserControl1 : UserControl
{
    public UserControl1()
    {
        InitializeComponent();

        DataContextChanged += new DependencyPropertyChangedEventHandler(UserControl1_DataContextChanged);
    }

    void UserControl1_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        // You can also validate the data going into the DataContext using the event args
    }
} 
```

请注意，在 DataContext 从 null 更改为不同的值之前，它不会输入 UserControl1_DataContextChanged。

不确定这是否回答了您的问题，但可以非常方便地用于调试问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-17T19:35:41.883

我认为您正在检查 UserControl 的构造函数中的“DataContext”。在构造函数中它将为空，因为在构造函数代码中执行时尚未创建用户控件。但是在 Loaded 事件中检查属性，您将正确看到该对象。

```
public partial class UserControl1
{
    public UserControl1()
    {
        this.InitializeComponent();

        //DataContext will be null here 
        this.Loaded += new RoutedEventHandler(UserControl1_Loaded);
    }

    void UserControl1_Loaded(object sender, RoutedEventArgs e)
    {
        //Check DataContext Property here - Value is not null
    }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-16T22:11:30.497

我会检查您是否在运行时遇到绑定错误。将此命名空间添加到您的 XAML：

```
xmlns:debug="clr-namespace:System.Diagnostics;assembly=System" 
```

并检查调试器的输出窗口以获取相关错误消息。

或者，您能否向我们展示更多代码？

# statistics - 模拟/统计/预测的研究生学位？

> ID：296513
> 
> 赞同：1
> 
> 时间：2008-11-17T19:04:13.443
> 
> 标签：statistics, machine-learning

我想知道是否有人对此有任何见解。我正在考虑去研究生院获得一些计算机科学相关的学位。我一直对使用统计软件包或模拟解决问题的人很感兴趣。我要学习什么才能对这些事情有广泛的了解？他们属于机器学习吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:19:46.940

我的女朋友正在获得数学学位，重点是统计和 [运筹学。](http://en.wikipedia.org/wiki/Operations_research)

她使用 SAS 和其他统计软件做了大量工作，以最大化某些功能并预测未来事件的可能性。它可能比你喜欢的更多的数学，但你可以尝试寻找侧重于运筹学或统计学的 CS 课程的硕士。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-30T03:52:56.480

这里有很多可能的机会。让我添加以下选项：

*   物理学，专注于复杂网络。这在生物学、流行病学、社会学、金融学和计算机科学中都有应用。
*   一个很好的机器学习程序，具有统计、数据挖掘、文本分析和计算学习理论。
*   工业工程/运筹学，具有模拟、可靠性和过程控制。

我很乐意进一步讨论这个问题，请在评论中提出问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T19:16:48.490

我假设你的学校会提供一些实际的统计学课程，可能是在数学系，你可以通过这些课程来了解这一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T19:30:52.283

学习很多数学，尤其是概率和统计。我现在有一个研究生模拟课程，我希望我知道更多的概率/统计数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T23:02:16.513

在生物统计学（在明尼苏达大学），我们在贝叶斯统计、遗传学等领域进行了大量模拟。任何强分析程序都是教授你想要的技能的好人选，包括：经济学、计量经济学、农艺学、统计遗传学……等等，等等，:)

在您等待的同时，拿起 R、Matlab（Octave 是免费的实现）或您选择的图灵完备语言，深入了解 Wikipedia，然后开始工作 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T05:47:19.550

我想赞同 Gregg Lind 关于在生物科学中思考统计学的建议。它资金充足，正在进行很多有趣的工作（理论和应用！），而且你在聚会上听起来真的很酷，因为不知何故，你总能在工作中与治愈癌症建立某种联系。:)

不过说真的，在 20 世纪初，霍尔丹、菲塞尔和赖特等人完成了许多伟大的统计工作。最近在分析或大型数据集、多假设检验和应用机器学习方面进行了有趣的工作。这是超级令人兴奋的。来加入我们吧！

# c# - 将数组从 JavaScript 传递到 C# 的最佳方法？

> ID：296517
> 
> 赞同：2
> 
> 时间：2008-11-17T19:05:56.607
> 
> 标签：c#, asp.net, jquery, web-services

我需要将数组从 JavaScript 传递到 C# 中的页面方法。我尝试在 IList 的 C# 方法中使用参数以及 string[] 数组。两种方式都会抛出异常“无法将system.string类型的对象转换为xxx”，其中xxx是C#方法中的参数类型。我将 jQuery 中的对象作为 json 对象传递，看起来它正在正常通过。这是它的样子：

```
{"testNumbers":"5555555555,3333333333,4444444444"} 
```

我在这里做错了什么？

编辑：C#代码：

```
[WebMethod()]
public static void ProcessAction(string[] testNumbers)
{
    var dataProvider = new DataProvider();
    dataProvider.ProcessAction(testNumbers);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T19:18:52.713

嗯，有两点：

1.  JSON 数组周围有方括号
2.  不引用 JSON 数字。

试试这个：

```
{"testNumbers": [5555555555,3333333333,4444444444]} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T19:20:42.193

您需要使用 .NET JSON 反序列化器之一：

[http://msdn.microsoft.com/en-us/library/bb299886.aspx](http://msdn.microsoft.com/en-us/library/bb299886.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T19:21:58.137

```
{"testNumbers":["5555555555","3333333333","4444444444"]} 
```

我应该认为与解串器一起做这个把戏。看看[`http://www.json.org/`](http://www.json.org/)哪个对 json 语法有很好的图形表示。

# unix - `(cd X; pwd)` 有时会返回两行

> ID：296519
> 
> 赞同：3
> 
> 时间：2008-11-17T19:06:39.150
> 
> 标签：unix, shell

我有以以下开头的 shell 脚本：

```
sdir=`dirname $0`
sdir=`(cd "$sdir/"; pwd)` 
```

这通常会扩展（使用'sh -h'）成

```
++ dirname /opt/foo/bin/bar
+ sdir=/opt/foo/bin
++ cd /opt/foo/bin/
++ pwd
+ sdir=/opt/foo/bin 
```

但对于单个用户，单个参数组合的扩展为（注意结果 sbin 值处的两行）

```
++ dirname bin/foo
+ sdir=bin
++ cd bin/
++ pwd
+ sdir='/opt/foo/bin
/opt/foo/bin' 
```

我尝试了不同的组合，但无法重现这种行为。使用该用户的不同输入参数，它开始产生正确的单行结果。我是 shell 脚本的新手，所以请告知何时`(cd X; pwd)`可以返回两行。它在 CentOS 上被观察到，但不确定它是否重要。请指教。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T19:25:12.887

罪魁祸首是cd，试试这个

```
sdir=`dirname $0`
sdir=`(cd "$sdir/" >/dev/null; pwd)` 
```

发生这种情况是因为当您指定非绝对路径并且在环境变量 CDPATH 中找到该目录时，cd 会将其更改为的目录的绝对路径的值打印到 stdout。

相关的 man bash 部分：

```
       CDPATH cd 命令的搜索路径。这是一个
              以冒号分隔的目录列表，其中
              shell 查找指定的目标目录
              通过 cd 命令。一个示例值是 ``.:~:/usr''。

       cd [-L|-P] [目录]

              将当前工作目录更改为目录。如果
              目录没有给出，HOME shell 的值
              使用变量。如果 shell 变量 CDPATH 存在，
              它用作搜索路径。如果目录以斜杠开头，
              不使用 CDPATH。

              -P 选项表示不跟随符号链接；象征性的
              默认情况下或使用 -L 选项跟随链接。如果
              目录是'-'，它相当于$OLDPWD。

              如果使用 CDPATH 中的非空目录名，或者如果使用“-”
RELEVANT -\ 为第一个参数，换目录成功，
PARAGRAPH -/ 写入新工作目录的绝对路径名
              到标准输出。

              如果目录成功返回状态为零
              改变，否则非零。

       OLDPWD cd 设置的前一个工作目录
              命令。

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T01:23:16.953

CDPATH is a common gotcha. You can also use "unset CDPATH; export CDPATH" to avoid the problem in your script.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T19:19:42.633

用户可能对“cd”有一些时髦的别名。也许您可以尝试让它执行“/usr/bin/cd”（或默认情况下实际运行的任何“cd”）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T19:22:04.627

有些人将 pwd 别名为“echo $PWD”。此外，pwd 命令本身可以是内置的 shell 或 /usr/bin 中的程序。对该用户和任何正常工作的用户都执行“别名密码”和“哪个密码”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T09:38:41.877

尝试这个：

```
sdir=$( cd $(dirname "$0") > /dev/null && pwd ) 
```

它只是一行，将保持目录名称中的所有特殊字符不变。请记住，在 Unix 上，文件/目录名中只有两个字符是非法的：0 字节和`/`（正斜杠）。特别是，换行符在文件名中有效！

# winapi - VISTA 中的 Win32 控制台进程 - 10% CPU，但非常慢

> ID：296520
> 
> 赞同：1
> 
> 时间：2008-11-17T19:06:41.287
> 
> 标签：winapi, windows-vista, console, cpu

我有一个 Win32 控制台应用程序，它正在执行一些计算，在 Compaq Visual Fortran 中编译（这可能无关紧要）。

我需要同时运行很多。

在 XP 中，它们一起占用大约 90-100% 的 CPU，工作速度非常快。在 Vista 中，无论我运行多少个，它们占用的 CPU 都不会超过 10%（一起），并且分别运行得很慢。

有相当多的控制台输出正在进行，但现在非常多。我可以最小化所有的窗口，它没有帮助。CPU基本上什么都不做...

有任何想法吗？

**更新：**

不，这些是不同的机器，但它们运行相对相同的硬件。2\. 不使用线程，这是一个非常古老（20 年）的 DOS 普通应用程序，在 win32 中编译。它应该计算迭代直到它们相遇，消耗它所拥有的一切。我的印象 - VISTA 只是没有给它更多的 CPU

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:58:52.540

您是否尝试过将控制台输出重定向到文件？如果您的应用程序被阻止写入控制台（不幸的是有时会发生这种情况），那么重定向输出应该会有所帮助，因为写入简单文件比写入控制台要快得多。

你这样做

```
c:\temp> dir > output.log 
```

如果您真的根本不关心输出，可以通过重定向到`nul`. 例如：

```
c:\temp> dir > nul 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T20:05:50.293

Vista 中有一个[已知的“功能”](http://www.trnicely.net/misc/vista.html)，它将某些控制台应用程序的 RAM 限制为 32MB。不知道 Compaq Visual Fortran 编译的那些会不会受到这个“特性”的影响。

[这篇文章](http://www.trnicely.net/misc/vista.html)似乎在 2008 年 10 月才更新，所以问题仍然存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T23:24:11.053

Your loops are obviously not simple computations. There is a blocking system call in there somewhere. Just because it worked on XP doesn't mean the app is bug free.

Since you can minimize the console windows and see no improvement, I would not consider that an issue. In my experience console output slows a program down only if the console window is drawing text, not when it's minimized.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T20:01:11.020

正如 Tim 暗示的那样，控制台输出（stdout）非常昂贵。

我建议重新运行您的测试，同时将控制台输出重定向到每个进程的单独日志文件。如果可能，在另一个测试运行中调低输出的详细程度。

除此之外，还有其他明显的可能性：硬件是否明显不同，是否有其他主要进程正在运行，是否存在正在争用的共享资源？

除了明显的，寻找不明显的资源争用，例如共享文件。

但是我要看的主要领域是您的代码为两种操作系统环境编译的方式是否存在显着差异-我想知道您的 Fortran 代码在 Vista 上运行时是否会受到某种特殊惩罚，例如兼容性模式。查看对 Vista 的支持情况以及是否可以专门针对 Vista 进行编译。还要寻找任何报告类似问题的人，例如错误报告、功能请求等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T19:17:27.457

为了解释 Daok 的帖子——你的 XP 机器可能是这个进程的 CPU 绑定，而 vista 机器受其他一些资源的约束。

澄清一下：输出到标准输出（或其他）可能会减慢处理速度。（上下文切换或文件访问等也可以）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T19:14:50.707

您的 Vista 和 XP 上的机器硬件是否相同？它可能只使用 Vista 的 10%，因为它不需要更多。你在用线程吗？我认为它需要有关您的项目的更多信息才能有更好的想法。您是否尝试使用分析器来查看发生了什么？

# sql-server - 获取存档表中当前记录的最佳查询是什么（SQL Server 2005/2008）

> ID：296525
> 
> 赞同：4
> 
> 时间：2008-11-17T19:08:08.147
> 
> 标签：sql-server, performance, tsql, sql-server-2008

# 例子

有一个应用程序可以测量世界每个城镇的温度。每 5 分钟进行一次测量并写入测量表。

```
CREATE TABLE [dbo].[Measurement](
    [MeasurementID] [int] IDENTITY(1,1) NOT NULL,
    [Town] [varchar](50) NOT NULL,
    [Date] [datetime] NOT NULL,
    [Temp] [int] NOT NULL,
CONSTRAINT [PK_Measurement] PRIMARY KEY CLUSTERED 
(
    [MeasurementID] ASC
)) ON [PRIMARY] 
```

# 问题

获取城镇列表及其当前温度的最有效查询是什么？

假设有 10 万个城镇和 1000 万条记录

*注意：我添加了几个可能的答案，但可能还有其他选项。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T19:16:46.540

这里有一对应该起作用的：

SELECT
m1.Town, m1.Temp
FROM
Measurement AS m1
LEFT JOIN
Measurement AS m2
ON
m1.Town = m2.Town
AND m1.Date < m2.Date
WHERE
m2.MeasurementID IS NULL
ORDER BY m1.Town

* * *

你需要一个关于城镇和日期的索引。

这种技术对于 MySQL 的早期版本特别有用，它无法处理更明显的问题

SELECT Town, Temp
FROM Measurement AS m1
WHERE NOT EXISTS (
SELECT 1 From Measurement
WHERE Town = m1.Town
AND Date > m1.date
)按
城镇排序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T22:38:25.290

Good to see so many ways to skin this cat. Here's one using a CTE (you can also nest the query for more ANSI-ism, but I find CTEs great to avoid a lot of indenting and declaring things up front makes it pretty readable up top and down below):

```
WITH LastMeasurements AS (
    SELECT [Town], MAX([Date]) AS LastMeasurementDate
    FROM [Measurement]
    GROUP BY [Town]
)
SELECT [Measurement].Town, [Measurement].[Date], [Measurement].Temp
FROM [Measurement]
INNER JOIN LastMeasurements
    ON [Measurement].[Town] = LastMeasurements.[Town]
    AND [Measurement].[Date] = LastMeasurements.LastMeasurementDate 
```

What I like about the explicit seeking back technique is that it easily gives you access to all the information in the top row selected for the group and is very flexible in changing the grouping and low on repeating yourself.

The optimizer tends to perform these pretty quickly on SQL Server - like most solutions, if you have an index on Town, Date, Temp this will be covering and will run super fast. Even if it's just on Town, Date, the bulk of the work in the `GROUP BY` can be done super fast anyway.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T19:09:35.540

```
select *
from
(
    select distinct *, --Keyword,Total,CreatedOn,EngineInstanceID,
    Rank() over (PARTITION by Town order by Date DESC) as DateOrder
    from Measurement
    where Town is not null
) CurrentMeasurement
where DateOrder = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T19:08:52.343

```
select s.*
from Measurement s
where exists ( 
   select 1
   from Measurement s1
   where s.Town = s1.Town
   group by s1.Town
   having max( s1.Date )= s.Date)
   order by s.Town 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T19:26:40.933

```
select m.town, m.temperature, m.date
from Measurement m
where m.date = (select max(m2.date) from Measurement m2 where m2.town = m.town)
order by 1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-12T00:25:36.827

你可能有一张带有不同城镇列表的表格吗？假设每个城镇有大约 1000 个测量值，窗口函数解决方案（例如 row_number()、rank() 等）的性能可能不如普通聚合或此 APPLY 版本：

```
SELECT
   M.*
FROM
   Towns T
   OUTER APPLY (
      SELECT TOP 1 * -- add 'WITH TIES' to the 'TOP 1' if you have/want ties on date.
      FROM Measurement M
      WHERE T.Town = M.Town
      ORDER BY M.Date DESC
   ) M 
```

如果没有城镇列表，你可以试试这个，虽然我不知道它会如何与普通的香草聚合 + 查找相叠加：

```
SELECT
   M.*
FROM
   (SELECT DISTINCT Town FROM Towns) T
   OUTER APPLY (
      SELECT TOP 1 *
      FROM Measurement M
      WHERE T.Town = M.Town
      ORDER BY M.Date DESC
   ) M 
```

这些查询的性能绝对取决于索引。您至少需要 [Town] 上的一个，而 [Town, Date] 最好。如果其他表使用MeasurementID，但您很少使用MeasurementID 访问Measurement 表，则删除聚集索引，使MeasurementID 成为非聚集PK，并在Town、Date 上添加（非唯一）聚集索引。如果您没有使用 MeasurementID 的其他表，则完全删除该列 - 在这种情况下，它是无用的合成/人工键，无缘无故地使您的表膨胀。

这些建议的索引更改将有助于此处使用聚合或应用的答案中的所有查询。不确定它们对窗口函数的影响，这取决于优化器如何制定执行计划（如果它足够聪明地意识到它只需要访问最大日期而不触及所有其他行，那么相同的索引将提升它难以置信，虽然我怀疑优化器可以做到这一点）。

另外，为了提高性能，我肯定会建议使用 Town 表，使用 TownID 而不是将整个城镇放在适当的位置。如果城市名称改变了怎么办？从每个名称的平均 15 个字节左右切换到 int TownID 的仅 4 个字节将有助于提高速度。（虽然测试是为了肯定地证明这一点）。

# wpf - WPF ListView 性能非常慢 - 为什么？（ElementHost，还是其他原因？）

> ID：296533
> 
> 赞同：25
> 
> 时间：2008-11-17T19:09:35.587
> 
> 标签：wpf, performance, listview, datagrid, elementhost

我有一个 Windows 窗体应用程序，它有一个包含 WPF 用户控件的 ElementHost... 在我的 WPF 中，我有一个非常简单的 ListView：

```
<ListView Margin="4" ItemsSource="{Binding Notifications}">
    <ListView.View>
        <GridView>
            <GridViewColumn Header="FirstName" DisplayMemberBinding="{Binding FirstName}" />
            <GridViewColumn Header="LastName" DisplayMemberBinding="{Binding LastName}" />
            <GridViewColumn Header="Address" DisplayMemberBinding="{Binding Address}" />
            <GridViewColumn Header="City" DisplayMemberBinding="{Binding City}" />
            <GridViewColumn Header="State" DisplayMemberBinding="{Binding State}" />
            <GridViewColumn Header="Zip" DisplayMemberBinding="{Binding Zip}" />
        </GridView>
    </ListView.View>
</ListView> 
```

如果我的来源有 10 个项目，则表单会在不到一秒的时间内加载。如果我的来源有 1000 个项目，则需要 7 秒！！！我的计时器只考虑加载（而不是获取物品需要多少时间）。

所以我的问题是：

使用 ElementHost 是一场性能噩梦吗？

WPF DataBinding 是性能噩梦吗？

ListView 是废话吗？（顺便说一句，与 WPFToolkit 的 DataGrid 的结果相同）？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-17T19:33:07.707

使用虚拟化

```
<ListView ItemsSource="{BindingNames}"Name="lv">
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                   <!--<StackPanel/>
                    If StackPanel was used, the memory consumed was over 2GB and dead slow.
                    -->
                   <VirtualizingStackPanel>
                    <!--Memory footprint is only 200 mb-->
                    </VirtualizingStackPanel>
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}"/>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-07T15:15:23.807

您可能还想查看有关代码项目的这篇优秀文章：

WPF：数据虚拟化 Paul McClean [http://www.codeproject.com/KB/WPF/WpfDataVirtualization.aspx](http://www.codeproject.com/KB/WPF/WpfDataVirtualization.aspx)

它以最少的内存和带宽使用向您展示了一种更好的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-16T08:10:48.190

我有一个案例，这里提供的答案并没有解决我的问题。在我的情况下，将 的`MaxHeight`属性设置为`ListView`大于实际显示高度的值立即解决了它，这要归功于[这里的答案](https://stackoverflow.com/a/19426279/720425)，即使我无法解释它是如何工作的以及为什么工作。

# scsf - SCSF vs 雅典卫城

> ID：296534
> 
> 赞同：1
> 
> 时间：2008-11-17T19:09:42.653
> 
> 标签：scsf, acropolis

SCSF 和 Acropolis 有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:52:56.623

SCSF（智能客户端软件工厂）是一组工具（使用 Visual Studio 的 Guidance 自动化扩展），用于使用复合 UI 应用程序块构建应用程序。

Composite UI Application Block 是一个基于 Composite UI 模式的应用程序框架，基本上为松散耦合的 UI 提供管道。它在很大程度上基于在 Microsoft 模式和实践中开发的“ObjectBuilder”依赖注入容器。

如果我没记错的话，Acropolis 将成为 Composite UI 应用程序块的“重启”。 [它不再被开发](http://en.wikipedia.org/wiki/Microsoft_codename_Acropolis)，但是（至少根据 Wikipedia 的说法）它的一些概念被整合到当前的微软产品中，比如 Silverlight。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T19:18:18.657

[http://en.wikipedia.org/wiki/Microsoft_codename_Acropolis](http://en.wikipedia.org/wiki/Microsoft_codename_Acropolis)

[http://msdn.microsoft.com/en-us/library/aa480482.aspx](http://msdn.microsoft.com/en-us/library/aa480482.aspx)

雅典卫城尚未发布。SCSF现在可用吗？不知道你还能找到什么，因为其中一个在技术上不存在:)

# bash - 如何对 curl 命令的数据进行 urlencode？

> ID：296536
> 
> 赞同：432
> 
> 时间：2008-11-17T19:09:59.127
> 
> 标签：bash, shell, curl, scripting, urlencode

我正在尝试编写一个用于测试的 bash 脚本，该脚本接受一个参数并通过 curl 将其发送到网站。我需要对值进行 url 编码以确保正确处理特殊字符。做这个的最好方式是什么？

到目前为止，这是我的基本脚本：

```
#!/bin/bash
host=${1:?'bad host'}
value=$2
shift
shift
curl -v -d "param=${value}" http://${host}/somepath $@ 
```

* * *

## 回答 #1

> 赞同：526
> 
> 时间：2010-01-08T13:05:40.657

使用`curl --data-urlencode`；来自`man curl`：

> `--data`除了执行 URL 编码之外，这将发布数据，类似于其他选项。要符合 CGI，该`<data>`部分应以名称开头，后跟分隔符和内容规范。

示例用法：

```
curl \
    --data-urlencode "paramName=value" \
    --data-urlencode "secondParam=value" \
    http://example.com 
```

有关更多信息，请参见[手册页](https://curl.haxx.se/docs/manpage.html#--data-urlencode)。

这需要[curl 7.18.0 或更高版本（2008 年 1 月发布）](https://curl.haxx.se/changes.html#7_18_0)。用于 `curl -V`检查您拥有的版本。

您也可以对[查询字符串](https://curl.haxx.se/docs/manpage.html#-G)进行编码：

```
curl -G \
    --data-urlencode "p1=value 1" \
    --data-urlencode "p2=value 2" \
    http://example.com
    # http://example.com?p1=value%201&p2=value%202 
```

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2012-05-18T22:58:11.663

# 这是纯粹的 BASH 答案。

**更新**：由于已经讨论了许多更改，因此我将其放在[https://github.com/sfinktah/bash/blob/master/rawurlencode.inc.sh](https://github.com/sfinktah/bash/blob/master/rawurlencode.inc.sh)上，供任何人发布 PR。

**注意**：此解决方案并非旨在对 unicode 或多字节字符进行编码——这完全超出了 BASH 不起眼的**本机**功能。它仅用于对符号进行编码，否则会破坏在 POST 或 GET 请求中传递的参数，例如“&”、“=”等。

**非常重要的注意事项**：永远不要尝试用任何语言编写自己的 UNICODE 转换函数。见答案结尾。

```
rawurlencode() {
  local string="${1}"
  local strlen=${#string}
  local encoded=""
  local pos c o

  for (( pos=0 ; pos<strlen ; pos++ )); do
     c=${string:$pos:1}
     case "$c" in
        [-_.~a-zA-Z0-9] ) o="${c}" ;;
        * )               printf -v o '%%%02x' "'$c"
     esac
     encoded+="${o}"
  done
  echo "${encoded}"    # You can either set a return variable (FASTER) 
  REPLY="${encoded}"   #+or echo the result (EASIER)... or both... :p
} 
```

您可以通过两种方式使用它：

```
easier:  echo http://url/q?=$( rawurlencode "$args" )
faster:  rawurlencode "$args"; echo http://url/q?${REPLY} 
```

[编辑]

这是匹配的 rawurldecode() 函数，它 - 谦虚地说 - 很棒。

```
# Returns a string in which the sequences with percent (%) signs followed by
# two hex digits have been replaced with literal characters.
rawurldecode() {

  # This is perhaps a risky gambit, but since all escape characters must be
  # encoded, we can replace %NN with \xNN and pass the lot to printf -b, which
  # will decode hex for us

  printf -v REPLY '%b' "${1//%/\\x}" # You can either set a return variable (FASTER)

  echo "${REPLY}"  #+or echo the result (EASIER)... or both... :p
} 
```

使用匹配集，我们现在可以执行一些简单的测试：

```
$ diff rawurlencode.inc.sh \
        <( rawurldecode "$( rawurlencode "$( cat rawurlencode.inc.sh )" )" ) \
        && echo Matched

Output: Matched 
```

如果你真的觉得你需要一个外部工具（嗯，它会更快，并且可能会做二进制文件等......）我在我的 OpenWRT 路由器上找到了这个......

```
replace_value=$(echo $replace_value | sed -f /usr/lib/ddns/url_escape.sed) 
```

其中 url_escape.sed 是包含以下规则的文件：

```
# sed url escaping
s:%:%25:g
s: :%20:g
s:<:%3C:g
s:>:%3E:g
s:#:%23:g
s:{:%7B:g
s:}:%7D:g
s:|:%7C:g
s:\\:%5C:g
s:\^:%5E:g
s:~:%7E:g
s:\[:%5B:g
s:\]:%5D:g
s:`:%60:g
s:;:%3B:g
s:/:%2F:g
s:?:%3F:g
s^:^%3A^g
s:@:%40:g
s:=:%3D:g
s:&:%26:g
s:\$:%24:g
s:\!:%21:g
s:\*:%2A:g 
```

虽然在 BASH 中编写这样一个能够处理 UTF-8 输入的脚本（可能使用并且非常冗长的规则集）并非不可能`xxd`，但有更快、更可靠的方法。尝试将 UTF-8 解码为 UTF-32 是一项与准确性相关的重要任务，尽管很容易不准确地做到这一点，以至于您认为它可以工作直到它不起作用的那一天。

甚至 Unicode 联盟在发现它不再 100% 与实际标准兼容后，也删除了他们的示例代码。

Unicode 标准在不断发展，并且变得非常微妙。任何你可以拼凑起来的实现都不会完全合规，如果你通过一些极端的努力来管理它，它就会**保持**合规。

* * *

## 回答 #3

> 赞同：183
> 
> 时间：2015-12-22T02:33:08.383

另一种选择是使用`jq`：

```
$ printf %s 'encode this'|jq -sRr @uri
encode%20this
$ jq -rn --arg x 'encode this' '$x|@uri'
encode%20this 
```

`-r`( `--raw-output`) 输出字符串的原始内容，而不是 JSON 字符串文字。`-n`( `--null-input`) 不从 STDIN 读取输入。

`-R`( `--raw-input`) 将输入行视为字符串，而不是将它们解析为 JSON，并且`-sR`( `--slurp --raw-input`) 将输入读入单个字符串。如果您的输入仅包含一行，或者您不想用 替换换行符，则可以替换`-sRr`为：`-Rr``%0A`

```
$ printf %s\\n 'multiple lines' 'of text'|jq -Rr @uri
multiple%20lines
of%20text
$ printf %s\\n 'multiple lines' 'of text'|jq -sRr @uri
multiple%20lines%0Aof%20text%0A 
```

或者这个百分比编码所有字节：

```
xxd -p|tr -d \\n|sed 's/../%&/g' 
```

* * *

## 回答 #4

> 赞同：100
> 
> 时间：2008-11-18T09:34:45.997

在 bash 脚本的第二行使用 Perl 的`URI::Escape`模块和函数：`uri_escape`

```
...

value="$(perl -MURI::Escape -e 'print uri_escape($ARGV[0]);' "$2")"
... 
```

**编辑：**修复引用问题，正如 Chris Johnsen 在评论中所建议的那样。谢谢！

* * *

## 回答 #5

> 赞同：77
> 
> 时间：2012-05-29T11:11:23.320

一种变体，可能很难看，但很简单：

```
urlencode() {
    local data
    if [[ $# != 1 ]]; then
        echo "Usage: $0 string-to-urlencode"
        return 1
    fi
    data="$(curl -s -o /dev/null -w %{url_effective} --get --data-urlencode "$1" "")"
    if [[ $? != 3 ]]; then
        echo "Unexpected error" 1>&2
        return 2
    fi
    echo "${data##/?}"
    return 0
} 
```

例如，这是单行版本（如[*Bruno*](https://stackoverflow.com/questions/296536/how-to-urlencode-data-for-curl-command#comment21366455_10797966)建议的那样）：

```
date | curl -Gso /dev/null -w %{url_effective} --data-urlencode @- "" | cut -c 3-

# If you experience the trailing %0A, use
date | curl -Gso /dev/null -w %{url_effective} --data-urlencode @- "" | sed -E 's/..(.*).../\1/' 
```

* * *

## 回答 #6

> 赞同：73
> 
> 时间：2011-09-21T21:10:50.273

为了完整起见，许多解决方案使用`sed`或`awk`仅翻译一组特殊字符，因此代码大小相当大，也不翻译应编码的其他特殊字符。

一种安全的 urlencode 方法是只对每个字节进行编码——即使是那些被允许的字节。

```
echo -ne 'some random\nbytes' | xxd -plain | tr -d '\n' | sed 's/\(..\)/%\1/g' 
```

xxd 在这里注意输入被处理为字节而不是字符。

编辑：

xxd 带有 Debian 中的 vim-common 软件包，我只是在一个没有安装它的系统上，我不想安装它。替代方案是使用`hexdump`Debian 中的 bsdmainutils 包。根据下图，安装 bsdmainutils 和 vim-common 的可能性应该差不多：

[http://qa.debian.org/popcon-png.php?packages=vim-common%2Cbsdmainutils&show_installed=1&want_legend=1&want_ticks=1](http://qa.debian.org/popcon-png.php?packages=vim-common%2Cbsdmainutils&show_installed=1&want_legend=1&want_ticks=1)

但尽管如此，这里有一个版本使用`hexdump`而不是`xxd`允许避免`tr`调用：

```
echo -ne 'some random\nbytes' | hexdump -v -e '/1 "%02x"' | sed 's/\(..\)/%\1/g' 
```

* * *

## 回答 #7

> 赞同：58
> 
> 时间：2010-02-10T10:26:10.760

我发现它在 python 中更具可读性：

```
encoded_value=$(python3 -c "import urllib.parse; print urllib.parse.quote('''$value''')") 
```

三重 ' 确保价值中的单引号不会受到伤害。urllib 在标准库中。例如，它适用于这个疯狂的（现实世界）网址：

```
"http://www.rai.it/dl/audio/" "1264165523944Ho servito il re d'Inghilterra - Puntata 7 
```

* * *

## 回答 #8

> 赞同：36
> 
> 时间：2009-11-10T19:48:37.217

我发现以下代码片段有助于将其粘贴到程序调用链中，其中 URI::Escape 可能未安装：

```
perl -p -e 's/([^A-Za-z0-9])/sprintf("%%%02X", ord($1))/seg' 
```

（[来源](http://support.internetconnection.net/CODE_LIBRARY/Perl_URL_Encode_and_Decode.shtml)）

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2011-02-25T12:37:16.197

如果您希望运行`GET`请求并使用纯 curl，只需添加`--get`到 @Jacob 的解决方案即可。

这是一个例子：

```
curl -v --get --data-urlencode "access_token=$(cat .fb_access_token)" https://graph.facebook.com/me/feed 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2013-08-01T09:14:56.417

这可能是最好的一个：

```
after=$(echo -e "$before" | od -An -tx1 | tr ' ' % | xargs printf "%s") 
```

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2008-11-30T21:42:37.960

直接链接到 awk 版本：[http](http://www.shelldorado.com/scripts/cmds/urlencode)
://www.shelldorado.com/scripts/cmds/urlencode 我用了很多年，它就像一个魅力

```
:
##########################################################################
# Title      :  urlencode - encode URL data
# Author     :  Heiner Steven (heiner.steven@odn.de)
# Date       :  2000-03-15
# Requires   :  awk
# Categories :  File Conversion, WWW, CGI
# SCCS-Id.   :  @(#) urlencode  1.4 06/10/29
##########################################################################
# Description
#   Encode data according to
#       RFC 1738: "Uniform Resource Locators (URL)" and
#       RFC 1866: "Hypertext Markup Language - 2.0" (HTML)
#
#   This encoding is used i.e. for the MIME type
#   "application/x-www-form-urlencoded"
#
# Notes
#    o  The default behaviour is not to encode the line endings. This
#   may not be what was intended, because the result will be
#   multiple lines of output (which cannot be used in an URL or a
#   HTTP "POST" request). If the desired output should be one
#   line, use the "-l" option.
#
#    o  The "-l" option assumes, that the end-of-line is denoted by
#   the character LF (ASCII 10). This is not true for Windows or
#   Mac systems, where the end of a line is denoted by the two
#   characters CR LF (ASCII 13 10).
#   We use this for symmetry; data processed in the following way:
#       cat | urlencode -l | urldecode -l
#   should (and will) result in the original data
#
#    o  Large lines (or binary files) will break many AWK
#       implementations. If you get the message
#       awk: record `...' too long
#        record number xxx
#   consider using GNU AWK (gawk).
#
#    o  urlencode will always terminate it's output with an EOL
#       character
#
# Thanks to Stefan Brozinski for pointing out a bug related to non-standard
# locales.
#
# See also
#   urldecode
##########################################################################

PN=`basename "$0"`          # Program name
VER='1.4'

: ${AWK=awk}

Usage () {
    echo >&2 "$PN - encode URL data, $VER
usage: $PN [-l] [file ...]
    -l:  encode line endings (result will be one line of output)

The default is to encode each input line on its own."
    exit 1
}

Msg () {
    for MsgLine
    do echo "$PN: $MsgLine" >&2
    done
}

Fatal () { Msg "$@"; exit 1; }

set -- `getopt hl "$@" 2>/dev/null` || Usage
[ $# -lt 1 ] && Usage           # "getopt" detected an error

EncodeEOL=no
while [ $# -gt 0 ]
do
    case "$1" in
        -l) EncodeEOL=yes;;
    --) shift; break;;
    -h) Usage;;
    -*) Usage;;
    *)  break;;         # First file name
    esac
    shift
done

LANG=C  export LANG
$AWK '
    BEGIN {
    # We assume an awk implementation that is just plain dumb.
    # We will convert an character to its ASCII value with the
    # table ord[], and produce two-digit hexadecimal output
    # without the printf("%02X") feature.

    EOL = "%0A"     # "end of line" string (encoded)
    split ("1 2 3 4 5 6 7 8 9 A B C D E F", hextab, " ")
    hextab [0] = 0
    for ( i=1; i<=255; ++i ) ord [ sprintf ("%c", i) "" ] = i + 0
    if ("'"$EncodeEOL"'" == "yes") EncodeEOL = 1; else EncodeEOL = 0
    }
    {
    encoded = ""
    for ( i=1; i<=length ($0); ++i ) {
        c = substr ($0, i, 1)
        if ( c ~ /[a-zA-Z0-9.-]/ ) {
        encoded = encoded c     # safe character
        } else if ( c == " " ) {
        encoded = encoded "+"   # special handling
        } else {
        # unsafe character, encode it as a two-digit hex-number
        lo = ord [c] % 16
        hi = int (ord [c] / 16);
        encoded = encoded "%" hextab [hi] hextab [lo]
        }
    }
    if ( EncodeEOL ) {
        printf ("%s", encoded EOL)
    } else {
        print encoded
    }
    }
    END {
        #if ( EncodeEOL ) print ""
    }
' "$@" 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2017-01-01T02:44:09.043

这是一个不调用任何外部程序的 Bash 解决方案：

```
uriencode() {
  s="${1//'%'/%25}"
  s="${s//' '/%20}"
  s="${s//'"'/%22}"
  s="${s//'#'/%23}"
  s="${s//'$'/%24}"
  s="${s//'&'/%26}"
  s="${s//'+'/%2B}"
  s="${s//','/%2C}"
  s="${s//'/'/%2F}"
  s="${s//':'/%3A}"
  s="${s//';'/%3B}"
  s="${s//'='/%3D}"
  s="${s//'?'/%3F}"
  s="${s//'@'/%40}"
  s="${s//'['/%5B}"
  s="${s//']'/%5D}"
  printf %s "$s"
} 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2011-01-11T12:51:29.847

```
url=$(echo "$1" | sed -e 's/%/%25/g' -e 's/ /%20/g' -e 's/!/%21/g' -e 's/"/%22/g' -e 's/#/%23/g' -e 's/\$/%24/g' -e 's/\&/%26/g' -e 's/'\''/%27/g' -e 's/(/%28/g' -e 's/)/%29/g' -e 's/\*/%2a/g' -e 's/+/%2b/g' -e 's/,/%2c/g' -e 's/-/%2d/g' -e 's/\./%2e/g' -e 's/\//%2f/g' -e 's/:/%3a/g' -e 's/;/%3b/g' -e 's//%3e/g' -e 's/?/%3f/g' -e 's/@/%40/g' -e 's/\[/%5b/g' -e 's/\\/%5c/g' -e 's/\]/%5d/g' -e 's/\^/%5e/g' -e 's/_/%5f/g' -e 's/`/%60/g' -e 's/{/%7b/g' -e 's/|/%7c/g' -e 's/}/%7d/g' -e 's/~/%7e/g') 
```

这将对 $1 中的字符串进行编码并将其输出到 $url 中。虽然如果你愿意，你不必把它放在一个 var 中。顺便说一句，没有包含 sed for tab 认为它会变成空格

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2012-01-31T23:10:59.600

从 shell 脚本中使用 php：

```
value="http://www.google.com"
encoded=$(php -r "echo rawurlencode('$value');")
# encoded = "http%3A%2F%2Fwww.google.com"
echo $(php -r "echo rawurldecode('$encoded');")
# returns: "http://www.google.com" 
```

1.  [http://www.php.net/manual/en/function.rawurlencode.php](http://www.php.net/manual/en/function.rawurlencode.php)
2.  [http://www.php.net/manual/en/function.rawurldecode.php](http://www.php.net/manual/en/function.rawurldecode.php)

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2008-11-17T19:42:51.823

如果你不想依赖 Perl，你也可以使用 sed。这有点混乱，因为每个字符都必须单独转义。制作一个包含以下内容的文件并调用它`urlencode.sed`

```
s/%/%25/g
s/ /%20/g
s/ /%09/g
s/!/%21/g
s/"/%22/g
s/#/%23/g
s/\$/%24/g
s/\&/%26/g
s/'\''/%27/g
s/(/%28/g
s/)/%29/g
s/\*/%2a/g
s/+/%2b/g
s/,/%2c/g
s/-/%2d/g
s/\./%2e/g
s/\//%2f/g
s/:/%3a/g
s/;/%3b/g
s//%3e/g
s/?/%3f/g
s/@/%40/g
s/\[/%5b/g
s/\\/%5c/g
s/\]/%5d/g
s/\^/%5e/g
s/_/%5f/g
s/`/%60/g
s/{/%7b/g
s/|/%7c/g
s/}/%7d/g
s/~/%7e/g
s/      /%09/g 
```

要使用它，请执行以下操作。

```
STR1=$(echo "https://www.example.com/change&$ ^this to?%checkthe@-functionality" | cut -d\? -f1)
STR2=$(echo "https://www.example.com/change&$ ^this to?%checkthe@-functionality" | cut -d\? -f2)
OUT2=$(echo "$STR2" | sed -f urlencode.sed)
echo "$STR1?$OUT2" 
```

这会将字符串拆分为需要编码的部分，以及可以的部分，对需要它的部分进行编码，然后重新缝合在一起。

为方便起见，您可以将其放入 sh 脚本中，也许需要一个参数进行编码，将其放在您的路径上，然后您可以调用：

```
urlencode https://www.exxample.com?isThisFun=HellNo 
```

[[来源](http://www.unix.com/shell-programming-scripting/59936-url-encoding.html)]

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2020-07-08T06:20:06.390

Python 3 基于@sandro 2010 年的好回答：

```
echo "Test & /me" | python -c "import urllib.parse;print (urllib.parse.quote(input()))" 
```

测试%20%26%20/我

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2010-06-20T00:22:08.960

对于那些正在寻找不需要 perl 的解决方案的人，这里是一个只需要 hexdump 和 awk 的解决方案：

```
url_encode() {
 [ $# -lt 1 ] && { return; }

 encodedurl="$1";

 # make sure hexdump exists, if not, just give back the url
 [ ! -x "/usr/bin/hexdump" ] && { return; }

 encodedurl=`
   echo $encodedurl | hexdump -v -e '1/1 "%02x\t"' -e '1/1 "%_c\n"' |
   LANG=C awk '
     $1 == "20"                    { printf("%s",   "+"); next } # space becomes plus
     $1 ~  /0[adAD]/               {                      next } # strip newlines
     $2 ~  /^[a-zA-Z0-9.*()\/-]$/  { printf("%s",   $2);  next } # pass through what we can
                                   { printf("%%%s", $1)        } # take hex value of everything else
   '`
} 
```

从网络上的几个地方和一些本地试验和错误缝合在一起。效果很好！

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2012-11-26T08:48:57.270

[uni2ascii](http://www.billposer.org/Software/uni2ascii.html)非常方便：

```
$ echo -ne '你好世界' | uni2ascii -aJ
%E4%BD%A0%E5%A5%BD%E4%B8%96%E7%95%8C 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2015-01-20T21:08:51.677

[`encodeURIComponent`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)您可以在 perl中模拟 javascript 。这是命令：

```
perl -pe 's/([^a-zA-Z0-9_.!~*()'\''-])/sprintf("%%%02X", ord($1))/ge' 
```

您可以将其设置为 bash 别名`.bash_profile`：

```
alias encodeURIComponent='perl -pe '\''s/([^a-zA-Z0-9_.!~*()'\''\'\'''\''-])/sprintf("%%%02X",ord($1))/ge'\' 
```

现在您可以通过管道输入`encodeURIComponent`：

```
$ echo -n 'hèllo wôrld!' | encodeURIComponent
h%C3%A8llo%20w%C3%B4rld! 
```

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2015-02-26T04:40:31.503

简单的 PHP 选项：

```
echo 'part-that-needs-encoding' | php -R 'echo urlencode($argn);' 
```

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2014-11-14T11:55:29.400

问题是关于在 bash 中执行此操作，并且不需要 python 或 perl，因为实际上有一个命令可以完全满足您的要求 - “urlencode”。

```
value=$(urlencode "${2}") 
```

这也好得多，例如，上面的 perl 答案没有正确编码所有字符。用你从 Word 中得到的长破折号试试，你得到了错误的编码。

请注意，您需要安装“gridsite-clients”才能提供此命令。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2021-02-11T16:42:13.847

这个基于 nodejs 的答案将在标准输入上使用[encodeURIComponent](https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)：

```
uriencode_stdin() {
    node -p 'encodeURIComponent(require("fs").readFileSync(0))'
}

echo -n $'hello\nwörld' | uriencode_stdin
hello%0Aw%C3%B6rld 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2014-07-07T00:04:58.943

这是节点版本：

```
uriencode() {
  node -p "encodeURIComponent('${1//\'/\\\'}')"
} 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2016-12-31T05:14:25.560

这是执行此操作的 POSIX 函数：

```
url_encode() {
   awk 'BEGIN {
      for (n = 0; n < 125; n++) {
         m[sprintf("%c", n)] = n
      }
      n = 1
      while (1) {
         s = substr(ARGV[1], n, 1)
         if (s == "") {
            break
         }
         t = s ~ /[[:alnum:]_.!~*\47()-]/ ? t s : t sprintf("%%%02X", m[s])
         n++
      }
      print t
   }' "$1"
} 
```

例子：

```
value=$(url_encode "$2") 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2017-04-12T17:42:15.800

什么会比 javascript 更好地解析 URL？

```
node -p "encodeURIComponent('$url')" 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2012-06-19T23:45:26.590

Ruby，为了完整性

```
value="$(ruby -r cgi -e 'puts CGI.escape(ARGV[0])' "$2")" 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2013-12-18T09:13:49.750

另一种php方法：

```
echo "encode me" | php -r "echo urlencode(file_get_contents('php://stdin'));" 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2017-01-31T10:45:24.143

这是我的嵌入式系统busybox ash shell版本，我最初采用了Orwellophile的变体：

```
urlencode()
{
    local S="${1}"
    local encoded=""
    local ch
    local o
    for i in $(seq 0 $((${#S} - 1)) )
    do
        ch=${S:$i:1}
        case "${ch}" in
            [-_.~a-zA-Z0-9]) 
                o="${ch}"
                ;;
            *) 
                o=$(printf '%%%02x' "'$ch")                
                ;;
        esac
        encoded="${encoded}${o}"
    done
    echo ${encoded}
}

urldecode() 
{
    # urldecode <string>
    local url_encoded="${1//+/ }"
    printf '%b' "${url_encoded//%/\\x}"
} 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2011-04-29T18:32:33.683

这是使用 Lua 进行的单行转换，类似于[blueyed 的答案](https://stackoverflow.com/questions/296536/urlencode-from-a-bash-script/1710689#1710689)，除了所有[RFC 3986 未保留字符](http://www.apps.ietf.org/rfc/rfc3986.html#sec-2.3)未编码（[如此答案](https://stackoverflow.com/questions/296536/urlencode-from-a-bash-script/296556#296556)）：

```
url=$(echo 'print((arg[1]:gsub("([^%w%-%.%_%~])",function(c)return("%%%02X"):format(c:byte())end)))' | lua - "$1") 
```

此外，您可能需要确保字符串中的换行符从 LF 转换为 CRLF，在这种情况下，您可以`gsub("\r?\n", "\r\n")`在百分比编码之前在链中插入 a。

这是一个变体，在[application/x-www-form-urlencoded 的非标准样式中](https://stackoverflow.com/questions/1634271/url-encoding-the-space-character-or-20)，进行换行规范化，并将空格编码为 '+' 而不是 '%20' （可能会添加到Perl 片段使用类似的技术）。

```
url=$(echo 'print((arg[1]:gsub("\r?\n", "\r\n"):gsub("([^%w%-%.%_%~ ]))",function(c)return("%%%02X"):format(c:byte())end):gsub(" ","+"))' | lua - "$1") 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2013-08-15T12:04:33.463

安装 php 我使用这种方式：

```
URL_ENCODED_DATA=`php -r "echo urlencode('$DATA');"` 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2013-12-25T14:07:12.477

这是 orwellophile 的答案的 ksh 版本，其中包含 rawurlencode 和 rawurldecode 函数（链接：[How to urlencode data for curl command?](https://stackoverflow.com/questions/296536/urlencode-from-a-bash-script/10660730#10660730)）。我没有足够的代表发表评论，因此新帖子..

```
#!/bin/ksh93

function rawurlencode
{
    typeset string="${1}"
    typeset strlen=${#string}
    typeset encoded=""

    for (( pos=0 ; pos<strlen ; pos++ )); do
        c=${string:$pos:1}
        case "$c" in
            [-_.~a-zA-Z0-9] ) o="${c}" ;;
            * )               o=$(printf '%%%02x' "'$c")
        esac
        encoded+="${o}"
    done
    print "${encoded}"
}

function rawurldecode
{
    printf $(printf '%b' "${1//%/\\x}")
}

print $(rawurlencode "C++")     # --> C%2b%2b
print $(rawurldecode "C%2b%2b") # --> C++ 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-01-03T04:56:48.490

以下内容基于 Orwellophile 的回答，但通过设置 LC_ALL=C（来自 vte.sh 的技巧）解决了评论中提到的多字节错误。我已经以适合 PROMPT_COMMAND 的函数形式编写了它，因为这就是我使用它的方式。

```
print_path_url() {
  local LC_ALL=C
  local string="$PWD"
  local strlen=${#string}
  local encoded=""
  local pos c o

  for (( pos=0 ; pos<strlen ; pos++ )); do
     c=${string:$pos:1}
     case "$c" in
        [-_.~a-zA-Z0-9/] ) o="${c}" ;;
        * )               printf -v o '%%%02x' "'$c"
     esac
     encoded+="${o}"
  done
  printf "\033]7;file://%s%s\007" "${HOSTNAME:-}" "${encoded}"
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2019-06-26T17:27:06.497

对于我的一个案例，我发现 NodeJS`url`库有最简单的解决方案。当然是 YMMV

```
$ urlencode(){ node -e "console.log(require('url').parse(process.argv.slice(1).join('+')).href)" "$@"; }

$ urlencode "https://example.com?my_database_has=these 'nasty' query strings in it"
https://example.com/?my_database_has=these%20%27nasty%27%20query%20strings%20in%20it 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-06-28T08:00:18.507

Orwellophile 提供了一个很好的答案，其中确实包括一个纯 bash 选项（函数 rawurlencode），我在我的网站上使用过它（基于 shell 的 CGI 脚本，大量 URL 以响应搜索请求）。唯一的缺点是高峰期的高 CPU。

我找到了一个修改后的解决方案，利用 bash“全局替换”功能。使用此解决方案，url 编码的处理时间快 4 倍。该解决方案识别要转义的字符，并使用“全局替换”运算符 (${var//source/replacement}) 来处理所有替换。加速显然来自使用 bash 内部循环，而不是显式循环。

性能：在核心 i3-8100 3.60Ghz 上。测试用例：来自堆栈溢出的 1000 URL，类似于此票证：“https://stackoverflow.com/questions/296536/how-to-urlencode-data-for-curl-command”。

*   现有解决方案：0.807 秒
*   优化解决方案：0.162 秒（5 倍加速）

```
url_encode()
{
    local key="${1}" varname="${2:-_rval}" prefix="${3:-_ENCKEY_}"
    local unsafe=${key//[-_.~a-zA-Z0-9 ]/} 
    local -i key_len=${#unsafe}
    local ch ch1 ch0

    while [ "$unsafe" ] ;do
        ch=${unsafe:0:1}
        ch0="\\$ch"
        printf -v ch1 '%%%02x' "'$ch'" 
        key=${key//$ch0/"$ch1"}
        unsafe=${unsafe//"$ch0"}
    done
    key=${key// /+} 

    REPLY="$key"
    # printf "%s" "$REPLY"
    return 0
} 
```

作为一个小额外，它使用“+”来编码空间。稍微紧凑的 URL。

基准：

```
function t {
    local key
    for (( i=1 ; i<=$1 ; i++ )) do url_encode "$2" kkk2 ; done
    echo "K=$REPLY"
}

t 1000 "https://stackoverflow.com/questions/296536/how-to-urlencode-data-for-curl-command" 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2021-05-08T15:02:38.030

笔记

*   这些函数不是用来编码 URL 的数据，而是 URL。
*   以每行一个的方式将 URL 放入文件中。

```
#!/bin/dash

replaceUnicodes () { # $1=input/output file
    if ! mv -f "$1" "$1".tmp 2>/dev/null; then return 1; fi
    output="$1" awk '
    function hexValue(chr) {
        if(chr=="0") return 0; if(chr=="1") return 1; if(chr=="2") return 2; if(chr=="3") return 3; if(chr=="4") return 4; if(chr=="5") return 5;
        if(chr=="6") return 6; if(chr=="7") return 7; if(chr=="8") return 8; if(chr=="9") return 9; if(chr=="A") return 10;
        if(chr=="B") return 11; if(chr=="C") return 12; if(chr=="D") return 13; if(chr=="E") return 14; return 15 }
    function hexToDecimal(str,  value,i,inc) {
        str=toupper(str); value=and(hexValue(substr(str,length(str),1)),15); inc=1;
        for(i=length(str)-1;i>0;i--) {
            value+=lshift(hexValue(substr(str,i,1)),4*inc++)
        } return value }
    function toDecimal(str, value,i) {
        for(i=1;i<=length(str);i++) {
            value=(value*10)+substr(str,i,1)
        } return value }
    function to32BE(high,low) {
        # return 0x10000+((high-0xD800)*0x400)+(low-0xDC00) }
        return lshift((high-0xD800),10)+(low-0xDC00)+0x10000 }
    function toUTF8(value) {
        if(value<0x80) { 
            return sprintf("%%%02X",value)
        } else if(value>0xFFFF) {
            return sprintf("%%%02X%%%02X%%%02X%%%02X",or(0xF0,and(rshift(value,18),0x07)),or(0x80,and(rshift(value,12),0x3F)),or(0x80,and(rshift(value,6),0x3F)),or(0x80,and(rshift(value,0),0x3F)))
        } else if(value>0x07FF) {
            return sprintf("%%%02X%%%02X%%%02X",or(0xE0,and(rshift(value,12),0x0F)),or(0x80,and(rshift(value,6),0x3F)),or(0x80,and(rshift(value,0),0x3F)))
        } else { return sprintf("%%%02X%%%02X",or(0xC0,and(rshift(value,6),0x1F)),or(0x80,and(rshift(value,0),0x3F))) }
    }
    function trap(str) { sub(/^\\+/,"\\",str); return str }
    function esc(str) { gsub(/\\/,"\\\\",str); return str }
    BEGIN { output=ENVIRON["output"] }
    {
        finalStr=""; while(match($0,/[\\]+u[0-9a-fA-F]{4}/)) {
            p=substr($0,RSTART,RLENGTH); num=hexToDecimal(substr(p,RLENGTH-3,4));
            bfrStr=substr($0,1,RSTART-1); $0=substr($0,RSTART+RLENGTH,length($0)-(RSTART+RLENGTH-1));
            if(surrogate) {
                surrogate=0;
                if(RSTART!=1 || num<0xD800 || (num>0xDBFF && num<0xDC00) || num>0xDFFF) {
                    finalStr=sprintf("%s%s%s%s",finalStr,trap(highP),bfrStr,toUTF8(num))
                } else if(num>0xD7FF && num<0xDC00) {
                    surrogate=1; high=num; finalStr=sprintf("%s%s",finalStr,trap(highP))
                } else { finalStr=sprintf("%s%s",finalStr,toUTF8(to32BE(high,num))) }
            } else if(num>0xD7FF && num<0xDC00) {
                surrogate=1; highP=p; high=num; finalStr=sprintf("%s%s",finalStr,bfrStr)
            } else { finalStr=sprintf("%s%s%s",finalStr,bfrStr,toUTF8(num)) }
        } finalStr=sprintf("%s%s",finalStr,$0); $0=finalStr

        while(match($0,/[\\]+U[0-9a-fA-F]{8}/)) {
            str=substr($0,RSTART,RLENGTH); gsub(esc(str),toUTF8(hexToDecimal(substr(str,RLENGTH-7,8))),$0)
        }
        while(match($0,/[\\]*&#[xX][0-9a-fA-F]{1,8};/)) {
            str=substr($0,RSTART,RLENGTH); idx=index(str,"#");
            gsub(esc(str),toUTF8(hexToDecimal(substr(str,idx+2,RLENGTH-idx-2))),$0)
        }
        while(match($0,/[\\]*&#[0-9]{1,10};/)) {
            str=substr($0,RSTART,RLENGTH); idx=index(str,"#");
            gsub(esc(str),toUTF8(toDecimal(substr(str,idx+1,RLENGTH-idx-1))),$0)
        }
        printf("%s\n",$0) > output
    }' "$1".tmp
    rm -f "$1".tmp
}

replaceHtmlEntities () { # $1=input/output file
    if ! mv -f "$1" "$1".tmp 2>/dev/null; then return 1; fi
    sed 's/%3[aA]/:/g; s/%2[fF]/\//g; s/&quot;/%22/g; s/&lt;/%3C/g; s/&gt;/%3E/g; s/&nbsp;/%A0/g; s/&cent;/%A2/g; s/&pound;/%A3/g; s/&yen;/%A5/g; s/&copy;/%A9/g; s/&reg;/%AE/g; s/&amp;/\&/g; s/\\*\//\//g' "$1".tmp > "$1"
    rm -f "$1".tmp
}

# "od -v -A n -t u1 -w99999999"
# "hexdump -v -e \47/1 \42%d \42\47"
# Reminder :: Do not encode (, ), [, and ].
toUTF8Encoded () { # $1=input/output file
    if ! mv -f "$1" "$1".tmp 2>/dev/null; then return 1; fi
    if [ -s "$1".tmp ]; then
        # od -A n -t u1 -w99999999 "$1".tmp | \
        hexdump -v -e '/1 "%d "' "$1".tmp | \
        output="$1" awk 'function hexDigit(chr) { if((chr>47 && chr<58) || (chr>64 && chr<71) || (chr>96 && chr<103)) return 1; return 0 }
        BEGIN { output=ENVIRON["output"] }
        {   for(i=1;i<=NF;i++) {
                flushed=0; c=$(i);
                if(c==13) { if($(i+1)==10) i++; printf("%s\n",url) > output; url=""; flushed=1
                } else if(c==10) { printf("%s\n",url) > output; url=""; flushed=1
                } else if(c==37) {
                    if(hexDigit($(i+1)) && hexDigit($(i+2))) {
                        url=sprintf("%s%%%c%c",url,$(i+1),$(i+2)); i+=2
                    } else { url=sprintf("%s%%25",url) }
                } else if(c>32 && c<127 && c!=34 && c!=39 && c!=96 && c!=60 && c!=62) {
                    url=sprintf("%s%c",url,c)
                } else { url=sprintf("%s%%%02X",url,c) }
            } if(!flushed) printf("%s\n",url) > output
        }'
    fi
    rm -f "$1".tmp
} 
```

调用`replaceUnicodes()`--> `replaceHtmlEntities()`-->`toUTF8Encoded()`

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2021-10-15T14:46:46.433

在这种情况下，我需要对主机名进行 URL 编码。不要问为什么。作为一个极简主义者和 Perl 粉丝，这就是我想出的。

```
url_encode()
  {
  echo -n "$1" | perl -pe 's/[^a-zA-Z0-9\/_.~-]/sprintf "%%%02x", ord($&)/ge'
  } 
```

非常适合我。

# c# - IsInRole 问题

> ID：296538
> 
> 赞同：2
> 
> 时间：2008-11-17T19:10:43.883
> 
> 标签：c#, asp.net

我是第一次使用表单身份验证，我正在使用来自网络的示例来学习，我包含在我的 web.config

```
 <authentication mode="Forms">
        <forms name="MYWEBAPP.ASPXAUTH" loginUrl="Login.aspx" protection="All" path="/"/>
    </authentication>
    <authorization>
        <deny users="?"/>
    </authorization> 
```

然后我创建了一个用于登录“login.aspx”的页面，并将其编码在一个按钮上，只是为了开始；

```
private void btnLogin_Click(Object sender, EventArgs e)
    {
        // Initialize FormsAuthentication
        FormsAuthentication.Initialize();

         // Create a new ticket used for authentication
         FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(
            1, // Ticket version
            Username.Value, // Username associated with ticket
            DateTime.Now, // Date/time issued
            DateTime.Now.AddMinutes(30), // Date/time to expire
            true, // "true" for a persistent user cookie
            "accountants, seekers, copiers, typers", // User-data, in this case the roles
            FormsAuthentication.FormsCookiePath);// Path cookie valid for

         // Encrypt the cookie using the machine key for secure transport

         string hash = FormsAuthentication.Encrypt(ticket);
         HttpCookie cookie = new HttpCookie(
            FormsAuthentication.FormsCookieName, // Name of auth cookie
            hash); // Hashed ticket

         // Set the cookie's expiration time to the tickets expiration time
         if (ticket.IsPersistent) cookie.Expires = ticket.Expiration;

         // Add the cookie to the list for outgoing response
         Response.Cookies.Add(cookie);
    } 
```

我也在 Global.asax 中编码；

```
protected void Application_AuthenticateRequest(object sender, EventArgs e)
{
    if(HttpContext.Current.User != null)
    {
        if(HttpContext.Current.User.Identity.IsAuthenticated)
        {
            if (HttpContext.Current.User.Identity is FormsIdentity)
            {
                FormsIdentity id = (FormsIdentity)HttpContext.Current.User.Identity;
                FormsAuthenticationTicket ticket = id.Ticket;

                // Get the stored user-data, in this case, our roles
                string userData = ticket.UserData;
                string[] roles = userData.Split(',');
                HttpContext.Current.User = new GenericPrincipal(id, roles);
            }
        }
    }
} 
```

最后在另一个页面中，我试图确认获得的角色；

```
protected void Page_Load(object sender, EventArgs e)
{
    string str = null;

    if (User.IsInRole("seekers"))
    {
        str += " seekers ";
    }

    if (User.IsInRole("accountants"))
    {
        str += " accountants ";
    }

    if (User.IsInRole("copiers"))
    {
        str += "copiers";
    }

    Response.Write(str);
} 
```

但是发生了一些奇怪的事情，因为它只写“accountants”（注意“accountants”是分隔逗号字符串中的第一个元素），而不是应该显示的其他角色。我更改了 btnlogin 单击事件中角色列表的顺序，将“复印机”作为第一个元素写入，并且在页面中仅写入“复印机”。

我尝试过不同的组合，并且总是打印分隔逗号字符串的第一个元素。

对不起，我的无知，但这里发生了什么，所有的角色都在那里吗？是正常的？还是我在这里忘记了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:14:50.600

删除空格

```
"accountants, seekers, copiers, typers" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T19:16:45.620

尝试不带逗号后的空格：“accountants,seekers,copiers,typers”

Split 将创建诸如“accountants”、“seekers”、“copiers”、“typers”之类的字符串，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T19:17:19.690

您正在拆分 ',' ...但是当您初始化角色字符串时，它实际上是“，”（逗号空格）。

对此的一个提示是使用调试器并使用即时窗口来实际“查看”正在发生的事情。

# mshtml - 嵌入式 MSHTML：鼠标滚轮被忽略

> ID：296548
> 
> 赞同：1
> 
> 时间：2008-11-17T19:14:50.943
> 
> 标签：mshtml

在我的 VC++ 应用程序中，我有一个嵌入式浏览器 (MSHTML)。它工作正常并正确处理鼠标（例如，单击和选择处理正常）。但是，嵌入式浏览器上的鼠标滚轮旋转没有任何效果。这是我的问题。

我对 MSHTML 嵌入的内部结构和一般的 OLE 不是很熟悉。这是一个 wxWidgets 应用程序（wxWidgets 是一个 C++ GUI 库），我正在使用它的 IEHTMLWin 组件（它承载一个 MSHTML 控件并将其包装在 wxWindow 界面中）。但是，我确实有源代码，并且愿意进行一些调试。

忘记 wxWidgets 并纯粹谈论 OLE 和 MSHTML，什么是开始寻找问题原因的正确位置？我尝试天真地搜索“mshtml 鼠标事件”或“mshtml 滚轮”的变体，但没有给出任何好的指示。

如果你想看一下 IEHTMLWin 的代码，可以在[这里](http://wxcode.cvs.sourceforge.net/viewvc/wxcode/wxCode/components/iehtmlwin/src/)浏览。iehtmlwin.c 文件（1,5 k 行）包含所有与 OLE 相关的代码，并实现了托管 Web 浏览器控件所需的所有接口。值得注意的是，鼠标事件根本不会进入包含的 wxWindow（永远不会调用 OnMouse）。

{UPD} mshtml 版本：6.00.2900.3314。承载此控件的其他应用程序（包括 IE）支持滚轮。{/UPD}

* * *

jdigital 提示（关于 winspector）非常有帮助。经过一些消息嗅探，我意识到问题与焦点有关。单击浏览器控件以某种方式不会将焦点设置在浏览器控件上（与 RichEdit 不同），并且不会将 WM_MOUSEWHEEL 发送到那里。所以新的问题是设置焦点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T21:14:01.590

试试 Winspector ( [http://www.windows-spy.com/](http://www.windows-spy.com/) )，它可以让你看到 windows 消息。确保滚轮事件正在通过。

# lucene - 在 Lucene.net 中使用日期范围

> ID：296550
> 
> 赞同：3
> 
> 时间：2008-11-17T19:16:02.407
> 
> 标签：lucene, lucene.net

我了解 Lucene.net 如何用于文本索引。我能否根据给定的日期范围有效地搜索文档？或者 Lucene.net 会只使用文本匹配来匹配日期吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-20T11:02:41.603

Lucene.Net 将只使用文本匹配，因此您需要在添加到索引之前正确格式化日期：

```
 public static string Serialize(DateTime dateTime)
    {
        return dateTime.ToString("yyyyMMddHHmmss", CultureInfo.InvariantCulture);
    }

    public static DateTime Deserialize(string str)
    {
        return DateTime.ParseExact(str, "yyyyMMddHHmmss", CultureInfo.InvariantCulture);
    } 
```

例如，您可以执行基于范围的查询以按日期过滤（例如 2006* 到 2007* 以包括 2006 年和 2007 年的所有日期）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-13T04:07:31.933

当我将日期转换为`yyyymmddHHmmssff`. 当我尝试对数据进行排序时，它给了我一个太大而无法转换的异常。因此我搜索并发现你需要有两列。一中一`yyyymmdd`，`HHmmss`然后用`Sort[]`，给这两列再用。这将解决问题。

# vbscript - 使用 VBSCript 挂载/卸载 USB 驱动器

> ID：296560
> 
> 赞同：8
> 
> 时间：2008-11-17T19:17:33.027
> 
> 标签：vbscript

我正在寻找一种使用 VBScript 挂载\卸载 USB 闪存驱动器的方法。这是我能得到的最接近的。

```
Sub EjectDrive(strDrive)
On Error Resume Next
CONST SSF_DRIVES = 17
Set objShell = CreateObject("Shell.Application")
Set objDrive = objShell.Namespace(SSF_DRIVES).ParseName(strDrive)
objDrive.InvokeVerb "E&ject"
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T23:31:44.713

这将适用于 Windows Server 2003，但不幸的是不适用于 NT/2000/XP/Vista。

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colItems = objWMIService.ExecQuery _
    ("Select * From Win32_Volume Where Name = 'E:\\'")

For Each objItem in colItems
    objItem.Dismount(True, True)
Next 
```

从[卸载卷](http://www.microsoft.com/technet/scriptcenter/scripts/storage/disks/drives/stdvvb07.mspx?mfr=true)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T21:03:30.447

看看这个[线程](http://www.winserverkb.com/Uwe/Forum.aspx/windows-server-scripting/3654/Win32-Volume-dismount-method-failure)，它谈到了使用 mountvol.exe 命令行工具来挂载/卸载驱动器，它应该适用于 USB 闪存驱动器，或者还有一个名为 deveject 的程序。查看此线程以获取更多信息：[http ://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/d2e5d16e-e7c9-48ef-88b8-3abf6e638384](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/d2e5d16e-e7c9-48ef-88b8-3abf6e638384)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T01:58:15.557

您可以使用类似这样的方法弹出弹出对话框。我不确定是否可以卸载特定设备。

```
Set WshShell = WScript.CreateObject("WScript.Shell")
intReturn = WshShell.Run("RunDll32.exe shell32.dll,Control_RunDLL hotplug.dll", 1, TRUE) 
```

# java - 如何编写垃圾邮件过滤器

> ID：296579
> 
> 赞同：7
> 
> 时间：2008-11-17T19:24:03.077
> 
> 标签：java, email-spam

我不得不编写一个简单的垃圾邮件过滤器，我不确定我将如何去做。

到目前为止，我已经提出了 wordlist 和域过滤，它们将给出或删除达到某个阈值的点。

例如，如果您从列入黑名单的域中撰写有关“v1agr4”的信息，您将获得 2 分的垃圾邮件，但如果您从 hotmail.com 帐户撰写有关“v1agr4”的信息，您将仅获得 1 分“垃圾邮件点”。

你们还有其他建议/资源吗？

这更多是关于学习垃圾邮件过滤器，而不是开发企业级的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T19:30:21.503

这里有一些非常好的算法信息：

[http://www.paulgraham.com/spam.html](http://www.paulgraham.com/spam.html)

[http://www.paulgraham.com/better.html](http://www.paulgraham.com/better.html)

但是，说真的，为什么要重新发明轮子呢？

只需下载 K9： http: [//keir.net/k9.html](http://keir.net/k9.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T11:50:51.663

一些与贝叶斯垃圾邮件过滤相关的开源 Java 项目（LFSR Consulting 提到过）：

*   [分类器4j](http://classifier4j.sourceforge.net/)
*   [jBNC](http://sourceforge.net/project/showfiles.php?group_id=49871)
*   [乃班](http://www.tempeststrings.com/naiban/)

还有一个 C++ 额外的：

*   [垃圾邮件探测器](http://sourceforge.net/projects/spamprobe/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T19:31:20.677

查看[贝叶斯垃圾邮件过滤](http://en.wikipedia.org/wiki/Bayesian_spam_filtering)。

我知道 perl 有一个库，所以我假设 java 也有一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T20:58:29.983

我写[了一篇花里胡哨的东西](http://code.google.com/p/sblam/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T12:57:23.497

您可以将其委托给分布式服务。[Akismet](http://akismet.com/)是一个非常好的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-02T13:00:00.923

编写垃圾邮件过滤器取决于您对可扩展性的需求。

如果您想要一个可扩展的解决方案，那么内容过滤可能不是明智的选择，因为它非常消耗 CPU 和内存，您宁愿选择基于信誉的过滤或基于黑名单的过滤，这对 CPU 更友好在您的服务器上以及更容易编写。

我[在我的博客上写了一篇文章](http://programmers-tips.blogspot.co.il/2016/07/how-spam-filters-actually-work.html)，从程序员的角度解释了编写垃圾邮件过滤器的想法，并涵盖了从基于内容的过滤到基于黑名单的过滤的所有选项。

# c# - 创建对象实例而不调用构造函数？

> ID：296584
> 
> 赞同：69
> 
> 时间：2008-11-17T19:24:55.883
> 
> 标签：c#

**在 C# 中，有没有办法在不调用其构造函数的情况下实例化类的实例？**

假设该类是公共的并且在第 3 方库中定义并且构造函数是内部的。我想这样做的原因很复杂，但知道是否可以使用某种 C#hackery 会很有帮助。

注意：我特别**不想调用任何构造函数**，因此不能使用反射访问内部构造函数。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-11-17T20:33:43.717

我还没有尝试过，但是在反序列化期间使用了一个名为[FormatterServices.GetUninitializedObject](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getuninitializedobject.aspx)的方法。

来自 MSDN 的评论说：

> 因为对象的新实例被初始化为零并且没有运行构造函数，所以该对象可能不代表该对象认为有效的状态。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-17T19:27:47.517

实际上，听起来他们使构造函数成为内部构造函数，因此您无法实例化它。它可能有一个构建器或工厂方法。

查看这些文章：

[防止第三方衍生：第 1 部分](http://blogs.msdn.com/ericlippert/archive/2008/09/26/preventing-third-party-derivation-part-one.aspx)

[防止第三方衍生：第 2 部分](http://blogs.msdn.com/ericlippert/archive/2008/10/06/preventing-third-party-derivation-part-two.aspx)

他们有点解释推理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-05T14:40:28.243

与许多人认为的相反，构造函数与对象的实例化没有太大关系（相当误导的术语）。构造函数是一种特殊方法，可以在对象实例化后调用，以允许该对象正确初始化自身。在 C++ 中，对象实例化为对象分配内存，在 .NET 和 Java 中，它根据字段的类型（0、null、false 等）被分配和预初始化为默认值。然后运行时调用构造函数。新操作符将这两个单独的操作封装成一个看似单一的操作。如果不使用构造函数就无法创建实例，那么反序列化在 .NET 中永远不会起作用。也就是说，所谓的 ConstructorInfo 类型在调用其 Invoke(...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T19:26:41.993

可以通过反射访问构造函数并像那样调用它（但我不确定它是否会工作，因为构造函数是内部的 - 你必须测试它）。否则，据我所知，如果不调用构造函数，您将无法创建对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T19:29:01.087

请参阅 System.Activator.CreateInstance 函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T19:34:27.893

编辑：你更新了你的问题，你想构造一个没有构造函数的类。或调用默认的“空构造函数”。

这是无法做到的，因为如果已经指定了默认构造函数，编译器将不会生成默认构造函数。然而，为了读者的利益，这里是如何获得一个内部的、受保护的或私有的构造函数：

假设你的班级被称为 Foo：

```
using System.Reflection;

// If the constructor takes arguments, otherwise pass these as null
Type[] pTypes = new Type[1];
pTypes[0] = typeof(object);    
object[] argList = new object[1];
argList[0] = constructorArgs;

ConstructorInfo c = typeof(Foo).GetConstructor
    (BindingFlags.NonPublic |
     BindingFlags.Instance,
     null,
     pTypes,
     null);

Foo foo = 
    (Foo) c.Invoke(BindingFlags.NonPublic,
                   null, 
                   argList, 
                   Application.CurrentCulture); 
```

丑陋，但有效。

当然，将构造函数标记为内部可能有一个完全合理的理由，因此在通过反射获取它来滥用该类之前，您应该真正考虑您想要的逻辑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T20:22:16.283

您必须调用构造函数来创建对象。如果没有你喜欢的，也许你可以使用像 Mono 项目的 Cecil 这样的字节码重写库。它适用于 Windows 和 Linux。从我看到的一些演示来看，它看起来很酷。您可以更改方法的保护级别和各种疯狂的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-09T21:40:21.133

如果类（以及它引用的对象的类）是可序列化的，则可以通过使用输出到 MemoryStream 的 BinaryFormatter 序列化来创建深层副本（创建字节数组 byte[]），然后反序列化。请参阅[有关将对象转换为字节数组的问题的答案](https://stackoverflow.com/questions/4865104/convert-any-object-to-a-byte)。（但请注意 - 保存字节数组以供以后/其他地方使用可能不起作用。IOW 不要将字节数组保存到文件或其他持久形式。）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-17T20:04:57.270

您要求做的是违反了开发托管编程的哲学。.Net Framework 和 C# 的构建原则是，尽可能将对象从其底层内存中抽象出来。对象是对象，而不是结构化的字节数组。这就是为什么您不能将对象强制转换为 void 指针的原因。当对象从其底层内存中抽象出来时，建议对象实例可以在没有调用构造函数的情况下存在从根本上是无效的。

也就是说，.Net 框架已经让步，事实上，对象实际上是在内存中表示的。有了一些创造力，就可以在不调用它们的初始化程序的情况下实例化值类型。但是，如果您觉得需要这样做，那么您可能做错了。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-19T10:06:58.097

我注意到该主题的“死气沉沉”，但只是为了向更多读者澄清，并给出一个在发布问题时可能不可能的最终答案。就这样吧。

似乎您可以通过为其属性分配值来实例化一个类而不使用它的构造函数。这是 MSDN 中此类实例化的操作方法的地址[http://msdn.microsoft.com/en-us/library/bb397680.aspx](http://msdn.microsoft.com/en-us/library/bb397680.aspx)。

似乎这是一种不为人所知的技术，因为我在 CodeProject 的一篇文章中遇到了它，然后用谷歌搜索它并没有找到任何关于它的内容，后来访问了 MSDN 主页，有一篇文章将我与那个确切的链接学科。因此，这似乎是一个未知主题，而不是一个新主题，因为 CodeProject 发布日期为 2008 年 5 月。

希望这可以帮助谷歌这个并遇到这个问题的其他人。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-11-17T20:07:15.173

这里没有人完全阐明“无法做到”的含义。

构造函数*是*创建对象的对象。你的问题类似于“我怎样才能建造一座沙堡而不把它塑造成一座城堡？” 你不能——你所拥有的只是一堆沙子。

您可以做的最接近的事情是分配一块与您的对象大小相同的内存：

```
byte[] fakeObject = new byte[sizeof(myStruct)]; 
```

（注意：即使只在 MyStruct 中有效也是一个值类型）

# java - Hibernate 的轻量级替代品？

> ID：296587
> 
> 赞同：117
> 
> 时间：2008-11-17T19:25:24.993
> 
> 标签：java, database, hibernate, sqlite

我有一个单用户 java 程序，我想将数据存储在轻量级数据库中，例如 Derby 或 Sqlite。我想在我的程序中使用数据抽象层。Hibernate 似乎需要大量配置，并且对于我需要的东西来说太过分了。什么是 Hibernate 的轻量级替代品？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-11-17T22:45:06.447

如果您使用注解，Hibernate 需要几乎为零的配置。它甚至可以自动发现类路径中的映射 bean！**从简单性和**强大的角度来看，我看不到任何替代方案。

它还可以将自己暴露为 JPA，这（恕我直言）甚至更简单。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2010-06-25T18:02:34.660

我的[ORMLite](http://ormlite.com/)库就是这样一种选择。它支持 MySQL、Postgres、Microsoft SQL Server、H2、Derby、HSQLDB 和 Sqlite，并且可以很容易地扩展到其他人。它使用注解来配置类、良好的 Spring 支持、灵活的查询构建器等。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-11-17T19:53:43.157

它仍然需要 XML 配置，但请查看[MyBatis（以前称为 iBatis）](https://mybatis.org)。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-12-23T20:14:09.453

[jOOQ](http://www.jooq.org)附带了一个流畅的 DSL，直接在 Java 中模拟 SQL，作为其主要目标的副作用：

*   源代码生成
*   完全支持标准 SQL，包括 SQL 语言功能，如 UNION、嵌套 SELECT、所有类型的 JOIN、别名（例如，自连接）等
*   广泛支持非标准 SQL，包括 UDT、存储过程、供应商特定函数等。

在本文中阅读有关 jOOQ 的信息：http://java.dzone.com/announcements/simple-and-intuitive-approach [，](http://java.dzone.com/announcements/simple-and-intuitive-approach)或直接访问网站：http: [//www.jooq.org](http://www.jooq.org)

（免责声明，我在 jOOQ 背后的公司工作）

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-16T20:22:37.520

[Apache Commons DBUtils](http://commons.apache.org/dbutils/)消除了 JDBC 编程中大量重复的繁琐工作。它需要很少的配置并且易于学习。它不是一个 ORM 框架（就像这里提到的 Hibernate 和其他框架那样），但它确实自动将 SELECT 列映射到 Java 成员字段以及其他重复的 JDBC 编程任务。它当然很轻。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-11-12T04:37:53.060

你可以看看[Ebean ORM](http://ebean-orm.github.io/)。- 没有会话 - 延迟加载正常工作 - 使用和学习更简单的 API。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-17T20:36:08.533

[Cayenne](http://cayenne.apache.org/)为我提供了很好的服务。相对容易理解和启动和运行。我发现逆向工程部分特别迷人。可以使用 GUI 进行配置。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-01-11T09:20:46.693

我可以提出 apache Empire-db。[http://incubator.apache.org/empire-db/](http://incubator.apache.org/empire-db/)

Apache Empire-db 是一个开源的关系数据持久化组件，它允许数据库供应商独立的动态查询定义以及安全和简单的数据检索和更新。与大多数其他解决方案（如 Hibernate、TopLink、iBATIS 或 JPA 实现）相比，Empire-db 采用了截然不同的方法，特别关注***编译时安全***、减少冗余和提高开发人员的生产力。

一个例子：

```
// Define the query
DBCommand cmd = db.createCommand();
DBColumnExpr EMPLOYEE_FULLNAME= db.EMPLOYEES.LASTNAME.append(", ")
                        .append(db.EMPLOYEES.FIRSTNAME).as("FULL_NAME");
// Select required columns
cmd.select(db.EMPLOYEES.EMPLOYEE_ID, EMPLOYEE_FULLNAME);
cmd.select(db.EMPLOYEES.GENDER, db.EMPLOYEES.PHONE_NUMBER);
cmd.select(db.DEPARTMENTS.NAME.as("DEPARTMENT"));
cmd.select(db.DEPARTMENTS.BUSINESS_UNIT);
// Set Joins
cmd.join(db.EMPLOYEES.DEPARTMENT_ID, db.DEPARTMENTS.DEPARTMENT_ID);
// Set contraints and order
cmd.where(EMP.LASTNAME.length().isGreaterThan(0));
cmd.orderBy(EMP.LASTNAME);; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-08-03T18:00:29.117

ORMAN框架也不错。[https://github.com/ahmetalpbalkan/orman](https://github.com/ahmetalpbalkan/orman)

文档：[https ://github.com/ahmetalpbalkan/orman/wiki](https://github.com/ahmetalpbalkan/orman/wiki)

比较：[https ://github.com/ahmetalpbalkan/orman/wiki/Why-orman-is-better-than-other-orms-for-you%3F](https://github.com/ahmetalpbalkan/orman/wiki/Why-orman-is-better-than-other-orms-for-you%3F)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-04-07T21:32:19.457

我可能有点晚了，但我在 2010 年发布了[ActiveJDBC](http://javalite.io/activejdbc/) ，它是 ActiveRecord 模式的 ORM 实现，在依赖项上比 Hibernate 轻 10 倍以上，运行时至少快两倍，并且需要零配置或注释。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-17T20:37:51.197

您可能想看看 prevayler（在 sourceforge 上）。一种更轻量级的持久性方法。或者您是否正在考虑针对数据库进行报告？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-16T12:35:37.133

如果不强制使用关系数据库，请尝试使用 db4o。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-12-10T15:02:45.673

我创建了[sormula](http://sourceforge.net/projects/sormula/)作为重量级 ORM 的替代品。它支持 CRUD、POJO 友好、易于使用、配置和理解。零配置使用是可能的。[www.sormula.org](http://www.sormula.org)

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2012-11-19T18:30:37.273

Kiteframework 也是非常轻量级的 orm 框架。它以最少的配置提供几乎所有的数据库操作。

[http://deipakgarg.github.com/Kite-ORM/](http://deipakgarg.github.com/Kite-ORM/)

**披露：我是这个项目的作者**

# sendmail - 您的电子邮件客户端是否允许您以编程方式添加自定义标头？

> ID：296603
> 
> 赞同：12
> 
> 时间：2008-11-17T19:32:33.667
> 
> 标签：sendmail, email, email-spam, email-client

我正在开发一个反垃圾邮件项目（[centmail](http://centmail.net)），该项目涉及让发件人使用添加自定义标头（以及签名，但那部分[更容易](https://stackoverflow.com/questions/142319)）的客户端插件。一般的问题是在您的外发邮件中添加一个电子邮件标题，其中标题字段的内容是为每条消息动态确定的。

令人惊讶的是，这在 Pine/Alpine 中似乎是不可能的。Pine 允许您为传出邮件指定过滤脚本，但只有正文而不是标题通过它。您当然可以在 Pine 设置中定义自定义标题，但我认为无法动态更改它们的内容。

我很高兴听到如何在其他电子邮件客户端（Thunderbird、Outlook、Evolution、Mutt 等）中执行此操作。当然，如果我对 Pine 的看法有误。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-27T08:38:41.587

你可以在[Eudora](http://email.about.com/od/eudoratips/qt/et_extra_header.htm)中做到这一点。

您可以[在 Outlook](http://www.systemwebmail.com/faq/2.8.aspx)中使用[自定义表单以](http://www.add-in-express.com/forum/read.php?FID=5&TID=1480)编程方式进行操作。

您可以[从 about:config 在 Mozilla](http://email.about.com/cs/mozillatips/qt/et030604.htm)中执行此操作。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-27T08:40:33.393

虽然它不是严格意义上的插件，但您可以制作一个代理 SMTP 服务器来修改电子邮件 - 例如类似于 AVG Outgoing E-mail Scanner 之类的东西。这将具有与许多电子邮件客户端合作的优势；您还可以制作一个插件，一方面与代理通信，另一方面与电子邮件 UI 通信。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-02T05:50:43.823

Thunderbird 插件[Enigmail](https://addons.mozilla.org/en-US/thunderbird/addon/71)控制外发邮件的标题。所以这是一个存在证明，它在 Thunderbird 中是可能的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T10:54:10.720

我同意皮斯克沃尔的观点。我会将它实现为代理 SMTP 服务器，这将产生许多好处：

1.  您不会受限于任何一个电子邮件客户端，因此会受到其 API（如果有）的限制
2.  可以应用在邮件服务器端，免去安装部署的烦恼

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-27T10:58:31.790

Emacs 可以通过编程方式完成此操作。您可以创建一个缓冲区 ( `get-buffer-create`)，用标头信息填充它，然后以`mail-send`非交互方式调用 (设置`mail-interactive`为`nil`)。

与以下内容一起使用的缓冲区内容（标题+正文）示例`mail-send`：

```
From: "Toto" <toto@toto.net>
To: somebody@somewhere.net
Subject: Something
BCC: sebastien.rocca-serra@f4-group.com
--text follows this line--

Hello, how are you? 
```

您还可以通过在`mail-send-hook`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-27T11:02:15.213

这已经被专门询问过关于 Thunderbird 的问题：

*   [如何插入带有 Thunderbird 扩展的电子邮件标题？](https://stackoverflow.com/questions/162057/how-do-you-insert-email-headers-with-a-thunderbird-extension)

最佳答案包含修改普通 xul/js 中的标头的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-27T08:59:42.060

我从 Brain 曲调的旧部分中挖掘到了其他东西......

**如果我理解正确**，我认为这种方法是去配置 SENDMAIL 并通过 [bash/etc] 脚本编写 。

根文件 [http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ewtoc.html](http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ewtoc.html)

发送邮件配置

标头声明 [http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ch04/061-064.html#Heading22](http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ch04/061-064.html#Heading22)

[http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ch04/078-080.html](http://snap.nlc.dcccd.edu/reference/sysadmin/julian/ch04/078-080.html)

> 标题行的格式由 H 行定义。这一行的语法是
> 
> H[c ?c mflagsc ?]c hnamec :c htemplate
> 
> 本规范中的续行直接插入到传出消息中。htemplate 在插入到消息中之前进行了宏扩展。如果扩展为空，则不包括标题行。如果指定了 mflags（被问号包围），则必须在邮件程序定义中声明至少一个指定的标志，以便自动输出此标头。如果这些标头之一在输入中，则无论这些标志如何，它都会被定向到输出。
> 
> 特殊标题行 几个标题行具有配置文件定义的特殊解释。其他人在 sendmail 中内置了解释，如果不更改代码就无法更改。以下列表中描述了内置功能：
> 
> • Return-Receipt-To：如果发送此标头，则在最终交付完成后，将向任何指定的名称发送一条消息。邮件程序必须在邮件程序描述符中设置 l 标志（本地传递）。• Errors-To：如果在处理过程中的任何地方发生错误，此标头会将错误消息发送到列出的名称而不是发送者。将此标题行用于邮件列表，以便将错误返回给列表管理员。• 收件人：如果收到的邮件没有在邮件中列出收件人（在收件人：、抄送：或密件抄送：行中），sendmail 会为在sendmail 命令行中指定的每个收件人添加一个明显收件人：标题行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T00:20:46.457

我突然想到，因为 pine 是开源的，如果这个功能对你来说对这个程序很重要，你可以尝试为项目做贡献以添加这个功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T20:01:42.857

您可能想要研究的一件事是使用伪标题而不是标题。因为 pine/alpine 允许您为要通过的电子邮件指定一个过滤程序，您可以在开始时将标头添加到正文中，这应该很容易处理。我不确定它是否完全符合您的目的，因为我不知道您正在组装哪种类型的系统。

[我通过在Debian BTS System](http://www.debian.org/Bugs/Reporting#pseudoheader)中使用伪头文件了解了它们。

回答这个问题，我使用 GMail，你不能以编程方式编辑标题（我很想看到一个让你的网络邮件）。你[甚至不能](http://en.wikipedia.org/wiki/Gmail#Criticisms)过滤像 X-List 这样的自定义标题，这很烦人。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-30T13:53:48.853

为自定义标头插入邮件客户端的一般想法有问题。

那里有很多客户。包括不同的版本，在不同的系统上。

header+body 格式背后的好处是所有非用户、服务器和路由特定数据对用户都是隐藏的。这个想法很重要。我认为用户不应该为一些自定义的、与服务器相关的标头而烦恼。

此外，您尝试附加的数据实际上是用户特定的数据。喜欢签名。它验证发件人的有效性。没有理由对用户隐藏它。

电子邮件数据的签名是众所周知的过程，被 PGP、SMIME 等使用。可能有更多的邮件客户端允许此类操作（通过外部程序验证和签名）而不是允许添加或修改自定义邮件标题。

自定义标头应由邮件服务器修改；邮件客户端的用户数据。

我认为你应该把你的数据放在消息或消息部分。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-30T14:39:47.560

在不修改 pine 本身或修改邮件服务器的情况下使其在 pine 中工作的一种方法是让 pine 通过命令行程序（传统上是 /usr/sbin/sendmail 等）传递，并让被调用的程序成为原始程序的包装器程序。然后你可以添加你需要的任何标题。

虽然这很丑，但它肯定不会扩展到整个用户群。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-27T08:56:11.397

对于支持使用外部编辑器的所有邮件客户端，您可以拥有一个脚本，将特定标头添加到发送到编辑器的模板中。在[mutt](http://www.mutt.org/)中，有一个名为的配置参数[`edit_headers`](http://www.mutt.org/doc/manual/manual-6.html#edit_headers)可以添加一组通用的标头，因此很容易添加您自己的标头。还有另一个[`my_hdr`](http://www.mutt.org/doc/manual/manual-3.html#my_hdr)可以使用的参数称为。Mutt 确实支持 ` backtick ` 符号来运行外部命令。

能够指定自己的模板会更好，但目前还不可能。

# asp.net - 在 ASP .NET 页面中引发错误时，浏览器显示“页面未找到”消息

> ID：296604
> 
> 赞同：2
> 
> 时间：2008-11-17T19:32:45.947
> 
> 标签：asp.net, iis

当我导航到 ASP.NET 页面时，浏览器会显示“页面未找到”消息。该页面存在并且位于虚拟目录中，我可以在本地开发机器上的 IIS 上浏览它。什么可能导致服务器上出现此问题？

当我用旧版本替换 iam 使用的类库之一时，它可以工作。但是该页面也可以在我的本地机器上使用新版本的组件。我在服务器和我的开发机器上都有完全相同的文件。

我已将自定义错误设为“关闭”。有没有办法显示错误而不是“找不到页面”。

该页面是使用 .NET 2.0 构建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T08:50:48.753

您是否安装并激活了 ASP.NET 扩展？默认情况下，Windows Server 2003 中不安装此功能。当此功能未激活时，任何 .aspx 文件都会出现 404。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T05:49:10.133

您服务器上的虚拟目录是否允许编写脚本？关闭脚本可能会使页面无法访问。

# asp.net - 扩展 asp.net web 控件时，应该在哪个事件中注入额外的 web 控件？

> ID：296609
> 
> 赞同：3
> 
> 时间：2008-11-17T19:33:45.740
> 
> 标签：asp.net, vb.net, web-controls

我试图通过扩展现有控件来避免复合控件或使用和 ASCX。但是，我无法将控件添加到继承的控件并保持其视图状态/回发完整性。每当我在预渲染期间添加控件时，控件都会显示，但回发会引发视图状态异常。我尝试在那里和 LoadViewState 期间添加它们（这当然是一个长期的愚蠢）。Init 在我扩展的控件中不可用。

> 异常是 Sys.WebForms.PageRequestManagerServerErrorException：无法加载视图状态。正在加载视图状态的控制树必须与在先前请求期间用于保存视图状态的控制树匹配。例如，动态添加控件时，回发期间添加的控件必须与初始请求期间添加的控件的类型和位置相匹配

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T19:40:26.913

实际上，微软说你应该重写[CreateChildControls](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx)方法。

您可以在添加控件之前或之后调用基类方法，我不确定那里是否有约定。

```
protected override void CreateChildControls(){
  Controls.Add(someControl);
  base.CreateChildControls();
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T19:40:07.583

您应该在 OnInit 或 CreateChildControls 中添加它们。无论如何，为了避免 ViewState 出现问题，请阅读[这篇很棒的文章](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)。您的情况可能是示例“4\. 以编程方式初始化子控件”。

# asp.net - 使用查询字符串参数和 IE6/7 重定向到 EXE

> ID：296615
> 
> 赞同：1
> 
> 时间：2008-11-17T19:35:52.897
> 
> 标签：asp.net, c#-3.0

问候！

我在挠头，想知道为什么当我执行以下操作时：

```
Response.Redirect(@"http://www.example.com/file.exe?id=12345"); 
```

IE6 和 IE7 都将文件下载为“file”（没有扩展名），但 Firefox、Opera、Google Chrome 和 Safari 完全没有问题将文件下载为“file.exe”。

知道 IE6/7 的问题是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T19:43:25.987

您是否尝试在响应标头中设置正确的内容类型？例如：

```
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="file.exe" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T03:02:27.580

如果您使用 fiddler2 ( [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/) )，您可以准确地看到哪些标头被发送到 IE，这可能有助于您进行调试。

也许您可以在此处发布生成的标题？

我怀疑在重定向之前添加 Content-Type 和 Content-Disposition 会产生任何影响，因为浏览器会看到重定向标头并向重定向的 url 发出全新的 http 请求，这将是一组完全不同的标头。

但是，您可以尝试使用服务器端重定向的 Server.Transfer，如下所示：

```
Response.Clear(); //In case your .aspx page has already written some html content
Response.AddHeader("Content-Type", "application/octet-stream");
string disp = String.Format("attachment; filename={0}", fileName); // fileName = file.exe
Response.AddHeader("Content-Disposition", disp);

Server.Transfer(@"http://www.example.com/file.exe?id=12345"); 
```

或者，使用 Response.BinaryWrite ：

```
Response.Clear(); //In case your .aspx page has already written some html content
byte[] exeContent = ... //read the content of the .exe into a byte[]

Response.AddHeader("Content-Type", "application/octet-stream");
string disp = String.Format("attachment; filename={0}", fileName); // fileName = file.exe
Response.AddHeader("Content-Disposition", disp);

Response.BinaryWrite(exeContent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:53:24.097

您可能需要远程获取文件大小并将其添加到标题部分的 Content-Length 中。

# java - FreeMarker 模板中的 if-else

> ID：296619
> 
> 赞同：20
> 
> 时间：2008-11-17T19:37:52.660
> 
> 标签：java, template-engine, freemarker

FreeMarker 模板支持具有以下语法的 if 语句

```
<#if hot> 
  It's hot.
</#if> 
```

我查看了文档，找不到任何对 if-else 语句的支持。当然，我可以通过以下方式获得相同的结果：

```
<#if hot> 
  It's hot.
</#if>  
<#if !hot> 
  It's not hot.
</#if> 
```

FreeMarker 中是否支持 if-else？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-17T19:42:10.637

是的，你可以写：

```
<#if hot>
it's hot
<#else>
it's not
</#if> 
```

如果你正在做很多 freemarker，我真的可以推荐 IntelliJ IDEA 8，它的 freemarker 支持真的很有帮助......

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-18T16:19:27.660

是的，sintaxis 是：

`<#if condition>`

`...`

`<#elseif condition2>`

`...`

`<#elseif condition3>`

`...`

`<#else>`

`...`

`<#/if>`

你可以找到[Freemarker 完整参考](http://freemarker.sourceforge.net/docs/)

如果您使用的是 Netbeans，则有[这个插件](http://plugins.netbeans.org/PluginPortal/faces/PluginListPage.jsp?search=freemarker)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:35:30.203

*iberck*已经指出了文档。但这是[FreeMarker 中有关 if-else](http://freemarker.sourceforge.net/docs/ref_directive_if.html)的确切文档。

# svn - 阿帕奇访问控制

> ID：296632
> 
> 赞同：0
> 
> 时间：2008-11-17T19:43:44.487
> 
> 标签：svn, apache, mod-dav-svn

我正在尝试将 Apache 配置为允许只读访问，并在您来自本地网络（10.*）时要求用户写入 SVN 存储库，但除非从外部网络登录，否则不允许任何访问。

我有点理解 Order、Deny、Allow 和 Limit 指令是如何工作的，但我不知道是否有可能/如何将它们结合起来以达到预期的结果。

```
<Location /svn>
  # Set mod_dav_svn settings
  DAV svn
  SVNListParentPath on
  SVNParentPath /mnt/svn
  AuthzSVNAccessFile /mnt/svn/.authz

  # Set Authentication
  AuthType Basic
  AuthName "Auth Realm"
  AuthUserFile /mnt/svn/.htpasswd

  Order Deny,Allow
  Deny from all
  Allow from 127.0.0.1 10.0.0.0/8

  <LimitExcept GET PROPFIND OPTIONS REPORT>
    Require valid-user
  </LimitExcept>
  Satisfy Any
</Location> 
```

我知道这将允许所有访问任何本地流量，但在尝试从外部流量写入时要求登录。这接近我想要的。非常感谢您对阅读内容的任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T18:52:16.597

我不认为有解决办法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-12T00:23:14.157

这可能是一个迟到的回复，但你可以添加两个

VirtualHost 指令需要一个 ip 或 * 以及要监听的端口。假设您的主机在一台有两个网卡的机器上，只要每个只在正确的网卡上监听，它就应该做你想做的事......

# project-management - 项目文件夹结构推荐

> ID：296643
> 
> 赞同：12
> 
> 时间：2008-11-17T19:46:11.300
> 
> 标签：project-management, directory

我正准备实施一个源代码控制系统（颠覆），但我对如何构建我的文件夹有一些疑问。

我使用 Delphi 进行所有开发，并从 IDE 中编译项目。

我当前的项目文件夹结构如下：

```
-E:\工作\1。共享
--Forms（所有项目的共享表单）
--Units（所有项目中的共享单元/类，包括 JCL 等第 3 方）

-E:\工作\2。公司名
--Admin（与管理工作相关的东西，如许可证密钥生成器、自动处理订单处理的 Windows CGI，全部在 Delphi 中开发）
--项目
----项目A
-----5.x（版本 5.x）
------BIN（该项目的所有二进制文件所在的位置）
------Build Manager（FinalBuilder 项目所在的地方）
-------安装（创建 setup.exe 的 NSIS 文件）
--------Protection（项目文件保护已编译的exe）
--------更新（自动更新相关的inf文件）
------Docs（安装文件中包含的readme.txt、license.txt和history.txt在哪里）
--------缺陷（我或其他人进行的任何测试的文档）
--------HTMLHelp（项目的html帮助）
------研发（截图，设计理念和其他研发的东西去哪里）
------Releases（使用 FinalBuilder 构建版本时，nsis 创建的设置文件放在此处）
------资源（本项目使用的图像和其他资源）
------Source（如果存在子项目，它将编译为 BIN，因为它们都是相关的）
--------子项目A
--------子项目B
--------子项目C
--网站
--- companywebsite.com（目前唯一的一个，但如果我们决定为产品建立单独的网站，它们都将放在站点文件夹中）

```

符号“-”标记目录。

有人关心对当前结构发表评论或有任何改进建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-17T20:30:40.430

多年来建立了数百个项目，并且专注于软件配置管理和发布工程，我建议您首先关注您希望如何构建/发布您的项目。

如果您只使用 IDE 来构建（编译和打包）您的项目，那么您不妨遵循该 IDE 的典型约定，以及您可能找到的任何“最佳实践”。

但是，我强烈建议您不要仅使用 IDE 构建，甚至根本不要构建。相反，使用许多可用的出色开源工具中的一种或多种来创建自动构建/发布脚本。由于您的目标似乎是 Windows，因此我建议您先查看 Ant、Ivy 和适当的 xUnit（用于 Java 的 jUnit、用于 .NET 的 nUnit 等）进行测试。

一旦你开始走这条路，你会发现很多关于项目结构、设计构建脚本、测试等方面的建议。现在我不会用详细的建议让你不知所措，我只会把这些建议留给你——你会很容易找到答案在那里你的问题，以及找到更多值得调查的问题。

享受！

根据评论，似乎需要一些细节。

我要提出的一个特别建议是将代码库分成单独的子项目，每个子项目都产生一个可交付成果。主应用程序（.EXE）应该是一个，任何支持的二进制文件都是单独的项目，安装程序将是一个单独的项目，等等。

每个项目产生一个单一的主要交付物：一个.EXE、一个.DLL、一个.HLP 等。该交付物被“发布”到一个单一的、共享的、本地的输出目录。

创建一个目录树，其中子项目是对等的（没有深度或层次结构，因为它没有帮助），并且不要让项目“到达”彼此的子树 - 每个项目应该完全独立，仅依赖于主要可交付成果共享输出目录中引用的其他子项目。

不要创建相互调用的构建脚本的层次结构，我这样做并发现它不会增加价值，但会成倍增加维护工作。相反，制作一个调用独立构建脚本的持续集成脚本，但首先将干净的签出到临时目录中。

不要将任何可交付成果或依赖项提交到源代码控制中——不是您的构建输出，也不是您使用的库等。使用 Ivy 对您与源代码控制分开部署的类似 Maven 的二进制存储库，并将您自己的可交付成果发布到它用于在您的组织内共享。

哦，不要使用 Maven——它太复杂了，混淆了构建过程，因此定制起来不划算。

基于我的目标平台，我正在转向 SCons、BuildBot、Ant、Ivy、nAnt 等。

我一直在撰写关于这个主题的白皮书，我认为它可能有读者。

[编辑：请参阅我对如何组织版本控制存储库](https://stackoverflow.com/questions/222827/how-do-you-organize-your-version-control-repository#304036)的详细回答？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T19:49:05.583

为什么是 5.x？（在项目A下）

我认为在树中引入版本没有用 - 这就是颠覆等的用途。

# java - Thrift、Protocol Buffers、JSON、EJB、其他的性能比较？

> ID：296650
> 
> 赞同：70
> 
> 时间：2008-11-17T19:48:44.883
> 
> 标签：java, python, performance, protocol-buffers, thrift

我们正在研究传输/协议解决方案，并且即将进行各种性能测试，所以我想我会与社区核实他们是否已经这样做了：

有没有人对简单的回显服务进行服务器性能测试，以及比较 Linux 上的 EJB3、Thrift 和协议缓冲区的各种消息大小的序列化/反序列化？

主要语言将是 Java、C/C++、Python 和 PHP。

更新：我仍然对此非常感兴趣，如果有人做过任何进一步的基准测试，请告诉我。此外，非常有趣的基准测试显示压缩 JSON 的性能与 Thrift/Protocol Buffers 相似/更好，所以我也将 JSON 扔进了这个问题。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-23T22:48:30.130

最新比较可在[thrift-protobuf-compare](https://github.com/eishay/jvm-serializers/wiki/)项目 wiki 上找到。它包括许多其他序列化库。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-18T00:13:01.637

我正在一个[名为 thrift-protobuf-compare 的开源项目](http://code.google.com/p/thrift-protobuf-compare/)中编写一些代码，比较 protobuf 和 thrift。目前它涵盖的序列化方面很少，但我打算涵盖更多。结果（对于[Thrift](http://eishay.blogspot.com/search/label/Thrift)和[Protobuf](http://eishay.blogspot.com/search/label/protobuf)）在我的博客中进行了讨论，当我到达时我会添加更多内容。您可以查看代码以比较 API、描述语言和生成的代码。我很乐意为实现更全面的比较做出贡献。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-17T19:52:38.293

您可能对这个问题感兴趣：[“Thrift 与 Protocol Buffers 的最大区别？”](https://stackoverflow.com/questions/69316/biggest-differences-of-thrift-vs-protocol-buffers)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-09T22:46:07.167

我使用许多其他数据格式（xml、json、默认对象序列化、hessian、一种专有格式）和用于数据绑定任务（读取和写入）的库（jaxb、快速信息集、手写）测试了 PB 的性能，但不包括节俭的格式。具有多个转换器的格式（如 xml）的性能差异很大，从非常慢到非常快。作者的主张与感知绩效之间的相关性相当弱。尤其是对于那些提出最疯狂要求的包裹。

对于它的价值，我发现 PB 的性能被夸大了（通常不是它的作者，而是其他只知道谁写的人）。在默认设置下，它并没有击败最快的文本 xml 替代方案。使用优化模式（为什么这不是默认的？），它有点快，可以与最快的 JSON 包相媲美。Hessian 相当快，文本 json 也是。专有的二进制格式（这里没有名字，它是公司内部的）是最慢的。Java 对象序列化对于较大的消息来说速度很快，而对于小对象则不那么快（即，每次操作的高固定开销）。使用 PB 消息大小很紧凑，但考虑到您必须做的所有权衡（数据不是自我描述的：如果丢失模式，就会丢失数据；当然有索引和值类型，但从你所拥有的如果需要，可以对字段名称进行逆向工程），

我的观点是（a）实现通常比规范（数据格式）更重要，（b）端到端，最佳品种（不同格式）之间的差异通常不足以决定选择。也就是说，你最好选择你最喜欢使用的格式+API/lib/framework（或者有最好的工具支持），找到最好的实现，看看它是否足够快。如果（且仅当！）不是，请考虑下一个最佳选择。

附言。不确定这里的 EJB3 是什么。也许只是简单的 Java 序列化？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-17T22:25:23.240

如果原始净性能是目标，那么没有什么比 IIOP 更好（参见 RMI/IIOP）。尽可能小的占用空间——只有二进制数据，根本没有标记。序列化/反序列化也非常快。

由于它是 IIOP（即 CORBA），几乎所有语言都有绑定。

但我认为性能不是**唯一**的要求，对吧？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-17T19:56:14.727

在我的 PB 的“待办事项”列表顶部附近的一件事是移植 Google 的内部协议缓冲区性能基准 - 这主要是采用机密消息格式并将它们变成完全平淡无奇的格式，然后为数据。

完成后，我想您可以在 Thrift 中构建相同的消息，然后比较性能。

换句话说，我还没有给你的数据——但希望在接下来的几周内......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-04-05T20:04:16.077

为了支持 Vladimir 关于 IIOP 的观点，这里有一个有趣的性能测试，它应该提供一些关于 google 基准的额外信息，因为它比较了 Thrift 和 CORBA。（Performance_TIDorb_vs_Thrift_morfeo.pdf // 链接不再有效）引用该研究：

> *   Thrift 对小数据非常有效（基本类型作为操作参数）
> *   Thrifts 传输不如具有中型和大型数据（结构和>复杂类型> 1 KB）的 CORBA 高效。

另一个与性能无关的奇怪限制是 Thrift 仅限于返回几个值作为结构 - 尽管这与性能一样，可能肯定可以改进。

有趣的是，Thrift IDL 与 CORBA IDL 非常匹配，很好。我没有使用过 Thrift，它看起来很有趣，尤其是对于较小的消息，并且设计目标之一是减少繁琐的安装，因此这些是 Thrift 的其他优点。也就是说，CORBA 名声不好，有很多优秀的实现，例如[omniORB](http://omniorb.sourceforge.net/)，它具有Python 绑定，易于安装和使用。

已编辑：Thrift 和 CORBA 链接不再有效，但我确实从 CERN 找到了另一篇有用的论文。他们评估了 CORBA 系统的替代品，并且在[评估 Thrift](http://zeromq.wdfiles.com/local--files/intro%3aread-the-manual/Middleware%20Trends%20and%20Market%20Leaders%202011.pdf)时，他们最终选择了 ZeroMQ。虽然 Thrift 在他们的性能测试中表现最快，在 9000 msg/sec 与 8000（ZeroMQ）和 7000+ RDA（基于 CORBA），但由于其他问题，他们选择不进一步测试 Thrift：

> 它仍然是一个不成熟的产品，具有错误的实现

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-04T12:56:15.417

我为我的工作研究了 spring-boot、mappers（手动、Dozer 和 MapStruct）、Thrift、REST、SOAP 和 Protocol Buffers 集成。

服务器端：[https ://github.com/vlachenal/webservices-bench](https://github.com/vlachenal/webservices-bench)

客户端：[https ://github.com/vlachenal/webservices-bench-client](https://github.com/vlachenal/webservices-bench-client)

它还没有完成，已经在我的个人电脑上运行（我必须要求服务器来完成测试）......但结果可以参考：

*   笔记本电脑：[https ://github.com/vlachenal/webservices-bench/blob/master/results.md](https://github.com/vlachenal/webservices-bench/blob/master/results.md)
*   桌面：[https ://github.com/vlachenal/webservices-bench/blob/master/results-desktop.md](https://github.com/vlachenal/webservices-bench/blob/master/results-desktop.md)

作为结论：

*   Thrift 提供最佳性能且易于使用
*   具有 JSON 内容类型的 RESTful Web 服务非常接近 Thrift 的性能，是“可以使用的浏览器”并且非常优雅（从我的角度来看）
*   SOAP 的性能很差，但提供了最好的数据控制
*   Protocol Buffers 具有良好的性能......直到 3 个同时调用......我不知道为什么。它很难使用：我放弃（现在）让它与 MapStruct 一起工作，我不尝试与 Dozer 一起使用。

项目可以通过拉取请求（修复或其他结果）来完成。

# c++ - 在 Visual Studio 中定义宏 - /D 或 #define？

> ID：296657
> 
> 赞同：4
> 
> 时间：2008-11-17T19:51:26.283
> 
> 标签：c++, visual-studio

最近，在将一些 STL 代码移植到 VS2008 时，我想禁用`std::copy`通过定义新`_SCL_SECURE_NO_WARNINGS`标志生成的警告。您可以通过两种方式做到这一点：

*   使用**/D**编译器开关，可以在项目属性中指定。您需要确保它是为 Release 和 Debug 构建定义的，我经常忘记这样做。
*   通过在包含相关 STL 标头之前定义它的宏样式，或者，为了全面覆盖，在 stdafx.h 中：

    `#define _SCL_SECURE_NO_WARNINGS`

这两种方法都可以正常工作，但我想知道是否有任何论据支持一种优于另一种？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T19:58:44.583

/D 选项通常在您想在不同的构建上以不同方式定义它时使用（因此可以在 makefile 中更改它）

如果您“总是”希望它以相同的方式设置，请使用#define。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-17T19:59:56.077

通过将它们放在您的项目文件中，您可以在平台特定警告和平台之间保持密切关联，这对我来说似乎是正确的。

如果它们在代码中，它们总是在代码中，无论它是否适合平台。对于 GCC 或未来版本的 Visual C++，您不需要它。另一方面，通过将它包含在代码中，它就更明显地存在了。如果您移动（复制）代码，则更容易记住使用它移动该定义。

各方面的优点和缺点。YMMV。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T19:58:13.740

如果您有一个包含在所有其他标题中的标题（例如 stdafx.h），您应该把它放在那里。编译器命令行开关通常用于构建选项，并不总是设置，如 NDEBUG、UNICODE 等。虽然您的宏必须始终设置。

这听起来可能是武断的。事实上，有些人可能会说其他话。最后，你必须决定什么适合你的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T22:11:49.713

如果您确实将它们放入您的代码中，请记住正确地对它们进行 ifdef：

```
#ifdef _MSC_VER
#define _SCL_SECURE_NO_WARNINGS
#endif 
```

这将使您的代码保持可移植性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T23:39:11.940

一般来说，我更喜欢将#define 放在代码中，而不是在大多数情况下使用/D 编译器开关，因为查找#define 似乎比检查编译器设置更直观。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-28T21:10:41.420

/D 不是 msbuild.exe 的有效标志（至少是我使用的版本 v2.0.50727）。

这样做的方法是：

```
/p:DefineConstants="MY_MACRO1;MY_MACRO2" 
```

这样做的结果是：

```
Target CoreCompile:
    C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Csc.exe /define:MY_MACRO1;MY_MACRO2 ... 
```

# javascript - 什么是最好的轻量级 JSON/ajax 脚本？

> ID：296658
> 
> 赞同：5
> 
> 时间：2008-11-17T19:51:54.923
> 
> 标签：javascript, ajax, json

我正在创建一个 joomla 插件，并希望在页面加载后加载一组图像。为此，我目前正在使用 mootools.js 调用 myserver URL，获取 JSON 响应并将响应解析为表示每个图像 url 的 javascript 变量。它工作得很好，但是 mootools.js 的命名恰如其分，因为它在尺寸部门中是一个真正的笨蛋。

是否有一个轻量级脚本可以进行 ajax 调用并解析 JSON 对象？越小越好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T22:54:31.670

I just found a JSON parser, json2.js, at json.org that minifies down to about 3k. You basically do a standard HTTPRequest via AJAX and then pass the response text to the JSON parser to create the JSON object.

Thanks for all the answers and I did track them all down. I couldn't get any of them small enough to compete with this approach, though.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T20:03:28.020

除了 Mootools 之外，还有很多 JavaScript 框架可以完成您正在寻找的工作。我建议看一下 Jquery 或 Prototype。它们与 Mootools 非常相似，迷你版可能会提供您正在寻找的轻量级解决方案：

[http://jquery.com/](http://jquery.com/)

[http://www.prototypejs.org/](http://www.prototypejs.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T21:09:45.233

如果你想要它是轻量级的，我可以推荐 Net.js。

[http://xkr.us/code/javascript/Net/](http://xkr.us/code/javascript/Net/)

但是，它不支持解析 JSON，但这只是一行代码，获取 responseText 并调用`eval`它：

```
var json = eval('(' + xhr.responseText + ')'); 
```

**缺点：**

超时不可配置。但是，直接在源代码中很容易修改。

不支持具有通用完成处理程序的请求组。每个请求都是单独的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T20:15:04.207

两个建议：

1.  找到一个库，将您需要的功能分解为相对较小的组件。然后只下载您需要的组件。YUI 被很好地划分，但即使是那些文件也可能比需要的大一些。一个基于 YUI 的较小项目是 Fork。[在http://forkjavascript.org](http://forkjavascript.org/)找到这个库
2.  在其中一个开源库中找到您需要的功能，并将其重构为您自己的小得多的版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T20:34:55.600

我不知道您使用的是哪个特定版本的 MooTools，但如果您专门根据自己的需要对其进行定制，它不必很大。MooTools 提供了一个[高级下载页面](http://mootools.net/core)，允许您在单个文件中创建一个定制的、缩小的库版本。尝试一下，看看它是否适合您的需求。如果是这样，您将不必去学习原型/jquery/等。

**编辑：**我刚刚尝试下载带有所有依赖项的 MooTools 的 Request.JSON 包。使用 YUI 压缩选项后，文件大小为 33.8KB。

# javascript - 在引用原始函数时覆盖 JavaScript 函数

> ID：296667
> 
> 赞同：164
> 
> 时间：2008-11-17T19:53:13.017
> 
> 标签：javascript, overriding, user-defined-functions

我有一个函数，`a()`我想覆盖它，但还要`a()`根据上下文按顺序执行原始函数。例如，有时当我生成一个页面时，我会想像这样覆盖：

```
function a() {
    new_code();
    original_a();
} 
```

有时像这样：

```
function a() {
    original_a();
    other_new_code();
} 
```

我如何`original_a()`从覆盖范围内得到它`a()`？甚至可能吗？

请不要以这种方式提出替代方案，我知道很多。我是专门问这种方式的。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-11-17T20:01:58.303

你可以这样做：

```
var a = (function() {
    var original_a = a;

    if (condition) {
        return function() {
            new_code();
            original_a();
        }
    } else {
        return function() {
            original_a();
            other_new_code();
        }
    }
})(); 
```

`original_a`在匿名函数内部声明可以防止它弄乱全局命名空间，但它可以在内部函数中使用。

就像评论中提到的书呆子一样，一定要`()`在最后加上。您想调用外部函数并将*结果*（两​​个内部函数之一）存储在 中`a`，而不是将外部函数本身存储在`a`.

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-11-17T20:03:56.193

[代理模式](http://docs.jquery.com/Types#Proxy_Pattern)可能会帮助您：

```
(function() {
    // log all calls to setArray
    var proxied = jQuery.fn.setArray;
    jQuery.fn.setArray = function() {
        console.log( this, arguments );
        return proxied.apply( this, arguments );
    };
})(); 
```

> 上面将其代码包装在一个函数中以隐藏“代理”变量。它将 jQuery 的 setArray 方法保存在一个闭包中并覆盖它。然后代理记录对该方法的所有调用并将调用委托给原始方法。使用 apply(this, arguments) 可以保证调用者不会注意到原始方法和代理方法之间的区别。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-11-16T06:56:02.427

谢谢大家，代理模式真的很有帮助.....实际上我想调用一个全局函数 foo.. 在某些页面中我需要做一些检查。所以我做了以下。

```
//Saving the original func
var org_foo = window.foo;

//Assigning proxy fucnc
window.foo = function(args){
    //Performing checks
    if(checkCondition(args)){
        //Calling original funcs
        org_foo(args);
    }
}; 
```

Thnx 这真的帮助了我

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-01-31T05:33:55.617

您可以使用以下构造覆盖函数：

```
function override(f, g) {
    return function() {
        return g(f);
    };
} 
```

例如：

```
 a = override(a, function(original_a) {
      if (condition) { new_code(); original_a(); }
      else { original_a(); other_new_code(); }
 }); 
```

编辑：修正了一个错字。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-31T17:24:27.047

传递任意参数：

```
a = override(a, function(original_a) {
    if (condition) { new_code(); original_a.apply(this, arguments) ; }
    else { original_a.apply(this, arguments); other_new_code(); }
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-17T12:49:40.640

@Matthew Crumley 提供的答案是利用立即调用的函数表达式，将旧的“a”函数关闭到返回函数的执行上下文中。我认为这是最好的答案，但就个人而言，我更愿意将函数“a”作为参数传递给 IIFE。我觉得比较好理解。

```
 var a = (function(original_a) {
        if (condition) {
            return function() {
                new_code();
                original_a();
            }
        } else {
            return function() {
                original_a();
                other_new_code();
            }
        }
    })(a); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-19T02:00:24.980

上面的示例没有正确应用`this`或`arguments`正确传递给函数覆盖。下划线 _.wrap() 包装现有函数，正确应用`this`和传递`arguments`。见：[http ://underscorejs.org/#wrap](http://underscorejs.org/#wrap)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-22T17:34:17.830

我有一些由其他人编写的代码，并想在我在代码中找不到的函数中添加一行。因此，作为一种解决方法，我想覆盖它。

不过，没有一个解决方案对我有用。

以下是我的情况：

```
if (typeof originalFunction === "undefined") {
    originalFunction = targetFunction;
    targetFunction = function(x, y) {
        //Your code
        originalFunction(a, b);
        //Your Code
    };  
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-25T09:19:18.883

我为类似的场景创建了一个小助手，因为我经常需要覆盖多个库中的函数。这个助手接受一个“命名空间”（函数容器）、函数名和覆盖函数。它将用新函数替换引用命名空间中的原始函数。

新函数接受原始函数作为第一个参数，原始函数参数作为其余参数。它将每次都保留上下文。它也支持 void 和 non-void 函数。

```
function overrideFunction(namespace, baseFuncName, func) {
    var originalFn = namespace[baseFuncName];
    namespace[baseFuncName] = function () {
        return func.apply(this, [originalFn.bind(this)].concat(Array.prototype.slice.call(arguments, 0)));
    };
} 
```

以 Bootstrap 为例：

```
overrideFunction($.fn.popover.Constructor.prototype, 'leave', function(baseFn, obj) {
    // ... do stuff before base call
    baseFn(obj);
    // ... do stuff after base call
}); 
```

我没有创建任何性能测试。它可能会增加一些不必要的开销，这可能是也可能不是大问题，具体取决于场景。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-12T01:41:10.377

在我看来，最重要的答案是不可读/不可维护的，其他答案没有正确绑定上下文。这是一个使用 ES6 语法来解决这两个问题的可读解决方案。

```
const orginial = someObject.foo;
someObject.foo = function() {
  if (condition) orginial.bind(this)(...arguments);
}; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-30T06:17:05.617

所以我的答案最终成为一个解决方案，允许我使用指向原始对象的 _this 变量。我创建了一个“Square”的新实例，但是我讨厌“Square”生成它的大小的方式。我认为它应该符合我的特定需求。然而，为了做到这一点，我需要广场有一个更新的“GetSize”函数，该函数的内部调用广场中已经存在的其他函数，例如this.height、this.GetVolume()。但为了做到这一点，我需要在没有任何疯狂黑客的情况下做到这一点。所以这是我的解决方案。

其他一些对象初始化器或辅助函数。

```
this.viewer = new Autodesk.Viewing.Private.GuiViewer3D(
  this.viewerContainer)
var viewer = this.viewer;
viewer.updateToolbarButtons =  this.updateToolbarButtons(viewer); 
```

在另一个对象中起作用。

```
updateToolbarButtons = function(viewer) {
  var _viewer = viewer;
  return function(width, height){ 
blah blah black sheep I can refer to this.anything();
}
}; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-05T21:54:23.290

不确定它是否适用于所有情况，但在我们的例子中，我们试图覆盖`describe`Jest 中的函数，以便我们可以解析名称并在`describe`它满足某些条件时跳过整个块。

这对我们有用：

```
function describe( name, callback ) {
  if ( name.includes( "skip" ) )
    return this.describe.skip( name, callback );
  else
    return this.describe( name, callback );
} 
```

这里有两件事很关键：

1.  我们不使用箭头函数`() =>`。

    箭头函数更改对的引用`this`，我们需要将其作为文件的`this`.

2.  使用`this.describe`and`this.describe.skip`而不是`describe`and `describe.skip`。

同样，不确定它对任何人是否有价值，但我们最初试图摆脱[Matthew Crumley 的](https://stackoverflow.com/users/2214/matthew-crumley) [出色答案](https://stackoverflow.com/a/296706/293280)，但需要使我们的方法成为函数并接受参数以便在条件中解析它们。

# javascript - 一个合理的请求：IE 中指示加载进度的 iframe？

> ID：296674
> 
> 赞同：1
> 
> 时间：2008-11-17T19:55:29.177
> 
> 标签：javascript, internet-explorer, iframe, progress-bar, onload

让我对 IE 感到困扰的一件事是，当它使用 iframe 加载页面时，它会等到 iframe 完成加载后才会呈现页面。相比之下，Firefox 将在 iframe 加载时呈现所有其他页面元素，如果 iframe 需要很长时间才能加载，这非常好，因为它会向用户提供页面正在运行的一些反馈。它还允许您执行诸如在框架加载时显示“iframe 加载”消息并将其换出 iframe 加载的操作。

所以，我想知道是否有人找到了解决方法。理想情况下，我希望看到一个跨浏览器解决方案，在页面上加载 iframe 时显示进度条。除此之外，我会采用一种实现 iframe 的方法，该方法强制 IE 首先呈现页面然后加载 iframe。

我已经看到了几个有趣的 jquery 进度条，例如： http: [//plugins.jquery.com/project/jQueryProgressBar](http://plugins.jquery.com/project/jQueryProgressBar)

但是......（如果我在这里错了，请纠正我，因为我的理解是不稳定的）......在我看来，jquery 栏只在 DOM 加载后呈现。在 IE 中，直到加载 DOM 后才会显示 iframe 内容，因此此时显示进度条是无关紧要的。

我还尝试将 iframe src 设置为 loading.htm，然后 onload 将 src 切换到我想要的内容。遗憾的是，在最终内容页面出现之前，IE 仍然不会呈现页面（对我来说似乎很奇怪）。

帮助我stackoverflow，你是我唯一的希望。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T20:11:19.753

如果您要使用 XmlHttpRequest 加载页面，然后在加载时替换文档的内容，该怎么办？

```
<!-- jQuery example: -->

<div id='content'>Loading...</div>

<script type='text/javascript'>
$("#content").load(url);
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T20:23:44.033

您可以在父窗口加载后使用 JavaScript 设置 iframe 的位置。

```
<body onload="document.getElementById('myIframe').location='someurl';">
    <iframe id="myIframe">
</body> 
```

将是最基本的方法。

# parameters - 页面自动重新加载参数

> ID：296685
> 
> 赞同：2
> 
> 时间：2008-11-17T19:58:02.790
> 
> 标签：parameters, reload

我试图在每 20 秒后自动重新加载我的页面。我为此使用 JavaScript 而不是 <meta>。

我有 <body onload="SetTimer()"> 这是我的 JavaScript 函数

```
 function SetTimer(){
        setTimeout('window.location.replace(window.location.pathname)', 20000)
    } 
```

现在我的问题是，当第一次加载此页面时，我还在查询字符串中传递了一个参数。但是当页面再次重新加载时（`window.location.pathname`不包括参数），因此我无法根据传递的参数为页面上的标签分配值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-21T23:05:14.740

简单的页面重新加载也有一个技巧

```
function SetTimer(){ 
    setTimeout('window.location.reload(true)', 20000)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T20:09:02.020

window.location 将包含已传递的 GET 参数。

```
function SetTimer(){ 
    setTimeout('window.location.replace(window.location)', 20000)
} 
```

如果您通过 POST 提交参数，最好的方法可能是为每个参数创建一个带有隐藏输入的表单。每二十秒提交一次表格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T20:12:53.073

```
 setTimeout('window.location.replace(window.location.href)', 2000); 
```

成功了

# c# - 在自定义构建任务中运行 Project.Build() 时如何获取构建输出、错误列表？

> ID：296695
> 
> 赞同：1
> 
> 时间：2008-11-17T19:59:42.193
> 
> 标签：c#, visual-studio, msbuild, msbuild-task

**环境：**

C# 项目、Visual Studio 2008、C#、.Net 3.5、MSBuild

**客观的：**

为我的 C# 项目运行我自己的自定义构建任务，并基于平台（Soln 配置平台），在构建之前对 Project 对象本身进行一些操作。比如将 BuildAction 设置为 EmbeddedResource 等。

完成后，我打电话给`Project.Build()`. 我不想在 GlobalEngine 上使用 Project 对象，因为无论如何修改 Project 对象后，它都会将文件标记为脏文件（并从 TFS 签出）。

**问题：**

因为我使用的是我自己的引擎实例和项目，所以我无法将构建输出、错误定向到 VS。我只得到一个布尔值`Project.Build()`。我没有发现任何我可以连接的事件可以允许访问`BuildErrorEventArgs`和类似的东西。我知道我可以用来`Log.LogErrorEvent()`将消息记录到 VS 错误列表中。但我需要先获得构建输出本身才能做到这一点。

**代码：**

```
// Execute method in my custom build task class, derives from a BaseTask class
public override bool Execute()
{
Engine engine = new Engine();
Project project = new Project(engine);
project.Load(ProjectName);
Log.LogMessage(Microsoft.Build.Framework.MessageImportance.High, "Got the Project");
// Set the project's DefaultTargets to "Build" to be able to build with CSharp targets
project.DefaultTargets = "Build";
IsBuilt = project.Build(); // Isbuilt bool is a property in my BaseTask class
// Here's where I want to get Build output and direct it to VS output window and errorlist window

engine.Shutdown();
return base.Execute();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T22:33:30.960

我想通了，只需实现一个自定义记录器并在事件处理程序中使用 Log.LogMessage 或 LogError

```
public class MyCustomBuildLogger : ILogger
{
    private IEventSource source;

 public void Initialize(IEventSource eventSource)
        {
            this.source = eventSource;
            //Events.ProjectStarted += new ProjectStartedEventHandler(Events_ProjectStarted);
            //Events.ProjectFinished += new ProjectFinishedEventHandler(Events_ProjectFinished);
            Events.WarningRaised += new BuildWarningEventHandler(Events_WarningRaised);
            Events.ErrorRaised += new BuildErrorEventHandler(Events_ErrorRaised);
            Events.BuildFinished += new BuildFinishedEventHandler(Events_BuildFinished);
            //Events.BuildStarted += new BuildStartedEventHandler(Events_BuildStarted);
            Events.MessageRaised += new BuildMessageEventHandler(Events_MessageRaised);
            //Events.CustomEventRaised += new CustomBuildEventHandler(Events_CustomEventRaised);

            Events.MessageRaised += new BuildMessageEventHandler(Events_MessageRaised);
        }

 void Events_ErrorRaised(object sender, BuildErrorEventArgs e)
        {
            // This logs the error to VS Error List tool window
            Log.LogError(String.Empty, 

             String.Empty,
                    String.Empty, 
                    e.File, 
                    e.LineNumber, 
                    e.ColumnNumber,
                    e.LineNumber, 
                    e.ColumnNumber, 
                    e.Message);
           }
} 
```

在 MyCustomBuildTask 类中，您可以在其中设置和加载引擎和项目，

```
_logger = new MyCustomBuildLogger();
_logger.Log = Log;
_engine.RegisterLogger(_logger); 
```

# excel - 确保公共 VBA 方法不出现在 Excel 宏列表中

> ID：296696
> 
> 赞同：26
> 
> 时间：2008-11-17T19:59:55.860
> 
> 标签：excel, vba

在 Excel VBA (2003) 中，我注意到模块或*ThisWorkbook*中没有任何参数的任何**Public**或**Friend** **Sub方法都将显示为可由用户运行的宏。**即，当用户转到工具 --> 宏 --> 宏...（或 Alt+F8）时，该方法将显示在可以运行的列表中。

 *为了理智（组织、维护等），我确实需要将代码分成模块。我希望找到一种非 hacky 的方式来向用户隐藏一些方法，但仍然允许它们对其他代码模块可见。请注意，所有代码都包含在同一个*应用程序*中，因此不会调用外部代码。

我目前的解决方法是使用返回布尔值而不是**Sub的****Function** s，而忽略返回值。**eJames 建议在Sub**中使用可选参数的选项，这也将隐藏宏列表中的方法。

 ****然而，这些都不是很正确，所以任何关于如何构建一个重要的 Excel VBA 应用程序的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-11-17T20:41:09.927

将以下内容添加到模块顶部：

```
Option Private Module 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa266185(VS.60).aspx)：

> 当模块包含 Option Private Module 时，公共部分，例如在模块级别声明的变量、对象和用户定义的类型，在包含该模块的项目中仍然可用，但对其他应用程序或项目不可用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T20:21:14.757

一种解决方案是给方法一个`Optional`参数。

```
Public Sub myPublicSub(Optional dummy_var As Integer)
    ...
End Sub
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-12T12:26:06.053

只是 Jason Z 答案的一个小附录：如果您用来调用该方法，隐藏的方法`Option Private Module`仍然可见。`Application.Run()`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-19T17:26:41.943

另外值得注意的是**Option Private Module**和添加 Optional Params 的副作用是 Sub 将不再作为快捷键绑定的目标。

重述：如果您有一个键绑定来设置启动宏的键盘快捷键。该宏无法隐藏。否则键绑定将不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-10T20:57:22.100

我的方法已经列出了，但是 ChrisB 发表了以下声明：

> 作为一项规则，也许我们都应该在代码模块的顶部都有 Option Private Module —— 除非模块包含由按钮调用的过程

如果宏在将其设为私有之前已分配给按钮，则甚至可以从按钮调用私有例程。

# java - 持有具有起始时间的对象的类的好名字

> ID：296702
> 
> 赞同：2
> 
> 时间：2008-11-17T20:01:21.583
> 
> 标签：java, oop, naming-conventions, naming

我正在创建一个（Java）类来表示乐谱中具有特定开始时间的对象，并且可能还有持续时间。我需要为这门课起个好听的名字。像“Timed”或“TimedObject”这样的东西合适吗？我试图想出一些以“-able”结尾的东西（比如 Runnable），但我想不出什么好东西；“OnsetTimeable”听起来很傻，因为“OnsetTime”不是动词。我也不太喜欢“MusicalObject”，因为这并不意味着该对象有一个开始时间（“音乐对象”可以是与乐谱相关的任何东西）。

更新：从音乐上讲，这个类代表了乐谱中某个时间点发生的事情的抽象。这应该是 Note、KeyChange、MeterChange、DynamicMarking、TempoMark 等类的超类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T20:24:58.210

这听起来像是[MIDI 文件](http://jedi.ks.uiuc.edu/~johns/links/music/midifile.html)中的**事件**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T20:26:58.037

是类还是接口？接口应该由调用者的需求驱动。你能用 OnsetTimeable 做什么（现在叫它）？您提出以 -able 结尾的名称的倾向表明您将其视为一个接口。

如果您只是为音乐评分，而不是编写程序来播放乐谱，我猜乐谱中的大多数对象将更像是简单的数据结构或“值对象”，而不是具有操作的真实对象。这是因为在渲染对象时（比如在五线谱上），封装往往会被破坏。这是有道理的，因为对象的渲染或序列化点是捕获其所有状态。在这种情况下，使用具体的 POJO 可能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:06:07.470

您的对象应该向系统的其余部分提出的主要服务（或服务）是什么？

我相信它的名字应该代表你想通过首先设计它来实现的**[抽象。](https://stackoverflow.com/questions/216150#216218)**

到目前为止，我们知道您的对象是由什么组成的（开始时间，...），但我们不知道它是做什么的**，**更重要的是，正如[baash05](https://stackoverflow.com/questions/296702#296764)指出的那样，它***是***什么：总之，它代表什么。

正如问题中提到的[命名类的最佳方法是什么？](https://stackoverflow.com/questions/38019?sort=votes#sort-top)，[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)也可以是一个很好的方法。

如果它必须代表乐谱的任何特征（注意，...）的某种通用结构，那么像**ScoreAttribute**这样的名称可能是合适的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T20:10:21.923

它是什么，在*音乐*上？

是笔记吗？-> 好名字：“Note”，或“TimedNote”
是短语吗？-> 好名字：“MusicalPhrase”或“Phrase”
等。

不要将对象从其上下文中抽象出来（例如，将其命名为“Timed”）；选择一个名称，考虑对象的**真正**含义以及它在您的程序中的用途。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T20:20:24.180

时间呢？还是 TimedFigure、TemporalFigure ？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T20:20:50.793

我们不需要知道你的对象做了什么。然后我们需要知道“Cat”的类类型是什么......（我的做的很少，但我不愿意创建一个 SleepsAndPoops 类）
类名就是它“是”。
哪里需要动词？对话框、堆栈、字符串、笔……我在他们的名字中没有看到动词？

我会选择**MusicNote** ..
所有音符都有时间元素.. 真的。你听过没有时间元素的音符吗？

然后一个 MusicPhrase 可以有一个 MusicNotes 数组，一个 MusicSong 可以有一个短语数组。MusicAlbam 可以有一系列 MusicSongs。
我知道我知道一首歌从定义上讲是音乐剧，但名称有助于将它们保持在一起。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T20:21:44.100

分数项？音乐盛会？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T20:22:32.880

我同意其他人回答这个问题；我会概括。

考虑创建一个类，比如命名为“TimedAction”。这可以参数化以在指定时间执行某种操作；然后你只需告诉“TimedAction”它在那个时候会做什么。这允许您修改操作，并为您可能需要实施的其他操作提供灵活性。

这里的想法是你希望在给定的时间发生一些事情。与其把它想象成你想要发生的事情，不如把它想象成某件事的发生。因此，您创建了一个用于发生“TimedAction”的类并将其参数化。这与你为正在发生的事情创建一个类的第一直觉相反。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-17T20:38:14.050

听起来您可能正在描述一个[部分](http://en.wikipedia.org/wiki/Section_(music))，或者可能是一个[运动](http://en.wikipedia.org/wiki/Movement_(music))。

# unix - zcat 不能正确解压文件

> ID：296717
> 
> 赞同：42
> 
> 时间：2008-11-17T20:06:06.173
> 
> 标签：unix, command-line, archive, unzip, zcat

我需要在我的程序中即时解压缩压缩文件。当我在我自己的 linux 计算机上尝试它时它可以工作，但是由于某种原因，每当我告诉他们这样做时，学校计算机就会失败。要解压缩，我使用以下命令：

```
 zcat /file/address/file.tar.gz 
```

并得到错误：

```
 /file/address/file.tar.gz.Z: No such file or directory 
```

我尝试查看文档，但找不到关闭这种奇怪行为的标志。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-17T20:08:18.760

你学校的系统仍然有旧的“压缩”风格的实用程序，而不是新的基于 GNU “gzip”的实用程序。

假设它可用，您需要使用`gzcat`而不是。`zcat`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-22T21:52:08.410

当我想gzip时，我一般只是直接使用gzip：

```
gzip -dc /file/address/file.tar.gz 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T21:13:13.903

gzip --解压 /file/address/file.tar.gz

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-28T13:32:19.143

```
zcat archive.tgz | tar -x --wildcards apri/fls/filename 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T21:28:39.313

如果您将 .Z 广告到文件名的末尾，如下所示：

> zcat /文件/地址/file.tar.gz.Z

然后它会找到文件。

# oop - 我应该什么时候开始一个方法名称，它可以获取带有“get-”前缀的属性？

> ID：296719
> 
> 赞同：3
> 
> 时间：2008-11-17T20:06:51.307
> 
> 标签：oop, naming-conventions, accessor

对于返回对象的属性/属性/成员的命名方法，有什么好的经验法则？如果一个对象具有一些不可变的质量“blarg”，那么返回该质量的方法应该称为“blarg()”还是“getBlarg()”？例如，Java API 是不一致的：大多数属性都是通过“get”方法访问的（即使是那些没有相应的“set”方法的），但我们也有类似 Object.hashCode() 而不是 Object。获取哈希码（）。

更新：属性是否应该是一个字段（在实现中）是这里的决定者？那么在二维空间中表示不可变点的类呢？无论该点是存储为 (x,y) 还是 (r,theta)，我仍然需要所有四个属性的访问器。它们应该是 getX()、getY() 等，还是只是 x()、y() 等？从用户的角度来看，由于我们不希望我们的用户知道/关心我们的实现，这四个不应该有相同的命名约定吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T20:26:48.567

取决于语言。

在 Smalltalk 中，对于 getter 的约定是 blarg，对于 setter 是 blarg:。

在 Java 中，[JavaBeans](http://java.sun.com/javase/technologies/desktop/javabeans/index.jsp)约定是 getBlarg() 和 setBlarg()。加上布尔属性的 isBlarg()。

您提到了没有 getter 和 setter 的情况。这是有道理的，因为某些属性是只读的。

当您遵循约定时，您会获得其他人更容易阅读的代码。有时工具支持。例如，许多工具识别 JavaBeans 约定。

JavaBeans 约定直到 Java 1.1 才出现。所有 Object 方法（例如，hashCode()）都早于此。并且不能更改以实现向后兼容性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T20:12:21.513

我相信最常用的约定是：

```
GetBlarg() or getBlarg() 
```

可能会争辩说名称`GetHashCode()`不正确，因为该对象没有被调用的字段`hashcode`并且它是计算出来的。

当然，这些都是惯例，而不是规则，而且它们中的大多数已经发展了很长时间，因此并不是 100% 一致的。

问候
K

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T20:15:25.360

如果该方法除了访问属性之外什么都不做，那么请遵守`getProperty`约定。此规则的常见例外是，如果您正在访问布尔值，则约定是使用`isProperty`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T20:21:34.897

为了不同意这里的其他海报，我通常更喜欢仅使用名称（“blarg”）作为属性产生的直观 API。当您学习面向对象编程时，通常会教您这些内容-例如，在“汽车”类和“引擎”类的经典示例中，您会被告知汽车有引擎，并且看起来像：

```
car.engine 
```

这就是他们使用的，因为它比

```
car.getEngine 
```

大多数正常人会说，“什么是getEngine？”。汽车没有getEngine，它有一个引擎。以我的经验，这可能导致暂时混乱的情况远远超过普通人类可读性的整体改进。这只是我的观点，与一般的 Java 编程背道而驰，但老实说，这是我不喜欢 Java 编程的部分原因。;)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T20:43:59.810

对于具有本地属性概念（Java 没有）的语言，当访问器（get 或 set）没有副作用、相对性能（不是长时间运行）、返回相同的值时，您应该使用属性每次调用，或者不依赖于其他属性（上下文依赖）。如果其中任何一个为真，则应使用名为 GetXxx 或 SetXxxx 的方法，其中“Xxx”是其他情况下的属性名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-18T01:47:07.233

在 Objective-C 中，命名访问器方法有“严格”的约定，这将使类符合键值编码。

foo 的 setter 总是称为 setFoo：

```
[obj setFoo:newFoo]; 
```

getter 可以是以下三种选择之一：

```
[obj foo];
[obj getFoo:otherFoo];
[obj isFoo]; 
```

第一个是访问器返回属性或属性副本的实例。第二个是访问器接受一个参数，并将属性放入这个变量（通常是指针引用），第三个是属性 foo 是布尔类型的地方。

在 Objective-C 中使用它的优点是，您可以使用键路径访问属性，并且它将使用访问器 - 并且将搜索不同形式的访问器，直到找到一个。

```
temp = obj.foo; 
```

这将使用访问器，只要它遵循上面的命名方案。

* * *

在 python 中，我使用不同的方案。对于我将通过属性表示法访问的属性：

```
class Class:

    def get_x(self):
        return self._x

    def set_x(self,x):
        self._x = x

    x = property(get_x, set_x) 
```

在我想使用方法调用的情况下，我使用：

```
get_thing() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T20:16:00.647

如果它是布尔值，则约定是“isBlarg()”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T20:23:36.200

在我看来，IsFoo 约定很烂。您正在添加匈牙利符号。如果将其更改为使用 2 值逻辑中的 3 值逻辑的类，则需要重命名方法。保持你在编译器中的输入和命名。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T21:37:01.753

我反对省略 getter 的“get”或“is”前缀，因为仅使用字段名称可能会导致它被误解为实际执行实际操作的函数。

假设您有一个校对器类，并且您有一个名为 _checkSpelling 的 bool 字段，它指示是否检查拼写： checkSpelling()

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-17T20:34:42.887

我相信你应该坚持 getBlarg()（或 isBlarg()）约定，只要你意识到这不仅仅是为了获得财产。

将它们命名为 get...() 的原因是表示***访问***对象特征的过程，无论是简单属性还是计算属性。

所以，IMO，它应该是 getHashCode() ;)，但是出于向后兼容性的原因，正如 John 指出的那样，它将保持 hashCode()。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-20T17:04:49.273

约定通常是特定于语言的，最好的方法是遵循您使用的任何语言。Java 使用 getter 和 setter（或访问器和修改器），而在 C# 中，您可能正在为您的类创建属性。了解您的语言的各种约定，以便您可以与其他编码人员进行交流。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-20T17:19:51.517

总结一下：

**请注意，以下所有内容都是特定于语言的。它适用于 Java 和可能更多的语言，但并非适用于所有语言。第二：这只是一个约定。当您遵循约定时，您会获得其他人更容易阅读的代码。有时工具支持（例如，许多工具识别 JavaBeans 约定） 这仍然不意味着您不能选择坚持另一个约定。**

*   命名返回或设置对象具有的某个属性的方法的一个好的经验法则，例如“hashCode”如下：getHashCode() 用于获取它，setHashCode(...) 用于设置它。
*   对于 getHashCode() 而言，当对象在调用函数时没有备用 hashCode 而是立即计算它时，这也是正确的，因为对象通过此方法提供的服务在两种情况下都保持不变：它给你一个hashCode。
*   Java 方法名称在这方面不一致的事实可以通过以下事实来解释：在早期版本的 Java 中，尚未遵循此命名约定，并且出于向后兼容性的原因无法更改它们。
*   有些 getter 没有相应的 setter 是正常的，因为您可能不希望每个属性都被访问和更改。

# coldfusion - 何时应该在 ColdFusion 中使用范围锁定（应用程序、服务器等）与命名锁定？

> ID：296721
> 
> 赞同：11
> 
> 时间：2008-11-17T20:07:19.683
> 
> 标签：coldfusion, locking, shared-memory, coldfusion-8

什么时候适合使用 <cflock scope="application"> 或类似的，而不是 <cflock name="foo">？

具体来说，我有兴趣使用 CFLock 保护应用程序、会话或服务器范围内的共享对象，但我也有兴趣了解 ColdFusion 中锁定的不同用途。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T20:39:32.520

您应该在读取和写入应用程序范围内可能发生变化的内容时使用。例如：

```
<cfquery name="application.myData">
    select * from myTable
</cfquery> 
```

您将要使用 type="exclusive" 锁定它。无论在哪里使用 application.myData，您都需要一个 type="readonly" 锁。例外是 Application.cfc 的 OnApplicationStart 方法，它会锁定自身。同样，对会话和服务器范围使用相同的策略。

命名锁使您可以更好地控制锁定策略。当您需要动态锁定命令时，请使用命名的 cflock。例如：

```
<cflock name="write_file_#session.user_type#" type="exclusive">
    <cffile action="write" name="file_#session.user_type#" output="#content#" />
</cflock> 
```

在这个例子中，不同类型的用户可以同时写一个文件，但是相同*session.user_type*的用户必须互相等待。此 cflock 有助于避免文件争用问题。

使用命名锁的另一个原因是如果您不知道当前操作的范围。如果你在一个实例化的 cfc 中，你怎么知道你被实例化到了哪个作用域？变量？会议？应用？良好的封装告诉我们，除了被告知的内容之外，对象什么都不知道。在 CFC 中，使用命名锁并以 CFC 或 CFC 和唯一实例变量命名，具体取决于您的用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T21:16:26.487

继续@Mr。Nate 说，只要你担心竞争条件，就使用锁。例如，您可能希望锁定会话初始化，但不锁定后续读取。同样，您可能希望锁定对应用程序范围的写入，而不是读取。

自从 CF6 引入了线程安全的共享变量范围以来，锁定读取的用处要小得多。在糟糕的过去，如果你不小心，你可能会同时读写同一个内存地址。但是，由于 CF 由 Java 驱动，因此这不是问题。

正如他所展示的，命名锁对于锁定任何没有作用域的东西很有用，比如文件读/写。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T21:39:58.387

基于此处的其他建议。

老实说，自从 cf8 出现以来，现在 duplicate() 可以复制对象，我只会在写入应用程序、会话或服务器范围时使用范围锁（顺便说一句，写入服务器范围是我的一大禁忌）书）。

如果您需要读出数据，我会使用 duplicate() 将数据深度复制到局部变量并避免一起读锁。这将防止死锁。

```
<cflock scope="application" timeout="5" type="exlusive">
 <cfset application.data = {}>
 <cfset application.data.firstname = "tony">
</cflock>

<cfset variables.firstname = duplicate(application.data.firstname)> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-04T01:21:51.830

使用命名锁定的好时机是当你有一个“事务”你想确保一次完成，例如一次更新数据库中的几个表，或者你只是想确保两个用户是'不一次更新相同的数据库记录，或者在读取或写入服务器上可能有多个用户一次尝试访问它的文件时。

简单地说，任何时候如果两个请求试图同时做同样的事情就会出现问题，然后在它周围放置一个命名锁（或者如果它严格涉及会话、应用程序或服务器范围，那么使用范围锁）。

Ben Nadel 曾在一篇博文中写道：

> “在我看来，必须满足两个条件才能要求使用 CFLock：
> 
> 1.  正在访问或更新共享资源。
> 2.  必须存在导致负面结果的竞争条件的可能性。”

您甚至可以嵌套 CFLOCK 标记，例如在事务周围有一个命名锁，以及嵌套在其中的会话或应用程序范围的锁，但要小心这样做——如果你做错了，你可能会遇到没有请求的“死锁”情况可以执行页面的锁定部分，并且对页面锁定部分的所有请求可能会被阻止，直到超时。（ColdFusion 手册描述了嵌套锁定的最佳实践。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T20:19:12.543

通常，当您在 Application.cfc 之外读取或更改这些变量时，您应该始终将 cflock 用于会话、应用程序和服务器变量，以防止出现竞争条件。这是一篇可能会有所帮助的文章：

[http://www.horwith.com/index.cfm/2008/4/28/cflock-explained](http://www.horwith.com/index.cfm/2008/4/28/cflock-explained)

**编辑：**为了进一步回答您关于范围的问题，我总是`<cflock scope="application">`在与共享资源交互时使用（例如）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-17T13:29:17.120

这是 ColdFusion 8 文档中的一个示例，该示例使用页面变量创建“本地标志”，无需锁定即可读取该标志，以查看应用程序变量是否已初始化。

这确实解决了这样一个事实，即我们需要对排他锁进行条件化，因为每次加载页面时运行它可能会由于锁占用更多处理时间而产生瓶颈。

我不知道自此之后是否出现了更好的技术，但我想我还是会在这里发布。ColdFusion 文档通常不提供好的代码，所以我很想看看是否有人可以看到如何改进这个。

*   我可能会将*本地标志*放在请求范围内，以便即使在自定义标签等中也可以使用它。但是，它实际上只需要在 app.cfm 中，所以也许没有必要。
*   我还将删除 isDefined() 以支持 structKeyExists() ，这样它就不必循环遍历所有范围。
*   我还将使用括号表示法来设置变量，以便保留大写（例如 application['myDsn'] = "orders"）。它还可以更容易地发现变量写入，这比变量读取更重要。（这只是我的喜好）

来源：[http ://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=sharedVars_18.html](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=sharedVars_18.html)

```
<!--- Initialize local flag to false. --->
<cfset app_is_initialized = False>
<!--- Get a readonly lock --->
<cflock scope="application" type="readonly">
    <!--- read init flag and store it in local variable --->
    <cfset app_is_initialized = IsDefined("APPLICATION.initialized")>
</cflock>
<!--- Check the local flag --->
<cfif not app_is_initialized >
<!--- Not initialized yet, get exclusive lock to write scope --->
    <cflock scope="application" type="exclusive">
        <!--- Check nonlocal flag since multiple requests could get to the
                exclusive lock --->
        <cfif not IsDefined("APPLICATION.initialized") >
            <!--- Do initializations --->
            <cfset APPLICATION.varible1 = someValue >
             ... 
            <!--- Set the Application scope initialization flag --->
            <cfset APPLICATION.initialized = "yes">
        </cfif>
    </cflock>
</cfif> 
```

# c++ - 为 C++ 构建解决方案

> ID：296728
> 
> 赞同：5
> 
> 时间：2008-11-17T20:10:11.080
> 
> 标签：c++, build-process, build, build-automation

我想为在 Visual Studio 2005 中开发的非托管 C++ 代码设置构建服务器。构建服务器应该能够执行以下操作：

*   监控 Subversion 存储库的代码更改并安排构建
*   从 Subversion 签出代码并运行单元测试
*   提供有关构建成功和先前构建更改的某种报告

我最初一直在考虑将 CruiseControl 与 Ant 一起使用。有更好的解决方案吗？也许 CruiseControl.Net 和 NAnt？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T20:27:48.003

NAnt 需要做很多工作才能有效地构建 C++。它确实是一个彻头彻尾的 .NET 构建系统。我们正在为四个 C++ 平台和一组 .NET 工具构建我们的标题，并且需要一段时间才能使 NAnt 满足我们的需求。例如，NAnt 的 C++ 依赖分析非常糟糕，以至于我们不得不自己编写。它有很多性能问题，我们不得不去解决它来解决。

所以不要双脚跳进去。做一些初步测试，以确保它真的可以做你想做的事，并了解你需要为 C++ 修改多少。

此外，我们还将 CruiseControl.NET 用于我们已内置到驱动我们正在开发的游戏的工具之一中的一些 NUnit 东西。对此非常满意，设置起来非常容易。在这里竖起大拇指。

在之前的演出中，我在您描述的确切场景中使用了 Final Builder - 在构建服务器上。本地构建是使用 Visual Studio 完成的。这是一个非常棒的产品，如果你有一点钱可以花，我会认真考虑。我们从中得到了很好的结果。

在我现在的公司，我们选择了 NAnt，因为我们不想为团队中的每个工程师都购买 FB。我们也不喜欢 FB 是封闭源代码的。所以我们是 100% Nant 并且喜欢它。只是花了一些时间来塑造它！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:13:39.413

由于没有人提到，Jenkins 是一个很好的 CI，并且变得越来越普遍（免费也没有什么坏处）：

[http://jenkins-ci.org/](http://jenkins-ci.org/)

易于安装、使用和监控，并与很多东西（SVN、GIT 等）很好地集成。也非常可定制。需要 5 分钟才能启动并运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:12:08.690

我刚刚开始使用 Visual Build Professional，印象非常深刻，您可以从这里下载功能齐全的 30 天试用版：

[http://www.kinook.com/VBP/](http://www.kinook.com/VBP/)

SVN 也完全支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T20:24:21.567

我们使用 FinalBuilder 构建我们的 Visual Studio 2005 项目，包括使用 InstallShield 打包最终的 exe 和 dll 并将它们放在共享服务器上。

我们还远程登录（从 FinalBuilder）到许多其他平台（Unix/Linux/OpenVMS），并通过在那里运行 makefile 来启动远程构建。

我们不使用连续构建，但有一个 FinalBuilder Server 可以处理这个问题，并免费提供 FinalBuilder Professional 许可证。

我们对 FinalBuilder 非常满意，它很容易上手，而且功能强大，可以解决大多数问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T20:33:09.460

我们使用 CruiseControl.Net 和 NAnt（和 Subversion），我们对结果很满意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T20:46:24.893

除了 Ant CruiseControl 还支持[NAnt](http://cruisecontrol.sourceforge.net/main/configxml.html#nant)和[Exec](http://cruisecontrol.sourceforge.net/main/configxml.html#exec)。

但如果你真的想走前卫，你可以考虑[Rake](http://cruisecontrol.sourceforge.net/main/configxml.html#rake)（关于：[Rake](http://rake.rubyforge.org/)，[.Net 上的 Rake 入门](http://www.tobinharris.com/2008/11/4/getting-started-with-rake-on-net)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-28T14:43:43.283

Visual Studio 2005 项目完全可以从命令行运行！做就是了

```
devenv.com whatever.sln /build 'Release|Win32' /project whatever 
```

（替换`whatever`为您的项目名称以及`Release|Win32`您需要的配置和平台）。这可以由 CruiseControl 或 Jenkins 或其他任何东西轻松运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-25T11:09:00.493

在 Visual Studio 2010 中，微软最终将 Visual C++ 项目文件 (.vcproj) 的格式升级为基于 XML 的 NAnt 克隆格式 MSBuild，现在命名为 .vcxproj。这意味着 C++ 项目将使用该任务轻松编译。

如果您可以预见您只会拥有一个小团队和有限数量的构建，我会推荐使用 NAnt 的 TeamCity (http://www.jetbrains.com/teamcity/)。TeamCity 是一个基于 Java 的 CI 服务器（更容易在 Linux 构建服务器上部署），它支持单独的构建代理（因此您可以拥有多个 Windows 虚拟机或运行构建的专用机器）。

TeamCity 对基于 MSBuild、NAnt 和 Ant 的构建的支持非常出色，它有一个非常好的基于 AJAX 的 GUI，使用起来很有趣，并且允许您从浏览器设置和配置项目。但是，如果您越过免费版的 20 个项目门槛，它就会变得不合理地昂贵。

我可以推荐的另一个选项是 Jenkins 与 NAnt、Ant、MSBuild 或 Jenkins 可以支持的其他许多构建系统之一。Jenkins 是开源的，将处理无限的项目，例如 TeamCity，它可以在服务器上运行，同时将构建发送到单独的构建代理，并且它具有许多 C++ 工具的插件（想想静态分析、单元测试和打包）。

Jenkins 的 Web 界面不像 TeamCity 那样方便和美观，但它被广泛使用并且几乎所有东西都有插件。

# mysql - 在 phpMyAdmin 中消失的外键

> ID：296730
> 
> 赞同：6
> 
> 时间：2008-11-17T20:10:50.517
> 
> 标签：mysql, foreign-keys, phpmyadmin

我正在 mysql 中创建一个新表，并尝试向其中一个字段添加外键约束。

```
创建表`在线订单`（
  `receiptid` varchar(10) NOT NULL default '',
  `delivereddate` 日期默认为 NULL，
  `cid` int(10) 非空，
  `card#` int(10) 默认 NULL，
  `expire` 日期默认为 NULL，
  主键（`receiptid`），
  FOREIGN KEY (receiptid) REFERENCES 购买
) 引擎=MyISAM 默认字符集=latin1；

```

但是，在它创建之后，我进入 phpMyAdmin 并导出表。似乎外键约束已经消失了。

```
创建表`在线订单`（
  `receiptid` varchar(10) NOT NULL default '',
  `delivereddate` 日期默认为 NULL，
  `cid` int(10) 非空，
  `card#` int(10) 默认 NULL，
  `expire` 日期默认为 NULL，
  主键（`receiptid`）
) 引擎=MyISAM 默认字符集=latin1；

```

phpMyAdmin 是否摆脱了外键或者我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T20:18:15.043

您需要使用 InnoDB 引擎来拥有外键。

参考：[http ://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T23:10:24.320

当您使用 MyISAM 存储引擎定义表时，它会接受`FOREIGN KEY`约束，但会默默地丢弃它们。它会解析它们，但不会将约束存储在表元数据中，因此无法强制执行约束。当您要求查看数据库对表定义的想法时，它对该约束一无所知，正如您所发现的那样。

约束也会发生同样的事情`CHECK`（不管存储引擎如何）；它解析语法并接受它，然后忽略它。

恕我直言，这对于 MySQL 产品来说是一件可怕的事情。它接受标准 SQL 而没有错误，给您留下的印象是它将以标准方式支持约束。但事实并非如此！甚至没有`SHOW WARNINGS`表明 MySQL 忽略了约束。

如果您使用 InnoDB 存储引擎，它会注意外键约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-19T20:28:19.000

此外，PHPMyAdmin 删除提取任何约束，直到所有表都已创建并已插入数据。如果您使用 PHPMySql 为您转储表格，您会在文件末尾找到一个包含所有 ADD CONSTRAINT 条目的 UPDATE 表格部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-16T15:59:27.127

使用 phpmyadmin 管理表时有两种类型的约束：

*   内部：当您使用 phpmyadmin 设计器设置约束时，例如存储为内部的约束，将不会包含在导出中。
*   innoDB：导出中包含的这些限制查看有关它的链接视频

[视频：设置外键约束][1]

# c# - Fluent-NHibernate 是否支持映射到过程？

> ID：296732
> 
> 赞同：13
> 
> 时间：2008-11-17T20:11:39.313
> 
> 标签：c#, nhibernate, stored-procedures, fluent-nhibernate, enterprise-library

我一直想知道是否可以让 Fluent-NHibernate 与已经存在的存储过程进行通信，并将结果集的映射分配给我自己的域对象。

Fluent-NHibernate 也可以直接执行程序而不返回结果集吗？

基本上，我一直在考虑使用 Fluent-NHibernate 将过时的 TypedDataSet 模型替换为可以从 DAL 返回简单对象的域驱动设计的含义。如果 Fluent-NHibernate 不能轻松地与 SP 一起工作，我想我最有可能拥有一个组合 DAL，它可以利用 FNH 进行简单的 CRUD 操作，同时让复杂的过程由 Enterprise Library 管理。虽然我认为如果 FNH 不能很好地与 SP 配合使用，那么拥有 2 个竞争 DAL 并不是最佳选择，但我很想听听除了同时使用 EntLib 和 FNH 之外的任何其他想法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T14:32:46.123

只是为了回答我自己的问题，答案就是您可以为 NHibernate 编写 xml 映射并将它们与 Fluent-NHibernate 映射结合起来。FNH 的 SP 映射很可能会在以后添加。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-01T17:01:53.353

Fluent NHibernate 的主干版本（在 GitHub 上）支持插入、更新和删除存储过程。

在您的映射类构造函数中，调用：

```
SqlInsert("StoredProcName"); 
```

免责声明：我自己还没有测试过，但它肯定会很快派上用场。

有关更多信息，请参阅Fluent NHibernate Google Group 中的[此线程](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/44cd2963145f327)。

# web-applications - 在 iplanet 6 中，webapp 目录定义在哪里？

> ID：296735
> 
> 赞同：0
> 
> 时间：2008-11-17T20:12:41.590
> 
> 标签：web-applications, deployment

我正在尝试在现有的 iplanet 6 安装上部署我的第一个 war 文件，并且 config 目录中唯一指定 Web 应用程序目录的位置位于`server.xml`：

```
<PROPERTY name="docroot" value="/usr/local/ns-home/docs"/>
  <USERDB id="default"/>
  <SEARCH>
    <WEBAPP uri="/olc" path="/WWW/ns-home/docs/olc" enabled="true"/>
  </SEARCH>
... 
```

但是当我把我的战争文件放进去时`/WWW/ns-home/docs/olc`，什么也没有发生。

还有其他地方我应该寻找吗？

服务器安装目录下有一个“webapps”目录，但它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T12:55:26.040

在执行此操作之前，您需要通过 iplanet 管理控制台部署战争文件，备份服务器、xml 文件

然后campare备份文件server.xml文件和当前server.xml你就明白了

# oracle - 如何从备份文件（ora 文件）重新创建 oracle 9i 数据库

> ID：296736
> 
> 赞同：1
> 
> 时间：2008-11-17T20:12:45.273
> 
> 标签：oracle, backup, restore, controlfile

我是一名开发人员，所以我有点迷失在 DBA 世界中。我们的系统人员给了我一个 Oracle 9i 数据库的备份。我已经在我的电脑上安装了 oracle 9i，现在正在尝试“导入”备份文件，这样我就有了一个正常的数据库可以使用。

备份文件夹上有 SNCF[SID].ora 文件和大约 150 个 [SID]-[Date]-[counter]-[soemnumber].ora 文件。问题是，如何将这些数据输入 oracle，以便通过 sql 查询？

我已经创建了一个与备份数据库的 SID 匹配的数据库。谷歌告诉我，我需要进入 rman 并运行“数据库恢复”。但是它怎么知道回溯文件的位置呢？

有任何想法吗？谢谢。

* * *

我不知道。说真的，我们备份的 Oracle 数据是一个非常古老的应用程序的一部分，该应用程序正在逐步淘汰。没有人真正拥有数据库，而且我们手头上也没有 DBA……所以它落在了我这个唯一的开发人员身上。明天我可以尝试为您获取更多详细信息。

同时，原始数据库在 Windows 机器上运行并且是 9i 的某个版本。我在我的 Windows XP 机器上安装了 Oracle 9i (9.2.0.1.0)（我专门安装了这个旧版本，这样我就可以从备份的文件中重新创建数据库）。

备份是专门完成的，所以我可以尝试在我的电脑上重新创建它（所以我们不会弄乱生产）。我们每周只有一个几个小时的窗口，因此以不同的方式重做备份并不容易。

一位 DBA 朋友建议我们导出数据库而不是进行完整备份；但是，系统人员在导出时遇到了问题，所以现在我有了这个完整的备份。

就控制文件而言，似乎有一个 SNCF[SID].ORA 文件，大约 2.2 兆，这显然是控制文件。所有其他文件（略超过 150 个）大约是半个演出，也有 ORA 结尾。我猜这些是实际的数据文件。

我很快就会得到准确的 oracle 和 windows 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T00:02:55.760

好的，第一件事。备份取自哪个版本的 Oracle？9i 是一个营销标签——我们需要完整的 4 位版本号（即 9.2.0.4）。您的 PC 是否运行完全相同的 Oracle 版本？您的 PC 是否运行完全相同的操作系统？

备份是如何完成的？您是否正在查看数据库的一致冷备份？

您没有任何控制文件（通常是 .ctl）吗？

SNCF[SID].ORA 听起来像是参数文件，而不是控制文件。您需要一个控制文件才能恢复数据库。

如果数据库实际上已启动并在某个地方运行，我敢打赌，如果您努力找出使用导出实用程序不起作用的原因并解决该问题，那么您将经历比尝试更轻松的痛苦和痛苦从冷备份中恢复数据库，特别是在备份的方式存在任何混淆的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T15:13:54.797

.ora 文件？？？这通常是 pfile 的扩展名（在 9i 中，您更喜欢使用 spfile）。

不知道日期/编号的文件。也许他们是警报日志？或者他们是带有奇怪扩展名的 exp 转储。还是它们是 rman 备份的一部分？

你说“备份是专门完成的，所以我可以尝试在我的电脑上重新创建它”，那么为什么你没有具体的说明来恢复它呢？

抱歉，这里的问题多于答案。但我建议您从真正的 DBA 那里获得专家帮助。

你的系统家伙是一个不错的选择。向他们寻求帮助，他们制造了这个烂摊子。

# perl - 如何用 Perl 解析相对日期？

> ID：296738
> 
> 赞同：10
> 
> 时间：2008-11-17T20:13:05.083
> 
> 标签：perl, datetime, parsing, date

我很想知道是否有一个模块可以解析 Perl 中的“人工格式化”日期。我的意思是“明天”、“星期二”、“下周”、“1 小时前”。

我对 CPAN 的研究表明没有这样的模块，那么您将如何创建一个呢？NLP 在这方面遥遥领先。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-17T20:13:59.527

[Date::Manip](http://search.cpan.org/perldoc?Date::Manip)正是这样做的。

这是一个示例程序：

```
#!/usr/bin/perl

use strict;
use Date::Manip;

while (<DATA>)
{
  chomp;
  print UnixDate($_, "%Y-%m-%d %H:%M:%S"),  " ($_)\n";
}

__DATA__
today
yesterday
tomorrow
last Tuesday
next Tuesday
1 hour ago
next week 
```

这导致以下输出：

```
2008-11-17 15:21:04 (today)
2008-11-16 15:21:04 (yesterday)
2008-11-18 15:21:04 (tomorrow)
2008-11-11 00:00:00 (last Tuesday)
2008-11-18 00:00:00 (next Tuesday)
2008-11-17 14:21:04 (1 hour ago)
2008-11-24 00:00:00 (next week) 
```

UnixDate 是 提供的函数之一`Date::Manip`，第一个参数是模块支持的任何格式的日期/时间，第二个参数描述如何格式化日期/时间。还有其他函数只解析这些“人类”日期，而不对其进行格式化，用于增量计算等。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-17T21:54:48.310

您可能还会发现查看该`DateTime::Format`系列很有趣，特别是[DateTime::Format::Natural](http://search.cpan.org/dist/DateTime-Format-Natural/lib/DateTime/Format/Natural.pm)。一旦您将日期/时间解析为 DateTime 对象，您就可以以多种不同的方式对其进行操作和评估。

这是一个示例程序：

```
use strict;
use warnings;

use DateTime::Format::Natural;

my( $parser ) = DateTime::Format::Natural->new;

while ( <> ) {

    chomp;
    my( $dt ) = $parser->parse_datetime( $_ );

    if ( $parser->success ) {

        print join( ' ', $dt->ymd, $dt->hms ) . "\n";
    }
    else {

        print $parser->error . "\n";
    }
} 
```

输出：

```
tomorrow  
2008-11-18 21:48:49  
next Tuesday  
2008-11-25 21:48:53  
1 week from now  
2008-11-24 21:48:57  
1 hour ago  
2008-11-17 20:48:59 
```

TMTOWTDI :)

-史蒂夫

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T06:34:03.817

就个人而言，我一直为此使用[Time::ParseDate](http://search.cpan.org/perldoc?Time::ParseDate)。它几乎可以理解我尝试过的每一种格式。

绝对日期格式

```
 Dow, dd Mon yy
    Dow, dd Mon yyyy
    Dow, dd Mon
    dd Mon yy
    dd Mon yyyy
    Month day{st,nd,rd,th}, year
    Month day{st,nd,rd,th}
    Mon dd yyyy
    yyyy/mm/dd
    yyyy-mm-dd      (usually the best date specification syntax)
    yyyy/mm
    mm/dd/yy
    mm/dd/yyyy
    mm/yy
    yy/mm      (only if year > 12, or > 31 if UK)
    yy/mm/dd   (only if year > 12 and day < 32, or year > 31 if UK)
    dd/mm/yy   (only if UK, or an invalid mm/dd/yy or yy/mm/dd)
    dd/mm/yyyy (only if UK, or an invalid mm/dd/yyyy)
    dd/mm      (only if UK, or an invalid mm/dd) 
```

相对日期格式：

```
 count "days"
    count "weeks"
    count "months"
    count "years"
    Dow "after next"
    Dow "before last"
    Dow                     (requires PREFER_PAST or PREFER_FUTURE)
    "next" Dow
    "tomorrow"
    "today"
    "yesterday"
    "last" dow
    "last week"
    "now"
    "now" "+" count units
    "now" "-" count units
    "+" count units         
    "-" count units
    count units "ago" 
```

绝对时间格式：

```
 hh:mm:ss[.ddd] 
    hh:mm 
    hh:mm[AP]M
    hh[AP]M
    hhmmss[[AP]M] 
    "noon"
    "midnight" 
```

相对时间格式：

```
 count "minutes"         (count can be franctional "1.5" or "1 1/2")
    count "seconds"
    count "hours"
    "+" count units
    "+" count
    "-" count units
    "-" count
    count units "ago" 
```

时区格式：

```
 [+-]dddd
    GMT[+-]d+
    [+-]dddd (TZN)
    TZN 
```

特殊格式：

```
 [ d]d/Mon/yyyy:hh:mm:ss [[+-]dddd]
    yy/mm/dd.hh:mm 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-17T20:15:51.257

我假设你有上下文。NLP 在这里如何提供帮助？作为一个疯狂的猜测，您可以找到最接近的日期，即确切日期（与今天无关）并使用今天/明天/昨天与之相关。

# vb.net - 将处理程序添加到动态创建的上下文菜单

> ID：296740
> 
> 赞同：2
> 
> 时间：2008-11-17T20:14:29.510
> 
> 标签：vb.net, events, contextmenu

我需要在运行时从数据库中填充上下文菜单。我不知道列表中的项目数量，所以我想在一个地方处理点击事件。如何声明处理程序，以便知道哪个菜单项实际触发了点击。

```
Public Function GetBookmarkContextMenu(ByVal aBookmark As Bookmark) As System.Windows.Controls.ContextMenu

    Dim myContextMenu As New Controls.ContextMenu
    myContextMenu.Name = "BookmarkMenu" 

             For Each aMailingList As MasterService.FalconBookmarkMailingListType In GlobalUserSettings.MailingLists

                Dim mySubMenuItem As New Controls.MenuItem
                mySubMenuItem.Name = "MailingListName" & aMailingList.ID.ToString
                mySubMenuItem.Header = aMailingList.Title
                AddHandler (myMenuItem.Click), AddressOf ForwardToList_Click
                mySubMenuItem.IsEnabled = True
                myMenuItem.Items.Add(mySubMenuItem)
            Next
            myContextMenu.Items.Add(myMenuItem)

            return myContextMenu
End Function

Public Sub ForwardToList_Click()
    'How do I know which of the dynamically created items was clicked?
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-03T11:05:35.780

无法添加评论，所以我将其放在这里。AundyKarthick 的出色回复很容易说明我的结果是这样的：

在这种情况下首先在表单上创建一个上下文菜单条 ContextMenuStrip1

```
Private Sub Form1_Load(sender As Object, e As System.EventArgs) Handles Me.Load
  NamesTableAdapter.Fill(DataSet.Names)
  For Each element In DataSet.Names
     Dim mnuitem As New ToolStripMenuItem
     mnuitem.Name = element.Item(1)
     mnuitem.Text = element.Item(1)
     AddHandler (mnuitem.Click), AddressOf ToolMenuItem_Click
     ContextMenuStrip1.Items.Add(mnuitem)
  Next
End Sub

Private Sub ToolMenuItem_Click(sender As Object, ByVal e As EventArgs) 
    textbox1.Text = sender.name
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-25T06:53:11.793

```
Dim mnuitm As New ToolStripMenuItem
mnuitm.Name = name_cbk.Items(i)
mnuitm.Text = name_cbk.Items(i)
AddHandler (mnuitm.Click), AddressOf item_Click
menulist.Items.Add(mnuitm) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:19:06.647

您的 ForwardToList_Click() 应包含发送者和事件参数的参数：

```
Public Sub ForwardToList_Click(sender As Object, e As EventArgs)
'...
End Sub 
```

“发件人”是导致事件的控件，我相信您正在寻找它。

# java - Java EE 的长事务时间解决方案？

> ID：296741
> 
> 赞同：4
> 
> 时间：2008-11-17T20:14:33.270
> 
> 标签：java, web-services, multithreading, jakarta-ee, transactions

我在职业生涯中遇到过几次的问题是在分层服务架构中，如果单个下游系统进入其所有线程都被死锁或某种无限循环消耗的状态，它可能会导致整个客户端应用程序瘫痪该系统中的错误。在这些情况下，Java EE 服务器上的服务器套接字仍在接受来自客户端应用程序的请求并对其进行排队。这会导致客户端应用程序用尽所有等待来自正确建立的套接字连接的响应的线程。然后所有用户都被锁定在系统之外，因为他们的请求也在排队。

我已经想到了一些解决方案，但我想知道社区是否有更好的解决方案。

1.  下游请求的隔离线程池。这成为一个问题，因为您在系统中增加了空闲线程的数量，创建了许多需要足够线程来确保完全吞吐量的小池。产生线程意味着您需要自己处理事务和安全上下文。不是真正受支持的 Java EE 解决方案。

2.  MDB 解决方案，Java EE 的首选异步解决方案，然而，这似乎相当重量级，但具有让应用程序服务器处理管理 MDB 线程池的额外好处。（目前在我的名单上排名第一）

3.  ESB。这甚至更重，并增加了更多的网络和处理时间。但它允许您设置单独的服务超时。还有一个问题是在大公司中实施需要很长时间，所以在我的时间范围内可能不切实际。

大家有什么更好的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T20:46:07.200

您是正确的，因为 MDB 案例是正常的解决方案，它通常也支持超时，这将有助于避免挂起请求。话虽如此，它可能并不能真正解决问题，而只是将备份转移到您的 JMS 队列，而不会将响应发送回客户端。当然，如果几个服务中只有一个导致了这个问题，其他的现在仍然可以访问。

您的建议 (1) 也可以通过 commonj WorkManager 在 WebSphere 或 Weblogic 上实现。它将允许您在这些环境中创建托管线程并且非常轻量级。

[WorkManager 和 TimerManager API](http://e-docs.bea.com/wls/docs92/commonj/commonj.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T20:31:39.727

我们使用 MDB，其中队列持久保存在数据库中，这样的好处是，如果系统出现故障，消息不会丢失。

您可能还希望在参与方之间建立异步合同。我的意思是，客户端将向您发送一条消息，而不是您进行大量繁重的处理并返回响应，您只需发送一个确认响应，然后向他们发送一条带有完整结果的异步消息。

您还应该建立一个协议，如果客户端在规定的时间内没有收到完整的响应，则允许客户端重新发送消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T20:11:56.160

您可以尝试使用[Atomikos](http://www.atomikos.com) MessageDrivenContainers（消息驱动 POJO）的轻量级 MDB 方法。您的应用程序将更轻量级、更好的可测试性并且可能也更具可扩展性。

看[http://www.atomikos.com/Publications/J2eeWithoutApplicationServer](http://www.atomikos.com/Publications/J2eeWithoutApplicationServer)。

高温高压

盖伊

# css - IE7标签定位问题，div宽度问题

> ID：296744
> 
> 赞同：1
> 
> 时间：2008-11-17T20:15:36.840
> 
> 标签：css

我对`fieldset`（反馈表）内的标签有疑问。它在 Firefox、Opera、IE6 中正确显示，但在 IE7 中看起来很难[看](http://www.partnergrp.ru/consult.htm)。您还可以找到`pg.css`（主 ccs 文件）`ie6.css`、、、`ie.css`。

HTML 代码：

```
<fieldset>
    <legend>Вы можете отправить нам вопрос прямо с этой страницы, заполнив форму</legend>
    <form action="mail.php" method="post">
        <label for="name">Имя*</label> <input type="text" name="name"><br>
        <label for="tel">Телефон</label> <input type="text" name="tel"><br>
        <label for="email">E-mail*</label> <input type="text" name="email"><br>
        <label for="title">Тема вопроса</label> <input type="text" name="title"><br>
        <label for="mess">Вопрос*</label><textarea name="mess"></textarea><br>
        <label for="submit">&nbsp </label><input type="submit" value="Отправить" name="submit" class="button"><br>
        <label for="reset">&nbsp </label><input type="reset" value="Очистить" class="button"> 
    </form>
</fieldset> 
```

CSS 代码：

```
label {
    float:left;
    width:25%;
    text-align:right;
    margin-right:5px;
}

textarea {
    width: 400px;
    height:200px;
    font-size: 110%;
}

input, textarea {
    padding: 2px;
    margin: 5px;
    border:1px #7a974d solid;
    background: #f1ece8;
} 
```

第二个问题是 IE7 中的棕色线不是主 div 宽度的 100%。

```
#text, #text1 {
    border-top: 3px solid #4d320f;/*brown line*/
    float: left;
    margin: 0 1em 0 1em;
    padding: 7px 0 0 0;
} 
```

在我看来，div=text 的宽度`div=container`与带有徽标和菜单的上 div（div=maincontent）的宽度不同。的宽度`div=text`取决于最大的段落。在我的页面上， div=text 的宽度与页面底部的最后一段相同，因此棕色线的宽度相同：

```
<p class="bottom">&copy; Copyright <a href="http://www.pg.ru/contact.htm">«ПартнерГрупп»</a>.  Москва, ул. Давыдковская, д. 12, стр.7, <b>(495) 725-14-09</b></p> 
```

`width:100%`没有帮助。我不知道有什么问题。我不是css专家，我需要你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T20:36:32.463

查看您的代码后，问题似乎出现在您的 CSS 中。在 pg/pg.css 中有如下代码块：

```
#maincontent {
    float: left;
    margin: 0 0 10px 0;
} 
```

如果你取出浮动：left; 一切都将开始在 IE7 中正确排列。

# ruby-on-rails - “<%=h [ ...] %>”中的“h”是什么意思？

> ID：296747
> 
> 赞同：64
> 
> 时间：2008-11-17T20:15:55.123
> 
> 标签：ruby-on-rails, ruby, templates

当我生成默认脚手架时，show.html.erb 上的显示标签有

```
<%=h @broker.name %> 
```

`<%`我知道和之间的区别`<%=`。“h”是做什么的？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-11-17T20:16:45.623

html 转义。这是一种将 < 和 > 之类的内容转换为数字字符引用的方法，这样渲染就不会破坏您的 html。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-17T22:46:30.377

`<%=h`实际上发生了两件事。您正在打开一个 erb 标记 ( `<%=`) 并调用 Rails 方法`h`来转义所有符号。

这两个调用是等价的：

```
<%=h person.first_name %>
<%= h(person.first_name) %> 
```

该`h`方法通常用于从用户输入表单中转义 HTML 和 Javascript。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-19T19:48:14.807

`h`是`html_escape`来自[ERB::Util](http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB/Util.html)类的方法别名。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-29T16:07:38.323

`Rack::Utils.escape_html`如果您在 Metal 中并且想要转义某些 HTML ，Rack 中还有一种方法可以转义 HTML。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-02T23:19:33.703

派对迟到了，但我正在进一步解释`html_escape`正在做的事情，希望能帮助像我这样的其他菜鸟了解正在发生的事情。`html_escape`Rails 3 及更高版本现在自动转义所有输出，因此需要aka的情况要少得多`h()`。其中最值得注意的是当您打算`html_safe`在演示者类等中使用 html 构建链接时使用该方法。例如：

```
#some_view.html.erb
<span><%= @user.name %></span>  #This is 100% fine and will be automatically escaped by Rails 3+
#Output =>  <span>Brian Kunzig</span>

#Now say we want a link with html that we need preserved!  OMG WHAT ARE DO??
<%=link_to "<span><i class='fa fa-user'></i>#{@user.name}</span>".html_safe  #DANGER!!! 
```

上面的链接可能会导致严重的问题，并使您面临各种 xss（跨站点脚本）攻击。最简单的例子，如果用户保存了他们的名字，`"<script>alert('omg');</script>"`而你在上面使用`html_safe`了它，它会导致任何呈现他们假设的名字的页面都会收到一个警告说'omg'！这是一个重大问题。为避免这种情况，请执行以下操作：

```
<%=link_to "<span><i class='fa fa-user'></i>#{h(@user.name)}</span>".html_safe #Winning! 
```

通过逃避用户提供的可能被污染的数据，我们无家可归！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-22T13:36:13.623

h 只是 html_escape 的别名。它是一种常用的实用方法，用于从用户输入表单中转义 html 和 javascript。它将特殊字符转换为数字字符引用，以便渲染不会破坏您的 html。

例如有

```
<%= h "<p>Hello World</p>" %> 
```

将输出

```
<p>Hello World</p> 
```

作为要查看的文本，不会应用段落。它将被编码为

```
&lt;p&gt;Hello World&lt;/p&gt;. 
```

# .net - 将属性更改为方法 - 任何副作用？

> ID：296750
> 
> 赞同：2
> 
> 时间：2008-11-17T20:16:44.920
> 
> 标签：.net

我有一个具有一些属性的类。我想要一些可以根据这些属性计算分数的东西。因为这是一项微不足道的任务（一些添加和划分，但没有什么了不起的）。

所以很自然地，问题是：“什么时候在 getter 中使用带有一些代码的属性，什么时候使用函数？”，[这个问题已经得到了回答](https://stackoverflow.com/questions/67063/)。

现在，我想知道一件事：如果 - 出乎所有人的意料 - 我曾经需要让这个 Getter 变得如此复杂以至于它应该是一个函数（例如，因为我需要将数据放入或者因为它可以抛出异常或其他任何东西)，将属性更改为方法是否容易？

当然，看起来真的很琐碎，只是在改变

```
public double Score {
    get {
        return Math.Round(A + B / C * D,3);
    }
} 
```

到

```
public double Score(){
    return Math.Round(A + B / C * D,3);
} 
```

但我想知道：有没有副作用？当像这样改变东西时，有什么东西会坏吗？当涉及到反射时，我只能将其视为一个可能的问题，但是在我有 2 个程序集的情况下——一个定义类，一个使用类——并且只更改包含类的一个而不重新编译消费者部件。这是“几乎不可能跟踪的奇怪错误”的可能来源，还是将属性更改为方法完全安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T20:19:52.747

拉起反射器，你会看到你的属性已经是方法:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T20:24:21.410

不，这根本没有副作用。

> 拉起反射器，你会看到你的属性已经是方法了

在引擎盖下，属性中的`get`and`set`访问器只是简单地转换为`get_MyPropertyName()`and`set_MyPropertyName()`方法。这也是您可以（但通常不应该）向属性添加参数的原因。

唯一的“陷阱”是在 C# 中，您需要将“()”添加到任何现有调用中。

还

> 根据编码指南，属性名称通常是名词（即分数），但方法应该描述动作（动词），因此更合适的名称是 GetScore() 或 CalculateScore()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T20:32:50.443

如果您要从属性更改为方法并允许编译器向您显示添加括号的位置，您可能会遇到一些细微的错误，例如`object ting = thing.score` `ting`对于 score 的属性版本的盒装双精度，但是对于 score 的方法版本的委托不同的代码路径会导致：

```
public void erm(double param){ //stuff here}
public void erm(func<double> param) {// different stuff here} 
```

当你打电话时

```
erm(thing.score) 
```

使用属性与方法版本的分数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T20:39:15.780

一个副作用是破坏了对该属性的所有调用代码。您将向我们更新所有调用者的方法签名而不是属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T20:49:54.667

正如其他人已经指出的那样 - 没什么好担心的。我只是为了澄清一下，根据编码指南，属性名称通常是名词（即分数），但方法应该描述动作（动词），所以更合适的名称是 GetScore() 或 CalculateScore() :)

语法纳粹在行动:)

# wcf - WCF + NHibernate + ISession =？

> ID：296753
> 
> 赞同：6
> 
> 时间：2008-11-17T20:18:08.397
> 
> 标签：wcf, nhibernate

我是 WCF 和 NHibernate 的初学者。但是，我必须做一个涉及多个服务（使用 WCF 制作）和一个持久层（使用 NHibernate 制作）的小项目。

我的问题涉及 ISession 和 ISessionFactory 的使用。我已经阅读（并看到） ISessionFactory 的实例化非常繁重（并且是线程安全的）。所以，我认为我只能在应用程序运行时实例化这个类一次。我是正确的？

我的问题更多地涉及 ISession 类。我不完全知道我必须在哪个粒度上使用它。我认为我应该为每次调用服务操作使用/创建一个实例（我使用“每次调用服务”）。再说一遍，我是对的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T21:45:34.180

你很准。会话工厂的构建成本很高，非常适合作为单例，而会话是包装“工作单元”的更轻量级的上下文对象。

要了解更多信息，您可以阅读城堡 WCF 设施，该设施提出了该问题的解决方案。这是一篇探索它的[博客文章。](http://elegantcode.com/2008/07/14/integrating-castle-windsor-and-nhibernate-with-wcf-throwing-the-wcf-facility-and-some-rhino-tools-in-the-mix/)

# c# - 子范围和 CS0136

> ID：296755
> 
> 赞同：22
> 
> 时间：2008-11-17T20:18:18.490
> 
> 标签：c#, compiler-construction, scope

以下代码无法编译，说明“无法在此范围内声明名为 'st' 的局部变量，因为它会给 'st' 赋予不同的含义，后者已在 'child' 范围内用于表示其他内容”：

```
 var l = new List<string>();
        l.Find(st => st.EndsWith("12"));
        string st = "why this fails?"; 
```

我明白为什么这不起作用：

```
 string preParent = "";
        {
            string preParent = "Should fail cause we change the meaning";
        } 
```

当我们执行以下操作时，我们得到“CS0103：当前上下文中不存在名称‘postParent’”：

```
 {
            string postParent=string.Empty;
        }
        postParent = "Should this work?"; 
```

我不明白为什么编译器足够聪明，可以看到 postParent 不在范围内，但不会让我定义一个与子范围内使用的变量同名的新变量（这显然不在在这一点上的范围）。

编译器是否通过拒绝让我使用变量来简单地执行范围？如果是这样，这是有道理的。

===========

编辑：

我想我还觉得有趣的是如何在一个方法中在两个子范围内拥有相同的变量，所以这是有效的：

```
 {
            string thisWorks= string.Empty;
        }
        {
            string thisWorks= "Should this work?";
        } 
```

我只是有点好奇你可以有两个同名的变量，只要它们处于同一级别（如果你将范围视为一棵树）。这是有道理的，因为您可以在同一个类的两个同名方法中使用局部变量。

我很惊讶编译器能够区分并允许这样做，而它不允许 postParent 变量。这是技术限制还是设计决定？这就是我真正想要达到的目的；-)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-17T20:24:50.427

是的，编译器正在执行范围。请注意，变量的范围是它所属的词法块 - 不仅仅是从声明点开始，而是整个范围。

编译器抱怨，因为赋值`postParent`超出了它的范围（这只是嵌套的大括号）。如果您尝试在当前分配给`postParent`问题的位置声明一个新变量，则将使用嵌套块，因为 的范围`postParent`将包括该嵌套块，即使它在声明之前也是如此。

范围在 C# 3.0 规范的第 3.7 节中进行了描述。

编辑：回复您的问题编辑。

这只是两个简单的规则：

*   当另一个同名的局部变量在范围内时，您不能声明局部变量
*   局部变量的范围是声明发生的块

我确信该语言可以设计成范围仅在声明点开始，但我认为将范围视为块更简单（就语言复杂性而言） - 因此在同一块中声明的所有局部变量例如，具有相同的范围。在考虑捕获的变量时，这也使生活变得更加简单 - 因为捕获的内容取决于范围，而嵌套范围使生活变得有趣......

编辑：语言规范对原始 lambda 表达式示例有这样的说法 - 这是第 7.14.1 节：

> 匿名函数的可选匿名函数签名定义匿名函数的形式参数的名称和可选类型。匿名函数的参数范围是anonymous-function-body。与参数列表（如果给定）一起，匿名方法体构成了一个声明空间。因此，匿名函数的参数名称与范围包括匿名方法表达式或 lambda 表达式的局部变量、局部常量或参数的名称匹配是编译时错误。

这有帮助吗？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-11-17T20:28:13.133

您在有限范围内声明变量并尝试在该范围之外使用它。编译器假定您不想访问它，因此您可以在文件的其他位置声明一个具有相同名称的变量。您尝试执行假设变量将立即存在于范围之外的旧 C 技巧。例如，这曾经在旧版本的 C/C++ 中有效，但现在不再有效。

```
for (int i=0; i<10; i++)
{
    cout <<”In the loop i is “&lt;< i << endl;
}
cout << “outside of the loop i is “ << i << endl; //this only compiles with old C/C++ compilers. 
```

# c# - ThreadAbortException 调用 OdbcDataReader.ExecuteReader()

> ID：296781
> 
> 赞同：4
> 
> 时间：2008-11-17T20:24:52.127
> 
> 标签：c#, .net, odbc

我正在使用 OdbcDataReader 类和 ExecuteReader() 方法对大型机 DB2 数据库运行 SQL 查询。这段代码正在生产中，几个月来一直运行良好。

查询通常需要 1-2 分钟才能执行。上周五，查询遇到了 ThreadAbortException。下面是格式化的堆栈跟踪。跟踪中的 ApplicationException 是在我的 catch 块中创建的。

如果它很重要，则在客户端调用 Web 服务方法时运行查询。Web 服务托管在 Windows 服务中。Web 服务使用soap.tcp 协议托管在Windows 服务中。

任何想法为什么会发生 TreadAbortException？

> 2 个异常的堆栈跟踪。根本原因在顶部。
> 
> 异常 2：线程被中止。
> System.Threading.ThreadAbortException inside C:\WINDOWS\assembly\GAC_64\System.Data\2.0.0.0__b77a5c561934e089\System.Data.dll 在 System.Data.Common.UnsafeNativeMethods.SQLExecDirectW(OdbcStatementHandle StatementHandle, String StatementText, Int32 TextLength) 在System.Data.Odbc.OdbcStatementHandle.ExecuteDirect(String commandText) 在 System.Data.Odbc.OdbcCommand.ExecuteReaderObject(CommandBehavior 行为，String 方法，布尔需要Reader，Object[] methodArguments，SQL_API odbcApiMethod) 在 System.Data.Odbc.OdbcCommand。 MyCompany.MyDatabase.GetFolioList(String sqlWhereClause) 中 System.Data.Odbc.OdbcCommand.ExecuteReader(CommandBehavior 行为) 中的 ExecuteReaderObject(CommandBehavior 行为，String 方法，Boolean needReader)
> 
> 例外 1：无法检索 STAT_CD='V' 的作品集摘要列表。
> System.ApplicationException 在 D:\Production\DBGateway\bin\MyDatabase.dll 在 MyCompany.MyDatabase.GetFolioList(String sqlWhereClause) 在 MyCompany.MyDatabase.<>c__DisplayClass18.b__17() 在 MyCompany.WebUtilities.WebServiceBase.WebMethodTemplate[T]( String methodName, String exceptionFormat, WebMethodWorker `1 Worker, StringFormatter`1 FormatterMethod)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T21:32:44.870

这是我自己的问题的答案。

托管 Web 服务时，有一些进程监控 Web 服务调用所用的时间。如果一个调用花费的时间太长，那么它会被终止并且会发生 ThreadAbortException。超时时间可以增加。

对于在 ASP.NET 之外运行的 WSE3 Web 服务，例如托管为 soap.tcp（就像我的一样），配置属性是 executionTimeoutInSeconds：

```
<configuration>
  <microsoft.web.services3>
    <messaging>
      <executionTimeoutInSeconds value="360" />
    </messaging>
  </microsoft.web.services3>
</configuration> 
```

对于托管在 ASP.NET 中的 Web 服务，配置属性是 executionTimeout：

```
<configuration>
<system.web>
            <httpRuntime executionTimeout=”360” />
      </system.web>
</configuration 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T20:45:04.193

在乐观锁定导致的死锁情况下，您的线程可能被选为受害者，但在这种情况下，我希望负责层来处理它。

ThreadAbortExceptions 可能由许多原因引起，包括其他应用程序或 CLR 主机中止线程。您的代码是否由另一个应用程序托管？（开创性的例子是 Sql Server，尽管在您的情况下似乎不是这种情况。）

# c# - Resharper：vars

> ID：296783
> 
> 赞同：20
> 
> 时间：2008-11-17T20:26:22.577
> 
> 标签：c#, .net, resharper

为什么 Resharper 要您将代码中的大多数变量更改为 var 类型而不是实际类型？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-17T20:30:51.320

这只是一种选择。您可以禁用它：

ReSharper -> 选项 -> 代码检查 -> 检查严重性 -> 代码冗余 -> 尽可能使用“var”关键字：将其更改为“不显示”

还有上下文（灯泡）选项，它将带您进入各个方向 - 这是在 ReSharper -> 选项 -> 语言 -> C# -> 上下文操作 -> “用 'var' 替换显式类型声明”下

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-08-30T17:23:52.757

我看到了一个来自 Hadi Hariri 的视频，他在那里展示了 Resharper 6.x。他的理由是，如果你强迫用户使用“var”，你实际上是在强迫他以更有意义的方式命名变量，这样所有的名字都是可读的并且更有意义。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T20:33:38.630

默认情况下，它将“绿色曲线”这种类型的声明：

```
Person p = new Person();
^^^^^^ 
```

因为重复。

它还会在可以推断出时建议（小绿色下划线）var：

```
Person p = repository.GetPerson(1);
¯¯¯ 
```

在这种情况下，可以根据 GetPerson 方法的返回类型来推断它。

正如 Jon Skeet 所说，您可以在 resharper 的选项中禁用这些建议。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-17T20:33:16.760

回答您的问题……因为 JetBrains 的某个人认为这是“首选”方式。

要更改它，请按照乔恩的回答。此外，您还可以在 ReSharper 选项的代码清理部分下进行代码清理（我经常使用）时更改 ReSharper 的行为。设置为“使用显式类型”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-23T09:28:59.403

这是 JetBrains 代码检查 wiki 上关于它的解释： http: [//confluence.jetbrains.net/display/ReSharper/Use+%27var%27+keyword+when+initializer+explicitly+declares+type](http://confluence.jetbrains.net/display/ReSharper/Use+%27var%27+keyword+when+initializer+explicitly+declares+type)

如果你看到右边的类，那么也没有必要在左边看到它。如果类名很长，它也可以节省空间并减少代码。就我个人而言，我不会将 var 用于字符串、int 等简单类型，但会使用它`var dictionary = new Dictionary<string, int>()`来节省空间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T20:35:57.113

我认为它建议你两种方式。如果您有明确的类型 - 您可以将其更改为 var。如果您有 var - 可以将其更改为显式。只是为了让你更快地改变，如果你认为它当然是合适的。

使用 var 可能会很好，例如，用于循环变量、迭代集合时等等，当类型对您来说是“隐式”时（当然，当 Resharper 建议它时，它对于编译器来说总是隐式的）并且它不存在不会降低代码的可读性。另外，我喜欢它来缩短一些声明，这些声明可能会随着泛型而变得很长。就像，如果您在作业的左侧写“var”， IList(IDictionary(SomeType)) myVar = List(IDictionary(SomeType)) () 不会松动太多。

（用尖括号替换括号；）

当然，我会尝试谨慎使用 vars，以提高可读性，反之亦然。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-17T20:41:53.090

对我来说，这绝对物有所值……（即使我必须自己付钱）。但它可以减慢你的VS。如果你有 5000 行代码之类的文件，它会变得非常慢。

然而，我仍然不明白为什么我是团队中唯一使用它的人......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T20:33:12.017

Vars 有助于使方法内的代码更具可读性，尤其是在您使用泛型时。

正如乔恩所说，这只是一种选择。

# sql-server-2005 - SQL Server Mgt Studio 查询编辑器窗口选项卡不是描述性的

> ID：296789
> 
> 赞同：1
> 
> 时间：2008-11-17T20:27:58.190
> 
> 标签：sql-server-2005, configure, ssms

在 SQL Server Mgt Studio 2005 中，当我打开对象资源管理器以将对象脚本写入新的查询编辑器窗口时，该新脚本窗口的选项卡的标题类似于“MyServerName.MyDatabaseName - sqlquery37.sql”

不是很描述。所以当我同时打开一堆窗户时，我不知道哪个是哪个。

因此，“活动文件”下拉菜单没有用。

有没有办法配置 Mgt. Studio 以便查询编辑器窗口选项卡标题更准确地反映我正在处理的对象？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T21:21:41.653

如果没有将脚本窗口实际保存到文件中，则不会 [容易] - 然后你会得到

```
MyServerName.MyDatabaseName - MyFileName.sql 
```

作为标题。

您可能可以使用插件/附加组件来更改它，但不能不编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T00:37:26.017

SQL 团队已经意识到这一点（请参阅[此连接项](https://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=276832)），但没有确定何时解决该问题的截止日期。按照 Ken G 的建议保存文件是目前唯一的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-15T20:14:44.980

我最近创建了[这个建议](https://connect.microsoft.com/SQLServer/feedback/details/575463/sql-server-management-studio-ui-tabs-are-a-pain-to-use#)，其中我为选项卡提供了一个替代 UI：

[（图片）http://img190.imageshack.us/img190/7130/exampletabs2.png](http://img190.imageshack.us/img190/7130/exampletabs2.png)

如果有足够多的人支持它，也许他们会认真对待它！

# haskell - Haskell IO and closing files

> ID：296792
> 
> 赞同：40
> 
> 时间：2008-11-17T20:30:30.383
> 
> 标签：haskell, file-io, io

When I open a file for reading in Haskell, I've found that I can't use the contents of the file after closing it. For example, this program will print the contents of a file:

```
main = do inFile <- openFile "foo" ReadMode
          contents <- hGetContents inFile
          putStr contents
          hClose inFile 
```

I expected that interchanging the `putStr` line with the `hClose` line would have no effect, but this program prints nothing:

```
main = do inFile <- openFile "foo" ReadMode
          contents <- hGetContents inFile
          hClose inFile
          putStr contents 
```

Why does this happen? I'm guessing it has something to do with lazy evaluation, but I thought these expressions would get sequenced so there wouldn't be a problem. How would you implement a function like `readFile`?

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-18T02:00:22.963

As others have stated, it is because of lazy evaluation. The handle is half-closed after this operation, and will be closed automatically when all data is read. Both hGetContents and readFile are lazy in this way. In cases where you're having issues with handles being kept open, typically you just force the read. Here's the easy way:

```
import Control.Parallel.Strategies (rnf)
-- rnf means "reduce to normal form"
main = do inFile <- openFile "foo" 
          contents <- hGetContents inFile
          rnf contents `seq` hClose inFile -- force the whole file to be read, then close
          putStr contents 
```

These days, however, nobody is using strings for file I/O anymore. The new way is to use Data.ByteString (available on hackage), and Data.ByteString.Lazy when you *want* lazy reads.

```
import qualified Data.ByteString as Str

main = do contents <- Str.readFile "foo"
          -- readFile is strict, so the the entire string is read here
          Str.putStr contents 
```

ByteStrings are the way to go for big strings (like file contents). They are much faster and more memory efficient than String (= [Char]).

**Notes:**

I imported rnf from Control.Parallel.Strategies only for convenience. You could write something like it yourself pretty easily:

```
 forceList [] = ()
  forceList (x:xs) = forceList xs 
```

This just forces a traversal of the spine (not the values) of the list, which would have the effect of reading the whole file.

Lazy I/O is becoming considered evil by experts; I recommend using strict bytestrings for most of file I/O for the time being. There are a few solutions in the oven which attempt to bring back composable incremental reads, the most promising of which is called "Iteratee" by Oleg.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-19T01:16:34.753

[**Update**: Prelude.readFile causes problems as described below, but switching over to using Data.ByteString's versions of everything works: I no longer get the exception.]

Haskell newbie here, but currently I don't buy the claim that "readFile is strict, and closes the file when it's done":

```
go fname = do
   putStrLn "reading"
   body <- readFile fname
   let body' = "foo" ++ body ++ "bar"
   putStrLn body' -- comment this out to get a runtime exception.
   putStrLn "writing"
   writeFile fname body'
   return () 
```

That works as it stands on the file that I was testing with, but if you comment out the putStrLn then apparently the writeFile fails. (Interesting how lame Haskell exception messages are, lacking line numbers etc.?)

```
Test> go "Foo.hs"
reading
writing
Exception: Foo.hs: openFile: permission denied (Permission denied)
Test> 
```

?!?!?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T22:58:06.077

This is because hGetContents doesn't do anything yet: it's lazy I/O. Only when you use the result string the file is actually read (or the part of it that is needed). If you want to force it to be read, you can compute its length, and use the seq function to force the length to be evaluated. Lazy I/O can be cool, but it can also be confusing.

For more information, see [the part about lazy I/O](http://book.realworldhaskell.org/read/io.html#io.lazy) in Real World Haskell, for example.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T23:55:05.777

As previously noted, `hGetContents` is lazy. `readFile` is strict, and closes the file when it's done:

```
main = do contents <- readFile "foo"
          putStr contents 
```

yields the following in Hugs

```
> main
blahblahblah 
```

where `foo` is

```
blahblahblah 
```

Interestingly, `seq` will only guarantee that *some portion* of the input is read, not all of it:

```
main = do inFile <- openFile "foo" ReadMode
          contents <- hGetContents $! inFile
          contents `seq` hClose inFile
          putStr contents 
```

yields

```
> main
b 
```

A good resource is: [Making Haskell programs faster and smaller: hGetContents, hClose, readFile](http://users.aber.ac.uk/afc/stricthaskell.html#semiclosed)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-03T10:42:17.753

If you want to keep your IO lazy, but to do it safely so that errors such as this don't occur, use a package designed for this such as [safe-lazy-io](http://hackage.haskell.org/package/safe-lazy-io). (However, safe-lazy-io doesn't support bytestring I/O.)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T20:52:42.103

The explanation is rather long to be included here. Forgive me for dispensing a short tip only: you need to read about "semi-closed file handles" and "unsafePerformIO".

In short - this behaviour is a design compromise between a semantic clearness and lazy evaluation. You should either postpone hClose until you are absolutely sure you woudnt be doing anything with the file content (like, call it in error handler, or somesuch), or use something else besides hGetContents to get file contents non-lazily.

# svn - 如何在 SVN 中为单个文件的单个修订设置属性

> ID：296795
> 
> 赞同：4
> 
> 时间：2008-11-17T20:30:56.687
> 
> 标签：svn, version-control

我有一个 Subversion 存储库，并且有许多用户签入和签出。但是，我也需要经常为其他人检查工作。我需要追踪作品的原作者。

我正在考虑在 SVN 中创建一个属性，比如“originalauthor”，它可以跟踪这个。如果它是空的，我可以使用作者。如果它被填写，我可以适当地归因于更改。

*但是*，我看不到添加不会通过多次修订保留的属性的方法。同样，似乎没有一种方法可以使用提交挂钩来保证如果存在不包含它的提交，将删除“originalauthor”属性。

我总是可以重写服务器上的密码文件，以允许我在他们的用户名下提交，然后恢复原始密码文件，但这看起来很笨拙（并且不允许我跟踪它代表他们签入的事实）。或者我可以创建一个额外的用户（因此对于每个“用户 A”都有一个“用户 A 代理”），我可以使用它来检查更改。这些选项似乎都不吸引人。

有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-17T20:38:24.173

Subversion 有两种属性

*   文件或目录的属性。这些属性是版本化的
*   修订属性。这些特定于它们所应用的回归。

第一种类型仅在您希望标记文件的所有版本时才有用。

为了标记特定路径，Subversion 项目本身以特殊格式将原始作者添加到日志消息中，该格式由 contribulyzer 脚本读取：

```
Patch by: Jan Jansen <jan@example.com> 
```

但是如果你有可用的工具（并且可以假设 subversion 1.5+）你也可以使用

```
svn commit --with-revprop "original-author=Jan Jansen <jan@example.com>" 
```

创建原始作者修订属性。

要检索属性，您可以使用 svn log 作为：

```
svn log <...> --with-revprop original-author 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T20:34:16.773

为什么不为所有其他用户（需要代理）建立一个单独的分支，然后当您查看它们时（我假设您代表他们签入，因为他们不允许这样做）然后您提升到主干？

我不确定为什么不允许其他用户自行签入。也许如果您解释说我们可以提供更好的答案。

# unix - 需要在 UNIX 中使用 shell 脚本程序和 IF..THEN 命令进行故障排除

> ID：296797
> 
> 赞同：0
> 
> 时间：2008-11-17T20:31:13.050
> 
> 标签：unix, shell, sqlplus

由于你们有很多问题或没有足够的信息可以使用，以下是专有信息，因此请尽可能小心。问题 - （请参阅 if [$7 -eq "AAA"]...then 语句 - 粗体）的输出有问题，我只能输出/打印 'AAA' 的计数，无论变量是否进入“BBB”或“AAA”。结果，作为错误，程序输出/打印“AAA”的计数。

再次，在这种情况下，我尝试用我最好的知识向那些可用和精明的人解释。谢谢。

```
-----------------------------------------------------------------------
# Print the run date
echo "**********************"
echo " TALK Program "
echo " Run Date " 
     date
echo "**********************"

#            DIRECTORIES/VARIABLES/PARAMETERS

p1=$1
p2=$2
p3=$3
p4=$4
p5=$5
p6=$6
p7=$7
p8=$8

echo "***********************************************"
echo "The parameteres are"
echo "                                  "
echo "  Param 1 (Username/Password)   = "
echo "  Param 2 (User account number) = "$2
echo "  Param 3 (Requestor name)      = "$3
echo "  Param 4 (Requestor ID)        = "$4
echo "  Param 7 (AAA or BBB)          = "$7
echo "  Param 8 (TALK Data Filename)  = "$8
echo "***********************************************"

AREA1=$WILLS_TOP/bin                      # Switch-variable points to GENEX bin dir
AREA2=$WILLS_TOP/sql                      # Switch-variable points to GENEX sql dir

SQL_CTL=$AREA1/WILLSTALK.ctl              # Name of SQL*Load ctrl file                  
SQL_VALID=$AREA2/WILLSTALK.sql            # Name of validation PL/SQL script

FTP_BIN=/usr/local/bin                    # Where ftp program is
UNIX_GET=$FTP_BIN/ftpmget.sh              # Name of UNIX file get program
UNIX_PUT=$FTP_BIN/ftpmput.sh              # Name of UNIX file put program
UNIX_DEL=$FTP_BIN/ftpdel.sh               # Name of UNIX file delete program 

TEMP=/tmp                                 # Name of temp dir

INPUT_DIR=/oracle/inbound                 # For DVLP  Where input file is comming from
ARCHIVE_NT_DIR=/oracle/inbound/RFS_DVLP   # For DVLP  Modified on 2005

OUTPUT_DIR=/oracle/outbound/              # Where output file is going to
OUTPUT_UNIX_DIR=$OUTCSF/$$OUTLOG/         # Directory of where output is
DES_NAME=${OUTPUT_UNIX_DIR}${OUT_FILE}    # Where output is going to be

USERACCNUM=$p2                            # User Account Number
USERNAME=$p5                              # Username
PASSWORD=$p6                              # Password
AAA_OR_BBB=$p7                            # Either 'AAA' or default of 'BBB'
DATAFILE_NAME=$p8                         # Datafile name (NT)  
SERVER='172.........'                     # Server (NT)
LOG_DIR=$WILLS_TIP/log                    # Path of log dir
LOCAL_DIR=$WILLS_TIP/data                 # Directory where file is at (UNIX)
ARCHIVE_DIR=$WILLS_TIP/archive            # Directory for archive (UNIX)
FILE_NAME=""                              # File name (UNIX)
FILE_TRAN_TYPE='ascii'                    # File transfer type

#*****************************************************************************
#                               MAIN PROCEDURE
#*****************************************************************************
if [ ! "$p7" ]
then
     echo "At least one MS Excel Update Data File must be entered !"
     echo "No files were entered."
     exit 1
fi

#----------------------------------------------------------------------
#  Remove all MS Excel datafile in $GENEX_TOP/data directory if exist
#----------------------------------------------------------------------
rm -f $WILLS_TIP/data/TALK* 

#--------
#  FTP
#--------
${UNIX_GET} $p5 $p6 $SERVER $INPUT_DIR $DATAFILE_NAME $LOCAL_DIR "" $TEMP $FILE_TRAN_TYPE 

if [ $? != 0 ]
then
    echo "The MS Excel Datafile(s) ftp has failed."
    exit 1
fi

if [ ! -s $LOCAL_DIR/$p8 ]
then
    echo "FTP command executed, but MS Excel file(s) did not get copied."
    exit 2
fi

#-----------------------------------------
# SQL*Loads - New MS Excel file to load
#-----------------------------------------

for i in $LOCAL_DIR/$DATAFILE_NAME   
do
   SQLOAD_DAT_FILE=`echo $i | sed "s/\// /g" | awk ' { print $NF } '`

   SQLOAD_LOG_FILE=$SQLOAD_DAT_FILE.log         # Sqlload log file name
   SQLOAD_BAD_FILE=$SQLOAD_DAT_FILE.bad         # Sqlload bad file name

   if [ -s $LOG_DIR/$SQLOAD_BAD_FILE ]
   then
       rm -f $LOG_DIR/$SQLOAD_BAD_FILE  # Remove prev. bad file, if such exists
       echo "Previous bad file has been successfully removed."
   else
       echo "No bad file was identified and removed."
       echo "Resume Normal Processing."
   fi

   echo $i
   echo "Now loading datafile:  $LOCAL_DIR/$SQLOAD_DAT_FILE"

   #---------------------------------------------------------------
   sed "s/@USERACCNUM/$USERACCNUM/" $SQL_CTL > $TEMP/WILLSTAL.ctl  # Changing '@USERACCNUM' 
   #--------------------------------------------------------------- 

   sqlldr userid=${p1} control=$TEMP/WILLSTALK.ctl \
             log=$LOG_DIR/$SQLOAD_LOG_FILE \
             bad=$LOG_DIR/$SQLOAD_BAD_FILE \
            data=$LOCAL_DIR/$SQLOAD_DAT_FILE

   if test ! -s $LOG_DIR/$SQLOAD_BAD_FILE
   then
        tail -20 $LOG_DIR/$SQLOAD_LOG_FILE
        echo "*** Done SQL*Loader Script ***"
   else
        echo "The SQL*Load for MS Excel Update file has FAILED due to BAD DATA."
        echo "*** Exitting Script On Failure ***"
        echo "*** Process is ready for NEXT LOAD! ***" 
        exit 1
   fi
done

#----------------------------------------
#       To run a PL/SQL script
#----------------------------------------
sqlplus -s $p1 @$SQL_VALID $AAA_OR_BBB
if [ $? -ne 0 ]
then
    echo "The PL/SQL script for validation has FAILED."
    exit 1
fi

#---------------------------------------------------------- 
# Now run SQL*Plus script Flat File Report After Updating 
#----------------------------------------------------------

sqlplus -s $1 <<EOF

set echo off
set heading off
set space 0
set newpage 0
set pagesize 0
set feed off
set term on

SPOOL $OUTCSF/$OUTLOG/l$4.log

SELECT 'spool $OUTCSF/$APPLOUT/o$4.out' FROM dual;

SPOOL OFF

@$OUTCSF/$OUTLOG/l$4.log

Select 'Run Date: '||to_char(sysdate, 'DD-MON-YYYY') From dual;

Select '*************************************************************' From dual; 

SELECT 'ERRORS Found: '||count(*) 
  FROM gnx_rel_date_temp   
 WHERE error_text IS NOT NULL;

Select '--------------- ----------- ---------------------------------' From dual;
Select 'TRX NUMBER      NEW DATE                           ERROR TEXT' From dual;
Select '--------------- ----------- ---------------------------------' From dual;
SELECT trx_num||'|'||new_date||'|'||error_text
  FROM will_rel_date_temp   
 WHERE error_text IS NOT NULL;

Select '*************************************************************' From dual;

#-------------
#---- AAA ----
#-------------
if [ $7 -eq "AAA" ] then
   SELECT 'Total AAA Updated: '||count(*)||' records'         
     FROM reldatetemp             
         ,allcustomers     
    WHERE trx_num = trx_no       
      AND error_text IS NULL       
      AND attr2 IS NOT NULL          
      AND attr2 = TO_CHAR(new_date,'YYYY/MM/DD HH24:MI:SS');  
else
    exit 0
fi
#---------------
#---- BBB ----
#---------------
if [ $7 -eq "BBB" ] then
   SELECT 'Total BBB Updated: '||count(*)||' records'         
     FROM reldatetemp             
         ,allcustomers     
    WHERE trx_num = trx_no       
      AND error_text IS NULL       
      AND attr1 IS NOT NULL          
      AND attr1 = TO_CHAR(new_date,'YYYY/MM/DD HH24:MI:SS');  
else 
    exit 0
fi

SPOOL OFF
EOF

#----------------------------------------------
#   To delete the data files on NT
#----------------------------------------------
${UNIX_DEL} $p5 $p6 $SERVER $INPUT_DIR $DATAFILE_NAME $TEMP

mv $WILLS_TIP/data/$DATAFILE_NAME $WILLS_TIP/archive/. 

#  All Done!
echo "*** End of program *** " 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T21:00:45.783

“sqlplus -s $1 << EOF”和“EOF”之间的任何内容都称为“here-doc”，供sqlplus使用。你不能指望 sqlplus 以“if [”$7“-eq ....]”的形式理解 shell 脚本。

您应该在 here-doc 之外制作所有“ifs”并在其中使用结果。像这样：

```
if [ "$7" -eq "AAA" ] ; then
  attr="attr2"
elsif [ "$7" -eq "BBB" ] ; then
  attr="attr1"
else
  echo "Bogus $7 - need AAA or BBB"
fi

....

sqlplus -s $1 <<EOF
...
SELECT 'Total $7 Updated: '||count(*)||' records'         
 FROM reldatetemp             
     ,allcustomers     
WHERE trx_num = trx_no       
  AND error_text IS NULL       
  AND ${attr} IS NOT NULL          
  AND ${attr} = TO_CHAR(new_date,'YYYY/MM/DD HH24:MI:SS');
...
EOF 
```

注意“${attr}”并阅读关于 shell 脚本的不错的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T21:01:48.963

在此代码之后脚本如何可能继续：

```
#-------------
#---- AAA ----
#-------------
if [ $7 -eq "AAA" ] then
   SELECT 'Total AAA Updated: '||count(*)||' records'         
     FROM reldatetemp             
         ,allcustomers     
    WHERE trx_num = trx_no       
      AND error_text IS NULL       
      AND attr2 IS NOT NULL          
      AND attr2 = TO_CHAR(new_date,'YYYY/MM/DD HH24:MI:SS');  
else
    exit 0
fi 
```

如果 $7 = "AAA" 然后运行选择，如果 $7 不是 = "AAA" 退出脚本.....

问候
K

# php - 在 PHP 中获取文件名

> ID：296799
> 
> 赞同：2
> 
> 时间：2008-11-17T20:31:35.733
> 
> 标签：php

如何在 PHP 中获取文件名？我想要做的是让一个函数获取一个文件名字符串，然后如果它实际上在页面上，则执行一些操作。

```
function onThisPageFunction(fileNameFromFunction)  
{  
  if(onThisPage == fileNameFromFunction)  
  {  
    do stuff  
  }  
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T20:48:47.650

有两个变量将为您提供文件名。

例如：您调用 /test/test1.php 作为 url 并且 test1.php 包括 test2.php。

[`__FILE__`](http://pl.php.net/manual/en/language.constants.predefined.php)将为您提供执行代码的当前文件，在这种情况下，它将返回“test2.php”

[`$_SERVER['PHP_SELF']`](http://ca3.php.net/manual/en/reserved.variables.server.php)将为您提供原始调用的完整 url，在本例中为“/test/test1.php”

请注意，您可以使用[basename()](http://ca.php.net/basename)函数仅从路径中获取文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T20:34:19.033

如果我理解正确你想要`__FILE__`。

参考： http: [//php.net/manual/en/language.constants.predefined.php](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T20:50:04.620

我想你想使用：

```
_SERVER["PHP_SELF"] 
```

例如：

```
 if (isset($_SERVER["PHP_SELF"]) AND  ($_SERVER["PHP_SELF"] == 'foo')){
echo 'do stuff';
} 
```

将要

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T20:59:02.200

```
if (realpath($_SERVER['SCRIPT_NAME']) === __FILE__) {
    echo "Called directly";
} 
```

也可以在命令行上工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T20:03:03.763

感谢您的回复。这就是最终为我完成这项工作的原因。

```
function menuStrikethrough($pageName)
    {
        // get the name of the page we're on
        $fileName = basename($_SERVER['PHP_SELF']);

        // if fileName equals pageName then output css to show a strikethrough
        if($fileName == $pageName)
        {
            echo ' style="text-decoration:line-through" ';
        }
    } 
```

我发现`____FILE____`对我不起作用，因为我在包含的文件中编写了这个函数。

基本名称提示派上用场了。

感谢所有的帮助！

# sql-server - 巨大的交易日志——这正常吗？

> ID：296830
> 
> 赞同：4
> 
> 时间：2008-11-17T20:38:38.637
> 
> 标签：sql-server

我有一个 5GB 的数据库和一个 20GB 的事务日志（SQL Server 2005）。不知道为什么它这么大或发生了什么让它这么大，它曾经是数据库大小的 1/2 左右。DB 每月增长约 1GB。

对于事务日志相对于数据库文件大小的大小，是否有任何指导方针？

编辑：我并不是说我的事务日志很大（我知道一些 DBA 会嘲笑我的小数据库），只是与我认为它很大的数据库文件有关。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T20:49:22.017

呃......请原谅明显的流血，但是您是否使用“BACKUP LOG”安排了备份

如果恢复模型是 FULL ，那么这需要发生。

我将包括其他一些罕见的选项（并非详尽无遗）：

*   大表索引重建/维护。但是，备份日志会清除这一点。
*   阻止备份日志删除条目的开放事务（因此它会增长）
*   与[SET IMPLICIT_TRANSACTIONS ON](http://msdn.microsoft.com/en-us/library/ms190230(SQL.90).aspx)的连接（请参阅上一点）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-07T17:45:32.473

除了检查数据库上使用的恢复模型之外，您还可以进一步了解“**发生了什么使它变大**” - 您可以阅读它并查看日志中保存的事务类型和数量. 此外，您可以检查交易发生的时间以及执行者

为此，您可以使用本机 SQL Server 函数**fn_dblog**、**DBCC PAGE**或**fn_dump_dblog**或某些第 3 方工具。但是，本机函数没有记录，很难理解它们提供的结果。至于第 3 方工具，您可以查看**[Open LDF 文件并查看 LDF 文件内容](http://solutioncenter.apexsql.com/open-ldf-file-and-view-ldf-file-content/)**在线文章以获取更多详细信息和更深入地分析读取事务日志信息所需的内容

*免责声明：我在 ApexSQL 担任产品支持工程师*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T20:47:23.330

如果你有很多交易行为，这并不罕见。但是，您可能应该研究使其更小的方法。对此有很多选择，但在不知道您的恢复模式的情况下，我永远无法提出建议。从这个[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms189493.aspx)、这个[知识库文章](http://support.microsoft.com/kb/907511)开始，然后从那里开始。小心。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T21:08:05.627

关于“这是否正常”，请记住事务会永远累积在日志中，直到您正确设置备份和检查点。例如，如果你不这样做，数据库中的每条记录都至少有一个插入事务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T20:47:57.243

如果您有执行大量事务的代码（相对于数据库的实际大小），它肯定会使日志膨胀。

如果您现在还没有，我绝对建议您制定一个数据库维护计划来进行夜间备份（也许更频繁的事务日志备份）。通常，备份过程会在备份完成后将日志大小恢复到合理的值。

就一般准则而言，我尝试将其保持在数据库大小的 50% 以下，尽管使用备份计划，我通常不会看到我们的日志甚至接近这个值。

如果您不关心保留交易记录，这种类型的查询会缩小它，但我会先阅读 Shrinkfile。

```
Backup Log DatabaseName With Truncate_Only
GO

Declare @LogFileLogicalName sysname
select @LogFileLogicalName=RTRIM(Name) from sysfiles where filename like '%.ldf%'
--SELECT @LogFileLogicalName
DBCC Shrinkfile(@LogFileLogicalName,2) 
```

# c# - Fluent NHibernate - 如何一对一映射子类？

> ID：296834
> 
> 赞同：7
> 
> 时间：2008-11-17T20:39:48.663
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping

假设我有三个班级。实例化 A 是有效的，但也有特殊情况 B 和 D 是 A 的子类，增加了额外的信息。

我将如何在（流利的）NHibernate 中为此映射文件？

```
public class A
{
    public int ID { get; set;}
    public string CommonProperty1 { get; set; }
    public string CommonProperty2 { get; set; }
}

public class B : A
{
    public string BSpecificProperty1 { get; set; } //not null
    public string BSpecificProperty2 { get; set; } //not null
}

public class D : A
{
    public string DSpecificProperty { get; set; } //not null
} 
```

我尝试了以下方法，但它根本不起作用：

```
public class AMap : ClassMap<A>
{
    public AMap()
    {
        Id(x => x.ID);

        Map(x => x.CommonProperty1);
        Map(x => x.CommonProperty2);
    }
}

public class BMap : ClassMap<B>
{
    public BMap()
    {
        References(x => x.ID);
        Map(x => x.BSpecificProperty1)
            .CanNotBeNull();
        Map(x => x.BSpecificProperty2)
            .CanNotBeNull();
    }
}

public class DMap : ClassMap<D>
{
    public DMap()
    {
        References(x => x.ID);

        Map(x => x.DSpecificProperty)
            .CanNotBeNull();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T10:08:03.650

我不确定我是否理解“一对一映射子类”的意思，但是如果您想在子类具有不可为空的属性的情况下映射继承，您可以在 Fluent-NHibernate 中这样做：

```
// Domain classes
public class Animal
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
}

public class Cat : Animal
{
    public virtual int WhiskerLength { get; set; }
    public virtual int ClawCount { get; set; }
}

public class Dog : Animal
{
    public virtual int TailWagRate { get; set; }
}

// Mapping file
public class AnimalMap : ClassMap<Animal>
{
    public AnimalMap()
    {
        Id(x => x.Id)
            .WithUnsavedValue(0)
            .GeneratedBy.Native();

        Map(x => x.Name);

        var catMap = JoinedSubClass<Cat>("CatId", sm => sm.Map(x => x.Id));

        catMap.Map(x => x.WhiskerLength)
            .CanNotBeNull();
        catMap.Map(x => x.ClawCount)
            .CanNotBeNull();

        JoinedSubClass<Dog>("DogId", sm => sm.Map(x => x.Id))
            .Map(x => x.TailWagRate)
                .CanNotBeNull();
    }
} 
```

由于您希望子类的属性不为空，因此您必须使用 table-per-class (joined-subclass) 方式对继承进行建模。这是因为每个层次结构的表要求所有子类属性都可以为空。

我希望它有所帮助。

/埃里克

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-23T12:39:17.217

自 Erik 的帖子以来，FNH 中的语法可能已经改变，但他的示例是正确的。这是我根据 Erik 的帖子使用的一些代码，用于处理我现在知道的两个 FNH 子类策略（SubClass（下面的注释掉的代码和 JoinedSubClass）。顺便说一句，我见过其他名称用于描述相同的策略，包括在 NHibernate 文档中，当这对您来说是新的时，这有点令人困惑。（[https://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html](https://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html)）。

```
// Domain classes
public class Animal : Entity
{
    public virtual string Name { get; set; }
    public virtual string Unwanted { get; set; }
}

public class Cat : Animal
{
    public virtual int WhiskerLength { get; set; }
    public virtual int ClawCount { get; set; }
}

public class Dog : Animal
{
    public virtual int TailWagRate { get; set; }
}

public class Boxer : Dog
{
    public string DroolBucket { get; set; }
}

public class AnimalMapJoinedSubclassOverride : IAutoMappingOverride<Animal>
{
    public void Override(AutoMap<Animal> mapping) {
        mapping.Map(x => x.Name);

        mapping.IgnoreProperty(x => x.Unwanted);

        mapping.JoinedSubClass("CatId", CatMap.AsJoinedSubClass());
        mapping.JoinedSubClass("DogId", DogMap.AsJoinedSubClass());
        //mapping.DiscriminateSubClassesOnColumn("Type")
        //    .SubClass<Cat>("CatId", CatMap.AsSubClass())
        //    .SubClass<Dog>("CatId", DogMap.AsSubClass());
    }
}

public class CatMap
{
    public static Action<JoinedSubClassPart<Cat>> AsJoinedSubClass()
    {
        return part =>
        {
            part.Map(x => x.ClawCount).Not.Nullable();
            part.Map(x => x.WhiskerLength).Not.Nullable();
        };
    }

    public static Action<SubClassPart<Cat>> AsSubClass()
    {
        return part =>
        {
            part.Map(x => x.ClawCount);
            part.Map(x => x.WhiskerLength);
        };
    }
}

public class DogMap
{
    public static Action<JoinedSubClassPart<Dog>> AsJoinedSubClass()
    {
        return sub =>
        {
            sub.Map(x => x.TailWagRate).Not.Nullable();
        };
    }

    public static Action<SubClassPart<Dog>> AsSubClass()
    {
        return sub =>
        {
            sub.Map(x => x.TailWagRate);
        };
    }
}

public class BoxerMap
{
    public static Action<JoinedSubClassPart<Boxer>> AsJoinedSubClass()
    {
        return sub =>
        {
            sub.Map(x => x.DroolBucket);
        };
    }

    public static Action<SubClassPart<Boxer>> AsSubClass()
    {
        return sub =>
        {
            sub.Map(x => x.DroolBucket);
        };
    }
} 
```

# c# - 将天数转换为人类可读的持续时间文本

> ID：296842
> 
> 赞同：3
> 
> 时间：2008-11-17T20:43:27.690
> 
> 标签：c#, f#

给定天数，例如 25 天，将其转换为持续时间文本，例如“3 周，4 天”

如果 F# 变体提供对 C# 的任何改进，C# 和 F# 解决方案都会很棒。

编辑：解决方案应该在过去几周内扩展到包括几个月和几年。包括世纪等在内的奖励积分。如果它在某种程度上是可配置的，则额外奖励，这意味着您可以告诉该方法排除周的标准化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T20:45:38.560

```
String.Format("{0} Weeks, {1} days", days / 7, days % 7); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T17:08:00.527

这是一个递归解决方案。请注意，持续时间只有在给定日历上的特定时间点测量才真正有意义，因为月份和年份的长度会有所不同。但这是一个假设固定长度的简单解决方案：

```
let divmod n m = n / m, n % m    

let units = [
    ("Centuries", TimeSpan.TicksPerDay * 365L * 100L );
    ("Years", TimeSpan.TicksPerDay * 365L);
    ("Weeks", TimeSpan.TicksPerDay * 7L);
    ("Days", TimeSpan.TicksPerDay)
]

let duration days =
    let rec duration' ticks units acc =
        match units with
        | [] -> acc
        | (u::us) ->
            let (wholeUnits, ticksRemaining) = divmod ticks (snd u)
            duration' ticksRemaining us (((fst u), wholeUnits) :: acc)
    duration' (TimeSpan.FromDays(float days).Ticks) units [] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T21:46:36.253

```
 public class UnitOfMeasure {
        public UnitOfMeasure(string name, int value) {
            Name = name;
            Value = value;
        }

        public string Name { get; set; }
        public int Value { get; set; }

        public static UnitOfMeasure[] All = new UnitOfMeasure[] {
            new UnitOfMeasure("Year", 356),
            new UnitOfMeasure("Month", 30),
            new UnitOfMeasure("Week", 7),
            new UnitOfMeasure("Day", 1)
        };

        public static string ConvertToDuration(int days) {
            List<string> results = new List<string>();

            for (int i = 0; i < All.Length; i++) {
                int count = days / All[i].Value;

                if (count >= 1) {
                    results.Add((count + " " + All[i].Name) + (count == 1 ? string.Empty : "s"));
                    days -= count * All[i].Value;
                }
            }

            return string.Join(", ", results.ToArray());
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T03:48:03.293

这是基于先前发布的 C# 版本的 F# 版本。主要区别在于它是应用性的而不是命令性的（没有可变变量）。

```
#light
let conversions = [|
    365, "Year", "Years"
    30, "Month", "Months"
    7, "Week", "Weeks"
    1, "Day", "Days" |]
let ToDuration numDays =
    conversions
    |> Array.fold_left (fun (remainDays,results) (n,sing,plur) ->
        let count = remainDays / n
        if count >= 1 then 
            remainDays - (count * n),
              (sprintf "%d %s" count (if count=1 then sing else plur)) :: results
        else
            remainDays, results
    ) (numDays,[])
    |> snd |> (fun rs -> System.String.Join(", ", List.rev rs |> List.to_array))
printfn "%s" (ToDuration 1008) 
```

# sql-server - 远程连接到 sql08

> ID：296844
> 
> 赞同：1
> 
> 时间：2008-11-17T20:44:13.960
> 
> 标签：sql-server, sql-server-2008

有人有一个链接，我可以在其中阅读如何访问我的远程服务器的 sql server '08 安装？

**更新**

我想从远程服务器上的管理工作室访问 sql server 2008。

默认情况下禁用远程访问！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T16:41:20.017

badbadboy 的链接将是一个好的开始

1.  在 SSMS 中启用远程连接
2.  检查 TCP/IP，在配置管理器中启用命名管道
3.  检查防火墙

并仔细检查您连接到正确的服务器\实例名称和端口

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T20:57:36.867

你能扩大你的问题吗？你想如何访问它？用 SQL 管理工作室？指定计算机名称不起作用吗？您可以在本地访问它吗？它是 2008 SQL 有什么特别的吗？

# asp.net - TextBox 或 Html 区域中的换行符

> ID：296849
> 
> 赞同：10
> 
> 时间：2008-11-17T20:45:22.927
> 
> 标签：asp.net, html, vb.net

插入数据库（Asp.Net）时在多行文本框或 HTML 文本区域中分隔换行符和空格的方法是什么。例如，如果我想插入我应该怎么做

你好

世界

到带有换行符的数据库？还有同时显示我应该做什么？我不想为此使用编辑器。

* * *

但问题是如何分隔换行符和空格。现在当我插入

你好

世界

或你好世界，它在数据库中以相同的字符保存。因此，我无法将它们分开，尽管用户使用了上述换行符，但我正在展示 hello world。该值来自 TextBox 或 html 区域，与换行符或空格相同。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-17T20:57:35.010

换行符应该持续到数据库。当您检索信息并显示为 Html 时，只需将换行符（即 Environment.NewLine）替换为换行符标记（即 `< b r / >` ）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-10-12T19:48:19.947

`< br />`没有为我工作。（同时将文本分配给 html textarea）

`\r\n`做过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T17:37:03.883

使用 Razor (MVC3) 来显示或保留从我的数据库中提取的换行符，以下工作：

```
@Html.Raw(text_to_display.Replace(Environment.NewLine, "<br/>")) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-29T18:46:23.167

您可以使用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-15T18:01:52.027

一些选择：
• 将换行符转换为`<br/>`.
• 将您的文本放在一个`<pre>`块中。
• 将每一行放在自己的`<div>`块中。

请记住，所有空格（SP、HT、LF、CR）在 HTML 中都会被忽略（大部分时间）。

您存储在数据库中的应该是纯字符文本。将其转换为适当的 HTML 以供显示需要用 HTML 序列替换某些字符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-12-16T01:31:56.343

当试图为 asp.net 页面上的 textarea 控件保留格式化的回车符/换行符时，从后面的代码中获取它的值时，您应该使用：

```
textarea.Value = Server.HtmlDecode(myValue.Replace("\r\n", "&#13;")); 
```

这将从：

```
some blah blah\r\nblah blah 
```

到：

```
some blah blah
blah blah 
```

因此，当您使用 javascript 读取换行符时，您可以使用：

```
textarea.value.indexOf("\n"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T20:56:46.743

我总是按提供的方式存储用户输入，但是在再次显示它时必须**非常小心。**换行符只是用“<br />”替换 System.Environment.Newline 的一种情况。不确定在呈现为 html 时保留其他空白的最佳做法是什么，听听其他人在做什么会很有趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T00:25:49.287

在呈现为 HTML 后保留空白区域最容易通过将其转换为 HTML 实体来完成`&nbsp;`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-18T13:59:01.827

您需要用 html 标签 [<br>] 替换所有 vbcrlf (environment.newline) 实例

并且要允许多个空格，您需要将空格替换为 [& nbsp ;]

这会将您的普通测试转换为“足够”以被视为 html 的 html（适用于我网站的输入文本部分）

从我的标签中，它只是 [] 之间的文本并删除空格......将标签文本放入页面导致它显示为 html ！！！！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-15T17:43:34.857

上面对我有用的唯一建议是： `<& # 1 0 ;>` 我正在使用 Front Page 生成的文本框，现在在 Linux 服务器上运行。

字符串的多次使用不会创建多个换行符，但在新行上的单个字符串条目提供了适合新段落的双换行符。

在使用 Windows 操作系统从服务器移动我的页面之前，我能够通过双“Enter”来完成换行。

# c# - 所有者绘制的进度条（ListView/DataGridView）中的动画“发光”

> ID：296857
> 
> 赞同：6
> 
> 时间：2008-11-17T20:46:52.737
> 
> 标签：c#, listview, animation, windows-vista, progress-bar

我注意到 .NET 2.0 (Winforms) 中的标准 ProgressBar 确实在 Vista 中显示为精美的动画发光条。然而，使用 ProgressBarRenderer（当试图在所有者绘制的列表视图、网格视图或其他此类控件中绘制进度条时通常必须这样做）只会给出没有漂亮动画的视觉样式。

我想期望这会神奇地工作是愚蠢的——我想Vista中的本机控件必须有某种嵌入式计时器或线程，在绘制静态图像时显然不存在。我确实看到，如果您连续多次重绘 ProgressBar 控件（使用 DrawToBitmap），您实际上可以看到动画发光的不同阶段，所以我尝试使用计时器来保持自动重绘，但有些地方不太对劲外观，它也比实际的 ProgressBar 消耗更多的 CPU 时间。

这似乎给我留下了两个不合标准的选择：a）使用 ProgressBarRenderer 并最终得到 Vista“外观”但没有动画；或 b) 使用计时器不断地将多个 ProgressBars 重绘为位图，并浪费 CPU 周期以使其看起来更好但仍不完美。

我想知道是否有人有在自绘控件中嵌入进度条的经验，并且可能知道比上述两个选项更好的方法 - 无需依赖计时器和/或敲击 CPU 即可准确再现发光/闪烁的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T21:45:30.403

我不得不做一些非常疯狂的特技来完成这项工作。不幸的是，MSFT 没有更新 VisualStyleElement.ProgressBar 类来添加 Vista 添加的部分。并且构造函数是私有的。我不得不猜测产生动画的部分。我与这段代码相当接近，它应该给你一些实验的东西：

```
using System;
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;
using System.Reflection;

namespace WindowsFormsApplication1 {
  public partial class Form1 : Form {
    VisualStyleElement pulseOverlay;
    VisualStyleElement moveOverlay;
    VisualStyleRenderer pulseRenderer;
    VisualStyleRenderer moveRenderer;
    Timer animator = new Timer();
    public Form1() {
      InitializeComponent();
      ConstructorInfo ci = typeof(VisualStyleElement).GetConstructor(BindingFlags.NonPublic | BindingFlags.Instance,
        null, new Type[] { typeof(string), typeof(int), typeof(int) }, null);
      pulseOverlay = (VisualStyleElement)ci.Invoke(new object[] { "PROGRESS", 7, 0 });
      moveOverlay = (VisualStyleElement)ci.Invoke(new object[] { "PROGRESS", 8, 0 });
      pulseRenderer = new VisualStyleRenderer(pulseOverlay);
      moveRenderer = new VisualStyleRenderer(moveOverlay);
      animator.Interval = 20;
      animator.Tick += new EventHandler(animator_Tick);
      animator.Enabled = true;
      this.DoubleBuffered = true;
    }
    void animator_Tick(object sender, EventArgs e) {
      Invalidate();
    }

    int xpos;
    protected override void OnPaint(PaintEventArgs e) {
      Rectangle rc = new Rectangle(10, 10, 100, 20);
      ProgressBarRenderer.DrawHorizontalBar(e.Graphics, rc);
      rc = new Rectangle(10, 10, 50, 20);
      ProgressBarRenderer.DrawHorizontalChunks(e.Graphics, rc);
      xpos += 3;
      if (xpos >= 30) xpos = -150;  // Note: intentionally too far left
      rc = new Rectangle(xpos, 10, 50, 20);
      pulseRenderer.DrawBackground(e.Graphics, rc);
      moveRenderer.DrawBackground(e.Graphics, rc);
    }
  }

} 
```

# actionscript-3 - 测试对象是否在 ActionScript 中定义

> ID：296861
> 
> 赞同：28
> 
> 时间：2008-11-17T20:48:01.130
> 
> 标签：actionscript-3, actionscript, actionscript-2

在 ActionScript 中，如何测试对象是否已定义，即不为空？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-17T21:06:55.023

> **测试是否定义了对象**

这适用于 AS2 和 AS3，并且是测试对象是否具有值的最可靠方法。

```
if (obj != null) {
    doSomethingWith(obj);
} 
```

它也是测试对象属性并以相同表达式读取它的最可靠方法：

```
if (arr[0] != null && arr[0]>5) {
    doSomethingWith(arr[0]);
} 
```

> **测试一个对象是否为空**

null 和 undefined 之间是有区别的，但是如果您不在乎，您可以在两者之间进行正常比较，因为它们比较相等：

```
if (obj == null) {
    doSomethingWith(obj);
} 
```

是相同的

```
if (obj == undefined) {
    doSomethingWith(obj);
} 
```

如果您关心差异，请使用 === 或 !== 运算符，它们不会转换它们。

```
if (obj === undefined) {
    // obj was never assigned a value
}
else if (obj === null) {
    // obj was explicitly set to null
}
else {
    doSomethingWith(obj);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-22T11:51:13.200

对于[ActionScript 3.0](http://en.wikipedia.org/wiki/ActionScript#ActionScript_3.0)，如果您想要的只是对*虚无*的通用测试，那么这很容易：

```
var a;
var b;
var c;
var d;
a = undefined;
b = null;
c = 5;
if (a) 
    trace(a);
if (b) 
    trace(b);
if (c) // Will trace
    trace(c); 
if (d) 
    trace(d); 
```

在上面的例子中，只会`c`追踪。这通常是我需要的，并且只是检查`if (obj)`是最易读的版本。

此方法使用隐式转换为布尔值，也称为*boolean coercion*，哪些值将强制为 false 以及哪些值将强制为 true 的详细信息[遵循 ECMA 标准](http://www.ecma-international.org/ecma-262/5.1/#sec-9.2)，并且还[专门针对 ActionScript 进行了记录](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f87.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7f87__WS5b3ccc516d4fbf351e63e3d118a9b90204-7f77)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T20:50:05.103

只需针对 null 测试它。

```
var someObj:Object = getSomeObjectOrMaybeNull();
if(someObj == null) {
  trace("someObj is null!");
} else {
  trace("someObj is not null!");
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-04T10:01:10.463

您还可以遍历父对象以查看它是否包含您要查找的对象的任何实例。

```
foundit=false;
for (var i in this) {
    if (this[i]._name == "MyMovie") {
         foundit=true;
    }
} 
```

# java - 使用 Java EE 进行简单的工作流管理

> ID：296872
> 
> 赞同：1
> 
> 时间：2008-11-17T20:51:09.517
> 
> 标签：java, jakarta-ee, workflow

我有一个应用程序，它允许不同的用户更新一些数据，然后将这些数据发布到网站上。该应用程序使用 JPA 作为持久层。我现在想在这个场景中添加一些工作流管理，这样当具有初级角色的用户更新数据时，它不会直接发布，而是等待高级用户出现并批准更新。当更新未获批准时，原始数据应保持可见。

理想情况下，高级用户应该能够拒绝更新，而初级用户将看到该更新被拒绝并相应地编辑更新。

问题是，创建这样一个场景的好模式是什么？

我难以理解的部分是如何在不复制我拥有的每个实体的情况下表示更改的数据。在批准之前对数据进行多次更改怎么办？

我考虑了[命令](http://en.wikipedia.org/wiki/Command_pattern)模式，因为它允许某种类型的撤消。我想知道是否有人有过类似情况的经验并有什么建议可以提供？

我应该指出，我知道一些工具，例如[JBPM](http://www.jboss.org/jbossjbpm/downloads/)，它是一个工作流引擎，但我希望避免将这些工具集成到现有架构中的复杂性。如果有人指出使用这样的工具最终会产生更高的生产力，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-27T23:13:37.260

是的，我绝对认为您在这种情况下所做的是启动不同的*业务*流程。使用 JBPM 或[drools-flow](http://downloads.jboss.com/drools/docs/5.0.1.26597.FINAL/drools-flow/html/index.html)（您应该看看）等工具不仅可以准确地表达您的问题，还可以让您通过他们提供的设计器对应用程序的流程进行可视化处理。您可以使用使您的应用程序直接作为文档工作的东西。

# html - 如何设置当前文件夹的相对路径？

> ID：296873
> 
> 赞同：98
> 
> 时间：2008-11-17T20:51:16.833
> 
> 标签：html

假设我目前在： `http://example.com/folder/page.html`

是否可以在此页面上创建指向`http://example.com/folder/`而不指定`folder`任何位置的相对链接？（并且仅使用 HTML。）

**更新：** **事实证明，`./`它只适用于非严格的 doctype 模式，同时`.`适用于两种模式，所以在我看来它仍然是一个更好的答案:) 谢谢大家。**

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-11-17T20:55:18.133

只是点工作。doctype 有所不同，但有时 ./ 也很好。

```
<a href=".">Link to this folder</a> 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2014-06-21T10:06:30.050

对于找到此线程的任何人，解决相对路径总是会引发关于什么是正确的争论。

根据您使用要寻址的路径的位置，这将取决于您如何寻址路径。

一般来说 ：

`.`并`./`做同样的事情，但是你不会使用`.`文件名。否则，您将让浏览器`.filename.ext`从服务器请求文件。正确的方法是`./filename.ext`.

`../`寻址从当前文件夹向上一级的路径。如果您在路径中，并且文档中`/cheese/crackers/yummy.html`要求您的链接代码，那么就服务器而言，您将寻址路径。`../butter/spread.html``yummy.html``/cheese/butter/spread.html`

`/`将始终解决站点的*根目录*。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-17T20:53:48.700

您可以使用

```
 ../ 
```

意思是上一层。如果您在**page.html**所在的文件夹中有一个名为**page2.html**的页面，则相对路径为：

 **```
 page2.html. 
```

如果**page2.html**与文件夹处于同一级别，则路径为：

```
 ../page2.html 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-17T20:53:39.650

```
<html>
    <head>
        <title>Page</title>
    </head>
    <body>
       <a href="./">Folder directory</a> 
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T20:52:27.000

以下两个似乎都有效

./

.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-17T20:54:02.083

```
<a href="./">Folder</a> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-08T10:46:25.760

最佳答案不够清楚。这对我有用：如果您想指向实际文件，正确的格式应该如下所示：

```
 <a href="./page.html"> 
```

如果您在页面上，这将使您指向同一文件夹中的该文件`http://example.com/folder/index.html`

# indexing - 在 sphinx 搜索引擎中配置 merge_block_size

> ID：296879
> 
> 赞同：5
> 
> 时间：2008-11-17T20:53:16.033
> 
> 标签：indexing, sphinx

我正在使用 Sphinx 进行网络搜索，并在构建索引时收到以下错误消息：

> 警告：sort_hits：merge_block_size=76 kb 太低，增加 mem_limit 可能会提高性能

问题是我找不到有关配置此设置的位置的任何文档。我对 Sphinx 设置有点精通，所以我只需要知道设置的配置位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T18:30:01.383

这可能是因为您试图一次索引太多项目。确保您使用的是[范围查询](http://www.sphinxsearch.com/docs/current.html#conf-sql-query-range)。如果您已经在使用范围查询，那么`mem_limit`按照它的建议增加 可能会有所帮助。这`merge_block_size`是基于`mem_limit`和文件的数量。

如果您对它如何生成该数字感到好奇，请查看源代码。它是免费提供的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-01T15:14:52.950

> 在 sphinx.conf 中：
> 
> ```
> sql_query_range   = SELECT MIN(id),MAX(id) FROM documents
> sql_range_step = 1000
> sql_query = SELECT * FROM documents WHERE id>=$start AND id<=$end 
> ```
> 
> 如果表包含从 1 到 2345 的文档 ID，则 sql_query 将运行 3 次：
> 
> 1.  $start 替换为 1，$end 替换为 1000；
> 2.  $start 替换为 1001，$end 替换为 2000；
> 3.  $start 替换为 2000，$end 替换为 2345。
> 
> 显然，这对于 2000 行的表来说差别不大，但是在索引 1000 万行的 MyISAM 表时，范围查询可能会有所帮助。
> 
> [http://sphinxsearch.com/docs/current.html#ranged-queries](http://sphinxsearch.com/docs/current.html#ranged-queries)

希望对你有效。

# sql-server - 您的 SQL Server 备份/维护计划是什么？

> ID：296897
> 
> 赞同：6
> 
> 时间：2008-11-17T20:58:02.187
> 
> 标签：sql-server, backup, maintenance

作为[这个问题](https://stackoverflow.com/questions/296830/huge-transaction-log-is-this-normal)的后续，我想知道您的 SQL Server 备份/维护计划是什么，以及如何让我的计划变得更好。

目前，我正在从计划向导运行两个简单的维护计划。

第一个每晚运行，几乎所有事情......

*   完整的数据库和事务日志备份
*   完整性检查、重建索引、重新计算统计信息等（我检查了除增量备份之外的所有内容）

另一个每三个小时运行一次并进行增量备份（我很偏执，我知道这可能是矫枉过正）。

备份到磁盘，完整备份发送到 SAN，保留一周。

你怎么看，这是一个明智的计划吗？有什么建议么？

编辑：这是 SQL Server 2005。DB 为 5GB，每月增长约 1GB。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T21:08:07.330

听起来不错。我更偏执。我每天进行两次完整备份和每小时事务日志备份。取决于数据库或课程的大小。备份直接到磁盘，然后每晚备份到磁带。

您可能不需要每天都执行维护任务。我只在周末做，除了我们每晚重新索引的这张桌子。同样，这取决于数据库的大小和活动。

如果您有足够的 CPU 和磁盘空间，您可以压缩磁盘备份以节省空间并更快地传输到磁带或其他位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-18T16:33:27.990

您应该与您的用户/客户/数据保管人交谈——无论您如何称呼他们。他们需要清楚地了解他们可以失去多少工作。如果您没有 SLA，请编写一份 SLA。当遇到坏消息时，您不希望有任何意外。

他们还需要了解恢复需要时间。您需要规划恢复计划以创建可接受的恢复时间。这可能意味着每天进行一次完整备份，每 5 分钟备份 4 次差异和日志备份。这并不像 Marcus Erickson 所说的那样疯狂或偏执——这一切都取决于您的信息和您的组织对其的美元价值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T21:27:25.060

我认为您每 3 小时运行一次备份并不偏执。基本上，您的备份计划必须根据您的恢复要求来衡量。您在恢复期间可以承受多长时间的停机，而在停机之前您愿意丢失多少数据。对于 SQL Server，您可以通过将事务日志备份添加到备份计划中来大大减少您愿意丢失的数据量。许多人每隔几分钟就会这样做一次，具体取决于通过系统的交易量。要进行还原，您只需还原最后一次完整备份、最后一次增量备份，然后是自增量备份以来的所有事务日志备份。这可以最大限度地减少数据丢失，但应用所有事务日志备份可能需要一点时间。我经常看到以下内容：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T10:35:30.133

请记住在实际尝试从您创建的备份（到测试系统）中恢复的地方进行防火练习。这应该每月进行一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T05:08:05.267

我向我的客户推荐的最低要求是每晚对数据库进行一次完整备份，然后每 3 小时进行一次事务备份。有多少人从未设置备份，这总是让我感到惊讶。那些总是不好的电话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-24T14:10:56.613

在我看来，最好的方法是：

每 12 小时进行一次完整的数据库备份

`BACKUP DATABASE database TO DISK = 'd:/full.bak'`

每六个小时进行一次差异备份，在发生故障的情况下更容易恢复过程

`BACKUP DATABASE database TO DISK = 'd:/diff.bak' WITH DIFFERENTIAL`

当然，还有最好每小时进行一次的事务日志备份。

`BACKUP LOG database TO DISK = 'log.bak'`

如果失败的情况下，恢复过程将是下一个：

*   上次完整备份
*   上次差异备份
*   最后的事务日志

必须承认，最好使用完全恢复模式来实现时间点恢复。

# asp.net - 如何为 ASP.NET GridView 创建两行标题

> ID：296904
> 
> 赞同：0
> 
> 时间：2008-11-17T21:00:07.720
> 
> 标签：asp.net, gridview

我的数据是这样的，我想显示特定记录的员工和主管的值。我将向您展示一个粗略的示例，而不是对其进行描述：

```
<table><tr>
<th colspan="3">Employee</th>
<th colspan="3">Supervisor</th>
</tr><tr>
<th>Name</th>
<th>Last Activity</th>
<th>Count</th>
<th>Name</th>
<th>Last Activity</th>
<th>Count</th>
</tr>
</table> 
```

如何为 GridView 创建这个？我基本上想要 2 行作为标题，并且一些单元格应该跨越一列以上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T21:04:58.583

你需要gridview的编辑或排序功能吗？我发现除了在 gridview 中显示直接表格数据之外，尝试做任何事情都是一种耐心的练习。

为简单起见，如果您的网格是只读的，我建议使用中继器并编写您自己的表格 HTML。

**编辑** 以回复下面的[评论](https://stackoverflow.com/questions/296904/how-to-create-two-row-header-for-asp-net-gridview#comment143686_296914)。

> 这可能是我们采取的路线，但出于相互教育的目的，我想知道您是否可以使用 GridView 做这样的事情。– 拉森

你可以，但这绝非易事。如果您还没有并且可以负担得起切换，您可能想要查看 ASP.NET MVC，它可以让您完全控制 HTML。您可能想查看有关一般数据访问的此链接。[http://www.asp.net/learn/data-access/](http://www.asp.net/learn/data-access/) #15、#27、#51-53 可能会为您提供一些与您的 gridview 问题相关的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T17:27:00.423

正如 Galwegian 所发布的，冻结数据网格可以通过 CSS 表达式来实现。但这仅适用于 IE7 及以下版本。

对于 IE 7 以上的版本和 Firefox 等其他浏览器，下面的代码段应该可以工作。

```
function setWidth () {
    document.getElemenById("myDiv").style.left = body.clientWidth / 2 - oDiv.offsetWidth / 2;
    document.getElemenById("myDiv").style.top = document.body.clientHeight / 2 - oDiv.offsetHeight / 2;
} 
```

有关详细信息，请参阅[http://techbookshelf.blogspot.in/2012/09/expressions-in-css.html](http://techbookshelf.blogspot.in/2012/09/expressions-in-css.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-07T18:24:09.037

一个选项可能是处理 RowDataBound 并在 RowType for Header 上设置自己的 RenderMethod 并自己编写 HTML。

```
e.Row.SetRenderMethodDelegate(New RenderMethod(AddressOf RenderHeader)) 
```

# sql-server - 使用 SQL Server Profiler 访问日志表

> ID：296906
> 
> 赞同：5
> 
> 时间：2008-11-17T21:01:35.703
> 
> 标签：sql-server, profiler

有没有办法使用 Profiler 来确定查询是否正在访问表？

我看到一个名为`Object:Opened`（指示何时访问对象，例如对于 SELECT、INSERT 或 DELETE 语句）和的事件`Object:Closed`，但这些似乎不起作用。

特别是，我使用没有过滤器的 Object:Opened 和 Object:Closed 创建了一个简单的跟踪（除了标准的“Application Name not like 'SQL Profiler'”过滤器）并运行`SELECT TOP 1 * FROM TableName`，但没有报告任何事件。

那么，有没有办法使用 Profiler 来确定是否正在从中选择表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-23T14:26:49.087

调查 SQL 正在获取的锁可能会有所帮助。Select 语句通常会获取共享锁 (LCKMS)，因此您可以对此进行过滤。

在分析器中查找 Locks:Acquired 事件。ObjectID 将解析为您可以轻松查找的表`OBJECT_NAME(objectid)`。Mode 会告诉您正在获取的共享锁的类型是 3。有关更多信息，请查看[此处](http://msdn.microsoft.com/en-us/library/ms189897.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-29T00:58:10.700

Profiler 有一种方法可以做到这一点，但它对性能有很大的影响。

相反，您能用您使用的 SQL Server 版本澄清您的问题吗？如果您使用的是 SQL Server 2008，请查看 Audit 对象，该对象旨在执行此操作，而且它对性能的影响非常低。

这是一篇解释如何设置审计的文章：

[在 SQL Server 2008 中实施安全审核](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1338532,00.html)

其他发帖者指出，您可以根据对象名称过滤 TextData，但如果有人使用视图访问该对象，这将不起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-07T12:53:24.367

我通过分析器找到了一种方法，即 EventClass“审计架构对象访问事件”。

虽然经过一番挖掘，我独立地发现了这一点，但我发现了这篇优秀的文章；

[http://www.databasejournal.com/features/mssql/article.php/3887996/Determining-Object-Access-Using-SQL-Server-Profiler.htm](http://www.databasejournal.com/features/mssql/article.php/3887996/Determining-Object-Access-Using-SQL-Server-Profiler.htm)

问候，

达伦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T23:15:31.067

我在 SQL Server 2005 中没有看到这些。

以我的经验，我看`SQL:StmtStarting` **AND** `SP:StmtStarting` - 你可以过滤`TextData`. `%TABLE_NAME%`当您使用`SP:StmtStarting`.

它不是万无一失的，因为它必须使用`LIKE`语法，但它可能会为您提供所需的内容。

# database - 数据库之外是否需要事务行为？

> ID：296909
> 
> 赞同：13
> 
> 时间：2008-11-17T21:02:48.120
> 
> 标签：database, transactions, persistence, unit-of-work

如果没有事务，我不敢在数据库中做任何复杂的事情。几乎总是有一个简单易用的内置命令。但是，当您开始使用其他持久性数据时，您并没有得到这种简单易用的事务支持。一些例子是

*   文件系统
*   网络服务（我没有使用过）

即使在非持久性数据中，在出现异常后撤消工作块通常也很有用。使用一种语言获得的标准数据结构都不支持事务。

我想知道的是，为什么数据库是特例？

数据库之外的事务行为主题是否有任何有用的链接？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-17T23:19:08.813

我必须恭敬地不同意：事务系统不是自动和专有的数据库引擎，恰恰相反......

我已经实现了一种不同于数据库事务的应用程序事务机制（在 .NET 中）。它实际上相当容易（包括单元测试套件在内的几个小时的工作）。它完全用 C# 编写，不依赖于任何数据库功能或任何其他组件。但首先是一些背景......

这种非数据库事务特性存在于 Java 平台上的多种表现形式中，例如 EJB、ESB、JMS，并且通常与 BPM 相关联。其中一些表现形式使用底层数据库，但并非总是如此，也并非没有必要。其他平台也有类似的表现形式，例如 MSMQ。

大多数遗留版本控制系统不实现 ACID 事务语义。正如 ddaa 所说，CVS 没有，但 Subversion（它的继任者）有。Visual Source Safe 没有。如果您研究 Subversion，您可以找到说明这一点的比较图表。

现在对于关键点，数据库事务或其等价物并不能保证安全的业务逻辑。尽管我喜欢 Subversion，但具有讽刺意味的是，它是这一事实的一个很好的例子。

您可以虔诚地使用 Subversion 以及自动构建脚本（一个用于编译、测试和打包您的应用程序的命令），并且仍然将损坏的构建提交到源代码控制存储库。我已经多次看到了。当然，使用非 ACID 事务的源代码控制工具（如 VSS）更容易。但是对于许多人来说，得知使用 Subversion 之类的工具是可能的，这让很多人感到震惊。

请允许我列出这个场景。您和一位同事正在开发一个应用程序，并使用 Subversion 作为源代码控制存储库。你们俩都在编码，偶尔会提交到存储库。您进行一些更改，运行一个干净的构建（重新编译所有源文件），并且所有测试都通过了。因此，您提交更改并回家。您的同事一直在进行自己的更改，因此他还运行了一个干净的构建，看到所有测试通过，并提交到存储库。但是，您的同事随后从存储库更新，进行了一些更改，运行干净的构建，构建在他的脸上炸毁了！他恢复他的更改，再次从存储库更新（只是为了确定），并发现一个干净的构建仍然爆炸！您的同事在接下来的几个小时内对构建和源代码进行故障排除，并最终发现您在离开之前所做的更改导致构建失败。他向您和您的共同老板发送了一封令人讨厌的电子邮件，抱怨您破坏了构建然后粗心大意地回家了。你早上到达，发现你的同事和老板在你的办公桌前等着骂你，其他人都在看着！所以你快速运行一个干净的构建并向他们展示构建没有破坏（所有的测试都通过了，就像昨晚一样）。

那么，这怎么可能呢？这是可能的，因为每个开发人员的工作站都不是 ACID 事务的一部分；Subversion 只保证存储库的内容。当您的同事从存储库更新时，他的工作站包含存储库内容（包括您的更改）和他自己未提交的更改的混合副本。当你的同事在他的工作站上运行一个干净的构建时，他正在调用一个不受 ACID 语义保护的业务事务。当他恢复更改并执行更新时，他的工作站随后与存储库匹配，但构建仍然中断。为什么？因为您的工作站也是不受 ACID 语义保护的单独业务事务的一部分，这与您对存储库的提交不同。由于在运行干净构建之前您没有更新您的工作站以匹配存储库，因此您实际上并没有构建存储库中存在的源文件。如果您执行了这样的更新，您会发现您的工作站上的构建也会失败。

现在我可以阐述我的初始观点——交易具有必须仔细考虑的范围/上下文。仅仅因为您有 ACID 事务并不意味着您的业务逻辑是安全的，除非 ACID 事务的范围/上下文和业务逻辑完全匹配。如果您依赖于某种形式的数据库 ACID 事务，但您在业务逻辑中执行了该数据库事务未涵盖的任何操作，那么您的差距可能会导致类似的灾难性错误。如果您可以强制您的业务逻辑与您的数据库事务完全匹配，那么一切都很好。如果没有，那么您可能需要单独的业务交易。根据未受保护逻辑的性质，您可能需要实现自己的事务机制。

因此，消息传递可以是事务性的，但范围仅仅是消息。关于上面的例子，Subversion 的上下文只是对存储库的单个提交。但是，业务事务是一个干净的构建，涉及的范围要大得多。这个特定问题通常通过编写干净的构建脚本和干净的检查来解决，理想情况下使用持续集成实现（例如，通过 CruiseControl 等）。在开发人员工作站上，它要求每个开发人员在干净构建之前执行完整更新（甚至是干净检查）。

因此，回顾一下，每个事务都有一个限制其保护的范围或上下文。业务事务通常包含超出我们常用的事务机制（例如数据库引擎）范围的逻辑。您可能必须弥补差额。在极少数情况下，编写自己的事务机制来这样做甚至可能是有意义的。

我为一家规模不大的 90 人公司设计了一个关键业务系统的重写。我发现实施这样的机制是必要的，而且我发现这种体验很容易、很有价值并且很有意义。我会再做一次，也许更容易一些，但我总是会质疑为什么我不能只坚持一个数据库事务。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-17T21:52:30.360

我认为事务只出现在数据库中的原因是，根据定义，提供事务的系统称为数据库。这听起来很循环，所以我必须详细说明。

事务支持是提供[ACID](http://en.wikipedia.org/wiki/ACID)属性的功能。用外行的话来说，这意味着一个事务允许 1\. 将许多谨慎的操作捆绑到一个包中，这些操作要么作为一个整体成功，要么作为一个整体失败 2\. 隐藏对并发用户的未提交更改，以便 3\. 并发用户始终对系统有“一致”的看法。

[文件系统](https://stackoverflow.com/questions/296909/is-transactional-behaviour-ever-needed-outside-the-database#296912)传统上提供一些锁定机制，但这与提供事务不同。但是，所有文件系统都有一些原子属性。例如，如果您有目录`/a/`and `/b/`，并且您同时尝试执行`mv /a /b/a`and `mv /b /a/b`，那么这些操作中只有一个会成功，而不会影响完整性。然而，文件系统通常缺乏将多个操作捆绑到一个孤立的原子包中的能力。

[一个答案](https://stackoverflow.com/questions/296909/is-transactional-behaviour-ever-needed-outside-the-database#296984)提到了颠覆。所有健全的版本控制系统都有事务。当提交多个文件时，系统要么完全应用提交，要么完全拒绝它（除了 CVS，我不认为它是理智的）。拒绝的原因总是同时发生的变化。版本控制系统的实现者非常注意维护数据库。

[另一个](https://stackoverflow.com/questions/296909/is-transactional-behaviour-ever-needed-outside-the-database#296927)答案提到消息传递系统是事务性的。我没有阅读链接的材料，但答案本身只提到了消息的原子传递。那不是交易。

[在Brian C.](https://stackoverflow.com/questions/296909/is-transactional-behaviour-ever-needed-outside-the-database#297022)在这里提到它之前，我从未听说过[Clojure 。](http://clojure.org/refs)在我看来，这确实是数据库上下文之外的事务实现。这里的重点是并发控制，而不是维护持久数据的一致性。

因此，除了 Clojure 之外，似乎任何需要事务的系统要么使用底层数据库，要么将自己变成数据库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T21:04:22.687

现代文件系统确实有事务。它们对最终用户是透明的。

NTFS、XFS、JFS、EXT3 和 ReiserFS 都可以，仅举几例。

这只是文件系统的内部。许多操作系统还支持文件锁定（例如，参见 *NIX 世界中的flock(2)），带有排他（写）和共享（读）锁。

编辑：如果您考虑一下，文件系统不像现代数据库那样具有隔离级别，因为一旦您完成读取文件，如果您没有锁定它，您通常会关闭它。然后当你想写它时重新打开它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-17T21:34:38.960

[Clojure](http://clojure.org/refs)使用[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)，它使用事务使编写多线程程序变得容易和安全，而无需手动锁定。Clojure 具有不可变的数据结构和对它们的可变引用，并且需要事务来更改引用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T21:07:58.203

消息系统是事务资源管理器的另一个例子。

也就是说，您可以确保消息使用者成功处理队列中的消息。如果处理失败，则消息留在队列中。

此外，消息传递系统可以参与与另一个资源管理器的分布式事务。

更多信息在

*   [https://java.sun.com/j2ee/1.4/docs/tutorial/doc/JMS6.html](https://java.sun.com/j2ee/1.4/docs/tutorial/doc/JMS6.html)
*   [http://www.odi.ch/prog/jms-tx.php](http://www.odi.ch/prog/jms-tx.php)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-17T21:22:02.947

Subversion 提交是事务性的：它们是真正原子的，因此中断的提交不会使存储库处于不一致的状态。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-02T16:46:51.967

我遇到了需要将文件系统和数据库视为一个事务单元的情况。

就我而言，我只需要将一组文件下载到文件系统中。我通过每次创建随机目录、将数据放在那里并将目录名称存储在数据库表中来做到这一点。因此，我所有的数据库工作以及数据库表中的目录名称（= 文件系统工作）都可以在一个数据库事务中完成。

[http://www.databasesandlife.com/atomic-operations-over-filesystem-and-database/](http://www.databasesandlife.com/atomic-operations-over-filesystem-and-database/)

# windows - UNIX shell 脚本的 Windows 等效项是什么？

> ID：296910
> 
> 赞同：19
> 
> 时间：2008-11-17T21:03:47.027
> 
> 标签：windows, command-line, shell, batch-file

我想要一个可执行文件来调用其他一些程序。我在 Linux 中执行此操作的方法是使用如下所示的简单 bash 脚本：

```
#!/bin/bash
echo "running some-program"
/home/murat/some-program arg1 arg2 
```

在 Windows 下做这种事情的最佳方法是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-17T21:05:50.577

看看[PowerShell](http://www.microsoft.com/downloads/details.aspx?familyid=C6EF4735-C7DE-46A2-997A-EA58FDFCBA63&displaylang=en)，它是最接近真正的脚本语言的工具，就像在 Unix 中一样。除此之外，对于简单的事情，例如简单地运行应用程序，请查看 Windows 命令脚本/MS-DOS 批处理文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-17T21:07:28.547

您可以使用老式批处理文件 ( [http://en.wikipedia.org/wiki/Batch_file](http://en.wikipedia.org/wiki/Batch_file) )，也可以使用全新的闪亮 Windows PowerShell 脚本 ( [http://www.microsoft.com/technet/脚本中心/集线器/msh.mspx](http://www.microsoft.com/technet/scriptcenter/hubs/msh.mspx)）。

我将批处理用于简单操作，将 PowerShell 用于还涉及数据处理的复杂脚本。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-17T21:15:23.303

Windows 上有许多脚本选项：

*   批处理文件
*   VBScript/CScript/JScript（与 WMI 结合使用时非常强大）
*   电源外壳
*   您可以安装 Perl、Python 或其他引擎
*   您可以安装 unix 工具，例如通过 Cygwin，以使大多数常见的 unix 命令在 Windows 中也可用。
*   因为我们都是（大部分？）这里的程序员，所以没有什么能阻止你制作一个 .exe 文件来做你想做的事。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-17T21:05:22.250

您可以使用 Windows 批处理文件。[在Wikipedia 文章](http://en.wikipedia.org/wiki/Batch_file)中查找更多信息。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-17T21:23:06.207

Windows NT 系列操作系统（NT 3.51、NT 4.0、2000、XP、Vista）具有相当强大的命令外壳，即使它有点深奥。这个 shell 没有典型的 UNIX shell 的强大功能，但是它在 Windows 机器上无处不在，而且可以实现的效果非常惊人。Timothy Hill所著的[Windows NT Shell Scripting](https://rads.stackoverflow.com/amzn/click/com/1578700477)是一本很好的书。我总是发现[Rob van der Woude 的 Scripting Pages](http://www.robvanderwoude.com/batchfiles.php)是一个很好的批处理文件资源。

PowerShell 是 Microsoft 在该领域的最新产品，它将脚本编写提升到一个全新的水平，让您可以访问 .NET 框架以及 WMI、COM 和任何其他 Windows 接口的所有功能。这方面的学习曲线相当陡峭，但这绝对是要走的路，我认为它有可能成为微软世界的基础技术技能之一（如 RegEx、XPath 等）。一个很好的起点是[Microsoft Windows PowerShell 技术中心](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)，但这里有大量资源。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-17T21:09:53.143

我曾经使用批处理文件。对于你上面给出的简单例子，我仍然这样做，但我越来越多地使用[python](http://www.python.org/)来做这些事情。对于那些在多个平台上实际上有意义的稀有脚本，它具有跨平台工作的额外好处。

Python 只是您可以用于此类事情的众多脚本语言之一。Perl、ruby 或 php 可能更适合您的速度。我发现脚本语言给了我更丰富和更容易理解的语法，如果我想做一些比仅仅使用几个默认参数启动程序更复杂的事情。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-17T21:14:37.753

只要我们建议使用 *nix 命令行工具，我建议您查看 Cygwin ( [http://www.cygwin.com](http://www.cygwin.com) )，因为它模拟了类似 *nix 的环境。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-17T21:05:15.713

批处理文件对我有用。只需删除示例中的第一行，它在 win32 cmd 行中的工作方式应该相同。

注意 - 创建一个文本文件，使用 .bat 扩展名命名，并使用反斜杠而不是正斜杠。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-17T23:25:43.603

**更新**：哇，这现在已经过时了（尽管这是不可避免的）。Powershell 肯定会越来越多地成为 Windows 自动化的首选语言。它具有任何 .net 语言（如 C#）的许多优点以及任何良好的 shell 语言中存在的许多权宜之计，而没有批处理文件的严重缺点。

对于它的价值，我在某家大型的、基于雷德蒙德的软件公司看到的最受欢迎的选择（按受欢迎程度的粗略排序）：

*   批处理文件
*   Perl
*   Windows 脚本宿主 (Javascript)
*   小前任

不太受欢迎：

*   电源外壳

请注意，Perl 不需要安装，它只需要一些环境变量更新，因此很容易将完整的发行版与其他工具一起推入源代码控制系统。

我个人的偏好是尽可能避免使用批处理文件，即使使用最谨慎和最严格的流程，成本收益也是不值得的。如果您使用批处理，您将永远不会得到令人满意的解决方案。Perl 和 Javascript 很容易使用，但存在一些麻烦的基本缺陷，还有很多不足之处，如果没有强有力的开发指南，这些方法很可能会导致代码质量低下。

Python 和 Powershell 是很好的候选者，但我对它们不够熟练，更重要的是，很多人对它们并不熟悉。也许这不是一个足够好的借口。微小的 exe 也可能有很多问题，需要纪律和流程，以确保始终签入源代码，确保 exe 符合某些 UI 规范（例如，如果您运行 -? 或 /?，它们会提供有用的帮助），即他们有一个明显的所有者，更新exes的过程是可发现的，等等。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-09-22T16:36:03.147

作为功​​能不足的 Windows 命令行、对 Windows 不太友好的 Cygwin 或古怪而缓慢的 Powershell 的替代方案，您可以考虑[Hamilton C shell](http://www.hamiltonlabs.com/cshell.htm)。我是作者，所以我当然可能有偏见，但我是一个真实的人，我确实关心如何让我的客户满意。Hamilton C shell 是对 UNIX C shell 和实用程序的完全重新创建，但所有这些都是针对 Windows 从头开始​​的，因此，它旨在遵循 Windows 对文件名等的约定。今年夏天，我刚刚发布了一个新版本的 Vista，其中包括 32 位和 64 位版本。（64 位版本的速度大约是 32 位版本的 2 到 3 倍。）有一个免费的演示，所以您可以在购买前尝试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-12-23T14:54:23.890

虽然外壳有`sh -C ${custom command}`.

尝试***${custom command}***代表您要执行的命令的位置`cmd /C ${custom command}`。

 ** * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-17T21:09:02.880

通常，与 *nix 相比，windows 命令行 (DOS) 被认为是相当贫乏的。如果你想要一个强大的命令 shell，你可以安装 Cygwin 或 PowerShell 之类的东西，或者你可能会给自己带来巨大的痛苦和痛苦，尝试使用 DOS 来满足你的所有需求。:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-17T21:17:15.157

WScript.CreateObject("Scripting.FileSystemObject");

最近一直是我选择的win32武器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-17T21:19:37.633

我使用 CScript/JScript 的组合。一旦你了解了可用的系统对象，它就非常强大。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-05-11T07:35:14.953

这是我不久前为某人制作的示例批处理文件。

```
echo off
echo Backing up Images
%homedrive%\Backup\7z.exe a -tzip photos.zip %userprofile%\Photos\*.jpg %userprofile%\Photos\*.png %userprofile%\Photos\*.gif %userprofile%\Photos\*.bmp
echo Backing up Music
%userprofile%\Backup\7z.exe a -tzip music.zip %userprofile%\Music\*.mp3 %userprofile%\Music\*.wma %userprofile%\Music\*.ogg %userprofile%\Music\*.wav
echo All Done 
```

请注意，该脚本希望 7z.exe 程序位于 %homedrive% 位置的名为 Backup 的文件夹中。我使用环境变量让不同的用户更容易使用。

# c# - 如何在c#中返回对字符串的引用？

> ID：296913
> 
> 赞同：4
> 
> 时间：2008-11-17T21:04:55.697
> 
> 标签：c#

我正在寻找编写一个类似的函数

```
ref String TestIt( int index )
{
return this.TestArray[index];
}; 
```

这样我就可以编写如下代码：

```
MyClass.TestIt(0) = "Hello World"; 
```

我的目标是模仿这个 c++ 声明

```
CString& MyClass::Data( UINT index); 
```

通过引用，我指的是 c++ 术语变量的地址。
换句话说，在我调用 TestIT(0) 之后，TestArray[0] 将包含“Hello World”。

**编辑** 我不能使用索引器，因为我的目标是持续将 .cpp 文件转换为 c#。我越能模仿这个 c++ 代码，我必须编写的转换器就越少。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T21:12:42.797

为此，您需要编写一个 setter 属性。不幸的是，setter 无法在 C# 中接受更多参数，因此您将无法在 C# 中 1:1 编写此代码。您可以获得的最接近的是具有默认属性的嵌套类：

```
class YourClass {
    public class Nested {
        public Nested(YourClass outer) { m_RefToOuterWorld = outer; }
        private readonly YourClass m_RefToOuterWorld;

        public string this[int index] {
            get { return m_RefToOuter.TestArray[index];
            set { m_RefToOuter.TestArray[index] = value; }
        }
    }

    private readonly Nested m_Nested;
    private string[] TestArray = new string[10];

    public YourClass() { m_Nested = new Nested(this); }

    public Nested TestIt { get { return m_Nested; } }
} 
```

你可以像这样使用它：

```
var test = new YourClass();
test.TestIt[2] = "Hello world!"; 
```

顺便说一句，由于这很费力，您可能不想这样做。此外，它感觉不是很 C#-y。通过这里的嵌套类进行的无用的间接操作并不是您经常会看到的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T21:21:49.877

简短的回答是您不能返回对字符串*变量*的引用，即对字符串引用的引用）。

简单的解决方案是避免这种 API 并要求用户以另一种方式设置字符串：

```
myobj.SetString(0, "Hello, world!"); 
```

如果您*确实*需要表示（作为一等对象）对您的字符串引用的引用，请尝试以下 API：

```
Interface IStringReference
{
    void SetString(string value);
    string GetString();
}

class MyClass
{
    public IStringReference TestIt()
    {
        ... details left out ;) ...
    }
} 
```

但我认为这在模仿 C++ 的左值方面太过分了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T21:49:31.893

我可以推荐以下解决方案

```
 public class Test
    {
        Dictionary<int,string> str=new Dictionary<int,string>(); 
        public string this[int i]
        {
            get
            {
                return str[i];
            }
            set
            {
                if(!str.ContainsKey(i))
                    str.Add(i,value);
                else
                    str[i] = value;
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T21:09:09.153

您无需返回参考即可实现目标。字符串类型是引用类型，但对比较有特殊处理。因此，如果您只是从 TestIt 返回一个字符串，则相等性检查将进行字符串比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T21:40:13.660

你不会只使用索引器（一个带参数的匿名属性）吗？

```
private string []storage = new string[10];
public string this[int index]
{
  get
  {
    return storage[index];
  }
  set
  {
    storage[index] = value;
  }
} 
```

然后调用：

```
MyClass[0] = "Hello World"; 
```

当然，它没有花哨的“TestIt”名牌……你需要那个名牌吗？

编辑：大声笑，我搜索了“C# 命名索引器”，我发现谁在 2005 年以出色的答案回答了愚蠢的问题？正是[乔恩·斯基特](http://bytes.com/forum/thread223907.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T23:03:51.963

为什么要费心保持两个版本的代码相同？编写一个可以从 .Net 使用然后调用适当函数的托管 C++ 包装器不是更容易吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T23:20:50.727

所有相同的字符串只有一个引用，无论它在代码中被引用多少次。

来自[http://msdn.microsoft.com/en-us/library/system.string.intern.aspx](http://msdn.microsoft.com/en-us/library/system.string.intern.aspx)

> 公共语言运行时通过维护一个称为实习池的表来保存字符串存储，该表包含对程序中以编程方式声明或创建的每个唯一文字字符串的单个引用。因此，具有特定值的文字字符串的实例在系统中只存在一次。
> 
> 例如，如果您将相同的文字字符串分配给多个变量，则运行时会从实习池中检索对文字字符串的相同引用并将其分配给每个变量。

# .net - 复制本地选项在哪里？

> ID：296917
> 
> 赞同：0
> 
> 时间：2008-11-17T21:05:24.027
> 
> 标签：.net, asp.net, .net-3.5

我正在尝试将 dll 引用添加到 ASP.NET 3.5 项目（Web 窗体不是 MVC），并且我添加的所有引用都显示为自动更新。我右键单击bin文件夹中的dll以指定本地复制，但该选项不存在。

我回到了 2.0 项目之一，我有很多不是自动更新的 dll，但我不知道如何添加不再自动更新的引用......

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T22:06:44.497

我不确定它是否适合您（我使用 Studio 2005、.NET 2.0），但对于我来说，对于普通应用程序，我展开引用节点并单击引用。显示属性，它以“复制本地”的形式存在。（不是bin中的dll，项目资源管理器中Reference节点中的引用）

# .net - .NET DateTime.Now 在时区更改时返回不正确的时间

> ID：296918
> 
> 赞同：39
> 
> 时间：2008-11-17T21:05:28.753
> 
> 标签：.net, datetime, timezone, dst

此问题发生在夏令时更改期间。更改发生后，我们注意到我们的服务器应用程序开始写入日志的时间不正确 - 提前一小时，这意味着 .NET 缓存时区偏移量。我们不得不重新启动我们的应用程序来解决这个问题。我写了一个简单的应用程序来重现这个问题。当我在应用程序运行时更改时区时，DateTime.Now 属性会继续生成旧时区的时间。有谁知道除了重新启动应用程序之外是否有解决此问题的方法？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-17T22:24:19.623

是的，当前时区被缓存。有一个很好的理由，它避免了使用 DateTime.Now 来实现经过时间测量的损坏代码的麻烦。当时间突然改变一个小时或更长时间时，这样的代码往往会遭受心脏病发作。

您必须调用 System.Globalization.CultureInfo.ClearCachedData() 来重置缓存值。对 DateTime.Now 的下一次调用现在将提供新的本地时间。如果您完全使用 .NET 3.5 TimeZoneInfo 类，那么您还需要调用其 ClearCachedData() 方法。您可以使用 SystemEvents.TimeChanged 事件作为触发器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T21:37:10.093

最常见的建议是存储 DateTime.UtcNow，当您想向用户显示本地时间时，转换为本地时间以考虑夏令时。

[.NET 使用DaylightTime](http://msdn.microsoft.com/en-us/library/system.globalization.daylighttime.aspx)和[TimeZone](http://msdn.microsoft.com/en-us/library/htc4xefd.aspx)类提供涉及夏令时的计算，并且[ToLocalTime](http://msdn.microsoft.com/en-us/library/system.datetime.tolocaltime.aspx)方法据说可以将 UTC 转换为夏令时的本地会计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-22T18:29:43.443

上面的完全限定类略有不同，但可能在 .NET 3.5 中发生了变化。

```
System.Globalization.CultureInfo.CurrentCulture.ClearCachedData() 
```

也不要忘记包含（在 C#.NET 中）或导入（使用 VB.NET）库参考`System.Globalization.CultureInfo`

在使用之前调用它`DateTime.Now`。尽管最好在 Global.asax 文件的启动事件中调用它。

========== 还要确保检查 Windows Server 本身或本地计算机上的时区，具体取决于 IIS Web 服务器的运行位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T07:37:59.490

在我的项目中，如果时间（或时区）发生更改，我需要重置一系列变量。为了让我知道发生了这个事件，我最终使用了 WindowsMessageFilter。

我正在使用.Net 2.0，所以我不能使用（或者我在错误的地方寻找）ClearCachedData，所以我在一些反思的帮助下使用了这种方法。

```
 Private mTZChangeFilter As WindowsMessageFilter

    mTZChangeFilter = New WindowsMessageFilter()
    AddHandler mTZChangeFilter.TimeChanged, AddressOf onTimeChanged

    Application.RemoveMessageFilter(mTZChangeFilter)

Public Class WindowsMessageFilter
    Implements IMessageFilter

    <System.Diagnostics.DebuggerStepThrough()> _
    Public Function PreFilterMessage(ByRef m As System.Windows.Forms.Message) As Boolean Implements System.Windows.Forms.IMessageFilter.PreFilterMessage
        ' Debug.Print(m.Msg.ToString)
        If m.Msg = 30 Then
            ResetTimeZone()
            RaiseEvent TimeChanged(Me)
        End If
    End Function

    Private Sub ResetTimeZone()
        Dim tz As Type = GetType(System.TimeZone)
        Dim mth As System.Reflection.MethodInfo

        Try
            mth = tz.GetMethod("ResetTimeZone", BindingFlags.NonPublic Or BindingFlags.Static)
            mth.Invoke(mth, Nothing)
        Catch ex As Exception
            Debug.Print(ex.ToString)
        End Try
    End Sub 

end class 
```

# c# - 您如何获得当前时间？

> ID：296920
> 
> 赞同：296
> 
> 时间：2008-11-17T21:06:47.923
> 
> 标签：c#, datetime

你如何获得当前时间（不是日期和时间）？

示例：下午 5:42:12

* * *

## 回答 #1

> 赞同：417
> 
> 时间：2008-11-17T21:08:53.067

`DateTime.Now.TimeOfDay`把它作为一个`TimeSpan`（从午夜开始）给你。

`DateTime.Now.ToString("h:mm:ss tt")`把它作为一个*字符串*给你。

日期时间参考：[https ://msdn.microsoft.com/en-us/library/system.datetime](https://msdn.microsoft.com/en-us/library/system.datetime)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-04-02T10:20:18.017

尝试这个：

```
DateTime.Now.ToString("HH:mm:ss tt"); 
```

对于其他格式，您可以查看此站点：[C# DateTime Format](https://www.dotnetperls.com/datetime-format)

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-11-18T02:07:58.753

使用 String.Format() 的另一个选项

```
string.Format("{0:HH:mm:ss tt}", DateTime.Now) 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-11-17T21:15:46.300

带有 AM/PM 指示符的当前时间：

```
DateTime.Now.ToString("hh:mm:ss tt", System.Globalization.DateTimeFormatInfo.InvariantInfo)
DateTime.Now.ToString("hh:mm:ss.fff tt", System.Globalization.DateTimeFormatInfo.InvariantInfo) 
```

当前时间使用 0-23 小时表示法：

```
DateTime.Now.ToString("HH:mm:ss", System.Globalization.DateTimeFormatInfo.InvariantInfo)
DateTime.Now.ToString("HH:mm:ss.fff", System.Globalization.DateTimeFormatInfo.InvariantInfo) 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2008-11-17T21:10:27.137

```
DateTime.Now.TimeOfDay 
```

或者

```
DateTime.Now.ToShortTimeString() 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-10-22T19:57:55.300

开始了：

```
 DateTime time = DateTime.Now;
 Console.WriteLine(time.ToString("h:mm:ss tt")); 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2017-12-11T13:22:57.270

```
DateTime.Now.ToString("yyyy-MM-dd h:mm:ss tt"); 
```

只需尝试一下即可满足您的需求

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2012-05-17T04:35:46.527

这个会更好，试试这个

```
 DateTime.Now.ToShortTimeString(); 
```

为此，您无需指定时间格式。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-11-17T21:09:38.310

`Datetime.TimeOfDay`返回 a`TimeSpan`并且可能是您要查找的内容。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-11-17T21:08:58.420

获取当前日期和时间，然后只使用它的时间部分。查看[MSDN 文档](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)中格式化日期时间字符串的可能性。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-01-15T18:59:02.457

这可能是一个可能的解决方案：

```
DateTime now = DateTime.Now;
string time = now.ToString("T"); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-10-08T13:20:42.110

我认为这段代码会解决你的问题

```
DateTime.Now.ToString("HH:mm") 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-01-02T06:55:57.057

```
var CurDate= DateTime.Now;
CurDate.Hour;
CurDate.Minute;
CurDate.Millisecond 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-02-03T09:22:16.530

要计算当前日期时间：

```
DateTime theDate = DateTime.UtcNow;

string custom = theDate.ToString("d");

MessageBox.Show(custom); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-01-15T18:45:26.840

```
MyEmail.Body = string.Format("The validation is done at {0:HH:mm:ss} Hrs.",DateTime.Now); 
```

可以使用`{0:HH:mm:ss}`, `{0:HH:mm:ss.fff}`, `{0:DD/mm/yyy HH:mm:ss}`, 等等...

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-09-24T18:54:22.677

我也在尝试这个，发现这些页面也很有帮助。首先是主类... [https://msdn.microsoft.com/en-us/library/system.datetime(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.datetime(v=vs.110).aspx)

现在 ToString 方法的一些说明符格式... [https://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo(v=vs.110).aspx)

例子：

```
using System;

namespace JD
{
    class Program
    {
        public static DateTime get_UTCNow()
        {
            DateTime UTCNow = DateTime.UtcNow;
            int year = UTCNow.Year;
            int month = UTCNow.Month;
            int day = UTCNow.Day;
            int hour = UTCNow.Hour;
            int min = UTCNow.Minute;
            int sec = UTCNow.Second;
            DateTime datetime = new DateTime(year, month, day, hour, min, sec);
            return datetime;
        }

        static void Main(string[] args)
        {
            DateTime datetime = get_UTCNow();            

            string time_UTC = datetime.TimeOfDay.ToString();
            Console.WriteLine(time_UTC);

            Console.ReadLine();

        }
    }
} 
```

我把那个 TimeOfDay 方法扔在那里只是为了表明你得到默认的 24 小时时间，如“从午夜开始的时间”

你可以使用我的 geter 方法（）；:-D

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-01-04T17:53:15.167

很简单`DateTime.Now.ToString("hh:mm:ss tt")`

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-17T21:16:10.480

这将仅以 24 小时格式显示当前时间：

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(DateTime.Now.ToLongTimeString().ToString());
        Console.WriteLine(DateTime.Now.ToShortTimeString().ToString());
        Console.ReadLine();
    }
} 
```

问候
K

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-02-25T12:42:02.277

使用下面的代码

```
DateTime.Now.ToString("h:mm:ss tt") 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-05-02T07:02:54.703

就我而言，我使用下面的代码从 DateTime 单独获取时间。

```
var currentDateTime = DateTime.Now; 
var currentTimeAlone = new TimeSpan(currentDateTime.Hour, currentDateTime.Minute,    currentDateTime.Second); 
Console.WriteLine(currentTimeAlone); 
```

希望它对某人有所帮助。:)

* * *

## 回答 #21

> 赞同：-6
> 
> 时间：2009-01-05T14:02:14.687

试试这个。它在 3tier Architecture Web Application 中为我工作。

```
"'" + DateTime.Now.ToString() + "'" 
```

请记住插入查询中的单引号。

例如：

```
string Command = @"Insert Into CONFIG_USERS(smallint_empID,smallint_userID,str_username,str_pwd,str_secquestion,str_secanswer,tinyint_roleID,str_phone,str_email,Dt_createdOn,Dt_modifiedOn) values ("
 + u.Employees + ","
 + u.UserID + ",'"
 + u.Username + "','"
 + u.GetPassword() + "','"
 + u.SecQ + "','"
 + u.SecA + "',"
 + u.RoleID + ",'"
 + u.Phone + "','"
 + u.Email + "','"
 + DateTime.Now.ToString() + "','"
 + DateTime.Now.ToString() + "')"; 
```

`DateTime`在行尾插入。

# c - 嵌入式软件的 Mips 计算

> ID：296922
> 
> 赞同：6
> 
> 时间：2008-11-17T21:06:59.890
> 
> 标签：c, performance, embedded, measurement

客户最近（并且反复）向我询问运行我们的软件所需的[MIPS 。](http://en.wikipedia.org/wiki/Instructions_per_second)通常我们能够通过向客户解释这实际上取决于 cpu/os/hw（我们的软件是高度可移植的）和/或用例（即我们的软件如何使用）来摆脱这个问题。

但我有最后一个，不仅非常固执，而且还提供了固执的充分理由。:) 他想要估价，因为他不确定自己是否有足够的能力运行我们的软件，所以在估价之前购买软件是不合逻辑的。（我们无法提供演示/评估，因为在此特定平台上运行需要大量工作。）

现在的问题是：有人在使用任何软件的任何硬件上都有过此类任务的经验吗？任何现实生活中的例子都会非常有帮助。我可以选择在许多操作系统和许多硬件上运行我们的软件。因此，如果您知道在任何硬件上进行此类估算的任何工具，那么我就有机会使用它，或者至少有一个想法。要知道我只知道如何测量[eCosPro OS](http://www.ecoscentric.com/)上的 CPU 负载。

**编辑：**

使用探针实际上是一个好主意，假设我可以创建一个控制环境，其中只有我的软件在运行我可以计算的所有指令都是我的，我猜探针有一个接口可以做到这一点。实际上，我有一些不同的硬件调试器，如果有人有经验如何做这将非常好，无论如何我明天将阅读一些文档，并希望能在这个方向找到一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T02:03:41.257

好的，您意识到这充满了免责声明和警告——CPU 速度、内存速度、缓存命中、MMU 页表刷新、总线争用等......（如果它是一个重型嵌入式系统）所有这些因素都对决策有重要影响……

**话虽如此**....我会做的是这个。获得一个实时操作系统（留在我身边），也许像 FreeRTOS（免费，真是惊喜）或 u/C-OS-II（不是免费用于商业用途，可能是 3000 美元）。这些内核允许您检测代码以计算空闲 CPU 周期（空闲任务自旋循环）。

因此，在你们同意的板上（例如 MPC860 板、ARM7 板等）上运行您的整个应用程序（或客户的应用程序）作为唯一（非空闲）任务。通过 RTOS 测量板上的 CPU 百分比。（例如“在以 60 MHz 运行的 Flibber 板上，我们的应用程序使用了 12% 的 CPU。”）

如果没有他们给你更多，或者反之亦然，这听起来对他们来说是一个相当合理的长度。

好消息是，一旦你完成了这项工作，你就可以将工作重新用于其他目标和/或板，也许这些数字将帮助你增加销售额和/或调整/优化你的软件。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T21:58:38.943

您是否有可以为您提供指令计数的模拟器或调试器探针？您甚至不需要为正确的目标平台执行此操作，只需粗略的指令计数即可。

如果其他一切都失败了，请在您可以访问的任何平台上运行它，使用您的-MHz/客户的-MHz 的商来扩展运行时间。这应该可以让您对客户将体验到的运行时间有一个**非常粗略的估计。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T22:31:21.793

I/S 是具有操作系统的系统的“弱”指标。

在本质上，你必须做的是

1.  找出最坏情况下的指令路径并计算执行所需的周期数（这意味着阅读该 CPU 的程序集并查看告诉您周期数的 CPU 手册）。
2.  现在找出你的实时约束。
3.  然后你将#1 用于最坏情况的循环。向上/向下调整 CPU，直到它适合实时约束。
4.  添加一个软糖因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T22:59:49.273

您需要做的第一件事是提出一些正确操作的标准。这在很大程度上取决于应用程序的性质——您的标准可能包括“必须在 3 毫秒内执行代码 x”，或“必须具有低于 100 毫秒的延迟”。任何与定量测量无关的标准都将是困难的，因为它是主观的。

找到正确操作的标准将使您能够找到代码的关键部分。请记住，这些可能会在极端情况下而不是正常操作中找到。

如果代码的这些关键部分很小，那么计算目标平台的指令将相对简单。如果你有一个模拟器可能会更容易。（取决于你可能需要做一个模拟以确保它被执行的代码，但如果你有一大块代码要分析，这可能仍然比计算指令更容易）

如果您的关键代码很大，那么您可能需要执行类似于 JesperE 的建议的操作。除非您的应用程序针对的是对价格非常敏感的行业，否则客户可能会愿意接受计算中的一些松懈——因此，高估比低估您的 CPU 需求要好。

我与 JesperE 的建议不同的地方是建议不要专注于 MHz，而是关注目标的实际 MIPS。例如，在测试平台上编译和执行你的代码——如果你有一个分析器可能会更好。然后为客户的目标编译您的代码，并对生成的可执行文件中的指令数量进行粗略比较。然后，您可以将此比率以及测试和目标处理器的相对 MIPS 合并到执行时间的计算中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T23:31:53.200

你说你的软件是高度可移植的，所以我的建议是在处理器架构、处理器指令集和内存/外围总线类型最接近的平台上运行软件。测量必须实时运行的最长例程，然后估计它将在其架构上运行多长时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T20:48:24.643

大多数现代调试器使您能够查看所使用的指令，例如；RVDS。另外，您可以使用处理器仿真器来了解所消耗的指令，而无需在平台上实际运行（如果您的代码是独立的，例如编解码器或加密模块并且不依赖于板子） - 请注意，这将为您提供说明，不是循环。周期将受到您的板详细信息的影响（例如；等待状态、内存访问等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-15T07:57:23.100

在我使用的两种处理器架构（MSP430F5X 和 AVR32）上，处理器中内置了一个硬件周期计数寄存器。我通常有一个方案，当处理器不忙时，它被置于低功耗空闲状态，处理器内核停止。然后有两个选项可以计算实际的处理器负载。我可以在周期性定时器函数中设置断点并读取执行的处理器周期数，也可以通过在操作开始和结束时读取此寄存器来检测特定进程。处理器空闲时间不会出现在循环计数中，因为此时 CPU 会暂停。

您没有指定您的处理器架构，但可能存在此功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-04T12:17:11.323

[RapiTime](http://www.rapitasystems.com/products/RapiTime)声称可以为您的目标提供最坏情况执行时间的概率估计。我没有亲自使用它，但看过他们的演示文稿......

如果您的目标与您的客户的目标足够相似，您可能可以对其进行缩放以估计他们平台上的 WCET。然后，他们可以将其与当前系统的“空闲”时间进行比较。

# java - Java 浮动许可服务器 API？

> ID：296928
> 
> 赞同：4
> 
> 时间：2008-11-17T21:08:03.523
> 
> 标签：java, api, licensing

没有滚动你自己的。那里一定有什么东西。FlexLM/FlexNet 定价过高，不适用于我们这样的公司。RLM 也是如此。我希望有一种产品叫做 LUM，但 IBM 不再许可 API。那么还有什么可用的呢？或者你有任何已知的方法来获得 LUM 吗？

请帮助，我一直在审查和搜索一年多，只是找不到合适的解决方案。也许每个人都只是创造自己的，我们宁愿不这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T21:22:30.343

这里有一个产品——SoftwarePassport：[http](http://www.siliconrealms.com/) ://www.siliconrealms.com/ 他们购买了 Armadillo，它曾经是一种廉价的软件保护和许可方案。价格比当时高，但我敢打赌它仍然低于 FlexLM。

作为许可软件的用户和开发者，我确实有一个关于许可的建议。实施“软截止”，以便在许可机制失败（或许可到期）时，您的客户不会陷入困境。为他们提供一些继续运行的方法，以便有足够的时间来解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T14:00:19.717

还有[Reprise](http://www.reprisesoftware.com/)，由最初编写 FlexLM 的人编写。它被吹捧为比原版更便宜、更好。

我还没有尝试过，因为我正在做与 OP 相同的搜索。

# math - 我怎样才能最好地填补我数学知识的空白？

> ID：296932
> 
> 赞同：13
> 
> 时间：2008-11-17T21:08:28.233
> 
> 标签：math

每隔一段时间，我就会觉得我的数学知识（因为它与软件开发领域有关）有一些差距。我是一个受过教育的人。我有大学学位。我一直很喜欢学习，这就是为什么我想尝试填补这些空白。

我的工作是金融行业，我觉得我们所做的许多大规模数字运算任务可能会变得更有效率，如果我能更好地掌握其中的数学/逻辑或概念的话这可以用作捷径。

你有什么建议吗？您发现的书籍对此有帮助吗？视频讲座？

编辑：我应该注意我的学位是计算机科学，所以我熟悉一些相关的数学领域。我只是不确定如何最好地复习它们或完善我已经知道的内容:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T21:13:54.743

对编程非常有用的数学领域之一是离散数学。一个很好的参考是关于“计算机科学数学”的麻省理工学院开放课件课程，在[这里](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-042JMathematics-for-Computer-ScienceFall2002/Readings/index.htm)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T21:34:04.797

按重要性排序，我想说：

*   代数
*   组合学
*   统计与概率
*   矢量数学
*   矩阵数学
*   结石

在我看来，代数对于任何体面的程序员都是必不可少的，因为它构成了变量表示和表达式评估（函数、交换性和操作传递性等）的基础。

组合学对于各种图形算法（遍历图形中的所有节点、查找最短路径等）都是必不可少的。在几乎任何编程环境中，了解组合和排列的方式都至关重要。

接下来是统计数据，特别是如果你想进入人工智能或机器学习领域。对于程序员来说，统计数据可能是最划算的数学知识领域。在大多数情况下，您不需要深入研究繁重的内容，例如多元回归。仅仅知道如何（以及在​​什么情况下）快速计算平均值、中位数、众数、标准差、误差范围、置信区间和条件概率对于许多机器学习应用程序非常有用。

矢量数学在各种信息建模应用程序（n 维矢量空间模型是推理文档语义的一种非常方便的方式）以及各种 3D 图形应用程序中都很重要。

就其应用（人工智能、信息模型、3D 等）而言，矩阵数学很像向量数学，但它有点棘手，因为它增加了另一个维度。（矩阵数学是我自己的致命弱点；我绝对可以复习一下。）

微积分对于任何从事科学计算和模拟的人来说都是必不可少的。

玩得开心！

* * *

编辑：

我认为复习数学知识的最好方法是开展一个使用这些知识的项目。例如，如果您想学习一些统计数据（例如，真正学习它，这样您就可以在不查找它们的情况下快速说出所有公式），那么您可能会对分析来自[Netflix Prize](http://www.netflixprize.com/index)竞赛的数据集感兴趣。

该数据集包括来自 Netflix 用户数据库的 1 亿多条记录，为您尝试实施其中一些数学密集型算法提供了巨大的机会。

至于实际的参考资料，我发现维基百科绰绰有余。例如，在我最近的一个项目中，我反复提到了它关于[核密度估计](http://en.wikipedia.org/wiki/Kernel_density_estimation)和[向量场](http://en.wikipedia.org/wiki/Vector_field)的一些文章。

关于核心数学（因为我几乎完全是自学的）（对我来说）令人生畏的事情是符号。所有这些希腊字母都让我头晕目眩。但是，如果您多次阅读这些文章（并在谷歌上搜索“math sigma symbol”之类的短语），那么将它们所谈论的内容拼凑起来并不难。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T21:19:54.310

你应该知道[概率和统计](https://rads.stackoverflow.com/amzn/click/com/013603313X)。我在本科物理课程中经历了这一点。斯坦福提供免费的数学和物理讲座，我想你仍然可以[在这里](http://itunes.stanford.edu/)访问它们（许多大学现在都在做这个公共[视频讲座](http://videolectures.net/)的想法）。以及该网站的一位创建者刚刚推荐的 [东西。](https://rads.stackoverflow.com/amzn/click/com/0716710455)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T21:15:45.380

它可能没有直接关系，但[Project Euler](http://projecteuler.net/)非常适合让您以数学方式思考。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T21:22:52.917

[具体数学。](https://rads.stackoverflow.com/amzn/click/com/0201558025) 这是 Knuth 的一本大学教科书，强调在与程序员相关的领域解决实际问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T21:14:14.897

*   回顾你的大学数学笔记。看看你记得什么，不记得什么。尝试重做一些作业。
*   一旦你弄清楚哪些领域需要重新审视，就从那里开始。使用[OCW](http://ocw.mit.edu/OcwWeb/web/home/home/index.htm "麻省理工学院开放课件")或其他免费在线课程材料来扩展您的知识。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-17T21:15:24.117

我会研究大型大学对其计算机科学学位的课程要求。那里通常有正确的数学组合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-17T21:56:57.370

为什么不在本地大学上几节课呢？也许您工作中的一些极客可能知道您应该参加哪些课程？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-26T02:28:43.620

还有一个 - 这是 Steven Skiena 的离散数学课程的一组[视频和音频讲座](http://www.cs.sunysb.edu/~algorith/math-video/)。他以编写[《算法设计手册》](http://books.google.com/books?id=6U7I4577l00C&dq=skiena+algorithm+design+manual&printsec=frontcover&source=bn&hl=en&sa=X&oi=book_result&resnum=5&ct=result)（又名《算法漫游指南》）而闻名，他的数学课程也相当不错。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T20:00:49.147

拿出一本书，比如好的离散数学教科书，每天开始做练习。做所有这些。

用另一本书重复。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-17T21:29:09.907

作为一个主修数学的人，我认为数学最好向一位好老师学习，有一些成功的压力（比如学费）。我发现自学计算很容易，但数学要难得多。我仍然非常喜欢它。

# ruby-on-rails - How show hide image in paperclip when no image present

> ID：296952
> 
> 赞同：39
> 
> 时间：2008-11-17T21:13:59.360
> 
> 标签：ruby-on-rails, ruby, plugins, paperclip

How can I prevent the image tag that calls the associated image from displaying if no image is associated with the record?

```
<%= image_tag @agent.avatar.url %> 
```

...gives me the text "Missing" if there is no image associated with that agent. I want to test to see there is an image available first, then render the above tag if the test returns true.

Better yet, is there anyway for me to specify a default image if no image is specifically provided?

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-17T23:22:25.700

I use the following to find wether a model has an associated attachment:

```
<% if @agent.avatar.file? %>
  <%= image_tag @agent.avatar.url(:normal) %>
<% else %>
  No attachment available!
<% end %> 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2010-11-16T18:36:59.340

If avatar has multiple sizes:

```
has_attached_file :avatar, 
                  :styles => {:small => '30x30#', :large => '100x100#'}, 
                  :default_url => '/images/missing_:style.png' 
```

for Rails 3:

```
has_attached_file :avatar, 
                  :styles => {:small => '30x30#', :large => '100x100#'}, 
                  :default_url => '/assets/images/missing_:style.png' 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-11-17T21:24:17.670

Okay, so I got one part of it.

Specifying a default image happens in the model

```
has_attached_file :avatar, :default_url => '/images/brokers/agents/anonymous_icon.jpg' 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2010-03-02T14:15:14.020

Few bytes less:

```
<% if @agent.avatar? %>
  <%= image_tag @agent.avatar.url(:normal) %>
<% else %>
  No attachment available!
<% end %> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-18T09:44:07.817

It is better to use :default_url rather than conditions.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-20T10:02:05.627

If a default_url has been specified in the model you can use the method present? to check if the url is the default or an uploaded one.

```
<% if @agent.avatar.present? %>
  <%= image_tag @agent.avatar.url(:normal) %>
<% else %>
  No attachment available!
<% end %> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-19T16:35:59.863

You can use this

```
user.photo.exists?(:medium). 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-14T04:22:22.697

I also had the same problem before, but solved it by using:

```
<% if @post.image.exists? %>
<%= image_tag @post.image.url %>
<% end %> 
```

# perl - 在 Perl 中 shift() 有什么作用？

> ID：296964
> 
> 赞同：74
> 
> 时间：2008-11-17T21:16:35.190
> 
> 标签：perl, built-in

以下行可能意味着什么？

```
my $x = shift; 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-17T21:27:25.853

`shift()`是一个内置的 Perl 子程序，它接受一个数组作为参数，然后返回并删除该数组中的第一项。通常的做法是通过`shift`调用获取传递给子例程的所有参数。例如，假设您有一个带有`foo`三个参数的子例程。将这些参数分配给局部变量的一种方法是`shift`：

```
sub foo() {
  my $x = shift;
  my $y = shift;
  my $z = shift;
  # do something
} 
```

这里的困惑是，似乎 shift 没有作为参数传递给数组。事实上，它被隐式传递给“默认”数组，它`@_`位于子程序内部或子程序`@ARGV`外部。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-17T21:24:21.117

该`shift`函数从数组中删除第一个元素，并将其返回。数组缩短了一个元素。

默认数组（如果没有作为参数给出）是`@_`你在一个函数中，或者`@ARGV`你在文件范围内。

所以在这种情况下`$x`，要么设置为第一个函数参数，要么设置为第一个命令行参数。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-18T05:25:47.153

在 Perl 中，如果您没有显式指定参数，许多方法会使用默认变量 (`$_`和)。`@_`您的代码与以下内容相同：

```
my $x = shift @_; 
```

正如 PullMonkey 之前指出的，在子例程中，`@_`包含传递给该子例程的参数（如 参考资料中所述[`perlsub`](http://perldoc.perl.org/perlsub.html#DESCRIPTION)）。`shift`将从中删除第一个参数值`@_`并将其存储在中`$x`，因此`$_[0]`现在将为您提供传递给子例程的**第二个参数。**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T21:17:57.980

这通常是一个习惯用法： $x 是分配给传递给子例程的第一个参数的局部变量，尽管如此。

```
my ($x) = @_; 
```

可能更清楚（并且它不会修改参数列表）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-21T02:59:19.817

用外行的话来说，从非常高级的角度来看，*[shift](https://perldoc.perl.org/perlfunc.html#shift-ARRAY)*是取数组的第一个元素（最左边的部分），而相反的是*[pop](https://perldoc.perl.org/perlfunc.html#pop-ARRAY)*，它是取数组的最后一个元素（最右边的部分）。

```
我的@array1=(5,6,7,8,9);
我的 $x = shift @array1;
打印 "$x\n"; # 5
打印“@array1\n”；# 6 7 8 9

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T21:25:40.133

如果您在子例程中，则此行将`shift`打开`@_`（传入的参数）。数组中的第一项也是
如此。`$x``popped``@_`

所以通常你会看到`$x = shift if @_;`

# iphone - CALayer的动画结束回调？

> ID：296967
> 
> 赞同：74
> 
> 时间：2008-11-17T21:17:15.890
> 
> 标签：iphone, core-animation

我想知道CALayer中动画的回调在哪里（或者是否有任何东西）。具体来说，对于隐含的动画，比如改变框架、位置等。在 UIView 中，您可以执行以下操作：

```
[UIView beginAnimations:@"SlideOut" context:nil];
[UIView setAnimationDuration:.3];
[UIView setAnimationDelegate:self];
[UIView setAnimationDidStopSelector:@selector(animateOut:finished:context:)];
CGRect frame = self.frame;
frame.origin.y = 480;
self.frame = frame;
[UIView commitAnimations]; 
```

具体来说，这`setAnimationDidStopSelector`是我想要的 CALayer 中的动画。有这样的吗？

TIA。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-06-30T03:28:04.153

您可以使用 CATransaction，它有一个完成块处理程序。

```
[CATransaction begin];
CABasicAnimation *pathAnimation = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
[pathAnimation setDuration:1];
[pathAnimation setFromValue:[NSNumber numberWithFloat:0.0f]];    
[pathAnimation setToValue:[NSNumber numberWithFloat:1.0f]];
[CATransaction setCompletionBlock:^{_lastPoint = _currentPoint; _currentPoint = CGPointMake(_lastPoint.x + _wormStepHorizontalValue, _wormStepVerticalValue);}];
[_pathLayer addAnimation:pathAnimation forKey:@"strokeEnd"];
[CATransaction commit]; 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-11-17T21:41:31.113

我回答了我自己的问题。您必须像这样添加动画`CABasicAnimation`：

```
CABasicAnimation* anim = [CABasicAnimation animationWithKeyPath:@"frame"];
anim.fromValue = [NSValue valueWithCGRect:layer.frame];
anim.toValue = [NSValue valueWithCGRect:frame];
anim.delegate = self;
[layer addAnimation:anim forKey:@"frame"]; 
```

并实现委托方法`animationDidStop:finished:`，你应该很高兴。谢天谢地，这个功能存在！:D

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2017-11-28T16:45:53.773

### 对于 2018 年...

再简单不过了。

不要忘记，`[weak self]`否则你会崩溃的。

```
func animeExample() {

    CATransaction.begin()

    let a = CABasicAnimation(keyPath: "fillColor")
    a.fromValue, duration = ... etc etc

    CATransaction.setCompletionBlock{ [weak self] in
        self?.animeExample()
        self?.ringBell()
        print("again...")
    }

    someLayer.add(a, forKey: nil)
    CATransaction.commit()
} 
```

### 关键提示：

您*必须*`setCompletionBlock` *在*`someLayer.add`. _ _

顺序很关键！这是iOS的怪癖。

在示例中，它只是再次调用自身。

当然，你可以调用任何函数。

* * *

***任何刚接触 iOS 动画的人的注意事项：***

1.  “键”（如`forKey`）是**无关紧要的，很少使用**。将其设置为零。如果要设置它，请将其设置为“任何字符串”。

2.  “keyPath”实际上**是实际的“你正在制作动画的东西”**。它实际上是**图层的属性，**例如“不透明度”、“背景颜色”等，但***写成字符串***。（您不能只在此处输入“任何您想要的”，它必须是图层实际属性的名称，并且必须是可动画的。）

重复一遍：“key”（很少使用 - 只需将其设置为 nil）和“keyPath”彼此完全无关。

您经常会看到将这两者**混淆**的示例代码（由于愚蠢的命名），这会导致各种问题。

* * *

请注意，您可以交替使用委托，但仅使用完成块要容易得多，因为 (A) 它是独立的，可以在任何地方使用，并且 (B) 您通常有多个动画，在这种情况下使用代表很无聊。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2016-09-24T00:43:17.793

这是基于 bennythemink 解决方案的 Swift 3.0 中的答案：

```
 // Begin the transaction
    CATransaction.begin()
    let animation = CABasicAnimation(keyPath: "strokeEnd")
    animation.duration = duration //duration is the number of seconds
    animation.fromValue = 0
    animation.toValue = 1
    animation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionLinear)
    circleLayer.strokeEnd = 1.0

    // Callback function
    CATransaction.setCompletionBlock { 
        print("end animation")
    }

    // Do the actual animation and commit the transaction
    circleLayer.add(animation, forKey: "animateCircle")
    CATransaction.commit() 
```

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2014-10-30T01:29:46.063

用这个垃圾浪费了4个小时，只是为了淡入淡出。注意代码中的注释。

```
 [CATransaction begin];
    CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"opacity"];
    animation.duration = 0.3;
    animation.fromValue = [NSNumber numberWithFloat:0.0f];
    animation.toValue = [NSNumber numberWithFloat:1.0f];
    animation.removedOnCompletion = NO;
    animation.fillMode = kCAFillModeBoth;
  ///  [box addAnimation:animation forKey:@"j"]; Animation will not work if added here. Need to add this only after the completion block.

    [CATransaction setCompletionBlock:^{

        CABasicAnimation *animation2 = [CABasicAnimation animationWithKeyPath:@"opacity"];
        animation2.duration = 0.3;
        animation2.beginTime = CACurrentMediaTime()+1;
        animation2.fromValue = [NSNumber numberWithFloat:1.0f];
        animation2.toValue = [NSNumber numberWithFloat:0.0f];
        animation2.removedOnCompletion = NO;
        animation2.fillMode = kCAFillModeBoth;
        [box addAnimation:animation2 forKey:@"k"];

    }];

    [box addAnimation:animation forKey:@"j"];

    [CATransaction commit]; 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-09-25T21:41:06.227

对于在 Google 上找到此页面的人，请注意：您确实可以通过将动画对象的“委托”属性设置为将接收通知的对象并在该对象的 .m 中实现“animationDidStop”方法来完成工作文件。我刚刚尝试过，它有效。我不知道为什么 Joe Blow 说这不是正确的方法。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2018-01-02T11:41:15.313

在**Swift 4+**中，我刚刚添加`delegate`为

```
class CircleView: UIView,CAAnimationDelegate {
...

let animation = CABasicAnimation(keyPath: "strokeEnd")
animation.delegate = self//Set delegate 
```

**动画完成回调 -**

```
func animationDidStop(_ anim: CAAnimation, finished flag: Bool) {
     print("Animation END")
  } 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2019-04-11T00:51:41.380

**斯威夫特 5.0**

```
func blinkShadow(completion: @escaping (() -> Void)) {
    CATransaction.begin()
    let animation = CABasicAnimation(keyPath: "shadowRadius")
    animation.fromValue = layer.shadowRadius
    animation.toValue = 0.0
    animation.duration = 0.1
    animation.autoreverses = true
    CATransaction.setCompletionBlock(completion)
    layer.add(animation, forKey: nil)
    CATransaction.commit()
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-19T18:54:23.943

您可以在设置 CAAnimation 对象时设置给定动画的名称。在animationDiStop:finished 中，只需比较提供的Animation 对象的名称，即可根据动画执行特定的功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-29T21:38:26.553

对于 2020 年...

ValueAnimator，更新你的自定义属性。

[https://github.com/Only-IceSoul/ios-jjvalueanimator](https://github.com/Only-IceSoul/ios-jjvalueanimator)

```
 class OnAnimationListener : AnimatorListener {

        weak var s : ViewController?

        init(_ ins: ViewController) {
            s = ins
        }
        func onAnimationStart(_ animation: Animator) {}
        func onAnimationEnd(_ animation: Animator) {

           print("end")
           s?.label.text = "end"

        }
        func onAnimationCancel(_ animation: Animator) {}
        func onAnimationRepeat(_ animation: Animator) {}

    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-08T12:36:25.483

我在 CAAnimation 上写了一个扩展，它给你一个开始和一个结束的结束，因为我厌倦了实现委托，特别是对于多个动画，你必须做一些可怕的事情，比如使用动画的键来查看哪个动画是调用代表 - 使这种事情变得非常容易。

它在 GitHub 上 -[动画动作](https://github.com/franklynw/AnimationActions)

希望对某人有用！

# git - 自动存储

> ID：296971
> 
> 赞同：9
> 
> 时间：2008-11-17T21:18:49.257
> 
> 标签：git, version-control

[http://ftp.newartisans.com/pub/git.from.bottom.up.pdf](http://ftp.newartisans.com/pub/git.from.bottom.up.pdf)中的**最后一个链接：存储和引用日志**部分建议经常存储以获取正在进行的工作的快照。作者甚至建议您可以使用 cron 作业定期存储您的工作，而无需手动进行存储。

> stash 的美妙之处在于它可以让您将不显眼的版本控制应用于您的工作流程本身：即每天工作树的各个阶段。如果您愿意，您甚至可以定期使用 stash，例如以下快照脚本：
> 
> ```
> $ cat <<EOF > /usr/local/bin/git-snapshot
> #!/bin/sh
> git stash && git stash apply
> EOF
> $ chmod +x $_
> $ git snapshot 
> ```
> 
> 没有理由不能每小时从 cron 作业运行它，同时每周或每月运行 reflog expire 命令。

这种方法的问题是：

1.  如果您的工作副本没有更改，“git stash apply”将导致您的最后一个 stash 应用于您的工作副本。
2.  在 cron 作业执行和用户处理工作副本之间可能存在竞争条件。例如，“git stash”运行，然后用户打开文件，然后执行脚本的“git stash apply”。

有人对使这种自动存储工作更可靠有什么建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-17T21:38:31.260

出于您引用的原因，我当然不会像那篇文章（否则很棒）中描述的那样设置自动存储。

我更喜欢使用预期使用的存储，我在工作时故意存储并应用更改。对于定期备份，我使用适当的备份解决方案。在我看来，Git 不能替代备份解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T18:01:19.180

git stash 实际上只是一个小 shell 脚本，它创建一个未在任何分支中引用的提交。您可以在没有竞争条件的情况下模拟此行为：

```
#!/bin/sh
GIT_DIR=$(git rev-parse --git-dir) || exit
ref_stash=refs/stash

w_commit=$(git stash create) # creates a commit for the wip

# gather some info
head=$(git log --no-color --abbrev-commit --pretty=oneline -n 1 HEAD --)
branch=$(git symbolic-ref -q HEAD)
branch=${branch#refs/heads/}
msg=$(printf 'WIP on %s: %s' "$branch" "$head")

# Make sure the reflog for stash is kept.
: >>"$GIT_DIR/logs/$ref_stash"

git update-ref -m "$msg" $ref_stash $w_commit 
```

脚本可能需要一些润色，但我希望你能明白 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-12T16:46:27.860

对于我的个人用途（在 3 年内使用它），我在别名配置部分添加了这一行：

```
s = !sh -c \"git stash save | grep 'No local changes to save' && git $* || (git $* && git stash pop) \" 
```

然后，我可以通过在前面添加一个“s”来运行每个带有自动存储的 git 命令。就像你的情况一样：git s snapshot

也许为时已晚，但希望有一天它会对某人有所帮助......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T10:46:28.257

在存储管理之前，我更喜欢分支管理：看看[这里](https://stackoverflow.com/questions/758916/how-to-make-subversion-or-any-program-perform-periodic-commits/760092#760092)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-13T01:25:16.503

对于备份内容，我建议使用类似于 dropbox.com 的在线备份服务。您实际上不需要做任何事情，它只会跟踪您在一天中所做的所有更改。

我为我所有的 git 存储库启用了它，这有助于我专注于手头的实际任务。

# sql - SQL 到 LINQ 工具

> ID：296972
> 
> 赞同：205
> 
> 时间：2008-11-17T21:19:37.023
> 
> 标签：sql, linq

有没有可以将 SQL 语法转换为 LINQ 语法的工具？

我只想用 join 等将基本查询重写为[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)。这会节省我很多时间。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-11-17T22:02:15.503

编辑 2020 年 7 月 17 日：我无法删除这个已接受的答案。以前很好，现在不行了。伙计们，当心真正的旧帖子。我正在删除链接。

[ **Linqer** ] 是一个 SQL 到 LINQ 的转换工具。它可以帮助您学习 LINQ 并转换您现有的 SQL 语句。

并非每个 SQL 语句都可以转换为 LINQ，但 Linqer 涵盖了许多不同类型的 SQL 表达式。Linqer 支持 .NET 语言 - C# 和 Visual Basic。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-17T22:29:08.773

我知道这不是您所要求的，但[LINQPad是自学](http://en.wikipedia.org/wiki/LINQPad)[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)的一个非常好的工具（而且它是免费的：o）。

当时间不重要时，我在上周左右一直在使用它，或者在[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)中使用查询窗口，并且我的 LINQ 技能越来越好。

它也是一个不错的小代码片段工具。它唯一的缺点是免费版本没有[IntelliSense](https://en.wikipedia.org/wiki/Intelli-sense)。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-11-02T02:22:48.050

[Bill Horst 的 - 将 SQL 转换为 LINQ](http://blogs.msdn.com/b/vbteam/archive/2007/11/19/converting-sql-to-linq-part-1-the-basics-bill-horst.aspx)是完成这项任务（以及[**LINQPad**](http://www.linqpad.net/)）的一个很好的资源。

[LINQ Tools](http://www.thinqlinq.com/default/LINQ-Tools.aspx)也有一个不错的工具列表，但我不相信还有其他东西可以做 Linqer 所做的事情。

* * *

一般来说，LINQ 是一种比 SQL 更高级别的查询语言，在尝试将 SQL 转换为 LINQ 时会导致翻译丢失。一方面，LINQ 发出成形结果和 SQL 平面结果集。这里的问题是，从 SQL 到 LINQ 的自动翻译通常必须执行比翻译更多的*音译*- 生成如何不编写 LINQ 查询的示例。因此，很少有工具（如果有的话）能够可靠地将 SQL 转换为 LINQ。类似于学习 C# 4，首先将 VB6 转换为 C# 4，然后研究生成的转换。

# git - 我如何告诉 git-svn 获取 repo 后创建的远程分支？

> ID：296975
> 
> 赞同：198
> 
> 时间：2008-11-17T21:19:50.253
> 
> 标签：git, git-svn

我`git-svn`用来处理我公司的中央 Subversion 存储库。我们最近在中央存储库中创建了一个新功能分支。

我如何告诉 Git 呢？当我运行时，`git branch -r`我只能看到当我`fetch`针对 Subversion 存储库运行以初始化我的 Git 存储库时存在的分支？

* * *

## 回答 #1

> 赞同：300
> 
> 时间：2009-09-16T03:23:25.443

您可以手动添加远程分支，

```
git config --add svn-remote.newbranch.url https://svn/path_to_newbranch/
git config --add svn-remote.newbranch.fetch :refs/remotes/newbranch
git svn fetch newbranch [-r<rev>]
git checkout -b local-newbranch -t newbranch
git svn rebase newbranch 
```

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2012-04-16T11:49:38.617

如果要跟踪所有远程 svn 分支，则解决方案很简单：

```
git svn fetch 
```

这将获取所有尚未获取的远程分支。

额外提示：如果您一开始只检查了主干，然后您想跟踪所有分支，则编辑`.git/config`为如下所示并重新运行`git svn fetch`：

```
[svn-remote "svn"]
        url = https://svn/path_to_repo_root/
        fetch = path_to_trunk:refs/remotes/git-svn
        branches = path_to_branches/*:refs/remotes/* 
```

关键点`url`应该指向存储库根目录，并且在`fetch`和中定义的路径`branches`应该是相对于`url`.

如果您只想获取特定分支而不是 ALL，则有一个很好的示例`git svn --help`：

```
[svn-remote "huge-project"]
        url = http://server.org/svn
        fetch = trunk/src:refs/remotes/trunk
        branches = branches/{red,green}/src:refs/remotes/branches/*
        tags = tags/{1.0,2.0}/src:refs/remotes/tags/* 
```

使用旧版本的`git-svn`. 指定分支后，您可能无法使用`git svn fetch`. 一种解决方法是添加更多`fetch`行，如下所示：

```
[svn-remote "huge-project"]
        url = http://server.org/svn
        fetch = trunk/src:refs/remotes/trunk
        fetch = branches/blue:refs/remotes/branches/blue
        fetch = branches/yellow:refs/remotes/branches/yellow
        branches = branches/{red,green}/src:refs/remotes/branches/* 
```

@AndyEstes 的另一种解决方法：在创建任何新指定的分支或标签之前编辑`.git/svn/.metadata`并更改`branches-maxRev`或修改的值。`tags-maxRev`完成此操作后，运行`git svn fetch`以跟踪新的 svn 远程分支。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2008-11-17T21:26:29.820

看来我只需要`git svn fetch`；不知何故，我说服自己会获取整个 repo 而不仅仅是更改。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-12-11T09:56:28.023

也许我以某种方式把它搞砸了，但我按照 vjangus 回答中的说明进行操作，它*几乎*奏效了。唯一的问题是 newbranch 似乎没有从主干分支。在 gitk 中，它本身就是一种“浮动”。它与树干没有共同的祖先。

解决方案是：

1.  查找创建分支之前在主干上发生的最后一次提交的 SHA1。
2.  在新分支上找到第一次提交的 SHA1（消息可能是“已创建新分支，从 trunk@12345 复制”或其他内容）
3.  `git diff-tree <sha1 from step 1> <sha1 from step 2>`-- 应该没有输出。如果有输出，您可能选择了错误的提交。
4.  `git checkout local-newbranch`然后`git rebase <sha1 from step 1>`。这将重新定位`local-newbranch`到新树上，但`remotes/newbranch`仍将断开连接。
5.  转到文件并对其进行编辑以包含与当前指向的旧提交相对应的*新*提交（在 rebased 上）`.git/refs/remotes/newbranch`的完整 SHA1 。（或者也许使用。谢谢你。）*`newbranch``git-update-ref refs/remotes/newbranch <new-SHA>`*
**   下一次，你`git svn dcommit`会`newbranch`收到一堆关于它更新一些日志的消息。我认为这很正常。*

 *我建议始终保持`gitk --all`打开状态并经常刷新它以跟踪您在做什么。我对 git 和 git svn 还是有点陌生​​，所以请建议改进​​这个方法。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-04-02T17:56:46.257

vjangus 回答的简化：

如果您在 SVN 中使用标准布局并且已经完成了通常的 svn init，那么 git-svn 将为您完成配置工作。只是：

1.  在 SVN 中查找分支副本修订
2.  使用 git-svn 获取该版本
3.  创建新的本地分支跟踪远程

一个例子。SVN 网址是`svn+ssh://gil@svn.myplace.com/repo`. 我正在寻找的 SVN 分支是`newbranch`. 本地 git 分支（跟踪远程`newbranch`）将是`git-newbranch`.

第 1 步：找到分支副本修订

```
    # svn log --stop-on-copy svn+ssh://gil@svn.myplace.com/repo/branches/newbranch | 尾-4
    r7802 | 某人 | 2014-03-21 18:54:58 +0000（2014 年 3 月 21 日星期五）| 1 行

    将 HEAD 分支到 newbranch
    -------------------------------------------------- ----------------------

```

所以 SVN 中的分支点是修订版 7802。

第 2 步：获取修订版

```
    # git svn 获取 -r 7802
    找到可能的分支点：svn+ssh://gil@svn.myplace.com/repo/trunk => svn+ssh://gil@svn.myplace.com/repo/branches/newbranch, 7801
    找到分支父级：（refs/remotes/trunk）8dcf3c5793ff1a8a79dc94d268c91c2bf388894a
    跟随父母与 do_switch
    成功关注父母
    r7802 = 9bbd4194041675ca5c9c6f3917e05ca5654a8a1e (refs/remotes/newbranch)

```

git-svn 完成了所有工作，现在知道了遥控器：

```
    # git 显示参考 | grep 新分支
    2df23af4733f36f5ad3c14cc1fa582ceeb3edb5c refs/remotes/newbranch

```

第 3 步：创建新的本地分支来跟踪远程分支：

```
    # git checkout -b git-newbranch -t newbranch
    签出文件：100% (413/413)，完成。
    设置分支 git-newbranch 以跟踪本地 ref refs/remotes/newbranch。
    切换到新分支“git-newbranch”

```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-02-11T13:46:01.263

我还没有找到有关此功能的任何文档，但看起来 git svn 配置支持多个获取条目。这样，您也可以单独添加分支，而无需在配置中添加另一个远程 svn 存储库条目，也无需使用通配符来获取某个目录的所有分支。

假设您的 SVN 树真的很讨厌有很多没有任何逻辑的分支，它们是如何定位的，例如，有包含更多分支的分支和子目录。

IE

```
trunk
branches
  -> branch1
  -> sub-dir1
    -> branch2
    -> branch3
  -> sub-dir2
    -> branch4
    -> sub-dir3
      -> branchX 
<... hundreds more ...> 
```

并且您只想手动挑选一些要包含到您的 git 存储库中的分支。

你可以先用没有任何额外分支的主干初始化你的存储库：

```
git svn clone -r 10000:HEAD https://svn.com/MyRepo myrepo --prefix=svn/ --trunk=trunk 
```

之后，您应该看到以下配置：

```
localhost: elhigu$ git config --get-regexp "svn-remote."
svn-remote.svn.url https://svn.com/MyRepo
svn-remote.svn.fetch trunk:refs/remotes/svn/trunk 
```

当您想从 MyRepo 获取新分支时，您可以通过以下方式将新的获取条目添加到配置中：

```
git config --add svn-remote.svn.fetch branches/sub-dir2/branch4:refs/remotes/svn/branches/sub-dir2/branch4 
```

或者您可以在 .git/config 中编辑相同的配置

要在将新分支添加到配置后获取新分支，只需运行：

```
git svn fetch -r 10000:HEAD 
```

**[编辑]**有时似乎有必要使用 --all 参数运行 fetch 以获取新添加的分支：

```
git svn fetch --all -r 10000:HEAD 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-25T10:48:45.470

[您可以尝试SubGit](http://subgit.com/)，而不是处理 git-svn 怪癖。

必须将 SubGit 安装到 Subversion 存储库中。之后可以使用标准的 git 工作流程，而不是使用特殊的 git-svn 命令：

1.  推送新的提交：

    git-svn：

    ```
    $ git commit
    $ git svn rebase
    $ git svn dcommit 
    ```

    子Git：

    ```
    $ git commit
    $ git push 
    ```

2.  获取传入的更改

    git-svn：

    ```
    $ git svn rebase 
    ```

    子Git：

    ```
    $ git pull [--rebase] 
    ```

3.  创建一个新分支：

    git-svn：

    ```
    $ git svn branch foo
    $ git checkout -b foo -t remotes/foo
    $ git commit
    $ git svn dcommit 
    ```

    子Git：

    ```
    $ git checkout -b foo
    $ git commit
    $ git push 
    ```

有关更多详细信息，请参阅[SubGit 文档](http://subgit.com/documentation/)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-02-17T12:30:58.873

为了添加对我有帮助的 vjangus 的回答，我还发现添加使用 git 移植在适当的点将分支连接到主干很有用 - 允许 git 查看历史记录并正确执行合并。

`.git/info/grafts`这只是在散列中添加一行的简单情况：

```
<initial branch commit> <parent commit in trunk> 
```

例如。

```
378b0ae0902f5c2d2ba230c429a47698810532e5 6c7144991381ce347d4e563e9912465700be0638 
```

归功于[http://evan-tech.livejournal.com/255341.html](http://evan-tech.livejournal.com/255341.html)

（我会将其添加为评论，但我没有足够的声誉。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-15T17:03:08.943

如果您不使用有效的布局签出，您将无法签出远程分支。

这就是我所做的：

```
git svn init -s <svn path with no trunk> local_repo
cd local_repo
git svn fetch 
## wait 
```

之后，您可以切换到远程分支：

```
git checkout --track -b branch_name branch_name 
```

然后您将自动切换到您的分支。

# c# - 什么时候使用 String.Format 与字符串连接更好？

> ID：296978
> 
> 赞同：125
> 
> 时间：2008-11-17T21:20:32.547
> 
> 标签：c#, .net, string

我有一小段代码正在解析索引值以确定 Excel 中的单元格输入。这让我想...

有什么区别

```
xlsSheet.Write("C" + rowIndex.ToString(), null, title); 
```

和

```
xlsSheet.Write(string.Format("C{0}", rowIndex), null, title); 
```

这个比那个好吗？为什么？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2008-11-18T17:45:49.437

我最初的偏好（来自 C++ 背景）是 String.Format。由于以下原因，我后来放弃了这个：

*   字符串连接可以说是“更安全”。它发生在我身上（我已经看到它发生在其他几个开发人员身上）删除一个参数，或者错误地弄乱了参数顺序。编译器不会根据格式字符串检查参数，并且最终会出现运行时错误（也就是说，如果您足够幸运，没有将它放在晦涩的方法中，例如记录错误）。通过串联，删除参数不太容易出错。您可能会争辩说出错的可能性很小，但它**可能会**发生。

~~- 字符串连接允许空值，`String.Format`不允许。写入“ `s1 + null + s2`”不会中断，它只是将 null 值视为 String.Empty。好吧，这可能取决于您的具体情况 - 在某些情况下，您希望出现错误而不是默默地忽略 null FirstName。然而，即使在这种情况下，我个人更喜欢自己检查空值并抛出特定错误，而不是从 String.Format 获得的标准 ArgumentNullException。~~

*   字符串连接性能更好。上面的一些帖子已经提到了这一点（没有实际解释原因，这决定了我写这篇文章:)。

想法是 .NET 编译器足够聪明，可以转换这段代码：

```
public static string Test(string s1, int i2, int i3, int i4, 
        string s5, string s6, float f7, float f8)
{
    return s1 + " " + i2 + i3 + i4 + " ddd " + s5 + s6 + f7 + f8;
} 
```

对此：

```
public static string Test(string s1, int i2, int i3, int i4,
            string s5, string s6, float f7, float f8)
{
    return string.Concat(new object[] { s1, " ", i2, i3, i4, 
                    " ddd ", s5, s6, f7, f8 });
} 
```

String.Concat 背后发生的事情很容易猜到（使用 Reflector）。数组中的对象通过 ToString() 转换为它们的字符串。然后计算总长度并只分配一个字符串（总长度）。最后，通过 wstrcpy 在一些不安全的代码中将每个字符串复制到结果字符串中。

原因`String.Concat`是不是更快？好吧，我们都可以看看`String.Format`在做什么——你会惊讶于处理格式字符串所需的代码量。最重要的是（我已经看到有关内存消耗的评论），`String.Format`在内部使用 StringBuilder 。就是这样：

`StringBuilder builder = new StringBuilder(format.Length + (args.Length * 8));`

因此，对于每个传递的参数，它保留 8 个字符。如果参数是一位数，那么太糟糕了，我们浪费了一些空间。如果参数是在 上返回一些长文本的自定义对象`ToString()`，那么甚至可能需要重新分配（当然是最坏的情况）。

与此相比，串联只会浪费对象数组的空间（不算太多，考虑到它是一个引用数组）。没有格式说明符的解析，也没有中间的 StringBuilder。两种方法都存在装箱/拆箱开销。

我选择 String.Format 的唯一原因是涉及本地化。将格式字符串放入资源中可以让您在不弄乱代码的情况下支持不同的语言（想想格式化值根据语言改变顺序的场景，即“在 {0} 小时和 {1} 分钟之后”在日语中可能看起来完全不同： ）。

* * *

总结一下我的第一篇（而且很长）的帖子：

*   对我来说最好的方法（就性能与可维护性/可读性而言）是使用字符串连接，而无需任何`ToString()`调用
*   如果您追求性能，`ToString()`请自己拨打电话以避免拳击（我有点偏向于可读性） - 与您问题中的第一个选项相同
*   如果您向用户显示本地化字符串（这里不是这种情况），`String.Format()`则有优势。

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2008-11-17T21:22:16.660

**在 C# 6 之前**

老实说，我认为第一个版本更简单 - 尽管我会将其简化为：

```
xlsSheet.Write("C" + rowIndex, null, title); 
```

我怀疑其他答案*可能*会谈到性能影响，但老实说，*如果存在的话，*它会是最小的——而且这个连接版本不需要解析格式字符串。

格式字符串非常适合用于本地化等目的，但在这种情况下，连接更简单并且效果也很好。

**使用 C# 6**

字符串插值使 C# 6 中的许多内容更易于阅读。在这种情况下，您的第二个代码变为：

```
xlsSheet.Write($"C{rowIndex}", null, title); 
```

这可能是最好的选择，IMO。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T21:34:16.667

我认为第一个选项更具可读性，这应该是您最关心的问题。

```
xlsSheet.Write("C" + rowIndex.ToString(), null, title); 
```

string.Format 在后台使用 StringBuilder （使用[反射器](http://www.red-gate.com/products/reflector/)检查），因此除非您进行大量连接，否则它不会有任何性能优势。对于您的场景来说它会更慢，但现实情况是这种微观性能优化决策在大多数情况下是不合适的，除非您处于循环中，否则您应该真正关注代码的可读性。

无论哪种方式，首先编写可读性，然后如果您真的认为自己有性能问题，请使用[性能分析器来识别您的热点。](http://www.google.com/search?num=50&q=.net+performance+profiler "Google 搜索 .net 性能分析器")

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-17T21:36:54.230

对于一个简单的单一连接的简单情况，我觉得它不值得复杂性`string.Format`（而且我没有测试过，但我怀疑对于这样一个简单的情况，`string.Format` *可能*会稍微慢一点，格式字符串解析呢和所有）。像 Jon Skeet 一样，我更喜欢不显式调用`.ToString()`，因为这将通过`string.Concat(string, object)`重载隐式完成，而且我认为没有它的代码看起来更干净，更容易阅读。

但是对于不止几个连接（多少是主观的），我绝对更喜欢`string.Format`. 在某一点上，我认为连接的可读性和性能都会受到不必要的影响。

如果格式字符串有很多参数（同样，“很多”是主观的），我通常更喜欢在替换参数上包含注释索引，以免我忘记哪个值到哪个参数。一个人为的例子：

```
Console.WriteLine(
    "Dear {0} {1},\n\n" +

    "Our records indicate that your {2}, \"{3}\", is due for {4} {5} shots.\n" +
    "Please call our office at 1-900-382-5633 to make an appointment.\n\n" +

    "Thank you,\n" +
    "Eastern Veterinary",

    /*0*/client.Title,
    /*1*/client.LastName,
    /*2*/client.Pet.Animal,
    /*3*/client.Pet.Name,
    /*4*/client.Pet.Gender == Gender.Male ? "his" : "her",
    /*5*/client.Pet.Schedule[0]
); 
```

* * *

### 更新

我突然想到我给出的例子有点令人困惑，因为我似乎同时使用**了**连接和`string.Format`这里。是的，从逻辑和词汇上讲，这就是我所做的。^(但是编译器1)将优化所有连接，因为它们都是字符串文字。所以在运行时，会有一个字符串。所以我想我应该说我更喜欢*在运行时*避免许多串联。

当然，这个主题的大部分内容现在已经过时了，除非您仍然坚持使用 C# 5 或更早版本。现在我们已经[插值了字符串](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/interpolated-strings)`string.Format`，在几乎所有情况下，它的可读性都远远优于。这些天来，除非我只是将一个值直接连接到字符串文字的开头或结尾，否则我几乎总是使用字符串插值。今天，我会这样写我之前的例子：

```
Console.WriteLine(
    $"Dear {client.Title} {client.LastName},\n\n" +

    $"Our records indicate that your {client.Pet.Animal}, \"{client.Pet.Name}\", " +
    $"is due for {(client.Pet.Gender == Gender.Male ? "his" : "her")} " +
    $"{client.Pet.Schedule[0]} shots.\n" +
    "Please call our office at 1-900-382-5633 to make an appointment.\n\n" +

    "Thank you,\n" +
    "Eastern Veterinary"
); 
```

**您确实会以这种方式丢失编译时连接。** 每个内插字符串都被编译器转换为对的调用`string.Format`，并且它们的结果在运行时连接起来。这意味着这是为了可读性而牺牲运行时性能。大多数时候，这是值得的牺牲，因为运行时的损失可以忽略不计。但是，在性能关键代码中，您可能需要分析不同的解决方案。

* * *

[¹ 您可以在[C# 规范](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/expressions#constant-expressions)中看到这一点：]

> ...在常量表达式中允许以下构造：
> 
> ...
> 
> *   预定义的 + ... 二元运算符...

[您还可以使用一些代码来验证它：]

```
const string s =
    "This compiles successfully, " +
    "and you can see that it will " +
    "all be one string (named `s`) " +
    "at run time"; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-17T21:25:37.370

如果您的字符串更复杂，并且连接了许多变量，那么我会选择 string.Format()。但是对于在您的情况下连接的字符串的大小和变量的数量，我会使用您的第一个版本，它更[简单](http://www.codinghorror.com/blog/archives/001148.html)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-17T21:26:11.987

这个例子可能太微不足道而无法注意到差异。事实上，我认为在大多数情况下，编译器可以优化掉任何差异。

但是，如果我不得不猜测，我会`string.Format()`为更复杂的场景提供优势。但这更像是一种直觉，它可能会更好地利用缓冲区而不是产生多个不可变字符串，而不是基于任何真实数据。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-17T22:57:02.600

我查看了 String.Format（使用 Reflector），它实际上创建了一个 StringBuilder，然后在其上调用 AppendFormat。因此，对于多个搅拌，它比 concat 更快。最快的（我相信）将创建一个 StringBuilder 并手动调用 Append 。当然，“许多”的数量是可以猜测的。对于像您的示例一样简单的事情，我会使用 + （实际上，因为我主要是 VB 程序员）。随着它变得越来越复杂，我使用 String.Format。如果有很多变量，那么我会选择 StringBuilder 和 Append，例如，我们有构建代码的代码，我使用一行实际代码来输出一行生成的代码。

似乎有一些关于为每个操作创建多少个字符串的猜测，所以让我们举几个简单的例子。

```
"C" + rowIndex.ToString(); 
```

“C”已经是一个字符串。
rowIndex.ToString() 创建另一个字符串。（@manohard - 不会发生 rowIndex 装箱）
然后我们得到最终的字符串。
如果我们以

```
String.Format("C(0)",rowIndex); 
```

然后我们将 "C{0}" 作为字符串
rowIndex 被装箱以传递给函数
创建一个新的字符串生成
器 在字符串生成器上调用 AppendFormat - 我不知道 AppendFormat 函数的详细信息，但假设它是超高效，它仍然必须将盒装的 rowIndex 转换为字符串。
然后将 stringbuilder 转换为新字符串。
我知道 StringBuilders 试图防止发生无意义的内存复制，但与普通连接相比，String.Format 仍然会产生额外的开销。

如果我们现在举一个带有更多字符串的例子

```
"a" + rowIndex.ToString() + "b" + colIndex.ToString() + "c" + zIndex.ToString(); 
```

我们有 6 个字符串开始，这对于所有情况都是相同的。
使用连接我们还有 4 个中间字符串加上最终结果。正是那些通过使用 String、Format（或 StringBuilder）消除的中间结果。
请记住，要创建每个中间字符串，必须将前一个字符串复制到新的内存位置，不仅仅是内存分配可能很慢。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-17T21:29:41.200

我喜欢 String.Format 因为它可以让你的格式化文本比内联连接更容易理解和阅读，而且它更灵活允许你格式化你的参数，但是对于像你这样的短期用途，我认为连接没有问题。

对于循环内或大字符串中的连接，您应该始终尝试使用 StringBuilder 类。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-21T14:22:12.227

我同意上面的很多观点，我认为应该提到的另一点是代码可维护性。string.Format 允许更轻松地更改代码。

即我有一条消息 `"The user is not authorized for location " + location`或 `"The User is not authorized for location {0}"`

如果我想将消息更改为： `location + " does not allow this User Access"`或 `"{0} does not allow this User Access"`

使用 string.Format 我所要做的就是更改字符串。对于连接，我必须修改该消息

如果在多个地方使用可以节省很多时间。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-01T12:16:18.787

我的印象是 string.format 更快，在这个测试中似乎慢了 3 倍

```
string concat = "";
        System.Diagnostics.Stopwatch sw1 = new System.Diagnostics.Stopwatch    ();
        sw1.Start();
        for (int i = 0; i < 10000000; i++)
        {
            concat = string.Format("{0}{1}{2}{3}{4}{5}{6}{7}{8}{9}{10}","1", "2" , "3" , "4" , "5" , "6" , "7" , "8" , "9" , "10" , i);
        }
        sw1.Stop();
        Response.Write("format: "  + sw1.ElapsedMilliseconds.ToString());
        System.Diagnostics.Stopwatch sw2 = new System.Diagnostics.Stopwatch();
        sw2.Start();
        for (int i = 0; i < 10000000; i++)
        {
            concat = "1" + "2" + "3" + "4" + "5" + "6" + "7" + "8" + "9" + "10" + i;
        }
        sw2.Stop(); 
```

string.format 用了 4.6 秒，使用“+”时用了 1.6 秒。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-17T23:01:52.357

当格式模板（“C{0}”）存储在配置文件（如 Web.config / App.config）中时，string.Format 可能是更好的选择

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-18T02:32:06.800

我对各种字符串方法进行了一些分析，包括 string.Format、StringBuilder 和字符串连接。字符串连接几乎总是优于其他构建字符串的方法。因此，如果性能是关键，那么它会更好。但是，如果性能不重要，那么我个人认为 string.Format 更容易在代码中遵循。（但这是一个主观原因）然而，StringBuilder 在内存利用率方面可能是最有效的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-30T16:08:01.560

关于性能，我更喜欢 String.Format

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-27T14:56:45.417

### 关于性能：

```
void Main()
{
    var start = CurrentTimeMillis();
    for (var i = 0; i < 1000000; i++)
    {
        var s = "Hi " + i.ToString() + "; Hi to you " + (i * 2).ToString();
    }
    var end = CurrentTimeMillis();
    Console.WriteLine("Concatenation = " + ((end - start)).ToString() + " millisecond");
    start = CurrentTimeMillis();
    for (var i = 0; i < 1000000; i++)
    {
        var s = String.Format("Hi {0}; Hi to you {1}", i, +i * 2);
    }
    end = CurrentTimeMillis();
    Console.WriteLine("Format = " + ((end - start)).ToString() + " millisecond");
    start = CurrentTimeMillis();
    for (var i = 0; i < 1000000; i++)
    {
        var s = String.Concat("Hi ", i.ToString(), "; Hi to you ", (i * 2).ToString());
    }
    end = CurrentTimeMillis();
    Console.WriteLine("Strng.concat = " + ((end - start)).ToString() + " millisecond");

    start = CurrentTimeMillis();
    for (int i = 0; i < 1000000; i++)
    {
        StringBuilder bldString = new StringBuilder("Hi ");
        bldString.Append(i).Append("; Hi to you ").Append(i * 2);
    }
    end = CurrentTimeMillis();
    Console.WriteLine("String Builder = " + ((end - start)) + " millisecond");
}

private static readonly DateTime Jan1st1970 = new DateTime
    (1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);

public static long CurrentTimeMillis()
{
    return (long)(DateTime.UtcNow - Jan1st1970).TotalMilliseconds;
} 
```

### 结果

```
Concatenation = 69 millisecond
Format = 142 millisecond
Strng.concat = 62 millisecond
String Builder = 91 millisecond 
```

为了进行公平的比较，我实例化了一个新的 StringBuilder 而不是在循环之外创建的（由于循环附加在一个构建器的重新分配空间的末尾，这可能会更快）。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-11-17T21:30:19.373

与 String.Format 相比，字符串连接占用更多内存。所以连接字符串的最佳方法是使用 String.Format 或 System.Text.StringBuilder 对象。

让我们以第一种情况为例： "C" + rowIndex.ToString() 假设 rowIndex 是一个值类型，因此 ToString() 方法必须使用 Box 将值转换为 String，然后 CLR 为包含两个值的新字符串创建内存。

string.Format 需要对象参数并将 rowIndex 作为对象接收并在内部将其转换为字符串，当然会有拳击，但它是内在的，而且它不会像第一种情况那样占用太多的内存。

对于短字符串，我猜这并不重要......

# regex - 构建正则表达式以在 href 中查找 id

> ID：296981
> 
> 赞同：2
> 
> 时间：2008-11-17T21:21:48.020
> 
> 标签：regex

有人可以给我看一个正则表达式，它会浏览这个文档并选择`RELATION_ID`它末尾的每个 href 的 href 值吗？如果是这样，我必须得到问号之前的 ID（例如`href="dctm://ISDOFSDdev/`37004e1f800021f3 `?DMS_OBJECT_SPEC=RELATION_ID`）

谢谢！

```
<?xml version="1.0" encoding="utf-8"?>
<?dctm xml_app="elearningContent"?>
<!DOCTYPE OnlineContent PUBLIC "-//ISDOFSD//DTD Online Content//EN" "file:C:/dmExport/New%20Folder%20(2)/ISDOFSDdev/elearningContent/OnlineContent.dtd">
<OnlineContent outputclass="Graphic Down" id="OnlineContent_955627C91D8743B98DCB8BD9BE379DE8">
    <title>Text and Popup</title>
    <OnlineContentBody>
        <lcInstruction id="lcInstruction_770F26218C064A84BFA1813562173970">
            <p>This is an example of a plain text screen with an attached popup.</p>
            <p>
                Popups are used to display additional content in a popup window. A <xref scope="local" type="topic" format="dita" href="dctm://ISDOFSDdev/37004e1f800021f3?DMS_OBJECT_SPEC=RELATION_ID">link is provided</xref> in the main text of the screen, which may clicked on to open a popup. A screen may contain <xref scope="local" type="topic" format="dita" href="dctm://ISDOFSDdev/37004e1f800021f4?DMS_OBJECT_SPEC=RELATION_ID">more than one popup</xref>.
            </p>
        </lcInstruction>
    </OnlineContentBody>
    <OnlinePopup id="OnlinePopup_AFE53E2CACBF4D8196E6360D4DDB6B70">
        <title>A Popup</title>
        <OnlinePopupBody>
            <p>This is an example of popup content.</p>
            <p>A popup may contain one or more paragraphs of text. They may also contain lists, like this:</p>
            <ul id="ul_7812991BBBDD4995B7499A9557C4EA9C">
                <li id="li_E83BDB28EC494B98BFF3DD5924AF855E">An item in a list</li>
                <li id="li_270F2A3A85BA4E6EBF98CB4023344475">Another item in a list</li>
            </ul>
            <p>A numbered list is demonstrated in the second popup.</p>
        </OnlinePopupBody>
    </OnlinePopup>
    <OnlinePopup id="OnlinePopup_5AE081BFB97043CE99F39A9E4A063332">
        <title>Another Popup</title>
        <OnlinePopupBody>
            <p>This is the second popup on this screen, containing a numbered list.</p>
            <ol id="ol_EF18C080E7CC40B7998DEB75772367A6">
                <li id="li_91B42F1B886B4CF887C001577C14B3F0">An item in a list</li>
                <li id="li_95C4F32E093843FAB985A3F6981A7D07">Another item in a list</li>
            </ol>
        </OnlinePopupBody>
    </OnlinePopup>
</OnlineContent> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T21:57:15.420

您可以使用此正则表达式：

```
[a-fA-F0-9]+(?=\?DMS_OBJECT_SPEC=RELATION_ID) 
```

它与查询字符串之前的十六进制数匹配。

我还建议使用 XPath 通过正则表达式来执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T22:17:55.830

既然您有 XML 数据，为什么不使用 XSLT 样式表呢？此示例选择所需属性的值。此示例仅使用了 XPath 1.0 函数，这些函数有些受限。它输出所需的 href 属性的值。

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        >
        <xsl:output method="text" indent="no"/>
        <xsl:template match="*[@href]">
            <xsl:if test="contains(@href, 'RELATION_ID')">
                <xsl:value-of select="@href"/>
            <xsl:text>&#xa;</xsl:text>
            </xsl:if>
            <xsl:apply-templates select="*"/>
        </xsl:template>
        <xsl:template match="*">
            <xsl:apply-templates select="*"/>
        </xsl:template>
</xsl:stylesheet> 
```

考虑到您将给定文件命名为“example.xml”并将 XSLT 样式表命名为“example-xslt.xsl”，您可以使用以下行使用[MSXSL.exe](http://www.microsoft.com/downloads/details.aspx?FamilyID=2fb55371-c94e-4373-b0e9-db4816552e41&displaylang=en)将结果保存到文件“out.txt” ：

```
C:\Documents and Settings\fer\Escritorio>msxsl.exe -xw example.xml example-xslt.xsl > out.txt 
```

**编辑：**接下来是使用 XPath v2.0 的 XSLT，它让您可以在字符串处理函数中使用正则表达式的强大功能。结果是您正在查找的 URL 内的 ID（而不是 href 属性的整个值）。

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:fn="http://www.w3.org/2005/xpath-functions" >
        <xsl:output method="text" indent="no"/>
        <xsl:template match="*[@href]">
            <xsl:if test="fn:contains(@href, 'RELATION_ID')">
                <xsl:value-of select="fn:replace(@href,'.*/([^/]*)\?.*', '$1')"/>
                <xsl:text>&#xa;</xsl:text>
            </xsl:if>
            <xsl:apply-templates select="*"/>
        </xsl:template>
        <xsl:template match="*">
            <xsl:apply-templates select="*"/>
        </xsl:template>
</xsl:stylesheet> 
```

那里没有很多免费的 XSLT v2.0 处理器，但[AltovaXML-2008](http://www.altova.com/altovaxml.html)就是其中之一。以下命令行为您提供了预期的结果。

```
C:\Documents and Settings\fer\Escritorio>AltovaXML -xslt2 example-xslt.xsl -in example.xml 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T21:26:00.677

类似的东西：`href=".*/([^"?/]*)?[^"]*RELATION_ID[^"]*"`。这假设您在为属性使用双引号时保持一致。这应该是 perl & java 友好的。

将`([^"?/]*)`捕获斜线和问号之间的位。在 java 中，您将使用[`Matcher.group(int)`](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#group(int))来获取值。如果您尝试从同一个文档中获取多个值，请查看[`Matcher.find(int)`](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#find()).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T21:32:49.573

用普通的正则表达式来攻击它可能是不谨慎的。具有内置 url 解析功能的 XPath 可能是更好的解决方案。

如前所述，最佳解决方案取决于您使用的语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T21:36:02.357

也许像这样 href="(.+?)/(.+?)\?(.+?)RELATION_ID" 并使用第二个匹配，如果你只寻找 id 部分（37004e1f800021f3 在你的例子）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T21:53:00.250

这是一个python解决方案：

```
expr = re.compile('href=.*?/(.*?)\?.*?=RELATION_ID', re.MULTILINE)

for x in expr.finditer(test_string): # iterate through all matches
   s = x.group(1) # get the one and only group of the match
   ss = s.split("/") # split off the ISDOFSDdev
   s = ss[len(ss) - 1] # grab the last element
   print s # print it 
```

输出 test_string 是您发布的字符串：

```
37004e1f800021f3
37004e1f800021f4 
```

这同样是在 python 中，但是使用任何现代正则表达式库，您应该能够复制它。

获得一个只提取 ID 的正则表达式是非常困难的。我并不是说这是不可能的，但通常更容易接近正则表达式，然后从正则表达式给你的子字符串中分离出你需要的东西。

[python regex 模块的文档](http://docs.python.org/library/re.html#module-re)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T23:44:31.710

首先使用这个正则表达式找到 href 属性：
`href="[^=]*=RELATION_ID"`

收集这些属性后，使用以下正则表达式查找 ID：
`dctm:[^?]*`

***第一个正则表达式的解释***：

`href="`：从字面上匹配字符“href="”
`[^=]*`：在零次和无限次之间匹配不是“=”的任何字符：从字面上
`=RELATION___ID`匹配字符“=RELATION_ID”。

***第二个正则表达式的解释***：

`dctm`: : 从字面上匹配字符 "dctm:"
`[^?]*`: 匹配任何不是 "?" 的字符 在零和无限次之间。

如果您打算经常使用正则表达式，您应该强烈考虑在[http://www.regexbuddy.com/购买 Regex Buddy](http://www.regexbuddy.com/)

# c - GLib v APR 各有优缺点

> ID：296992
> 
> 赞同：20
> 
> 时间：2008-11-17T21:24:32.960
> 
> 标签：c, open-source, glib, apr

我有几个我想开始的爱好 C 编程项目。我正在寻找一个具有自由许可证的开源库（我想要信用，但几乎任何人都可以使用）。该库需要比 C 标准库和一些可移植的线程原语更好的字符串。

我正在考虑[GLib](http://library.gnome.org/devel/glib/)和[APR](http://apr.apache.org/)。你的实践经验是什么？哪个是更好的基础 C 库？是否有其他图书馆填补了同样的空白？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-18T14:28:33.780

我认为 glib 通常优于 apr。glib 有更多的数据结构作为可移植库。例如哈希表、各种列表、队列、堆栈、动态数组，也用于参数解析，文件 io 也有它自己的包装器，并且内存管理很容易修改。例如，您可以轻松地使 glib 使用 Boehm Weisser GC，这是 AFAIKT 从未使用过的，或者使用 Apache 很容易。我会决定有点不同。如果你需要一个更有用的数据结构库，glib 是一个更好的装备。如果涉及 GUI 的东西，那么 libapr 什么都没有，而 glib 有 gdk/gtk+ 和很多 gnome 的东西，如果你喜欢的话。

但是，如果涉及到网络方面的东西，libapr 肯定比 glib 更有优势。

所以我的建议是

*   **桌面编程**：使用 GTK+ 和 glib。
*   **网络资料**：使用 apr，但请放心 glib 也有所有这些可移植的资料。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T21:43:01.063

我会选择 APR。APR 更擅长 Unix/Windows 的可移植性（作为一个专用的可移植库），GLib 传统上更面向 Unix。APR 是一个比 GLib 更大的库，其中包含许多有用的东西（哈希表、参数解析、文件 I/O 东西、内存管理、共享内存例程、信号处理等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T17:14:28.393

您是否有理由不想使用 c++ stl？即使您正在编写没有类的“c 风格”代码，您也可以使用 c++ 字符串和数据结构。

当然，坚持使用 C 语言有很多正当理由。如果是这样的话，我会支持 glib 的建议。APR 更像是一个可移植层而不是实用程序库。

# windows-mobile - PocketPC 平台上的智能手机式组合框行为？

> ID：296996
> 
> 赞同：4
> 
> 时间：2008-11-17T21:25:52.940
> 
> 标签：windows-mobile, compact-framework, pocketpc, smartphone

我为 PocketPC 平台（.NET Compact Framework 2.0 和更高版本）开发应用程序，我经常遇到的问题之一是 ComboBox 控件的下拉宽度不够宽，无法显示很长的字符串值。

我遇到过 P/Invoke 方法来扩大下拉菜单的宽度，但我真正想要的是 ComboBoxes 的智能手机式行为。我的意思是，初始视图是旋转控件的视图（左/右箭头滚动选项列表），如果您单击操作按钮，它将带您进入所有选项的全屏再现更容易阅读。

我想我可以创建一个自定义用户控件来模拟 PocketPC 上的这种行为，但我想知道是否有可能获得实际的智能手机功能并使用它。如果可能的话，利用现有功能肯定会更快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T21:47:31.197

我认为这是不可能的，因为 ComboBox 中的行为正是 PocketPC 智能手机操作系统处理 ComboBox 的方式。如果您使用 ComboBox 编译智能手机应用程序并在常规 PocketPC 中运行它，则 ComboBox 不会那样运行（我认为）。**************