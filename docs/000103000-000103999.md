# StackOverflow 问答 103000-103999

# asp.net - 我应该在 ViewState 中存储数据库 ID 字段吗？

> ID：103000
> 
> 赞同：3
> 
> 时间：2008-09-19T15:38:18.827
> 
> 标签：asp.net, viewstate

我需要从数据库中检索一条记录，将其显示在网页上（我正在使用 ASP.NET），但将该记录中的 ID（主键）存储在某处，以便稍后我可以使用该 ID 返回数据库（也许做一个更新）。

我知道可能有几种方法可以做到这一点，例如将 ID 存储在 ViewState 或隐藏字段中，但是最好的方法是什么，我可能会选择这种方法而不是其他方法的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T15:46:33.847

这取决于。

你关心是否有人看到记录ID？如果你这样做了，那么隐藏字段和视图状态都不合适；您需要将其存储在会话状态中，或加密视图状态。

您是否关心是否有人使用伪造的 id 提交表单？如果这样做，则不能使用隐藏字段（并且您需要将 CSRF 保护视为奖励）

您是否希望它不变但不关心它是否可以查看（通过一些工作）？在您的页面（或全局）上使用视图状态并设置 enableViewStateMac="true"

想要隐藏和保护它但不能使用会话状态？通过设置以下 web.config 条目来加密您的视图状态

```
<pages enableViewState="true" enableViewStateMac="true" />
<machineKey ... validation="3DES" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T15:51:10.637

您希望最终用户知道 ID 吗？例如，如果 id 值是来自数据库的标准 1,1 种子，我可以查看数字并查看您拥有多少客户。如果您加密该值（就像视图状态一样），我会发现解密密钥要困难得多（但并非不可能）。

另一种方法是将其存储在会话中，这将对您的应用程序产生（如果它只是一个整数，则非常小）性能影响，但这意味着我作为用户永远不会看到该主键。它还将对象暴露给您的应用程序的其他部分，您可能希望也可能不希望它被暴露（会话对象保留直到清除，经过设定的时间（如 5 分钟）或浏览器窗口关闭 - 以较早发生者为准.

每次回发后，视图状态值都会在客户端上造成额外的负载，因为视图状态不仅会保存页面的对象，而且如果您使用后退按钮，还会记住对象。这意味着在每次回帖后，它的视图状态会变得更大且更难使用。它们只会存在于他的页面上，直到浏览器转到另一个页面。

每当我像这样在页面中存储一个 ID 时，我总是创建一个属性

```
public int CustomerID {
    get { return ViewState("CustomerID"); }
    set { ViewState("CustomerID") = value; }
} 
```

或者

```
 Public Property CustomerID() As Integer
        Get
            Return ViewState("CustomerID")
        End Get
        Set(ByVal value As Integer)
            ViewState("CustomerID") = value
        End Set
    End Property 
```

这样，如果您决定将其从 Viewstate 更改为会话变量或隐藏的表单字段，这只是在属性引用中更改它的一种情况，页面的其余部分可以使用“Page.CustomerID”访问该变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T15:41:59.457

ViewState 是一个选项。它仅对您所在的页面有效。它不携带对其他资源（如 Session 对象）的请求。

隐藏字段也可以工作，但是您正在向任何聪明到可以查看页面源代码的人泄露有关您的应用程序的少量信息。

您还可以将整个记录存储在 ViewState 中，并且可能避免再次往返服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T15:44:40.917

我个人对在会话中添加任何内容持怀疑态度。我们的工作进程循环了太多次，我们丢失了会话状态。

正如您描述的问题，我会将其放在隐藏字段或页面的视图状态中。

此外，在确定将此类数据放在何处时，请始终查看数据的范围。它的范围是单个页面还是整个会话？如果对我们来说答案是“会话”，我们将其放入 cookie 中。（免责声明：我们在知道启用了 cookie 的情况下编写内部网应用程序。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T15:50:50.857

如果它是一个简单的 id 将选择在查询字符串中传递它，那么您不需要进行回发，并且页面更容易被用户和搜索引擎访问。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-19T15:40:20.943

```
Session["MyId"]=myval; 
```

它会更安全一些，并且本质上提供与将其置于视图状态中相同的机制

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-19T15:49:44.040

我倾向于将类似的东西粘贴在隐藏的领域中，只需做一点

```
 <asp:label runat=server id=lblThingID visible=false /> 
```

# sql - 可能与光标/加入有关的问题

> ID：103005
> 
> 赞同：2
> 
> 时间：2008-09-19T15:38:58.293
> 
> 标签：sql, optimization, join, database-cursor

这是我的情况：

表一包含一组使用 id 作为唯一标识符的数据。该表与大约 6 个其他表具有一对多关系。

给定 Id 为 001 的表 1：表 2 可能有 3 行外键：001 表 3 可能有 12 行外键：001 表 4 可能有 0 行外键：001 表 5 可能有 28 行外键: 001

我需要编写一份报告，列出指定时间范围内表 1 中的所有行，然后是引用它的少数表中包含的所有数据。

我当前的伪代码方法如下所示：

```
select * from table 1
foreach(result) {
  print result;
  select * from table 2 where id = result.id;
  foreach(result2) {
    print result2;
  }
  select * from table 3 where id = result.id
  foreach(result3) {
    print result3;
  }
  //continued for each table
} 
```

这意味着单个报告可以在 1000 个查询附近运行。我知道这太过分了，但是我的 sql-fu 有点弱，我可以使用一些帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T15:42:23.450

Table1 上的 LEFT OUTER JOIN Tables2-N

```
SELECT Table1.*, Table2.*, Table3.*, Table4.*, Table5.*
FROM Table1
LEFT OUTER JOIN Table2 ON Table1.ID = Table2.ID
LEFT OUTER JOIN Table3 ON Table1.ID = Table3.ID
LEFT OUTER JOIN Table4 ON Table1.ID = Table4.ID
LEFT OUTER JOIN Table5 ON Table1.ID = Table5.ID
WHERE (CRITERIA) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T15:50:41.293

加入不适合我。我讨厌不得不在客户端解开数据。所有来自左连接的空值。

这是一个不使用联接的基于集合的解决方案。

```
INSERT INTO @LocalCollection (theKey)
SELECT id
FROM Table1
WHERE ...

SELECT * FROM Table1 WHERE id in (SELECT theKey FROM @LocalCollection)

SELECT * FROM Table2 WHERE id in (SELECT theKey FROM @LocalCollection)

SELECT * FROM Table3 WHERE id in (SELECT theKey FROM @LocalCollection)

SELECT * FROM Table4 WHERE id in (SELECT theKey FROM @LocalCollection)

SELECT * FROM Table5 WHERE id in (SELECT theKey FROM @LocalCollection) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T15:47:44.437

```
SELECT * FROM table1 t1
INNER JOIN table2 t2 ON t1.id = t2.resultid -- this could be a left join if the table is not guaranteed to have entries for t1.id
INNER JOIN table2 t3 ON t1.id = t3.resultid -- etc 
```

或者，如果数据都采用您可以执行的相同格式。

```
SELECT cola,colb FROM table1 WHERE id = @id
UNION ALL
SELECT cola,colb FROM table2 WHERE resultid = @id
UNION ALL
SELECT cola,colb FROM table3 WHERE resultid = @id 
```

这实际上取决于您需要将数据输出到报告的格式。

如果您可以提供您希望输出的示例，我可能会提供更多帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T15:42:50.283

啊! 程序！如果您需要在第一个表的结果之后对其他表的结果进行排序，我的 SQL 将如下所示。

> ```
> Insert Into #rows Select id from Table1 where date between '12/30' and '12/31'
> Select * from Table1 t join #rows r on t.id = r.id
> Select * from Table2 t join #rows r on t.id = r.id
> --etc 
> ```

如果您想按初始 ID 对结果进行分组，请使用左外连接，如前所述。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T15:43:29.423

如果您觉得大胆，最好使用 Crystal 或 Jasper 之类的报告工具，甚至是 XSL-FO。他们有内置的东西来专门处理这个问题。这不是在原始 SQL 中运行良好的东西。

如果所有行（标题以及所有细节）的格式都相同，那么将其作为存储过程也很容易。

我会做什么：将它作为一个连接来做，这样你就会在每一行上都有标题数据，然后使用报告工具进行分组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T15:51:45.317

我要做的是在以下查询上打开游标：

```
SELECT * from table1 order by id
SELECT * from table1 r, table2 t where t.table1_id = r.id order by r.id
SELECT * from table1 r, table3 t where t.table1_id = r.id order by r.id 
```

然后我会并行移动这些光标，打印你的结果。您可以这样做，因为它们都以相同的顺序出现。（请注意，我建议虽然 table1 的主 ID 可能命名为 id，但在其他表中**不会**有该名称。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T15:56:43.837

所有表格的格式都一样吗？如果没有，那么如果您必须有一个可以显示`n`不同类型行的报告。如果您只对相同的列感兴趣，那就更容易了。

大多数数据库都有某种形式的动态 SQL。在这种情况下，您可以执行以下操作：

```
create temporary table from
select * from table1 where rows within time frame

x integer
sql varchar(something)
x = 1
while x <= numresults {
 sql = 'SELECT * from table' + CAST(X as varchar) +  ' where id in (select id from temporary table'
 execute sql
 x = x + 1
} 
```

但我的意思是基本上在这里你在你的主表上运行一个查询来获取你需要的行，然后为每个子表运行一个查询来获取与你的主表匹配的行。

如果报告需要每个表相同的 2 或 3 列，您可以将其更改`select * from tablex`为 an`insert into`并在最后获得一个结果集...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T15:44:10.030

将所有表连接在一起。

```
select * from table_1 left join table_2 using(id) left join table_3 using(id); 
```

然后，您需要汇总代码中的列，以按照您认为合适的方式格式化您的报告。

# c# - 将纬度和经度转换为双精度值的最简单方法是什么

> ID：103006
> 
> 赞同：9
> 
> 时间：2008-09-19T15:38:59.917
> 
> 标签：c#, gis

我有一个包含纬度和经度值的 CSV 文件，例如：

> "25°36'55.57""E","45°39'12.52""N"

任何人都有一段快速简单的 C# 代码来将其转换为双精度值吗？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T15:43:41.903

如果您的意思是执行此操作的 C# 代码：

结果 = 25 + (36 / 60) + (55.57 / 3600)

首先，您需要使用 Regex 或其他机制解析表达式并将其拆分为各个部分。然后：

```
String hour = "25";
String minute = "36";
String second = "55.57";
Double result = (hour) + (minute) / 60 + (second) / 3600; 
```

当然，根据 N/S 或 E/S 切换到翻转标志。维基百科对此有一点：

> 对于计算，西/东后缀在西半球被一个负号代替。令人困惑的是，有时也会看到否定东方的惯例。首选惯例——东方为正——与北极向上的右手笛卡尔坐标系一致。然后可以将特定的经度与特定的纬度（在北半球通常为正）结合起来，以给出地球表面上的精确位置。（[http://en.wikipedia.org/wiki/Longitude](http://en.wikipedia.org/wiki/Longitude)）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-19T16:15:48.690

感谢所有快速回答。根据 amdfan 的回答，我将这段代码放在一起，用 C# 完成这项工作。

```
/// <summary>The regular expression parser used to parse the lat/long</summary>
private static Regex Parser = new Regex("^(?<deg>[-+0-9]+)[^0-9]+(?<min>[0-9]+)[^0-9]+(?<sec>[0-9.,]+)[^0-9.,ENSW]+(?<pos>[ENSW]*)$");

/// <summary>Parses the lat lon value.</summary>
/// <param name="value">The value.</param>
/// <remarks>It must have at least 3 parts 'degrees' 'minutes' 'seconds'. If it 
/// has E/W and N/S this is used to change the sign.</remarks>
/// <returns></returns>
public static double ParseLatLonValue(string value)
{
    // If it starts and finishes with a quote, strip them off
    if (value.StartsWith("\"") && value.EndsWith("\""))
    {
        value = value.Substring(1, value.Length - 2).Replace("\"\"", "\"");
    }

    // Now parse using the regex parser
    Match match = Parser.Match(value);
    if (!match.Success)
    {
        throw new ArgumentException(string.Format(CultureInfo.CurrentUICulture, "Lat/long value of '{0}' is not recognised", value));
    }

    // Convert - adjust the sign if necessary
    double deg = double.Parse(match.Groups["deg"].Value);
    double min = double.Parse(match.Groups["min"].Value);
    double sec = double.Parse(match.Groups["sec"].Value);
    double result = deg + (min / 60) + (sec / 3600);
    if (match.Groups["pos"].Success)
    {
        char ch = match.Groups["pos"].Value[0];
        result = ((ch == 'S') || (ch == 'W')) ? -result : result;
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T15:50:29.140

你想用什么来表示它？弧秒？然后每度60分钟，每分钟60秒。然后，您必须自己保留 E 和 N。

不过，这不是通常的做法。

我见过的最简单的表示是在一个网格系统上绘制在地球上的一个点，它的原点通过地球的中心。[因此是一个很好的位置向量。]这个问题是虽然它很容易使用数据，正确地进出系统可能很困难，因为地球不是圆形的，或者就此而言是均匀的。

# linux - 断管不再结束程序？

> ID：103016
> 
> 赞同：5
> 
> 时间：2008-09-19T15:39:44.143
> 
> 标签：linux, shell, tcsh, broken-pipe

当您管道两个进程并在管道的“输出”处终止一个进程时，第一个进程用于接收“Broken Pipe”信号，这通常也会终止它。例如跑步

```
$> do_something_intensive | less 
```

然后在 SuSE8 或更早版本上退出*less used 以立即将您返回到响应式 shell。*当我今天尝试这样做时，*do_something_intensive*显然仍在运行，直到我手动将其杀死。似乎有些东西发生了变化（glib？shell？），使程序忽略“破管道”......

你们中有人对此有提示吗？如何恢复以前的行为？为什么它被改变了（或者为什么它总是存在多种语义）？

*编辑*：进一步的测试（使用 strace）显示生成了“SIGPIPE” ，但*程序*没有中断。一个简单的

```
#include <stdio.h>
int main() 
{
   while(1) printf("dumb test\n");
   exit(0);
} 
```

将永无止境地继续下去

```
--- SIGPIPE (Broken pipe) @ 0 (0) ---
write(1, "dumb test\ndumb test\ndumb test\ndu"..., 1024) = -1 EPIPE (Broken pipe) 
```

当*更少*被杀死时。我可以肯定地在我的程序中编写一个信号处理程序并确保它终止，但我更多的是寻找一些环境变量或 shell 选项来强制程序在 SIGPIPE 上终止

*再次编辑*：这似乎是一个特定于 tcsh 的问题（bash 正确处理它）并且依赖于终端（Eterm 0.9.4）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T15:45:12.820

好吧，如果在阅读器离开后尝试写入管道，则会生成 SIGPIPE 信号。应用程序有能力捕捉到这个信号，但如果没有，进程就会被杀死。

在调用进程尝试写入之前不会生成 SIGPIPE，因此如果没有更多输出，则不会生成它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T16:26:02.393

“做一些密集的事情”有没有改变？

正如丹尼尔所提到的，SIGPIPE 不是一个神奇的“你的管道消失了”信号，而是一个“不错的尝试，你不能再读/写那个管道”信号。

如果您可以控制“做一些密集的事情”，您可以更改它以在它旋转时写出一些“进度指示器”输出。这将及时提高 SIGPIPE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:50:35.503

感谢您的建议，解决方案越来越接近......

根据 tcsh 的手册页，“非登录 shell 从其父级继承终止行为。其他信号具有 shell 从其父级继承的值。”

这表明我的*终端*实际上​​是问题的根源......如果它忽略了 SIGPIPE，shell 本身也会忽略 SIGPIPE......

*编辑：*我有明确的确认问题只出现在 Eterm+tcsh 中，并且在 Eterm 源代码中发现了一个可疑的缺失信号（SIGPIPE，SIG_DFL）。我认为结案。

# enterprise-library - 企业库的 Msmqdistributor 服务的优缺点是什么？

> ID：103033
> 
> 赞同：2
> 
> 时间：2008-09-19T15:41:04.797
> 
> 标签：enterprise-library

我们正在使用 EntLib 日志记录应用程序块。事实证明，由于性能原因，我们应该使用 msmq 进行日志记录。现在我们正在尝试使用 Msmqdistributor 服务将这些消息记录在队列中。

企业库的 Msmqdistributor 服务的优缺点是什么？

请分享你的经验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T08:38:44.520

主要缺点将是 Microsoft 消息队列 (MSMQ) 本身。MSMQ 已经存在了一段时间，它是一个非常酷的工具。然而，它确实缺乏实用程序。由于数据存储在队列中的方式，大多数人最终需要编写一些辅助实用程序来调试和手动操作队列。其他一些需要考虑的事情：

*   **队列大小**- 如果太多项目被放入队列，并且没有及时删除，服务器可能会停止。
*   **目的**- MSMQ 专为多步骤事务（例如计费）而设计，您提到您将使用它进行日志记录。如果日志仅用于调试，那么数据库表或平面文件或将错误发送到错误跟踪器将为您提供更好的服务。如果您需要复杂的日志记录并使用 MSMQ 将信息发送到不同的计算机，那么您会发现 MSMQ 更有用。

# visual-studio-2008 - VS2008 调试器不会因未处理的异常而中断

> ID：103034
> 
> 赞同：2
> 
> 时间：2008-09-19T15:41:13.780
> 
> 标签：visual-studio-2008, debugging, unhandled

我的 vs 调试器有一个奇怪的问题。在 vs 调试器下运行我的程序时，调试器不会因未处理的异常而中断。而是将控制权返回给 VS，就好像程序正常退出一样。如果我查看输出选项卡，在线程终止之前列出了第一次机会异常。

我了解如何使用“调试”菜单中的“例外”框。我检查了未处理异常的中断。如果我检查正在发生的特定异常的第一次机会异常，调试器将停止。

但是，据我了解，调试器也应该在任何“未处理异常”上停止。这不是为我做的。

这是我的“输出”选项卡的最后几行：

```
A first chance exception of type 'System.ArgumentOutOfRangeException' occurred in mscorlib.dll
The thread 0x60c has exited with code 0 (0x0).
The program '[3588] ALMSSecurityManager.vshost.exe: Managed' has exited with code -532459699 (0xe0434f4d). 
```

我不明白为什么异常在未处理时被标记为“第一次机会”异常。

我相信 0xe0434f4d 退出代码是一个通用的 COM 错误。

有任何想法吗？

地铁。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T16:17:06.580

当我阅读有关在“例外...”对话框中有两个复选框的答案时，我返回并再次打开该对话框。我只有一列复选框——用于“抛出”的中断。

事实证明，如果您没有在“调试”选项中选中“仅启用我的代码（仅限托管）”，则“用户未处理”列不会显示在“异常”对话框中。

我选择了“仅启用我的代码”选项并验证了“异常”对话框上的“用户未处理”复选框已为所有异常类别选中。

我能够获得未处理的异常以闯入调试器进行一个会话。但是当我第二天回来时，行为还是和以前一样。

地铁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-12-04T17:13:00.887

如果您使用的是 64 位操作系统，那么您很有可能会被导致异常消失的操作系统级别的行为所困扰。重现它最可靠的方法是制作一个新的 WinForm 应用程序，它只是在 OnLoad 中抛出一个异常；它似乎不会被抛出。看看这些：

1.  Visual Studio 不会因 Windows 64 位的未处理异常而中断
    *   http://social.msdn.microsoft.com/Forums/en/vsdebug/thread/69a0b831-7782-4bd9-b910-25c85f18bceb
2.  [OnLoad异常消失的案例](http://blog.paulbetts.org/index.php/2010/07/20/the-case-of-the-disappearing-onload-exception-user-mode-callback-exceptions-in-x64/)
3.  x64 开发机器上的静默异常 (Microsoft Connect)
    *   https://connect.microsoft.com/VisualStudio/feedback/details/357311/silent-exceptions-on-x64-development-machines

第一个是我从谷歌找到的（在这个线程没有帮助之后），那个线程把我带到了以下两个。第二个有最好的解释，第三个是 Microsoft 错误/票证（再次确认这是“设计”行为）。

因此，基本上，如果您的应用程序在返回堆栈的过程中抛出一个触及内核模式边界的异常，它就会在该边界处被阻塞。Windows 团队决定处理它的最佳方法是假装异常已被处理。执行继续，好像一切正​​常完成。

哦，这*到处都*发生。调试与发布无关。.Net 与 C++ 无关。这是操作系统级别的行为。

想象一下，您必须将一些关键数据写入磁盘，但它在内核模式边界的错误一侧失败。其他代码稍后会尝试使用它，如果幸运的话，您会检测到数据有问题……但是为什么呢？我敢打赌，您永远不会认为您的应用程序无法写入数据——因为您预计会引发异常。

混蛋。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T15:42:55.227

Ctl-D, E 调出例外窗口。您可以设置您想要和不想要的例外情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T15:42:51.967

“异常...”框中有两个复选框，我通常必须检查它们以使其在未处理的异常上中断。不管它读起来像你需要检查一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T15:51:34.177

每隔一段时间，这也发生在我身上。这似乎是一个错误或其他东西，因为当我复制场景时，异常被捕获并像往常一样显示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T20:03:46.933

我有一个类似的问题，检查“仅启用我的代码（仅限托管）”解决了这个问题，而如果我把它关掉然后问题又回来了，不知道为什么（但有可能一些 DLL 似乎得到了未选中时加载会导致该行为）。

# .net - 我在哪里可以看到像“BlanchedAlmond”这样的 .NET 中的颜色属性是什么样的？

> ID：103035
> 
> 赞同：0
> 
> 时间：2008-09-19T15:41:25.857
> 
> 标签：.net, colors

我正在.Net 中编写代码以在我的应用程序中绘制一些东西，我需要选择一种颜色来使用。但是“Chartreuse”这个颜色是什么样的呢？不是有一个很好的位图来显示每个系统颜色在某个地方的样子吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T15:44:29.450

[MSDN - 按名称着色](http://msdn.microsoft.com/en-us/library/aa358802(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T15:43:12.357

试试这个[网站](http://www.blizzardskies.com/bz/colorchart.html)。

这个站点很好，因为它显示了颜色将如何作为前景色和背景色显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T15:43:22.183

我相信这就是你要找的东西：http: [//www.cambiaresearch.com/c4/7cb36a7b-3731-48f6-b91b-1d8c503f140e/What-are-the-aspnet-Named-Colors.aspx](http://www.cambiaresearch.com/c4/7cb36a7b-3731-48f6-b91b-1d8c503f140e/What-are-the-aspnet-Named-Colors.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T15:46:09.760

是的，有一个网站：[http ://adonnart.free.fr/gratuit/140coulu.htm](http://adonnart.free.fr/gratuit/140coulu.htm)

带十六进制代码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T15:44:40.933

看看这个：[http ://www.w3schools.com/TAGS/ref_color_tryit.asp?color=BlanchedAlmond](http://www.w3schools.com/TAGS/ref_color_tryit.asp?color=BlanchedAlmond)

（注意URL并根据需要进行修改）

# project-management - 您如何从概念验证阶段过渡到开发可用于生产的解决方案？

> ID：103051
> 
> 赞同：2
> 
> 时间：2008-09-19T15:43:10.203
> 
> 标签：project-management

我正在开展一个项目，该项目已被接受为概念验证，现在已作为实际生产项目按计划进行。我很好奇其他人是如何处理这种转变的。

我从各种渠道获悉，当一个项目作为概念证明开始时，通常最好丢弃在快速发展阶段编写的所有代码，并从根本上重新开始，这取决于你所学到的从概念阶段开始，但没有努力清理您第一次编写的可能混乱的代码。类似于“扔掉你要发送的愤怒电子邮件的第一个副本，重新开始”理论的编程版本。

我已经做到了，这是在过去，我还重构了概念代码以在生产中使用，但由于我正处于一个新项目的过渡阶段，我想了解其他人是如何做到这一点的。显然，很大程度上取决于项目本身和概念代码（例如，如果您生成的内容有效但无法扩展，那么最好重新开始，但如果您的项目时间表非常紧凑，您可能会被迫以您已经编写的内容为基础）。

也就是说，如果所有事情都是平等的，你们会选择什么作为方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T15:51:19.340

正如您已经暗示的那样，答案是“视情况而定”

重新开始很好，因为您可以帮助删除在最初解决问题时添加但实际上并不需要的东西。

它还让您有机会更多地考虑您希望架构如何——而不是已经依赖于概念证明的编写方式......

然而，在实践中，除非您从事向外部世界销售软件的业务，否则基于原型构建是相当普遍的。如果您遇到一些闻起来或看起来可以以更好的方式完成的代码，请不要养成思考“我稍后会修复它”的习惯......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T15:50:26.537

将现有代码重构到解​​决方案中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T15:49:53.730

对我来说，这取决于我的 POC 有多马虎。如果将它传递给另一个开发人员我会感到羞耻，我会重写它。否则，就用你得到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T15:47:19.257

如果代码有效，请使用它。花一点时间重构最混乱的部分，以便于将来的维护。但不要落入从头开始构建新系统的陷阱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T15:52:50.133

抛开概念证明中的所有内容，除了经验教训，可能还有一些小的代码片段，例如计算等。

概念验证应用程序不应该只是查看相关技术是否有效并开始测试某些边界条件的最低要求。

完成后，您可以使用新发现的知识自由地重新设计应用程序。

# svn - 从哪里开始源代码控制

> ID：103059
> 
> 赞同：20
> 
> 时间：2008-09-19T15:43:47.893
> 
> 标签：svn, version-control, cvs, visual-sourcesafe

对于想要尝试某种源代码控制以及进入 ASP.NET 的新旅程的新手，任何人有什么建议可以从哪里开始？SVN、VSS、CVS...我什至不知道从哪里开始！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-19T15:46:23.270

只要确保您[远离](http://www.codinghorror.com/blog/archives/000660.html)视觉源安全。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-19T15:44:49.623

Eric Sink 的[源代码控制 HOWTO](http://www.ericsink.com/scm/source_control.html)。

阅读它，然后下载 Subversion（免费）或 Vault（单个用户免费）并开始使用它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-19T16:21:16.057

这里有很多人建议的介绍和全面的操作方法，这些都很好地告诉你如何做你想做的事。

另外，关于如何知道自己想要什么，我会给新手三点建议：

1）版本控制一切（即，你写的一切）。

版本控制项目文件。版本控制您的测试用例。版本控制您用来复制内容的任何小脚本。版本控制您的待办事项列表。绝对版本控制您的设计笔记。一旦你熟悉了这些命令，它就不会花费任何成本，而且有一天你会为一个你从未想过需要回滚的文件的历史感到高兴。

2）当您对更改感到满意时，请立即签入。并检查一切。

如果您按顺序步骤工作（这并不总是发生 - 您可能会分心 - 但这是一种很好的做法），那么在每个新步骤开始时，您的结帐中应该有 0 个修改过的文件。您甚至可能想要签入未完成的非工作代码，具体取决于适合您的方式。

3）当你达到一个里程碑时，标记它。

甚至是您自己的个人目标（英寸鹅卵石）。如果您不介意标记，只需记下日期和时间（您猜对了，在一个版本控制的文件中）。如果某个特定版本由于某种原因令人难忘（“我完成了后端”、“我将其发送给其他人查看”），您想确切地知道其中的内容。与存储库进行比较可以比调试器更快地诊断出某些类型的错误。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-19T15:45:13.600

非常特定于 Subversion，但它可以很好地理解版本控制基础知识。

[http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T15:51:43.193

我认为最简单的方法是通过一些免费的提供商获得免费的 SVN 服务器。我使用[汇编](http://www.assembla.com/)。

然后，如果你在 Windows 中，你应该下载[TortoiseSVN](http://tortoisesvn.tigris.org/)。这是迄今为止最容易使用的 Subversion 客户端。

首先将当前项目导入存储库，然后您就可以开始了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T15:52:20.913

我建议从 SVN 开始，比其他一些更容易掌握。

[乌龟](http://tortoisesvn.tigris.org/)是一个好的开始。它易于安装并与 Windows shell 集成，这意味着右键单击文件夹/文件等一切都非常直观。文档也非常好。

您还需要一个 SVN 服务器/主机来连接... 我可以推荐[Assembla](http://www.assembla.com/)，它可以免费注册并为您提供一个 SVN 服务器来玩。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-19T15:55:32.873

我会根据你愿意花多少钱推荐 Subversion 或 Visual Studio Team Foundation Systems。

查看 Visual SVN（VS 铁杆粉丝的 Subversion）——它与 Visual Studio 完美集成：http: [//www.visualsvn.com/](http://www.visualsvn.com/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-19T15:45:28.373

如果您刚刚开始，我建议您阅读免费的[Subversion 书籍](http://svnbook.red-bean.com/)。这是一个广泛使用的系统，免费的，一旦你开始，应该相对容易理解。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-19T15:45:44.767

如果您是 100% .NET，并且您拥有 MSDN 开发人员许可证，请运行 TFS for Workgroups。它非常简单和可靠。

如果您没有许可证，请查看 Subversion。它是一个不错的免费源代码控制，具有用于 Visual Studio 集成的插件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T15:46:24.080

我第一次使用 tortoise svn 被介绍到 svn，很喜欢它，后来一家公司使用了 Visual Sourcesafe，我多么怀念使用 tortoise。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T15:47:56.667

获取《使用 Subversion 的实用版本控制》一书的副本——它将帮助您入门。

[图片 http://ecx.images-amazon.com/images/I/51XYQTP2BYL._SL500_AA240_.jpg](http://ecx.images-amazon.com/images/I/51XYQTP2BYL._SL500_AA240_.jpg)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-19T15:58:54.410

由于还没有人提到这一点，我建议也看看[Git](http://git.or.cz/)。甚至还有一个免费的源代码托管服务：[github](http://github.com/)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-19T16:39:19.647

现在我只是从分布式系统开始。它们更容易设置（您不需要设置服务器和/或在线查找服务器：只需`init`一些随机目录并开始做您的事情）并且与集中式服务器一样容易/难以理解。

以下是人们在选择分布式修订控制系统时应注意的一些事项：

*   [吉特](http://git.or.cz/)
*   [达克斯](http://darcs.net)
*   [汞 (Hg)](http://www.selenic.com/mercurial/wiki/)

如果你被困在 Windows 中，我会远离 Git（至少暂时如此）。Windows 上似乎正在[支持 Git](http://code.google.com/p/msysgit/)，但我还没有尝试过。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-19T15:46:27.950

必须第二次阅读 Subversion 书。此外，该软件是免费的，可在大多数环境中运行，并且易于上手。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-19T15:50:19.250

Pragmatic 系列有两本我读过的最好的书，可以帮助您了解版本控制。他们有[SVN](https://rads.stackoverflow.com/amzn/click/com/0977616657)和[CVS](https://rads.stackoverflow.com/amzn/click/com/0974514004)的版本。我真的很喜欢他们关于标签和分支的章节。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-19T16:05:49.680

使用什么源代码控制实际上取决于您的环境、您的企业文化以及您公司如何处理项目的一般情况。Team Foundation 中较新的“Visual Source Safe”比以前的 VSS 更好。并且在只有一个或几个位置的 Microsoft 商店中表现出色。我也非常成功地使用了 Subversion，它很好地集成到了 Eclipse 中。我不喜欢放下产品，我想每个产品都有其正面和负面之分。但是我上面提到的这两个确实是很好的源代码/版本控制产品。如果您刚刚开始并想开始学习源代码控制实践和一般概念，请下载 CVS 或 Subversion 等开源产品，加载并试用。

[http://www.ericsink.com/scm/source_control.html](http://www.ericsink.com/scm/source_control.html)有一些很好的信息可以使用。

- 我正在重新编辑此评论，以注意它看起来像其他人在之前的帖子中链接到该源代码控制链接。:) 该死，我不是第一个发布它的人。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-19T16:06:36.030

仅仅安装工具是不够的。您需要了解特定技术的工作原理（如 SVN）以及整个源代码树应该如何工作：最佳结构、标记、分支、合并等等。由于我们使用 SVN，我推荐[Subversion Book](http://svnbook.red-bean.com/en/1.0/index.html)。它对源代码控制概念有一些很好的解释。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-19T16:13:02.037

查看 Subversion (SVN) 以开始。正如其他帖子中所建议的，有一本很棒的免费[电子书](http://svnbook.red-bean.com/)，它不仅涵盖了如何使用 SVN，而且是概念的一个很好的开端。

对于易于设置的服务器，请查看[VisualSVN](http://www.visualsvn.com/server/)的免费服务器。

如果您使用 Visual Studio，您可以使用他们的加载项（成本）或开源[Ankh SVN](http://ankhsvn.open.collab.net/)加载项。如果您使用其他 IDE，[Tortoise SVN](http://tortoisesvn.tigris.org/)与 Windows 中的 Explorer 集成。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-19T17:24:14.593

从颠覆开始。[文档在线](http://svnbook.red-bean.com/)，[实用程序员 Svn 书](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)很棒。

如果您使用的是 Windows，您还可以获得[TortoiseSvn](http://tortoisesvn.tigris.org)（免费）用于资源管理器集成或[VisualSvn](http://visualsvn.com/visualsvn/)（商业）用于 Visual Studio 集成。对于 Mac，[Versions](http://www.versionsapp.com/)看起来像是一个不错的独立客户端，并且 XCode 3 内置了 svn 集成。我仍然会在命令行中使用 svn 客户端花一些时间来真正弄清楚你在做什么。

在熟悉了 svn 的工作方式之后，您就可以进入 Git、Bazaar 或 Mercurial 等分布式版本控制系统，但我已经看到足够多的专业开发人员在围绕版本控制的基础知识（分支合并等）时遇到问题在转向分布式系统之前，我会先对此感到满意。

远离 Visual SourceSafe (VSS)。是便便。您的代码*不安全*。请参阅[这些链接](http://www.google.com/search?hl=en&rlz=1C1GGLS_en-USUS292&q=visual+sourcesafe+bad&btnG=Search)，了解为什么不使用 VSS。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-19T18:51:50.797

颠覆ftw。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-19T15:46:47.027

您可以开始浏览本网站。

[https://stackoverflow.com/questions/tagged/source-control](https://stackoverflow.com/questions/tagged/source-control)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-19T15:53:08.790

在我看来，如果您已经拥有 Viual Source Safe 并且您是使用 VS 工作的单个开发人员，那完全没问题。它是一个简单的系统，可以很好地用于小型单个开发人员项目。我已经使用它多年，在小型项目中没有遇到任何麻烦。易于管理和备份。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-19T15:55:02.797

我相信策略点在于分布式版本控制系统（如 mercurial 或 git）。使用它有一些优点：

1.  您不需要设置中央存储库（它需要繁琐的服务器设置）
2.  您可以通过电子邮件或其他方式与您的朋友共享变更集（修订），并将变更安全地集成到您的存储库中。
3.  您可以轻松地修改修订历史记录（rebase，git 支持它），这是 SVN 无法做到的。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-19T16:11:29.060

我建议尝试免费的分布式版本控制系统。它们中的大多数都非常容易在您的个人 PC 上进行设置，并附有良好的文档。这是我的最爱 1\. Bazaar 2\. Mercurial 3\. Git（据我所知仅适用于基于 *nix 的系统）

在此处查看列表：

[http://en.wikipedia.org/wiki/List_of_revision_control_software](http://en.wikipedia.org/wiki/List_of_revision_control_software)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-19T16:43:42.413

我用过的产品评论：

VSS - 现在（几年）没有使用它，当时它完成了我们想要的基本功能，但我们经常遇到各种问题，以至于我们积极寻找更好的解决方案。如果您可以免费访问，那么了解他们的实施以了解当时处理问题的不同方式（他们现在可能已经与其他产品一致）不会有什么坏处.

CVS - 在以前的公司使用过这个，并与 tortoiseCVS 的原作者一起工作，所以我有点偏向于认为它是一个不错的开源解决方案。我建议亲自从这里开始，一切都很容易获得并被广泛使用。

Perforce - 我们公司目前的源代码控制解决方案，在团队中几乎得到普遍认可。人们可以选择的几个替代 UI 和良好的命令行支持（对于工具交互至关重要）。如果您正在评估一家公司，我肯定会将其包含在您的列表中以供查看。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-19T18:48:02.910

试用[Unfuddle](http://unfuddle.com/)以获得免费的托管 SVN 源代码控制。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-19T18:50:03.313

另一个投票给 Subversion / TortoiseSVN，但请注意它不能很好地与 FAT32 国内 NAS 配合使用。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-06-17T09:38:35.647

我对整个源代码控制社区失去了信心。每个人都说 VSS 很糟糕，喜欢那些陈旧的偏见，C++ 比 C 好得多，Win Vista 很糟糕，XP 太老了，无法为世界服务。然而仍然有很多人在使用它们。在使用工具之前，您永远不知道自己想要什么。每个版本控制应用程序都包含错误和缺陷。而VSS就是这么难掉。

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2008-09-19T16:26:19.290

Visual Source Safe (VSS) 非常适合初学者，因为您不知道自己错过了什么。当您需要更复杂的东西时，请担心获得其他产品。

# c# - 为什么我无法在 SQL Server Management Studio 中打开此表？

> ID：103092
> 
> 赞同：0
> 
> 时间：2008-09-19T15:45:51.477
> 
> 标签：c#, sql, sql-server

我通过 C# 程序创建了几个表，命名为 [MyTableOneCustom0] 和 [MyTableTwoCustom0]。当我尝试通过 MS SQL Server Management Studio 中的“打开表”返回这些表中的所有值时，我收到以下错误：

> 错误来源：Microsoft.VisualStudio.DataTools
> 
> 错误消息：调用的目标已引发异常。

但是，我仍然可以通过 SELECT * 语句调出所有数据。

有谁知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T15:56:29.110

根据位于[Egg Head Cafe](http://www.eggheadcafe.com/software/aspnet/30462589/exception-has-been-thrown.aspx)的类似帖子，如果查询中显式包含的列过多，Management Studio 将抛出异常。Select * 隐式返回它们，因此似乎没有问题。

我在这个表中有超过 800 列，所以我确定这就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T18:22:34.423

我犹豫要问，但通常你不会想要 800 或数据库中的列，那么你为什么要这样做呢？考虑到数据库存储信息的方式，您可能会在数据检索和存储方面为自己制造许多问题。一整行有多少字节的数据？您知道可以在一行中存储的数据字节数是有限制的。当一行超出这些限制时，您可能会遇到输入数据的问题。即使存在一对一的关系，最好还是拆分成单独的表。在 BOL 中阅读有关数据页和数据存储方式的信息，以了解为什么这与我有关。

# diff - 增量文件复制工具和 NIH

> ID：103118
> 
> 赞同：2
> 
> 时间：2008-09-19T15:48:53.870
> 
> 标签：diff

多年来，我最重要的工具之一是增量复制实用程序，它比较两个目录的内容并向我显示哪些文件较新/较旧/添加/删除。每天我发现自己在我的两台台式机和服务器之间复制源代码文件夹，这样的实用程序对于避免用旧文件覆盖新文件以及通过仅复制更改的文件来节省时间至关重要。此外，该实用程序允许我查看源文件夹中我不一定想要复制的新文件（如临时文件），而我可以删除这些文件。

像任何订阅[NIH](http://en.wikipedia.org/wiki/Not_Invented_Here)思维方式的人一样，我编写了自己的实用程序来比较两个文件夹的内容，并让我标记要复制、删除、比较或忽略的文件。我有很多版本的这个实用程序可以追溯到 DOS、OS/2 和 Win32。

我每天都使用这个实用程序，这让我想知道：其他人使用什么？当然有类似的程序可以做到这一点……我的实用程序没有差异屏幕，偶尔看看两个更改的文件之间有什么区别会很高兴。

您使用什么来比较和增量复制文件夹？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T15:51:23.180

[同步](http://samba.anu.edu.au/rsync/)。每时每刻。

rsync 最大的好处是它用增加的 CPU 时间换取了减少的传输带宽，因为现在 CPU 非常快，甚至磁盘复制也相对较慢，这是一件好事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T15:54:29.473

我将[rsync](http://samba.anu.edu.au/rsync/)用于某些工作，而将[统一](http://www.cis.upenn.edu/~bcpierce/unison/)用于其他工作。

对于您的情况，我强烈建议使用一些版本控制解决方案，例如[Subversion](http://subversion.tigris.org/)。

至于美国国立卫生研究院？虽然多年来我编写了大量工具，但我**总是**在编写自己的工具之前寻找现有的工具。它节省了时间，并且可能有比我以前使用的更好的解决方案。至少，它会给我一些“如何不去做”的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T15:52:37.700

[SyncToy](http://www.microsoft.com/downloads/details.aspx?FamilyID=c26efa36-98e0-4ee9-a7c5-98d0592d8c52&DisplayLang=en)也擅长这些东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T15:59:36.827

[SyncBack（免费）或 SyncBackSE（$$）](http://www.2brightsparks.com/downloads.html)是另一种可能的解决方案。SyncBackSE 是我*付费购买*的少数几个程序之一。健康警告：只赢。

恕我直言，NIH 违反了**懒惰**和**不耐烦**，尽管它强烈支持**傲慢**。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-10T19:51:57.587

我今天尝试了 Robocopy（包含在 Vista 中，可用于 XP 下载），它运行良好。要增量镜像我使用的驱动器：`robocopy source destination /MIR`

还有一个可用的 GUI：[http ://technet.microsoft.com/en-us/magazine/cc160891.aspx](http://technet.microsoft.com/en-us/magazine/cc160891.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T15:51:39.763

机械复制。它在 Vista 中，也是 Windows 资源工具包的一部分。它有一个奇怪的命令行界面，但它非常强大并且非常适合这种事情。

不过，我发现自己想知道源代码控制是否对您来说是一个更好的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-09T21:15:33.907

我一直在使用 rsync（Linux 到 Linux / WinXP 到 Linux）并且喜欢它。今天我试图让它在 Vista 下启动并运行，这是一个相当大的挑战。我让它运行了，但在网络驱动器和本地化字符（即 åäö）方面存在一些问题。

SyncToy 看起来很可爱！我注意到它在同步文件夹中放置了一个数据文件。任何人都知道是否可以在没有数据文件的情况下使用它/是否将数据文件保存到另一个文件夹？

我也必须尝试 robocopy。

非常感谢！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T15:56:32.090

NIH不一定是坏事。当应用程序具有一些非常个人化的特征并且您希望它对您尽可能方便时，这可能会很好，但不要笼统。

几年前，我还为此目的推出了自己的实用程序（Perl 脚本），我在家里和工作中都使用它来进行备份。它运行起来很简单，因为它完全符合我的需要并且仅此而已，而且易于调整，因为它是用灵活的脚本语言编写的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-09T23:40:51.353

您是否考虑过使用[版本控制](https://stackoverflow.com/questions/250984/do-i-really-need-version-control)工具来完成此任务？它可以让您保持同步，同时还可以记住项目的历史。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-20T11:52:11.120

一些很好的工具可以在这里尝试。Rsync 是 Linux 上权限和增量的终极版本，但在 Windows 上，您通常将它与 posix 一起使用，因此 acl 权限并不完美。

制作 delta 副本的人还从头开始制作了基于 rysnc 算法的纯 Windows 版本： [http ://web.synametrics.com/Syncrify.htm](http://web.synametrics.com/Syncrify.htm)

我还没有尝试过，但希望它能够通过 rsync 的惊人增量产品为 Windows 带来良好的权限。

# sql-server-2005 - 如何确定谁拥有单用户模式下的 SQL Server 2005 数据库？

> ID：103121
> 
> 赞同：0
> 
> 时间：2008-09-19T15:49:14.213
> 
> 标签：sql-server-2005

我有一个处于单用户模式的数据库，我正在尝试删除它，以便可以在其上重新运行创建脚本，但我被锁定了。

1.  我如何确定谁拥有它的锁？
2.  如何禁用该锁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T15:51:23.460

运行 sp_who，找到具有所需数据库名称的 spid，杀死该 spid。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:37:16.860

从 SQL Server 管理工作室：

1.  打开对象资源管理器
2.  扩展数据库服务器
3.  展开“管理”
4.  双击“活动监视器”
5.  使用所需的数据库定位进程
6.  右键单击进程
7.  点击“杀死进程”

# stored-procedures - 使用 groovy.sql Out 参数时出错

> ID：103136
> 
> 赞同：1
> 
> 时间：2008-09-19T15:50:31.620
> 
> 标签：stored-procedures, grails, groovy

我正在尝试以常规方式执行一些存储过程。通过使用直接的 JDBC，我可以很容易地做到这一点，但这似乎不符合 Grails 的精神。

我试图将存储过程称为：

```
sql.query( "{call web_GetCityStateByZip(?,?,?,?,?)}",[params.postalcode, 
sql.out(java.sql.Types.VARCHAR), sql.out(java.sql.Types.VARCHAR), 
sql.out(java.sql.Types.INTEGER), sql.out(java.sql.Types.VARCHAR)]) { rs ->
   params.city = rs.getString(2)
   params.state = rs.getString(3)
} 
```

我尝试了各种方法，例如`sql.call`. 在此之后我试图获取输出变量值。

每次错误：

```
Message: Cannot register out parameter. 
Caused by: java.sql.SQLException: Cannot register out parameter. 
Class: SessionExpirationFilter 
```

但这似乎不起作用。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-20T07:31:15.137

这仍然没有答案，所以我做了一些挖掘，虽然我不完全理解这个问题。以下来自 Groovy 源代码，也许它有一些帮助：

这条线似乎是异常的起源：

[http://groovy.codehaus.org/xref/groovy/sql/Sql.html#1173](http://groovy.codehaus.org/xref/groovy/sql/Sql.html#1173)

这似乎表明您有一个实现 PreparedStatement 的 Statement 对象，当您需要子接口 CallableStatement 时，它具有应该最终调用的 registerOutParameter() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T13:26:45.363

常规方式可能是以下代码：

```
def getHours(java.sql.Date date, User user) throws CallProceduresServiceException {

    log.info "Calling stored procedure for getting hours statistics."
    def procedure
    def hour
    try {
        def sql = Sql.newInstance(dataSource.url, user.username, user.password, dataSource.driverClassName)
        log.debug "Date(first param): '${date}'"

        procedure = "call ${dbPrefixName}.GK_WD_GET_SCHEDULED_TIME_SUM(?, ?, ?, ?)"
        log.debug "procedure: ${procedure}"

        sql.call("{${procedure}}", [date, Sql.out(Sql.VARCHAR.getType()), Sql.out(Sql.VARCHAR.getType()), Sql.out(Sql.VARCHAR.getType())]) {
            hourInDay, hourInWeek, hourInMonth -> 
            log.debug "Hours in day: '${hourInDay}'"
            log.debug "Hours in week: '${hourInWeek}'"
            log.debug "Hours in month: '${hourInMonth}'"
            hour = new Hour(hourInDay, hourInWeek, hourInMonth)
        }
        log.info "Procedure was executed."
    } 
    catch (SQLException e) {
        throw new CallProceduresServiceException("Executing sql procedure failed!"
                + "\nProcedure: ${procedure}", e)
    }       
    return hour 
} 
```

在我的应用程序中效果很好。

托马斯·彼得卡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T18:28:22.933

谢谢互联网朋友，如果我写代码像 -

```
 Sql sql = new Sql(dataSource)
Connection conn
ResultSet rs
try {
        conn = sql.createConnection()
        CallableStatement callable = conn.prepareCall(
        "{call web_GetCityStateByZip(?,?,?,?,?)}")
         callable.setString("@p_Zip",params.postalcode)
         callable.registerOutParameter("@p_City",java.sql.Types.VARCHAR)
         callable.registerOutParameter("@p_State",java.sql.Types.VARCHAR)
         callable.registerOutParameter("@p_RetCode",java.sql.Types.INTEGER)
         callable.registerOutParameter("@p_Msg",java.sql.Types.VARCHAR)
         callable.execute()
        params.city = callable.getString(2)
        params.state = callable.getString(3)
    } 
```

它以 JDBC 方式运行良好。但我想像以前使用 sql.query/sql.call 的代码一样尝试它。

任何意见？？

谢谢萨达纳

# ide - JavaScript 调试器

> ID：103155
> 
> 赞同：18
> 
> 时间：2008-09-19T15:51:48.280
> 
> 标签：ide, editor

有谁知道调试 JavaScript 的非常好的编辑器（除 Visual Studio 2008 和 FireBug 之外）吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T15:57:36.067

这是一篇文章[Advanced JavaScript Debugging Techniques](http://www.sitepen.com/blog/2008/04/03/advanced-javascript-debugging-techniques/)，它描述了几种工具的使用。我了解到的一个我以前没有听说过的新工具是[JSLint](http://www.jslint.com/)。有时[JSLint](http://www.jslint.com/)会立即向您显示导致问题的狡猾代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T15:55:22.780

Opera 有[Dragonfly](http://www.opera.com/products/dragonfly/)，不过我还是更喜欢 Firebug。在 Firebug 之前有[Venkman](http://www.mozilla.org/projects/venkman/)，尽管目前还不确定它的未来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T15:52:09.527

IE8 beta 2 有一个不错的调试器

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T16:02:03.560

[Google chrome](http://www.google.com/chrome)浏览器内置了一个合理的 wee JS 调试器。[这里](http://www.pascarello.com/lessons/browsers/ChromeDebugHelp.html)有一个很好的可用命令列表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-19T15:54:00.833

看看 Venkman，Firefox 的 JavaScript 调试器：

[http://www.mozilla.org/projects/venkman/](http://www.mozilla.org/projects/venkman/)

这是一个真正的源代码级 javascript 调试器，您可以在其中设置断点并逐步执行代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T18:58:55.117

[Aptana Studio IDE](http://www.aptana.com/studio)有一个不错的 javascript 调试器。

社区版只支持火狐，专业版也支持Internet Explorer。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T18:21:54.987

对于 Internet Explorer 调试（并且当您没有 VS 2008 时），您可以使用 MS 脚本编辑器。这是一篇关于如何正确配置它的好文章：

[http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-23T20:17:41.570

我在阿普塔纳工作。您可以在编辑器中设置断点、将鼠标悬停在变量上并进行监视。爱它。从没想过我会离开 Firebug 作为我的首席调试器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T20:21:20.297

如果您习惯使用 Firebug，您可能会喜欢用 JavaScript 实现的[Firebug Lite](http://getfirebug.com/lite.html)。您可以将其用作书签，这很好。我不确定它有多强大，我想其他“真正的”解决方案会更好，但它在紧要关头很方便。

# .net - 如何将 XML 文件转换为 .Net 类？

> ID：103157
> 
> 赞同：2
> 
> 时间：2008-09-19T15:51:52.897
> 
> 标签：.net, xml

有人可以提醒我如何从 XML 文件创建 .Net 类吗？

我更喜欢批处理命令，或者将其集成到 shell 中的方法。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:20:18.673

下面的批处理将在当前目录中从**XML创建一个 .Net****类。** 所以... XML -> XSD -> VB

 **（请随意用 CS 代替语言）

在 %UserProfile%\SendTo 目录中创建一个**Convert2Class.Bat 。**
然后复制/保存以下内容：

```
@Echo off
Set XsdExePath="C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\XSD.exe"
Set Language=VB
%~d1
CD %~d1%~p1 
%XsdExePath% "%~n1.xml" /nologo
%XsdExePath% "%~n1.xsd" /nologo /c /language:%Language% 
```

在我的机器上工作 - 祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T15:55:11.860

您也许可以使用 xsd.exe 工具生成一个类，否则您可能必须针对您的 XML 实现自定义解决方案

[XML 模式定义工具](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.80).aspx)

[XML 序列化](http://msdn.microsoft.com/en-us/library/ms950721.aspx)**

# iis - IIS ASP 缓存

> ID：103158
> 
> 赞同：2
> 
> 时间：2008-09-19T15:51:54.783
> 
> 标签：iis, caching, asp-classic

我正在尝试按照我购买的软件的说明在 IIS 中配置 ASP 缓存。这应该使它运行得更快。

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a5766228-828e-4e31-a92b-51da7d24d569.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/a5766228-828e-4e31-a92b-51da7d24d569.mspx?mfr=true)

软件说明指向那篇文章。

我遇到的问题是我的 IIS 对话框中不存在提到的“ **ASP 文件缓存部分”...**

我错过了什么吗？有什么配置可以让它出现吗？我在 W2003 Server Enterprise Edition 上运行 IIS 6.0。

更新1：我以本地管理员身份登录（框不在域中）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T16:11:19.840

右键单击 IIS 管理器中的“网站”。选择属性-> 主目录-> 配置，您将看到“缓存选项”选项卡。

诀窍是点击“网站”，而不是进入特定的网站。

# odbc - OLE DB 和 ODBC 数据源有什么区别？

> ID：103167
> 
> 赞同：187
> 
> 时间：2008-09-19T15:52:44.847
> 
> 标签：odbc, oledb

我正在阅读一篇关于 pivotcache 的 MS Excel 帮助文章，想知道*OLE DB 和 ODBC 源是什么意思*

> ...您应该使用 CommandText 属性而不是 SQL 属性，该属性现在主要是为了与早期版本的 Microsoft Excel 兼容。如果同时使用这两个属性，则 CommandText 属性的值优先。
> 
> 对于**OLE DB 源**，CommandType 属性描述了 CommandText 属性的值。
> 
> 对于**ODBC 源**，CommandText 属性的功能与 SQL 属性完全相同，设置该属性会导致数据被刷新...

我非常感谢您的简短回答。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-07-13T15:05:52.067

根据[*ADO: ActiveX Data Objects*，Jason T. Roff 的一本书，由 O'Reilly Media 于 2001 年出版](http://books.google.ca/books?id=JTKX7OUqCEMC&lpg=PP1&dq=contact%20jason%20roff%20activex%20data%20objects&pg=PA12)（这里的图表很好），他准确地表达了 MOZILLA 所说的。

（直接来自那本书的第 7 页）

> *   ODBC 仅提供对关系数据库的访问
> *   OLE DB 提供以下功能
>     *   访问数据，无论其格式或位置如何
>     *   完全访问 ODBC 数据源和 ODBC 驱动程序

因此，OLE DB 似乎通过 ODBC 驱动程序层与基于 SQL 的数据源进行交互。

![替代文字](../Images/d0e3a0265594493d849166602ebeeeae.png)

*我不是 100% 确定这张图片是正确的。* 我不确定的两个连接是通过 ADO C-api 的 ADO.NET 和通过 ODBC 到基于 SQL 的数据源的 OLE DB（因为在[此图](http://books.google.ca/books?id=JTKX7OUqCEMC&lpg=PP1&dq=contact%20jason%20roff%20activex%20data%20objects&pg=PA12)中，作者没有通过 ODBC 访问 OLE DB，我相信是一个错误）。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-04-24T09:47:52.490

ODBC：- 仅适用于关系数据库（Sql Server、Oracle 等）

OLE DB：- 适用于关系和非关系数据库。（Oracle、Sql-Server、Excel、原始文件等）

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-07-13T17:37:43.977

这是我的理解（非权威）：

ODBC 是大多数软件供应商支持的与技术无关的开放标准。OLEDB 是来自 COM 时代*的特定技术的*Microsoft API（COM 是 .NET 之前的组件和互操作性技术）

在某些时候，愿意与 Microsoft 数据消费者兼容的各种数据源供应商（例如 Oracle 等）为他们的产品开发了 OLEDB 提供程序，但在大多数情况下，OLEDB 仍然是 Microsoft 独有的标准。现在，大多数*Microsoft*数据源都允许 ODBC 和 OLEDB 访问，主要是为了与旧的 ODBC 数据消费者兼容。此外，还存在用于 ODBC 的 OLEDB 提供程序（包装器），如果愿意，它允许使用 OLEDB 访问 ODBC 数据源。

就功能而言，OLEDB 比 ODBC 丰富得多，但存在“一环一统”综合症（过于通用、过于复杂、没有意见）。

在非 Microsoft 世界中，基于 ODBC 的数据提供者和客户端被广泛使用，而且无处不在。

微软内部正在逐步淘汰 OLEDB，取而代之的是构建在该数据源的任何本机传输层之上的本机 .NET API（例如，用于 MS SQL Server 的 TDS）。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2018-07-13T15:51:37.087

ODBC 和 OLE DB 是两种相互竞争的数据访问技术。特别是关于 SQL Server，微软已经将它们都提升为他们的首选未来方向——尽管是在不同的时间。

# ODBC

ODBC 是用于访问类似表格的数据的行业标准接口。它主要是为数据库开发的，并以记录集合的形式呈现数据，每个记录都被分组到一个字段集合中。每个字段都有自己的数据类型，适合其包含的数据类型。每个数据库供应商（Microsoft、Oracle、Postgres 等）都为其数据库提供 ODBC 驱动程序。

还有对象的 ODBC 驱动程序，尽管它们不是数据库表，但它们非常相似，因此以相同的方式访问数据很有用。例如电子表格、CSV 文件和柱状报告。

# 数据库

OLE DB 是一种用于访问数据的 Microsoft 技术。与 ODBC 不同，它包含类似表格和不类似表格的数据，例如电子邮件、网页、Word 文档和文件目录。然而，它是面向过程而不是面向对象的，并且被认为是一个相当困难的接口，用于开发对数据源的访问。为了克服这个问题，ADO 被设计为 OLE DB 之上的面向对象层，并提供了一种更简单、更高级别（尽管仍然非常强大）的工作方式。ADO 的最大优势在于您可以使用它来操作特定于给定类型数据源的属性，就像您可以使用它来访问适用于所有数据源类型的属性一样容易。您不限于某些令人不满意的最低公分母。

虽然所有数据库都有 ODBC 驱动程序，但它们并不都有 OLE DB 驱动程序。但是，如果您想以类似 OLE DB 的方式访问它们，可以使用 OLE 和 ODBC 之间的接口。此接口称为 MSDASQL（用于 ODBC 的 Microsoft OLE DB 提供程序）。

# SQL Server 数据访问技术

由于 SQL Server (1) 由 Microsoft 制造，(2) Microsoft 数据库平台，*因此*ODBC 和 OLE DB 都非常适合它。

## ODBC

由于所有其他数据库平台都有 ODBC 接口，微软显然不得不为 SQL Server 提供一个接口。除此之外，DAO（Microsoft Access 中的原始默认技术）使用 ODBC 作为与所有外部数据源对话的标准方式。这使得 ODBC 接口成为必要条件。与 SQL Server 2000 一起发布的用于 SQL Server 的版本 6 ODBC 驱动程序仍然存在。已发布更新版本以处理后续版本中出现的新数据类型、连接技术、加密、HA/DR 等。截至 2018 年 9 月 7 日，最新版本是 v13.1“SQL Server 的 ODBC 驱动程序”，于 2018 年 3 月 23 日发布。

## 数据库

这是微软自己的技术，他们在大约 2002 年至 2005 年期间大力推广该技术，以及其随附的 ADO 层。他们显然希望它将成为首选的数据访问技术。（他们甚至将 ADO 设为在 Access 2002/2003 中访问数据的默认方法。）然而，最终很明显这不会发生，原因有很多，例如：

1.  世界不会转向微软技术并远离 ODBC。
2.  DAO/ODBC 比 ADO/OLE DB 更快，并且完全集成到 MS Access 中，因此不会自然死亡；
3.  Microsoft 正在开发的新技术，特别是 ADO.NET，也可以直接与 ODBC 对话。ADO.NET 也可以直接与 OLE DB 对话（从而使 ADO 陷入困境），但它并非（与 ADO 不同）完全依赖于它。

由于这些原因[和其他](https://hal2020.com/2011/09/25/ole-db-and-sql-server-history-end-game-and-some-microsoft-dirt/)原因，Microsoft 实际上[已弃用 OLE DB 作为](https://blogs.msdn.microsoft.com/sqlnativeclient/2011/08/29/microsoft-is-aligning-with-odbc-for-native-relational-data-access/)v11 (SQL Server 2012) 之后的 SQL Server 版本的数据访问技术。在此之前的几年中，他们一直在生产和更新支持 ODBC 和 OLE DB 技术的 SQL Server Native Client。然而，在 2012 年末，他们宣布他们将与 ODBC 保持一致，以便在 SQL Server 中进行本机关系数据访问，并鼓励其他所有人也这样做。他们进一步表示，在 v11/SQL Server 2012 之后的 SQL Server 版本将主动*不*支持 OLE DB！

这一宣布引发了一场抗议风暴。人们不明白为什么 MS 突然弃用了一项他们花了数年时间才让他们承诺的技术。此外，与 SQL Server 密切相关的 MS 编写的应用程序 SSAS/SSRS 和 SSIS 完全或部分依赖于 OLE DB。另一个抱怨是 OLE DB 具有某些理想的特性，似乎无法移植回 ODBC —— 毕竟，OLE DB 有很多优点。

2017 年 10 月，微软让步并[正式取消了 OLE DB](https://blogs.msdn.microsoft.com/sqlnativeclient/2017/10/06/announcing-the-new-release-of-ole-db-driver-for-sql-server/)。他们宣布即将到来的新驱动程序 (MSOLEDBSQL) 将具有 Native Client 11 的现有功能集，还将引入多子网故障转移和 TLS 1.2 支持。该驱动程序于 2018 年 3 月发布。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-05-16T12:42:46.963

• 2011 年 8 月：Microsoft**弃用**OLE DB（[Microsoft 正在与 ODBC 保持一致以实现本机关系数据访问](https://blogs.msdn.microsoft.com/sqlnativeclient/2011/08/29/microsoft-is-aligning-with-odbc-for-native-relational-data-access/)）

• 2017 年 10 月：Microsoft取消**弃用**OLE DB（[宣布新版本的 OLE DB Driver for SQL Server](https://blogs.msdn.microsoft.com/sqlnativeclient/2017/10/06/announcing-the-new-release-of-ole-db-driver-for-sql-server/)）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-19T16:12:33.877

在非常基本的层面上，这些只是针对不同数据源（即数据库）的不同 API。OLE DB 更新并且可以说更好。

您可以在 Wikipedia 中阅读有关这两个方面的更多信息：

1.  [数据库](http://en.wikipedia.org/wiki/OLE_DB)
2.  [ODBC](http://en.wikipedia.org/wiki/Open_Database_Connectivity)

即，您可以使用 ODBC 驱动程序或 OLE DB 驱动程序连接到同一个数据库。在这些情况下，数据库行为的差异就是您的书所指的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-10-08T13:44:48.607

两者都是数据提供者（您的代码将用来与数据源对话的 API）。1998 年推出的 Oledb 旨在替代 ODBC（1992 年推出）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-19T16:19:54.063

我不确定所有细节，但我的理解是 OLE DB 和 ODBC 是两个 API，可用于连接到各种类型的数据库，而无需处理每个数据库的所有实现特定细节。根据[关于 OLE DB 的 Wikipedia 文章](http://en.wikipedia.org/wiki/OLE_DB "维基百科关于 OLE DB 的文章")，OLE DB 是 Microsoft 对 ODBC 的继承者，并提供了一些您可能无法使用 ODBC 完成的功能，例如将电子表格作为数据库源访问。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-12T01:06:48.083

在微软网站上，显示原生OLEDB Provider 直接应用于SQL Server，另外一个OLEDB Provider 叫做OLEDB Provider for ODBC 来访问其他数据库，如Sysbase、DB2 等。OLEDB Provider 下有不同种类的组件。有关更多信息，请参阅[MSDN 上的分布式查询](http://msdn.microsoft.com/en-us/library/ms188721(v=SQL.105).aspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-19T06:36:06.890

ODBC 仅适用于关系型数据库，它不能用于非关系型数据库，例如 Ms Excel 文件。Olebd 可以做任何事情的地方。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2016-09-07T04:21:59.170

要知道 M$ 发明 OLEDB 的原因，不能将 OLEDB 与 ODBC 进行比较。相反，您应该将 OLEDB 与 DAO、RDO 或 ADO 进行比较。后者很大程度上依赖于 SQL。但是，OLEDB 依赖于 COM。但是 ODBC 已经存在很多年了，所以有一个 OLEDB-ODBC 桥可以解决这个问题。我认为当 M$ 发明 OLEDB 时会有大图景。

# asp.net - 找出适合工作的语言：从 C# 分支

> ID：103174
> 
> 赞同：4
> 
> 时间：2008-09-19T15:53:19.697
> 
> 标签：asp.net, programming-languages

我在 Microsoft 环境中工作，所以我可以在遇到的任何钉子上使用我的 C# 锤子。话虽如此，哪些语言（编译、解释、脚本、功能、任何类型！）补充了了解 C#，以及出于什么目的？例如，我已经将许多脚本功能从已编译的控制台应用程序移到了 Powershell 脚本中。如果您是一名 MS 开发人员，您是否在您的世界中为其他语言（如 F#、IronRuby、IronPython 或类似语言）找到了一个利基市场，它们填补了哪些利基市场？

注意：这个问题是针对微软开发人员的，因为我不能跑掉并开始在我的公司周围安装 LAMP 堆栈，因此必须永远支持它。:) 但是，除了您的主要语言之外，请随意提及您发现有趣的任何其他语言来完成您的世界中的某个任务/角色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T16:06:48.883

Python/Perl/Ruby/PowerShell 是 C#/VB.NET 的重要补充。如果你的老板递给你一个文本文件并说将它插入数据库一次或两次，那么 Perl/Python/Ruby 中的任何一个（我不确定 powershell，但我想它并没有那么困难）应该没问题解析它。无论哪种方式，对于您的主要应用程序，您可能会卡在 C# 中。您可以使用其中一种更动态的语言在 C# 中进行代码生成。

由于您处于 Microsoft 环境中，因此让您的解决方案被接受的最佳机会可能是 PowerShell。接下来我会说 IronPython 或其他与 CLR 集成的东西。但主要问题是，要让其他人维持您的工作，他们必须知道您使用的任何语言。MS 未来计划更多地使用 PowerShell，因此证明 PowerShell 的合理性可能比 Python/Perl/Ruby 更容易。

如果您只是一次性处理一个文本文件。或者创建一次性代码生成器来生成所有代码，然后打算维护生成的代码，那就没关系了。您将使用结果，如果您使用 Perl 节省时间，那么您将获得更多的权力。但是，如果您正在做一些会被反复使用的事情（比如一个活动的代码生成器，您可以在其中更改模板并运行生成器而不是维护生成的代码），那么从事您所做工作的其他开发人员将需要了解该语言你用过。在 Microsoft 商店中学习 Perl/Ruby/Python 更难争论。但 PowerShell 似乎是更简单的论点。我认为 MS 的宏伟计划是最终应用程序将通过命令行开关为 power shell 提供更多功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T15:54:49.817

一个好的脚本语言总是一个很好的工具。请参阅[Ruby](http://www.ruby-lang.org/en/)或[Python](http://www.python.org/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T15:57:21.153

我使用 python 进行原型设计，因为在编辑和实际运行新版本代码之间几乎没有周转时间。我什至可能最终将它用于一个真正的项目——我用得越多，我就越喜欢它。

不过，作为 C# 程序员需要一些时间来适应 - 它使用的缩进定义结构系统起初有点奇怪。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T16:12:56.327

由于您在 MS 商店，我建议将[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)作为一种体面的脚本语言来学习。它与 C# 配合得很好。我也是 Ruby 的忠实粉丝。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T16:07:40.847

虽然它有点像边缘语言，但我不得不提到[Erlang](http://www.erlang.org/index.html)。Erlang 是您的工具箱中的一门出色的语言，因为它的不同寻常的优势往往与其他编程平台相得益彰。Erlang 对于构建分布式、并发、容错系统非常有用。在需要分布式但互连架构的即时消息和电话领域中，它被大量使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T16:15:03.840

我想要第二或第三条蟒蛇。具体来说，IronPython (ttp://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython) 可以让您学习 python，但也可以让您访问 .net 框架的好东西。

它非常适合与脚本相关的任务，因此它可能对您的日常编码生活很有用，也是一种以实验性编码/原型设计方式进行混杂的好方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T18:33:22.517

也许和 Boo 一起玩，看看你的想法。
[Codehaus.org上的](http://boo.codehaus.org/)
[嘘声 维基百科上的嘘声](http://en.wikipedia.org/wiki/Boo_(programming_language))

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-11T13:11:42.897

如果您使用 .Net 框架，那么语言实际上并不重要，因为编译器和解释器在任何情况下都会创建相同的 IL 代码。

如果您离开 .Net 世界，我认为开发工具和语言就是一个工具箱。我努力为手头的工作使用正确的工具，同时考虑到其他开发人员的技能基础以及公司正在寻求的方向（我是一名顾问）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T15:57:06.317

我和 jjnguy 在一起。尝试其中一种脚本语言。另外作为奖励，当您学习 Ruby/PythonPearl 等时……它是一种入门药物……为其他环境开发的错误语言。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T16:32:45.280

尝试常规工具箱之外的语言将为您提供以您当前最喜欢的语言处理事物的新方法。即使您不将它们用于严肃的项目语言，例如 Perl（用于数据处理）、Lisp（[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)）和 Javascript（[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)），也会教您以新的方式思考当前语言中的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T16:43:56.330

作为一名专业的 Web 开发人员，您可能会研究 XSLT/XPath 系列，因为对于某些类型的 XML 处理，它们可能是非常强大的工具。

当然，在 C# 3.x 中，Linq2Xml 公开了一些类似的内联功能。

但是，XSLT 可以成为将数据与应用程序中的表示分离的强大方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T16:49:18.673

我对 F# 和 CLR/DLR 中的其他一些新语言非常感兴趣。DLR 语言可能更适合您的 UI，因为它们不会让您做出很多愚蠢的事情。

然而，我认为重要的是要记住学习一门新语言，尤其是在一个新领域，比如函数式编程，总是一种重新训练你的思维的好方法，这样你就可以接触到新的概念，并且你可以即使您从未使用过这些新语言，也可以使用您选择的语言更好地编写代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-05T18:43:03.230

查看 Boo - 它运行在 .NET 堆栈之上，但它的语法更像 Python。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-11T13:13:31.550

要学习补充 C# 的新语言，我会选择 C++。您可以以“比 p/invoke 更好的方式”使用它来从 C# 应用程序访问非托管代码。然后，如果您发现某些 .NET 应用程序开始占用所有 RAM 和/或 CPU 或者通常速度不及你想要。

# c# - 在 C# 中枚举证书字段

> ID：103177
> 
> 赞同：0
> 
> 时间：2008-09-19T15:53:41.583
> 
> 标签：c#, security, cryptography, certificate

您如何枚举商店中证书帮助的字段。具体来说，我正在尝试枚举颁发给登录用户的个人证书的字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T15:58:25.220

请参阅[http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509store.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509store.aspx)

```
using System.Security.Cryptography.X509Certificates;
...
var store = new X509Store(StoreName.My);
foreach(var cert in store.Certificates)
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T18:27:45.560

您还必须使用**store.open()**才能访问商店。

# .net - 在哪里可以找到 Visual Studio 中尚未包含的 Microsoft 程序集？

> ID：103178
> 
> 赞同：1
> 
> 时间：2008-09-19T15:53:44.953
> 
> 标签：.net, visual-studio, assemblies, gac, adfs

我认为有人可以普遍回答这个问题，但如果有人想具体说明我正在尝试使用：

使用 System.Web.Security.SingleSignOn；使用 System.Web.Security.SingleSignOn.Authorization；

我已经用谷歌搜索了我的大脑，这是我找到的最接近的答案：

“我们离线讨论了这个问题，但看起来 ADFS 程序集是 GACed，但没有安装在文件系统上或在 VS.NET 中注册，因此它显示在 .NET 选项卡中。我猜 MS 可能需要加强此方案的安装程序。与此同时，您可能需要自己执行此操作。”

到底是什么，我自己做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:19:57.853

我发现一个[安装日志](http://web2.minasi.com/forum/topic.asp?TOPIC_ID=23116)显示它应该在

> C:\WINDOWS\ADFS\System.Web.Security.SingleSignon.dll

在 Windows Server 2003 上。您可能需要安装活动目录才能让它出现在那里，因为我检查了一台没有 AD 的 2003 服务器，但它不存在。

通常我会猜测 DLL 将在系统范围的全局程序集缓存 (GAC) 中注册，因此您不必知道它的实际路径。如果程序集在 GAC 中注册，则可以通过打开“添加引用”对话框并单击“.NET”选项卡来添加对它的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:17:34.270

你可以在这个文件中找到指定的命名空间：*system.web.security.singlesignon.claimtransforms.dll*

但是这个文件通常不可用，只能安装在 GAC（全局程序集缓存）中。您可以在例如*c:\window\assembly...*下找到它，然后将 dll 复制到另一个路径。然后您可以在 Visual Studio 中手动引用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:03:43.367

对于使用特定环境（如 SharePoint 对象模型）的项目，建议使用安装在 GAC 程序集中的虚拟 PC。ADFS 程序集应该只有 Win 服务器。如果您找到它们并在工作环境（桌面）中手动安装，则某些可能性（如调试）并非不可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:38:39.213

如果您尝试将程序集添加到 Visual Studio“添加引用”对话框中的“.NET”选项卡，则需要进行注册表设置。[KB30149 更详细地解释了它。](http://support.microsoft.com/kb/306149)简短版本：您需要向`HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework\AssemblyFolders`注册表项添加一个条目。

If you're trying to locate a physical file corresponding to an assembly in the GAC, drop to a command prompt and go to `%WINDIR%\Assembly` (e.g., `C:\WINDOWS\Assembly`). Navigate around in there - that's where GAC'd assemblies live.

# java - 如何在 Swing 中全局设置应用程序的图标？

> ID：103179
> 
> 赞同：9
> 
> 时间：2008-09-19T15:54:00.520
> 
> 标签：java, swing

我知道我可以为每个表单或根表单指定一个，然后它将级联到所有子表单，但我希望有一种方法可以覆盖所有表单的默认 Java 咖啡杯，即使是那些我可能会忘记。

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T16:07:08.930

您可以使根形式（我假设您的意思是`JFrame`）成为您自己的子类`JFrame`，并将标准功能放入其构造函数中，例如：

```
this.setIconImage(STANDARD_ICON); 
```

您也可以在此处捆绑其他标准内容，例如将框架的窗口度量存储为用户偏好、管理启动窗格等。

由这个产生的任何新帧也将是这个`JFrame`子类的实例。您唯一需要记住的是实例化您的子类，而不是`JFrame`. 我认为没有什么可以替代记住这样做，但至少现在是记住子类而不是`setIconImage`调用（可能还有其他功能）的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T17:42:53.910

还有另一种方法，但它更像是一种“黑客”，而不是真正的修复....

如果您将 JRE 与您的应用程序一起分发，您可以用您自己的图标替换 java exe/dll/rt.jar 中的咖啡杯图标资源。这可能不是很合法，但有可能......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:40:43.790

此外，如果您有一个“主”窗口，并且正确设置了它的图标，只要您将该主窗口用作任何 Dialog 类的“父”窗口，它们就会继承该图标。但是，任何新框架都需要在其上设置图标。

正如 Paul/Andreas 所说，继承 JFrame 将是你最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T15:57:23.040

扩展 JDialog 类（例如将其命名为 MyDialog）并在构造函数中设置图标。然后所有对话框都应该扩展您的实现（MyDialog）。

# hash - 防止重复使用信用卡的最佳方法

> ID：103184
> 
> 赞同：19
> 
> 时间：2008-09-19T15:54:16.807
> 
> 标签：hash, cryptography, credit-card

我们有一个系统，我们希望防止为两个不同的帐户注册相同的信用卡号。由于我们没有在内部存储信用卡号 - 只是最后四位数字和到期日期 - 我们不能简单地比较信用卡号和到期日期。

我们目前的想法是在信用卡注册时在我们的信用卡信息系统中存储一个哈希值（SHA-1），并比较哈希值以确定一张卡之前是否被使用过。

通常，使用盐来避免字典攻击。我假设在这种情况下我们很容易受到攻击，所以我们可能应该将盐与哈希一起存储。

大家觉得这个方法有什么缺陷吗？这是解决这个问题的标准方法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-19T18:46:13.367

让我们做一些数学运算：信用卡号码的长度为 16 位。前七位数字是“主要行业”和发行人编号，最后一位数字是 luhn 校验和。剩下 8 位数字“免费”，总共 100,000,000 个帐号，乘以潜在发行人编号的数量（这不太可能很高）。有些实现可以在日常硬件上每秒执行数百万次哈希，所以无论你做什么加盐，这对蛮力来说都不是什么大问题。

纯属巧合，在寻找提供哈希算法基准的东西时，我发现[了这篇关于存储信用卡哈希](http://www.integrigy.com/oracle-security-blog/topics/PCI)的文章，它说：

> 使用简单的单次哈希算法存储信用卡，即使是加盐的，也是很傻的。如果哈希值被泄露，暴力破解信用卡号码太容易了。
> 
> ...
> 
> 散列信用卡号时，必须仔细设计散列，以通过使用最强的可用加密散列函数、大盐值和多次迭代来防止暴力破解。

完整的文章非常值得仔细阅读。不幸的是，结果似乎是任何使存储散列信用卡号码“安全”的情况也会使搜索重复项的成本过高。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T16:52:57.167

我认为人们在考虑这个设计。使用像 sha-256 这样的加盐、高度安全（例如“计算成本高”）的散列，每个记录都有唯一的加盐。

您应该首先进行低成本、高精度的检查，然后只有在检查成功时才进行高成本的确定性检查。

步骤1：

寻找最后 4 位数字的匹配项（也可能是到期日期，尽管可能需要解决一些细微的问题）。

第2步：

如果简单检查成功，请使用盐，获取哈希值，进行深度检查。

cc# 的最后 4 位是最独特的（部分原因是它也包括 LUHN 校验位），因此您将执行的深度检查的百分比最终不会匹配（误报率）将非常，非常低（百分之几），相对于天真的“每次都进行哈希检查”设计，这可以为您节省大量开销。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-12T18:03:47.133

不要存储信用卡号的简单 SHA-1，这**太***容易*破解（特别是因为知道最后 4 位数字）。我们在公司遇到了同样的问题：我们是这样解决的。

 ****第一个解决方案**

1.  对于每张信用卡，我们存储最后 4 位数字、到期日期、长随机盐（50 字节长）和 CC 号码的盐渍哈希。我们使用 bcrypt 哈希算法是因为它非常安全，并且可以根据需要调整为 CPU 密集型。我们将其调整为*非常*昂贵（我们服务器上的每个哈希大约需要 1 秒！）。但我想您可以改用 SHA-256 并根据需要进行多次迭代。
2.  当输入一个新的 CC 号码时，我们首先查找所有以相同 4 位数字结尾且具有相同到期日期的现有 CC 号码。然后，对于每个匹配的 CC，我们检查其存储的加盐散列是否与根据其盐和新的 CC 编号计算的加盐散列相匹配。换句话说，我们检查是否`hash(stored_CC1_salt+CC2)==stored_CC1_hash`.

由于我们的数据库中有大约 10 万张信用卡，我们需要计算大约 10 个哈希值，因此我们在大约 10 秒内得到结果。在我们的例子中，这很好，但您可能需要稍微调整 bcrypt。不幸的是，如果你这样做了，这个解决方案的安全性就会降低。另一方面，如果您将 bcrypt 调整为更加占用 CPU 资源，则匹配 CC 编号将花费更多时间。

尽管我相信这个解决方案比简单*地*存储 CC 号码的未加盐哈希要好得多，但它不会阻止一个非常积极的盗版者（他们设法获得数据库的副本）在平均2到5年。所以如果你的数据库里有 10 万张信用卡，如果海盗有*很多*CPU，那么他每天可以恢复几个信用卡号！

这使我相信您不应该自己计算哈希：您必须将其委托给其他人。这是第二种解决方案（我们正在迁移到第二种解决方案）。

**第二种解决方案**

只需让您的支付服务提供商为您的信用卡生成别名即可。

1.  对于每张信用卡，您只需存储您想要存储的任何内容（例如最后 4 位数字和到期日期）**以及**信用卡号别名。
2.  当输入新的信用卡号时，您联系您的支付提供商并提供 CC 号码（或者您将客户重定向到支付提供商，他直接在支付提供商的网站上输入 CC 号码）。作为回报，您将获得信用卡别名！而已。当然，您应该确保您的支付提供商提供此选项，并且生成的别名实际上是安全的（例如，确保他们不会简单地计算信用卡号上的 SHA-1！）。现在，如果盗版者想要恢复信用卡号码，就必须破坏您的系统**以及您的支付提供商的系统。**

它简单、快速、安全（好吧，至少如果您的支付提供商是的话）。我看到的唯一问题是它将您与您的支付提供商联系在一起。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T16:43:17.907

[PCI DSS](https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml)声明您可以使用强单向哈希存储 PAN（信用卡号）。他们甚至不需要加盐。也就是说，您应该使用唯一的每张卡值对其进行盐分。到期日是一个好的开始，但可能有点太短了。您可以从卡中添加其他信息，例如发行人。您不应该使用 CVV/安全号码，因为您不能存储它。如果您确实使用了到期日期，那么当持卡人获得一张具有相同号码的新卡时，它将被视为另一张卡。根据您的要求，这可能是好事也可能是坏事。

使您的数据更安全的一种方法是使每个操作的计算成本很高。例如，如果你 md5 两次，攻击者将花费更长的时间来破解代码。

生成有效的信用卡号并尝试为每个可能的到期日收费是相当简单的。但是，它的计算成本很高。如果你让破解你的哈希变得更昂贵，那么任何人都不值得打扰；即使他们有盐、哈希和你使用的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-11T08:02:30.310

我相信我已经找到了解决这个问题的万无一失的方法。如果我的解决方案存在缺陷，请有人纠正我。

1.  在 EC2、Heroku 等上创建一个安全服务器。该服务器将服务于一个目的且只有一个目的：散列您的信用卡。
2.  在该服务器上安装安全的 Web 服务器（Node.js、Rails 等）并设置 REST API 调用。
3.  在该服务器上，使用唯一的盐（1000 个字符）和 SHA512 1000 次。

这样，即使黑客得到了你的哈希值，他们也需要**闯入你的服务器**才能找到你的公式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T16:13:29.053

@Cory R. King

SHA 1 本身并没有损坏。文章显示的是，可以在不到蛮力的时间内生成 2 个具有相同哈希值的字符串。您仍然无法在合理的时间内生成等同于特定哈希的字符串。两者有很大的不同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T15:58:17.937

比较哈希是一个很好的解决方案。不过，请确保您不只是用相同的恒定盐对所有信用卡号码进行盐分。在每张卡上使用不同的盐（如有效期）。这应该使您不受字典攻击的影响。

从[这篇编码恐怖文章](http://www.codinghorror.com/blog/archives/000953.html)：

> 为您存储的每个密码添加一个长的、唯一的随机盐。盐（或随机数，如果您愿意）的目的是使每个密码唯一且足够长，以至于蛮力攻击是浪费时间。因此，用户的密码不是存储为“myspace1”的哈希值，而是最终存储为 128 个字符的随机 unicode 字符串 +“myspace1”的哈希值。你现在完全免疫彩虹桌攻击。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T15:58:59.807

**几乎是个好主意。**

只存储哈希是一个好主意，它在密码世界中已经服务了几十年。

添加盐*似乎*是一个不错的主意，并且确实使攻击者的暴力攻击变得更加困难。但是，当您实际检查以确保新 CC 是唯一的时，该盐会花费您很多额外的精力：您必须对您的新 CC 编号 N 次进行 SHA-1，其中 N 是您拥有的盐的数量已经用于您要与之比较的所有 CC。如果您确实选择了好的随机盐，则必须对系统中的所有其他卡进行哈希处理。所以现在是你在做蛮力。所以我会说这不是一个可扩展的解决方案。

您会看到，在密码世界中，salt 不会增加任何成本，因为我们只想知道明文 + salt 是否会散列到我们为该特定用户存储的内容中。您的要求实际上是完全不同的。

你必须自己权衡权衡。如果数据库被盗，添加盐不会使您的数据库安全，它只会使解码变得更加困难。有多难？如果它将攻击从需要 30 秒更改为需要 1 天，那么您一无所获——它仍然会被解码。如果它将它从一天更改为 30 年，那么您已经取得了一些值得考虑的事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T15:56:42.840

是的，在这种情况下，比较哈希应该可以正常工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T15:57:55.440

加盐哈希应该可以正常工作。拥有一个每用户加盐的系统应该有足够的安全性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T16:02:27.333

SHA1[坏了](http://www.schneier.com/blog/archives/2005/02/sha1_broken.html)。当然，没有太多关于什么是好的替代品的信息。沙2？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T16:08:41.390

如果您将卡号的最后 4 位数字与持卡人的姓名（或只是姓氏）和到期日期结合起来，您应该有足够的信息来使记录独一无二。散列对安全性很好，但是您不需要存储/调用盐来复制散列以进行重复检查吗？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T16:13:02.363

我认为上面暗示的一个好的解决方案是存储一个哈希值，比如卡号、到期日期和名称。这样您仍然可以进行快速比较...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T16:13:45.310

Sha1*坏*了在这里不是问题。所有损坏的意思是计算碰撞（具有相同 sha1 的 2 个数据集）比您预期的更容易。这可能是基于 sha1 接受任意文件的问题，但它与内部散列应用程序无关。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-09-14T13:29:56.997

如果您使用的是像 Stripe / Braintree 这样的支付处理器，让他们来做“繁重的工作”。

它们都提供卡指纹识别，您可以安全地存储在您的数据库中，稍后进行比较以查看卡是否已经存在：

*   Stripe 返回`fingerprint`字符串 - 见[doc](https://stripe.com/docs/api#card_object)
*   Braintree 回归`unique_number_identifier string`- 见[文档](https://developers.braintreepayments.com/javascript+ruby/reference/objects/credit-card)**

# java - Eclipse 有宏记录器吗？

> ID：103202
> 
> 赞同：115
> 
> 时间：2008-09-19T15:55:52.373
> 
> 标签：java, eclipse, ide, editor, macros

是否有用于录制和播放宏的好 Eclipse 插件？

我试过[这个](http://web.archive.org/web/20161025001953/http://www.bdaum.de:80/eclipse/)，但它对我没有任何好处——它似乎还没有准备好迎接黄金时段。

我知道编辑器模板，但我正在寻找可以用来记录我的击键然后多次应用于一堆文本的东西。

这似乎是 IDE 中的一个奇怪的漏洞。我是否为此缺少一些内置工具？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-24T13:36:39.970

我在过去一个月左右整理了一些东西，以便您发现有用。它有局限性，因为 Eclipse 编辑器/命令在设计时没有考虑到宏支持，但我认为它工作得相当好。几天前，我刚刚在 SourceForge 上发布了[Practical Macro 。](http://sourceforge.net/projects/practicalmacro/files/)它需要 Eclipse 3.4。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-04-23T18:14:45.333

Emacs+ 版本 3.x 将键盘宏 ( [http://www.mulgasoft.com/emacsplus](http://www.mulgasoft.com/emacsplus) ) 添加到其功能集中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T16:23:16.707

> 这似乎是 IDE 中的一个奇怪漏洞，我是否缺少一些内置工具？

这是一个常见的问题。Eclipse 跟踪器中为此打开了大约四个错误。不幸的是，您可能会在 Eclipse v4.0 或更高版本中看到宏。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-09-24T19:44:59.240

我使用 AutoHotKey 取得了成功（不过，仅限于 Windows）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-21T06:00:19.090

[有一个名为Eclipse Monkey](http://www.eclipse.org/proposals/eclipse-monkey/)的插件允许编写在 IDE 中执行的脚本。由于缺乏兴趣，它在大约一个月前[被终止。](http://wiki.eclipse.org/Eclipse_Monkey)

[它基于一个名为Groovy Monkey](https://github.com/fmjrey/Groovy-Monkey)的旧插件。如果你谷歌它，你仍然可以得到它。Aptana 团队有[更多](http://aptana.com/monkey/)关于使用它的信息。

请注意，这允许编写脚本，但不允许记录操作。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-02-25T12:29:39.313

这不是 Eclipse 特定的，但也可以在那里使用：

[http://sikuli.org/](http://sikuli.org/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-24T23:22:00.497

只是为了记录，还有另一个名为[MacroSchmacro](http://web.archive.org/web/20070724060839/https://macroshmacro.dev.java.net/)的项目执行 Eclipse 宏，但它没有记录很多重要的事情（比如搜索导航）。它也非常慢。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-09-29T05:06:52.950

对于 Windows 计算机上的简单文本扩展，您可以使用[AutoHotkey](http://en.wikipedia.org/wiki/AutoHotkey)。它不像大多数宏工具那样强大，但由于它不依赖于任何一个程序，它可以在其他编辑器、电子邮件等中使用。

例如，如果我输入“;;ln”，AutoHotkey 会立即发送击键来删除它并将其替换为“System.out.println();” 光标在括号之间。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-10-18T21:08:10.140

谈到 Emacs，[jEdit](https://en.wikipedia.org/wiki/JEdit)有一个非常强大的宏工具。有很多高质量的宏和插件，并且已经内置了几个宏。您甚至可以使用 bean 脚本添加一些逻辑，这类似于 VBA。所以，你可以写出非常强大的东西（很多人都这样做过）。

jEdit 显然是一个独立的编辑器，但我认为它值得一试。见[http://www.jedit.org/](http://www.jedit.org/)

# java - 您将如何在 Java 中实现安全的静态登录凭据系统？

> ID：103203
> 
> 赞同：3
> 
> 时间：2008-09-19T15:56:10.173
> 
> 标签：java, security, encryption, https

我们最近进行了一次安全审计，它暴露了这里现有系统中的几个弱点。由此产生的任务之一是我们需要更新我们的合作伙伴凭据系统，使其更加安全。

“旧”的做事方式是生成一个（错误的）密码，将其提供给具有 ID 的合作伙伴，然后他们将通过 https 发送该 ID 和该密码的 Base 64 编码副本以及他们的所有 XML 请求. 然后我们对它们进行解码并验证它们。

这些密码不会改变（因为我们的合作伙伴必须进行编码/配置更改才能更改它们，并且与数百个合作伙伴针对多个环境协调密码到期将是一场噩梦），并且它们不必由人类输入或人类可读的。如果我们的合作伙伴有更好但仍然相对简单的实施，我愿意改变这一点。

基本上它归结为两件事：我需要一个更安全的 Java 密码生成系统，并确保它们以安全的方式传输。

我发现了一些手动密码生成器，但没有什么能真正突出作为执行此操作的标准方法（也许有充分的理由）。可能还有一种比通过 https 进行简单 Base 64 编码更安全的方式来传输它们。

您会为密码生成器做什么，您认为现有的传输方法是否足够安全？

编辑：XML 来自 SOAP 消息，凭据位于标头中，而不是 XML 本身。此外，由于在设置密码时，每个合作伙伴的密码都是一次性操作，因此我们不太担心生成器的效率。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T17:11:02.067

### 密码生成

至于对传输密码进行编码，唯一真正增加安全性的编码是加密。使用 Base-64 或十六进制不是为了安全，而只是为了能够将其包含在 XML 等文本格式中。

熵用于衡量密码质量。因此，使用随机“硬币翻转”选择每一位将为您提供最优质的密码。您希望密码与其他加密密钥一样强大，因此我建议至少 128 位的熵。

有两种简单的方法，具体取决于您希望如何将密码编码为文本（从安全角度来看，这并不重要）。

对于[Base-64](http://en.wikipedia.org/wiki/Base64)，使用如下内容：

```
 SecureRandom rnd = new SecureRandom();
  /* Byte array length is multiple of LCM(log2(64), 8) / 8 = 3\. */
  byte[] password = new byte[18];
  rnd.nextBytes(password);
  String encoded = Base64.encode(password); 
```

以下内容不需要您提供 Base-64 编码器。生成的编码不是那么紧凑（26 个字符而不是 24 个），并且密码没有那么多的熵。（但 130 位已经很多了，与人类选择的至少 30 个字符的密码相当。）

```
SecureRandom rnd = new SecureRandom();
/* Bit length is multiple of log2(32) = 5\. */
String encoded = new BigInteger(130, rnd).toString(32); 
```

创建新的 SecureRandom 对象的计算成本很高，因此如果您要频繁生成密码，您可能需要创建一个实例并保留它。

### 更好的方法

将密码嵌入 XML 本身似乎是一个错误。

首先，您似乎希望在处理他们发送给您的任何文件之前对发件人进行身份验证。假设我讨厌你的胆量，并开始向你发送巨大的 XML 文件来执行拒绝服务攻击。您是否只想解析 XML 以发现我不是合法合作伙伴？如果 servlet 只是预先拒绝来自未经身份验证的用户的请求，不是更好吗？

其次，您的合法合作伙伴的密码在传输过程中受到 HTTPS 的保护，但现在它们很可能以“明文形式”存储在您系统的某个地方。那安全性很差。

更好的方法是在合作伙伴向您发送包含 HTTP 请求标头中的凭据的文档时对其进行身份验证。如果您只允许 HTTPS，则可以将密码完全从文档中取出，并将其放入[HTTP“基本”身份验证](http://www.ietf.org/rfc/rfc2617.txt)标头中。它在传输过程中受到 SSL 的保护，并且不会以明文形式存储在您的系统中（您仅存储单向哈希以用于身份验证）。

HTTP 基本身份验证简单、受广泛支持，并且比 SSL 客户端证书更容易为您和您的合作伙伴实施。

### 保护文档内容

如果文档本身的内容是敏感的，那么它们确实应该由发件人加密，并由您以加密形式存储。最好的方法是使用公钥加密，但这将是另一个问题的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:51:54.267

我不清楚为什么您的审计团队认为通过 SSL（通过 HTTPS）传输密码是“不安全的”。因此，当您要求两件事时，似乎第二件事——确保密码以安全的方式传输——已经得到很好的处理。

至于第一个，我们必须知道审计将您的密码暴露为不安全的情况......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T15:24:23.983

我会放弃整个密码方法并开始使用允许 2 端经过身份验证的 SSL 连接的客户端证书。

您必须为每个客户端生成并签署单独的证书。在 SSL 握手中，您请求客户端的证书并对其进行验证。如果失败，则连接以 401 状态码结束。

您可以随时撤销证书，从而轻松断开以前的客户。

由于所有这些都发生在通信之前的握手中，因此不可能用数据淹没您的服务器。

# asp.net - 在 RDLC 表中查找第一行

> ID：103240
> 
> 赞同：0
> 
> 时间：2008-09-19T15:59:31.083
> 
> 标签：asp.net, asp.net-2.0, rdlc

我在 RDLC 报告中有一个用作子报告的表，该表的第一列是静态字符串。有谁知道我如何确定一行是否是表中的第一行。我尝试使用 "=First("My String")" 但它没有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T18:34:02.553

[查看ThatBloke 在他的回答中](https://stackoverflow.com/questions/103240/finding-first-row-in-a-rdlc-table#103388)提供的链接，我找到了 RowNumber 命令。

这意味着这有效：

```
=IIf(RowNumber(Nothing)=1,"myString", "") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:19:49.350

聚合函数与“范围”一起使用，指的是这篇 MSDN 文章中的段落范围，可能会有所帮助......

[http://msdn.microsoft.com/fr-fr/library/ms252112(VS.80).aspx](http://msdn.microsoft.com/fr-fr/library/ms252112(VS.80).aspx) "

据我了解，您可能必须定义一个范围或尝试 =First("MyString", Nothing)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T10:51:07.637

=IIF((RowNumber(Nothing) Mod <>)=0)

<> 指明要显示的行数

# visual-studio - VB6/Crystal Report 8.5 错误：这里需要一个字符串

> ID：103261
> 
> 赞同：1
> 
> 时间：2008-09-19T16:01:52.420
> 
> 标签：visual-studio, vb6, crystal-reports

我最近继承了一个旧的 Visual Basic 6/ Crystal Reports 项目，它连接到一个 sql server 数据库。当我尝试运行项目时收到的错误消息（错误# -2147191803 A String is required here）似乎缩小到以下代码中的 .Printout 命令：

```
        '登录数据库
        设置表 = Report.Database.Tables
        设置表 = Tables.Item(1)

        Table.SetLogOnInfo ConnName, DBName, user, pass
        域名 = CStr（已选择）
        '设置参数字段
            '声明参数持有者
            设置 ParamDefs = Report.ParameterFields
            '存储参数对象
            对于 ParamDefs 中的每个 ParamDef
                使用 ParamDef
                    MsgBox("域名：" + 域名)
                    选择案例 .ParameterFieldName
                        案例“公司名称”
                        .SetCurrentValue 域名

                    结束选择

                    选择案例.名称
                         案例“{?公司名称}”
                         .SetCurrentValue 域名
                    结束选择
                    '标记以查看分配给当前值的内容
                    MsgBox("paramdef:" + ParamDef.Value)
                结束于
            下一个

        Report.EnableParameterPrompting = False

        Screen.MousePointer = vbHourglass
        'CRViewer1.ReportSource = 报告
        'CRViewer1.ViewReport

        测试 = 1
        **报告.打印输出**

        测试 = 测试 + 3

        当前时间 = Str(现在)
        当前时间=替换（当前时间，“/”，“-”）
        当前时间=替换（当前时间，“：”，“-”）
        域名=替换（域名，“。”，“”）

        startName = mPath + "\crysta~1.pdf"
        endName = mPath + "\" + DomainName + "\" + DomainName + " " + currenttime + ".pdf"
        rc = MsgBox("等待 PDF 作业完成", vbInformation, "H/W Report")

        名称 startName 作为 endName
        Screen.MousePointer = vbDefault
    万一

```

在运行期间，表单显示，ParamDef 变量设置“公司名称”，当它到达提示打印的**Report.PrintOut**行时，它会抛出错误。我猜水晶报告没有收到“公司名称”来正确运行水晶报告。有谁知道如何诊断这个......无论是在vb6还是水晶报告方面来确定我在这里遗漏了什么？

**更新：**

*   插入 CStr(selected) 以强制 DomainName 为字符串
*   将 msgboxes 插入到 .setcurrentvalue 行上方和下方的 for 循环中
*   插入 Case "{?Company Name}" 语句以查看是否有助于设置值
*   尝试了其他论坛网站建议的 .AddCurrentValue 和 .SetCurrentValue 函数
*   排除这是我的开发环境..将它加载到另一台机器上，在 winxp prof sp2 上运行完全相同的 vb6 水晶报告 8.5 并出现相同的错误。

当我运行 MsgBox(ParamDef.Value) 时，它也会出现相同的缺失字符串错误。我也找不到关于 craxdrt.ParameterFieldDefinition 类的任何文档，以查看还有哪些其他隐藏函数可用。当我看到方法和属性变量的列表时，它没有将 SetCurrentValue 列为函数之一。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T16:26:43.547

selected is a string variable input taken from a form with a drop down select box. I previously put a message box there to ensure there the variable is passing through right before the Report.Printout and it does come up. DomainName variable is also declared as a string type.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T18:20:10.560

这是我在 Crystal 中设置参数的方法（.NET 附带的——不知道它是否对你有帮助）。

```
Dim dv As New ParameterDiscreteValue
dv.Value = showphone
rpt.ParameterFields("showphone").CurrentValues.Add(dv) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:13:58.383

您选择的变量的值是多少？

Table.SetLogOnInfo ConnName, DBName, user, pass
**DomainName = selected**
'设置参数字段

如果它不是字符串，那么这可能是问题所在。Crystal 需要一个字符串变量，当它没有收到预期的内容时，它会抛出错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T09:55:09.033

如果您更改了在报表中使用的字符串列的长度，使其超过 255 个字节，这可能会在 Crystal 报表 8.5 中发生。如果将列类型从 varchar 更改为 nvarchar（双字节字符串！），也会发生这种情况

原因是 Crystal 报告 8.5 将所有超过 255 字节的字符串视为备注字段。

我建议你升级到 Crystal Reports XI——API 没有太大变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T07:13:15.120

从我的角度来看，如果您在 Crystal Reports 设计器中打开报表并切换到预览模式，您应该会收到相同的错误消息。设计器还应该向您显示问题的确切位置的消息，例如不能被视为字符串的字段。

问题不在于无法打印超过 255 个字节的字段。问题是不能在公式中使用超过 255 个字节的字段作为排序标准......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T22:32:56.017

这是一个设置我们使用的参数的实时示例：

```
For Each CRXParamDef In CrystalReport.ParameterFields
  Select Case CRXParamDef.ParameterFieldName
    Case "@start"
      CRXParamDef.AddCurrentValue CDate("1/18/2002 12:00:00AM")
    Case "@end"
      CRXParamDef.AddCurrentValue Now
  End Select
Next 
```

这实际上是用 VBScript 编写的用于打印 Crystal 8.5 报表的示例，但语法与 VB6 相同

# java - Weblogic 9.x 是否支持 2.4 Servlet 标准？

> ID：103271
> 
> 赞同：0
> 
> 时间：2008-09-19T16:03:24.883
> 
> 标签：java, servlets, weblogic

似乎是一个足够简单的问题，但我似乎找不到答案。嘿，像这样简单的问题和简单的答案是乔尔和杰夫想要的，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:09:35.960

[http://e-docs.bea.com/wls/docs92/compatibility/compatibility.html](http://e-docs.bea.com/wls/docs92/compatibility/compatibility.html)

> BEA WebLogic Server 百分百兼容 J2EE 1.4

...这意味着它支持[servlet 2.4 规范](http://java.sun.com/products/servlet/reference/api/index.html)。

# mobile - 制作适合移动设备的网站的最佳方式是什么？

> ID：103273
> 
> 赞同：8
> 
> 时间：2008-09-19T16:03:39.560
> 
> 标签：mobile

完全用无技术的术语来说，制作移动友好网站的最佳方式是什么？也就是说，我想制作一个可以在普通计算机上运行但也有页面的移动版本的网站。我应该重写每一页吗？这些页面可能会有不同的功能，所以我应该重写后端代码吗？它应该是具有相同数据库的有效不同站点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:13:25.530

在我的[网站上](http://www.bowlsk.com)，我检测到用户代理，并且对于已知的移动浏览器，我提供不同的样式表，在某些页面上留下了一些更大/不太必要的项目。后端并没有真正改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:09:16.147

大约一年前，我向一个运营站点添加了一个移动表示层。基于站点的架构（希望这对您来说不太依赖于技术），我添加了一组新的 JSP 来适应移动浏览器（旁注：请参阅[http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)以获得构建的好方法与浏览器类型无关的移动页面）。此外，由于大多数移动浏览器的功能有限，一些后端功能也发生了变化。因此，简而言之，整合并没有人们想象的那么痛苦。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:12:34.050

这是一个相当广泛的问题，但这里有：

*   如果该站点主要是关于内容的，这意味着它不是您使用的服务，而是您阅读的出版物，那么我会尽量避免发布两个站点。专注于使用移动浏览器可以很好处理的成熟技术进行简单演示。
*   如果它本质上是通过网络交付的软件应用程序，那么事情就会变得更加棘手，因为您需要考虑移动设备的 UI，以及它与桌面的不同之处。
*   这是不言而喻的，但无论哪种方式，如果您有很多移动用户，则在为网站创作内容时应牢记这一点。格式、长度、语音等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:22:21.780

除了 todd 提到的 WURFL / WALL 功能系统之外，还有 Java Server Faces 库可用，它们使用用于移动电话的替代 WML 渲染套件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T16:24:59.323

我过去做过的一种方法是确保我的数据在数据层中被很好地抽象，然后使用单独的中间层模型来提取合适的数据。就我而言，该应用程序是一个天气应用程序，并且目标设备的显示方式非常有限，因此我们选择仅在网站功能齐全的情况下向用户展示移动设备上的基本信息。那可能是 10 年前 WAP 大的时候。但如今，随着设备的屏幕更大、带宽更高，您可能希望使用不同的视图模型来使用和显示完全相同的数据。

我从来不知道将来需要哪种类型的应用程序来使用数据。我们做了很多跨平台的应用程序，但领域模型很少改变。因此，我最终会尽可能使用相同的中间层对象，并在不同的客户端中提取这些数据。一个很好的例子是最近的一个项目，我们有一个富互联网应用程序（小部件）、一个完整的网站和一个使用相同数据的 Web 服务。中间层中的数据抽象在这种环境中确实大放异彩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T20:37:04.817

在非常高的抽象层次上，移动设备有两个主要的警告：（1）它们的屏幕很小，（2）它们的网络连接是断断续续的。这基本上意味着您需要呈现内容，使其即使在小（可变尺寸）屏幕上看起来也很好，并且最好也使其可缓存，以便您的用户可以在离线时浏览内容。然后还有低带宽和高延迟的问题，但现在这些问题稍微不那么重要了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T16:58:03.620

这是对如何使网站移动的非常全面的概述，尽管我希望公平地说，对于任何寻求移动的人来说，总会有不同的要求。如果您有一个博客，那么您可以使用 Mippin Mobilizer 轻松地使其对移动设备友好；它是免费的，提供品牌定制工具，并且有大量观众已经浏览了各种各样的移动内容，因此有机会在您的博客周围产生广告收入。

这是因为 Mippin Mobilized 博客随后成为更广泛的内容社区的一部分，人员、新闻、博客、列表、所有内容都围绕内容连接，以及移动网站上的更多内容：

[http://mippin.com](http://mippin.com)（在移动浏览器上。）

看看 Mobilizing 工具，因为它展示了网站可以在一秒钟内做什么：

www.mippin.com/mobilizer

Only if you have a blog of course...

# c++ - 捕获信号并向用户报告问题的便携式方式

> ID：103280
> 
> 赞同：4
> 
> 时间：2008-09-19T16:05:34.377
> 
> 标签：c++, c, posix, signals, reentrancy

如果由于某种奇迹在我们的程序中发生了段错误，我想捕获 SIGSEGV 并让用户（可能是 GUI 客户端）通过单个返回码知道发生了严重问题。同时我想在命令行上显示信息以显示哪个信号被捕获。

今天我们的信号处理程序如下所示：

```
void catchSignal (int reason) {
  std :: cerr << "Caught a signal: " << reason << std::endl;
  exit (1);
} 
```

我可以听到上面的恐怖尖叫，因为我从这个[线程](http://groups.google.com/group/gnu.gcc.help/browse_thread/thread/6184795b39508519/f775c1f48284b212?lnk=gst&q=deadlock#)中读到从信号处理程序调用不可重入函数是邪恶的。

是否有一种可移植的方式来处理信号并向用户提供信息？

**编辑：**或者至少在 POSIX 框架内可移植？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T17:32:48.007

此[表](http://docs.oracle.com/cd/E19963-01/html/821-1601/gen-61908.html#gen-95948)列出了 POSIX 保证异步信号安全的所有函数，因此可以从信号处理程序中调用。

通过使用该表中的“写入”命令，以下相对“丑陋”的解决方案有望解决问题：

```
#include <csignal>

#ifdef _WINDOWS_
#define _exit _Exit
#else
#include <unistd.h>
#endif

#define PRINT_SIGNAL(X) case X: \
          write (STDERR_FILENO, #X ")\n" , sizeof(#X ")\n")-1); \
          break;

void catchSignal (int reason) {
  char s[] = "Caught signal: (";
  write (STDERR_FILENO, s, sizeof(s) - 1);
  switch (reason)
  {
    // These are the handlers that we catch
    PRINT_SIGNAL(SIGUSR1);
    PRINT_SIGNAL(SIGHUP);
    PRINT_SIGNAL(SIGINT);
    PRINT_SIGNAL(SIGQUIT);
    PRINT_SIGNAL(SIGABRT);
    PRINT_SIGNAL(SIGILL);
    PRINT_SIGNAL(SIGFPE);
    PRINT_SIGNAL(SIGBUS);
    PRINT_SIGNAL(SIGSEGV);
    PRINT_SIGNAL(SIGTERM);
  }

  _Exit (1);  // 'exit' is not async-signal-safe
} 
```

**编辑：**建立在窗户上。

尝试构建此窗口后，似乎未定义“STDERR_FILENO”。然而，从文档来看，它的值似乎是“2”。

```
#include <io.h>
#define STDIO_FILENO 2 
```

**编辑：**也不应该从信号处理程序中调用“退出”！

[正如fizzer](https://stackoverflow.com/questions/103280/portable-way-to-catch-signals-and-report-problem-to-the-user#114413)所指出的，在上面调用 _Exit 是对 HUP 和 TERM 等信号的大锤方法。理想情况下，当这些信号被捕获时，可以使用“volatile sig_atomic_t”类型的标志来通知主程序它应该退出。

我发现以下内容在我的搜索中很有用。

1.  [Unix 信号编程简介](http://users.actcom.co.il/~choo/lupg/tutorials/signals/signals-programming.html)
2.  [扩展传统信号](http://docs.oracle.com/cd/E19963-01/html/821-1601/gen-61908.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T19:35:24.920

FWIW, 2 也是 Windows 上的标准错误，但您将需要一些条件编译，因为它们的 write() 称为 _write()。你也会想要

```
#ifdef SIGUSR1 /* or whatever */ 
```

等所有对不保证由 C 标准定义的信号的引用。

此外，如上所述，您不想像这样处理 SIGUSR1、SIGHUP、SIGINT、SIGQUIT 和 SIGTERM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T11:54:05.360

理查德，仍然没有足够的业力来评论，所以恐怕是一个新的答案。这些是异步信号；您不知道它们何时交付，因此您可能会处于需要完成以保持一致的库代码中。因此，这些信号的信号处理程序需要返回。如果你调用 exit()，库会在 main() 之后做一些工作，包括调用用 atexit() 注册的函数和清理标准流。例如，如果您的信号到达标准库 I/O 函数，则此处理可能会失败。因此在 C90 中你不能调用 exit()。我现在看到 C99 通过在 stdlib.h 中提供一个新函数 _Exit() 放宽了要求。_Exit() 可以安全地从异步信号的处理程序中调用。

致 bk1e（评论一些帖子） *SIGSEGV 是同步的这一事实就是为什么您不能使用并非设计为可重入的函数的原因。如果崩溃的函数持有一个锁，而信号处理程序调用的函数试图获取相同的锁怎么办？*

这是一种可能性，但问题不是“SIGSEGV 是同步的事实”。使用异步信号从处理程序调用不可重入函数要糟糕得多，原因有两个：

*   异步信号处理程序（通常）希望返回并恢复正常的程序执行。同步信号的处理程序（通常）无论如何都会终止，因此如果您崩溃，您不会损失太多。
*   在反常的意义上，您可以绝对控制何时传递同步信号 - 它发生在您执行有缺陷的代码时，并且不会在其他时间发生。您完全无法控制何时传递异步信号。除非 OP 自己的 I/O 代码本身就是缺陷的原因——例如输出错误的 char*——否则他的错误消息有合理的成功机会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:39:56.027

编写一个启动程序来运行你的程序并向用户报告异常退出代码。

# php - 如果 MySQL 连接在 PHP 页面上一直没有关闭会发生什么？

> ID：103281
> 
> 赞同：8
> 
> 时间：2008-09-19T16:05:43.580
> 
> 标签：php, mysql

在每个 PHP 页面的开头，我打开与 MySQL 的连接，在整个页面中使用它，并在页面末尾关闭它。但是，我经常在页面中间重定向到另一个页面，因此在这些情况下连接不会关闭。我知道这对 Web 服务器的性能来说并不坏，因为 PHP 无论如何都会在每个页面的末尾自动关闭所有 MySQL 连接。这里是否还有其他问题需要记住，或者您真的不必担心在 PHP 中关闭数据库连接？

```
$mysqli = new mysqli("localhost", "root", "", "test");
...do stuff, perhaps redirect to another page...
$mysqli->close(); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-19T16:06:51.487

来自：[http ://us3.php.net/manual/en/mysqli.close.php](http://us3.php.net/manual/en/mysqli.close.php)

> “打开的连接（和类似的资源）在脚本执行结束时会自动销毁。但是，您仍然应该在不再需要所有连接、结果集和语句句柄时立即关闭或释放它们。这将有助于将资源返回给 PHP和 MySQL 更快。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T16:09:34.850

仅仅因为您重定向并不意味着脚本停止执行。重定向只是发送的标头。如果您没有立即退出（），则脚本的其余部分将继续运行。当脚本完成运行时，它将关闭所有打开的连接（如果您使用持久连接，则将它们释放回池中）。别担心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:08:55.947

一次可以打开多少个连接可能存在限制，因此如果您有很多用户，您可能会用完 SQL 连接。实际上，用户将看到 SQL 错误而不是漂亮的网页。

最好打开一个连接来读取数据，然后关闭它，然后显示数据，一旦用户单击“提交”，您就打开另一个连接，然后提交所有更改。

# c++ - 如何将非托管双精度转换为托管字符串？

> ID：103298
> 
> 赞同：3
> 
> 时间：2008-09-19T16:07:20.270
> 
> 标签：c++, double, unmanaged, managed

从托管 C++ 中，我调用了一个返回双精度的非托管 C++ 方法。如何将此双精度转换为托管字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T16:18:20.837

我假设类似

```
(gcnew System::Double(d))->ToString() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T16:14:30.377

C++ 绝对不是我最强的技能。误读了这个问题，但这应该转换为std :: string，虽然不完全是您正在寻找的东西，但因为它是原始帖子而留下它......

```
double d = 123.45;
std::ostringstream oss;
oss << d;
std::string s = oss.str(); 
```

但是，这应该转换为托管字符串..

```
double d = 123.45
String^ s = System::Convert::ToString(d); 
```

# r - 如何测试 R 中的 EOF 标志？

> ID：103312
> 
> 赞同：7
> 
> 时间：2008-09-19T16:09:26.053
> 
> 标签：r, file, file-io, eof

如何测试`EOF`R 中的标志？

例如：

```
f <- file(fname, "rb")
while (???) {
    a <- readBin(f, "int", n=1)
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T16:20:30.987

The [readLines](http://wiki.r-project.org/rwiki/doku.php?id=rdoc:base:readlines) function will return a zero-length value when it reaches the EOF.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-30T07:09:28.827

尝试检查 readBin 返回的数据长度：

```
while (length(a <- readBin(f, 'int', n=1)) > 0) {
    # do something
} 
```

# bash - 在 bash 中，环境变量无法正确扩展制表符

> ID：103316
> 
> 赞同：15
> 
> 时间：2008-09-19T16:09:53.027
> 
> 标签：bash, unix, keyboard-shortcuts

在 bash 中，环境变量在 echo 命令之后会正确地进行制表符扩展，例如：

```
echo $HOME 
```

但是在 cd 或 cat 之后，bash 在 $ 符号之前放置一个 \，如下所示：

```
cd \$HOME 
```

如果我使用变量作为命令的第二个参数，它根本不会扩展：

```
cp somefile $HOM 
```

我的 .bashrc 或 .inputrc 文件中有什么神秘的选项让我如此痛苦？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-27T17:08:17.577

您所描述的是[bash 4.2 中引入](http://lists.gnu.org/archive/html/bug-bash/2011-02/msg00274.html)的“功能” 。所以你没有任何神秘的选择让你感到痛苦，而只是“有意”的行为。

我觉得这很烦人，因为我喜欢它以前的方式并且还没有找到任何配置选项来恢复早期的行为。使用`complete`其他答案建议的选项并没有让我到任何地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-21T03:38:03.767

尝试***完成 -r cd***以删除许多 Linux 发行版为该`cd`命令安装的特殊编程完成功能。该函数将搜索 CDPATH 变量中指定的目录列表添加到选项卡完成中`cd`，但以破坏默认完成行为为代价。

有关更多详细信息，请参阅[http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion 。](http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T16:28:14.120

对于第二种情况，您可以在 tab 之前按 ESC 来解决它。

我不知道您的问题的解决方案，但您可以查看**/etc/bash_completion**或**/etc/bash_completion.d**下的文件以确定哪些命令使用自动完成功能以及如何使用。

```
help complete 
```

也可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T17:32:22.250

[Bash 参考手册](http://www.gnu.org/software/bash/manual/bashref.html)提供的关于扩展勘误表的信息比您想要的更多。

[第 8.7 节](http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion-Builtins)看起来应该是开始的地方。它提供有关“完整”功能的信息等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-19T11:41:25.060

检查 Dmitry Alexandrov的[https://superuser.com/questions/434139/urxvt-tab-expand-environment-variables的答案：](https://superuser.com/questions/434139/urxvt-tab-expand-environment-variables)

> 这是关于 direxpand 选项。**`$ shopt -s direxpand`**并将`$FOO_PATH/`由 TAB 扩展。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-20T02:16:55.113

我正在回答4岁的问题！极好的！

这是在 v4.2 中无意引入的 bash 错误/功能，并且在很长一段时间内都未被注意到。[geirha在这](https://askubuntu.com/questions/41891/bash-auto-complete-for-environment-variables)一步中指出了这一点。[在此处](http://lists.gnu.org/archive/html/bug-bash/2011-02/msg00296.html)确认为意外功能

我在家里运行 Ubuntu 时遇到了这个问题。在工作中我有 bash-3.00，所以我花了一些时间四处浏览看看发生了什么。我想知道我是否可以“降级”....

# xml - 选择包含“foo”的属性的正确 XPath 是什么？

> ID：103325
> 
> 赞同：199
> 
> 时间：2008-09-19T16:11:05.567
> 
> 标签：xml, xpath

给定这个 XML，XPath 返回其`prop`属性包含的所有元素`Foo`（前三个节点）：

```
<bla>
 <a prop="Foo1"/>
 <a prop="Foo2"/>
 <a prop="3Foo"/>
 <a prop="Bar"/>
</bla> 
```

* * *

## 回答 #1

> 赞同：349
> 
> 时间：2008-09-19T16:23:03.337

```
//a[contains(@prop,'Foo')] 
```

如果我使用此 XML 来获取结果，则可以使用。

```
<bla>
 <a prop="Foo1">a</a>
 <a prop="Foo2">b</a>
 <a prop="3Foo">c</a>
 <a prop="Bar">a</a>
</bla> 
```

编辑：要注意的另一件事是，虽然上面的 XPath 将返回该特定 xml 的正确答案，但如果你想保证你只得到元素“bla”中的“a”元素，你应该像其他人提到的那样使用

```
/bla/a[contains(@prop,'Foo')] 
```

这将搜索整个 xml 文档中的所有“a”元素，无论嵌套在“blah”元素中

```
//a[contains(@prop,'Foo')] 
```

为了彻底和stackoverflow的精神，我添加了这个。:)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-02-25T19:33:29.747

此 XPath 将为您提供所有具有包含 'Foo' 的属性的节点，无论节点名称或属性名称如何：

```
//attribute::*[contains(., 'Foo')]/.. 
```

当然，如果您对属性本身的内容更感兴趣，而不一定是它们的父节点，只需删除 /..

```
//attribute::*[contains(., 'Foo')] 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-19T16:28:14.510

```
descendant-or-self::*[contains(@prop,'Foo')] 
```

或者：

```
/bla/a[contains(@prop,'Foo')] 
```

或者：

```
/bla/a[position() <= 3] 
```

剖析：

```
descendant-or-self:: 
```

轴 - 搜索下面的每个节点和节点本身。这通常比 // 更好。我遇到了一些实现，其中 // 表示任何地方（根节点的后代或自身）。另一个使用默认轴。

```
* or /bla/a 
```

Tag - 通配符匹配，/bla/a 是绝对路径。

```
[contains(@prop,'Foo')] or [position() <= 3] 
```

[ ] 内的条件。@prop 是attribute::prop 的简写，因为attribute 是另一个搜索轴。或者，您可以使用 position() 函数选择前 3 个。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-19T16:24:45.767

John C 是最接近的，但 XPath 区分大小写，因此正确的 XPath 应该是：

```
/bla/a[contains(@prop, 'Foo')] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-14T15:47:44.167

如果您还需要匹配链接本身的内容，请使用 text()：

`//a[contains(@href,"/some_link")][text()="Click here"]`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-19T16:16:33.307

您是否尝试过类似的方法：

//a[包含(@prop, "Foo")]

我以前从未使用过 contains 功能，但怀疑它应该像宣传的那样工作......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T16:17:27.983

/bla/a[包含（@prop，“foo”）]

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-19T16:18:51.927

试试这个：

//a[包含(@prop,'foo')]

这应该适用于文档中的任何“a”标签

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T16:17:49.573

对于上面的代码... //*[contains(@prop,'foo')]

# c++ - 如何将 Lua 粘合到 C++ 代码？

> ID：103347
> 
> 赞同：12
> 
> 时间：2008-09-19T16:14:17.867
> 
> 标签：c++, scripting, lua

你是使用 Luabind、toLua++ 还是其他一些库（如果是，是哪一个），还是根本不使用？

对于每种方法，优点和缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T21:25:48.517

我真的不能同意“自己动手”的投票，将基本类型和静态 C 函数绑定到 Lua 是微不足道的，是的，但是当您开始处理表和元表时，情况就会发生变化；事情变得非常棘手。

LuaBind 似乎可以完成这项工作，但我有一个哲学问题。对我来说，如果你的类型已经很复杂，那么 Luabind 被大量模板化的事实不会让你的代码更容易理解，正如我的一个朋友所说“你需要 Herb Shutter 来找出编译消息” . 另外，它依赖于 Boost，加上编译时间会受到严重影响，等等。

在尝试了一些绑定之后，Tolua++ 似乎是最好的。Tolua 似乎没有进行太多开发，因为 Tolua++ 似乎工作正常（加上一半的“Tolua”教程实际上是“Tolua++”教程，相信我：） Tolua 确实生成了正确的东西，可以修改源代码，它似乎可以处理复杂的情况（如模板、联合、无名结构等）

Tolua++ 的最大问题似乎是缺乏适当的教程、预设的 Visual Studio 项目，或者命令行有点难以理解（你的路径/文件不能有空格 - 至少在 Windows 中） - 等等）不过，对我来说，它是赢家。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T16:19:05.593

To answer my own question in part:

Luabind: once you know how to bind methods and classes via this awkward template syntax, it's pretty straightforward and easy to add new bindings. However, luabind has a significant performance impact and shouldn't be used for realtime applications. About 5-20 times more overhead than calling C functions that manipulate the stack directly.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T23:21:14.960

我不使用任何图书馆。前段时间我使用 SWIG 公开了一个 C 库，但是开销太大，我停止使用它。

优点是更好的性能和更多的控制，但它需要更多的时间来编写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T17:21:25.073

Use raw Lua API for your bindings -- and keep them simple. Take inspiration in the API itself (AUX library) and libraries by Lua authors.

With some practice raw API is the best option -- maximum flexibility and minimum of unneeded overhead. You've got what you want and no more, the way you need it to be.

If you must bind large third-party libraries use automated generators like tolua, tolua++ (or even roll your own for the specific case). It would free you from manual work.

I would not recommend using Luabind. At the moment it's development stalled (however starting to come back to life), and if you would meet some corner case, you may be on your own. Also Luabind heavily uses template metaprogramming. This may (and may not) be unacceptable, depending on the point of view.

# c++ - C++ 字符串：UTF-8 还是 16 位编码？

> ID：103358
> 
> 赞同：12
> 
> 时间：2008-09-19T16:15:55.570
> 
> 标签：c++, encoding, utf-8, stdstring, ucs2

我仍在尝试决定我的（家庭）项目是否应该使用[UTF-8](http://en.wikipedia.org/wiki/UTF-8)字符串（根据 std::string 在必要时使用额外的 UTF-8 特定函数实现）或一些 16 位字符串（实现为 std: :wstring)。该项目是一种编程语言和环境（如 VB，它是两者的结合）。

有一些愿望/限制：

*   如果它可以在有限的硬件上运行，比如内存有限的计算机，那就太酷了。
*   我希望代码在 Windows、Mac 和（如果资源允许）Linux 上运行。
*   我将使用[wxWidgets](http://www.wxwidgets.org/)作为我的 GUI 层，但我希望与该工具包交互的代码限制在代码库的一个角落（我将拥有非 GUI 可执行文件）。
*   在处理用户可见文本和应用程序数据时，我想避免使用两种不同类型的字符串。

目前，我正在使用 std::string，目的是仅在必要时使用 UTF-8 操作函数。它需要更少的内存，并且似乎是许多应用程序的发展方向。

如果您推荐 16 位编码，那是哪一种：[UTF-16](http://en.wikipedia.org/wiki/UTF-16)？[UCS-2](http://en.wikipedia.org/wiki/Universal_Character_Set#Encoding_forms_of_the_Universal_Character_Set)？另一个？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-19T16:46:41.143

UTF-16 仍然是可变长度字符编码（有超过 2^16 个 unicode 代码点），因此您不能进行 O(1) 字符串索引操作。如果您正在做很多此类事情，那么您不会在 UTF-8 上节省任何速度。另一方面，如果您的文本包含大量 256-65535 范围内的代码点，则 UTF-16 可以显着改善大小。UCS-2 是固定长度的 UTF-16 的变体*，*其代价是禁止任何大于 2^16 的代码点。

在不了解您的要求的情况下，我个人会选择 UTF-8。由于其他人已经列出的所有原因，这是最容易处理的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T16:23:05.270

老实说，我从来没有找到任何理由使用 UTF-8 以外的任何东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T17:39:18.973

如果您决定使用 UTF-8 编码，请查看此库：[http ://utfcpp.sourceforge.net/](http://utfcpp.sourceforge.net/)

它可能会让你的生活更轻松。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-21T23:26:16.063

实际上，我已经编写了一个广泛使用的应用程序（超过 500 万用户），所以每千字节的使用量都会加起来。尽管如此，我还是坚持使用 wxString。我已将其配置为从 std::wstring 派生，因此我可以将它们传递给期望 wstring const& 的函数。

Please note that std::wstring is native Unicode on the Mac (no UTF-16 needed for characters above U+10000), and therefore it uses 4 bytes/wchar_t. The big advantage of this is that i++ gets you the next character, always. On Win32 that is true in only 99.9% of the cases. As a fellow programmer, you'll understand how little 99.9% is.

But if you're not convinced, write the function to uppercase a std::string[UTF-8] and a std::wstring. Those 2 functions will tell you which way is insanity.

Your on-disk format is another matter. For portability, that should be UTF-8\. There's no endianness concern in UTF-8, nor a discussion over the width (2/4). This may be why many programs appear to use UTF-8.

On a slightly unrelated note, please read up on Unicode string comparisions and normalization. Or you'll end up with the same bug as .NET, where you can have two variables föö and föö differing only in (invisible) normalization.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T16:33:57.493

我会推荐 UTF-16 用于任何类型的数据操作和 UI。Mac OS X 和 Win32 API 使用 UTF-16，同样适用于 wxWidgets、Qt、ICU、Xerces 等。UTF-8 可能更适合数据交换和存储。请参阅[http://unicode.org/notes/tn12/](http://unicode.org/notes/tn12/)。

但无论您选择什么，我绝对会建议“仅在必要时”使用 UTF-8 反对 std::string。

一路走 UTF-16 或 UTF-8，但不要混搭，那是自找麻烦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T16:39:54.780

MicroATX 几乎是一种标准的 PC 主板格式，最适合 4-8 GB 的 RAM。如果您在谈论 picoATX，那么您可能仅限于 1-2 GB RAM。即便如此，这对于开发环境来说已经足够了。出于上述原因，我仍然会坚持使用 UTF-8，但内存不应该是您关心的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T16:23:03.837

根据我的阅读，除非内存不足，否则最好在内部使用 16 位编码。它在一个字符中几乎适用于所有生活语言

我也会看看[ICU](http://www.icu-project.org/)。如果您不打算使用字符串的某些 STL 功能，则使用 ICU 字符串类型可能更适合您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T17:04:33.457

你考虑过使用 wxStrings 吗？如果我没记错的话，他们可以进行 utf-8 <-> Unicode 转换，当您必须将字符串传入和传出 UI 时，它会变得更容易一些。

# android - Android Phone Emulator 对性能的反映如何？

> ID：103366
> 
> 赞同：20
> 
> 时间：2008-09-19T16:16:49.390
> 
> 标签：android, opengl-es, android-emulator

我一直在玩`OpenGL ES`Android 上的开发。`OpenGL ES`应用程序似乎在我的开发机器上的模拟器中运行缓慢。这是否反映了实际硬件的可能性能？如果图形性能变得迟缓，我担心会花费太多时间来开发应用程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T16:24:10.760

The emulator is super slow on my `Mobile Intel Pentium M 725, 1600 MHz`.

I'm assuming the emulator isn't representative of real world performance.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-10T16:10:09.363

模拟器太慢了，在某些情况下，使用它时甚至无法启动 openGL 应用程序。虽然android的实际硬件甚至可以如此强大，你甚至可以在上面玩GTA。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-24T19:24:07.553

在 Windows 上配置 VM 加速

Windows 虚拟机加速需要安装英特尔硬件加速执行管理器（英特尔 HAXM）。该软件需要具有虚拟化技术 (VT) 支持的 Intel CPU 和以下操作系统之一：

Windows 7（32/64 位）
Windows Vista（32/64 位）
Windows XP（仅限 32 位）
要安装虚拟化驱动程序：

启动 Android SDK Manager，选择 Extras，然后选择 Intel Hardware Accelerated Execution Manager。
下载完成后，执行
`<sdk>/extras/intel/Hardware_Accelerated_Execution_Manager/IntelHAXM.exe`

按照屏幕上的说明完成安装。安装完成后，打开命令提示符窗口并运行以下命令，确认虚拟化驱动程序运行正常：

```
sc query intelhaxm 
```

您应该会看到一条包含以下信息的状态消息：SERVICE_NAME：`intelhaxm`

```
 ...
   STATE              : 4  RUNNING

   ... 
```

要使用 VM 加速运行基于 x86 的模拟器：

如果您从命令行运行模拟器，只需指定一个基于 x86 的 AVD：

```
emulator -avd <avd_name> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-03T10:45:04.960

After the new update the emulators have become much more reliable but still can't be taken as the way to check the performance of your application. Till now testing the application of real devices are more reliable then emulators.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-15T17:41:56.283

使用 Android Studio 2.0 的新模拟器，如果你的电脑不错，它运行起来相当流畅，至少对于我的应用程序来说是这样！

检查[功能](http://developer.android.com/intl/es/tools/devices/emulator.html)！

# .net - 托管 C++ 方法命名

> ID：103382
> 
> 赞同：2
> 
> 时间：2008-09-19T16:18:29.307
> 
> 标签：.net, windows, c++-cli

我正在使用托管 c++ 来实现一个返回字符串的方法。我使用以下签名在头文件中声明该方法：

```
String^ GetWindowText() 
```

但是，当我在 C# 中使用此方法时，签名是：

```
string GetWindowTextW(); 
```

如何摆脱方法名称末尾的额外“W”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:20:35.620

要绕过 Windows 头文件的预处理器骇客，请像这样声明它：

```
#undef GetWindowText
String^ GetWindowText() 
```

请注意，如果您`GetWindowText()`在代码中实际使用 Win32 或 MFC 例程，则需要重新定义宏或将它们称为`GetWindowTextW()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:22:15.460

GetWindowText 是一个 win32 api 调用，它通过一个宏别名为 C++ 项目中的 GetWindowTextW。

尝试将#undef GetWindowText 添加到您的 C++ 项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:36:13.023

不是托管 c++，而是用于 .net 平台的 C++/CLI。一组 Microsoft 对 C++ 的扩展，用于他们的 .Net 系统。

Bjarne Stroustrup 的常见问题解答[http://www.research.att.com/~bs/bs_faq.html#CppCLI](http://www.research.att.com/~bs/bs_faq.html#CppCLI)

C++/CLI 不是 C++，不要这样标记它。发送

# oracle - Oracle 自然连接和计数(1)

> ID：103389
> 
> 赞同：4
> 
> 时间：2008-09-19T16:19:51.987
> 
> 标签：oracle, natural-join

有谁知道为什么在 Oracle 11g 中，当您执行具有多个自然连接的 Count(1) 时，它会执行笛卡尔连接并抛出计数？

如

```
SELECT Count(1) FROM record NATURAL join address NATURAL join person WHERE status=1
AND code = 1 AND state = 'TN' 
```

这会拉回 300 万行

```
SELECT * FROM record NATURAL join address NATURAL join person WHERE status=1
AND code = 1 AND state = 'TN' 
```

像 36000 行一样拉回，这是正确的数量。

我只是错过了什么吗？

这是我用来获得此结果的表格。

```
CREATE TABLE addresses (
address_id           NUMBER(10,0)  NOT NULL,
address_1            VARCHAR2(60)  NULL,
address_2            VARCHAR2(60)  NULL,
city                 VARCHAR2(35)  NULL,
state                CHAR(2)       NULL,
zip                  VARCHAR2(5)   NULL,
zip_4                VARCHAR2(4)   NULL,
county               VARCHAR2(35)  NULL,
phone                VARCHAR2(11)  NULL,
fax                  VARCHAR2(11)  NULL,
origin_network       NUMBER(3,0)   NOT NULL,
owner_network        NUMBER(3,0)   NOT NULL,
corrected_address_id NUMBER(10,0)  NULL,
"HASH"                 VARCHAR2(200) NULL
);

CREATE TABLE rates (
rate_id      NUMBER(10,0) NOT NULL,
eob          VARCHAR2(30) NOT NULL,
network_code NUMBER(3,0)  NOT NULL,
product_code VARCHAR2(2)  NOT NULL,
rate_type    NUMBER(1,0)  NOT NULL
);

CREATE TABLE records (
pk_unique_id      NUMBER(10,0) NOT NULL,
rate_id           NUMBER(10,0) NOT NULL,
address_id        NUMBER(10,0) NOT NULL,
effective_date    DATE         NOT NULL,
term_date         DATE         NULL,
last_update       DATE         NULL,
status            CHAR(1)      NOT NULL,
network_unique_id VARCHAR2(20) NULL,
rate_id_2         NUMBER(10,0) NULL,
contracted_by     VARCHAR2(50) NULL,
contract_version  VARCHAR2(5)  NULL,
bill_address_id   NUMBER(10,0) NULL
); 
```

我应该提到这在 Oracle 9i 中不是问题，但是当我们切换到 11g 时，它就成了问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T17:34:52.977

My advice would be to NOT use NATURAL JOIN. Explicitly define your join conditions to avoid confusion and "hidden bugs". Here is the [official NATURAL JOIN Oracle documentation](http://68.142.116.68/docs/cd/B28359_01/server.111/b28286/statements_10002.htm#sthref9907) and [more discussion](http://awads.net/wp/2006/03/20/back-to-basics-inner-joins/#comment-2837) about this subject.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T16:28:44.477

如果它完全按照你说的那样发生，那么它**一定**是一个优化器错误，你应该将它报告给 Oracle。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:31:26.687

您应该尝试计数（*）

两者是有区别的。
count(1) 表示计数行，其中 1 不为空
count(*) 表示计数行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T17:12:33.623

Just noticed you used 2 natural joins... From the documentation you can only use a natural join on 2 tables [Natural_Join](http://www.orafaq.com/wiki/Natural_join)

# svn - 使用 TortoiseSVN 或命令行 SVN 在 Subversion 存储库中设置 SVN“执行”位

> ID：103395
> 
> 赞同：50
> 
> 时间：2008-09-19T16:20:28.897
> 
> 标签：svn, version-control, tortoisesvn

我有一个托管在 code.google.com 上的开源应用程序。它是跨平台的（Linux / Windows / Mac）。我最初使用 TortoiseSVN 从 WinXP 机器上传了代码，似乎用于 linux 构建的“配置”批处理文件都没有设置“执行”位。

为需要它们的文件设置这些最简单的方法是什么？我想使用 TortoiseSVN 会更容易，但如果不能使用，那么我也可以在我的 linux 机器上使用命令行 SVN。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-09-19T16:32:34.000

以下是如何在命令行上执行此操作：

```
for file in `find . -name configure`; do
  svn ps svn:executable yes ${file}
done 
```

或仅针对一个文件（`configure`此处为文件名）：

```
svn ps svn:executable yes configure 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-19T16:38:56.420

使用 tortoise SVN，很简单：你可以选择多个文件（可能来自搜索结果，所以它们不必在同一目录中），在 TortoiseSVN 菜单中选择“属性”，添加所需的属性（有最常用属性的下拉列表，在本例中为“svn:executable”）并设置值（在本例中为“*”）。如果提交更改的文件并在 linux 下检出，可执行位将被设置。

如果您想一次设置多个属性，首先为一个文件正确设置属性，将它们导出到文件中，选择所有需要的文件，选择“属性”菜单可能更安全（以防出错）并导入之前保存的属性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-01-07T11:10:49.450

在 Unix 上使用 {} 来处理结果集：

```
find . -type f -name "*.bat" -exec svn propset svn:executable yes '{}' \; 
```

有谁知道为什么这个属性需要“是”作为有效参数？找到另一个用 '' 而不是 yes 的例子，也可以...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-12T16:00:53.423

```
find . -type f -name "*.bat" -exec svn propset svn:executable yes "${}" \; 
```

当然 .exe 等也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-25T14:01:39.123

恢复svn导入过程中丢失的可执行权限的方法：

从您在 svn 导入期间使用的原始源复制权限（当前目录到版本 1）：

```
find . -type f | xargs -I {} chmod --reference {} ../version1/{} 
```

然后使用以下 shell 脚本为所有可执行文件设置 svn:executable：

```
for file in `find . -executable -type f`; do
  svn ps svn:executable yes ${file}
done 
```

# sharepoint - 如何让 SharePoint 链接列表默认在新窗口中打开？

> ID：103402
> 
> 赞同：6
> 
> 时间：2008-09-19T16:21:07.647
> 
> 标签：sharepoint, web-parts

在 SharePoint 中，很容易设置由指向其他文档、文件夹、网站等的链接组成的列表 webpart。不幸的是，当单击这些链接时，默认行为是在当前浏览器窗口中打开页面。也就是说，它不会在浏览器的新实例中打开页面。事实证明，这对我网站上的许多用户来说很烦人。

有谁知道在新浏览器窗口中打开默认行为的方法？

我希望这是可以在 SharePoint 中设置的东西，而不是让用户需要在浏览器中调整某种设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T16:26:17.400

默认链接列表 Web 部件不可能，但有资源描述如何扩展 Sharepoint 服务器端以添加此功能。

[Share Point 链接在新窗口中打开](http://www.andrewconnell.com/blog/articles/SharepointLinksListOpenInNewWindow.aspx)
[更改 Sharepoint 2007 中的链接列表](http://weblogs.asp.net/bryanglass/archive/2008/03/07/changing-links-list-in-sharepoint-2007-to-open-in-new-browser-window.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T16:38:59.227

您可以在 SharePoint 设计器中编辑页面，将列表视图 Web 部件转换为 XSLT 数据视图。（通过右键单击+“转换为 XSLT 数据视图”）。
然后您可以编辑 XSLT - 找到`A`标签并添加一个属性`target="_blank"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-10T15:16:49.857

SP2010 的相同实例；链接列表 webpart 不会自动在新窗口中打开，而是用户必须手动 rt 单击链接对象并选择在新窗口中打开。

使用kin SP2010 添加/插入链接选项将允许用户手动配置链接以在新窗口中打开。

也许 SP2012 版本会解决这个问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-05T14:40:08.867

在链接选项卡下 ==> 编辑 URL 项 ==> 在 URL 下（键入 Web 地址）- 将值格式化如下：

示例：如果 URL = [http://www.abc.com](http://www.abc.com) ==> 然后在值后面加上 ==>

*   #openinnewwindow/,'" target="http://www.abc.com'

因此，最终值应为 ==> [http://www.abc.com#openinnewwindow/](http://www.abc.com#openinnewwindow/) ,'" target="http://www.abc.com'

DONE ==> 这将在新窗口中打开 URL

# math - 为什么在 Math.h 中调用函数时出现链接错误？

> ID：103407
> 
> 赞同：6
> 
> 时间：2008-09-19T16:21:31.343
> 
> 标签：math, gcc, linker

尝试在 中调用函数时`math.h`，出现如下链接错误

```
undefined reference to sqrt 
```

但我`#include <math.h>`
正在使用 gcc 并编译如下：

```
gcc -Wall -D_GNU_SOURCE blah.c -o blah 
```

为什么链接器找不到 的定义`sqrt`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T16:24:32.273

调用 gcc 时在命令中添加 -lm：
gcc -Wall -D_GNU_SOURCE blah.c -o blah -lm

这将告诉链接器与数学库链接。包含 math.h 将告诉编译器存在诸如 sqrt() 之类的数学函数，但它们是在单独的库中定义的，链接器需要将其与可执行文件一起打包。

正如 FreeMemory 指出的那样，该库称为 libm.a 。在类 Unix 系统上，命名库的规则是 lib[blah].a 。然后，如果您想将它们链接到您的可执行文件，您可以使用 -l[blah] 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T16:22:11.607

您需要明确链接数学库。添加`-lm`到您传递给 gcc 的标志，以便链接器知道链接`libm.a`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-25T15:40:40.573

附加`-lm`到 gcc 命令的末尾以链接数学库：

```
gcc -Wall -D_GNU_SOURCE blah.c -o blah -lm 
```

为了正确链接事物，编译器标志的顺序很重要！具体来说，`-lm`应该放在[行尾](https://stackoverflow.com/questions/16344445/undefined-reference-to-pow-even-with-math-h-and-the-library-link-lm)。

如果您想知道为什么`math.h`在 C 中编译时需要包含该库，请在[此处](https://stackoverflow.com/questions/1033898/why-do-you-have-to-link-the-math-library-in-c)查看此说明。

# iphone - 如何在 OpenGLES 中翻转精灵/纹理？

> ID：103421
> 
> 赞同：6
> 
> 时间：2008-09-19T16:23:23.757
> 
> 标签：iphone, objective-c, opengl

我有一个作为纹理加载的精灵，我需要为它设置动画，让它“面向”左或右——基本上有时我需要“翻转”它。我知道 OpenGL 有一个 gltranslate 可以重新定位一个对象，而 glrotate 可以旋转它。有没有一种方法可以简单地将它翻转到一个轴上？如果没有，您将如何实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-22T22:23:55.850

我没有弄乱点精灵，但我相信它们是纹理。纹理具有纹理矩阵，这意味着您可以在它们上使用`glTranslatef()`,`glScalef()`和`glRotatef()`。

我会尝试一些沿着`glScalef(-1,1,1);`X 轴翻转纹理坐标的方法。

正如我所说，我没有玩过点精灵，但我也没有搞乱纹理矩阵。不过，它们看起来确实很有用。

**更新：**我同时玩过纹理矩阵。与在模型视图和投影矩阵之间切换的方式相同，可以切换到纹理矩阵；大约：`glMatrixMode(GL_TEXTURE);`之后您可以进行上述操作。

您也可以只绘制一个四边形/两个三角形并完成它:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T17:03:27.123

你不能用 OpenGL 点精灵来做到这一点；虽然你可以移动精灵的中心，但它的形状总是以相同的方式定向。

你*可以*做的是把你的精灵画成四边形，这样你就可以随意翻转、旋转和弄乱它们。[NeHe](http://nehe.gamedev.net/data/articles/article.asp?article=19)上有关于手动绘制精灵（又名广告牌）的教程

# string - 将人名解析为其组成部分的简单方法？

> ID：103422
> 
> 赞同：31
> 
> 时间：2008-09-19T16:23:28.717
> 
> 标签：string, parsing, database-design

许多联系人管理程序都会这样做——你输入一个名字（*例如*，“John W. Smith”），它会自动在内部将其分解为：

**名字：** John
**中间名：** W.
**姓氏：** Smith

同样，它会计算出诸如“Jane W. Smith 夫人”和“Dr. John Doe, Jr.”之类的东西。也正确（假设您允许在名称中使用“前缀”和“后缀”等字段）。

我认为这是人们想要做的相当普遍的事情......所以问题是......你会怎么做？有一个*简单*的算法吗？也许是一个正则表达式？

我正在寻求 .NET 解决方案，但我并不挑剔。

**更新：**我很感激没有涵盖所有边缘案例和文化的简单解决方案......但是为了争论起见，我们假设您需要分片的名称（填写表格 - 例如税收或其他政府表格 - 是您必须在固定字段中输入姓名的一种情况，无论您喜欢与否），但您不一定要强制用户将他们的姓名输入离散字段（更少打字=更容易新手用户）。

您希望程序“猜测”（尽其所能）第一个、中间、最后一个等。如果可以，请查看 Microsoft Outlook 如何为联系人执行此操作 - 它允许您输入姓名，但是如果您需要澄清，可以打开一个额外的小窗口。我会做同样的事情——给用户一个窗口，以防他们想以离散的部分输入名称——但允许在一个框中输入名称并进行涵盖*最*常见名称的“最佳猜测”。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-19T16:29:19.577

如果你*必须*做这个解析，我相信你会在这里得到很多好的建议。

我的建议是 -**不要做这个解析**。

相反，创建您的输入字段，以便信息已经被分离出来。有标题、名字、中间名首字母、姓氏、后缀等单独的字段。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-26T17:20:05.613

我知道这是旧的，可​​能是我已经找不到的地方的答案，但由于我找不到任何适合我的东西，这就是我想出的，我认为它很像 Google 联系人和 Microsoft Outlook。它不能很好地处理边缘情况，但是对于一个好的 CRM 类型的应用程序，总是可以要求用户解决这些问题（在我的应用程序中，我实际上一直都有单独的字段，但我需要从另一个应用程序导入数据只有一个字段）：

```
 public static void ParseName(this string s, out string prefix, out string first, out string middle, out string last, out string suffix)
    {
        prefix = "";
        first = "";
        middle = "";
        last = "";
        suffix = "";

        // Split on period, commas or spaces, but don't remove from results.
        List<string> parts = Regex.Split(s, @"(?<=[., ])").ToList();

        // Remove any empty parts
        for (int x = parts.Count - 1; x >= 0; x--)
            if (parts[x].Trim() == "")
                parts.RemoveAt(x);

        if (parts.Count > 0)
        {
            // Might want to add more to this list
            string[] prefixes = { "mr", "mrs", "ms", "dr", "miss", "sir", "madam", "mayor", "president" };

            // If first part is a prefix, set prefix and remove part
            string normalizedPart = parts.First().Replace(".", "").Replace(",", "").Trim().ToLower();
            if (prefixes.Contains(normalizedPart))
            {
                prefix = parts[0].Trim();
                parts.RemoveAt(0);
            }
        }

        if (parts.Count > 0)
        {
            // Might want to add more to this list, or use code/regex for roman-numeral detection
            string[] suffixes = { "jr", "sr", "i", "ii", "iii", "iv", "v", "vi", "vii", "viii", "ix", "x", "xi", "xii", "xiii", "xiv", "xv" };

            // If last part is a suffix, set suffix and remove part
            string normalizedPart = parts.Last().Replace(".", "").Replace(",", "").Trim().ToLower();
            if (suffixes.Contains(normalizedPart))
            {
                suffix = parts.Last().Replace(",", "").Trim();
                parts.RemoveAt(parts.Count - 1);
            }
        }

        // Done, if no more parts
        if (parts.Count == 0)
            return;

        // If only one part left...
        if (parts.Count == 1)
        {
            // If no prefix, assume first name, otherwise last
            // i.e.- "Dr Jones", "Ms Jones" -- likely to be last
            if(prefix == "")
                first = parts.First().Replace(",", "").Trim();
            else
                last = parts.First().Replace(",", "").Trim();
        }

        // If first part ends with a comma, assume format:
        //   Last, First [...First...]
        else if (parts.First().EndsWith(","))
        {
            last = parts.First().Replace(",", "").Trim();
            for (int x = 1; x < parts.Count; x++)
                first += parts[x].Replace(",", "").Trim() + " ";
            first = first.Trim();
        }

        // Otherwise assume format:
        // First [...Middle...] Last

        else
        {
            first = parts.First().Replace(",", "").Trim();
            last = parts.Last().Replace(",", "").Trim();
            for (int x = 1; x < parts.Count - 1; x++)
                middle += parts[x].Replace(",", "").Trim() + " ";
            middle = middle.Trim();
        }
    } 
```

抱歉，代码又长又丑，我还没来得及清理它。它是一个 C# 扩展，因此您可以像这样使用它：

```
string name = "Miss Jessica Dark-Angel Alba";
string prefix, first, middle, last, suffix;
name.ParseName(out prefix, out first, out middle, out last, out suffix); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-19T16:31:26.517

对此没有简单的解决方案。 [名称构造因文化而异](https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/)，即使在英语世界中，前缀和后缀也不一定是名称的一部分。

一种基本方法是在字符串的开头查找敬语（例如，“Hon. John Doe”）和结尾的数字或其他字符串（例如，“John Doe IV”、“John Doe Jr.”），但实际上你所能做的就是应用一套启发式方法并希望最好。

查找未处理名称的列表并针对它测试您的算法可能会很有用。不过，我不知道那里有任何预先包装好的东西。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-19T16:34:15.697

你可能真的不需要做任何花哨的事情。像这样的东西应该工作。

```
 Name = Name.Trim();

    arrNames = Name.Split(' ');

    if (arrNames.Length > 0) {
        GivenName = arrNames[0];
    }
    if (arrNames.Length > 1) {
        FamilyName = arrNames[arrNames.Length - 1];
    }
    if (arrNames.Length > 2) {
        MiddleName = string.Join(" ", arrNames, 1, arrNames.Length - 2);
    } 
```

您可能还想先检查标题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-20T02:58:13.437

我不得不这样做。实际上，比这更难的事情，因为有时“名字”会是“史密斯，约翰”或“史密斯约翰”而不是“约翰史密斯”，或者根本不是一个人的名字而是一个公司的名字。它必须自动完成，用户没有机会更正它。

我最终做的是想出一个名称可能包含的有限模式列表，例如：
Last, First Middle-Initial
First Last
First Middle-Initial Last
Last, First Middle
First Middle Last
First First Last

把你的先生，Jr的，也在那里。假设您最终得到了十几种模式。

我的应用程序有一个常见的名字、常见的姓氏（你可以在网上找到这些）、常见的标题、常见的后缀（jr、sr、md）的字典，使用它可以对模式做出真正好的猜测。我没那么聪明，我的逻辑也没那么花哨，但是，创建一些在 99% 以上的时间里猜对的逻辑并不难。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T18:42:12.660

我明白这很难做到*正确*- 但是如果您为用户提供一种编辑结果的方法（例如，如果它没有猜对，则弹出窗口来编辑名称）并且仍然猜对大多数人案例......当然，这是很难的猜测。

从理论上看问题时说“不要这样做”很容易，但有时情况并非如此。包含名称所有部分的字段（标题、名字、中间名、姓氏、后缀，仅举几例）可能会占用大量屏幕空间 - 并结合地址问题（另一天的主题) 确实会弄乱*应该*是干净、简单的 UI。

我想答案应该是“除非你绝对必须这样做，否则不要这样做，如果你这样做，请保持简单（这里已经发布了一些方法）并为用户提供在需要时编辑结果的方法。”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-26T21:43:02.933

理解这是一个坏主意，我用 perl 编写了这个正则表达式 - 这对我来说是最有效的。我已经过滤掉了公司名称。
以 vcard 格式输出：（hon_prefix、given_name、additional_name、family_name、hon.suffix）

```
/^ \s*
    (?:((?:Dr.)|(?:Mr.)|(?:Mr?s.)|(?:Miss)|(?:2nd\sLt.)|(?:Sen\.?))\s+)? # prefix
    ((?:\w+)|(?:\w\.)) # first name
(?: \s+ ((?:\w\.?)|(?:\w\w+)) )?  # middle initial
(?: \s+ ((?:[OD]['’]\s?)?[-\w]+))    # last name
(?: ,? \s+ ( (?:[JS]r\.?) | (?:Esq\.?) | (?: (?:M)|(?:Ph)|(?:Ed) \.?\s*D\.?) | 
         (?: R\.?N\.?) | (?: I+) )  )? # suffix
\s* $/x 
```

笔记：

*   不处理 IV、V、VI
*   前缀、后缀的硬编码列表。从约 2K 名称的数据集演变而来
*   不处理多个后缀（例如 MD、PhD）
*   专为美国名字设计 - 不能在罗马化的日本名字或其他命名系统上正常工作

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-03-01T00:11:32.480

这里真正的解决方案没有回答这个问题。必须注意信息的预兆。名字不仅仅是一个名字；我们就是这样出名的。

这里的问题是不确切知道哪些部分标记了什么，以及它们的用途。尊敬的前缀只能在个人信件中使用；医生是由头衔派生的敬称。关于一个人的所有信息都与他们的身份相关，它只是确定什么是相关信息。出于管理原因，您需要名字和姓氏；电话号码、电子邮件地址、土地描述和邮寄地址；一切都是身份的象征，知道你在和谁打交道。

这里真正的问题是这个人在管理中迷失了方向。突然之间，他们只需将个人信息输入表格并提交给任意程序进行处理后，就可以得到预制模板喷出的各种敬语和取悦词。这是错误的；尊敬的先生或女士，如果对信函的原因表现出个人兴趣，那么绝对不应该使用模板来写信。个人信函需要对收件人有一点了解。男性或女性，上学当医生或法官，他们在什么文化中长大。

在其他文化中，名称由可变数量的字符组成。这个人的名字对我们来说只能解释为一串数字，其中空格实际上是由字符宽度而不是空格字符决定的。在这些情况下，敬语是一个或多个字符作为实际名称的前缀和后缀。礼貌的做法是使用给你的字符串，如果你知道敬语，那么一定要使用它，但这再次暗示了接受者的某种个人知识。除了 Sensei 以外的任何称呼 Sensei 都是错误的。不是逻辑错误，而是你刚刚侮辱了你的来电者，现在你应该找到一个可以帮助你道歉的模板。

出于自动化、非个人通信的目的，可以为每日文章、每周问题或其他内容设计模板，但当接收者向自动化服务发起通信时，问题就变得很重要。

发生的事情是一个错误。丢失的信息。未知或缺失的信息总是会产生异常。真正的问题不是你如何用表达式将一个人的名字分成不同的组成部分，而是你怎么称呼它们。

解决方案是创建一个额外的字段，如果已经有名字和姓氏，则将其设为可选，并将其称为“我们可以叫你什么”或“我们应该如何称呼你”。医生和法官将确保您正确解决这些问题。这些不是编程问题，而是沟通问题。

好的，不好的说法，但在我看来，用户名、标记名和 ID 更糟糕。所以我的解决方案；是缺少的问题，“我们应该怎么称呼你？”

这只是一个您有能力提出新问题的解决方案。机智占上风。在您的用户表单上创建一个新字段，将其命名为 Alias，为用户添加标签“我们应该怎么称呼您？”，然后您就有了与之交流的方式。使用名字和姓氏，除非收件人提供了别名，或者与发件人个人熟悉，则可以接受名字和中间名。

```
To Me, _______________________ (standard subscribed corrospondence)
To Me ( Myself | I ), ________ (standard recipient instigated corrospondence)
To Me Myself I, ______________ (look out, its your mother, and you're in big trouble;
                                nobody addresses a person by their actual full name)

Dear *(Mr./Mrs./Ms./Dr./Hon./Sen.) Me M. I *(I),
To Whom it may Concern; 
```

否则，您正在寻找标准的东西：您好，问候，您可能是赢家。

如果您在一个字符串中包含一个人的姓名数据，那么您没有问题，因为您已经有了他们的别名。如果您需要的是名字和姓氏，那么只需 Left(name,instr(name," ")) & " " & Right(name,instrrev(name," "))，我的数学可能是错误的，我'我有点不习惯。将左右与已知的前缀和后缀进行比较，并从匹配中消除它们。除了确认身份的情况外，通常很少使用中间名；地址或电话号码可以告诉您更多信息。观察连字符，可以确定如果不使用姓氏，则将使用中间的一个。

为了搜索名字和姓氏的列表，必须考虑使用中间名字之一的可能性；这将需要四个搜索：一个过滤第一个和最后一个，然后另一个过滤第一个和中间，然后另一个过滤中间和最后一个，然后另一个过滤中间和中间。归根结底，第一个名字永远是第一个，最后一个永远是最后一个，并且可以有任意数量的中间名；少即是多，可能为零，但不太可能。

有时人们更喜欢被称为 Bill、Harry、Jim、Bob、Doug、Beth、Sue 或 Madonna；而不是他们的真实姓名；相似，但不切实际地期望任何人都能理解所有不同的可能性。

你能做的最有礼貌的事情就是问；我们可以叫你什么？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-12-11T21:16:16.810

迟到了 10 年才开始这次谈话，但仍在寻找一个优雅的解决方案，我通读了这个帖子，并决定走 @eselk 所走的路，但要扩展它：

```
public class FullNameDTO
{
    public string Prefix     { get; set; }
    public string FirstName  { get; set; }
    public string MiddleName { get; set; }
    public string LastName   { get; set; }
    public string Suffix     { get; set; }
}

public static class FullName
{
    public static FullNameDTO GetFullNameDto(string fullName)
    {
        string[] knownPrefixes    = { "mr", "mrs", "ms", "miss", "dr", "sir", "madam", "master", "fr", "rev", "atty", "hon", "prof", "pres", "vp", "gov", "ofc" };
        string[] knownSuffixes    = { "jr", "sr", "ii", "iii", "iv", "v", "esq", "cpa", "dc", "dds", "vm", "jd", "md", "phd" };
        string[] lastNamePrefixes = { "da", "de", "del", "dos", "el", "la", "st", "van", "von" };

        var prefix     = string.Empty;
        var firstName  = string.Empty;
        var middleName = string.Empty;
        var lastName   = string.Empty;
        var suffix     = string.Empty;

        var fullNameDto = new FullNameDTO
        {
            Prefix     = prefix,
            FirstName  = firstName,
            MiddleName = middleName,
            LastName   = lastName,
            Suffix     = suffix
        };

        // Split on period, commas or spaces, but don't remove from results.
        var namePartsList = Regex.Split(fullName, "(?<=[., ])").ToList();

        #region Clean out the crap.
        for (var x = namePartsList.Count - 1; x >= 0; x--)
        {
            if (namePartsList[x].Trim() == string.Empty)
            {
                namePartsList.RemoveAt(x);
            }
        }
        #endregion

        #region Trim all of the parts in the list
        for (var x = namePartsList.Count - 1; x >= 0; x--)
        {
            namePartsList[x] = namePartsList[x].Trim();
        }
        #endregion

        #region Only one Name Part - assume a name like "Cher"
        if (namePartsList.Count == 1)
        {
            firstName = namePartsList.First().Replace(",", string.Empty).Trim();
            fullNameDto.FirstName = firstName;

            namePartsList.RemoveAt(0);
        }
        #endregion

        #region Get the Prefix
        if (namePartsList.Count > 0)
        {
            //If we find a prefix, save it and drop it from the overall parts
            var cleanedPart = namePartsList.First()
                                           .Replace(".", string.Empty)
                                           .Replace(",", string.Empty)
                                           .Trim()
                                           .ToLower();

            if (knownPrefixes.Contains(cleanedPart))
            {
                prefix = namePartsList[0].Trim();
                fullNameDto.Prefix = prefix;

                namePartsList.RemoveAt(0);
            }
        }
        #endregion

        #region Get the Suffix
        if (namePartsList.Count > 0)
        {
            #region Scan the full parts list for a potential Suffix
            foreach (var namePart in namePartsList)
            {
                var cleanedPart = namePart.Replace(",", string.Empty)
                                          .Trim()
                                          .ToLower();

                if (!knownSuffixes.Contains(cleanedPart.Replace(".", string.Empty))) { continue; }

                if (namePart.ToLower() == "jr" && namePart != namePartsList.Last()) { continue; }

                suffix             = namePart.Replace(",", string.Empty).Trim();
                fullNameDto.Suffix = suffix;

                namePartsList.Remove(namePart);
                break;
            }
            #endregion
        }
        #endregion

        //If, strangely, there's nothing else in the overall parts... we're done here.
        if (namePartsList.Count == 0) { return fullNameDto; }

        #region Prefix/Suffix taken care of - only one "part" left.
        if (namePartsList.Count == 1)
        {
            //If no prefix, assume first name (e.g. "Cher"), otherwise last (e.g. "Dr Jones", "Ms Jones")
            if (prefix == string.Empty)
            {
                firstName = namePartsList.First().Replace(",", string.Empty).Trim();
                fullNameDto.FirstName = firstName;
            }
            else
            {
                lastName = namePartsList.First().Replace(",", string.Empty).Trim();
                fullNameDto.LastName = lastName;
            }
        }
        #endregion

        #region First part ends with a comma
        else if (namePartsList.First().EndsWith(",") || (namePartsList.Count >= 3 && namePartsList.Any(n => n == ",") && namePartsList.Last() != ","))
        {
            #region Assume format: "Last, First"
            if (namePartsList.First().EndsWith(","))
            {
                lastName             = namePartsList.First().Replace(",", string.Empty).Trim();
                fullNameDto.LastName = lastName;
                namePartsList.Remove(namePartsList.First());

                firstName             = namePartsList.First();
                fullNameDto.FirstName = firstName;
                namePartsList.Remove(namePartsList.First());

                if (!namePartsList.Any()) { return fullNameDto; }

                foreach (var namePart in namePartsList)
                {
                    middleName += namePart.Trim() + " ";
                }
                fullNameDto.MiddleName = middleName;

                return fullNameDto;
            }
            #endregion

            #region Assume strange scenario like "Last Suffix, First"
            var indexOfComma = namePartsList.IndexOf(",");

            #region Last Name is the first thing in the list
            if (indexOfComma == 1)
            {
                namePartsList.Remove(namePartsList[indexOfComma]);

                lastName             = namePartsList.First().Replace(",", string.Empty).Trim();
                fullNameDto.LastName = lastName;
                namePartsList.Remove(namePartsList.First());

                firstName             = namePartsList.First();
                fullNameDto.FirstName = firstName;
                namePartsList.Remove(namePartsList.First());

                if (!namePartsList.Any()) { return fullNameDto; }

                foreach (var namePart in namePartsList)
                {
                    middleName += namePart.Trim() + " ";
                }
                fullNameDto.MiddleName = middleName;

                return fullNameDto;
            }
            #endregion

            #region Last Name might be a prefixed one, like "da Vinci"
            if (indexOfComma == 2)
            {
                var possibleLastPrefix = namePartsList.First()
                                                      .Replace(".", string.Empty)
                                                      .Replace(",", string.Empty)
                                                      .Trim()
                                                      .ToLower();

                if (lastNamePrefixes.Contains(possibleLastPrefix))
                {
                    namePartsList.Remove(namePartsList[indexOfComma]);

                    var lastPrefix = namePartsList.First().Trim();
                    namePartsList.Remove(lastPrefix);

                    lastName             = $"{lastPrefix} {namePartsList.First().Replace(",", string.Empty).Trim()}";
                    fullNameDto.LastName = lastName;
                    namePartsList.Remove(namePartsList.First());
                }
                else
                {
                    lastName = namePartsList.First().Replace(",", string.Empty).Trim();
                    namePartsList.Remove(namePartsList.First());

                    lastName = lastName + " " + namePartsList.First().Replace(",", string.Empty).Trim();
                    namePartsList.Remove(namePartsList.First());

                    fullNameDto.LastName = lastName;
                }

                namePartsList.Remove(",");

                firstName             = namePartsList.First();
                fullNameDto.FirstName = firstName;
                namePartsList.Remove(namePartsList.First());

                if (!namePartsList.Any()) { return fullNameDto; }

                foreach (var namePart in namePartsList)
                {
                    middleName += namePart.Trim() + " ";
                }
                fullNameDto.MiddleName = middleName;

                return fullNameDto;
            }
            #endregion
            #endregion
        }
        #endregion

        #region Everything else
        else
        {
            if (namePartsList.Count >= 3)
            {
                firstName = namePartsList.First().Replace(",", string.Empty).Trim();
                fullNameDto.FirstName = firstName;
                namePartsList.RemoveAt(0);

                //Check for possible last name prefix

                var possibleLastPrefix = namePartsList[namePartsList.Count - 2]
                                               .Replace(".", string.Empty)
                                               .Replace(",", string.Empty)
                                               .Trim()
                                               .ToLower();

                if (lastNamePrefixes.Contains(possibleLastPrefix))
                {
                    lastName = $"{namePartsList[namePartsList.Count - 2].Trim()} {namePartsList[namePartsList.Count -1].Replace(",", string.Empty).Trim()}";
                    fullNameDto.LastName = lastName;

                    namePartsList.RemoveAt(namePartsList.Count - 1);
                    namePartsList.RemoveAt(namePartsList.Count - 1);
                }
                else
                {
                    lastName = namePartsList.Last().Replace(",", string.Empty).Trim();
                    fullNameDto.LastName = lastName;

                    namePartsList.RemoveAt(namePartsList.Count - 1);
                }

                middleName = string.Join(" ", namePartsList).Trim();
                fullNameDto.MiddleName = middleName;

                namePartsList.Clear();
            }
            else
            {
                if (namePartsList.Count == 1)
                {
                    lastName = namePartsList.First().Replace(",", string.Empty).Trim();
                    fullNameDto.LastName = lastName;

                    namePartsList.RemoveAt(0);
                }
                else
                {
                    var possibleLastPrefix = namePartsList.First()
                                             .Replace(".", string.Empty)
                                             .Replace(",", string.Empty)
                                             .Trim()
                                             .ToLower();

                    if (lastNamePrefixes.Contains(possibleLastPrefix))
                    {
                        lastName = $"{namePartsList.First().Replace(",", string.Empty).Trim()} {namePartsList.Last().Replace(",", string.Empty).Trim()}";
                        fullNameDto.LastName = lastName;

                        namePartsList.Clear();
                    }
                    else
                    {
                        firstName = namePartsList.First().Replace(",", string.Empty).Trim();
                        fullNameDto.FirstName = firstName;

                        namePartsList.RemoveAt(0);

                        lastName = namePartsList.Last().Replace(",", string.Empty).Trim();
                        fullNameDto.LastName = lastName;

                        namePartsList.Clear();
                    }
                }
            }
        }
        #endregion

        namePartsList.Clear();

        fullNameDto.Prefix     = prefix;
        fullNameDto.FirstName  = firstName;
        fullNameDto.MiddleName = middleName;
        fullNameDto.LastName   = lastName;
        fullNameDto.Suffix     = suffix;

        return fullNameDto;
    }
} 
```

这将处理相当多的不同场景，并且我已经针对它编写了（迄今为止）超过 50 个不同的单元测试以确保。

再次向@eselk 表示支持，因为他的想法帮助我编写了他出色解决方案的扩展版本。而且，作为奖励，这也处理了一个名为“JR”的人的奇怪实例。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-01-25T20:20:26.553

我们在公司中使用了一些插件来完成此任务。我最终创建了一种方法来为不同的客户在不同的导入中实际指定名称的格式。根据我的经验，有一家公司的工具非常物有所值，并且在处理这个问题时真的令人难以置信。它位于： http: [//www.softwarecompany.com/](http://www.softwarecompany.com/)并且效果很好。在不使用任何统计方法的情况下执行此操作的最有效方法是用逗号或空格分隔字符串，然后：1\. 去掉标题和前缀 2\. 去掉后缀 3，按照 (2 names = F & L, 3 个名称 = FML 或 LMF) 取决于 string() 的顺序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T16:31:35.750

你可以做一些显而易见的事情：寻找 Jr.、II、III 等作为后缀，Mr.、Mrs.、Dr. 等作为前缀并删除它们，然后第一个单词是名字，最后一个单词是最后一个名字，中间的一切都是中间名。除此之外，没有万无一失的解决方案。

一个完美的例子是 David Lee Roth（姓：Roth）和 Eddie Van Halen（姓：Van Halen）。如果 Ann Marie Smith 的名字是“Ann Marie”，则无法将其与中间名 Marie 的 Ann 区分开来。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-20T22:49:58.767

如果您只需要这样做，请将猜测添加到 UI 作为可选选择。这样，您可以告诉用户您是如何解析名称的，并让他们从您提供的列表中选择不同的解析方式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-09-01T20:31:30.623

有一个名为 NetGender 的第三方工具可以很好地工作。我用它来解析大量格式错误且格式不可预测的名称。查看他们页面上的示例，您也可以下载并尝试。

[http://www.softwarecompany.com/dotnet/netgender.htm](http://www.softwarecompany.com/dotnet/netgender.htm)

我根据对 420 万个名字的抽样得出了这些统计数据。Name Parts 表示由空格分隔的不同部分的数量。数据库中大多数名称的正确率都很高。正确性随着部分的增加而下降，但是>3 部分的名称很少，>4 的名称更少。这对我们的案例来说已经足够好了。该软件失败的地方是识别不知名的多部分姓氏，即使用逗号分隔也是如此。如果它能够破译这一点，那么所有数据的错误总数将不到 1%。

```
Name Parts | Correct | Percent of Names in DB
 2             100%       48%
 3              98%       42%
 4              70%        9%
 5              45%        0.25% 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-11-16T07:11:48.430

我已经在页面加载时执行此服务器端。编写了一个 Coldfusion CFC，它将两个参数传递给它 - 实际用户数据（名字、中间名、姓氏）和数据类型（名字、中间名、姓氏）。然后相应地例行检查连字符、撇号、空格和格式。前任。MacDonald、McMurray、O'Neill、Rodham-Clinton、Eric von Dutch、GW Bush、Jack Burton Jr.、Dr. Paul Okin、Chris di Santos。对于用户只有一个名字的情况，只需要名字字段，中间名和姓氏是可选的。

所有信息都以小写形式存储 - 除了前缀、后缀和自定义。这种格式化是在页面呈现时完成的，而不是在存储到数据库期间完成的。虽然在用户输入数据时有验证过滤。抱歉，无法发布代码。开始使用正则表达式，但对于所有场景都变得过于混乱和不可靠。使用标准逻辑块（if/else、switch/case），更易于阅读和调试。使每个输入/数据库字段分开！是的，这需要一些编码，但在你完成后，它应该占到 99% 的组合。到目前为止仅基于英文名称，没有国际化，那是另一个蜡球。

这里有一些事情需要考虑：

*   Hypens（例如 Rodham-Clinton，可能在第一个、中间或最后一个）
*   撇号（例如 O'Neill，可以在第一个、中间或最后一个）
*   空间
*   Mc 和 Mac（例如 McDonald、MacMurray，可能在第一个、中间或
    最后一个）
*   名字：多个名字（例如 Joe Bob Briggs）
*   姓氏：de,di,et,der,den,van,von,af 应为小写（前 Eric von Dander、Mary di Carlo）
*   前缀：博士、教授等
*   后缀：Jr.、Sr.、Esq.、II、III 等

当用户输入信息时，db 中的字段模式是这样的：

*   前缀/标题（博士等，使用下拉菜单）
*   前缀/标题自定义（用户可以输入自定义，例如 Capt. 使用文本字段）
*   名
*   中间
*   姓
*   后缀（Jr.、III、Prof.、Ret. 等使用下拉菜单）
*   后缀自定义（用户可以输入自定义，例如 CPA）

这是我用来将每个名称的第一个字母大写的正则表达式。我先运行它，然后根据规则遵循例程格式（它是 Coldfusion 格式，但你明白了）：

```
<cfset var nameString = REReplace(LCase(nameString), "(^[[:alpha:]]|[[:blank:]][[:alpha:]])", "\U\1\E", "ALL")> 
```

您也可以使用 JavaScript 和 CSS 在客户端执行此操作——甚至可能更容易——但我更喜欢在服务器端执行，因为我需要在页面加载客户端之前设置变量。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T16:31:59.447

我会说[从列表中删除称呼，](http://snippets.dzone.com/posts/show/866)然后按空格分隔，将 list.first() 作为名字， list.last() 作为姓氏，然后用空格连接其余部分并将其作为中间名。最重要的是显示您的结果并让用户修改它们！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-19T16:33:00.333

当然，有一个简单的解决方案 - 用空格分割字符串，计算标记的数量，如果有 2 个，则将它们解释为 FIRST 和 LAST，如果有 3 个，则将其解释为 FIRST、MIDDLE 和 LAST。

问题是简单的解决方案不会是 100% 正确的解决方案 - 有人总是可以输入带有更多标记的名称，或者可以包含标题、带有空格的姓氏（这可能吗？）等。你可以想出一个大多数时候都适用于大多数名字的解决方案，但不是一个绝对的解决方案。

我会按照 Shad 的建议拆分输入字段。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-19T16:35:28.160

你不想这样做，除非你只打算接触来自一种文化的人。

例如：

Guido van Rossum 的姓氏是 van Rossum。

宫崎骏的名字叫Hayao。

你能做的最成功的事情就是去掉常见的头衔和称呼，并尝试一些启发式方法。

即便如此，最简单的解决方案是只存储全名，或者分别询问给定和姓氏。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-19T16:53:38.553

这是一个愚蠢的差事。太多的异常无法确定地执行此操作。如果您这样做是为了对列表进行预处理以供进一步审查，我认为少即是多。

1.  去掉称呼、头衔和世代后缀（大的正则表达式，或几个小的正则表达式）
2.  如果只有一个名字，它是“最后一个”。
3.  如果只有两个名字先分开，最后。
4.  如果三个标记和中间是初始的，首先拆分它们，中间，最后
5.  其余的手动排序。

几乎可以保证任何进一步的处理都会产生更多的工作，因为您必须重新组合处理拆分的内容。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-02T20:39:14.513

我同意，对此没有简单的解决方案。但我在 Microsoft KB 5.0 的 VB 文章中发现了一种糟糕的方法，这是这里讨论的大部分讨论的实际实现：http: [//support.microsoft.com/kb/168799](http://support.microsoft.com/kb/168799)

像这样的东西可以在紧要关头使用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-26T22:34:17.913

没有 100% 的方法可以做到这一点。

您可以按空格拆分，并尝试理解您想要的所有名称，但是归根结底，有时您会弄错。如果这足够好，请在此处寻找任何可以让您拆分的答案。

但是有些人会有像“John Wayne Olson”这样的名字，其中“John Wayne”是名字，而其他人会有像“John Wayne Olson”这样的名字，其中“Wayne”是他们的中间名。该名称中没有任何内容可以告诉您以哪种方式解释它。

就是那样子。这是一个模拟世界。

我的规则很简单。

取最后一部分 --> 姓
如果还有多个部分，取最后一部分 --> 中间名
剩下的 --> 名字

但不要认为这将是 100% 准确的，任何其他硬编码解决方案也不会。您将需要能够让用户自己编辑此内容。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-01-28T22:21:13.510

我做了类似的事情。我遇到的主要问题是当人们输入“Richard R. Smith, Jr.”之类的内容时。[我在http://www.blackbeltcoder.com/Articles/strings/splitting-a-name-into-first-and-last-names](http://www.blackbeltcoder.com/Articles/strings/splitting-a-name-into-first-and-last-names)上发布了我的代码。它在 C# 中，但可以很容易地转换为 VB。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-06-17T03:41:00.527

更简单的方法：

安装`HumanNameParser`NuGet：

```
Install-Package HumanNameParser 
```

并调用 Parse 扩展方法。

```
string name = "Mr Ali R Von Bayat III";

var result = name.Parse();

//result = new Name()
//{
//    Salutation = "Mr",
//    FirstName = "Ali",
//    MiddleInitials = "R",
//    LastName = "Von Bayat",
//    Suffix = "III"
//}; 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2008-09-19T16:32:49.990

我同意**不这样做**。Rick Van DenBoer 这个名字最终会以 Van 的中间名结尾，但它是姓氏的一部分。

# sql-server - 最好的 SQL Server 性能优化技术是什么？

> ID：103423
> 
> 赞同：17
> 
> 时间：2008-09-19T16:23:31.603
> 
> 标签：sql-server, optimization

我一直采用的方法是首先使用最少的索引集部署数据库，然后根据性能要求添加/更改索引。

这种方法相当有效。但是，它仍然没有告诉我在哪里可以提高性能。它只告诉我哪里的性能如此糟糕以至于用户抱怨它。

目前，我正在重构我们许多应用程序上的数据库对象。

那么，既然“过早的优化是万恶之源”，我不应该费心去寻找性能改进吗？

在重构应用程序代码时，开发人员一直在寻找提高代码质量的方法。有没有办法不断寻求数据库性能的改进？如果是这样，您发现哪些工具和技术最有帮助？

我曾短暂地玩过“数据库引擎调优顾问”，但根本没有发现它有帮助。也许我只是需要更多的经验来解释结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T16:33:45.760

我的方法是使用 SQL Server Profiler 将针对服务器或数据库的命令收集到一个表中。一旦你有了它，你就可以根据最大和平均执行时间、最大和平均 cpu 时间以及（也非常重要的）查询运行的次数进行查询。

由于我尝试将所有数据库访问代码放在存储过程中，因此我很容易分解查询。如果您使用内联 SQL，它可能会更难，因为更改查询中的值会使它看起来像一个不同的查询。您可以尝试使用 LIKE 运算符来解决此问题，将相同类型的查询放入相同的存储桶中以计算聚合（最大值、平均值、计数）。

一旦你有了潜在问题的“前 10 名”列表，你就可以开始逐个查看它们，看看是否可以重新设计查询、索引是否有帮助，或者进行小的架构更改是否合适。要得出前 10 名，请尝试以不同的方式查看数据：平均 * 计算期间的总成本，最大违规者，普通平均等。

最后，如有必要，请务必在不同的时间段内进行监控。早上每个人都进入并运行他们的每日报告时，数据库的使用可能与中午用户输入新数据时不同。您还可以决定，即使某些夜间进程比任何其他查询花费的时间更长，也没有关系，因为它是在非工作时间运行的。

祝你好运！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-19T18:17:49.597

“过早优化是万恶之源”

在数据库编程方面，我认为这句话是无稽之谈。重新编写整个应用程序非常昂贵，因为您的开发人员不关心第一次编写高效的代码。所有的 t-sql 代码都应该从它如何影响数据库性能的角度来考虑（当然，数据完整性是第一位的）。除了数据完整性之外，性能应该胜过一切。

是的，有一些优化的事情在你遇到问题之前是不应该做的，但有些事情应该理所当然地完成，以后不要修复。编写具有更高效率的代码不需要更多时间，而一旦您了解如何使用糟糕的代码影响效率，就不会花费更多时间。Cervo 对光标代码的讨论就是一个例子。基于集合的操作几乎总是比游标解决方案快得多，因此当基于集合的解决方案可以使用时，最初不应该编写游标。编写基于集合的解决方案几乎总是花费我更少的时间来编写游标，但获得这种方式的唯一方法是永远不要编写游标。

并且没有理由使用 select * 而不是指定您的字段名称。在 MSSQL 中，您可以将这些名称从对象资源管理器中拖过来，这样您就不能告诉我这样做太难了。但是通过仅指定您实际需要的字段，您可以节省网络资源和数据库服务器资源以及 Web 服务器资源。那么，程序员为什么要选择懒惰的选择 * 并担心以后的优化呢？

索引也是如此。你说你做了一组最小的索引。根据您定义最小的方式，这可能没问题，但是在所有外键上都有索引是至关重要的，我不想推送一个在最常见的几个字段上没有索引的数据库 where条款。如果您的用户是外部客户而不是内部客户，他们不会抱怨您的网站有多慢，他们会去其他地方。从一开始就计划有效的数据库访问只有在商业上才有意义。

我对未能从一开始就考虑效率的主要担忧之一是，最初几次事情太慢的时候，公司往往只是在问题上投入更多的设备而不是性能调整。当人们开始进行性能调优时，您已经拥有了数 GB 或更多的数据库，其中有许多不满意的客户，他们得到的超时多于结果。在这一点上，数据库中的几乎所有内容通常都必须重新编写，同时您正在失去客户。我记得在一家公司的商业应用程序中提供支持，客户服务代表在试图通过电话帮助已经不满的客户时，实际上需要十分钟才能从一个屏幕移动到另一个屏幕。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T16:31:39.337

SQL Server 执行计划！！！去这里：[http ://dbalink.wordpress.com/2008/08/08/dissecting-sql-server-execution-plans-free-ebook/](http://dbalink.wordpress.com/2008/08/08/dissecting-sql-server-execution-plans-free-ebook/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T16:29:52.963

分析后，将您认为麻烦的查询放入 SQL 查询分析器并显示执行计划。识别执行代价高昂的表扫描的查询部分并重新索引这些表以最小化此成本。

试试这些参考：

[优化 SQL](http://www.bcarter.com/optimsql.htm)
[如何优化查询](http://www.serverwatch.com/tutorials/article.php/2175621)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T16:25:58.447

分析您的查询，不是显而易见的查询，而是访问不同表、视图等的复杂查询和/或从不同表返回许多行的查询

这会告诉你应该把重点放在哪里

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T16:29:10.653

分析是关键，但是在使用分析集时，您必须确保它是准确的数据测试集，否则调整工具将无法为您提供所需的准确结果。

此外，2005 年使用报告的碎片化管理对象也非常有用！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T16:44:57.590

当然，您必须分析您的查询并查看执行计划。但是一遍又一遍地出现的两个主要事情是尽可能快地过滤掉，并尽量避免使用游标。

我看到一个应用程序，其中有人将整个数据库事件表下载到客户端，然后根据某些条件逐行过滤每一行。在将过滤条件传递给数据库并让查询在 where 子句中应用条件方面，性能有了巨大的提升。这对于使用数据库的人来说是显而易见的，但我也看到过类似的事情。此外，有些人的查询存储了一堆临时表，其中充满了他们不需要的行，然后在临时表的最终连接中将其消除。基本上，如果您从填充临时表的查询中消除，那么其余查询的数据就会更少，整个查询运行得更快。

光标很明显。如果您有一百万行并逐行进行，那么它将永远存在。做一些测试，如果你即使使用 Perl 这样“慢”的动态语言连接到数据库，并对数据集执行一些逐行操作，速度仍然会比数据库中的游标快得多。使用 Java/C/C++ 之类的东西，速度差异更大。如果您可以在数据库代码中找到/消除游标，它将运行得更快......如果您必须使用游标，用任何编程语言重写该部分并将其从数据库中取出可能会产生巨大的性能提升。

关于游标的另一个注意事项，注意像 SELECT @col1 = col1, @col2 = col2, @col3 = col3 这样的代码，其中 id = @currentid 在循环中遍历 ID，然后在每一列上执行语句。基本上这也是一个游标。不仅如此，使用真正的游标通常比这更快，尤其是静态和 forward_only。如果您可以将操作更改为基于设置，它将更快......话虽如此，光标在某些事情上占有一席之地......但从性能的角度来看，使用它们基于集合是有代价的方法。

还要注意执行计划。有时它估计需要几秒钟的操作非常昂贵，而需要几分钟的操作非常便宜。查看执行计划时，请确保通过在代码中插入一些 SELECT 'At this area', GETDATE() 来检查所有内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-23T21:54:47.653

我的建议是，在这种情况下，“过早的优化是万恶之源”是一派胡言。

*在我看来，这一切都与设计有关——在设计*数据模式时，您需要考虑并发性、热点、索引、缩放和使用模式。

如果您不知道需要哪些索引以及如何在不进行分析的情况下立即配置它们，那么您已经失败了。

有数百万种优化查询执行的方法，这些方法都很好，但最终数据会落在您告诉它的位置。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-08-29T12:49:59.223

**在数据库中的表列中应用适当的索引**

*   确保数据库中的每个表都有一个主键。

这将确保每个表都创建了一个聚集索引（因此，表的相应页面在磁盘中根据主键字段进行物理排序）。因此，任何使用主键从表中检索数据的操作，或对主键字段或 where 子句中指定的任何主键值范围的任何排序操作，都会非常快速地从表中检索数据。

*   在列上创建非聚集索引

    常用于搜索条件。

    用于连接其他表。

    用作外键字段。

    具有高选择性（从特定值的总行数中返回低百分比 (0-5%) 行的列）。

    在 ORDER BY 子句中使用。

**不要在 SQL 查询中使用“SELECT*”**

可能会获取不必要的列，这会增加数据检索时间的费用。数据库引擎无法利用“覆盖索引”的优势，因此查询执行缓慢。

例子：

```
SELECT Cash, Age, Amount FROM Investments; 
```

代替：

```
SELECT * FROM Investments; 
```

**尽量避免在 Select 语句中使用 HAVING 子句**

HAVING 子句用于在选择所有行之后过滤行，并且用作过滤器。尽量不要将 HAVING 子句用于任何其他目的。

例子：

```
SELECT Name, count (Name) FROM Investments WHERE Name!= ‘Test’ AND Name!= ‘Value’ GROUP BY Name; 
```

代替：

```
SELECT Name, count (Name) FROM Investments GROUP BY Name HAVING Name!= ‘Test’ AND Name!= ‘Value’ ; 
```

**尽量减少查询中子查询块的数量**

有时我们的主查询中可能有多个子查询。我们应该尽量减少查询中子查询块的数量。

例子：

```
SELECT Amount FROM Investments WHERE (Cash, Fixed) = (SELECT MAX (Cash), MAX (Fixed) FROM Retirements) AND Goal = 1; 
```

代替：

```
SELECT Amount FROM Investments WHERE Cash = (SELECT MAX (Cash) FROM Retirements) AND Fixed = (SELECT MAX (Fixed) FROM Retirements) AND Goal = 1; 
```

**避免 SELECT 列表中不必要的列和连接条件中不必要的表**

在 Select 查询中选择不必要的列会增加实际查询的开销，尤其是当不必要的列是 LOB 类型时。在连接条件中包含不必要的表会迫使数据库引擎检索和获取不必要的数据并增加查询执行时间。

**不要在子查询中使用 COUNT() 聚合来进行存在性检查**

当您使用 COUNT() 时，SQL Server 不知道您正在执行存在检查。它通过执行表扫描或扫描最小的非聚集索引来计算所有匹配值。当您使用 EXISTS 时，SQL Server 知道您正在执行存在性检查。当它找到第一个匹配值时，它返回 TRUE 并停止查找。

**尽量避免连接两种类型的列**

在不同数据类型的两列之间连接时，必须将其中一列转换为另一列的类型。类型较低的列是被转换的列。如果您要连接类型不兼容的表，其中一个可以使用索引，但查询优化器不能在它转换的列上选择索引。

**尽量不要使用 COUNT(*) 获取表中的记录数**

要获取表中的总行数，我们通常使用以下 Select 语句：

```
SELECT COUNT(*) FROM [dbo].[PercentageForGoal] 
```

此查询将执行全表扫描以获取行数。以下查询不需要全表扫描。（请注意，这可能不会始终为您提供 100% 完美的结果，但这仅在您不需要完美计数时才很方便。）

```
SELECT rows FROM sysindexes
WHERE id = OBJECT_ID('[dbo].[PercentageForGoal]') AND indid< 2 
```

**尝试在查询中适当地使用 EXISTS、IN 和 JOINS 等运算符**

*   通常 IN 的性能最慢。
*   IN 是有效的，只有当大多数用于选择的过滤条件都放在 SQL 语句的子查询中时。
*   当用于选择的大多数筛选条件位于 SQL 语句的主查询中时，EXISTS 是有效的。

**尽量避免动态SQL**

除非确实需要，否则尽量避免使用动态 SQL，因为： 动态 SQL 很难调试和排除故障。如果用户向动态 SQL 提供输入，则存在 SQL 注入攻击的可能性。

**尽量避免使用临时表**

除非确实需要，否则尽量避免使用临时表。而是使用表变量。在 99% 的情况下，表变量驻留在内存中，因此速度要快得多。临时表驻留在 TempDb 数据库中。因此对临时表进行操作需要数据库间通信，因此会更慢。

**代替 LIKE 搜索，使用全文搜索来搜索文本数据**

全文搜索总是优于 LIKE 搜索。全文搜索将使您能够实现使用 LIKE 搜索无法实现的复杂搜索条件，例如搜索单个单词或短语（以及可选地对结果集进行排名）、搜索靠近另一个单词或短语词或短语，或搜索特定词的同义形式。实现全文搜索比 LIKE 搜索更容易实现（尤其是在搜索需求复杂的情况下）。

**尝试使用 UNION 来实现“或”操作**

尽量不要在查询中使用“OR”。而是使用“UNION”来组合两个有区别的查询的结果集。这将提高查询性能。如果不需要区分结果，最好使用 UNION ALL。UNION ALL 比 UNION 更快，因为它不必对结果集进行排序以找出可区分的值。

**为大对象实现延迟加载策略**

将大对象列（如 VARCHAR(MAX)、图像、文本等）存储在与主表不同的表中，并在主表中放置对大对象的引用。检索一次查询中的所有主表数据，如果需要加载大对象，则仅在需要时才从大对象表中检索大对象数据。

**在用户定义的函数中实施以下良好实践**

不要在存储过程、触发器、函数和批处理中重复调用函数。例如，您可能在过程的许多地方都需要字符串变量的长度，但不要在需要时调用 LEN 函数；相反，调用 LEN 函数一次，并将结果存储在变量中以备后用。

**在触发器中实施以下良好实践**

*   尽量避免使用触发器。触发触发器并执行触发事件是一个昂贵的过程。
*   永远不要使用可以使用约束来实现的触发器。
*   不要对不同的触发事件（插入、更新和删除）使用相同的触发器。
*   不要在触发器中使用事务代码。触发器始终在触发触发器的代码的事务范围内运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T16:27:37.553

您似乎在谈论 MS SQL。

启动分析器并记录您在数据库上运行的最常见查询。然后在打开执行计划的情况下运行这些查询，您将看到是什么（如果有的话）减慢了您的查询速度。然后，您可以优化查询或在字段上添加更多索引。

SQL Books 将为您提供概要分析和查询分析功能的良好概述。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T16:35:37.050

您可能想要检查当前索引的内部和外部框架，然后删除并重新创建它们或重新组织它们。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T16:41:44.430

确保您正在使用生产量进行分析 - 就行数**和**负载而言。查询及其计划在不同的负载/容量场景下表现不同

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-20T16:58:29.467

一般来说，这里的提示：

[http://www.sql-server-performance.com/](http://www.sql-server-performance.com/)

过去对我来说质量很高且很有用。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-11-19T08:19:47.847

我的建议是从适用于所有数据库的技术开始，然后尝试特定于 MsSQL 的技术。

优化 SQL 是困难的，并且没有硬性规定。您可以遵循的通用准则很少，例如：

*   95% 的性能改进将来自应用程序，而不是来自服务器或数据库引擎配置。
*   先设计正确性，再调整性能
*   减少访问数据库的次数
*   尝试以适合您的数据模型的方式表达事物
*   忽略关于性能的一般建议 - 是的，在某些时候，您会发现其中一个规则不适用的系统或 SQL 语句。

但关键是你应该始终应用 80-20 规则。这意味着在任何系统中，您都需要调整 20%（通常少得多）的代码才能获得最大的性能提升。这就是供应商提供的工具[通常会失败](http://consultuning.blogspot.com/2008/11/more-on-tuning-tools-from-industry.html)的地方，因为他们通常无法猜测执行的应用程序/业务上下文。

# c# - 在 Windows XP 中使用 C# 在登录屏幕上显示窗口

> ID：103427
> 
> 赞同：4
> 
> 时间：2008-09-19T16:24:04.987
> 
> 标签：c#, windows-xp, service, desktop, winlogon

我正在尝试使用 C# 创建一个服务，该服务启动一个可以显示在 Windows XP 登录屏幕上的进程。

我发现了一些在 C++ 中执行此操作的代码。C++ 代码用于创建另一个进程的服务，其中 STARTUPINFO.lpDesktop 设置为“WinSta0\WinLogon”。然后将创建的进程显示到 Windows 登录屏幕。我似乎找不到使用 System.Diagnostic.Process 类在 C# 中指定新进程的“桌面”的方法。

有谁知道如何用 C# 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T18:19:29.610

解决方案是从 C# 代码中调用 kernel32.dll 中的 C++ Win32 API 函数 CreateProcess。该站点对于获取 C# 的正确函数签名非常有帮助：

[http://www.pinvoke.net/default.aspx/kernel32/CreateProcess.html](http://www.pinvoke.net/default.aspx/kernel32/CreateProcess.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-19T16:56:59.043

我认为您必须用 C++ 编写它，将其编译为 DLL，然后从托管代码中调用 DLL。

# tcp - LSL communications

> ID：103439
> 
> 赞同：5
> 
> 时间：2008-09-19T16:25:43.393
> 
> 标签：tcp, communication, remote-execution, linden-scripting-language

Years ago I created a programming collaboratory in Diversity University MOO -- a room written in MOOcode that used TCP/IP to communicate with a perl server back at my campus to compile and execute C, Perl, Bash and other programs and return results to the MOO collaboratory -- all for demonstrating programming languages in a MOO teaching environment. The application is usually a romp in five or six languages and fun to play with. Now I'd like to do the same thing in SecondLife using LSL. The only suggestion I've gotten so far from that crowd is to use a WWW request, presumeably constructing an http POST message to a CGI process. I never cared much for html forms so I'd rather use TCP/IP or some other communications protocol. Has anyone tried this who'd care to provide a few hints? There are several good LSL demo sites in SecondLife but I'd like to demo other compiler and script languages, maybe even PowerShell. Dick S.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T18:23:03.657

[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)现在流行用于 Web 服务。根据您的描述，对于不需要超级性能或响应时间的东西，没有真正的理由深入到 TCP/IP 层。LSL HTTP 支持非常好，所以你应该没有任何问题。

当然，实时获取程序的输出并不理想 - 因为您需要在服务器上打开 http 连接并不断写入页面正文（而客户端会读取）。但即使在服务器和客户端之间来回切换，您也应该获得相当好的体验。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T18:00:49.540

LSL 的外部通信选项仅限于三个特定选项。官方 LSL wiki 提供了有关每个选项的更多详细信息。

*   **原始 HTTP：**请求必须由 LSL 脚本发起
*   **XmlHTTP：**请求必须由外部服务发起
*   **电子邮件：**完全双向通信，但具有强制睡眠定时器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T23:59:57.033

我倾向于同意伊利亚的观点。

如果您希望脚本响应速度非常快，那么最好的办法就是让服务器端代码在服务器使用 XML-RPC 意识到该对象后回调该对象。

Second Life 的主 wiki 非常适合用于示例代码等 [XML-RPC](http://wiki.secondlife.com/wiki/Category:LSL_XML-RPC)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T22:06:45.310

LSL 的 llHTTPRequest 函数和对应的 http_response 事件绝对是你最好的选择。

与您的问题中提出的假设相反，使用 http 不需要使用“html 表单”。POST（或 PUT）有效负载可以包含根据需要组织的数据。REST 接口是进行我们正在讨论的那种机器对机器 http 通信的好方法。REST 优于 html 或 xml 的一个优点是 REST 可以不那么冗长。当您开始接近 LSL 对 http 响应的 2048 个字符限制时，这一点很重要。

尽管 LSL 有另外两种与 Internet 的其余部分通信的方法（电子邮件和 xml-rpc），但现在*非常*不鼓励在 LSL 脚本中使用它们。这两个系统（目前在第二人生中实现）都依赖于集中式服务器将消息路由到它们的目的地。这不能很好地扩展。随着 Second Life 的发展，这些服务器的负载不断增加。另一方面，llHTTPRequest 完全在运行脚本的模拟器上运行，这意味着您不必担心由于中央服务器过载而丢失消息。

最后，很快就会有一个新特性添加到 LSL 中，允许任何脚本充当 http 服务器（参见[http://wiki.secondlife.com/wiki/LSL_http_server](http://wiki.secondlife.com/wiki/LSL_http_server)）。它目前（截至 2009 年 6 月）部署在 beta 网格上，但应该在下一次重大更新时位于主网格上。有了这个附加功能，许多当前定期轮询 Web 服务器以获取更新数据的 LSL 到 Web 程序将能够在更新发生时将更新推送给它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-03T10:50:04.440

正如 Ilya 所说，REST 和 LSL-HTTP 将是可行的方法。

Linden 脚本语言中 JSON的**新实现**应该对此有所帮助。您可能想先阅读官方 wiki 上 LSL 页面中的[Json 用法。](http://wiki.secondlife.com/wiki/Json_usage_in_LSL)

# windows - 从 Windows 用户模式转储文件中识别主机

> ID：103453
> 
> 赞同：2
> 
> 时间：2008-09-19T16:26:52.923
> 
> 标签：windows, debugging, crash-dumps

有没有一种简单的方法可以找出通过 WinDbg 生成用户模式转储文件的机器的主机名？

或者至少任何一条识别信息来尝试确认两个转储文件来自同一个系统。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T16:32:22.300

您可以通过使用 WinDbg 分析用户转储文件来做到这一点。运行命令并在其输出中`!peb`查找 的值。`COMPUTERNAME`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:31:35.143

从调试器.chm：

**在内核模式转储文件中查找计算机名称**

如果您需要确定进行故障转储的计算机的名称，您可以使用 !peb 扩展名并在其输出中查找 COMPUTERNAME 的值。

或者您可以使用以下命令：

```
0: kd> x srv!SrvComputerName
be8ce2e8  srv!SrvComputerName  = _UNICODE_STRING "AIGM-MYCOMP-PUB01" 
```

**在内核模式转储文件中查找 IP 地址**

要确定进行故障转储的计算机的 IP 地址，请查找显示某些发送/接收网络活动的线程堆栈。打开其中一个发送数据包或接收数据包。IP 地址将在该数据包中可见。

编辑：我会注意到，根据转储文件的创建方式，PEB 信息可能不可用，因此您不会*总是*能够找到计算机名称。特别是如果某些内容来自 Microsoft Winqual 站点，它已经过清理。

在 PEB 中使用环境变量的快捷方式：!envvar COMPUTERNAME

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-14T19:06:51.423

**对于 IP 地址列表：**
3: kd> du poi(poi(srvnet!SrvAdminIpAddressList))
ffffe001 d3d58464 "::1" 3: kd> ffffe001 d3d5848a "" 3: kd> ffffe001 d3d584c0 "" 3: kd> ffffe001 d3d584e2 "" 3: kd> ffffe001`d3d584e4 "fe80::fc6f:ae16:b336:83dc" 3: kd> `d3d58450 "127.0.0.1" 3: kd> du
ffffe001`

`d3d5846c "169.254.66.248"
3: kd>
ffffe001`

`d3d5848c "fe80::f0cb:5439:f12f:42f8"
3: kd>
ffffe001`
`d3d584c2 "192.168.104.249" 3: kd> ffffe001`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-11T02:47:34.983

在内核和用户模式下，

```
10: kd> !envvar COMPUTERNAME
COMPUTERNAME = a-host-name 
```

检索目标 PC 的计算机名称，即主机名。

它需要`EXTS.dll`加载扩展程序和 Windows XP+（撰写本文时为 W10 RS3）。

在内核模式下，这不直接起作用，`!envvar`会返回空

```
10: kd> !peb
PEB NULL... 
```

您当前的上下文是一个空闲线程。

WinDbg（Windows 10 RS3 16299.15 SDK）帮助`!process`仅列出位 0-4，但是我发现位 5 与 0 和 4 一起使用时会转储整个环境。标志 = `0b110001`. 所以我在 WinDbg 启动脚本期间使用它来自动记录计算机名称。

```
!process 0 0x31 wininit.exe 
```

将转储所有环境变量：

```
10: kd> !process 0 0x31 wininit.exe
PROCESS ffffc485c82655c0
    SessionId: 0  Cid: 02d0    Peb: 8d04c6b000  ParentCid: 0258
    DirBase: 40452f000  ObjectTable: ffffe30b1150fb40  HandleCount: 163.
    Image: wininit.exe
    VadRoot ffffc485c862b990 Vads 61 Clone 0 Private 326\. Modified 12\. Locked 2.
    DeviceMap ffffe30b0a817880
    Token                             ffffe30b1150f060
    ElapsedTime                       00:00:18.541
    UserTime                          00:00:00.000
    KernelTime                        00:00:00.015
    QuotaPoolUsage[PagedPool]         121696
    QuotaPoolUsage[NonPagedPool]      11448
    Working Set Sizes (now,min,max)  (1750, 50, 345) (7000KB, 200KB, 1380KB)
    PeakWorkingSetSize                1697
    VirtualSize                       2097239 Mb
    PeakVirtualSize                   2097239 Mb
    PageFaultCount                    2104
    MemoryPriority                    BACKGROUND
    BasePriority                      13
    CommitCharge                      470

    PEB at 0000008d04c6b000            
    InheritedAddressSpace:    No
    ReadImageFileExecOptions: No
    BeingDebugged:            No
    ImageBaseAddress:         00007ff7be3d0000
    Ldr                       00007ff8dff4f3a0
    Ldr.Initialized:          Yes
    Ldr.InInitializationOrderModuleList: 000001be470e1c10 . 000001be47128d60
    Ldr.InLoadOrderModuleList:           000001be470e1d80 . 000001be47128d40
    Ldr.InMemoryOrderModuleList:         000001be470e1d90 . 000001be47128d50
                    Base TimeStamp                     Module
            7ff7be3d0000 600d94df Jan 24 10:40:15 2021 C:\Windows\system32\wininit.exe
            7ff8dfdf0000 493793ea Dec 04 03:25:14 2008 C:\Windows\SYSTEM32\ntdll.dll
...
    SubSystemData:     0000000000000000
    ProcessHeap:       000001be470e0000
    ProcessParameters: 000001be470e1460
    CurrentDirectory:  'C:\Windows\system32\'
    WindowTitle:  '< Name not readable >'
    ImageFile:    'C:\Windows\system32\wininit.exe'
    CommandLine:  'wininit.exe'
    DllPath:      '< Name not readable >'
    Environment:  000001be47104460
        ALLUSERSPROFILE=C:\ProgramData
        CommonProgramFiles=C:\Program Files\Common Files
        CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
        CommonProgramW6432=C:\Program Files\Common Files
        COMPUTERNAME=a-host-name
        ComSpec=C:\Windows\system32\cmd.exe
        NUMBER_OF_PROCESSORS=16
        OS=Windows_NT
        Path=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\
        PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
        PROCESSOR_ARCHITECTURE=AMD64
        PROCESSOR_IDENTIFIER=AMD64 Family 23 Model 1 Stepping 1, AuthenticAMD
        PROCESSOR_LEVEL=23
        PROCESSOR_REVISION=0101
        ProgramData=C:\ProgramData
        ProgramFiles=C:\Program Files
        ProgramFiles(x86)=C:\Program Files (x86)
        ProgramW6432=C:\Program Files
        PSModulePath=%ProgramFiles%\WindowsPowerShell\Modules;C:\Windows\system32\WindowsPowerShell\v1.0\Modules
        PUBLIC=C:\Users\Public
        SystemDrive=C:
        SystemRoot=C:\Windows
        TEMP=C:\temp
        TMP=C:\temp
        USERNAME=SYSTEM
        USERPROFILE=C:\Windows\system32\config\systemprofile
        windir=C:\Windows 
```

您可以单击 PEB dml 链接，或通过 切换上下文`.process /p <PROCESS_ADDRESS>`，然后`!envvar COMPUTERNAME`也可以使用。

# .net - 在 .NET 应用程序中确定机器名称的最佳方法是什么？

> ID：103460
> 
> 赞同：4
> 
> 时间：2008-09-19T16:27:59.970
> 
> 标签：.net

我需要获取运行我的 .NET 应用程序的机器的名称。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T18:05:57.287

虽然其他人已经说过[System.Environment.MachineName](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)返回您机器的名称，但请注意......

该属性仅返回 NetBIOS 名称（并且仅当您的应用程序具有 EnvironmentPermissionAccess.Read 权限时）。您的机器名称可能会超过以下定义的长度：

```
MAX_COMPUTERNAME_LENGTH 
```

在这些情况下，System.Environment.MachineName 不会返回正确的名称！

另请注意，您的机器可以使用多个名称，在 Win32 中，有一个[GetComputerNameEx](http://msdn.microsoft.com/en-us/library/ms724301(VS.85).aspx)方法能够获取与这些不同名称类型中的每一个匹配的名称：

*   计算机名称 Dns 域
*   计算机名称DnsFullyQualified
*   ComputerNameDnsHostname
*   计算机名称NetBIOS
*   计算机名称PhysicalDnsDomain
*   计算机名称PhysicalDnsFullyQualified
*   ComputerNamePhysicalDnsHostname
*   计算机名称PhysicalNetBIOS

如果你需要这些信息，你可能需要通过 p/invoke 去 Win32，比如：

```
class Class1
{
    enum COMPUTER_NAME_FORMAT
    {
        ComputerNameNetBIOS,
        ComputerNameDnsHostname,
        ComputerNameDnsDomain,
        ComputerNameDnsFullyQualified,
        ComputerNamePhysicalNetBIOS,
        ComputerNamePhysicalDnsHostname,
        ComputerNamePhysicalDnsDomain,
        ComputerNamePhysicalDnsFullyQualified
    }

    [DllImport("kernel32.dll", SetLastError=true, CharSet=CharSet.Auto)]
    static extern bool GetComputerNameEx(COMPUTER_NAME_FORMAT NameType,
                       [Out] StringBuilder lpBuffer, ref uint lpnSize);

    [STAThread]
    static void Main(string[] args)
    {
        bool success;
        StringBuilder name = new StringBuilder(260);
        uint size = 260;
        success = GetComputerNameEx(COMPUTER_NAME_FORMAT.ComputerNameDnsDomain,
                                    name, ref size);
        Console.WriteLine(name.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T16:28:48.207

[`System.Environment.MachineName`](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:29:26.253

~~尝试[Environment.MachineName](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)。~~Ray 实际上有**最好的** [答案](https://stackoverflow.com/questions/103460/whats-the-best-way-to-determine-the-name-of-your-machine-in-a-net-app#104154)，尽管您需要使用一些互操作代码。

# .net - Adding .net Webservice references

> ID：103474
> 
> 赞同：1
> 
> 时间：2008-09-19T16:29:10.797
> 
> 标签：.net, vb.net, visual-studio-2008, wsdl

I'm getting near completely different objects from the same WSDL file when I try to Add a Web Reference depending if I am using Express or Pro version of the vs2008 .NET IDE.

1) Why is this happening? I'd expect the WSDL's to act the same across platforms--clearly they are not! 2) How do I determine what tool/wizard the IDE is calling when I select "Add Service Reference".

Details: The VB.NET Express version is adding objects that are desired and expected. I'd like to use the IDE to add the service (not muck with wsdl.exe or svcutil.exe).

I'm using vs2008 Pro v9.0.30729.1 on Windows Server 2003\. Express version 9.0.21022.8 RTM on XP.The respective Reference.vb shows the same header "This code was generated by a tool. Runtime Version:2.0.50727.3053".

The wizard UI's to add the service WSDL are visually different between the two IDEs.

Express has Strict On and Pro has Strict Off. The general IDE Strict settings seem to have no control over this.

Java/Eclipse are having no issues with these WSDLs.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T02:17:29.167

很抱歉，视觉工作室生成的代理非常糟糕。

现在真正的解决方案是编写自己的合约和代理。我知道，这不是什么好消息，但 30 分钟的打字可能会让你免于受伤。

查看[idesign.net上的帮助类](http://www.idesign.net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:31:08.217

I have seen in the past where wsdl.exe would produce different proxy classes than the VS IDE wizard does. This is probably the explanation.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:32:37.167

Try using svcutil.exe instead.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T17:32:42.873

当您添加 Web 引用时，VS 2005 和 2008 Pro 会生成不同的类 - 也许这很相似？如果在添加服务引用时单击高级，您将在表单底部找到添加 Web 引用。

# c# - iPhone 编程 - 印象，意见？

> ID：103480
> 
> 赞同：6
> 
> 时间：2008-09-19T16:29:48.127
> 
> 标签：c#, c++, iphone, objective-c, development-environment

多年来，我一直在使用 C、C++、C# 和其他几种语言进行编程，主要用于 Windows 和 Linux，但也用于嵌入式平台。最近开始做一些 iPhone 编程作为一个副项目，所以我在 Apple II 时代以来第一次使用 Apple 平台。我想知道其他使用 Mac OSX、Xcode 和 iPhone SDK 的开发人员会怎么想。以下是我的印象，到目前为止：

*   Mac OSX：非常混乱，我往往会打开太多的窗口并且不知道在哪里。幸好有鸟瞰图，没有它我会迷路的。至少有了外壳，就有了所有熟悉的东西，所以这对我有很大帮助。

*   Xcode：感觉不如 VisualStudio 或 Eclipse 这两个我熟悉的环境。我想我可以习惯它，但我想知道 Apple 使用 Eclipse 是否会更好。在我发现所有窗户都粘在一起的环境之前，我讨厌它，现在我可以忍受了。

*   iPhone SDK：确实很奇怪。我理解 Apple 想要控制他们的环境的愿望，但在这个时代，这似乎有点低俗，他们通过破坏开发者的善意而错过了很多东西。

*   Objective-C：我知道它很多年了，但从未看过它。语法令人反感，但我实际上对这种语言非常感兴趣。我认为这是 C++ 和 C# 之间有趣的第三站，我非常喜欢这两者。由于 Apple 技术的普及，Obj-C 是否有可能突破 Mac 沙盒？

好奇地阅读你的想法，

安德鲁

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T16:45:09.243

我和你在同一条船上（有点）。从 .NET 1.0 开始，我已经用 C# 开发了 7 年。在过去的几周里，我一直在自学 Cocoa 和 Objective-C。这是我的印象（与你的注意事项）

*   同意这种混乱可能是一个问题。在 XCode 中进行开发时，我倾向于大量使用 Spaces（将 XCode 放在一个空间中，Interface Builder 放在另一个空间中，Instruments 放在第三个空间中）。如果您没有 Leopard（因此没有空格），请使用 Command-H 隐藏您的活动窗口。使用它往往会清理很多东西（但是，如果您可以在命令选项卡到另一个应用程序时自动命令-h当前窗口，那就太好了）。

*   我越来越喜欢 XCode。我讨厌 Visual Studio - 我发现它不稳定、缓慢，而且是一个糟糕的 IDE。相比之下，我发现 XCode 快速、稳定，而且我喜欢它组织和过滤文件的方式。我对我的 XCode 快捷方式不太感兴趣，但我希望有一种方法可以快速从一个类切换到另一个类（类似于 ReSharper 中的 ctrl +n 快捷方式）。Intellisense 在如何向用户显示方面可能会更好，但我真的很喜欢它本质上创建模板的方式，您可以通过 ctrl + / 跳转到消息中的下一个参数。

*   我讨厌 XCode 中的文档。帮助系统很糟糕，无论出于何种原因，它*永远*找不到我正在寻找的东西。我最终只是在谷歌上搜索我需要知道的任何东西......我希望他们改进文档。这是我现在最大的牛肉。

*   还没有，因为我正在浏览适用于 Mac 桌面的完整 Cocoa 框架。到目前为止，我真的，真的很喜欢我所看到的。我要说的一件事是，如果 iPhone SDK 允许垃圾收集，那就太好了……

*   Objective-C - 我从未使用过它，这是我第一次尝试它。起初我对消息传递的语法和方括号有点厌烦，但它真的在我身上成长。浏览一个方法并查看该方法发出的消息调用非常快。我使用它的次数越多，Objective-C 的感觉就越好……但是模板/泛型将是该语言的一个受欢迎的补充。

总而言之，我对 Mac 开发的尝试是愉快的，我很高兴开始（今天！耶！）一些实际的 mac/iphone 项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T16:36:46.080

我同意你的观点。从 Microsoft 开发工具（和 eclipse）到 XCode 有点苛刻。XCode 只是感觉……在某些方面还没有完成。它当然没有我对 VS 和 Eclipse 的期望。

SDK 是类似的，其中大部分都没有很好的文档记录，并且有很多你知道应该存在的漏洞，但事实并非如此。尝试仔细控制音频/视频文件的播放就是一个例子。

然而，Objective-C 很棒。我真的很喜欢这门语言，尽管它有怪癖和特质（null 的消息不是运行时异常？真的吗？）一旦你的 C++ 眼睛习惯了语法，松散类型的匿名消息传递实际上最终会变得非常酷有（如果有点危险并且容易发生 RTE。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T16:49:25.240

我真的很想继续开发 iPhone 应用程序。我做过一些摩托罗拉、黑莓和 Windows Mobile 的开发，这些都很酷，而且很容易通过良好的文档进入，易于访问和安装 SDK。到目前为止，我觉得苹果有点精英化，因为他们的开发环境似乎只在 Mac 上可用。我也不太喜欢他们的许可概念。如果您希望能够真正发布应用程序，您需要通过它们，并且他们对您是否可以或您的应用程序是否被认为可以在他们的优质产品上运行有最终决定权。我相信他们让开源社区更难维护和生产应用程序，或者像我这样的 iPhone 新手甚至开始为产品编写应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T17:08:14.040

我曾开发过一些小型 iPhone 应用程序，但令我惊讶的是它们没有包含使开发人员能够轻松访问 SOAP Web 服务的框架组件。在企业 IT 环境中工作的其他任何人都感到痛苦吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T04:41:05.817

我个人认为文档在这一点上非常好。在任何 Objective C 类上，您可以选择双击以显示该术语的文档，以及是否有任何示例项目使用列出的特定类（至少对于许多 iPhone 特定类）。

刚开始时也考虑打开 Research Assistant，并打开 Code Sense（不要认为它默认打开）。当你习惯了 XCode + Interface Builder 的组合时，它的功能非常强大，坦率地说，几十年来，我从未使用过更好的界面构建器，就代码集成的工作方式或设计智能调整大小的界面的能力而言大量的额外工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T10:25:50.253

在为许多平台编程多年之后，我对 iPhone 编程和 XCode 也很陌生，我的印象与您的印象相当接近（有一些差异）：

*   Mac OSX：大约 2 年前（作为实验）我从 Windows 切换并留下了 :) - 我不认为我会切换回来。拥有 Unix 基础非常酷，我喜欢华丽的 GUI + 我喜欢界面的基本简单性。我花了大约 2 个月的时间来适应它，但我无法想象回去。我讨厌 MacBook 的键盘布局和一些 OSX 的键盘限制。有趣的是，一家以其可用性洞察力而自豪的公司怎么会做出如此糟糕的决定。也许最好的例子是没有上下文菜单（右键单击）键盘快捷键，并且您需要两个键来完成诸如 Home、End、PgUp 等任务。我的主要建议是花时间学习尽可能多的键盘尽可能走捷径。我还建议安装 &[Quicksilver](http://docs.blacktree.com/quicksilver/what_is_quicksilver)、[路径查找器](http://www.cocoatech.com/)、[1Password](http://agilewebsolutions.com/products/1Password)、[Things](http://culturedcode.com/things/)、[TextMate](http://macromates.com/)、[Text Wrangler](http://www.barebones.com/products/textwrangler/) & [Transmit](http://www.panic.com/transmit/)。

*   Xcode：我完全同意你的看法。我认为 XCode**相当原始**。我将它与我经常使用的 IntelliJ IDEA 进行比较，感觉 Apple 至少在 7 年前就被困住了：

    *   代码导航太原始了，有太多的窗口跳来跳去
    *   你必须一直使用鼠标
    *   模板非常有限，并且基于与上下文或范围无关的幼稚宏观概念
    *   重构仅限于几个简单的动作
    *   您甚至无法轻松完成诸如覆盖方法之类的琐碎任务
    *   Code Sense 很好，但如果它理解打字可能会更好......

    具有讽刺意味的是，严肃的 Mac 开发人员*甚至不明白他们有问题*......他们已经习惯了必须处理的混乱局面，以至于他们无法想象一个更美好的世界......而不是帮助你， XCode 一直在阻碍。与现代 Java IDE（Eclipse、IntelliJ）相比，我可以举出几十个例子来说明这个环境是如何糟糕的，但我认为这是在浪费时间——苹果似乎太自豪而无法向其他人学习......如果您考虑到 Java 的发明者并不羞于向[Objective-C 学习](http://cs.gmu.edu/~sean/stuff/java-objc.html)这一事实，那就很有趣了。我唯一的建议（也是对我自己）是每次打开 XCode 时都要深呼吸，并[尽可能多地向](https://stackoverflow.com/questions/146297/what-are-those-little-xcode-tips-tricks-you-wish-you-knew-about-2-years-ago)更习惯这种环境的专家学习。

*   iPhone SDK：比这更糟糕——几个月前我们考虑将[我们的移动应用程序](http://interbine.com/ibservice/main.action)移植到 iPhone 上，但决定不打扰，因为我们担心 Apple 可能会从应用程序商店拒绝它，而你无法提前知道（他们过去曾[拒绝](http://www.macworld.com/article/135527/2008/09/appstore.html)过一个有点相似的应用程序，理由是它与 iTunes 太接近了！）

*   Obj-C: I find Objective-C quite nice and after a few days you get used to the awkward messaging syntax, but boy do I miss garbage collection... Having to deal with memory allocations and releases feels a bit like going back in time to my early C/C++ days. I'm just beginning to learn the nuances of this language, but so far I like what I found. There are quite a few tips scattered around the web about Obj-C best practices that you can't find in the official docs and I learned a lot from them (see for example the following discussion [here on stackoverflow](https://stackoverflow.com/questions/155964/what-are-best-practices-that-you-use-when-writing-objective-c-and-cocoa))

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T17:08:26.520

我也有 C# 背景，从 beta 2 开始就一直在使用 iPhone SDK。我完全同意克兰利的观点，即 VS 与 Xcode 相比有点笨拙。Xcode 是非常不同的，当你开始使用它时完全陌生。VS 在过去也是如此。一旦你通过了学习曲线，那将是一次美妙的体验。我正在开发的应用程序使用 C# 服务器端（Web 服务），我非常讨厌不得不切换到 VS 来从 Xcode 编写 Web 服务代码。一旦您了解了 Obj-C 的最佳工作方式，使用起来也非常有趣：委托（与 .NET 委托非常不同）、消息、类别和所有其他奇怪的东西。

我在 .NET 之前做过一些 Java 和 Flex 编程，与 Java 文档相比，我总是讨厌 .NET 文档。他们只是不削减它。我个人发现 Xcodes 文档和搜索系统简直令人惊叹。从包含大量示例代码的文档中链接了无数的 PDF 指南。想一想：iPhone SDK 已经退出测试版大约 2 个月了。文档显示了多年的成熟度。是的，这是因为 Obj-C 已经问世一年多了，而且框架很相似。

总的来说，我发现的最大问题是，有很多 .NET 开发人员加入了 iPhone 的潮流，并试图像使用 C# 或 VB 一样使用 Obj-C。他们没有阅读基本的 Obj-C 文档，更不用说 iPhone 文档，然后他们非常沮丧并最终失败。讨论区充满了这种场景。iPhone 编程并不容易。学习一门新语言并不容易。这需要时间和大量的try.fail.try。这不是 .NET，所以在你开始之前就失去这种心态，事情会很棒。

# javascript - 使用 jQuery 即时构建 HTML 表格

> ID：103489
> 
> 赞同：21
> 
> 时间：2008-09-19T16:31:08.293
> 
> 标签：javascript, jquery

下面是我用来动态构建 HTML 表的代码（使用从服务器接收的 JSON 数据）。

我在加载数据时显示一个动画请等待 (.gif) 图形。但是，当 JavaScript 函数正在构建表格时，图形会冻结。起初，我很高兴能做到这一点（显示表格），我想现在我需要提高效率。至少我需要阻止动画图形冻结。我可以去一个静态的“加载”显示，但我宁愿让这个方法工作。

对我的 pleasewait 显示有什么建议吗？和效率？可能是构建表格的更好方法？或者也许不是一张桌子，而是其他一些“桌子”，比如显示

```
var t = eval( "(" + request + ")" ) ;
var myTable = '' ;
myTable += '<table id="myTable" cellspacing=0 cellpadding=2 border=1>' ;
myTable +=  "<thead>" ;
myTable +=   "<tr>";
for (var i = 0; i < t.hdrs.length; i++) {
    myTable +=    "<th>"     + header +       "</th>";
}
myTable +=   "</tr>" ;
myTable +=  "</thead>" ;
myTable +=  "<tbody>" ;

for (var i = 0; i < t.data.length; i++) {
    myTable +=    '<tr>';
    for (var j = 0; j < t.hdrs.length; j++) {
        myTable += '<td>';
        if (t.data[i][t.hdrs[j]] == "") {
            myTable += "&nbsp;" ;
        }
        else {
            myTable += t.data[i][t.hdrs[j]] ;
        }
        myTable += "</td>";
    }
    myTable +=    "</tr>";
}
myTable +=  "</tbody>" ;
myTable += "</table>" ;

$("#result").append(myTable) ;
$("#PleaseWaitGraphic").addClass("hide");
$(".rslt").removeClass("hide") ; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-20T00:51:49.463

你基本上想要设置你的循环，以便它们每隔一段时间就让给其他线程。以下是[本文中](http://www.julienlecomte.net/blog/2007/10/28/)有关在不冻结 UI 的情况下运行 CPU 密集型操作的一些示例代码：

```
function doSomething (progressFn [, additional arguments]) {
    // Initialize a few things here...
    (function () {
        // Do a little bit of work here...
        if (continuation condition) {
            // Inform the application of the progress
            progressFn(value, total);
            // Process next chunk
            setTimeout(arguments.callee, 0);
        }
    })();
} 
```

至于在脚本中简化 HTML 的生成，如果您使用 jQuery，您可以试试我的[Simple Templates](http://plugins.jquery.com/project/simple-templates)插件。它通过大幅减少您必须执行的连接数量来整理过程。在我最近进行了一些重构之后，它的性能也非常好，这导致了相当大的[速度提升](http://andrew.hedges.name/experiments/simple-templates-speed-test/)。这是一个示例（无需为您完成*所有*工作！）：

```
var t = eval('(' + request + ')') ;
var templates = {
    tr : '<tr>#{row}</tr>',
    th : '<th>#{header}</th>',
    td : '<td>#{cell}</td>'
};
var table = '<table><thead><tr>';
$.each(t.hdrs, function (key, val) {
    table += $.tmpl(templates.th, {header: val});
});
... 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-19T18:07:11.653

我一直在使用[JTemplates](http://jtemplates.tpython.com/)来完成您所描述的内容。[Dave Ward 在他的](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)博客上有一个例子。JTemplates 的主要好处是您的 html 不会被编织到您的 javascript 中。您编写一个模板并调用两个函数让 jTemplate 从您的模板和 json 构建 html。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T16:36:32.760

您正在做的是构建一个字符串，然后在插入时立即解析它。如何创建一个实际的表格元素（即`$("<table>")`），然后依次向其中添加每一行？当您实际将其插入页面时，DOM 节点将全部构建完毕，因此它应该不会受到太大影响。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-20T07:55:39.337

使用innerHTML 肯定比使用jQuery 的HTML-to-DOM-ifier 快得多，后者使用innerHTML 但对输入进行大量处理。

我建议检查[chain.js](http://github.com/raid-ox/chain.js/wikis)作为一种从 JavaScript 对象快速构建表和其他重复数据结构的方法。它是一个非常轻量级、智能的 jQuery 数据绑定插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T16:58:59.053

对于初学者，请查看[flydom](http://flydom.socianet.com/)及其变体，它们将提供大量帮助。您能否提供更多背景信息？如果这不在 onload 中并且只是粘贴在页面中，只需将整个内容包装在 $(function () { /* code */ }) 中可能会清理您遇到的所有问题。内联 JS 立即执行，这意味着表的循环。onload 是一个事件，本质上是“分离的”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T18:03:31.740

我的经验是有两个离散的延迟。一个是将所有这些字符串连接在一起。另一种是浏览器实际尝试呈现字符串时。通常，IE 最容易出现 UI 冻结问题，部分原因是它在运行 javascript 时要慢得多。这在 IE8 中应该会变得更好。

在您的情况下，我建议将操作分成几个步骤。假设一个 100 行表，您首先生成一个有效的 10 行表。然后将其输出到屏幕并使用 setTimeout 将控制权返回给浏览器，以便 UI 停止阻塞。当 setTimeout 返回时，您执行接下来的 10 行，依此类推。

正如其他人所说，使用 DOM 创建表肯定是“更干净”的。然而，就性能而言，要付出高昂的代价。请参阅有关此主题的出色[quirksmode](http://www.quirksmode.org/dom/innerhtml.html)文章，其中包含一些您可以自己运行的基准。

长话短说，innerHTML 比 DOM 快得多，甚至在现代 JS 引擎上也是如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-05T22:20:44.117

在 Web 上搜索 JavaScript 和 StringBuilder。一旦你有了一个 JavaScript 字符串构建器，请确保你`.append`对每个连接都使用该方法。也就是说，您不希望有任何`+`串联。之后，搜索 JavaScript 并替换html。使用此功能代替`innerHTML`.

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-09-19T17:49:25.250

您可以将表格一点一点地插入到 DOM 中。老实说，我不完全确定这是否有助于解决您的问题，但值得一试。我会大致这样做（未经测试的代码，可以进一步完善）：

```
$("#result").append('<table id="myTable" cellspacing=0 cellpadding=2 border=1></table>');
$('#myTable').append('<thead><tr></tr></thead>');
$('#myTable').append('<tbody></tbody>');

for (var i = 0; i < t.hdrs.length; i++) { 
    $('#myTable thead tr').append('<th>'+header+'</th>');
}

for (var i = 0; i < t.data.length; i++) { 
 myTr =    '<tr>';
 for (var j = 0; j < t.hdrs.length; j++) { 
  myTr += '<td>';
  if (t.data[i][t.hdrs[j]] == "") { 
   myTr += "&nbsp;" ; 
  }
  else { 
   myTr += t.data[i][t.hdrs[j]] ; 
  }
  myTr += "</td>";
  }
 myTr +=    "</tr>";
 $('#myTable tbody').append(myTr);
}

$("#PleaseWaitGraphic").addClass("hide");
$(".rslt").removeClass("hide") ; 
```

# java - Best way of restarting a jetty instance

> ID：103508
> 
> 赞同：3
> 
> 时间：2008-09-19T16:33:34.840
> 
> 标签：java, jetty

I'm using start.jar and stop.jar to stop and start my jetty instance. I restart by calling stop.jar, then start.jar. The problem is, if I don't sleep long enough between stop.jar and start.jar I start getting these random ClassNotFoundExceptions and the application doesn't work correctly.

Sleeping for a longer period of time between stop and start is my current option.

I also heard from someone that I should have something that manages my threads so that I end those before jetty finishes. Is this correct? The question I have about this is that stop.jar returns immediately, so it doesn't seem to help me, unless there's something I'm missing. Another option might be to poll the log file, but that's pretty ugly.

What's the best way of restarting jetty?

Gilbert: The Ant task is definitely not a bad way of doing it. However, it sleeps for a set amount of time, which is exactly what I'm trying to avoid.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T21:48:53.583

你能在调用shutdown之后和调用startup之前写一个shell脚本来做这样的事情吗？

```
LISTEN_PORT = `netstat -vatn | 听听| grep 8080 | wc -l`
而 [$LISTEN_PORT -ne 0] ; 做
    睡觉 1
    LISTEN_PORT = `netstat -vatn | 听听| grep 8080 | wc -l`
完毕

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:22:10.510

该线程看起来很旧，但无论如何发布，可能会对某人有所帮助。跨平台方法：

[http://ptrthomas.wordpress.com/2009/01/24/how-to-start-and-stop-jetty-revisited/](http://ptrthomas.wordpress.com/2009/01/24/how-to-start-and-stop-jetty-revisited/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:39:42.440

Did you try JFGI? Setting up Ant task that could do the work for you?

This blog post details how to setup targets that can start and stop jetty for you. You could easily cobble together another target called 'jetty-restart' which depends on 'jetty-stop' and then calls 'jetty-start'.

[http://ptrthomas.wordpress.com/2006/10/10/how-to-start-and-stop-jetty-from-ant/](http://ptrthomas.wordpress.com/2006/10/10/how-to-start-and-stop-jetty-from-ant/)

# c++ - 为什么使用 static_cast (x) 而不是 (int)x？

> ID：103512
> 
> 赞同：750
> 
> 时间：2008-09-19T16:33:58.100
> 
> 标签：c++, casting, static-cast

我听说`static_cast`函数应该优先于 C 风格或简单的函数风格转换。这是真的？为什么？

* * *

## 回答 #1

> 赞同：693
> 
> 时间：2008-09-19T17:23:59.680

主要原因是经典的 C 类型转换不区分我们所说`static_cast<>()`的 , `reinterpret_cast<>()`,`const_cast<>()`和`dynamic_cast<>()`。这四件事是完全不同的。

A`static_cast<>()`通常是安全的。语言中有一个有效的转换，或者一个适当的构造函数使它成为可能。唯一有点冒险的时候是当你放弃继承的类时；您必须通过语言外部的方式（如对象中的标志）确保该对象实际上是您声称它的后代。`dynamic_cast<>()`只要检查结果（指针）或考虑可能的异常（参考），A就是安全的。

另一方面，A `reinterpret_cast<>()`（或 a ）总是危险的。`const_cast<>()`你告诉编译器：“相信我：我知道这看起来不像 a `foo`（这看起来好像它不是可变的），但它是”。

第一个问题是，如果不查看大量分散的代码并了解所有规则，几乎不可能判断出哪个会出现在 C 风格的转换中。

让我们假设这些：

```
class CDerivedClass : public CMyBase {...};
class CMyOtherStuff {...} ;

CMyBase  *pSomething; // filled somewhere 
```

现在，这两个编译方式相同：

```
CDerivedClass *pMyObject;
pMyObject = static_cast<CDerivedClass*>(pSomething); // Safe; as long as we checked

pMyObject = (CDerivedClass*)(pSomething); // Same as static_cast<>
                                     // Safe; as long as we checked
                                     // but harder to read 
```

但是，让我们看看这个几乎相同的代码：

```
CMyOtherStuff *pOther;
pOther = static_cast<CMyOtherStuff*>(pSomething); // Compiler error: Can't convert

pOther = (CMyOtherStuff*)(pSomething);            // No compiler error.
                                                  // Same as reinterpret_cast<>
                                                  // and it's wrong!!! 
```

如您所见，如果不了解所涉及的所有类，就很难区分这两种情况。

第二个问题是 C 风格的演员阵容太难定位了。在复杂的表达式中，很难看到 C 风格的强制转换。如果没有成熟的 C++ 编译器前端，几乎不可能编写需要定位 C 风格转换的自动化工具（例如搜索工具）。另一方面，很容易搜索“static_cast<”或“reinterpret_cast<”。

```
pOther = reinterpret_cast<CMyOtherStuff*>(pSomething);
      // No compiler error.
      // but the presence of a reinterpret_cast<> is 
      // like a Siren with Red Flashing Lights in your code.
      // The mere typing of it should cause you to feel VERY uncomfortable. 
```

这意味着，不仅 C 风格的强制转换更危险，而且很难找到它们以确保它们是正确的。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2008-09-19T16:59:17.463

一个实用提示：如果您打算整理项目，可以在源代码中轻松搜索 static_cast 关键字。

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2014-10-09T02:12:44.107

> **简而言之**：
> 
> 1.  `static_cast<>()`为您提供编译时检查能力，C-Style cast 没有。
> 2.  `static_cast<>()`可以在 C++ 源代码中的任何位置轻松发现；相比之下，C_Style 演员更难发现。
> 3.  使用 C++ 强制转换可以更好地传达意图。
> 
> **更多解释**：
> 
> 静态转换执行**兼容类型**之间的转换。它类似于 C 风格的演员表，但更具限制性。例如，C 风格的转换将允许一个整数指针指向一个字符。
> 
> ```
> char c = 10;       // 1 byte
> int *p = (int*)&c; // 4 bytes 
> ```
> 
> 由于这会导致 4 字节指针指向已分配内存的 1 字节，因此写入该指针将导致运行时错误或将覆盖一些相邻的内存。
> 
> ```
> *p = 5; // run-time error: stack corruption 
> ```
> 
> 与 C 风格的转换相比，静态转换将允许编译器检查指针和指针数据类型是否兼容，这允许程序员在编译期间捕获这种不正确的指针分配。
> 
> ```
> int *q = static_cast<int*>(&c); // compile-time error 
> ```

阅读更多内容： static_cast<> 和 C 风格转换 以及[常规转换与 static_cast 与 dynamic_cast](https://stackoverflow.com/questions/28002/regular-cast-vs-static-cast-vs-dynamic-cast/18414172#18414172)
[有什么区别](https://stackoverflow.com/a/18414126/2736559)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-09-19T17:24:30.053

问题不仅仅是使用 wither static_cast 或 C 风格转换，因为在使用 C 风格转换时会发生不同的事情。C++ 强制转换运算符旨在使这些操作更加明确。

从表面上看，static_cast 和 C 风格的转换看起来是一样的，例如，当将一个值转换为另一个值时：

```
int i;
double d = (double)i;                  //C-style cast
double d2 = static_cast<double>( i );  //C++ cast 
```

这两个都将整数值转换为双精度值。然而，当使用指针时，事情变得更加复杂。一些例子：

```
class A {};
class B : public A {};

A* a = new B;
B* b = (B*)a;                                  //(1) what is this supposed to do?

char* c = (char*)new int( 5 );                 //(2) that weird?
char* c1 = static_cast<char*>( new int( 5 ) ); //(3) compile time error 
```

在这个例子中 (1) 可能没问题，因为 A 指向的对象实际上是 B 的一个实例。但是如果你在代码中不知道 a 实际指向的那个点怎么办？(2) 可能完全合法（您只想查看整数的一个字节），但也可能是错误，在这种情况下，错误会很好，例如 (3)。C++ 强制转换运算符旨在通过在可能的情况下提供编译时或运行时错误来暴露代码中的这些问题。

因此，对于严格的“值转换”，您可以使用 static_cast。如果您想要指针的运行时多态转换，请使用 dynamic_cast。如果你真的想忘记类型，你可以使用 reintrepret_cast。并且只是将 const 扔出窗外，有 const_cast。

他们只是让代码更明确，这样看起来你知道自己在做什么。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2008-09-19T16:46:57.133

`static_cast`意味着你不能意外地`const_cast`or `reinterpret_cast`，这是一件好事。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-19T17:39:23.887

1.  允许使用 grep 或类似工具在您的代码中轻松找到强制转换。
2.  明确说明您正在执行哪种类型的转换，并让编译器帮助执行它。如果你只想抛弃 const-ness，那么你可以使用 const_cast，它不允许你做其他类型的转换。
3.  强制转换本质上是丑陋的——作为程序员，您正在推翻编译器通常如何处理您的代码。你是在对编译器说：“我比你更清楚。” 在这种情况下，执行强制转换应该是一件适度痛苦的事情，并且它们应该在您的代码中突出显示，因为它们可能是问题的根源。

请参阅[有效的 C++](https://rads.stackoverflow.com/amzn/click/com/0321334876)简介

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-19T16:47:32.250

这是关于你想强加多少类型安全。

当您编写时`(bar) foo`（相当于`reinterpret_cast<bar> foo`您没有提供类型转换运算符），您是在告诉编译器忽略类型安全，并按照它的指示去做。

当您编写时，`static_cast<bar> foo`您要求编译器至少检查类型转换是否有意义，并且对于整数类型，插入一些转换代码。

* * *

**编辑 2014-02-26**

我在 5 多年前写了这个答案，但我弄错了。（见评论。）但它仍然得到了赞成！

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-19T17:29:08.420

在代码块中很容易错过 C 风格转换。C++ 风格转换不仅是更好的实践；它们提供了更大程度的灵活性。

reinterpret_cast 允许整数到指针类型的转换，但是如果误用可能是不安全的。

static_cast 为数字类型提供了良好的转换，例如从枚举到整数或整数到浮点数或您确信类型的任何数据类型。它不执行任何运行时检查。

另一方面，dynamic_cast 将执行这些检查，标记任何不明确的分配或转换。它仅适用于指针和引用并产生开销。

还有其他几个，但这些是您会遇到的主要内容。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-19T16:37:03.943

除了操作指向类的指针之外，static_cast 还可用于执行类中显式定义的转换，以及执行基本类型之间的标准转换：

```
double d = 3.14159265;
int    i = static_cast<int>(d); 
```

# .net - 在 WinForms 中为上下文菜单动态选择菜单项的正确方法是什么？

> ID：103514
> 
> 赞同：3
> 
> 时间：2008-09-19T16:34:21.080
> 
> 标签：.net, winforms, menu

我正在尝试为“链接”到主菜单项的控件创建上下文菜单。有两个始终存在的固定菜单项和可能需要在菜单上的任意数量的附加菜单项。

我尝试通过保持对固定菜单项的类级引用和动态菜单项列表来解决问题。我`Opening`通过清除当前项目列表来处理两个菜单的事件，然后将适当的项目添加到菜单中。这适用于主菜单，但上下文菜单的行为很奇怪。

主要问题似乎是，在`Opening`提出时，菜单已经决定要显示哪些项目。这个表格展示了：

```
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public class DemoForm : Form
    {
        private List _items;

        public DemoForm()
        {
            var contextMenu = new ContextMenuStrip();
            contextMenu.Opening += contextMenu_Opening;

            _items = new List();
            _items.Add(new ToolStripMenuItem("item 1"));
            _items.Add(new ToolStripMenuItem("item 2"));

            this.ContextMenuStrip = contextMenu;
        }

        void contextMenu_Opening(object sender, CancelEventArgs e)
        {
            var menu = sender as ContextMenuStrip;

            if (menu != null)
            {
                foreach (var item in _items)
                {
                    menu.Items.Add(item);
                }
            }
        }
    }
} 
```

当您第一次右键单击表单时，没有显示任何内容。第二次，菜单按预期显示。是否有另一个事件引发了我可以更新项目的地方？动态选择菜单项是一种不好的做法吗？

（*注意：这是我开始为想要这种功能的人制作的示例，我很好奇它有多难，所以我无法提供有关为什么这样做的详细信息。这个人想要“链接”一个主菜单项到上下文菜单，并且由于菜单项只能是单个菜单的子项，这似乎是一种合理的方法。欢迎任何替代方法的建议。*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:38:24.267

您可以在控件的 MouseDown 事件期间计算出项目。检查它是否也是鼠标右键。

# c# - Excel 加载项访问冲突

> ID：103516
> 
> 赞同：0
> 
> 时间：2008-09-19T16:35:01.297
> 
> 标签：c#, interop, .net-2.0, add-in

使用 c#、VS2005 和 .NET 2.0。（XP 32 位）这是一个 Winforms 应用程序，由 VBA 插件 (.xla) 通过互操作库调用。这个应用程序已经存在了一段时间，并且在我的开发机器以外的任何地方编译和执行程序集时工作正常。在开发时，它会严重崩溃（在调试器中并只是运行对象），并出现“EXCEL.EXE 中 0x 处的未处理异常...：0x...违反读取位置 0x...

但这是奇怪的部分：

我界面中的第一个方法工作正常。所有其他方法都如上所述崩溃。这是代码的近似值：

```
[Guid("123Fooetc...")]
    [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    public interface IBar
    {
        [DispId(1)]
         void ThisOneWorksFine(Excel.Workbook ActiveWorkBook);

         [DispId(2)]
         string Crash1(Excel.Workbook ActiveWorkBook);

         [DispId(3)]
         int Crash2(Excel.Workbook activeWorkBook, Excel.Range target, string someStr);
     }

    [Guid("345Fooetc..")]
    [ClassInterface(ClassInterfaceType.None)]
    [ProgId("MyNameSpace.MyClass")]    
    public class MyClass : IBar
    {
        public void ThisOneWorksFine(Excel.Workbook ActiveWorkBook)
        {...}

         string Crash1(Excel.Workbook ActiveWorkBook);
        {...}

         int Crash2(Excel.Workbook activeWorkBook, Excel.Range target, string someStr);
        {...}

    } 
```

这似乎是某种环境的东西。注册表混乱？可能是代码错误，但在其他地方可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T17:26:30.643

过去，我在使用 Office 2003 的情况下遇到过问题。一些有帮助的事情：

*   安装 Office 2003 Service Pack 2 停止了关闭 Excel 时发生的一些崩溃。

*   安装 Office 2003 Service Pack 3 修复了在 VSTO2005 应用程序中使用 XP 样式的错误（此处不是您的情况）

*   定期运行 Excel VBA CodeCleaner [http://www.appspro.com/Utilities/CodeCleaner.htm](http://www.appspro.com/Utilities/CodeCleaner.htm)有助于防止随机崩溃。

*   从多个线程访问 Excel 对象会很狡猾，所以我希望你不要那样做。

如果您有可能也可以尝试使用 Microsoft PSS 开箱。如果您能够重现问题，它们非常好。而且在大多数情况下，这种事情是一个错误，所以你不会为此付费:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:38:35.920

你的开发机是Win64的吗？如果您将构建平台设置为 x86，我会遇到应用程序的 win64 构建问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:41:08.443

您的开发机器运行的 Office 版本是否与其他机器不同？我知道 PIA 不同。因此，例如，如果您在 Office 2003 上进行开发并在 Office 2007 上进行测试（反之亦然），您就会遇到问题。

# java - Junit 输出和 OutOfMemoryError

> ID：103519
> 
> 赞同：5
> 
> 时间：2008-09-19T16:35:32.620
> 
> 标签：java, junit

我正在我的应用程序上运行一些 JUnit 测试。每个测试都有一个 for 循环调用相应的方法 10000 次。测试的方法会产生大量的日志。JUnit 也会自动收集这些日志作为测试输出。这种情况会导致 OutOfMemoryError，因为 JUnit 保存输出的字符串缓冲区变得太大。我在测试期间不需要这些日志，所以如果有办法告诉 JUnit“不要保留程序输出”就足够了。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T16:39:07.807

您使用的是什么类型的日志记录？有什么方法可以覆盖默认的日志记录行为以忽略所有日志消息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:38:32.287

一些选项：

1.  更改您的日志记录，使其转储到文件而不是标准输出。
2.  用 增加最大堆大小`-Xmx <some number>M`，例如`-Xmx 256M`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:39:13.033

我只会增加可用内存。尝试将 -Xmx256m -Xmx256m 添加到您的虚拟机中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T17:20:51.747

解决方案是覆盖日志记录属性。现在我禁用了日志记录，似乎一切正常（测试仍在运行）。如果它有效，我将配置一种记录到文件的方式。谢谢大家（并祝贺 Jeff 和朋友们的这个网站）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T22:52:29.827

我看到一个答案已经被接受，但如果我把它输入并更快地测试，我会提交以下内容：

如果“记录”是指 System.out.println() 或 System.err.println()，并且您确定您的测试确实不需要日志，那么您可以以编程方式重定向 stdout 和 stderr。

```
// Save the original stdout and stderr
PrintStream psOut = System.out;
PrintStream psErr = System.err;
PrintStream psDevNull = null;
try
{
    // Send stdout and stderr to /dev/null
    psDevNull = new PrintStream(new ByteArrayOutputStream());
    System.setOut(psDevNull);
    System.setErr(psDevNull);
    // run tests in loop
    for (...)
    {
    }
}
finally
{
    // Restore stdout and stderr
    System.setOut(psOut);
    System.setErr(psErr);
    if (psDevNull != null)
    {
        psDevNull.close();
        psDevNull = null;
    }
} 
```

这样，您的测试输出将被禁用，但 JUnit 的其他输出不会被禁用，就像您在命令行上使用重定向时一样：

```
ant test &> /dev/null 
```

命令行重定向导致所有 Ant/JUnit 的输出都被重定向，而不仅仅是来自您正在测试的类的输出，所以这可能不是您想要的。程序化重定向仅导致程序中对 System.out 和 System.err 的打印/写入被重定向，并且您仍将获得来自 Ant 和 JUnit 的输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T23:21:19.717

设置`outputtoformatters="no"`解决了我所有的内存问题（在 Ant 1.7.1 中，它阻止了测试生成的输出被发送到测试格式化程序）。

# file - The essential steps in verifying a file upload

> ID：103522
> 
> 赞同：2
> 
> 时间：2008-09-19T16:36:07.190
> 
> 标签：file, file-upload

What would you say are the essential steps in verifying a file upload?

I'd tend to check the MIME type, give it a new (random) name, make sure its got an allowed file extension, and then I'd check the contents of the file. How do you go about it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T17:23:13.767

检查（按此顺序）：文件 MIME 类型（并注意某些浏览器存在 MIME 类型检测问题...）；文件路径存在；不存在具有相同名称的文件的先前版本，否则，请修改它；文件不是太大；成功后，在服务器上运行病毒检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:41:27.163

Check the file type, check the file size, the image dimension.

These are the 3 I always check to be sure to have good result.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:14:51.590

取决于预期的文件内容...对文件运行病毒扫描可能是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:41:58.923

例如，如果您收到个人资料照片的 gif 文件，则应检查 mime 类型是否为 gif。
这样您就可以避免上传坏文件。
[这里](http://www.jellyandcustard.com/2006/01/19/php-mime-types-and-fileinfo/)有一个使用 php 的示例。

# ajax - Is there a list of AJAX JSF Libraries available?

> ID：103523
> 
> 赞同：2
> 
> 时间：2008-09-19T16:36:11.793
> 
> 标签：ajax, jsf, user-interface, components, packages

I'm looking for an alternative to [www.jsfmatrix.net](http://www.jsfmatrix.net/) to get a better idea of what JSF libraries are out there and to avoid having to write my own grid/table components. Or are these 27 the best the world has to offer (really only 3 are worth their salt.)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T19:04:56.210

你看过 RichFaces 吗？它带有很多非常酷的丰富的 UI 内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T20:42:48.380

I'll second RichFaces, but also point out IceFaces (which isn't free, but is also very nice).

# c# - 在打开 SqlConnection 之前处理不同的 ConnectionStates

> ID：103532
> 
> 赞同：6
> 
> 时间：2008-09-19T16:38:07.093
> 
> 标签：c#, .net, sql-server, database

如果您需要在发出查询之前打开一个SqlConnection，您可以简单地以相同的方式处理所有非打开的连接状态吗？例如：

```
 if (connection.State != ConnectionState.Open)
    {
        connection.Open();
    } 
```

我在某处读到 ConnectionState.Broken 连接需要在重新打开之前关闭。有人对此有经验吗？谢谢-

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T17:28:59.980

[http://msdn.microsoft.com/en-us/library/system.data.connectionstate.aspx](http://msdn.microsoft.com/en-us/library/system.data.connectionstate.aspx)

断开连接状态确实需要关闭并重新打开才能继续使用。

编辑：不幸的是，关闭关闭的连接也会停止。在对未知连接进行操作之前，您需要测试 ConnectionState。也许一个简短的 switch 语句可以解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T17:19:52.140

这不是直接回答您的问题，但最佳做法是为每次访问数据库打开和关闭连接。ADO.NET 连接池可确保其执行良好。在服务器应用程序（例如 ASP.NET）中执行此操作尤其重要，但即使在直接访问数据库的 WinForms 应用程序中我也会这样做。

例子：

```
using(SqlConnection connection = new SqlConnection(...))
{
   connection.Open();
   // ... do your stuff here

}  // Connection is disposed and closed here, even if an exception is thrown 
```

通过这种方式，您在打开连接时永远不需要检查连接状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-21T19:50:42.633

你可以用同样的方式处理它。在使用 IE9 时，我遇到了许多连接状态 == 中断。在这方面，IE9 存在根本性的问题，因为在对数据库表进行 5 或 6 次更新后，没有其他浏览器出现连接状态断开的问题。所以我使用对象上下文。所以基本上只需关闭它并重新打开它。

在业务逻辑层进行所有读取和更新之前，我有这段代码：

```
if (context.Connection.State == System.Data.ConnectionState.Broken)
{
    context.Connection.Close();
    context.Connection.Open();
} 
```

# iphone - 如何在 iPhone 上的 OpenGLES 中创建缩放效果？

> ID：103537
> 
> 赞同：1
> 
> 时间：2008-09-19T16:38:34.547
> 
> 标签：iphone, objective-c, opengl-es

我有一个 OpenGL ES 游戏，我正在一起破解。其中一部分涉及查看一个大的“类似地图”的区域，然后双击一个部分以“放大”它。您将如何使用 OpenGL ES 来提供这种效果（假设它可能需要放大地图的不同部分）。

我听说过 glScale 和 glOrtho，但我不清楚它们实际上是如何工作的，因为整个 openGL 世界对我来说都是非常新的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-20T16:19:52.603

您描述的二维缩放可能会更好地使用核心动画来实现。NSView（及其 NDA'd iPhone 对应物）在您更改其框架时提供隐式动画。在这种情况下，您需要做的就是将框架的 origin.x 和 origin.y 以及 size.width 和 size.height 设置为这样的值，以使视图大于屏幕。如果您这样做并将其包装在适当的调用中以启动和提交动画，您将免费获得缩放动画。Core Animation 在幕后使用 OpenGL 来制作动画。

但是，如果您觉得必须在 OpenGL 中执行此操作，我可以建议我在[http://www.sunsetlakesoftware.com/2008/08/05/lessons-molecules-opengl-es](http://www.sunsetlakesoftware.com/2008/08/05/lessons-molecules-opengl-es)上写的一些文章吗？我是[Molecules](http://www.sunsetlakesoftware.com/molecules)的作者，这是一个免费的 iPhone 3-D 分子可视化工具，在我开始这个项目之前，我对 OpenGL ES 一无所知。3 周后，它在 App Store 中发布。

OpenGL 调用非常简单，围绕它们的数学运算会让您头疼。放大对象实际上非常简单，可以通过移动相机或实际缩放对象来完成。对于分子，我使用 glScalef(x,y,z) 函数缩放对象，其中 x、y 和 z 是您希望应用于模型对象的缩放因子。我逐步进行缩放。也就是说，我不会在每个渲染帧的开头重置转换矩阵（使用 glLoadIdentity()），而是根据用户输入稍微缩放它。如果用户将手指分开 5%，我将比例增加 5%。

同样，我建议 Core Animation 用于您描述的 2-D 缩放，但在 OpenGL ES 中实现相同的结果并不难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:45:37.107

恕我直言，答案是花几天时间学习 OpenGL 的基础知识，网上有比这里更好的地方。

# svn - Locking File using Apache Server and TortoiseSVN

> ID：103548
> 
> 赞同：0
> 
> 时间：2008-09-19T16:39:29.460
> 
> 标签：svn, apache, tortoisesvn, locking

I am seeting up Apache server with TortoiseSVN for local source code repository. Currently on trial purpose I am setting only two users. Is it possible for administrator to set up some thing so that file get compulsory locked once its checkout (copy to working directory) by some one.

Abhijit Dhopate

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T16:56:25.613

您可能希望在 subversion 上执行此操作的主要原因是难以或不可能“合并”的二进制文件（即图像等）。在这些情况下，每个用户都可以请求锁定文件。还有一个 svn 属性（needs-lock）可以应用于文件，使它们在签出时为只读，在锁定时为读写，以便您记得在编辑之前请求锁定。

请参阅svn 书中[关于锁定的章节。](http://svnbook.red-bean.com/en/1.5/svn.advanced.locking.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:43:33.133

这不会破坏像 SubVersion 这样的并发版本控制系统的目的之一吗？通常，您会检出一个文件块，但服务器不知道是否有人在编辑这些文件。如果出现冲突，为什么不允许其他用户访问这些文件并处理结果？

# c# - 如何以正确的字体呈现 unicode 字符？(C#/WinForms)

> ID：103556
> 
> 赞同：6
> 
> 时间：2008-09-19T16:40:11.347
> 
> 标签：c#, winforms, unicode, rendering

我的应用程序正确处理不同类型的字符集，但仅限于内部 - 在标准 WinForms 标签和文本框中显示文本时，中文字符似乎存在问题。

问题似乎是使用的字体（Tahoma），因为当我复制和粘贴文本或在调试器中查看它时，它会正确显示。此外，当我将 MS Mincho 设置为要使用的字体时，屏幕上的字符看起来还不错。

当然，我不想在整个应用程序中使用 MS Mincho。我是否必须根据显示的字符切换字体，还是我错过了更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-25T19:58:15.640

[UniScribe](http://en.wikipedia.org/wiki/Uniscribe)是在 Windows 2000 中引入的，它应该透明地处理这个问题，这意味着它将自动为您选择的字体中不存在的字符使用不同的字体（例如 Mincho）。这就是为什么它在调试器中看起来是正确的，即使在调试器中使用的字体不包含中文字符。也许您正在做一些禁用 UniScribe 的事情，或者以其他方式存在问题。也许如果您可以粘贴一些代码，则更容易识别问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T16:44:31.820

所有字体都没有可以用 unicode 表示的所有字形的数据。您必须找到具有所需子集的合适字体。

编辑：澄清一下，*有些*字体涵盖了整个 unicode 范围，但您现在使用的字体不是其中之一。

# exception - Rhino 模拟命令回复，抛出异常问题

> ID：103557
> 
> 赞同：0
> 
> 时间：2008-09-19T16:40:19.520
> 
> 标签：exception, mocking, rhino-mocks

如果我的代码中有异常，我正在尝试实现一些重试逻辑。我已经编写了代码，现在我正在尝试让 Rhino Mocks 来模拟场景。代码的主要内容如下：

```
class Program
    {
        static void Main(string[] args)
        {
            MockRepository repo = new MockRepository();
            IA provider = repo.CreateMock<IA>();

            using (repo.Record()) 
            {
                SetupResult.For(provider.Execute(23))
                           .IgnoreArguments()
                           .Throw(new ApplicationException("Dummy exception"));

                SetupResult.For(provider.Execute(23))
                           .IgnoreArguments()
                           .Return("result");
            }

            repo.ReplayAll();

            B retryLogic = new B { Provider = provider };
            retryLogic.RetryTestFunction();
            repo.VerifyAll();
        }
    }

    public interface IA
    {
        string Execute(int val);
    }

    public class B
    {
        public IA Provider { get; set; }

        public void RetryTestFunction()
        {
            string result = null;
            //simplified retry logic
            try
            {
                result = Provider.Execute(23);
            }
            catch (Exception e)
            {
                result = Provider.Execute(23);
            }
        }
    } 
```

似乎发生的情况是每次都抛出异常，而不仅仅是一次。我应该将设置更改为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:12:05.337

您需要使用 Expect.Call 而不是 SetupResult：

```
 using (repo.Record())
    {
        Expect.Call(provider.Execute(23))
                   .IgnoreArguments()
                   .Throw(new ApplicationException("Dummy exception"));

        Expect.Call(provider.Execute(23))
                   .IgnoreArguments()
                   .Return("result");
    } 
```

Rhino.Mocks wiki 说，

> [使用 SetupResult.For() 完全绕过了 Rhino Mocks 中的期望模型](http://www.ayende.com/Wiki/Default.aspx?Page=Rhino+Mocks+Setup+Result&AspxAutoDetectCookieSupport=1)

# asp.net - Invalid postback or callback argument

> ID：103560
> 
> 赞同：4
> 
> 时间：2008-09-19T16:40:42.717
> 
> 标签：asp.net, exception

I have an ASP.net application that works fine in the development environment but in the production environment throws the following exception when clicking a link that performs a postback. Any ideas?

> Invalid postback or callback argument. Event validation is enabled using in configuration or <%@ Page EnableEventValidation="true" %> in a page. For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them. If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

**Edit:** This seems to only be happening when viewed with IE6 but not with IE7, any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-24T09:04:41.427

问题描述：这是很多 ASP.NET 初学者面临、发帖和询问的常见问题之一。通常，他们会发布如下错误消息并寻求解决方案，而不会分享他们正在尝试做的事情。

[ArgumentException：回发或回调参数无效。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。]

虽然，错误堆栈跟踪本身建议通过关闭事件验证来快速解决，但它不是推荐的解决方案，因为它会打开一个安全漏洞。知道它发生的原因以及如何解决/处理该根本问题总是很好的。

评估：进行事件验证以验证事件的起源是否是相关的呈现控件（而不是一些跨站点脚本左右）。由于控件在渲染期间注册其事件，因此可以在回发或回调期间验证事件（通过 __doPostBack 的参数）。这降低了未经授权或恶意回发请求和回调的风险。

参考：MSDN：Page.EnableEventValidation 属性

基于上述情况，我在讨论中遇到或听到的可能引发问题的场景是： 案例 #1：如果我们在请求数据中有尖括号，看起来某个脚本标签正在传递给服务器。

可能的解决方案：HTML 在提交表单之前借助 JavaScript 对尖括号进行编码，即替换“<” 用“<” 和“>”与“>”</p>

```
function HTMLEncodeAngularBrackets(someString)
{
var modifiedString = someString.replace("<","&lt;");
modifiedString = modifiedString.replace(">","&gt;");
return modifiedString;
} 
```

案例#2：如果我们编写的客户端脚本在运行时更改客户端中的控件，我们可能会遇到一个悬空事件。一个示例可能是具有嵌入式控件，其中内部控件注册回发但由于在外部控件上执行的操作而在运行时隐藏。这是我在 Carlo 写的 MSDN 博客上读到的，在寻找相同的问题时，因为有多个表单标签。

可能的解决方案：在页面的 Render 方法中手动注册事件验证控件。

```
protected override void Render(HtmlTextWriter writer)
{
ClientScript.RegisterForEventValidation(myButton.UniqueID.ToString());
base.Render(writer);
} 
```

如前所述，报告的另一种常见情况（看起来属于同一类别）是构建一个页面，其中一个表单标记嵌入在服务器上运行的另一个表单标记中。删除其中一个可以更正流程并解决问题。

案例#3：如果我们在每次回发时在运行时重新定义/实例化控件或命令，则可能会遇到相应/相关的事件。一个简单的示例可能是在每个页面加载（包括回发）上重新绑定数据网格。因为，在重新绑定网格中的所有控件时，都会有一个新的 ID，因此在由 datagrid 控件触发的事件期间，回发时控件 ID 会发生更改，因此事件可能无法连接到正确的控件，从而引发问题。

可能的解决方案：这可以通过确保不会在每次回发时重新创建控件来简单地解决（在此处重新绑定）。使用 Page 属性 IsPostback 可以轻松处理它。如果您想在每个回发上创建一个控件，那么有必要确保 ID 没有更改。

```
protected void Page_Load(object sender, EventArgs e)
{
if(!Page.IsPostback)
{
// Create controls
// Bind Grid
}
} 
```

结论：如前所述，一个简单/直接的解决方案可以在 Page 指令或 Web.config 文件中添加 enableEventValidation=”false”，但不推荐。根据实施和原因，找到根本原因并相应地应用解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:10:34.487

如果您发布的内容可能是恶意的，就会发生这种情况；例如其中包含 html，但在回发之前未编码的文本框。如果您允许提交 html 或脚本，则需要对其进行编码，以便将 < 等字符作为 & lt; 传递。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:45:40.037

当回发发生时，页面上的数据/控件似乎发生了变化。如果您在页面指令中关闭事件验证会发生什么。

```
<%@ Page ... EnableEventValidation = "false" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T19:27:50.707

`<form>`只有当我的页面中有嵌套标签时，我才会得到这个。IE6 将查看嵌套的表单标签并尝试在*这些*表单以及主 ASP.NET 表单中发布值，从而导致错误。其他浏览器不会发布嵌套表单（因为它是无效的 HTML）并且不会收到错误消息。

您当然可以通过执行 来解决此`EnableEventValidation = "false"`问题，但这可能意味着您发布的值和视图状态存在问题。最好先清除嵌套`<form>`标签。

还有其他可能出现这种情况的地方，例如表单字段中的 HTML 式值，但我认为这些错误消息更具体。在抛出此问题的通用回发中，我只需检查呈现的页面是否有额外的`<form>`标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-09T19:48:01.487

当我手动输入文本时，我有一个工作正常的 ListBox，但是当我根据 SQL 查询输入数据时，列表中的最后一项会引发此异常。我搜索了所有的问答，没有一个符合我的问题。

就我而言，问题是 SQL 数据中有一个不可打印的字符 (\r)。我猜测服务器基于不可打印字符的存在创建了一个哈希码，但它已从实际显示在 ListBox 中的字符串中删除，因此第二个哈希与第一个不匹配。在将字符串放入 ListBox 之前清理字符串并删除不可打印的字符解决了我的问题。

这可能是一个超级边缘案例，但我想添加它只是为了完成（并希望帮助其他人不要花 2 天时间发疯）。

# visual-studio - FxCop/StyleCop 是否可以仅限于使用 Visual Studio 分析选定的方法？

> ID：103561
> 
> 赞同：4
> 
> 时间：2008-09-19T16:40:53.763
> 
> 标签：visual-studio, coding-style, fxcop, stylecop

我正在组建一个维护团队，并希望引入 FxCop 和 StyleCop 等工具来帮助改进代码并向开发人员介绍更好的编程技术和标准。由于我们正在维护代码而不是进行重大改进，因此在进行更改时我们可能一次只处理几个方法/例程。

是否可以将 FxCop/StyleCop 定位到 Visual Studio 中的特定代码区域，以避免在分析整个类或项目时被引发的所有问题所淹没？如果有可能，你会怎么做？

谢谢，马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T18:37:23.003

我使用 FxCopCmd.exe (FxCop 1.36) 作为具有各种命令行参数的外部工具，包括这个：

```
/types:<type list>  [Short form: /t:<type list>]
Analyze only these types and members. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T18:45:32.580

FxCop 可以使用命令行或 GUI 来定位特定类型。StyleCop 不提供这样的机制。

但是，对于它们两者，您都可以针对特定规则而不是类型，这可能会更好地将“噪音”的数量减少到更易于管理的块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-25T12:03:26.093

尝试本文中的方法

[http://blogs.msdn.com/sourceanalysis/archive/2008/11/11/introducing-stylecop-on-legacy-projects.aspx](http://blogs.msdn.com/sourceanalysis/archive/2008/11/11/introducing-stylecop-on-legacy-projects.aspx)

您可以通过添加属性以包含或排除 .csproj 中的每个文件，从而从 StyleCop 的眼睛中删除单个文件

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-19T18:27:17.000

我猜它不能（似乎是一个过于具体的需求）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-12T20:57:10.113

为 FXCop 创建新规则是可能的，但“高级”。将 FXCop 配置为仅使用可用规则中的某些规则是微不足道的。

# java - 在 Java 中使用 instanceof 对性能的影响

> ID：103564
> 
> 赞同：338
> 
> 时间：2008-09-19T16:41:12.310
> 
> 标签：java, performance, instanceof

我正在开发一个应用程序，一种设计方法涉及对`instanceof`运算符的大量使用。虽然我知道 OO 设计通常会尽量避免使用`instanceof`，但这是另一回事，这个问题完全与性能有关。我想知道是否有任何性能影响？是一样快`==`吗？

例如，我有一个包含 10 个子类的基类。在接受基类的单个函数中，我会检查该类是否是子类的实例并执行一些例程。

我想到的解决它的其他方法之一是改用“type id”整数原语，并使用位掩码来表示子类的类别，然后将子类“type id”与一个位掩码进行比较表示类别的常量掩码。

JVM是否`instanceof`以某种方式优化了比这更快的速度？我想坚持使用 Java，但应用程序的性能至关重要。如果以前曾经走过这条路的人可以提供一些建议，那就太酷了。我是不是吹毛求疵，还是专注于优化错误的事情？

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2014-10-22T18:54:40.517

# 方法

我编写[了一个基准程序](https://github.com/michaeldorner/instanceofBenchmark)来评估不同的实现：

1.  `instanceof`实施（作为参考）
2.  `@Override`通过抽象类和测试方法面向对象
3.  使用自己的类型实现
4.  `getClass() == _.class`执行

我使用[jmh](http://openjdk.java.net/projects/code-tools/jmh/)运行了 100 次预热调用、1000 次测量迭代和 10 个分叉的基准测试。因此，每个选项都测量了 10 000 次，这需要 12:18:57 在我的 MacBook Pro 上运行 macOS 10.12.4 和 Java 1.8 的整个基准测试。基准测量每个选项的平均时间。有关更多详细信息，请参阅[我在 GitHub 上的实现](https://github.com/michaeldorner/instanceofBenchmark/blob/master/src/main/java/de/michaeldorner/MyBenchmark.java)。

为了完整起见：[这个答案和我的基准有一个以前的版本](https://stackoverflow.com/revisions/26514984/10)。

# 结果

```
| 操作 | 每次操作的运行时间（以纳秒为单位）| 相对于 instanceof |
|------------|------------------------------------ --|------------------------|
| 实例 | 39,598 ± 0,022 ns/操作 | 100,00 % |
| 获取类 | 39,687 ± 0,021 ns/操作 | 100,22 % |
| 类型 | 46,295 ± 0,026 纳秒/操作 | 116,91 % |
| 面向对象 | 48,078 ± 0,026 ns/操作 | 121,42 % |

```

# tl;博士

在 Java 1.8`instanceof`中是最快的方法，虽然`getClass()`非常接近。

* * *

## 回答 #2

> 赞同：288
> 
> 时间：2008-09-19T16:45:45.170

现代 JVM/JIT 编译器已经消除了大多数传统上“慢”操作的性能损失，包括 instanceof、异常处理、反射等。

正如 Donald Knuth 所写，“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。” instanceof 的性能可能不会成为问题，所以在确定问题所在之前，不要浪费时间想出奇特的解决方法。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2008-12-29T12:13:26.450

我只是做了一个简单的测试，看看 instanceOf 的性能如何与对只有一个字母的字符串对象的简单 s.equals() 调用进行比较。

在 10.000.000 循环中，instanceOf 给了我 63-96ms，而字符串 equals 给了我 106-230ms

我使用了java jvm 6。

因此，在我的简单测试中，执行 instanceOf 而不是一个字符串比较更快。

使用整数的 .equals() 而不是字符串给了我相同的结果，只有当我使用 == i 比 instanceOf 快 20 毫秒时（在 10.000.000 循环中）

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-11-02T03:35:56.720

将确定性能影响的项目是：

1.  instanceof 运算符可以返回 true 的可能类的数量
2.  您的数据分布 - 大多数 instanceof 操作是否在第一次或第二次尝试中解决？您需要将最有可能返回真正的操作放在首位。
3.  部署环境。在 Sun Solaris VM 上运行与 Sun 的 Windows JVM 有很大不同。默认情况下，Solaris 将在“服务器”模式下运行，而 Windows 将在客户端模式下运行。Solaris 上的 JIT 优化将使所有方法的访问权限都相同。

我[为四种不同的调度方法](http://www.theeggeadventure.com/wikimedia/index.php/InstanceOf_Performance)创建了一个微基准。来自 Solaris 的结果如下，数字越小越快：

```
InstanceOf 3156
class== 2925 
OO 3083 
Id 3067 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-09-19T16:51:00.260

回答您的最后一个问题：除非分析器告诉您，您在 instanceof 中花费了大量时间：是的，您在吹毛求疵。

在考虑优化永远不需要优化的东西之前：以最易读的方式编写算法并运行它。运行它，直到 jit 编译器有机会自己优化它。如果您在这段代码中遇到问题，请使用分析器告诉您，从哪里获得最大收益并对其进行优化。

在高度优化编译器的时候，你对瓶颈的猜测很可能是完全错误的。

并且本着这个答案的真实精神（我完全相信）：一旦 jit 编译器有机会优化它，我绝对不知道 instanceof 和 == 之间的关系。

我忘记了：永远不要测量第一次运行。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2012-03-23T19:06:10.940

我也有同样的问题，但是因为我没有找到与我类似的用例的“性能指标”，所以我做了更多的示例代码。在我的硬件和 Java 6 和 7 上，instanceof 和 switch on 10m 迭代之间的区别是

```
for 10 child classes - instanceof: 1200ms vs switch: 470ms
for 5 child classes  - instanceof:  375ms vs switch: 204ms 
```

因此，instanceof 真的很慢，尤其是在大量的 if-else-if 语句上，但是在实际应用程序中差异可以忽略不计。

```
import java.util.Date;

public class InstanceOfVsEnum {

    public static int c1, c2, c3, c4, c5, c6, c7, c8, c9, cA;

    public static class Handler {
        public enum Type { Type1, Type2, Type3, Type4, Type5, Type6, Type7, Type8, Type9, TypeA }
        protected Handler(Type type) { this.type = type; }
        public final Type type;

        public static void addHandlerInstanceOf(Handler h) {
            if( h instanceof H1) { c1++; }
            else if( h instanceof H2) { c2++; }
            else if( h instanceof H3) { c3++; }
            else if( h instanceof H4) { c4++; }
            else if( h instanceof H5) { c5++; }
            else if( h instanceof H6) { c6++; }
            else if( h instanceof H7) { c7++; }
            else if( h instanceof H8) { c8++; }
            else if( h instanceof H9) { c9++; }
            else if( h instanceof HA) { cA++; }
        }

        public static void addHandlerSwitch(Handler h) {
            switch( h.type ) {
                case Type1: c1++; break;
                case Type2: c2++; break;
                case Type3: c3++; break;
                case Type4: c4++; break;
                case Type5: c5++; break;
                case Type6: c6++; break;
                case Type7: c7++; break;
                case Type8: c8++; break;
                case Type9: c9++; break;
                case TypeA: cA++; break;
            }
        }
    }

    public static class H1 extends Handler { public H1() { super(Type.Type1); } }
    public static class H2 extends Handler { public H2() { super(Type.Type2); } }
    public static class H3 extends Handler { public H3() { super(Type.Type3); } }
    public static class H4 extends Handler { public H4() { super(Type.Type4); } }
    public static class H5 extends Handler { public H5() { super(Type.Type5); } }
    public static class H6 extends Handler { public H6() { super(Type.Type6); } }
    public static class H7 extends Handler { public H7() { super(Type.Type7); } }
    public static class H8 extends Handler { public H8() { super(Type.Type8); } }
    public static class H9 extends Handler { public H9() { super(Type.Type9); } }
    public static class HA extends Handler { public HA() { super(Type.TypeA); } }

    final static int cCycles = 10000000;

    public static void main(String[] args) {
        H1 h1 = new H1();
        H2 h2 = new H2();
        H3 h3 = new H3();
        H4 h4 = new H4();
        H5 h5 = new H5();
        H6 h6 = new H6();
        H7 h7 = new H7();
        H8 h8 = new H8();
        H9 h9 = new H9();
        HA hA = new HA();

        Date dtStart = new Date();
        for( int i = 0; i < cCycles; i++ ) {
            Handler.addHandlerInstanceOf(h1);
            Handler.addHandlerInstanceOf(h2);
            Handler.addHandlerInstanceOf(h3);
            Handler.addHandlerInstanceOf(h4);
            Handler.addHandlerInstanceOf(h5);
            Handler.addHandlerInstanceOf(h6);
            Handler.addHandlerInstanceOf(h7);
            Handler.addHandlerInstanceOf(h8);
            Handler.addHandlerInstanceOf(h9);
            Handler.addHandlerInstanceOf(hA);
        }
        System.out.println("Instance of - " + (new Date().getTime() - dtStart.getTime()));

        dtStart = new Date();
        for( int i = 0; i < cCycles; i++ ) {
            Handler.addHandlerSwitch(h1);
            Handler.addHandlerSwitch(h2);
            Handler.addHandlerSwitch(h3);
            Handler.addHandlerSwitch(h4);
            Handler.addHandlerSwitch(h5);
            Handler.addHandlerSwitch(h6);
            Handler.addHandlerSwitch(h7);
            Handler.addHandlerSwitch(h8);
            Handler.addHandlerSwitch(h9);
            Handler.addHandlerSwitch(hA);
        }
        System.out.println("Switch of - " + (new Date().getTime() - dtStart.getTime()));
    }
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-07-16T10:13:26.027

`instanceof`速度非常快，只需要几条 CPU 指令。

显然，如果一个类`X`没有加载子类（JVM 知道），`instanceof`可以优化为：

```
 x instanceof X    
==>  x.getClass()==X.class  
==>  x.classID == constant_X_ID 
```

主要成本只是阅读！

如果`X`确实加载了子类，则需要更多读取；它们可能位于同一地点，因此额外成本也非常低。

大家好消息！

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-27T18:30:28.367

在大多数现实世界的实现中， instanceof 可能会比简单的 equals 更昂贵（也就是说，真正需要 instanceof 的那些，并且您不能仅仅通过覆盖一个通用方法来解决它，就像每个初学者教科书以及上面的德米安建议）。

这是为什么？因为可能会发生的是你有几个接口，它们提供一些功能（比如说，接口 x、y 和 z），以及一些可能（或不）实现这些接口之一的要操作的对象......但是不直接。比如说，我有：

w 扩展 x

A 实现 w

B 扩展 A

C 扩展 B，实现 y

D 扩展 C，实现 z

假设我正在处理 D 的一个实例，即对象 d。计算 (d instanceof x) 需要使用 d.getClass()，循环遍历它实现的接口以了解一个是否 == 到 x，如果不是，则再次递归地对其所有祖先执行此操作......在我们的例子中，如果您对该树进行广度优先探索，则至少会产生 8 次比较，假设 y 和 z 不扩展任何内容...

现实世界的派生树的复杂性可能更高。在某些情况下，如果 JIT 能够提前将 d 解析为，在所有可能的情况下，它是扩展 x 的某个实例，则 JIT 可以优化其中的大部分内容。然而，实际上，您大部分时间都将经历该树遍历。

如果这成为一个问题，我建议使用处理程序映射，将对象的具体类链接到执行处理的闭包。它删除了树遍历阶段，有利于直接映射。但是，请注意，如果您为 C.class 设置了处理程序，则无法识别我上面的对象 d。

这是我的 2 美分，希望对您有所帮助...

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-19T16:49:34.663

Instanceof 非常快。它归结为用于类引用比较的字节码。在循环中尝试几百万个实例，然后自己看看。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-27T20:07:04.457

instanceof 非常有效，因此您的性能不太可能受到影响。但是，使用大量 instanceof 表明存在设计问题。

如果您可以使用 xClass == String.class，这会更快。注意：最终类不需要 instanceof。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-06-22T05:07:32.310

我基于 jmh-java-benchmark-archetype:2.21 编写了一个性能测试。JDK是openjdk，版本是1.8.0_212。测试机器是mac pro。测试结果是：

```
Benchmark                Mode  Cnt    Score   Error   Units
MyBenchmark.getClasses  thrpt   30  510.818 ± 4.190  ops/us
MyBenchmark.instanceOf  thrpt   30  503.826 ± 5.546  ops/us 
```

结果表明：getClass优于instanceOf，与其他测试相反。但是，我不知道为什么。

测试代码如下：

```
public class MyBenchmark {

public static final Object a = new LinkedHashMap<String, String>();

@Benchmark
@BenchmarkMode(Mode.Throughput)
@OutputTimeUnit(TimeUnit.MICROSECONDS)
public boolean instanceOf() {
    return a instanceof Map;
}

@Benchmark
@BenchmarkMode(Mode.Throughput)
@OutputTimeUnit(TimeUnit.MICROSECONDS)
public boolean getClasses() {
    return a.getClass() == HashMap.class;
}

public static void main(String[] args) throws RunnerException {
    Options opt =
        new OptionsBuilder().include(MyBenchmark.class.getSimpleName()).warmupIterations(20).measurementIterations(30).forks(1).build();
    new Runner(opt).run();
}
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-19T16:46:05.090

通常，在这种情况下（instanceof 正在检查此基类的子类）不赞成“instanceof”运算符的原因通常是因为您应该做的是将操作移动到方法中并为适当的方法覆盖它子类。例如，如果您有：

```
if (o instanceof Class1)
   doThis();
else if (o instanceof Class2)
   doThat();
//... 
```

您可以将其替换为

```
o.doEverything(); 
```

然后在 Class1 中调用“doThis()”中的“doEverything()”，在 Class2 中调用“doThat()”，以此类推。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-19T16:46:56.197

'instanceof' 实际上是一个运算符，就像 + 或 - 一样，我相信它有自己的 JVM 字节码指令。它应该很快。

我不应该说，如果您有一个要测试对象是否是某个子类的实例的开关，那么您的设计可能需要重新设计。考虑将特定于子类的行为下推到子类本身。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-09-19T16:58:13.753

很难说某个 JVM 是如何实现实例的，但在大多数情况下，对象可以与结构相媲美，类也是如此，并且每个对象结构都有一个指向它作为实例的类结构的指针。所以实际上 instanceof 为

```
if (o instanceof java.lang.String) 
```

可能与以下 C 代码一样快

```
if (objectStruct->iAmInstanceOf == &java_lang_String_class) 
```

假设 JIT 编译器已经到位并且做得不错。

考虑到这只是访问一个指针，在指针指向的某个偏移量处获取一个指针并将其与另一个指针进行比较（这基本上与测试 32 位数字相等），我想说该操作实际上可以非常快。

但是，它不必如此，它在很大程度上取决于 JVM。但是，如果这会成为您代码中的瓶颈操作，我会认为 JVM 实现相当糟糕。即使没有 JIT 编译器并且只解释代码，也应该能够几乎立即进行 instanceof 测试。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-09-21T15:51:16.937

德米安和保罗提到了一个好点；*但是*，要执行的代码的位置实际上取决于您要如何使用数据...

我非常喜欢可以以多种方式使用的小型数据对象。如果您遵循覆盖（多态）方法，则您的对象只能以“一种方式”使用。

这就是模式出现的地方......

您可以使用双重分派（如在访问者模式中）要求每个对象“呼叫您”传递自身——这将解析对象的类型。*但是*（再次）您需要一个可以使用所有可能的子类型“做事”的类。

我更喜欢使用策略模式，您可以在其中为要处理的每个子类型注册策略。类似于以下内容。请注意，这仅有助于精确的类型匹配，但具有可扩展的优势 - 第三方贡献者可以添加自己的类型和处理程序。（这对于像 OSGi 这样可以添加新包的动态框架很有用）

希望这会激发一些其他的想法......

```
package com.javadude.sample;

import java.util.HashMap;
import java.util.Map;

public class StrategyExample {
    static class SomeCommonSuperType {}
    static class SubType1 extends SomeCommonSuperType {}
    static class SubType2 extends SomeCommonSuperType {}
    static class SubType3 extends SomeCommonSuperType {}

    static interface Handler<T extends SomeCommonSuperType> {
        Object handle(T object);
    }

    static class HandlerMap {
        private Map<Class<? extends SomeCommonSuperType>, Handler<? extends SomeCommonSuperType>> handlers_ =
            new HashMap<Class<? extends SomeCommonSuperType>, Handler<? extends SomeCommonSuperType>>();
        public <T extends SomeCommonSuperType> void add(Class<T> c, Handler<T> handler) {
            handlers_.put(c, handler);
        }
        @SuppressWarnings("unchecked")
        public <T extends SomeCommonSuperType> Object handle(T o) {
            return ((Handler<T>) handlers_.get(o.getClass())).handle(o);
        }
    }

    public static void main(String[] args) {
        HandlerMap handlerMap = new HandlerMap();

        handlerMap.add(SubType1.class, new Handler<SubType1>() {
            @Override public Object handle(SubType1 object) {
                System.out.println("Handling SubType1");
                return null;
            } });
        handlerMap.add(SubType2.class, new Handler<SubType2>() {
            @Override public Object handle(SubType2 object) {
                System.out.println("Handling SubType2");
                return null;
            } });
        handlerMap.add(SubType3.class, new Handler<SubType3>() {
            @Override public Object handle(SubType3 object) {
                System.out.println("Handling SubType3");
                return null;
            } });

        SubType1 subType1 = new SubType1();
        handlerMap.handle(subType1);
        SubType2 subType2 = new SubType2();
        handlerMap.handle(subType2);
        SubType3 subType3 = new SubType3();
        handlerMap.handle(subType3);
    }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-05-30T21:59:34.177

我会在 instanceof 性能方面与您联系。但是完全避免问题（或缺乏问题）的一种方法是为您需要在其上执行 instanceof 的所有子类创建一个父接口。该接口将是您需要对其进行 instanceof 检查的子类中*所有方法的超集。*如果方法不适用于特定的子类，只需提供此方法的虚拟实现即可。如果我没有误解这个问题，这就是我过去解决问题的方法。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-19T19:09:53.077

在现代 Java 版本中，instanceof 运算符作为简单的方法调用更快。这表示：

```
if(a instanceof AnyObject){
} 
```

更快：

```
if(a.getType() == XYZ){
} 
```

另一件事是如果您需要级联许多instanceof。然后只调用一次 getType() 的开关更快。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-19T17:15:09.047

**InstanceOf**是对糟糕的面向对象设计的警告。

当前的 JVM 确实意味着**instanceOf**本身并没有太大的性能问题。如果您发现自己经常使用它，尤其是在核心功能方面，那么可能是时候看看设计了。重构为更好的设计所带来的性能（和简单性/可维护性）收益将大大超过实际调用**instanceOf**所花费的任何实际处理器周期。

举一个非常简单的编程示例。

```
if (SomeObject instanceOf Integer) {
  [do something]
}
if (SomeObject instanceOf Double) {
  [do something different]
} 
```

一个糟糕的架构是一个更好的选择，让 SomeObject 成为两个子类的父类，其中每个子类都覆盖一个方法（doSomething），因此代码如下所示：

```
Someobject.doSomething(); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-07-27T14:13:43.073

如果速度是您的唯一目标，那么使用 int 常量来识别子类似乎可以节省几毫秒的时间

```
static final int ID_A = 0;
static final int ID_B = 1;
abstract class Base {
  final int id;
  Base(int i) { id = i; }
}
class A extends Base {
 A() { super(ID_A); }
}
class B extends Base {
 B() { super(ID_B); }
}
...
Base obj = ...
switch(obj.id) {
case  ID_A: .... break;
case  ID_B: .... break;
} 
```

糟糕的 OO 设计，但是如果您的性能分析表明这是您的瓶颈所在，那么可能。在我的代码中，调度代码占用了总执行时间的 10%，这可能有助于提高 1% 的总速度。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-19T16:50:42.693

如果它确实是您项目中的性能问题，您应该测量/分析。如果是，我建议重新设计 - 如果可能的话。我很确定您无法击败平台的本机实现（用 C 编写）。在这种情况下，您还应该考虑多重继承。

您应该详细说明该问题，如果您只对具体类型感兴趣，也许您可​​以使用关联存储，例如 Map<Class, Object>。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-19T01:25:01.620

关于 Peter Lawrey 的注释，即最终类不需要 instanceof 并且可以只使用引用相等，请小心！即使最终类不能扩展，也不能保证它们被同一个类加载器加载。如果您绝对肯定该部分代码只有一个类加载器，请仅使用 x.getClass() == SomeFinal.class 或其同类。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-08-13T15:38:05.477

我也更喜欢枚举方法，但我会使用抽象基类来强制子类实现该`getType()`方法。

```
public abstract class Base
{
  protected enum TYPE
  {
    DERIVED_A, DERIVED_B
  }

  public abstract TYPE getType();

  class DerivedA extends Base
  {
    @Override
    public TYPE getType()
    {
      return TYPE.DERIVED_A;
    }
  }

  class DerivedB extends Base
  {
    @Override
    public TYPE getType()
    {
      return TYPE.DERIVED_B;
    }
  }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-10-16T07:53:53.673

我认为可能值得提交一个反例来反对此页面上的普遍共识，即“instanceof”的成本不足以担心。我发现我在内部循环中有一些代码（在一些历史性的优化尝试中）确实

```
if (!(seq instanceof SingleItem)) {
  seq = seq.head();
} 
```

在 SingleItem 上调用 head() 会返回未更改的值。将代码替换为

```
seq = seq.head(); 
```

让我从 269 毫秒加速到 169 毫秒，尽管在循环中发生了一些相当繁重的事情，比如字符串到双精度的转换。当然，加速可能更多是由于消除了条件分支而不是消除了 instanceof 运算符本身。但我认为值得一提。

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2008-09-19T16:51:11.960

你专注于错误的事情。instanceof 和任何其他检查同一事物的方法之间的差异可能甚至无法衡量。如果性能至关重要，那么 Java 可能是错误的语言。主要原因是您无法控制 VM 何时决定收集垃圾，这可能会使大型程序中的 CPU 达到 100% 几秒钟（MagicDraw 10 非常适合）。除非您能控制该程序将在其上运行的每台计算机，否则您无法保证它将在哪个版本的 JVM 上运行，并且许多较旧的 JVM 存在严重的速度问题。如果它是一个小型应用程序，你可能对 Java 没问题，但如果你不断地读取和丢弃数据，那么你*会*注意到 GC 何时启动。

# visual-studio-2008 - Visual Studio 2008 保存文件变慢

> ID：103569
> 
> 赞同：5
> 
> 时间：2008-09-19T16:41:54.883
> 
> 标签：visual-studio-2008

我找了一些关于这个问题的其他文章，甚至尝试了[这个线程](https://stackoverflow.com/questions/8440/visual-studio-optimizations#8539)中的一些想法；但是，还没有解决这个问题。所以，关于这个问题。

在 Visual Studio（通常是 C#）中工作时会发生一些事情，导致 IDE 在保存文件时变得有点不稳定。我会好好工作一段时间然后在某个时候我注意到每次我保存一个文件（`Ctrl`+ `S`）它变得非常慢。

我注意到的行为是这样的；我以某种方式（`Ctrl`+ `S`、菜单等）点击保存，在状态栏中我看到“**搜索**”一词出现。看起来它正在扫描所有已加载的命名空间以查找某些内容，尽管我不知道它这样做是什么或为什么这样做。它会在工作流程中造成真正的打嗝，因为通常我会经常点击`Ctrl`+`S`并继续输入。

我一直无法追查到底是什么原因导致这种情况开始发生。它发生在多种项目类型（Web、WPF、控制台）中。

有没有人看到这种行为或有任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T13:01:18.020

我知道这个问题很老，但这可能会帮助遇到同样问题的其他人。

我遇到了 VS 2008 需要很长时间才能保存一些文件的问题。不是所有文件，只是一些文件。点击`Ctrl`+`S`将需要 30-120 秒的任何时间。

我发现它出现在具有外部 JavaScript 的页面上。所以我选择性地将它们注释掉并尝试保存并找到违规者。

罪魁祸首是谷歌翻译 javascript 代码。

它开始于`<script src="//translate.google.com/translate_a...`

请注意`//`src 开头的 。**其他所有以http://**开头的外部脚本都没有问题，我把//改成了http://，问题就解决了。

如果路径不是http，VS似乎试图在本地获取文件。我不知道它做了什么，但这解决了我的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T16:47:10.253

我以前也遇到过类似的问题。你在使用 ReSharper 或 DevExpress 之类的插件吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:53:24.043

您是否禁用了智能感知？我们已经在 Visual Studio 中看到了各种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-17T23:18:46.003

我在使用 Visual Studio 2005 时遇到了类似的问题。

我阅读了几篇帖子（抱歉，我无法发布链接，因为：抱歉，新用户最多只能发布一个超链接）。

我运行 FileMon 并发现在保存时 IDE 一直在查询 C:\Documents and Settings\iguigova\Local Settings\Application Data\Microsoft\WebsiteCache

然后我遇到了这篇文章： [http ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=347228](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=347228)

现在我正在尝试清除目录。已经满了。我计划设置一个批处理文件以每天删除其内容...

祝你好运！

# wpf - WPF 验证未在 TextBox 的第一个 LostFocus 上触发

> ID：103575
> 
> 赞同：16
> 
> 时间：2008-09-19T16:42:20.967
> 
> 标签：wpf, validation, focus

我正在尝试针对对象验证 WPF 表单。当我在文本框中输入内容时，验证会触发失去焦点回到文本框，然后擦除我写的任何内容。但是，如果我只是加载 WPF 应用程序并在文本框上制表符而不从文本框中写入和擦除任何内容，那么它不会被触发。

这是 Customer.cs 类：

```
public class Customer : IDataErrorInfo
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }

        public string Error
        {
            get { throw new NotImplementedException(); }
        }
        public string this[string columnName]
        {
            get
            {
                string result = null;

                if (columnName.Equals("FirstName"))
                {
                    if (String.IsNullOrEmpty(FirstName))
                    {
                        result = "FirstName cannot be null or empty"; 
                    }
                }
                else if (columnName.Equals("LastName"))
                {
                    if (String.IsNullOrEmpty(LastName))
                    {
                        result = "LastName cannot be null or empty"; 
                    }
                }
                return result;
            }
        }
    } 
```

这是 WPF 代码：

```
<TextBlock Grid.Row="1" Margin="10" Grid.Column="0">LastName</TextBlock>
<TextBox Style="{StaticResource textBoxStyle}" Name="txtLastName" Margin="10"
         VerticalAlignment="Top" Grid.Row="1" Grid.Column="1">
    <Binding Source="{StaticResource CustomerKey}" Path="LastName"
             ValidatesOnExceptions="True" ValidatesOnDataErrors="True"
             UpdateSourceTrigger="LostFocus"/>         
</TextBox> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-08-28T14:33:23.617

如果您不反对在代码中添加一些逻辑，则可以使用以下方式处理实际的*LostFocus*事件：

**.xaml**

```
<TextBox LostFocus="TextBox_LostFocus" .... 
```

* * *

**.xaml.cs**

```
private void TextBox_LostFocus(object sender, RoutedEventArgs e)
{
     ((Control)sender).GetBindingExpression(TextBox.TextProperty).UpdateSource();
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T16:50:52.367

不幸的是，这是设计使然。WPF 验证仅在控件中的值发生更改时触发。

难以置信，但却是真实的。到目前为止，WPF 验证是众所周知的最大痛苦——太可怕了。

但是，您可以做的一件事是从控件的属性中获取绑定表达式并手动调用验证。这很糟糕，但它有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T06:42:07.350

查看 ValidationRule 的[ValidatesOnTargetUpdated](http://msdn.microsoft.com/en-us/library/system.windows.controls.validationrule.validatesontargetupdated.aspx)属性。它将在首次加载数据时进行验证。如果您尝试捕获空字段或空字段，这很好。

你会像这样更新你的绑定元素：

```
<Binding 
    Source="{StaticResource CustomerKey}" 
    Path="LastName" 
    ValidatesOnExceptions="True" 
    ValidatesOnDataErrors="True" 
    UpdateSourceTrigger="LostFocus">
    <Binding.ValidationRules>
        <DataErrorValidationRule
            ValidatesOnTargetUpdated="True" />
    </Binding.ValidationRules>
</Binding> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-16T01:27:37.157

我发现处理这个问题的最佳方法是在文本框的 LostFocus 事件上我做了这样的事情

```
 private void dbaseNameTextBox_LostFocus(object sender, RoutedEventArgs e)
    {
        if (string.IsNullOrWhiteSpace(dbaseNameTextBox.Text))
        {
            dbaseNameTextBox.Text = string.Empty;
        }
    } 
```

然后它看到一个错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T14:47:13.290

我遇到了同样的问题，并找到了一种非常简单的方法来解决这个问题：在窗口的 Loaded 事件中，只需输入 txtLastName.Text = String.Empty。就是这样！！由于您的对象的属性已更改（已设置为空字符串），验证的触发！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-15T04:43:11.977

以下代码循环遍历所有控件并验证它们。不一定是首选方式，但似乎有效。它仅适用于 TextBlocks 和 TextBoxes，但您可以轻松更改它。

```
public static class PreValidation
{

    public static IEnumerable<T> FindVisualChildren<T>(DependencyObject depObj) where T : DependencyObject
    {
        if (depObj != null)
        {
            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
            {
                DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                if (child != null && child is T)
                {
                    yield return (T)child;
                }

                foreach (T childOfChild in FindVisualChildren<T>(child))
                {
                    yield return childOfChild;
                }
            }
        }
    }

    public static void Validate(DependencyObject depObj)
    {
        foreach(var c in FindVisualChildren<FrameworkElement>(depObj))
        {
            DependencyProperty p = null;

            if (c is TextBlock)
                p = TextBlock.TextProperty;
            else if (c is TextBox)
                p = TextBox.TextProperty;

            if (p != null && c.GetBindingExpression(p) != null) c.GetBindingExpression(p).UpdateSource();
        }

    }
} 
```

只需在您的窗口或控件上调用 Validate，它就会为您预先验证它们。

# xml - 我的 XPath/XML 有什么问题？

> ID：103576
> 
> 赞同：10
> 
> 时间：2008-09-19T16:42:21.823
> 
> 标签：xml, xpath, namespaces

我正在[这个 xml](http://pastebin.com/f14a20a30)上尝试一个非常基本的 XPath （如下所示），但它没有找到任何东西。我正在尝试 .NET 和[这个网站](http://www.xmlme.com/XpathTool.aspx)，以及 XPaths，例如`//PropertyGroup`，`/PropertyGroup`并且`//MSBuildCommunityTasksPath`根本不适合我（他们编译但返回零结果）。

源 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <!-- $Id: FxCop.proj 114 2006-03-14 06:32:46Z pwelter34 $ -->
    <PropertyGroup>
        <MSBuildCommunityTasksPath>$(MSBuildProjectDirectory)\MSBuild.Community.Tasks\bin\Debug</MSBuildCommunityTasksPath>
    </PropertyGroup>
    <Import
        Project="$(MSBuildProjectDirectory)\MSBuild.Community.Tasks\MSBuild.Community.Tasks.Targets" />
    <Target Name="DoFxCop">
        <FxCop TargetAssemblies="$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.dll"
            RuleLibraries="@(FxCopRuleAssemblies)" 
            AnalysisReportFileName="Test.html"
            DependencyDirectories="$(MSBuildCommunityTasksPath)" 
            FailOnError="True"
            ApplyOutXsl="True"
            OutputXslFileName="C:\Program Files\Microsoft FxCop 1.32\Xml\FxCopReport.xsl" />
    </Target>
</Project> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-19T18:39:14.867

您可以在代码中添加命名空间等等，但您可以有效地使用通配符命名空间。试试下面的 XPath 习惯用法。

```
//*[local-name()='PropertyGroup']
//*[local-name()='MSBuildCommunityTasksPath'] 
```

name() 通常也可以工作，例如：

```
//*[name()='PropertyGroup']
//*[name()='MSBuildCommunityTasksPath'] 
```

EDIT: **Namespaces are great** and i'm not suggesting they're not important, but wildcarding them comes in handy when cobbling together prototype code, one-off desktop tools, experimenting with XSLT, and so forth. Balance your need for convenience against acceptable risk for the task at hand. FYI, if need be, you can also strip or reassign namespaces.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T17:29:17.360

文档中的标签最终位于由 xmlns 属性创建的“默认”命名空间中，没有前缀。不幸的是，仅 XPath 无法查询默认命名空间中的元素。我实际上不确定语义细节，但是您必须使用托管 XPath 的任何工具显式地将前缀附加到该名称空间。

在 .NET 中可能有更短的方法来执行此操作，但我见过的唯一方法是通过 NameSpaceManager。在显式添加命名空间后，您可以使用命名空间管理器进行查询，就好像命名空间元素中的所有标记都具有该前缀（我选择了“msbuild”）：

```
using System;
using System.Xml;

public class XPathNamespace {
    public static void Main(string[] args) {
        XmlDocument xmlDocument = new XmlDocument();
        xmlDocument.LoadXml(
    @"<?xml version=""1.0"" encoding=""utf-8""?>
<Project xmlns=""http://schemas.microsoft.com/developer/msbuild/2003"">
    <!-- $Id: FxCop.proj 114 2006-03-14 06:32:46Z pwelter34 $ -->

    <PropertyGroup>
        <MSBuildCommunityTasksPath>$(MSBuildProjectDirectory)\MSBuild.Community.Tasks\bin\Debug</MSBuildCommunityTasksPath>
    </PropertyGroup>

    <Import Project=""$(MSBuildProjectDirectory)\MSBuild.Community.Tasks\MSBuild.Community.Tasks.Targets""/>

    <Target Name=""DoFxCop"">

        <FxCop 
            TargetAssemblies=""$(MSBuildCommunityTasksPath)\MSBuild.Community.Tasks.dll""
            RuleLibraries=""@(FxCopRuleAssemblies)"" 
            AnalysisReportFileName=""Test.html""
            DependencyDirectories=""$(MSBuildCommunityTasksPath)""
            FailOnError=""True""
            ApplyOutXsl=""True""
            OutputXslFileName=""C:\Program Files\Microsoft FxCop 1.32\Xml\FxCopReport.xsl""
        />
    </Target>

</Project>");

        XmlNamespaceManager namespaceManager = new
    XmlNamespaceManager(xmlDocument.NameTable);
        namespaceManager.AddNamespace("msbuild", "http://schemas.microsoft.com/developer/msbuild/2003");
        foreach (XmlNode n in xmlDocument.SelectNodes("//msbuild:MSBuildCommunityTasksPath", namespaceManager)) {
            Console.WriteLine(n.InnerText);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T16:49:03.977

您的问题与命名空间有关（xmlns="http://schemas.microsoft.com/developer/msbuild/2003"）。您收到零节点是因为您没有使用命名空间对其进行限定。如果您删除 xmlns 属性，您的“//PropertyGroup”XPath 将起作用。如何使用命名空间进行查询通常涉及将默认 xmlns 别名为标识符（因为未在属性上指定一个），并选择类似“//myXMLNStoken:PropertyGroup”。

# php - 例外：这是一个好习惯吗？

> ID：103583
> 
> 赞同：1
> 
> 时间：2008-09-19T16:43:42.413
> 
> 标签：php, language-agnostic, exception, exception-handling, error-handling

这是用 PHP 编写的，但它实际上与语言无关。

```
try
{
    try
    {
        $issue = new DM_Issue($core->db->escape_string($_GET['issue']));
    }
    catch(DM_Exception $e)
    {
        throw new Error_Page($tpl, ERR_NOT_FOUND, $e->getMessage());
    }
}
catch(Error_Page $e)
{
    die($e);
} 
```

嵌套的 try, catch 块是一个很好的做法吗？仅对于错误页面来说似乎有点笨重 - 但是如果发生错误，我的 Issue Datamanager 会抛出异常，我认为这是检测错误的好方法。

Error_Page 异常只是一个错误页面编译器。

我可能只是迂腐，但你认为这是报告错误的好方法吗？如果是，你能建议一个更好的方法来写这个吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T16:50:35.970

您正在为页面逻辑使用异常，我个人认为这不是一件好事。异常应该用于在发生不良或意外事情时发出信号，而不是控制错误页面的输出。如果要基于异常生成错误页面，请考虑使用[set_exception_handler](http://www.php.net/set_exception_handler)。任何未捕获的异常都通过您指定的任何回调方法运行。请记住，这并不能阻止异常的“致命性”。在通过回调传递异常后，执行将在任何未捕获的异常后正常停止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T16:48:59.267

我认为你最好不要嵌套。如果您期望多种异常类型，请使用多个捕获。

```
try{
  Something();
}
catch( SpecificException se )
{blah();}
catch( AnotherException ae )
{blah();} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T16:59:09.600

理想的情况是在可以处理它们的级别捕获异常。不是之前（浪费时间），也不是之后（你失去了上下文）。

因此，如果 $tpl 和 ERR_NOT_FOUND 是仅在新的 DM_Issue 调用附近“已知”的信息，例如因为在其他地方创建 DM_Issue 并且需要 ERR_SOMETHING_ELSE，或者因为 $tpl 的值不同，那么你'在正确的地方捕获第一个异常。

如何从那个地方走向死亡是另一个问题。另一种选择是死在那里。但是如果你这样做了，那么干预代码就没有机会在错误之后但退出之前做任何事情（例如以某种方式清除某些内容或修改错误页面）。有明确的控制流也很好。所以我觉得你很好。

我假设您的示例不是一个完整的应用程序 - 如果是，那么它可能是不必要的冗长，您可能会死在 DM_Exception catch 子句中。但是对于一个真正的应用程序，我赞成不只是死在茫茫荒野中的原则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:49:32.227

根据您的需要，这可能很好，但我通常很犹豫要捕获异常，将消息包装在新异常中，然后重新抛出它，因为您在包装中丢失了原始异常中的堆栈跟踪（以及可能的其他）信息例外。如果您**确定**在检查包装异常时不需要该信息，那么它可能没问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T16:51:28.697

我不确定 PHP，但在例如 C# 中，您可以拥有多个 catch-Block，因此不需要嵌套的 try/catch-combinations。

一般来说，我认为使用 try/catch/finally 进行错误处理始终是常识，也用于“仅”显示错误页面。这是一种处理错误并避免崩溃时出现奇怪行为的干净方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T17:22:59.230

我不会在未找到的问题上抛出异常 - 这是应用程序的有效状态，您不需要堆栈跟踪来显示 404。

你需要捕捉的是意外的失败，比如 sql 错误——这时异常处理就派上用场了。我会将您的代码更改为如下所示：

```
try {
    $issue = DM_Issue::fetch($core->db->escape_string($_GET['issue']));
}
catch (SQLException $e) {
    log_error('SQL Error: DM_Issue::fetch()', $e->get_message());
}
catch (Exception $e) {
    log_error('Exception: DM_Issue::fetch()', $e->get_message());
}

if(!$issue) {
    display_error_page($tpl, ERR_NOT_FOUND);
}
else
{
    // ... do stuff with $issue object.
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-20T00:16:30.220

仅当存在潜在的站点破坏事件时才应使用异常 - 例如数据库查询未正确执行或配置错误。一个很好的例子是 Apache 进程不可写缓存或日志目录。

这里的想法是，开发人员可以停止可能破坏整个站点的代码，以便您可以在部署之前修复它们。它们也是健全性检查，以确保如果环境发生变化（例如，有人更改缓存文件夹的权限或更改数据库方案），站点会在可能损坏任何东西之前停止。

所以不行; 嵌套的 catch 处理程序不是一个好主意。在我的页面中，我的 index.php 文件将其代码包装在一个 try...cache 块中——如果发生不好的事情，它会检查它是否在生产中；或者给我发电子邮件并显示一个通用的错误页面，或者在屏幕上显示错误。

请记住：PHP 不是 C#。C#（除了 ASP.net 的例外（呵呵，没有双关语：p））用于包含状态的应用程序 - 而 PHP 是一种无状态脚本语言。

# php - 使用php，如何插入文本而不覆盖文本文件的开头

> ID：103593
> 
> 赞同：8
> 
> 时间：2008-09-19T16:45:02.567
> 
> 标签：php, insert

我有：

```
<?php

$file=fopen(date("Y-m-d").".txt","r+") or exit("Unable to open file!");

if ($_POST["lastname"] <> "")
{
   fwrite($file,$_POST["lastname"]."\n");
}

fclose($file);

?> 
```

但它会覆盖文件的开头。我如何让它插入？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-19T16:46:50.487

我不完全确定您的问题-您是要写入数据而不是让它覆盖现有文件的开头，还是将新数据写入现有文件的开头，然后保留现有内容？

**要插入文本而不覆盖文件的开头**，您必须打开它以进行附加（[`a+`而不是`r+`](http://ie.php.net/fopen)）

```
$file=fopen(date("Y-m-d").".txt","a+") or exit("Unable to open file!");

if ($_POST["lastname"] <> "")
{
   fwrite($file,$_POST["lastname"]."\n");
}

fclose($file); 
```

**如果您尝试写入文件的开头，则**必须先读入文件内容（请参阅 参考资料[`file_get_contents`](http://www.google.ie/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.php.net%2Ffile_get_contents&ei=39jTSKOWEoyk1wbQ-vC6Dg&usg=AFQjCNHwFDwvy4v0p90sNfmfSB_jg7gR7Q&sig2=KyOdq6fGxuj8701pDDdXqA)），然后将新字符串和文件内容写入输出文件。

```
$old_content = file_get_contents($file);
fwrite($file, $new_content."\n".$old_content); 
```

上述方法适用于小文件，但您可能会在尝试读取大文件时遇到内存限制`file_get_conents`。在这种情况下，请考虑使用[`rewind($file)`](http://ie.php.net/rewind)，它将句柄的文件位置指示符设置为文件流的开头。注意使用时，不要用（或）选项`rewind()`打开文件，如：`a``a+`

> 如果您以追加（“a”或“a+”）模式打开文件，则无论文件位置如何，您写入文件的任何数据都将始终被追加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T06:24:51.030

一个在文件流中间插入而不覆盖的工作示例，并且不必将整个内容加载到变量/内存中：

```
function finsert($handle, $string, $bufferSize = 16384) {
    $insertionPoint = ftell($handle);

    // Create a temp file to stream into
    $tempPath = tempnam(sys_get_temp_dir(), "file-chainer");
    $lastPartHandle = fopen($tempPath, "w+");

    // Read in everything from the insertion point and forward
    while (!feof($handle)) {
        fwrite($lastPartHandle, fread($handle, $bufferSize), $bufferSize);
    }

    // Rewind to the insertion point
    fseek($handle, $insertionPoint);

    // Rewind the temporary stream
    rewind($lastPartHandle);

    // Write back everything starting with the string to insert
    fwrite($handle, $string);
    while (!feof($lastPartHandle)) {
        fwrite($handle, fread($lastPartHandle, $bufferSize), $bufferSize);
    }

    // Close the last part handle and delete it
    fclose($lastPartHandle);
    unlink($tempPath);

    // Re-set pointer
    fseek($handle, $insertionPoint + strlen($string));
}

$handle = fopen("file.txt", "w+");
fwrite($handle, "foobar");
rewind($handle);
finsert($handle, "baz");

// File stream is now: bazfoobar 
```

[可以在这里找到它的 Composer 库](https://github.com/prewk/file-chainer/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:47:28.007

如果要将文本放在文件的开头，则必须首先阅读文件内容，例如：

```
<?php

$file=fopen(date("Y-m-d").".txt","r+") or exit("Unable to open file!");

if ($_POST["lastname"] <> "")
{    
    $existingText = file_get_contents($file);
    fwrite($file, $existingText . $_POST["lastname"]."\n");
}

fclose($file);

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:56:59.527

您打开文件以进行附加

```
<?php
$file=fopen(date("Y-m-d").".txt","a+") or exit("Unable to open file!");
if ($_POST["lastname"] <> "")
{
   fwrite($file,$_POST["lastname"]."\n");
}
fclose($file);
?> 
```

# javascript - 为什么 JavaScript 中不推荐使用 arguments.callee.caller 属性？

> ID：103598
> 
> 赞同：220
> 
> 时间：2008-09-19T16:45:37.807
> 
> 标签：javascript, ecma262

为什么`arguments.callee.caller`JavaScript 中不推荐使用该属性？

它在 JavaScript 中被添加，然后被弃用，但 ECMAScript 完全省略了它。某些浏览器（Mozilla、IE）一直支持它，并且在地图上没有任何取消支持的计划。其他人（Safari、Opera）已经采用了对它的支持，但对旧浏览器的支持并不可靠。

是否有充分的理由将这个有价值的功能置于边缘？

（或者，有没有更好的方法来获取调用函数的句柄？）

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2008-10-25T01:51:40.203

JavaScript 的早期版本不允许命名函数表达式，因此我们无法创建递归函数表达式：

```
 // This snippet will work:
 function factorial(n) {
     return (!(n>1))? 1 : factorial(n-1)*n;
 }
 [1,2,3,4,5].map(factorial);

 // But this snippet will not:
 [1,2,3,4,5].map(function(n) {
     return (!(n>1))? 1 : /* what goes here? */ (n-1)*n;
 }); 
```

为了解决这个问题，`arguments.callee`添加了这样我们可以这样做：

```
 [1,2,3,4,5].map(function(n) {
     return (!(n>1))? 1 : arguments.callee(n-1)*n;
 }); 
```

然而，这实际上是一个非常糟糕的解决方案，因为这（与其他参数、被调用者和调用者问题一起）使得内联和尾递归在一般情况下是不可能的（您可以通过跟踪等在特定情况下实现它，但即使是最好的代码由于没有必要的检查，因此是次优的）。另一个主要问题是递归调用会得到不同的`this`值，例如：

```
var global = this;
var sillyFunction = function (recursed) {
    if (!recursed)
        return arguments.callee(true);
    if (this !== global)
        alert("This is: " + this);
    else
        alert("This is the global");
}
sillyFunction(); 
```

总之，EcmaScript 3 通过允许命名函数表达式解决了这些问题，例如：

```
 [1,2,3,4,5].map(function factorial(n) {
     return (!(n>1))? 1 : factorial(n-1)*n;
 }); 
```

这有很多好处：

*   可以像从代码内部调用任何其他函数一样调用该函数。

*   它不会污染命名空间。

*   的值`this`不变。

*   它的性能更高（访问[arguments 对象](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments)很昂贵）。

### 哎呀，

刚刚意识到除了其他所有问题之外，问题是关于`arguments.callee.caller`，或者更具体地说[`Function.caller`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/caller)。

在任何时候，您都可以在堆栈上找到任何函数的最深调用者，正如我上面所说，查看调用堆栈有一个主要影响：它使大量优化变得不可能，或者变得更加困难。

例如。如果我们不能保证一个函数`f`不会调用未知函数，那么就不可能内联`f`。基本上，这意味着任何可能被微不足道内联的调用站点都会积累大量的守卫，采取：

```
 function f(a, b, c, d, e) { return a ? b * c : d * e; } 
```

如果 js 解释器在调用时不能保证所有提供的参数都是数字，它需要在内联代码之前插入对所有参数的检查，或者它不能内联函数。

现在在这种特殊情况下，智能解释器应该能够重新排列检查以使其更优化，并且不会检查任何不会使用的值。然而，在许多情况下，这是不可能的，因此内联变得不可能。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-08-26T15:31:21.707

`arguments.call**ee**.call**er**`**没有**被弃用，尽管它确实使用了该属性。（只会给你一个当前函数的参考）[`Function.call**er**`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/caller)[`arguments.call**ee**`](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Functions_and_function_scope/arguments/callee)

*   `Function.call**er**`，尽管根据 ECMA3 是非标准的，但已在**所有当前主要浏览器**中实现。
*   [`arguments.call**er**`](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Functions_and_function_scope/arguments/caller) **已**弃用，取而代之的是，并且在当前的一些主要浏览器（例如 Firefox 3）中未实现。`Function.call**er**`

所以情况不太理想，但是如果您想在所有主要浏览器中访问 Javascript 中的调用函数，您可以使用该属性，可以直接在命名函数引用上访问，也可以通过该属性从匿名函数内部访问。`Function.call**er**``arguments.call**ee**`

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-19T17:38:12.813

使用**命名函数**比使用 arguments.callee 更好：

```
 function foo () {
     ... foo() ...
 } 
```

好于

```
 function () {
     ... arguments.callee() ...
 } 
```

**[命名函数将可以通过caller](http://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/caller)**属性访问其调用者：

```
 function foo () {
     alert(foo.caller);
 } 
```

这比

```
 function foo () {
     alert(arguments.callee.caller);
 } 
```

弃用是由于当前的 ECMAScript[设计原则](http://wiki.ecmascript.org/doku.php?id=es3.1:design_principles)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T08:44:14.787

只是一个扩展。“this”的值在递归期间发生变化。在以下（修改后的）示例中，阶乘获取 {foo:true} 对象。

```
[1,2,3,4,5].map(function factorial(n) {
  console.log(this);
  return (!(n>1))? 1 : factorial(n-1)*n;
},     {foo:true}     ); 
```

第一次调用的阶乘获取对象，但递归调用并非如此。

# asp.net - 您在运行 ASP.NET 的网络场中使用什么进行分布式缓存？

> ID：103601
> 
> 赞同：4
> 
> 时间：2008-09-19T16:45:57.993
> 
> 标签：asp.net, caching, memcached, scaling, distributed-cache

我很好奇其他人在这种情况下使用的是什么。我知道一些可用的选项，例如 memcached 端口或 ScaleOutSoftware。memcached 端口似乎没有被积极处理（如果我错了，请纠正我）。ScaleOutSoftware 对我来说太贵了（我不怀疑它值得）。这并不是说我不想听到人们使用 memcached 或 ScaleOutSoftware。在这一点上，我只是陈述我“知道”的内容。

所以我的问题基本上是这样的：对于那些**积极**使用分布式缓存的人，你在使用什么，你对它是否满意，我应该注意什么？

我很快就会搬到两台服务器上……两者都将在同一个位置。我相当大量地（但小心地）使用缓存来减少我的数据库服务器上的负载。

**编辑：**我下载了 Scaleout Software 的解决方案。我已经为它编写了代码，它似乎工作得很好。我只需要决定我的钱包是否愿意为此付出现金。:) 任何人对 ScaleoutSoftware 有好的或坏的体验吗？

**再次编辑：**我问这个已经有一段时间了？还有什么想法吗？我们最终从 ScaleOutSoftware 购买了解决方案，并且对它感到满意，但我很好奇其他人在做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T18:56:41.320

微软有一个代号为[Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)的产品待定。它仍然在 CTP 中，并且正在缓慢移动，但看起来会很不错。我们将在不久的将来击败它，看看它如何处理我们想要它做的事情（> 每小时 200 万次读/写）。将返回结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T02:17:50.397

有一个 100% 原生 .NET，有据可查的开源 (LGPL) 项目，称为[Shared Cache](http://www.sharedcache.com/)。看起来它还没有在 SO 上提到，但它很有前途，应该能够满足大多数人对分布式缓存的期望。它甚至支持不同的策略，如分布式或复制缓存等。

一旦我有机会在一个真实的项目中尝试它，我将更新这篇文章的更多细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:48:19.093

我们正在为 Windows 使用 memcached 端口，我们对此非常满意。[enyim.com memcached 客户端 API](http://www.codeplex.com/EnyimMemcached)非常棒且易于使用。如果你问我，它也是开源的，这是一个很大的优势。

我们现在在生产网络应用程序中使用此设置，它对提高其性能有很大帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T08:54:35.357

[Codeplex 上有一个很棒的](http://www.codeplex.com/memcachedproviders).NET 包装器/端口。很棒的酱！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-20T09:13:51.420

我们目前正在使用一个非常简单的缓存，它是我在几个小时内编写的，基于在 Windows 服务中重新托管 ASP.NET 缓存（[更多信息和源代码在这里](http://gregbeech.com/blogs/tech/archive/2007/12/20/how-to-write-a-high-performance-distributed-cache-in-30-minutes.aspx)）。我不会假装它与 Memcached 之类的东西一样优化，但在 Velocity 出现之前，我们只是在寻找简单且免费的东西，即使在相当重的负载下它也能保持得非常好。

这归结为我们个人对核心组件的偏好——即影响站点是否可用的组件——它们要么由具有快速和高质量支持历史的供应商支持，要么由我们这样如果出现问题，我们可以快速修复它。开源一切都很好，确实我们确实使用了一些 OSS，但如果您的网站离线，那么不幸的是新闻组*等人*没有 1 小时的 SLA，仅仅因为它是 OSS 并不意味着您有必要的了解或自己修复的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T11:44:44.590

我们在生产环境中使用 memcached 和 enyim 库 (www.funda.nl)。工作正常，非常满意，但我们确实注意到客户端的 CPU 使用率大幅提高。大概是由于正在进行的序列化/反序列化。我们每秒进行大约 1000 次读取。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-22T10:42:36.463

[NCache](http://www.alachisoft.com/ncache/)是一款经过全球 100 家客户试用和测试的产品。它的

一款功能丰富的产品，可让您以冗余且高度可用的方式存储会话状态，让您共享数据

在企业内部以及桥接 WAN 通信，本质上充当数据结构，最后它允许您构建弹性缓存层，以便当

您的应用程序可扩展，您可以将服务器添加到缓存中并实际进一步提高性能。

# salesforce - Salesforce.com - 为什么上传 Apex 课程不起作用？

> ID：103616
> 
> 赞同：2
> 
> 时间：2008-09-19T16:47:13.467
> 
> 标签：salesforce, apex-code, force.com

我有一个最初在开发人员版下开发的 Apex 类（控制器），需要将其上传到企业版的生产环境中。

上传失败并显示以下消息

```
classes/RenewalController.cls(RenewalController):An error occurred on your page.

package.xml(RenewalController):An object 'RenewalController' of type ApexClass 
was named in manifest but was not found in zipped directory 
```

当我尝试使用 Force.com IDE 时出现相同的消息：*保存错误：您的页面上发生错误。*

此类在 Developer Edition 下工作，但不适用于 Enterprise。

可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-12T08:59:40.983

Dmytro，你是对的。Visualforce 页面、顶点类和组件必须以正确的顺序上传。通常我使用的模式是上传控制器、组件，然后是 visualforce 页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T04:52:00.560

控制器类可能会引用其他自定义 SalesForce 对象，如页面。如果控制器在这些对象之前上传*保存错误：您的页面发生错误。*被报道。

应使用正确的自定义组件上传顺序。

# java - 查看/解决 Windows XP 内存碎片的工具

> ID：103622
> 
> 赞同：5
> 
> 时间：2008-09-19T16:48:06.413
> 
> 标签：java, windows, memory, memory-management, windows-xp

我们有一个需要大量堆空间的 java 程序 - 我们以（以及其他命令行参数）参数 -Xmx1500m 开始它，它指定最大堆空间为 1500 MB。在刚刚重新启动的 Windows XP 机器上启动此程序时，它将毫无问题地启动和运行。但是如果程序运行了几次，计算机已经启动了一段时间等，当它尝试启动时，我得到这个错误：

```
初始化虚拟机时出错
无法为对象堆保留足够的空间
无法创建Java虚拟机。

```

我怀疑Windows本身存在内存碎片，但我不知道如何证实这种怀疑。发生这种情况时，任务管理器和 sysinternals procexp 报告 2000MB 可用内存。我看过[这个与内部碎片有关的问题](https://stackoverflow.com/questions/60871/how-to-solve-memory-fragmentation)

所以第一个问题是，我如何确认我的怀疑？第二个问题是，如果我的怀疑是正确的，有没有人知道解决这个问题的任何工具？我环顾四周，但除了定期重新启动机器之外，我没有发现任何有用的东西。

ps - 改变操作系统目前也不是一个可行的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T17:30:10.023

除非您的页面文件空间不足，否则此问题不是计算机内存不足。虚拟内存的全部意义在于允许进程使用比物理可用更多的虚拟内存。

不知道 JVM 是如何处理堆的，很难说到底是什么问题，但常见的问题之一是您的进程中没有足够的连续可用地址空间来允许扩展堆. 为什么在机器运行一段时间后这会成为问题有点令人困惑。

我一直在工作中解决类似的问题。我发现使用 WinDBG 运行程序并使用“！address”和“！address -summary”命令对于追踪进程的虚拟地址空间为何变得碎片化非常有用。您也可以尝试在重新启动后运行程序并使用“！address”命令对地址空间进行拍照，然后在程序不再运行时执行相同操作。这可能会提示您解决问题。也许像加载额外的DLL这样简单的事情可能会导致问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T17:38:02.610

同意 Torlack，这在很大程度上是因为其他 DLL 正在加载并进入某些位置，从而将您可以为 VM 获得的内存量分成一大块。

如果你有超过 3G 的内存来移动一些 Windows 的东西，你可以在 WinXP 上做一些工作，在这里查找 PAE：http: [//www.microsoft.com/whdc/system/platform/server/PAE/ PAEdrv.mspx](http://www.microsoft.com/whdc/system/platform/server/PAE/PAEdrv.mspx)

如果您的 Java 应用程序确实需要超过 1.2G 的内存，您最好的选择是查看 64 位 Windows 或 linux 或 OSX。如果您在应用程序中使用任何类型的本机库，则必须将它们重新编译为 64 位，但这比尝试重新设置 dll 和东西以最大化您可以在 32 位窗口上获得的内存要容易得多.

另一种选择是将您的程序拆分为多个 VM，并让它们通过 RMI 或消息传递或其他方式相互通信。这样，每个 VM 都可以拥有您需要的一些内存子集。在不知道您的应用程序做什么的情况下，我不确定这是否会有所帮助，但是...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T13:55:35.663

我怀疑问题是 Windows 内存碎片。StackOverflow 上还有另一个问题，称为[Windows XP 上的 Java Maximum Memory，](https://stackoverflow.com/questions/171205/java-maximum-memory-on-windows-xp)它提到使用 Process Explorer 查看 DLL 映射到内存的位置，然后通过重新设置 DLL 的基础来解决问题，以便以更紧凑的方式加载到内存中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T17:19:40.720

对该应用程序使用 Minimem ( [http://minimem.kerkia.net/ ) 可能会解决您的问题。](http://minimem.kerkia.net/)但是，我不确定这是您正在寻找的答案。我希望它有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:20:19.363

也许您应该考虑启动程序并保留内存，而不是在每次运行后结束 VM。寻找不同的 GC 选项并释放您的对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-11T09:54:49.240

使用 Microsoft SysInternals 工具中的 vmmap 查看虚拟地址空间的碎片，并确定是什么破坏了空间

# asp.net - jQuery 菜单和 ASP.NET 站点地图

> ID：103630
> 
> 赞同：20
> 
> 时间：2008-09-19T16:49:27.063
> 
> 标签：asp.net, jquery, superfish

是否可以将[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) web.sitemap 与 jQuery [Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/)菜单一起使用？

如果没有，是否有任何基于标准的与浏览器无关的插件可用于 web.sitemap 文件？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-15T11:24:55.053

我在寻找相同答案时发现了这个问题……每个人*都说*有可能，但没有人给出实际的解决方案！我似乎现在可以正常工作了，所以我想我会发布我的发现...

我需要的东西：

*   [Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/#download)，其中还包括一个[jQuery版本](http://jquery.com/)

*   [CSS 友好控制适配器](http://cssfriendly.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=2159)下载 DLL 和 .browsers 文件（分别进入 /bin 和 /App_Browsers 文件夹）

*   [ASP.NET SiteMap](http://msdn.microsoft.com/en-us/library/yy2ykkab.aspx)（web.config 中的 .sitemap XML 文件和`siteMap`提供程序条目）

我的成品`Masterpage.master`有以下`head`标签：

```
<head runat="server">
    <script type="text/javascript" src="/script/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="/script/superfish.js"></script>
    <link href="~/css/superfish.css" type="text/css" rel="stylesheet" media="screen" runat="server" />
    <script type="text/javascript">

        $(document).ready(function() {
        $('ul.AspNet-Menu').superfish();
        }); 

</script>
</head> 
```

这基本上是 jQuery Superfish 菜单工作所需的所有东西。页面内部（菜单所在的位置）如下所示（基于[这些说明](http://www.devx.com/asp/Article/31889)）：

```
<asp:SiteMapDataSource ID="SiteMapDataSource" runat="server"
    ShowStartingNode="false" />
<asp:Menu ID="Menu1" runat="server" 
    DataSourceID="SiteMapDataSource"
    Orientation="Horizontal" CssClass="sf-menu">
</asp:Menu> 
```

根据文档，这似乎应该有效 - 但事实并非如此。原因是`CssClass="sf-menu"`当菜单被渲染并且`<ul>`标签得到一个`class="AspNet-Menu"`. 我以为这条线`$('ul.AspNet-Menu').superfish();`会有所帮助，但它没有。

**还有一件事**

虽然这是一个 hack（请有人指出正确的解决方案），但我能够通过打开`superfish.css`文件并*搜索并用 AspNet-Menu 替换* sf **-** **menu**来使其工作......瞧！菜单出现了。我认为控件中会有一些配置设置，我可以在其中设置类，但没有通过谷歌找到任何提示。**`asp:Menu``<ul>`**

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T22:26:33.367

是的，这是完全可能的。

我已经将它与 ASP:Menu 控件和带有 Superfish 插件的 jQuery 1.2.6 一起使用。请注意，您将需要[ASP.NET 2.0 CSS Friendly Control Adapters](http://www.asp.net/CSSAdapters/Menu.aspx)。

ASP.NET 将 ASP:Menu 控件生成为表格布局。CSS 友好控件适配器将使 ASP.NET 生成 ASP:Menu 控件作为 div 内的 UL/LI 布局。

这将允许轻松集成 jQuery 和 Superfish 插件，因为 Superfish 插件依赖于 UL/LI 布局。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T22:08:19.597

看起来您需要为 Superfish 生成 UL。您应该能够使用站点地图中的 ASP.Net 执行此操作。我认为站点地图控件会做这样的事情。如果没有，直接从 C# 调用站点地图并以编程方式生成 DOM 应该很简单。您可以构建一个用户控件来执行此操作，或者在母版页中执行此操作。

查看[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms178424.aspx)，了解如何以编程方式枚举站点地图中的节点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-16T10:06:00.313

请记住为 NonLink 元素添加 css 类。Superfish css 元素不适合它们。如果你像我一样拥有不是链接的根菜单，那么它会呈现得很糟糕。只需将 AspNet-Menu-NonLink 元素添加到 superfish.css 文件中，它应该可以正常渲染。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:13:54.917

SiteMapDataSource 控件应该能够绑定到任何分层数据绑定控件。我对 superfish 不熟悉，但我知道有很多 jQueryish 控件可以做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-19T17:22:19.697

我创建了一个简洁的小示例项目，您可以在[http://simplesitemenu.codeplex.com/使用](http://simplesitemenu.codeplex.com/)

它是一个复合控件，可从您的站点地图生成嵌套的 UL/LI 列表。

享受！**

# math - 非唯一集的帕斯卡定理？

> ID：103633
> 
> 赞同：3
> 
> 时间：2008-09-19T16:49:44.443
> 
> 标签：math

[当集合包含唯一实体时， Pascal](http://en.wikibooks.org/wiki/Combinatorics/Subsets_of_a_set-The_Binomial_Coefficient)关于计算集合子集的规则非常有效。

当集合包含重复项目时，是否对此规则进行了修改？

例如，当我尝试查找字母 A、B、C、D 的组合计数时，很容易看出它是 1 + 4 + 6 + 4 + 1（来自帕斯卡三角形）= 16，或者 15 如果我删除了“不使用任何字母”条目。

现在，如果这组字母是 A,B,B,B,C,C,D 怎么办？手动计算，我可以确定子集的总和是：1 + 4 + 8 + 11 + 11 + 8 + 4 + 1 = 48，但这不符合我知道的三角形。

问题：如何修改帕斯卡三角形以考虑集合中的重复实体？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T16:52:39.070

一个集合只包含独特的项目。如果有重复，那么它不再是一个集合。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T17:48:45.940

是的，如果您不想考虑集合，请考虑“因素”的概念。有多少因素：

```
p1^a1.p2^a2....pn^an 
```

如果 p1 是不同的素数，则有。如果 ai 都为 1，则数字为 2^n。一般来说，答案是 (a1+1)(a2+1)...(an+1) 正如 David Nehme 所说。

哦，请注意，您的手动答案是错误的，如果您不想计算空集，则应该是 48 或 47。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T17:55:18.717

看起来你想知道有多少子多集有，比如 3 个元素。这个数学变得非常棘手，非常快。这个想法是你想把到达那里的所有方式组合在一起。所以你有 C(3,4) = 4 种没有重复元素的方法。B 可以以 C(1,3) = 3 种方式重复两次。B 可以以 1 种方式重复 3 次。并且 C 可以以 C(1,3) = 3 种方式重复两次。总共11个。（你手头的 10 错了。对不起。）

一般来说，试图做到这一点太难了。跟踪它的更简单方法是写出一个多项式，其系数具有您想要的项，您可以将其相乘。对于帕斯卡三角形，这很容易，多项式是 (1+x)^n。（您可以使用重复平方来更有效地计算。）在您的情况下，如果一个元素重复两次，您将有一个 (1+x+x^2) 因子。3 次将是 (1+x+x^2+x^3)。因此，您的具体问题将解决如下：

```
(1 + x) (1 + x + x^2 + x^3) (1 + x + x^2) (1 + x)
  = (1 + 2x + 2x^2 + 2x^3 + x^4)(1 + 2x + 2x^2 + x^3)
  = 1    + 2x   + 2x^2 +  x^3 +
    2x   + 4x^2 + 4x^3 + 2x^4 +
    2x^2 + 4x^3 + 4x^4 + 2x^5 +
    2x^3 + 4x^4 + 4x^5 + 2x^6 +
    x^4  + 2x^5 + 2x^6 +  x^7
  = 1 + 4x + 8x^2 + 11x^3 + 11x^4 + 8x^5 + 4x^6 + x^7 
```

如果您想在代码中生成这些数字，我会使用多项式技巧来组织您的思维和代码。（您将使用系数数组。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T17:03:06.953

您根本不需要修改帕斯卡三角。研究 C(k,n) 你会发现——你基本上需要除以原始结果来解释等价字母的排列。

例如，A B1 B2 C1 D1 == A B2 B1 C1 D1，因此您需要将 C(5,5) 除以 C(2,2)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T17:10:59.900

如果没有重复项（如早期海报所指出的那样，在集合中），每个元素要么在子集中，要么在子集外。所以你有 2^n 个子集。对于重复项（在“多集合”中），您必须考虑每个元素在“子多集合”中的次数。如果它m_1,m_2...m_n代表每个元素重复的次数，那么子包的个数就是(1+m_1) * (1+m_2) * ... (1+m_n)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T17:00:02.453

尽管数学集合确实包含独特的项目，但在现实编程世界中，您可能会遇到“集合”中重复项目的问题。有关示例，请参见Lisp unions 上的[此线程。](http://groups.google.com/group/comp.lang.lisp/browse_thread/thread/49b04522abaf7f7b/7948ffb8a3acf0f5?lnk=gst&q=reiners+set#7948ffb8a3acf0f5)

# language-agnostic - 为什么默认情况下语言不会在整数溢出时引发错误？

> ID：103654
> 
> 赞同：49
> 
> 时间：2008-09-19T16:53:10.533
> 
> 标签：language-agnostic, integer, language-design, integer-overflow

在几种现代编程语言（包括 C++、Java 和 C#）中，该语言允许在运行时发生[整数溢出](http://en.wikipedia.org/wiki/Integer_overflow)，而不会引发任何类型的错误条件。

例如，考虑这个（人为的）C# 方法，它没有考虑上溢/下溢的可能性。（为简洁起见，该方法也不处理指定列表为空引用的情况。）

```
//Returns the sum of the values in the specified list.
private static int sumList(List<int> list)
{
    int sum = 0;
    foreach (int listItem in list)
    {
        sum += listItem;
    }
    return sum;
} 
```

如果这个方法被调用如下：

```
List<int> list = new List<int>();
list.Add(2000000000);
list.Add(2000000000);
int sum = sumList(list); 
```

方法中会发生溢出`sumList()`（因为`int`C#中的类型是32位有符号整数，列表中的值之和超过了最大32位有符号整数的值）。sum 变量的值为 -294967296（不是 4000000000）；这很可能不是 sumList 方法的（假设的）开发人员想要的。

显然，开发人员可以使用多种技术来避免整数溢出的可能性，例如使用 Java 之类的类型[`BigInteger`](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigInteger.html)，或者 C# 中的[`checked`](http://msdn.microsoft.com/en-us/library/74b4xzyw.aspx)关键字和[`/checked`](http://msdn.microsoft.com/en-us/library/h25wtyxf.aspx)编译器开关。

但是，我感兴趣的问题是为什么这些语言被设计为默认情况下首先允许整数溢出发生，而不是例如在运行时执行操作时引发异常，这会导致溢出。如果开发人员在编写执行可能导致溢出的算术运算的代码时忽略了溢出的可能性，这种行为似乎有助于避免错误。（这些语言可能包含类似“unchecked”关键字之类的东西，它可以指定一个允许发生整数溢出而不引发异常的块，在开发人员明确意图该行为的情况下；C# 实际上[确实有 this](http://msdn.microsoft.com/en-us/library/a569z7k8.aspx) . )

答案是否简单地归结为性能 - 语言设计者不希望他们各自的语言默认具有“慢”算术整数运算，运行时需要做额外的工作来检查每个适用的算术是否发生溢出操作——在发生意外溢出的情况下，这种性能考虑是否超过了避免“静默”故障的价值？

除了性能方面的考虑之外，这种语言设计决策还有其他原因吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-09-20T17:15:15.730

在 C# 中，这是一个性能问题。具体来说，开箱即用的基准测试。

当 C# 刚出现时，微软希望很多 C++ 开发人员会改用它。他们知道许多 C++ 人认为 C++ 速度很快，尤其是比那些在自动内存管理等上“浪费”时间的语言更快。

潜在的采用者和杂志评论者都可能获得新 C# 的副本，安装它，构建一个在现实世界中没人会编写的微不足道的应用程序，在一个紧密的循环中运行它，并测量它花了多长时间。然后他们会为他们的公司做出决定或根据该结果发表一篇文章。

他们的测试表明 C# 比本地编译的 C++ 慢，这一事实会让人们很快放弃 C#。您的 C# 应用程序将自动捕获上溢/下溢这一事实是他们可能会错过的事情。所以，默认情况下它是关闭的。

我认为很明显，99% 的时间我们都希望 /checked 处于打开状态。这是一个不幸的妥协。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-19T16:55:49.297

我认为性能是一个很好的理由。如果您考虑典型程序中增加整数的每条指令，并且如果不是简单的操作来加 1，它必须每次检查加 1 是否会溢出类型，那么额外周期的成本将非常严重。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-19T17:01:33.197

您的工作假设整数溢出总是不受欢迎的行为。

有时整数溢出是期望的行为。我见过的一个例子是将绝对航向值表示为定点数。给定一个无符号整数，0 是 0 或 360 度，最大 32 位无符号整数 (0xffffffff) 是 360 度以下的最大值。

```
int main()
{
    uint32_t shipsHeadingInDegrees= 0;

    // Rotate by a bunch of degrees
    shipsHeadingInDegrees += 0x80000000; // 180 degrees
    shipsHeadingInDegrees += 0x80000000; // another 180 degrees, overflows 
    shipsHeadingInDegrees += 0x80000000; // another 180 degrees

    // Ships heading now will be 180 degrees
    cout << "Ships Heading Is" << (double(shipsHeadingInDegrees) / double(0xffffffff)) * 360.0 << std::endl;

} 
```

可能还有其他可以接受溢出的情况，类似于此示例。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-19T18:12:24.290

C/C++ 从不强制执行陷阱行为。即使是明显的除以 0 也是 C++ 中未定义的行为，而不是特定类型的陷阱。

C 语言没有任何捕获的概念，除非您计算信号。

C++ 有一个设计原则，即除非您要求，否则它不会引入 C 中不存在的开销。所以 Stroustrup 并不想强制要求整数的行为方式需要任何显式检查。

一些早期的编译器和受限硬件的轻量级实现根本不支持异常，并且通常可以使用编译器选项禁用异常。强制语言内置例外是有问题的。

即使 C++ 已经检查了整数，如果为了性能提升而关闭，早期 99% 的程序员也会关闭...

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-19T16:57:42.007

因为检查溢出需要时间。通常转换为单个汇编指令的每个原始数学运算都必须包括检查溢出，从而导致多个汇编指令，可能导致程序慢几倍。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-19T16:56:57.983

这可能是 99% 的性能。在 x86 上，必须检查每个操作的溢出标志，这将对性能造成巨大影响。

其他 1% 将涵盖那些人们正在做花哨的位操作或在混合有符号和无符号操作时“不精确”并想要溢出语义的情况。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-19T16:59:59.893

向后兼容性是一个大问题。对于 C，假设您对数据类型的大小给予了足够的关注，以至于如果发生上溢/下溢，那就是您想要的。然后是 C++、C# 和 Java，“内置”数据类型的工作方式几乎没有改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-17T21:31:43.873

如果整数溢出被定义为立即引发信号、抛出异常或以其他方式转移程序执行，那么任何可能溢出的计算都需要按指定的顺序执行。即使在整数溢出检查不会直接花费任何成本的平台上，将整数溢出捕获在程序执行序列中的正确点的要求也会严重阻碍许多有用的优化。

如果一种语言要指定整数溢出将设置一个锁存错误标志，则要限制函数内对该标志的操作如何影响其在调用代码中的值，并规定在以下情况下不需要设置标志溢出不会导致错误的输出或行为，然后编译器可以生成比程序员可以使用的任何类型的手动溢出检查更有效的代码。举个简单的例子，如果 C 中有一个函数可以将两个数字相乘并返回一个结果，并在溢出的情况下设置一个错误标志，那么无论调用者是否会使用结果，都需要编译器来执行乘法运算. 然而，在我所描述的规则较宽松的语言中，

From a practical standpoint, most programs don't care about precisely when overflows occur, so much as they need to guarantee that they don't produce erroneous results as a consequence of overflow. Unfortunately, programming languages' integer-overflow-detection semantics have not caught up with what would be necessary to let compilers produce efficient code.

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-09-19T16:59:17.447

我对为什么默认情况下不会在运行时引发错误的理解归结为希望创建具有类似 ACID 行为的编程语言的遗留问题。具体来说，您编写的任何代码（或不编写代码）都会执行（或不执行）的原则。如果你没有编写一些错误处理程序，那么机器会因为没有错误处理程序而“假设”你真的想做你告诉它去做的荒谬的、容易崩溃的事情。

（酸参考：[http](http://en.wikipedia.org/wiki/ACID) ://en.wikipedia.org/wiki/ACID ）

# c - 是什么让你成为 C 编程专家？

> ID：103669
> 
> 赞同：25
> 
> 时间：2008-09-19T16:55:46.440
> 
> 标签：c

我昨天参加了一个招聘会，一位开发人员问我如何对我的 C 语言熟练程度进行排名。然后我意识到这是非常随意的，几乎不可能确定，所以我的问题是什么知识让你成为 C 编程专家？

编辑：或者故障是什么？是什么让你变得优秀、体面、精通等等。

再次编辑：我更多的是寻找技能列表或其他一些建设性的衡量标准来判断自己对 C 的熟练程度，因为这很难做到。

到目前为止的清单：

*   大型项目经验
*   掌握指针（和内存管理，我假设）
*   精通调试器（gdb，...）
*   掌握分析器（gprof，...）
*   掌握内存分析器（valgrind，...）
*   基本标准知识

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-19T17:10:52.847

我认为这个问题的问题在于答案是毫无意义的。我看到人们谈论经验，这很好，我看到人们谈论理解语言的复杂性，这很好。但是，如果我正在雇用某人从事我的 C 项目，并且我有一个神奇的 8 球，可以准确回答任何一个（并且只有一个）问题，我永远不会问它，“他们是 C专家”。

为什么？

仅仅因为某人是 C 专家并不意味着他们是优秀的软件开发人员。经验和语言熟悉度很好，但我认为它们都被无形的、不可量化的属性压倒了，这使得某人成为“优秀的软件开发人员”。我想说的是，“是什么让你成为 C 编程专家？” 不是一个有用的问题，因为还有更重要的问题。如果某人是一名优秀的**程序员**，他们就会迎难而上**。**

 **举个例子：你可能是一名 C 编程专家，但在团队中表现得很糟糕。你可以是 C 编程专家并拒绝使用版本控制。你可以成为一名 C 编程专家，却不知道如何用 C 实际做**任何**事情。

这些句子中的“without”子句同样重要：是什么让你成为一名优秀的团队程序员？*使用 SCM x*或*y*的最佳方式是什么？您如何使用 C 语言编写客户端/服务器游戏、计费应用程序、Web 浏览器、操作系统或编译器？如果应聘者告诉我“不，我不是 C 专家”，但对这些其他问题给出了很好的答案，我会立即雇用他们，而不是那个魔术 8 球说是 C 专家，但没有不知道如何将他的代码检查为 subversion，并且 12 年没有学习一门新语言。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-19T17:01:47.567

我在谷歌面试的时候，面试官告诉我要这样想。在 C 语言熟练度 1-10 的范围内，说你是“10”意味着你写过论文和/或书籍，或者在 C 编程会议上发表过演讲。基于此，很少有人是10 秒。

FWIW，我已经用 C 语言编程了 15 年。我认为自己非常熟练。我可能会给自己一个可靠的 8 或 8.5。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-19T17:00:27.320

对于比你技术差的人，你是专家。

对于比你更熟练的人来说，你是一个新手。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-19T17:06:49.893

经验是关键，了解语言的“规则”和语法当然是必须的，但这只是一个基础。学习正确做事的常见陷阱和习语是关键。

知道是否有任何资源可以在您的编程时获得帮助，当然，知道您是工具链。我认识许多从未使用过调试器或内存跟踪器的 C++“专家”。如果你问我，成为某事的专家不同于精通某事的所有方面。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-19T16:58:40.273

每个人都是招聘会上的专家

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-19T16:58:14.687

如果您可以回答 stackoverflow.com 上所有标记为“c”的问题而不眨眼，那么您就是 c 专家。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-19T17:28:57.593

这并不能直接回答您的问题（抱歉），但它可能会帮助您决定如何对自己进行分类。

我更喜欢中世纪公会使用的三级专业知识系统，而不仅仅是“专家”和“无知的新手”：

### 学徒

*   还是需要RTFM。
*   掌握他手艺的工具和技术。
*   需要监督。

### 熟练工

*   已阅读 Effin 手册。
*   精通其工艺的所有标准工具和技术。
*   可以单独工作，并可以监督学徒的日常工作。

### 掌握

*   可以写艾芬手册。
*   正在开发或采用新的工具和技术。
*   可以监督以前可能从未尝试过的重大项目。

在招聘会上？没有专家：每个人都是专家。:)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-19T16:59:43.937

有些人可能不同意，但我认为经验是成为任何语言专家的关键。我认识很多人通过了认证考试，但无法将他们的知识应用于现实世界中的任何实际事情。

因此，我认为总体而言，成为专家是对给定主题 (C) 拥有足够知识的产物，然后将其应用到足够多的现实世界场景中，以犯我们所有人都会犯的错误并从中吸取教训。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-21T00:00:36.317

这个问题的答案确实有助于阅读一些有趣的内容 - 似乎我们无法在这里很好地理解专家的定义。在像招聘会这样更广泛的论坛上会有什么希望？:-)

但是把我自己的 2 美分放进去……我认为有两种 C 专家。

*   有学术意义上的专家（如“可以编写自己的编译器”、“已写论文”）。
*   有务实的专家。我想将其定义为“可以编写任何人都可以理解的优雅 C 代码的*人”。*

我会在心跳中选择后者而不是前者。如果您有一段由专家编写的代码非常脆弱，只能由另一位专家阅读和理解，那么无论如何，该代码是不可维护的。这段代码的作者在表达式中间记住了类型转换的复杂性，这一切都很好，但是如果代码已经编写成完全明确的，那就更好了。

项目通常有足够的技术挑战，而不需要所有团队成员都记住 C'99 标准。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-19T17:13:39.987

当您可以编写自己的 C 编译器时，您就是 C 专家。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T17:03:11.197

像这样的面试问题总是很棘手。你想吹自己的号角，但听起来不像吹牛。

如果你在 C 方面做了很多工作（例如，在 C 中从事开源项目），那么我会这样回应，但不仅仅是通过指出你简历上的成就列表，而是通过谈论一个或多个它们以及它特别有趣或具有挑战性的地方（关于它对 C 的使用）。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-19T17:03:34.940

阅读 Peter van der Linden 的“专家 C 编程”并记住他所涵盖的所有内容怎么样？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-19T17:09:07.250

缺乏标准测试，真的无法确定专家级别是多少，但这里有一些我的试金石，每个人的清单都不一样，我敢肯定。

不看文档：

*   了解主要运算符的优先级，这样您就不必在代码中乱扔括号以避免得到错误的评估顺序

*   能够为简单的函数指针编写原型

*   习惯于将指针传递给指针

*   了解块、函数、模块范围

这样的项目还有很多。

另一方面，我不认为你必须能够理解或能够写出 Duff 的设备，或者在你的脑海中找出混淆的 C 竞赛来认为自己是专家。

即使我认为自己是专家（我不确定），我也可能永远不会在工作面试中声称自己是专家。

安德鲁

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-19T17:00:26.210

掌握指针。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-19T17:01:07.613

我想说，对于任何给定的语言，经验都是关键。学习一门语言并学习该语言使用的 API 和“习语”只需要时间。一个人是否是某方面的专家是应该向同龄人询问的事情。套用 Jeff Foxworthy 的话说，“如果你回答的问题多于你提出的问题，那么你*可能*是专家。”

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-19T17:02:08.827

我认为一个公平的答案是理解 ISO C 的所有细节。

事实上，正如任何 comp.lang.c 的常客都会告诉您的那样，人们需要做的几乎所有事情都不能在纯 ISO C 中完成，因为您通常需要以更明确的方式与您的环境进行交互。这就是 POSIX 的由来。

我不会对任何自称为“专家”的人眨眼，他们对 C 语言有深刻的理解，对 ISO C 的承诺有很好的理解，并且对 POSIX 函数有实际的理解。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-11-16T23:08:12.463

能够写论文/书籍并不一定会让一个人成为专家级程序员。这需要大量的努力、实践经验和对各种 C 库的良好理解。

祝你好运！**

# database - 可测试性的最佳数据库访问模式是什么？

> ID：103676
> 
> 赞同：1
> 
> 时间：2008-09-19T16:57:03.567
> 
> 标签：database, testing, design-patterns, data-access

我已经阅读并涉足了一些内容，包括活动记录、存储库、数据传输对象。哪个最好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T16:59:13.483

“最佳”问题并不是真正有效的。世界充满了组合和变化。您应该从必须回答的问题开始：您要解决什么问题。在您回答后，您会查看最适合该问题的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T17:05:21.223

虽然我同意“最佳”问题不是最好的形式（因为它们是如此武断），但它们也不是完全不相关的。

在 SO 构建的世界中，开发人员对什么是“最好的”进行投票，为什么不提出最好的问题呢？“最佳问题”引发讨论和不同意见。

最终，当有人“谷歌”搜索“数据访问模式”时，他们应该会来到这个页面并看到[大量](http://www.youtube.com/watch?v=b6E682C7Jj4)答案，对吧？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-20T03:56:32.733

这真的取决于你的任务。至少您应该了解并*了解*所有数据库访问模式，以选择最适合当前问题的一种。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T17:26:45.827

这是一个很好的问题，应该引起一些思考。
数据库访问通常不需要经过严格的测试——尤其是自动化测试，我当然想增加对我的数据库的测试量。

我正在使用从 Visual Studio 内部运行的 MbUnit 测试框架进行一些测试。
我们的应用程序尽可能使用存储过程，并且我编写的测试设置了用于测试的数据库、调用存储过程并检查结果。
对于相关存储过程的集合，我们有一个 C# 文件，其中包含对这些存储过程的测试。（然而，到目前为止，我们的覆盖率可能约为 1%！）。

活动记录是一个有吸引力的选择，因为 Ruby 内置强调自动化测试。如果我重新开始，那将是使用活动记录的重点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T09:03:18.820

存储库可能是可测试性的最佳模式，因为它允许您在需要测试时用模拟替换存储库。ActiveRecord 将您的模型与数据库联系起来（有时很方便，但通常更难测试）。

# .net - Machine.Migrations 成熟到可以使用？

> ID：103677
> 
> 赞同：1
> 
> 时间：2008-09-19T16:57:07.640
> 
> 标签：.net, database

好的，感谢我找到代码的第一个人。

Machine.Migrations：我的意思是，数据模式/数据迁移框架。

我的意思是，这里提到的那个： [http ://blog.eleutian.com/2008/04/25/AFirstLookAtMachineMigrations.aspx](http://blog.eleutian.com/2008/04/25/AFirstLookAtMachineMigrations.aspx)

好的，有人用过吗？我想我想在我的项目中有这样的框架（我一直在使用 Rails，这样的框架有助于使迁移更加系统化）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T17:07:21.733

它是博客作者编写的一个实验库。

见[http://blog.eleutian.com/Default.aspx#a2e4f933f-e00c-445e-ab64-17bf9a64d96f](http://blog.eleutian.com/Default.aspx#a2e4f933f-e00c-445e-ab64-17bf9a64d96f)

该帖子底部有一个链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-17T09:49:39.117

我刚刚发布了一个名为 Mig# 的新迁移库。你可以在 GitHub 上找到它：[https ://github.com/dradovic/MigSharp](https://github.com/dradovic/MigSharp)

它应该足够成熟，因为我们在我的工作场所使用它来编写高效的代码。

Mig# 目前提供对 SQL Server 2005/2008/CE 4、Oracle 和 Teradata 的支持。最重要的是，您可以获得一个漂亮的验证框架等等（请参阅[https://github.com/dradovic/MigSharp/wiki/Feature-Overview](https://github.com/dradovic/MigSharp/wiki/Feature-Overview)）。

# javascript - 什么是避免对象命名空间冲突的 javascript 哈希表实现？

> ID：103679
> 
> 赞同：2
> 
> 时间：2008-09-19T16:57:32.553
> 
> 标签：javascript, hash, diff, adobe-indesign

首先：我正在使用一个相当晦涩的嵌入 javascript 实现作为 Adob​​e InDesign CS3 的脚本引擎。这种实现有时与“标准”javascript不同，因此是我的问题。

我正在使用[John Resig 的 jsdiff 库](http://ejohn.org/projects/javascript-diff-algorithm/)（[来源此处](http://ejohn.org/files/jsdiff.js)）来比较两个文档之间的文本选择。jsdiff 使用 vanilla 对象作为关联数组来将文本中的单词映射到另一个对象。（参见 jsdiff.js 中的“ns”和“os”变量，第 129 行左右。）

当文本中出现“反射”这个词时，我的头痛就开始了。“反射”是*所有*对象的默认*只读*属性。当 jsdiff 尝试将关联数组上的值分配给 ns['reflect'] 时，一切都会爆炸。

 *我的问题：有没有办法解决这个问题？有没有办法在不使用明显的香草对象的情况下在 javascript 中做一个哈希表？

**基本规则：**切换脚本引擎不是一种选择。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T17:19:12.423

你可能“问错了问题”（正如 Raymond Chen 所说）；与其尝试避免使用 vanilla 对象，不如尝试更改关联数组成员的命名方式。

我尝试解决这个问题的方式：不存在数组成员 ns["reflect"]，而是更改 jsdiff 构建数组的方式，以便成员为 ns["_reflect"] 或其他一些变体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:46:12.200

如果您使用的 JS 实现支持对象的 hasOwnProperty 方法，您可以使用它来测试是否为对象显式设置了属性，或者该属性是从其原型继承的。例子：

```
if(object.hasOwnProperty('testProperty')){
     // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:14:24.663

好的，javascript 中的对象只是关联数组，实际上没有另一个内置的哈希解决方案。您可以通过在一些数组周围包装一个类来创建自己的伪哈希表，尽管所涉及的手动工作可能会对性能造成重大影响。

只是一个旁注，我没有真正使用或查看过 jsdiff 库，所以我无法根据提示或技巧提供任何有效的见解。*

# visual-studio - ReportViewer 在打印布局模式下显示黑色背景

> ID：103688
> 
> 赞同：4
> 
> 时间：2008-09-19T16:58:49.243
> 
> 标签：visual-studio, reporting-services, reportviewer

在我的 ReportViewer 控件中，当我单击打印布局时，报表的背景变为黑色。这一定是个bug。有解决方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T19:19:52.257

Microsoft 已经意识到这个问题，它的 KB 位于[此处](http://blog.n-technologies.be/ct.ashx?id=dfa6b270-0143-4389-9f5d-725b8eb95d3c&url=http%3a%2f%2fsupport.microsoft.com%2fkb%2f935436)。

您可以通过安装 Cumulative Update 1 (build 3161) 来解决该问题，可以通过以下 Microsoft[页面请求下载](http://support.microsoft.com/kb/935356/en-us)

如果您可以再等一会儿，我认为 SQL Server 2005 SP3 将提供此修复程序

# php - PHP/JS - 即时创建缩略图或存储为文件

> ID：103707
> 
> 赞同：2
> 
> 时间：2008-09-19T17:00:30.097
> 
> 标签：php, javascript, image, image-manipulation, thumbnails

对于图像托管 Web 应用程序：

对于我存储的图像，使用 PHP（或其他）动态创建缩略图是否可行，或者我应该将 1 个或多个不同大小的缩略图保存到磁盘并加载它们？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T17:06:55.087

将缩略图保存到磁盘。图像处理会占用大量资源，并且根据图像的大小，可能会超过 php.ini 的默认允许内存限制。如果您拥有自己的服务器并且只运行您的应用程序，那么这不是一个问题，但它仍然需要大量的 CPU 功率和内存来调整图像大小。如果您正在考虑即时创建缩略图，则无需进行太多更改 - 在第一次请求时，从源文件创建缩略图，将其保存到磁盘，然后在后续请求时从磁盘读取它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T21:54:12.230

我使用[phpThumb](http://phpthumb.sourceforge.net/)，因为它是两全其美的。您可以即时创建缩略图，但它会自动缓存图像以加快未来的请求。它围绕 GD 和 ImageMagick 库创建了一个很好的包装器。值得一看！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:04:00.633

缓存缩略图会好得多。动态生成它们会对系统造成很大的负担。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T17:12:23.890

这取决于网站的使用模式，但是，基本上，您希望每张图片被查看多少次？

在缩略图的情况下，它们很可能会存在很长一段时间（图像上传一次并且从未更改，因此缩略图也不会更改），因此通常值得在上传完整图像时生成并将它们存储起来以备后用。除非该站点完全死机，否则它们将在其生命周期内被查看很多次（数百或数千次），并且这些天磁盘比延迟便宜得多。当然，随着服务器负载的增加，这也变得更加重要。

相反，对于像股票图表这样每小时更新一次（如果不是更频繁的话）的东西，在这种情况下你最好动态创建它们，以避免浪费 CPU 时间来不断生成图像用户将永远看到。

或者，如果您想变得花哨，您可以优化处理任一访问模式，方法是在第一次需要时动态生成图像，然后再显示预生成的图像，直到它从更改生成的数据，此时您将其删除，以便下次需要时重新生成它。但这对于像缩略图这样静态的东西，IMO 来说太过分了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:02:20.840

查看[gd 库](http://us2.php.net/gd)和[imagemagick](http://us2.php.net/manual/en/book.imagick.php)

# asp.net - ASP.Net 3.5 DetailsView 控件中消失的复选框标签

> ID：103708
> 
> 赞同：0
> 
> 时间：2008-09-19T17:00:34.590
> 
> 标签：asp.net, webforms, checkbox, detailsview

我有一个带有按钮和 DetailsView 控件的 Web 表单。在按钮的单击事件中，我将 DetailsView 控件更改为插入模式，以便添加记录：

DetailsView1.ChangeMode(DetailsViewMode.Insert)

一切正常，除了 DetailsView 中的一个复选框。当 DetailsView 进入插入模式时，描述复选框用途的文本会消失。复选框本身工作正常。

为什么我的文字消失了，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T19:31:45.770

我能够通过将其更改为模板字段来解决我的问题。不知道为什么它不能以另一种方式工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:04:54.907

标签中的文本是否位于项目模板中？如果是这样，您需要将其添加到编辑项目模板。还要检查控件的宽度是否足以容纳所有控件和文本。由于绝对定位，它可能会被隐藏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T18:12:37.833

感谢您的快速回复。文本不在模板中。它只是一个将 Text 属性设置为“Active”的 CheckBoxField：

我尝试扩大字段和 DetailsView 控件，但单击按钮时文本仍然消失。

# apache-flex - 有没有办法让 FlexBuilder 3 将项目视为应用程序和库？

> ID：103723
> 
> 赞同：2
> 
> 时间：2008-09-19T17:03:00.247
> 
> 标签：apache-flex, flexbuilder

我的团队为其他（内部）软件开发团队构建可重用的库。我们使用 FlexBuilder 3 作为我们的开发环境。我们的 SCM 标准规定这些项目必须包括测试工具和单元测试运行器，并且（当然）我们希望能够使用调试器。因此，所有项目都是应用程序。

我们的构建脚本（主要用于 CI 系统和发布部署）构建我们实际的库，效果很好。使用这种方法是为了不需要 FlexBuilder 来实际构建我们的生产工件（在命令行上）。

问题是——为了将 FlexBuilder 项目添加到应用程序的库路径中，它必须是库项目。我已经尝试为我们想要包含的项目添加一个性质，但还没有让它工作。如果您想在另一个项目中调试源文件，您会想要这样做。

一个简单（但令人讨厌）的解决方法是将“库项目”的源文件夹作为源文件夹包含在“应用程序项目”中。这很烦人，因为在“库项目”的 swc 和项目本身的源文件夹之间交换需要多个步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T07:09:31.957

我还建议将其分解为 2 个项目。有 1 个库项目和 1 个用于测试和测试运行程序的应用程序。

附带说明：FlexBuilder 4 将支持在 IDE 中运行 FlexUnit 测试，包括 Flex 应用程序和 Flex 库项目。因此，您不必仅仅为了运行测试而维护应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T20:05:00.917

假设有可能，我建议调整您的 SCM 标准以允许测试工具和单元测试运行器存在于其他项目中。只需要求任何库项目都必须包含一个配套的测试项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T20:42:31.533

我不知道这会让它变得更容易，但我实际上会让库和测试工具成为单独的项目。这将允许您对每个源代码进行控制，并解决您使用 flexbuilder 的问题。它不会使它更容易使用，但它会更干净，最容易更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T21:35:05.127

我没有完全理解您对情况的描述，但如果它有帮助，我将描述我们如何组织我们的 Flex 项目。我们的大部分应用程序代码都包含在 SWC（“库”）项目中。然后，我们创建两个 SWF（“应用程序”）项目 - 一个代表最终输出 SWF 的“外壳”应用程序，以及一个测试工具 FlexUnit 2 应用程序。这两个 SWF 项目都使用源路径引用 SWC 项目。使用这种方法使得在 SWC 中启用应用程序代码库的单元测试变得轻而易举。

# asp.net - 有没有办法以编程方式确定字体文件是否具有特定的 Unicode 字形？

> ID：103725
> 
> 赞同：32
> 
> 时间：2008-09-19T17:03:07.313
> 
> 标签：asp.net, vb.net, unicode, fonts

我正在开发一个项目，该项目可以生成包含相当复杂的数学和科学公式的 PDF。文本以 Times New Roman 呈现，它具有很好的 Unicode 覆盖率，但并不完整。我们有一个系统可以为在 TNR 中没有字形的代码点（如大多数“陌生”数学符号）交换更 Unicode 完整的字体，但我似乎找不到查询的方法*.ttf 文件以查看是否存在给定的字形。到目前为止，我只是硬编码了一个存在哪些代码点的查找表，但我更喜欢自动解决方案。

我在 ASP.net 下的 Web 系统中使用 VB.Net，但任何编程语言/环境中的解决方案都将不胜感激。

编辑：win32 解决方案看起来很棒，但我要解决的具体情况是在 ASP.Net Web 系统中。有没有办法在我的网站中不包含 Windows API DLL 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T17:22:52.163

这是一个使用 c# 和 windows API 的通行证。

```
[DllImport("gdi32.dll")]
public static extern uint GetFontUnicodeRanges(IntPtr hdc, IntPtr lpgs);

[DllImport("gdi32.dll")]
public extern static IntPtr SelectObject(IntPtr hDC, IntPtr hObject);

public struct FontRange
{
    public UInt16 Low;
    public UInt16 High;
}

public List<FontRange> GetUnicodeRangesForFont(Font font)
{
    Graphics g = Graphics.FromHwnd(IntPtr.Zero);
    IntPtr hdc = g.GetHdc();
    IntPtr hFont = font.ToHfont();
    IntPtr old = SelectObject(hdc, hFont);
    uint size = GetFontUnicodeRanges(hdc, IntPtr.Zero);
    IntPtr glyphSet = Marshal.AllocHGlobal((int)size);
    GetFontUnicodeRanges(hdc, glyphSet);
    List<FontRange> fontRanges = new List<FontRange>();
    int count = Marshal.ReadInt32(glyphSet, 12);
    for (int i = 0; i < count; i++)
    {
        FontRange range = new FontRange();
        range.Low = (UInt16)Marshal.ReadInt16(glyphSet, 16 + i * 4);
        range.High = (UInt16)(range.Low + Marshal.ReadInt16(glyphSet, 18 + i * 4) - 1);
        fontRanges.Add(range);
    }
    SelectObject(hdc, old);
    Marshal.FreeHGlobal(glyphSet);
    g.ReleaseHdc(hdc);
    g.Dispose();
    return fontRanges;
}

public bool CheckIfCharInFont(char character, Font font)
{
    UInt16 intval = Convert.ToUInt16(character);
    List<FontRange> ranges = GetUnicodeRangesForFont(font);
    bool isCharacterPresent = false;
    foreach (FontRange range in ranges)
    {
        if (intval >= range.Low && intval <= range.High)
        {
            isCharacterPresent = true;
            break;
        }
    }
    return isCharacterPresent;
} 
```

然后，给定一个要检查的 char toCheck 和一个 Font theFont 来测试它...

```
if (!CheckIfCharInFont(toCheck, theFont) {
    // not present
} 
```

使用 VB.Net 的相同代码

```
<DllImport("gdi32.dll")> _
Public Shared Function GetFontUnicodeRanges(ByVal hds As IntPtr, ByVal lpgs As IntPtr) As UInteger
End Function  

<DllImport("gdi32.dll")> _
Public Shared Function SelectObject(ByVal hDc As IntPtr, ByVal hObject As IntPtr) As IntPtr
End Function  

Public Structure FontRange
    Public Low As UInt16
    Public High As UInt16
End Structure  

Public Function GetUnicodeRangesForFont(ByVal font As Font) As List(Of FontRange)
    Dim g As Graphics
    Dim hdc, hFont, old, glyphSet As IntPtr
    Dim size As UInteger
    Dim fontRanges As List(Of FontRange)
    Dim count As Integer

    g = Graphics.FromHwnd(IntPtr.Zero)
    hdc = g.GetHdc()
    hFont = font.ToHfont()
    old = SelectObject(hdc, hFont)
    size = GetFontUnicodeRanges(hdc, IntPtr.Zero)
    glyphSet = Marshal.AllocHGlobal(CInt(size))
    GetFontUnicodeRanges(hdc, glyphSet)
    fontRanges = New List(Of FontRange)
    count = Marshal.ReadInt32(glyphSet, 12)

    For i = 0 To count - 1
        Dim range As FontRange = New FontRange
        range.Low = Marshal.ReadInt16(glyphSet, 16 + (i * 4))
        range.High = range.Low + Marshal.ReadInt16(glyphSet, 18 + (i * 4)) - 1
        fontRanges.Add(range)
    Next

    SelectObject(hdc, old)
    Marshal.FreeHGlobal(glyphSet)
    g.ReleaseHdc(hdc)
    g.Dispose()

    Return fontRanges
End Function  

Public Function CheckIfCharInFont(ByVal character As Char, ByVal font As Font) As Boolean
    Dim intval As UInt16 = Convert.ToUInt16(character)
    Dim ranges As List(Of FontRange) = GetUnicodeRangesForFont(font)
    Dim isCharacterPresent As Boolean = False

    For Each range In ranges
        If intval >= range.Low And intval <= range.High Then
            isCharacterPresent = True
            Exit For
        End If
    Next range
    Return isCharacterPresent
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T18:14:53.000

斯科特的回答很好。如果只检查每个字体的几个字符串（在我们的例子中每个字体一个字符串），这是另一种可能更快的方法。但如果您使用一种字体检查大量文本，可能会更慢。

```
 [DllImport("gdi32.dll", EntryPoint = "CreateDC", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr CreateDC(string lpszDriver, string lpszDeviceName, string lpszOutput, IntPtr devMode);

    [DllImport("gdi32.dll", ExactSpelling = true, SetLastError = true)]
    private static extern bool DeleteDC(IntPtr hdc);

    [DllImport("Gdi32.dll")]
    private static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);

    [DllImport("Gdi32.dll", CharSet = CharSet.Unicode)]
    private static extern int GetGlyphIndices(IntPtr hdc, [MarshalAs(UnmanagedType.LPWStr)] string lpstr, int c,
                                              Int16[] pgi, int fl);

    /// <summary>
    /// Returns true if the passed in string can be displayed using the passed in fontname. It checks the font to 
    /// see if it has glyphs for all the chars in the string.
    /// </summary>
    /// <param name="fontName">The name of the font to check.</param>
    /// <param name="text">The text to check for glyphs of.</param>
    /// <returns></returns>
    public static bool CanDisplayString(string fontName, string text)
    {
        try
        {
            IntPtr hdc = CreateDC("DISPLAY", null, null, IntPtr.Zero);
            if (hdc != IntPtr.Zero)
            {
                using (Font font = new Font(new FontFamily(fontName), 12, FontStyle.Regular, GraphicsUnit.Point))
                {
                    SelectObject(hdc, font.ToHfont());
                    int count = text.Length;
                    Int16[] rtcode = new Int16[count];
                    GetGlyphIndices(hdc, text, count, rtcode, 0xffff);
                    DeleteDC(hdc);

                    foreach (Int16 code in rtcode)
                        if (code == 0)
                            return false;
                }
            }
        }
        catch (Exception)
        {
            // nada - return true
            Trap.trap();
        }
        return true;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:14:29.640

[FreeType](http://www.freetype.org/)是一个可以读取 TrueType 字体文件（以及其他）的库，可用于查询特定字形的字体。但是，FreeType 是为渲染而设计的，因此使用它可能会导致您引入比此解决方案所需的更多代码。

不幸的是，即使在 OpenType / TrueType 字体的世界中也没有真正明确的解决方案。字符到字形的映射有十几种不同的定义，具体取决于字体类型和最初设计的平台。您可能会尝试查看Microsoft 的[OpenType 规范副本中的](http://www.microsoft.com/typography/otspec/otff.htm)[cmap 表定义](http://www.microsoft.com/typography/otspec/cmap.htm)，但这并不容易阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T14:20:52.013

Scott Nichols 发布的代码非常棒，除了一个错误：如果字形 id 大于 Int16.MaxValue，则会引发 OverflowException。为了修复它，我添加了以下功能：

```
Protected Function Unsign(ByVal Input As Int16) As UInt16
    If Input > -1 Then
        Return CType(Input, UInt16)
    Else
        Return UInt16.MaxValue - (Not Input)
    End If
End Function 
```

然后将函数 GetUnicodeRangesForFont 中的主 for 循环更改为如下所示：

```
For i As Integer = 0 To count - 1
    Dim range As FontRange = New FontRange
    range.Low = Unsign(Marshal.ReadInt16(glyphSet, 16 + (i * 4)))
    range.High = range.Low + Unsign(Marshal.ReadInt16(glyphSet, 18 + (i * 4)) - 1)
    fontRanges.Add(range)
Next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:15:55.300

这篇 Microsoft 知识库文章可能会有所帮助：http: [//support.microsoft.com/kb/241020](http://support.microsoft.com/kb/241020)

它有点过时（最初是为 Windows 95 编写的），但一般原则可能仍然适用。示例代码是 C++，但由于它只是调用标准的 Windows API，因此它很可能也可以在 .NET 语言中工作，而且需要一点麻烦。

-Edit- 似乎旧的 95 时代 API 已被微软称为“ [Uniscribe](http://msdn.microsoft.com/en-us/library/ms776488(VS.85).aspx) ”的新 API 淘汰，它应该能够做你需要做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-26T02:53:54.390

我只用了一个 VB.Net 单元测试，没有 WIN32 API 调用。它包括检查特定字符 U+2026（省略号）和 U+2409（HTab）的代码，还返回具有字形的字符数（以及低值和高值）。我只对等宽字体感兴趣，但很容易改变......

```
 Dim fnt As System.Drawing.Font, size_M As Drawing.Size, size_i As Drawing.Size, size_HTab As Drawing.Size, isMonospace As Boolean
    Dim ifc = New Drawing.Text.InstalledFontCollection
    Dim bm As Drawing.Bitmap = New Drawing.Bitmap(640, 64), gr = Drawing.Graphics.FromImage(bm)
    Dim tf As Windows.Media.Typeface, gtf As Windows.Media.GlyphTypeface = Nothing, ok As Boolean, gtfName = ""

    For Each item In ifc.Families
        'TestContext_WriteTimedLine($"N={item.Name}.")
        fnt = New Drawing.Font(item.Name, 24.0)
        Assert.IsNotNull(fnt)

        tf = New Windows.Media.Typeface(item.Name)
        Assert.IsNotNull(tf, $"item.Name={item.Name}")

        size_M = System.Windows.Forms.TextRenderer.MeasureText("M", fnt)
        size_i = System.Windows.Forms.TextRenderer.MeasureText("i", fnt)
        size_HTab = System.Windows.Forms.TextRenderer.MeasureText(ChrW(&H2409), fnt)
        isMonospace = size_M.Width = size_i.Width
        Assert.AreEqual(size_M.Height, size_i.Height, $"fnt={fnt.Name}")

        If isMonospace Then

            gtfName = "-"
            ok = tf.TryGetGlyphTypeface(gtf)
            If ok Then
                Assert.AreEqual(True, ok, $"item.Name={item.Name}")
                Assert.IsNotNull(gtf, $"item.Name={item.Name}")
                gtfName = $"{gtf.FamilyNames(Globalization.CultureInfo.CurrentUICulture)}"

                Assert.AreEqual(True, gtf.CharacterToGlyphMap().ContainsKey(AscW("M")), $"item.Name={item.Name}")
                Assert.AreEqual(True, gtf.CharacterToGlyphMap().ContainsKey(AscW("i")), $"item.Name={item.Name}")

                Dim t = 0, nMin = &HFFFF, nMax = 0
                For n = 0 To &HFFFF
                    If gtf.CharacterToGlyphMap().ContainsKey(n) Then
                        If n < nMin Then nMin = n
                        If n > nMax Then nMax = n
                        t += 1
                    End If
                Next
                gtfName &= $",[x{nMin:X}-x{nMax:X}]#{t}"

                ok = gtf.CharacterToGlyphMap().ContainsKey(AscW(ChrW(&H2409)))
                If ok Then
                    gtfName &= ",U+2409"
                End If
                ok = gtf.CharacterToGlyphMap().ContainsKey(AscW(ChrW(&H2026)))
                If ok Then
                    gtfName &= ",U+2026"
                End If
            End If

            Debug.WriteLine($"{IIf(isMonospace, "*M*", "")} N={fnt.Name}, gtf={gtfName}.")
            gr.Clear(Drawing.Color.White)
            gr.DrawString($"Mi{ChrW(&H2409)} {fnt.Name}", fnt, New Drawing.SolidBrush(Drawing.Color.Black), 10, 10)
            bm.Save($"{fnt.Name}_MiHT.bmp")
        End If
    Next 
```

输出是

> *M* N=Consolas，gtf=Consolas，[x0-xFFFC]#2488，U+2026。
> 
> *M* N=Courier New, gtf=Courier New,[x20-xFFFC]#3177,U+2026。
> 
> *M* N=Lucida 控制台，gtf=Lucida 控制台，[x20-xFB02]#644，U+2026。
> 
> *M* N=Lucida Sans 打字机，gtf=Lucida Sans 打字机，[x20-xF002]#240,U+2026。
> 
> *M* N=MingLiU-ExtB，gtf=MingLiU-ExtB，[x0-x2122]#212。
> 
> *M* N=MingLiU_HKSCS-ExtB，gtf=MingLiU_HKSCS-ExtB，[x0-x2122]#212。
> 
> *M* N=MS 哥特式，gtf=MS 哥特式，[x0-xFFEE]#15760,U+2026。
> 
> *M* N=NSimSun，gtf=NSimSun，[x20-xFFE5]#28737，U+2026。
> 
> *M* N=OCR A 扩展，gtf=OCR A 扩展，[x20-xF003]#248，U+2026。
> 
> *M* N=SimSun，gtf=SimSun，[x20-xFFE5]#28737，U+2026。
> 
> *M* N=SimSun-ExtB，gtf=SimSun-ExtB，[x20-x7F]#96。
> 
> *M* N=Webdings，gtf=Webdings，[x20-xF0FF]#446。

# database - 如何在数据存储而不是数据库中思考？

> ID：103727
> 
> 赞同：185
> 
> 时间：2008-09-19T17:03:11.227
> 
> 标签：database, google-app-engine, google-cloud-platform, google-cloud-datastore

例如，Google App Engine 使用 Google Datastore（而非标准数据库）来存储数据。有人对使用 Google Datastore 而不是数据库有任何提示吗？似乎我已经训练我的思维 100% 思考直接映射到表结构的对象关系，现在很难看到任何不同的东西。我可以理解 Google Datastore 的一些好处（例如性能和分发数据的能力），但是牺牲了一些好的数据库功能（例如连接）。

与 Google Datastore 或 BigTable 合作过的人是否对与他们合作有什么好的建议？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2008-09-19T19:24:34.413

与“传统”关系数据库相比，App Engine 数据存储区有两点需要习惯：

*   数据存储区不区分插入和更新。当您在实体上调用 put() 时，该实体将使用其唯一键存储到数据存储中，并且具有该键的任何内容都会被覆盖。基本上，数据存储中的每种实体类型都像一个巨大的地图或排序列表。
*   正如您所提到的，查询受到更多限制。没有加入，首先。

要实现的关键——以及这两种差异背后的原因——是 Bigtable 基本上就像一个巨大的有序字典。因此，put 操作只是设置给定键的值 - 无论该键的任何先前值如何，并且 fetch 操作仅限于获取单个键或键的连续范围。索引可以实现更复杂的查询，索引基本上只是它们自己的表，允许您将更复杂的查询实现为对连续范围的扫描。

一旦你吸收了这些，你就拥有了理解数据存储的功能和限制所需的基本知识。看似武断的限制可能更有意义。

这里的关键是，尽管这些限制了您可以在关系数据库中执行的操作，但这些相同的限制使得扩展到 Bigtable 旨在处理的那种数量级变得切实可行。您根本无法执行在纸面上看起来不错但在 SQL 数据库中速度极慢的那种查询。

就如何改变数据表示方式而言，最重要的是预先计算。不要在查询时进行连接，而是尽可能预先计算数据并将其存储在数据存储中。如果要选择随机记录，请生成一个随机数并将其与每条记录一起存储。这里有一整本关于这种技巧和窍门的[食谱](https://web.archive.org/web/20090416113704/http://appengine-cookbook.appspot.com/)。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2008-09-19T17:14:21.467

我一直在进行思维转换的方式是完全忘记数据库。

在关系数据库世界中，您总是需要担心数据规范化和表结构。抛弃一切。只需布局您的网页。把它们都摆出来。现在看看他们。你已经有 2/3 了。

如果您忘记了数据库大小很重要并且数据不应该重复的概念，那么您就已经是 3/4 了，您甚至不必编写任何代码！让你的观点决定你的模型。您不必再像在关系世界中那样将您的对象变成二维的。您现在可以存储具有形状的对象。

是的，这是对磨难的简化解释，但它帮助我忘记了数据库，只做一个应用程序。到目前为止，我已经使用这种理念制作了 4 个 App Engine 应用程序，并且还会有更多应用程序。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-02T19:51:59.597

当人们出来时，我总是轻笑 - 这不是关系。我在 django 中编写了 cellectr，下面是我的模型片段。如您所见，我有由用户管理或指导的联赛。我可以从一个联盟获取所有的经理，或者从一个给定的用户我可以返回她教练或经理的联盟。

仅仅因为没有特定的外键支持并不意味着您不能拥有具有关系的数据库模型。

我的两便士。

* * *

```
class League(BaseModel):
    name = db.StringProperty()    
    managers = db.ListProperty(db.Key) #all the users who can view/edit this league
    coaches = db.ListProperty(db.Key) #all the users who are able to view this league

    def get_managers(self):
        # This returns the models themselves, not just the keys that are stored in teams
        return UserPrefs.get(self.managers)

    def get_coaches(self):
        # This returns the models themselves, not just the keys that are stored in teams
        return UserPrefs.get(self.coaches)      

    def __str__(self):
        return self.name

    # Need to delete all the associated games, teams and players
    def delete(self):
        for player in self.leagues_players:
            player.delete()
        for game in self.leagues_games:
            game.delete()
        for team in self.leagues_teams:
            team.delete()            
        super(League, self).delete()

class UserPrefs(db.Model):
    user = db.UserProperty()
    league_ref = db.ReferenceProperty(reference_class=League,
                            collection_name='users') #league the users are managing

    def __str__(self):
        return self.user.nickname

    # many-to-many relationship, a user can coach many leagues, a league can be
    # coached by many users
    @property
    def managing(self):
        return League.gql('WHERE managers = :1', self.key())

    @property
    def coaching(self):
        return League.gql('WHERE coaches = :1', self.key())

    # remove all references to me when I'm deleted
    def delete(self):
        for manager in self.managing:
            manager.managers.remove(self.key())
            manager.put()
        for coach in self.managing:
            coach.coaches.remove(self.key())
            coaches.put()            
        super(UserPrefs, self).delete() 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-04-09T21:26:52.640

我来自关系数据库世界，然后我发现了这个 Datastore 的东西。花了几天时间才弄明白。好吧，我有一些发现。

您一定已经知道 Datastore 是按比例构建的，而这正是它与 RDMBS 的区别所在。为了更好地扩展大型数据集，App Engine 进行了一些更改（有些意味着很多更改）。

**RDBMS VS DataStore**
*结构*
在数据库中，我们通常将数据构建在 Tables 中，Datastore 中的 Rows 变成[Kinds 和 Entities](https://developers.google.com/appengine/docs/python/datastore/entities#Kinds_and_Identifiers)。

*关系*
在 RDBMS 中，大多数人遵循一对一、多对一、多对多的关系，在数据存储中，因为它有“无连接”的东西，但我们仍然可以使用“ *ReferenceProperty* ”实现我们的规范化“例如[一对一关系示例](https://stackoverflow.com/questions/2653074/schema-less-design-guidelines-for-google-app-engine-datastore-and-other-nosql-db)。

*[索引](https://developers.google.com/appengine/articles/index_building)*
通常在 RDMBS 中，我们制作主键、外键、唯一键和索引键等索引，以加快搜索速度并提高数据库性能。在数据存储中，您必须为每种类型创建至少一个索引（无论您喜欢与否，[它都会自动生成](https://stackoverflow.com/questions/7902065/how-gae-datastore-key-is-generated)），因为数据存储会根据这些索引搜索您的实体，相信我这是最好的部分，在 RDBMS 中，您可以使用搜索非索引字段虽然需要一些时间，但它会。在 Datastore 中，您无法使用非索引属性进行搜索。

*计数*
在 RDMBS 中，计数（*）要容易得多，但在数据存储中，请不要以正常方式思考它（是的，有一个计数功能），因为它有[1000 个限制](https://stackoverflow.com/questions/751124/how-does-one-get-a-count-of-rows-in-a-datastore-model-in-google-appengine)，并且它会花费与实体一样多的[小](https://stackoverflow.com/questions/12232049/what-counts-towards-the-gae-datastore-quotas)操作不好但我们总是有好的选择，我们可以使用[Shard Counters](https://stackoverflow.com/questions/10242918/app-engine-shard-counters-and-high-replication-datastore)。

RDMBS 中的*[独特约束，我们喜欢这个功能，对吧？](https://stackoverflow.com/questions/2626978/unique-constraint-at-data-level-in-gae)*但是Datastore有它自己的方式。您不能将属性定义为唯一的:(。

*Query*
GAE Datatore 提供了一个更好的功能，非常[LIKE](https://stackoverflow.com/questions/47786/google-app-engine-is-it-possible-to-do-a-gql-like-query)（哦，不！数据存储没有 LIKE 关键字）SQL，即[GQL](https://developers.google.com/appengine/docs/python/datastore/gqlreference)。

*数据插入/更新/删除/选择*
这是我们都感兴趣的地方，因为在 RDMBS 中，我们需要对插入、更新、删除和选择进行一次查询，就像 RDBMS 一样，Datastore 有 put、delete、get（不要太兴奋）因为 Datastore在[写入、读取、小型操作（](https://developers.google.com/appengine/docs/billing)*数据存储调用的*读取成本）方面进行放置或获取，这就是数据建模发挥作用的地方。您必须最小化这些操作并保持您的应用程序运行。对于减少[读取操作](https://developers.google.com/appengine/docs/python/datastore/entities#Batch_Operations)，您可以使用[Memcache](http://blog.notdot.net/2009/9/Efficient-model-memcaching)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-29T07:34:50.053

查看 Objectify 文档。页面底部的第一条评论说：

“很好，虽然你写这篇文章是为了描述 Objectify，但它也是我读过的关于 appengine 数据存储本身的最简洁的解释之一。谢谢。”

[https://github.com/objectify/objectify/wiki/Concepts](https://github.com/objectify/objectify/wiki/Concepts)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T17:27:40.950

如果您习惯于考虑 ORM 映射的实体，那么这基本上就是像 Google 的 App Engine 这样的基于实体的数据存储的工作方式。对于连接之类的东西，您可以查看[参考属性](http://code.google.com/appengine/docs/python/datastore/entitiesandmodels.html#References)。由于后端是由 GQL 和 Datastore API 接口抽象出来的，因此您实际上不需要担心它是使用 BigTable 作为后端还是其他东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-28T16:25:06.863

我看待数据存储的方式是，种类识别表本身，而实体是表中的单个行。如果谷歌要拿出一张没有结构的大桌子，你可以在一个实体中倾倒任何你想要的东西。换句话说，如果实体不绑定到一种实体，您几乎可以对实体具有任何结构并存储在一个位置（一种没有结构的大文件，每一行都有自己的结构）。

现在回到原来的评论，google datastore 和 bigtable 是两个不同的东西，所以不要将 google datastore 与 datastore 数据存储的意义混淆。Bigtable 比 bigquery 更昂贵（我们没有使用它的主要原因）。Bigquery 确实有适当的连接和像 sql 语言这样的 RDBMS，而且它更便宜，为什么不使用 bigquery。话虽如此，bigquery 确实有一些限制，具体取决于您可能会或可能不会遇到它们的数据大小。

此外，就数据存储方面的思考而言，我认为正确的说法应该是“从 NoSQL 数据库的角度思考”。这些天有太多可用的，但是当涉及到谷歌产品时，除了谷歌云 SQL（即 mySQL）之外，其他一切都是 NoSQL。

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2008-09-19T17:07:17.507

扎根于数据库世界，对我来说数据存储将是一个巨大的表（因此得名“bigtable”）。BigTable 是一个不好的例子，因为它做了很多典型数据库可能做不到的其他事情，但它仍然是一个数据库。除非您知道您需要构建类似 Google 的“bigtable”之类的东西，否则您很有可能使用标准数据库就可以了。他们需要这样做，因为他们正在一起处理大量的数据和系统，并且没有商业可用的系统可以真正以他们可以证明他们需要完成工作的确切方式来完成这项工作。

（大表参考：[http](http://en.wikipedia.org/wiki/BigTable) ://en.wikipedia.org/wiki/BigTable ）

# asp.net - 如何通过 response.redirect 保留标签的值？

> ID：103765
> 
> 赞同：0
> 
> 时间：2008-09-19T17:10:57.090
> 
> 标签：asp.net, persistence, viewstate

情况如下：我有一个标签的文本集，紧随其后的是 response.redirect() 调用如下（这只是一个示例，但我相信它准确地描述了我的情况）：

aspx：

```
<asp:Label runat="server" Text="default text" /> 
```

代码隐藏（在 onclick 事件上调用的代码）：

```
Label.Text = "foo";
Response.Redirect("Default.aspx"); 
```

当页面呈现时，标签显示“默认文本”。我需要做些什么不同的事情？我的理解是，这些更改将在幕后自动完成，但显然，在这种情况下不会。谢谢。

对于一些额外的背景知识，代码隐藏片段在 onclick 事件调用的方法内调用。还有更多内容，但我只包括了与此问题相关的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T17:17:24.627

调用将`Response.Redirect`要求用户的浏览器加载您给它的 URL 中指定的页面。因为这是对您的页面的新请求，所以该页面使用您的标记中包含的文本（因为我假设标签文本是在按钮处理程序或类似的处理程序中设置的）。

如果您删除`Response.Redirect`呼叫，您的页面应该像宣传的那样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:16:24.863

除非明确指定状态，否则 ASP 和 ASP.Net 本质上是无状态的。通常在 PostBacks 之间的信息（如标签的值）包含在视图状态中，但如果您更改页面，该视图状态会丢失，因为它被存储在页面上的隐藏字段中。

如果您想在调用之间维护标签的值，您需要使用其中一种状态机制（例如 Session、Preferences）或通信系统（Request (GET, POST)）。

此外，您可能正在寻找 Server.Transfer ，这将改变谁在幕后处理页面。Response.Redirect 旨在在大多数情况下放弃您当前的上下文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:19:10.207

重定向后，您将丢失与控件关联的任何状态信息。如果您只想刷新页面，请删除重定向。代码执行完成后，页面将刷新并保留任何状态。

在幕后，这是可行的，因为 ASP.NET 将状态信息写入页面上的隐藏输入字段。当您单击一个按钮时，将发布表单，并且 ASP.NET 会破译视图状态。您的代码运行，修改状态，然后状态再次写入隐藏字段并继续循环，**直到您在没有 POST 的情况下更改页面**。当单击指向另一个页面的超链接或通过 Response.Redirect() 指示浏览器遵循指定的 url 时，可能会发生这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T17:46:27.753

要保持状态，请使用 Server.Transfer 而不是 Response.Redirect。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:23:38.310

所以，如果我可以回答我自己的问题（根据常见问题解答，这是鼓励的），简短的回答是，您不会通过重定向来保持视图状态。查看状态用于回发，而不是重定向。

奖励：[您想知道的关于 ASP.NET](http://msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic10)中的视图状态的所有信息，包括图片！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T23:04:02.273

对于它的价值（希望它有价值），[C# 2008 中的 Pro ASP.NET 3.5 第二版](https://rads.stackoverflow.com/amzn/click/com/1590598938)的第 6 章是关于该主题的极好的资源。到目前为止，整本书都很棒。

# database-design - 存储对需要批准才能可见的数据库记录的更改的最佳方式是什么？

> ID：103766
> 
> 赞同：44
> 
> 时间：2008-09-19T17:10:58.340
> 
> 标签：database-design

我需要将用户输入的更改存储到特定表中，但在管理员用户查看和批准之前不显示这些更改。虽然这些更改仍处于待处理状态，但我仍会显示旧版本的数据。存储这些等待批准的更改的最佳方式是什么？

我想了几种方法，但不知道什么是最好的方法。这是一个非常小的网络应用程序。一种方法是创建一个模仿另一个表模式的 PendingChanges 表，然后一旦更改获得批准，我就可以使用信息更新真实表。另一种方法是进行某种记录版本控制，我将多个版本的数据存储在表中，然后始终提取已标记为已批准的最高版本号的记录。这将限制额外表的数量（我需要为多个表执行此操作），但每次我提取一组记录时都需要进行额外处理以确保获得正确的记录。

对这些方法或其他可能好的方法有任何个人经验吗？

更新：澄清一下，在这种特殊情况下，我对历史数据不太感兴趣。我只需要某种方式来批准用户在网站上上线之前所做的任何更改。因此，用户将编辑他们的“个人资料”，然后管理员将查看该修改并批准它。一旦批准，将成为显示值，旧版本不需要保留。

任何人都尝试过下面的解决方案，您可以在特殊的 PendingChanges 表中存储任何需要将它们作为 XML 跟踪的表中的未决更改？每条记录都会有一列表示更改是针对哪个表的，一列可能存储将要更改的记录的 id（如果是新记录，则为 null），一个日期时间列，用于存储更改发生的时间，以及用于存储更改记录的 xml 的列（可能会序列化我的数据对象）。由于我不需要历史记录，因此在批准更改后，将更新真实表并删除 PendingChange 记录。

对这种方法有什么想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-19T17:12:23.920

绝对将它们存储在主表中，并用一列指示数据是否被批准。

更改通过后，无需复制。当您考虑时，过滤未批准数据的额外工作是数据库应该做的事情。如果您索引已批准的列，那么做正确的事情应该不会太麻烦。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T17:16:14.007

大小是你的敌人。如果您正在处理大量数据和大量行，那么将历史与当前混合在一起会打击您。如果你加入其他数据并确保你有正确的行，你也会遇到问题。

如果您需要保存历史数据以显示随时间的变化，我会使用单独的历史表，一旦获得批准，它就会更新实时的真实数据。它只是全方位的清洁剂。

如果您有很多具有这种机制但不需要保留历史记录的数据类型，我建议您使用一个通用的队列表来查看待处理的项目，例如存储为 xml。这将只允许管理员读取一个表，并使您能够相当容易地将此​​功能添加到系统中的任何表中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T18:16:32.737

我在银行领域工作，我们有这样的需求——一个用户所做的更改必须在得到另一个用户的批准后才能反映。我们使用的设计如下

1.  主表 A
2.  另一个存储更改记录的表 B（因此与第一个完全相同）+ 2 个附加列（C 的 FKey 和指示更改类型的代码）
3.  第三个表 C 存储所有需要批准的记录
4.  存储历史的第四个表 D（您可能不需要这个）。

我推荐这种方法。它非常优雅地处理所有场景，包括更新和删除。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T17:23:41.397

鉴于大多数上市公司面临的 SOx 合规运动，我在这方面有相当多的经验。通常我一直在使用一个单独的表，该表带有带有某种标志列的带有时间戳的挂起更改。负责管理此数据的人员会获得一份待处理更改的列表，并且可以选择接受或不接受。当一条数据被接受时，我使用触发器将新数据集成到表中。尽管有些人不喜欢触发方法，而是宁愿将其编码到存储过程中。这对我来说效果很好，即使在相当大的数据库中也是如此。复杂性可能会有点难以处理，尤其是在处理一个更改与另一个更改直接冲突的情况以及处理这些更改的顺序时。保存请求数据的表永远无法删除，因为它保存了“面包屑”，可以说是在需要追溯特定情况下发生的情况时所必需的。但是在任何方法中，都需要评估风险，例如我提到的冲突数据，并且需要建立业务逻辑层来确定这些情况下的流程。

我个人不喜欢相同的表方法，因为在不断更改的数据存储的情况下，表中的这些额外数据可能会不必要地阻碍表上的请求，并且需要更多详细信息来了解您的操作方式正在索引表和您的执行计划。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T17:44:37.900

另一个想法是拥有三张桌子。

*   一个是保存原始数据的主表。
*   第二个将保存建议的数据。
*   第三个将保存历史数据。

这种方法使您能够快速轻松地回滚，并在需要时为您提供审计跟踪。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T18:38:36.677

我会创建一个带有标志的表并创建一个类似的视图

```
 CREATE OR REPLACE VIEW AS 

  SELECT * FROM my_table where approved = 1 
```

它可以帮助分离 aprovement 和查询之间的依赖关系。但如果需要对视图进行更新，这可能不是最好的主意。

移动记录可能有一些性能考虑。但是分区表可以做一些非常相似的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T17:36:46.810

由于这是一个网络应用程序，我将假设读取次数多于写入次数，并且您想要一些相当快的东西，并且您的冲突解决（即乱序批准）会导致相同的行为 - 最新更新是用来。

您提出的两种策略都相似，因为它们每个更改集都保留一行，必须处理冲突等，唯一的区别是是将数据存储在一个表还是两个表中。鉴于这种情况，出于性能原因，两个表似乎是更好的解决方案。如果您的数据库支持，您还可以使用一个表和最近批准的更改视图来解决此问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T17:14:24.743

我认为第二种方法是更好的方法，仅仅是因为它可以更好地扩展到多个表。此外，额外的处理将是最小的，因为您可以基于“已批准”位创建表的索引，并且您可以将查询专门用于提取已批准（用于查看）或未批准（用于批准）条目。

# asp.net - 使用 Cassini 而不是 IIS 有什么（缺点）优点？

> ID：103785
> 
> 赞同：52
> 
> 时间：2008-09-19T17:13:16.790
> 
> 标签：asp.net, visual-studio, iis, cassini

我发现在某些情况下我可以在调试时编辑源代码。使用 Visual Studio 内置网络服务器而不是 IIS 中的虚拟目录还有其他优点吗？

我在我的开发环境中使用 Windows XP 和 IIS 5 的本地实例。我从事多个项目，因此我使用多个虚拟目录来管理所有不同的站点。

有什么缺点吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-09-19T17:17:29.853

Visual Studio 的内置 Web 服务器称为 Cassini，以下是它的一些限制...

*   每个端口只能承载一个 ASP.NET 应用程序。
*   它不支持 HTTPS。
*   它不支持身份验证。
*   它只响应 localhost 请求。
*   与 IIS 相比，它的启动速度很慢

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-19T18:20:29.357

以前的所有回复都是很好的答案 - 这是 Cassini 的一个问题，可能需要在 destkop 上安装 IIS。

Cassini 在开发人员的上下文中运行，而不是作为 IIS 用户（IUSR_、IWAM 或在 WinXP x64 中的 w3wp 进程）。如果您有一个正在访问外部文件或创建临时文件的网站，这可能会有点痛苦。当您的开发人员作为其桌面的管理员运行时，这一点最为明显。

当您移动到服务器 IIS 时，您可以在 Cassini 中访问的某些内容将无法正常工作。使用 IIS_WPG 进行 CACL 通常是修复所需的全部，但如果您的开发人员没有考虑这一点，他们很快就会对部署感到非常沮丧。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T18:23:02.270

Cassini 不支持虚拟目录。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-07-03T18:16:27.037

看起来第三种选择即将推出：

[IIS 快递](http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T17:15:46.847

内置服务器非常适合那些不想让开发人员在他们自己的机器上提供任何管理员访问权限来配置 IIS 的大型公司。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-19T17:25:53.623

`//`Visual Studio Web 服务器在路径上的宽容度较低。

它将拒绝像 `http://localhost:52632/main//images/logo.jpg`IIS 那样提供链接。

这很模糊，但这意味着我们有很多修复工作要做，以摆脱所有的`//`事件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-19T20:27:19.117

我遇到的另一个缺点是在使用自定义`IPrincipal`/的 Forms 身份验证网站上`IIdentity`。卡西尼会在`AppDomains`没有警告（或通知）的情况下切换。

查看此[博客文章](http://www.lhotka.net/weblog/UpdateOnMyStrugglesWithTheASPNETDevelopmentServer.aspx)了解更多信息。对此的头痛让我放弃了 Cassini 并坚持使用 IIS。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-19T17:23:33.347

[内置服务器处理 HTTPModules 的方式存在错误](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=274696 "使用 ASP.NET 开发服务器时，在 ASP.NET 中使用自定义标识失败")- 有[一种解决方法](http://www.lhotka.net/weblog/UpdateOnMyStrugglesWithTheASPNETDevelopmentServer.aspx "在评论中搜索“John Lewicki”")，但我讨厌必须放入生产中永远不需要的代码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-19T17:38:02.550

*   您需要运行 Visual Studio 才能使用它（在正常情况下）

*   它只响应 localhost，因此您不能将链接`http://simon-laptop:37473/app1`提供给朋友以通过网络查看您的站点

*   [大缺点：让提琴手](http://www.fiddlertool.com "提琴手")工作更难，因为本地主机流量不是通过代理发送的。

使用`http://ipv4.fiddler:37473`是让 Fiddler 使用它的最佳方式。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T17:18:35.137

如果您“Web 引用”内置 Web 服务器上 Web 服务的 URL，则端口可能会更改。除非您在菜单*项目*→*属性*选项页面中设置了“特定端口”。

这是我现在已经习惯的事情。我总是设置一个特定的端口。现在，当有时网络服务器崩溃时（我曾经发生过这种情况），我只需更改端口号，一切都很好。我认为重新启动也将解决此问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T17:18:54.263

内置服务器意味着开发人员不必知道如何设置 IIS 来测试他们的站点。

您可能会争辩说这是一个缺点，而且 Windows 开发人员至少应该知道这么多 IIS。或者您可能会争辩说，不是系统管理员的开发人员根本不应该乱搞 Web 服务器。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-19T17:28:12.963

Cassini 也不支持[ASP Classic](https://en.wikipedia.org/wiki/Active_Server_Pages)页面。这只是旧 ASP Classic 页面仍然存在的遗留项目的问题（例如我们工作中的 Web 应用程序）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-19T21:51:29.973

你不能使用虚拟目录:(

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-19T17:14:45.787

如果您在家里使用 XP Home 进行业余工作，则无法在本地安装 IIS。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-19T17:16:47.887

内置服务器不可配置，它运行在一个奇怪的端口上，所以如果你指望特定的行为，它可能会很麻烦。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-19T17:40:47.847

我经常两全其美，在 IIS 中创建应用程序，并使用内置的 Web 服务器进行更高效的调试。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-19T17:55:45.517

Cassini 旨在成为一个轻量级的测试网络服务器。这个想法是开发人员不需要安装和配置 IIS 来测试他/她的应用程序。

如果您熟悉 IIS，并且您已经设置好并且您的机器可以处理它，请使用 IIS。卡西尼并不是要成为替代品。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-07-01T16:34:06.830

在启用了 UAC 的 Vista 或 Windows 7 中使用 IIS 时，必须以管理权限运行 Visual Studio。如果执行此操作，则无法从 shell 拖放到 Visual Studio（即使您以管理员身份运行 explorer.exe 的实例）。

出于这个原因，我在大多数项目中都使用 Cassini。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-08-06T05:48:30.737

仅供参考，Windows XP 64 位附带 IIS 6。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-07-23T13:33:01.910

这是2年前开始的旧线程。我在谷歌搜索时偶然发现了[UtilDev Cassini](http://ultidev.com/products/Cassini/index.htm)。对我来说看起来很有希望。至少它能够同时运行多个站点。该功能对我非常有用，因为我在 2 个不同的站点上工作，并且必须使用 IIS 在它们之间不断切换。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-07-11T21:27:01.933

这是第三种方式的原因：尽管[UWS Pro](http://ultidev.com/Forums/yaf_postst633_Welcome-to-UltiDev-Web-Server-Pro.aspx)可能比 Cassini 更接近 IIS（尽管受 Cassini 的启发并且来自 UltiDev Cassini 分支的供应商），但它的主要目的是可与 ASP.NET 应用程序一起 [再分发。](http://ultidev.com/Forums/yaf_postst660_Creating-Installer-project-bundling-UltiDev-Web-Server-Pro-using-Visual-Studio.aspx)![在此处输入图像描述](../Images/6a0fcf8194575d3da2fedf6a9a8fa470.png)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-19T17:15:37.767

安装 IISAdmin，您可以在 IIS 5 中设置单独的站点，而不是使用虚拟目录。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-19T17:20:29.393

内置的网络服务器不如 IIS 强大，但不需要设置，所以它只是一个折衷方案。

您可能并不总是希望您的开发项目暴露在您的 IIS 服务器（甚至是本地 IIS 服务器）上，因此内置服务器非常适合。

但是，如果您的应用程序要访问 Web 应用程序规范之外的资源，那么您可能需要在 IIS 中频繁调试，以便您的应用程序以受限权限运行，并且您可以看到痛点在哪里。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-19T18:09:58.477

`\aspnet_client`我们还看到 Visual Studio 内置服务器的一些问题，这些问题涉及一些将其脚本放入文件夹的第三方控件。

由于不在 IIS 下运行时该文件夹不存在，因此控件不起作用。总是使用 IIS 并避免奇怪的问题似乎要简单得多。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-19T18:57:34.743

我发现的一个区别是开发服务器处理上传文件的方式与 IIS 不同。如果要上传的文件大于您的 Max_File_Size 设置，您将无法捕获错误。该页面刚刚消失并返回 500。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-08-06T05:32:41.113

另一个缺点是它通过 gloabal asax 文件发送每个请求，该文件包括对图像和样式表的所有请求。这意味着如果您有代码可以处理文件名，例如查找，那么辅助文件也将得到处理。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-01-09T08:50:55.480

同样通过 IIS，您不必担心会在您的 localhost url 中自动记住和设置一个愚蠢的端口号。这是卡西尼直接依赖的时髦东西......屁股很大。谁想记住一些随意的端口号。只需在 IIS 中运行该死的站点即可。简单明了。

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2008-09-19T17:17:36.747

如果您的项目位于 IIS 目录中，您仍然可以编辑代码。这仅取决于它是否已发布。

当你调试某些基于权限的场景时，你会在 Cassini 与 IIS 上遇到很多问题，比如[Kerberos](https://duckduckgo.com/html/?q=Wikipedia%20ntlm)和[NTLM](https://en.wikipedia.org/wiki/NT_LAN_Manager)身份验证以及服务器压缩等问题。总而言之，Cassini 仍然可以开发，但请确保在发布到 IIS 时进行广泛的测试。

# java - 如何在 Lotus Notes 8.5+ 的电子邮件消息窗口工具栏中添加按钮？

> ID：103791
> 
> 赞同：0
> 
> 时间：2008-09-19T17:14:17.707
> 
> 标签：java, eclipse, lotus-notes

一位同事一直在努力解决这个问题。

期望的结果是一个可安装的 Notes 插件，它将添加一个带有附件的按钮电子邮件，让用户可以将附件保存到文档管理系统。

至少可以说，为 Notes 查找有关执行此操作的文档是一场艰苦的战斗。

编写实际的 java 来完成这项工作不是问题，但弄清楚如何扩展 Notes 才是问题。

那么，有没有办法向工具栏添加按钮/图标，或者只是添加新工具栏的问题？如果我们添加一个新的工具栏，那么我们是否可以让它只在没有电子邮件打开时才可见（或者只是灰显）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T17:41:17.097

Lotus Notes 8+ 和 Lotus Symphony 都使用 IBM Lotus Expeditor Toolkit。

如果您在[此处](http://symphony.lotus.com/software/lotus/symphony/developers.nsf/home)获得 Lotus Symphony SDK 。

它们是处理将按钮添加到 Symphony 工具栏的一两个示例。

它们应该与 Notes 几乎完全相同。

祝你好运，

布赖恩·吉安福卡罗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T18:39:33.087

我必须在 Notes 中为我正在开发的插件执行此操作。我最终做的是在设计器中编辑 Notes 模板，然后在其后面编写一些通过 DLL 调用 .NET 类的 LotusScript。因此，当您单击按钮时，它会触发 LotusScript 中的事件，然后调用 DLL，并将项目信息传递给它。

我还应该注意到，因为 Notes 文档太糟糕了，所以要弄清楚这是一个可怕的熊。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-30T13:06:07.587

根据您对系统的访问权限，任务可能相当容易。通常，您自定义邮件模板以在收件箱文件夹和所有文档视图中包含一个按钮（有关安全预防措施，请参阅[此条目](http://www.wissel.net/blog/D6Plinks/SHWL-77E6UQ)）。如果您只想在视图级别或其他表单上拥有按钮，您可以自定义 ($Inbox) ($All)（您可以使用共享标题子表单。
给按钮一个有意义的标签并添加以下代码：

```
@Command([ToolsRunMacro];"(ExportDocumentsTo[yourSystemNameHere])") 
```

圆括号实际上很重要。您的代码（我假设是 Java）进入代理程序。您选择“创建代理”和 Java 作为语言。您指定要运行的“选定文档”和代理列表选择作为触发器（这会将 () 放在您的名字周围）。您可以从 Session 类中获取它们。如果您的用户可以使用菜单而不是按钮，您只需选择操作列表作为触发器，代理将列在操作菜单中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-11T14:11:48.657

从您的问题中，我了解到您希望 Eclipse 客户端使用此功能。请仔细阅读 Mikkel Heisterberg 的网站[LekkimWorld.com](http://www.lekkimworld.com)

它包含大量材料。首先阅读他的演示文稿并搜索该网站。它有很多有用的材料。

# memory - 限制可用内存的工具

> ID：103806
> 
> 赞同：2
> 
> 时间：2008-09-19T17:15:51.260
> 
> 标签：memory, qa, devtools

操作系统：Windows XP

有谁知道限制可用内存的工具（最好是免费的）以及其他 Windows 资源（句柄等）？我想测试一个内存不足的应用程序，以确保它运行正常，如果已经有工具可以做这种事情，我宁愿不自己写。

顺便说一句，我确实为此寻找了其他问答主题，但没有找到。如果这是一个骗局，我很抱歉。只要让我知道，我会关闭这个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T17:18:04.017

您可以使用 Linux（grub.conf 或 lilo.conf）和 Windows（boot.ini）的引导参数来调整内存大小。

在 Linux 上，内核附加行中的“mem=128”将限制为 128MB。

在 Windows 上，boot.ini 中的“/MAXMEM=”。（参考：[Boot INI 选项参考](http://technet.microsoft.com/en-us/sysinternals/bb963892.aspx)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T17:20:40.127

如果您想测试物理内存较低的 PC，您可以使用 VM 并根据需要为其分配尽可能少（或尽可能多，如果主机上可用）的 RAM。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T17:41:51.183

您可以使用 Microsoft 应用程序验证工具： [http ://technet.microsoft.com/en-us/library/bb457063.aspx](http://technet.microsoft.com/en-us/library/bb457063.aspx)

这将允许您模拟资源不足以及许多其他问题。YMMV 使用非 MS 堆等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-29T06:45:37.707

将分页内存减少到零（需要重新启动）。然后应用程序仅限于物理内存。在大多数情况下，页面文件默认大小为 1.5gb，有助于解决问题。试图限制应用程序的内存将会对如此大的页面文件感到沮丧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T17:19:19.223

您可以使用 maxmem 选项编辑 boot.ini：

[http://support.microsoft.com/default.aspx?scid=kb;en-us;833721](http://support.microsoft.com/default.aspx?scid=kb;en-us;833721)

# sql-server - T-SQL：如何从一个表中获取其值与另一表中的值完全匹配的行？

> ID：103829
> 
> 赞同：5
> 
> 时间：2008-09-19T17:19:32.467
> 
> 标签：sql-server, tsql

鉴于以下情况：

```
declare @a table
(
    pkid int,
    value int
)

declare @b table
(
    otherID int,
    value int
)

insert into @a values (1, 1000)
insert into @a values (1, 1001)
insert into @a values (2, 1000)
insert into @a values (2, 1001)
insert into @a values (2, 1002)

insert into @b values (-1, 1000)
insert into @b values (-1, 1001)
insert into @b values (-1, 1002) 
```

如何查询@a 中与@b 完全匹配的所有值？

`{@a.pkid = 1, @b.otherID = -1}`不会返回（3 个值中只有 2 个匹配）

`{@a.pkid = 2, @b.otherID = -1}`将被返回（3 个值中的 3 个匹配）

重构表是一种选择。

**编辑：**我在 James 和 Tom H 的回答中取得了成功。

当我在@b 中添加另一个案例时，它们有点不足。

```
insert into @b values (-2, 1000) 
```

假设这应该返回另外两行 (`{@a.pkid = 1, @b.otherID = -2}`和`{@a.pkid = 2, @b.otherID = -2}`，它不起作用。但是，对于我的项目来说，这不是问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T13:45:31.387

这更有效（它使用`TOP 1`而不是`COUNT`），并且适用于`(-2, 1000)`：

```
SELECT  *
FROM    (
        SELECT  ab.pkid, ab.otherID,
                (
                SELECT  TOP 1 COALESCE(ai.value, bi.value)
                FROM    (
                        SELECT  *
                        FROM    @a aii
                        WHERE   aii.pkid = ab.pkid
                        ) ai
                FULL OUTER JOIN
                        (
                        SELECT  *
                        FROM    @b bii
                        WHERE   bii.otherID = ab.otherID
                        ) bi
                ON      ai.value = bi.value
                WHERE   ai.pkid IS NULL OR bi.otherID IS NULL
                ) unmatch
        FROM
                (
                SELECT  DISTINCT pkid, otherid
                FROM    @a a , @b b
                ) ab
        ) q
WHERE   unmatch IS NOT NULL 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T17:43:45.077

可能不是最便宜的方法：

```
SELECT a.pkId,b.otherId FROM
    (SELECT a.pkId,CHECKSUM_AGG(DISTINCT a.value) as 'ValueHash' FROM @a a GROUP BY a.pkId) a
    INNER JOIN (SELECT b.otherId,CHECKSUM_AGG(DISTINCT b.value) as 'ValueHash' FROM @b b GROUP BY b.otherId) b
ON a.ValueHash = b.ValueHash 
```

您可以看到，基本上我正在为每个表中的每个 Id 的值集代表一个值的每个值创建一个新的结果集，并且仅在它们匹配的地方加入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T18:14:53.973

以下查询为您提供了请求的结果：

```
select A.pkid, B.otherId
    from @a A, @b B 
    where A.value = B.value
    group by A.pkid, B.otherId
    having count(B.value) = (
        select count(*) from @b BB where B.otherId = BB.otherId) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T17:49:06.703

适用于您的示例，我认为它适用于所有情况，但我尚未对其进行彻底测试：

```
SELECT
    SQ1.pkid
FROM
    (
        SELECT
            a.pkid, COUNT(*) AS cnt
        FROM
            @a AS a
        GROUP BY
            a.pkid
    ) SQ1
INNER JOIN
    (
        SELECT
            a1.pkid, b1.otherID, COUNT(*) AS cnt
        FROM
            @a AS a1
        INNER JOIN @b AS b1 ON b1.value = a1.value
        GROUP BY
            a1.pkid, b1.otherID
    ) SQ2 ON
        SQ2.pkid = SQ1.pkid AND
        SQ2.cnt = SQ1.cnt
INNER JOIN
    (
        SELECT
            b2.otherID, COUNT(*) AS cnt
        FROM
            @b AS b2
        GROUP BY
            b2.otherID
    ) SQ3 ON
        SQ3.otherID = SQ2.otherID AND
        SQ3.cnt = SQ1.cnt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T18:09:31.850

```
-- 注意，只有在任一表中不允许重复值的情况下才有效
声明@validcomparisons 表（
    pkid INT,
    其他 INT,
    整数
)

插入@validcomparisons（pkid，otherid，num）
选择 a.pkid、b.otherid、A.cnt
FROM (select pkid, count(*) as cnt FROM @a group by pkid) a
INNER JOIN (select otherid, count(*) as cnt from @b group by otherid) b
    ON b.cnt = a.cnt

声明@比较表 (
    pkid INT,
    其他 INT,
    相同的INT）

插入@comparison（pkid，otherid，相同）
选择 a.pkid，b.otherid，计数（*）
来自@aa
内连接@bb
    ON a.value = b.value
按 a.pkid、b.otherid 分组

选择 COMP.PKID、COMP.OTHERID
来自@comparison comp
内部联接@validcomparisons val
    ON comp.pkid = val.pkid
    AND comp.otherid = val.otherid
    AND comp.same = val.num

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T18:28:56.343

我添加了一些额外的测试用例。您可以通过更改在聚合中使用不同关键字的方式来更改重复处理。基本上，我得到了匹配的计数并将其与每个@a 和@b 中所需匹配的计数进行比较。

```
declare @a table
(
    pkid int,
    value int
)

declare @b table
(
    otherID int,
    value int
)

insert into @a values (1, 1000)
insert into @a values (1, 1001)

insert into @a values (2, 1000)
insert into @a values (2, 1001)
insert into @a values (2, 1002)

insert into @a values (3, 1000)
insert into @a values (3, 1001)
insert into @a values (3, 1001)

insert into @a values (4, 1000)
insert into @a values (4, 1000)
insert into @a values (4, 1001)

insert into @b values (-1, 1000)
insert into @b values (-1, 1001)
insert into @b values (-1, 1002)

insert into @b values (-2, 1001)
insert into @b values (-2, 1002)

insert into @b values (-3, 1000)
insert into @b values (-3, 1001)
insert into @b values (-3, 1001)

SELECT Matches.pkid, Matches.otherId
FROM
(
    SELECT a.pkid, b.otherId, n = COUNT(*)
    FROM @a a
    INNER JOIN @b b
        ON a.Value = b.Value
    GROUP BY a.pkid, b.otherId
) AS Matches

INNER JOIN 
(
    SELECT
        pkid,
        n = COUNT(DISTINCT value)
    FROM @a
    GROUP BY pkid
) AS ACount
ON Matches.pkid = ACount.pkid

INNER JOIN
(
    SELECT
        otherId,
        n = COUNT(DISTINCT value)
    FROM @b
    GROUP BY otherId
) AS BCount
    ON Matches.otherId = BCount.otherId

WHERE Matches.n = ACount.n AND Matches.n = BCount.n 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T20:56:52.947

> 如何查询@a 中与@b 完全匹配的所有值？

恐怕这个定义不是很清楚。从您的附加示例看来，您希望所有对 a.pkid、b.otherID 的给定 b.otherID 的每个 b.value 也是给定 a.pkid 的 a.value。

换句话说，您希望@a 中的 pkid**至少**具有b 中 otherID 的所有值。@a 中的额外值似乎没问题。同样，这是基于您的附加示例的推理，以及 (1, -2) 和 (2, -2) 将是有效结果的假设。在这两种情况下，给定 pkid 的 a.value 值都**大于**给定 otherID的 b.value 值。

所以，考虑到这一点：

```
 select
    matches.pkid
    ,matches.otherID
from
(
    select 
        a.pkid
        ,b.otherID
        ,count(1) as cnt
    from @a a
    inner join @b b
        on b.value = a.value
    group by 
        a.pkid
        ,b.otherID
) as matches
inner join
(
    select
        otherID
        ,count(1) as cnt
    from @b
    group by otherID
) as b_counts
on b_counts.otherID = matches.otherID
where matches.cnt = b_counts.cnt 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T17:29:32.600

有几种方法可以做到这一点，但一种简单的方法是创建一个联合视图

```
create view qryMyUinion as
select * from table1 
union all
select * from table2 
```

小心使用 union all，而不是简单的 union，因为它会省略重复项

然后这样做

```
select count( * ), [field list here] 
from qryMyUnion
group by [field list here]
having count( * ) > 1 
```

Union 和 Have 语句往往是标准 SQL 中最容易被忽视的部分，但它们可以解决许多原本需要过程代码的棘手问题

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T17:44:40.443

如果您试图只返回完整的记录集，您可以试试这个。我肯定会推荐使用有意义的别名，虽然......

Cervo 是对的，我们需要额外检查以确保 a 与 b 完全匹配，而不是 b 的超集。在这一点上，这更像是一个笨拙的解决方案，因此这仅在其他解决方案中的分析功能不起作用的情况下才合理。

```
select 
    a.pkid,
    a.value
from
    @a a
where
    a.pkid in
    (
    select
        pkid
    from
        (
        select 
            c.pkid,
            c.otherid,
            count(*) matching_count
        from 
            (
            select 
                a.pkid,
                a.value,
                b.otherid
            from 
                @a a inner join @b b 
                on a.value = b.value
            ) c
        group by 
            c.pkid,
            c.otherid
        ) d
        inner join
        (
        select 
            b.otherid,
            count(*) b_record_count
        from
            @b b
        group by
            b.otherid
        ) e
        on d.otherid = e.otherid
        and d.matching_count = e.b_record_count
        inner join
        (
        select 
            a.pkid match_pkid,
            count(*) a_record_count
        from
            @a a
        group by
            a.pkid
        ) f
        on d.pkid = f.match_pkid
        and d.matching_count = f.a_record_count
    ) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T18:18:29.113

进一步迭代这一点：

```
select a.*
from @a a 
inner join @b b on a.value = b.value 
```

这将返回@a 中与@b 匹配的所有值

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T20:08:56.697

1）我假设你没有重复的 id

2) 获取相同数量值的键

3）键值个数等于等值个数的行为目标

我希望这是您搜索的内容（您不搜索性能，不是吗？）

```
declare @a table(    pkid int,    value int)
declare @b table(    otherID int,    value int)

insert into @a values (1, 1000)
insert into @a values (1, 1001)
insert into @a values (2, 1000)
insert into @a values (2, 1001)
insert into @a values (2, 1002)
insert into @a values (3, 1000)  
insert into @a values (3, 1001)
insert into @a values (4, 1000)
insert into @a values (4, 1001)
insert into @b values (-1, 1000)
insert into @b values (-1, 1001)
insert into @b values (-1, 1002)
insert into @b values (-2, 1001)
insert into @b values (-2, 1002)
insert into @b values (-3, 1000)
insert into @b values (-3, 1001)

  select cntok.cntid1 as cntid1, cntok.cntid2 as cntid2
  from
 (select cnt.cnt, cnt.cntid1, cnt.cntid2 from
    (select acnt.cnt as cnt, acnt.cntid as cntid1, bcnt.cntid as cntid2 from
          (select count(pkid) as cnt, pkid as cntid from @a group by pkid)
           as acnt
                full join 
               (select count(otherID) as cnt, otherID as cntid from @b group by otherID)
                as bcnt
                   on  acnt.cnt = bcnt.cnt)
     as cnt
     where cntid1 is not null and cntid2 is not null)
   as cntok 
inner join 
(select count(1) as cnt, cnta.cntid1 as cntid1, cnta.cntid2 as cntid2
from
    (select cnt, cntid1, cntid2, a.value as value1 
     from
         (select cnt.cnt, cnt.cntid1, cnt.cntid2 from
            (select acnt.cnt as cnt, acnt.cntid as cntid1, bcnt.cntid as cntid2 from
                  (select count(pkid) as cnt, pkid as cntid from @a group by pkid)
                   as acnt
                        full join 
                       (select count(otherID) as cnt, otherID as cntid from @b group by otherID)
                        as bcnt
                           on  acnt.cnt = bcnt.cnt)
             as cnt
             where cntid1 is not null and cntid2 is not null)
         as cntok 
             inner join @a as a on a.pkid = cntok.cntid1)
      as cnta
         inner join

             (select cnt, cntid1, cntid2, b.value as value2 
             from
             (select cnt.cnt, cnt.cntid1, cnt.cntid2 from
                    (select acnt.cnt as cnt, acnt.cntid as cntid1, bcnt.cntid as cntid2 from
                          (select count(pkid) as cnt, pkid as cntid from @a group by pkid)
                           as acnt
                                full join 
                               (select count(otherID) as cnt, otherID as cntid from @b group by otherID)
                                as bcnt
                                   on  acnt.cnt = bcnt.cnt)
                     as cnt
                     where cntid1 is not null and cntid2 is not null)
                 as cntok 
                     inner join @b as b on b.otherid = cntok.cntid2)
               as cntb
               on cnta.cntid1 = cntb.cntid1 and cnta.cntid2 = cntb.cntid2 and cnta.value1 = cntb.value2
      group by cnta.cntid1, cnta.cntid2) 
   as cntequals
   on cntok.cnt = cntequals.cnt and cntok.cntid1 = cntequals.cntid1 and cntok.cntid2 = cntequals.cntid2 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-19T17:50:39.663

正如 CQ 所说，您只需要一个简单的内部连接。

```
Select * -- all columns but only from #a
from #a 
inner join #b 
on #a.value = #b.value -- only return matching rows
where #a.pkid  = 2 
```

# pgp - GnuPG 是否与 McAfee eBusiness Server 7.1 兼容？

> ID：103831
> 
> 赞同：-1
> 
> 时间：2008-09-19T17:19:46.227
> 
> 标签：pgp, gnupg, mcafee

现在，我们正在使用 PGP 命令行 9.0。有人知道 GnuPG 是否可以工作吗？会便宜很多。

编辑：理论上，GnuPG/PGP/McAfee eBusiness Server 应该能够互操作。在实践中，你几乎只需要测试就可以看到。我们没有让 GnuPG 与 McAfee eBusiness Server 一起工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T19:41:50.443

我从未专门使用过 McAfee eBusiness Server，但 GnuPG 的全部意义在于提供实现 OpenPGP 规范的自由软件。除非 McAfee 出于某些令人讨厌的原因强制使用特定密码，否则应该没有问题。

请注意，如果某些组件将使用 PGP 检查密钥，而另一些组件将使用 GnuPG，您可能需要仔细检查 GnuPG 的[互操作性常见问题解答问题](http://www.gnupg.org/documentation/faqs.en.html#q5)，因为实际上您可能必须限制您的密码和压缩算法或签名版本. 该常见问题解答讨论的是 PGP 的旧版本，因此它实际上可能不再是问题。

# 64-bit - 如何在启动时为 Win x64 机器运行批处理文件？

> ID：103842
> 
> 赞同：2
> 
> 时间：2008-09-19T17:21:19.517
> 
> 标签：64-bit, startupscript

我知道您可以使用 autoexnt 在 Windows XP 的启动时运行批处理文件，但这似乎只适用于 32 位机器。我在一个盒子上运行 Windows XP x64，我需要在启动时运行一个脚本（没有任何人登录）。有什么想法吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T17:36:52.100

还可以使用本地计算机策略来配置启动和关闭脚本。

[http://vlaurie.com/computers2/Articles/group_policy_editor.htm](http://vlaurie.com/computers2/Articles/group_policy_editor.htm)

有一个很好的演练如何做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:33:52.903

在您的注册表中，可通过“regedit”访问，您可以导航到以下键：

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

添加一个 Reg_sz 类型的条目，不管键名是什么，但作为值，为您的程序或批处理文件提供完全限定的路径名​​。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:23:52.800

在启动时意味着登录，还是在启动时意味着（在任何人登录之前）？

登录时，您可以在 Startup 文件夹中放置一个 BAT。

# mapping - TIGER shapefile - 使用和解释

> ID：103843
> 
> 赞同：3
> 
> 时间：2008-09-19T17:21:51.027
> 
> 标签：mapping, gis, geocoding

多年前我*就*知道美国 GIS TIGER 文件格式，但从未使用过。

我很快将需要非常快速地实现道路和其他功能的简单地理编码和矢量图形。

*   我在哪里获取信息 - 是否有教程、示例查询等？

是否有其他方法可以在移动（无互联网）设备中包含地理编码和基本映射？

-亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T17:31:27.027

据我所知，直接使用 TIGER/Line 格式的应用程序并不多。大多数应用程序使用已翻译成 ESRI 的 shapefile 格式的 TIGER 文件。

编辑添加：

> 是否有关于 ESRI 格式的信息？

有描述文件格式的[ESRI 白皮书。](http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf)

如果您打算在应用程序中使用 shapefile，则可以使用[各种](http://www.gdal.org/ogr/) [库](http://shapelib.maptools.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-19T18:39:18.923

[OpenStreetMap](http://www.openstreetmap.org/)项目导入了 TIGER 数据，您可能会在那里找到有用的代码片段。有关更多信息和链接，请参阅 OpenStreetMap wiki 上的[TIGER](http://wiki.openstreetmap.org/index.php/TIGER)页面

# python - 如何使用 List Comprehension 将 Python 中的二维数组合并为一个字符串？

> ID：103844
> 
> 赞同：20
> 
> 时间：2008-09-19T17:21:53.570
> 
> 标签：python, list-comprehension

列表理解对我来说似乎就像正则表达式对我来说是一块不透明的花岗岩。我需要指针。

说，我有一个二维列表：

```
li = [[0,1,2],[3,4,5],[6,7,8]] 
```

我想将其合并到一个长列表中

```
li2 = [0,1,2,3,4,5,6,7,8] 
```

或带分隔符的字符串：

```
s = "0,1,2,3,4,5,6,7,8" 
```

真的，我想知道如何做到这两点。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-19T17:28:14.087

像这样：

```
[ item for innerlist in outerlist for item in innerlist ] 
```

将其直接转换为带有分隔符的字符串：

```
','.join(str(item) for innerlist in outerlist for item in innerlist) 
```

是的，“for innerlist in outerlist”和“for item in innerlist”的顺序是正确的。即使循环的“主体”位于 listcomp 的开头，嵌套循环（和“if”子句）的顺序仍然与您写出循环时的顺序相同：

```
for innerlist in outerlist:
    for item in innerlist:
        ... 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-19T17:26:51.187

有几个选择。首先，您可以创建一个新列表并将每个列表的内容添加到其中：

```
li2 = []
for sublist in li:
    li2.extend(sublist) 
```

或者，您可以使用`itertools`模块的`chain`函数，该函数生成一个包含多个迭代中所有项目的迭代：

```
import itertools
li2 = list(itertools.chain(*li)) 
```

如果您采用这种方法，您可以在不创建中间列表的情况下生成字符串：

```
s = ",".join(itertools.chain(*li)) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-19T17:29:22.977

试试看：

```
li=[[0,1,2],[3,4,5],[6,7,8]]
li2 = [ y for x in li for y in x] 
```

你可以这样读：
给我每个 ys 的列表。
ys 来自 xs。
xs 来自 li。

要将其映射到字符串中：

```
','.join(map(str,li2)) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T17:27:43.820

我最喜欢的，也是最短的，是这样的：

```
li2 = sum(li, []) 
```

和

```
s = ','.join(li2) 
```

编辑：使用`sum`而不是`reduce`, （感谢[Thomas Wouters](https://stackoverflow.com/users/17624/thomas-wouters)！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T17:24:56.760

```
import itertools
itertools.flatten( li ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T17:26:44.247

要使其成为扁平列表，请使用：

1.  [http://code.activestate.com/recipes/121294/](http://code.activestate.com/recipes/121294/)
2.  [http://code.activestate.com/recipes/363051/](http://code.activestate.com/recipes/363051/)

然后，`join`使它成为一个字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T17:26:52.107

对于第二个，有一个内置的字符串方法可以做到这一点：

```
>>> print ','.join(str(x) for x in li2)
"0,1,2,3,4,5,6,7,8" 
```

对于第一个，您可以在理解列表中使用 join ：

```
>>> print ",".join([",".join(str(x) for x in li])
"0,1,2,3,4,5,6,7,8" 
```

但是使用 itertools.flatten 更容易：

```
>>> import itertools
>>> print itertools.flatten(li)
[0,1,2,3,4,5,6,7,8]
>>> print ",".join(str(x) for x in itertools.flatten(li))
"0,1,2,3,4,5,6,7,8" 
```

注意：itertools 是一个模块，可帮助您使用迭代器（例如列表、元组或字符串）处理常见任务......它很方便，因为它不存储您正在处理的结构的副本，而是一个一个地处理项目.

编辑：有趣，我正在学习很多方法来做到这一点。谁说只有一种好方法？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T19:17:27.197

有很多方法可以解决这个问题。我喜欢[Numpy](http://numpy.scipy.org/)的工具，因为它通常已经导入到我所做的所有事情中。但是，如果您没有将 Numpy 用于其他任何事情，这可能不是一个好方法。

```
import numpy
li = [[0,1,2],[3,4,5],[6,7,8]]
li2=li[0] #first element of array to merge
i=1 
while i<len(li):
    li2=numpy.concatenate((li2,li[i]))
    i+=1
print li2 
```

这将打印 [0 1 2 3 4 5 6 7 8] ，然后您也可以将其转换为您的字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-18T14:12:37.437

这是一种方法：

```
def convert2DArrtostring(ndArr):
    '''converts 2D array to string'''
    arr_str = "["
    for i in ndArr:
        arr_str += "["
        for j in i:
            arr_str += str(j) + " "
        arr_str += "]\n"
    arr_str += "]"
    return arr_str 
```

# java - 您最喜欢的 Java API 领域是什么？

> ID：103848
> 
> 赞同：7
> 
> 时间：2008-09-19T17:22:16.113
> 
> 标签：java, reflection, collections

我很想知道其他 Java 程序员觉得他们最喜欢这门语言的什么部分，为什么他们会有这种感觉，以及为什么其他程序员也应该对它有深入的了解。我正在寻找简单、性能等原因。谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-19T17:23:19.980

我最喜欢的 Java API 是**Collections Framework**。我发现自己一直在使用它，而不是滚动自己的实现，而且它非常有趣且易于使用。它由高性能数据结构和算法的几个有用且可互换的实现以​​及用于围绕它们包装附加功能的几种便捷方法组成。

可以在此处找到 Josh Bloch 的教程：http: [//java.sun.com/docs/books/tutorial/collections/index.html](http://java.sun.com/docs/books/tutorial/collections/index.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-19T17:41:32.650

我最喜欢的 API 部分绝对是[java.lang](http://java.sun.com/javase/6/docs/api/java/lang/package-frame.html)。它有一个名为 的类`String`，它允许您轻松地操作字符数组。任何认真编写好的 Java 代码的程序员都应该检查一下。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-21T01:18:37.287

[java.util.concurrent](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)对我的生活至关重要。我们做了很多多核编程，尝试使用旧式原始线程来实现我们所有任务的想法让我感到恶心。

并发包真正让我们的生活更轻松的一个很好的例子是它提供的专用数据结构池。我个人最喜欢的是[CopyOnWriteArrayList](http://java.sun.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)。在显示任务正在从数据缓存中读取数据以更新屏幕而另一个任务正在从网络获取信息以更新缓存的情况下，我们使用了很多。通常，这将是碰撞、[ConcurrentModificationExceptions](http://java.sun.com/javase/6/docs/api/java/util/ConcurrentModificationException.html)和类似恐怖的邀请。使用 CopyOnWriteArrayList，写入任务将在需要添加数据时创建数据的新副本，从而确保读取器始终拥有有效（尽管可能已过时）数据集来显示。

正如javadoc所说，

> 这通常成本太高，但当遍历操作的数量大大超过突变时，它可能比替代方法更有效，并且在您不能或不想同步遍历但需要排除并发线程之间的干扰时很有用。

Java 消除了我通常会引入来解决这个问题的整个类的错误，使我能够专注于我需要解决的实际问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T17:51:50.207

绝对是集合框架。无论您是在做服务器端 Java 还是客户端，无论是否图形化，它都会一直使用。它很容易使用。大多数数据结构类都有非泛型和泛型版本（最好使用第二个，但有大量使用第一个的遗留代码），但除了类参数之外，它们在 API 方面几乎相同。在 .NET 中，这两个版本可以有不同的名称/API，并且会变得非常混乱。我也喜欢 Java 集合框架如何将算法作为静态方法（例如 Collections.sort(collectionVar)）而不是作为实例方法。在 .NET 中，他们使用实例方法，并且由于某种原因，并非每个数据结构都有排序...集合框架也非常丰富，您可以找到简单和专门的数据结构（例如

我听说的一个缺点是该框架表现不佳，有些人自己编写。我无法验证它，因为我不处理对性能至关重要的东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-19T17:36:37.670

javax.命名

[http://java.sun.com/javase/6/docs/api/javax/naming/package-summary.html](http://java.sun.com/javase/6/docs/api/javax/naming/package-summary.html)

Java 是一种出色的系统集成技术，因为它具有可移植性，而 JNDI 在抽象出首次接触远程系统的复杂性方面做得很好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T21:29:26.627

反射。其中一些在[java.lang.reflect](http://java.sun.com/javase/6/docs/api/java/lang/reflect/package-frame.html)中，一些在[java.lang](http://java.sun.com/javase/6/docs/api/java/lang/package-frame.html)中（主要是 Class 和 ClassLoader）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-20T00:35:02.297

流。Java 中的流比 C++ 中的流更容易掌握和实现（观点），并且根据 API 附带的流的名称，通常很容易看出流将为您做什么。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-19T17:29:09.870

[我是Java EE 中 JPA 的](http://java.sun.com/javaee/overview/faq/persistence.jsp)忠实粉丝。它减少了我需要为大型应用程序（将使用 EJB）和小型应用程序做的工作量。

紧随其后的是安全 API JAAS，这里是 Java SE JAAS 的链接：http: [//java.sun.com/javase/technologies/security/](http://java.sun.com/javase/technologies/security/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-22T01:25:47.880

到目前为止，java.util.regex API 包是我最喜欢的，因为它使我不必为了各种目的搜索和利用字符串片段而在很多场合重新发明轮子。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-19T17:32:47.147

java.util 非常实用。为什么？

*   收藏品。其中很多！
*   日期和时间类
*   文本扫描仪
*   依赖注入实用程序（Java 6 起）
*   定时器线程
*   随机数
*   观察者模式就在那里
*   Java 属性

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T18:10:34.700

java.util.jar - 帮助将 .jar 文件加载到我的应用程序插件的类加载器中！我喜欢它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-19T18:29:22.440

java.util.regex

还有其他一些我不能没有的包，但是 regex 包必须位于“java 的最大补充”的顶层——绝对就在 Collections 那里。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-20T00:31:35.300

我同意反思评论。迄今为止，Java API 中最有用/最强大的部分

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-20T21:24:22.840

回想我的 Java 时代，最有趣的 API 是[java.util.concurrent](http://java.sun.com/javase/6/docs/api/index.html?java/util/concurrent/package-summary.html)，因为它为并行处理提供了经过深思熟虑且易于使用的构建块。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-05T23:19:20.507

`InheritableThreadLocal`一路！！！这么多编写混淆代码的机会和绞死自己的绳索似乎永远不会用完。

# java - 在没有特定于 Flash 的服务器的情况下在 Java 和 Flash 之间进行通信

> ID：103861
> 
> 赞同：0
> 
> 时间：2008-09-19T17:23:18.590
> 
> 标签：java, flash

我有 Java 和 Flash 客户端应用程序。如果没有特殊的 Flash 专用服务器（例如 BlazeDS 或 Red5），两者进行通信的最佳方式是什么？我正在寻找一个轻量级的仅限客户端的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T17:33:26.117

好吧，您可以从 flash 向任何 url 发出 http 请求……因此，如果您的 java 服务器可以侦听传入请求并处理 XML 或 JSON，则您的 flash 客户端可以向该 url 发出请求。BlazeDS 和 Red5 只是旨在通过为您处理翻译来使其更简单，从而可以透明地调用服务器端函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:39:06.260

它们是在浏览器（小程序和 SWF）中运行，还是独立的应用程序？

如果它们在浏览器中运行，那么您可以使用 javascript。Flash 和 Java 都可以访问 javascript。它很脆弱，但它有效。

如果它们作为实际应用程序运行，那么您可以让 Java 在某个端口上打开套接字连接。然后 Flash 可以连接到它，它们可以来回发送 XML 数据。

这两个我都做过，所以我知道它们都有效。javascript 的东西很脆弱，但套接字的东西工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:36:24.550

WebORB for Java 可能对您有所帮助。它与您的 J2EE 代码集成。

欲了解更多信息： [http ://www.themidnightcoders.com/weborb/java/](http://www.themidnightcoders.com/weborb/java/)

对不起，我重读了您的问题，您只是在寻找客户端解决方案。在这种情况下，WebORB 将无法帮助您。很抱歉对于这个误会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T22:43:38.867

[默拉皮](https://code.google.com/p/merapi/)桥 API

> Merapi 允许开发人员将用 Adob​​e Flex 编写的 Adob​​e AIR 应用程序连接到在用户本地计算机上运行的 Java 应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T23:40:36.077

[Caucho 的Hessian](http://hessian.caucho.com/doc/flash.xtp) Web 服务协议有一个 Flash 实现。这种方法类似于使用 JSon 或 XML，但性能更高，因为 Hessian 是一种二进制协议。如果您碰巧在您的服务器上使用 Spring，您可以使用 Spring/Hessian 绑定直接从您的 Flash 应用程序调用您的 Spring 服务，而工作量很小。

# e-commerce - Authorize.Net Silent Post 是如何工作的？

> ID：103892
> 
> 赞同：4
> 
> 时间：2008-09-19T17:27:50.357
> 
> 标签：e-commerce, authorize.net, silent-post

Authorize.net 为其自动定期计费提供“静默 POST”功能。它应该将数据发布到您选择的网址，告诉您他们是否能够向客户收取费用，多少等。问题是，它没有很好的记录。

*   有什么方法可以测试该 URL 的帖子吗？我已经注册了一个开发者帐户，但无法像在实际系统中那样指定该 URL。因此，似乎没有办法对其进行测试。
*   如果没有，是否有它可以返回的可能值列表？它似乎发送`x_first_name`，`x_amount`- 我已经看到使用这些值的代码 - 但由于我实际上无法让它发送响应，所以我不确定。
*   任何地方都有此功能的文档吗？甚至是完全实现它的类？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-13T21:59:53.620

迟到总比不好：[关于 Authorize.Net 的静默帖子](http://www.johnconde.net/blog/all-about-authorize-nets-silent-post/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T17:30:53.457

我只在 AIM 和 SIM 上看到的不多，你可以给他们打电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:39:06.947

登录到您的 Authorize.Net 订单处理帐户，然后单击“设置”链接（在左栏中的“帐户”下）。然后单击“交易格式设置”区域中的“静默发布 URL”链接。您可以在下一页输入您的无声帖子 URL。下一页还包含一个指向解释技术细节的文档的链接。高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T17:13:16.733

这是我在该主题上发现的更多（有些）有用的帖子。

*   [Merchant Account Services](http://www.merchant-account-services.org/blog/handling-authorizenet-arb-subscription-failures/) - 提供一些有限的示例代码 (PHP)
*   [专家交流](http://www.experts-exchange.com/Programming/Languages/Q_22138459.html)- 列出了一些有用的变量，让您了解正在发送的内容 (ASP)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-31T03:53:34.117

您仍然需要致电您的帐户代表，让他们使用您的帐户激活 Silent Post URL，因为这不是自动启用的

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-10-11T22:15:48.803

我们的客户使用以下工具来测试从 Authorize.Net 网关发送的静默 post url 请求。

只需将以下网址添加到您的静默帖子设置中，然后更改电子邮件地址即可将结果发送到您选择的电子邮件。

**网址：**

[http://www.silentposturl.com/action/email/index.php?support@silentposturl.com](http://www.silentposturl.com/action/email/index.php?support@silentposturl.com)

# ruby - 自动化具有输入的 Ruby Gem 安装

> ID：103918
> 
> 赞同：1
> 
> 时间：2008-09-19T17:31:33.780
> 
> 标签：ruby, database, automation, rubygems, db2

我正在尝试安装 ibm_db gem，以便可以从 Ruby 访问 DB2。当我尝试：

```
sudo gem install ibm_db 
```

我收到以下澄清请求：

```
选择要为您的平台安装的 gem (i486-linux)
 1.ibm_db 0.10.0（红宝石）
 2.ibm_db 0.10.0 (mswin32)
 3.ibm_db 0.9.5 (mswin32)
 4.ibm_db 0.9.5（红宝石）
 5.跳过这个宝石
 6.取消安装

```

我总是要安装 linux 版本（我假设是“ruby”版本），所以有没有办法直接从 gem install 命令中选择我要安装的版本？

这是一个问题的原因是我需要通过 bash 脚本自动执行此安装，所以我想提前选择我想要“ruby”版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:07:55.427

您可以使用“此处文档”。那是：

```
sudo gem install ibm_db <<heredoc
  1
heredoc 
```

\<\<\SOMETHING 和 SOMETHING 之间的内容被输入为上一个命令的条目（有点像 ruby​​ 自己的 heredocuments）。当然，其中的 1 是“ibm_db 0.10.0 (ruby)”平台的选择。

希望够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T17:56:30.897

试试这个：

```
sudo gem install --platform ruby ibm_db 
```

请注意，您可以使用以下命令获取有关安装命令的帮助：

```
gem help install 
```

* * *

**更新：**看起来这个选项只适用于 RubyGems 0.9.5 或更高版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T18:03:37.277

@[约翰托普利](https://stackoverflow.com/questions/103918/automate-a-ruby-gem-install-that-has-input#104102)

我已经尝试过 gem help install ，而 --platform 在帮助和实践中都不是一个选项：

```
$ sudo gem install ibm_db --platform ruby
错误：执行 gem 时...（OptionParser::InvalidOption）
    无效选项：--platform

```

* * *

**更新**：Ubuntu repos 有 0.9.4 版本的 ruby​​gems，它没有 --platform 选项。看来它可能是[0.9.5 中的一个新功能](http://rubyforge.org/forum/forum.php?forum_id=23112)，但仍然没有它的在线文档，无论如何，它无法在我需要它工作的平台 Ubuntu 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T18:12:50.093

试试这个，我认为它只适用于 Bash

```
sudo gem install ibm_db < <(echo 1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T18:41:00.447

1.0 及更高版本的 Rubygems 会自动检测您正在运行的平台，因此不会问这个问题。您可以将您的宝石更新到最新版本吗？

```
$ sudo gem update --system 
```

更新后，如果您在 Windows 上，请收到警告；你可能会遇到[这个问题](https://stackoverflow.com/questions/43778/sqlite3-ruby-gem-failed-to-build-gem-native-extension)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T18:51:34.477

另一种选择是下载 .gem 文件并手动安装，如下所示：

```
sudo gem install path/to/ibm_db-0.10.0.gem 
```

这颗特殊的宝石在[ruby​​forge](http://rubyforge.org/frs/?group_id=2361&release_id=25677)。

# ruby-on-rails - 你如何实现一个返回上次访问页面的 URL 的函数

> ID：103919
> 
> 赞同：1
> 
> 时间：2008-09-19T17:31:33.813
> 
> 标签：ruby-on-rails, ruby

我想将当前 URL 存储在会话变量中以引用先前访问的页面。

如果我存储每个 URL（通过 ApplicationController 上的 before_filter），则以重定向结尾的操作（创建、更新等）也被视为上次访问的页面。

有没有办法告诉 Rails 只在渲染模板时执行一个函数？

**更新**

感谢 after_filter 提示...写了这么多 before_filters 我没有看到明显的内容。但是@performed_redirect 的技巧不起作用-

这是我到目前为止得到的

```
class ApplicationController < ActionController::Base

  after_filter :set_page_as_previous_page

  def set_page_as_previous_page
    unless @performed_redirect
      flash[:previous_page] = request.request_uri
    else
      flash[:previous_page] = flash[:previous_page]
    end
  end

end 
```

我需要实现一个“返回”链接，而不使用 Javascript，即 HTTP Referer。抱歉，如果我应该提到这一点，我感谢您的帮助！

**更新 2**

我找到了一个解决方案，它不是很优雅，只有在您的应用程序遵循标准命名方案时才有效

```
def after_filter   
    if File.exists?(File.join(Rails.root,"app","views", controller_path, action_name+".html.erb"))
      flash[:previous_page] = request.request_uri
    else
      flash[:previous_page] = flash[:previous_page]
    end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:47:29.480

不确定为什么`@performed_redirect`不起作用，您可以通过调用此测试控制器上的操作来查看它确实存在并具有所需的值：

```
class RedirController < ApplicationController
  after_filter :redir_raise

  def raise_true
    redirect_to :action => :whatever
  end

  def raise_false
    render :text => 'foo'
  end

  private

  def redir_raise
    raise @performed_redirect.to_s
  end

end 
```

顺便说一句，而不是做

```
flash[:previous_page] = flash[:previous_page] 
```

你可以做

```
flash.keep :previous_page 
```

（我的补丁，那个。回到过去：P）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T16:05:53.520

确定响应是重定向还是渲染的另一种可能方法是检查状态代码：

```
class ApplicationController < ActionController::Base

  after_filter :set_page_as_previous_page

  def set_page_as_previous_page
    unless 302 == request.status  #redirecting
      flash[:previous_page] = request.request_uri
    else
      flash[:previous_page] = flash[:previous_page]
    end
  end

end 
```

似乎真的应该有一个重定向？ActionController::Base 中的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T17:37:10.290

可以更具体一点吗？我无法得到您的问题-通过模板您的意思是渲染：视图，布局？还是仅在使用 render :template 调用时？

渲染页面？render :action=>:new 也是一个页面...您能否更具体地说明您要捕获的内容以及要排除的内容？

看到接受的答案:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T17:40:15.413

控制器将具有这些变量，这可能会有所帮助：

```
@performed_render
@performed_redirect 
```

但无论如何，你究竟是如何存储网址的？向我们展示过滤器代码。为什么不使用`after_filter`?

# java - 连接关闭时结果集未关闭？

> ID：103938
> 
> 赞同：49
> 
> 时间：2008-09-19T17:35:35.767
> 
> 标签：java, jdbc, findbugs

我一直在对我们的一个宠物项目进行代码审查（主要使用 FindBugs 之类的工具），并且 FindBugs 将以下代码标记为错误（伪代码）：

```
Connection conn = dataSource.getConnection();

try{
    PreparedStatement stmt = conn.prepareStatement();
    //initialize the statement
    stmt.execute();
    ResultSet rs =  stmt.getResultSet();
    //get data
}finally{
    conn.close();
} 
```

错误是此代码可能不会释放资源。我发现 ResultSet 和 Statement 没有关闭，所以我最终将它们关闭：

```
finally{
    try{
        rs.close()
    }catch(SqlException se){
        //log it
    }
    try{
        stmt.close();
    }catch(SqlException se){
        //log it
    }
    conn.close();
} 
```

但是我在很多项目（来自不少公司）中都遇到了上述模式，并且没有人关闭 ResultSets 或 Statements。

当连接关闭时，您是否遇到过结果集和语句未关闭的问题？

我只发现了[这个](http://www.theserverside.com/discussions/thread.tss?thread_id=41036)，它指的是 Oracle 在关闭连接时遇到关闭 ResultSets 的问题（我们使用 Oracle db，因此我进行了更正）。java.sql.api 在 Connection.close() javadoc 中什么也没说。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-09-19T18:00:44.100

仅关闭连接而不关闭结果集的一个问题是，如果您的连接管理代码正在使用连接池，则只`connection.close()`会将连接放回池中。此外，某些数据库在服务器上有游标资源，除非显式关闭，否则无法正确释放。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-19T17:42:14.940

即使连接已关闭，我在 Oracle 中也遇到了未关闭的 ResultSets 的问题。我得到的错误是

```
"ORA-01000: maximum open cursors exceeded" 
```

所以：总是关闭你的结果集！

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-19T19:32:00.980

您应该始终明确关闭所有 JDBC 资源。正如 Aaron 和 John 已经说过的，关闭连接通常只会将其返回到池中，并且并非所有 JDBC 驱动程序都以完全相同的方式实现。

这是一个可以在 finally 块中使用的实用方法：

```
public static void closeEverything(ResultSet rs, Statement stmt,
        Connection con) {
    if (rs != null) {
        try {
            rs.close();
        } catch (SQLException e) {
        }
    }
    if (stmt != null) {
        try {
            stmt.close();
        } catch (SQLException e) {
        }
    }
    if (con != null) {
        try {
            con.close();
        } catch (SQLException e) {
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-19T17:50:15.297

在这种情况下，Oracle 会给你关于打开游标的错误。

根据：http: [//java.sun.com/javase/6/docs/api/java/sql/Statement.html](http://java.sun.com/javase/6/docs/api/java/sql/Statement.html)

看起来重用语句将关闭任何打开的结果集，关闭语句将关闭任何结果集，但我没有看到任何关于关闭连接会关闭它创建的任何资源的信息。

所有这些细节都留给 JDBC 驱动程序提供者。

明确关闭所有内容总是最安全的。我们编写了一个 util 类，它使用 try{ xxx } catch (Throwable {} 包装所有内容，这样您就可以调用 Utils.close(rs) 和 Utils.close(stmt) 等，而不必担心关闭扫描可能会抛出的异常.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-19T18:53:01.137

ODBC 桥可以使用某些 ODBC 驱动程序产生内存泄漏。

如果您使用良好的 JDBC 驱动程序，那么关闭连接应该不会有任何问题。但是有2个问题：

*   你知道你是否有一个好司机吗？
*   以后还会使用其他的 JDBC 驱动吗？

最好的做法是全部关闭。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-19T20:07:18.947

我在一个大型 J2EE Web 环境中工作。我们有几个数据库可以在一个请求中连接。我们的一些应用程序开始出现逻辑死锁。问题如下：

1.  用户会请求页面
2.  服务器连接到 DB 1
3.  DB 1 上的服务器选择
4.  服务器“关闭”与 DB 1 的连接
5.  服务器连接到 DB 2
6.  僵局！

发生这种情况有两个原因，我们遇到的流量远高于正常情况，并且默认情况下 J2EE 规范实际上不会关闭您的连接，直到线程完成执行。因此，在上面的示例中，步骤 4 从未真正关闭连接，即使它们在 finally 中正确关闭。

要解决此问题，您必须为数据库连接使用 web.xml 中的资源引用，并且必须将 res-sharing-scope 设置为不可共享。

例子：

```
<resource-ref>
    <description>My Database</description>
    <res-ref-name>jdbc/jndi/pathtodatasource</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
    <res-sharing-scope>Unshareable</res-sharing-scope>
</resource-ref> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-19T17:56:19.587

我肯定看到了未关闭的 ResultSets 的问题，并且一直关闭它们会有什么伤害，对吧？需要记住这样做的不可靠性是迁移到为您管理这些细节的框架的最佳理由之一。这在您的开发环境中可能不可行，但我很幸运使用 Spring 来管理 JPA 事务。打开连接、语句、结果集和编写过于复杂的 try/catch/finally 块（在 finally 块中使用 try/catch 块*！*）以再次关闭它们的杂乱细节消失了，让您真正完成一些工作. 我强烈建议迁移到这种解决方案。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-19T18:00:03.650

在 Java 中，语句（不是结果集）与 Oracle 中的游标相关联。最好关闭您打开的资源，因为 JVM 和系统资源可能会发生意外行为。

此外，一些 JDBC 池框架池语句和连接，因此不关闭它们可能不会将这些对象标记为池中的空闲，并导致框架中的性能问题。

通常，如果对象上有 close() 或 destroy() 方法，则有理由调用它，而忽略它会造成后果自负。

# apache-flex - Flex：组合框控件的自定义项目渲染器截断文本

> ID：103945
> 
> 赞同：2
> 
> 时间：2008-09-19T17:36:14.160
> 
> 标签：apache-flex, actionscript, mxml

我已经实现了一个自定义项目渲染器，我在我正在处理的 flex 项目中使用了一个组合框。它显示每个项目的图标和一些文本。唯一的问题是，当文本很长时，菜单的宽度没有被正确调整，并且在显示时文本被截断。我尝试调整所有明显的属性来缓解这个问题，但没有取得任何成功。有谁知道如何使组合框菜单宽度适当地缩放到它呈现的任何数据？

我的自定义项目渲染器实现是：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml"
    styleName="plain" horizontalScrollPolicy="off"> 

    <mx:Image source="{data.icon}" />
    <mx:Label text="{data.label}" fontSize="11" fontWeight="bold" truncateToFit="false"/>

</mx:HBox> 
```

我的组合框像这样使用它：

```
 <mx:ComboBox id="quicklinksMenu" change="quicklinkHandler(quicklinksMenu.selectedItem.data);" click="event.stopImmediatePropagation();" itemRenderer="renderers.QuickLinkItemRenderer" width="100%"/> 
```

编辑：我应该澄清一下：我可以将组合框上的 dropdownWidth 属性设置为任意大的值 - 这将使一切都合适，但它会太宽。由于此组合框中显示的数据是通用的，因此我希望它自动将自身调整为 dataprovider 中最大的元素（flex 文档说它会这样做，但我觉得我的自定义项目渲染器以某种方式破坏了这种行为）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T18:08:43.893

只是一个随机的想法（不知道这是否会有所帮助）：

尝试将父 HBox 和标签的宽度设置为 100%。这通常可以解决我遇到的任何类似问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T18:27:21.260

您是否尝试过使用**calculatePreferredSizeFromData()**方法？

```
protected override function calculatePreferredSizeFromData(count:int):Object 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T21:37:18.190

这个答案可能为时已晚，但我对 DataGrid 的列宽有一个非常相似的问题。

经过多次思考，我决定在私有 TextField 中预渲染我的文本，从中获取渲染文本的宽度，并在所有适当的调整大小类型事件上显式设置列的宽度。有点hack-y，但如果你没有很多变化的数据，效果就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-06T16:14:36.680

如果您查看 的`measure`方法`mx.controls.ComboBase`，您会看到组合框将其计算`measuredMinWidth`为文本宽度和组合框按钮宽度之和。

```
 // Text fields have 4 pixels of white space added to each side
    // by the player, so fudge this amount.
    // If we don't have any data, measure a single space char for defaults
    if (collection && collection.length > 0)
    {
        var prefSize:Object = calculatePreferredSizeFromData(collection.length);

        var bm:EdgeMetrics = borderMetrics;

        var textWidth:Number = prefSize.width + bm.left + bm.right + 8;
        var textHeight:Number = prefSize.height + bm.top + bm.bottom 
                    + UITextField.TEXT_HEIGHT_PADDING;

        measuredMinWidth = measuredWidth = textWidth + buttonWidth;
        measuredMinHeight = measuredHeight = Math.max(textHeight, buttonHeight);
    } 
```

`calculatePreferredSizeFromData`@defmeta 提到的方法（在 中实现`mx.controls.ComboBox`）假设数据渲染器只是一个文本字段，并用于从对象`flash.text.lineMetrics`中的标签字段计算文本宽度`data`。如果您想向项目渲染器添加一个额外的视觉元素，并`ComboBox`在计算它自己的大小时考虑它的大小，您将必须扩展`mx.controls.ComboBox`类并重写该`calculatePreferredSizeFromData`方法，如下所示：

```
 override protected function calculatePreferredSizeFromData(count:int):Object
  {
      var prefSize:Object = super.calculatePrefferedSizeFromData(count);
      var maxW:Number = 0;
      var maxH:Number = 0;
      var bookmark:CursorBookmark = iterator ? iterator.bookmark : null;
      var more:Boolean = iterator != null;

      for ( var i:int = 0 ; i < count ; i++)
      {
          var data:Object;
          if (more) data = iterator ? iterator.current : null;
          else data = null;
          if(data)
          {
              var imgH:Number;
              var imgW:Number;

              //calculate the image height and width using the data object here

              maxH = Math.max(maxH, prefSize.height + imgH);
              maxW = Math.max(maxW, prefSize.width + imgW);
          }
          if(iterator) iterator.moveNext();
      }

      if(iterator) iterator.seek(bookmark, 0);
      return {width: maxW, height: maxH};
 } 
```

如果可能，将图像尺寸存储在数据对象中并将这些值用作`imgH`和`imgW`，这将使调整大小更加容易。

编辑：

`maxH`如果您要向渲染中添加除图像之外的元素（如标签），您还必须在遍历数据元素时计算它们的大小，并在计算和时考虑这些尺寸`maxW`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-16T10:02:55.233

你需要做两件事：

*   对于文本，使用`mx.controls.Text`（支持文本换行）而不是 mx.controls.Label
*   set comboBox's `dropdownFactory.variableRowHeight=true`-- 这个 dropdownFactory 通常是 List 的子类，您在 ComboBox 上设置的 itemRenderer 将用于渲染列表中的每个项目

并且，不要显式设置`comboBox.dropdownWidth`——让 h 的默认值`comboBox.widt`用作下拉菜单的宽度。

# reporting-services - SSRS - ReportViewer LocalReport 设置 SubReport 参数值

> ID：103976
> 
> 赞同：1
> 
> 时间：2008-09-19T17:40:22.513
> 
> 标签：reporting-services, reportviewer

如何以编程方式设置子报表的参数？对于顶级报告，您可以执行以下操作：

```
reportViewer.LocalReport.SetParameters
(
    新的 Microsoft.Reporting.WebForms.ReportParameter[]
    {
        新的 Microsoft.Reporting.WebForms.ReportParameter("ParameterA", "Test"),
        新的 Microsoft.Reporting.WebForms.ReportParameter("ParameterB", "1/10/2009 10:30 AM"),
        新的 Microsoft.Reporting.WebForms.ReportParameter("ParameterC", "1234")
    }
);

```

像上面这样传递参数似乎只将它们传递给顶级报表，而不是子报表。

LocalReport 允许您处理 SubreportProcessing 事件。这将传递给您一个 SubreportProcessingEventArgs 实例，该实例具有类型 ReportParameterInfoCollection 的属性。此集合中的值是只读的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-20T17:46:46.777

将参数添加到父报表并从父报表（在实际报表定义中）设置子报表参数值。这是我读过的。请让我知道这对你有没有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-02-01T18:40:51.647

将参数设置为 <Expression...> 并使用公式生成器添加父参数。

# vba - 在 Word VBA 中指定新内联形状的位置？

> ID：103980
> 
> 赞同：2
> 
> 时间：2008-09-19T17:40:44.057
> 
> 标签：vba, ms-word

我正在为我工​​作的公司编写文档“向导”。它是一个 .dot 文件，其标题由一些文本和一些表单字段以及大量 VBA 代码组成。文档正文作为 OLE 对象从单独的 .doc 文件中提取。

目前，这是作为一个`Shape`，而不是一个`InlineShape`。我这样做是因为我可以绝对定位 Shape，而 InlineShape 总是出现在文档的开头。

这样做的问题是`Shape`当标题的大小发生变化时 a 不会移动。如果有人由于特殊情况需要在标题中添加或删除一行，他们还需要移动定义正文的对象。这是一种痛苦，如果可能的话，我想避免它。

长话短说，如何`InlineShape`在 Word 中定位使用 VBA？

我使用的版本是 Word 97。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T17:58:20.363

InlineShape 被视为一个字母。因此，同样的技术。

```
ThisDocument.Range(15).InlineShapes.AddPicture "1.gif" 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-24T16:55:49.487

我的最终代码最终`ThisDocument.Paragraphs`用于获得我需要的范围。但是 GSerg 为我指出了正确的方向，即使用 a`Range`将我的对象放在需要的位置。

# c - 寻找元组匹配算法

> ID：103989
> 
> 赞同：12
> 
> 时间：2008-09-19T17:41:33.523
> 
> 标签：c, algorithm

我需要在 C 中实现内存中的字符串元组匹配功能。将有大量与不同操作相关联的元组列表以及要与列表匹配的大量事件。

元组列表：

```
("one", "four")
("one")
("three")
("four", "five")
("six") 
```

event ("one", "two", "three", "four") 应该匹配列表项 ("one", "four") and ("one") and ("three") 但不匹配 ("four", “五”）而不是（“六”）

我当前的方法使用所有元组字段值的映射作为使用该值的每个元组列表的键。有很多冗余的散列和列表插入。

有没有正确或经典的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T18:11:21.970

如果您只有少量可能的元组值，那么编写某种散列函数可以将它们转换为整数索引以进行快速搜索是有意义的。

如果有 < 32 个值，您可以使用位掩码做一些事情：

```
unsigned int hash(char *value){...}

typedef struct _tuple {
    unsigned int bitvalues;
    void * data
} tuple;

tuple a,b,c,d;
a.bitvalues  = hash("one");
a.bitvalues |= hash("four");
//a.data = something;

unsigned int event = 0;
//foreach value in event;
event |= hash(string_val);

// foreach tuple
if(x->bitvalues & test == test)
{
     //matches
} 
```

如果有太多的值来做位掩码解决方案，你可以有一个链表数组。浏览事件中的每个项目。如果项目与 key_one 匹配，则使用第一个键遍历元组并检查第二个键的事件：

```
typedef struct _tuple {
    unsigned int key_one;
    unsigned int key_two;
    _tuple *next;
    void * data;
} tuple;

tuple a,b,c,d;
a.key_one = hash("one");
a.key_two = hash("four");

tuple * list = malloc(/*big enough for all hash indexes*/
memset(/*clear list*/);

//foreach touple item
if(list[item->key_one])
   put item on the end of the list;
else
   list[item->key_one] = item;

//foreach event
   //foreach key
      if(item_ptr = list[key])
        while(item_ptr.next)
           if(!item_ptr.key_two || /*item has key_two*/)
              //match
           item_ptr = item_ptr.next; 
```

这段代码没有经过测试，可能有很多小错误，但你应该明白。（纠正的一个错误是元组匹配的测试条件）

* * *

如果事件处理速度是最重要的，那么遍历所有构造的元组是有意义的，计算出现的次数并可能重新排序每个元组的键一/键二，以便首先列出最唯一的值.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T17:15:48.483

一种可能的解决方案是为每个单词分配一个唯一的素数。

然后，如果您将每个元组中的单词相乘，那么您将得到一个表示列表中单词的数字。

Divide one list by another, and if you get an integer remainder, then the one list is contained in the other.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T18:05:33.717

我不知道任何经典或正确的方法来做到这一点，所以这就是我会做的：P

看起来您想使用集合论行话来确定 A 是否是 B 的超集。一种方法是对 A 和 B 进行排序，然后对 A 和 B 执行合并排序操作，即尝试查找 B 中的值在 A 中的位置。B 的那些也在 A 中的元素将具有重复项，而其他元素则不会。因为 A 和 B 都已排序，所以这应该不会太可怕。

例如，您取 B 的第一个值，然后遍历 A，直到在 A 中找到它的重复项。然后您取 B 的第二个值，并从您之前离开的地方开始遍历 A。如果你在没有找到匹配的情况下到达 A 的末尾，那么 A 不是 B 的超集，并且你返回 false。

如果这些元组可以保持排序，那么排序成本只会产生一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T18:24:20.893

如果您有少量可能的字符串，您可以为每个字符串分配一个索引并使用位图。这样一个简单的按位会告诉你是否有重叠。

如果这不切实际，您的倒排索引设置可能很难匹配速度，特别是如果您只需要构建一次。（元组列表在运行时会改变吗？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T18:25:10.813

```
 public static void Main()
    {
        List<List<string>> tuples = new List<List<string>>();

        string [] tuple = {"one", "four"};
        tuples.Add(new List<string>(tuple));

        tuple = new string [] {"one"};
        tuples.Add(new List<string>(tuple));

        tuple = new string [] {"three"};
        tuples.Add(new List<string>(tuple));

        tuple = new string[]{"four", "five"};
        tuples.Add(new List<string>(tuple));

        tuple = new string[]{"six"};
        tuples.Add(new List<string>(tuple));

        tuple = new string[] {"one", "two", "three", "four"};

        List<string> checkTuple = new List<string>(tuple);

        List<List<string>> result = new List<List<string>>();

        foreach (List<string> ls in tuples)
        {
            bool ok = true;
            foreach(string s in ls)
                if(!checkTuple.Contains(s))
                {
                    ok = false;
                    break;
                }
            if (ok)
                result.Add(ls);
        }
    } 
```