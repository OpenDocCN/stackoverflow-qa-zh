# StackOverflow 问答 10606000-10606999

# c# - Upscaling a bitmap with no smoothing is inaccurate somehow, how to make it right?

> ID：10606000
> 
> 赞同：1
> 
> 时间：2012-05-15T17:39:35.953
> 
> 标签：c#, image, scaling, system.drawing

```
Bitmap outputBitmap = new Bitmap(inputBitmap.Width * 5, inputBitmap.Height * 5);

using (Graphics graphics = Graphics.FromImage(outputBitmap))
    {                        
    graphics.CompositingQuality =
        System.Drawing.Drawing2D.CompositingQuality.HighQuality;
    graphics.InterpolationMode =
        System.Drawing.Drawing2D.InterpolationMode.NearestNeighbor;
    graphics.SmoothingMode =
        System.Drawing.Drawing2D.SmoothingMode.HighQuality;

    graphics.DrawImage(inputBitmap, 0, 0,
        inputBitmap.Width * 5, inputBitmap.Height * 5);
    } 
```

The result is an upscaled image offset by a few pixels in direction of top left corner. ![what it should look like and what it looks like](../Images/fdbc76cb8988da1cb202da43248cdc7f.png)

How do I make this right?

# python - 如何使用 pygame 在屏幕上放置整个像素阵列？

> ID：10606003
> 
> 赞同：1
> 
> 时间：2012-05-15T17:39:41.427
> 
> 标签：python, arrays, pygame, pixel

使用 javascript 和画布，您可以为每个像素填充颜色数组，然后将其放在屏幕上。我如何使用 pygame 在 python 中做到这一点？一个很小的例子就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:06:29.850

下面是我创建的一个简单示例：

```
import pygame, sys, random
from pygame.locals import *

arr=[]
RED=(255,10,10)
BLU=(10,255,10)
GRN=(10,10,255)
arr.append(RED)
arr.append(BLU)
arr.append(GRN)
SCREEN_X=100
SCREEN_Y=100

screen = pygame.display.set_mode((SCREEN_X, SCREEN_Y))
square=pygame.Surface((1, 1))

for j in range (SCREEN_Y):
    for i in range (SCREEN_X):
        num=random.randint(0,2)
        square.fill(arr[num])
        draw_me=pygame.Rect((j+1), (i+1), 1, 1)
        screen.blit(square,draw_me)
pygame.display.flip() 
```

我用红蓝绿填充了一个数组，然后随机选择一种颜色来绘制。

希望能帮助到你

# python - 如何计算给定日期的 SQL 表中列的总和，并用最接近的前一个日期的值修补缺失值？

> ID：10606009
> 
> 赞同：1
> 
> 时间：2012-05-15T17:40:09.637
> 
> 标签：python, mysql, sql, date, sum

我有一个看起来像这样的表：

```
+-----+-----------+------------+
| id  |     value |       date |
+-----+-----------+------------+
| id1 |      1499 | 2012-05-10 |
| id1 |      1509 | 2012-05-11 |
| id1 |      1511 | 2012-05-12 |
| id1 |      1515 | 2012-05-13 |
| id1 |      1522 | 2012-05-14 |
| id1 |      1525 | 2012-05-15 |
| id2 |      2222 | 2012-05-10 |
| id2 |      2223 | 2012-05-11 |
| id2 |      2238 | 2012-05-13 |
| id2 |      2330 | 2012-05-14 |
| id2 |      2340 | 2012-05-15 |
| id3 |      1001 | 2012-05-10 |
| id3 |      1020 | 2012-05-11 |
| id3 |      1089 | 2012-05-12 |
| id3 |      1107 | 2012-05-13 |
| id3 |      1234 | 2012-05-14 |
| id3 |      1556 | 2012-05-15 |
| ... |       ... |        ... |
| ... |       ... |        ... |
| ... |       ... |        ... |
+-----+-----------+------------+ 
```

`value`我想要做的是为每个日期生成此表中所有数据的列的总和。`id`每天有一个条目。问题是某些 ids 没有所有天的值，例如**id2 没有日期的值：2012-05-11**

我想要做的是：当给定日期没有特定 id 的值时，则在总和中计算前一个日期的值（更接近给定日期）。

例如，假设我们只有上面显示的数据。我们可以从此查询中获取特定日期的所有值的总和：

```
SELECT SUM(value) FROM mytable WHERE date='2012-05-12'; 
```

结果将是：1511 + 1089 = **2600**

但我想要的是做一个查询来做这个计算：1511 + **2223** + 1089 = **4823**

以便添加日期 2012-05-11 的**2223**而`id2`不是*错过*的值：

```
| id2 |  2223 | 2012-05-11 | 
```

你知道如何通过 SQL 查询来做到这一点吗？或通过脚本？例如蟒蛇..

* * *

每个日期我有数千个 id，所以如果可能的话，我希望查询快一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T18:20:24.123

这并不漂亮，因为它必须将您的表的四个副本连接到自身，这可能会导致各种性能问题（我*强烈*建议您在`id`and上设置索引`date`）......但这会解决问题：

```
SELECT   y.report_date, SUM(x.value)
FROM     mytable AS x
  NATURAL JOIN (
    SELECT   a.id, b.date AS report_date, MAX(c.date) AS date
    FROM     (SELECT DISTINCT id   FROM mytable) a JOIN
             (SELECT DISTINCT date FROM mytable) b JOIN
             mytable AS c ON (c.id = a.id AND c.date <= b.date)
    GROUP BY a.id, b.date
 ) AS y
GROUP BY y.report_date 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/d5d28/4)上查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:18:00.453

我能想到的 SQL 解决方案不是很漂亮（在值列上的 case 语句中的子选择与日期序列表的右连接......这很丑陋。）所以我会去蟒蛇版本：

```
import pyodbc
#connect to localhost
conn = pyodbc.connect('Driver={MySQL ODBC 5.1 Driver};Server=127.0.0.1;Port=3306;Database=information_schema;User=root; Password=root;Option=3;')
cursor = conn.cursor()

sums = {}  ## { id : { 'dates': [], 'values': [], 'sum': 0 } }      # sum is optional, you can always just sum() on the values list.

query = """SELECT
    id, value, date
FROM mytable
ORDER BY date ASC, id ASC;"""

## note that I use "fetchall()" here because in my experience the memory
## required to hold the result set is available. If this is not the case
## for you, see below for a row-by-row streaming

for row in cursor.execute(query).fetchall():
    id = sums.get(row['id'], {'dates' : [], 'values': [], 'sum': 0})
    if len(id['date']) > 0: # previous records exist for id
        # days diff is greater than 1
        days = row['date'] - id['dates'][-1]).days  
        ## days == 0, range(0) == [], in which case the loop steps won't be run
        for d in range(1, days):   
            id['dates'].append(id['dates'][-1] + datetime.timedelta(days = 1))  # add date at 1 day increments from last date point
            id['values'].append(id['values'][-1])  # add value of last date point again
            id['sum'] = id['sum'] + id['values'][-1]    # add to sum
        ## finally add the actual time point
        id['dates'].append(row['date'])
        id['values'].append(row['value'])
        id['sum'] = id['sum'] + row['value']

    else: # this is the first record for the id
        sums[row['id']] = {'dates': [row['date']], 'values': [row['value']], 'sum': row['value'] } 
```

替代的逐行流式循环：

```
cursor.execute(query)
while 1:
    row = cursor.fetchone()
    if not row:
        break
    id = sums.get(row['id'], {'dates' : [], 'values': [], 'sum': 0})
    if len(id['date']) > 0: # previous records exist for id
        # days diff is greater than 1
        days = row['date'] - id['dates'][-1]).days  
        ## days == 0, range(0) == [], in which case the loop steps won't be run
        for d in range(1, days):   
            id['dates'].append(id['dates'][-1] + datetime.timedelta(days = 1))  # add date at 1 day increments from last date point
            id['values'].append(id['values'][-1])  # add value of last date point again
            id['sum'] = id['sum'] + id['values'][-1]    # add to sum
        ## finally add the actual time point
        id['dates'].append(row['date'])
        id['values'].append(row['value'])
        id['sum'] = id['sum'] + row['value']

    else: # this is the first record for the id
        sums[row['id']] = {'dates': [row['date']], 'values': [row['value']], 'sum': row['value'] } 
```

完成后不要忘记关闭连接！

```
conn.close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:09:30.910

您可能需要多考虑一下列的语义`date`。

也许您应该添加一列并创建`date`一个范围。

您所做的任何不涉及记录数据的操作都可能很慢。对您的请求的字面解释可能需要`date`遍历每个值的总和。

# css - 悬停 li 使用 css 更改图像

> ID：10606011
> 
> 赞同：2
> 
> 时间：2012-05-15T17:40:10.633
> 
> 标签：css, hover

试图找到一种在将鼠标悬停在 LI 上时更改主图像的方法

查看[Using only CSS, show div on hover over <a>](https://stackoverflow.com/questions/5210033/show-div-on-hover-with-only-css)我想我可以让它工作，但是当我移动 div 时它当然不再工作了。

下面是我将如何使用 JavaScript 来做这件事 - 你能告诉我如何在同一个 html 上使用纯 CSS 做同样的事情吗？

```
<html>
<head>
<script>
var myImages = {li1:"image1.jpg",li2:"image2.jpg",li3:"image3.jpg"};
window.onload=function() {
  var lis = document.getElementById('myList').getElementsByTagName('li');
  for (var i=0;i<lis.length;i++) {
    lis[i].onmouseover=function() {
       document.getElementById('image1').src=myImages[this.id];
    }
  }
}
</script>
</head>
<body>
<img id="image1" />
<ul id="myList">
<li id="li1">show image1</li>
<li id="li2">show image2</li>
<li id="li3">show image3</li>
</ul>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:22:36.680

根据您的评论要求：

[http://jsfiddle.net/wjBjZ/](http://jsfiddle.net/wjBjZ/)

这是一个基本示例，显示列表和图像按照您的要求运行。使用定位进行微调。

实施您的评论

[http://jsfiddle.net/QgJTN/2/](http://jsfiddle.net/QgJTN/2/)

```
#main {
    position: absolute;
    top: 0px;
    left: 10px;
    border: solid 5px red;
}
#myList{
    background: #ccc;
    position: absolute;
    top:110px;
}
#myList span{
    cursor: pointer;
}
#myList img{
    display: none;
    width: 100px;
    height: 100px;
    position: absolute;
    top: -110px;
    left: 10px;
    border: solid 5px red;
}
#myList li:hover{
    background: #888;
}
#myList li:hover img{
    display:block;
} 
```

HTML

```
<img id="main" src="http://lorempixel.com/100/100/abstract/" />
<ul id="myList">
    <li>
        <span>List Item One</span>
        <img src="http://lorempixel.com/100/100/abstract/" />
    </li>
    <li>
        <span>List Item Two</span>
        <img src="http://lorempixel.com/100/100/fashion/" />
    </li>
    <li><span>List Item Three</span>
        <img src="http://lorempixel.com/100/100/city/" />
    </li>
</ul> 
```

# javascript - Decimal values for yAxis categories in Highcharts

> ID：10606019
> 
> 赞同：5
> 
> 时间：2012-05-15T17:40:31.520
> 
> 标签：javascript, highcharts

I need my yAxis categories to be 0 = 'Poor', 0.25 = 'Below Average', 0.75 = 'Average' 1="Good"

I set the categories right, but Highcharts seems to interpret each point I plot to be equal to "1" step on the yAxis. See [http://jsfiddle.net/54cFG/](http://jsfiddle.net/54cFG/)

Ideally, that chart should *always* show 4 labels on the yAxis and the plotted points should line up at "Below Average" and "Average".

Is there a setting I'm missing? I think I pretty much tried everything at [http://www.highcharts.com/ref/](http://www.highcharts.com/ref/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:00:55.360

您始终可以使用绘图带在 Y 轴上显示类别。这样你仍然可以保留实际值。[**我在这里**](http://jsfiddle.net/54cFG/1/)用你的代码证明了这一点。

**编辑**

这是另一个去掉网格线的[**例子**](http://jsfiddle.net/54cFG/3/)，每个 plotBands 都有自己的颜色。如果您想更改其中的任何一个，这是[**颜色图表。**](http://www.december.com/html/spec/colorrgbadec.html)

如果您更喜欢使用绘图带而不使用 y 轴标签，这里是一个[**例子**](http://jsfiddle.net/54cFG/4/)。我认为它工作得很好。如果用户真的想看到确切的值，他们可以将鼠标悬停在该点上。

# ruby - Optionally calling a block in ruby

> ID：10606025
> 
> 赞同：0
> 
> 时间：2012-05-15T17:40:54.313
> 
> 标签：ruby

I have two ways I might need to call some code using a block.

Option 1:

```
foo() 
```

Option 2:

```
block_function do 
  foo()
end 
```

How do I switch between the two of these at runtime? I really don't want to do the following, because `foo()` is actually a whole lot of code:

```
if condition then
    foo()
else
    block_function do 
      foo()
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:29:05.767

```
def condition_or_block_function
  if condition
    yield
  else
    block_function { yield }
  end
end

condition_or_block_function do
  foo() # which is really a lot of code :)
end 
```

或者像其他人建议的那样，将`foo()`一堆代码变成一个实际的方法，然后写下你在 OP 中写的东西。

@tadman 建议的更通用的版本：

```
def condition_or_block condition, block_method, *args
  if condition
    yield
  else
    send(block_method, *args) { yield }
  end
end

condition_or_block(some_condition, some_block_yielding_method) do
  foo() # which is really a lot of code :)
end 
```

@Christian Oudard 添加了一条注释，指定了具体问题，可以选择使用 div do...end with Erector 装饰代码块。这提出了另一种方法：

```
class BlockWrapper
  def initialize(method=nil)
    @method = method
  end
  def decorate
    @method ? send(method) { yield } : yield
  end
end

wrapper = BlockWrapper.new( condition ? nil : :div )

wrapper.decorate do
  #code block
end 
```

# php - 未定义的索引：在 PHP codeigniter 中，同时发送变量

> ID：10606026
> 
> 赞同：1
> 
> 时间：2012-05-15T17:41:17.200
> 
> 标签：php, mysql, codeigniter

我的控制器：

```
public function thread($page = 'empty')
{

    $data['user_id'] = $this->tank_auth->get_user_id();
    $data['username'] = $this->tank_auth->get_username();
    //User data variable grab
    //default template load data
    $data['thread'] = $this->thread_model->get_thread($page);
    $data['title'] = ucfirst($page); // Capitalize the first letter
    $data['replies'] = $this->thread_model->get_reply($data['thread']['thread_id']);
    $this->thread_model->view_increment($data);
    $this->load->view('templates/head', $data);
    $this->load->view('main/wrapper-start', $data);
    $this->load->view('templates/leftbar', $data);
    $this->load->view('main/thread', $data);
    $this->load->view('main/wrapper-end', $data);
    $this->load->view('templates/footer', $data);

} 
```

错误出现在该`$data['replies']`行：

> 严重性：通知
> 
> 消息：未定义的索引：thread_id
> 
> 文件名：控制器/main.php
> 
> 行号：40

这是我的模型代码，回复指的是：`$this->thread_model->get_reply`

```
public function get_reply($thread_id)
{

    $query = $this->db->query("SELECT r.reply_id FROM reply_thread rt
    INNER JOIN replies r
    ON rt.reply_id = r.reply_id
    WHERE thread_id = ". $thread_id);
    $replies = $query->result_array();
    $replyarray = array();
    foreach ($replies as $reply)
    {
        $id = $reply['reply_id'];
        $query = $this->db->query("SELECT * FROM replies WHERE reply_id='$id'");
        $thisRow = $query->row_array();
        $replyarray[] = $thisRow;
    }

    return $replyarray;
} 
```

任何想法为什么会弹出此错误？除了错误之外，页面加载得很好……所有信息都完好无损，可以通过查询获得。

这是我的 get_thread 模型

```
public function get_thread($page)
{
    $slug = $page;
    $query = $this->db->get_where('thread', array('slug' => $slug));
    return $query->row_array();
} 
```

使用`print_r($data['thread']);`我得到这个数组：

```
Array ( [thread_id] => 233 [owner_id] => 8 [subject] => Repercussions of D3 addiction [body] => 1\. signs of unhygienic practices 2.become irritable when forced to stop playing 3\. carpal tunnel 4\. loss of interest in pursuing a significant other 5\. sleep deprivation 6\. malnutrition There's nothing positive about this. [timestamp] => 2012-05-08 19:03:02 [replystamp] => 2012-05-09 12:38:32 [last_post_id] => 3 [slug] => 233-repercussions-of-d3-addiction [replies_num] => 2 [views] => 21 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T08:10:34.997

我想你可以试试这个：

```
$threadinfo = $this->thread_model->get_thread($page);
$data['thread'] = $threadinfo;
$data['replies'] = $this->thread_model->get_reply($threadinfo->thread_id); 
```

# php - 制作没有标准按钮的新页面

> ID：10606033
> 
> 赞同：-8
> 
> 时间：2012-05-15T17:41:35.500
> 
> 标签：php, jquery, css

我想要`chatroom`用户之间的程序和私人聊天。点击聊天侧边栏中的每个用户名，打开新页面，比如`chatbox`漂亮的图层，没有标准按钮，比如关闭或最小化。

示例：[图片](http://up.vatandownload.com/images/dq2vod8v1dn2vd1hse9e.jpg)

***代码***

```
 <a href="javavoid()" onclick="privatechat()">User1</a>
 <a href="javavoid()" onclick="privatechat()">User2</a>
 <a href="javavoid()" onclick="privatechat()">User3</a> 
```

单击名称时如何设计此页面并打开此页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:03:34.143

好吧，如果我理解正确，您确实在寻找创建一个基于 Web 的聊天应用程序（如 Facebook 聊天），对吗？

我们无法为您提供代码，那是您的工作，但我可以为您提供您认为有用的教程资源。

[http://net.tutsplus.com/tutorials/javascript-ajax/how-to-create-a-simple-web-based-chat-application/](http://net.tutsplus.com/tutorials/javascript-ajax/how-to-create-a-simple-web-based-chat-application/)

或者您可能会在这里找到任何有用的脚本[http://php.resourceindex.com/Complete_Scripts/Chat/](http://php.resourceindex.com/Complete_Scripts/Chat/)

祝你好运！

# php - 如何有效地获取匹配的 Amazon S3 文件列表？

> ID：10606034
> 
> 赞同：3
> 
> 时间：2012-05-15T17:41:39.587
> 
> 标签：php, optimization, amazon-s3, amazon-web-services, file-exists

假设一个平面 Amazon S3 存储桶中有 200,000 个图像。

桶看起来像这样：

```
000000-1.jpg
000000-2.jpg
000000-3.jpg
000000-4.jpg
000001-1.jpg
000001-2.jpg
000002-1.jpg
...
ZZZZZZ-9.jpg
ZZZZZZ-10.jpg 
```

（一个 6 位哈希，后跟一个计数，然后是扩展名）

如果我需要所有匹配的文件`000001-*.jpg`，最有效的方法是什么？

在 PHP 中，我会`rglob($path,'{000001-*.jpg}',GLOB_BRACE)`用来获取一系列匹配项，但我认为这不能远程工作。

我可以获取存储桶中所有文件的列表，然后在数组中查找匹配项，但这似乎是一个昂贵的请求。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:23:14.390

Amazon 提供了一种直接使用 S3 api 执行此操作的方法。

您可以`prefix`在调用列出 S3 对象时使用该选项以仅返回以前缀开头的对象。例如使用适用于 PHP 的 AWS 开发工具包：

```
// Instantiate the class
$s3 = new AmazonS3();

$response = $s3->list_objects('my-bucket', array(
    'prefix' => '000001-'
));

// Success?
var_dump($response->isOK());
var_dump(count($response->body->Contents)) 
```

您可能还会发现该`delimiter`选项很有用 - 您可以使用它来获取所有唯一 6 位哈希的列表。

# iphone - 需要自定义 UIView 中的 UIButton 响应触摸

> ID：10606035
> 
> 赞同：0
> 
> 时间：2012-05-15T17:41:42.690
> 
> 标签：iphone, uiview, touchesbegan, touchesmoved

我有一个带有一些按钮作为子视图的自定义 UIView。我正在使用 touchesBegan/Moved/Ended 来用用户的手指旋转视图。问题是，当我尝试从按钮拖动/旋转视图时，`touches`不会调用这些方法。我需要按钮来响应`UIControlEventTouchUpInside`事件，但如果它与视图一起拖动，则使我的视图旋转。我已经查看了[这个](https://stackoverflow.com/questions/3046813/how-can-i-click-a-button-behind-a-transparent-uiview)问题和[这个](https://stackoverflow.com/questions/3427619/disable-touches-on-uiview-background-so-that-buttons-on-lower-views-are-clickabl)问题，但都无法找到适合我的解决方案。

这是我的自定义视图代码：

```
- (id)initWithFrame:(CGRect)frame andRadius:(float)Radius andViews:

(NSMutableArray *)AllViews
{
    self = [super initWithFrame:frame];
    if (self) {
        radius = Radius;
        allViews = AllViews;

        for(int i = 0; i < [allViews count]; i++){
            //the "currentView" is a UIButton
            UIView *currentView = (UIView *)[allViews objectAtIndex:i];
            [currentView setFrame:CGRectMake(frame.size.width / 2 - 25 + radius * cos((2 * M_PI / [allViews count]) * i), frame.size.height / 2 - 25 + radius * sin((2 * M_PI / [allViews count]) * i), 50, 50)];
            [self addSubview:currentView];

        }
        [self setBackgroundColor:[UIColor redColor]];
        [self setAlpha:.5];

    }
    return self;
}

//- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event
//{
//    for (UIView * view in [self subviews]) {
//        if ([view pointInside:[self convertPoint:point toView:view] withEvent:event]) {
//            return YES;
//        }
//    }
//    return NO;
//}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView:self];

    x = point.x;
    y = point.y;

    NSLog(@"touchesBegan");
} 

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView:self];

    float X = point.x;
    float Y = point.y;

    float a = sqrt(X * X + Y * Y);
    float b = sqrt(x * x + y * y);
    float c = sqrt((x - X) * (x - X) + (y - Y) * (y - Y));

    float alpha = acos((a * a + b * b - (c * c)) / (2 * a * b));
    if(alpha == NAN)
        alpha = 0;

    alpha = -alpha;

    [UIView beginAnimations:@"rotate" context:nil];
    [UIView setAnimationDuration:0];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    self.transform = CGAffineTransformRotate(self.transform, alpha);
    [UIView commitAnimations];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView:self];

    float X = point.x;
    float Y = point.y;

    float a = sqrt(X * X + Y * Y);
    float b = sqrt(x * x + y * y);
    float c = sqrt((x - X) * (x - X) + (y - Y) * (y - Y));

    float alpha = acos((a * a + b * b - (c * c)) / (2 * a * b));

    alpha = -alpha;

    [UIView beginAnimations:@"rotate" context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];
    self.transform = CGAffineTransformRotate(self.transform, alpha);
    [UIView commitAnimations];
    NSLog(@"touchesEnded");
}

- (void)dealloc
{
    [allViews release];
    [super dealloc];
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:25:14.223

也许不是您正在寻找的答案，但是：

我不确定为什么您希望“手指按下按钮然后将手指拖出按钮”活动作为拖动/旋转动作被按钮后面的视图拾取。就我而言，如果您将手指放在按钮内，则您正在与按钮交互，而不是与后面的视图交互；如果您在仍然触摸屏幕的同时将手指从按钮上移开，那么您这样做是为了中止按钮按下（即您已经“武装”它但没有“触发”它），而不是与后面的视图交互。

所以我要说的是：你为什么要这样做？也许你需要重新考虑你的 UI 设计。

如果你绝对想这样做，你可能想看看 using `UIGestureRecognizer`s 而不是`touchesBegan`etc - 你可以在使用它们时更轻松地设置更复杂的场景。但手势识别器并非在所有版本的 iOS 上都可用。

或者，实现一些看起来像按钮或任何你想要的东西，并使用 touchesBegan 等处理它的触摸（以及视图拖动等） - 即不要使用实际的按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:42:59.940

万一有人遇到类似的问题，我会发布我使用的解决方案。我覆盖了另一个`UIView`用作按钮的类。在每个 中`touchedBegan/Moved/Ended`，我实现了按钮单击所需的代码，然后将命令链向上传递到下一个 custom `UIView`，如下所示：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self.nextResponder touchesBegan:touches withEvent:event];
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self.nextResponder touchesMoved:touches withEvent:event];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView:self];

    if (point.x < self.frame.size.width && point.y < self.frame.size.height) {
        NSDictionary *userInfo = [[NSDictionary alloc] initWithObjectsAndKeys:[NSString stringWithFormat:@"%d", self.tag], @"tag", nil];
        [[NSNotificationCenter defaultCenter] postNotificationName:@"ChangeFilter" object:self userInfo:userInfo];
    }

    [self.nextResponder touchesEnded:touches withEvent:event];
} 
```

请注意，我使用 NSNotifications 将操作发送到`ViewController`包含被覆盖视图的我。

# ios - 使用 Scaleform 进行游戏资产渲染，而不仅仅是 UI

> ID：10606040
> 
> 赞同：3
> 
> 时间：2012-05-15T17:41:49.260
> 
> 标签：ios, scaleform

有没有人尝试在 iOS 游戏中使用 Scaleform 进行实际游戏资产渲染，而不仅仅是 UI。目标是利用将通过 Scaleform 转换为多边形的矢量 swf，但具有驱动游戏的 C++ 代码（无 AS3）。如果您尝试过，您对结果有何感受？它的渲染速度够快吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-12T14:46:07.180

Scaleform 已在多个 iOS 游戏中用作整个引擎（包括 AS3）。这里有些例子：

TinyThief：http: [//inthefold.autodesk.com/in_the_fold/2013/07/5-ants-brings-tiny-thief-to-ios-and-android-with-autodesk-scaleform-mobile-sdk.html](http://inthefold.autodesk.com/in_the_fold/2013/07/5-ants-brings-tiny-thief-to-ios-and-android-with-autodesk-scaleform-mobile-sdk.html)

你不认识杰克：http: [//inthefold.autodesk.com/in_the_fold/2013/01/you-dont-know-jack-qa.html](http://inthefold.autodesk.com/in_the_fold/2013/01/you-dont-know-jack-qa.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-21T23:32:16.083

您当然可以为此目的使用 Scaleform。Scaleform 包括允许 C++ 管理 Flash 资源的直接访问 API (DAPI)（这包括在运行时创建符号实例并管理它们的状态 + 生命周期）。

GFx::Value 类是 DAPI 的基础，应该提供大部分（如果不是全部）您需要的功能。您可能仍然需要一些 AS3 代码来将一些东西粘合在一起，但这应该可以忽略不计。

静态矢量内容的性能取决于形状的复杂性（更多路径、更多样式 => 更多三角形 + 批次）。我会尝试限制矢量（形状）时间线动画的数量，因为形状变形会导致重新镶嵌。缩放矢量内容也会导致重新镶嵌，因此请记住这一点。

# jquery - 如何使用 jquery 将整个部分添加到一堆 html 元素中？

> ID：10606045
> 
> 赞同：1
> 
> 时间：2012-05-15T17:42:30.690
> 
> 标签：jquery

我想在 div id="primary" 的内容中添加一段 class="box"，不包括 h1。我的html如下。

```
<div id="primary">

    <h1 class="page-title">Search Results for: dffd</h1>        

        <h2>Nothing Found</h2>
        <p>Sorry, but nothing matched your search criteria. Please try again with some different keywords.</p>

 </div> <!--end #primary --> 
```

所以我想要实现的是

```
<div id="primary">

  <h1 class="page-title">Search Results for: dffd</h1>  

 <section class="box">

        <h2>Nothing Found</h2>
        <p>Sorry, but nothing matched your search criteria. Please try again with some different keywords.</p>

   </section>

 </div> <!--end #primary --> 
```

**编辑：犯了一个错误，我不希望我的 h1 在该部分中，已修改问题**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T17:43:56.433

使用[jQuery 的 wrapInner](http://api.jquery.com/wrapInner/)：

```
$('#primary').wrapInner('<section class="box" />'); 
```

--**编辑**--

看到你修改过的问题，试试这个：

```
// Wrap the contents in with the section
$('#primary').wrapInner('<section class="box" />');

// Detach (remove, but retain events/data) the <h1>, then prepend it to the primary div
$('#primay .box h1').detach().prependTo('#primary'); 
```

当然，有很多方法可以做到这一点。

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T17:57:32.303

```
$('#primary').children().not('h1').wrapAll('<section class="box"></section>'); 
```

# android - 如何在android中同时启动两个动画？

> ID：10606053
> 
> 赞同：27
> 
> 时间：2012-05-15T17:43:12.893
> 
> 标签：android, animation

我有两个线性布局，我想同时在这两个布局上执行两个不同的动画。

现在它以顺序方式工作。即，在完成一个之后开始另一个。

这是我的代码。

```
 Animation inFromRight = new TranslateAnimation(
                    Animation.RELATIVE_TO_PARENT, +0.0f,
                    Animation.RELATIVE_TO_PARENT, 0.0f,
                    Animation.RELATIVE_TO_PARENT, 0.0f,
                    Animation.RELATIVE_TO_PARENT, 0.0f);
            inFromRight.setDuration(500);
            inFromRight.setInterpolator(new AccelerateInterpolator());

    Animation outtoLeft = new TranslateAnimation(
                    Animation.RELATIVE_TO_PARENT, 0.0f,
                    Animation.RELATIVE_TO_PARENT, -1.0f,
                    Animation.RELATIVE_TO_PARENT, 0.0f,
                    Animation.RELATIVE_TO_PARENT, 0.0f);
            outtoLeft.setDuration(500);
            outtoLeft.setInterpolator(new AccelerateInterpolator());

    @Override
        public void onClick(View v) {
            switch (v.getId()) {
            case R.id.menu:
                            mainLayout.startAnimation(outtoLeft);
                sideBar.startAnimation(inFromRight);                
                break;
            }
        }

outtoLeft.setAnimationListener(new AnimationListener() {
            @Override
            public void onAnimationStart(Animation animation) {
            }

            @Override
            public void onAnimationRepeat(Animation animation) {
            }

            @Override
            public void onAnimationEnd(Animation animation) {
                mainLayout
                        .setLayoutParams(new LayoutParams(
                                LayoutParams.FILL_PARENT,
                                LayoutParams.FILL_PARENT, 40));

            }
        }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-15T18:38:47.373

我认为您需要使用`AnimationSet`.

从[文档](http://developer.android.com/reference/android/view/animation/AnimationSet.html)：

> 表示应该一起播放的一组动画。每个单独动画的变换组合在一起成为一个变换。

[在这里](http://groups.google.com/group/android-developers/browse_thread/thread/9df24ac25f01cee9/6e0eac7802a541e3)你可以看到 an`AnimationSet`应该是怎样的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-15T00:21:15.967

在您的活动中

```
ImageView reusableImageView = (ImageView)findViewById(R.id.imageView1);
reusableImageView.setImageResource(R.drawable.flag);
reusableImageView.setVisibility(View.VISIBLE);
Animation an =  AnimationUtils.loadAnimation(this, R.anim.yourAnimation);
reusableImageView.startAnimation(an); 
```

然后，在 yourAnimation.xml 中定义你想要的所有动画

```
<set
xmlns:android="http://schemas.android.com/apk/res/android"
android:shareInterpolator="false">
<scale
    android:pivotX="50%"
    android:pivotY="50%"
    android:fromXScale="1.0"
    android:fromYScale="1.0"
    android:toXScale="2.0"
    android:toYScale="2.0"
    android:duration="2500" />
<scale
    android:startOffset="2500"
    android:duration="2500"
    android:pivotX="50%"
    android:pivotY="50%"
    android:fromXScale="1.0"
    android:fromYScale="1.0"
    android:toXScale="0.5"
    android:toYScale="0.5" />
<rotate
    android:fromDegrees="0"
    android:toDegrees="360"
    android:pivotX="50%"
    android:pivotY="50%"
    android:duration="5000" />
</set> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T18:44:47.003

解决这个问题的方法是使用带有[Animator](https://developer.android.com/reference/android/animation/AnimatorSet.html)对象的[AnimatorSet 。](https://developer.android.com/reference/android/animation/Animator.html)如果您担心向后兼容性，可以使用 NineOldAndroids 库将 API 一路带回 Android 1.0

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-01T19:04:49.463

我解决了它在第一个动画的 onAnimationStart 事件中开始第二个动画。在我的示例中，右布局替换了左布局，它们都同时向左移动。我使用 View 类[http://developer.android.com/reference/android/view/View.html#animate()](http://developer.android.com/reference/android/view/View.html#animate())的 animate 属性，该属性可从 API v.12 开始使用

```
leftLayout.animate()
    .translationX(-leftLayout.getWidth()) // minus width
    .setDuration(300)
    .setListener(new AnimatorListenerAdapter() {
        @Override
        public void onAnimationStart(Animator animation) {
            rightLayout.animate()
                    .translationX(-leftLayout.getWidth()) // minus width
                    .setDuration(300)
                    .setListener(new AnimatorListenerAdapter() {
                        @Override
                        public void onAnimationEnd(Animator animation) {
                            leftLayout.setVisibility(View.GONE);
                            leftLayout.setTranslationX(0f); // discarding changes
                            rightLayout.setTranslationX(0f);
                        }
                    });
        }
}); 
```

# printing - 带有 .tmp 扩展名的假脱机文件的文件格式？

> ID：10606054
> 
> 赞同：3
> 
> 时间：2012-05-15T17:43:24.483
> 
> 标签：printing, postscript, spool, spooler

在许多 Windows 设置中，当您直接打印到打印机时，通常会在 Windows 假脱机目录“C:\Windows\System32\spool\PRINTERS”中创建两个文件。假脱机文件“80021.SPL”和影子文件“80021.SHD”是这些文件的示例。假脱机文件包含绘图指令的肉和土豆，因此打印机可以打印页面。根据语言技术和使用的打印驱动程序，此假脱机文件中的数据采用不同格式的大杂烩。但是，当您打印到打印服务器上的打印机时，会创建一个“.TMP”文件并将其传输到打印服务器。我认为可以公平地假设这只是将 .SHD 和 .SPL 文件组合成一个传输文件以将其发送到服务器。但是，它不可读，我 m n 确定它是压缩的、加密的还是什么，但我无法破译它。打印 PDF 时，您通常可以在假脱机文件 (.SPL) 中看到纯文本 PostScript 指令，只需将其打开并在文本编辑器中查看即可。您甚至可以将该假脱机文件 (.SPL) 发送到像 GhostScript 这样的 postscript 查看器，并让它显示在屏幕上绘制的页面。但是当工作全部打包在一个 .TMP 文件中时，它基本上只是一堆二进制文件。 **有谁知道如何从这些传输 .TMP 假脱机文件中解压缩数据？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T03:03:43.330

我相信您拥有的文件将是一个 EMF 文件，该文件在开始时填充了专有的 MS 结构。确定您是否正在处理 EMF 结构的最简单方法是在您拥有的 tmp 文件中查找 ANSI 字符“EMF”。

假设您确实找到了这些字符，只需从文件开头删除专有结构数据，然后将其视为标准 EMF 文件。幸运的是，所有 EMF 文件都有标准的标题格式，因此应该合理地确定 EMF 文件的开始位置。

[这里](http://msdn.microsoft.com/en-us/library/cc230635%28v=prot.10%29.aspx)对 EMF 文件头有很好的描述

# asp.net - 用户名的会话变量

> ID：10606055
> 
> 赞同：0
> 
> 时间：2012-05-15T17:43:26.693
> 
> 标签：asp.net

嘿，我正在创建一个论坛，用户可以在其中登录并在论坛中发布 ocmments，我希望将用户名作为会话变量，以便在他们发表评论并将用户名插入数据库时​​获取它，并显​​示用户好消息.

下面是我的登录代码：

```
protected void Button1_Click(object sender, EventArgs e)
{
    DataSet ds = new DataSet();
    localhost.Service1 myws = new localhost.Service1();
    ds = myws.GetUsers();
    foreach (DataRow row in ds.Tables[0].Rows)
        if (txtusername.Text == System.Convert.ToString(row["username"]) &&
        txtpassword.Text == System.Convert.ToString(row["password"]))
        {
            System.Web.Security.FormsAuthentication.RedirectFromLoginPage(txtusername.Text, false);
        }
        else
            Label3.Text = "Invalid Username/Password";
} 
```

我在这里声明会话变量吗？

像：

```
Session["username"] = "username"; 
```

也不确定输入什么来从数据库中获取值用户名

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:45:08.697

您不需要使用会话。调用该`FormsAuthentication.RedirectFromLoginPage`方法后，在目标页面内，您可以使用此方法发出的身份验证 cookie 访问当前连接的用户`User.Identity.Name`。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (User.Identity.IsAuthenticated)
    {
        string username = User.Identity.Name;
        // ...
    }
} 
```

要了解有关表单身份验证如何在 ASP.NET 中工作的更多信息，我邀请您阅读[以下文章](http://msdn.microsoft.com/en-us/library/ff647070.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T17:51:14.007

您已经在使用`FormsAuthentication.RedirectFromLoginPage(txtusername.Text, false)`很棒的表单身份验证 ( )。`User.Identity.Name`因此，正如 Darin 所指出的，您不需要存储用户名是 session，因为它已经可以通过 获得 。

我写了两篇关于表单身份验证的教程，您可能会觉得有用：

*   [表单身份验证概述](http://www.asp.net/web-forms/tutorials/security/introduction/an-overview-of-forms-authentication-cs)
*   [表单身份验证配置和高级主题](http://www.asp.net/web-forms/tutorials/security/introduction/forms-authentication-configuration-and-advanced-topics-cs)

此外，考虑使用会员资格。Membership 是 ASP.NET 中内置的一个子系统，它处理用户帐户并提供用于创建帐户、删除帐户等的 API。简而言之，您不必自己编写所有代码。使用登录 Web 控件，创建新帐户、登录用户、重置密码等都非常简单，涉及零到很少的代码。有关更多信息，请参阅我的[会员教程](http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs)。

快乐编程！

# r - 回归分析还是方差分析？

> ID：10606056
> 
> 赞同：2
> 
> 时间：2012-05-15T17:43:32.810
> 
> 标签：r, statistics, regression, lm, anova

我希望能做到最清楚。假设我有一个包含 10 个变量的数据集，其中 4 个变量代表我称为 Y 的某种现象。另外 6 个代表我称为 X 的另一种现象。

这些变量（10）中的每一个都包含 37 个单位。这些单位只是我的分析（调查）的受访者。由于所有问题均基于李克特量表，因此它们是定性变量。所有这些的比例都是从 0 到 7，但是缺少答案的地方有“-1”和“-2”值。因此，比例实际上是从 -2 到 7。

我想要做的是计算我的 Y（在这种情况下包含 4 个变量，每个变量有 37 个答案）和我的 X（包含 6 个变量和相同数量的受访者）之间的回归。我知道对于定性分析，我应该使用 Anova 而不是回归，尽管我在某处读到甚至可以进行回归。

到目前为止，我一直试图以这种方式行事：

```
> apply(Y, 1, function(Y) mean(Y[Y>0])) #calculate the average per rows (respondents) without considering the negative values

> Y.reg<- c(apply(Y, 1, function(Y) mean(Y[Y>0]))) #create the vector Y, thus it results like 1 variable with 37 numbers

> apply(X, 1, function(X) mean(X[X>0]))

> X.reg<- c(apply(X, 1, function(X) mean(X[X>0]))) #create the vector X, thus it results like 1 variable with 37 numbers

> reg1<- lm(Y.reg~ X.reg) #make the first regression
> summary(reg1) #see the results
Call:
lm(formula = Y.reg ~ X.reg)

Residuals:
     Min         1Q       Median      3Q       Max 
-2.26183 -0.49434 -0.02658  0.37260  2.08899 

Coefficients:
               Estimate  Std. Error   t value   Pr(>|t|)    
(Intercept)     4.2577     0.4986     8.539    4.46e-10 ***
 X.reg          0.1008     0.1282     0.786    0.437    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

Residual standard error: 0.7827 on 35 degrees of freedom
Multiple R-squared: 0.01736,    Adjusted R-squared: -0.01072 
F-statistic: 0.6182 on 1 and 35 DF,  p-value: 0.437 
```

但是正如你所看到的，虽然我不使用由 4 个变量组成的 Y 和由 6 个组成的 X，并且我也不考虑负值，但我的 R^2 得分非常低。

如果我改为使用方差分析，我会遇到这个问题：

```
> Ymatrix<- as.matrix(Y)
> Xmatrix<- as.matrix(X) #where both this Y and X are in their first form, thus composed by more variables (4 and 6) and with negative values as well.

> Errore in UseMethod("anova") : 
  no applicable method for 'anova' applied to an object of class "c('matrix', 'integer', 'numeric')" 
```

老实说，几天前我成功使用了anova，但不幸的是我不记得如何并且我没有将命令保存在任何地方。

我想知道的是：

*   首先，我处理问题的方式错了吗？
*   您如何看待回归输出？
*   最后，我该怎么做才能制作方差分析？如果我必须这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-05T08:34:54.450

我不同意丹尼的回答。无论您拥有何种数据类型，您都可以使用任何一种方法。如果您有分类数据，则可以使用虚拟编码将其表示为数字。例如，给定具有 3 个选项的特征 x，例如 1、2 和 3，您可以通过创建 3 个新的附加变量 x1、x2 和 x3 将其编码为数字。如果 x 为 1，则 x1 为 1，x2 为 0，x3 为 0。如果 x 缺失，则三个新的 x 值都将为零。

在您的情况下，我建议您首先尝试回归，因为您拥有的功能数量众多，而且它往往是直截了当的。随着特征数量的增加，方差分析会变得复杂。假设您的数据满足两种技术所需的假设，两者都应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T04:14:40.073

如果您的响应 (Y) 和预测变量 (x) 是数字刻度，则可以使用回归。如果您的响应 (Y) 是数字尺度，而预测变量 (x) 是分类尺度，则可以使用 ANOVA。

建议：

在使用回归方法之前，您必须使用有效性和可靠性测试来了解答案（指标）对于响应和预测变量是否有效且可靠。

# sql-server-2008 - T-SQL 错误“无效的列名”在运行时引用了我的过程名称

> ID：10606058
> 
> 赞同：0
> 
> 时间：2012-05-15T17:43:38.557
> 
> 标签：sql-server-2008, tsql

我正在将存储过程从一个数据库复制到另一个数据库。我目前正在使用以下方式获取存储过程：

```
select OBJECT_DEFINITION(OBJECT_ID(N'dbo.' + @stored_procedure_name, 'P')) 
```

并将返回的字符串存储在变量中`@stored_procedure_defn`。

然后我运行该过程：

```
exec(@stored_procedure_defn) 
```

但是我目前收到错误

> 列名“stored_procedure_name”无效

这可能是什么原因造成的？我已经尝试了几个不同的程序，他们唯一一次提到他们的名字是在`create procedure [dbo].['stored_procedure_name']`.

**编辑**对不起我的错误在别处。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T17:46:42.980

听起来存储过程引用了“新”数据库中不存在的列。请注意，该表存在，但列 ( `stored_proceudre_name`) 不存在。

根据您发布的内容，无效列名称和您的 memvar 名称的相似性似乎只是巧合。

# php - 从 ID 数组中获取数据库结果

> ID：10606062
> 
> 赞同：1
> 
> 时间：2012-05-15T17:43:52.287
> 
> 标签：php, mysql, select, multidimensional-array, pdo

为这个问题的新鲜感道歉。我刚刚开始一个项目，我有一组 ID 可以从表中获取某些记录。解决这个问题的最佳方法是什么？

下面的工作吗？

```
public function getWork($slideIDs) {
    $params = array();
    $params = $slideIDs;

    $count = count($params);

    for($i=0;$i<$count;$i++) {
        $STH = $this->_db->prepare("SELECT * 
            FROM slides
            WHERE slideID = :slideID;");

        $STH->execute($params[$i]);
    }

    $result = $STH->fetchAll(PDO::FETCH_ASSOC);

    return $result;       
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T17:48:10.947

调整您的 PHP 以创建具有以下格式的单个查询字符串：

```
SELECT * 
FROM slides
WHERE slideID IN (2,5,11) 
```

不要执行多个查询。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T17:48:25.557

最好使用 IN 子句只执行一条 SQL 语句

```
SELECT * FROM slides WHERE slideID IN (1,2,3,4,5, ...) 
```

由于较少的连接和访问数据库通常会更好地提高性能。

因此，只需在循环中构建该 SQL 字符串，然后将 Execute 移动到底部（在循环之外。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T17:53:08.863

和其他人一样;)

用于`implode($array, ",")`获取应该进入`IN()`语句的部分

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T18:02:09.883

以下应该工作。使用 implode 创建所需的字符串，其中包含用逗号分隔的 ID 以传递给 SQL。

```
 function getWork($slideIDs) {
    $params = implode(",",$slideIDs);
    $STH = $this->_db->prepare("SELECT * 
            FROM slides
            WHERE slideID in ( :slideID );");

    $STH->execute($params);

    $result = $STH->fetchAll(PDO::FETCH_ASSOC);

    return $result;   
    } 
```

# java - java中，同步方法的使用会不会不可靠？

> ID：10606063
> 
> 赞同：1
> 
> 时间：2012-05-15T17:43:52.297
> 
> 标签：java, methods, concurrency, synchronized

直奔主题，我编写了一个代码来测试java中的并发性，使用同步方法：

代码：

```
public class ThreadTraining {

    public static class Value {

        private static int value;

        public static synchronized void Add() {
            value++;
        }

        public static synchronized void Sub() {
            value--;
        }

        public static synchronized int Get() {
            return value;
        }
    }

    public static class AddT implements Runnable {

        public static String name;

        public AddT(String n) {
            name = n;
        }

        @Override
        public void run() {
            while (Value.Get() < 100) {
                int prev = Value.Get();
                Value.Add();
                System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
            }
        }
    }

    public static class SubT implements Runnable {

        public static String name;

        public SubT(String n) {
            name = n;
        }

        @Override
        public void run() {
            while (Value.Get() > (-100)) {
                int prev = Value.Get();
                Value.Sub();
                System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
            }
        }
    }

    public static void main(String[] args) {
        Thread threads[] = new Thread[3];
        for (int i = 0; i < 4; i++) {
            if (i % 2 == 0) {
                threads[i] = new Thread(new AddT("Adder - Thread #" + i));
            } else {
                threads[i] = new Thread(new SubT("Subtractor - Thread #" + i));
            }
            threads[i].start();
        }
    }
} 
```

尽管*“同一对象上同步方法的两次调用不可能交错”，但这段代码的执行并不可靠。*（来源：[Oracle 的并发教程 - 同步方法](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)），给出不可靠的输出，如下所示：（注意，输出中的**任何非模式变化**都在“...”行之间表示，**而不仅仅是不可靠的行为**）

```
-----[Thread #0 - Adder] has been created!
=====[Thread #0 - Adder] has been started!
-----[Thread #1 - Subtractor] has been created!
[Thread #0 - Adder] - changed value from 0 to 1
[Thread #0 - Adder] - changed value from 1 to 2
[Thread #0 - Adder] - changed value from 2 to 3
...\*goes on, adding as expected, for some lines*\
[Thread #0 - Adder] - changed value from 83 to 84
[Thread #0 - Adder] - changed value from 84 to 85
-----[Thread #2 - Adder] has been created!
=====[Thread #1 - Subtractor] has been started!
[Thread #0 - Adder] - changed value from 85 to 86
[Thread #1 - Subtractor] - changed value from 86 to 85
[Thread #1 - Subtractor] - changed value from 86 to 85
[Thread #1 - Subtractor] - changed value from 85 to 84
...\*goes on, subtracting as expected, for some lines*\
[Thread #1 - Subtractor] - changed value from -98 to -99
[Thread #1 - Subtractor] - changed value from -99 to -100 \*This thread ends here, as it reaches the state where (value>(-100))==false*\
=====[Thread #2 - Adder] has been started!
[Thread #2 - Adder] - changed value from -100 to -99
[Thread #2 - Adder] - changed value from -99 to -98
[Thread #2 - Adder] - changed value from -98 to -97
...\*goes on as expected...*\
[Thread #2 - Adder] - changed value from -67 to -66
[Thread #2 - Adder] - changed value from -66 to -65
-----[Thread #3 - Subtractor] has been created!
=====[Thread #3 - Subtractor] has been started!
[Thread #3 - Subtractor] - changed value from -65 to -66
[Thread #3 - Subtractor] - changed value from -66 to -67
...\*goes on as expected...*\
[Thread #3 - Subtractor] - changed value from -71 to -72
[Thread #3 - Subtractor] - changed value from -72 to -73 \*NOTE: From -73 it goes to -74, without a Subtractor-action in between! WTF???*\
[Thread #2 - Adder] - changed value from -74 to -73
[Thread #2 - Adder] - changed value from -73 to -72
...\*goes on as expected...*\
[Thread #2 - Adder] - changed value from 98 to 99
[Thread #2 - Adder] - changed value from 99 to 100 \*This adder ends here, adder thread #0 probably ends after next line...but not before doing something crazy!*\
[Thread #0 - Adder] - changed value from 85 to 86 \*What the hell are these values doing here? Oh wait, next lines is...*\
[Thread #3 - Subtractor] - changed value from -73 to -47\*...Holy mother of god!*\
[Thread #3 - Subtractor] - changed value from 100 to 99
[Thread #3 - Subtractor] - changed value from 99 to 98
...
[Thread #3 - Subtractor] - changed value from -98 to -99
[Thread #3 - Subtractor] - changed value from -99 to -100 \*The logical nightmare is finally over.*\ 
```

使用同步方法不可靠吗？还是实施有误？（如果是这样，那么有什么问题？以及如何解决它？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T17:51:10.933

你的实现有点偏离。'Get'、'Add' 和 'Sub' 都被锁定了，但是你的 'Get' 和你的加减之间有一个差距。刚刚执行“获取”的线程可以在该间隙中休息，其他人会更改该值。如果您希望多个方法调用都作为单个操作发生，则需要在比单个方法“更大”的东西上进行同步。

```
synchronized (Value.class) {
  int prev = Value.Get();
  Value.Add();
  System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
} 
```

请注意，这仍然有一个问题，当您输入时 <100 可能仍然不正确，因此您应该重新检查它。（当然，锁定 Class 对象并不是您通常想要在“真实”代码中执行的操作 :)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T17:50:10.910

您所看到的*不是*“不可靠”，也不是实施问题。您正在处理大量的竞争条件。例如：

```
while (Value.Get() < 100) {
     // other threads could have called `Add()` or `Subtract()` here
     int prev = Value.Get();
     // other threads could have called `Add()` or `Subtract()` here
     Value.Add();
     // other threads could have called `Add()` or `Subtract()` here
     System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
} 
```

您在此循环中调用`Get()`了 3 次，并且不能保证其他线程在每次调用之间更改了`Get()`. 如果您将代码更改为如下所示，它将产生更一致的输出：

```
while (true) { {
     // only call get once
     int prev = Value.Get();
     if (prev >= 100) {
        break;
     }
     // return the new value from add
     int newValue = Value.Add();
     System.out.println("[" + name + "] - changed value from " + prev + " to " + newValue);
}

// here's the new version of add
public static synchronized int Add() {
    value++;
    return value;
} 
```

`Get()`请注意，在和方法调用之间仍然存在竞争条件，`Add()`因为它是一个测试然后是一个集合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T17:50:54.480

要了解您的代码有什么问题，请考虑以下事项：

```
int prev = Value.Get();
Value.Sub();
System.out.println(... + Value.Get()); 
```

`synchronized`三个操作`Get()`, `Sub()`,中的每一个`Get()`都保证正确和原子地工作。**但是，不能保证在这些操作**和 modify之间不会出现另一个线程`Value`。

每当您需要确保*一系列*操作的原子性时，您应该提供一个一次性`synchronized`执行所有操作的方法，或者使用如下外部`synchronized`块：

```
synchronized (Value.class) {
    int prev = Value.Get();
    Value.Sub();
    System.out.println(... + Value.Get());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T18:35:09.137

这是完美运行的代码。它补充了@Affe 和@Aix 在这里给出的答案。

```
public class ThreadTraining {

    public static class Value {

        private static  int value;

        public static synchronized void Add() {
            value++;

        }

        public static synchronized void Sub() {
            value--;
        }

        public static synchronized int Get() {
            return value;
        }
    }

    public static class AddT implements Runnable {

        public static String name;

        public AddT(String n) {
            name = n;
        }

        @Override
        public void run() {

            while (Value.Get() < 100) {
                 synchronized(Value.class){
                int prev = Value.Get();
                Value.Add();
                System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
            }
            }
        }
    }

    public static class SubT implements Runnable {

        public static String name;

        public SubT(String n) {
            name = n;
        }

        @Override
        public void run() {

            while (Value.Get() > (-100)) {
            synchronized(Value.class){
                int prev = Value.Get();
                Value.Sub();
                System.out.println("[" + name + "] - changed value from " + prev + " to " + Value.Get());
            }
            }
        }
    }

    public static void main(String[] args) {
        Thread threads[] = new Thread[3];
        for (int i = 0; i < 4; i++) {
            if (i % 2 == 0) {
                threads[i] = new Thread(new AddT("Adder - Thread #" + i));
            } else {
                threads[i] = new Thread(new SubT("Subtractor - Thread #" + i));
            }
            threads[i].start();
        }
    }
} 
```

通过不按照修改后的代码所示放置同步块，您可以让线程获取变量值，而不会原子地完成操作。因此导致不一致。

# html - JSP中的Html5 var

> ID：10606065
> 
> 赞同：0
> 
> 时间：2012-05-15T17:44:04.047
> 
> 标签：html, jsp

我目前正在尝试将 HTML5（带画布）中的文本 var 保存到 jsp 中，但不知道该怎么做，或者是否有可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:47:20.260

如果您的意思是“如何将 JSP var 转换为 HTML 5 组件”

```
yourHTML5var = <%=jspvar%> 
```

否则，您将需要 Web 服务将客户端变量提交到服务器以供服务器端使用。一定要清理从客户端发送到服务器的任何内容。祝你好运！

编辑：根据评论 - HTML 5 有一些原生 API 使用：[http](http://today.java.net/article/2010/03/31/html5-server-push-technologies-part-1) ://today.java.net/article/2010/03/31/html5-server-push-technologies-part-1 - 最终虽然你需要一个处理这些请求的服务器端组件

# javascript - 创建类似于数组的对象或扩展 Array 原型

> ID：10606071
> 
> 赞同：2
> 
> 时间：2012-05-15T17:44:30.277
> 
> 标签：javascript

我正在尝试制作类似于数组的东西。

我需要能够“释放”一个索引（将其值设置为未定义），但我不想丢失索引。每当将新项目放入数组时，都应重新使用“已发布”的索引。

我希望能够做类似的事情：

```
example = new MyArray();

a = example.leaseIndex(); // returns 0
example[a] = "example value";

b = example.leaseIndex(); // returns 1
example[b] = "another value";

example.releaseIndex(0);

c = example.leaseIndex(); // returns 0
example[c] = "yet another value"; 
```

在我的示例中，leaseIndex 找到一个可用的索引，或者如果没有可用的索引，则将新项目推送到数组中并返回该项目的索引。

我想这样做，这样数组就不会随着时间的推移而不必要地变大。我无法删除“已发布”项目，因为数组中的每个项目都包含对同一数组中另一个项目的引用。

我在主函数和数组之外的函数和数组上取得了一些成功，以跟踪可用索引并分配和释放它们，但理想情况下，我希望该功能成为主数组的一部分。

我是否必须将我的函数添加到数组（或其原型）中，还是有其他方法？因为并非我的所有阵列都需要此功能。

希望这是有道理的：/

**更新**

我正在尝试存储布线机布局，它本质上是一个网络图（点和关于点如何连接的信息）。

图为织机示例。它有 3 个连接器；红色 (0) 有 2 条线，黄色 (1) 有 3 条线，绿色 (2) 有 2 条线。红色连接器上的一条线是拼接的（允许多条线连接到一条线，蓝色方块）

![在此处输入图像描述](../Images/9ff9dfd5a8327ecf5c0ecbab2afea955.png)

这就是织布机的存放方式。

```
loom = {
    points = [
        { self: 0, list: [ 2 ] },
        { self: 1, list: [ 7 ] },
        { self: 2, list: [ 0 ] },
        { self: 3, list: [ 7 ] },
        { self: 4, list: [ 6 ] },
        { self: 5, list: [ 7 ] },
        { self: 6, list: [ 4 ] },
        { self: 7, owner: 1, list: [ 1, 3, 5 ] }
    ],
    connectors = [
        [ 0, 1 ],
        [ 2, 3, 4 ],
        [ 5, 6 ]
    ]
} 
```

连接器数组中的元素包含点数组中点的索引。每个点对象内的列表数组包含其目的地的索引，这些也是点。

我试图制作函数来帮助更轻松地管理索引，只是想知道是否有办法扩展数组，或者制作包含该功能的类似东西。使用静态函数就可以了，这也是我一直在使用的。我只是想看看我是否可以扩展数组，或者使用类似的东西，所以我不需要使用静态函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:01:06.677

这是一个使用一些静态函数的简单实现（无需大惊小怪）：

```
var hop = function(obj, prop){
    return Object.prototype.hasOwnProperty.call(obj, prop);
};

var leaseIndex = function(arr, value){
    var i;
    for(i=0; i<arr.length; i++){
        if(!hop(arr, i)){
           break;
        }
    }
    arr[i] = value;
    return i;
};

var releaseIndex = function(arr, i){
    delete arr[i];
}; 
```

当然，我不知道这是否是你*真正*想要的，因为我的算法可能是 O(N)，我不确定你是否需要所有这些复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:03:35.957

我会将这些方法添加到数组的原型中，如下所示：

```
Array.prototype.leaseIndex = function () {
   for (var i = 0; i < this.length; i++) {
     if(typeof this[i] === "undefined") {
       return i;
     }
   }
   return this.length;
};
Array.prototype.releaseIndex = function (index) {
  delete this[index];
}; 
```

因此，您的代码将如下所示：

```
example = [];

a = example.leaseIndex(); // returns 0
example[a] = "example value";

b = example.leaseIndex(); // returns 1
example[b] = "another value";

example.releaseIndex(0);

c = example.leaseIndex(); // returns 0
example[c] = "yet another value"; 
```

我希望它有所帮助。

# video - SIP/SDP 提议中 H.264 SPS/PPS 的语法

> ID：10606072
> 
> 赞同：1
> 
> 时间：2012-05-15T17:44:30.413
> 
> 标签：video, sip, h.264, rtp, sdp

根据 RFC 6184：

> H.264 的附件 B 定义了一个封装过程，以通过面向字节流的网络传输此类 NALU。在本备忘录的范围内，附件 B 不相关。

我看到很多这样的 SPS/PPS 示例，包括在 RFC6236 中

```
a=fmtp:99 packetization-mode=0;profile-level-id=42e011; \
      sprop-parameter-sets=Z0LgC5ZUCg/I,aM4BrFSAa 
```

但是，根据 H.264 的附件 B，不应该有逗号，并且必须在 SPS 和 PPS 的开头添加前导码（然后将 SPS/PPS 转换为 base 64）。

所以我不明白什么是正确的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:51:04.800

将 sps 和 pps 分离为两个字节数组。将它们转换为base 64。为每个添加前缀“001”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T04:50:37.563

逗号应该在那里。前缀仅适用于 MPEG-2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T05:14:33.567

简短的答案在上面，这些是规范参考：

[RFC 3984](http://www.ietf.org/rfc/rfc3984.txt)：

> sprop 参数集：
> 
> 该参数可用于传达任何序列和图片参数集 NAL 单元（此处称为初始参数集 NAL 单元），它们必须在解码顺序中的任何其他 NAL 单元之前。该参数不得用于指示任何能力交换过程中的编解码器能力。**参数的值是[1] 的第 7.3.2.1 和 7.3.2.2 节中指定**的初始参数集 NAL 单元的 base64 [6] 表示**. 参数集以解码顺序传送，并且不发生参数集 NAL 单元的成帧。 **逗号用于分隔列表中的任何一对参数集。** 请注意，参数集 NAL 单元中的字节数通常小于 10，但图片参数集 NAL 单元可以包含数百个字节。**

 **其中 [1] 上面是 H.264 规范参考，其 7.3.2.1 和 7.3.2.2 部分定义了**不带**起始码前缀的比特流。

> 7.3.2 原始字节序列有效载荷和 RBSP 尾随位语法 7.3.2.1 序列参数集 RBSP 语法 7.3.2.2 图片参数集 RBSP 语法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T14:24:28.137

逗号分隔 SPS 和 PPS。它们是两个独立的单元（采用附件 B 格式）。**

# javascript - 显示和隐藏动态 jQuery UI 对话框

> ID：10606075
> 
> 赞同：2
> 
> 时间：2012-05-15T17:44:39.147
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-dialog, jquery-dialog

我知道这应该很简单，但它似乎并没有像我希望的那样工作。

我正在尝试为元素“帮助”动态生成 jQuery UI 对话框。

我想在关闭时切换对话框的可见性（对话框中的 x 按钮），然后单击帮助图标。这样，用户应该能够在页面查看期间根据需要多次调出对话框并摆脱它。

```
// On creation of page, run the following to create dialogs for help
// (inside a function called from document.ready())
$("div.tooltip").each(function (index, Element) {
    $(Element).dialog({
        autoOpen: false,
        title: $(Element).attr("title"),
        dialogClass: 'tooltip-dialog'
    });
});
$("a.help").live("click", function (event) {
    var helpDiv = "div#" + $(this).closest("span.help").attr("id");
    var dialogState = $(helpDiv).dialog("isOpen");
    // If open, close. If closed, open.
    dialogState ? $(helpDiv).dialog('close') : $(helpDiv).dialog('open');
}); 
```

编辑：将代码更新到当前版本。dialogState 和 dialog('open')/dialog('close') 的值仍然存在问题。

我可以从每个中的 $(Element).dialog("isOpen") 获得一个真/假值。当我稍后尝试查找元素时（使用稍微不同的选择器），我似乎无法成功调用 $(helpDiv).dialog("isOpen")。这将返回 [] 而不是 true/false。关于我做错了什么有什么想法吗？在这一点上，我已经在这里待了大约一天半......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T17:48:20.643

也许将声明的行替换`dialogState`为`var dialogState = ! $(helpDiv).dialog( "isOpen" );`.

说明：`$(helpDiv).dialog( "option", "hide" )`不测试对话框是否打开。它获取关闭对话框时将使用的效果类型。要测试对话框是否打开，您应该使用`$(helpDiv).dialog( "isOpen" ).`有关详细信息，请参阅[http://jqueryui.com/demos/dialog/#options](http://jqueryui.com/demos/dialog/#options)和[http://jqueryui.com/demos/dialog/#methods](http://jqueryui.com/demos/dialog/#methods)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T13:44:57.040

I was able to get it working using the following code:

```
$("div.tooltip").each(function (index, Element) {
    var helpDivId = '#d' + $(Element).attr('id').substr(1);
    var helpDiv = $(helpDivId).first();
    $(Element).dialog({
        autoOpen: true,
        title: $(Element).attr("title"),
        dialogClass: 'tooltip-dialog'
    });
});
// Show or hide the help tooltip when the user clicks on the balloon
$("a.help").live("click", function (event) {
    var helpDivId = '#d' + $(this).closest('span.help').attr('id').substr(1);
    var helpDiv = $(helpDivId).first();
    var dialogState = helpDiv.dialog('isOpen');

    dialogState ? helpDiv.dialog('close') : helpDiv.dialog('open');
}); 
```

I changed the selectors so that they're identical, instead of just selecting the same element. I also broke out the Id, div and state into separate variables.

# c# - 有没有办法在 C# 中打印计算的时间格式字符串？

> ID：10606076
> 
> 赞同：2
> 
> 时间：2012-05-15T17:44:44.360
> 
> 标签：c#, .net, datetime, time, datetime-format

我知道标题可能会令人困惑，但我不确定如何更好地表达它......

我这样做是为了获取当前时间的日志：

```
'TraceSink-'yyyy-MM-dd HH'-Hourly.log' 
```

我怎样才能得到前一小时？IE：

```
'TraceSink-'yyyy-MM-dd (HH-1)'-Hourly.log' 
```

这样的时间格式有什么可能吗？

**编辑**：我无权访问 C# 代码，但我可以在其中更改内部内容的 exe.config。

就像 DateTime.ToString(var); 上的 var

我要求太多了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T17:47:51.643

从日期/时间中减去一小时并将其*格式化*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:00:54.257

你的问题的答案是**否定**的。

格式字符串仅定义格式。它没有能力对其进行计算（为什么会这样？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:56:12.593

我不知道您为什么有此要求，但我怀疑您可能正在从另一个时区的机器接收 DateTime 对象......如果您在格式字符串中包含与 UTC 的偏移量可能会有所帮助：

[http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#zSpecifier](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#zSpecifier)

这样，当您看到日志时，您可以知道特定事件发生在 UTC -3 小时。

我认为这是您在不访问原始代码的情况下所能做的最好的事情。

# templates - 我与 Smarty 引擎和 type="text/x-tmpl" 有冲突

> ID：10606080
> 
> 赞同：0
> 
> 时间：2012-05-15T17:45:03.303
> 
> 标签：templates, smarty

我使用 smarty 引擎来模板（不要判断，我是怎么习惯的），对于上传表单，我在这个脚本的表单旁边，我不知道如何转义`{%`and `%}`。

```
<script id="template-download" type="text/x-tmpl">
                    {% for (var i=0, file; file=o.files[i]; i++) { %}
                <tr class="template-download fade">
                    {% if (file.error) { %}
                <td></td>
                <td class="name"><span>{%=file.name%}</span></td>
                <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
                <td class="error" colspan="2"><span class="label label-important">{%=locale.fileupload.error%}</span> {%=locale.fileupload.errors[file.error] || file.error%}</td>
                    {% } else { %}
                <td class="preview">{% if (file.thumbnail_url) { %}
                <a href="{%=file.url%}" title="{%=file.name%}" rel="gallery" download="{%=file.name%}"><img src="{%=file.thumbnail_url%}"></a>
                    {% } %}</td>
                <td class="name">
                <a href="{%=file.url%}" title="{%=file.name%}" rel="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
        </td>
        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
        <td colspan="2"></td>
    {% } %}
    <td class="delete">
        <button class="btn btn-danger" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}">
            <i class="icon-trash icon-white"></i>
            <span>{%=locale.fileupload.destroy%}</span>
        </button>
        <input type="checkbox" name="delete" value="1">
    </td>
</tr>
{% } %}
</script> 
```

现在`{%`and`%}`给我带来了问题。我怎样才能使它们成为字面意思？我也使用了`{literal}{/literal}`但是那个标签仍然给我错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:03:45.927

您是否尝试更改默认的 smarty 分隔符？

例子.php：

```
$smarty->left_delimiter = '<!--{';
$smarty->right_delimiter = '}-->';

$smarty->assign('foo', 'bar');
$smarty->assign('name', 'Albert');
$smarty->display('example.tpl');

?> 
```

例子.tpl：

```
Welcome <!--{$name}--> to Smarty
<script language="javascript">
  var foo = <!--{$foo}-->;
  function dosomething() {
    alert("foo is " + foo);
  }
  dosomething();
</script> 
```

[在http://www.smarty.net/docsv2/en/language.escaping.tpl](http://www.smarty.net/docsv2/en/language.escaping.tpl)上查看更多信息

# c# - 掩码将 int 1、10、100 格式化为字符串“001”、“010”、“100”

> ID：10606082
> 
> 赞同：17
> 
> 时间：2012-05-15T17:45:11.773
> 
> 标签：c#

如何将掩码应用于旨在以下列方式格式化输出文本的字符串（最多 2 个前导零）：

```
int a = 1, b = 10, c = 100;
string aF = LeadingZeroFormat(a), bF = LeadingZeroFormat(b), cF = LeadingZeroFormat(c);
Console.Writeline("{0}, {1}, {2}", aF, bF, cF); // "001, 010, 100" 
```

什么是最优雅的解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-15T17:46:58.883

您可以使用 Int32.ToString("000") 以这种方式格式化整数。有关详细信息，请参阅[自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)和[Int32.ToString](http://msdn.microsoft.com/en-us/library/8wch342y)：

```
string one = a.ToString("000"); // 001
string two = b.ToString("000"); // 010 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-15T17:47:50.120

除了 Reed 的建议外，您还可以直接在复合格式字符串中执行此操作：

```
int a = 1, b = 10, c = 100;
Console.WriteLine("{0:000}, {1:000}, {2:000}", a, b, c); // "001, 010, 100" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T17:49:29.203

> 要将整数显示为十进制值，请调用其 ToString(String) 方法，并将字符串“Dn”作为格式参数的值传递，其中 n 表示字符串的最小长度。

```
int i = 10;
Console.WriteLine(i.ToString("D3")); 
```

另请检查[如何：用前导零填充数字](http://msdn.microsoft.com/en-us/library/dd260048.aspx)

# python - 用于单击 Python Tkinter Text Widget 中每一行的单独命令

> ID：10606091
> 
> 赞同：1
> 
> 时间：2012-05-15T17:46:26.210
> 
> 标签：python, tkinter

**背景**

我的文本小部件中出现的每一项都代表任务。我在 ListBox 上使用 Text 小部件，因为 Text 小部件允许不同的项目使用不同的颜色。每个任务的颜色是它的状态。是否可以为每个任务设置单独的 LC 命令？

我有一个拆分窗格应用程序，右侧有任务（可能是可滚动的），我想单击一个任务以在左侧窗格中将其打开以进行审查。

**主要问题**

我可以通过左键单击 Python Text Tkinter 小部件中的单独行以任何方式激活单独的事件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:19:47.997

只需在`<1>`. `index`使用widget的方法和事件的x/y坐标很容易得到被点击的行号。

这是一个简单的例子：

```
import Tkinter as tk

class ExampleApp(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.status = tk.Label(self, anchor="w")
        self.status.pack(side="bottom", fill="x")
        self.text = tk.Text(self, wrap="word", width=40, height=8)
        self.text.pack(fill="both", expand=True)
        self.text.bind("<1>", self.on_text_button)
        for n in range(1,20):
            self.text.insert("end", "this is line %s\n" % n)

    def on_text_button(self, event):
        index = self.text.index("@%s,%s" % (event.x, event.y))
        line, char = index.split(".")
        self.status.configure(text="you clicked line %s" % line)

if __name__ == "__main__":
    app = ExampleApp()
    app.mainloop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:36:05.357

我认为你可以做这样的事情。tkHyperlinkManger 做到了（[http://effbot.org/zone/tkinter-text-hyperlink.htm](http://effbot.org/zone/tkinter-text-hyperlink.htm)）

由于您已经对线条进行了不同的着色，因此我假设您正在使用`tag_config`. 然后，您只需`tag_bind`将回调绑定到文本区域。

# php - 正确获取 PHP IF 语句

> ID：10606094
> 
> 赞同：0
> 
> 时间：2012-05-15T17:46:33.657
> 
> 标签：php, mysql

我想要做的是创建一个查询，如果选择了返回单选，然后搜索数据库。如果不是，则继续原始查询。

这就是我到目前为止所拥有的并且（并不奇怪）它不起作用

```
if ($ret == 'y')
        $sql1 = mysql_query("SELECT * FROM  search_v Currency='$currency' AND rout_to='$sfrom' AND rout_from='$sto' AND date_avialable='$stoda'") or die(mysql_error()) ;
} 
```

我也使用相同的 IF 语句来包含一个文件，但它也不愿意发送任何东西：

```
if ($ret == 'y')
        include ("return.php");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T17:48:53.233

您似乎缺少一个左大括号。像这样简单地添加一个应该可以解决这个问题：

```
if ($ret == 'y')
{
    $sql1 = mysql_query("SELECT * FROM  search_v Currency='$currency' AND rout_to='$sfrom' AND rout_from='$sto' AND date_avialable='$stoda'") or die(mysql_error()) ;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T17:48:34.370

if 语句应采用以下形式：

```
if ($boolean_expression) {

} 
```

注意左括号；`{`. 你在这里仍然会评估，因为没有括号的 if 语句将假定下一行，并且只有下一行，是 if 子句的一部分。但是，紧随其后的是一个右括号将与您拥有的任何其他范围相混淆；在那之后的任何事情都不太可能执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T17:51:28.500

这里缺少`{`左花括号...

```
if ($ret == 'y')  
{                   **---------------------> MISSING**
include ("return.php"); 
} 
```

# php - PHP Map：来回

> ID：10606099
> 
> 赞同：1
> 
> 时间：2012-05-15T17:46:47.853
> 
> 标签：php

考虑这个人为的例子。如果我想将英语转换为西班牙语，以下数组可以正常工作。

```
$translate = array( 'one'    => 'uno',
                    'two'    => 'dos',
                    'three'  => 'tres'
            );

echo $translate['one']; 
```

但是我如何从西班牙语转换成英语呢？这可以通过关联数组来完成，还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T17:51:00.657

```
echo array_search ('uno', $translate); 
```

但是，如果您想反过来翻译多个单词以重新映射数组，它可能会更快：

```
$translate_reverse = array_flip ($translate);
echo $translate_reverse ['uno']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T17:54:27.283

虽然您可以搜索数组，但它是 O(n) 而不是 O(1) 的键。所以我会这样做：

```
$english_to_spanish = array('one' => 'uno', ...);
$spanish_to_english = array_flip($english_to_spanish); 
```

如果您有一个巨大的列表，那么最好使用数据库来存储索引的两个列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T17:52:06.460

如果是一对一的映射，可以使用下面的方法来获取英文单词：

```
echo array_search("tres", $translate); 
```

但是，如果它是一对多的，array_search 将返回一个键（西班牙语单词）数组，您必须以某种方式从中进行选择。

# git - 自动将所有子模块添加到存储库

> ID：10606101
> 
> 赞同：5
> 
> 时间：2012-05-15T17:47:00.737
> 
> 标签：git, git-submodules

我有一个大目录`~/.vim`，其中有一个子目录，其中包含许多其他 git 存储库。我想为我的`~/.vim`目录创建一个 git repo，但不想遍历我的其他每个 git 子目录。

有没有办法递归地添加所有子模块？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-15T19:07:13.430

**假设**.vim 已经**是一个有效的 git 存储库**，并且您想将所有 git 存储库添加到您的主 git 存储库，那么下面的 for 循环可能就是您需要的：

首先，`cd`到**您的**git 存储库的根目录。

可粘贴预览命令 - 仅回显，不会进行任何更改：

```
for x in $(find . -type d) ; do if [ -d "${x}/.git" ] ; then cd "${x}" ; origin="$(git config --get remote.origin.url)" ; cd - 1>/dev/null; echo git submodule add "${origin}" "${x}" ; fi ; done 
```

可粘贴命令以添加子模块：

```
for x in $(find . -type d) ; do if [ -d "${x}/.git" ] ; then cd "${x}" ; origin="$(git config --get remote.origin.url)" ; cd - 1>/dev/null; git submodule add "${origin}" "${x}" ; fi ; done 
```

此循环首先仅查找目录，查找 .git 目录，识别原始 URL，然后添加子模块。

可读版本：

```
for x in $(find . -type d) ; do
    if [ -d "${x}/.git" ] ; then
        cd "${x}"
        origin="$(git config --get remote.origin.url)"
        cd - 1>/dev/null
        git submodule add "${origin}" "${x}"
    fi
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-14T23:56:49.443

```
cd /to/super/repo
root_path=$(pwd)
for submodule in $(find -mindepth 2 -type d -name .git); do
    submodule_dir=$root_path/$submodule/..
    remote_name=$(cd $submodule_dir && git rev-parse --abbrev-ref --symbolic-full-name @{u}|cut -d'/' -f1 )
    remote_uri=$(cd $submodule_dir && git remote get-url $remote_name)

    echo "Adding $submodule with remote $remote_name..."

    # If already added to index, but not to .gitmodules...
    git rm --cached $submodule_dir &> /dev/null

    git submodule add $remote_uri $submodule_dir
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-05T23:50:09.257

可悲的是，这个功能似乎不存在。git 应该有一个命令可以添加 .gitmodules 中引用的所有模块，例如：

```
### wishful thinking

git submodules init --all
git submodules add --all 
```

:(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-25T23:55:15.213

我将 git repos 嵌套在更深的子目录中，因此要从任何深度级别查找和添加它们，我必须使用： `for i in $(find ~/Sources/* -type d -name .git) do cd $i && cd .. && git submodule add $(pwd) done`

# ruby-on-rails - Rails 3嵌套查询避免SQL

> ID：10606106
> 
> 赞同：1
> 
> 时间：2012-05-15T17:47:29.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, arel

假设我有以下模型：

```
class Foo < ActiveRecord::Base
    belongs_to :bar
end

class Bar < ActiveRecord::Base
    belongs_to :a
    belongs_to :b
end 
```

我想找到所有的`Foos`，包括和`Bar`分组。`a_id``b_id`

我很确定以下查询会起作用：

```
Foo.joins(:bar).group('bar.a_id, bar.b_id').all 
```

我想知道是否有一种方法可以不用在 group 语句中编写 SQL 吗？

# 子问题

这种查询风格叫什么，我在哪里可以阅读它的完整文档？rails 查询指南混合了多种样式，并且没有详细介绍其中的任何一种。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T07:52:27.157

样式的混合是因为使用散列的样式目前无法描述所有可能的 SQL 查询。因此，总是有使用字符串的后备。

您提供的查询有效，没有理由不使用它，因为字符串是非常标准的 SQL，如果使用不同的数据库也不应该失败。

但是，可以不使用字符串来编写它。

请注意，您当前编写的查询将引发错误，因为默认情况下会选择 Foo 的所有字段 - 但是对于组，您只能选择聚合函数或按列分组。

查询将类似于：

```
Foo.select("COUNT(*) as count").joins(:bar).group([:bar => :a_id, :bar => :b_id]) 
```

我刚刚添加了 select 子句，因此只选择了一个聚合函数。

# c# - .NET 中的透明控件

> ID：10606111
> 
> 赞同：2
> 
> 时间：2012-05-15T17:47:48.887
> 
> 标签：c#, .net, winforms, winapi

我有一个问题：

```
BackColor = Color.Transparent; 
```

它无法正常工作。我有一个蓝色背景的表单和一个加载了图片的图片框。它实际上并没有采用图片中的内容，而是 - 表单的背景颜色。请告诉我有一个简单的方法来解决这个问题吗？

您在以下屏幕截图中看到的是一个自定义用户控件，它的背景颜色设置为透明，位于图片之上，具有蓝色背景。

我需要用户控件来显示它下面的内容，作为真正的透明度，它应该显示渐变和图像的一部分。

![在此处输入图像描述](../Images/19faf52d80ce57340d7e609258fbd660.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T17:55:59.063

尝试将图片框设置为自定义用户控件的父级。

```
myControl.Parent = this.myPictureBox; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T17:58:23.317

尝试调用“SetStyle(ControlStyles.SupportsTransparentBackColor, true);” 在您的用户控件构造函数上。

更多详细信息，请访问：http: [//msdn.microsoft.com/en-us/library/wk5b13s4 (v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/wk5b13s4(v=vs.90).aspx)

# api - LinkedIn 登录脚本不适用于 PHP 页面 - 仅适用于 HTML 页面

> ID：10606116
> 
> 赞同：0
> 
> 时间：2012-05-15T17:47:56.803
> 
> 标签：api, login, linkedin

linkedIn API 的部分登录脚本如下所示：

```
<script type="in/Login">
Hello, <?js= firstName ?> <?js= lastName ?>.
</script> 
```

不幸的是，当我将页面保存为`.php`文件时，`<?js`这段代码会引发错误。但是，如果我将文件另存为`.html`，则不会出现错误，并且使用linkedIn 按钮登录就可以了。

我在这里遗漏了一些明显的东西吗？有没有办法把这个按钮放在一个 php 页面上？

作为参考，我看到的错误是：

> 解析错误：语法错误，意外的 '='

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:53:14.740

尝试：

```
<script type="in/Login">
Hello, <?php echo '<' . '?js= firstname ?' . '>' ; ?> <?php echo '<' . '?js= lastName ?' . '>' ; ?>.
</script> 
```

# jquery-ui - jQuery UI 菜单栏样式

> ID：10606120
> 
> 赞同：1
> 
> 时间：2012-05-15T17:48:14.467
> 
> 标签：jquery-ui

我正在处理[此处](http://jsfiddle.net/qVLwT/)提供的 jQuery UI 菜单栏。我希望菜单显示在栏的中心而不是左侧。我怎么做？我尝试通过填充来做到这一点，它可以工作，但它不是理想的做法，因为如果我使用不同的设备，它不会出现在中心。

# objective-c - ModalView 仅在 SubViewControllers 内

> ID：10606121
> 
> 赞同：0
> 
> 时间：2012-05-15T17:48:16.037
> 
> 标签：objective-c, ios5, modalviewcontroller, subview

我有这种情况：

```
 ----------------------------
|  UIViewController          |
|                            |
|    --------------------    |
|   |                    |   |
|   |  SubViewController |   |
|   |                    |   |
|    --------------------    |
 ---------------------------- 
```

我的 SubViewController 有一个点击手势：

```
- (void) tapped: (UIGestureRecognizer*) g 
{
    int tag=g.view.tag;
    UIViewController* vc = [controlersOfBoxes objectAtIndex:tag-1];

    UIViewController *controller = [[[UIViewController alloc] init] autorelease];
    [controller setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
    [controller.view setFrame:vc.view.frame];

    [vc presentModalViewController:controller animated:YES];
} 
```

问题是新 UIViewController 的尺寸......我在视图之前放置了相同的框架，但是......填满了所有屏幕......

我只想更改 SubViewController。

任何解决方案！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T17:58:03.520

如果我遇到您的问题，您希望您的视图控制器仅占用父视图控制器上分配的框架。在这种情况下，您不能使用 PresentModalViewController ..您必须使用：-分配您的第二个视图控制器（子）分配框架：-

```
 yourSecondViewController.frame=CGRectMake(x,y,width,height);
[self.view addSubView:yourSeconViewController.view]; 
```

# android - Android：从 Application.onCreate() 调用 getExternalFilesDir(null) 返回 null

> ID：10606122
> 
> 赞同：0
> 
> 时间：2012-05-15T17:48:16.567
> 
> 标签：android, oncreate

在某些客户设备上调用`getExternalFilesDir( null )`（并且很少`getFilesDir()`） from`Application.onCreate()`返回 null。

文档没有说明不能从 Application 对象调用这些方法，并且在大多数设备上它们都可以正常工作。任何人都知道为什么这些方法会返回 null 并且我应该从 Activity 对象中专门调用它们吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-23T21:55:00.653

添加

```
<uses-permission
            android:name="android.permission.WRITE_EXTERNAL_STORAGE" >
</uses-permission> 
```

到您的清单。为什么写不读（仅读取目录时）-我不知道。我想每个应用程序都需要它才能在第一次使用 sdcard 时创建目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T17:58:58.717

来自[ContextWrapper.getExternalFilesDir的文档](http://developer.android.com/reference/android/content/ContextWrapper.html#getExternalFilesDir%28java.lang.String%29)

> **退货**
> 
> 返回外部存储上保存应用程序文件的目录的路径。**如果当前未安装外部存储，则返回 null，因此无法确保路径存在；**当它可用时，您将需要再次调用此方法。

您是否在调用该方法之前检查以确保已安装外部存储？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-25T11:35:53.020

我们的一些客户也得到了这个。幸运的是，它突然在我们的一台测试设备上重现。
经过一番嗅探，我发现 Android/data/ 下出现了一个奇怪的文件，名称与应用程序包名称类似，但大小为 0。我无法删除或重命名它。虽然此文件存在，但该应用程序无法访问外部存储。
经过一些尝试，我重新启动了设备并导航到 Android/data。只见奇怪的文件消失了，出现了一个同名的文件夹。应用程序开始正常运行。
我认为这是 Android 应用程序安装程序中的一个错误。我将开始建议报告此问题的客户重新启动他们的设备。

# java - 使用 SimpleDateFormat，Java 的日期解析不正确

> ID：10606126
> 
> 赞同：7
> 
> 时间：2012-05-15T17:48:24.607
> 
> 标签：java, simpledateformat, parse-error

我需要使用日期模式“yyyy-MM-dd”从输入字符串中解析日期，如果日期将以任何其他格式出现，则抛出错误。

这是我解析日期的一段代码：

```
private void validateDate() throws MyException {
  Date parsedDate;
  String DATE_FORMAT = "yyyy-MM-dd";
  try{
    parsedDate = new SimpleDateFormat(DATE_FORMAT).parse(getMyDate());
    System.out.println(parsedDate);
  } catch (ParseException e) {
    throw new MyException(“Error occurred while processing date:” + getMyDate());
  }

} 
```

当我在 myDate 中输入像“2011-06-12”这样的字符串时，我会得到输出“Thu Sep 29 00:00:00 EEST 2011”，这很好。

当我发送像“2011-0612”这样的错误字符串时，我收到了预期的错误。

当我尝试传递仍然有两个“连字符”但位数错误的字符串时，问题就开始了。例子：

输入字符串“2011-06-1211”结果“Tue Sep 23 00:00:00 EEST 2014”。

输入字符串“2011-1106-12”结果“Mon Feb 12 00:00:00 EET 2103”。

我无法更改字符串日期的输入格式。

我怎样才能避免它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T17:49:51.230

你试过打电话`setLenient(false)`给你的`SimpleDateFormat`吗？

```
import java.util.*;
import java.text.*;

public class Test {

    public static void main(String[] args) throws Exception {
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
        format.setLenient(false);
        Date date = format.parse("2011-06-1211"); // Throws...
        System.out.println(date);
    }
} 
```

请注意，我还建议设置您的`SimpleDateFormat`. （或者，使用[Joda Time](http://joda-time.sf.net)代替......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-29T22:51:01.350

同样的问题，我注意到当我直接在 main 方法中使用此代码时，它返回正确的日期，当我通过单独的方法使用相同的代码时，它返回不正确的日期

```
String string = "03/01/2015";
DateFormat format = new SimpleDateFormat("MM/dd/yyyy", Locale.ENGLISH);
Date date1 = format.parse(string);
System.out.println(new SimpleDateFormat("dd/MM/yyyy").format(date)); 
```

返回错误日期的函数中的代码

```
public Date isValidDate(String dateToValidate, String dateFormat){

  if(dateToValidate == null){
     return null;
  }

  DateFormat format = new SimpleDateFormat(dateFormat,Locale.ENGLISH);
  //format.setLenient(false);

  Date date;
  try {

      date = format.parse(dateToValidate);

  } catch (ParseException e) {

      e.printStackTrace();
      return null;
  }

  return date;
} 
```

# ruby-on-rails - Rail Devise 创建自己的登录和注销操作

> ID：10606131
> 
> 赞同：0
> 
> 时间：2012-05-15T17:48:41.107
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, devise, ruby-on-rails-plugins

我在滑轨潜水时遇到以下问题。

**所有请求和响应都是 JSON**

登录**/partners/sign_in**后，我收到以下回复：

> HTTP/1.1 200 OK {"成功":true}

在我退出**/partners/sign_out**后，我​​得到以下回复：

> HTTP/1.1 200 OK {"成功":true}

现在我的问题：如何创建自己的 RegisterController 以及它的外观，有没有示例？我在 github/devise 上进行了搜索，但没有找到任何示例。

我想响应其他内容，如果身份验证失败，我想响应 HTTP 404 ERROR

**路线.rb**

```
devise_for :partners, :controllers => { :sessions => "sessions" } 
```

**session_controller.rb**

```
 class SessionsController < Devise::SessionsController

  def create
    resource = warden.authenticate!(:scope => resource_name, :recall => :failure)
    return sign_in_and_redirect(resource_name, resource)
  end

  def destroy
    redirect_path = after_sign_out_path_for(resource_name)
    signed_out = (Devise.sign_out_all_scopes ? sign_out : sign_out(resource_name))
    set_flash_message :notice, :signed_out if signed_out

    respond_to do |format|
      format.html { redirect_to redirect_path }
      format.json { render :json => {:success => true} }
    end
  end

  private

  def sign_in_and_redirect(resource_or_scope, resource=nil)
    scope = Devise::Mapping.find_scope!(resource_or_scope)
    resource ||= resource_or_scope
    sign_in(scope, resource) unless warden.user(scope) == resource
    return render :json => {:success => true}
  end

  def failure
    return render:json => {:success => false, :errors => ["Login failed."]}
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T06:38:16.657

ActionController 的 render 方法以 :status 为 key 的 hash。您可以在此处指定 HTTP 错误状态代码或该状态代码的符号：

```
render json: {success: false, errors: ["Login Failed"]}, status: 404  
# or the following is a preferred way
render json: {success: false, errors: ["Login Failed"]}, status: :not_found 
```

这里是[渲染方法](http://apidock.com/rails/ActionController/Base/render)的文档。
这是 Cody Fauser编写的关于[rails status code to symbol mapping的优秀文档](http://www.codyfauser.com/2008/7/4/rails-http-status-code-to-symbol-mapping)

一个观察：

在 Ruby 中，在函数末尾使用 return 语句并不习惯，因为最后一个表达式的返回值是函数的返回值。

# python - 在 Python 中使用 Requests 库发送“用户代理”

> ID：10606133
> 
> 赞同：285
> 
> 时间：2012-05-15T17:48:44.303
> 
> 标签：python, web-crawler, python-requests

我想在`"User-agent"`使用 Python 请求请求网页时发送一个值。我不确定是否可以将其作为标头的一部分发送，如下面的代码所示：

```
debug = {'verbose': sys.stderr}
user_agent = {'User-agent': 'Mozilla/5.0'}
response  = requests.get(url, headers = user_agent, config=debug) 
```

调试信息未显示请求期间发送的标头。

在标头中发送此信息是否可以接受？如果没有，我该如何发送？

* * *

## 回答 #1

> 赞同：412
> 
> 时间：2012-05-15T17:58:21.327

`user-agent`应指定为标题中的字段。

这是[HTTP 标头字段列表](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields)，您可能会对[特定于请求的字段](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Request_fields)感兴趣，其中包括`User-Agent`.

### 如果您使用 requests v2.13 和更新版本

做你想做的最简单的方法是创建一个字典并直接指定你的标题，如下所示：

```
import requests

url = 'SOME URL'

headers = {
    'User-Agent': 'My User Agent 1.0',
    'From': 'youremail@domain.com'  # This is another valid field
}

response = requests.get(url, headers=headers) 
```

### 如果您使用 requests v2.12.x 及更早版本

旧版本的`requests`破坏默认标头，因此您需要执行以下操作以保留默认标头，然后将您自己的标头添加到其中。

```
import requests

url = 'SOME URL'

# Get a copy of the default headers that requests would use
headers = requests.utils.default_headers()

# Update the headers with your custom ones
# You don't have to worry about case-sensitivity with
# the dictionary keys, because default_headers uses a custom
# CaseInsensitiveDict implementation within requests' source code.
headers.update(
    {
        'User-Agent': 'My User Agent 1.0',
    }
)

response = requests.get(url, headers=headers) 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2017-06-14T04:16:13.503

[使用session](https://2.python-requests.org/en/master/user/advanced/#id1)更方便，这样你就不必每次都记住设置标题：

```
session = requests.Session()
session.headers.update({'User-Agent': 'Custom user agent'})

session.get('https://httpbin.org/headers') 
```

默认情况下，会话还为您管理 cookie。如果您想禁用它，请参阅[此问题](https://stackoverflow.com/questions/17037668/how-to-disable-cookie-handling-with-the-python-requests-library)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-09-12T07:00:59.797

**只需您可以像下面这样：**

```
import requests

url = requests.post("URL", headers={"FUser":"your username","FPass":"your password","user-agent": "your custom text for the user agent "}) 
```

# php - if 语句在 php 脚本中的位置

> ID：10606139
> 
> 赞同：-1
> 
> 时间：2012-05-15T17:49:22.603
> 
> 标签：php

如果上传了新文件或现有文件，我在下面有一个 php 脚本，它会在其中添加一个数据库行：

```
<?php
session_start();
...//connect to DB

$result = 0;
if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) {
    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";

    mysql_query($imagesql);
} else {
    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";
    mysql_query($imagesql);
}
mysql_close();
?>

<script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result ? 'true' : 'false'; ?>, '<?php echo $_FILES['fileImage']['name'] ?>');</script> 
```

但问题是我想在 $result = 2 时在 else 语句下方添加一个 if 语句，以便删除数据库行。当我尝试这个时，它不会在上传新文件或现有文件后插入数据库行。

```
if ($result = 2){
  $imagecancelsql = "DELETE FROM Image 
  WHERE ImageFile = 'ImageFiles/". mysql_real_escape_string($_FILES['fileImage']['name'])."'";
  mysql_query($imagecancelsql);
} 
```

所以我的问题是：我应该如何将上面的 if 语句放在 php 脚本中，以便它执行必要的数据库更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:06:06.750

你没有在任何地方定义你的 $result 变量，所以 if 永远不会被执行。无论如何，你应该把它放在那里：

```
<?php
session_start();
...//connect to DB

$result = 0;
if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) {
    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";

    mysql_query($imagesql);
} else {
    $imagesql = "INSERT INTO Image (ImageFile) 
    VALUES ('ImageFiles/".mysql_real_escape_string($_FILES['fileImage']['name'])."')";
    mysql_query($imagesql);
}

if ($result == 2){
  $imagecancelsql = "DELETE FROM Image 
  WHERE ImageFile = 'ImageFiles/". mysql_real_escape_string($_FILES['fileImage']['name'])."'";
  mysql_query($imagecancelsql);
}

mysql_close();
?> 
```

# gnome - 删除 Glib 调度程序（也在 gtk 线程中）导致段错误

> ID：10606140
> 
> 赞同：3
> 
> 时间：2012-05-15T17:49:24.903
> 
> 标签：gnome, glib, gtkmm, gtk2

我有一些使用调度程序的多线程代码。我小心翼翼地让调度程序在 gtk 线程中创建/销毁。但是，似乎即使从那里也无法摧毁它们。请参阅此代码（甚至是单线程）。我错过了什么吗？

```
#include <gtkmm.h>
#include <iostream>
using namespace std;

class HelloWorld:public Gtk::Window {
 public:

 Glib::Dispatcher* disp;
 Glib::Dispatcher disp2;
sigc::connection conn;

 void onDisp(){
  cout << "Hello by disp" << endl;
}

 HelloWorld():m_button("Hello"),m_destr("Destr") {
  disp=new Glib::Dispatcher();
  conn=disp->connect(sigc::mem_fun(*this,&HelloWorld::onDisp));      
  disp2.connect(sigc::mem_fun(*this,&HelloWorld::on_work));

 m_button.signal_clicked().connect(sigc::mem_fun(*this,&HelloWorld::on_button_clicked));
  m_destr.signal_clicked().connect(sigc::mem_fun(*this,&HelloWorld::on_destr_clicked));
  v.add(m_button);
  v.add(m_destr);
  add(v);
  show_all_children();
}

protected:

void on_work(){
 usleep(1*1E5);
}

void on_button_clicked(){

   for (size_t i=0;i<100;i++){
if (disp!=NULL){
  (*disp)();
}
disp2();
   }
 }

 void on_destr_clicked() {
   conn.disconnect();
   delete disp;
   disp=NULL;
 }

Gtk::Button m_button;
Gtk::Button m_destr;
Gtk::VBox v;

};

int main (int argc, char *argv[]) {
 Gtk::Main kit(argc, argv);

 HelloWorld helloworld;
//Shows the window and returns when it is closed.
 Gtk::Main::run(helloworld);

 return 0;
} 
```

===环境=== Ubuntu 11.10，gtkmm 2.24.2-1，libglib 2.30.0

===GDB====

```
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff70f6ee9 in Glib::DispatchNotifier::pipe_io_handler(Glib::IOCondition) () from /usr/lib/libglibmm-2.4.so.1
(gdb) bt
#0  0x00007ffff70f6ee9 in Glib::DispatchNotifier::pipe_io_handler(Glib::IOCondition) () from /usr/lib/libglibmm-2.4.so.1
#1  0x00007ffff70f8dcc in Glib::IOSource::dispatch(sigc::slot_base*) () from /usr/lib/libglibmm-2.4.so.1
#2  0x00007ffff70f89df in Glib::Source::dispatch_vfunc(_GSource*, int (*)(void*), void*) () from /usr/lib/libglibmm-2.4.so.1
#3  0x00007ffff4e68a5d in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#4  0x00007ffff4e69258 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#5  0x00007ffff4e69792 in g_main_loop_run () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#6  0x00007ffff5751db7 in gtk_main () from /usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0
#7  0x00007ffff7824326 in Gtk::Main::run(Gtk::Window&) () from /usr/lib/libgtkmm-2.4.so.1
#8  0x0000000000442f9a in main (argc=1, argv=0x7fffffffe368) at gtkmmWindow.cpp:66 
```

====VALGRIND====

```
 Invalid read of size 8
==5254==    at 0x5931E81:
Glib::DispatchNotifier::pipe_io_handler(Glib::IOCondition) (in
/usr/lib/libglibmm-2.4.so.1.3.0)
==5254==    by 0x5933DCB: Glib::IOSource::dispatch(sigc::slot_base*) (in
/usr/lib/libglibmm-2.4.so.1.3.0)
==5254==    by 0x59339DE: Glib::Source::dispatch_vfunc(_GSource*, int
(*)(void*), void*) (in /usr/lib/libglibmm-2.4.so.1.3.0)
==5254==    by 0x7B35A5C: g_main_context_dispatch (in
/lib/x86_64-linux-gnu/libglib-2.0.so.0.3000.0)
==5254==    by 0x7B36257: ??? (in
/lib/x86_64-linux-gnu/libglib-2.0.so.0.3000.0)
==5254==    by 0x7B36791: g_main_loop_run (in
/lib/x86_64-linux-gnu/libglib-2.0.so.0.3000.0)
==5254==    by 0x70E6DB6: gtk_main (in
/usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0.2400.6)
==5254==    by 0x530B325: Gtk::Main::run(Gtk::Window&) (in
/usr/lib/libgtkmm-2.4.so.1.1.0)
==5254==    by 0x442F99: main (gtkmmWindow.cpp:66)
==5254==  Address 0xd1ad9e8 is 8 bytes inside a block of size 24 free'd
==5254==    at 0x4C27FF2: operator delete(void*) (vg_replace_malloc.c:387)
==5254==    by 0x5B584E8: sigc::signal_base::~signal_base() (in
/usr/lib/libsigc-2.0.so.0.0.0)
==5254==    by 0x443A45: HelloWorld::on_destr_clicked() (gtkmmWindow.cpp:50)
==5254==    by 0x4442B4: sigc::bound_mem_functor0<void,
HelloWorld>::operator()() const (in
/home/fabio/research/software/bin/gui/gtkmmWindow.greenplanet)
==5254==    by 0x4441DF: sigc::adaptor_functor<sigc::bound_mem_functor0<void,
HelloWorld> >::operator()() const (adaptor_trait.h:251)
==5254==    by 0x444096:
sigc::internal::slot_call0<sigc::bound_mem_functor0<void, HelloWorld>,
void>::call_it(sigc::internal::slot_rep*) (slot.h:103)
==5254==    by 0x5938B07:
Glib::SignalProxyNormal::slot0_void_callback(_GObject*, void*) (in
/usr/lib/libglibmm-2.4.so.1.3.0)
==5254==    by 0x78AF0A3: g_closure_invoke (in
/usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0.3000.0)
==5254==    by 0x78C11F4: ??? (in
/usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0.3000.0)
==5254==    by 0x78CA6B0: g_signal_emit_valist (in
/usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0.3000.0)
==5254==    by 0x78CA851: g_signal_emit (in
/usr/lib/x86_64-linux-gnu/libgobject-2.0.so.0.3000.0)
==5254==    by 0x7040904: ??? (in
/usr/lib/x86_64-linux-gnu/libgtk-x11-2.0.so.0.2400.6) 
```

# c# - 创建复选框列表

> ID：10606144
> 
> 赞同：1
> 
> 时间：2012-05-15T17:49:48.703
> 
> 标签：c#, .net, xaml

好的，所以基本上我是 C# 新手，我目前正在为一家开发电子商务软件的公司工作，我遇到了一个我似乎无法解决的问题。

我有两列，我想添加第三列显示复选框列表，但我只想在其他两个（或一个）字段中显示某种形式的数据时显示这些复选框，即：

```
 Name Type Check
            lol   lol 
```

我还希望自动勾选这些复选框。

另一个问题是我也想这样做，所以当检查时产品会显示在我们的搜索中，但如果它们未被选中，我希望它们被隐藏但不被删除。

我目前正在使用 GridView，因为我不想重写已经存在的其余内容，因为它与我一无所知的 SQL 数据库进行通信。

我们没有使用 ASP，我们使用的是 XAML 和 C#（我对这两者都知之甚少。）

![](../Images/a7d4e0096c285c3e81c420d371ff5854.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:43:48.340

你的问题非常广泛，有点难以回答。简而言之，您要查看的是`Visibility`控件上的属性。

通过设置`Visibility`为`Collapsed`，UI 将不显示该元素。如果需要，您可以`Visibility`根据另一个 XAML 元素或数据元素的值进行设置，但您需要实现一个实现 IValueConverter 的类来进行转换。

最常见的值转换器之一是“布尔到可见性”转换器。如果您在 Internet 上搜索，您将能够找到这些示例。您可以复制该方法并创建“EmptyToVisibilityConverter”或“NullToVisibilityConverter”或您需要的任何其他内容。拥有该转换器后，您只需在绑定中指定它以获取可见性。例如：

```
<Page.Resources>
    <conv:NullToVisibilityConverter x:Key="NullToVis"/>
</Page.Resources>

<CheckBox ... Checked={Binding ThisBoxIsChecked} 
              Visibility={Binding SomeOtherValue, 
                          Converter={StaticResource NullToVis}}"/> 
```

请记住，控件内容和可见性属性之间的数据绑定不必相同。您可以将您的内容绑定到一个值，并将可见性绑定到另一个值。

如果您不使用数据绑定，则必须在代码隐藏中设置这些。但是你为什么不使用数据绑定呢？

**编辑：这是一个工作示例。**

*如果这不是您要找的东西，那么我很迟钝并且不理解这个问题*

我建议您开始一个空白项目，将其放入其中，然后尝试一下，以了解如何进行设置。XAML 的学习曲线相对陡峭，通常有几种方法可以完成您需要的工作，但您确实需要对数据绑定和 INotifyPropertyChanged（我在本示例中没有涉及）有基本的了解。

这是 C# 代码：

```
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace CheckboxList
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            //Create a viewmodel and add some data to it.
            var viewModel = new MyViewModel();
            viewModel.Items.Add(new Data() {Name = "lol", Type = "lol", Selected = true});
            viewModel.Items.Add(new Data() { Name = "lol", Type = "not_lol", Selected = true });
            viewModel.Items.Add(new Data() { Name = "not_lol", Type = "not_lol", Selected = true });

            //Set the window's datacontext to the ViewModel.  This will make binding work.
            this.DataContext = viewModel;

        }
    }

    //This is the ViewModel used to bind your data 
    public class MyViewModel 
    {
        //This could just be a List<Data> but ObservableCollection<T> will automatically
        //update your UI when items are added or removed from the collection.
        public ObservableCollection<Data> Items { get; set; }

        public MyViewModel()
        {
            Items = new ObservableCollection<Data>();
        }
    }

    //Just a sample class to hold the data for the grid.
    //This is the class that is contained in the ObservableColleciton in the ViewModel
    public class Data
    {
        public string Name { get; set; }
        public string Type { get; set; }
        public bool Selected { get; set; }
    }

    //This is an example converter.  It looks to see if the element is set to "lol" 
    //If so, it returns Visibility.Collapsed.  Otherwise, it returns Visibility.Visible.
    public class LolToVisibilityConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null && value is string)
            {
                var input = (string) value;
                if (string.Equals(input, "lol", StringComparison.CurrentCultureIgnoreCase))
                {
                    return Visibility.Collapsed;
                }
                else
                {
                    return Visibility.Visible;
                }
            }

            return Visibility.Visible;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

和 XAML：

```
<Window x:Class="CheckboxList.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:CheckboxList="clr-namespace:CheckboxList"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <!-- Create an instance of LolToVisibilityConverter and call it "LolToVis" -->
        <CheckboxList:LolToVisibilityConverter x:Key="LolToVis"/>
    </Window.Resources>
    <Grid>

        <ListView ItemsSource="{Binding Items}">  <!--Bind the contents of the Items collection in our viewmodel -->
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Name}"/> <!-- bind this element to this column-->
                    <GridViewColumn Width="140" Header="Type" DisplayMemberBinding="{Binding Type}"/> <!-- bind this element to this column-->
                    <GridViewColumn Width="140" Header="Selected" >  <!-- because we don't want this to just display true/false, we need to set up a template-->
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <!-- we set the Visibility property to Name, and the converter to LolToVis-->
                                <!-- whenever this field will be displayed, it calls the converter to convert the string to a Visibility value-->
                                <!-- The visibility value is checked to determine whether or not the element should be displayed-->
                                <CheckBox IsChecked="{Binding Selected}" Visibility="{Binding Name, Converter={StaticResource LolToVis}}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:48:39.923

这是我过去用来为每个 datagridview 行创建一个复选框的方法......然后我使用 datagridview_cellcontentclick 事件处理程序在单击时更改复选框的值。在下面的代码上下文中，我有一个自定义类，它包含一个程序名称、一个窗口标题和一个打开的文件或 url。然后，我创建了一个自定义 custructor 类型的全局列表“oplist”。然后，当我将列表中的项目添加到 datagridview 时，我指定了列标题。然后从 datagridview 添加或删除任何内容变得非常容易。您所要做的就是将项目删除或添加到列表中，然后刷新 datagridview。

```
 public void addOpenProgramsToDataGrid()
    {
        dataGridView1.ColumnCount = 3;

        DataGridViewCheckBoxColumn column = new DataGridViewCheckBoxColumn();
        {
            column.HeaderText = "Selected";
            column.Name = "Selected";
            column.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            column.FlatStyle = FlatStyle.Standard;
            column.ThreeState = false;
            column.CellTemplate = new DataGridViewCheckBoxCell();
            column.CellTemplate.Style.BackColor = Color.White;
        }

        dataGridView1.Columns.Insert(0, column); // This is to be a checkbox column
        dataGridView1.Columns[0].HeaderText = "X";

        dataGridView1.Columns[1].HeaderText = "Process Name:";

        dataGridView1.Columns[2].HeaderText = "Window Title";
        dataGridView1.Columns[3].HeaderText = "Open File or URL";

        dataGridView1.RowCount = opList.Count;
        //opList.RemoveRange(0, opList.Count);
        for (int a = 0; a < opList.Count; a++)
        {
            openProgram tempProgram = new openProgram();
            tempProgram = opList[a];
            dataGridView1.Rows[a].Cells[0].Value = true;

            dataGridView1.Rows[a].Cells[1].Value = tempProgram.processName;
            dataGridView1.Rows[a].Cells[2].Value = tempProgram.windowTitle;
            dataGridView1.Rows[a].Cells[3].Value = tempProgram.openFileOrURL;
        }
        selectAllCheckBox.Checked = true;
    } 
```

# c# - 将 ActionLink 分配给 MVC 中的 jQuery 按钮

> ID：10606146
> 
> 赞同：7
> 
> 时间：2012-05-15T17:50:06.087
> 
> 标签：c#, javascript, jquery, asp.net-mvc, asp.net-mvc-3

如何将 ActionLink 分配给 asp.net MVC 页面中的 jQuery 按钮。

```
<button id="Button1">Click</button>

<%: Html.ActionLink("About", "About", "Home")%>

<script language="javascript" type="text/javascript">
    $(function () {

        $("#Button1").button().click(function () {
            return false;
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:06:16.197

根据您的评论，您只想在单击按钮时转到 Home 控制器中的 About 操作，您可以执行以下操作并删除`ActionLink`：

```
$(function () {
    $("#Button1").click(function () {
        location.href = '<%= Url.Action("About", "Home") %>';
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T17:52:13.413

给锚一个`id`：

```
<%: Html.ActionLink("About", "About", "Home", null, new { id = "Button1"})%> 
```

使用这个[重载](http://msdn.microsoft.com/en-us/library/dd492124)：

```
public static MvcHtmlString ActionLink(
    this HtmlHelper htmlHelper,
    string linkText,
    string actionName,
    Object routeValues,
    Object htmlAttributes // <==============
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T17:53:38.437

```
<%: Html.ActionLink("About", "About", "Home", new { @class = "yourclass" })%> 
```

您可以尝试将类附加到操作链接，然后可以通过查询选择它。如果你想使用一个类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T17:53:22.887

jQuery的[按钮方法也适用于标签，试试这个：](http://jqueryui.com/demos/button/)

```
<%: Html.ActionLink("About", "About", "Home", null, new { id="Button1" })%>

<script language="javascript" type="text/javascript">
    $(function () {

        $("#Button1").button().click(function () {
            return false;
        });
    });
</script> 
```

# ruby-on-rails - Capybara::ElementNotFound: 找不到 xpath "/html"

> ID：10606150
> 
> 赞同：6
> 
> 时间：2012-05-15T17:50:12.997
> 
> 标签：ruby-on-rails, ruby, rspec, capybara, gemfile

我正在关注[http://ruby.railstutorial.org/chapters/static-pages](http://ruby.railstutorial.org/chapters/static-pages)上的 Ruby on Rails 教程并遇到以下错误

```
 StaticPages Home page should have the content 'Sample App'
 Failure/Error: page.should have_content('Sample App')
 Capybara::ElementNotFound:
   Unable to find xpath "/html"
 # (eval):2:in `text'
 # ./spec/requests/static_pages_spec.rb:7:in `(root)' 
```

我的宝石文件如下

```
source 'http://rubygems.org'

gem 'rails', '3.0.10'

gem 'jruby-openssl'

gem 'activerecord-jdbcsqlite3-adapter'
group :development, :test do
   gem 'webrat'
   gem 'rspec-rails', ">= 2.10.0"
   gem 'capybara', ">= 1.1.2"
end 
```

如何摆脱此错误并通过 rspec？源文件

```
require 'spec_helper'

describe "StaticPages" do

  describe "Home page" do

    it "should have the content 'Sample App'" do
      visit '/static_pages/home'
      # puts page.html
      page.should have_content('Sample App')
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:22:57.570

您可能会遇到阻止页面正确呈现的错误。

使用一些调试工具来寻求帮助：

*   在您的请求规范中，用于`puts page.html`在您的规范期间打印页面内容。
*   跟踪日志文件（log/test.log）

你能显示你的 ./spec/requests/static_pages_spec.rb 源代码吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T23:04:21.437

也许问题出在 webrat gem + capybara gem，尝试从您的 gemfile 中删除 webrat。

[检查这个问题](https://github.com/rspec/rspec-rails/issues/406)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-10T21:44:33.087

我猜这个问题很可能出在这条线上：

`visit '/static_pages/home'`

运行“rake routes”以找出路径名并使用其中之一。例如，如果您有一条名为“home”的路线，请使用：

访问 home_path

如果您想要的路径不存在，请将其添加到 config/routes.rb。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-26T06:40:57.877

今天我有同样的错误，但情况不同。我包括`include Capybara::DSL`在`spec_helper.rb`（`rails_helper.rb`）中。

然后，当我运行规范时，会默默地出现一个警告`including Capybara::DSL in the global scope is not recommended!`。但在一些测试中我得到了`Capybara::ElementNotFound: Unable to find xpath "/html"`。

我必须包括在`RSpec.configure`块中。

```
RSpec.configure do |config|
  config.include Capybara::DSL
end 
```

# ruby-on-rails-3 - 渲染：带有 rss 的布局

> ID：10606153
> 
> 赞同：3
> 
> 时间：2012-05-15T17:50:31.127
> 
> 标签：ruby-on-rails-3, rss

我遇到了 render :layout 在 respond_to 块中被忽略。我正在尝试创建一个 RSS 提要。如果我将格式更改为 xml 并删除

```
 xml.rss :version => "2.0" do 
```

从构建器那里，一切正常，我得到了一个 xml 文件。但是，将其重新添加并放入我的控制器中：

```
respond_to do |format|
    format.html { render :layout => 'application' }
    format.rss  { render :layout => false } 
end 
```

我收到一个缺少模板的错误：

```
Missing template organizations/home/show, application/show with {:handlers=>[:erg,
:builder, :coffee], :formats=>[:rss], :locale=>[:en, :en]}. 
```

渲染页面的 html 版本可以正常工作（如果告诉它 :layout false 也可以工作，它会正常工作并且不会渲染布局）

想法？

# c++ - 使用 C++ 创建/删除文件夹

> ID：10606167
> 
> 赞同：0
> 
> 时间：2012-05-15T17:51:28.567
> 
> 标签：c++, linux, g++, directory

需要一些有关使用 C++ 创建/删除/打开目录的帮助。我在互联网上搜索了它，但找不到一个好的答案。

这是我的作业，其中一部分涉及创建和删除文件夹并在其中浏览，我在 Linux 中使用 g++ 编译器来编译它。

我读过一个名为的库`direct.h`，但我认为它不是 c++ 库，必须添加到包含库中。

如何使用标准库使用 C++ 创建/删除/打开文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:00:52.680

如果您愿意使用 boost，那么[`boost::filesystem`](http://www.boost.org/doc/libs/1_49_0/libs/filesystem/v3/doc/index.htm)它的功能[`create_directory`](http://www.boost.org/doc/libs/1_49_0/libs/filesystem/v3/doc/reference.html#create_directories)就是为此目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T17:55:00.637

尝试在 sys/stat.h [http://pubs.opengroup.org/onlinepubs/7908799/xsh/mkdir.html中使用 mkdir](http://pubs.opengroup.org/onlinepubs/7908799/xsh/mkdir.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:00:03.870

在 linux 上，您可以使用函数 mkdir() 和 rmdir()。检查手册页：[mkdir](http://linux.die.net/man/3/mkdir)，[rmdir](http://linux.die.net/man/2/rmdir)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:03:37.790

尝试这个：

删除文件： [http ://cplusplus.com/reference/clibrary/cstdio/remove/](http://cplusplus.com/reference/clibrary/cstdio/remove/)

打开/创建文件： [http ://cplusplus.com/reference/clibrary/cstdio/fopen/](http://cplusplus.com/reference/clibrary/cstdio/fopen/)

是的，这些是 C 函数，但幸运的是 C 函数在 C++ 中工作。

要创建目录，请尝试 mkdir。您可以在手册页中阅读它：man 2 mkdir

祝你好运！

# sql - 处理sqlite中的空值

> ID：10606169
> 
> 赞同：1
> 
> 时间：2012-05-15T17:51:50.153
> 
> 标签：sql, sqlite, null

我想通过更新该表在包含空值的记录中插入一个零。我使用了以下代码，但无济于事。

```
Statement statementXIV = db.createStatement("UPDATE Temp54 SET bal53 = '0' WHERE balan = NULL ");
                    statementXIV.prepare();
                    statementXIV.execute();       
                    statementXIV.close(); 
```

`null`在`WHERE`子句中使用 a 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:01:33.270

我建议使用：

```
UPDATE Temp54 SET bal53 = '0' WHERE balan IS NULL OR balan = '' 
```

另外，看到这个链接，[SQLite select where empty?](https://stackoverflow.com/questions/3620828/sqlite-select-where-empty) . 公认的答案提供了各种方法，这些方法总是很高兴知道。

# php - 使用 PHP DOMXpath 和通配符时排除 HTML 属性

> ID：10606171
> 
> 赞同：1
> 
> 时间：2012-05-15T17:51:55.760
> 
> 标签：php, xpath, joomla

我正在尝试使用 PHP DOMXpath 匹配 Joomla 站点上的多个字符串，查询如下：

```
$query = "//*[contains(text(),'$target'))]"; 
```

HTML 标记的示例如下：

```
<ul>
  <li>
    <a href="#" title="foo bar"><span>foo bar</span></a>
 </li>
</ul> 
```

整个 PHP 函数（为清楚起见进行了修改）是：

```
function onAfterRender() {

    $buffer = JResponse::getBody();

    $doc = new DOMDocument;
    $doc->loadHTML($buffer);
    $xpath = new DOMXPath($doc);

    $targets = 'Foo, foo';
    $targets = explode(',', $targets);

     foreach ($targets as $target) {

         $query = $xpath->evaluate("//*[contains(.,'" . trim($target) . "')]");

         foreach($query as $match) {

            $match = $doc->saveXML($match);

            $replacement = preg_replace("/($target)/i",'<i class="notranslate">' . $target. '</i>',$match);

            $buffer = str_replace($match, $replacement, $buffer);

            JResponse::setBody($buffer);
        }

     }

    return true;
} 
```

有任何想法吗？

谢谢！

编辑：我之前没有明确说明的问题是，当使用这种方法注入 HTML 时，比如 foo，会生成无效标记。这种无效标记可能会很差地呈现给访问者，如果不是“破坏”的话。我想排除匹配的标题属性和可能的​​其他元素，如标题标签等。

编辑：我已经更新了原始问题和代码。部分解决方案是更改 $match = $doc->saveXML($match); 因为它保留了 HTML 标记。但是，我无法排除 HTML 属性，但可以通过进一步的正则表达式省略这些匹配项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:09:06.900

title="foo" 中缺少等号

```
<ul>
  <li>
    <a href="#" title="foo"><span>fooey</span></a>
 </li>
</ul> 
```

这似乎对我有用：

```
 $body = JResponse::getBody();
    // test
    $doc = new DOMDocument;
    $doc->loadHTML($body);
    $xpath = new DOMXPath($doc);
    $targets = 'Foo, foo';
    $targets = explode(',', $targets);

     foreach ($targets as $target) {

         $query = "//*[contains(text(),'".trim($target)."')]";
         echo $query .'<br>';

         foreach($xpath->query($query) as $match) {

            $match = $match->textContent;
            echo 'match: ' . $match .'<br>';

        }

     } 
```

输出：

```
//*[contains(text(),'Foo')]
//*[contains(text(),'foo')]
match: fooey 
```

# hibernate - 在休眠 JPA 中；即使在我提交交易之后；瞬态变量值是完整的

> ID：10606176
> 
> 赞同：0
> 
> 时间：2012-05-15T17:52:09.393
> 
> 标签：hibernate, jpa, transactions, transient

我有一个实体；它具有瞬态变量。在我提交这个实体之后；我以为下次我对这个实体进行任何操作时（没有 jvm 重新启动，就像对实体的更新一样）；那些瞬态值将被重置为 null 但它不会发生。

什么是最佳做法；以便在事务成功提交（实际上甚至回滚）之后；所有瞬态值都被重置。我知道我可以明确地做到这一点；但我正在寻找这样做的最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:21:07.900

持久层不会触及瞬态值（这就是你将它们设为瞬态的原因，对吗？）所以它们只会在对象被垃圾收集时消失。您可以通过从 JPA 缓存中逐出实体（或使其不可缓存）并再次获取它来强制解决问题。我想另一种选择是明确清除数据访问层中的瞬态值。

# haskell - 完成相同任务的替代方法是什么？

> ID：10606180
> 
> 赞同：2
> 
> 时间：2012-05-15T17:52:40.717
> 
> 标签：haskell

我有一个在父函数中实例化的结构，我想通过从该父函数调用函数来修改该实例化数据。这是一个人为的例子：

```
import Data.List

data MyLists = MyLists {
    myInts :: [Int],
    myBools :: [Bool]
} deriving (Show)

addIntToList :: Int -> MyLists -> MyLists
addIntToList x main_lists =
    main_lists { myInts = Data.List.insert x my_ints }
    -- might make a call to another child function that modifies main_list here, and so on (i.e., this is the vertical problem I see with this structuring)
        where
            my_ints = myInts main_lists

main :: IO()
main = do
    let my_main_lists = MyLists [1,2,3] [False, True, False]
    let my_new_main_lists = addIntToList 4 my_main_lists
    print my_new_main_lists
    let my_new_new_main_lists = addBoolToList True my_new_main_lists
    print my_new_new_main_lists
    -- and so on (this is the lateral problem I see with this code structuring) 
```

构建此代码或完成类似任务的替代方法是什么？有没有更简洁的方法？

我应该补充一点，一旦您对子函数进行一长串函数调用，这会变得特别臭（即代码气味）；他们最终都需要返回一个新的`MyLists`或者只是返回`main_list`而不做任何事情。那，父母可能还必须处理`MyList`另一个返回值（例如，`-> (Bool, MyList)`）。

所以，你可以想象一个函数调用的树结构都需要一个 MyList 参数和返回值；这似乎不是最优的。

这是我正在谈论的那种事情的更具体的例子。[在https://github.com/mokehehe/monao](https://github.com/mokehehe/monao)浏览代码（haskell 中的超级马里奥克隆）。您会看到 state.monad 从未被使用过，并且存在必须贯穿整个代码的上层结构（例如 Main.hs 中的 GameGame）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:20:05.560

您可以使用[RecordWildCards](http://www.haskell.org/ghc/docs/latest/html/users_guide/syntax-extns.html#record-wildcards)扩展使其更简洁：

```
{-# LANGUAGE RecordWildCards #-}
import Data.List (insert)

addIntToList :: Int -> MyLists -> MyLists
addIntToList x ml@MyLists{..} = ml{ myInts = insert x myInts } 
```

该`MyLists{..}`模式将记录的属性转储`MyLists`到范围内。`myInts`因此，我们可以在初始化 new 时轻松引用 old `myInts`。

相反，如果您`..`在表达式上下文中使用，它将在范围内填充具有相应名称的未初始化属性。`addIntToList`函数也可以写成：

```
addIntToList x MyLists{..} = MyLists{ myInts = insert x myInts, .. } 
```

使用记录通配符可以做的另一件很酷的事情：

```
someAction = do
    myInts  <- getInts :: IO [Int]
    myBools <- getBools :: IO [Bool]
    return MyLists{..} 
```

另外，`Data.List.insert`有点冗长。你可以说`insert`，因为这个导入：

```
import Data.List 
```

会将所有名称 from`Data.List`导入命名空间。如果你不喜欢这样（例如，因为你想在你自己的模块中定义一个名为 的函数`insert`），你可以导入它限定：

```
import qualified Data.List as List

… List.insert … 
```

就`MyLists`在程序中使用而言，`StateT`monad 转换器非常有帮助：

```
{-# LANGUAGE RecordWildCards #-}
import Control.Monad.State

...

printList :: StateT MyLists IO ()
printList = liftIO . print =<< get

program :: StateT MyLists IO ()
program = do
    printList
    modify $ addIntToList 4
    printList
    modify $ addBoolToList True
    printList

main :: IO()
main = evalStateT program $ MyLists [1,2,3] [False, True, False] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:19:04.530

你应该看`Data.Lens`一下`MonadState`：

```
{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE FlexibleContexts #-}

import Control.Monad.State
import Data.Lens
import Data.Lens.Template
import qualified Data.List

data MyLists = MyLists { _myInts :: [Int]
                       , _myBools :: [Bool]
                       } deriving ( Show )

$(makeLens ''MyLists)

addIntToList :: MonadState MyLists m => Int -> m [Int]
addIntToList i = myInts %= Data.List.insert i

addBoolToList :: MonadState MyLists m => Bool -> m [Bool]
addBoolToList b = myBools %= Data.List.insert b

program :: MonadState MyLists m => m ()
program = do
    addIntToList 1
    addBoolToList False
    addIntToList 2
    addBoolToList True
    return ()

main = do
  let ml = execState program MyLists { _myInts = []
                                     , _myBools = []
                                     }
  print ml 
```

**编辑：**

这就是我输入未经测试的代码所得到的。我更改了示例，因此它确实有效！您需要安装`data-lens`、`data-lens-fd`和`data-lens-template`模块（使用`cabal install`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:15:06.450

我不是专业人士，但这就是我尝试实现这一目标的方式

```
import Data.List (insert)

data MyLists = MyLists { myInts  :: [Int],
                         myBools :: [Bool]
                       } deriving (Show)

addIntToList :: Int -> MyLists -> MyLists
addIntToList i (MyLists is bs) = MyLists (insert i is) bs
-- if you don't care about order just do (i:is), which is faster
-- usually lists of i are denoted is (or sometimes I use ii) as a kind of plural

main :: IO()
main = do
    let myMainList = MyLists [1,2,3] [False, True, False]
    -- you would rather use CamelCase in Haskell than _
    print $ addIntToList 4 myMainList 
```

# java - 试图将多个命令行参数传递给 javaws 启动应用程序？

> ID：10606183
> 
> 赞同：4
> 
> 时间：2012-05-15T17:52:49.810
> 
> 标签：java, command-line, arguments, jnlp, java-web-start

我已经看到了类似的问题，但没有一个能够帮助我解决我的问题。我被要求能够传入多个命令行参数来启动我们使用的自定义 Java 应用程序。

无论如何，我已经尝试过这个命令，因为我能找到的所有文档都说：

```
"javaws -open arg1 arg2 arg3 arg4 arg5 arg6 http://yadda/html/launch.jnlp" 
```

我还尝试了各种数量的参数，并注意到“-open”确实作为参数 arg[0] 传入，但由于某种原因它不会接受更多参数。

相关解决方案之一说您可以向 JNLP 添加任意数量的参数，如下所示，然后如果没有提供参数，则应该使用默认值，但如果是，则应该传递它们而不是默认值. 这是真的？

```
<application-desc main-class="com.company.casd.core.MainClass">
    <argument>testARG1</argument>
    <argument>testARG2</argument>
    <argument>testARG3</argument>
    <argument>testARG4</argument>
    <argument>testARG5</argument>
    <argument>testARG6</argument>
</application-desc> 
```

本地 Java：
C:\Users\user>java -version
java version "1.6.0_31"
Java(TM) SE Runtime Environment (build 1.6.0_31-b05)
Java HotSpot(TM) 64-Bit Server VM (build 20.6-b01) ， 混合模式）'

LinuxServer:~ # java -version
java version "1.7.0"
IcedTea Runtime Environment (build 1.7.0-b24)
IcedTea 64-Bit Server VM (build 1.7.0-b24, mixed mode)

它可能与服务器与我的本地机器的不同版本有关吗？还是我还缺少其他东西？

任何帮助或帮助将不胜感激！

谢谢！
乔什

# android - How to get class name only, not full path?

> ID：10606190
> 
> 赞同：77
> 
> 时间：2012-05-15T17:53:12.840
> 
> 标签：android

I am aware that using `Context` and a method `getClass().getName()` I can get a string which represent full class name, like `com.package1.package2.MainActivity`.

How can I get only the last part, class name only? In this case it would be `MainActivity` string.

I can do it with a simple `split()` method, but maybe there is a better way, more reliable.

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-05-15T18:58:15.427

This is all you need.

```
MainActivity.this.getClass().getSimpleName(); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-05-15T17:59:26.843

To get only the name of the class, not full path you will use this expression:

```
String className =  this.getLocalClassName(); 
//or
String className = getBaseContext().getLocalClassName();  
//or
String className = getApplicationContext().getLocalClassName(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-24T21:32:29.677

Alternatively, you could use:

```
private static final String TAG = MainActivity.class.getSimpleName(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-28T09:01:08.670

1.  If you need class name within a method, use `getLocalClassName()`

2.  If you need class name outside a method, use `getClass().getSimpleName()`

3.  If you want to reuse the class name in multiple methods within the same class, then use `private final String TAG = getClass().getSimpleName();` within the class and then use TAG variable in every method.

4.  If you want to access the class name from static methods, then use `private static final String TAG = MainActivity.class.getSimpleName();` now use the static variable TAG within your static methods.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T17:56:52.600

No matter what way you do it, you'll need to perform an extra operation on top of getClass. I'd recommend this over split:

```
String className = xxx.getClass();
int pos = className.lastIndexOf ('.') + 1; 
String onlyClass = className.substring(pos); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-21T07:13:07.680

Kotlin way: `MainActivity::class.java.simpleName`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-16T13:56:33.743

No other solutions work for me, dunno why. I'm using

```
this.getClass().getName().replace("$",".").split("\\.")[3] 
```

cons: in one string, and you can use it in threads and listeners.

(in listeres I get something like *com.djdance.android.main$53*)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-05T07:24:48.007

If you want to get the name outside the class you can call:

```
MainActivity.class.getSimpleName() 
```

in this way you can avoid to make your class static.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-06T17:15:11.970

Use the `getSimpleName` method:

```
String name = getClass().getSimpleName(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-04T17:52:55.910

In kotlin you should use:

```
val className = javaClass.simpleName 
```

# css - 如何将任何 div 高度从中间拉伸到浏览器窗口的末尾

> ID：10606192
> 
> 赞同：2
> 
> 时间：2012-05-15T17:53:22.680
> 
> 标签：css, html, height

我需要在没有单独使用 CSS（没有 jQuery 或 JavaScript）的滚动条的情况下拉伸`div.leftContent3`并直到浏览器窗口的末尾，并且以同样支持 IE7 的方式进行。`div.bodyContent3`怎么做？

**HTML：**

```
<div class="parent">
    <div class="leftPanel">
        <div class="leftContent1">
            Left Content1
        </div>
        <div class="leftContent2">
            Left Content2
        </div>
        <div class="leftContent3">
            Left Content3
        </div>
    </div>
    <div class="bodyContent">
        <div class="bodyContent1">
            Body Content1
        </div>
        <div class="bodyContent2">
            Body Content2
        </div>
        <div class="bodyContent3">
            Body Content3
        </div>
    </div>
</div> 
```

**CSS：**

```
* {
    margin: 0;
    padding: 0;
}
html, body, .parent {
    height: 100%;
}
.parent {
    margin: auto;
    width: 1000px;
}
.leftPanel {
    float: left;
    width: 200px;
    height: 100%;
}
.bodyContent {
    float: left;
    width: 800px;
    height: 100%;
}
.leftContent1, .leftContent2, .leftContent3,
.bodyContent1, .bodyContent2, .bodyContent3 {
    border-bottom: 1px solid #000000;
    float: left;
    width: 100%
}
.leftContent1 {
    background-color: #cccccc;
    height: 125px;
}
.leftContent2 {
    background-color: #999999;
    height: 150px;
}
.leftContent3 {
    background-color: #ff0000;
    height: inherit;
}
.bodyContent1 {
    background-color: #fcfcfc;
    height: 120px;
}
.bodyContent2 {
    background-color: orange;
    height: 80px;
}
.bodyContent3 {
    background-color: #00ff00;
    height: inherit;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:14:29.470

如果我确实理解了您的问题，您可以通过应用 some `position:relative;`, `position:absolute;`with `top`, `left`, `right`,来实现您的目标`bottom`：

请参阅工作[小提琴示例！](http://jsfiddle.net/zuul/7QcZb/)

**HTML**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title></title>
  </head>
  <body>
    <div class="parent">
      <div class="leftPanel">
        <div class="leftContent1">Left Content1</div>
        <div class="leftContent2">Left Content2</div>
        <div class="leftContent3">
          Left Content3 This Section needs to beexpand till the end of
          the browser window Without having browser scroll
        </div>
      </div>
      <div class="bodyContent">
        <div class="bodyContent1">Body Content1</div>
        <div class="bodyContent2">Body Content2</div>
        <div class="bodyContent3">
          Body Content3 This Section needs to beexpand till the end of
          the browser window Without having browser scroll
        </div>
        </div>
      </div>
  </body>
</html> 
```

**CSS**

```
* { margin:0; padding:0; }
html, body, .parent { height:100%; }

.parent { margin:auto; width:1000px; }

.leftPanel { float:left; width:200px; height:100%; position:relative; }
.bodyContent { float:left; width:800px; height:100%; position:relative; }

.leftContent1, .leftContent2, .leftContent3, .bodyContent1,
.bodyContent2, .bodyContent3 {
    border-bottom: 1px solid #000000;
    position: absolute;
    left: 0;
    right: 0;
}

.leftContent1 { background-color:#cccccc; height: 125px; }
.leftContent2 { background-color:#999999; height: 150px; top:125px; }
.leftContent3 { background-color:#ff0000; top:275px; bottom:0; }

.bodyContent1 { background-color:#fcfcfc; height:120px; }
.bodyContent2 { background-color:orange; height:80px; top:120px; }
.bodyContent3 { background-color:#00ff00; top:200px; bottom: 0; } 
```

### 笔记

您可以拖动 Fiddle 的拆分栏来查看两个 div 的增长和缩小。

要阅读此内容：

[CSS 定位](http://www.w3schools.com/css/css_positioning.asp)和[CSS 位置属性](http://www.w3schools.com/cssref/pr_class_position.asp)

# ios - UIView在tableHeaderView时更新，但在子视图时不更新

> ID：10606195
> 
> 赞同：0
> 
> 时间：2012-05-15T17:53:28.397
> 
> 标签：ios, cocoa-touch, uiview, addsubview

我有一个包含 TableView 的自定义 UIView。在表格上方，我计划展示一些其他项目。现在，我只想要一个按钮。

我正在创建一个 UIView 'headerView'，并将按钮添加到它。按钮本身只是被操纵以在按下时更新其标题。

如果我将 headerView作为 tableHeaderView 添加*到*表视图中，它就可以正常工作。

如果我在 tableview*上方*添加 headerView ，作为兄弟子视图，它会正确显示，但按钮标题不会更新。

我通过日志验证了更新按钮标签的方法被调用，但视图似乎需要刷新。

为什么会这样？我是否缺少一些简单的东西。

如果有帮助，请遵循代码。

注意：我没有使用 IB。

**更新**：我已将其缩小到一行。当我设置 tableview 的框架时，我将它添加到 headerView 下方，我将 origin.y 设置为 headerView.size.height。如果我将其更改为使用硬编码数字（即使是相同的值），按钮也会更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:54:28.907

没有任何代码很难诊断问题，但这里有一些常见的问题/解决方案可能会有所帮助。

1.  使用 [button setTile:forState:] 而不是 button.titleLabel.text
2.  通过在适当的视图上调用 setNeedsLayout 和/或 layoutIfNeeded，确保您没有错过任何对 layoutSubviews 的调用。
3.  确保使用正确的控制事件将正确的选择器名称连接到正确的目标。

听起来因为它在某些情况下有效，所以 1 和 3 不是问题。此外，由于它在您设置不同的大小时工作，它可能是 2。tableview 将正确调用布局方法到它的标题视图，这可能是它作为表标题视图而不是正常兄弟视图工作的原因。

# java - 如何从 Java EE 服务器（JBoss）上同一耳朵的不同战争中访问文件？

> ID：10606196
> 
> 赞同：7
> 
> 时间：2012-05-15T17:53:32.370
> 
> 标签：java, file-io, jboss, java-ee-6

所以下面的问题：我们有一个负载均衡器，后面有 n 个服务器。在每台服务器上，ear 中都安装了一个 PDF 项目（war）以及同一个 earfile 中的 pdf-builder 项目（不同的 war）。我现在想阅读另一场战争的 pdf。

问题是：我不知道我正在运行的服务器的 IP 地址，并且使用 dns 查找我可能会通过负载平衡器在不同的服务器上结束。此外，访问/安全约束可能存在问题，因为服务器本身不是有权访问 pdf war 项目的 pdf 文件位置的有效用户。

有没有办法获得像 getResourceAsStream() 这样的东西，它可以在耳朵内的不同模块/战争文件中工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T09:32:30.443

您可以将 .PDF 移至单独的 jar（即 pdf-builder.jar）并将其放入 .EAR 在您的 .WAR ( `META-INF/MANIFEST.MF`) 清单中放入以下行：

```
Class-Path: pdf-builder.jar 
```

现在您可以使用类加载器加载 .PDF。这是符合 J2EE 的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T10:40:41.237

您需要提供文件的绝对路径才能访问不在当前类路径中的资源。

你可以打电话

```
`serverletContext.getRealpath("/");`
```

将给出直到服务器节点（上下文）的路径。从那里您可以导航到该文件。

另一种方法是，Jboss 在引导时使用（或设置）几个环境变量。您可以使用这些属性来获取当前节点（如“默认”）。以下两个属性将为您提供当前服务器节点的绝对路径。

```
`System.getProperty("jboss.server.base.dir") + File.separator + System.getProperty("jboss.server.name")`;
```

（`System.getenv('varname')`如果 getProperty 不起作用，请使用）。从那里您可以导航。 [这](https://community.jboss.org/wiki/JBossProperties)是 jboss 使用的系统变量的完整列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T14:23:36.167

WAR 旨在相互隔离。他们可以“向上”查看应用程序类加载器（EAR 级别），但无法访问对等的类加载器。因此，虽然可能有办法让它在您的特定应用程序服务器上工作，但不建议这样做。如果运营团队中的某个人更改了部署选项，他们可能不知道您正在依赖该机制，并且会以一种（可能）神秘的方式破坏应用程序。

尝试访问这样的对等类加载器违反了 Java EE（如果不是规范的文字，至少是它的精神）。

如果您不能将静态内容放在单独的服务器上进行访问，至少将静态 PDF 放入 JAR（如其他人建议的那样）并部署到 EAR 中。当你这样做时，不要忘记将 JAR 条目添加到声明 WAR 的清单文件中（否则它不会将 JAR 加载到应用程序类加载器中）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T10:58:28.830

1.  如果部署不是太频繁，请将其更改`.war`为`.jar`( ?)。`.ear`例如，如果您每天重新启动，则在服务器 lib 目录中。

2.  不要部署战争，而是将文件上传到固定目录，即使用**rsync**。*这有我的偏好。*

3.  按照@Rp- 说的做，可能会解压缩。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T23:44:12.953

我知道我没有足够的经验来回答这样的问题，所以，在一个非常非常粗略的草图中，我所能想到的就是将每个 .war 设置为不同的 Spring 上下文，然后通过在内部设置适当的映射来动态加载它弹簧 MVC 框架。

[在运行时动态加载 Spring 上下文](http://www.crazymcphee.net/x/2010/04/29/dynamically-loading-spring-contexts-from-the-classpath-at-runtime/)

[将 Spring 资源加载为依赖 jar](http://forum.springsource.org/showthread.php?105580-Spring-Resources-loading-in-dependant-jars)

[Web 资源 - 第 9 章 - Spring 参考](http://static.springsource.org/osgi/docs/1.2.x/reference/html/web.html)

# javascript - JavaScript：如何正确地制作我的 IDE 提示类

> ID：10606197
> 
> 赞同：1
> 
> 时间：2012-05-15T17:53:38.613
> 
> 标签：javascript

我正在使用 Komodo IDE 开发一个 JavaScript 库，但我希望我的 IDE 知道我拥有哪些类型的对象以及它们的作用。特别是，我正在尝试解决这样的问题。考虑以下：

```
NS = {
    Template: {
        Class1: function() { 
            this.arg1 = 0;
        }
    }
}

/**
 * @return {NS/Template/Class1}
 */
function test()
{
    return new NS.Template.Class1();
}

var tmp = test();
tmp. // that should give me a select box with "arg1" present 
```

但是上面的例子不起作用。我在想要么我在 @return 中错误地指定了命名空间，要么 IDE 根本不支持这个。以下示例不是我想做的事情，但它有效：

```
NS = {
    Template: {
        /**
         * @type __Class1
         */
        Class1: __Class1 // this is only here for access via NS.*
    }
}

function __Class1()
{
    this.arg1 = 0;
}

/**
 * @return {__Class1}
 */
function test()
{
    return new __Class1();
}

var tmp = test();
tmp. // that does give a select box with "arg1" in it 
```

基本上我要问的是，是否有人知道如何使用评论使 IDE（如果可能的话，Komodo）识别“命名空间”中的类。第二个例子虽然有效，但对我来说似乎很丑陋，我不想使用它。

谢谢你的想法

# iphone - 模拟器冻结在 arc4random 方法中

> ID：10606199
> 
> 赞同：0
> 
> 时间：2012-05-15T17:53:45.410
> 
> 标签：iphone, objective-c, ios, random, freeze

在我的应用程序中，您首先会获得一个开始按钮，当您点击“开始”时，该应用程序会将整数 fraga1-fraga40 随机化在 0 到 23 之间（将用作问题）。fraga1 到 fraga12 不能相同。fraga13 到 fraga22 不能相同。fraga23 到 fraga28 不能相同。fraga29 到 fraga40 不能相同。

然后过了一会儿，你会得到另一个开始按钮。当你按下那个按钮时，fraga41-fraga81 将在 0 和 23 之间随机化。fraga41 到 fraga52 不能相同。`` fraga53 到 fraga62 不能相同. fraga63 到 fraga68 不能相同。fraga69 到 fraga80 不能相同。

但是当您第二次单击开始按钮时，该按钮保持“单击”（或“突出显示”）状态并且应用程序模拟器冻结。

我正在使用这样的代码......

```
 -(void) v1
 {
     fraga1=arc4random()%24;
    [self v2];
  }
  -(void) v2

 {
      fraga2=arc4random()%24;
      if(fraga2==fraga1)
       {
         [self v2];
      }
      [self v3];
  }
 -(void) v3
 {
      fraga3=arc4random()%24;
     if(fraga3==fraga2||fraga3==fraga1)
     {
         [self v3];
     }
           [self v4];
     } 
```

从第一个按钮一直到 40... 从另一个按钮从 v41 到 v80！

你觉得我能解决这个问题吗？我应该改变随机问题的策略吗？

我试图改变它，让它像30个数字一样随机化，但它仍然是一样的......当我在每个问题上尝试100个数字时......它有效，但有点慢！

提前致谢！

/一个菜鸟

编辑：我这样做了，但每个 frag 都设置为 0：

```
void fillUniqueRand(uint32_t arr[], uint32_t l, uint32_t n) 
```

{ uint32_t in, il = 0;

```
for(in = 0; in < n && il < l; ++in)
{
    uint32_t rn = n - in;
    uint32_t rl = l - il;
    if(arc4random() % rn < rl)
        arr[il++] = in;
}

//We now have random numbers in order and
//need to shuffle them
uint32_t j, tmp;
for(uint32_t i = l - 1; i > 0; i--)
{
    j = arc4random() % (i + 1);
    tmp = arr[i];
    arr[i] = arr[j];
    arr[j] = tmp;
} 
```

} //从方法调用这个 -(void) vnr { uint32_t fraga1, fraga2, fraga3,fraga4, fraga5,fraga6,fraga7,fraga8,fraga9,fraga10,fraga11,fraga12, fraga13,fraga14,fraga15,fraga16,fraga17,fraga18 ,fraga19,fraga20,fraga21,fraga22, //... fraga23, fraga24, fraga25,fraga26,fraga27,fraga28,fraga29,fraga30,fraga31,fraga32,fraga33,fraga34,fraga35,fraga36,fraga37,fraga38,fraga39,fraga40; //,... ;

```
//Max fraga range I noticed was 12
uint32_t unique[12] = { 0 };
fillUniqueRand(unique, 12u, 24u);

fraga1 = unique[0];
fraga2 = unique[1];
fraga3 = unique[2];
fraga4 = unique[3];
fraga5 = unique[4];
fraga6 = unique[5];
fraga7 = unique[6];
fraga8 = unique[7];
fraga9 = unique[8];
fraga10 = unique[9];
fraga11 = unique[10];
fraga12 = unique[11];
//...
fillUniqueRand(unique, 10, 24u);

fraga13 = unique[0];
fraga14 = unique[1];
fraga15 = unique[2];
fraga16 = unique[3];
fraga17 = unique[4];
fraga18 = unique[5];
fraga19 = unique[6];
fraga20 = unique[7];
fraga21 = unique[8];
fraga22 = unique[9];
//Only 6 elements between fraga23-fraga28
fillUniqueRand(unique, 6, 21u);

fraga23 = unique[0];
fraga24 = unique[1];
fraga25 = unique[2];
fraga26 = unique[3];
fraga27 = unique[4];
fraga28 = unique[5];

fillUniqueRand(unique, 12u, 24u);

fraga29 = unique[0];
fraga30 = unique[1];
fraga31 = unique[2];
fraga32 = unique[3];
fraga33 = unique[4];
fraga34 = unique[5];
fraga35 = unique[6];
fraga36 = unique[7];
fraga37 = unique[8];
fraga38 = unique[9];
fraga39 = unique[10];
fraga40 = unique[11];
//...
//You get the picture 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:29:19.763

根据[C 编程语言中整数数组中唯一随机数](https://stackoverflow.com/questions/1608181/unique-random-numbers-in-an-integer-array-in-the-c-programming-language)的答案，您应该实现更有效的算法，这样您就不会陷入无限循环，并避免在范围结束时花费昂贵的计算时间。这是一个可能适合您的实现示例。

```
/*!
 @param arr Array to be filled with unique random numbers
 @param l Number of elements to fill in the array
 @param n The max of range the random number
    (if there is a minimum range then just add it to each resulting arr index)
 */
void fillUniqueRand(uint32_t arr[], uint32_t l, uint32_t n)
{
    uint32_t in, il = 0;

    for(in = 0; in < n && il < l; ++in)
    {
        uint32_t rn = n - in;
        uint32_t rl = l - il;
        if(arc4random() % rn < rl)
            arr[il++] = in;
    }

    //We now have random numbers in order and
    //need to shuffle them
    uint32_t j, tmp;
    for(uint32_t i = l - 1; i > 0; i--)
    {
        j = arc4random() % (i + 1);
        tmp = arr[i];
        arr[i] = arr[j];
        arr[j] = tmp;
    }
} 
```

* * *

```
//Calling this from a method
-(void) v1
{
    uint32_t 
        fraga1, fraga2, fraga3, //...
        fraga23, fraga24, fraga25 //,...
    ;

    //Max fraga range I noticed was 12
    uint32_t unique[12] = { 0 };
    fillUniqueRand(unique, 12u, 24u);

    //fill fraga1 - fraga12
    fraga1 = unique[0];
    fraga2 = unique[1];
    fraga3 = unique[2];
    //...

    //Only 6 elements between fraga23-fraga28
    fillUniqueRand(unique, 6, 24u);

    //fill fraga23 - fraga28
    fraga23 = unique[0];
    fraga24 = unique[1];
    fraga25 = unique[2];
    //...
    //You get the picture
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:24:00.223

我建议你使用一个可变数组来处理你的整数 fragaXY。您不能将整数直接添加到数组中，但可以在执行此操作后添加它们：

`[myArray addObject:[NSNumber numberWithInt:fragaXY]];`

所以我建议你从你的数组开始，用随机数完全填充它（而不是在你进行时生成它们），并修复任何匹配的数字，使用 for 循环

```
NSMutableArray *myArray = [[NSMutableArray alloc] initWithCapacity:80];

for (int i=0;i<80;i++) {
[myArray addObject:[NSNumber numberWithInt:(arc4random%24)]];
} 
```

完成后，要检查您的要求是否满足，您可以编写：

```
if([myArray objectAtIndex:0].intValue != [myArray objectAtIndex:11].intValue) {

//checking if they fraga1 is different than fraga12 and so on... here you can change one of the values..

} 
```

这将使您的代码更干净。

# ruby - 使用 regex/ruby 在另一个字符串中附加一个字符串

> ID：10606201
> 
> 赞同：0
> 
> 时间：2012-05-15T17:53:53.183
> 
> 标签：ruby, regex

我想在 iframe 中附加 youtube 链接的参数`?wmode=transparent`， 例如，对于下面的链接：`src`

```
<iframe frameborder=\"0\" height=\"315\" src=\"http://www.youtube.com/embed/F4_Bq16rB2Y\" width=\"560\"></iframe> 
```

我想要`src=\"http://www.youtube.com/embed/F4_Bq16rB2Y?wmode=transparent\"`在 iframe 中。

```
result = <iframe frameborder=\"0\" height=\"315\" src=\"http://www.youtube.com/embed/F4_Bq16rB2Y?wmode=transparent\" width=\"560\"></iframe> 
```

使用正则表达式和/或 ruby​​ 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:24:33.837

```
str ='<iframe frameborder=\"0\" height=\"315\" src=\"http://www.youtube.com/embed/F4_Bq16rB2Y\" width=\"560\"></iframe>'
puts str.gsub('\" width=', '?wmode=transparent\" width=')

#=><iframe frameborder=\"0\" height=\"315\" src=\"http://www.youtube.com/embed/F4_Bq16rB2Y?wmode=transparent\" width=\"560\"></iframe> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:08:56.573

示例 str 是否包含整个 iframe 文本。您可以`gsub`像这样使用分组：

```
str = "<iframe ....>"
str.gsub!(/(youtube[\w\.\/]+)/, '\1?wmode=transparent') 
```

# twitter - 用于收集推文的 Twitter 流 API

> ID：10606202
> 
> 赞同：0
> 
> 时间：2012-05-15T17:53:55.287
> 
> 标签：twitter, twitter4j

我想收集一些特定信息的推文。考虑哈希标签。我想收集一些特定的哈希标签。这些推文已有 15 天的历史，即使在今天，也有关于它的新推文。我想知道该示例是否有任何 API 可以执行此过程。我想以 Json 格式收集推文，然后将其处理以存储到数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:32:18.950

你可以试试 Twitter 的 Search API。

`http://search.twitter.com/search.json?q=%23Twitter`

主题标签在`#Twitter`URL 中编码的位置。

我问了一个类似的问题，这对你有帮助。[是否为公共地理推文选择 Twitter 的 Search 或 Streaming API？](https://stackoverflow.com/questions/9378294/whether-to-choose-search-or-streaming-api-of-twitter-for-public-geo-tweets)

# python - 递归字谜算法的大 O 复杂度

> ID：10606205
> 
> 赞同：2
> 
> 时间：2012-05-15T17:54:09.357
> 
> 标签：python, recursion, big-o, anagram

我正在尝试使用递归方法 anagram() 返回字符串的所有排列。对于任何单词“ABCD...N”，该函数返回一个列表，该列表在 anagram("BCD...N") 中的尽可能多的位置上包含字母“A”。递归的限制情况是，如果参数大小为 2（例如：“XY”），则返回 ['XY','YX']。

代码如下：

```
def anagram(block):
   if (len(block) <= 2):
      permu=list()
      permu.append(block[0]+block[1])
      permu.append(block[1]+block[0])
   else:
      permu=list()
      lowerpermu=anagram(block[1:])             # anag(sd)
      for blocklet in lowerpermu:           # sd, ds are blocklets
         for each in rotate(block[0],blocklet):     # each in ['asd', 'sad', 'sda'] and ['ads', 'das', 'dsa']
            permu.append(each)
   return permu

def rotate(letter, word):
   rotatedlist=list()
   for i in range(len(word)+1):
      rotatedlist.append(word[:i]+letter+word[i:])
   return rotatedlist

def main():
   word=raw_input('Enter the word to be anagrammed: ')  #for example: 'asd'
   print anagram(word)                  

if __name__ == '__main__':
    main() 
```

我正在自学一般算法及其分析，如果有人能提出一种经验法则来估计涉及递归的算法顺序，我将不胜感激。

# c# - 无论如何，RDPSession 上的 COMException E_UNEXPECTED

> ID：10606207
> 
> 赞同：1
> 
> 时间：2012-05-15T17:54:25.257
> 
> 标签：c#, windows, sharing, rdp

我正在尝试根据此处找到的说明[和此处](http://msdn.microsoft.com/en-us/library/bb968809.aspx)[和](http://blogs.msdn.com/b/rds/archive/2007/03/23/writing-a-desktop-sharing-application.aspx)此处[找到](http://blogs.msdn.com/b/rds/archive/2007/03/08/windows-desktop-sharing-api.aspx)的文档制作屏幕共享应用程序。但是，这是一个没有太多信息的主题，文档也很少。

这是我正在使用的代码片段。这是在我的会话（服务器）端，因此将把它的桌面共享给客户端。

```
private void Form1_Load(object sender, EventArgs e)
    {
        session.OnAttendeeConnected += session_OnAttendeeConnected;
        session.Open();

        IRDPSRAPIInvitation invitation = session.Invitations.CreateInvitation(null, "test", "", 10);
        invitationTextBox.Text = invitation.ConnectionString;
        log.Debug("Created invitation: " + invitation.ConnectionString);
    }

    void session_OnAttendeeConnected(object pAttendee)
    {
        IRDPSRAPIAttendee attendee = pAttendee as IRDPSRAPIAttendee;
        attendee.ControlLevel = CTRL_LEVEL.CTRL_LEVEL_INTERACTIVE;
        log.Info("Attendee Connected from " + attendee.RemoteName);
    }

    private void requestColourDepth(object sender, EventArgs e)
    {
        session.Pause();

        if (eightBitRadio.Checked)
        {
            session.colordepth = 8;
        }
        else if (sixteenBitRadio.Checked)
        {
            session.colordepth = 16;
        }
        else if (twentyfourBitRadio.Checked)
        {
            session.colordepth = 24;
        }
        else
        {
            session.colordepth = 32;
        }

        session.Resume();
    } 
```

我的问题是 Form1_Load 之外的任何尝试与会话对象交互的东西都会导致以下异常：

```
 base    {"Catastrophic failure (Exception from HRESULT: 0x8000FFFF (E_UNEXPECTED))"}    System.Runtime.InteropServices.ExternalException {System.Runtime.InteropServices.COMException}
        ErrorCode   -2147418113 int 
```

我不认为这完全是我的代码错误，我相信在处理 COM 的地方不能正确加载某些东西，但我没有太多使用 COM 对象的经验，可以使用一些方向。

谢谢！

# php - 在服务器上保持文件安全 - 更改权限是否足够？

> ID：10606210
> 
> 赞同：2
> 
> 时间：2012-05-15T17:54:35.300
> 
> 标签：php, security

当我存储访问我的数据库的文件时，是否将文件的权限更改为 0600 足以阻止服务器上除其他文件之外的任何内容访问该文件？我已经读过一种方法是将文件存储在 Web 根目录之外，但是更改权限会给您带来相同的安全结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T17:57:35.273

您可以做很多事情：

*   对包含文件的目录设置权限
*   设置文件的权限
*   设置您的服务器指令以修改您的 url，以便只有“公共”文件夹中的内容可以通过直接链接访问，否则它们必须由代理通过服务器端代码加载。

我更喜欢方法3。

# java - request.getSession() 和 request.getSession(boolean createNew) 的意义

> ID：10606213
> 
> 赞同：0
> 
> 时间：2012-05-15T17:54:57.003
> 
> 标签：java, http, servlets

在使用`HttpServletRequest.getSession()`Servlet 中的方法时，我意识到 Servlet API 的官方文档表明，`HttpServletRequest.getSession()`如果当前会话已过期或已失效，则返回一个新的会话对象。

此外，如果为 true 并且前一个会话不再存在，则`HttpServletRequest.getSession(boolean createNew)`返回一个新会话。`createNew`

通常，IMO 在设计 API 时，会将这些方法设计为`HttpServletRequest.getSession(true)`如果前一个会话无效则创建一个新会话，`HttpServletRequest.getSession()`如果存在则返回现有会话，否则返回 null。

API 的这种显着差异是否有任何具体原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:38:09.553

应用程序更有可能需要当前会​​话或创建一个新会话，而不是仅当当前会话存在时。因此，Servlet EG 选择的 API 就是这样编写的。

# php - JQuery 表单意外重新加载

> ID：10606215
> 
> 赞同：1
> 
> 时间：2012-05-15T17:55:01.337
> 
> 标签：php, javascript, jquery, ajax, reload

我在一个页面上有两个表格，一个登录和一个注册表单。
注册表单可以完美地与 JQuery 脚本配合使用，但是当我提交登录脚本时，页面会刷新吗？我已经尝试过“return false”；和“event.preventDefault();” 这是我最新的脚本，添加了一些额外的代码。

```
$(document).ready(function(){
        $("#login_form").submit(function(){
    l_user=$("#l_user").val();
    l_user=$("#l_pass").val();
    $.ajax({
        type: "POST",
        url: "../../functions/login-java.php",
        data: { l_user: l_user, l_pass: l_pass },
        success: function(html){
            if ($.trim(html)=="true")
            {
                $('.l_loader').spin(false);
                $('#login_form').slideUp('slow', function() {
                    $('#login_msg').removeClass('msg_error').addClass('msg_ok');
                    $('#login_msg').html('You are being logged in...');
                    $('#login_msg').slideDown('slow');
                });
            }
            else
            {
                $('.l_loader').spin(false);
                $('#login_msg').removeClass('msg_error').addClass('msg_error');
                $("#login_msg").html(html);
                $("#login_msg").slideDown('slow');
            }
        },
        beforeSend:function()
        {
            $('.l_loader').spin();
        }
    });
    return false;
});
$("#register_form").submit(function(){
    r_name=$("#r_name").val();
    r_user=$("#r_user").val();
    r_email=$("#r_email").val();
    $.ajax({
        type: "POST",
        url: "../../functions/register-java.php",
        data: { r_name: r_name, r_user: r_user, r_email: r_email },
        success: function(html){
            if ($.trim(html)=="true")
            {
                $('.r_loader').spin(false);
                $('#register_form').slideUp('slow', function() {
                    $('#register_msg').removeClass('msg_error').addClass('msg_ok');
                    $('#register_msg').html('You have registered! Please check you email to continue.<br />Note: our messages are usually marked as spam.');
                    $('#register_msg').slideDown('slow');
                });
            }
            else
            {
                $('.r_loader').spin(false);
                $('#register_msg').removeClass('msg_error').addClass('msg_error');
                $("#register_msg").html(html);
                $("#register_msg").slideDown('slow');
            }
        },
        beforeSend:function()
        {
            $('.r_loader').spin();
        }
    });
    return false;
}); 
```

});

# php - 试图将 php 文件（带有图像标签）加载到fancybox

> ID：10606217
> 
> 赞同：0
> 
> 时间：2012-05-15T17:55:03.290
> 
> 标签：php, jquery, fancybox

我最近需要将图像加载到 Fancybox 中并在显示时对它们进行计数，这样我就可以知道每个图像被查看了多少次。我能够通过here找到答案，但是今天再次查看时，宽度似乎没有自动调整大小。昨天它一定被缓存了，这就是为什么它看起来不错。我通过firebug查看源代码，可以清楚地看到宽度为0，奇怪的是每次单击next或previous通过图库时高度都会调整。昨天的答案是把一个php文件加载到fancybox中，对图像进行计数，然后显示图像。关于如何使用此方法获得自动调整宽度的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T03:59:25.610

php文件是在计算图像后加载图像并发送图像标题还是使用html代码显示？ie '' 如果是后者，你应该发送图像标题，fancybox 应该读取它们然后自动调整窗口大小。

# database - 假设我们使用 git 进行代码，如何对 CMS 内容（例如 Drupal）进行版本控制

> ID：10606223
> 
> 赞同：4
> 
> 时间：2012-05-15T17:55:17.813
> 
> 标签：database, git, content-management-system, workflow

对于使用 cms 的 Web 开发团队来说，最好的 git 工作流程是什么？让我解释一下情况。在我们的上一个项目中，我们使用 git 进行版本控制。

首先，我们尝试了分布式版本控制，其中每个成员都有自己的 git 存储库并推/拉到一个裸存储库。然而，由于我们使用了 Drupal（*但 Druapl 不是唯一这样做的 cms*），我们依赖于模块。创建页面布局时，Drupal(module) 将生成它自己的 HTML，并将其发送到 DB。

所以当我们将模板的源代码推送到裸仓库时，问题就出现了，其他开发人员可以拉取它，但数据库的更改保留在本地数据库中。在某个时候，我们放弃了这种工作流风格，开始在一台服务器上工作。

在下一个项目中，我们只是开始在一台服务器上工作，并尝试创建尽可能多的模板，以便这些模板可以覆盖模块尝试创建自己的 HTML，并将其发送到 DB。**但我的问题是，你们中有人遇到过这个问题吗？你们是如何解决的？**

这个问题似乎仅仅因为 DB 就特定于 Web 开发。

我认为这个问题是一个通用问题，而不是真正特定于 git 或 Druapl，它更多的是带有 cms 问题的版本控制工作流。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T13:25:17.310

**请参阅simont**评论中的正确答案：

以下是评论中的链接：

1.  [http://drupal.org/node/956112](http://drupal.org/node/956112)
2.  [在 Drupal/CMS 项目上使用版本控制](https://stackoverflow.com/questions/2893774/working-with-version-control-on-a-drupal-cms-project)

# excel - Randbetween 只返回奇数

> ID：10606227
> 
> 赞同：1
> 
> 时间：2012-05-15T17:55:49.767
> 
> 标签：excel

我需要在 Excel 中的两个边界之间创建一个随机数列表。诀窍是数字必须是奇数。所以我不能只使用`randbetween()`. 我应该只使用类似`=if(a1 % 2 =0) then a1=a1+1`. 我不知道Excel中的语法，但我得到的是如果数字是偶数（mod 2 = 0）然后加一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:11:42.890

使用一个小技巧。[`CEILING`](http://office.microsoft.com/en-us/excel-help/ceiling-HP005209007.aspx)并[`FLOOR`](http://office.microsoft.com/en-us/excel-help/floor-HP005209094.aspx)有第二个参数，这是您需要的。

```
=CEILING(RANDBETWEEN(...),2)-1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:00:33.833

您可以获得具有不同范围的随机数*n*，并为您的单元格值计算 2* *n* +1。我假设下限为 0（或 1），因此您的新范围也从 0 开始（如果不是，请参阅如何计算上限）。对于上限，如果您希望*m*作为最大奇数，那么您的上限是 (显然) `(m-1)/2`。

例如，假设您想要 15 到 27 之间的奇数。您的 randbetween 下限为`(15-1)/2 = 7`，上限为`(27-1)/2 = 13`。因此，单元格公式将为`=2*randbetween(7, 13)+1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:33:20.200

您也可以在此处使用 RAND() 以与早期的 excel 版本兼容，通常此公式将为您提供均匀分布，假设 C2 包含下限，D2 包含上限（均为奇数）

`=INT(RAND()*((D$2-C$2)/2+1))*2+C$2`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:27:27.143

我知道我在比赛中迟到了，但这不是那么简单。

```
A1 = randbetween(0,100)
B1 = if(mod(A1,2)=0,A1+1,A1) 
```

# java - 字符串的 Jdbctemplate 查询：EmptyResultDataAccessException：不正确的结果大小：预期为 1，实际为 0

> ID：10606229
> 
> 赞同：119
> 
> 时间：2012-05-15T17:55:57.640
> 
> 标签：java, spring, jdbctemplate

我正在使用 Jdbctemplate 从数据库中检索单个字符串值。这是我的方法。

```
 public String test() {
        String cert=null;
        String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN 
             where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
        cert = (String) jdbc.queryForObject(sql, String.class); 
        return cert;
    } 
```

在我的场景中，我的查询完全可能不会受到影响，所以我的问题是如何绕过以下错误消息。

```
EmptyResultDataAccessException: Incorrect result size: expected 1, actual 0 
```

在我看来，我应该只返回一个 null 而不是抛出异常。我怎样才能解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2012-05-16T05:46:11.900

在 JdbcTemplate , `queryForInt`, 中`queryForLong`，`queryForObject`所有此类方法都期望执行的查询将返回一行且仅返回一行。如果您没有得到任何行或多于一行，则会导致`IncorrectResultSizeDataAccessException`. 现在正确的方法不是捕获这个异常`EmptyResultDataAccessException`，而是确保您使用的查询应该只返回一行。如果根本不可能，请改用`query`方法。

```
List<String> strLst = getJdbcTemplate().query(sql, new RowMapper<String>() {
    public String mapRow(ResultSet rs, int rowNum) throws SQLException {
        return rs.getString(1);
    }
});

if (strLst.isEmpty()) {
    return null;
} else if (strLst.size() == 1) { // list contains exactly 1 element
    return strLst.get(0);
} else { // list contains more than 1 element
         // either return 1st element or throw an exception
} 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-05-06T00:44:53.430

您也可以使用 a[`ResultSetExtractor`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/ResultSetExtractor.html)而不是 a [`RowMapper`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/RowMapper.html)。两者都一样简单，唯一的区别是你调用[`ResultSet.next()`](https://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html#next--).

```
public String test() {
    String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN "
                 + " where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
    return jdbc.query(sql, new ResultSetExtractor<String>() {
        @Override
        public String extractData(ResultSet rs) throws SQLException,
                                                       DataAccessException {
            return rs.next() ? rs.getString("ID_NMB_SRZ") : null;
        }
    });
} 
```

额外的[`ResultSetExtractor`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/ResultSetExtractor.html)好处是您可以处理所有有超过一行或没有返回行的情况。

**更新**：几年过去了，我有一些技巧可以分享。[`JdbcTemplate`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html)与以下示例设计的 java 8 lambda 一起使用非常好，但您可以很容易地使用静态类来实现相同的目的。

虽然问题是关于简单类型的，但这些示例可作为提取域对象的常见情况的指南。

首先关。为简单起见，假设您有一个具有两个属性的帐户对象`Account(Long id, String name)`。您可能希望`RowMapper`为此域对象提供一个。

```
private static final RowMapper<Account> MAPPER_ACCOUNT =
        (rs, i) -> new Account(rs.getLong("ID"),
                               rs.getString("NAME")); 
```

您现在可以直接在方法中使用此映射器来映射`Account`来自查询的域对象（`jt`是一个`JdbcTemplate`实例）。

```
public List<Account> getAccounts() {
    return jt.query(SELECT_ACCOUNT, MAPPER_ACCOUNT);
} 
```

太好了，但现在我们想要我们原来的问题，我们使用我原来的解决方案重用[`RowMapper`](http://[%60RowMapper%60][2])为我们执行映射。

```
public Account getAccount(long id) {
    return jt.query(
            SELECT_ACCOUNT,
            rs -> rs.next() ? MAPPER_ACCOUNT.mapRow(rs, 1) : null,
            id);
} 
```

太好了，但这是您可能并且希望重复的模式。因此，您可以创建一个通用工厂方法来[`ResultSetExtractor`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/ResultSetExtractor.html)为任务创建一个新方法。

```
public static <T> ResultSetExtractor singletonExtractor(
        RowMapper<? extends T> mapper) {
    return rs -> rs.next() ? mapper.mapRow(rs, 1) : null;
} 
```

创建[`ResultSetExtractor`](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/ResultSetExtractor.html)现在变得微不足道。

```
private static final ResultSetExtractor<Account> EXTRACTOR_ACCOUNT =
        singletonExtractor(MAPPER_ACCOUNT);

public Account getAccount(long id) {
    return jt.query(SELECT_ACCOUNT, EXTRACTOR_ACCOUNT, id);
} 
```

我希望这有助于表明您现在可以很容易地以一种强大的方式组合各个部分，从而使您的域更简单。

**更新 2** ：与可选值而不是 null的[Optional](https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html)结合使用。

```
public static <T> ResultSetExtractor<Optional<T>> singletonOptionalExtractor(
        RowMapper<? extends T> mapper) {
    return rs -> rs.next() ? Optional.of(mapper.mapRow(rs, 1)) : Optional.empty();
} 
```

现在使用时可能具有以下内容：

```
private static final ResultSetExtractor<Optional<Double>> EXTRACTOR_DISCOUNT =
        singletonOptionalExtractor(MAPPER_DISCOUNT);

public double getDiscount(long accountId) {
    return jt.query(SELECT_DISCOUNT, EXTRACTOR_DISCOUNT, accountId)
            .orElse(0.0);
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-05-15T20:07:26.293

这不是一个好的解决方案，因为您依赖于控制流的异常。在您的解决方案中，出现异常是正常的，将它们放在日志中是正常的。

```
public String test() {
    String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
    List<String> certs = jdbc.queryForList(sql, String.class); 
    if (certs.isEmpty()) {
        return null;
    } else {
        return certs.get(0);
    }
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-05-15T18:11:58.257

好的，我想通了。我只是将它包装在 try catch 中并返回 null。

```
 public String test() {
            String cert=null;
            String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN 
                     where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
            try {
                Object o = (String) jdbc.queryForObject(sql, String.class);
                cert = (String) o;
            } catch (EmptyResultDataAccessException e) {
                e.printStackTrace();
            }
            return cert;
    } 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-02-25T05:46:16.140

由于在没有数据时返回 null 是我在使用 queryForObject 时经常要做的事情，我发现扩展 JdbcTemplate 并添加类似于下面的 queryForNullableObject 方法很有用。

```
public class JdbcTemplateExtended extends JdbcTemplate {

    public JdbcTemplateExtended(DataSource datasource){
        super(datasource);
    }

    public <T> T queryForNullableObject(String sql, RowMapper<T> rowMapper) throws DataAccessException {
        List<T> results = query(sql, rowMapper);

        if (results == null || results.isEmpty()) {
            return null;
        }
        else if (results.size() > 1) {
            throw new IncorrectResultSizeDataAccessException(1, results.size());
        }
        else{
            return results.iterator().next();
        }
    }

    public <T> T queryForNullableObject(String sql, Class<T> requiredType) throws DataAccessException {
        return queryForObject(sql, getSingleColumnRowMapper(requiredType));
    }

} 
```

您现在可以像使用 queryForObject 一样在代码中使用它

```
String result = queryForNullableObject(queryString, String.class); 
```

我很想知道是否有人认为这是个好主意？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-07-12T08:54:06.637

实际上，您可以`JdbcTemplate`根据自己的喜好使用和自定义自己的方法。我的建议是做这样的事情：

```
public String test() {
    String cert = null;
    String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN
        where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
    ArrayList<String> certList = (ArrayList<String>) jdbc.query(
        sql, new RowMapperResultSetExtractor(new UserMapper()));
    cert =  DataAccessUtils.singleResult(certList);

    return cert;
} 
```

它与原版一样工作`jdbc.queryForObject`，但没有`throw new EmptyResultDataAccessException`when `size == 0`。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-08-26T18:22:50.067

使用 Java 8 或更高版本可以使用[`Optional`](https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html)和 Java Streams。

因此，您可以简单地使用该`JdbcTemplate.queryForList()`方法，创建一个 Stream 并使用[`Stream.findFirst()`](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html#findFirst--)它将返回 Stream 的第一个值或空`Optional`：

```
public Optional<String> test() {
    String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
    return jdbc.queryForList(sql, String.class)
            .stream().findFirst();
} 
```

为了提高查询的性能，您可以附加`LIMIT 1`到查询中，因此从数据库中传输的项目不超过 1 个。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-18T14:34:37.917

您可以使用组函数，以便您的查询始终返回结果。IE

```
MIN(ID_NMB_SRZ) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-21T05:01:40.840

由于 getJdbcTemplate().queryForMap 期望最小大小为 1，但是当它返回 null 时，它显示 EmptyResultDataAccesso 修复 dis 何时可以使用以下逻辑

```
Map<String, String> loginMap =null;
try{
    loginMap = getJdbcTemplate().queryForMap(sql, new Object[] {CustomerLogInInfo.getCustLogInEmail()});
}
catch(EmptyResultDataAccessException ex){
    System.out.println("Exception.......");
    loginMap =null;
}
if(loginMap==null || loginMap.isEmpty()){
    return null;
}
else{
    return loginMap;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-09-22T08:33:14.683

你可以这样做：

```
String cert = DataAccessUtils.singleResult(
    jdbcTemplate.queryForList(
        "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN where ID_STR_RT = :id_str_rt and ID_NMB_SRZ = :id_nmb_srz",
        new MapSqlParameterSource()
            .addValue("id_str_rt", "999")
            .addValue("id_nmb_srz", "60230009999999"),
        String.class
    )
) 
```

**DataAccessUtils.singleResult** + **queryForList**：

*   为空结果返回 null
*   如果恰好找到 1 行，则返回单个结果
*   如果找到超过 1 行，则抛出异常。主键/唯一索引搜索不应发生

[DataAccessUtils.singleResult](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/dao/support/DataAccessUtils.html#singleResult-java.util.Collection-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-07-05T04:43:10.067

在 Postgres 中，您几乎可以通过包装让任何单值查询返回一个值或 null：

```
SELECT (SELECT <query>) AS value 
```

从而避免调用者的复杂性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-11-07T07:26:32.417

我们可以使用 query 代替 queryForObject，query 和 queryForObject 的主要区别在于查询返回的对象列表（基于 Row 映射器返回类型），如果没有从数据库接收到数据，则该列表可以为空，而 queryForObject 总是期望只有单个对象从 db 获取的既不是 null 也不是多行，如果结果为空，那么 queryForObject 会抛出 EmptyResultDataAccessException，我编写了一个使用查询的代码，该代码将在 null 结果的情况下克服 EmptyResultDataAccessException 的问题。

> ```
> ----------
> 
> public UserInfo getUserInfo(String username, String password) {
>       String sql = "SELECT firstname, lastname,address,city FROM users WHERE id=? and pass=?";
>       List<UserInfo> userInfoList = jdbcTemplate.query(sql, new Object[] { username, password },
>               new RowMapper<UserInfo>() {
>                   public UserInfo mapRow(ResultSet rs, int rowNum) throws SQLException {
>                       UserInfo user = new UserInfo();
>                       user.setFirstName(rs.getString("firstname"));
>                       user.setLastName(rs.getString("lastname"));
>                       user.setAddress(rs.getString("address"));
>                       user.setCity(rs.getString("city"));
> 
>                       return user;
>                   }
>               });
> 
>       if (userInfoList.isEmpty()) {
>           return null;
>       } else {
>           return userInfoList.get(0);
>       }
>   } 
> ```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-25T18:28:02.813

我之前处理过这个问题，并在春季论坛上发布过。

[http://forum.spring.io/forum/spring-projects/data/123129-frustrated-with-emptyresultdataaccessexception](http://forum.spring.io/forum/spring-projects/data/123129-frustrated-with-emptyresultdataaccessexception)

我们收到的建议是使用一种 SQlQuery。这是我们在尝试从可能不存在的数据库中获取值时所做的示例。

```
@Component
public class FindID extends MappingSqlQuery<Long> {

        @Autowired
        public void setDataSource(DataSource dataSource) {

                String sql = "Select id from address where id = ?";

                super.setDataSource(dataSource);

                super.declareParameter(new SqlParameter(Types.VARCHAR));

                super.setSql(sql);

                compile();
        }

        @Override
        protected Long mapRow(ResultSet rs, int rowNum) throws SQLException {
                return rs.getLong(1);
        } 
```

在 DAO 中，我们只需调用...

```
Long id = findID.findObject(id); 
```

性能不清楚，但它可以工作并且很整洁。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-08-07T05:18:57.313

对于拜伦，你可以试试这个..

```
public String test(){
                String sql = "select ID_NMB_SRZ from codb_owner.TR_LTM_SLS_RTN 
                     where id_str_rt = '999' and ID_NMB_SRZ = '60230009999999'";
                List<String> li = jdbcTemplate.queryForList(sql,String.class);
                return li.get(0).toString();
        } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-08-19T13:45:14.263

使

```
 jdbcTemplate.queryForList(sql, String.class) 
```

工作，确保你的 jdbcTemplate 是类型

```
 org.springframework.jdbc.core.JdbcTemplate 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-01-21T18:13:59.567

恕我直言，返回 a`null`是一个糟糕的解决方案，因为现在您遇到了在（可能的）前端客户端发送和解释它的问题。我有同样的错误，我通过简单地返回一个`List<FooObject>`. 我用过`JDBCTemplate.query()`。

在前端（Angular Web 客户端），我只检查列表，如果它为空（长度为零），则将其视为未找到记录。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-01T15:52:09.663

我在使用时遇到了同样的异常

```
if(jdbcTemplate.queryForMap("select * from table").size() > 0 ) /* resulted exception */ 
```

当更改为列出时，它已解决

```
if(jdbcTemplate.queryForList("select * from table").size() > 0) /* no exception */ 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-11-16T13:39:10.420

我只是抓住了这个“EmptyResultDataAccessException”

```
public Myclass findOne(String id){
    try {
        Myclass m = this.jdbcTemplate.queryForObject(
                "SELECT * FROM tb_t WHERE id = ?",
                new Object[]{id},
                new RowMapper<Myclass>() {
                    public Myclass mapRow(ResultSet rs, int rowNum) throws SQLException {
                        Myclass m = new Myclass();
                        m.setName(rs.getString("name"));
                        return m;
                    }
                });
        return m;
    } catch (EmptyResultDataAccessException e) { // result.size() == 0;
        return null;
    }
} 
```

然后你可以检查：

```
if(m == null){
    // insert operation.
}else{
    // update operation.
} 
```

# php - PHP 的那部分 html/text 用 start/end 函数关闭的特性是什么？

> ID：10606232
> 
> 赞同：0
> 
> 时间：2012-05-15T17:56:04.023
> 
> 标签：php

你有什么 PHP 的特性，比如说一段“开始”代码，然后是一些通常会发送到浏览器的 html 或文本，然后是一段代码来“结束”它？

例如，

```
<? start_something(); ?>

<html>some html</html>

<? end_something(); ?> 
```

是的，这是 php 的内置功能，我很确定，但我不记得它叫什么了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T17:59:11.543

缓冲？

```
ob_start();

//do some code

ob_flush(); //sends current code to browser

//do something else

ob_end_flush(); //or ob_end_clean() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T17:59:31.230

通常，这就是有多少网站在其网页上应用通用页眉和页脚。通过将它们分成单独的文件并将它们包含在每个页面中，他们可以轻松地保持其网站的一致外观和感觉，同时使维护变得容易，因为他们只需要更新一两个文件即可更改整个网站的外观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T17:59:37.533

[输出缓冲](http://php.net/manual/en/book.outcontrol.php)？

```
<? ob_start(); ?>

<html>some html</html>

<? ob_end_flush(); ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:00:00.447

查看[print()的 PHP 文档](http://php.net/manual/en/function.print.php)

```
print <<<END
This uses the "here document" syntax to output
multiple lines with $variable interpolation. Note
that the here document terminator must appear on a
line with just a semicolon no extra whitespace!
END; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T18:02:07.910

很确定您在询问输出缓冲，如其他答案中所述

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-15T18:02:50.530

这是你需要的：http: [//php.net/manual/en/control-structures.alternative-syntax.php](http://php.net/manual/en/control-structures.alternative-syntax.php)

# java - 使用多线程，无法在 webdriver 中启动多个 IE 实例

> ID：10606233
> 
> 赞同：0
> 
> 时间：2012-05-15T17:56:06.923
> 
> 标签：java, selenium, webdriver, testng

使用 selenium webdriver。我必须在 IE 上运行 10 个或更多自动化测试用例实例。我尝试将 Grid2 与 Webdriver 一起使用，但如果我在同一台机器上执行，网格只会一个接一个地启动 IE 实例。单独使用 testNG（没有网格）也给出了相同的结果。为了解决这个问题，我正在处理测试用例并从驱动程序脚本中调用多个线程。这在 Firefox 中运行良好，但在 IE 中不行。在 IE 的情况下，如果我尝试调用两个以上的实例（不管有多少），只会调用一个实例。

以前有人遇到过类似的问题吗？请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:24:30.283

这是因为默认情况下，链接到 Sel Grid 2 集线器的节点仅启动一个 1 个 IE 实例，而它启动 5 个 Firefox 和 Chrome 实例。

使用更多 IE 实例以不同方式启动您的节点。你可以使用类似的东西

```
java -jar selenium-server-standalone-2.21.0.jar -port 4445 -role node -hub http://yourhub:4444/grid/register -browser browserName="internet explorer",platform=WINDOWS,maxInstances=5 
```

您可以在此 URL 检查每个节点的浏览器实例数

```
http://yourhubserver.com:4444/grid/console 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T11:08:34.550

可以使用 Selenium Grid2 启动的 IE 实例的默认数量仅为“1”。要运行多个实例，您可以执行以下操作：

```
java -jar selenium-server-standalone-2.28.0.jar -role wd -browser "browserName=internet explorer,version=8,maxInstances=5,platform=WINDOWS" -hub http://localhost:4444/grid/register 
```

# svn - Perforce 项目的颠覆

> ID：10606234
> 
> 赞同：1
> 
> 时间：2012-05-15T14:10:05.123
> 
> 标签：svn, visual-studio-2010, perforce

我有一个项目目前在 Perforce 存储库中。不幸的是，由于一些测试限制，我有一台测试机器（类似于 linux 的私有构建），无论出于何种原因，它都不能运行 Perforce，但能够运行颠覆。是否有可能，或者一个好主意，在它仍然绑定到 Perforce 的同时将所有内容加载到 subversion 中？

这是一个 VS2010 项目，我知道 VS2010 会看到 Perforce 拥有的源代码控制绑定。将其放入颠覆中会搞砸吗？

是的，我知道为了测试我所要做的就是复制编译的构建，但是我们也在考虑即时进行更改，所以我们也想在目标机器上进行一些代码编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:37:00.153

我首先要说的是，您不需要第二个源代码控制系统来将文件从一个系统移动到另一个系统。使用 RSync 将文件从一台运行 p4 的计算机移动到另一台计算机不是更好吗？

如果我要硬装一个使用两个版本控制系统的解决方案，那么我会使用 Git 而不是 SVN，因为 SVN 会在你的子文件夹中乱扔 .svn 文件，这可能会污染你的 Perforce 存储库。如果您使用 Git，您可以更轻松地覆盖两个存储库，而问题最少。最后，如果您不使用 SVN 中的版本控制，那么随着时间的推移，您将遇到其他问题，例如 repo 慢慢填满和删除 .svn 文件。

我实际上将 git 与 Perforce 一起使用，其中所有二进制文件都存储在 Perforce 中，以便我们可以“锁定”文件。一旦艺术家将文件签入到 Perforce 我们的 Jenkins 的 CI 服务器看到更新，它会获取 P4 中的最新资产，复制签入说明，然后将资产提交到 GIT 和“艺术”分支。然后开发人员将“艺术”分支合并到主分支或特定功能分支中。这也是降低成本的好方法，因为您只需要足够的 P4 座位供艺术家和 Jenkins 盒子使用，开发人员都可以使用免费的 GIT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:24:15.077

那不是我的方法。是否可以在具有 perforce 的机器和这台机器之间共享驱动器或网络位置？另一种方法是联系 perforce 支持，看看他们是否无法为您提供工作的 p4 二进制文件。

将源代码控制绑定添加到 svn 不应该把它们搞砸，但我从未尝试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T15:57:50.977

您可以找到大多数 Linux 变体的 Perforce 二进制文件。如果这不可行，您可以使用 rsync 之类的东西来回传输构建和补丁（您在构建框中的本地更改）。

如果您需要一个版本管理系统并且 P4 不可用，那么 git 可能是一个更好的选择。您可以通过sneaker net 传输git repo，并且有一个git-p4 连接器可用于将更改重播到Perforce。Perforce 也在开发更好的连接器，但要到今年晚些时候才会推出。

# programming-languages - 在你的机器上“安装”一种语言是什么意思？

> ID：10606235
> 
> 赞同：2
> 
> 时间：2012-05-15T17:56:14.677
> 
> 标签：programming-languages, installation

所以我从几种语言开始，并且有一些 php 和 JavaScript 知识，但我一直只使用 php 和 WP。我开始学习 python 和 php（关闭 Wordpress），我到处读到的第一件事就是在你的机器上“安装”python 以使用它。

我已经直接从 python.org 安装了 python 启动器，但不确定它到底做了什么或它的用途。这是一个非常基本的问题，但是在您的计算机上安装 python 或 php 等以开发该语言意味着什么？

提前感谢女士们和先生们！

**更新：**我想我现在明白了！谢谢大家的详细回复和帮助！非常感谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T17:59:26.723

“安装”一种语言可能意味着不同的东西。通常，您必须为编译语言或解释语言（如 Java）下载[编译器，您还需要一个](http://en.wikipedia.org/wiki/Compiler)[解释器](http://en.wikipedia.org/wiki/Interpreter_%28computing%29)（Java 虚拟机）。这些通常可以预先打包在[IDE](http://en.wikipedia.org/wiki/Integrated_development_environment)或编辑器中，允许您编写代码。

如果这些术语让您感到困惑，我建议您阅读一下编程语言的编译（转换为字节码）。它将帮助您更好地理解您编写的高级语言是如何输入计算机的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:02:16.177

我可以看到它有点令人困惑，因为“Python”可能意味着 2 个不同的东西，具体取决于上下文。如果您谈论的是语言，“Python”是语言规范中定义的一组命令。但是，“Python”也可以是“Python 解释器、核心库和其他工具”的简写。当人们谈论“安装 Python”时，他们的意思是在系统上安装这些组件。这些组件允许您实际运行 Python 代码。否则，它只是文件中的一堆文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:55:04.103

编程语言由几个组件组成：

*   **语言定义**——通常是描述语言语法和语义的文档
*   **语言实现**——以该语言执行语句并产生输出的程序，通常是编译器和运行时库或解释器。
*   **语言库**——具有通用功能的辅助模块

安装“语言”意味着安装该语言的实现。这意味着安装编译器或解释器，以及最常见的库。安装后，您可以在本地机器上以该语言编写和执行程序。

这适用于所有语言——除非您的操作系统管理器（通常是 C；Ruby；Objective C）或 Web 浏览器（对于 JavaScript）已经为您安装了实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T18:04:08.447

简单来说 - 这意味着下载适合您的操作系统的语言解释器。解释器是理解您编写的代码并执行它的程序。

在 Python 的情况下，它更简单，因为 osx 和 Linux 都将 Python 作为其默认安装的一部分。

对于 Windows，您应该下载Python的[官方 Windows 安装程序。](http://www.python.org/download/)安装它就像安装任何其他 Windows 程序一样。

同样，对于 PHP，您可以下载[Windows 的官方安装程序](http://windows.php.net/download/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T18:52:32.710

当您在 Web 主机上使用 PHP 时，他们已经安装了两个程序：

*   网络服务器（例如 Apache）
*   一个php解释器

Web 服务器会收到一个请求，要求 PHP 执行一个程序。该程序是您编写的php页面。PHP 解释器执行程序，该程序产生一个输出，然后由 Web 服务器发送回客户端。

当您在自己的计算机上开发程序时，设置是不同的。

首先，除了 web 开发，你不会在你的机器上运行一个 web 服务器来告诉解释器运行你的程序，你必须自己运行解释器。

通常，您在 Windows 上使用命令行 shell（例如 cmd.exe）。

```
C:>python script.py 
```

当 cmd.exe 执行此命令时，它会查找程序“python.exe”并告诉它运行您的程序“script.py”。默认情况下，script.py 的输出被发送到 cmd.exe，然后它只会在其窗口中显示它。

为了成功，你的计算机上必须安装一个 python.exe，所以首先你必须安装一个名为 python 解释器的程序“python.exe”。

这是关于如何在你的机器上*运行*你的 python 程序的故事。开发还涉及*编写*脚本。

要编写您的程序“script.py”，理论上您可以在 Windows 上使用简单的文本编辑器（如记事本），然后如上所述执行脚本。但这即使对于非常短的程序也不方便。

幸运的是，当您安装 Python 解释器时，它还会安装一些额外的程序，其中一个是 IDLE，它是 Python 程序的编辑器，足以编写简单的 Python 程序。为了您的方便，IDLE 还可以直接告诉 python.exe 运行您的 sript，而无需您在 cmd.exe 中键入命令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-15T17:59:05.160

根据我的经验，Python 这种语言实际上与使用它开发的编译器相关联。我安装了它，它带有一个控制台和 GUI 来执行脚本。对于 PHP，我知道 PHP 有一个控制台，当您安装服务器时安装了它，您可以访问和更改 PHP 配置设置。希望这个对你有帮助。

# google-maps - 为什么谷歌地图显示在左边？

> ID：10606236
> 
> 赞同：0
> 
> 时间：2012-05-15T17:56:19.453
> 
> 标签：google-maps

我将自动生成的谷歌地图放在为客户制作的目录中。（演示：[http](http://sudburyhomebuilders.com/directory/a-j-home-hardware/) ://sudburyhomebuilders.com/directory/aj-home-hardware/ ）当您单击“查找我们”时，它会填充地图，将图钉放置在正确的位置，但视口已经到了正确的。您必须缩小并移动地图才能看到位置。有没有人对导致这种情况的原因有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:03:24.780

填充地图后，将标记的坐标传递给地图 setCenter 方法，如下所示：

```
mapObject.setCenter(latLongObject); 
```

# android - 如何从另一个类访问共享首选项布尔值

> ID：10606237
> 
> 赞同：2
> 
> 时间：2012-05-15T17:56:20.463
> 
> 标签：android, sharedpreferences

我创建了一个包含两个按钮的单选组，我可以选择一个并保存它，它工作正常，关闭应用程序后仍然存储。我想要做的是使用另一个类中单选按钮的值。这是我的设置类，其中包含共享首选项代码：

```
public class Settings extends Activity {
private String settingsTAG = "AppNameSettings";
private SharedPreferences prefs;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    setContentView(R.layout.settings);
    prefs = getSharedPreferences(settingsTAG, 0);

    final RadioButton rb0 = (RadioButton) findViewById(R.id.radioInternetYes);
    final RadioButton rb1 = (RadioButton) findViewById(R.id.radioInternetNo);

    rb0.setChecked(prefs.getBoolean("rb0", true));
    rb1.setChecked(prefs.getBoolean("rb1", false));     
    Button btnSave = (Button) findViewById(R.id.btnSave);

    btnSave.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            prefs = getSharedPreferences(settingsTAG, 0);
            Editor editor = prefs.edit();

            editor.putBoolean("rb0", rb0.isChecked());
            editor.putBoolean("rb1", rb1.isChecked());
            editor.commit();

            finish();

        }
    } );

} 
```

在另一个类中，我试图在单击按钮时检查 rb0 是真还是假：

```
share.setOnClickListener(new View.OnClickListener(){

        public void onClick(View v) {
            if(rb0 = true){
            Intent i = new Intent(Intent.ACTION_SEND);

            i.setType("text/plain");

            i.putExtra(Intent.EXTRA_EMAIL  , new String[]{""});

            i.putExtra(Intent.EXTRA_SUBJECT, "Check out my awesome score!");
            i.putExtra(Intent.EXTRA_TEXT   , "I am playing this awesome game called Tap the Button, and I just scored the incredible highscore of " +s+ " Taps!!\n\nCan you beat it!?");
            try {
                startActivity(Intent.createChooser(i, "Send mail..."));
            } catch (android.content.ActivityNotFoundException ex) {
                Toast.makeText(FailScreen.this, "There are no email clients installed.", Toast.LENGTH_SHORT).show();
            }
        }
            else{
                //Display warning that rb0 is false
            }
                }
    }); 
```

我已经研究了 Stackoverflow 和开发人员文档，但我似乎无法找出如何做到这一点，任何建议都值得赞赏。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:00:21.607

您需要再次访问 SharedPreferences而不是`if(rb0 = true)`（无论如何都应该如此）。`==`引自[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)：

> 要读取值，请使用 SharedPreferences 方法，例如 getBoolean() 和 getString()。

所以你会使用类似的东西：

```
String settingsTAG = "AppNameSettings";
SharedPreferences prefs = getSharedPreferences(settingsTAG, 0);
boolean rb0 = prefs.getBoolean("rb0", false);
if(rb0 == true){ 
    // Do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-23T19:06:58.837

您还可以使用：

```
SharedPreferences sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);
sharedPreferences.getBoolean("myKey", false) 
```

# sqlite - 重新创建 SVN wc.db

> ID：10606243
> 
> 赞同：2
> 
> 时间：2012-05-15T17:57:01.497
> 
> 标签：sqlite, svn, version-control

我们的一些开发团队的工作副本出现问题，并且 wc.db 数据库似乎已损坏。有没有一种快速的方法来修复或重建数据库而不是重新结帐？

我收到的错误消息是 **"no such table: wcroot"**，操作系统是 Windows 7 并使用[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN) 1.7.6。

即使这是一个特定的错误，当 SQLite 数据库损坏时，除了进行完整的检查之外，最好的选择是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-11T07:25:38.813

很简单，降级。

将所有元数据放入 SQLite 数据库绝对没有逻辑；Subversion 开发人员并不那么聪明。以前，您的结帐中都有 .svn 文件……一个 .svn 文件夹被搞砸了；它偶尔会发生。很简单：重命名，再次检查，合并本地更改——使用 Subversion 1.7 的解决方案是“请再次检查 10G”。

如果你有一个像我一样的大项目（超过 10 GB），并且你负担不起每月检查所有内容的费用，请降级 Subversion。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T17:11:48.920

[SmartSVN](https://www.smartsvn.com/)提出了一种修复某些类型或 wc.db 损坏的工具（修改|验证管理区域），从存储库中检索丢失/不正确的信息。我不确定它是否会有所帮助，但请尝试一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-11T08:07:30.827

在不知道问题是什么的情况下，很难诊断。最简单的方法是执行新的签出（然后复制或合并任何本地更改）。

[这里列出](http://subversion.1072662.n5.nabble.com/WC-database-corruption-1-7-1-td142807.html)了一些您可以尝试的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-11T06:24:43.203

我遇到了同样的问题，原因是我的机器没有存储空间。释放一些空间后，它们的问题就消失了。

# jquery - jQuery，编辑内联样式标签

> ID：10606244
> 
> 赞同：2
> 
> 时间：2012-05-15T17:57:09.717
> 
> 标签：jquery, tags, styles

我遇到了一些 css+javascript 的问题。你看，我正在尝试制作某种所见即所得的网页样式编辑器，其中有一个 iframe，它加载包含此类代码的网页。

```
<head>
<style id=mystyle>
  /* something is here */
</style>
</head>
<body>
  <h1>Other, quite a lot autogenerated stuff along with javascript that add some interactivity.</h1>
</body> 
```

现在，我需要修改#mystyle 的内容，使其实时反映到页面。使用 jquery，我尝试使用几种技术来做到这一点，例如：

1.  `$(#mystyle).html(newcss);`
2.  `$(#mystyle).replaceWith("<style id='mystyle'>"+newcss+"</style>")`
3.  `$(#mystyle).after("the newcss along with style tag")`，然后删除旧的。
4.  `$(#mystyle).delete()`//只是想看看会发生什么。

以上所有都未能改变网页的外观。事实上，删除标签 (4.) 并没有使页面变得丑陋，我确实使用“检查元素”进行了检查，html 确实发生了变化，但外观没有。所以....我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:31:32.223

using`html`似乎工作得很好。看：

[http://jsfiddle.net/tGSkS/](http://jsfiddle.net/tGSkS/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:02:15.583

如果您想在页面加载时设置特定元素的样式，则可以执行以下操作

```
$(function(){

  $('element-selector').css({
     style1:'value',
     style2:'value',
     style2:'value',
   });  

}); 
```

或在服务器上，有条件地呈现或动态构建您的样式表。

# ruby - airbrake notify_airbrake 方法在控制器中不起作用

> ID：10606245
> 
> 赞同：3
> 
> 时间：2012-05-15T17:57:15.147
> 
> 标签：ruby, ruby-on-rails-3, exception, airbrake

在空气制动控制器中，此代码有效（提供通知）救援 => 前 Airbrake.notify 但

```
rescue => ex
    notify_airbrake(ex)
end 
```

不提供任何空气制动通知。如何使 notify_airbrake(ex) 工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T12:20:38.983

您可能正在开发环境中对其进行测试。将此添加到您的`airbrake.rb`，它应该可以工作。

`config.development_environments = []`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T21:40:36.793

`notify_airbrake`忽略本地请求的实现。因此，如果您尝试在开发中使用此方法，那么您就不走运了。无论您在 Airbrake 配置中定义了什么。

所以你可以设置`consider_all_requests_local = false`，这不是你想要的。

相反，`airbrake_request_data`如果您不想自己选择参数，您可以使用它来获得相同的结果。

```
rescue => ex
  Airbrake.notify(ex, airbrake_request_data)
  redirect_to root_url
end 
```

希望这可以帮助！

# c - 像“case_GETOPT_HELP_CHAR”这样的宏有风险吗？

> ID：10606250
> 
> 赞同：1
> 
> 时间：2012-05-15T17:57:33.527
> 
> 标签：c, coding-style

我正在研究 coreutils 源代码以更好地编程，我在 base64.c 和其他代码中发现了这些行：

```
while ((opt = getopt_long (argc, argv, "diw:", long_options, NULL)) != -1)
switch (opt)
{
// ... other stuff
  case_GETOPT_HELP_CHAR; // <- this especially

  case_GETOPT_VERSION_CHAR (PROGRAM_NAME, AUTHORS);
// .. other stuff again 
```

我不知道这到底是什么意思，直到我在 system.h 中找到了这个：

```
#define case_GETOPT_HELP_CHAR           \
 case GETOPT_HELP_CHAR:         \
 usage (EXIT_SUCCESS);          \
 break; 
```

我不知道您实际上可以制作包含这么多语句的宏！在宏中使用这么多语句是不是很冒险，或者这是我应该学习的一种很好的编码风格？

编辑：我还注意到 coreutils 中实际上使用了很多 MACROS。这让我有点困惑，因为我来自 C++ 背景。

```
#define STREQ(a, b) (strcmp (a, b) == 0) 
```

比如上面这个，真的有必要吗？它使阅读代码变得更加困难，并且仅在 inf 语句中执行 STREQ 并没有节省多少

EDIT2：另一方面，我非常喜欢这个，感谢杰伊：

```
 #define COMMAND(NAME)  { #NAME, NAME ## _command }

 struct command commands[] =
 {
   COMMAND (quit),
   COMMAND (help),
   ...
 }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:04:08.417

只要编写正确，使用这样的宏就没有风险（如果不是，可能会导致编译错误或意外行为）。但是，除非您需要它们，否则请避免使用它们——它们往往会使代码难以阅读。

例如，宏`#define foo() bar(); bar`会很危险，因为`if(...) foo();`最终`bar()`总是会被调用（在这种情况下，您会将宏代码包装在 a 中`do{ ... }while(0)`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:14:42.327

这取决于。如果宏大大减少了代码大小，或者使在一个地方修改东西变得相当容易，那么无论如何，去吧，即使它有时在代码诗人的眼中看起来很丑。

在特定情况下，我持怀疑态度。首先，宏以分号结尾，宏的用法也是如此，因此扩展以分号结尾，其中一个是空语句。一些 lints 对这些发出警告。在多语句宏之后强制使用分号的规范方法是

```
#define FOO(x) do { statement(x); stmnt; } while (0) 
```

但在这种情况下，由于`case`. （意外的双关语，呵呵）。

其次，我不确定这个宏是否真的在某处被重用。如果不是，那么我认为它比优雅的hackery 更多的是代码混淆。另一方面，它看起来`system.h`也包含在其他实用程序中，并且在许多 coreutils 实用程序之间保持一致性是有一点意义的，例如，始终使用相同的选项 char 表示“帮助”、“详细”等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:02:10.250

这没有风险，也没有任何问题。

请阅读[此处](http://gcc.gnu.org/onlinedocs/cpp/Macros.html)并使用 Google 了解有关宏的更多信息。一旦您对宏有了一些了解，您将能够决定何时使用什么。

还要检查这个 stackoverflow[链接](https://stackoverflow.com/questions/321143/good-programming-practices-for-macro-definitions-define-in-c)。:) 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:46:48.503

快速阅读答案会告诉您，这是一个偏好问题。有些人喜欢，有些人不喜欢。
我不。

我的主要问题是使用它的代码并不是真正的 C 代码。所以当你读了它，你知道了C，你仍然无法理解它。

如果使用不当，此类定义可能会导致奇怪且难以调试的问题。您查看代码，它看起来正确，但事实并非如此。该`case_GETOPT_HELP_CHAR`宏似乎不太容易出现此类错误。`case_GETOPT_VERSION_CHAR`，有参数，可能更危险。

`STREQ`是一个更好的宏。它使事情比`strcmp(a,b)==0`（我总是觉得这个令人困惑）更清楚一些。
根据经验，我更喜欢可能是函数的宏。如果你愿意，你可以实现`STREQ`为一个函数，但不是`case_GETOPT_HELP_CHAR`.

`COMMAND`是一个不同的故事。它有一些丑陋的地方，但有一个强有力的理由——它消除了重复。如果没有宏技巧，您将不得不重复两次命令名称。
另一方面，考虑看到这个`quit_command`函数并试图找到调用它的地方的可怜人。他可以在各个来源中搜索这个名字，但他不会找到它。

# c++ - 检测 C++ 模板问题的工具

> ID：10606251
> 
> 赞同：1
> 
> 时间：2012-05-15T17:57:34.133
> 
> 标签：c++, templates, g++, static-analysis

我最近花了一些时间在我的 C++ 模板中寻找一个错字。g++ 没有抱怨错字，所以我想知道将来是否有可以检查此类问题的工具？

这是一个演示正确编译的简化示例。我希望有人抱怨没有定义 struct dummy，但似乎模板化的类 goo 隐藏了这一点。

富.h：

```
struct smart {
    int x, y, z;
};

template<typename T> class goo
{
    void barf(T* ptr){}
};

template<typename T> class foo 
{
public:
    foo(){};
private:
    goo<T> x;
};

class bar: public foo<struct dummy>
{
public:
    void do_something(struct smart& thing){}
}; 
```

foo.cpp：

```
#include "foo.h"

int main()
{
    bar a;
    struct smart b;
    a.do_something(b);
    return b.x+b.y+b.z;
} 
```

使用 g++ foo.cpp 成功编译

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:06:17.303

设置为最高警告级别的**编译器**是检测任何 C++ 问题的最佳工具。

我给你的建议有两个：

1) 将编译器警告级别设置为最高级别。这将捕捉到许多较低级别可能保持沉默的错误。

2) 使用一种在你做错事时更容易产生编译器错误的编码风格。例如：

```
class bar: public foo<struct dummy>
{
public:
    void do_something(struct smart& thing){}
}; 
```

老实说，我不知道这段代码是否合法。我强烈怀疑不是，但看起来你正在声明一个新类型`struct dummy`。编译器接受它，所以我不确定它是否合法。

相反，您会得到很好的服务：

```
class bar: public foo<dummy>
{
public:
    void do_something(struct smart& thing){}
}; 
```

现在这永远不能被解析为新的类型声明，编译器将拒绝它。这会及早发现您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:02:55.197

如果您没有使用模板类型参数（在您的示例中就是这种情况），则代码是可以的，即使该类型不存在或者您正在调用未调用的成员函数中的类型的函数。这是以 C++ 的名义，如果你不使用它，你就不用为它付费（例如，没有创建新函数）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T18:12:14.430

这是因为您使用`struct dummy`编译器被告知如果没有这样的结构退出，则自动生成前向声明结构。如果你`dummy`不使用`struct`它就不会这样做，它会抱怨。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T19:21:00.100

[Attilla 做到](https://stackoverflow.com/a/10606339/11698)了这一点；的定义`dummy`是不需要的，因此它可以保持为不完整的类型。这是 C/C++ 的一个非常有用的特性，因为它有助于隐藏信息并减少编译时间。

例如：

```
// Afwd.h
class A;
A * getA ();
void processA(A *);
void printA (A *);

// t.cc
#include "Afwd.h"
void bar ()
{
  A * a = getA ();
  processA (a);
  printA (a);
} 
```

在这里，客户端无需`A`查看其实现细节。这还有一个优点是客户端不需要包含定义所需的标头`A`

为了`dummy`在原始示例中生成错误，必须在此翻译单元中使用该定义。

首先，`ptr`需要以需要完整类型的方式使用，例如通过取消引用：

```
template<typename T> class goo
{
public:
    void barf(T* ptr){
      *ptr;           
    }
}; 
```

这仍然不是问题，因为`barf`未调用该函数，因此未实例化：

```
template<typename T> class foo 
{
public:
    foo(){
      x.barf (0);
    };
private:
    goo<T> x;
}; 
```

此代码现在生成错误。实例化和调用的构造函数`bar`定义了`foo`实例化和调用`barf`。

# sqlite - SQLite 中的聚合函数

> ID：10606253
> 
> 赞同：0
> 
> 时间：2012-05-15T17:57:37.613
> 
> 标签：sqlite, aggregate-functions

如果我有一个包含一列文本和一列整数的表，我如何对每个文本条目特定的整数求和？例子：

```
text1 | 4
text2 | 2
text3 | 5
text2 | 3
text1 | 2 
```

我想做：SELECT Text,SUM(Number) FROM TABLE

但是，这会将所有数字加在一起（text1 | 16）。如何独立地将每个文本条目的数字相加？（ text1 | 6 text2 | 5 text3 | 5 ）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:01:02.737

看看`GROUP BY`条款：[http ://www.sqlite.org/lang_select.html#resultset](http://www.sqlite.org/lang_select.html#resultset)

示例用法：

```
SELECT   mycolumn, SUM(myothercolumn) 
FROM     mytable
GROUP BY mycolumn
ORDER BY mycolumn; 
```

# asp.net - ASP EnableEventValidation 中的安全问题

> ID：10606254
> 
> 赞同：0
> 
> 时间：2012-05-15T17:57:41.747
> 
> 标签：asp.net, security

我`EnableEventValidation`用来防止用户更改表单数据中的值，特别是电子邮件地址（以防止用户将电子邮件放入可能从我的服务器向其他人发送垃圾邮件）。我已`EnableEventValidation`设置为 true，但我想知道是否存在任何用户可以绕过或绕过它的安全问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T11:57:38.290

据我所知，EVENTVALIDATION+VIEWSTATEMAC 是一个安全的组合。如果 VIEWSTATEMAC 未启用，则可以篡改 EVENTVALIDATION 并添加/编辑 ASP 将视为有效的值。这里有更多信息：

[http://www.jardinesoftware.net/2012/02/06/asp-net-tampering-with-event-validation-part-1/](http://www.jardinesoftware.net/2012/02/06/asp-net-tampering-with-event-validation-part-1/) http://www.jardinesoftware.net/2012/02/01/viewstatemac-认真启用它/

但是，不建议依赖 ASP（或任何其他框架）自动验证系统来确保安全。

希望能帮助到你！

# objective-c - 如何在 xcode 中的屏幕之间切换

> ID：10606255
> 
> 赞同：0
> 
> 时间：2012-05-15T17:57:51.370
> 
> 标签：objective-c, ios, xcode

我是 XCode/iOS 的新手，我正在尝试在两个不同的屏幕之间创建一个 segue（一个带有字母 A（一个标签），另一个带有字母 B）。我在情节提要上创建了两个基本视图控制器，然后在其中一个上添加了一个按钮。然后我控制单击并从按钮拖动到另一个视图控制器。我选择推。但是，当我运行它时，它不会继续。为什么不？我听说过导航控制器，但我不想在屏幕顶部有一个导航栏（例如背面），因此我没有使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:08:09.720

为了使用 push segue，你的根视图控制器需要是一个导航控制器。在没有类似“主”控制器的情况下，唯一可以使用的 segue 是模态 segue

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T20:17:06.243

[`UINavigationController`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)如果你想让你的 push segue 工作，你绝对需要一个。

但是，如果您不想看到导航栏，您可以简单地在导航控制器中使用属性禁用它[`navigationBarHidden`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)

如果您使用的是 Xcode，可以在 Utilities Bar、Attribute Inspector 中取消选中此属性，名称为“Shows Navigation Bar”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:08:18.217

如果您不想使用导航控制器，则需要模态序列。此外，您可能想编写自定义 segue 来控制两个视图控制器之间的转换。你可以参考我的帖子，这里解释了如何从一个场景切换到另一个场景：

[您如何从情节提要中的 UIButton 执行自定义转场（模态转场）](https://stackoverflow.com/questions/9466231/how-do-you-perform-a-customized-segue-modal-segue-from-a-uibutton-in-storyboar)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:27:04.790

这是一个非常好的关于segues的教程。您需要购买书籍/PDF 才能获得本教程的第二部分，但如果您想进行 iOS 5.0 编程，这是一个很好的资源。

[http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T20:27:41.507

在故事板的基础上尝试像这样的极客柠檬视频教程：[http](http://www.geekylemon.com/WEBPROTECT-xcodestoryboard) ://www.geekylemon.com/WEBPROTECT-xcodestoryboard 。您可以在注册网站或您的电子管中看到它们。我对 x 代码太陌生了，我发现这一系列教程非常有用。

# php - 如何在一篇文章中将数据插入两个表？

> ID：10606262
> 
> 赞同：0
> 
> 时间：2012-05-15T17:58:32.637
> 
> 标签：php, mysql, insert

如何在一个帖子中在第一个表中插入一行，在第二个表中插入多行？

我有两个表，第一个是主表，第二个是子表，例如：

第一张表 -->>**发票** 第二张表 -->> **sub_invoices**

*每张发票都链接到一张或多张子发票。*

所以，我需要将一个帖子中的数据插入到拖车表中，将一行插入到**invoices**中，将一个或多个插入到**sub_invoices**中。

**发票**:: `invoice_id`, `date`, `total`, `drvr_name`, `mobile`, `car_no`, `to`, `from`,`username`

**sub_invoices** :: `invoice_id`, `contract_no`, `inv_sub_no`, `dest`, `contract_vlu`, `advncd_sum`, `late_sum`, `discount_extra`, `rcvd_sum`, `notes`,`job_no`

```
if(isset($_POST['addinvoice2']) and $_POST['addinvoice2'] == 'addinvoice2'){
            //invoices::
            $drvr_name = $_POST['drvr_name'];
            $mobile = $_POST['mobile'];
            $car_no = $_POST['car_no'];
            $to = $_POST['to'];
            //sub_invoices::
             foreach($_POST['contract_no'] as $index => $contractno) {

                    $contract_no = $contractno;
                    $inv_sub_no = $_POST['inv_sub_no'][$index];
                    $dest = $_POST['dest'][$index];
                    $contract_vlu = $_POST['contract_vlu'][$index];
                    $advncd_sum = $_POST['advncd_sum'][$index];
                    $late_sum = $_POST['late_sum'][$index];
                    $discount_extra = $_POST['discount_extra'][$index];
                    $rcvd_sum = $_POST['rcvd_sum'][$index];
                    $notes = $_POST['notes'][$index];
                    $job_no = $_POST['job_no'][$index];
             } 

                $date=date('d-m-y h:iA');

                $MAIN = mysql_query("INSERT INTO `invoices`(`invoice_id`, `date`, `total`, `drvr_name`, `mobile`, `car_no`, `to`, `from`, `username`)
                 VALUES
                 ('','$date','','$drvr_name','$mobile','$car_no','$to','','') 
                ") or die(mysql_error());

                $last_id_in_invoices = mysql_insert_id();

                $SUB = "INSERT INTO `sub_invoices`
                (`invoice_id`, `contract_no`, `inv_sub_no`, `dest`, `contract_vlu`, `advncd_sum`, `late_sum`,
                 `discount_extra`, `rcvd_sum`, `notes`, `job_no`) 
                VALUES ($last_id_in_invoices,$contract_no,$inv_sub_no,$dest,$contract_vlu,$advncd_sum,$late_sum,$discount_extra,$rcvd_sum,$notes,$job_no)";

                $RESULT_SUB = mysql_query($SUB);

                if (isset($MAIN, $RESULT_SUB)){
                    die ("
                        <center>Done Successfully!</center>
                        ");
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:04:47.733

很确定你会使用两个插入语句，你为什么不做这样的事情呢？

```
INSERT INTO INVOICES....  and INSERT INTO SUB_INVOICES...(perhaps in a loop) 
```

# php - php数组foreach循环跳过单个键值

> ID：10606263
> 
> 赞同：1
> 
> 时间：2012-05-15T17:58:51.133
> 
> 标签：php, arrays, loops

我正在尝试获取一个 foreach 循环来显示数组的所有值，但由于某种原因它跳过了值 4。

```
echo $sku."<br>";
$skuArray = explode(" ", $sku);
$skuCount = array_count_values($skuArray);
print_r($skuArray);
echo "<br><br>";
$i=0;
foreach ($skuCount as $key => $val) {
    echo "[".$i."] => ".$key." ";
    $i++;
} 
```

这就是输出的样子：

```
1DALI0SPBA775RW 2 $92.99 1GJESSGRIP10000 2 $9.99

Array ( [0] => 1DALI0SPBA775RW 
        [1] => 2 
        [2] => $92.99 
        [3] => 1GJESSGRIP10000 
        [4] => 2 
        [5] => $9.99 )

[0] => 1DALI0SPBA775RW 
[1] => 2 
[2] => $92.99 
[3] => 1GJESSGRIP10000 
[4] => $9.99 
```

如您所见，foreach 循环说 4 等于 $9.99，但在 print_r 数组中它等于 2 - 这是我所期望的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:07:13.623

这就是你想要的：

```
echo $sku."<br>";
$skuArray = explode(" ", $sku);
print_r($skuArray);
echo "<br><br>";
$i=0;
foreach ($skuArray as $key => $val) {
    echo "[".$key."] => ".$val." ";
} 
```

`array_count_values($skuArray)`实际上创建了一个可以循环的数组，但重复项被省略为单个值。请参阅[文档](http://php.net/manual/en/function.array-count-values.php)。

# c# - 在 VisualStudio DTE 中，如何获取 ActiveDocument 的内容？

> ID：10606274
> 
> 赞同：8
> 
> 时间：2012-05-15T17:59:28.627
> 
> 标签：c#, visual-studio, envdte

我在 VisualStudio 中编写脚本，并试图获取当前 ActiveDocument 的内容。

这是我目前的解决方案：

```
var visualStudio = new API_VisualStudio_2010();

var vsDTE = visualStudio.VsAddIn.VS_Dte;

var document = (Document)vsDTE.ActiveDocument;
var textDocument = (TextDocument)document.Object("TextDocument");

var editPoint = textDocument.StartPoint.CreateEditPoint();
var text = editPoint.GetText(textDocument.EndPoint.CreateEditPoint());

panel.clear().add_SourceCodeViewer()
     .set_Text(text,  document.FullName.extension()); 
```

这是最好的方法吗？

我得到了解决方案：[因为 ActiveDocument.Text() 太容易了......](http://ask.metafilter.com/103284/Because-ActiveDocumentText-Would-Be-Too-Easy)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-05T02:07:47.647

这对我有用

```
protected DTE2 dte;
dte2 = (EnvDTE80.DTE2)GetService(typeof(EnvDTE.DTE));

public string GetCurrentTextFile(){

  TextDocument doc = (TextDocument)(dte.ActiveDocument.Object("TextDocument"));
  var p = doc.StartPoint.CreateEditPoint();
  string s = p.GetText(doc.EndPoint);

  return s;            
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:04:21.107

你能试试这个吗？

```
Dim objSelection As TextSelection = DTE.ActiveDocument.Selection 
```

# c# - 两个字符的组合

> ID：10606277
> 
> 赞同：1
> 
> 时间：2012-05-15T17:59:35.897
> 
> 标签：c#, combinations

**我将输入作为int**并根据该输入我想要两个字符的组合， 例如我将输入作为 2 并且我有两个字符 x 和 y 所以我想要像这样的组合

```
 xx,yy,xy,yx 
```

如果输入是 3，我想要

```
 xxx,xyy,xxy,xyx,yxx,yyy,yxy.yyx 
```

依此类推，我尝试使用以下代码，

```
 int input1 = 4;
        Double totalpossibilities = Math.Pow(2, input1);
        string[] PArray = new string[Convert.ToInt16(totalpossibilities)];
        char[] chars = new char[] { 'x', 'y'};

        for (int i = 0; i < totalpossibilities; i++)
        {
            string possibility = "" ;
            for (int j = 0; j < input1; j++)
            {
                Random random = new Random();
                int r = random.Next(chars.Length);
                char randomChar = chars[r];
                possibility = possibility + randomChar;

            }
            if (PArray.Contains(possibility))
            {
                i--;
            }
            else
                PArray[i] = possibility;
        } 
```

但是你可以看到我使用的是随机函数所以我完成的时间太长了，有什么不同的逻辑吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:05:31.417

[使用从这里](http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx)逐字复制的笛卡尔积扩展方法的副本：

```
static IEnumerable<IEnumerable<T>> CartesianProduct<T>(this IEnumerable<IEnumerable<T>> sequences) 
{ 
  IEnumerable<IEnumerable<T>> emptyProduct = new[] { Enumerable.Empty<T>() }; 
  return sequences.Aggregate( 
    emptyProduct, 
    (accumulator, sequence) => 
      from accseq in accumulator 
      from item in sequence 
      select accseq.Concat(new[] {item})); 
} 
```

然后在您的代码中，您可以拥有：

```
IEnumerable<char> possibleCharacters = "xy";//change to whatever
int numberOfDigits = 3;

var result = Enumerable.Repeat(possibleCharacters, numberOfDigits)
     .CartesianProduct()
     .Select(chars => new string(chars.ToArray()));

//display (or do whatever with) the results
foreach (var item in result)
{
    Console.WriteLine(item);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:04:03.100

您可以运行从 0 到全部可能性的 for 循环。将 i 转换为二进制，例如，在第 20 次迭代中，这将导致“10100”。将结果填充到 input1 个字符，例如（8 个位置）：00010100 然后转换为字符串并将所有零替换为“x”，所有替换为“y”。

```
 int places = 4;
        Double totalpossibilities = Math.Pow(2, places);

        for (int i = 0; i < totalpossibilities; i++)
        {
            string CurrentNumberBinary = Convert.ToString(i, 2).PadLeft(places, '0');

            CurrentNumberBinary = CurrentNumberBinary.Replace('0', 'x');
            CurrentNumberBinary = CurrentNumberBinary.Replace('1', 'y');
            Debug.WriteLine(CurrentNumberBinary);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:13:35.577

如果你总是有 2 个字符，那么最简单的方法是使用整数组合性质。如果您采用从 2^n 到 2^(n+1) - 1 的所有数字的二进制形式，您会注意到它表示长度为 n 的“0”和“1”的所有可能组合：)。

对于超过 2 个字符，我将使用类似的方法，但基数不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:26:23.287

这是一个解决方案`List<>`。泛化到任意数量的字母。

```
static List<string> letters = new List<string> { "x", "y", };

static List<string> MakeList(int input)
{
  if (input < 0)
    throw new ArgumentOutOfRangeException();

  var li = new List<string> { "", };

  for (int i = 0; i < input; ++i)
    li = Multiply(li);

  return li;
}

static List<string> Multiply(List<string> origList)
{
  var resultList = new List<string>(origList.Count * letters.Count);
  foreach (var letter in letters)
    resultList.AddRange(origList.Select(s => letter + s));
  return resultList;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T19:26:58.327

svenv 答案是对这个问题的正确（而且非常聪明）的答案，但我想我会提供一个通用的解决方案来生成一组标记的所有排列，这可能对可能有类似问题的其他人有用。

```
public class Permutations
{
    public static string[][] GenerateAllPermutations(string[] tokens, int depth)
    {
        string[][] permutations = new string[depth][];

        permutations[0] = tokens;

        for (int i = 1; i < depth; i++)
        {
            string[] parent = permutations[i - 1];
            string[] current = new string[parent.Length * tokens.Length];

            for (int parentNdx = 0; parentNdx < parent.Length; parentNdx++)
                for (int tokenNdx = 0; tokenNdx < tokens.Length; tokenNdx++)
                    current[parentNdx * tokens.Length + tokenNdx] = parent[parentNdx] + tokens[tokenNdx];

            permutations[i] = current;
        }

        return permutations;
    }

    public static void Test()
    {
        string[] tokens = new string[] { "x", "y", "z" };
        int depth = 4;

        string[][] permutations = GenerateAllPermutations(tokens, depth);

        for (int i = 0; i < depth; i++)
        {
            foreach (string s in permutations[i])
                Console.WriteLine(s);

            Console.WriteLine(string.Format("Total permutations:  {0}", permutations[i].Length));
            Console.ReadKey();
        }
    }
} 
```

干杯，

# javascript - 鼠标位置滚动

> ID：10606278
> 
> 赞同：0
> 
> 时间：2012-05-15T17:59:36.270
> 
> 标签：javascript

这是有效的：http: [//jsfiddle.net/9NDXF/1/](http://jsfiddle.net/9NDXF/1/)当我写 onmousemove 时，但这不是：http: [//jsfiddle.net/9NDXF/7/](http://jsfiddle.net/9NDXF/7/)当我写 onscroll 时。

我怎样才能让鼠标位置滚动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:04:58.537

因为滚动事件没有 pageX 属性。卷轴很烂。[这是一篇关于鼠标滚动事件](http://viralpatel.net/blogs/2009/08/javascript-mouse-scroll-event-down-example.html)的好文章，以及演示的[jsFiddle](http://jsfiddle.net/CEvYx/1/)。

“在滚动时获取鼠标位置”的唯一方法是在较早的时间记录它，然后在需要时访问它。不过，我会花很多时间思考为什么你认为这是一个好主意：[jsFiddle](http://jsfiddle.net/9NDXF/21/)

```
var mousePostion = {clientX:0,clientY:0};

function record(e)
{
    mousePostion = {
        clientX: e.clientX,
        clientY: e.clientY
    };
}
function print(e)
{
   document.getElementById("x").value=mousePostion.clientX;
   document.getElementById("y").value=mousePostion.clientY;
}
window.onmousemove=record;
window.onscroll=print;​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:02:14.427

onscroll 是当用户滚动屏幕时。最小化 jsFiddle 所以有一个滚动条，然后用它滚动。您将看到填充的值。“e”未定义。

```
function test(e)
{
    alert(e);

    var doc=document.documentElement;
    var body=document.body;
    if(e.pageX)
    {
        document.getElementById("x").value=e.pageX;
        document.getElementById("y").value=e.pageY;
    }
    else
    {
        document.getElementById("x").value=e.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);
        document.getElementById("y").value=e.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);
    }
}
window.onscroll=test;​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:09:03.120

阅读此参考希望对
[http://javascriptmagic.blogspot.com/2006/09/getting-scrolling-position-using.html有所帮助](http://javascriptmagic.blogspot.com/2006/09/getting-scrolling-position-using.html)

# objective-c - 将字符串转换为 int 会更改值

> ID：10606281
> 
> 赞同：0
> 
> 时间：2012-05-15T17:59:58.767
> 
> 标签：objective-c, cocoa, nsstring, integer

我正在尝试将从 XML 解析器检索到的字符串值转换为整数。不幸的是，我发现整数值没有反映字符串中的数字，我不知道为什么。这是我的代码：

```
int maxTweetID = [[[_dataArray lastObject]tweetID]intValue];

NSLog(@"String Value of tweet ID: %@",[[_dataArray lastObject]tweetID]);
NSLog(@"Int Value of tweet ID: %i",[[[_dataArray lastObject]tweetID]intValue]); 
```

这是我从调试器中得到的：

```
2012-05-15 10:58:44.395 nearYou[2460:707] String Value of tweet ID: 202425636143370242
2012-05-15 10:58:44.396 nearYou[2460:707] Int Value of tweet ID: 2147483647 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:03:01.947

这个数字太大了，无法容纳 32 位`int`。你想要做的是使用 a`long`代替：

```
long maxTweetID = [[[_dataArray lastObject]tweetID]longValue]; 
```

**编辑：**

您实际上需要`long long`在Objective-C中使用：

```
long long maxTweetID = [[[_dataArray lastObject]tweetID]longLongValue]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:02:13.923

字符串中的数字太大而无法存储为整数。32 位可能的最高整数是 2.147.483.647。尝试使用长。

# c# - 从后台线程启动时，UI 线程上的任务继续

> ID：10606283
> 
> 赞同：8
> 
> 时间：2012-05-15T18:00:02.367
> 
> 标签：c#, c#-4.0, parallel-processing, task-parallel-library

如果以下代码*在后台线程上*运行，我如何在主线程上“继续”？

```
 var task = Task.Factory.StartNew(() => Whatever());
  task.ContinueWith(NeedThisMethodToBeOnUiThread), TaskScheduler.FromCurrentSynchronizationContext()) 
```

上面的不行，因为当前的同步上下文已经是后台线程了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T18:08:48.620

您需要从 UI 线程获取对 TaskScheduler.FromCurrentSynchronizationContext() 的引用并将其传递给延续。

与此类似。 [http://reedcopsey.com/2009/11/17/synchronizing-net-4-tasks-with-the-ui-thread/](http://reedcopsey.com/2009/11/17/synchronizing-net-4-tasks-with-the-ui-thread/)

```
private void Form1_Load(object sender, EventArgs e)
{
    // This requires a label titled "label1" on the form...
    // Get the UI thread's context
    var context = TaskScheduler.FromCurrentSynchronizationContext();

    this.label1.Text = "Starting task...";

    // Start a task - this runs on the background thread...
    Task task = Task.Factory.StartNew( () =>
        {
            // Do some fake work...
            double j = 100;
            Random rand = new Random();
            for (int i = 0; i < 10000000; ++i)
            {
                j *= rand.NextDouble();
            }

            // It's possible to start a task directly on
            // the UI thread, but not common...
            var token = Task.Factory.CancellationToken;
            Task.Factory.StartNew(() =>
            {
                this.label1.Text = "Task past first work section...";
            }, token, TaskCreationOptions.None, context);

            // Do a bit more work
            Thread.Sleep(1000);
        })
        // More commonly, we'll continue a task with a new task on
        // the UI thread, since this lets us update when our
        // "work" completes.
        .ContinueWith(_ => this.label1.Text = "Task Complete!", context);
} 
```

# ruby-on-rails-3 - Rails 3 Uploadify + Paperclip 无法在保存时自动生成孙子记录 ID

> ID：10606286
> 
> 赞同：0
> 
> 时间：2012-05-15T18:00:03.807
> 
> 标签：ruby-on-rails-3, uploadify, nested-attributes, null, grandchild

我有一个这样的协会：

用户有很多上传上传属于用户并且有很多上传图片上传图片属于上传<--孙

在将上传添加到该用户之前，我创建了我的用户。Uploads 是 misc 类型的独立文件，但它们也可以有许多 Upload Images 链接到它们以更好地描述 Uploads（因此单独的 Upload Image 模型）。现在 Upload 和 Upload_Image 持久性发生在用户更新函数中，因为它们是嵌套的表单属性。

因为 Uploads 可以有很多 Upload_Images 我正在尝试使用 Uploadify 来保存图像，但我无法将它与其余参数哈希一起发送到用户更新函数（我曾经能够在它只是一个正在发送单个回形针图像上传）。Uploadify 现在强制我将 Upload_Image 参数发送到单独的创建操作，这应该不是问题，因为我可以简单地计算 upload_id 外键并手动分配它。

然而问题是，当我执行保存时，它会将自动生成的字段（即 id 和时间戳）保留为 nil，我该如何防止这种情况发生？

这是我的模型（简化）：

用户.rb

```
 has_many :uploads, :dependent => :destroy, :order => 'created_at desc'
  accepts_nested_attributes_for :uploads, :allow_destroy => true 
```

上传.rb

```
belongs_to :user
has_many :upload_images, :dependent => :destroy  
  accepts_nested_attributes_for :upload_images
    has_attached_file :upload,  :path => ":rails_root/:class/:id/:basename.:extension", :url => ":rails_root/:class  /:id/:basename.:extension" 
```

上传图片.rb

```
belongs_to :upload
has_attached_file :image, :styles => {:thumb => "125x125#", :small => "150x150>", :medium => "200x200>", :large => "320x240>"}, 
                  :path => ":rails_root/uploads/:upload_id/:class/:id/:style/:basename.:extension", 
                  :url => ":rails_root/uploads/:upload_id/:class/:id/:style/:basename.:extension" 
```

## 额外的

这是我的上传脚本：

```
<script type="text/javascript" charset="utf-8">
<%- session_key = Rails.application.config.session_options[:key] -%> 
$(document).ready(function() {
    // Create an empty object to store our custom script data
    var uploadify_script_data = {};

    // Fetch the CSRF meta tag data
    var csrf_token = $('meta[name=csrf-token]').attr('content');
    var csrf_param = $('meta[name=csrf-param]').attr('content');

    // Now associate the data in the config, encoding the data safely
    uploadify_script_data[csrf_token] = encodeURI(encodeURI(csrf_param));

    // Now associate the data in the config, encoding the data safely
    uploadify_script_data[csrf_token] = encodeURI(csrf_param)

    $('.uploadify').uploadify(
    {
        uploader : '/uploadify/uploadify.swf',
        cancelImg : '/uploadify/cancel.png',
        multi : true,
        auto : true,
        script : '/uploads',
        onComplete : function(event, queueID, fileObj, response, data) 
        { 
            var dat = eval('(' + response + ')');
            $.getScript(dat.upload);
        },
        scriptData : 
        {
            '_http_accept': 'application/javascript',
            'format' : 'json',
            '_method': 'post',
            '<%= session_key %>' : encodeURIComponent('<%= u cookies[session_key] %>'),
            'authenticity_token': encodeURIComponent('<%= u form_authenticity_token %>'),
            'upload_id' : '<%= Upload.last.id + 1 %>'
          }
    }); 

    $('#submit').click(function(event){ 
        event.preventDefault();
    }); 

    $('#submit').click(function(event){ 
            event.preventDefault(); 
            $('.uploadify').uploadifyUpload(); 
        });

}); 
</script> 
```

和创建动作：

```
 def create
    @upload_image_test = UploadImage.new(:image => params[:Filedata])
    @upload_image_test.upload_id = Upload.last.id + 1     
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:45:20.300

这更像是一个设计问题。基本上我试图在父对象之前创建一个子对象，所以我只需将此表单移动到创建父对象之后发生的单独页面。

# php - 在这种情况下如何在函数中传递参数？

> ID：10606288
> 
> 赞同：1
> 
> 时间：2012-05-15T18:00:25.640
> 
> 标签：php, arrays, function

我正在尝试将数组作为参数传递给新的 php 文件。

```
$data=array('arr1'=>'haha', 'arr2'=>'wawa');

 function load($view='index',$data=false){

            require $view.'.php';

        if (isset($data)){
            //I want to pass $data(array) to index.php so I can use the array 
            //in index.php page.
            //not sure what to do here.
        }

    }

load('index', $data); 
```

索引.php

```
<html>
      echo '$arr1 ='.$arr1;
      echo '$arr2 ='.$arr2;
</html> 
```

这可能吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:03:29.920

您已经可以访问该数组。

```
 function load($view='index',$data=false){

     require $view.'.php';

 } 
```

在您的 index.php 中，您可以执行以下操作：

```
<p>
   <?=$data['value'];?>
</p> 
```

因为你在你的职能范围内。

请注意，那里有很多模板引擎，我强烈建议您使用其中之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:04:52.207

在你的“要求”声明之前......你可以这样做：

```
foreach($data as $name => $value) {
    $$name = $value;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T18:15:39.473

我认为您对包含文件的实际含义感到困惑。因为包含一个文件几乎意味着您附加了包含的文件，所以您不是重定向或类似的东西。因此，如果您将其包含在定义变量的文件中，您将能够在“视图”文件中使用变量。

但是，您可以使用 php 进行解析，将逻辑和视图分开很好，但我建议您尝试使用模板引擎，它可以完成您尝试做的所有事情，但更好的是内置转义、渲染, 缓存等

我会推荐以下引擎：

[http://twig.sensiolabs.org/](http://twig.sensiolabs.org/) Twig，它很棒，可以在 Symfony 框架中使用如果我没记错的话！它易于安装和使用。

Twig 的替代品是 Smarty，它也是一个很棒的模板引擎，并在许多项目中使用。[http://www.smarty.net/](http://www.smarty.net/)

Have a look at both of them If you wish and decide which one you like the most. But if you are not interested and preferably want your own 'template engine' it's perfectly fine, I am just saying why reinvent the wheel, when there is code that is tested, well written and so forth.

# ruby - Ruby Net::SSH 使用变量插值更改目录

> ID：10606290
> 
> 赞同：4
> 
> 时间：2012-05-15T18:00:32.910
> 
> 标签：ruby, ssh, exec

我对 Ruby 很陌生，所以如果我遗漏了一些明显的东西，请原谅我。

问题是 Ruby 似乎没有在 Net::SSH.exec 中进行变量插值！方法。

```
VCL_DIR = "/usr/local/etc/varnish/"
host = '0.0.0.0'
Net::SSH.start(host, 'root') do |ssh|
  puts "Changing directories to #{VCL_DIR}"
  ssh.exec!("cd #{VCL_DIR}")
  res = ssh.exec!("pwd")
  puts "Server reports current directory as #{res}"
end 
```

输出：

```
Changing directories to /usr/local/etc/varnish/
Server reports current directory as /root 
```

任何帮助表示赞赏。使用 Ruby 1.9.3p194

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T19:01:41.337

问题是 Net::SSH 对每个 exec 调用使用不同的 shell。解决方案是使用有状态的 shell。有一个宝石可以做到这一点，但它已经过时了。Net::SSH::Shell 通过[https://github.com/mitchellh/net-ssh-shell](https://github.com/mitchellh/net-ssh-shell)

我选择使用 Rye 来处理这个任务。[http://code.google.com/p/rye/](http://code.google.com/p/rye/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-10T03:01:16.223

`Net::SSH.start( "10.2.10.1", "botp:)", :password=>"secret=)") do |session| puts session.exec! "ls -la; cd /etc; ls -la" end`

参考：[https ://www.ruby-forum.com/topic/160890](https://www.ruby-forum.com/topic/160890)

> 请注意：您必须为每个`.exec!`运行的命令“cd”。
> 如下所示，将向您展示在一个执行程序中使用 cd ！command 不会更改下一个 exec 命令的位置。

`Net::SSH.start( "10.2.10.1", "botp:)", :password=>"secret=)") do |session| puts session.exec!("ls -la; cd /etc; ls -la") puts session.exec!("ls -la") end`

# java - Java Maven MOJO - 从项目 POM 中获取信息

> ID：10606293
> 
> 赞同：29
> 
> 时间：2012-05-15T18:00:45.390
> 
> 标签：java, maven, pom.xml, mojo

我正在开发一个 Maven 插件。我似乎很难弄清楚，从执行 MOJO 的项目中获取 POM 信息的好方法是什么？

例如，如果我在另一个 maven 项目中执行我的 mojo，我想获取项目名称或其他一些参数。

还有一件事，AbstractMojo.java 类中有一个上下文 MAP 有私有 Map pluginContext，如果我错了，有人可以纠正我，但这应该用于在 mojos 之间传递信息吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-15T21:32:19.873

您可以使用如下声明的字段将当前 maven 项目注入您的 mojo：

```
/**
 * @parameter default-value="${project}"
 * @required
 * @readonly
 */
MavenProject project; 
```

然后只需调用即可获得项目名称`project.getName()`。要使用此 API，您需要将`maven-project`工件添加为依赖项：

```
<dependency>
    <groupId>org.apache.maven</groupId>
    <artifactId>maven-project</artifactId>
    <version>2.0.6</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-03-11T20:53:41.810

```
@Component
private MavenProject project; 
```

如果使用 new 也可以工作（更简洁和直观）`maven-plugin-annotations`，这是从`maven-archetype-plugin`.

*编辑*（感谢@bmargulies）：虽然`@Component`3.2 的Javadoc 建议将它用于`MavenProject`，但显然已弃用，并且从3.3 开始放弃该建议；（从 3.3 开始）建议的[成语](http://maven.apache.org/plugin-tools/maven-plugin-tools-annotations/index.html)`maven-plugin-tools-annotations`是这样的（两者似乎都有效）：

```
@Parameter(defaultValue="${project}", readonly=true, required=true)
private MavenProject project; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-08-06T15:51:15.890

现在首选的语法是：

```
@Parameter(defaultValue = "${project}", required = true, readonly = true)
MavenProject project; 
```

您必须为`maven-project`插件的 pom 添加依赖项：

```
<dependency>
    <groupId>org.apache.maven</groupId>
    <artifactId>maven-project</artifactId>
    <version>2.0.6</version>
</dependency> 
```

（感谢已经提供此信息的其他人。此答案将它们组合在一个地方。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-08T22:43:07.083

请参阅[教程：如何创建 Maven 插件](https://dzone.com/articles/tutorial-create-a-maven-plugin)：

### 聚甲醛

```
 <dependency>
            <!-- needed when injecting the Maven Project into a plugin  -->
            <groupId>org.apache.maven</groupId>
            <artifactId>maven-core</artifactId>
            <version>3.6.3</version>
            <scope>provided</scope>
        </dependency> 
```

### 魔精

```
@Parameter(property = "project", readonly = true)
private MavenProject project; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-07-02T09:15:43.773

`maven-project`对于 maven 2.x 版本已替换为`maven-model`maven 3.x 版本，因此对于新项目，请使用

```
<dependency>
  <groupId>org.apache.maven</groupId>
  <artifactId>maven-model</artifactId>
  <version>3.6.3</version>
</dependency> 
```

# r - 从 Auto.arima 到 R 中的预测

> ID：10606295
> 
> 赞同：9
> 
> 时间：2012-05-15T18:00:51.373
> 
> 标签：r

我不太明白如何在in 中`forecast()`应用外部回归器的语法。`library(forecast)``R`

我的身材是这样的：

`fit <- auto.arima(Y,xreg=factors)`

其中`Y`是一个`timeSeries`对象 100 x 1，因子是一个`timeSeries`对象 100 x 5。

当我去预测时，我申请...

`forecast(fit, h=horizon)`

我得到一个错误：

`Error in forecast.Arima(fit, h = horizon) : No regressors provided`

它是否要我从拟合中加回 xregressors？我认为这些被包含在`fit`对象中作为`fit$xreg`. 这是否意味着它要求 xregressors 的未来值，或者我应该重复我在拟合集中使用的相同值？该文档未涵盖`xreg`预测步骤中的含义。

我相信这一切意味着我应该使用

`forecast(fit, h=horizon,xreg=factors)`

或者

`forecast(fit, h=horizon,xreg=fit$xreg)`

这给出了相同的结果。但我不确定预测步骤是将这些因素解释为未来值，还是适当地解释为以前的值。所以，

1.  这是否像我预期的那样根据纯粹的过去值进行预测？
2.  为什么我必须指定 xreg 值两次？如果我排除它们，它就不会运行，所以它不像一个选项。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-15T21:23:08.210

如果我错了，请纠正我，但我认为您可能不完全理解带有回归量的 ARIMA 模型是如何工作的。

当您使用简单的 ARIMA 模型（没有回归量）进行预测时，它只是使用时间序列的过去值来预测未来值。在这样的模型中，您可以简单地指定您的视野，它会给您一个直到那个视野的预测。

当您使用回归量构建 ARIMA 模型时，您需要包含*回归量的未来值*以进行预测。例如，如果您使用温度作为回归量，并且您正在预测疾病发病率，那么您将需要温度的未来值来预测疾病发病率。

其实文档里*确实*有具体讲`xreg`。抬头`?forecast.Arima`看看论点`h`和`xreg`。你会看到 If`xreg`被使用， then`h`被忽略。为什么？因为如果您的函数使用`xreg`，那么它*需要*它们进行预测。

因此，在您的代码中，`h`当您包含`xreg`. 由于您只是使用了用于拟合模型的值，因此它只是为您提供了对同一组回归量的所有预测，*就好像它们在未来一样*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-27T22:49:52.323

相关 [https://stats.stackexchange.com/questions/110589/arima-with-xreg-rebuilding-the-fitted-values-by-hand](https://stats.stackexchange.com/questions/110589/arima-with-xreg-rebuilding-the-fitted-values-by-hand)

我读到 R 中的 arima 很无聊 参见第 3 和第 4 期

[https://www.stat.pitt.edu/stoffer/tsa4/Rissues.htm](https://www.stat.pitt.edu/stoffer/tsa4/Rissues.htm)

建议使用 xreg 导出正确的截距。

我正在使用 excel 的真实统计数据来确定实际常数是多少。我有一个教授告诉我你需要有一个常数

这些得出相同的预测。因此，您似乎可以使用 xreg 获取一些描述性信息，但您必须使用 statsexchange 链接手动从中派生。

f = auto.arima(lacondos[,1])

f$coef

g = Arima(lacondos[,1],c(t(matrix(arimaorder(f)))),include.constant=FALSE,xreg=1:length(lacondos[,1]))

g$coef

# jquery - 使用 jQuery 抓取兄弟的 html 以设置为元素的标题标签

> ID：10606300
> 
> 赞同：0
> 
> 时间：2012-05-15T18:00:55.443
> 
> 标签：jquery, fancybox

我正在使用以下代码设置元素的标题属性，并触发 Fancybox：

```
var caption = jQuery('.fancybox').siblings('p.wp-caption-text').html();

jQuery('.fancybox').attr({ title:caption, 'data-fancybox-group': 'gallery1'}).fancybox(); 
```

当页面上只有一个链接时，这很好`.fancybox`用，但问题当然是我想使用画廊。

上面将变量设置为页面上的第一个实例，因此所有标题都是相同的。

我可以这样做吗？

```
jQuery('.fancybox').attr({ title:'jQuery(this).siblings('p.wp-caption-text').html();', 'data-fancybox-group': 'gallery1'}).fancybox(); 
```

请原谅我缺乏编码技能，但我希望对于更熟悉 jQuery 的人来说这是一个简单的问题。

正在进行的页面：http: [//professorleonidas.com/wordpress/formacao/](http://professorleonidas.com/wordpress/formacao/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:37:15.803

你可以让它更简单：拥有这个 html ...

```
<a class="fancybox" data-fancybox-group="gallery1" href="image01.jpg">open image 01</a>
<p>I am the caption for the image 01</p>
<a class="fancybox" data-fancybox-group="gallery1" href="image02.jpg">open image 02</a>
<p>I am the caption for the image 02</p> 
```

...使用这个脚本：

```
jQuery(".fancybox").fancybox({
 beforeShow: function(){
  this.title = $(this.element).next('p').html();
 }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:07:34.877

分别适用于每一个：

```
var caption;
$('.fancybox').each(function(i, elem){
    // Grab the caption text
    caption = $(elem).siblings('p.wp-caption-text').html();

    // Set the attributes and initialize fancybox
    $(elem).attr({ title:caption, 'data-fancybox-group': 'gallery1'}).fancybox();
}); 
```

您的问题并不清楚您的 'data-fancybox-group' 属性的意义，但上面的代码将`gallery1`作为其值应用于所有与 class 匹配的元素`fancybox`。

干杯

# monodevelop - 将可移植类库项目 .csproj 文件从版本 2 (Beta) 转换回版本 1

> ID：10606302
> 
> 赞同：1
> 
> 时间：2012-05-15T18:01:05.240
> 
> 标签：monodevelop, visual-studio-2012, portable-class-library

目前，我正在尝试在 VS10、VS11 和 MonoDevelop3 之间来回移动大量代码。

似乎 MonoDevelop3 对 PCL1 有一些初步支持，但 VS10 和 VS11 现在都使用 PCL2（Beta）——因为我将 VS11 安装在与 VS10 相同的 PC 上。

为了让 MonoDevelop3 加载这些 PCL2(Beta) 项目，我正在尝试手动操作 PCL 项目。

看起来这不像更改 .csproj XML 文件中的 TargetProfile 那样简单——似乎还需要更多……但我不知道是什么。

有谁知道 PCL2 和 PCL1 之间的确切区别是什么？或者我如何手动转换 PCL2 项目文件以便将它们加载到 MonoDevelop 中？

谢谢

斯图尔特

一个示例 PLP2 项目文件看起来有点像：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{B6E27475-E7D0-448C-A5CC-5097DCA1E2DD}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Cirrious.MvvmCross</RootNamespace>
    <AssemblyName>Cirrious.MvvmCross</AssemblyName>
    <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
    <TargetFrameworkProfile>Profile104</TargetFrameworkProfile>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{786C830F-07A1-408B-BD7F-6EE04809D6DB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Application\MvxApplication.cs" />
    etc
  </ItemGroup>
  <Import Project="$(MSBuildExtensionsPath32)\Microsoft\Portable\$(TargetFrameworkVersion)\Microsoft.Portable.CSharp.targets" />
</Project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:32:54.307

现在结束这个问题。

在仔细研究了这个之后......项目文件之间似乎没有任何显着差异。

相反，对这些文件的 monoDevelop 支持似乎还很年轻，如果你想在 MonoDevelop (3.0.2) 中打开这些文件，**你必须使用 Profile1**

所以使用：

```
<TargetFrameworkProfile>Profile1</TargetFrameworkProfile> 
```

不是

```
<TargetFrameworkProfile>Profile2</TargetFrameworkProfile> 
```

# c++ - 在程序启动时从另一个目录加载 DLL

> ID：10606304
> 
> 赞同：10
> 
> 时间：2012-05-15T18:01:15.580
> 
> 标签：c++, windows, visual-studio, dll

我的基本问题是：我的程序（MyProgram.exe）依赖于另一个程序（OtherProgram）的 DLL，我试图避免每次 OtherProgram 更新时重新打包一个新的 DLL。我想在 MyProgram.exe 启动时在 OtherProgram 的 DLL 中有链接，但我不完全确定 Windows 是否允许这样做。因此，如果有某种解决方法也是可以接受的。

只是为了一些背景，平台是 Windows 7 x64，当我在 MyProgram.exe 项目目录中创建指向 OtherProgram 安装目录中 DLL 的符号链接时，MyProgram.exe 运行良好。当我尝试在没有符号链接的情况下运行它时，出现“程序无法启动，因为您的计算机中缺少 OtherProgramDLL.dll”错误。

非常感谢任何建议或相关信息的链接！

编辑：澄清：DLL在编译时没有链接，这个问题在运行时出现

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-15T19:16:36.480

Windows 世界中有两种类型的动态链接：

1.  [加载时](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684184%28v=vs.85%29.aspx)链接是在程序启动时自动加载 DLL。Windows 使用我将在下面讨论的特定算法找到此 DLL。
2.  [运行时](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685090%28v=vs.85%29.aspx)*链接*是指通过调用`LoadLibrary`代码来专门加载 DLL 。类似的规则适用于如何找到库，但您可以指定完全限定或相对限定的路径来控制搜索。

**在加载时链接的情况下**，MS 建议将程序的 DLL 存储在加载应用程序的同一目录中并从该目录加载。如果这完全可行，这可能是您最好的选择。

如果这不起作用，还有其他几个选项，[在此处列出](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682586%28v=vs.85%29.aspx)。一种是通过将 DLL 放在工作目录或从中加载应用程序的目录中来利用搜索顺序。

您可以通过以下方式更改应用程序的工作目录：

1.  创建应用程序的快捷方式。
2.  调出快捷方式的属性
3.  使用 DLL 所在的目录编辑“开始于”属性。

当您使用快捷方式启动应用程序时，它将加载正确的 DLL。

加载时链接的其他选项包括：

*   向您的应用程序添加一个清单，该清单指定您的依赖[程序集](http://msdn.microsoft.com/en-us/library/windows/desktop/dd408052%28v=vs.85%29.aspx)在哪里，或者，
*   设置`PATH`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:10:40.227

您可以使用[LoadLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)，但您需要一种方法来保证 DLL 的位置。这篇 Wikipedia[文章](http://en.wikipedia.org/wiki/Dynamic-link_library#Explicit_run-time_linking)提供了关于如何在加载 DLL 后使用它的很好的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:03:21.440

您可以将dll所在的目录添加到`PATH`环境变量中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-15T15:10:00.067

`LoadLibrary`我一直在为同样的问题而苦苦挣扎，并且还发现了建议的方法，如、`SetDllDirectory`、 Qt`addLibraryPath`和其他方法的死胡同。不管我尝试了什么，问题仍然存在，即应用程序在实际运行代码之前检查了库（并且没有找到它们），因此任何代码解决方案都必然会失败。

我几乎绝望了，但后来发现了一种非常简单的方法，在像你这样的情况下也可能会有所帮助：**使用批处理文件！**（或实际应用之前的类似加载器）

用于此目的的 Windows 批处理文件可能如下所示：

```
@echo off
PATH=%PATH%;<PATH_TO_YOUR_LIB>
<PATH_TO_YOUR_APP_EXE> 
```

/edit：刚刚在[Luchian 的回答中看到了](https://stackoverflow.com/a/10606345/959339)[@SirDarius](https://stackoverflow.com/users/393701/sirdarius)评论，它描述了这种方式，所以只需将我的批处理代码位作为参考，所有学分都归他所有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-01T01:38:41.287

我正在处理的一个应用程序也有同样的问题。

我不想使用运行时加载，因为我需要手动为其创建函数指针的函数有几十个。

Dibling 先生提到清单文件为我打开了一扇新的大门，但我遗憾地发现支持该功能的最旧版本的 Windows 是 Windows 7。它甚至无法在 Vista 上运行。

长话短说，一位熟悉 Windows 应用程序开发的朋友告诉我查找[Delay-Loaded DLL](https://msdn.microsoft.com/en-us/library/151kt790.aspx "延迟加载的 DLL")，结果证明以最小的努力完美地解决了问题。它将 DLL 库的加载延迟到您手动执行的点，或者第一次调用它的函数时。因此，您只需在此之前将您的 DLL 路径添加到搜索路径，[SetDllDirectory](https://msdn.microsoft.com/en-us/library/windows/desktop/ms686203(v=vs.85).aspx "设置DLL目录")可以帮助您。

以下是使其工作的步骤：

1) 指定要延迟加载到链接器的 DLL，可以通过您的 makefile、cmake 或 VS 属性页 (Linker->Input of VS2015)

2) 在程序开始时调用[SetDllDirectory](https://msdn.microsoft.com/en-us/library/windows/desktop/ms686203(v=vs.85).aspx "设置DLL目录")，在调用 DLL 之前。

一直到 VC6 都支持延迟加载的 DLL。XP SP1 之后支持SetDllDirectory。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-06T21:17:25.373

## 使用指向第 3 方可执行文件的符号链接

我发现[Aaron Margosis](https://social.msdn.microsoft.com/profile/Aaron+Margosis)提倡的方法很有用。看：

> [使用 NTFS 连接修复 64 位版本 Windows 上的应用程序兼容性问题](https://blogs.msdn.microsoft.com/aaron_margosis/2012/12/09/using-ntfs-junctions-to-fix-application-compatibility-issues-on-64-bit-editions-of-windows/)

本质上，为每个相关的第 3 方可执行文件创建符号链接。将这些符号链接文件放在您自己的相关可执行文件中。除了对目标的文件名更改外，“软”符号链接将解决加载时依赖关系，即使链接的目标被未来的更新更改。

# javascript - javascript全局变量会破坏chrome

> ID：10606305
> 
> 赞同：0
> 
> 时间：2012-05-15T18:01:20.683
> 
> 标签：javascript, google-chrome, global-variables

我的 javascript 代码在 Firefox 上运行良好，但在 Chrome 上无法运行。它说我的名为 frames 的全局变量没有定义。我仔细检查了我的代码，没有任何问题。它在 Firefox 和其他浏览器上也能正常工作。

与chrome中的全局变量有什么关系吗？

.apsillers 是对的。问题解决了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:36:43.563

全局变量`frames`是预先存在的浏览器构造。（它实际上是 . 的别名`window`。）如果您正在创建一个名为 的新全局变量`frames`，那么您正在尝试破坏已经存在的变量。但是，Firefox 和 Internet Explorer 不允许您覆盖`frames`，而 Chrome 允许。您可能不小心破坏或重写了`frames`，但实际上只有 Chrome 允许您这样做。

如果您发布代码，我们可以确定。

# node.js - 使用 Node JS 的新手如何设置和获取 cookie

> ID：10606307
> 
> 赞同：1
> 
> 时间：2012-05-15T18:01:23.677
> 
> 标签：node.js

我是来自 python 的 nodejs 的新手。

下面是我在龙卷风中设置和获取 cookie 的标准脚本。

```
if not self.get_cookie('mdi'):
            self.cookie_id=str(uuid4())
            self.set_cookie('mdi', self.cookie_id, domain='mdi.com',expires_days=365*2)
        else:
            self.cookie_id = self.get_cookie('mdi') 
```

NodeJS中的等价物是什么。我使用 uuid4 在 python 中创建 cookie id。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:47:50.560

您可能希望对节点使用 Web 框架，例如[Express](http://expressjs.com/)（但还有[其他](https://github.com/joyent/node/wiki/Modules#wiki-web-frameworks-full)的）。

Express 提供 cookie 功能[`res.cookie`](http://expressjs.com/guide.html#res.cookie%28%29)。您可以执行以下操作：

```
app.get('/', function(req, res){
  res.cookie('rememberme', 'yes',
             { expires: new Date(Date.now() + 900000), httpOnly: true });
}); 
```

然后你可以像这样读回来：

```
app.use(express.cookieParser());

app.get('/', function(req, res){
  console.log(req.cookies.rememberme);
}); 
```

最后，您可以使用以下方法清除它：

```
res.clearCookie('rememberme'); 
```

# r - 将两个 xts 时间序列合并到一个流中

> ID：10606309
> 
> 赞同：2
> 
> 时间：2012-05-15T18:01:35.140
> 
> 标签：r, merge, time-series, xts

给定这 2 个 xts 对象：

```
> X
2012-02-01 09:31:40 2012-02-01 09:31:50 2012-02-01 09:33:30 
         -3.8993007          -2.0860621          -0.6308867
> Y
2012-02-01 09:32:00 2012-02-01 09:32:10 2012-02-01 09:32:20
          1.1983066          -0.2071149           0.3887806 
```

如何按时间加入它们并拥有一个索引为 9:31:40、9:31:50、9:32:00、9:32:10、9:32:20、9:33:30 的列对象? 也就是说，我需要在一个序列中流式传输两个对象（而不是将两列 X/Y 合并到一个组合矩阵中）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:08:26.907

```
> X <- xts(rnorm(1:10), Sys.time() + 1:10)
> Y <- xts(rnorm(1:10), Sys.time() - 10:1)
> rbind(X, Y)
                          [,1]
2012-05-15 13:07:25  1.1022975
2012-05-15 13:07:26 -0.4755931
2012-05-15 13:07:27 -0.7094400
2012-05-15 13:07:28 -0.5012581
2012-05-15 13:07:29 -1.6290935
2012-05-15 13:07:30 -1.1676193
2012-05-15 13:07:31 -2.1800396
2012-05-15 13:07:32 -1.3409932
2012-05-15 13:07:33 -0.2942939
2012-05-15 13:07:34 -0.4658975
2012-05-15 13:07:36  0.1340882
2012-05-15 13:07:37 -0.4906859
2012-05-15 13:07:38 -0.4405479
2012-05-15 13:07:39  0.4595894
2012-05-15 13:07:40 -0.6937202
2012-05-15 13:07:41 -1.4482049
2012-05-15 13:07:42  0.5747557
2012-05-15 13:07:43 -1.0236557
2012-05-15 13:07:44 -0.0151383
2012-05-15 13:07:45 -0.9359486 
```

# c# - 数据绑定语法错误

> ID：10606311
> 
> 赞同：0
> 
> 时间：2012-05-15T18:01:43.830
> 
> 标签：c#, asp.net, data-binding

我在asp.net 网页中有一个gridview。数据源来自 sql server 表。我希望每个单元格的最大长度小于 50。我遇到了错误。

感谢您帮助我修复它。

```
<asp:TemplateField HeaderText="OrgContactName" SortExpression="OrgContactName">
            <EditItemTemplate>
                <asp:TextBox ID="TextBox3" runat="server" Text='<%# Bind("OrgContactName") %>'></asp:TextBox>
            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label3" runat="server" Text='<%# (Eval("OrgContactName").Length>50)?Eval("OrgContactName").SubString(0,50):Eval("OrgContactName") %>'></asp:Label>
            </ItemTemplate>
        </asp:TemplateField> 
```

错误：

> 编译器错误消息：CS1061：“object”不包含“Length”的定义，并且找不到接受“object”类型的第一个参数的扩展方法“Length”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:08:09.503

您可以尝试 Eval("OrgContactName").toString().Length>50 .... 等 Eval 将返回一个对象，因此如果您想访问“Length”属性，您需要转换为 String。试试看。

# ssl - 将 SSL / HTTPS 与 Meteor 一起使用？

> ID：10606312
> 
> 赞同：5
> 
> 时间：2012-05-15T18:01:48.377
> 
> 标签：ssl, https, meteor

有没有人看过接受 HTTPS / SSL 与流星的连接？

道歉。

具体来说：如何设置流星以接受和使用 HTTPS 连接？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-14T21:33:58.910

是的 *

`HTTPS/SSL`添加了支持`v0.3.8`

*来源：[Github](https://github.com/meteor/meteor/blob/master/History.md)*

*更新：警告可能适用于一个人的用例。请参阅下面布雷特的评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T19:03:42.200

我不相信你可以在 Meteor 中使用 ssl 证书。您可以做的是在 Meteor 前面放置一个基于 node.js 的代理并以这种方式处理 ssl 连接。

# mysql - sqlfiddle 中的错误或者我不明白 INSERT ... ON DUPLICATE KEY UPDATE

> ID：10606325
> 
> 赞同：2
> 
> 时间：2012-05-15T18:02:21.053
> 
> 标签：mysql, sql, sqlfiddle

此 sqlfiddle 链接似乎在调用中保留状态： [http ://sqlfiddle.com/#!2/125bc/1](http://sqlfiddle.com/#!2/125bc/1)

它包含 mysql 的这个模式：

```
CREATE TABLE if not exists  `standings` (
  `teamid` int(11) NOT NULL,
  `win` decimal(23,0) default NULL,
  `tie` decimal(23,0) default NULL,
  `lose` decimal(23,0) default NULL,
  PRIMARY KEY  (`teamid`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

INSERT INTO `standings` (`teamid`, `win`, `tie`, `lose`) VALUES
(1, 3, 0, 0),
(2, 1, 1, 1),
(3, 1, 1, 1),
(4, 0, 0, 3);

CREATE TABLE if not exists `newscores` (
  `recordid` int(11) NOT NULL auto_increment,
  `teamid` int(11) NOT NULL,
  `gameid` int(11) NOT NULL,
  `totalstrokes` int(11) NOT NULL,
  primary key (recordid)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=5 ;

INSERT INTO `newscores` (`recordid`, `teamid`, `gameid`, `totalstrokes`) VALUES
(5, 1, 1, 145),
(6, 2, 1, 105),
(7, 5, 1, 145),
(8, 6, 1, 155); 
```

这两个查询：

```
Insert into  standings (teamid, win, tie, lose) (SELECT g1.teamid, SUM( IF( g1.totalstrokes < g2.totalstrokes, 1, 0 ) ) AS win, SUM( IF( g1.totalstrokes = g2.totalstrokes, 1, 0 ) ) AS tie, SUM( IF( g1.totalstrokes > g2.totalstrokes, 1, 0 ) ) AS lose
FROM newscores g1
JOIN newscores g2 ON g1.gameid = g2.gameid
AND g1.teamid != g2.teamid
GROUP BY g1.teamid) 
on duplicate key 
update win = win + values(win), 
lose = lose + values(lose), 
tie = tie + values(tie);

select * from standings; 
```

它应该导致这个`standings`表：

```
teamid   win tie lose
  1       4   1   1
  2       4   1   1
  3       1   1   1
  4       0   0   3
  5       1   1   1
  6       0   0   3 
```

它确实是第一次运行。第二次运行时（通过将 url 粘贴到新窗口中），teamids 1,2,5,6 的一些值会增加。

我可以通过编辑模式将“创建表”更改为“如果不存在表则创建”，反之亦然，或者包括“删除表”语句来重置它。但这似乎很奇怪。

PS如果有人比我在这个问题上添加了一个sqlfiddle标签，我将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-15T18:18:34.250

我是 SQL Fiddle 的作者。这种行为有一个非常简单的解释。本质上，您在右侧面板（“运行查询”侧）上运行的所有查询都在事务块中执行，该事务块立即回滚以保留模式的状态（由左侧定义控制板）。大多数情况下，所有内容都会返回到事情开始的确切位置，因为在事务中执行的大多数内容都可以回滚。然而，正如我在 SQL Fiddle 早期发现的那样，少数不会回滚的事情之一是自动递增 ID 值。这是所有供应商有意做出的设计决定，旨在确保您的主键永远不会因重用而发生冲突。

由于自动 id 应该是没有意义的，所以对于 SQL Fiddle 来说，这件事发生了变化（特别是因为大多数人无论如何都在左侧运行他们的插入）从来没有真正让我觉得这是一个问题。

顺便说一句，您无需打开多个窗口即可看到此行为 - 只需多次点击“运行查询”，您就会看到它发生了变化。您还可以使用我的 SQL Server 示例小提琴来查看它：[http](http://sqlfiddle.com/#!3/1fa93/1) ://sqlfiddle.com/#!3/1fa93/1 只需多次运行该查询，您就会看到 id 每次都发生变化。（如果有一段时间没有使用小提琴，它将重置，因为在特定小提琴未使用后我删除了正在运行的数据库以释放内存）。

*编辑*

嗬！抱歉，没有足够仔细地阅读您的查询。我现在明白发生了什么。您正在使用 MyISAM 表而不是 InnoDB。我真的需要禁用这些作为 MySQL 的选项。你看，他们根本不支持交易。因此，当我尝试回滚对这些表的更新时，更新根本不会回滚。你不断地增加它们。当我第一次推出 MySQL 作为一个选项时，我看到了这一点，因为默认情况下 MySQL 使用 MyISAM。我必须将默认值更改为 InnoDB 才能使事务正常工作。

当我简单地删除您对 MyISAM 的显式使用时，您可以在这里看到它工作正常：[http ://sqlfiddle.com/#!2/cec6e/1](http://sqlfiddle.com/#!2/cec6e/1)

*更新*

这是我重新安排的版本，由于对 MySQL 的一些更改要求：[http ://sqlfiddle.com/#!2/a9cc3/1](http://sqlfiddle.com/#!2/a9cc3/1)

# .net - 为什么.net 中没有异步文件删除？

> ID：10606328
> 
> 赞同：58
> 
> 时间：2012-05-15T18:02:26.263
> 
> 标签：.net, file-io, asynchronous

你有读写的异步版本（开始/结束函数），但没有删除（我可以告诉你）。这有什么原因吗？没有像读/写那样异步删除的理由吗？

使用线程来模拟异步行为与异步函数不同。很大的不同，确保你得到了感知的并行处理，但它并没有真正防止阻塞，其他线程仍然被阻塞等待文件 i/o 完成。真正的异步函数（开始/结束函数）在系统级别运行，它们将文件 i/o 排队，让应用程序继续，并让应用程序知道它何时准备好继续文件 i/o（允许您在等待文件 i/o 可用时做其他事情）。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-05-15T19:25:59.837

这会很有用。如果在断开连接的网络共享上删除，DeleteFile 最多可能需要 30 秒。

原因很可能是没有异步删除文件的原生函数。托管 API 通常是非托管 API 的包装器。

* * *

现在为什么没有原生的异步文件删除 API？原生异步删除很难在 Windows 上实现。`DeleteFile`在伪代码中`CreateFile`加上`NtSetInformationFile(Disposition, Delete)`plus `CloseHandle`。没有异步`CreateFile`（在我看来是 Windows 中的设计错误）。`NtSetInformationFile`只需在内核中的文件数据结构上设置一个标志。它不能是异步的。实际删除发生在最后一个句柄关闭时。我认为这可能会导致`CloseHandle`阻塞，这是 Windows 中的另一个设计问题。没有 async `CloseHandle`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-15T19:40:36.830

这个怎么样：

```
public static class FileExtensions {
   public static Task DeleteAsync(this FileInfo fi) {
      return Task.Factory.StartNew(() => fi.Delete() );
   }
} 
```

然后你可以这样做：

```
FileInfo fi = new FileInfo(fileName);
await fi.DeleteAsync(); // C# 5
fi.DeleteAsync().Wait(); // C# 4 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-01-06T11:32:31.407

该类`File`不公开异步文件删除方法；但是，通过使用`FileStream`该类，仍然可以利用提供的 13 个构造函数重载中的特定一个来执行异步文件删除。以下代码将异步删除文件：

```
using (new FileStream(Path, FileMode.Open, FileAccess.Read, FileShare.None, 1, FileOptions.DeleteOnClose | FileOptions.Asynchronous)) ; 
```

我没有对它进行太多测试，因此您可能需要稍微修改一下用法。`FileShare.None`（如果在删除期间不应阻止其他线程的文件访问，您可能需要更改为其他内容。）此外，由于此代码不返回 Task 的任何派生，因此使用该`Task.Run`方法运行它可能是有效的。基本上，它执行的文件删除实际上在 I/O 级别上是异步的，因此在这种情况下将其卸载到线程池应该是可以的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-10-12T00:14:25.877

如果没有其他东西打开文件，打开`FileStream`with`FileOptions.DeleteOnClose`将导致 Windows 在流关闭时删除文件。如果您已经打开 a`FileStream`进行异步读/写，这可能会对您有所帮助，但如果您需要等待删除完成它对您没有帮助（尽管根据 @JoelFan 等待`File.Delete`完成并不能保证文件实际上已被删除）。

有趣的是，在针对网络共享进行测试时，似乎像这样打开流并且什么都不做比`File.Delete`：

```
using (new FileStream(filename, FileMode.Open, FileAccess.Read, FileShare.None, 4096, FileOptions.DeleteOnClose)) { } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T19:19:52.577

我可能是错的，但如果有人试图在跨线程操作上访问同一个文件，则需要阻止文件访问，直到删除操作完成。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2012-05-15T19:39:03.720

也许是因为您自己也可以轻松地做到这一点？

```
var t = Task.Factory.StartNew(() => File.Delete("file.txt"));
// ...
t.Wait(); 
```

# jquery - 使用 jQuery 弹跳图像

> ID：10606329
> 
> 赞同：3
> 
> 时间：2012-05-15T18:02:30.663
> 
> 标签：jquery, css

我正在尝试使一些图像“反弹”。

[http://jsfiddle.net/d7UjD/43/](http://jsfiddle.net/d7UjD/43/)

```
$('#bbb').mouseenter(function() {
    $(this).stop().effect('bounce',500);
});
$('#bbb').mouseleave(function() {
    $(this).stop(true,true);
});
$('#target').mouseenter(function() {
    $(this).stop().effect('bounce',500);
});
$('#target').mouseleave(function() {
    $(this).stop(true,true);
});
$('#sears').mouseenter(function() {
    $(this).stop().effect('bounce',500);
});
$('#sears').mouseleave(function() {
    $(this).stop(true,true);
}); 
```

```
<div id="RegStores">
    <a href="http://www.bedbathandbeyond.com/regGiftRegistry.asp?wrn=-1824276933&amp;" target="_new"><img src="http://www.dkg2012.com/img/bbb.png" id="bbb" width="144" height="48" border="0" /></a>
    <a href="http://www.target.com/RegistryGiftGiverCmd?isPreview=false&amp;status=completePageLink&amp;listId=HCoY5fRCrcOOxRCdNn3i6g&amp;registryType=WD&amp;isAjax=false" target="_new"><img src="http://www.dkg2012.com/img/target.png" id="target" width="143" height="34" border="0" style="padding-left: 10px; padding-bottom: 5px;" /></a>
    <a href="http://www.sears.com/shc/s/GRManageView?storeId=10153&amp;catalogId=12605&amp;langId=&amp;externalId=900040792636010101&amp;grUserType=BUYER&amp;fwdURL=GRGuestRegistryView&amp;sortType=category" target="_new"><img src="http://www.dkg2012.com/img/sears.png" width="142" height="40" border="0" id="sears" style="padding-left: 10px;" /></a>
</div> 
```

```
#RegStores {
    position:absolute;
    bottom:10px;
    left:23px;
    width:467px;
    height:50px;
    z-index:30;
} 
```

如何在**不**使其他图像向下移动的情况下使其正常工作。而且，当您在图像上快速移动鼠标时，它会导致图像不断向上移动 - 我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:20:05.680

我在评论中的意思是动画正在这样做（即添加`display: block`）..实际上它并没有真正添加它本身，而是将项目包装在一个 div 中进行动画处理。您可以添加`.ui-effects-wrap { display: inline-block; }`以解决此问题：

[http://jsfiddle.net/d7UjD/46/](http://jsfiddle.net/d7UjD/46/)

但是，这仅适用于支持该功能的浏览器，因此您可能必须改用浮点数。您可能还应该使用更具体的规则（例如，将所有这些都包装在自己的 div 中），这样您就不会影响使用该类的其他效果。理想情况下，jQuery 也有办法改变包装类。我无法想象它没有..

编辑：在被 Good Guy Greg 斥责没有回答多部分问题的所有部分之后，我在这里创建了一个更新：

[http://jsfiddle.net/d7UjD/47/](http://jsfiddle.net/d7UjD/47/)

这将防止图像在已经动画时在悬停时动画。就个人而言，这对我来说是最理想的，但如果你想在鼠标移出（对我没有意义）或鼠标悬停时停止动画，你将不得不做其他事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:37:07.813

这是一个主要修复了将其推向顶部的能力。我通过在鼠标移出时将 ti 动画化回其起始位置来做到这一点。还做了一些其他的改进。值得注意的是，切换到`hover`每个链接并将一个类应用于每个链接，而不是为每个链接使用单独的事件绑定器。

[http://jsfiddle.net/EcN2h/2/](http://jsfiddle.net/EcN2h/2/)

```
$('.bounce').hover(function() {
    $('img', this).stop(true, true).effect('bounce', 500);
}, function() {
    $('img', this).stop(true, true) );
});
​ 
```

​</p>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:25:24.107

这是一个建议。我把它放在这里是因为它在评论中看起来不漂亮

```
$('#bbb,#target,#sears').mouseenter(function() {
    $(this).stop().effect('bounce',500);
});
$('#bbb,#target,#sears').mouseleave(function() {
    $(this).stop(true,true);
}); 
```

您可以像这样缩短代码。

# wordpress - 主页登录也将用户登录到 Wordpress 部分

> ID：10606330
> 
> 赞同：0
> 
> 时间：2012-05-15T18:02:34.710
> 
> 标签：wordpress, login, dreamweaver

我们有一个站点，其中包含仅限成员的部分和 WordPress 在子目录中。一些仅限会员的页面、表格等在 WP 之外。我们使用 Dreamweaver 5.5 在我们的主页上创建了一个会员登录表单。有没有办法让 WordPress 接受该主登录，以便会员在进入 WP 会员专用页面时无需再次登录？感谢您为我指明正确方向的任何帮助。我知道足够多的 PHP 是危险的。如果您想查看 DW 登录代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:00:11.667

是的，您正在谈论为 Wordpress 页面创建自己的自定义模板。

您可以通过将扩展名重命名为 .php 来使用从 Dreamweaver 生成的页面，除非它已经是。将其移至 /wp-content/themes/yourtheme 文件夹，其中 yourtheme 是您当前活动的主题。在模板的顶部，添加以下行：

```
<?php
//
// Template Name: Login Form
//
?> 
```

转到 Wordpress 仪表板 > 页面 > 添加新的。添加一个名为“登录”或任何您需要的页面，选择“登录表单”作为页面属性下的模板，然后发布。

参考：[http ://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

# .htaccess - RewriteCond 附加查询字符串

> ID：10606331
> 
> 赞同：0
> 
> 时间：2012-05-15T18:02:35.037
> 
> 标签：.htaccess, mod-rewrite

我正在使用 .htaccess 文件将我存档的旧 aspx url 重定向到我的新 php 站点。现在要求如下： example.com/showad.aspx?adid=1234 应该是 example.com/ad/getad/1234 我google了一下，得到了以下htaccess规则：

```
RewriteCond %{QUERY_STRING} ^adid=(\d+)$
RewriteRule ^showad\.aspx$ /ad/getad/%1 
```

该规则有效，除了生成的 url 是 example.com/ad/getad/1234?adid=1234 我再次搜索并了解到要删除输出 url 末尾的 (adid=1234) 你应该放置一个问号？在替换参数的末尾，因此规则应为：

```
RewriteCond %{QUERY_STRING} ^adid=(\d+)$
RewriteRule ^showad\.aspx$ /ad/getad/%1? 
```

但它不起作用！结果 url 仍然附加了原始查询字符串。我正在使用这个站点来测试我的 htaccess 规则：htaccess.madewithlove.be 任何线索为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:24:06.753

你的规则很好 - 我只是在我自己的 .htaccess 中测试了它。这是错误的htaccess测试器网站:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:57:41.380

尝试将您的规则更改为

```
RewriteRule ^showad\.aspx$ /ad/getad/%1? [R=302,L] 
```

# c# - 使用 PrincipalSearcher 查找带有“或”参数的用户

> ID：10606334
> 
> 赞同：32
> 
> 时间：2012-05-15T18:02:38.090
> 
> 标签：c#, .net, active-directory

是否可以`System.DirectoryServices.AccountManagement.PrincipalSearcher`使用“或”（不是“和”）基于多个参数进行搜索。

IE

```
// This uses an and
//(&(objectCategory=person)(!UserAccountControl:1.2.840.113556.1.4.803:=2)(&(SAMAccountName=tom*)(DisplayName=tom*)))
var searchPrinciple = new UserPrincipal(context);
searchPrinciple.DisplayName =  "tom*";
searchPrinciple.SamAccountName = "tom*";

var searcher = new PrincipalSearcher();
searcher.QueryFilter = searchPrinciple;

var results = searcher.FindAll(); 
```

`PrincipalSearcher`我想使用(not `DirectorySearcher`)进行类似的搜索（在 LDAP 中）

```
// (&(objectCategory=person)(!UserAccountControl:1.2.840.113556.1.4.803:=2)(|(SAMAccountName=tom*)(DisplayName=tom*))) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-12-18T10:30:42.537

这显然是不可能的，这里有一个解决方法：

```
List<UserPrincipal> searchPrinciples = new List<UserPrincipal>();
searchPrinciples.Add(new UserPrincipal(context) { DisplayName="tom*"});
searchPrinciples.Add(new UserPrincipal(context) { SamAccountName = "tom*" });
searchPrinciples.Add(new UserPrincipal(context) { MiddleName = "tom*" });
searchPrinciples.Add(new UserPrincipal(context) { GivenName = "tom*" });

List<Principal> results = new List<Principal>();
var searcher = new PrincipalSearcher();
foreach (var item in searchPrinciples)
{
    searcher = new PrincipalSearcher(item);
    results.AddRange(searcher.FindAll());
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-22T17:05:01.567

不一定像其他一些答案那样干净，但这是我在我正在从事的项目中实现这一点的方式。我希望两个搜索都异步运行，以尝试减少由于运行两个 AD 查询而导致的任何减速。

```
public async static Task<List<ADUserEntity>> FindUsers(String searchString)
{
    searchString = String.Format("*{0}*", searchString);
    List<ADUserEntity> users = new List<ADUserEntity>();

    using (UserPrincipal searchMaskDisplayname = new UserPrincipal(domainContext) { DisplayName = searchString })
    using (UserPrincipal searchMaskUsername = new UserPrincipal(domainContext) { SamAccountName = searchString })
    using (PrincipalSearcher searcherDisplayname = new PrincipalSearcher(searchMaskDisplayname))
    using (PrincipalSearcher searcherUsername = new PrincipalSearcher(searchMaskUsername))
    using (Task<PrincipalSearchResult<Principal>> taskDisplayname = Task.Run<PrincipalSearchResult<Principal>>(() => searcherDisplayname.FindAll()))
    using (Task<PrincipalSearchResult<Principal>> taskUsername = Task.Run<PrincipalSearchResult<Principal>>(() => searcherUsername.FindAll()))
    {
        foreach (UserPrincipal userPrincipal in (await taskDisplayname).Union(await taskUsername))
            using (userPrincipal)
            {
                users.Add(new ADUserEntity(userPrincipal));
            }
    }

    return users.Distinct().ToList();
} 
```

我的 ADUserEntity 类具有基于 SID 的相等性检查。我试图将`Distinct()`on 添加到`Union()`两个搜索结果中，但没有奏效。

我欢迎对我的回答提出任何建设性的批评，因为我想知道是否有任何方法可以改进它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-09T11:54:22.440

我知道这有点晚了，但这是我在搜索 AD 时使用的结构：

```
public static Task<IEnumerable<SomeUserModelClass>> GetUsers(//Whatever filters you want)
{
    return Task.Run(() =>
    {
        PrincipalContext context = new PrincipalContext(ContextType.Domain);
        UserPrincipal principal = new UserPrincipal(context);
        principal.Enabled = true;
        PrincipalSearcher searcher = new PrincipalSearcher(principal);

        var users = searcher.FindAll().Cast<UserPrincipal>()
            .Where(x => x.SomeProperty... // Perform queries)
            .Select(x => new SomeUserModelClass
            {
                userName = x.SamAccountName,
                email = x.UserPrincipalName,
                guid = x.Guid.Value
            }).OrderBy(x => x.userName).AsEnumerable();

        return users;
    });
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-05-15T18:12:49.003

> FindAll 方法在主体上下文中指定的域中搜索与**查询过滤器上设置的属性相同的对象**。FindAll 方法返回与提供的对象匹配的所有对象，而 FindOne 方法仅返回一个匹配的主体对象。 [http://msdn.microsoft.com/en-us/library/bb384378(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb384378(v=vs.90).aspx)

我不知道您需要什么，但您可以按 1 个属性和 1 个其他属性进行搜索，然后在列表中使用 LINQ 进行合并、过滤等...

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2015-08-26T12:47:40.153

```
PrincipalContext pContext = new PrincipalContext(ContextType.Machine, Environment.MachineName);
GroupPrincipal gp = GroupPrincipal.FindByIdentity(pContext, "Administrators");
bool isMember = UserPrincipal.Current.IsMemberOf(gp); 
```

# multithreading - Netty 线程执行 - MemoryAwareThreadPoolExecutor

> ID：10606336
> 
> 赞同：0
> 
> 时间：2012-05-15T18:02:44.923
> 
> 标签：multithreading, asynchronous, event-handling, threadpool, netty

在memoryawarethreadpoolexecutor的文档中

[http://docs.jboss.org/netty/3.2/api/org/jboss/netty/handler/execution/MemoryAwareThreadPoolExecutor.html](http://docs.jboss.org/netty/3.2/api/org/jboss/netty/handler/execution/MemoryAwareThreadPoolExecutor.html)

在事件执行顺序下，他提到

线程 X：--- 通道 A（事件 2）--- 通道 A（事件 1）---------------------------->

线程 Y：--- 通道 A（事件 3）--- 通道 B（事件 2）--- 通道 B（事件 3）--->

线程 Z：--- 通道 B（事件 1） --- 通道 B（事件 4） --- 通道 A（事件 4） --->

Channel A（Event 1，Event 2），Channel A（Event 3）如何由两个线程X，Y处理。

根据我的理解，单个 netty 工作线程可以为许多客户端进行处理，但是对于客户端，它的所有事件（1 ,2 3）必须由同一个工作线程处理，对吗？怎么可能改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:46:08.603

请注意，在这种情况下，事件不再由 Netty 工作线程池处理。事件被移交给另一个线程池，并且无法保证何时执行任务，即使对于同一通道也是如此。通道 A 可以交出分配给线程 X 的事件 1，线程 X 被抢占，然后通道 A 交出由线程 Y 立即执行的事件 2，之后线程 X 再次启动并执行事件 1。

但是，我同意图中线程 X 的时间线很奇怪，因为它自然会按顺序从内部队列中挑选任务。但是，我推测，不能保证 ThreadPoolExecutor 中排队的任务的顺序。队列通常是先进先出的，但它们并非必须如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T07:24:26.220

完全正确..一旦使用 ExecutorHandler，相同的“每个通道线程”可能不再适用。

# asp.net-mvc-3 - 如何实现 MVC3 模型 URL 验证？

> ID：10606340
> 
> 赞同：4
> 
> 时间：2012-05-15T18:02:55.457
> 
> 标签：asp.net-mvc-3, validation

我已经成功实现了客户端验证，要求在我的文本框中输入。但是，我想评估文本框的内容以查看它是否是格式正确的 URL。到目前为止，这是我所拥有的：Index.cshtml：

```
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery-1.5.1.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.validate.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")"></script>
@model Ticket911.Models.ValidationModel                          
@{
ViewBag.Title = "Home Page";
}

<h2>@ViewBag.Message</h2>
@using (Ajax.BeginForm("Form", new AjaxOptions() { UpdateTargetId = "FormContainer" , OnSuccess = "$.validator.unobtrusive.parse('form');" }))

{
<p>
    Error Message: @Html.ValidationMessageFor(m => m.URL)
</p>
<p>
@Html.LabelFor(m =>m.URL):
@Html.EditorFor(m => m.URL)
</p>
<input type="submit" value="Submit" /> 
```

验证模型：

```
 public class ValidURLAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        return (value != null);
    }
}

public class ValidationModel
{
    [Required]
    public string URL {get; set;}
} 
```

如何确保模型 URL 验证发生？单击提交按钮时，必须执行什么操作才能导航到输入到文本框中的 URL？

非常感谢：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:11:56.437

你可以这样做`DataAnnotations`

```
public class ValidationModel
{
  [Required]
  [RegularExpression(@"^http(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\'\/\\\+&amp;%\$#_]*)?$", ErrorMessage = "URL format is wrong")]
  public string URL {get; set;}
} 
```

在您的`HTTPPost`Action 方法中，您可以调用`ModelState.IsValid`将为您检查验证的属性。

```
[HttpPost]
public ActionResult Save(ValidationModel model)
{
  if(ModelState.IsValid)
  {
   //Save or whatever
  }
  return View(model);

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T15:05:52.853

好的方法是实现您的属性以供下次在 mvc 项目中使用。像这样：

```
public class UrlAttribute : RegularExpressionAttribute
{
    public UrlAttribute() : base(@"^http(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\'\/\\\+&amp;%\$#_]*)?$")
    {}
} 
```

等等模型：

```
[Url(ErrorMessage = "URL format is wrong!")]
public string BlogAddress { get; set; } 
```

# mysql - 将文件加载到mysql

> ID：10606343
> 
> 赞同：0
> 
> 时间：2012-05-15T18:03:08.043
> 
> 标签：mysql

我需要将制表符分隔的文件加载到 mysql 数据库中。我的数据库设置了以下列：ID;A;B;C;D;E，我的文件是列 ID 和 D 的转储。如何将此文件加载到我的数据库中并仅替换列 ID 和 D更改列 C 和 E 的值。当我现在加载它时，列 C 和 E 更改为 DEFAULT:NULL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:15:30.367

[我已经在这里](https://stackoverflow.com/questions/10572615/php-save-multiple-rows-from-csv-to-mysql/10572652#10572652)回答了类似的问题，但在您的情况下，您希望将 csv 加载到临时表中，然后使用简单的更新 SQL 语句将特定列从临时表更新到生产表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:07:40.220

您可以使用以下命令更新特定列：

```
UPDATE the_table
SET D=<value-of-D>
WHERE ID=<value-of-ID> 
```

然后对制表符分隔文件中的每一行运行此命令，替换每个行的 D 和 ID 值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:26:55.650

您可以使用存储过程或 PHP 程序来完成需要的工作。

对于 MySQL，SP 需要使用[load_file()](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_load-file)打开文件并将值存储在变量中。然后程序需要通过查找代表新行的“\n”来循环以获取字符串中的整行。

然后程序需要使用[locate()](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_locate)找到第一个制表符位置，并使用[substring()](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr)获取第一个 ID col。然后程序需要使用locate() 及其第三个参数找到第4 个选项卡，即另外3 个选项卡。这将是 D 列的起始位置。然后使用 locate() 及其第三个参数再次找到下一个制表符，这将为您提供 D 列的结束字符。使用 substring() 获取 D 列的内容。使用 update 命令更新行的 D 列，使用 ID 作为 where 子句中的搜索键。

由于上述内容将遍历所有行，因此您将更新所有数据行。

# java - 如何仅从上次通话中删除日志？

> ID：10606344
> 
> 赞同：1
> 
> 时间：2012-05-15T18:03:10.943
> 
> 标签：java, android, string

使用下面的代码，我可以删除来​​自特定号码的呼叫，这很好，只是速度很慢，并且在代码运行时应用程序变得无响应（特别是如果日志中有很多呼叫）

所以我真正想要的是它只检查日志中的最后一个调用，而不是通过漏洞日志。

```
String strUriCalls = "content://call_log/calls";
    Uri UriCalls = Uri.parse(strUriCalls);
    Cursor c = context.getContentResolver().query(UriCalls, null, null,
            null, null);
    if (c.getCount() <= 0) {
        Toast.makeText(context, "Call log empty", Toast.LENGTH_SHORT)
                .show();
    }

    while (c.moveToNext()) {
        SharedPreferences sp = PreferenceManager
                .getDefaultSharedPreferences(context);
        String gonnabprefd = sp.getString("callerase", null);
        String[] numarry = gonnabprefd.split(" ");
        for (int i = 0; i < numarry.length; i++) {
            String gonnabpref = numarry[i];
            String queryString = "NUMBER='" + gonnabpref + "'";
            Log.v("Numberimcomingreciver ", queryString);
            int b = context.getContentResolver().delete(UriCalls,
                    queryString, null);
            if (b >= 1) {
                Toast.makeText(context, "deleted", Toast.LENGTH_LONG)
                        .show();}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:59:31.287

讨厌回答我自己的问题，但删除

```
while (c.moveToNext()) { 
```

工作过

# ios - iOS：定位服务列表中缺少应用程序

> ID：10606349
> 
> 赞同：2
> 
> 时间：2012-05-15T18:03:33.010
> 
> 标签：ios, location

我的应用程序使用 iPhone 的 GPS 功能，它之前运行良好，因为它提示用户允许使用定位服务，并显示在设置 > 定位服务列表下。我从应用商店卸载并重新下载了该应用，但它不再执行其中任何一个。该应用程序是同一版本，并且有一段时间没有更新，但问题是最近开始的。

该问题已在运行不同操作系统 (iOS 4-5) 的多个设备 (iPhone 3GS、iPhone 4、iPhone 4S) 中发现。Apple 最近是否改变了定位服务的工作方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-28T09:06:22.003

这同样发生在我身上，我不知道为什么。要将应用程序恢复到位置服务列表，您需要关闭主位置服务开关，然后一一运行所有应用程序。每个需要启用位置服务的应用程序都会要求您启用此服务并将其自身添加到列表中。

# java - 使用元字符正则表达式模式执行多个字符串替换

> ID：10606356
> 
> 赞同：1
> 
> 时间：2012-05-15T18:04:01.973
> 
> 标签：java, regex

我正在尝试使用 Java 的 Pattern 和 Matcher 执行多个字符串替换，其中正则表达式模式可能包含元字符（例如 \b、() 等）。例如，对于输入 string `fit i am`，我想应用替换：

```
\bi\b --> EYE
i     --> I 
```

然后我遵循了两个问题的编码模式（[Java Replacing multiple different substrings in a string](https://stackoverflow.com/questions/1326682/java-replacing-multiple-different-substring-in-a-string-at-once-or-in-the-most)，[Replacing multiple substrings in Java when replacement text overlays search text](https://stackoverflow.com/questions/7532042/replacing-multiple-substrings-in-java-when-replacement-text-overlaps-search-text)）。在两者中，他们创建了一个 or'ed 搜索模式（例如 foo|bar）和一个（模式，替换）的映射，并且在`matcher.find()`循环内部，他们查找并应用替换。

我遇到的问题是该`matcher.group()`函数不包含有关匹配元字符的信息，因此我无法区分`i`和`\bi\b`。请看下面的代码。我能做些什么来解决这个问题？

```
import java.util.regex.Matcher;    
import java.util.regex.Pattern;
import java.util.*;

public class ReplacementExample
{
    public static void main(String argv[])
    {
        Map<String, String> replacements = new HashMap<String, String>();
        replacements.put("\\bi\\b", "EYE");
        replacements.put("i", "I");

        String input = "fit i am";

        String result = doit(input, replacements);

        System.out.printf("%s\n", result);
    }

    public static String doit(String input, Map<String, String> replacements)
    {
        String patternString = join(replacements.keySet(), "|");
        Pattern pattern = Pattern.compile(patternString);
        Matcher matcher = pattern.matcher(input);
        StringBuffer resultStringBuffer = new StringBuffer();

        while (matcher.find())
        {
            System.out.printf("match found: %s at start: %d, end: %d\n",
                matcher.group(), matcher.start(), matcher.end());

            String matchedPattern = matcher.group();
            String replaceWith = replacements.get(matchedPattern);

            // Do the replacement here.
            matcher.appendReplacement(resultStringBuffer, replaceWith);
        }

        matcher.appendTail(resultStringBuffer);

        return resultStringBuffer.toString();
    }

    private static String join(Set<String> set, String delimiter)
    {
        StringBuilder sb = new StringBuilder();
        int numElements = set.size();
        int i = 0;

        for (String s : set)
        {
            sb.append(Pattern.quote(s));
            if (i++ < numElements-1) { sb.append(delimiter); }
        }

        return sb.toString();
    }
} 
```

这打印出来：

```
match found: i at start: 1, end: 2
match found: i at start: 4, end: 5
fIt I am 
```

理想情况下，它应该是`fIt EYE am`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:31:45.907

您输入错误的正则表达式之一：

```
 replacements.put("\\bi\\", "EYE"); //Should be \\bi\\b
    replacements.put("i", "I"); 
```

您可能还想让您的正则表达式独一无二。map.getKeySet() 不能保证顺序，因此它可能只是在检查之前将 i 替换为 I `\\bi\\b`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:55:49.397

您可以使用捕获组，而不会偏离您现有的设计太远。因此，您无需使用匹配的模式作为键，而是根据列表中的顺序进行查找。

您需要更改*join*方法以在每个模式周围加上括号，如下所示：

```
private static String join(Set<String> set, String delimiter) {
    StringBuilder sb = new StringBuilder();
    sb.append("(");
    int numElements = set.size();
    int i = 0;
    for (String s : set) {
        sb.append(s);
        if (i++ < numElements - 1) {
            sb.append(")");
            sb.append(delimiter);
            sb.append("(");         }
    }
    sb.append(")");
    return sb.toString();
} 
```

附带说明一下，在原始代码清单中使用 Pattern.quote 会导致匹配在存在这些元字符的地方失败。

完成此操作后，您现在需要确定哪个捕获组负责匹配。为简单起见，我将假设所有匹配模式本身都不会包含捕获组，在这种情况下，在匹配器 while 循环中，这样的事情会起作用：

```
 int index = -1;
        for (int j=1;j<=replacements.size();j++){
            if (matcher.group(j) != null) {
                index = j;
                break;
            }

        }
        if (index >= 0) {
            System.out.printf("Match on index %d = %s %d %d\n", index, matcher.group(index), matcher.start(index), matcher.end(index));
        } 
```

接下来，我们想使用生成的索引值直接索引到替换中。原代码使用了HashMap，不适合这个；您将不得不对其进行重构，以便以某种形式使用一对列表，一个包含匹配模式列表，另一个包含相应的替换字符串列表。我不会在这里这样做，但我希望能提供足够的细节来创建一个可行的解决方案。

# matlab - 什么导致 MATLAB 中的文件标识符无效？

> ID：10606373
> 
> 赞同：6
> 
> 时间：2012-05-15T18:04:59.153
> 
> 标签：matlab, fopen

我有一个 MATLAB 脚本，我可以发誓上次使用它时（一年前）运行良好。现在，我收到此错误：

```
Invalid file identifier.  Use fopen to generate a valid file identifier. 
```

如果我理解正确，它将无法找到或打开（？）脚本中其他地方指定的文件。这是正确的吗？如果是这样，可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-15T18:20:04.093

`fid`（文件标识符）是`fopen`. 它是一个整数，但与文件无关。您需要使用`fopen`来获取`fid`. 在我看来，您`fid`在某些与文件相关的 I/O 命令中使用了不正确的（文件标识符），例如`fread`,`fscanf`或`fclose`. 不成功的`fopen`给予`fid`。`-1`对于任何有效的正常文件，成功`fopen`将给出`fid`is`3`或更大的整数。

However, without any code it's impossible to say where or what the bug or error is. You could use MATLAB debugger to single-step the code from relevant `fopen` (set breakpoint there and run your program) until the relevant `fclose` and see if `fid` (or whatever variable name you use for file identifier) or any data structure for your file identifiers (if have more than one file identifier in your code) changes in any point between relevant `fopen` and `fclose`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-24T06:14:40.390

我通过向**fopen添加*****权限*选项**为自己解决了这个问题。正如您在[http://www.mathworks.se/help/matlab/ref/fopen.html](http://www.mathworks.se/help/matlab/ref/fopen.html)中看到的，fopen 语法是：

 **```
fileID = fopen(filename,permission) 
```

可能的权限，例如：'r'（默认）| 'w' | '一个' | 'r+' | 'w+' | '一个+' | ...

'r' - 打开文件进行读取。

'w' - 打开或创建新文件以进行写入。丢弃现有内容（如果有）。

'a' - 打开或创建新文件以进行写入。将数据附加到文件末尾。

'r+' - 打开文件进行读写。

'w+' - 打开或创建新文件进行读写。丢弃现有内容（如果有）。

'a+' - 打开或创建新文件以进行读写。将数据附加到文件末尾。

...

如果我使用 fopen without permission 选项，或者如果我使用 'r' （默认）选项，fopen 将返回 -1，这是错误的。我成功了：

```
fid=fopen('tmp.txt', 'w');
fid=fopen('tmp.txt', 'a'); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-19T08:21:49.073

我有这个问题。原来我试图写入的文件太大（我没有足够的可用空间来容纳它）。但是，直到调用 fclose，程序才失败。非常混乱！

尝试释放一些空间或编写一个非常小的文件来测试此诊断。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-31T12:58:35.813

我在尝试打开 ASF 工具箱演示时遇到了同样的问题。以管理员身份运行 Matlab（右键单击打开）似乎为我解决了这个问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-06-13T16:01:15.537

`fopen`可能会失败，因为 MATLAB 没有读取/写入您指定的文件的权限。

尝试在您/MATLAB 拥有所有权限的位置（取决于您的操作系统）打开文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-12T00:00:34.117

我已经`fopen`获得许可使用并且出现了同样的错误。但是，我**以管理员身份启动了 MATLAB**，这解决了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-26T20:31:36.727

我在 excel 中打开了文件，结果 fopen 返回了 -1。花了我很长时间才找到这么一个微不足道的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-13T12:12:28.767

尝试在不存在的目录中创建文件时也会发生这种情况。`mkdir('folderName')`在 MATLAB 中尝试或只是预先创建目录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-28T13:31:07.940

对于我的情况，我已经检查了所有内容，但错过了一个简单的步骤。

在运行“fopen”代码之前，请选择“浏览您的文件夹”并浏览您当前的文档位置。

[![在此处输入图像描述](../Images/9515183fe6903843feee3c39401fc275.png)](https://i.stack.imgur.com/dSMBe.jpg)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-17T12:48:03.050

开头带有正斜杠的路径可能会导致相同的错误。

```
filename = '/data/myfile.txt'; 
```

抛出此错误，而

```
filename = 'data/myfile.txt'; 
```

不会产生错误。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2015-04-16T14:52:24.433

当脚本试图读取文件末尾之外的内容时也会发生这种情况。**

# profiling - 从 ifort 11.1 构建的分析代码产生 __powr8i4 例程，它是什么？

> ID：10606374
> 
> 赞同：1
> 
> 时间：2012-05-15T18:05:03.573
> 
> 标签：profiling, intel-fortran

我用 Intel 11.1 构建了一个 Fortran 代码。我使用 -p 选项构建它以生成分析数据。当我检查这些结果时，存在一些不属于我的代码的例程。我想它们是由英特尔放在那里的。其中包括：

```
__powr8i4
__intel_new_memset
__intel_fast_memset
__intel_fast_memset.J
__intel_fast_memcpy
__intel_new_memcpy
__intel_fast_memcpy.J 
```

还有其他人。当我在没有优化的情况下构建代码时，代码不会在其中花费太多时间。除了结果显示 __powr8i4 的使用率为 3.3%。但是，当我使用优化构建代码时，这个数字会上升到大约 35%。我似乎无法找出这些例程是什么，但它们使我的结果感到困惑，因为我想知道在哪里优化我的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T17:13:53.550

大多数程序在调用子例程（通常是库子例程）上花费了很多周期，因此如果您只查看独占（自身）时间，您将看到您所看到的。

*   因此，第 1 点是查看包容性（自我加被调用者）时间。

现在，如果分析器是“CPU 分析器”，它可能对 I/O 时间视而不见。这意味着你的程序可能大部分时间都在阅读或写作，但分析器不会给你任何线索。

*   所以第 2 点是使用一个在“挂钟”时间而不是“CPU”时间上工作的分析器，除非你确定你没有做太多的 I/O。（有时你认为你不是在做 I/O，而是在一些子程序层的深处，你猜怎么着——它在做 I/O。）

许多分析器试图生成一个调用图，如果你的程序不包含递归，并且如果分析器可以访问你代码中的所有例程，这可能有助于识别代码中占很多的子例程调用的时间。但是，如果例程 A 很大并且在多个位置调用 B，则分析器不会告诉您要查看哪些代码行。

*   第 3 点是使用分析器，如果可能的话，它会为您提供行级包含时间百分比。（百分比是最有用的数字，因为它告诉您如果可以以某种方式删除该行代码，您将节省多少总时间。此外，它不会受到系统中竞争进程的太大影响。）此类分析器的一个示例是[*缩放*](http://www.rotateright.com/)。

可能是在你完成所有这些之后，你看不到你可以做多少来加速代码。但是，如果您可以看到数据的某些属性如何影响性能，您可能会发现可以获得进一步的加速。探查器无法查看数据。

*   我所做的是在调试器下[随机采样](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)程序的状态，看看我是否能真正理解它在每个样本中所做的事情。你可以找到其他方式找不到的东西。（有些人说这不*准确*，但它是准确的——关于什么是重要的。重要的是问题是什么，而不是确切的成本。）这就是第 4 点。

# javascript - IE9 内存泄漏

> ID：10606375
> 
> 赞同：6
> 
> 时间：2012-05-15T18:05:10.793
> 
> 标签：javascript, internet-explorer-9

我注意到，在我的应用程序中，与 Win7 上的 IE 进程相关的内存在每次页面刷新时都会增加 20-30 MB。一旦我达到大约 1.5 GB，浏览器就会变得无响应。我使用的是 IE9，只能在 IE9 中重现。Chrome、FF、IE7 或 IE8 中没有此类问题。事实上，在兼容模式下运行 IE9 时也不会出现该问题。

特别是，我想知道即使在页面刷新后内存如何泄漏。有没有其他人看过这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-16T16:25:14.583

我不确定这是否是您的问题，但我也遇到了这个 IE9 内存泄漏问题，其中内存不断增长（每次刷新/页面更改大约 20 毫克）。

如果您使用的是 Modernizr（现在应该在最近的版本之一中修复，我相信 2.5+），但如果您使用的是旧版本（并且不能出于任何原因更新它），那么您只需要做是替换一个`return`语句。

**Modernizr / Geolocation & IE9**出现问题，它实际上是 IE9 的继承问题，而不是 Modernizr。

```
return 'geolocation' in navigator 
```

代替：

```
return !!navigator.geolocation // this causes the memory leak (silly IE9) 
```

[https://github.com/Modernizr/Modernizr/issues/513](https://github.com/Modernizr/Modernizr/issues/513)

看看那个链接，但基本上 Geolocation 测试的返回语句需要更改，这个问题会自行解决！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:15:39.457

过去，Internet Explorer 在普通 JavaScript 变量和 DOM 对象之间的引用方面存在一些问题。所以，如果我没记错的话，像这样的循环引用

```
var e = document.createElement('div');
var x = { elementReference: e };
e.jsReference = x; 
```

即使没有其他对`e`and的引用，也不会被垃圾收集`x`。这是因为 IE 对 DOM 元素和 JavaScript 使用了不同的垃圾收集方法。

现在，我相信这个问题已经在更高版本的 IE 中得到了解决，但也许不是。如果您不再需要它们，请尝试查找所有此类有问题的引用并手动删除它们。

```
e.jsReference = null;
x.elementReference = null; 
```

**编辑：在 IE 8 中测试**

我写了这个简单的测试网页。

```
<html>
  <head>
    <title>Leak test</title>
    <script>
      function leak() {
        var e = document.createElement('div');
        var x = { elementReference: e };
        e.jsReference = x;
      }

      function test() {
        for (var i = 0; i < 10000; i++)
          leak();
        alert('Done');
      }
    </script>
  </head>
  <body>
    <input type="button" value="test" onclick="test();" />
  </body>
</html> 
```

我在 IE 8 中对此进行了测试，因为我没有在这台机器上安装 IE 9。但是，这仍然可能是相关的，因为它表明即使在最新版本的 IE 中仍然存在该问题，因此即使在 IE 9 中也可能持续存在。

我打开页面并查看内存使用情况。每次按下按钮后，内存使用量都会增加几 MB。刷新网页后，完全没有任何反应。关闭IE后，内存使用恢复到原来的状态。

您可以在 IE 9 中亲自尝试。当然，您可能不会在代码中分配 10000 个循环引用对象，但您可能会创建更大的对象，其中可能包含一些您尚未找到的循环引用。

# c# - 调用 SqlCommand.Prepare() 后 SqlCommand.ExecuteNonQuery() 中的 NullReferenceException

> ID：10606376
> 
> 赞同：0
> 
> 时间：2012-05-15T18:05:29.153
> 
> 标签：c#, .net, prepared-statement, nullreferenceexception, sqlcommand

我遇到了抛出 NullReferenceException 的问题。这是代码：

```
using (SqlConnection connection = new SqlConnection(@"server=localhost\SQL2005;database=UintaTest;Integrated Security=SSPI;Connect Timeout=240"))
using (SqlCommand command = new SqlCommand(@"SELECT * FROM tblCaseActual WHERE CaseID = @Param", connection))
{
    connection.Open();
    connection.StatisticsEnabled = true;
    SqlParameter commandParameter = new SqlParameter
    {
        ParameterName = "Param",
        SqlDbType = SqlDbType.VarChar,
        Size = 12,
        Value = "1-19"
    };
    command.Parameters.Add(commandParameter);

    command.Prepare();
    //this does not throw an exception
    command.ExecuteNonQuery();

    //This throws an exception
    command.ExecuteNonQuery();
} 
```

调用第二个“ExecuteNonQuery”函数时会引发异常。第一个电话工作正常。

我查看了这个[msdn 链接](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.prepare)，但没有帮助。那里的代码片段与我正在尝试做的非常相似。我也搜索了其他有类似问题的人，但我没有找到任何东西。

并非所有 SQL 语句都会发生这种情况，但我已经在几个不同的数据库和几个不同的表上重现了它。

这里也是堆栈跟踪：

```
at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite)
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite)
at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
at SqlCommandPrepareTest.Program.Main(String[] args) in C:\Users\jadams\Documents\Visual Studio 2010\Projects\SqlCommandPrepareTest\SqlCommandPrepareTest\Program.cs:line 33
at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args) 
```

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:05:18.760

感谢您的评论。我最终将其更改为 ExecuteReader() 调用。从我的测试来看，如果您事先准备好语句，您似乎不能将 SELECT 语句与 ExecuteNonQuery() 调用结合使用。

第一次调用成功而第二次调用失败的事实告诉我，这很可能是 .NET 框架中的一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T10:58:37.880

.Net 没有错误。这是因为 ExecuteNonQuery 不是线程安全的。使其线程安全以解决问题

# html - 如何使用好html5标签进入特定服务网站

> ID：10606382
> 
> 赞同：0
> 
> 时间：2012-05-15T18:05:43.070
> 
> 标签：html, tags

我已经阅读了一些 html5 文档以及如何使用标签，特别是新闻我有一个网站 www.webmaster-toolbox.com，它就像一个实用程序，它打印一些关于网站的信息。

好吧，我在 2 部分中分开

results_sect：我把所有结果放在哪里 analize_sect：我把搜索栏放在哪里

关于标题和文章我不知道在我的情况下使用它们，所以问题是html5只对博客有用吗？没有这种网站？谢谢

如果不能帮助我使用微格式更好地指示页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:24:11.020

HTML 5 不仅对博客有用。**创建一个非常有意义的语义 HTML 非常有帮助，不仅浏览器可以理解，甚至人类也可以清楚地理解。**

以前为了创建文档的标题部分，我们几乎使用带有 id/class 作为标题的 div。现在在 HTML5 的帮助下，我们可以使用 header 标签来语义化地构建文档。

您可以使用文章标签，可用于博客文章或论坛帖子等......您也可以使用部分标签来有意义地分隔不同的内容，而不是使用传统的 div 方法。

# java - 使用 Runtime.getRuntime().exec(command) 启动程序时遇到问题

> ID：10606383
> 
> 赞同：1
> 
> 时间：2012-05-15T18:05:43.750
> 
> 标签：java, runtime, exe, actionlistener, runtime.exec

我目前正在编写一个可以在我的 PC 上打开 .exe 程序的 Java 程序，例如 MS Word。我有一个问题，因为 Runtime.getRuntime().exec() 只会成功打开某些程序。我对所有程序都使用了完全相同的代码，但无论如何，有些程序不会打开。

这是我下载的程序 Picasa 3 的代码：

```
class picasaHandler implements ActionListener
{
    public void actionPerformed(ActionEvent r)
    {
        try 
        {
            Runtime.getRuntime().exec("cmd /c start Picasa3.exe");

        }
        catch (IOException t)
        {
            JOptionPane.showMessageDialog(null,
                    "Sorry, could not find Picasa 3");
        }
    }
} 
```

所以我的问题是，为什么 Runtime.getRuntime().exec() 不能运行我使用它的所有程序，以及如何运行像 Picasa 3 这样的程序，我目前无法使用这种方法运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:08:17.833

我猜 Picasa3.exe 不在您的 %PATH% 上，所以它不知道如何加载它。您是否尝试过指定 Picasa3.exe 的完整路径？

```
Runtime.getRuntime().exec("cmd /c \"c:\\program files (x86)\\Google\\Picasa3\\Picasa3.exe\"") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T13:21:01.323

```
File file=new File("picassa3");
String filename=file.getAbsolutePath(file);
try 
    {
        Runtime.getRuntime().exec(filename);

    }
    catch (IOException t)
    {
        JOptionPane.showMessageDialog(null,
                "Sorry, could not find the file");
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:11:54.340

运行时的 exec 只能启动 Windows 路径上的应用程序。有些程序会自动在路径上，而其他程序（例如 Picasa）则不会。

唯一的解决方法是确定正确的路径，然后启动该应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:01:58.520

这可能对你有用。如果您想使用 Runtime.exec() 运行某个程序，只需将其安装路径添加到系统变量中的路径变量即可。要找到它的安装路径，只需右键单击它的快捷方式并选择“查找目标”。然后将整个地址连接到路径变量的末尾。

# objective-c - 移出屏幕时不会触发 didSelectRowAtIndexPath

> ID：10606389
> 
> 赞同：0
> 
> 时间：2012-05-15T18:06:21.733
> 
> 标签：objective-c, ios, ipad, uitableview, didselectrowatindexpath

我有一个`UITableView`最初在屏幕外的，当按下按钮时，我将视图的中心点向右移动，将 tableview 移回屏幕上。类似于 Facebook 中的菜单。

```
//Slide in Side Menu
[UIView beginAnimations:nil context:nil];    
[UIView setAnimationDuration:.75];

self.view.center = CGPointMake((cgSize.width/2)+10, 165);

[UIView setAnimationDelegate:self];
[UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];    

[UIView commitAnimations]; 
```

我的问题是，当我的表格视图的左上角是负数（屏幕外）时，`didSelectRowAtIndexPath`不会触发并且由于某种原因禁用了选择。

```
menuTableView = [[UITableView alloc] initWithFrame:CGRectMake(-350, 0, 350, cgSize.height-50) 
                                                 style:UITableViewStylePlain]; 
```

当我将 -350 更改为 0 时，它可以完美运行，如下所示：

```
menuTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 350, cgSize.height-50) 
                                                 style:UITableViewStylePlain]; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:10:31.093

表格视图的框架位于视图的标准框架之外，因此输入不会向下转发到表格视图。您需要弄清楚如何保持表格视图的边界包含在其父视图中，同时仍然按照您希望的方式制作动画

# javascript - 搜索引擎如何分析动态内容？

> ID：10606392
> 
> 赞同：2
> 
> 时间：2012-05-15T18:06:31.763
> 
> 标签：javascript, html, seo

我想使用 JavaScript 动态注入这些标签。

```
<meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
<meta name='title' content='Foo - All Your Bookmarks in One Place.'>
<meta name='description' content='A better way to bookmark.'> 
```

因此，如果您单击：View->Source，它们将不会显示，因为它们是动态创建的。

但是当使用链接到 window.onload 的函数请求页面时，它们会自动插入到 DOM 中。

搜索引擎会知道他们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:09:42.630

1.  不会。一般而言，搜索引擎不会处理或处理 JavaScript。因此，如果您通过 JavaScript 生成内容很可能不会被搜索引擎看到。但是，他们确实有能力解析*一些*JavaScript，而且 Google 确实支持可[抓取的 Ajax 标准](http://googlewebmastercentral.blogspot.com/2009/10/proposal-for-making-ajax-crawlable.html)（此处不适用），因此他们*可能*会发现这一点，但您不应该指望它。
2.  元标签不再影响您的排名，所以从 SEO 的角度来看，这个问题真的无关紧要。这些标签可能对搜索引擎产生的唯一影响是[它们*可能会*在搜索结果中使用您的元描述标签，](https://webmasters.stackexchange.com/a/15974/1253)但这并不能保证。

**更新**

搜索引擎会看到他们从您的服务器下载的源代码，而不是 JavaScript 或 Flash 等产生的任何操作的结果。因此，即使它在 DOM 中，它也仅在 JavaScript 执行后才存在。如果爬虫不执行 JavaScript，那么就它们而言，它永远不会在 DOM 中。

**更新#2**

搜索引擎爬虫本质上相当于一个有可用性和可访问性需求的人。要查看搜索引擎爬虫看到的内容，请关闭您的图像、CSS 和 JavaScript。[更好的是，通过Jaws 之](http://www.freedomscientific.com/products/fs/jaws-product-page.asp)类的屏幕阅读器或[Lynx 之类的文本浏览器](http://lynx.browser.org/)查看您的网站。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:11:01.507

可能不会，尽管 Google 可能正在处理 javascript。您可能应该在此处发布之前阅读[https://developers.google.com/webmasters/ajax-crawling/](https://developers.google.com/webmasters/ajax-crawling/)。

在此处查看更新的答案：[https ://webmasters.stackexchange.com/questions/28201/search-engine-misunderstanding#10006925](https://webmasters.stackexchange.com/questions/28201/search-engine-misunderstanding#10006925)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:08:27.480

我会说几乎肯定不是，对不起。

# asp.net - 树视图节点的子节点

> ID：10606393
> 
> 赞同：1
> 
> 时间：2012-05-15T18:06:34.503
> 
> 标签：asp.net, xml, vb.net

我有一个具有以下结构的 xml 文件：

```
<table name="tblcats">
    <row>
        <Id>3680</Id>
        <Industry>Associations</Industry>
        <ParentId>1810</ParentId>
    </row>
    <row>
        <Id>1592</Id>
        <Industry>Fortune 100</Industry>
        <ParentId>1810</ParentId>
    </row>
    <row>
        <Id>1601</Id>
        <Industry>Oil &amp; Gas Operations</Industry>
        <ParentId>1689</ParentId>
    </row>
    <row>
</table> 
```

我想使用这个 XML 文件创建一个树视图。我写了以下代码

```
 ' Load a TreeView control from an XML file.
    Private Sub LoadTreeViewFromXmlFile(ByVal file_name As String, ByVal trv As TreeView)
        ' Load the XML document.
        Dim xml_doc As New XmlDocument
        xml_doc.Load(file_name)

        ' Add the root node's children to the TreeView.
        trv.Nodes.Clear()
        trv.Nodes.Add(New TreeNode(xml_doc.DocumentElement.Name))
        AddTreeViewChildNodes(trv.Nodes, xml_doc.DocumentElement)
    End Sub

    ' Add the children of this XML node 
    ' to this child nodes collection.
    Private Sub AddTreeViewChildNodes(ByVal parent_nodes As TreeNodeCollection, ByVal xml_node As XmlNode)
        For Each child_node As XmlNode In xml_node.ChildNodes
            ' Make the new TreeView node.
            Dim new_node As TreeNode = New TreeNode(child_node.Item("Industry").InnerText, child_node.Item("Id").InnerText)

            parent_nodes.Add(new_node)

        Next child_node
    End Sub 
```

但它会创建一个像这样的树视图：

```
->table
->Associations
->Fortune 100 
```

我希望表格作为这样的父元素

```
->table
  ->Associations
  ->Fortune 100 
```

这样如果我单击表节点，所有树都会折叠或展开。请建议我该如何解决

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:29:00.337

问题是您将树视图控件本身传递给 AddTreeViewChildNodes 方法，因此它将所有节点添加到同一顶层。您需要将创建的根节点传递给该方法，以便在其下添加子节点。

改变：

```
 trv.Nodes.Add(New TreeNode(xml_doc.DocumentElement.Name))
    AddTreeViewChildNodes(trv.Nodes, xml_doc.DocumentElement) 
```

到：

```
 Dim rootNode As TreeNode = New TreeNode(xml_doc.DocumentElement.Name)
    trv.Nodes.Add(rootNode)
    AddTreeViewChildNodes(rootNode, xml_doc.DocumentElement) 
```

# asp.net - 使用 Asp.Net 进行异步编程的最佳方式

> ID：10606398
> 
> 赞同：6
> 
> 时间：2012-05-15T18:06:49.273
> 
> 标签：asp.net, node.js, asp.net-web-api, signalr

目前似乎有几个选项可以使用 asp.net 进行异步/推送式编程。但是对于什么是最好的，什么是对开发人员最友好的方法，我有点困惑。我已经遇到的事情是，

节点

信号R

[使用 PushStreamContent (Web API) 和类似 KnockoutJS 的东西](http://www.strathweb.com/2012/05/native-html5-push-notifications-with-asp-net-web-api-and-knockout-js/)

尽管[SignalR 被认为可以支持 asp.net 4.5 ，但我看到](http://www.hanselman.com/blog/VisualStudio11BetaInContext.aspx)[MS](http://adtmag.com/articles/2012/01/26/guthrie-talks-node.aspx)中的 NodeJs 很受关注 （特别是在 Azure 周围）。任何人都可以阐明（至少是 NodeJs 和 SignalR 的）差异吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-15T20:26:35.463

SignalR 是“.NET 的客户端和服务器端库，它通过持久连接提供消息传递和抽象。” 这不会神奇地使您的代码异步 - 它只是允许您的服务器异步调用客户端（包括在用户浏览器中运行的 JavaScript）。

但是，.NET 4.5 和 Visual Studio 2012（以及[Mono](http://mono-project.com/) 2.11+）中附带的 C# 5.0 允许您通过使用新的`async`&`await`关键字来编写/修改代码以实现异步。

如果您已经是 .NET 开发人员，那么 C# async & await 和 SignalR 非常容易上手、学习和运行，让您能够构建高度可扩展的高性能系统。

Node.js 使您能够用 JavaScript 编写代码并将其托管在应用服务器中。

Node 目前受到了很多关注，但如果您来自 .NET 开发背景，那么在迁移到服务器上的 JavaScript 时，值得注意的一些事情可能会让您感到惊讶/烦恼：

1.  JavaScript 是一种非常强大且极其灵活的动态类型语言。但是，在您了解它的许多缺陷以及如何克服它们之前，这种灵活性可能是非常危险和有问题的。如果您必须执行 JavaScript 代码，请考虑使用[TypeScript](http://www.typescriptlang.org/)和[CoffeeScript](http://coffeescript.org/)等语言编写源代码，它们可以编译为 JavaScript，但可以使您远离 JavaScript 的许多危险。

2.  虽然 node 提供了强大的异步调度功能，但它的代码执行性能可能比执行 C# 慢得多。如果您的代码很少/不处理数据，您可能不会注意到这个问题。但是，如果您的代码进行了大量的数据处理/计算/分析等，您可能会发现节点的 JavaScript 性能下降是不可接受的。

3.  节点是单线程的！如果您的代码必须执行一些繁重的处理，例如，对大量数据执行复杂的计算，它将阻止单个节点实例服务其他传入请求，直到每个处理操作完成。因此，您需要计划启用[节点集群](http://nodejs.org/api/cluster.html)（目前是一项实验性功能），或者，**如果您在 Windows 上托管节点**，请使用 IIS 和 IISNode] [4](http://nodejs.org/api/cluster.html)，它使用（很棒的）IIS 和 Windows 进程激活基础架构处理节点实例管理。

4.  与典型的 .NET 开发人员的调试经验相比，目前在 node 下调试代码是一个缓慢而繁琐的过程。这样做需要你使用 node-inspector 和 Chrome web 浏览器来调试代码，但是体验很差：断点不会在运行中保留；不支持条件断点；显示的调用堆栈很浅；等等

# prolog - 更改全局堆栈大小，GNU Prolog

> ID：10606400
> 
> 赞同：1
> 
> 时间：2012-05-15T18:06:52.957
> 
> 标签：prolog, stack, global, gnu-prolog

所以我在我大学的 bash 服务器上使用 GNU Prolog，我需要增加全局堆栈大小。

我尝试使用以下选项进行编译：

```
 gprolog --global-size 16384 --init-goal 'consult('test')' 
```

其中 test 只是我为测试而制作的 test.pl 文件。但是，我仍然收到以下异常

```
 Fatal Error: global stack overflow (size: 8192 Kb, environment variable used: GLOBALSZ) 
```

这表明大小仍然是 8192 Kb。不幸的是，我正在运行 GNU Prolog 版本 1.2.16，因为那是服务器上的内容，我无法轻易更改它。有什么我可以在这里做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-04T08:15:30.947

尝试： GLOBALSZ=16384 gprolog --init-goal 'consult('test')'

# xpages - xpage - sessionID 和 DomAuthsessId

> ID：10606401
> 
> 赞同：0
> 
> 时间：2012-05-15T18:06:56.777
> 
> 标签：xpages

当一个人登录到 domino 服务器时，会创建 domauthsessid cookie。在处理 xpages 时，我还看到了 sessionID 的 cookie。sessionID 是特定于 xpages 的吗？xpages如何使用这个sessionID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:27:37.517

取自[http://www-01.ibm.com/support/docview.wss?uid=swg27021314](http://www-01.ibm.com/support/docview.wss?uid=swg27021314)：

> Q. 有时当 XPage 被提交时，它会将 SessionID 添加到 URL 中并且一些 JavaScript 停止工作。那个 SessionID 是什么？
> 
> A. 这是由于 HTTP 的工作方式。HTTP 是无状态的，因此浏览器必须将 ID 传递给服务器，以便在服务器上保持会话打开。传递此 ID 有两种方法。
> 
> 1 - 将 ID 作为 URL 的一部分传递
> 
> 2 - 从浏览器传递 ID 作为 cookie 的一部分
> 
> 第二种方式是首选方式。但是对于第一个页面，XPages 引擎不知道连接到该页面的浏览器是否支持 cookie，因此它首先通过传递一个 ID 和一个 cookie 进行尝试。在第二个请求中，它会查找 cookie，如果 cookie 存在，它会从 URL 中删除 ID。因此，如果您查看所有应用程序服务器，它们都在这样工作。现在在 XPages 中有一个属性说“假设客户端有 cookie”，在这些情况下根本不使用会话 ID。所以这会破坏一些不支持启用 cookie 的浏览器。

sessionID URL 参数不用于 Lotus Domino 8.5.3 - 仅用于 8.5.2 和更早版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-23T12:44:16.897

创建一个 Xpage，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view
    xmlns:xp="http://www.ibm.com/xsp/core"
    rendered="false"
>
    <xp:this.beforeRenderResponse><![CDATA[#{javascript:

var externalContext = facesContext.getExternalContext();
var request = externalContext.getRequest();
var response = externalContext.getResponse();
var currentContext = com.ibm.domino.xsp.module.nsf.NotesContext.getCurrent();
var session = request.getSession(false);
var sessionId = session.getId();
// flush the cookies and invalidate the HTTP session...
for(var cookie in request.getCookies()){
    cookie.setValue("");
    cookie.setPath("/");
    cookie.setMaxAge(0);
    response.addCookie(cookie);
}
session.invalidate();
// now nuke the XSP session from RAM, then jump to logout...
currentContext.getModule().removeSession(sessionId);
externalContext.redirect("?logout");
}]]></xp:this.beforeRenderResponse>
</xp:view> 
```

然后创建一个链接或者Page Link指向上面的Xpage……</p>

这将使您注销并删除所有 cookie。

免责声明：在网上找到的代码（对那个人表示敬意），这**不适**用于客户端证书认证的服务器......</p>

为什么在讨论中这么晚才粘贴这个答案？因为我一直在寻找答案，但以上都不起作用，所以供将来参考……</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T07:41:56.713

此外，不应将使用 sessionId 表示的会话与基于会话的身份验证相混淆。

domauthsessid cookie 用于单服务器身份验证。如果您使用多服务器身份验证，LtpaToken 将用于该目的。此 cookie 保持您的身份验证会话。

当您登录、注销甚至使用其他用户登录时，XPages 会话将被保留。XPages 会话只会在特定的空闲时间后被删除，而身份验证会话会在您注销时被删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:02:10.730

cookie 管理服务器的浏览器会话。如果您执行 ?logout，则不会删除 sessionScope 变量。您可以使用 SSJS 清除 sessionScope 映射并注销，但这只会清除当前 NSF 的映射。如果您删除 sessionID cookie，XPages 会话将被删除，并且整个服务器的所有 sessionScope 变量都将被删除。我向 xSnippets OpenNTF 站点添加了一个片段，该站点执行注销并删除 sessionID cookie。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T19:01:37.313

XPages 使用 sessionID cookie，以便服务器知道它处理的是哪个会话，因此当您运行一些像 sessionScope.get(param) 这样的代码时，它知道要查看哪个用户的 sessionScope。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-16T07:40:48.857

Mikael Andersson Wigander 向我们展示了如何从 Domino 服务器注销的一个很好的解决方案。但是，URL 中的 ?logout 参数并不总是有效。

我们发现 Mikael 的注销页面仅在第一次尝试时注销了用户。然后浏览器缓存此注销页面并阻止用户下次尝试注销。

Mikael 解决方案的以下更改将解决此问题：

```
var appUrl = facesContext.getExternalContext().getRequest().getContextPath();
var url =  appUrl +"?Logout&t=" + new Date().getTime() + "&redirectto=" + appUrl ;  
facesContext.getExternalContext().redirect(url); 
```

使用同样包含时间（以毫秒为单位）的参数调用 Xpage：

```
<xe:this.href><![CDATA[#{javascript:"Logout.xsp?" + new Date().getTime();}]]></xe:this.href> 
```

现在用户将能够退出每次尝试。

# c# - 在 WPF 中重用触发条件或 MultiBinding

> ID：10606407
> 
> 赞同：2
> 
> 时间：2012-05-15T18:07:15.893
> 
> 标签：c#, .net, wpf, binding, controltemplate

### 目的是在不同的地方重用这个 MultiBinding

```
<MultiTrigger.Conditions>
    <Condition Value="True">
        <Condition.Binding>
                <MultiBinding Converter="{StaticResource ValidationBooleanConverter}">
                    <Binding X" />
                    <Binding Y" />
                    <Binding Z" />        
                </MultiBinding>
        </Condition.Binding>
    </Condition>
</MultiTrigger.Conditions> 
```

### 当前不太[干燥](http://coolthingoftheday.blogspot.co.uk/2009/05/short-introduction-to-solid-and-dry-for.html)的条件 (n+)

```
<Style x:Key="AnErrorTemplate" TargetType="FrameworkElement">
 <Style.Triggers>
    <MultiTrigger>
         <!-- Repeating the whole MultiTrigger.Conditions block here ---> 
         <Setter Property="Validation.ErrorTemplate" Value="{StaticResource DirtyErrorControlTemplate}" />
    </MultiTrigger>
 </Style.Triggers> 
```

```
<Style x:Key="AnotherStyle" TargetType="FrameworkElement">
 <Style.Triggers>
    <MultiTrigger>
         <!-- Repeating the whole MultiTrigger.Conditions block here ---> 
         <Setter Property="Other" Value="SomeValueIfTheSameConditionsAreTrue" />
    </MultiTrigger>
 </Style.Triggers> 
```

*事实上，要求更广泛，因为我还需要在 ControlTemplates 中重复使用这些相同的条件。*

```
<ControlTemplate x:Key="InlineErrorControlTemplate" TargetType="{x:Type Control}">
    <TextBlock Text="{Binding ElementName=InputView, Path=(Validation.Errors)[0].ErrorContent}" Foreground="Red"/>
     <ControlTemplate.Triggers>
         <MultiTrigger>
            <!-- Repeating the whole MultiTrigger.Conditions block here ---> 
            <Setter Property="Visibility" Value="SetMeIfTheseSameTriggerConditionsHold" />
        </MultiTrigger>
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

### 易于维护的雨伞？

有什么想法可以只指定一次 MultiTrigger.Conditions 或 MultiBinding，然后在多个样式和控件模板中使用它吗？

*   仅在 XAML 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T08:03:17.967

这正是`Style inheritance`WPF 中提供的原因。另外，在您的情况下，我建议使用`DataTrigger`with`MultiBinding`而不是`MultiTrigger`with `MultiBinding`...

为了证明这一点，假设我正在创建一个样式来检查`Tooltip`or`Name`分配给 any`FrameworkElement`是否为空。如果是这样，如果是a ，它将变为`Foreground`红色，如果`FrameworkElement`是，`ComboBox`它将`Background`变为黄色。`FrameworkElement``TextBox`

我正在使用...`Tag`的杂项领域`FrameworkElement`

因此，对此的所有 XAML（加上 C# 转换器）解决方案如下......

```
<Window x:Class="WpfApplication1.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        Height="300" Width="300">
    <Window.Resources>
        <local:AtleastOneEmptyConverter x:Key="AtleastOneEmptyConverter"/>
        <Style x:Key="BaseFrameworkElementStyle"
               TargetType="{x:Type FrameworkElement}">
            <Style.Triggers>
                <DataTrigger Value="True">
                    <DataTrigger.Binding>
                      <MultiBinding
                      Converter="{StaticResource AtleastOneEmptyConverter}">
                            <Binding Path="ToolTip"
                                     RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="Name"
                                     RelativeSource="{RelativeSource Self}"/>
                        </MultiBinding>
                    </DataTrigger.Binding>
                    <Setter Property="Tag" Value="1"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ApplyToComboStyle"
               TargetType="{x:Type ComboBox}"
               BasedOn="{StaticResource BaseFrameworkElementStyle}">
            <Style.Triggers>
                <DataTrigger
                    Binding="{Binding Tag,
                            RelativeSource={RelativeSource Self}}" Value="1">
                    <Setter Property="Foreground" Value="Red"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ApplyToTextBoxStyle"
               TargetType="{x:Type TextBox}"
               BasedOn="{StaticResource BaseFrameworkElementStyle}">
            <Style.Triggers>
                <DataTrigger
                    Binding="{Binding Tag,
                            RelativeSource={RelativeSource Self}}" Value="1">
                    <Setter Property="Background" Value="Yellow"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <StackPanel>
        <ComboBox Style="{StaticResource ApplyToComboStyle}"
                  x:Name="NotRedComboBox"
                  ToolTip="You will not see red text here">
            <ComboBoxItem IsSelected="True">I am not Red!</ComboBoxItem>
        </ComboBox>
        <ComboBox Style="{StaticResource ApplyToComboStyle}">
            <ComboBoxItem IsSelected="True">I am Red!</ComboBoxItem>
        </ComboBox>
        <Separator Margin="5"/>
        <TextBox Style="{StaticResource ApplyToTextBoxStyle}"
                 Text="I am yellow"
                 x:Name="YellowTextBox"/>
        <TextBox Style="{StaticResource ApplyToTextBoxStyle}"
                 Text="I am not yellow"
                 x:Name="NotYellowTextBox"
                 ToolTip="You will not see yellow background here"/>
    </StackPanel>
</Window> 
```

C#转换器：

```
public class AtleastOneEmptyConverter : IMultiValueConverter
{
    public object Convert
        (object[] values, Type targetType,
         object parameter, CultureInfo culture)
    {
        return values.Cast<string>().Any(val => string.IsNullOrEmpty(val));
    }

    public object[] ConvertBack
        (object value, Type[] targetTypes,
        object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T03:52:12.483

我已经多次遇到这种情况，我想通过从 Binding 继承并通过指定重用它们来重用设置转换器的常用绑定、这些转换器中的验证规则、源/目标更新通知等：

```
Foreground="{b:CustomColorBinding CustomDateTime}" 
```

减少我需要为绑定键入的 XAML 数量，但不要相信有办法将它全部保存在 XAML 中。不幸的是，尝试设置 x:Key 并像使用静态或动态资源一样使用它是不可能的。我已经非常习惯于使用这种约定，因此我为我的项目创建了一个 BindingCatalog 来存储我为绑定到不同类型的不同控件的常见（多）绑定场景。

我相信你有充分的理由想要避免代码隐藏，但如果你可以在代码中创建你的 MultiBinding 一次并重用它来干燥你的 XAML——那么我认为它不仅仅是证明（过度妖魔化，恕我直言）执行此操作所需的代码。

希望这有助于决定做什么！

扩展绑定

```
namespace MyNamespace
{
    public class CustomBinding : Binding
    {
        public CustomBinding(String path)
            : base(path)
        {
            this.Converter = new CustomValueConverter();
            this.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;
            this.ValidatesOnDataErrors = true;
        }
    }
} 
```

其 XAML 用法

```
<UserControl x:Class="MyNamespace.UserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:MyNamespace">
    <StackPanel>
        <TextBox Text="{local:CustomBinding MyViewModelProperty}"/>
    </StackPanel>
</UserControl> 
```

# java - 使用 ActivityLifecycleCallbacks 自动记录 Android 生命周期事件？

> ID：10606408
> 
> 赞同：36
> 
> 时间：2012-05-15T18:07:16.453
> 
> 标签：java, android, callback, lifecycle

我正在尝试使用 ActivityLifecycleCallbacks 自动捕获和记录 Android 生命周期事件，但是至少可以说，关于这件事的文档很少：

```
 public void registerActivityLifecycleCallbacks (Application.ActivityLifecycleCallbacks callback) 
```

我不想扩展 Activity 类或覆盖现有的生命周期方法（onCreate、onResume 等），我希望有一个单独的类来监听这些事件并采取相应的行动。

有没有人有这方面的经验，或者有关于它如何工作的好的可靠文档或教程的链接？具体来说，ActivityLifecycleCallbacks如何注册，如何处理？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-06-18T11:57:22.893

我没有任何第一手经验，但从 API 判断，您可以编写自己的实现[`Application.ActivityLifecycleCallbacks`](http://developer.android.com/reference/android/app/Application.ActivityLifecycleCallbacks.html)接口的类并在提供的`Application`类实例上注册该类

```
getApplicaton().registerActivityLifecycleCallbacks(yourCustomClass); 
```

此类将收到与您的个人活动相同的回调。祝你好运。

PS。这是 API 级别 14 顺便说一句，所以它不适用于旧手机。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-01-23T00:12:00.460

我自己实现了[`Application.ActivityLifecycleCallbacks`](http://developer.android.com/reference/android/app/Application.ActivityLifecycleCallbacks.html). 我正在使用`SherlockActivity`，但对于普通的 Activity 类可能会起作用。

首先，我正在创建一个接口，其中包含用于跟踪活动生命周期的所有方法：

```
public interface ActivityLifecycleCallbacks{
    public void onActivityStopped(Activity activity);
    public void onActivityStarted(Activity activity);
    public void onActivitySaveInstanceState(Activity activity, Bundle outState);
    public void onActivityResumed(Activity activity);
    public void onActivityPaused(Activity activity);
    public void onActivityDestroyed(Activity activity);
    public void onActivityCreated(Activity activity, Bundle savedInstanceState);
} 
```

其次，我在我的应用程序类中实现了这个接口：

```
public class MyApplication extends Application implements my.package.ActivityLifecycleCallbacks{

    @Override
    public void onCreate() {
        super.onCreate();           
    }

    @Override
    public void onActivityStopped(Activity activity) {
        Log.i("Tracking Activity Stopped", activity.getLocalClassName());

    }

    @Override
    public void onActivityStarted(Activity activity) {
        Log.i("Tracking Activity Started", activity.getLocalClassName());

    }

    @Override
    public void onActivitySaveInstanceState(Activity activity, Bundle outState) {
        Log.i("Tracking Activity SaveInstanceState", activity.getLocalClassName());
    }

    @Override
    public void onActivityResumed(Activity activity) {
        Log.i("Tracking Activity Resumed", activity.getLocalClassName());
    }

    @Override
    public void onActivityPaused(Activity activity) {
        Log.i("Tracking Activity Paused", activity.getLocalClassName());
    }

    @Override
    public void onActivityDestroyed(Activity activity) {
        Log.i("Tracking Activity Destroyed", activity.getLocalClassName());
    }

    @Override
    public void onActivityCreated(Activity activity, Bundle savedInstanceState) {
        Log.i("Tracking Activity Created", activity.getLocalClassName());
    }
} 
```

第三，我正在创建一个从 SherlockActivity 扩展的类：

```
public class MySherlockActivity extends SherlockActivity {

    protected MyApplication nMyApplication;

    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        nMyApplication = (MyApplication) getApplication();
        nMyApplication.onActivityCreated(this, savedInstanceState);
    }

    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        nMyApplication.onActivityResumed(this);
    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        nMyApplication.onActivityPaused(this);
    }

    @Override
    protected void onDestroy() {
        // TODO Auto-generated method stub
        super.onDestroy();
        nMyApplication.onActivityDestroyed(this);
    }

    @Override
    protected void onStart() {
        super.onStart();
        nMyApplication.onActivityStarted(this);
    }

    @Override
    protected void onStop() {
        super.onStop();
        nMyApplication.onActivityStopped(this);
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        nMyApplication.onActivitySaveInstanceState(this, outState);
    }   
} 
```

四、所有继承自SherlockActivity的类，我替换为MySherlockActivity：

```
public class MainActivity extends MySherlockActivity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

} 
```

现在，在 logcat 中，您将看到在 MyApplication 中的接口实现中编程的日志。

**更新**

此实现已通过 API 级别 9（姜饼）、API 级别 12（蜂窝）和 API 级别 17（果冻豆）进行了测试，并且运行良好。可能适用于 Android 的旧版本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-11-16T07:18:18.973

```
@Override
public void onCreate() {
    super.onCreate();
    registerActivityLifecycleCallbacks(MyApplication.this/*(Your Application Name)*/);
} 
```

只在 Application 类上添加这一行，一切正常。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-28T11:14:03.577

试试这个：[http ://engineering.meetme.com/2015/04/android-determine-when-app-is-opened-or-closed/#comment-202](http://engineering.meetme.com/2015/04/android-determine-when-app-is-opened-or-closed/#comment-202)

它建议`AppForegroundStateManager`每个活动通过其`onStop()`和`onStart()`功能向其报告，如下所示：

```
@Override
protected void onStart() {
    super.onStart();
    AppForegroundStateManager.getInstance().onActivityVisible(this);
}

@Override
protected void onStop() {
    AppForegroundStateManager.getInstance().onActivityNotVisible(this);
    super.onStop();
} 
```

你的`Application`类实现了一个这样的监听器：

```
public class MyApplication extends Application {
    @Override
    public void onCreate() {
        super.onCreate();
        AppForegroundStateManager.getInstance().addListener(this);
    }

    @Override
    public void onAppForegroundStateChange(AppForegroundStateManager.AppForegroundState newState) {
        if (AppForegroundStateManager.AppForegroundState.IN_FOREGROUND.equals(newState)) {
            // App just entered the foreground. Do something here!
            Log.i(TAG, "App Just Entered the Foreground with launch mechanism of: " + mLaunchMechanism);
        } else {
            // App just entered the background. Set our launch mode back to the default of direct.
            mLaunchMechanism = LaunchMechanism.DIRECT;
        }
    }
} 
```

它还包括确定应用程序打开方式的提示和技巧 - 从通知、打开应用程序的 URL 或直接从应用程序菜单。这是通过`Enum`Application 类中的一个来完成的：

```
public enum LaunchMechanism {
    DIRECT,
    NOTIFICATION,
    URL,
    BACKGROUND
}

private LaunchMechanism mLaunchMechanism = LaunchMechanism.DIRECT;

public void setLaunchMechanism(LaunchMechanism launchMechanism) {
    mLaunchMechanism = launchMechanism;
} 
```

在我们的实现中，当我们启动一个将启动第三方活动的活动时，我们有标志，例如用户是否从我们的应用程序拨打电话或是否启动了浏览器。在启动活动中，`onStop()`我们然后进行这样的检查，以仅在这些标志为假时报告活动的不可见性：

```
if(!flag_userLaunchedThirdPartyActivity){
     AppForegroundStateManager.getInstance().onActivityNotVisible(this);
     } 
```

为了检查应用程序是否进入后台 - 例如当设备的屏幕变暗或用户接到电话时 - 它的工作方式如下：

```
public static boolean isApplicationGoingToBackground(final Context context) {

    ActivityManager am = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);
    List<RunningTaskInfo> tasks = am.getRunningTasks(1);
    if (!tasks.isEmpty()) {
        ComponentName topActivity = tasks.get(0).topActivity;
        if (!topActivity.getPackageName().equals(context.getPackageName())) {
            setLaunchMechanism(LaunchMechanism.BACKGROUND);
            return true;
        }
    }

    setLaunchMechanism(LaunchMechanism.DIRECT);
    return false;
} 
```

此解决方案不依赖于 API 级别，因此它应该一直工作到 API 级别 1。

# android - Android canvas drawText 文本的y位置

> ID：10606410
> 
> 赞同：30
> 
> 时间：2012-05-15T18:07:34.610
> 
> 标签：android, text, canvas, position, drawtext

我正在使用 Canvas 创建一个带有一些背景和一些文本的 Drawable。可绘制对象用作 EditText 内的复合可绘制对象。

文本是通过画布上的 drawText() 绘制的，但在某些情况下，绘制文本的 y 位置确实存在问题。在这种情况下，某些字符的一部分会被截断（参见图片链接）。

*没有定位问题的字符：*

[http://i50.tinypic.com/zkpu1l.jpg](http://i50.tinypic.com/zkpu1l.jpg)

*有定位问题的字符，文本包含“g”、“j”、“q”等：*

[http://i45.tinypic.com/vrqxja.jpg](http://i45.tinypic.com/vrqxja.jpg)

您可以在下面找到重现该问题的代码片段。

有没有专家知道如何确定 y 位置的正确偏移量？

```
public void writeTestBitmap(String text, String fileName) {
   // font size
   float fontSize = new EditText(this.getContext()).getTextSize();
   fontSize+=fontSize*0.2f;
   // paint to write text with
   Paint paint = new Paint(); 
   paint.setStyle(Style.FILL);  
   paint.setColor(Color.DKGRAY);
   paint.setAntiAlias(true);
   paint.setTypeface(Typeface.SERIF);
   paint.setTextSize((int)fontSize);
   // min. rect of text
   Rect textBounds = new Rect();
   paint.getTextBounds(text, 0, text.length(), textBounds);
   // create bitmap for text
   Bitmap bm = Bitmap.createBitmap(textBounds.width(), textBounds.height(), Bitmap.Config.ARGB_8888);
   // canvas
   Canvas canvas = new Canvas(bm);
   canvas.drawARGB(255, 0, 255, 0);// for visualization
   // y = ?
   canvas.drawText(text, 0, textBounds.height(), paint);

   try {
      FileOutputStream out = new FileOutputStream(fileName);
      bm.compress(Bitmap.CompressFormat.JPEG, 100, out);
   } catch (Exception e) {
      e.printStackTrace();
   }
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-15T18:20:07.090

我认为假设 textBounds.bottom = 0 可能是错误的。对于那些降序字符，这些字符的底部可能低于 0（这意味着 textBounds.bottom > 0）。你可能想要这样的东西：

`canvas.drawText(text, 0, textBounds.top, paint); //instead of textBounds.height()`

如果您的 textBounds 从 +5 到 -5，并且您在 y=height (10) 处绘制文本，那么您只会看到文本的上半部分。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-08T05:45:37.510

我相信如果你想在左上角附近绘制文字，你应该这样做：

```
canvas.drawText(text, -textBounds.left, -textBounds.top, paint); 
```

您可以通过将所需的位移量与两个坐标相加来移动文本：

```
canvas.drawText(text, -textBounds.left + yourX, -textBounds.top + yourY, paint); 
```

这个工作的原因（至少对我来说）是 getTextBounds() 告诉你在 x=0 和 y=0 的情况下 drawText() 将在哪里绘制文本。因此，您必须通过减去 Android 中处理文本的方式引入的位移（textBounds.left 和 textBounds.top）来抵消这种行为。

在[这个答案](https://stackoverflow.com/questions/5714600/gettextbounds-in-android/14766372#14766372)中，我对此主题进行了详细说明。

# c# - 如何将 MVC / C# 对象输出到 Javascript 对象？

> ID：10606418
> 
> 赞同：1
> 
> 时间：2012-05-15T18:08:10.050
> 
> 标签：c#, javascript, asp.net, asp.net-mvc, client-side

我有一个通过其构造函数填充的 C# 模型。我想将此对象放在我的 _Layout.cshtml 中，以便我的 Javascript 可以将其用作设置。

这是我的模型的样子：

```
public class SomeConfig
{
    public string PropertyA { get; set; }
    public string PropertyB { get; set; }
    public string PropertyC { get; set; }

    public SomeConfig()
    {
        PropertyA = SystemSettings.getSetting(KEYA);
        PropertyB = SystemSettings.getSetting(KEYB);
        PropertyC = SystemSettings.getSetting(KEYC);
    }
} 
```

我想在 _Layout.cshtml 中初始化并输出它，这样我的所有其他视图都可以使用它。到目前为止，我只能弄清楚如何在 _Layout.cshtml 中手动执行此操作，如下所示：

```
<script type="text/javascript">
    MyNamespace.someConfig = {
        PropertyA: @SystemSettings.getSetting(KEYA),
        PropertyB: @SystemSettings.getSetting(KEYB),
        PropertyC: @SystemSettings.getSetting(KEYC)
    }
</script> 
```

这太可怕了，因为每次扩展 SomeConfig.cs 模型时，我都必须记住在客户端手动扩展它。有没有办法在 _Layout.cshtml 中对其进行初始化，以便动态创建 Javascript 对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:14:23.637

尝试做

```
<script type="text/javascript">
    MyNamespace.someConfig =  @Json.Encode(SystemSettings);
</script> 
```

# ninject - NInject InRequestScope 不会为 MVC4 返回相同的实例

> ID：10606422
> 
> 赞同：0
> 
> 时间：2012-05-15T18:08:19.090
> 
> 标签：ninject, asp.net-mvc-4

我已经通过 nuget 安装了 ninject，所以我有以下内容：

```
public static void Start() 
{
    DynamicModuleUtility.RegisterModule(typeof(OnePerRequestHttpModule));
    DynamicModuleUtility.RegisterModule(typeof(NinjectHttpModule));          
    bootstrapper.Initialize(CreateKernel);
} 
```

在`NinjectWebCommon`app_start 文件夹中。

在注册中我添加了一些 to be `InRequestScope`，但它似乎不起作用。当我在注册后立即设置断点并尝试`Kernel.Get<T>()`执行构造函数时，每次都会执行构造函数，并且每次请求期间请求实例时也会执行构造函数。这是 MVC4 中的一个已知问题吗？或者它应该工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:16:03.713

它仅在请求中起作用。启动代码不在 http 请求中。

# css - twitter bootstrap 作为我们的“go to”框架？

> ID：10606428
> 
> 赞同：2
> 
> 时间：2012-05-15T18:08:49.927
> 
> 标签：css, twitter-bootstrap, blueprint-css

在最近的几个项目中，我们一直在使用带有蓝图 css 的 html5 样板。通过一些调整，我们能够使蓝图“响应”。我们喜欢蓝图，但担心它可能有点“过时”，因为我们对 gui 趋势知之甚少。我们已经听到很多关于 twitter bootstrap 2.0 的讨论。从我们所看到的来看，我们喜欢 bootstrap 的简单性以及它提供开箱即用的响应能力这一事实。但是，我们担心它对我们的目的来说太重了。

所以，我想知道的是：

我们知道引导程序的外观可以无限制地定制。但是，彻底检查框架的默认外观是否比值得做的更多？（我们的设计师永远不会基于引导程序设计 Web 应用程序/网站）。

另外，我很想听听其他人从蓝图切换到引导程序的经历。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T05:04:26.790

我的 2 美分：

我是推特引导程序的粉丝。我已经将它用于工作中的内部应用程序。我基本上用它来将一个普通的应用程序转换为一个响应式应用程序，它具有非常需要的用户友好的用户界面。

我确实对默认的 twitter bootstrap css 库进行了一些自定义。我没有发现这特别困难，如果开发人员/设计人员了解 html/css/browser Web 开发工具的方式，他们也不应该这样做。

我认为它的设计足以让开发人员/设计师即使在进行定制之后仍然可以获得一些重大收益。

# javascript - 在 simplemodal 对话框弹出窗口中操作 div 的问题 - 进一步编辑

> ID：10606436
> 
> 赞同：0
> 
> 时间：2012-05-15T18:09:12.737
> 
> 标签：javascript, jquery, simplemodal

好的，我对 simplemodal 感到头疼 - 我知道我快到了，但无法让它完全正常工作。我有一个简单的对话框，里面有几个动态创建的 div，例如

```
<html>
<head>
<!-- Confirm CSS files -->
<link type='text/css' href='css/confirm.css' rel='stylesheet' media='screen' />
</head>

<body>
<div id='container'>
<h1>Test Page</h1>
<div id='content'>
    <div id='confirm-dialog'>
        Page Content Goes Here
    </div>

<!-- modal content -->
<div id='confirm'>
   <div class='header'><span>Header Text</span></div>
   <div class='message'>
     <div id='optionDiv0'><input type='radio' id='options' name='options' value='0' />Option0</div>
     <div id='optionDiv1'><input type='radio' id='options' name='options' value='1' />Option1</div>
     <div id='optionDiv2'><input type='radio' id='options' name='options' value='2' />Option2</div>
   </div>
   <div class='buttons'>
     <div class='yes'>OK</div>
   </div>
  </div>
</div>
<!-- Load JavaScript files -->
<script type='text/javascript' src='scripts/jquery.js'></script>
<script type='text/javascript' src='scripts/jquery.simplemodal.js'></script>

<script type="text/javascript">
jQuery(function ($) {
$('#confirm-dialog input.confirm, #confirm-dialog a.confirm').click(function (e) {
    e.preventDefault();
    confirm("", function () {
        for(var k = 0; k <= 3; k++) {
            if(options[k].checked) {
            var ele = document.getElementById("optionDiv" + k);
            ele.style.display = "none;";
            //alert("Stop Here");
            }
        }

        });
});
});

function confirm(message, callback) {
$('#confirm').modal({
    closeHTML: "<a href='#' title='Close' class='modal-close'>x</a>",
    position: ["20%",],
    overlayId: 'confirm-overlay',
    containerId: 'confirm-container', 
    containerCss: {
                        height: 300,
                        width: 450,
                        backgroundColor: '#fff',
                        border: '3px solid #ccc'
                  },

    onShow: function (dialog) {
        var modal = this;

        $('.message', dialog.data[0]).append(message);

        // if the user clicks "yes"
        $('.yes', dialog.data[0]).click(function () {
            // call the callback
            if ($.isFunction(callback)) {
                callback.apply();
            }
            // close the dialog
            modal.close(); // or $.modal.close();
        });
    }
});
}
</script>
</body>
</html> 
```

在点击代码中，我试图做到这一点，当用户点击其中一个单选按钮，然后点击“确定”时，该项目在弹出窗口中不再可见。如果我在该代码后面加上一个`alert("Stop here");`（如上面的代码所示，已注释掉），那么我可以看到 div 从弹出窗口中消失。但是，一旦我清除了警告框（或者如果我将其注释掉以使其永远不会运行），下次我激活对话框时，我隐藏的 div 就会重新出现。如何保持隐藏状态，以便下次激活对话框时保持隐藏状态，或者这可能吗？提前致谢。

最终编辑：找到了对话框每次打开时都恢复到原始状态的解决方案。我将它粘贴在 jquery 代码的正上方，它就像一个魅力：

```
<script> $.modal.defaults.persist = true; </script> 
```

作为另一个问题的一部分，在此站点上的另一个线程中找到。感谢所有帮助过的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:53:12.323

您的代码对我来说仍然不完整，但至于您的`confirm`函数回调

```
confirm("", function(){
    $('#confirm input[type=radio]').each(function(){
        if($(this).is(':checked'))
            $(this).parent().empty();
    });
}); 
```

像那样？

# python - gnuplot multiplot中的透明背景

> ID：10606439
> 
> 赞同：7
> 
> 时间：2012-05-15T18:09:25.170
> 
> 标签：python, gnuplot

我想在我的 gnuplot 图中获得透明背景。到目前为止我编码的是：

```
#! /usr/bin/python

from numpy import *
import Gnuplot as gp
import Gnuplot.funcutils

x = (1,2,3)
y=(2,4,5)
x1 = (3,6,8)
g = gp.Gnuplot()
g("set terminal svg size 200,400")
g("set output 'filename.svg'")
g("unset xtics")
g("unset ytics")
g("set multiplot layout 3,1 title 'Title here'")
g("set object 1 rectangle from screen 0,0 to screen 1,1 fillcolor rgb '#ff0000'      behind")
#First
g("set tmargin 2")
g("set title 'Plot'")
g("unset key")
d = gp.Data(x,y,with_="lines")
g.plot(d)
#Secon
g("set title 'Plot2'")
g("unset key")
d1 = gp.Data(x1,y,with_="lines")
g.plot(d1)
#Third
g("set title 'Plot3'")
g("unset key")
d2 = gp.Data(y,x,with_="lines")
g.plot(d2)
g("unset multiplot") 
```

我有一个红屏，但只是第三个情节。（是的，我必须更改 rgb 组合以获得透明背景颜色。但是，它是什么？）

在此先感谢，FB

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:28:09.793

Gnuplot 可以直接输出透明背景，但不是针对所有格式。例如，这可以为 .png 完成：

```
set term png transparent truecolor
set output 'plot.png'
plot sin(x) 
```

`transparent`处理背景和`truecolor`透明对象/绘图填充的透明度。

我可以从 gnuplot 中获得透明背景的另一种方法是，如果我输出 .eps 并将其转换为 .png 或某种支持透明度的光栅格式。

Gnuplot 示例：

```
set terminal postscript enhanced color
set output 'plot.eps'
plot sin(x) 
```

在 bash 中：

```
convert plot.eps -rotate 90 plot.png 
```

生成的 .png 具有透明背景，而 .eps 则没有。这可能与 imagemagick 处理透明度的方式有关。我将 .svg 转换为 .png 时不会发生同样的情况；它仍然有一个白色的背景。

使用诸如 Inkscape 之类的矢量图形编辑器来添加透明度可能会有一些运气。

# css - CSS - 剪切或合并 div 之间的共享边框

> ID：10606442
> 
> 赞同：2
> 
> 时间：2012-05-15T18:09:27.740
> 
> 标签：css

如何切断这两个 div 之间的共享边界线？我希望顶部的小 div 在三个边上都有边框，期望底部和下方的储藏室 div 只有顶部边框但留下共享边框。所以它看起来像一条穿过两个 div 上边界的线。我尝试在底部覆盖顶部 div。但没有得到我想要的。

```
 .ihead {
background-color: #EEE;
width: 15em;
height: 3em;
text-align:center center;
border-top:1px solid black;
border-left:1px solid black;
border-right:1px solid black;
border-bottom:none;

  }

    .ibody {
background-color: #EEE;
width: 60em;
height:20em;
margin-top:3em;
border-top:1px solid black;
z-index: 10;

  }

<div class="ihead"><h>Hello !</h></div>
<div class="ibody">......</div> 
```

从 - ![在此处输入图像描述](../Images/8456dc67f3981a8e2622ed023d00af75.png)

至 -

![在此处输入图像描述](../Images/19e845476e76664b6eaa0aca9eef9d64.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:14:12.140

实现此效果的正常方法是让顶部的框向下移动到其边框的顶部。在您的示例中，您可以通过添加`position: relative; bottom: -1px`到您的`.ihead`课程并`margin-top: 3em`从您的`.ibody`课程中删除来实现这一点。

[请参阅 jsFiddle。](http://jsfiddle.net/GGaFE/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-20T23:33:22.877

```
.bordered{
border: 1px solid black;
}
.bordered:not(:first-child){ //to merge borders between rows
    border-top: none;
}
.bordered:not(:first-child){ //if you want to merge between columns
    border-left: none;
}
```

```
<div class="bordered"><h1>Test1</h1></div>
<div class="bordered"><h1>Test2</h1></div>
<div class="bordered"><h1>Test3</h1></div>
```

这个问题是我第一个出现的问题，所以我觉得最好不要像上面接受的答案那样正确回答它。使用 CSS：

```
.bordered{
border: 1px solid black;
}
.bordered:not(:first-child){ //to merge borders between rows
    border-top: none;
}
.bordered:not(:first-child){ //if you want to merge between columns
    border-left: none;
} 
```

# vb.net - 在 vb.net 中使用 unicode 支持检测剪贴板文本更改

> ID：10606444
> 
> 赞同：0
> 
> 时间：2012-05-15T18:09:35.377
> 
> 标签：vb.net, unicode, clipboard

我使用下面的代码来检查剪贴板中的文本更改，但它不支持像 ا ب ج 这样的 unicode 字符有没有办法添加对 unicode 文本的支持，或者有没有其他方法可以做同样的工作？

```
#Region " Definitions "
    'Constants for API Calls...
    Private Const WM_DRAWCLIPBOARD As Integer = &H308
    Private Const WM_CHANGECBCHAIN As Integer = &H30D
    'Handle for next clipboard viewer...
    Private mNextClipBoardViewerHWnd As IntPtr
    'API declarations...
    Declare Auto Function SetClipboardViewer Lib "user32" (ByVal HWnd As IntPtr) As IntPtr
    Declare Auto Function ChangeClipboardChain Lib "user32" (ByVal HWnd As IntPtr, ByVal HWndNext As IntPtr) As Boolean
    Declare Auto Function SendMessage Lib "User32" (ByVal HWnd As IntPtr, ByVal Msg As Integer, ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Long
#End Region

#Region " Contructor "
#End Region

#Region " Message Process "
    'Override WndProc to get messages...
    Protected Overrides Sub WndProc(ByRef m As Message)
        Dim iData As IDataObject = New DataObject()
        iData = Clipboard.GetDataObject()
        Select Case m.Msg

            Case Is = WM_DRAWCLIPBOARD 'The clipboard has changed...
                '##########################################################################
                ' Process Clipboard Here :)........................
                '##########################################################################
                MsgBox(CStr(iData.GetData(DataFormats.Text)))
                SendMessage(mNextClipBoardViewerHWnd, m.Msg, m.WParam, m.LParam)

            Case Is = WM_CHANGECBCHAIN 'Another clipboard viewer has removed itself...
                If m.WParam = CType(mNextClipBoardViewerHWnd, IntPtr) Then
                    mNextClipBoardViewerHWnd = m.LParam
                Else
                    SendMessage(mNextClipBoardViewerHWnd, m.Msg, m.WParam, m.LParam)
                End If
        End Select

        MyBase.WndProc(m)
    End Sub
#End Region

#Region " Dispose "
    'Form overrides dispose to clean up...
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            'Set the next clipboard viewer back to the original... 
            ChangeClipboardChain(Me.Handle, mNextClipBoardViewerHWnd)
            MyBase.Dispose(disposing)
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T02:31:11.220

您的代码无法检测到 Unicode 文本的更改，因为它不是在寻找 Unicode 文本格式。Ansi 和 Unicode 使用不同的剪贴板格式，它们可以同时在剪贴板上共存。 `DataFormats.Text`仅支持 Ansi 文本。[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.dataformats.text.aspx)甚至说了这么多：

> 指定标准 ANSI 文本格式

您需要寻找`DataFormats.UnicodeText`代替或补充的`DataFormats.Text`，例如：

```
Protected Overrides Sub WndProc(ByRef m As Message) 
    Select Case m.Msg 
        Case Is = WM_DRAWCLIPBOARD 'The clipboard has changed... 
            '########################################################################## 
            ' Process Clipboard Here :)........................ 
            '########################################################################## 
            Dim iData As IDataObject = Clipboard.GetDataObject() 
            Dim oData as Object = iData.GetData(DataFormats.Text)
            If oData IsNot Nothing
              MsgBox(CStr(oData), MsgBoxStyle.OKOnly, "Ansi") 
            End If
            oData = iData.GetData(DataFormats.UnicodeText)
            If oData IsNot Nothing
              MsgBox(CStr(oData), MsgBoxStyle.OKOnly, "Unicode") 
            End If

        Case Is = WM_CHANGECBCHAIN 'Another clipboard viewer has removed itself... 
            If m.WParam = CType(mNextClipBoardViewerHWnd, IntPtr) Then 
                mNextClipBoardViewerHWnd = m.LParam 
            Else 
                SendMessage(mNextClipBoardViewerHWnd, m.Msg, m.WParam, m.LParam) 
            End If 
    End Select 

    MyBase.WndProc(m) 
End Sub 
```

# java - 使用 PID 控制器管理程序中的资源

> ID：10606445
> 
> 赞同：2
> 
> 时间：2012-05-15T18:09:41.867
> 
> 标签：java, operating-system, process-control, control-theory

我想知道是否有使用 PID 控制器类型机制来管理计算资源的先例（请参阅[http://en.wikipedia.org/wiki/PID_controller](http://en.wikipedia.org/wiki/PID_controller)）。

我所说的计算资源是指：备用线程、备用进程、队列长度等。

例如，在 apache.conf 中，您可以指定备用服务器的数量、最小服务器数量等。

我的问题是你如何控制新服务器的产生或资源池的收缩。

如果您的负载增加超过某个级别，那么同样可以应用于在 Amazon Grid 上看到生成节点。

作为对这个问题的回答，我感兴趣的是：

1.  如果有一个 Yes, No, Maybe 回答这个问题

2.  如果有在开源世界中使用它的可访问示例

3.  如果有为此目的在java、python等中实现PID控制的库。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T10:36:55.990

根据[这篇研究文章](http://research.google.com/pubs/pub35085.html)，.NET 框架中的线程池似乎有一个。我还找到了关于使用自主控制来平衡 Apache Web 服务器、控制 DB2 中的内存占用等的文章。

这里的[代码](http://code.google.com/p/grtframework/source/browse/trunk/grtSpotFramework/src/com/grt192/controller/pid/PIDController.java?spec=svn118&r=118)是一个开源项目中使用的java实现。

# jquery - jQuery拖动滚动禁用

> ID：10606447
> 
> 赞同：0
> 
> 时间：2012-05-15T18:09:44.520
> 
> 标签：jquery, html, css, scroll

我现在有点卡住了一些 html/css/jquery 混合。

基本上我有这个设置。

```
<div style="height: 100px; overflow: hidden">
<div style="height: 500px; width: 500px"></div>
</div> 
```

所以我的父 div 充当一个框架，其中的内容将使用 scrollto 插件滚动到。

但是我有一个问题，如果有人在框架区域中单击并拖动鼠标，它会滚动 div。

我怎样才能禁用这种行为？我已经使用了滚动事件和 preventDefault 但这不适用于拖动滚动。

我该怎么做呢？

谢谢

欧文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:26:58.940

**编辑：** 要么不使用插件，而只使用 jquery 的 animate() 函数在内部 div 上提供一个新的左侧位置，或者......

试试 scrollto 的“儿童”项目：[SerialScroll](http://flesler.blogspot.com/2008/02/jqueryserialscroll.html)和[LocalScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)。听起来那些比物理滚动更适合导航（使用 js 在单击某些内容后滚动到某个位置），听起来这就是你想要做的。

# php - 指定 simplepie 缓存位置？

> ID：10606450
> 
> 赞同：2
> 
> 时间：2012-05-15T18:10:01.940
> 
> 标签：php, simplepie, document-root

嗯。我知道这看起来很简单（如馅饼，哈哈），但我一直得到一个

```
Warning: /cache/ is not writeable. Make sure you've set the correct relative or absolute path, and that the location is server-writable. 
```

这是我的情况。我有 simplepie 从我的域中的各个级别和文件夹中提取提要。因此，如果它在一个地方有效，那么我会在其他地方收到此警告。（例如它位于子文件夹中。）

所以，我试图通过编辑 simplepie.inc 文件上的第 501 行来指定实际的完整路径位置

```
var $cache_location = $_SERVER['DOCUMENT_ROOT'] . "/cache/"; 
```

但是，这是一个语法错误......

所以，A）为什么？我知道我错过了一些愚蠢的东西。

B）有没有更好/更有效的方法来做到这一点？

谢谢是提前！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:15:30.583

[http://simplepie.org/wiki/reference/simplepie/set_cache_location](http://simplepie.org/wiki/reference/simplepie/set_cache_location)怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-27T06:37:12.280

在您的应用程序中创建一个文件夹假设文件夹名称是缓存添加这一行到您的 php 页面。$feed->set_cache_location($_SERVER['DOCUMENT_ROOT'] . '/你的应用名称/缓存');

# python - 导入模块，Levenshtein

> ID：10606451
> 
> 赞同：1
> 
> 时间：2012-05-15T18:10:06.873
> 
> 标签：python, import, easy-install, levenshtein-distance

我正在编写一个使用比较来确定模糊匹配的脚本，所以我正在使用 Levenshtein 功能。

不幸的是，当我在终端窗口中运行 easy_install python-Levenshtein 时，当我对其运行导入时，Python 仍然无法识别 Levenshtein。当我查看终端窗口时，我得到了这些错误代码列表（我认为这是出错的地方）：

> 处理 python-Levenshtein-0.10.2.tar.gz
> 
> 运行 python-Levenshtein-0.10.2/setup.py -q bdist_egg --dist-dir /var/folders/0H/0HiEtyHBGV4TWfq84ctWC++++TM/-Tmp-/easy_install-tbdn73/python-Levenshtein-0.10.2/ egg-dist-tmp-L7Jws0 警告：在目录“docs”下找不到匹配“*”的文件
> 
> 警告：在分发的任何地方都找不到与“*pyc”匹配的先前包含的文件
> 
> 警告：在分发的任何地方都找不到与“.project”匹配的先前包含的文件
> 
> 警告：在分发的任何地方都找不到与“.pydevproject”匹配的先前包含的文件
> 
> 无法执行 gcc-4.0：没有这样的文件或目录
> 
> 错误：安装脚本退出并出现错误：命令“gcc-4.0”失败，退出状态为 1

有谁知道为什么 Levenshtein 安装不起作用？我认为这与 gcc-4.0 错误有关（我运行了 GCC 安装程序，但仍然无法正常工作），或者有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:50:10.043

赠品是这一行：

```
unable to execute gcc-4.0: No such file or directory 
```

这暗示您没有安装 OS X 开发人员工具。您需要从 Apple 下载它们。如果幸运的话，您将只能找到命令行工具的下载，这就是您所需要的 - 否则您将不得不下载整个 XCode，即数 GB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:25:04.793

您可能必须安装 Python 的开发包才能编译此包中的 C 代码。要在 Debian/Ubuntu 机器上安装 python-dev，只需运行：

```
sudo apt-get install python-dev 
```

如果计算距离的速度不是您关心的问题，您还可以查看纯 Python 实现，例如可以在 NLTK 中找到的[nltk.metrics.distance模块。](http://nltk.googlecode.com/svn/trunk/doc/api/nltk.metrics.distance-module.html)

# atk4 - Page_SchemaGenerator 类是否在 Agiletoolkit 中工作？

> ID：10606452
> 
> 赞同：0
> 
> 时间：2012-05-15T18:10:11.017
> 
> 标签：atk4

我正在查看 atk4 (http://agiletoolkit.org/) 的项目。

但是 Page_SchemaGenerator 对我不起作用：

```
Method is not defined for this object

Additional information:

Raised by object: Object Model_Testmodel(igSchool_create_model_testmodel)
class: Model_Testmodel
method: getAllFields
arguments: Array ( ) 
```

有人可以确认它是否适用于 atk4 4.2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:07:29.013

更新已推送到 atk4-adddons 主分支。

将您的 atk4-adddons 更新到最新版本，它应该可以工作。

# google-analytics-api - Google AdWords - 如何在 AdWords 中正确使用自动标记和 UTM 变量？

> ID：10606456
> 
> 赞同：7
> 
> 时间：2012-05-15T18:10:25.513
> 
> 标签：google-analytics-api, google-ads-api, utm

让我用一些背景信息来作为这个问题的序言：

1.  我有一个基于网络的系统，它从谷歌分析 API 中获取数据，并通过网络界面根据每个客户的需求显示该信息。

2.  我为每个包含“utm”变量和系统生成值的来源/广告系列（Google AdWords、LinkedIn、Facebook、展示广告网络等）使用唯一的 URL。示例：url.com/?utm_source=Google&utm_medium=PPC&utm_content=1234&utm_campaign=This-is-the-campaign-name

3.  Google Analytics 是存储库，因为大多数客户在他们的网站上使用它，因此很自然地适合将它们用作数据捕获的主力。

4.  所有客户都拥有有效的 Google AdWords 广告系列、关联的 Google Analytics 帐户，并且他们启用了自动标记功能。

5.  当我测试 Google 文字广告时，网络浏览器中填充的链接类似于以下内容：url.com/?utm_source=Google&utm_medium=PPC&utm_content=1234&utm_campaign=This-is-the-campaign-name&gclid=123xyz

我目前的困境集中在启用了自动标记的 AdWords 广告系列上。所有来源（不包括 Google AdWords）的数据捕获过程都可以正常工作。我在“utm_content”变量中填充了唯一的跟踪代码，因此当我调用 Google Analytics API 时，此跟踪代码充当我的唯一标识符。对于所有 Google AdWords 广告系列，我会更新广告创意中的所有目标链接，以包含系统生成的 URL，这些 URL 也包含预填充的值。在 Google Analytics 中查看报告时，变量/值不存在，就好像 Google 完全无视这些值并使用从 Google AdWords 到 Google Analytics 的反向渠道来输入广告系列属性。对于这些 Google AdWords 广告系列，访问不会丢失，

这是我所知道的事情的清单：

1.  根据我的阅读，禁用自动标记将解决此问题并允许将“utm”变量及其值从 Google AdWords 传递到 Google Analytics。禁用自动标记的后果是丢失点击转化和费用数据。

2.  在与同样使用 Google Analytics 的客户合作时，KISSmetrics 记录了类似的问题。包含“gclid”的链接，例如：url.com/?gclid=123xyz（启用自动标记）不会记录任何其他信息（活动来源、媒体等）。还包含“utm”变量的链接，例如：url.com/?utm_source=Google&utm_medium=PPC&utm_content=1234&utm_campaign=This-is-the-campaign-name&gclid=123xyz，此信息将传递给 KISSmetrics。对于第二种情况，我假设 KISSmetrics javascript 正在读取 URL 变量和值。

这是我想要实现的目标：

1.  我试图避免必须添加一个专有的 javascript 来读取 URL 变量和值，然后将该信息发布到外部 URL。

2.  我不想将订单项添加到当前的 Google Analytics javascript（例如：自定义变量）。

3.  我正在寻找一种可能会考虑 AdWords ValueTrack 参数的“开箱即用”解决方案。我对这些变量的熟悉程度有限，因此我无法确定这些值之一是否可以用作唯一标识符，以便以后在使用 Google Analytics API 访问数据时进行参考。或者作为替代方案，使用 Google AdWords 维度来做同样的事情。请参阅[http://developers.google.com/analytics/devguides/reporting/core/dimsmets/adwords](http://developers.google.com/analytics/devguides/reporting/core/dimsmets/adwords)。

4.  我想确定是否可以继续使用生成唯一 URL 的方法，将它们分配给 Google AdWords 广告系列，并通过其 API 从 Google Analytics 获取这些广告系列的结果，而不会影响点击转化和成本数据（禁用自动标记）。

提前感谢您阅读我的困境，您提供的任何反馈将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-28T16:15:12.170

所以你是对的。当 Google Analytics 同时看到 UTM 参数和自动标记 GCLID 时，它会丢弃 UTM 参数以支持 GCLID。

然而......承认这是一个问题，特别是因为使用其转化导入功能的 AdWords 广告客户经常同时使用 UTM 和 GCLID，他们在 Google Analytics（分析）帐户中启用了一个覆盖开关，允许同时使用这两种功能。

您可以在他们的常见问题解答中了解更多信息，网址为[https://support.google.com/analytics/answer/1033981?hl=en](https://support.google.com/analytics/answer/1033981?hl=en)

我认为这应该可以解决您的问题。

乔恩

# android - 从哪里获得调试 PhoneGap 应用程序的指南？

> ID：10606458
> 
> 赞同：0
> 
> 时间：2012-05-15T18:10:38.340
> 
> 标签：android, cordova, guid

我刚刚开始进行 PhoneGap 开发，并在模拟器上运行了我的第一个示例 android 应用程序。所以我一直在寻找调试应用程序的方法，以备不时之需。我遇到了[http://debug.phonegap.com/](http://debug.phonegap.com/)，它要求在代码中包含 js 文件以便能够对其进行调试。但由于我是 PhoneGap 的新手，我似乎找不到向导。谷歌搜索一个小时左右并没有给我任何有用的东西，所以这是我向你们提出的问题：

*   什么是指导？

*   在我的 PhoneGap 应用程序中哪里可以找到指南？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:23:21.893

*   什么是指导？

全球唯一标识符

*   在我的 PhoneGap 应用程序中哪里可以找到指南？

你没有找到它，你只是在那个网页上创建你自己的。

参考： http: [//my.safaribooksonline.com/book/web-development/mobile/9781449324773/appendix-i-leftovers-the-top-six-things-we-didn-t-cover/377](http://my.safaribooksonline.com/book/web-development/mobile/9781449324773/appendix-i-leftovers-the-top-six-things-we-didn-t-cover/377)

# oracle11g - Oracle 显式锁定超时

> ID：10606460
> 
> 赞同：1
> 
> 时间：2012-05-15T18:10:42.033
> 
> 标签：oracle11g

我有一个 webapp 的多个节点可以尝试对 Oracle 表执行某些操作的情况。我们提出的解决方案是获得一个显式锁（在某个单独的锁对象或表本身上（对此开放反馈）），这样只有一个节点会尝试执行该操作。这个想法的唯一问题是获取锁的节点崩溃的场景。所以我的问题与Oracle是否允许您在获取它时指定锁定超时有关（不希望全局指定）

谢谢。

PS这是Oracle 11g

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T13:52:49.343

您可以为 DML 命令（插入、选择更新、删除、合并）指定语句级超时。对于 DDL 语句，您可以在会话级别指定。还有一个“跳过锁”子句，您可以在其中允许语句仅跳过已锁定的行。

# c++ - 使用 map::count 优化算法

> ID：10606462
> 
> 赞同：3
> 
> 时间：2012-05-15T18:10:56.140
> 
> 标签：c++, optimization, map

我目前有一个算法，可以散列一个键并使用 map::count 检查它的唯一性。如何优化？我也忘了提到这是线程的。

```
int coll = 0;
map<long, bool> mymap;
#pragma omp parallel for
for (int i = 0; i < 256; i++)
  for (int j = 0; j < 256; j++)
    for (int k = 0; k < 256; k++)
    {
      string temp;
      temp = i;
      temp += j;
      temp += k;
      temp += temp;
      long myhash = hash(temp.c_str());

     if (mymap.count(myhash))
      {
        #pragma omp atomic
        coll++;
        cout << "Collision at " << i << " " << j << " " << k << endl;
      }
      else
      {
        #pragma omp critical
        mymap[myhash] = true;
      }
    }

cout << "Number of collisions: " << coll << endl;
cout << "Map size: " << mymap.size() << endl; 
```

经过多次试验和错误，这是我可以制作的最佳版本，使用 1GB RAM 在 82.5 秒内生成 4294967296 个密钥。

```
#include <iostream>
#include <string>
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <sys/time.h>
#include <iomanip>
#include <omp.h>
#include <vector>
#include <fstream>
#include <ios>
#include <unistd.h>
using namespace std;

class Timer 
{
private:
  timeval startTime;

public:

  void start()
  {
    gettimeofday(&startTime, NULL);
  }

  double stop()
  {
    timeval endTime;
    long seconds, useconds;
    double duration;

    gettimeofday(&endTime, NULL);

    seconds  = endTime.tv_sec  - startTime.tv_sec;
    useconds = endTime.tv_usec - startTime.tv_usec;

    duration = seconds + useconds/1000000.0;

    return duration;
  }

  static void printTime(double duration)
  {
    cout << setprecision(10) << fixed << duration << " seconds" << endl;
  }
};

static inline long hash(const char* str)
{
  return (*(long*)str)>> 0;
}  
int coll;
vector<bool> test;

void process_mem_usage(double& vm_usage, double& resident_set)
{
  using std::ios_base;
  using std::ifstream;
  using std::string;

  vm_usage     = 0.0;
  resident_set = 0.0;

  // 'file' stat seems to give the most reliable results
  //
  ifstream stat_stream("/proc/self/stat",ios_base::in);

  // dummy vars for leading entries in stat that we don't care about
  //
  string pid, comm, state, ppid, pgrp, session, tty_nr;
  string tpgid, flags, minflt, cminflt, majflt, cmajflt;
  string utime, stime, cutime, cstime, priority, nice;
  string O, itrealvalue, starttime;

  // the two fields we want
  //
  unsigned long vsize;
  long rss;

  stat_stream >> pid >> comm >> state >> ppid >> pgrp >> session >> tty_nr
          >> tpgid >> flags >> minflt >> cminflt >> majflt >> cmajflt
          >> utime >> stime >> cutime >> cstime >> priority >> nice
          >> O >> itrealvalue >> starttime >> vsize >> rss; // don't care about the rest

  stat_stream.close();

  long page_size_kb = sysconf(_SC_PAGE_SIZE) / 1024; // in case x86-64 is configured to use 2MB pages
  vm_usage     = vsize / 1024.0;
  resident_set = rss * page_size_kb;
}
Timer timer;
void signal_handlerkill(int sig)
{
  cout << "Number of collisions: " << coll << endl;
  //cout << test.size() << endl;
  double vm, rss;
  process_mem_usage(vm, rss);
  vm /= 1024.0;
  rss /= 1024.0;
  cout << "VM: " << vm << "MB" << endl;
  timer.printTime(timer.stop());
  exit(1);
}

int main()
{
  signal(SIGINT, signal_handlerkill);
  timer = Timer();
  timer.start();
  coll = 0;

  for (long i = 0; i < 4294967296+1; i++)
  {
    test.push_back(0); //Set up the vector
  }

  #pragma omp parallel for 
  for (int i = 0; i < 256; i++)
    for (int j = 0; j < 256; j++)
      for (int k = 0; k < 256; k++)
        for (int l = 0; l < 256; l++)
        {
          const char temp[4] = {i, j, k, l};
          long myhash = (*(long*)temp);

          if(test.at(myhash))
          {
            #pragma omp atomic
            coll++;
          }
          else
          {
            test[myhash].flip();
          }
        }

  cout << "Number of collisions: " << coll << endl;
  double vm, rss;
  process_mem_usage(vm, rss);
  vm /= 1024.0;
  rss /= 1024.0;
  cout << "VM: " << vm << "MB" << endl;
  timer.printTime(timer.stop());

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:14:37.047

在空间方面，您可以使用 a`set`而不是 a `map`，因为该`bool`值是无用的。

此外，如果您使用 C++11，an`unordered_set`可能会提供更好的性能。

还，

```
temp = i;
temp += j;
temp += k;
temp += temp; 
```

`stringstream`可能比使用 a甚至 char 数组具有更大的开销。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:14:15.057

使用`insert`而不是`operator[]`. 插入函数返回一对。第二个值表示，如果该值是实际插入的，即你可以重写你的代码如下：

```
if (!mymap.insert(std::make_pair(myhash, true)).second) {
    coll++;
    cout << "Collision at " << i << " " << j << " " << k << endl;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T18:30:57.107

好吧，我在这里回答了这个问题：[https](https://stackoverflow.com/a/10606381/389833) ://stackoverflow.com/a/10606381/389833 ，它是这样的：

```
 int coll = 0;
typedef map<long, bool> MY_MAP_TYPE;
MY_MAP_TYPE mymap;
string temp;
long myhash;
for (int i = 0; i < 256; i++)
    for (int j = 0; j < 256; j++)
        for (int k = 0; k < 256; k++)
        {
            temp = i;
            temp += j;
            temp += k;
            temp += temp;
            myhash = hash(temp.c_str());
            if( mymap.insert( MY_MAP_TYPE::value_type( myhash, true ) ).second == false)
            {
                coll++;
                cout << "Collision at " << i << " " << j << " " << k << endl;
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T18:26:49.127

根据散列的大小，您可以用空间换取 CPU 时间，并且只使用布尔向量而不是映射来进行常数时间查找。如果范围是 0 - 256 ³（此处唯一值的数量），它应该只需要大约 2 MB，因为许多实现中的 STL 向量将在内部将 bool 向量压缩为位。当然，如果您的哈希函数可以返回非常大的值，例如 2 ^(32)甚至 2 ^(64) ，这将不会有效（或者可能根本不起作用） 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T19:42:52.450

如果您只关心 6 个字符串，那么您可以通过以下方式轻松优化您生成的循环：

```
for (int i = 0; i < 256; i++)
  for (int j = 0; j < 256; j++)
    for (int k = 0; k < 256; k++)
    {
/*
      string temp;
      temp = i;
      temp += j;
      temp += k;
      temp += temp;
      myhash = hash(temp.c_str());
*/  
      // effectively, the same as above
      const char temp[7] = {i, j, k, i, j, k, '\0'};
      myhash = hash(temp);
    } 
```

以上与`insert`所建议的相结合，应该会提供很好的性能提升。

**编辑：**

所以，你在下面评论这个版本“更慢”让我很怀疑：

1.  你是如何分析的
2.  哈希函数的实现

这些都是有问题的，因为在我的机器上运行这段代码（暂时忽略 3.3GHz 幻数，因为那是我 CPU 的速度）：

```
#include <iostream>
#include <vector>
#include <boost/functional/hash.hpp>
#include <x86intrin.h>

using namespace std;

uint64_t f(std::vector<uint64_t>& values)
{
    boost::hash<std::string> hasher;

    uint64_t start = __rdtsc();
    int z = 0;

    for (int i = 0; i < 256; i++)
    {
      for (int j = 0; j < 256; j++)
      {
        for (int k = 0; k < 256; k++)
        {
          string temp;
          temp = i;
          temp += j;
          temp += k;
          temp += temp;

          values[z++] = hasher(temp);
        }
      }
    }

    return (__rdtsc()) - start;
}

uint64_t g(std::vector<uint64_t>& values)
{
    boost::hash<std::string> hasher;

    uint64_t start = __rdtsc();
    int z = 0;

    for (int i = 0; i < 256; i++)
    {
      for (int j = 0; j < 256; j++)
      {
        for (int k = 0; k < 256; k++)
        {
          const char temp[7] = {i, j, k, i, j, k, '\0'};
          values[z++] = hasher(std::string(temp, 6));
        }
      }
    }

    return (__rdtsc()) - start;
}

static const double freq = 3300000000.0;
static const int elements = 1024 * 1024 * 16;

int main()
{
    std::vector<uint64_t> values_f(elements);
    std::vector<uint64_t> values_g(elements);

    uint64_t delta_f = f(values_f);
    uint64_t delta_g = g(values_g);

    cout << "F: " << (delta_f * 1000.0) / freq << "ms \n";
    cout << "G: " << (delta_g * 1000.0) / freq << "ms \n";

    for(int x = 0; x < elements; ++x)
    {
        if(values_f[x] != values_g[x])
        {
            cout << "Error: Expected "
                 << values_f[x] << " received "
                 << values_g[x] << "!\n";
        }
    }

    return 0;
} 
```

给出这个输出：

```
F: 3297.17ms 
G: 736.444ms 
```

表明构建的版本`std::string`（甚至在技术上不是必需的）性能比进行连接的版本好得多。我的情况的不同之处在于使用`boost::hash`(并且显然使用 a`std::vector`而不是 a `std::map`or `std::set`，但这并不会使测试偏向于任何一个结果。

# android - Android 在小部件文本上使用 ellipsize

> ID：10606469
> 
> 赞同：0
> 
> 时间：2012-05-15T18:11:29.083
> 
> 标签：android

我创建了一个带有文本的小部件。我想在没有足够位置显示整个文本的文本末尾添加 ...。我用过 `android:ellipsize="end"`，但只有前两行可见。

这是小部件布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="64dip"
    android:layout_height="72dip"
    android:layout_gravity="center"
    android:id="@+id/widgetlayout">

    <ImageView android:id="@+id/ImageView01"
     android:layout_width="72dip" 
     android:layout_height="72dip"
     android:scaleType="fitXY">
    </ImageView>

    <TextView
        android:id="@+id/tvConfigInput"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:gravity="left"
        android:textColor="#FFFFFF"
        android:layout_margin="2dip"    
        android:ellipsize="end"
        android:textSize="12dip" />

</RelativeLayout> 
```

第一张图片是椭圆效果的。第二个没有它。你可以看到有足够的地方显示更多的文本。

![在此处输入图像描述](../Images/dfd6ccc03ece90cb068175443ff9bcee.png) 我也在 1x2 小部件中尝试过，同样的情况

![在此处输入图像描述](../Images/6e1dc3b44c74c37ea94094e0d3c21141.png)

感谢 Devunwired，我现在正在尝试这个，但没有任何改变（我想我做错了）

```
RemoteViews views = new RemoteViews(c.getPackageName(), R.layout.widget_layout);

        TextPaint paint = new TextPaint(); 
        final float densityMultiplier = this.getResources().getDisplayMetrics().density;
        final float scaledPx = 20 * densityMultiplier;
        paint.setTextSize(scaledPx);
        final float size = paint.measureText(widgettext);  
        Log.i("size", size + "");  //1716 e.g

        while (widgettext != TextUtils.ellipsize(widgettext, paint, (float)GetDipsFromPixel(72),  TextUtils.TruncateAt.END)) { 
            paint.setTextSize(paint.getTextSize() - 1);
        }

        views.setTextViewText(R.id.tvConfigInput, widgettext);
        views.setTextColor(R.id.tvConfigInput, loadedtextcolor);

        views.setFloat(R.id.tvConfigInput, "setTextSize", int_widgetfontsize); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:18:07.650

您发现了我最喜欢的框架错误之一：[http ://code.google.com/p/android/issues/detail?id=2254](http://code.google.com/p/android/issues/detail?id=2254)

请随意给它加注星标，并希望我们能尽快看到解决此问题的方法。其中的评论还指出了您可以使用自定义视图实施以克服该问题的许多解决方案。您还可以使用`Paint.measureText()`和的组合手动放置省略号`TextUtils.ellipsize()`

高温高压

# ios - 带有 iOS GLES 的 UIImageView

> ID：10606473
> 
> 赞同：1
> 
> 时间：2012-05-15T18:11:50.657
> 
> 标签：ios, opengl-es, uiimage

我是新手`OpenGL`，正在寻找任何用于`UIImage`在屏幕上绘制简单的代码片段 - 完全一样`UIImageView`。

互联网上到处都是这样的代码示例，但都为图片添加了一点点平滑，当我（在我的代码中）添加一个`OpenGLView`over a`UIImageView`时，用户可以看到这一刻。上的文字`UIImage`变得稍微平滑了一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:32:55.710

对于现有的解决方案，您可以使用我的开源[GPUImage](https://github.com/BradLarson/GPUImage)框架中的 GPUImageView，再加上 GPUImagePicture 来拉入您的 UIImage。执行此显示的代码如下所示：

```
UIImage *inputImage = [UIImage imageNamed:@"image.png"];
GPUImagePicture *stillImageSource = [[GPUImagePicture alloc] initWithImage:inputImage];
GPUImageView *imageView = (GPUImageView *)self.view;
[stillImageSource addTarget:imageView];
[stillImageSource processImage]; 
```

这个框架的重点是执行基于 OpenGL ES 的图像和视频处理，所以这是你可以用框架做的最基本的事情。过滤器和其他类型的图像处理操作可以添加到从图像到视图的链中。

这个基于 OpenGL ES 的图像视图具有三种不同的填充模式，可以通过`fillMode`属性设置，但默认情况下它会拉伸图像以填充视图。您应该能够使用此属性来匹配 UIImageView 的填充模式。

您可以检查 GPUImageView 的代码，以了解我如何获取纹理并根据这些不同的填充模式和可能的图像旋转来显示它。基本上，我只是使用两个三角形来建立一个矩形，并使用一个直通着色器在该矩形内显示一个纹理，这几乎是其他人在这种情况下所做的。

您看到的平滑差异可能来自 GPU 上过滤纹理的方式与 Core Graphics 如何缩小图像的差异，如果您将图像放置在这些视图中，这些视图的大小与它们显示的视图不同。

# javascript - 如何通过 javascript 检测被阻止的 youtube 视频

> ID：10606482
> 
> 赞同：8
> 
> 时间：2012-05-15T18:12:19.613
> 
> 标签：javascript, youtube

如何检测 youtube 视频是否无法播放？

我知道有一种方法可以调用 youtube api 的请求，但是这将花费太多时间来检查每个视频，因为视频是根据用户请求播放的。

有没有办法检查 youtube 播放器的状态，如果它不播放，然后采取相应的行动？

我知道有一些状态，比如准备好、停止、播放、查询。找不到此特定事物的状态。

提前致谢

好的，我找到了解决方案。但它不会让我发布它，因为我不像你们那样酷。这里是：

```
onYouTubePlayerReady = function() {
    player.addEventListener("onError", "onPlayerError");
}

function onPlayerError(errorCode) {
    playnext();
} 
```

如果您想检查某个错误，则错误代码位于 youtube 网站上。然而这对我来说已经足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T15:25:37.397

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-02T11:37:04.217

我不知道你是怎么做到的，但我是这样做的：

```
 ...

    events{
         ...
         'onError': onPlayerError
    }

    ...

    function onPlayerError(errorCode) {
         playnext();
    }

    ... 
```

# c - SSE：如果不为零则倒数

> ID：10606483
> 
> 赞同：8
> 
> 时间：2012-05-15T18:12:24.357
> 
> 标签：c, normalization, sse

如何使用 SSE 指令获取浮点数的倒数（倒数），但**仅适用于非零**值？

*背景如下：*

我想标准化一个向量数组，以便每个维度都具有相同的平均值。在 C 中，这可以编码为：

```
float vectors[num * dim]; // input data

// step 1\. compute the sum on each dimension
float norm[dim];
memset(norm, 0, dim * sizeof(float));
for(int i = 0; i < num; i++) for(int j = 0; j < dims; j++)
    norm[j] += vectors[i * dims + j];
// step 2\. convert sums to reciprocal of average
for(int j = 0; j < dims; j++) if(norm[j]) norm[j] = float(num) / norm[j];
// step 3\. normalize the data
for(int i = 0; i < num; i++) for(int j = 0; j < dims; j++)
    vectors[i * dims + j] *= norm[j]; 
```

现在出于性能原因，我想使用 SSE intinsics 来执行此操作。Setp 1 和第 3 步很容易，但我被困在第 2 步。我似乎没有找到任何代码示例或明显的 SSE 指令来取值的倒数（**如果**它不为零）。对于除法，_mm_rcp_ps 可以解决问题，并且可能将其与条件移动相结合，但是如何获得指示哪个分量为零的掩码？

我不需要上述算法的代码，只需要“如果不为零则取反”函数：

```
__m128 rcp_nz_ps(__m128 input) {
    // ????
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-15T18:18:37.043

```
__m128 rcp_nz_ps(__m128 input) {
    __m128 mask = _mm_cmpeq_ps(_mm_set1_ps(0.0), input);
    __m128 recip = _mm_rcp_ps(input);
    return _mm_andnot_ps(mask, recip);
} 
```

如果输入为零，则每个通道`mask`设置为，否则设置为。And-not 使用该掩码将对应于零输入的倒数元素替换为零。`b111...11``b000...00`

# regex - 如何在 vim 正则表达式中扩展设置或变量？

> ID：10606485
> 
> 赞同：6
> 
> 时间：2012-05-15T18:12:37.837
> 
> 标签：regex, vim

我有一个正则表达式 ，`^ \{3,}/`并且想使用设置或变量的值来代替`3`. 这是上下文：

```
match LeadingSpaces /^ \{3,}/
highlight LeadingSpaces ctermbg=red guibg=red 
```

我想用 的值`tabstop`代替 3。或者，我可以设置一个要使用的新变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T18:29:25.180

尝试以下而不是`match LeadingSpaces /^ \{3,}/`：

```
execute 'match LeadingSpaces /^ \{'.&tabstop.',}/' 
```

# jquery - jQueryTools Validator - 合并所有错误消息并显示一个 alert()

> ID：10606491
> 
> 赞同：0
> 
> 时间：2012-05-15T18:13:12.297
> 
> 标签：jquery, jquery-tools

我正在使用 jQuery Tools Validator (jquerytools.org)，默认情况下会在每个字段上方显示错误消息。

相反，我希望将错误消息合并到一个常规的 alert() 对话框中（普通的 JS alert() 函数）。

我不认为这是文档中的一个选项。有没有办法让这种情况发生？

谢谢你尽你所能的帮助。

对于上下文，验证的编码如下：

```
$.tools.validator.fn("[minlength]", function(input, value) {
    var minlength = input.attr("minlength");
    if(value.length != 0 && value.length < minlength) return 'Minimum ' + minlength + ' characters';
    else return true;
});

$.tools.validator.fn("[data-validate=name]", function(input, value) {
    if(!name_regex.test(value) && value) return 'Contains invalid characters';
    else return true;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:06:56.317

这不是 hack——您可以使用 onFail 事件处理程序来执行此操作。 [http://www.jquerytools.org/demos/validator/events.html](http://www.jquerytools.org/demos/validator/events.html)

当表单验证失败但在显示任何错误消息之前，它会执行该处理程序。通过返回 false，您可以创建自己的错误消息处理并防止验证器显示错误。

# javascript - 通过服务器端条件加载 javascript 或 CSS 是否有缺点？

> ID：10606492
> 
> 赞同：0
> 
> 时间：2012-05-15T18:13:23.077
> 
> 标签：javascript, css, caching, optimization

假设我有一个 javascript 或 CSS 文件，它只用于网站上的一个或很少几个页面。我还有一种方法可以轻松识别何时提供这些页面，例如人类可读的 URL。使用服务器端测试有条件地为 JS 提供服务以查看脚本是否必要是不好的做法吗？以 PHP 为例，我可能会这样做：

```
<?php
if($page='myFancyPage')
{
?>
    <script src="myFancyScipt.js"></script>
<?php
}
?> 
```

我不会失去浏览器缓存的好处吗？我不应该这样做还有其他原因吗？

我认识到随着站点变得越来越大并且必须堆积越来越多的条件，这可能会变得笨拙。但除了这个问题之外，是否有理由避免这种做法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:14:57.603

不，因为条件是在服务器而不是客户端上。

客户端不知道它**为什么**得到文件，但是当它得到它时，它会被缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:16:12.000

浏览器缓存发生在客户端（浏览器），而您的 PHP 将在服务器端执行。如果您的浏览器看到包含`myFancyScript.js`在其中的页面，那么对该页面的所有后续请求都将使用 的缓存版本`myFancyScript.js`，假设来自服务器的响应标头允许它并且浏览器服从标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T16:15:47.167

这取决于...

一般来说，建议是尽量减少页面对外部资源的请求数量，因为额外请求/响应的开销通常大于文件源合并到另一个文件源的情况。

这就是为什么标准性能建议是将 JS 文件合并在一起以创建最小下载次数的原因

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:16:22.780

您不会失去文件缓存的好处，除非它们被需要并且没有被提供！文件缓存只有在文件没有更改并且已经存在于客户端时才会使您受益。

有选择地链接到您的外部文件（仅链接`this`页面需要的文件）是有好处的，因为您的文件将加载得更快，因为它不必解析多余的 js/css ...您最好只添加将页面需要

# mysql - 两个查询之间的mysql变量

> ID：10606493
> 
> 赞同：1
> 
> 时间：2012-05-15T18:13:24.573
> 
> 标签：mysql

我需要执行这个查询：

```
SELECT MAX(col1) FROM table1;
INSERT INTO table1 (col1) VALUES (@someting); 
```

@something 在哪里`MAX(col1) + 1`。你能帮我写查询吗？我需要查询也适用于 NULL 值......我想我需要一个 CAST。

这是一个类似drupal的表。col0 是 AUTO_INCREMENT，但 col1 不能有很多原因。

col0 是主键并且 auto_increment 处于活动状态。但我使用 vid 作为版本控制 ID。我需要在不插入新记录的情况下增加它，并且我需要一个线程安全的查询。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:15:52.000

为此，您不需要变量。您可以只使用一个`INSERT INTO ... SELECT` 语句：

```
INSERT INTO table1 (col1)
  SELECT MAX(col1) + 1 FROM table1 
```

如果您需要通过返回 1 if `MAX(col1)`is来工作`NULL`，请使用`COALESCE()`：

```
INSERT INTO table1 (col1)
  SELECT COLAESCE(MAX(col1) + 1, 1) FROM table1 
```

注意：如评论中所述，如果您尝试创建递增列，请不要这样做。使用适当的`AUTO_INCREMENT`代替，这​​将不受竞争条件的影响。

### 评论后更新：

您在评论中的内容与您的问题有很大不同。您的语法无效，不应包含`VALUES()`关键字和括号组。相反，这样做：

```
INSERT INTO node (vid, type, uid, title, created, changed, status, promote, sticky)
  SELECT
    COALESCE(MAX(vid) + 1, 1),
    'node',
    1,
    'title', 
    1,1,1,1,1
  FROM node 
```

假设它是主键，则正确的自动递增列定义`vid`如下所示：

```
vid INT NOT NULL PRIMARY KEY AUTO_INCREMENT 
```

使用上述，就没有必要做`MAX(vid) + 1`

# r - t-test 循环返回“找不到对象”错误

> ID：10606498
> 
> 赞同：1
> 
> 时间：2012-05-15T18:13:49.150
> 
> 标签：r, for-loop

在 R 中，假设有一个数据框“mydata”，包括自变量“组”（两组）和 n 个因变量。我想运行 n t-tests（每个因变量一个），通过执​​行以下操作将结果打印并保存在文件中：

```
variables<-names(mydata)
variables<-variables[-1] #to remove the group variable
capture.output(for(i in variables){print(t.test(get(paste("mydata$", i, sep=""))~mydata$group))},file="outputfile.txt") 
```

此命令返回以下错误消息：

```
Error in get(paste("mydata$", i, sep = "")) : object 'mydata$variable1' not found 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:26:05.383

简短的回答：`get`不适`$`用于数据框的元素。

更好的答案：使用构建整个公式`paste`并将其`t.test`作为一个元素发送。另外，使用`lapply`.

```
set.seed(5)
x <- matrix(round(runif(100,0,10),1), ncol=10)
colnames(x) <- paste("var", 1:ncol(x), sep="")
mydata <- data.frame(group=gl(2,10), x)

variables <- names(mydata)[-1]
names(variables) <- variables

out <- lapply(variables, function(v) {
  t.test(as.formula(paste(v, "~ group")), data=d)
})

out 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T18:27:43.443

对于其他人，一些示例数据：

```
mydata <- data.frame(group=sample(1:2, 100, replace=T), variable1=rnorm(100), variable2=rnorm(100), variable3=rnorm(100)) 
```

我会使用更直接的方法：

```
for(i in variables) {
   t.test(mydata[i], mydata$group)
} 
```

如果我使用 for 循环。但是，您可以使用更类似于 R 的样式来执行此操作：

```
lapply(variables, function(v, df=mydata) t.test(df[v], df$group)) 
```

# javascript - Javascript 的问题 - JQuery 和选择器

> ID：10606502
> 
> 赞同：0
> 
> 时间：2012-05-15T18:14:20.300
> 
> 标签：javascript, jquery, jquery-selectors

我有以下代码：

```
 <div id="imgThumb">
        <img id="t1" src="images/cards/1.png" style="display:none; "/><img id="t13" src="images/cards/13.png" style="display:none; "/>img id="t15" src="images/cards/15.png" style="display:none; "/><img id="t16" src="images/cards/16.png" style="display:none; "/>            
    </div>
    <div id="cardHolder" class="rounded-border">
        <div class="title"></div>
        <div id="cardsInvestigated"><h1>In hand</h1>
            <div value="t1" class="impar tecnologia unselected investigated">Adrenalina GreenDragonFly</div><div value="t15" class="impar tecnologia unselected investigated">Diplomatico Wissenland</div>            </div>
        <div id="cardsNotInvestigated"><h1>Not investigated</h1>
            <div value="t13" class="par tecnologia unselected notinvestigated">Centinela Saisei</div><div value="t16" class="par tecnologia unselected notinvestigated">Emboscada Arthuria</div>
        </div>
    </div> 
```

然后我有以下javascript：

```
 $('.investigated.active').click(function(){
    //jugar tarjeta
    alert ('jugar');
})

$('.notinvestigated.active').click(function(){
    //investigar tarjeta
    alert ('investigar');
})

$(".unselected").click(function (){
    alert('click on unselected')
    $('#'+$('.active').attr('value')).toggle();
    $('.active').removeClass('active').addClass('unselected');
    //$(this).addClass('active');
    $(this).removeClass('unselected').addClass('active');
    $('#message div:last-child').remove();
    $('#message').append('<div id="message1">Has seleccionado la tarjeta '+$(this).text()+'</div>');
    $('#'+$(this).attr('value')).toggle();

}) 
```

现在，当我单击 div 时，它可以完美运行并更改类（删除未选择并添加活动）但是当我再次单击它时，它会触发未选择功能而不是活动功能。谁能告诉我发生了什么事？

**答案**：正如 Felix 所建议的，以下代码有效：

```
 $('#cardHolder').on('click','.investigated.active',(function(){
    alert ('jugar');
}))

$('#cardHolder').on('click','.notinvestigated.active',(function(){
    //investigar tarjeta
    alert ('investigar');
}))

$("#cardHolder").on("click",'.unselected',(function(){
    alert('click on unselected')
    $('#'+$('.active').attr('value')).toggle();
    $('.active').removeClass('active').addClass('unselected');
    //$(this).addClass('active');
    $(this).removeClass('unselected').addClass('active');
    $('#message div:last-child').remove();
    $('#message').append('<div id="message1">Has seleccionado la tarjeta '+$(this).text()+'</div>');
    $('#'+$(this).attr('value')).toggle();

})) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:19:30.063

当您的 jquery 运行时，它会将操作绑定到 html 标签。更改他们的类不会使他们触发不同的事件，因为点击回调已经被绑定。您正在寻找的是绑定事件的“on”方法。

Live 不会将事件绑定到标签本身，而是绑定到文档，并且无论何时单击文档，它都会查看单击的内容是否与选择器匹配。

[http://api.jquery.com/on/](http://api.jquery.com/on/)

基本上，而不是这样做

```
$('.investigated.active').click(function(){ 
```

你会这样做

```
$('.investigated.active').on("click",function(){ 
```

# asp.net-mvc-3 - MVC3中reportviewer控件的回发问题

> ID：10606506
> 
> 赞同：1
> 
> 时间：2012-05-15T18:14:30.347
> 
> 标签：asp.net-mvc-3, reportviewer

我需要在我的 ASP.net MVC3 应用程序中使用 reportviewer 控件。VS2010 报表查看器 V10.0

我尝试使用以下解决方案。我创建了用户控件并将reportviewer控件放在那里。

[如何在 asp.net mvc 3 razor 视图中使用 reportviewer 控件？](https://stackoverflow.com/questions/6144513/how-can-i-use-a-reportviewer-control-in-an-asp-net-mvc-3-razor-view/7176529#7176529)

代码与上面链接中显示的相同。

问题是， - 如果我点击下一页或最后一页，它只会留在那里。- 如果我允许用​​户输入参数，然后单击报表查看器上的查看报表按钮，它什么也不做。

我知道原因，它失去了它的状态。它的回发问题。如果它的常规aspx页面我可以通过“！IsPostBack”在page_load中控制它，但如何在用户控制中做到这一点。我尝试将 IsPostback 放在控制 page_load 上，但它总是错误的。

我的代码与上面链接中列出的相同。我正在使用用户控制。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T10:26:00.637

这将解决问题并在回发时使 IsPostBack=true ：

```
<script runat="server">
    private void Page_Init(object sender, System.EventArgs e)
    {
        Context.Handler = this.Page;
    }
</script> 
```

# c# - 这在 Parallel Stack 窗口中意味着什么？

> ID：10606512
> 
> 赞同：4
> 
> 时间：2012-05-15T18:14:56.340
> 
> 标签：c#, visual-studio-2010, task-parallel-library

几个小时前我试图检测死锁。

当我暂停程序时，我在“并行任务”窗口中看到了此信息

![UI线程中的死锁](../Images/51e7e551f9a301acdd08a30d4dd6c20b.png)

我想知道为什么第一个任务没有显示“位置”、“任务”或“线程分配”？

这是 UI 的线程（主线程）吗？

这是否意味着这是在 UI 线程上运行的任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:49:07.630

也许任务 #1 是[计划任务](http://msdn.microsoft.com/en-us/library/dd998369.aspx)：

> 计划任务在此列中没有值。

# nginx - NGINX 上的图像重写

> ID：10606515
> 
> 赞同：1
> 
> 时间：2012-05-15T18:15:12.113
> 
> 标签：nginx

我在 nginx 上有一个应用程序。一个链接到我们网站上的图像的网站，我们需要重写一个新的：

```
From: /static/v20/images/lorem/ipsum/square6.png
To: /static/v31/images/ipsum/example/square8.png 
```

这是我尝试过的：

```
rewrite ^/static/(.*)/images/lorem/ipsum/(.*).png
    /static/v31/images/ipsum/example/$2.png; 
```

我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:08:22.740

```
rewrite ^/static/(?:.+)/images/lorem/ipsum/(.+)\.png$
         /static/v31/images/ipsum/example/$1.png; 
```

# android - Android，通过 webview 启动意图

> ID：10606520
> 
> 赞同：0
> 
> 时间：2012-05-15T18:15:31.113
> 
> 标签：android, html, webview

我正在尝试实现一些东西，我有一个简单的本机应用程序，其中包含一个 webview 和一个我编写的托管在网络上的网站。

这个想法是我的 Android 应用程序加载（以及后来的 iOS 也将受支持），我正在将其加载到 webview 中的网站。但是，其中一个网页 id="LaunchNativeApp" 上有一个元素，当收到 onClick 时，我想从我的本机应用程序启动条码扫描器的意图。我该怎么做呢？

一个用例是：

1.  用户启动原生安卓应用

2.  本机 android 应用程序加载 www.mywebsiteaddress.co.uk

3.  用户浏览 www.mywebsiteaddress.co.uk 并进入页面 www.mywebsiteaddress.co.uk/inputDetails

4.  用户在文本输入字段中单击

5.  本机 android 应用程序加载相机

6.  用户读取条形码

7.  插入文本输入字段的条形码

8.  项目清单

第 1 到 3 步我可以做，第 4 到 8 步我需要一些建议，如果这可能的话，有什么想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T14:33:18.950

您还可以使用 addJavascriptInterface(Object, String) 以便您可以从 javascript 调用 java 对象的方法。您不需要将脚本放在页面服务器端，通过调用 mWebView.loadUrl("javascript: {your javascript code here} "); 注入一些javascript就足够了 如果您知道页面中的 HTML 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:36:59.790

在您的网页上，您可以实现类似于第 4 步的 javascript 代码：

window.location = 'myApp://message?param=X¶m2=Y';

然后在您的 WebView 中，您将有一个 WebViewClient shouldOverrideUrlLoading 实现：

```
mWebView.setWebViewClient(new WebViewClient() 
{

    public boolean shouldOverrideUrlLoading(WebView view, String url)
    {

        // handle myApp links
        if (url.startsWith("myApp"))
        {
            try
            {
                java.net.URI uri = new java.net.URI(url);

                // MESSAGE
                if (uri.getHost().equalsIgnoreCase("message"))
                {
                          // do something here...(e.g. load Camera activity)
                }

            }
            catch (Exception e)
            {
            }

            return (true);
        }

        return (false);
    }

}); 
```

您会在您的本地代码中“捕获”javascript 调用并响应它们（例如加载相机活动等）。

然后，您可以通过回调页面 DOM 将结果返回给您的 WebView

```
String str = String.format("javascript:{your javascript code here}");
mWebView.loadUrl(str); 
```

# java - 选中时显示 JTable 行的信息

> ID：10606521
> 
> 赞同：2
> 
> 时间：2012-05-15T18:15:37.107
> 
> 标签：java, swing, jtable

选中时如何显示`JTable`一行的信息？

我将简要解释我正在尝试做什么，然后发布我创建的 SSCCE，以防我的任何解释令人困惑。

我希望能够单击表格中的任何行并在面板上显示该信息。我不确定我需要利用什么来完成工作。

我想我需要使用：

*   `table.getSelectedRow()`
*   `MouseListener()`
*   `ListSelectionListener()`

我以前没有使用过 Listeners，所以我只知道那些来自阅读文章/文档，同时研究我需要做什么才能完成工作。

对于如何在我的 JPanel 上显示信息，我也有些困惑。面板是在主类中创建的，而表是在其自己的类中创建的。

我感谢任何帮助和建议。

**示例来源：**

```
import javax.swing.JFrame;
import javax.swing.JSplitPane;
import javax.swing.SwingUtilities;
import java.awt.BorderLayout;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;

public class SwingTesting {

    private final JFrame frame;
    private final TablePane tablePane;
    private final JSplitPane splitPane;
    private final JPanel infoPanel;

    public SwingTesting() {
        tablePane = new TablePane();
        infoPanel = new JPanel();
        frame = new JFrame();

        splitPane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, tablePane, infoPanel);

        frame.add(splitPane);
        frame.pack();
        frame.setVisible(true);
    }

    class TablePane extends JPanel {

        private final JTable table;
        private final TableModel tableModel;
        private final ListSelectionModel listSelectionModel;

    public TablePane() {
        table = new JTable();
        tableModel = createTableModel();
        table.setModel(tableModel);
        table.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        table.add(table.getTableHeader(), BorderLayout.PAGE_START);
        table.setFillsViewportHeight(true); 

        listSelectionModel = table.getSelectionModel();
        table.setSelectionModel(listSelectionModel);
        listSelectionModel.addListSelectionListener(new SharedListSelectionHandler());
        table.setSelectionModel(listSelectionModel);

        this.setLayout(new GridBagLayout());
    GridBagConstraints gbc = new GridBagConstraints();
    gbc.anchor = GridBagConstraints.NORTHWEST;
    gbc.fill = GridBagConstraints.BOTH;
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.gridheight = 1;
    gbc.gridwidth = 3;
    gbc.insets = new Insets(5, 5, 5, 5);
    gbc.ipadx = 2;
    gbc.ipady = 2;
    gbc.weightx = 1;
    gbc.weighty = 1;
        this.add(new JScrollPane(table), gbc);
    }

    private TableModel createTableModel() {
        DefaultTableModel model = new DefaultTableModel(
            new Object[] {"Car", "Color", "Year"}, 0 
        ){
            @Override 
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };

        addTableData(model);
        return model;
    }

    private void addTableData(DefaultTableModel model) {
        model.addRow(new Object[] {"Nissan", "Black", "2007"});
        model.addRow(new Object[] {"Toyota", "Blue", "2012"});
        model.addRow(new Object[] {"Chevrolet", "Red", "2009"});
        model.addRow(new Object[] {"Scion", "Silver", "2005"});
        model.addRow(new Object[] {"Cadilac", "Grey", "2001"});
    }

    class SharedListSelectionHandler implements ListSelectionListener {

        @Override
        public void valueChanged(ListSelectionEvent e) {
            ListSelectionModel lsm = (ListSelectionModel) e.getSource();
            String contents = "";

            if(lsm.isSelectionEmpty()) {
                System.out.println("<none>");
            } else {
                int minIndex = lsm.getMinSelectionIndex();
                int maxIndex = lsm.getMaxSelectionIndex();
                for(int i = minIndex; i <= maxIndex; i++) {
                    if(lsm.isSelectedIndex(i)) {
                        for(int j = 0; j < table.getColumnCount(); j++) {
                            contents += table.getValueAt(i, j) + " ";
                        }
                    }
                }
                System.out.println(contents);
            }
        }

    }
}

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new SwingTesting();
            }
        });
    }
} 
```

这并不像我想要的那样表现。它打印出双倍的信息。

所以不是`Chevrolet Red 2009`打印出来`Chevrolet Red 2009 Chevrolet Red 2009`。最终，我想将文本放在 JLabel 中并将其放在面板上。请记住，包含 JLabel 的面板与表格属于不同的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:37:43.207

```
table.getModel().addTableModelListener(tableModelListener); 
```

详情请参阅[`TableModel.addTableModelListener(TableModelListener)`](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/TableModel.html#addTableModelListener%28javax.swing.event.TableModelListener%29)。

* * *

基于SSCCE。

![带有选择详细信息的 GUI](../Images/be4e8334394cd1bef810d13540c12190.png)

```
import javax.swing.*;
import java.awt.*;
import javax.swing.event.*;
import javax.swing.table.*;

public class SwingTesting {

    private final JFrame frame;
    private final TablePane tablePane;
    private final JSplitPane splitPane;
    private final JPanel infoPanel;

    JTextField make = new JTextField(9);;
    JTextField color = new JTextField(7);;
    JTextField year = new JTextField(4);

    public SwingTesting() {
        tablePane = new TablePane();
        infoPanel = new JPanel(new FlowLayout(5));

        infoPanel.add(new JLabel("Make"));
        infoPanel.add(make);
        infoPanel.add(new JLabel("Color"));
        infoPanel.add(color);
        infoPanel.add(new JLabel("Year"));
        infoPanel.add(year);

        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        splitPane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, tablePane, infoPanel);

        frame.add(splitPane);
        frame.pack();
        frame.setVisible(true);
    }

    class TablePane extends JPanel {

        private final JTable table;
        private final TableModel tableModel;
        private final ListSelectionModel listSelectionModel;

    private void setFields(int index) {
        make.setText(table.getValueAt(index, 0).toString());
        color.setText(table.getValueAt(index, 1).toString());
        year.setText(table.getValueAt(index, 2).toString());
    }

    private void clearFields() {
        make.setText("");
        color.setText("");
        year.setText("");
    }

    public TablePane() {
        table = new JTable();
        tableModel = createTableModel();
        table.setModel(tableModel);
        table.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        table.add(table.getTableHeader(), BorderLayout.PAGE_START);
        table.setFillsViewportHeight(true);

        listSelectionModel = table.getSelectionModel();
        table.setSelectionModel(listSelectionModel);
        listSelectionModel.addListSelectionListener(new SharedListSelectionHandler());
        table.setSelectionModel(listSelectionModel);

        this.setLayout(new GridBagLayout());
    GridBagConstraints gbc = new GridBagConstraints();
    gbc.anchor = GridBagConstraints.NORTHWEST;
    gbc.fill = GridBagConstraints.BOTH;
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.gridheight = 1;
    gbc.gridwidth = 3;
    gbc.insets = new Insets(5, 5, 5, 5);
    gbc.ipadx = 2;
    gbc.ipady = 2;
    gbc.weightx = 1;
    gbc.weighty = 1;
        this.add(new JScrollPane(table), gbc);
    }

    private TableModel createTableModel() {
        DefaultTableModel model = new DefaultTableModel(
            new Object[] {"Car", "Color", "Year"}, 0
        ){
            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };

        addTableData(model);
        return model;
    }

    private void addTableData(DefaultTableModel model) {
        model.addRow(new Object[] {"Nissan", "Black", "2007"});
        model.addRow(new Object[] {"Toyota", "Blue", "2012"});
        model.addRow(new Object[] {"Chevrolet", "Red", "2009"});
        model.addRow(new Object[] {"Scion", "Silver", "2005"});
        model.addRow(new Object[] {"Cadilac", "Grey", "2001"});
    }

    class SharedListSelectionHandler implements ListSelectionListener {

        @Override
        public void valueChanged(ListSelectionEvent e) {
            ListSelectionModel lsm = (ListSelectionModel) e.getSource();
            String contents = "";

            if(lsm.isSelectionEmpty()) {
                System.out.println("<none>");
            } else {
                int minIndex = lsm.getMinSelectionIndex();
                int maxIndex = lsm.getMaxSelectionIndex();
                if (minIndex==maxIndex) {
                    setFields(minIndex);
                } else {
                    clearFields();
                    for(int i = minIndex; i <= maxIndex; i++) {
                        if(lsm.isSelectedIndex(i)) {
                            for(int j = 0; j < table.getColumnCount(); j++) {
                                contents += table.getValueAt(i, j) + " ";
                            }
                        }
                    }
                    System.out.println(contents);
                }
            }
        }

    }
}

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new SwingTesting();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:33:51.100

我会用

*   `table.getSelectedRow()`可能是安全的，直到/没有实施`RowSorter`or `RowFilter`，否则你必须`convertViewToModel`

*   `MouseListener`为了`JToolTip`

*   `ListSelectionListener()`是直接的方法，但是

一个）`setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);`

b) 测试 if `row > -1`，否则没有选择任何行

c) 那么就没有理由思考或减少`I would prefer to have double/multi click disabled.`

*   `frame.getContentPane().add(splitPane);`不需要`ContentPane`从 Java5使用

*   新`SwingTesting();`请阅读[初始线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)

编辑：

如何在[此处](https://stackoverflow.com/a/6901508/714968)、[此处](https://stackoverflow.com/a/8187799/714968)或[顶部示例中使用](https://stackoverflow.com/a/7052751/714968)[ListSelectionListener](http://www.java2s.com/Tutorial/Java/0260__Swing-Event/0460__ListSelectionListener.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:23:40.857

好吧，我认为使用自定义`MouseListener`不像使用可以在每一行的单独列上`ButtonColumn`呈现的特殊那样可行`JButton`，您只需`ActionListener`为`JButton`.

更多信息可以在这里找到： [表格按钮列](http://tips4java.wordpress.com/2009/07/12/table-button-column/)

# html - 图像不会显示在文本旁边

> ID：10606524
> 
> 赞同：0
> 
> 时间：2012-05-15T18:15:50.617
> 
> 标签：html, css

这是我的代码：

```
<div id="banner">
  <h1 class="title">Sam Clark</h1> <img src="Images/twitter.png" width="35" height="35" alt="Twitter" id="twitter-img" />
  </div> 
```

图像显示在新行上...我该如何阻止它？顺便说一句，我刚刚意识到我不需要它水平居中......对不起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:18:04.337

`<h1>`元素是块级元素，这意味着它会默认占用输入宽度。如果您希望图像与文本显示在同一行，您需要在元素*内*定义它，与文本一起。

```
<h1 align="center" class="title">
    Sam Clark <img src="Images/twitter.png" width="35" height="35" alt="Twitter" id="twitter-img" />
</h1> 
```

如果您尝试将图像向左或向右浮动，则需要在元素*之前定义它。*`<h1>`

* * *

经过一番尝试，我找到了一种方法，使图像旁边的文本垂直居中，同时保持标题本身内文本的水平居中，但它涉及添加一个额外的（非语义）元素。

```
<h1 class="title">
    <span><img src="Images/twitter.png" width="35" height="35" alt="Twitter" id="twitter-img" /> Sam Clark</span>
</h1> 
```

```
h1.title {
    text-align: center;
}
h1.title span {
    display: inline-block;
    line-height: 35px;
}
h1.title span img {
    float: right;
    margin-left: 7px;
} 
```

[请参阅 jsFiddle。](http://jsfiddle.net/yp55G/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:17:33.037

`h1`默认情况下显示`display`为`block`. 要更改这一点，请使用此 CSS：

```
#banner .h1 {
    display: inline;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:17:50.610

`<h1>`元素是块级元素。您可以选择非块级元素（例如`<span>`）或更改`<h1>`元素的样式并设置`display:inline;`。

前任：

```
#banner h1.title {
    display: inline;
} 
```

另一种选择是将图像放在`<h1>`标签内，然后将图像的垂直对齐属性设置为中间。

```
<div id="banner">
  <h1 align="center" class="title">Sam Clark <img src="Images/twitter.png" width="35" height="35" alt="Twitter" id="twitter-img" style="vertical-align:middle" /></h1>
</div>​ 
```

# ruby - 如何通过调用块方法在 ruby 中构建字符串？

> ID：10606528
> 
> 赞同：1
> 
> 时间：2012-05-15T18:16:12.410
> 
> 标签：ruby, string-concatenation, block

我想要做的是定义一个方法来获取块中每个方法的结果（或调用块中的每个方法）并返回结果字符串......

例如：

```
def a_method(&block)
    ## build a string by calling each of the blocks methods
end

def brackets(str)
    '('+str+')'
end

a_method do
    brackets "foo"
    brackets "bar"
end

# desired output => (foo)(bar) 
```

我尝试`yield`输入`a_method`，但正如我所料，它只返回块中最后一个评估的表达式（在本例中为`(bar)`）。

我已经查看了如何从块内的调用构建字符串，但找不到任何东西。我原以为这将是一种相当普遍的技术..有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:00:22.513

您可以使用 DSL 对象来处理此问题，从而为您提供更大的灵活性：

```
class StringBuilder
  def method_missing(method, *args, &block)
    @strings << (@original_self.send method, *args, &block)
  end

  def build(&block)
    @strings = []
    @original_self = eval "self", block.binding
    instance_eval &block
    @strings.join(' ') #format as you like
  end
end 
```

现在在需要的地方使用：

```
sb = StringBuilder.new
sb.build do
  brackets "foo"
  brackets "bar"
end
#=> (foo) (bar) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:45:11.760

如果你非常想使用块来创建你的字符串，你将不得不使用聪明的方法来记住它。其中一种方法是使用字符串实例并评估其上的块。

```
def a_method(&block)
  "".instance_eval(&block)
end

def brackets(str)
  self << "(#{str})"
end

str = a_method do
  brackets "foo"
  brackets "bar"
end

puts str
#=> (foo)(bar) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:34:32.817

```
["foo", "bar"].map(&method(:brackets)).join 
```

**更新**如果您想使用各种方法的另一种方法：

```
def a_method(&block)
    ## build a string by calling each of the blocks methods
    p block[].join
end

def brackets(str)
    '('+str+')'
end

a_method do
    [ brackets("foo"),
      brackets("bar") ]
end 
```

# php - 使用 PHP 编辑 .XML 文件

> ID：10606529
> 
> 赞同：-2
> 
> 时间：2012-05-15T18:16:16.513
> 
> 标签：php, xml

我有一个 xml 文件，我想创建一个表单/表格来使用 PHP 添加、编辑和删除记录。

有什么方法可以创建一个显示所有结果的表，并允许我编辑或删除表示 XML 文件中完整记录的表的特定行？

我希望能够仅使用我的网络浏览器添加/编辑/删除标签，而无需编辑 pc 上的 xml 文件并上传到 FTP ..

我需要用 PHP、javascript 或任何其他方式完成此操作。

> 请不要给我simpleXML的链接，因为我试过了，但我没有让它工作，因为我对PHP一无所知:(

如果有人能为我做这将不胜感激！谢谢！

我的 xml 文件 (scores.xml) 看起来像这样：

```
<SCORES>
<GAME>
<DATE>14.5.2012 12:05</DATE>
<TIME>FT</TIME>
<HOMETEAM>Team1</HOMETEAM>
<SCORE>4 - 0</SCORE>
<AWAYTEAM>Team2</AWAYTEAM>
<OTHER> </OTHER>
<INFO><![CDATA[<img class='info1' src='images/info.png' width='14px' height='14px' border='0' />]]></INFO>
<INFOID>info1</INFOID>
<INFODATA>FIRST BUBBLE</INFODATA>
</GAME>
</SCORES> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:20:28.210

[使用SimpleXML](http://php.net/manual/en/book.simplexml.php)加载和操作它，然后使用 PHP [FTP 库](http://www.php.net/manual/en/book.ftp.php)上传它。

# php - Zend Soap on 1and1

> ID：10606530
> 
> 赞同：0
> 
> 时间：2012-05-15T18:16:17.010
> 
> 标签：php, zend-framework, soap, soap-client

好吧，你们所有的 1and1 天才。我想在我的 1and1 主机上使用 Zend Soap 客户端（ [http://framework.zend.com/manual/en/zend.soap.client.html ）。](http://framework.zend.com/manual/en/zend.soap.client.html)我的主机包应该支持开箱即用的 ZF，但我不认为它支持。当我尝试以下代码时

```
<?php
$client = new Zend_Soap_Client('/path/to/WSDL');
var_dump($client);
?> 
```

我收到一个错误

```
Fatal error: Class 'Zend_Soap_Client' not found 
```

所以我下载了 ZF，现在将它上传到我网站根目录的文件夹中。我似乎找不到下一步该做什么的任何答案。我知道我需要将 ZF 库文件夹链接到我的包含路径。这可以通过 .htaccess 或 php.ini 文件来完成吗？我也可以单独使用 Zend Soap 类，还是必须使用其他 Zend 框架的东西？

谢谢。

编辑：奇怪的是，包含路径在根目录中正确设置，但在任何子目录中都没有。我将包含路径添加到每个子目录中的新 php.ini 文件中，并且有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:05:31.120

添加

```
require_once 'Zend/Loader/Autoloader.php'; 
```

到脚本的开头。

如果它不起作用，请检查**脚本中的**包含路径- 它应该包含 libzend-framework-php 目录

```
<?php
echo get_include_path(); 
```

如果不是，您可以将其报告给 1and 1 或在脚本开头手动设置

```
<?php
set_include_path(get_include_path() . PATH_SEPARATOR . "directory with zend framework"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:30:27.940

您应该做的第一件事是在 php.ini 文件夹中设置包含路径，或者执行 phpinfo() 来获取当前包含路径。然后将 zend lib 放在该路径中。最后只需要 Zend/Soap 文件夹中的 Client.php 脚本。

# jquery - 使用 Jquery 的 mvc3 搜索结果

> ID：10606532
> 
> 赞同：1
> 
> 时间：2012-05-15T18:16:44.510
> 
> 标签：jquery, asp.net-mvc-3, search

我正在开发一个 Asp.Net MVC3 webapplication。我有一个文本框和一个按钮。我使用 MVC WebGrid 根据搜索字符串在 UI 中显示数据。我正在尝试使用 jquery 拉出没有页面回发的 mvc webgrid。我需要 Jquery 代码中的一些帮助来填充数据而无需回发。

我现在正在做的是 jquery on button click 或 on selected item 我正在将选定的 id 重定向到页面，如下所示。

```
 select: function (event, ui) { 
                $.ajax({ url: 'ControllerName', 
                    type: 'POST', 
                    data: { id: ui.item.id 
                    }, 
                    async: false, 
                    success: function (result) { 
                        window.location.replace("ControllerName" + '?id=' + ui.item.id); 
                    } 
                }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:56:55.663

通过使用`$.support`（参见[http://api.jquery.com/jQuery.support/](http://api.jquery.com/jQuery.support/)），您可以检查是否启用了 AJAX：

```
 $.support.ajax 
```

一旦我们知道是否启用了 AJAX，我们就可以构建一个智能搜索按钮。让我们在 MVC 中设置你的控制器/动作：

```
public ActionResult Search(string q)
{
     //TODO: Some logic to perform a search
     MySearchResultsModel results = new MySearchResultsModel(); //Populate results with some model of data

     if (Request.IsAjaxRequest())
          return PartialView("_Results", results); //partial view w/ results
     else
          return View("Search",results); //Returns a full page
} 
```

现在我们的控制器操作已设置为执行搜索，我们需要两个不同的视图：

*   将呈现搜索结果的 HTML 的局部视图（称为“_Results”）
*   如果浏览器不（称为“搜索”）支持 AJAX，将包装部分视图的完整视图

现在，“搜索”页面看起来像：

```
@model MySearchResultsModel
<h2>Search Results</h2>
@Html.Partial("_Results",model) 
```

“_Results”将包含原始 HTMl 或使用您的 MVC WebGrid：

```
 @model  MySearchResultsModel
 <ul>
 @foreach(var result in MySearchResultsModel.Results)
 {
      <li>@result.SomeProperty</li>
 }
 </ul> 
```

现在，如何使这一切正常工作？假设您的页面上有一个 id 为“searchResults”的 div：

```
 <div id="searchResults"></div> 
```

您需要一个表格进行搜索：

```
 <form action="@Url.Action("Search")" id="searchForm">
      <input type="text" name="q" value=""/>
      <input type="submit" value="Search"/>
 </form> 
```

你需要一些 JS 来捕获表单提交

```
 $(function(){
      $('#searchForm').submit(function(e){
           if($.support.ajax) //Is AJAX enalbed?
           {
                e.preventDefault(); //prevent the form from submitting

               //Send the request via AJAX
               $.ajax({
                    type: 'POST',
                    url: $(this).attr('action'), //Read the action from the FORM url OR you could use @Url.Action('Search')
                    data: $(this).serialize(),  //The forms data
                    success: function (response) {
                        $('#searchResults').html(response); //This sets the DIV's contents to the AJAX response
                    },
                    error: function () {
                        alert('An error occured while performing your search');
                    }
                });

           } 
      });
 }); 
```

# c# - 如何使用 XPath 搜索 XML 文件，使用 C# 返回找到的节点的行号和列号？

> ID：10606534
> 
> 赞同：1
> 
> 时间：2012-05-15T18:16:46.470
> 
> 标签：c#, xml, xpath, position, line

我想用 C# 搜索大约一百个人类可读的缩进 XML 文件，使用 XPath 表达式，它应该返回每个找到的节点的文件名和行位置（以及列位置会很好），匹配 XPath .

我的目标是：将所有这些文件反序列化为一个对象树，其中包含几十个类，甚至程序中的更多实例。它的类有时是历史悠久的，需要进化/清理/重构。在更改之前我想检查更改的部分是否在任何地方使用，因为这些文件正在与不同的客户一起使用。稍后我将使用 XSLT 自动更改 XML 文件，同时改进代码。

奢侈的想法是构建一个用于在文件中搜索的 VS2010 插件——就像普通的“在文件中查找”对话框一样，但使用 XPath 作为搜索模式。

我发现 - 到目前为止 - 这里没有合适的东西，就像我的问题相反： [如何从 C# 中的行号和列号中找到 XML 节点？](https://stackoverflow.com/questions/9226108/how-to-find-an-xml-node-from-a-line-and-column-number-in-c) 但作为输入，会有 XPath 表达式，而不是节点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T21:58:08.077

我以这种方式解决了它（以下代码的摘要）：

1.  将每个文件读入一个实例`XPathDocument`
2.  使用方法`CreateNavigator`
3.  使用`Select`带有正则 XPath 表达式的方法
4.  处理每个找到的节点：
    1.  通过以下方式递归评估此文档的 xml 节点树中的绝对位置
        *   `XPathNavigator.MoveToPrevious()`
        *   `XPathNavigator.MoveToParent()`
        *   直到不再有前任/父母
        *   结果是一个可以写为“绝对”XPath 的列表，例如`//*[1]/*[10]/*[1]/*[3]`，它标识与 found 相同的节点。
    2.  再次读取整个 XML 文件，但使用 XML 阅读器（使用[http://msdn.microsoft.com/en-us/library/system.xml.ixmllineinfo%28v=vs.110%29](http://msdn.microsoft.com/en-us/library/system.xml.ixmllineinfo%28v=vs.110%29)的示例代码）
    3.  调整该代码，当前节点的“绝对”位置是已知的，并将其与找到的“绝对”位置进行比较，直到找到
    4.  如果找到，则 XmlReader 的当前节点包含最终需要的信息：
        *   XML文件中搜索节点的行号和列号:-)

这是快速编写的代码示例（方法搜索是入口点）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.XPath;
using System.Xml;
using System.IO;
using System.Diagnostics;

namespace XmlFileSearchMVP
{

    public class XmlFileSearchModel : IXmlFileSearchModel
    {
        public XmlFileSearchModel()
        {

        }

        /// <summary>
        /// Search in all files (fitting the wildcard pattern in <paramref name="filter"/>) from the directory
        /// <paramref name="path"/> for the XPath and report each found position in a string in the return value with
        /// the informations:
        /// + absolute file name path
        /// + number of found occurrence
        /// + line number
        /// + column number
        /// </summary>
        /// <param name="path">file system path, containing the XML files, that have to be searched</param>
        /// <param name="filter">file name with wildcards, e. g. "*.xml" or "*.mscx" or "*.gpx"</param>
        /// <param name="xPath">XPath expression (currently only Xml Node resulting XPaths ok)</param>
        /// <returns></returns>
        public IList<string> Search(string path, string filter, string xPath)
        {

            string[] files = System.IO.Directory.GetFiles(path, filter);

            var result = new List<string>();

            for (int i = 0; i < files.Length; i++)
            {
                XPathDocument xpd = new XPathDocument(files[i]);
                var xpn = xpd.CreateNavigator();
                var xpni = xpn.Select(xPath);

                int foundCounter = 0;
                while (xpni.MoveNext())
                {
                    foundCounter++;
                    var xn = xpni.Current;

                    var xnc = xn.Clone();

                    List<int> positions = new List<int>();
                    GetPositions(xn, ref positions);
                    string absXPath = GetAbsoluteXPath(positions);

                    // ok if xPath is looking for an element
                    var xpn2 = xpn.SelectSingleNode(absXPath);
                    bool samePosition = xnc.IsSamePosition(xpn2);

                    int y = -1;
                    int x = -1;
                    bool gotIt = GotFilePosition(files[i], positions, ref y, ref x);

                    result.Add(string.Format("{0} No. {1}: {2} {3} line {4}, col {5}", files[i], foundCounter, absXPath, gotIt, y, x));

                }
                result.Add(files[i] + " " + foundCounter.ToString());
            }

            return result;
        }

        /// <summary>
        /// Evaluates the absolute position of the current node.
        /// </summary>
        /// <param name="node"></param>
        /// <param name="positions">Lists the number of node in the according level, including root, that is first element. Positions start at 1.</param>
        private static void GetPositions(XPathNavigator node, ref List<int> positions)
        {
            int pos = 1;

            while (node.MoveToPrevious())
            {
                pos++;
            }

            if (node.MoveToParent())
            {
                positions.Insert(0, pos);
                GetPositions(node, ref positions);
            }
        }

        private static string GetAbsoluteXPath(List<int> positions)
        {
            StringBuilder sb = new StringBuilder("/", positions.Count * 5 + 1); // at least required...

            foreach (var pos in positions)
            {
                sb.AppendFormat("/*[{0}]", pos);
            }

            return sb.ToString();

        }

        /// <summary>
        /// base code from
        /// http://msdn.microsoft.com/en-us/library/system.xml.ixmllineinfo%28v=vs.110%29
        /// </summary>
        /// <param name="xmlFile"></param>
        /// <param name="positions"></param>
        /// <param name="line"></param>
        /// <param name="column"></param>
        /// <returns></returns>
        public static bool GotFilePosition(string xmlFile, List<int> positions, ref int line, ref int column)
        {

            // Create the XmlNamespaceManager.
            XmlNamespaceManager nsmgr = new XmlNamespaceManager(new NameTable());

            // Create the XmlParserContext.
            XmlParserContext context = new XmlParserContext(null, nsmgr, null, XmlSpace.None);

            // Create the reader.
            using (FileStream fs = new FileStream(xmlFile, FileMode.Open, FileAccess.Read))
            {
                List<int> currPos = new List<int>();
                XmlValidatingReader reader = new XmlValidatingReader(fs, XmlNodeType.Element, context);

                try
                {
                    IXmlLineInfo lineInfo = ((IXmlLineInfo)reader);
                    if (lineInfo.HasLineInfo())
                    {

                        // Parse the XML and display each node.
                        while (reader.Read())
                        {

                            switch (reader.NodeType)
                            {
                                case XmlNodeType.Document:
                                case XmlNodeType.Element:
                                    Trace.Write(string.Format("{0} {1},{2}  ", reader.Depth, lineInfo.LineNumber, lineInfo.LinePosition));

                                    if (currPos.Count <= reader.Depth)
                                    {
                                        currPos.Add(1);
                                    }
                                    else
                                    {
                                        currPos[reader.Depth]++;
                                    }
                                    Trace.WriteLine(string.Format("<{0}> {1}", reader.Name, GetAbsoluteXPath(currPos)));

                                    if (HasFound(currPos, positions))
                                    {
                                        line = lineInfo.LineNumber;
                                        column = lineInfo.LinePosition;
                                        return true;
                                    }
                                    break;

                                case XmlNodeType.Text:
                                    Trace.Write(string.Format("{0} {1},{2}  ", reader.Depth, lineInfo.LineNumber, lineInfo.LinePosition));
                                    Trace.WriteLine(string.Format("{0} {1}", reader.Value, GetAbsoluteXPath(currPos)));
                                    break;

                                case XmlNodeType.EndElement:
                                    Trace.Write(string.Format("{0} {1},{2}  ", reader.Depth, lineInfo.LineNumber, lineInfo.LinePosition));
                                    while (reader.Depth < currPos.Count - 1)
                                    {
                                        currPos.RemoveAt(reader.Depth + 1); // currPos.Count - 1 would work too.
                                    }
                                    Trace.WriteLine(string.Format("</{0}> {1}", reader.Name, GetAbsoluteXPath(currPos)));
                                    break;

                                case XmlNodeType.Whitespace:
                                case XmlNodeType.XmlDeclaration: // 1st read in XML document - hopefully
                                    break;
                                case XmlNodeType.Attribute:

                                case XmlNodeType.CDATA:

                                case XmlNodeType.Comment:

                                case XmlNodeType.DocumentFragment:

                                case XmlNodeType.DocumentType:

                                case XmlNodeType.EndEntity:

                                case XmlNodeType.Entity:

                                case XmlNodeType.EntityReference:

                                case XmlNodeType.None:

                                case XmlNodeType.Notation:

                                case XmlNodeType.ProcessingInstruction:

                                case XmlNodeType.SignificantWhitespace:
                                    break;

                            }

                        }

                    }

                }
                finally
                {
                    reader.Close();
                }
                // Close the reader.

            }
            return false;
        }

        private static bool HasFound(List<int> currPos, List<int> positions)
        {
            if (currPos.Count < positions.Count)
            {
                return false; // tree is not yet so deep traversed, like the target node
            }

            for (int i = 0; i < positions.Count; i++)
            {
                if (currPos[i] != positions[i])
                {
                    return false;
                }
            }
            return true;
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T09:36:21.183

此示例应该可以帮助您入门：

```
using (StringReader stream = new StringReader(xml))
{
    XPathDocument document = new XPathDocument(stream);
    XPathNavigator navigator = document.CreateNavigator();

    XPathExpression expression = navigator.Compile("/path/to/element");
    XPathNodeIterator iterator = navigator.Select(expression);

    try
    {
        while (iterator.MoveNext())
        {
            XPathNavigator current = iterator.Current;
            string elementValue = current.Value;

            IXmlLineInfo lineInfo = current as IXmlLineInfo;
            if (lineInfo != null)
            {
                int lineNumber = lineInfo.LineNumber;
                int linePosition = lineInfo.LinePosition;
            }
        }
    }
    catch
    {
    }
} 
```

# git - `git svn rebase` vs `git rebase trunk`

> ID：10606535
> 
> 赞同：15
> 
> 时间：2012-05-15T18:16:53.517
> 
> 标签：git, svn, rebase

我正在开发一个使用 subversion 作为其存储库的项目。因为我需要做一些还不能发送到svn服务器的更改，所以我开始使用`git svn`，以便我可以进行本地签入。我的设置如下所示：

**分支：**主干（跟踪 svn 主干）、主干（非常接近 svn 中的内容）和主题。

```
*------------------ trunk
 \
  *-----------*--------- master
               \
                *-------- topic 
```

**工作流程：**

```
[on branch master]
$ git svn fetch
$ git svn rebase
$ git checkout -b topic
$ git rebase master
[hack hack hack]
$ git commit -a
[once upstream is ready for my changes]
$ git svn fetch
$ git checkout master
$ git svn rebase
$ git checkout topic
$ git rebase master
$ git svn dcommit
$ git checkout master
$ git svn rebase
$ git branch -d topic 
```

假设没有人在 and 之间提交 svn `git svn fetch`，那么 run on master 和`git svn rebase`run **on master 基本一样****吗？`git svn rebase``git rebase trunk`**

**是否有更明智的工作流程可供使用？**似乎有很多变化的分支和变基正在进行。我知道我希望能够在 svn 中的任何内容之上重新调整我的工作，但似乎我正在做比严格必要的更多的重新调整。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-18T12:07:57.177

请注意，来自[git svn](http://schacon.github.com/git/git-svn.html)，详见“[为什么用 git-svn 颠倒“我们的”和“他们的”的含义](https://stackoverflow.com/questions/2959443/why-is-the-meaning-of-ours-and-theirs-reversed-with-git-svn/2960751#2960751)：

```
git svn rebase 
```

> 这会从当前 HEAD 的 SVN 父级获取修订，并针对它重新设置当前（未提交到 SVN）的工作。

所以你不需要and`git svn fetch`之前的，特别是如果你只跟踪（父级）。`git checkout master``git svn rebase``trunk``master`

* * *

第二点，`git svn dcommit`将在 SVN 中为每个新提交创建修订`master`，但您的工作流程不会显示任何新提交`master`，仅显示`topic`（从未合并`master`）

* * *

[OP Sean McMillan](https://stackoverflow.com/users/117587/sean-mcmillan)评论：

> 根据文档，`git svn dcommit`如果没有指定分支，则将提交推送到当前 HEAD，而不仅仅是`master`. 所以我从我的分支提交到 SVN，然后依靠 a将提交从 SVN 带回来`git svn rebase`。`master`之后我放弃了`topic`分支`dcommited`。这不是犹太洁食吗？

他详细说明：

> 我还不能将它们发送到 SVN...。上游想要“冻结”主干以进行发布，同时，我正在为下一个版本开发功能。
> 
> 但最终的问题是，“ **git rebase trunk master 是否与 master 分支上的 git svn rebase 相同？** ”如果是，那么我不需要不断更改我的分支，只需针对 SVN 重新设置我的 master 分支。但如果不是，并且当我 git svn rebase 时发生了某种魔法，我想知道。

我回复：

A`git svn fetch`后跟 a`git rebase trunk master`将等效于 a `git svn rebase`。

# jquery - Jquery 在 IE9 上不起作用

> ID：10606536
> 
> 赞同：-1
> 
> 时间：2012-05-15T18:17:05.447
> 
> 标签：jquery, browser

我在我的网页上使用了一个 jquery 表添加行插件，它在我的本地桌面上的 Chrome 和 IE9 上运行良好。

但是当我将项目上传到服务器时，它在 Chrome 上仍然可以正常工作，但在 IE9 上没有任何反应，（有一个添加按钮，当我单击它时，没有添加任何行）。

你知道为什么会这样吗？

我使用最新的 jquery 版本。

编辑：

```
 <table id="tblotherlicence" style="width:800px" cellspacing="2" cellpadding="3">     
        <tr><td class="formtitle" colspan="5">OTHER PROFESSIONAL LICENSURE<a style="font-size:7pt">(e.g.,registered psychiatric nurse; registered massage therapist; registered social worker)</a></td></tr>
        <tr><td class="formlabel">Profession</td>
            <td class="formlabel">Licence Number</td>
            <td class="formlabel">Jurisdiction</td>
            <td class="formlabel">Date of Expiry</td>
            <td class="formlabel"><input class="addrow" type="button" value="Add Row" /></td></tr>
        <tr>
            <td><asp:TextBox ID="Licence1" runat="server"></asp:TextBox>
            </td>
            <td><asp:TextBox ID="LicenceNumber1" runat="server"></asp:TextBox>
            </td>
            <td><asp:TextBox ID="Jurisdiction1" runat="server"></asp:TextBox>
            </td>
            <td><asp:TextBox ID="ExpiryDate1" runat="server"></asp:TextBox></td>
            <td><input class="delrow" type="button" value="Delete Row" /></td>
        </tr>
     </table> 

 <script type="text/javascript">
            $(document).ready(function () {
                $("#<%=ExpiryDate1.ClientID%>").datepicker({
                        yearRange: '1950:2015',
                        changeYear: true, 
                        changeMonth: true,
      257        });
                $(".addrow").btnAddRow(function () {
                    var i;
                    var rowCount = $("#tblotherlicence tr").length;
                    for (i = 3; i <= rowCount; i++) {
                        $("#tblotherlicence tr:nth-child(" + i + ") td:nth-child(4) input[type='text']").attr("id", "MainPlaceHolder_RecordofNursing1_ExpiryDate" + (i - 2));            
                        $("#tblotherlicence tr:nth-child(" + i + ") td:nth-child(4) input[type='text']").removeAttr("class");
                        $("#tblotherlicence tr:nth-child(" + i + ") td:nth-child(4) input[type='text']").datepicker({
                                yearRange: '1950:2015',
                                changeYear: true, 
                                changeMonth: true,
                        });
                    }
                });
                $(".delrow").btnDelRow();
            }); 
    </script> 
```

错误是“SCRIPT1028：预期的标识符，字符串或数字 xxxxx.aspx，第 257 行字符 21”，我已经标记了第 257 行，它只是一个右括号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:11:38.003

这个“问题”并不特定于 jQuery。IE 不喜欢对象声明中的尾随逗号，而其他浏览器会忽略它。

我建议通过[JSLint](http://www.jslint.com/)运行您的代码以捕获此类错误。你可能会得到比在 IE9 中得到的更好的错误消息。你会有更干净的代码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:59:27.063

去掉后面的逗号`changeMonth`

```
$("#<%=ExpiryDate1.ClientID%>").datepicker({
   yearRange: '1950:2015',
   changeYear: true, 
   changeMonth: true // Right here
}); 
```

“预期的标识符、字符串或数字”意味着它收到了与预期不同的东西。在这种情况下，由于您有一个逗号，它希望在 之后出现更多内容`changeMonth`，但您将其关闭。

一些浏览器对这样的拼写错误和小错误往往很宽容，但 IE 更严格。这可能是一件好事（强制执行正确的代码），但这也意味着您会遇到更多错误。

# android - 我什么时候应该实例化 Activity 类？

> ID：10606537
> 
> 赞同：1
> 
> 时间：2012-05-15T18:17:07.653
> 
> 标签：android, android-activity

我看到它允许`Activity`通过`new`关键字实例化。

```
new MainActivity(); 
```

当我这样做时，我立即可以访问它的所有字段、事件等。

![](../Images/774533b6c7af1a5cd109ac58fbcad6fa.png)

那么，我什么时候需要以`Activity`这种方式实例化某个类？我的意思是在哪些情况下。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:22:12.343

绝不。根据您发送的项目，创建`Activity`实例应始终由单独处理。`ActivityManager``Intent`

# c - C中的多维数组

> ID：10606538
> 
> 赞同：0
> 
> 时间：2012-05-15T18:17:08.490
> 
> 标签：c, multidimensional-array

我正在尝试从 .txt 文件中读取的数据创建一个二维数组。
'data.txt' 中的数据如下所示：

```
A;B;4
A;C;5
B;C;8 
```

假设它是对称的。
有没有办法创建一个二维矩阵 [i][j] 并在 d[i][j] = value 中打印？

感谢您的意见/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:30:51.573

当在编译时知道维度时，二维数组很有用。如果是这种情况，其他答案可能会很有用。如果没有，二维数组不适合您。

我建议使用一个简单的一维数组，分配 ( `malloc`) 以具有 n*n 条目。
然后，要访问单元格 i/j，请使用`array[i*n+j]`.

另一种方法是分配一个指向数组的指针数组。创建它更复杂，但您可以将其作为`array[i][j]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:21:49.343

```
int tda[3][3];
tda[1][2] = 'x'; 
```

您还可以将 malloc 用于动态大小的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:29:05.093

正如你所写：

```
#include <stdio.h>

#define N 4

int main(int argc, char **args) {
    int A[N][N], i, j;

    for (i = 0; i < N; i++)
        for (j = 0 ; j < N; j++)
            A[i][j] = i + j;

    for (i = 0; i < N; i++) {
        for (j = 0; j < N; j++)
            printf("%d ", A[i][j]);
        printf("\n");
    }
} 
```

# google-maps - 如何将动态生成的 kml/xml 文件加载到嵌入式 Google 地图中

> ID：10606548
> 
> 赞同：0
> 
> 时间：2012-05-15T18:18:14.487
> 
> 标签：google-maps, google-maps-api-3

您好，对这个问题的任何建议将不胜感激，因为它似乎应该是一个简单的问题，但它给我带来了很大的困难。

我一直在遵循位于[https://developers.google.com/maps/articles/phpsqlajax](https://developers.google.com/maps/articles/phpsqlajax)的教程“使用 PHP/MySQL 和 Google 地图”来生成 kml/xml 文件。我生成的 kml 文件与示例中看到的文件不同，因为我正在生成一系列建筑物的多边形边界，而不仅仅是在特定位置创建地点标记。此页面的代码如下所示...

```
// Creates the Document.
    $dom = new DOMDocument('1.0', 'UTF-8');

    // Creates the root KML element and appends it to the root document.
    $node = $dom->createElementNS('http://earth.google.com/kml/2.1', 'kml');
    $parNode = $dom->appendChild($node);

    // Creates a KML Document element and append it to the KML element.
    $dnode = $dom->createElement('Document');
    $docNode = $parNode->appendChild($dnode);

    //Style 1
    //Set Style ID
    $restStyleNode = $dom->createElement('Style');
    $restStyleNode->setAttribute('id', '#style1');
    $restIconstyleNode = $dom->createElement('IconStyle');
    $restIconstyleNode->setAttribute('id', 'BuildingIcon');

    //Set LineStyle
    $restIconNode = $dom->createElement('LineStyle');
    $restHref = $dom->createElement('colour', 'FF990000');
    $restIconNode->appendChild($restHref);
    $restWidth = $dom->createElement('width', '2');
    $restIconNode->appendChild($restWidth);
    $restIconstyleNode->appendChild($restIconNode);
    $restStyleNode->appendChild($restIconstyleNode);
    $docNode->appendChild($restStyleNode);

    //Set Polystyle
    $restIconNode = $dom->createElement('PolyStyle');
    $restHref = $dom->createElement('colour', 'FFCC0000');
    $restIconNode->appendChild($restHref);
    $restFill = $dom->createElement('fill', '1');
    $restIconNode->appendChild($restFill);
    $restOutline = $dom->createElement('outline', '1');
    $restIconNode->appendChild($restOutline);
    $restIconstyleNode->appendChild($restIconNode);
    $restStyleNode->appendChild($restIconstyleNode);
    $docNode->appendChild($restStyleNode);

    //Style 2
    //Set Style ID
    $restStyleNode = $dom->createElement('Style');
    $restStyleNode->setAttribute('id', '#style2');
    $restIconstyleNode = $dom->createElement('IconStyle');
    $restIconstyleNode->setAttribute('id', 'HighfieldIcon');

    //Set LineStyle
    $restIconNode = $dom->createElement('LineStyle');
    $restHref = $dom->createElement('colour', 'ff000000');
    $restIconNode->appendChild($restHref);
    $restWidth = $dom->createElement('width', '2');
    $restIconNode->appendChild($restWidth);
    $restIconstyleNode->appendChild($restIconNode);
    $restStyleNode->appendChild($restIconstyleNode);
    $docNode->appendChild($restStyleNode);

    //Set Polystyle
    $restIconNode = $dom->createElement('PolyStyle');
    $restHref = $dom->createElement('colour', 'ff000000');
    $restIconNode->appendChild($restHref);
    $restFill = $dom->createElement('fill', '1');
    $restIconNode->appendChild($restFill);
    $restOutline = $dom->createElement('outline', '1');
    $restIconNode->appendChild($restOutline);
    $restIconstyleNode->appendChild($restIconNode);
    $restStyleNode->appendChild($restIconstyleNode);
    $docNode->appendChild($restStyleNode);

    // Iterates through the MySQL results, creating one Placemark for each row.
    while ($row = @mysql_fetch_assoc($result))
        {
            // Creates a Placemark and append it to the Document.

            $node = $dom->createElement('Placemark');
            $placeNode = $docNode->appendChild($node);

            // Creates an id attribute and assign it the value of id column.
            $placeNode->setAttribute('id', 'placemark' . $row['buildingID']);

              // Create name, and description elements and assigns them the values of the name and address columns from the results.
              $nameNode = $dom->createElement('name',htmlentities($row['name']));
              $placeNode->appendChild($nameNode);
              $styleUrl = $dom->createElement('styleUrl', $row['styleID']);
              $placeNode->appendChild($styleUrl);

              // Creates a Polygon element.
              $polygonNode = $dom->createElement('Polygon');
              $placeNode->appendChild($polygonNode);

              //Add extrude information
              $restExtrude = $dom->createElement('extrude', '1');
              $polygonNode->appendChild($restExtrude);

              //Add altitude information
              $restAltitude = $dom->createElement('altitudeMode', 'relativeToGround');
              $polygonNode->appendChild($restAltitude);

              //Add outerBoundaryIsNode
              $outerBoundaryIsNode = $dom->createElement('outerBoundaryIs');
              $polygonNode->appendChild($outerBoundaryIsNode);

              //Add LinearRing Node
              $LinearRingNode = $dom->createElement('LinearRing');
              $outerBoundaryIsNode->appendChild($LinearRingNode);

              //Adding information into linear ring node
              $tessellate = $dom->createElement('tessellate', '1');
              $LinearRingNode->appendChild($tessellate);

              // Creates a coordinates element and gives it the value of the lng and lat columns from the results.
              $coorStr = $row['longitude1'] . ','  . $row['latitude1'] . ' ' . $row['longitude2'] . ',' . $row['latitude2'] . ' ' . $row['longitude3'] . ',' . $row['latitude3'] . ' ' . $row['longitude4'] . ',' . $row['latitude4'] . ' ' . $row['longitude5'] . ',' . $row['latitude5'];
              $coorNode = $dom->createElement('coordinates', $coorStr);
              $LinearRingNode->appendChild($coorNode);
        }

        $kmlOutput = $dom->saveXML();
        header('Content-type: application/vnd.google-earth.kml+xml');
        echo $kmlOutput; 
```

我已经检查了通过将其加载到地图中生成的 kml 文件，我对结果感到满意，但是我无法终生弄清楚如何让我的网站显示我的 php 文件正在生成的任何 kml 文件。我只是想不出该怎么做。我已经尝试按照教程的建议进行操作，但是我真的不明白它在做什么，我无法让它工作。开发 php 代码来动态生成 kml 文件后，我认为我已经完成了困难的部分，我觉得我错了。任何建议将不胜感激，因为它非常重要！

目前我正在使用以下代码：

```
<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=key 
```

" type="文本/javascript">

```
 var map;
            var geoXml; 
            var toggleState = 1;

    function initialize() 
    {
        if (GBrowserIsCompatible())
            {
                geoXml = new GGeoXml("Locationoffile.part");
                map = new GMap2(document.getElementById("map_canvas")); 
                map.setCenter(new GLatLng(50.xxxxx,-1.xxxxxxx), 16); 
                map.addControl(new GLargeMapControl());
                 map.addOverlay(geoXml);
            }
    } 

function toggleMyKml() 
    {
    if (toggleState == 1) 
        {
        map.removeOverlay(geoXml);
        toggleState = 0;
        } 
    else 
        {
        map.addOverlay(geoXml);
        toggleState = 1;
        }
    } 
```

通过将 php 生成的 kml 文件的输出复制到静态位置来生成地图。这行得通。我需要编辑多少才能让它加载我的 php 文件？尽管有你的帮助，我还是有点困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:26:53.643

你可能已经完成了最困难的部分。要在 Google 地图上显示 kml 文件，您可以使用`KmlLayer`[^(api-doc)](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)。请记住，您提供给`KmlLayer`构造函数的 URL 必须是公开可用的 URL，因此您必须确保能够传递可以从 Web 访问的 URL。KML 是动态生成的很好，您只需使其可供 Google 检索。然后，Google 将处理 kml 并生成图块叠加层。这就是您对以下内容的调用将返回的内容：`new google.maps.KmlLayer`。

如果您想测试您的 URL 是否生成有效的 kml，请查看[Galdos KML 验证器](http://www.kmlvalidator.com/home.htm)；您向它提供一个 URL，它会检索并尝试解析您的 KML。这是一个不错的 kml 烟雾测试实用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-22T17:16:13.650

可能有问题。Google 会缓存 kml 文件。每次制作新版本时，您都需要更改保存的 kml 文件名。没有这个，您将继续获取旧的缓存版本而不是最新版本。

# sql - 在 Oracle 中检查字符格式

> ID：10606552
> 
> 赞同：1
> 
> 时间：2012-05-15T18:18:41.407
> 
> 标签：sql, oracle

可能是一个明显的问题，但 Oracle Technet 对我的搜索词并不友好。我想创建一个表并让一个 char 列具有特定的格式。例如，一个检查约束将确保插入的 SSN 字符串采用“###-##-####”格式，包括破折号。如何指定此检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:23:12.480

我从来没有做过类似的事情，但尝试这样的事情：

```
CREATE TABLE suppliers
(   supplier_id numeric(4), 
    supplier_name   varchar2(50),   
    CONSTRAINT check_supplier_id
        CHECK (supplier_id REGEXP_LIKE(testcol, '^... .. ....$');)
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:26:29.237

以特定格式存储数据通常不是一个好主意。格式化只是花里胡哨，不同的情况可能需要不同的格式。将本地化添加到此，很明显这不是一个好主意。

您可能希望在检索数据后进行格式化。这可以通过[Format Models](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements004.htm)来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T07:18:37.907

可以使用数据库触发器完成更复杂的验证。也许你就是你错过的搜索词。

# iphone - UIimageview 加上文本覆盖另存为新图像？

> ID：10606553
> 
> 赞同：0
> 
> 时间：2012-05-15T18:18:44.980
> 
> 标签：iphone, xcode, cocoa-touch

我知道关于如何在图像视图的一部分上覆盖文本框的资源已经足够了。但是，有什么方法可以在上传时将图像+叠加文本保存为新图像？

1.  用户选择照片和图像视图填充图像
2.  用户在图像视图顶部输入文本
3.  用户点击“上传”按钮，图像+文本被渲染为一个新图像，在保存到后端数据库之前在其上合并文本。

这可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:50:30.487

您可以使用 Core Graphics/Quartz 2D 做到这一点。我自己对 Core Graphics 不太熟悉，但请查看此处的文档，该文档描述了使用图像加载图形上下文，然后您可以在修改后将其保存到文件中，或者只是从头开始绘制图像并将其保存出来：

链接 1：[iOS 绘图/打印](http://developer.apple.com/library/ios/#documentation/2ddrawing/conceptual/drawingprintingios/HandlingImages/Images.html#//apple_ref/doc/uid/TP40010156-CH13-SW1 "绘图/打印 iOS")

链接 2：[Quartz 2D 编程指南](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html#//apple_ref/doc/uid/TP30001066 "Quartz 2D 编程指南")

[从Quartz 2D Programming Guide](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_text/dq_text.html#//apple_ref/doc/uid/TP30001066-CH213-TPXREF101 "Quartz 2D 编程指南 - 文本")的“Text”部分下绘制文本的快速示例：

```
void MyDrawText (CGContextRef myContext, CGRect contextRect) // 1
{
  float w, h;
  w = contextRect.size.width;
  h = contextRect.size.height;

  CGAffineTransform myTextTransform; // 2
  CGContextSelectFont (myContext, // 3
                "Helvetica-Bold",
                 h/10,
                 kCGEncodingMacRoman);
  CGContextSetCharacterSpacing (myContext, 10); // 4
  CGContextSetTextDrawingMode (myContext, kCGTextFillStroke); // 5

  CGContextSetRGBFillColor (myContext, 0, 1, 0, .5); // 6
  CGContextSetRGBStrokeColor (myContext, 0, 0, 1, 1); // 7
  myTextTransform =  CGAffineTransformMakeRotation  (MyRadians (45)); // 8
  CGContextSetTextMatrix (myContext, myTextTransform); // 9
  CGContextShowTextAtPoint (myContext, 40, 0, "Quartz 2D", 9); // 10
} 
```

以下是代码的作用：

1.  将图形上下文和要绘制到的矩形作为参数。
2.  声明仿射变换的存储。
3.  将字体设置为 Helvetica，将字体大小设置为页面矩形的高度除以 10。字体大小以文本空间为单位。在此示例中，文本被绘制到一个可调整大小的窗口。当用户调整窗口大小时，文本也会调整大小。编码设置为 kCGEncodingMacRoman，但唯一的其他选择是 kCGEncodingFontSpecific。
4.  将字符间距设置为 10 个文本空间单位。仅当您想在一个字形的原点和下一个字形的原点之间的前进中添加额外的空间时，才调用此函数。
5.  将文本绘制模式设置为填充和描边。
6.  将填充颜色设置为绿色，alpha 值为 0.5，以实现部分透明的填充。请注意，这不是特定于文本的属性。填充颜​​色适用于图形状态。
7.  将描边颜色设置为不透明的蓝色。这是另一个不是文本特定的属性。
8.  创建执行 45 度旋转的仿射变换。MyRadians 例程是一个应用程序定义的便利函数，用于根据弧度计算度数。您要么需要提供自己的例程来将度数转换为弧度，要么需要将此调用替换为指定弧度的值。否则，此代码示例将无法编译。
9.  将文本矩阵设置为上一步中创建的转换。
10.  绘制文本，传递文本空间中的 x 和 y 坐标以在 (40,0) 处开始绘制、要绘制的字符数组以及指定文本数组长度的值。在这种情况下，您传递一个 C 风格的字符串和值 9 来指定字符数。

# java - 找不到符号 - 构造函数 item()

> ID：10606556
> 
> 赞同：0
> 
> 时间：2012-05-15T18:19:18.010
> 
> 标签：java, constructor, symbols, default-constructor

考虑这段代码：

```
// Create a Item oject
item item = new item(); 
```

编译器错误信息：

> 错误 - 找不到符号 - 构造函数 item();

类`item`：

```
public class item
{
    // Attributes
    private String Itemcode;
    private String Itemname;
    private String Description;
    private String Style;
    private String Finish;
    private float  Unitprice;
    private float  Stock;
    private String Suppliercode;
    private String Suppliername;
    private String Address;

    public item(String ItemcodeIn, String ItemnameIn, String DescriptionIn,
                String StyleIn, String FinishIn, float UnitpriceIn, float StockIn,
                String SuppliercodeIn,
                String SuppliernameIn, String AddressIn)
    {
        Itemcode = ItemcodeIn;
        Itemname = ItemnameIn;
        Description = DescriptionIn;
        Style = StyleIn;
        Finish = FinishIn;
        Unitprice = UnitpriceIn;
        Stock = StockIn;
        Suppliercode = SuppliercodeIn;
        Suppliername = SuppliernameIn;
        Address = AddressIn;
    } 
```

此代码之后是属性的所有 setter/getter 方法。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:21:22.137

创建参数化构造函数时，默认构造函数将被删除，除非您创建自己的构造函数。

因此，您必须显式创建一个默认构造函数，如下所示：

```
public Item() {} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-15T18:21:37.680

您需要添加一个默认构造函数：

```
public item() {
   // any initialization you need here
} 
```

您还应该根据最佳实践将您的类重命名为`Item`(capital `I`)，并且您的字段应该以小写字母开头。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T18:23:53.653

你的`Item`类只有 1 个构造函数：

```
public item(String ItemcodeIn, String ItemnameIn, String DescriptionIn, 
     String StyleIn, String FinishIn, float UnitpriceIn, float StockIn, 
     String SuppliercodeIn, String SuppliernameIn, String AddressIn) 
```

尽管您尝试通过`new Item();`此构造函数来访问它，但由于您已用参数化的构造函数覆盖了它，因此该构造函数不存在。

您应该在创建`Item`或创建另一个通用构造函数时提供这些参数：

```
public Item() {
    // Some code goes here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:55:49.010

每当您不编写任何构造函数时，默认构造函数默认在类中可用。但是，如果您在任何类中定义编写参数化构造函数，则只有该参数化构造函数可用。在这种情况下，您将必须显式定义默认构造函数。

# c#-4.0 - 如何在 XNA 中将圆形蒙版应用于纹理？

> ID：10606557
> 
> 赞同：0
> 
> 时间：2012-05-15T18:19:21.207
> 
> 标签：c#-4.0, windows-phone-7.1, textures, xna-4.0

我已经开始使用纯 XNA 4.0 解决方案为 Windows Phone 7.1 开发游戏。游戏本质上将涉及在迷宫中移动，我想在右上角有一个圆圈，显示玩家在迷宫中的位置的缩小视图。

我已经编写了生成随机迷宫的代码，因此我可以渲染所有墙壁，将此渲染保存到内存中的纹理并将其缩放到所需的任何大小。但这将是一个矩形......我需要将它显示在一个圆圈内。

关于最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:01:36.190

您可以使用模板缓冲区...

首先用你的掩码填充模板缓冲区

然后在模板缓冲区中写入具有正确功能的地图。

它可能与此类似：

```
 You fill stencil buffer with a black filled circle rounded by white 
```

之后，使用以下操作绘制地图：

```
 StencilFunction = CompareFunction.GreaterEqual
 StencilPass = StencilOperation.Replace 
```

您可以在此处获取更多信息：

[https://web.archive.org/web/20120507161332/http://www.crappycoding.com/2010/08/texture-modification-using-render-targets-with-some-stencil-buffer-action/](https://web.archive.org/web/20120507161332/http://www.crappycoding.com/2010/08/texture-modification-using-render-targets-with-some-stencil-buffer-action/)

# email - 如何使用 PHP 邮件功能将 PDF 附加到电子邮件

> ID：10606558
> 
> 赞同：14
> 
> 时间：2012-05-15T18:19:28.070
> 
> 标签：email, email-attachments, php

我正在使用 PHP 邮件功能发送电子邮件，但我想将指定的 PDF 文件作为文件附件添加到电子邮件中。我该怎么做？

这是我当前的代码：

```
$to = "me@myemail.com";
$subject = "My message subject";
$message = "Hello,\n\nThis is sending a text only email, but I would like to add a PDF attachment if possible.";
$from = "Jane Doe <janedoe@myemail.com>";

$headers = "From:" . $from; 
mail($to,$subject,$message,$headers);

echo "Mail Sent!"; 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-15T18:23:46.100

您应该考虑使用 PHP 邮件库，例如[PHPMailer](https://github.com/PHPMailer/PHPMailer)，这将使发送邮件的过程更加简单和更好。

下面是一个如何使用PHPMailer的例子，真的很简单！

```
<?php

require_once('../class.phpmailer.php');

$mail             = new PHPMailer(); // defaults to using php "mail()"

$body             = file_get_contents('contents.html');
$body             = eregi_replace("[\]",'',$body);

$mail->AddReplyTo("name@yourdomain.com","First Last");

$mail->SetFrom('name@yourdomain.com', 'First Last');

$mail->AddReplyTo("name@yourdomain.com","First Last");

$address = "whoto@otherdomain.com";
$mail->AddAddress($address, "John Doe");

$mail->Subject    = "PHPMailer Test Subject via mail(), basic";

$mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional, comment out and test

$mail->MsgHTML($body);

$mail->AddAttachment("images/phpmailer.gif");      // attachment
$mail->AddAttachment("images/phpmailer_mini.gif"); // attachment

if(!$mail->Send()) {
  echo "Mailer Error: " . $mail->ErrorInfo;
} else {
  echo "Message sent!";
}

?> 
```

PHPMailer 的替代方案是[http://swiftmailer.org/](http://swiftmailer.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:22:50.050

简单的回答：不要这样做。手动构建 MIME 电子邮件是一项痛苦的工作，而且很容易搞砸。

相反，使用[PHPMailer](http://phpmailer.worxware.com)或[Swiftmailer](http://swiftmailer.org)。用它们做附件几乎是微不足道的，而且你会得到 FAR FAR FAR 更好的反馈，以防万一发生了什么事情，而不是 mail() 屈尊吐出的简单真/假。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-24T18:55:02.870

为了消除弃用错误，

代替

```
$body             = eregi_replace("[\]",'',$body); 
```

和

```
$body             = preg_replace('/\.([^\.]*$)/i','',$body); 
```

# java - 如何在mysql数据库中插入一次数据，然后继续更新？爪哇/安卓

> ID：10606561
> 
> 赞同：0
> 
> 时间：2012-05-15T18:19:42.687
> 
> 标签：java, android, sqlite, boolean

我想做以下事情：我想检查我的数据库表是否已经存在。如果没有，它应该成功（createEntry）。一旦它创建了一条记录，我想继续用新信息更新同一条记录（updateEntry）（所以基本上用新信息覆盖第一条记录）。

我现在使用布尔值的问题是它创建了数据库（这很好），但是当我读取另一个二维码并想要更新我的记录中的信息时，它只是将信息写入第二条记录。基本上它一直在做 createEntry 而不是 updateEntry。

布尔值可能有什么问题？我似乎找不到它。

```
private void insertQR(String doctorID, String doctorFullName, String patientID, String apiKey) {
    DatabaseHelper databaseHelper = new DatabaseHelper(this);
    databaseHelper.open();  
     boolean dbExist = checkDB();

    if (dbExist == true)
    {
        databaseHelper.createEntry(doctorID, doctorFullName, patientID, apiKey);
    }

    databaseHelper.updateEntry(0,doctorID, doctorFullName, patientID, apiKey); 
    databaseHelper.close();
}

private boolean checkDB() {
        SQLiteDatabase checkDB = null;
        try {
            checkDB = SQLiteDatabase.openDatabase("/data/data/rem.med.artesis/databases/qrreader.db", null,
                    SQLiteDatabase.OPEN_READONLY);
            checkDB.close();
        } catch (SQLiteException e) {
            // database doesn't exist yet.
        }
        return checkDB != null ? true : false;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:31:19.823

`checkDB()`如果数据库存在，则返回 true 。因此，您的`if`语句将始终创建该条目。您还需要检查该表是否存在。使用[SQLiteDatabase.query()](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#query%28java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String%5B%5D,%20java.lang.String,%20java.lang.String,%20java.lang.String,%20java.lang.String%29)来确定您的表是否存在。

# c - C尾指针问题中的环形缓冲区（用于音频流）

> ID：10606562
> 
> 赞同：2
> 
> 时间：2012-05-15T18:19:44.743
> 
> 标签：c, audio-streaming

我目前正在编写一个用于音频流的嵌入式应用程序。嵌入式应用程序将接收通过 wifi 发送的音频数据包，缓冲数据包，然后将音频数据发送到解码器芯片。我编写了一个环形缓冲区实现（在 stackoverflow 上的一篇优秀帖子的帮助下），但有时会出现一些奇怪的行为。在音频方面，我在播放过程中听到歌曲的某些部分重复。我发现这是由于尾指针被两次设置到缓冲区的开头。

（在我的实现中，头指针标记有效数据的结尾，而尾指针标记有效数据的开头）

例如，我看到：

*   头指针复位到缓冲区的开始
*   尾指针复位到缓冲区的开始
*   尾指针重置为缓冲区的开头<-这是我听到音频重复的地方
*   头指针复位到缓冲区的开始

这是环形缓冲区的实现：

```
typedef struct ring_buffer
{
    UINT8 *buffer;      /* data buffer */
    UINT8 *buffer_end;  /* end of data buffer */
    size_t capacity;    /* maximum number of mp3Bytes in the buffer */
    size_t count;       /* number of mp3Bytes in the buffer */
    size_t typesize;    /* size of each mp3Byte in the buffer */
    UINT8 *head;        /* ring buffer head pointer */
    UINT8 *tail;        /* ring buffer tail pointer */
} ring_buffer;

PUBLIC UINT8
AppAudioStream_RingBufInit(ring_buffer *rb, size_t capacity, size_t typesize)
{   
    /* alloc buffer of size capacity * typesize */
    rb->buffer = malloc(capacity * typesize);
    if(rb->buffer == NULL)
    {
        printf("ring buffer init fail\r\n");
        return RING_BUF_INIT_FAIL;
    }

    /* init rb buffer to 0 */
    memset(rb->buffer, 0, capacity * typesize);

    /* rb struct element init */
    rb->capacity = capacity;
    rb->buffer_end = rb->buffer + capacity * typesize;
    rb->count = 0;
    rb->typesize = typesize;
    rb->head = rb->buffer;
    rb->tail = rb->buffer;

    return RING_BUF_INIT_DONE;
}

PUBLIC VOID
AppAudioStream_RingBufWrite(ring_buffer *rb, UINT8 *mp3Byte)
{   
    /* default: allow overwriting if ring buffer is full */
    memcpy(rb->head, mp3Byte, rb->typesize);
    rb->head = rb->head + rb->typesize;
    if(rb->head == rb->buffer_end) {
        printf("head back to start\r\n");
        rb->head = rb->buffer;
    }

    if(rb->count == rb->capacity) {
        printf("buffer full\r\n");
        if (rb->head > rb->tail)
            rb->tail = rb->tail + rb->typesize;
    } else { 
        rb->count++;
    }
}

PUBLIC VOID
AppAudioStream_RingBufRead(ring_buffer *rb, UINT8 *mp3Byte)
{
    /* insert 'comfort noise' if the ring buffer is empty */
    if(rb->count == 0){
        printf("buffer empty\r\n");
        *mp3Byte = NOISE_BYTE;
    } else {
        /* copy data to mp3Byte and increase tail pointer */
        memcpy(mp3Byte, rb->tail, rb->typesize);
        rb->tail = rb->tail + rb->typesize;
        if(rb->tail == rb->buffer_end) {
            printf("TAIL back to start\r\n");
            printf("Tbuffer count: %i\r\n", rb->count);
            rb->tail = rb->buffer;
        }   
        rb->count--;
    }
} 
```

以下是调用环形缓冲区写入函数的方式：

```
while (1)
{
    AppAudioStream_BufRecv(sd, dataLen, &addr);
}

PUBLIC VOID 
AppAudioStream_BufRecv(int sd, INT32 dataLen, struct sockaddr_in *addr)
{
    INT32 addrlen = sizeof(struct sockaddr_in);
    UINT8 j, i = 0;
    UINT8 *audioByte;

    /* listen to incoming audio data packets */
    dataLen = recvfrom(sd, (char *) appRxBuf, sizeof(appRxBuf), 0, 
                       (struct sockaddr *)&addr, &addrlen);

    /* set pointer to first element in recieve buffer */
    audioByte = appRxBuf;

    /* buffer received packets into FIFO */
    while (dataLen > 0)
    {
        /* write 1 byte into audio FIFO */
        AppAudioStream_RingBufWrite(&audioFIFO, audioByte);

        /* increase pointer index and update # of bytes left to write */
        audioByte++;
        dataLen--;
    }

    /* wait until buffer is 2/3 full to start decoding */
    if (audioFIFO.count >= FIFO_TWO_THIRD_FULL 
        && audioStreamStatus == GSN_STREAM_BUFFERING) {
        audioStreamStatus = GSN_STREAM_START; 
        //printf("stream start\r\n");
    }
} 
```

环形缓冲区读取函数在每 2 毫秒发生一次的回调中调用（这基本上是一个 ISR）：

```
PRIVATE VOID 
AppAudioStream_DecoderCb(UINT32* pDummy, UINT32 TimerHandle)
{
    UINT8 spiWriteCount = 0;
    UINT8 mp3Byte;
    int i = 0;
    GSN_SPI_NUM_T spiPortNumber = GSN_SPI_NUM_0;

    /* read 32 bytes of data from FIFO and write to SPI */
    while (spiWriteCount < DATA_WRITE_AMT)
    {
        /* set stream status to decoding */
        audioStreamStatus = GSN_STREAM_DECODING;

        /* read 1 byte of audio data from FIFO */
        AppAudioStream_RingBufRead(&audioFIFO, &mp3Byte);

        /* write 1 byte of audio data out to VS1053 */
        AppSpi_SdiByteWrite(spiPortNumber, &mp3Byte);

        /* increase byte written count */
        spiWriteCount++; 
    }
} 
```

非常感谢任何帮助/见解。我确信我现在只是忽略了一些非常明显的东西。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:33:02.930

如果你从回调中读取这个环形缓冲区并从其他地方写入它，那么显然你会得到各种奇怪的错误，因为环形缓冲区缺乏保护。您需要添加互斥锁、信号量、中断禁用或适用于您的特定系统的任何内容。

此外，回调和应用程序其余部分之间共享的所有变量都应声明为 volatile，以防止危险的优化器错误 (*)。除此之外，这些变量可能还需要使用互斥锁进行保护，以防止出现竞争条件。

如果上述任何错误是原因造成的，那么进行压力测试的一个好方法是创建一个多线程应用程序。创建 10+ 个写入缓冲区的线程，以及 10+ 个从缓冲区读取和打印的线程。记录输出并查看是否打印出奇数或垃圾。

* * *

(*) （此评论与线程安全*无关*，所以请不要发表关于 volatile 不足以实现线程安全的评论，因为我从来没有说过，我也不会进行那种愚蠢的辩论再次。）

# mysql - Arvixe 共享主机，MYSQL 数据库的表单身份验证错误

> ID：10606570
> 
> 赞同：2
> 
> 时间：2012-05-15T18:20:30.520
> 
> 标签：mysql, asp.net-mvc, shared-hosting, form-authentication

我有我的实时数据库中存在的所有表单身份验证数据库表的完整副本，我可以看到数据在那里，我可以在我的应用程序上连接和查看单独的数据......但是当我尝试使用我的网站登录时，我得到

*建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）*

然后潜在的错误似乎是它正在尝试创建一组新的用户身份验证表，因为它无法连接到我的 MYSQL DB。我这么说是因为堆栈跟踪错误：

```
[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +5103182
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +260
   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover) +389
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject, Boolean withFailover) +197
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout) +963
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +195
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +316
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +5119675
   System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup) +31
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +76
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +126
   System.Data.SqlClient.SqlConnection.Open() +125
   System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString) +82

**[HttpException (0x80004005): Unable to connect to SQL Server database.]**
   System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString) +137
   System.Web.Management.SqlServices.SetupApplicationServices(String server, String user, String password, Boolean trusted, String connectionString, String database, String dbFileName, SqlFeatures features, Boolean install) +94
   System.Web.Management.SqlServices.Install(String database, String dbFileName, String connectionString) +27
   System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString) +395 
```

我的 Web.config 文件看起来像

```
<remove name="LocalMySqlServer" />

<add name="mydbEntities" connectionString="metadata=res://*/DataEntity.csdl|res://*/DataEntity.ssdl|res://*/DataEntity.msl;provider=MySql.Data.MySqlClient;provider connection string=&quot;server=servername;User Id=id;password=password;Persist Security Info=True;database=mydb&quot;" providerName="System.Data.EntityClient" />
<add name="MySqlMembershipConnection" connectionString="server=localhost; user id=id; password=password; persist security info=true; database=mydb;" providerName="MySql.Data.MySqlClient"/> 
```

```
<roleManager enabled="true" />
<membership defaultProvider="MySqlMembershipProvider">
  <providers>
    <clear />
    <add name="MySqlMembershipProvider" 
         type="MySql.Web.Security.MySQLMembershipProvider, 
         MySql.Web, 
         Version=6.4.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" 
         autogenerateschema="true" 
         connectionStringName="MySqlMembershipConnection" 
         enablePasswordRetrieval="false" 
         enablePasswordReset="true" 
         requiresQuestionAndAnswer="false" 
         requiresUniqueEmail="false" 
         passwordFormat="Hashed" 
         maxInvalidPasswordAttempts="5" 
         minRequiredPasswordLength="6" 
         minRequiredNonalphanumericCharacters="0" 
         passwordAttemptWindow="10" 
         passwordStrengthRegularExpression="" 
         applicationName="/" />
  </providers>
</membership> 
```

我不确定为什么它找不到我的 MYSQL 数据库，或者是什么事件链导致登录过程失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:23:50.293

这个问题归结为我没有指定完整的成员资格、配置文件和角色管理器选项。一旦我填写了这些并将我的应用程序定向到我的 MySQL 数据库，它就会停止尝试创建自己的数据库来处理这些功能。下面是我的 web.config 文件需要包含的 3 个部分的示例……希望这可以减轻其他人的挫败感，我得说 Arvxie 支持在这个问题上没有帮助。

```
<membership defaultProvider="MySqlMembershipProvider">
  <providers>
    <clear />
    <add name="MySqlMembershipProvider" type="MySql.Web.Security.MySQLMembershipProvider, MySql.Web, Version=6.4.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" autogenerateschema="false" connectionStringName="MySqlMembershipConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" passwordStrengthRegularExpression="" applicationName="/" />
  </providers>
</membership>
<profile>
  <providers>
    <add name="MySQLProfileProvider" type="MySql.Web.Profile.MySQLProfileProvider, MySql.Web, Version=6.4.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" connectionStringName="MySqlMembershipConnection" applicationName="/" />
  </providers>
</profile>
<roleManager enabled="true" defaultProvider="MySQLRoleProvider">
  <providers>
    <add connectionStringName="MySqlMembershipConnection" applicationName="/" name="MySQLRoleProvider" type="MySql.Web.Security.MySQLRoleProvider, MySql.Web, Version=6.4.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" />
  </providers>
</roleManager> 
```

# git - git统计数据是什么意思？

> ID：10606583
> 
> 赞同：2
> 
> 时间：2012-05-15T18:21:29.267
> 
> 标签：git

我可能不知道如何搜索它，但找不到执行 git pull 或“git show --stat 947a403”时显示的 git 统计信息（--stat 不在手册页中）它应该是行 ins/del，但它们并不真正匹配。

```
 TODO                           |    6 +++-
 htdocs/main/js/ek.balcony.js   |   18 +++++++---
 htdocs/main/js/ek.face.js      |    3 +-
 htdocs/main/js/ek.main.js      |    2 +-
 htdocs/main/js/ek.tsakiseis.js |    2 +-
 octave/.point2tsak.m.kate-swp  |  Bin 66 -> 0 bytes
 octave/initialiseEdf-balc.m    |   68 ------------------------------------
 octave/initialiseEdfbalc.m     |   75 ----------------------------------------
 8 files changed, 22 insertions(+), 152 deletions(-) 
```

这些数字和 + 和 - 是什么？这有点像 levenshtein 距离吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:25:34.620

这些显示文件已更改以及在每个文件中添加和删除的行。在您的示例中，更改了 3 个文件，在 ek.face.js 中，添加了一行，删除了一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:24:31.923

```
TODO ... 3 additions 1 deletion
htdocs/main/js/ek.balcony.js ... 7 additions 3 deletions
htdocs/main/js/ek.face.js ... 1 addition 1 deletion 
```

至于数字……我不是 100% 确定的。添加/删除多少行可能是行数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T10:34:16.983

好吧，手册在这里：http: [//invisible-island.net/diffstat/](http://invisible-island.net/diffstat/)或 diffstat(1) 计数由 diff 报告。+/- 和计数之间的差异只是四舍五入。

# asp.net - 从数据库下载exe文件

> ID：10606586
> 
> 赞同：3
> 
> 时间：2012-05-15T18:21:46.463
> 
> 标签：asp.net, vb.net

我有一些 exe 文件已上传到我的数据库中，因为我不希望它们可以公开访问。我尝试使用链接按钮和通用处理程序使用以下代码提供文件：

```
Context.Response.Clear()
Context.Response.ContentType = "application/exe"
Context.Response.AppendHeader("Content-Disposition", "filename=program.exe")
Context.Response.BinaryWrite(binaryfile) 
```

问题：谷歌浏览器不会将下载视为任何其他 exe，而是在下载后报告“program.exe 不经常下载，可能很危险”。带有“放弃”按钮和“保留”下载的选项隐藏在上下文菜单下。

是否有任何其他/更好的方式来提供存储在数据库中的 exe 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:27:28.603

我`application/exe`在野外很少见到。`application/octet-stream`用于可执行文件更为常见。

如果您使用的是 .NET，那么我暂时假设您使用的是 IIS。（如果不是这种情况，请纠正我。）如果是这样，那么[这个（旧的，但仍然有用的）MIME 类型和文件扩展名列表](http://technet.microsoft.com/en-us/library/bb742440.aspx)可能会有所帮助。

自然，您将无法真正从服务器端绕过任何浏览器端限制。您可以修改发送给客户端的标头，但最终取决于客户端如何处理响应。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:27:39.730

您是否检查过这个问题： [绕过 Chrome 的恶意文件警告](https://stackoverflow.com/questions/9512919/getting-around-chromes-malicious-file-warning)

Jeff G 建议注册 Google 网站管理员工具并添加您的网站。Google 需要几天的时间来抓取您的网站并填写任何信息，但它最终会停止认为您的文件是恶意文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-22T11:29:29.697

就我而言，我使用以下一组标题解决了它：

```
Cache-Control: max-age=864000
Content-type: application/octet-stream
Content-Disposition: attachment; filename="....zip"
Content-Transfer-Encoding: binary
Last-Modified: ...
Etag: ...
Content-Length: ... 
```

格外注意 Content-type、Cache-Control、Last-Modified 和 Etag，它们似乎对我很有帮助。

# html - 使用表单助手进行奇怪的字符串转换

> ID：10606594
> 
> 赞同：0
> 
> 时间：2012-05-15T18:22:25.543
> 
> 标签：html, cakephp, encoding, cakephp-2.0

我有以下代码：

```
<?php 

     $select_options = array();
     foreach($delivery_options as $option)
     {
        $select_options[$option->getDeviceId()] = $option->getDeviceName();
        echo $select_options[$option->getDeviceId()]; 
     }

     echo $this->Form->input('default_device', array( 
        'type' => 'select', 
        'options' => $select_options, 
        'value' => $default_device,
        'label' => '', 
    ));

?> 
```

在 foreach 循环中，每个回声都返回： `abc'abc` 在 html 源代码中，它看起来像这样`abc&#39;abc`

然后在选择输入：`abc&#39;abc` 在html源代码中：`abc&amp;#39;abc`

这意味着`&`char from`abc&#39;abc`已转换为它的 html 编码 -`&amp`但它是如何发生的？

我也尝试了 htmlentities() 和 htmlspecialchars() 但这仍然没有帮助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:28:31.373

> select 输入类型允许一个名为 'escape' 的特殊 $option 属性，它接受 bool 并确定是否对 HTML 实体编码选择选项的内容。默认为真。

尝试将其设置为 false。

```
echo $this->Form->input('default_device', array( 
        'type' => 'select', 
        'options' => $select_options,
        'escape' => false, // like so
        'value' => $default_device,
        'label' => '', 
)); 
```

# php - 从 Xpath 查询中选择单个节点

> ID：10606597
> 
> 赞同：0
> 
> 时间：2012-05-15T18:22:30.763
> 
> 标签：php, xml, xpath

我正在使用此代码从 xml 中提取所有必需的节点：

```
$xml = simplexml_load_file('file.xml');

    echo "<strong>Using direct method...</strong><br />";
    $items = $xml->xpath('/w:document/w:body/w:tbl/w:tr/w:tc/w:p/w:r/w:t');
    foreach($items as $item) {
        echo "Found $item<br />";
    } 
```

我得到一长串条目，但我需要有可能单独选择其中任何一个。尝试使用 `echo "Found $item[2]<br />";`但出现错误：

> `Warning: main() [function.main]: Cannot add element t number 1 when only 0 such elements exist`感谢您的建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:35:33.803

如果要提取第二个`w:t`元素，请改用 xpath 中的索引。

```
$item = list($xml->xpath('(/w:document/w:body/w:tbl/w:tr/w:tc/w:p/w:r/w:t)[3]')); 
```

**注意** `3`表示第三个`w:t`元素。Xpath 索引从而`1`不是`0`. 并且`list`用于获取第一个元素，因为 Xpath 总是返回一个数组。

**另请注意**`(//w:r/w:t)[3]`，除非在其他地方有相同的树可用，否则此 XPath 可以减少。所以看起来像

```
$item = list($xml->xpath('(//w:r/w:t)[3]')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:38:00.397

它应该`echo "found $items[2]<br />";`代替`$item[2]`

# ruby-on-rails - Ruby on Rails - Heroku 部署问题

> ID：10606598
> 
> 赞同：0
> 
> 时间：2012-05-15T18:22:36.753
> 
> 标签：ruby-on-rails, database, deployment, heroku

我似乎遇到了一个障碍，在这里和其他论坛上搜索过，但什么也没有。我正在运行 rails 3.2.3 和 ruby​​ 1.9.3 并想在 heroku 上部署我的应用程序。

我已经创建了雪松，虽然我可以`git push heroku master`得到一个完整的 500 服务器错误。我怀疑是因为我的数据库不在那里。但是，我似乎无法到达那里。我跑过：

`heroku run rake db:create`-> 这给出了一些关于弃用的警告，然后`dkhgclqccm already exists`

所以它已经存在了？所以让我们迁移它：

`heroku run rake db:migrate` 然而，这输出：

```
<deprecation errors>
rake aborted!
An error has occurred, this and all later migrations canceled:

PG::Error: ERROR:  relation "hphotos" does not exist
: ALTER TABLE "hphotos" ADD COLUMN "description" character varying(255)

Tasks: TOP => db:migrate
(See full trace by running task with --trace) 
```

该特定迁移是：

```
class AddDescriptionToHphotos < ActiveRecord::Migration
  def change
    add_column :hphotos, :description, :string
  end
end 
```

对我来说似乎很好，不知道为什么它给我这个错误：/

最后一件事，即使这个迁移成功了，我的数据库也会是空的，我的seeds.rb 没有数据库的所有必要数据。所以我想推孔DB。

```
heroku db:push         
 !    Taps Load Error: cannot load such file -- sqlite3
 !    You may need to install or update the taps gem to use db commands.
 !    On most systems this will be:
 !
 !    sudo gem install taps 
```

为什么会出现这个？我安装了 'heroku' gem 和 'taps' gem，我在我的 gem 文件中得到了这个：

```
group :development, :test do
  gem 'mysql2'
end
group :production do
  gem 'pg'
end 
```

此外，当我运行时`heroku run rake db:version`，它显示： 当前版本：20120508130957 这实际上是我当前版本的 5 次迁移，但我无法迁移它，如我上面提到的错误所示......

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:50:24.513

Heroku 带有一个数据库设置（这就是为什么`db:create`不起作用）。你试过`heroku run rake db:schema:load`吗？这应该将您的 schema.rb 文件加载到数据库中。`db:migrate`这比每次设置新数据库时都要好得多

编辑：

对于您关于水龙头的最后一个问题，它似乎正在尝试在本地使用 sqlite，但您的 Gemfile 中只有 pg。您可能在 config/database.yml`adapter: sqlite`中。因此，要么您需要在本地使用 postgres 并将该适配器更改为 postgres，要么走更简单的路线并在本地使用 sqlite 并将其添加到 :development 组。

请注意，heroku 仅使用 postgres，因此我不建议从 mysql 开发，因为在某些语法以及您如何在两个平台之间做一些事情时存在一些不一致之处。再说一次，如果您只使用与 ANSI 兼容的查询或仅使用 rails 的方法来激活查询，那么无论哪种方式都应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:23:52.603

我认为你需要仔细检查你的迁移，看看你是否真的有一个文件说：

```
 def up
    create_table :hphotos do |t|
      [...]
    end 
```

似乎该表尚未远程创建，您正在尝试对其进行修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-29T08:31:34.493

解决方案是不仅将 Taps gem 添加`sqlite3`到 Gemfile 中，还将 gem 添加到`:development`组中。如果您`sqlite3`在开发中使用，那么添加`taps`gem 就足够了。

但是由于您正在使用`mysql2`您的开发，因此要解决该问题，您必须同时添加两者。

```
group :development do
  gem 'taps'
  gem 'sqlite3'
end 
```

# c# - 为什么枚举文件多次返回同一个文件？

> ID：10606599
> 
> 赞同：1
> 
> 时间：2012-05-15T18:22:42.143
> 
> 标签：c#, winforms, io, .net

我有这个代码（感谢那些迄今为止一直在帮助的人）

它搜索目录和所有子目录以查找文件名。

```
Files.Clear(); //BindingList<FileInfo> Datasource for a datagridview

Task.Factory.StartNew( () =>
    {
       DirectoryInfo dir = new DirectoryInfo(MainFolder);

       foreach(var file in dir.EnumerateFiles("*" + textBox1.Text + "*.doc?", SearchOption.AllDirectories).Take(200))
       {
          this.BeginInvoke( new Action(() =>
             {
                Files.Add(file);
             }));
       }
     }); 
```

问题是，如果我设置`textBox1.text`为我知道只有 1 个的东西，它会将其添加到`Files`4 次。我尝试中断指向它以确保它不是我显示它的方式。

我将这 4 个对象相互比较，它们是相同的。当我稍微打开搜索条件并获得 5 个结果时，其中一些是 1，一些是两倍，一些是三倍。所以有 5 个独特的结果，但总共有 10-12 个。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:26:29.143

使用调用。

您的 lambda 正在捕获正在变异的变量文件。您不仅会得到重复文件，还会丢失文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:28:54.083

您直接使用枚举变量

如果将变量复制到局部变量，应该没问题

文件.清除（）；//datagridview的BindingList数据源

```
 Task.Factory.StartNew( () =>
    {
        DirectoryInfo dir = new DirectoryInfo(MainFolder);
        foreach(var file in dir.EnumerateFiles("*"+textBox1.Text+"*.doc?",SearchOption.AllDirectories).Take(200))
        {
            var currentFile = file;
            this.BeginInvoke( new Action(() =>
            {
                Files.Add(currentFile);
            }));
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:51:24.243

这应该工作得更快并且有更好的清晰度。

```
var searchPattern = "*" + textBox1.Text + "*.doc?";
Files.Clear(); //BindingList<FileInfo> Datasource for a datagridview
DirectoryInfo dir = new DirectoryInfo(MainFolder);
Files.AddRange(dir.EnumerateFiles(searchPatten, SearchOption.AllDirectories).ToList()); 
```

为什么最初您使用所有异步操作？

# python - 使用 mySQLdb 在 Python 中编写 MySQL 数据库

> ID：10606604
> 
> 赞同：0
> 
> 时间：2012-05-15T18:23:20.440
> 
> 标签：python, mysql, mysql-python

所以我有以下代码，它可以工作：

```
for count in range(0,1000):
    L=[random.randint(0, 127),random.randint(0, 127),random.randint(0, 127)]
    random.randint(0, 127)
    name=''.join(map(chr,L))

    number=random.randint(0,1000)

    x.execute('insert into testTable set name=(%s), number=(%s)', (name, number)) 
```

上面，x 只是我制作的光标（显然）。我只是从 ASCII 值和一个随机数创建一个随机字符串并将其写入我的数据库（这是一个纯粹的 BS 示例，所以我知道它有效）/

然后，

我有另一个脚本：

```
x.execute('insert into rooms set \
        room_name=(%s),\
        room_sqft=(%s),\
        room_type=(%s),\
        room_purpose=(%s) ,\
        room_floor_number=(%s)',
        (name, sqft, roomType, room_use_ranking, floor)) 
```

我得到一个语法错误：第一行的语法无效，就在 x. x.execute 的一部分。

两条线有什么不同？在问题代码中，除名称之外的所有参数都是整数（名称是字符串），它们是从捕获错误输入错误的 int(raw_input(...)) 类型提示符获取的。

显然这是可行的，但是第二段代码出了什么问题？

谢谢，nkk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T22:10:35.417

x.execute 之前的行有问题。（此时 x 是出乎意料的）。你能链接更多的文件吗？

另外，试试这种格式，它可以通过将字符串变成一个 blob 来清除这类事情。（您的语法荧光笔也应该将其显示为一个大的多行字符串！）

```
sql = '''
    INSERT INTO rooms
    SET room_name=(%s),
        room_sqft=(%s),
        room_type=(%s),
        room_purpose=(%s),
        room_floor_number=(%s)
'''

x.execute(sql, (name, sqft, roomType, room_use_ranking, floor)) 
```

# ruby-on-rails - 使用/不使用 OAuth 和 OpenID 构建 API

> ID：10606609
> 
> 赞同：1
> 
> 时间：2012-05-15T18:23:32.010
> 
> 标签：ruby-on-rails, ruby, api, oauth, openid

我需要开发一个 API 作为 Web APP 的核心。我最初的想法是制作一个 REST API 来处理所有请求，然后为 Web、移动和桌面创建一些客户端。

我的问题是，我应该如何管理这种情况的身份验证？我考虑过使用一个令牌，该令牌将与所有对 REST API 的请求一起传递。我的情况是，我不想拥有像 OAuth 这样的东西，因为生态系统不会像 Facebook/Twitter 那样拥有多个应用程序。注意：我必须将 API 与 Web 客户端分开。

更详细地说，我会请求 POST /users/auth 传递他们的密码和用户名，并接收一个身份验证令牌。

这是一个好方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T15:02:04.817

同意 Devise 非常适合应用程序中的身份验证。对于 API 级别，3scale 可以提供很大帮助（http://www.3scale.net）——它负责处理速率限制、密钥、oauth 秘密分发、分析、开发人员门户和其他内容。有一个 ruby​​ 插件可以从这里开始：[https](https://github.com/3scale/3scale_ws_api_for_ruby) ://github.com/3scale/3scale_ws_api_for_ruby 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:16:08.117

[Devise](http://github.com/plataformatec/devise)是一个很棒的 gem，可以处理 rails 应用程序中的身份验证。它还提供基于令牌的身份验证。您可以在网上找到许多资源（例如[这里](http://matteomelani.wordpress.com/2011/10/17/authentication-for-mobile-devices/)），解释如何使用它。毫无疑问，它将适合您的情况。

# sql - 如何在 Oracle APEX 中设置 SPOOL 脚本以将视图数据导出为 CSV？

> ID：10606613
> 
> 赞同：0
> 
> 时间：2012-05-15T18:23:42.390
> 
> 标签：sql, oracle, sqlplus, oracle-apex, spool

我在 APEX 中有一个视图，我想将其作为 CSV 文件导出到驱动器（该文件将被其他应用程序的进程拾取）。有 UTIL_FILE 方法，但它似乎要复杂得多。如何使用 SPOOL 将视图导出为 CSV？我试过这个，但它无法在 Apex 内部运行？所以我想我不确定脚本本身，也不确定在哪里保存/安排它。

```
spool out.csv
select '"'|| EVENT_ID || '",' || ENTER_DATE || ',' || START_TIME || ',' || END_TIME || ',' || PLANNED_FLAG || ',' || PURPOSE
 || ',' || TITLE || ',' || SERVICES || ',' || CAUSES || ',' || TICKET_NUM || ',' || OWNER || ',' || DETAILS from DT_FULLVIEW;
spool off
exit​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T06:42:23.273

有几种方法可以做到这一点。

1) 您可以使用操作系统实用程序创建您的脚本并安排它在数据库之外使用 SQLPLUS 运行。

2) dbms_scheduler 据说可以运行外部程序。（我自己从来没有这样做过）。

3) 创建一个打包过程，使用 utl_file_dir 创建文件并从数据库中调度它。

# javascript - 在文件输入上动态启动事件

> ID：10606614
> 
> 赞同：1
> 
> 时间：2012-05-15T18:23:44.183
> 
> 标签：javascript, forms, file, file-upload, input

我正在寻找一种动态“单击”浏览按钮的方法，`input type="file".`我有一个包含 onclick 事件的按钮，我想单击该事件的浏览按钮，然后将提交表单`input type="file",`的 onchange 事件`input type="file"`文件被选中。我不知道如何“点击” `input type="file"`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:31:06.937

您需要做的就是从所需元素的单击处理程序中调用`click`该元素的函数。`input`

```
<input type="file" id="files" name="files[]" multiple />
<div id="clickme">Click Me to Open File Browser</div>

document.getElementById('clickme').onclick = function() {
   document.getElementById('files').click(); 
} 
```

这是一个有效的[JSFiddle](http://jsfiddle.net/brantolsen/5ckx5/)来展示它的实际效果。

# visual-c++ - 更改 Visual C++ 应用程序字体

> ID：10606616
> 
> 赞同：1
> 
> 时间：2012-05-15T18:23:50.190
> 
> 标签：visual-c++, fonts, gdi

如何在 Visual C++ 应用程序中更改所有对话框表单中的字体？

我想设置 Tahoma 风格。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:21:16.153

您可以在创建对话框的资源中设置对话框的[字体。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381003%28v=vs.85%29.aspx)我相信这也会改变所有标准控件的字体。如果您有自定义控件，则必须做额外的工作。

请注意，如果您想让字体与计算机的默认 UI 字体匹配，则可以使用虚拟字体，例如“MS Shell Dlg 2”，它将映射到 XP 上的 Tahoma 和 Vista+ 上的 Segoe UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T00:31:26.037

在应用程序的每个对话框中替换字体将是一项相当乏味的工作。您可以使用 MFC 为您做这件事。检查您的应用程序的 InitInstance。看看 AfxEnableControlContainer(); 即使 AfxEnableControlContainer 被声明为

```
void AFX_CDECL AfxEnableControlContainer(COccManager* pOccManager=NULL); 
```

COccManager 是一个非常有趣的类，当有 occ（OLE 自定义控件）支持时使用，管理 OLE 容器和站点类。默认情况下，所有 MFC 应用程序都是使用 occ 支持创建的。如果您在向导生成的代码中没有看到 AfxEnableControlContainer，则说明您没有启用 occ 支持。

无论如何，而不是使用默认的 occ 实现，使用 own 并更改它以更改字体。从 COccManager 派生类。在此示例中，我将其称为 CDlgOccManager。覆盖虚拟 PreCreateDialog：

```
virtual const DLGTEMPLATE* PreCreateDialog(_AFX_OCC_DIALOG_INFO* pOccDialogInfo,
    const DLGTEMPLATE* pOrigTemplate); 
```

在实施中：

```
const DLGTEMPLATE* CDlgOccManager::PreCreateDialog(_AFX_OCC_DIALOG_INFO* pOccDialogInfo, const DLGTEMPLATE* pOrigTemplate)
{
    CDialogTemplate RevisedTemplate(pOrigTemplate);
    // here replace font for the template
    RevisedTemplate.SetFont(_T("Tahoma"), -16);

    return COccManager::PreCreateDialog (pOccDialogInfo, (DLGTEMPLATE*)RevisedTemplate.Detach());
} 
```

现在您正在更改所有对话框的字体。请记住更改 AfxEnableControlContainer 调用：

```
PROCESS_LOCAL(CDlgOccManager, pManager);

BOOL CDlgFontChangeApp::InitInstance()
{
    AfxEnableControlContainer(pManager.GetData());
.
.
.
} 
```

不要忘记

```
#include "DlgOccManager.h" 
```

对于 MFC 的新版本，包括用于旧版本的 afxdisp.h，用于 COccManager 的 occimpl.h。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T00:39:59.073

我刚刚注意到一些事情。这不是一个错误，但它需要一个解释。我已经将这段代码保存在我的存储库中很长时间了。那时 DLL 将所有数据保持为全局数据，从而使加载此 dll 的所有模块都可以使用数据。为了强制将数据存储在 TLS 区域中，我使用了 PROCESS_LOCAL 宏，该宏扩展为调用仍然存在的 CProcessLocal 类。您可以删除此宏并将其替换为：

```
BOOL CDlgFontChangeApp::InitInstance()
{
    CDlgOccManager* pManager = new CDlgOccManager();
    AfxEnableControlContainer(pManager);
.
.
.
} 
```

# ruby-on-rails - 使用简单表单嵌套导轨表单？

> ID：10606619
> 
> 赞同：3
> 
> 时间：2012-05-15T18:24:01.407
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, simple-form

如何实现嵌套的导轨形式？我无法正确设置此设置。现在我有：

```
<%= simple_form_for @user do |f| %>

  <%= f.input :city %>
  <%= f.input :address %>
  <%= f.input :zipcode %>
  <%= f.association :interests, :as => :check_boxes, :label => false %>
  <%= f.association :holidays, :as => :check_boxes, :label => false %>

  <%= f.simple_fields_for :friend_birthdays do |friend_birthday| %>
    <%= f.input :name %>
    <%= f.input :gender, :collection => ['male','female'] %>
  <% end %>
  <%= f.button :submit %>
<% end %> 
```

`f.association`适合我的兴趣和假期模型，因为它们每个只需要收集一个属性。但是，该`friend_birthdays`模型与用户模型具有相同的精确关系（兴趣和假期），但***需要编辑/添加多个属性。***有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:03:16.843

如果您使用的是 Rails 3+，那么它可以处理嵌套表单而无需任何额外的 gem。关键在于对模型中的关联使用“accepts_nested_attributes_for”方法，并在表单助手中使用 fields_for 方法。[在这里](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html)和[这里](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)阅读它们。

我从未使用过 simple_form，但我相信它推动了 Rails 中的嵌套表单开发。因此，猜测一下，您需要将嵌套表单引用编写为：

```
<%= f.simple_fields_for :friend_birthdays do |friend_birthday| %>
  <%= friend_birthday.input :name %>
  <%= friend_birthday.input :gender, :collection => ['male','female'] %>
<% end %> 
```

关键是，您需要在嵌套表单上调用助手，而不是父表单。

# php - Jquery html() 无法将所有 xhtml 转换为 html 标准

> ID：10606627
> 
> 赞同：0
> 
> 时间：2012-05-15T18:24:32.190
> 
> 标签：php, jquery

我正在尝试从我的网站获取 html 代码。我可以这样做`html()`，我需要比较字符串。

例如。

但是我明白`< br/>`了，似乎浏览器或 jquery 只能得到`< br>`- 没有结束斜杠。

我研究并发现了这个[http://bugs.jquery.com/ticket/4509](http://bugs.jquery.com/ticket/4509)

似乎可以通过将页面作为 application/xml+xhtml 来解决。但是，我无法让它工作。任何专家建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T10:17:07.897

找到了解决方案。对于任何想要类似 $("#container").xhtml() 的人，你可以只使用这个扩展。[http://code.google.com/p/jqxhtml/](http://code.google.com/p/jqxhtml/)

这是针对 IE 的，稍加修改也可以适应 webkit 浏览器。希望这可以帮助任何将来需要它的人。

# jquery - 引用按钮单击以从数组中检索适当的值

> ID：10606631
> 
> 赞同：1
> 
> 时间：2012-05-15T18:24:44.973
> 
> 标签：jquery

我正在使用数组动态构建链接列表，这将导致如下所示：

```
<div>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
</div>
<div>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
   <p class="link">label</p>
</div> 
```

然后我会有一个点击处理程序：

```
$(".link").click(function(){
//do something
 myarray[?].stuff;
}); 
```

我想从数组中检索一些东西，但我不确定引用链接的最佳方法是什么。我可以将数组键添加为 p 标签中的 id，但是我想知道是否有更优雅的方式来处理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:30:51.850

您可以使用索引，但这会给您：

```
<div>
   <p class="link">label</p> //0
   <p class="link">label</p> //1
</div>
<div>
   <p class="link">label</p> //0
   <p class="link">label</p> //1
</div>

//js
$(".link").on('click', function(){
    myarray[$(this).index()].stuff;
}); 
```

您也可以使用父母索引，例如：

```
<div>
   <p class="link">label</p> //0
   <p class="link">label</p> //1
</div>
<div>
   <p class="link">label</p> //10
   <p class="link">label</p> //11
</div>

//js
$(".link").on('click', function(){
    var numb = parseFloat($(this).parent().index().toString() + $(this).index().toString());
    myarray[numb]);
});​ 
```

[小提琴](http://jsfiddle.net/adeneo/Wxu5M/)

或数据属性

```
<div>
   <p class="link" data-i="0">label</p>
   <p class="link" data-i="1">label</p>
</div>
<div>
   <p class="link" data-i="2">label</p>
   <p class="link" data-i="3">label</p>
</div>

//js
$(".link").on('click', function(){
    myarray[$(this).data('i')].stuff;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:44:13.433

我会坚持使用`key`作为标识符（虽然通常我倾向于使用，但你分配给哪个属性并不真正相关`id`）。这样，您`<p>`的 's `id`（或您分配给它的任何属性）将始终与相应的数组属性匹配。

根据过去的经验，在属性中附加/添加某些内容通常是一个好主意（特别是如果它是`id`, 以防止重复 element `id`，然后使用该`.replace()`方法删除除您需要的所有内容之外的所有内容）

# r - 使用 RSCript 在世界地图上绘制数字/数据点

> ID：10606634
> 
> 赞同：2
> 
> 时间：2012-05-15T18:25:11.697
> 
> 标签：r, rworldmap

使用 RSCript 和 rworldmap 包。我想创建一个输出，以便能够显示每个公司内发布的文档数量。大致基于 mapPies，而不是使用饼图来仅在图表上显示数据。

我有自己的 txt 文件，它有 3 列 - ISO3V10、国家和文档编号。

```
ISO3V10 Country              No of Documents
CAN     Canada               30
CHN     China                20
RUS     Russia               10
GBR     United Kingdom       38
USA     United States        50 
```

对于美国，将出现数字 50，而英国将出现 38 等......在下图所示的图像上！！！！

**我有图片，我希望它看起来像，但我不能发布任何图片，如果需要澄清，很乐意发送**

我已经使用 RSCript 和 rworldmap 创建了一张世界地图，因此应用能够做到这一点的代码非常棒。

我用来生成世界地图的代码如下：

```
library(rworldmap) 
require(rworldmap)
myData2 <- read.delim(file="C:\\Documents\\Projects\\RScriptAnalysis\\noofpublications2.txt", header = TRUE, sep = "\t")
names(myData2)
sPDF2 <- joinCountryData2Map(myData2, joinCode = "ISO3", nameJoinColumn = "ISO3V10")
par(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")
mapParams <- mapCountryData(sPDF2, nameColumnToPlot="No.of.Documents", catMethod = "categorical", addLegend=FALSE)
do.call( addMapLegend, c(mapParams, legendWidth=0.5, legendMar = 2)) 
```

如果使用 RSCript 和 rworldmap 可以做到这一点，您是否可以编写代码或修改允许我这样做的代码？

* * *

这就是我希望能够做到的！

我在哪里可以找到经度和纬度，因为这样会更好。

作为我想要的输出是每个国家/地区地图上显示的文档数量！

您能否在原始问题中编辑我上面的文件和代码以向我展示如何执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:18:35.173

可能吗？这是R。

```
require(fortunes)
fortune("Yoda") 
```

您可能需要更具体地确定您想要这些数字的确切位置，因为合并为您带来了 5 个以上的领域：

```
str(sPDF2@data[which(sPDF2@data$ISO3V10 =="GBR"),])
'data.frame':   1 obs. of  15 variables:
 $ FIPS        : Factor w/ 244 levels "","AC","AE","AF",..: 224
 $ ISO2        : Factor w/ 246 levels "AD","AE","AF",..: 76
 $ ISO3        : Factor w/ 246 levels "ABW","AFG","AGO",..: 79
 $ UN          : int 826
 $ NAME        : Factor w/ 246 levels "Afghanistan",..: 230
 $ AREA        : int 24193
 $ POP2005     : int 60244834
 $ REGION      : int 150
 $ SUBREGION   : int 154
 $ LON         : num -2.9
 $ LAT         : num 54.2
 $ ISO3V10     : Factor w/ 5 levels "CAN","CHN","GBR",..: 3
 $ Country     : Factor w/ 5 levels "Canada","China",..: 4
 $ No_Documents: int 38
 $ ISO3        : Factor w/ 5 levels "CAN","CHN","GBR",..: 3 
```

那么为什么不为您希望放置这些数字的位置提供坐标，并编辑您的输入文件以反映该选择。

# mysql - 使用外键从表中删除

> ID：10606639
> 
> 赞同：0
> 
> 时间：2012-05-15T18:25:36.197
> 
> 标签：mysql, sql, foreign-keys, foreign-key-relationship

早晨，

我有三张桌子：

表：债务人

```
id           -    INT(11)
type         -    ENUM('c', 'p') 
```

表：公司

```
id           -    INT(11)
debtor_id    -    INT(11)
and a lot of other fields for companies 
```

表：private_individuals

```
id           -    INT(11)
debtor_id    -    INT(11)
and a lot of other fields for private individuals 
```

公司外键 SQL（个人也用）：

```
INDEX `fk_private_individual_debtors1` (`debtor_id` ASC) ,
  CONSTRAINT `fk_private_individual_debtors1`
    FOREIGN KEY (`debtor_id` )
    REFERENCES `application_user`.`debtors` (`id` )
    ON DELETE CASCADE
    ON UPDATE NO ACTION) 
```

当我删除公司或个人时，我希望债务人也被删除，并且它也应该以相反的方式工作（删除债务人，公司或个人也会被删除）。

我正在考虑用触发器来做到这一点，但我想有更好的方法来做到这一点..

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:35:35.313

> 删除债务人，公司或个人也会被删除：

这可以通过`ON DELETE CASCADE`. 您在定义外键时指定它，并应用于表上的所有删除。您不能在单独的 DELETE 级别提及这一点。请参阅MySql 手册中的[FOREIGN KEY Constraints](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)记住这在大多数情况下是危险的，最好在应用程序代码中使用此逻辑。

> 当我删除公司或个人时，我希望债务人也被删除

这是直接不可能的。您已经在公司和债务人之间建立了外键关系，但可以有多个公司与债务人关联。外键中没有任何东西可以阻止这种情况。您可能有其他应用程序逻辑（在过程中、在您的 java/C# 代码中、在触发器中），但外键级别根本没有任何内容。因此，由于这是通过额外的应用程序逻辑实现的，因此您的删除也将需要额外的应用程序逻辑。需要注意的另一点是：只有在删除所有子记录时才应删除 [arent。

# android - Cocos2D android 背景图像被弄乱了

> ID：10606640
> 
> 赞同：1
> 
> 时间：2012-05-15T18:25:40.663
> 
> 标签：android, ccsprite, cocos2d-android

所以我现在试图用一个简单的静态背景制作一个游戏，但是当我将它绘制到屏幕上时（没有进行缩放，因为图像的分辨率与屏幕相同）它绘制了底部图像不正确，图像底部的几百个像素在图像下方完全相同。抱歉，这很难解释，但作为新手，我实际上无法发布出问题的图片。

现在我只是使用一个简单的精灵来渲染这个背景图像。这是正在使用的代码：

```
 // background layer: another image
    background = CCSprite.sprite("WaterBackground.png");
    // change the transform anchor point (optional)
    background.setPosition(CGPoint.make(GAME_WIDTH/2, GAME_HEIGHT/2));
    addChild(background); 
```

我在这里做错了吗？Cocos2D 不支持这么大的精灵图片吗？（分辨率为 800*1280）任何帮助将不胜感激！

因为我现在可以上传图片，所以这里是出现问题的视觉效果：

![应该看起来的图像](../Images/07c11a0e7af3601599c3eab983b3cd20.png)

我的游戏中的问题：

![在此处输入图像描述](../Images/f2a13e8b1aec299bd774d4bc4e161ca3.png)

如您所见，这个问题很难描述。问题只存在于这个更大的图像；我在 GIMP 中手动缩小它，然后为游戏放大它，它看起来很好（除了分辨率较低）。我还尝试缩小这个更大的图像，但仍然导致同样的问题。希望你们能帮助我，因为我不知道什么可能导致这个错误。特别是因为我读到 Cocos2D 支持的最大图像尺寸是 2048*2048，而我的图像正好在其中。

感谢你们提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T19:47:41.017

这是由于纹理大小的限制。Coсos2d-android 支持最大尺寸为 1024 x 1024 像素的图像。

我遇到了同样的问题，正在寻找解决方法。

**编辑**

我找到了解决方案在 cocos2d 项目中打开 org.cocos2d.opengl 包中的文件 CCTexture2d.java 并将 kMaxTextureSize 从 1024 更改为 2048

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T07:21:20.510

you should try to make one method for adding background,i am doing this this like this way try this hope it will help full for you...here addBackGroundScene is my method and i am adding my background with this method,scrXScaleFactor is maintaining scaling part of my screen try this...

```
private void addBackGroundScene() {
        CCSprite bgForLevel1 = addBackgroundAtOrigin("prelevel1/bgMenu.jpg");
        bgForLevel1 .setScaleX(scrXScaleFactor);
            bgForLevel1 .setAnchorPoint(0, 0);          
            addChild(bgForLevel1 );

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T15:13:06.500

我不确定，因为从你的代码和查看 cocos2d 代码我看不出会发生这种情况的确切原因，但考虑到你在屏幕上的精灵数量，我肯定会采取看看我对[这个](https://stackoverflow.com/questions/8633702/cocos2d-android-texure-issue-on-motorola-xoom/10335955#10335955)问题的回答，因为你很可能遇到了 cocos2d 围绕多个精灵的古怪的小渲染错误之一。尝试 spritesheets 不会有什么坏处，这当然是在 cocos 中实际制作 sprites 的正确方法。

此外，绝对要为自己创建一个辅助实用程序来确定设备与原始图像大小相比的缩放比例，与 iphone 不同，android 确实有几乎无限的屏幕分辨率变化，以及简单的一点“加载时缩放” " 如果您想在任何其他设备上使用它，现在的实用程序代码将在未来为您节省大量时间。

# jquery - jquery 从表格单元格中获取值

> ID：10606641
> 
> 赞同：0
> 
> 时间：2012-05-15T18:25:42.620
> 
> 标签：jquery, arrays, each

我需要在表格的第 5 列中获取文本框的值，并在警报中显示该值。

文本框的名称为： T[1] ， T[2] ， T[3] ..........T[30]

```
 $('#MyTable tr td:nth-child(5)').each(function(index) {

       var TextBoxValue = $("input[type=text][name^=T]").eq(index).val();

    }); 
```

我的桌子有：10colums 和 30rows

但它跳过一行，并在警报框中显示奇数行文本框值。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:43:05.887

不完全确定您的标记是什么样子或您将`.eq(index)`作品放在哪里，但试试这个：

```
 $('#MyTable tr td:nth-child(5)').each(function(index) {

    var TextBoxValue = $("input[type=text][name^=T]", this).val();

    console.log(TextBoxValue);
}); 
```

我所做的最重要的更改是为选择器“ `, this`”添加了上下文。我还删除了“ `.eq(index)`”部分。

在这里演示：http: [//jsfiddle.net/aymansafadi/CpNZV/](http://jsfiddle.net/aymansafadi/CpNZV/)

# android - 如何让 TabActivity 调用 onActivityResult？（编辑标题）

> ID：10606645
> 
> 赞同：0
> 
> 时间：2012-05-15T18:26:03.820
> 
> 标签：android, android-activity

出于某种原因，当我要求扫描一维条码时，不会调用 onActivityResult 方法。有解决方法吗？如果没有，是否有另一个条形码应用程序可以与我的应用程序集成，或者我需要从头开始构建一个？

代码：

```
btnScan.setOnClickListener(new View.OnClickListener() 
    {   
        @Override
        public void onClick(View arg0) 
        {
            Intent intent = new Intent("com.google.zxing.client.android.SCAN");
            intent.putExtra("com.google.zxing.client.android.SCAN.SCAN_MODE", "PRODUCT_MODE");

            try{
                startActivityForResult(intent, 0);
            }catch(ActivityNotFoundException ex){
                showDownloadDialog();
            }
        }
    }); 
```

返回码：

```
 @Override public void onActivityResult(int requestCode, int resultCode, Intent intent){
    if (requestCode == 0)
    {
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("Scan");
        builder.setMessage(intent.getStringExtra("SCAN_RESULT"));

        builder.create().show();

        Log.d("SCAN", "sup");
    }

    Log.d("SCAN", "sup sup");
} 
```

提前致谢。

编辑：实际上，甚至 QR 码都没有调用 onActivityResult。我正在使用 TabActivity。也许这与某些事情有关？

编辑 2：好的，我尝试在 ActivityB 上使用 startActivity。ActivityB 负责调用 startActivityForResult(zxing) 然后在 onActivityResult 中发出一个日志。工作。现在我只需要知道 TabActivity 有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T19:38:10.420

好的，我设法调用了 onActivityResult。在儿童活动中，我使用了：

`getParent().startActivityForResult(intent, positive_request_code);`

然后，在父活动 (TabActivity) 中，我将 onActivityResult 放在那里。

# ant - 依赖问题

> ID：10606653
> 
> 赞同：0
> 
> 时间：2012-05-15T18:26:43.347
> 
> 标签：ant, maven-2

我正在尝试使用 Maven Ant 任务在 Ant 中使用 Maven。我已经能够将自定义库安装/依赖于本地存储库（Artifactory），并且能够获取依赖项（来自公共存储库和本地）。我遇到了自定义库的问题，但不确定问题出在哪里。

1.  使用新版本将库添加到本地仓库
2.  获取项目的依赖项，包括新的库版本 <--- 这有效
3.  删除本地 .m2 存储库缓存。
4.  再次尝试获取依赖项。公共存储库中的所有内容都已下载，但自定义库未下载。事实上，我需要删除该版本或创建一个新版本才能再次下载它（这只能工作 1x）。

我得到的错误是：[artifact:dependencies] 处理 Maven 工件任务时发生错误。[artifact:dependencies] 诊断：[artifact:dependencies] [artifact:dependencies] 无法解析工件：缺少：[artifact:dependencies] ---------- [artifact:dependencies] 1) xxx.yyy： zzz:jar:0.0.2

该版本仍然显示在 Artifactory 中，我可以看到 jar 和 pom。

我的本地缓存没有 jar（正如我对上述错误的预期）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T13:53:18.630

事实证明，这个问题与 artifactory 中的安全配置设置有关。由于配置不当，该应用程序并未始终允许公众访问。

# android - WebChromeClient Websocket 支持？

> ID：10606654
> 
> 赞同：1
> 
> 时间：2012-05-15T18:26:43.100
> 
> 标签：android, webchromeclient

Android 带有两个 Web 视图（SetWebViewClient 和 SetWebChromeClient），很明显常规 Web 客户端对 Websocket 的支持为零。

但是，我不确定 WebChromeClient 的功能，除了 Android 浏览器上的 Chrome 似乎支持 Websockets。

有人可以确认 WebChromeClient 是否支持 Websockets？

（这个特定的答案没有提供有关 WebChromeClient 的足够信息[setWebViewClient 与 setWebChromeClient 有什么区别？](https://stackoverflow.com/questions/2835556/whats-the-difference-between-setwebviewclient-vs-setwebchromeclient)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-05T11:01:29.477

有一个简单的测试来检查您的浏览器是否支持 websocket。在 url 下面启动并 ping 公共托管服务。如果您能够从浏览器 ping 通，则支持 :)

[https://www.websocket.org/echo.html](https://www.websocket.org/echo.html)

我已经把这些细节放在我的博客上，[这里](http://geekrai.blogspot.in/2015/06/testing-websockets-service-from-browser.html)。

# java - 如何从 Java 环境运行 Gnuplot 脚本？

> ID：10606662
> 
> 赞同：1
> 
> 时间：2012-05-15T18:27:06.477
> 
> 标签：java, gnuplot, javaplot

我找到的关于使用 JavaPlot 的所有信息都是关于如何创建绘图并从 Java 代码级别运行它们。这很好，但是当用户执行它们时，我已经使用了一些脚本文件来执行我希望它们在 Jave 之外执行的操作。现在，我可以打开 Gnuplot，然后输入命令

```
gnuplot> load "script.plt" 
```

它会为我输出一个漂亮的 .png 图形，显示我所拥有的情节。在脚本中，调用的行之一是

```
plot "graphData.dat" title "Line Title" 
```

文件“graphData.dat”存储绘制我的图表所需的坐标信息。

当用户双击其文件夹中的“script.plt”文件（我在 Windows 环境中运行）时，这可以正常工作。这是非常完美的（减去 gnuplot 进程没有正确结束的事实，这不是我要问的，但如果它响起任何铃声，我也很想听听如何解决这个问题）。

我面临的问题是我需要能够通过 gnuplot*通过 java environment*运行脚本。我的程序需要使用 gnuplot 自动导出 .png 图形。我环顾四周，JavaPlot 似乎是 Gnuplot 中 Java 支持的首选库，但我无法让它做我想做的事：只需运行一个调用上述加载命令的 gnuplot 实例。

我能得到的任何帮助或建议将不胜感激，我尝试放弃脚本文件，我尝试动态调用加载命令（但显然不是从正确的位置），我尝试绘制 .dat直接文件，它*真的*不喜欢。只要我能让那个脚本运行，我就准备好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:19:15.983

我立即注意到的一件事：只需从 gnuplot 提示符加载脚本（即）

```
gnuplot> #We've already entered gnuplot from the commandline
gnuplot> load "script.plt" 
```

完全等同于在命令行上将脚本名称作为第一个参数传递给 gnuplot（即）

```
gnuplot script.plt 
```

这也相当于`gnuplot -e 'load "script.plt"'`从命令行。这简化了你的问题，因为现在你不需要弄清楚如何通过管道与 gnuplot 通信，你只需要弄清楚如何发出系统调用`Java`——我认为这个任务对于编码的人来说相当简单在`java`. 在`python`，我可以做到`import os; os.system("gnuplot script.plt")`。

我认为@andersoj 发布的链接中的第二、第三和第四个答案提供了示例和链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-02T15:30:35.480

JavaGnuplotHybrid 库是您所需要的：使用 Java 和 Gnuplot 进行混合编程。

1.  使用 Java 和 Gnuplot 进行混合编程
2.  重量很轻（只有三个核心类）
3.  在 Gnuplot 代码中使用标签来执行函数或获取 Java 中的字段值。
4.  支持 Java 中 Gnuplot 的同步和异步运行。（同步：你的 java 程序会等到你关闭弹出的 Gnuplot 窗口；异步：你的 java 程序不会等待。）
5.  将 Gnuplot 的错误/正常文本输出捕获到 java 终端
6.  从 xml 文件中读取 Gnuplot 代码
7.  支持 Gnuplot 代码模板。

更多细节：

1.  项目页面：[https ://github.com/mleoking/JavaGnuplotHybrid](https://github.com/mleoking/JavaGnuplotHybrid)
2.  示例：[https ://github.com/mleoking/JavaGnuplotHybrid/blob/master/javagnuplothybrid/doc/examples.md](https://github.com/mleoking/JavaGnuplotHybrid/blob/master/javagnuplothybrid/doc/examples.md)

# iphone - Three20 在 Navigation Controller 之上呈现 ViewController

> ID：10606665
> 
> 赞同：1
> 
> 时间：2012-05-15T18:27:12.430
> 
> 标签：iphone, objective-c, ios, ipad, three20

我正在使用 Three20 框架并尝试在 navigationController 之上展示 ViewController。我不确定 Three20 框架是如何完成的，任何接触过这个框架的大师都可以帮助我吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:34:29.417

在同一屏幕上对 iPad 和多个视图控制器有“有限支持”。我会避免使用`TTNavigator`和视图控制器 url 映射。您可以使用标准工作流程推送和展示您的`TTViewController`课程`self.navigationController`

PS，我所说的“有限支持”是指可怕、错误和无用的支持。

# c# - 从代码执行时存储过程不返回值，在管理工作室工作正常

> ID：10606667
> 
> 赞同：0
> 
> 时间：2012-05-15T18:27:22.310
> 
> 标签：c#, sql-server, xml

我有一个像

```
CREATE PROCEDURE [dbo].[ExportTestAsXML]
    @TestId         int
AS
BEGIN
    SET NOCOUNT ON;

    declare @x xml;
    set @x = (
       select
          (select * from table1 where testid = @TestId FOR XML auto, Type, Elements),
          (select * from table2 where testid = @TestId FOR XML auto, Type, Elements),
          (select * from table3 
           where objectiveid in 
               (select objectiveid from objectives where testid = @TestId) 
           FOR XML auto, Type, Elements),
          (select * from table4 
           where objectiveid in 
               (select objectiveid from objectives where testid = @TestId) 
           FOR XML auto, Type, Elements),
          (select * from table5 
           where questionid in 
               (select questionid from questions 
                where objectiveid in 
                      (select objectiveid from objectives where testid = @TestId)
               ) 
           FOR XML auto, Type, Elements)
       for xml path(''), type
    );

   select @x as my_xml
END 
```

当我从 SQL Server 2005 Management Studio 运行它时，我得到一个表，其中包含来自 select 语句的组合 XML 的单个记录。当我从我的 Web 服务代码运行它并使用数据表可视化工具检查表时，它是空的。这是我用来执行 proc 的代码

```
SqlParameter[] Parameters = new SqlParameter[1];
Parameters[0] = new SqlParameter();
Parameters[0].ParameterName = "@TestId";
Parameters[0].Value = TestId;
Parameters[0].SqlDbType = SqlDbType.Int;
Parameters[0].Size = 50;

DataTable data = ExecuteDataSet("ExportTestAsXML", Parameters);

private DataTable ExecuteDataSet(string storedProcName, SqlParameter[] parameters)
{
    SqlCommand command = new SqlCommand();
    command.CommandText = storedProcName;
    command.Parameters.AddRange(parameters);
    command.CommandType = CommandType.StoredProcedure;
    command.Connection = (SqlConnection)dcMUPView.Connection;

    command.Connection.Open();
    command.Prepare();

    SqlDataAdapter adapter = new SqlDataAdapter(command);
    DataTable ds = new DataTable();
    adapter.Fill(ds);

    command.Connection.Close();
    return ds;
} 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:57:37.867

如果您填充 a`DataSet`而不是 a ，则您的示例有效`DataTable`。

这是您的源代码的副本，所需的更改最少。请注意，当您使用 a 时，`DataSet`您应该添加代码以检查是否返回了任何表，以及第一个表中是否有可用的行等。

呼叫者：

```
SqlParameter[] Parameters = new SqlParameter[1];
Parameters[0] = new SqlParameter();
Parameters[0].ParameterName = "@TestId";
Parameters[0].Value = TestId;
Parameters[0].SqlDbType = SqlDbType.Int;
Parameters[0].Size = 50;

DataSet data = ExecuteDataSet("ExportTestAsXML", Parameters);

// Read First table (Tables[0]), First Row (Rows[0]), First Column of that Row (Rows[0][0])
System.Diagnostics.Debug.Write(data.Tables[0].Rows[0][0]); 
```

方法：

```
private DataSet ExecuteDataSet(string storedProcName, SqlParameter[] parameters)
{
    SqlCommand command = new SqlCommand();
    command.CommandText = storedProcName;
    command.Parameters.AddRange(parameters);
    command.CommandType = CommandType.StoredProcedure;
    command.Connection = (SqlConnection)dcMUPView.Connection;

    command.Connection.Open();
    command.Prepare();

    SqlDataAdapter adapter = new SqlDataAdapter(command);
    DataSet ds = new DataSet ();
    adapter.Fill(ds);

    command.Connection.Close();
    return ds;
} 
```

# mysql - MySQL 中缺少 InnoDB

> ID：10606669
> 
> 赞同：0
> 
> 时间：2012-05-15T18:27:28.627
> 
> 标签：mysql, innodb

我不知道我在这里做了什么，但我的 InnoDB 引擎似乎已经从我的 MySQL 服务器上消失了。我最近从 dotdeb 存储库升级了它，然后安装了`mysql-server`.

除了一些解释默认启用 InnoDB 的注释外，我没有提到 InnoDB，`my.cnf`我不明白。中也没有提到 InnoDB `SHOW ENGINES`。

我在这里缺少什么吗？

如果重要的话，我的 MySQL 服务器版本是：`5.5.24-1~dotdeb.1 (Debian)`.

编辑`SHOW ENGINES`：：

```
mysql> SHOW ENGINES;
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |
| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |
| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |
| BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |
| MyISAM             | DEFAULT | MyISAM storage engine                                          | NO           | NO   | NO         |
| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |
| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |
| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |
+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+
8 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T14:18:10.960

问题很可能是日志文件大小不匹配：mysql 期望 innodb 日志文件与配置文件中指定的大小完全相同。要检查这是否真的是问题，请执行以下操作：

1.  `sudo /etc/init.d/mysql restart`
2.  `sudo tail -n 1000 /var/log/syslog`

（我假设你在 Debian 上）

如果您看到那里报告了一些关于 innodb 和日志文件大小的错误（抱歉，我不记得该消息的确切措辞），那么修复很简单：

1.  找到日志文件（可能`/var/lib/mysql/ib_logfile0`和`/var/lib/mysql/ib_logfile1`）
2.  停止mysql服务器
3.  重命名日志文件：`sudo mv /var/lib/mysql/ib_logfile0 /var/lib/mysql/ib_logfile0.bak`等
4.  启动mysql服务器
5.  检查`/var/log/syslog`错误是否不再发生
6.  连接到 mysql 并检查`SHOW ENGINES;`InnoDB 现在是否可用...

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:31:50.903

首先要做的是`SHOW ENGINES`在 MySQL 提示符下运行以确认 Innodb 是否已禁用。

如果是，请检查 MySQL 服务器的错误日志。它将详细说明 InnoDB 被禁用的原因。MySQL 在启动时可能会禁用 InnoDB 有几个原因。例如，如果 my.cnf 中指定的 innodb 日志文件大小与磁盘上现有日志文件的大小不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T12:31:43.003

我在预装了 mysql 5.5 的 Debian 7 服务器上遇到了这个问题。之后没有 InnoDB 引擎`SHOW ENGINES`

正如 severin 之前提到的那样运行这个：

1.  `sudo /etc/init.d/mysql restart`
2.  `sudo tail -n 1000 /var/log/syslog`

我有这个：

**InnoDB：错误：io_setup() 在 5 次尝试后以 EAGAIN 失败。**

以及其他行的解决方案：

**InnoDB：您可以通过在 my.cnf 中设置 innodb_use_native_aio = 0 来禁用 Linux Native AIO**

添加`innodb_use_native_aio = 0`到my.cnf后InnodDB出现在`SHOW ENGINES`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-19T11:23:26.227

检查磁盘上是否有足够的空间以及 mysql.sock 的存储位置。

1.  停止 MYSQL
2.  编辑 my.cnf 并增加：

`innodb_buffer_pool_size=100M (May vary per case)`

3.  添加：

    `[mysqld] innodb_force_recovery = 1`

4.  执行以下

    `mv /var/lib/mysql/ib_logfile0 /var/lib/mysql/ib_logfile0.bak`

    `mv /var/lib/mysql/ib_logfile1 /var/lib/mysql/ib_logfile1.bak`

5.  启动 MySQL 并进行备份以防万一。

6.  登录到 mysql 并：`show engines;`- 检查是否列出了 InnoDB 并且 SUPPORT = YES。

7.  如果在 6 点之前一切正常，退出并编辑 my.cnf 将其设置回来：

[mysqld] innodb_force_recovery = 0

8.  重启 MySQL

9.  访问您的网站，检查是否一切正常，祝您好运！

PS - 您可能想要检查导致此问题的原因，可能是在您的生产服务器上工作，或者重新启动导致您的日志文件损坏。你现在很清楚，所以环顾四周，确保其他一切看起来都很好，尤其是可用磁盘空间和异地备份。

# php - 从数组直接输出到 CSV 而不保存到 CSV 文件

> ID：10606676
> 
> 赞同：5
> 
> 时间：2012-05-15T18:27:54.180
> 
> 标签：php, arrays, file, csv

我正在寻找一种简单的方法来获取数组，将其转换为 CSV 并让用户能够下载 CSV，而无需将 CSV 保存到服务器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-15T18:52:13.823

```
$array = [
    ['name', 'email'],
    ['Doe, John', 'johndoe@foo'],
    ['Jane Doe', 'janedoe@foo'],
    ['Ron "SuperFly" O\'Neal', 'supafly@foo'],

];
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=test.csv");
$fp = fopen('php://output', 'w'); // or use php://stdout
foreach ($array as $row) {
    fputcsv($fp, $row);
} 
```

见[fputcsv](http://www.php.net/fputcsv) ()

使用的好处`fputcsv`是它将为您处理字段的转义和封闭，确保即使您的列值恰好包含 csv 控制字符（如逗号、引号、换行符等）也不会中断的**有效、坚固的输出**......如果你不要注意稳健地处理控制字符，而是采用常见的捷径，例如使用`implode(',', $row)`您的（低质量）代码会产生损坏的 csv 输出。

不幸的是，fputcsv 不能输出到字符串，只能输出到流，所以我通过它写入 php 的输出流，`php://output`这相当于将`echo`其输出。请注意，就像通过 echo 输出一样，它将通过 php 的输出缓冲区机制，其中包括任何可能的输出处理程序，例如`ob_gzhandler`可能修改输出的客户输出缓冲区回调函数。如果您希望绕过输出缓冲区，您可以直接写入`php://stdout`.

如果您需要在输出之前将 csv 文件内容作为字符串访问，您也可以写入`php://memory`、或文件。`php://temp`

```
$fp = fopen('php://memory', 'w+'); // or php://temp
foreach ($array as $row) {
    fputcsv($fp, $row);
}

// Read it back into a string, if desired.
// Rewind the stream to start.
fseek($fp, 0);
// Read the entire stream back to string.
$csvContents = stream_get_contents($fp); 
```

流包装信息[http://www.php.net/manual/en/wrappers.php.php](http://www.php.net/manual/en/wrappers.php.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-15T18:34:26.063

```
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=test.csv");
header("Pragma: no-cache");
header("Expires: 0");

echo "name,city,street\n"; 
```

有时最好使用

```
header("Content-Type: application/octet-stream"); 
```

对于 IE...

# mysql - MySQL SELECT 针对 varbinary 列

> ID：10606678
> 
> 赞同：1
> 
> 时间：2012-05-15T18:27:58.067
> 
> 标签：mysql, binary

[这是我在此处](https://stackoverflow.com/questions/10486025/alternative-to-hashed-ssn-as-a-key-in-mysql)发布的上一期的后续内容。

我创建了一个测试表：

```
CREATE TABLE `my_test_table` (
    `record_id` INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,
    `col1` BINARY(20) NULL DEFAULT NULL,
    `col2` CHAR(40) NULL DEFAULT NULL,
    PRIMARY KEY (`record_id`)
) 
```

然后运行语句：

```
INSERT INTO my_test_table (col1, col2) VALUES(sha1('test'), sha1('test') ); 
```

数据看起来...

1 0x6139346138666535636362313962613631633463 a94a8fe5ccb19ba61c4c0873d391e987982fbbd3

我不确定如何针对 VARBINARY 列进行选择。我可以针对 CHAR 进行选择，例如：

```
SELECT * FROM my_test_table WHERE col2 = sha1('test'); 
```

我试过了

```
SELECT * FROM my_test_table WHERE col1 = hex(sha1('test')); 
```

和其他变体，但似乎无法找到解决方案（如果有的话）。在允许新插入之前，我需要能够检查数据库中是否已经存在一个值。我正在根据以前的建议查看 VARBINARY 和 BINARY。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:35:48.127

我没有读过你之前的问题，但是根据这个问题的源代码，你只将 sha1 哈希的前 20 个字符存储在 col1 中，所以如果你想选择它，你应该只查找前 20 个字符sha1 哈希。

例如：

```
SELECT * 
FROM my_test_table 
WHERE col1 = left(sha1('test'),20); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:32:50.617

```
Data truncation: Data too long for column 'col1' at row 1: INSERT INTO my_test_table (col1, col2) VALUES(sha1('test'), sha1('test') ) 
```

这可能是您无法正确选择数据的原因吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-15T11:38:50.597

顺便说一句，`sha1('test')`返回一个十六进制字符的字符串......

您应该在将`unhex(sha1('test'))`数据作为十六进制字符串输入时使用，否则它不会作为 acsii 值输入，这根本无法匹配

`SELECT * FROM my_test_table WHERE col1 = unhex(sha1('test'));` 也应该是匹配的查询。

# testing - 从命令行远程运行 Jmeter

> ID：10606680
> 
> 赞同：7
> 
> 时间：2012-05-15T18:28:12.280
> 
> 标签：testing, jmeter

是否可以在远程服务器上运行 Jmeter 而无需在本地机器上安装 Jmeter 客户端。我的意思是我可以从命令提示符在远程机器上运行 jmeter.bat，这样它就可以在远程服务器上运行测试并将结果存储在 listener.jtl 文件中，而我的机器上没有任何 jmeter 客户端。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T12:01:25.520

这是链接：http: [//jmeter.apache.org/usermanual/remote-test.html](http://jmeter.apache.org/usermanual/remote-test.html)。
只需浏览 Jmeter 网站上提供的文档即可。

您给出的场景是某种“分布式测试”本身，您希望每个测试人员从安装 JMeter 的机器上执行负载测试。

为此，您必须在每台测试机器中复制 JMeter 并输入您的 JMeter 服务器机器（主机）。

现在，当每个测试人员都将运行 JMeter 时，他们将能够在 JMeter 主机上运行负载。

```
jmeter -n -t script.jmx -l listener.jtl -R **HostMachineIP** 
```

# ruby-on-rails - 查询多个 Rails 模型

> ID：10606681
> 
> 赞同：0
> 
> 时间：2012-05-15T18:28:16.550
> 
> 标签：ruby-on-rails, activerecord

我需要创建一个包含来自两个不同模型/表的条目的画廊，比如说“视频”和“图像”。处理这个问题的最佳方法是什么？我想将它们保存在不同的表中，但将它们一起检索（例如，最近的 50 张图像和视频）。单表继承似乎不适合。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:35:09.650

多态是你的朋友。

```
class Video
  belongs_to :viewable, :polymorphic => true
end

class Image
  belongs_to :viewable, :polymorphic => true
end

class Gallery
  has_many :media, :as => :viewable
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:34:54.813

我能想到的最好方法是创建一个包含所有显示的表，其中包含对其他表的多态引用。

```
class Gallery
  has_many :displays
end

class Display
  belongs_to :gallery
  belongs_to :derived_display, :polymorphic => true
end

class Video
  has_one :display, :as => :derived_display
end 
```

# perl - 像树命令一样显示目录树输出

> ID：10606685
> 
> 赞同：2
> 
> 时间：2012-05-15T18:28:47.193
> 
> 标签：perl, tree, directory, traversal, tree-traversal

[`Path::Class`](https://metacpan.org/module/Path%3a%3aClass)为了遍历目录，我仍然使用很棒的模块。我写了一段代码，但我对输出的显示不满意。我的目录树输出不像命令的输出那样简洁和优雅`tree`。:-(

到目前为止我的代码：

```
use strict;
use warnings;
use Path::Class;

my $dir = Path::Class::Dir->new('D:\dev\pl\testdir');

my $max_depth = $dir->traverse(sub {
  my ($child, $cont, $depth) = @_;
  return max($cont->($depth + 1), $depth);
}, 0);
sub max { my $max = 0; for (@_) { $max = $_ if $_ > $max } $max };

# Print header
printf "%-43s|%s\n", " Name", " mtime";
printf "%-43s|%s\n", '-' x 43, '-' x 11;

$dir->traverse(sub {
  my ($child, $cont, $indent) = @_;
  my $child_basename = $child->basename;
  my $child_stat     = $child->stat();
  my $child_mtime    = $child_stat->[9];
  $indent //= 0;
  my $width = 40 - 3 * ($indent - 1);

  #print "DEBUG: Scanning $child\n";

  if ($indent == 0) {
    print "ROOT: ", $child, "\n";
  }
  else {
    if ($child->is_dir) {
        print '   ' x ($indent - 1), '+- ';
        printf "%-${width}s| %d", $child_basename . '/', $child_mtime;
        print "\n";
    } else {
        print '   ' x ($indent - 1), '|- ';
        printf "%-${width}s| %d", $child_basename, $child_mtime;
        print "\n";
    }
  }

  $cont->($indent + 1);
}); 
```

我的**错误**输出是：

```
Name                                       | mtime
-------------------------------------------|-----------
ROOT: D:\dev\pl\testdir
+- Path-Class-0.25/                        | 1337013211
   |- Build.PL                             | 1329360988
   |- Changes                              | 1329360988
   |- dist.ini                             | 1329360988
   |- INSTALL                              | 1329360988
   +- lib/                                 | 1337013211
      +- Path/                             | 1337013211
         +- Class/                         | 1337013211
            |- Dir.pm                      | 1329360988
            |- Entity.pm                   | 1329360988
            |- File.pm                     | 1329360988
         |- Class.pm                       | 1329360988
   |- LICENSE                              | 1329360988
   |- Makefile.PL                          | 1329360988
   |- MANIFEST                             | 1329360988
   |- META.yml                             | 1329360988
   |- README                               | 1329360988
   |- SIGNATURE                            | 1329360988
   +- t/                                   | 1337013211
      |- 01-basic.t                        | 1329360988
      |- 02-foreign.t                      | 1329360988
      |- 03-filesystem.t                   | 1329360988
      |- 04-subclass.t                     | 1329360988
      |- 05-traverse.t                     | 1329360988
      |- author-critic.t                   | 1329360988 
```

**正确**的输出（也更好看）应该是：

```
Name                                       | mtime
-------------------------------------------|-----------
ROOT: D:\dev\pl\testdir
+- Path-Class-0.25/                        | 1337013211
   |- Build.PL                             | 1329360988
   |- Changes                              | 1329360988
   |- dist.ini                             | 1329360988
   |- INSTALL                              | 1329360988
   +- lib/                                 | 1337013211
   |  +- Path/                             | 1337013211
   |     +- Class/                         | 1337013211
   |     |  |- Dir.pm                      | 1329360988
   |     |  |- Entity.pm                   | 1329360988
   |     |  |- File.pm                     | 1329360988
   |     \- Class.pm                       | 1329360988
   |- LICENSE                              | 1329360988
   |- Makefile.PL                          | 1329360988
   |- MANIFEST                             | 1329360988
   |- META.yml                             | 1329360988
   |- README                               | 1329360988
   |- SIGNATURE                            | 1329360988
   \- t/                                   | 1337013211
      |- 01-basic.t                        | 1329360988
      |- 02-foreign.t                      | 1329360988
      |- 03-filesystem.t                   | 1329360988
      |- 04-subclass.t                     | 1329360988
      |- 05-traverse.t                     | 1329360988
      \- author-critic.t                   | 1329360988 
```

**您能否改进或更正我的代码？**

非常感谢您的帮助！

问候，
斯科蒂

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T00:00:53.300

我下面的代码不是花哨的解决方案，但它可以满足您的需求>>

```
#!/usr/bin/perl

use strict;
use warnings;
use Path::Class;

my $dir = Path::Class::Dir->new('D:\dev\pl\testdir');

my $max_depth = $dir->traverse(sub {
  my ($child, $cont, $depth) = @_;
  return max($cont->($depth + 1), $depth);
}, 0);

sub max { my $max = 0; for (@_) { $max = $_ if $_ > $max } $max };

my @output = ( sprintf("%-43s|%s", " Name", " mtime"),
               sprintf("%-43s|%s", '-' x 43, '-' x 11) );

my @tree = (0, 0);
my $last_indent = 0;

$dir->traverse( sub {
  my ($child, $cont, $indent) = @_;
  my $child_basename = $child->basename;
  my $child_stat     = $child->stat();
  my $child_mtime    = $child_stat->[9];

  $indent = 1 if (!defined $indent);
  my $width = 40 - 3 * ($indent - 1);

  if ($last_indent != $indent) {
    if ($last_indent > ($indent + 1)) {
      for my $level (($indent + 1)..($last_indent - 1)) {
        $output[$#output - $_] = 
          substr($output[$#output - $_], 0, 3 * ($level - 1)) . ' ' .
          substr($output[$#output - $_], 3 * ($level - 1) + 1, 65535) 
            for (0..$tree[$level] - 1);
      }
      delete $tree[$_] for $indent..$last_indent;
    }
    $tree[$indent] = 0;
    $last_indent = $indent;
  }

  if ($child->is_dir) {
    push @output, sprintf("%s+- %-${width}s| %d",
      ('|  ' x ($indent - 1)), $child_basename . '/', $child_mtime);
    $tree[$indent] = 0;
  }
  else {
    push @output, sprintf("%s%s- %-${width}s| %d", ('|  ' x ($indent - 1)),
      ($child eq ($child->dir->children)[-1] ? '\\' : '|' ),
      $child_basename, $child_mtime);
    $tree[$indent]++;
  }
  $tree[$_]++ for (1..$indent - 1);

  $cont->($indent + 1);
});

for my $level (1..$last_indent - 1) {
  $output[$#output - $_] = 
    substr($output[$#output - $_], 0, 3 * ($level - 1)) . ' ' .
    substr($output[$#output - $_], 3 * ($level - 1) + 1, 65535)
      for (0..$tree[$level] - 1);
}

print "$_\n" for @output; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:24:35.093

```
if ($child->is_dir) {
    printf "%s+- %-${width}s| %d\n",
        ('|  ' x ($indent - 1)),
        $child_basename . '/',
        $child_mtime;
} else {
    printf "%s%s- %-${width}s| %d\n",
        ('|  ' x ($indent - 1)),
        ($child eq ($child->dir->children)[-1] ? '\\' : '|' ),
        $child_basename,
        $child_mtime;
} 
```

此外，ASCII 行会导致眼癌。请改用正确的[方框图字符](http://www.fileformat.info/info/unicode/block/box_drawing/images.htm)。

# magento - Magento 订单确认页面上的小计减优惠券/折扣

> ID：10606688
> 
> 赞同：2
> 
> 时间：2012-05-15T18:28:55.103
> 
> 标签：magento

在 Magento 1.5 的订单确认页面上（使用模板，我有一些分析转换代码脚本（如 Google AdWords 转换跟踪）。

当前用于获取小计的代码是

```
<?php $order_id = Mage::getSingleton('checkout/session')->getLastRealOrderId(); ?>
<?php $order_details = Mage::getModel('sales/order')->loadByIncrementId($order_id); ?>
<?php $subtotal = $order_details->subtotal; ?> 
```

然后在整个过程中使用 $subtotal 变量。问题是这是在应用任何优惠券或折扣之前的小计。我需要它是优惠券或折扣后的总数。

任何人都可以帮助我获得该值的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:02:03.173

您可以调用`var_dump($order_details->debug())`查看订单对象的所有数据字段。我没有看到任何与折扣相匹配的小计，但我确实看到了一个`discount_amount`字段，其中包含总折扣金额（作为负数）；将此添加到您的小计中。

如果您想要总计，包括折扣和运费，请使用该`grand_total`字段。

# php - PHP while循环，使用ajax将信息更新到页面

> ID：10606691
> 
> 赞同：0
> 
> 时间：2012-05-15T18:29:04.510
> 
> 标签：php, ajax, while-loop

我有一个我正在处理的 WOL PHP 脚本，我希望找到一种方法来使用 ajax 刷新页面的一部分，或者我是否应该调用外部 php 脚本？

我的 PHP 脚本启动了一台电脑，然后多次检查它是否已启动并运行....但是，对于 PHP，用户显然必须等到它完全完成才能显示结果，我希望那里是一种让我正在运行的“while 循环”在页面的第一部分加载后运行和更新的方法吗？

本质上，checkstatus 函数检查端口是否正在运行，然后显示输出。我希望加载主页，然后使用 ajax 或其他 php 脚本更新端口检查的状态？不知道怎么做。

```
function CheckStatus($tries, $device, $deviceip, $deviceport, $devicemac1, $devicemac2, $maxtries, $broadcast, $udport, $timeout){
    while($tries <= $maxtries){
        echo "<br \>";
        echo "Try $tries of $maxtries";
        echo "<br \>";
        //echo portcheck($deviceip, $deviceport);
        if (portcheck($deviceip, $deviceport) != 0){
                echo "  ------>  Could NOT open connection to $device at $deviceip on port $deviceport";
                echo "<br \>";                
                //echo "<br /> TRIES: $tries";

            }else{
                echo "<br \>";
                echo "<br \>";
                echo "<br \>";
                echo "TESTED OKAY!  $device";
                return TRUE;
            }
            $tries=$tries + 1;
    }
    echo "<br />";
    echo "MAX TRIES REACHED... COULD NOT CONNECT!";
    return FALSE;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:13:43.140

发表评论说“你不能在单个 PHP 实例中做到这一点”，我现在继续证明自己错了。

可以使用某种[服务器推送](http://en.wikipedia.org/wiki/Push_technology#HTTP_server_push)设置来*做到这一点。*考虑以下代码：

```
<?php

  // Do all your preliminary stuff here

?>
<html>
  <head>
    <title>Server push demo</title>
    <script type="text/javascript">
      function updateTries(tries) {
        document.getElementById('num_tries').innerHTML = tries;
      }
      function pushEvent(str) {
        var event = document.createElement('div');
        event.innerHTML = str;
        document.getElementById('stream_container').appendChild(event);
      }
    </script>
  </head>
  <body>
    <div>
      Number of tries:
      <span id="num_tries"></span>
    </div>
    <div id="stream_container"></div>
<?php

  // Push all output so far to the client
  flush();

  // Start status check loop
  CheckStatus($tries, $device, $deviceip, $deviceport, $devicemac1, $devicemac2, $maxtries, $broadcast, $udport, $timeout);

  function CheckStatus($tries, $device, $deviceip, $deviceport, $devicemac1, $devicemac2, $maxtries, $broadcast, $udport, $timeout){

    while ($tries < $maxtries) {

        echo "<script type='text/javascript'>updateTries($tries);</script>";
        flush();

        if (portcheck($deviceip, $deviceport) != 0){

          echo "<script type='text/javascript'>pushEvent('Could NOT open connection to $device at $deviceip on port $deviceport');</script>";
          flush();

        } else {

          echo "<script type='text/javascript'>pushEvent('TESTED OKAY! $device');</script>";
          flush();
          return TRUE;

        }

        $tries++;

    }

    echo "<script type='text/javascript'>pushEvent('MAX TRIES REACHED... COULD NOT CONNECT!');</script>";
    flush();
    return FALSE;

  }

?>
</body></html> 
```

但是，我仍然认为最好将循环抽象到客户端并使用 AJAX 轮询服务器，服务器一次执行一项检查。

# c# - 事后思考似乎不起作用，简单的代码

> ID：10606700
> 
> 赞同：2
> 
> 时间：2012-05-15T18:29:56.343
> 
> 标签：c#, code-injection, post-build-event, aop, afterthought

我编写了一段简单的代码来参与 Afterthought，但它不起作用，我不知道为什么。其中很大一部分来自其他 SO 问题：[How to implement simple Property Amendment with Afterthought](https://stackoverflow.com/questions/9944702/how-to-implement-simple-property-ammendment-with-afterthought)。

```
using System;
using System.Collections.Generic;
using Afterthought;
namespace SecondAmendmentTest
{
    class Program
    {
        public class TestUser
        {
            public int Id { get; set; }
            public string FirstName { get; set; }
            public string LastName { get; set; }
            public bool HasChanged { get; set; }
            public void method()
            {
                Console.WriteLine("method");
            }
        }

        public class TestUserAmmendment<T> : Amendment<T, T> where T : TestUser
        {
            public TestUserAmmendment()
            {
                Properties
                    .AfterSet((instance, x, y, z, a) => instance.HasChanged = true);
                Methods.After(ExceptionMethod);
            }

            private object ExceptionMethod(T instance, string method, object[] parameters, object result)
            {
                throw new NotImplementedException();
            }
        }

        static void Main(string[] args)
        {
            TestUser tu = new TestUser();
            Console.WriteLine("Has changed: " + tu.HasChanged.ToString());
            Console.WriteLine("Performing changes...");
            tu.Id = 5;
            tu.FirstName = "name";
            tu.LastName = "lastname";
            Console.WriteLine("Has changed: " + tu.HasChanged.ToString());
            tu.method();
            Console.ReadKey();
        }
    }
} 
```

它可以编译，但不会对输出的 exe 文件进行任何更改。我已经配置了构建后事件。构建输出：

```
1>------ Rebuild All started: Project: SecondAmendmentTest, Configuration: Debug Any CPU ------
1>  SecondAmendmentTest -> C:\Users\Lukasz\Documents\Visual Studio 11\Projects\SecondAmendmentTest\SecondAmendmentTest\bin\Debug\SecondAmendmentTest.exe
1>  Amending SecondAmendmentTest.exe (5,559 seconds)
========== Rebuild All: 1 succeeded, 0 failed, 0 skipped ========== 
```

最后在运行后从应用程序输出：

```
C:\Users\Lukasz\Documents\Visual Studio 11\Projects\SecondAmendmentTest\SecondAmendmentTest\bin\Debug>SecondAmendmentTest.exe
Has changed: False
Performing changes...
Has changed: False
method 
```

既未修改 HasChanged 属性，也未引发 NotImplementedException。我正在使用 Git 的最后一个资源。你有什么想法为什么它不起作用？

编辑：这是整个解决方案：[SecondAmendmentTest.zip](http://dl.dropbox.com/u/1014611/SecondAmendmentTest.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-10T00:34:31.837

我知道这是一年后，但是：

为了以 Willem van Ketwich 的回答为基础，Afterthought.NET 中实际上存在一个错误（疏忽？），如果不修改其父类型，则不允许修改嵌套类型。

我已经提交了修复错误的[拉取请求。](https://github.com/vc3/Afterthought/pull/49)

除了这个修复，你还需要`[Amendment(typeof(TestUserAmmendment<>))]`在你的嵌套类上触发修正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T04:32:43.073

我通过做两件事来做到这一点：

*   将 TestUser 和 TestUserAmmendment 类移出 Program 类，这样它们就不会嵌套。

*   将属性添加`[Amendment(typeof(TestUserAmmendment<>))]`到 TestUser 类。

工作解决方案可以在[这里](https://sites.google.com/site/willvk/home/files/SecondAmendmentTestMod.zip?attredirects=0&d=1)找到。

# c# - Selenium WebDriver - 如何使用 C# 设置页面加载超时

> ID：10606703
> 
> 赞同：42
> 
> 时间：2012-05-15T18:29:59.733
> 
> 标签：c#, selenium, timeout, webdriver, wait

我正在使用 Selenium 2.20 WebDriver 创建和管理带有 C# 的 firefox 浏览器。要访问一个页面，我使用以下代码，在访问 URL 之前设置驱动程序超时：

```
driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(5)); // Set implicit wait timeouts to 5 secs
driver.Manage().Timeouts().SetScriptTimeout(new TimeSpan(0, 0, 0, 5));  // Set script timeouts to 5 secs
driver.Navigate().GoToUrl(myUrl);   // Goto page url 
```

问题是有时页面需要永远加载，并且使用 selenium WebDriver 加载页面的默认超时似乎是 30 秒，这太长了。而且我不相信我设置的超时适用于使用 GoToUrl() 方法加载页面。

所以我试图弄清楚如何为页面加载设置超时，但是，我找不到任何实际有效的属性或方法。当我单击一个元素时，默认的 30 秒超时似乎也适用。

有没有办法将页面加载超时设置为特定值，以便当我调用 GoToUrl() 方法时它只会等待我指定的时间才能继续？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2017-06-21T20:46:37.697

```
driver.Manage().Timeouts().PageLoad = TimeSpan.FromSeconds(5); 
```

注意：`driver.Manage().Timeouts().SetPageLoadTimeout(TimeSpan.FromSeconds(5))`现在已弃用。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-08-27T17:49:47.323

如果这有助于任何仍在寻找答案的人，C# WebDriver API 现在包含适当的方法。

```
driver.Manage().Timeouts().SetPageLoadTimeout(timespan) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-15T18:50:57.540

有了这个，您应该能够明确声明等待。

```
WebDriverWait wait = new WebDriverWait(browser, new TimeSpan(time in seconds));
wait.until(Your condition) 
```

您还可以更改隐式等待时间

```
driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(10)); 
```

我认为这是 C# 中的语法。（不确定）

在红宝石中是

```
@driver.manage.timeouts.implicit_wait = 30
@wait = Selenium::WebDriver::Wait.new(:timeout => 30) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-17T16:07:01.773

我找到了这个问题的解决方案。创建新的 FirefoxDriver 时，构造函数中有重载，允许您指定命令超时，这是等待每个命令的最长时间，并且在调用 GoToUrl() 方法时似乎可以正常工作：

```
driver = new FirefoxDriver(new FirefoxBinary(), profile, new TimeSpan(0, 0, 0, timeoutSeconds)); 
```

链接到 FirefoxDriver 构造函数文档以供参考： [http ://selenium.googlecode.com/svn/trunk/docs/api/dotnet/html/M_OpenQA_Selenium_Firefox_FirefoxDriver__ctor_2.htm](http://selenium.googlecode.com/svn/trunk/docs/api/dotnet/html/M_OpenQA_Selenium_Firefox_FirefoxDriver__ctor_2.htm)

希望这可以帮助遇到此问题的其他人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-15T19:40:37.897

页面加载超时尚未在 .NET 绑定中实现。希望他们会很快。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-16T20:49:46.213

截至 2018 年：除此之外：

```
driver.Manage().Timeouts().ImplicitWait.Add(System.TimeSpan.FromSeconds(5));      
driver.Manage().Timeouts().PageLoad.Add(System.TimeSpan.FromSeconds(5));
driver.Manage().Timeouts().AsynchronousJavaScript.Add(timespan)); 
```

分别等待搜索项目、加载页面和等待脚本。有：

```
WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10)); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-09-25T17:25:25.217

我们巴西人对糟糕的解决方法“Gambiarra”有一个词......嗯......至少他们完成了这项工作......这是我的：

```
var url = "www.your.url.here"
try {
    DRIVER.Navigate().GoToUrl(url);
} catch {
    // Here you can freely use the Selenium's By class:
    WaitElement(By.Id("element_id_or_class_or_whatever_to_be_waited"), 60);
}
// rest of your application 
```

我的`WaitElement(By, int)`工作：

```
/// <summary>
/// Waits until an element of the type <paramref name="element"/> to show in the screen.
/// </summary>
/// <param name="element">Element to be waited for.</param>
/// <param name="timeout">How long (in seconds) it should be waited for.</param>
/// <returns>
/// False: Never found the element. 
/// True: Element found.
/// </returns>
private bool WaitElement(By element, int timeout)
{
    try {
        Console.WriteLine($" - Waiting for the element {element.ToString()}");
        int timesToWait = timeout * 4; // Times to wait for 1/4 of a second.
        int waitedTimes = 0; // Times waited.
        // This setup timesout at 7 seconds. you can change the code to pass the 

        do {
            waitedTimes++;
            if (waitedTimes >= timesToWait) {
                Console.WriteLine($" -- Element not found within (" +
                $"{(timesToWait * 0.25)} seconds). Canceling section...");
                return false;
            }
            Thread.Sleep(250);
        } while (!ExistsElement(element));

        Console.WriteLine($" -- Element found. Continuing...");
    //  Thread.Sleep(1000); // may apply here
        return true;
    } catch { throw; }
} 
```

在此之后，您可以玩`timeout`...

让`By`您注意到在页面中最后加载的内容（如 javascript 元素和验证码）记住：它将`// rest of your application`在页面完全加载之前开始工作，因此最好将 a`Thread.Sleep(1000)`放在最后以确保...

另请注意，此方法将在 Selenium 的 60 秒标准超时后调用`DRIVER.Navigate().GoToUrl(url);`

不是最好的，但是......正如我所说：一个好的gambiarra可以完成工作......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-30T05:59:17.860

对于任何想要相反效果的人：设置超时时间超过 60 秒。

你需要同时使用：

```
new FirefoxDriver(FirefoxDriverService.CreateDefaultService(), new FirefoxOptions(), TimeSpan.FromSeconds(120)) 
```

和

```
driver.Manage().Timeouts().PageLoad = TimeSpan.FromSeconds(120); 
```

`new FirefoxDriver(binary, profile, timeSpan)`已经过时了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-16T16:37:01.037

```
driver.Manage().Timeouts().SetPageLoadTimeout(timespan) 
```

不起作用。

这行得通。使用属性设置器语法。

```
driver.Manage().Timeouts().PageLoad = TimeSpan.FromSeconds(15); 
```

# c# - 如何从 web javascript 应用程序获取桌面 c# 程序中的变量

> ID：10606706
> 
> 赞同：0
> 
> 时间：2012-05-15T18:30:14.727
> 
> 标签：c#, javascript, web, desktop

我遇到了一个问题，有两个应用程序。一个是 c# 中的桌面应用程序，另一个是 javascript 中的 Web 应用程序。运行桌面应用程序中的一些变量或信息需要传输到 Web 应用程序。有谁知道如何解决这个问题？有没有人想提供更多细节来解决这个问题？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:35:34.130

我认为这些进程是非常分离的，除非您使用 c# + js 的唯一处理程序（例如 c#.net 来呈现您的页面），否则将无法检索数据。

也许你可以从 webbrowser 对象中得到一些东西：在你的页面上运行它，你可能会访问你的一些 web 变量......

此外，如果 c# 应用程序将数据写入文件，js 可以读取它......

玩得开心

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:35:00.420

当您打开 Web 应用程序时，将变量作为[查询字符串参数](http://en.wikipedia.org/wiki/Query_string)传入，您可以使用 javascript 各种方式获取它们，其中一些在[此处注明](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

# mysql - Mysql大表vs连接

> ID：10606709
> 
> 赞同：0
> 
> 时间：2012-05-15T18:30:22.977
> 
> 标签：mysql, normalization

我有一个（项目 [id, name, color, size, etc] ）表超过 6000。我认为它最多可以达到 10000。在那个表中基本上是关于项目的信息。我还有 5 个常量库表和 0 到 7 个临时库表。这些表是这样的（id、item_id、数量）。我试图通过将这些仓库组合在一个表中（id、item_id、数量、storehouse_id）来规范化该数据库。当使用自联接从所有仓库中搜索多个项目时，这使得搜索速度非常慢 6-10 秒。然后我决定将项目与新创建的数据库（id、名称、颜色、大小等、storehouse1_quantity、storehouse2_quantity 等）结合起来。这使得任何请求的查询时间都小于 0.1 秒。但是现在数据库非常非规范化。由于仓库的物品不超过 2000 件，而且大多少于 500 件。如果没有更好的方法，我可以忍受。我不知道在哪里可以使数据库更具逻辑性并且更易于维护。任何帮助表示赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:32:13.523

好吧，规范化方法是“正确”的方法，并且由于数据库引擎是为处理这个问题而构建的，所以我将开始查看您的索引排列是什么。如果有很多查找/连接，通常应该有一个索引，这样 MySQL 就不必遍历所有文本。

# tsql - 存储过程联合所有问题

> ID：10606717
> 
> 赞同：0
> 
> 时间：2012-05-15T18:30:52.473
> 
> 标签：tsql, stored-procedures, union-all

我有一个存储过程，我试图使用 组合两个不同的`SELECT`语句`UNION ALL`，但是在执行查询之后，只`SELECT`返回第一个中的项目。

我想从第一个和第二个 select 语句中获取所有项目。

这是我所拥有的：

```
CREATE PROCEDURE [dbo].[Report_AllActivitiesOfficesAll]
    @BeginDate datetime,
    @EndDate datetime
AS
    SET @BeginDate = .dbo.DateOnly(@BeginDate)
    SET @EndDate = .dbo.DateOnly(@EndDate)
BEGIN
    SET NOCOUNT ON;

    SELECT 
          O.OfficeId,
          O.OfficeName AS Name,
          AT.Description AS Activity,
          SUM(A.Duration) AS [Minutes], 
          CAST(SUM(A.Duration) AS FLOAT) / 60 AS [Hours],  
          COUNT(A.ActivityId) AS Activities,
          COUNT(DISTINCT A.CaseId) AS Cases,
          MIN(CAST(A.Duration AS FLOAT) / 60) AS [Min Time],
          MAX(CAST(A.Duration AS FLOAT) / 60) AS [Max Time],
          SUM(CAST(A.Duration AS FLOAT) / 60) / COUNT(A.ActivityId) AS [Avg Time],
          SUM(CAST(A.Duration AS FLOAT) / 60) AS [TotalHours]
      FROM Activity A
          INNER JOIN ActivityType AT ON A.ActivityTypeId = AT.ActivityTypeId
          INNER JOIN ActivityEntry AE ON A.ActivityEntryId = AE.ActivityEntryId
          INNER JOIN [Case] C ON A.CaseId = C.CaseId
          INNER JOIN [Office] O ON AE.OfficeId = O.OfficeId
          INNER JOIN [User] U ON C.CreatedByUserId = U.UserId
      WHERE .dbo.DateOnly(AE.ActivityDate) BETWEEN @BeginDate AND @EndDate 
      GROUP BY 
            O.OfficeId,
            O.OfficeName,
            AT.Description

      UNION ALL

      SELECT 
        O.OfficeId,
        O.OfficeId AS NonCaseOfficeId,
        O.OfficeName AS OfficeName,
        NCAT.Description AS NonCaseActivityType, 
        SUM(NCA.Duration) AS [Minutes],
        CAST(SUM(NCA.Duration) AS FLOAT) / 60 AS [Hours],
        COUNT(NCA.NonCaseActivityId) AS Activities,
        MIN(CAST(NCA.Duration AS FLOAT) / 60) AS [Min Time],
        MAX(CAST(NCA.Duration AS FLOAT) / 60) AS [Max Time],
        SUM(CAST(NCA.Duration AS FLOAT) / 60) / COUNT(NCA.NonCaseActivityId) AS [Avg Time],
        SUM(CAST(NCA.Duration AS FLOAT) / 60) AS [TotalHours]
    FROM NonCaseActivity NCA
        INNER JOIN NonCaseActivityType NCAT ON NCA.NonCaseActivityTypeId = NCAT.NonCaseActivityTypeId
        INNER JOIN [Office] O ON NCA.OfficeId = O.OfficeId
        INNER JOIN [User] U ON NCA.UserId = U.UserId
    WHERE .dbo.DateOnly(NCA.ActivityDate) BETWEEN @BeginDate AND @EndDate
    GROUP BY
        O.OfficeId,
        O.OfficeName,
        NCAT.Description
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:17:46.523

列必须在数据类型和内容上匹配才能正确有效地使用联合。您不能在中间更改列名。如果您需要知道一条记录来自联合的哪个部分，请添加另一列来执行此操作。你的没有。Officename 位于第一个查询的第二列和第二个查询的第三列。第二个查询的第二列中的内容很可能与第一个查询的第二列中的数据类型不同。这不是唯一的不匹配，而是一个例子。

如果您在第二个查询中需要第一个查询中不需要的列，您仍必须将它放在第一个查询中。如果您在第一列中需要一列，而第二列中不需要，则必须在查询中的该位置放置一个空值。例如（不是完全重写你所拥有的，但足以了解我在说什么）：

```
SELECT            
    O.OfficeId,    
    CAST(NULL as int) as   NonCaseOfficeId     
    O.OfficeName AS Name,           
    AT.Description AS Activity, 
    COUNT(DISTINCT A.CaseId) AS Cases,
     cast('Case' as varchar (10)) as recordType         
FROM Activity A           
    INNER JOIN ActivityType AT ON A.ActivityTypeId = AT.ActivityTypeId           
    INNER JOIN ActivityEntry AE ON A.ActivityEntryId = AE.ActivityEntryId           
    INNER JOIN [Case] C ON A.CaseId = C.CaseId           
    INNER JOIN [Office] O ON AE.OfficeId = O.OfficeId          
    INNER JOIN [User] U ON C.CreatedByUserId = U.UserId       
WHERE .dbo.DateOnly(AE.ActivityDate) BETWEEN @BeginDate AND @EndDate        
GROUP BY              
    O.OfficeId,             
    O.OfficeName,             
    AT.Description   
UNION ALL        

SELECT          
    O.OfficeId,         
    O.OfficeId,         
    O.OfficeName,         
    NCAT.Description,
    cast(NULL as int),
     'NonCase'  
FROM NonCaseActivity NCA         
    INNER JOIN NonCaseActivityType NCAT 
        ON NCA.NonCaseActivityTypeId = NCAT.NonCaseActivityTypeId
    INNER JOIN [Office] O ON NCA.OfficeId = O.OfficeId         
    INNER JOIN [User] U ON NCA.UserId = U.UserId     
WHERE .dbo.DateOnly(NCA.ActivityDate) BETWEEN @BeginDate AND @EndDate 
```

现在，由于查询还采用了第一个查询的数据类型，您会看到我专门将它转换为我想要的数据类型。您可能需要在联合的第二部分中的 null 上执行此操作，同时确保数据类型匹配。我相信如果您不指定，SQL 服务器会将 null 假定为 int，因此当您需要其他数据类型时，这一点最重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:49:52.260

对我来说似乎很好。请记住，使用的列名将来自第一个查询。

因此，如果我使用如下查询：

```
SELECT 1 AS Something
UNION ALL
SELECT 2 AS SomethingElse 
```

我只会在名为 Something 的字段下看到结果（1 和 2），而不会在名为 SomethingElse 的字段下看到任何结果。

也许这就是问题所在？

尝试向两个查询添加一个额外的字段，以标识它从哪个结果集中提取。

也许为第一个查询添加“活动”作为源，为第二个查询添加“非案例活动”作为源，只是为了确保您清楚地了解所显示的内容？

# objective-c - 无法从 Objective C 中的大双精度数中添加/减去

> ID：10606719
> 
> 赞同：2
> 
> 时间：2012-05-15T18:30:59.570
> 
> 标签：objective-c, double

我正在尝试使用以下代码从双精度数中减去 1：

```
-(NSMutableArray *)getMoreTwitterDataWithMaxID:(double)maxID {
    double newestID = (maxID - 1);
    NSLog(@"newest ID is %f and maxID is %f", newestID, maxID);
    // other code
} 
```

控制台吐出这个：

```
2012-05-15 11:21:14.693 nearYou[2570:3a03] newest ID is 202429657738522624.000000 and maxID is 202429657738522624.000000 
```

我不确定他们为什么不减去 . . .

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:44:19.350

可能是你已经达到了双精度数据类型的限制。您可以改用[NSDecimal](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:39:20.590

您可能已经达到双浮点格式的限制。64 位浮点格式只有 52 位尾数，这意味着它在使用指数之前只能以任何整数精度保存 52 位整数。你的数字比那个大，所以一个整数和下一个可能的整数之间的差距已经大于 1。

# sql-server - 使用 SQL 镜像和连接字符串进行自动故障转移

> ID：10606720
> 
> 赞同：3
> 
> 时间：2012-05-15T18:31:00.743
> 
> 标签：sql-server, connection-string, failover, mirroring

我使用见证服务器为 SQL 镜像和自动故障转移设置了 3 台服务器。这按预期工作。

现在，我连接到数据库的应用程序在发生故障转移时似乎出现问题 - 我需要手动干预并更改连接字符串以使其再次连接。到目前为止，我发现的最佳解决方案涉及使用`Failover Partner`连接字符串的参数，但它既不直观也不完整：`Data Source="Mirror";Failover Partner="Principal"` [在此处找到](http://blogs.msdn.com/b/spike/archive/2010/12/08/clarification-on-the-failover-partner-in-the-connectionstring-in-database-mirror-setup.aspx)。

从上面博客中的示例（场景#3）中，当第一次故障转移发生并且主体（故障转移伙伴）不可用时，将使用数据源（这是新的主体）。如果它再次失败（我只在有限的时间内尝试过），它就会出现一条错误消息。发生这种情况是因为连接字符串被缓存，所以在刷新之前，它会不断出现错误（似乎连接字符串在遇到错误后刷新约 5 分钟）。如果在故障转移后我交换数据源和故障转移伙伴，我将再次进行一次静默故障转移。

有没有办法为使用镜像数据库的应用程序实现全自动故障转移（没有看到错误）？

我可以看到使用自定义脚本的潜在解决方法，这些脚本将轮询当前活动的数据库节点名称并相应地调整连接字符串，但目前这似乎有点过头了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-17T21:54:48.913

在此处阅读博客文章 [http://blogs.msdn.com/b/spike/archive/2010/12/15/running-a-database-mirror-setup-with-the-sqlbrowser-service-off-may-produce -unexpected-results.aspx](http://blogs.msdn.com/b/spike/archive/2010/12/15/running-a-database-mirror-setup-with-the-sqlbrowser-service-off-may-produce-unexpected-results.aspx)

它解释了正在发生的事情，故障转移伙伴实际上是从 sql 服务器而不是从您的配置中读取的。运行该帖子中的查询以找出实际用作故障转移服务器的内容。它可能是一个无法从您的客户端运行的位置发现的机器名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T15:35:23.267

如果发生故障转移，您可以清除应用程序池。我知道不是很好;-)

```
 // ClearAllPools resets (or empties) the connection pool. 
  // If there are connections in use at the time of the call, 
  // they are marked appropriately and will be discarded 
  // (instead of being returned to the pool) when Close is called on them.
  System.Data.SqlClient.SqlConnection.ClearAllPools(); 
```

当我们通过 SQL Server 别名更改底层服务器时，我们使用它来强制“刷新”服务器名称。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearallpools.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearallpools.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T07:43:33.117

解决方案是关闭连接池`Pooling="false"`

虽然这对小型应用程序的影响很小，但我还没有用每分钟接收数百个请求（或更多）的应用程序测试它，并且不确定它的含义是什么。有人愿意发表评论吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-14T13:27:37.043

试试这个连接字符串：

`connectionString="Data Source=[MSSQLPrincipalServerIP,MSSQLPORT];Failover Partner=[MSSQLMirrorServerIP,MSSQLPORT];Initial Catalog=DatabaseName;Persist Security Info=True;User Id=userName; Password=userPassword.; Connection Timeout=15;"`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-20T11:36:15.107

如果使用.net开发，可以尝试使用ObjAdoDBLib或PigSQLSrvLib和PigSQLSrvCoreLib，代码会变得简单。

***示例代码：***

新对象
ObjAdoDBLib

> Me.ConnSQLSrv = 新 ConnSQLSrv（Me.DBSrv，Me.MirrDBSrv，Me.CurrDB，Me.DBUser，Me.DBPwd，Me.ProviderSQLSrv）

PigSQLSrvLib 或 PigSQLSrvCoreLib

> Me.ConnSQLSrv = 新 ConnSQLSrv（Me.DBSrv，Me.MirrDBSrv，Me.CurrDB，Me.DBUser，Me.DBPwd）

镜像数据库故障转移后，执行该方法自动连接在线数据库。

> Me.ConnSQLSrv.OpenOrKeepActive

***有关详细信息，请参阅相关链接。***

> [https://www.nuget.org/packages/ObjAdoDBLib/](https://www.nuget.org/packages/ObjAdoDBLib/)

> [https://www.nuget.org/packages/PigSQLSrvLib/](https://www.nuget.org/packages/PigSQLSrvLib/)

> [https://www.nuget.org/packages/PigSQLSrvCoreLib/](https://www.nuget.org/packages/PigSQLSrvCoreLib/)

# c# - 具有公共访问器的自动属性与受保护变量

> ID：10606722
> 
> 赞同：0
> 
> 时间：2012-05-15T18:31:08.067
> 
> 标签：c#, properties

在我最近继承责任的一些代码中，我发现了几个原始开发人员执行以下操作的实例：

```
protected MyEnumerationType _foo;

public MyEnumerationType Foo
{
    get { return _foo; }
    set { this._foo = (MyEnumerationType) value; }
} 
```

这对我来说似乎是不必要的冗长，我很好奇这样做而不是简单地使用自动属性是否有一些优势：

```
public MyEnumerationType Foo { get; set; } 
```

我错过了什么吗？上面的第一段代码是否有一些我不知道的优势？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:35:07.467

很可能原始代码是在 C# 3.0 发布之前编写的，也就是引入[自动实现属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)的时候。在该语言的早期版本中，第一种方法是唯一可行的方法。

在 C# 3.0 及更高版本中，显式定义支持字段的主要优点是对其执行无法通过属性执行的操作，例如使用默认值初始化它（否则必须通过构造函数完成）并声明它是易变的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:32:39.327

这*可能*是一个优势，不知道它是否在您的域中，所以，如果您认为从该类派生的类可以访问该字段`MyEnumerationType _foo`，避免以这种方式（出于某种原因）通过属性访问它。

很难说在您的特定上下文中是否有某些含义，但是，我再说一遍，可能存在上述含义。

例如，如果我有：

```
public MyEnumerationType Foo
{
    get { return _foo; }
    set { 
           this._foo = (MyEnumerationType) value; 
           TriggerSomething(..);
       }
} 
```

所以设置该属性我会在我的环境中触发一些操作，如果我从某个子类更改该字段，直接访问该*字段*将帮助我避免不必要的（对于架构决策）触发。

# jquery - 如何在这个父母中找到孩子？

> ID：10606723
> 
> 赞同：0
> 
> 时间：2012-05-15T18:31:11.090
> 
> 标签：jquery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:44:38.020

虽然@Imdad 完全就在这里。因为 ID 在定义上是唯一的，包括标签名称是无关的。只需使用`'#'`而不是`'a#'`

```
 to_user = $("#"+msg_id).find("div.fromTo").text() 
```

如果您有多种类型的标签具有相同的 id（因此需要同时查询标签名称和 id 来获取元素），您将会遇到问题，并且确实应该使用类或数据属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:34:01.323

`#id`如果您直接通过 id 访问，则该语法有效。如果您想先访问标签名称，然后给出 id（或任何其他属性），那么以下方式将起作用

```
to_user = $("a[id='"+msg_id+"']").find("div.fromTo").text(); 
```

同样，您可以访问具有任何属性的元素

`$("a[attribute_name='"+desired_value+"']")`

您可以在此处详细说明[http://api.jquery.com/category/selectors/attribute-selectors/](http://api.jquery.com/category/selectors/attribute-selectors/)

# java - String 方法 isEmpty 在 Android API Levels < 10 中真的不可用吗？

> ID：10606725
> 
> 赞同：3
> 
> 时间：2012-05-15T18:31:12.677
> 
> 标签：java, android, string, netbeans

我正在使用 NetBeans 并`nbandroid`构建我的 Android 应用程序。以前我的目标是 API 级别 10 (2.3.3)，但我意识到这样做会从我的应用程序中排除太多人，并且（我认为）我的应用程序没有使用任何超过 API 级别 7 的功能。但是，在在 NetBeans 的项目属性中更改我的 API 级别，我的项目将无法编译并且编译`myString.isEmpty()`条件失败。我知道这很容易修复/替换，但是`String.isEmpty`直到 API 级别 10 才真正可用？如果没有，我该如何修复我的`nbandroid`项目？我注意到，即使我在项目属性中选择了 API 级别，在库下它总是显示 Android 2.3.3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:15:17.540

检查字符串是否为空（没有`isEmpty`方法）的更有效方法是检查其长度是否为 0 与 using `equals`，如：

```
if ( myString.length() == 0 )
{
  // is emtpy
} 
```

实际上，这`isEmpty`就是幕后所做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:36:00.243

isEmpty 是在 API 9 中添加的。（[参考](http://developer.android.com/reference/java/lang/String.html#isEmpty%28%29)）

如果您愿意，您仍然可以将您的应用程序转换为 API 7，您需要使用`String.length() != 0`而不是`isEmpty();`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T18:38:29.717

它可能仍然说您使用 2.3.3 库，因为您已`targetSdk`设置为 2.3.3。

* * *

如果 Min SDK 超过**2.2 (8)**，您将失去**27.1%**的观众

如果 Min SDK 超过**2.1 (7)**，您将损失**6.2%**

如果 Min SDK 超过**1.6 (6)**，您将损失**0.7%**

因此，如果您不想超过**2.3 (9)** ，这取决于您。

（*我个人建议将您的 minSdk 设置为 2.2 (8) 并针对 3.0 (11)*）

* * *

至于 String.isEmpty()

```
 if("".equals(String)){
   // is Empty
 } 
```

或者

```
 if(!"".equals(String) && String != null){
   // is Not Empty
 } 
```

对于完整的 isEmpty 实现，您需要记住您的字符串可能为空或充满空格（从技术上讲是空的）：

```
 if(String != null && "".equals(String.trim())){
   // is Empty
 } 
```

检查 null 允许您在`trim()`没有 NullPointerException 的情况下调用该方法

参考：

[统计参考](http://developer.android.com/resources/dashboard/platform-versions.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-15T18:35:58.263

[这](http://developer.android.com/reference/java/lang/String.html#isEmpty%28%29)是文档。它可从 API 9 及更高版本获得。正如你所说，它很容易被替换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T18:35:48.760

它就在那里，[从九级开始](http://developer.android.com/reference/java/lang/String.html#isEmpty%28%29)。

# mysql - Active Record 或 mysql 中的批处理计数

> ID：10606726
> 
> 赞同：0
> 
> 时间：2012-05-15T18:31:16.223
> 
> 标签：mysql, ruby-on-rails, activerecord, batch-file, count

我的目标是为给定集合的每个模型对象导出投票。在此示例中，我使用 .all，但在野外，它将是产生大集合的 .where。我有以下我担心的查询：

```
Model.all.each{|x|puts x.votes.count}.explain

   (0.4ms)  SELECT COUNT(*) FROM `votes` WHERE `votes`.`entry_id` = 1
0
   (0.3ms)  SELECT COUNT(*) FROM `votes` WHERE `votes`.`entry_id` = 2
0
   (0.4ms)  SELECT COUNT(*) FROM `votes` WHERE `votes`.`entry_id` = 3
1
   (0.3ms)  SELECT COUNT(*) FROM `votes` WHERE `votes`.`entry_id` = 4
0
   (0.2ms)  SELECT COUNT(*) FROM `votes` WHERE `votes`.`entry_id` = 5
0 
```

单独计数非常快，但我觉得调用 All 不太舒服，尤其是当我有数千或数百万的集合时。有没有办法将记录计为批量操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:35:45.613

不确定“全部”是什么意思，但做同样的事情，只尝试使用 GROUP BY ID 和 COUNT 函数。像这样的东西：

```
SELECT COUNT(*) FROM Votes GROUP BY entry_id 
```

# c# - 在 C# 中搜索名称列表的最快方法

> ID：10606728
> 
> 赞同：3
> 
> 时间：2012-05-15T18:31:23.867
> 
> 标签：c#

我的应用程序的内存中可能有 100,000 个字符串的列表。我需要找到包含某个关键字的前 20 个字符串（不区分大小写）。这很容易做到，我只需运行以下 LINQ。

```
from s in stringList
where s.ToLower().Contains(searchWord.ToLower())
select s 
```

但是，我有一种明显的感觉，我可以更快地做到这一点，我需要找到方法，因为我需要每秒多次在这个列表中查找。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:34:03.757

查找子字符串（不完全匹配）非常困难。没有任何内置功能可以帮助您解决此问题。我建议您研究可用于有效查找子字符串的[后缀树数据结构。](http://en.wikipedia.org/wiki/Suffix_tree)

顺便说一句，您可以拉出`searchWord.ToLower()`一个局部变量来节省大量的字符串操作。您还可以预先计算 stringList 的小写版本。如果你不能预先计算，至少使用`s.IndexOf(searchWord, StringComparison.InvariantCultureIgnoreCase) != -1`. 这节省了昂贵的 ToLower 调用。

您还可以在查询上添加 .AsParallel。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:46:12.453

另一种选择，虽然它需要相当多的内存，但会预先计算类似后缀数组的东西（字符串中的位置列表，按它们指向的字符串排序）。

[http://en.wikipedia.org/wiki/Suffix_array](http://en.wikipedia.org/wiki/Suffix_array)

如果您要搜索的字符串列表相对静态，这将是最可行的。整个字符串索引列表可以存储在单个元组数组中（indexOfString，positionInString），您可以在其上执行二进制搜索，使用`String.Compare(keyword, 0, target, targetPos, keyword.Length)`.

因此，如果您有 100,000 个平均长度为 20 的字符串，则该结构需要 100,000 * 20 * 2*sizeof(int) 的内存。您可以通过将 indexOfString 和 positionInString 打包到一个 32 位 int 中来将其减半，例如，在最低 12 位中使用 positionInString，在剩余的高位中使用 indexOfString。您只需要稍微摆弄一下就可以恢复这两个值。重要的是要注意结构本身不包含字符串或子字符串。您要搜索的字符串仅存在一次。

这基本上会给你一个完整的索引，并允许非常快速地找到任何子字符串（对后缀数组表示的索引进行二进制搜索），而实际的字符串比较最少。

如果内存很贵，原始蛮力算法的简单优化将是预先计算唯一字符的字典，并分配序数来表示每个字符。然后为每个字符串预先计算一个位数组，并为字符串中包含的每个唯一字符设置位。由于您的字符串相对较短，因此返回的 BitArrays 应该有相当多的可变性（如果您的字符串很长，它将无法正常工作）。然后，您只需计算 BitArray 或您的搜索关键字，并仅在那些字符串中搜索关键字`keywordBits & targetBits == keywordBits`. 如果您的字符串预先转换为小写，并且只是英文字母，则 BitArray 可能适合单个 int。因此，这将需要最少的额外内存，易于实现，并且允许您快速过滤掉您肯定不会在其中找到关键字的字符串。这可能是一个有用的优化，因为字符串搜索速度很快，但是使用蛮力搜索有很多事情要做。

**编辑**对于那些感兴趣的人，这里是我提出的初始解决方案的基本实现。我使用 OP 描述的 100,000 个随机生成的长度字符串进行了测试。虽然构建和排序索引大约需要 30 秒，但一旦创建，搜索关键字 3000 次的速度是暴力搜索的 49,805 毫秒，使用索引搜索为 18 毫秒，因此快了几千倍。如果您很少构建列表，那么我最初构建后缀数组的简单但相对较慢的方法应该足够了。有更聪明的方法可以更快地构建它，但需要比我下面的基本实现更多的编码。

```
// little test console app
static void Main(string[] args) {
    var list = new SearchStringList(true);
    list.Add("Now is the time");
    list.Add("for all good men");
    list.Add("Time now for something");
    list.Add("something completely different");
    while (true) {
        string keyword = Console.ReadLine();
        if (keyword.Length == 0) break;
        foreach (var pos in list.FindAll(keyword)) {
            Console.WriteLine(pos.ToString() + " =>" + list[pos.ListIndex]);
        }
    }
}
~~~~~~~~~~~~~~~~~~
// file for the class that implements a simple suffix array
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace ConsoleApplication1 {
    public class SearchStringList {
        private List<string> strings = new List<string>();
        private List<StringPosition> positions = new List<StringPosition>();
        private bool dirty = false;
        private readonly bool ignoreCase = true;

        public SearchStringList(bool ignoreCase) {
            this.ignoreCase = ignoreCase;
        }

        public void Add(string s) {
            if (s.Length > 255) throw new ArgumentOutOfRangeException("string too big.");
            this.strings.Add(s);
            this.dirty = true;
            for (byte i = 0; i < s.Length; i++) this.positions.Add(new StringPosition(strings.Count-1, i));
        }

        public string this[int index] { get { return this.strings[index]; } }

        public void EnsureSorted() {
            if (dirty) {
                this.positions.Sort(Compare);
                this.dirty = false;
            }
        }

        public IEnumerable<StringPosition> FindAll(string keyword) {
            var idx = IndexOf(keyword);
            while ((idx >= 0) && (idx < this.positions.Count)
                && (Compare(keyword, this.positions[idx]) == 0)) {
                yield return this.positions[idx];
                idx++;
            }
        }

        private int IndexOf(string keyword) {
            EnsureSorted();

            // binary search
            // When the keyword appears multiple times, this should
            // point to the first match in positions. The following
            // positions could be examined for additional matches
            int minP = 0;
            int maxP = this.positions.Count - 1;
            while (maxP > minP) {
                int midP = minP + ((maxP - minP) / 2);
                if (Compare(keyword, this.positions[midP]) > 0) {
                    minP = midP + 1;
                } else {
                    maxP = midP;
                }
            }
            if ((maxP == minP) && (Compare(keyword, this.positions[minP]) == 0)) {
                return minP;
            } else {
                return -1;
            }
        }

        private int Compare(StringPosition pos1, StringPosition pos2) {
            int len = Math.Max(this.strings[pos1.ListIndex].Length - pos1.StringIndex, this.strings[pos2.ListIndex].Length - pos2.StringIndex);
            return String.Compare(strings[pos1.ListIndex], pos1.StringIndex, this.strings[pos2.ListIndex], pos2.StringIndex, len, ignoreCase);
        }

        private int Compare(string keyword, StringPosition pos2) {
            return String.Compare(keyword, 0, this.strings[pos2.ListIndex], pos2.StringIndex, keyword.Length, this.ignoreCase);
        }

        // Packs index of string, and position within string into a single int. This is
        // set up for strings no greater than 255 bytes. If longer strings are desired,
        // the code for the constructor, and extracting  ListIndex and StringIndex would
        // need to be modified accordingly, taking bits from ListIndex and using them
        // for StringIndex.
        public struct StringPosition {
            public static StringPosition NotFound = new StringPosition(-1, 0);
            private readonly int position;
            public StringPosition(int listIndex, byte stringIndex) {
                this.position = (listIndex < 0) ? -1 : this.position = (listIndex << 8) | stringIndex;
            }
            public int ListIndex { get { return (this.position >= 0) ? (this.position >> 8) : -1; } }
            public byte StringIndex { get { return (byte) (this.position & 0xFF); } }
            public override string ToString() {
                return ListIndex.ToString() + ":" + StringIndex;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:36:40.777

在这种情况下，您需要的是反向索引。

如果您愿意花很多钱，您可以使用数据库特定的全文搜索索引，并调整索引以索引每个单词子集。

或者，您可以使用一个非常成功的开源项目来实现相同的目标。

您需要使用标记器对字符串进行预索引，并构建反向索引文件。我们在 Java 中有类似的用例，我们必须在大量数据中进行非常快速的自动完成。

您可以查看[Lucene.NET](http://incubator.apache.org/lucene.net/)，它是 Apache Lucene（Java 中）的一个端口。

如果您愿意放弃 LINQ，可以使用 NHibernate Search。（眨眼）。

另一种选择是在内存中实现预索引，预处理和绕过不需要的扫描，看看[Knuth-Morris-Pratt 算法](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:43:32.660

有一种方法会快得多。但这意味着寻找精确的单词匹配，而不是使用该`Contains`功能。

基本上，如果你有它的记忆，你可以创建一个[单词字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)，它还为找到该单词的字符串引用某种 ID（或 ID）。

所以 Dictionary 可能是 type `<string, List<int>>`。当然，这里的好处是您将大量单词合并到一个较小的集合中。而且，字典的查找速度非常快，因为它是建立在哈希表上的。

现在，如果这不是您要查找的内容，您可以搜索内存中的全文搜索库。SQL Server 支持使用索引进行全文搜索，以加快传统通配符搜索的过程。但是纯粹的内存解决方案肯定会更快。但是，这仍然可能无法为您提供通配符搜索的确切功能。

# postgresql - 沿postgis中的点查找路径长度

> ID：10606730
> 
> 赞同：1
> 
> 时间：2012-05-15T18:31:31.993
> 
> 标签：postgresql, postgis

我有一个带有 gps-observations 的 postgis 数据库（postgres 8.4.11，postgis 1.5.2），我想在其中计算一些旅行距离。

我从 gpspoint p1, gpspoint p2 where p2.datetime=p1.datetime+interval '1 hour' 中选择 observedid,ST_Distance(p1.shape_utm,p2.shape_utm) 计算从一个点到另一个点的行进距离

（当然还有更多，但这是其中的距离部分）我已将其定义为视图，以便我可以轻松地执行 select * from motion_view whereobservedid=42

问题1：是否可以制作视图以便我也可以定义时间间隔？

例如 select * form motion_view whereobservedid=42 and interval='15 minutes' ？

问题2：SQL/postgis中是否可以计算一段时间内的总行驶距离？我每 5 秒有一个 gpspoint，并且想计算每个 gps 点后 1 小时的行驶距离。我可以使用与上述相同的方法计算每个点的行进距离，然后我可以使用 sum() 函数，但是如何？

表定义：id integer、
gpsstatus character(2)、
datetime timestamp without time zone、
lat numeric(9,6)、
lon numeric(9,6)、
alt numeric(9,4)、
time integer、
datafileid integer、
shape geometry ,
speed 双精度,
dist 双精度,
shape_utm 几何,
lokalitet character(128),
covid integer

Id：主键 datetime、lokalitet、cowid、gpsstatus 上有索引，shape 和 shape_utm 上有 gist-index。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T09:59:24.840

问题一：

```
CREATE VIEW movement_view AS
SELECT observedid, ST_Distance(p1.shape_utm,p2.shape_utm) as distance, p1.datetime as datetime1, p2.datetime as datetime2
FROM gpspoint p1, gpspoint p2;

SELECT * from movement_view where observedid = 42 and datetime2 = datetime1 + interval '15 minutes' 
```

问题2：

从您的点创建一条线并计算长度：

```
SELECT hours,  st_Length(ST_MakeLine(t.shape_utm)) as distance FROM
    (SELECT date_trunc('hour', datetime::timestamp) as hours, shape_utm FROM gpspoint order by datetime) as t
GROUP by hours 
```

# android - 以编程方式为视图创建资源 ID

> ID：10606732
> 
> 赞同：5
> 
> 时间：2012-05-15T18:31:35.757
> 
> 标签：android, view, android-resources

`View`包含一个方法`setId(int)`。我的问题是，如何以编程方式为对象提供一个不与任何资源 ID 重叠的 ID `R`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-02-25T14:03:27.587

根据[文档](https://developer.android.com/reference/android/view/View.html#generateViewId())，`View.generateViewId()`在 API 级别 17 中添加会生成一个适合在`setId(int)`. 此值不会与 aapt for 在构建时生成的 ID 值冲突`R.id`。

我进行了实验`View.generateViewId()`以了解它的行为方式。这是我的发现。

*   生成的 ID 将从 1 开始，每次调用时都会递增 (1, 2 , 3...)
*   `generateViewId()` *将保留返回的最后一个 ID*，并将在整个应用程序生命周期中从那里继续。例如，如果设备轮换前的最后一个 ID 为 4，则轮换后的下一个 ID 将为 5。

`onCreate()`重要的是要注意，例如，如果您在应用程序的方法中通过`generateViewId()`每次调用在运行时设置视图，则在您的设备旋转后，默认情况下`onCreate()`会再次调用，并且您的*视图将收到与旋转之前不同的 ID*。

Android 具有自动恢复视图状态的功能 - 例如，您输入到 EditText 视图中的文本，CheckBox 的选中状态 - 在设备旋转后，但*它仅在视图具有持久 ID 时才有效*。所以在上面的例子中，这种状态恢复将不起作用——你的 EditText 视图将丢失输入，你必须再次输入你需要输入的任何内容——因为每次生成视图时都会收到不同的 ID。要解决此问题，您需要在活动生命周期中维护 ID。

我发现 Android 为 XML 中定义的对象分配了数十亿的 ID。这是从我的应用程序中获取的真实 ID，只有几个预定义的 ID：2131427423。因此*，*您可以自行决定使用低 ID 而无需调用`generateViewId()`. 在我的简单应用程序中，我通过分配从 1 开始的 ID 来模仿它，然后增加 1，并且它起作用了。这是一个从我的应用程序中提取的示例：

```
public class MainActivity extends AppCompatActivity {
    // since our lastAllocatedViewId will reset on device rotation
    // regenerated views will receive the same ID
    private int lastAllocatedViewId = 0;

    private ArrayList<QuizQuestions> quizQuestions;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // read quizQuestions from xml at runtime;
        quizQuestions = parseQuizQuestionsXml();

        // we will dynamically add quiz question views to this view
        // depending on how many quizQuestions are in the XML config
        LinearLayout container = (LinearLayout) findViewById(R.id.quiz_questions_container);

        // generate a view for each quiz question
        for (int i = 0; i < quizQuestions.size(); i++) {
            LinearLayout quizQuestionView = (LinearLayout) inflater.inflate(R.layout.quiz_question_template, parent, false);

            quizQuestionView.setId(lastAllocatedViewId++);

            (...) // do some work on our newly generated view

            // then add it to the quiz questions container
            container.addView(quizQuestionView);
        }
    }
} 
```

# ruby - 递归数组有什么用？

> ID：10606734
> 
> 赞同：30
> 
> 时间：2012-05-15T18:31:44.330
> 
> 标签：ruby, arrays, recursion

Ruby 支持递归数组（即自包含数组）：

```
a = []
# => [] 
a << a
# => [[...]] 
a.first == a
# => true 
```

这本质上很酷，但是你能用它做什么工作呢？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-15T20:53:32.977

具有未区分边的有[向图](http://en.wikipedia.org/wiki/Directed_graph)可以将每个顶点简单地表示为从该顶点可到达的顶点的数组。如果图形有循环，您将拥有一个“递归数组”，特别是如果一条边可以返回同一个顶点。

例如，此图：
![有向循环图](../Images/823176820460be6e52c69b5a2c91e26d.png)
...可以在代码中表示为：

```
nodes = { a:[], b:[], c:[], d:[] }
nodes[:a] << nodes[:a]
nodes[:a] << nodes[:b]
nodes[:b] << nodes[:a]
nodes[:b] << nodes[:c]
p nodes
#=> {:a=>[[[...], []], [...]], :b=>[[[...], [...]], []], :c=>[], :d=>[]} 
```

通常每个顶点的表示会更“健壮”（例如，具有名称和传出边数组属性的类实例），但并非不可能想象您想要一个非常轻量级的数据表示的情况（对于非常大图），因此需要使用像这样的最小表示。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-15T21:56:17.880

> Ruby 支持递归数组

对我来说，问题是它为什么*不*支持它？

数组只是引用的集合。它是否应该检查每个元素并在其中一个引用集合本身时抛出错误，所以防止递归或将其用于像 Phrogz 示例这样的图形。

所以我不认为这是一个特性，但如果是这样的话，我知道的大多数语言都有它，甚至 Java ..只需使用 Object 作为 Array 元素。

# html - 如何让 div 溢出而不在 IE 的电子邮件中下推其他内容？

> ID：10606746
> 
> 赞同：3
> 
> 时间：2012-05-15T18:32:30.390
> 
> 标签：html, internet-explorer, css

我试图在电子邮件中放置一个 div，以便它溢出后来放置的内联块 div（而不是将它们向下推），因为有问题的 div 是 display:inline。它似乎在 Chrome 中工作，但我无法让它在 IE 中正确呈现，它受到稍后放置的内联块 div 的限制。

这是我正在谈论的一个示例（有问题的 div 具有蓝色背景）：

```
<html>
<head>
<style type="text/css">
* {
    margin: 0;
    padding: 0;
    border: 0;
}
div {
    *display: inline!important;
    _height: 1px;
}
</style>
</head>
<body style="width: 300px; height: 300px;">
  <div style="margin: 0; padding: 0; font-size: 1px; display: block!important; width: 300px; height: 300px; background-color: green;">
    <div style="margin: 0; padding: 0; font-size: 1px; display: inline-block; width: 300px; height: 10px; background-color: gray;"></div>
    <div style="margin: 0; padding: 0; font-size: 1px; display: inline-block; width: 10px; height: 280px; background-color: gray;"></div>
    <div style="margin: 0; padding: 0; display: inline-block; width: 280px; height: 280px; background-color: red; line-height: 23px; font-family: Helvetica, Arial, FreeSans, san0serif; color: #333;">
      <div style="margin: 0; padding: 0; margin-top: 0; width: 150px; height: 320px; background-color: blue; display: block;"></div>
    </div>
    <div style="margin: 0; padding: 0; display: inline-block; width: 10px; height: 280px; background-color: gray;"></div>
    <div style="margin: 0; padding: 0; display: inline-block; width: 300px; height: 10px; background-color: gray;"></div>
  </div>
</body>
</html> 
```

这就是它在 Chrome 中的呈现方式（以及我希望它呈现的方式）： ![正确的](../Images/1b67e5886810884d8e176851d2333732.png)

这是它在 IE(8) 中的呈现方式：

![不正确](../Images/9c8cad6b6b1329b4de1884688ad1bbf6.png)

如何让 IE 像在 Chrome 中一样呈现这个 div？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:37:46.923

大多数电子邮件客户端不会 100% 始终如一地听 css。这在某种程度上也适用于 Web 客户端电子邮件视图。您需要将 2 个 div 从容器对象中分离出来。IE：两个单独的包含，所以当左边的一个溢出时 - 右边的 div 没有。

编辑：这是一个很好的兼容性地图： http: [//www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:38:18.283

你试过浮动红色和蓝色的div吗？这会将它们从文档流中删除，如果相对定位和 z 索引正确，则应该按您想要的方式显示。

# javascript - jquery menu-show onclick 在左侧

> ID：10606751
> 
> 赞同：0
> 
> 时间：2012-05-15T18:32:56.623
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 制作 vk.com 风格的右上角菜单。当我们单击设置符号时，它会显示几个链接，其代码如下所示。我正在尝试使用jquery，所以我尝试使用slideup和slidedown，但我想要与vk.com完全一样，点击后它显示在左侧，鼠标移除后隐藏

```
<tr>
  <td class="top_home_link_td">
    <div id="top_logo_down" class=""></div>
    <a onmouseup="removeClass('top_logo_down','tld_d');" onclick="return nav.go(this, event);" onmousedown="addClass('top_logo_down','tld_d');" href="/feed" class="top_home_link"></a>
  </td>
  <td class="top_back_link_td"></td>
  <td style=""><nobr>
    <a onmouseover="gSearch.preload();" onclick="return nav.go(this, event, {search: true, noframe: true});" onmousedown="event.cancelBubble = true;" ontouchstart="event.cancelBubble = true;" href="/search" id="top_search" class="top_nav_link">search</a>
  </nobr></td>
  <td style="" id="support_link_td"><nobr>
    <a onclick="return nav.go(this, event);" onmousedown="event.cancelBubble = true;" ontouchstart="event.cancelBubble = true;" href="/support?act=new" id="top_support_link" class="top_nav_link">help</a>
  </nobr></td>
  <td style="" id="invite_link_td"><nobr>
    <a onclick="return nav.go(this, event);" onmousedown="event.cancelBubble = true;" ontouchstart="event.cancelBubble = true;" href="/invite" id="top_invite_link" class="top_nav_link">invite</a>
  </nobr></td>
  <td id="logout_link_td"><nobr>
    <a onclick="if (checkEvent(event) === false) { location.href = this.href; return cancelEvent(event); }" onmousedown="event.cancelBubble = true;" ontouchstart="event.cancelBubble = true;" href="https://login.vk.com/?act=logout&amp;hash=906cc70a366d6dd462&amp;from_host=vk.com&amp;from_protocol=http" id="logout_link" class="top_nav_link">log out</a>
  </nobr></td>
  <td><nobr>
    <a onmousedown="event.cancelBubble = true; TopSearch.toggleSettings()" ontouchstart="event.cancelBubble = true;" onmouseout="TopSearch.settingsOut()" onmouseover="TopSearch.settingsOver()" class="ts_settings active" id="ts_settings" style="opacity: 1;"></a>
  </nobr></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:10:36.993

查看 .on('[点击](http://api.jquery.com/click/)',function(){}); 和 .on(' [mouseout](http://api.jquery.com/mouseout/) ',function(){}); jQuery 函数。

# php - PHP：命中计数。错误：mysql_num_rows() 期望参数 1 是资源

> ID：10606752
> 
> 赞同：0
> 
> 时间：2012-05-15T18:32:59.637
> 
> 标签：php, mysql, ip, counter, mysql-num-rows

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

嘿，我正在制作一个独特的计数器。

```
<?php  
$ip_add = $_SERVER['REMOTE_ADDR'];

function ip_exists($ip){
  global $ip_add;
  $query = "SELECT 'ip_count' from 'count_ip' where 'ip_count' = '$ip_add'";
  $query_run = mysql_query($query);
  $query_num_rows = mysql_num_rows($query_run);

  if($query_num_rows == 0){
    return false;
  }
  else if($query_num_rows >= 1){
    return true;
  }
}

if(ip_exists($ip_add)) {
  echo " exists";
} else {
  echo "doesnt";
}
... 
```

**我收到此错误：**

```
Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in 
C:\wamp\www\php\Hit Counter\index.php on line 18 
```

**错误在这里：**

```
$query_num_rows = mysql_num_rows($query_run); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:39:44.567

首先，我们在错误消息中看到`boolean given`- 为 SELECT 查询返回布尔值的唯一原因[`mysql_query()`](http://php.net/manual/en/function.mysql-query.php)是查询失败 - 因为您的 SQL 中有语法错误，所以它会这样做。您需要将一些单引号更改为反引号：

```
$query = "
  SELECT `ip_count`
  FROM `count_ip`
  WHERE `ip_count` = '$ip_add'
"; 
```

对象名称（列、表等）应该用反引号 ` 引用，任何用单引号 ' 包围的东西都被视为文字字符串。

您需要检查查询是否失败：

```
$query_run = mysql_query($query);
if (!$query_run) {
  // Handle error here
}
$query_num_rows = mysql_num_rows($query_run); 
```

一些额外的评论：

*   尝试更明智地缩进您的代码，从长远来看，这将使调试变得更加容易
*   [避免使用全局变量，它们是非常糟糕的做法，尤其是当您使用已经超全局](http://php.net/manual/en/language.variables.superglobals.php)的数据填充它们时
*   [确保在数据库查询中使用之前从外部源中转义任何数据](http://bobby-tables.com/)
*   不要使用`mysql_*`函数，使用[PDO](http://php.net/manual/en/book.pdo.php)或[MySQLi](http://php.net/manual/en/book.mysqli.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:41:50.847

测试你`query`以确保它被正确执行：

```
<?php
...
$query_run = mysql_query($query);
if (!$query_run) {
  die('Invalid query: ' . mysql_error());
} else {
  // continue your code
}
?> 
```

像这样，如果查询失败，你可以得到一些反馈来分析！

**请参阅：** [mysql_query 示例](http://php.net/manual/en/function.mysql-query.php)，#1 无效查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:41:20.910

`mysql_query()`返回一个布尔值，查询是否成功。如果要传入正确的参数，则需要将连接处理程序分配给一个变量，然后将其传入。

```
$conn = mysql_connect()...
...
$query_num_rows = mysql_num_rows($conn); 
```

**虽然你不应该再使用`mysql_*`函数了！看我对你问题的评论！**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:43:12.187

实际上查询有语法错误导致 $query_run() 返回错误而不是实际输出。在查询中使用引号时必须小心。像这样替换查询：

```
$query = "SELECT ip_count from count_ip where ip_count='$ip_add'"; 
```

如果 $ip_add 不是字符串，也请避免使用单引号。如果您正在编写字段名称或表名称，请避免使用引号。仅在编写字符串的地方才需要引号。

# ruby-on-rails - rails 3 与回形针和多个模型的多态关联

> ID：10606753
> 
> 赞同：7
> 
> 时间：2012-05-15T18:33:00.883
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, polymorphic-associations

我想与回形针建立多态关联，并允许我的用户拥有一个头像和多个图像。

**附件**型号：

```
class Attachment < ActiveRecord::Base
belongs_to :attachable, :polymorphic => true
end

class Avatar < Attachment
has_attached_file :image, :styles => { :thumb => "150x150>", :view => "260x180>" },
end

class Image < Attachment
has_attached_file :image, :styles => { :thumb => "150x150>", :view => "260x180>" },
end 
```

用户模型：

```
has_one :avatar, :as => :attachable, :class_name => 'Attachment', :conditions => {:type => 'avatar'}
accepts_nested_attributes_for :avatar 
```

用户控制器：

```
def edit
   @user.build_avatar
end 
```

用户查看表单：

```
<%= form_for @user, :html => { :multipart => true } do |f| %>

  <%= f.fields_for :avatar do |asset| %>
      <% if asset.object.new_record? %>
          <%= asset.file_field :image %>
      <% end %>
  <% end %> 
```

当我尝试保存更改时，我收到错误 => 未知属性：头像

如果我在 has_one 关联中删除 :class_name => 'attachment' 我得到错误 => 未初始化的常量 User::Avatar

我还需要将头像附加到博客文章，所以我需要关联是多态的（或者至少我认为是这样）

我很难过，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T18:24:29.577

我确实有一个项目正在成功使用回形针和多态关联。让我告诉你我有什么，也许你可以将它应用到你的项目中：

```
class Song < ActiveRecord::Base
  ...
  has_one :artwork, :as => :artable, :dependent => :destroy
  accepts_nested_attributes_for :artwork
  ...
end

class Album < ActiveRecord::Base
  ...
  has_one :artwork, :as => :artable, :dependent => :destroy
  accepts_nested_attributes_for :artwork
  ...
end

class Artwork < ActiveRecord::Base
  belongs_to :artable, :polymorphic => true
  attr_accessible :artwork_content_type, :artwork_file_name, :artwork_file_size, :artwork

  # Paperclip
  has_attached_file :artwork,
    :styles => {
      :small => "100",
      :full => "400"
    }

  validates_attachment_content_type :artwork, :content_type => 'image/jpeg'
end 
```

歌曲表格和专辑表格包括以下部分：

```
<div class="field">
<%= f.fields_for :artwork do |artwork_fields| %>
  <%= artwork_fields.label :artwork %><br />
  <%= artwork_fields.file_field :artwork %>
<% end %> 
```

不要忘记在表单中包含 :html => { :multipart => true }

艺术品控制器.rb

```
class ArtworksController < ApplicationController
  def create
    @artwork = Artwork.new(params[:artwork])

    if @artwork.save
        redirect_to @artwork.artable, notice: 'Artwork was successfully created.'
    else
        redirect_to @artwork.artable, notice: 'An error ocurred.'
    end
  end
end 
```

最后，摘自 song_controller.rb：

```
def new
    @song = Song.new
    @song.build_artwork
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:17:51.280

我不确定你真的需要多态。这种使用 has_many :through 的方法怎么样？通俗的说，用户有一个头像，里面有多张图片，通过这个关联，你可以调用 User.images 来获取与头像关联的图片集合。

[http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

```
class User < ActiveRecord::Base
  has_one :avatar
  has_many :images, :through => :avatar
end

class Avatar < ActiveRecord::Base
  belongs_to :user
  has_many :images
end

class Image < ActiveRecord::Base
  belongs_to :avatar
  has_attached_file :image, :styles => { :thumb => "150x150>", :view => "260x180>" },
end 
```

说了这么多，我想知道为什么无论如何你都需要经历这一切。为什么不只是做

```
class User < ActiveRecord::Base
  has_many :avatars
end 
```

这将为您提供任意数量的图像（化身）。

# eclipse - 在eclipse中如何将现有的maven项目添加为web项目

> ID：10606756
> 
> 赞同：0
> 
> 时间：2012-05-15T18:33:29.307
> 
> 标签：eclipse, maven, spring-mvc

我正在尝试将 maven 项目作为动态 Web 项目运行。

我的 Eclipse 中有我的 Maven 项目。我想像这样在 localhost:8080/abc 上运行项目。

请建议我设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:46:31.053

好吧，我不知道这是否是你要找的，但如果你只是想轻松运行你的 Maven Web 项目，你可以使用[jetty-plugin](http://mvnrepository.com/artifact/org.mortbay.jetty/jetty-maven-plugin/)来运行它。

配置将是：

```
<plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty-maven-plugin</artifactId>
    <version>8.1.3.v20120416</version>
    <configuration>
        <webAppConfig>
            <contextPath>/abc</contextPath>
        </webAppConfig>
    </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T06:33:49.610

首先，您的 Maven 项目应该是一个 Web 项目（例如`<packaging>`应该是`war`）。

你应该有`Eclipse IDE for Java EE Developers`。

你应该在你的 Eclipse 中配置一个服务器——比如 tomcat、jetty 等。

安装[m2e](http://www.eclipse.org/m2e/) Eclipse 插件以及[m2e-wtp](https://issues.sonatype.org/browse/MECLIPSEWTP)支持插件。

将 maven 项目导入 Eclipse。构建完成后，您应该能够选择“作为服务器运行...”选项并指定您配置的服务器。

# c# - 循环遍历变量的所有属性。包括复杂类型

> ID：10606757
> 
> 赞同：0
> 
> 时间：2012-05-15T18:33:29.780
> 
> 标签：c#, asp.net, .net-4.0

我有以下程序循环遍历我的变量的所有属性：

```
class Program
{
    static void Main(string[] args)
    {
        var person = new Person {Age = 30, Name = "Tony Montana", Mf = new Gender {Male = true,Female = false}};
        var type = typeof(Person);
        var properties = type.GetProperties();

        foreach (PropertyInfo property in properties)
        {
            Console.WriteLine("{0} = {1} : Value= {2}", property.Name, property.PropertyType, property.GetValue(person, null));
        }

        Console.Read();
    }
}

public class Person
{
    public int Age { get; set; }
    public string Name { get; set; }
    public Gender Mf;
}

 public class Gender
  {
       public bool Male;
       public bool Female;
   } 
```

当我运行它时，我得到以下输出：

```
"Age = System.Int32 : Value= 30"
"Name = System.String : Value= Tony Montana" 
```

我没有看到我的复杂类型 person.Mf。我如何遍历我的对象 person 并获取 person.Mf 的类型和 person.Mf 的属性（即 person.Mf.Male 等）？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:36:10.747

Mf 是一个字段，而不是一个属性。将其更改为：

```
public Gender Mf { get; set; } 
```

或者，或者，使用反射来遍历所有公共字段（但我认为你最好将它作为一个属性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:37:18.247

您看不到它，因为它不是财产。

为了解决这个问题，

*   或将其定义为属性

*   或者也使用反射恢复字段

    `FieldInfo[] fields = type.GetFields()`

# java - 基于文件的进程间通信的 EOFException

> ID：10606758
> 
> 赞同：0
> 
> 时间：2012-05-15T18:33:35.410
> 
> 标签：java, linux, file, eofexception

Process-A 使用 FileOutputStream 将字节写入数据文件。Process-B 使用 DataInputStream 从同一个数据文件中读取数据。

数据文件位于不支持 FileLocks 的 NFS 挂载上，因此使用以下方法：

Process-A 创建一个锁定文件来通知 Process-B 它可以开始读取数据文件。它在刷新并关闭 FileOutputStream 后创建锁定文件。Process-B 检查锁定文件是否存在，然后开始读取数据文件。但是，有时它会遇到 EOFException。

```
java.io.EOFException
        at java.io.DataInputStream.readFully(DataInputStream.java:180)
        at java.io.DataInputStream.readUTF(DataInputStream.java:592)
        at java.io.DataInputStream.readUTF(DataInputStream.java:547)

java.io.EOFException
        at java.io.DataInputStream.readInt(DataInputStream.java:375)
        at java.io.DataInputStream.readFloat(DataInputStream.java:429) 
```

有人可以解释一下，出了什么问题？另外，鉴于我不能使用 FileLock api，还有其他替代方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:30:33.423

什么都不会出错。您已到达流的末尾。对等方已经关闭了他的连接端。结束你的结局，忘记它。

# sql - SQL 查询性能下降取决于搜索值的顺序

> ID：10606760
> 
> 赞同：5
> 
> 时间：2012-05-15T18:33:42.007
> 
> 标签：sql, sql-server, query-optimization, self-join

我有一个双重自联接查询，其中在交换搜索值时性能会严重下降。

```
-- 500,000 i/o & 500ms execution
select
  fooA.ID
  , fooB.ID
from
  foo AS fooA
  INNER JOIN bar AS barA ON fooA.barID = barA.barID
  INNER JOIN foo AS fooB ON fooA.fooID = fooB.fooID -- self join
  INNER JOIN bar AS barB ON fooB.barID = barB.barID
where
  barA.value = 'xyz'
  AND barB.value = '60'

-- 5,000 i/o & 5ms execution
select
  fooA.ID
  , fooB.ID
from
  foo AS fooA
  INNER JOIN bar AS barA ON fooA.barID = barA.barID
  INNER JOIN foo AS fooB ON fooA.fooID = fooB.fooID -- self join
  INNER JOIN bar AS barB ON fooB.barID = barB.barID
where
  barA.value = '60'
  AND barB.value = 'xyz' 
```

*   值“xyz”在“bar”表中列出了 150,000 次。
*   值“60”在“bar”表中列出了 500 次。
*   查询计划是相同的，只是最里面的循环返回 150,000 行或 500 行，具体取决于首先列出的搜索值。
*   搜索对非聚集索引执行搜索。
*   使用 FULLSCAN 更新了两个表的统计信息。

为什么 SQL 查询优化器不能正确识别在这两种情况下查询计划的最内连接应该是行数最少的连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:46:34.150

SQL Server 不会在每次执行查询时重新编译它。它只执行一次，并针对第一次看到的确切值进行了优化。我猜你缓存了一个不幸的计划。

尝试`OPTION (RECOMPILE)`在最后添加。

# matlab - fmincon 收敛时间

> ID：10606762
> 
> 赞同：1
> 
> 时间：2012-05-15T18:33:51.730
> 
> 标签：matlab

我今天尝试了 fmincon，发现它收敛得非常快。它给出的价值也很完美。我不确定如何。一开始，它迈出了一大步。我在 1 和 1 处初始化了两个参数。突然它跳到将值更改为 51 和 130。这是一大步。我不确定这是否是一件好事。但我想知道为什么 fmincon 收敛得这么快并找到了价值。任何见解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:58:38.913

MALTAB 的`fmincon`函数实现了几种算法。因此收敛速度将取决于目标函数和约束类型。MATLAB 将自动选择最佳算法。在大多数情况下，它将是内点算法。这些算法家族以其在真正大问题上的快速收敛而闻名。大多数内点算法需要大约 20-60 步才能收敛。`fmincon`最重要的是，我的回答是肯定的——如果收敛得非常快，这绝对是正常的。如果您需要更多详细信息设置`Display`选项来`'iter-detailed'`使用`optimset`，您将看到每次迭代的详细信息。

# python - cd 到另一个目录执行脚本

> ID：10606766
> 
> 赞同：0
> 
> 时间：2012-05-15T18:34:10.150
> 
> 标签：python

我需要 cd 到一个特定的目录来运行一个 jar 包。这就是我目前正在尝试做的事情，尽管没有成功：

```
subprocess.call(['cd','sales'])
subprocess.call(shlex.split("""java Autoingestion %s %s %s Sales Daily Details %s"""%                                                                         
            (self.username, self.password, self.vendor_number, self.date))) 
```

我将如何正确 cd 进入销售文件夹并执行此脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:42:12.283

你应该做

```
subprocess.call(["java","Autoingestion",self.username, self.password, self.vendor_number, "Sales","Daily","Details",self.date, cwd="sales") 
```

请注意，您不应该执行 shlex.split，因为它不安全

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:37:38.203

一种方法是[`os.chdir()`](http://docs.python.org/library/os.html#os-file-dir)在创建 Java 子进程之前使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T18:39:23.413

[`os.chdir()`](http://docs.python.org/library/os.html#os.chdir)在第二次通话之前使用`Popen`（并摆脱第一次`Popen`通话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:25:09.593

使用[os.chdir()](http://www.tutorialspoint.com/python/os_chdir.htm)将当前目录更改为指定目录。

我建议你使用[subprocess.Popen()](http://docs.python.org/library/subprocess.html#subprocess.Popen)而不是 subprocess.call()。如果您希望在运行 java 代码之前自己设置环境，例如设置 JAVA_PATH 等，通过设置 Popen 的 env 参数很容易。

```
from subprocess import Popen
from os import chdir
from os.path import exists

sales_dir = "/home/ubuntu/sales"

# Sanity check for the directory
if exists(sales_dir):
    chdir(sales_dir)

new_proces = Popen("java Autoingestion %s %s %s Sales Daily Details %s" % 
             (self.username, self.password, self.vendor_number, self.date)) 
```

# xaml - 是否可以仅覆盖本机控件的一个 ViewState？

> ID：10606767
> 
> 赞同：0
> 
> 时间：2012-05-15T18:34:16.750
> 
> 标签：xaml, windows-8, winrt-xaml

我不想覆盖所有内容，但是需要在本机 XAML 控件中更改其中一个视图状态以适应我的应用程序的需要。是否可以只覆盖一个或者它们都需要被覆盖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:57:15.357

您必须覆盖样式/模板才能完成此操作。

# javadoc - javadoc：引用类头中的概念？

> ID：10606769
> 
> 赞同：0
> 
> 时间：2012-05-15T18:34:30.373
> 
> 标签：javadoc

我有一个接口`IFoo`（不是真名），我正在尝试为其编写 Javadoc——这是一个通过 JSR223 向 Rhino/Jython 脚本公开的包，而这个接口是唯一公开的一个。

它有许多相当简单的方法。其中许多是豆类，但有些不是。

```
public void setBar(double x);
public double getBar();
public void setBigQuux(int n);
public int getBigQuux();
public void setLittleQuux(int n);
public int getLittleQuux();
public void clearQuuxes(); 
```

我的问题是，许多这些方法形成了自然群体。一种方法，看起来像是 Sun 选择的一种（我看过一些 Swing 类），是为每个组选择一种方法，并将大部分相关信息放在其 javadoc 中，然后链接其他方法带`@see`标签。记录密切相关的方法组的另一种方法（对我来说似乎是一种更好的方法）是将一个部分放入类 Javadoc 标头中，然后将简要摘要放入方法标头中，但参考标头，但是我不知道该怎么做：

```
/**
 * Foo
 * <p>
 * Quuxes: these are magic knobs that control quux content. A foo has a big quux
 * and a little quux. (etc) (I want to link here from the quux-related methods)
 */
interface IFoo    
{
  /**
   * Sets the big quux
   * @param n new value
   * @see ???? how to refer to the quux section of the class header?
   */
  public void setBigQuux(int n);
  /**
   * Gets the big quux
   * @return big quux 
   * @see ???? how to refer to the quux section of the class header?
   */
  public int getBigQuux();
  /* etc */
} 
```

任何人都可以帮助我，或解释为什么这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:16:50.847

啊哈，让它工作，在标题和行中使用`<a name="abcd">`/`<a href="#abcd">`标记对`@see`。此语法的参考[位于`@see`](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html#see).

```
/**
 * Foo
 * <p>
 * <a name="quuxes">Quuxes</a>:
 * these are magic knobs that control quux content. A foo has a big quux
 * and a little quux. (etc) (I want to link here from the quux-related methods)
 */
interface IFoo    
{
  /**
   * Sets the big quux
   * @param n new value
   * @see <a href="#quuxes">quuxes</a>
   * @see #getBigQuux
   */
  public void setBigQuux(int n);
  /**
   * Gets the big quux
   * @return big quux 
   * @see <a href="#quuxes">quuxes</a>
   * @see #setBigQuux
   */
  public int getBigQuux();
  /* etc */
} 
```

# jquery - jquery css 背景图像仅适用于 firefox

> ID：10606771
> 
> 赞同：0
> 
> 时间：2012-05-15T18:34:35.330
> 
> 标签：jquery, css, background-image, setinterval

有人能指出为什么这个脚本只能在 Firefox 上运行，而不能在任何其他浏览器上运行吗？Chrome 的控制台没有显示任何错误。Firefox 的 ofc 也是如此。有什么建议么？提前致谢！

```
jQuery.noConflict();
jQuery(document).ready(function(){

function wrapr(){
    var min=1;
    var max=5;
    var bd = jQuery('body.home');

    function bg(){

        if(min < max){

            bd.css('background-image','url(http://sitename/templates/rt_gantry/images/body/'+min+'.jpg');
            min++;
        }
        else if(min = max){
        min=1;
        }
    }
    setInterval(bg,9000);
}
wrapr();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:37:56.297

您似乎缺少一个“）”：

```
bd.css('background-image','url(http://sitename/templates/rt_gantry/images/body/'+min+'.jpg)'); 
```

**另外**：为了提高可读性，提取函数定义可能是值得的：

```
 <script>
    jQuery.noConflict();

    function wrapr(){
        var min = 1;
        var max = 5;
        var bd = jQuery('body.home');

        setInterval(function(){
          if(min < max){
            bd.css('background-image','url(http://sitename/templates/rt_gantry/images/body/'+min+'.jpg');
            min++;
          } else {
            current = min;
          }
        }, 1000);
    }

    jQuery(document).ready(function(){
      wrapr();
    });
  </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:39:28.947

这部分不好：

```
else if(min = max){
   min=1;
} 
```

使用单个等号导致将最大值分配给最小值。您必须使用两个来检查是否相等。

```
else if(min == max){
    min=1;
} 
```

# objective-c - UITableView 编辑模式删除按钮 padding-right

> ID：10606778
> 
> 赞同：0
> 
> 时间：2012-05-15T18:35:04.283
> 
> 标签：objective-c, ios, uitableview, editmode

我想在`UITableView` **编辑模式删除按钮**和单元格**左侧**之间留出一些空间（见下面的截图）。
任何想法？[（来源：][[mixdesign.kz](http://mixdesign.kz/mix/editmode.png)][）]

[![](../Images/cd888074f8b432b117f04cd4c3e4ed6d.png)](https://i.stack.imgur.com/EifDI.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T13:40:31.693

设置 indentationLevel/indentationWidth 对我不起作用。

对我有用的是继承 UITableViewCell 和自定义`-layoutSubviews`：

```
#define LEFT_EDITING_MARGIN 42

- (void)layoutSubviews
{
    [super layoutSubviews];

    if (self.editing && self.contentView.frame.origin.x != 0) {
        CGRect frame = self.contentView.frame;
        CGFloat diff = LEFT_EDITING_MARGIN - frame.origin.x;
        frame.origin.x = LEFT_EDITING_MARGIN;
        frame.size.width -= diff;
        self.contentView.frame = frame;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:59:19.767

你可以实现

```
- (void)willTransitionToState:(UITableViewCellStateMask)state 
```

在您的 UITableViewCell 子类中稍微移动您的子视图以获得更大的填充。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:00:59.870

@property(nonatomic) NSInteger indentationLevel 是一个在[UITableViewCell 文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewCell/indentationLevel)中定义的属性。使用它，您可以设置 tableview 单元格的缩进级别。从您的设置此属性`- (void)willTransitionToState:(UITableViewCellStateMask)state`

# ios - 无法从命令行运行 UIAutomationTest

> ID：10606785
> 
> 赞同：8
> 
> 时间：2012-05-15T18:35:24.440
> 
> 标签：ios, continuous-integration, ui-automation

我有一个 iOS 应用程序，我想把它放在持续集成中。我用来执行此操作的策略是尝试从命令行运行测试。

我正在尝试使用以下脚本来做到这一点：

```
TRACETEMPLATE="/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Instruments/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate"
instruments   -t $TRACETEMPLATE build/Release-iphonesimulator/MyApp.app -e UIACSCRIPT "UnitTests/SomeTest.js" 
```

SomeTest.js 是一个简单的 javascript 文件，我可以在 Xcode 中的 Instrumentation 中运行它并且它可以工作。我使用以下方法构建我的应用程序：

```
xcodebuild -alltargets -sdk iphonesimulator5.1 
```

这会生成 MyApp.app。我可以在模拟器中从 Xcode 运行应用程序，但是，当我尝试通过仪器运行时，我得到一个框，说存在未知错误，并在命令行中打印：

```
2012-05-15 15:32:59.928 instruments[17548:1d03] Recording cancelled : At least one target failed to launch; aborting run
Instruments Trace Error : Failed to start trace. 
```

任何人都可以就可能发生的事情给我任何帮助/建议，我该如何解决这个问题？

还有，它总是打开 iPad 模拟器？我可以让它打开我想要的任何模拟器吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T22:03:14.217

我遇到了同样的错误，几乎把头发拉出来试图解决它。错误消息完全没有帮助。

对我来说最终成为问题的是我指向的 .app 文件。一旦我找到了深埋在 5.1 Simulator 文件夹中的“正确”的 .app 文件，我终于能够使用 Xcode 4.3 从命令行运行 UIAutomation 测试。

对我有用的 .app 路径：

```
~/Library/Application\ Support/iPhone\ Simulator/5.1/Applications/{string-of-numbers-and-letters}/MyApp.app/ 
```

这是我使用 Xcode 4.3 从命令行运行 UIAutomation 测试的完整命令：

```
instruments -t /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Instruments/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate ~/Library/Application\ Support/iPhone\ Simulator/5.1/Applications/{string-of-numbers-and-letters}/MyApp.app/ -e UIASCRIPT /Path/To/TestFile.js 
```

希望这对其他人有所帮助，因为那里的文档非常缺乏。

**更新**

请注意，从 Xcode 4.5.2 开始，自动化模板位置已与我原来的答案不同：

```
/Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-05T16:43:28.877

从 Xcode 4.5.2 开始，Automation.tracetemplate 的正确位置是`/Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T23:56:28.510

UIAutomation 的命令行调用路径在过去几年中略有变化。我已经编写了一些可以协同工作的 bash shell 脚本，它们可以以适用于 Xcode 4.4.1 的方式启动您的 UIAutomation 测试文件。

看到这个要点：[https ://gist.github.com/3605692#comments](https://gist.github.com/3605692#comments)

简而言之，关键命令最终是：

`instruments -t $INSTRUMENTS_TEMPLATE $APP_PATH -e UIASCRIPT $SCRIPT_PATH -e UIARESULTSPATH $RESULTS_PATH`

我的脚本显示了所需的变量替换。另一个好处是 iOS 模拟器应用程序经常更改 GUID 作为其路径的一部分。我的脚本会找到它们，因此您不必在构建/脚本/命令行调用中硬编码临时 GUID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T15:03:59.300

抱歉，我的英语很不好。作为从 Teamtsity 运行此脚本的最简单方法？每个组件 - 数字和字母都不同。不是最简单的方法：

1.  组装前清洁模拟器
2.  找到包含程序的文件夹，它包含这些数字和字母，写在变量中。
3.  这个变量，比如写脚本。

也许有一种更容易从这些数字中获取的方法？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-10T07:36:05.373

构建配置应该是调试而不是发布。这就是我的案例中出现错误的原因。您可以在“编辑方案”中更改构建配置并选择配置文件选项卡。验证构建选项卡是否也处于调试模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-13T17:25:17.933

我执行了`ps`命令来查看哪些进程正在运行。我发现仪器仍在运行。然后我做了`killall instruments`，这杀死了仪器进程。然后我做了我的仪器命令，之后它工作得很好。

# php - FosUserBundle 与 FosRestBundle 的集成

> ID：10606792
> 
> 赞同：6
> 
> 时间：2012-05-15T18:35:44.943
> 
> 标签：php, symfony, fosuserbundle

有没有人有一个例子或任何想法如何将 FOSRestBundle 与 FOSUserBundle 一起实现。我已经使用 Symfony 2 和 FOSUserBundle 开发了一个 Web 应用程序，但我想为 api 层添加 FOSRestBundle。我希望能够将用户名和密码传递给它，并从 FOSUserBundle 接收某种类型的令牌，该令牌代表已登录的用户，然后我可以在其他 api 调用之间来回传递。有谁知道这样做的好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T08:33:40.973

`FOSUserBundle`应该是原生的“restful”，这意味着它可以遵循 REST 建议。

但是，它不是为原生使用而设计的`FOSRestBundle`，最简单的方法是覆盖 Bundle 中的 UsersController 并调整您的操作。

例如，要允许 RESTFul 注册，您可以编写以下操作：

```
 public function postUsersAction()
    {
        $form = $this->container->get('fos_user.registration.form');
        $formHandler = $this->container->get('fos_user.registration.form.handler');
        $confirmationEnabled = $this->container->getParameter('fos_user.registration.confirmation.enabled');

        $process = $formHandler->process($confirmationEnabled);

        if ($process) {
            $user = $form->getData();
            $authUser = false;

            if ($confirmationEnabled) {
            } else {
                $authUser = true;
            }

            $response = new Response();

            if ($authUser) {
                /* @todo Implement authentication */
                //$this->authenticateUser($user, $response);
            }

            $response->setStatusCode(Codes::HTTP_CREATED);
            $response->headers->set(
                'Location',
                $this->generateUrl(
                    'api_users_get_user',
                    array('user' => $user->getId()),
                    true
                )
            );

            return $response;
        }

        return RestView::create($form, Codes::HTTP_BAD_REQUEST);
    } 
```

# jquery - 如何使用条件语句设置变量？

> ID：10606802
> 
> 赞同：0
> 
> 时间：2012-05-15T18:36:14.593
> 
> 标签：jquery

这不起作用，即使在功能块中放置一个简单的 print ("foo") 确实有效。

```
<script>

var viewportHeight = $(window).height();
var X;

$(function() {

    if (viewportHeight >= 600) {
         var X = 100;
       }
});
</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:37:32.103

`var`关键字用于创建一个变量，其范围分配给它所在的任何内容`function`。如果它不在函数内，则其范围为`window`，使其成为全局变量。如果省略`var`关键字，js 引擎将查找范围链以查找最接近的变量定义。因此，通过`var`在函数内部使用，您正在创建一个名为`X`该函数本地的新变量。如果您`var`在函数中省略关键字，它将查找作用域链并找到`var X`您在上面定义的那个。

```
<script>

var viewportHeight = $(window).height();
var X;

$(function() {

    if (viewportHeight >= 600) {
        X = 100; //don't use var if you want to access the above X
    }
});
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:40:05.777

只是我的两分钱，但你可以把整个事情写成一个表达式。

```
 var X = $(window).height() >= 600 ? 100 : null; 
```

这似乎是一个很好的速记的地方

# c++ - C/C++ 中的单引号、双引号和 sizeof('a')

> ID：10606807
> 
> 赞同：58
> 
> 时间：2012-05-15T18:36:45.233
> 
> 标签：c++, c, gcc

我在看问题[Single quotes vs. double quotes in C or C++](https://stackoverflow.com/questions/3683602/single-quotes-vs-double-quotes-in-c)。我无法完全理解给出的解释，所以我编写了一个程序：

```
#include <stdio.h>
int main()
{
  char ch = 'a';
  printf("sizeof(ch) :%d\n", sizeof(ch));
  printf("sizeof(\'a\') :%d\n", sizeof('a'));
  printf("sizeof(\"a\") :%d\n", sizeof("a"));
  printf("sizeof(char) :%d\n", sizeof(char));
  printf("sizeof(int) :%d\n", sizeof(int));
  return 0;
} 
```

我使用 gcc 和 g++ 编译它们，这些是我的输出：

### 海湾合作委员会：

```
sizeof(ch)   : 1  
sizeof('a')  : 4  
sizeof("a")  : 2  
sizeof(char) : 1  
sizeof(int)  : 4 
```

### 克++：

```
sizeof(ch)   : 1  
sizeof('a')  : 1  
sizeof("a")  : 2  
sizeof(char) : 1  
sizeof(int)  : 4 
```

g++ 输出对我来说很有意义，对此我没有任何疑问。在 gcc 中，需要与什么`sizeof('a')`不同`sizeof(char)`？背后有什么实际原因还是只是历史原因？

同样在 C 中 if`char`和`'a'`具有不同的大小，这是否意味着当我们编写 时 `char ch = 'a';`，我们正在进行隐式类型转换？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-15T18:38:18.013

在 C 中，字符常量如`'a'`具有 type `int`，在 C++ 中是`char`.

关于最后一个问题，是的，

```
char ch = 'a'; 
```

导致 到 的隐式`int`转换`char`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T19:19:55.380

因为没有 char 只是 intgers 链接 int 一个字符

我猜是62

如果你尝试 printf("%c",62); 你会看到一个角色

# shell - 终端 cd 命令在 Scala 脚本中不起作用

> ID：10606808
> 
> 赞同：6
> 
> 时间：2012-05-15T18:36:47.627
> 
> 标签：shell, scala, io

我需要从 Scala 脚本运行 shell 命令，为此我使用以下代码段：

```
import scala.sys.process.{Process, ProcessIO}

val command = "ls /tmp"
val process = Process(command)

val processIO = new ProcessIO(_ => (),
    stdout => scala.io.Source.fromInputStream(stdout).getLines.foreach(println),
    _ => ())
process.run(processIO) 
```

代码工作正常。我想知道为什么我得到

```
java.io.IOException: Cannot run program "cd": error=2, No such file or directory 
```

一旦我将命令更改`cd /tmp && ls`为 IMO 相当于`ls /tmp`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T18:42:08.357

来自[维基百科的`cd`命令](http://en.wikipedia.org/wiki/Cd_(command)#How_it_works)：

> [...] 在 Unix 系统上`cd`调用`chdir()`POSIX C 函数。这意味着在执行命令时，**不会**像其他命令（例如`ls`. 相反，shell 本身会执行此命令。

那里甚至有一段关于 Java 的引述：

> [...] Java 编程语言和 Java 虚拟机都不`chdir()`直接支持；十多年来，当负责 Java 的团队考虑替代方案时，一个变更请求一直处于开放状态，尽管到 2008 年，该请求在仅引入有限支持后被拒绝 [...]

自己试试：

```
$ which ls
/bin/ls
$ which cd
$ 
```

简而言之，`cd`它不是您可以运行的程序（进程）（如`/bin/ls`）——它更像是一个命令行指令。

你想达到什么目标？[更改 Java 中的当前工作目录？](https://stackoverflow.com/questions/840190)或更改您刚刚创建的进程的工作目录？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-20T12:29:13.553

工作解决方案：

```
import java.io.File
import scala.sys.process.{Process, ProcessIO}

object terminal_cd {
  def main(args: Array[String]): Unit = {
    val command = "ls"
    val process = Process(command, new File("/tmp"))

    val processIO = new ProcessIO(_ => (),
      stdout => scala.io.Source.fromInputStream(stdout).getLines.foreach(println),
      _ => ())
    process.run(processIO)
  }
} 
```

您所需要的只是将`"cd /tmp"`java.io.File 实例替换为工作目录参数。

(The method to be called: [/scala/src/library/scala/sys/process/Process.scala](https://github.com/scala/scala/blob/39148e4ec34a5c53443dd1b25ceec2308cd097fe/src/library/scala/sys/process/Process.scala#L72-L79) )

# git - SVN Changelist的Git等价物？

> ID：10606809
> 
> 赞同：13
> 
> 时间：2012-05-15T18:36:53.830
> 
> 标签：git, svn, list

只是好奇Git是否有类似Subversions Changelist功能的东西，我发现它在运行时非常方便，我知道我可以运行类似的东西：

```
cat 'changelistfileimade' | xargs git update 
```

但很好奇是否也有内置方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-06-24T21:00:27.807

我为此搜索了更多内容，我想我已经找到了我在上面的评论中提到的[TortoiseSVN`ignore-on-commit`更改列表用例的替代品。](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-commit.html#tsvn-dug-commit-ignore)有问题的命令是`git update-index --assume-unchanged <path/name>`. Git 帮助对此有这样的说法：

> --[no-]假设不变
> 
> 指定这些标志时，不会更新为路径记录的对象名称。相反，这些选项设置和取消设置路径的“假设不变”位。当“假设未更改”位打开时，Git 停止检查工作树文件是否有可能的修改，因此您需要手动取消设置该位以告诉 Git 当您更改工作树文件时。这在处理具有非常慢的 lstat(2) 系统调用（例如 cifs）的文件系统上的大型项目时有时会很有帮助。
> 
> 此选项也可以用作粗略的文件级机制，以忽略跟踪文件中未提交的更改（类似于 .gitignore 对未跟踪文件所做的事情）。如果 Git 需要修改索引中的这个文件，例如在提交合并时，Git 将失败（优雅地）；因此，如果假定的未跟踪文件在上游发生更改，您将需要手动处理这种情况。

我在[Nick Quaranto 的 GitReady 博客](http://gitready.com/intermediate/2009/02/18/temporarily-ignoring-files.html)上找到了对该选项的解释，其中包括以下内容：

> 显然，有很多注意事项与此有关。如果你`git add`直接文件，它将被添加到索引中。合并带有此标志的提交将导致合并正常失败，因此您可以手动处理它。

但这对我来说只是成功的一半。下一步是了解您忽略了什么（并希望记住原因）。这是由 Abe Voelker 对一个恰当命名的问题的[方便评论提供的。](https://stackoverflow.com/questions/2363197/can-i-get-a-list-of-files-marked-assume-unchanged#comment8790168_2363495)只需`.gitconfig`使用代码段编辑您的文件

```
[alias]
    ignored = !git ls-files -v | grep "^[[:lower:]]" 
```

`[alias]`如果文件中已经存在，请不要添加该位。现在`git ignored`会告诉你这样的事情：

```
h configs/environment/local.php
h configs/logging/log4php.xml 
```

`ignore`您可以使用别名 for和`unignore`以下行更进一步：

```
 ignore = update-index --assume-unchanged
    unignore = update-index --no-assume-unchanged 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-15T18:51:23.730

我自己从未使用过[SVN 更改列表](http://www.subversion.org.cn/svnbook/nightly/svn.advanced.changelists.html)，但如果我理解正确，它允许您将文件*分组到更改**列表*中，然后分别提交这些更改列表。（对？）

我不认为你真的需要 Git 的这样一个特性。您已经可以独立地单独暂存（`git add`）每个文件或其中的部分（`git add -p`）并提交这些文件。您可以为每个更改列表创建分支，然后合并/重新设置这些分支。或者您可以创建多个提交，然后使用交互式 rebase ( ) 重新排序它们`git rebase -i`。

而不是`svn diff --changelist something`，您将简单地使用`git show changelistbranch`.

您不必推送那些本地/临时分支。在您认为它们已准备好被释放到野外之前，没有人需要看到它们。

您甚至可以命名您的“更改列表分支”：`git branch changelist/name_of_your_changelist`，然后您将所有更改列表按其前缀分组。

我错过了什么吗？

# node.js - 在后台使用 console.log 的 readline

> ID：10606814
> 
> 赞同：7
> 
> 时间：2012-05-15T18:37:15.473
> 
> 标签：node.js

我在使用 node.js 的 readline 时遇到问题。下面显示的是控制台输出：粗体字是我输入的内容，其余的是服务器正在记录的内容。

```
>测试日志消息
>测试日志消息
> 日志消息
日志消息
T日志消息
esting日志消息
> 123

```

简而言之，我的代码如下所示

```
setInterval(function() { console.log("log message") }, 1000);
var cli = require('readline').createInterface(process.stdin, process.stdout);
cli.setPrompt("> ", 2);
cli.on('line', function(line) {
    cli.prompt();
});
cli.prompt(); 
```

我怎样才能得到提示以提供新的输出空间，而不会完全破坏我正在输入的任何内容？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T20:07:14.873

这似乎在一定程度上解决了问题——在控制台登录后，提示至少会被重绘。

```
var log = console.log;
console.log = function() {
    // cli.pause();
    cli.output.write('\x1b[2K\r');
    log.apply(console, Array.prototype.slice.call(arguments));
    // cli.resume();
    cli._refreshLine();
} 
```

~~但是，中断的提示不会被清除。~~

**编辑：**添加`cli.output.write('\x1b[2K\r');`使它工作

* * *

**编辑 2：**更完整的解决方案，使其他事情也`util.log`能正常工作：

```
function fixStdoutFor(cli) {
    var oldStdout = process.stdout;
    var newStdout = Object.create(oldStdout);
    newStdout.write = function() {
        cli.output.write('\x1b[2K\r');
        var result = oldStdout.write.apply(
            this,
            Array.prototype.slice.call(arguments)
        );
        cli._refreshLine();
        return result;
    }
    process.__defineGetter__('stdout', function() { return newStdout; });
} 
```

**#EDIT 3：**看起来`cli.pause()`和`cli.resume()`通话前后都是多余的。

# objective-c - DADiskEject 导致错误代码 12 (kDAReturnUnsupported) 的问题

> ID：10606817
> 
> 赞同：3
> 
> 时间：2012-05-15T18:37:33.020
> 
> 标签：objective-c, cocoa, diskarbitration

在以下回调函数中卸载后，我尝试弹出外部 USB 驱动器和磁盘映像：

```
void __unmountCallback(DADiskRef disk, DADissenterRef dissenter, void *context )
{
    ...
    if (!dissenter) 
    {
        DADiskEject(disk, 
                    kDADiskEjectOptionDefault, 
                    __ejectCallback, 
                    NULL);
    }
} 
```

不幸的是，我在 __ejectCallback 中遇到错误...

```
void __ejectCallback(DADiskRef disk, DADissenterRef dissenter, void * context)
{
    if(dissenter) 
    {
       DAReturn status = DADissenterGetStatus(dissenter);
       if(unix_err(status)) 
       {
        int code = err_get_code(status);
            ...
       }
    }
} 
```

错误代码为 12，表示 kDAReturnUnsupported。我真的不知道出了什么问题。任何人都可以对此发表评论吗？这是否意味着无法弹出磁盘映像？？？提前谢谢了！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T17:51:52.863

文档对此非常不清楚。因此，最好查看[DARequest 类的实际源代码](http://www.opensource.apple.com/source/DiskArbitration/DiskArbitration-129/diskarbitrationd/DARequest.c)以找出导致`kDAReturnUnsupported`响应的原因。

它揭示了以下返回`kDAReturnUnsupported`响应的条件：

**您的 DADisk 实例是否代表整个卷？**

```
if ( DADiskGetDescription(disk, kDADiskDescriptionMediaWholeKey) == NULL )
{
    status = kDAReturnUnsupported;
}

if ( DADiskGetDescription(disk, kDADiskDescriptionMediaWholeKey) == kCFBooleanFalse )
{
     status = kDAReturnUnsupported;
} 
```

查看 IO Kit 文档（DiscArbitation.framework 对其进行了包装），我们发现它`kDADiskDescriptionMediaWholeKey`描述了媒体是否完整（即，它代表整个磁盘或上面的分区），因此请检查您是否“重新弹出整个光盘而不是分区。请记住，您可以卸载分区，但不能弹出它。（那没有意义）

**光盘可以装吗？**

另一个条件`DARequest.c`是卷是否可挂载，因此请确保它是：

```
if (DADiskGetDescription(disk, kDADiskDescriptionVolumeMountableKey) == kCFBooleanFalse )
{
     status = kDAReturnUnsupported;
} 
```

**DADisk 实例的名称是否有效？**

第三次检查验证卷的名称。某些系统提供的（内部）卷没有名称且无法弹出。检查非常简单，只是查找*任何*名称，所以这应该没什么大不了的。

```
if (DARequestGetArgument2(request) == NULL)
{
    status = kDAReturnUnsupported;
} 
```

通过这三项检查，看看它们是否适用于您。这样你一定会找出问题所在。

# mysql - 如何将图像上传到mysql数据库iOS应用程序

> ID：10606822
> 
> 赞同：0
> 
> 时间：2012-05-15T18:37:47.780
> 
> 标签：mysql, ios, xcode, uiimageview, uiimagepickercontroller

我是 iOS 开发的新手，目前正在为我在 uni 的主要项目创建一个应用程序。我正在创建一个注册页面，要求用户填写他们的详细信息并上传图片。到目前为止，我已经将值输入数据库，但我不知道如何添加图像选择器选择的图像。有人可以帮忙吗？代码贴在下面......

注册视图控制器.h

```
#import <UIKit/UIKit.h>

#define kpostURL @"http://myurl.com/myphp.php"
#define kfname @"fname"
#define ksname @"sname"
#define kemail @"email"
#define kusername @"username"
#define kpassword @"password"
#define kinstrument @"instrument"
#define klocation @"location"

@interface registrationViewController : UIViewController <UIImagePickerControllerDelegate, UINavigationControllerDelegate> {

    UIScrollView *scrollView_;
    BOOL keyboardVisible_;

    IBOutlet UITextField *fnameText;
    IBOutlet UITextField *snameText;
    IBOutlet UITextField *emailText;
    IBOutlet UITextField *usernameText;
    IBOutlet UITextField *passwordText;
    IBOutlet UITextField *instrumentText;
    IBOutlet UITextField *locationText;
    IBOutlet UIImageView *ImageView;
    IBOutlet UIButton *button;

    NSURLConnection *postConnection;
}

@property (nonatomic, retain) UIImagePickerController *imagePicker;
@property (nonatomic, strong) IBOutlet UIScrollView *scrollView;

- (IBAction) pickImage:(id)sender;
- (IBAction) textFieldDoneEditing: (id) sender;
-(IBAction)post:(id)sender;

-(void) postMessage:(NSString*) location withName:(NSString *) fname withSurname:(NSString *) sname withEmail:(NSString *) email withUsername:(NSString *) username withPassword:(NSString *) password withInstrument:(NSString *) instrument;

- (void) keyboardDidShow:(NSNotification *)notif;
- (void) keyboardDidHide:(NSNotification *)notif;

@end 
```

注册视图控制器.m

```
#import "registrationViewController.h"
#import <QuartzCore/QuartzCore.h>

@implementation registrationViewController

@synthesize imagePicker;
@synthesize scrollView=scrollView_;

- (IBAction)textFieldDoneEditing:(id)sender {
    [sender resignFirstResponder];
}

- (IBAction)pickImage:(id)sender {
    imagePicker = [[UIImagePickerController alloc] init];
    imagePicker.delegate = self;
    imagePicker.allowsEditing = YES;
    imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    [self presentModalViewController:imagePicker animated:YES];
}

- (void) imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo{
        ImageView.image = image;
    [imagePicker dismissModalViewControllerAnimated:YES];
}

- (void) imagePickerControllerDidCancel:(UIImagePickerController *)picker {

    [imagePicker dismissModalViewControllerAnimated:YES];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];

}

-(void) postMessage:(NSString*) location withName:(NSString *) fname withSurname:(NSString *) sname withEmail:(NSString *) email withUsername:(NSString *) username withPassword:(NSString *) password withInstrument:(NSString *) instrument{

    if (fname != nil && location != nil && sname !=nil && email !=nil && username !=nil && password !=nil && instrument !=nil){

        NSMutableString *postString = [NSMutableString stringWithString:kpostURL];

        [postString appendString:[NSString stringWithFormat:@"?%@=%@", kfname, fname]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", ksname, sname]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", kemail, email]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", kusername, username]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", kpassword, password]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", kinstrument, instrument]];

        [postString appendString:[NSString stringWithFormat:@"&%@=%@", klocation, location]];

        [postString setString:[postString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

        NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:postString]];
        [request setHTTPMethod:@"POST"];

        postConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES];

    }

}

-(IBAction)post:(id)sender{

    [self postMessage:locationText.text withName:fnameText.text withSurname:snameText.text withEmail:emailText.text withUsername:usernameText.text withPassword:passwordText.text withInstrument:instrumentText.text];
    [locationText resignFirstResponder];
    fnameText.text = nil;
    snameText.text = nil;
    emailText.text = nil;
    usernameText.text = nil;
    passwordText.text = nil;
    instrumentText.text = nil;
    locationText.text = nil;
    [[NSNotificationCenter defaultCenter] postNotificationName:@"Test1" object:self];

}

- (void)viewDidUnload
{
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{

    NSLog(@"%@", @"Registering for keyboard events...");
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidShow:) name:UIKeyboardDidShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardDidHide:) name:UIKeyboardDidHideNotification object:nil];
    keyboardVisible_ = NO;

    [super viewWillAppear:animated];

}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{

    NSLog(@"%@", @"Unregistering for keyboard events...");
    [[NSNotificationCenter defaultCenter] removeObserver:self];

    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

#pragma mark -
#pragma mark Keyboard handlers

- (void) keyboardDidShow:(NSNotification *)notif {
    NSLog(@"%@", @"Received UIKeyboardDidShowNotification");

    if (keyboardVisible_) {
        NSLog(@"%@", @"Keyboard is already visible.  Ignoring notifications.");
        return;
    }

    // The keyboard wasn't visible before
    NSLog(@"Resizing smaller for keyboard");

    // Get the origin of the keyboard when it finishes animating
    NSDictionary *info = [notif userInfo];
    NSValue *aValue = [info objectForKey:UIKeyboardFrameEndUserInfoKey];

    // Get the top of the keyboard in view's coordinate system. 
    // We need to set the bottom of the scrollview to line up with it
    CGRect keyboardRect = [aValue CGRectValue];
    keyboardRect = [self.view convertRect:keyboardRect fromView:nil];
    CGFloat keyboardTop = keyboardRect.origin.y;

    // Resize the scroll view to make room for the keyboard
    CGRect viewFrame = self.view.bounds;
    viewFrame.size.height = keyboardTop - self.view.bounds.origin.y;

    self.scrollView.frame = viewFrame;
    keyboardVisible_ = YES;
}

- (void) keyboardDidHide:(NSNotification *)notif {
    NSLog(@"%@", @"Received UIKeyboardDidHideNotification");

    if (!keyboardVisible_) {
        NSLog(@"%@", @"Keyboard already hidden.  Ignoring notification.");
        return;
    }

    // The keyboard was visible
    NSLog(@"%@", @"Resizing bigger with no keyboard");

    // Resize the scroll view back to the full size of our view
    self.scrollView.frame = self.view.bounds;
    keyboardVisible_ = NO;
}

@end 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T03:03:01.740

这是我在 NSMutableURLRequest 上创建的一个类别：

```
@interface NSMutableURLRequest (SendFormData)

-(void)sendFormData:(NSDictionary *)data;

@end

@implementation NSMutableURLRequest (SendFormData)

-(void)sendFormData:(NSDictionary *)data{
    // add boundary
    NSMutableString *boundary = [NSMutableString stringWithString:@"----Boundary+"];

    // append 5 random chars to the end of the boundary
    for(int i = 0; i < 5; i++){
        BOOL lowercase = arc4random() % 2;
        if(lowercase){
            [boundary appendFormat:@"%c", (arc4random() % 26) + 97];
        } else{
            [boundary appendFormat:@"%c", (arc4random() % 26) + 65];
        }
    }

    // create body data
    NSMutableData *body = [[NSMutableData alloc] init];

    self.HTTPMethod = @"POST";
    [self setValue:[NSString stringWithFormat:@"multipart/form-data, boundary=%@", boundary] forHTTPHeaderField:@"Content-Type"];

    for(NSString *currentKey in [data allKeys]){
        id currentObject = [data objectForKey:currentKey];
        if([currentObject class] == [UIImage class]){
            [body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary]  dataUsingEncoding:NSUTF8StringEncoding]];
            [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"; filename=\"myphoto.png\"\r\n", currentKey] dataUsingEncoding:NSUTF8StringEncoding]];
            [body appendData:[@"Content-Type: image/x-png\r\n" dataUsingEncoding:NSASCIIStringEncoding]];
            [body appendData:[@"Content-Transfer-Encoding: binary\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
            [body appendData:UIImagePNGRepresentation(currentObject)];
            [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
        } else{
            [body appendData:[[NSString stringWithFormat:@"--%@\r\nContent-Disposition: form-data; name=\"%@\"\r\n\r\n%@\r\n", boundary, currentKey, currentObject] dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:NO]];
        }
    }

    self.HTTPBody = body;
}

@end 
```

只需将您的参数和参数对象的 NSDictionary 传递给它，它就会创建您的请求，然后您可以将其传递给 NSURLConnection。

或者您可以选择查看 ASIFormDataRequest 以获取此类内容（https://github.com/pokeb/asi-http-request/tree）。

# android - 获取 Android 手机上的 google 联系人列表

> ID：10606827
> 
> 赞同：0
> 
> 时间：2012-05-15T18:38:03.673
> 
> 标签：android, google-contacts-api

我正在寻找一种方法来查看所有 Android 手机联系人并建立一个 Google 帐户列表。

现在显而易见的解决方案是只查找以“@gmail.com”结尾的电子邮件。然而，这并不适用于所有情况。如果您的联系人有使用 gmail 的公司电子邮件，那么即使他们拥有有效的 gmail 帐户，您的电子邮件也会以“@companyURL.ext”而不是“@gmail.com”结尾。

这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:41:53.107

我假设您的意思是您希望出现的联系人（即其他人）拥有由 Google 托管邮件的电子邮件地址，而不是属于手机用户的 Google 帐户。（只是检查是偏执狂，但第二种情况实际上很容易）。然后不是真的。或者至少我看不到任何实用的方法。

考虑这种情况。我给你我的电子邮件 foo@bar.com。您在联系人中输入。今天我是自托管。下周我将我的域转移到 Google Apps 并让 Google 托管我的邮件。手机上的一切都不会改变。对外界唯一可见的变化是我将更新我的 DNS 区域文件中的 MX 记录以指向 Google。我想您可以获取域，对 MX 记录进行 DNS 查询，并确定邮件服务器是否是谷歌服务器。害羞，没有什么可以说我的邮件托管在 Google 上。但我认为这根本不是一个非常实际的答案。

还要考虑我有多个邮件别名转发到我的帐户的情况。我可能会将它们与我的 Google 帐户相关联，在这种情况下，我可以登录 Google 并使用它们获取 Gmail。但即使是 MX 记录也不会泄露这一点，即使给他们的邮件最终会出现在我的 Gmail 帐户中。

就我而言，我有使用这两种模式的电子邮件地址。

# c# - 在保存到数据库之前检查一个类是否是一个新实例或至少填充一次属性

> ID：10606828
> 
> 赞同：1
> 
> 时间：2012-05-15T18:38:04.953
> 
> 标签：c#, asp.net-mvc, vb.net, entity-framework, nhibernate

我认为这将是一个容易的，但我想不出一个好的方法来做到这一点。

用户提交网络表单。根据提交的信息，我构建了三个类并根据接收到的数据分配它们的属性：

```
UserInfo userInfo = new UserInfo();
UserAddress userAddress = new UserAddress();
UserEmployer userEmployer = new UserEmployer(); 
```

根据提交的信息，某些类最终会填充属性，而有些则不会。

例如，检查 userInfo 类是否最终分配了属性的最佳方法是什么？如果没有分配任何实际属性并且所有属性都设置为空或“”，我不想将特定对象保存到数据库中。

我只想保存最终分配了至少一个不动产的对象。

附言。使用 NHibernate 将数据保存到数据库

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:51:11.493

```
public interface IPersistable{
    bool ShouldPersist {get;}
}

public class MyPersistable:IPersistable
{
    private bool _persist;

    public MyPersistable(){}

    public string MyValue{
        get{
            return _myValue;
        }
        set{
            _persist = true;// or validate with !IsNullOrEmpty() first
            _myValue = value;
        }
    }

    public bool ShouldPersist{
        get{
            return _persist;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:44:45.703

您可以使用反射并循环遍历属性，分别检查每个属性。

```
var type = userInfo.GetType();
var properties = type.GetProperties(); 
```

或者如果它们是字段而不是属性

```
var fields = type.GetFields(); 
```

然后您可以检查每个是否为 null 或某个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:47:25.630

如果您没有任何可以分配给该对象属性的值，请不要创建该对象的实例。

除此之外，“UserAddress”可能不应该是一个实体，而是一个值对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T18:41:07.870

尝试创建一个所有三个类都实现的接口，提供一个类似`shouldSave()`or的函数`hasSetProperties()`，它检查每个数据字段并在定义了任何一个时返回 true。

甚至可能是一种以您可以轻松传递给 NHibernate 的形式获取所有数据的方法。

# android - 改变屏幕方向对软键盘的影响

> ID：10606831
> 
> 赞同：0
> 
> 时间：2012-05-15T18:38:25.253
> 
> 标签：android

问题是我将特定活动的屏幕方向切换到横向模式，当我单击编辑文本时，软键盘只显示它的一部分（顶部的行）。在纵向模式下没有问题，所以我认为这是与屏幕方向有关的问题。我该如何解决这个问题？我正在使用 android 2.2 平台。

活动的 Android 清单代码：

```
<activity android:name=".Main"
                  android:label="@string/app_name"
                  android:screenOrientation = "landscape">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity> 
```

布局上的 EditText 代码：

```
<EditText  
    android:id = "@+id/text"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:text="@string/text"
    android:inputType = "text"
    /> 
```

# objective-c - 来自不同视图控制器的目标 C 访问变量

> ID：10606832
> 
> 赞同：0
> 
> 时间：2012-05-15T18:38:25.813
> 
> 标签：objective-c, delegates

我在情节提要中使用实用程序。我还创建了第三个 viewcontroller，它通过从 Flipsideviewcontroller 的 segue 访问。我想将第三个视图控制器中的一个值添加到主视图控制器中存在的 NSMutableArray 中。我玩过“委托”，但我无法让它发挥作用。我的问题是，如何从第三个视图控制器访问主视图控制器中定义的数组？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:42:11.337

创建第三个视图控制器时，您可以设置指向该数组的弱属性。或者您可以定义第三个视图控制器引用的委托协议，但主视图控制器实现：

```
my3rdviewcontroller.delegate = mainViewController; 
```

然后在 my3rdviewcontroller 中：

```
[self.delegate addValue:myValue]; 
```

当然 mainViewController 实现了 addValue: 消息。

# c# - c# lambda 表达式复杂度

> ID：10606834
> 
> 赞同：0
> 
> 时间：2012-05-15T18:38:46.063
> 
> 标签：c#, lambda, time-complexity

关于 lambda 表达式的一个简单问题

我想在以下代码中获得所有交易的平均值。我使用的公式是 ((price 1*qty 1+(price 2*qty 2)....+(price n*qty n)/(qty 1+qty 2+...+qty n)

在下面的代码中，我使用 sum 函数来计算 (price*qty) 的总和，复杂度将为 O(n)，再一次将所有数量相加，复杂度将为 O(n)。那么，有什么方法可以找到两者的总和，使用复杂度 O(n) 意味着可以计算两个结果的单个 lambda 表达式。

使用 for 循环，我可以计算 O(n) 复杂度的两个结果。

```
class Program
{
    static void Main(string[] args)
    {
        List<Trade> trades = new List<Trade>()
        {
            new Trade() {price=2,qty=2},
            new Trade() {price=3,qty=3}
        };

         ///using lambda
        int price = trades.Sum(x => x.price * x.qty);
        int qty = trades.Sum(x => x.qty);

        ///using for loop
        int totalPriceQty=0, totalQty=0;

        for (int i = 0; i < trades.Count; ++i)
        {
            totalPriceQty += trades[i].price * trades[i].qty;
            totalQty += trades[i].qty;
        }
        Console.WriteLine("Average {0}", qty != 0 ? price / qty : 0);
        Console.Read();
    }
}

class Trade
{
    public int price;
    public int qty;
} 
```

**编辑：**我知道系数不计算在内。让我重新表述这个问题，说使用 lambda 我们将遍历列表中的每个元素两次，而使用 for 循环我们将只遍历每个元素一次。有没有 lambda 的解决方案，所以它不必遍历列表元素两次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:41:56.620

Big-O 复杂度不考虑常数系数。O(n) + O(n) 仍然给出 O(n)。

如果您确定要在 lambda 中使用它，这里有一个使用`Aggregate`运算符的示例。它看起来很做作，我不会推荐它而不是传统的 for 循环。

```
var result = trades.Aggregate(
    Tuple.Create(0, 0),
    (acc, trade) => 
        Tuple.Create(acc.Item1 + trade.price * trade.qty, acc.Item2 + trade.qty));

int totalPrice = result.Item1;
int totalQuantity = result.Item2; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:47:52.760

如前所述，无论您迭代一次还是两次，Big-O 都没有改变。如果您只想使用 Linq 迭代**一次**，您*可以*使用自定义聚合器（因为您要减少到相同的属性，我们可以只使用`Trade`聚合的实例）：

```
var ag = trades.Aggregate(new Trade(), 
                          (agg, trade) => 
                          { 
                            agg.price += trade.price * trade.qty; 
                            agg.qty += trade.qty; 
                            return agg; 
                          });
int price = ag.price;
int qty = ag.qty; 
```

在这一点上，我个人只会使用 foreach 循环或您已经拥有的简单 lambdas - 除非性能在这里至关重要（测量它！）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T19:01:02.273

要扩展 BrokenGlass 的答案，您还可以使用匿名类型作为聚合器，如下所示：

```
var result = trades.Aggregate( 
                 new { TotalValue = 0L, TotalQuantity = 0L }, 
                 (acc, trade) => new 
                 { 
                     TotalValue = acc.TotalValue + trade.price, 
                     TotalQuantity = acc.TotalQuantity + trade.qty
                 }
             ); 
```

这种方法有两个小的好处：

1.  如果您对大量交易（或大宗交易）进行这种计算，您可能会溢出`int`跟踪交易总值和总股数的数据。这种方法允许您指定`long`您的数据类型（因此溢出需要更长的时间）。

2.  与仅返回一个对象相比，您从此聚合中返回的对象将具有更有意义的属性`Trade`。

最大的缺点是看起来有点奇怪。

# javascript - 使用 jQuery 更新对话框标题

> ID：10606836
> 
> 赞同：2
> 
> 时间：2012-05-15T18:38:51.367
> 
> 标签：javascript, jquery, jsf, primefaces

我无法`p:dialog`使用 jQuery 更新标题：

```
<p:commandButton value="#{msgs.ViewPersons}" oncomplete="
    jQuery('#ui-dialog-title-viewPersonsDlgId').text('ciao');
    viewPersonsDlg.show()"> 
...
<p:dialog modal="true" id="viewPersonsDlgId" 
    widgetVar="viewPersonsDlg" dynamic="true"> 
```

奇怪的是第二个 Javascript 语句：`viewPersonsDlg.show()`成功执行，我在 Firebug 中看不到错误。对话框的标题保持为空，或者显示我在对话框`header`属性中放入的内容（如果存在）。

我不是 jQuery 专家，我从 primefaces[论坛](http://forum.primefaces.org/viewtopic.php?f=3&t=8147)中获取了 jQuery 语法。可能我误解了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:44:09.713

相信我，这没有任何元素`id`：`#ui-dialog-title-viewPersonsDlgId`。使用井号，您可以通过 找到元素`id`。`ui-dialog-title`is a `class`of `span`in `dialog`where`title`被定义并且`viewPersonsDlgId`是它的`id`. 所以正确的代码是：

```
oncomplete="jQuery('#viewPersonsDlgId .ui-dialog-title').text('ciao');viewPersonsDlg.show()" 
```

**编辑：**删除了答案的前一部分，这不是问题的原因。还有一件重要的事情是你必须指定正确`id`的`dialog`，所以如果它被放置在 a 中`form`并且你不在`prependId="false"`属性中`form`使用然后使用`...#formID\\:viewPersonsDlgId...`（你必须在 jQuery 中用双斜杠转义“：”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:42:46.827

怎么样：

```
$('#myDialogId').dialog( "option", "title", "ciao" ); 
```

# html - CSS 在 Chrome 而不是 Firefox 中工作（ div 高度）

> ID：10606837
> 
> 赞同：6
> 
> 时间：2012-05-15T18:38:54.750
> 
> 标签：html, css, firefox, google-chrome

我一直在建立一个网站，主要是在 Chrome 中进行测试。最近我意识到一些 CSS 不适用于 Firefox。

我想这可能是：main { min-height }

这个 jFiddle 重现了这个错误，主 div 没有它应该的高度。[http://jsfiddle.net/msW9m/](http://jsfiddle.net/msW9m/)

HTML：

```
<div id='main'></div>
<div id="container"></div>
<div id='footer'>
    <div id='footerRelative'>Development by <a href='mailto:'>John Doe</a></div>
</div>​ 
```

CSS：

```
#main {
    min-height: 80%;
    height: auto;
    border: 1px solid #bbbbbb;
    margin: 3% 5% 1%;
    padding: 10px 10px;
}
#footer {
    position: absolute;
    left: 50%;
}
#footerRelative {
    position: relative;
    left: -50%;
    font-size: 80%;
}
/*Probably Irrelevant*/
#container {
    margin: 0 auto;
    margin-top: -300px;
    margin-left: -261px;
    position: absolute;
    top: 50%;
    left: 50%;
    width: 523px;
    height: 600px;
    background-image: url('../images/doctorSymbol.jpg');
    background-repeat:no-repeat;
    background-position:center;
    opacity: 0.125;
    overflow: hidden;
    z-index: -1;
} 
```

然而，在 Chrome 中一切正常，主 div 的最小高度为 80% 。我想知道是否有解决方法或者我做错了什么。

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T18:46:32.967

您是否尝试过将 body 和 html 制作为 100%？
在某些浏览器中，body 元素在其内容已满之前不会保持 100% 的高度。

[http://jsfiddle.net/HRKRN/](http://jsfiddle.net/HRKRN/)

```
html, body {
    height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-09T17:32:52.177

还有一个对我有用的可能解决方案：将 div 的显示设置为`table-cell`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T14:49:37.553

使用 CSS3 来解决这个问题

```
http://pastebin.com/Q8727Kvt 
```

[使用 CSS 3 垂直对齐](https://stackoverflow.com/questions/5412912/align-vertically-using-css-3)

# python - 在python中遇到基本递归问题

> ID：10606838
> 
> 赞同：1
> 
> 时间：2012-05-15T18:38:57.267
> 
> 标签：python, recursion

我正在研究如何像计算机科学家一样思考，目前正在尝试掌握递归。我在其中一个问题上遇到了麻烦，所以我希望你能帮助我。

我正在编写一个函数，它找到一个列表的递归最小值，其元素是整数、整数列表、整数列表列表等。

这是我当前的版本：

```
def recursive_min(nested_num_list):
    """
      >>> recursive_min([9, [1, 13], 2, 8, 6])
      1
      >>> recursive_min([2, [[100, 1], 90], [10, 13], 8, 6])
      1
      >>> recursive_min([2, [[13, -7], 90], [1, 100], 8, 6])
      -7
      >>> recursive_min([[[-13, 7], 90], 2, [1, 100], 8, 6])
      -13
    """
    min = nested_num_list[0]
    while type(min) == type([]):
        min = min[0]
    for item in nested_num_list:
        if type(item) == type([]):
            recursive_min(item)
        elif item < min:
            min = item
    return min 
```

但是，这只适用于在顶层找到最小值，所以我现在的代码没有进入列表的深度。

现在，看看答案，我知道我的版本应该是这样的：

```
def recursive_min(nested_num_list):
    """
      >>> recursive_min([9, [1, 13], 2, 8, 6])
      1
      >>> recursive_min([2, [[100, 1], 90], [10, 13], 8, 6])
      1
      >>> recursive_min([2, [[13, -7], 90], [1, 100], 8, 6])
      -7
      >>> recursive_min([[[-13, 7], 90], 2, [1, 100], 8, 6])
      -13
    """
    min = nested_num_list[0]
    while type(min) == type([]):
        min = min[0]
    for item in nested_num_list:
        if type(item) == type([]):
            min_of_elm = recursive_min(item)
            if min_of_elm < min:
                min = min_of_elm
        elif item < min:
            min = item
    return min 
```

请注意，它不只是执行 recursive_min(item)，而是将其分配给一个变量，并将其与当前的 min 进行比较。我不明白为什么我需要这样做，因为在我看来，如果我在嵌入列表上执行整个函数，那是一个整数列表，那么它应该进入 elif 语句（而不是 if 语句) 并正确比较这些值。

我知道我必须在这里遗漏一些关于递归的东西。我非常感谢您能给我的任何见解，以帮助我了解是什么使第二个版本有效但第一个版本失败了。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:41:51.237

为什么它会起作用？您调用该函数，它会递归直到找到最小值。那么它有什么作用呢？它依次退出所有递归，直到回到顶层。那时， 的价值是`min`多少？正是在开始递归之前它是什么，因为您从未从递归函数中捕获返回值。

不要忘记函数的每次调用都有自己的局部变量，因此有自己的局部值`min`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:17:57.450

有很多方法可以解决这个问题。就个人而言，我更喜欢一种更实用的方法 - 仅使用列表上的递归，没有循环或局部变量。这当然*不是*解决问题的最有效方法，但它简单而优雅：

```
def recursive_min(num_list):
    return aux_min(num_list[1:], num_list[0]) if num_list else None

def aux_min(num_list, min_num):
    if not num_list:
        return min_num
    elif not isinstance(num_list, list):
        return min(num_list, min_num)
    else:
        return min(aux_min(num_list[0],  min_num),
                   aux_min(num_list[1:], min_num)) 
```

在上面的代码中， main 函数是`recursive_min`，它调用了 helper 函数`aux_min`。反过来，`aux_min`接收一个列表和当前最小值，并将问题拆分为三种情况：

1.  如果列表为空，则返回当前最小值
2.  如果是数字而不是列表，则返回数字与当前最小值之间的最小值
3.  如果是列表，则递归返回其第一个元素与列表其余部分之间的最小值

它适用于列表列表，因为在第三种情况下，第一个元素可能是列表本身。

# vb.net - 如何在不需要实例化该类型的对象的情况下获取类型的属性名称？

> ID：10606841
> 
> 赞同：1
> 
> 时间：2012-05-15T18:39:10.490
> 
> 标签：vb.net, reflection, types, properties

我有一个要求，我需要一种“类型安全”的方式来访问属性名称，而无需实际实例化一个对象来获取该属性。举个例子，考虑一个将 IMyObject 列表和表示属性名称（IMyObject 中存在的属性）的字符串作为参数的方法。

方法实现将获取列表并使用传递的属性名称访问列表中的所有对象......出于某种原因，我们不会详述！

现在，我知道您可以使用实例化对象来执行此操作，例如...

```
Dim x as MyObject = nothing
Dim prop As PropertyInfo = PropHelper.GetProperty(Of MyObject)(Function() x.MyProperty) 
```

我的辅助方法使用反射将属性名称作为字符串获取 - 在网络上有很多这样的例子！

但我不想创建这个毫无意义的对象，我只想做一些类似 MyObject.MyProperty 的事情！反射允许您在不声明该类型的对象的情况下迭代类型属性和方法......但我想访问特定属性并检索其名称的字符串版本，而无需迭代并且不声明该类型的对象！

这里的要点是，虽然我试图将属性名称作为字符串获取......这是在运行时完成的......在编译时，我希望这是类型安全的，所以如果有人更改了属性名称，编译会中断。

任何人都可以帮助完成这个任务！？！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T11:28:56.583

所以这里有一个快速的代码清单来展示我正在寻找的答案：

```
Imports System.Linq.Expressions

Public Class A
    Public Prop1 As String
    Public Prop2 As Integer
End Class

Public Class Form1
    Public Function GetPropertyNameB(Of TModel, TProperty)(ByVal [property] As Expression(Of Func(Of TModel, TProperty))) As String
        Dim memberExpression As MemberExpression = DirectCast([property].Body, MemberExpression)
        Return memberExpression.Member.Name
    End Function

    Public Sub New()
        InitializeComponent()
        Dim propertyName As String = GetPropertyNameB(Function(myObj As A) myObj.Prop1)
        Dim propertyName2 As String = GetPropertyNameB(Function(myObj As A) myObj.Prop2)
        MsgBox(propertyName & " | " & propertyName2)
        End
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:05:08.160

您可以将属性作为简单的 lamdba 表达式传入，并将其作为表达式树在方法中使用。您应该能够分析表达式树以获取属性的字符串名称，但是如果属性名称更改，lambda 表达式将无法编译。查看此页面了解更多详情：

[http://msdn.microsoft.com/en-us/library/bb397951.aspx](http://msdn.microsoft.com/en-us/library/bb397951.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-23T07:18:44.477

您可以使用 NameOf 函数：

```
Dim fieldName = nameOf(MyClass.MyField) 
```

# python - 用户模型的导入错误

> ID：10606843
> 
> 赞同：7
> 
> 时间：2012-05-15T18:39:13.423
> 
> 标签：python, google-app-engine

我有这段代码在本地主机上完美运行，但在 GAE 上抛出了这个模糊的错误：

`import_string() failed for 'webapp2_extras.appengine.auth.models.User' . Possible reasons are: - missing __init__.py in a package; - package or module`

我的进口声明：

```
from webapp2_extras import auth
from webapp2_extras import sessions
from webapp2_extras.auth import InvalidAuthIdError   
from webapp2_extras.auth import InvalidPasswordError 
```

`auth's`用户模型的使用：

```
user = self.auth.store.user_model.create_user(username, password_raw = password, email = email)
if not user[0]: #returns a tuple with [boolean, user_info]
    return 'Create user error'
else:
    self.set_flash("Thank you for registering. Please login!")
    self.redirect(self.auth_config['login_url']) 
```

[完整代码](https://github.com/prakhar1989/webapp2_auth/blob/master/main.py)

# 更新（完整堆栈跟踪）

```
import_string() failed for 'webapp2_extras.appengine.auth.models.User'. Possible reasons are:

- missing __init__.py in a package;
- package or module path not included in sys.path;
- duplicated package or module name taking precedence in sys.path;
- missing module, class, function or variable;

Original exception:

ImportError: No module named ndb

Debugged import:

- 'webapp2_extras' found in '/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2_extras/__init__.pyc'.
- 'webapp2_extras.appengine' found in '/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2_extras/appengine/__init__.pyc'.
- 'webapp2_extras.appengine.auth' found in '/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2_extras/appengine/auth/__init__.pyc'.
- 'webapp2_extras.appengine.auth.models' not found.
Traceback (most recent call last):
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1511, in __call__
    rv = self.handle_exception(request, response, e)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1505, in __call__
    rv = self.router.dispatch(request, response)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1253, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1077, in __call__
    return handler.dispatch()
  File "/base/data/home/apps/s~webapp-auth/1.358936463581927371/main.py", line 34, in dispatch
    response = super(BaseHandler, self).dispatch()
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 547, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 545, in dispatch
    return method(*args, **kwargs)
  File "/base/data/home/apps/s~webapp-auth/1.358936463581927371/main.py", line 127, in post
    user = self.auth.store.user_model.create_user(username, password_raw = password, email = email)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 701, in __get__
    value = self.func(obj)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2_extras/auth.py", line 131, in user_model
    cls = self.config['user_model'] = webapp2.import_string(cls)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1824, in import_string
    return getattr(__import__(module, None, None, [obj]), obj)
  File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2_extras/appengine/auth/models.py", line 13, in <module>
    from ndb import model 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-16T15:37:32.080

看起来类似于webapp 2.5.1 已经修复的这个[问题](http://code.google.com/p/webapp-improved/issues/detail?id=42)

通过将这些行添加到 app.yaml 文件中，确保导入最新版本的 webapp2：

```
libraries:
- name: webapp2
  version: latest 
```

作为一种解决方法，您可以将以下行添加到您的应用程序中：

```
 import sys
 from google.appengine.ext import ndb
 sys.modules['ndb'] = ndb 
```

# iphone - 如何通过蓝牙将 iOS 设备连接到非 iOS 设备（Arduino 设备）？

> ID：10606854
> 
> 赞同：8
> 
> 时间：2012-05-15T18:40:02.850
> 
> 标签：iphone, bluetooth, arduino, ios5, mfi

在谷歌上搜索后，我发现有人说只能通过“MFi 程序”将 iOS 设备与非 iOS 设备连接起来。真的吗？

我的项目主要专注于直接通过蓝牙与 Arduino 设备发送和接收信息。

iOS 和非 iOS 设备之间是否可以在没有[越狱](http://en.wikipedia.org/wiki/IOS_jailbreaking)的情况下进行通信？如果有，有参考吗？

（我查看了 Stack Overflow 问题*[iPhone 如何通过无线或蓝牙访问其他非 iPhone 设备？](https://stackoverflow.com/questions/1065459/how-can-an-iphone-access-another-non-iphone-device-over-wireless-or-bluetooth/1066375#1066375)*。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-16T20:41:04.483

正如我在上面链接的问题中所述，与非越狱 iOS 设备上的外部设备的一般蓝牙通信仅限于兼容 MFi 的蓝牙硬件。

但是，较新的 iOS 设备（iPhone 4S、新 iPad）能够与外部设备进行蓝牙 4.0 LE 通信，而无需这些设备兼容 MFi。这种交互是通过新的核心蓝牙框架完成的，它允许您向蓝牙 LE 设备发送和接收任意数据。不过，这只适用于那些列出的较新的 iOS 设备。

Tim 指出了一个有趣的技巧，你可以通过它让你的设备看起来像一个蓝牙 HID 键盘。像[这种条码扫描仪](http://ftp.opticonusa.com/OPN2002/Documents/OPN2002%20iPad%20&%20iPhone%20QSG.pdf)这样的设备具有特殊模式，可以在 iOS 中显示为 HID 设备。您可能可以基于此将某些内容整合在一起，但是所有数据传输都将是从您的设备传输的单向，并且看起来这将需要将该数据输入到文本字段中，就好像您连接了键盘一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:13:08.197

Alasdair Alan 的[“带有 Arduino 的 iOS 传感器应用程序”](http://shop.oreilly.com/product/0636920021179.do)是一个很好的参考资料。我已经将 Wifi 与另一个微处理器（mbed）一起使用，但不确定蓝牙。Alasdair 在 Twitter 上很活跃，他通常很友善地回答问题。

# c# - 具有键“消息”的 ViewData 项的类型为“System.String”，但必须为“IEnumerable”类型 '

> ID：10606857
> 
> 赞同：0
> 
> 时间：2012-05-15T18:40:27.730
> 
> 标签：c#, database, asp.net-mvc, drop-down-menu, strong-typing

我正在尝试实现一个具有视图、控制器和视图模型的 MVC 应用程序，以便从数据库中填充下拉列表，然后将数据用于 [HttpPost] 中的选定项目。以下是每个相应文件中的数据：

消息控制器.cs

```
public String send_url;
    private msg_cmsEntities smse = new msg_cmsEntities();
public ActionResult Message_Send_Get()
{

    var model = new MessageModel
    {
        MessagesList = smse.Messages
           .Select(c => new SelectListItem
           {
               Value = c.message1,
               Text = c.message1
           })
    };
    return View(model);            
}

[HttpPost]
    public ActionResult Message_Send_Get(String code, String password, String from, String Message_List, MessageModel message_to_send)
    {
        //If the Model is valid (no errors) then go into this statement
        if (ModelState.IsValid)
        {
            WebRequest wrGETURL;

        //This is a string that points to the location of the Web Service 
        string web_service_location = "http://www.google.com?";

        //This initates a new writeable instance of HttpValueCollection
        NameValueCollection query_string = System.Web.HttpUtility.ParseQueryString(string.Empty);
        //This builds up the query string that will be used for the redirect
        query_string["code"] = code;
        query_string["password"] = password;
        query_string["from"] = from;
        query_string["msg"] = Message_List;

        //This concatinates the web_service_location (String) and query_string (String)
        send_url = web_service_location + query_string.ToString();

        Debug.WriteLine(send_url);

        wrGETURL = WebRequest.Create(send_url);
    }
    var model = new MessageModel
    {
        MessagesList = smse.Messages
           .Select(c => new SelectListItem
           {
               Value = c.message1,
               Text = c.message1
           })
    };
    return View(message_to_send);
} 
```

Message_Send_Get.aspx（视图）：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<Message_Send.Models.MessageModel>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Message_Send_Get
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <h2>Message_Send_Get</h2>

    <% using (Html.BeginForm()) {%>
        <%: Html.ValidationSummary(true) %>

        <fieldset>
            <legend>Fields</legend>

            <div class="editor-label">
                <%: Html.LabelFor(model => model.code) %>
            </div>
            <div class="editor-field">
                <%: Html.TextBoxFor(model => model.code) %>
                <%: Html.ValidationMessageFor(model => model.code) %>
            </div>

            <div class="editor-label">
                <%: Html.LabelFor(model => model.password) %>
            </div>
            <div class="editor-field">
                <%: Html.TextBoxFor(model => model.password) %>
                <%: Html.ValidationMessageFor(model => model.password) %>
            </div>

            <div class="editor-label">
                <%: Html.LabelFor(model => model.from) %>
            </div>
            <div class="editor-field">
                <%: Html.TextBoxFor(model => model.from) %>
                <%: Html.ValidationMessageFor(model => model.from) %>
            </div>

            <div class="editor-label">
                <%: Html.LabelFor(model => model.message) %>
            </div>
            <div class="editor-field">
                <%= Html.DropDownListFor(model => model.message, Model.MessagesList)%>
                <%: Html.ValidationMessageFor(model => model.message) %>
            </div>               

            <p>
                <input type="submit" value="Create" />
            </p>
        </fieldset>

    <% } %>

    <div>
        <%: Html.ActionLink("Back to List", "Index") %>
    </div>

</asp:Content> 
```

消息模型.cs

```
public class MessageModel
    {
        [Required(ErrorMessage = "You must enter a code for this service!!")]
        [DataType(DataType.Text)]
        [DisplayName("Code")]
        public string code { get; set; }

        [Required(ErrorMessage = "A password is required for the service!!")]
        [DataType(DataType.Text)]
        [DisplayName("Password")]
        public string password { get; set; }

        [Required(ErrorMessage = "You must enter the 'From' information!!")]
        [DataType(DataType.Text)]
        [DisplayName("Message From")]
        public string sms_from { get; set; }

        [Required]
        [DisplayName("Send Message")]
        public string message { get; set; }

        public IEnumerable<SelectListItem> MessagesList { get; set; }
    } 
```

使用它时，我得到标题中的错误，有人可以帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T07:19:08.450

在您的 POST 控制器操作中，您似乎正在实例化一些您对它什么都不做的模型变量。当然，您仍然没有分配`return View(message_to_send);`此变量的属性。另外，当您的视图模型中已经存在所有动作参数时，为什么还要重复它们？`message_to_send``MessagesList`

以下是我建议您改进代码的方法（我在代码中添加了一些警告作为注释）：

```
[HttpPost]
public ActionResult Message_Send_Get(MessageModel message_to_send)
{
    if (ModelState.IsValid)
    {
        WebRequest wrGETURL;

        //This is a string that points to the location of the Web Service 
        string web_service_location = "http://www.google.com?";

        //This initates a new writeable instance of HttpValueCollection
        NameValueCollection query_string = System.Web.HttpUtility.ParseQueryString(string.Empty);
        //This builds up the query string that will be used for the redirect
        query_string["code"] = message_to_send.code;
        query_string["password"] = message_to_send.password;
        query_string["from"] = message_to_send.sms_from;

        // Warning: you seem to have used some Message_List argument in your action
        // but there's no corresponding input field in the view or in the model
        // maybe you want to add some
        // query_string["msg"] = message_to_send.sms_from.msg;

        //This concatinates the web_service_location (String) and query_string (String)
        send_url = web_service_location + query_string.ToString();

        Debug.WriteLine(send_url);

        // Warning: Here you only created the request but never sent it
        // I guess you will have to complete the code .....
        wrGETURL = WebRequest.Create(send_url);
    }

    // since we want to redisplay the same view we need to reassign the
    // MessagesList property used by the dropdown because in HTML a dropdown
    // sends only the selected value when the form is submitted and not the entire
    // list of options
    message_to_send.MessagesList = smse.Messages
       .Select(c => new SelectListItem
       {
           Value = c.message1,
           Text = c.message1
       });
    return View(message_to_send);
} 
```

小评论：在您看来，您似乎正在使用模型的某些`from`属性：`<%: Html.TextBoxFor(model => model.from) %>`但是您显示的模型中不存在此类属性。也许你的意思是`sms_from`。

# ios - Facebook SDK 链接器错误

> ID：10606858
> 
> 赞同：2
> 
> 时间：2012-05-15T18:40:33.517
> 
> 标签：ios, xcode, facebook, xcode4.3

```
Undefined symbols for architecture armv7:
  "_OBJC_CLASS_$_Facebook", referenced from:
      objc-class-ref in AppDelegate.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我一直在这里寻找答案，但还没有找到答案。我已经尝试过其他人的建议，例如使用较旧的 SDK 副本，但仍然出现此链接器错误。SDK 教程[教程](https://developers.facebook.com/docs/mobile/ios/build/)建议在运行它们包含的脚本后将文件夹拖到您的项目中。当我拖动文件夹时，我遇到了问题。当我在我的项目中为文件创建目录并拖动文件时，它可以工作，但仍然出现此链接器错误。

我还缺少其他东西吗？我已经按照“T”的教程进行操作，但仍然无法弄清楚。

谢谢

# php - 避免对象多重继承

> ID：10606859
> 
> 赞同：1
> 
> 时间：2012-05-15T18:40:34.687
> 
> 标签：php, oop

我正在创建一个表单生成器，实际上我正在处理一个特定的元素：`DuplicableElement`。

表单可以包含一个特殊的容器 ( `DuplicableContainer`)，它使用 jQuery 插件 ( [sheepit](http://www.mdelrosso.com/sheepit/) ) 来复制自己。

要开始这项工作，`DuplicatableContainer`只能`DuplicableElement`在它的孩子中拥有，因为它们是他们特有的很多东西。

问题是 php 不允许**多重继承**。（应该与 php "Traits" 一起使用，但实际上不支持）。我不能`DuplicableTextBox`同时扩展`DuplicableFormElement`和正常`TextBox`元素。

我希望我足够清楚。

编辑：即使使用“特征”，问题仍然存在，我找不到干净的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:45:41.927

您还可以将行为/插件注入到提供特征功能但没有官方支持的元素中。

```
<?php
class Car {
  public $behaviors = array();

  public function __call($method, $params) {
    foreach($this->behaviors as $behavior) {
      if (method_exists($behavior, $method)) {
        return call_user_func_array(array($behavior, $method), $params);
      }
    }
  }
}

class Engine {
  public function start() { echo 'Started'; }
}

$car = new Car;
$engine = new Engine;
$car->behaviors[] = $engine;
$car->start(); // Started 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:45:00.257

`DuplicableElement`s 特别需要是一个类吗？如果对象的公共接口很重要，您可以创建`DuplicableElement`一个接口。一个类可以扩展一个类并同时实现多个接口。

# java - 从 Java Swing App 中的 URL 流式传输音频

> ID：10606864
> 
> 赞同：0
> 
> 时间：2012-05-15T18:40:52.007
> 
> 标签：java, audio, audio-streaming, javasound

我想在 java swing 应用程序中播放来自服务器的流式音频。

有一个公开的直播流在`http://64.202.98.32:6210`。

我尝试了[java声音API](http://www.oracle.com/technetwork/java/index-139508.html)但没有成功：

```
URL ur= new URL("http://64.202.98.32:6210");
AudioStream as = new AudioStream (url.openStream()); 
```

[我还从 java swing 客户端](https://stackoverflow.com/questions/2458221/internet-audio-player-from-java-swing-client)查看了 Internet 音频播放器？

如何在 Swing 应用程序中播放实时音频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:08:50.160

在这个链接上有一个名为 FMJ 的开源项目，也许它可以帮助 -> [http://fmj-sf.net/](http://fmj-sf.net/)

但是恕我直言，您可以使用 Swing 应用程序从网络获取流数据，而不是直接使用服务，然后使用 Java 的 Sound API 播放它。

# javascript - 这段代码可以用更短的方式编写吗？

> ID：10606866
> 
> 赞同：2
> 
> 时间：2012-05-15T18:41:03.780
> 
> 标签：javascript, jquery

我有一段代码，里面没有复杂的东西，它基于三个不同的数字（在我的例子中是视口宽度）：

```
if(viewport_width > 1224) {
    $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 8 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    });
}
if(viewport_width < 1224 && viewport_width > 954) {
    $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 6 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    });
}
if(viewport_width < 954 && viewport_width > 624) {
    $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 4 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    });
}
if(viewport_width < 624) {
    $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 2 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    });
} 
```

所以我虽然（一种方法）将这三个数字放在这样的数组中：

```
var widths = [1224, 954, 624]; 
```

并在其上应用 foreach 函数后：

```
for(var i in widths ) {
   ...
} 
```

但我真的不知道如何将这三个数字包装起来。唯一会根据数组中的数字变化的是另一个数字：

```
{ ... perPage: 6 ... } 
```

可以从 8 到 2 不等。如果可能的话，我希望得到一点帮助，或者换一种写法就好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:44:43.200

您可以制作一个对象列表：

```
var limits = [
  { min: 1224, perPage: 8 },
  { min: 954, perPage: 6 },
  { min: 624, perPage: 4 },
  { min: 0, perPage: 2 }
]; 
```

然后：

```
for (var i = 0; viewport_width <= limits[i].min, i++);
$(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: limits[i].perPage }, 
   function(pages){
      current_page = pages.current;
      total_pages = pages.count;
 }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T18:45:28.010

尝试以下

```
var page;
if (viewport_width > 1224) {
  page = 8;
} else if (viewport_width > 954) {
  page = 6;
} else if (viewport_width > 624) { 
  page = 4;
} else {
  page = 2;
}

$(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: page }, function(pages){
    current_page = pages.current;
    total_pages = pages.count;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:45:55.637

我会做类似下面的事情，

也是全部`if..if..`还是`else If`？我认为应该是`if..else if..`

```
if(viewport_width > 1224) {
    initShop(pages, 8);
} else if(viewport_width >= 954) {
    initShop(pages, 6);
} else if(viewport_width >= 624) {
    initShop(pages, 4);
} else if(viewport_width < 624) {
    initShop(pages, 2);
}    

function initShop(pages,perPage) {
      $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 8 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    });

} 
```

编辑：更新`if..if`，`else if`因为它更有意义.. 还将条件更改`>=`为涵盖所有范围。

* * *

**原始帖子：**包含所有`if..if`

```
if(viewport_width > 1224) {
    initShop(pages, 8);
}
if(viewport_width < 1224 && viewport_width >= 954) {
    initShop(pages, 6);
}
if(viewport_width < 954 && viewport_width >= 624) {
    initShop(pages, 4);
}
if(viewport_width < 624) {
    initShop(pages, 2);
}    

function initShop(pages,perPage) {
      $(".shop-items-navigation").initiate_shop({ containerID: "shop-items-wrapper", perPage: 8 }, function(pages){
        current_page = pages.current;
        total_pages = pages.count;
    }); 
```

# c# - System.Net.Mail.SmtpException：SMTP 命令超时 - 关闭连接

> ID：10606867
> 
> 赞同：1
> 
> 时间：2012-05-15T18:41:03.873
> 
> 标签：c#, email, structuremap, smtpclient, system.net.mail

我遇到偶尔发生的错误。当我遇到此错误时，如果我再试一次，电子邮件将发送。我无法可靠地重现该错误，但它经常出现，足以成为一个问题。

> System.Net.Mail.SmtpException ：服务不可用，正在关闭传输通道。服务器响应为：[Servername]：SMTP 命令超时 - 关闭连接

**堆栈跟踪：**

> 在 System.Net.Mail.MailCommand.CheckResponse(SmtpStatusCode statusCode, String response) 在 System.Net.Mail.MailCommand.Send(SmtpConnection conn, Byte[] command, String from) 在 System.Net.Mail.SmtpTransport.SendMail( MailAddress 发件人、MailAddressCollection 收件人、String deliveryNotify、SmtpFailedRecipientException& 异常）在 System.Net.Mail.SmtpClient.Send（MailMessage 消息）

这是有问题的代码。它使用 HTML 模板（由 web url 默认备份驱动的数据库）来注入值并创建 html 电子邮件。

```
public void AccountActivationEmail(Common.Request.Email.AccountActivation request)
{
    var profile = profileRepository.GetOne(new ProfileByUsername(request.Username, request.SiteId));
    var options = siteService.GetOptions(new GatewayOptionsRequest()
    {
        SiteId = request.SiteId
    });
    var site = options.Site;

    ExpiringHMAC hmac = new ExpiringHMAC(request.ExpireOn, new string[] { request.AccountId.ToString(), request.AccountKey.ToString(), request.Username });

    Dictionary<string, string> data = new Dictionary<string, string>();

    data.Add("{{logourl}}", String.IsNullOrEmpty(options.FullyHostedGateway.LogoUrl) ? UrlHelper.ConvertRelativeToAbsolute("/content/images/spacer.png") : options.FullyHostedGateway.LogoUrl);
    data.Add("{{name}}", profile.Name.DisplayName);
    data.Add("{{sitename}}", site.Name.DisplayName);
    data.Add("{{activationlink}}", String.Format(ActivationUrlFormat, options.UrlFriendlyName, Encryption.EncryptQueryString(request.Username), hmac.ToString()));

    MailDefinition template = new MailDefinition();
    MailMessage message = null;
    var emailTemplate = options.GetEmailTemplate(EmailTemplateType.ActivateAccount);
    string defaultSubject = "Activate Account";

    bool hasTemplate = false;

    if (emailTemplate != null)
    {
        hasTemplate = !String.IsNullOrEmpty(emailTemplate.Template);
    }

    if (!hasTemplate)
    {
        template.BodyFileName = activationDefaultTemplateUrl;
        message = template.CreateMailMessage(request.EmailAddress, data, new System.Web.UI.LiteralControl());
        message.IsBodyHtml = true;
        message.Subject = defaultSubject;
    }
    else
    {
        message = template.CreateMailMessage(request.EmailAddress, data, emailTemplate.Template, new System.Web.UI.LiteralControl());
        message.IsBodyHtml = emailTemplate.IsHtml;

        if (!String.IsNullOrEmpty(emailTemplate.Subject))
            message.Subject = emailTemplate.Subject;
        else
            message.Subject = defaultSubject;
    }

    if (options.ContactDetails != null)
    {
        if (!String.IsNullOrEmpty(options.ContactDetails.EmailAddress))
            message.From = new MailAddress(options.ContactDetails.EmailAddress);
    }

    SmtpClient client = new SmtpClient();

    client.Send(message);
} 
```

此代码是使用 Structuremap 作为单例生成的类的一部分。我认为这可能是导致问题的原因，但是每次调用该方法时，都会创建一个新的 SmtpClient 对象，这应该可以消除我所看到的有关使用同一连接发送多封电子邮件的问题。

我们没有阻止或限制连接，这是我们的电子邮件托管在此问题上采取的官方立场。我想看看是否有任何方法可以更好地做到这一点，所以我不会收到这些错误。

**编辑：**

我确实在我的 web.config 中定义了我的邮件服务器。我已通过我的电子邮件托管确认我的设置是正确的。

```
 <system.net>
      <mailSettings>
        <smtp deliveryMethod="Network" from="no-reply@mydomain.com">
          <network host="smtp.emailhost.com" userName="someaddress@mydomain.com" 
              password="myPassword1" port="2500" />
        </smtp>
      </mailSettings>
  </system.net> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:04:24.903

您是否在发送后处理 Smtp Client 对象？从[http://connect.microsoft.com/VisualStudio/feedback/details/337557/smtpclient-does-not-close-session-after-sending-message](http://connect.microsoft.com/VisualStudio/feedback/details/337557/smtpclient-does-not-close-session-after-sending-message)看起来“......即使你正在创建一个新实例每次使用 SmtpClient 时，它仍然使用相同的基础会话。”

所以也许

```
using (SmtpClient client = new SmtpClient())
{
    client.Send(message);
} 
```

# c++ - C ++单指针上的多个新

> ID：10606870
> 
> 赞同：3
> 
> 时间：2012-05-15T18:41:12.490
> 
> 标签：c++, memory-leaks

我很确定这是一个基本问题，但我在任何地方都找不到答案（可能是因为搜索词错误）。

以下代码是否会造成内存泄漏？

```
int * ptr= new int(15);
ptr= new int(25); 
```

`new`在第二次调用同一指针上的运算符之前，我是否必须删除第一个指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T18:42:41.523

是的，你正在重写`ptr`另一个调用`new`. 因此第一个指针丢失。

如果您想重新使用相同的变量`ptr`，那么只需`delete`使用第一个指针并再次安全地使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T18:42:55.297

> 以下代码是否会造成内存泄漏？

是的。

> 在第二次在同一个指针上调用 new 运算符之前，我是否必须删除第一个指针？

是的，您应该在丢失对它的所有引用并且不再可以释放它之前`delete`分配任何东西。`new`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-15T18:48:48.503

实际上只是为了澄清一点。
`New`将为您提供堆中的“随机”指针，唯一的保证是您可以将请求的字节数放入指针指向的内存块中。

考虑以下：

`int *x = new int;`指针`x`现在指向**0x12345678**，并且那里有一个整数的位置，获得这个整数的唯一方法是使用存储在指针中的地址`x`。

现在假设你再次调用 new。**0x12345678**`x = new int;` 处的整数房间为您保持“保留”，但您的指针现在指向其他地方，例如**0x87654321**，那里有一个新整数的新“点”，指向前一个的指针永远丢失，因为您的指针没有long 指向堆的原始部分。

 ****这个问题的解决方案是调用`delete`指针，它不会触及指针`x`本身，它只会从指针恰好指向的堆中释放内存。（作为直接结果，它`x`本身会改变，但只是因为`new`会给它赋值......）

`new`现在您可以再次自由调用。

（编辑）是的，`new`确实为您调用了构造函数，但这并不是真正的重点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-15T18:42:23.850

是的，是的。每次使用`new`，都必须使用`delete`，它是对等的。****

# sql - 带时间戳的 WebMatrix 数据库

> ID：10606880
> 
> 赞同：0
> 
> 时间：2012-05-15T18:42:05.840
> 
> 标签：sql, sql-server, timestamp, token, webmatrix

我很难尝试让这件事继续下去，我不知道为什么。

我正在尝试建立一个由数据库支持的站点。我工作的公司通过 WebMatrix 使这成为可能。我已经上传了所有的 web 文件并且 IIS 正在运行，但是当涉及到数据库时，我无法弄清楚最后一件事。

如何为时间戳设置列？

回到 phpAdmin，这很简单，但这很荒谬。

我添加了一个包含这些设置的列：

```
(Name)            timestamp
Allow Nulls       False
Datatype          datetime
Default Value     ???
Is Primary Key?   False 
```

如果我将默认值行留空，我会收到此错误：

> Alter table 只允许添加可以包含空值的列。该列不能添加到表中，因为它不允许空值。

但是，如果我将 Default Value 的值填写为 CURRENT_TIMESTAMP，我会收到此错误：

> 解析查询时出错。[令牌行号 = 1，令牌行偏移量 = 62，错误令牌 = CURRENT_TIMESTAMP]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:14:27.540

我知道这是一个老问题，但如果有人在寻找解决方案时遇到它（就像我一样），`GetDate()`请在默认值字段中输入。

# android - 冻结应用程序......所以我不会在重启手机时丢失数据

> ID：10606888
> 
> 赞同：0
> 
> 时间：2012-05-15T18:42:40.723
> 
> 标签：android, save

有没有办法保存所有内容，以免重启后丢失所有数据？

```
 bCalculate.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            InputMethodManager inputManager = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);

            inputManager.hideSoftInputFromWindow(getCurrentFocus()
                    .getWindowToken(), InputMethodManager.HIDE_NOT_ALWAYS);

            int error = 0;
            int anzahlGraden = 0;
            double d1 = 0.0, d2 = 0.0, d3 = 0.0, d4 = 0.0, d5 = 0.0, d6 = 0.0, d7 = 0.0, d8 = 0.0, d9 = 0.0, d10 = 0.0;

            EditText Grade1r = (EditText) findViewById(R.id.Grade1r);
            String Grade1 = Grade1r.getText().toString();

            EditText Grade2r = (EditText) findViewById(R.id.Grade2r);
            String Grade2 = Grade2r.getText().toString();

            EditText Grade3r = (EditText) findViewById(R.id.Grade3r);
            String Grade3 = Grade3r.getText().toString();

            EditText Grade4r = (EditText) findViewById(R.id.Grade4r);
            String Grade4 = Grade4r.getText().toString();

            EditText Grade5r = (EditText) findViewById(R.id.Grade5r);
            String Grade5 = Grade5r.getText().toString();

            EditText Grade6r = (EditText) findViewById(R.id.Grade6r);
            String Grade6 = Grade6r.getText().toString();

            EditText Grade7r = (EditText) findViewById(R.id.Grade7r);
            String Grade7 = Grade7r.getText().toString();

            EditText Grade8r = (EditText) findViewById(R.id.Grade8r);
            String Grade8 = Grade8r.getText().toString();

            EditText Grade9r = (EditText) findViewById(R.id.Grade9r);
            String Grade9 = Grade9r.getText().toString();

            EditText Grade10r = (EditText) findViewById(R.id.Grade10r);
            String Grade10 = Grade10r.getText().toString();

            if (Grade1.equals("")) {
                error++;
            } else {
                d1 = Double.parseDouble(Grade1);
                anzahlGraden++;
            }

            if (Grade2.equals("")) {
                error++;
            } else {
                d2 = Double.parseDouble(Grade2);
                anzahlGraden++;
            }

            if (Grade3.equals("")) {
                error++;
            } else {
                d3 = Double.parseDouble(Grade3);
                anzahlGraden++;
            }

            if (Grade4.equals("")) {
                error++;
            } else {
                d4 = Double.parseDouble(Grade4);
                anzahlGraden++;
            }

            if (Grade5.equals("")) {
                error++;
            } else {
                d5 = Double.parseDouble(Grade5);
                anzahlGraden++;
            }

            if (Grade6.equals("")) {
                error++;
            } else {
                d6 = Double.parseDouble(Grade6);
                anzahlGraden++;
            }

            if (Grade7.equals("")) {
                error++;
            } else {
                d7 = Double.parseDouble(Grade7);
                anzahlGraden++;
            }

            if (Grade8.equals("")) {
                error++;
            } else {
                d8 = Double.parseDouble(Grade8);
                anzahlGraden++;
            }

            if (Grade9.equals("")) {
                error++;
            } else {
                d9 = Double.parseDouble(Grade9);
                anzahlGraden++;
            }

            if (Grade10.equals("")) {
                error++;
            } else {
                d10 = Double.parseDouble(Grade10);
                anzahlGraden++;
            }

            if (error > 8) {
                display.setText("Please enter more then 2 grades.");
            } else {

                double gesamt = d1 + d2 + d3 + d4 + d5 + d6 + d7 + d8 + d9
                        + d10;

                double resultat = gesamt / anzahlGraden;

                display.setText("Your average is " + resultat);

            }

        }

    });

} 
```

这个应用程序计算你的平均成绩...

我想保留所有edittext输入......所以用户可以随时回来并添加新数据......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:48:46.367

在 android 中，您可以使用 SharedPreferences 类在存储中保存和检索原始数据类型的值。查看以下官方文档：

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:46:09.737

看看[这个链接](http://developer.android.com/reference/android/app/Activity.html#SavingPersistentState)。

您可能想要使用`onSaveInstanceState(Bundle)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T18:59:25.510

`onPause`,`onCreate`和的组合`SharedPreferences`是您想要的：

```
 private SharedPreferences mPrefs;
 private EditText grade1r;

 protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);

     mPrefs = getSharedPreferences();

     String rememberedText1 = mPrefs.getString("grade1r", "");
     grade1r = (EditText) findViewById(R.id.Grade1r);
     grade1r.setText(rememberedText1);
 }

 protected void onPause() {
     super.onPause();

     SharedPreferences.Editor ed = mPrefs.edit();
     ed.putString("grade1r", grade1r.getText().toString());
     ed.commit();
 } 
```

这是使用 Activity 生命周期来填充和保存您的 edittexts 视图信息。

您可能想在某个时候清除偏好，但这取决于您。

参考：

[活动生命周期](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)

[保存状态](http://developer.android.com/reference/android/app/Activity.html#SavingPersistentState)

# .net - 如何在 WinForms 应用程序中安全地存储连接字符串？

> ID：10606892
> 
> 赞同：9
> 
> 时间：2012-05-15T18:42:49.230
> 
> 标签：.net, vb.net, security, encryption, connection-string

我需要知道在 VB.NET 中为 WinForms 应用程序存储 SQL 服务器连接字符串的常用方法是什么。

我搜索了网络，并找到了以下每个问题的答案：

*   如何读取 app.config 值
*   如何在 ASP.NET[参考中做到这一点：[this SO question](https://stackoverflow.com/q/9908021/1313143)。]
*   如何存储连接字符串（未加密因此不安全）

我想要一个关于如何在 VB.NET 中安全地`app.config`（或者`settings.settings`如果更好的话）存储连接字符串的完整答案。

是`app.config`正确的地方吗？我可以加密这些值吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-15T18:58:52.193

简单地说，.net 框架允许您这样做，请参阅

[http://msdn.microsoft.com/en-us/library/89211k9b(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/89211k9b%28v=vs.80%29.aspx)

相关信息：

这进入**machine.config**文件：

```
<configProtectedData defaultProvider="RsaProtectedConfigurationProvider">
  <providers>
    <add name="RsaProtectedConfigurationProvider" 
      type="System.Configuration.RsaProtectedConfigurationProvider, ... />
    <add name="DataProtectionConfigurationProvider" 
      type="System.Configuration.DpapiProtectedConfigurationProvider, ... />
  </providers>
</configProtectedData> 
```

这是应用程序代码：

```
Shared Sub ToggleConfigEncryption(ByVal exeConfigName As String)
    ' Takes the executable file name without the
    ' .config extension.
    Try
        ' Open the configuration file and retrieve 
        ' the connectionStrings section.
        Dim config As Configuration = ConfigurationManager. _
            OpenExeConfiguration(exeConfigName)

        Dim section As ConnectionStringsSection = DirectCast( _
            config.GetSection("connectionStrings"), _
            ConnectionStringsSection)

        If section.SectionInformation.IsProtected Then
            ' Remove encryption.
            section.SectionInformation.UnprotectSection()
        Else
            ' Encrypt the section.
            section.SectionInformation.ProtectSection( _
              "DataProtectionConfigurationProvider") 'this is an entry in machine.config
        End If

        ' Save the current configuration.
        config.Save()

        Console.WriteLine("Protected={0}", _
        section.SectionInformation.IsProtected)

    Catch ex As Exception
        Console.WriteLine(ex.Message)
    End Try
End Sub 
```

**更新 1**

感谢@wpcoder，对于[这个链接](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/protecting-connection-information)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-15T18:48:41.603

在我的工作中，我们将完整的连接字符串存储在 app.config 中，但我们使用 AES256 对其进行加密。它工作得很好，并增加了相当多的安全性。我们编写了一个小工具，可让您加密和解密连接字符串，因此编辑 app.config 文件非常容易。我们只是在应用程序中硬编码了加密密钥，所以如果有人想反编译程序集，他们可以弄清楚，但它提高了足够高的标准来满足我们的需求。这是我们用来加密和解密连接字符串的类：

```
Public Class Aes256Base64Encrypter
    Public Function Decrypt(ByVal encryptedText As String, ByVal secretKey As String) As String
        Dim plainText As String = Nothing
        Using inputStream As MemoryStream = New MemoryStream(System.Convert.FromBase64String(encryptedText))
            Dim algorithm As RijndaelManaged = getAlgorithm(secretKey)
            Using cryptoStream As CryptoStream = New CryptoStream(inputStream, algorithm.CreateDecryptor(), CryptoStreamMode.Read)
                Dim outputBuffer(0 To CType(inputStream.Length - 1, Integer)) As Byte
                Dim readBytes As Integer = cryptoStream.Read(outputBuffer, 0, CType(inputStream.Length, Integer))
                plainText = Unicode.GetString(outputBuffer, 0, readBytes)
            End Using
        End Using
        Return plainText
    End Function

    Public Function Encrypt(ByVal plainText As String, ByVal secretKey As String) As String
        Dim encryptedPassword As String = Nothing
        Using outputStream As MemoryStream = New MemoryStream()
            Dim algorithm As RijndaelManaged = getAlgorithm(secretKey)
            Using cryptoStream As CryptoStream = New CryptoStream(outputStream, algorithm.CreateEncryptor(), CryptoStreamMode.Write)
                Dim inputBuffer() As Byte = Unicode.GetBytes(plainText)
                cryptoStream.Write(inputBuffer, 0, inputBuffer.Length)
                cryptoStream.FlushFinalBlock()
                encryptedPassword = System.Convert.ToBase64String(outputStream.ToArray())
            End Using
        End Using
        Return encryptedPassword
    End Function

    Private Function getAlgorithm(ByVal secretKey As String) As RijndaelManaged
        Const salt As String = "put a salt key here"
        Const keySize As Integer = 256

        Dim keyBuilder As Rfc2898DeriveBytes = New Rfc2898DeriveBytes(secretKey, Unicode.GetBytes(salt))
        Dim algorithm As RijndaelManaged = New RijndaelManaged()
        algorithm.KeySize = keySize
        algorithm.IV = keyBuilder.GetBytes(CType(algorithm.BlockSize / 8, Integer))
        algorithm.Key = keyBuilder.GetBytes(CType(algorithm.KeySize / 8, Integer))
        algorithm.Padding = PaddingMode.PKCS7
        Return algorithm
    End Function
End Class 
```

实际上，我们将其包装在一个 ConnectionStringEncrpyter 类中，该类对密钥进行硬编码。

# c# - 访问引用应用程序设置配置文件的常量静态类

> ID：10606899
> 
> 赞同：10
> 
> 时间：2012-05-15T18:43:22.937
> 
> 标签：c#

我有一个名为 LocalConstants 的类....

```
 public static class LocalConstants {
    public static string DM_PATH = ConfigurationManager.AppSettings["DMQueue"];
    public static string PROJECT_PATH = ConfigurationManager.AppSettings["MSQueue"];
 } 
```

当试图在我的主程序中访问这个类时，我得到一个空引用异常。ConfigurationManager.AppSettings[ 中的任何内容始终为空。但如果我写

```
 //The value is returned fine 
  string bo=ConfigurationManager.AppSettings["MSQueue"]; 
```

这编译得很好，但总是 null 并抛出 NullRefexception

```
 string moomoo = LocalConstants.PROJECT_PATH; 
```

例外是“TestCodeOutOnSide.LocalConstants”的类型初始化程序引发了异常。

innerException 是未设置为对象实例的基本对象引用。

即使我将 PROJECT_PATH 更改为

```
public static readonly string PROJECT_PATH = @"FORMATNAME:DIRECT=OS:serus-nickl\RMQDEV"; 
```

我得到同样的例外

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:05:03.647

首先，如果您这样做是为了提供某种性能优势，那么您应该知道这些是缓存的。请参阅[ConfigurationManager.AppSettings 缓存](https://stackoverflow.com/questions/389361/configurationmanager-appsettings-caching-doubt)，以删除任何内容。

其次，问题很可能是[静态字段初始化](http://msdn.microsoft.com/en-us/library/aa645758%28v=vs.71%29.aspx)无法按照您的预期工作。因此，您编写的代码不能保证 `ConfigurationManager.AppSettings`已经运行。从链接的文章示例代码：

> 可能会产生以下输出：

```
Init A
Init B
1 1 
```

> 或输出：

```
Init B
Init A
1 1 
```

[根据 OP 评论编辑]

必须有其他的东西：

```
public static class LocalConstants
{
    public static string DM_PATH = "DMQueue";
    public static string PROJECT_PATH = "MSQueue";
}

class Program
{
    static void Main(string[] args)
    {
        string moomoo = LocalConstants.PROJECT_PATH;

        Console.WriteLine(moomoo);
    }
} 
```

为我工作。

[编辑 2 - 来自后来者]

看起来[“SomeClass”的类型初始值设定项引发了异常](http://blog.wouldbetheologian.com/2009/03/type-initializer-for-someclass-threw.html)可能是一种情况

> 但是当它被 WPF 设计器调用时，“应用程序”是 Visual Studio，它（可能）在其 .config 文件中没有适当的连接字符串；

该作者的修复是：

> 将我的实体数据模型的实例化移动到一个属性中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-23T16:42:45.593

为什么不尝试类似的东西：

```
 public static string ProjectPath 
   { 
       get 
       { 
           return ConfigurationManager.AppSettings["MSQueue"]; 
       } 
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:57:55.657

我叫这个

```
public static string Environment = AppEnvironmentVariable.ToUpper() != "PROD" ? "***FROM " + AppEnvironmentVariable.ToUpper() + "** " : ""; 
```

在这之前

```
public static string AppEnvironmentVariable = "DEV"; 
```

在 LocalConstants 文件中，由于 Josh 所说的静态字段初始化而破坏了它

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-15T19:12:39.600

你可以尝试制作它们`readonly`

```
public static readonly string PROJECT_PATH = ConfigurationManager.AppSettings["MSQueue"]; 
```

`readonly`字段可以延迟加载

# asp.net - asp.net 网络服务登录

> ID：10606900
> 
> 赞同：0
> 
> 时间：2012-05-15T18:43:26.807
> 
> 标签：asp.net

我有一个使用表单身份验证的登录系统，问题是如果用户未登录，我想要登录和注册链接，如果用户已登录，我想要欢迎用户名和注销链接。我的网站使用母版页进行一致的布局，所以我假设所有代码都将进入那里..

我在考虑页面加载时我会有这样的东西：

```
if (User.Identity.IsAuthenticated)
    {
        label1.Text = User.Identity.Name;
    } 
```

但我得到用户在当前上下文中不存在。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T10:22:19.050

感谢榛子。这是答案：

```
<asp:LoginView ID="RegisterLink" runat="server">
<AnonymousTemplate>
<div class="titleRegistration">
  <a href="Register.aspx">Register</a> or 
</div>
</AnonymousTemplate>
<LoggedInTemplate>
    <div class="titleRegistration">
        Hi <b><asp:LoginName ID="LoginName1" runat="server" />!</b>
    </div>
</LoggedInTemplate>
</asp:LoginView>
<asp:LoginStatus ID="lsGeneral" runat="server" LogoutPageUrl="/Users/Logout.aspx" /> 
```

谢谢菲尔伯特。

# c++ - 缓冲区损坏？

> ID：10606902
> 
> 赞同：2
> 
> 时间：2012-05-15T18:43:30.877
> 
> 标签：c++, opengl

我正在尝试在 OpenGL 中编写 UI，但在调整控件大小时遇到​​了问题。

![纹理错误](../Images/525bf13cfd7c332b01e98c35fed095fa.png)

当我缩小面板时，文本纹理似乎会缩小或损坏，最终按钮也会这样做。这些按钮与窗口的大小无关，因此问题不在于计算大小。我打印了文本纹理的大小和按钮大小，它们在测试期间保持一致。

所以每次我调整窗口大小时，都会发生以下情况：

```
onResize
    Delete TexturedRectangle object
        | Delete 9 sprites (including vertex data) used for the TexturedRectangle
        | Delete the RenderTexture
    New TexturedRectangle Object
        | Create 9 sprites (new vertex data) for the textured rectangle
        | Render the rectangle using the 9 sprites to a new RenderTexture the size of the window 
```

我检查了代码并确保在创建新缓冲区之前从 gpu 中删除旧数据。我的缓冲区是否损坏或我渲染到 RenderTextures 的方式不正确？我检查了 glGetError() 并在运行时没有出错。问题可能出在OpenGL堆栈上吗？我不知道问题出在哪里，因为当我调整窗口大小时按钮根本没有改变。

```
Sprite::Sprite() 
    : ISprite(), mVbo(0) {
    mDiffuse = ResourceCache::getSingleton().getTexture("Texture_NOTFOUND");
    createVbo();
}

Sprite::Sprite(ITexture *diffuse, FloatRect textureBounds)
    : ISprite(), mVbo(0) {
    mDiffuse = diffuse;

    if(textureBounds.x == 0 && textureBounds.y == 0) {
        mTextureBounds = diffuse->getBounds();
    } else {
        mTextureBounds = textureBounds;
    }

    createVbo();
}

Sprite::~Sprite() {
    glDeleteBuffers(1, &mVbo);
}

void Sprite::draw(IRenderTarget *target, RenderState *state) const {
    glEnableClientState(GL_VERTEX_ARRAY);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    glBindBuffer(GL_ARRAY_BUFFER, mVbo);

    switch(state->getRenderMode()) {
    default:
    case RenderState::DIFFUSE:
        mDiffuse->bindTexture();
        break;
    case RenderState::NORMAL_MAP:
        mNormalMap->bindTexture();
        break;
    case RenderState::HEIGHT_MAP:
        mHeightMap->bindTexture();
        break;
    };

    glPushMatrix();
    glTranslatef(mPosition.x, mPosition.y, mPosition.z);
    glColor4f(mColor.r, mColor.g, mColor.b, mColor.a);

    glVertexPointer(3, GL_FLOAT, sizeof(Vertex), (void*)offsetof(Vertex, x));
    glTexCoordPointer(2, GL_FLOAT, sizeof(Vertex), (void*)offsetof(Vertex, tx));

    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);

    glPopMatrix();

    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glDisableClientState(GL_VERTEX_ARRAY);
}

void Sprite::createVbo() {
    if(mVbo != 0) {
        glDeleteBuffers(1, &mVbo);
    }

    // Generate the VBO
    glGenBuffers(1, &mVbo);
    Vector2f size = getSize();

    float texW = mDiffuse->getWidth();
    float texH = mDiffuse->getHeight();
    float srcW = size.x / texW;
    float srcH = size.y / texH;

    // Calculate the vertices
    Vertex verts[] = {{0.f, 0.f, 0.f, mTextureBounds.x / texW, mTextureBounds.y / texH},
                        {size.x, 0.f, 0.f, (mTextureBounds.x / texW) + srcW, mTextureBounds.y / texH},
                        {0.f, size.y, 0.f, mTextureBounds.x / texW, (mTextureBounds.y / texH ) + srcH},
                        {size.x, size.y, 0.f, (mTextureBounds.x / texW) + srcW, (mTextureBounds.y  / texH) + srcH}};

    int vertSize = sizeof(verts);

    // Bind the VBO
    glBindBuffer(GL_ARRAY_BUFFER, mVbo);

    // Submit the vertex data to the GPU
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertex) * 4, &verts[0].x, GL_STATIC_DRAW_ARB);

    // Unbind the VBO
    glBindBuffer(GL_ARRAY_BUFFER, 0);
} 
```

重复精灵

```
RepeatingSprite::RepeatingSprite(Texture *diffuseTexture, FloatRect spriteBounds, int xRepeat, int yRepeat) 
    : ISprite(), mXRepeat(xRepeat), mYRepeat(yRepeat) {
    mVbo = 0;
    mDiffuse = diffuseTexture;
    mTextureBounds = spriteBounds;
    createVbo();
}

RepeatingSprite::~RepeatingSprite() {
    glDeleteBuffers(1, &mVbo);
}

void RepeatingSprite::draw(IRenderTarget *target, RenderState *state) const {
    glEnableClientState(GL_VERTEX_ARRAY);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);

    glBindBuffer(GL_ARRAY_BUFFER, mVbo);

    switch(state->getRenderMode()) {
    default:
    case RenderState::DIFFUSE:
        mDiffuse->bindTexture();
        break;
    case RenderState::NORMAL_MAP:
        mNormalMap->bindTexture();
        break;
    case RenderState::HEIGHT_MAP:
        mHeightMap->bindTexture();
        break;
    };

    glPushMatrix();
    glTranslatef(mPosition.x, mPosition.y, mPosition.z);
    glColor4f(mColor.r, mColor.g, mColor.b, mColor.a);

    glVertexPointer(3, GL_FLOAT, sizeof(Vertex), (void*)offsetof(Vertex, x));
    glTexCoordPointer(2, GL_FLOAT, sizeof(Vertex), (void*)offsetof(Vertex, tx));

    glDrawArrays(GL_QUADS, 0, (mXRepeat * mYRepeat) * 4);

    glPopMatrix();

    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glDisableClientState(GL_VERTEX_ARRAY);
}

void RepeatingSprite::createVbo() {
    int totalRepeats = mXRepeat * mYRepeat;
    float textureWidth = mDiffuse->getWidth();
    float textureHeight = mDiffuse->getHeight();
    Vertex *vertices = new Vertex[totalRepeats*4];

    int counter = 0;
    // For each sprite count, create a quad
    for(float y = 0; y < mYRepeat; y++) {
        for(float x = 0; x < mXRepeat; x++) {   

            Vertex v1 = {x * mTextureBounds.w, 
                         y * mTextureBounds.h, 0.f, 
                         mTextureBounds.x / textureWidth, 
                         mTextureBounds.y / textureHeight};

            Vertex v2 = {x * mTextureBounds.w + mTextureBounds.w, 
                         y * mTextureBounds.h, 0.f, 
                         (mTextureBounds.x / textureWidth) + (mTextureBounds.w / textureWidth), 
                         mTextureBounds.y / textureHeight};

            Vertex v3 = {x * mTextureBounds.w, 
                         y * mTextureBounds.h + mTextureBounds.h, 0.f, 
                         mTextureBounds.x / textureWidth, 
                         (mTextureBounds.y / textureHeight) + (mTextureBounds.h / textureHeight)};

            Vertex v4 = {x * mTextureBounds.w + mTextureBounds.w, 
                         y * mTextureBounds.h + mTextureBounds.h, 0.f, 
                         (mTextureBounds.x / textureWidth) + (mTextureBounds.w / textureWidth), 
                         (mTextureBounds.y / textureHeight) + (mTextureBounds.h / textureHeight)};

            vertices[counter] = v1;
            counter++;
            vertices[counter] = v2;
            counter++;
            vertices[counter] = v4;
            counter++;
            vertices[counter] = v3;
            counter++;
        }
    }

    glGenBuffers(1, &mVbo);

    glBindBuffer(GL_ARRAY_BUFFER, mVbo);

    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertex) * (totalRepeats*4), &vertices[0].x, GL_STATIC_DRAW_ARB);

    glBindBuffer(GL_ARRAY_BUFFER, 0);

    delete[] vertices;
} 
```

渲染纹理

```
RenderTexture::RenderTexture(float width, float height) {
    mWidth = width;
    mHeight = height;

    // Create the color buffer
    glGenTextures(1, &mId);
    glBindTexture(GL_TEXTURE_2D, mId);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, (int)mWidth, (int)mHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);
    glBindTexture(GL_TEXTURE_2D, 0);

    // Create the framebuffer
    glGenFramebuffers(1, &mFbo);
    glBindFramebuffer(GL_FRAMEBUFFER, mFbo);

    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, mId, 0);

    GLenum err = glCheckFramebufferStatus(GL_FRAMEBUFFER);
    assert(err == GL_FRAMEBUFFER_COMPLETE); // Make sure texture is valid

    glBindFramebuffer(GL_FRAMEBUFFER, 0);
}

RenderTexture::~RenderTexture() {
    glDeleteBuffers(1, &mFbo);
    glDeleteTextures(1, &mId);
    mFbo = 0;
}

void RenderTexture::preDraw() {
    // store the glViewport and glEnable states
    glPushAttrib(GL_VIEWPORT_BIT);

    // Bind the frame buffer
    //glBindTexture(GL_TEXTURE_2D, 0);
    glBindFramebuffer(GL_FRAMEBUFFER, mFbo);

    // Save the current matrix
    glPushMatrix();
    glLoadIdentity();

    // Setup the projection matrix for the render target
    glMatrixMode(GL_PROJECTION);
    glPushMatrix();
    glLoadIdentity();
    glViewport(0, 0, (int)mWidth, (int)mHeight);
    glOrtho(0, mWidth, 0.f, mHeight, 0.f, 100.f);

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT);
    glDrawBuffer(GL_COLOR_ATTACHMENT0);
}

void RenderTexture::postDraw() {
    // Pop the render target's projection matrix off the stack
    glPopMatrix();
    // Restore previouse projection matrix
    glPopMatrix();
    glBindFramebuffer(GL_FRAMEBUFFER, 0);
    // Restore the previous viewport settings
    glPopAttrib();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T07:08:51.503

在 OpenGL 中，当您对一个对象应用某种变换并看到其他对象受到影响时，开始查找的一个好地方是您的变换和堆栈操作逻辑。

所以在`RenderTexture::preDraw()`你有：

```
glPushMatrix();
// ...
glMatrixMode(GL_PROJECTION);
glPushMatrix(); 
```

并在`RenderTexture::postDraw()`：

```
glPopMatrix();
// Restore previouse projection matrix
glPopMatrix(); 
```

他们之间没有任何通话`glMatrixMode()`。

它不会像这样正常工作。每个矩阵模式都有自己的堆栈，因此第二个`glPopMatrix()`是弹出错误的堆栈。

您将需要执行以下操作：

```
glPopMatrix();
glMatrixMode(GL_MODELVIEW);
glPopMatrix(); 
```

# c# - 如何返回通用 T.ToString()

> ID：10606907
> 
> 赞同：2
> 
> 时间：2012-05-15T18:43:54.107
> 
> 标签：c#, .net, generics

给定这样的定义

```
public class KeyValueItem<K,V>
{
    public K Key { get; set; }
    public V Value { get; set; }

    public override string ToString()
    {
        return T.ToString(); // does not compile
    }
} 
```

我如何覆盖 ToString() 并返回 V.ToString();

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:45:40.137

好吧，看起来你想使用：

```
public class KeyValueItem<K,V>
{
    public K Key { get; set; }
    public V Value { get; set; }

    public override string ToString()
    {
        return this.Value.ToString(); // does compile
    }
} 
```

为什么？因为您在任何地方都没有 T 并且 K/V 是类型，而不是类型的实例。

# ios - 子类化 UITextField 并检测它何时成为或退出第一响应者

> ID：10606908
> 
> 赞同：4
> 
> 时间：2012-05-15T18:43:55.190
> 
> 标签：ios, xcode, uitextfield, subclass, first-responder

我对 UITextField 进行了子类化，并希望在它成为第一响应者或辞去第一响应者时调用一个方法。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-15T19:03:07.420

只需覆盖 becomeFirstResponder 即可调用您的方法。就像是，

```
 - (BOOL)becomeFirstResponder
    {
        BOOL returnValue = [super becomeFirstResponder];
        if (returnValue) {
            [self method];
        }
        return returnValue;
    } 
```

有关响应者方法的更多信息，请参阅此处的文档：http: [//developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/cl/UIResponder](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/cl/UIResponder)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T14:48:48.253

这对我不起作用。我必须成为文本字段的委托并实现这个委托方法：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField{
     //call some custom code here...
} 
```

# javascript - 处理焦点事件时触发点击（jQuery）

> ID：10606910
> 
> 赞同：1
> 
> 时间：2012-05-15T18:44:08.023
> 
> 标签：javascript, jquery, events, javascript-events

我试图确定为什么这样的事情不起作用：

```
$('a').focus( function() {
  $(this).click(); 
}); 
```

背景：

我正在尝试创建一个表单，其中对各种元素（例如文本框等）的制表符将触发指向 div 中锚点的链接，以便在填写表单时将相关文本滚动到视图中。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:53:29.510

```
 $('yourInput').on('focus', function(){
      $('yourAnchor').trigger('click');
 }); 
```

应该可以正常工作，但是由于新元素已被“单击”，您可能会失去对输入字段的关注。我建议改用 jQuery [scrollTo](http://demos.flesler.com/jquery/scrollTo/)插件。这将使您能够执行以下操作：

```
 $('yourInput').on('focus', function(){
       $('messageArea').scrollTo('yourAnchor');
 }); 
```

这是滚动以一种很好的动画方式发生并且不会触发浏览器事件。

您发布的代码可能失败的部分原因是，1\. 锚并不总是有焦点事件，2\. 在焦点后立即单击它可能是多余的，不会导致您正在寻找的更改。

# sharepoint-2010 - 查看 vmware 工作站外部的 sharepoint 站点

> ID：10606912
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:10.117
> 
> 标签：sharepoint-2010, windows-server-2008, vmware-workstation

我在 vmware 工作站中运行 windows server 2008 并且在那里我安装了 sharepoint 2010。如何从我的主机查看 sharepoint 站点，那么从我的 windows 7？

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:05:51.240

这取决于您分配给 VM 的网络配置。如果您没有隔离您的 VM，您应该能够从您的主机 ping 它（假设它们共享相同的网络设置 - 子网掩码、网关、IP 类......）并从主机访问您的 SharePoint 站点。

还要确保服务器上的本地防火墙允许与相关端口的入站/出站连接（至少：80）。

干杯。

# javascript - 如何在 jQuery 中动画背景图像的变化？

> ID：10606917
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:19.340
> 
> 标签：javascript, jquery, jquery-animate

我正在尝试`pulsing heartbeat`为按钮创建重复的视觉效果。

我不相信这可以在 CSS 中完成。

但是，您如何为`jQuery`or中的背景图像更改设置动画`JS`？

我希望能够做到以下几点

```
$(this).animate({
     'background-image': '-webkit-linear-gradient(top, white, red)',
     'background-image': '-linear-gradient(top, white, red)'
 }, 4000); 
```

但是 jQuery 不允许在 CSS 映射中使用非数值。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T18:48:33.423

您可以使用以下方式编写自己的动画`cssHooks`- 创建一个假 CSS 样式键，以您想要的方式设置背景并以数字作为其值，然后可以在`.animate()`.

[http://api.jquery.com/jQuery.cssHooks/](http://api.jquery.com/jQuery.cssHooks/)

或者，如果您为另一个属性设置动画，您可以使用`step`回调手动进行更改（不推荐，除非您使用的是非常旧版本的 jQuery）。

# java - 泽西资源 .class 加载

> ID：10606919
> 
> 赞同：1
> 
> 时间：2012-05-15T18:44:27.090
> 
> 标签：java, rest, jakarta-ee, websphere, jersey

我将 Jersey 资源类作为 JAR 文件捆绑在一个更大的 WAR 中，该文件现在位于 Websphere Application Server 上的 WEB-INF/lib 文件夹下。我有正确的 web.xml 条目（WEB-INF/web.xml），但仍在服务器上，扫描似乎无法查找捆绑为 JAR 的资源类。我正在查看一些线程，建议不要将资源捆绑为 JAR，而是在 /WEB-INF/classes 下单独加载类。

```
<servlet-name>Jersey REST Service</servlet-name>
<servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
 <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
         <param-value>blah.blah.blah</param-value>
 </init-param>
 </servlet> 
```

> com.sun.jersey.api.container.ContainerException：ResourceConfig 实例不包含任何根资源类。在 com.sun.jersey.server.impl.application.WebApplicationImpl.processRootResources(WebApplicationImpl.java:1064)

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:42:57.853

Rohit 的博客文章中概述了有关特定版本 WebSphere 的各种球衣问题的问题，您能看看那里有什么对您有帮助吗？

[http://wasdynacache.blogspot.com/2011/08/jax-rs-implementations-in-websphere.html](http://wasdynacache.blogspot.com/2011/08/jax-rs-implementations-in-websphere.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:42:04.220

将类放在 JAR 和 WEB-INF/classes 中没有区别。您的包名称在 web.xml 中是错误的，或者您的 web.xml 中的其他内容配置不正确，或者您的资源类没有正确注释（或者，可能是一些 WebSphere 魔鬼在起作用——我'我自己从未使用过它，但我听说过非常奇怪的类路径问题）。如果您显示资源类、完整的 web.xml 以及更多有关错误的日志，那么有人可能会指出出了什么问题。

# c# - 将数据传输到另一个表并使之前的 GridView 为空

> ID：10606920
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:34.507
> 
> 标签：c#, asp.net, gridview

我有`GridView`。当我单击一个按钮时，它会将数据发送到另一个表并使之前的表为`GridView`空。

我有以下用于按钮单击的代码，但它不会使之前的代码为`GridView`空。

```
protected void Button1_Click(object sender, EventArgs e)
        {
            SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString);
            conn.Open();
            string userApply = "insert into Company (CompanyName) select (JobTitle) from Jobs where JobTitle=JobTitle";
            SqlCommand insertApply = new SqlCommand(userApply, conn);

            try
            {
                insertApply.ExecuteNonQuery();
                conn.Close();
                Response.Redirect("ApplyJob.aspx");
            }
            catch (Exception er)
            {
                Response.Write(er.ToString());
            }
            finally
            {

            }
        }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:31:46.900

您是否在任何地方清除以前的网格视图？也许在重定向之前试试这个：

```
grvPrevious.DataSource = null;
grvPrevious.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:03:05.953

看起来您在 ApplyJob.aspx 中有您的 GridView，因为您在 try 块中重定向到该页面，并且在那里您看到 gridview 包含一些值。您可以将查询字符串与 ApplyJob.aspx 一起传递，然后在您的 ApplyJob.aspx 表单加载中检查该查询字符串。如果找到该值，则清除 Gridview。以下行中的内容.. 在您的 try 块中执行：

```
Response.Redirect("ApplyJob.aspx?ClearGridView=YES"); 
```

在 ApplyJob.aspx 的 Form_Load 事件中检查查询字符串

```
if(Request.QueryString["ClearGridView"] != null && Request.QueryString["ClearGridView"] =="YES")
   {
      yourGridView.DataSource = null;
      youGridView.DataBind();
   } 
```

# xpages - 修复 IE 中“拉伸”的 XPage 扩展库名称选择器？

> ID：10606922
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:40.040
> 
> 标签：xpages, xpages-extlib

Dalie 想出了一个很好的解决方案，当它们出现在 IE 中时，阻止它们“拉伸”到右侧的对话框。

[修复 IE 中“拉伸”的 XPage 扩展库对话框？](https://stackoverflow.com/questions/10456050/fixing-stretched-xpage-extension-library-dialog-box-in-ie)

Dalie 的解决方案是设置对话框的宽度。这很好用。但是现在我对扩展库名称选择器有同样的问题。它具有我设置的宽度属性，但似乎无法解决问题。

回顾一下，基本上在 IE 中的对话框都被“拉伸”到了对话框的右边框。无论您将对话框移动到哪里，右侧都会固定在原位。

这个问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:13:53.483

尝试通过将 X-UA-Compatible 标头设置为 IE=8（甚至 IE=Edge）来强制 IE 不使用兼容模式：

```
<xp:this.beforeRenderResponse><![CDATA[#{javascript:  if (context.getUserAgent().isIE()) {
    var response = facesContext.getExternalContext().getResponse();
    response.setHeader("X-UA-Compatible", "IE=8");
  }}]]>
</xp:this.beforeRenderResponse> 
```

# php - 单击取消按钮后如何删除数据库行

> ID：10606925
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:44.170
> 
> 标签：php, javascript, jquery, ajax, dom

当用户单击取消按钮时，我想删除包含文件名的数据库行。问题是它没有删除数据库行。数据库行没有被取消，我做错了什么？

下面是表格的相关代码：

```
var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
  "Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
  "<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" +     
  "</p><p class='imagef1_cancel' align='center'><label>" + 
  "<input type='button' name='imageCancel' class='imageCancel' value='Cancel' /></label>" +
  "<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form>"); 
```

下面是 startImageUpload() 函数，它开始上传文件并存储取消按钮函数：

```
 function startImageUpload(imageuploadform, imagefilename){
    $('.imagef1_cancel').eq(window.lastUploadImageIndex).find(".imageCancel").on("click", function(event) {
      return stopImageUpload(2);
      });     
    return true;
  } 
```

下面是 stopImageUpload() 函数，它使用成功和结果显示取消消息：

```
function stopImageUpload(success, imagefilename){
  var result = '';
  if (success == 2){
    result = '<span class="imagecemsg"> The file upload was canceled!</span><br/><br/>';
  } else {
    result = '<span class="imageemsg">There was an error during file upload!</span><br/><br/>';
  }         
  return true;   
} 
```

最后下面是使用 iframe 链接到 QandATable.php（包含上述代码的脚本）的 imageupload.php 脚本，这是假设要从中删除数据库行的位置：

```
<?php
  session_start();
  ...//connected to DB
  $result = 0;

  if ($result == 2) {
    $imagecancelsql = "DELETE FROM Image 
                       WHERE ImageFile = 'ImageFiles/".
                       mysql_real_escape_string($_FILES['fileImage']['name'])."'";
    mysql_query($imagecancelsql);
  }
  mysql_close();
?>
<script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result ? 'true' : 'false'; ?>, '<?php echo $_FILES['fileImage']['name'] ?>');</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:49:11.953

在 imageupload.php 你声明：

```
$result = 0; 
```

然后你说：

```
if ($result == 2)... 
```

`$result`是 0 而不是 2，因此不会执行查询。

# magento - 修复 Magento 中的运输方式名称

> ID：10606927
> 
> 赞同：0
> 
> 时间：2012-05-15T18:44:50.377
> 
> 标签：magento

我有这个奇怪的问题。其中一个运输方式名称`Overnight`显示为 just `O`，在结账时在前端显示，在下订单时在后端显示或在运输方式下显示。

我没有看到任何重命名它的选项或任何东西。在 IRC 上有人告诉我，在表格费率选项卡（系统 > 配置 > 运输方法）下，我可以设置方法名称和标题，但它已经设置为其他内容。

有没有可能有其他东西覆盖它？它存储在数据库中的什么位置？

**更新进度：**

我运行了以下查询`SELECT * FROM core_config_data WHERE path LIKE 'carriers/%/title';`，但没有名为`Overnight`or的方法`O`，我认为某些东西正在即时覆盖它的名称。任何指针？

![在此处输入图像描述](../Images/2cd3052cdc5a6ad3d297f82637d8d27f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T08:40:02.543

在模板上（对我来说*app/design/frontend/base/default/template/checkout/onepage/shipping_method/available.phtml*），标题是这样显示的，我假设在后端使用相同的方法：

```
<label for="s_method_<?php echo $_rate->getCode() ?>"><?php echo $_rate->getMethodTitle() ?> 
```

此方法获取保存在 core_config_data 表中的标题。连接到 MySQL 并使用此请求：

```
SELECT * FROM core_config_data WHERE path LIKE 'carriers/%/title'; 
```

您将看到为每种运输方式显示的标题。也许保存的标题是**O**而不是**Overnight**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:38:20.783

可能有一个翻译文件更改了该值。

查看：

```
app/design/frontend/[package]/[theme]/locale/[region]/translate.csv 
```

# cx-freeze - cx_freeze：如何将包文件添加到 library.zip 中？

> ID：10606932
> 
> 赞同：10
> 
> 时间：2012-05-15T18:45:01.833
> 
> 标签：cx-freeze, pytz

当我尝试为 Windows 滚动 zip 时，我注意到 pytz 错过了 zoneinfo 文件夹。现在我有一个我在之后使用的解决方法`python setup.py build`，即

```
7z a -xr!*.py* build\exe.win32-2.7\library.zip C:\Python27\Lib\site-packages\pytz 
```

有没有合适的方法来实现这一目标`setup.py`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-12-03T22:16:22.497

您可以解决此问题，添加以下方法：

```
def include_files():
        path_base = "C:\\Python27\\Lib\\site-packages\\pytz\\zoneinfo\\"
        skip_count = len(path_base) 
        zip_includes = [(path_base, "pytz/zoneinfo/")]
        for root, sub_folders, files in os.walk(path_base):
            for file_in_root in files:
                zip_includes.append(
                        ("{}".format(os.path.join(root, file_in_root)),
                         "{}".format(os.path.join("pytz/zoneinfo", root[skip_count:], file_in_root))
                        ) 
                )      
        return zip_includes 
```

然后，进入 setup.py 文件：

```
build_exe_options = {"packages": ["os"],
                     "excludes": ["tkinter"],
                     "zip_includes": include_files(),
                     ...
                     } 
```

希望有帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-15T12:34:06.923

我已经通过以下方式在 Python 3.4 中解决了这个问题

```
import pytz
setup(
    ...
    options = {'build_exe':
        {'include_files': (pytz.__path__[0],), ...},
    }, 
) 
```

然后`pytz`包含解压缩的所有时区

# c# - 同一集合中的不同泛型 T

> ID：10606935
> 
> 赞同：12
> 
> 时间：2012-05-15T18:45:21.440
> 
> 标签：c#, generics

```
public abstract Column<T>
{
   private T Value {get;set;}    

   public abstract string Format();

}

public class DateColumn : Column<DateTime>
{
   public override string Format()
   {
      return Value.ToString("dd-MMM-yyyy");
   }
}

public class NumberColumn : Column<decimal>
{
   public override string Format()
   {
      return Value.ToString();
   }
} 
```

我遇到的问题是将这些添加到通用集合中。我知道这是可能的，但我怎样才能在一个集合中存储多种类型等

```
IList<Column<?>> columns = new List<Column<?>() 
```

对于实现这一目标的任何建议，我将不胜感激。目标是将不同的列类型存储在同一个列表中。值得一提的是，我正在使用 NHibernate 和鉴别器来加载适当的对象。最终，Value 需要具有类的类型。

非常感谢您提前提供的帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-15T18:48:27.620

为了一起存储，`List<T>`列必须具有共同的基本类型。`DateColumn`和最接近的公共基类`NumberColumn`是`object`。`Column<T>`两者都不是源自`Column<T>`.

这里的一个解决方案是引入一个非泛型`Column`类型，它`Column<T>`派生自并将其存储在`List`

```
public abstract class Column { 
  public abstract object ValueUntyped { get; }
}

public abstract class Column<T> : Column {
  public T Value { get; set; }
  public override object ValueUntyped { get { return Value; } }
}

...

IList<Column> list = new List<Column>();
list.Add(new DateColumn());
list.Add(new NumberColumn()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:47:45.833

泛型都是关于指定类型的。如果要使用动态类型，请改用经典类型`ArrayList`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T18:48:03.207

`Column`从包含列的尽可能多的非泛型公共接口的非泛型类派生可能是有意义的......然后将您的列表声明为`List<Column>`.

# jquery - jQuery Mobile 处理 input[type=submit] vs button[type=submit]

> ID：10606941
> 
> 赞同：0
> 
> 时间：2012-05-15T18:45:49.457
> 
> 标签：jquery, forms, jquery-mobile

我正在创建一个简单的表单并开始遇到我的提交按钮 ( `<input type=submit>`) 没有发布表单的问题。我发现有一个配置选项 (ajaxEnabled) 应该设置为 false。所以添加了配置，但是当点击提交按钮时它仍然不会发布。然后，`<input>`我没有使用标签，而是用标签替换了它，你`<button>`瞧，它发布了表单。

从 jQuery Mobile 站点阅读文档，它说 type=submit 的输入和按钮都应该以相同的方式处理。谁能解释我收到的行为？也许这是当前版本的 jQuery mobile 中的一个错误？

谢谢！

# wpf - 从使用者视图将 XAML 属性值设置为用户控件

> ID：10606953
> 
> 赞同：1
> 
> 时间：2012-05-15T18:46:39.830
> 
> 标签：wpf, data-binding, user-controls

我有一个包含网格的自定义 UserControl ...我希望`ItemsSource`通过资源字典中数据模板的 xaml 代码设置该网格的属性...然后我使用了依赖属性...这是我的实现。 ..

```
public partial class MyControlGrid : UserControl
{

    // Dependency Property
    public static readonly DependencyProperty MyItemSourceProperty =
         DependencyProperty.Register("MyItemSource", typeof(ICollectionView),
         typeof(MyControlGrid), new FrameworkPropertyMetadata(null, OnMyItemSourcePropertyChanged));      

    IDictionary<string, string> _columns = new Dictionary<string, string>();

    private static void OnMyItemSourcePropertyChanged(DependencyObject obj, 
        DependencyPropertyChangedEventArgs args)
    {
        // When the color changes, set the icon color PlayButton
        MyControlGrid muc = (MyControlGrid)obj;
        ICollectionView value = (ICollectionView)args.NewValue;
        if (value != null)
        {
            muc.MyGridControl.ItemsSource = value;
        }
    }

    public ICollectionView MyItemSource
    {
        get
        {
            return (ICollectionView)GetValue(MyItemSourceProperty);
        }
        set
        {
            SetValue(MyItemSourceProperty, value);
            //OnTargetPowerChanged(this, new DependencyPropertyChangedEventArgs(TargetPowerProperty, value, value));
            // Old value irrelevant.
        }
    }

    public MyControlGrid()
    {
        InitializeComponent();

    }
} 
```

这是用户控件 xaml 代码

```
<UserControl x:Class="GUI.Design.Templates.MyControlGrid"
    Name="MyListControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:WpfTkit="http://schemas.microsoft.com/wpf/2008/toolkit"
             xmlns:Templates="clr-namespace:Emule.GUI.Design.Templates">

<StackPanel>

        <WpfTkit:DataGrid   ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Templates:MyControlGrid}}, Path=MyItemSource}"
                            x:Name="MyGridControl"  

<StackPanel> 
```

这是我使用的绑定路径表达式

```
<basic:MyControlGrid MyItemSource="{Binding MyDataContextVisibleCollection}"/> 
```

这不起作用，wpf 输出窗口不显示任何错误

请注意，自然地，如果我直接在用户控件中绑定它可以正常工作

```
<WpfTkit:DataGrid   ItemsSource="{Binding MyDataContextVisibleCollection}" 
```

我错了吗？

谢谢

ps对不起我的英语

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T07:23:28.337

这个 [答案](https://stackoverflow.com/questions/4539416/user-control-with-custom-itemssource-dependency-property)告诉我方向

使用`PropertyChangedCallback`我的代码可以正常工作：

```
public static readonly DependencyProperty MyItemSourceProperty =
              DependencyProperty.Register("MyItemSource", typeof(IEnumerable),
              typeof(MyControlGrid), new FrameworkPropertyMetadata(null,
              new PropertyChangedCallback(MyControlGrid.OnItemsSourceChanged))); 
```

或者我必须删除评论`OnTargetPowerChanged`并触发属性更改事件

```
set
{
    SetValue(MyItemSourceProperty, value);
    //OnTargetPowerChanged(this, new DependencyPropertyChangedEventArgs(TargetPowerProperty, value, value));
    // Old value irrelevant.
} 
```

正确的

```
public ICollectionView MyItemSource
{
    get
    {
        return (ICollectionView)GetValue(MyItemSourceProperty);
    }
    set
    {
        SetValue(MyItemSourceProperty, value);
        OnItemsSourceChanged(this, new DependencyPropertyChangedEventArgs(MyItemSourceProperty, value, value));
    }
} 
```

# python - 选择一个有效的选择 XXX 不是可用的选择之一......但值出现在选择中

> ID：10606954
> 
> 赞同：1
> 
> 时间：2012-05-15T18:46:41.797
> 
> 标签：python, django, django-forms

我有一个带有选择字段的简单表单：

```
class seguimentTutorialForm(forms.Form):
    pregunta_select  = forms.ChoiceField(    )

    def __init__(self, *args, **kwargs):
        self.pregunta = kwargs.pop('pregunta', None)
        super(seguimentTutorialForm,self).__init__(*args,**kwargs)
        self.fields['pregunta_select'].widget.choices=
               [('',u'---Tria---')] + 
               [ (x.strip(),x.strip(), ) for x 
                       in self.pregunta.possibles_respostes.split('|')] 
```

我在 POST 数据上收到此验证错误：

```
Select a Valid Choice NO is not one of the available choices 
```

这是生成的 html 表单：

```
 <tr>        
                <td class="label_tag">
                                <label for="id_6_3-pregunta_select">blah blah?</label>:</td> 
                <td class="tria_tag"  class="conte_errors"    >             
                    <select name="6_3-pregunta_select" id="id_6_3-pregunta_select"> 
<option value="">---Tria---</option> 
<option value="NO" selected="selected">NO</option> 
<option value="Sí, AO">Sí, AO</option> 
<option value="Sí, AA">Sí, AA</option> 
<option value="Sí, PS">Sí, PS</option> 
<option value="Sí, UEE">Sí, UEE</option> 
</select> 

                    <br/><span class="help_text">( Tipus alumne )</span> 

                    <ul class="errorlist"><li>Select a Valid Choice NO is not one of the available choices.</li></ul> 
                </td> 
            </tr> 
```

解决这个问题的一些想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:16:50.280

好的！修正，我的错误。要修复它更改行：

```
 self.fields['pregunta_select'].widget.choices= 
```

经过：

```
 self.fields['pregunta_select'].choices= 
```

# google-maps - 如何在 GoogleMaps 中绘制历史国家数据（苏联、东德等）？

> ID：10606955
> 
> 赞同：20
> 
> 时间：2012-05-15T18:46:42.687
> 
> 标签：google-maps, google-maps-api-3, google-fusion-tables, country-codes

我正在使用 Fusion Tables 构建一系列信息图表来显示国家/地区的年度数据，每个国家在 Google 地图上由一个大头针表示，当您单击该国家的大头针时数据值可见。我的当代价值观完美地发挥了作用，但是：

我的数据可以追溯到 80 年前，我希望允许用户查看不存在的国家（如苏联、东德/西德等）的历史数据。

**将历史数据上传到 Fusion Tables 时，是否可以使用“存档”世界地图？**（例如，1988 年的世界地图，1934 年的世界地图）

如果没有，我可以简单地使用现代地图并选择大头针位置来近似旧国家，但它看起来不会那么好。我不够聪明，也不能花时间来创建新的世界地图——我想以前肯定有人遇到过这个问题，但我什么也找不到。

任何建议都将不胜感激。

最好的，T.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T01:14:26.577

如果您在 GeoCommons 上找不到您需要的内容，[该站点](http://spatial.scholarslab.org/stepbystep/creating-gis-datasets-from-historic-maps/)提供了一个教程，用于从地图图像创建您自己的 GIS 数据集，如果您愿意投入其中。它需要您安装[ArcGIS Explorer](http://www.esri.com/software/arcgis/explorer/download)（它是免费的，不用担心）。您可以使用许多历史地图图像来源，例如[俄罗斯的这一](http://www.russiamap.org/maps.php?type=historical)图像。

我还支持 geocodezip，因为使用 KML 可能是将 GIS 数据集放到 Google 地图上的最简单方法，并且许多 GIS 应用程序（如[ArcGIS](http://www.esri.com/software/arcgis/explorer/download)）都支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:12:02.383

您可以在 Google 地图图块上覆盖旧地图。这可能是实现您正在寻找的最简单的方法。

请参阅覆盖文档 - [https://developers.google.com/maps/documentation/javascript/overlays#GroundOverlays](https://developers.google.com/maps/documentation/javascript/overlays#GroundOverlays)

示例： [https ://google-developers.appspot.com/maps/documentation/javascript/examples/groundoverlay-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/groundoverlay-simple)

还有一些工具可以帮助做到这一点。我只是简单地搜索了 Google Maps Tiles Overlay Generator。- 我找到的第一个：http: [//www.maptiler.org/](http://www.maptiler.org/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-29T05:25:06.850

您可以使用样式参数为地图设置主题，使其看起来更旧一些，可能会删除 pois、道路等的标签。

# android - 如何在发送短信时异步显示消息？

> ID：10606956
> 
> 赞同：1
> 
> 时间：2012-05-15T18:46:44.183
> 
> 标签：android, android-intent

我正在开发一个 android 应用程序，它从一个窗口（活动）发送一条短信，然后移动到另一个窗口（活动）。我正在尝试向用户显示一条消息，如何查看消息传递的另一个活动。我想解决方案是触发一个发送消息的线程，然后等到它被传递并显示一个 toast 或 Dialog。但我不知道这是否正确或如何做到这一点。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:01:31.060

`sendDataMessage`为此具有以下参数：

`sentIntent`- 如果不为 NULL，则在消息发送成功或失败时广播此 PendingIntent。

`deliveryIntent`- 如果不为 NULL，则在将消息传递给收件人时广播此 PendingIntent。

[编辑] - 如何创建待处理意图的示例

```
final PendingIntent sentIntent = PendingIntent.getActivity(this, 0, new Intent(this, SmsSendCheck.class), 0); 
```

`SmsSendCheck`- 这是一个展示你的吐司的特殊活动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:58:29.623

吐司是个好方法。否则，当您的 PendingIntent 在 SMS 发送后广播时，在当前 Activity 中显示一些内容。

# bash - 运行 bash 脚本时自动输入密码

> ID：10606958
> 
> 赞同：6
> 
> 时间：2012-05-15T18:46:49.400
> 
> 标签：bash, passwords, sudo

例如，假设我有一个脚本说：

```
#!/bin/bash
sudo setpci -s 00:02.0 F4.B=00 
```

如何将 root 密码放入脚本中，以便它在读取和执行 sudo 行时接受它作为密码（所以我不必手动输入）？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-15T18:49:10.923

在您的 bash 脚本中产生一个[期望](http://en.wikipedia.org/wiki/Expect)会话通常是您自动化交互式提示的方式。

例如

```
expect -c "
spawn sudo setpci -s 00:02.0 F4.B=00
expect -nocase \"password:\" {send \"$PASS\r\"; interact}
" 
```

请注意，在这种情况下，这不是推荐的方法，因为将 root 密码存储在 bash 脚本中是一个**巨大的安全漏洞。**

正确的解决方案是编辑您`/etc/sudoers/`以不提示您输入该二进制文件的密码。

```
#in /etc/sudoers
neohexane ALL=(ALL) NOPASSWD : /usr/bin/setpci 
```

# java - 从字符串 (GWT) 制作 kml 层

> ID：10606959
> 
> 赞同：1
> 
> 时间：2012-05-15T18:46:51.613
> 
> 标签：java, google-maps, gwt, kml

我有一个字符串形式的 KML。实际上，我从我的 GWT 项目中调用了一个服务，该服务以字符串的形式返回一个 KML 文件。如何在我的地图上显示此 KML？我只有一个字符串。我应该先解析它还是可以从这个字符串创建一个 KML 图层？

//我正在为 GWT 使用谷歌地图 v3 api

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:53:48.287

我以为您使用的是 JavaScript，但由于您使用的是 Java，您是否看过[JAK Java API for KML](http://code.google.com/p/javaapiforkml/)？它在幕后使用 JAXB，但它提供了一个`unmarshal`接受文件或`String`. TheServerSide.com 上有[一篇描述该库的文章，](http://www.theserverside.com/news/thread.tss?thread_id=57055) [Java.net](http://weblogs.java.net/blog/thlandgraf/archive/2009/08/java_api_for_km.html)上有另一篇文章。

[最后， Micromata 的 JAK 站点上](http://labs.micromata.de/display/jak/Home)提供了一些很好且详细的文档。希望这可以帮助 -

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T19:59:44.083

我正在尝试做与您完全相同的事情。从 Google 中查看这个示例：[KmlOverlayDemo.java](http://code.google.com/p/gwt-google-apis/source/browse/trunk/maps/samples/hellomaps/src/com/google/gwt/maps/sample/hellomaps/client/KmlOverlayDemo.java?r=1715)。

您必须将字符串写入文件（最好在服务器端完成），然后调用`GeoXmlOverlay.load("KmlFilePath", GeoXmlLoadCallback)`. 如果成功，将返回一个覆盖对象，您可以将其添加到`MapWidget`.

这是迄今为止我找到的最好的方法，但我正在寻找更好的方法。

# sip - 使用 tshark 过滤 VoIP 呼叫

> ID：10606961
> 
> 赞同：5
> 
> 时间：2012-05-15T18:47:04.640
> 
> 标签：sip, voip, wireshark, tshark

我正在分析网络上的 VoIP 呼叫

现在我正在使用生成的 .pcap 文件，但稍后我将实时监听。

我正在使用 tshark，我可以很容易地从 .pcap 中过滤一些重要数据（例如“源 ip 地址和端口”、“目标 ip 地址和端口”、有效负载 pckt 丢失、Max Delta(ms)、Max Jitter(毫秒），平均抖动（毫秒））与

> tshark -r myfile -q -z rtp,streams

我想知道的是：我怎样才能得到一个呼叫的 sip addrs？（客户端和服务器）

我可以通过过滤所有 sip INVITE 来检索一些 sip 地址（仅限客户端），如下所示：

> tshark -r myFile -R "sip.Request-Line 包含 INVITE"

但是我无法获取服务器的地址。

澄清一下，我的想法是在 tshark 中获得这个“统计信息”，就像当我访问“电话 > VoIP 呼叫”时，wireshark 给我的一样（就像 tshark -r myfile -q -z rtp,streams 返回我的统计信息一样wireshark 的电话>RTP>显示所有流），有没有办法做到这一点？如果没有“统计”（-z），我如何创建一个过滤器（-R）来做类似于wireshark的“VoIPCall”功能的事情

我正在使用 tshark，因为我想处理这些数据，而不仅仅是在我的屏幕上分析它

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-11T01:50:02.877

尝试：

```
tshark -r myFile -R "sip.CSeq.method eq INVITE" 
```

这将过滤从客户端发送的请求和来自服务器的相应回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-07T13:28:49.587

我处于类似的情况，最终浏览了 tshark 手册页。

命令：`tshark -r input_file.pcap -q -z sip,stat`

解释：

```
-r <infile> : Read packet data from infile

-q : When reading a capture file, don't print packet information; this is useful if you're using a -z option to calculate statistics and don't want the packet information printed, just the statistics.

-z <statistics> : Get TShark to collect various types of statistics and display the result after finishing reading the capture file. 
```

您还可以将过滤器添加到过滤器中，例如，您想要汇总所有只有 SIP 480 状态代码的数据包，您可以通过以下方式进行：

`tshark -r input_file.pcap -q -z sip,stat,sip.Status-Code==480`

```
-z sip,stat[,filter] : This option will activate a counter for SIP messages. You will get the number of occurrences of each SIP Method and of each SIP Status-Code 
```

如果您想要多个过滤器，您可以一个一个添加它们

`tshark -r input_file.pcap -q -z sip,stat,sip.Status-Code==480 -z sip,stat,sip.Status-Code==500`

如果要按 sip 地址进行汇总，可以按以下方式过滤：

`tshark -r input_file.pcap -q -z sip,stat,sip.to.host==sip-to-host.com`

参考：

1.  TShark 手册页：[https ://www.wireshark.org/docs/man-pages/tshark.html](https://www.wireshark.org/docs/man-pages/tshark.html)
2.  SIP 过滤器：[https ://www.wireshark.org/docs/dfref/s/sip.html](https://www.wireshark.org/docs/dfref/s/sip.html)

# bash - 在 Bash Shell 中计算

> ID：10606967
> 
> 赞同：1
> 
> 时间：2012-05-15T18:47:36.933
> 
> 标签：bash, bc

如何计算以下数据？

```
Input:

2 Printers
2 x 2 Cartridges
2 Router
1 Cartridge 
```

输出：

```
Total Number of Printers: 2
Total Number of Cartridges: 5 
Total Number of Router: 2 
```

请注意，墨盒已成倍增加`(2 x 2) + 1 = 5`。我尝试了以下操作，但不确定当我有`(2 x 2)`场景类型时如何获取号码：

```
awk -F " " '{print $1}' Cartridges.txt >> Cartridges_count.txt
CartridgesCount=`( echo 0 ; sed 's/$/ +/' Cartridges_count.txt; echo p ) | dc`

echo "Total Number of Cartridges: $CartridgesCount" 
```

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:24:32.140

这假设数据中只有乘法运算符。

```
awk '{$NF = $NF "s"; sub("ss$", "s", $NF); qty = $1; for (i = 2; i < NF; i++) {if ($i ~ /^[[:digit:]]+$/) {qty *= $i}}; items[$NF] += qty} END {for (item in items) {print "Total number of", item ":", items[item]}}' 
```

分成多行：

```
awk '{
        $NF = $NF "s"; 
        sub("ss$", "s", $NF); 
        qty = $1; 
        for (i = 2; i < NF; i++) {
            if ($i ~ /^[[:digit:]]+$/) {
                qty *= $i
            }
        }; 
        items[$NF] += qty
     } 
     END {
         for (item in items) {
             print "Total number of", item ":", items[item]
         }
     }' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:05:20.417

尝试这样的事情（假设输入格式良好）......

```
sed -e 's| x | * |' -e 's|^\([ 0-9+*/-]*\)|echo $((\1)) |' YourFileName | sh | awk '{a[$2]+=$1;} END {for (var in a) print a[var] " "var;}' 
```

PS墨盒和墨盒是不同的。如果您也想处理它，那将更加困难，但您可以修改管道中的最后一个 awk。

# android - 如何找到与 Android Market 关联的 Gmail 帐户？

> ID：10606976
> 
> 赞同：7
> 
> 时间：2012-05-15T18:48:40.233
> 
> 标签：android, google-play

我知道如何查找帐户（包括用户的 gmail 电子邮件 ID）以及如何过滤 gmail 帐户。

```
AccountManager am = AccountManager.get(context);
        Account[] accounts = am.getAccounts();
        ArrayList<String> googleAccounts = new ArrayList<String>();
        for (Account ac : accounts) {
            String acname = ac.name;
            String actype = ac.type;
            //add only google accounts
            if(ac.type.equals("com.google")) {
                googleAccounts.add(ac.name);
            }
            Log.d(TAG, "accountInfo: " + acname + ":" + actype);
        }
        return googleAccounts; 
```

我想知道的是如何找到与 Android Market 关联的 gmail 帐户？如果您尝试从 Android 手机中删除 gmail 帐户，您将收到此消息 ![在此处输入图像描述](../Images/9d2527ed7a6a41b46fd58416857b52c4.png)

但如果您尝试删除与 Android Market 关联的 gmail 帐户，您将收到以下消息（如果您在前面的消息中按**删除帐户）。**

![在此处输入图像描述](../Images/79f67f5a9f5d24dab79cd10d2c2acac7.png)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-23T05:41:24.080

根据我的发现，设备中添加的第一个谷歌帐户是与 android 市场相关联的主要谷歌地址。此外，我们按照在设备中添加的顺序获取 google 帐户。因此，accounts[0] 将是添加的第一个电子邮件 ID。

```
String marketAssociatedEmailId = "";
Account[] accounts = AccountManager.get(context).getAccountsByType("com.google");
if(accounts.length > 0) {
  marketAssociatedEmailId = accounts[0].name;
} 
```

同样，我不确定这一点。您必须自己使用各种场景进行测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T09:16:04.593

对话框

![在此处输入图像描述](../Images/20204084b0706be8b41ed5ef2db7ce2f.png)

是由Google 帐户身份验证器中的[AbstractAccountAuthenticator#getAccountRemovalAllowed实现引起的。](http://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html#getAccountRemovalAllowed%28android.accounts.AccountAuthenticatorResponse,%20android.accounts.Account%29)

`AbstractAccountAuthenticator`由于仅系统权限阻止了直接调用实现，因此`android.permission.ACCOUNT_MANAGER`您将很难自己找到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T06:00:49.310

“关联”将由 Android Market/Google Play 应用程序管理，我认为它没有任何公共 API 可以告诉您它使用哪些帐户。此外，在最近的版本中，它可以使用多个帐户，因此手机上的任何 Google 帐户都可以与 Market/Play 商店应用程序一起使用。

你究竟为什么要这样做？为了能够“安全地”删除帐户？用户将收到适当的错误消息，因此他们应该能够决定是否删除该帐户。

# java - Memcache服务过期

> ID：10606978
> 
> 赞同：1
> 
> 时间：2012-05-15T18:48:41.720
> 
> 标签：java, google-app-engine, memcached

在 Java 中使用 GAE 增加 Memcache 中对象的过期时间的最佳方法是什么？

我将尝试再次设置对象，但这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:36:41.567

memcache 使用最近最少使用的驱逐算法。如果您查询对象，它应该会导致它保留更长时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:53:07.393

如果您设置了明确的过期时间，则使用新的过期时间再次存储记录将更新过期时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T06:47:35.870

如前面的答案中所述，使用新的到期时间再次设置它。但是您还应该关注所选的新到期时间。您的到期时间还必须在考虑数据及其新鲜度的情况下生成。

# javascript - 通过 ajax/jQuery 向服务器发出 ajax POST 请求

> ID：10606979
> 
> 赞同：2
> 
> 时间：2012-05-15T18:48:45.310
> 
> 标签：javascript, jquery, ajax, cross-domain, http-post

我正在尝试通过 ajax 将发布请求发送到另一个域并获得 json 响应。服务器位于我公司的场所，通过日志，我可以看到它正在发送带有 json 的响应。

以下是我的尝试示例：

1)

```
function makeRequest(strURL){
    $.get(strURL+"?callback=rest.draw_table_dyn", "{}", 
    function(resp){
        rest.draw_table_dyn(resp);
    });
} 
```

2)

```
xmlhttpPost : function(strURL) {
var xmlHttpReq = false;
var self = this;
if (window.XMLHttpRequest) {
    self.xmlHttpReq = new XMLHttpRequest();
    }
else if (window.ActiveXObject) {
    self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
    }
self.xmlHttpReq.open('POST', strURL, true);
self.xmlHttpReq.setRequestHeader("Content-Type", "application/json");
self.xmlHttpReq.onreadystatechange = function() {
    rest.draw_table_dyn(self.xmlHttpReq.responseText);
}
self.xmlHttpReq.send(null);
} 
```

但是，以下是我遇到的问题：

1）服务器总是被“OPTIONS”请求而不是“GET”或“POST”请求击中。我从这个链接（http://engin.bzzzt.biz/2010/01/25/cross-domain-xhr-access-control-preflight/）了解到这是一个符合标准的预检请求。

但是我可以发出 POST 请求吗？我尝试使用 $.post、$.ajax 甚至 $.get，但无济于事。

2) 响应数据为空。我需要数据来用项目填充页面。有没有办法读取json？目前我只得到一个返回状态为 0 的空字符串。

我尝试了 xmlHttpRequest、$.ajax、$.get 和 $.post 来发送请求并接收 json 无济于事。

我在这里（http://stackoverflow.com/questions/4221458/how-to-make-a-jsonp-call-to-an-api-using-jquery）阅读了关于将脚本保存在标签中的信息。这对我也不起作用。有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:13:33.687

目前，通过 Ajax 到另一个源的唯一方法`POST`是服务器使用适当的[CORS](http://www.w3.org/TR/cors/) `Allow-*`标头进行响应：

```
Access-Control-Allow-Origin: your.origin 
```

如果没有这样的标头，浏览器将由于[Same-Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)拒绝请求。

> 在您的第一个示例中，您似乎正在尝试使用 JSONP ( `?callback=...`)。此类请求受到严格限制，`GET`因为它们是通过将新`<script>`元素附加到页面而不是通过`XMLHttpRequest`：
> 
> ```
> <script src="http://remote.origin/resource?callback=rest.draw_table_dyn"></script> 
> ```

CORS 的浏览器支持也[仅限于](http://caniuse.com/cors)使用`XMLHttpRequest Level 2`or `XDomainRequest`(IE8/9) 的浏览器。

除此之外，您仅限于必须创建一个在浏览器和远程服务器之间进行调解的[服务器端代理。](http://ajaxpatterns.org/Cross-Domain_Proxy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:06:11.133

可以使用 $.post 和 $.ajax 发出 POST 请求。使用 $.ajax 并为“成功”和“失败”提供函数。在“错误”函数中读取错误消息。这应该让您了解 ajax 请求失败的原因。

我的猜测是 ajax 请求返回 404 错误。

PS $.get 和 $.post 是 $.ajax 的简写版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:09:20.807

[由于同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您不能对位于您的站点（不同域）之外的页面进行 ajax 调用

有一些[可用](https://stackoverflow.com/questions/3506208/jquery-ajax-cross-domain)的解决方法，包括使用 JSONP 作为数据类型。

# c++ - 使用 llvm-gcc 4.x 安装 srilm 1.6.0 时出现问题

> ID：10606983
> 
> 赞同：2
> 
> 时间：2012-05-15T18:49:08.380
> 
> 标签：c++, build, installation, nlp

# 问题

我正在尝试在我的 Mac 上构建[SRI 的语言建模工具](http://www.speech.sri.com/projects/srilm/)，`srilm`版本 1.6.0，并遇到了一些相当奇怪的编译问题（“奇怪”，几个小时的 Google-fu 没有帮助），所以我转向你看看是否有人看到我如何解决这个问题。

我已经[检查了我是否拥有所需的依赖项，并按照安装说明进行操作](http://www.speech.sri.com/projects/srilm/docs/INSTALL)，并浏览[了 FAQ 的构建故障排除部分](http://www-speech.sri.com/projects/srilm/manpages/srilm-faq.7.html)。

# 系统规格

我有一个非常普通的 OS X 安装，其中一些软件包是通过自制软件安装的。XCode 4.3.2（最新版本）已安装。以下是其他相关的系统详细信息。

## 操作系统版本

Mac OS X 10.7.4

## `gcc -v`打印出

```
$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/local/libexec/gcc/x86_64-apple-darwin11.0.0/4.6.1/lto-wrapper
Target: x86_64-apple-darwin11.0.0
Configured with: ../gcc-4.6.1/configure --enable-languages=fortran,c++
Thread model: posix
gcc version 4.6.1 (GCC) 
```

## `g++ -v`打印出

```
$ gcc -v
Using built-in specs.
COLLECT_GCC=g++
COLLECT_LTO_WRAPPER=/usr/local/libexec/gcc/x86_64-apple-darwin11.0.0/4.6.1/lto-wrapper
Target: x86_64-apple-darwin11.0.0
Configured with: ../gcc-4.6.1/configure --enable-languages=fortran,c++
Thread model: posix
gcc version 4.6.1 (GCC) 
```

## `uname -a`打印出

```
$ uname -a
Darwin MacBook-Air.local 11.4.0 Darwin Kernel Version 11.4.0: Mon Apr  9 19:32:15 PDT 2012; root:xnu-1699.26.8~1/RELEASE_X86_64 x86_64 
```

# 错误本身

以下是`make World`从 srlim 顶级目录运行产生的输出的结尾。在以下任何情况下，到目前为止的所有内容都可以正常编译：

*   我`make World`自己跑。
*   我跑`make World MACHINE_TYPE=macosx`
*   我运行`make World MACHINE_TYPE=macosx-m64`（64 位处理器的特定生成文件）
*   我运行`make World MACHINE_TYPE=macosx-m32`（32 位处理器的特定生成文件）

而且弹出的错误总是一样的（如下图）。

## `stderr`打印出

```
$ make World

(...) # a bunch of stuff compiles with no errors or warnings

c++ -Wreturn-type -Wimplicit -DINSTANTIATE_TEMPLATES -DHAVE_ZOPEN  -I/usr/include -I. -I../../include -DHAVE_ZOPEN   -c -g -O2 -fno-common -o ../obj/macosx/LatticeIndex.o LatticeIndex.cc
LatticeIndex.cc:78:6: error: variable length array of non-POD element type
      'NBestWordInfo'
            makeArray(NBestWordInfo, roundedNgram, len + 1);
            ^
../../include/Array.h:93:33: note: expanded from macro 'makeArray'
# define makeArray(T, A, n)             T A[n]
                                           ^
LatticeIndex.cc:126:4: warning: data argument not used by format string
      [-Wformat-extra-args]
                        (float)ngram[0].start);
                        ^
LatticeIndex.cc:128:4: warning: data argument not used by format string
      [-Wformat-extra-args]
                        (float)(ngram[len-1].start + ngram[len-1].duration));
                        ^
2 warnings and 1 error generated.
make[2]: *** [../obj/macosx/LatticeIndex.o] Error 1
make[1]: *** [release-libraries] Error 1
make: *** [World] Error 2 
```

知道可能出了什么问题吗？它似乎在我部门的其他一些人的 mac 上编译得很好，我检查了他们的 makefile 是否存在差异，但没有弹出任何内容。这里没有人知道构建失败的原因，但如果您能帮助我们，我们将不胜感激。提前感谢您为我提供的任何帮助！:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:55:59.820

问题是由于 Apple 使用了不支持可变长度数组的 llvm-gcc/clang。这个问题实际上可以通过修改 $SRILM/dstruct/src/Array.h 来解决，并且在即将发布的`srilm`.

目前，在 mac 上，`srilm`使用 g++ 4.2 构建，使用以下命令：

```
$ make MACHINE_TYPE=macosx-m64 CXX=g++-4.2 World 
```

这`srilm`在我所有的 Mac 上都没有问题。

# java - Java如何控制动画GIF？

> ID：10606992
> 
> 赞同：1
> 
> 时间：2012-05-15T18:49:53.203
> 
> 标签：java, controls, delay, gif, animated-gif

例如，有没有办法将动画 GIF 添加到 JButton 并控制它？例如：

*   在第 1 帧暂停，然后使其显示第 2 帧（在第 2 帧暂停）
*   设置帧动画之间的延迟
*   到达终点时停止（不重播）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:28:51.750

我从来没有理由分解 GIF，但据我所知，Java 可以访问 GIF 的每一帧。

无论您的解决方案是什么，都需要一些编码。是多还是少在很大程度上取决于您的要求和您的编码技能。

在互联网上达到顶峰，有人说 javax.imageio.ImageReader 可以做你想做的事：http: [//docs.oracle.com/javase/6/docs/api/javax/imageio/ImageReader.html](http://docs.oracle.com/javase/6/docs/api/javax/imageio/ImageReader.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:19:58.357

我知道[本教程](http://docs.oracle.com/javase/tutorial/uiswing/components/slider.html)不是关于 gif 动画，而是关于滑块，但你也许可以从中收集到一些东西。

# asp.net - 动态用户控件中的超链接

> ID：10606994
> 
> 赞同：0
> 
> 时间：2012-05-15T18:50:14.233
> 
> 标签：asp.net, html, user-controls, hyperlink

我有一个 userControl 被动态添加到我的表单中，从 1 到 20 次不等。该控件包含超链接字段（可见）和引用字段（不可见）。问题是超链接没有将引用字段的值作为链接页面参数传递。

userControl 代码如下所示：

```
 <asp:Hyperlink ID="childLink" Enabled="true" DataNavigateUrlFields="aSeq" 
DataNavigateUrlFormatString="~/Header.aspx?aSeq={0}" NavigateUrl="~/Header.aspx"
 runat="server><%# DataBinder.Eval(Container, "DataItem.cName") %> </asp:HyperLink> 
```

因此，超链接应该打开 Header 页面，传递“aSeq”字段的值，如下所示：

```
<asp:HyperLink ID="aSeq"  Enabled="true" DataNavigateUrlFields="aSeq" DataNavigateUrlFormatString="~/Header.aspx?aSeq={0}" NavigateUrl="~/Header.aspx" 
                runat="server"><%# DataBinder.Eval(Container,"DataItem.genePK") %></asp:HyperLink> 
```

它确实会转到 Header.aspx 页面的页面加载，但`Request.QueryString["aSeq"]`始终为 NULL。在 Page_Load 我有一小段代码：

```
string aRequest = Request.QueryString["aSeq"];
        if (aRequest==null)
        {
            PopulateHeader("GKEAAHDI");
        }
        else
        {
            PopulateHeader(aRequest);
        } 
```

我只能推测它没有得到标记为“aSeq”的字段的值。我使用了超链接，因为文本框不允许数据绑定器使用代码块。

我做了什么！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:56:38.967

根据 MSDN，“DataTextField 属性指定的字段的值作为查询字符串传递到格式字符串中指定的网页。” 所以你需要在你的 asp:hyperlink 声明中添加 DataTextField="aSeq" 。

没有测试，只是研究了一下。

# android - 我可以通过 Intents 调用符合 HIPAA 标准的 Android 应用程序

> ID：10606998
> 
> 赞同：0
> 
> 时间：2012-05-15T18:50:26.113
> 
> 标签：android, android-intent, hipaa

我公司的一位客户要求我们可以通过我们的 Android 应用程序提供符合 HIPAA 的 PDF 和媒体内容。我想知道是否有任何现有的应用程序可用于查看符合 HIPAA 的媒体和 PDF，我可以通过意图调用这些应用程序。我更愿意通过意图传递一个 URL 来流式传输内容，我可以控制它的安全性，或者一个加密的文件和意图的密钥。

我对符合 HIPAA 需要做的事情的理解是确保我们永远不会将这些媒体/PDF 文件保存到磁盘，或者如果我们这样做了，我们会对其进行加密。

就媒体内容而言，我目前可以在 MediaPlayer 中播放媒体内容，但经过一些研究后，我没有发现 MediaPlayer 内部实现是否符合 HIPAA 的信息。我已经尝试挖掘 Video 和 MediaPlayer 的来源，如果这将任何内容存储在设备的内部存储中，则无法得出任何结论。

对于 PDF，我完全依赖 3rd 方应用程序来下载和查看 PDF 文件。

备份解决方案是包含媒体/PDF 的第 3 方应用程序，并修改任何需要更改以符合 HIPAA 的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T21:52:56.307

在 Android 生态系统中，第三方和 HIPAA 合规性几乎是相互排斥的。

通过触发一个意图，您将下一个操作委托给操作系统和用户——您对启动什么应用程序的控制非常有限，尽管不太可能，您很可能最终将 PHI 传递给*Sketchy NSA Phone-Home PDF 刮板临*™。

诚然，我不确定软件的责任在哪里结束，最终用户的责任从 HIPAA 开始。

永远不要说永远，但您可能需要将阅读器合并到您的应用程序中。