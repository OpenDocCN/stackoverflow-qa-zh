# StackOverflow 问答 000474000-000474999

# c++ - 浮点到二进制值（C++）

> ID：474007
> 
> 赞同：20
> 
> 时间：2009-01-23T18:45:28.580
> 
> 标签：c++, binary, floating-point, ieee-754

我想在 C++ 中获取一个浮点数，例如 2.25125，以及一个填充了二进制值的 int 数组，该二进制值用于将浮点数存储在内存中（IEEE 754）。

所以我可以取一个数字，最后得到一个带有浮点二进制值的 int num[16] 数组： num[0] 将是 1 num[1] 将是 1 num[2] 将是 0 num[3 ] 将是 1 等等...

将 int 放入数组并不困难，只是获取浮点数的二进制值的过程就是我卡住的地方。您可以只读取浮点变量的内存中的二进制文件吗？如果没有，我怎么能在 C++ 中做到这一点？

编辑：以这种方式进行比较的原因是我想学习在 C++ 中进行按位运算。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-23T19:01:18.753

使用联合和位集：

```
#include <iostream>
#include <bitset>
#include <climits>

int main()
{
    union
    {
        float input; // assumes sizeof(float) == sizeof(int)
        int   output;
    } data;

    data.input = 2.25125;

    std::bitset<sizeof(float) * CHAR_BIT> bits(data.output);
    std::cout << bits << std::endl;

    // or
    std::cout << "BIT 4: " << bits[4] << std::endl;
    std::cout << "BIT 7: " << bits[7] << std::endl;
} 
```

它可能不是数组，但您可以使用 [] 运算符访问位，就像使用数组一样。

输出

```
$ ./bits
01000000000100000001010001111011
BIT 4: 1
BIT 7: 0 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-23T18:47:55.673

```
int fl = *(int*)&floatVar; //assuming sizeof(int) = sizeof(float)

int binaryRepresentation[sizeof(float) * 8];

for (int i = 0; i < sizeof(float) * 8; ++i)
    binaryRepresentation[i] = ((1 << i) & fl) != 0 ? 1 : 0; 
```

## 解释

`(1 << i)`将 value `1`,`i`位向左移动。`&`运算符计算操作数的按*位和*。

循环对浮点数中的 32 位中的每一个`for`运行一次。每次，`i`将是我们要从中提取值的位数。我们计算数字 和 的按位和`1 << i`：

假设数字是：1001011，并且`i = 2`

`1<<i`将等于 0000100

```
 10001011
& 00000100
==========
  00000000 
```

如果`i = 3`那时：

```
 10001011
& 00001000
==========
  00001000 
```

基本上，结果将是一个数字，`i`第 th 位设置为`i`原始数字的第 th 位，所有其他位为零。结果将为零，这意味着`i`原始数字中的第 th 位为零或非零，这意味着实际数字的`i`第 th 位等于`1`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-19T00:49:58.410

其他方法，使用 stl

```
#include <iostream>
#include <bitset>

using namespace std;
int main()
{
    float f=4.5f;
    cout<<bitset<sizeof f*8>(*(long unsigned int*)(&f))<<endl;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T18:49:18.010

如果您需要特定的浮点表示，则必须从浮点本身语义上构建它，而不是通过位复制。

c0x 标准： [http](http://c0x.coding-guidelines.com/5.2.4.2.2.html) ://c0x.coding-guidelines.com/5.2.4.2.2.html没有定义浮点数的格式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T18:50:24.530

> 您可以只读取浮点变量的内存中的二进制文件吗？

是的。静态将指向它的指针转换为 int 指针并从结果中读取位。C++ 中的 IEEE 754`float`类型是 32 位。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-23T18:57:07.230

您可以使用 unsigned char 将浮点逐字节读取到整数数组中：

```
unsigned int bits[sizeof (float) * CHAR_BIT];
unsigned char const *c = static_cast<unsigned char const*>(
    static_cast<void const*>(&my_float)
);

for(size_t i = 0; i < sizeof(float) * CHAR_BIT; i++) {
    int bitnr = i % CHAR_BIT;
    bits[i] = (*c >> bitnr) & 1;
    if(bitnr == CHAR_BIT-1)
        c++;
}

// the bits are now stored in "bits". one bit in one integer. 
```

顺便说一句，如果您只想比较位（当您评论另一个答案时），请使用`memcmp`：

```
memcmp(&float1, &float2, sizeof (float)); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-23T20:15:02.910

查看此答案（[浮点到二进制值（C++）](https://stackoverflow.com/questions/474007/floating-point-to-binary-valuec#474014)）中的注释，这样做的原因是对两个值进行按位比较。

```
#include <iostream>

int main()
{
    union Flip
    {
         float input;   // assumes sizeof(float) == sizeof(int)
         int   output;
    };

    Flip    data1;
    Flip    data2;
    Flip    data3;

    data1.input = 2.25125;
    data2.input = 2.25126;
    data3.input = 2.25125;

    bool    test12  = data1.output ^ data2.output;
    bool    test13  = data1.output ^ data3.output;
    bool    test23  = data2.output ^ data3.output;

    std::cout << "T1(" << test12 << ") T2(" << test13 << ") T3(" << test23 << ")\n";

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-23T18:48:15.923

将 int 指针转换为浮点指针，就完成了。

（虽然我不会将它声明为 int 数组。我会使用 void* 来明确表示内存正被用作其他值的转储场。）

顺便说一句，你为什么不直接使用浮点数组呢？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-23T18:55:25.237

创建 float 和 unsigned long 的联合。设置 float 成员的值并遍历 unsigned long 值的位，如其他答案中所述。

这将消除演员阵容。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-04T08:51:13.117

您也可以使用强制转换指针来做到这一点。这是一个小例子

```
#include <iostream>
#include <bitset>

using namespace std;

int main(){
    float f = 0.3f;
    int* p = (int*)&f;
    bitset<32> bits(*p);
    cout << bits << endl;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-28T05:20:43.827

好吧，我不相信 C++ 有任何真正安全的方式来存储浮点数而不会出现某种问题。在机器之间移动时，既高效又易于存储，无需使用大存储容量。

它非常准确，但它不支持真正疯狂的值。在任何位置，您最多可以有 7 位数字，但两边不能超过 7 位数字。对于左侧，您将收到不准确的结果。在右侧，您会在读取期间收到错误消息。要解决该错误，您可以在写入期间抛出错误或在读取时执行“buffer[idx++] & 0x7”，以防止其超出 0 和 7 范围。请记住，“& 0x7”仅有效，因为它是 2 减 1 的幂。即 2^3 - 1。您只能使用这些值来执行此操作，例如 0、1、3、7、15、31、63、127、255、511、1023 等...

因此，是否要使用它取决于您。我觉得这是获得您所需要的大多数价值的安全方式。下面的示例显示了如何将其转换为 4 字节数组，但对于 C++，这将是一个 char*。如果您不想执行除法，您可以将 POWERS_OF_TEN 数组转换为带有小数和倍数的辅助数组。

```
const float CacheReader::POWERS_OF_TEN[] = 
{
    1.0F, 10.0F, 100.0F, 1000.0F, 10000.0F, 100000.0F, 1000000.0F, 10000000.0F
};

float CacheReader::readFloat(void)
{
    int flags = readUnsignedByte();
    int value = readUnsignedTriByte();
    if (flags & 0x1)
        value = -value;
    return value / POWERS_OF_TEN[(flags >> 1) & 0x7];
}

unsigned __int32 CacheReader::readUnsignedTriByte(void)
{
    return (readUnsignedByte() << 16) | (readUnsignedByte() << 8) | (readUnsignedByte());
}

unsigned __int8 CacheReader::readUnsignedByte(void)
{
    return buffer[reader_position] & 0xFF;
}

void CacheReader::writeFloat(float data)
{
    int exponent = -1;
    float ceiling = 0.0F;

    for ( ; ++exponent < 8; )
    {
        ceiling = (POWERS_OF_TEN[exponent] * data);
        if (ceiling == (int)ceiling)
            break;
    }

    exponent = exponent << 0x1;
    int ceil = (int)ceiling;
    if (ceil < 0)
    {
        exponent |= 0x1;
        ceil = -ceil;
    }
    buffer[writer_position++] = (signed __int16)(exponent);
    buffer[writer_position++] = (signed __int16)(ceil >> 16);
    buffer[writer_position++] = (signed __int16)(ceil >> 8);
    buffer[writer_position++] = (signed __int16)(ceil);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-28T15:17:54.937

这是我没有给出任何警告的解决方案：

```
int32_t floatToIntBits(float f)
{
    char * c = (char*)&f;
    int32_t i = 0;
    i |= (int32_t)((c[3] << 24)     & 0xff000000);
    i |= (int32_t)((c[2] << 16)     & 0x00ff0000);
    i |= (int32_t)((c[1] << 8)      & 0x0000ff00);
    i |= (int32_t)((c[0])           & 0x000000ff);
    return i;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-07-16T18:52:20.380

最简单的方法：

```
float myfloat;
file.read((char*)(&myfloat),sizeof(float)); 
```

# qt - Blinking background cell in a model

> ID：474011
> 
> 赞同：3
> 
> 时间：2009-01-23T18:47:12.663
> 
> 标签：qt, qvariant

I am confused about the `setData` in data methods for my custom role (`IsBlinkingRole`). I've tried different options but every option failed.

```
bool CustomSqlModel::setData( const QModelIndex& index, const QVariant& value, int role)
{
     if (role == IsBlinkingRole && index.column() == 0 && index.isValid()) {
           //What to put here ?

            emit dataChanged(index, index);
         return true;
     }
     return false;
} 
```

```
QVariant CustomSqlModel::data(const QModelIndex& index, int role) const
{
    QVariant value = QSqlTableModel::data(index, role);
    if (role == Qt::BackgroundRole && index.column() == 0) {
        QModelIndex testIndex = index.model()->index(index.row(), 0, index.parent());
        if ( index.model()->data(testIndex, Qt::DisplayRole).toInt() == 5)
            return QVariant(QColor(Qt::red));
        else
            return QVariant();
    }
    return value;

}

void CustomSqlModel::timerEvent(QTimerEvent *)
{   
    static bool blinkon = true;
    blinkon = !blinkon;
    int topRow = rowCount();
    int bottomRow = -1;
    for(int i = 0; i < rowCount(); i++) {
        for(int j = 0; j < columnCount(); j++) {
            if(data(index(i, j), IsBlinkingRole).toBool()){
                if(blinkon)
                    setData(index(i, j), Qt::red, Qt::BackgroundRole);
                else
                    setData(index(i, j), QVariant(), Qt::BackgroundRole);
                if(i < topRow) topRow = i; if(i > bottomRow) bottomRow = i;
            }
        }
    }
    if(bottomRow >= 0)
        emit dataChanged(index(topRow, 0), index(bottomRow, columnCount()-1));

} 
```

The problem I have with the `setData` method is regarding what kind of code I need to put here.

Do I have to create a container first to store data?

# linq-to-sql - 使用 Linq 表达式树设计灵活的高级搜索的模式或技术

> ID：474028
> 
> 赞同：1
> 
> 时间：2009-01-23T18:51:57.147
> 
> 标签：linq-to-sql, entity-framework, linq-to-entities, lambda, expression-trees

我希望在我的 ASP.NET/SQL Server 2005 应用程序中添加“高级搜索”功能。理想情况下，我希望它是表驱动的。例如，如果我的架构随着向要搜索的表中添加新列而发生变化，我希望 UI 将新列的添加反映为可搜索字段。我可以设想一些包含可搜索字段、它们的类型、相关查找等的控制表。

构建 UI 时可以参考这些表。我的问题在于**创建动态 SQL 的最佳方法**。一种方法是自己构造一个参数化的 SQL 语句。但我对 Linq 很感兴趣，不知何故，我认为 System.Linq.Dynamic 命名空间——以及**Linq 表达式树**——可能会提供更优雅/更强大的解决方案？

希望任何此类解决方案都适用于 Linq to Sql 或 Linq to Entities。我调查这条路径是否正确，或者这个问题空间是否真的不是表达式树的用例之一？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T22:05:15.213

您可以使用表达式树，通过构建一个树来比较架构中的所有字段，然后将该表达式传递给 Linq2Sql 以获取您想要的 sql。但是为什么要打扰呢？这是更多的编程工作，代码将更难理解，除了交换数据​​提供者的理论能力之外没有任何好处。

（嘿霍华德） - 确实 - 在这种情况下使用字符串将比使用表达式树简单得多。另一方面，如果您要为用户提供一种小型查询语言，那么表达式树就会派上用场。

# python - 哪个 GTK 小部件组合用于可滚动的小部件列？

> ID：474034
> 
> 赞同：4
> 
> 时间：2009-01-23T18:53:35.773
> 
> 标签：python, gtk, pygtk, widget

我正在使用 PyGTK，试图提出一个小部件的组合，这些小部件将执行以下操作：

*   让我在一列中添加无数个小部件
*   提供垂直滚动条以到达底部的滚动条
*   调整窗口大小时，调整小部件的宽度以填充可用的水平空间

谢谢 - 我是 GTK 的新手。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T19:23:01.063

*   列中无数的小部件：听起来像 GtkVBox。
*   垂直滚动条：将您的 VBox 放在 GtkScrolledWindow 中。
*   水平拉伸：这需要为 VBox、ScrolledWindow 和其他小部件设置适当的属性。至少在 Glade 中，默认值似乎主要处理这个问题（您可能想要更改 ScrolledWindow 的滚动条策略）。

现在是诀窍。如果您只是按照我上面列出的方式进行操作，VBox 的内容将尝试垂直和水平调整大小，并且您将无法获得滚动条。解决方案是将您的 VBox 放在 GtkViewport 中。

所以最终的层次结构是 ScrolledWindow(Viewport(VBox(widgets)))。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-26T06:54:52.347

史蒂夫在代码中所说的：

```
vbox = gtk.VBox()
vbox.pack_start(widget1, 1, 1) ## fill and expand
vbox.pack_start(widget2, 1, 1) ## fill and expand
vbox.pack_start(widget3, 1, 1) ## fill and expand
swin = gtk.ScrolledWindow()
swin.add_with_viewport(vbox) 
```

# raku - 如何开始使用 Perl 6？

> ID：474037
> 
> 赞同：12
> 
> 时间：2009-01-23T18:55:03.430
> 
> 标签：raku, rakudo, parrot, pugs

我想听听您对如何开始使用 Perl 6 的看法？应该使用在 Parrot 上构建的 Rakudo 还是更好地使用 Pugs 实现？

如果是 Rakudo，最好的安装方法是什么？Parrot 的月度版本，来自 Parrot 的 SVN，其他？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-23T21:34:21.673

注意我回答的日期。我会把它留在这里，但世界不再是这样了。见[raiph 的回答](https://stackoverflow.com/a/29378102/2766176)。

* * *

我建议使用[Parrot 网站](http://www.parrot.org/)或[CPAN 上的 parrot 发布](http://search.cpan.org/dist/parrot)的最新月度版本的鹦鹉。我发现有时trunk/中的最新内容无论出于何种原因都不起作用。这只是开始。

一旦你开始并且足够勇敢，最前沿的东西可能更合适。[Parrot 下载页面](http://www.parrot.org/download)包含存储库详细信息。

但是请注意，您不应该安装 parrot。除非自从我上次查看以来他们已经修复了这个问题，否则安装 parrot 会扰乱构建过程。在它的源目录中创建它，但不要使用安装目标。您仍然可以构建语言/perl6 并创建 perl6 目标并将其安装在您喜欢的位置。

我放弃了 Pugs，因为安装最新的 GHC 总是那么痛苦。虽然我已经有一段时间没有看它了，但是每个新的 Pugs 版本似乎都需要 GHC 升级。也许现在更理智了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-06T09:46:31.270

在我第一次访问 irc.freenode.org 的 #perl6 之后，我得到了对同一问题的以下答案：

*   [Perl 5 到 Perl 6](http://perlgeek.de/en/article/5-to-6)
*   [降临日历](http://perl6advent.wordpress.com/2009/12/01/perl-6-advent-calendar/)
*   [概要](http://perlcabal.org/syn/)
*   [RFC](http://dev.perl.org/perl6/rfc/)
*   [乐道书](http://github.com/perl6/book)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-18T15:00:31.113

我建议使用每月 Rakudo Star 版本：[http:](http://rakudo.org/downloads/star) //rakudo.org/downloads/star Rakudo Star 包括 Rakudo Perl 6、MoarVM、panda 和一些 Perl 6 模块。2015 年 2 月的版本将是最后一个包含 parrot VM 的版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-31T20:37:35.463

加入[freenode IRC 频道 #perl6](https://kiwiirc.com/client/irc.freenode.net/perl6)以使用在线评估机器人和/或获得任何形式的帮助。欢迎大家。

如果你想在 Perl 5 中使用 Perl 6——加载 Perl 6 模块，使用 Perl 6 对象，编写 Perl 6 代码——考虑尝试新的[Inline::Perl6](https://metacpan.org/pod/Inline::Perl6)（CPAN 上的一个 Perl 5 模块，它包装和嵌入Rakudo-on-MoarVM Perl 6 编译器）。

如果您想安装最新的、经过测试的、稳定的编译器/文档/模块捆绑版本，请尝试[Rakudo Star](http://rakudo.org/downloads/star/)发行版。

有关代码，请参阅[示例](https://github.com/perl6/perl6-examples)、[RosettaCode](http://rosettacode.org/wiki/Category:Perl_6)、[learnXinYminutes](http://learnxinyminutes.com/docs/perl6/)和[Perl 6 Advent Calendars](https://perl6advent.wordpress.com/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T19:37:16.010

乐藤，SVN。

我很确定你已经知道了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-30T00:22:18.420

安装 Rakudo 是开始在 Perl 6 中编程的最佳方式。Rakudo 是一个 Perl 6 编译器和实现。

我个人建议使用 rakudobrew 安装管理器安装 Rakudo，因为它简化了安装过程。按照这里的说明[https://github.com/tadzik/rakudobrew](https://github.com/tadzik/rakudobrew)。除了安装 Rakudo 和 MoarVM 之外，它还将安装 Panda，它是一个 Perl 6 模块安装程序。

您想了解的有关 Perl 6 的所有信息都可以在[http://perl6.org/](http://perl6.org/)上找到。

# nhibernate - 如何构造这个 NHibernate 查询

> ID：474044
> 
> 赞同：1
> 
> 时间：2009-01-23T18:57:20.147
> 
> 标签：nhibernate, hql

我有一对多的关系。我想构造这个查询：

给我所有只有一个孩子的父母和这个孩子`child.Type=X`

由于我正在学习，请向我展示使用 Criteria API 和 HQL 的查询。

顺便说一句，是否有任何自动方法可以知道 HQL 与标准表达式相同？

**更新：**

看来我找到了如何在 HQL 中做到这一点：

```
@"select Parent
    from Parent parent
        join parent.Children ch
        where (ch.Type = :chType) and
              (select count(*) from parent.Children) = 1") 
```

但它做得好吗？表现如何？我的直觉是 count(*) 位置不太好......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T20:10:23.323

同意@David Pellerin 关于问题的模糊性。然而，我实际上*只是*在整理关于这个主题的午餐'n'Learn，所以使用典型的客户，订单关系。. .

标准 API：

```
public IList<Customer> GetCustomersWithOrdersAfterDate(DateTime sinceDate)
{
   return Session.ICriteria.CreateCriteria(typeof(Customer))
      .CreateCriteria("Orders")
      .Add(Expression.Gt("OrderDate", sinceDate))
      .List<Customer>();
} 
```

HQL（看起来很像 SQL，只是你不必知道整个关系图）：

```
public IList<Customer> GetCustomersWithOrdersAfterDate(DateTime sinceDate)
{
    Session.CreateQuery("select c from Customer c, c.Orders.elements o WHERE o.OrderDate > :orderDate).SetDateTime("orderDate", sinceDate).List<Customer>();
} 
```

顺便说一句：
如果您只是在学习，请停止您正在做的一切并观看[这些截屏视频](http://www.summerofnhibernate.com)。可能是我看过的关于 nHibernate 的最好的一组视频。强烈推荐，强烈推荐。

解决您的“计数 = 1”要求的另一个有用链接是[此处](http://www.nablasoft.com/alkampfer/index.php/2008/02/27/nhibernate-icriteria-count-and-the-missing-of-having-clause/)。相当复杂，但我已经成功地改编了类似的东西。

# mysql - 如何从 mysqldump 获得与 mysqladmin/backup 完全相同的输出

> ID：474046
> 
> 赞同：0
> 
> 时间：2009-01-23T18:57:50.100
> 
> 标签：mysql, mysqldump, mysqladministrator

在一个非常重要的 Windows 服务器上，我们使用 mysqladmin 实用程序设置的计划任务来备份我们的关键数据。

我想使用更简单的 mysqldump 命令，但我想确保输出相同。大概 mysqladmin 和 mysqldump 都共享一个共同的核心转储组件，因此对于 mysqladmin 中的任何给定设置，我应该能够找到 mysqldump 产生**完全相同输出**的配置。

但是怎么做？

目前我正在尝试和错误 - 但有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T19:05:05.780

我会先用 mysqladmin 转储一些短表，用 mysqldump 转储相同的表。Then I would check the differences and find the appropriate options to use using the [mysqldump manual](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T19:36:30.320

MySQL Administrator 实际上并没有使用与 mysqldump 相同的核心转储能力。出于某种原因，它被重新实现（并且通常比 mysqldump 使用的情况更糟）。

所以我建议你选择你最想要的选项并在 mysqldump 中使用它们。

# c# - 如何/在哪里处理 Windows 服务中的 ConfigurationErrorsException？

> ID：474047
> 
> 赞同：3
> 
> 时间：2009-01-23T18:57:52.423
> 
> 标签：c#, windows-services, configuration-files

我有一个具有自定义配置部分的 Windows 服务。在 configSectionHandler 类中，我使用属性上的属性来验证设置，如下所示：

```
 //ProcessingSleepTime Property
    [ConfigurationProperty("ProcessingSleepTime", DefaultValue = 1000, IsRequired = false)]
    [IntegerValidator(MinValue = 5, MaxValue = 60000)]
    public Int32 ProcessingSleepTime
    {
        get
        {
            if (this["ProcessingSleepTime"] == null)
                return 100;

            return (Int32)this["ProcessingSleepTime"];
        }
        set
        {
            this["ProcessingSleepTime"] = value;
        }
    } 
```

如果配置文件中的值验证失败，则会引发 ConfigurationErrorsException。在 Windows 服务中，当它试图启动时会发生这种情况，而且它真的很难看（它提供启动调试器）。我怎样才能优雅地处理这个错误？我尝试将 OnStart 方法包装在 try/catch 中，但没有效果。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:36:11.633

Or better yet (as you might need multiple such a properties), using the code from @Ricardo Villiamil, create:

```
int GetIntFromConfigSetting(string settingName, int defaultValue)
{
   int retValue = defaultValue;
   if(this.ContainsKey(settingName))
   {
      int sleepInterval;
      if(Int32.TryParse(this[settingName], out sleepInterval)
      {
         retValue = sleepInterval;
      }
   }
   return retValue;
} 
```

Then use it from any property you need to.

EDIT: actually, after re-reading the question once more, looks like this solves your problem only half-way, as if the value is out of the defined range, it will throw exception anyway.

EDIT2: You can hook the [AppDomain.UnhandledException event](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx) in the static ctor of your config section handler. The static ctor is ran before any instance or static member of a class are accessed, so it guarantees that you will intercept the exception even if the main method of your service is not yet called.

And then, when you intercept and log the error, you can exit the service with some error code != 0 ( Environment.Exit(errorCode) ), so the service manager knows it failed, but not try to invoke a debugger.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T22:05:25.667

Ok I think I have it. In my service I have code that looks like this in the constructor:

config = ConfigurationManager.GetSection("MyCustomConfigSection") as MyCustomConfigSectionHandler;

This is where the error is thrown. I can catch the error and log it. The error must be rethrown in order to prevent the service from continuing. This still causes the ugly behavior but at least I can log the error thereby informing the user of why the service did not start

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-23T19:22:31.627

首先，检查您的配置是否包含您要查找的密钥，然后将其包装在 try catch 中，然后检查它是否为有效整数：

```
int retValue = 100;
if(this.ContainsKey("ProcessingSleepTime"))
{
    object sleepTime = this["ProcessingSleepTime"];
    int sleepInterval;
    if(Int32.TryParse(sleepTime.ToString(), out sleepInterval)
    {
       retValue = sleepInterval;
    }
}
return retValue; 
```

# entity-framework - 如何强制 ADO.NET Entity Framework 重新生成代码？

> ID：474050
> 
> 赞同：17
> 
> 时间：2009-01-23T18:58:40.583
> 
> 标签：entity-framework, wcf-data-services

我遇到了一个 ADO.NET 实体框架模型和一个使其可用的 ADO.NET 数据服务的障碍。模型和数据服务在脱离源代码控制时正在编译，没有任何问题或警告。但是，当我运行该服务时，出现以下错误： [![请求错误 - 服务器在处理请求时遇到错误。 有关更多详细信息，请参阅服务器日志。](https://i.stack.imgur.com/npsVr.jpg)](https://i.stack.imgur.com/npsVr.jpg)

不幸的是，没有服务器日志（我知道），因为这是 VS 2008 Web 开发服务器，并且确实没有任何代码可以调试.....通过一些试验和错误，生成的代码（模型.Designer.cs）在某种程度上已经过时了。如果我对 EDM 执行一些微不足道的更新以强制它重新生成代码文件，那么当我重新运行该服务时它就可以正常工作。

我试图删除 model.designer.cs 文件，希望在构建过程中项目/实体构建器会检测到丢失的文件并为我重新生成它。那没有发生.....有谁知道如何强制重新生成此代码？（不必将生成的代码置于源代码控制之下，这也会让我更开心一些。）

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-26T04:23:25.033

右键单击 EDMX 文件并选择运行自定义工具。

还有一个名为*edmgen*的命令行代码生成工具（可从 VS 命令提示符获得）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-06-05T17:58:38.223

在 Visual Studio 2017 中，看起来只是保存`.tt`文件会自动重新运行模板，更新实体类文件。

# c# - C# 等效于 getClassLoader().getResourceAsStream(...)

> ID：474055
> 
> 赞同：3
> 
> 时间：2009-01-23T19:00:17.443
> 
> 标签：c#, dll, embedded-resource

在 Java 中，您可以使用以下代码读取嵌入在 JAR 文件中的文件：

```
String file = "com/company/package/filename.txt";
InputStream is = ClassName.class.getClassLoader().getResourceAsStream(file); 
```

什么是上述代码的 C#/.NET 等效项 - 也就是说，我如何读取我嵌入在 DLL 中的文件？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T19:04:29.667

将文本文件添加为资源并为其分配 a`resourceName`后，然后：

```
 Assembly assembly = Assembly.GetExecutingAssembly();
 TextReader inputStream = new StreamReader(assembly.GetManifestResourceStream(resourceName));
 string result = inputStream.ReadToEnd(); 
```

注意：这来自[这个](http://gibbons.co.za/archive/2005/02/02/253.aspx)帖子

# c# - 如何通过泛型初始化数组？

> ID：474057
> 
> 赞同：2
> 
> 时间：2009-01-23T19:01:17.083
> 
> 标签：c#, generics

有没有办法通过泛型将数组的所有元素初始化为常量值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T19:21:06.060

就个人而言，我会使用一个好的、旧的 for 循环，但如果你想要一个单行，这里是：

```
T[] array = Enumerable.Repeat(yourConstValue, 100).ToArray(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T19:29:37.947

如果您需要经常这样做，您可以轻松编写一个静态方法：

```
public static T[] FilledArray<T>(T value, int count)
{
    T[] ret = new T[count];
    for (int i=0; i < count; i++)
    {
        ret[i] = value;
    }
    return ret;
} 
```

这样做的好处是您可以进行类型推断：

```
string[] foos = FilledArray("foo", 100); 
```

这比（否则整洁的） Enumerable.Repeat(...).ToArray() 答案更有效。在小案例中差异不会很大，但对于较大的数量可能会很重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T19:40:42.620

我会使用扩展器（.net 3.5 功能）

```
public static class Extenders
{
    public static T[] FillWith<T>( this T[] array, T value )
    {
        for(int i = 0; i < array.Length; i++)
        {
            array[i] = value;
        }
        return array;
    }
}

// now you can do this...
int[] array = new int[100];
array.FillWith( 42 ); 
```

# c++ - 编码风格 - 输入验证

> ID：474063
> 
> 赞同：2
> 
> 时间：2009-01-23T19:03:22.540
> 
> 标签：c++, coding-style

这是验证传递给函数的输入的最佳方法，即在进行类似操作之前是否验证所有输入

```
class A;
void fun(A* p)
{
  if(! p)
  {
    return;
  }

 B* pB = p->getB();
  if(! pB)
  {
    return;
  }

.......

} 
```

或者你是这样写的：

```
void fun(A* p)
{
  if(p)
  {
    B* pB = p->getB();
    if(pB)
    {
      .....
    }
  }
} 
```

我问这个是因为，如果我使用第一种样式，那么我的代码中会有多个返回语句，很多人说它们不好（不知道为什么），如果我使用第二种样式，那么级别就会太多嵌套在我的代码中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T19:13:48.790

第一种方法比第二种方法更容易阅读并且更简单（按深度）。在第二个中，复杂性和深度随着参数数量的增加而增加。但在第一个例子中，它只是线性的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T20:56:37.147

多重回报：人员和编码标准是双向的。在 C++ 中，imo 没有理由不喜欢多个返回（和异常），如果您使用的是 RAII 等。许多 C 编码标准强制执行单入口单出口以确保执行所有清理代码，因为没有RAII 和基于范围的销毁/资源清理。

[一个函数应该只有一个返回语句吗？](https://stackoverflow.com/questions/36707/should-a-function-have-only-one-return-statement)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T19:09:30.390

我更喜欢预先进行输入验证，但通常会同时执行所有测试

IE

```
if(!p || !p->getB()){
    return;
} 
```

如果函数需要输入，并且语言支持它，我会抛出 Argument Exceptions（请参阅 .NET ArgumentNullException、ArgumentException），以便代码在无效状态的情况下不会执行干净的返回。这让调用者知道参数不足以完成操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T19:57:54.113

我更喜欢第一个，因为我有一组宏来处理常见情况（并且通常同时断言用于调试目的）。这种方法的缺点是您的函数返回类型必须相当统一才能使您的宏使用统一；好处是用法/效果非常清楚。因此，例如，我的代码可能是：

```
class A;
void fun(A* p)
{
  ASSERT_NONZERO_RETURN_ON_FAIL( p );

  B* pB = p->getB();
  ASSERT_NONZERO_RETURN_ON_FAIL( pB );

  .......
} 
```

这会导致代码更具可读性，同时也会提醒您注意错误。此外，作为额外的好处，如果您发现您认为边际速度增加超过运行时检查的价值，您可以轻松地禁用签入发布版本。

补充说明：根据我的经验，有些人说函数的多个返回点不好的原因是因为他们在函数退出之前明确地进行资源取消分配，因此您不想复制取消分配代码。但是，如果您正确且统一地使用 RIIA，这应该不是问题。因为这也是我一直尝试做的事情，所以对我来说，多个返回点比嵌套更可取。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T00:32:42.063

我倾向于在方法的开头使用这些类型的检查和返回。这样我就可以 [通过合同](http://en.wikipedia.org/wiki/Design_by_contract)[前提条件](http://en.wikipedia.org/wiki/Precondition)和[断言来模拟](http://en.wikipedia.org/wiki/Assertion_(computing))[Eiffel](http://en.wikipedia.org/wiki/Eiffel_(programming_language))式设计，如 [Bertrand Meyer 的《](http://se.ethz.ch/~meyer)[面向对象的软件构建](http://archive.eiffel.com/doc/oosc/)》 一书 ，第二版，Prentice Hall 中所述。

对于您的示例，我将返回一个标识违规的枚举，而不是返回 void，例如：

```
enum Violation { inviolate = 0, p_unspecified_unavailable, p_B_unspecified_unavailable,..... };

Violation fun(A* p)
{
//__Preconditions:___________________________________
  if (! p)         return p_unspecified_unavailable:
  if (! p->getB()) return pB_unspecified_unavailable;
//__Body:____________________________________________
   ....
//__Postconditions: _________________________________
   ..(if any)..
   return inviolate;
} 
```

我的观点是，我认为前置条件（和任何后置条件）验证是对方法/函数主体的实现的一种包装，并且倾向于将控制条件逻辑的流程与主体的表达式区分开来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T19:15:57.350

理想情况下，您会通过引用传递，然后您就不必担心这一点。不过，这并不总是一种选择。否则，这是一个偏好问题。

我个人更喜欢第一个，因为我对多次退货并没有太大的问题。我认为函数基本上应该适合一两个屏幕，所以只要你有语法突出显示它应该不难看到所有函数的退出点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-23T19:20:46.730

我使用您发布的第一种方法，在大多数情况下，它允许我向用户提供：有意义的返回值或消息：

```
 btnNext_OnClick(...)
{
if(!ValidateData())
 return;

// do things here
}

boolean ValidateData()
{
if(!condition)
{
 MessageBox.Show("Message", "Title", MessageBoxButtons.OK, MessageBoxIcons.Information);
 return false;
}

return true;
} 
```

这样，当我添加需要表单级别验证的字段时，我可以在验证方法中添加另一个 if 语句检查。

# c# - 模型类型的强类型化 ASP.NET Controller.View() 方法

> ID：474065
> 
> 赞同：2
> 
> 时间：2009-01-23T19:03:46.657
> 
> 标签：c#, asp.net-mvc

没有返回 ActionResult 的强类型 View() 方法。所以，假设我有

```
class Edit : ViewPage<Frob> 
```

在我的 FrobController 中，我将执行类似“return View("Edit", someFrob);" 之类的操作。这里没有进行检查，所以我必须始终手动同步视图和控制器对它的使用。这是次优的，我不知道有任何内置修复。

我将此方法添加到我的控制器基类中：

```
public ActionResult ViewPage<V, M>(V view, M model)
    where V : ViewPage<M>
    where M : class {
    return View(typeof(V).Name, model);
} 
```

> 注意：我采用从未使用过的视图对象的原因是，AFAIK，没有办法让 C# 的类型推断以其他方式工作。如果我删除了 view 参数，我需要明确指定 V ，这也意味着也明确指定 M ......叹息。

所以现在，我可以这样做：

```
 return ViewPage(new Views.Frob.Edit(), myFrob); 
```

我指定了确切的视图（如果重命名也没问题），并且 myFrob 被类型检查为正确的模型类型。丑陋的一面是我新建了一个编辑。或者，我可以写：

```
 return ViewPage((Views.Frob.Edit)null, myFrob); 
```

一个缺点是模型必须完全匹配。因此，使用 ViewPage>，我无法传入列表。我认为这可能有效：

```
 public ActionResult ViewPage<V, M, T>(V view, T model)
        where V : ViewPage<M>
        where M : class 
        where T : M {
        return View(typeof(V).Name, model);
    } 
```

但是 C# 的类型推断却想不通。另一个潜在的问题是视图类型的名称可能不是正确的名称，因为我认为它可以被属性覆盖。但如果我遇到它，这很容易解决。

问题：

1.  我怎样才能使这个语法更干净？
2.  我在这里缺少什么缺点？

编辑：关于控制器知道视图，它只是稍微知道。它从视图中获得的唯一东西是类型，它为其获取名称。所以这相当于传入字符串名称。还有强类型模型，它必须匹配，否则会失败。所以它对 View 的了解并不多——它只是让编译器捕获错误的一个技巧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T19:11:35.627

我看到的第一个问题是你现在已经让你的控制器知道了视图。这是一条你永远不应该跨越的线。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T20:39:20.333

看看这个例子： http: [//oddiandeveloper.blogspot.com/2008/11/strongly-typed-view-names.html](http://oddiandeveloper.blogspot.com/2008/11/strongly-typed-view-names.html)

你可以像这样调用你的视图：

```
return View(typeof(Views.en.Home.about), AboutModel); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T03:39:26.663

我仍然在摸索你这样做的好处，而不是说你错了。Ayende 几乎每天都对我做同样的事情 :-) 无论如何，我能想到的最简洁的语法是这样的：

```
public ActionResult Test() {
    return View<Views.Module1.Test, string>("Hello All");
}

protected ActionResult View<TView, TModel>(TModel model)
    where TView : ViewPage<TModel>
    where TModel : class {
        return View(typeof(TView).Name, model);
} 
```

您牺牲了类型推断，但获得了完整的编译时类型检查，并且您不必新建未使用的对象。

# c# - 覆盖扩展方法

> ID：474074
> 
> 赞同：24
> 
> 时间：2009-01-23T19:05:49.757
> 
> 标签：c#

我一直在考虑使用扩展方法来替代抽象基类。扩展方法可以提供默认功能，并且可以通过将具有相同签名的方法放在派生类中来“覆盖”。

有什么理由我不应该这样做？

另外，如果我有两个具有相同签名的扩展方法，使用哪一个？有没有办法确定优先级？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-23T19:07:52.280

一般来说，您不应该通过扩展方法提供“基本”功能。它们应该只用于“扩展”类功能。如果您可以访问基类代码，并且您尝试实现的功能在逻辑上是继承层次结构的一部分，那么您应该将它放在抽象类中。

我的观点是，仅仅因为你*可以*并不意味着你*应该*。当普通的老式 OO 编程无法为您提供合理的解决方案时，最好坚持使用老式的 OOP 并使用较新的语言特性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-23T19:40:05.477

这绝对是个坏主意。扩展方法是静态绑定的，这意味着除非您在编译时类型为子类型的对象上调用覆盖，否则您仍将继续调用扩展方法。再见多态性。[这个页面](http://ruben.3click.be/blog/extension-methods-silent-static-slaves)很好地讨论了扩展方法的危险。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T16:40:17.827

这里的所有答案都说“你不能”，就目前而言，这是正确的。大多数补充说“你不应该”。我想证明你应该能够——尽管这可能是一种小小的安慰。

举一个痛苦的现实世界的例子：如果你很不幸地使用了新的 MVC 框架，并且你的视图代码到处都在使用一些 HtmlHelper 扩展方法，并且你想覆盖它的默认行为......然后呢？

你是SOL，就是这样。即使你做了“OOP 的事情”——从 HtmlHelper 派生，改变你的基视图类以用你的 DerivedHtmlHelper 的实例替换“Html”对象实例，并在其中定义一个显式的“Foo”方法——即使你做了所有也就是说，调用“Html.Foo”**仍将**调用原始扩展方法而不是方法。

这很令人惊讶！毕竟，扩展方法只有在对象还没有方法的情况下才会被应用！这里发生了什么？

嗯，这是因为扩展方法是一个**静态**特性。也就是说，当看到“Html.Foo”时，编译器会查看“Html”的**静态**类型。如果它有一个 'Foo' 方法，它会像往常一样被调用。否则，如果有 'SomeClass' 提供了 'Foo' 扩展方法，它会将表达式转换为 'SomeClass.Foo(Html)'。

您会期望编译器会考虑对象的**动态**类型。也就是说，生成的（伪）代码将读取 'Html.HasMethod("Foo") ？Html.Foo() : SomeClass.Foo(Html)'。

这当然会产生在每个扩展方法调用中使用反射的成本。因此，您会期望您可以编写类似“static void Foo( **virtual** this HtmlHelper html)”之类的内容来显式请求编译器插入运行时检查。将此称为“虚拟扩展方法”。

然而，在他们有限的预算和无限的智慧中，C# 语言设计者只选择了更高效、更受限制的替代方案。当我需要覆盖 HtmlHelper 的默认行为时，这让我仍然 SOL :-(

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T19:16:12.153

我同意迈克尔的观点。基类应该包含所有基本功能扩展方法显然应该扩展基本功能。在像 Ruby 这样的动态语言中，通常使用扩展方法来提供附加功能而不是使用子类。基本上，扩展方法用于替换使用子类，而不是替换使用基类。

我见过的唯一例外是，如果您有多种类型具有不同的类层次结构（如 winform 控件），您可以创建每个都实现和接口的子类，然后扩展该接口，从而给出“基础”功能到一组不同的控件，而无需扩展控件或对象之类的所有内容。

编辑：回答你的第二个问题

我认为编译器会为你捕捉到这个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T19:08:29.377

它们在语义上是不同的操作。例如，多态性可能不像抽象基类那样工作。

作为一般规则，使用任何语言工具来实现它的设计目的。扩展方法不是继承的替代品，它们是一种使用（通常）它已经可见的接口来扩展类功能的技术。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-23T19:21:33.813

你有充分的理由不应该这样做。第一个是，你不能保证你的扩展将如何被调用：

```
MyExtensions.AMethod(myObj) 
```

或者

```
myObj.AMethod() 
```

第二个只是第一个的语法糖。

您的建议违背了语言功能的精神。扩展方法绝对*不是*面向对象的。然而，您正在尝试实现一种面向对象的技术。不要为此使用扩展方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-10T19:16:53.037

如果您不需要唯一的派生类，您可能需要考虑上述多态性。

此 MSDN[文章中](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)的一些一般准则：

1.  一旦在一个类中定义了一个方法，该类共享该方法名称的任何扩展方法都将不再执行。

2.  扩展方法由命名空间加载。为了允许用户使用其他扩展方法，您可能应该避免将扩展方法放在与被扩展类相同的命名空间中。

如果各种依赖程序集使用同一个库，每个程序集都需要针对库中的类的自定义函数，则可以在该程序集的命名空间中声明特定于依赖程序集的扩展。不依赖于该程序集的其他程序集将没有该扩展名。

虽然这不是多态性，但您可能不想使用多态性，因为它需要所有派生类实现它们的覆盖。

换句话说，如果您有具有特定变体逻辑的派生词，请使用多态性。如果您只是在特定情况下需要自定义函数，否则可能会令人困惑或繁重，那么扩展方法不是一个坏主意。

此外，请参阅 JoshRivers 的回答，展示如何使用单独命名空间中的类中的命名空间覆盖扩展方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-20T03:39:01.403

首先，最好检查 [new] 作为方法修饰符 - 它应该提供相同的性能和方法分离，但麻烦少得多。

如果在那之后您仍在考虑相同的技巧，这里是要考虑的主要选项 - 不涉及意识形态，只列出您需要注意的方面:-)

首先，您可能必须将所有使用限制为模板化函数参数以保证确定性函数选择，因为此技巧将创建与 CLR 保证跨函数调用边界确定性绑定优先级的情况完全相反的情况。

如果您仍然要拥有抽象基类并且拥有所有代码，那么仅仅将一个基方法“转换”为扩展根本不会给您带来任何好处，只会让您失去一个通用接口，该接口仍然存在于其他所有东西中，包括 vtables 的成本。

如果您的目标是将抽象类转换为具体类，出于性能原因消除所有虚拟方法并仅在模板中使用具体基类和所有派生类（甚至可能转换为结构），那么该技巧可以为您带来一些性能。您只需要注意，如果不进行重构，您将无法回到基于接口的使用。您还需要使用签名中的基类测试非模板函数中的调用顺序，如果您有多个 dll-s，请格外小心。使用 [new] 运算符尝试相同的操作，看看它是否效果更好。

此外，即使它们具有完全相同的功能，您也必须为每个派生类编写单独的方法实现，因此如果您有很多派生类，您会看到大量代码重复。即使您使用 [new]，这部分也会对您产生影响，除非您返回到虚拟方法并在继承中引入另一层 - 这当然会取消所有性能增益。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-10T18:52:02.110

添加指向另一个 SO 问题的链接，该问题具有“你不能”之外的替代答案。更多的'你不能......除非'。

[如何覆盖现有的扩展方法](https://stackoverflow.com/questions/1451099/how-to-override-an-existing-extension-method)

# sql - 创建“群功能”

> ID：474083
> 
> 赞同：0
> 
> 时间：2009-01-23T19:08:27.380
> 
> 标签：sql

我想在我的网站上创建一个组功能，我想知道最好的方法是什么？我最好创建两个表组和 group_members 吗？我对 sql 相当陌生，所以我不太确定。

我在想：

```
团体
  group_id int(11) NOT NULL auto_increment，
  group_name varchar(32) NOT NULL

```

```
小组成员
  id int(11) NOT NULL auto_increment,
  group_id int(11) 非空
  user_id int(11) 非空

```

```
用户
  id int(11) NOT NULL auto_increment
  用户名 varchar(24) NOT NULL
  密码 varchar(32) NOT NULL

```

那会是最好的吗？或者，还有更好的方法？

干杯男孩

编辑：检查我的最后一条消息以获取另一个问题:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T19:13:59.147

我就是这样做的。

另一种选择是在 users 表中放置一个 group_id 列，但如果这样做，您将自己限制为每个用户只有一个组。你这样做的方式允许多对多关系，我认为这是最好的途径:o)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T19:13:58.400

> 那会是最好的吗？

确切地。

这是一个[多对多的关系](http://en.wikipedia.org/wiki/Many-to-many_(data_model))。

# c# - 为几十列存储配置值的最佳方法是什么？

> ID：474086
> 
> 赞同：1
> 
> 时间：2009-01-23T19:08:34.290
> 
> 标签：c#, .net

我在一个网格中有大约 20 列，每一列都可以通过另一个对话框中的复选框显示或隐藏。

任何给定列的可见性状态都将存储在一个 XML 文件中，该文件可通过 Options 类访问。

我正在尝试决定如何最好地表示 Options 类中的那些布尔可见性值。我很确定我会想要暴露每列可见性的属性，但是在这些属性下面是否应该为每列都有一个布尔值，或者我应该考虑使用字典或类似的东西来将所有列的可见性值保存在一个地方？

我认为单个布尔值的方式可能更健壮，并且不太可能导致丢失列值或类似情况，但字典可能会减少代码总量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T19:12:58.947

如果它是您需要为列存储的唯一属性，则可以使用单个字符串，其中 1 表示该列可见，0 表示隐藏。

<Columns Visible="00001011110111010101" />

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T19:36:57.137

如果您将来需要存储其他属性（例如每列的宽度），我会说使用字典会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T19:49:30.620

从概念上讲，您正在迈出最终希望保持对象状态的第一步，因此请以这种方式考虑问题。由于您已经致力于将 XML 用于您的持久性格式，因此从您的位置到您的答案应该是一小步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T22:59:42.333

我选择这样做的方式是创建一个枚举，其中每个列的条目与一个字典相结合以保存可见性状态和一个公开每个列值的属性。

这使得从我的 XML 文件中存储和检索列值变得容易（只需通过 Enum 枚举存储/从字典中为每个 Enum 检索所需的值），同时还提供比仅使用裸字典更多的安全性。

# acid - 实施 ACID

> ID：474087
> 
> 赞同：9
> 
> 时间：2009-01-23T19:09:04.883
> 
> 标签：acid

我正在开始研究一个需要在其数据库上提供 ACID 语义的项目。

由于数据的性质，它不适合存储在常见的现成系统（关系或键值）中。

关于如何实现必须提供 ACID 语义的系统，有哪些好的资源？

我的典型谷歌搜索返回更多关于已经提供 ACID 语义的系统的信息，而不是如何去实现这样的系统。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T19:13:25.203

ARIES 是一种用于实现 ACID 数据库的流行算法（例如 SQL Server 使用此算法）。

1.  [白羊座的维基百科](http://en.wikipedia.org/wiki/Algorithms_for_Recovery_and_Isolation_Exploiting_Semantics)
2.  [白羊座纸](http://en.wikipedia.org/wiki/Algorithms_for_Recovery_and_Isolation_Exploiting_Semantics)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:55:37.367

如果你懂德语，我会推荐

*   Alfons Kemperer: Datenbanksysteme - Eine Einführung, ISBN 3486576909

“Einführung”，意思是“介绍”，是一种严重的轻描淡写。这本书有几章介绍了如何物理布局数据、WAL（预写日志记录）、可序列化与不可序列化的历史记录、失败后重新启动等等。

不过，我怀疑你真的想写这样的东西。我是否需要提醒您，理论上您可以在关系模型之上对任何数据结构进行建模？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-13T12:48:52.910

看看乐观并发。使用 STM（软件事务内存）方法而不是锁定。更快，更容易实施。使用 SERIALIZABLE 隔离级别，您每秒可以有 10,000 或 100,000 个 ACID 事务。无需放松事务的隔离属性。

另外，我建议考虑为内存缓存和磁盘数据使用部分持久的数据结构。它允许读取器永远不会被写操作阻塞。

有关我正在处理的数据库，请参见[http://bergdb.com/ 。](http://bergdb.com/)请随时与我联系以讨论这个有趣的话题。/ 弗兰斯·伦德伯格

对于我对定义不明确的 ACID 属性的看法：

[http://blog.franslundberg.com/2013/12/acid-does-not-make-sense.html](http://blog.franslundberg.com/2013/12/acid-does-not-make-sense.html)

# sharepoint - 有条件地绕过 Sharepoint 'onWorkflowModified' 活动

> ID：474091
> 
> 赞同：1
> 
> 时间：2009-01-23T19:11:24.847
> 
> 标签：sharepoint, workflow, wss

我有一个 SharePoint（WSS 3.0，VS 2005）工作流，它附加了一个工作流修改表单，我想在一段时间后禁用它并继续使用关联表单中的参数。

如果计时器到了，跳过“onWorkflowModified”活动的最佳方法是什么？似乎侦听修改数据的唯一方法会导致工作流无限期地等待活动。

谢谢！

编辑：并行活动的一个分支中的“onWorkflowModified”活动阻止任何事情发生，直到它被处理——这是我试图避免的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T20:15:10.507

您可能可以运行并行活动。一个监听，另一个等待事件。如果其中任何一个被逐步执行，您可以取消另一个。您无需在 onWorkflowActivated 步骤中专门执行任何操作。仅 SharePoint 需要它来启动工作流并提供您的初始数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T17:31:03.903

事实证明，正如怀疑的那样，“onWorkflowModified”继承自“HandleExternalEventActivity”，这是一个阻塞活动。因此，将其作为并行活动中的一个分支会导致工作流停止，直到它被处理。绕过它的最简单方法是在计时器启动时触发它正在等待的事件，并区分从计时器接收事件和用户接收事件。

希望这可以帮助别人！

# jquery - 为什么在我移动到不同的页面然后点击后退按钮后，这个 jQuery 的工作方式会有所不同？

> ID：474095
> 
> 赞同：3
> 
> 时间：2009-01-23T19:13:10.787
> 
> 标签：jquery, html

我正在为网站制作一个简单的导航菜单。`ul`你用 id创建一个，`menu`从那里应该很简单。我有一些简单的 css 来为所有`li`s 提供正确的背景图像，然后一些 jQuery 来改变`li`用户鼠标悬停时的外观。它工作得很好，但有一个问题。当用户 *直接*点击一个链接，而不是点击它周围的框，然后使用浏览器的后退按钮，就会出错。当用户将鼠标悬停在*这个*时间时，整个 li 完全空白，但是一旦用户将鼠标移开就可以了。有谁知道可能导致这种奇怪行为的原因？（注意，每隔一段时间，鼠标悬停会导致 a`li`闪烁，特别是如果它是底部两个之一时`li`s。我认为这很正常，但可能有助于诊断问题。）

```
<html>
<head>
<title>Menu Test</title>
<style type="text/css">
ul#menu{width: 185px; margin: auto; text-align: center; color: #fff; list-style-type: none;}

ul,li,h2{padding: 5px 0 0 0; margin: 0;}

li h2{height: 49px; background: url('top.png'); vertical-align: middle;}
li.link{height: 30px; background: url('link.png');}
li.link a{color: white; text-decoration: none;}
li.bottom{height: 25px; background: url('bottom.png');}
</style>

<script src="jquery.js" type="text/javascript"></script>
<script type="text/javascript">
 $(document).ready(function(){
  $(".link").mouseover(function(){ //highlight on mouseover
   $(this).css({background: "url('file:///Users/J/Desktop/DHTML/Menu/linkselect.png')"});
  })
  $(".link").mouseout(function(){ //un-highlight on mouseout
   $(this).css({background: "url('./link.png')"});
  })
  $(".link").click(function(){ //go to site on click, even if click isn't on link
   window.location = $(this).find("a").attr("href");
  })
 })
</script>
</head>
<body>

<ul id="menu">
 <li><h2>Menu</h2></li>
 <li class="link"><a href="http://google.com/">Google</a></li>
 <li class="link"><a href="http://norwegianrecycling.multiply.com/">Norwegian Recycling</a></li>
 <li class="link"><a href="http://www.jquery.com/">jQuery</a></li>
 <li class="link"><a href="http://www.apple.com/">Apple</a></li>
 <li class="link"><a href="http://www.ubuntu.com">Ubuntu</a></li>
 <li class="link"><a href="http://www.firefox.com/">Firefox</a></li>
 <li class="link"><a href="http://www.youtube.com/">YouTube</a></li>
 <li class="bottom"></li>
</ul>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T19:23:03.077

*您知道只需*CSS 和 HTML就可以完成您正在做的所有事情吗？

*   设置为`a`使其`display:block`填充`li`
*   在 a 上设置`:hover`状态以更改背景。
*   ？？？
*   利润。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T19:57:00.323

以下作品。我会把 CSS 细节留给你。另请注意，正如其他人指出的那样，您可以使用纯 CSS 执行此操作并获得相同的结果。但既然这不是你要求的，我会尊重你的要求并提供 jQuery。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Default Web Project - www.SampsonResume.com</title>
    <style type="text/css">
      .ul {list-style:none;margin:0;padding:0;border:1px solid #CCCCCC;}
      li.link {background-color:#000000;padding:10px;}
        li a {color:#ffffff;text-decoration:none;}
      li.on {background-color:#f1f1f1;cursor:pointer;}
        li.on a {color:#000000;}
    </style>
    <script src='scripts/jquery/jquery-1.3.min.js' type='text/javascript'></script>
      <script type="text/javascript">
        $(document).ready(function(){
          $("li.link").each(function(){
            $(this).hover(
              function(){$(this).addClass("on");},
              function(){$(this).removeClass("on");}
            );
           $(this).click(function(){
             window.location = $(this).find("a").attr("href");
           });          
         });
       });
     </script>
  </head>
  <body>
    <ul>
      <li class="link"><a href="http://www.google.com">Google</a></li>
      <li class="link"><a href="http://www.yahoo.com">Yahoo</a></li>
      <li class="link"><a href="http://www.SampsonVideos.com">SampsonVideos</a></li>
    </ul>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T19:22:19.303

我知道这并不完全是您问题的答案，但是在悬停时更改元素的 CSS 属性可以完全在 CSS 中完成。对于您的示例，您的 CSS 将类似于：

```
.link {
  background: url('./link.png');
}
.link:hover {
  background: url('file:///Users/J/Desktop/DHTML/Menu/linkselect.png');
} 
```

~~我*认为*您也可以将标签包裹在`<a>`标签周围`<li>`，这样整个列表项就是链接（无需`$(".link").click(...)`代码）。~~

糟糕，无法环绕`<a>`，`<li>`但正如 Oli 所提到的，您可以在 CSS 中执行此操作：

```
.link a {
  display: block;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T20:06:22.270

哦，好吧，我说过我不会给出 CSS 解决方案，但无论如何，这里是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Default Web Project - www.SampsonResume.com</title>
    <style type="text/css">
      ul {list-style:none;margin:0;padding:0;border:1px solid #CCCCCC;}
      li {margin:0;padding:0;}
        li a {display:block;background-color:#FFF;color:#000;text-decoration:none;}
      li a:hover {color:#FFF;background-color:#000;}
    </style>
  </head>
  <body>

    <ul>
      <li><a href="http://www.google.com">Google</a></li>
      <li><a href="http://www.yahoo.com">Yahoo</a></li>
      <li><a href="http://www.SampsonVideos.com">SampsonVideos</a></li>
    </ul>

  </body>
</html> 
```

# apache-flex - 如何在 Flex 中使用位图图像创建反射效果？

> ID：474103
> 
> 赞同：1
> 
> 时间：2009-01-23T19:14:48.303
> 
> 标签：apache-flex, flash, actionscript, air

我正在寻找一种简单、干净且内存效率高的方法来创建反射效果并将其应用到我在运行时加载到 Flex 应用程序中的位图图像（你知道的，由著名的 iPhone UI 推广）。源图像将具有不同的类型（JPG、PNG 等），但可接受的解决方案可以假设每个图像都已加载并存储为 BitmapData。

我希望能够对 BitmapData 的某些视图应用（可选）反射效果，但仍保持源 BitmapData 完整，因为并非所有视图都需要反射效果。非常感谢您的见解！提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:52:48.557

你可以使用这个类：

[http://code.google.com/p/cay/source/browse/trunk/as3/cl/cay/effects/Reflejo.as](http://code.google.com/p/cay/source/browse/trunk/as3/cl/cay/effects/Reflejo.as)

它可能并不完美，但至少可以让您快速入门。然后根据您的需要更新和修改。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T17:31:33.073

[Chet Haase 发布了我正在寻找的答案](http://graphics-geek.blogspot.com/2009/03/video-moment-of-reflexion.html)，并附有源代码和演示视频。希望它可以帮助其他人寻找灵活的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:00:30.020

可能是一种更简单的方法，但我会说只是显示图像的第二个副本反转并变得透明：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"
    creationComplete="onCC()">
    <mx:Script>
        <![CDATA[
            private function onCC():void {
                var m:Matrix = new Matrix(1,0,0,-1,flipImage.transform.matrix.tx, flipImage.transform.matrix.ty + flipImage.height);
                flipImage.transform.matrix = m;
                flipImage.alpha = 0.3;
            }
        ]]>
    </mx:Script>
    <mx:VBox verticalGap="0">
        <mx:Image source="http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png">

        </mx:Image>
        <mx:Image id="flipImage" source="http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png">

        </mx:Image>
    </mx:VBox>
</mx:Application> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T10:10:36.580

您始终可以使用 scaleX = -1;

这将水平翻转您的图像。但它以左侧为轴翻转，因此您必须将图像的 x 位置调整为 image.x = image.x + image.widht;

# .net - 什么是最好的 WPF 功能区控制套件？

> ID：474104
> 
> 赞同：27
> 
> 时间：2009-01-23T19:15:28.067
> 
> 标签：.net, wpf, wpf-controls, ribbon

我将在我的程序中添加一个 WPF 功能区 UI。

根据您的经验，包括功能区控件在内的最佳 WPF 控件套件是什么？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-01-26T11:32:40.923

请看一下 Fluent Ribbon Control Suite： http: [//fluent.codeplex.com](http://fluent.codeplex.com)

“Fluent Ribbon Control Suite 是一个为 Windows Presentation Foundation (WPF) 实现类似 Office（Microsoft® Office Fluent™ 用户界面）的库。它提供了良好的自定义控件，例如 RibbonTabControl、Gallery、QuickAccessToolbar、ScreenTip、StatusBar 和等等。它与最新的 Office 2010 样式捆绑在一起。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-23T19:28:29.383

我会推荐[WPF Ribbon Preview](http://www.codeplex.com/wpf/Wiki/View.aspx?title=WPF%20Ribbon%20Preview)，因为无论如何它都会进入下一个 .NET 版本。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-08-10T22:01:11.257

Microsoft 于 2010 年 8 月 2 日发布了他们更新的 WPF 功能区。链接在这里：

[适用于 WPF 的 Microsoft 功能区](http://www.microsoft.com/downloads/details.aspx?FamilyID=2bfc3187-74aa-4154-a670-76ef8bc2a0b4&displaylang=en)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T16:40:21.693

我尝试了几种产品，但停止了[DevComponents 的](http://devcomponents.com/dotnetbar-wpf/wpfribbon/)实现。使用简单，但非常有效。查看他们提供的试用版和示例。价格也足够低。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T19:19:12.240

[SandRibbon](http://divelements.com/net/)，最重要的是当你购买它时，升级版本是免费的，作者不断更新、改进和修复（几乎每周发布一个新版本），你可以直接联系他，非常聪明的家伙，会接受任何反馈。

他为网页、Silverlight 和 Windows 应用程序制作了一个版本，并提供了[现场演示](http://divelements.com/net/controls/sandribbonsl/livedemofullscreen.htm)。

# c# - 平台调用语句中 DLL 的相对路径

> ID：474107
> 
> 赞同：2
> 
> 时间：2009-01-23T19:15:58.240
> 
> 标签：c#, visual-studio-2008, pinvoke

我正在使用 VS 2008 开发一个使用 .dll 和 P/Invoke 的应用程序。当我使用绝对路径时，我可以成功使用 dll。例如，这确实有效：

[DllImport("C:\\myDLL.dll")] internal static extern bool isReady();

这不起作用：

[DllImport("myDLL.dll")] 内部静态 extern bool isReady();

我尝试添加一个参考文件夹并将 dll 添加到项目文件夹中，但都不起作用。我需要将此应用程序部署在其他计算机上，并且需要确保包含此 .dll。谢谢您的帮助！

* * *

当我尝试这样做时，我忘了提及我收到此错误：

Microsoft Visual Studio 无法添加对“C:\Users\dlugokja\Documents\Visual Studio 2008\Projects\DinamapN.sln(1)\DinamapN\DinamapN\DinaWin.dll”的引用。请确保该文件是可访问的，并且它是一个有效的程序集或 COM 组件。好的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T19:41:28.717

我们在工作中使用的解决方案如下：

1.  将 DLL 添加到您的项目中
2.  将 DLL 的属性编辑为“内容”和“始终复制”
3.  在您的 P/Invoke 语句中将 DLL 引用为 @"mydll.dll"

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-23T19:20:01.180

为什么不直接右键单击项目文件，“添加引用”并浏览到 dll？

# c# - 强类型 ASP.NET MVC ViewData 扩展 - 在哪里放置标识符？

> ID：474114
> 
> 赞同：1
> 
> 时间：2009-01-23T19:18:06.877
> 
> 标签：c#, asp.net-mvc

有时，创建新模型类型的开销很烦人。在这些情况下，我想设置 ViewData，选项似乎是：

1.  只需使用字符串键设置 viewdata，然后将其丢弃。这有明显的问题。

2.  将标识符（字符串键）存储在某处（在哪里？在控制器上？）并将其投射到视图页面上。在解决其中一个问题的同时，我仍在强制转换，这是有问题的，并且会扼杀类型推断。

3.  使用 MVCContrib 强类型 Set/Get 函数。这些有时很好，但如果类型不是很具有描述性，比如布尔值“IsNew”，它们就不能很好地工作。它还杀死了类型推断，而且它仍然几乎只是在做一个演员，所以我必须手动同步视图和控制器。

因此，我正在考虑使用幻像类型来组合类型和键标识符。它相当于这个伪 C#：

```
class ViewDataKey<T> = string 
```

这将让我在控制器中创建标识符，如下所示：

```
public static readonly ViewDataKey<bool> IsNew = "IsNew"; 
```

使用一些简单的扩展方法，设置数据将是：

```
 ViewData.Set(IsNew, true); 
```

取出它同样简单：

```
var isNew = ViewData.Get(FrobNozzleController.IsNew); 
```

请注意，我们不需要指定 isNew 的类型，它是安全推断的。键和类型定义存储在一个位置。

问题：

1.  密钥应该存储在哪里？对于“全球性”的 ViewData，一些常见的类可以正常工作。但是对于视图/控制器特定的数据？把它放在控制器上有什么缺点吗？（除了控制器的长名称？）

2.  有没有更简单的方法，或者已经内置的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T19:21:08.277

我认为这就是模型在 MVC 模式中所做的事情。为什么不使用类型化视图？

我相信你只是通过在控制器和视图之间引入另一个依赖关系使事情变得更加复杂。在代码行或类似的方面，我没有看到任何具体的好处。您必须声明变量的存在，您也可以在模型类定义中这样做。

这样做不会获得任何显着优势。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T19:28:29.557

一个想法是在您不想创建特定视图模型类的情况下为强类型视图创建元组：

```
class SimpleModel<T>

class SimpleModel<T, U>

class SimpleModel<T, U, V> 
```

然后像往常一样制作一个强类型视图。现在您拥有强类型的优势，而不必为每种情况创建一个新类。

.NET 4.0 内置了 Tuple 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T13:56:29.793

我仍然会使用 ViewData 字典，而不是“将其排除”，而是使用 ToString() 和 Html.Encode 它。为什么要打破 MVC 模式？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T13:35:47.927

我刚刚发布了一篇关于这个主题的帖子。

[http://agilefutures.com/index.php/2009/06/mvc-strongly-typed-global-viewdata](http://agilefutures.com/index.php/2009/06/mvc-strongly-typed-global-viewdata)

希望有用。

问候

托比

# sql - 表示单个 SQL 表中记录之间的多对多关系的最佳方式是什么？

> ID：474119
> 
> 赞同：6
> 
> 时间：2009-01-23T19:19:59.417
> 
> 标签：sql, database, many-to-many, entity-relationship, relational

我有一个这样的 SQL 表：

更新：我正在更改示例表，因为原始数据（州、城市、学校）的现有分层性质掩盖了项目之间需要简单关系的事实。

```
entities
id      name               
1       Apple     
2       Orange            
3       Banana             
4       Carrot                
5       Mushroom 
```

我想定义这些实体之间的双向关系，以便查看一个实体的用户可以看到所有相关实体的列表。

关系由最终用户定义。

在数据库中表示这些关系并随后查询和更新它们的最佳方式是什么？

**我看到的一种方式...**

我的直觉是这样的关系表：

```
entity_entity
entity_id_a       entity_id_b
1                 2
5                 1
4                 1
5                 4
1                 3 
```

既然如此，给定提供的 entity_id 为 4，如何获取所有相关记录，即 1 和 5？

同样， entity_id = 1 的查询应返回 2、3、4 和 5。

感谢您抽出宝贵时间，如果我能澄清这个问题，请告诉我。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-23T19:30:42.420

定义一个约束：`entity_id_a < entity_id_b`.

创建索引：

```
CREATE UNIQUE INDEX ix_a_b ON entity_entity(entity_id_a, entity_id_b);
CREATE INDEX ix_b ON entity_entity(entity_id_b); 
```

第二个索引不需要包含`entity_id_a`，因为您只会使用它来选择`a`一个中的所有`b`。`RANGE SCAN`on`ix_b`会比`SKIP SCAN`on快`ix_a_b`。

使用您的实体填充表，如下所示：

```
INSERT
INTO entity_entity (entity_id_a, entity_id_b)
VALUES (LEAST(@id1, @id2), GREATEST(@id1, @id2)) 
```

然后选择：

```
SELECT entity_id_b
FROM entity_entity
WHERE entity_id_a = @id
UNION ALL
SELECT entity_id_a
FROM entity_entity
WHERE entity_id_b = @id 
```

`UNION ALL`此处允许您使用上述索引并避免为唯一性进行额外排序。

以上所有对于对称和反自反关系都是有效的。这意味着：

*   如果**a**与**b**相关，则 **b**与**a相关**

*   **a**从不与**a相关**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T19:25:40.340

我认为您建议的结构很好。

要获取相关记录，请执行以下操作

```
SELECT related.* FROM entities AS search 
LEFT JOIN entity_entity map ON map.entity_id_a = search.id
LEFT JOIN entities AS related ON map.entity_id_b = related.id
WHERE search.name = 'Search term' 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T19:35:12.833

链接表方法似乎很好，除了您可能想要一个“关系类型”，以便您知道它们为什么相关。

例如，Raleigh 和 North Carolina 之间的关系与 Raleigh 和 Durham 之间的关系不同。此外，您可能想知道谁是关系中的“父母”，以防您使用条件下拉菜单。（即您选择一个州，您可以看到该州的城市）。

根据您要求的复杂性，您现在拥有的简单设置可能还不够。如果您只是需要表明两条记录以某种方式相关，那么链接表就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T19:40:21.153

我已经在您的设计中发布了一种方法，但如果您的设计具有一定的灵活性并且更符合您的需求，我也想提供这种单独的设计见解。

如果项目在（非重叠）等价类中，您可能希望将等价类作为表设计的基础，其中类中的所有内容都被视为等价类。类本身可以是匿名的：

```
CREATE TABLE equivalence_class (
    class_id int -- surrogate, IDENTITY, autonumber, etc.
    ,entity_id int
) 
```

`entity_id`对于您的空间的非重叠分区应该是唯一的。

这避免了确保正确的左手或右手习惯或强制右上关系矩阵的问题。

那么你的查询有点不同：

```
SELECT c2.entity_id
FROM equivalence_class c1
INNER JOIN equivalence_class c2
    ON c1.entity_id = @entity_id
    AND c1.class_id = c2.class_id
    AND c2.entity_id <> @entity_id 
```

或者，等效地：

```
SELECT c2.entity_id
FROM equivalence_class c1
INNER JOIN equivalence_class c2
    ON c1.entity_id = @entity_id
    AND c1.class_id = c2.class_id
    AND c2.entity_id <> c1.entity_id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T19:26:16.220

```
select * from entities
where entity_id in 
(
    select entity_id_b 
    from entity_entity 
    where entity_id_a = @lookup_value
) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T19:31:43.090

我能想到几个方法。

带 CASE 的单通道：

```
SELECT DISTINCT
    CASE
        WHEN entity_id_a <> @entity_id THEN entity_id_a
        WHEN entity_id_b <> @entity_id THEN entity_id_b
    END AS equivalent_entity
FROM entity_entity
WHERE entity_id_a = @entity_id OR entity_id_b = @entity_id 
```

或者两个过滤的查询 UNIONed 因此：

```
SELECT entity_id_b AS equivalent_entity
FROM entity_entity
WHERE entity_id_a = @entity_id
UNION
SELECT entity_id_a AS equivalent_entity
FROM entity_entity
WHERE entity_id_b = @entity_id 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-23T21:08:52.147

根据您更新的架构，此查询应该可以工作：

```
select if(entity_id_a=:entity_id,entity_id_b,entity_id_a) as related_entity_id where :entity_id in (entity_id_a, entity_id_b) 
```

其中 :entity_id 绑定到您要查询的实体

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-23T19:53:28.117

我的建议是您的初始表格设计很糟糕。不要在同一张表中存储不同类型的东西。（数据库设计的第一条规则，就是不要在同一个字段中存储多条信息）。这更难查询，并且会导致严重的性能问题。另外，将数据输入到 realtionship 表中会是一个问题——当你做一个新的条目时，你怎么知道哪些实体需要被 realted？设计适当的关系表会好得多。实体表几乎总是一个坏主意。从示例中我看不出有任何理由将此类信息放在一个表中。坦率地说，我有一个大学表和一个相关的地址表。这将很容易查询并执行得更好。

# xml - XML Schema - 绕过唯一标签约束

> ID：474142
> 
> 赞同：1
> 
> 时间：2009-01-23T19:25:15.130
> 
> 标签：xml, schema, xsd, tags, particles

我必须为已经使用的 XML 格式创建一个模式。现有的 XML 已经由不同的程序生成，听起来很难找到所有需要更改的地方才能使用更常规的 XML 格式。

这是一个类似于我们的 XML 结构的示例：

```
<data>
    <summary>some info</summary>
    <error>error message (only if there was an error)</error>
    <details>more info
        <x>more</x>
        <y>even more</y>
    </details>
    <error>another error message</error>
    <z>some extra info</z>
</data> 
```

请注意，错误标签在同一级别重复使用，并且出现在某些项目之后而不是其他项目之后，所以我不能只设置 maxOccurs="unbounded"。我已经尝试将相关的错误/其他标签对包装在 xsd:sequence 中，但这并不能解决问题，因为我仍然有效地破坏了唯一粒子归属规则。

这甚至可以完成，还是我需要让其他开发人员知道这个模式不会验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:13:03.740

我对[XML 模式标准](http://www.w3.org/TR/xmlschema-1/)的阅读表明您可能是安全的。您只需在架构中定义具有相同名称的非连续元素，以反映将（或可能）生成的 XML。只要所有“错误”实例*总是*被其他元素分隔并且不连续，这应该不是问题。例如，类似：

```
  <xs:元素名称="数据">
    <xs:complexType>
      <xs:序列>
        <xs:element name="summary" minOccurs="1" maxOccurs="1" type="xs:string" />
        <xs:element ref="error" minOccurs="1" maxOccurs="1" />
        <xs:element name="details" minOccurs="1" maxOccurs="1" type="detailsType" />
        <xs:element ref="error" minOccurs="1" maxOccurs="1" />
        <xs:element name="z" minOccurs="0" maxOccurs="1" type="xs:string" />
      </xs:sequence>
    </xs:complexType>
  </xs:元素>

  <xs:element name="error" type="xs:string"/>

  <xs:complexType name="detailsType">
    ……
  </xs:complexType>

```

如果 details 的 minOccurs="0" 并且上面的第一个 "error" 的 maxOccurs > 1，那么您将无法通过唯一粒子属性规则，因为验证无法验证，如果您在一行中有两个错误元素，则 "error" 的哪个实例" 在它们所属的模式中。但是，只要可以在模式中唯一标识“错误”的每个实例，由于对错误元素和中间元素很好地使用了“minOccurs”和“maxOccurs”，那么你就很好。

只要模式验证器始终可以通过使用 minOccurs 和 maxOccurs（例如）明确地确定引用了哪个实例，您甚至可以有连续的“错误”实例。

想想 xhtml，其中的元素可以以任意顺序出现，任意重复。

EDIT: Updated to reflect edits in original question.

# ruby-on-rails - 如何限制 Phusion 乘客内存使用？

> ID：474147
> 
> 赞同：11
> 
> 时间：2009-01-23T19:26:40.353
> 
> 标签：ruby-on-rails, passenger, phusion

有没有办法限制 Phusion Passenger 在提供应用程序时使用的内存量？

在我获得大量流量后，我的主机过来并终止了该进程，因此我最终提供了空白页面。有什么我可以说的“嘿，不要使用超过 100Mb 的空间，而且无论网站有多过载，都只会产生 3 个进程”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-24T18:20:50.720

没有办法明确限制内存使用（比如使用 <= 100MiB）。

但是你可以做的是通过设置[PassengerMaxPoolSize](http://www.modrails.com/documentation/Users%20guide%20Nginx.html#PassengerMaxPoolSize)来限制进程的数量。设置它，然后查看内存使用情况（这取决于您正在运行的应用程序）。

此外，使用[Ruby Enterprise Edition](http://www.rubyenterpriseedition.com/)可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T18:33:39.100

还可以查看 3.0.11 中的新乘客 max_requests

[http://www.modrails.com/documentation/Users%20guide%20Nginx.html#PassengerMaxRequests](http://www.modrails.com/documentation/Users%20guide%20Nginx.html#PassengerMaxRequests)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T16:34:12.110

看来它可能已“在客运企业中实施” [https://code.google.com/p/phusion-passenger/issues/detail?id=201](https://code.google.com/p/phusion-passenger/issues/detail?id=201)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T10:05:50.360

为了补充 Mihai A 在 2009 年所写的内容，[REE 已在 2012 年达到使用寿命](http://blog.phusion.nl/2012/02/21/ruby-enterprise-edition-1-8-7-2012-02-released-end-of-life-imminent/)。主要原因之一是它没有提供比 Ruby 2.0 显着的性能改进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-01T17:33:47.367

正如其他人指出的那样，企业版乘客具有此功能。

对于免费版本，请查看此博客文章：[http ://dev.mensfeld.pl/2012/08/simple-rubyrails-passenger-memory-consumption-limit-monitoring/](http://dev.mensfeld.pl/2012/08/simple-rubyrails-passenger-memory-consumption-limit-monitoring/)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-07-14T09:16:19.720

尝试在 Solaris Zone 中运行它；）

# asp.net-mvc - iframe/脚本是在 ASP.NET MVC 中拥有多个独立控件的唯一方法吗？

> ID：474153
> 
> 赞同：0
> 
> 时间：2009-01-23T19:28:14.547
> 
> 标签：asp.net-mvc

除了使用脚本或 iframe 之外，还有什么方法可以让独立操作的视图/操作在单个页面上工作？例如，假设我有一个 FabWidgets 的删除页面。它可能看起来像：

```
Are you sure you want to delete this FabWidget "<%= Model.Name %>"?

Careful, this FabWidget controls these FrobNozzles:

<% Html.RenderAction("Grid", "FrobNozzles") %>

<!-- Form for delete/cancel --> 
```

到目前为止一切顺利……除非 FrobNozzle 的 Grid 视图真的很大并且需要进行分页。如果发生正常的分页操作，我们将离开删除页面。我们如何获得 FrobNozzle 网格的分页？

我看到了将网格粘贴在 iframe 中的可能性，因此它可以像正常一样渲染并根据需要自行处理新的内容，而不会弄乱当前页面。还有一种方法使用脚本来执行 ajax 请求并重新显示或诸如此类。

是否有任何简单的 ASP.NET MVC 集成可以使其正常工作而无需真正处理它？例如，在 ASP.NET WebForms 中，ViewState 回发只会让我们让 FrobNozzle 网格触发事件，而不会弄乱页面的其余部分。像 ASP.NET MVC 这样的“魔法”吗？

我确实查看了部分等，但没有看到它如何处理回发问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:11:24.290

这是 MVC 与 WebForms 的区别之一。如果你想做这样的事情，你需要编写一些代码来处理分页。

您可以将“PostbackUrl”传递给 Grid 操作，并且 Grid 操作可以在分页数据时使用该 Url（将其分页参数附加到查询字符串）。或者您可以传递“PostbackRouteData”，这将是生成分页链接时要使用的一组路由值（同样，网格会将其分页参数添加到路由数据中）。

我实际上建议在这里使用 Ajax 助手（Ajax.ActionLink 非常适合分页），但如果您真的需要避免 IFrame 和 JavaScript，则必须推出自己的解决方案。

MVC 为您提供了对渲染的大量控制，这可能是一个优势。但是，您失去了 WebForms 的“类似 Windows”的事件驱动编程模型。

# java - 使用 Spring 进行休眠二级缓存

> ID：474159
> 
> 赞同：20
> 
> 时间：2009-01-23T19:29:01.910
> 
> 标签：java, hibernate, spring, jpa, jakarta-ee

我正在使用 Spring + JPA + Hibernate。我正在尝试启用 Hibernate 的二级缓存。在我的春天，`applicationContext.xml`我有：

```
<prop key="hibernate.cache.provider_class">net.sf.ehcache.hibernate.SingletonEhCacheProvider</prop>
<prop key="hibernate.cache.provider_configuration_file_resource_path">/ehcache.xml</prop> 
```

当我运行时，我收到错误：

```
Caused by: org.hibernate.HibernateException: Could not instantiate cache implementation
     at org.hibernate.cache.CacheFactory.createCache(CacheFactory.java:64)

Caused by: org.hibernate.cache.NoCachingEnabledException: Second-level cache is not enabled for usage [hibernate.cache.use_second_level_cache | hibernate.cache.use_query_cache]
     at org.hibernate.cache.NoCacheProvider.buildCache(NoCacheProvider.java:21) 
```

所以抱怨我没有启用二级缓存。我尝试通过添加到我的来启用它`applicationContext.xml`：

```
<prop key="hibernate.cache.use_second_level_cache">true</prop> 
```

但仍然没有喜悦。我还尝试将其添加到我的 ehcache.xml 中：

```
<property name="hibernate.cache.use_second_level_cache">true</property> 
```

但它仍然不起作用。更改`provider_class`to`org.hibernate.cache.EhCacheProvider`也无济于事：

```
<prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop> 
```

我的实体类被注释为使用缓存

```
@Cache(usage=CacheConcurrencyStrategy.READ_ONLY) 
```

那么，如何启用二级缓存呢？

**编辑：** 这是在 bean 下：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean"> 
```

**已解决：**因为我正在使用`LocalEntityManagerFactoryBean`它，所以它的设置来自`META-INF/persistence.xml`. 我的设置`applicationContext.xml`甚至没有被读取。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-31T12:19:54.403

我没有回答这个问题，但发帖人自己找到答案并不明显。我转发他的回答：

### 解决

由于我正在使用`LocalEntityManagerFactoryBean`它，因此它的设置来自`META-INF/persistence.xml`. 我的设置`applicationContext.xml`甚至没有被读取。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-30T12:57:59.967

试试这个：

```
<prop key="hibernate.cache.use_query_cache">true</prop>
<prop key="hibernate.max_fetch_depth">4</prop>
<prop key="hibernate.cache.use_second_level_cache">true</prop>
<prop key="hibernate.cache.use_query_cache">true</prop>
<prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</prop> 
```

如果您使用 Maven，请将其添加到您的 POM 文件中：

```
<dependency>
  <groupId>net.sf.ehcache</groupId>
  <artifactId>ehcache-core</artifactId>
  <version>2.3.0</version>
</dependency> 
```

[或者从http://ehcache.org/](http://ehcache.org/)下载最新的 jar

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-24T04:41:29.217

[这个链接](http://ehcache.org/documentation/user-guide/hibernate)帮助我在 Hibernate 4 中使用二级缓存

# php - 设置数据库和访问控制权限

> ID：474163
> 
> 赞同：1
> 
> 时间：2009-01-23T19:29:36.497
> 
> 标签：php, mysql, database-design, data-access, access-control

我是使用 PHP 和 MySQL 创建 Web 应用程序的团队的一员。该应用程序将有多个具有不同角色的用户。该应用程序还将以地理分布的方式使用。

因此，我们需要创建一个访问控制系统来控制特定数据库记录的用户权限，即修改数据库查询以便只显示特定记录。例如，对于城市级别的用户，只应显示与用户的特定城市相关的记录，而对于国家级别的用户，应显示该国所有城市的记录。

我需要帮助设计一个可以处理此类信息检索的系统，而无需对 SQL 查询中的信息进行硬编码。

任何帮助，将不胜感激。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T23:14:18.443

应用程序的设计将根据所需的安全需求而有所不同。

例如，信息是存储在多个数据库中还是在单个数据库中？向每种类型的用户提供代表其特定权限的数据库模式是否重要？显然，这些问题的答案表明您是否需要更安全的数据库访问系统。

如果这样做，则为系统中存在的每种用户类型创建一个数据库用户。为每个用户提供对适当表、视图、过程等的权限。当用户向系统进行身份验证时，您必须根据该人的用户类型创建条件数据库连接。

最极端的做法是，通过存储过程严格控制对数据库的访问也是合适的。然后每个数据库用户将只能访问他们需要的一组存储过程。

在数据库中实施安全性可能会很痛苦，并增加了应用程序的复杂性以及维护它的成本，并且确实降低了应用程序 IMO 的整体凝聚力，但它也为任何可能想要破解或其他方式的人提供了非常严格的安全墙滥用系统。

无论出于安全目的在数据库中实现什么，您显然还需要使用会话机制来存储当前经过身份验证的用户及其类型。为特定用户更改功能的一种简单方法是将每个用户的可用操作（读取函数或方法）及其属性（或属性）封装在一个类中以表示特定用户。这样，如果两个人点击 Dashboard.php，他们将准确地看到他们有权访问的数据。

最后，您可以通过数据库中存储的有关用户的信息来控制一些访问控制（并且可能必须这样做），例如他们需要查看哪些城市的信息或他们监督哪些用户。然后使用该信息创建可以从您的用户特定域对象访问的对象集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:19:58.733

用户可以直接访问数据库引擎吗？如果可以的话，避免它。

使应用程序使用专用用户帐户连接到数据库，该帐户仅为其提供整个应用程序所需的权限。根据应用程序定义的用户和角色以及简单的自定义 API，在应用程序内部执行其余的安全工作。

如果这些用户可能需要访问和使用多个此类应用程序，请考虑将用户存储在单独的共享数据库中，并让应用程序使用共享的自定义 API 查询它。

# c# - 验证用户输入标签

> ID：474165
> 
> 赞同：0
> 
> 时间：2009-01-23T19:30:14.573
> 
> 标签：c#, php, asp.net, vb.net, tagging

我知道这个问题可能听起来有点俗气，但这是我第一次在我的一个项目网站上实现“标记”功能，我想确保我做的一切都是正确的。

现在，我正在使用与 SO.. 中相同的标记系统。空格分隔，破折号（-）组合多个单词。所以当我验证用户输入标签字段时，我正在检查

1.  空字符串（不能为空）
2.  确保字符串不包含特定字母（这里欢迎建议..）
3.  至少一个字
4.  如果有空格（有多个单词）拆分字符串
5.  对于每个拆分，插入数据库

我在这里遗漏了什么？或者这大致可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:13:32.477

在 处拆分字符串`" "`，迭代各个部分，确保它们符合您的期望。如果他们这样做，请将它们放入数据库中。

例如，您可以使用此正则表达式来检查各个部分：

```
^[-\w]{2,25}$ 
```

这会将允许的输入限制为 2..25 个字符长的连续字母数字字符串（和`"_"`，这是因为您要求它的一部分`"\w"`）`"-"`。这基本上消除了您可能面临的任何代码注入威胁。

编辑：代替`"\w"`，您可以自由选择更紧密定义[的字符范围](http://www.regular-expressions.info/charclass.html)，我选择它只是为了简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:17:53.073

确保您的算法可以毫无问题地处理前导/尾随/额外空格 = )

同样值得考虑的可能是不适当标签的标签黑名单（例如亵渎）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:25:31.437

我从未实现过标记系统，但我可能很快就会为我正在从事的项目这样做。我主要是一个数据库专家，我突然想到，出于性能原因，最好通过解析表将您的标记实体与标记关键字相关联。因此，例如，使用示例表，例如：

**TechQuestion**
TechQuestionID (pk)
SubjectLine
QuestionBody

**TechQuestionTag**
TechQuestionID (pk)
TagID (pk)
活动（索引）

**标记**
TagID (pk)
TagText（索引）

...当使用从未使用过的标签时，您只会添加新的标签表条目。您将通过 TechQuestionTag 表条目重新关联以前提供的标签。您查询与给定标签相关的 TechQuestions 将如下所示：

```
SELECT
q.TechQuestionID,
q.SubjectLine,
q.QuestionBody
FROM
Tag t INNER JOIN TechQuestionTag qt
ON t.TagID = qt.TagID AND qt.Active = 1
INNER JOIN TechQuestion q
ON qt.TechQuestionID = q.TechQuestionID
WHERE
t.TagText = @tagText 
```

...或者你有什么。我不知道，也许这对每个人来说都是显而易见的，但我想我会把它放在那里......因为我不相信替代方案（冗余、索引、文本标签条目）不会查询为有效率的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T20:06:37.903

我希望您正在针对注入攻击进行通常的保护-也许这已包含在＃2中。

至少，您会想要转义引号字符并使嵌入的 HTML 无害——在 PHP 中，像[addlashes](http://us3.php.net/manual/en/function.addslashes.php)和[htmlentities](http://us3.php.net/manual/en/function.htmlentities.php)这样的函数可以帮助您。鉴于它是用于标记系统的，我猜你只想允许字母数字字符。我不确定实现这一目标的最佳方法是什么，也许是使用正则表达式。

# database - 计算机软件专家证人最重要的技术技能是什么？

> ID：474171
> 
> 赞同：5
> 
> 时间：2009-01-23T19:32:18.377
> 
> 标签：database

作为计算机软件专家证人，我需要分析大量不同的软件技术。在我的证词或审判证词期间，对方专家可能会提出旨在暴露或揭示我的弱点的问题。没有时间进行研究或教育。

鉴于我不可能成为每项技术的专家，我应该学习的最通用和可转移的技能或技术是什么？

我将从显而易见的开始：

1.  数据库无处不在（但哪些是最好的原型？）
2.  由于较旧的基于 Windows 和 DOS 的系统的流行，经常涉及 C

应该在这个列表中添加什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T19:41:17.673

我可能误读了您的问题，但我怀疑如果您被要求作为专家证人，您已经具备他们正在寻求的专业知识；我想，学习任何技术的更多技术方面会让你更有可能成为专家证人，但最终我会建议最好的技能是诚实。如果你不知道，就说出来。任何未知的问题都可以成为“待研究”列表供以后审查。

只是我的2美分...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T19:51:05.873

如果您不能成为提问的专家，那么将您称为专家证人将是愚蠢的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T19:57:33.193

嗯，作为证人的重要事情是倾听你为之作证的律师。在计算机世界中，您的可信度不容易受到质疑。如果他们试图这样做，那就是质疑正规教育或培训不足以成为专家。他们不会要求您解释图灵机是什么，或者如何在 LISP 中编写排序算法，除非它与手头的事情直接相关。他们不会播放“Gotcha！” 有困难的技术问题，因为它不会引起法官/陪审团的共鸣。你能想象有多少陪审团成员这样说：“我无法相信‘专家’不了解数据库规范化！真是个骗局！”？如果陪审团不理解问题，他们就不会理解答案。

不，你的可信度会受到外行人的质疑。如果你被要求作证，那是因为你有相关的答案。坚持这些，不要做任何花招（正如你的律师会告诉你的那样），你会没事的。如果您的信息是正确的，并且您的学位/经验是可靠的，您甚至可能不会被盘问（他们只会找到他们自己的专家说与您所说的相反）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T19:43:24.517

计算机软件专家证人还需要对网络技术有很好的了解，并能够向陪审团或法官解释。因为很多软件都是基于客户端/服务器的，所以能够解释防火墙、IP 地址、http、互联网路由器的工作方式以及为什么你可以判断某些软件在特定时间和位置肯定被使用是很重要的。

熟悉服务器操作系统及其生成的日志文件也很有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T20:15:58.290

我想说忘记在理解行业概念以及它们如何在现实世界中真正应用之外学习新技术。作为专家证人，您需要做的关键事情是用外行人容易理解的术语解释这些概念。你已经知道这些东西，否则你就不会*成为*专家证人。你在那里是因为你的名字和声誉被认为很好，他们[起诉/辩护]需要你的帮助。

我是这样想的：律师/大律师/律师的工作是推销他们对真相的*看法*，并让陪审团接受他们的看法（这种看法可能会或可能不会有偏差）。 *你的*工作是推销事实。两者要么是一回事，要么不是。尽你所能推销事实，如果你有容易理解的例子[通过容易理解，我的意思是一个 8 岁的孩子]，那就更好了。

我认为关键概念是人们将使用/利用来实施或掩盖犯罪的软件系统：

*   网络系统：通用协议、数据包跟踪等。
*   防火墙系统和常见漏洞。
*   病毒和复制：蠕虫与特洛伊木马等。
*   主要操作系统：基本概念和常见漏洞。
*   Web 应用程序：它们的结构以及如何利用它们。
*   常见的黑客概念：DoS、OOB、SQL 注入等。
*   电子邮件概念：传输、接收、跟踪、标头信息。
*   数据存储*和*恢复概念和关键软件。
*   监控技术：数据包分析、键盘记录器等。

我敢肯定还有其他一些，但没有其他人会立即浮现在脑海中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T19:46:08.413

一定要了解电子邮件系统。我想现在电子邮件通信在法庭案件中经常发挥作用。了解 SMTP 和 POP3 的工作原理。了解电子邮件服务器的基础知识以及操作它们的方式以及操作的难度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-23T19:46:48.300

我认为您是在自欺欺人，什么是“计算机软件专家证人”？这就像说，您是一名电气工程师，因此您有能力回答任何工程问题，无论它们来自化学、机械、土木还是其他特定的工程领域。

# wpf - 如何在 WPF 中扩展控件以为 ErrorTemplate 中的错误消息腾出空间？

> ID：474173
> 
> 赞同：4
> 
> 时间：2009-01-23T19:33:30.277
> 
> 标签：wpf, xaml

我有一个使用验证的 WPF 窗口。我创建了一个错误模板，它在验证失败的元素周围放置了一个红色边框，并在下面显示错误消息。这可以正常工作，但错误消息会呈现在带有错误的控件下方的任何控件之上。我能说的最好的情况是，发生这种情况是因为错误模板呈现在装饰层上，装饰层位于其他所有内容之上。我希望发生的事情是让其他所有内容都向下移动以为错误消息腾出空间。有没有办法做到这一点？网络上的所有示例似乎都使用了工具提示，并使用了一个简单的指示符，如星号或感叹号，不会占用太多空间。

这是模板：

```
<ControlTemplate x:Key="ValidationErrorTemplate">
    <StackPanel>
        <Border BorderBrush="Red" BorderThickness="2" CornerRadius="2">
            <AdornedElementPlaceholder x:Name="placeholder"/>
        </Border>
        <TextBlock Foreground="Red" FontSize="10" Text="{Binding ElementName=placeholder, Path=AdornedElement.(Validation.Errors)[0].ErrorContent, FallbackValue=Error!}"></TextBlock>
    </StackPanel>
</ControlTemplate> 
```

以下是使用模板的控件（我输入了其中的一些，因此请忽略任何语法错误）：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
    <RowDefinition Height="Auto"/>
  </Grid.RowDefinitions>
  <TextBox Name="Account" Grid.Row="0" Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}" Width="200">
    <TextBox.Text>
      <Binding Path="AccountNumber">
        <Binding.ValidationRules>
          <validators:RequiredValueValidationRule/>
          <validators:NumericValidationRule/>
        </Binding.ValidationRules>
      </Binding>
    </TextBox.Text>
  </TextBox>
  <TextBox Name="Expiration" Grid.Row="1" Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}" Width="100"  Margin="0,2,5,2">
    <TextBox.Text>
      <Binding Path="ExpirationDate">
        <Binding.ValidationRules>
          <validators:ExpirationDateValidationRule/>
        </Binding.ValidationRules>
      </Binding>
    </TextBox.Text>
  </TextBox>
</Grid> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T01:01:47.210

编辑：好吧，我不肯定这是最好的解决方案（我当然希望有人能提供更好的解决方案），但它是这样的：

您可以添加一些 TextBlocks 并将它们绑定到 Validation.HasError 和 (Validation.Errors)[0].ErrorContent，而不是使用 Validation.ErrorTeplate，它将在 AdornerLayer 中呈现所有视觉效果，使用客户 IValueConverter 转换Validation.HasError bool 到 Visibility 值。它看起来像下面这样：

窗口1.cs：

```
<Window x:Class="WpfApplicationTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:local="clr-namespace:WpfApplicationTest"
    Title="Window1" Height="300" Width="300">
    <Grid Margin="10">
        <Grid.Resources>
            <!-- The person we are binding to -->
            <local:Person x:Key="charles" Name="Charles" Age="20" />
            <!-- The convert to use-->
            <local:HasErrorToVisibilityConverter x:Key="visibilityConverter" />
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <!-- The name -->
        <TextBox Name="NameTextBox" Grid.Row="0" Text="{Binding Source={StaticResource charles}, Path=Name, ValidatesOnDataErrors=true}" />
        <TextBlock Grid.Row="1" 
                   Foreground="Red" 
                   Text="{Binding ElementName=NameTextBox, Path=(Validation.Errors)[0].ErrorContent}" 
                   Visibility="{Binding ElementName=NameTextBox, Path=(Validation.HasError), Converter={StaticResource visibilityConverter}}" />

        <!-- The age -->
        <TextBox Name="AgeTextBox" Grid.Row="2" Text="{Binding Source={StaticResource charles}, Path=Age, ValidatesOnExceptions=true}" />
        <TextBlock Grid.Row="3" 
                   Foreground="Red" 
                   Text="{Binding ElementName=AgeTextBox, Path=(Validation.Errors)[0].ErrorContent}" 
                   Visibility="{Binding ElementName=AgeTextBox, Path=(Validation.HasError), Converter={StaticResource visibilityConverter}}" />
    </Grid>
</Window> 
```

个人.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel;
using System.Text.RegularExpressions;

namespace WpfApplicationTest
{
    public class Person : IDataErrorInfo
    {
        public string Name { get; set; }
        public int Age { get; set; }

        #region IDataErrorInfo Members

        string IDataErrorInfo.Error
        {
            get { throw new NotImplementedException(); }
        }

        string IDataErrorInfo.this[string columnName]
        {
            get
            {
                switch (columnName)
                {
                    case ("Name"):
                        if (Regex.IsMatch(this.Name, "[^a-zA-Z ]"))
                        {
                            return "Name may contain only letters and spaces.";
                        }
                        else
                        {
                            return null;
                        }
                    default:
                        return null;
                }
            }
        }

        #endregion
    }
} 
```

HasErrorToVisibilityConverter.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Data;
using System.Windows;

namespace WpfApplicationTest
{
    [ValueConversion(typeof(bool), typeof(Visibility))]
    public class HasErrorToVisibilityConverter : IValueConverter
    {
        #region IValueConverter Members

        object IValueConverter.Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            bool hasError = (bool)value;
            return hasError ? Visibility.Visible : Visibility.Collapsed;
        }

        object IValueConverter.ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion
    }
} 
```

它的扩展性不如您可以在所有控件中引用的单个 ControlTemplate，但它是我找到的唯一解决方案。我感觉到你的痛苦——几乎我能找到的关于 WPF 验证主题的每个示例都非常简单，并且几乎总是使用“！” 或 '*' 在控件之前，工具提示绑定到 (Validation.Errors)[0].ErrorContent...

祝你好运！如果我找到更好的解决方案，我会更新这个；）

# .net - MVC 控制器应该在单独的 DLL 中吗？

> ID：474180
> 
> 赞同：7
> 
> 时间：2009-01-23T19:34:37.983
> 
> 标签：.net, winforms, model-view-controller, design-patterns

我创建了一个 .NET winforms MVC。控制器和视图在同一个 EXE 中。模型位于一组被多个组使用的 DLL 中。MVC 非常明确。模型对控制器一无所知，控制器对视图一无所知。我正在考虑将控制器放在自己的 DLL 中，以便对其进行单元测试。非常不像有人会重用控制器。*单元测试是我*进入 DLL的唯一原因。

从概念上讲，控制器是否应该始终与视图在同一个程序集中？有什么理由支持/反对让他们在一起？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T19:58:15.843

控制器和视图的分离是一个抽象的概念。没有严格的规则要求您在物理上将它们分开（就像三层应用程序中的层一样）。然而，这两种方法都可能有一些优势。

分离组件具有以下好处：

*   减少将视图意外耦合到控制器并破坏分离的可能性。
*   无需重新编译控制器就可以更轻松地编辑视图（从部署的角度来看这很棒）。
*   构建视图和控制器是分开的，因此即使另一个根本没有构建，您也可以测试其中一个。

但是，对于小型项目，这可能是不可行的。对于非常小的项目，您可能希望发布一个可执行文件，而不是其他任何东西。此外，您可能不想创建 3 个单独的项目。

嘿，你可能根本不想对它进行单元测试；）哎呀，我的头受伤了，这块大砖是从哪里来的？:))

# sharepoint - 使用应用程序页面进行 SharePoint 个性化

> ID：474182
> 
> 赞同：1
> 
> 时间：2009-01-23T19:35:07.140
> 
> 标签：sharepoint, moss, personalization

我正在尝试在部署到 SharePoint 的 ASP.NET 应用程序上实现个性化（WebPartManager 和 WebParts）作为应用程序页面（单独的应用程序和 aspx 页面部署到 _layouts）。

我想利用 SharePoint 个性化提供程序，因此我可以将提供程序连接到 ASP.NET 应用程序中的 WebPartManager。然而，SharePoint 似乎调用 SPRequest 对象来执行这些任务，并且没有用于个性化的提供程序。

我尝试的第二个选项是在这些页面上使用 SharePoint WebPartManager，但它似乎不起作用，因为应用程序页面不是 SharePoint 内容数据库中的上传页面，因此当我尝试添加/个性化 Web 部件时收到错误消息。

有谁知道在应用程序页面上使用 SharePoint 个性化的简洁方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T16:40:53.713

通常，应用程序页面不绑定到特定站点。Webpart 管理器将个性化值与页面来源站点中的页面保持一致。

您可能可以通过使用 ASP.NET 个性化来完成您正在尝试做的事情。但是你必须使用 [我认为] 默认情况下想要使用 SQL Server 的 ASp.NET 个性化基础设施。

当然，这样做的缺点是您将实施 2 个个性化基础架构。这可能意味着部署难题。

罗杰威廉姆斯富兰克林实验室

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T07:29:18.923

应用程序页面在 Farm 中的应用程序之间共享，不支持个性化。您需要将它们部署为发布页面以使用个性化。您可以尝试使用功能和作为 Ghostable 上传这些文件。这样您就不需要将它们放在 Pages Library 中，您可以将它放在您想要的任何 Web 文件夹中。有关更多信息，请参阅此[链接](http://msdn.microsoft.com/en-us/library/cc406685.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T09:17:53.810

您可能希望将页面布局用于发布页面而不是应用程序页面。

# c# - 如何传递将用作数据表中行的过滤器的 lambda？

> ID：474184
> 
> 赞同：3
> 
> 时间：2009-01-23T19:35:30.150
> 
> 标签：c#, linq

我有一些代码接受 DataTable 作为参数并计算 DataTable 中几列的总数。我认为能够传入一个 lambda 表达式可能会很好，该表达式将对我总计的列执行过滤器。

这是代码的一部分：

```
public TrafficTotals CalculateTotals(DataTable table)
{
    TrafficTotals total = new TrafficTotals();
    total.TotalTraffic = table.AsEnumerable().Sum(p => p.Field<int>("Converted"));
    // More stuff 
```

我可以直接在代码中手动将过滤器添加到表达式中：

```
var filteredTotal = table.AsEnumerable().Where(p => p.Field<string>("MyColumn") == "Hello").Sum(p => p.Field<int>("Converted")); 
```

但相反，我想将“Where”部分作为 lambda 表达式传递，但我一直迷失在语法中以获取正确的参数。

我有几种解决这个问题的方法，这些方法并不真正涉及 lambda，但它似乎是处理这个问题的好方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T19:41:03.897

我有点困惑，因为您*已经*使用 lambda 表达式指定 Where 子句，但我怀疑您想要这个：

```
public TrafficTotals CalculateTotals(DataTable table, 
                                     Func<DataRow, bool> filter)
{
    TrafficTotals total = new TrafficTotals();
    total.TotalTraffic = table.AsEnumerable()
                              .Where(filter)
                              .Sum(p => p.Field<int>("Converted"));
    // More stuff
} 
```

然后，您可以使用以下命令调用它：

```
totals = CalculateTotals(table, 
                         row => row.Field<string>("MyColumn") == "Hello"); 
```

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:44:17.917

如果要存储 lambda 表达式，则需要像这样声明它。如果整数小于 3，这将返回 true，例如：

```
Func<int,bool> F = o=>o < 3 
```

然后你可以传递它。

# javascript - IE & Firefox 是否有 div 宽度限制？

> ID：474192
> 
> 赞同：1
> 
> 时间：2009-01-23T19:39:05.760
> 
> 标签：javascript, css, internet-explorer, firefox

简而言之，我正在尝试制作一个天气滚动器，它将水平显示大约 50 个城市的天气。我遇到的问题是 IE 和 FF 都在制作 2-3 行的城市，而 Chrome 将其保持在一个不错的水平线上。所以 Chrome 有 1 行随天气滚动，而 IE+FF 有 2-3 行。我已将我当前的代码粘贴到 pastebin 以不溢出页面。

[http://pastebin.ca/1316234](http://pastebin.ca/1316234)

有人有什么主意吗？

谢谢你。

编辑：忽略读取的最后 Javascript 行`widnow.onresize`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T21:03:19.240

您执行以下操作：

```
.weather_entry{
 display:inline;
 float:left;
} 
```

这是不允许的。仅块级元素支持浮点数。使用以下应该做你想做的事。

```
.weather_entry{
 display:block
 float:left;
} 
```

浮动将确保元素显示为内联。另外我不太确定你为什么要让选框浮动：左，但你可能有你的理由。

# python - 如何将 id 从 url 传递到 urls.py 中的 post_save_redirect

> ID：474203
> 
> 赞同：0
> 
> 时间：2009-01-23T19:42:18.980
> 
> 标签：python, django, django-urls

我在数据库中有几个对象。使用通用视图编辑对象的 URL 看起来像特定对象的 id 在`site.com/cases/edit/123/`哪里。`123`考虑`cases/url.py`内容：

```
url(r'edit/(?P<object_id>\d{1,5})/$', update_object, { ... 'post_save_redirect': ???}, name = 'cases_edit'), 
```

`update_object`通用视图在哪里。如何构造`post_save_redirect`to 指向`site.com/cases/edit/123/`. 我的问题是，我不知道如何将`id`对象传递给重定向函数。我试过类似的东西：

```
'post_save_redirect': 'edit/(?P<object_id>\d{1,5})/'
'post_save_redirect': 'edit/' + str(object_id) + '/' 
```

但显然这些都不起作用。`reverse`建议使用功能，但如何通过特定的`id`？

```
'post_save_redirect': reverse('cases_edit', kwargs = {'object_id': ???}) 
```

`{% url %}`在寺庙里也需要传递`id`特定的对象。`id`可以通过`extra_context`：

```
extra_context = {'object_id': ???} 
```

在所有情况下，问题都是`object_id`从 url 获取。

问候
克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T21:52:17.893

简而言之，您需要做的是包装 update_object 函数。

```
def update_object_wrapper(request, object_id, *args, **kwargs):
    redirect_to = reverse('your object edit url name', object_id)
    return update_object(request, object_id, post_save_redirect=redirect_to, *args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:05:47.690

首先，阅读[反向](http://docs.djangoproject.com/en/dev/topics/http/urls/?from=olddocs#reverse)功能。

其次，阅读`{%` [url](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#url) `%}`标签。

您`reverse`在视图中使用该函数来生成预期的重定向位置。

此外，您应该`{% url %}`在模板中使用标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-26T20:42:27.460

直接来自文档：[https ://docs.djangoproject.com/en/dev/ref/generic-views/#django-views-generic-create-update-create-object](https://docs.djangoproject.com/en/dev/ref/generic-views/#django-views-generic-create-update-create-object)

post_save_redirect 可能包含字典字符串格式，它将根据对象的字段属性进行插值。例如，您可以使用 post_save_redirect="/polls/%(slug)s/"。

# wpf - WPF圆角背景渗出

> ID：474204
> 
> 赞同：7
> 
> 时间：2009-01-23T19:42:27.217
> 
> 标签：wpf, xaml, rounded-corners

我正在首次涉足 WPF - 我有一个简单的表单，其中包含为内联帮助定义的弹出窗口。我正在使用圆角，由于某种原因，黑色背景在角落周围渗出。我不明白是哪个元素导致了问题。

[替代文字 http://www.awbrey.net/rounded.jpg](http://www.awbrey.net/rounded.jpg)

我认为这是我没有看到的非常明显的东西。这是我正在使用的 XAML：

```
<Window x:Class="Consent.Client.SubjectNumberEntry"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" FontSize="24"
    Title="SubjectNumberEntry" WindowStyle="None" WindowState="Maximized"
        xmlns:h="clr-namespace:Consent.Client" KeyDown="windowOuter_KeyDown" Background="White" Name="windowOuter" AllowsTransparency="true" Loaded="Window_Loaded">

    <StackPanel Height="400" DockPanel.Dock="Top" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10">
        <StackPanel Height="60" Orientation="Horizontal" VerticalAlignment="Center">
            <TextBox Name="txtSubjectNumber" Margin="10" Width="400" KeyDown="txtSubjectNumber_KeyDown" h:HelpProvider.HelpString="Enter the subject identifier, or scan their wristband">
                <TextBox.ToolTip>This is a textbox</TextBox.ToolTip>
            </TextBox>
            <Button Name="btnEnter" Margin="10" Width="100" Click="btnEnter_Click">Enter</Button>
            <Button Width="50" Name="btnHelp" Margin="10" Click="btnHelp_Click">?</Button>
            <Button Width="50" Name="btnExit" Margin="10" Click="btnExit_Click">Exit</Button>

        </StackPanel>
        <Label Name="lblValue" Margin="10"></Label>

        <Popup Placement="Bottom" HorizontalAlignment="Center" VerticalOffset="10" MouseDown="popHelp_MouseDown" PopupAnimation="Fade" Name="popHelp" PlacementTarget="{Binding ElementName=txtSubjectNumber}">
            <Border Padding="10" Margin="10" BorderBrush="CornflowerBlue" BorderThickness="1" CornerRadius="10" Background="CornflowerBlue">
                <TextBlock FontSize="12" Background="CornflowerBlue">This is the content of the help box.</TextBlock>
            </Border>
        </Popup>

    </StackPanel>

</Window> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-23T20:35:28.500

我认为这是导致问题的弹出窗口。尝试在弹出窗口中将 AllowsTransparency 设置为 True。

[Popup.AllowsTransparency](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.allowstransparency.aspx)

当设置为 False 时，任何透明颜色都与黑色“合并”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T18:52:25.090

您还可以将弹出窗口包裹在具有圆角的边框中。如果您无法更改弹出窗口的 AllowsTransparency，这很有用。

像这样的东西：

```
<Border CornerRadius="10">
    <Popup Placement="Bottom" HorizontalAlignment="Center" VerticalOffset="10" MouseDown="popHelp_MouseDown" PopupAnimation="Fade" Name="popHelp" PlacementTarget="{Binding ElementName=txtSubjectNumber}">
        <Border Padding="10" Margin="10" BorderBrush="CornflowerBlue" BorderThickness="1" CornerRadius="10" Background="CornflowerBlue">
            <TextBlock FontSize="12" Background="CornflowerBlue">This is the content of the help box.</TextBlock>
        </Border>
    </Popup>
</Border> 
```

# html - 在表格中设置交替行样式的最佳方法是什么？

> ID：474216
> 
> 赞同：2
> 
> 时间：2009-01-23T19:45:13.937
> 
> 标签：html, css, css-tables

显然，奇/偶行的实际样式将通过 CSS 类完成，但是将类“附加”到行的最佳方法是什么？将它放在标记中更好，还是通过客户端javascript更好？哪个更好？为什么？

为简单起见，我们假设这是一个大表，有 100 行，并且颜色方案是交替奇数行/偶数行。此外，页面中的其他地方需要某种可以轻松执行此操作的 javascript 库，因此该包的开销不是一个因素。

* * *

这个问题的真正目标是确定涉及哪些权衡以及应该如何处理这些权衡，例如如果页面在负载下命中（假设是动态表）对服务器的性能影响，带宽命中对于连接速度较低的用户，通过向 HTML 添加额外的布局代码来实现语义命中（这里的想法是 HTML 用于内容，CSS 用于布局，javascript 用于内容的行为方式以及控制/增强布局）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-23T19:51:56.183

您可以使用 jQuery 轻松完成此操作，如下所示：

```
$(function(){
    $('tr:even').addClass('alternateClass');
    $('tr:odd').addClass('mainClass');
}); 
```

如果您只想在一个特定表上执行此操作，或者也对“li”元素执行此操作，则可以对选择器进行更多限定。

我认为这在客户端比在某些服务器端环境中更干净、更易读，

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T19:49:19.123

我会把它放在标记中（服务器端）。服务器不到一毫秒就可以完成`rowNum = (rowNum - 1) * -1`当一个网站因为执行了多少javascript而运行缓慢时，这是我的一个小烦恼。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T19:52:57.383

正如在其他答案中所说，在客户端的大表上执行此操作将比在服务器端慢，并且如果用户禁用了 javascript，则可能无法正常工作。

然而，使用像[jQuery](http://www.jquery.com)这样的 JS 框架让它变得如此简单，以至于它真的很诱人：

```
$(document).ready(function() {
  $('.myTable tr:odd').addClass('alternateRow');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T19:48:29.123

对于如此大的表，我会在服务器端进行行处理，使用 PHP 或类似方法计算每行的奇数/偶数类名。这个解决方案适用于那些关闭了 JavaScript 的人，并且比任何处理这种大小的表格元素的 JavaScript 库的性能都要高得多。

在 PHP 中，逻辑看起来像

```
foreach($rows as $i => $row) {
    $class = ($i % 2 == 0) ? 'even' : 'odd';
} 
```

如果您无法进行任何服务器端处理，我建议您让 JavaScript 为每一行设置类标签，而不是直接操作样式。这样，演示留给 CSS，行为留给 JavaScript，如果您在以后更改类的生成方式，演示代码将保持不变。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T20:05:43.833

我最初会在服务器端执行此操作，因为客户端可能没有启用 javascript。如果您使用 javascript 在客户端添加/删除行，那么您可能还希望能够在添加/删除事件完成后在客户端上执行此操作。除非您可以控制浏览器环境（例如，在您可以要求启用它的 Intranet 应用程序中），否则您应该尽可能尝试让您的界面在没有 Javascript 的情况下表现良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T20:09:03.997

总有一天，我们将能够只使用[纯 CSS](http://www.w3.org/Style/Examples/007/evenodd)。当然，这部分 CSS 规范是在**2001**年引入的，现在仍然不受支持。=(

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T20:10:53.540

你想要完成的事情甚至可以用 CSS3 来完成：

```
tr:nth-child(odd) { background: #FFF; }
tr:nth-child(even) { background: #AAA; } 
```

这也列在[w3 的 css3 选择器规范](http://www.w3.org/TR/css3-selectors/#nth-child-pseudo)中。如果您正在寻找兼容性，添加类服务器端或通过 javascript 将是一个更好的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-23T19:49:58.310

这取决于你的场景。如果表不是即时创建的，则基于 JavaScript 的多行可能会更快地实现。但是，如果您正在动态创建表，则可以很容易地将每隔一行的类设置为“row_alternate”——如果您担心某些用户可能没有 JavaScript，我更喜欢服务器端方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-23T19:52:18.073

如果您使用任何类型的框架，这通常是它们包含的第一个功能。

否则，我在 Google 上搜索“jscript 表格交替颜色”并获得了几十个技术链接。

**（顺便说一句：开发人员从来没有因为他们没有**编写的代码而获得赞誉，这太糟糕了。）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-23T19:55:24.540

我总是在服务器端应用类，因为它们被流式传输/添加到页面，但如果您有客户端重新排序，则需要重新分类行。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T19:58:22.817

我找到了一个很好的网站来解释你想用 jquery 实现什么：

这是最终输出 - [http://15daysofjquery.com/examples/zebra/code/demoFinal.php](http://15daysofjquery.com/examples/zebra/code/demoFinal.php)

这是教程 -http: [//15daysofjquery.com/examples/zebra/](http://15daysofjquery.com/examples/zebra/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-23T20:01:18.647

我会说真的，这取决于情况。如果您正在遍历数据以在服务器端创建行，我可能会说您应该在那里进行。

如果您要开始使用客户端脚本对行进行排序/重新排序，这会变得更加复杂。在这种情况下，如果它有 100 行左右，我可能倾向于在 onload 事件客户端执行此操作，因为至少这样您就不会复制代码来确定行颜色。我承认，在这种情况下，这真的取决于它的速度。在做出最终决定之前，我可能会尝试一下，看看性能是否可以接受。

# c# - DataGridView/ListView - 以 Outlook 样式显示？

> ID：474224
> 
> 赞同：1
> 
> 时间：2009-01-23T19:46:41.047
> 
> 标签：c#, visual-studio, datagridview, datagridviewcolumn

我习惯使用 Telerik Grids，并且能够以 Outlook 样式显示它们，即最左侧的图片、粗体标题和主标题下的其他几行文本。

有没有办法使用标准的 .Net2.0 Windows 控件来做到这一点？使用便宜的控件，还是现有的 datagridview 或 listview？

基本上，我需要能够生成如下布局：

```
Job Title
Engineer: Fred Bloggs
Product: Some random product 
```

所以，我将在一个网格中有 2000 个左右的这些项目，每个项目旁边都有一个状态图像，实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T01:25:37.743

这是使用列表视图的帮助。我会选择列表，因为你只有一列，所以不需要网格。

你想使用：

```
private void lstItems_DrawItem(object sender, DrawItemEventArgs e) 
```

然后使用 e.Graphics 获取可以直接绘制的对象。

我使用本[教程](http://www.codeproject.com/KB/books/1930110286_10.aspx)来帮助我了解如何在 ListView 中绘图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:22:28.203

我不能给你一个例子，因为我现在没有时间写它，但是你可以创建一个 UserControl 来布置你想要看到的行。然后，您必须创建自己的 DataGridViewCell 来处理 UserControl 而不是 MS 提供的标准单元格类型。对于您的每个条目，创建并填充用户控件并将其添加到 DataGridView 中的另一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T23:08:56.777

我一直在寻找同样的东西。我刚刚遇到了一些有趣的事情。查看免费的 Visual Basic Power Packs 3.0（您可以从任何 .NET 语言（包括 c#）中引用它）：

[http://msdn.microsoft.com/en-us/vbasic/bb735936.aspx](http://msdn.microsoft.com/en-us/vbasic/bb735936.aspx)

它基本上让您使用所需的任何控件设计单行，然后使用绑定的数据重复该行

# javascript - 文本中的星号会导致 getJSON 请求不起作用吗？

> ID：474239
> 
> 赞同：0
> 
> 时间：2009-01-23T19:50:36.297
> 
> 标签：javascript, jquery, asp.net-mvc

这真的很奇怪，但这段代码可以正常工作，除非用户输入的值包括星号 (*) 或其他字符，如 $ 或 #。#ticketNumber.Val() 是可疑的问题。我们的一些 id 中有一个 *。任何帮助，将不胜感激。

```
function buttonClicks() {
    var action = '/ServiceCall/IsAServiceCall/' + $('#ticketNumber').val() + '?x=' + new Date().getTime();
    $('#ticketNumberFilter').hide();
    $('#loading').show();
    $.getJSON(action,
        { ticketNumber: $("#ticketNumber").val() },
        function(callData) {
            if (callData.status == true) {
                window.location = "/ServiceCall/Show/" + $("#ticketNumber").val();
            }
            else {
                $('#loading').hide()
                $('#ticketNumberFilter').show();
                $("#ticketListMessage").slideDown("slow");
                $("#ticketNumber").val("");
            }
        });
} 
```

这是控制器：当有 * 时，控制器永远不会被击中：

```
 public JsonResult IsAServiceCall(string ticketNumber)
    {
        IServiceCallService scService = new ServiceCallService();
        return (Json(new { status = scService.IsAServiceCall(ticketNumber) } ));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:17:15.680

我的猜测是（正如 RoBorg 建议的那样），MVC 框架使用的 URL 重写器认为 * 是一个特殊字符......我不能确定问题是什么，但似乎你可以避免只需在请求之前删除星号并在服务器端再次添加它们，就可以很容易地发出问题：

```
var ticketNumber = $('#ticketNumber').val().split('*').join('&asterisk;'); 
```

在服务器端，您可以反转该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T20:02:57.020

A`*`不应该引起问题，而是`#`意志 - 您应该使用 URL 对值进行编码[`encodeURIComponent()`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/encodeURIComponent)：

```
var action = '/ServiceCall/IsAServiceCall/' + encodeURIComponent($('#ticketNumber').val()) + '?x=' + new Date().getTime(); 
```

你的也一样`window.location`

# mod-rewrite - 每个子域（10000+）有 1 个 A 记录；任何潜在的问题？还有其他解决方案吗？

> ID：474244
> 
> 赞同：1
> 
> 时间：2009-01-23T19:51:35.063
> 
> 标签：mod-rewrite, dns, subdomain, bind

我在此处阅读的大多数在 DNS 级别支持每个用户的子域的解决方案都是使用 *.domain.com 将所有内容指向一个 IP。

这是一个简单的解决方案，但是如果我想将前 1000 个注册用户指向 serverA，然后将接下来的 1000 个注册用户指向 serverB，该怎么办？这是我们降低集群软件和硬件成本的首选解决方案。

[alt text http://learn.iis.net/file.axd?i=1101](http://learn.iis.net/file.axd?i=1101) （从 MS IIS 站点引用的图表）

最合乎逻辑的解决方案似乎是在区域数据文件中每个子域有 1 个 A 记录。BIND 似乎对区域数据文件没有任何大小限制，只限于可用内存。

但是，我的团队担心启动和准备新子域的延迟，因为创建新子域包括插入新的 A 记录和重新启动 DNS 服务器。

我们应该担心重新启动 DNS 服务器的性能吗？

先感谢您。

**更新：**

似乎你们中的大多数人建议我改用反向代理设置：

[替代文字 http://learn.iis.net/file.axd?i=1102](http://learn.iis.net/file.axd?i=1102)

（ARR是IIS7的反向代理方案）

但是，这是我可以看到的缺点：

1.  单点故障
2.  无法根据 IP 地理位置战略性地在不同位置设置服务器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T19:54:42.857

使用通配符 DNS 条目，然后使用负载平衡在服务器之间分配负载，无论它们是什么客户端。

当您使用它时，请跳过 URL 重写步骤并让您的应用程序根据输入的 URL 确定它是哪个帐户（您可以像在 domain.com?user 中一样轻松地确定 X.domain.com 中的 X 是什么？ =X)。

编辑：根据您的附加信息，您可能希望开发一个“代理”来存储哪些客户端要访问哪些服务器。使该面向公众，然后从与代理存储的客户端相关联的资源中提取。您的前端可以进行负载平衡，然后您可以根据它们的身份从文件/数据库服务器中获取它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T11:30:33.310

带有通配符 DNS 条目的前端代理确实是解决这个问题的方法。这就是 LiveJournal 等大型网站的运作方式。

请注意，这不仅仅是一个 TCP 层负载平衡器 - 有很多解决方案可以检查 URL 的主机部分，以确定哪个后端服务器也转发查询。[您可以通过在具有适当配置](http://www.apachetutor.org/admin/reverseproxies)的低规格服务器上运行的 Apache 轻松做到这一点。

代理确保每个用户的会话始终转到正确的后端服务器，并且大多数会话处理方法都将继续工作。

此外，代理不必是单点故障。在冗余配置中运行两个或多个前端代理（以避免故障）甚至让它们共享负载（以避免压力）是完全可能的并且非常容易。

我还赞同 John Sheehan 的建议，即应用程序只需查看 URL 的左侧部分来确定要显示哪个用户的内容。

如果后端使用 Apache，请参阅[这篇文章](https://stackoverflow.com/questions/321259/how-to-setup-sub-domains-like-blogspot#321292)以获取有关如何配置它的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:20:31.903

如果你使用tinydns，你修改它的数据库就不需要重新启动nameserver，它不应该是一个瓶颈，因为它通常非常快。我不知道它是否在超过 10000 个条目时表现良好（如果不是，我会感到惊讶）。

[http://cr.yp.to/djbdns.html](http://cr.yp.to/djbdns.html)

# email - 允许基于 Web 的电子邮件系统向发件人的个人电子邮件地址发送回复和退回邮件的最佳方式是什么？

> ID：474245
> 
> 赞同：1
> 
> 时间：2009-01-23T19:51:48.103
> 
> 标签：email, return-path

我有一个只有注册用户才能使用的网络应用程序，因此我应该为消息的创建者提供一个有效的电子邮件地址。

此 Web 应用程序的一部分将允许用户创建电子邮件消息并将其发送到用户输入的电子邮件地址。我的网络服务器将创建和发送电子邮件，但是如果电子邮件出现传递问题，我希望退回邮件到用户的电子邮件地址而不是服务器。这将使用户知道传递消息时出现问题，他们可以采取适当的措施。

将“return-path”属性设置为用户的电子邮件地址会处理这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T19:58:32.210

正如[RFC2821](http://www.ietf.org/rfc/rfc2821.txt)所说：

> Return-path 的主要目的是指定将指示未投递或其他邮件系统故障的消息发送到的地址。为了明确这一点，当消息被传递时，应该恰好存在一个返回路径。

所以是的，所有符合标准的服务器都应该考虑到`Return-path`您的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:58:11.210

您可以在您的服务器上设置 Windows 服务，以定期检查 BadMail 文件夹并解析退回的邮件并将它们重新发送给原始发件人。该解决方案在大多数情况下都有效。我不认为 return-path 在每种情况下都会有所帮助（如果有的话），因为不同的邮件服务器处理退回的方式不同。

# c# - 只写队列？

> ID：474259
> 
> 赞同：0
> 
> 时间：2009-01-23T19:55:01.063
> 
> 标签：c#, .net, security

我正在开发一个通过接口加载不受信任的程序集的应用程序。这些程序集中的每一个都应该能够将一个或多个 GameAction 对象添加到服务器使用的线程安全队列中。

设计的第一次迭代只是通过队列——像这样：

```
public interface IGameClient
{
  void HandleStateChange(IGameState gameState, 
                         ref Queue<IGameAction> actionQueue);
} 
```

但是，这样做的问题在于，它为不受信任的程序集提供了对共享队列的访问权限，从而允许它操纵队列的其他成员并发现有关其他队列操作的信息。

第二遍是：

```
public interface IGameClient
{
  void HandleStateChange(IGameState gameState);
  GameActionDelegate event HasNewEvent; // passes IGameAction as a parameter
} 
```

这样做的问题是它不一定允许对操作进行排序或分组。

我真正希望的是能够传递对封装线程安全队列的对象的引用，但只公开 Enqueue()。但是，我担心不受信任的程序集可能会使用反射来操纵私有 Queue 对象。

那么，处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:04:30.060

没有特定顺序的想法：

1）事件*确实*保证了顺序（或者至少，您的实现可以保证您想要的任何顺序，并且最简单的实现将保留顺序）。

2）我不明白你为什么要在接口的第一个示例中通过引用传递队列。可能值得检查您是否了解[参数传递和 "ref"](http://pobox.com/~skeet/csharp/threads/parameters.html)。

3）如果你想出一个只公开 Enqueue 的接口，那么实现大概不会*是*`Queue<T>`. 它可能*包含*一个`Queue<T>`，但如果您真的不相信程序集不会与您的私人成员发生冲突，您应该以不授予它们相关反射权限的方式加载它们。

另一种选择可能是传入一个`Action<IGameAction>`客户端可以在它想要将项目添加到队列时调用的。委托将从您拥有的任何 Enqueue 方法创建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:06:36.937

根本不要公开队列——只需在外观上公开一个方法，该方法允许 GameClient 提交 GameServer 将放置在内部队列中的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T20:10:08.177

您可以让 HandleStateChange 方法返回 IEnumerable<IGameAction>、IList<IGameAction> 或 IGameAction[]：

```
public interface IGameClient
{
  IGameAction[] HandleStateChange(IGameState gameState);
} 
```

然后使用该返回值将操作添加到队列中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T20:10:26.053

传递一个新创建的队列实例，当 HandleStateChange 返回时，将虚拟队列中的内容合并到真实队列中。

# python - Python pysqlite 不接受我的 qmark 参数化

> ID：474261
> 
> 赞同：1
> 
> 时间：2009-01-23T19:55:18.097
> 
> 标签：python, sqlite, pysqlite, python-db-api

我想我是个傻瓜，也许没有导入正确的包，但是当我这样做时......

```
 from pysqlite2 import dbapi2 as sqlite
import types
import re
import sys
...
    def create_asgn(self):
        stmt = "CREATE TABLE ? (login CHAR(8) PRIMARY KEY NOT NULL, grade INTEGER NOT NULL)"
        stmt2 = "insert into asgn values ('?', ?)"
        self.cursor.execute(stmt, (sys.argv[2],))
        self.cursor.execute(stmt2, [sys.argv[2], sys.argv[3]])
... 我收到错误 pysqlite2.dbapi2.OperationalError: near "?": syntax error
```

这对我来说意义不大，因为文档显示 pysqlite 是 qmark 参数化的。不过，我是 python 和 db-api 的新手，请帮帮我！谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T20:05:50.603

那是因为参数只能传递给 VALUES。表名不能参数化。

此外，您在第二个查询的参数化参数周围有引号。删除引号，转义由下划线库自动为您处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:10:00.017

尝试删除分配给的行中的引号`stmt2`：

```
 stmt2 = "insert into asgn values (?, ?)" 
```

此外，正如 nosklo 所说，您不能将问号参数化与 CREATE TABLE 语句一起使用。将表名直接粘贴到 SQL 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-20T22:09:07.913

如果您真的想这样做，请尝试以下操作：

定义读取（db =“项目”）：

```
sql = "select * from %s"
sql = sql % db
c.execute(sql) 
```

# objective-c - 在 Cocoa Touch 中从字符串中修剪空格的最佳方法是什么？

> ID：474270
> 
> 赞同：24
> 
> 时间：2009-01-23T19:58:04.877
> 
> 标签：objective-c, string, cocoa-touch, whitespace

我正在寻找确定来自用户输入（UITextField）的字符串值是否为“空白”，如果它不为零。检查是否`[textField.text isEqualToString:""]`不够，因为我想避免任何空白/空格输入（比如几个空格字符）。

[在这篇 StOv 帖子](https://stackoverflow.com/questions/422242/simple-string-parsing-in-cocoa-objective-c-parsing-a-command-line-into-command)中，似乎确实有迹象表明我的特定问题有一个很好的解决方案。

基本上它是这样的，但我怀疑必须（或应该）有更好的方法：

```
NSString *strResult;
NSScanner* scanner = [NSScanner scannerWithString:textField.text];
BOOL hasValidChars = [scanner scanUpToCharactersFromSet:[NSCharacterSet whitespaceAndNewlineCharacterSet] 
                                             intoString:&strResult];

// if hasValidChars == YES, we've got nonwhite space chars collected into strResult 
```

这显然只适用于我的特定情况，即使这样，如果第一个字符是空格但我想要的数据紧随其后，它也会失败。所以，我意识到我有点被 Ruby 宠坏了，但是在 Cocoa 中必须有一个经过验证的、真正的习惯用法来修剪字符串。

**Aaaand 答案已经出来了，我很抱歉：**

NSString`-stringByTrimmingCharactersInSet:`会这样做：

> 返回通过从给定字符集中包含的接收者字符的两端删除而生成的新字符串。

我仍然很想知道是否有人有其他/首选的方法来做到这一点。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-23T20:22:18.183

您正在使用 whitespaceAndNewlineCharacterSet，很好。但是不使用scanUpToCharactersFromSet，为什么不使用stringByTrimmingCharactersInSet？像这样的东西...

```
strResult = [strResult stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
```

编辑：直到我发布此内容后，才意识到您已经找到了 stringByTrimmingCharactersInSet。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-09-30T20:04:13.380

你正在寻找的是

`[string stringByReplacingOccurrencesOfString:@" " withString:@""]`.

删除字符串中间的空白不称为“修剪”。

**根据定义进行修剪从边缘开始。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-29T18:39:20.487

为了使您自己更轻松，而不是创建子类，您可以修改现有的 Apple 类并执行类似的操作

```
//
// NSString+MyExtensions.h
//

@interface NSString (MyExtensions)

- (NSString *)trimmed;

@end 
```

和实施

```
//
// NSString+MyExtensions.m
//

#import "NSString+MyExtensions.h"

@implementation NSString (MyExtensions)

- (NSString *)trimmed {
     return [self stringByTrimmingCharactersInSet:
             [NSCharacterSet whitespaceAndNewlineCharacterSet]];
}

@end 
```

因此，现在在您的应用程序中使用 的任何地方，您现在都`NSString`可以像下面这样
调用`[@" hello world " trimmed]`

```
//
// ViewController.m
//

#import "NSString+MyExtensions.h"

@implementation ViewController

- (void)viewDidLoad {

    NSString *string = @"      This is a string    ";

    NSLog(@"The original string: %@ \n The trimmed string: %@\n\n",
          string,
          [string trimmed]);

    string = @"                 ";

    if([string trimmed].length == 0)
        NSLog(@"%@", @"String is empty! :O");

}

@end 
```

哪个会打印出来

```
The original string:       This is a string    
The trimmed string: This is a string

String is empty! :O 
```

# python - 解析的部分评估

> ID：474275
> 
> 赞同：3
> 
> 时间：2009-01-23T19:59:01.693
> 
> 标签：python, parsing, macros, language-design

我正在为 Python 开发一个宏系统（[如此处所讨论的](https://stackoverflow.com/questions/454648/pythonic-macro-syntax)），我一直在考虑的一件事是度量单位。尽管可以在没有宏或通过静态宏（例如提前定义所有单位）的情况下实现度量单位，但我正在玩弄允许在运行时动态扩展语法的想法。

为此，我正在考虑在编译时对代码使用一种部分评估。如果对给定表达式的解析失败，由于其语法的宏不可用，编译器将停止对函数/块的评估，并生成它已经拥有的代码，其中包含未知表达式所在的存根。当此存根在运行时被命中时，该函数将针对当前宏集重新编译。如果此编译失败，将引发解析错误，因为执行无法继续。如果编译成功，新函数将替换旧函数并继续执行。

我看到的最大问题是，在受影响的代码运行之前，您无法找到解析错误。但是，这不会影响很多情况，例如 []、{}、() 和 `` 等组运算符仍然需要配对（我的标记器/列表解析器的要求），以及类和函数等顶级语法不会受到影响，因为它们的“运行时”实际上是加载时间，在那里评估语法并生成它们的对象。

除了实现困难和我上面描述的问题，这个想法还有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T12:58:26.413

这里有几个可能的问题：

*   如果出现问题，您可能会发现很难向用户提供有用的错误消息。这似乎很可能，因为任何编译时语法错误都可能只是语法扩展。
*   性能受到打击。

我试图找到一些关于 Perl 6 中动态解析的优点、缺点和/或实现的讨论，但我找不到任何合适的东西。但是，您可能会发现 Nicklaus Wirth（Pascal 和其他语言的设计者）的这句话很有趣：

> 1960 年代计算机科学家的幻想是无限的。由于自动语法分析和解析器生成的成功，一些人提出了灵活的或至少可扩展的语言的想法。这个概念是一个程序之前将有句法规则，然后在解析后续程序时指导通用解析器。更进一步：语法规则不仅在程序之前，而且可以散布在整个文本的任何地方。例如，如果有人希望使用一种特别花哨的私有形式的 for 语句，他可以优雅地这样做，甚至在同一程序的不同部分为同一概念指定不同的变体。语言用于人类之间交流的概念已经完全融合，显然，现在每个人都可以即时定义自己的语言。然而，在试图说明这些私人建筑应该意味着什么时遇到的困难很快就使寄予厚望的希望破灭了。结果，可扩展语言的有趣想法很快就消失了。

*编辑*：这是 Perl 6 的[Synopsis 6: Subroutines](http://svn.pugscode.org/pugs/docs/Perl6/Spec/S06-routines.pod)，不幸的是标记形式，因为我找不到更新的格式化版本；在里面搜索“宏”。不幸的是，它不是*很*有趣，但是您可能会发现一些相关的东西，例如 Perl 6 的一次性解析规则，或者它用于抽象语法树的语法。Perl 6 采用的方法是，宏是一个函数，它在其参数被解析后立即执行并返回一个 AST 或一个字符串；Perl 6 继续解析，就好像源实际上包含返回值一样。提到了错误消息的生成，但它们看起来好像宏返回 AST，你可以做的很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T21:22:02.730

更进一步，您可以进行“惰性”解析，并且始终只解析到足以评估下一条语句的程度。就像某种即时解析器。然后语法错误可能会变成正常的运行时错误，只会引发可以由周围代码处理的正常异常：

```
def fun():
   not implemented yet

try:
  fun()
except:
  pass 
```

这将是一个有趣的效果，但它是否有用或可取是另一个问题。通常，即使您现在不调用代码，了解错误也是很好的。

在控制到达宏之前不会对宏进行评估，并且解析器自然会知道所有先前的定义。此外，宏定义甚至可以使用程序迄今为止计算的变量和数据（例如为先前计算的列表中的所有元素添加一些语法）。但是，开始为通常可以直接在语言中完成的事情编写自修改程序可能是一个坏主意。这可能会让人感到困惑......

在任何情况下，您都应该确保只解析一次代码，如果第二次执行，则使用已经解析过的表达式，这样就不会导致性能问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-01T07:17:26.157

以下是我硕士论文中的一些想法，可能有用，也可能没有帮助。这篇论文是关于自然语言的健壮解析。主要思想：给定一种语言的上下文无关语法，尝试解析给定的文本（或者，在你的情况下，是一个 python 程序）。如果解析失败，您将获得部分生成的解析树。使用树结构来建议新的语法规则，以更好地覆盖已解析的文本。我可以把我的论文寄给你，但除非你读过希伯来语，否则这可能没有用。

简而言之：我使用了[自下而上的](http://en.wikipedia.org/wiki/Bottom-up_parser) [图表解析器](http://en.wikipedia.org/wiki/Chart_parser)。这种类型的解析器为语法的产生式生成边。每条边都标有被消耗的树的部分。每个边缘都根据它与完全覆盖的接近程度获得分数，例如：

```
S -> NP . VP 
```

得分为二分之一（我们成功覆盖了 NP，但没有覆盖 VP）。得分最高的边表明新规则（例如 X->NP）。一般来说，图表解析器的效率低于常见的 LALR 或 LL 解析器（通常用于编程语言的类型） - O(n^3) 而不是 O(n) 复杂度，但是你再次尝试比只是解析现有的语言。如果你能对这个想法做点什么，我可以给你发送更多细节。我相信看看自然语言解析器可能会给你一些其他的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T21:09:05.950

我考虑过的另一件事是使它成为全面的默认行为，但允许语言（意味着一组宏来解析给定语言）在编译时引发解析错误。例如，我系统中的 Python 2.5 会执行此操作。

代替存根的想法，只需重新编译在执行时无法在编译时完全处理的函数。这也将使自修改代码更容易，因为您可以修改代码并在运行时重新编译它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T13:52:40.563

您可能需要用未知语法分隔输入文本的位，以便解析语法树的其余部分，除了一些稍后将扩展的字符序列节点。根据您的顶级语法，这可能没问题。

您可能会发现解析算法和词法分析器以及它们之间的接口都需要更新，这可能会排除大多数编译器创建工具。

（更常用的方法是为此目的使用字符串常量，可以在运行时将其解析为小解释器）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T23:04:41.003

我认为您的方法不会很好。让我们举一个用伪代码编写的简单示例：

```
define some syntax M1 with definition D1
if _whatever_:
    define M1 to do D2
else:
    define M1 to do D3
code that uses M1 
```

所以有一个例子，如果你允许在运行时重新定义语法，你就会遇到问题（因为根据你的方法，使用 M1 的代码将由定义 D1 编译）。请注意，验证是否发生语法重新定义是不确定的。可以通过某种类型的系统或某种其他类型的静态分析来计算过度近似值，但 Python 对此并不为人所知：D。

困扰我的另一件事是您的解决方案“感觉”不正确。我发现存储您无法解析的源代码是很邪恶的，因为您可能能够在运行时解析它。

另一个让我想起的例子是：

```
...function definition fun1 that calls fun2...
define M1 (at runtime)
use M1
...function definition for fun2 
```

从技术上讲，当您使用 M1 时，您无法解析它，因此您需要将程序的其余部分（包括 fun2 的函数定义）保留在源代码中。当你运行整个程序时，你会看到一个你不能调用的 fun2 调用，即使它已经定义了。

# ruby-on-rails - 考虑使用现有数据（不是数据库，实际数据）的新 Rails 应用程序——最好的方法是什么？

> ID：474277
> 
> 赞同：2
> 
> 时间：2009-01-23T19:59:44.297
> 
> 标签：ruby-on-rails, brownfield

我的任务是为我目前的工作开发一个新的零售电子商务店面，我正在考虑使用 RoR 来解决它 A) 用我有限的 Rails 知识构建一个“真实”项目，以及 B) 为管理层提供快速周转和反馈（他们希望尽快完成这项工作，而且他们的截止日期相当不切实际——我说的是几周后才能从无到有工作模式，这样他们就可以开始使用 SEO/SEM 进行营销，我不骗你，“视频博客”，因为我的老板听说那是未来）。

我们确实有一个数据库结构，但它非常糟糕，而且毫无道理地被拼凑在一起，所以我将在很大程度上忽略它并从头开始创建一个新数据库；但是，我有需要加载到应用程序中的现有数据（就像我说的，它是一个电子商务应用程序，我们有产品数据）。我需要将这些数据按摩成可用的格式，因为我们的供应商向我们提供了神秘的缩写列名，并且它是高度非规范化的，尤其是在类别中（我之前发布过一个关于它的问题 - 基本上类别表有六个字段，每个类别/子类别一个，如果该类别不适用，则其中一些为空白）。

有两个主要问题让我重新考虑：

1.  正如我所说，需要将数据放入“适当的”数据库模式中；我不能按原样加载它。我对一个好的数据模型有一些想法，但我的分析还没有完成。最终会有大量的连接表将各种事物链接在一起（例如 products_categories、products_attributes、products_prices）等，这些表将不是通过 ID 而是通过它们的 SKU 链接产品（见下文）。

2.  所有东西都已经有一个为其生成的 ID，但是我添加的任何新东西都需要自动生成一个；我怀疑这对于任何成熟的 RDBMS 来说都是一个问题，但我知道 Rails 喜欢自己生成 ID。另外，几乎所有的产品相关表都是通过SKU链接的（而且在供应商提供的数据中实际上是一个由前缀和库存号组成的组合键，它们组合起来构成了完整的SKU），而不是通过ID和I '不确定这是否会成为性能问题（当然，我总是可以在这些列上手动创建索引以加快速度）。然而，这确实意味着我需要脱离 Rails 约定。

简而言之，我认为就上市时间和易于开发而言，Rails 可能是一个不错的选择，但必须使用现有的数据内容可能会变得很痛苦，因为需要围绕开发应用程序那个，而不是“传统的” Rails 应用程序，这个因素让我对使用 Rails 产生了重大怀疑。还有一些其他问题（必须设置 Linux 服务器，而且我居住的地区几乎没有 Rails 开发人员，所以如果我离开公司，我基本上会把他们当作人质来更新/修改） . 我真的不确定如何进行的最佳途径。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T20:39:14.997

我会开发应用程序，就好像您没有数据一样。使用 ORM 并使您的数据库尽可能地达到最佳状态，但当然要记住您必须使用哪些数据来填充它（例如：不要为那些会让您逐条记录旧数据的事情制定疯狂的新约束）。

完成并测试后，编写一个导入脚本，将您的真实数据提取到您的新数据库中。

它与传统的设计/开发模型没有什么不同……除此之外，您还可以以半自动化的方式进行数据输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T05:36:31.137

不久前我也遇到了同样的情况——一个蹩脚的 PHP 应用程序，它保存了 10 年的*所有*公司数据。

我所做的只是创建一个迁移模型并添加方法来导入每个资源。

```
class Migration
  def migration_all
    self.jobs
  end

  def self.jobs
    ...
  end
end 
```

很酷的一点是，您可以安排导入哪些订单资源，因为其中一个可能会引用另一个。我还添加了直接修改数据库模式的方法。如果您必须保留现有的主键，一个很好的技巧是创建一个名为“legacy_id”的字段，复制现有的主键，完成后，只需删除“id”字段，重命名“legacy_id”字段到 'id'，然后在新的 'id' 字段上添加 primary_key 约束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T05:49:37.837

不要使用 SKU 作为每个产品的唯一键 - 使用标准 Rails 递增 id。

SKU 可能会发生变化，因为它可能会被错误输入等，这将使更改其他表中的所有引用成为一场噩梦。将您当前的 id 放在 sku 列中，对其进行索引并将其他表中的引用更新为 Rails id。

您可以在控制器中执行 Product.find_by_sku(params[:sku]) ，设置 /products/:sku 路线等。我看不出您会获得什么（除了头痛）使用您未生成的 id 作为数据库主键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T09:59:36.597

我还建议您通过应用程序的验证运行您的旧数据，以确保您不会加载一堆不一致和错误。它将帮助您的应用程序顺利运行，并在您可以修复它们的地方突出显示现有的数据错误。

不要仅仅因为它已经存在就假设现有数据是有效的。

# c++ - 将函子保留为变量

> ID：474279
> 
> 赞同：6
> 
> 时间：2009-01-23T20:00:43.873
> 
> 标签：c++, functor

我正在研究资源管理类，并希望用户为“ReleaseResource”方法提供一个函子，作为资源管理器构造函数的一部分。从那里请求资源时，将提供函子作为我将返回的 shared_ptr 的删除器，以便在不再使用资源时调用适当的方法。

我遇到的问题是，这需要我将仿函数存储在我的班级中，我不完全确定如何做到这一点。通常在使用仿函数时，您可以像这样对函数进行模板化：

```
template<class MyFunctor> MyMethod(MyFunctor f) {
    f();
} 
```

如果您打算在该函数的范围内使用仿函数，这很好，但是由于模板超出了函数的范围，我不确定您将如何指定适当类型的变量来存储仿函数以供以后使用.

谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T20:25:06.227

```
template<class MyFunctor> MyMethod(MyFunctor f) {
    boost::function<void()> g = f;
    g();
} 
```

您传递给[`boost::function`](http://www.boost.org/doc/libs/1_37_0/doc/html/function.html)的类型是函数类型。例如，`int(bool, char)`是返回 int 并采用 bool 和 char 的函数的类型。也就是说，如果您想立即构造 shared_ptr，则不需要将仿函数存储在某处（`boost::function`需要`new`运算符，即使对于非常小的仿函数，它也会使用特殊技巧仅使用堆栈分配（小缓冲区优化））：

```
template<class MyFunctor> MyMethod(MyFunctor f) {
    boost::shared_ptr<T> ptr(new T, f);
} 
```

boost::function 是[`tr1`](http://en.wikipedia.org/wiki/Technical_Report_1)并将成为下一个官方 C++ 标准的一部分。例子：

```
struct Manager {
    template<typename Deleter>
    Manager(Deleter d) 
        :deleter(d) {

    }

    boost::shared_ptr<Resource> allocate() {
        ...
        return boost::shared_ptr<Resource>(resource, deleter);
    }

private:
    boost::function<void(Resource *)> deleter;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T20:27:34.507

有两种方法，这两种方法都归结为模板类。

```
template <MyFunctor>
class MyClass
{
   MyFunctor   func;
  public:
    MyClass(MyFunctor f) :func(f)
    { }

    MyMethod() 
   {
       func();
   }
} 
```

这需要你知道函子的类型。为了避免这种情况，我们可以使用工厂：

```
 template<MyFunctor>
 MyClass<MyFunctor>  MakeFunctorClass(MyFunctor f)
 {     
     return MyClass<MyFunctor>(f);       
 } 
```

或者，由于很可能大部分函子签名都是相同的，只有一小部分发生变化，我们可以使用它：

```
template <MyType>
class MyClass
{
   typedef std::binary_function<MyType, MyType, bool>  MyFunctor;
   MyFunctor func;
  public:

    MyMethod(MyFunctor f) 
   {
       func = f;
       func();
   }
} 
```

这使得使用更简单：

```
 bool AreEqual(int, int); 
 MyClass<int> myc;
 myc.MyMethod(AreEqual); 
```

以更复杂的定义为代价（即，我不保证我给出的 binary_function typedef 会起作用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T20:04:50.713

不确定这是否有帮助，但请注意 boost::shared_ptr 具有构造函数覆盖，允许用户包含自定义取消分配（和自定义分配器，如果需要）。这可能足以满足您的需要（如果我正确阅读您的用例，它的设计考虑到了这一点）。

# java - 提供系统上安装的 JRE 列表的命令

> ID：474283
> 
> 赞同：3
> 
> 时间：2009-01-23T20:02:30.547
> 
> 标签：java

是否有任何命令可以列出系统上安装的所有 JRE 版本和发行版？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T21:09:53.283

要在 Windows 机器上列出所有已注册的 JRE（在名为“jre.txt”的文件中）：

```
start /w regedit /e jre.txt 
   "HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:05:13.320

嗯...

```
find / -name "java" -print 
```

在 *nix 上。

没有任何其他放松，这是唯一的方法（是的，这很丑陋）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T20:14:25.033

在 ubuntu 和其他一些 linux 上，它们主要位于 /usr/lib/jvm 中。你也可以检查

```
for x in $(echo $PATH | tr ':' ' '); do ls -asl $x | grep java; done 
```

它还将向您展示所有漂亮的软链接。可能有更好的方法可以做到这一点，希望某个好心人会发布:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T20:22:41.257

如果您使用的是 Linux，则可以调查该`alternatives`命令（如果您的发行版使用该命令）。java 的替代品（我认为可以通过键入来获得`alternatives java`，但请查看手册页了解详细信息）将列出所有已安装的 JRE，并指出哪一个是当前系统默认值。它还可以让您轻松地在不同版本之间切换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T20:06:48.620

在 Windows 上，看起来所有安装都记录在 HKEY_LOCAL_MACHINE/Software/JavaSoft/Java Runtime Environment 注册表项中。

# agile - 什么是持续软件工程？

> ID：474284
> 
> 赞同：11
> 
> 时间：2009-01-23T20:02:34.370
> 
> 标签：agile, sdlc

我遇到过“维持软件工程”这个短语，但不知道它的确切含义。似乎有一些国防部联系？它与敏捷开发有关吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-03-20T11:52:03.597

软件世界中的许多人将持续工程定义为错误修复团队。虽然这是所涉及的职责的一部分，但维持工程小组还应该着眼于整体缺陷趋势，以帮助确定需要重构的区域。该小组的重点应该不仅是在错误出现时修复它们，而且应该成为重新进入工程的渠道，以消除来自客户的不必要的呼叫。这可能涉及“按设计工作”问题以及客户很难理解的产品领域。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-23T20:10:24.667

我相信“维持”是“维护”的另一个词：它是软件发布后发生的事情，即支持、错误修复、增强......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-23T20:08:33.763

[可持续软件工程](http://www.scribd.com/doc/5507536/Sustainable-Software-Engineering)：在管理项目时考虑软件项目的社会和环境影响。管理软件项目，以最大限度地提高项目的正面社会和环境影响，并尽量减少负面的社会和环境影响。

替代方案（维持）：在软件项目的设计和开发过程中考虑长期支持需求。开发完成后进行所需长期支持的过程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T21:44:41.963

这只是“软件维护团队”的一种说法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T20:47:24.263

维持软件工程，至少在我遇到的情况下，是负责为已发布产品实施热修复和处理技术支持人员无法自行解决的客户服务问题的部门。

# sql-server - SQL Server 2008 中的静态端口分配不保存

> ID：474289
> 
> 赞同：1
> 
> 时间：2009-01-23T20:04:37.593
> 
> 标签：sql-server, sql-server-2008, ports, multiple-instances

我有两个 SQL Server 2008 的命名实例，并且正在尝试为每个实例设置静态端口。我打开 SQL Server 配置管理器 -> 展开“SQL Server 网络配置” -> 单击我要更改的实例 -> 并选择 TCP/IP。

从这里我所做的任何配置更改在我点击 OK 后都不会保留。我尝试将“TCP 动态端口”选项设置为空白，并在 IPALL 部分下的“TCP 端口”选项下设置我想要的端口号，但每次返回配置屏幕时，更改不再出现。

我试过弹跳服务，但这也无济于事。

有人对这里发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T21:02:26.963

原来问题是我的帐户不是机器上的本地管理员。我是 SQL Server 的系统管理员，所以我认为它可以工作。

令人沮丧的是，界面没有提醒我我没有权限，它只是告诉我我的更改已保存并继续忽略它们。

感谢所有回答的人！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:08:37.523

进行更改后是否重新启动了 SQL Server？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T20:22:40.397

您是在特定 NIC 下还是在 IPAll 部分下更改 TCP 端口？

您应该在 IPAll 下进行（在最底部）。

# silverlight - 如何让 PropertyChanged 事件冒泡？

> ID：474300
> 
> 赞同：1
> 
> 时间：2009-01-23T20:06:27.043
> 
> 标签：silverlight, inotifypropertychanged

我有一个对象层次结构（对象A，B），每个对象都实现`INotifyPropertyChanged`了......

A 有 B 类型的成员，B 有 C 的成员，C 是 bool 类型

当 C 更改时，它的`PropertyChanged`事件被触发，但是这不会触发 B 的属性更改事件。因此 A 不会对 B 的变化做出反应。

有没有什么好的方法可以让这个冒泡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T22:27:07.620

这太棒了——我得花更多时间看看它。谢谢你。

我找到了一个不同的解决方案，但它有点破解。我只是将绑定路径属性设置为嵌套类型。使用我上面的示例，在我的 xaml（它具有对象 A 的 DataContext）中，我将绑定设置为...

{绑定路径=BC}

将事件冒泡肯定更优雅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T13:51:10.317

这是一个相当简单的解决方案，但您不能只订阅 PropertyChanged 事件并传播调用吗？

例如

```
MyContainedObject.PropertyChanged += PropertyChangedHandler; 
```

然后在你的处理程序中：

```
private void PropertyChangedHandler(object sender, PropertyChangedEventArgs e)
{
    this.OnPropertyChanged(e.PropertyName);
} 
```

当您的对象具有同名的属性时，这非常有用。如果您有不同名称的属性，您将不得不做更多的工作来在属性值之间进行转换。

```
private void PropertyChangedHandler(object sender, PropertyChangedEventArgs e)
{
    switch(e.PropertyName)       
    {         
     case "Property1":   
        this.OnPropertyChanged("ADifferentProperty1");
        break;                  
     case "Property2":            
        this.OnPropertyChanged("ADifferentProperty2");
        break;                   
     default:            
        this.OnPropertyChanged(e.PropertyName);           
        break;      
   }
} 
```

# asp.net - ASP.NET 控件和泛型

> ID：474307
> 
> 赞同：3
> 
> 时间：2009-01-23T20:08:00.363
> 
> 标签：asp.net, generics, user-controls

ASP.NET 控件可以与泛型一起使用吗？从未见过这样做，并且想要一种按类型区分页面上的某些控件的方法，即：**DateTime** vs **int**

例子：

```
public class MyGenericTextBox<T>: TextBox
{
public MyGenericTextBox<T>() {... }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:18:26.787

请注意 - 当控件程序集中的类之一是通用的时，Visual Studio 无法创建智能感知架构。有人在我们的一个项目中添加了这样的控件，我们花了两个月的时间才弄清楚为什么我们的标记中没有智能感知。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T21:47:42.847

可以通过特殊的 hack 来完成，例如我在本文中使用的那个：

[ASP.NET 中的类型化中继器](http://www.codeproject.com/KB/aspnet/TypedRepeater.aspx)

但是，我不建议在简单的情况下为了方便而这样做，因为结果会比您尝试改进的事情更复杂。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T20:14:46.717

如果您只使用代码中的控件，这可能会起作用。我怀疑它可以在标记或设计器中表示。

# asp.net - ASP.NET 无法加载类型“System.String”

> ID：474315
> 
> 赞同：1
> 
> 时间：2009-01-23T20:09:19.550
> 
> 标签：asp.net, string

有没有人见过 ASP.NET websuite 在初始登录时出现问题，抱怨 web.config 中定义的配置文件中的 system.string 类型。

更多信息：

```
Server Error in '/abc' Application.
--------------------------------------------------------------------------------

Configuration Error 
Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: Attempting to load this property's type resulted in the following error: Could not load type 'System.String'.

Source Error: 

Line 222:           </providers>
Line 223:           <properties>
Line 224:               <add name="FirstName" type="System.String"/>
Line 225:               <add name="LastName" type="System.String"/>
Line 226:               <add name="DriverCode" type="System.String"/>

Source File: d:\Inetpub\wwwroot\abc\web.config    Line: 224 

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.1433; ASP.NET Version:2.0.50727.1433 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:12:36.330

我还没有看到，但是文档说 System.String 是默认设置，所以请尝试删除类型部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:09:38.790

看看这个问答：[在 .NET Membership 中使用 List 类型的配置文件属性](https://stackoverflow.com/questions/2199395/using-a-profile-property-of-type-list-in-net-membership)

尝试添加一个完全限定的程序集名称，例如：
`<add name="MyString" type="System.string, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>`

这使它对我有用。

# objective-c - 可可中的哈希表

> ID：474316
> 
> 赞同：28
> 
> 时间：2009-01-23T20:09:25.353
> 
> 标签：objective-c, cocoa, macos, hashtable

HashTables/HashMaps 是现有数据结构中最有用的（如果不是*最有用的话）之一。*因此，当我开始学习 Cocoa 编程时，我研究的第一件事就是如何从哈希表创建、填充和读取数据。

令我惊讶的是：我一直在阅读的关于 Cocoa/Objective-C 编程的所有文档似乎根本没有解释这么多。作为一个使用“java.util”就好像它是一个身体功能的Java开发人员：我对此完全感到困惑。

因此，如果有人可以为我提供创建、填充和读取哈希表内容的入门知识：我将不胜感激。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-01-23T20:21:24.487

[NSDictionary](https://developer.apple.com/documentation/foundation/nsdictionary?language=objc)和[NSMutableDictionary](https://developer.apple.com/documentation/foundation/nsmutabledictionary?language=objc)？

这是一个简单的例子：

```
NSMutableDictionary *dictionary = [[NSMutableDictionary alloc] init];
[dictionary setObject:anObj forKey:@"foo"];
[dictionary objectForKey:@"foo"];
[dictionary removeObjectForKey:@"foo"];
[dictionary release]; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-07-08T13:15:29.083

您可以尝试使用[NSHashTable](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSHashTable_class/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004555)！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-23T22:10:52.613

如果您正在使用 Leopard（和 Cocoa 的新垃圾收集），您还想看看[NSMapTable](https://developer.apple.com/documentation/foundation/nsmaptable?language=objc)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-24T20:04:41.057

除了 NSDictionary，还可以查看 NSSet 以了解何时需要没有顺序且没有重复的集合。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-01-24T22:22:46.750

使用iOS 6.0+ SDK 中的[NSHashTable](https://developer.apple.com/documentation/foundation/nshashtable)。哈希表是仿照 NSSet 建模的，但有以下区别： 它可以保存对其成员的弱引用。它的成员可以在输入时被复制，或者可以使用指针标识来进行相等和散列。它可以包含任意指针（其成员不限于对象）。

```
 NSHashTable *hashTable = [NSHashTable 
 hashTableWithOptions:NSPointerFunctionsCopyIn];
 [hashTable addObject:@"foo"];
 [hashTable addObject:@"bar"];
 [hashTable addObject:@100];
 [hashTable removeObject:@"bar"];
 NSLog(@"Members: %@", [hashTable allObjects]); 
```

使用iOS 6.0+ SDK 中的[NSMapTable](https://developer.apple.com/documentation/foundation/nsmaptable)。映射表是在 NSDictionary 之后建模的，但有以下区别： 键和/或值可选地“弱”保存，以便在回收对象之一时删除条目。它的键或值可以在输入时被复制，或者可以使用指针标识来进行相等和散列。它可以包含任意指针（其内容不限于对象）。

```
 id delegate = ...;
 NSMapTable *mapTable = [NSMapTable 
 mapTableWithKeyOptions:NSMapTableStrongMemory
                                         valueOptions:NSMapTableWeakMemory];
 [mapTable setObject:delegate forKey:@"foo"];
 NSLog(@"Keys: %@", [[mapTable keyEnumerator] allObjects]); 
```

# java - 在 Java 中，如何在更改属性时调用方法的对象周围构造一个“代理包装器”？

> ID：474320
> 
> 赞同：4
> 
> 时间：2009-01-23T20:10:03.200
> 
> 标签：java, design-patterns, proxy-classes

我正在寻找类似于[Proxy 模式](http://en.wikipedia.org/wiki/Proxy_pattern)或[Dynamic Proxy Classes](http://java.sun.com/j2se/1.3/docs/guide/reflection/proxy.html)的东西，只是我不想在真实对象上调用方法调用之前拦截它们，而是我想拦截正在更改的属性. 我希望代理能够表示具有不同属性集的多个对象。[Action Script 3 中的 Proxy 类之类的](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/Proxy.html)就可以了。

这是我一般想要实现的目标：

我有一个线程运行一个对象，该对象管理由程序中的其他线程移交的值列表（数字、字符串、对象），因此该类可以负责在磁盘上创建定期持久快照以进行检查点应用程序。这个持久化对象管理一个“脏”标志，表示自上一个检查点以来值列表是否已更改，并且在忙于将其写入磁盘时需要锁定该列表。

持久化器和其他组件通过通用名称识别特定项目，因此当从崩溃中恢复时，其他组件可以首先检查持久化器是否保存了最新的副本，并从中断的地方继续工作。

在正常操作期间，为了使用他们移交给持久化器的对象，我希望他们接收对代理对象的引用，该引用看起来好像是原始对象，但是每当他们更改其上的某些值时，持久化器通知并相应地采取行动，例如在实际设置实际值之前将项目或列表标记为脏。

* * *

**编辑**：或者，Java中是否有通用设置器（如PHP 5），即如果属性不存在则调用的方法？或者是否有一种对象可以在运行时添加属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:21:20.010

如果“属性”是指JavaBean 属性，即代表一个getter 和/或setter 方法，那么您可以使用动态代理来拦截set 方法。

如果您的意思是实例变量，那么没有办法 - 不是在 Java 级别上。不过，也许可以通过[字节码级别的操作](http://java-source.net/open-source/bytecode-libraries)来完成某些事情。

实际上，最简单的方法可能是使用[AspectJ](http://www.eclipse.org/aspectj/)并定义一个 set() 切入点（它将拦截字节码级别的字段访问）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:18:34.087

您正在寻找的设计模式是：差分执行。我相信。

[差分执行是如何工作的？](https://stackoverflow.com/questions/371898/how-does-differential-execution-work#381861)

是我回答的一个与此有关的问题。

但是，我可以建议您改用回调吗？您将不得不阅读有关此内容的信息，但总体思路是您可以实现在“有趣的事情”发生时激活的接口（通常称为侦听器）。比如有一个数据结构被改变。

强制性链接：

[Wiki 差异执行](http://en.wikipedia.org/wiki/Differential_execution)

[维基回调](http://en.wikipedia.org/wiki/Callback_(computer_science))

好吧，这是我看到的答案。差分执行是 O(N) 时间。这真的很合理，但如果这对你不起作用，回调会。回调基本上通过将方法按参数传递给正在更改数组的类来工作。此方法将获取更改的值和项目的位置，通过参数将其传递回“存储类”并适当地更改值。所以，是的，您必须通过方法调用来支持每个更改。

我现在意识到这不是你想要的。您似乎想要的是一种方法，您可以在数组中的每个变量上提供某种侦听器，当该项目更改时将调用该侦听器。然后侦听器将更改“备份”中的相应数组以反映此更改。

本机我想不出一种方法来做到这一点。当然，您可以使用接口创建自己的侦听器和事件。这与回调基本相同，但更好看。

然后是反射...... Java 有反射，我很肯定你可以用它写一些东西来做到这一点。然而，反射是出了名的缓慢。更不用说编码的痛苦了（在我看来）。

希望有帮助...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-24T00:58:33.727

> 我不想在调用真实对象之前拦截方法调用，而是想拦截正在更改的属性

所以事实上，你想要监控的对象不是方便的 bean，而是 C 结构的复兴。我想到的唯一方法是使用[JVMTI 中的 Field Access 调用](http://java.sun.com/j2se/1.5.0/docs/guide/jvmti/jvmti.html#FieldAccess)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-13T13:24:08.090

我自己也想做同样的事情。我的解决方案是使用使用 Javassist 的动态代理包装器。我将生成一个实现与目标对象的类相同的接口的类，将代理类包装在原始类周围，并将代理上的所有方法调用委托给原始类，但也会触发 PropertyChangeEvent 的 setter 除外。

无论如何，我在我的博客上发布了完整的解释和代码：http: [//clockwork-fig.blogspot.com/2010/11/javabean-property-change-listener-with.html](http://clockwork-fig.blogspot.com/2010/11/javabean-property-change-listener-with.html)

# .net - asp.net MVC 对象值中的 Html.ActionLink 格式错误

> ID：474327
> 
> 赞同：4
> 
> 时间：2009-01-23T20:11:37.377
> 
> 标签：.net, asp.net-mvc, model-view-controller, html-helper, actionlink

我有一个 html.actionlink，我希望显示一个指向会员个人资料页面的链接，如下所示：[http](http://somesite.com/members/) ://somesite.com/members/ {username}

使用以下标记时

```
<%= Html.ActionLink(r.MemberName, "profile", new { MemberName = r.MemberName } )%> 
```

我得到一个看起来像这样的链接：[http](http://somesite.com/members?MemberName=) ://somesite.com/members?MemberName= {username}

我需要在 ActionLink 帮助程序中进行哪些更改才能实现这样的 url：

[http://somesite.com/members/](http://somesite.com/members/) {用户名}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T20:15:27.743

假设在您的路线中，用户名令牌是 {username} 就像您显示的那样，试试这个：

```
<%= Html.ActionLink(r.MemberName, "profile", new { username = r.MemberName } )%> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:15:37.760

您应该在路由表中的其他路由之前添加映射“/members/{MemberName}”的路由。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T20:43:56.797

感谢您的回复...我的路线与值名称不匹配。

只需确保我的路由 url 匹配就可以了。

这是我的代码....

```
//Global.asax
routes.MapRoute(
    "Profile",
    "members/{membername}",
    new { controller = "Members", action = "Profile", memberName = "" }
);

//In the Controller
public ActionResult Profile(string memberName)
{
  return View();
}

//My Action Link
<%= Html.ActionLink(r.MemberName, "profile", new { memberName = r.MemberName })%> 
```

再次感谢

# python - 获取我没有名称的 Python 包的属性，直到运行时

> ID：474331
> 
> 赞同：2
> 
> 时间：2009-01-23T20:13:10.667
> 
> 标签：python, package

在 Python 包中，我有一个包含（大概）子包名称的字符串。从那个子包中，我想检索一个常量元组......不过，我真的不知道如何继续这样做。

```
#!/usr/bin/python
"" The Alpha Package
Implements functionality of a base package under the 'alpha' namespace
""

def get_params(packagename):
    # Here, I want to get alpha.<packagename>.REQUIRED_PARAMS
    pass 
```

所以，稍后在我的代码中，我可能会有：

```
#!/usr/bin/python
import alpha

alpha.get_params('bravo') # should return alpha.bravo.REQUIRED_PARAMS
alpha.get_params('charlie') # should return alpha.charlie.REQUIRED_PARAMS 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T20:17:26.070

如果我正确理解你想要什么，我认为大致这样的东西应该可以工作：

```
def get_params(packagename):
    module = __import__('alpha.%s' % packagename)
    return module.__dict__['REQUIRED_PARAMS'] 
```

# c# - 使用正则表达式在 C# 中编辑字符串

> ID：474335
> 
> 赞同：1
> 
> 时间：2009-01-23T20:13:46.517
> 
> 标签：c#, .net, regex

我刚开始使用正则表达式，所以请忍受我的术语。我有一个在字符串上正常工作的正则表达式模式。字符串的格式可以是“text [pattern] text”。因此，我也有一个否定第一个模式的正则表达式模式。如果我打印出每个匹配项的结果，一切都会正确显示。

我遇到的问题是我想将文本添加到字符串中，它会更改正则表达式 MatchCollection 中匹配项的索引。例如，如果我想将找到的匹配项包含在“td”匹配“/td””标签中，我有以下代码：

```
Regex r = new Regex(negRegexPattern, RegexOptions.IgnoreCase | RegexOptions.Singleline);
            MatchCollection mc = r.Matches(text);
            if (mc.Count > 0)
            {
                for (int i = 0; i < mc.Count; i++)
                {
                    text = text.Remove(mc[i].Index, mc[i].Length);
                    text = text.Insert(mc[i].Index, "<td>" + mc[i].Value + "</td>");
                }                
            } 
```

这对第一场比赛很有用。但正如您所期望的那样， mc[i].Index 不再有效，因为字符串已更改。因此，我尝试在 for 循环中仅搜索一个匹配项来查找我期望的匹配项 (mc.Count)，但随后我继续找到第一个匹配项。

因此，希望在不引入更多正则表达式以确保它不是第一次匹配并将所有内容保存在一个字符串中的情况下，是否有人对我如何完成此操作有任何意见？感谢您的输入。

编辑：谢谢大家的回复，我很感激他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:26:00.813

它可以很简单：-

```
 string newString = Regex.Replace("abc", "b", "<td>${0}</td>"); 
```

结果在`a<td>b</td>c`.

在你的情况下： -

```
Regex r = new Regex(negRegexPattern, RegexOptions.IgnoreCase | RegexOptions.Singleline);
text = r.Replace(text, "<td>${0}</td>"); 
```

将所有出现的 negRegexPattern 替换为 td 元素包围的匹配内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:44:40.260

尽管我同意上面的 Regex.Replace 答案是最佳选择，但只是为了回答您提出的问题，如何从最后一个匹配替换为第一个匹配。这样，您的字符串将超出“先前”匹配，因此较早的匹配索引仍然有效。

```
for (int i = mc.Count - 1; i > 0; --i) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T20:25:16.477

```
 static string Tabulate(Match m) 
   {
      return "<td>" + m.ToString() + "</td>";
   }

   static void Replace() 
   {
      string text = "your text";
      string result = Regex.Replace(text, "your_regexp", new MatchEvaluator(Tabulate));
   } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T20:52:34.080

你可以尝试这样的事情：

```
Regex.Replace(input, pattern, match =>
{
   return "<tr>" + match.Value + "</tr>";
}); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-23T20:24:37.570

在循环开始之前保留一个计数器，并添加每次插入的字符数。IE：

```
 Regex r = new Regex(negRegexPattern, RegexOptions.IgnoreCase | RegexOptions.Singleline);
            MatchCollection mc = r.Matches(text);

                int counter = 0;
                for (int i = 0; i < mc.Count; i++)
                {
                    text = text.Remove(mc[i].Index + counter, mc[i].Length);
                    text = text.Insert(mc[i].Index + counter, "<td>" + mc[i].Value + "</td>");
                    counter += ("<td>" +  "</td>").Length;
                } 
```

我没有对此进行测试，但它应该可以工作。

# java - Oracle ADF 甘特图

> ID：474337
> 
> 赞同：-1
> 
> 时间：2009-01-23T20:13:59.400
> 
> 标签：java, oracle, jsf, oracle-adf

我刚开始学习 ADF，我的任务是检查 ADF 的甘特图是如何工作的。

我已经完成了Oracle的教程，但是我觉得教程教的只是如何使用教程。

基本上我正在寻找一个很好的教程来展示如何从一个空项目：

创建一个虚拟数据集合[不是来自数据库] 将视图附加到数据，理想情况下是图表，不一定是甘特图，但那将是一个加号。

提前致谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-01-23T20:29:54.767

如果您是合作伙伴或员工，请查看题为 的甲骨文大学培训`Oracle ADF 11g Overview`。否则，有一篇博文[JSF/ADF Faces for Dummies](http://roosevelt.blogetery.com/category/tutorial/)和另一个有用的[链接](http://whitepapers.zdnet.com/abstract.aspx?docid=263239)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-18T08:41:15.840

教程和文档几乎没用..

Oracle 在此处提供了 dvt 组件的在线演示您可以[在](http://download.oracle.com/otn/java/jdeveloper/11g/extensions/dvt-faces-demo.zip)[此处](http://jdevadf.oracle.com/dvtdemo-dvt-faces-demo-context-root/faces/dvtFeatureDemo/index.jspx) 下载此演示的工作区并检查它们的工作方式。这对我帮助很大！

查看 oracle.dvtdemo.gantt.data.SampleModelFactory，它为甘特图创建了一个虚拟数据模型。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-12T11:29:45.180

Oracle ADF 是一项复杂的技术，试图了解 ADF 的甘特图是如何工作的非常模糊（这只是我的看法）。我来自 Oracle 表单环境，发现本教程对帮助我了解整个框架如何组合在一起非常有帮助

[http://www.oracle.com/technology/obe/ADFBC_tutorial_1013/index.htm](http://www.oracle.com/technology/obe/ADFBC_tutorial_1013/index.htm)

# asp.net - DropDownList OnSelectedIndexChange to 0th index w/out ViewState

> ID：474367
> 
> 赞同：6
> 
> 时间：2009-01-23T20:21:29.137
> 
> 标签：asp.net, user-controls, drop-down-menu, viewstate, selectedindexchanged

我确实关注了文章[真正了解 ViewState](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx)（顺便说一句很棒的文章），并且填充我的下拉列表效果很好。我什至设置了一个几乎一样好的 OnSelectedIndexChange 事件。

我发现的问题是选择第 0 个索引时不会触发 SelectedIndexChanged 事件。然而，它在所有其他时间都这样做。

这是一些代码：

```
<asp:DropDownList runat="server" ID="DropDownList1" EnableViewState="false" 
AutoPostBack="True" OnSelectedIndexChanged="DropDownList1_SelectedIndexChanged" /> 
```

```
protected override void OnInit(EventArgs e)
{
    this.DropDownList1.DataTextField = "Text";
    this.DropDownList1.DataValueField = "Value";
    this.DropDownList1.DataSource = fillQueueDropDown();
    this.DropDownList1.DataBind();

    base.OnInit(e);
}

protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    OnSelectedQueueChanged(e);
}

public void OnSelectedQueueChanged(EventArgs e)
    {
        // Do stuff.
    }

public event EventHandler queueNamesChangedEvent;
public void OnSelectedQueueChanged(EventArgs e)
    {
        if (queueNamesChangedEvent != null)
            queueNamesChangedEvent(this, e);
    } 
```

我想我可以在 Page_Load 方法中进行某种类型的检查：

```
 if(ViewState["selectedIndexChangedFlag"] != 1)
      // raise OnSelectedChange event 
```

或者有什么我可以在 OnInit() 方法中设置的东西，我每次都可以重新绑定这些数据？

看，我的自定义 EventHander 引发了一个事件，该事件被该控件所在的父页面捕获，以便父页面可以使用新选择的值执行一些操作。这目前适用于所选索引> 0的所有情况。

我在这个控件中创建了一个包含最近选择的索引的属性，在这种情况下，我的父页面可以在每个 Page_Load 上对这个属性值进行操作......不知道。

接受建议。或者如何强制此 SelectedIndexChanged 事件为第 0 个索引选择触发。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T20:35:24.880

问题是您每次都在加载数据，这是重置选定的索引。想象一下这是您的下拉菜单：

```
zero [selected]
one
two 
```

然后在客户端中更改所选索引：

```
zero
one [selected]
two 
```

这将`__EVENTARGUMENT`使用您的新索引 (1) 填充隐藏输入，并`__EVENTTARGET`使用`id`下拉列表填充隐藏输入。现在服务器端代码启动并重新加载您的数据：

```
zero [selected]
one
two 
```

“零”是选定的值，因为这是加载数据时的默认值。然后 ASP.NET在 中查找`__EVENTTARGET`并找到您的下拉列表并找到新索引 (1)。现在您的下拉列表如下所示：`__EVENTARGUMENT``Request``id`

```
zero 
one [selected]
two 
```

由于索引已更改，下拉列表会引发其`SelectedIndexChanged`事件，指示索引已更改。显然这是工作的部分，现在让我们看看为什么选择列表中的第一项不会引发事件。

现在假设我们的下拉菜单仍然处于它刚刚所处的状态（选择“one”并且选择的索引为 1）。当我们在客户端选择列表中的第一项时会发生什么？

`__EVENTTARGET`并使用下拉列表和新索引 (0)`__EVENTARGUMENT`填充。`id`然后服务器将数据加载到下拉列表中，下拉列表现在再次看起来像这样：

```
zero [selected]
one
two 
```

请注意，由于您在事件触发*之前*重新加载了数据，因此索引已设置为 0，因为这是默认值。现在，当您的事件触发并且下拉列表的选定索引设置为 0 时，下拉列表不会将此视为更改，因为选定索引（据它所知）没有更改。

以下是解决问题的方法：

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);

    if (!Page.IsPostBack)
    {
        this.DropDownList1.DataTextField = "Text";
        this.DropDownList1.DataValueField = "Value";
        this.DropDownList1.DataSource = fillQueueDropDown();
        this.DropDownList1.DataBind();
    }    
} 
```

如果页面不是回发，这只会将数据加载到下拉列表中。这意味着 ViewState 将为您维护数据以及所选索引，以便在您回发时下拉列表会将新索引与您在客户端中看到的索引进行比较。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-24T00:33:10.033

我在此下拉列表中禁用 ViewState 的目标是最小化页面的 ViewState 大小。

我只执行 if(!Page.IsPostBack){...DataBind()...} 时遇到的问题是，当您第一次选择一个项目并重新加载页面时，我的下拉列表变为空.

我最终做的是在这个控件上创建另一个属性 LastIndex。当 OnSelectedIndexChanged 事件触发时，我更新 LastIndex 值。在 Page_Load 中，我比较 Current 和 Last 索引值，如果它们不同，则触发 Index changed 事件。

```
 public int SelectedValue{
        get { return this.DropDownList1.SelectedItem.Value; }
    }

    public int LastIndex{
        get { return this.ViewState["lastIndex"] == null ? -1 : (int)this.ViewState["lastIndex"]; }
        set { this.ViewState["lastIndex"] = value; }
    }

    protected override void OnInit(EventArgs e){
        base.OnInit(e);
        this.DropDownList1.DataTextField = "Text";
        this.DropDownList1.DataValueField = "Value";
        this.DropDownList1.DataSource = fillQueueDropDown();
        this.DropDownList1.DataBind();
    }

    protected void Page_Load(object sender, EventArgs e){
        if (this.LastIndex != this.SelectedValue)
            this.OnSelectedQueueChanged(new EventArgs());
    }

    private ListItemCollection fillQueueDropDown(){...}

    protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e){
        OnSelectedQueueChanged(e);
        this.LastIndex = this.SelectedValue;
    }

    public event EventHandler queueNamesChangedEvent;
    public void OnSelectedQueueChanged(EventArgs e){
        if (queueNamesChangedEvent != null)
            queueNamesChangedEvent(this, e);
    } 
```

你是对的。数据在 OnInit 阶段重新加载和重新绑定。然后 ViewState 被恢复（当第 0 个索引被恢复时），当我们最终进入 Events 阶段时，控件没有检测到变化。

不确定这是最优雅的路线，但到目前为止它运行良好。

然后我在 IPostBackDataHandler 的 msdn 文档中找到了这个：

```
 public virtual bool LoadPostData(string postDataKey, 
     NameValueCollection postCollection) {

     String presentValue = Text;
     String postedValue = postCollection[postDataKey];

     if (presentValue == null || !presentValue.Equals(postedValue)) {
        Text = postedValue;
        return true;
     }

     return false;
  } 
```

由于当前值与更改后的值相同，因此不会触发该事件。

# python - Python：使用编解码器模块还是使用字符串函数解码？

> ID：474373
> 
> 赞同：0
> 
> 时间：2009-01-23T20:23:38.680
> 
> 标签：python, unicode, csv, decode, codec

我有一个以 UTF-8 编码的文本文件。我正在阅读它以分析和绘制一些数据。我希望文件以 ascii 格式读取。最好使用编解码器模块还是使用内置的字符串解码方法？此外，文件被划分为 csv，那么 csv 模块也可以是一个有效的解决方案吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T20:36:12.197

你的意思是你的文件是用UTF-8编码的吗？（“Unicode”不是编码...必读：[http](http://www.joelonsoftware.com/articles/Unicode.html) ://www.joelonsoftware.com/articles/Unicode.html ）我不是 100% 确定，但我认为您应该能够阅读 UTF-8使用 csv 模块编码的文件，您可以在阅读后将包含特殊字符的字符串转换为 Python 的 unicode 字符串（*编辑：*如果需要）。

[在http://docs.python.org./library/csv.html#csv-examples](http://docs.python.org./library/csv.html#csv-examples)有一些使用 UTF-8 编码数据的 csv 示例；它可能会帮助您查看它们。

# apache-flex - 将 XML 绑定到 Flex 树的问题

> ID：474374
> 
> 赞同：1
> 
> 时间：2009-01-23T20:24:15.357
> 
> 标签：apache-flex

我有一个值如下的 XML：

```
<products>
  <product id="1" name="All Products">
    <code>000</code>
    <shortname>ALL</shortname>
    <cost>0.0</cost>
    <product id="2" name="Product Group A">
      <code>001</code>
      <shortname>A</shortname>
      <cost>0.0</cost>
      <product id="4" name="Product A">
        <code>11</code>
        <shortname>ProductA</shortname>
        <cost>0.4</cost>
      </product>
    </product>
  </product>
</products> 
```

我通过调用 xml.children() 声明了一个 XMLList，并将它绑定到一个树，如下所示：

```
var products:XMLList = xml.children()

<mx:Tree id="treeProducts" dataProvider="{products}" labelField="@name" width="100%" /> 
```

但是，我的树不知道要为哪些 XML 元素创建节点，所以我为每个元素获取节点，即：

> ```
> -All Products
>   - 000
>   - ALL
>   - 0.0
>   - Product Group A
>     - 001
>     - A
>     - 0 
> ```

我真正想要的只是显示`@name`每个的价值`<product>`：

> *   所有产品
>     *   产品组 A
>         *   产品A

我错过了一些完全明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T23:30:21.143

如果您只是从树中收集节点，我认为 E4X 表示法将是最好的方法：

```
xml..(@name != '')
```

（或一些类似的，未检查准确性）

但是，这不会保留树结构。由于您想要树数据的特定视图，我建议应用[ITreeDataDescriptor](http://livedocs.adobe.com/flex/3/langref/mx/controls/treeClasses/ITreeDataDescriptor.html)的实现，该实现在其方法中过滤命名节点：

# ldap - LDAP 查询不同

> ID：474375
> 
> 赞同：1
> 
> 时间：2009-01-23T20:24:31.440
> 
> 标签：ldap

是否可以仅使用 LDAP 查询列出不同的值？由于某种原因，我收到了重复的用户，但我只希望他们被报告一次，谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-06-25T10:33:05.433

目录模型对重复的属性值没有限制，包括那些属于 RDN 的属性值。例如，条目`uid=user1,dc=example,dc=com`和条目`uid=user1,ou=people,dc=example,dc=com`是两个独立且不同的条目，但`uid`属性是相同的。正因为如此，许多专业质量的目录服务器实现了某种唯一性功能，这些功能将强制属性的唯一性。

如果您的目录服务器未强制执行唯一性，则从 LDAP 搜索请求返回不同值的方法是更改​​搜索请求的参数，例如，使用不同的搜索库或过滤器以使目录服务器能够区分条目应该在搜索响应中返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:51:11.230

Linq to Active Directory 可能会在此处为您提供帮助：

[http://www.codeplex.com/LINQtoAD](http://www.codeplex.com/LINQtoAD)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T21:40:11.563

我会更关心为什么 LDAP 查询不止一次返回用户，除非它们存在不止一次。这似乎表明您的 LDAP 源中存在真正的问题。

这几乎不应该发生。

# c# - Socket 编程的替代方案是什么？

> ID：474386
> 
> 赞同：9
> 
> 时间：2009-01-23T20:28:03.477
> 
> 标签：c#, sockets

我正在四处寻找编程疑难解答，我想知道 Socket 编程的替代方案是什么；如果有的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T20:29:00.137

假设您可以控制所使用的协议，您可以使用更高级别的抽象，例如 .NET 的 Remoting 或 WCF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:45:09.587

[TCPClient](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.aspx)和[UDPClient](http://msdn.microsoft.com/en-us/library/system.net.sockets.udpclient.aspx)在某种程度上将您从底层套接字中抽象出来。他们很高兴和他们一起工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-02T12:21:42.280

这个问题相当模糊，并没有解释 MrM 在套接字编程方面的问题是什么，或者他想要完成什么。

套接字的实际替代方案是[**(Win)Pcap**](http://www.winpcap.org/)，其中存在 .net 包装器并且不位于套接字层的顶部，正如迄今为止给出的其他答案。

还有[**RDMA**](http://en.wikipedia.org/wiki/Remote_direct_memory_access)，它也不使用套接字或大部分网络堆栈，旨在实现最高性能，但与常见的 IP 网络不兼容。

然后是相反的方法：在仍然使用标准套接字的同时获得高性能，通过使用特定于供应商的网络堆栈（例如**[OpenOnload](http://www.openonload.org/)的**. 然而，其中许多堆栈仅在特定供应商的硬件上运行。

# silverlight - 动态数据模板切换

> ID：474391
> 
> 赞同：1
> 
> 时间：2009-01-23T20:29:35.237
> 
> 标签：silverlight, xaml, silverlight-2.0

我正在尝试实现与以下帖子中所示相同的行为。问题是这篇文章解决了 WPF 的问题。

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/4fd42590-8375-46d0-b7bc-6c217df0f0ba/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/4fd42590-8375-46d0-b7bc-6c217df0f0ba/)

关于如何在 Silverlight 2.0 中执行此操作的任何想法？

谢谢克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T07:39:48.020

等待未来版本支持 DynamicResources。如果您需要执行一次（例如在加载时），Silverlight Toolkit 的 ImplicitStyleManager 是一个很好的解决方案 ( [http://silverlight.codeplex.com)...否则](http://silverlight.codeplex.com)...otherwise)您将不得不等待。WPF 比 SL2 功能更丰富。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T15:09:26.300

谢谢，我会调查的。

我们目前正在使用 ComponentOne 提供的一些控件，他们为他们的 ItemsControl 实现了一个 DataTemplateSelector（类似于 WPF 实现）。

这就是我目前正在使用的方法，但我仍然在解决一些问题。

再次感谢。

# wpf - 我是 WPF 引擎中的错误的发现者吗？

> ID：474393
> 
> 赞同：3
> 
> 时间：2009-01-23T20:30:34.360
> 
> 标签：wpf

我们有一个使用 /CLR 编译的 MFC 8 应用程序，其中包含大量 Windows 窗体用户控件，这些用户控件再次包含使用 ElementHost 的 WPF 用户控件。由于我们软件的架构，我们不能直接使用 HwndHost。我们在这里观察到一个非常奇怪的行为，我们无法理解：

当应用程序启动期间 CPU 负载非常高并且有很多活动的 ElementHost 实例时，整个属性引擎会完全停止工作。例如，通常可以正常工作的动画现在永远不会更新绑定属性的值，它们只是在启动后保持在某个随机值。当我设置一个未绑定到任何东西的属性时，该值正确存储在依赖属性中（调用 getter 返回新值），但视觉表示从未反映这一点。我将背景设置为红色，但背景颜色没有改变。

我们在许多运行 Windows XP SP2 的不同机器上对此进行了测试，它的重现性非常好。

这里有趣的是，实际上存在一种情况，绑定的属性实际上从动画中获取了一个新值，并且视觉根据属性值进行了更新。当我调整 ElementHost 的大小或隐藏并重新显示父本机控件时。一旦我这样做，绑定到动画的属性就会拾取一个新值，并且视觉效果会根据新属性值重新呈现 - 但只是一次 - 如果我想看到另一个更新，我必须调整 ElementHost 的大小。

您对这里可能发生的事情或我如何解决这个问题有任何解释吗？我能做些什么来调试这个？有没有办法让我获得有关 WPF 实际功能或 WPF 可能在哪里崩溃的更多信息？对我来说，它目前似乎是 WPF 本身的一个错误，因为它只发生在启动时的高 CPU 负载下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:37:02.723

我不与那些技术人员做任何工作，所以我真的不能说。但是，对我来说，您的代码中似乎发生了某种死锁，它阻止了对 redraw() （或其等效项）的调用。调整窗口大小将强制重绘，但是当您更改某些内容时告诉它重绘的正常机制可能会被阻止。

您的代码中是否有可能存在竞争条件？在负载较轻的系统上，事情可能会以正确的顺序发生，但在负载较重的系统上，时间可能会有所不同。也许这会触发您的代码中的死锁？

如果您可以附加调试器，请查看正在运行的线程。如果您可以看到每个线程正在等待什么以及它还持有什么锁（您可以使用 Java 执行此操作，但不确定您的应用程序），这可能有助于您确定它在哪里死亡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T14:36:25.123

大多数时候，[选择并没有被破坏](http://www.codinghorror.com/blog/archives/001079.html)（俗话说）。

[正如@Herms 所暗示](https://stackoverflow.com/questions/474393/am-i-a-discoverer-of-a-bug-in-the-wpf-engine#474412)的，这听起来确实很像某种竞赛或僵局。

您当然可以检查 MSDN 中的已知错误。根据你的代码是什么样的，当我*真的*遇到一个错误时，我发现删除代码块直到你留下一个最小的测试用例通常会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T14:54:03.747

没有关于如何在启动时加载数据的详细信息......如果您还没有这样做，请考虑使用`Dispatcher.BeginInvoke`（优先级低于渲染）或`BackgroundWorker`

[这](http://dotnet.org.za/rudi/archive/2009/01/19/wpf-basics-loading-large-datasets.aspx)是一篇关于如何做到这一点的帖子！

PS。如果您绑定到的对象是`ObservableCollection<>`... 阅读有关我在[此处执行此操作的问题的更多信息，请小心](http://groups.google.co.za/group/wpf-disciples/browse_thread/thread/58c2d48c95964107)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T14:46:44.090

您的应用程序中没有发生任何奇怪的事情。依赖系统“停止工作”是因为系统所依赖的所有 UI 线程都很忙。这都是关于不同 Disparcher 对象的优先级。我可以考虑使用后台进程来延长操作，而所有同步都在 UI 线程中完成。此外，您可以使用任务优先级（DispatcherPriority 枚举作为 Invoke/BeginInvoke 方法的第一个参数）另一个提示，可以帮助您实现 DoEvent 模式，从 WinForms 已知（处理 Windows 队列中的消息）总之，你应该记住，你在 STA 工作。此外，当您在 Windows XP 中使用 ElementHost 时，实际上移除了硬件加速。尝试使用 .NET 3.5 SP1 以某种方式修复它，但您仍然必须离开 CPU 来渲染和调度事物。

# javascript - ajax 和可访问性

> ID：474402
> 
> 赞同：1
> 
> 时间：2009-01-23T20:34:43.243
> 
> 标签：javascript, accessibility

1) 无需 javascript 即可访问网站有多重要？我正在使用很多ajax。我将大部分网站转换为无需 js 即可访问，但所涉及的努力让我想知道这是否值得。

2) 哪些场景（经常发生）可能会关闭 javascript？（除了人们偏执并关闭js）

我正在开发一个专门为我大学的学生服务的网站。我知道该网站的大多数（99%）用户将通过普通的网络浏览器（没有屏幕阅读器或手机等）访问它。

我看到即使是像 digg、reddit 这样的大型网站，当我关闭 js 时也会停止工作，而没有任何尝试提供仅限 html 的访问权限。即使在 SO 中，也无法在没有 javascript 的情况下投票或查看评论（尽管显示了一些不错的错误消息）

编辑：搜索引擎优化不是一个主要问题，因为它是一个非常小众的网站，营销是通过其他方式完成的。现在，它已被索引，并且是搜索站点名称时的第一个结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:37:56.233

禁用 JS 的最常见的不可访问的非偏执原因是搜索引擎机器人开始索引内容时。如果您想在搜索引擎上正确列出，您需要能够处理这个问题。

编辑您的编辑：足够公平。这实际上取决于您网站的功能。如果它是一个主要提供信息的网站，那么要求 JS 是荒谬的。如果它更像是一个 Web 应用程序，那么不需要它会使其更难使用。使信息部分（如果有的话）尽可能易于访问，然后对其余部分做你想做的事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T21:02:00.130

**无障碍的重要性**

对于您的网站而言，具有高度可访问性可能非常重要，特别是如果该网站是为一个由联邦资金资助的组织构建的。

《康复法》于 1998 年进行了修订，现在*要求*联邦机构向残疾人提供其电子和信息技术。

类似的法律适用于电子商务网站，适用于传统零售商的在线店面。

您可以查看[**第 508 节**](http://www.section508.gov/)以获取更多信息，但主要思想是现代屏幕阅读器不会读取部分页面刷新，如果您的网站需要可访问，则需要额外的努力，当然值得您付出努力。

许多 web 框架仍在使用中，它们没有预料到 ajax，它可能需要大量的变通方法才能使东西可访问。尽管如此，这确实是最好的选择，即使您正在开发一个私人网站。

以下是有关该主题的其他几篇文章：

*   [**第 508 条**](http://www.section508.gov/)
*   [**http://www.alistapart.com/articles/saveaccessibility/**](http://www.alistapart.com/articles/saveaccessibility/)
*   [**http://www.alistapart.com/articles/politics/**](http://www.alistapart.com/articles/politics/)

**没有 javascript 的用户**

至于“关闭”javascript，用户在任何地方都不会像 5 年前那样频繁地这样做，尽管有些人仍然可能这样做。您的听众不太可能出现这种情况，并且通常不会将其视为曾经的主要问题。

这些天来，真正关心的只是客户支持。所有现代浏览器都支持足够的 javascript 来让您完成工作。它是替代客户端，例如您提到的可访问性设备，可能会增加您的设计要求。

如果您的某些受众在安全敏感的环境（政府机构等）中工作，则可能仍会强制要求在他们的工作机器上关闭 javascript。随着时间的推移，这也变得越来越少，尽管它比你提到的偏执问题更常见。

当然，如果您为这些用户提供一些支持，则不必担心。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-24T06:47:35.627

听起来您的网站将用于教育环境；许多国家都有关于教育网站可访问性的法律。除此之外，搜索引擎和移动浏览器以及屏幕阅读器将受益于符合标准的网站。

这并不是说你不能使用 Javascript，只是你应该小心。在一个理想的世界里，你应该使用 XHTML 作为你的内容，使用 CSS 作为你的样式，使用 Javascript 作为你的行为。关于后一点，请参阅以下两篇维基百科文章：

*   [http://en.wikipedia.org/wiki/Progressive_Enhancement](http://en.wikipedia.org/wiki/Progressive_Enhancement)
*   [http://en.wikipedia.org/wiki/Unobtrusive_JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T20:42:36.287

黑莓和其他便携式网络浏览器通常默认关闭 javascript

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T20:53:12.020

[我在这里](https://stackoverflow.com/questions/462176/how-do-you-implement-ui-for-the-non-computer-savvy)问了一个非常相关的问题。尽管我在那里说主要目的不是可访问性而是易用性，但这对您来说可能是一本有趣的读物。我是我的大学网站的开发者之一，我们的领导认为教育、非营利组织、政府组织等领域的所有网站都应该 100% 可访问。理想情况下，您希望页面在没有 CSS 和客户端代码（JS/VBScript）的情况下“工作”。[我们使用这个](http://www.visionaustralia.org.au/info.aspx?page=1569)和/或[这个](https://addons.mozilla.org/en-US/firefox/addon/5809)来分析我们的页面，以检查我们网站的可访问性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T07:06:00.630

**这取决于您的网站。**

如果您正在开发仅适用于桌面用户的 Web 应用程序，那么大量的 Javascript 可能是可以的。否则，*强烈考虑*让移动用户、受损用户或关闭 Javascript 的偏执用户访问您的网站。遵循的最佳策略之一是优雅降级，其中没有 Javascript 的用户仍然可以与您的网站交互，只是没有华丽的功能。

# .net - MSBuild 任务 - 构建失败，因为在发布而不是调试中构建了一个解决方案

> ID：474403
> 
> 赞同：2
> 
> 时间：2009-01-23T20:35:03.367
> 
> 标签：.net, msbuild, tfsbuild

我在使用[MSBuild](http://en.wikipedia.org/wiki/MSBuild)时遇到了一个奇怪的问题，我认为这可能只是一个环境问题。我们正在使用 MSBuild 构建许多单独的解决方案，它似乎可以在我的机器上运行。但是在其他几台机器上，它不起作用。

我已经追踪了这个问题，看起来当其他所有东西都在“调试”中构建时，其中一个解决方案（或该解决方案中的一个项目）正在“发布”中构建。这会导致某些引用丢失 - 因此在“发布”中构建的解决方案无法构建。我希望所有解决方案都构建在“调试”中。以下是我们当前的 TFSBuild.proj 文件 - 我们做错了什么？

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="DesktopBuild" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <!-- TO EDIT BUILD TYPE DEFINITION

        To edit the build type, you will need to edit
        this file which was generated by the Create New
        Build Type wizard.  This file is under source
        control and needs to be checked out before
        making any changes.

        The file is available at -

            $/{TeamProjectName}/TeamBuildTypes/{BuildTypeName}

        where you will need to replace TeamProjectName
        and BuildTypeName with your Team Project and
        Build Type name that you created

        Checkout the file

          1\. Open Source Control Explorer by selecting
             View -> Other Windows -> Source Control Explorer

          2\. Ensure that your current workspace has a mapping for
             the $/{TeamProjectName}/TeamBuildTypes folder and
             that you have done a "Get Latest Version" on that
             folder

          3\. Browse through the folders to
             {TeamProjectName}->TeamBuildTypes->{BuildTypeName} folder

          4\. From the list of files available in this folder, right
             click on TfsBuild.Proj. Select 'Check Out For Edit...'

        Make the required changes to the file and save

        Checkin the file
          1\. Right click on the TfsBuild.Proj file
             selected in Step 3 above and select
             'Checkin Pending Changes'

          2\. Use the pending checkin dialog to save your
             changes to the source control

        Once the file is checked in with the
        modifications, all future builds using this
        build type will use the modified settings
    -->

    <!-- Do not edit this -->
    <Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v8.0\TeamBuild\Microsoft.TeamFoundation.Build.targets" />
    <ProjectExtensions>

        <!--  DESCRIPTION
            The description is associated with a build
            type. Edit the value for making changes.
        -->
        <Description>
        </Description>

        <!--  BUILD MACHINE
            Name of the machine which will be used to
            build the solutions selected.
        -->
        <BuildMachine>xxxx-test</BuildMachine>
    </ProjectExtensions>
    <PropertyGroup>

      <!--  TEAM PROJECT
          The team project which will be built using
          this build type.
      -->
      <TeamProject>CFAST</TeamProject>

      <!--  BUILD DIRECTORY
          The directory on the build machine that will
          be used to build the selected solutions. The
          directory must be a local path on the build
          machine (e.g. c:\build).
      -->
      <BuildDirectoryPath>C:\Build\brtcn</BuildDirectoryPath>
      <SolutionRoot Condition=" '$(IsDesktopBuild)'!='true' "
      >$(BuildDirectoryPath)\w</SolutionRoot>

      <!--  DROP LOCATION
          The location to drop (copy) the built binaries
          and the log files after the build is complete.
          This location has to be a valid UNC path of
          the form \\Server\Share. The build machine
          service account and application tier account
          need to have read write permission on this
          share.
      -->
      <DropLocation>\\my-files\xx-files\Build Drop\xx</DropLocation>

      <!--  TESTING
          Set this flag to enable/disable running tests
          as a post build step.
      -->
      <RunTest>false</RunTest>
      <!--  WorkItemFieldValues
          Add/edit key value pairs to set values for
          fields in the work item created during the
          build process. Please make sure the field
          names are valid for the work item type being
          used.
      -->
      <WorkItemFieldValues>Symptom=build break;Steps To Reproduce=Start the build using Team Build</WorkItemFieldValues>
      <!--  CODE ANALYSIS
          To change CodeAnalysis behavior edit this
          value. Valid values for this can be
          Default,Always or Never.

          Default - To perform code analysis as per the individual project settings
          Always  - To always perform code analysis irrespective of project settings
          Never   - To never perform code analysis irrespective of project settings
       -->
      <RunCodeAnalysis>Never</RunCodeAnalysis>

      <!--  UPDATE ASSOCIATED WORK ITEMS
       Set this flag to enable/disable updating associated workitems on a successful build
      -->
      <UpdateAssociatedWorkItems>true</UpdateAssociatedWorkItems>
      <!-- Title for the work item created on build failure -->
      <WorkItemTitle>Build failure in build:</WorkItemTitle>
      <!-- Description for the work item created on build failure -->
      <DescriptionText>This work item was created by Team Build on a build failure.</DescriptionText>
      <!-- Text pointing to log file location on build failure -->
      <BuildlogText>The build log file is at:</BuildlogText>
      <!-- Text pointing to error/warnings file location on build failure -->
      <ErrorWarningLogText>The errors/warnings log file is at:</ErrorWarningLogText>
    </PropertyGroup>
    <ItemGroup>
        <!--  SOLUTIONS
            The path of the solutions to build. To
            add/delete solutions, edit this value. For
            example, to add a solution MySolution.sln,
            add following line -
             <SolutionToBuild Include="C:\Project Files\path\MySolution.sln" />

            To change the order in which the solutions are build, modify the order in
            which the solutions appear below.
        -->
        <SolutionToBuild Include="..\..\xx1\xxx\Solution\xxx Solution.sln" />
        <SolutionToBuild Include="..\..\xx2\Build Solutions\xx xx xx Build\Data Port Common Build.sln" />
        <SolutionToBuild Include="..\..\xx3\Build Solutions\xxx Build\xxx Build.sln" />
    </ItemGroup>
    <ItemGroup>
        <!--  CONFIGURATIONS
            The list of configurations to build. To
            add/delete configurations, edit this value.
            For example, to add a new configuration, add
            following lines -
                <ConfigurationToBuild Include="Debug|x86">
                    <FlavorToBuild>Debug</FlavorToBuild>
                    <PlatformToBuild>x86</PlatformToBuild>
                </ConfigurationToBuild>

            The Include attribute value should be unique
            for each ConfigurationToBuild node.
        -->
        <ConfigurationToBuild Include="Debug|Any CPU">
            <FlavorToBuild>Debug</FlavorToBuild>
            <PlatformToBuild>Any CPU</PlatformToBuild>
        </ConfigurationToBuild>
    </ItemGroup>
    <ItemGroup>
        <!--  TEST ARGUMENTS
            If the RunTest is set to true then the
            following test arguments will be used to run
            tests.

            To add/delete new testlist or to choose a
            metadata file (.vsmdi) file, edit this
            value. For e.g. to run BVT1 and BVT2 type
            tests mentioned in the Helloworld.vsmdi
            file, add the following -

            <MetaDataFile Include="C:\Project Files\HelloWorld\HelloWorld.vsmdi">
                <TestList>BVT1;BVT2</TestList>
            </MetaDataFile>

            Where BVT1 and BVT2 are valid test types
            defined in the HelloWorld.vsmdi file.

                MetaDataFile - Full path to test metadata file.
                TestList - The test list in the selected metadata file to run.

            Please note that you need to specify the
            vsmdi file relative to $(SolutionRoot)
        -->
        <MetaDataFile Include=" ">
            <TestList> </TestList>
        </MetaDataFile>
    </ItemGroup>
    <ItemGroup>
      <!--  ADDITIONAL REFERENCE PATH
          The list of additional reference paths to use
          while resolving references.

          For example,
              <AdditionalReferencePath Include="C:\MyFolder\" />
              <AdditionalReferencePath Include="C:\MyFolder2\" />
      -->
      <AdditionalReferencePath Include="..\..\xxxx\Reference Files" />
      <AdditionalReferencePath Include="..\..\xxxx\Build Support\SomeCoolLibrary" />
      <AdditionalReferencePath Include="..\..\xxxx1.1\Reference Files " />
    </ItemGroup>
</Project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T20:40:37.163

确保您的所有构建脚本都有此部分：

```
<ConfigurationToBuild Include="Debug|Any CPU">
  <FlavorToBuild>Debug</FlavorToBuild>
  <PlatformToBuild>Any CPU</PlatformToBuild>
</ConfigurationToBuild> 
```

并将其设置为“调试”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T16:37:24.177

这是我们的构建文件的示例，它强制在发布或调试模式下进行构建 <

```
MSBuild Projects="$(RootPath)\Source\Website.csproj"
                 Targets="ResolveReferences;_CopyWebApplication" Properties="Configuration=$(BuildConfiguration);WebProjectOutputDir=$(DeploymentFolder);OutDir=$(DeploymentFolder)\bin\" /> 
```

Configuration=$(BuildConfiguration) 是上述示例中的键。将 $BuildConfiguration 替换为您的构建环境或从命令行提供它（这就是我们所做的）。这将强制以您想要的模式构建。希望这可以帮助。

# asp.net - 为什么取消按钮没有出现在 asp:Wizard 控件中？

> ID：474419
> 
> 赞同：0
> 
> 时间：2009-01-23T20:39:26.697
> 
> 标签：asp.net

这是我在 aspx 页面上拥有的 asp:Wizard 控件的代码片段，但没有显示“取消”按钮。仅显示下一个和上一个按钮。有谁知道如何解决这个问题？

```
<asp:Wizard 
    runat="server" 
    OnFinishButtonClick="wizCreateUser_Finish" 
    OnNextButtonClick="wizCreateUser_StepChange"
    HeaderText="SpecEx Application Form" 
    Font-Names="Arial" 
    BackColor="#336699" 
    ForeColor="White" 
    ID="wizCreateUser" 
    Font-Bold="False" 
    Style="border: outset 1px black;"
    Height="320px" 
    Width="861px" 
    ActiveStepIndex="0" 
    DisplaySideBar="False" 
    StartNextButtonImageUrl="~/images/next-btn.PNG" 
    StepNextButtonImageUrl="~/images/next-btn.PNG" 
    StepNextButtonType="Image" 
    StartNextButtonText="" 
    StartNextButtonType="Image" 
    StepNextButtonText="" 
    FinishCompleteButtonImageUrl="~/images/finish-btn.png" 
    FinishCompleteButtonType="Image" 
    FinishPreviousButtonImageUrl="~/images/previous-btn.png" 
    FinishPreviousButtonText="" 
    FinishPreviousButtonType="Image" 
    StepPreviousButtonImageUrl="~/images/previous-btn.png" 
    StepPreviousButtonText="" StepPreviousButtonType="Image"
    CancelButtonImageUrl="~/images/cancel-btn.png"  
    CancelButtonText="" 
    CancelButtonType="Image">
</asp:Wizard> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:47:56.493

您需要将“DisplayCancelButton”属性设置为“True”。

# javascript - jQuery - 选择器和 $(this)

> ID：474432
> 
> 赞同：0
> 
> 时间：2009-01-23T20:42:09.610
> 
> 标签：javascript, jquery

好的，这是关于如何解决此问题的一般问题，而不是为给出的示例找到一些解决方法。

假设我有一个`$(this)`对象，它是一个`select`，如果我想选择选定的选项并且我有一个`id`我可以破坏一个

`$('#id option:selected')`

游戏结束。

但是`this`我不能去`$(this+' option:selected')`或类似的东西。

我不太关心`option:selected`在示例中选择 ，因此我不想知道此实例的解决方法。

我想知道的一般是如何将子选择器`:has`与`option:selected`情况相结合`$(this)`。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T20:44:37.967

通过使用[可选的上下文参数](http://docs.jquery.com/Core/jQuery#expressioncontext)：

```
$('option:selected', this) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T08:41:15.850

你也可以这样做：

```
$(this).find('option:selected'); 
```

# unit-testing - 单元测试 scala 演员

> ID：474442
> 
> 赞同：12
> 
> 时间：2009-01-23T20:44:17.123
> 
> 标签：unit-testing, scala, actor

任何人都知道单元测试 Scala 演员的好方法吗？在一般意义上，我有一个接收消息并会发送其他消息作为响应的参与者。这是在多个线程上完成的，不正确的参与者可能会发送错误消息或根本不发送消息。我需要一种简单的方法来创建一个模型 Actor，它可以向被测试的 Actor 发送和接收消息。有这方面的经验吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T21:39:04.660

由于 Actor 式消息传递的动态特性，模拟 Actor 通常完全没有问题。只需创建一个接收所需消息的演员，您就可以回家了。您当然需要确保这个模拟 actor 是传递消息的那个，但只要您尝试测试的 actor 是[可重入](http://en.wikipedia.org/wiki/Reentrant_(subroutine))的，这应该不是问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-24T01:53:59.463

我认为复杂性取决于几个因素......

1.  演员的状态如何？

如果它表现得像一个幂等函数，只是异步的，那么它应该是一个简单的问题，即模拟一个发送消息的参与者，然后检查它是否接收到预期的消息。您可能希望在模拟演员上使用 react/receiveWithin，以防在合理的时间内有响应，您可能会失败而不是挂起。

但是，如果消息不是相互独立的，那么您应该使用各种消息序列和预期结果对其进行测试。

2.  被测试的演员将与多少演员互动？

如果期望一个参与者与许多其他参与者交互，并且它是有状态的，那么应该使用多个发送/接收消息的参与者进行测试。由于您可能无法保证消息到达的顺序，因此您应该确保置换参与者发送消息的顺序，或者在生成消息的参与者中引入随机暂停并多次运行测试。

我不知道有任何用于测试演员的预构建框架，但您可以向 Erlang 寻求灵感。

[http://svn.process-one.net/contribs/trunk/eunit/doc/overview-summary.html](http://svn.process-one.net/contribs/trunk/eunit/doc/overview-summary.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T19:50:57.430

我一直想知道如何自己测试演员。

这是我想出的，有人看到这种方法有问题吗？

如果您的参与者将消息发送委托给一个函数，而不是直接发送消息，该怎么办？

然后，您的测试可以将函数替换为跟踪调用次数和/或调用该方法的参数的函数：

```
class MyActor extends Actor {

  var sendMessage:(Actor, ContactMsg) => Unit = {
    (contactActor, msg) => {
      Log.trace("real sendMessage called")
      contactActor ! msg 
    }
  }

  var reactImpl:PartialFunction(Any, Unit) = {
      case INCOMING(otherActor1, otherActor2, args) => {

        /* logic to test */
        if(args){
          sendMessage(otherActor1, OUTGOING_1("foo"))

        } else {
          sendMessage(otherActor2, OUTGOING_2("bar"))
        }
      }
  }

  final def act = loop {
    react {
      reactImpl
    }
  } 
```

您的测试用例可能包含如下代码：

```
// setup the test
var myActor = new MyActor
var target1 = new MyActor
var target2 = new MyActor
var sendMessageCalls:List[(Actor, String)] = Nil

/*
* Create a fake implementation of sendMessage
* that tracks the arguments it was called with
* in the sendMessageCalls list:
*/
myActor.sendMessage = (actor, message) => {
  Log.trace("fake sendMessage called")
  message match {
    case OUTGOING_1(payload) => { 
      sendMessageCalls = (actor, payload) :: sendMessageCalls
    }
    case _ => { fail("Unexpected Message sent:"+message) }
  }
}

// run the test
myActor.start
myActor.reactImpl(Incoming(target1, target2, true))

// assert the results
assertEquals(1, sendMessageCalls.size)
val(sentActor, sentPayload) = sendMessageCalls(0)
assertSame(target1, sentActor)
assertEquals("foo", sentPayload)
// .. etc. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-05T07:04:12.507

我尝试对演员进行单元测试（它有效）。我使用[Specs](http://code.google.com/p/specs/ "Scala 的规格测试")作为框架。

```
object ControllerSpec extends Specification {
  "ChatController" should{
    "add a listener and respond SendFriends" in{
        var res = false
        val a = actor{}
        val mos = {ChatController !? AddListener(a)}
        mos match{
             case SendFriends => res = true
             case _ => res = false
        }
        res must beTrue
    } 
```

其工作原理是向单例 ChatController 发送同步调用。ChatController 通过使用*reply()*来响应。响应作为被调用函数的返回发送，该函数被存储到 mos 中。然后对 mos 应用匹配，获取从 ChatController 发送的案例类。如果结果是预期的 (SendFriends)，则将 res 设置为 true。*res must beTrue*断言决定了测试的成功或失败。

我正在测试的演员单身人士

```
import ldc.socialirc.model._

import scala.collection.mutable.{HashMap, HashSet}
import scala.actors.Actor
import scala.actors.Actor._

import net.liftweb.util.Helpers._

//Message types
case class AddListener(listener: Actor)
case class RemoveListener(listener: Actor)
case class SendFriends
//Data Types
case class Authority(usr: Actor, role: String)
case class Channel(channelName: String, password: String, creator: String, motd:   String, users: HashSet[Authority])

object ChatController extends Actor {
    // The Channel List  - Shows what actors are in each Chan
    val chanList = new HashMap[String, Channel]
    // The Actor List - Shows what channels its in
    val actorList = new HashMap[Actor, HashSet[String]]

    def notifyListeners = {

    }

    def act = {
        loop {
            react {
                case AddListener(listener: Actor)=>
                    actorList += listener -> new HashSet[String]
                    reply(SendFriends)

            }
        }
    }
    start //Dont forget to start
} 
```

虽然它不完整，但它确实按预期返回了 Sendfriends 案例类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-13T10:38:39.097

用于 Actors 单元测试的套件最近已添加到[Akka](http://doc.akkasource.org/)中。[您可以在这篇](http://roestenburg.agilesquad.com/2011/02/unit-testing-akka-actors-with-testkit_12.html)博文中找到一些信息和代码片段。

# delphi - 为什么某些 Delphi 组件需要“AOwner: TComponent”来构造它们？

> ID：474448
> 
> 赞同：15
> 
> 时间：2009-01-23T20:45:50.913
> 
> 标签：delphi, vcl

要求 TComponent 作为所有者来实例化某种对象似乎完全无关紧要。为什么有这么多 Delphi 组件需要这个？

例如，TXMLDocument 需要一个 TComponent 对象来实例化。

为什么会这样，如果有充分的理由，我应该在那里使用什么来“做正确的事”？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-23T21:14:19.403

所有者组件应该管理其所有拥有的组件。当所有者被销毁时，拥有的组件会自动销毁。

这有助于开发人员从工具面板中拖动组件，将它们放到表单上，然后连接事件以完成工作，而无需担心管理组件的生命周期。

表单是放置在其上的所有组件的所有者。Application 对象是表单的所有者。当应用程序关闭时，应用程序对象被破坏，这反过来又破坏了表单和所有组件。

但是创建组件时，所有者并不是真正需要的。如果您将 Nil 传递给参数，则将在没有所有者的情况下创建组件，在这种情况下，您将负责管理组件的生命周期。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T21:29:27.360

所有 TComponent 后代都需要 Owner，它在 TComponent 构造函数中定义。Owner 组件负责销毁所有的 Owned 组件。

如果要控制寿命，可以将 nil 作为参数传递。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T22:02:55.453

只是为了添加一些额外的信息。

每个控件也有一个父控件。（一个 TWinControl）。所有者负责生命周期，父母负责显示对象。

例如，一个表单有一个面板，而面板有一个按钮。在这种情况下，表单拥有面板和按钮。但是表单是面板的父级，而面板是按钮的父级。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T00:16:21.943

还有一点需要注意。我已经使用了多个第三方组件，它们**依赖**于在构造函数创建中传递的所有者组件，如果你传入 Nil 将引发异常/AV。

最终结果是，当您在 IDE 中使用可视化组件时，这些组件可以正常工作，但在运行时创建它们时会出现问题。

从某种意义上说，造成这些问题的原因是糟糕的设计。规则中没有任何内容表明您不能/不应该将 NIL 作为 aOwner 参数传递。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T14:03:47.087

You shoudl use this for two reasons: - the ownership mechanism stands also as a kind of garbage collecting system - the ownership mechanism is important in Delphi serialization process (Stream.ReadComponent/WriteComponent etc).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T18:14:02.903

An Owner parameter is only needed for `TComponent` descendants, as it is a parameter of the `TComponent` constructor. All components that are accessible at design-time for dropping on `TForm`, `TFrame`, and `TDataModule` classes are `TComponent` descendants (which includes `TXMLDocument`).

# c# - 异常消息是否应该全球化

> ID：474450
> 
> 赞同：11
> 
> 时间：2009-01-23T20:46:24.313
> 
> 标签：c#, exception, globalization

我正在做一个项目，我刚刚开始做所有必要的工作来全球化应用程序。经常出现的一件事是是否将异常消息全球化，但要确保 string.Format 使用 CultureInfo.CurrentCulture 而不是 CultureInfo.InvariantCulture。此外，这意味着异常消息将存储在可以标记为特定于文化的资源文件中。

所以问题是，异常消息应该全球化还是应该留在 InvariantCulture 或作者所在的国家？在我的情况下，美国。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-23T20:52:05.393

异常消息应该很少直接显示给用户。您需要考虑每个字符串的消费者。显然，用户界面中的文本片段需要国际化，但是如果异常消息*只会*被支持人员看到（或者对用户可见，然后在他们单击按钮时通过电子邮件发送给支持人员），那么这样做的好处在哪里？翻译它？

如果你走得太远，你不仅会浪费时间和精力（而 i18n 可能会花费*很多*精力），而且还会让你的支持生活变得更加艰难。您真的不想阅读用外语编写的日志文件并将它们翻译回您的母语。

*微软将他们的*异常消息国际化是有道理的，因为它们将被来自世界各地的*开发人员*阅读——但除非你是跨国公司，与多个国家的开发人员没有共同的语言，我不会翻译消息这真的是为了开发/支持。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-23T20:50:15.710

通常，我不会。

将用户可能看到的字符串全球化，并且您不会让异常消息渗透到 UI 中，对吗？

对？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T20:50:13.197

如果您将成为处理异常的人，那么要么将它们留在您可以理解的语言中，要么给它们代码，以便您可以用您的母语查找它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T20:55:27.273

我假设全球化，你的意思是[i18n](http://www.w3.org/International/)兼容，通常称为国际化。是的，将 GUI 的所有可见部分国际化，包括诊断消息。日志文件是开发人员应该去获取堆栈跟踪等真实信息的地方，不应该被国际化。

# java - Java int[][] 数组 - 迭代和查找值

> ID：474451
> 
> 赞同：9
> 
> 时间：2009-01-23T20:47:21.440
> 
> 标签：java, arrays, iteration

我有一个 ' ' 形式的数组，`int[][]`它代表一个小网格的坐标。每个坐标都被分配了自己的值。例如`array[0][4] = 28`……

我有两个问题。首先，我如何遍历所有存储的值。其次，我希望能够输入一个值并返回其在网格中的特定坐标。解决这个问题的最佳方法是什么？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-23T20:54:12.300

您可以使用 for 循环或增强的 for 循环进行迭代：

```
for (int row=0; row < grid.length; row++)
{
    for (int col=0; col < grid[row].length; col++)
    {
        int value = grid[row][col];
        // Do stuff
    }
} 
```

或者

```
// Note the different use of "row" as a variable name! This
// is the *whole* row, not the row *number*.
for (int[] row : grid)
{
    for (int value : row)
    {
         // Do stuff
    }
} 
```

第一个版本将是“查找坐标”问题的最简单解决方案 - 只需检查内部循环中的值是否正确。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T20:52:39.260

迭代值使用循环：

```
 int[][] matrix   
 //...
 for(int row[] : matrix)
     for(int cell : row){
      //do something with cell
    } 
```

要根据值访问坐标，您需要某种双哈希图（查看 java.util.HashMap），但我不知道直接这样做

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T20:53:06.250

要遍历网格中的所有元素，请尝试以下操作：

```
int grid[][] = new int[10][10];

for(int i = 0; i < grid.length(); ++i) {
    for(int j = 0; j < grid[i].length(); ++j) {
        // Do whatever with grid[i][j] here
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T20:52:46.937

除非您的网格以某种方式排序，否则您可能不会比蛮力搜索做得更好。

对于迭代，我认为它会是这样的（语法可能有点偏离，我有一段时间没有处理 java 中的数组了。）：

```
int[][] grid;  // just assuming this is already assigned somewhere

for(int x = 0 ; x < grid.length ; x++) {
  int[] row = grid[x];
  for(int y = 0 ; y < row.length ; y++) {
    int value = row[y];
    // Here you have the value for grid[x][y] and can do what you need to with it
  }
} 
```

对于搜索，您可能需要使用它进行迭代，然后在找到它后返回。

如果您可能多次查找相同值的位置，那么您可能希望使用哈希表来记忆结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T20:53:31.973

使用嵌套的 for 循环遍历 x 和 y 维度，这样您就可以遍历每个值，一次一个。

要输入一个值，只需执行与上述相同的操作，但要查找与您请求的值匹配的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T21:32:01.053

如果您在单个类中阻止所有这些集合并且不以任何方式公开它们，您会很高兴。

这意味着将您的搜索和查找例程也移动到此类中。

对于存储，每个人都涵盖了迭代、添加哈希表和查找。我在 nickolai 的帖子上发表了这条评论：

将 new Integer(ix + iy * 1000) 存储为哈希表中的值。如果您的 y 索引可以超过 1000，请使用更大的数字——整数真的很大。要取回它，请使用 ix=val%1000, iy=val/1000。

如果您的数组和哈希表封装在同一个类中，那么您的其余代码将非常容易编写并且更加简洁。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-23T20:53:27.730

通常没有办法找到特定值的特定坐标，除非通过数组并搜索它。但是，如果保证数组中的值是唯一的（即每个值只出现在一个单元格中），您可以维护一个单独的数组作为索引，它存储由该值索引的每个值的坐标。

# asp.net - ASP.NET 缓存对象读写

> ID：474458
> 
> 赞同：4
> 
> 时间：2009-01-23T20:49:01.063
> 
> 标签：asp.net, caching

如果一个用户试图读取**HttpContext.Current.Cache[key]**而另一个用户同时试图删除对象**HttpContext.Current.Cache.Remove(key)**会发生什么？

想想数百个用户从缓存中读取数据并试图同时清理一些缓存对象。会发生什么，它是线程安全的吗？

是否可以在缓存中创建数据库感知业务对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T20:52:41.273

内置的 ASP.Net 缓存对象 ( [http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx) ) 是线程安全的，因此在多线程中插入/删除操作环境本质上是安全的。

将任何对象放入缓存的主要要求是必须是可序列化的。所以是的，您的 db-aware 业务对象可以进入缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T20:58:45.177

如果代码无法获取对象，则不返回任何内容/null。

如果您有机会如此频繁地删除对象，为什么还要费心缓存它呢？如果对象不再在缓存中，最好设置过期时间并重新加载对象。

你能解释一下“数据库感知对象”吗？您的意思是[sql 缓存依赖项](http://msdn.microsoft.com/en-us/library/system.web.caching.sqlcachedependency.aspx)，还是只是一个包含有关数据库连接信息的对象？

**编辑：** 回复评论#3。

我认为我们在这里遗漏了一些东西。让我解释一下我认为你的意思，你可以告诉我它是否正确。

1.  UserA 检查缓存中的对象（“resultA”）但没有找到。
2.  UserA 运行查询。结果作为“resultA”缓存 5 分钟。
3.  UserB 检查缓存中的对象（“resultA”）并找到它。
4.  UserB 使用缓存对象“resultA”

如果是这种情况，那么您不需要 Sql Cache 依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:26:54.433

好吧，我有一个填充缓存的代码：

```
string cacheKey = GetCacheKey(filter, sort);
if (HttpContext.Current.Cache[cacheKey] == null)
{
  reader = base.ExecuteReader(SelectQuery);
  HttpContext.Current.Cache[cacheKey] = 
    base.GetListByFilter(reader, filter, sort);
}
return HttpContext.Current.Cache[cacheKey] as List<CurrencyDepot>; 
```

并且当执行下面的表更新清理代码时：

```
private void CleanCache()
{
  IDictionaryEnumerator enumerator = 
    HttpContext.Current.Cache.GetEnumerator();
  while (enumerator.MoveNext())
  {
    if (enumerator.Key.ToString().Contains(_TableName))
    {
      try {
        HttpContext.Current.Cache.Remove(enumerator.Key.ToString());
      } catch (Exception) {}
    }
  }
} 
```

这种用法会造成麻烦吗？

# ruby-on-rails - Rails has_many_polymorphs 反过来？

> ID：474461
> 
> 赞同：1
> 
> 时间：2009-01-23T20:49:57.410
> 
> 标签：ruby-on-rails, ruby, has-many-polymorphs

所以我设置了一些模型，每个模型都可以发表评论。我已经使用 has_many_polymorphs 设置了它，但是我开始遇到一些问题，它无法按照我认为的方式工作。

例如：

```
class Project < ActiveRecord::Base
end

class Message < ActiveRecord::Base
  has_many_polymorphs :consumers, 
    :from => [:projects, :messages], 
    :through  => :message_consumers,
    :as => :comment   # Self-referential associations have to rename the non-polymorphic key
end

class MessageConsumer < ActiveRecord::Base
  # Self-referential associations have to rename the non-polymorphic key
  belongs_to :comment, :foreign_key => 'comment_id', :class_name => 'Message'

  belongs_to :consumer, :polymorphic => true
end 
```

在这种情况下，删除项目时消息不会被删除，因为消息实际上是关系中的父级。

我对示例进行了一些简化，但还有其他模型具有消息，并且也有类似工作的附件。

什么是正确的设置方法，以便在删除父级时删除子级？我希望没有一百万张桌子，但我想不出另一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T07:15:19.753

当您说“当父级被删除时，子级被删除？”，你能举个例子吗？即当一个项目被删除时，我希望它的所有消息也被删除？当您删除一条消息时会发生什么，您是否还希望删除其他任何内容（例如所有相应的 message_consumer 条目）？

* * *

**更新**

好的，所以`has_many_polymorphs`会自动删除“孤儿” `message_consumer`。您的问题是一条消息可能有多个消费者，因此删除一个项目可能不足以删除其所有相关消息（因为其他消费者可能依赖于这些消息。）

在这种特殊情况下，您可以在 中设置`after_destroy`回调`MessageConsumer`，以检查是否仍然存在`MessageConsumer`引用 的其他映射（除了 self）`Message`，如果不存在，还删除消息，例如：

```
class MessageConsumer < ActiveRecord::Base

  ...

  after_destroy :delete_orphaned_messages

  def delete_orphaned_messages
    if MessageConsumer.find(:first, :conditions => [ 'comment_id = ?', self.comment_id] ).empty?
      self.comment.delete
    end
  end
end 
```

所有这些都发生在事务中，所以要么所有删除都成功，要么都不成功。

您应该只知道潜在的竞争条件，其中一个会话将得出`Message`不再使用 a 的结论，而另一个会话可能正在`MessageConsumer`为该完全相同的`Message`. 这可以通过数据库级​​别的引用完整性（添加外键约束，这将使两个会话中的一个失败，并使您的数据库保持一致状态）或锁定（啊！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T20:31:34.300

您可以通过使用[`acts_as_commentable`](http://www.juixe.com/techknow/index.php/2006/06/18/acts-as-commentable-plugin/).

# php - 如何在 RSS 2.0 提要中获取完整条目

> ID：474466
> 
> 赞同：1
> 
> 时间：2009-01-23T20:51:16.330
> 
> 标签：php, rss

我使用了人们建议尝试解析 RSS 的几种不同脚本，包括 Magpie 和 PHP 中的 SimpleXML 功能。但似乎没有人能很好地处理 RSS 2.0，因为他们不会把完整的内容块还给我。有没有人建议阅读[http://chacha102.com/feed/](http://chacha102.com/feed/)上的提要，并获取完整内容而不仅仅是描述？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T21:36:11.280

无需阅读任何有关 rss“内容”名称空间以及如何使用它的文档，这里是一个有效的 SimpleXML 脚本。诀窍是在检索内容时使用命名空间。

```
/* the namespace of rss "content" */
$content_ns = "http://purl.org/rss/1.0/modules/content/";

/* load the file */
$rss = file_get_contents("http://chacha102.com/feed/");
/* create SimpleXML object */
$xml = new SimpleXMLElement($rss);
$root=$xml->channel; /* our root element */

foreach($root->item as $item) { /* loop over every item in the channel */
    print "Description: <br>".$item->description."<br><br>";
    print "Full content: <div>";
    foreach($item->children($content_ns) as $content_node) {
        /* loop over all children in the "content" namespace */
        print $content_node."\n";
    }
    print "</div>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:36:56.020

你有什么现在不工作的？解析 RSS 应该是一个简单的过程。尝试从过多的库中退后一步，只使用一些简单的 XPath 查询或访问 PHP 中的 DOMDocument 对象。

参见：[PHP DOMDocument](http://us2.php.net/manual/en/class.domdocument.php)

# sql-server-2005 - 我在 Sql Server 2005 中使用什么函数来获取 UTC 格式的当前日期时间？

> ID：474479
> 
> 赞同：2
> 
> 时间：2009-01-23T20:54:03.673
> 
> 标签：sql-server-2005

我已经在默认值中使用 GetDate() 很长时间了。
什么是等效的调用，或者 SQL 2005 中的逻辑让我输入一个默认值，它将给我当前的 UTC 时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T20:56:56.710

```
GETUTCDATE() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T20:57:32.853

**GETUTCDATE()**

GETDATE() 和 GETUTCDATE() 之间的区别在于 SQL Server 机器的时区编号。

# concurrency - 函数式语言（特别是 Erlang）如何/为什么能够很好地扩展？

> ID：474497
> 
> 赞同：92
> 
> 时间：2009-01-23T20:59:28.983
> 
> 标签：concurrency, functional-programming, erlang, scalability

一段时间以来，我一直在关注函数式编程语言和功能日益增长的知名度。我调查了他们，没有看到上诉的原因。

[然后，最近我在Codemash](http://codemash.org/default.aspx)参加了 Kevin Smith 的“Erlang 基础”演讲。

我很喜欢这个演示，并了解到函数式编程的许多属性使得避免线程/并发问题变得更加容易。我理解缺乏状态和可变性使得多个线程无法更改相同的数据，但 Kevin 说（如果我理解正确的话）所有通信都是通过消息进行的，并且消息是同步处理的（再次避免并发问题）。

但我读过 Erlang 用于高度可扩展的应用程序（爱立信首先创建它的全部原因）。如果所有内容都作为同步处理的消息进行处理，如何有效地处理每秒数千个请求？这难道不是我们开始转向异步处理的原因吗？这样我们就可以利用同时运行多个操作线程并实现可伸缩性？看起来这种架构虽然更安全，但在可扩展性方面倒退了一步。我错过了什么？

我理解 Erlang 的创建者故意避免支持线程以避免并发问题，但我认为多线程是实现可伸缩性所必需的。

**函数式编程语言如何在本质上是线程安全的，但仍然可以扩展？**

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-23T21:07:16.127

函数式语言（通常）不依赖于[改变](https://en.wikipedia.org/wiki/Immutable_object)变量。正因为如此，我们不必保护变量的“共享状态”，因为值是固定的。这反过来又避免了传统语言在跨处理器或机器上实现算法所必须经历的大部分跳跃。

Erlang 通过在消息传递系统中烘焙它比传统的函数式语言更进一步，该系统允许一切都在基于事件的系统上运行，其中一段代码只担心接收消息和发送消息，而不担心更大的图景。

这意味着程序员（名义上）不关心消息将在另一个处理器或机器上处理：只需发送消息就足以让它继续。如果它关心响应，它将等待它作为*另一条消息*。

这样做的最终结果是每个片段都独立于其他片段。没有共享代码，没有共享状态，所有交互都来自一个可以分布在许多硬件（或不分布）的消息系统。

将此与传统系统进行对比：我们必须在“受保护”变量和代码执行周围放置互斥锁和信号量。我们通过堆栈在函数调用中进行了紧密绑定（等待返回发生）。所有这些都会造成瓶颈，而在 Erlang 这样的无共享系统中，这些瓶颈问题不大。

编辑：我还应该指出 Erlang 是异步的。你发送你的消息，也许/有一天另一条消息会回来。或不。

Spencer 关于乱序执行的观点也很重要并且得到了很好的回答。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-01-23T21:18:27.040

消息队列系统很酷，因为它有效地产生了“触发并等待结果”效果，这是您正在阅读的同步部分。令人难以置信的是，它意味着行不需要按顺序执行。考虑以下代码：

```
r = methodWithALotOfDiskProcessing();
x = r + 1;
y = methodWithALotOfNetworkProcessing();
w = x * y 
```

考虑一下 methodWithALotOfDiskProcessing() 大约需要 2 秒才能完成，而 methodWithALotOfNetworkProcessing() 大约需要 1 秒才能完成。在过程语言中，这段代码运行大约需要 3 秒，因为这些行将按顺序执行。我们正在浪费时间等待一种方法完成，该方法可以与另一种方法同时运行而无需竞争单一资源。在函数式语言中，代码行并不规定处理器何时会尝试它们。函数式语言会尝试以下内容：

```
Execute line 1 ... wait.
Execute line 2 ... wait for r value.
Execute line 3 ... wait.
Execute line 4 ... wait for x and y value.
Line 3 returned ... y value set, message line 4.
Line 1 returned ... r value set, message line 2.
Line 2 returned ... x value set, message line 4.
Line 4 returned ... done. 
```

多么酷啊？通过继续编写代码并仅在必要时等待，我们已自动将等待时间缩短至两秒！:D 所以是的，虽然代码是同步的，但它的含义往往与程序语言不同。

编辑：

一旦您结合 Godeke 的帖子掌握了这个概念，就很容易想象利用多个处理器、服务器群、冗余数据存储以及其他方面的优势是多么*简单。*

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-05T06:25:22.390

您很可能将**synchronize**与**sequence 混为一谈**。

erlang 中的函数体是按顺序处理的。因此，斯宾塞所说的这种“自动魔法效应”并不适用于 erlang。不过，您可以使用 erlang 对这种行为进行建模。

例如，您可以生成一个计算一行中单词数的进程。由于我们有几行，我们为每一行生成一个这样的过程并接收答案以从中计算总和。

这样，我们生成执行“繁重”计算的进程（如果可用，使用额外的核心），然后我们收集结果。

```
-module(countwords).
-export([count_words_in_lines/1]).

count_words_in_lines(Lines) ->
    % For each line in lines run spawn_summarizer with the process id (pid)
    % and a line to work on as arguments.
    % This is a list comprehension and spawn_summarizer will return the pid
    % of the process that was created. So the variable Pids will hold a list
    % of process ids.
    Pids = [spawn_summarizer(self(), Line) || Line <- Lines], 
    % For each pid receive the answer. This will happen in the same order in
    % which the processes were created, because we saved [pid1, pid2, ...] in
    % the variable Pids and now we consume this list.
    Results = [receive_result(Pid) || Pid <- Pids],
    % Sum up the results.
    WordCount = lists:sum(Results),
    io:format("We've got ~p words, Sir!~n", [WordCount]).

spawn_summarizer(S, Line) ->
    % Create a anonymous function and save it in the variable F.
    F = fun() ->
        % Split line into words.
        ListOfWords = string:tokens(Line, " "),
        Length = length(ListOfWords),
        io:format("process ~p calculated ~p words~n", [self(), Length]),
        % Send a tuple containing our pid and Length to S.
        S ! {self(), Length}
    end,
    % There is no return in erlang, instead the last value in a function is
    % returned implicitly.
    % Spawn the anonymous function and return the pid of the new process.
    spawn(F).

% The Variable Pid gets bound in the function head.
% In erlang, you can only assign to a variable once.
receive_result(Pid) ->
    receive
        % Pattern-matching: the block behind "->" will execute only if we receive
        % a tuple that matches the one below. The variable Pid is already bound,
        % so we are waiting here for the answer of a specific process.
        % N is unbound so we accept any value.
        {Pid, N} ->
            io:format("Received \"~p\" from process ~p~n", [N, Pid]),
            N
    end. 
```

这就是它的样子，当我们在 shell 中运行它时：

```
Eshell V5.6.5  (abort with ^G)
1> Lines = ["This is a string of text", "and this is another", "and yet another", "it's getting boring now"].
["This is a string of text","and this is another",
 "and yet another","it's getting boring now"]
2> c(countwords).
{ok,countwords}
3> countwords:count_words_in_lines(Lines).
process <0.39.0> calculated 6 words
process <0.40.0> calculated 4 words
process <0.41.0> calculated 3 words
process <0.42.0> calculated 4 words
Received "6" from process <0.39.0>
Received "4" from process <0.40.0>
Received "3" from process <0.41.0>
Received "4" from process <0.42.0>
We've got 17 words, Sir!
ok
4> 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-24T14:24:15.800

使 Erlang 能够扩展的关键在于并发性。

操作系统通过两种机制提供并发：

*   操作系统进程
*   操作系统线程

进程不共享状态——一个进程不能通过设计使另一个进程崩溃。

线程共享状态——一个线程可以设计使另一个线程崩溃——这是你的问题。

使用 Erlang——虚拟机使用一个操作系统进程，VM 不是通过使用操作系统线程而是通过提供 Erlang 进程来为 Erlang 程序提供并发性——也就是说，Erlang 实现了自己的时间分片器。

这些 Erlang 进程通过发送消息（由 Erlang VM 而非操作系统处理）相互通信。Erlang 进程使用进程 ID (PID) 相互寻址，该进程 ID (PID) 具有三部分地址`<<N3.N2.N1>>`：

*   进程号 N1 on
*   虚拟机 N2 开启
*   物理机N3

同一台虚拟机上的两个进程、同一台机器上的不同虚拟机上或两台机器以相同的方式进行通信——因此，您的扩展与部署应用程序的物理机器的数量无关（初步近似）。

Erlang 只是琐碎意义上的线程安全——它没有线程。（即 SMP/多核 VM 的语言每个内核使用一个操作系统线程）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-23T21:12:58.627

你可能对 Erlang 的工作原理有误解。Erlang 运行时最小化了 CPU 上的上下文切换，但如果有多个 CPU 可用，那么所有 CPU 都用于处理消息。您没有其他语言中的“线程”，但是您可以同时处理大量消息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T17:29:41.843

Erlang 消息是完全异步的，如果你想同步回复你的消息，你需要明确地编码。可能说的是进程消息框中的消息是按顺序处理的。发送到进程的任何消息都位于该进程消息框中，并且该进程可以从该框中选择一条消息进行处理，然后按照它认为合适的顺序移动到下一条消息。这是一个非常连续的动作，接收块正是这样做的。

看起来你已经混合了克里斯提到的同步和顺序。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-23T21:07:51.507

参考透明度：见[http://en.wikipedia.org/wiki/Referential_transparency_(computer_science)](http://en.wikipedia.org/wiki/Referential_transparency_(computer_science))

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-23T21:20:11.110

在纯函数式语言中，计算顺序无关紧要 - 在函数应用程序 fn(arg1, .. argn) 中，可以并行计算 n 个参数。这保证了高水平的（自动）并行性。

Erlang 使用一个进程模型，其中一个进程可以在同一个虚拟机上运行，​​或者在不同的处理器上运行——没有办法分辨。这是可能的，因为消息是在进程之间复制的，没有共享（可变）状态。多处理器并行比多线程走得更远，因为线程依赖于共享内存，所以在 8 核 CPU 上只能有 8 个线程并行运行，而多处理可以扩展到数千个并行进程。

# sql-server - Sql SMO：如何获取数据库物理文件名的路径？

> ID：474498
> 
> 赞同：5
> 
> 时间：2009-01-23T20:59:59.277
> 
> 标签：sql-server, smo

我正在尝试返回数据库的 mdf/ldf 文件的物理文件路径。

我尝试使用以下代码：

```
Server srv = new Server(connection);
Database database = new Database(srv, dbName);

string filePath = database.PrimaryFilePath; 
```

但是，这会引发异常“'database.PrimaryFilePath' 引发了类型为 'Microsoft.SqlServer.Management.Smo.PropertyNotSetException' 的异常 - 即使我正在针对它运行的数据库存在，并且它的 mdf 文件位于 c:\程序文件\Microsoft SQL Server\MSSQL.1\MSSQL

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T21:20:49.157

通常问题在于 DefaultFile 属性为空。默认数据文件是数据文件存储在 SQL Server 实例上的位置，除非在 FileName 属性中另有指定。如果未指定其他默认位置，则该属性将返回一个空字符串。

因此，如果您未设置默认位置，则此属性不会返回任何内容（空字符串）。

一种解决方法是检查 DefaultFile 属性，如果它返回一个空字符串，则使用 SMO 获取主数据库，然后使用 Database.PrimaryFilePath 属性检索默认数据文件位置（因为它没有更改）

既然您说问题出在您的 PrimaryFilePath 上：

*   确认您的连接已打开
*   确认其他属性可用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:44:46.440

我就是这样做的，为多个文件名做好准备。访问 database.LogFiles 以获取相同的日志文件名列表：

```
private static IList<string> _GetAttachedFileNames(Database database)
{
    var fileNames = new List<string>();

    foreach (FileGroup group in database.FileGroups)
        foreach (DataFile file in group.Files)
            fileNames.Add(file.FileName);

    return fileNames;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T13:19:16.157

服务器 srv = 新服务器（连接）；DatabaseCollection dbc = svr.Databases; 数据库数据库 = dbc["dbName"]; 字符串文件路径 = 数据库.PrimaryFilePath;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T09:24:24.017

我认为最简单的方法是在你的 sql server 实例上运行 sql 脚本，它总是会返回正确的数据和日志文件路径。下面的 sql 可以解决问题

```
 SELECT
    db.name AS DBName,
    (select mf.Physical_Name FROM sys.master_files mf where mf.type_desc = 'ROWS' and db.database_id = mf.database_id ) as DataFile,
    (select mf.Physical_Name FROM sys.master_files mf where mf.type_desc = 'LOG' and db.database_id = mf.database_id ) as LogFile
FROM sys.databases db
order by DBName 
```

如果您愿意，您仍然可以使用 SMO 执行此 sql，这将返回一个数据集，然后您可以提取该信息。

```
 var result = new List();
            var server = new Server( serverInstanceName );
            var data = server.Databases[ "master" ].ExecuteWithResults(sql);

            foreach ( DataRow row in data.Tables[ 0 ].Rows )
                result.Add( new DatabaseInfo( row[ "DBName" ].ToString(), row[ "DataFile" ].ToString(), row[ "LogFile" ].ToString() ) );

            return result; 

```

如果您将使用此代码段，请确保创建一个 DatabaseInfo 类，该类将存储从 Sql 服务器实例返回的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-27T13:33:52.450

```
using Smo = Microsoft.SqlServer.Management.Smo;

public string GetDataBasePath(string strDatabaseName)
{
    ServerConnection srvConn = new ServerConnection();
    srvConn.ConnectionString = "<your connection string goes here>";
    Server srv = new Server(srvConn);

    foreach (Smo.Database db in srv.Databases)
    {
        if (string.Compare(strDatabaseName, db.Name, true) == 0)
        {
            return db.PrimaryFilePath;
        }
    }

    return string.Empty;
} 
```

# svn - Subversion 和图像上传的最佳实践

> ID：474500
> 
> 赞同：1
> 
> 时间：2009-01-23T21:00:52.333
> 
> 标签：svn

运行 ASP.Net 网站并使用 TinyMCE 进行内容管理。用户需要能够为内容上传图片。这些图像将显示在网站内容（新闻、文章等）中，但除其内容外，不会被任何其他内容引用。

这些图像应该受版本控制（svn），还是应该在需要时（备份、测试等）传递上传目录？如果应该对它们进行版本控制，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T21:08:38.853

内容不是应用程序的一部分，只是您正在运行的实例，因此应该将其添加到您的备份中，而不是您的 SVN 存储库。如果它本身有应用程序的一部分，我只会将图像添加到 SVN。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:12:21.640

没有理由不将图像存储在版本管理存储库中，它是处理思想变化、谁做了什么以及事情如何随时间演变的绝佳工具。

您唯一需要做的就是确保您对这些文件具有需求锁定属性 - 您想要的最后一件事是让用户获取文件，修改它，然后尝试签入它只是发现其他人修改了它已经。由于 SVN 的合并能力，通常这不是问题，但合并图像文件有点棘手。因此，将需求锁定属性打开，一次只有 1 个用户可以修改图像。

啊..再读一遍，你的意思是用户上传的内容不属于你的网站吗？在这种情况下，你为什么需要这些图像——当然是备份它们，但除此之外，你是否在任何地方都需要它们？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-13T15:16:50.170

我认为您想对这些图像进行定期备份。

SVN 很棒，但是如果你想将它用于用户内容，你还必须在应用程序的前端实现 SVN，否则它就没有任何用处。

如果您有 SSH 访问权限，您可以安排一个作业来定期备份图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T11:39:09.937

我通常为图像创建一个不同的颠覆控制。假设您有一个由源代码和图像组成的项目，我创建了两个子版本，如下所示：

`$ svnadmin create my_project`

和

`$ svnadmin create my_project_images`

通过对图像进行任何更改，我只需从颠覆控制拳头中删除该图像，然后添加修改后的图像。这对于图像更改次数远少于源代码的情况很有用，源代码受 my_project 颠覆控制。通过这种方式，我可以使用 SVN 与其他人共享包含二进制数据的项目。

# asp.net - 像 ASP.NET MVC 提供的 URL

> ID：474509
> 
> 赞同：2
> 
> 时间：2009-01-23T21:03:24.917
> 
> 标签：asp.net, asp.net-mvc, url-rewriting, friendly-url

有什么方法可以像在 asp.net mvc 中那样在 asp.net 中实现 URL 机制

例如 mydomain.com/user/myusername 但不使用 MVC

如果是这样，如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T21:07:34.783

您可以使用 System.Web.Routing 程序集来执行此操作

这是一篇[博文](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)，展示了如何:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T21:09:57.633

您可以使用 ASP.NET MVC 在 ASP.NET WebForm 应用程序内部使用的相同路由机制。查看 Phil Haack 的这篇[文章](http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx)，了解如何了解更多信息。

或者

如果您不想使用路由功能并且想推出自己的功能，请查看此[问题](https://stackoverflow.com/questions/22869/aspnet-building-your-own-routing-system)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T21:10:09.023

如果您有权访问 IIS：

*   如果是 IIS7，则 URL 重写模块可能会工作。
*   设置 IIS 以处理 ASP.NET 的任何请求，并向 Global.ashx 添加一个条目

如果是 Apache，请使用 mod_rewrite。

否则，您可以使用：
[http://myserver/Web.aspx/url/1](http://myserver/Web.aspx/url/1) 或：
[http://myserver/Url.aspx/1](http://myserver/Url.aspx/1) 并处理 Request.Uri.PathInfo

它必须转到某个地方的 .aspx 文件，否则它不会被处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T21:39:07.420

我过去曾使用 ASP.NET 2.0 和[UrlRewrite.Net](http://www.urlrewriting.net)库完成此操作

唯一的技巧是，如果您希望它使用没有 aspx 扩展名的路径，您必须配置 IIS 以通过 ASP.NET 引擎传递每个请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T21:11:40.127

我在 2005 年左右构建了一个经典的 ASP.NET（我不敢相信这个术语存在）应用程序，它使用了重写，当时 MSDN 上的这篇文章非常有帮助：http: [//msdn.microsoft.com/en-us/库/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)。

如果您受限于 2.0，甚至 1.1，这可能是要走的路，因为 System.Web.Routing 只有 3.5。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T04:36:56.363

[IIRF](http://www.codeplex.com/IIRF)对 IIS5 和 6 进行 URL 重写。它支持正则表达式。自由。开源。

# asp.net-mvc - 表单集合项显示为空

> ID：474518
> 
> 赞同：0
> 
> 时间：2009-01-23T21:05:07.363
> 
> 标签：asp.net-mvc, forms, collections

我正在尝试使用表单集合，这就是我用来提交表单的方法。

```
 <%=Html.ActionLink("Update", "Calendar", ViewData["sub"], new { onclick =  "this.form.submit();" })%> 
```

只是为了它，我尝试用一​​个保留其价值的下拉列表替换它，突然间我得到了我所有的表单集合。

```
 <%=Html.DropDownList("dllMonth", new SelectList(new List<string>() { "January", 
    "Feburary", "March", "April", "June", "July", "August", "September", "October", "November", "December"}, ViewData["Month"]), new { onchange = "this.form.submit();" })%> 
```

有人可以解释发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T23:41:42.210

我将我的操作链接更改为以下内容，现在一切正常：

```
<a name="update" href="Calendar" onclick="this.form.submit();" type="submit">Update</a> 
```

# c++ - 使用什么 API 在现有 MFC 应用程序中添加 HTTP 客户端支持？

> ID：474521
> 
> 赞同：2
> 
> 时间：2009-01-23T21:05:27.923
> 
> 标签：c++, http, mfc, winhttp

我最近接到了一项任务，将与[Web 地图服务](http://en.wikipedia.org/wiki/Web_Map_Service)交互的能力添加到现有 MFC 应用程序中，我需要一个客户端 HTTP API。

根据我的研究，领先的候选人似乎是[CAtlHttpClient](http://msdn.microsoft.com/en-us/library/a58y3a65(VS.80).aspx)和[WinHTTP](http://msdn.microsoft.com/en-us/library/aa384273(VS.85).aspx)。我很想知道是否有人有可以分享的经验或关于哪种方法更好的意见（或完全不同的建议）。

乍一看，CAtlHttpClient 似乎级别更高一些，更容易使用。然而，在我的研究中，似乎任何时候人们遇到无法用它做某事的问题时，答案都是“使用 WinHTTP”。

**结果**

我最终使用了 WinHTTP，因为 WinInet 显示对话框并且我们的应用程序可以通过 COM API 使用。我避免使用 Ultimate TCP/IP，因为我在一家大公司工作，并且获得批准在产品中使用的第三方软件是一场彻头彻尾的噩梦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:02:48.627

从这里免费试用 Ultimate TCP/IP：

[http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)

这是一个非常好的库，并且很容易与您的应用程序集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T17:59:15.573

最简单的是[WinInet](http://msdn.microsoft.com/en-us/library/aa383630(VS.85).aspx) [MFC 包装器](http://msdn.microsoft.com/en-us/library/6f7sbkyc(VS.80).aspx)：[CInternetSession](http://msdn.microsoft.com/en-us/library/cttkhz64(VS.80).aspx)和朋友。

WinHTTP，虽然是一个不同的 API，但建立在与 WinInet 相同的模型上，但提供了更好的 HTTP 支持（虽然没有 FTP，但您可能不在乎）。应该检查您是否需要 WinHTTP 提供的额外好处。

WinHTTP 的一个缺点是 ATL/MFC 不为其提供包装器，这与 WinInet 不同。

正如 Rob 所提到的，[UltimateTCP](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)是一个很好的选择。它的优点之一是它是一个库：您可以将代码链接到您的应用程序中，从而消除 DLL 地狱的潜在问题。此外，它还附带完整的源代码，如果您遇到实现的限制，这可能会很方便。

做你的选择！

# visual-studio - 水晶报表：新页面

> ID：474523
> 
> 赞同：1
> 
> 时间：2009-01-23T21:05:46.147
> 
> 标签：visual-studio, crystal-reports

我的应用程序为客户打印报表。自然，我希望每个客户的声明都从页面顶部开始。我如何让它做到这一点？

在Section Expert中，如果我选中'new page before'第一组，它会在开头浪费一个页面，如果我选中'new page after'最后一组，它会在最后浪费一个页面。打印 350 条语句时我并不介意，但是当我只打印一条时，它是相当低级的，而且很浪费。

这是 Visual Studio 中的“内置”Crystal Reports。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T07:28:08.670

之后在新页面上使用它

不（OnLastRecord）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:14:47.593

你有'keeptgether'设置吗？您应该能够在组页脚上执行“新页面之后”，并且只有在有以下组时才会转到下一页。否则它将打印页面和报告页脚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T23:41:36.517

您也许可以为“之前的新页面”选项使用公式。当然，对于第 2 页以上的页面，类似下面的内容会返回 true，从而在需要时为您提供新页面。只是一个理论。:)

```
PageNumber > 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-16T10:32:19.880

只要写下这两行代码就可以正常工作了——

rDoc.ReportDefinition.Sections["GroupHeaderSection1"].SectionFormat.EnableNewPageBefore = true; rDoc.ReportDefinition.Sections["GroupHeaderSection1"].SectionFormat.EnableKeepTogether = true;

谢谢并恭祝安康

# asp.net - 行选择后，GridView 滚动回顶部

> ID：474526
> 
> 赞同：14
> 
> 时间：2009-01-23T21:06:12.183
> 
> 标签：asp.net, gridview, state

我在 ma 网站上有一个长的 GridView 控件。它允许行选择。问题是，当我向下滚动此 GridView 并选择一些底部行时，会发生选择，但整个 GridView 正在滚动回顶部。有谁知道如何避免这种情况？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T21:23:44.173

如果它在回发期间发生，那么在您的 <%@ Page %> 指令中，您可以添加以下内容：

```
MaintainScrollPositionOnPostback="true" 
```

这是在 .NET 2.0 中添加的，并向页面添加了一些 JavaScript，以确保页面向下滚动到导致回发的控件。

工作一种享受。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T11:17:58.863

我找到了另一个解决方案。如果您在可滚动的 div 容器中有 GridView，我建议这样做：[保持 DIV 的滚动位置](http://michaelsync.net/2006/06/30/maintain-scroll-position-of-div-using-javascript-aspnet-20)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T21:12:10.313

选择行后是否重新加载整个页面？如果是这样，请尝试将 GridView 放在 UpdatePanel 中，以便将事件发送到服务器而无需实际重新加载整个页面。

# python - 每 x 秒重复执行一个函数的最佳方法是什么？

> ID：474528
> 
> 赞同：418
> 
> 时间：2009-01-23T21:07:05.813
> 
> 标签：python, timer

我想永远每 60 秒在 Python 中重复执行一个函数（就像 Objective C 中的[NSTimer](http://web.archive.org/web/20090823012700/http://developer.apple.com:80/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html)或 JS 中的 setTimeout 一样）。此代码将作为守护程序运行，实际上就像使用 cron 每分钟调用一次 python 脚本一样，但不需要用户设置。

在[这个关于在 Python 中实现的 cron 的问题中](https://stackoverflow.com/questions/373335/suggestions-for-a-cron-like-scheduler-in-python)，解决方案似乎有效地只是[sleep()](http://docs.python.org/library/time.html#time.sleep) x 秒。我不需要如此高级的功能，所以也许这样的东西会起作用

```
while True:
    # Code executed here
    time.sleep(60) 
```

这段代码有任何可预见的问题吗？

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2009-01-23T21:09:33.110

如果您的程序还没有事件循环，请使用[sched](http://docs.python.org/library/sched.html)模块，它实现了一个通用的事件调度程序。

```
import sched, time
s = sched.scheduler(time.time, time.sleep)
def do_something(sc): 
    print("Doing stuff...")
    # do your stuff
    s.enter(60, 1, do_something, (sc,))

s.enter(60, 1, do_something, (s,))
s.run() 
```

如果您已经在使用`asyncio`, `trio`, `tkinter`, `PyQt5`, `gobject`,等事件循环库`kivy`- 只需使用现有事件循环库的方法来安排任务即可。

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2014-08-11T20:25:25.000

将您的时间循环锁定到系统时钟，如下所示：

```
import time
starttime = time.time()
while True:
    print("tick")
    time.sleep(60.0 - ((time.time() - starttime) % 60.0)) 
```

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2016-07-11T22:15:34.927

如果您想要一种非阻塞方式来定期执行您的函数，而不是阻塞无限循环，我会使用线程计时器。这样，您的代码可以继续运行并执行其他任务，并且仍然每 n 秒调用一次您的函数。我经常使用这种技术来打印长的、CPU/磁盘/网络密集型任务的进度信息。

这是我在类似问题中发布的代码，带有 start() 和 stop() 控件：

```
from threading import Timer

class RepeatedTimer(object):
    def __init__(self, interval, function, *args, **kwargs):
        self._timer     = None
        self.interval   = interval
        self.function   = function
        self.args       = args
        self.kwargs     = kwargs
        self.is_running = False
        self.start()

    def _run(self):
        self.is_running = False
        self.start()
        self.function(*self.args, **self.kwargs)

    def start(self):
        if not self.is_running:
            self._timer = Timer(self.interval, self._run)
            self._timer.start()
            self.is_running = True

    def stop(self):
        self._timer.cancel()
        self.is_running = False 
```

用法：

```
from time import sleep

def hello(name):
    print "Hello %s!" % name

print "starting..."
rt = RepeatedTimer(1, hello, "World") # it auto-starts, no need of rt.start()
try:
    sleep(5) # your long-running job goes here...
finally:
    rt.stop() # better in a try/finally block to make sure the program ends! 
```

特征：

*   仅标准库，无外部依赖
*   `start()`即使计时器已经启动/停止，`stop()`也可以安全地多次调用
*   要调用的函数可以有位置参数和命名参数
*   您可以`interval`随时更改，下次运行后生效。同样的`args`，`kwargs`甚至`function`！

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2009-01-23T21:14:06.393

您可能需要考虑[Twisted](http://twistedmatrix.com/trac/)，它是一个实现[Reactor Pattern](http://en.wikipedia.org/wiki/Reactor_pattern)的 Python 网络库。

```
from twisted.internet import task, reactor

timeout = 60.0 # Sixty seconds

def doWork():
    #do work here
    pass

l = task.LoopingCall(doWork)
l.start(timeout) # call every sixty seconds

reactor.run() 
```

虽然“while True: sleep(60)”可能会工作 Twisted 可能已经实现了您最终需要的许多功能（如 bobince 所指出的守护进程、日志记录或异常处理），并且可能是一个更强大的解决方案

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2016-12-05T00:22:40.053

这是 MestreLion 对代码的更新，可避免随着时间的推移而漂移。

此处的 RepeatedTimer 类按照 OP 的要求每隔“间隔”秒调用一次给定函数；时间表不取决于函数执行需要多长时间。我喜欢这个解决方案，因为它没有外部库依赖项；这只是纯python。

```
import threading 
import time

class RepeatedTimer(object):
  def __init__(self, interval, function, *args, **kwargs):
    self._timer = None
    self.interval = interval
    self.function = function
    self.args = args
    self.kwargs = kwargs
    self.is_running = False
    self.next_call = time.time()
    self.start()

  def _run(self):
    self.is_running = False
    self.start()
    self.function(*self.args, **self.kwargs)

  def start(self):
    if not self.is_running:
      self.next_call += self.interval
      self._timer = threading.Timer(self.next_call - time.time(), self._run)
      self._timer.start()
      self.is_running = True

  def stop(self):
    self._timer.cancel()
    self.is_running = False 
```

示例用法（复制自 MestreLion 的回答）：

```
from time import sleep

def hello(name):
    print "Hello %s!" % name

print "starting..."
rt = RepeatedTimer(1, hello, "World") # it auto-starts, no need of rt.start()
try:
    sleep(5) # your long-running job goes here...
finally:
    rt.stop() # better in a try/finally block to make sure the program ends! 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2012-11-04T10:26:10.230

我认为更简单的方法是：

```
import time

def executeSomething():
    #code here
    time.sleep(60)

while True:
    executeSomething() 
```

这样你的代码就被执行了，然后它等待 60 秒然后它再次执行，等待，执行等等......不需要让事情复杂化：D

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2018-04-12T16:31:00.910

```
import time, traceback

def every(delay, task):
  next_time = time.time() + delay
  while True:
    time.sleep(max(0, next_time - time.time()))
    try:
      task()
    except Exception:
      traceback.print_exc()
      # in production code you might want to have this instead of course:
      # logger.exception("Problem while executing repetitive task.")
    # skip tasks if we are behind schedule:
    next_time += (time.time() - next_time) // delay * delay + delay

def foo():
  print("foo", time.time())

every(5, foo) 
```

如果您想在不阻塞剩余代码的情况下执行此操作，可以使用它让它在自己的线程中运行：

```
import threading
threading.Thread(target=lambda: every(5, foo)).start() 
```

该解决方案结合了其他解决方案中很少发现的几个功能：

*   **异常处理：**在这个级别上，尽可能地正确处理异常，即在不中止程序的情况下为调试目的记录异常。
*   **没有链接：**您在许多答案中找到的常见的类似链的实现（用于安排下一个事件）在调度机制（或其他）中出现任何问题的方面是脆弱的`threading.Timer`，这将终止链。即使问题的原因已经解决，也不会发生进一步的执行。相比之下，一个简单的循环和一个简单`sleep()`的等待要健壮得多。
*   **没有漂移：**我的解决方案准确跟踪它应该运行的时间。不存在取决于执行时间的漂移（与许多其他解决方案一样）。
*   **跳过：**如果一次执行花费了太多时间，我的解决方案将跳过任务（例如，每五秒执行一次，但 X 花费了 6 秒）。这是标准的 cron 行为（并且有充分的理由）。然后，许多其他解决方案只需连续多次执行任务，没有任何延迟。对于大多数情况（例如清理任务），这是不希望的。如果需要*，*只需使用它`next_time += delay`。

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2019-12-05T21:44:15.867

我最终使用了[日程安排](https://github.com/dbader/schedule/)模块。API 很好。

```
import schedule
import time

def job():
    print("I'm working...")

schedule.every(10).minutes.do(job)
schedule.every().hour.do(job)
schedule.every().day.at("10:30").do(job)
schedule.every(5).to(10).minutes.do(job)
schedule.every().monday.do(job)
schedule.every().wednesday.at("13:15").do(job)
schedule.every().minute.at(":17").do(job)

while True:
    schedule.run_pending()
    time.sleep(1) 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2020-11-30T05:18:03.127

替代的灵活性解决方案是[Apscheduler](https://apscheduler.readthedocs.io/en/stable/userguide.html)。

```
pip install apscheduler 
```

```
from apscheduler.schedulers.background import BlockingScheduler
def print_t():
  pass

sched = BlockingScheduler()
sched.add_job(print_t, 'interval', seconds =60) #will do the print_t work for every 60 seconds

sched.start() 
```

此外，apscheduler 还提供了很多调度器，如下所示。

*   BlockingScheduler：当调度程序是进程中唯一运行的东西时使用

*   BackgroundScheduler：当您不使用以下任何框架并希望调度程序在应用程序的后台运行时使用

*   AsyncIOScheduler：如果您的应用程序使用 asyncio 模块，请使用

*   GeventScheduler：如果您的应用程序使用 gevent，则使用

*   TornadoScheduler：在构建 Tornado 应用程序时使用

*   TwistedScheduler：在构建 Twisted 应用程序时使用

*   QtScheduler：在构建 Qt 应用程序时使用

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-01-23T21:12:17.130

它和 cron 之间的主要区别在于，异常会永远杀死守护进程。您可能希望使用异常捕获器和记录器进行包装。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-06-06T18:21:58.707

前段时间我遇到了类似的问题。可能是[http://cronus.readthedocs.org](http://cronus.readthedocs.org)可能有帮助？

对于 v0.2，以下代码段有效

```
import cronus.beat as beat

beat.set_rate(2) # 2 Hz
while beat.true():
    # do some time consuming work here
    beat.sleep() # total loop duration would be 0.5 sec 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-05-21T15:19:39.143

**如果漂移不是问题**

```
import threading, time

def print_every_n_seconds(n=2):
    while True:
        print(time.ctime())
        time.sleep(n)

thread = threading.Thread(target=print_every_n_seconds, daemon=True)
thread.start() 
```

哪个异步输出。

```
#Tue Oct 16 17:29:40 2018
#Tue Oct 16 17:29:42 2018
#Tue Oct 16 17:29:44 2018 
```

如果正在运行的任务需要相当长的时间，则间隔变为 2 秒 + 任务时间，因此如果您需要精确调度，那么这不适合您。

请注意该`daemon=True`标志意味着该线程不会阻止应用程序关闭。例如，有问题在`pytest`运行测试后会无限期挂起，等待此广告停止。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2021-05-11T09:45:01.860

**只需使用**

```
import time

while True:
    print("this will run after every 30 sec")
    #Your code here
    time.sleep(30) 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-03-24T06:56:37.077

一个可能的答案：

```
import time
t=time.time()

while True:
    if time.time()-t>10:
        #run your task here
        t=time.time() 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-03-14T08:27:20.970

我使用 Tkinter after() 方法，它不会“窃取游戏”（就像前面介绍的**sched**模块），即它允许其他东西并行运行：

```
import Tkinter

def do_something1():
  global n1
  n1 += 1
  if n1 == 6: # (Optional condition)
    print "* do_something1() is done *"; return
  # Do your stuff here
  # ...
  print "do_something1() "+str(n1)
  tk.after(1000, do_something1)

def do_something2(): 
  global n2
  n2 += 1
  if n2 == 6: # (Optional condition)
    print "* do_something2() is done *"; return
  # Do your stuff here
  # ...
  print "do_something2() "+str(n2)
  tk.after(500, do_something2)

tk = Tkinter.Tk(); 
n1 = 0; n2 = 0
do_something1()
do_something2()
tk.mainloop() 
```

`do_something1()`并且`do_something2()`可以以任何间隔速度并行运行。在这里，第二个将被以两倍的速度执行。另外请注意，我使用了一个简单的计数器作为终止任一函数的条件。如果您在程序终止之前运行什么函数（例如时钟），您可以使用您喜欢的任何其他条件或不使用。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-09-10T09:55:43.000

这是 MestreLion 代码的改编版本。除了原来的函数，这段代码：

1）添加first_interval用于在特定时间触发定时器（调用者需要计算first_interval并传入）

2）解决原始代码中的竞争条件。在原始代码中，如果控制线程未能取消正在运行的定时器（“停止定时器，并取消定时器动作的执行。这只有在定时器仍处于等待阶段时才有效。”引用自[https:// docs.python.org/2/library/threading.html](https://docs.python.org/2/library/threading.html)），计时器将无休止地运行。

```
class RepeatedTimer(object):
def __init__(self, first_interval, interval, func, *args, **kwargs):
    self.timer      = None
    self.first_interval = first_interval
    self.interval   = interval
    self.func   = func
    self.args       = args
    self.kwargs     = kwargs
    self.running = False
    self.is_started = False

def first_start(self):
    try:
        # no race-condition here because only control thread will call this method
        # if already started will not start again
        if not self.is_started:
            self.is_started = True
            self.timer = Timer(self.first_interval, self.run)
            self.running = True
            self.timer.start()
    except Exception as e:
        log_print(syslog.LOG_ERR, "timer first_start failed %s %s"%(e.message, traceback.format_exc()))
        raise

def run(self):
    # if not stopped start again
    if self.running:
        self.timer = Timer(self.interval, self.run)
        self.timer.start()
    self.func(*self.args, **self.kwargs)

def stop(self):
    # cancel current timer in case failed it's still OK
    # if already stopped doesn't matter to stop again
    if self.timer:
        self.timer.cancel()
    self.running = False 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-05-20T17:49:51.270

这是另一个不使用任何额外库的解决方案。

```
def delay_until(condition_fn, interval_in_sec, timeout_in_sec):
    """Delay using a boolean callable function.

    `condition_fn` is invoked every `interval_in_sec` until `timeout_in_sec`.
    It can break early if condition is met.

    Args:
        condition_fn     - a callable boolean function
        interval_in_sec  - wait time between calling `condition_fn`
        timeout_in_sec   - maximum time to run

    Returns: None
    """
    start = last_call = time.time()
    while time.time() - start < timeout_in_sec:
        if (time.time() - last_call) > interval_in_sec:
            if condition_fn() is True:
                break
            last_call = time.time() 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-02-21T13:43:43.773

我用它来导致每小时 60 个事件，大多数事件在整分钟后的相同秒数发生：

```
import math
import time
import random

TICK = 60 # one minute tick size
TICK_TIMING = 59 # execute on 59th second of the tick
TICK_MINIMUM = 30 # minimum catch up tick size when lagging

def set_timing():

    now = time.time()
    elapsed = now - info['begin']
    minutes = math.floor(elapsed/TICK)
    tick_elapsed = now - info['completion_time']
    if (info['tick']+1) > minutes:
        wait = max(0,(TICK_TIMING-(time.time() % TICK)))
        print ('standard wait: %.2f' % wait)
        time.sleep(wait)
    elif tick_elapsed < TICK_MINIMUM:
        wait = TICK_MINIMUM-tick_elapsed
        print ('minimum wait: %.2f' % wait)
        time.sleep(wait)
    else:
        print ('skip set_timing(); no wait')
    drift = ((time.time() - info['begin']) - info['tick']*TICK -
        TICK_TIMING + info['begin']%TICK)
    print ('drift: %.6f' % drift)

info['tick'] = 0
info['begin'] = time.time()
info['completion_time'] = info['begin'] - TICK

while 1:

    set_timing()

    print('hello world')

    #random real world event
    time.sleep(random.random()*TICK_MINIMUM)

    info['tick'] += 1
    info['completion_time'] = time.time() 
```

根据实际情况，您可能会得到长度刻度：

```
60,60,62,58,60,60,120,30,30,60,60,60,60,60...etc. 
```

但在 60 分钟结束时，您将有 60 个滴答声；并且它们中的大多数将在您喜欢的那一分钟的正确偏移处发生。

在我的系统上，我得到的典型漂移小于 1/20 秒，直到需要进行校正。

这种方法的优点是时钟漂移的分辨率；如果您正在执行诸如每个刻度附加一个项目并且您预计每小时附加 60 个项目之类的事情，这可能会导致问题。未能考虑漂移可能会导致诸如移动平均线之类的次要指示将数据考虑得太深，从而导致输出错误。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-09-29T18:13:20.170

例如，显示当前本地时间

```
import datetime
import glib
import logger

def get_local_time():
    current_time = datetime.datetime.now().strftime("%H:%M")
    logger.info("get_local_time(): %s",current_time)
    return str(current_time)

def display_local_time():
    logger.info("Current time is: %s", get_local_time())
    return True

# call every minute
glib.timeout_add(60*1000, display_local_time) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-08-28T10:59:03.507

```
 ''' tracking number of times it prints'''
import threading

global timeInterval
count=0
def printit():
  threading.Timer(timeInterval, printit).start()
  print( "Hello, World!")
  global count
  count=count+1
  print(count)
printit

if __name__ == "__main__":
    timeInterval= int(input('Enter Time in Seconds:'))
    printit() 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-05-19T16:48:22.110

我认为这取决于您想做什么，并且您的问题没有详细说明。

对我来说，我想在我已经多线程的进程之一中进行昂贵的操作。所以我让领导进程检查时间，只有她做昂贵的操作（检查点深度学习模型）。为此，我增加计数器以确保每 5 秒保存 5、10 和 15 秒（或使用带有 math.floor 的模运算）：

```
def print_every_5_seconds_have_passed_exit_eventually():
    """
    https://stackoverflow.com/questions/3393612/run-certain-code-every-n-seconds
    https://stackoverflow.com/questions/474528/what-is-the-best-way-to-repeatedly-execute-a-function-every-x-seconds
    :return:
    """
    opts = argparse.Namespace(start=time.time())
    next_time_to_print = 0
    while True:
        current_time_passed = time.time() - opts.start
        if current_time_passed >= next_time_to_print:
            next_time_to_print += 5
            print(f'worked and {current_time_passed=}')
            print(f'{current_time_passed % 5=}')
            print(f'{math.floor(current_time_passed % 5) == 0}') 
```

```
starting __main__ at __init__
worked and current_time_passed=0.0001709461212158203
current_time_passed % 5=0.0001709461212158203
True
worked and current_time_passed=5.0
current_time_passed % 5=0.0
True
worked and current_time_passed=10.0
current_time_passed % 5=0.0
True
worked and current_time_passed=15.0
current_time_passed % 5=0.0
True 
```

对我来说，检查 if 语句是我需要的。在我已经很复杂的多处理多 GPU 代码中拥有线程和调度程序并不是我想要添加的复杂性，如果我可以避免它并且似乎我可以。检查工作人员 ID 很容易确保只有 1 个进程在执行此操作。

请注意，我使用 True 打印语句来真正确保模块化算术技巧有效，因为检查确切时间显然不起作用！但令我惊喜的是，地板成功了。

# java - 用Java表示分数的最佳方法？

> ID：474535
> 
> 赞同：102
> 
> 时间：2009-01-23T21:07:59.527
> 
> 标签：java, math, fractions

我正在尝试使用 Java 中的[分数](http://en.wikipedia.org/wiki/Fraction_%28mathematics%29#Vulgar.2C_proper.2C_and_improper_fractions)。

我想实现算术函数。为此，我首先需要一种方法来规范化函数。我知道在我有一个共同点之前，我不能添加 1/6 和 1/2。我将不得不添加 1/6 和 3/6。一种天真的方法会让我添加 2/12 和 6/12，然后减少。如何以最小的性能损失实现共同点？什么算法最适合这个？

* * *

版本 8（感谢[hstoerr](https://stackoverflow.com/users/21499/hstoerr)）：

> 改进包括：
> 
> *   equals() 方法现在与 compareTo() 方法一致

```
final class Fraction extends Number {
    private int numerator;
    private int denominator;

    public Fraction(int numerator, int denominator) {
        if(denominator == 0) {
            throw new IllegalArgumentException("denominator is zero");
        }
        if(denominator < 0) {
            numerator *= -1;
            denominator *= -1;
        }
        this.numerator = numerator;
        this.denominator = denominator;
    }

    public Fraction(int numerator) {
        this.numerator = numerator;
        this.denominator = 1;
    }

    public int getNumerator() {
        return this.numerator;
    }

    public int getDenominator() {
        return this.denominator;
    }

    public byte byteValue() {
        return (byte) this.doubleValue();
    }

    public double doubleValue() {
        return ((double) numerator)/((double) denominator);
    }

    public float floatValue() {
        return (float) this.doubleValue();
    }

    public int intValue() {
        return (int) this.doubleValue();
    }

    public long longValue() {
        return (long) this.doubleValue();
    }

    public short shortValue() {
        return (short) this.doubleValue();
    }

    public boolean equals(Fraction frac) {
        return this.compareTo(frac) == 0;
    }

    public int compareTo(Fraction frac) {
        long t = this.getNumerator() * frac.getDenominator();
        long f = frac.getNumerator() * this.getDenominator();
        int result = 0;
        if(t>f) {
            result = 1;
        }
        else if(f>t) {
            result = -1;
        }
        return result;
    }
} 
```

* * *

我已经删除了所有以前的版本。我要感谢：

*   [戴夫·雷](https://stackoverflow.com/users/40310/dave-ray)
*   [克莱图斯](https://stackoverflow.com/users/18393/cletus)
*   [达菲莫](https://stackoverflow.com/users/37213/duffymo)
*   [詹姆士](https://stackoverflow.com/users/41039/james)
*   [米尔豪斯](https://stackoverflow.com/users/17712/milhous)
*   [奥斯卡·雷耶斯](https://stackoverflow.com/users/20654/oscar-reyes)
*   [杰森小号](https://stackoverflow.com/users/44330/jason-s)
*   [弗朗西斯科·卡内多](https://stackoverflow.com/users/54591/francisco-canedo)
*   [非法程序员](https://stackoverflow.com/users/1471/outlaw-programmer)
*   [贝斯卡](https://stackoverflow.com/users/57120/beska)

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-23T21:21:43.883

碰巧我不久前写了一个 BigFraction 类，用于[Project Euler 问题](http://projecteuler.net)。它保留一个 BigInteger 分子和分母，因此它永远不会溢出。但是对于很多你知道永远不会溢出的操作来说，它会有点慢。无论如何，如果你想要它，就使用它。我一直渴望以某种方式炫耀这一点。:)

**编辑**：此代码的最新和最好的版本，包括单元测试[现在托管在 GitHub 上](https://github.com/kiprobinson/BigFraction)，也[可以通过 Maven Central 获得](https://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22com.github.kiprobinson%22%20AND%20a%3A%22bigfraction%22)。我将原始代码留在这里，以便这个答案不仅仅是一个链接......

* * *

```
import java.math.*;

/**
 * Arbitrary-precision fractions, utilizing BigIntegers for numerator and
 * denominator.  Fraction is always kept in lowest terms.  Fraction is
 * immutable, and guaranteed not to have a null numerator or denominator.
 * Denominator will always be positive (so sign is carried by numerator,
 * and a zero-denominator is impossible).
 */
public final class BigFraction extends Number implements Comparable<BigFraction>
{
  private static final long serialVersionUID = 1L; //because Number is Serializable
  private final BigInteger numerator;
  private final BigInteger denominator;

  public final static BigFraction ZERO = new BigFraction(BigInteger.ZERO, BigInteger.ONE, true);
  public final static BigFraction ONE = new BigFraction(BigInteger.ONE, BigInteger.ONE, true);

  /**
   * Constructs a BigFraction with given numerator and denominator.  Fraction
   * will be reduced to lowest terms.  If fraction is negative, negative sign will
   * be carried on numerator, regardless of how the values were passed in.
   */
  public BigFraction(BigInteger numerator, BigInteger denominator)
  {
    if(numerator == null)
      throw new IllegalArgumentException("Numerator is null");
    if(denominator == null)
      throw new IllegalArgumentException("Denominator is null");
    if(denominator.equals(BigInteger.ZERO))
      throw new ArithmeticException("Divide by zero.");

    //only numerator should be negative.
    if(denominator.signum() < 0)
    {
      numerator = numerator.negate();
      denominator = denominator.negate();
    }

    //create a reduced fraction
    BigInteger gcd = numerator.gcd(denominator);
    this.numerator = numerator.divide(gcd);
    this.denominator = denominator.divide(gcd);
  }

  /**
   * Constructs a BigFraction from a whole number.
   */
  public BigFraction(BigInteger numerator)
  {
    this(numerator, BigInteger.ONE, true);
  }

  public BigFraction(long numerator, long denominator)
  {
    this(BigInteger.valueOf(numerator), BigInteger.valueOf(denominator));
  }

  public BigFraction(long numerator)
  {
    this(BigInteger.valueOf(numerator), BigInteger.ONE, true);
  }

  /**
   * Constructs a BigFraction from a floating-point number.
   * 
   * Warning: round-off error in IEEE floating point numbers can result
   * in answers that are unexpected.  For example, 
   *     System.out.println(new BigFraction(1.1))
   * will print:
   *     2476979795053773/2251799813685248
   * 
   * This is because 1.1 cannot be expressed exactly in binary form.  The
   * given fraction is exactly equal to the internal representation of
   * the double-precision floating-point number.  (Which, for 1.1, is:
   * (-1)^0 * 2^0 * (1 + 0x199999999999aL / 0x10000000000000L).)
   * 
   * NOTE: In many cases, BigFraction(Double.toString(d)) may give a result
   * closer to what the user expects.
   */
  public BigFraction(double d)
  {
    if(Double.isInfinite(d))
      throw new IllegalArgumentException("double val is infinite");
    if(Double.isNaN(d))
      throw new IllegalArgumentException("double val is NaN");

    //special case - math below won't work right for 0.0 or -0.0
    if(d == 0)
    {
      numerator = BigInteger.ZERO;
      denominator = BigInteger.ONE;
      return;
    }

    final long bits = Double.doubleToLongBits(d);
    final int sign = (int)(bits >> 63) & 0x1;
    final int exponent = ((int)(bits >> 52) & 0x7ff) - 0x3ff;
    final long mantissa = bits & 0xfffffffffffffL;

    //number is (-1)^sign * 2^(exponent) * 1.mantissa
    BigInteger tmpNumerator = BigInteger.valueOf(sign==0 ? 1 : -1);
    BigInteger tmpDenominator = BigInteger.ONE;

    //use shortcut: 2^x == 1 << x.  if x is negative, shift the denominator
    if(exponent >= 0)
      tmpNumerator = tmpNumerator.multiply(BigInteger.ONE.shiftLeft(exponent));
    else
      tmpDenominator = tmpDenominator.multiply(BigInteger.ONE.shiftLeft(-exponent));

    //1.mantissa == 1 + mantissa/2^52 == (2^52 + mantissa)/2^52
    tmpDenominator = tmpDenominator.multiply(BigInteger.valueOf(0x10000000000000L));
    tmpNumerator = tmpNumerator.multiply(BigInteger.valueOf(0x10000000000000L + mantissa));

    BigInteger gcd = tmpNumerator.gcd(tmpDenominator);
    numerator = tmpNumerator.divide(gcd);
    denominator = tmpDenominator.divide(gcd);
  }

  /**
   * Constructs a BigFraction from two floating-point numbers.
   * 
   * Warning: round-off error in IEEE floating point numbers can result
   * in answers that are unexpected.  See BigFraction(double) for more
   * information.
   * 
   * NOTE: In many cases, BigFraction(Double.toString(numerator) + "/" + Double.toString(denominator))
   * may give a result closer to what the user expects.
   */
  public BigFraction(double numerator, double denominator)
  {
    if(denominator == 0)
      throw new ArithmeticException("Divide by zero.");

    BigFraction tmp = new BigFraction(numerator).divide(new BigFraction(denominator));
    this.numerator = tmp.numerator;
    this.denominator = tmp.denominator;
  }

  /**
   * Constructs a new BigFraction from the given BigDecimal object.
   */
  public BigFraction(BigDecimal d)
  {
    this(d.scale() < 0 ? d.unscaledValue().multiply(BigInteger.TEN.pow(-d.scale())) : d.unscaledValue(),
         d.scale() < 0 ? BigInteger.ONE                                             : BigInteger.TEN.pow(d.scale()));
  }

  public BigFraction(BigDecimal numerator, BigDecimal denominator)
  {
    if(denominator.equals(BigDecimal.ZERO))
      throw new ArithmeticException("Divide by zero.");

    BigFraction tmp = new BigFraction(numerator).divide(new BigFraction(denominator));
    this.numerator = tmp.numerator;
    this.denominator = tmp.denominator;
  }

  /**
   * Constructs a BigFraction from a String.  Expected format is numerator/denominator,
   * but /denominator part is optional.  Either numerator or denominator may be a floating-
   * point decimal number, which in the same format as a parameter to the
   * <code>BigDecimal(String)</code> constructor.
   * 
   * @throws NumberFormatException  if the string cannot be properly parsed.
   */
  public BigFraction(String s)
  {
    int slashPos = s.indexOf('/');
    if(slashPos < 0)
    {
      BigFraction res = new BigFraction(new BigDecimal(s));
      this.numerator = res.numerator;
      this.denominator = res.denominator;
    }
    else
    {
      BigDecimal num = new BigDecimal(s.substring(0, slashPos));
      BigDecimal den = new BigDecimal(s.substring(slashPos+1, s.length()));
      BigFraction res = new BigFraction(num, den);
      this.numerator = res.numerator;
      this.denominator = res.denominator;
    }
  }

  /**
   * Returns this + f.
   */
  public BigFraction add(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    //n1/d1 + n2/d2 = (n1*d2 + d1*n2)/(d1*d2) 
    return new BigFraction(numerator.multiply(f.denominator).add(denominator.multiply(f.numerator)),
                           denominator.multiply(f.denominator));
  }

  /**
   * Returns this + b.
   */
  public BigFraction add(BigInteger b)
  {
    if(b == null)
      throw new IllegalArgumentException("Null argument");

    //n1/d1 + n2 = (n1 + d1*n2)/d1
    return new BigFraction(numerator.add(denominator.multiply(b)),
                           denominator, true);
  }

  /**
   * Returns this + n.
   */
  public BigFraction add(long n)
  {
    return add(BigInteger.valueOf(n));
  }

  /**
   * Returns this - f.
   */
  public BigFraction subtract(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    return new BigFraction(numerator.multiply(f.denominator).subtract(denominator.multiply(f.numerator)),
                           denominator.multiply(f.denominator));
  }

  /**
   * Returns this - b.
   */
  public BigFraction subtract(BigInteger b)
  {
    if(b == null)
      throw new IllegalArgumentException("Null argument");

    return new BigFraction(numerator.subtract(denominator.multiply(b)),
                           denominator, true);
  }

  /**
   * Returns this - n.
   */
  public BigFraction subtract(long n)
  {
    return subtract(BigInteger.valueOf(n));
  }

  /**
   * Returns this * f.
   */
  public BigFraction multiply(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    return new BigFraction(numerator.multiply(f.numerator), denominator.multiply(f.denominator));
  }

  /**
   * Returns this * b.
   */
  public BigFraction multiply(BigInteger b)
  {
    if(b == null)
      throw new IllegalArgumentException("Null argument");

    return new BigFraction(numerator.multiply(b), denominator);
  }

  /**
   * Returns this * n.
   */
  public BigFraction multiply(long n)
  {
    return multiply(BigInteger.valueOf(n));
  }

  /**
   * Returns this / f.
   */
  public BigFraction divide(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    if(f.numerator.equals(BigInteger.ZERO))
      throw new ArithmeticException("Divide by zero");

    return new BigFraction(numerator.multiply(f.denominator), denominator.multiply(f.numerator));
  }

  /**
   * Returns this / b.
   */
  public BigFraction divide(BigInteger b)
  {
    if(b == null)
      throw new IllegalArgumentException("Null argument");

    if(b.equals(BigInteger.ZERO))
      throw new ArithmeticException("Divide by zero");

    return new BigFraction(numerator, denominator.multiply(b));
  }

  /**
   * Returns this / n.
   */
  public BigFraction divide(long n)
  {
    return divide(BigInteger.valueOf(n));
  }

  /**
   * Returns this^exponent.
   */
  public BigFraction pow(int exponent)
  {
    if(exponent == 0)
      return BigFraction.ONE;
    else if (exponent == 1)
      return this;
    else if (exponent < 0)
      return new BigFraction(denominator.pow(-exponent), numerator.pow(-exponent), true);
    else
      return new BigFraction(numerator.pow(exponent), denominator.pow(exponent), true);
  }

  /**
   * Returns 1/this.
   */
  public BigFraction reciprocal()
  {
    if(this.numerator.equals(BigInteger.ZERO))
      throw new ArithmeticException("Divide by zero");

    return new BigFraction(denominator, numerator, true);
  }

  /**
   * Returns the complement of this fraction, which is equal to 1 - this.
   * Useful for probabilities/statistics.

   */
  public BigFraction complement()
  {
    return new BigFraction(denominator.subtract(numerator), denominator, true);
  }

  /**
   * Returns -this.
   */
  public BigFraction negate()
  {
    return new BigFraction(numerator.negate(), denominator, true);
  }

  /**
   * Returns -1, 0, or 1, representing the sign of this fraction.
   */
  public int signum()
  {
    return numerator.signum();
  }

  /**
   * Returns the absolute value of this.
   */
  public BigFraction abs()
  {
    return (signum() < 0 ? negate() : this);
  }

  /**
   * Returns a string representation of this, in the form
   * numerator/denominator.
   */
  public String toString()
  {
    return numerator.toString() + "/" + denominator.toString();
  }

  /**
   * Returns if this object is equal to another object.
   */
  public boolean equals(Object o)
  {
    if(!(o instanceof BigFraction))
      return false;

    BigFraction f = (BigFraction)o;
    return numerator.equals(f.numerator) && denominator.equals(f.denominator);
  }

  /**
   * Returns a hash code for this object.
   */
  public int hashCode()
  {
    //using the method generated by Eclipse, but streamlined a bit..
    return (31 + numerator.hashCode())*31 + denominator.hashCode();
  }

  /**
   * Returns a negative, zero, or positive number, indicating if this object
   * is less than, equal to, or greater than f, respectively.
   */
  public int compareTo(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    //easy case: this and f have different signs
    if(signum() != f.signum())
      return signum() - f.signum();

    //next easy case: this and f have the same denominator
    if(denominator.equals(f.denominator))
      return numerator.compareTo(f.numerator);

    //not an easy case, so first make the denominators equal then compare the numerators 
    return numerator.multiply(f.denominator).compareTo(denominator.multiply(f.numerator));
  }

  /**
   * Returns the smaller of this and f.
   */
  public BigFraction min(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    return (this.compareTo(f) <= 0 ? this : f);
  }

  /**
   * Returns the maximum of this and f.
   */
  public BigFraction max(BigFraction f)
  {
    if(f == null)
      throw new IllegalArgumentException("Null argument");

    return (this.compareTo(f) >= 0 ? this : f);
  }

  /**
   * Returns a positive BigFraction, greater than or equal to zero, and less than one.
   */
  public static BigFraction random()
  {
    return new BigFraction(Math.random());
  }

  public final BigInteger getNumerator() { return numerator; }
  public final BigInteger getDenominator() { return denominator; }

  //implementation of Number class.  may cause overflow.
  public byte   byteValue()   { return (byte) Math.max(Byte.MIN_VALUE,    Math.min(Byte.MAX_VALUE,    longValue())); }
  public short  shortValue()  { return (short)Math.max(Short.MIN_VALUE,   Math.min(Short.MAX_VALUE,   longValue())); }
  public int    intValue()    { return (int)  Math.max(Integer.MIN_VALUE, Math.min(Integer.MAX_VALUE, longValue())); }
  public long   longValue()   { return Math.round(doubleValue()); }
  public float  floatValue()  { return (float)doubleValue(); }
  public double doubleValue() { return toBigDecimal(18).doubleValue(); }

  /**
   * Returns a BigDecimal representation of this fraction.  If possible, the
   * returned value will be exactly equal to the fraction.  If not, the BigDecimal
   * will have a scale large enough to hold the same number of significant figures
   * as both numerator and denominator, or the equivalent of a double-precision
   * number, whichever is more.
   */
  public BigDecimal toBigDecimal()
  {
    //Implementation note:  A fraction can be represented exactly in base-10 iff its
    //denominator is of the form 2^a * 5^b, where a and b are nonnegative integers.
    //(In other words, if there are no prime factors of the denominator except for
    //2 and 5, or if the denominator is 1).  So to determine if this denominator is
    //of this form, continually divide by 2 to get the number of 2's, and then
    //continually divide by 5 to get the number of 5's.  Afterward, if the denominator
    //is 1 then there are no other prime factors.

    //Note: number of 2's is given by the number of trailing 0 bits in the number
    int twos = denominator.getLowestSetBit();
    BigInteger tmpDen = denominator.shiftRight(twos); // x / 2^n === x >> n

    final BigInteger FIVE = BigInteger.valueOf(5);
    int fives = 0;
    BigInteger[] divMod = null;

    //while(tmpDen % 5 == 0) { fives++; tmpDen /= 5; }
    while(BigInteger.ZERO.equals((divMod = tmpDen.divideAndRemainder(FIVE))[1]))
    {
      fives++;
      tmpDen = divMod[0];
    }

    if(BigInteger.ONE.equals(tmpDen))
    {
      //This fraction will terminate in base 10, so it can be represented exactly as
      //a BigDecimal.  We would now like to make the fraction of the form
      //unscaled / 10^scale.  We know that 2^x * 5^x = 10^x, and our denominator is
      //in the form 2^twos * 5^fives.  So use max(twos, fives) as the scale, and
      //multiply the numerator and deminator by the appropriate number of 2's or 5's
      //such that the denominator is of the form 2^scale * 5^scale.  (Of course, we
      //only have to actually multiply the numerator, since all we need for the
      //BigDecimal constructor is the scale.
      BigInteger unscaled = numerator;
      int scale = Math.max(twos, fives);

      if(twos < fives)
        unscaled = unscaled.shiftLeft(fives - twos); //x * 2^n === x << n
      else if (fives < twos)
        unscaled = unscaled.multiply(FIVE.pow(twos - fives));

      return new BigDecimal(unscaled, scale);
    }

    //else: this number will repeat infinitely in base-10\.  So try to figure out
    //a good number of significant digits.  Start with the number of digits required
    //to represent the numerator and denominator in base-10, which is given by
    //bitLength / log[2](10).  (bitLenth is the number of digits in base-2).
    final double LG10 = 3.321928094887362; //Precomputed ln(10)/ln(2), a.k.a. log[2](10)
    int precision = Math.max(numerator.bitLength(), denominator.bitLength());
    precision = (int)Math.ceil(precision / LG10);

    //If the precision is less than 18 digits, use 18 digits so that the number
    //will be at least as accurate as a cast to a double.  For example, with
    //the fraction 1/3, precision will be 1, giving a result of 0.3\.  This is
    //quite a bit different from what a user would expect.
    if(precision < 18)
      precision = 18;

    return toBigDecimal(precision);
  }

  /**
   * Returns a BigDecimal representation of this fraction, with a given precision.
   * @param precision  the number of significant figures to be used in the result.
   */
  public BigDecimal toBigDecimal(int precision)
  {
    return new BigDecimal(numerator).divide(new BigDecimal(denominator), new MathContext(precision, RoundingMode.HALF_EVEN));
  }

  //--------------------------------------------------------------------------
  //  PRIVATE FUNCTIONS
  //--------------------------------------------------------------------------

  /**
   * Private constructor, used when you can be certain that the fraction is already in
   * lowest terms.  No check is done to reduce numerator/denominator.  A check is still
   * done to maintain a positive denominator.
   * 
   * @param throwaway  unused variable, only here to signal to the compiler that this
   *                   constructor should be used.
   */
  private BigFraction(BigInteger numerator, BigInteger denominator, boolean throwaway)
  {
    if(denominator.signum() < 0)
    {
      this.numerator = numerator.negate();
      this.denominator = denominator.negate();
    }
    else
    {
      this.numerator = numerator;
      this.denominator = denominator;
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-01-23T21:15:10.010

*   使其[不可变](http://en.wikipedia.org/wiki/Immutable_object)；
*   使其[规范化](http://en.wikipedia.org/wiki/Canonical#Mathematics)，意味着 6/4 变为 3/2（[最大公约数](http://en.wikipedia.org/wiki/Greatest_common_divisor)算法对此很有用）；
*   称它为有理数，因为你所代表的是一个[有理数](http://en.wikipedia.org/wiki/Rational_number)；
*   您可以[`BigInteger`](http://java.sun.com/javase/6/docs/api/java/math/BigInteger.html)用来存储任意精确的值。如果不是 then `long`，则实现起来更容易；
*   使分母始终为正。符号应由分子携带；
*   扩展[`Number`](http://java.sun.com/javase/6/docs/api/java/lang/Number.html)；
*   实施[`Comparable<T>`](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)；
*   实施[`equals()`](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#equals(java.lang.Object))和[`hashCode()`](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#hashCode())；
*   为 a 表示的数字添加工厂方法`String`；
*   添加一些方便的工厂方法；
*   添加一个[`toString()`](http://java.sun.com/javase/6/docs/api/java/lang/Object.html#toString()); 和
*   让它[`Serializable`](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)。

事实上，试试这个尺寸。它运行但可能有一些问题：

```
public class BigRational extends Number implements Comparable<BigRational>, Serializable {
    public final static BigRational ZERO = new BigRational(BigInteger.ZERO, BigInteger.ONE);
    private final static long serialVersionUID = 1099377265582986378L;

    private final BigInteger numerator, denominator;

    private BigRational(BigInteger numerator, BigInteger denominator) {
        this.numerator = numerator;
        this.denominator = denominator;
    }

    private static BigRational canonical(BigInteger numerator, BigInteger denominator, boolean checkGcd) {
        if (denominator.signum() == 0) {
            throw new IllegalArgumentException("denominator is zero");
        }
        if (numerator.signum() == 0) {
            return ZERO;
        }
        if (denominator.signum() < 0) {
            numerator = numerator.negate();
            denominator = denominator.negate();
        }
        if (checkGcd) {
            BigInteger gcd = numerator.gcd(denominator);
            if (!gcd.equals(BigInteger.ONE)) {
                numerator = numerator.divide(gcd);
                denominator = denominator.divide(gcd);
            }
        }
        return new BigRational(numerator, denominator);
    }

    public static BigRational getInstance(BigInteger numerator, BigInteger denominator) {
        return canonical(numerator, denominator, true);
    }

    public static BigRational getInstance(long numerator, long denominator) {
        return canonical(new BigInteger("" + numerator), new BigInteger("" + denominator), true);
    }

    public static BigRational getInstance(String numerator, String denominator) {
        return canonical(new BigInteger(numerator), new BigInteger(denominator), true);
    }

    public static BigRational valueOf(String s) {
        Pattern p = Pattern.compile("(-?\\d+)(?:.(\\d+)?)?0*(?:e(-?\\d+))?");
        Matcher m = p.matcher(s);
        if (!m.matches()) {
            throw new IllegalArgumentException("Unknown format '" + s + "'");
        }

        // this translates 23.123e5 to 25,123 / 1000 * 10^5 = 2,512,300 / 1 (GCD)
        String whole = m.group(1);
        String decimal = m.group(2);
        String exponent = m.group(3);
        String n = whole;

        // 23.123 => 23123
        if (decimal != null) {
            n += decimal;
        }
        BigInteger numerator = new BigInteger(n);

        // exponent is an int because BigInteger.pow() takes an int argument
        // it gets more difficult if exponent needs to be outside {-2 billion,2 billion}
        int exp = exponent == null ? 0 : Integer.valueOf(exponent);
        int decimalPlaces = decimal == null ? 0 : decimal.length();
        exp -= decimalPlaces;
        BigInteger denominator;
        if (exp < 0) {
            denominator = BigInteger.TEN.pow(-exp);
        } else {
            numerator = numerator.multiply(BigInteger.TEN.pow(exp));
            denominator = BigInteger.ONE;
        }

        // done
        return canonical(numerator, denominator, true);
    }

    // Comparable
    public int compareTo(BigRational o) {
        // note: this is a bit of cheat, relying on BigInteger.compareTo() returning
        // -1, 0 or 1\.  For the more general contract of compareTo(), you'd need to do
        // more checking
        if (numerator.signum() != o.numerator.signum()) {
            return numerator.signum() - o.numerator.signum();
        } else {
            // oddly BigInteger has gcd() but no lcm()
            BigInteger i1 = numerator.multiply(o.denominator);
            BigInteger i2 = o.numerator.multiply(denominator);
            return i1.compareTo(i2); // expensive!
        }
    }

    public BigRational add(BigRational o) {
        if (o.numerator.signum() == 0) {
            return this;
        } else if (numerator.signum() == 0) {
            return o;
        } else if (denominator.equals(o.denominator)) {
            return new BigRational(numerator.add(o.numerator), denominator);
        } else {
            return canonical(numerator.multiply(o.denominator).add(o.numerator.multiply(denominator)), denominator.multiply(o.denominator), true);
        }
    }

    public BigRational multiply(BigRational o) {
        if (numerator.signum() == 0 || o.numerator.signum( )== 0) {
            return ZERO;
        } else if (numerator.equals(o.denominator)) {
            return canonical(o.numerator, denominator, true);
        } else if (o.numerator.equals(denominator)) {
            return canonical(numerator, o.denominator, true);
        } else if (numerator.negate().equals(o.denominator)) {
            return canonical(o.numerator.negate(), denominator, true);
        } else if (o.numerator.negate().equals(denominator)) {
            return canonical(numerator.negate(), o.denominator, true);
        } else {
            return canonical(numerator.multiply(o.numerator), denominator.multiply(o.denominator), true);
        }
    }

    public BigInteger getNumerator() { return numerator; }
    public BigInteger getDenominator() { return denominator; }
    public boolean isInteger() { return numerator.signum() == 0 || denominator.equals(BigInteger.ONE); }
    public BigRational negate() { return new BigRational(numerator.negate(), denominator); }
    public BigRational invert() { return canonical(denominator, numerator, false); }
    public BigRational abs() { return numerator.signum() < 0 ? negate() : this; }
    public BigRational pow(int exp) { return canonical(numerator.pow(exp), denominator.pow(exp), true); }
    public BigRational subtract(BigRational o) { return add(o.negate()); }
    public BigRational divide(BigRational o) { return multiply(o.invert()); }
    public BigRational min(BigRational o) { return compareTo(o) <= 0 ? this : o; }
    public BigRational max(BigRational o) { return compareTo(o) >= 0 ? this : o; }

    public BigDecimal toBigDecimal(int scale, RoundingMode roundingMode) {
        return isInteger() ? new BigDecimal(numerator) : new BigDecimal(numerator).divide(new BigDecimal(denominator), scale, roundingMode);
    }

    // Number
    public int intValue() { return isInteger() ? numerator.intValue() : numerator.divide(denominator).intValue(); }
    public long longValue() { return isInteger() ? numerator.longValue() : numerator.divide(denominator).longValue(); }
    public float floatValue() { return (float)doubleValue(); }
    public double doubleValue() { return isInteger() ? numerator.doubleValue() : numerator.doubleValue() / denominator.doubleValue(); }

    @Override
    public String toString() { return isInteger() ? String.format("%,d", numerator) : String.format("%,d / %,d", numerator, denominator); }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        BigRational that = (BigRational) o;

        if (denominator != null ? !denominator.equals(that.denominator) : that.denominator != null) return false;
        if (numerator != null ? !numerator.equals(that.numerator) : that.numerator != null) return false;

        return true;
    }

    @Override
    public int hashCode() {
        int result = numerator != null ? numerator.hashCode() : 0;
        result = 31 * result + (denominator != null ? denominator.hashCode() : 0);
        return result;
    }

    public static void main(String args[]) {
        BigRational r1 = BigRational.valueOf("3.14e4");
        BigRational r2 = BigRational.getInstance(111, 7);
        dump("r1", r1);
        dump("r2", r2);
        dump("r1 + r2", r1.add(r2));
        dump("r1 - r2", r1.subtract(r2));
        dump("r1 * r2", r1.multiply(r2));
        dump("r1 / r2", r1.divide(r2));
        dump("r2 ^ 2", r2.pow(2));
    }

    public static void dump(String name, BigRational r) {
        System.out.printf("%s = %s%n", name, r);
        System.out.printf("%s.negate() = %s%n", name, r.negate());
        System.out.printf("%s.invert() = %s%n", name, r.invert());
        System.out.printf("%s.intValue() = %,d%n", name, r.intValue());
        System.out.printf("%s.longValue() = %,d%n", name, r.longValue());
        System.out.printf("%s.floatValue() = %,f%n", name, r.floatValue());
        System.out.printf("%s.doubleValue() = %,f%n", name, r.doubleValue());
        System.out.println();
    }
} 
```

输出是：

```
r1 = 31,400
r1.negate() = -31,400
r1.invert() = 1 / 31,400
r1.intValue() = 31,400
r1.longValue() = 31,400
r1.floatValue() = 31,400.000000
r1.doubleValue() = 31,400.000000

r2 = 111 / 7
r2.negate() = -111 / 7
r2.invert() = 7 / 111
r2.intValue() = 15
r2.longValue() = 15
r2.floatValue() = 15.857142
r2.doubleValue() = 15.857143

r1 + r2 = 219,911 / 7
r1 + r2.negate() = -219,911 / 7
r1 + r2.invert() = 7 / 219,911
r1 + r2.intValue() = 31,415
r1 + r2.longValue() = 31,415
r1 + r2.floatValue() = 31,415.857422
r1 + r2.doubleValue() = 31,415.857143

r1 - r2 = 219,689 / 7
r1 - r2.negate() = -219,689 / 7
r1 - r2.invert() = 7 / 219,689
r1 - r2.intValue() = 31,384
r1 - r2.longValue() = 31,384
r1 - r2.floatValue() = 31,384.142578
r1 - r2.doubleValue() = 31,384.142857

r1 * r2 = 3,485,400 / 7
r1 * r2.negate() = -3,485,400 / 7
r1 * r2.invert() = 7 / 3,485,400
r1 * r2.intValue() = 497,914
r1 * r2.longValue() = 497,914
r1 * r2.floatValue() = 497,914.281250
r1 * r2.doubleValue() = 497,914.285714

r1 / r2 = 219,800 / 111
r1 / r2.negate() = -219,800 / 111
r1 / r2.invert() = 111 / 219,800
r1 / r2.intValue() = 1,980
r1 / r2.longValue() = 1,980
r1 / r2.floatValue() = 1,980.180176
r1 / r2.doubleValue() = 1,980.180180

r2 ^ 2 = 12,321 / 49
r2 ^ 2.negate() = -12,321 / 49
r2 ^ 2.invert() = 49 / 12,321
r2 ^ 2.intValue() = 251
r2 ^ 2.longValue() = 251
r2 ^ 2.floatValue() = 251.448975
r2 ^ 2.doubleValue() = 251.448980 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-01-24T19:41:23.693

> 我正在尝试在 Java 中使用正确的分数。

[Apache Commons Math](http://commons.apache.org/math/)有一个[Fraction](http://commons.apache.org/math/userguide/fraction.html)类已经有一段时间了。大多数时候的答案是，“男孩，我希望 Java在核心库中有类似*X的东西！”* 可以在[Apache Commons library](http://commons.apache.org/)的保护伞下找到。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-01-23T21:12:00.127

请使其成为不可变类型！分数的值不会改变——例如，一半不会变成三分之一。您可以使用 withDenominator 代替 setDenominator，它返回一个*新*分数，该分数具有相同的分子但指定的分母。

使用不可变类型，生活会轻松*得多。*

覆盖 equals 和 hashcode 也是明智的，因此它可以用于映射和集合。Outlaw Programmer 关于算术运算符和字符串格式的观点也很好。

作为一般指南，请查看 BigInteger 和 BigDecimal。他们没有做同样的事情，但他们足够相似，可以给你好的想法。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-23T21:11:07.600

好吧，首先，我会摆脱 setter 并使 Fractions 不可变。

您可能还需要加法、减法等方法，也许还需要某种方法来获取各种字符串格式的表示。

编辑：我可能会将这些字段标记为“最终”以表明我的意图，但我想这没什么大不了的......

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-23T21:13:53.477

> 我需要从最小到最大对它们进行排序，所以最终我还需要将它们表示为双精度

不是绝对必要的。（事实上​​，如果你想正确处理相等，不要依赖 double 来正常工作。）如果 b*d 是正数，如果 ad < bc，则 a/b < c/d。如果涉及负整数，则可以适当处理...

我可能会重写为：

```
public int compareTo(Fraction frac)
{
    // we are comparing this=a/b with frac=c/d 
    // by multiplying both sides by bd.
    // If bd is positive, then a/b < c/d <=> ad < bc.
    // If bd is negative, then a/b < c/d <=> ad > bc.
    // If bd is 0, then you've got other problems (either b=0 or d=0)
    int d = frac.getDenominator();
    long ad = (long)this.numerator * d;
    long bc = (long)this.denominator * frac.getNumerator();
    long diff = ((long)d*this.denominator > 0) ? (ad-bc) : (bc-ad);
    return (diff > 0 ? 1 : (diff < 0 ? -1 : 0));
} 
```

这里的使用`long`是为了确保如果你将两个大`int`s 相乘时不会溢出。如果你能保证分母总是非负的（如果它是负的，只需将分子和分母都取反），那么你就可以不用检查 b*d 是否为正，省去几个步骤。我不确定你在寻找零分母的行为。

不确定性能与使用双打进行比较相比如何。（也就是说，如果您非常关心性能）这是我用来检查的一种测试方法。（似乎工作正常。）

```
public static void main(String[] args)
{
    int a = Integer.parseInt(args[0]);
    int b = Integer.parseInt(args[1]);
    int c = Integer.parseInt(args[2]);
    int d = Integer.parseInt(args[3]);
    Fraction f1 = new Fraction(a,b); 
    Fraction f2 = new Fraction(c,d);
    int rel = f1.compareTo(f2);
    String relstr = "<=>";
    System.out.println(a+"/"+b+" "+relstr.charAt(rel+1)+" "+c+"/"+d);
} 
```

（ps您可​​能会考虑重组以实现`Comparable`或`Comparator`为您的课程。）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-23T21:15:46.890

*   如果没有 add() 和 multiply() 等算术方法，这有点毫无意义。
*   您绝对应该重写 equals() 和 hashCode()。
*   您应该添加一种方法来规范化分数，或者自动进行。考虑一下您是否希望将 1/2 和 2/4 视为相同 - 这对 equals()、hashCode() 和 compareTo() 方法有影响。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-23T21:11:27.507

一个非常小的改进可能是保存您正在计算的双精度值，以便您仅在第一次访问时计算它。除非您经常访问此号码，否则这不会是一个很大的胜利，但这也不是太难做到。

另外一点可能是您在分母中进行的错误检查...您会自动将 0 更改为 1。不确定这是否适用于您的特定应用程序，但一般来说，如果有人试图除以 0，则说明有些错误. 我会让它抛出一个异常（如果你觉得需要它是一个专门的异常），而不是以用户不知道的看似任意的方式更改值。

与其他一些评论相反，关于添加方法来添加减法等等......因为你没有提到需要它们，我假设你不需要。除非您正在构建一个真正将在许多地方或其他人使用的库，否则请使用 YAGNI（您不会需要它，所以它不应该在那里。）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-23T21:15:28.730

有几种方法可以改进这个或任何值类型：

*   使您的类[不可变](http://en.wikipedia.org/wiki/Immutable_object)，包括使分子和分母最终化
*   自动[将分数转换为规范形式](http://en.wikipedia.org/wiki/Greatest_common_divisor)，例如 2/4 -> 1/2
*   实现 toString()
*   实现“public static Fraction valueOf(String s)”将字符串转换为分数。实现类似的工厂方法从 int、double 等转换。
*   实现加法、乘法等
*   从整数添加构造函数
*   覆盖等于/hashCode
*   考虑使 Fraction 成为一个接口，并根据需要切换到 BigInteger
*   [考虑对Number](http://java.sun.com/javase/6/docs/api/java/lang/Number.html)进行子分类
*   考虑为常见值（如 0 和 1）包含命名常量
*   考虑使其可序列化
*   测试除以零
*   记录您的 API

基本上，看看其他值类的 API，比如[Double](http://java.sun.com/javase/6/docs/api/java/lang/Double.html)， Integer 并做他们所做的事情:)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-23T21:19:19.190

如果您将一个分数的分子和分母与另一个分数的分母相乘，反之亦然，您最终会得到两个分母相同的分数（仍然是相同的值），您可以直接比较分子。因此，您不需要计算双精度值：

```
public int compareTo(Fraction frac) {
    int t = this.numerator * frac.getDenominator();
    int f = frac.getNumerator() * this.denominator;
    if(t>f) return 1;
    if(f>t) return -1;
    return 0;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-23T21:14:58.747

我将如何改进该代码：

1.  基于 String Fraction(String s) //expect "number/number" 的构造函数
2.  一个拷贝构造函数Fraction(Fraction copy)
3.  覆盖克隆方法
4.  实现 equals、toString 和 hashcode 方法
5.  实现接口 java.io.Serializable, Comparable
6.  一种方法“双 getDoubleValue()”
7.  方法加/除/等...
8.  我会将该类设置为不可变的（没有设置器）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-23T22:15:09.797

你已经有一个 compareTo 函数......我会实现 Comparable 接口。

不过，无论您要使用它做什么，都可能并不重要。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-23T22:50:48.243

如果您喜欢冒险，请查看**[JScience](http://jscience.org/)**。它有一个[`Rational`](http://jscience.org/api/org/jscience/mathematics/number/Rational.html)表示分数的类。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-03T20:37:35.387

> **具体来说**：有没有更好的方法来处理通过零分母？将分母设置为 1 感觉非常随意。我怎样才能做到这一点？

我会说抛出一个除以零的 ArithmeticException，因为这确实是正在发生的事情：

```
public Fraction(int numerator, int denominator) {
    if(denominator == 0)
        throw new ArithmeticException("Divide by zero.");
    this.numerator = numerator;
    this.denominator = denominator;
} 
```

您可能想让消息说“除以零：分数的分母为零”，而不是“除以零”。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-23T21:12:21.217

创建分数对象后，为什么要允许其他对象设置分子或分母？我认为这些应该是只读的。它使对象不可变...

另外...将分母设置为零应该抛出一个无效的参数异常（我不知道它在 Java 中是什么）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-23T21:22:05.440

Timothy Budd 在他的“C++ 中的数据结构”中很好地实现了 Rational 类。当然，不同的语言，但它很好地移植到 Java。

我会推荐更多的构造函数。默认构造函数的分子为 0，分母为 1。单个 arg 构造函数将假定分母为 1。想想你的用户如何使用这个类。

不检查零分母？按合同编程会让你添加它。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-23T21:57:47.523

我将第三或第五或任何使您的分数不可变的建议。我还建议你让它扩展[Number](http://java.sun.com/javase/6/docs/api/java/lang/Number.html)类。我可能会查看[Double](http://java.sun.com/javase/6/docs/api/java/lang/Double.html)类，因为您可能想要实现许多相同的方法。

您可能还应该实现[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)和[Serializable](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)，因为可能会出现这种行为。因此，您将需要实现 compareTo()。你还需要重写equals()，我不能强调你也重写hashCode()。这可能是少数情况之一，尽管您不希望 compareTo() 和 equals() 保持一致，因为可归约的分数不一定相等。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-24T04:00:51.470

我喜欢的一种清理做法是只有一次回报。

```
 public int compareTo(Fraction frac) {
        int result = 0
        double t = this.doubleValue();
        double f = frac.doubleValue();
        if(t>f) 
           result = 1;
        else if(f>t) 
           result -1;
        return result;
    } 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-04T18:16:46.857

使用[JScience](http://www.jscience.org)库中的 Rational 类。这是我在 Java 中看到的小数运算的最佳选择。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-02-24T07:46:25.520

我清理了[cletus 的答案](https://stackoverflow.com/a/474577/14731)：

*   为所有方法添加了 Javadoc。
*   添加了对方法前提条件的检查。
*   `valueOf(String)`用`BigInteger(String)`更灵活和更快的替换自定义解析。

```
import com.google.common.base.Splitter;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.math.RoundingMode;
import java.util.List;
import java.util.Objects;
import org.bitbucket.cowwoc.preconditions.Preconditions;

/**
 * A rational fraction, represented by {@code numerator / denominator}.
 * <p>
 * This implementation is based on <a
 * href="https://stackoverflow.com/a/474577/14731">https://stackoverflow.com/a/474577/14731</a>
 * <p>
 * @author Gili Tzabari
 */
public final class BigRational extends Number implements Comparable<BigRational>
{
    private static final long serialVersionUID = 0L;
    public static final BigRational ZERO = new BigRational(BigInteger.ZERO, BigInteger.ONE);
    public static final BigRational ONE = new BigRational(BigInteger.ONE, BigInteger.ONE);

    /**
     * Ensures the fraction the denominator is positive and optionally divides the numerator and
     * denominator by the greatest common factor.
     * <p>
     * @param numerator   a numerator
     * @param denominator a denominator
     * @param checkGcd    true if the numerator and denominator should be divided by the greatest
     *                    common factor
     * @return the canonical representation of the rational fraction
     */
    private static BigRational canonical(BigInteger numerator, BigInteger denominator,
        boolean checkGcd)
    {
        assert (numerator != null);
        assert (denominator != null);
        if (denominator.signum() == 0)
            throw new IllegalArgumentException("denominator is zero");
        if (numerator.signum() == 0)
            return ZERO;
        BigInteger newNumerator = numerator;
        BigInteger newDenominator = denominator;
        if (newDenominator.signum() < 0)
        {
            newNumerator = newNumerator.negate();
            newDenominator = newDenominator.negate();
        }
        if (checkGcd)
        {
            BigInteger gcd = newNumerator.gcd(newDenominator);
            if (!gcd.equals(BigInteger.ONE))
            {
                newNumerator = newNumerator.divide(gcd);
                newDenominator = newDenominator.divide(gcd);
            }
        }
        return new BigRational(newNumerator, newDenominator);
    }

    /**
     * @param numerator   a numerator
     * @param denominator a denominator
     * @return a BigRational having value {@code numerator / denominator}
     * @throws NullPointerException if numerator or denominator are null
     */
    public static BigRational valueOf(BigInteger numerator, BigInteger denominator)
    {
        Preconditions.requireThat(numerator, "numerator").isNotNull();
        Preconditions.requireThat(denominator, "denominator").isNotNull();
        return canonical(numerator, denominator, true);
    }

    /**
     * @param numerator   a numerator
     * @param denominator a denominator
     * @return a BigRational having value {@code numerator / denominator}
     */
    public static BigRational valueOf(long numerator, long denominator)
    {
        BigInteger bigNumerator = BigInteger.valueOf(numerator);
        BigInteger bigDenominator = BigInteger.valueOf(denominator);
        return canonical(bigNumerator, bigDenominator, true);
    }

    /**
     * @param value the parameter value
     * @param name  the parameter name
     * @return the BigInteger representation of the parameter
     * @throws NumberFormatException if value is not a valid representation of BigInteger
     */
    private static BigInteger requireBigInteger(String value, String name)
        throws NumberFormatException
    {
        try
        {
            return new BigInteger(value);
        }
        catch (NumberFormatException e)
        {
            throw (NumberFormatException) new NumberFormatException("Invalid " + name + ": " + value).
                initCause(e);
        }
    }

    /**
     * @param numerator   a numerator
     * @param denominator a denominator
     * @return a BigRational having value {@code numerator / denominator}
     * @throws NullPointerException     if numerator or denominator are null
     * @throws IllegalArgumentException if numerator or denominator are empty
     * @throws NumberFormatException    if numerator or denominator are not a valid representation of
     *                                  BigDecimal
     */
    public static BigRational valueOf(String numerator, String denominator)
        throws NullPointerException, IllegalArgumentException, NumberFormatException
    {
        Preconditions.requireThat(numerator, "numerator").isNotNull().isNotEmpty();
        Preconditions.requireThat(denominator, "denominator").isNotNull().isNotEmpty();
        BigInteger bigNumerator = requireBigInteger(numerator, "numerator");
        BigInteger bigDenominator = requireBigInteger(denominator, "denominator");
        return canonical(bigNumerator, bigDenominator, true);
    }

    /**
     * @param value a string representation of a rational fraction (e.g. "12.34e5" or "3/4")
     * @return a BigRational representation of the String
     * @throws NullPointerException     if value is null
     * @throws IllegalArgumentException if value is empty
     * @throws NumberFormatException    if numerator or denominator are not a valid representation of
     *                                  BigDecimal
     */
    public static BigRational valueOf(String value)
        throws NullPointerException, IllegalArgumentException, NumberFormatException
    {
        Preconditions.requireThat(value, "value").isNotNull().isNotEmpty();
        List<String> fractionParts = Splitter.on('/').splitToList(value);
        if (fractionParts.size() == 1)
            return valueOfRational(value);
        if (fractionParts.size() == 2)
            return BigRational.valueOf(fractionParts.get(0), fractionParts.get(1));
        throw new IllegalArgumentException("Too many slashes: " + value);
    }

    /**
     * @param value a string representation of a rational fraction (e.g. "12.34e5")
     * @return a BigRational representation of the String
     * @throws NullPointerException     if value is null
     * @throws IllegalArgumentException if value is empty
     * @throws NumberFormatException    if numerator or denominator are not a valid representation of
     *                                  BigDecimal
     */
    private static BigRational valueOfRational(String value)
        throws NullPointerException, IllegalArgumentException, NumberFormatException
    {
        Preconditions.requireThat(value, "value").isNotNull().isNotEmpty();
        BigDecimal bigDecimal = new BigDecimal(value);
        int scale = bigDecimal.scale();
        BigInteger numerator = bigDecimal.unscaledValue();
        BigInteger denominator;
        if (scale > 0)
            denominator = BigInteger.TEN.pow(scale);
        else
        {
            numerator = numerator.multiply(BigInteger.TEN.pow(-scale));
            denominator = BigInteger.ONE;
        }

        return canonical(numerator, denominator, true);
    }

    private final BigInteger numerator;
    private final BigInteger denominator;

    /**
     * @param numerator   the numerator
     * @param denominator the denominator
     * @throws NullPointerException if numerator or denominator are null
     */
    private BigRational(BigInteger numerator, BigInteger denominator)
    {
        Preconditions.requireThat(numerator, "numerator").isNotNull();
        Preconditions.requireThat(denominator, "denominator").isNotNull();
        this.numerator = numerator;
        this.denominator = denominator;
    }

    /**
     * @return the numerator
     */
    public BigInteger getNumerator()
    {
        return numerator;
    }

    /**
     * @return the denominator
     */
    public BigInteger getDenominator()
    {
        return denominator;
    }

    @Override
    @SuppressWarnings("AccessingNonPublicFieldOfAnotherObject")
    public int compareTo(BigRational other)
    {
        Preconditions.requireThat(other, "other").isNotNull();

        // canonical() ensures denominator is positive
        if (numerator.signum() != other.numerator.signum())
            return numerator.signum() - other.numerator.signum();

        // Set the denominator to a common multiple before comparing the numerators
        BigInteger first = numerator.multiply(other.denominator);
        BigInteger second = other.numerator.multiply(denominator);
        return first.compareTo(second);
    }

    /**
     * @param other another rational fraction
     * @return the result of adding this object to {@code other}
     * @throws NullPointerException if other is null
     */
    @SuppressWarnings("AccessingNonPublicFieldOfAnotherObject")
    public BigRational add(BigRational other)
    {
        Preconditions.requireThat(other, "other").isNotNull();
        if (other.numerator.signum() == 0)
            return this;
        if (numerator.signum() == 0)
            return other;
        if (denominator.equals(other.denominator))
            return new BigRational(numerator.add(other.numerator), denominator);
        return canonical(numerator.multiply(other.denominator).
            add(other.numerator.multiply(denominator)),
            denominator.multiply(other.denominator), true);
    }

    /**
     * @param other another rational fraction
     * @return the result of subtracting {@code other} from this object
     * @throws NullPointerException if other is null
     */
    @SuppressWarnings("AccessingNonPublicFieldOfAnotherObject")
    public BigRational subtract(BigRational other)
    {
        return add(other.negate());
    }

    /**
     * @param other another rational fraction
     * @return the result of multiplying this object by {@code other}
     * @throws NullPointerException if other is null
     */
    @SuppressWarnings("AccessingNonPublicFieldOfAnotherObject")
    public BigRational multiply(BigRational other)
    {
        Preconditions.requireThat(other, "other").isNotNull();
        if (numerator.signum() == 0 || other.numerator.signum() == 0)
            return ZERO;
        if (numerator.equals(other.denominator))
            return canonical(other.numerator, denominator, true);
        if (other.numerator.equals(denominator))
            return canonical(numerator, other.denominator, true);
        if (numerator.negate().equals(other.denominator))
            return canonical(other.numerator.negate(), denominator, true);
        if (other.numerator.negate().equals(denominator))
            return canonical(numerator.negate(), other.denominator, true);
        return canonical(numerator.multiply(other.numerator), denominator.multiply(other.denominator),
            true);
    }

    /**
     * @param other another rational fraction
     * @return the result of dividing this object by {@code other}
     * @throws NullPointerException if other is null
     */
    public BigRational divide(BigRational other)
    {
        return multiply(other.invert());
    }

    /**
     * @return true if the object is a whole number
     */
    public boolean isInteger()
    {
        return numerator.signum() == 0 || denominator.equals(BigInteger.ONE);
    }

    /**
     * Returns a BigRational whose value is (-this).
     * <p>
     * @return -this
     */
    public BigRational negate()
    {
        return new BigRational(numerator.negate(), denominator);
    }

    /**
     * @return a rational fraction with the numerator and denominator swapped
     */
    public BigRational invert()
    {
        return canonical(denominator, numerator, false);
    }

    /**
     * @return the absolute value of this {@code BigRational}
     */
    public BigRational abs()
    {
        if (numerator.signum() < 0)
            return negate();
        return this;
    }

    /**
     * @param exponent exponent to which both numerator and denominator is to be raised.
     * @return a BigRational whose value is (this<sup>exponent</sup>).
     */
    public BigRational pow(int exponent)
    {
        return canonical(numerator.pow(exponent), denominator.pow(exponent), true);
    }

    /**
     * @param other another rational fraction
     * @return the minimum of this object and the other fraction
     */
    public BigRational min(BigRational other)
    {
        if (compareTo(other) <= 0)
            return this;
        return other;
    }

    /**
     * @param other another rational fraction
     * @return the maximum of this object and the other fraction
     */
    public BigRational max(BigRational other)
    {
        if (compareTo(other) >= 0)
            return this;
        return other;
    }

    /**
     * @param scale        scale of the BigDecimal quotient to be returned
     * @param roundingMode the rounding mode to apply
     * @return a BigDecimal representation of this object
     * @throws NullPointerException if roundingMode is null
     */
    public BigDecimal toBigDecimal(int scale, RoundingMode roundingMode)
    {
        Preconditions.requireThat(roundingMode, "roundingMode").isNotNull();
        if (isInteger())
            return new BigDecimal(numerator);
        return new BigDecimal(numerator).divide(new BigDecimal(denominator), scale, roundingMode);
    }

    @Override
    public int intValue()
    {
        return (int) longValue();
    }

    @Override
    public long longValue()
    {
        if (isInteger())
            return numerator.longValue();
        return numerator.divide(denominator).longValue();
    }

    @Override
    public float floatValue()
    {
        return (float) doubleValue();
    }

    @Override
    public double doubleValue()
    {
        if (isInteger())
            return numerator.doubleValue();
        return numerator.doubleValue() / denominator.doubleValue();
    }

    @Override
    @SuppressWarnings("AccessingNonPublicFieldOfAnotherObject")
    public boolean equals(Object o)
    {
        if (this == o)
            return true;
        if (!(o instanceof BigRational))
            return false;
        BigRational other = (BigRational) o;

        return numerator.equals(other.denominator) && Objects.equals(denominator, other.denominator);
    }

    @Override
    public int hashCode()
    {
        return Objects.hash(numerator, denominator);
    }

    /**
     * Returns the String representation: {@code numerator / denominator}.
     */
    @Override
    public String toString()
    {
        if (isInteger())
            return String.format("%,d", numerator);
        return String.format("%,d / %,d", numerator, denominator);
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-23T21:56:09.007

初步评论：

永远不要这样写：

```
if ( condition ) statement; 
```

这好多了

```
if ( condition ) { statement }; 
```

只是为了创造一个好习惯而创造。

通过按照建议使类不可变，您还可以利用 double 来执行 equals 和 hashCode 和 compareTo 操作

这是我的快速脏版本：

```
public final class Fraction implements Comparable {

    private final int numerator;
    private final int denominator;
    private final Double internal;

    public static Fraction createFraction( int numerator, int denominator ) { 
        return new Fraction( numerator, denominator );
    }

    private Fraction(int numerator, int denominator) {
        this.numerator   = numerator;
        this.denominator = denominator;
        this.internal = ((double) numerator)/((double) denominator);
    }

    public int getNumerator() {
        return this.numerator;
    }

    public int getDenominator() {
        return this.denominator;
    }

    private double doubleValue() {
        return internal;
    }

    public int compareTo( Object o ) {
        if ( o instanceof Fraction ) { 
            return internal.compareTo( ((Fraction)o).internal );
        }
        return 1;
    }

    public boolean equals( Object o ) {
          if ( o instanceof Fraction ) {  
             return this.internal.equals( ((Fraction)o).internal );
          } 
          return false;
    }

    public int hashCode() { 
        return internal.hashCode();
    }

    public String toString() { 
        return String.format("%d/%d", numerator, denominator );
    }

    public static void main( String [] args ) { 
        System.out.println( Fraction.createFraction( 1 , 2 ) ) ;
        System.out.println( Fraction.createFraction( 1 , 2 ).hashCode() ) ;
        System.out.println( Fraction.createFraction( 1 , 2 ).compareTo( Fraction.createFraction(2,4) ) ) ;
        System.out.println( Fraction.createFraction( 1 , 2 ).equals( Fraction.createFraction(4,8) ) ) ;
        System.out.println( Fraction.createFraction( 3 , 9 ).equals( Fraction.createFraction(1,3) ) ) ;
    }       

} 
```

关于静态工厂方法，如果您将 Fraction 子类化以处理更复杂的事情，或者如果您决定为最常用的对象使用池，它可能在以后很有用。

可能不是这样，我只是想指出这一点。:)

请参阅[Effective Java](http://java.sun.com/docs/books/effective/toc.html)第一项。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-10-28T10:15:47.137

可能有助于添加简单的事情，例如互惠、获得余数和获得整体。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-04-26T17:18:12.340

即使你有 compareTo() 方法，如果你想使用 Collections.sort() 之类的实用程序，那么你也应该实现 Comparable。

```
public class Fraction extends Number implements Comparable<Fraction> {
 ...
} 
```

此外，为了漂亮的显示，我建议覆盖 toString()

```
public String toString() {
    return this.getNumerator() + "/" + this.getDenominator();
} 
```

最后，我将公开该类，以便您可以从不同的包中使用它。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-03-21T17:10:03.900

这个函数使用欧几里德算法简化在定义分数时非常有用

```
 public Fraction simplify(){

     int safe;
     int h= Math.max(numerator, denominator);
     int h2 = Math.min(denominator, numerator);

     if (h == 0){

         return new Fraction(1,1);
     }

     while (h>h2 && h2>0){

          h = h - h2;
          if (h>h2){

              safe = h;
              h = h2;
              h2 = safe;

          }  

     }

  return new Fraction(numerator/h,denominator/h);

 } 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-01-07T11:51:55.223

对于工业级分数/有理实现，我将实现它，以便它可以表示 NaN、正无穷大、负无穷大和可选的负零，其操作语义与浮点算术的 IEEE 754 标准状态完全相同（它还简化了与浮点值之间的转换）。另外，由于与零、一和上面的特殊值的比较只需要简单，但分子和分母与 0 和 1 的组合比较 - 我会添加几个 isXXX 和 compareToXXX 方法以方便使用（例如 eq0() 将在幕后使用 numerator == 0 && denominator != 0 而不是让客户端与零值实例进行比较）。一些静态预定义的值（ZERO、ONE、TWO、TEN、ONE_TENTH、NAN 等）也很有用，因为它们作为常数值出现在几个地方。这是恕我直言的最佳方式。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-02-05T17:27:47.047

班级分数：

```
 public class Fraction {
        private int num;            // numerator 
        private int denom;          // denominator 
        // default constructor
        public Fraction() {}
        // constructor
        public Fraction( int a, int b ) {
            num = a;
            if ( b == 0 )
                throw new ZeroDenomException();
            else
                denom = b;
        }
        // return string representation of ComplexNumber
        @Override
        public String toString() {
            return "( " + num + " / " + denom + " )";
        }
        // the addition operation
        public Fraction add(Fraction x){
            return new Fraction(
                    x.num * denom + x.denom * num, x.denom * denom );
        }
        // the multiplication operation
        public Fraction multiply(Fraction x) {
            return new Fraction(x.num * num, x.denom * denom);
        } 
} 
```

主程序：

```
 static void main(String[] args){
    Scanner input = new Scanner(System.in);
    System.out.println("Enter numerator and denominator of first fraction");
    int num1 =input.nextInt();
    int denom1 =input.nextInt();
    Fraction x = new Fraction(num1, denom1);
    System.out.println("Enter numerator and denominator of second fraction");
    int num2 =input.nextInt();
    int denom2 =input.nextInt();
    Fraction y = new Fraction(num2, denom2);
    Fraction result = new Fraction();
    System.out.println("Enter required operation: A (Add), M (Multiply)");
    char op = input.next().charAt(0);
    if(op == 'A') {
        result = x.add(y);
        System.out.println(x + " + " + y + " = " + result);
    } 
```

# linux - 我可以在linux中恢复一个我不小心做了“rm”的文件吗？

> ID：474547
> 
> 赞同：4
> 
> 时间：2009-01-23T21:10:13.127
> 
> 标签：linux, recovery, file-recovery

你知道我恢复意外删除的文件的任何工具/命令吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T21:18:14.763

*   不要在分区上做任何事情；按原样卸载它；
*   安装[TestDisk](http://en.wikipedia.org/wiki/TestDisk)套件，或从安装了恢复套件的实时发行版引导（请参阅 TestDisk 维基百科页面）；
*   我发现[PhotoRec](http://en.wikipedia.org/wiki/PhotoRec)实用程序在类似情况下非常有用（它在 VFAT 分区上，但我想它也适用于 ext2）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:18:32.673

它有多重要？你可以，但它使用取证方法。这意味着您需要卸载驱动器，以只读方式重新安装它，然后使用 Helix 之类的东西在驱动器上雕刻以恢复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T21:20:06.740

很抱歉在这里遇到您的麻烦 - 我会开始寻找文件恢复实用程序，但不要让您抱有希望。

您使用的是 ext3 文件系统吗？如果是这样，那么即使是文件恢复实用程序也无济于事——[这里有一些关于 ext3 的信息](http://batleth.sapienti-sat.org/projects/FAQs/ext3-faq.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T21:17:32.143

你不能。抱歉，但重点是它已被永久删除†。鉴于您要问这个问题，您可能没有安装[safe-rm 之](http://freshmeat.net/releases/287577/)类的东西。

† 有点儿。如果没有取证恢复工具，那么可以。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T21:22:19.030

最好与您的 SA 讨论恢复备份的问题。

如果做不到这一点，你很可能不走运。

# gridview - GridView .DataBind RowDataBound 未触发

> ID：474549
> 
> 赞同：2
> 
> 时间：2009-01-23T21:10:24.280
> 
> 标签：gridview, data-binding

我希望有人能帮帮忙！我有一个具有 gridview 的用户控件（UC 中有一个更新面板）

我在 2 个不同的页面上使用这个 UC - 在两个页面上，UC 都在一个选项卡（ajax tabpanel）上，该选项卡位于更新面板内。

在 1 页上，当我使用 .DataBind() （不是初始加载）时，它会触发 RowDataBound 事件并且网格正确完成。

但是在第二页（相同的代码！！），.DataBind 不会触发 RowDataBound 事件，并且数据源未绑定/刷新。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-25T21:52:42.857

RowDataBound 事件仅在回发期间 GridView 的数据发生更改时触发。该事件是为了速度而短路的，因此它不会不必要地重新生成完全相同的数据。改用 RowCreated 事件来操作 HTML - 无论数据是否已更改，它都会在每次回发时触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:35:17.037

首先检查您是否启用了缓存（在服务器上）。我还将使用断点来跟踪应用程序是否完全进入 Page_Load 事件。

如果启用缓存，浏览器将缓存而不使用 Page_Load，因此不使用 DataBind()。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T07:02:53.547

我已经通过放置代码行解决了

```
(TabContainer1_ActiveTabChanged(TabContainer1, null);) 
```

在`Page_Load`事件中，不在 `!IsPostback`事件中

```
protected void Page_Load(object sender, EventArgs e)
    Page.Title = ConfigurationManager.AppSettings["PageTitle"].ToString().Trim() + " Project Type";

    if (!IsPostBack)
    {
        if (Request.Params["stidx"] != null && Request.Params["stidx"].ToString().Trim() != "")
        {
            if (Request.Params["stidx"].ToString().Trim() == "0")   //have to make project type selected in left
            {
                NullAllDate_Except_ProjectType();

                TabContainer1.ActiveTabIndex = 0;

                LeftBar.var_data_to_show = "";
            }
            else if (Request.Params["stidx"].ToString().Trim() == "1")   //have to make Modules selected in left
            {
                NullAllDate_Except_Module();

                TabContainer1.ActiveTabIndex = 1;

                LeftBar.var_data_to_show = "";
            }
            else if (Request.Params["stidx"].ToString().Trim() == "2")   //have to make Activity selected in left
            {
                NullAllDate_Except_Activity();

                TabContainer1.ActiveTabIndex = 2;

                LeftBar.var_data_to_show = "";
            }
            else if (Request.Params["stidx"].ToString().Trim() == "3")   //have to make Systems selected in left
            {
                NullAllDate_Except_Systems();

                TabContainer1.ActiveTabIndex = 3;

                LeftBar.var_data_to_show = "";
            }
            else if (Request.Params["stidx"].ToString().Trim() == "4")   //have to make Module Headers selected in left
            {
                NullAllDate_Except_ModuleHeaders();

                TabContainer1.ActiveTabIndex = 4;

                LeftBar.var_data_to_show = "";
            }
            else
            {
                NullAllDate_Except_ProjectType();

                LeftBar.var_data_to_show = "";
            }
        }
        else
        {
            NullAllDate_Except_ProjectType();

            LeftBar.var_data_to_show = "";
        }

    }

    if (IsPostBack)
    {
        if (MyScriptManager.IsInAsyncPostBack)
        {
            //LeftBar.var_data_to_show = true;
            LeftBar.var_data_to_show = GetModuleName(TabContainer1.ActiveTabIndex.ToString());
        }
    }

    TabContainer1_ActiveTabChanged(TabContainer1, null);    //this is required here, otherwise onrow databound is not working on !Postback
} 
```

# c# - 异常消息应该存储在哪里

> ID：474564
> 
> 赞同：13
> 
> 时间：2009-01-23T21:12:56.397
> 
> 标签：c#, exception, resources

由于我不能以 Microsoft 作为最佳实践的示例，因为它们的异常消息是出于必要而存储在资源文件中的，所以我不得不问应该将异常消息存储在哪里。

我想这可能是我想到的常见地点之一

*   默认资源文件
*   局部常数
*   类常量
*   全局异常消息类
*   内联为字符串文字

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T21:16:42.020

我可能会为此被枪杀（好吧，被否决），但为什么不“在哪里创建异常”？

```
throw new InvalidDataException("A wurble can't follow a flurble"); 
```

除非您要将异常消息国际化（[我建议您不要](https://stackoverflow.com/questions/474450/should-exception-messages-be-globalized#474468)），否则您是否特别需要它们成为常量等？好处在哪里？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T22:38:13.760

如果您的异常是强类型的，则无需担心消息。消息用于向用户呈现错误，异常用于在异常情况下控制流程。

```
throw new InvalidOperationException("The Nacho Ordering system is not responding."); 
```

可能成为

```
throw new SystemNotRespondingException("Nacho Ordering"); 
```

在后一种情况下，没有什么可翻译的，因此无需担心本地化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:15:57.530

迫不得已？这是为了简化本地化。要本地化应用程序中的错误消息，这是一个很好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T21:28:48.517

如果您不打算向用户显示异常消息，那么您需要将它们与您需要翻译的资源字符串分开。

如果您有很多重复的字符串，请使用 Jon 建议的字符串文字，或者创建一个实用程序类来保存它们。

# c# - 运行多个服务主机的性能损失？

> ID：474571
> 
> 赞同：2
> 
> 时间：2009-01-23T21:14:12.727
> 
> 标签：c#, .net, wcf, performance

从这个问题开始：

[使用多个合同运行 WCF ServiceHost](https://stackoverflow.com/questions/334472/run-wcf-servicehost-with-multiple-contracts)

如答案之一中所建议的那样，运行多个服务主机是否有任何性能损失？

我正在考虑实施一个具有 4-5 个服务合同的解决方案，并且可以将一个实施合同的类定义为 chilltemp 的建议，或者按照 Chris Porter 的建议运行 4-5 个服务主机，每个服务主机托管一个服务合同。

我宁愿运行多个服务主机以获得更大的灵活性，但我想知道启动这些主机是否有任何性能损失？

提前致谢，
威尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T21:17:07.183

你是如何招待他们的？IIS？视窗服务？控制台应用程序？在几乎所有情况下，一旦服务启动，您将不会看到将它们作为一项服务运行或将它们作为独立服务运行之间有太大的性能差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:28:02.513

我能看到的唯一优势是一个或多个合同是否有需要大量处理时间的操作。然后将其分成自己的服务将允许您在单独的机器上托管该服务。将它们全部托管在同一台机器上似乎不会比将所有合同都放在一个服务中产生更好的结果。

尽管如果合同不是非常相关和/或以某种方式相互耦合，那么将其拆分为多个服务是一个好主意。这样，您将获得更好的可重用性。

# windows - 我在哪里可以了解各种可用的源代码控制系统的优缺点？

> ID：474573
> 
> 赞同：4
> 
> 时间：2009-01-23T21:14:21.760
> 
> 标签：windows, version-control

我想比较和对比各种源代码控制系统。有什么好的参考吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T21:17:27.433

Eric Raymond 的《理解版本控制系统》：http: [//www.catb.org/esr/writings/version-control/version-control.html](http://www.catb.org/esr/writings/version-control/version-control.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T21:19:42.700

Linux 版本控制系统：http: [//linuxmafia.com/faq/Apps/vcs.html](http://linuxmafia.com/faq/Apps/vcs.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T21:18:19.460

一些 python 核心开发人员最近开始整理一份[文档，说明各种工作流程](http://www.python.org/dev/peps/pep-0374/)，比较和对比使用 hg、bzr、git 和 svn 的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T21:20:37.783

以下是众多 SCM 的比较：http: [//better-scm.berlios.de/comparison/comparison.html](http://better-scm.berlios.de/comparison/comparison.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T22:37:17.833

您可能需要一个理论框架来比较它们。它显示大多数产品比较（尤其是命名链接中的那些）相当不完整。对此有一个 5 维模型：

*   版本（想要更改）
*   状态（生命周期：创建、测试、部署、退役）
*   视图（源、架构、部署、可推导）
*   层次结构（模块、类、方法）
*   变体（非常相似，描述差异，产品系列）

大多数系统只处理其中的几个维度。要处理所有这五个问题，您必须描述（修复）您的开发过程。

参考资料：

管理设计数据：CAD框架、配置管理、产品数据管理五个维度。van den Hamer，P. Lepoeter，K.
Philips Res.，埃因霍温；

本文发表于： IEEE 出版日期： 1996 年 1 月卷： 84，期数： 1 页数： 42-56 ISSN： 0018-9219 引用的参考文献： 26 代码： IEEPAD INSPEC 登录号： 5175049 数字对象标识符: 10.1109/5.476025 当前版本发布时间: 2002-08-06

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T00:53:24.703

维基百科对此有一篇很好的[文章](http://en.wikipedia.org/wiki/Comparison_of_revision_control_software)：

# asp.net - ASP.NET：如何从 javascript 访问转发器生成的元素？

> ID：474584
> 
> 赞同：7
> 
> 时间：2009-01-23T21:16:24.563
> 
> 标签：asp.net, ajax

我有一系列使用**asp:repeater**生成的行：

```
<asp:repeater ID="itemsRepeater" 
      OnItemDataBound="itemsRepeater_ItemDataBound" 
      runat="Server">
   <itemtemplate>
      <tr>
         <td>
            <asp:HyperLink ID="linkView" runat="server"
               Text="<%# GetItemText((Item)Container.DataItem) %>" 
               NavigateUrl="<%# GetViewItemUrl((Item)Container.DataItem) %>" />
         </td>
         <td>
            <asp:HyperLink ID="linkDelete" runat="server"
                Text="Delete"
                NavigateUrl="<%# GetDeleteUrl((ActionItem)Container.DataItem) %>" />
         </td>
      </tr>
   </itemtemplate>
</asp:repeater> 
```

转发器创建一个 HTML 表，每一行都包含一个项目的链接和（本质上是）一个“删除”链接。上面的简化示例代码生成的 HTML 类似于：

```
<TR>
<TD>
   <A href="ViewItem.aspx?ItemGuid={19a149db-5675-4eee-835d-3d78372ca6f9}">
      AllisonAngle_SoccerGirl001.jpg
   </A>
</TD>
<TD>
   <A href="DeleteItem.aspx?ItemGuid={19a149db-5675-4eee-835d-3d78372ca6f9}">Delete</A>
</TD>
</TR> 
```

现在一切正常，但我想将“删除”转换为客户端。我希望能够单击该链接，它将在客户端 javascript 上：

*   提示警报“您确定...”
*   让 javascript 发出服务器命中以实际删除他们想要的项目
*   从客户端 DOM 树中删除项目

所以有四个问题需要解决：

1.  如何将 javascript 连接到**删除**链接的客户端单击。
2.  如何知道用户点击了哪些项目**删除**
3.  防止回发
4.  删除用户点击的行

那是我的问题。

从这里你会发现我漫无目的的尝试来解决它。不要将以下任何内容视为与任何可能接受的解决方案有任何关系。仅仅因为我在下面发布了代码，并不意味着它是有用的。这并不意味着我在最佳解决方案的距离之内。而且因为我不能做任何低于工作的东西——它一定走错了路。

* * *

## 我的尝试

**连接 Javascript**

第一个任务是将删除链接 HTML 从以下内容转换：

```
<A href="DeleteItem.aspx?ItemGuid={19a149db-5675-4eee-835d-3d78372ca6f9}">
   Delete
</A> 
```

变成更javascripty的东西：

```
<A href="#" 
      onclick="DeleteItem('DeleteItem.aspx?ItemGuid={19a149db-5675-4eee-835d-3d78372ca6f9}')">
   Delete
</A> 
```

并添加脚本：

```
<script type="text/javascript">
   //<![CDATA[
       function DeleteItem(deleteUrl)   
       {   
          //Ask the user if they really want to
          if (!confirm("Are you sure you want to delete INSERT NAME HERE?"))
          {
             return false;
          }

          //Call returns false if the server returned anything other than OK
          if (!DoAjaxHit(deleteUrl)
          {
             return false;
          }

          //Remove the table row from the browser
          var tableRow = document.getElementById("TODO-WHAT ID");
          if (row != null)
          {
             //TODO: how to delete the tableRow from the DOM tree?
             //document.Delete(tableRow) ?
          }

          //return false to prevent a postback
          return false;
       }
   //]]>
</script> 
```

可以使用什么 ASP 代码组合来创建上述内容？我听说**asp:LinkBut​​ton**有一个**OnClientClick**事件，您可以在其中连接一个 javascript 函数：

```
<asp:LinkButton ID="linkDelete" runat="server"
   Text="Delete"
   OnClientClick="DeleteItem(<%# GetDeleteUrl((ActionItem)Container.DataItem) %>);"/> 
```

问题是呈现的 HTML 从字面上包含：

```
<a onclick="DeleteItem(&lt;%# GetDeleteUrl((ActionItem)Container.DataItem)) %>);" ...>
   Delete
</a> 
```

如果我将客户端单击事件处理程序更改为：

```
 OnClientClick="DeleteItem('todo - figure this out');"/> 
```

它可以工作 - 以及“待办事项 - 解决这个问题”可以工作。

* * *

**防止回发**

上面的 javascript 调用实际上发生了（我可以看到我的警报），但还有下一个问题：从 javascript 函数返回 false 不会阻止回发。事实上，我可以看到生成的html代码上的*href*不是“#”，而是

```
javascript:__doPostBack('ctl0.... 
```

我尝试更改 ASPX 代码以包括我自己的 OnClick 处理程序：

```
 OnClick="#"
   OnClientClick="DeleteItem('todo - figure this out');" 
```

但是编译器认为磅侧是一个编译指示，并抱怨：

> 预处理器指令必须作为行上的第一个非空白字符出现

* * *

**表行标识**

表行没有 ID，它们由**asp:repeater**生成。

javascript函数如何知道是什么触发了点击事件？javascript 需要能够找到元素，并将其从树中删除。

**注意：**我当然更喜欢淡入淡出+折叠动画。

通常你通过使用获得一个元素

```
var tr = document.getElementById("the table row's id"); 
```

但是表行没有容易知道的 ID。由于存在多行，因此服务器在构建表时会生成 ID。我意识到一些解决方案将不得不涉及改变：

```
<TR> 
```

进入

```
<TR runat="server"> 
```

这样每个表行都会有服务器生成的标识，但是我如何从 javsscript 引用生成的名称？

通常我会认为脚本问题可以通过使用多个参数来解决：

```
function DeleteItem(tableRowElement, deleteUrl)
{
   //Do a web-hit of deleteUrl to delete the item

   //remove tableRowElement DOM object from the document tree
} 
```

但是问题只是被推到了其他地方：如何填充 tableRowElement 和 deleteUrl 以调用 javascript 函数？

* * *

这样一个简单的问题：将点击从回发转换为客户端。

所涉及的问题数量变得非常愚蠢。这似乎表明

*   想法解决方案是完全不同的
*   没有解决办法

* * *

## 参考

[Stackoverflow：如何在回发之前淡出一行？](https://stackoverflow.com/questions/183179/how-do-i-fade-a-row-out-before-postback)

[Stackoverflow：asp之前的Javascript：ButtonField点击](https://stackoverflow.com/questions/218733/javascript-before-aspbuttonfield-click)

[asp.net：从 javascript 访问中继器元素。](http://forums.asp.net/p/1116342/1733360.aspx)

[Stackoverflow：如何访问中继器生成的元素？](https://stackoverflow.com/questions/480195/asp-net-how-to-access-repeater-generated-elements)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T21:38:36.907

[jQuery](http://docs.jquery.com/)可以为你挖掘出标签：

```
$("[id$=linkDelete]").click(function() {
    DeleteItem(this.href);
}); 
```

该代码表示​​“查找 ID 以 'linkDelete' 结尾的所有 DOM 元素并连接以下单击事件处理程序”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T22:12:57.913

我建议不要以这种方式通过链接实现删除功能。[删除链接存在安全风险。](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx)

相反，最好要求在该网址上发布帖子。如果您想做 ajax，我强烈建议您使用 javascript 框架，这样您就不必处理不同浏览器如何实现 XmlHttpRequests 的差异。

例如，在 jQuery 中你可以这样做：

```
$.post('Delete.aspx',{itemGuid:'{19a149db-5675-4eee-835d-3d78372ca6f9}'},
    function(data, textStatus) {
        if (textStatus == 'success') {
            $(this).parents('tr:eq(0)').fadeOut();
        }
    }); 
```

这将执行您想要的 ajax 调用*和淡出效果。*

然后，您可以从 Request.Form["itemGuid"] 访问 Delete.aspx 中的项目 guid，这样就不容易受到链接攻击。

**防止回发**

服务器正在生成回发连接，因为您使用的是服务器控件。使用`<a>`没有 runat='server' 指令的普通标签。

**表行标识**

我通常通过对某种 ID 列进行数据绑定并将其放入转发器模板中来做到这一点：

```
<tr id='<%#Eval("ID")%>'> 
```

PS 我讨厌听起来像个狂热分子，但是 jQuery 将使所有这些事情变得容易一个数量级。如果可以的话，你真的应该考虑一下。否则，您将在尝试以一致的方式跨浏览器实现这些功能时陷入痛苦的境地。

PPS 如果仅从 javascript 调用 Delete.aspx 和类似的 url，我建议改用 ashx http 处理程序。您可以执行所有相同的服务器逻辑，而无需完整页面的不必要开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T01:54:16.313

我的通常看起来像

```
<asp:LinkButton runat="server" OnClientClick='<%# Eval("ID", "DeleteItem(this, \"{0}\"); return false;") %>' Text="Delete" /> 
```

这将使html看起来像

```
<a id="blah_blah_ctl01" onclick='DeleteItem(this, "{19a149db-5675-4eee-835d-3d78372ca6f9}"); return false;'>Delete</a> 
```

我包含“this”引用，以便您可以访问 dom 并删除链接......或者它是父级或其他。从那里使用 jQuery 来实际进行发布和 DOM 操作非常简单。“返回错误；” 禁用回发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T19:25:35.077

其他回答者发现了与问题的不同方面相关的各种位。我设法拼凑出一个完整的解决方案。我在这里复制/粘贴了相关的片段。

第一个重要的变化是使用**asp:LinkBut​​ton**允许作为**OnClientClick**事件，它使您可以直接访问 javascript **OnClick**事件：

```
<asp:repeater ID="itemsRepeater"
      OnItemDataBound="itemsRepeater_ItemDataBound"
      runat="Server">
   <itemtemplate>
      <tr>         
         <td>
            <asp:HyperLink ID="linkView" runat="server"
               Text="<%# GetItemText((Item)Container.DataItem) %>"
               NavigateUrl="<%# GetViewItemUrl((Item)Container.DataItem) %>" />
         </td>
         <td>
            <asp:LinkButton ID="linkImpregnate" runat="server"
                   Text="Impregnate"
                   OnClientClick="<%# GetImpregnateUrl((Item)Container.DataItem) %>" />
         </td>
      </tr>
   </itemtemplate>
</asp:repeater> 
```

代码隐藏手动构建包含 javascript 调用的演示代码（是的，控制器和视图的分离！）。

```
protected string GetNodeAcknowledgementClientClick(Item item)
{
   if (!(item is HotGirl))
      return ""; //this shouldn't be called for non-acknowledgements, but i won't fail

   HotGirl girl = (HotGirl)item;

   String szOnClientClick =
         "return ImpregnateGirl(this, "+
               Toolkit.QuotedStr(girl.GirlGUID.ToString()) + ", "+
               Toolkit.QuotedStr(GetItemName(item))+");";

   return szOnClientClick;
} 
```

最后在 aspx 中，我找到了一个随机点来混入一些 javascript：

```
<script type="text/javascript" src="Javascript/jquery.js"></script>  
<script type="text/javascript">
   //<![CDATA[
   function DeleteItem(sender, girlGuid, girlName)   
   {
      if (!confirm("Are you sure you want to impregnate "+girlName+"?"))
      {
         return false;
      }

      $.post(
         'ImpregnateGirl.aspx?GirlGUID='+nodeGuid,
               function(data, textStatus) {
                  if (textStatus == 'success') 
                  {
                     $(sender).parents('tr:eq(0)').hide();
                  }
                  else
                  {
                     return false;
                  }
               }
      );

      //return false to suppress the postback
      return false;
   }
//]]>
</script> 
```

我会让 jQuery 做一个帖子，作为一个安全措施，就像家伙建议的那样，但是 jQuery 会给出一个错误，而不是发布。而不是关心，我选择不关心。

# sql - 您正在等待哪些 SQL 改进？

> ID：474591
> 
> 赞同：15
> 
> 时间：2009-01-23T21:18:09.600
> 
> 标签：sql

处理 SQL 向我们展示了一些限制，并让我们有机会想象可能会发生什么。

您还在等待对 SQL 的哪些改进？你会把哪个放在愿望清单的顶部？

我认为如果您在答案中发布您的功能请求缺少的数据库会很好。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-23T21:30:04.507

特定于 T-SQL：从存储过程返回的结果集中进行选择的一种不错的方式，它不涉及将其放入临时表或使用某些晦涩的函数。

```
SELECT * FROM EXEC [master].[dbo].[xp_readerrorlog] 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-05T22:35:39.763

我知道这是非常不切实际的，但我希望他们能使 INSERT 和 UPDATE 的语法保持一致。谈论无缘无故的非正交性。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-26T15:09:55.540

管理日期（或数字）范围的操作员：

```
where interval(date0, date1) intersects interval(date3, date4) 
```

编辑：日期或数字，当然是相同的。

编辑 2：Oracle 似乎有一些事情要做，未记录的 OVERLAPS 谓词。更多信息[在这里](http://www.orafaq.com/node/2067)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-23T21:20:21.310

一种使用分层数据遍历树的体面方式。Oracle 具有[`CONNECT BY`](http://www.adp-gmbh.ch/ora/sql/connect_by.html)存储对象的简单而通用的结构，并且很难以自然的方式查询“父”表的自引用连接。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-23T21:27:24.137

比 SQL 更多的 SQL Server，但更好地与源代码管理集成。最好是 SVN 而不是 VSS。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-23T22:52:05.073

隐式连接或它应该被称为什么（即绑定到表定义的预定义视图）

> 从客户 C 中选择客户 ID、总和（C.ORDERS.LINES.VALUE）

重新设计整个 GROUP BY 事物，这样 SELECT 子句中的每个表达式都不必在 GROUP BY 子句中重复

一些支持 let 表达式或其他更合法的地方使用别名，有点与 GROUP BY 的事情有关，但我发现其他时候我只是讨厌 Oracle 强迫我使用外部选择只是通过别名引用一个大表达式.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-05T22:13:26.203

我想看看在字符串处理中使用正则表达式的能力。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-23T21:55:12.927

一种动态指定列/表的方法，无需求助于在另一个上下文中执行的完整动态 sql。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-05T22:54:41.830

我希望供应商真正标准化他们的 SQL。他们都有罪。MySQL 和 PostGresql 中的`LIMIT/OFFSET`子句是一个很好的解决方案，其他人似乎都没有这样做。Oracle 有自己的显式`JOIN`s 语法，而其他所有人都使用 ANSI-92。MySQL 应该像其他人一样弃用该`CONCAT()`函数并使用`||`它。并且有许多超出标准的条款和陈述可以更广泛地传播。MySQL`REPLACE`就是一个很好的例子。还有更多，关于转换和比较类型、列类型的怪癖、序列等的问题等等。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-05T22:59:56.657

参数化顺序，如：

```
 select * from tableA order by @columName 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-26T20:13:38.003

能够无限地基于其他列定义列（包括消歧）。

这是一个人为的例子，而不是真实世界的案例，但我想你会看到我要去哪里：

```
SELECT LTRIM(t1.a) AS [a.new]
    ,REPLICATE(' ', 20 - LEN([a.new])) + [a.new] AS [a.conformed]
    ,LEN([a.conformed]) as [a.length]
FROM t1
INNER JOIN TABLE t2
    ON [a.new] = t2.a
ORDER BY [a.new] 
```

代替：

```
SELECT LTRIM(t1.a) AS [a.new]
    ,REPLICATE(' ', 20 - LEN(LTRIM(t1.a))) + LTRIM(t1.a) AS [a.conformed]
    ,LEN(REPLICATE(' ', 20 - LEN(LTRIM(t1.a))) + LTRIM(t1.a)) as [a.length]
FROM t1
INNER JOIN TABLE t2
    ON LTRIM(t1.a) = t2.a
ORDER BY LTRIM(t1.a) 
```

现在，在 SQL Server 2005 及更高版本中，我将使用 CTE 并在连续的层中进行构建。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-23T21:58:52.153

自动反规范化。

但我可能在做梦。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-23T21:35:30.093

在 SQL 中支持指定是否希望优化查询计划以快速返回第一行或所有行。

Oracle 有 FIRST_ROWS 提示的概念，但语言中的标准方法会很有用。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-05T22:54:29.570

PostgreSQL 中的 UPSERT 或 MERGE。这是一个让我难以置信的功能。Postgres 拥有其他一切。为什么他们不能一起行动并实施它，即使是有限的形式？

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-23T22:47:05.020

改进的数据透视表。我想告诉它根据在数据中找到的键自动创建列。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-12T17:48:53.273

`WITH`子句用于除 之外的其他语句`SELECT`，它表示 for`UPDATE`和`DELETE`。

例如：

```
WITH table as (
  SELECT ...
)
DELETE from table2 where not exists (SELECT ...) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-14T00:03:43.697

使用子查询检查约束，我的意思是：

```
CHECK ( 1 > (SELECT COUNT(*) FROM TABLE WHERE A = COLUMN)) 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-05T22:33:09.127

在我的愿望清单上是一个支持 CHECK 约束中的子查询的数据库，而不必依赖[物化视图技巧](http://www.dbazine.com/oracle/or-articles/tropashko8)。还有一个支持 SQL 标准的“断言”的数据库，即可以跨越多个表的约束。

其他：一个与元数据相关的函数，如果可能值的集合很低，它将返回给定列的可能值。即，如果一列具有指向另一列的外键，它将返回被引用列中的现有值。如果该列具有像“CHECK foo IN(1,2,3)”这样的 CHECK 约束，它将返回 1,2,3。这将使基于表模式创建 GUI 元素变得更加容易：如果函数返回两个值的列表，程序员可以决定单选按钮小部件是相关的 - 或者如果函数返回 - 例如 - 10 个值，则应用程序显示了一个下拉小部件。等等。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-03-19T21:48:39.670

关系代数 DIVIDE 运算符。我讨厌总是不得不重新考虑如何处理表 A 中**所有**从表 B 中给出的**所有**元素。

 **[http://www.tc.umn.edu/~hause011/code/SQLexample.txt](http://www.tc.umn.edu/~hause011/code/SQLexample.txt)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-27T00:53:01.183

这些都是特定于 MS Sql Server/T-SQL 的：

1.  “自然”连接基于现有的外键关系。
2.  轻松使用存储的 proc 结果作为结果集
3.  除了 while 之外的其他一些循环结构
4.  跨非 NULL 值的唯一约束
5.  EXCEPT、IN、ALL 子句代替 LEFT|RIGHT JOIN WHERE x IS [NOT] NULL
6.  模式绑定存储过程（以简化#2）
7.  跨多个数据库的关系、模式绑定视图等

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-03-19T00:08:31.317

我称之为 REFERENCE JOIN 的东西。它通过隐式使用它们之间的 FOREIGN KEY...REFERENCES 约束将两个表连接在一起。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-05T22:49:10.063

更多 OOP 功能：

*   存储过程和用户​​函数

    CREATE PROCEDURE tablename.spname (params) AS ...

通过调用

```
EXECUTE spname
FROM tablename
WHERE conditions
ORDER BY 
```

它隐式地将游标或当前记录传递给 SP。（类似于插入和删除的伪表）

*   具有继承的表定义

从基表派生的表定义，继承公共列等

顺便说一句，这不一定是真正的 OOP，而只是现有技术的语法糖，但它会大大简化开发。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-05T22:49:48.750

抽象表和子分类

```
create abstract table person
  (
  id primary key,
   name varchar(50)
  );

create table concretePerson extends person
  (
  birth date,
  death date
  );

create table fictionalCharacter  extends person
  (
  creator int references concretePerson.id      
  ); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-03-03T21:25:32.557

检查约束的注释。使用此功能，应用程序（或引发错误时的数据库本身）可以查询元数据并检索该评论以将其显示给用户。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-03-19T21:16:48.107

如果优化器生成的计划与测试查询所用的计划不同，则自动通知 dba。

换句话说，可以注册每个查询。那时，计划就保存下来了。稍后在执行查询时，如果计划发生更改，dba 会收到通知，表明发生了意外情况。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-02-09T22:29:34.713

**数组**

我不确定是什么阻碍了这一点，但缺少数组会导致临时表和相关的混乱。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-02-05T23:06:56.690

增加了 Sql Server 中的时态数据库支持。间隔、重叠等

增加了 Sql Server 中的 OVER 支持，包括 LAG、LEAD 和 TOP。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-03-19T21:39:15.323

1) [左 | RIGHT] SEMI JOIN 和 [LEFT | RIGHT] ANTI JOIN 这些可以让我写出类似的东西

```
-- return customers who have placed at least one order
SELECT c.*
  FROM Customers c
  LEFT SEMI JOIN o ON o.CustomerId = c.Id

-- return customers who have NOT placed any order
SELECT c.*
  FROM Customers c
  LEFT ANTI JOIN o ON o.CustomerId = c.Id 
```

这将具有完全相同的结果

```
SELECT c.*
  FROM Customers c
 WHERE c.Id IN(SELECT CustomerId FROM Orders) 
```

和

```
SELECT c.*
  FROM Customers c
 WHERE c.Id NOT IN(SELECT CustomerId FROM Orders) 
```

， 分别。但是，IN（或几乎等效的 EXISTS）语法比我建议的语法要混乱得多，尤其是在更复杂的情况下。

当然，不能引用半/反连接表，所以这是非法的：

```
-- Error, can't reference semi joined table.
SELECT c.*, o.OrderNumber
  FROM Customers c
  LEFT SEMI JOIN o ON o.CustomerId = c.Id 
```

2）有一个好的解决方案会很好

```
WHERE Column IN('a', 'b', 'c') 
```

当您不知道要搜索的值的数量时出现问题。也许可以允许

```
WHERE Column IN(ARRAY @array) 
```

并且调用代码会将@array 绑定到一个数组。

编辑：我又想到了一个

3) 约束系统的某种可扩展性，它允许在并发环境中完美工作的表之间对约束进行编码，并且允许我手动执行任何锁定和验证以确保始终满足约束。目前可以使用触发器，但考虑到并发性，它们很难正确使用。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-01-26T15:46:21.070

Group by 上的字符串聚合（在 Oracle 中可以使用这个[技巧](http://www.oracle-base.com/articles/10g/StringAggregationTechniques.php)）：

```
SELECT deptno, string_agg(ename) AS employees
FROM   emp
GROUP BY deptno;

DEPTNO EMPLOYEES
---------- --------------------------------------------------
    10 CLARK,KING,MILLER
    20 SMITH,FORD,ADAMS,SCOTT,JONES
    30 ALLEN,BLAKE,MARTIN,TURNER,JAMES,WARD 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2009-02-20T23:02:34.647

某种 UPGRADE 表允许对**表进行更改，使其类似于给定的**：

```
CREATE OR UPGRADE TABLE 
( 
  a VARCHAR,
  ---
) 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-02-27T00:39:36.627

我的愿望清单（用于 SQLServer）

1.  能够同时存储/使用存储过程的多个执行计划，并让系统自动了解每次执行时使用的最佳存储计划。

目前有一个计划 - 如果它不再是最佳的，无论如何都会使用它，或者计算一个全新的计划来代替它。

2.  原生 UTF-8 存储

3.  具有多个备用服务器的数据库镜像以及使用接近“简单”的恢复模型的能力当然前提是所有服务器都已启动并且事务随处提交。

4.  替换功能中的 PCRE

5.  重用大型 sql 查询片段、存储匹配条件、选择条件等的一些巧妙方法。类似于函数，但实际上实现更像预处理器宏。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-02-05T22:36:37.797

类似于 LINQ 的功能集成到 SQL :-)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-02-05T22:51:55.517

在递归表上选择：

```
 select * from rdfClass where rdfClass.uri is instance of "foaf:Person"; 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-02-05T22:52:16.813

不再有记录大小/命令长度限制。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-07-16T20:47:22.780

MACRO SQL EXPRESSIONS

For instance:

```
SELECT *
  FROM X
 WHERE MACRO_1(A, B, C) 
```

Where MACRO_1 can be something like:

```
A*2/B+C 
```

or something like:

```
A=2 OR B<C 
```

MACRO_1 is not a function, it's just a macro to be preprocessed and substituted before the final parsing.

They are like functions but because are substituted the optimizer can take advantage of indexes, not like funcions that the optimizer does not know what happens.

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-03-19T21:03:14.553

CreateOrAlter 命令。

我厌倦了在“Create Proc”和“Alter Proc”之间来回切换。我不在乎它是创建还是更改，我只希望最终结果是我放入程序主体的内容。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-01-28T00:27:01.593

为那些不支持它们的平台高效实现 SQL 标准，例如 DOMAIN。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-01-23T22:08:27.080

执行最佳执行计划的干净方法。

MSSQL 和 Oracle 中有提示，但是您需要*说服*DBMS 使用它们，它们可以被默默地忽略，这被引用为特性，而不是文档中的错误。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-01-28T00:06:18.423

管理其他表上的间隔日期的外键

例如，对于表：

```
TABLE_A(begin DATE, end DATE)
TABLE_B(day DATE) 
```

一些定义 On 的方法`TABLE_B`：

```
FOREIGN KEY (day)
  REFERENCES INTERVAL ON TABLE_A (begin, endd) 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-02-05T22:08:36.760

部分Foreing键约束。

如果有这些表：

```
create table prova_a (a number, b number);
alter table prova_a add primary key (a,b);
create table prova_b (a number, b number);
alter table prova_b add foreign key (a,b) references prova_a(a,b) ;
insert into prova_a  values (1,2); 
```

您可以插入它而不会出错：

```
insert into prova_b  values (123,null);
insert into prova_b  values (null,null);
insert into prova_b  values (null,123); 
```

我希望在不使用检查约束的情况下避免这种情况。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-02-05T23:24:48.103

SQL Server 特定：

一些不错的日期函数，例如 TRUNC。改进全文搜索（更好地控制匹配逻辑）

如果 SQL 服务器可以在同一个数据库和日志文件（共享文件组）中存储不同的数据库，我会喜欢它，这样我就可以一次性备份整个服务器。

编译存储过程时的完整语法和错误检查（不仅在运行时）

是的，这听起来像是“我希望 SQL Server 中的所有 Oracle 功能都没有复杂性（和成本！）”

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-02-05T23:37:32.273

我很想看到在创建索引时放置 WHERE 子句的能力：

```
CREATE INDEX BAR ON FOO (FooName, FooId) WHERE FooEnabled = 1; 
```

然后，优化器可以在处理 SQL 时使用它，如下所示：

```
SELECT FooId, FooName
FROM Foo
WHERE FooEnabled = 1
ORDER BY FooName; 
```

从索引创建和优化器的角度来看，这似乎是一个可以解决的问题。实际上，您可以使用基于函数的索引和/或物化视图来模拟相同的事情。这很麻烦，可能涉及更改应用程序发出的 SQL。

上面有一个语法糖会很好。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-02-05T23:05:12.153

凯文领先我几秒钟……但更一般地说，

```
select @columnName from @tableName
order by @otherColumnName 
```

ETC

它会呈现大量令人讨厌的字符串连接，然后

```
exec (@sql) 
```

立即不必要。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-01-26T20:07:53.583

优化 QBE（按示例查询）。最后为我们提供了一种方法，可以将所有想要匹配任意列子集的查询的责任转嫁给数据库。

* * *

编辑：QBE 是一种用于查询关系数据的非 SQL 方法。将它添加到 SQL 可能看起来像

从表中选择列
WHERE 示例（名字、姓氏、生日）=（'Fred%'、'Jones'、'20090209'）

在功能上支持类似于 Access 为图形 querydef 设计器提供的功能。您给它一个字段列表，并收集一组匹配的用户输入，优化器将丢弃未指定的列并优化其余列。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-03-19T00:11:28.953

嵌套聚合函数。

PostgreSQL 不允许类似 SELECT MAX(COUNT(*))...

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-07-13T23:16:00.130

计算列。

能够根据另一个表达式在表上添加列，而无需创建视图。

# ssl - 如何为 IIS 6 创建自签名通配符 SSL 证书？

> ID：474609
> 
> 赞同：5
> 
> 时间：2009-01-23T21:21:21.230
> 
> 标签：ssl, iis-6, wildcard, self-signed

我正在尝试创建一个自签名通配符 SSL 证书，以在运行 IIS 6 的许多开发和测试服务器上使用。遵循各种指南导致了几种生成证书的方法，但我没有任何运气它工作。我最成功的方法是遵循[这个 OpenSSL 指南](http://beyondintegration.blogspot.com/2008/06/self-signed-certificates-how-to-get.html)并像这样使用 makecert.exe：

```
makecert.exe -r -b 01/01/2009 -e 01/01/2042 -sr LocalMachine -ss MY -a sha1 -n CN="*.example.com" -sky exchange -pe -eku 1.3.6.1.5.5.7.3.1 -sy 12 -sp "Microsoft RSA SChannel Cryptographic Provider" wildcard.cer 
```

两者都会生成 IIS 6 将接受的证书，但是当我实际尝试查看该站点时，我在 firefox 中收到以下错误：

> ## 数据传输中断
> 
> 页面加载时与 dev.example.com 的连接中断。

IE 只是给出：

> ## Internet Explorer无法显示该网页
> 
> 最可能的原因：
> 
> *   您没有连接到 Internet。
> *   网站遇到问题。
> *   地址可能有输入错误。

无论我尝试通过域名、机器名、本地主机、本地 ip 还是环回 ip 访问它，都会发生此错误。

那么...如何创建 IIS 6 可以使用的自签名通配符证书？或者我该如何解决我已经创建的问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T02:37:56.233

您可以使用 MS 提供的 IIS 6 Resource Kit，这是一个名为 SelfSSL 的命令行应用程序。它可以生成 SSL 密钥并将其导入到您的 IIS 安装中。

[IIS 6 资源工具包](http://www.microsoft.com/downloads/details.aspx?FamilyId=56FC92EE-A71A-4C73-B628-ADE629C89499&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T20:17:03.177

you can do a wildcard certificate with *.domain.local and multiple ssl protocols by using the c:\inetpub\adminscripts adsutil.vbs set w3svc[siteid]\SecureBindings ":443:name.domain.local"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:25:34.530

您是否意识到您需要从“example.com”更改为更适合您的情况的内容（“localhost”可能是测试期间其中之一）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T21:30:01.103

对于 IIS 7 - 有一个 wzard 可以做到这一点。设置大约需要 30 秒。

对于 IIS 6 - 这有点棘手。设置大约需要 30 分钟。

你用的是哪一个？

我强烈建议迁移到 IIS 7 - 一开始它很陌生，但他们已经做了很多改进。

鉴于您可能无法升级到 IIS 7，我必须执行以下操作才能在 IIS 6 中实现您想要的功能。

1) 创建证书服务器 2) 生成请求 3) 授予请求 4) 安装证书

设置证书颁发机构服务器有点麻烦，但它与 Windows Server 一起提供，并且演练非常简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-21T19:09:18.357

我们发现证书颁发机构由于域设置而不受信任并导致错误。我们最终部署了由受信任的 CA 生成的星级证书，从而解决了问题。

# language-agnostic - 我应该如何重构我的代码以删除不必要的单例？

> ID：474613
> 
> 赞同：20
> 
> 时间：2009-01-23T21:21:48.767
> 
> 标签：language-agnostic, refactoring, singleton

当我第一次开始看到反单身的评论时，我很困惑。我在最近的一些项目中使用了单例模式，并且效果很好。这么多，事实上，我已经用过很多次了。

现在，在遇到一些问题后，阅读[了这个](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)SO 问题，尤其是[这篇](http://steve.yegge.googlepages.com/singleton-considered-stupid)博文，我明白了我给这个世界带来的邪恶。

那么：如何从现有代码中*删除单例？*

例如：
在一个零售店管理程序中，我使用了 MVC 模式。我的模型对象描述了商店，用户界面是视图，我有一组控制器作为两者之间的联系。伟大的。除了我把 Store 变成了一个单例（因为应用程序一次只管理一个商店），我还把我的大部分 Controller 类变成了单例（一个 mainWindow、一个 menuBar、一个 productEditor...）。现在，我的大部分 Controller 类都可以像这样访问其他单例：

```
Store managedStore = Store::getInstance();
managedStore.doSomething();
managedStore.doSomethingElse();
//etc. 
```

我应该改为：

1.  为每个对象创建一个实例并将引用传递给需要访问它们的每个对象？
2.  使用全局变量？
3.  还有什么？

Globals 仍然很糟糕，但至少他们不会[假装](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)。

我看到#1 很快导致了可怕的构造函数调用：

```
someVar = SomeControllerClass(managedStore, menuBar, editor, sasquatch, ...) 
```

还有其他人经历过吗？让许多单独的类访问公共变量而不是全局或单例的 OO 方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-23T21:30:38.293

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)是你的朋友。

看看[优秀的谷歌测试博客](http://googletesting.blogspot.com/)上的这些帖子：

*   [单身人士是病态的骗子](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)（但如果你问这个问题，你可能已经明白了）
*   [关于依赖注入的演讲](http://misko.hevery.com/2008/11/11/clean-code-talks-dependency-injection/)
*   [编写可测试代码指南](http://googletesting.blogspot.com/2008/11/guide-to-writing-testable-code.html)

希望有人为 C++ 世界制作了一个 DI 框架/容器？看起来谷歌已经发布了一个[C++ 测试框架](http://code.google.com/p/googletest/)和一个[C++ 模拟框架](http://googletesting.blogspot.com/2008/12/announcing-google-c-mocking-framework.html)，这可能会帮助你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T21:29:12.527

我避免单例的方法源于“应用程序全局”并不意味着“VM 全局”（即`static`）的想法。因此，我介绍了一个`ApplicationContext`包含许多以前的`static`单例信息的类，这些信息应该是应用程序全局的，例如配置存储。该上下文被传递到所有结构中。如果您使用任何 IOC 容器或服务管理器，则可以使用它来访问上下文。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T21:50:16.150

问题不是单例。拥有一个只有一个实例的对象很好。问题是全局访问。您使用 Store 的类应该在构造函数中接收一个 Store 实例（或具有可以设置的 Store 属性/数据成员），并且它们都可以接收相同的实例。Store 甚至可以在其中保留逻辑以确保只创建一个实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T16:51:38.960

在程序中使用全局或单例没有任何问题。不要让任何人对这种废话持教条主义的态度。规则和模式是很好的经验法则。但归根结底，这是您的项目，您应该对如何处理涉及全局数据的情况做出自己的判断。

无限制地使用全局变量是个坏消息。但只要你勤奋，他们就不会扼杀你的项目。系统中的某些对象应该是单例的。标准输入和输出。您的日志系统。在游戏中，您的图形、声音和输入子系统，以及游戏实体的数据库。在 GUI 中，您的窗口和主要面板组件。你的配置数据，你的插件管理器，你的网络服务器数据。所有这些东西或多或少对您的应用程序来说都是全局性的。我认为您的 Store 课程也会通过它。

很清楚使用全局变量的成本是多少。您的应用程序的任何部分都可以修改它。当每一行代码都是调查中的嫌疑人时，很难追踪错误。

但是不使用全局变量的成本呢？就像编程中的其他一切一样，这是一种权衡。如果你避免使用全局变量，你最终不得不将这些有状态的对象作为函数参数传递。或者，您可以将它们传递给构造函数并将它们保存为成员变量。当你有多个这样的对象时，情况会变得更糟。您现在正在**线程化**您的状态。在某些情况下，这不是问题。如果您知道只有两个或三个函数需要处理有状态的 Store 对象，那么这是更好的解决方案。

但在实践中，情况并非总是如此。如果您的应用程序的每个部分都触及您的商店，您将把它线程化到十几个函数中。最重要的是，其中一些功能可能具有复杂的业务逻辑。当你用辅助函数分解业务逻辑时，你必须——多线程化你的状态！例如，您意识到一个深度嵌套的函数需要来自 Store 对象的一些配置数据。突然，您必须编辑 3 或 4 个函数声明以包含该存储参数。然后，您必须返回并将 store 作为实际参数添加到调用这些函数之一的任何地方。函数对 Store 的唯一用途可能是将其传递给需要它的子函数。

模式只是经验法则。在您的汽车变道之前，您是否**总是**使用转向信号灯？如果你是普通人，你通常会遵守规则，但如果你在凌晨 4 点在空旷的高速公路上开车，谁在乎，对吧？有时它会咬你一口，但这是可控的风险。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T21:36:42.447

关于膨胀的构造函数调用问题，您可以引入参数类或工厂方法来为您解决这个问题。

*参数类*将一些参数数据移动到它自己的类中，例如：

```
var parameterClass1 = new MenuParameter(menuBar, editor);
var parameterClass2 = new StuffParameters(sasquatch, ...);

var ctrl = new MyControllerClass(managedStore, parameterClass1, parameterClass2); 
```

不过，它只是将问题转移到其他地方。您可能想要对您的构造函数进行管家处理。仅保留在构造/启动相关类时重要的参数，其余的使用 getter/setter 方法（如果您正在使用 .NET，则使用属性）。

*工厂方法*是一种创建您需要的类的所有实例并具有封装所述对象的创建的好处的方法。它们也很容易从 Singleton 重构，因为它们类似于您在 Singleton 模式中看到的 getInstance 方法。假设我们有以下非线程安全的简单单例示例：

```
// The Rather Unfortunate Singleton Class
public class SingletonStore {
    private static SingletonStore _singleton
        = new MyUnfortunateSingleton();

    private SingletonStore() {
        // Do some privatised constructing in here...
    }

    public static SingletonStore getInstance() {
        return _singleton;
    }  

    // Some methods and stuff to be down here
}

// Usage: 
// var singleInstanceOfStore = SingletonStore.getInstance(); 
```

很容易将其重构为工厂方法。解决方案是删除静态引用：

```
public class StoreWithFactory {

    public StoreWithFactory() {
        // If the constructor is private or public doesn't matter
        // unless you do TDD, in which you need to have a public 
        // constructor to create the object so you can test it.
    }

    // The method returning an instance of Singleton is now a
    // factory method. 
    public static StoreWithFactory getInstance() {
        return new StoreWithFactory(); 
    }
}

// Usage:
// var myStore = StoreWithFactory.getInstance(); 
```

用法仍然相同，但您不会因拥有单个实例而陷入困境。自然地，您会将这个工厂方法移到它自己的类中，因为`Store`该类不应该关心自己的创建（并且巧合地遵循单一责任原则作为将工厂方法移出的效果）。

从这里你有很多选择，但我会把它留给你自己练习。这里很容易对模式进行过度设计（或过热）。我的建议是仅在[需要](https://stackoverflow.com/questions/449731/design-patterns-to-avoid#449753)时应用模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T21:32:30.880

好吧，首先，“单身人士总是邪恶的”的观念是错误的。只要您拥有不会或永远不能复制的资源，您就可以使用 Singleton。没问题。

也就是说，在您的示例中，应用程序具有明显的自由度：有人可能会说“但我想要*两个*商店”。

有几种解决方案。首先出现的是建立一个工厂类；当您请求一个 Store 时，它​​会为您提供一个以某个通用名称（例如，URI）命名的 Store。在该 Store 中，您需要确保多个副本不会通过关键区域或某种方法相互叠加确保事务的原子性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T21:33:51.020

[Miško Hevery](http://misko.hevery.com "米什科·赫弗里")有一篇关于可测试性的不错的文章系列，其中包括[单例](http://misko.hevery.com/code-reviewers-guide/flaw-brittle-global-state-singletons/)，他不仅在讨论问题，而且还讨论了如何解决它（请参阅“修复缺陷”）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-23T23:04:44.767

我喜欢鼓励在必要时使用单例，同时不鼓励使用单例模式。注意单词大小写的区别。单例（小写）用于只需要一个实例的地方。它在程序开始时创建，并传递给需要它的类的构造函数。

```
class Log
{
  void logmessage(...)
  { // do some stuff
  }
};

int main()
{
  Log log;

  // do some more stuff
}

class Database
{
  Log &_log;
  Database(Log &log) : _log(log) {}
  void Open(...)
  {
    _log.logmessage(whatever);
  }
}; 
```

使用单例提供了单例反模式的所有功能，但它使您的代码更容易扩展，并且使其可测试（在 Google 测试博客中定义的词的意义上）。例如，我们可能决定在某些时候也需要登录到 Web 服务的能力，使用单例我们可以轻松地做到这一点，而无需对代码进行重大更改。

相比之下，单例模式是全局变量的另一个名称。它从不在生产代码中使用。

# c# - 图形输入板/手写笔库

> ID：474643
> 
> 赞同：1
> 
> 时间：2009-01-23T21:28:55.240
> 
> 标签：c#, .net, input

有谁知道任何允许您使用图形输入板的 .net 库？

特别是我追求笔的压力敏感度，但笔上的“橡皮擦”和按钮也很有用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T08:11:11.330

我还发现 WPF 也有一个`InkCanvas`，它内置了所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:29:56.703

查看[Paint.NET的源代码](http://getpaint.net)

**编辑**：那里也应该有一个DLL...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-12T23:33:55.620

[http://sourceforge.net/projects/vbtablet/](http://sourceforge.net/projects/vbtablet/) 它对我有用。至少有一段时间。现在我遇到了一些问题，并试图找到另一个问题。如果我的搜索失败，我将直接使用 Windows API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-14T08:57:40.417

Microsoft 的 RealTimeStylus API 允许访问所有笔/触笔数据。

# .net - 您可以在 .net 2.0 winforms 应用程序中使用 basicHttpBinding 调用 WCF 吗？

> ID：474651
> 
> 赞同：0
> 
> 时间：2009-01-23T21:30:37.610
> 
> 标签：.net, wcf

据我所知，basichttpbinding 向后兼容.net 2.0 对吗？

看来，当您引用 WCF 服务时，API 有所不同。

我的服务使用 SSL，它有一个你必须设置的用户名和密码。

在 .net 2.0 中，API 完全不同，并且存在正确调用端点的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-15T02:52:17.090

WCF 服务存在于 .NET 3.0 和 3.5 框架中。虽然您的服务将在 2.0 运行时中执行（.NET 3.0 和 3.5 只是 2.0 框架的附加层），但只要它序列化易于理解的类型（即可以解析为字符串和整数等基本类型），一切都很好。事实上，Java 客户端可以调用 WCF 服务，因为在线路级别，重要的是符合广泛接受的规范，例如 SOAP 1.1。

从您的 Windows 窗体客户端，您需要使用 wsdl.exe（或使用 Visual Studio 的添加 Web 引用向导）创建对服务的引用。据它所知，它看起来像任何 ASP.NET Web 服务。

现在，使用 basicHttpBinding 并不能确保您的服务与非 WCF 客户端兼容。您还需要确保您坚持使用 DataContractSerializer 或 XmlSerializer。您将希望避免使用 NetDataContractSerializer，因为这需要在服务和客户端上共享类型。并不是说它不能完成，但是您必须确保您的类型在 .NET 2.0 程序集中并且不使用仅在 3.0 或更高版本中可用的功能（例如 System.Core）。

# visual-studio - 如何使用 NHibernate 将 SQL 调用记录到 Visual Studio 的控制台？

> ID：474659
> 
> 赞同：39
> 
> 时间：2009-01-23T21:32:10.833
> 
> 标签：visual-studio, nhibernate, logging, log4net

我有[NHibernate](http://en.wikipedia.org/wiki/NHibernate)的以下配置文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
  <session-factory>
    <property name="connection.connection_string">Server=.\SQLEXPRESS;Database=mydb;Integrated Security=True;</property>
    <property name="dialect">NHibernate.Dialect.MsSql2005Dialect</property>
    <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
    <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
    <property name="connection.release_mode">auto</property>
    <property name="adonet.batch_size">500</property>

    <property name="show_sql">true</property>

  </session-factory>
</hibernate-configuration> 
```

但是 SQL 没有显示在 Visual Studio 的输出窗口中。是否必须安装[log4net](http://en.wikipedia.org/wiki/Apache_log4net)？还是应该`show_sql`单独工作？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-09-01T05:20:09.710

要在 Visual Studio 的输出窗口中显示 SQL，请将 log4net 配置为在 log4net 配置中使用 TraceAppender。这：

```
<appender name="DebugSQL" type="log4net.Appender.TraceAppender">
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
    </layout>
</appender> 
```

然后这个：

```
<logger name="NHibernate.SQL" additivity="false">
    <level value="DEBUG" />
    <appender-ref ref="DebugSQL" />
</logger> 
```

编辑：我似乎无法在这里正确格式化。[有关代码示例，请参见此链接](http://suspendedwithpay.wordpress.com/2009/04/03/displaying-nhibernate-sql-in-visual-studios-output-window/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-01T06:38:00.703

对于那些更喜欢代码而不是配置的人，以下代码片段将使用简单的控制台附加程序创建适当的 NH 记录器。

```
var hierarchy = (Hierarchy) LogManager.GetRepository();
var logger = (Logger) hierarchy.GetLogger("NHibernate.SQL");
logger.AddAppender(new ConsoleAppender {Layout = new SimpleLayout()});
hierarchy.Configured = true; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-24T01:04:09.533

`show_sql`输出到`Console.Out`- 在运行集成测试时最有用

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-24T01:41:47.523

您可以使用一种叫做 NHibernate 分析器的东西。

[http://nhprof.com/](http://nhprof.com/)

它很贵，但它有效，并且有 30 天的试用期。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-09-01T15:59:54.210

从 NHibernate 3.0 开始，您可以使用 loquacious 配置

```
configuration.DataBaseIntegration(x =>
{
  x.LogSqlInConsole = true;
  x.LogFormattedSql = true;
}); 
```

其他信息可在[http://fabiomaulo.blogspot.com.ar/2009/07/nhibernate-configuration-through.html](http://fabiomaulo.blogspot.com.ar/2009/07/nhibernate-configuration-through.html)

# ruby-on-rails - 这个“posts_path”变量在哪里定义？

> ID：474667
> 
> 赞同：4
> 
> 时间：2009-01-23T21:34:22.780
> 
> 标签：ruby-on-rails, ruby, variables

我正在关注Rails 的[本教程](http://guides.rails.info/getting_started_with_rails.html)（看起来不错）。我跑之后

```
ruby script/generate scaffold Post 
```

然后此链接适用于其中一个 erb 文件：

```
<%= link_to "My Blog", posts_path %> 
```

**为什么？**我在整个应用程序中寻找“posts_path”，但无处可寻。另一方面，这

```
<%= link_to "My Blog", home_path %> 
```

不起作用**，**它也是一个控制器。

定义在哪里`posts_path`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-23T21:42:01.127

`posts_path`是您从添加的路线中免费获得的命名路线`script/generate scaffold`。看到`routes.rb`你应该看到这样的东西：

```
map.resources :posts 
```

[有关您免费获得的其他命名路由的信息，](http://api.rubyonrails.org/classes/ActionController/Resources.html)请参阅API 文档。

你也可以跑`rake routes`，看看你`routes.rb`给了你什么。

如果您想要一个名为 route 的 home_path，请在您的`routes.rb`:

```
map.home '/home', :controller => "home", :action => "index" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:42:24.137

我相信“posts_path”是由 Rails 在运行时动态创建的。查看您的 routes.rb 文件 - Home 的定义方式可能与 Posts 不同。它与您的控制器无关，它取决于路由定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T23:06:18.647

`map.root :controller => "home"`将是写入主目录路径的更短方式。这将使用 / 拥有家，而不是 /home。如果您仍想使用 /home（和 home_path），`map.home 'home', :controller => "home"`将做同样的事情。

[Mike Gunderloy 写了](http://guides.rubyonrails.org/routing_outside_in.html)一篇很棒的指南，介绍了有关路由的所有知识。

# .net - 如何为 C++ 和 C# 制作单个测试项目

> ID：474674
> 
> 赞同：0
> 
> 时间：2009-01-23T21:35:55.883
> 
> 标签：.net

我是 .net 方面的新手，但是我正在用两种语言 C++ 和 C# 开发同一个项目；没什么太复杂的，每个项目中只有几个基本相同的类。

现在，我需要为两组代码制作一个单独的测试项目，所以我的问题是如何制作一个项目，很可能是一个控制台项目，我可以在其中包含 c# 类和 c++ 类。

当我运行控制台项目时，我希望能够执行以下操作：

*   C# /s {方法名} | /i {参数}
*   C++ /s {方法名} | /i {参数}

我希望你能明白我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T21:45:52.397

只要 C++ 是完全托管的，您就可以从另一个以任何语言编写的 .NET 程序集调用它。

但是，对于测试，我建议使用[NUnit](http://nunit.org/index.php)或[MbUnit](http://mbunit.com/)之类的测试框架，而不是在控制台应用程序中编写自己的框架。它们将为您提供更强大的测试环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:40:40.117

既然是.NET，你不能只添加一个引用和一个`using`语句，然后有一个“/cpp”或“/csharp”选项吗？

# c# - 捕获控制台退出 C#

> ID：474679
> 
> 赞同：97
> 
> 时间：2009-01-23T21:36:24.103
> 
> 标签：c#, .net, events, console, exit

我有一个包含很多线程的控制台应用程序。有些线程监视某些条件并在它们为真时终止程序。这种终止可以随时发生。

我需要一个可以在程序关闭时触发的事件，以便我可以清理所有其他线程并正确关闭所有文件句柄和连接。我不确定.NET 框架中是否已经内置了一个，所以我在编写自己的框架之前先问一下。

我想知道是否有类似的事件：

```
MyConsoleProgram.OnExit += CleanupBeforeExit; 
```

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-01-23T21:52:03.977

我不确定我在网上哪里找到了代码，但我现在在我的一个旧项目中找到了它。这将允许您在控制台中执行清理代码，例如当它突然关闭或由于关机时......

```
[DllImport("Kernel32")]
private static extern bool SetConsoleCtrlHandler(EventHandler handler, bool add);

private delegate bool EventHandler(CtrlType sig);
static EventHandler _handler;

enum CtrlType
{
  CTRL_C_EVENT = 0,
  CTRL_BREAK_EVENT = 1,
  CTRL_CLOSE_EVENT = 2,
  CTRL_LOGOFF_EVENT = 5,
  CTRL_SHUTDOWN_EVENT = 6
}

private static bool Handler(CtrlType sig)
{
  switch (sig)
  {
      case CtrlType.CTRL_C_EVENT:
      case CtrlType.CTRL_LOGOFF_EVENT:
      case CtrlType.CTRL_SHUTDOWN_EVENT:
      case CtrlType.CTRL_CLOSE_EVENT:
      default:
          return false;
  }
}

static void Main(string[] args)
{
  // Some biolerplate to react to close window event
  _handler += new EventHandler(Handler);
  SetConsoleCtrlHandler(_handler, true);
  ...
} 
```

**更新**

对于那些不检查评论的人来说，这个特定的解决方案似乎在**Windows 7**上（或根本**不**）运行良好。以下[线程](http://social.msdn.microsoft.com/Forums/en/windowscompatibility/thread/abf09824-4e4c-4f2c-ae1e-5981f06c9c6e)讨论了这个

 *** * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-04-10T18:55:48.660

完整的工作示例，使用 ctrl-c，用 X 关闭窗口并杀死：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;

namespace TestTrapCtrlC {
    public class Program {
        static bool exitSystem = false;

        #region Trap application termination
        [DllImport("Kernel32")]
        private static extern bool SetConsoleCtrlHandler(EventHandler handler, bool add);

        private delegate bool EventHandler(CtrlType sig);
        static EventHandler _handler;

        enum CtrlType {
            CTRL_C_EVENT = 0,
            CTRL_BREAK_EVENT = 1,
            CTRL_CLOSE_EVENT = 2,
            CTRL_LOGOFF_EVENT = 5,
            CTRL_SHUTDOWN_EVENT = 6
        }

        private static bool Handler(CtrlType sig) {
            Console.WriteLine("Exiting system due to external CTRL-C, or process kill, or shutdown");

            //do your cleanup here
            Thread.Sleep(5000); //simulate some cleanup delay

            Console.WriteLine("Cleanup complete");

            //allow main to run off
            exitSystem = true;

            //shutdown right away so there are no lingering threads
            Environment.Exit(-1);

            return true;
        }
        #endregion

        static void Main(string[] args) {
            // Some boilerplate to react to close window event, CTRL-C, kill, etc
            _handler += new EventHandler(Handler);
            SetConsoleCtrlHandler(_handler, true);

            //start your multi threaded program here
            Program p = new Program();
            p.Start();

            //hold the console so it doesn’t run off the end
            while (!exitSystem) {
                Thread.Sleep(500);
            }
        }

        public void Start() {
            // start a thread and start doing some processing
            Console.WriteLine("Thread started, processing..");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-25T15:18:42.487

还要检查：

```
AppDomain.CurrentDomain.ProcessExit 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-09-03T07:07:35.120

我遇到了类似的问题，只是我的控制台应用程序将无限循环运行，中间有一个抢先声明。这是我的解决方案：

```
class Program
{
    static int Main(string[] args)
    {
        // Init Code...
        Console.CancelKeyPress += Console_CancelKeyPress;  // Register the function to cancel event

        // I do my stuffs

        while ( true )
        {
            // Code ....
            SomePreemptiveCall();  // The loop stucks here wating function to return
            // Code ...
        }
        return 0;  // Never comes here, but...
    }

    static void Console_CancelKeyPress(object sender, ConsoleCancelEventArgs e)
    {
        Console.WriteLine("Exiting");
        // Termitate what I have to terminate
        Environment.Exit(-1);
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-23T22:36:29.317

听起来您有线程直接终止应用程序？也许最好让一个线程向主线程发出信号，说应用程序应该被终止。

收到这个信号后，主线程可以干净地关闭其他线程并最终关闭自己。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-07-08T13:32:13.467

ZeroKelvin 的答案适用于 Windows 10 x64、.NET 4.6 控制台应用程序。对于那些不需要处理 CtrlType 枚举的人来说，这是一个非常简单的方法来挂钩框架的关闭：

```
class Program
{
    private delegate bool ConsoleCtrlHandlerDelegate(int sig);

    [DllImport("Kernel32")]
    private static extern bool SetConsoleCtrlHandler(ConsoleCtrlHandlerDelegate handler, bool add);

    static ConsoleCtrlHandlerDelegate _consoleCtrlHandler;

    static void Main(string[] args)
    {
        _consoleCtrlHandler += s =>
        {
            //DoCustomShutdownStuff();
            return false;   
        };
        SetConsoleCtrlHandler(_consoleCtrlHandler, true);
    }
} 
```

从处理程序返回 FALSE 告诉框架我们没有“处理”控制信号，并且使用此进程的处理程序列表中的下一个处理程序函数。如果没有任何处理程序返回 TRUE，则调用默认处理程序。

请注意，当用户执行注销或关机时，回调不会被 Windows 调用，而是立即终止。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-23T21:40:58.803

有 WinForms 应用程序；

```
Application.ApplicationExit += CleanupBeforeExit; 
```

对于控制台应用程序，请尝试

```
AppDomain.CurrentDomain.DomainUnload += CleanupBeforeExit; 
```

但我不确定在什么时候调用它，或者它是否会在当前域内工作。我怀疑不是。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-12-31T16:39:24.250

视觉工作室 2015 + Windows 10

*   允许清理
*   单实例应用
*   一些镀金

代码：

```
using System;
using System.Linq;
using System.Runtime.InteropServices;
using System.Threading;

namespace YourNamespace
{
    class Program
    {
        // if you want to allow only one instance otherwise remove the next line
        static Mutex mutex = new Mutex(false, "YOURGUID-YOURGUID-YOURGUID-YO");

        static ManualResetEvent run = new ManualResetEvent(true);

        [DllImport("Kernel32")]
        private static extern bool SetConsoleCtrlHandler(EventHandler handler, bool add);                
        private delegate bool EventHandler(CtrlType sig);
        static EventHandler exitHandler;
        enum CtrlType
        {
            CTRL_C_EVENT = 0,
            CTRL_BREAK_EVENT = 1,
            CTRL_CLOSE_EVENT = 2,
            CTRL_LOGOFF_EVENT = 5,
            CTRL_SHUTDOWN_EVENT = 6
        }
        private static bool ExitHandler(CtrlType sig)
        {
            Console.WriteLine("Shutting down: " + sig.ToString());            
            run.Reset();
            Thread.Sleep(2000);
            return false; // If the function handles the control signal, it should return TRUE. If it returns FALSE, the next handler function in the list of handlers for this process is used (from MSDN).
        }

        static void Main(string[] args)
        {
            // if you want to allow only one instance otherwise remove the next 4 lines
            if (!mutex.WaitOne(TimeSpan.FromSeconds(2), false))
            {
                return; // singleton application already started
            }

            exitHandler += new EventHandler(ExitHandler);
            SetConsoleCtrlHandler(exitHandler, true);

            try
            {
                Console.BackgroundColor = ConsoleColor.Gray;
                Console.ForegroundColor = ConsoleColor.Black;
                Console.Clear();
                Console.SetBufferSize(Console.BufferWidth, 1024);

                Console.Title = "Your Console Title - XYZ";

                // start your threads here
                Thread thread1 = new Thread(new ThreadStart(ThreadFunc1));
                thread1.Start();

                Thread thread2 = new Thread(new ThreadStart(ThreadFunc2));
                thread2.IsBackground = true; // a background thread
                thread2.Start();

                while (run.WaitOne(0))
                {
                    Thread.Sleep(100);
                }

                // do thread syncs here signal them the end so they can clean up or use the manual reset event in them or abort them
                thread1.Abort();
            }
            catch (Exception ex)
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.Write("fail: ");
                Console.ForegroundColor = ConsoleColor.Black;
                Console.WriteLine(ex.Message);
                if (ex.InnerException != null)
                {
                    Console.WriteLine("Inner: " + ex.InnerException.Message);
                }
            }
            finally
            {                
                // do app cleanup here

                // if you want to allow only one instance otherwise remove the next line
                mutex.ReleaseMutex();

                // remove this after testing
                Console.Beep(5000, 100);
            }
        }

        public static void ThreadFunc1()
        {
            Console.Write("> ");
            while ((line = Console.ReadLine()) != null)
            {
                if (line == "command 1")
                {

                }
                else if (line == "command 1")
                {

                }
                else if (line == "?")
                {

                }

                Console.Write("> ");
            }
        }

        public static void ThreadFunc2()
        {
            while (run.WaitOne(0))
            {
                Thread.Sleep(100);
            }

           // do thread cleanup here
            Console.Beep();         
        }

    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-08-21T15:07:50.453

Charle B 在对 flq 的评论中提到的上述[链接](http://social.msdn.microsoft.com/Forums/en/windowscompatibility/thread/abf09824-4e4c-4f2c-ae1e-5981f06c9c6e)

内心深处 说道：

> 如果链接到 user32，SetConsoleCtrlHandler 将无法在 windows7 上运行

建议在线程中的其他地方创建一个隐藏窗口。因此，我创建了一个 winform，并在 onload 中附加到控制台并执行原始 Main。然后 SetConsoleCtrlHandle 工作正常（按照 flq 的建议调用 SetConsoleCtrlHandle）

```
public partial class App3DummyForm : Form
{
    private readonly string[] _args;

    public App3DummyForm(string[] args)
    {
        _args = args;
        InitializeComponent();
    }

    private void App3DummyForm_Load(object sender, EventArgs e)
    {
        AllocConsole();
        App3.Program.OriginalMain(_args);
    }

    [DllImport("kernel32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool AllocConsole();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-11T21:10:22.597

对于那些对 VB.net 感兴趣的人。（我在互联网上搜索并找不到它的等价物）在这里它被翻译成vb.net。

```
 <DllImport("kernel32")> _
    Private Function SetConsoleCtrlHandler(ByVal HandlerRoutine As HandlerDelegate, ByVal Add As Boolean) As Boolean
    End Function
    Private _handler As HandlerDelegate
    Private Delegate Function HandlerDelegate(ByVal dwControlType As ControlEventType) As Boolean
    Private Function ControlHandler(ByVal controlEvent As ControlEventType) As Boolean
        Select Case controlEvent
            Case ControlEventType.CtrlCEvent, ControlEventType.CtrlCloseEvent
                Console.WriteLine("Closing...")
                Return True
            Case ControlEventType.CtrlLogoffEvent, ControlEventType.CtrlBreakEvent, ControlEventType.CtrlShutdownEvent
                Console.WriteLine("Shutdown Detected")
                Return False
        End Select
    End Function
    Sub Main()
        Try
            _handler = New HandlerDelegate(AddressOf ControlHandler)
            SetConsoleCtrlHandler(_handler, True)
     .....
End Sub 
```

# asp.net - 如何跨应用程序整合 ASP.NET 母版页？

> ID：474685
> 
> 赞同：2
> 
> 时间：2009-01-23T21:38:02.773
> 
> 标签：asp.net, master-pages

第一次在这些板上提出问题，希望我能得到一些帮助，这里是：

我正在努力在我的客户上启动 .NET 实践。我们目前有 5 个小型 .NET 应用程序，其中一些已投入生产。它们大多是带有一些数据输入/业务逻辑功能的小型报告片段。这些应用程序中的每一个当前都使用相同的母版页。

我的意思是每个应用程序中都有相同母版页的副本。它们都是基本的网站->WCF->BL->DB 分层应用程序。所以我有 4 个相同母版页的副本，当我对其进行更改时，我必须更改它们。

客户不想将所有这些整合到一个解决方案中。他们喜欢跨站点的应用程序分离。我只是不想继续处理公共元素的多次更新的麻烦（在这些应用程序中会有更多更新）。

代码全部存储在团队基础服务器中。我们也不想将母版页编译成 .dll 并部署它。

任何人都可以就如何在我的多个应用程序中维护这些公共文件（主文件、.css 等）的单个副本提出一些建议。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T21:47:28.963

您可能想查看[在 Visual Studio 中共享母版页](http://msdn.microsoft.com/en-us/library/aa992039(VS.80).aspx)。

如果这没有帮助，那么您可以尝试在 Visual Studio 中使用[构建事件。](http://visualstudiohacks.com/articles/general/customize-your-project-build-process/)我会选择其中一个项目作为我的“主项目”，并且只编辑该项目的母版页。当您构建项目时，它会运行一个命令，将该母版页（如果已更改）复制到您设置的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T21:46:59.103

> 客户不想将所有这些整合到一个解决方案中。他们喜欢跨站点的应用程序分离。我只是不想继续处理公共元素的多次更新的麻烦（在这些应用程序中会有更多更新）。
> 
> 代码全部存储在团队基础服务器中。我们也不想将母版页编译成 dll 并部署它。

你消除了那里仅有的两个真正的选择。母版页中的全部内容是什么？是否可以将 HTML UI 元素提取到单个模板或一系列模板 HTML 文件中，然后将它们动态导入到母版页中？然后，您可以将通用 HTML 重新定位到任意 URL，并让每个应用程序的母版页动态地将其拉入。

编辑：我撒谎了。您还可以使用像 Sharepoint 这样的 VirtualPathProvider 将母版页存储在数据库或其他目录中，但请注意 VirtualPathProviders 在 MediumTrust 环境中不起作用。

请参阅：http:
[//msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx](http://msdn.microsoft.com/en-us/library/system.web.hosting.virtualpathprovider.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T22:16:33.287

如果您使用的是 Web 应用程序（编译成 dll）而不是网站，您可以执行以下操作：

右键单击要存储母版页的文件夹

选择“添加现有项目...”

浏览到文件系统上的母版页，然后选择 .master 和 .master.cs 文件。

然后，不要单击“添加”按钮，而是单击“添加”右侧的小向下箭头，这将弹出一个带有选项的小菜单：“添加”和“添加为链接”

选择“添加为链接”，这将引用您项目中的文件，同时将其保留在您的开发环境中的原始位置 - 这允许您在任一应用程序中对其进行编辑，同时在其他应用程序中使其保持最新。

显然，如果您编辑后面的代码，则需要在将更改部署到这些站点之前重新编译其他项目。

这在网站项目中不可用，因为它们依赖文件结构来计算项目中的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T22:29:23.450

编辑：错过了 css 部分。显然，您将无法提供这些文件，因此这只适用于母版页。

不知道你的情况，所以

如果您可以控制应用程序的 DNS / 虚拟目录，则可以使用如下格式：

c:\inetpub\wwwroot\Application1
c:\inetpub\wwwroot\Application2
c:\inetpub\wwwroot\Application3
c:\inetpub\wwwroot\Application4
c:\inetpub\wwwroot\Application5
并将您的母版页放在 c:\inetpub \wwwroot\master.Master，
c:\inetpub\wwwroot\master.Master.cs，
c:\inetpub\wwwroot\master.Master.cs.designer

然后，您可以从 /../master.Master 引用母版页的单个副本。我使用预编译的母版页快速进行了此操作，以确保我可以超越我的根目录。您可能需要试一试才能看到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T08:37:36.243

我们使用我们的源代码控制在我们需要的所有地方创建指向共享文件的链接。所以如果你在一个地方编辑，你只需要做一个获取最新的，它就会出现在你链接它的其他地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-17T21:30:39.180

我最终选择了 VPP 路线。我创建了一个虚拟路径提供程序并将我的母版页构建到一个 DLL 中，这正在工作。现在我有一个巨大的问题，因为它的母版页通过代码隐藏延迟绑定的内容页面会抛出验证/格式化问题，因为它认为它应该是一个支持页面。我的 CNTRL + K、CNTRL + D 在我现在共享母版页的每个页面上都损坏了。这对我和团队来说非常令人沮丧

# php - 如何使用 php 创建 unix 密码哈希

> ID：474698
> 
> 赞同：1
> 
> 时间：2009-01-23T21:41:24.827
> 
> 标签：php, security, unix, hash, passwords

我正在尝试使用 php 脚本安全地创建系统用户，在这种情况下，我希望能够使用 php 脚本对密码进行哈希处理，以便他们的密码不会出现在 bash 历史记录中。

如何获取一个字符串并对其进行哈希处理，使其成为 unix 密码哈希？

```
$UX_PW = some_function('my_password');
exec("useradd -p $UX_PW newusername"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T21:46:34.143

它`crypt()`实现了 UNIX 密码散列。
[http://us.php.net/manual/en/function.crypt.php](http://us.php.net/manual/en/function.crypt.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T21:46:13.973

根据您的系统，您正在寻找`crypt()`或`md5()`.

传统上，unix 使用 DES 加密的密码（即“crypt”函数），带有 2 个字符的 salt（来自集合 [a-zA-Z0-9./] 的两个随机字符），它被预先添加到散列以扰乱算法。

不过，较新的系统通常使用 MD5。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T21:48:40.647

使用[地穴](http://www.php.net/manual/en/function.crypt.php)。最近的 linux/unix 使用 CRYPT_MD5 或 CRYPT_BLOWFISH。MD5 是最广泛支持的一种。DES 用于旧系统。

另外我应该注意，MD5 版本不是简单的 MD5 求和运算，它还使用“盐”值来使哈希值不可预计算。[[这个词是我编的：）]]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T21:56:37.400

在 UNIX、Linux 和其他类似 UNIX 的 POSIX 操作系统上使用的密码散列变化很大。大多数“ `passwd`”散列方法使用*修改后*的DES 算法（不是真正的 DES），它们可能多次将散列应用于输入，并且它们使用 16 位或 24 位的盐。生成与 passwd 兼容的哈希的方法的具体答案取决于您使用的操作系统。

`crypt()`系统调用应该是根据您的操作系统进行密码散列的方法。您可以使用函数在 PHP 中访问它[`crypt()`](http://www.php.net/manual/en/function.crypt.php)。

至于使用哪种加密算法，这取决于您的操作系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T23:13:47.727

来自 passwd 上的 Ubuntu Intrepid 手册页（更改密码）

> 密码的安全性取决于加密算法的强度和密钥空间的大小。UNIX 系统加密方法基于 NBS **DES 算法**，非常安全。密钥空间的大小取决于所选密码的随机性。

[此外，您可能更喜欢hash()](http://ca2.php.net/manual/en/function.hash.php)而不是使用 crypt()，因为这允许您将哈希算法的字符串设置保留在其他地方。如果您的代码需要为其他环境使用不同的哈希算法，您只需更改字符串而不是函数的名称。

# java - 连接到只读数据库

> ID：474712
> 
> 赞同：1
> 
> 时间：2009-01-23T21:45:47.860
> 
> 标签：java, spring

尝试连接到设置为只读的数据库时，无法建立连接。我收到以下错误：

```
Cannot create PoolableConnectionFactory (Io exception: The Network Adapter could not 
establish the connection) 
```

应用程序需要以读写模式运行，然后通过仅检查连接对象的 isReadOnly 属性自动处理切换到只读。连接到读写数据库时应用程序运行正常，但当我更改为下面的连接字符串时失败（删除了安全信息）。我已经验证了连接字符串是正确的，所以问题不在那里。

```
ca.businesssolutions.nbs.jdbc.connect=jdbc:oracle:thin:unicorn_read_only/password@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=hostname)(PORT=9999)))(CONNECT_DATA=(SID=SBSBTST)(SERVER=DEDICATED))) 
```

我很难弄清楚从哪里开始寻找。我继承了该应用程序，但不确定它是弹簧框架限制还是我缺少的其他设置。

数据源的spring配置是：

```
<bean id="dataSource" class="ca.businesssolutions.nbs.server.base.datasource.MyBasicDataSource"
      destroy-method="close">
    <!--url and driver class name are set through Configuratoin object.-->
    <property name="initialSize" value="10"/>
    <property name="maxActive" value="-1"/>
    <property name="validationQuery" value="SELECT 1 FROM DUAL"/>
    <property name="accessToUnderlyingConnectionAllowed" value="true"/>
</bean> 
```

数据源构造函数：

```
public MyBasicDataSource() {
    super();
    setUrl(Configuration.get(Configuration.CONNECT));
    setDriverClassName(Configuration.get(Configuration.DRIVER_NAME));
    //The initial number of connections that are created when the pool is started.
    int numConnections = 10;
    try {
        numConnections = Integer.parseInt(Configuration.get(Configuration.NUMBER_OF_CONNECTIONS));
    } catch (Exception exception) {
        // Do nothing.
    }
    setInitialSize(numConnections);
    //The maximum number of active connections that can be allocated from this pool at the same time, or non-positive for no limit.
    setMaxActive(-1);
    setValidationQuery("SELECT 1 FROM DUAL");
    setAccessToUnderlyingConnectionAllowed(true);
    DataAccessObject.setDataSource(this);
} 
```

还有什么帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T22:04:44.483

读/写和只读连接字符串有什么区别？有错别字的*机会吗？*您是否从另一个工具（但来自同一主机）尝试了此连接字符串？尝试在您无法连接的同一台计算机上使用 Java GUI 工具。将复制/粘贴与您的确切连接字符串一起使用。

如果这也不起作用，您可能有无法解析的主机名、防火墙问题或其他问题。如果它确实可以*在同一台计算机上*运行，​​请发表评论。

# asp.net - 从具有自定义格式的 PageMethod 返回 JSON 对象

> ID：474718
> 
> 赞同：3
> 
> 时间：2009-01-23T21:46:17.453
> 
> 标签：asp.net, json, pagemethods

是否可以格式化如何从 PageMethod 将对象作为 JSON 返回？IE。从数据中删除第一个“d”元素，而无需从头开始编写 JSON。

**从：**
`{ "d": { "name": "bob", "email": "bob@example.com" } }`

**到**
`{ "name": "bob", email: "bob@example.com" }`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T00:32:20.223

.NET 框架添加了额外`"d"`参数，作为针对 XSS 攻击的附加安全措施 [[来源](http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx)]。当`"Content-Type"`请求的 指定时包含它`"application/json"`。

如果您只是将*请求*的指定为. 尝试从请求中删除该标头（如果可以）并查看 .NET 返回的内容。`"d"``"Content-Type"``"application/json"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T23:24:15.960

不。Microsoft 的 JSON 序列化程序出于某种原因在服务器端添加了 d，反序列化 JSON 字符串的客户端 AJAX 代码期望它存在。

# msbuild - TFS 和 TeamBuild 中的 BuildDef (tfsbuild.proj) 中的简单 Exec 任务

> ID：474723
> 
> 赞同：0
> 
> 时间：2009-01-23T21:47:28.947
> 
> 标签：msbuild, exec, task, tfsbuild

在 BuildExplorer 中排队时，这不起作用（取自 tfsbuild.proj）：

WFPApp1 的 Builddef。. . . . . .

但这确实（取自 app1.csproj）并在 VS IDE 中构建/重建

用于 WFPApp1 的 csproj 。. . . . .

在第一个示例中，构建似乎无限期挂起，直到在 BuildExplorer 中取消。您可以通过 BuildExplorer 查看步骤，并看到所有目标都已完成。

这看起来很简单，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-05T20:37:49.007

您能否发布更多信息 - 实际的 MSBuild 代码、构建步骤的图片？

您说“取自 TFSBuild.proj”，但我希望看到 MSBuild 语法，但我没有……？

# java - 从现有项目生成 Maven POM？

> ID：474725
> 
> 赞同：19
> 
> 时间：2009-01-23T21:47:35.047
> 
> 标签：java, maven-2, ide

是否有任何 IDE（或任何其他工具）能够基于现有项目生成 POM？

* * *

我最终按照[Peter](https://stackoverflow.com/users/57695/peter-lawrey)和[Sal](https://stackoverflow.com/users/13753/sal)的建议使用 Maven 原型生成了 POM，然后将现有源移入。感谢各位的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-23T22:29:04.293

一种方法是通过 maven 原型创建模板项目，然后将现有代码移动到模板中。我只推荐这个用于非常简单的项目。它会像这样工作。

```
mvn archetype:generate 
mv src/* src/main/java
mv test/* src/test/java
mvn package 
```

你会得到错误。要添加缺少的依赖项，请访问：[http](http://www.mvnrepository.com/) ://www.mvnrepository.com/并开始查找它们。如果你选择一个接近你需要的原型，你就成功了一半。

一旦一切正常。

```
svn commit -m "hacky maven port" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T21:59:19.970

您可以在 IntelliJ 中执行此操作，但它生成的 POM 可能比您手动编写更复杂。如果您的项目当前在 JBuilder 或 Eclipse 中，您可以先导入它。

相反，我建议您在 POM 中描述您的项目并使用它来生成您的项目信息。您可以为 eclipse 和 idea 执行此操作（我假设其他 IDE）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T22:08:51.120

您现有的项目可能不使用 Maven，因此基于它创建 POM 并非易事。

我能想到的最简单的方法是获取 Eclipse 的 Maven 插件，生成一个新的 maven 项目，然后添加您的代码。

您还需要使用 Maven 的方法管理外部 jar。在这种情况下，它们可能是系统 jar。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-07T23:52:09.317

在 eclipse Galileo 中，如果你有 maven2 插件，你可以选择项目，然后右键单击并在上下文菜单中向下转到 Maven2，应该有一个选项可以将项目转换为 maven 项目。

# mysql - MySQL 行优先级

> ID：474727
> 
> 赞同：1
> 
> 时间：2009-01-23T21:47:52.520
> 
> 标签：mysql, cleaned-data

我有一个数据库表，里面有一些非常丑陋和混乱的数据。在一个单独的表中，我有一个更清晰的数据版本，它们通过 id 链接，但我需要保留杂乱的数据集并且不能覆盖它，因为我使用它来检查数据差异。

我正在尝试将数据合并到一个新表中，或者在两个表中使用单个查询，并在结果中赋予干净的表结果优先级。

所以如果`id=3` `uglydata=x7z` `cleandata=xyz`，那么我会得到干净的数据，如果`cleandata`是 null，我会得到丑陋的数据。我尝试选择`cleandata`AS `uglydata`，希望 MySQL 会覆盖另一个字段，但这不起作用（是的，这很奇怪，我认为这不起作用）。

他们是这样做的好方法吗？

我能想到的另一种解决方案是先从干净的数据中插入新表，然后从丑陋的数据中插入，因为出价是唯一的。

但我希望我能够按类型或其他方式对结果进行优先级排序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T22:00:10.263

```
SELECT IFNULL(cleandata, uglydata)
FROM uglytable
LEFT OUTER JOIN cleantable
ON clean_id = ugly_id 
```

# c - C中意外的输出复制文件

> ID：474733
> 
> 赞同：2
> 
> 时间：2009-01-23T21:49:28.850
> 
> 标签：c, file-io

在另一个问题中，[接受的答案](https://stackoverflow.com/questions/174531/easiest-way-to-get-files-contents-in-c#174552)显示了一种将文件内容读入内存的方法。

我一直在尝试使用此方法读取文本文件的内容，然后将其复制到新文件中。但是，当我将缓冲区的内容写入新文件时，文件末尾总会有一些额外的垃圾。这是我的代码示例：

```
inputFile = fopen("D:\\input.txt", "r");
outputFile = fopen("D:\\output.txt", "w");

if(inputFile)
{
    //Get size of inputFile
    fseek(inputFile, 0, SEEK_END);
    inputFileLength = ftell(inputFile);
    fseek(inputFile, 0, SEEK_SET);

    //Allocate memory for inputBuffer   
    inputBuffer = malloc(inputFileLength);

    if(inputBuffer)
    {
        fread (inputBuffer, 1, inputFileLength, inputFile);
    }

    fclose(inputFile);

    if(inputBuffer)
    {
        fprintf(outputFile, "%s", inputBuffer);
    }

    //Cleanup
    free(inputBuffer);
    fclose(outputFile);
} 
```

输出文件始终包含输入文件的精确副本，但在末尾附加了文本“MPUTERNAM2”。任何人都可以阐明为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T21:58:35.493

你可能会更开心

```
int numBytesRead = 0;
if(inputBuffer)
{
  numBytesRead = fread (inputBuffer, 1, inputFileLength, inputFile);
}

fclose(inputFile);

if(inputBuffer)
{
  fwrite( inputBuffer, 1, numBytesRead, outputFile );
} 
```

它不需要以 null 结尾的字符串（因此可以在包含零的二进制数据上正常工作）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T21:53:20.700

您没有为缓冲区中的终止空字符分配足够的空间（并且您也忘记实际设置它），因此您的 fprintf 有效地过度读取到其他一些内存中。您的缓冲区与文件的大小完全相同，并且填充了其内容，但是，fprintf 读取参数以寻找终止的空值，该空值不存在，直到几个字符之后，巧合的是，有一个。

**编辑**
您实际上混合了两种类型的 io，fread（与 fwrite 配对）和 fprintf（与 fscanf 配对）。您可能应该使用要写入的字节数进行 fwrite；或者相反，使用 fscanf，它将以空值终止您的字符串（尽管这不允许您的字符串中有空值）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T21:56:33.110

因为您正在编写缓冲区，就好像它是一个字符串一样。字符串以 NULL 结尾，您读取的文件没有。

您可以 NULL 终止您的字符串，但更好的解决方案是使用 fwrite() 而不是 fprintf()。这也可以让您复制包含 NULL 字符的文件。

除非您知道输入文件总是很小，否则您可能会考虑循环读取/写入，以便复制大于内存的文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T23:06:26.853

分配内存以适应文件实际上是一种非常糟糕的方式，尤其是在这里完成的方式。如果 malloc() 失败，则不会将数据写入输出文件（并且它会静默失败）。换句话说，由于地址空间的限制，您不能在 32 位平台上复制大于几 GB 的文件。

实际上，使用较小的内存块（已分配或​​在堆栈上）并以块的形式读/写文件要好得多。无论如何，读取和写入都将被缓冲，只要您使块相对较大，对 C 运行时库的函数调用开销就很小。

您也应该始终以二进制模式复制文件，因为没有翻译的机会，所以速度更快。

就像是：

```
FILE *fin = fopen ("infile","rb");  // make sure you check these for NULL return
FILE *fout = fopen ("outfile","wb");
char buff[1000000];  // or malloc/check-null if you don't have much stack space.
while ((count = fread (buff, 1, sizeof(buff), fin)) > 0) {
    // Check count == -1 and errno here.
    fwrite (buff, 1, count, fout); // and check return value.
}
fclose (fout);
fclose (fin); 
```

这是来自记忆，但提供了如何做到这一点的总体思路。而且您应该**始终**进行 copioos 错误检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T21:55:28.043

fprintf 期望 inputBuffer 以空值结尾，但事实并非如此。所以它正在读取 inputBuffer 的末尾并打印那里的任何内容（到您的新文件中），直到找到一个空字符。

在这种情况下，您可以 malloc 一个额外的字节并将 null 作为 inputBuffer 中的最后一个字符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T21:58:34.743

除了其他人所说的：您还应该以二进制模式打开文件 - 否则，您可能会在 Windows（或其他非 POSIX 系统）上得到意想不到的结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T21:58:53.073

您可以使用

```
fwrite (inputBuffer , 1 , inputFileLength , outputFile ); 
```

而不是`fprintf`, 以避免以零结尾的字符串问题。`fread`它也与:) “匹配得更好”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-23T22:00:38.890

尝试使用 fgets 代替，它会在字符串的末尾为您添加空值。同样如上所述，您需要一个空终止符的空间。

IE

字符串“Davy”表示为包含 D,a,v,y,\0（不带逗号）的数组。基本上，您的数组至少需要 sizeofstring + 1 才能保存空终止符。fread 也不会自动添加终止符，这就是为什么即使你的文件比你得到垃圾的最大长度短得多。

请注意，另一种懒惰的方法是使用 calloc 将字符串设置为 0。但您仍然应该最多只读取 inputFileLength-1 个字符。

# perl - Perl 猴子补丁是否允许您查看补丁包的范围？

> ID：474763
> 
> 赞同：3
> 
> 时间：2009-01-23T21:56:38.850
> 
> 标签：perl, scope, packages, monkeypatching

我正在使用[“如何在 Perl 中对实例方法进行猴子修补？”开头给出的技术对包进行修补。](https://stackoverflow.com/questions/449690/how-can-i-monkey-patch-an-instance-method-in-perl#449783). 我遇到的问题是原始子例程使用了一个包级`my`变量，修补后的子例程似乎无法通过完整路径规范或隐式使用访问该变量。

有什么方法可以获取以这种方式限定范围的数据，以便在修补的子例程中使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T23:11:17.717

您可以使用[PadWalker](http://search.cpan.org/dist/PadWalker)模块获取词汇。邪恶，但它有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T22:13:51.530

不，您误会的是它们**不是**包范围的。根据定义，词法变量仅限于其词法范围，换句话说，就是它所在的块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T03:42:51.307

词法（即：用'my'声明）在声明它们的词法范围（文件或块）之外是不可见的。这就是词法变量的全部意义所在。

如果有一个与词法变量在同一范围内的子例程/方法，那么它可以返回词法的值，并且可以允许从其范围之外间接访问该变量。

词法变量没有“完整路径规范”之类的东西。那是针对包变量的。如果 var 是用 'our' 而不是 'my' 声明的，你可以这样做。

# windows-mobile - Window Mobile 6.5 构建在哪个版本的 CE 之上？

> ID：474770
> 
> 赞同：1
> 
> 时间：2009-01-23T21:58:08.817
> 
> 标签：windows-mobile, windows-ce

Windows Mobile 5 基于 CE 5.0。

Windows Mobile 6 基于 CE 5.2。

有谁知道 Windows Mobile 6.5 使用什么版本的 CE？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T22:35:30.160

该[来源](http://forum.xda-developers.com/showthread.php?p=3204746)表明 WM6.5 也是基于 CE 5.2（特别是 5.2.21139）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T23:25:08.703

是的，它仍然是 CE 5.0 基础——它没有使用 CE 6.0 内核。

# wpf - 如何让 WPF 设计器窗格查看我的资源？

> ID：474782
> 
> 赞同：0
> 
> 时间：2009-01-23T21:59:47.080
> 
> 标签：wpf, visual-studio-2008

在我的应用程序中，我有在多个类中使用的各种样式和模板。我已经在 my 中定义了这些，因此它们在所有子对象中都是可见的。

然而，在设计时，WPF 设计器看不到这些资源，抱怨它们“未找到”，并要求在重新加载设计器之前必须修复错误。

我可以做些什么来让它查找对象层次结构，或者将它专门指向定义它们的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T22:09:36.110

您可以通过将它们引用为 DyanmicResource 而不是 StaticResource 来停止抱怨

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T22:26:03.863

您必须使用 Expression Blend 来让您的样式和模板按照您期望的方式运行。不幸的是，除了最简单的情况外，微软似乎已经放弃了 Visual Studio 的 WPF 设计器。他们似乎已经认真对待设计和开发的分离，至少在一定程度上是这样。

> ID：474785
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# domain-driven-design - 合并两个域对象

> ID：474788
> 
> 赞同：1
> 
> 时间：2009-01-23T22:00:33.897
> 
> 标签：domain-driven-design, factory

在我正在处理的项目中，我们有一个聚合域对象。工厂对象处理对象唯一 ID 的创建。但是有一个单独的导入过程，它最初创建没有 id 的相同对象。要将导入的对象添加到系统中，我们现在被迫逐个字段地复制到一个新对象，因为出于显而易见的原因，我们不能只为其设置 id。任何人都可以提出更好的方法来处理这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T22:54:34.850

可能性：

*   如果导入过程允许，请在创建时注入您的域对象，以便它实际填充您的对象。
*   让您的对象实现成为导入过程创建的对象的包装器。相应地更改您的工厂。

# c# - 如何为测试目的模拟网络故障（在 C# 中）？

> ID：474803
> 
> 赞同：27
> 
> 时间：2009-01-23T22:07:52.463
> 
> 标签：c#, testing, network-programming

我正在为一个新的应用程序构建一个可以称为 DAL 的东西。不幸的是，与数据库的网络连接是一个真正的问题。

我希望能够在我的测试范围内临时阻止网络访问，以便我可以确保我的 DAL 在这些情况下按预期运行。

更新：有很多手动方法可以禁用网络，但如果我可以在测试本身中启用/禁用它肯定会很好。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-23T23:25:22.027

目前，我只是通过设置一个虚假的静态 IP 来“禁用”网络，如下所示：

```
using System.Management;

class NetworkController
{

    public static void Disable()
    {
        SetIP("192.168.0.4", "255.255.255.0");
    }

    public static void Enable()
    {
        SetDHCP();
    }

    private static void SetIP(string ip_address, string subnet_mask)
    {
        ManagementClass objMC = new ManagementClass("Win32_NetworkAdapterConfiguration");
        ManagementObjectCollection objMOC = objMC.GetInstances();

        foreach (ManagementObject objMO in objMOC) {
            if ((bool)objMO("IPEnabled")) {
                try {
                    ManagementBaseObject setIP = default(ManagementBaseObject);
                    ManagementBaseObject newIP = objMO.GetMethodParameters("EnableStatic");

                    newIP("IPAddress") = new string[] { ip_address };
                    newIP("SubnetMask") = new string[] { subnet_mask };

                    setIP = objMO.InvokeMethod("EnableStatic", newIP, null);
                }
                catch (Exception generatedExceptionName) {
                    throw;
                }
            }

        }
    }

    private static void SetDHCP()
    {
        ManagementClass mc = new ManagementClass("Win32_NetworkAdapterConfiguration");
        ManagementObjectCollection moc = mc.GetInstances();

        foreach (ManagementObject mo in moc) {
            // Make sure this is a IP enabled device. Not something like memory card or VM Ware
            if ((bool)mo("IPEnabled")) {
                ManagementBaseObject newDNS = mo.GetMethodParameters("SetDNSServerSearchOrder");
                newDNS("DNSServerSearchOrder") = null;
                ManagementBaseObject enableDHCP = mo.InvokeMethod("EnableDHCP", null, null);
                ManagementBaseObject setDNS = mo.InvokeMethod("SetDNSServerSearchOrder", newDNS, null);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T22:15:01.137

使用开关为您正在使用的网络类连接类（例如 WebClient）编写一个包装器 :)

要么，要么在防火墙中阻止您的应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-23T22:47:29.607

如果您正在为您的应用程序尝试完全的网络中断，则拔下网络电缆将起作用。有时您可能有一个具有多个数据源（在不同机器上）的数据访问层，在这种情况下，您可以使用 Rhino Mocks 之类的 Mock 框架在测试中模拟异常。这是您在测试中可能拥有的一些伪代码

```
void TestUserDBFailure()
{
    // ***** THIS IS PSEUDO-CODE *******
    //setting up the stage - retrieval of the user info create an exception
    Expect.Call(_userRepository.GetUser(null))
       .IgnoreArguments()
       .Return(new Exception());

    // Call that uses the getuser function, see how it reacts
    User selectedUser = _dataLoader.GetUserData("testuser", "password");        
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-23T22:12:39.020

尝试在会话中途阻止与防火墙的连接？

我也喜欢包装器的想法，但这有点抽象问题，你可能无法得到准确的现实世界行为。此外，插入包装层然后将其移除可能比它的价值更麻烦。

**编辑**：运行脚本以随机或按设定的时间间隔打开/关闭网络适配器？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-23T23:24:26.863

可能对模拟“真实”网络问题没有帮助，但您可以在测试范围内将数据库连接字符串指向不存在的机器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-16T17:49:04.777

试试 Toxiproxi，它可以模拟网络中断。

他们有 REST API 甚至 .NET Client API 以编程方式更改网络模拟（来自您的测试代码） [https://github.com/shopify/toxiproxy](https://github.com/shopify/toxiproxy)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-23T22:22:25.833

寻找一个允许您限制带宽（并完全切断它）的 WAN 模拟器。当我的应用程序在带宽受限的环境中运行时，看看用户体验如何变化，我总是觉得很有趣。[在这里](http://www.myloadtest.com/free-wan-emulator/)查看一些信息。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-23T22:47:25.910

有一个工具可用于模拟数据库应用程序测试中的高延迟和低带宽，如本[博客条目中](http://sqlblog.com/blogs/john_paul_cook/archive/2008/04/13/simulating-high-latency-and-low-bandwidth-for-database-connectivity-testing.aspx)所述。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-23T23:53:02.063

取决于您希望模拟的特定网络问题。对于大多数人来说，它就像“服务器无法访问”一样简单，在这种情况下，您只需尝试连接到不存在的服务器即可。但是要小心，因为您想要一些可路由但不应答的东西。尝试连接到 dkjdsjk.com 将立即失败（DNS 查找），但尝试连接到 www.google.com:1433 将（可能）由于防火墙而超时 - 这是您的应用程序在您的数据库服务器运行时的行为方式向下。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-01-22T17:56:42.613

刚刚找到了一个允许直接关闭 TCP 连接的替代方案：

[http://lamahashim.blogspot.ch/2010/03/disabling-network-using-c.html](http://lamahashim.blogspot.ch/2010/03/disabling-network-using-c.html)

它基于 Windows IP Helper API（使用 DllImport）： http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa366073 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366073(v=vs.85).aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T23:15:21.437

使用模拟对象创建真实事物的可配置、可破坏版本——在本例中为数据库。

# .net - SQL Server 数据库中的 NULL 与默认值

> ID：474806
> 
> 赞同：5
> 
> 时间：2009-01-23T22:08:05.240
> 
> 标签：.net, sql-server

在将行插入数据库时​​，使用默认值（例如空字符串）是否有任何影响。在应用程序中使用数据时必须检查使用空值的问题，而默认值可以更容易处理。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T22:13:01.440

数据库中NULL的含义应该保留给'unknown'，它与空不同。因此，只要您使用的默认值反映了基础数据的性质（即它不是“未知”），我实际上会建议使用默认值。

但是，您的里程可能会有所不同。这取决于您的应用程序。如果它以不同的方式处理未知值，那么一定要这样做:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-23T22:53:54.400

我不同意使用默认值。null 的目的是表明您没有任何信息。空字符串并不意味着，它是一个值。此外，如果您开始禁止字符串上的空值，那么您需要考虑其他数据类型。数字和日期很难有一个意味着“我没有这个字段的值”的值。如果您错误地将数字或日期存储在 varchar 字段中，则放置空字符串而不是 null 可能会导致查询不起作用；当您需要将它们转换为日期或等效数字以对它们进行数学处理时（不建议将日期和数字数据存储为字符串，只是认识到您可能已经有了一些，并且这种方案可能会导致查询它们的方式出现问题。）如果您不允许除这些字段之外的所有字段都为空值，那么您会做很多，查询这些字段时会出现很多错误，因为您不习惯检查空值，并且更有可能忘记这样做。您也可能导致新品牌的查询问题。考虑：

```
select count(myfield), myfield2 from mytable group by myfield2 
```

如果您在不知道某个值时使用 null 或空字符串来存储值，这将产生不同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T22:12:38.117

我相信你会遇到的主要错误是逻辑错误。

字符串很简单，但整数不同。考虑一个薪水列。默认值为 0，这可能表示与 NULL 不同的东西。NULL 表示该员工没有通过工资单，而 0 表示由于某种原因他仍然必须处理。

NULL 也可用于外键，但在 FK 上设置 Default 似乎是个坏主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T22:11:22.130

我相信这取决于偏好和数据库目的，虽然我对 SQL Server 数据库如何存储它的数据并不十分熟悉，但我推测它会产生最小的实际差异，因为我已经使用过 Null条目和默认字符串作为区分方法，并且从未注意到任何一种方式有太大差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T22:27:04.983

向列添加空能力确实会增加更多的存储开销。每八个可为空的列创建一个空位图。例如，一到八个可为空的列向该行添加一个额外的字节，九到十六个添加另一个字节，每行总共添加两个额外的字节，依此类推。

检查 NULL 与空字符串 ('') 是不同的，因为您需要检查 COLUMN IS NULL 或 COLUMN = ''。即使 COLUMN 为 NULL，COLUMN = NULL 的比较也不会起作用，因为 NULL 不等于 NULL，因此 IS NULL 运算符。

此外，将 NULL 与其他数据连接或聚合将导致重大问题，因为与 NULL 连接的任何内容都会导致 NULL。聚合将忽略 NULL 并引发警告，但这可能不是您想要的平均值行为。

我的建议是坚持非空列并使用空字符串作为占位符，如果您想尽可能减少存储空间并且您不希望在代码中检查 NULL 会带来额外的麻烦。我并不是建议这适用于所有情况，并且可以为可空性提出一个论据，但这种方法使其保持简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-07T06:11:34.267

由您决定，主要由应用程序行为和业务需求驱动。

一个默认列，大多数时候在什么时候使用

1.  您的应用程序根本不想输入该列。一个很好的例子是“审计”列，如果您不希望应用程序/用户在插入/更新行时提供数据
2.  在某些模块中使用（网页/风窗体等）。例如，快速注册表单只接受所需的用户 ID/姓名、电子邮件和密码。
3.  如果您不懒惰手动填充测试数据。我发现开发人员的懒惰是导致不必要的 DEFAULT 列的主要驱动力。

# c# - 在 C# 中将像素转换为英寸，反之亦然

> ID：474810
> 
> 赞同：8
> 
> 时间：2009-01-23T22:09:07.967
> 
> 标签：c#, winforms, system.drawing, pixels, inches

我希望将像素转换为英寸，反之亦然。我知道我需要 DPI，但我不确定如何获取此信息（例如，我没有`Graphics`对象，所以这不是一个选项）。

有办法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T23:38:07.787

在视频设备上，这个问题的任何答案通常都不是很准确。用于了解为什么会这样的最简单示例是投影仪。例如，输出分辨率为 1024x768，但 DPI 会因屏幕与投影仪孔径的距离而异。例如，WPF 始终假定视频设备上的 DPI 为 96。

Presuming you still need an answer, regardless of the accuracy, and you don't have a Graphics object, you can create one from the screen with some P/Invoke and get the answer from it.

```
Single xDpi, yDpi;

IntPtr dc = GetDC(IntPtr.Zero);

using(Graphics g = Graphics.FromHdc(dc))
{
    xDpi = g.DpiX;
    yDpi = g.DpiY;
}

if (ReleaseDC(IntPtr.Zero) != 0)
{
    // GetLastError and handle...
}

[DllImport("user32.dll")]
private static extern IntPtr GetDC(IntPtr hwnd);    
[DllImport("user32.dll")]
private static extern Int32 ReleaseDC(IntPtr hwnd); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T22:14:39.500

在不知道 DPI 的情况下，从物理上讲，没有真正的方法。像素是离散的，英寸不是，如果你在显示器上谈论英寸，你需要知道（至少）分辨率（和像素纵横比）和可见显示器区域的大小，以便计算你的 DPI . 分辨率通常可以在某个地方获取（我不是 C# 或 .NET 程序员，所以我无法帮助您），但通常无法获得显示器的大小。如果估计值足够好，则让用户输入显示器的尺寸（即 21" 或其他尺寸）并求解 DPI：

```
(resX/DPI)^2 + (resY/DPI)^2 = screenDiagonal^2 
```

给予（假设你知道对角线和分辨率）

```
DPI = sqrt(resX^2+resY^2)/screenDiagonal 
```

这只是一个估计值，因为显示器永远不会正好是 21 英寸（.. 或其他），而且像素长宽比也几乎不会是 1:1。

如果您在纸上谈论英寸，那么您很自然地需要知道打印机的 DPI（或者更准确地说，是当前的打印机设置）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T22:26:01.710

您可以通过调用`this.CreateGraphics()`（或更一般地`Control.CreateGraphics()`）简单地创建 Graphics 对象，然后使用您似乎知道的 DpiX 和 DpiY 属性。只需记住在创建图形对象后处理它（最好使用 Using 语句）。

如果您不使用 WinForms，请告诉我们它是什么类型的应用程序。

# c# - 从 http url 加载 xml

> ID：474814
> 
> 赞同：1
> 
> 时间：2009-01-23T22:09:47.357
> 
> 标签：c#

我在 Web 应用程序中使用 xml.net 当我尝试通过 http Internet url 加载 xml 时，使用：xmlDoc.Load("http://....") 我得到一个错误："连接的主机无法响应"

任何人都知道解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T22:51:04.530

已连接主机未能响应是因为您没有正确访问 uri，或者您无权访问它，或者它没有响应您，或者它已关闭。http 并不真正关心它传输的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T01:11:48.397

这可能正是它所说的：负责您指定的 URL 上的请求的 Web 服务器没有发回响应。Web 服务器出现问题，如果是这样，您无法对云中某人的 Web 服务器无法正常运行采取任何措施。

但是，您可以接受并非每个 URL 都能正常工作的事实，并且您必须捕获 XmlDocument 或 XDocument 抛出的异常。可以合理地预期这种情况可能会发生。因此，您需要进行防御性编程，并通过包含适当的异常处理来处理此类情况。

编辑：所以你可以从 .NET 框架之外访问它，嗯？也许尝试使用 HTTP 调试器，如 Fiddler，并将您的 XML 文档对象发出的请求与浏览器发出的请求进行比较。哪些标头字段不同？浏览器是否包含 XML 文档对象不包含的标头？或者两者之间是否存在不同的标头值，这可能导致 .NET 请求未得到响应？去搞清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T01:58:29.423

如果该页面可通过 Web 浏览器访问，但不能通过 load 方法访问，则听起来该方法没有向所需页面的 Web 服务器发出正确的 HTTP 请求。

您可以尝试使用带有标准 GET 方法的 HTTPWebRequest 为网页发出正确的 HTTP 请求。然后，您可以将响应作为流传递给 XMLDocument.Load 方法，然后它应该可以正常加载。

[HTTPWebRequest 类 MSDN.com](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T02:26:01.757

尝试对 url 发出 WebRequest 并将其 UserAgent 属性设置为类似 "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322)" 。如果它可以加载您在 xmldoc 中获得的文本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T04:11:09.193

我尝试使用 .Net HttpWebRequest 加载 xml，还尝试设置 userAgent 属性。但它仍然给我错误消息：“无法连接到远程服务器” 但是可以通过浏览器访问 xml。

这是代码：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);

    request.UserAgent ="Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322)";

    string result = string.Empty;

    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
    {
            // Get the response stream
            StreamReader reader = new StreamReader(response.GetResponseStream());

            // Read the whole contents and return as a string
            result = reader.ReadToEnd();

    } 
```

谢谢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T05:08:03.120

您的浏览器是否使用了任何代理？

只需尝试 telnet 以查看您是否能够通过浏览器以外的应用程序连接到 Web 服务器。

因此，如果您使用的是[http://www.xmlserver.com/file.xml](http://www.xmlserver.com/file.xml)之类的网址，请在命令提示符下尝试以下操作：

```
 telnet xmlserver.com 80 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-01T23:46:57.987

您的请求和浏览器请求之间的巨大差异可以通过以下行来桥接：

```
request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"; 
```

# .net - 多列上的 LINQ COUNT

> ID：474817
> 
> 赞同：7
> 
> 时间：2009-01-23T22:11:16.700
> 
> 标签：.net, sql, linq, linq-to-sql

如果我有一个包含 1 或 NULL 的标题列和 3 位列（f1、f2、f3）的表，我将如何编写 LINQ 以返回包含 1 的每个位列的计数的标题？我正在寻找这个 SQL 查询的等价物：

```
SELECT title, COUNT(f1), COUNT(f2), COUNT(f3) FROM myTable GROUP BY title 
```

我正在寻找“最好”的方式来做到这一点。当您查看底层 SQL 时，我提出的版本会在表中下降 4 次，所以它太慢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T22:19:18.837

如果您想坚持使用 LINQ 查询并使用匿名类型，则查询可能如下所示：

```
 var query = 
      from r in ctx.myTable
      group r by r.title into rgroup
      select new
      {
          Title = rgroup.Key,
          F1Count = rgroup.Count(rg => rg.f1 == true),
          F2Count = rgroup.Count(rg => rg.f2 == true),
          F3Count = rgroup.Count(rg => rg.f3 == true)
      }; 
```

诀窍是识别您想要计算真实字段的数量（它被映射为可为空的布尔值），您可以使用 Count 运算符和谓词来完成。此处有关 LINQ 组运算符的更多信息：[标准 LINQ 运算符](http://www.odetocode.com/Articles/739.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-24T00:19:56.520

我认为这就是 LINQ 失败的地方。如果您想要高效地使用 SQL，如果您想要漂亮的代码，请使用 LINQ。

您总是可以直接执行查询，因为您已经知道 SQL。

```
class TitleCount {
    public string Title;
    public int Count1;
    public int Count2;
    public int Count3;
}

DataContext dc = new DataContext("Connection string to db");

IEnumerable<TitleCount> query = dc.ExecuteQuery<TitleCount>(
    @"SELECT title, 
             COUNT(f1) as Count1, 
             COUNT(f2) as Count2, 
             COUNT(f3) as Count3 
       FROM myTable GROUP BY title"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T13:57:15.767

这是我想出的解决方案。请注意，它接近@OdeToCode 提出的解决方案（但使用 VB 语法），但有一个主要区别：

```
Dim temp = _
    (From t In context.MyTable _
     Group t.f1, t.f2, t.f3 By t.title Into g = Group _
     Select title, g).ToList

Dim results = _
    From t In temp _
    Select t.title, _
        f1_count = t.g.Count(Function(x) If(x.f1, False)), _
        f2_count = t.g.Count(Function(x) If(x.f2, False)), _
        f3_count = t.g.Count(Function(x) If(x.f3, False)) 
```

第一个查询进行分组，但 ToList 按原样从服务器获取分组数据。在此处消除计数可防止生成的 SQL 语句为每个计数生成子 SELECT。我在本地的第二个查询中进行计数。

这很有效，因为我知道第一个查询将返回可管理的行数。如果它返回数百万行，我可能不得不转向另一个方向。

# .net - Cruise Control .Net - 跨域构建

> ID：474819
> 
> 赞同：0
> 
> 时间：2009-01-23T22:12:17.400
> 
> 标签：.net, continuous-integration, dns

目前我们的开发环境由一个开发服务器、一个暂存服务器和一个生产服务器组成。我们的生产服务器和登台服务器位于同一个域中，而我们的构建服务器和开发服务器位于不同的域中。

是否可以让我的构建服务器（Cruisecontrol .Net）访问其域外的两台服务器？如果是这样，我在一个域中的构建用户可以访问另一个域吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T22:36:52.297

Cruise Control.Net 会做任何你想做的事，但你必须做一些管道。所有 Cruise Control.Net 都是一个帮助您进行持续集成的工具，它不是无缝的，并且确实需要一些工作来设置。

如果您尝试将构建“推送”到多个位置，这是可能的，但您必须进行设置（据我所知）。我们将 FTP 传输与[Robocopy](http://Robocopy)结合使用，将构建推送到不同域上的多个区域，然后将文件复制到我们当前的文件上。

如果您有兴趣，这是[一篇](http://msmvps.com/blogs/omar/archive/2008/10/06/asp-net-website-continuous-integration-deployment-using-cruisecontrol-net-subversion-msbuild-and-robocopy.aspx)关于开始使用巡航控制的好文章。

祝你好运

# windows - 在 MinGW 构建后，Qt 工具栏按钮图标在 Windows 中显示，但在使用 g++ 构建后消失

> ID：474833
> 
> 赞同：1
> 
> 时间：2009-01-23T22:15:07.380
> 
> 标签：windows, linux, qt, icons

我正在开发一个类似于 Eclipse 的 PHP IDE，但重量更轻。对于界面，我使用的是 Qt 4.4.3，它似乎工作得很好。我主要使用我的 Windows 机器在 Eclipse CDT 中进行大部分编码，并使用 MinGW 作为编译器。

几天前，我把代码放在我的 Eee PC 上，看看我是否可以构建它。好吧，在获得了 build-essential、Qt 和 Eclipse 之后，程序编译得很好。但是，当我在 Linux 中启动它时，我的程序工具栏上的所有图标都消失了。这些是常见的图标，如剪切、复制、粘贴、打开、新建...构建没有给我任何警告，并且工具栏就像它有图标一样（即，如果图标不可用，则有一个文本标签显示按钮。它不显示文本标签，因此它认为图像在那里）。

关于为什么图标没有显示的任何想法？文件结构完全一样，图标的路径也正确。资源文件查找图像。我对 Linux 很陌生，并且在 Linux 上进行开发，所以我会很感激任何帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T18:35:31.430

您为图标使用了哪种图像格式，例如 GIF、PNG？可能是目标机器上的 Qt 没有成功加载该格式的[插件](http://doc.trolltech.com/4.5/qimageioplugin.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T00:01:47.430

使用'strace -e file -o LOG ./YourBinary'，启动后立即退出程序。

查看日志中的“未找到文件错误”。在像这样的神秘案例中，以这种方式仔细检查路径确实是正确的永远不会有什么坏处

# c++ - C++ 标准模板库优先级队列抛出异常并显示消息“无效堆”

> ID：474835
> 
> 赞同：3
> 
> 时间：2009-01-23T22:15:43.633
> 
> 标签：c++, heap, priority-queue

使用 STL`priority_queue`时，我一尝试使用`pop()`. 我可以将我的值推送到队列中，`top()`队列的值是我所期望和可访问的。`pop()`，当它去重新堆时，似乎有问题。

我在队列中存储指向模板类的指针。我有比较重载：

```
template <class type>
class vertexPriorityCompare
{
public:
   bool operator()(Vertex<type>* leftVertex, Vertex<type>* rightVertex) const
   {
      if(leftVertex->getDistanceFromSource() < 0 && rightVertex->getDistanceFromSource() < 0)
      {
         return false;
      }
      else if(leftVertex->getDistanceFromSource() < 0)
      {
         return true;
      }
      else if(rightVertex->getDistanceFromSource() < 0)
      {
         return false;
      }
      else
      {
         return leftVertex->getDistanceFromSource() > rightVertex->getDistanceFromSource();
      }
   }
}; 
```

`priority_queue`是类的私有成员：

```
priority_queue< Vertex<type>*, vector< Vertex<type>* >, vertexPriorityCompare<type> > Q; 
```

过载以它的方式工作，因为负距离被认为是无穷大，总是比其他任何东西都大；为了表示无穷大，距离被初始化为 -1。队列需要在顶部保持最小但非负数。

我取消引用重载中的指针，我在那里做什么是允许的吗？而且，我需要重载另一个运算符吗？

我会附上代码，但似乎如果我这样做，它会吓跑人们。请求查看更多，我将附加到另一条消息。

我动态声明了一个指向指针的指针数组，这些是被推送的，因为我假设`priority_queue`通过引用存储，所以如果我只是将循环中声明的指针放入队列中，该指针就会超出范围。这些指针指向正确的`Vertex<type>`，并且存在于整个函数中。

Visual Studio 2008 调试器将我带到“stdthrow.cpp”第 24 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T22:45:10.237

这可能是您的比较功能。要进行测试，请将其替换为仅比较指针的简单版本：

```
bool operator()(...)
{
  return leftVertex<rightVertex;
} 
```

如果问题不再出现，则问题是您的比较功能无效。您的比较器必须定义[“严格-弱排序”](http://www.sgi.com/tech/stl/priority_queue.html)。我没有足够的男人来证明它不是，但我敢打赌就是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T23:30:44.777

比较函数看起来很好，**如果**对象的值`getDistanceFromSource()`没有改变，而该对象在队列中。这有保证吗？`getDistanceFromSource()`或者当它们在队列中或队列最初被填充时，是否可能对对象进行了更改，这会产生影响？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T22:26:40.740

你从哪里调用这个函数？

我的猜测是，无效堆是您从“此函数调用者的”代码传递给函数的指针。或者，当您将顶点从向量中取出时，您可能会越界。

我认为该功能没有任何问题。

请提供堆栈跟踪

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T22:27:01.503

如果没有调用堆栈，确定问题所在会有点困难，但是您要么没有`Vertex<...>`正确分配，要么试图`Vertex<...>`从堆栈中释放，要么没有将它们初始化`Vertex<...>*`为有效值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T00:05:41.773

这一点让我害怕：

> 我动态声明了一个指向指针的指针数组，这些是被推送的，因为我假设 priority_queue 通过引用存储，所以如果我只是将循环中声明的指针放入队列中，则该指针超出范围。这些指针指向正确的顶点，并且存在于整个函数中。

目前尚不清楚您如何填充队列。您必须创建 Vertex 对象，并且它们必须保留在内存中并在它们在队列中的整个时间内返回相同的距离。

队列不按引用存储，它存储副本 - 但在这种情况下，您放入的是指针，因此它复制指针，该指针仍将指向您分配的原始对象。

我认为我们需要一个简短的完整示例才能进一步了解。

# clickonce - ClickOnce 与快捷方式

> ID：474838
> 
> 赞同：0
> 
> 时间：2009-01-23T22:17:03.083
> 
> 标签：clickonce, deployment

我见过一些应用程序，其“部署”策略是在服务器中拥有一个 .exe 文件，并通过来自不同“客户端”的快捷方式访问它，它运行良好。他们只担心在新版本到来时保持该 EXE 文件更新。为什么这种方法会出错？使用 ClickOnce 代替这种老式风格有什么优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T19:30:26.920

当心怀不满的乔决定在整个组织中传播大规模病毒并用恶意病毒替换您友好的 .exe 时会发生什么？ClickOnce 通过证书验证阻止了这一点。

还...

ClickOnce 有一个先决条件检查系统。您没有数据访问组件？您甚至没有 .NET Framework 2.0？没问题！它安静地安装先决条件。

暂时想不出任何其他原因，但这些都是重要的原因。

编辑：此外，ClickOnce 安装可以在与网络断开连接时运行的本地副本。运行本地副本时，它会自动检查任何更新，为用户提供更新到新版本或运行当前版本的选择。如果我没有记错的话，这可以配置为在程序启动时或程序关闭时完成。

嗯。。还有什么。。

通过像这样在网络上运行 .exe，您可能会在修改运行 .exe 的 PC 的文件系统时遇到问题。ClickOnce 没有任何问题，因为它是在本地运行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T22:35:17.230

在网络驱动器上共享文件可能会导致文件锁定问题，并且可能根本无法工作，具体取决于安全策略和 Windows 版本。

# c++ - boost vs ACE C++ 跨平台性能比较？

> ID：474840
> 
> 赞同：19
> 
> 时间：2009-01-23T22:18:18.870
> 
> 标签：c++, performance, boost, cross-platform, ace-tao

我参与了一项将一些通信、解析、数据处理功能从 Win32 移植到 Linux 的项目，并且两者都将得到支持。问题域对吞吐量和性能非常敏感。

我对 boost 和 ACE 的性能特征的经验很少。具体来说，我们想了解哪个库为线程提供了最佳性能。

任何人都可以提供一些关于两者之间相对表现的数据——记录在案的或口口相传的，或者可能是一些链接吗？

编辑

谢谢大家。确认了我们最初的想法——我们很可能会为系统级跨平台的东西选择 boost。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-23T22:26:01.943

与使用本机操作系统线程设施相比，这两个库都不应该有任何开销。你应该看看哪个 API 更干净。在我看来，boost 线程 API 更容易使用。

ACE 更倾向于“经典的 OO”，而 boost 则倾向于借鉴 C++ 标准库的设计。例如，在 ACE 中启动一个线程需要创建一个从 ACE_Task 派生的新类，并覆盖线程运行时调用的虚拟 svc() 函数。在 boost 中，您创建一个线程并运行您想要的任何功能，这大大减少了侵入性。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-08T07:42:57.337

帮自己一个忙，避开 ACE。如果你问我，这是一个不应该被编写的可怕的、可怕的图书馆。我已经工作（或者更确切地说是不得不使用它）3 年了，我告诉你它是一个设计糟糕、文档记录不充分、实现不善的垃圾，使用过时的 C++ 并建立在完全脑死亡的设计决策之上......调用 ACE “C with classes”实际上是在帮它一个忙。如果您查看它的某些构造的内部实现，您通常很难抑制您的呕吐反射。此外，我不能足够强调“糟糕的文档”方面。通常，ACE 记录函数的概念包括简单地打印函数的签名。至于它的参数的含义、它的返回值和它的一般行为，那么你 通常让你自己解决这个问题。我厌倦了不得不猜测函数可能抛出哪些异常，哪个返回值表示成功，我必须传递哪些参数才能使函数执行我需要它执行的操作，或者函数/类是否是线程安全的或不。

另一方面，Boost 使用简单，现代 C++，文档非常完善，而且它可以正常工作！Boost 是要走的路，用 ACE 打倒！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-24T01:45:34.037

不要担心操作系统抽象层在线程和同步对象上的开销。线程开销实际上根本不重要（因为它只适用于线程创建，与 pimpl 化指针间接的开销相比，这已经非常慢了）。如果您发现互斥操作让您放慢了速度，那么您最好查看原子操作或重新安排您的数据访问模式以避免争用。

关于 boost 与 ACE，这是“新式”与“旧式”编程的问题。Boost 有很多仅基于标头的基于模板的恶作剧（如果您能欣赏的话，使用起来很漂亮）。另一方面，如果您习惯于 C++ 的“C with classes”风格，那么 ACE 会感觉更自然。我相信这主要是您团队的个人喜好问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-10-16T09:34:16.707

我已经将 ACE 用于许多重型生产服务器。它从来没有让我失望过。它坚如磐石，现在已经工作了很多年。尝试学习了BOOST的ASIO网络框架——学不来。虽然 BOOST 是更“现代”的 C++，但它也更难用于不平凡的任务 - 如果没有“现代”C++ 经验和深厚的 STL 知识，很难正确使用

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-08T19:36:06.223

即使 ACE 是一种老式的 C++，它仍然有许多 boost 还没有提供的面向线程的特性。

目前我认为没有理由不使用两者（但用于不同的目的）。一旦 boost 提供了一种简单的方法来实现任务之间的消息队列，我可能会考虑放弃 ACE。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-21T21:01:52.757

When it comes to ease-of-use, boost is way better than ACE. boost-asio has a more transparent API, its abstractions are simpler and can easily provide building blocks to your application. The compile-time polymorphism is judiciously used in boost to warn/prevent illegal code. ACE's uses of templates, on the other hand, is limited to generalization and is hardly ever user-centric enough to disallow illegal operations. You're more likely to discover problems at run-time with ACE.

A simple example which I can think of is ACE_Reactor - a fairly scalable and decoupled interface- but you must remember to call its "own" function if you're running its event loop in a thread different from where it was created. I spent hours to figure this out for the first time and could've easily spent days. Ironically enough its object model shows more details than it hides - good for learning but bad for abstraction.

[https://groups.google.com/forum/?fromgroups=#!topic/comp.soft-sys.ace/QvXE7391XKA](https://groups.google.com/forum/?fromgroups=#!topic/comp.soft-sys.ace/QvXE7391XKA)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-24T01:19:15.277

线程实际上只是 boost 和 ACE 提供的一小部分，两者总体上并没有真正的可比性。我同意 boost 更容易使用，因为 ACE 是一个相当沉重的框架。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-05T19:39:28.917

我不会将 ACE 称为“C with classes”。ACE 并不直观，但如果您花时间按预期使用该框架，您将不会后悔。

据我所知，在阅读了 Boost 的文档之后，我想使用 ACE 的框架和 Boost 的容器类。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-30T12:25:45.123

使用 ACE 并协同提升。ACE 有更好的通信 API，基于 OO 设计模式，而 boost 有类似“现代 C++”的设计，并且可以很好地与容器配合使用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-26T01:33:00.403

我们开始使用 ACE，相信它会隐藏 TCP 套接字和 select 调用中 windows 和 unix 之间存在的平台差异。事实证明，事实并非如此。Ace 的选择，反应器模式，不能在 Windows 上混合套接字和标准输入，并且平台之间关于套接字可写通知的语义差异仍然存在于 ACE 级别。

当我们意识到这一点时，我们已经在使用 ACE 的线程和进程特性（后者并没有像我们希望的那样隐藏平台差异），因此我们的代码现在绑定到一个巨大的库，实际上阻止将我们的代码移植到 64 位 MinGW！

我等不及代码中最后一次使用 ACE 的那一天终于被不同的东西取代了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-29T21:54:45.000

我已经使用 ACE 很多年了 (8)，但我刚刚开始为我的下一个项目再次调查使用 boost。我正在考虑提升，因为它有一个更大的工具包（正则表达式等），并且它的一部分正在被 C++ 标准所吸收，因此长期维护应该更容易。也就是说，提升将需要一些调整。尽管 Greg 提到线程支持的侵入性较小，因为它可以运行任何（C 或静态）函数，但如果您习惯使用更类似于 ACE_Task 提供的 Java 和 C# 线程类的线程类，您有使用一点技巧来获得相同的提升。

# c# - 动态获取参数类型的默认值

> ID：474841
> 
> 赞同：8
> 
> 时间：2009-01-23T22:18:30.257
> 
> 标签：c#, reflection, dynamic

## 问题

我正在尝试动态获取在 ParameterInfo 中指定的类型的默认值。_methods[methodName] 返回一个 MethodInfo 对象。

不幸的是，编译器不喜欢默认（paramType）中的“paramType”位。我难住了。

## 错误

> 找不到类型或命名空间名称“paramType”（您是否缺少 using 指令或程序集引用？）
> 
> C:\Applications\...\MessageReceiver.cs 第 113 行

## 例子

```
object blankObject = null;
foreach (var paramInfo in _methods[methodName].Key.GetParameters())
{
    if (paramInfo.Name == paramName)
    {
        Type paramType = paramInfo.ParameterType;
        blankObject = (object)default(paramType);
    }
}
parameters[i] = blankObject; 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-23T22:26:40.960

实现起来非常简单：

```
public object GetDefault(Type type)
{
    return type.IsValueType ? Activator.CreateInstance(type) : null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T22:22:22.653

我认为 default 仅适用于实际类型。这是一个编译器快捷方式，而不是实际方法。它适用于泛型。例如：

```
public void MyMethod<T>(T obj)
{
   T myvar = default(T);
} 
```

看看我不久前发布的这个问题：

[泛型的默认值](https://stackoverflow.com/questions/354136/default-value-for-generics)

# javascript - 如何显示谷歌地球旧世界地图（或空白/物理世界地图）的谷歌地图平铺覆盖？

> ID：474842
> 
> 赞同：1
> 
> 时间：2009-01-23T22:20:44.433
> 
> 标签：javascript, google-maps, geography

我正在尝试构建一个谷歌地图驱动的网络应用程序，它可以以以下一种或所有配置显示整个世界的地图：

*   大陆轮廓图，仅区分陆地和水域（像[这样](http://maps.google.com/?ie=UTF8&ll=-0.703107,-1.40625&spn=151.859736,305.859375&z=2)，但没有国家边界/名称，放大时没有显示任何其他细节）
*   世界的自然地理地图，绝对不包含道路、城市或政治边界（因此默认卫星地图已失效 - 如果我无法让其他任何工作，我正在考虑限制缩放级别，以便您不能靠得足够近，看不到现代特色）
*   [此处](http://www.gearthhacks.com/dlfile4943/Old-Map-of-the-World.htm)和[此处](http://www.gearthhacks.com/dlfile4729/Kirchers-world.htm)显示的与 Google 地球相同的旧世界地图。

[使用 Rumsey Collection ( qv](http://rumsey.geogarage.com/maps/CassiniWorldGlobe1790.html) )中的旧地图可以实现与我所追求的类似的效果，这些地图非常出色，但相当占用带宽，并显着降低了 GMaps 的性能。更简单、细节更少的图像更适合我的目的。

有没有一种有效的方法可以将项目符号 3 中的那些跨越世界的 KMZ 图形文件加载为图块集？

物理或基于轮廓的地图怎么样？如有必要，如果存在免费可用的起始地图，则可以遵循 GMaps 指南来雕刻 .png 文件来表示每个图块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T06:37:16.060

这是关于构建自定义平铺地图的教程： [http ://webtide.wordpress.com/2008/08/27/custom-google-maps/](http://webtide.wordpress.com/2008/08/27/custom-google-maps/)

这似乎是用于创建自定义平铺地图的服务：http: [//www.maplib.net/](http://www.maplib.net/)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T12:44:17.440

您还可以使用开源 MapTiler 应用程序 - [http://www.maptiler.org/](http://www.maptiler.org/)或命令行实用程序 gdal2tiles。

# sql - SQL友元函数

> ID：474843
> 
> 赞同：2
> 
> 时间：2009-01-23T22:21:26.180
> 
> 标签：sql

构建朋友“功能”的最佳方式是什么。
这就是我的想法：假设我有一个包含以下列的用户表：user_id、用户名、密码......和一个以朋友的名字命名的表，列：friend1、friend2、接受。

如果 user2 添加 user1 我希望 user2 显示在 user1 的个人资料上，而 user1 显示在 user2 的...：O

这似乎有点乱......有没有更聪明的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T22:27:46.340

```
CREATE TABLE (friend_id_a, friend_id_b, accepted) 
```

定义一个约束：`friend_id_a < friend_id_b`.

使用您的实体填充表，如下所示：

```
INSERT
INTO friend_friend(friend_id_a, friend_id_b)
VALUES (LEAST(@id1, @id2), GREATEST(@id1, @id2)) 
```

选择一个人的所有朋友：

```
SELECT friend_id_b
FROM friend_friend
WHERE friend_id_a = @id
 AND accepted
UNION ALL
SELECT friend_id_a
FROM friend_friend
WHERE friend_id_b = @id
 AND accepted 
```

此处的 UNION ALL 允许您使用索引并避免对唯一性进行额外排序。

以上所有对于作为对称和反自反关系的“友谊”都是有效的。这意味着：

*   如果**a**是**b**的朋友，则 **b**是**a的朋友**

*   **a**永远不是a的**朋友**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T22:28:08.757

我觉得你的设计很好。第二个表`friends` （主键`friend1`, ），如果“和之间的友谊即将建立”，则存在`friend2`一行`f1`，如果实际上已经建立，则为 True，是表示多对多关系的正确方法.`f2``f1``f2``accepted`

（幼稚方法的唯一问题是当您必须*检查*that`f1`是`f2`'s 的朋友时：这可能意味着 row存在，`f1`或者*row*存在。为克服这个困难向 Quassnoi +1。）`f2`*`f2``f1`*

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T22:28:57.693

我不知道您是指一个为每个朋友提供一列的大表，还是像下面这样的两个表，但后者是最好的。

```
[dbo].[Users]{
    User_ID int,
    UserName VarChar,
    Password ...
}

[dbo].[Friends]{
    User1_ID int,
    User2_ID int,
    Accepted bit
} 
```

# powershell - PowerShell 是批处理文件的良好升级吗？

> ID：474849
> 
> 赞同：25
> 
> 时间：2009-01-23T22:23:43.820
> 
> 标签：powershell, batch-file

我使用批处理文件 (Windows) 将我们的服务器版本打包成 zip 文件，运行 WinZip 的命令行版本。以前我们是“手动”做这种事情的，但我开发了使用批处理文件自动化它的过程。

批处理文件变得相当复杂，因为我们的产品很复杂（即，我们这次发布了哪些部分？我们是否也发布了配置文件？）而且我开始遇到批处理文件的一些令人沮丧的限制。

将 PowerShell 作为批处理文件的“升级”进行调查是一件好事吗？或者考虑到它所做的大部分工作是触发 DOS 命令，这是否完全是矫枉过正？

奖励：PowerShell 可以使用 .NET 程序集吗？例如，我可以开始使用 SharpZip 进行压缩吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T22:27:43.453

如果你有一个可行的解决方案，那么你*不需要*去 powershell。话虽如此，如果您打算进行更改或改进流程，那么我强烈推荐使用 powershell。Powershell 可以访问 .Net 程序集……主要是。某些程序集的结构使其比其他程序集更困难。

如果您决定查看 powershell，可以[在此处查看一些资源。](https://stackoverflow.com/questions/33559/how-to-get-started-with-powershell)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-25T20:46:44.443

最初，我对 PowerShell 感到非常兴奋。最后是一个强大的 Windows 原生 shell。然而，我很快意识到，与你最喜欢的 unix shell 相比，PowerShell 实在是太冗长了。与使用 bash 和用于 Win32 的 GNU 工具所做的相比，即使是做简单的事情也需要太多的输入。

我喜欢这样的想法，即 shell 知道不同的类型，但如果我需要做很多额外的工作，我更喜欢使用各种 unix 流编辑器获取必要的数据。

**编辑**：我刚刚又看了一遍 PowerShell，我不得不承认，它确实有一些非常有用的功能，而这些功能对于传统的 unix 风格的工具来说是不可用的。

一方面，PowerShell 拥有所有命令，这意味着它可以提供一组更加连贯的功能。参数统一处理，可以使用通配符搜索命令、参数等，非常有用。

第二个重要功能是 PowerShell 允许您枚举通常不可用于流编辑器的源，例如 Windows 注册表、证书存储等。当然，您可以使用工具为您执行此操作并将其显示为文本，但 PowerShell 方法非常优雅 IMO。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-24T15:18:33.007

看看 PowerShell Community Extensions (PSCX)，它是免费的，它有 Zip cmdlet：

写邮编

写-BZip2

写-GZip

[http://www.codeplex.com/PowerShellCX](http://www.codeplex.com/PowerShellCX)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T13:40:57.123

您应该观看与PowerShell 创建者和架构师[Jeffrey Snover 的演示/讨论。](http://channel9.msdn.com/shows/Going+Deep/Expert-to-Expert-Erik-Meijer-and-Jeffrey-Snover-Inside-PowerShell/)如果您对技术细节（有很多“哇”的时刻）不感到惊讶，那么您会对 Jeffrey 的热情感到惊讶:)。一旦掌握了基础知识，就很容易使用 PowerShell 提高工作效率。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T22:40:25.517

答案是肯定的——PowerShell 可以使用 .NET 程序集。如果您需要连接代表，v1 中涉及到一些有趣的事情，而 v2 使这更加干净。

只需调用 LoadFile / LoadAssembly 即可在内存中获取适当的库，然后您就可以走了

```
[Reflection.Assembly]::LoadFile('/path/to/sharpzip.dll')
$zip = 新对象 ICSharpCode.SharpZipLib.Zip.FastZip
$zip.CreateZip('C:\Sample.zip', 'C:\BuildFiles\', 'true', '^au')
# 注意 - 我实际上并没有测试这段代码
# 我没有下载 SharpZip - 只需阅读他们的参考资料。

```

另请注意，[PowerShell 社区扩展](http://www.codeplex.com/PowerShellCX)支持各种压缩方法，例如 write-zip。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-24T15:47:09.173

我试图用 power shell 替换我使用的冗长的构建批处理文件之一。我觉得这很痛苦：至少在那个时候，文档专注于有趣的措辞以及你可以用它做什么很酷、很糟糕的事情，但在“完成简单的事情”类别中缺乏。我得到了它的工作，但错误处理是不稳定的。

YMMV，试试powershell，你可能会喜欢它。但在更新构建批次之前尝试一下。

我的解决方案：使用 C# 控制台应用程序。我有严肃的日志记录、异常处理、可以使用我的实用程序功能，如果某些东西不起作用，我有一个真正的调试器。这是我*喜欢*修改的第一个解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T22:26:43.173

我不确定 powershell，但我是否可以推荐使用 IronPython（如果你想访问 .NET 库）或普通 python 之类的东西？您将获得一种成熟的编程语言，几乎没有限制。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-25T20:36:11.030

一方面，如果它有效，就离开它。但听起来这是随着时间的推移你会添加的东西，当然你最终需要编辑批处理文件的继任者/同事也需要理解它。如果您具有编程背景，那么您可能会发现 Powershell 的强大功能使您的脚本更短且更易于阅读/维护（例如，即使只有完整的 if 语句和 for/while 循环）。另一方面，如果您对编程不太熟悉，很多人会发现 Powershell 乍一看有点令人生畏。

关于 .NET 部分，Powershell 构建在 .NET 之上，所以是的，您可以访问 .NET 程序集（但您应该始终先查看是否有可用的 cmdlet）。

我会推荐一本名为“The Powershell Cookbook”的书，作者是 Lee Holmes，由 O'Reilly 出版。它提供了可用于常见任务的“食谱”；这可能会加快您实现脚本的时间，并且它会一路教您 Powershell。

# c++ - 计算 C++ 标头中定义的方法数

> ID：474867
> 
> 赞同：3
> 
> 时间：2009-01-23T22:27:43.233
> 
> 标签：c++

是否有工具可以计算标题中定义的方法数量？这似乎是人们不时想要做的事情，但我从未听说过这样的实用程序。*我可以自己动手（在这种*特殊情况下很容易想出适合我的东西），但我想我会先尝试 stackoverflow :)

谢谢，易

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T22:43:03.017

试试这个：

```
ctags --c++-kinds=f -x myfile.h 
```

列出文件 myfile.h 中的所有函数。要计算 中的函数数量`deque.tcc`：

```
$ ctags --c++-kinds=f --language-force=c++ -x deque.tcc | wc -l
24 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T22:32:44.847

我不知道 doxygen 是否 --> [http://www.doxygen.nl/](http://www.doxygen.nl/)这样做，但如果它也这样做，我不会感到惊讶。

它从头文件 + javadoc（如注释）生成文档。

它也会找到功能，所以有点计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-24T04:04:57.843

您可以编写 Visual Studio 插件。您可以在其中访问每个类以及其中的每个方法。这使用了 COM 技术和 Visual Studio 可扩展性功能。

编辑：我从未见过有问题的标签可可。此答案仅适用于 Visual Studio

# .net - 每个开发人员的工具箱中应该有哪些可重用的代码？

> ID：474878
> 
> 赞同：8
> 
> 时间：2009-01-23T22:30:19.640
> 
> 标签：.net, code-reuse

我正在尝试建立一个可重用代码库以在项目之间使用。当我编写代码片段和组件时，我试图决定哪些库我会从长期 VS 中得到最多的使用，我真的会再次使用它吗？

每个开发人员都应该重用哪些代码或组件？

我主要对.net web 和winforms 感兴趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-23T22:41:42.723

用于验证的正则表达式

*   有效日期
*   有效号码
*   两个日期之间
*   压缩
*   邮政
*   年龄
*   号码范围

取决于语言，因为有些已经具备这些功能

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-24T00:00:41.627

*nix 操作系统（Unix、Solaris、Linux、MacOS、Cygwin）和它的“经典”命令行实用程序集。

合并、混合、烘焙、粉碎和滥用这些基本概念的方式是无法估量的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T22:37:42.217

我个人认为一个好的框架应该提供这些工具，而不是你。如果不是语言的默认库（Java 就是一个很好的例子）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T22:42:38.023

这取决于您编写的应用程序类型。所以我认为没有任何问题的真正工具箱。（或者它应该是框架）。

我们有几个应用程序和一个跨应用程序库。其中包含大量代码：

*   打印功能。
*   形状处理（我们对形状和多边形做了很多工作）
*   分贝计算
*   一般应用程序行为（housestyle）。

每次我们在一个应用程序中有一些可能对其他应用程序有用的东西时，它就会被移到库中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T23:35:40.943

*   数据库池代码
*   日志记录
*   字符串和集合操作
*   IoC 维护（注解或 XML）
*   文件和目录处理

其中一些可能随 VM 或标准库一起提供，但您总是需要一些额外的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-24T04:05:25.437

一段时间以来，我一直致力于为 c# 创建一组可重用的代码。通过一次添加 1 个组件，更重要的是，将框架用于真正的应用程序，我终于使框架变得简单、有据可查，并带有各种易于反复使用的“模块”。

[在 CodePlex 上的 CommonLibrary.NET 上](http://commonlibrarynet.codeplex.com)查看

它比 SpringFramework 和 MS App Blocks 更简单、更轻量级。

它包括以下内容：1\. 参数/选项解析 2\. ActiveRecord/域模型类 3\. 集合 4\. 验证等等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T22:35:57.117

我很容易想到：

*   链表模板
*   红黑树模板
*   数据库初始化 mini-api（用于您喜欢的数据库或持久层）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-23T22:41:33.143

我认为这将根据语言和您可能使用的框架必须提供的内容而有很大不同。许多所需的可重用代码将位于现代框架中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-23T23:03:46.330

答案取决于**你的**目标——通常使某些东西“可重用”在开始时需要更多的努力，但当然，在重用时会得到回报——当然，前提是它是**真正**可重用的。有时这种能力被高估了... IMO ...

这个问题的真正答案将在你编写代码时得到解答——当你发现自己说，哎呀，我上周刚刚写了这样的东西。

我的“工具箱”由字符串、数学、网络、数据库、文件、日志记录和许多其他“库”例程（程序集等）组成，我可以快速将其作为参考。当然，使它成为一个活库的关键是让这些库项目的代码真正与正在开发的应用程序/代码分开。

希望能帮助到你 ...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-20T16:54:52.830

好问题

1.  业务对象级缓存
2.  我自己的自定义身份验证工具包
3.  jQuery 选择器
4.  用于表单、选项卡和 ui 元素的 css
5.  密码等的加密和散列

虽然我开始用企业库替换我的东西 - [http://msdn.microsoft.com/en-us/library/cc467894.aspx](http://msdn.microsoft.com/en-us/library/cc467894.aspx) - 它至少随着时间的推移得到改进并且比它有更多的关注我的实现

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T22:55:25.753

在 .Net 中：

*   .Net Framework 中没有的扩展方法（ForEach、AddRange、RemoveWhere 等）
*   [Switch.Type](http://blog.ashmind.com/index.php/2007/09/20/simple-typeswitch-in-c-30-part-2-the-solutions/)语句（针对访客）
*   基本参数验证 (Argument.EnsureNotNull)

这几乎是全部，各种免费库覆盖了其余部分。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-23T23:48:13.993

PKI 认证

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-24T00:58:17.207

我的两个：

*   **依赖注入**代码，让你可以让它更可测试；并且不依赖于单例的单个实现。

*   模块化/**插件**功能。让它可模拟也是一个好主意，这样您的客户端代码就可以在不调用成熟的插件系统的情况下进行测试。

两者都有几种实现，但有时您无法避免自己编写。:(

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-24T12:16:22.827

解析类

日期操作类

消息类

验证类

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-09T12:43:50.027

作为一个疲倦和心怀不满的代码维护者，我会以不同的方式看待这个问题：项目需要使用什么代码，以避免七个*开发人员创建七个不同的解决方案，当某些事情发生变化时需要七处修改（在发现有七个不同的解决方案）。

我想大多数人将重用视为初始开发中的一种效率工具，而忘记了它也是高效维护的关键。

*我认为只有七个，但我仍在测试中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-09T12:48:32.077

一个可以处理货币、分配、算术运算和格式化的 Money 类。

# image-processing - 开源机器视觉库

> ID：474881
> 
> 赞同：12
> 
> 时间：2009-01-23T22:33:40.850
> 
> 标签：image-processing, open-source, computer-vision

确实存在哪些免费/开源机器/计算机视觉库？

# 答案摘要

## 图书馆

*   [开放式CV](http://sourceforge.net/projects/opencvlibrary/)
    *   [简单CV](http://simplecv.org/)
*   [VxL](http://vxl.sourceforge.net/)
*   [VLFeat](http://www.vlfeat.org/)
*   [化学气相沉积](http://savannah.nongnu.org/projects/libcvd)
*   [冰翼](http://icewing.sourceforge.net/)
*   [CImg](http://cimg.sourceforge.net/)
*   [运动](http://www.lavrsen.dk/foswiki/bin/view/Motion/WebHome)
*   [ccv](http://libccv.org/)

## 其他

*   [RoboRealm 视觉软件应用程序](http://www.roborealm.com/links/vision_software.php)
*   [维基百科：SIFT 实现列表](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform#External_links)
*   [Stack Overflow：什么是最好的图像处理库](https://stackoverflow.com/questions/158756/what-is-the-best-image-manipulation-library/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T22:43:19.177

您使用什么语言？[VLFeat](http://www.vlfeat.org/)对于 C++ 来说似乎是一个非常好的（并且积极维护），尽管我实际上并没有使用它。我主要熟悉 SIFT -[维基百科文章](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform#Implementations)底部列出了许多实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-28T16:58:33.120

libCVD [http://savannah.nongnu.org/projects/libcvd](http://savannah.nongnu.org/projects/libcvd)

Cambridge Video Dynamics - 用于图像、视频捕获、显示、计算机视觉等的库。与 TooN 很好地集成，用于线性代数框架。语言：C++

这是积极开发的，并且有很多有用的特性和算法，而且通常这些人让事情工作得非常快。

它是 LGPL。

可以在 Win、Linux 和 MacOS X 上编译它。

还有一个意图是为 Python 提供端口，以允许非常快速地使用 Python 和 SciPy 对计算机视觉算法进行原型设计（我不确定现在处于哪个阶段，但在 Python 会议上有一篇关于它的论文.)

如果你想实时做任何事情，你应该认真考虑 libCVD。

例如，Georg Klein 的 PTAM（Parallel Tracking And Mapping）框架就使用了这个库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T15:41:32.133

RoboRealm 编制了大量[视觉](http://www.roborealm.com/links/vision_software.php)软件。

[这个较旧的问题](https://stackoverflow.com/questions/158756/what-is-the-best-image-manipulation-library/647637#647637)提到了很多图书馆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-28T17:10:22.387

我的大学与 IceWing 合作，为视觉任务制作快速原型，用于添加任务，使它们产生链并具有用于查看结果等的 GUI。该库被广泛用于在比勒费尔德开发的所有机器人中的视觉相关任务

[你可以在这里](http://icewing.sourceforge.net/)找到图书馆

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-01T17:00:42.337

如果您正在编程 C++，您可以查看[CImg](http://cimg.sourceforge.net/)。虽然它可能不是最优化的库，但我发现它对用户友好。它也很整洁，它不会强迫您部署额外的 dll。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T15:55:50.540

如果您只需要运动检测，则可以使用[Motion](http://www.lavrsen.dk/twiki/bin/view/Motion/WebHome)

# c# - 如何在 ASP.NET 应用程序中运行 C# 主程序

> ID：474889
> 
> 赞同：2
> 
> 时间：2009-01-23T22:35:47.540
> 
> 标签：c#, asp.net, testing

我正在使用 Visual Studio 2008 开发一个 ASP.NET 2.0 应用程序。

如果我想对后端中的方法进行非常快速的测试，有没有办法让我通过命令行调用该类中的主函数？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T22:37:40.547

简短回答：[NUnit](http://www.nunit.org/)。你可能不知道如何使用它，但你应该知道。使用和学习并不难。它速度很快，并且有一个 GUI。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T22:37:25.663

这就是测试项目的目的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T23:01:38.300

您应该获得[TestDriven.NET](http://testdriven.net/)插件（免费供个人使用）。基本上，它是一组测试驱动开发工具，例如 NUnit，与您的 Visual Studio 集成。我发现的一件事是，它允许您在代码中运行任何方法，只需右键单击它并选择菜单项“Run Test(s)”或“Test With -> Debugger”，如果你想调试方法。

[![替代文字](https://i.stack.imgur.com/308W4.png)](https://i.stack.imgur.com/308W4.png)

希望有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T22:41:37.043

答案是否定的，你不能那样做。每个程序集只能有一个主要功能。

事实是，你不应该那样做测试。C# 不是 Java，不管它起源于 Java。

改用 NUnit 或 MSUnit 并构建单元测试。他们将为您测试您的方法，而无需部署到网站或类似的东西。这是测试方法的最佳方式。以下是一些链接：

[单元](http://www.nunit.org/index.php)

[MSUnit](http://msdn.microsoft.com/en-us/library/ms243147.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T22:39:09.437

只需创建一个测试项目并从那里进行测试。如果不是，您可以创建一个控制台应用程序并通过引用正确的项目从那里测试它（考虑到您要测试的代码在程序集中），这在某种程度上将是您的测试项目。

# eclipse-plugin - 从 eclipse 3.2 中清除插件的最佳方法

> ID：474890
> 
> 赞同：1
> 
> 时间：2009-01-23T22:35:47.913
> 
> 标签：eclipse-plugin, rad

由于 eclipse 3.2 的配置管理器和更新管理器没有删除或删除我所有插件的好选项，因此需要按顺序处理插件可能很麻烦。当您安装的版本比您所需要的高（取决于您正在开发的 jdk 版本）时，仅仅解决您的依赖关系可能是一场噩梦。

除了删除插件和功能目录中的文件（有时有效）之外，我们在 M$ 环境中还有哪些其他选项？

在您使用 RAD 7 的情况下，您也必须处理共享的 SDP70Shared 文件夹，这也有点空灵。

我希望看到一种简单的方法来清理常规 eclipse 3.x、RAD 或任何可以工作的一体化软件包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T23:34:24.927

Eclipse 3.2 对 Help->Software updates->Manage configuration 下的插件具有“卸载”功能。

Eclipse 3.4 在 Help->Software updates->Installed software 下具有相同的功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T23:02:27.610

您可以完全卸载 eclipse 并使用自定义 eclipse 构建器（如[http://www.yoxos.com/ondemand/]](http://www.yoxos.com/ondemand/]) [1](http://www.yoxos.com/ondemand/)使用您使用的基本插件集创建构建。我不记得 eclipse 在 Windows 中是如何配置的，但在 Linux 中，您的工作空间中通常有一个隐藏的项目目录，您可能需要删除它以防万一。我不确定您是否需要担心任何注册表设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T15:13:16.057

到目前为止，我发现的最佳解决方案是从头开始卸载和重建。有时您可以删除插件目录中的文件并在注册表上运行 CCleaner，这可能会解决问题，但根据情况会出现问题。如果有一个真正可以理解 eclipse 插件的应用程序，每个人都会使用它，但没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-16T19:15:22.630

虽然不建议手动删除由 p2 管理的插件，但我发现定期清理插件可以极大地提高性能和可发布性，尤其是在您复制主 eclipse 配置并与多个开发人员共享的情况下。在这种情况下，最好只归档主 eclipse 安装，而不是依赖每个人同步更新他们的配置。

看

[如何删除旧版本的 Eclipse 插件？](https://stackoverflow.com/questions/221476/how-to-remove-old-versions-of-eclipse-plugins)

# pdf - DocBook 是否应该用于发布英语和阿拉伯语的技术文档？

> ID：474894
> 
> 赞同：2
> 
> 时间：2009-01-23T22:36:59.440
> 
> 标签：pdf, publishing, arabic, docbook

我正在寻找用于以英语和阿拉伯语（在同一文档中）发布技术文档的理想工具。我应该使用 DocBook，还是坚持使用 TeX/LaTeX 更好？我是这两个系统的完整初学者，因此无需担心遗留问题。对我来说最重要的两个因素是易于使用和对阿拉伯语的支持。通过易用性，我的意思是我不介意设置 XML 文档等，但对于日常写作，我宁愿不处理手动编码 XML，这是一个很好的编辑器，可以让您了解文档的排序方式的外观将是理想的。我希望输出是可打印的 PDF 以及 HTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T22:58:33.110

[那么，XeTeX 化身中的TeXLive](http://www.tug.org/texlive/) CD/DVD/bundle 中的TeX/LaTeX肯定能够处理阿拉伯语，请参阅[这些示例](http://www.tug.org/mactex/src/Demos/XeTeX-showcase/00Start-Here.html)。我不确定是否所有 DocBook 实用程序（如编辑器和 fop 之类的东西）都符合此要求。

# java - 在 Java 中创建数组时是否调用了 Object 构造函数？

> ID：474896
> 
> 赞同：9
> 
> 时间：2009-01-23T22:37:21.373
> 
> 标签：java, arrays, object, instrumentation, construction

在 Java 中，数组是一个对象。我的问题是......创建新数组时是否调用了 Object 构造函数？我们想使用这个事实来使用一些额外的字节码来检测对象构造函数，以检查正在构造的数组的长度。那行得通吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T22:54:33.197

根据[JVM 规范](http://java.sun.com/docs/books/jvms/second_edition/html/Compiling.doc.html#4091)：“数组是使用一组不同的指令创建和操作的。” 因此，虽然数组是对象的实例，但它们的初始化方式与其他对象的初始化方式不同（如果从该链接锚向上滚动，您可以看到）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-15T15:57:53.000

就Java语言规范而言，虽然都使用了`new`关键字，但[类实例创建表达式](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.9)和[数组创建表达式](http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.10.1)是不同的表达形式，各有各的规则。数组创建表达式的描述没有提到调用构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T22:43:45.620

我不这么认为，因为您无法派生本机数组来覆盖构造函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T22:56:22.583

您可以使用字节码操作将检查放置在创建新数组的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T23:26:16.470

没有。我在 AspectJ 邮件列表中找到了这个：http: [//dev.eclipse.org/mhonarc/lists/aspectj-users/msg02975.html](http://dev.eclipse.org/mhonarc/lists/aspectj-users/msg02975.html)。

您可能出于某种原因询问数组，但如果可以，为什么不切换到集合类。这将为您提供很多拦截和验证的机会。

# javascript - HTML 中的垂直换行

> ID：474901
> 
> 赞同：7
> 
> 时间：2009-01-23T22:37:58.020
> 
> 标签：javascript, html, css

我正在寻找一种进行垂直包装的好方法。我的目标是将复选框列表放入 div 中。我的复选框按字母顺序排序，我希望列表从 div 的顶部流到底部，然后在它们到达底部时在新列中重新开始。现在，我可以通过在将列表输入到我的 html 模板之前，在服务器端将列表分成预定义大小的块来实现这一点。但是，当列表变得太长以至于您必须滚动时，事情就会变得一团糟。我希望强制它只水平滚动。这并不容易，因为我将每个块都保存在一个浮动 div 中，所以 white-space:nowrap 似乎并没有削减它。目前，我 m 使用 javascript 计算列表块的数量并扩展中间容器的宽度（在用作视口但包含包含数据的 div 的 div 内）。我想要看起来大致像这样的东西：

```
 __________________________
| []..... []..... [].....  |
| []..... []..... [].....  |
| []..... [].....          |
| []..... [].....          |
|__________________________|
|<|_____________|___||___|>| 
```

所以我想我有两个问题：

1.  有没有一种垂直包装列表的好方法？
2.  当数据对于视口而言太大时，是否有一种强制水平滚动的好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-24T11:43:57.697

我会使用[CSS3 列](http://www.w3.org/TR/css3-multicol/)。然而，到目前为止，只有 WebKit（Safari、Chrome、...）和 Gecko（Firefox、...）实现了它，您必须添加它们各自的供应商前缀 ( `-moz-column-width:...; -webkit-column-width:...;`) 才能使其工作。

如果 IE*必须*获取列，浮动 div 可能是最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T22:42:16.030

我会因为这样说而被下地狱，但是......使用一张**桌子**！

好吧，这不是最漂亮的方法，但我想它可以解决您的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T22:51:22.827

我使用这块 Xsl 来生成具有固定行数的表：-

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" encoding="UTF-8" />
<xsl:variable name="rowCount" select="6" />
<xsl:template match="/*">
    <table rules="all">
        <xsl:for-each select="item[position() &lt;= $rowCount]">
            <tr>
                <xsl:for-each select=". | following-sibling::item[position() mod $rowCount = 0]">
                    <td><xsl:value-of select="." /></td>
                </xsl:for-each>
            </tr>               
        </xsl:for-each>
    </table>
</xsl:template>

</xsl:stylesheet> 
```

您可以将 rowCount 变量替换为参数。然后，您需要计算视口的垂直客户端高度将占用多少行（请记住，当水平滚动条出现时，您会松动一些，我会使其始终可见）。

这可以适应一组浮动 div，但我不会打扰。您的视口只需要是一个具有固定高度/宽度和溢出-x:scroll 的 div；溢出-y：隐藏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T19:42:20.510

要管理视口的滚动，您可以设置 CSS 溢出属性：

```
div#viewport{
  overflow: scroll;
  overflow-x: scroll; /* not sure if it's standard */
  height: 150px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-14T22:42:45.557

我最终使用了一点服务器端预处理。无论如何，这个站点和这个特定页面最终都需要进行大量的预处理，而且我不认为数据的大小会变得太大。

# video-capture - 演示屏幕视频捕获的建议

> ID：474927
> 
> 赞同：9
> 
> 时间：2009-01-23T22:46:01.233
> 
> 标签：video-capture

我正在为我的应用程序制作一些小的演示教程视频，以帮助用户快速上手。我过去使用过 Camtasia，但不太喜欢它。任何人都有任何建议。好的比免费更重要，但免费肯定有帮助。

我可以使用 Windows 或 Mac 来完成这项工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T22:52:12.890

[这里](http://www.codinghorror.com/blog/archives/000721.html)和[这里](http://www.smashingmagazine.com/2008/08/19/screencasting-how-to-start/)列出了一堆工具。

此外，您可能想检查以前的线程：

[什么是录制正在屏幕上播放的视频或截屏的好程序？](https://stackoverflow.com/questions/59525/whats-a-good-program-to-record-video-or-screencast-being-played-on-screen)

[截屏软件](https://stackoverflow.com/questions/24125/screencast-software)

[录制网络广播的提示](https://stackoverflow.com/questions/16763/tips-on-recording-a-webcast)

# math - 从采样的用户名中推断网站用户群规模的方法

> ID：474933
> 
> 赞同：8
> 
> 时间：2009-01-23T22:48:21.243
> 
> 标签：math, machine-learning, probability, bayesian, collective-intelligence

假设您想估计一个不公开此信息的站点的用户群规模。

人们更有可能以不同的概率获得不同的用户名。例如，如果系统上不存在用户名“nick”，则它的用户群可能非常小。如果使用用户名“starbaby”，它可能是一个更大的站点。这似乎是一个简单的贝叶斯问题。

存在不同站点可能具有不同的允许用户名空间的问题。我想最大的问题是空格等常见字符的合法性。另一个可能影响之前发布的问题是，网站是否会在你想要的名字被取走时建议名字，或者让你自己想一个更有创意的名字。

您如何建立一个跨不同规模系统的用户名出现频率的训练集？有没有办法使用贝叶斯进行数值估计而不是分类到固定宽度的桶中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T18:02:15.307

您需要做的是在给定注册用户数量的情况下准确估计某个用户名出现的概率。假设 N 是用户数，如果用户 u 存在，则 u = 1，如果用户不存在，则 u = 1。

首先，假设每个用户名的概率分布相互独立。这不会是真的 - 你已经想出了一个原因 - 但它可能是必要的，因为它使数据收集和数学变得更容易。

您将需要来自具有注册用户名的站点的大量数据以及该站点的用户总数。现在，取任何特定的用户名并想象您在 2d 绘图上的数据点（x 上为 N，y 上为 u），在 y=0 处将有一条水平线点，在 y=1 处有另一条点。您可以按照您的建议对 x 轴进行分箱，并采用箱中所有数据点的平均 y 坐标来获得离散函数，或者您可以尝试将图表上的点拟合到某些函数类别。我真的不知道那类函数会是什么——也许是某种幂律？（我在想[Zipf 定律](http://en.wikipedia.org/wiki/Zipf%27s_law "齐夫定律")）。

您现在拥有应用贝叶斯规则的概率分布。我不知道你想使用什么样的先验。均匀分布（最多一些）不会做任何假设，但我猜大多数网站的用户群都很小。

我怀疑为了完成这项工作，当您从一个站点对用户进行抽样时，您需要为一组特定的用户这样做。我敢打赌，用户名的受欢迎程度将会有一个很长的尾巴，因此随机的用户样本会给你很多非常不常用的名字，因此会有很多无用的证据。

**编辑**：我有另一个想法；在大多数论坛（以及 StackOverflow 上）中，用户具有连续的用户 ID，因此您可以使用具有大量用户的单个站点来为您提供所有较小 N 的估计值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T22:53:06.833

我认为这是一个很酷的主意！

您可以通过使用[UserNameCheck.com](http://www.usernamecheck.com/)为一些不同的用户名组合一个数据集，并将结果与​​提供它们的那些网站的规定用户群规模进行交叉引用。

*注意*：该网站似乎没有检查用户名是否对该网站有效，因此它认为 Gmail 会允许您注册“nick@gmail.com”，即使这太短了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T22:51:21.330

唯一的方法是在您知道用户群规模的系统上获取大量使用的用户名。在某些名称更常见的用户群中，数据可能会出现偏差。例如，即使是指环王论坛中的一个很小的用户群也可能包含用户名 Strider。

# python - 如何为这个 UDP 协议构建数据包？

> ID：474934
> 
> 赞同：0
> 
> 时间：2009-01-23T22:48:44.660
> 
> 标签：python, network-programming, network-protocols

[此处](http://developer.valvesoftware.com/wiki/Server_Queries)记录的 Valve Software 的 Steam 服务器查询协议允许您查询他们的游戏服务器以获取各种数据。这有点超出我的深度，我正在寻找一些关于我需要学习什么的指导。

我假设我需要[socket](http://docs.python.org/library/socket.html)和[struct](http://docs.python.org/library/struct.html)，对吗？

我对[这些](http://www.prasannatech.net/2008/07/socket-programming-tutorial.html)基本的 UDP 任务很满意，所以我想我的主要问题是如何用 struct 构造我的数据，因为我完全不熟悉它。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T00:38:19.493

我找到了自己问题的答案。耶。

[SRCDS.py](https://sourceforge.net/projects/srcdspy/)已经实现了这个，我通过查看它发现了它。

# vba - 在excel中调用web服务

> ID：474936
> 
> 赞同：27
> 
> 时间：2009-01-23T22:49:47.153
> 
> 标签：vba, excel, web-services, office-2007

在 excel 2007 的 VBA 模块中，是否可以调用 Web 服务？如果是这样，任何代码片段？我将如何添加网络参考？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-23T22:53:50.937

是的你可以！

我参与了一个这样做的项目（见评论）。不幸的是，没有来自那个的代码示例，但谷歌搜索显示了这些：

[如何使用 Excel 和 VBA 集成来自多个 Web 服务的数据](http://msdn.microsoft.com/en-us/magazine/cc163837.aspx)

[一步一步：通过 VBA（Excel 或 Word）使用 Web 服务](http://www.dotnetspider.com/resources/19-STEP-BY-STEP-Consuming-Web-Services-through-VBA-Excel-or-Word-Part-I.aspx)

[VBA：使用 Soap Web 服务](http://www.automateexcel.com/2004/11/14/excel_vba_consume_web_services/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-29T21:05:04.643

以下是 MS 的概述：

[在 Excel 2007 中使用 Web 服务](http://msdn.microsoft.com/en-us/library/dd819156.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-25T09:39:24.973

有关更新的答案，请参阅此 SO 问题：

[在 excel 2010 中使用 VBA 代码调用 Web 服务](https://stackoverflow.com/questions/3521876/calling-web-service-using-vba-code-in-excel-2010)

两个线程都应该合并。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-14T12:42:38.373

在 Microsoft Excel Office 2007 中尝试安装“Web 服务参考工具”插件。并使用 WSDL 并添加 Web 服务。并在模块中使用以下代码从 Web 服务中获取必要的数据。

```
Sub Demo()
    Dim XDoc As MSXML2.DOMDocument
    Dim xEmpDetails As MSXML2.IXMLDOMNode
    Dim xParent As MSXML2.IXMLDOMNode
    Dim xChild As MSXML2.IXMLDOMNode
    Dim query As String
    Dim Col, Row As Integer
    Dim objWS As New clsws_GlobalWeather

    Set XDoc = New MSXML2.DOMDocument
    XDoc.async = False
    XDoc.validateOnParse = False
    query = objWS.wsm_GetCitiesByCountry("india")

    If Not XDoc.LoadXML(query) Then  'strXML is the string with XML'
        Err.Raise XDoc.parseError.ErrorCode, , XDoc.parseError.reason
    End If
    XDoc.LoadXML (query)

    Set xEmpDetails = XDoc.DocumentElement
    Set xParent = xEmpDetails.FirstChild
    Worksheets("Sheet3").Cells(1, 1).Value = "Country"
    Worksheets("Sheet3").Cells(1, 1).Interior.Color = RGB(65, 105, 225)
    Worksheets("Sheet3").Cells(1, 2).Value = "City"
    Worksheets("Sheet3").Cells(1, 2).Interior.Color = RGB(65, 105, 225)
    Row = 2
    Col = 1
    For Each xParent In xEmpDetails.ChildNodes
        For Each xChild In xParent.ChildNodes
            Worksheets("Sheet3").Cells(Row, Col).Value = xChild.Text
            Col = Col + 1
        Next xChild
        Row = Row + 1
        Col = 1
    Next xParent
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-30T05:21:01.227

Excel 2013 从 Web 服务读取数据并 bash 直到您可以从中获得所需的内容（假设 JSON 将始终采用相同的格式）。

这段代码应该可以在不需要任何插件的情况下工作。

***不过，您将需要来自[货币转换器](https://www.currencyconverterapi.com)网站的免费 API 密钥。***

我用它将美元到英镑的值加载到我工作表上的一个单元格中。

```
Option Explicit

Sub Test_LateBinding()

    Dim objRequest As Object
    Dim strUrl As String
    Dim blnAsync As Boolean
    Dim strResponse As String

    Set objRequest = CreateObject("MSXML2.XMLHTTP")
    strUrl = "https://free.currconv.com/api/v7/convert?q=USD_GBP&compact=ultra&apiKey=[MY_API_KEY]"
    blnAsync = True

    With objRequest
        .Open "GET", strUrl, blnAsync
        .SetRequestHeader "Content-Type", "application/json"
        .Send
        While objRequest.readyState <> 4
            DoEvents
        Wend
        strResponse = .responsetext
    End With

    Dim responseArray() As String
    responseArray = Split(strResponse, ":", -1)

    Dim value As String
    value = responseArray(1)

    Dim valueArray() As String
    valueArray = Split(value, "}", -1)

    Dim finalValue As String
    finalValue = valueArray(0)

    Sheet2.Cells(22, "C") = finalValue
End Sub 
```

# ruby-on-rails - 最佳 SSL 证书提供商？

> ID：474937
> 
> 赞同：8
> 
> 时间：2009-01-23T22:49:58.477
> 
> 标签：ruby-on-rails, ssl, ssl-certificate, vendors

我将很快将 SSL 切换到我的 Rails 站点，想知道是否有人对谁是最好的提供商有想法或建议？

有没有人对某些供应商有任何快乐或恐怖的故事？

谢谢

肯特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T00:00:20.600

我过去使用过 Godaddy 证书，它非常简单。他们似乎有一个非常好的系统和不同类型的证书，价格不同，具体取决于您的需要。对于许多应用程序来说，感知安全性（对于网站用户而言）似乎非常重要。出于这个原因，如果您觉得他们的品牌在您的用户中更受信任，您可以考虑选择对您来说不太方便的提供商。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T22:52:42.730

好吧，我不知道它是否最好，但[CACert](http://cacert.org/)是免费且易于使用的。免责声明：我担任 CACert 担保人已超过 3 年。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T04:06:31.300

我正在使用通过[Dynadot](http://www.dynadot.com/ssl/about.html)以 15.99 美元购买的 RapidSSL 证书。忽略之前发帖者所说的关于 RapidSSL 仍在使用 MD5 的内容。他们没有。他们使用 SHA-1。[你可以在这里](https://press.verisign.com/easyir/customrel.do?easyirid=AFC0FF0DB5C560D3&version=live&prid=463259&releasejsp=custom_97)阅读更多关于它的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T22:52:10.797

威力标志。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T22:55:15.533

Geotrust 的表现非常好。通常是快速的 SSL 证书颁发（他们吹嘘 10 分钟，但至少要准备多一点），之后就没有麻烦了。大多数浏览器现在都有他们的根证书，所以给他们一个机会。[http://www.geotrust.com](http://www.geotrust.com)。他们是威瑞信的一部分，但根据我浏览他们网站的经验，他们的网站效果最好（也许还是不同的员工？）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T00:29:23.520

也许是一个旁注：

您从 ie rapidssl 和 quickssl 购买的更便宜的证书仍然使用 MD5 生成的密钥，这些密钥已被破坏并可能用于劫持。[在这里阅读更多](http://news.softpedia.com/news/SSL-Security-Broken-101075.shtml)。因此，根据您希望使用证书的安全程度，您可能想要购买更昂贵的证书。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-24T00:06:25.140

我一直使用 GoDaddy，从来没有遇到过问题。他们的支持人员很棒，总是在那里提供帮助。

# asp.net-mvc - 在 ASP.NET MVC 中的 Form.Begin 中使用命名路由

> ID：474938
> 
> 赞同：2
> 
> 时间：2009-01-23T22:50:41.113
> 
> 标签：asp.net-mvc, routing

使用 Form.Begin 时，有没有办法在 ASP.NET MVC 中强制使用命名路由。我越来越多地了解路由，并且害怕如果您只是更改顺序或参数是否具有默认值，它可能会非常脆弱。

```
<% Form.Begin(...) %> <!-- no overload for providing a route name --%> 
```

用于开始表单的命名路由似乎没有过载，所以我能想到的最好的方法是：

```
<form action="/Products/Command/ViewProduct" method="post"> 
```

我想知道这个丢失的重载是否是疏忽（现在是测试版），是否有原因或生成 URL 的替代方法。

我尝试使用 RouteLink 并将其嵌入到 Form 标签中，但是 RouteLink 为我创建了一个`<A>`不好的标签的完整 HTML。

```
action="<%= Ajax.RouteLink("Update Status", "product-route-short", new { action = "GetStatus", sku = "" }, new AjaxOptions { UpdateTargetId = "status" })%>" 
```

我必须从命名路由生成 URL 的替代方法。

我应该将这个丢失的超载报告为问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-24T00:04:06.083

如果您需要生成命名路由的 URL，您可以使用`Url.RouteUrl()`，您只需将控制器和操作放入路由值对象中，如下所示：

```
<%= Url.RouteUrl("NamedRoute", new { controller="Controller", action="Action", foo="Bar" ... }) %> 
```

至于添加重载，这些助手中有很多不同的重载，以至于它们开始发生冲突并变得模棱两可。例如，考虑以下重载

```
public string BeginForm(string actionName, string controllerName)
public string BeginForm(string actionName)
public string BeginForm(string routeName, string actionName) // Uh oh! 
```

第一个和第三个具有相同的签名，因此它们是无效的。

如果您需要经常使用命名路由，您总是可以创建自己的表单助手作为 HtmlHelper 的扩展方法。

# asp.net - 我必须使用 JavaScript 吗？

> ID：474939
> 
> 赞同：5
> 
> 时间：2009-01-23T22:50:47.477
> 
> 标签：asp.net, javascript

什么时候它变得不可避免？当你有选择的时候，你会在什么时候选择 JavaScript 而不是服务器端？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-23T22:53:32.590

当您需要更改页面上的某些内容而不重新加载时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T22:57:39.307

设计师观点：

*   当您想为网页提供更多交互性时
*   当您想在不重新加载的情况下加载内容时（例如：ajax）

当你不应该使用：

*   当您不想花 1000 个小时无意义地尝试禁用浏览器的后退箭头时 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T23:12:08.340

如果没有 JavaScript，谷歌地图是不可能的。至少不是我们今天所知道（和喜爱）的形式。因此，清楚地取决于您的抱负（和要求）：有时 JavaScript 是不可避免的，即使存在采用另一种可能同样有效的方法的技术（Java Applet、RIA 技术等）。

如果让我选择的话，我可能会为大量应用程序选择 JavaScript 而不是服务器端实现，但话又说回来，这不是黑白图片。在很长一段时间内，服务器对于 Web 应用程序仍然很重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T23:27:25.033

是的你是。现在拿出你的课本，翻到第一章。;)

不过，老实说，要回答您的问题，我认为这从来都不是“不可避免的”，不；你总是可以在没有 JavaScript 的情况下编写代码。（实际上，可用性最佳实践要求您至少*尝试*“优雅地降低”不支持它的浏览器或选择不支持它的用户的用户体验。）当然，一开始并没有 JavaScript——但仍然有网络。它只是，好吧，有点糟透了。

没有简单的答案，但如果你绝对必须有一个，我能想到的最直接的方法就是使用 JavaScript 来改善用户体验。其次，使用它将工作负载从您的服务器转移到浏览器（你好，Ajax！）——验证、状态等。这是两个重要原因，广义地说，IMO。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T23:52:20.753

在一段时间内，您可以通过服务器端编程来完成所有事情。有些事情会非常缓慢并且难以正确完成，但这是可能的。如果您想看到仅使用 CSS 完成的巧妙操作，请在禁用脚本的情况下尝试 lxr.mozilla.org 上的搜索功能。

但实际上，使用 javascript 的最佳位置是它会破坏用户操作流程的地方——这里的 AJAXy 都是很好的例子，实时预览也是如此（每个人都应该拥有其中之一！）

如果它提供了显着的好处，那么使用它是完全可以的。但是请不要让它成为*必需*，除非仅服务器等效项不必要地复杂。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T23:57:08.437

我从*不想*选择 JavaScript，但是当客户想要一个像样的 Web 应用程序时，它就变得不可避免了。JavaScript 在浏览器中具有低延迟反馈的独特功能 - 服务器端代码没有。

此外，有一些（相当有限的）次数实际上*更容易*取出一些 JQuery 进行格式化，而不是处理 ASP.NET 的事件模型来操作客户端元素。但是，我会说这些相对较少。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-24T02:03:06.233

如果您正在寻找响应式 UI 并希望避免使用 JavaScript，请考虑使用一些 RIA 技术，例如 Flex、Silverlight 或 JavaFX。从 v1.5 开始，我一直在使用 Flex 进行开发，发现它非常有能力和生产力。Silverlight 也随着每个版本的发布而变得越来越好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-24T02:51:35.790

在客户端和服务器之间分担负载。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-24T03:34:37.453

GWT 是一个很好的系统，可以将 java 代码编译成 javascript，这有点像浏览器的“机器语言”——你永远不必考虑它。

我相信大多数谷歌应用程序都是使用 GWT 编写的。它很光滑。

您的所有源代码几乎都是纯 Java，使用类似于 Swing 的库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-24T20:55:03.593

JavaScript 不是必需品，但与 DOM API 相结合，它为逐步改善网站的用户体验提供了一种非常有用的媒介。显然，这在多大程度上取决于您执行这些增强功能的程度，不要仅仅为了它而使用 JavaScript；这是一个设计决定，不应掉以轻心。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T23:14:13.327

尽量保持自然。用它来增强小东西，不要在 JS 上构建你的整个应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-24T02:59:25.353

衡量你技能广度的一个好方法是“我必须使用……”何时开始从你的谈话中消失。希望你能达到一种语言只是一种语言的地步，并且你对什么是适合这项工作的工具有一种感觉，并且可以像使用任何其他语言一样舒适地使用它。

如果有什么安慰的话，越来越多的证据表明，有足够的传统智慧和可用的工具集，开发人员越来越喜欢 javascript。我个人喜欢它的简洁性和易于扩展性 - 一旦你了解它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-24T04:45:28.353

你不必。

但是，如果您想提供 UI 附加功能，例如自动完成、拖放、更丰富的表单输入字段等……，Javascript 是您唯一的答案。

当然，您可以将 Javascript 生成抽象到服务器端，但您仍然会与 Javascript 争论不休，尽管是通过程序代码生成。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-24T09:02:33.157

当您创建一个加载到浏览器中并使用开放 API（如 SOAP、JSON 等）与 Web 服务器通信的富 Internet 应用程序时

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-24T23:15:14.120

“服务器端的 Javascript” JavaScript 是客户端，而不是服务器端。您仍然需要运行服务器端的东西才能从服务器获取数据。Javascript 只是让您更好地控制客户端如何从服务器接收数据。

当您想要网站上默认不支持的某些动态功能时，JavaScript 是不可避免的。动态功能 -**无**JavaScript：当鼠标悬停在元素上时，您可以使用 CSS 更改元素的背景。你可以用 JavaScript 做同样的事情。-**仅**在 JavaScript 中：当您用鼠标单击元素时，该元素会消失。不要认为这在 CSS 中是可能的（也许你可以在某些元素的 CSS 中使用 :active。我自己从未测试过）。

# c++ - 修改修饰名称 - VS6.0 到 VS2005 迁移

> ID：474947
> 
> 赞同：2
> 
> 时间：2009-01-23T22:52:11.547
> 
> 标签：c++, visual-studio-2005, atl, visual-c++-6, name-decoration

经过几个小时的谷歌搜索，我想是时候问问专家了。我们有一个遗留模块（MS Visual C++ 6.0），我们正在尝试将其移植到 VS 2005。存在许多调用应用程序，因此我们正在尝试（如果可能）保持这些向后兼容。

在代码方面，结果非常简单，几个小时的开发消除了所有编译器错误和大多数警告。

然后我在链接步骤中遇到了一些“未解决的外部符号”错误，这似乎是装饰名称的细微差别。

事实证明，一组错误与 time_t 是 VS2005 中的 64 位结构有关——定义`_USE_32BIT_TIME_T`修复了这三个。

现在我遇到了两个剩余的错误：

函数定义为

`int RC_STATE::my_function(UINT stateId, UINT period, UINT index, UINT paramtype, UINT dpindex, UINT managerId, UINT calctype, UINT status, double *p_val, long *p_isc, CTime *p_time)`

看来，在“旧”Visual Studio 下，它对装饰名称很满意

`?my_function@RC_STATE@@QAEHIIIIIIIIPANPAJPAVCTime@@@Z`

但是现在，VS2005 想要为“CTime”参数包含 ATL 命名空间：

`?my_function@RC_STATE@@QAEHIIIIIIIIPANPAJPAVCTime@ATL@@@Z`

如果我用这个新的修饰名称更新我的 .DEF 文件，它会编译和链接......耶！除了当我用一些曾经可以工作的代码将那个 DLL 放下时，它抱怨它无法在 DLL 中找到过程入口点（即具有“旧”结构的入口点，没有命名空间）。

有什么建议么？是否有某种关键字，编译器指令可以让我告诉编译器不要将命名空间放在修饰名称中（我知道命名空间很好，但是与需要命名空间的 CTime 类型没有冲突解决冲突）。

是否有任何解决方法可以使修饰名称与旧格式匹配？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-24T00:34:21.670

这里实际上有两个问题。首先，正如您所发现的，`CTime`现在在`ATL`名称空间中，而且`CTime`在 VS2005`__time64_t`内部使用，它是 64 位，而不是 32 位，并且不会通过定义`_USE_32BIT_TIME_T`.

因此，即使您要修复命名空间问题，如果您的应用程序是用 VC6 编译的，而 DLL 是用 VS2005 编译的（反之亦然），`CTime`在这些模块之间传递对象几乎肯定会导致数据损坏问题，因为内存布局。

`time_t`在我看来，解决方案是使用 VS2005 重新编译所有代码，并始终使用 64 位，与`CTime`VS2005 一致（即不要使用`_USE_32BIT_TIME_T`.

我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-25T18:10:26.393

另一种可能性是将 CTime 的旧定义复制到您的 VS2005 项目中，并在您试图保持兼容性的函数的参数列表中使用它。然后在处理之前将向后兼容的 CTime 参数转换为新的 ATL::CTime。旧的 VC6 客户端可以调用您的向后兼容方法。

# python - Python 2.2：如何从 64 位数字中取出低 32 位？

> ID：474949
> 
> 赞同：1
> 
> 时间：2009-01-23T22:52:18.833
> 
> 标签：python

我有一个由各种位字段组成的 64 位数字，我正在编写一个简单的 python 实用程序来解析数字。我面临的问题是较低的 32 位由一个字段组成，并且使用位移或位掩码的某种组合并不仅仅给出 32 位。

```
big_num = 0xFFFFFFFFFFFFFFFF
some_field = (big_num & 0x00FFFF0000000000) # works as expected
field_i_need = big_num & 0x00000000FFFFFFFF # doesn't work 
```

发生的`field_i_need`是等于`big_num`，而不是低 32 位。

我在这里错过了一些简单的东西吗？

谢谢！

马修

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T22:57:35.827

```
>>> big_num = 0xFFFFFFFFFFFFFFFF
>>> some_field = (big_num & 0x00FFFF0000000000) # works as expected
>>> field_i_need = big_num & 0x00000000FFFFFFFF # doesn't work
>>> big_num
18446744073709551615L
>>> field_i_need
4294967295L 
```

它似乎有效，或者我错过了这个问题。无论如何，我正在使用 Python 2.6.1。

为了您的信息，我前段时间问了一个与某种相关的[问题。](https://stackoverflow.com/questions/210629/python-unsigned-32-bit-bitwise-arithmetic)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T22:55:22.507

您需要使用长整数。

```
foo = 0xDEADBEEFCAFEBABEL
fooLow = foo & 0xFFFFFFFFL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T19:59:33.663

Matthew 在这里，我注意到我遗漏了一条信息，我使用的是 python 版本 2.2.3。我设法在另一台带有 2.5.1 版的机器上尝试了这个，一切都按预期工作。不幸的是，我需要使用旧版本。

无论如何，谢谢大家的回复。附加“L”似乎可以解决问题，这是一次性的，所以我对这种方法感到满意。

谢谢，

马修

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T00:46:27.463

显然，如果它是一次性的，那么通过将“L”附加到您的文字来使用长整数是快速的答案，但是对于更复杂的情况，如果您查看[Python 是否有位域，您可能会发现您可以编写更清晰的代码类型？](https://stackoverflow.com/questions/142812/does-python-have-a-bitfield-type)因为这就是您使用位掩码的方式。

我想我个人的偏好可能是[http://docs.python.org/library/ctypes.html#ctypes-bit-fields-in-structures-unions](http://docs.python.org/library/ctypes.html#ctypes-bit-fields-in-structures-unions "ctypes 位域")不过，因为它在标准库中，并且有一个非常清晰的 API .

# ssh - 网络中断后自动（或更容易）重新连接到屏幕会话

> ID：474967
> 
> 赞同：56
> 
> 时间：2009-01-23T22:56:32.520
> 
> 标签：ssh, scripting, automation, gnu-screen

补充：我相信这个问题现在被这个问题所包含： [Using GNU Screen fully transparent and automatic](https://stackoverflow.com/questions/1075947/can-i-use-gnu-screen)

另请参阅此相关问题：
[https ://superuser.com/questions/147873/ssh-sessions-in-xterms-freeze-for-many-minutes-whenever-they-disconnect](https://superuser.com/questions/147873/ssh-sessions-in-xterms-freeze-for-many-minutes-whenever-they-disconnect)

原始问题：

如果有办法通过 ssh 连接到机器并立即重新连接到特定的屏幕会话，那就太好了。你可以这样做：

```
laptop> ssh server.com screen -ls 
```

它将显示 server.com 上可用的屏幕列表，如下所示 [1]：

```
123.pts-1
456.pts-2 
```

然后你可以尝试这样做：

```
laptop> ssh server.com screen -dr pts-2 
```

但这失败了，说“必须连接到终端”。您必须先 ssh 进入，然后在 server.com 上执行“screen -dr pts-2”，如果您的连接不稳定并且经常断开连接，这将是不好的。您希望能够在笔记本电脑上通过简单的“向上箭头输入”来恢复。（或者也许让它更加自动化。）

对于这个问题，我有一个非常巧妙的解决方案，我将把它作为答案发布，并希望它被否决而被遗忘，以支持处理这个问题的正确方法。

* * *

脚注：

[1] 或者，更好的是，如果您使用“ `screen -S foo`”和“ `screen -S bar`”之类的名称创建屏幕会话，那么您将获得一个更友好的列表，例如：

```
123.foo
456.bar 
```

并且可以重新连接，例如“ `screen -dr foo`”。

* * *

## 小屏教程，结合这个问题的答案：

登录到 server.com 并执行

```
screen -S foo 
```

然后再也不会退出该会话。要从其他地方重新连接到它，请执行

```
ssh -t server.com screen -dr foo 
```

列出要重新连接到的可用屏幕：

```
screen -ls 
```

或者，当然，

```
ssh server.com screen -ls 
```

远程检查 server.com 的可用屏幕。

我现在使用以下别名 (tcsh)，基于 Jason 在下面的回答，连接到命名屏幕（如果存在）或创建并连接：

```
alias ssc 'ssh -t \!:1 "screen -S \!:2 -dr || screen -S \!:2"' 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-01-23T23:08:59.533

该`-t`选项是否符合您的要求？

```
     -t 强制伪 tty 分配。这可以用来执行仲裁
             将基于屏幕的程序放在远程机器上，可以是
             非常有用，例如在实现菜单服务时。多个 -t
             即使 ssh 没有本地 tty，选项也会强制分配 tty。

```

所以：

```
laptop> ssh -t server.com screen -dr pts-2 
```

这似乎适用于我的安装。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-02T17:56:10.947

这现在被以下内容所包含： [完全透明和自动地使用 GNU Screen](https://stackoverflow.com/questions/1075947/can-i-use-gnu-screen)

* * *

这是一个脚本，`ssc`它的工作原理与此类似，`ssh`但需要第三个参数来指定要重新连接到的屏幕或新屏幕的名称。我相信这个脚本包含了原始问题中的所有内容。

```
#!/usr/bin/env perl
# Use 'ssc' (this script) instead of 'ssh' to log into a remote machine.
# Without a 3rd argument it will list available screens.
# Give it a 3rd argument to attach to an existing screen or specify a new
#   screen.  Eg, ssc remote.com foo
# The numbers in front of the screen tag can usually be ignored.
# Screen is a little too clever though in that if there's an existing screen "bar"
#   and you say "ssc remote.com b" it will reconnect you to "bar" instead of making
#   a new screen "b".  It's like invisible and silent tab-completion.

if(scalar(@ARGV)==0 || scalar(@ARGV) > 2) {
  print "USAGE: ssc remote.com [screen name]\n";
} elsif (scalar(@ARGV) == 1) {
  $machine = shift;
  @screens = split("\n", `ssh $machine screen -ls`);
  for(@screens) {
    if(/^\s*(\d+)\.(\S+)\s+\(([^\)]*)\)/) {
      ($num, $tag, $status) = ($1, $2, $3);
      if($status =~ /attached/i) { $att{"$num.$tag"} = 1; }
      elsif($status =~ /detached/i) { $att{"$num.$tag"} = 0; }
      else { print "Couldn't parse this: $_\n"; }
    }
  }
  print "ATTACHED screens:\n";
  for(keys(%att)) { print "  $_\n" if $att{$_}; }
  print "DETACHED screens:\n";
  for(keys(%att)) { print "  $_\n" unless $att{$_}; }
} else {
  $machine = shift;
  $tag = shift;
  system("ssh -t $machine \"screen -S $tag -dr || screen -S $tag\"");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T23:10:00.700

使用`-t`ssh 选项在直接运行命令时分配终端。

```
laptop> ssh -t server.com screen -dr pts-2 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T18:25:24.120

我一直在做类似的事情，但还没有做到，你的解决方案已经解决了我的问题，所以这是我的建议：

```
ssh -t server.com "screen -S foo -rd || screen -S foo" 
```

这只是尝试打开名为 foo 的现有屏幕，如果它不存在，则创建它。我会把它放在我笔记本电脑的启动器中，所以当无线网络连接时，我可以在我离开的地方打开。

刚刚注意到默认的屏幕外壳有点弱，所以一个更好地设置你的家庭环境的改进是：

```
ssh -t server.com "screen -S foo -rd || screen -S foo bash -l" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-06T06:34:40.760

我将其转换为在 OS X .bash_profile 上工作，并添加了一个：如果没有给出第二个参数，它将启动一个“默认”会话。

```
function ssc() {
    if [[ -z $2 ]]; then
        screen="default"
    else
        screen=$2
    fi
    ssh -t $1 "screen -S $screen -dr || screen -S $screen"
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-26T13:50:22.917

如果您想始终连接到同一个会话，即使它处于活动状态、已分离或尚不存在：

> ssh -t user@server screen -xR screenName

相同，但如果它已经在其他一些 pty 上处于活动状态，则创建一个新会话：

> ssh -t user@server screen -rR screenName

# maven-2 - Maven Jboss AOP 插件 - 有人在注释标记的切入点上取得了成功吗？

> ID：474974
> 
> 赞同：0
> 
> 时间：2009-01-23T22:57:56.060
> 
> 标签：maven-2

在我的 jboss-aop.xml 中，如果我使用普通签名标记切入点，如下所示：

`<bind pointcut="execution(public void org.POJO->noop())">
<Interceptor class="org.SimpleInterceptor"/>
</bind>`

方面编译没有问题，但如果我使用注释，像这样

`<bind pointcut="execution(void *->@org.Trace(..))">
<interceptor class="org.SimpleInterceptor"/>
</bind>`

然后没有aop compile - 没有错误，但是没有编译切入点。所以 - 任何人都知道 maven jboss aop 插件是否应该能够编译注释标记的切入点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T19:29:44.050

在探索了 jboss aop sdk（注释示例工作的地方）并尝试将 2 个项目放在一起寻找原因数小时后，罪犯失踪了

```
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME) 
```

在我的 Trace 界面上。结合 aop 编译器对其设置的几乎每个方面都非常挑剔，并且如果缺少任何重要的东西（如目标/编译），它就会默默地不编译，这是一个非常有趣的难题！

# visual-studio-2008 - Windows 7 测试版上的 Visual Studio 2008

> ID：474977
> 
> 赞同：9
> 
> 时间：2009-01-23T23:00:18.067
> 
> 标签：visual-studio-2008, windows-7

我正在考虑全面升级到 Windows 7 Beta，从而从我的 HD 中删除 Vista。

Visual Studio 2008 能否在 Windows 7 上运行良好？我已经阅读了一些论坛帖子，这些帖子存在问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-23T23:06:16.620

Windows 7 非常稳定，速度非常快，如果您知道自己在做什么并愿意承担小风险，则无需安装 VM。Visual Studio 2008 Professional 可以正常工作（至少据我所知）。我是从运行 VS2008 和 Windows Mobile SDK 6 的 Windows 7 机器上输入的，没有任何问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T15:15:53.227

我在 Win7 beta 上遇到了 VS2008 SP1 的问题。在 LINQ to SQL (DBML) 设计器中，当我将鼠标悬停在表格上时，表格就会消失。我试过搜索，但在任何地方都没有找到任何提及。

这是从已经安装了 VS2008 SP1 的 Vista SP1 的升级。我稍后会尝试安装干净的 Win7（还没有安装 VS2008）。除此之外，我根本没有任何问题。Vista到Win7的升级效果很好。

* * *

编辑：我应该补充一下，这些都是 VistaSP1 x64 和 Win7 x64。也许在 32 位版本的 Win7 中不会发生这种情况。任何人都可以确认吗？

更新：我已经用 VS2008 SP1 完成了干净的 Win7 安装，但 DBML 表仍然消失。现在对我来说没什么大不了的，只是烦人。

* * *

编辑：另外，我有时会无缘无故地将文件锁定在 Win7 中。我无法重命名或删除文件，也找不到使用*procexp*或 Windows 资源监视器锁定的进程。显然只发生在 exe 文件中。我尝试卸载防病毒软件、TortoiseSVN 或任何可能锁定文件的软件。关于VS2008，我在编译时随机得到这个错误：

> 无法将文件“obj\Debug\HelloWorld.exe”复制到“bin\Debug\HelloWorld.exe”。该进程无法访问文件“bin\Debug\HelloWorld.exe”，因为它正被另一个进程使用。

我最终卸载/重新安装驱动器或重新启动 Windows 以使其释放文件。

* * *

编辑： VS2008 SP1 DBML 设计器问题自 Win7 build 7057 起已修复！:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T23:02:10.590

如果您想查看 Windows 7，我会进行 VM 安装而不是完整安装。至少直到它进入 RC 阶段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T23:03:30.683

我的一位同事拥有双启动的 Windows 7 Beta 和 Vista，他一直在 Windows 7 中使用 Visual Studio 2008 进行开发。但这只是一个人的经验，我相信整体上会有问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T23:09:31.607

对我来说，它在 Windows 7 上运行良好。我发誓，它在 7 上的崩溃比在 Vista 上的崩溃要少得多——我很高兴。并不是说它对每个人都有那么好，但我当然希望它对你有用，如果你试一试！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T18:49:21.433

效果很好，除了设计师（Linq To Sql、实体框架、类设计器......）有一个令人讨厌的刷新问题。

基本上，每次您将鼠标悬停在某个类上时，该类都会出现空白，从而难以编辑图表。

不是炫耀，而是烦恼。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-24T23:15:07.797

注意：如果可以的话，我会这样做作为对罗斯帖子的评论。

Windows 7*不仅仅是*带有新壁纸的 vista，从最近几个版本的经验来看，它与 vista 相比效率更高（并且明显更快）。

此外，罗斯，你的错误更可能是时间错误而不是 Windows 7 错误。在另一个操作系统中测试它只是为了检查是个好主意。自预测试版以来，我也从未遇到过断点问题。

无论如何，就您的问题而言，我遇到的唯一问题是 Windows 7 的第一个预测试版，它在设置 WCF 连接时给我一些非常奇怪的端口号问题。

安装 VS SP1 时出现了另一个奇怪的修复，但是自最新版本的 Win 7 以来已修复此问题。

我们在安装 Microsoft Blend 2 和 Visual Studio 时也遇到了问题，您需要按特定顺序安装，自 RC 以来，这再次得到修复。

从我的经验中可以看出，在使用大多数人现在使用的候选版本时，我没有遇到任何重大问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-27T02:32:48.973

到目前为止，我发现的唯一一件事让我很恼火，那就是如果我对 Import Export Settings 做任何事情，它会使 Visual Studio 陷入困境。显然，Xaml“包”或任何已损坏的东西，即使在绝对干净的安装中也是如此。

我正在尝试修复整个应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-24T23:45:48.350

它似乎对我来说很好，但有一个（大）例外：每当我尝试在 WPF 设计器中打开 xaml 文件时，它都会崩溃。除此之外，我喜欢使用 beta 7 - 它似乎比 Vista 快一点。

为任何有同样问题的人更新：通过卸载 Silverlight 解决了这个问题。不能说这绝对是问题，但对我有用......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-01T06:06:12.527

John Robbins 等人发现了一个记录在 Win7 SDK 发行说明中的​​问题。有关约翰的问题和寻找答案的信息，请参阅[http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/01/24/the-case-of-the-corrupt-pe-binaries.aspx 。](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/01/24/the-case-of-the-corrupt-pe-binaries.aspx)

有关 Win7 SDK 发行说明，请参阅[http://download.microsoft.com/download/8/8/0/8808A472-6450-4723-9C87-977069714B27/ReleaseNotes.Htm](http://download.microsoft.com/download/8/8/0/8808A472-6450-4723-9C87-977069714B27/ReleaseNotes.Htm)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T12:15:01.290

我在 Windows 7 中工作到 1 月，没有大问题（只有通过构建升级修复的错误）。我使用 Visual Studio 2008 Team Suite，它运行良好！

但我遇到了一个问题 - 我无法在当前版本 7068 上安装 ADO.NET Entity Framework 1.0 Beta 3 x86。我收到一个错误：“只有 Microsoft ***.NET Framework****才能安装 ADO.NET Entity Framework 1.0（预发布版）**3.5**安装*“。

事实上，它*已安装*。有谁知道如何解决这个问题？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-28T02:18:31.527

我有 win7 x64 RC Build 7100。我在使用 Visual Studio 2008 Pro SP1 时遇到了一些非常奇怪的问题。开发 Web 应用程序时，我无法添加任何 Web 内容表单。我可以添加 Web 表单，但是在使用 Web 内容表单时，我没有得到第二个对话框，允许我选择母版页。它只是永远不会出现。这变得相当烦人。但是，我可以通过右键单击母版页并选择“创建内容表单”来创建内容表单。除此之外，我在 Win7 x64 下运行 VS2008 SP1 没有任何问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-09-23T16:06:24.683

我在 Windows 7 (x64) Build 7100 上运行 VS 2008 SP1，发现开发服务器存在一些问题，当我切换到设计视图时，VS 会完全锁定。然而，最常见的是，当我尝试调试我的 web 应用程序时，开发服务器部分会指示它没有响应并导致调试器通知我安全句柄已关闭。通常，我所要做的就是重新发出 debug 'go' 命令，然后开发服务器的新实例将进行更多的调试，直到再次运行。绝对没有什么可以阻止一个人从 vista 升级到 7，但仍然很烦人。

也许我应该花更多的时间来创建不需要太多调试的代码；）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-31T18:15:47.597

好的。重新安装了 Windows 7 x64 Home Premium 的新副本，然后立即安装了 Visual Studio 2008 Enterprise，它运行良好。因此，任何故障都是由在 VS2008 之前安装的一些第 3 方软件引起的。不确定哪一个，但会在每次安装第 3 方软件后运行 VS2008 测试项目以尝试跟踪它。它仍然运行有点慢，但每次我运行测试项目时，它似乎运行得更快更顺畅。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-14T21:41:40.413

在 Win7 (Pro) 零售完整版上安装了 VS2008 (Pro) 和 SP1。坦率地说，有噩梦般的问题，我正在考虑回到 ti XP 一段时间。

开发 MFC C++：问题：VS2008 将现有项目添加到项目。文件对话框不允许 Ctrl+ 左键单击一次选择多个文件。因此，将 10 个文件添加到项目中就变成了真正的 PITA。

从另一个项目打开 .rc 文件不再允许拖放到当前项目 rc 文件。事实上，它每次都会崩溃 VS2008。我累了3次。此功能在 XP 上的 VS2008 和所有以前的 VS 一直有效，并且一直有效，一直到 VS4

Win7：使用文件打开对话框不允许使用鼠标滚轮，如果我单击文件列表视图，愚蠢的单击会打开一个我不想要的文件，所以我必须使用愚蠢的 VScroll 栏。

Win7：在与所有“拒绝访问”的废话作斗争并按照我喜欢使用 Windows 的方式进行设置之后，运行我迄今为止安装的其他几个程序似乎是合理的。我想我只是在绕过 Vista 时与学习曲线作斗争。
我不能说我看到与 XP 相同的速度差异很大。我的硬件是合理的（双（双核）Xeon 2.8GHz 内存和高清空间等）

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-07-24T23:05:11.997

Windows 7 只不过是带有新桌面壁纸的 Vista，而 UAC 降低了 1 个档次。不过，引擎盖下的垃圾完全相同。

我目前使用的是**Windows 7 RC1 Build 7100 (x64)**，而**Viual Studio 2008 Professional**的日子不好过。

除非您将应用程序的编译设置为特定于处理器 (x86)，否则您无法在调试期间修改代码。

所有断点都不起作用，因为它们会变成白色并带有感叹号，表明您的代码与原始代码不在同一个位置，即使您可能刚刚开始调试。建议的修复（选择忽略）不能解决问题。

您的应用程序将抛出一个错误，GUI 将返回一条消息，说明当前异常发生的位置没有源代码。

另一个棘手的方面是在调试时，您的应用程序可能会在以前没有触发错误。然后相同的功能不会产生错误，一切都很好。然后两分钟后，相同的功能将产生完全不同的错误。您可以从 GUI 中获取多达五个不同的错误，所有这些都是胡言乱语，让您知道它真的不知道发生了什么。

我可以毫无问题地编写一些简单的程序，但是当涉及到任何复杂性或严重性时，我正在处理大量失败。

对我来说，要保持高效，它又回到了快速、可靠、一致的 Windows XP 上。

# visual-studio - 基于 VisualStudio 的富客户端平台

> ID：474981
> 
> 赞同：0
> 
> 时间：2009-01-23T23:01:47.237
> 
> 标签：visual-studio, rich-client-platform

我记得听说过一个基于 Visual Studio 的富客户端平台，类似于 Eclipse 的富客户端平台，它为您提供自动更新、shell、帮助系统等内置功能。不过，我似乎在 Google 上找不到它，有人记得这叫什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T23:12:29.010

[视觉工作室外壳](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)？

# asp.net - ASP.net AJAX 保存后 onclick 事件不起作用

> ID：474984
> 
> 赞同：1
> 
> 时间：2009-01-23T23:02:04.133
> 
> 标签：asp.net, javascript, ajax

我有一个gridview，我`onclick`通过以下方式将事件添加到复选框列：

```
cb.InputAttributes.Add("onclick", "checkClick()"); 
```

一切正常，但是当用户单击表单上的保存按钮（位于 内`updatepanel`）时，复选框的事件突然`onclick`停止触发！

这是 ASP.NET AJAX 的问题吗？

奇怪的是，我`onclick`在源上看到了事件，它只是没有触发。

帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T23:06:38.490

当第一次从服务器接收到文档时，源将显示文档的状态，而不是 DOM 的当前状态。可能发生的情况是更新面板内容被新的 HTML 内容所取代。原始点击事件绑定到的元素不再在 dom 中。

onclick 事件将需要重新绑定以连接到已到达的新元素。*****