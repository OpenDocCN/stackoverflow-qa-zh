# StackOverflow 问答 10154000-10154999

# string - Perl $strings 到哈希表的转换

> ID：10154001
> 
> 赞同：2
> 
> 时间：2012-04-14T13:27:04.307
> 
> 标签：string, perl, type-conversion, user-input, hash

我正在研究一些 DNA（A、T、C 和 G，有可能加入 U）

现在我有一个非常长的字符串，里面充满了不确定长度的 DNA。我已经完成了核苷酸碱基的代码。

```
%nucleotide_bases = ( A => Adenine, 
                      T => Thymine, 
                      G => Guanine, 
                  C => Cytosine );

 $nucleotide_bases{'U'} = 'This is a RNA base called Uracil';#T=U for RNA 
```

现在我需要做的就是放入某种循环中以从字符串中读取每个字符。由于此代码适用于学生，因此需要简单。几周前我自己开始使用 perl，在那之前是 java。

字符串（它被称为 $string1）需要在读取每个碱基对时打印它的全名（一次一个）。所以当字符串说 ATTCGCG

屏幕输出需要阅读： Adenine Thymine Adenine Thymine Cytosine Guanine Cytosine Guanine

如果从字符串中执行此操作太棘手，我可以使用数组作为起点。非常感谢您的帮助。

优秀的答案。我们现在都准备好了。

我遇到的另一个问题是关于确保用户只能输入 DNA 碱基（A、T、C 和 G）。我认为这称为输入验证。

```
print "Please enter your first DNA sequence now: \n";
$userinput1=<>;
chomp $userinput1; 
```

你将如何在那里添加输入验证？除非满足条件，否则应始终重新询问第一个打印语句。

我知道我需要类似的东西

```
 if($userinput1 ne 'a' or 't' or 'c' or 'g') {
 print "Please enter DNA only (A, T, C or G)";
 } 
```

我不完全确定如何回到原来的打印语句

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:47:00.237

[使用一次处理一个字符串一个字符](http://docstore.mik.ua/orelly/perl/cookbook/ch01_06.htm)的配方，我想出了这个：

```
使用警告；
使用严格；

我的 %核苷酸碱基 = ( A => '腺嘌呤',
             T => '胸腺嘧啶'，
             G => '鸟嘌呤',
             C => '胞嘧啶' );

我的 $string = 'ATATCGCG';
我的@array = split(//, $string);
foreach (@array) {
    我的 $char = $_;
    打印 $核苷酸碱基{$char}, ' ';
}

```

请注意，我正在使用`use warnings`and `use strict`（作为初学者，您可能也应该这样做），所以我必须在基本名称周围添加引号。此外，程序最后会打印出一个额外的空格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T13:52:37.827

我假设您正在尝试从字符串中解码各种字母 A、T、G 和 C 并打印出它们的全名。

```
print "$nucleotide_bases{$_} " for split //, $string; 
```

或使用数组：

```
my @array = map $nucleotide_bases{$_}, split(//, $string);
print "@array"; # quoted to insert spaces between elements. 
```

作为 的替代方法`split`，您可以使用正则表达式，它将排除任何不相关的字符进行解码：

```
my @array = $string =~ /[ATCG]/g; 
```

哦，当您为哈希分配值时，您需要引用这些值。[卢克·格文 ( Luke Girvin](https://stackoverflow.com/users/133/luke-girvin) ) 的精彩接球。

```
my %nucleotide_bases = ( A => "Adenine", ... ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T23:04:09.773

***脚本：***

```
#!/usr/bin/perl

use strict;
use warnings;

my %nucleotide_bases = ( A => 'Adenine',
                         T => 'Thymine',
                         G => 'Guanine',
                         C => 'Cytosine',
                         U => 'Uracil' );

my $string1 = 'ATATCGCG';

$string1 =~ s/([ATGCU])/{$nucleotide_bases{$1}.' '}/ge;

print $string1, "\n"; 
```

***输出：***

```
Adenine Thymine Adenine Thymine Cytosine Guanine Cytosine Guanine 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T13:17:12.663

请*务必* 在所有 Perl 程序开始时，尤其是那些您正在寻求帮助的程序`use strict`。`use warnings`这样，Perl 将修复许多您没有注意到的简单错误，并且您将更快地生成工作代码。

这可以非常简单地通过将字符串拆分为字符，使用散列来翻译它们，然后再次连接它们来完成。

这个程序演示了这个想法。请注意，我留下了构建散列的代码，就像您提供的那样，仅仅是因为您可能更喜欢这种方式。

```
use strict;
use warnings;

my %nucleotide_bases = (
  A => 'Adenine', 
  T => 'Thymine', 
  G => 'Guanine', 
  C => 'Cytosine',
);
$nucleotide_bases{'U'} = 'This is a RNA base called Uracil'; #T=U for RNA

my $chain = 'ATATCGCG';

my $expand = join ' ', map $nucleotide_bases{$_}, split //, $chain;

print $expand, "\n"; 
```

**输出**

```
Adenine Thymine Adenine Thymine Cytosine Guanine Cytosine Guanine 
```

* * *

**编辑**

根据要求，这是从控制台读取序列并重复，只要提供的序列无效。输出与前面代码的输出相同。

```
use strict;
use warnings;

my %nucleotide_bases = (
  A => 'Adenine', 
  T => 'Thymine', 
  G => 'Guanine', 
  C => 'Cytosine',
);
$nucleotide_bases{'U'} = 'This is a RNA base called Uracil'; #T=U for RNA

my $userinput1;
while () {
  print "Please enter your first DNA sequence now: ";
  chomp ($userinput1 = uc <>);
  last unless $userinput1 =~ /[^ATGC]/;
  printf qq("$userinput1" is an invalid sequence\n);
} 

my $expand = join ' ', map $nucleotide_bases{$_}, split //, $userinput1;

print $expand, "\n"; 
```

# javascript - 在不涉及整页刷新的动态页面更改后，使用 JQuery 访问/传播选择器到新的输入字段

> ID：10154011
> 
> 赞同：1
> 
> 时间：2012-04-14T13:28:33.057
> 
> 标签：javascript, jquery, css-selectors

我有一个 jQuery 选择器，它在用户在输入表单中更改国家名称后运行。但是，在国家/地区字段更改后，地址输入字段会更改，并且页面会动态刷新，而无需重新加载整个页面。

问题：内联/部分页面刷新后，如何让 JQuery 访问/传播选择器到新的输入字段？

例子：

```
jQuery('[id^="Country"]').on('mouseup', function(e) {
// code gets here okay... the problem is it doesn't call the the following after the page refresh... 
});

jQuery('select[id^="AccountEditForm.Parent Ship To Address."]:visible,input[id^="AccountEditForm.Parent Ship To Address."]:visible').on('mousedown', function(e) {
// code no longer gets here because the input fields are updated dynamically for some reason
}); 
```

注意：我使用的是 .live()... 但新版本的 jQuery 不再支持此功能。

V$H。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:34:29.047

```
$(document).on('mouseup', '[id^="Country"]',  function(e){
    alert($(this).attr('id'));
​});​ 
```

[示例](http://jsfiddle.net/heera/WSe3n/)

```
for(i=1;i<6;i++)
{
    var div=$("<div id='Country"+i+"'>country"+i+"</div>");
    $('#wrapper').append(div);
}

$('#wrapper').on('mouseup', '[id^="Country"]', function(e){
    alert($(this).attr('id'));
}); 
```

[例子](http://jsfiddle.net/heera/WSe3n/3/)

# iphone - Cocos2d 应用程序在设备上崩溃但在模拟器上运行正常

> ID：10154015
> 
> 赞同：0
> 
> 时间：2012-04-14T13:29:46.393
> 
> 标签：iphone, xcode, cocos2d-iphone, ios5.1

Cocos2d 应用程序在设备上崩溃，但在模拟器上运行正常。

我明白了

```
"error: failed to launch '/Users/user/Library/Developer/Xcode/DerivedData/
appname-erbohpyunldppdeoivvobopinufc/Build/Products/Debug-iphoneos/
appname.app/ appname -- failed to get the task for process 3259" 
```

阅读较旧的帖子后，我尝试：

*   在 Xcode 上更改应用名称
*   从 iPhone 的跳板中删除应用程序
*   更改捆绑标识符
*   删除 DerivedData 文件夹内容
*   在 xcode 中做了 product->clean
*   重启iphone
*   重启xcode

没有任何效果，我将 xcode 4.3.2 与 iphone 4 ios 5.1 一起使用。我还没有开发人员帐户，所以我不得不禁用代码唱歌（希望不是原因），当我运行 Xcode 应用程序时，它们会因同样的错误而崩溃，但是当我关闭并重新打开它们时，它的工作就很好了。只有使用 cocos2d apss 他们才会不断崩溃。还有一件事，当我构建它时，任何 cocos2d 代码的行为都是一样的，即使是内置的 cocos2d 示例。

谢谢。

# c++ - 在数组中一次分配整个结构

> ID：10154018
> 
> 赞同：4
> 
> 时间：2012-04-14T13:30:05.940
> 
> 标签：c++, arrays, struct

我正在学习 C++，但我对`struct`数组有疑问。我的结构是：

```
struct board
{
    string name;
    string desc;
    int nval;
    int sval;
    int eval;
    int wval;
}; 
```

我的数组如下所示：

```
board field[10][10]; 
```

例如，我可以这样做：

```
field[5][6].name = "ExampleName";
field[5][6].desc = "This is an example";
field[5][6].nval = 3;
//and so on... 
```

但我想立即分配给整个结构，如下所示：

```
field[5][6] = {"ExampleName", "This is an example", 3, 4, 5, 6};
//so I don't have to type everything over and over again... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:50:40.560

C标准允许您尝试做的事情。它似乎也在 C++ 中工作。我在 C++11 中验证了它：

```
struct board
{
string name;
string desc;
int nval;
int sval;
int eval;
int wval;
}field[10][10];

int main()
{    
field[5][6]={"ExampleName","This is an example",3,4,5,6};
cout<<field[5][6].name<<endl;
cout<<field[5][6].sval<<endl;
return 0;
} 
```

它打印正确。所以你应该能够做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:38:12.520

恐怕你不能这样做。

但在现实生活中这不是问题，因为您通常不需要手动填写此类字段。您通常会循环执行此操作。

如果您不介意运行时初始化，我会这样做：

```
 // in the beginning make these arrays
string names[10*10] = {
    "example 1 name"
    "example 2 name"
    "blah blah blah "
};

string descriptions[100] = {

};
//and then just loop through that

int i,j;
for (int k = 0; k != 10*10; ++k) { // 10*10 size of a board
        if (j == 10) {
            j = 0;
            i++
        }

        field[i][j].name = names[k]// get it from names
        field[i][j].desc = // get somehow the description,...
        ++j
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T13:46:25.800

如前所述，C99 和 C# 支持该语法的一种形式，但标准 C++ 不支持。您*可以*通过将构造函数添加到您的结构来做到这一点。请注意，这将不再与 ANSI C 兼容。

```
struct board
{
    string name;
    string desc;
    int nval;
    int sval;
    int eval;
    int wval;

    board()
    {
    }

    board(string name, string desc, int nval, int sval, int eval, int wval)
    {
        this->name = name;
        this->desc = desc;
        this->nval = nval;
        this->sval = sval;
        this->eval = eval;
        this->wval = wval;
    }
};
```

```
field[1][2] = board("name", "desc", 1, 2, 3, 4);
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T13:48:19.437

如果您定义带参数的构造函数，您将能够创建临时并用它初始化给定元素。您还需要定义和默认构造函数：

```
struct board
{
   string name;
   string desc;
   int nval;
   int sval;
   int eval;
   int wval;

   board():
     name(""),
     desc(""),
     nval(0),
     sval(0),
     eval(0),
     wval(0){}

   board(
     const string& name,
     const string& desc,
     int nval,
     int sval,
     int eval,
     int wval):
   name(name),
   desc(desc),
   nval(nval),
   sval(sval),
   eval(eval),
   wval(wval){}
};

int main()
{
   board field[10][10];
   field[5][6]= board("ExampleName","This is an example",3,4,5,6);
   return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T13:48:22.087

如果您确实需要为所有 100 个字段定义手动选择的值，您可以通过将所有参数写入文本文件然后解析文件并用提取的值填充数组来简化操作。该文件可能看起来像

```
0 0
Corner field
Here it begins
0 1 2 3

0 1
ExampleName
This is an example
3 4 5 6 
```

等等。然后在读取文件时，您可以使用它`istream::getline`来提取文本字符串和`istream::operator>>`提取数字。

但这仍然很痛苦。你确定没有自动的方法来产生至少你的大部分价值吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-15T00:18:24.010

这个问题不太清楚你的意思*一行*，所以我将开始提供建议：

使用聚合初始化：

```
board fields[10][10] = { 
                  { {"ExampleName","This is an example",3,4,5,6}, // Element 0,0
                    {"ExampleName","This is an example",3,4,5,6}, // Element 0,1
                // ...
                  },
                  { {"ExampleName","This is an example",3,4,5,6}, // Element 1,0
                // ... 
                  }
                }; 
```

这是您可以获得的最接近单线的，它是有效的 C++（在所有变体中，假设它`board`是一个聚合，因此`board[10][10]`也是一个聚合），但它可能很难阅读。

下一步是更接近您正在做的事情，即初始化每个元素（而不是数组），因为在 C++11 中，您可以使用与您建议的相同类型的初始化。在 C++03 中，您需要通过构造函数来执行此操作（注意，这将更改类型的属性，并且您需要为数组创建默认构造函数）：

```
 struct board {
    string name;
    string desc;
    int nval;
    int sval;
    int eval;
    int wval;
    board() {}  // [*]
    board( const char* name, const char* desc, int n, int s, int e, int w )
       : name(name), desc(desc), nval(n), sval(s), eval(e), wval(w)
    {}
 };
 board fields[10][10];  // [*] this requires the default constructor [*]

 fields[5][6] = board("ExampleName","This is an example",3,4,5,6); 
```

或者通过一个函数：

```
board create_board( const char* name, const char* desc, ... ) {
   board res = { name, desc, ... };
   return res;
} 
```

请注意，在这两种情况下，数组中的元素都会在数组初始化期间进行初始化，然后在它们之上复制一个新对象。

# silverlight - Silverlight 混合行为不会在设计时附加

> ID：10154023
> 
> 赞同：4
> 
> 时间：2012-04-14T13:30:52.353
> 
> 标签：silverlight, behavior, blend

我开发了一种改变 AssociatedObject 的 Clip 属性的行为。当我运行应用程序时，一切都很好。但是，当我在 Blend 中查看页面时，似乎该行为不会影响其关联对象。

我尝试通过将 Visual Studio 2010 调试器附加到它的进程来“调试”混合，并在行为的 OnAttached 方法上设置断点，但从未达到断点。好像混合阻止了在设计时附加该行为。

有办法解决吗？

干杯，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T15:24:15.753

我终于找到了一种可行的解决方法，但是我在这个答案的末尾提出了一个很大的警告。这是我的 CustomAttachManager：

```
public class CustomAttachManager : DependencyObject
{
    #region Object CustomAttachManager.Attached = null

    public static IAttachedObject GetAttached(DependencyObject obj) { return (IAttachedObject)obj.GetValue(AttachedProperty); }
    public static void SetAttached(DependencyObject obj, IAttachedObject value) { obj.SetValue(AttachedProperty, value); }

    public static readonly DependencyProperty AttachedProperty =
        DependencyProperty.RegisterAttached("Attached", typeof(IAttachedObject), typeof(CustomAttachManager), new PropertyMetadata(null, StaticHandleAttachedChanged));

    static void StaticHandleAttachedChanged(DependencyObject self, DependencyPropertyChangedEventArgs args)
    {
        var ov = (IAttachedObject)args.OldValue;
        var nv = (IAttachedObject)args.NewValue;

        if (ov != null) ov.Detach();
        if (nv != null) nv.Attach(self);
    }
    #endregion
} 
```

然后，您可以使用它来附加如下行为：

```
<my:CustomAttachManager.Attached>
    <my:RedBackgroundBehavior></my:RedBackgroundBehavior>
</my:CustomAttachManager.Attached> 
```

我的示例行为将面板的背景更改为红色，这在设计器中可见。

剩下的问题是多重行为的情况。我能想出的最佳解决方案是代理：

```
[ContentProperty("Children")]
public class MultipleBehavior : Behavior<DependencyObject>
{
    DependencyObjectCollection<IAttachedObject> children = new DependencyObjectCollection<IAttachedObject>();
    public DependencyObjectCollection<IAttachedObject> Children { get { return children; } }

    protected override void OnAttached()
    {
        foreach (var child in Children) child.Attach(AssociatedObject);
    }

    protected override void OnDetaching()
    {
        foreach (var child in Children) child.Detach();
    }
} 
```

可以这样使用：

```
 <my:CustomAttachManager.Attached>
        <my:MultipleBehavior>
            <my:RedBackgroundBehavior />
            <my:SupriseBehavior />
        </my:MultipleBehavior>
    </my:CustomAttachManager.Attached> 
```

代理有一个缺陷，即它无法正确处理在附加某些内容后添加的行为，但在经典用例中不会发生这种情况。

需要注意的是，我不知道如何让 Blend 显示对象树中的行为。不能使用“AlternateContentProperty”，因为它不适用于附加属性，这是 CustomAttachManager 使用的。

如果我找到这个问题的答案，我会更新这个答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T12:00:42.013

我不确定，但我认为关联对象只有在行为“附加”后才会受到影响。这是在“OnAttached”事件期间调用的，我不相信在设计时调用此事件。据我所知，控件的设计时更改发生在它们的初始化/创建阶段。OnAttached 发生在所有这些发生之后（因此 AssociatedObject 可用于操作的原因），因此，使得行为难以在设计时更改控件。我并不是说这是不可能的，但从控件生命周期和行为的明显设计来看，这种方法似乎很困难。解决方案：

*   采取模板操作的方法。附加您设计的自定义样式或资源字典键，以创建您寻求的印象。
*   在 Visual Studio 中创建一个自定义控件，该控件公开一个可以将另一个控件绑定到的属性。让这个自定义控件操纵这个“属性”，即在它的一个初始化方法中使用剪辑属性的控件。例如，在 InitializeComponent 期间，检查内容是否已加载，然后调用一个方法来根据需要调整“Clip”属性。阅读 Silverlight 控件的生命周期，这可能会对您有所帮助 - [http://stuff.seans.com/2009/03/23/hello-silverlight-world-part-3-the-lifecycle-of-a-silverlight -控制/](http://stuff.seans.com/2009/03/23/hello-silverlight-world-part-3-the-lifecycle-of-a-silverlight-control/)

就像我说的，我不确定这里的答案，但我会说这么多——如果解决方案看起来太复杂，可能有更清洁的方法；）

# python - 文件中的 unicode 字符串包含不同的

> ID：10154025
> 
> 赞同：0
> 
> 时间：2012-04-14T13:30:58.960
> 
> 标签：python, sqlite, unicode, utf-16

我的系统是fedora。由于某种原因。一条记录的最后一个字段是**一个 unicode 字符串** （在 qemu 中使用来自来宾机器的 memcpy 复制数据）。unicode 字符串是 windows regedit 键名。

> smss.exe|NtOpenKey|304|4|4|0|\^@R^@e^@g^@i^@s^@t^@r^@y^@\^@M^@a^@ c^@h^@i^@n^@e^@\^@S^@y^@s^@t^@e^@m^@\^@C^@u^@r^@r^ @e^@n^@t^@C^@o^@n^@t^@r^@o^@l^@S^@e^@t^@\^@C^@o^@n ^@t^@r^@o^@l^@\^@S^@e^@s^@s^@i^@o^@n^@ ^@M^@a^@n^@a ^@g^@e^@r^@ smss.exe|NtClose|304|4|4|0|System|NtOpenKey|4|0|2147484532|0|\^@R^@e^@g^@i ^@s^@t^@r^@y^@\^@M^@a^@c^@h^@i^@n^@e^@\^@S^@y^@s^@ t^@e^@m^@\^@C^@u^@r^@r^@e^@n^@t^@C^@o^@n^@t^@r^@o^ @l^@S^@e^@t^@ services.exe|NtOpenKey|680|624|636|0|\^@R^@E^@G^@I^@S^@T^@R^ @Y^@\^@M^@A^@C^@H^@I^@N^@E^@\^@S^@y^@s^@t^@e^@m^@\ ^@C^@u^@r^@r^@e^@n^@t^@C^@o^@n^@t^@r^@o^@l^@S^@e^@ t^@\^@S^@e^@r^@v^@i^@c^@e^@s^@

这是一些十六进制代码：使用'|' 作为拆分字符。前 6 个字段是 ascii sting 。最后一个字段是一个窗口 unicode 字符串（我认为它是 utf-16 代码）。

> 0000000 6d73 7373 652e 6578 4e7c 4f74 6570 4b6e
> 0000010 7965 337C 3430 347C 347C 307C 5c7c 5200
> 0000020 6500 6700 6900 7300 7400 7200 7900 5C00
> 0000030 4d00 6100 6300 6800 6900 6e00 6500 5C00
> 0000040 5300 7900 7300 7400 6500 6d00 5C00 4300
> 0000050 7500 7200 7200 6500 6E0000 7400 4200
> 6F00 7400 7400,600,00070700 6F00
> 6C00 6C00
> 6C00 7300 6F00 7300 6F00 7300 6F00 6F00 6900 6F00 6F00 6_00
> 0000090 2000 4d00 6100 6e00 6100 6700 6500 7200

我将使用 python 解析它并将其插入一个 db 。这是我的处理方式

```
def parsecreate(filename):
    sourcefile = codecs.open("data.db",mode="r",encoding='utf-8')
    cx = sqlite3.connect("sqlite.db")
    cu = cx.cursor()
    cu.execute("create table data(id integer primary key,command text, ntfunc text, pid text, ppid text, handle text, roothandle text, genevalue text)")
    eachline = []
    for lines in sourcefile:
        eachline = lines.split('|')
        eachline[-1] = eachline[-1].strip('\n')
        eachline[-1] = eachline[-1].decode('utf-8')

        cu.execute("insert into data(command,ntfunc,pid,ppid,handle,roothandle,genevalue) values(?,?,?,?,?,?,?)",(eachline[0],eachline[1],eachline[2],eachline[3],eachline[4],eachline[5],eachline[-1]) )

    cx.commit()
    cx.close() 
```

我会错的：

> 文件“./parse1.py”，第 18 行，在 parsecreate 中为源文件中的行：文件“/usr/lib/python2.7/codecs.py”，第 684 行，在下一个 return self.reader.next() 文件中“ /usr/lib/python2.7/codecs.py”，第 615 行，在下一行 = self.readline() 文件“/usr/lib/python2.7/codecs.py”，第 530 行，在 readline 数据 = self .read(readsize, firstline=True) File "/usr/lib/python2.7/codecs.py", line 477, in read newchars, decodedbytes = self.decode(data, self.errors) UnicodeDecodeError: 'utf8' codec无法解码位置 51 中的字节**0xd0 ：无效的继续字节**

因为 unicode 字符串可能包含 utf8 不知道的字节。如何正确阅读最后一个字段？

简单的说。不是 utf-16 编码文件中有一个 unicode 字符串，如何使该字段正确插入到数据库中？Python 读取文件使用一种编码方式。我可以只读取原始字节吗？可以将这些字节组合成一个 unicode 字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:50:13.197

您的数据文件不是纯文本文件，因此以二进制形式打开文件并明确解码文本字段。我不得不对数据进行相当多的操作才能取回我认为的原始二进制数据。看起来原始数据可能是`sqlite3.exe`类似于我下面的最终输出的转储，除了最终字段的数据存储为 UTF-16 编码的 BLOB 而不是 TEXT。

请注意，按行解析并按“|”分割 如果 UTF-16 数据包含表示 '\n' 或 '|' 的字节，可能会遇到问题，但我现在将忽略它。

这是我的测试：

```
from binascii import unhexlify
import sqlite3

data = unhexlify('''\
6d73 7373 652e 6578 4e7c 4f74 6570 4b6e
7965 337c 3430 347c 347c 307c 5c7c 5200
6500 6700 6900 7300 7400 7200 7900 5c00
4d00 6100 6300 6800 6900 6e00 6500 5c00
5300 7900 7300 7400 6500 6d00 5c00 4300
7500 7200 7200 6500 6e00 7400 4300 6f00
6e00 7400 7200 6f00 6c00 5300 6500 7400
5c00 4300 6f00 6e00 7400 7200 6f00 6c00
5c00 5300 6500 7300 7300 6900 6f00 6e00
2000 4d00 6100 6e00 6100 6700 6500 7200'''.replace(' ','').replace('\n',''))

# OP's data dump must have been decoded from the original data
# as little-endian words, and is missing a final 0x00 byte.
# Byte-swapping and adding missing zero byte to get back what
# was likely the original binary data.
data = ''.join(a+b for a,b in zip(data[1::2],data[::2])) + '\x00'

with open('data.db','wb') as f:
    f.write(data)

def parsecreate(filename):
    with open(filename,'rb') as sourcefile:
        with sqlite3.connect("sqlite.db") as cx:
            cu = cx.cursor()
            cu.execute("create table data(id integer primary key,command text, ntfunc text, pid text, ppid text, handle text, roothandle text, genevalue text)")
            eachline = []
            for line in sourcefile:
                eachline = line.split('|')
                eachline[-1] = eachline[-1].decode('utf-16le')
                cu.execute("insert into data(command,ntfunc,pid,ppid,handle,roothandle,genevalue) values(?,?,?,?,?,?,?)",(eachline[0],eachline[1],eachline[2],eachline[3],eachline[4],eachline[5],eachline[-1]) )

parsecreate('data.db') 
```

输出：

```
C:\>sqlite3 sqlite.db
SQLite version 3.7.9 2011-11-01 00:52:41
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> select * from data;
1|smss.exe|NtOpenKey|304|4|4|0|\Registry\Machine\System\CurrentControlSet\Control\Session Manager 
```

# symfony - 使用 Doctrine 选择从月初到当前日期的记录

> ID：10154028
> 
> 赞同：2
> 
> 时间：2012-04-14T13:32:08.797
> 
> 标签：symfony, doctrine, doctrine-orm

我在从学说中获取数据时遇到 2 个问题：

1.  选择从月初到当前日期的记录
2.  选择从年初到当前日期的记录

我如何编写一个 Doctrine 查询来做和我们[在 Mysql中做的一样的事情](https://stackoverflow.com/questions/7403390/select-records-from-start-of-month-to-current-date)

这是我的存储库中的不完整代码？

```
public function findByYearlyAttendanceTillToday($id)
{
    $em = $this->getEntityManager();
    $query = $em->createQuery("SELECT count(a) FROM CollegeStudentBundle:StudentAttendance a where a.present LIKE 'A' and a.student_id = :id and a.date > :date");
    $query->setParameter('id', $id);
    $query->setParameter('date', **?????**);
    return $query->getResult();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-14T16:28:21.427

这是您需要的：

```
new \DateTime('midnight first day of this month');
new \DateTime('first day of january'); 
```

我也会改变这个：

```
a.date > :date 
```

对此：

```
a.date >= :date 
```

# c# - 需要关于线程中创建的对象的生命周期的解释

> ID：10154033
> 
> 赞同：2
> 
> 时间：2012-04-14T13:32:56.587
> 
> 标签：c#, winforms, multithreading, object-lifetime

我有一个绑定到 BindingList 的 DevExpress GridControl。

我试图从一个线程修改 BindingList 并且这引发了一个异常，我用谷歌搜索它并找到以下解释：

*此问题与 XtraGrid 没有直接关系。不幸的是，您不能在后台线程中更改网格的数据源，因为这会导致很多同步问题。XtraGrid 可能会在您的后台线程更改它的同时对底层数据源执行一些操作。在这种情况下，网格稍后可能会收到更改通知，并会尝试从数据源更新行，这将导致上述问题。很多情况下可能会出现这个问题。例如，当用户编辑数据、对其进行分组或 XtraGrid 尝试重新计算摘要时。此问题的唯一解决方案是在后台线程中更改 Grid 的 DataSource 引用（注意：您需要使用 Invoke 方法来实现它）。换个说法，在后台线程中，您应该使用 DataSource 的本地副本，并在必要时将其克隆传递给 Grid 的 DataSource。在随附的示例中，您将找到一个演示此方法的示例项目。*

我尝试了它所说的，结果是：

```
proxyWorker = new Thread(() =>
{
    //Clone the datasource into the thread
    BindingList<Proxy> newList = new BindingList<Proxy>(proxies);

    //Set the proxy source to the cloned datasource in the thread
    gcProxies.BeginInvoke(new MethodInvoker(delegate { gcProxies.DataSource = newList; }));

   //Logic here
});

proxyWorker.Name = "proxyTester";

proxyWorker.Start(); 
```

它有效，但我不明白线程结束后数据源会发生什么？不是`newList`被毁了吗？

我在想的是，最后我会重新克隆 newList 并将其设置回`proxies`（原始数据源）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T17:21:02.937

我认为您的困惑源于您认为 .NET 对象与创建它的线程相关联。情况并非如此，进程中的所有线程共享同一个 GC 堆。在一个线程中创建的 List<> 对象与另一个线程中的 List<> 没有什么不同，它不会以任何方式使创建它的线程保持活动状态。

*线程的*一个问题是有很多类不是线程安全的。任何 UI 组件肯定都是这种情况。您*不能*做的是从另一个线程分配此类对象的属性，而该属性值也可以在 UI 线程中使用。UI 组件的几乎所有属性都有这个限制。数据绑定特别麻烦，因为属性分配不是直接可见的。您只设置 DataSource，而不是绑定设置的所有其他属性。使用 Control.BeginInvoke 或 Dispatcher.BeginInvoke 可确保在创建控件的同一线程中设置属性值，从而解决线程安全问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:38:41.693

那是“一对一”的 C# 垃圾收集

`new list`继续存在，通过`gcProxies.DataSource`.

直到您用完对该列表的引用为止，您都很好。

除非您正在访问跨线程或在一个线程中创建并在另一个线程中使用的“列表”有任何特定的“跨线程”问题 - 一切都会很好。
在这里，您只是在初始化并且除了通过 DataSource 之外再也不会使用它，所以一切都很好。

希望这可以帮助

编辑：回答评论，我简化了一下

您偶然创建对象的线程与对象的“生命周期”无关 - 即线程不拥有该对象。应用程序域可以（超出范围），但您可以“跨越”线程边界或做任何您想做的事情 - 但您“只需要”同步您的代码/对象。

# c# - 正在寻找 C# TDD 框架？

> ID：10154043
> 
> 赞同：4
> 
> 时间：2012-04-14T13:34:33.233
> 
> 标签：c#, tdd

是否有一个 C# 框架允许您以类似于 RSpec 适用于 Ruby 的方式遵循 TDD，并且允许这样做：

```
obj.should_receive(a).with(b).and_return(c) 
```

在我看来，xUnit + Moq 可能是 TDD 的不错选择。你怎么看待这件事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T01:22:04.530

[http://nspec.org/](http://nspec.org/)

NSpec 更类似于 RSpec。那是 BDD，而不是 TDD。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T02:21:18.547

我使用[Moq](http://code.google.com/p/moq/)和[FluentAssertions](http://fluentassertions.codeplex.com/)。添加诸如[SpecFlow](http://www.specflow.org/)或[StoryQ 之](http://storyq.codeplex.com/)类的东西，您应该一切顺利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T04:33:12.360

您可以查看[Sharp Tests Ex](http://sharptestex.codeplex.com/)。它将允许您编写这样的断言：

```
var c = mathObject.Add(5, 7);  
c.Should().Be.EqualTo(12); 
```

# c# - 在 XNA 中进行文本输入（用于输入姓名、聊天）

> ID：10154046
> 
> 赞同：6
> 
> 时间：2012-04-14T13:35:06.510
> 
> 标签：c#, text, input, xna, keyboard

我正在尝试实现键盘文本输入以在游戏中聊天、输入角色名称、保存文件名等。

我在弄乱 KeyboardState 试图让最新添加的符号转换成我可以添加到我的输入字符串中的字符，但它似乎以某种顺序对当前按下的键的数组进行排序（我敢打赌它是按键码排序的），所以我不能轻易找到最后按下哪个键将其添加到输入字符串。

是否有一种简单的方法来检测最后按下的文本键（包括按下多个键的情况，因为人们有时会这样做），还是更容易使用一些现有的解决方案？

我正在学习 C# 和 XNA，所以我希望自己能够做到，但最终我希望我的游戏能够正常工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T20:23:09.383

为了处理文本输入，您需要知道何时按下或释放某个键。不幸的是，XNA 的 KeyboardState 对此并没有真正的帮助，所以你必须自己做。基本上，您只需将当前更新的 PressedKeys 与上一次更新的 PressedKeys 进行比较。

```
public class KbHandler
{
    private Keys[] lastPressedKeys;

    public KbHandler()
    {
        lastPressedKeys = new Keys[0];
    }

    public void Update()
    {
        KeyboardState kbState = Keyboard.GetState();
        Keys[] pressedKeys = kbState.GetPressedKeys();

        //check if any of the previous update's keys are no longer pressed
        foreach (Keys key in lastPressedKeys)
        {
            if (!pressedKeys.Contains(key))
                OnKeyUp(key);
        }

        //check if the currently pressed keys were already pressed
        foreach (Keys key in pressedKeys)
        {
            if (!lastPressedKeys.Contains(key))
                OnKeyDown(key);
        }

        //save the currently pressed keys so we can compare on the next update
        lastPressedKeys = pressedKeys;
    }

    private void OnKeyDown(Keys key)
    {           
        //do stuff
    }

    private void OnKeyUp(Keys key)
    {
        //do stuff
    }
} 
```

给你的 Game 类一个 KbHandler，并从你的 Game 的 update 方法中调用它的 Update 方法。

（顺便说一句，比较两个数组可能比使用 foreach 和 Contains 更有效，但是要比较的项目很少，我怀疑它是否重要。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:45:14.947

[您可以尝试此处](http://www.riemers.net/eng/Tutorials/XNA/Csharp/Series2D/Keyboard_input.php)列出的示例

```
KeyboardState keybState = Keyboard.GetState();
if (keybState.IsKeyDown(Keys.Left)) {
  // process left key
}
if (keybState.IsKeyDown(Keys.Right)) {
  // process right key
} 
```

这将处理同时按下的多个键。如果你想避免这种情况，请`else`在第二个`if`（以及后面的）之前添加一个

此外，按住一个键将触发多个键按下事件——如果不需要，您将需要引入一个状态变量，当键按下时翻转，当它没有按下时，根据其状态继续键*被*按下

# iphone - iPhone App 与服务器的连接以下载内容

> ID：10154048
> 
> 赞同：0
> 
> 时间：2012-04-14T13:35:13.933
> 
> 标签：iphone, objective-c, ios, app-store, in-app-purchase

如果我问了一个非常愚蠢的问题，我很抱歉。

我正在设计一个包含短篇小说的应用程序 - 其中一些将与应用程序一起预安装，而其他（免费或付费）可以从我的服务器下载。所以我打算在我的网络服务器上创建一个 API，它可以满足我的应用程序的下载/购买请求。

问题是我有点困惑如何验证我的网络服务器 api 收到的请求是真正来自我的应用程序和真实用户，而不是来自想要获取我所有数据并构建自己的应用程序的竞争对手或程序在它的上面。

请帮忙。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:38:56.310

当用户进行应用内购买时，Store Kit API 会为您提供收据。您将该收据发送到您的服务器。然后，您的服务器可以与 Apple 验证收据，以确保收据有效。

请参阅[In-App Purchase Programming Guide](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)中的[验证商店收据](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html#//apple_ref/doc/uid/TP40008267-CH104-SW1)。

# ios - 在 iOS 上使用 OpenGL ES 避免半像素

> ID：10154050
> 
> 赞同：-2
> 
> 时间：2012-04-14T13:35:21.433
> 
> 标签：ios, opengl-es

我试图告诉 OpenGL ES 只渲染全像素。我正在开发一款像素风格的游戏，缩放后的精灵在屏幕上移动时会开始闪烁。我宁愿让他们跳进像素网格。有没有办法告诉 OpenGL 使用整数精度而不是浮点数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:25:10.650

您不能只启用像这样改变渲染的东西。您必须实际渲染所有内容，使其与像素网格对齐。责任在你，而不是 OpenGL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-15T23:56:16.923

为防止在绘制精灵时边框闪烁，您可以使用 1px 透明框架绘制纹理，在这种情况下，透明像素会闪烁，但您看不到，因为它是透明的。也不要忘记对图像进行预处理，因此对于透明像素，颜色将与邻居平均

# jquery - FancyBox v2.0 脚本混淆>jquery.fancybox.pack.js OR jquery.fancybox.js

> ID：10154052
> 
> 赞同：1
> 
> 时间：2012-04-14T13:35:48.143
> 
> 标签：jquery, fancybox

对下载中包含的 2 个不同的脚本文件有点困惑。

jquery.fancybox.pack.js

和

jquery.fancybox.js

在演示中它仅使用后者，但在自述文件和说明中它指的是前者。另外，我似乎找不到这两个文件之间的任何依赖关系。

有人可以在这里阐明一下吗？

我还注意到，缩略图和按钮助手在 iPad 上都不能正常工作（不出现），但这是一个单独的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:37:09.383

该`jquery.fancybox.pack.js`版本已*缩小*代码；它不是相同的源代码（应该映射到相同或等效的标记），但它具有完全相同的功能和更小的文件大小。

# mysql - MySQL - 按多行分组

> ID：10154058
> 
> 赞同：2
> 
> 时间：2012-04-14T13:36:41.203
> 
> 标签：mysql, group-by

我为我的用户进行了在线调查，每次用户回答调查时，我都会在这样的“survey_stats”表中捕获他们的详细信息 -

```
| id      | user_id | survey_id | key          | value   |
|---------|---------|-----------|--------------|---------|
|       1 |      10 |        99 | gender       | male    |
|       2 |      10 |        99 | age          | 32      |
|       3 |      10 |        99 | relationship | married |
|       4 |      11 |        99 | gender       | female  |
|       5 |      11 |        99 | age          | 27      |
|       6 |      11 |        99 | relationship | single  | 
```

换句话说，当用户回答调查时，我会在 3 行中捕获用户的属性（性别、年龄、关系）（每一行对应于用户的每个单独属性）。我们保持这种方式的原因是如果我们以后想扩展用户属性，我们可以在每个调查中添加更多记录，而不是修改survey_stats表结构。

我想构建一个 SQL 来生成这样的报告：

```
| age_group | male  |  female |
|-----------|-------|---------|
|   13 - 17 |    10 |       7 |
|   18 - 24 |    25 |      10 |
|   25 - 34 |    30 |      11 | 
```

非常感谢一些帮助，向我展示如何编写单个 SQL 语句来做到这一点。

仅供参考 - 我正在使用 MySQL。上述项目是一个 Ruby on Rails 应用程序。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:55:25.623

```
select
      case when YT2.age between 13 and 17 then "13 - 17"
           when YT2.age bewteen 18 and 24 then "18 - 24"
           when YT2.age between 25 and 35 then "25 - 34"
           else "35 and over" end as AgeGroup,
      Sum( if( YT1.value = "male", 1, 0 )) as MaleFlag,
      SUM( if( YT1.value = "female", 1, 0 )) as FemaleFlag
   from
      YourTable YT1
         JOIN YourTable YT2
             ON YT1.user_id = YT2.user_ID
            AND YT1.survey_id = YT2.survey_id
            AND YT2.key = "age"
   where
      YT1.Key = "gender"
   group by
      AgeGroup 
```

# javascript - 当我重新加载页面时，倒计时重新加载到

> ID：10154061
> 
> 赞同：0
> 
> 时间：2012-04-14T13:37:00.320
> 
> 标签：javascript, jquery, countdown

如何在 jquery.countdown 插件上保持时间？

倒计时运行正确，但是当我重新加载页面时，倒计时重新加载到，并且我想在重新加载时保持倒计时，我该怎么办？

[http://jsfiddle.net/wtkd/CUSnS/](http://jsfiddle.net/wtkd/CUSnS/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:42:23.103

您使用 2012 年 1 月 1 日作为您的倒计时目标（已经过去），然后您检查此条件并计算从现在起 12 小时后的时间点。如果您希望倒计时正常工作，则需要向固定日期计数，否则它将始终从 12:00:00 开始。“固定日期”意味着您需要将日期作为参数传递或以某种方式存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:43:11.407

它在 DOM 准备好后初始化，因此您无法保留剩余时间，您可以获取服务器的当前时间，并`echo`在 javascript 变量中说它并更新倒计时时间。

# php - 如何从 php 中的整个 cURL 响应中有效地获取一个特定的行？

> ID：10154068
> 
> 赞同：0
> 
> 时间：2012-04-14T13:37:23.323
> 
> 标签：php, performance

我通过使用 cURL 得到响应 $str。$str 是 html 格式，总包含 327 行。我想从最初的第 127 行获取日期

```
<b>Last Updated On:</b>17-Dec-2011 11:33:41 UTC<br><br> 
```

为了尝试减少 $str 使用的内存，在 cURl 之后，我确实这样做了

> $str = strip_tags($str);

然后，要获取完整的行，

> preg_match("/^Last Updated On......................./m", $str, $line);
> 
> $lastupdate = $line[0];

然后，要删除多余的文本，

> $lastupdate = str_replace("上次更新时间：", "", $lastupdate);

现在我认为这个 preg_match 语句不是最有效的。它使用了太多的点，必须有类似的东西

> LookFor = 最后更新时间：
> 
> 如果您看到 LookFor，请获取接下来的 25 个字符。

我使用正确的 preg_match 语法吗？目前它正在工作，并给了我想要的结果，但我不知道它是如何工作的。

请向我推荐这条预赛线的正确/有效等价物。

另外，我怎样才能告诉 PHP 直接跳转到第 127 行，而不是遍历所有前 126 行。所有以 [CR][LF] 结尾的行。

附言

*   我只需要接下来的 25 个字符。
*   我需要的线路永远是第 127 行
*   我将检索到的日期用作一串文本；没有计算，只存储在 .csv 文件中。但是，如果不是文本，我可以以正确的日期格式获取它，那真的会很高兴。现在它只是一串文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:45:37.923

**尝试这个 ：**

```
<?php

    // get the lines in an array
    $lines = explode("\n",$str);

    // get the 127th line
    $line = $lines[126];

    // get the date
    preg_match('/<\/b>(.+)<br><br>/', $line, $matches);

    $date = $matches[1];

    echo $date;

?> 
```

**输出 ：**

```
17-Dec-2011 11:33:41 UTC 
```

# javascript - 为什么使用ajax加载时警报功能不起作用

> ID：10154075
> 
> 赞同：1
> 
> 时间：2012-04-14T13:38:28.397
> 
> 标签：javascript, ajax

我有一个页面 index.html

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
 <title>Lufia</title>
 <script language="javascript" type="text/javascript">
 function ajax()
 {

var xmlhttp;
if (window.XMLHttpRequest)
  {
  xmlhttp=new XMLHttpRequest();
  }
else
  {
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }

xmlhttp.onreadystatechange=function()
  {if (xmlhttp.readyState==4 && xmlhttp.status==200)
   document.getElementById('mydiv').innerHTML=xmlhttp.responseText;
  }
  xmlhttp.open("GET",'welcome.html',true);
xmlhttp.send();
 }
 </script></head>
<body>

<button onclick="ajax();"></button><div id="mydiv"></div></body>
</html> 
```

还有一个叫做welcome.html的页面

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
 <title>Lufia</title>

<body onload="alert('ank');">welcome
</body>
</html> 
```

我希望它在welcome.html通过ajax加载时提醒ank，因为警报功能写在welcome.html的body onload属性上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:42:08.050

对于初学者，您尝试插入的 HTML 无效。它不仅格式不正确（没有根元素、没有头部、头部外的标题），而且它不是文档片段（这是*大多数*人在通过 AJAX 加载 HTML 时返回的内容）。

所以浏览器正在尽其所能，包括**剥离新`<body>`标签**。由于它被删除，该事件显然无法触发。

你为什么要这样做？您已经拥有了等价物`onload`- 您甚至首先使用它来将 HTML 放在您`<div>`的位置。就在那里做事。

旁注：如果您认为添加`<script>`通孔`innerHTML`会起作用，这里有一些建议：它不会。

# c++ - 移动构造函数的奇怪编译错误

> ID：10154085
> 
> 赞同：4
> 
> 时间：2012-04-14T13:39:39.783
> 
> 标签：c++, constructor, move

我正在尝试制作移动构造函数，但出现错误

```
expected ',' or '...' before '&&' token 
```

这是导致问题的行：

```
List(List&& list) noexcept; 
```

我还有一个看起来相似的复制构造函数。不知道这是否会引起麻烦：

```
List(const List& copy); 
```

（这都在我的 List 类的头文件中）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T13:41:07.177

确保您使用可以编译 C++11 代码的编译器（并设置为这样做），这在 C++ 标准的早期版本中无效

# c# - 实体集与对象集有什么不同

> ID：10154087
> 
> 赞同：4
> 
> 时间：2012-04-14T13:39:59.190
> 
> 标签：c#, sql-server, linq, entity

谁能告诉我 EntityFramework 中的 EntitySet 和 ObjectSet 有什么不同？

感谢您的指导

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T00:11:28.817

您的问题在这里得到了很好的回答：http: [//social.msdn.microsoft.com/Forums/en/adonetefx/thread/c76d72c0-951c-4033-b75f-fc84f735826e](http://social.msdn.microsoft.com/Forums/en/adonetefx/thread/c76d72c0-951c-4033-b75f-fc84f735826e)

希望有帮助。

# android - Android获取JSON键值

> ID：10154090
> 
> 赞同：0
> 
> 时间：2012-04-14T13:40:35.153
> 
> 标签：android, json

我对解析特定`json`字符串有疑问。我没有找到任何对我的情况有帮助的东西。我有这个 json ：

```
{
"AM": {
    "country_name": "Armenia", 
    "data": {
        "180854": {
            "time_published": "2012-03-30 13:31:39", 
            "title": "Example", 
        }, 
        "180926": {
            "time_published": "2012-04-02 05:21:44", 
            "title": "Example", 
        }, // keeps going on
    }
},
"BM": {
    "country_name": "Bolivia", 
    "data": {
        "180854": {
            "time_published": "2012-03-30 13:31:39", 
            "title": "Example", 
        }, 
        "180926": {
            "time_published": "2012-04-02 05:21:44", 
            "title": "Industrial PPI inflation eases to 5.5% y/y in February", 
        }
    }
    }, // continues
} 
```

所以我想知道的是有没有办法获得它的价值`JSONObject`：`AM`，`BM`。它们每次都不同，所以我无法检查它们，但我希望能够将它们保存为`String`. 这是我实际用来解析 JSON 的内容：

```
 public static void jsonParser(String jsonBuffer){

    try {

        //String jsonData = new String(jsonBuffer,"UTF-8");
        JSONObject json = (JSONObject) new JSONTokener(jsonBuffer).nextValue();

        //JSONObject country = json.getJSONObject(String.valueOf(json.keys().next()));
        Log.d("","json : "+json);
        Iterator<Object> keys = json.keys();
        while (keys.hasNext()) {
             JSONObject country = json.getJSONObject(String.valueOf(keys.next()));

            String countryName = country.getString("country_name");
            Log.e("","country_name: "+countryName);

            JSONObject data = country.getJSONObject("data");

            Iterator<Object> keys2 = data.keys();

            while(keys2.hasNext()){
                JSONObject datas = data.getJSONObject(String.valueOf(keys2.next()));

                String published = datas.getString("time_published");
                Log.d("","published : "+published);

                String title = datas.getString("title");
                Log.w("","title : "+title);
            }
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }
} 
```

那么有什么建议我怎样才能得到这些值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T13:51:08.153

我不知道我对你的理解是否正确。您希望将“AM”和“BM”作为字符串值，以便您拥有国家名称的短标签。

“AM”是您要迭代的键：`keys.next()`

```
String short = String.valueOf(keys.next());
JSONObject country = json.getJSONObject(short); 
```

# css - 如果用户有特殊字体，我可以制作 font-weight:bold 吗？

> ID：10154091
> 
> 赞同：0
> 
> 时间：2012-04-14T13:40:35.557
> 
> 标签：css, fonts

我有一个文字`font-family: "Lucida Grande", tahoma, arial, sans-serif;`

Lucida Grande 在字体粗细下看起来不错：粗体，但 tahoma 不是，反之亦然： tahoma 在正常字体粗细下看起来不错，但 Lucida Grande 不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T13:57:34.610

不，没有办法让字体粗细取决于字体系列。

通常，该`font-family`属性的值应该是*相似*字体的列表，以便它们中的任何一个都与整体设计相匹配。Lucida Grande 与 Tahoma 和 Arial 有很大不同，它们彼此有很大不同。更好的替代品是 Lucida Sans 和 Lucida Sans Unicode。不要忘记使用您列出的每种字体来测试外观，而不是仅仅从某个地方复制字体系列列表。

这可能会消除在正常和粗体之间交替的需要——任何这样的需要都可能是字体选择不兼容的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:00:20.060

[RemySharp 的 font.js](http://remysharp.com/2008/07/08/how-to-detect-if-a-font-is-installed-only-using-javascript/)可能很有用。:)

使用 jQuery，基本上它检查提到的字体是否存在。那么在你的情况下，如果 Lucida Grande 存在，你可以用它加粗`$('.yourelement').css('font-weight, bold');`

# javascript - Safari 上的 JavaScript 文件优先级

> ID：10154092
> 
> 赞同：1
> 
> 时间：2012-04-14T13:40:45.320
> 
> 标签：javascript, safari

我正在开发一个严重依赖 JavaScript 的应用程序。我的应用程序在 Chrome 中运行良好。但是，我正在对 Safari 进行一些测试，但遇到了一些问题。据我所知，我的一个 JavaScript 文件要么未加载，要么不可见。我在我的页面中引用了两个 JavaScript 文件：

```
<script type="text/javascript" src="/scripts/app.formatters.js"></script>
<script type="text/javascript" src="/scripts/app.js"></script> 
```

app.formatters.js 有一些实用方法可以帮助我格式化日期/时间、文本、货币值等。app.js 是我的应用程序的主要逻辑。app.js 引用了一个名为“formatDate”的函数，该函数位于 app.formatters.js 中。我已将 alert("here") 设置为该文件的第一行。它在 Chrome 中运行良好。但是，在 Safari 中，警报永远不会触发。更让我困惑的是，控制台中没有写入任何错误。

是否有一些奇怪的 javascript 优先级，在 Safari 中加载我不知道的东西？

谢谢！

# xcode - 如何使用 Xcode 列出为提交更改的所有文件并查看每个文件的更改？

> ID：10154094
> 
> 赞同：1
> 
> 时间：2012-04-14T13:41:01.060
> 
> 标签：xcode

我正在使用 Xcode 4.3。有办法查看单个文件的修订和差异，但有没有办法查看例如昨天下午 3 点提交的文件列表：

```
main.m  
House.m  
House.h 
```

以及提交消息，单击每个文件将显示该文件的差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:55:44.403

最好的方法是转到 Organizer → Repositories → Expand commit（单击 ▶）并单击“（查看更改）”按钮。这将让您逐个文件查看差异文件，但不能同时查看整个提交。

使用[GitX](http://gitx.laullon.com/)，它在显示 git 历史记录方面比 Xcode 好得多——你会看到每次提交的差异，以及合并和分支。

两者都可以同时在同一个存储库上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-20T08:50:49.400

在现代 Xcode（版本 10+）中，您可以在以下位置查看所有跟踪更改：

> 源代码管理 > 提交...

在 Xcode 菜单中。

# php - 如何上传具有不同文件名的文件

> ID：10154106
> 
> 赞同：1
> 
> 时间：2012-04-14T13:43:04.790
> 
> 标签：php

我有一个名为“name=fileImage”的文件输入。现在我在下面有 php 代码，它检查文件夹（ImageFiles）中是否存在文件：

```
if (file_exists("ImageFiles/" . $_FILES["fileImage"]["name"]))
  {

  } 
```

我的问题是，如果文件夹中确实存在一个文件，如何对其进行编码以便它仍然上传文件但它给它一个不同的文件名。也许像在文件名的末尾自动添加一个数字给它一个不同的文件名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T13:47:33.570

`$_FILES`只是一个变量，恰好是超全局变量，并且预先填充了文件上传数据。这意味着您可以轻松更改它。

例如：

```
if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) {
    $parts = explode(".",$_FILES['fileImage']['name']);
    $ext = array_pop($parts);
    $base = implode(".",$parts);
    $n = 2;
    while( file_exists("ImageFiles/".$base."_".$n.".".$ext)) $n++;
    $_FILES['fileImage']['name'] = $base."_".$n.".".$ext;
}
// now use $_FILES['fileImage']['name'] just like you would normally 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:35:24.920

如果您想将上传的文件重命名为您自己选择的名称，您可以尝试

```
<?php

    //Any file name user/uploader has chosen/used on his/her computer
    $tmp_name = $_FILES["domainfile"]["tmp_name"];

    //Name you want
    $name = "MyDesiredName.png"; //save as MyDesiredName.png

    //Move/save file
    move_uploaded_file($tmp_name, $name);

?> 
```

显然，每次上传新文件时，此代码都会替换旧文件。
为了不让这种情况发生，您需要在 $name 中引入一些变量
并执行 $name++ 并找到一种方法来存储其值以供将来参考。

# php - 获取 Post by CURL 后的新 url

> ID：10154107
> 
> 赞同：0
> 
> 时间：2012-04-14T13:43:09.240
> 
> 标签：php, redirect, curl

这是一个例子：

原始网址是`http://www.vietbando.com/maps/#t=1&sk=258+lý+Thường+Kiệt`

当我发布表格时。

它像这样更改为新的 URL

```
http://www.vietbando.com/maps/#t=1&sk=258+lý+Thường+Kiệt&l=4&kv=15.0132985,106.744091 
```

如何获取新网址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:59:02.097

如果您指的是重定向，则新 URL 应始终位于`Location`响应的标头中。

要获取 curl 请求中包含的标头，请`CURLOPT_HEADER`通过`curl_set_opt`.

如果您对导航到/获取下一个 URL 而不是获取实际 URL 更感兴趣，则可以使用`FOLLOW_REDIRECTS`设置。

最后，如果您正在执行任何类型的 HTTP 工作而不是几次调用，我强烈建议您使用 HTTP 库（因为 PHP cURL 是一种折磨）。请参阅[Guzzle](http://guzzlephp.org/)、[Httpful](http://phphttpclient.com)或[Requests](http://requests.ryanmccue.info/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:04:10.707

在这种情况下，您可以解析响应的标题以获取 url。您必须使用此代码来执行此操作：

```
$ch_url = curl_init();
curl_setopt($ch_url, CURLOPT_URL, 'http://www.example.com/)'; //your first url
curl_setopt($ch_url, CURLOPT_USERAGENT, 'AppleWebKit/530.5 (KHTML, like Gecko) Chrome/2.0.172.39 Safari/530.5');
curl_setopt($ch_url, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch_url, CURLOPT_HEADER, 1);
curl_setopt($ch_url, CURLOPT_NOBODY, 1); //we don't need to recieve the body of response
$headers = curl_exec($ch_url);
curl_close ($ch_url);

$pattern = '`.*?((http)://[\w#$&+,\/:;=?@.-]+)[^\w#$&+,\/:;=?@.-]*?`i'; //this regexp finds your url
if (preg_match_all($pattern,$headers,$matches))
    $url = $matches[1][0]; //your second url 
```

# jquery - 带有 Spring MVC 的 JQuery Full Calendar .. 无法调用控制器来获取 JSON 对象

> ID：10154113
> 
> 赞同：3
> 
> 时间：2012-04-14T13:43:39.393
> 
> 标签：jquery, json, spring-mvc, fullcalendar

我正在尝试将 JQuery [Full Calendar](http://arshaw.com/fullcalendar/)与 Spring MVC + Freemarker 一起使用。

我做了一个这样的[演示](http://arshaw.com/js/fullcalendar-1.5.3/demos/selectable.html)。

目标：我需要调用控制器来获取包含要在日历上呈现的事件的 JSON 对象。

问题：我有以下 freemarker，它应该去控制器并获取 JSON 对象来呈现，但它没有去？！

自由标记：

[#ftl /]

```
<script type="text/javascript">
    $(document).ready(function() {

        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();

        var calendar = $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            selectable: true,
            selectHelper: true,
            select: function(start, end, allDay) {
                var title = prompt('Event Title:');
                if (title) {
                    calendar.fullCalendar('renderEvent',
                    {
                        title: title,
                        start: start,
                        end: end,
                        allDay: allDay
                    },
                            true // make the event "stick"
                            );
                }
                calendar.fullCalendar('unselect');
            },
            editable: true,
            events: [
                {
                    url: '[@spring.url '/vacation/getVacation'/]',
                    type: 'GET',

                    data: {
                        start: 'start',
                        id: 'id',
                        title: 'title'
                    }

                }
            ]
        });

    }); 
```

```
body {
    margin-top: 40px;
    text-align: center;
    font-size: 14px;
    font-family: "Lucida Grande", Helvetica, Arial, Verdana, sans-serif;
}

#calendar {
    width: 900px;
    margin: 0 auto;
} 
```

控制器：

```
@RequestMapping(value = "/vacation/getVacation", method = RequestMethod.GET)
    public @ResponseBody   void getVacation(HttpServletResponse response) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("id", 111);
        map.put("title", "event1");
        map.put("start", "2011-07-28");
        map.put("url", "http://yahoo.com/");

        // Convert to JSON string.
        String json = new Gson().toJson(map);

        // Write JSON string.
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");
        try {
            response.getWriter().write(json);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

萤火虫射击： ![在此处输入图像描述](../Images/88b4b759e78f26dfd8005f1abb289136.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T21:34:00.873

最后，我让它工作:) 我已经使用 $.getJSON 来获取 json 对象。

自由标记：

```
 $(document).ready(function() {
            var date = new Date();
            var d = date.getDate();
            var m = date.getMonth();
            var y = date.getFullYear();
          $.getJSON('[@spring.url '/vacation/getVacation'/]', function (data) {
            var calendar = $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                selectable: true,
                selectHelper: true,
                select: function(start, end, allDay) {
                    var title = prompt('Event Title:');
                    if (title) {
                        calendar.fullCalendar('renderEvent',
                        {
                            title: title,
                            start: start,
                            end: end,
                            allDay: allDay
                        },
                                true // make the event "stick"
                                );
                    }
                    calendar.fullCalendar('unselect');
                },
                editable: true,
                events:[data]
            });
         });
        }); 
```

Java 控制器：

```
@RequestMapping(value = "/vacation/getVacation", method = RequestMethod.GET)
    public
    @ResponseBody
    String getVacation(HttpServletResponse response) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("id", 111);
        map.put("title", "event1");
        map.put("start", "2012-4-15");
        map.put("url", "http://yahoo.com/");

        // Convert to JSON string.
        String json = new Gson().toJson(map);

        // Write JSON string.
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");

        return json;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:56:02.457

```
@RequestMapping(value = "/vacation/getVacation", method = RequestMethod.GET)
    @ResponseBody
    public String getVacation(HttpServletResponse response) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("id", 111);
        map.put("title", "event1");
        map.put("start", "2011-07-28");
        map.put("url", "http://yahoo.com/");

        // Convert to JSON string.
        String json = new Gson().toJson(map);

        // Write JSON string.
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");
        return json; //Try simply returning the json
    } 
```

根据spring文档：@ResponseBody注解类似于@RequestBody。此注解可以放在方法上，并指示返回类型应直接写入 HTTP 响应正文（而不是放在模型中，或解释为视图名称）。

例如：

```
@RequestMapping(value = "/something", method = RequestMethod.PUT)
@ResponseBody
public String helloWorld()  {
  return "Hello World";
} 
```

我不确定这是否不同于：

```
response.getWriter().write(json); 
```

这篇文章讨论了差异，其中一个解决方案提到了与 freemarker 的冲突：[Spring mvc has response.write to output to the browser directly？](https://stackoverflow.com/questions/3146461/does-spring-mvc-have-response-write-to-output-to-the-browser-directly)

还可以尝试在您的 ajax 调用中指定预期的数据类型：

```
$(document).ready(function () {
     var calendar = $('#calendar').fullCalendar({
         editable: true,
         eventSources: [{
         // your event source
             url: '[@spring.url '/vacation/getVacation'/]', // I was expecting here to call the controller,but nothing is happened !!
             type: 'GET',
             data: {
                 start: 'start',
                 id: 'id',
                 title: 'title,'
             },
             error: function () {
                 alert('there was an error while fetching events!');
             },
             color: 'yellow',
             textColor: 'black',
             dataType: 'json'
         }])
     };)
 }; 
```

正如建议的那样，我还将在调试模式下运行您的应用程序，在控制器中设置一个调试点，以查看代码是否被命中。如果不是用 firebug 分析您的请求中使用的 url。

检查 spring 用于设置调度程序的配置文件。通常在此配置中注册 InternalResourceViewResolver。这是我的一个例子：

```
<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
<beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".jsp" />
</beans:bean> 
```

如果您找到此配置，请确保它指向您存储 jsp 文件的区域。

我刚刚从您的评论中注意到的另一件事。你说萤火虫显示你试图点击这个网址：

:eventSources: [{ // 你的事件源 url: '/springway/vacation/getVacation', type: 'GET', data: { start: 'start', id: 'id', title: 'title,' }

我不喜欢格式化的方式，特别是它包含注释，这可能会使该行的其余部分变得毫无意义或在 url 中使用。我会使用 firebug 中的 net 面板来查看这个，它显示了通过网络传输的请求。这将向您显示您尝试点击的真实网址。

我还会在你的 js 中编辑这一行：

```
url: '[@spring.url '/vacation/getVacation'/]', 
```

至：

```
url: '/vacation/getVacation', 
```

我不熟悉@spring.url，但在我看来，它目前弊大于利。

# php - preg_replace 的 URL 正则表达式，但不匹配 bbcode [url] 中的 url

> ID：10154116
> 
> 赞同：3
> 
> 时间：2012-04-14T13:44:20.443
> 
> 标签：php, regex, bbcode

我在网站上发表评论部分。起初我需要做一个正则表达式来查找任何 url 并将其替换为

```
<a href="url"></a> 
```

所以我找到了一个超级正则表达式来查找评论中的所有 url，我做了一个函数来返回所有带有 html 标记的 url：

```
function addURLTags($string) {
    $pattern = "/(?i)\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'\".,<>?«»“”‘’]))/";
    return preg_replace($pattern, '<a href="$1">$1</a>', $string);
} 
```

一切都很顺利。但是一周前我的老板告诉我，现在我必须将 bbcode 添加到评论部分。我就像“没问题”......但后来他告诉我我的功能 addURLTags 必须留下。

所以任何这样的字符串：

```
http://www.google.com
[url]http://www.google.com[/url]
[url="http://www.google.com"]http://www.google.com[/url] 
```

必须替换为相同的字符串：

```
<a href="http://www.google.com">http://www.google.com</a> 
```

所以我得到了一个小 php 库，它将所有 bbcode 出现替换为 html 代码。

我想：“好吧，**首先**我应该得到所有在开始时没有 [url] 标签的 url 出现！然后我替换所有 bbcode 标签”

我试图在超级正则表达式的开头添加一个否定断言，如下所示：

/(?i)\b((?![url])(?:https?://|www\d{0,3}[.]|[a-z0-9.-]+[.][ az]{2,4}/)(?:[^\s()<>]+|(([^\s()<>]+|(([^\s()<>]+)) ) *))+(?:(([^\s()<>]+|(([^\s()<>]+)))* )|[^\s`!()[]{}; :'\".,<>?«»“”'']))/

但没用！

我是一个使用正则表达式的新手，我尝试过的所有在线测试人员都不能很好地使用这么长的正则表达式。我不知道还有什么尝试。

你有什么建议吗？你知道有和没有 [url] bbcode 标签的“url 替换”的任何 PHP 库吗？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:28:52.663

你在这里解决了两个问题。因此，分别解决它们，不要将所有内容都放入一个正则表达式中，这或多或少会使事情变得更复杂而不是更少。

分而治之：

首先使用您的 bbcode 库找到这些 url 所在的部分，以便您可以创建文本流：

```
"normal text", "bbcode", "normal text", "bbcode" 
```

然后您应用 bbcode 库仅在“bbcode”段上创建 URL，并且您的 URL clickable-maker 将仅应用于“普通文本”段。

处理完所有段后，将所有段连接回一个字符串。

瞧，问题解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T13:49:49.543

最好先解析`[url]`BBCode，然后将任何裸 URL 制作成链接。这很容易通过使用否定的lookbehind来实现，以确保URL之前没有双引号。这是有效的，因为您应该已经将原始字符串中的引号转换为`&quot;`，因此必须将 URL 之前的任何实际引号作为链接创建者的一部分放在那里。

# java - 如何使用snakeyaml 作为返回某些东西的函数？

> ID：10154117
> 
> 赞同：0
> 
> 时间：2012-04-14T13:44:27.757
> 
> 标签：java, yaml, snakeyaml

我正在尝试使用snakeyaml 制作一个转储int、字符串和字符串[] 的函数。问题是我不知道如何编写函数以便可以插入信息。

例如：

```
public void testDump() {
    Map<String, Object> data = new HashMap<String, Object>();
    data.put("name", "Silenthand Olleander");
    data.put("race", "Human");
    data.put("traits", new String[] { "ONE_HAND", "ONE_EYE" });
    Yaml yaml = new Yaml();
    String output = yaml.dump(data);
    System.out.println(output);
} 
```

我需要像`"name"`和`"Silenthand Olleander"`可配置的东西。我也不知道这个函数到底是做什么的。它会创建一个新文件吗？因为我需要它在现有的 strings.yml 文件中添加一行。所以我希望 string.yml 的格式是这样的：

```
#String.yml file
0 name_here The array of argument messages here.
1 name_here Another array of argument messages here.
2 name_here And again... I think you get the point. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:57:53.407

由于代码（最终）来自[文档](http://code.google.com/p/snakeyaml/wiki/Documentation#Dumping_YAML)，我假设您已经阅读过。

该调用`yaml.dump()`不会创建文件，而是返回一个字符串（然后您可以将其[放入文件中](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/FileOutputStream.html)）。根据文档，该`dump`方法将正确处理列表/数组。

要使 HashTable 中的键（例如“名称”）可配置，您可以将所需的值传递给填充表的函数。

根据您的问题，尽管您似乎需要一个关于如何使用 Java 本身进行编程的速成课程，然后才能处理 snakeyaml。

# android - 收听后台服务中的音量按钮？

> ID：10154118
> 
> 赞同：47
> 
> 时间：2012-04-14T13:44:40.610
> 
> 标签：android, volume, listen

我知道如何在活动中收听音量按钮。但是我可以在后台服务中做到这一点吗？如果是，该怎么做？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-08T10:50:58.200

有可能的。使用下面的代码（对于较新的 Android 版本，尤其是 Marshmallow，请参见答案的底部）：

```
public class SettingsContentObserver extends ContentObserver {
    int previousVolume;
    Context context;

    public SettingsContentObserver(Context c, Handler handler) {
        super(handler);
        context=c;

        AudioManager audio = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
        previousVolume = audio.getStreamVolume(AudioManager.STREAM_MUSIC);
    }

    @Override
    public boolean deliverSelfNotifications() {
        return super.deliverSelfNotifications();
    }

    @Override
    public void onChange(boolean selfChange) {
        super.onChange(selfChange);

        AudioManager audio = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
        int currentVolume = audio.getStreamVolume(AudioManager.STREAM_MUSIC);

        int delta=previousVolume-currentVolume;

        if(delta>0)
        {
            Logger.d("Ściszył!"); // volume decreased.
            previousVolume=currentVolume;
        }
        else if(delta<0)
        {
            Logger.d("Zrobił głośniej!"); // volume increased.
            previousVolume=currentVolume;
        }
    }
} 
```

然后在您的服务 onCreate 中注册它：

```
mSettingsContentObserver = new SettingsContentObserver(this,new Handler());
getApplicationContext().getContentResolver().registerContentObserver(android.provider.Settings.System.CONTENT_URI, true, mSettingsContentObserver ); 
```

然后在 onDestroy 中注销：

```
getApplicationContext().getContentResolver().unregisterContentObserver(mSettingsContentObserver); 
```

注意这个例子是根据媒体音量的变化来判断的，如果你想用其他的音量，就改变吧！

更新：

上面的方法据说在 Marshmallow 上不起作用，但是自从 MediaSession 被引入以来，现在有了更好的方法！因此，首先您必须将代码迁移到 MediaController/MediaSession 模式，然后使用以下代码：

```
private VolumeProviderCompat myVolumeProvider = null;

myVolumeProvider = new VolumeProviderCompat(VolumeProviderCompat.VOLUME_CONTROL_RELATIVE, maxVolume, currentVolume) {
    @Override
    public void onAdjustVolume(int direction) {
        // <0 volume down
        // >0 volume up

    }
};

mSession.setPlaybackToRemote(myVolumeProvider); 
```

即使屏幕关闭，也会以某种方式检测到音量按钮按下（如果适用于您的平台，请务必注册正确的媒体按钮意图接收器！）

更新 2，因为 GalDude 要求提供有关获取媒体 MediaSession/MediaController 的更多信息。抱歉，但由于我停止使用 Java，它将在 Kotlin 中：

```
lateinit var mediaSession: MediaSessionCompat // you have to initialize it in your onCreate method
val kontroler: MediaControllerCompat
 get() = mediaSession.controller // in Java it's just getController() on mediaSession

// in your onCreate/start method:
mediaSession = MediaSessionCompat(this, "YourPlayerName", receiver, null)
mediaSession.setFlags(MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS or MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS)
mediaSession.isActive = true
if (ratingIsWorking) // note: rating crashes on some machines you have to check it!
    mediaSession.setRatingType(RatingCompat.RATING_5_STARS)

mediaSession.setCallback(object : MediaSessionCompat.Callback() {
...
// here you have to implement what happens with your player when play/pause/stop/ffw etc. is requested - see exaples elsewhere
})

// onDestroy/exit method:
mediaSession.isActive = false
mediaSession.release() 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-16T18:45:27.683

AOSP 音乐应用有一个服务 ( [MediaPlaybackService )，它通过注册一个 BroadcastReceiver (](https://github.com/android/platform_packages_apps_music/blob/master/src/com/android/music/MediaPlaybackService.java) [MediaButtonIntentReceiver](https://github.com/android/platform_packages_apps_music/blob/master/src/com/android/music/MediaButtonIntentReceiver.java) )来响应音量键事件。

这是它注册接收器的代码片段：

```
 mAudioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
    ComponentName rec = new ComponentName(getPackageName(),
            MediaButtonIntentReceiver.class.getName());
    mAudioManager.registerMediaButtonEventReceiver(rec); 
```

另外，不要忘记清单：

```
 <receiver android:name="com.android.music.MediaButtonIntentReceiver">
        <intent-filter>
            <action android:name="android.intent.action.MEDIA_BUTTON" />
            <action android:name="android.media.AUDIO_BECOMING_NOISY" />
        </intent-filter>
    </receiver> 
```

即使音乐应用程序不在前台，这也有效。这不是你想要的吗？

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-04-09T08:21:37.447

我能够使用`MediaSession`. 但是，`ContentObserver`@ssuukk 的建议在 4.4 和 7.0 设备上都不适用于我（至少在我一直在测试的 ROM 上）。这是一个适用于 android 5+ 的完整示例。

服务：

```
import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.support.v4.media.VolumeProviderCompat;
import android.support.v4.media.session.MediaSessionCompat;
import android.support.v4.media.session.PlaybackStateCompat;

public class PlayerService extends Service {
    private MediaSessionCompat mediaSession;

    @Override
    public void onCreate() {
        super.onCreate();
        mediaSession = new MediaSessionCompat(this, "PlayerService");
        mediaSession.setFlags(MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS |
                MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS);
        mediaSession.setPlaybackState(new PlaybackStateCompat.Builder()
                .setState(PlaybackStateCompat.STATE_PLAYING, 0, 0) //you simulate a player which plays something.
                .build());

        //this will only work on Lollipop and up, see https://code.google.com/p/android/issues/detail?id=224134
        VolumeProviderCompat myVolumeProvider =
                new VolumeProviderCompat(VolumeProviderCompat.VOLUME_CONTROL_RELATIVE, /*max volume*/100, /*initial volume level*/50) {
            @Override
            public void onAdjustVolume(int direction) {
                /*
                -1 -- volume down
                1 -- volume up
                0 -- volume button released
                 */
            }
        };

        mediaSession.setPlaybackToRemote(myVolumeProvider);
        mediaSession.setActive(true);
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        mediaSession.release();
    }
} 
```

在`AndroidManifest.xml`：

```
<application ...>
    ...
    <service android:name=".PlayerService"/>
</application> 
```

在您的活动中：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ...
    startService(new Intent(this, PlayerService.class));
} 
```

有几件事需要注意：

*   *它完全*拦截音量按钮，因此当此代码运行时，您将无法使用音量按钮调整铃声音量。这可能是可以解决的，我只是没有尝试。
*   如果您按原样运行示例，即使屏幕关闭并且应用程序已从“最近的应用程序”列表中删除，音量按钮仍将由应用程序控制。您必须转到`Settings->Applications`，找到该应用程序并强制停止它才能恢复音量按钮。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2019-08-06T09:20:57.387

不幸的是，这是 Android 的另一个领域，有五种不同的方法可以“解决问题”，但大多数都不能很好地工作。为了我自己的理智，我将尝试在下面列出所有不同的方法。

# 解决方案

### 1）`MediaSession`（来自服务）

Denis Kniazhev 的回答：[https ://stackoverflow.com/a/43304591/2441655](https://stackoverflow.com/a/43304591/2441655)

> 缺点：
> 
> 1.  需要 Android API 级别 21+ (Android 5.0+)。

### 2）`android.media.VOLUME_CHANGED_ACTION`（来自服务）

Nikhil 的回答：[https ://stackoverflow.com/a/44040282/2441655](https://stackoverflow.com/a/44040282/2441655)

> 缺点：
> 
> 1.  不是 SDK 的官方部分：[https ://stackoverflow.com/a/8974510/2441655](https://stackoverflow.com/a/8974510/2441655)
> 2.  忽略第一次按音量键（因为它只显示音量条）。
> 3.  100% 时忽略音量增大键，0% 时忽略音量减小键。

### 3）`ContentObserver`（来自服务）

ssuukk 的回答：[https](https://stackoverflow.com/a/15292255/2441655) ://stackoverflow.com/a/15292255/2441655 （第一部分）

> 缺点：
> 
> 1.  不适用于较新版本的 Android：[dsemi的评论](https://stackoverflow.com/questions/10154118/listen-to-volume-buttons-in-background-service#comment55056397_15292255)
> 2.  忽略第一次按音量键（因为它只显示音量条）。
> 3.  100% 时忽略音量增大键，0% 时忽略音量减小键。

### 4）`AudioManager.registerMediaButtonEventReceiver`（来自服务）

乔的回答：[https ://stackoverflow.com/a/11510564/2441655](https://stackoverflow.com/a/11510564/2441655)

> 缺点：
> 
> 1.  不适用于大多数 rom：[elgui 的评论](https://stackoverflow.com/questions/10154118/listen-to-volume-buttons-in-background-service#comment18851137_11510564)

### 5）`onKeyDown`（来自活动）

dipali 的回答：[https ://stackoverflow.com/a/21086563/2441655](https://stackoverflow.com/a/21086563/2441655)

> 缺点：
> 
> 1.  如果屏幕关闭，在不同的应用程序中等，则不起作用。

### 6）`dispatchKeyEvent`（来自活动）

Maurice Gavin 的回答：[https ://stackoverflow.com/a/11462962/2441655](https://stackoverflow.com/a/11462962/2441655)

> 缺点：
> 
> 1.  如果屏幕关闭，在不同的应用程序中等，则不起作用。

# 结论

我目前使用的解决方案是#1，因为：

1.  它是 SDK 的官方部分。
2.  从服务可以使用。（即，无论您使用什么应用程序）
3.  无论当前音量/用户界面状态如何，它都会捕获每次音量键按下。
4.  它在屏幕关闭时工作。

让我知道你是否发现了其他的——或者你是否发现了其中一些的更多缺点！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-07-09T14:37:11.437

从关于这个话题的其他几个问题来看，没有。

[其他问题 1](https://stackoverflow.com/questions/2986337/is-it-possible-to-create-an-android-service-that-listens-for-hardware-key-presse) , [其他问题 2](https://stackoverflow.com/questions/3454710/onkeydown-in-a-service-global-hot-keys)

服务根本不接收 KeyEvent 回调。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-09-22T06:07:27.300

您需要从服务中播放空白声音，然后只有您可以收听音量变化。以下为我工作

## 脚步

## 1.将blank.mp3放入原始文件夹（从[这里](https://drive.google.com/open?id=0B9c2cKcXamU2SElheTJIN0tEZGM)下载）

## 2\. 在 onStartCommand() 处启动媒体

```
private MediaPlayer mediaPlayer;

public MyService() {
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {

    ........

    mediaPlayer = MediaPlayer.create(this, R.raw.blank);
    mediaPlayer.setLooping(true);
    mediaPlayer.start();

    .......

    return START_STICKY;
} 
```

## 3.您必须选择停止和释放媒体播放器。最好在 onDestroy() 中这样做

```
@Override
public void onDestroy() {

    mediaPlayer.stop();
    mediaPlayer.release();

    super.onDestroy();
} 
```

## 4\. 创建将监听音量变化的广播接收器

```
int volumePrev = 0;

private BroadcastReceiver broadcastReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {

        if ("android.media.VOLUME_CHANGED_ACTION".equals(intent.getAction())) {

            int volume = intent.getIntExtra("android.media.EXTRA_VOLUME_STREAM_VALUE",0);

            Log.i(TAG, "volume = " + volume);

            if (volumePrev  < volume) {
                Log.i(TAG, "You have pressed volume up button");
            } else {
                Log.i(TAG, "You have pressed volume down button");
            }
            volumePrev = volume;
        }
    }
}; 
```

## 5.在onStartCommand()中注册广播接收器

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    .....

    IntentFilter filter = new IntentFilter();
    filter.addAction("android.media.VOLUME_CHANGED_ACTION");
    registerReceiver(broadcastReceiver, filter);

    ....

    return START_STICKY;
} 
```

## 6\. 在 onDestroy() 中注销广播接收器

```
 @Override
public void onDestroy() {
    .....

    unregisterReceiver(broadcastReceiver);

    .....

    super.onDestroy();
} 
```

## 就这样

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-10T19:38:00.543

# 这需要 Lollipop (v5.0/API 21) 或更高版本

我的目标是通过服务调整系统音量。不过，任何行动都可以在媒体上采取。

```
public class VolumeKeyController {

    private MediaSessionCompat mMediaSession;
    private final Context mContext;

    public VolumeKeyController(Context context) {
        mContext = context;
    }

    private void createMediaSession() {
        mMediaSession = new MediaSessionCompat(mContext, KeyUtil.log);

        mMediaSession.setFlags(MediaSessionCompat.FLAG_HANDLES_MEDIA_BUTTONS |
                MediaSessionCompat.FLAG_HANDLES_TRANSPORT_CONTROLS);
        mMediaSession.setPlaybackState(new Builder()
                .setState(PlaybackStateCompat.STATE_PLAYING, 0, 0)
                .build());
        mMediaSession.setPlaybackToRemote(getVolumeProvider());
        mMediaSession.setActive(true);
    }

    private VolumeProviderCompat getVolumeProvider() {
        final AudioManager audio = mContext.getSystemService(Context.AUDIO_SERVICE);

        int STREAM_TYPE = AudioManager.STREAM_MUSIC;
        int currentVolume = audio.getStreamVolume(STREAM_TYPE);
        int maxVolume = audio.getStreamMaxVolume(STREAM_TYPE);
        final int VOLUME_UP = 1;
        final int VOLUME_DOWN = -1;

        return new VolumeProviderCompat(VolumeProviderCompat.VOLUME_CONTROL_RELATIVE, maxVolume, currentVolume) {
            @Override
            public void onAdjustVolume(int direction) {
                // Up = 1, Down = -1, Release = 0
                // Replace with your action, if you don't want to adjust system volume
                if (direction == VOLUME_UP) {
                    audio.adjustStreamVolume(STREAM_TYPE,
                            AudioManager.ADJUST_RAISE, AudioManager.FLAG_REMOVE_SOUND_AND_VIBRATE);
                }
                else if (direction == VOLUME_DOWN) {
                    audio.adjustStreamVolume(STREAM_TYPE,
                            AudioManager.ADJUST_LOWER, AudioManager.FLAG_REMOVE_SOUND_AND_VIBRATE);
                }
                setCurrentVolume(audio.getStreamVolume(STREAM_TYPE));
            }
        };
    }

    // Call when control needed, add a call to constructor if needed immediately
    public void setActive(boolean active) {
        if (mMediaSession != null) {
            mMediaSession.setActive(active);
            return;
        }
        createMediaSession();
    }

    // Call from Service's onDestroy method
    public void destroy() {
        if (mMediaSession != null) {
            mMediaSession.release();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-09T14:23:21.433

在这种情况下，Android 不会记录与音量按钮交互的 API。所以我猜答案是否定的……</p>

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-13T01:28:51.453

**注意：这仅适用于活动，而不适用于问题所述的服务。**

根据需要回调的上下文，可能会有替代解决方案。

为了能够检测到音量按钮，Activity 需要覆盖该`dispatchKeyEvent`功能。为了让这个出现在多个活动中，可以编写一个包含被所有后续活动扩展的重写函数的超类。

这是检测音量增大/减小按键的代码：

```
 // Over-ride this function to define what should happen when keys are pressed (e.g. Home button, Back button, etc.)
    @Override
    public boolean dispatchKeyEvent(KeyEvent event) 
    {
        if (event.getAction() == KeyEvent.ACTION_DOWN)
        {
            switch (event.getKeyCode()) 
            {
                case KeyEvent.KEYCODE_VOLUME_UP:
                    // Volume up key detected
                    // Do something
                    return true;
                case KeyEvent.KEYCODE_VOLUME_DOWN:
                    // Volume down key detected
                    // Do something
                    return true;
            }
        }

        return super.dispatchKeyEvent(event);
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-01T19:19:22.723

checkout [Controlling Your App's Volume and Playback](https://developer.android.com/training/managing-audio/volume-playback.html) ...这将有助于解决您的问题...多个应用程序可能希望从后台监听按钮按下，这可能是 KeyEvents 只能由活动处理的原因，因为它们是接口给用户按键。

# cocoa-touch - UITextField canBecomeFirstResponder 返回 NO

> ID：10154130
> 
> 赞同：0
> 
> 时间：2012-04-14T13:46:34.043
> 
> 标签：cocoa-touch, uiresponder

在该方法中`-(void)registerUser`，我展示了一个带有 2 个 UITextField 和一个 Ok 按钮的模式视图。

填充 UITextFields 并按下 Ok 按钮后，我调用委托方法`-(void)AEMUserRegistrationVCUserName:(NSString *)un password:(NSString *)pw`来验证连接到服务器的数据。

当答案到达时，`-(void)request:(RKRequest *)request didLoadResponse:(RKResponse *)response`如果数据错误，我尝试将焦点设置在 UITextfield 上，`self.userRegistrationVC.userName becomeFirstResponder]`但它没有获得焦点。

我已经检查过`[self.userRegistrationVC.userName canBecomeFirstResponder]`，它返回 NO，另一方面，这是文档所说的默认返回的内容。

我的代码在这里作为参考：

笔记：

`self.userName`并且`selfPassword`是 NSStrings。 `self.userRegistrationVC`是一个 UIViewController。 `self.userRegistrationVC.userName`并且`self.userRegistrationVC.password`是 UITextfields。

```
-(void)registerUser
{
    //Recuperar el nombre de usuario
    self.userName = [[NSUserDefaults standardUserDefaults] objectForKey:kNombreUsuario];
    if (!self.userName) {
        //No hay nombre de usuario, el usuario nunca ha registrado la aplicación.
        if (!self.userRegistrationVC) {
            //Solicitar datos de registro
            self.userRegistrationVC = [[AEMUserRegistrationViewController alloc] initWithNibName:@"AEMUserRegistrationViewController" bundle:nil];
        }
        self.userRegistrationVC.delegate = self;
        [self.viewControllerToPresentModalView presentModalViewController:self.userRegistrationVC animated:YES];
        return;
    }

    //Recuperar la contraseña
    NSError *error;
    self.password = [SFHFKeychainUtils getPasswordForUsername:self.userName andServiceName:kServiceName error:&error];
    if (!self.password) {
        //No hay contraseña. La contraseña se ha perdido.
        if (!self.userRegistrationVC) {
            //Solicitar datos de registro
            self.userRegistrationVC = [[AEMUserRegistrationViewController alloc] initWithNibName:@"AEMUserRegistrationViewController" bundle:nil];
        }
        self.userRegistrationVC.delegate = self;
        [self.viewControllerToPresentModalView presentModalViewController:self.userRegistrationVC animated:YES];
        return;
    }

    //Los datos del usuario existen
    //Verificar el registro
    [self.client get:kConfirmUsuario
         queryParams:[NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:self.userName, self.password, nil] 
                                                 forKeys:[NSArray arrayWithObjects:kNombreUsuario, kPassword, nil]]
                                                delegate:self];
}

-(void)AEMUserRegistrationVCUserName:(NSString *)un password:(NSString *)pw
{
    //El usuario ha introducido datos de registro
    //Realizar el registro
    self.userName = un;
    self.password = pw;
    [self.client get:kCreateUsuario 
         queryParams:[NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:self.userName, self.password, nil]
                                                 forKeys:[NSArray arrayWithObjects:kNombreUsuario, kPassword, nil]]
            delegate:self];

    //No hacer dismiss ahora esperar a verificar el registro
}

-(void)request:(RKRequest *)request didLoadResponse:(RKResponse *)response
{
    //Puede responder a createUsuario o a confirmUsuario
    //En ambos casos el error impide registrar al usuario y ejecutar el programa
    BOOL isRequestCreateUser;
    NSRange aRange = [request.resourcePath rangeOfString:kCreateUsuario];
    if (aRange.location != NSNotFound) { 
        //The request was to create a user
        isRequestCreateUser = YES;
    } else {
        //The request was to check a user
        isRequestCreateUser = NO;
    }

    if (response.isConflict) {
        //Error
        [self.userRegistrationVC.userNameError setHidden:NO];
        if ([self.userRegistrationVC.password canResignFirstResponder]) {
            NSLog(@"SI"); //This return NO
        }
        if ([self.userRegistrationVC canBecomeFirstResponder]) {
            NSLog(@"SI"); //This returns NO           
        }
        [self.userRegistrationVC.userName becomeFirstResponder]; 
    }

    if (response.isServerError) {
        //Error
        [self.userRegistrationVC.userNameError setHidden:NO];
        [self.userRegistrationVC.userName becomeFirstResponder];                
    }

    if (response.isOK) {
        //Success

        //Retirar la pantalla de registro de usuario
        [self.viewControllerToPresentModalView dismissModalViewControllerAnimated:YES];

        //Si la peticion fue crear un usuario
        if (isRequestCreateUser) {
            //Guardar el nombre de usuario en las preferencias del usuario
            [[NSUserDefaults standardUserDefaults] setValue:self.userName forKey:kNombreUsuario];           
            //Guardar la contraseña en KeyChain
             [SFHFKeychainUtils storeUsername:self.userName andPassword:self.password forServiceName:kServiceName updateExisting:YES error:nil];
        }

        [self.delegate AEMUserRegistrationSucess];
    }    
} 
```

调用顺序将是：

*   -（无效）注册用户
*   -(void)AEMUserRegistrationVCUserName:(NSString *)un 密码:(NSString *)pw
*   -(void)request:(RKRequest *)request didLoadResponse:(RKResponse *)response

阅读论坛时，许多问题都以 [UITextField becomeFirstResponder] 作为解决方案来回答，所以也许我遗漏了一些重要的东西，我无法让它发挥作用。

文档说您可以覆盖 canBecomeFirstResponder 以返回 YES，但是如何覆盖 UITextField 方法？这是需要做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:37:44.143

试试 UITextView。处理[iPhone 的痛苦：当 UITextView 文本更改时停止 UIScrollView 自动滚动](https://stackoverflow.com/questions/8139876/iphone-stop-uiscrollview-from-auto-scrolling-when-uitextview-text-is-changed)可能会成为你的果实。无论如何，它的作用恰恰相反……很烦人，但如果您通过委托回调限制输入，则可能可行

# android - 防止 Activity 在旋转屏幕时重新启动

> ID：10154131
> 
> 赞同：2
> 
> 时间：2012-04-14T13:46:43.587
> 
> 标签：android, android-layout, android-intent

我的应用程序是一个简单的表单。我使用`TableLayout`，并且有很多行设置为`visibility="gone"`. 随着用户开始填写表单，越来越多的行变得可见。但问题是第二个屏幕从纵向旋转到横向或从横向旋转到纵向，整个表单重置，所有可见的字段都变得不可见。有什么办法可以防止这种情况发生吗？

提前感谢任何帮助的人:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T13:50:19.387

将此行添加到您的 Manifest.xml 文件中，这将防止`onCreate()`屏幕旋转时调用。

```
<activity android:name=".yourActivity" android:configChanges="keyboardHidden|orientation"> 
```

Android 3.2以上版本，还需要添加“screenSize”：

```
<activity android:name=".yourActivity" android:configChanges="keyboardHidden|orientation|screenSize"> 
```

# javascript - 加载 tinyMCE 时的默认 html 字符

> ID：10154134
> 
> 赞同：1
> 
> 时间：2012-04-14T13:47:21.043
> 
> 标签：javascript, jquery, html, tinymce

我在我的 textarea 中加载了 tinyMCE（基于 jquery 插件），但我在我的框中看到了默认的 html。当我发送文本时，我的数据+这个字符插入到 mysql。如何删除这个字符？

html字符：

```
<p><br></p> 
```

加载tinymce：

```
<script>
tinyMCE.init({ mode : "textareas", theme : "simple",directionality : "rtl"
,theme_advanced_buttons3 : "", theme_advanced_toolbar_location : "top",height:'100%'
,theme_advanced_toolbar_align : "left",});
</script> 
```

mysql：

```
&lt;p&gt; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T19:54:43.457

您可能会发现这些帖子和文章很有用：

*   [使用 tinyMCE 验证 textarea - jquery](https://stackoverflow.com/questions/2012312/validate-textarea-using-tinymce-jquery)
*   [http://drupal.org/node/550428](http://drupal.org/node/550428)
*   [http://alastairc.ac/2010/03/removing-emtpy-html-tags-from-tinymce/](http://alastairc.ac/2010/03/removing-emtpy-html-tags-from-tinymce/)

# php - 我该如何设计这个？

> ID：10154135
> 
> 赞同：0
> 
> 时间：2012-04-14T13:47:26.907
> 
> 标签：php, mysql

所以; 我是 PHP 菜鸟，我正试图让一个网站工作，作为一个有趣的副项目。我目前有一个包含歌词的数据库，以及谁唱了这些歌词等。现在我使用以下代码将这些回显到 LYRICS.PHP：

函数.php

```
function getLyric() {
(int)$id = $_GET['id'];
$query = mysql_query("SELECT * FROM lyrics WHERE id = ".$id."") or die(mysql_error());
while ($row = mysql_fetch_assoc($query)) { ?>
    <h1><?= $row['title']; ?> lyrics</h1>
    <h2><?= $row['author']; ?></h2>

    <pre><?= $row['lyrics']; ?></pre>
    <?php }     
} 
```

歌词.php?id=1

```
<?php getLyric(); ?> 
```

哪个有效，但是如何在页面的 [title] 标签中显示歌手和歌曲名称？（目前它只是普通的 html）。以我现在的设计方式，我认为这是不可能的，对吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:02:37.190

这是你可以做的。它不太漂亮，绝对可以简化，但它应该可以完成您想要的工作。

## HTML

歌词.php?id=1

```
<html>
<head>
<title><?php getTitle(); ?></title>
</head>
<body>
<?php getLyric(); ?>
</body> 
```

## PHP

```
function getLyric() {
(int)$id = $_GET['id'];
$query = mysql_query("SELECT * FROM lyrics WHERE id = ".$id."") or die(mysql_error());
while ($row = mysql_fetch_assoc($query)) { ?>
    <h1><?= $row['title']; ?> lyrics</h1>
    <h2><?= $row['author']; ?></h2>

    <pre><?= $row['lyrics']; ?></pre>
    <?php }     
}

function getTitle() {
(int)$id = $_GET['id'];
$query = mysql_query("SELECT * FROM lyrics WHERE id = ".$id."") or die(mysql_error());
while ($row = mysql_fetch_assoc($query)) { ?><?= $row['title']; ?> by <?= $row['author']; ?><?php } ?>   
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:53:12.363

这取决于您如何输出 HTML。如果您在 中使用内联 HTML `lyrics.php`，则可以执行以下操作：

```
<html>
<head>
...
<title><?php echo getTitle(); ?></title>
... 
```

如果您正在回显一串 HTML，那么您可以执行以下操作：

```
echo "<title>" . getTitle() . "</title>" 
```

显然，您需要先制作该`getTitle`功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T14:01:49.303

您可以使您的函数从该查询的结果中返回一个数组或对象，然后将数组项输出到您想要的位置，而不是让您的函数生成标记..还可以考虑对传递给 GET 变量的值进行一些过滤

# mongodb - 如何在 NoSQL (MongoDB) 中存储评论？

> ID：10154152
> 
> 赞同：8
> 
> 时间：2012-04-14T13:50:11.010
> 
> 标签：mongodb, nosql

## 1路

评论嵌入在 Post 文档中：

```
{
  "_id": ObjectId(12345),
  "title": "Cat ate elephant!",
  "body": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean convallis pretium vulputate.",
  "comments": [
    {"name": "Cat", "body": "MEOW!"},
    {"name": "Elephant", "body": "I was eaten by cat, lol!"},
    {"name": "Human", "body": "I am hungry!"}
  ]
} 
```

* * *

## 2种方法

帖子和评论之间的关系（在单独的文档中）。帖子有很多评论：

```
// POST //
{
  "_id": ObjectId(12345),
  "title": "Cat ate elephant!"
  "body": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean convallis pretium vulputate."
}

// Comments //

{
  "_id": ObjectId(...),
  "post_id": ObjectId(12345),
  "name": "Cat",
  "body": "MEOW!"
}

{
  "_id": ObjectId(...),
  "post_id": ObjectId(12345),
  "name": "Elephant",
  "body": "I was eaten by cat, lol!"
}

{
  "_id": ObjectId(...),
  "post_id": ObjectId(12345),
  "name": "Human",
  "body": "I am hungry!"
} 
```

* * *

哪种方式更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:06:11.190

第一种方式是首选，只要文档不是写繁重的。如果您要在一分钟内将 5000 条评论添加到帖子中，请使用第二种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T14:08:16.503

## 方法一

*   无需加入 => 快速访问数据
*   NoSQL 的做法
*   每条评论都只与该帖子相关，所以为什么不将它们存储在一起（您将标题和正文存储在一起；）

如果您有大于 15.5 兆字节的大型文档，并且收到大量评论，那么您可能需要将它们存储在其他地方。这是因为最大文档大小为 16 兆字节。

方法 2 是 RDMBS 的执行方式，Mongo 没有内置连接，因此您需要在应用程序中执行它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T14:01:52.427

因为没有评论属于一个以上的帖子，所以将它们嵌入到 NoSQL 的 Post 文档中更有意义。因此，当您检索您的帖子时，您也会立即在 1 个查询中获得您的评论。

# java - Java有没有办法查看一个键是否被按下而不阻塞？

> ID：10154153
> 
> 赞同：1
> 
> 时间：2012-04-14T13:50:11.573
> 
> 标签：java

我有一个机器人程序来测试我的服务器。如果按下任何键，我希望它退出循环，但不希望它停止并等到按下键。因此循环将继续运行，直到按下键盘上的任何键。

这就是我现在尝试做的方式，但不起作用

```
 if (System.in.available()>0)
        {
            System.out.println("key pressed");
            break; // exit loop
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T13:58:00.743

您的选择是：

*   **创建一个 GUI 窗口**。您可以通过按键事件侦听器从 awt/swing 窗口接收异步按键事件。

    [请参阅此处](https://stackoverflow.com/questions/7606989/read-any-key-to-continue-java)最后一个答案中的代码示例。

*   **在您的程序中创建单独的线程**以等待输入键按下，然后通知主循环线程结束。

*   **使用**像[jInput](http://www.newdawnsoftware.com/resources/jinput/)或[jLine](http://jline.sourceforge.net)这样的本机库（或者使用 jni/jna 编写您自己的更简单的等价物）。

    这允许您连接到本机操作系统的异步键处理，尽管即便如此，通常首先存在对窗口系统的微妙依赖。

# web-scraping - 从整个网络抓取数据

> ID：10154161
> 
> 赞同：1
> 
> 时间：2012-04-14T13:50:58.373
> 
> 标签：web-scraping

我需要开发一个从整个网络上抓取产品数据（价格、标题等）的抓取工具。现在，我确实有抓取经验，但那是针对单个网站的。我不确定如何抓取整个网络。一种可能的解决方案是查询 google，然后从 google 中出现的链接中抓取每个网站。这是好方法吗？

我只需要一个关于如何解决这个问题的通用方法，因为在我看来，每个站点可能都有自己的数据表示方式。我如何整合所有这些变化？任何指南/提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T02:28:32.047

谷歌有一个内置的多网站价格比较功能见：[http ://www.google.co.uk/shopping](http://www.google.co.uk/shopping)

您可以尝试使用谷歌自己的自定义搜索 API 或 curl 来查询该资源，尽管 API 可能是一个更好的选择，因为 google 非常难以抓取，并且如果它认为正在使用 curl 脚本或类似脚本，可能会锁定 IP。如果手动为多个站点编码的想法让您感到恐惧，那么另一种方法是从其他人的比较站点中提取数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T02:50:20.300

定义您所说的内容的术语是**网络爬虫**。你看过维基百科的文章吗？

[http://en.wikipedia.org/wiki/Web_crawler](http://en.wikipedia.org/wiki/Web_crawler)

# orm - 学说：两个实体之间的松散关系

> ID：10154162
> 
> 赞同：0
> 
> 时间：2012-04-14T13:51:05.770
> 
> 标签：orm, symfony, doctrine-orm

我想将用户数据拆分为两个表/对象：

1.  技术用户数据（用户名、电子邮件、密码、盐，..）
2.  个人用户数据（姓名、出生、地址、特征）

困难在于，一个简单的嵌入对象（个人用户数据嵌入到技术用户数据中）必须具有严格的依赖关系，而两个完全分离的对象将难以处理权限问题。

那么如何在不依赖实体之间的情况下关联数据呢？

最好的问候， 博多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T21:32:12.643

阅读您的问题，我想到的是“松散的接口耦合”。在这种情况下，您可以做的是： 1) 创建一个接口，为个人用户数据定义公共方法，例如“PersonalDataInterface”。2) 使持有个人数据的实体实现该接口。3) 在您的技术数据实体中，不要对持有个人数据的实体进行类型提示，而是对接口进行类型提示。

这样，您将能够将实现该接口的任何对象传递给该实体。

我希望它有帮助！

# wcf - Sencha Touch、JSONP、ASP.NET WCF REST 和用户会话

> ID：10154165
> 
> 赞同：1
> 
> 时间：2012-04-14T13:51:13.770
> 
> 标签：wcf, rest, sencha-touch, jsonp, session-state

抱歉标题含糊不清，但我正在开发 Sencha Touch 移动应用程序并构建了一个基于 REST 的 WCF Web 服务来提供数据，并且需要找出处理用户登录并在整个应用程序中保持会话活动的最佳方式.

现在因为我需要使用 JSONP 来连接 Web 服务，这限制了身份验证和会话处理的选项。我可以将用户的凭据保存在应用程序的本地存储中，并在每次调用服务时传递它们，但这不是最好的解决方案。有些人提到将凭据传递给 Web 服务上的登录方法并传回 sessionid，然后在每次进一步调用时发送该 sessionid。但是，我不确定如何首先使用 WCF 创建会话，以及如何使用传入的 sessionid 使其保持活动状态。

任何人都可以推荐一种实现这一目标的技术吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T17:29:48.207

jsonp 是从外部服务获取数据的好方法。但是由于您是 web 服务的所有者，您可以在 http 响应中添加一个 Access-Control-Allow-Origin: * 标头并切换到 ajax 模式。然后，您可以使用标准身份验证过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:37:26.840

如果您的 web 服务旨在供其他开发人员使用，则凭据将在客户端应用程序中配置，因此我将使用身份验证密钥（例如 google-maps api）并让 web 服务无状态。

如果您需要对用户/通行证进行身份验证，您提出的解决方案与 http 身份验证相同。如果您没有理由重新实现自己，请使用标准 http 身份验证（如果在您的场景中可用）。

# android - Android 上的非阻塞 HTTP GET 查询

> ID：10154167
> 
> 赞同：1
> 
> 时间：2012-04-14T13:51:28.880
> 
> 标签：android, http, get, nonblocking

我听说有可能发布 GET 查询并以一种不会让您等待答案的方式传递给它一些处理程序：当答案到来时，它只是调用处理结果的给定处理程序。

这与阻止 UI 无关，我知道如何使用 AsyncTask。问题是我想同时向互联网发布 3-4 个查询。

有没有办法在Android中做到这一点而不会创建太多线程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:58:51.380

看看支持非阻塞 IO (NIO)的[Apache commons HTTP core 。](http://hc.apache.org/httpcomponents-core-ga/httpcore-nio/index.html)（和一个[例子](http://hc.apache.org/httpcomponents-core-ga/httpcore-nio/examples/org/apache/http/examples/nio/NHttpClient.java)）

# php - Symfony 2 - 多种形式

> ID：10154168
> 
> 赞同：4
> 
> 时间：2012-04-14T13:51:38.613
> 
> 标签：php, forms, symfony, bundle

有人知道如何在一页中呈现更多表单吗？

我有一个实体类 ImportPath: id。该实体对应的描述、路径、本地和 ImportPathForm。我想要的是类似表格的东西，它在每一行都有小表格，可以在其中编辑一个路径。

我不知道路径的最终计数，所以它必须在某个循环中是动态的。应该从路径 id 中知道请求的形式（尚未实现）。

代码：控制器：public function importAction($message="no message") {

```
$em = $this->getDoctrine()->getEntityManager();

$paths = $em->getRepository('WT2\BabuBundle\Entity\ImportPath')->findAll();

$forms=array();
foreach ($paths as $path) {
$form = $this->createForm(new ImportPathForm(), $path);
$forms[]=$form;
}

// $request = $this->getRequest();
// if ($request->getMethod() == 'POST') {
// $form->bindRequest($request);
// if ($form->isValid()) {
// /* ok */
// }
// }

return $this->render('WT2BabuBundle:Admin:import.html.twig', array('forms'=>$forms,'message'=>$message));
} 
```

查看（摘录）：

```
{% for key, form in forms %}
{{ key }}
<form action="{{ path('admin_import') }}" method="post" {{ form_enctype(form) }}>
{{ form_widget(form) }}
<input type="submit" value="Ym2nit" />
</form>
{% endfor %} 
```

**编辑>**

我得到它 ：）

解决方案是

```
$forms=array();
foreach ($paths as $path) {
$form = $this->createForm(new ImportPathForm(), $path);
**$form = $form->createView();**
$forms[]=$form;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T07:48:17.433

我得到它 ：）

解决方案是

```
$forms=array();
foreach ($paths as $path) {
$form = $this->createForm(new ImportPathForm(), $path);
$form = $form->createView();
$forms[]=$form;
} 
```

# javascript - 正在使用 jquery 使网页在加载时需要很长时间

> ID：10154169
> 
> 赞同：0
> 
> 时间：2012-04-14T13:51:40.823
> 
> 标签：javascript, jquery

我想知道使用原生javascript或jquery构建高质量站点哪种方法好。jquery会使页面加载时间更长吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T13:54:43.973

好吧，鉴于 jQuery 只是一堆 JavaScript，旨在让编码人员的生活更轻松，同时完全忽略了“少即是多”、“亲吻”和其他类似原则的基本原理，我会说原始 JavaScript 是一个*地狱*在页面加载时间方面比 jQuery 快得多。

也就是说，当然完全有可能编写杀死浏览器的纯 JavaScript。
如`while(some condition that is accidentally always true)`（我犯了这个罪）

因此，仅仅“不使用 jQuery”并不能保证您的网站比使用 jQuery 的网站运行得更快。无论您使用何种工具，您仍然需要优化您编写的代码。

# iphone - 根据自定义 URL 架构从 appDelegate 显示视图控制器

> ID：10154172
> 
> 赞同：2
> 
> 时间：2012-04-14T13:52:25.737
> 
> 标签：iphone, objective-c, ios, xcode

我的应用程序正在使用情节提要。我想在这里发布层次结构：

视图控制器 > 标签栏控制器 > 导航控制器 > TableViewController > DetailViewController

这个详细视图控制器也有一个我通过界面构建​​器设置的标识符。

选择表上的项目显示详细视图。

我在我的应用程序中启用了自定义 URL，一切正常，除了使用 myappname://uniqueid 接收来自其他应用程序的呼叫

当我收到自定义 URL 调用时，我想显示我之前谈到的详细信息视图，但我不知道如何。

我已经使用它的标识符实例化了视图控制器，但我不知道如何在不引发错误的情况下显示它。

如何直接从 appdelegate openUrl:source 应用程序方法显示此情节提要中的视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T18:27:53.037

此问题的解决方案是从 AppDelagate 向所有视图控制器发出通知，当正确的视图控制器从 AppDelegate 自定义 URL 委托接收到此通知时，可以模态加载视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:33:15.883

您需要让您的 UI 处于已知的就绪状态，因为不知道呼叫进入时它会在哪里。要做好准备，您需要有一个标签栏的句柄，并且能够转换将 URL 上的 uniqueid 插入到详细 vc 应该检查的模型部分。

它应该看起来像这样（对您现有的代码进行自由猜测）：

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {

    // get the ui to a known state
    self.tabBarController.selectedIndex = kTHE_NAVIGATION_VC_INDEX;
    UINavigationController *nav = (UINavigationController *)self.tabBarController.selectedViewController;
    [nav popToRootViewControllerAnimated:NO];

    // parse the url to get uniqueId
    // the uniqueId specifies an object in your model that you want to have
    // inspected by the detail view controller?  you'll need that object...
    MyObject *detailObject = [self.myModel objectWithUniqueId:uniqueId];

    // the detail vc probably has an init like this?
    DetailVC *detailVC = [[DetailVC alloc] initWithModel:detailObject];

    [nav pushViewController:detailVC animated:YES];
} 
```

**编辑**

要让您的应用程序委托访问它的 tabBarController，您可以设置如下属性：

```
// AppDelegate.h
@property (strong, nonatomic) UITabBarController *tabBarController;

// AppDelegate.m, after @implementation
@synthesize tabBarController=_tabBarController; 
```

您是否使用故事板 segue 从启动 vc 到主应用程序？我猜是的。从启动视图控制器到主应用程序是否有不止一个 segue？我猜NO。如果这些猜测中的任何一个是错误的，您将需要调整此代码...

```
// SplashViewController.m

#import "AppDelegate.h"

-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    UITabBarController *tabBarController = (UITabBarController *)[segue destinationViewController];
    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    appDelegate.tabBarController = tabBarController;
} 
```

# jsf - 如何使用 JSF 显示多个动态数据表

> ID：10154177
> 
> 赞同：1
> 
> 时间：2012-04-14T13:53:11.233
> 
> 标签：jsf, dynamic, datatable

我已经在我的 jsf 页面中成功地显示了一个动态数据表（动态列和行）。

但是，我需要显示超过 1 个表格 - 垂直。如何在列表中迭代以显示它们？

谢谢

有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T19:15:07.287

怎么样

```
 <ul>
        <ui:repeat value="#{someBean.items}" var="someCurrentItems">
            <li>
                <h:dataTable value="#{someCurrentItems}" var="currentItem"></h:dataTable>
            </li>
        </ui:repeat>
    </ul> 
```

如果您想摆脱公告，请将其添加到您的 css 文件中（如果您将用一些包装...，您可以为 css 提供更精确的选择`ul`器）`div``id`

`ul { list-style-type: none; }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T11:06:31.073

另一个更详细的例子：

```
<ul>
             <ui:repeat value="#{timeslipBean.usersSlips}" var="tabSlips" >
            <li>
             <p:dataTable id="timeslips" var="time" value="#{tabSlips.table}">
             <h2>
                 #{tabSlips.label} 
            </h2>                    
                  <p:column >
                   <f:facet name="header" >  
                               User  
                   </f:facet>  
                        <h:outputText value="#{time.user}"/>
                  </p:column>
                  <p:columns value="#{tabSlips.columns}" var="column" columnIndexVar="colIndex" styleClass="#{time.times[colIndex].festivo ? 'festivo' : null}">  
                         <f:facet name="header">  
                               #{column.header}  
                        </f:facet>  
                        <h:outputText value="#{time.times[colIndex].hours}" styleClass="#{time.times[colIndex].style}"/>
                   </p:columns> 
              </p:dataTable>    
            </li>
        </ui:repeat>
    </ul> 
```

# android - 假推技术？

> ID：10154185
> 
> 赞同：1
> 
> 时间：2012-04-14T13:54:03.487
> 
> 标签：android, server-push, http-streaming

我对推送技术没有任何背景，我需要学习如何尽快让它在 Android 上运行。不幸的是，我也不知道如何在服务器端进行推送。我这里的背景绝对是 0。:|

*   您是否知道任何提供虚拟推送的服务，以便我的应用程序可以连接到它并等待数据？
*   像那些语音聊天应用程序那样的虚拟实时推送技术怎么样？
*   你能给我一些关于如何在代码中在 Android 上实现推送技术的链接吗？
*   如果我想在Android上学习推送技术，我应该在Google上搜索哪些关键字？（我指的是所需的类等）

如果我还可以学习如何在服务器端创建推送技术，那就太好了，但现在，我非常需要首先学习如何在 Android 中接收实时推送（例如用于语音聊天的流式语音），而我没有不知道我可以将我的应用程序连接到的任何在线服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:01:58.213

看看[Android Cloud to Device Messaging](http://code.google.com/android/c2dm/)和 Lars Vogel 关于服务器和客户端实现的精彩[教程](http://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:03:14.093

您可以使用 Urban Airship 等第三方解决方案来处理 Android 和 iPhone 的服务器端推送。

[城市飞艇](http://urbanairship.com/products/push-notifications/)

# internet-explorer-8 - Bootstrap Font Awesome 和 IE8

> ID：10154187
> 
> 赞同：0
> 
> 时间：2012-04-14T13:54:08.153
> 
> 标签：internet-explorer-8, fonts, twitter-bootstrap, font-awesome

我在我的项目中使用[Font Awesome](https://github.com/FortAwesome/Font-Awesome)，它适用于 chrome、firefox 和 IE9，但它无法显示 ie8 的图标。如果这是我的错，我试过了，但项目站点也没有显示我的 IE8（win7）的字体。

我用的是IE8的默认网页保护，请问是什么原因？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:07:17.750

字体仅在 IE8 模式（不兼容或 IE7 标准模式）下查看时才有效，因此请确保您的浏览器设置为该模式。[在页面的路线图](http://fortawesome.github.com/Font-Awesome/#roadmap)部分的下方，您可以看到他们列出了对 IE7 的未来支持，IE8 兼容视图应该效仿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-25T12:45:56.253

1.  将此添加到 htaccess。“BrowserMatch MSIE 最佳标准支持标头集 X-UA 兼容 IE=8 env=最佳标准支持”
2.  试图重新转换eot字体
3.  doc 可压缩性模式更改
4.  试过usleep功能
5.  设置间隔js
6.  添加谷歌html5脚本
7.  在 ie8 的正文部分调用 css
8.  添加数据图标类
9.  广告伪元素js
10.  在 CSS 中添加 png 和 svg 过滤器
11.  检查服务器中的字体类型权限

但最终在添加时有效

> **.sass 和 .less CSS**

文件

# ruby-on-rails - 重定向到自定义域页面时 Rails 3 会话重置，但会话保留为 heroku 默认域

> ID：10154188
> 
> 赞同：2
> 
> 时间：2012-04-14T13:54:10.280
> 
> 标签：ruby-on-rails, session, heroku

我正在使用 Rails 3 的会话变量来存储一些数据。例如。session[:token] = user_token

如果我通过 heroku 域访问我的应用程序，则此会话变量存在于整个单个会话中。(example.heroku.com) 但是，如果我通过自定义域访问，(www.example.com) 每次我重定向到域中的另一个页面时，会话变量都会清除。

我无法弄清楚我尝试使用 :cookie_store 和 :active_record_store 实现它的问题是什么，但同样的问题仍然存在。我什至尝试为 :cookie_store 设置 :domain

```
MyApp::Application.config.session_store :cookie_store, :key => '_my_app_session', :domain => :all 
```

还没有运气。如果我错过了任何设置，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T18:18:49.533

在这种情况下，您需要设置一个默认域。 `ActionController::CgiRequest::DEFAULT_SESSION_OPTIONS[:session_domain] = '.example.com'`

有关详细信息，请阅读此博客[Cookie-Handling](http://szeryf.wordpress.com/2008/01/21/cookie-handling-in-multi-domain-applications-in-ruby-on-rails/)

# php - Cake Php 中的复杂查询

> ID：10154189
> 
> 赞同：0
> 
> 时间：2012-04-14T13:54:38.643
> 
> 标签：php, mysql, cakephp, find

我有一个与 cakephp 中复杂的查找条件相关的问题。我有一个交易表，其中有很多 transaction_item（是一个结构 product_id，date 的表），并且产品与供应商有多对多的联系。所以我对产品和供应商使用映射表，在 transaction_item 表中我使用外键进行交易。我的问题是如何在知道交易 ID 的情况下阅读供应商及其相关产品。

例子。

知道 transaction.id = 9;

我要结果

```
Supplier id:1
   Transaction Item 1
   Transaction Item 2
Supplier id:2
   Transaction Item 1
   Transaction Item 3 
```

在 SQL 中，我的查询是

```
SELECT 
      `map_table`.`supplier_id`, 
      `transaction_item_table`.`id`
   FROM
      `transaction_item_table` 
         INNER JOIN `map_table` 
            ON `transaction_item_table`.`id` = `map_table`.`product_id`
   WHERE    
      `transaction_item_table`.`transaction_id` = 9 
   ORDER BY 
      `map_table`.`supplier_id`; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:46:05.733

在要获取该列表的函数中的 TransactionController 中：

```
$transactionId = 9; //For your example ;-)
$this->Transaction->Behavior->attach('Containable');
$result = $this->Transaction->find(
    'first',
    array(
        'conditions' => array(
            'Transaction.id' => $transactionId
        ),
        'contain' => array(
            'TransactionItem' => array(
                'Product' => array(
                    'Supplier'
                )
            )
        )
    )
); 
```

上面的代码应该可以解决问题（如果我正确理解了您的问题），假设您有：

*   Transaction hasMany TransactionItem
*   TransactionItem 有一个产品
*   产品有很多供应商

如果模型有不同的名称，您可能必须修改我的示例以反映适当的模型名称。如果关系不同，它可能根本不起作用..

另外，看看[ContainableBehavior](http://book.cakephp.org/1.3/en/view/1323/Containable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T09:00:35.387

```
$this->TransactionItemTable->find('all', 
    array( 
        'fields' => array(
              'MapTable.supplier_id', 
              'TransactionItemTable.id'
    ),
    'joins' => array(
        array(
            'table' => 'map_table',
            'alias' => 'MapTable',
            'type' => 'INNER',
            'conditions' => array(
                'TransactionItemTable.id = MapTable.product_id'
            )
        ),

    ),
    'conditions' => array('TransactionItemTable.transaction_id' => 9),
    'order' => array('MapTable.supplier_id'=> 'ASC'),
    'recursive' => -1
  )
); 
```

# jquery-ui - 页面第二次加载时如何禁用Jqueryui对话框

> ID：10154191
> 
> 赞同：0
> 
> 时间：2012-04-14T13:54:49.977
> 
> 标签：jquery-ui, dialog

我在我的母版页上创建了一个 jquery ui 对话框，所以在我的站点对话框中出现在所有页面中，之后我使用 clickevent 关闭对话框，当我再次打开下一页对话框时。一旦我关闭对话框，它不应该打开下一页加载。请给我一些想法。我怎样才能做到这一点？？

这是我的jQuery代码：

```
 <script type="text/javascript">

  $(document).ready(function () {

  $("#dialog").dialog({ modal: false, resizable: false,
 bgiframe: true, draggable: false, position: ['right', 'bottom'], height: 150,     width:     300
 });

 $("#<%=btnCancel.ClientID%>").click(
  function () {
    $("#dialog").dialog('close');
 return false;
  });
   $("#<%=btnyes.ClientID%>").click(
  function () {
 var url = ".....";
  $(location).attr('href', url);
 return false
    });

      });
  </script> 
```

这是我的设计代码：

```
 <div id="dialog" title="How Are We Doing?" style="width:500px; margin:0 0;"  background-color="white">

    <asp:Label ID="Label1" runat="server" Text="Please take a minute to give us your feedback…MICROMO.com’s User Feedback Program."></asp:Label>
    <asp:Button ID="btnyes" runat="server" Text="YES" BackColor="#0099cc" width="40px" ForeColor="White" Font-Bold="true" />
    <asp:Button ID="btnCancel" runat="server" Text="NO" width="40px" BackColor="#0099cc" ForeColor="White" Font-Bold="true"/>

     </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T09:42:57.797

我们可以使用JS Cookie函数在Document.ready函数之前设置显示对话框的条件。下面我给出了函数代码：

```
<script type="text/javascript">          
$(document).ready(function ()  
{
var check=getCookie("clicked");alert(check);
if (check!='true' && check!="")
{    

$("#dialog").dialog({ modal: false, resizable: false,
bgiframe: true, draggable: true, position: ['right', 'bottom'], height: 150,     
width:     300

});

}

$("#<%=btnCancel.ClientID%>").click(

function () {
$("#dialog").dialog('close');
$("#dialog").dialog('disable');
return false;
});
$("#<%=btnyes.ClientID%>").click(
function () {
var url = "http://www.w3schools.com/jquery/jquery_intro.asp";
$(location).attr('href', url);  
setCookie("clicked",true,2);    
return false
});
});
</script> 
```

Cookie Js 文件

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
}
function getCookie(c_name)
{
var i,x,y,ARRcookies=document.cookie.split(";");
for (i=0;i<ARRcookies.length;i++)
{
x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
x=x.replace(/^\s+|\s+$/g,"");
if (x==c_name)
{
return unescape(y);
}
}
} 
```

# javascript - 在 webOS 中加载页面时执行功能

> ID：10154192
> 
> 赞同：0
> 
> 时间：2012-04-14T13:55:06.763
> 
> 标签：javascript, webos

我目前正在尝试在 webOS 中创建一个数据库，以后可以对其执行 crud 操作。到目前为止，用户需要单击一个按钮来创建数据库和另一个按钮来创建表。有没有办法在应用程序加载时创建这些，以便用户不必自己做？

编辑：

这是一个 Enyo 应用程序，我使用 HTML5 作为数据库，所以基本上我希望能够在应用程序加载时打开数据库并创建一个表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T17:10:46.253

我的建议是覆盖`create`您的应用程序类型的功能以检查数据库是否已初始化，然后根据需要创建它。或者，您可以从启动屏幕开始并执行必要的功能，完成后，加载您的主要类型。

这是一篇关于启动画面的文章：

[https://developer.palm.com/content/resources/develop/app_splash_screens.html](https://developer.palm.com/content/resources/develop/app_splash_screens.html)

或者有人创建了一种启动画面：

[https://developer.palm.com/distribution/viewtopic.php?f=11&t=16262](https://developer.palm.com/distribution/viewtopic.php?f=11&t=16262)

# html - 将 html 转换为 xml 复选框输入和文本区域

> ID：10154193
> 
> 赞同：0
> 
> 时间：2012-04-14T13:55:08.090
> 
> 标签：html, xml

我需要通过网页收集数据并将该数据转换为 XML。
我有一个带有输入字段、文本区域、单选按钮和复选框的 html 文件。我有 XML 和 XSL 文件作为转换后的 XML 数据的模板。我可以提供特定的代码，但它只是基本的输入、复选框等，我正在寻找一些将 html 页面中的值转换为 XML 的想法。

我计划将数据存储在 mysql 数据库中，并且我有输入字段和 textareas 工作，但我还没有完成复选框和单选按钮。

我不知道我是否应该将 HTML 转换为 XML，或者先存储在数据库中，然后从数据库中提取 XML？
感谢您的指导和建议。谢谢。

# javascript - Node.js 原型继承

> ID：10154194
> 
> 赞同：1
> 
> 时间：2012-04-14T13:55:13.970
> 
> 标签：javascript, node.js, prototype

试图通过一个简单的测试来围绕 Javascript 中的原型，特别是 Node.js。

```
function Lint() {
    this.input = 'foo';
    events.EventEmitter.call(this);
}

Lint.prototype.dirs = function (dirs) {
    _.each(dirs, this.files);
}

Lint.prototype.files = function (dir) {
    console.log(this.input); // trying to get 'foo', returns undefined
}

var lint = new Lint();

lint.dirs(['js', 'js/views']); 
```

`Lint.prototype.files`记录未定义，因为`this`不是指 Lint 的实例。我在这里想念什么？

我能想到的唯一可行的解​​决方案是将初始值传递`this`给`Lint.prototype.dirs`其他函数。我很确定有更好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:58:13.130

`this`引用`lint`对象，但您没有将`Lint`对象传递给`_.each`. 您正在从对象中分离函数并传递它。

`Function.prototype.bind`您可以使用...将函数的上下文绑定到所需的值

```
_.each(dirs, this.files.bind(this)); 
```

或者，您可以保留对该`this`值的引用，并将匿名函数传递给`_.each`...

```
var this_lint = this;

_.each(dirs, function(v) {
    this_lint.files(v);
} 
```

# drupal - 处理异常时抛出额外的未捕获异常

> ID：10154195
> 
> 赞同：2
> 
> 时间：2012-04-14T13:55:25.293
> 
> 标签：drupal, e-commerce, open-atrium

我面临与这篇文章相同的问题。 [drupal视图模块mysql错误](https://stackoverflow.com/questions/6524456/drupal-views-module-mysql-error?answertab=active#tab-top)

我在 /opt/lampp/etc/my.cnf 将 max_allowed_pa​​cket 从 1M 增加到 60M 但是当我尝试在结构中添加所有内容时问题仍然存在。这是屏幕代码。

处理异常时抛出额外的未捕获异常。

原来的

```
PDOException: SQLSTATE[HY000]: General error: 2006 MySQL server has gone away: SELECT * FROM {uc_product_classes}; Array ( ) in uc_product_class_load() (line 1704 of /opt/lampp/htdocs/advanced-a/sites/all/modules/uc_product/uc_product.module). 
```

额外的

```
PDOException: SQLSTATE[HY000]: General error: 2006 MySQL server has gone away: SELECT ff.* FROM {filter_format} ff WHERE (status = :db_condition_placeholder_0) ORDER BY weight ASC; Array ( [:db_condition_placeholder_0] =&gt; 1 ) in filter_formats() (line 407 of /opt/lampp/htdocs/advanced-a/modules/filter/filter.module). 
```

会话处理程序中抛出未捕获的异常。

```
PDOException: SQLSTATE[HY000]: General error: 2006 MySQL server has gone away in _drupal_session_write() (line 206 of /opt/lampp/htdocs/advanced-a/includes/session.inc). 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T02:42:30.490

对于 max_allowed_pa​​cket 来说，这是一个相当高的设置（几乎就像有人告诉您将其设置为 16 但您听到它为“六十”一样）

尽管如此，您是否也对 my.ini 进行了必要的更改？

[https://drupal.org/files/my.ini_.patch](https://drupal.org/files/my.ini_.patch)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T09:12:20.327

更改`max_allowed_packet = 1M`为`max_allowed_packet = 16M`_`my.ini`

# security - 我如何在 JSF 中做安全性？

> ID：10154202
> 
> 赞同：16
> 
> 时间：2012-04-14T13:56:00.100
> 
> 标签：security, jsf, jakarta-ee

我将 Java EE 6 与所有参考实现一起使用。对某些页面（例如下面的所有内容）进行了一些安全限制`/secure/*`。这是粗粒度的安全性。例如，如果两个用户都具有相同的角色，但同一页面的某些内容应该只对用户“John”可见怎么办？或者应该向“约翰”显示一个完全不同的页面？我有很多问题没有得到解答，所以如果有人能提供一些链接/解释或涵盖这个问题的书籍，那就太好了。我需要更细粒度的安全控制。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-17T20:39:43.550

您希望的细粒度安全功能不仅*存在*，Oracle 甚至还有[一篇有用的博客文章详细介绍了该主题](https://blogs.oracle.com/enterprisetechtips/entry/improving_jsf_security_configuration_with)，并附有示例代码。

而且因为简单地链接文档并运行对我来说是简洁和不礼貌的，所以接下来是一些关于如何根据我的理解结合在一起的讨论。

## 第*0*个问题：粗粒度、声明式安全

[声明式安全性](https://stackoverflow.com/questions/1401263/what-is-declarative-security-in-general)的最大问题是它迫使您在设计时迭代地定义所有用户角色。这是*非常*不可取的，原因有两个：首先，它无法正确地将您的安全模型从您的实现中抽象出来（未能充分地为您的应用程序提供[面向未来的证明](http://en.wikipedia.org/wiki/Future_proof)，并为信息泄露漏洞打开大门），其次，它将您的用户角色束缚在应用程序的直接设计，通常无法在需要或必要时提供细粒度的权限或[ACL 。](http://en.wikipedia.org/wiki/Access_control_list)

实际上，这是一个抽象不足的问题。您正在使用的系统可以立即满足您当前的需求，但由于角色变得更加复杂并且代码库的复杂性不断增加，您无法期望在应用程序的生命周期内可以使用或维护该系统。

## 使用托管 Bean 的细粒度安全性

这里的一阶解决方案是使用一个抽象模型，该模型允许您在每个 JSF 方法调用的上下文中独立定义用户角色，允许您根据需要将它们换入或换出。作为奖励，这允许您定义*更细粒度的*权限，因为这样的方案允许您定义*每个方法*而不是每个视图、每个端点或每个 bean 的权限。如果角色改变？您只需要在一个位置更新您的权限模型，而不是去每个这些 bean 并换出它们的用户定义。

前面链接的[文章](https://blogs.oracle.com/enterprisetechtips/entry/improving_jsf_security_configuration_with)比我愿意在这里介绍的要详细得多，所以我强烈建议阅读博客文章。但是这里的要点是，要*正确*执行此操作，您应该同时提供*身份验证堆栈和详细说明权限角色的注释层，*并且这两者只应在您明确且有意连接两者的地方相遇。

定义细粒度的方法调用和有意义的安全策略留给读者作为练习，但如果您在这方面有任何疑问，请随时在评论或一组后续问题中提出，如这些问题本质上对广大受众有用。

## 改进

可以想象，此解决方案不足以满足您的需求。例如，如果您希望使用[LDAP](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)或[Kerberos](http://en.wikipedia.org/wiki/Kerberos_%28protocol%29)对用户进行身份验证以提供用户和角色的统一表示，那么这仅提供了部分解决方案来满足您的需求。该领域中存在一些[重要的](http://docs.oracle.com/javase/jndi/tutorial/ldap/security/ldap.html) [资源](http://docs.oracle.com/javase/1.4.2/docs/guide/security/jgss/single-signon.html)，但这留给读者作为练习。

这里的最终结论是，在完美的世界中，这就是您的应用程序安全性应该被定义的方式。您的需求可能会有所不同，对于小规模的东西，*简单的声明式安全性可能足以满足您的需求*。毕竟，这就是它继续存在的原因。

但是，对于必须安全、正确地满足大量用户需求的大型应用程序，这是正确的方法。它需要更多的知识和开销，但如果你从正确开始，它将为你节省大量的时间、精力和挫败感。

与往常一样，祝您的申请好运。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-14T19:49:02.867

最简单的方法是

```
<h:panelGroup rendered="#{request.userPrincipal.name == 'user1'}">
    <p>Content for user 1</p>
</h:panelGroup>
<h:panelGroup rendered="#{request.userPrincipal.name == 'user2'}">
    <p>Content for user 2</p>
</h:panelGroup> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T23:33:33.000

显示同一页面的多个版本与安全性无关（不同版本！=链接隐藏），限制访问和需要额外授权，如果您不介意，我会回答。

[您可以在 JAAS 页面上](http://docs.oracle.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html)了解这两者（身份验证、授权）。它也是我认为最好的框架。掌握它需要一些时间，但在那之后，它就很容易了，你甚至会意识到它根本不是重量级的——**你不必被迫使用每一个功能**。（就像 EJB 一样）

JAAS 甚至可以使用 ldap 或 windows 帐户登录您，甚至支持多个身份验证步骤 - 您可以实现 pass+sms 登录。[当然，即使使用acegi](http://sourceforge.net/projects/acegisecurity/)也可以做到这一点（这并不容易）

由于您已经提到过 JSF，所以 JAAS 比 acegi 更适合，您可以使用**@RolesAllowed**注释任何支持 bean，如果用户会话不满足要求，则会抛出 SecurityException。这适用于 servlet 和 bean（ejb，支持），不适用于 jsps（但无论如何它没有多大意义）

您可以在此处阅读有关[@RolesAllowed 的信息](http://java.sun.com/developer/technicalArticles/J2EE/security_annotation/)，但如果您已经在考虑它，**请不要错过[JBoss Seam Security](http://docs.jboss.org/seam/3/latest/reference/en-US/html_single/#security-introduction)** - 它建立在安全注释和 JAAS 之上，而且使用起来也很容易上瘾。值得一读。

顺便说一句：我不是嫖客，只是发现了一个有趣的问题，所以......随时为赏金而战:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T03:58:39.163

通常这种内容会保存在会话变量中。因此，您不必考虑登录的是什么用户。

# c# - 从 SQLite 中的所有表中删除

> ID：10154206
> 
> 赞同：0
> 
> 时间：2012-04-14T13:56:56.693
> 
> 标签：c#, sql, sqlite

SQLite（用于 C#.NET）中是否有执行等效操作的 SQL 命令？

`DELETE * FROM * WHERE id='idnumber'`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T13:58:55.903

不，没有。

一种方法是编写一个小脚本来[查询元数据表](http://www.sqlite.org/faq.html#q7)，以*创建*另一个脚本，其中包含一系列单独的`delete`语句，每个表一个。

一个例子可能是（假设*每个*表都有一个 ID 列）：

```
select 'delete from ' || name || ' where ID = 42'
from sqlite_master
where type = 'table' 
```

这将为`delete`每个表生成一个语句，然后您可以将其捕获并作为脚本运行。

但是对于数据库开发人员来说，知道他们的表的名称通常是一个好主意:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-06T07:47:43.190

此删除将擦除数据库中的所有内容：

```
.output wipe.sql
.print BEGIN TRANSACTION;
SELECT 'DELETE FROM ' || name || ' WHERE id="idnumber";'
FROM sqlite_master
WHERE type = 'table';
.print COMMIT;
.print VACUUM;
.output
-- .read wipe.sql 
```

请注意，如果您忽略它，`WHERE id="idnumber"`这将清除您的数据库！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-17T18:40:30.893

我用于动态编程目的的一种方法是创建一个表名数组并循环遍历它们。

例如

迅速

```
var array = ['table1','table2','table3']

for item in array

{

var stringToDeleteTables:String = "DELETE FROM \\(item) [optional where clause]"

//run the command on the database

} 
```

我希望这可以帮助别人。非常适合诸如注销或清除搜索数据之类的事情。您甚至可以扩展数组并将其作为函数调用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-14T14:01:15.513

你可以试试看：

```
//You can do it with the following DANGEROUS commands:

PRAGMA writable_schema = 1;
delete from sqlite_master where type = 'table';
PRAGMA writable_schema = 0;

 //you then want to recover the deleted space with
 VACUUM

//and a good test to make sure everything is ok
 PRAGMA INTEGRITY_CHECK; 
```

希望它对你有用。

# javascript - jQuery 在 Wordpress 中不起作用

> ID：10154218
> 
> 赞同：0
> 
> 时间：2012-04-14T13:58:50.863
> 
> 标签：javascript, jquery, wordpress

我有一些 jQuery 脚本，可以在这里找到：http: [//jsfiddle.net/RUqNN/45/](http://jsfiddle.net/RUqNN/45/)

当我将此脚本合并到我的 wordpress 模板中时，我不起作用。

我检查了 jquery 源链接，重写了代码，没有任何效果。

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>
    <body>
      <script type="text/javascript">
        $(document).ready(function() {
          $(".move").toggle(
            function() {
              $("#teetimetag").animate({
                right: "0px"
              }, "normal");
            },function() {
              $("#teetimetag").animate({
                right: "-200px"
              }, "normal");
          });
        });
    </script>
      <div id="teetimetag">
         <img class="move" src="http://test.tooheavytoskydive.com/wp-content/themes/newtheme/images/flag.png" style="float: left;" />
        <div style="margin: 15px 0 0 50px;">
          <a href="http://test.tooheavytoskydive.com/reservations/" style="color: #FFF; font-weight: bold; font-size: 17px;">Reserve your Tee-Time</a>
        </div>
      </div>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:25:23.830

您的网站出现以下 javascript 错误：“$ 不是函数”。看起来 jQuery 与其他一些库发生冲突。这可以通过调用 jQuery.noConflict() 并将所有 $ 替换为 'jQuery' 来解决。代码如下所示：

```
jQuery.noConflict();
jQuery(document).ready(function() {
          jQuery(".move").toggle(
            function() {
              jQuery("#teetimetag").animate({
                right: "0px"
              }, "normal");
            },function() {
              jQuery("#teetimetag").animate({
                right: "-200px"
              }, "normal");
          });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:04:28.120

你应该在你的模板functions.php文件中注册你的js文件：

```
wp_register_script('jquery', 'http://code.jquery.com/jquery-1.7.2.min.js'); 
```

[http://codex.wordpress.org/Function_Reference/wp_register_script](http://codex.wordpress.org/Function_Reference/wp_register_script)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-07T18:15:38.923

作为一般规则，您不应该使用`$`变量 for ，`jQuery`除非您使用了其中一个[快捷方式](http://docs.jquery.com/Using_jQuery_with_Other_Libraries#Referencing_Magic_-_Shortcuts_for_jQuery)。以下是如何使用 jQuery 快捷方式安全使用`$`变量的示例：

```
jQuery(function ($) {
    /* You can safely use $ in this code block to reference jQuery */
}); 
```

要在 wordpress 上加载 jquery，请使用以下 2 个版本之一。`Plugin Page`在OR 处包含代码`function.php`

```
function include_jQuery() {
    if (!is_admin()) {
        wp_enqueue_script('jquery');
    }
}
add_action('init', 'include_jQuery'); 
```

当然，您可以使用任何有意义的函数名来代替 off `include_jQuery`。

或者，您可以使用以下代码：

```
function include_jQuery() {
    if (!is_admin()) {
        // comment out the next two lines to load the local copy of jQuery
        wp_deregister_script('jquery'); 
        wp_register_script('jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js', false, '1.8.3'); 
        wp_enqueue_script('jquery');
    }
}
add_action('init', 'include_jQuery'); 
```

您可能也喜欢[这个](http://www.ericmmartin.com/5-tips-for-using-jquery-with-wordpress/)链接，我个人从那里学习上述技术。非常感谢**Ericm Martin！**

# php - VPS 上的 MongoCursor::getNext 性能糟糕

> ID：10154223
> 
> 赞同：1
> 
> 时间：2012-04-14T13:59:19.460
> 
> 标签：php, performance, mongodb

我试图弄清楚为什么托管在具有 2GB RAM 的 VPS 上的站点在大约 2 秒内开始显示页面，而在 localhost 上最坏的情况只需要大约 200 毫秒。我想指出 IIRC，它在过去没有发生，并且负载或访问者数量没有差异。顶部显示大部分时间 CPU 使用率为 0%，空闲 77M RAM，已使用 4M 交换空间。

我分析了一个缓慢的请求，发现 87% 的时间都花在调用`MongoCursor::getNext`. 使用的数据库的 mongodump 是 800MB，所以内存应该不是问题。操作系统是 64 位 Ubuntu 11。

我要采取哪些步骤来解决此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:43:15.293

原来是由旧的 mongo 版本引起的 - 在 VPS 上它是 1.8.* 而在我的本地盒子上 - 2.0.4。在我升级 mongo 和`mongorestore`d 后，我必须运行`db.repairDatabase()`数据，因为某些数据没有使用`error: { "$err" : "assertion db/key.cpp:409" }`. 现在一切都恢复正常了。

# python - Django ORM，按天分组

> ID：10154227
> 
> 赞同：33
> 
> 时间：2012-04-14T14:00:02.783
> 
> 标签：python, mysql, django, django-orm

我正在尝试按 DAY 对产品进行分组，但是 date_created 是一个日期时间字段。

```
Product.objects.values('date_created') \
               .annotate(available=Count('available_quantity')) 
```

返回：

```
[
    {'date_created': datetime.datetime(2012, 4, 14, 13, 3, 6), 'available': 1},
    {'date_created': datetime.datetime(2012, 4, 14, 17, 12, 9), 'available': 1},
    ...
] 
```

我想：

```
[
    {'date_created': datetime.datetime(2012, 4, 14), 'available': 2}, ...
] 
```

**编辑：**数据库后端MYSQL

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-14T14:38:37.007

受[这个问题](https://stackoverflow.com/questions/3543379/django-annotate-groupings-by-month)的启发，试试这个 for MySQL

```
from django.db.models import Count

Product.objects.extra(select={'day': 'date( date_created )'}).values('day') \
               .annotate(available=Count('date_created')) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-08-10T00:33:19.873

与[San4ez](https://stackoverflow.com/a/10154412/1476885)的答案类似，但将日期返回为 'YYYY-MM-DD' 而不是 'datetime.datetime(YYYY, MM, DD)'：

```
Product.objects.extra(select={'day': "TO_CHAR(date_created, 'YYYY-MM-DD')"})
               .values('day') \
               .order_by('day') \
               .annotate(available=Count('date_created')) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T14:05:41.303

在 Django 1.4 中，您可以`.dates('date_created', 'day')`使用`.values()`.

试试这个代码片段：

```
Product.objects.annotate(available=Count('available_quantity')) \
  .dates('date_created', 'day') 
```

这*应该*返回：

```
[
    {'date_created': datetime.datetime(2012, 4, 14), 'available': 2}, ...
] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-14T10:57:18.637

你可以试试

```
Product.objects.extra(select={'day': "TO_CHAR(date_created, 'YYYY-MM-DD')"})\
                .values('day')\
                .order_by('day')\
                .annotate(bets=Count('date_created')) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-04T11:19:04.857

通过遵循 San4ez 的回答和[Zanon](https://stackoverflow.com/users/1476885/zanon)[的](https://stackoverflow.com/users/455833/san4ez)变化

对我来说，我必须制定一个解决方法来使用 Postgres 或 Sqlite，因为 Count() 函数将考虑 datetime 字段，如果你要创建一个“day”输入只是与日期无关，因为 date_created 仍然保存时间信息，因此多个带有时间的记录不会被合并和计数，在尝试了很多不同的事情之后，我达到了跳过时间的方式

姜戈 2.2

```
from django.db.models import Count

# Change date() to to_char(created_at, 'YYYY-MM-DD') if using Postgres
Product.objects.extra(select={'day': 'date( date_created )'})\
    .values('day') \
    .order_by('date_created__date')\
    .annotate(available=Count('date_created__date')) 
```

# java - 使用 java 驱动程序为 GridFS 自定义 _id

> ID：10154242
> 
> 赞同：1
> 
> 时间：2012-04-14T14:02:12.110
> 
> 标签：java, mongodb, gridfs

我的问题与下面的问题相同，只是我想使用 java 驱动程序来执行此操作。

[使用 PHP 在 mongo GridFs 中创建自己的 files_id](https://stackoverflow.com/questions/8907050/create-own-files-id-in-mongo-gridfs-using-php)

上述问题中针对 Java 驱动程序给出的 googlegroup 链接实际上是针对 C# 驱动程序的。检查Java驱动程序GridFS api，似乎没有办法为GridFS文件集合设置_id字段。

有什么办法可以用 Java 驱动程序做到这一点，如果我不得不切换到使用其他驱动程序，它会造成很多不必要的混乱？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T04:03:32.793

GridFSInputFile 类的 Put 方法用于向 JSON 对象添加附加字段。因此，如果您添加默认为 ObjectId 的“_id”字段，它将覆盖 ObjectId。

我在 2.2.3 版本上尝试了以下代码并且它有效。

```
GridFSInputFile gif = gridfs.createFile(new File("c:\\image.jpg"));
gif.put("_id", 1234567);
gif.save(); 
```

文件集合按预期包含 1234567。chunks 集合与 file_id 具有相同的值。

# regex - 如何制作匹配“ ”、“ ”和“”的任意组合的正则表达式 " 出现在一行的开头？

> ID：10154243
> 
> 赞同：3
> 
> 时间：2012-04-14T14:02:22.610
> 
> 标签：regex

我想匹配所有“新行”类型的 html 标记（中断和段落） ，**无论它们出现多少**以及以什么顺序出现，只要它们出现在一行的开头。

此正则表达式模式匹配**第**一个： `^<[Bb][Rr] ?/?>|^<[Pp]>`

因此，鉴于此 text `<p><br>fred`，它将匹配第一个`<p>`但不匹配紧随其后的`<br>`。

请注意，我不想删除这些标签中的每一个，而只是删除那些出现在输入行开头的标签。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:11:57.033

我还将添加对标签之间空格的支持：

```
^(?:(?:<[Bb][Rr]>\s*)|(?:<[Pp]\s*>))+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T14:07:15.090

你需要一些[重复](http://www.regular-expressions.info/repeat.html)。

```
^(<[Bb][Rr] ?/?>|^<[Pp]>)+ 
```

此外，如果您只使用不区分大小写的标志而不是字符类，这将更清晰/更简洁。

```
^(<br ?/?>|^<p>)+ 
```

# python - Django 源代码中的 Model.py 在哪里？

> ID：10154246
> 
> 赞同：8
> 
> 时间：2012-04-14T14:02:46.903
> 
> 标签：python, django, django-models

我一直在编写我的前几个 Django 模型，并想看看所有模型扩展的基类（例如：“class Poll(models.Model”）但找不到 Model 基类。我检查了[github 上的源代码](https://github.com/django/django)当我浏览到[django.db.models](https://github.com/django/django/tree/master/django/db/models)目录时，我很惊讶没有找到可以查看的“Model.py”文件。这个文件是生成的吗？还是模型类存在于其他地方？或者有一些 python我不熟悉的包装魔术？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T14:36:27.307

如前所述，Python 不是 Java。特别是，Python 中没有任何内容说类必须存在于与该类同名的文件中。

正如 San4ez 指出的那样，`Model`该类位于 . 中`django.db.models.base`，并被导入到该`__init__.py`目录中的文件中，以便可以直接将其引用为`models.Model`. 这不是任何魔法，只是普通的惯用 ​​Python。

然而，一旦你查看了类本身的代码，你会发现它实际上包含了很多 Python 魔法，尤其是元类。但这是一个不同的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T14:07:10.820

在`https://github.com/django/django/blob/master/django/db/models/__init__.py`

看

```
from django.db.models.base import Model 
```

所以`Model`那里描述了类`https://github.com/django/django/blob/master/django/db/models/base.py`

从字面上看，您可以通过这种方式将模型导入`from django.db.models.base import Model`您的项目。但是 django 核心开发人员决定隐藏一些服务类，将一些导入到`django.db.models`包中，并为您提供更短的导入。

# html - HTML 背景图像不需要的缩进

> ID：10154249
> 
> 赞同：1
> 
> 时间：2012-04-14T14:03:41.517
> 
> 标签：html, css, background-image

我是 HTML 新手；但是我有使用 Objective-C 的编程经验，这是我的代码：

```
<STYLE TYPE="text/css">
  .horiz {
    background-image: url(Banner.png); 
    background-repeat: repeat-x;  
    height:100px; 
  }
</STYLE> 
```

我的banner.png 文件是一个 1x100 的图像，它可以很好地穿过屏幕，但问题是横幅从顶部和左侧缩进了几个像素。我不想要这种效果，我尝试过 position:relative 和 top:0px left:0px，我尝试过将 padding 设置为零（但都没有奏效）。

基本上，我想实现与 Twitter 中的顶栏类似的效果，它拥抱屏幕的顶部边缘，但我想不通。感谢您花时间帮助我！

ps 如果有什么不同，我在我的正文标签中使用了一个标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:09:12.460

您的问题可能与背景无关，实际上是由 body 元素本身的填充引起的，这将阻止您的`.horiz`元素紧贴视口顶部。

默认情况下，您的 HTML 文档将设置一些初始样式。其中之一是在`<body/>`元素上填充。使用*重置*样式表是一种常见的做法，例如 Eric Meyer 提供的样式表。您可以在 Chris Coyier 的网站上找到它：http: [//css-tricks.com/snippets/css/meyer-reset/](http://css-tricks.com/snippets/css/meyer-reset/)

只需在您的文档中首先引用它，然后继续添加您自己的所有自定义样式。这样做的另一件事是规范不同浏览器供应商之间默认存在的风格差异。

# css - 滚动固定位置容器中的部分内容

> ID：10154250
> 
> 赞同：60
> 
> 时间：2012-04-14T14:04:07.163
> 
> 标签：css, overflow

我`position: fixed`在布局中有一个 div，作为侧边栏。我被要求将它的部分内容固定在它的顶部（内部），*如果它溢出 div 的底部，*其余的则滚动。

我看过[这个答案](https://stackoverflow.com/a/4646733/383609)，但是那里提出的解决方案不适用于容器`position: fixed`，`position: absolute`这很痛苦。

我在这里做了一个 JSFiddle 演示我的[问题](http://jsfiddle.net/jamwaffles/AKL35/1)。理想情况下，大量文本应该滚动，而不是溢出到页面底部。标题的高度可以随内容而变化，并且可以是动画的。

```
body {
    background: #eee;
    font-family: sans-serif;
}

div.sidebar {
    padding: 10px;
    border: 1px solid #ccc;
    background: #fff;
    position: fixed;
    top: 10px;
    left: 10px;
    bottom: 10px;
    width: 280px;
}
div#fixed {
    background: #76a7dc;
    padding-bottom: 10px;
    color: #fff;
}

div#scrollable {
    overlow-y: scroll;
}
```

```
<div class="sidebar">
    <div id="fixed">
        Fixed content here, can be of varying height using jQuery $.animate()        
    </div>

    <div id="scrollable">
        Scrolling content<br><br>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </div>
</div>
```

如果没有固定的标题，我可以简单地添加`overflow-y: scroll`，`div.sidebar`如果它溢出容器的底部，我可以愉快地滚动它的所有内容。但是，我遇到了在侧边栏顶部有一个固定的、可变高度的标题的问题，并且如果滚动条太长而无法放入容器中，则在该滚动条下方有任何内容。

`div.sidebar` *必须*留下来`position: fixed`，我非常希望在没有任何黑客攻击的情况下做到这一点，并尽可能使其成为跨浏览器。我尝试了各种事情，但没有一个有效，我不确定从这里尝试什么。

当容器内的 div 的内容溢出包含的 div 时，如何使`position: fixed`容器内的 div 仅在 Y 方向上滚动，并且具有可变的、不确定的高度的固定标题？我非常想远离 JS，但如果我必须使用它，我会的。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-04-14T17:14:15.303

如果你使用它似乎工作

```
div#scrollable {
    overflow-y: scroll;
    height: 100%;
} 
```

并添加`padding-bottom: 60px`到`div.sidebar`.

例如：http: [//jsfiddle.net/AKL35/6/](http://jsfiddle.net/AKL35/6/)

但是，我不确定为什么必须如此`60px`。

另外，你错过了`f`来自`overflow-y: scroll;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-15T09:13:47.070

什么对我有用：

```
div#scrollable {
    overflow-y: scroll;
    max-height: 100vh;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-30T16:05:49.783

我将可滚动的 div 更改为具有绝对位置，一切都对我有用

```
div.sidebar {
    overflow: hidden;
    background-color: green;
    padding: 5px;
    position: fixed;
    right: 20px;
    width: 40%;
    top: 30px;
    padding: 20px;
    bottom: 30%;
}
div#fixed {
    background: #76a7dc;
    color: #fff;
    height: 30px;
}

div#scrollable {
    overflow-y: scroll;
    background: lightblue;

    position: absolute;
    top:55px; 
    left:20px;
    right:20px;
    bottom:10px;
} 
```

[带有两个可滚动 div 的演示](http://jsfiddle.net/AKL35/472/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-18T15:20:47.147

实际上，这是更好的方法。如果`height: 100%`使用，内容会超出边界，但是当它是`95%`一切正常时：

```
div#scrollable {
    overflow-y: scroll;
    height: 95%;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-14T15:00:28.730

将可滚动的 div 设置为具有`max-size`并添加`overflow-y: scroll;`到它的属性。

编辑：试图让 jsfiddle 工作，但它没有正确滚动。这需要一些时间才能弄清楚。

# asp.net-mvc - 唯一验证属性不适用于编辑现有元素

> ID：10154252
> 
> 赞同：2
> 
> 时间：2012-04-14T14:04:18.433
> 
> 标签：asp.net-mvc

在我的解决方案中添加或编辑用户时，我想验证用户名是否尚未使用。

这是我对远程验证所做的事情：

视图模型：

```
 [Required, Remote("UserNameAlreadyExists", "User", Error="Already exists!")]
    public string UserName { get; set; } 
```

控制器：

```
 public ActionResult UserNameAlreadyExists(string userName)
    {
        var user = _requestServiceClient.GetUserFromUserName(userName);
        return Json(user == null, JsonRequestBehavior.AllowGet);
    } 
```

它非常适合创作。但它不适用于版本，因为已编辑用户本人的用户名已经存在。你懂我的意思吗？

一种解决方案是根据用户名和用户 ID 签入数据库。所以在编辑用户的情况下，我们可以检查用户名不存在（除了作为参数传递的用户ID）。这是一个很好的选择吗？如何在远程验证属性中传递此用户 ID？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T14:38:08.490

如果您的用户在创建后无法更改其用户名，则使用不同的视图模型进行编辑，您只需在其中显示`UserName`而不进行任何验证。

否则，您可以使用[AdditinalFields](http://msdn.microsoft.com/en-us/library/system.web.mvc.remoteattribute.additionalfields%28v=vs.98%29.aspx)属性将额外数据传递给您的验证器：

```
public class UserModel
{
    public int Id{ get; set; }

    [Required, Remote("UserNameAlreadyExists", "User", AdditionalFields = "Id")]
    public string UserName { get; set; }
}

public ActionResult UserNameAlreadyExists(string userName, int id)
{
    var user = _requestServiceClient.GetUserFromUserNameAndId(userName, id);
    return Json(user == null, JsonRequestBehavior.AllowGet);
} 
```

您还需要`Id`在您的`form`例如：

```
@using (Html.BeginForm())
{
    @Html.HiddenFor(m => m.Id)
    @Html.TextBoxFor(m => m.UserName)
    @Html.ValidationMessageFor(x => x.UserName)
    <input type="submit" value="Save" />
} 
```

# android - 无法在 Android 项目中使用 Gson 库

> ID：10154256
> 
> 赞同：0
> 
> 时间：2012-04-14T14:04:49.927
> 
> 标签：android

我不确定为什么这个特定的库会给我带来麻烦，而其他人却没有。我做了以下尝试缩小范围：

1.) 在 Eclipse 中，新的 Android 项目 2.) 将 gson-1.7.1.jar 复制到 lib/ 3.) 右键单击​​ gson-1.7.1.jar，添加到构建路径 4.) 将此添加到样板主要活动: 格森格森; 5.) 项目在运行时抛出此异常：

```
04-14 13:50:23.366: E/AndroidRuntime(1020): FATAL EXCEPTION: main
04-14 13:50:23.366: E/AndroidRuntime(1020): java.lang.NoClassDefFoundError: com.google.gson.Gson
04-14 13:50:23.366: E/AndroidRuntime(1020):     at com.nerdsoft.client.GsonTestActivity.onCreate(GsonTestActivity.java:17)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.os.Looper.loop(Looper.java:123)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at java.lang.reflect.Method.invokeNative(Native Method)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at java.lang.reflect.Method.invoke(Method.java:521)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-14 13:50:23.366: E/AndroidRuntime(1020):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:12:35.773

将您的`lib`文件夹名称更改为`libs`并重新运行它。

# iphone - 便利构造函数是否会增加应用程序的大小...？

> ID：10154257
> 
> 赞同：1
> 
> 时间：2012-04-14T14:04:52.747
> 
> 标签：iphone, objective-c, ios, constructor, autorelease

我很确定他们这样做......但只是想确认......例如看看下面的代码......

```
- (void)reset {
NSNumber *zero = [NSNumber numberWithInteger:0];
[self setCount:zero];
} 
```

现在这将返回一个自动释放的对象，该对象被添加到应用程序的自动释放池中，从而增加了它的大小......

除非应用程序被终止，否则这不会被释放..？任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:07:14.787

内存在下一次​​通过应用程序的主事件循环时被释放。

确切的时间取决于您的应用程序何时完成执行代码并返回事件循环。在事件循环期间，在计划的任务中，正在清空（耗尽）应用程序的自动释放池。

如果您担心自动释放池的大小增加，您可以战略性地使用自己的自动释放池。

# php - 表单到 iframe 提交 - 文件上传后如何重置表单？

> ID：10154260
> 
> 赞同：0
> 
> 时间：2012-04-14T14:05:08.520
> 
> 标签：php, javascript, html, ajax

我有一个将结果提交到 iframe 的表单。提交的字段和文件上传由upload.php 处理。尽管我希望在成功提交文件后重置表单，但一切都按预期工作，创建了一个 ajax 样式的结果。否则提交按钮将继续上传相同的文件。

形式

```
<form action="functions/upload.php" method="POST" enctype="multipart/form-data" name="form1" id="form1" target="fileupload"> 
```

框架

```
<iframe name="fileupload" frameborder="0" src="functions/upload.php" style="float:none; color:#FFF; display:none" width="100%" id="result" allowtransparency="true"></iframe> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:09:21.600

`iframe`文件上传成功后，您可以在右侧运行以下 JavaScript 代码。

```
parent.document.getElementById("form1").reset(); 
```

# algorithm - 算法 | 多数元素

> ID：10154263
> 
> 赞同：2
> 
> 时间：2012-04-14T14:05:34.920
> 
> 标签：algorithm, runtime, element

我试图编写一个算法，如果数组中存在多数元素，则返回 true，否则返回 false。编辑：我只能判断两个元素是否相等。这意味着我不能使用 < 或 >，只能使用 =。编辑：解决方案应该采用分而治之的方法。它的运行时不应该超过nlogn，我用java写了一些东西，但我不确定它是否正确以及如何计算运行时..这是我得到的：

```
public static boolean MajorityBoolean(int[] arr) {
    int c;
    int n = arr.length;
    for (int i = 0; i < n; i = i + 2) {
        System.out.println("*");
        if ((arr[i] == arr[(i + 1)%n]) || ((arr[i] == arr[(i - 1+n)%n]))) {
            c = 0;
            for (int j = 0; j < n; j = j + 1)
                if (arr[j] == arr[i])
                    c = c + 1;
            if (c > n / 2)
                return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T14:23:28.797

所描述算法的运行时间是`O(n^2)`. 外循环被执行`n/2`次数，因此内计数器`j`被重置 `n/2`次数，因此内循环被执行总`O(n^2)`次数。

我不确定我是否遵循您的想法背后的逻辑，但这里有两种方法我将如何实现它[在高级伪代码中]：

(1) 从数据中创建一个[直方图](http://en.wikipedia.org/wiki/Histogram)：

*   创建一个[`Map<Integer,Integer>`](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)[键是元素，值是出现次数]
*   迭代数组，并为每个元素计算它出现的次数
*   迭代直方图并找出是否存在唯一的最大值。
*   如果有 - 返回真，否则返回假。

`O(n)`如果您使用 a[`HashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)作为地图，这种方法是平均的。

(2) 排序并找到最大出现次数：

*   对数组进行排序 - 结果，所有相等的元素都彼此相邻。您可以[`Arrays.sort(array)`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28int%5B%5D%29)用于排序。
*   计算每个元素出现的次数[类似于直方图的想法]，并找出是否存在唯一的最大值。你实际上不需要维护*所有*元素的数据，维护前 2 个就足够了，最后看看它们是否相同。

这个解决方案是`O(nlogn)`平均+最坏情况[实际上，取决于排序-[合并](http://en.wikipedia.org/wiki/Merge_sort)排序给你`O(nlogn)`最坏情况，而[快速排序](http://en.wikipedia.org/wiki/Quicksort)给你`O(n^2)`最坏情况，两者都是`O(nlogn)`平均情况]。

编辑：

我误解了手头的问题，我以为您正在寻找是否存在唯一的最大值。这两个解决方案仍然适合该问题，您只需修改每个解决方案的最后一步 [检查最常出现的元素是否出现超过一半的时间，这在`O(n)`] 中再次相当容易和可行。

另外，还有一种解决方法：使用[选择算法](http://en.wikipedia.org/wiki/Selection_algorithm)求中位数，找到后判断是否为多数元素，如果是则返回。由于选择算法是基于分而治之的解决方案，我认为它符合您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-17T22:14:58.407

大小为 n 的数组 A[] 中的多数元素是出现超过 n/2 次的元素

```
public static boolean find(int[] arr, int size) { 
int count = 0, i, mElement;
for (i = 0; i < size; i++) {
    if (count == 0)
        mElement = arr[i];
    if (arr[i] == mElement) 
        count++;
    else
        count--;
}
count = 0;
for (i = 0; i < size; i++)
    if (arr[i] == mElement)
        count++;
if (count > size/2)
    return true;
return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T14:48:39.587

以下是 O(n) 解决方案 [Find Majority Element](https://stackoverflow.com/a/9487018/560302)

# javascript - Jquery .toggle 只显示不隐藏在 Drupal 视图中

> ID：10154266
> 
> 赞同：0
> 
> 时间：2012-04-14T14:05:49.677
> 
> 标签：javascript, drupal, views, jquery

我对drupal中的节点有一个看法。每个节点都有按钮（应该）在表格中切换一个额外的行。但是，尽管我能够打开额外的行，但我无法再次将其关闭。

这是javascript；

```
Drupal.behaviors.morelink = function(context) {
  $("a.morelink").click(function (e) {
    e.preventDefault();
    $('.more').hide();
    $('.more').eq( $('a.morelink').index( $(this) ) ).toggle();
  });
} 
```

这是我的 node-type.tpl.php 中的按钮；

```
<a class="morelink" href = "<?php print url('node/' . $node->nid); ?>">
<img src="greydown.png" ALT="More"></a> 
```

这是额外的行；

```
<tr class="more ">
<td> some content here</td>
</tr> 
```

这是CSS；

```
.more {
  display:none;
} 
```

关于为什么我不能再次关闭（隐藏）的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:51:45.370

可能是因为你每次都这样，结果`hide`是. IE：`toggle``show`

```
$('.more').hide();
$('.more').eq( $('a.morelink').index( $(this) ) ).toggle(); 
```

如果你删除`hide()`，你应该很好。

# ruby - 让 Ruby 块返回一个数组？

> ID：10154267
> 
> 赞同：1
> 
> 时间：2012-04-14T14:06:05.680
> 
> 标签：ruby, block, dsl

我制作了一个类似 DSL 的小程序，用于将饮料添加到数组中。这是使用`instance_eval`和`&block`创建快速程序的一个非常基本的示例。

这是程序：

```
class Drinks
  def initialize(&block) # Initialize drinks
    @drinks = []
    instance_eval &block
  end

  def drink(d)
    @drinks << d
  end # Add drink

  def all_drinks
    puts @drinks
  end

end

add_drinks = Drinks.new do
  drink "water"
  drink "soda"
  drink "juice"
end

add_drinks.all_drinks 
```

计划是`add_drinks`自动返回，因此您不必使用`add_drinks.all_drinks`. 这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T14:37:18.113

您可以从 Array 继承 Drinks，因此您可以像使用数组一样使用新实例

```
class Drinks < Array
  def initialize(&block) # Initialize drinks
    instance_eval &block
  end

  def drink(d)
    self << d
  end # Add drink
end

add_drinks = Drinks.new do
  drink "water"
  drink "soda"
  drink "juice"
end

add_drinks  #  => ["water", "soda", "juice"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:01:40.133

您可能需要重新考虑对象是什么以及它的行为方式。也许这样做：

```
class Drinks
  def initialize(&block)
    @drinks = []
    instance_eval &block
  end

  def add(d)
    @drinks << d
  end

  def show
    puts @drinks
  end
end

drinks = Drinks.new do
  add "water"
  add "soda"
  add "juice"
end

drinks.show 
```

# ruby - Ruby - rails - 拆分字符串并以相反的顺序打印

> ID：10154270
> 
> 赞同：0
> 
> 时间：2012-04-14T14:06:38.407
> 
> 标签：ruby, ruby-on-rails-3

我需要拆分一个字符串并从我的视图底部开始打印它。标准方式从头开始读取字符串并相应地打印。我该如何扭转它？

```
<% @a[:log].to_s.split(/----/).each do |line| %>
<div width='100%'><pre class="log"><%= "#{line}" %></pre></div>
<% end %>

@a[:log] is a string something like this: One ---- Two ---- Three ---- Four

I want this printed reverse starting from Four, instead of One. 

<div width='100%'><pre class="log">Four</pre></div>
<div width='100%'><pre class="log">Three</pre></div>
<div width='100%'><pre class="log">Two</pre></div>
<div width='100%'><pre class="log">One</pre></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:37:45.450

如果您不想要一个中间数组（该`reverse`方法返回），那么有`reverse_each`.

```
@a[:log].to_s.split(/----/).reverse_each 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T14:11:38.660

代替：

```
@a[:log].to_s.split(/----/).each 
```

做：

```
@a[:log].to_s.split(/----/).reverse.each 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T14:12:42.333

`@a[:log].to_s.split(/----/).reverse.each`

# android - 解析xml文件时出错

> ID：10154272
> 
> 赞同：0
> 
> 时间：2012-04-14T14:07:01.703
> 
> 标签：android, xml, parsing

嗨，我创建了一个 save11111.xml 文件并放在服务器上。 这是我需要从该文件中获取数据[的 .xml 文件的代码。](http://pastebin.com/AdMJdZWH)
但是当我尝试运行文件时，它在
Log cat 中显示错误。这是logcat

```
04-14 19:18:58.137: ERROR/AndroidRuntime(22682): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.examguide/com.example.examguide.ReadBooksActivity}: java.lang.IllegalStateException: Target host must not be null, or set in parameters.
04-14 19:18:58.137: ERROR/AndroidRuntime(22682): Caused by: java.lang.IllegalStateException: Target host must not be null, or set in parameters.
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at org.apache.http.impl.client.DefaultRequestDirector.determineRoute(DefaultRequestDirector.java:572)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:292)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at com.example.examguide.XMLParser.getXmlFromUrl(XMLParser.java:45)
04-14 19:18:58.137: ERROR/AndroidRuntime(22682):     at com.example.examguide.ReadBooksActivity.onCreate(ReadBooksActivity.java:43) 
```

我不明白我的代码有什么问题。[这里和](http://pastebin.com/TCTQwERa)[这里](http://pastebin.com/K0mwN5rh)

请给我一些提示或参考。
任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:43:43.043

您忘记在 URL 中指定协议：

```
 static final String URL = "http://www.cerebrumtechno.com/Save.xml"; 
```

# android - 如何在开发 Android 应用程序时获取实时足球比赛直播的 RSS 提要

> ID：10154273
> 
> 赞同：0
> 
> 时间：2012-04-14T14:07:06.327
> 
> 标签：android

我是android开发的新手，我有一点问题。我想开发一个应用程序，我可以在该应用程序上获得足球比赛的现场直播。我不确定一些像 ESPN 这样的足球网站是否有此类 RSS 订阅的规定。我不确定是否可以直接在我的应用程序上获取游戏广播，而不会将我重定向到网站本身

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T18:07:43.613

或者，如果您愿意，您可以购买 XML API 服务的订阅，以获得更结构化的数据获取方式。我使用[http://www.xmlsoccer.com](http://www.xmlsoccer.com)已经有一段时间了。它们非常实惠，并且免费提供一个没有时间限制的演示联赛，因此您可以花所有时间针对他们的 API 进行开发，而无需支付任何费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:36:44.953

如果您有权访问这些 RSS 提要，则可以使用 DocumentBuilderFactory 解析它们

# jquery - jquery UI 自动完成等效库

> ID：10154275
> 
> 赞同：0
> 
> 时间：2012-04-14T14:07:11.267
> 
> 标签：jquery, autocomplete, equivalent

我正在寻找等效的 Jquery UI 自动完成功能。我不能在我的项目中使用 jQuery UI。对我应该使用的一些库有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:12:43.820

我用这个：

[http://www.devbridge.com/projects/autocomplete/jquery/](http://www.devbridge.com/projects/autocomplete/jquery/)

# java - 无法获取具有抽象父级的子嵌套类的字段

> ID：10154281
> 
> 赞同：0
> 
> 时间：2012-04-14T14:07:33.810
> 
> 标签：java, oop

尝试获取子嵌套静态类的字段值时，获取`null`. *1 *每个类文件由水平线划分。如何检索子战士的值？

* * *

```
abstract class GameCahracter{

        public String name;

    public String type;

    public Weapon weapon; 

    public int hitPoints;

    public String getDescription(){

        return type + "; " + name + "; " + hitPoints + " hp; " + weapon.type; 
    }

    public static class Warrior extends Player{

        public final String type = "Warrior";

        public int hitPoints = 100;

        public static final  Weapon.Sword weapon = new Weapon.Sword(); 

    }
} 
```

* * *

```
abstract class Player extends GameCahracter {

} 
```

* * *

```
GameCahracter.Warrior wr = new GameCahracter.Warrior();

wr.name = "Joe";

System.out.println( wr.getDescription()); 
```

* * *

输出：

```
null; Joe; 0 hp; null 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:25:10.703

不要重新声明成员变量。相反，您应该在构造函数中设置值。

```
public static class Warrior extends Player{
    public Warrior() {
      type = "Warrior";
      hitPoints = 100;
      weapon = new Weapon.Sword(); 
    }
} 
```

另一种选择是创建一个`GameCahracter`构造函数，它接受与每个成员变量匹配的参数。

作为旁注：公共成员变量是一个坏主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:47:56.090

`GameCahracter.name`并且`GameCahracter.hitPoints` 没有被分配，所以它们保持为空。`Warrior.name`并被`WarriorhitPoints.hitPoints`分配，但它们是不同的字段。在父项和子项中使用相同名称的字段是一个坏主意（与方法不同）。

# c++ - 围绕 glutMainLoop 执行我的程序的其余部分？

> ID：10154282
> 
> 赞同：2
> 
> 时间：2012-04-14T14:07:43.200
> 
> 标签：c++, opengl, glut

我目前正在开发一个项目，其中我在 PC 上的 OpenGL 窗口中编写了控件和对象的 Android 应用程序。我已经得到了 OpenGL 窗口来做我想做的事，并且我已经从我的 android 设备获取数据以流式传输到终端。但是，我需要将数据流式传输到终端以供 OpenGL 对象使用。当我尝试在同一个脚本中运行它们时，它只会卡在“glutMainLoop”中，并且永远不会达到与我的设备建立连接的地步。我知道这是 glutMainLoop 的一个常见问题。我正在寻找任何建议。我是不是走错了路？有更好的方法吗？我在下面附上了我的代码：

```
 #include <stdlib.h>
#include <stdio.h>
#include <signal.h>
#include <string.h>
#include <strings.h>
#include <vrpn_Shared.h>
#include <vrpn_Analog.h>
#include <vector>

#include <imageviewer.h>

using namespace std;

int done = 0;           // Signals that the program should exit
unsigned tracker_stride = 1;    // Every nth report will be printed

//-------------------------------------
// This section contains the data structure that holds information on
// the devices that are created.  For each named device, a remote of each
// type analog is created.

class device_info {
    public:
    char            *name;

    vrpn_Analog_Remote  *ana;

};
const unsigned MAX_DEVICES = 2;

//-------------------------------------
// This section contains the data structure that is used to determine how
// often to print a report for each sensor of each tracker.  Each element
// contains a counter that is used by the callback routine to keep track
// of how many it has skipped.  There is an element for each possible sensor.
// A new array of elements is created for each new tracker object, and a
// pointer to it is passed as the userdata pointer to the callback handlers.

class t_user_callback {
    public:
    char            t_name[vrpn_MAX_TEXT_LEN];
        vector<unsigned>    t_counts ;
};

//Callback handlers

void    VRPN_CALLBACK handle_analog (void *userdata, const vrpn_ANALOGCB a)
{
    int i;
    const char *name = (const char *)userdata;

    printf("Input from %s:\n  \n        %5.0f", name, a.channel[0]);
    for (i = 1; i < a.num_channel; i++) {
    printf(" %5.0f \n", a.channel[1]);
    }
    printf(" \n");
}

int main (int argc, char * argv [])
{

  int   print_for_tracker = 1;  // Print tracker reports?
  int   print_for_button = 1;   // Print button reports?
  int   print_for_analog = 1;   // Print analog reports?
  int   print_for_dial = 1; // Print dial reports?
  int   print_for_text = 1; // Print warning/error messages?

  device_info device_list[MAX_DEVICES];
  unsigned num_devices = 0;

  int i;

  // Parse arguments, creating objects as we go.  Arguments that
  // change the way a device is treated affect all devices that
  // follow on the command line.
  for (i = 1; i < argc; i++) {
    if (!strcmp(argv[i], "-notracker")) {
      print_for_tracker = 0;
    } else if (!strcmp(argv[i], "-nobutton")) {
      print_for_button = 0;
    } else if (!strcmp(argv[i], "-noanalog")) {
      print_for_analog = 0;
    } else if (!strcmp(argv[i], "-nodial")) {
      print_for_dial = 0;
    } else if (!strcmp(argv[i], "-notext")) {
      print_for_text = 0;
    } else if (!strcmp(argv[i], "-trackerstride")) {
      if (tracker_stride <= 0) {
      fprintf(stderr, "-trackerstride argument must be 1 or greater\n");
      return -1;
      }
    } else {    // Create a device and connect to it.
    device_info *dev;

    // Make sure we have enough room for the new device
    if (num_devices == MAX_DEVICES) {
        fprintf(stderr,"Too many devices!\n");
        exit(-1);
    }

    // Name the device and open it as everything
    dev = &device_list[num_devices];
    dev->name = argv[i];

    dev->ana = new vrpn_Analog_Remote(dev->name);

    if ( (dev->ana == NULL) ){         
        fprintf(stderr,"Error opening %s\n", dev->name);
        return -1;
    } else {
        printf("Opened %s as:", dev->name);
    }
    if (print_for_analog) {
        printf(" Analog");
        dev->ana->register_change_handler(dev->name, handle_analog);
    }
    printf(".\n");
    num_devices++;
    }

  }

 // main interactive loop

  printf("Press ^C to exit.\n");
  while ( ! done ) {
      unsigned i;

      // Let all the devices do their things
      for (i = 0; i < num_devices; i++) {

      device_list[i].ana->mainloop();

      glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_SINGLE);
    glutInitWindowSize(400,300);
    glutInitWindowPosition(200,100);
    glutCreateWindow("ImageViewer");

    init();
    glutDisplayFunc(display);
    glutMotionFunc(drag);
    glutMouseFunc(mouse);
    glutMainLoop();

      }
  }
 return 0;
}  

// a.channel[0] =  x
// a.channel[1] =  y
// a.channel[2] =  Zoom? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:28:18.213

你可以停止使用 GLUT。[GLFW](http://www.glfw.org/)使您可以更好地控制循环，以便更轻松地进行其他处理。

如果您坚持使用 GLUT，并且您正在使用 FreeGLUT，那么您可以使用`glutMainLoopEvent`. 此函数处理主循环的一次迭代。所以你可以把它粘在一个无限循环中并重复调用它。作为该循环的一部分，您可以执行其他操作，例如从终端提取数据等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T10:26:39.617

freeglut 提供[glutMainLoopEvent](http://freeglut.sourceforge.net/docs/api.php#EventProcessing)，所以你可以选择你的运行模式。

# xcode - 如何在文本视图中创建段落？

> ID：10154286
> 
> 赞同：0
> 
> 时间：2012-04-14T14:08:09.617
> 
> 标签：xcode, macos, xcode4, xcode4.2, xcode4.3

有谁知道如何在文本视图中创建段落。我正在尝试学习 Xcode，并尝试学习我正在制作一个应用程序。我希望它看起来像：（当我输入它时，它看起来像这样，但它不会像这样出来。

" 发动机规格：
 VQ37CHR - 3.7 升 DOHC 24 气门 V6
 332hp @ 7,000rpm
 276 lb-ft @ 5,200rpm <br> Nismo 调谐双排气
 双进气系统  

传动系统：
  碳纤维驱动轴
 6 速闭比手动变速箱 <br> 7 速自动，带手动换档模式，换挡拨片和转速匹配
 VLSD
  4 轮通风盘式制动器
 2 连杆 双叉骨 前
 4 连杆悬架悬架后 <br> 前后稳定杆"

但它不断出现，就像这样一个巨大的段落：

“Z 系列的第 5 代。发动机规格：VQ37CHR - 3.7 升 DOHC 24 气门 V6 332hp @ 7,000rpm 276 lb-ft @ 5,200rpm Nismo 调谐双排气双进气系统传动系统：碳纤维驱动轴 6 速关闭-比率手动变速箱 7 速自动带手动换档模式，换挡拨片和转速匹配 VLSD 4 轮通风盘式制动器 2 连杆双叉骨悬架前 4 连杆悬架后前和后稳定杆"

对不起，我是菜鸟。

`textView.text = @"The 5th Generation in the Z family.\nEngine Specs:\nVQ37CHR - 3.7 Liter DOHC\n 24-Valve V6\n332hp @ 7,000rpm\n276 lb-ft @ 5,200rpm\nNismo Tuned Dual Exhaust\n\nTwin intake System\n\nDrivetrain:\nCarbon Fiber Drive Shaft\n6-speed close-ratio Manual Transmission\n7-speed Automatic w/ manual shift mode, paddle shifters and rev matching\nVLSD\n\n4-wheel vented disc brakes\n2-link Double wish bone Suspension front\n4-link Suspension rear\nfront and rear Stabilizer bars";`已更新<--我将其放入视图 FirstViewController.m 这是放置它的正确位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T01:17:54.600

`\n`又名换行符。把它放在你想要换行的文本中，如下所示：

```
textView.text = @"Engine Specs:\nVQ37CHR - 3.7 Liter DOHC 24-Valve V6\n..."; 
```

# python - 使用 BeautifulSoup 提取第一个子标签之前的文本

> ID：10154289
> 
> 赞同：9
> 
> 时间：2012-04-14T14:08:30.157
> 
> 标签：python, beautifulsoup

从这个 html 源代码：

```
<div class="category_link">
  Category:
  <a href="/category/personal">Personal</a>
</div> 
```

我想提取文本`Category:`

这是我使用 Python/BeautifulSoup 的尝试（输出为注释 - 在 # 之后）

```
parsed = BeautifulSoup(sample_html)
parsed_div = parsed.findAll('div')[0]
parsed_div.firstText() # <a href="/category/personal">Personal</a>
parsed_div.first() # <a href="/category/personal">Personal</a>
parsed_div.findAll()[0] # <a href="/category/personal">Personal</a> 
```

我希望“文本节点”可以作为第一个孩子使用。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-14T14:53:28.663

我相当确定以下应该做你想要的

```
parsed.find('a').previousSibling # or something like that 
```

这将返回一个与`NavigableString`实例几乎相同的`unicode`实例，但您可以调用`unicode`它来获取一个 unicode 对象。

我会看看我是否可以测试一下并让你知道。

**编辑**：我刚刚确认它有效：

```
>>> from BeautifulSoup import BeautifulSoup
>>> soup = BeautifulSoup('<div class=a>Category: <a href="/">a link</a></div>')
>>> soup.find('a')
<a href="/">a link</a>
>>> soup.find('a').previousSibling
u'Category: '
>>> 
```

# php - 通过 IP、cookie 限制访问？- 有更好的解决方案吗？

> ID：10154291
> 
> 赞同：1
> 
> 时间：2012-04-14T14:08:49.277
> 
> 标签：php, mysql

我正在使用 PHP 和 MySQL 来限制对未注册用户的下载访问。

我看到的唯一选项是 cookie 和/或 IP 地址。

Cookies 不是一个好的解决方案，因为重要的是用户不能通过删除他们的 cookie 来重置他们的下载计数 - 因为他们的想法是如果他们的使用量超过一定水平，他们就会付费。

这让我可以通过在 PHP 中记录 IP 地址并将其插入 MySQL 数据库来限制访问。传统上，这个问题是有些人使用动态/共享 IP，因此计数对他们毫无意义，甚至可能阻止其他潜在客户免费下载。

但话又说回来，几乎我所有的销售都来自西方国家，而且现在西方的大多数人似乎都使用静态 IP 地址……这是正确的吗？

解决这个困境的最佳方案是什么？有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:22:51.130

您可以通过使用多种策略而不是仅使用一种策略来更好地识别唯一用户。结合 IP 地址、cookie 和浏览器的用户代理可以为您提供客户端的唯一密钥。我还建议嵌入一个 JavaScript 片段，将操作系统、屏幕大小等发送到服务器以与唯一用户相关联。

然后，您使用降级方法来规范访问。为您提供上述信息的所有访问权限的用户可以下载文件到他们的限制。限制 cookie、禁用 javascript 的用户对文件的访问更少。并且您将 IP 视为简单的用户唯一 ID。如果他们在共享网络上，那么对他们来说很难，他们应该启用 cookie。

对于具有滚动 IP 地址、禁用 cookie 和禁用 Javascript 的人。您实际上无能为力，但它们只代表一小部分用户。

cookie 不是识别某人的好方法，因为他们可以删除它，但它会为您节省一些数据库执行，以便仅查找 IP 和用户代理。所以更多的是速度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T14:11:17.077

> 这个对吗？

不。

您可以通过创建服务器端会话来解决这个难题。用户必须识别、登录。然后，您可以跟踪您需要跟踪的所有内容。

**编辑：**回顾一下：您希望客户端系统除了识别用户之外什么都不需要。您一次希望太多，显然您选择了错误的平台。

让我们更仔细地回顾一下：

*   饼干：你不想要它们。
*   IP地址：就像关闭浏览器一样，切换IP很容易。你不想要那个。

现在让我想想还剩下什么？唔。出色地。没有什么？

您唯一能做的就是尝试组合尽可能多的识别元素，而不是让它们每个都需要，以便通过模式组合成有用且可行的识别用户的总和：

1.  饼干
2.  知识产权
3.  标头
4.  更多标题
5.  推荐人

使用服务器端会话跟踪它。如前所述，如果你想开始构建复杂的东西，你需要 session。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:11:56.750

要求您网站的访问者至少提供一封电子邮件或一些其他无法更改或留在客户端的信息。cookie，会话可以清除，ips 可能是动态的。

# r - geom_rect 失败：eval 中的错误（expr，envir，enclos）：找不到对象“变量”

> ID：10154293
> 
> 赞同：11
> 
> 时间：2012-04-14T14:08:56.890
> 
> 标签：r, ggplot2

我试图在 ggplot2 书的第 86 页复制 Hadley Wickham 的示例，其中他覆盖了 geom_rects，显示执政党对失业趋势的控制。这是我的核心代码，带有一些示例数据：

```
library("ggplot2")
library("reshape2")
library("lubridate")

con <- textConnection("Date,Var1,Var2
8-Jan-12,100.8,116
15-Jan-12,99.4,115.5
22-Jan-12,98.4,115
28-Jan-12,97.1,114
4-Feb-12,95.9,112
11-Feb-12,95.3,113
18-Feb-12,93.9,111.5
25-Feb-12,93.5,111.5
3-Mar-12,92.6,110
10-Mar-12,91.4,108
17-Mar-12,90.2,106.8
24-Mar-12,90,107.5
31-Mar-12,89.9,106
5-Apr-12,90.4,106.5
12-Apr-12,89.8,106") 

track <- read.csv(con, header=TRUE)
track$Date <- as.Date( dmy(track$Date) )

track <- melt(track, 
            id.vars = c("Date"))

con <- textConnection("City,From,To
Auckland,5-Apr-12,10-Apr-12
Brussels,1-Apr-12,3-Apr-12
Cleveland,24-Jan-12,26-Jan-12
Darjeeling,18-Jan-12,19-Jan-12
Erehwon,8-Feb-12,10-Feb-12
Florence,5-Mar-12,7-Mar-12
Gandalf,25-Mar-12,27-Mar-12")

trips <- read.csv(con, header=TRUE)
trips$From <- as.Date( dmy(trips$From) )
trips$To <- as.Date( dmy(trips$To) )

# draw the Time Series data
p <- ggplot(track, 
            aes(x = Date, 
                y = value, 
                colour=variable,
                group = variable))
p <- p + geom_smooth()
p <- p + geom_point(size=3)
p <- p + geom_vline(data=trips, 
                    aes(xintercept=From),
                    colour='steelblue') # departure dates
p <- p + geom_vline(data=trips, 
                    aes(xintercept=To),
                    colour='grey80') # return dates
yrng <- c(80,120)
p <- p + scale_y_continuous(limits=yrng)

p # this works up to here, using vlines (ugly, but makes the point)

# ----------- THIS geom_rect() STOPS THIS PLOT BEING RENDERED
p2 <- p + geom_rect(aes(NULL, NULL, xmin=From, xmax=To),
                   ymin=yrng[1], ymax=yrng[2],
                   data=trips)

p2 # this gives an error message
# Error in eval(expr, envir, enclos) : object 'variable' not found

# ----------- THIS NOW WORKS, THANKS TO @smu, SEE BELOW
p2 <- p + geom_rect(aes(NULL, NULL, xmin=From, xmax=To, 
                   colour=NULL, group=NULL),
                   ymin=yrng[1], ymax=yrng[2],
               fill='orange',
               alpha=0.4,
               data=trips)
p2 # and I have added fill and alpha to prettify it a bit 
```

正如@tyler-rinker 所建议的那样，我已经编辑了代码以包含原始错误和@smu 指出的解决方案。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-11-19T10:22:31.003

只需添加`inherit.aes=FALSE`您的`geom_rect`实际效果会更好，因为它不会更改您对之前的图表（图例等）所做的任何设置

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-14T14:22:41.153

在第一次`ggplot`调用中，您将映射`colour`到“变量”。此映射仍然存在于`geom_rect`调用中，但在“trips”中不存在名为“variable”的变量。我建议使用以下方法取消映射颜色：

```
p2 <- p + geom_rect(aes(NULL, NULL, xmin=From, xmax=To, colour=NULL),
               ymin=yrng[1], ymax=yrng[2],
               data=trips) 
```

（没有尝试过，但我想它应该可以工作）。

# android - 如何以编程方式设置 listView 的 state_pressed 颜色

> ID：10154297
> 
> 赞同：2
> 
> 时间：2012-04-14T14:09:45.500
> 
> 标签：android, listview

我正在（尝试做）编写一个没有 xml 文件的程序（android 文档说这是可能的），但是我很难找到一些细节的信息。

当物品被中性色触摸时，我想替换丑陋的橙色。***有人知道我们如何在程序中做到这一点吗？对于没有 R.layout 表示的 ListView？***

提前感谢您的回答...

一些关于此的讨论：

> ```
>  ColorStateList c = new ColorStateList( 
>              new int[][] {
>                      new int[] { android.R.attr.state_pressed},
>                      new int[1]
>                  }, new int[] {
>                      Color.rgb(50, 50, 255),
>                      Color.BLACK,
>                  }); 
> ```

但是如何将其设置为我的列表视图？

列表视图的创建如下：

```
private class mybaseAdapter extends BaseAdapter {

    @Override
    public int getCount() {
        if (portList == null)
            return 0;
        return portList.size();
    }

    @Override
    public Object getItem(int position) {
        Log.v("getItem", portList.get(position).toString());
        return portList.get(position);
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub
        Log.v("getView", portList.get(position).toString());
        return portList.get(position);
    }
}

    ListView lv = new ListView(context);
    TableRow.LayoutParams lp = new TableRow.LayoutParams(
            LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
    lv.setAdapter(new mybaseAdapter());
    lv.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            Log.v("onItemClick", "Clicked item is");
        }
    });
    addView(lv, lp); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:29:58.253

您可以使用[StateListDrawable](http://developer.android.com/reference/android/graphics/drawable/StateListDrawable.html)创建它后，您可以将其设置为 View 的背景`v.setBackgroundDrawable(yourStateListDrawable);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:42:31.017

像这样设置 Listview 属性运行时

list.setCacheColorHint(Color.TRANSPARENT);

# socket.io - 在 socket.io 中将图像从客户端发送到服务器

> ID：10154298
> 
> 赞同：6
> 
> 时间：2012-04-14T14:09:47.717
> 
> 标签：socket.io

是否可以使用 socket.io 将图像从客户端上传到服务器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T23:51:21.537

WebSocket 规范声明 WebSockets 应该能够以 ArrayBuffer 的形式发送二进制数据，但是浏览器并不能很好地支持这一点。Socket.io 限制您发送字符串，但您可以发送 Base64 编码数据。因此，使用 canvas toDataUrl() 方法获取 base64 格式的图像，一切就绪。[这是一篇关于这个主题的好文章。](http://www.websector.de/blog/2011/12/22/pushing-binary-image-data-using-node-js-and-socket-io/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-13T00:46:04.240

我建议使用类似文件堆栈[https://www.filestack.com/](https://www.filestack.com/)客户端上的用户可以将图像上传到 s3 存储桶并在回调中接收到图像的 url。然后，您可以只将 url 发送到 socket.io。我实际上已经为我正在做的一个项目实现了这一点，表演者可以上传图像，然后与房间里的人分享。基本上，他们通过文件选择器上传它，获取 url，通过 socket.io 发送 url，然后服务器上的 socket.io 将它广播给房间里的每个人。

# rvm - 无法安装 rvm-capistrano gem

> ID：10154304
> 
> 赞同：0
> 
> 时间：2012-04-14T14:10:50.540
> 
> 标签：rvm, capistrano, rvm-capistrano

我刚刚升级到最新的 RVM (1.12.3) 并尝试安装 rvm-capistrano gem。

我已经安装了最新的`capistrano, capistrano-ext, and capistrano-colors gems`。

这是我添加到我的 Gemfile 中的行：

```
gem 'rvm-capistrano' 
```

当我这样做时，`'bundle install'`我收到以下错误：

============================================

> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/bin/rake 错误：错误：[rake --tasks] rake 中止！
> 
> 未初始化的常量 Capistrano
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/rvm-capistrano-1.0.2/lib/rvm/capistrano.rb:3:in `'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler/runtime.rb:74:in `require'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler/runtime.rb:74:in `rescue in block in require'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler/runtime.rb:62:in `block in require'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `each'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler/runtime.rb:55:in `require'
> 
> /home/larry/.rvm/gems/ruby-1.9.3-p125@stuptues/gems/bundler-1.1.3/lib/bundler.rb:119:in `require'
> 
> /home/larry/RubyMine/StupidTuesday/config/application.rb:7:in `'
> 
> /home/larry/RubyMine/StupidTuesday/Rakefile:4:in `require'
> 
> /home/larry/RubyMine/StupidTuesday/Rakefile:4:in `'
> 
> =================================================

这是新添加 `rvm-capistrano/lib/rvm/capistrano.rb`文件中的“违规”行：

> Capistrano::Configuration.instance(true).load 做

这似乎应该只是工作。有谁知道为什么不是？

谢谢，

拉里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T19:38:35.353

只需更新 rvm-capistrano gem 的版本：

```
bundle update rvm-capistrano 
```

此问题已报告并已修复。

# java - Java：检查数组的相等性（顺序无关紧要）

> ID：10154305
> 
> 赞同：26
> 
> 时间：2012-04-14T14:11:05.750
> 
> 标签：java, arrays, string

我有两个`String`数组，比方说：

```
String[] s1 = {"a","b","c"}
String[] s2 = {"c","a","b"} 
```

//这些数组应该相等

我想以“最干净”的方式检查它们的平等性。

我尝试使用`Arrays.equals(s1,s2)`但我得到一个错误的答案。我想这种方法关心元素的顺序，我不希望这很重要。

你能告诉我如何以一种好的方式做到这一点吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-14T14:25:22.993

*   Arrays.sort(s1);
*   Arrays.sort(s2);
*   Arrays.equals(s1,s2);

如果您不想修改原始数组

```
 Arrays.equals( Arrays.sort( Arrays.copyof(s1,s1.length)),
                Arrays.sort( Arrays.copyof(s2,s2.length)) ); 
```

Arrays.sort() 使用优化的快速排序，平均为 nlog(n)，但在最坏的情况下为 O(n2)。来自 java 文档。所以最坏的情况是 O(n2)，但实际上大多数情况下是 O(nlogn)。

> 排序算法是经过调整的快速排序，改编自 Jon L. Bentley 和 M. Douglas McIlroy 的“Engineering a Sort Function”，Software-Practice and Experience，Vol。23(11) P. 1249-1265（1993 年 11 月）。该算法在许多数据集上提供 n*log(n) 性能，导致其他快速排序降低到二次性能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-14T14:31:12.113

其他人建议对数组进行排序。但是由于您正在寻找“最干净”的解决方案，我认为不应触及原始数组。因此：

```
List<String> l1 = new ArrayList<String>(Arrays.asList(s1));
List<String> l2 = new ArrayList<String>(Arrays.asList(s2));

Collections.sort(l1);
Collections.sort(l2);

boolean outcome = l1.equals(l2); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-06T15:44:35.003

如果您使用的是[Eclipse Collections](https://www.eclipse.org/collections/)，则可以使用 a[`Bag`](https://www.eclipse.org/collections/javadoc/10.0.0/org/eclipse/collections/api/bag/Bag.html)来确定两个数组是否相等。

```
String[] s1 = {"a", "b", "c", "c"};
String[] s2 = {"c", "a", "b", "c"};

Bag<String> h1 = Bags.mutable.with(s1);
Bag<String> h2 = Bags.mutable.with(s2);
Assert.assertEquals(h1, h2); 
```

如果袋子（也称为多重集）每个元素的出现次数相同，则认为它们是相等的。顺序无关紧要，它可以正确处理重复元素。使用由哈希表支持的包的优点是创建一个包需要线性时间。对两者进行排序都需要 O(n log n)。

注意：我是 Eclipse Collections 的提交者

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-14T14:35:52.290

人道方式：

遍历第一个数组，检查第二个数组中的每个元素是否存在，然后对第一个数组上的第二个数组执行相同的操作。时间：n^2。请注意，此方法假定没有元素重复。如果是这样，您将不得不，对于您要检查的每个元素，回到开头并计算该元素有多少个实例（例如 X），并且仅将成功视为在第二个数组。这样做将消除第二次检查的需要，并将作为练习留给读者（如果你愿意的话，那就是。）

```
boolean equal(String[] arr1, String[] arr2) {
    if(arr1.length != arr2.length) return false; // obviously
    main_loop:
    for(int i = 0; i < arr1.length; i++) {
        for(int j = 0; j < arr2.length; j++) {
            if(arr1[i].equals(arr2[j]))
                break main_loop;
        }
        return false;
    }
    main_loop:
    for(int i = 0; i < arr2.length; i++) {
        for(int j = 0; j < arr1.length; j++) {
            if(arr2[i].equals(arr1[j]))
                break main_loop;
        }
        return false;
    }
    // having got through both loops, we can now return true
} 
```

一种更高级的方法：对两个数组进行排序并遍历它们。时间：n lg n

```
boolean equals(String[] arr1, String[] arr2) {
    if(arr1.length != arr2.length) return false;
    String[] copy1 = Arrays.copyOf(arr1,arr1.length); // java.util.Arrays
    String[] copy2 = Arrays.copyOf(arr2,arr2.length); // java.util.Arrays
    Arrays.sort(copy1);
    Arrays.sort(copy2);
    for(int i = 0; i < copy1.length; i++) {
        if(!copy1[i].equals(copy2[i])
            return false;
    }
    return true;
} 
```

一种更高级的方法：使用 hashmap，添加第一个字符串数组的计数，删除第二个字符串数组的计数。当你很高兴时，所有计数都应该为零。

```
boolean equal(String[] arr1, String[] arr2) {
    if(arr1.length != arr2.length) return false;
    Map<String, Integer> map1 = new HashMap<String,Integer>();
    for(String str : arr1) {
        if(!map.containsKey(str)) {
            map.put(str, 1);
        } else {
            map.put(str, map.get(str) + 1); // add to count inthe map
        }
    }
    for(String str : arr1) {
        if(!map.containsKey(str)) {
            return false; // we have an element in arr2 not in arr1 - leave now
        } else {
            map.put(str, map.get(str) - 1); // remove to count inthe map
        }
    }
    for(Integer count : map.values()) {
        if(count.intValue() != 0) return false;
    }
    return true;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-14T14:27:00.027

```
String[] s1 = {"a","b","c"};
String[] s2 = {"b","c","a"} ;

Arrays.sort(s1);
Arrays.sort(s2);

    if(Arrays.equals(s1, s2)){
        System.out.println("ok");
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-07T17:59:31.080

# `Set::equals`

注意：这是一个简单的非侵入式解决方案，但只有在您确定输入数组/列表中没有重复条目（或者您想忽略重复项）时才有效。

您不需要任何外部库。 [`Set<>`](https://docs.oracle.com/javase/8/docs/api/java/util/Set.html)已经有一种[`equals`](https://docs.oracle.com/javase/8/docs/api/java/util/Set.html#equals-java.lang.Object-)方法可以进行与顺序无关的比较。

```
public static <T> boolean areArraysEquivalent(T[] ary1, T[] ary2) {
    if (ary1 == null) {
        return ary2 == null;
    }

    if (ary2 == null) {
        return false;
    }

    List<T> list1 = Arrays.asList(ary1);
    List<T> list2 = Arrays.asList(ary2);
    return areListsEquivalent(list1, list2);
}

public static <T> boolean areListsEquivalent(List<T> list1, List<T> list2) {
    if (list1 == null) {
        return list2 == null;
    }

    if (list2 == null) {
        return false;
    }

    Set<T> set1 = new HashSet<>(list1);
    Set<T> set2 = new HashSet<>(list2);
    return set1.equals(set2);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-15T11:03:39.647

我会先对 2 个数组进行排序，然后逐行比较...

```
public boolean areArraysEqual (String[] array1,String[] array2){    
    if (s1.length != s2.length){
        return false;
        }

    java.util.Arrays.sort(s1);
    java.util.Arrays.sort(s2);

    for (int i=0;i<s1.length;i++){
        if (! s1[i].equals(s2[i])){
            return false;
        }
    }

return true;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-14T14:23:29.620

我想这是给学校的。

可能的策略：

*   使用 Arrays.sort 对两个数组进行排序，然后使用循环将 s1[i] 与 s2[i] 进行比较
*   使用循环，并为 s1 的每个项目查看 s2 的项目以查找它是否包含相同的
*   将 s1 的项目放入哈希集中，然后在 s2 上使用循环并查看您的项目是否在 s1

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-23T00:08:58.047

如果人们经常想要在不修改其内容的情况下将数组相互比较，那么定义一种封装不可变数组的类型、其排序版本、`long`保证唯一且至少大部分与对象相关的序列计数可能会有所帮助年龄，以及对另一个已知匹配的旧对象的初始空引用。缓存一个组合了所有数组元素的哈希值的哈希值也可能会有所帮助。

使用这种方法，第一次将对象与其他东西（任何东西）进行比较时需要进行排序，但在那之后就不需要了。此外，如果发现对象 X 和 Y 都等于 Z，则 X 和 Y 之间的比较可以报告它们相等，而不必实际检查数组内容（如果 Z 比 X 和 Y 旧，则两者都将报告自己相等到同一个较老的对象；如果 X 是最年轻的，Y 是最老的，X 会知道它等于 Z，Z 会知道它等于 Y。当 X 下次与某物进行比较时，它会发现它已知的最旧的东西等于是Y，所以它当然等于Y。

这种方法将产生类似于实习的平等比较性能优势，但不需要实习字典。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-13T02:05:20.720

对于小型阵列，我会使用`Arrays.sort`和`Arrays.equals`其他人建议的那样。对于较大的数组，您可以使用以下具有更好时间复杂度的解决方案 -`O(n)`而不是`O(n log n)`.

```
public static boolean haveSameElements(Object[] arr1, Object[] arr2) {
    return arr1.length == arr2.length && counts(arr1).equals(counts(arr2));
}

// Map.merge and method references require Java 8
private static <T> Map<T, Integer> counts(T[] arr) {
    Map<T, Integer> map = new HashMap<>();
    for (T t : arr)
        map.merge(t, 1, Integer::sum);
    return map;
} 
```

# php - Codeigniter $this->lang->line(errors) 没有用于 tank auth 错误消息的段落标签

> ID：10154308
> 
> 赞同：3
> 
> 时间：2012-04-14T14:11:23.037
> 
> 标签：php, codeigniter, tankauth

我想知道是否有人可以帮助我解决这个问题。我目前正在尝试将 tank auth 集成到我的 codeigniter 站点中。我正在慢慢到达那里，但遇到了一个小绊脚石，因为当我将错误消息从显示为 html 视图的一部分移动到 javascript 警报时，它们仍在打印出错误消息周围的段落标签。

我认为作为数组/或多维数组传递给我的登录表单的错误消息是由以下代码行在控制器中生成的：

```
$data['errors'] = array();
foreach ($errors as $k => $v)   $data['errors'][$k] = $this->lang->line($v); 
```

这是我显示错误消息的代码：

```
if ((isset($errors[$login['name']]))||(isset($errors[$password['name']]))||(form_error($login['name']))||(form_error($password['name']))){
        echo'<script type="text/javascript">alert("';
}
echo form_error($login['name']);
echo isset($errors[$login['name']])?$errors[$login['name']]:'';
echo form_error($password['name']); 
echo isset($errors[$password['name']])?$errors[$password['name']]:'';
if ((isset($errors[$login['name']]))||(isset($errors[$password['name']]))||(form_error($login['name']))||(form_error($password['name']))){
        echo'")</script>';
} 
```

现在我的主要问题是如何删除 paragreaph 标签，并且我在 codeigniter 文档中找到了一个线索： [http](http://codeigniter.com/user_guide/libraries/file_uploading.html) ://codeigniter.com/user_guide/libraries/file_uploading.html 他们这里的关键部分是它说你可以设置通过执行以下操作，上传脚本上的错误的分隔符：

```
$this->upload->display_errors('<p>', '</p>'); 
```

但我不知道如何以及在何处将其应用于坦克身份验证。

我还有第二个问题，我会感谢任何可以回答的人，我对显示错误消息的代码有点困惑。例如：

```
echo form_error($password['name']) 
```

有人可以向我解释一下吗，它一开始没有 $ 所以不是变量所以它是怎么回事，我真正想要了解的是如何简化我检查错误消息的逻辑，因为它目前非常冗长，并且有很多错误消息需要处理。

我很感激这里有很多事情要处理，但任何帮助/解释都将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-14T14:41:20.273

要删除包装错误消息的标签，您必须`set_error_delimiters()`使用 2 个空字符串作为参数调用表单验证对象的方法。

```
$this->form_validation->set_error_delimiters('', ''); 
```

有关此的更多信息：[https ://codeigniter.com/user_guide/libraries/form_validation.html#chang-the-error-delimiters](https://codeigniter.com/user_guide/libraries/form_validation.html#changing-the-error-delimiters)

至于你的第二个问题，我不确定你实际上在问什么。它只是一个函数调用，调用的返回值将输出给用户。

# android - Android：在待机期间保持 GPS 处于活动状态？

> ID：10154317
> 
> 赞同：1
> 
> 时间：2012-04-14T14:12:50.223
> 
> 标签：android, gps, wakelock

我有一个创建唤醒锁的服务：

```
pm = (PowerManager) getSystemService(POWER_SERVICE);
flags=PowerManager.PARTIAL_WAKE_LOCK; 
wl = pm.newWakeLock(flags,"myApp");
wl.acquire(); 
```

接下来我通过 LocationManager.GPS_PROVIDER 请求位置更新。这工作正常，直到设备进入 PARTIAL_WAKE_LOCK-sleep，这里 GPS 位置消失。所以我的问题是：我如何让 GPS 在这种待机状态下保持活力？设置 SCREEN_DIM_WAKE_LOCK 会起作用，但不是一个选项，因为它需要太多的功率。

埃尔米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T11:06:44.520

同时我发现：它似乎取决于设备或操作系统版本。

对于我的摩托罗拉 Xoom 2 / Android 3.2，可以关闭整个屏幕，包括 GPS 在内的系统通过部分唤醒锁定保持活动状态。

对于似乎停止 GPS 的其他一些设备（由我的应用程序的用户报告），它们最多可以使屏幕变暗以使其保持活动状态。

# css - CSS 格式问题

> ID：10154319
> 
> 赞同：0
> 
> 时间：2012-04-14T14:23:04.783
> 
> 标签：css

我一直在创建一个基于 iWebKit 5 oding 的移动网站，我一直在使用他们的 css 样式表并且一切正常，但是 css 的格式都在一行上，这显然使它令人困惑并且几乎无法阅读，所以我想格式化它。我尝试了许多在线格式化程序，但他们以某种方式压缩代码并将其搞砸，或者他们重新排列它并最终无法正常工作。我也遇到了某些格式化程序删除他们认为“坏属性”的问题，这些属性实际上是 iDevice 特定的样式。

所以我的问题是，有没有什么/有人可以帮助我将我的代码重新排列成一个可读但明显有效的 css 样式表？

这是样式表的链接：

[http://pastebin.com/czuuaPyn](http://pastebin.com/czuuaPyn)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:29:52.120

我几乎不需要反过来这样做，但是当确实出现这种情况时，我会使用诸如[http://cssbeautify.com/](http://cssbeautify.com/)之类的在线工具。这对于“解开” css 非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T14:32:12.683

快速而肮脏的解决方案：

*   在任何具有搜索+替换的编辑器中打开文件
*   替换`{`为`{\n\t`
*   替换`;`为`;\n\t`
*   替换`}`为`\n}\n`
*   整理任何违规行为（特别是评论，可能是媒体查询）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T14:36:16.150

这应该这样做：

[http://pastebin.com/CmXhA87P](http://pastebin.com/CmXhA87P)

在没有启用任何过滤器或修饰符的情况下通过[Codebeautifier 运行它。](http://www.codebeautifier.com/)

# html - 无法读取已保存的 html 页面

> ID：10154320
> 
> 赞同：0
> 
> 时间：2012-04-14T14:23:20.423
> 
> 标签：html, apache, osx-snow-leopard

如果我保存这样一个 html 页面：

```
<html>
  <body>
    <h1>
      Lista immagini:
    </h1>
    <img src="http://imageshack.us/photos/immagine/399/scalauominifl0.jpg" width="200" height="300" />
    <p>Fine</p>
  </body>
</html> 
```

并且我给了.html扩展名（字符编码UNICODE UTF-8），下次我用文本编辑打开它时，我没有看到源代码，但我看到了网页。如何查看和编辑源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:13:03.337

我推荐 Sublime Text 2 作为文本编辑器。

# oz - Oz 中的端口和单元

> ID：10154322
> 
> 赞同：2
> 
> 时间：2012-04-14T14:23:23.770
> 
> 标签：oz

我现在正在大学里自学课程，并注意到我咬得比我能咀嚼的多一点。该课程是关于 Oz 编程语言的，我正在阅读一本关于它的电子书以尝试更好地了解它，并且我正在尝试解决一些练习来测试我的理解。我很卡在某个练习上，我不太知道如何解决它。问题是：

> 实施端口。在第 5 章中我们介绍了端口的概念，它是一个简单的通信通道。端口有操作 {NewPort SP}，它返回一个带有流 S 的端口 P，和 {Send PX}，它在端口 P 上发送消息 X。从这些操作中，很明显端口是一个有状态的非捆绑 ADT。在本练习中，使用第 6.4 节的技术根据单元实现端口。

关键词是 stateful unbundled 和 cell。我尝试通过以下方法使用单元来实现端口的行为：

```
declare
MyPort
MyStream
proc {NewPortEx ?S ?P}
   P = {NewCell nil}
   S = !!P  %read only view on the cell
end
proc {SendEx P X}
   P:=X|@P  %extend the cell's content, a list, with X
end
in
{NewPortEx MyStream MyPort}
{Browse @MyStream}
{SendEx MyPort c}
{Browse @MyStream} 
```

我的最后一步是添加一个包装器/解包器对以确保 ADT 安全，但首先我希望该功能能够正常工作。这似乎是正确的行为，但这不是我想要的。我希望能够在`{Browse MyStream}`没有 , 的情况下调用`@`一次。我希望浏览器会显示一些内容，`firstSent|secondSent|_<future>`而不是`<Cell>`按预期显示，我需要`Browse`在每个 之后调用它`Send`，并且输出显示为 list: `[firstSent secondSent]`。

如果我从我读过的理论中没记错的话，这与急切与懒惰的评估有关，分别导致（有限）列表与（无限）流。

我觉得我做得不太对，而且我对函数式语言没有任何经验，谁能帮我做一个用单元实现的端口的例子？（基本上你自己实现现有的`NewPort`and `Send`）

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T22:57:21.647

流只是一个带有未绑定尾部的列表。例如，最初列表只是一个未绑定的变量_。每当发送一个元素时，尾部都会绑定到一个新对，例如：

```
(1) Initially:          S = _
(2) Send 1 to the port: S = 1|_
(3) Send 2 to the port: S = 1|2|_
etc. 
```

除非您关闭端口，否则尾部始终保持未绑定。

现在，您将单元格用作指向列表末尾的指针。最初，该单元格仅指向 S。然后，SendEx 操作包括以下步骤：

```
(1) Read the current tail from the cell.
(2) Declare a new unbound variable that will serve as the new tail.
(3) Unify: current tail = X | new tail
(4) Store the new tail in the cell. 
```

希望这可以帮助。

# java - JDT 索引格式信息

> ID：10154325
> 
> 赞同：0
> 
> 时间：2012-04-14T14:23:31.700
> 
> 标签：java, eclipse, search, indexing, eclipse-jdt

我正在寻找有关 JDT 索引的信息。例如格式是什么，数据的结构如何（文档？字段？）。关于该主题的信息似乎很少。[这个问题](https://stackoverflow.com/questions/3898185/how-would-you-access-eclipse-jdt-index)的答案还没有帮助。[在这里](http://www.eclipse.org/forums/index.php/mv/tree/63389/#page_top)，我找到了寻找 JavaSearchPattern 层次结构的提示，但它很难理解。我想知道是否有更好的信息来源。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T14:55:35.557

有关快速概述，请参阅线程[http://www.eclipse.org/forums/index.php/m/849875/](http://www.eclipse.org/forums/index.php/m/849875/)

# algorithm - 生成“自己的”斐波那契数列

> ID：10154328
> 
> 赞同：6
> 
> 时间：2012-04-14T14:24:24.927
> 
> 标签：algorithm, fibonacci

我有一个不寻常的（我认为）问题。对于给定的数字 F_n（我不知道 n 的值），我必须找到数字 F_0、F_1 使得 F_{n}=F_{n-1}+F_{n-2}。另一个困难是这个序列应该尽可能长（F_n 的值 n 应该是最高的），如果存在多个解决方案，我必须用最小的 F_0 来解决这个问题。简而言之，我必须生成我“自己的”斐波那契数列。一些例子：

在：F_n = 10；出：F_0 = 0；F_1 = 2;

在：F_n = 17；出：F_0 = 1；F_1 = 5；

在：F_n = 4181；出：F_0 = 0；F_1 = 1；

我对每个序列（使用“斐​​波那契规则”）观察到的 F_n 有：

F_n = Fib_n * F_1 + Fib_{n-1} * F_0

其中 Fib_n 是第 n 个斐波那契数。对于斐波那契数列尤其如此。但我不知道这个观察是否值得。我们不知道 n，我们的任务是找到 F_1、F_0，所以我认为我们一无所获。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T16:41:13.657

~~F [n-1] = 圆形(F [n] /φ)~~

其中 φ=(√5+1)/2。

~~证明留给读者练习;^P~~

**更新**这是不正确的，回到绘图板。

**更新 2让我们从 F** [n]和 F [n-1]向后计算。

F [n-2] = F [n] - F [n-1]
F [n-3] = F [n-1] - F [n-2] = F [n-1] - (F [n] - F [n-1] ) = 2F [n-1] - F [n]
F [n-4] = F [n-2] - F [n-3] = (F [n] - F [n-1] ) - (2F [n-1] - F [n] ) = 2F [n] - 3F [n-1]
F [n-5] = F [n-3] - F [n-4] = (2F [n-1] - F [n] ) - (2F [n]- 3F [n-1] ) = 5F [n-1] - 3F [n]
F [n-6] = F [n-4] - F [n-5] = (2F [n] - 3F [n-1] ) - (5F [n-1] - 3F [n] ) = 5F [n] - 8F [n-1]

注意到图案了吗？很容易从*真实的*斐波那契数列和最后两个成员中计算出该序列的任何成员。但是我们只知道最后一个成员，我们怎么知道最后一个呢？

[让我们用 F n-1]写下要求 F [i] >0 。

F [n-2] = F [n] - F [n-1] > 0 ⇒ F [n-1] < F [n]
F [n-3] = 2F [n-1] - F [n] > 0 ⇒ F [n-1] > F [n] /2
F [n-4] = 2F [n] - 3F [n-1] ⇒ F [n-1] < 2F [n] /3
F [n-5] = 5F [n-1] - 3F [n] ⇒ F [n-1] > 3F [n] /5

所以我们在 F [n-1]上有一系列用真实斐波那契数列书写的界限，每一个都比前一个更紧。仍然可满足的最后一个界限确定了对应于最长序列的F [n-1 。]如果有多个数满足最后一个界限，则使用最小或最大的一个，具体取决于序列的长度是偶数还是奇数。

例如，如果 F [n] =101，则
101*5/8 < F [n-1] < 101*8/13 ⇒ F [n-1] = 63

先前的（不正确的）解决方案将暗示 F [n-1] = 62，这是接近但没有雪茄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T14:52:26.230

你的方程式

```
F_n = Fib_n * F_1 + Fib_{n-1} * F_0 
```

是一个有两个变量和的[线性丢番图方程](http://mathworld.wolfram.com/DiophantineEquation.html) 。该链接提供了一种有效的算法来计算解决方案集的描述，该算法允许您找到具有和和最小值的解决方案（如果存在）。然后，您可以尝试猜测，直到发现没有解决方案。这种方法是多项式的。`F_1``F_0``F_1 >= 0``F_0 >= 0``F_0``n = 0, 1, ...``log(F_n)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T14:54:12.707

> F_n = Fib_n * F_1 + Fib_{n-1} * F_0
> 
> 其中 Fib_n 是第 n 个斐波那契数。对于斐波那契数列尤其如此。但我不知道这个观察是否值得。我们不知道 n，我们的任务是找到 F_1、F_0，所以我认为我们一无所获。

好吧，您正在寻找最长的序列，这意味着您想要最大化`n`.

为斐波那契数创建一个查找表。从最大的`n`这样开始`Fib_n <= F_n`，表中的前一个条目是`fib_n{n-1}`。现在唯一的变量是`F_1`和`F_0`。求解[线性丢番图方程](http://en.wikipedia.org/wiki/Diophantine_equation#Linear_Diophantine_equations)。如果它有解决方案，你就完成了。如果不是，则减`n`1 并重试，直到找到解决方案。

注意：解决方案总是存在的，因为`F_2 = 1 * F_1 + 0 * F_0`有解决方案`F_2 = F_1`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T14:31:46.693

我不确定你在找什么。您提到的递归系列定义为：

```
Fn = F{n-1} + F{n-2} 
```

显然，如果凝视值可以是任何值，我们可以任意选择`F{n-1}`，这将给出`F{n-2} ( = Fn=F{n-1})`。知道了`F{n-1} = F{n-2} + F{n-3}`，`F{n-3}`就可以计算出`F{n-1} and F{n-2}`。这意味着您可以将数字追溯到无穷大，因此没有“最长”序列并且有无限多个有效序列。

`F{n}`在某种程度上，您正在计算具有初始值和`F{n-1}`where的逆斐波那契数列`F{i} = F{i+2}-F{i+1}`，`i`永远递减

更新：如果您希望将解决方案空间限制为所有`F{i}`都是非负整数的结果，您将只能获得少数（大多数情况下是单例）解决方案。

如果你计算原始斐波那契数（`Fib{i}`），很快你就会得到`F{n} < Fib{i-1}`；显然你不需要更进一步。然后，您可以尝试所有可能的 and 组合，`F{0}`这样`F{1}`-`F{n} <= Fib{i} * F{1}+ Fib{i-1} * F{0}`只有有限数量的非负`F{0}`and的可能性`F{1}`（您显然可以排除`F{0}=F{1}=0`）。然后看看哪些`i`（s）在满足平等的那些（s）中是最高的——你也`F{0}`得到`F{1}`了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-07T01:16:36.963

Mimic the computation of Fibonacci numbers with a matrix (but with different initial values). [[0 1] [1 1]] to power k will yield [F_{n+k}, F_{n+1+k}] when multiplied by [F_{n}, F_{n+1}].

Since raising of a matrix to a power is an O(log n) (assuming multiplications of integers is O(1)), you can perform the whole calculation in O(log n) time until matrix coefficients start to dominate the computation.

I don't know how large the numbers with which you are working happen to be, but the nth power of this matrix is [[F_{n-1} F_n] [F_n F_{n+1}]]. And log(F_n) ~ n/5 (so the billionth Fibonacci number will have roughly 200 million digits).

# ruby-on-rails - Lion Server、Profilemanager、RVM 和 Rails 不能一起工作

> ID：10154336
> 
> 赞同：3
> 
> 时间：2012-04-14T14:26:07.403
> 
> 标签：ruby-on-rails, osx-lion, rvm, mdm, osx-server

狮子服务器是荒谬的。在 Mac 上，我运行了 Lion Server 10.7.3 的安装和设置，然后安装了 rvm、Ruby 1.9.3 和 Rails 3.2.3。

在 Mac 上它工作得很好，而在第二个 Mac 上不工作，我进入了 log devicemgr：

```
<Info>: default_profile_created_at_least_once was already true
Apr 10 20:23:26 <Name of Server> ProfileManager[1117] <Warning>: ** has_many_polymorphs: Warning; not all usage scenarios for polymorphic scopes are supported yet. 
```

在系统日志中，守护进程 devicemgr 总是重复：

```
<Date, Time and Nome Server>.devicemanager[1634]: DEBUG: Initializing DeviceManagerDaemon with ports 3320,3321,3322,3323,3324,3325,3326,3327,3328,3329 (physmem = 8GB)
<Date, Time and Nome Server>.devicemanager[1634]: DEBUG: Making sure Rails is configured properly
<Date, Time and Nome Server>.devicemanager[1634]: DEBUG: Running rake command: /usr/bin/rake db:migrate
<Date, Time and Nome Server>.devicemanager[1634]: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:777:in `report_activate_error': Could not find RubyGem rake (>= 0) (Gem::LoadError)
<Date, Time and Nome Server>.devicemanager[1634]:   from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:211:in `activate'
<Date, Time and Nome Server>.devicemanager[1634]:   from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:1056:in `gem'
<Date, Time and Nome Server>.devicemanager[1634]:   from /usr/bin/rake:18
<Date, Time and Nome Server>.devicemanager[1634]: /usr/share/devicemgr/backend/devicemgrd:109:in `rake': Rake command failed with 256 (RuntimeError)
<Date, Time and Nome Server>.devicemanager[1634]:   from /usr/share/devicemgr/backend/devicemgrd:103:in `setupRails'
<Date, Time and Nome Server>.devicemanager[1634]:   from /usr/share/devicemgr/backend/devicemgrd:33:in `run'
<Date, Time and Nome Server>.devicemanager[1634]:   from /usr/share/devicemgr/backend/devicemgrd:131
Apr 12 23:02:05 apple com.apple.launchd[1] (com.apple.devicemanager[1634]): Exited with code: 1
Apr 12 23:02:05 apple com.apple.launchd[1] (com.apple.devicemanager): Throttling respawn: Will start in 10 seconds
Apr 12 23:02:07 apple xgrid[1637]: gss_init_sec_context is called on main thread, its a blocking api
Apr 12 23:02:12 apple xgrid[1641]: gss_init_sec_context is called on main thread, its a blocking api 
```

我该如何解决？如果您想避免重新安装所有内容。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T13:25:43.830

我最近从 Snow Leopard Server 升级到 Lion Server，不幸的是，Apple 在[这篇](http://support.apple.com/kb/TS4042?locale=en)文章中说，你试图完成的情况是不可能的 :( 并且恢复拥有一个正常运行的配置文件管理器服务器几乎但不可能重建服务器的例外。

希望能解决一些问题。

-编辑：

通过卸载和删除所有安装了 ruby​​ 更新的新 gem，我设法让 wiki 服务器重新启动并运行。但是**，如果您需要配置文件管理器或 wiki 服务，请不要更新 gems，这一点非常重要，**否则我相信其他一切都应该工作。

肖恩

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T07:30:28.750

我认为（我有类似的问题）他做了这些步骤：

*   在profilemanager之类的服务器上有一些服务
*   在系统中安装 RVM。
*   安装最新版本的 Rails。

在这些 ProfileManager 之后，我想，其他服务也会停止运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T09:11:00.030

添加此信息，我的 GEM ENV 为：

```
RubyGems Environment:
- RUBYGEMS VERSION: 1.8.21
- RUBY VERSION: 1.9.3 (2012-02-16 patchlevel 125) [x86_64-darwin11.3.0]
- INSTALLATION DIRECTORY: /Users/ladmin/.rvm/gems/ruby-1.9.3-p125
- RUBY EXECUTABLE: /Users/ladmin/.rvm/rubies/ruby-1.9.3-p125/bin/ruby
- EXECUTABLE DIRECTORY: /Users/ladmin/.rvm/gems/ruby-1.9.3-p125/bin
- RUBYGEMS PLATFORMS:
  - ruby
  - x86_64-darwin-11
- GEM PATHS:
   - /Users/ladmin/.rvm/gems/ruby-1.9.3-p125
   - /Users/ladmin/.rvm/gems/ruby-1.9.3-p125@global
- GEM CONFIGURATION:
   - :update_sources => true
   - :verbose => true
   - :benchmark => false
   - :backtrace => false
   - :bulk_threshold => 1000
- REMOTE SOURCES:
   - http://rubygems.org/ 
```

配置文件管理器不起作用。

# checkbox - knockoutjs 复选框属性值不变

> ID：10154339
> 
> 赞同：1
> 
> 时间：2012-04-14T14:26:59.237
> 
> 标签：checkbox, knockout.js

谁能告诉我为什么单击复选框时，复选框没有被选中？

简单的代码在这里：http: [//jsfiddle.net/VTvYG/5/](http://jsfiddle.net/VTvYG/5/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:33:48.563

Observables 是函数，所以你应该改变

```
self.Selected = config; 
```

到

```
self.Selected(config); 
```

对于复选框，更改

```
<input type="checkbox" /> 
```

到

```
<input type="checkbox" data-bind="checked: AmISelected" /> 
```

# java - Java SQL：结果集之前的错误

> ID：10154341
> 
> 赞同：1
> 
> 时间：2012-04-14T14:27:27.067
> 
> 标签：java, sql, resultset

我的 java 应用程序中的查询有问题。这是一个简单的查询，可以根据用户的姓名获得用户得分，但是，我经常收到错误消息，无法确定问题出在哪里。

```
 String driver = "com.mysql.jdbc.Driver";    
        Class.forName(driver).newInstance();

        con = DriverManager.getConnection(url, USERNAME, PASSWORD);   
        st  = con.createStatement();

        PreparedStatement preStatement = con.prepareStatement("select score from playerscore where name=?");
        preStatement.setString(1, "tomcat");

        ResultSet resultSet = preStatement.executeQuery();
        score               = resultSet.getInt(1); 
```

有人可以睁一只眼闭一只眼，为我指明正确的方向吗？

编辑：堆栈跟踪的图像

[http://imageshack.us/photo/my-images/854/stackr.jpg/](http://imageshack.us/photo/my-images/854/stackr.jpg/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T14:39:00.253

最初，`ResultSet`位于第一行*之前。*因此，您必须先调用`resultSet.next()`移动到第一行，然后才能检索其任何值。

`boolean`您可以通过检查返回的来验证第一行是否确实存在`resultSet.next()`。

# python - 将对象添加到会话时，SQLAlchemy 是否保存顺序？

> ID：10154343
> 
> 赞同：18
> 
> 时间：2012-04-14T14:28:05.800
> 
> 标签：python, database, orm, sqlalchemy

这个断言是否总是通过？换句话说，当向会话添加新对象时，SQLAlchemy 是否保存顺序（在生成 INSERT 查询时）？

```
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm.session import sessionmaker
from sqlalchemy.engine import create_engine
from sqlalchemy.types import Integer
from sqlalchemy.schema import Column

engine = create_engine('sqlite://')
Base = declarative_base(engine)
Session = sessionmaker(bind=engine)
session = Session()

class Entity(Base):
    __tablename__ = 'entity'
    id = Column(Integer(), primary_key=True)
Entity.__table__.create(checkfirst=True)

first = Entity()
session.add(first)

second = Entity()
session.add(second)

session.commit()
assert second.id > first.id
print(first.id, second.id) 
```

没有，在生产中我使用的是 postgresql，sqlite 用于测试。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-11-14T23:42:36.657

在查看了一下 SQLAlchemy 源代码后，它看起来像`add()`插入时的记录：[https ://github.com/zzzeek/sqlalchemy/blob/master/lib/sqlalchemy/orm/session.py#L1719](https://github.com/zzzeek/sqlalchemy/blob/master/lib/sqlalchemy/orm/session.py#L1719)

相关片段：

```
def _save_impl(self, state):
    if state.key is not None:
        raise sa_exc.InvalidRequestError(
            "Object '%s' already has an identity - it can't be registered "
            "as pending" % state_str(state))

    self._before_attach(state)
    if state not in self._new:
        self._new[state] = state.obj()
        state.insert_order = len(self._new) # THE INSERT ORDER IS SAVED!
    self._attach(state) 
```

这是从`Session.add`=> `self._save_or_update_state`=> `self._save_or_update_impl`=>调用的`self._save_impl`。

然后在`_sort_states`保存时使用它：[https ://github.com/zzzeek/sqlalchemy/blob/master/lib/sqlalchemy/orm/persistence.py#L859](https://github.com/zzzeek/sqlalchemy/blob/master/lib/sqlalchemy/orm/persistence.py#L859)

不幸的是，这只是实现级别的证明。我在文档中找不到任何保证它的东西......

**更新**：我已经对此进行了更多研究，结果发现 SQLAlchemy 中有一个称为*工作单元的*概念，它在一定程度上定义了刷新期间的顺序：[http](http://www.aosabook.org/en/sqlalchemy.html) ://www.aosabook.org/en/sqlalchemy.html （搜索工作单元）。

在同一个类中，顺序确实由`add`调用的顺序决定。但是，您可能会在不同类之间的 INSERT 中看到不同的排序。如果您添加`a`类型的对象，`A`然后添加`b`类型的对象`B`，但`a`结果是有一个外键`b`，您将在 INSERT for`b`之前看到一个 INSERT for `a`。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-04-14T14:36:26.727

不，它在您提交时执行，而不是在您添加时执行。

# javascript - Apex 中的 JavaScript：单击弹出窗口按钮后执行过程的弹出窗口

> ID：10154344
> 
> 赞同：0
> 
> 时间：2012-04-14T14:28:06.490
> 
> 标签：javascript, triggers, oracle-apex, procedure

我正在使用 Oracle ApEx 开发一个资源调度器，用户可以在其中预留资源。如果已预留资源，则用户可以选择暂停资源或取消预留。目前。我正在使用触发器来检查资源的状态并进行相应的更新。

这是我想知道的：

单击“保留”按钮后，如果资源已被保留，我想从该按钮使用 Javascript 调用一个弹出窗口，该窗口将询问用户是否要暂停该资源。通过在弹出窗口中单击“是”，系统将继续为用户保留资源。

如何才能做到这一点？

# c++ - 最佳操作系统可移植线程池库

> ID：10154345
> 
> 赞同：0
> 
> 时间：2012-04-14T14:28:12.880
> 
> 标签：c++, multithreading, pooling

我正在为 POSIX 兼容系统和 Windows(R) 开发一个 C++ 程序，并且想知道：

1.  什么是最好的操作系统可移植线程池库？还是我应该自己做？
2.  汇集比物理处理器内核更多的胎面有什么意义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:32:30.560

1.  新的 C++11 标准支持线程，所以如果你的编译器支持它，你应该更喜欢它。否则，会有[Boost.Thread](http://www.boost.org/doc/libs/1_49_0/doc/html/thread.html)。这些不是线程池库，但您可以在它们之上构建一个线程池。
2.  取决于你试图解决什么问题。如果你想并行运行*n 个*任务，你必须启动*n 个*线程，无论你有多少个处理器内核（多线程在处理器增长多个内核之前很流行，通常数百个线程已经在并行运行，所以更多没那么重要）。另一方面，线程创建成本很高，因此您不应该为每个短期后台线程创建一个新线程。在 C++11 中，您可以将期货用于此类后台任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:12:48.123

[dlib](http://dlib.net)中有一个线程池工具，它允许您指定机器上的处理核心数，然后将作业提交到线程池。因此，如果您正在寻找可以轻松有效地使用多核 CPU 的东西，那么 dlib::thread_pool 会非常有用。

还有一个[示例程序](http://dlib.net/thread_pool_ex.cpp.html)展示了如何使用各种方法（包括 C++11 lambda 函数）将作业提交到池中。另一个好处是没有安装过程，你可以下载 dlib 和这个示例程序并编译它。您无需安装或配置任何东西。它只能在您提到的任何一个平台上运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T14:39:58.130

1.  如果可能的话，最好的办法是使用抽象线程的库，而是专注于任务，例如 Intel [TBB](http://en.wikipedia.org/wiki/Intel_Threading_Building_Blocks) / Microsoft PPL。`parallel_for`他们还提供了易于使用且功能强大的并行算法。它们还提供了解决许多其他不同问题的可能性，比如减少操作、递归的东西......

2.  一般来说，这并不好，因为线程之间过多的任务切换和线程生成会降低性能。相反，应该尝试 - TBB 和 PPL 这样做 - 通过应用任务窃取模式（请参阅 TBB wiki 页面）来拆分不同线程上的工作。小额超额订阅的唯一好处是某些线程必须等待，这样会浪费 CPU 处理时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T14:49:33.907

1）我也会选择Boost。

2）也许。如果任务中有任何锁定或 I/O 阻塞，则可能需要大量线程。如果任务受 CPU 限制，那就更难说了。如果任务不读取，尤其是写入大量数据，因此在运行时不会使那么多缓存无效，那么大量线程似乎实际上会略微提高性能 - 如果只是添加到变量中，则 200 个线程会得到完成的工作量比 8 略多。在更常见的 CPU 密集型任务使用大量内存并因此倾向于弄脏所有缓存的情况下，大量线程（例如 200）通常会导致吞吐量下降 20 -50% 因为缓存刷新。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-14T14:32:12.513

Boost 线程是跨平台的，适用于 C++： http: [//www.boost.org/doc/libs/1_49_0/doc/html/thread.html](http://www.boost.org/doc/libs/1_49_0/doc/html/thread.html)

# java - Java 字段隐藏

> ID：10154348
> 
> 赞同：3
> 
> 时间：2012-04-14T14:28:20.553
> 
> 标签：java, field, member-hiding

在以下场景中：

```
class Person{
    public int ID;  
}

class Student extends Person{
    public int ID;
} 
```

学生“隐藏人的ID字段。

如果我们想在内存中表示以下内容：

```
Student john = new Student(); 
```

john 对象是否有两个单独的内存位置用于 storint Person.ID 和它自己的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T14:46:54.643

正确的。您示例中的每个类都有自己的`int ID`id 字段。

您可以通过这种方式从子类中读取或分配值：

```
super.ID = ... ; // when it is the direct sub class
((Person) this).ID = ... ; // when the class hierarchy is not one level only 
```

或在外部（当它们公开时）：

```
Student s = new Student();
s.ID = ... ; // to access the ID of Student
((Person) s).ID = ... ; to access the ID of Person 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T14:36:17.743

是的，您可以通过以下方式验证：

```
class Student extends Person{
    public int ID;

    void foo() {
        super.ID = 1;
        ID = 2;
        System.out.println(super.ID);
        System.out.println(ID);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T14:33:56.033

对，那是正确的。将有两个不同的整数。

您可以通过以下方式访问`Person`'s int `Student`：

```
super.ID; 
```

不过要小心，成员字段不会发生动态调度。如果您在 Person 上定义一个使用该`ID`字段的方法，它将引用`Person`' 字段，而不是`Student`' ，即使在`Student`对象上调用也是如此。

```
public class A
{
    public int ID = 42;

    public void inheritedMethod()
    {
        System.out.println(ID);
    }
}

public class B extends A
{
    public int ID;

    public static void main(String[] args)
    {
        B b = new B();
        b.ID = 1;
        b.inheritedMethod();
    }
} 
```

上面将打印 42，而不是 1。

# sql-server - 使用原始查询、使用实体框架和 MVC 返回计数

> ID：10154349
> 
> 赞同：30
> 
> 时间：2012-04-14T14:28:34.227
> 
> 标签：sql-server, asp.net-mvc, entity-framework

我在 MVC 网站中使用实体框架

我正在尝试使用原始查询获取记录数。

我正在寻找这些方面的东西，但任何人都会对任何解决方案感到满意。

```
var sql = SELECT COUNT(*) FROM dbo.Articles WHERE (CategoryID = 3)

var total = _context.Database.SOMETHING(sql) 
```

我意识到对于这样一个简单的场景，原始查询可能不是要走的路，但实际上，sql 字符串要复杂得多，因此使用 Linq to SQL 几乎是不可能的。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-04-14T15:05:06.417

您可以使用[SqlQuery](http://msdn.microsoft.com/en-us/library/gg679164%28v=vs.103%29.aspx)方法首先使用 EF 代码[执行原始 SQL查询：](http://blogs.msdn.com/b/adonet/archive/2011/02/04/using-dbcontext-in-ef-feature-ctp5-part-10-raw-sql-queries.aspx)

```
var sql = "SELECT COUNT(*) FROM dbo.Articles WHERE (CategoryID = 3)";
var total = _context.Database.SqlQuery<int>(sql).First(); 
```

# php - 访问在类中的函数内声明的变量 (PHP)

> ID：10154350
> 
> 赞同：0
> 
> 时间：2012-04-14T14:28:47.330
> 
> 标签：php, mysql, class, scope, superglobals

我正在为一个网站编写脚本，用户可以在该网站上创建帐户并上传数据，以便公众稍后搜索和访问这些数据。作为我的上传类的一部分，我有一个重命名文件的功能，这样我的上传目录中就没有多个同名文件。问题是我需要从类中取出重命名的文件值，以便可以将其放入 mySQL 数据库的 fileName 部分。

真正在类中工作的函数的代码：

```
class Ds1_Upload {
protected $_uploaded = array();
protected $_destination;
protected $_max = 10485760;
protected $_messages = array();
protected $_permitted = array('audio/mpeg','audio/wav','audio/mpeg3','audio/x-mpeg-3');
protected $_renamed = false;

public function __construct($path) {
    if(!is_dir($path) || !is_writable($path)) {
        throw new Exception("$path must be a valid, writable directory.");
    }
    $this->_destination = $path;
    $this->_uploaded = $_FILES;
}

public function move($overwrite = false) {
    $field = current($this->_uploaded);
    $OK = $this->checkError($field['name'], $field['error']);
    if($OK) {
        $sizeOK = $this->checkSize($field['name'],$field['size']);
        $typeOK = $this->checkType($field['name'], $field['type']);
        if($sizeOK && $typeOK) {
            $name = $this->checkName($field['name'], $overwrite);
            $success = move_uploaded_file($field['tmp_name'], $this->_destination.$name);

            if($success) {

                $message = $field['name']. ' was uploaded successfully';
                if ($this->_renamed) {
                    $message .=" and renamed $name as a result of a conflicting filename in the Sleep Speak database.";
                }

                $this->_messages[] = $message;
            } else {
                $this->_messages[] = 'Could not upload ' . $field['name'];
            }
            $_POST['dream'] = $name;
        }
    }
} 
```

如您所见，我试图让它设置一个 $_POST 变量等于 $name 的值（这是我需要的值），但是当我尝试使用 $_POST[ 在我的主代码中设置 fileName 列时'dream']，它返回一个显示“列文件名不能为空”的页面。在函数或类中设置超全局变量是否存在问题？如果是这样，我该怎么做才能从类中获取 $name 的值，以便通过 mySQL 查询访问？

这是mySQL代码

```
if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "fileupload")) {
  $insertSQL = sprintf("INSERT INTO Dreams (fileName, userName, dreamName, tags,     uploadDate) VALUES (%s, %s, %s, %s, %s)",
                       GetSQLValueString($_POST['dream'], "text"),
                       GetSQLValueString($_POST['user'], "text"),
                       GetSQLValueString($_POST['title'], "text"),
                       GetSQLValueString($_POST['tags'], "text"),
                       GetSQLValueString($_POST['date'], "text"));

  mysql_select_db($database_Sleep_Speak, $Sleep_Speak);
  $Result1 = mysql_query($insertSQL, $Sleep_Speak) or die(mysql_error());

} 
```

所有其他 $_POST 值都由正在提交的表单设置。$_POST['dreams'] 由隐藏字段中的表单启动，但实际上并未设置任何内容。谁能帮我弄清楚这里出了什么问题？我是新来的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:37:44.903

如果没有看到完整的代码流，我建议您将 move() 函数中的最后一行代码从：

```
$_POST['dream'] = $name; 
```

至：

```
return $name; 
```

然后像这样捕获返回值：

```
$filename = $upload->move(); 
```

然后，更改此行：

```
GetSQLValueString($_POST['dream'], "text"), 
```

至：

```
mysql_real_escape_string($filename), 
```

# ios5 - 如何在 iOS5 中将导航控制器添加到我自己的容器视图控制器？

> ID：10154352
> 
> 赞同：0
> 
> 时间：2012-04-14T14:29:26.980
> 
> 标签：ios5, uiviewcontroller, uinavigationcontroller, splitcontainer

我正在尝试创建一个容器视图控制器（见屏幕截图），我想在右侧添加一个导航控制器，但我遇到了一些问题。你能帮助我吗？

当我在我的父控制器 (viewDidLoad) 中添加此代码时，我会看到具有其他位置/大小的视图，我猜是因为我无法访问导航控制器容器视图。

试过：

```
[self addChildViewController:_detailNavigationController];
_detailNavigationController.view.frame = CGRectMake(256, 49, 768, 651);
[self.view addSubview:_detailNavigationController.view]; 
```

还有这个，但显然只适用于第一种观点。

```
[self addChildViewController:_detailNavigationController];
_detailNavigationController.topViewController.view.frame = CGRectMake(256, 49, 768, 651);
[self.view addSubview:_detailNavigationController..topViewController.view]; 
```

尝试获取导航控制器容器视图，但不起作用，我在屏幕上什么也看不到，使用调试器我意识到视图为零。除此之外，苹果可能不喜欢这个。

```
[self addChildViewController:_detailNavigationController];
UIView *view = [_detailNavigationController valueForKey:@"_containerView"];
view.frame = CGRectMake(256, 49, 768, 651);
[self.view addSubview:view]; 
```

我错过了什么吗？
你知道如何在我自己定制的容器视图控制器中添加导航控制器吗？
提前致谢！

截图：http: [//img803.imageshack.us/img803/2464/screennjz.png](http://img803.imageshack.us/img803/2464/screennjz.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:52:54.793

我有自定义类 MasterViewController 和DetailedViewController 是UITableViewController 的子类。NavigationController 是 UINavigationController 的子类，SplitViewController 是 UISplitViewController 的子类。

如您所见，它有效，但是当我从导航控制器弹出视图时遇到问题。如果您知道如何解决此问题，请告诉我。

![在此处输入图像描述](../Images/a698f065fd58cbe240d75799ae056875.png)

```
 MasterViewController *master = [[MasterViewController alloc] init];

    NavigationController *masterNav = [[NavigationController alloc] initWithRootViewController:master];

    DetailedViewController *detailed = [[DetailedViewController alloc] init];

    NavigationController *detailedNav = [[NavigationController alloc] initWithRootViewController:detailed];

    myVC = [[SplitViewController alloc] init];

    [myVC setViewControllers:[NSArray arrayWithObjects:masterNav, detailedNav, nil]]; 
```

# mysql - 如何从数据库表中获取（选择然后删除）？

> ID：10154353
> 
> 赞同：0
> 
> 时间：2012-04-14T14:29:40.373
> 
> 标签：mysql, select, fetch

我有一个流表（内存表）和一个插入该表的脚本（从 1 行/分钟到 100 行/秒）。我需要每 5 秒获取 1000 行，我的意思是选择前 1000 行，然后删除选定的行。

我的选择查询非常简单：

```
SELECT * FROM vdp_stream WHERE user=xxx 
```

我的问题实际上是我无法查询 DELETE sql，因为在 i`SELECT`和`DELETE`. 我对吗？有没有从表中获取行的解决方案？

更新我的表结构：

```
vdp_stream
---------------------
user CHAR(30)
x    INT
y    INT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:40:06.640

如果您打算继续使用表执行此操作，我建议您在事务中使用 UPDATE、SELECT 和 DELETE 语句。可能是这样的——

```
START TRANSACTION;

UPDATE vdp_stream
SET selected = 1
ORDER BY id ASC
LIMIT 1000;

SELECT *
FROM vdp_stream
WHERE selected = 1;

DELETE
FROM vdp_stream
WHERE selected = 1;

COMMIT; 
```

**UPDATE** - 因为 InnoDB 的默认隔离级别是 REPEATABLE READ，所以你可以省略更新，只根据相同的标准执行 SELECT 和 DELETE -

```
START TRANSACTION;

SELECT *
FROM vdp_stream
ORDER BY id ASC
LIMIT 1000;

DELETE
FROM vdp_stream
ORDER BY id ASC
LIMIT 1000;

COMMIT; 
```

# vim - 从特定窗口中删除边框

> ID：10154356
> 
> 赞同：2
> 
> 时间：2012-04-14T14:29:56.753
> 
> 标签：vim, gtk

```
# -- THEME AUTO-WRITTEN DO NOT EDIT
include "/usr/share/themes/Adwaita/gtk-2.0/gtkrc"

style "user-font" {
    font_name = "Droid Sans 10"
}

widget_class "*" style "user-font"

gtk-font-name="Droid Sans 10"

include "/home/david/.gtkrc.mine"

style "vimfix" {
  #NOT WORKING
  GtkWindow::borderWidth = 0
}

widget "vim-main-window.*GtkForm" style "vimfix"

# -- THEME AUTO-WRITTEN DO NOT EDIT 
```

那是我的.gtkrc-2.0。如何使 gvim 的窗口没有边框，或者边框宽度为 0？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:58:45.767

你应该看看其他主题的作用。

使用[我使用的主题](http://gnome-look.org/content/show.php/?content=121685)，每个窗口（包括 GVim）只有一个 1px 的黑色边框。

# delphi - 如何将组合框中的项目与 Win32 API 热键相关联？

> ID：10154358
> 
> 赞同：0
> 
> 时间：2012-04-14T14:30:16.380
> 
> 标签：delphi

我有一个带有项目的组合框 - 热键。我想将每一个都关联到一个 Win32 热键，例如 F2 到 VK_F2，然后用 RegisterHotkey 调用那个。最好的方法是什么？我查找了一些东西，也许十六进制值会有所帮助，但它并没有说明如何使用它们。谢谢。

很抱歉，我无法提供更多信息，但我不知道我还应该包括什么：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T21:14:03.543

您可以使用`TextToShortCut`，然后将返回的值解码`TShortCut`为所需的值`RegisterHotKey`：

```
var
  Shortcut: TShortCut;
  Flags: Cardinal;
  Key  : Word;
  Shift : TShiftState;
begin
  ShortCut := TextToShortCut(ComboBox1.Items[ComboBox1.ItemIndex]);
  Flags := 0;
  Key   := 0;
  Shift  := [];
  ShortCutToKey(Shortcut, Key, Shift);
  if ssCtrl in Shift then
    Flags := Flags or MOD_CONTROL;
  if ssShift in Shift then
    Flags := Flags or MOD_SHIFT;
  if ssAlt in Shift then
    Flags := Flags or MOD_ALT;

  // You should check the return value of RegisterHotKey - it returns
  // a BOOL indicating success or failure. Omitted because your 
  // question isn't about using RegisterHotKey.
  RegisterHotKey(Application.Handle, YourHotKeyID, Flags, Key );
end; 
```

`TextToShortCut`并且`ShortCutToKey`都在`Menus`单元中定义。

`YourHotKeyID``wParam`是您定义的 $0000-$BFFF 之间的值，当您收到`WM_HOTKEY`消息时将传递给您的应用程序。

说了这么多，您应该重新考虑您对 UI 控件的选择。如果您使用 a `THotKey`，用户只需按下他们想要使用的组合键（而不是滚动列表）。然后，您可以使用`THotKey.HotKey`代替`ShortCut`示例代码中的变量（您可以将其直接传递给`ShortCutToKey`，并完全消除`ShortCut`变量）：

```
ShortCutToKey(HotKey1.HotKey, Key, Shift);
// ... remainder of code 
```

而且，期待您即将发表的评论:)，如何捕获和处理`WM_HOTKEY`消息以及如何处理您注册的多个热键应该是一个新问题。这个是专门关于组合框和热键的；如何处理被按下的热键是完全不同的。

# ruby-on-rails - 放弃阅读erb

> ID：10154360
> 
> 赞同：1
> 
> 时间：2012-04-14T14:31:00.453
> 
> 标签：ruby-on-rails, ruby, erb

ruby 的 ERB 中有没有办法（例如在 rails 视图中）在到达结尾之前退出解析文件？在红宝石的方向的东西`__END__`。

```
Some Text
<%= ... %>
<% some_magic_quit_function %>
This will not be included in the result 
```

我试过`return`了，但它不能正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:33:23.807

不，但有更简单的

```
<% unless some_quit_function %>
  Output you don't want included if some_quit_function returns true
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:35:49.223

正如 Doug R 指出的那样，这不起作用，原因是 Erb 评估方法“some_magic_quit_function”的结果，然后将结果作为渲染返回。我假设您在该方法中有一个返回，它所做的只是从该方法本身返回（它不会全局返回）。

您将需要使用 Doug R 提供的代码（在实际 Erb 文件中返回的逻辑测试）。

# python - Python中的广度优先搜索实现

> ID：10154362
> 
> 赞同：2
> 
> 时间：2012-04-14T14:31:15.740
> 
> 标签：python, algorithm, implementation, breadth-first-search

我正在尝试在 Python 中实现 BFS，我了解该算法的工作原理，但我没有太多的编程经验。我花了几个小时思考代表一切的最佳方式以及如何尽可能高效。我一直无法弄清楚如何获取从我的起始节点到目标节点的路径。

我花了很长时间在谷歌上搜索并查看其他人的算法实现，但我的应用程序略有不同，这让我感到困惑。当人们实施 BFS 时，他们假设他们有一个图表（就像关于 BFS 的维基百科文章一样）。在我的问题中，我有一个初始状态和一个想要达到的目标状态，但没有图形或树，所以我正在生成节点。

例如：

```
def BFS(initial, goal):

    q = [initial]
    visited = []

    while q:
        n = q.pop()
        states = generate_states(n)

        for state in states:
            if state == goal:
                pass #placeholder
            q.append(state)
            visited.append(state) 
```

它没有正确充实，因为我遇到了一些问题，我也不确定它具体是什么......如果初始和目标是节点，我在代码的其他地方编写了一个结构类型类，例如：

```
class node:
    state = None
    parent = None 
```

我认为这是表示节点的合适方式。因此，当我从队列中弹出一个节点对象时，它会包含有关其起源位置的信息，这些信息将由 generate_states 函数初始化。然后 for 循环会将这些新节点中的每一个附加到队列中，并访问队列，它将在生成的节点之一具有与我的目标状态匹配的状态下重复。

现在我已经找到了目标节点，我有一个访问节点的列表，但是如果我从目标节点向后跟踪路径，我不是减慢了算法吗？找到目标后，我会查看其父级，在访问列表中找到其父级，然后查看父级的父级，等等……直到我有一个 path = [node object, node object, ... ] 从初始节点到目标节点。

这给我带来了另一个问题，当我创建一个节点对象时，它只持续一次 while 循环的迭代。我打算如何将对象存储在数组中，它们每个都需要一个唯一的名称，并且（对我而言）没有明显的方法可以做到这一点。这是我之前提到的我不确定的问题。所以看起来我正在创建节点，但只将 node.state 存储在队列中，这是没有意义的，因为我需要节点对象来访问 node.parent ...

为什么我觉得这很困难，是我遗漏了一些明显的东西还是把它弄得太复杂了？

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:41:20.997

我不能对大部分内容发表评论，因为我不完全理解你想要做什么——正如你所说，通常 BFS 已经有图表了，所以我不确定你是如何提议的随手建造。但我必须回复这一点：

> 我是如何将对象存储在数组中的，它们每个都需要一个唯一的名称

这绝对是错误的。如果您只想将其存储在列表中，则绝对无需命名 - 您只需附加它即可。如果您担心以后能够找到它，那么与图表有关的正常操作就是给每个节点一个数字，通过一个计数器，每次定义一个时您都会增加该数字。同样，如果您只是将节点存储在列表中，那么它们会自动获得一个唯一编号：它们在列表中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:48:11.690

你的方法对我来说很好。

为了获得发现路径，您可以跟踪每个父节点，例如给它一个属性，该属性设置为发现它的节点。这样，您就有了一个可追溯发现路径的链表。一旦你达到了你可以做的目标就往回走

```
def get_parents(node):
    if node.parent is None:
        return []

    yield node.parent
    get_parents(node) 
```

为了跟踪生成的节点（变量 n），只需将您发现的节点放入列表中，而不仅仅是状态。

```
 n = q.pop()
    states = generate_states(n)

    for state in states:
        m = node()
        m.state = state
        m.parent = n
        if state == goal:
            pass #placeholder
        q.append(m)
        visited.append(m) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T14:52:01.363

一般来说，你所拥有的一切都很好。

有几个困惑，我将尝试解释。首先，您可以将节点存储在队列中，而不是状态，并且由于节点有父节点，您可以访问之前的节点，因此您不会丢失它们。其次，追溯父母不是为了提高效率而需要担心的事情——你只有在成功时才这样做（另外，不需要名字——听起来你把列表和地图混淆了？）。

因此，您的代码中唯一缺少的是您没有创建节点。当你得到一个状态时，创建一个节点，然后保存节点，而不是保存状态。然后一切都会奏效。

# mysql - 计算与 unix 时间戳（MYSQL）的不同间隔匹配的行

> ID：10154363
> 
> 赞同：0
> 
> 时间：2012-04-14T14:31:20.937
> 
> 标签：mysql, sql

我有一个 MYSQL 表记录对网站的点击，它的形式是（如果需要，这可以更改，我处于项目的“这是否可行”阶段）：

```
+----+-----------+---------+----------+------------+
| id | useragent |   url   | loadTime |  unixtime  |
+----+-----------+---------+----------+------------+
|  1 | Chrome    | /       |      300 | 1334354015 |
|  2 | Chrome    | /       |      330 | 1334354020 |
|  3 | Opera     | /about/ |      310 | 1334354100 |
+----+-----------+---------+----------+------------+ 
```

等等

我想做的是计算每天的点击次数，以及平均每天的 loadTime 以及我稍后会做的其他事情。

要计算点击次数，我知道如何做到这一点的唯一方法是使用服务器端语言 SELECT *，然后循环遍历，用一天开始和结束之间的 unix 时间计算行数。执行此操作的正确 SQL 方法是什么，或者我应该坚持选择 *，循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:36:35.760

假设您的表名是访问。

```
select date(FROM_UNIXTIME(unixtime)) as visitDate, count(v.id) from visits v group by visitDate; 
```

应该可以正常工作..如果您想按页面网址过滤结果；

```
select date(FROM_UNIXTIME(unixtime)) as visitDate, url, count(v.id) from visits v group by visitDate, url; 
```

如果你想看看今天的访问；

```
select date(FROM_UNIXTIME(unixtime)) as visitDate, count(v.id) from visits v where date(now()) = date(FROM_UNIXTIME(unixtime)) group by visitDate; 
```

我还没有测试过这些，可能需要一点点修改。

# ajax - 使用 Ajax 更新 Mako

> ID：10154365
> 
> 赞同：1
> 
> 时间：2012-04-14T14:31:40.187
> 
> 标签：ajax, pylons, mako

好的，所以我是 Mako 模板的新手，并且正在使用 pylons Web 框架。

我让我的 mako 模板通过 for 循环来为我创建一些表，我想知道我是否可以更新 for 循环中的数据并让 mako 呈现 html 的特定部分以轻松更新网页。

例子：

```
<ol>
    %for row in history:
        <li>${row.data}</li>
    %endfor
</ol> 
```

我想做的是将 AJAX 请求发送到返回一组新历史数据的服务器，然后让 mako 重新渲染列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T20:49:40.250

Mako 在服务器上渲染，你想要的是 javascript 在浏览器中渲染页面的片段。为此，您可能需要设置一个视图/控制器以在请求时将数据返回给客户端，并且您需要编写一些 javascript 来调用视图控制器，使用数据进行渲染，然后将结果粘贴到大教堂。

这是相当普遍的 javascript/ajax 东西。它与 mako 唯一有关的是，您的 mako 模板可能必须发送一些 javascript 以及任何 html 来引导整个更新过程。有很多方法可以做到这一点。

# ruby-on-rails - 使用 authlogic 进行蛮力保护，Rails3.0.10

> ID：10154368
> 
> 赞同：0
> 
> 时间：2012-04-14T14:32:05.850
> 
> 标签：ruby-on-rails, authlogic, brute-force

我想使用 authlogic 的 Bruteforce 功能，但不知道如何配置它。我的`user_session.rb`模型如下所示：

```
class UserSession < Authlogic::Session::Base

#edited code to ensure specific login error isn't displayed

    generalize_credentials_error_messages "Login/password invaild"

    #brute force protection
    consecutive_failed_logins_limit 3

    #orginal code commented out
        #def to_key
        #new_record? ? nil : [ self.send(self.class.primary_key) ]
        #end
        #def persisted?
        #false
        #end

end 
```

我知道我需要比这更多的配置，但是什么？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T21:55:19.830

您需要添加 Continuous_failed_logins_limit 和可选的 failed_login_ban_for。我在下面展示了一个使用 Authlogic 的默认设置的示例。您不需要为这些值定义和使用常量，但我喜欢这样做，以便可以从任何地方以编程方式引用这些值。

```
class UserSession < Authlogic::Session::Base
  MAXIMUM_NUMBER_OF_FAILED_LOGIN_ATTEMPTS_ALLOWED = 50
  consecutive_failed_logins_limit MAXIMUM_NUMBER_OF_FAILED_LOGIN_ATTEMPTS_ALLOWED

  LOCKOUT_TIMEOUT_PERIOD = 2.hours
  failed_login_ban_for LOCKOUT_TIMEOUT_PERIOD

...
end 
```

# c# - 将 date.now 添加到其中已包含代码的控制器

> ID：10154377
> 
> 赞同：1
> 
> 时间：2012-04-14T14:33:40.093
> 
> 标签：c#, asp.net, asp.net-mvc-3

我的控制器中有以下代码：

```
// GET: /Review/Create
public ActionResult Create()
    {
        var userGames = db.tblGames.Where(g => g.UserName == User.Identity.Name);
        ViewBag.GameIDFK = new SelectList(userGames, "GameID", "GameName");
        return View(new tblReview { UserName = @User.Identity.Name });
    } 
```

// 发布：/审查/创建

```
 [HttpPost]
    public ActionResult Create(tblReview tblreview)
    {
        if (ModelState.IsValid)
        {
            db.tblReviews.Add(tblreview);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        var userGames = db.tblGames.Where(g => g.UserName == User.Identity.Name);
        ViewBag.GameIDFK = new SelectList(userGames, "GameID", "GameName");
        return View(new tblReview { UserName = @User.Identity.Name });
    } 
```

我想将这行代码添加到它：

```
 return View(new tblReview { Posted = DateTime.Now }); 
```

但我不知道如何将代码组合在一起。我尝试了一个 If 语句，但应用程序崩溃了，因为它只是到处抛出错误。

我想将这些添加到代码中的原因是，当撰写评论时，查看者可以看到评论发布的日期。我的数据库表和模型中有一个已发布的属性，如下所示：

```
namespace TestWebSite.Models
{
    using System;
    using System.Collections.Generic;

    public partial class tblReview
    {
        public int ReviewID { get; set; }
        public string Recomendation { get; set; }
        public string AvoidOrBuy { get; set; }
        public string Score { get; set; }
        public System.DateTime Posted { get; set; }
        public int GameIDFK { get; set; }
        public string UserName { get; set; }

        public virtual tblGame tblGame { get; set; }
    }
} 
```

谢谢

如果您需要其他信息，请询问我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:43:06.993

我管理我不完全理解关系形式`tblReview`and `NewsItem`，但是如果您想公开该信息而不在 ViewModel 中设置它，我认为唯一的方法是使用 ViewBag。

就像是

```
ViewBag.NewsItem = new NewsItem() { Posted = DateTime.Now }; 
```

然后从视图中访问它。

老实说，我会创建一个特定的视图模型来保存视图所需的所有信息，但如果没有其他方法，我想这是一种替代方法。

**更新**

在您进行更改后，我不明白为什么这不起作用

```
return View(new tblReview { UserName = @User.Identity.Name, Posted = DateTime.Now }); 
```

# html - CSS下拉菜单保持不变的背景

> ID：10154382
> 
> 赞同：0
> 
> 时间：2012-04-14T14:33:58.967
> 
> 标签：html, css

我将在它的外观和当前外观以及 jsfiddle 的底部包含一个屏幕截图。

我目前的颜色相当..粗体，所以我可以清楚地看到什么是什么，当我正确时我会改变颜色，我会在 jsfiddle 中发布相关代码。

*   它应该是什么样子：[http ://tinypic.com/r/28s78tx/5](http://tinypic.com/r/28s78tx/5)
*   它的样子：[http ://tinypic.com/r/egw9pt/5](http://tinypic.com/r/egw9pt/5)
*   jsfiddle：http: [//jsfiddle.net/CwCdF/](http://jsfiddle.net/CwCdF/)

我在想一个 div，它做了一些我真的不知道的事情：/ 欢迎任何想法以及简短的解释，它没有用勺子喂;-) 谢谢负载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T13:56:59.767

这是我将如何在这里进行的[示例](http://jsfiddle.net/jamessouth/J3BBe/)。

它**没有**经过跨浏览器测试，因为我没有时间，也没有将其重构为最有效的形式。

虽然我已经对 css 进行了注释，以便您可以弄清楚发生了什么，我会尽力分析每个部分。如果您仍然需要我解释任何事情，希望我应该能够。

# asp.net - 在同一行代码中测试 null 和其他内容

> ID：10154383
> 
> 赞同：0
> 
> 时间：2012-04-14T14:34:03.090
> 
> 标签：asp.net

我有一个用户对象，我有一个名为 userID 的变量。

我想测试两件事：

*   用户 == 空
*   user.UserID != 用户ID

只有当用户不为空时才必须进行第二次测试，否则我会遇到运行时错误。

我想知道是否可以在同一行测试两者，如下所示：

```
return ((user == null) && (user.UserID != userID)) 
```

但是像上面这样的编码不起作用，因为当用户为空时，我有一个运行时错误。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:36:36.273

我假设 C# 并且当用户为空**或**用户 ID 与 user.UserID 不同时，您需要一个布尔值 == true。所以答案是：

```
return ((user == null) || (user.UserID != userID)); 
```

OR 逻辑运算符一旦发现从最左边开始的条件为真，就会停止对表达式的求值。

在这种情况下，如果 user 为 null，则您的结果为 (True)，无需测试第二个条件，因此您避免了 null 引用异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:35:43.870

是的，您可以在一行中进行检查，但您应该使用`or`条件

```
return ((user == null) || (user.UserID != userID)) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-14T14:42:02.753

我认为最容易阅读的方式是：

如果你想如果用户为空则为**真：**

```
return user == null || user.UserID != userID 
```

如果满足第一个条件（*为*真），则不会检查第二个条件。

或者，如果用户为空，则您想要**false ：**

```
return user != null && user.UserID != userID 
```

如果第一个条件*不满足*（它为假），那么它不会检查第二个条件。`&&`和`||`=)的力量

# mysql - MYSQL 避免两次插入同一行

> ID：10154387
> 
> 赞同：1
> 
> 时间：2012-04-14T14:34:32.933
> 
> 标签：mysql, sql

我有一个涉及将一行插入表中的 ajax 发布请求的系统。似乎有时ajax调用被调用两次，这意味着相同的数据在相邻的两个行中插入了两次。

我打算先添加一个查询以尝试选择具有相同数据的行，然后如果行数 = 0 添加它。有没有更好的方法可以避免进行两次查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:00:59.157

您可以在插入语句中使用 INSERT IGNORE INTO 语法或 INSERT...ON DUPLICATE KEY UPDATE。

如果您使用 INSERT IGNORE，那么如果它导致重复键，则实际上不会插入该行。但该语句不会产生错误。它会生成一个警告。

```
INSERT IGNORE INTO mytable
    (primaryKey, field1, field2)
VALUES
    ('abc', 1, 2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:47:23.167

我想说解决这个问题的最好方法是在你的应用程序中使用一个临时令牌（它可以兼作 CSRF 令牌，无论如何你可能需要它......）。

如果令牌与操作一起发送，则使令牌过期，使其不能重复。

# c# - 如何将图标添加到 Windows 窗体顶部栏（在最小化最大化按钮旁边）

> ID：10154390
> 
> 赞同：3
> 
> 时间：2012-04-14T14:35:32.080
> 
> 标签：c#, .net, winforms

我希望在最小化最大化按钮旁边添加更多按钮。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T17:22:42.953

我发现这段代码可以在 winform 标题栏上添加自定义按钮。它的评论很差，很难理解，但试一试:)

```
// The state of our little button
ButtonState _buttState = ButtonState.Normal;
Rectangle _buttPosition = new Rectangle();

[DllImport("user32.dll")]
private static extern IntPtr GetWindowDC(IntPtr hWnd);
[DllImport("user32.dll")]
private static extern int GetWindowRect(IntPtr hWnd, 
                                        ref Rectangle lpRect);
[DllImport("user32.dll")]
private static extern int ReleaseDC(IntPtr hWnd, IntPtr hDC);
protected override void WndProc(ref Message m)
{
    int x, y;
    Rectangle windowRect = new Rectangle();
    GetWindowRect(m.HWnd, ref windowRect);

    switch (m.Msg)
    {
        // WM_NCPAINT
        case 0x85:
        // WM_PAINT
        case 0x0A:
            base.WndProc(ref m);

            DrawButton(m.HWnd);

            m.Result = IntPtr.Zero;

            break;

        // WM_ACTIVATE
        case 0x86:
            base.WndProc(ref m);
            DrawButton(m.HWnd);

            break;

        // WM_NCMOUSEMOVE
        case 0xA0:
            // Extract the least significant 16 bits
            x = ((int)m.LParam << 16) >> 16;
            // Extract the most significant 16 bits
            y = (int)m.LParam >> 16;

            x -= windowRect.Left;
            y -= windowRect.Top;

            base.WndProc(ref m);

            if (!_buttPosition.Contains(new Point(x, y)) && 
                _buttState == ButtonState.Pushed)
            {
                _buttState = ButtonState.Normal;
                DrawButton(m.HWnd);
            }

            break;

        // WM_NCLBUTTONDOWN
        case 0xA1:
            // Extract the least significant 16 bits
            x = ((int)m.LParam << 16) >> 16;
            // Extract the most significant 16 bits
            y = (int)m.LParam >> 16;

            x -= windowRect.Left;
            y -= windowRect.Top;

            if (_buttPosition.Contains(new Point(x, y)))
            {
                _buttState = ButtonState.Pushed;
                DrawButton(m.HWnd);
            }
            else
                base.WndProc(ref m);

            break;

        // WM_NCLBUTTONUP
        case 0xA2:
            // Extract the least significant 16 bits
            x = ((int)m.LParam << 16) >> 16;
            // Extract the most significant 16 bits
            y = (int)m.LParam >> 16;

            x -= windowRect.Left;
            y -= windowRect.Top;

            if (_buttPosition.Contains(new Point(x, y)) &&
                _buttState == ButtonState.Pushed)
            {
                _buttState = ButtonState.Normal;
                // [[TODO]]: Fire a click event for your button 
                //           however you want to do it.
                DrawButton(m.HWnd);
            }
            else
                base.WndProc(ref m);

            break;

        // WM_NCHITTEST
        case 0x84:
            // Extract the least significant 16 bits
            x = ((int)m.LParam << 16) >> 16;
            // Extract the most significant 16 bits
            y = (int)m.LParam >> 16;

            x -= windowRect.Left;
            y -= windowRect.Top;

            if (_buttPosition.Contains(new Point(x, y)))
                m.Result = (IntPtr)18; // HTBORDER
            else
                base.WndProc(ref m);

            break;

        default:
            base.WndProc(ref m);
            break;
    }
}

private void DrawButton(IntPtr hwnd)
{
    IntPtr hDC = GetWindowDC(hwnd);
    int x, y;

    using (Graphics g = Graphics.FromHdc(hDC))
    {
        // Work out size and positioning
        int CaptionHeight = Bounds.Height - ClientRectangle.Height;
        Size ButtonSize = SystemInformation.CaptionButtonSize;
        x = Bounds.Width - 4 * ButtonSize.Width;
        y = (CaptionHeight - ButtonSize.Height) / 2;
        _buttPosition.Location = new Point(x, y);

        // Work out color
        Brush color;
        if (_buttState == ButtonState.Pushed)
            color = Brushes.LightGreen;
        else
            color = Brushes.Red;

        // Draw our "button"
        g.FillRectangle(color, x, y, ButtonSize.Width, ButtonSize.Height);
    }

    ReleaseDC(hwnd, hDC);
}

private void Form1_Load(object sender, EventArgs e)
{
    _buttPosition.Size = SystemInformation.CaptionButtonSize;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:01:36.463

一起去`WM_NCPAINT`，不是很容易，但很有效！

# javascript - 将文件放入区域 - 样式

> ID：10154394
> 
> 赞同：4
> 
> 时间：2012-04-14T14:36:01.680
> 
> 标签：javascript, jquery, css, html, plupload

有一个 pluploader，它有一个文件放置区，它的 id 是`dropFilesHere`；

```
var uploader = new plupload.Uploader({
        drop_element : "dropFilesHere", 
        /*...*/
    }); 
```

如果用户将文件放在拖放区上，我想在拖放区上进行一些更改*（如 gmail 文件附件）。

*例如：

```
.mouse_over{
    border-width:5px border-style:dashed #808080;
} 
```

样本： ![删除文件](../Images/c437acc8ba0182624a5b6e3b88e03d81.png)

我怎样才能做到这一点？

* * *

```
uploader.bind('Init', function(up, params) {
    $('#filelist').html("<div>Current runtime: " + params.runtime + "</div>");
    if(params.runtime === 'html5') {
        $('#dropFilesHere').on({
            "dragenter": function(){
                $(this).addClass('mouse_over');
            },
            "dragleave drop": function(){
                $(this).removeClass('mouse_over');
            }
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T16:26:49.927

如果初始化的运行时是 html5，你可以尝试这样的事情：

```
// the runtime has been initialized :
var uploader = $(item).pluploadQueue();

if(uploader.runtime === 'html5') {
$('li.plupload_droptext').bind('dragenter', function() {
    $(this).css("border", "5px dashed #000000");
});

$('li.plupload_droptext').bind('dragleave', function() {
    $(this).css("border", "0px none");
});
} 
```

在 Chrome 18 和 Firefox 11 上测试。希望这可以提供帮助。

我意识到另一个问题是不允许在放置区之外放置......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T08:10:22.207

您是否尝试过使用 CSS`:hover`选择器？

```
.dropFilesHere:hover {
    border-width:5px border-style:dashed #808080;
} 
```

您还可以使用`$('.dropFilesHere').mouseout()`和`$('.dropFilesHere').mouseenter()`或仅使用纯的客户端附加 jQuery 触发器`$('.dropFilesHere').hover()`

无论如何，现在使用 CSS 总是更好，因为它有时比 JS 更有效。

# c# - 通过网络流访问sqlite数据库

> ID：10154397
> 
> 赞同：1
> 
> 时间：2012-04-14T14:36:26.010
> 
> 标签：c#, database, sqlite, networking

我想知道是否有办法将网络流视为文件。我可能错了，但我将文件视为字节数组列表。当你在 Windows 中打开一个文件并写入文件时，我相信你是在向该文件（数组列表）插入字节。

我正在创建一个程序，在其中使用 SQLite 数据库部署它。我还在创建连接到网络上该数据库文件的客户端版本。

为了让用户连接到数据库文件，他们需要提供凭据才能访问该数据库中的数据。**我想让他们能够连接而无需输入该信息。**

我一直在想的事情：

*   改为使用 sql server 部署我的应用程序。（使用 SQL Server 部署应用程序并不容易，它会静默安装服务器、启用 tcp 连接以及实现此目的的所有必要配置。此外，安装 sqlite 只需不到 20 秒，大约需要 7 分钟！

*   我正在使用 WCF 与服务器通信，因此我可以为我计划使用的所有查询创建一个函数。因此，如果我想从产品中选择 *，那么我可以在 WCF 服务上调用方法 SelectAllFromProducts() ......（在这里我有点重新发明轮子。）另外，这样做的好处是我的查询会很多我相信更快。Sqlite 是无服务器的，因此如果您计划在产品中查找产品名称类似于“foo”的所有项目，那么如果您考虑一下，计算机将不得不通过网络访问数据库中的所有记录。如果本地计算机这样做并将少数结果发送给客户端，它会更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:44:44.423

我认为通过网络使用 Sqlite 不是一个好主意。我目前正在使用 Sqlite，但作为本地文件系统数据库。

在客户端服务器架构中，最好使用一些 RDBMS 而不是 SQLite

> 客户端/服务器应用程序
> 
> 如果您有许多客户端程序通过网络访问公共数据库，则应考虑使用客户端/服务器数据库引擎而不是 SQLite。SQLite 将在网络文件系统上工作，但由于与大多数网络文件系统相关的延迟，性能不会很好。此外，许多网络文件系统实现的文件锁定逻辑包含错误（在 Unix 和 Windows 上）。如果文件锁定不能正常工作，则两个或多个客户端程序可能同时修改同一数据库的同一部分，从而导致数据库损坏。因为这个问题是由底层文件系统实现中的错误引起的，所以 SQLite 无法阻止它。

请检查此链接以了解[适用于 Sqlite](http://www.sqlite.org/whentouse.html)并跳转到部分

> 另一个 RDBMS 可能工作得更好的情况

# mysql - 大型 MySQL 表 - 索引分解

> ID：10154408
> 
> 赞同：4
> 
> 时间：2012-04-14T14:37:47.657
> 
> 标签：mysql, datetime, indexing, partitioning

我有一个约 100GB 的 MySQL 表，其中有近 10 亿行。它只有 8 列，其中之一是索引 DateTime，用于通过薄切片的“BETWEEN”查询进行大多数查找。

以前我在该列上的索引工作得很好……但是随着表的不断增长，索引突然停止工作。现在 EXPLAIN 在所有查询中显示“使用文件排序”，并且我已经为内存池提高了所有适用的 my.conf 值，但无济于事。

钥匙可以处理的内容是否有最大值？像分区这样的东西会解决这个问题吗？

任何见解将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T19:06:28.333

如果可以，请停止 mysql 服务器，然后转到您的数据文件夹并执行

```
myisamchk -r <table_name> 
```

或者

```
myisamchk -r -v -f <table_name> 
```

那应该修理你的桌子。你也可以试试

```
REPAIR TABLE <table_name> 
```

更多信息[在这里](http://dev.mysql.com/doc/refman/5.1/en/repair-table.html)和 [这里](http://dev.mysql.com/doc/refman/5.0/en/myisamchk.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T19:00:43.440

您可以尝试通过提示强制使用索引。查看[解释索引提示的 mysql 页面](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)。一个非常简单的例子是；

```
SELECT * FROM table1 USE INDEX (col1_index)
  WHERE col1 BETWEEN date1 AND date2; 
```

但我不认为这是你的主要问题。为了预见您将来可能遇到的问题，我强烈建议您仔细阅读[MySQL Resource Limits Excerpt](http://downloads.mysql.com/docs/mysql-reslimits-excerpt-5.1-en.pdf)

在某些方面，它指出；

```
If you do encounter a full-table error, there are several reasons why it might have occurred: 
...
You are using MyISAM tables on an operating system that supports files only up to 2GB in size and you have hit this limit for the data file or index file. 
```

对你来说似乎不是这样。但此时您可能会考虑一些可能性。

我还强烈建议您快速搜索关键字“myisampack”。

# php - 检查两次之间的时差？

> ID：10154410
> 
> 赞同：0
> 
> 时间：2012-04-14T14:38:04.503
> 
> 标签：php, mysql, datetime

> **可能重复：**
> [使用 php 和 mysql 以小时为单位计算日期差异](https://stackoverflow.com/questions/2453846/count-date-difference-in-hours-using-php-and-mysql)

我有一个 MySQL 表，其中有一列`some_column`。此列设置为`datetime`，更新时更新为`NOW()`。

我想要做的是查询数据库，即`some_column`值，并检查其中的任何内容与查询时的时间之间的时间差。我想看看是否超过了2个小时。

我如何用 PHP 做到这一点？还是我用 MySQL 来做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T14:40:34.933

看看`TIMEDIFF`功能

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timediff](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timediff)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T14:41:02.803

```
SELECT IF(TIMEDIFF(NOW(),`some_column`) > '02:00:00',1,0) FROM `table` 
```

或者，如果您尝试返回两个多小时前更新的行：

```
SELECT * FROM `table` WHERE `some_column` < DATE_ADD(NOW(),INTERVAL -2 HOUR) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T14:44:48.363

```
<?php 

$time = // Run query to get datetime value from db

$time = strtotime($time);

$dif = time()-$time;

$dif = date('H', $dif);

if($dif >= 2) 
{
    // Do something
}

?> 
```

# java - JAVA - 通过链表过滤

> ID：10154413
> 
> 赞同：1
> 
> 时间：2012-04-14T14:38:37.037
> 
> 标签：java, linked-list, jtable, filtering, jcombobox

我有一个从文本文件中读取的类，通过分隔符拆分字符串并根据第一行将它们添加到对象中。

现在所有内容都添加到一个链接列表中，该链接列表稍后会在 JTable 中表示。

在 GUI 中，我有一个带有各种类别的 JComboBox。我想要的是根据所选项目过滤JTable。

这是一个屏幕截图，可帮助您了解更多信息：

![](../Images/91adf990076bd85e267fb5c6b299137a.png)

代码：

*   处理： http: [//pastebin.com/4L427yDY](http://pastebin.com/4L427yDY)
*   GUI_g：[http ://pastebin.com/rfaR3ehC](http://pastebin.com/rfaR3ehC)
*   程序表模型：http : [//pastebin.com/eLvcfPVM](http://pastebin.com/eLvcfPVM)

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:49:59.543

您可以使用 a`javax.swing.table.TableRowSorter`进行排序*和*过滤：请参阅[TableRowSorter](http://docs.oracle.com/javase/6/docs/api/javax/swing/table/TableRowSorter.html)。您可能必须实现自己的（简单）`javax.swing.RowFilter`，请参阅[RowFilter](http://docs.oracle.com/javase/6/docs/api/javax/swing/RowFilter.html)。

一个例子：[http ://www.javapractices.com/topic/TopicAction.do?Id=163](http://www.javapractices.com/topic/TopicAction.do?Id=163)

# erlang - 备份/恢复 mnesia 数据库的正确方法是什么？

> ID：10154414
> 
> 赞同：16
> 
> 时间：2012-04-14T14:38:40.330
> 
> 标签：erlang, backup, restore, mnesia

**警告：**背景信息很长。如果您认为在背景信息之前需要问题，请跳到底部。欣赏这将花费的时间！

我一直在网上（阅读谷歌），我还没有找到一个好的答案。是的，在 erlang.org 网站上有很多 Mnesia 文档的链接和参考，但即使是这些链接也会受到版本炎的影响。

因此，在最简单的情况下，您当前连接的 node() 与表集的所有者相同，那么备份/恢复将起作用。例如：

```
$ erl -sname mydatabase

> mnesia:start().
> mnesia:create_schema(...).
> mnesia:create_table(...).
> mnesia:backup("/tmp/backup.bup").
> mnesia:restore("/tmp/backup.bup", [{default_op, recreate_tables}]). 
```

嘿，这很好用！

但是，如果数据库实际上运行在远程节点（）或远程节点（）上的远程交配上，那么您必须以这种方式启动备份：

```
$ erl -sname mydbadmin

> rpc:call(mydatabase@host, mnesia, backup, ["/tmp/backup.bup"]).
> rpc:call(mydatabase@host, mnesia, restore, ["/tmp/backup.bup", [{default_op, recreate_tables}]]). 
```

当然这也很简单。现在这里是棘手的事情......

*   假设您正在进行每日备份。你的 mnesia 数据库服务器死了，你被迫更换硬件。如果要按原样还原数据库，则需要使用与以前相同的名称命名新硬件，并且还需要将节点命名为相同。
*   如果您想更改硬件和/或 node() 的名称...或者您想在另一台机器上恢复，那么您需要完成 node_change 过程。（[在此处](https://stackoverflow.com/questions/463400/how-to-rename-the-node-running-a-mnesia-database)和 mnesia 文档中进行了描述）

但这就是事情变得复杂的地方。虽然我的熟人是 erlang 和 mnesia 专家，但他们认为 mnesia 的复制存在严重缺陷，您不应该使用它（目前我所知道的没有替代方案，并且您将实施更好的版本的可能性有多大；不是可能）

因此，您有两个 nodes() 正在复制基于 ram 和磁盘的表。您一直在维护使用默认 BackupMod 使用标准备份定期备份数据库的策略。有一天，一位经理要求您验证备份。只有当您尝试恢复数据库时，您才会得到：

```
{atomic,[]} 
```

根据文档，这意味着没有错误……但没有恢复任何表。

不想运行 change_node 过程，您记得 node() 和主机名必须匹配，因此您更改主机名和 -sname 参数以匹配备份数据的机器。然而这一次你得到一个奇怪的错误：

```
{aborted,{'EXIT',{aborted,{bad_commit,{missing_lock,mydatabase@otherhost}}}}} 
```

仍然不想运行 change_node 过程，我快速克隆恢复我的服务器，以便我有两台类似的机器。然后我适当地命名以匹配生产服务器。然后我开始恢复过程。尤里卡！我现在在恢复服务器上有真实的工作数据。

我想说这是路的尽头......但我还没有问过一个问题，那么 SO.... 的意义就在这里吗？

**问题：**如果我想恢复从复制的 mnesia 节点集群中获取的备份，如何修改文件（类似于 change_node 过程）以便忽略或从备份中删除其他节点？

略有不同的问题：如何在单个节点（）上恢复复制的多节点（） mnesia 数据库？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-15T20:28:48.927

我认为这个问题属于与一个简单问题相关的更广泛的 Mnesia 问题类别：

> 如何重命名 Mnesia 节点？

如果您的数据库不大，第一个也是最简单的解决方案是使用 mnesia:traverse_backup 函数（请参阅[Mnesia 用户指南](http://www.erlang.org/doc/apps/mnesia/Mnesia_chap7.html)）。以下是 Mnesia 用户指南中的示例：

```
change_node_name(Mod, From, To, Source, Target) ->
    Switch =
        fun(Node) when Node == From -> To;
           (Node) when Node == To -> throw({error, already_exists});
           (Node) -> Node
        end,
    Convert =
        fun({schema, db_nodes, Nodes}, Acc) ->
                {[{schema, db_nodes, lists:map(Switch,Nodes)}], Acc};
           ({schema, version, Version}, Acc) ->
                {[{schema, version, Version}], Acc};
           ({schema, cookie, Cookie}, Acc) ->
                {[{schema, cookie, Cookie}], Acc};
           ({schema, Tab, CreateList}, Acc) ->
                Keys = [ram_copies, disc_copies, disc_only_copies],
                OptSwitch =
                    fun({Key, Val}) ->
                            case lists:member(Key, Keys) of
                                true -> {Key, lists:map(Switch, Val)};
                                false-> {Key, Val}
                            end
                    end,
                {[{schema, Tab, lists:map(OptSwitch, CreateList)}], Acc};
           (Other, Acc) ->
                {[Other], Acc}
        end,
    mnesia:traverse_backup(Source, Mod, Target, Mod, Convert, switched).

view(Source, Mod) ->
    View = fun(Item, Acc) ->
                   io:format("~p.~n",[Item]),
                   {[Item], Acc + 1}
           end,
    mnesia:traverse_backup(Source, Mod, dummy, read_only, View, 0). 
```

这里最重要的部分是`{schema, db_nodes, Nodes}`元组的操作，它可以让您重命名或替换数据库节点。

顺便说一句，我过去曾使用过该功能，我注意到的一件事是备份条款格式在 mnesia 版本之间发生变化，但也许只是我编写了错误的代码。如果你想确定的话，只需打印一个小型 mnesia 数据库的备份日志来检查备份术语格式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-06T14:34:33.020

我很难让它工作，所以我将分享我经历的步骤。

首先备份分布式系统中要恢复的节点（到单个节点）：

```
> mnesia:backup("/path/to/backup"). 
```

`change_node_name`确保在要恢复到的节点上可以使用以下适配：

```
-module(move_backup).
-export([set_node_name/4]).                                                                                                    

set_node_name(From, To, Source, Target) ->
    Switch =
        fun (Nodes) ->
                case lists:member(From, Nodes) of
                    true -> [To];
                    false -> []
                end
        end,
    Convert =
        fun({schema, db_nodes, Nodes}, Acc) ->
                {[{schema, db_nodes, Switch(Nodes)}], Acc};
           ({schema, version, Version}, Acc) ->
                {[{schema, version, Version}], Acc};
           ({schema, cookie, Cookie}, Acc) ->
                {[{schema, cookie, Cookie}], Acc};
           ({schema, Tab, CreateList}, Acc) ->
                Keys = [ram_copies, disc_copies, disc_only_copies],
                OptSwitch =
                    fun({Key, Val}) ->
                            case lists:member(Key, Keys) of
                                true -> {Key, Switch(Val)};
                                false-> {Key, Val}
                            end
                    end,
                {[{schema, Tab, lists:map(OptSwitch, CreateList)}], Acc};
           (Other, Acc) ->
                {[Other], Acc}
        end,
    mnesia:traverse_backup(Source, Target, Convert, switched). 
```

转换备份：

```
> move_backup:set_node_name('before@host', 'after@host', "/path/to/backup", "/path_to_backup_converted"). 
```

我将假设新节点完全为空（如果不是这种情况，您可能需要更改`default_op`参数）。有两种选择，一种用于实时恢复：

```
> mnesia:restore("/path/to/backup_converted", [{default_op, recreate_tables}]). 
```

这很好，但如果您有一个大型数据库（我的数据库约为 10GB，因此这导致内存不足异常），可能会使用大量内存。另一种方法是安装一个后备，然后重新启动你的 shell：

```
> mnesia:install_fallback("/path/to/backup_converted").
> q(). 
```

然后当您重新启动 shell（假设您使用正确的节点名称）时，它将导入完整的数据库。

# ruby-on-rails - 当我按下 ^C 时如何使自动测试只运行集成测试

> ID：10154417
> 
> 赞同：0
> 
> 时间：2012-04-14T14:38:47.117
> 
> 标签：ruby-on-rails, ruby, autotest

自动测试中是否有任何钩子可以使它像这样工作：跳过运行集成测试（因为它们很慢），除非我按下`^C`运行所有​​测试？

作为额外的奖励，如果我修改特定的集成测试，它应该由自动测试正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:18:00.990

一个月过去了，没有答案，所以我将发布我是如何临时解决问题的。**任何真正的解决方案仍然值得赞赏。**

现在，我正在运行自动测试，如下所示：

```
autotest -w -f -c 
```

这些选项意味着：

```
-f, --fast-start                 Do not run full tests at start
-c, --no-full-after-failed       Do not run all tests on red->green
-w, --warnings                   Turn on ruby warnings 
```

因此，每当我触摸任何文件时，`autotest`为它运行测试，当出现问题时，它会继续运行测试，直到它被修复，但之后没有完整的测试运行。当我准备好运行整个套件时（例如，在提交之前），我会按下`^C`它（整个套件需要大约 8 分钟才能通过）。

这对我有用，但并不完美。我宁愿不使用`-c`选项，而是让整个套件（但**没有集成测试**）在 red->green 上运行。`^C`仅当我按下时（或任何其他可能的方式，但仅在我需要时）才应包含集成测试。

有什么想法吗？

# c# - 在数组中选择 datagridview 列中的元素

> ID：10154419
> 
> 赞同：1
> 
> 时间：2012-04-14T14:39:38.147
> 
> 标签：c#, datagridview

我有一个 2 列的 DataGridView，有 150 个数据 => 150 行。

我想要做的是设法从第一列中获取所有值并将它们添加到一个数组中，就像这样

```
for ( int i=1; i<150; i++) 
    array[i] = ..... ?! .... ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:18:56.630

如果是 Windows 窗体 DataGridView，您可以使用：-

```
for ( int i=1; i<150; i++) 
  array[i] = MyDataGridView[1,i].value ;
or
  array[i]=  MyDataGridView.Rows[i].Cells[1].Value; 
```

# javascript - Javascript注册事件监听器

> ID：10154420
> 
> 赞同：1
> 
> 时间：2012-04-14T14:39:54.520
> 
> 标签：javascript, event-handling

在我的应用程序中，我有几个不同的小部件。当一个人做出改变时，其他人也需要改变。我想让它们解耦。我没有做过太多的 javascript 编程，所以我不太确定这样做的典型方法是什么。

jquery 中是否有任何排队机制，所以我可以发布一个事件，上面写着“prop X changed value Y”并且可以通知注册到该队列的任何人？或者这不是在 javascript 中处理事件的典型方式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:16:31.910

在 jquery 中它很简单，并且您使用与标准事件相同的机制。

```
//register listener for "widget"
$("div#firstWidget").bind("myCustomEvent", function(e){
    alert(e.customFlag);
});

//somewhere else trigger event on widget
var e = $.Event("myCustomEvent");
e.customFlag = "customValue";
$("div#firstWidget").trigger(e); 
```

您还可以提供一个全局事件总线，创建 emtpy jquery 对象来保存和调度事件

```
window.myEventBus = $([]);

//register listener
myEventBus.bind("customEvent", function(e){
    //handle event
});

//fire event
myEventBus.trigger($.Event("customEvent", { numProp:5, boolProp:true })); 
```

# arrays - 从制表符分隔的文本文件列制作数组

> ID：10154424
> 
> 赞同：2
> 
> 时间：2012-04-14T14:40:20.173
> 
> 标签：arrays, perl, parsing, csv

我想知道是否有人可以用 perl 帮助绝望的新手解决以下问题。我整天都在尝试，但是在工作中使用我的 perl 书时，我似乎在 google 中找不到任何相关的东西......或者也许我真的很愚蠢。

我有一个类似于以下内容的文件：

```
Bob     April
Bob     April
Bob     March
Mary    August
Robin   December
Robin   April 
```

我追求的输出文件是：

```
Bob     April April March
Mary    August
Robin   December April 
```

这样它就会按照每个人出现的顺序列出每个月。

我试着把它变成一个散列，但它当然不会让我有重复，所以我想我想为每个名字（在这个例子中，鲍勃、玛丽和罗宾）都有数组。我害怕上传我一直在尝试调整的代码，因为我知道这将是非常错误的。我想我需要定义（？）数组。这是正确的吗？

任何帮助将不胜感激，我保证在此期间我将更多地研究 perl。

感谢您的时间、耐心和帮助。

```
#!/usr/bin/perl -w

while (<>) {
    chomp;
    if (defined $old_name) {
        $name=$1;
        $month=$2;
        if ($name eq $old_name) { 
            $array{$month}++;   
            }
        else { 
            print "$old_name";
            foreach (@array)  { 
                push (@array, $month);
                print "\t@array";
                }
            print "\n";
            @array=(); 
            $array{$month}++; 
            }
        }
    else { 
        $name=$1;
        $month=$2;
        $array{month}++;
        }
    $old_name=$name; 
    }
print "$old_name"; 
foreach (@array)  {
    push (@array, $month);
    print "\t@array";
    }
print "\n"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:59:43.300

对于这样一个简单的任务，您的代码看起来过于复杂。

```
use strict;
use warnings;

my %hash;
while (<DATA>) {
    my ($name, $mon) = split;
    push @{$hash{$name}}, $mon;
}

for my $name (keys %hash) {
    my @months = @{$hash{$name}};
    print "$name\t@months\n";
}    
__DATA__
Bob     April
Bob     April
Bob     March
Mary    August
Robin   December
Robin   April 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:20:52.097

你有点接近。您确实希望使用名称作为键的散列，但是正如您所看到的，对于每个要存储月份**数组**的名称，因此您要使用的数据结构是数组的散列（或者更确切地说是数组引用, 因为这是在 Perl 中实现的)

在此过程中，请不要养成使用全局变量的习惯 - 100% 的代码应该以“ `use strict; use warnings;`”开头，以及局部作用域 ( `my`) 变量。

```
use strict;
my %data;
my @sorted_names; # Only needed if you care which order to print the results
while (<>) {
    chomp;
    my ($name, $month) = split(/s+/);
    if (! $data{$name}) {
        # Initialize to empty array reference if first time. 
        # Not required - perl will do it for you
        $data{$name} ||= []; 
        # Only needed if you want to print results in the same order of names as input.
        push @sorted_names, $name;
    }
    push @{ $data{$name} }, $month;
}

foreach my $name (@sorted_names) {
    print "$name\t" . join(" ", @{ $data{$name} }) . "\n";
}
# If don't care about name order, just do "foreach my $name (keys %data) {" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T23:17:05.643

***脚本：***

```
#!/usr/bin/perl
use strict;
use warnings;

my %content;
open my $fh, '<file.txt' or die $!;
while (<$fh>) {
  push @{$content{$1}}, $2 if /^(\S+)\s+(\S+)\s*$/;
}
close $fh;
foreach (keys %content) {
  print $_, "\t";
  foreach my $item (@{$content{$_}}) {
    print "$item ";
  }
  print "\n";
} 
```

或者

```
#!/usr/bin/perl
use strict;
use warnings;

my %content;
open my $fh, '<file.txt' or die $!;
while (<$fh>) {
  push @{$content{$1}}, $2 if /^(\S+)\s+(\S+)\s*$/;
}
close $fh;
print "$_\t@{$content{$_}}\n" for keys %content; 
```

或者

```
#!/usr/bin/perl
use strict;
use warnings;

my %content;
open my $fh, '<file.txt' or die $!;
s/^(\S+)\s+(\S+)\s*$/{push @{$content{$1}}, $2}/e for <$fh>;
close $fh;
print "$_\t@{$content{$_}}\n" for keys %content; 
```

***输出：***

```
Bob     April April March 
Mary    August 
Robin   December April 
```

对于`file.txt`包含内容的文件：

```
Bob     April
Bob     April
Bob     March
Mary    August
Robin   December
Robin   April 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T15:00:54.680

一个简单的方法是使用 perl 的 push 和 pop 函数。（因为你开始使用 perl：[http](http://perldoc.perl.org/functions/pop.html) ://perldoc.perl.org/functions/pop.html，http : [//perldoc.perl.org/functions /push.html](http://perldoc.perl.org/functions/push.html)）你应该为每个名字（例如@bobmonths）保留一个全局数组，并在每次找到一个时推送一个月。完成后，打印出名称和数组：

```
while(<>)
{
chomp;
push(@bobmonths, $2)

...
}
print @bobmonths 
```

# python - 可以使用 cmd ">>" 记录 Django 开发服务器吗？

> ID：10154427
> 
> 赞同：3
> 
> 时间：2012-04-14T14:40:37.550
> 
> 标签：python, django, python-2.7

是否可以将 Django 的 runserver 输出输出到文本文件中？如：

`python manage.py runserver>>Log.txt`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T14:52:06.730

Django 使用 python[日志记录](http://docs.python.org/library/logging.html)模块，您可以将其[配置](https://docs.djangoproject.com/en/dev/topics/logging/#an-example)`settings.py`为输出到文件中。

[给你的例子](https://stackoverflow.com/questions/5739830/simple-log-to-file-example-for-django-1-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-07T04:32:35.603

您可以通过在`settings.py`. 这既会在级别写入日志文件，`DEBUG`也会在级别的控制台上显示`INFO`。

```
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'file': {
            'level': 'DEBUG',
            'class': 'logging.handlers.RotatingFileHandler',
            'filename': /path/to/django/debug.log,
            'maxBytes': 50000,
            'backupCount': 2,
        },
        'console': {
            'level': 'INFO',
            'class': 'logging.StreamHandler',
        },
    },
    'root': {
        'handlers': ['file', 'console'],
        'level': 'DEBUG'
    },
    'loggers': {
        'django': {
            'handlers': ['file', 'console'],
            'level': 'DEBUG',
            'propagate': True,
        },
    },
} 
```

另请查看[Django 文档](https://docs.djangoproject.com/en/2.0/topics/logging/)以获取更多信息。

# java - 使用 Jodatime 将持续时间 PT01H00M 转换为期间

> ID：10154428
> 
> 赞同：1
> 
> 时间：2012-04-14T14:40:39.307
> 
> 标签：java, jodatime

我有一大堆持续时间字符串，我想用 Jodatime 将其转换为句点

我尝试了 ISOPeriodFormat：

```
PeriodFormatter pf = new   PeriodFormatterBuilder().append(ISOPeriodFormat.standard()).toFormatter();

Period period = pf.parsePeriod("PT01H00M"); 
```

但这会带来以下错误：java.lang.IllegalArgumentException: Invalid format: "PT01H00M" is malformed at "01H00M"

将此字符串转换为句点的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:46:46.833

```
PeriodFormatter yearsAndMonths = new PeriodFormatterBuilder()
     .appendSeparator("PT")
     .appendHours()
     .appendSeparator("H")
     .appendMinutes()
     .appendSeparator("M")
     .toFormatter(); 
```

对于这个字符串。

# javascript - 带有换行符的 JavaScript 字符串 - 但不使用 \n

> ID：10154429
> 
> 赞同：74
> 
> 时间：2012-04-14T14:40:51.850
> 
> 标签：javascript, string

我有一个包含新行的字符串。我想将它们转换为 HTML `<br>`，但我很难检测到它们。

想象一个这样的 JavaScript 字符串集：

```
var foo = "Bob
is
cool"; 
```

它们是我需要检测的那种新线。他们没有使用`\n`特殊字符 - 它们只是普通格式。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-04-14T14:59:44.250

它不起作用的原因是javascript字符串必须在下一个换行符之前终止（`\n`显然不是）。存在的原因`\n`是允许开发人员以一种简单的方式将换行符 (ASCII: 10) 放入他们的字符串中。

当你有一个看起来像这样的字符串时：

```
//Note lack of terminating double quote
var foo = "Bob 
```

您的代码此时将出现语法错误并停止运行。

如果您希望有一个跨越多行的字符串，您可以`\`在终止该行之前插入一个反斜杠字符 ' '，如下所示：

```
//Perfectly valid code
var foo = "Bob \
is \
cool."; 
```

但是，该字符串**不会**`\n`在字符串被分成单独的行的位置包含字符。在字符串中插入换行符的唯一方法是插入一个值为 10 的字符，最简单的方法是`\n`转义字符。

```
var foo = "Bob\nis\ncool."; 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2016-10-30T23:20:26.917

**更新：**我刚刚在 JavaScript-ES6 中[遇到](https://stackoverflow.com/a/805113/1454514)了一个很棒的语法设计，称为[Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals#Syntax)。您想要做的事情可以从字面上使用```（反引号或重音字符）来完成。

```
var foo = `Bob
is
cool`; 
```

在这种情况下，`foo === "Bob\nis\ncool"`是真的。

为什么设计师决定`` ... ``可以不终止，但是其中`" ... "`包含`' ... '`换行符是非法的，这超出了我的理解。

只要确保目标浏览器支持 ES6 指定的 Javascript 实现即可。

* * *

PS 此语法还支持 PHP、.NET 和其他一些脚本语言中的一个非常酷的特性；即“[标记模板文字](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals#Tagged_template_literals)”，您可以使用它来构建参数化字符串，如下所示：

```
var a = 'Hello', b = 'World';
console.log(`The computer says ${ a.toUpperCase() }, ${b}!`);
// results in "The computer says HELLO, World!" 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-14T14:43:23.827

检查`\n`或`\r`或`\r\n`。

换行符有几种表示形式，请参阅[http://en.wikipedia.org/wiki/Newline#Representations](http://en.wikipedia.org/wiki/Newline#Representations)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-14T14:44:04.553

我认为他们`\n`无论如何都在使用它甚至不可见，或者他们使用`\r`. 所以只需替换`\n`或`\r``<br/>`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-14T14:44:25.010

我认为您不了解 \n 的工作原理。结果字符串仍然只包含一个值为 10 的字节。这在 javascript 源代码中用 \n 表示。

您发布的代码片段实际上不起作用，但如果它起作用，则换行符*将*等同于 \n，除非它是 windows 样式的换行符，在这种情况下它将是 \r\n。（但即使替换仍然有效）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-06-23T09:06:07.100

这是上面@Andrew Dunn 帖子的一个小补充

结合2可以生成可读的JS和匹配的输出

```
 var foo = "Bob\n\
    is\n\
    cool.\n\"; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-14T14:44:35.570

您可以使用以下功能：

```
 function nl2br (str, is_xhtml) {
     var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br />' : '<br>';
     return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
  } 
```

像这样：

```
var mystr="line\nanother line\nanother line";
mystr=nl2br(mystr);
alert(mystr); 
```

这应该提醒`line<br>another line<br>another line`

该函数的来源来自这里： [http ://phpjs.org/functions/nl2br:480](http://phpjs.org/functions/nl2br:480)

这模仿了`nl2br`php中的功能......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-03T09:08:46.937

我用来在 JS 中转义换行符的查询字符串： `LOAD DATA LOCAL INFILE 'Data.csv' INTO TABLE DEMO FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\r\n' IGNORE 1 ROWS;`

这涉及到新的 ES6 语法 - Template Literals `` 我尝试将 '\n' 更改为 '\r\n' 并在我的情况下完美运行。

PS：这个例子是我将 CSV 数据上传到 mysql DB 的查询。

# javascript - 是否可以在放大 safari mobile 的同时逐步提高图像质量

> ID：10154437
> 
> 赞同：0
> 
> 时间：2012-04-14T14:42:02.227
> 
> 标签：javascript, jquery, iphone

是否有任何 JavaScript/jQuery 插件可以拍摄大图像并在缩放时提高质量？谷歌地球/地图之类的东西？

我想在移动浏览器中使用它，但桌面解决方案也可以

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:18:26.723

我不知道有任何插件可以做到这一点，但理论上很容易：

要知道移动 Safari 的缩放比例，您只需检查这个比例：`document.body.clientWidth / window.innerWidth`。

然后，只需要选择正确的事件来监听（调整大小，或者可能是触摸事件），检查这个缩放级别并替换你的 img。

# android - 适用于 Android 的 Webkit 组件

> ID：10154454
> 
> 赞同：3
> 
> 时间：2012-04-14T14:43:49.260
> 
> 标签：android, webkit

除标准 WebView 外，是否有适用于 Android 的 Webkit 组件/类？我已经受够了，它具有超级重复的非禁用选项，例如触摸时的图像抖动等。

我正在寻找一个很容易嵌入到 hello-world 应用程序中的组件，因为我是 Android 开发的新手。实际上，我的整个应用程序是 HTML5 网络应用程序，我只需要一种不扭曲的方式来呈现它。

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:35:34.680

它可能不会比使用 WebView 更容易，尤其是如果您是初学者。但请查看[android.webkit 包](http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/)中的各种类。点击链接并在左侧的文件夹中展开 android->webkit。

# html - 根据其内容的 div 大小

> ID：10154455
> 
> 赞同：0
> 
> 时间：2012-04-14T14:43:53.133
> 
> 标签：html, css

我目前正在创建一个网站，我需要根据其中一个孩子的偏移量来调整 div 的大小。所以，我这样做：

```
<script type="text/javascript">

      $(document).ready(function(){ 
        if($(sizer)[0].scrollHeight > 500)
        {
            $(maincnt).height( ($(sizer)[0].scrollHeight + 300) );
        }
      });

</script> 
```

但是，问题是 Firefox 没有触发该事件。但是使用chrome它可以工作。有没有更干净的方法来分配 div 大小？如果没有，有没有办法让它被 Firefox 触发？这是我的 HTML 代码：

```
<div id="maincnt" >
<div style="position:relative;">
<div id="sizer" style="position:absolute;top:12px;left:10px;width:750px;">
   <!-- Dynamically added things -->
</div>
</div>
</div> 
```

编辑：我放弃了，我找到了解决我的第一个问题的另一种解决方法，而不是 JQuery 问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:28:08.880

这个问题几乎可以肯定是由于您将 DOM 元素视为 JS 预先填充了 ID 作为变量。

尝试`$('#sizer')`并`$('#maincnt')`代替您当前拥有的那些。

另外，你为什么要使用绝对定位的元素呢？将其设置为： 有什么问题`margin: 12px 0px 0px 10px; width: 750px;`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:59:49.767

问题可能是当触发 DOMready 事件时，浏览器尚未计算所有宽度和高度。DOMready 事件在页面结构准备好使用时触发，而不是在 css 加载时触发。

尝试在 load 事件上做这种工作，当页面的所有资源被加载时触发，包括 css：

```
$(window).load(function(){ 
    if($(sizer)[0].scrollHeight > 500) {
        $(maincnt).height( ($(sizer)[0].scrollHeight + 300) );
    }
}); 
```

# android - tts应用力关闭

> ID：10154458
> 
> 赞同：0
> 
> 时间：2012-04-14T14:44:12.153
> 
> 标签：android, text-to-speech

错误消息
The constructor TextToSpeech(SQLiteExample, SQLiteExample) is undefined 04-16 04:06:19.860: E/AndroidRuntime(1728): Caused by: java.lang.ClassCastException: com.sql.SQLiteExample error line

```
myTts = new TextToSpeech(this,  this); 
```

在 onCreate 方法中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:30:39.520

错误的是，您没有在`TextToSpeech`.as 文档中传递正确的参数[：](http://developer.android.com/reference/android/speech/tts/TextToSpeech.html#TextToSpeech%28android.content.Context,%20android.speech.tts.TextToSpeech.OnInitListener%29)

```
TextToSpeech (Context context, TextToSpeech.OnInitListener listener) 
```

*context*：此实例正在运行的上下文。

*listener* : TextToSpeech.OnInitListener 将在 TextToSpeech 引擎初始化时调用。

# database - 在 Google App Engine 中更新实体组

> ID：10154459
> 
> 赞同：1
> 
> 时间：2012-04-14T14:44:24.710
> 
> 标签：database, google-app-engine

我试图更多地了解实体组如何在 GAE 中工作。在文档中的几个地方，它指的是“你只能期望每秒更新任何单个实体或实体组大约五次。”，而在其他地方它说多个用户同时写入同一个实体组时间只会导致其中一个成功（如果我理解正确的话）。因此，如果我有一个拥有 100 万个用户实体的实体组 Users，那么在任何给定时间只有 1 个用户能够更新他的记录，而其他任何尝试过的人都会失败？我只是不了解实体组。如果我理解正确，它们有点像文件夹？但我不明白为什么多个用户不能同时更新同一个实体组？

实体组只是一个结构性的东西吗？如果我有一百万个用户，他们是否都分组在一个实体组用户中（如果我指定的话）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T19:31:11.593

在您的情况下，用户是一种。

通过定义实体之间的[祖先关系](https://developers.google.com/appengine/docs/python/datastore/entities#Ancestor_Paths)来定义实体组。它们很重要，因为它们定义了[事务的范围](https://developers.google.com/appengine/docs/python/datastore/entities#Transactions_and_Entity_Groups)。

实体组的局限性在于它们的写入速率有限。

如果未定义祖先关系，则实体是实体组中的唯一实体。写入限制仍然适用于该实体。

在定义实体组时，重要的是要使它们尽可能小并组织它们以避免争用（并行写入）。一种常见的方法是使用户实体成为实体组的根。

# php - MySQL InnerJoin 有限制吗？

> ID：10154466
> 
> 赞同：5
> 
> 时间：2012-04-14T14:44:59.727
> 
> 标签：php, mysql, inner-join

我有这个查询来收集有关单个订单的信息，它变得非常复杂。

我没有任何要测试的数据，所以我问，如果有人在小型和大型数据集中有这方面的经验，你可以或应该在单个查询中进行多少个连接是否有限制？是否建议将大型查询拆分为较小的部分，或者这不会产生重大影响？

`WHERE`另外，在每个之后都有一个条款是否合法`INNER JOIN`？

谢谢你的建议。

这是查询：

```
# Order: Get Order

function getOrder($order_id) {
    $sql = "SELECT (order.id, order.created, o_status.status,
                    /* payment info */
                    order.total, p_status.status,
                    /* ordered by */
                    cust_title.title, cust.forename, cust.surname,
                    customer.phone, customer.email,
                    cust.door_name, cust.street1,
                    cust.street2, cust.town,
                    cust.city, cust.postcode,
                    /* deliver to */
                    recip_title.title, recipient.forename, recipient.surname,
                    recipient.door_name, recipient.street1,
                    recipient.street2, recipient.town,
                    recipient.city, recipient.postcode,
                    /* deliver info */
                        shipping.name, order.memo,
                    /* meta data */
                    order.last_update)
              FROM tbl_order AS order

        INNER JOIN tbl_order_st AS o_status
                ON order.order_status_id = o_status.id

        INNER JOIN tbl_payment_st AS p_status
                ON order.payment_status_id = p_status.id

        INNER JOIN (SELECT (cust_title.title, cust.forename, cust.surname,
                            customer.phone, customer.email,
        /* ordered by */    cust.door_name, cust.street1,
                            cust.street2, cust.town,
                            cust.city, cust.postcode)
                      FROM tbl_customer AS customer
                INNER JOIN tbl_contact AS cust
                          ON customer.contact_id = cust.id
                INNER JOIN tbl_contact_title AS cust_title
                        ON cust.contact_title_id = cust_title.id
                     WHERE order.customer_id = customer.id)
                ON order.customer_id = customer.id

        INNER JOIN (SELECT (recip_title.title, recipient.forename, recipient.surname,
        /* deliver to */    recipient.door_name, recipient.street1,
                            recipient.street2, recipient.town,
                            recipient.city, recipient.postcode)
                      FROM tbl_contact AS recipient
                INNER JOIN tbl_contact_title AS recip_title
                        ON recipient.contact_title_id = recip_title.id
                     WHERE order.contact_id = recipient.id)
                ON order.contact_id = recipient.id

        INNER JOIN tbl_shipping_opt AS shipping
                ON order.shipping_option_id = shipping.id

             WHERE order.id = '?';";
    dbQuery($sql, array((int)$order_id));
    $rows = dbRowsAffected();
    if ($rows == 1)
        return dbFetchAll();
    else
        return null;
} 
```

由于有人为此查询请求了架构，因此它是：

```
# TBL_CONTACT_TITLE

DROP TABLE IF EXISTS tbl_contact_title;
CREATE TABLE tbl_contact_title(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    title CHAR(3)
) ENGINE = InnoDB;
INSERT INTO tbl_contact_title
    (title)
VALUES  ('MR'),
    ('MRS'),
    ('MS');

# TBL_CONTACT

DROP TABLE IF EXISTS tbl_contact;
CREATE TABLE tbl_contact(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    contact_title_id INT,
    FOREIGN KEY(contact_title_id) REFERENCES tbl_contact_title(id) ON DELETE SET NULL,
    forename VARCHAR(50),
    surname VARCHAR(50),
    door_name VARCHAR(25),
    street1 VARCHAR(40),
    street2 VARCHAR(40),
    town VARCHAR(40),
    city VARCHAR(40),
    postcode VARCHAR(10),
    currency_id INT,
    FOREIGN KEY(currency_id) REFERENCES tbl_currency(id) ON DELETE SET NULL
) ENGINE = InnoDB;

# TBL_CUSTOMER

DROP TABLE IF EXISTS tbl_customer;
CREATE TABLE tbl_customer(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    contact_id INT,
    FOREIGN KEY(contact_id) REFERENCES tbl_contact(id) ON DELETE SET NULL,
    birthday DATE,
    is_male TINYINT,
    phone VARCHAR(20),
    email VARCHAR(50) NOT NULL
) ENGINE = InnoDB, AUTO_INCREMENT = 1000;

# TBL_ORDER_ST

DROP TABLE IF EXISTS tbl_order_st;
CREATE TABLE tbl_order_st(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    status VARCHAR(25)
) ENGINE = InnoDB;
INSERT INTO tbl_order_st
    (status)
VALUES
    ('NEW'),
    ('PROCESSING'),
    ('SHIPPED'),
    ('COMPLETED'),
    ('CANCELLED');

# TBL_SHIPPING_OPT

DROP TABLE IF EXISTS tbl_shipping_opt;
CREATE TABLE tbl_shipping_opt(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    name VARCHAR(50),
    description VARCHAR(255),
    cost DECIMAL(6,3)
) ENGINE = InnoDB;
INSERT INTO tbl_shipping_opt
    (name, description, cost)
VALUES
    ('UK Premier', 'U.K. Mainland upto 30KG, Next Working Day', 8.00),
    ('Europe Standard', 'Most European Destinations* upto 30KG, 2 to 5 Working Days *please check before purchase', 15.00);

# TBL_PAYMENT_ST

DROP TABLE IF EXISTS tbl_payment_st;
CREATE TABLE tbl_payment_st(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    status VARCHAR(25)
) ENGINE = InnoDB;
INSERT INTO tbl_payment_st
    (status)
VALUES
    ('UNPAID'),
    ('PAID');

# TBL_ORDER

DROP TABLE IF EXISTS tbl_order;
CREATE TABLE tbl_order(
    id INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY(id),
    customer_id INT,
        FOREIGN KEY(customer_id) REFERENCES tbl_customer(id) ON DELETE SET NULL,
    contact_id INT,
    FOREIGN KEY(contact_id) REFERENCES tbl_contact(id) ON DELETE SET NULL,
    created DATETIME,
    last_update TIMESTAMP,
    memo VARCHAR(255),
    order_status_id INT,
    FOREIGN KEY(order_status_id) REFERENCES tbl_order_st(id),
    shipping_option_id INT,
    FOREIGN KEY(shipping_option_id) REFERENCES tbl_shipping_opt(id),
    coupon_id INT,
    FOREIGN KEY(coupon_id) REFERENCES tbl_coupon(id) ON DELETE SET NULL,
    total DECIMAL(9,3),
    payment_status_id INT,
    FOREIGN KEY(payment_status_id) REFERENCES tbl_payment_st(id)
) ENGINE = InnoDB, AUTO_INCREMENT = 1000; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:29:28.387

你没有任何地方接近 MySQL 的 JOIN 限制。你的加入数量还不错。但是，在执行操作时加入派生表（您的内部子查询）可能会导致性能问题，因为派生表没有索引。在没有索引的派生表上执行连接可能会很慢。

您应该考虑制作一个带有用于连接的索引的真正临时表，或者想办法避免子查询。

MySQL 中的 JOIN 基本上就像对每个连接的行进行查找（查找）。因此，如果您要连接许多记录，MySQL 将不得不执行许多查找。与加入多少表相比，加入多少行才是问题所在。

无论如何，MySQL 在放弃并读取整个表之前只会执行这么多次查找。它在决定哪个更便宜方面做得很好。

也许您能做的最好的事情是通过使用 ANALYZE TABLE 更新索引统计信息来帮助它猜测。

每个 SELECT 可以有一个 WHERE 子句。因此，您的内部子查询将有一个 WHERE 子句，而您的外部查询将有一个 WHERE 子句，并且在 JOIN 之后应用它们（至少在逻辑上，尽管 MySQL 通常会首先应用它们以提高性能）。

此外，所有这些都假设您知道如何正确使用索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:13:40.673

好吧，我曾经亲自尝试过查看连接数的限制，如果我没记错的话，我在 mysql 5.0.4 上测试了一个包含 100 个表的连接。

我收到以下错误：

> 桌子太多。MySQL 在一个连接中只能使用 61 个表。

我认为 MySql 4 的限制是 31 个表。

如果您打算在查询中使用这么多表，那么是时候开始考虑简化查询设计了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-26T23:15:34.337

我也在寻找这个，然后我找到了另一个解决方案，将“AND”添加为 JOIN 的一部分。

```
INNER JOIN kopplaMedlemIntresse 
ON intressen.id = kopplaMedlemIntresse.intresse_id AND kopplaMedlemIntresse.medlem_id = 3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T14:52:54.247

我没有任何一般性的建议，只是我自己的经验。

我曾经遇到过性能非常差的问题，我使用 JOIN 添加了大量表。我做了大约 20 JOIN。当我在测试中删除了一些 JOINS 时，速度又提高了。由于我只需要单个信息，因此我能够用子选择替换大部分 JOINS。这解决了我的问题，从查询的 25 秒缩短到不到 1 秒。

这可能是您的表设计、连接表的列数以及连接 where 子句上的索引的事实。

# javascript - 取消隐藏 asp 按钮 onclick 的 html 按钮

> ID：10154469
> 
> 赞同：0
> 
> 时间：2012-04-14T14:45:51.720
> 
> 标签：javascript, asp.net

我的页面上有 2 个按钮。第一个是 html 按钮，下一个是 asp 按钮。现在我想在页面加载时隐藏 asp 按钮，并想在 html 按钮的 onclick 上取消隐藏。谁能帮我这个 ？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:56:05.487

**.aspx html/javascript 代码**

```
<head>
function UnhideButtons(buttonName){
if(buttonName == 'aspButton'){
document.getElementbyId(htmlButton).visiblity = "visible";
}
}
</head>

<body>
<asp:Button id="aspButton" style="visibility:hidden" Text="ASP Button"/>
<Button id="htmlButton" text="HTML Button" onClick=UnhideButtons("aspButton")
</body> 
```

# vb.net - 调用表单并冻结

> ID：10154470
> 
> 赞同：1
> 
> 时间：2012-04-14T14:45:54.797
> 
> 标签：vb.net, invoke

我的问题有点复杂：

我有 Socket 服务器，我有两种形式。一种是服务器的主要形式，另一种是定制的消息框。当请求到达服务器时，主表单必须调用第二个表单（消息框）。当主窗体第一次打开时，一切正常。但是当我关闭主窗体而不关闭应用程序并再次打开它并且请求到达服务器时，定制的消息框打开但它冻结并看起来像这样：

![在此处输入图像描述](../Images/cd0f5867c3f650ca4660dd03214d1962.png)

调用代码：

```
Private Delegate Sub DInvoke(ByRef Frm As Form, ByVal Text As String, ByVal Title As String, ByVal Socket As Integer, ByVal DataX As String, ByVal ReqForProfil As Boolean)

Public Sub ShowMessage(ByRef Frm As Form, ByVal Text As String, ByVal Title As String, ByVal Socket As Integer, ByVal DataX As String, ByVal ReqForProfil As Boolean)
    If Frm.InvokeRequired Then
        Dim DT As New DInvoke(AddressOf ShowMessage)
        Frm.Invoke(DT, New Object() {Frm, Text, Title, Socket, DataX, ReqForProfil})
    Else
        Messegar = New MessageFrm(Text, Title, Socket, DataX, ReqForProfil, True, 30)
        Messegar.Show()
    End If
End Sub 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:21:32.597

调试它。在 InvokeRequired 上设置断点。您知道这应该是正确的，因为该方法是从 I/O 完成线程调用的。您描述的问题与返回 False 的属性一致。所以 Invoke 不会发生，表单是*在*工作线程而不是 UI 线程上创建的。由于该线程没有发送消息循环，因此它已经死了。

这总是由传递错误的表单对象引起的。就像“Form1”，一个类型而不是一个对象，一个讨厌的 VB.NET 陷阱。或者传递“new Form1”，一个表单对象的新实例，而不是用户正在查看的那个。

Q&D 修复是通过 Application.OpenForms(0) 代替。一个干净的解决方法是将有效的表单引用传递给与套接字一起使用的类的构造函数。

# cross-platform - 等到命令队列完成所有排队的作业

> ID：10154473
> 
> 赞同：0
> 
> 时间：2012-04-14T14:46:18.160
> 
> 标签：cross-platform, opencl

我有一个算法可以在多个设备之间安排子任务来解决 main_task。它将内核排入所有命令队列并附加一个带有回调的事件。在此回调中，我检查我的 main_task 是否已完成，如果未完成，则将另一个子任务排入队列。否则，我将共享变量`is_main_task_done`设置`true`为通知其他命令队列它们应该停止对子任务进行排队。

同时，我必须以某种方式阻止主机的主线程退出，直到`is_main_task_done`设置为`true`. 有跨平台解决方案吗？到目前为止，我在 AMD 的指南中只找到了自旋锁解决方案：

```
while (!is_main_task_done)
 sleep(0) 
```

但它似乎仅适用于 Windows。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:53:20.023

在这里使用信号量是个好主意。使用您希望运行的任务数初始化信号量，并确保仅此数字运行。

# android - ActionBarCompat - 如何使用它

> ID：10154476
> 
> 赞同：11
> 
> 时间：2012-04-14T14:47:09.743
> 
> 标签：android, android-actionbar, android-actionbar-compat

我正在尝试在我自己的项目中使用 ActionBarCompat。我已经打开了示例项目（http://developer.android.com/resources/samples/ActionBarCompat/index.html），但我不知道如何自己实现它。

我找不到任何类型的教程。我应该把这个项目作为图书馆吗？有人可以给我一些指示吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-25T14:12:40.150

至于实现，只要坚持`MainActivity.java`类下提供的示例代码即可。您可以在[此处](http://developer.android.com/resources/samples/ActionBarCompat/src/com/example/android/actionbarcompat/MainActivity.html)或下方找到它`<your local android-sdks folder>/samples/android-15/ActionBarCompat/src/com/example/android/actionbarcompat/MainActivity.java`。一般来说，您需要做的就是：

1.  编写一个菜单资源，在其中声明操作栏的项目（参见[http://developer.android.com/resources/samples/ActionBarCompat/res/menu/main.html](http://developer.android.com/resources/samples/ActionBarCompat/res/menu/main.html)）
2.  编写一个扩展的 Activity`ActionBarActivity`
3.  覆盖`onCreateOptionsMenu()`，使其膨胀您在步骤 #1 中编码的菜单
4.  覆盖`onOptionsItemSelected()`，以便您在用户点击您在步骤 #1 中定义的任何 ActionBar 项目时处理该事件。

我认为用 ActionBarCompat 代码构建一个 Android 库项目是有意义的；那么您可以从您的自定义 Android 项目中引用它。请记住，它是根据*Apache 许可证 2.0 版*获得许可的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-28T00:44:09.447

这个答案描述了如何使用新的 ActionBarCompat 库（2013 年 7 月）。

在**Android Studio**中，打开`build.gradle`并添加：

```
dependencies {
    compile 'com.android.support:appcompat-v7:18.0.+'
} 
```

在**Eclipse**中，根据其中的代码创建一个[库项目](http://developer.android.com/tools/support-library/setup.html#libs-with-res)`sdk\extras\android\support\v7\appcompat`并将其添加到您的项目中。

活动要延长`ActionBarActivity`。

```
import android.support.v4.view.MenuItemCompat;
import android.support.v7.app.ActionBarActivity;
import android.support.v7.widget.SearchView;
import android.support.v7.app.ActionBar;
import android.view.Menu;
import android.view.MenuItem;

public class MainActivity extends ActionBarActivity {

    ActionBar ab;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        ab = getSupportActionBar();
        ab.setTitle("Test");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);

        MenuItem searchItem = menu.findItem(R.id.action_search);
        SearchView searchView = 
                    (SearchView) MenuItemCompat.getActionView(searchItem);

        return super.onCreateOptionsMenu(menu);
    }
} 
```

主题必须是（或扩展）`Theme.AppCompat`主题之一，例如：

```
<activity android:theme="@style/Theme.AppCompat.Light" ... /> 
```

资料来源：[如何将 ActionBarCompat 添加到您的项目](http://gmariotti.blogspot.de/2013/07/how-to-add-actionbarcompat-to-your.html)中，Gabriele Mariotti 的博客文章

# java - 如何从 HttpResponse 中获取对象？

> ID：10154477
> 
> 赞同：4
> 
> 时间：2012-04-14T14:47:16.723
> 
> 标签：java

我正在尝试将对象从服务器发送到客户端。

客户端：

```
HttpResponse response = client.execute(request); 
```

服务器端：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws  IOException 
{
    PrintWriter out = response.getWriter();
    out.print(new Object());
} 
```

如何从响应中获取对象？
我是否需要改用：

```
OutputStream out = response.getOutputStream(); 
```

如果是这样，哪种方式更有效？
请提供示例代码:)
谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:05:13.180

您不能只发送 Object.toString() 因为它不包含有关对象的所有信息。序列化可能是您需要的。看一下：http: [//java.sun.com/developer/technicalArticles/Programming/serialization/](http://java.sun.com/developer/technicalArticles/Programming/serialization/)
您要发送的对象必须实现可序列化。然后在您的服务器上，您可以使用以下内容：

```
OutputStream out = response.getOutputStream();
oos = new ObjectOutputStream(out);
oos.writeObject(yourSerializableObject); 
```

在客户端，您执行以下操作：

```
in = new ObjectInputStream(response.getEntity().getContent()); //Android
in = new ObjectInputStream(response.getInputStream()); //Java
ObjcetClass obj = (ObjectClass)in.readObject(); 
```

# sql - 如何在下拉列表中添加空白字段

> ID：10154479
> 
> 赞同：0
> 
> 时间：2012-04-14T14:47:56.980
> 
> 标签：sql, drop-down-menu, datasource

我需要在连接到数据库的下拉列表中添加一个空白字段。我尝试使用编辑项目，但它不起作用。

代码：

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:05:14.877

假设您在 C# 和 Asp.NET 中执行此操作，则应该执行此操作

```
dropDown.Items.Insert(0, new ListItem(String.Empty, String.Empty));
dropDown.SelectedIndex = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T16:45:49.853

我发现了如何最终做到这一点，我添加了一个值为 -1 的列表项，并禁用了下拉列表的视图状态。

编码：

```
<asp:DropDownList ID="ddlGroup" runat="server" DataSourceID="getGroup" 
DataTextField="group_name" DataValueField="group_id" AutoPostBack="True" 
onselectedindexchanged="ddlGroup_SelectedIndexChanged" 
AppendDataBoundItems="True" ViewStateMode="Disabled">
     <asp:ListItem Value="-1">Select Group</asp:ListItem>
</asp:DropDownList> 
```

# java - 如何将 x 的值从小到大排列？

> ID：10154481
> 
> 赞同：0
> 
> 时间：2012-04-14T14:48:14.110
> 
> 标签：java, arrays, sorting

```
 for(int i = 0; i < distance.length; i++) {
        for (int j = 0; j < distance.length; j++) {
            if (distance[i] == distance[j]) {
                if (x[i] > x[j]) {
                    x = swapInt(x, j, i);
                    input = swapString(input, j, i);
                }
            }
        }
    } 
```

distance 表示点到原点的距离
x 是点的 x 坐标
输入是用户的原始输入
我希望这个循环按 x 坐标的升序排列点，如果它们的距离相同但是，当我运行它时，它按降序排列
我应该怎么做才能解决这个问题？

```
 public static int[] swapInt (int[] a, int i, int j) {
    int temp = a[i];
    a[i] = a[j];
    a[j] = temp;
    return a;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:54:41.987

改变

```
if (x[i] > x[j]) { 
```

至

```
if (x[i] < x[j]) { 
```

这将改变排序顺序：在原来的情况下，如果 i'th 大于 j'th，则交换两个值，现在在相反的情况下交换它们：j'th 大于 i'th

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-14T15:07:36.113

我会更喜欢以下方式，因为它更干净，可读。

```
class Distance implements Comparable{
int x;
int y;
@Override
public int compareTo(Object o) {
    Distance other=(Distance)o;
    if(this.distanceFromOrigin() > other.distanceFromOrigin())
        return 1;
    else if(this.distanceFromOrigin() < other.distanceFromOrigin())
        return -1;
    else 
        return this.x - other.x;

}
int distanceFromOrigin(){
    return x*x+y*y;
} 
```

}

现在创建一个距离数组/列表并使用 Collections.sort 来获得您想要的顺序。

# python - 如何在 Google App Engine 中删除 Kind 实体本身？

> ID：10154485
> 
> 赞同：0
> 
> 时间：2012-04-14T14:48:44.847
> 
> 标签：python, google-app-engine

我知道每次在 Google App Engine 上重新启动开发服务器时，我的所有数据都会被默认清除，但我需要知道，当我开始部署时，我不仅可以通过编程方式删除所有 Kinds 的实体，还可以删除 Kind实体本身，因为我在开发/部署周期中更改它们。

看着类似的问题，我想出了这个尝试：

```
from model import *
from google.appengine.ext.db import *
from google.appengine.ext.db.metadata import *

for i in Kind.all():
    if i.kind_name == 'Person':
        i.delete() # Try one way
        db.delete(i) # Try another way
        print "Yes"
        break 
```

...但这每次都会打印“是”，表明“人”类没有被删除。这只是开发服务器的工件，还是您永远无法删除 Kind 实体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T04:49:20.130

您不能删除元数据查询返回的 Kind。App Engine 数据存储区有一个动态架构，当您删除一种类型的最后一个实体时，该架构会自动适应。开发应用程序服务器可能在这里有一些滞后 - 或者您可能误认为 Datastore 每次都被删除，因为这不应该发生。是什么让你认为它确实如此？

PS。不要使用 import * 这么多，它会使您的代码更难阅读，并且可能由于名称冲突而导致错误......

# jquery - 分组切换后的jQuery淡入

> ID：10154486
> 
> 赞同：2
> 
> 时间：2012-04-14T14:48:53.640
> 
> 标签：jquery

我有以下内容，但`$("span#slogan").fadeIn("slow");`在 if 语句完成对隐藏元素的循环后不运行。

我怎样才能使它淡入是最后运行的东西？

```
<style type="text/css">
#hidden span{
    display:none;
    float:left;
    font-size:20px;
}
</style>

<script type="text/javascript">
$(document).ready(function()
{   
    function showDiv() {

        if($('#hidden span:not(#slogan)').is(':hidden')) {

            $('#hidden span:not(#slogan):hidden:first').show("bounce", { times:3 }, 500);  
            setTimeout(showDiv, 500);
        }

        $("span#slogan").fadeIn("slow");
    }

    $("button").click(function() {
        showDiv();
    });
});
</script>

<button>Click</button>

<div id="hidden">
    <span>T</span>
    <span>e</span>
    <span>x</span>
    <span>t</span>
    <span id="slogan">Slogan</span>
</div> 
```

**回调**

 **我不能使用回调，`.show`因为`.show`if 循环运行了四次，如果我使用回调来淡入淡出，那么我将有四次相同的淡入淡出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:00:12.463

我已经为你创建了这个 JSFiddle，重要的是我删除了我无法包含在 jsFiddle 中的反弹效果。

[http://jsfiddle.net/3fEeb/](http://jsfiddle.net/3fEeb/)

关键是在回调里面检查是否所有的span都可见，如果是这样，fade in the slogan..

```
function showDiv() {
    if($('#hidden span:not(#slogan)').is(':hidden')) {
        $('#hidden span:not(#slogan):hidden:first').show("bounce", { times:3 },function() {        
            if($('#hidden span:not(#slogan):hidden:first').length==0){
                $("span#slogan").fadeIn("slow");
            }
        });  
        setTimeout(showDiv, 500);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:16:56.023

只是一种没有 setTimeout 的方法：

## *[jsBin 演示](http://jsbin.com/ujetes/edit#javascript,html,live)*

```
function showDiv() {
  $('#hidden span:not(#slogan)').each(function(i,e){
    $(this).delay(i*300).show("bounce", { times:3 }, 500, function(){
      $('#slogan').fadeIn('slow');
    });  
  });     
} 
```

* * *

**编辑：（**为了避免`#slogan`淡入运行 4 次/更多次。见评论）

```
function showDiv() {
  var c = 0;
  $('#hidden span:not(#slogan)').each(function(i,e){
    c++;
    $(this).delay(i*300).show("bounce", { times:3 }, 500);
  });
  $('#slogan').delay(c*300).fadeIn('slow');
} 
```

## *[jsBin 演示](http://jsbin.com/ujetes/2/edit)*

* * *

使用 .length: **[demo3](http://jsbin.com/ujetes/3/edit)**

```
function showDiv() {
  $('#hidden span:not(#slogan)').each(function(i,e){
    $(this).delay(i*300).show("bounce", { times:3 }, 500);
  });
  $('#slogan').delay( $('#hidden span').length * 300 ).fadeIn('slow');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T14:56:06.523

```
function showDiv() {
    if($('#hidden span:not(#slogan)').is(':hidden')) {
        $('#hidden span:not(#slogan):hidden:first').show("bounce", { times:3 }, 500, function(){
            $("span#slogan").fadeIn("slow");
        });  
    }
} 
```

这可能对你有用。**

# python - 在python中使用多线程时如何获得更快的速度

> ID：10154487
> 
> 赞同：13
> 
> 时间：2012-04-14T14:48:58.557
> 
> 标签：python, multithreading, post, tcp

现在我正在研究如何尽快从网站获取数据。为了获得更快的速度，我正在考虑使用多线程。这是我用来测试多线程和简单帖子之间区别的代码。

```
import threading
import time
import urllib
import urllib2

class Post:

    def __init__(self, website, data, mode):
        self.website = website
        self.data = data

        #mode is either "Simple"(Simple POST) or "Multiple"(Multi-thread POST)
        self.mode = mode

    def post(self):

        #post data
        req = urllib2.Request(self.website)
        open_url = urllib2.urlopen(req, self.data)

        if self.mode == "Multiple":
            time.sleep(0.001)

        #read HTMLData
        HTMLData = open_url.read()

        print "OK"

if __name__ == "__main__":

    current_post = Post("http://forum.xda-developers.com/login.php", "vb_login_username=test&vb_login_password&securitytoken=guest&do=login", \
                        "Simple")

    #save the time before post data
    origin_time = time.time()

    if(current_post.mode == "Multiple"):

        #multithreading POST

        for i in range(0, 10):
           thread = threading.Thread(target = current_post.post)
           thread.start()
           thread.join()

        #calculate the time interval
        time_interval = time.time() - origin_time

        print time_interval

    if(current_post.mode == "Simple"):

        #simple POST

        for i in range(0, 10):
            current_post.post()

        #calculate the time interval
        time_interval = time.time() - origin_time

        print time_interval 
```

如您所见，这是一个非常简单的代码。首先我将模式设置为“简单”，我可以得到时间间隔：**50s**（也许我的速度有点慢:()。然后我将模式设置为“多个”，我得到时间间隔：**35**。从中我可以看到，多线程实际上可以提高速度，但结果并没有我想象的那么好。我想获得更快的速度。

从调试中发现程序主要阻塞在: 行`open_url = urllib2.urlopen(req, self.data)`，这行代码从指定网站发布和接收数据需要花费大量时间。`time.sleep()`我想也许我可以通过在函数中添加和使用多线程来获得更快的速度`urlopen`，但我不能这样做，因为它是 python 自己的函数。

如果不考虑服务器阻止发布速度的可能限制，我还能做些什么来获得更快的速度？或者我可以修改的任何其他代码？多谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-14T15:44:44.250

您做错的最大的事情，即最损害您的吞吐量，是您调用的方式`thread.start()`和`thread.join()`：

```
for i in range(0, 10):
   thread = threading.Thread(target = current_post.post)
   thread.start()
   thread.join() 
```

每次通过循环，您都会创建一个线程，启动它，然后等待它完成，然后再**继续下一个线程**。你根本没有同时做任何事情！

你可能应该做的是：

```
threads = []

# start all of the threads
for i in range(0, 10):
   thread = threading.Thread(target = current_post.post)
   thread.start()
   threads.append(thread)

# now wait for them all to finish
for thread in threads:
   thread.join() 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-16T15:56:11.253

在许多情况下，python 的线程并不能很好地提高执行速度……有时，它会使情况变得更糟。有关更多信息，请参阅[David Beazley 在 Global Interpreter Lock](https://www.youtube.com/watch?v=Obt-vMVdM8s) / [Pycon2010 GIL 幻灯片](http://www.dabeaz.com/python/UnderstandingGIL.pdf)上的 PyCon2010 演示。此演示文稿内容丰富，我强烈推荐给任何考虑线程的人...

尽管 David Beazley 的演讲解释了网络流量改进了 Python 线程模块的调度，但您应该使用[multiprocessing 模块](http://docs.python.org/library/multiprocessing.html)。我将此作为选项包含在您的代码中（请参阅我的答案的底部）。

在我的一台旧机器（Python 2.6.6）上运行它：

```
current_post.mode == "Process"  (multiprocessing)  --> 0.2609 seconds
current_post.mode == "Multiple" (threading)        --> 0.3947 seconds
current_post.mode == "Simple"   (serial execution) --> 1.650 seconds 
```

我同意 TokenMacGuy 的评论，上面的数字包括移动`.join()`到不同的循环。如您所见，python 的多处理比线程快得多。

* * *

```
from multiprocessing import Process
import threading
import time
import urllib
import urllib2

class Post:

    def __init__(self, website, data, mode):
        self.website = website
        self.data = data

        #mode is either:
        #   "Simple"      (Simple POST)
        #   "Multiple"    (Multi-thread POST)
        #   "Process"     (Multiprocessing)
        self.mode = mode
        self.run_job()

    def post(self):

        #post data
        req = urllib2.Request(self.website)
        open_url = urllib2.urlopen(req, self.data)

        if self.mode == "Multiple":
            time.sleep(0.001)

        #read HTMLData
        HTMLData = open_url.read()

        #print "OK"

    def run_job(self):
        """This was refactored from the OP's code"""
        origin_time = time.time()
        if(self.mode == "Multiple"):

            #multithreading POST
            threads = list()
            for i in range(0, 10):
               thread = threading.Thread(target = self.post)
               thread.start()
               threads.append(thread)
            for thread in threads:
               thread.join()
            #calculate the time interval
            time_interval = time.time() - origin_time
            print "mode - {0}: {1}".format(method, time_interval)

        if(self.mode == "Process"):

            #multiprocessing POST
            processes = list()
            for i in range(0, 10):
               process = Process(target=self.post)
               process.start()
               processes.append(process)
            for process in processes:
               process.join()
            #calculate the time interval
            time_interval = time.time() - origin_time
            print "mode - {0}: {1}".format(method, time_interval)

        if(self.mode == "Simple"):

            #simple POST
            for i in range(0, 10):
                self.post()
            #calculate the time interval
            time_interval = time.time() - origin_time
            print "mode - {0}: {1}".format(method, time_interval)
        return time_interval

if __name__ == "__main__":

    for method in ["Process", "Multiple", "Simple"]:
        Post("http://forum.xda-developers.com/login.php", 
            "vb_login_username=test&vb_login_password&securitytoken=guest&do=login",
            method
            ) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T15:15:25.203

请记住，在 Python 中，多线程可以“提高速度”的唯一情况是当您执行*像这样*的操作时I/O 受限。否则，多线程不会提高“速度”，因为它不能在多个 CPU 上运行（不，即使你有多个内核，python 也不能那样工作）。当您希望同时完成两件事时，您应该使用多线程，而不是当您希望两件事并行时（即两个进程分开运行）。

现在，您实际上所做的实际上不会提高任何单个 DNS 查找的速度，但它会允许在等待其他一些请求的结果时触发多个请求，但您应该注意您做了多少否则您只会使响应时间比现在更糟。

也请停止使用 urllib2，并使用请求：[http ://docs.python-requests.org](http://docs.python-requests.org)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T15:01:36.997

DNS 查找需要时间。你对此无能为力。大延迟是首先使用多个线程的一个原因 - 多个查找广告网站 GET/POST 然后可以并行发生。

转储 sleep() - 它没有帮助。

# php - 重力形式：用户创建的字段不发布数据

> ID：10154488
> 
> 赞同：0
> 
> 时间：2012-04-14T14:48:58.783
> 
> 标签：php, wordpress

我在 Wordpress 中使用 Gravity Forms 为客户创建提交表单。Gravity Forms 具有我完成此任务所需的大部分要求，但我必须在插件本身中构建一些自定义字段（应该是可扩展的）。

因此，我正在创建一个字段类型，用于在提交后将视频文件上传到 Youtube。我计划使用文件上传输入类型，并在提交后获取文件数据（或 url/路径名）并将其上传到 Youtube。这是我必须在三周内完成的客户项目的一部分。

我使用以下钩子创建了一个自定义字段：（抱歉，格式很糟糕；链接和代码不能很好地混合）

`add_action("`[`gform_field_input`](http://www.gravityhelp.com/documentation/page/Gform_field_input)`", array('GFYoutubeUpload', 'add_gf_fieldtype'), 10, 5)`

`add_filter("`[`gform_editor_js_set_default_values`](http://www.gravityhelp.com/documentation/page/Gform_editor_js_set_default_values)`", array('GFYoutubeUpload', 'add_gf_defaults'));`

`add_action("`[`gform_editor_js`](http://www.gravityhelp.com/documentation/page/Gform_editor_js)`", array('GFYoutubeUpload', 'add_gf_formeditor'));`

`add_filter("`[`gform_field_type_title`](http://www.gravityhelp.com/documentation/page/Gform_field_type_title)`", array('GFYoutubeUpload', 'add_gf_title'));`

`add_filter("`[`gform_add_field_buttons`](http://www.gravityhelp.com/documentation/page/Gform_add_field_buttons)`", array('GFYoutubeUpload', 'add_gf_button'));`

（我还有一个我已经开始编写的[pre_submission处理程序，它将输入发送到不同的插件。）](http://www.gravityhelp.com/documentation/page/Gform_pre_submission)

我创建了一个文件输入类型，并且我相信我有正确的命名约定。我已经在下面发布了我的函数以供审查。）输入类型在 Wordpress 管理页面和重力表单表单预览上正确显示，但是当我发布表单时，我的自定义字段没有与之关联的值。（在 $_POST 中也没有与之对应的任何内容。）

看看下面的代码，谁能告诉我在创建这个输入时我哪里出错了？是否还有另一个我不知道的钩子需要用来处理我添加到表单中的数据？

```
<?php
     /* Register the cusitom field type with Gravity Forms. */ 
     public static function add_gf_fieldtype($input, $field, $value, $lead_id, $form_id) {  
         if ($field["type"] == "youtube") {  
             $input_name = $form_id .'_'. $field['id'];  
             $css = isset($field['cssClass']) ? $field['cssClass'] : '';  

             return sprintf("<div class='ginput_container'><input name='input_%s' id='input_%s_%s' class='%s' value='' type='file' /></div>", $field["id"], $form_id, $field["id"], $field["type"]. ' ' .esc_attr($css). ' ' .$field['size']);  
         }  

         return $input;  
     }
?> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:33:05.867

答案其实很简单——不是重力形式；而是重力形式。这是基本的 PHP。我使用的是`$_POST`超全局而不是`$_FILES`数据实际所在的位置。希望这将帮助遇到此问题的其他人。

# android - android游戏surfaceview与framelayout慢

> ID：10154494
> 
> 赞同：0
> 
> 时间：2012-04-14T14:49:52.753
> 
> 标签：android, user-interface, surfaceview, android-framelayout

我目前正在写一个游戏，现在遇到了一个问题。

在我的游戏中，如果我在我的自定义表面视图类上覆盖一个框架布局，我的帧速率将根据放置在框架布局中的视图小部件的数量而下降。

我正在使用框架布局来放置一些游戏控件和文本视图以进行点显示..

我想过直接在游戏循环中的surfaceview上实现控件，但这基本上破坏了Android UI小部件的目的，而且必须在XML中移动会容易得多。

如何解决这个问题呢？

这是我的代码： XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/FrameLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<com.sora.game.npc.Panel
    android:id="@+id/myview1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />

<GridLayout
    android:layout_width="wrap_content"
    android:layout_height="179dp"
    android:columnCount="8"
    android:rowCount="5" android:layout_gravity="bottom|left" android:visibility="visible">

    <Button
        android:id="@+id/upleft"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_column="0"
        android:layout_gravity="bottom|right"
        android:layout_row="0"
        android:text="↖" />

    <Button
        android:id="@+id/up"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_column="1"
        android:layout_gravity="bottom"
        android:layout_row="0"
        android:text="↑" />

    <Button
        android:id="@+id/upright"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_column="2"
        android:layout_columnSpan="4"
        android:layout_gravity="bottom"
        android:layout_row="0"
        android:text="↗" />

    <Button
        android:id="@+id/left"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_column="0"
        android:layout_gravity="bottom"
        android:layout_row="1"
        android:text="←" />

    <Button
        android:id="@+id/vdp"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_column="1"
        android:layout_gravity="bottom"
        android:layout_row="1"
        android:text="⥁" />

    <Button
        android:id="@+id/right"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_column="2"
        android:layout_columnSpan="4"
        android:layout_gravity="left"
        android:layout_row="1"
        android:text="→" />

    <Button
        android:id="@+id/downleft"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_column="0"
        android:layout_gravity="right"
        android:layout_row="2"
        android:text="↙" />

    <Button
        android:id="@+id/down"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_column="1"
        android:layout_gravity="left"
        android:layout_row="2"
        android:text="↓" />

    <Button
        android:id="@+id/downright"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_column="2"
        android:layout_columnSpan="4"
        android:layout_gravity="left"
        android:layout_row="2"
        android:text="↘" />

    <Space
        android:layout_width="1dp"
        android:layout_height="47dp"
        android:layout_column="0"
        android:layout_gravity="fill_horizontal"
        android:layout_row="1" />

    <Space
        android:layout_width="61dp"
        android:layout_height="1dp"
        android:layout_column="1"
        android:layout_gravity="fill_horizontal"
        android:layout_row="0" />

    <Space
        android:layout_width="30dp"
        android:layout_height="1dp"
        android:layout_column="2"
        android:layout_gravity="fill_horizontal"
        android:layout_row="0" />
</GridLayout>

<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:drawingCacheQuality="high"
    android:visibility="visible" >

    <TextView
        android:id="@+id/life"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Life"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/score"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="Score"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <TextView
        android:id="@+id/npcqt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:text="NPC quantity"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <Button
        android:id="@+id/strike"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/score"
        android:layout_marginTop="67dp"
        android:text="strike" />

    <Button
        android:id="@+id/fire"
        android:layout_width="wrap_content"
        android:layout_height="50dp"
        android:layout_alignParentBottom="true"
        android:layout_alignParentRight="true"
        android:text="----Fire!----"/>

    <Button
        android:id="@+id/cycle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/strike"
        android:text="cycle" />

</RelativeLayout>

</FrameLayout> 
```

编辑：我做了一些实验：

如果我将自定义表面视图缩放到顶部没有 UI 小部件（覆盖）表面视图的大小，则不会发生 FPS 的滞后和下降，这让我认为问题与渲​​染无关......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:20:14.953

我不认为有一个简单的解决方案。只是为了确保我会首先使用 TraceView 来检查性能瓶颈的真正位置。现在，如果这个瓶颈确实与 Android Widgets 相关（很可能是因为已知 SurfaceViews 与 Android Widgets 的结合成本很高）你可以尝试这样做。

```
 getWindow().setFormat(PixelFormat.RGB_565);
    holder.setFormat(PixelFormat.RGB_565); 
```

这可能有助于表面合成的性能，但你会失去 alpha。还要确保您的精灵具有相同的格式。如果这没有帮助，您将需要使用更少的小部件或开始在画布上绘制您自己的小部件。但一定要检查像[AndEngine](http://www.andengine.org/)这样的游戏引擎。无需为基本任务重新发明轮子:-)

另一个想法：您是在所有设备上还是仅在平板电脑上看到性能问题？以我个人的经验，平板电脑对性能问题更加敏感，因为它们的像素数比它们的 gpu 功率更高。那么你是否在 manifest.xml 中激活了硬件加速？

# facebook - 是否可以在不要求他登录的情况下获取用户的 facebook id 和个人资料图片？

> ID：10154496
> 
> 赞同：0
> 
> 时间：2012-04-14T14:50:00.823
> 
> 标签：facebook, windows-phone-7, facebook-c#-sdk, windows-phone-7.1

我想知道是否可以在不要求用户登录的情况下获取 Windows Phone 用户的 Facebook 用户 ID。任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:34:15.343

不，Facebook 的任何 API 都不会为您提供有关“当前”（/活动）用户的信息，除非他们已授权您的应用程序

# android - editText 视图不介意 layout_width

> ID：10154501
> 
> 赞同：0
> 
> 时间：2012-04-14T14:50:52.703
> 
> 标签：android, android-layout

我有一个布局问题。我在表格行中有三个 editText 视图。它们每个都有相同的属性，但是前两个不会介意我设置的 layout_width。注意：每个提示都有相同数量的字符。

解答： 移除表格并使用嵌套线性布局。

```
 <TableRow
        android:id="@+id/tableRowQuad1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal" >

            <EditText
                android:id="@+id/editTextQuadA"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintA" />

            <EditText
                android:id="@+id/editTextQuadB"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintB" />

            <EditText
                android:id="@+id/editTextQuadC"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintC" />

    </TableRow> 
```

editTextQuadC 显示正确的宽度，但 A 和 B 保持相同的大小，除非我让它比它们看起来更大。它们似乎出现在大约 75-85 sp。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:01:18.120

只需将 tableRow 更改为 LinearLayout 并尝试正常工作，如下所示：

```
<LinearLayout
        android:id="@+id/tableRowQuad1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal" >

            <EditText
                android:id="@+id/editTextQuadA"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintA" />

            <EditText
                android:id="@+id/editTextQuadB"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintB" />

            <EditText
                android:id="@+id/editTextQuadC"
                android:layout_width="50sp"
                android:layout_height="wrap_content"
                android:ems="10"
                android:inputType="numberDecimal|numberSigned"
                android:hint="@string/hintC" />

    </LinearLayout> 
```

因为如果您使用表格行，它的宽度取决于其他表格行。

# haskell - 使用带有惰性字节字符串的 base64 字节字符串

> ID：10154503
> 
> 赞同：3
> 
> 时间：2012-04-14T14:51:12.377
> 
> 标签：haskell, encryption, base64, lazy-evaluation, bytestring

这是我在 Haskell 中尝试做的事情：

*   以 ByteString 格式接收消息（懒惰或严格无关紧要）
*   使用 RSA 公钥加密消息
*   base64 对加密消息进行编码

我正在使用的[RSA 库](http://hackage.haskell.org/packages/archive/RSA/1.2.0.0/doc/html/Codec-Crypto-RSA.html)在内部处理惰性字节字符串。但是，[Base64](http://hackage.haskell.org/package/base64-bytestring)库仅使用严格的 ByteStrings。我的应用程序使用惰性字节字符串将消息发送到网络套接字。

所以，看起来我必须在惰性字节字符串和严格字节字符串之间进行转换。这就是我所做的：

```
encrypt :: CryptoRandomGen t => t -> RSA.PublicKey -> L.ByteString -> L.ByteString
encrypt gen pubkey msg = do
  let (ciphertext,_) = RSA.encrypt gen pubkey msg
  (L.fromChunks . map encode . L.toChunks) $ ciphertext

decrypt :: RSA.PrivateKey -> L.ByteString -> Either String L.ByteString
decrypt privkey ciphertext = do
  dec <- decode $ S.concat $ L.toChunks ciphertext
  return $ RSA.decrypt privkey $ L.fromChunks [dec] 
```

不幸的是，有时这会失败。当我解密以这种方式加密的消息时，有时会产生垃圾，然后是实际消息。我不确定问题出在哪里：是从惰性字节字符串转换为严格字节字符串还是 base64 编码步骤？还是两者兼而有之？

惰性字节字符串只是严格字节字符串块的列表。我是否通过转换隐式修改消息的长度？

请赐教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:29:13.123

问题是base64编码将输入的每三个字节（3×8位）映射到输出的四个字节（4×6位），所以当输入的大小不是3的倍数时，它必须添加填充。这意味着连接单独编码每个块的结果可能不会得到与编码整个事物相同的结果。

```
> encode "Haskell"
"SGFza2VsbA=="
> encode "Hask" `append` encode "ell"
"SGFzaw==ZWxs" 
```

请注意，即使您删除了`=`用于填充输出的字符，这些也是不同的。*输入*的填充仍然会导致问题。

您最好的选择可能是找到一个支持惰性字节串的库，但确保所有块（除了最后一个）的大小都是三的倍数可以作为一种解决方法。

或者，如果您不介意将整个内容保存在内存中，请将惰性字节字符串转换为严格字节字符串，一步对整个内容进行编码，然后再转换回来（如有必要）。

# java - 将 Base64 字符串拆分为相同长度的块以在 Android 中通过 http 传输的最佳/有效方法

> ID：10154504
> 
> 赞同：2
> 
> 时间：2012-04-14T14:51:27.183
> 
> 标签：java, android, string

将 Base64 字符串拆分为相同长度的块以在 Android 中通过 http 传输的最佳/有效方法是什么？最佳块大小是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T14:59:59.930

如果您的问题与使用 Java 将字符串拆分为相等长度的块有关，请查看[这个问题。](https://stackoverflow.com/questions/3760152/split-string-to-equal-length-substrings-in-java)

关于最佳块大小，它取决于太多因素：什么样的网络（wifi、2g、3g ......），你想对数据做什么，你的数据可靠性限制是什么，甚至电池使用时间你可能有的限制......如果你不提供一些额外的信息，就很难回答你问题的这一部分。

# php - MySql 的 ID 值在 while 循环中丢失

> ID：10154506
> 
> 赞同：0
> 
> 时间：2012-04-14T14:51:32.550
> 
> 标签：php, mysql

当我使用循环中的表单字段发布评论时，博客的特定 ID 不会传递到 php 脚本。所以评论没有分配给它打算去的博客。

```
<?php
$conn = mysql_connect("localhost", "ooze", "");
mysql_select_db ("ooze");
$result = mysql_query ("select * from blog") or die(mysql_error());
$result2 = mysql_query ("select * from blog, blogcomment where blog.ID = blogcomment.blogID") or die(mysql_error());
$i = 1;  
while($row = mysql_fetch_array($result))
{
echo "<h1>$row[title]</h1>";
echo "<p class ='second'>$row[blog_content]</p> "; 
echo "<p class='meta'>Posted by .... &nbsp;&bull;&nbsp; $row[date] &nbsp;&bull;&nbsp; <a href='#' onclick=\"toggle_visibility('something$i'); return false\">Comments</a><div id='something$i' style='display: none;'>";    
$i++;
while($row = mysql_fetch_array($result2))
{
echo "<p class='third' >$row[commentdate] &nbsp;&bull;&nbsp; $row[username]</p><p>said:</p> <p>$row[comment]</p>";
}
if ( isset ($_SESSION["gatekeeper"])) {
echo '<form method="post" name="result_'.$row["ID"].'" action="postcomment.php"><input name="ID" type = "hidden" value = "'.$row["ID"].'" /><input name="comment" id="comment" type="text" style="margin-left:20px;"/><input type="submit" value="Add comment" /></form>';
} 
else { 
echo '<p class="third"><a href="register.html">Signup </a>to post a comment</p>';
}
echo "</div>";
}
mysql_close($conn);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:56:42.757

这是因为您正在使用内部 while() 循环覆盖 $row 变量。将内部变量名称从 $row 更改为 $sub ，您会发现行为按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T14:54:31.150

`$row`不要对两个循环使用相同的变量 ( )...

将第二个循环更改为：

```
 while($row2 = mysql_fetch_array($result2)){...} 
```

并将第二个结果中的所有值更改为`$row2["COLUMN_NAME"]`

另外 - 不要忘记用引号将数组索引括起来......它可以工作但会创建一个通知，并使服务器工作更难

即：`$row[username]`应该是`$row["username"]`

这是尝试在您的代码中进行一些排序：

```
<?php
$conn = mysql_connect("localhost", "ooze", "");
mysql_select_db ("ooze");
$result = mysql_query ("select * from blog") or die(mysql_error());
$result2 = mysql_query ("select * from blog, blogcomment where blog.ID = blogcomment.blogID") or die(mysql_error());
$i = 1;  
while($row = mysql_fetch_array($result)){
    echo <<<str
    <h1>{$row["title"]}</h1>
    <p class ='second'>{$row["blog_content"]}</p> 
    <p class='meta'>Posted by .... &nbsp;&bull;&nbsp; {$row["date"]} &nbsp;&bull;&nbsp; <a href='#' onclick=\"toggle_visibility('something{$i}'); return false\">Comments</a><div id='something{$i}' style='display: none;'>
str;

    $i++;
    while($comment = mysql_fetch_array($result2)){
         echo "<p class='third' >{$comment["commentdate"]} &nbsp;&bull;&nbsp; {$comment["username"]}</p><p>said:</p> <p>{$comment["comment"]}</p>";
    }
    if ( isset ($_SESSION["gatekeeper"])) {
        echo '<form method="post" name="result_'.$row["ID"].'" action="postcomment.php"><input name="ID" type = "hidden" value = "'.$row["ID"].'" /><input name="comment" id="comment" type="text" style="margin-left:20px;"/><input type="submit" value="Add comment" /></form>';
    } 
    else { 
        echo '<p class="third"><a href="register.html">Signup </a>to post a comment</p>';
    }
    echo "</div>";
}
mysql_close($conn); 
```

毕竟，如果我理解你想要实现的目标 - 比你的脚本不好，第二个查询应该在第一个循环内，`WHERE blogID={$row["ID"]}`最后包含 a

如果您更喜欢在一个查询中获取所有评论 - 这很好，但是当您在嵌套循环中获取它们时，您需要安排它们，然后只显示与每个“博客”相关的内容 - 第二个查询只会给您行那些（因为第二次 - 它已经是空的）

# entity-framework - 联接表中的 Code First Fluent API 和导航属性

> ID：10154512
> 
> 赞同：6
> 
> 时间：2012-04-14T14:52:20.800
> 
> 标签：entity-framework, code-first, composite-key, jointable

我有四个实体，我想通过 code first fluent api 将它们转换为数据库表（我正在使用在 databaseanswers.org 找到的模型），但我不确定如何。我遇到的问题是 SuggestedMenuId 正在跨复合键（MenuCourse 和 CourseRecipeChoice）中的两个不同表迁移。

这是我收到的消息：

“在模型生成过程中检测到一个或多个验证错误：

\tSystem.Data.Entity.Edm.EdmAssociationConstraint: : 关系约束中的从属角色和主体角色中的属性数量必须相同。"

这是我在我的 EntityTypeConfiguration 类中尝试过的，它显然是不正确的......

```
public class CourseRecipeChoiceConfiguration : EntityTypeConfiguration<CourseRecipeChoice>
{
    public CourseRecipeChoiceConfiguration()
    {
        HasKey(crc => new { crc.Id});
        HasRequired(r => r.Recipe).WithMany(crc => crc.CourseRecipeChoices).HasForeignKey(crc => crc.RecipeId);
        HasRequired(m => m.MenuCourse).WithMany(crc => crc.CourseRecipeChoices).HasForeignKey(crc => crc.MenuCourseId);
        HasRequired(m => m.MenuCourse).WithMany(crc => crc.CourseRecipeChoices).HasForeignKey(crc => crc.SuggestedMenu_MenuCourseId);
    }
} 
```

CourseRecipeChoice 连接表的导航属性的正确语法和流畅的 api 语法的正确语法是什么？

```
public class SuggestedMenu
{
    public int SuggestedMenuId { get; set; }

    public virtual ICollection<MenuCourse> MenuCourses { get; set; }
}

public class MenuCourse
{
    public int Id { get; set; }
    public int SuggestedMenuId { get; set; }

    public SuggestedMenu SuggestedMenu { get; set; }
    public virtual ICollection<CourseRecipeChoice> CourseRecipeChoices { get; set; }
}

public class CourseRecipeChoice
{
    public int SuggestedMenuId { get; set; }
    public int MenuCourseId { get; set; }
    public int Id { get; set; }
    public int RecipeId { get; set; }

    //How do I represent the navigation properties in this class? 

}

public class Recipe
{
    public int RecipeId { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }

    public ICollection<CourseRecipeChoice> CourseRecipeChoices { get; set; }
} 
```

键如下：

*   **建议菜单（ID）**
*   **MenuCourse(Id, SuggestedMenuId)**
*   **CourseRecipeChoice(Id, SuggestedMenuId, MenuCourseId, RecipeId)** //这实际上是我感到困惑的地方，因为根据模型，SuggestedMenuId 是 SuggestedMenu 中的 PK 和 MenuCourse 和 CourseRecipeChoice 中的 PF（这可能只是糟糕的设计吗？）
*   **食谱（RecipeId）**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T16:50:30.590

...根据手头的信息（键，关系并不完全清楚），
这是最复杂的场景，应该涵盖你可能拥有的我认为...

```
public class SuggestedMenu
{
    public int SuggestedMenuId { get; set; }
    public string Description { get; set; }
    public virtual ICollection<MenuCourse> MenuCourses { get; set; }
    // public virtual ICollection<CourseRecipeChoice> CourseRecipeChoices { get; set; }
}
public class MenuCourse
{
    public int MenuCourseId { get; set; }
    public int SuggestedMenuId { get; set; }
    public SuggestedMenu SuggestedMenu { get; set; }
    public virtual ICollection<CourseRecipeChoice> CourseRecipeChoices { get; set; }
}
public class CourseRecipeChoice
{
    public int CourseRecipeChoiceId { get; set; }
    public int MenuCourseId { get; set; }
    public int SuggestedMenuId { get; set; }
    public int RecipeId { get; set; }
    // no virtuals if required, non-optional 
    public Recipe Recipe { get; set; }
    public MenuCourse MenuCourse { get; set; }
    // public SuggestedMenu SuggestedMenu { get; set; }
}
public class Recipe
{
    public int RecipeId { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public virtual ICollection<CourseRecipeChoice> CourseRecipeChoices { get; set; }
} 
```

...并且在`OnModelCreating`（我更喜欢在那里完成所有配置，尽管它是相同的）...

```
modelBuilder.Entity<CourseRecipeChoice>()
    .HasKey(crc => new { crc.CourseRecipeChoiceId, crc.SuggestedMenuId, crc.MenuCourseId, crc.RecipeId });

modelBuilder.Entity<CourseRecipeChoice>()
    .HasRequired(r => r.Recipe)
    .WithMany(crc => crc.CourseRecipeChoices)
    .HasForeignKey(crc => crc.RecipeId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<CourseRecipeChoice>()
    .HasRequired(m => m.MenuCourse)
    .WithMany(crc => crc.CourseRecipeChoices)
    .HasForeignKey(crc => new { crc.MenuCourseId, crc.SuggestedMenuId })
    .WillCascadeOnDelete(false);

modelBuilder.Entity<SuggestedMenu>()
    .HasKey(crc => crc.SuggestedMenuId );

modelBuilder.Entity<MenuCourse>()
    .HasKey(crc => new { crc.MenuCourseId, crc.SuggestedMenuId });

modelBuilder.Entity<MenuCourse>()
    .HasRequired(m => m.SuggestedMenu)
    .WithMany(crc => crc.MenuCourses)
    .HasForeignKey(crc => crc.SuggestedMenuId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<Recipe>()
    .HasKey(crc => crc.RecipeId ); 
```

...并测试例如...

```
 using (var db = new YourDbContext())
        {
            SuggestedMenu suggestedmenu = new SuggestedMenu { Description = "suggested menu" };
            var menucourse = new MenuCourse { MenuCourseId = 2, SuggestedMenu = suggestedmenu };
            var recipe = new Recipe { Name = "My recipe", Description = "recipe desc" };
            var crc = new CourseRecipeChoice { CourseRecipeChoiceId = 2, MenuCourse = menucourse, Recipe = recipe, };
            db.CourseRecipeChoices.Add(crc);
            int recordsAffected = db.SaveChanges();
            foreach (var crcs in db.CourseRecipeChoices.Include(c => c.MenuCourse).Include(c => c.Recipe))
            {
                Console.WriteLine("{0}, {1}, {2}, {3}", crcs.MenuCourse.MenuCourseId, crcs.MenuCourse.SuggestedMenuId, crcs.Recipe.Name, crcs.Recipe.Description);
            }
        } 
```

# javascript - 未终止的字符串文字/无效或意外的标记

> ID：10154514
> 
> 赞同：4
> 
> 时间：2012-04-14T14:52:48.217
> 
> 标签：javascript

为什么我越来越...

> SyntaxError：未终止的字符串文字

...在**Firefox**和...

> 未捕获的 SyntaxError：无效或意外的令牌

...当我运行时在**Chrome中...**

```
$(document).ready(function () {
  function addJSBeforeEndBody(code) {
       $('body').append('<script>' + code + '</script>');
  }
  addJSBeforeEndBody('$(document).ready(function() { console.log("I never end up here."); });');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-14T14:58:56.543

分解字符串`"</script>"`（在 javascript 代码中）；它将被解释为实际的结束脚本标记，而不是您想要的字符串文字。

```
$(document).ready(function () {
  function addJSBeforeEndBody(code) {
       $('body').append('<script>' + code + '</scr' + 'ipt>');
  }
  addJSBeforeEndBody('$(document).ready(function() { console.log("It works now."); });');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:16:02.350

```
'<script>'+code.toString()+'<\/script>' 
```

浏览器在看到 时关闭脚本元素`'</script>'`，表示脚本关闭标记。转义斜线使浏览器处于文本解释模式。

或如前所述将其分解：

```
"<script>"+code.toString()+"<"+"/script>" 
```

# objective-c - 保留属性的引用计数减少不正确

> ID：10154522
> 
> 赞同：1
> 
> 时间：2012-04-14T14:54:29.020
> 
> 标签：objective-c, memory-management

我想我仍然不明白这一点。我没有在这个项目上使用 ARC。

对于`aProperty`使用 retain 属性声明的属性，我希望分配的对象在以下语句中保留两次：

```
self.aProperty = [UIView alloc] init...]; 
```

一次来自 alloc，一次来自 setter。

所以我立即释放对象一次，如下所示：

```
self.aProperty = [UIView alloc] init...];
[self.aProperty release]; 
```

编译器给出错误信息：

> 调用者此时不拥有的对象的引用计数不正确递减。

保留计数是否由设置器增加，使其成为两个，此时？

另外，“调用者当时不拥有”是什么意思？这可能是我不熟悉的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:00:12.230

也许它会警告您，因为该对象未声明为简单变量，而是由其他东西拥有（在本例中为`self`），并希望阻止您随机释放对象。

试试这个：

```
UIView *view [UIView alloc] init...];
self.aProperty = view;
[view release]; 
```

或者这个，我通常做的事情：

```
self.aProperty = [[[UIView alloc] init] autorelease]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:31:15.883

澄清正在发生的事情。

```
self.myVar = [[UIView alloc] initWithFrame:frame]; 
```

相当于调用

```
[self setMyVar:[[UIView alloc] initWithFrame:frame]]; 
```

当使用`@property`with retain 它的实现最终看起来像这样（这只是一个粗略的例子）

```
- (void)setMyVar:(UIView *)myVar;
{
    if (_myVar != myVar) {
        [_myVar release];
        _myVar = [myVar retain];
    }
} 
```

所以现在我们可以这么说

```
+----------- +1 retain ------------+
|                                  |
[[UIView alloc] initWithFrame:frame] 
```

和

```
+------ +1 retain ----+
|                     |
_myVar = [myVar retain]; 
```

这是计数的+2。然后我们会有类似的东西

```
- (void)dealloc;
{
    [_myVar release];
    [super dealloc];
} 
```

这是-1，这只会给我们留下内存泄漏，因为仍然有+1保留。

我喜欢的模式是

```
UIView *myVar = [[UIView alloc] initWithFrame:frame];
self.myVar = myVar;
[myVar release]; myVar = nil; 
```

以便尽快释放内存，并且在被`nil`引出时不会留下任何悬空指针

# eclipse - Nutch 无法获取 UTF-8 字符

> ID：10154532
> 
> 赞同：0
> 
> 时间：2012-04-14T14:56:31.383
> 
> 标签：eclipse, ubuntu, character-encoding, nutch

**我用Nutch**抓取页面，在索引之前，我将内容保存到**Fetcher**类中的单独文件中，所以我不使用**-readseg**从索引文件中取回它们。但是，“ü”和“ç”等特殊字符保存为“?”。

我做了[Nutch Wiki 页面](http://wiki.apache.org/tomcat/FAQ/CharacterEncoding)中推荐的一切。编辑了**标签的编码属性为UTF-8，它仍然不起作用。我遇到了一些关于在系统文件中更改语言的建议。我在**Ubuntu 11.10**工作。**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T11:33:57.263

我能想到的有3种可能性：

1.  Nutch 工作正常，您的代码将内容正确写入文件，但您的环境（终端/编辑器）未在输出控制台上正确显示字符。
2.  您写出内容的代码（由 nutch 抓取）没有处理 UTF-8 编码。
3.  Nutch 未正确处理 UTF-8 编码。

我已经用 Nucth 抓取了包含中文字符的页面，并且我能够在`readseg`输出中看到一些乱码（这是使用 nutch 1.0）。后来我安装了一些语言插件并在终端中调整了设置，我可以看到这些字符。所以，我认为#3 不太可能，你必须关注#1 和#2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T06:06:57.427

我在想我已经解决了编码问题。请看下面的代码：

```
co = true;
fe = true;
ge = true;
pa = true;
pd = true;
pt = true;
SegmentReader segmentReader2 = new SegmentReader(crwlNutchCommon.nutch_conf, co, fe, ge, pa, pd, pt);
HashMap<String, List<Writable>> hm = new HashMap<String, List<Writable>>();
segmentReader2.get(path, new Text("some_url"), 
```

new OutputStreamWriter(new FileOutputStream("somefile1"), "UTF-8"),hm);

文件 somefile1 可能有错误的编码，但更进一步：

```
FileOutputStream fos; 
DataOutputStream dos;
File file= new File("somefile2");
fos = new FileOutputStream(file);
dos=new DataOutputStream(fos);
hm.get("co").get(0).write(dos); // look 
```

这行得通！somefile2 将是“原始的”，没有任何编码修改，但在开头和结尾有一些额外的数据 - 我认为可以解析它们分析“Content.java”源文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T10:41:20.443

跟着你，我决定修改 Fetcher 类并添加支持将内容直接保存到 mysql 数据库。它工作得更好更快。**

# php - 使用 WHERE 为多个复选框检索表单数据

> ID：10154535
> 
> 赞同：2
> 
> 时间：2012-04-14T14:57:23.620
> 
> 标签：php, mysql

我需要一个 php 脚本，它将使用表单复选框的值作为 MySQL 查询来检索数据。我想我需要在查询中使用 WHERE 和 OR 运算符。

我的 PHP 和 MySql 级别是初学者。

```
<form id="form1" name="form1" method="post" action="">

    <p>
        <h3>story</h3>
        <label><input type="checkbox" name="story" value="1" id="story_1" />one story</label>
        <label><input type="checkbox" name="story" value="2" id="story_2" />two story</label>
    </p>

    <p>
        <h3>bedrooms</h3>
        <label><input type="checkbox" name="bedroom" value="2" id="bed_2" />two beds</label>
        <label><input type="checkbox" name="bedroom" value="3" id="bed_3" />three beds</label>
        <label><input type="checkbox" name="bedroom" value="4" id="bed_4" />four beds</label>
    </p>

    <p>
        <h3>baths</h3>
        <label><input type="checkbox" name="bath" value="1" id="bath_1" />one bath</label>
        <label><input type="checkbox" name="bath" value="2" id="bath_2" />two baths</label>
        <label><input type="checkbox" name="bath" value="3" id="bath_3" />three baths</label>
    </p>

    <input type="submit" name="search" value="search" />

</form> 
```

到目前为止我的查询

```
SELECT * FROM homes WHERE story='1' OR story='2' OR bed='3' OR baths='3' 
```

因此，如果未选中任何复选框，则根本不会添加 WHERE 子句，并且默认检索所有记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:20:34.780

您可以通过使用相同的名称命名输入并后跟方括号来获取数组中的所有选定值：

HTML:
<input type="checkbox" name="bed[]" value="1" /> 一居室
<input type="checkbox" name="bed[]" value="2" /> 两居室

然后，您可以在 WHERE 子句中使用[mysql IN() 函数](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_in)。PHP：

```
$aBeds = $_POST['bed'];  // array (1,2) if both are checked
$aBeds = array_map ('intval', $aBeds); // filter with intval for sql injection
$sBeds = implode (',', $aBeds); // "1,2" if both are checked
$query = "SELECT  * FROM homes WHERE bed IN($sBeds) and ..."; 
```

**注意：**我在那里做了一些快速而肮脏的输入过滤，但请注意，这可能不是避免 SQL 注入的最佳方法。最好使用数据访问层、预准备语句或其他一些通用方案，其中每个查询都不需要自己的过滤代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:08:21.897

使用带有这么多或的 select 语句会导致问题。

```
SELECT * FROM homes WHERE story='1' OR story='2' OR bed='3' OR baths='3' 
```

这将生成所有故事 = 1 且具有任意数量的浴室或卧室的房屋。其中故事 = 2，带有任意数量的浴室或卧室。其中 bed = 3 带有任意数量的楼层或浴室 其中 baths = 3 带有任意数量的床或浴室

所以你最终可能会得到所有家庭的结果

你应该做的是用括号将不同的类型分开，并在它们之间使用 AND。

```
SELECT * FROM homes WHERE (story='1' OR story='2') and (bed='3') and (baths='3') 
```

或者对于更复杂的查询，类似这样的。

```
SELECT * FROM homes WHERE (story='1' OR story='2') 
                      and (bed='3' OR bed = '4') 
                      and (baths='3' OR baths='4') 
```

这将产生具有 1 层或 2 层的故事、3 或 4 层的卧室和 3 或 4 层的浴室的结果。你不会得到任何 3 层的房子，你不会得到任何 2 卧室的房子，你不会没有两间浴室的房子。

我认为这会做到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:11:37.263

您需要在 HTML 中的每个输入上具有唯一的“名称”属性。当表单发布时，它会被发送到“action”属性的 URL 地址。你有空白，所以你可能想把它发送到“something.php”，并在服务器上有一个同名的 PHP 文件。

如果 empty($_POST) 返回 True，您将知道表单是否已发布到 PHP 文件。此变量保存表单中发布的数据。

每个输入标签的名称属性将在 $_POST 全局变量中创建一个数组条目。因此，如果启用该复选框，则 $_POST["bath_1"] 将为 1。

有许多不同的方法可以将 $_POST 数据转换为您想要的 SQL 语句。我建议您先处理已发布的数据，然后再提出一个与处理数组和生成 SQL where 语句相关的更具体的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:13:10.417

我添加了一些额外的东西来避免注入攻击。

```
$query = 'SELECT * FROM homes WHERE 1';

// Protect against injection attacks
$valid_responses = array(
    'story' => array(
        '1','2'),
    'bedroom' => array(
        '2','3','4'),
    'bath_1' => array(
        '1','2','3'),
);
foreach ($valid_responses as $field=>$values) {
    $selection = array_intersect($_POST[$field],$values);
    if (!empty($selection)) {
        $query .= ' AND ' . $field . ' IN (' . implode(',',$selection) . ')';
    }
} 
```

# android - Android 在连接到 WLAN 网络时崩溃

> ID：10154536
> 
> 赞同：0
> 
> 时间：2012-04-14T14:57:33.953
> 
> 标签：android, crash, wifi

我正在运行一个小型应用程序，它通过 WifiManager.startScan() / WifiReceiver 扫描可用的 WLAN 网络。一旦检测到特定的开放网络，我就会尝试通过调用以下代码连接到它：

```
WifiConfiguration wifiConfig = new WifiConfiguration(); 
wifiConfig.BSSID =result.BSSID; // BSSID of detected network
wifiConfig.priority = 1; 
wifiConfig.allowedKeyManagement.set(KeyMgmt.NONE); 
wifiConfig.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.TKIP); 
wifiConfig.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN); 
wifiConfig.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE); 
wifiConfig.status=WifiConfiguration.Status.ENABLED; 

int netId = scanData.wifiManager.addNetwork(wifiConfig); 
scanData.wifiManager.enableNetwork(netId, true); 
```

奇怪的是：在我的平板电脑和其他一些用户的智能手机上，Android 崩溃了！需要明确的是：不是我的应用程序失败了，整个设备重新启动！那么这可能是什么原因呢？有人知道这个问题的解决方法吗？还是我连接网络的方法有问题？

谢谢！

埃尔米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:13:37.290

好的，这个问题似乎无法通过 Android App 本身解决，因为它是底层固件的问题。这个问题出现在其中一款糟糕的爱可视平板电脑上（一般来说都是垃圾）。现在完全相同的代码在摩托罗拉 Xoom 2 上运行没有任何问题。

# jquery - 为什么 AJAX POST 类型在 Symfony2 中这么慢？

> ID：10154540
> 
> 赞同：1
> 
> 时间：2012-04-14T14:58:06.747
> 
> 标签：jquery, symfony

这是JS：

```
(function($) {
     $('#jQueryObj').click(function() {
         $.post('routing', {not important}, function(response) {
             console.log(response);
         });
     });
})(jQuery); 
```

这是 Symfony2 控制器动作：

```
public function ajaxAction()
{
    return new Response('Why is so slow??');
} 
```

响应非常慢，5.02 seg，dev 和 prod 环境。但是，使用 GET 方法时，响应会在 13 毫秒内出现，但我需要使用 POST。

有人可以帮助我并解释原因。

谢谢

# javascript - 这个javascript代码有什么问题？

> ID：10154542
> 
> 赞同：0
> 
> 时间：2012-04-14T14:58:09.463
> 
> 标签：javascript, menu, scrolltop, floating

这段代码有什么问题？

```
function FloatMenu() {
    var scrollAmount = $(document).scrollTop();
    var newPosition = menuPosition + scrollAmount;

    if ($(window).height() < $fl_menu.height() + $fl_menu_menu.height()) {

        $fl_menu.css("top", menuPosition);

    } else {

        $fl_menu.stop().animate({
            top: newPosition
        }, $float_speed, $float_easing);

    }
}​ 
```

完整代码：

```
/* Floating Menu */
//config
$float_speed=500; //milliseconds
$float_easing="easeOutQuint";
$menu_fade_speed=500; //milliseconds
$closed_menu_opacity=0.75;

//cache vars
$fl_menu=$("#fl_menu");
$fl_menu_menu=$("#fl_menu .menu");
$fl_menu_label=$("#fl_menu .label");

$(window).load(function() {
    menuPosition=$('#fl_menu').position().top;
    FloatMenu();
    $fl_menu.hover(
        function(){ //mouse over
            $fl_menu_label.fadeTo($menu_fade_speed, 1);
            $fl_menu_menu.fadeIn($menu_fade_speed);
        },
        function(){ //mouse out
            $fl_menu_label.fadeTo($menu_fade_speed, $closed_menu_opacity);
            $fl_menu_menu.fadeOut($menu_fade_speed);
        }
    );
});

$(window).scroll(function () { 
    FloatMenu();
});

function FloatMenu(){
    var scrollAmount=$(document).scrollTop();
    var newPosition=menuPosition+scrollAmount;
    if($(window).height()<$fl_menu.height()+$fl_menu_menu.height()){
        $fl_menu.css("top",menuPosition);
    } else {
        $fl_menu.stop().animate({top: newPosition}, $float_speed, $float_easing);
    }
} 
```

错误是：

```
Message: 'menuPosition' is undefined 
```

和

```
Message:'position().top' is null or not an object 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:13:29.217

在你的函数中使用一个参数。它将优雅地解决您的问题。

```
function FloatMenu(menuPosition) {
    // Write your code as usual
}

// I guess you meant $(document).ready instead of $(window).load ?
// The main difference is that $(window).load will wait for all the images to be fully loaded, for example
$(document).ready(function() {
    menuPosition=$('#fl_menu').position().top;
    // Since you're using an argument, pass it!
    FloatMenu(menuPosition);

    // Or you can reduce to:
    FloatMenu($('#fl_menu').position().top) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:02:26.303

尝试`menuPosition`在函数范围之外声明：

```
var menuPosition = 0; // declared outside of function scopes

/* Floating Menu */
//config
$float_speed=500; //milliseconds
$float_easing="easeOutQuint";
$menu_fade_speed=500; //milliseconds
$closed_menu_opacity=0.75;

//cache vars
$fl_menu=$("#fl_menu");
$fl_menu_menu=$("#fl_menu .menu");
$fl_menu_label=$("#fl_menu .label");

$(window).load(function() {
    menuPosition=$('#fl_menu').position().top;
    FloatMenu();
    $fl_menu.hover(
        function(){ //mouse over
            $fl_menu_label.fadeTo($menu_fade_speed, 1);
            $fl_menu_menu.fadeIn($menu_fade_speed);
        },
        function(){ //mouse out
            $fl_menu_label.fadeTo($menu_fade_speed, $closed_menu_opacity);
            $fl_menu_menu.fadeOut($menu_fade_speed);
        }
    );
});

$(window).scroll(function () { 
    FloatMenu();
});

function FloatMenu(){
    var scrollAmount=$(document).scrollTop();
    var newPosition=menuPosition+scrollAmount;
    if($(window).height()<$fl_menu.height()+$fl_menu_menu.height()){
        $fl_menu.css("top",menuPosition);
    } else {
        $fl_menu.stop().animate({top: newPosition}, $float_speed, $float_easing);
    }
} 
```

# delphi - 在默认浏览器中打开网页，在 url 中使用双引号 (")

> ID：10154543
> 
> 赞同：7
> 
> 时间：2012-04-14T14:58:10.780
> 
> 标签：delphi, winapi, browser, delphi-7

当我尝试打开链接中包含双引号 ( `"`) 的任何站点时，例如。`user.php?name="stackoverflow"`它只是削减`"`或有时将我重定向到谷歌！？使用的代码：

```
ShellExecute(0, 'open', PChar('open'), PChar(URL), nil, SW_SHOW) ; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T19:24:42.533

您需要使用完全限定`URL`的包括`http://`和转义/编码`URL`通过将双引号 ( `"`)替换为`%22`.

你也传递了错误的参数。

请参阅 MSDN：[使用 ShellExecute 启动默认 Web 浏览器](http://support.microsoft.com/kb/224816)

例子：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  URL: string;
begin
  URL := 'http://www.user.com/?name="stackoverflow"';
  URL := StringReplace(URL, '"', '%22', [rfReplaceAll]);
  ShellExecute(0, 'open', PChar(URL), nil, nil, SW_SHOWNORMAL);
end; 
```

您应该始终对 URL 参数进行编码，而不仅仅是双引号。您可以将 Indy 与`TIdURI.URLEncode`-`IdURI`单元一起使用。
您还可以使用`HTTPEncode`from`HTTPApp`单元对`URL`.

请注意，这也会对 the和分隔符`TIdURI.URLEncode`进行编码。所以我认为将每个参数分别编码是一个更好的主意，例如：`?``&``HTTPEncode`

```
URL := 'http://www.user.com/?param1=%s&param2=%s';
URL := Format(URL, [
  HTTPEncode('"stackoverflow.com"'),
  HTTPEncode('hello word!')]);
// output: http://www.user.com/?param1=%22stackoverflow.com%22&param2=hello+word! 
```

# django - 用于同步倒计时的 Django 和 jQuery Coundown

> ID：10154544
> 
> 赞同：0
> 
> 时间：2012-04-14T14:58:16.327
> 
> 标签：django, time, countdown

我在 Django 中使用[jQuery Coundown 插件](http://keith-wood.name/countdown.html)为每个视图生成准确和同步的数据。

对于所有浏览器上显示的同步时间，我使用[插件的 serverSync 功能](http://keith-wood.name/countdown.html#zones)来传递数据（与示例非常相似），如下所示：

```
function serverTime() { 
    var time;
    $.ajax({url: '/ajax/get-server-time/', 
        async: false, dataType: 'text', 
        success: function(text) { 
            time = new Date(text); 
        }, error: function(http, message, exc) { 
            time = new Date(); 
    }});
    return time;
} 
```

我的倒计时初始化选择器函数就是这样（我通过 Django 将 unixtime 添加到元素的 endDatetime 数据中）：

```
function initAllTimers(selected){
    $(selected).each(function(){
        endDatetime = new Date($(this).attr("data-unixtime") * 1000);
        $(this).countdown({until: endDatetime, serverSync: serverTime});
    });
} 
```

Django 模板生成每个字段以填充计数，如下所示：

```
<span class="timeLeft" data-unixtime="1334898000"></span> 
```

我将时间计数应用于这些字段，如下所示：

```
initAllTimers('.timeLeft'); 
```

最后是 Django 查看方法或为此插件生成时间戳以检索（通过我的 serverTime() 方法）：

```
#points to /ajax/get-server-time/
def get_server_time(request):
    now = datetime.now()
    response = HttpResponse( now.isoformat())
    response['Expires'] = 'Fri, 1 Jan 2010 00:00:00 GMT'
    response['Content-Type'] = 'text/plain; charset=utf-8'
    response['Cache-Control'] = 'no-cache, must-revalidate'
    return response 
```

它可以正确渲染，但不会在不同的计算机之间同步，我的 Mac 显示的剩余时间与我的 windows 计算机不同。

我怀疑我在这部分犯了一个错误：

倒计时示例中的 php 示例`$now->format("M j, Y H:i:s O")."\n";`与我的 python 函数相同`datetime.now().isoformat()`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:04:51.977

`datetime.now().isoformat()`不等同于`$now->format("M j, Y H:i:s O")`

PHP 的格式转义在这里解释[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

您可以使用`strftime()`Python 正确格式化时间戳；文档可在此处[获得 http://docs.python.org/library/datetime.html#strftime-strptime-behavior](http://docs.python.org/library/datetime.html#strftime-strptime-behavior)

`.strftime("%b %d, %Y %H:%M:%S %z")`应该与 PHP`format()`调用几乎相同；如果您没有从 获得合适的偏移量`%z`，您可以手动将`+0000`自己添加到 Python 字符串中。

# spring-security - Spring Security 处理并发异常

> ID：10154545
> 
> 赞同：1
> 
> 时间：2012-04-14T14:58:19.907
> 
> 标签：spring-security

我正在使用 Spring Security 3.0.7。以下是我的安全配置文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <beans:beans xmlns="http://www.springframework.org/schema/security"
        xmlns:beans="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-3.0.xsd">

<http auto-config="false" use-expressions="true"
    access-denied-page="/nazir/auth/denied"
    entry-point-ref="authenticationEntryPoint">
    <intercept-url pattern="/nazir/auth/login" access="permitAll"/>
    <intercept-url pattern="/nazir/main/admin" access="hasRole('ROLE_ADMIN')"/>
    <intercept-url pattern="/nazir/main/common" access="hasRole('ROLE_USER')"/>

    <logout invalidate-session="true" logout-url="/nazir/auth/logout"
    logout-success-url="/nazir/auth/login"/>
    <custom-filter ref="authenticationFilter" position="FORM_LOGIN_FILTER"/>
    <custom-filter ref="concurrencyFilter"    position="CONCURRENT_SESSION_FILTER"/>
    <session-management session-authentication-strategy-ref="sas"/>
</http>

<beans:bean id="authenticationFilter"
    class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
    <beans:property name="sessionAuthenticationStrategy" ref="sas"/>
    <beans:property name="authenticationManager" ref="authenticationManager"/>
    <beans:property name="authenticationFailureHandler" ref="customAuthenticationFailureHandler"/>
    <beans:property name="authenticationSuccessHandler" ref="customAuthenticationSuccessHandler"/>
</beans:bean>
<beans:bean id="customAuthenticationFailureHandler1"
class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
    <beans:property name="defaultFailureUrl" value="/nazir/auth/login"/> 
</beans:bean>
<beans:bean id="customAuthenticationSuccessHandler"
class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler">
    <beans:property name="defaultTargetUrl" value="/nazir/main/common" />
</beans:bean>
<beans:bean id="authenticationEntryPoint"
class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
    <beans:property name="loginFormUrl" value="/nazir/auth/login"/>
</beans:bean>

<authentication-manager alias="authenticationManager">
    <authentication-provider user-service-ref="userDetailsService">
        <password-encoder ref="passwordEncoder"/>
    </authentication-provider> 
</authentication-manager> 

<beans:bean class="org.springframework.security.authentication.encoding.Md5PasswordEncoder"
        id="passwordEncoder"/>

<user-service id="userDetailsService">
    <user name="username" password="ee11cbb19052e40b07aac0ca060c23ee"
        authorities="ROLE_USER, ROLE_ADMIN" />
    <user name="test" password="21232f297a57a5a743894a0e4a801fc3"
        authorities="ROLE_USER" /> 
</user-service> 

<beans:bean id="concurrencyFilter"
    class="org.springframework.security.web.session.ConcurrentSessionFilter">
    <beans:property name="sessionRegistry" ref="sessionRegistry"/>
    <beans:property name="expiredUrl" value="/nazir/auth/session-expired" />
</beans:bean> 

<beans:bean id="sas"      
    class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
    <beans:property name="maximumSessions" value="1" />
    <beans:property name="exceptionIfMaximumExceeded" value="true" />
    <beans:constructor-arg name="sessionRegistry" ref="sessionRegistry" />
</beans:bean>

<beans:bean id="sessionRegistry" class="org.springframework.security.core.session.SessionRegistryImpl" />  

<beans:bean id="customAuthenticationFailureHandler" 
        class="org.springframework.security.web.authentication.ExceptionMappingAuthenticationFailureHandler" >
    <beans:property name="exceptionMappings">
        <beans:props>
            <beans:prop key="org.springframework.security.authentication.CredentialsExpiredException">/nazir/auth/login?error=resetPassword</beans:prop>
            <beans:prop key="org.springframework.security.authentication.BadCredentialsException">/nazir/auth/login?error=BadCredentials</beans:prop>
            <beans:prop key="org.springframework.security.authentication.AccountExpiredException">/nazir/auth/login?error=AccountExpired</beans:prop>
            <beans:prop key="org.springframework.security.authentication.AccountStatusException">/nazir/auth/login?error=AccountStatus</beans:prop>
            <beans:prop key="org.springframework.security.authentication.AuthenticationCredentialsNotFoundException">/nazir/auth/login?error=AuthenticationCredentialsNotFound</beans:prop>
            <beans:prop key="org.springframework.security.authentication.AuthenticationServiceException">/nazir/auth/login?error=AuthenticationService</beans:prop>
            <beans:prop key="org.springframework.security.authentication.DisabledException">/nazir/auth/login?error=Disabled</beans:prop>
            <beans:prop key="org.springframework.security.authentication.InsufficientAuthenticationException">/nazir/auth/login?error=InsufficientAuthentication</beans:prop>
            <beans:prop key="org.springframework.security.authentication.LockedException">/nazir/auth/login?error=Locked</beans:prop>
            <beans:prop key="org.springframework.security.authentication.ProviderNotFoundException">/nazir/auth/login?error=ProviderNotFound</beans:prop>
            <beans:prop key="org.springframework.security.authentication.SessionAuthenticationException">/nazir/auth/login?error=SessionAuthenticationException</beans:prop>
        </beans:props>
    </beans:property>
</beans:bean> 
```

问题（帮助）：如何通过我的`customAuthenticationFailureHandler`过滤器路由 SessionAuthenticationException？上述情况下，所有异常都得到了很好的处理，除了通过 401 路由的 SessionAuthenticationException。如果我使用 SessionAuthenticationException`org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler`而不是 `org.springframework.security.web.authentication.ExceptionMappingAuthenticationFailureHandler`.

问候， 纳齐尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T09:03:57.833

已解决...我在`customAuthenticationFailureHandler`bean 配置中添加了以下属性`:<beans:property name="defaultFailureUrl" value="/login?error=other"/>`

# html - CSS浮动对齐

> ID：10154550
> 
> 赞同：0
> 
> 时间：2012-04-14T14:59:23.330
> 
> 标签：html, css, textbox

例如，我想在第一行文本中显示^(一个)“你的名字”输入框；然后`float: left`用于文本和输入框。在^(第二)行，我想显示相同的信息（文本添加文本框）。你怎么能做 2sup>nd 行（文本添加文本框）不加入第一^行（因为我正在使用`float: left`）？

我认为这不是`<br/>`解决这个问题的最佳方法。所以我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:03:45.957

插入一个 div 以清除行之间的浮动

```
<div style="clear: left"></div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:06:05.137

为防止信息出现在浮动元素旁边，请为它们提供`clear`CSS 属性，并将值设置为`both`或`left`。

该`clear`属性告诉渲染器它应该在同一父元素中的任何浮动元素下渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:06:01.973

很难理解你想要它如何布局。您应该查看 CSS`display`属性。

看看这是否有帮助：http: [//jsfiddle.net/M68Qw/](http://jsfiddle.net/M68Qw/)

# jquery - 下拉列表和日期时间字段一起工作

> ID：10154557
> 
> 赞同：0
> 
> 时间：2012-04-14T15:00:08.910
> 
> 标签：jquery

我今天有最后一个 jQuery 问题。我有两个领域。一个是下拉列表，另一个是日期时间字段。如果用户选择否，那么它需要禁用输入字段并删除日期时间字段内的任何值，或者如果用户选择是，则它将类验证规则添加到日期时间字段。

```
<div class="section _100">
    <label for="comments">Allow Comments</label>
    <div>
        <select name="comments" id="comments">
            <option value="" selected="selected">Please Select An Option</option>
            <option value="0">No</option>
            <option value="1">Yes</option>
        </select>                           
    </div>
</div>

<div class="section _100">
    <label for="datetime">Date Comments Expire</label>
    <div>
        <input id="datetime" type="datetime" name="datetime" />
    </div>
</div>

$('#comments').change(function(){
    $('#datetime').removeAttr('disabled');
    $('#comments').not(this).val(0);
    $('#comments').each(function(){
        if($(this).val().length > 0){
            $('#datetime').attr('value','');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:21:39.517

不确定验证属性...这是我对您的问题的解决方案...

[http://jsfiddle.net/59BVn/](http://jsfiddle.net/59BVn/)

# php - Flash AS2 - 使用 LoadVars() 时网页崩溃

> ID：10154561
> 
> 赞同：0
> 
> 时间：2012-04-14T15:00:26.913
> 
> 标签：php, flash, actionscript-2, loadvars

正如标题所说，我正在我的网页中加载一个 Flash，当我调用**LoadVars()**时，它会使网页崩溃。
这是我的代码：

**闪光**

```
lv = new LoadVars();   
lv.onLoad = onLoadCallBack;  
lv.load("php/flash_getitems.php");

function onLoadCallBack(succes){
    if(succes){
        t = lv[this.totalItems];
        for(i = 1; i<= t; i++){
            key = this.itemName + "" + i;
            itemList.addItemAt(i, key);
        }
    }

}
stop(); 
```

**php**

```
INCLUDE 'connector.php';

$query = mysql_query("SELECT * FROM shop");
$totalrows = mysql_num_rows($query);
echo "&totalItems=$totalrows";

    while($row = mysql_fetch_assoc($query)){
        $id = $row['id'];
        $item = $row['item'];
        $desc = $row['description'];
        $price = $row['price']; 
        echo "&itemName$id=$item";
        echo "&price$id=$price";
        echo "&desc$id=$desc";
    } 
```

这将返回像
**&itemName1=First Item&price1=100&desc1=description**
这样的值，依此类推，id 较高

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:31:47.997

在我看来，您的解析函数有几个语法错误。

看看这是否更好：

```
function onLoadCallBack(success){
    if(success){
        for(var i:Number = 1; i<= lv.totalItems; i++)
            itemList.addItemAt(i, lv["itemName"+i]);
    }
} 
```

`lv["itemName"+i]`将评估为`lv.itemName1`等。您尝试访问未定义的变量，这会导致空引用错误。

# python - 推迟代码以供以后在 python 中执行（如 javascript 中的 setTimeout）

> ID：10154568
> 
> 赞同：53
> 
> 时间：2012-04-14T15:01:00.273
> 
> 标签：python

我必须在 python 中做一个需要执行一段时间的程序，然后（不管它在哪里执行）它必须将信息转储到文件中，关闭文件然后退出。

这里的行为在 JavaScript 中等价于使用`setTimeout(func, 1000000)`，其中第一个参数 (func) 是指向带有退出代码的函数的指针，第二个参数是程序执行的可用时间。

我知道如何用 C 语言（使用 SO 信号）制作这个程序，但是用 python

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-03-17T02:02:43.970

在实践中，[定时器](http://docs.python.org/2/library/threading.html#timer-objects)可能是做你想做的最简单的方法。

此代码将执行以下操作：

*   1 秒后，它打印“arg1 arg2”
*   2 秒后，它会打印“OWLS OWLS OWLS”

===

```
from threading import Timer

def twoArgs(arg1,arg2):
    print arg1
    print arg2
    print ""

def nArgs(*args):
    for each in args:
        print each

#arguments: 
#how long to wait (in seconds), 
#what function to call, 
#what gets passed in
r = Timer(1.0, twoArgs, ("arg1","arg2"))
s = Timer(2.0, nArgs, ("OWLS","OWLS","OWLS"))

r.start()
s.start() 
```

===

上面的代码很可能会解决您的问题。

但！还有另一种方法，即不使用多线程。它的工作原理更像是单线程的 Javascript。

对于这个单线程版本，您需要做的就是将函数及其参数以及函数应该运行的时间存储在一个对象中。

一旦你有了包含函数调用和超时的对象，只需定期检查函数是否准备好执行。

正确的方法是创建一个[优先级队列](http://en.wikipedia.org/wiki/Priority_queue)来存储我们将来要运行的所有函数，如下面的代码所示。

就像在 Javascript 中一样，这种方法不能保证函数会准确地按时运行。一个需要很长时间才能运行的函数会延迟它之后的函数。但它确实保证了一个函数将在其*超时*之前运行。

此代码将执行以下操作：

*   1秒后，打印“20”
*   2秒后，打印“132”
*   3 秒后，它退出。

===

```
from datetime import datetime, timedelta
import heapq

# just holds a function, its arguments, and when we want it to execute.
class TimeoutFunction:
    def __init__(self, function, timeout, *args):
        self.function = function
        self.args = args
        self.startTime = datetime.now() + timedelta(0,0,0,timeout) 

    def execute(self):
        self.function(*self.args)

# A "todo" list for all the TimeoutFunctions we want to execute in the future
# They are sorted in the order they should be executed, thanks to heapq
class TodoList: 
    def __init__(self):
        self.todo = []

    def addToList(self, tFunction):
        heapq.heappush(self.todo, (tFunction.startTime, tFunction))

    def executeReadyFunctions(self):
        if len(self.todo) > 0:
            tFunction = heapq.heappop(self.todo)[1]
            while tFunction and datetime.now() > tFunction.startTime:
                #execute all the functions that are ready
                tFunction.execute()
                if len(self.todo) > 0:
                    tFunction = heapq.heappop(self.todo)[1]
                else:
                    tFunction = None                    
            if tFunction:
                #this one's not ready yet, push it back on
                heapq.heappush(self.todo, (tFunction.startTime, tFunction))

def singleArgFunction(x):
    print str(x)

def multiArgFunction(x, y):
    #Demonstration of passing multiple-argument functions
    print str(x*y)

# Make some TimeoutFunction objects
# timeout is in milliseconds
a = TimeoutFunction(singleArgFunction, 1000, 20)
b = TimeoutFunction(multiArgFunction, 2000, *(11,12))
c = TimeoutFunction(quit, 3000, None)

todoList = TodoList()
todoList.addToList(a)
todoList.addToList(b)
todoList.addToList(c)

while True:
    todoList.executeReadyFunctions() 
```

===

在实践中，您可能会在该 while 循环中进行更多操作，而不仅仅是检查您的超时函数是否准备就绪。您可能正在轮询用户输入、控制某些硬件、读取数据等。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-14T15:45:33.303

您也可以在 python 中使用信号（仅限 unix）

```
import signal, sys

# install a SIGALRM handler 

def handler(signum, frame):
    print "got signal, exiting"
    sys.exit(1)

signal.signal(signal.SIGALRM, handler)

# emit SIGALRM after 5 secs

signal.setitimer(signal.ITIMER_REAL, 5)

# do stuff

i = 1
while True:
    if i % 100000 == 0:
        print i
    i += 1 
```

文档：[http ://docs.python.org/library/signal.html](http://docs.python.org/library/signal.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-08-23T21:21:36.327

`asyncio`在 python 3 中有一个很好的解决方案：

```
import asyncio

def async_call_later(seconds, callback):
    async def schedule():
        await asyncio.sleep(seconds)

        if asyncio.iscoroutinefunction(callback):
            await callback()
        else:
            callback()

    asyncio.ensure_future(schedule())

async def do_something_async():
    await asyncio.sleep(0.5)
    print('Now! async')

async def main():
    print('Scheduling...')

    async_call_later(3, do_something_async)
    async_call_later(3, lambda: print('Now!'))

    print('Waiting...')

    await asyncio.sleep(4)

loop = asyncio.get_event_loop()
loop.run_until_complete(main()) 
```

请注意，python 中的 sleep 和类似函数需要几秒钟，所以我复制了它。但是如果你需要毫秒，你可以提供分数。（例如 0.5 => 500 毫秒）。

这种方法优于[asyncio.call_later](https://docs.python.org/3/library/asyncio-eventloop.html?highlight=call_later#asyncio.loop.call_later)的一个优点是它只适用于同步回调。如果回调是协程，则此实现`awaits` 会更加健壮。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-11-04T17:12:50.290

你可以使用`call_later`python3 的 asyncio 事件循环的方法。下面的示例将正常工作。

```
import asyncio

loop = asyncio.get_event_loop()

def callback():
    print("callback")
    loop.call_later(1, callback)

loop.call_later(1, callback)

async def main():
    while True:
        await asyncio.sleep(1)

loop.run_until_complete(main()) 
```

# java - tcp 客户端和服务器不接收来自对方的数据

> ID：10154571
> 
> 赞同：1
> 
> 时间：2012-04-14T15:01:21.247
> 
> 标签：java, sockets, networking

我正在尝试将数据从客户端套接字发送到服务器，但是，当发送数据时，服务器仍在等待数据，之后客户端套接字然后等待来自服务器的数据。有两个套接字互相等待。有人可以解释什么是错的：

客户：

```
package ssd8ex3_tcp_client;

import java.io.*;
import java.net.*;

public class Ssd8Ex3_TCP_Client {

    private static final int SERVICE_PORT = 2000;

    public static void main(String[] args) {

        String hostname = "localhost";

        int counter = 0;
        while (counter < 1000) {
            try {
                Socket socket = new Socket(hostname, SERVICE_PORT);
                socket.setSoTimeout(50000);
                PrintStream pstream = new PrintStream( socket.getOutputStream() );
                pstream.print(counter);
                pstream.flush();

                BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                String s = reader.readLine();
                System.out.println("Results :" + s);
                socket.close();

            } catch (IOException e) {
                e.printStackTrace();
            }

            counter++;
        }

    }
} 
```

服务器：

```
package ssd8ex3_tcp_server;

import java.io.*;
import java.net.*;

public class Ssd8Ex3_TCP_Server {

    public static final int SERVICE_PORT = 2000;

    public static void main(String[] args) {
        try {
            ServerSocket server_socket = new ServerSocket(SERVICE_PORT);

            System.out.println("Server started");

            for(;;){
                Socket nextClient = server_socket.accept();
                System.out.println("Received request from " + nextClient.getInetAddress() + ":" + nextClient.getPort());

                BufferedReader reader = new BufferedReader(new InputStreamReader(nextClient.getInputStream()));
                String s = reader.readLine();
                OutputStreamWriter out = new OutputStreamWriter(nextClient.getOutputStream());
                PrintWriter pout = new PrintWriter(out);

                pout.print(s);

                out.flush();

                nextClient.close();
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:05:10.247

您的服务器使用`readLine`，它将等待一个完整的行。您的客户使用`print`不附加行尾标记的。所以服务器正在等待该行结束。

在客户端使用`println`（并且对退货交换做同样的事情），事情应该会“解开”。

# oracle - Oracle 选择语句

> ID：10154577
> 
> 赞同：2
> 
> 时间：2012-04-14T15:02:07.247
> 
> 标签：oracle, select

在 mysql 中，我可以编写一个类似“Select a.field1 > a.field2 from a”的查询，我会得到一个 0 和 1 的结果集

我尝试在 oracle 中编写类似的查询，但它不起作用。如何使用 oracle 获得类似的结果集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:03:33.867

尝试

```
Select CASE WHEN a.field1 > a.field2 THEN 1 ELSE 0 END from a 
```

# eclipse - 我的第一个 JSF 程序出错。Tomcat 和 Eclipse

> ID：10154579
> 
> 赞同：3
> 
> 时间：2012-04-14T15:02:21.903
> 
> 标签：eclipse, jakarta-ee, tomcat, jsf-2

我是Java的初学者。我正在使用 eclipse Helios 和 Tomcat 7。

我配置了服务器并编写了我的第一个 JSF 页面，但出现了这个错误：

```
HTTP Status 404 - /
type Status report
message /
description The requested resource (/) is not available.
Apache Tomcat/7.0.27 
```

第一页的代码是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"      
      xmlns:h="http://java.sun.com/jsf/html">

    <h:head>
        <title>JSF 2.0 Hello World</title>
    </h:head>
    <h:body>
        <h3>JSF 2.0 Hello World Example - hello.xhtml</h3>

    </h:body>
</html> 
```

然后我将端口更改为 8088。但是当我`localhost:8088`在浏览器中输入时，我得到了同样的错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T16:45:06.177

这可能是由几个常见原因引起的：

*   很可能是因为您试图在启动时访问这样的内容：localhost:8080/MyProject/

    为此，您必须在 web.xml 中指定欢迎文件列表：

    ```
    <welcome-file-list>
       <welcome-file>index.xhtml</welcome-file>
     </welcome-file-list> 
    ```

    如果您还没有指定 servlet 映射，还可以添加这些行：

    ```
     <servlet-mapping>
       <servlet-name>Faces servlet</servlet-name>
       <url-pattern>*.xhtml</url-pattern>
      </servlet-mapping> 
    ```

    确保您的 index.xhtml 文件位于 Web pages 文件夹中。

*   您已将尝试访问的 .xhtml 文件放置在 Wep pages 文件夹之外的某个位置。

*   您正在尝试访问一些不存在的 .xhtml。

我敢打赌这是第一个，因为日志错误显示：资源**(/)**，所以您可能正在尝试访问欢迎文件。

希望它有所帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-15T17:29:39.017

Tomcat 不附带 jsf 库。下载[jsf lib](https://javaserverfaces.java.net/download.html)文件并将它们放在 \apache-tomcat\lib 文件夹中。重建项目并重新启动服务器，您就可以开始了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T07:15:59.027

您的 jsf 库可能有问题，因此请尝试将它们放在 WEB-inf 下的 lib 文件夹中，然后这样做：右键单击您的项目 -->properties-->java build path-->JSF_lib-->remove in为了避免任何冲突

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T12:30:19.277

你试图做的方式是错误的

在 jsf 中，当我们输入像“localhost:8088\faces\test.jsp”这样的 url 时，首先发生的是这个 url 被解析，如果有任何可以启动 facesServlet 的 url pattren，那么只有 jsf 生命周期开始

现在，当您尝试通过 localhost\8080\ facesservlet 访问它时，此 url 模式必须在部署描述符（即 web.xml）中，因此这就是您的错误的原因。

web.xml 应该有一个类似的条目

Faces servlet *.xhtml

这将确保每当您的网址有 *.xhtml 时，您的 faces servlet cyscle 就会启动。

如果您的 web.xml 有

```
<servlet-mapping>    <servlet-name>Faces servlet</servlet-name>    <url-pattern>/faces/*</url-pattern>   </servlet-mapping> 
```

那么你的网址应该在你的网址中有“面孔”。希望这可以帮助。问候阿尼尔夏尔马

# ant - Ant：你如何让它很好地打印出你的错误？

> ID：10154585
> 
> 赞同：0
> 
> 时间：2012-04-14T15:02:57.153
> 
> 标签：ant, build, warnings

每当我运行 ant 来构建一个大型项目时，我的错误消息都会被一大堆警告淹没。如何使 ant 不打印所有这些警告，或者至少在其构建输出结束时打印错误（或其他一些允许方便读取错误的方法？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T20:08:40.557

您应该阅读有关[ANT 构建侦听器和记录器](http://ant.apache.org/manual/listeners.html)的信息。

例如：

```
ant -listener org.apache.tools.ant.XmlLogger clean build 
```

生成可以使用 XSLT 转换为 HTML 文件的 XML 文件。这使查看日志更加愉快：

```
xsltproc $ANT_HOME/etc/log.xsl log.xml > log.html 
```

# php - 检查表中的所有字段是否为空

> ID：10154592
> 
> 赞同：0
> 
> 时间：2012-04-14T15:04:40.200
> 
> 标签：php, mysql

这个问题以前可能有人问过，但方式不同。我正在尝试检查 mysql 表中的所有字段是否为空。

有一个 ID 字段设置为主键并具有自动索引，因此它有一个值，但其余列默认为空。

这是我到目前为止所拥有的：

```
public function check_empty_table() {
    $sql = "SELECT * FROM products";

    $fields = array();

    if ($stmt = $this->connect->prepare($sql)) {
        $stmt->execute();
        while ($stmt->fetch()) {

        }
    }

} 
```

我还应该添加什么？我抓取什么或如何抓取并不重要，我只想将所有数据放入该数组中，然后检查该数组是否为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:13:30.203

如果要检查表是否为空，可以使用

```
SELECT COUNT(*) FROM table; 
```

如果里面什么都没有，它应该返回 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:58:29.060

COUNT() 很酷的一点是它不计算 NULL 值。

因此，如果您对除 ID 列之外的每一列都执行此操作，并且每列都得到零，那么它就是“空白”：

```
SELECT COUNT(COL1), COUNT(COL2) FROM products 
```

# less - 在 LESS 的选择器中使用变量

> ID：10154595
> 
> 赞同：7
> 
> 时间：2012-04-14T15:04:54.273
> 
> 标签：less

我有一个变量`@index`，我想输出一个选择器，以便当`@index`是时`3`，选择器是`[data-sth="3"]`。

更长的例子：

```
@index: 3;
/* selector here */ {
    color: red;
} 
```

期望的输出：

```
[data-sth="3"] {
    color: red;
} 
```

我已经尝试了一些东西，但还没有设法得到任何有效的东西。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-14T15:27:43.967

请参阅[变量插值](http://lesscss.org/features/#variables-feature-variable-interpolation)。IE：

```
[data-sth="@{index}"] {
    color: red;
} 
```

* * *

*原始答案（1.40 之前的较少版本）：*

> 以下代码应该可以工作：
> 
> `(~'[data-sth="@{index}"]') { color: red; }`
> 
> `~`删除引号。

# virtualization - 简单的虚拟化方法

> ID：10154597
> 
> 赞同：0
> 
> 时间：2012-04-14T15:05:04.530
> 
> 标签：virtualization, sandbox

我们正在开发一个在线评判系统来测试学生的计算几何问题的解决方案。此时我们需要一个测试环境：我们必须限制时间和内存使用（只接受最佳解决方案），并且由于我们运行不受信任的代码，我们必须禁止一些系统调用（如 fork）、禁用网络等。将是这项任务最简单的（开源）虚拟化解决方案吗？据我了解，我将不得不使用打补丁的内核（如 OpenVZ），或者可以找到一个简单的工具，它将接受限制和不受信任的程序作为其参数并运行它？PS 如果这很重要——我们运行 c++ 代码，但是，我们希望使用通用解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T01:32:18.377

如果问题只涉及标准输入/标准输出，例如读取一些输入然后计算输出，你可以看看[seccomp](http://en.wikipedia.org/wiki/Seccomp)真的很简单。

同样在不久的将来，[第二种模式的 seccomp](http://lkml.org/lkml/2012/2/24/490)可能会进入内核，这将使您更加灵活。

# javascript - JavaScript将变量传递给内部点击功能不起作用

> ID：10154605
> 
> 赞同：0
> 
> 时间：2012-04-14T15:05:57.720
> 
> 标签：javascript, function, variables

我似乎无法弄清楚这一点。**它在for 循环**的第一部分工作正常，但是 var 在我评论过它中断的内部点击函数上丢失了......

另外，可能有一种更简洁的方式来编写它：

```
$(function () {
var a = "rgb(58,88,90)";
var b = "rgb(123,156,158)";
for (var c = 1; c <= 3; c++) {
    if ($("#select" + c).is(":checked")) {
        $("#select" + c + "-icon").css("background", a);
        var d = document.getElementById("select" + c + "_title").innerHTML;
        $("#Selection_" + c).val(d)
    } else {
        $("#select" + c + "-icon").css("background", b);
        $("#Selection_" + c).val("Off")
    }
    $("#select" + c).click(function () {
    // here's where it stops working... var c is no longer recognized...
        if ($("#select" + c).is(":checked")) {
        $("#select" + c + "-icon").css("background", a);
        var d = document.getElementById("select" + c + "_title").innerHTML;
        $("#Selection_" + c).val(d)
    } else {
        $("#select" + c + "-icon").css("background", b);
        $("#Selection_" + c).val("Off")
    }
    })
}
return false }); 
```

这是它定位的第一对对象：

```
<label for="select1"><aside id="select1-icon" class="icon-form right rounded"><img src="../common/images/icon-viewDemo.png" /></aside>
                <input type="checkbox" id="select1" name="select" checked="checked" class="view" /> <h5 id="select1_title">Watch Demo</h5></label> 
```

和：

```
<input type="hidden" id="Selection_1" name="Selection_1" value=""/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:46:18.233

您正在捕获循环变量，因此当`for`循环完成时，变量`c`的值为 4，这是函数在执行时看到的值。

```
var x;
for (var c = 0; c <= 3; c++) {
  x = function() { alert(c); };
}
x(); 
```

这将发出警报`4`，因为在您调用`x()`时，变量`c`已具有值`4`。

如果你想捕获的值`c`而不是变量本身，你可以给每个函数一个单独的副本。为了便于阅读，我将处理程序拆分为一个单独的本地函数。

```
function createClickHandler(c) {
    return function() {
        if ($("#select" + c).is(":checked")) {
            $("#select" + c + "-icon").css("background", a);
            var d = document.getElementById("select" + c + "_title").innerHTML;
            $("#Selection_" + c).val(d)
        } else {
            $("#select" + c + "-icon").css("background", b);
            $("#Selection_" + c).val("Off")
        }
    }
};
$("#select" + c).click(createClickHandler(c)); 
```

[您可以在此 Web 页面](http://www.mennovanslooten.nl/blog/post/62)和[较早的 stackoverflow 问题](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)中了解有关此现象的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:33:28.223

c 在全局范围内不存在，因此单击时它不存在。如果您将其设为全局，则单击发生时它不会具有您想要的值。所以使用 eval(); 用它的文字值替换 c ，因此当点击时，你有你想要的值。

```
$(
    function () {
        var a = "rgb(58,88,90)";
        var b = "rgb(123,156,158)";
        for (var c = 1; c <= 3; c++) {
            if ($("#select" + c).is(":checked")) {
                $("#select" + c + "-icon").css("background", a);
                var d = document.getElementById("select" + c + "_title").innerHTML;
                $("#Selection_" + c).val(d);
            } else {
                $("#select" + c + "-icon").css("background", b);
                $("#Selection_" + c).val("Off");
            }
            eval(
                '$("#select"' + c + ').click(function () {' +
                    'if ($("#select"' + c + ').is(":checked")) {' +
                        '$("#select"' + c + '"-icon").css("background", a);' +
                        'var d = document.getElementById("select"' + c +
                            '"_title").innerHTML;' +
                        '$("#Selection_"' + c + ').val(d)' +
                    '} else {' +
                        '$("#select"' + c + '"-icon").css("background", b);' +
                        '$("#Selection_"' + c + ').val("Off");' +
                    '}' +
                '});'
            );
        }
        return false;
    }
); 
```

# mysql - MySQL - 如何通过特定的行数进行分页？

> ID：10154608
> 
> 赞同：0
> 
> 时间：2012-04-14T15:06:22.120
> 
> 标签：mysql, pagination

假设我的数据库中有 5000 行。我想对结果进行分页，但我只想对最后 1000 行进行分页，而不是全部 5000 行。我该怎么做？我会有这样的查询：

```
SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT 0,25 
```

但是这个查询会获取所有 5000 个结果。我只想获取最新的 1000 个结果并对其进行分页。我该怎么做？我确实有一个 id 字段，它是一个主键，自动递增。不知道这是否会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:39:44.200

如果要使用 SQL 进行分页，则需要连续调用这些查询：

```
SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT 1000,25
SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT 1025,25
SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT 1050,25
...
... 
```

换句话说

```
SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT <offset>,<pageSize> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:13:27.437

尝试这样的事情：

```
SELECT * FROM table WHERE id > ((SELECT MAX(id) FROM table) - 1000); 
```

或者这个：

```
SELECT * FROM (SELECT * FROM table ORDER BY id DESC LIMIT 1000) AS ttbl ORDER BY
                                                                              id ASC; 
```

# java - Java：访问祖父母的状态

> ID：10154611
> 
> 赞同：0
> 
> 时间：2012-04-14T15:06:36.353
> 
> 标签：java, inheritance, overriding, superclass

我知道在 Java 中，尤其是当您进行字段隐藏时，您可以访问祖父母的状态变量：

```
((Grandparent) this).hiddenField 
```

为什么方法调用的情况并非如此？你可以调用 super.method()，为什么不能调用其他祖先的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:40:10.160

因为方法是虚拟的，而字段不是。目标是无论引用类型如何都调用相同的方法：

`(Grandparent) this).method()`总是等于`this.method()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:41:23.640

对于实例方法，没有类似的字段隐藏。与实例字段或**静态**方法不同，实例方法受动态调度的影响，这是一个完全不同的故事。从某种意义上说，被覆盖的方法不再“存在”，唯一的例外是在覆盖方法体内，只有被直接覆盖的方法。

# c++ - C++ 错误：预期为“{”

> ID：10154614
> 
> 赞同：0
> 
> 时间：2012-04-14T15:07:01.423
> 
> 标签：c++

帮助！我是 C++ 新手...如何修复此头文件？

```
#pragma once
class MyCls2
{
private:
    int _i, _j;
public:
    MyCls2(int i, int j) : _i(i), 
                            _j(j)
    MyCls2(); // error: expected a '{'
    ~MyCls2(void);
}; 
```

这是 MS VC 2010 中的错误：

> 错误：应为“{”

* * *

感谢您的帮助，我现在得到了我想要的：

。H：

```
#pragma once
class MyCls2
{
private:
    int _i, _j;
public:
    MyCls2(int i, int j) ;
    MyCls2();
    ~MyCls2(void);
}; 
```

.cpp：

```
#include "StdAfx.h"
#include "MyCls2.h"

MyCls2::MyCls2()
{
}

MyCls2::MyCls2(int i, int j) : _i(i), 
    _j(j)
{
}
MyCls2::~MyCls2(void)
{
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:08:07.870

您正在使用初始化列表提供构造函数定义。因此，它需要`{}`像任何其他（成员）函数一样。

```
MyCls2(int i, int j) : _i(i), 
                       _j(j) {} // Missing the opening and closing braces 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T15:08:13.100

您在使用`MyCls2`两个整数的构造函数的定义中缺少函数体。

```
MyCls2(int i, int j) : _i(i), 
                        _j(j) {} 
```

将初始化列表视为构造函数本身的一部分（它的定义，而不是它的声明）。您不能在某处拥有函数定义的一部分，而在其他地方拥有另一部分。

如果您想要在标头中使用初始化列表，您还需要在标头中包含该定义的其余部分（构造函数主体），如上所述。
如果你不想在头文件中定义，不要把初始化列表放在头文件中，把它放在实现文件中。

```
//header
  MyCls2(int i, int j); 
```

```
// implementation

MyCls2::MyCls2(int i, int j) : _i(i), _j(j)
{
   // constructor body
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:08:33.397

代替

```
MyCls2(int i, int j) : _i(i), 
                        _j(j) 
```

和

```
MyCls2(int i, int j) : _i(i), _j(j) { } 
```

构造函数需要一个主体，即使它是一个空的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:09:33.710

构造函数的大括号：

```
MyCls2(int i, int j) : _i(i), 
                            _j(j) {} 
```

# php - 如何为其他服务器上的重定向页面或新打开的页面设置超时？

> ID：10154615
> 
> 赞同：0
> 
> 时间：2012-04-14T15:07:09.980
> 
> 标签：php, javascript, jquery

我想将我的页面重定向到其他页面，例如 google.com 或在浏览器中打开 google.com 作为附加页面。

有什么方法可以在 10 分钟超时后关闭其他打开的谷歌页面（如果它作为新页面打开）或返回我的页面（如果我的页面被重定向到谷歌页面）？

我尝试使用 $_SESSION，但没有成功。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:13:26.237

不，如果您重定向，则无法返回您的页面。浏览器不再在您的页面上，就浏览器而言，它已经消失了。

至于打开另一个窗口，应该可以设置一个计时器来检查另一个页面是否已加载，但如果该页面位于另一个域上，则可能存在安全问题。

# image - 比较不同分辨率的图像

> ID：10154622
> 
> 赞同：8
> 
> 时间：2012-04-14T15:07:57.657
> 
> 标签：image, image-processing, hash, comparison

是否可以比较具有不同分辨率的两张图像？

我的意思是这里有一些算法/编程方法。例如，现在我**从图像的字节数组中计算哈希码**并比较这些哈希码值。这是很好的工作，但在不同分辨率的情况下会失败，即图像在**眼睛上是相同的，**但字节内容不同。

例如看我的图片附件：
![在此处输入图像描述](../Images/fd7b00177e763b28f9df1adafa670a9f.png)![在此处输入图像描述](../Images/b30e72e0224e556b82c4a8edd0094e40.png)

其中一个有**72 ppi**，但另一个有**96 ppi**。我想在比较相等时获得**TRUE**值，但现在我得到**FALSE**。请帮助在这里找到正确的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T17:47:08.943

在进入更复杂的领域之前，您可以尝试两种非常简单的感知散列方法，它们基于离散余弦变换和图像的局部与全局均值：

1.  将图像转换为灰度

    1.1（编辑）使您的图像零均值

2.  将您的图像压缩到缩略图大小，例如 [32x32]
3.  运行二维离散余弦变换
4.  保留左上角 [8 x 8]，最重要的低频分量
5.  根据组件的符号对块进行二值化
6.  结果是 64 位哈希

这个主题的一个变体是

1.  将图像转换为灰度
2.  可以选择将大小重新调整为预定义的大小。
3.  将图像划分为固定数量的块
4.  确定全局平均值
5.  确定每个块的局部平均值
6.  对于散列，每块写出 1 或 0，如果局部平均值大于或小于全局平均值，则待定。

另外，看看[phash](http://www.phash.org)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-14T15:26:00.493

对于具有几种不同颜色的合成图像，我将从直方图匹配开始。

基本上将每个图像中每种颜色的像素数相加，然后除以像素总数。然后你有一个简单的浮点向量作为指纹。如果您希望具有更多或更少边框的图像算作匹配，则可以忽略白色

它不会检测到重新排列切片的相同图像，或者文本向下移动一行，但我认为这不是这种情况下的问题

# java - Vala 逐行读取文件

> ID：10154625
> 
> 赞同：0
> 
> 时间：2012-04-14T15:08:16.910
> 
> 标签：java, file-io, io

```
int n = sc.nextInt();
char[][] original = new char[n][n];
char [][] result = new char[n][n];
String line;

for (int i = 0; i < n; i++) {
  line = sc.nextLine();
  System.out.println(line);
  for (int u = 0; u < n; u++) {
    original[i][u] = line.charAt(u);
  }
}

for (int i = 0; i < n; i++) {
  line = sc.nextLine();
  for (int u = 0; u < n; u++) {
    result[i][u] = line.charAt(u);
  }
} 
```

我有一个看起来像这样的文件：

```
2
ha
ah
lo
ol 
```

我在第一行有一个整数 N，然后是两个 N*N 字符矩阵。

我正在尝试将它们读入两个字符数组数组，但出现此错误：

线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：transform.main(transform.java:25) 处 java.lang.String.charAt(String.java:695) 处的 0

第 25 行是这样的：

```
original[i][u] = line.charAt(u); 
```

我只是不明白，我想我做的一切都很好。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:16:06.033

我想你`sc`是一个扫描仪实例？该方法`nextInt()`确实从您的文件中读取下一个数字，但不*处理*以下换行符。因此，您的第一次调用`nextLine()`将只返回一个空字符串（即所有字符，直到尚未处理的换行符）。你会看到你`println(...)`调用确实打印了一个空行。您可以在循环之前插入调用`newLine()`以修复此行为。

# c - 在 printf 之后将变量的内容转换为指针导致 NULL

> ID：10154630
> 
> 赞同：-1
> 
> 时间：2012-04-14T15:08:34.437
> 
> 标签：c, pointers, casting, printf, low-level

我尝试实现以下目标：我有一个指向地址的指针`p`，该地址再次保存一个地址（该地址也是一个有效地址）。现在我想要另一个指向`pp`地址的指针，它是`p`. 所以我正在做以下事情：

```
// Retrieve the start address
unsigned long long *p = getInitialAddress();

// Let pp point to next address
unsigned long long *pp = (unsigned long long*)(*p);

// Print address
printf("0x%llx %p\n", *p, pp); 
```

例如，这将打印：`0x7fffedc47a70 0x7fffedc47a70`这是所需的结果。

但是，将另一个`printf`放入代码中，如下所示：

```
// Retrieve the start address
unsigned long long *p = getInitialAddress();

// Print
printf("%p 0x%llx\n", p, *p);

// Let pp point to next address
unsigned long long *pp = (unsigned long long*)(*p);

// Print address
printf("0x%llx %p\n", *p, pp); 
```

导致：

```
0x7fffacea3660 0x7fffacea3680
0x0 (nil) 
```

这不是正确的结果，因为它**应该是**

```
0x7fffacea3660 0x7fffacea3680
0x7fffacea3680 0x7fffacea3680 
```

那么`printf`指针中的内容是否有所改变或有什么问题？

**编辑：完整代码**

```
unsigned long long* readRBP();

int main(void) {
    // Retrieve the start address
    unsigned long long *p = readRBP();

    // Print
    printf("%p 0x%llx\n", p, *p);

    // Let pp point to next address
    unsigned long long *pp = (unsigned long long*)(*p);

    // Print address
    printf("0x%llx %p\n", *p, pp);

    return 0;
}

unsigned long long* readRBP() {
    unsigned long long rbp;
    __asm__ volatile("mov %%rbp, $0" : "=r"(rbp));
    return (unsigned long long*)rbp;
} 
```

这将获得 rbp（堆栈基指针）。这个指针的内容就是指向下一个rbp的指针，以此类推。**这个**rbp 来自`readRBP()`它自己，下一个 rbp 属于，`main`main 之后的下一个是`0x0`，即最开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:59:44.863

返回的值`readRBP`是函数的基指针`readRBP`。然后调用`printf`which 创建自己的堆栈帧。并且该堆栈帧会删除`*p`.

要看到这是这样，您可以这样编写代码：

```
int main(void) {
    // Retrieve the start address
    unsigned long long *p = readRBP();
    unsigned long long pContents = *p
    unsigned long long *pp = (unsigned long long*)(*p);

    // Print
    printf("%p 0x%llx %p\n", p, pContents, pp);

    return 0;
} 
```

换句话说，您将所有信息收集到的堆栈框架中`main`，然后通过调用`printf`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:19:30.390

```
 // Let pp point to next address
  unsigned long long *pp = (unsigned long long*)(*p); 
```

评论是错误的。`pp`不指向下一个地址，而是*指向*通过转换`p`. 我不知道`getInitialAddress()`应该返回什么，但如果它是调用`calloc`，或分配一些内存，`malloc`然后用 清零`memset`，则很可能指向的内存区域`p`从零开始。

顺便说一句，您假设`long long`and `void*`（即数据指针）具有相同的大小。我不知道它在你的系统上是否正确（例如在 Linux/i686 系统上是错误的）。如果您想要与指针大小相同的整数大小，则更好地使用`intptr_t`并包含`<stdint.h>`

要探索你的堆栈，假设最近有一个 GCC 编译器，你可能会对内置的[返回地址](http://gcc.gnu.org/onlinedocs/gcc-4.7.0/gcc/Return-Address.html#Return-Address)感兴趣，`__builtin_return_address`或者`__builtin_frame_address`

# git - 从 github 存储库更新（Ubuntu）VPS？

> ID：10154631
> 
> 赞同：0
> 
> 时间：2012-04-14T15:08:41.643
> 
> 标签：git, ubuntu, github, vps

我刚刚开始使用 git，我在本地机器上设置并运行了所有东西。在我的本地机器上进行修改后，我现在想做的是能够将代码（一个 WordPress 主题）下载到我的 VPS 上的 /var/www/。这是可以用 git 轻松完成的事情，还是有更好的方法使用另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:08:00.960

[此](http://sebduggan.com/blog/deploy-your-website-changes-using-git/)页面显示了一种使用 post 接收挂钩的方法。

*   在存储库的 hooks 目录中创建一个文件 post-receive：

> #!/bin/sh
> GIT_WORK_TREE=/path/to/webroot/of/mywebsite git checkout -f

*   确保目标目录存在，因为 Git 不会为您创建它。最后，设置文件的权限：

> $ chmod +x hooks/post-receive

# c# - “User.Identity.Name”安全吗？

> ID：10154632
> 
> 赞同：4
> 
> 时间：2012-04-14T15:09:16.420
> 
> 标签：c#, asp.net, security, forms-authentication

我想知道是否可以使用*User.Identity.Name*从我的数据库中查询数据。
前任：

```
UsersBLL.GetPersonalInformation(string username) 
```

*将User.Identity.Name*的值传递给这个方法是个好主意吗？
User.Identity.Name 的值会被劫持吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:15:31.493

User.Identity.Name 与任何其他方式一样安全。有可能劫持它吗？也许，如果您不使用 ssl 并且您没有加密您的身份验证机制，但如果您使用 SSL 并使用加密的 FormsAuthentication 或 Windows 身份验证，您应该没问题。

基本上，如果您遵循良好的安全实践，它应该是完全安全的。至少不亚于任何其他识别用户的方式。

编辑：

这假设您不是在用户名上键入表，而是通过成员身份用户 ID，并且您的代码只是按名称在成员资格表中查找用户 ID。

如果您在用户名上键入表，则需要考虑许多安全问题。其中之一就是 Henk 在他的回答中提到的。如果您不允许更改或重复使用用户名，那么这不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T11:15:57.097

会不会被劫持？是的，例如由于[传输层保护不足](http://www.troyhunt.com/2011/11/owasp-top-10-for-net-developers-part-9.html)而通过会话劫持（该链接中的工作示例），但这对于成员资格提供程序实施本身来说不是风险。

我不会传递用户名，而是坚持使用 ID：

```
var user = Membership.GetUser();
var userId = (Guid?)user.ProviderUserKey; 
```

我假设任何依赖于 aspnet_Users 用户表的表（再次假设您使用的是默认成员资格提供程序），都使用 ID 作为外键而不是用户名。至少我希望是这样的！

# python - 在 Python 中将 CSV 数据加载到 MySQL

> ID：10154633
> 
> 赞同：56
> 
> 时间：2012-04-14T15:09:17.027
> 
> 标签：python, mysql

不确定我在这里遗漏了什么，但此代码运行时没有任何错误消息，但表中没有任何内容。我正在将三列中的 CSV 值加载到 mysql 表中

```
import csv
import MySQLdb

mydb = MySQLdb.connect(host='localhost',
    user='root',
    passwd='',
    db='mydb')
cursor = mydb.cursor()

csv_data = csv.reader(file('students.csv'))
for row in csv_data:

    cursor.execute('INSERT INTO testcsv(names, \
          classes, mark )' \
          'VALUES("%s", "%s", "%s")', 
          row)
#close the connection to the database.
cursor.close()
print "Done" 
```

如果其他人可以看看，将不胜感激。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-04-14T15:11:44.340

我认为你必须做`mydb.commit()`所有的插入。

像这样的东西

```
import csv
import MySQLdb

mydb = MySQLdb.connect(host='localhost',
    user='root',
    passwd='',
    db='mydb')
cursor = mydb.cursor()

csv_data = csv.reader(file('students.csv'))
for row in csv_data:

    cursor.execute('INSERT INTO testcsv(names, \
          classes, mark )' \
          'VALUES("%s", "%s", "%s")', 
          row)
#close the connection to the database.
mydb.commit()
cursor.close()
print "Done" 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2019-09-23T04:10:08.143

如果您没有**pandas**和**sqlalchemy**库，请使用 pip 安装它们

```
pip install pandas
pip install sqlalchemy 
```

我们可以使用**pandas**和**sqlalchemy**直接插入数据库

```
import csv
import pandas as pd
from sqlalchemy import create_engine, types

engine = create_engine('mysql://root:*Enter password here*@localhost/*Enter Databse name here*') # enter your password and database names here

df = pd.read_csv("Excel_file_name.csv",sep=',',quotechar='\'',encoding='utf8') # Replace Excel_file_name with your excel sheet name
df.to_sql('Table_name',con=engine,index=False,if_exists='append') # Replace Table_name with your sql table name 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-07-04T09:49:16.990

上面的答案似乎很好。但另一种方法是添加自动提交选项以及 db connect。这会自动提交在数据库中执行的所有其他操作，避免`sql.commit()`每次都使用提及。

```
 mydb = MySQLdb.connect(host='localhost',
        user='root',
        passwd='',
        db='mydb',autocommit=true) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-14T12:36:55.070

```
 from __future__ import print_function
import csv
import MySQLdb

print("Enter  File  To Be Export")
conn = MySQLdb.connect(host="localhost", port=3306, user="root", passwd="", db="database")
cursor = conn.cursor()
#sql = 'CREATE DATABASE test1'
sql ='''DROP TABLE IF EXISTS `test1`; CREATE TABLE test1 (policyID int, statecode varchar(255), county varchar(255))'''
cursor.execute(sql)

with open('C:/Users/Desktop/Code/python/sample.csv') as csvfile:
    reader = csv.DictReader(csvfile, delimiter = ',')
    for row in reader:
        print(row['policyID'], row['statecode'], row['county'])
        # insert
        conn = MySQLdb.connect(host="localhost", port=3306, user="root", passwd="", db="database")
        sql_statement = "INSERT INTO test1(policyID ,statecode,county) VALUES (%s,%s,%s)"
        cur = conn.cursor()
        cur.executemany(sql_statement,[(row['policyID'], row['statecode'], row['county'])])
        conn.escape_string(sql_statement)
        conn.commit() 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-05-14T07:24:06.930

如果有帮助，请使用 pymsql

```
import pymysql
import csv
db = pymysql.connect("localhost","root","12345678","data" )

cursor = db.cursor()
csv_data = csv.reader(open('test.csv'))
next(csv_data)
for row in csv_data:
    cursor.execute('INSERT INTO PM(col1,col2) VALUES(%s, %s)',row)

db.commit()
cursor.close() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-08T15:26:52.337

如果它是熊猫数据框，您可以这样做：

# 发送数据

```
csv_data.to_sql=(con=mydb, name='<the name of your table>',
  if_exists='replace', flavor='mysql') 
```

避免使用`for`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-15T07:58:11.850

最快的方法是通过“load data infile”语句使用 MySQL 批量加载器。这是迄今为止你在 Python 中想出的任何方法中最快的方法。如果您必须使用 Python，您可以从 Python 本身调用语句“load data infile”。

# php - PHP，缩进宽度为 4，CodeSniffer：“4”是事实上的标准吗？

> ID：10154634
> 
> 赞同：4
> 
> 时间：2012-04-14T15:09:19.950
> 
> 标签：php, indentation

我在[这里](https://webmasters.stackexchange.com/questions/28494/php-codesniffer-indentation-of-2-is-ignored-it-just-checks-4/28512)问了一个问题，因为我所有的 Php 代码都缩进了 2，而不是 4。

Php CodeSniffer 是一个非常棒的工具，缩进为“4”，您似乎无法更改该值。

Php CodeSniffer 有很多选择。所以这应该很容易添加“缩进宽度”。但似乎创作者**自愿**避免了这种可能性，因为这是不可能的（恕我直言，这很奇怪）。

所以如果你不能改变这一点，我想知道：“缩进宽度 = 4”是事实上的标准吗？

这对于 Java/JavaDoc 生成是否相同？

我是否必须将所有 10.000 多行代码更改为 4 - 缩进宽度？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-15T00:23:12.793

嗅探器中的任何公共成员 var 都可以使用 ruleset.xml 文件进行覆盖。ruleset.xml 文件是您自己的自定义编码标准的 XML 表示。它可以从任何包含的标准导入嗅探，如果您选择编写它们，还可以包含您自己的自定义嗅探。

在您的情况下，您需要确切的 PEAR 标准，但缩进值已更改。因此，创建一个文件`mystandard.xml`并将其作为内容：

```
<?xml version="1.0"?>
<ruleset name="MyStandard">
 <description>My custom PEAR coding standard.</description>
 <rule ref="PEAR"/>
 <rule ref="PEAR.WhiteSpace.ScopeIndent">
  <properties>
   <property name="indent" value="2"/>
  </properties>
 </rule>
</ruleset> 
```

`phpcs --standard=PEAR ...`现在，不要使用您使用的命令运行 PHP_CodeSniffer`phpcs --standard=/path/to/mystandard.xml ...`

请注意，您可以随意调用标准并将 XML 元数据（名称和描述）更改为更合适的名称。

您可以使用自定义 ruleset.xml 文件执行更多操作。您可以在此处找到有关自定义规则集的更多信息：http: [//pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php](http://pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:19:18.143

不，这不是事实上的标准。缩进没有标准。

您可以使用 --sniffs 选择规则——请参阅[手册](http://pear.php.net/manual/en/package.php.php-codesniffer.usage.php)。您不需要进行压痕测试。

如果 PHP CodeSniffer 好用，那么可以在您的编码标准中定义缩进样式。但是文档中没有提到它。

或者，您可以按照此处所述编写自己的规则：http: [//pear.php.net/manual/en/package.php.php-codesniffer.coding-standard-tutorial.php](http://pear.php.net/manual/en/package.php.php-codesniffer.coding-standard-tutorial.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:19:03.697

我发现的`PHP_CodeSniffer\CodeSniffer\Standards\Generic\Sniffs\WhiteSpace\ScopeIndentSniff.php`是`public $indent = 4;`。

您可能只想更改此值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T15:13:07.133

PHP CodeSniffer 有规则，据我所知，您应该能够创建一个定义缩进的规则。4 只是一些值，比如 2。所以应该可以。可能不是作为一种选择，而是在您定义标准时。

# ruby-on-rails - 从数据映射器中 PostgreSQL 的二进制列中删除限制

> ID：10154641
> 
> 赞同：3
> 
> 时间：2012-04-14T15:10:15.487
> 
> 标签：ruby-on-rails, postgresql, datamapper, database-migration

我正在尝试在 Datamapper for Rails 3 中创建一个带有 Binary 字段的模型，如下所示：

```
class Image

  include DataMapper::Resource

  # attributes
  property :id, Serial
  property :url, String
  property :file_name, String
  property :content_type, String
  property :data, Binary
  property :created_at, DateTime
  property :updated_at, DateTime

end 
```

但是，当我尝试迁移时，我得到以下信息：

```
ERROR:  type modifier is not allowed for type "bytea"
LINE 1: ..." VARCHAR(50), "content_type" VARCHAR(50), "data" BYTEA(50),... 
```

我似乎无法找到一种方法来消除 datamapper 放置在该字段上的 50 的限制。有人知道如何做到这一点或解决问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-15T00:23:47.650

这是 DataMapper 中的一个错误。看看[这个线程](https://github.com/datamapper/dm-migrations/pull/33)。它已在 GitHub 中修复，但尚未发布。如果你没问题，很容易修补 dm-migrations 来修复它。在“dm-migrations/adapters/dm-do-adapter.rb”中，您会找到说

```
if dump_class.equal?(String) && schema_primitive != 'TEXT' && schema_primitive != 'CLOB' && schema_primitive != 'NVARCHAR' 
```

并附加

```
&& schema_primitive != 'BYTEA' 
```

到最后。

我在这里测试了你的代码，它适用于应用的补丁。

# javascript - 具有 css 属性的正则表达式

> ID：10154643
> 
> 赞同：0
> 
> 时间：2012-04-14T15:10:20.230
> 
> 标签：javascript, css, regex

我有带有 css 属性及其值的字符串：

```
str = "filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#cccccc', endColorstr='#000000');
       background: -webkit-linear-gradient(top, black, white);
       animation-duration: 12s;"; 
```

我想我的比赛只返回属性

```
properties = text.match(/[^;:]*:/g); 
```

但它也返回“progid：”，我该如何避免它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:28:31.383

搜索行首或“;” 以及（或者可能是换行符/制表符，具体取决于您的字符串格式）：

```
/(^|;)[^:;]*:/ 
```

不过，您仍然需要稍微清理一下结果。

或者，您可以将字符串拆分为“;” 首先，然后在“：”上拆分每个位，并为您的属性获取每个位的第 0 个成员：

```
var str = "filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#cccccc', endColorstr='#000000');background: -webkit-linear-gradient(top, black, white);animation-duration: 12s;";

var rules = str.split(";")

var i, l = rules.length;

var properties = [];

for( i = 0; i < l; i++ ){
    properties.push( rules[ i ].split(":")[0] ); //dangerous if you're not sure you'll always have a result
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:20:29.357

请试试

```
properties = text.match(/^[^;:]*:/g); 
```

编辑：这是一个更好的解决方案，前提是属性和值之间总是有空格：

```
properties = text.match(/[^ ;:]+(?=: )/g) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T16:21:01.117

为了避免在以字符串结尾的半边分割时出现空规则，

拆分半决赛，内容紧随其后；

```
var rules= str.split(/;(?=\S+)/);

for(var i= 0, L= rules.length; i<L; i++){
    rules[i]= rules[i].split(':')[0];   
}

/* 
alert(rules)>>(Array)
filter, background, animation-duration
*/ 
```

# android - 安卓认证

> ID：10154645
> 
> 赞同：1
> 
> 时间：2012-04-14T15:10:42.740
> 
> 标签：android, web-services, authentication, rest, login

我正在尝试创建需要对用户进行身份验证的 Android 应用程序（通过 REST Web 服务）。该应用程序有多个活动和屏幕，都需要用户登录，登录后用户可以在网站上添加和编辑帖子。

我已经读过在“ConnectionManager”单例中使用 AndroidHttp 客户端是最好的方法。但是，我将在哪里存储用户详细信息（用户名、密码），这会在单例中吗？每次用户尝试编辑/添加内容时我应该进行身份验证吗？

我应该有这样的课程：

```
public class ConnectionManager {

    private static ConnectionManager instance = null;
    private AndroidHttpClient client;

    private ConnectionManager() {
        client = AndroidHttpClient.newInstance("Android-Connection-Manager");
    }

    public static ConnectionManager getInstance() {
        if( instance == null ) {
            instance = new ConnectionManager();
        }
        return instance;
    }

    public void authenticate(String username, String password) {
        //Check for authentication here
    }
} 
```

每次用户做某事时调用下面的代码：

```
private static ConnectionManager conn = ConnectionManager.getInstance();
conn.authenticate(); 
```

**或者**

我应该将用户详细信息存储在单例中吗

```
public class ConnectionManager {

    private static ConnectionManager instance = null;
    private AndroidHttpClient client;

    private AppUser mLoggedInUser;
    private boolean mAuthenticated;

    private ConnectionManager() {
        client = AndroidHttpClient.newInstance("Android-Connection-Manager");
    }

    public static ConnectionManager getInstance() {
        if( instance == null ) {
            instance = new ConnectionManager();
        }
        return instance;
    }

    public void InitialiseUser(String username, String password) {
            //Do login checks here then return true if logged in
            mAuthenticated = true;
    }

    public boolean isAuthenticated() {
            return mAuthenticated;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:17:30.500

如果您可以控制 Rest 服务，则可以在初始连接上使用用户名\密码进行身份验证，然后在身份验证成功时将“令牌”返回给您的应用程序。

然后，您的应用程序可以将此令牌添加到所有未来请求的 http 标头中，并且您的服务可以在继续之前检查它是否有效。

我就是这样做的，而且效果很好。

# android-edittext - 在 CustomList 中编辑文本值

> ID：10154646
> 
> 赞同：1
> 
> 时间：2012-04-14T15:11:02.273
> 
> 标签：android-edittext, custom-lists, lost-focus

我的自定义列表视图中有 EditText 字段。editText 的值未正确保留，请帮助我使用持有者类..提前致谢！

# javascript - 如何通过索引号突破 .each()

> ID：10154647
> 
> 赞同：5
> 
> 时间：2012-04-14T15:11:09.327
> 
> 标签：javascript, jquery

我想打破列表中的每三个项目，并为那个孩子添加一个类；

```
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li><!--target list item-->
    <li>4</li>
    <li>5</li>
    <li>6</li><!--target list item-->
    <li>7</li>
</ul> 
```

任何的想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T15:15:01.827

您应该使用 nth-child 伪选择器

```
$("ul li:nth-child(3n)").addClass("break-here"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T15:14:59.487

有一个 CSS 伪选择器：

```
:nth-child(xn+y) 
```

选择从 开始的每个`x`孩子`y`，因此在您的情况下`x = 3`和`y = 1`（默认值）

```
$('li:nth-child(3n)').addClass(...); 
```

演示在[http://jsfiddle.net/8WDK4/](http://jsfiddle.net/8WDK4/)

请参阅[http://www.w3.org/TR/selectors/#nth-child-pseudo](http://www.w3.org/TR/selectors/#nth-child-pseudo)和[示例](http://www.w3.org/Style/Examples/007/evenodd.en.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:18:14.330

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li><!--target list item-->
    <li>4</li>
    <li>5</li>
    <li>6</li><!--target list item-->
    <li>7</li>
</ul>

<script type="text/javascript">
i = 0;
$.each($("li"), function(key,value) {
    i++;
    if (i % 3 == 0) {
        //Do things
    }

})
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T15:19:03.417

```
$("li")​.each(function(index,item){
    console.debug(index)
    if(index % 3 == false){
        $(this).addClass("newClass");
    }
})​ 
```

这将是诀窍

[http://jsfiddle.net/TYuAn/](http://jsfiddle.net/TYuAn/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T15:22:23.523

另一种没有伪选择器的解决方案

```
collection.each(function(i, item){
    if(! i%3) {
        $(item).addClass('c');
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-14T15:44:40.317

```
$('ul li').each(function(i,e){
  $(e).eq((i+1)%3).addClass('red');
}); 
```

## *[演示 jsbin](http://jsbin.com/isoxim/edit#javascript,html,live)*

# facebook - Facebook SDK：有时电子邮件字段返回 null（设置“电子邮件”权限）

> ID：10154652
> 
> 赞同：0
> 
> 时间：2012-04-14T15:11:49.637
> 
> 标签：facebook

我有一个用 PHP 编写的 Facebook 应用程序。询问用户的“电子邮件”权限。我注意到我获得了**90%**的用户电子邮件地址，但不是一些。

我知道电子邮件权限允许 Facebook App 获取用户个人资料中所述的主要电子邮件地址，但为什么 SDK 有时会返回`null`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T17:01:46.313

“电子邮件”是用户在允许应用程序时无需提供的扩展权限。如果您需要您的用户在继续使用您的应用程序之前授予“电子邮件”权限，您需要在允许用户在身份验证后继续其工作流程之前检查该权限是否存在。

您需要使用的图形 API 端点是`"/me/permissions"`

这是我用来做到这一点的一种方法：

`permissions`是一个字符串数组，表示请求的权限。

```
hasPermissions(["email"], function(hasPerms){
     alert(hasPerms);
 });

function hasPermissions(permissions, callback){
    console.log("perms requested");
    console.log(permissions);
    FB.api("/me/permissions", function(response){
        var hasPerms = true;
        console.log("perms obtaind");
        console.log(response);
        for(var i in permissions){
            console.log([permissions[i]] + " - " + response["data"][0][permissions[i]])
            hasPerms = hasPerms && response["data"][0][permissions[i]] == 1;
        }
        if(typeof callback == "function"){
            callback(hasPerms);     
        }       
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T13:27:55.807

我不认为电子邮件是扩展权限集的一部分。我在授权对话框中询问了电子邮件权限，它没有出现在身份验证对话框中。

# prolog - ECLiPSe Prolog - 'nonvar/1' 的意外行为

> ID：10154657
> 
> 赞同：3
> 
> 时间：2012-04-14T15:12:53.437
> 
> 标签：prolog

我正在浏览一些 ECLiPSe 文档，发现了这个：

```
`nonvar/1` : Fails if Term is not instantiated 
```

我试过这样做：

```
1\. Query: nonvar(X). Result: No (AS EXPECTED)
2\. Query: X=5, nonvar(X). Result: Yes (AS EXPECTED)
3\. Query: X=5, nonvar(f(X)). Result: Yes, X=5\. (AS EXPECTED) 
```

现在这个查询结果让我很困惑：

```
4\. Query: nonvar(f(X)). Result: Yes, X=X. 
```

查询 1、2、3 按预期工作。对我来说， 4 的结果很奇怪。根据 eclipse 中 nonvar/1 的文档，参数可以是任何 PROLOG TERM（因此，f(X) 很好），并且 nonvar 测试参数是否已实例化。

在 4 的情况下，它没有被实例化，所以它应该是 NO 而不是 YES (X=X)。如果我的理解不正确，或者它是 ECLiPSe 序言中的文档问题，请纠正我？我正在使用最新版本。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:23:56.390

在您的查询 4 ​​中，`f(X)` *包含*未实例化的变量`X`，但它*本身不是未*实例化的变量。

SWI-Prolog 的帮助可能对以下含义更清楚一些`nonvar`：

> `nonvar(Term)`：如果`Term`当前不是自由变量，则为真。

您可以检查一个术语是否包含自由变量`ground/1`：

```
?- X = 5, ground(f(X)).
X = 5.

?- ground(f(X)).
false. 
```

# c# - 接口方法上的“修饰符 public 对此项目无效”

> ID：10154664
> 
> 赞同：4
> 
> 时间：2012-04-14T15:13:30.107
> 
> 标签：c#, interface

好的，所以我在从界面（显示数据的窗口窗体）调用方法 GetClassAverage() 时遇到问题。我也收到以下错误“公共修饰符对此项目无效”...这是我的 IService.cs 文件中的代码

```
[ServiceContract]
public interface IClassRollService
{
    [OperationContract]
    List<Student> GetStudentList(int semester);
    [OperationContract]    
    double GetClassAverage(int anything);
} 
```

在我的 Service.cs 文件中，我有

```
public double GetClassAverage()
{
    double sum = 0.0;
    double total;
    foreach (Student S in Students)
    {
        sum += S.Average;
    }
    return total = sum / Students.Count();
} 
```

在我的 Windows 窗体上，我通过调用 client.GetStudentList() 填充了一个网格视图，但它不适用于 GetClassAverage()

我做错了什么或我错过了什么？

[编辑] 已经公开了，但我仍然无法从 Windows 窗体调用该方法。有没有其他方法可以将该方法的返回值获取到 Windows 窗体中。这与网络服务有关，我知道的就这么多。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-14T15:16:46.890

在接口中，所有方法根据定义都是公共的。这就是为什么它告诉你“公开”是无效的。只需从接口的方法定义中删除“public”关键字，一切都会好起来的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T16:11:24.747

您编辑的 IService.cs 看起来不错。您需要更改 Service.cs 中的实现签名以匹配您的接口：

```
public double GetClassAverage() 
```

至

```
public double GetClassAverage(int anything) 
```

# jquery - JQuery UI 范围滑块更新值

> ID：10154666
> 
> 赞同：0
> 
> 时间：2012-04-14T15:13:30.853
> 
> 标签：jquery, jquery-ui, slider

我有一个 JQuery UI Range 滑块的实现：

```
$(function() {
$("#test").val(0);
$( "#slider-range" ).slider({
      range: true,
      min: 1,
    max: 24,
    values: [ 10, 15 ],
    create: function(event, ui){

       },
       slide: function( event, ui ) {
         $( "#amount" ).val( "" + ui.values[ 0 ] +":00" + " - " + ui.values[ 1 ]+":00" );
    }
});

$( "#amount" ).val( "" + $( "#slider-range" ).slider( "values", 0 ) +
    ":00 - " + $( "#slider-range" ).slider( "values", 1 ) + ":00");

$( "#check" ).button();
$( "#format" ).buttonset();
}); 
```

我想访问`values`这些功能之外的滑块。又名`ui.values[ 0 ]`和`ui.values[ 1 ]`。但是，如果我在此块之外创建某种全局变量并更新其中的变量`$( "#slider-range" ).slider({slide:})`不会覆盖它，因此当用户使用滑块时它不会更新。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:26:16.500

在表单中设置一个隐藏变量，然后使用幻灯片函数 slide:function (event,ui) { document.getElementById("testH").value=$( "#slider-range" ).slider( "values" , 0 ); }

# php - 在一天中选择 N 次随机数，总和为 M

> ID：10154668
> 
> 赞同：0
> 
> 时间：2012-04-14T15:13:47.297
> 
> 标签：php, random, bots

> **可能重复：**
> [选择 n 个总和固定的数字](https://stackoverflow.com/questions/5622608/choosing-n-numbers-with-fixed-sum)

我正在用 PHP 为我的 Bux 系统开发一个 Bot。Bot 应该`N`在一天内运行几次，并且每次`K`以固定一天用户总数的方式创建可变（随机）用户（`M`）。
我怎样才能做到这一点？（选择随机数`N`乘以数字总和为`M`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:30:42.483

```
<?php
function generate_random_sum($sum = 100)
{
    $out = array();
    while(array_sum($out) !== $sum)
    {
        $out[] = mt_rand(1, ($sum - array_sum($out)));
    }
    return $out;
}

print_r(generate_random_sum(100)); 
```

这有帮助吗？

它会给你一个不同的值数组，在你的问题中总计 M。如果有人想随意扩展，不知道如何让它创建 N 数量的用户。

# jsf - 链接到 JSF 中的其他页面

> ID：10154669
> 
> 赞同：0
> 
> 时间：2012-04-14T15:13:53.137
> 
> 标签：jsf, navigation

从核心服务器面孔我读到这个：

*如果没有给出从结果到视图 ID 的映射*

> *   如果结果没有文件扩展名，则附加当前视图的扩展名。
> *   如果结果不是以 / 开头，则添加当前视图的路径。

那么这是否意味着您不能使用相对链接`<h:link outcome="../index.xhtml" ... />`？你总是需要提供绝对链接吗？至少当我尝试相对链接时它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:16:11.120

它有效，您只需要在所述位置有一个 .xtml 文件：

```
admin/
  login.xhtml
home.xhtml 
```

# ruby-on-rails-3.2 - 使用 Spree 1.1.0 运行“rake test_app”时“系统找不到指定的路径”

> ID：10154670
> 
> 赞同：1
> 
> 时间：2012-04-14T15:14:14.160
> 
> 标签：ruby-on-rails-3.2, spree

我在 Rails 3.2 和 Spree 1.1 上。运行初始时，`rake test_app --trace`我得到：

```
** Invoke test_app (first_time)
** Execute test_app
** Invoke common:test_app (first_time)
** Execute common:test_app
Generating dummy Rails application...
Setting up dummy database...
The system cannot find the path specified. 
```

我`rake test_app`从`spree\core`. 据我所知`spree\core\lib\generators\spree\dummy\templates\rails\database.yml`，施普雷正在寻找`db\spree_test.sqlite3`。我尝试手动创建此数据库，但没有运气。

如果这有帮助，我也在 Windows 7 上，因为它可能是某种环境设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T00:01:56.510

这似乎是 Spree 生成器中的一个小错误：

```
puts "Setting up dummy database..."
cmd = "bundle exec rake db:drop db:create db:migrate db:test:prepare"

if RUBY_PLATFORM =~ /mswin/ #windows
  cmd += " >nul"
else
  cmd += " >/dev/null"
end

system(cmd) 
```

在我的情况下，RUBY_PLATFORM 是“i386-mingw32”，else 块添加“>/dev/null”，这是 linux 的有效消音器，但在 Windows 中会出现错误。

如此简单的解决方法可能是：

```
if RUBY_PLATFORM =~ /mswin|mingw/ 
```

正如我从这里的帖子中看到的[，](https://stackoverflow.com/questions/170956/how-can-i-find-which-operating-system-my-ruby-program-is-running-on)这里[和](https://stackoverflow.com/questions/11784109/detecting-operating-systems-in-ruby)这里[没有](https://stackoverflow.com/questions/4871309/what-is-the-correct-way-to-detect-if-ruby-is-running-on-windows)可靠的方法来确定正在运行的操作系统，但是有一些启发式代码。

代码取自 spree\core\lib\spree\testing_support\common_rake.rb

否则，您可以运行：

```
bundle exec rake db:drop db:create db:migrate db:test:prepare 
```

# php - 使用从 curl 输出中提取的新 url 刷新 php 页面

> ID：10154671
> 
> 赞同：1
> 
> 时间：2012-04-14T15:14:47.600
> 
> 标签：php, forms, url, curl

我有一个表单，提交后需要用新的 url 刷新页面。

然而，新的 url 需要来自 curl 函数的输出。

目前，我可以让 curl 功能正常运行，但不是用那个 url 刷新页面，它只是在页面上打印 url。

您知道我如何使用该 url 来刷新页面吗？

提前致谢

编辑：

```
$ch = curl_init();  

curl_setopt($ch, CURLOPT_URL, "http://uk.ImpulsePay.com/payforit?RouteID=5432&URL=Y"); 
curl_setopt($ch, CURLOPT_HEADER, 0);   

header( "Location: curl_exec($ch)");
curl_close($ch); 
```

如果您访问上面的链接 - 它将显示一个在正文中有链接的页面。我基本上试图在页面正文中获取链接，然后将页面刷新到该页面。

那有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:25:11.850

您需要使用 PHP header() 方法，请参阅此页面： http: [//php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

这是他们的例子：

```
header("Location: http://www.example.com/"); /* Redirect browser */ 
```

请注意以下内容：

> 请记住，必须在发送任何实际输出之前调用 header()

如果您需要在“打印”某些内容后更改标题，则需要使用输出缓冲，请参阅此页面以开始： http: [//php.net/manual/en/function.ob-start。 php](http://php.net/manual/en/function.ob-start.php)

更新：您的 curl_exec( $ch ) 未执行，因为您无法在双引号内执行功能，您只能插入变量。

这是您想要执行的操作：

```
$httpResponse = curl_exec( $ch );
header( "Location: $httpResponse"); 
```

假设响应只是一个 URL，这会将用户的浏览器重定向到 curl 请求返回的值。

更新：我错过了您没有返回转移设置。您需要在您的行之后添加此`CURLOPT_HEADER`行：

```
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 ); 
```

这将告诉 curl_exec 返回响应而不是布尔成功指示。

See the "Return values" section at: [http://php.net/manual/en/function.curl-exec.php](http://php.net/manual/en/function.curl-exec.php)

# backbone.js - 具有覆盖 toJSON 方法的主干.js 集合

> ID：10154675
> 
> 赞同：0
> 
> 时间：2012-04-14T15:15:14.300
> 
> 标签：backbone.js

我有一个模型，它有两个属性，它们是集合：

```
MainModel= Backbone.Model.extend({
  defaults: {
     colOne:undefined,
     colTwo:undefined
  },

  initialize:function() {
    this.set({colOne:new InnerCollection()});
    this.set({colTwo:new InnerCollection()});
  }
});

InnerCollection= Backbone.Collection.extend({ 
  model: InnerModel, 
});

InnerModel= Backbone.Model.extend({
      ...
}); 
```

我发现项目 ( `InnerModels`) 没有从 Collections colOne 和 colTwo 中正确删除。我在 Stackoverflow 上发现了一个[问题](https://stackoverflow.com/questions/6677815/backbone-js-collection-not-properly-removing-item-in-view)，似乎解释了问题的原因并提出了解决方案。`toJSON()`我在我的模型上提供了一个重写的实现：

```
MainModel= Backbone.Model.extend({
      defaults: {
         colOne:undefined,
         colTwo:undefined
      }

      initialize:function() {
        this.set({colOne:new InnerCollection()});
        this.set({colTwo:new InnerCollection()});
      },

      toJSON: function() {
        _.extend(this.attributes, {colOne: this.get('colOne').toJSON()});
        _.extend(this.attributes, {colTwo: this.get('colTwo').toJSON()});
        return this.attributes;
      },
    }); 
```

**问题 #1 -**我不太确定为什么这会解决问题或我为什么要这样做。

**问题 #2 -**当我尝试使用集合`colOne`或`colTwo`在我的视图中时，它会导致错误。堆栈跟踪是：

```
Uncaught TypeError: Object [object Object],[object Object] has no method 'bind'
Backbone.View.extend.initializeinteractiveviews.js:646
Backbone.Viewbackbone.js:1147
childbackbone.js:1392
Backbone.View.extend.renderinteractiveviews.js:441
Backbone.View.extend.renderinteractiveviews.js:619
(anonymous function)interactiveviews.js:766
_.each._.forEachunderscore.js:76
wrapper.(anonymous function)underscore.js:961
Backbone.View.extend.renderinteractiveviews.js:758
Backbone.View.extend.renderinteractiveviews.js:452
Backbone.View.extend.renderinteractiveviews.js:619
(anonymous function)interactiveviews.js:766
_.each._.forEachunderscore.js:76
wrapper.(anonymous function)underscore.js:961
Backbone.View.extend.renderinteractiveviews.js:758
Backbone.View.extend.renderinteractiveviews.js:443
Backbone.View.extend.renderinteractiveviews.js:619
window.AppView.Backbone.View.extend.renderindex.html:73
window.AppView.Backbone.View.extend.initializeindex.html:47
Backbone.Viewbackbone.js:1147
childbackbone.js:1392
(anonymous function)index.html:97
jQuery.Callbacks.firejquery-1.7.2.js:1075
jQuery.Callbacks.self.fireWithjquery-1.7.2.js:1193
jQuery.extend.readyjquery-1.7.2.js:435
DOMContentLoaded 
```

`bind`只是我尝试使用该系列的第一个地方`colOne`：

```
// this.collection is colOne
this.collection.bind('myEvent', this.myEventHandler); 
```

我没有任何语法错误，所以我不确定我的 toJSON 方法是如何破坏的。

## 更新

这不是 Backbone.js 的问题。我遇到的问题归结为没有解除与事件的绑定。因此，尽管一旦集合为空，特定的 View 就不再可见，但它是由添加新项目的事件触发的。这就是为什么每次我从 View 事件中删除一个项目时，集合的计数都会增加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T21:51:32.210

这不是 Backbone.js 的问题。我遇到的问题归结为没有解除与事件的绑定。

使用 Item 填充 Collection 的 View 不再可见，但仍绑定到触发将 Item 添加到 Collection 的 UI 事件。事件的顺序大约是：

```
Event XYZ triggers creation of View2
View2 creates Item and adds to Collection. 
```

（`collection.length`现在 1）。

```
...Item removed from Collection. 
```

（`collection.length`现在为 0）。

```
If Collection empty remove `View2`.
View2 removed. 
```

此时如果再次触发Event XYZ，**将创建两个View2实例，因此将2个项目添加到集合**中。即使从 Collection 中删除了一个 Item，每次删除第一个 Item 时长度都会增加 1。

**总结：**如果您`$(myView).remove()`在代码中的任何地方都使用了事件/绑定，请检查您是否从事件中取消绑定。

# android - Android - 库问题

> ID：10154682
> 
> 赞同：1
> 
> 时间：2012-04-14T15:16:21.290
> 
> 标签：android, exception, jsoup

我正在开发一个应用程序，之前发布了 2 个更新。从一开始，我就一直在使用 Jsoup 进行工作，一切似乎都很好。

需要做一些更新，我在应用程序上工作，令我惊讶的是，我得到了关于 Jsoup 的 NoClassDefFoundError 异常。

```
04-14 20:24:57.256: E/AndroidRuntime(806): java.lang.NoClassDefFoundError: org.jsoup.Jsoup 
```

经过一些建议后，我清理了项目。删除库并重新导入它。制作了一个 lib 文件夹，将库复制到那里，然后将其导入到项目中。删除了 bin 文件夹。尝试获取最新版本的 Jsoup，但似乎没有任何效果。

然后我检查了APK文件。上一个版本的大小约为 350kb。但它的大小刚刚超过 200kb，我没有做任何事情来减小它的大小。

NoClassFound，这意味着没有类，但是这个 NoClassdefFoundError 是什么？这是否意味着图书馆确实在那里并且有些事情不对？

这是在 Jsoup 失败之前使用的那一行。

```
ua.setDescription(Jsoup.parse(content.replace("<br>", "[newline]")).text().replace("[newline]", "\n")); 
```

这里的内容是一个字符串。

可能会发生什么，我做错了什么？有什么建议吗？提前致谢。

logcat 的总错误如下，我认为这不会有太大用处：

```
04-14 20:24:57.256: E/AndroidRuntime(806): FATAL EXCEPTION: MagentoBackground
04-14 20:24:57.256: E/AndroidRuntime(806): java.lang.NoClassDefFoundError: org.jsoup.Jsoup
04-14 20:24:57.256: E/AndroidRuntime(806):  at com.mozeej.android.lankafriends.datastructures.UserAccountParser.parseHTML_LankaLove(UserAccountParser.java:89)
04-14 20:24:57.256: E/AndroidRuntime(806):  at com.mozeej.android.lankafriends.BrowseView.loadProfiles(BrowseView.java:201)
04-14 20:24:57.256: E/AndroidRuntime(806):  at com.mozeej.android.lankafriends.BrowseView.getUsers(BrowseView.java:229)
04-14 20:24:57.256: E/AndroidRuntime(806):  at com.mozeej.android.lankafriends.BrowseView.access$0(BrowseView.java:208)
04-14 20:24:57.256: E/AndroidRuntime(806):  at com.mozeej.android.lankafriends.BrowseView$5.run(BrowseView.java:174)
04-14 20:24:57.256: E/AndroidRuntime(806):  at java.lang.Thread.run(Thread.java:1019)
04-14 20:24:59.626: E/WindowManager(806): Activity com.mozeej.android.lankafriends.BrowseView has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@406267a8 that was originally added here
04-14 20:24:59.626: E/WindowManager(806): android.view.WindowLeaked: Activity com.mozeej.android.lankafriends.BrowseView has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@406267a8 that was originally added here
04-14 20:24:59.626: E/WindowManager(806):   at android.view.ViewRoot.<init>(ViewRoot.java:258)
04-14 20:24:59.626: E/WindowManager(806):   at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
04-14 20:24:59.626: E/WindowManager(806):   at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
04-14 20:24:59.626: E/WindowManager(806):   at android.view.Window$LocalWindowManager.addView(Window.java:424)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.Dialog.show(Dialog.java:241)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ProgressDialog.show(ProgressDialog.java:107)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ProgressDialog.show(ProgressDialog.java:90)
04-14 20:24:59.626: E/WindowManager(806):   at com.mozeej.android.lankafriends.BrowseView.onCreate(BrowseView.java:179)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-14 20:24:59.626: E/WindowManager(806):   at android.os.Handler.dispatchMessage(Handler.java:99)
04-14 20:24:59.626: E/WindowManager(806):   at android.os.Looper.loop(Looper.java:123)
04-14 20:24:59.626: E/WindowManager(806):   at android.app.ActivityThread.main(ActivityThread.java:3683)
04-14 20:24:59.626: E/WindowManager(806):   at java.lang.reflect.Method.invokeNative(Native Method)
04-14 20:24:59.626: E/WindowManager(806):   at java.lang.reflect.Method.invoke(Method.java:507)
04-14 20:24:59.626: E/WindowManager(806):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-14 20:24:59.626: E/WindowManager(806):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-14 20:24:59.626: E/WindowManager(806):   at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:18:50.063

这是最新的 Android 开发者工具中的一个问题。

把罐子移进去`< yourappdir with AndroidManifest.xml in >/libs`，它会起作用的。

我知道，这很愚蠢。

乔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:29:51.477

就像乔说的那样，你的 jars 现在必须在 libs 目录中。

# java - 如何在 JSF 中映射任意 URL

> ID：10154685
> 
> 赞同：0
> 
> 时间：2012-04-14T15:16:38.353
> 
> 标签：java, jakarta-ee, jsf-2

我需要能够将 Facebook API 回调映射到我的*JSF 2.1* webapp中的**任意 URL 。**

 *我是 JSF 的新手，据我所知，唯一的选择是在预期*位置创建一个***虚拟视图**。我习惯于使用 Spring MVC，您可以直接在控制器中映射 URL。

 *对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T18:35:57.933

在 JSF 中导航是通过在操作方法中返回结果字符串来完成的。

例如：

```
<h:commandButton label="submit" action="navController.verifyAnswer" />

public String verifyAnswer() {
  if(true) return "nextPage";
  else return "errorPage";
} 
```

结果字符串“nextPage”转换为视图 ID nextPage.xhtml，errorPage 转换为 errorPage.xtml。如果您返回 null 则下一个视图是相同的视图。[文档](http://docs.oracle.com/javaee/6/tutorial/doc/bnavb.html#bnavc)中的更多详细信息**

# javascript - 使用 Javascript SDK 在 Facebook 上传 ByteArray 图像

> ID：10154689
> 
> 赞同：1
> 
> 时间：2012-04-14T15:17:07.420
> 
> 标签：javascript, facebook, actionscript-3, facebook-graph-api, bytearray

我正在尝试使用 Javascript SDK 在 Facebook 上上传照片。特别是我从我的 Actionscript3 应用程序生成一个 base64 编码的字节数组，我使用 ExternalInterface 将它传递给 Javascript 文件，然后我解码字节数组并尝试上传到 FB。但它给了我这个错误：

```
{"error":{"message":"(#324) Requires upload file","type":"OAuthException","code":324}} 
```

我试图简单地从 url 上传图片，这样就顺利了！

这是我的 Javascript 代码：

```
 upPhoto:function(photo) {
       var img = F.decode_base64(photo);

       FB.api('/me/photos', 'post', {
        message:'test',
        fileName:'test',
        image: img
       }, function(response){

          if (!response || response.error) {
            log('Error!');
          } else {
            log('Upload OK!');
          }
       });  
    }

    decode_base64:function(s) {
       var e={},i,k,v=[],r='',w=String.fromCharCode;
       var n=[[65,91],[97,123],[48,58],[47,48],[43,44]];

       for(z in n){for(i=n[z][0];i<n[z][1];i++){v.push(w(i));}}
       for(i=0;i<64;i++){e[v[i]]=i;}

       for(i=0;i<s.length;i+=72){
          var b=0,c,x,l=0,o=s.substring(i,i+72);
          for(x=0;x<o.length;x++){
            c=e[o.charAt(x)];b=(b<<6)+c;l+=6;
            while(l>=8){r+=w((b>>>(l-=8))%256);}
          }
       }
      return r;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:00:37.100

我不确定您从哪里获得该参数列表，但根据[文档](http://developers.facebook.com/docs/reference/api/user/)，没有*fileName*或*image*，您应该使用必需的*source*。

另一件事是您需要将其发布为*multipart/form-data*，而您不需要。

你检查过这个线程：[Facebook Graph API - 使用 JavaScript 上传照片](https://stackoverflow.com/questions/4999024/facebook-graph-api-upload-photo-using-javascript)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T00:20:13.580

在过去的三天里，我在这个话题上花了好几个小时。现在，我明白了，我有一个解决方案来修复你的代码（你已经接近解决方案了.. ^^）：

**这很简单：**一旦您的用户使用“publish_stream”授权您的 fb 应用程序，我只需使用以下代码，它就会将图片上传到用户墙上 :-) 我希望它真的有帮助！

```
 <a href="#" onclick="uploadonwall(); return false;">Call the Publish Magic</a>
            <script>
            function uploadonwall(){
                FB.api('/me/photos', 'post',
                {
                    message: 'A new pic is on my wall ...',
                    url:'http://www.yourwebsite.com/big_image_about_to_be_published_on_facebook_user_wall.jpg'

                }, function(response) {
                    if (!response || response.error) {
                        alert('Oops! User Denied Access');
                    } else {
                        alert('Success: Content Published on Facebook Wall');
                    }
                });
            }
            </script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-27T14:03:24.403

我解决了使用 Facebook JS SDK 登录的问题，以及简单的 Actionscript 的 HTTP 函数在 Facebook 上发布图像。

这是AS3上传功能：

```
private function uploadOnFB(event:Event):void {

    var byteArray:ByteArray = PNGEncoder.encode(videobitmapData);

    var url:String = "https://graph.facebook.com/me/photos";

    var param:Object = new Object();
    param.message = "My uploaded photo!";
    param.access_token = access_token;

    var urlRequest:URLRequest = new URLRequest();
    urlRequest.url = url;
    urlRequest.contentType = 'multipart/form-data; boundary=' + UploadPostHelper.getBoundary();
    urlRequest.method = URLRequestMethod.POST;
    urlRequest.data = UploadPostHelper.getPostData("photo.png", byteArray, param);

    var urlLoader:URLLoader = new URLLoader();
    urlLoader.dataFormat = URLLoaderDataFormat.BINARY;
    urlLoader.load(urlRequest);
} 
```

`access_token`由`onLoginSuccess`FB Javascript SDK 回调返回。

# github - GitHub 页面没有应用我的模板

> ID：10154690
> 
> 赞同：1
> 
> 时间：2012-04-14T15:17:16.867
> 
> 标签：github, jekyll, github-pages

我正在尝试在 GitHub 页面上使用 Jekyll。我正在按照他们在 0.11.0 版上告诉我的方式运行它，并且在我的机器上使用 --safe 并且它可以工作，但是当 GitHub 构建站点时，它没有正确构建页面。

[http://kennydude.github.com/data/months.html](http://kennydude.github.com/data/months.html)应该出现一个模板，但它不是。你可以在我的 YAML 前面看到它确实定义了一个布局[https://github.com/kennydude/data/blob/gh-pages/_posts/2012-04-10-months.json](https://github.com/kennydude/data/blob/gh-pages/_posts/2012-04-10-months.json)

完成这项工作会很可爱，因为我认为这将是一个不错的小资源。

乔:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T20:29:55.043

您的部分布局代码似乎与 GitHub 混淆了。我复制了您的页面并看到了相同的行为。当我删除字符串时：

```
<code>{% raw %}{{ FIELDNAME }}{% endraw %}</code> 
```

从“_layouts/entry.html”文件中，页面按预期呈现。试一试。

**更新：**

我相信`{% raw %}`and`{% endraw%}`标签来自[这个 jekyll 插件](https://gist.github.com/1020852)。出于安全原因，GitHub Pages 不运行插件。当原始的 jekyll 引擎碰到你的代码时，它就窒息了。

您可以使用转义字符串输出未处理的原始 Liquid 标签。对于您的示例，您将执行以下操作：

```
<code>{{ "{{ FIELDNAME " }}}}</code> 
```

我已经[在 GitHub 上对其进行了测试，](http://alanwsmith.github.com/liquid-escape-test)它按预期工作，呈现输出：

```
{{ FIELDNAME }} 
```

为了给予应有的荣誉，我在为自己研究转义字符串时从[“如何转义液体模板标签”的答案中发现了这一点。](https://stackoverflow.com/a/5866429/102401)

# php - 如何防止 Ajax 中的请求过于频繁

> ID：10154691
> 
> 赞同：0
> 
> 时间：2012-04-14T15:17:21.280
> 
> 标签：php, codeigniter, jquery

我正在使用 jQuery 将数据从表单提交到我的控制器文件。

它正在向数据库添加一个喜欢的片段，但是，如何防止用户发送数据过于频繁地处理 ajax 脚本？

我的意思是，我可以点击表单中的提交按钮数千次 - 如何防止这种情况发生？因此，例如，每 10 秒 1 个请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:59:36.680

就在我的脑海中，我会说这样的话：

```
$("#button_id").one('click', DoSomething);    // attaches the function for ONE click

function DoSomething() {
    $.post("test.php", function(data) {
        alert("Data Loaded: " + data);
        $("#button_id").delay(10000).one('click', DoSomething);   // reattach the listener 
    });        
} 
```

[从这个问题](https://stackoverflow.com/questions/1263042/how-to-temporarily-disable-a-click-handler-in-jquery)和[jQuery手册](http://api.jquery.com/jQuery.post/)复制的源代码

# android - 带有一些特殊效果的Android Idea

> ID：10154694
> 
> 赞同：-1
> 
> 时间：2012-04-14T15:17:40.047
> 
> 标签：android

我为我的 android 应用程序提出了一个奇怪的想法。简单地说，我的应用程序允许用户启用相机拍摄脚部实时图像来计算脚部尺寸，之后，程序会将脚部尺寸转换为鞋子尺寸。我用谷歌搜索了一些建议，比如处理 AI Analyse。这是我的临时截图

[截屏](https://www.dropbox.com/sh/ofc8vgj1izg32fp/EgBr6KXpYn/AndroidIdea.jpg)

我只是想知道我的想法是否可行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:27:53.393

简短的回答：没有。

长答案：是的，当然。这只是一点数学和物理。您必须测量相机和脚之间的距离，或者使用例如一盒您知道大小的糖果校准您的测量算法，并将其放在脚旁边。

如果没有参考，您将永远无法通过图像在图像上的像素数来判断对象的大小。

只看你当前鞋子的底部会更好。如果合适，就再买同样的尺寸，如果不合适，就买大一点的。替代方案：问问你妈妈，她可能会知道。

# wcf-data-services - WCF DataServices：无法访问从其他实体派生的实体

> ID：10154696
> 
> 赞同：0
> 
> 时间：2012-04-14T15:18:22.113
> 
> 标签：wcf-data-services

我是 WCF 的新手。我创建了一个托管在空的 asp.net 应用程序中的数据服务。

似乎该服务没有序列化`EntitySets`从 other 派生的`EntitySets`。它正确返回基数`EntitySets`，但根本不知道派生`EntitySets`数。

我正在使用 EF Code First 并传递类的`ObjectContext`通用参数（如此[处](http://www.codeproject.com/Articles/135586/Using-EF-DbContext-with-WCF-Data-Services)`DataService`所述）

我的实体如下所示：

```
[DataContractAttribute]
public class People : DomainEntityBase
{
    [DataMember]
    public long ID{get; set;}

    .
    .
    .
}
[DataContract]
public class Employee : Person
{
    [DataMember]
    public string PersonelCode{ get; set;}

    [DataMember]
    public virtual ObservableCollection<OrgPost> OrgPosts { get; set; }
} 
```

当我在 Web 浏览器中测试上下文时，它显示`PersonSet`但不显示`EmployeeSet`.

我这样做对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:21:28.880

请看这篇文章。看起来您尝试使用 Code First 的场景不受支持。

[http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/8115cf34-4527-4302-9123-0dce010629e0](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataservices/thread/8115cf34-4527-4302-9123-0dce010629e0)

# android - Android：检测 Android 2.1 的缩放手势

> ID：10154699
> 
> 赞同：0
> 
> 时间：2012-04-14T15:18:40.903
> 
> 标签：android, image, bitmap, scale, gesture

当我向 Google（或 stackoverflow.com）询问手势检测示例时，它总是带有 GestureDetector，它不适用于 Android 2.1 / API 版本 7。

所以这是我的问题：我使用一个继承自 View 并显示一个位图的类。位图绘制方法可以与矩阵一起调用。我计划使用这个矩阵在我的视图中显示该位图的缩放变体。

比例因子必须通过用户的比例手势（两个手指的东西，手指彼此靠近以缩小或用户展开它们以放大）来设置。

但是，当我的 API 为 7（Android 2.1）并且没有可用的 GestureDetector 时，如何检测到这样的手势？

谢谢

埃尔米

PS：澄清一下：我不想只为以后的 API 版本实现我的应用程序，因为 2.1 和 2.2 是最常用的 Android 版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:32:38.640

实际上 GestureDetector 在 API 级别 7 中可用

```
import android.view.GestureDetector; 
```

# windows - 什么是 Windows 8“子会话”？

> ID：10154700
> 
> 赞同：3
> 
> 时间：2012-04-14T15:18:45.367
> 
> 标签：windows, winapi, windows-8, terminal-services

我目前正在编写一个代理服务，它根据某些标准将进程启动到任意会话中。在查找我使用的其中一个 API 的文档时，我注意到为 Windows 8 添加了一些新的 API，控制一些新的“子会话”功能（[WTSIsChildSessionsEnabled](http://msdn.microsoft.com/en-us/library/windows/desktop/hh769145%28v=vs.85%29.aspx)、[WTSEnableChildSessions](http://msdn.microsoft.com/en-us/library/windows/desktop/Hh769143%28v=vs.85%29.aspx)、[WTSGetChildSessionId](http://msdn.microsoft.com/en-us/library/windows/desktop/hh769144%28v=vs.85%29.aspx)）。

问题是，据我所知，这个新的“子会话”功能没有记录在任何地方。如果它与我的应用程序相关，我希望能够“面向未来”我的应用程序并支持这项新技术，但如果我不知道它是什么，我无法弄清楚它是否相关！

有谁知道这到底是什么，或者有更多信息的链接？（我在 MSDN 和 Technet 上进行了搜索，结果空手而归……）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T20:57:58.060

您链接到的所有三个 MSDN 页面都包含以下注释。链接页面描述了子会话功能。

> 有关子会话的更多信息，请参阅[子会话](http://msdn.microsoft.com/en-us/library/windows/desktop/jj553447.aspx)。

我猜想添加此功能是为了支持 Windows 8 应用程序的“模拟器”调试。

# ios - 指向 maps.google.com 的 iPhone HTML 链接在 Mobile Safari 而非 Maps 应用程序中打开页面

> ID：10154706
> 
> 赞同：1
> 
> 时间：2012-04-14T15:19:14.087
> 
> 标签：ios, iphone, google-maps, mobile-safari

在 iPhone 上，maps.google.com 形式的链接由安装在每台 iPhone 上的 google maps 应用程序打开。（请参阅：[Apple URL 方案参考](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html)）

maps.google.com 的移动网站支持比本地地图应用程序更多的功能（如交通层）。

有没有办法制定一个 html 链接，这会导致 safari 在浏览器中打开地图链接而不是启动本机地图应用程序？

这是一个在地图应用程序中打开的示例链接，我宁愿通过移动 Safari 打开：

[http://maps.google.com/maps?q=boston&lci=transit_comp](http://maps.google.com/maps?q=boston&lci=transit_comp)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T22:54:55.073

使用 https 而不是 http。

[https://maps.google.com/maps?q=boston&lci=transit_comp](https://maps.google.com/maps?q=boston&lci=transit_comp)

**编辑**：

您也可以自己解析域名，然后使用 IP 地址。

[http://173.194.34.165/maps?q=boston&lci=transit_comp](http://173.194.34.165/maps?q=boston&lci=transit_comp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T15:22:48.747

尝试将变量添加`&ui=maps`到 URL 字符串的末尾。

# css - CSS 引导按钮

> ID：10154708
> 
> 赞同：3
> 
> 时间：2012-04-14T15:19:25.773
> 
> 标签：css, button, twitter-bootstrap, hover

我在引导程序中的风格化按钮有问题。

```
<div class="btn-group">
    <button class="btn btn-midd">Link</button>
    <button class="btn btn-midd dropdown-toggle">
       <span class="icon-download-alt icon-gray"></span>
    </button>
</div> 
```

我想将“icon-gray”更改为“icon-blue”。当然我有不同的图像（和改变背景图像的类）。图标蓝色应在悬停时更改。

感谢帮助。

CSS：

```
.icon-blue {background-image: url("../img/glyphicons-halflings-blue.png");}
 .icon-download-alt {background-position: -408px -96px;} 
```

这里有一个例子：

![在此处输入图像描述](../Images/eb3c35a3b083b33388ab35e3e3b3604d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T16:17:26.063

```
.icon-download-alt:hover {background-image: url("../img/glyphicons-halflings-blue.png");}
.icon-download-alt {background-position: -408px -96px;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:44:14.677

您可以使用[.hover()](http://api.jquery.com/hover/)方法使用[jQuery](http://jquery.com/)轻松完成此操作：

```
<script type="text/javascript">

$(document).ready(function() {

    $("span.icon-gray").hover(
        function () {
            $(this).removeClass("icon-gray");
            $(this).addClass("icon-blue");
        },
        function () {
            $(this).removeClass("icon-blue");
            $(this).addClass("icon-gray");
        }
    );

});

</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:30:52.240

只需将鼠标悬停在第一个元素上。您不想将鼠标完全悬停在图标上：

```
 .btn:hover .icon-download-alt { background: url("../img/glyphicons-halflings-blue.png") -432px -144px; } 
```

CSS，不需要 JS。

# c# - XSLT 模板不起作用

> ID：10154710
> 
> 赞同：2
> 
> 时间：2012-04-14T15:19:34.740
> 
> 标签：c#, xslt

尽管在各种网站上阅读了大量有关 XSLT 模板的文档，但我无法让 XSLT 与我的 C# 代码一起工作。

这是我的工作 XSLT 文件：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="/">
<HTML>
<BODY>
  <TABLE BORDER="2">
    <TR>
      <TD>First name</TD>
      <TD>Last name</TD>
      <TD>Age</TD>
    </TR>

    <xsl:for-each select="ArrayOfUserModel/UserModel">
          <TR>
                <TD><xsl:value-of select="FirstName"/></TD>
                <TD><xsl:value-of select="LastName"/></TD>
                <TD><xsl:value-of select="Age"/></TD>
              </TR>
    </xsl:for-each>

  </TABLE>
</BODY>
</HTML>
</xsl:template>
</xsl:stylesheet> 
```

这是我的非工作 XSLT 文件（和处理已移至样式表末尾的模板，理论上应该返回相同但不显示任何用户信息）：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:template match="/">
  <HTML>
<BODY>
  <TABLE BORDER="2">
    <TR>
      <TD>First name</TD>
      <TD>Last name</TD>
      <TD>Age</TD>
    </TR>

    <xsl:for-each select="ArrayOfUserModel/UserModel">
            <xsl:apply-templates select="user"/>
    </xsl:for-each>

  </TABLE>
</BODY>
  </HTML>
</xsl:template>

<xsl:template match="user">
  <TR>
<TD><xsl:value-of select="FirstName"/></TD>
<TD><xsl:value-of select="LastName"/></TD>
<TD><xsl:value-of select="Age"/></TD>
  </TR>
</xsl:template>
</xsl:stylesheet> 
```

这里是我用于 XSLT 转换的 C# 代码：（我传递了一个可序列化的 UserModel 对象，其中包含一些属性和 XSLT 文件的内容，然后它返回 HTML）

```
 public static string TransformXml2(object data, string xslt)
    {
        XmlSerializer xs = new XmlSerializer(data.GetType());
        string xml;
        using (StringWriter swr = new StringWriter())
        {
            xs.Serialize(swr, data);
            xml = swr.ToString();
        }

        // Simple data checks   
        if (string.IsNullOrEmpty(xml))
        {
            throw new ArgumentException("Param cannot be null or empty", "xml");
        }
        if (string.IsNullOrEmpty(xslt))
        {
            throw new ArgumentException("Param cannot be null or empty", "xslt");
        }

        // Create required readers for working with xml and xslt   
        StringReader xsltInput = new StringReader(xslt);
        StringReader xmlInput = new StringReader(xml);
        XmlTextReader xsltReader = new XmlTextReader(xsltInput);
        XmlTextReader xmlReader = new XmlTextReader(xmlInput);

        // Create required writer for output   
        StringWriter stringWriter = new StringWriter();
        XmlTextWriter transformedXml = new XmlTextWriter(stringWriter);

        // Create a XslCompiledTransform to perform transformation   
        XslCompiledTransform xsltTransform = new XslCompiledTransform();

        try
        {
            xsltTransform.Load(xsltReader, new XsltSettings(true, true), null);
            xsltTransform.Transform(xmlReader, transformedXml);
        }
        catch (XmlException xmlEx)
        {
            // TODO : log - "Could not load XSL transform: \n\n" + xmlEx.Message   
            throw;
        }
        catch (XsltException xsltEx)
        {
            // TODO : log - "Could not process the XSL: \n\n" + xsltEx.Message + "\nOn line " + xsltEx.LineNumber + " @ " + xsltEx.LinePosition)   
            throw;
        }
        catch (Exception ex)
        {
            // TODO : log   
            throw;
        }

        return stringWriter.ToString();
    } 
```

非常感谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:26:50.103

语法

```
select="user" 
```

意思是“找到所有称为‘用户’的子元素并应用它们的匹配模板”。没有“用户”元素，因此没有输出。

要么*调用命名模板*，要么应用产生匹配的选择。

例如，代替 for-each，您可以：

```
<xsl:apply-templates select="ArrayOfUserModel/UserModel"/> 
```

并更改模板以匹配 UserModel：

```
<xsl:template match="UserModel"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:35:37.570

尽量避免`for-each`并一直使用模板：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

    <xsl:template match="/">
        <HTML>
            <BODY>
                <xsl:apply-templates />
            </BODY>
        </HTML>
    </xsl:template>

    <xsl:template match="ArrayOfUserModel">
        <TABLE BORDER="2">
            <TR>
                <TD>First name</TD>
                <TD>Last name</TD>
                <TD>Age</TD>
            </TR>
            <xsl:apply-templates />
        </TABLE>
    </xsl:template>

    <xsl:template match="UserModel">
        <TR>
            <TD><xsl:value-of select="./FirstName" /></TD>
            <TD><xsl:value-of select="./LastName" /></TD>
            <TD><xsl:value-of select="./Age" /></TD>
        </TR>
    </xsl:template>

</xsl:stylesheet> 
```

请注意，通过拆分与文档正文、一般列表布局（表格）和列表项有关的输出部分，您的 xslt 将变得更具可读性和更易于维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:45:59.317

**最有可能的是，在问题中未显示的 XML 文档中，没有 `UserModel`一个子元素`ArrayOfUserModel`具有`user`child**。

这就是为什么这条线：

```
<xsl:apply-templates select="user"/> 
```

找不到任何`user`元素，因此没有应用模板。

**解决方案**：

**替换**：

```
<xsl:for-each select="ArrayOfUserModel/UserModel">                
  <xsl:apply-templates select="user"/>        
</xsl:for-each> 
```

**与**：

```
<xsl:apply-templates select="ArrayOfUserModel/UserModel"/> 
```

**并改变**：

```
<xsl:template match="user"> 
```

**至**：

```
<xsl:template match="UserModel"> 
```

**完整代码变为**：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
      <HTML>
    <BODY>
      <TABLE BORDER="2">
        <TR>
          <TD>First name</TD>
          <TD>Last name</TD>
          <TD>Age</TD>
        </TR>

        <xsl:apply-templates select="ArrayOfUserModel/UserModel"/>

      </TABLE>
    </BODY>
      </HTML>
    </xsl:template>

    <xsl:template match="UserModel">
      <TR>
    <TD><xsl:value-of select="FirstName"/></TD>
    <TD><xsl:value-of select="LastName"/></TD>
    <TD><xsl:value-of select="Age"/></TD>
      </TR>
</xsl:stylesheet> 
```

# php - PHP / CakePHP 日期时间比较

> ID：10154717
> 
> 赞同：3
> 
> 时间：2012-04-14T15:21:08.063
> 
> 标签：php, cakephp

我正在尝试检查 MySQL 存储的日期时间对象是否在现在的 2 小时内，并且仅根据当前时间的未来 2 小时的ride_hour 是否显示某些链接。这是我尝试过的：

```
$now = date('Y-m-d');
$now_hour = date('h');
$ride_date = date('Y-m-d',strtotime($ride['Ride']['date']));
$full_ride_hour =  date('h',strtotime($ride['Ride']['date']));
$ride_hour = $full_ride_hour-2; 
```

所以我先比较一天，看看今天是否发生了，如果是，我不需要检查时间。否则，我会尝试将 $ride_hour 与 $now_hour 进行比较。这一天显然在工作，但小时比较似乎不起作用。

我想做的另一件事是在 cakePHP 控制器中，根据排序值限制结果。我试图将结果限制为 ALL、具有未来日期的结果或过去的结果，然后分页。这是我正在尝试的方法，但它不起作用：

```
switch ($sort) {
case 0:
$rides = $this->paginate('Ride',array('Ride.user_id' => $user_id,'Ride.date > now()'));
break;

case 1:
$rides = $this->paginate('Ride',array('Ride.user_id' => $user_id));
break;

case 2:
$rides = $this->paginate('Ride',array('Ride.user_id' => $user_id,'Ride.date < now()'));
break;
}

$this->set('sort',$sort);
$this->set('rides', $rides); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:30:55.447

使用 PHP 中的 DateTime 功能会更容易。我不确定您所说的“2 小时内”是什么意思。我假设您的意思是在之前的 2 小时和之后的 2 小时之间。如果不是，您可以很容易地更改间隔。

```
$mysql_date_obj = new DateTime($date_from_mysql);
$before_time = new DateTime('now');
$before_time->add( DateInterval::createFromDateString('-2 hour') );
$after_time = new DateTime('now');
$after_time->add( DateInterval::createFromDateString('2 hour') );

if( $before_time <= $mysql_date_obj && $mysql_date_obj <= $after_time ) {
     // date is within 2 hours.
} 
```

文档： http: [//php.net/DateTime](http://php.net/DateTime)

# android - 创建 Javadoc 时出错，无法启动 Javadoc 命令

> ID：10154718
> 
> 赞同：1
> 
> 时间：2012-04-14T15:21:08.487
> 
> 标签：android, eclipse, javadoc

朋友们，我没有成功为我的 Android 项目创建 Javadocs。

我做什么：

1.  项目 - 创建 Javadoc
2.  在弹出的“Javadoc 命令”窗口中输入以下参数：C:\Android\android-sdk\platforms\android-10\android.jar，因为我的项目设置为 API 10。
3.  我从以 .java 结尾的包中选择一个类
4.  输入参数“使用标准 doclet 目的地：” C:\Users\MR WULF\Desktop 我假设的意思是只需将准备好的文档保存在桌面上

点击“完成按钮”后显示的错误：

无法启动 Javadoc 命令原因：无法运行程序：C:\Android\android-sdk\platforms\android-10\android.jar 创建进程错误=193，%1 不是有效的 WIN-32 函数

任何支持都会很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:25:36.317

您将 android.jar 设置为要运行的命令，这不起作用并导致您描述的错误。“Javadoc 命令”需要一个 javadoc 二进制文件的路径，例如

```
C:\Program Files\Java\jdk1.6.0_21\bin\javadoc.exe 
```

有了它，它应该做你所期望的;）

# jquery - jQuery Validate Plugin: required 和 minlength 取决于另一个字段

> ID：10154720
> 
> 赞同：3
> 
> 时间：2012-04-14T15:21:38.970
> 
> 标签：jquery, validation, jquery-plugins, jquery-validate

我有具有以下要求的手机和家庭电话字段：

*   至少需要一个
*   如果存在任何字符，则字符长度必须为 12（与其他字段无关）

我对 jQuery Validate 有很好的体验，但是在这里得到我想要的东西很棘手。这是我目前拥有的：

```
 rules:
        "contact[mobile]":                                                                                                                                                        
          required: ->
            if $('#contact_home_phone').val().length < 12 and $('#contact_mobile').val().length < 12     
              return 12                                                               
            else 
              return false
          minlength: ->                                                               
            if $('#contact_home_phone').val().length < 12 and $('#contact_mobile').val().length < 12     
              return 12
            else
              return false

        "contact[home_phone]":                                                         
          required: ->
            if $('#contact_mobile').val().length < 12 and $('#contact_home_phone').val().length < 12     
              return true                                                             
            else                                                                      
              return false                                                            
          minlength: ->                                                               
            if $('#contact_mobile').val().length < 12 and $('#contact_home_phone').val().length < 12     
              return 12
            else
              return false 
```

这对我来说也像是笨拙的 Javascript，所以希望有效的解决方案也更有说服力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:51:17.043

我没有时间测试这个，但也许是这样的：

```
var val_phone = function ( value, element, params ) {

  var phone_fields = [ 'home_phone', 'mobile' ];

  var other_field;

  while ( other_field = phone_fields.pop() ) {

    other_field = "contact_" + other_field;

    if ( element.id != other_field ) {

      other_field = $( "#" + other_field )[0];

      break;

    }
    // if

  }
  // while

  return Boolean(

    value.length == 12 ||

    (

      value.length == 0 &&

      $( other_field ).val().length == 12

    )

  );

};

$.validator.addMethod( 'contact_phone', val_phone, "You must supply at least one 12-character phone number." ); 
```

# math - 基于蚁群的集团

> ID：10154721
> 
> 赞同：1
> 
> 时间：2012-04-14T15:21:39.023
> 
> 标签：math, graph-algorithm, ant-colony

我想在无向图中找到所有 k-clique。因此，我需要基于蚁群的精确算法来查找图中的所有 k-clique。例如，考虑这个相邻矩阵：

```
0 1 1 0 0
1 0 1 1 0
1 1 0 1 1
0 1 1 0 1
0 0 1 1 0 
```

在这个相邻的矩阵中，我们有三个 3-clique：(1,2,3),(2,3,4),(3,4,5)

我想在每个图中找到这个 k-clique。note=K 是 K-clique 算法的输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:31:59.160

只要`K`是任意值作为问题输入，k-clique 问题就是[NP-complete](http://en.wikipedia.org/wiki/Clique_problem#Cliques_of_fixed_size)，这意味着没有什么比暴力算法更好的了 - 获取`K`节点的每个子图并检查它是否代表一个 clique。通过回溯实现这个想法的细节可以在[这里](http://www.ibluemojo.com/school/clique_algorithm.html)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T16:24:26.643

重新标记以包含蚁群标签，但 Andrei 是正确的——蚁群优化不会打破 NP-Complete 障碍，尤其是 k-clique 问题甚至没有近似算法。（如果我没记错的话，近似算法不存在，除非 P=NP。）

我碰巧知道的关于 ACO 和集团问题的最新调查大约有六年的历史，链接如下。这是一项非常好的研究，包括针对四种独立技术的详尽模拟/基准测试，一个直接的结论是，在 2006 年，即使是最先进的 ACO 方法也不能保证在基准问题中获得实际的最大集团。

[http://liris.cnrs.fr/Documents/Liris-1847.pdf](http://liris.cnrs.fr/Documents/Liris-1847.pdf)

# java - Box2d 碰撞问题

> ID：10154724
> 
> 赞同：1
> 
> 时间：2012-04-14T15:21:44.397
> 
> 标签：java, box2d, collision

我正在创建一个物理游戏，在我的游戏中有很多种球。
现在，有一个特殊的球假设可以穿过墙壁，但其他球
可以与它碰撞（所以只有墙壁不会“感觉到”特殊球）。

我不知道如何准确识别。
最佳做法是什么？

谢谢，
sock.socket

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:27:28.067

您可以在球与墙碰撞检查逻辑上添加一个额外条件，以仅在球不是特殊类型时检查/允许弹跳

# wif - Windows 身份基础 (WIF) - ClaimsAuthenticationManager

> ID：10154728
> 
> 赞同：0
> 
> 时间：2012-04-14T15:22:32.090
> 
> 标签：wif

我的代码类似于下面的代码片段（取自[http://leastprivilege.com/2009/05/24/use-geneva-session-management-for-your-own-needs/](http://leastprivilege.com/2009/05/24/use-geneva-session-management-for-your-own-needs/)）

```
public class Transformer : ClaimsAuthenticationManager
{
    public override IClaimsPrincipal Authenticate(string endpointUri, IClaimsPrincipal incomingPrincipal)
    {
        var claimName = "customClaimType";
        // expensive operation
        var claimValue = [from expensive operation];

        incomingPrincipal.Identities[0].Claims.Add(new
          Claim(claimName, claimValue));

        return incomingPrincipal;

    }
} 
```

在文章（[http://leastprivilege.com/2009/05/24/use-geneva-session-management-for-your-own-needs/](http://leastprivilege.com/2009/05/24/use-geneva-session-management-for-your-own-needs/)）中，Dominick 指出，如果我们不想检索这些（昂贵的）数据存储对每个请求的声明，然后我们可以使用 SAM（SessionAuthenticationModule）。但是，我们不能只检查该身份的声明是否已经存在，然后仅在不存在的情况下获取该声明吗？这不能解决性能问题吗？

```
public class Transformer : ClaimsAuthenticationManager
{
    public override IClaimsPrincipal Authenticate(string endpointUri, IClaimsPrincipal incomingPrincipal)
    {
        var claimName = "customClaimType";
        if(incomingPrincipal.Identities[0].Claims.Where(x => x.ClaimType == claimName).Count() <= 0)
        {
            // expensive operation
            var claimValue = [from expensive operation];

            incomingPrincipal.Identities[0].Claims.Add(new
              Claim(claimName, claimValue));
        }

        return incomingPrincipal;

    }
} 
```

我不明白为什么我们必须求助于 SessionAuthenticationModule。所以我在我的本地机器上尝试了上面的代码，并逐步验证了后续请求（在初始请求之后），不会调用昂贵的操作。现在我不确定这是在负载平衡环境（网络场）中还是在涉及共享单点登录结构的多个依赖方的真正联合组中的情况。

我真的很感激能帮助我更好地理解这一点的解释。

谢谢！-卡西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T15:42:37.437

我想你已经回答了你自己的问题。与 Dominick 方法的简单区别在于，附加的“http://claims/expensive”声明被缓存在会话 cookie 中，但对于您提出的解决方案，它不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:20:31.497

我误解了多米尼克的文章。他的文章是关于将 WIF 的 SessionAuthenticationModule 用于您的目的。如果您使用带有 WS-Fed 的 WIF，那么您可以立即使用此行为。

只是以为我会澄清这一点...

# java - 多个线程的启动和连接顺序不同？

> ID：10154729
> 
> 赞同：1
> 
> 时间：2012-04-14T15:22:44.287
> 
> 标签：java, android, multithreading

我正在开发一个使用线程的 android 应用程序。你能告诉我这3段代码之间的区别吗？

第一的：

```
Thread t1 = new Thread (new Class1(param1));
Thread t2 = new Thread (new Class2(param2));

t1.start();
t2.start();

t1.join();
t2.join(); 
```

第二：

```
Thread t1 = new Thread (new Class1(param1));
Thread t2 = new Thread (new Class2(param2));

t1.start();
t1.join(); 

t2.start();
t2.join(); 
```

第三：

```
Thread t1 = new Thread (new Class1(param1));
t1.start();

Thread t2 = new Thread (new Class2(param2));
t2.start();

t1.join();
t2.join(); 
```

另外，如果两个类 (`class1`和`class2`) 扩展同一个类，会有什么不同`Class`？

我仍然需要知道 Class1 和 Class2 两个类是否扩展同一个类（MAINCLASS）并实现可运行，会发生冲突吗？换句话说，它可以工作吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:31:44.400

1) 和 3) 类似：它们都启动 2 个线程并等待它们完成。

2）在开始 t2 之前等待 t1 完成，这使得在这个例子中使用线程有点毫无意义

# c# - 如何检查现有记录

> ID：10154731
> 
> 赞同：2
> 
> 时间：2012-04-14T15:22:57.440
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework-4

嗨人们是 MVC3 和学习的新手，我想知道当用户添加游戏时是否可以允许用户在我的网站上检查游戏是否已经输入。我想要这个功能，所以我网站上的任何游戏玩家都无法对同一款游戏进行全面评论。原因是我有一个用户可以在其中谈论游戏的页面。所以这就是为什么我想要一种在添加新游戏时检查数据库的方法，如果游戏存在的话。

我的控制器如下：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using PagedList;
using System.Web;
using System.Web.Mvc;
using System.IO;
using Test.Models;

namespace Test.Controllers
{ 
    public class GameController : Controller
    {
        private gamezoneDBEntities db = new gamezoneDBEntities();

        //
        // GET: /Game/

        public ViewResult Index(string Ordering, string WordFilter, string DisplaySearchResults, int? CounterForPage)
        {

            {
                var Info = db.tblGames.Include(x => x.tblConsole);

            }

            var Games = from b in db.tblGames
            .Where(U => U.UserName == User.Identity.Name)
                        select b;

            switch (Ordering)
            {
                case "HeadlineName":
                    Games = Games.OrderBy(b => b.GameName);
                    break;
                case "DatePosted":
                    Games = Games.OrderBy(b => b.ReleaseYear);
                    break;
                case "DiscriptionDate":
                    Games = Games.OrderBy(b => b.ReleaseYear);
                    break;
                default:
                    Games = Games.OrderByDescending(b => b.ReleaseYear);
                    break;
            }

            int pageSize = 3;
            int pageNumber = (CounterForPage ?? 1);
            var PageNumberResults = Games.ToPagedList(pageNumber, pageSize);
            ViewBag.PageNumberResults = Games.Count();
            if (PageNumberResults.Any())
            {
                return View(PageNumberResults);
            }

            return View("Error");
        }

        [HttpPost]
        public ActionResult Create(tblGame tblgame,
           HttpPostedFileBase image1,
           HttpPostedFileBase image2)
        {
            try
            {
                if (ModelState.IsValid)
                {

                    if (image1 != null)
                    {
                        string image = image1.FileName;
                        tblgame.Image = image;
                        var image1Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), image);
                        image1.SaveAs(image1Path);
                    }

                    if (image2 != null)
                    {

                        string Image2 = image2.FileName;
                        tblgame.Image2 = Image2;
                        var image2Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), Image2);
                        image2.SaveAs(image2Path);
                    }
                    db.tblGames.Add(tblgame);
                    db.SaveChanges();
                    return RedirectToAction("Index");
                }
                ViewBag.ConsoleNameIDFK = new SelectList(db.tblConsoles, "ConsoleName", "ConsoleName", tblgame.ConsoleNameIDFK);
                return View(tblgame);
            }
            catch
            {
                return View("Upload_Image_Failed");
            }

        }

        //
        // GET: /Game/Create

        public ActionResult Create()
        {

            ViewBag.ConsoleNameIDFK = new SelectList(db.tblConsoles, "ConsoleName", "ConsoleName");
            return View(new tblGame { UserName = @User.Identity.Name });

        } 

        public ViewResult Details(int id)
        {
            tblGame tblgame = db.tblGames.Find(id);
            return View(tblgame);
        }

        //
        // GET: /Game/Edit/5

        public ActionResult Edit(int id)
        { 
                tblGame tblgame = db.tblGames.Single(i => i.GameID == id);
                ViewBag.ConsoleNameIDFK = tblgame.ConsoleNameIDFK;
                return View(tblgame);
            }

        [HttpPost]
        public ActionResult Edit(tblGame tblgame, HttpPostedFileBase Image, int id,
            HttpPostedFileBase image2)
        {
            if (ModelState.IsValid)
            {

                if (Image != null)
                {
                    string image = Image.FileName;
                    tblgame.Image = image;
                    var image1Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), image);
                    Image.SaveAs(image1Path);
                }

                if (image2 != null)

                {

                    string Image2 = image2.FileName;
                    tblgame.Image2 = Image2;
                    var image2Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), Image2);
                    image2.SaveAs(image2Path);
                }

                db.tblGames.Attach(tblgame);
                db.Entry(tblgame).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Edit");
            }

            ViewBag.ConsoleNameIDFK = new SelectList(db.tblConsoles, "ConsoleName", "ConsoleName", tblgame.ConsoleNameIDFK);
            return View(tblgame);
        }

        //
        // GET: /Game/Delete/5

        public ActionResult Delete(int id)
        {
            tblGame tblgame = db.tblGames.Find(id);
            return View(tblgame);
        }

        //
        // POST: /Game/Delete/5

        [HttpPost, ActionName("Delete")]
        public ActionResult DeleteConfirmed(int id)

        {
            try
            {

                tblGame tblgame = db.tblGames.Find(id);
                db.tblGames.Remove(tblgame);
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            catch
            {
                return View("Error");

            }
        }  

        protected override void Dispose(bool disposing)
        {
            db.Dispose();
            base.Dispose(disposing);
        }
    }
} 
```

我一直很难尝试查看游戏是否存在，因为我有让用户独一无二的代码。我需要这个代码，否则我可以有一个语句来检查所有游戏的数据库，如果游戏存在这个代码，我会抛出一个错误，这对我来说有点困难，这就是我来这里的原因。

我已将以下内容添加到我的控制器中：

```
[HttpPost]
public ActionResult Create(tblGame tblgame, HttpPostedFileBase image1, HttpPostedFileBase image2)
{
    try
    {
        if (ModelState.IsValid)
        {
            var mygame = db.tblGames.Where(x => x.GameName == tblgame.GameName).SingleOrDefault();
            if (mygame != null)
            {
                if (image1 != null)
                                {
                                    string image = image1.FileName;
                                    tblgame.Image = image;
                                    var image1Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), image);
                                    image1.SaveAs(image1Path);
                                }

                                if (image2 != null)
                                {

                                    string Image2 = image2.FileName;
                                    tblgame.Image2 = Image2;
                                    var image2Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), Image2);
                                    image2.SaveAs(image2Path);
                                }
                                db.tblGames.Add(tblgame);
                                db.SaveChanges();
                                return RedirectToAction("Index");
            }
            else
            {
                //otherwise we add a generic error to the model state
                ModelState.AddModelError("", "A game review already exists");
            }
        }
    }
    catch
    {
        return View("Upload_Image_Failed");
    }
    //if arrive here the model is returned back to the view with the errors added
    return View(tblgame);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:35:03.450

您可以使用 Linq 查询在保存之前检查游戏是否存在。假设在我的示例中，字段名称足以识别您可以这样做的游戏评论

```
 [HttpPost]
    public ActionResult Create(tblGame tblgame, HttpPostedFileBase image1, HttpPostedFileBase image2)
    {
        try
        {
            if (ModelState.IsValid)
            {
              var mygame = db.tblGames.Where(x => x.GameName == tblgame.GameName).SingleOrDefault();
              if (mygame != null)
              {
                if (image1 != null)
                {
                  string image = image1.FileName;
                  tblgame.Image = image;
                  var image1Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), image);
                  image1.SaveAs(image1Path);
                }
                if (image2 != null)
                {
                  string Image2 = image2.FileName;
                  tblgame.Image2 = Image2;
                  var image2Path = Path.Combine(Server.MapPath("~/Content/UploadImages"), Image2);
                  image2.SaveAs(image2Path);
                }
                db.tblGames.Add(tblgame);
                db.SaveChanges();
                //All ok, we redirect to index or to Edit method. (PRG pattern)
                return RedirectToAction("Index");
              }
              else
              {
                //otherwise we add a generic error to the model state
                ModelState.AddModelError("", "A game review already exists");
              }
            }
        }
        catch
        {
          //return View("Upload_Image_Failed");
          ModelState.AddModelError("", "The upload of the images as failed");
        }
        //if we arrive here, the model is returned back to the view with the errors added
        ViewBag.ConsoleNameIDFK = new SelectList(db.tblConsoles, "ConsoleName", "ConsoleName", tblgame.ConsoleNameIDFK);
        return View(tblgame);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:33:39.890

从您提供的代码中，您应该更改您的`Create`操作方法：

```
[HttpPost]
public ActionResult Create(tblGame tblgame, // tblGame is the new game being created
       HttpPostedFileBase image1,
       HttpPostedFileBase image2)
{
    try
    {
        if (ModelState.IsValid)
        {
             /* Go to DB and check if there's a Game already there that matches this
                one just being added. What's the property you want to check against?
                That's something you must provide. I just wrote GameName to show you
                how to do this... */
             var game = db.tblGames.Single(g => g.GameName == tblGame.GameName);

             /* OK, can proceed adding this game... since there's no game in the DB
                that matches this one being added. */
             if (game == null)
             {
                // Continue saving the new game
             }
             else /* Abort and display a message to user informing that there's a game
                  already. */
             {
                // TODO
             }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T17:07:21.687

> 我一直很难尝试查看游戏是否存在，因为我有让用户独一无二的代码。我需要这个代码，否则我可以有一个语句来检查所有游戏的数据库，如果游戏存在这个代码，我会抛出一个错误，这对我来说有点困难，这就是我来这里的原因。

每个用户都有自己独特的游戏列表，您将有一个名为 GameMapping 的表，类似于这样，它将每个用户映射到一个游戏。

身份证 | 用户名 | 游戏ID

ID 是您的自动递增的主键。UserID 是链接到用户主 ID 的外键，而 GameID 是链接到特定游戏的外键。

```
var user = GetUser(); // not sure what you use to identity users, but that logic would go here
var game = Db.Games.Where(g => g.Name == tblGame.Name).First();

Db.GameMapping
   .Where(g => g.UserID == user.ID) // filter out all records for that user
   .Select(g => g.GameID) // select just the game IDs
   .Contains(game.ID) // see if the game id they want to add is in that list 
```

* * *

这是执行相同检查的替代 LINQ 查询。

```
if (Db.GameMapping.Where(gm => gm.UserID == User.ID && gm.GameID == game.ID).Count() > 0)
     // user already has that game
else
     // they do not 
```

* * *

看起来您的项目的增长开始引入错误并变得有点不堪重负。在您的项目中实施此游戏检查代码之前，我强烈建议您首先设置一个小型单元测试。创建一个与您的大项目分开的新项目，添加您的数据库库并创建一个非常小的测试，您可以在其中输入一个游戏和一个用户，然后查看此代码是否按预期工作。一旦您知道您的实施是可靠的，然后将其集成到更大的项目中。

当您将项目分解成更小的部分并测试每个部分时，您将大大降低调试整个项目的复杂性。祝你好运。

# android - Android DefaultHttpClient REST api

> ID：10154734
> 
> 赞同：0
> 
> 时间：2012-04-14T15:23:05.440
> 
> 标签：android, apache

我实现了一个小型 android 应用程序，它通过 REST api 从服务器接收数据。每个 Activity 都包含一个 AsyncTask，它从服务器获取请求的数据。我将 DefaultHttpClient 与 ThreadSafeConnManager 一起使用，并且客户端是单例以便重用它。当我测试应用程序并浏览活动时，有一个奇怪的问题：一切都在工作一段时间，突然接收数据需要越来越长的时间。如果我在活动中快速点击后退按钮，就会发生这种情况 - 我怀疑由于 asynctask 客户端连接尚未释放并且新任务无法连接。但是，如果我在每个 HttpGet 中创建一个新的客户端实例，也会发生同样的情况。

我坚持这个问题，不知道出了什么问题。任何帮助表示赞赏。

谢谢，彼得兄弟

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:27:09.280

AsyncTasks 有点棘手，尤其是长时间运行的操作。听起来您可能有几项任务试图满足您的要求。请记住，在此过程中的某个时间，您的客户会阻止。

我建议您从 asyncTasks 转移到带有请求队列的线程服务。如果您决定继续使用 asyncTasks，请确保您的取消已正确实施。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:18:06.517

这是您的案例的正确方法，在 Nelson 建议的同一页面内。

我会尝试对我的请求和线程执行器进行更多控制。请记住，Asynctask 的池是有限的。如果您的操作足够长，则请求将排队更大。

[http://joseluisugia.wordpress.com/2012/08/03/using-runnables-queues-and-executors-to-perform-tasks-in-background-threads-in-android/](http://joseluisugia.wordpress.com/2012/08/03/using-runnables-queues-and-executors-to-perform-tasks-in-background-threads-in-android/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:30:03.370

这个问题已经讨论过：

[Android HttpClient 性能](https://stackoverflow.com/questions/4654480/android-httpclient-perfomance)

1.  打开 connectionMgr 的调试级别日志记录，检查生命周期事件
2.  看看 closeExpiredConnections() 方法看看
3.  closeIdleConnections(long idleTimeout, TimeUnit tunit)

我认为您应该更仔细地查看来自您的 connectionPool 的连接的生命周期，特别是空闲和未使用的连接被关闭或重用。

您可以查看 ThreadSafeConnManager 的 API/文档，也可以查看源代码。

# ruby-on-rails-3 - Authlogic - 在不同页面上登录后如何重定向，第一次是什么时候？

> ID：10154735
> 
> 赞同：1
> 
> 时间：2012-04-14T15:23:08.273
> 
> 标签：ruby-on-rails-3, redirect, login, authlogic

我在我的应用程序中使用**Authlogic** gem 进行身份验证，并尝试添加一个功能，即用户第一次登录的时间，所以我想在欢迎“页面”上重定向他。在 DB 表中是列`login_count`。

在**UserSessionsController**我尝试使用此代码：

```
 def create
    @user_session = UserSession.new(params[:user_session])

    respond_to do |format|
      if @user_session.save
        if current_user.login_count == 1
          format.html { redirect_to(root_url+'welcome') }
        else
          format.html { redirect_to(root_url+'profile_page') }
        end
        format.xml  { render :xml => @user_session, :status => :created, :location => @user_session }
      else
        format.html { redirect_to :signin_user_sessions
                      flash[:warning] = 'Bad log-in credentials.' 
                    }
        format.xml  { render :xml => @user_session.errors, :status => :unprocessable_entity }         
      end
    end
  end 
```

但在这种情况下，我收到了错误消息

> nil:NilClass 的未定义方法“login_count”

我将**Authlogic**与通常的设置一起使用。

我应该在哪里放置重定向逻辑并测试该用户已经登录了多少次？

# java - Solr - 让 Java 无法运行

> ID：10154736
> 
> 赞同：2
> 
> 时间：2012-04-14T15:23:15.567
> 
> 标签：java, solr, django-haystack

我正在尝试开始使用 Solr，但似乎找不到 Java。我已将 JRE 安装在`/home/bill/jre1.6.0_31`. 但是根据 Solr 教程，听起来我什至不需要访问它。请参阅以下教程的摘录：

> Solr 可以在您选择的任何 Java Servlet 容器中运行，但为了简化本教程，示例索引包括一个小型 Jetty 安装。
> 
> 要使用 Solr WAR 和示例配置启动 Jetty，只需运行 start.jar ...

当我这样做时，我得到以下信息：

```
bill@ubuntu:/home/~solr/apache-solr-3.6.0/example$ java -jar start.jar

The program 'java' can be found in the following packages:

 * gcj-4.4-jre-headless
 * openjdk-6-jre-headless
 * cacao
 * gij-4.3
 * jamvm

Try: sudo apt-get install   -- 'selected package' 
```

我已经安装了 JRE，显然不想安装更多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:48:18.783

首先运行这些：

```
sudo apt-get install python-software-properties
sudo add-apt-repository ppa:sun-java-community-team/sun-java6
sudo apt-get update
sudo apt-get install sun-java6-jdk 
```

这些将安装 JDK，然后您可以运行 solr。

# javascript - 谷歌浏览器能走多远？

> ID：10154737
> 
> 赞同：3
> 
> 时间：2012-04-14T15:23:28.797
> 
> 标签：javascript, google-chrome, google-chrome-extension

我想开发一个谷歌浏览器扩展，它必须检测搜索表单，然后联系服务器并在本地执行一些操作。我是这个领域的初学者（以前从未编写过扩展程序）所以我有几个问题，因为谷歌开发者中心对我来说不够清楚，也许你可以帮助我。

当用户单击特定字段时，浏览器如何识别它们？我不想要确切的答案，只是一个开始寻找/学习的地方。此外，扩展是否能够执行算术运算？

干杯，p312z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T21:57:16.993

您最好的选择很可能是添加事件侦听器以检查并查看用户何时单击特定字段。尽管您无法真正预测在各种网站上将调用哪些字段，但您可以让后台脚本侦听一些标准单词，例如“地址”或“名称”。我建议您快速搜索与 JavaScript 相关的资源，以便您熟悉浏览器中发生的事件函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T13:16:17.753

更重要的是，扩展可以在加载时将 javascript 文件注入任何网站页面。在注入的脚本中，您可以添加自己的逻辑：如果是表单，则检查字段 id、标签等。然后相应地添加事件侦听器。然后，注入的脚本可以根据需要与后台页面对话。查看“实现”中有关“消息传递”的文档部分。我同意文档非常简洁。他们的论坛链接？送你到这里。我希望用户可以评论文档，就像在 php.net 中一样。

# iphone - 淡出动画突然停止

> ID：10154739
> 
> 赞同：0
> 
> 时间：2012-04-14T15:23:36.550
> 
> 标签：iphone, xcode, animation, fade

我有一个手势后出现的标签，我想淡出标签。下面的代码有效，但如果我连续做几个手势，最后一个不会完成淡入淡出和显示，而是突然停止。这是我的代码：

```
- (void) gestureLabelAppear:(NSString *)theLabelText
{
    myLabel = [[UILabel alloc] initWithFrame:CGRectMake(gestureEndPoint.x, gestureEndPoint.y, 200, 20)];
    myLabel.center=CGPointMake(gestureEndPoint.x, gestureEndPoint.y);
    myLabel.textAlignment = UITextAlignmentCenter;  
    myLabel.text =theLabelText;
    [self.view addSubview:myLabel];
    [self fadeOutLabels];

}

-(void)fadeOutLabels
{
    [UIView animateWithDuration:3.0 
                          delay:0.0 
                        options:UIViewAnimationCurveEaseInOut 
                     animations:^ {
                         myLabel.alpha = 0.0;
                     } 
                     completion:^(BOOL finished) {
                         [myLabel removeFromSuperview];
                         NSLog(@"removed label");
                     }];
} 
```

有关如何修复的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T13:21:09.657

您通过省略方法解决了主要问题`removeFromSuperview`，`fadeOutLabels`但现在这些标签会累积，占用内存。并且您一开始就进行了分配而不提供释放。

我认为这两个更改可能会完善您已经得出的解决方案：

1) 为 UILabel 创建一个名为“myLabel”的属性。

2）改变`gestureLabelAppear`和`fadeOutLabels`这个：

```
- (void) gestureLabelAppear:(NSString *)theLabelText 
{
if (self.myLabel) {
    [self.myLabel removeFromSuperview];
    self.myLabel = nil;
}
self.myLabel = [[[UILabel alloc] initWithFrame:CGRectMake(gestureEndPoint.x, gestureEndPoint.y, 200, 20)] autorelease];
self.myLabel.center=CGPointMake(gestureEndPoint.x, gestureEndPoint.y);
self.myLabel.textAlignment = UITextAlignmentCenter;  
self.myLabel.text =theLabelText;
[self.view addSubview:self.myLabel];
[self fadeOutLabels];

}

-(void)fadeOutLabels 
{
[UIView animateWithDuration:3.0 
                      delay:0.0 
                    options:UIViewAnimationCurveEaseInOut 
                 animations:^ {
                     myLabel.alpha = 0.0;
                 } 
                 completion:NULL];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T18:05:08.763

问题可能是您要求处理器连续执行太多动画和/或动画被事件循环中的其他进程中断。我经常发现这样的时间问题可以通过插入延迟来解决。

尝试替换`[self fadeOutLabels];`为`[self performSelector:@selector(fadeOutLabels) withObject:nil afterDelay:(NSTimeInterval)0.1];`

和/或替换`[self.view addSubview:myLabel];`为`[self.view performSelector:@selector(addSubview:) withObject:myLabel afterDelay:(NSTimeInterval)0.1];`

（我并不是说我了解所有的内部工作原理，只是说这个组合过去曾为我工作过类似的问题。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:39:41.857

这是似乎有效的代码。我需要为标签添加标签，这样我就可以明确地引用我正在创建的各个标签。我通过将 alpha 值更改为 0.2 并观察它们消失来验证标签是否消失。

```
- (void) gestureLabelAppear:(NSString *)theLabelText 
{
    counter=counter+1;
    self.myLabel = [[UILabel alloc] initWithFrame:CGRectMake(gestureEndPoint.x, gestureEndPoint.y, 200, 20)];
    self.myLabel.center=CGPointMake(gestureEndPoint.x, gestureEndPoint.y);
    self.myLabel.textAlignment = UITextAlignmentCenter;  
    self.myLabel.text =[NSString stringWithFormat:@"%@-%d",theLabelText,counter];
    self.myLabel.tag=counter;
    [self.view addSubview:self.myLabel];
    [self fadeOutLabels:counter];    

}

-(void)fadeOutLabels:(int)theTag 
{
    [UIView animateWithDuration:3.0 
                      delay:0.0 
                    options:UIViewAnimationCurveEaseInOut 
                 animations:^ {
                     self.myLabel.alpha = 0.2;
                 } 
                 completion:^(BOOL finished) {
                    UILabel *label = (UILabel *)[self.view viewWithTag:theTag]; 
                    [[self.view viewWithTag:theTag] removeFromSuperview];
                    label=nil;
                 }];
} 
```

# java - 如何在mysql中转换字符串类型（java）并存储在日期数据类型中？

> ID：10154743
> 
> 赞同：0
> 
> 时间：2012-04-14T15:23:58.407
> 
> 标签：java, mysql, date

我想将 JForm 中的值插入 mysql 数据库。但我无法将值插入日期字段。此代码在日期字段之外有效。有人能帮我吗..

```
 String s1=txtUsername.getText();
            String s2=txtPassword.getText();
            String s3=txtName.getText();
            String s4=txtAddress.getText();
            String s5=txtContractEndDetails.getText();

            connection getcon = new connection();
            Connection conn;

    try{
        conn=getcon.creatConnection();

             String sql="insert into TravelGuide(username,password,name,address,contract_end_date)values(?,?,?,?,?)";

             PreparedStatement stmt = conn.prepareStatement(sql);
          java.sql.Date dtValue = java.sql.Date.valueOf(s5); 

           stmt.setString(1, s1);

          stmt.setString(2, s2);

          stmt.setString(3, s3);
           stmt.setString(4, s4);

        stmt.setDate(5, s5);

           stmt.executeUpdate();

        }

    catch(Exception ex){
        JOptionPane.showMessageDialog(PanelTG, ex.getMessage(),"Error Occured 123",2);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:38:12.487

由于您使用的是 MySQL DB，因此您需要将 s5 变量字符串格式化为 yyyy-mm-dd 日期。您可以使用 dateFormat 对其进行格式化。或者确保你的 s5 变量应该包含这样的字符串 '2000-06-30'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:32:23.903

为了把一个字符串变成一个`java.util.Date`对象，你需要一个`DateFormat`（例如`SimpleDateFormat`）

*   [使用所需的日期格式屏蔽输入字段](https://stackoverflow.com/questions/3037050/extending-jtextfield-value-to-take-date-format)或使用日历组件。
*   用于`dateFormat.parse(..)`将字符串转换为`Date`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:45:33.543

你需要通过一个[`java.util.Date`](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html). 您可以使用a`Date`从 a解析a 。`String`[`SimpleDateFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)

您的代码可能如下所示：

```
String s5 = txtContractEndDetails.getText();
SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd");
Date contractEndDate = null;
try {
     contractEndDate = simpleDateFormat.parse(s5);
} catch (ParseException e) {
    // handle telling the user they have bad input
}
stmt.setDate(5, contractEndDate); 
```

笔记：

*   您需要选择适合您的用户的日期格式。有关您有哪些选项的更多信息，请参阅[javadoc](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)
*   您需要决定如何处理错误输入并对其进行编码（抛出异常或向他们显示消息等）
*   作为风格问题，请避免使用变量名`s1`，例如`s2`等。它们会导致不可读，从而导致错误：使用正确的名称`name`，例如`address`等，或内联它们（即删除它们并直接使用初始化它们的代码）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-04T10:48:38.750

让我给你基本的去扔如何转换字符串类型的数据，即我们从网页/HTML页面获取数据，然后用java处理数据，然后将其插入Mysql的DB。下面只是一段代码。

```
 String d = req.getParameter("dob");       
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-mm-dd");
        java.util.Date convertedDate =  formatter.parse(d);
        java.sql.Date date1 = new java.sql.Date(convertedDate.getTime());
        prestat.setDate(3,  date1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-25T13:34:10.843

```
public class Test {

    public static void main(String[] args){
        Date date = new Date();

        DateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd");
        String newDate = simpleDateFormat.format(date);
        System.out.println("DateIn String datatype = "+newDate);

        System.out.println("DateIn Date datatype = "+java.sql.Date.valueOf(newDate));

    }
} 
```

# matlab - 如何在 MATLAB 中播放实时 UDP 视频流

> ID：10154744
> 
> 赞同：0
> 
> 时间：2012-04-14T15:24:31.307
> 
> 标签：matlab, udp, video-streaming

我正在编写一个 MATLAB 脚本，该脚本在端口上获取实时视频流并在 MATLAB gui 中播放该视频。我查看了 videoinput 功能，但这似乎需要将实际硬件连接到计算机。

我正在某个端口上侦听 UDP 视频流，我想在 GUI 中以伪实时方式播放该视频。目前我正在逐帧接收原始 RGB 字节流。

重点：

这可能吗？如果是这样，人们将如何做到这一点？在这一点上，任何解决方案都是可行的，尽管我想在大部分工作中使用内置函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T03:22:51.063

如果您不需要高吞吐量，您可以使用[UDP 工具箱](http://www.mathworks.com/help/toolbox/instrument/udp.html)轻松地将 Matlab 连接到 UDP 端口。

如果您的帧只是原始 RGB 图像，您可以使用[image](http://www.mathworks.com/help/techdoc/ref/image.html)命令来显示它们。

如果您需要高吞吐量或需要实现更复杂的解码器，请考虑按照[此答案](https://stackoverflow.com/a/1661708/1257977)的建议在 Java 中实现它。

# c# - 你会怎么称呼一个从不打算在 C# 中实例化的类？

> ID：10154745
> 
> 赞同：0
> 
> 时间：2012-04-14T15:24:33.117
> 
> 标签：c#, class, static

你会怎么称呼一个从不打算在 C# 中实例化的类？

例如，我将所有类文件放在一个名为 Objects 的文件夹中，但是，现在我想要一个只包含控制其他对象使用的静态方法的类，但它本身永远不会被实例化，而且我不知道在哪里把它放在我的文件结构中或者叫什么！

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T15:26:22.960

您可以调用该静态类。你可以把它放在一个帮助文件夹中，然后调用它`XxxUtil`或者`XxxHelper`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T15:26:18.607

通常我会在这些类型后面加上名称 Utils。

```
public static class ObjectUtils {
  ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T16:27:00.443

正如 DarthVader 所建议的，`XXXUtil`并且`XXXHelper`是好名字。如果静态类包含扩展方法，那么我称之为`XxxExtension`.

```
public static class StringExtension
{

    public static double ToDouble(this string myString)
    {
         return double.Parse(myString);
    }

} 
```

# ios - NSURL URLWithString 到相对 url

> ID：10154747
> 
> 赞同：1
> 
> 时间：2012-04-14T15:24:51.730
> 
> 标签：ios, django, api, upload

我想从 ios 应用程序将图像（UIImage）上传到 django 网站。（其中有表单和提交按钮，就像普通网页一样。）

所以我决定为此使用 ASIFormDataRequest。（我是菜鸟，我做得对吗？）

第一的，

```
NSURL *url = [NSURL URLWithString:@"http://someec2site/profile/album/2/upload/"]; 
```

错误：当前 URL`profile/album/2/upload/`与其中任何一个都不匹配。

所以我做了，

```
NSURL *url = [NSURL URLWithString:@"http://someec2site/profile/albums/(?P&lt;album_id&gt;\d+)/upload/"]; 
```

错误：未知的转义序列 '\d'

我有个问题。

1）我做得对吗？

2) 如何获取字符串的相对 url？（基于 url.py 重定向 url）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:35:11.577

首先，您选择使用 ASI 非常适合 HTTP 请求。

如果我没记错的话，您正在尝试为不同的专辑 ID 构建上传网址。

你为什么不试试这个：

```
NSString * urlString = [NSString stringWithFormat:@"http://someec2site/profile/album/%d/upload/",albumId];
NSURL * url = [NSURL urlWithString:urlString]; 
```

# c - C 导入问题节点 Rs232

> ID：10154753
> 
> 赞同：0
> 
> 时间：2012-04-14T15:25:18.310
> 
> 标签：c, node.js, serial-port

我有以下结构：

```
~/Desktop/hellonode$ ls 
build    rs232.h    testnode.js    helloworld.cc    helloworld.node    rs232.c 
```

并在`rs232.h`：

```
int OpenComport(int, int); 
```

但是当我尝试创建一个节点原生插件并使用以下代码时：

```
#include "rs232.h"

using namespace v8;

void init(Handle<Object> target) {
  int cport_nr=0;        /* /dev/ttyS0 (COM1 on windows) */

  if(OpenComport(cport_nr, bdrate))
  {
    printf("Can not open comport\n");
    return;
  }

  target->Set(String::NewSymbol("hello"),
      FunctionTemplate::New(Method)->GetFunction());
} 
```

我使用 node-waf 构建插件

一切都编译得很好，但是，当我尝试运行它时，我收到以下错误：

> `~/Desktop/hellonode$ node testnode` `node: symbol lookup error: <~>/Desktop/hellonode/build/Release/helloworld.node: undefined symbol: OpenComport`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:39:40.380

这是链接错误，而不是编译器错误。在`OpenComport`中定义`rs232.c`，并且您是否链接`rs232.c`到您的可执行文件？

# ruby-on-rails - 如何在 Rails 中的多个数据模型之间共享类方法？

> ID：10154754
> 
> 赞同：3
> 
> 时间：2012-04-14T15:25:22.907
> 
> 标签：ruby-on-rails, ruby

我在 Ruby on Rails 中有多个 Active Record 数据模型，它们需要共享类方法。我可以轻松地在所有类中声明方法，但这违反了 DRY 原则。

我看过声明一个模块并使用“包含”来混合代码，但这似乎只适用于实例方法，而不适用于类方法。

在 Ruby/Rails 中执行此操作的首选方法是什么？（我试图创建一个基本的 ActiveRecord 类并从中继承，但 ActiveRecord 吓坏了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:39:18.313

ClassMethods 习惯用法是模块提供类和实例方法的常用方法：[http ://railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/](http://railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/)

如果您创建一个抽象基类，ActiveRecord 不应该惊慌失措，只要您`self.abstract_class = true`在该类中调用：http: [//api.rubyonrails.org/classes/ActiveRecord/Inheritance/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Inheritance/ClassMethods.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:31:11.903

使用`extend`而不是`include`与模块一起使用。这将混合类方法而不是实例方法。

或者您绝对可以从该基础继承您的基础模型`ActiveRecord::Base`并从该基础继承所有正常模型。ActiveRecord 不应该惊慌失措。

# c++ - 在 Qt4 上从另一个表单捕获表单的关闭事件

> ID：10154756
> 
> 赞同：1
> 
> 时间：2012-04-14T15:25:43.577
> 
> 标签：c++, qt, qt4

我有两种形式，比如form1和form2，现在我想在form1中关闭时捕捉form2的关闭事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T10:32:23.790

如何在 Form2 类中重新实现[void QWidget::closeEvent(QCloseEvent * event)](http://qt-project.org/doc/qt-5.0/qwidget.html#closeEvent)并从重新实现的函数发出信号。您可以将此信号连接到 Form1 的插槽。像这样的东西：

```
void Form2::closeEvent(QCloseEvent* event)
{
    emit closeRequestHasArrived();
    QWidget::closeEvent(event);
} 
```

# c - 使用 fork() 的 C 共享内存

> ID：10154766
> 
> 赞同：1
> 
> 时间：2012-04-14T15:26:35.643
> 
> 标签：c, fork, shared-memory

所以情况就是这样，我必须在unix中使用c开发一个多人游戏。现在我创建了套接字，服务器和客户端通信正常。现在这个游戏包括一个棋盘，所以每个客户端都有自己的 100x40 的 2d 数组，并且他们使用读/写（这也可以）将 x 和 y 位置发送到服务器。

现在，在服务器中，我正在使用 fork() 以便新客户端可以加入游戏。在孩子的部分，我收到 x 和 y 位置。现在我的问题是，如何将 x 和 y 位置存储到服务器中的“全局”板[100][40]（因此我可以检查冲突等）。我发现的困难是每个孩子都有自己版本的板，因为我使用的是 fork()，而且我只是更新那个特定孩子的板。我希望每次客户端发送它的 x 和 y 位置时，我都会将它们放在服务器中找到的板上。

我读过我需要使用某种 IPC，比如共享内存，但无法弄清楚。如果有人可以提供帮助，将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:32:06.303

使用共享内存 API 调用：`shmget`, `shmat`, `shmdet`, ...[示例代码](http://www.cs.cf.ac.uk/Dave/C/node27.html#SECTION002730000000000000000)。

如果服务器很简单，您可以使用线程。使用线程，您可以简单地访问相同的全局变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:39:07.853

您可以使用线程而不是进程，因为它们是轻量级的，即它们的开销要少得多。这个想法是在堆上分配板，以便在此进程中的所有线程之间共享它。

当有新玩家加入游戏时，[创建一个新线程](http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html)。

当玩家需要更新他们的棋盘信息时，应该以互斥的方式访问共享棋盘以防止[竞争条件](http://en.wikipedia.org/wiki/Race_condition)，例如：

```
void UpdateBoard(int X, int Y)
{
  // e.g., pthread_mutex_lock
  Enter critical section
  ..
  Update board(X, Y)
  ..
  // e.g., pthread_mutex_unlock
  Leave critical section
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:45:46.860

使用数据库将解决您所有的锁定/并发问题。

# django - django 查询集

> ID：10154767
> 
> 赞同：0
> 
> 时间：2012-04-14T15:26:36.723
> 
> 标签：django, orm, django-queryset

我有一家商店，这家商店有优惠如果您购买 5 件此商品清单，您将获得 3 美元的折扣，我试着写一个查询，

但没有用

```
o=order_products.objects.filter(order__id=1).values('product').annotate(Sum('qty'))
offers.objects.filter(products__id__in=o.values('product_id')).distinct(True) 
```

现在我怎么能匹配这个项目列表的数量等于有这个折扣或倍数

例如，如果他买了 5 件，他将获得 3 美元的折扣，如果他买了 10 件，他将获得 6 美元的优惠等......

```
class product(models.Model):
    id = models.AutoField(primary_key=True)
    name = models.CharField(max_length=255)
    price=models.FloatField()

class order(models.Model):
    id = models.AutoField(primary_key=True)
    order_date = models.DateTimeField(auto_now=True)

class order_products(models.Model):
    product=models.ForeignKey(product)
    qty=models.IntegerField()
    order=models.ForeignKey(order)

class offers(models.Model):
    id = models.AutoField(primary_key=True)
    products = models.ManyToManyField(product)
    qty = models.FloatField()
    discount_amount=models.FloatField() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:44:55.690

一种方法：

```
from collections import Counter

order = order_products.objects.filter(order__id=1).values('product__pk')
product_count = dict(Counter(order))

discounts = {}

for id,count in product_count.iteritems():
  offer = offers.objects.filter(products__pk=id,qty=count)
  if offer.count():
     discounts[id] = offer.discount_amount

for id,discount in discounts.iteritems():
   print '%d of %s discounted by %0.3f' % (product_count[id],product.objects.get(pk=id).name,discount) 
```

# javascript - 使用 javascript/jquery 的宽度和长度价格计算器帮助（添加选项）

> ID：10154768
> 
> 赞同：0
> 
> 时间：2012-04-14T15:26:43.843
> 
> 标签：javascript, jquery, options, calculator

大家好，

当我尝试添加选项时，我的价格计算器出现问题

（这里的 Js fiddle = [http://jsfiddle.net/wemdragon/hXydV/](http://jsfiddle.net/wemdragon/hXydV/)）

我想要做的是它说：

`var firstoption=$('select#myselect')`我希望将期权价值变成价格价值，例如：期权价值（即 1 ）= 20.00 但似乎无法做到。

如果有人能很好地帮助我并告诉我我做错了什么，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:33:01.250

您可能应该给出`<option>`您想要的值，然后使用：

```
var firstOption = +$('select#myselect').val(); 
```

jQuery`val()`抓取选定的值，`+`并将字符串值（如`"20"`）转换为数字。

# data-structures - 唯一有序数据结构

> ID：10154771
> 
> 赞同：1
> 
> 时间：2012-04-14T15:26:58.290
> 
> 标签：data-structures, language-agnostic, computer-science

知道要存储的数据由固定数量的唯一值组成（其中顺序很重要），要使用的最佳数据结构是什么？特别是，我试图以最佳方式存储一副 52 张卡片的状态，其中每张卡片由 1 到 52 之间的数字表示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:38:14.913

如果您唯一关心的是表达排列（*自然*顺序），您可以选择[阶乘数字系统](http://en.wikipedia.org/wiki/Factorial_number_system)，它是排列的最小可能表示形式。

顺便说一句：这不是一个非常*实用*的解决方案；52！大约是 8E67 ;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:30:23.963

一个数组/向量会很好地为你做这件事。

您有固定数量的对象（卡片），您可以用整数识别它们，而可能的整数值之间没有间隙。这允许您使用占用连续内存块并允许基于值（索引）直接访问的数据结构，并且访问使用整数值的自然排序——这完全适合数组/向量

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:32:40.890

如果您想确保集合中的唯一性，您可以在 Java 中使用[LinkedHashSet](http://docs.oracle.com/javase/tutorial/collections/interfaces/set.html)
，我希望其他语言/库也有类似的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T17:26:22.590

您只需要一个 226 位整数加上一个编号方案即可将牌组映射到其可能的顺序。

[将消息存储在一副卡片中](http://jerde.net/peter/cards/cards.html)

[上面链接的详细解释](http://jerde.net/peter/cards/explanation.html)

[key-deck](http://junkcode.erisian.com.au/key-deck)（简单的 Python 代码）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-14T15:35:49.023

鉴于顺序很重要并且元素数量固定，那么只需使用一组卡片，如下所示：

```
Card[] cards = new Card[52]; 
```

只需确保从 0 到 51 进行索引，在大多数编程语言中它比从 1 到 52 的索引更简单。

# c - 动态规划图块

> ID：10154775
> 
> 赞同：4
> 
> 时间：2012-04-14T15:27:36.980
> 
> 标签：c, algorithm, dynamic-programming

[http://www.spoj.pl/problems/GNY07H/](http://www.spoj.pl/problems/GNY07H/) 在这个问题中，我们必须找到在 4Xw (w >=1) 矩形中排列 2X1 瓷砖的多种方法？我已经尝试过这个问题并且花了很多时间，但无法提出任何解决方案。如何解决这类问题。意思是如何让 dp 为他们重复。?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-14T15:56:01.193

您可以逐行构建 4xW 矩形。当您构建下一行时，前一行可以处于 6 种不同的状态：

```
XXXX (1 - filled)
XX-- (2)
-XX- (3)
--XX (4)
X--X (5)
---- (6 - empty) 
```

例如，如果上一行是 (5)，则必须放置两个垂直的多米诺骨牌，然后下一行将是 (3)：

```
XXXX
XABX
-AB- 
```

让`X(W,q)`表示一个 4xW 矩形的可能组合，其中最后一行处于状态`q`，其余行完全填充。

如果您知道`X(W-1,q)`所有 6`q`个州，您可以轻松计算`X(W,q)`.

你知道初始状态`X(1,q)`（q=1..6 -> 1, 1, 1, 1, 1, 无效）。所以你可以增加 W 并为每个 W 获得这些数字。

最终结果是`X(W,1)`（填充最后一行）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-02T14:02:35.260

我也是这种动态编程变体的初学者，但此链接提到[您](http://apps.topcoder.com/forums/;jsessionid=A5053396424C9F9BBB9337ECAC9C6C17?module=Thread&threadID=770579&start=0&mc=2#1643035) 需要申请“带有配置文件的动态编程”，并且该链接还指向一个教程[http://apps.topcoder.com/forums/?module=Thread&threadID=697369&start=0&mc=19](http://apps.topcoder.com/forums/?module=Thread&threadID=697369&start=0&mc=19)特别是“层数+层配置文件”。

从上面的链接：“这是DP状态域中最难的类型。它通常用于在特殊图上**平铺或覆盖问题**。经典的例子是：计算用多米诺骨牌平铺矩形板的方法数（某些单元格不能“

有关此技术的其他更平易近人的教程可在以下位置获得：

[http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile.html](http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile.html)

[http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_13.html](http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_13.html)

[http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_7469.html](http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_7469.html)

[http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_6894.html](http://sk765.blogspot.in/2012/02/dynamic-programming-with-profile_6894.html)

我也在努力解决它们。

这不是对您提出的特定问题的答案，而是人们在解决此类问题时遵循的一般技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T15:36:58.287

我会尝试回溯算法：首先水平放置所有瓷砖，然后回溯，直到可以放置垂直瓷砖（然后水平分层向前） - 最终您将枚举所有可能的解决方案并且每个解决方案仅一次（最后一个回溯阶段中的正方形将包含水平或垂直瓷砖，如果存在，它将提供独特的解决方案）。

但是，我不知道这是否是解决问题的最佳算法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-02T14:50:44.847

如果通过删除任何 2*1 块出现模式（gemoetry ）使其再次成为中间结果，则只需设置模式，然后它会给出递归函数。从中创建 DP。

对于您的问题，只需查看链接。它会解释一切

[https://math.stackexchange.com/questions/664113/count-the-ways-to-fill-a-4-times-n-board-with-dominoes](https://math.stackexchange.com/questions/664113/count-the-ways-to-fill-a-4-times-n-board-with-dominoes)

如需进一步的参考，请参阅 IOI 培训的链接

[http://www.iarcs.org.in/inoi/online-study-material/topics/dp-tiling.php](http://www.iarcs.org.in/inoi/online-study-material/topics/dp-tiling.php)

# r - 如何将公式的右侧传递给另一个公式？

> ID：10154776
> 
> 赞同：5
> 
> 时间：2012-04-14T15:27:43.393
> 
> 标签：r

我想将公式的右侧传递给 R 函数，然后“添加”公式的左侧并调用`gam()`. 我想在没有丑陋的 as.formula() 结构等的情况下实现这一点。

我陷入了以下最小示例，您知道出了什么问题吗？

```
require(mgcv)
set.seed(0) ## set.seed(1)
gamEx1 <- gamSim(1, n=400, dist="normal", scale=2) ## simulate some data
str(gamEx1) ## display structure

## calling gam() and passing the right-hand side of a formula
gamFitter <- function(formula.RHS, data, ...){
    z <- 2*data$y + data$f0 # some given values
    gam(z ~ formula.RHS, data=data, ...) # call gam()
}

## call the function with the right-hand side of a formula
gamFitter(formula.RHS=~s(x0)+s(x1)+s(x2)+s(x3), data=gamEx1)

Error in model.frame.default(formula = z ~ formula.RHS, data = data,
                             drop.unused.levels = TRUE) :
  invalid type (language) for variable 'formula.RHS' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T20:22:39.457

看来您应该使用 R 的内置功能，即`update.formula`无需编写新函数：

```
> form <- ~s(x0)+s(x1)+s(x2)+s(x3)
> form
~s(x0)+s(x1)+s(x2)+s(x3)
> update.formula(form, z ~ .)
z ~ s(x0) + s(x1) + s(x2) + s(x3) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T17:35:34.507

这是基于@gsk3 想法的版本：

```
changeLHS <- function(formula, lhs) {
   if (length(formula) == 2) {
     formula[[3]] <- formula[[2]]
   }
   formula[[2]] <- substitute(lhs)
   formula
}

changeLHS(a~b+c, z+w)  # z + w ~ b + c
changeLHS(~b+c, z+w)   # z + w ~ b + c 
```

因此，您的代码变为：

```
gamFitter <- function(formula.RHS, data, ...){
  frm <- changeLHS(formula.RHS, 2*y + f0)
  gam(frm, data=data, ...) # call gam()
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-14T15:36:26.903

Kludgy，但它有效：

```
form1 <- as.formula("hi ~ lo + mid")
form2 <- as.formula("blue ~ red + green")
form2[[3]] <- form1[[3]]
> form2
blue ~ lo + mid 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-21T22:17:11.020

在其他答案的基础上，如果您需要通过传递字符串(à la ) 以[编程方式](https://stackoverflow.com/questions/12967797/is-there-a-better-alternative-than-string-manipulation-to-programmatically-build)`reformulate`替换 LHS ，那么两个小的调整会有所帮助。

使用@Tommy 的方法：

```
changeLHS <- function(formula, lhs) {
    if (length(formula) == 2) {
        formula[[3]] <- formula[[2]]
    }
    formula[[2]] <- as.symbol(lhs)
    formula
}

form <- ~s(x0)+s(x1)+s(x2)+s(x3)
changeLHS(form, "z")
## z ~ s(x0) + s(x1) + s(x2) + s(x3) 
```

使用@Derek 的方法：

```
update(form, reformulate(".", "z"))
## z ~ s(x0) + s(x1) + s(x2) + s(x3) 
```

# java - 在 Android 中为 smuge/wobble 效果制作矩阵（见图片）

> ID：10154781
> 
> 赞同：7
> 
> 时间：2012-04-14T15:28:15.773
> 
> 标签：java, android, matrix

***谢谢 Torious，明白了：***

```
 private void smudge() {

        for (int i = 0; i < COUNT*2; i += 2) {

            float xOriginal = matrixOriganal[i+0];
            float yOriginal = matrixOriganal[i+1];

            float distX = Math.abs(pointX-xOriginal);
            float distY = Math.abs(pointY-yOriginal);

            float dist = FloatMath.sqrt( distX*distX + distY*distY );

            float coof = ( bubbleSize - dist ) / bubbleSize;

        float oc = (float) -Math.sin(coof * 2*Math.PI) * 0.15f ;

            if ( dist < bubbleSize )
            {
            matrixVertsMoved[i+0] = xOriginal + smudgeAmount * (coof+oc);
            matrixVertsMoved[i+1] = yOriginal;
            }
            else
            {
            matrixVertsMoved[i+0] = xOriginal;
            matrixVertsMoved[i+1] = yOriginal;
            }

        }

        invalidate();
    } 
```

* * *

**old:** 现在我有这段代码，我是根据 SDK 附带的 api 示例制作的。

```
public class main extends Activity {

    ////////////////////////////////////////////////////////

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.main);

        LinearLayout ll01 = (LinearLayout)findViewById(R.id.linearLayout1);

        SampleView sv = new SampleView(this);
        ll01.addView(sv);
    }

    //////////////////////////////////////////////////////////////////////////////////////////////////////////////// 

    private static class SampleView extends View {
        static int WIDTH = 8; // sections
        static int HEIGHT = 8;
        static int COUNT = (WIDTH + 1) * (HEIGHT + 1); // total verts count

        Bitmap mBitmap; // declaring a bitmap
        float[] matrixVertsMoved = new float[COUNT*2]; // declaring an array with double amount of vert count, one for x and one for y
        float[] matrixOriganal = new float[COUNT*2];

        float clickX;
        float clickY;

        static void setXY(float[] array, int index, float x, float y) {
            array[index*2 + 0] = x;
            array[index*2 + 1] = y;
        }

        ///

        public SampleView(Context context) {
            super(context);
            setFocusable(true);

            mBitmap = BitmapFactory.decodeResource(getResources(), R.drawable.w);

            // construct our mesh
            int index = 0;
            for (int y = 0; y <= HEIGHT; y++) {
                float fy = mBitmap.getHeight() * y / HEIGHT;

                for (int x = 0; x <= WIDTH; x++) {
                    float fx = mBitmap.getWidth() * x / WIDTH;
                    setXY(matrixVertsMoved, index, fx, fy);
                    setXY(matrixOriganal, index, fx, fy);
                    index += 1;
                }

            }

        }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////// 

        @Override
        protected void onDraw(Canvas canvas) {

            canvas.drawBitmapMesh(mBitmap, WIDTH, HEIGHT, matrixVertsMoved, 0,  null, 0, null);

            Paint p1 = new Paint();
            p1.setColor(0x660000FF);

            Paint p2 = new Paint();
            p2.setColor(0x99FF0000);

            Paint p3 = new Paint();
            p3.setColor(0xFFFFFB00);

            for (int i = 0; i < COUNT*2; i += 2) {
                float x = matrixOriganal[i+0];
                float y = matrixOriganal[i+1];
                canvas.drawCircle(x, y, 4, p1);

                float x1 = matrixOriganal[i+0];
                float y1 = matrixOriganal[i+1];
                float x2 = matrixVertsMoved[i+0];
                float y2 = matrixVertsMoved[i+1];
                canvas.drawLine(x1, y1, x2, y2, p1);
            }

            for (int i = 0; i < COUNT*2; i += 2) {
                float x = matrixVertsMoved[i+0];
                float y = matrixVertsMoved[i+1];
                canvas.drawCircle(x, y, 4, p2);
            }

            canvas.drawCircle(clickX, clickY, 6, p3);

        }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////// 

        private void smudge() {

            for (int i = 0; i < COUNT*2; i += 2) {

                float xOriginal = matrixOriganal[i+0];
                float yOriginal = matrixOriganal[i+1];

                float dist_click_to_origin_x = clickX - xOriginal; // distance from current vertex in the original matrix to the place clicked.
                float dist_click_to_origin_y = clickY - yOriginal;

                float kv_kat = dist_click_to_origin_x*dist_click_to_origin_x + dist_click_to_origin_y*dist_click_to_origin_y;

                float pull = ( 1000000 / kv_kat / FloatMath.sqrt(kv_kat) );

                if (pull >= 1) {
                    matrixVertsMoved[i+0] = clickX;
                    matrixVertsMoved[i+1] = clickY;
                } else {
                    matrixVertsMoved[i+0] = xOriginal + dist_click_to_origin_x * pull;
                    matrixVertsMoved[i+1] = yOriginal + dist_click_to_origin_y * pull;
                }

            }

        }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////// 

        @Override
        public boolean onTouchEvent(MotionEvent event) {

                clickX = event.getX();
                clickY = event.getY(); 
                smudge(); // change the matrix.
                invalidate(); // calls a redraw on the canvas.

            return true;
        }

//////////////////////////////////////////////////////////////////////////////////////////////////////////////// 

    } 
```

重要的是最后的包装功能。这是它产生的结果。

// 蓝点是原始矩阵的顶点，而红点显示它们是如何从点击（黄点）移动的。

![在此处输入图像描述](../Images/d79adbfe7959581aec093e6112d8aa25.png)

然而，我需要的不是捏住一个顶点，而是像这样涂抹它。

![在此处输入图像描述](../Images/63a5e7dad12d9193975a9c24fc693b9b.png)

例如，此涂抹函数可以获取开始涂抹的像素或顶点坐标、x 和 y 偏移以及涂抹的强度，即影响周围顶点的强度。

任何想法如何做到这一点？

**编辑：基本上我正在尝试制作类似于[http://www.andwobble.com/的东西](http://www.andwobble.com/)**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:57:02.617

好的，我有一个看起来是你需要的（Flash）演示。

*我没有转换纹理网格，而只是转换顶点，因此很难验证效果是否完全符合预期，但它看起来是朝着正确方向迈出的一步。*

无论如何，这是代码；它在 AS3 中，但我怀疑它很难理解。

一些注意事项：

*   `CENTER`正如您在上面描述的那样，在下面的代码中将是涂抹操作的起点。这`controlPoint`将是终点。
*   我正在使用`Vector3D`，但仅使用其 2D 坐标。
*   `CENTER`,`controlPoint`并且输入`vertex`被视为在同一坐标系中。`CENTER`您可以改为相对于网格的局部坐标系进行预处理。然后，您可以从下面代码中的相对/局部坐标系中剥离变换。
*   逻辑函数用于从没有影响的影响圈边缘到完全影响的过渡。您可能可以使用其他几个功能来获得类似的效果。
*   我认为使用额外的第二个“拉到控制点”操作，强度更小，过渡更陡峭，效果会更好；现在，所有完全过渡到（接近）100% 影响的顶点都向控制点移动有点过于一致，我觉得。

试试看，如果您在理解 AS3 代码时遇到困难，请告诉我。

```
 private function log(t:Number):Number {
        return 1 / (1 + Math.pow(Math.E, -t));
    }

    private function transformVertex(vertex:Vector3D, controlPoint:Vector3D):Vector3D {

        // get control point relative to center of influence
        // (this could actually be calculated in pre-processing, as
        // it doesn't change between vertices)
        var controlPointRel:Vector3D = controlPoint.subtract(CENTER);

        // get vertex relative to center of influence
        var rel:Vector3D = vertex.subtract(CENTER);

        // get distance of vertex from center
        var dst:Number = rel.length / RADIUS;
        if (dst > 1) return vertex; // vertex outside circle of influence

        // PULL TO CONTROL POINT

        // tScale controls the steepness of the transition from the
        // edge of the circle. 1 = logistic transition, >1 = steeper
        var tScale:Number = 1.7;
        var t:Number = (1 - dst) * 12 * tScale - 6; // [-6, 6]
        t = log(t);

        controlPointRel = controlPointRel.clone();
        controlPointRel.scaleBy(t);
        // ALTERNATIVE, try this too:
        // controlPointRel.scaleBy(t * (1 - dst));

        rel = rel.add(controlPointRel);

        // relative to absolute
        return rel.add(CENTER);

    } 
```

# perl - 核心 Perl 中是否有任何东西可以从“<>”运算符自动选择行？

> ID：10154783
> 
> 赞同：13
> 
> 时间：2012-04-14T15:28:24.513
> 
> 标签：perl, input

在进行 Perl 编码时，我遇到的一个小烦恼是必须记住从输入中读取的一行。是的，经过多年的编码，记住这样做几乎是自动的，但仍然很烦人。

Perl（强烈首选的核心模块）中是否有任何编译指示、模块或其他任何东西可以自动使用`<>`运算符读取每一行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T16:45:18.570

除了您已经提到的水源过滤器之外，恐怕我不知道在这里您的目的是什么算作“黑客”。你认为这些显而易见的解决方案中的任何一个都是“黑客”吗？

1.  `*CORE::readline`在当前包中覆盖
2.  覆盖 `*CORE::GLOBAL::readline`所有包
3.  `READLINE`使用自定义方法处理与类的联系
4.  `<>`运算符的运算符重载

你试过那些了吗？

其中，我认为第一个，或者可能是第二个，最有可能做你想做的事，并且用最少的麻烦。

请注意，所有这四种解决方案都只需要纯 Perl 即可。它们甚至不需要任何核心模块，更不用说任何 CPAN 模块了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T17:28:29.050

我想你已经知道这一点，但是当你将命令行选项`-nl`组合在一起时，你会得到你想要的行为（假设你想要隐式`while(<>)`循环：

```
$ perl -nle 'printf q{%s}, $_' 
```

通常这两个选项用于通过 bash 命令行运行简短的 perl 命令，但我想没有什么可以阻止您在脚本中执行此操作：

```
#!/usr/bin/perl -nl

# puts the newline back on if you use print:
# print

# does not put the newline back on
printf '%s', $_; 
```

此处对此行为的简要说明：[http ://www.perlmonks.org/?node_id=324749](http://www.perlmonks.org/?node_id=324749)

# ruby-on-rails - Omniauth/Rake 的奇怪错误

> ID：10154784
> 
> 赞同：0
> 
> 时间：2012-04-14T15:28:24.673
> 
> 标签：ruby-on-rails, ruby, omniauth

我刚刚将我的 git repo 克隆到服务器，但尝试运行服务器或 rake:dbmigrate 给我以下错误：

```
omniauth.rb:4: syntax error, unexpected ':', expending kEND
...ntity, on_failed_registration: lambda { |env| Identities Cont... 
```

它在我的本地主机上运行良好，在 Heroku 上运行良好。知道问题可能是什么吗？我使用的是 Rails 3.2，之前在朋友的 Windows 机器上看到过这个问题。

编辑：我的 Omniauth.rb

```
Rails.application.config.middleware.use OmniAuth::Builder do
    provider :twitter, '....', '....'
    provider :facebook, '....', '....'
    provider :identity, on_failed_registration: lambda { |env| IdentitiesController.action(:new).call(env) }
end 
```

# ruby-on-rails - Ruby on Rails 未定义方法 `discussions_path' - 嵌套资源，一对多关系

> ID：10154785
> 
> 赞同：0
> 
> 时间：2012-04-14T15:28:26.563
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-forms

这个问题看起来很简单，但我似乎无法解决它。我一定遗漏了一些明显的东西，但非常感谢任何帮助！

出现的错误信息：

```
undefined method `discussions_path' for #<#<Class:0x000001032e90d8>:0x000001030f1168> 
```

路由文件：

```
resources :forums do
  resources :discussions
end 
```

讨论/_form.html.erb 文件：

```
<%= form_for [@forum, @discussion] do |f| %>  
 <%= f.error_messages %>
 <p>  
  <%= f.label :name %><br />  
  <%= f.text_field :name %>  
 </p>
 <p><%= f.submit "Submit" %></p>  
<% end %> 
```

讨论控制器新动作：

```
def new
  @forum = Forum.find_by_permalink(params[:id])
  @discussion = Discussion.new
end 
```

这是我现在得到的完整错误（在终端中）：

```
Started GET "/forums/general-chat/discussions/new" for 127.0.0.1 at 2012-04-14 18:35:28 +0100
Processing by DiscussionsController#new as HTML
Parameters: {"forum_id"=>"general-chat"}
Forum Load (1.6ms)  SELECT "forums".* FROM "forums" WHERE "forums"."permalink" IS NULL LIMIT 1
Rendered layouts/_content_full_start.html.erb (0.0ms)
Rendered discussions/_form.html.erb (574.4ms)
Rendered discussions/new.html.erb within layouts/application (575.9ms)
Completed 500 Internal Server Error in 581ms 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:34:13.400

对于嵌套资源，您需要将数组传递给`form_for`论坛和讨论，例如`@forum`在您的控制器中设置，然后在视图中使用：

```
<%= form_for [@forum, @discussion] do |f| %> 
```

从[rails 文档](https://github.com/rails/rails/blob/4f66586bbfacbce4c07f2b9d8d142be1bf6d4e5e/actionpack/lib/action_view/helpers/form_helper.rb#L239)：

```
If your resource has associations defined, for example, you want to add comments
to the document given that the routes are set correctly:
<%= form_for([@document, @comment]) do |f| %>
...
<% end %>
Where @document = Document.find(params[:id]) and @comment = Comment.new. 
```

# html - 溢出隐藏似乎不起作用

> ID：10154786
> 
> 赞同：13
> 
> 时间：2012-04-14T15:28:30.957
> 
> 标签：html, css

我在 ul li 中有一个包含文本和图像以及文本详细信息的 div，下面是 html 结构。我已将溢出隐藏应用到 .sbox 类，但它似乎不起作用，并且文本详细信息似乎没有被隐藏和溢出。

JSFiddle - [http://jsfiddle.net/SAN6n/](http://jsfiddle.net/SAN6n/)

## HTML

```
<div id="content" class="contentList">
  <ul id="slist" class="storyList">    
    <li>
     <div id="storyBox1" class="sbox"> 
        <div class="boxContent" >
            <span class="overlay"><h5>Picture1 </h5></span>
            <div class="txtOverlay"><h3>This is spring and weather looks good ...</h3</div>
            <span><img src="http://img13.imageshack.us/img13/38/picture11tp.jpg"/></span>
         </div>
      </div>
     </li>    
    </ul>
</div>​ 
```

## CSS

```
.storyList {
  width:100%;
  height:100%;   
}

.sbox {
float:left;
width:300px;
height:150px;
padding: 5px 7px 8px 5px;
margin-top:20px;
margin-right:40px;

background:white;
border:1px solid #DDD;

<!--border radius-->
-webkit-border-radius: 3px;
-moz-border-radius: 2px;
border-radius: 3px;

overflow: hidden;

}

.boxContent {

width:100%;
height:100%;
border: 1px solid #777;
}

.storyList li {
list-style:none;
}

.overlay {

float:left;
opacity: .7;
background: #000;  
height: 40px;  
width: 300px; 
position: absolute;    
}

h5{
float:left;
margin-top:0px;
padding:0 0 0 5px;
font-family: Tahoma;
letter-spacing: 0.5px;
font-size:30px;
color: white; 

}

.txtOverlay {
opacity: .7;
background: #000;  
height: 110px;  
width: 300px; 
position: absolute;        
margin-top:150px;
z-index:1;
font-weight:bold;
float:left;
font-family: OpenSansRegular;
letter-spacing: 0.5px;
font-size:10px;
color: white;

}​ 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-14T15:40:23.920

[**演示**](http://jsfiddle.net/SAN6n/2/)

我想这就是你需要的吗？任何时候，当你有`two` `div's`另一个时`inside`，`first`div 需要设置为`relative`并且`other`div 需要设置为`absolute`位置。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-14T15:35:25.120

这是因为您使用的是绝对位置。您不能在溢出隐藏的情况下使用绝对位置，因为绝对位置会将目标元素移出文档结构的上下文。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T15:41:39.863

实际上它正在工作，您提供的填充和它所具有的内容，它使它无法应用`overflow:hidden;`

请参阅此[演示](http://jsfiddle.net/Starx/SAN6n/4/)以了解我的观点，我降低了高度，并且`overflow:hidden`正在工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:36:30.320

当你给你的元素一个绝对位置时 - 它也可以放在 div 的边界之外 - 因此 - 隐藏的溢出不应该影响它

# asp.net - 根据角色显示部分命令列

> ID：10154788
> 
> 赞同：1
> 
> 时间：2012-04-14T15:28:57.053
> 
> 标签：asp.net, vb.net, webforms, asp.net-membership

我有一个带有网格视图的页面。默认情况下，gridview 已选中“启用编辑”和“启用删除”。我希望能够在代码隐藏 page_load 事件中“取消选中”其中任何一个。

我发现[了这个 SO question](https://stackoverflow.com/questions/5128043/displaying-edit-button-in-gridview-based-on-role)但这隐藏了整个命令列。我只想根据用户的角色隐藏“编辑”或“删除”超链接。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:43:21.963

将此添加到您的 GridView： ondatabound="GridView1_DataBound" 分隔 GridView 中的命令列

```
<asp:CommandField ShowDeleteButton="True"  />
<asp:CommandField  ShowEditButton="True" />

protected void GridView1_DataBound(object sender, EventArgs e)
{
        if (User.IsInRole("Administrator"))
        {
            GridView1.Columns[0].Visible = true; 
            GridView1.Columns[1].Visible = true; 
        }
        else {
            GridView1.Columns[0].Visible = false;
        }
} 
```

根据您的要求更改列索引，第一列为 0

# javascript - 颜色框弹出窗口在javascript中不起作用

> ID：10154789
> 
> 赞同：0
> 
> 时间：2012-04-14T15:28:58.803
> 
> 标签：javascript, popup, gallery, colorbox

我正在尝试插入一个弹出窗口，该窗口通过单击 Jalbum 中的标题文本打开（这是一个制作 html 画廊的软件）。[我从这个网站http://www.javascript-coder.com/window-popup/javascript-popup-window.phtml](http://www.javascript-coder.com/window-popup/javascript-popup-window.phtml)下载了文件来制作颜色框弹出窗口，并将所需的代码复制到这个网页[http://www 中。 tellmefilms.tk/indejx.html](http://www.tellmefilms.tk/indejx.html)。代码是

var images=new Array( {file:'slides/1.jpg',video:false,thumb:'thumbs/1.jpg',caption:'

## 一些文字',thmcapt:'1**',link:'',date:'',mod:15395,size:'42 kB',width:264,height:520,rel:0},

在这里，您可以看到 id link_content 被赋予标签，但仍然单击文本不会打开弹出窗口。请帮我解决这个问题，如果无法弹出颜色框，请建议另一个弹出窗口，就像颜色框弹出窗口一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:56:33.853

您的 jquery.colorbox-min.js 文件是 404ing。`<script src="jquery.colorbox-min.js" type="text/javascript"></script>`该文件不存在。确保它已上传到您的服务器上。**

# javascript - 切换样式表闪烁

> ID：10154790
> 
> 赞同：4
> 
> 时间：2012-04-14T15:29:04.043
> 
> 标签：javascript, html, css

我有一个包含 2 个样式表的站点，一个用于白天阅读，一个用于夜间阅读。我有一个带有`onclick`事件的图像来调用一个函数来更改样式表。问题是，对于新访问者来说，当他们第一次单击按钮时，页面会在半秒钟内完全没有样式（即没有样式表），然后新的页面就会启动。我知道发生这种情况的原因是我删除了在`rel="stylesheet"`将当前工作表添加到新工作表之前。有什么办法可以改进功能，即使对于新访客也不会出现短暂的延迟？谢谢。

```
function changeStyleSheet() {
    var a = document.getElementById('stylesheet1');
    var b = document.getElementById('stylesheet2');
    var now1 = $(a).attr('rel');
    var now2 = $(b).attr('rel');
    if (now1 == 'stylesheet') {
        a.setAttribute('rel', 'alt-stylesheet');
        b.setAttribute('rel', 'stylesheet');
    } else {
        b.setAttribute('rel', 'alt-stylesheet');
        a.setAttribute('rel', 'stylesheet');
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:58:13.687

您是否尝试过切换设置属性的顺序？就像先设置要切换到的样式表的 rel 属性，然后再设置要切换的样式表的 rel 属性？

将两个 rel 属性设置为 HTML 中的样式表，并在页面加载时使用 javascript 将其中一个更改为替代样式表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:40:06.300

为什么不按照这些思路做一些事情：

JavaScript

```
function changeStyle() {
    document.getElementById('stylesheet').href = 'style2.css';
} 
```

HTML

```
<input type="button" onclick="changeStyle();"/>
<link rel="stylesheet" href="style1.css" id="stylesheet"> 
```

或者为多个样式表尝试[这个](http://jsfiddle.net/jackdent/ZqtPs/)

对于切换试试这个：

```
function changeStyle() {
    var a = document.getElementById('stylesheet').href;
    if (a === 'style1.css') {
        document.getElementById('stylesheet').href = 'style2.css';
    } else {
        document.getElementById('stylesheet').href = 'style1.css';        
    }
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T16:44:35.117

如果您不需要维护两个单独的样式表，那么通过简单地将 应用`id`到`body`. 在我的演示中，为了简单起见，我使用了该`body`元素，但如果这不可能，您可以简单地将站点的内容包装在 a 中`div`并添加一个`id`到其中。然后，只需在 CSS 选择器前面加上相关内容`id`即可应用相关样式。

在我的演示中，我使用了以下 JavaScript：

```
var sel = document.getElementById('styles'),
    b = document.getElementsByTagName('body')[0];
sel.onchange = function() {
    b.id = this.value;
};​ 
```

和 CSS：

```
#styles1 h1 {
    margin-top: 1em;
    color: #f00;
    background-color: #000;
    text-align: center;
    font-size: 2em;
}

#styles1 div {
    width: 80%;
}

#styles2 h1 {
    margin-top: 1em;
    color: #000;
    background-color: #fff;
    text-align: right;
    font-size: 1.5em;
    font-style: italic;
}

#styles2 div {
    width: 50%;
    margin: 0 auto 1em auto;
}

/* the following is for the element holding the style-switcher select */
#styles1 #themes,
#styles2 #themes {
    width: auto;
    position: absolute;
    top: 0;
    left: 0;
    background-color: #fff;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2JPBZ/)。

使用上述内容，当样式更改时，您应该不会注意到任何闪烁，因为样式表已经加载。如果您的页面特别复杂，可能会出现可见的闪烁，但它*应该*比切换到新样式表时的闪烁要短得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T16:07:29.913

除非您的两个样式表具有非常相似的结构，否则无论如何您最终都会出现奇怪的闪烁/渲染：

更改顺序（您希望）：

*   表 1 - 已应用
*   表 2 - 已应用
*   表 1 - 已删除

这意味着在短时间内，您将同时应用两个样式表（如果它们都只是设置调色板并且都在相同的元素上，这不是问题，但如果更冗长/重要则将是一个问题）。

如果这是一个问题，您可能会考虑做一些事情来使样式表更改看起来很棒 - 例如在样式更改之前淡出页面/元素，更改样式，然后再淡入。

如果不担心，您应该可以使用 jacktheripper 提供的方法

# android - Eclipse中Android源码调试——定位服务

> ID：10154793
> 
> 赞同：1
> 
> 时间：2012-04-14T15:29:41.987
> 
> 标签：android, android-service, android-source

我正在尝试映射 android 中的函数调用流 - 当应用程序调用 API 时控制如何流动。我的第一个案例研究是定位服务。

调试时，控件永远不会到达 LocalationManagerService.java

*   My LocationDemo 应用调用 (LocationManager)requestLocationUpdates
*   它可以追溯到 LocationManager.java，后者又调用 ILocationManager（aidl 文件）中定义的 requestLocationUpdates
*   ILocationManager 在 LocationManagerService.java 中实现。
    但是 Eclipse 抱怨说`ILocationManager$Stub$Proxy.requestLocationUpdates(...) source not found`

是否可以链接 LocationManager <-> ILocationManager <-> LocationManagerService？
如果不是，我该如何调试 LocationManagerService 中的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T05:26:56.340

我的猜测是 LocationManagerService 是在 system_server 应用程序中运行的框架服务之一。要单步调试其代码，请查看[Debugging Android Framework services](http://apienthusiast.blogspot.com/2014/06/debugging-android-java-framework.html)。

# php - 页面加载时 JQuery 触发事件

> ID：10154795
> 
> 赞同：1
> 
> 时间：2012-04-14T15:29:52.833
> 
> 标签：php, jquery, html

我有一个下拉列表，我希望列表的第一个元素在页面加载时自动触发事件。

我的 jquery 当前代码：

```
<script type="text/javascript">
$(document).ready(function() {
    $(".size").change(function() {
        var searchbox = $(this).val();
        var myId = $(this).attr("id");
        var dataString = 'searchword=' + searchbox + '&product_id=' + myId;
        if (searchbox == '') {} else {
            $.ajax({
                type: "POST",
                url: "check_stock.php",
                data: dataString,
                cache: false,
                success: function(html) {
                    $("#display" + myId).html(html).show();
                }
            });
        }
        return false;
    });
});​
</script> 
```

html代码

```
<form id="form1" name="form1" method="post" action="cart.php">
    <label>Size:</label>
    <select name="size" class="size" id="'.$pid.'">

    <option value="XS">XS</option>
    <option value="S">S</option>
    <option value="M">M</option>
    <option value="L">L</option>
    <option value="XL">XL</option>
    <option value="XXL">XXL</option>
    <option value="3XL">3XL*</option>
    <option value="4XL">4XL*</option>
    <option value="5XL">5XL*</option>
    </select>
    <input type="hidden" name="pid" id="pid" class="pid" value="'.$pid.'" />
    <span id="display'.$pid.'"></span>
    </form> 
```

目前它仅在您从下拉列表中选择某些内容时触发。（任何帮助表示赞赏。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:31:36.077

添加侦听器后尝试添加此行：

```
$(".size").change(); 
```

这应该会在下拉列表中触发您的事件，就像有人选择了一个选项一样。

# apache - 每个目录的自定义 php.ini（用于测试站点）

> ID：10154796
> 
> 赞同：2
> 
> 时间：2012-04-14T15:29:54.980
> 
> 标签：apache, .htaccess, customization, php

我正在使用 PHP 5.39 mod_ssl/2.2.6 OpenSSL/0.9.8g 在 Windows 7 上运行 Apache 2.26。

PHP 工作正常，Apache 也一样。

但是，我想为我的测试站点尝试为每个目录创建自定义 php.ini 文件。

我可以 - 并且确实 - 使用 php_flag 但想尝试创建一个有效的自定义 php.ini 文件。我试图谷歌这个，但找不到任何相关的东西。

这是我当前用于 C:/www/vhosts/localhost/testsite1 的 .htaccess：

```
RewriteEngine on
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php

#RewriteCond %{REQUEST_fileNAME} !\.php -f
#RewriteRule .* index.php

AddType text/html .asp
AddHandler application/x-httpd-php .page

php_value include_path "./php:/php/" 
```

然而，我在 php 中的自定义 php.ini 中进行了更改，以关闭 [仅用于测试] 的短标签，但它没有选择它，而是显示了 php 代码。

对此的任何帮助表示赞赏；这将非常有用！

（请记住，这个 Apache 安装是一个开发/测试安装）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:56:45.887

如果您正在使用，`php_flag`那么您可能正在使用 mod_php5。不支持自定义 'php.ini' 文件。您需要使用 suPHP 或 equiv，因为`php.ini`仅在 PHP 启动时加载，这不是mod_php5 和 FCGI 的*每个请求*。

*但是*，由于您使用的是 PHP 5.3，因此您还可以使用[.user.ini 文件](http://www.php.net/manual/en/configuration.file.per-user.php)，这些文件是根据每个请求进行解析的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-18T16:45:59.503

很多时候，您可能会觉得需要为不同的站点（在同一台服务器上运行）进行不同的设置，如 php.ini 中指定的那样。因此，您开始使用 ini_set() 或 .htaccess 在您的 php 文件中进行更改以覆盖这些设置。在本指南中，我将告诉您如何通过为每个网站设置单独的 php.ini 文件来解决具有不同 php 设置的问题。

因此，假设我有一个网站，其文档根目录为 /var/www/html/example/，域为 www.example.com。出于测试目的，您可以在 /var/www/html/example/phpinfo.php 中创建一个小文件

```
<?php
phpinfo();
?> 
```

现在运行[http://example.com/phpinfo.php](http://example.com/phpinfo.php)它将显示当前的 php 设置。

现在将 php.ini 文件从 /etc/php.ini 文件复制到 /var/www/html/example。

[root]# cp /etc/php.ini /var/www/html/example #对于fedora用户

[chia]$ sudo cp /etc/php5/apache2/php.ini /var/www/example # 用于 Debian 和 Ubuntu

现在，我们只需要一个简单的技巧来告诉 apache 在哪里可以找到该网站的 php 设置。您需要在配置文件中进行这个小改动。

```
<VirtualHost 10.24.11.2:80>

ServerName example.com

ServerAlias www.example.com

PHPINIDir /var/www/html/example

</VirtualHost> 
```

PHPINIDir 应该是文件 php.ini 所在的目录。

在此之后重新启动apache

[root]# service httpd restart # 适用于基于 Fedora/Redhat/CenOS 的系统

[chia]$ sudo apache2 restart # 用于基于 Debian/Ubuntu 的系统

# android - 动态创建的 android TableLayout 中未显示内容

> ID：10154800
> 
> 赞同：2
> 
> 时间：2012-04-14T15:30:22.093
> 
> 标签：android, android-layout, tablelayout

我正在尝试制作一个 3 列`TableLayout`，但我什么也没看到。这是我的java代码：

```
 TableLayout tl = (TableLayout)findViewById(R.id.tableLayout1);
         TableRow tr = new TableRow(this);
         tr.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));

         TextView tv = new TextView(this);
         tv.setLayoutParams(new LayoutParams(
                   LayoutParams.FILL_PARENT,
                   LayoutParams.WRAP_CONTENT));
         tv.setText(data[0]);
         tr.addView(tv);

         TextView tv1 = new TextView(this);
         tv1.setLayoutParams(new LayoutParams(
                 LayoutParams.FILL_PARENT,
                 LayoutParams.WRAP_CONTENT));
         tv1.setText(data[1]);
         tr.addView(tv1);

         TextView tv2 = new TextView(this);
         tv2.setLayoutParams(new LayoutParams(
               LayoutParams.FILL_PARENT,
               LayoutParams.WRAP_CONTENT));
         tv2.setText(data[2]);
         tr.addView(tv2);

        /* Add row to TableLayout. */
        tl.addView(tr,new TableLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT)); 
```

这是我的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:orientation="vertical"
android:id="@+id/LinearLayout1" >

<TableLayout
    android:id="@+id/tableLayout1"
    android:layout_width="fill_parent"
    android:layout_height="350dp"
    android:layout_marginTop="10dp"
    >

</TableLayout>

<Button
    android:id="@+id/BorrarPedido"
    android:layout_width="204dp"
    android:layout_height="wrap_content"
    android:text="Borrar Pedido"
    android:layout_gravity="center" />

<Button
    android:id="@+id/EnviarPedido"
    android:layout_width="204dp"
    android:layout_height="wrap_content"
    android:text="Enviar Pedido"
    android:layout_gravity="center" />

   </LinearLayout> 
```

我没有收到任何错误消息，我什么也没有。问题是除了 2 之外`Buttons`，`TableLayout`我什么都看不到。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T19:46:34.503

您`TextView`的 s 是 a 的子级，因此您应该为 the`TableRow`设置一个实例，而不是您当前使用的简单实例（可能来自超类）：`TableRow.LayoutParams``LayoutParams``ViewGroup`

```
//...
        TextView tv = new TextView(this);
        tv.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));
        tv.setText("text 1");
        tr.addView(tv);

        TextView tv1 = new TextView(this);
        tv1.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));
        tv1.setText("text 2");
        tr.addView(tv1);

        TextView tv2 = new TextView(this);
        tv2.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
                TableRow.LayoutParams.WRAP_CONTENT));
        tv2.setText("text 3");
        tr.addView(tv2);
//... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T19:12:36.817

试试这样：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TableLayout
        android:id="@+id/tableLayout1"
        android:layout_width="fill_parent"
        android:layout_height="350dp"
        android:layout_marginTop="10dp" android:stretchColumns="*" >
    </TableLayout>

    <Button
        android:id="@+id/BorrarPedido"
        android:layout_width="204dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Borrar Pedido" />

    <Button
        android:id="@+id/EnviarPedido"
        android:layout_width="204dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Enviar Pedido" />
</LinearLayout>

    TableLayout tblLayout = (TableLayout)findViewById(R.id.tableLayout1);

    TableLayout.LayoutParams layoutParams = new TableLayout.LayoutParams(TableLayout.LayoutParams.WRAP_CONTENT, TableLayout.LayoutParams.WRAP_CONTENT);

    TableRow row = new TableRow(this);
    row.setBackgroundColor(Color.DKGRAY);
    tblLayout.addView(row, layoutParams);

    addToTableRow("Name", row, Color.WHITE);
    addToTableRow("Age", row, Color.WHITE);
    addToTableRow("Location", row, Color.WHITE);
  }

  private void addToTableRow(String str, TableRow row,int color) 
  {
    TextView t = new TextView(this);
    t.setTextColor(color);
    t.setText(str);
    row.addView(t);
  } 
```

# android - Android - 如何加入两个视频

> ID：10154805
> 
> 赞同：3
> 
> 时间：2012-04-14T15:30:59.830
> 
> 标签：android, video, join, append

基本上，我正在寻找一种将两个 mp4 视频文件（在 sd 卡上）组合在一起的方法。更像是在第一个视频的末尾附加第二个视频。我搜索了很多，但找不到合适的解决方案。（好吧，我根本找不到任何解决方案）。

所以我的问题是，是否有可用的库可以组合（并可能修剪）android 支持的视频？

我寻找的大多数 Java 库都依赖于平台，因为在这种情况下，前 Xuggler 并没有太大帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T12:09:59.520

您可以使用 mp4parser 库来[附加](https://code.google.com/p/mp4parser/wiki/AppendTracks)视频。问题是有限的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T10:24:10.007

使用 ffmpeg，它为用户提供了惊人的功能来压缩、拆分、合并和各种视频/音频编辑/压缩/转码等。1.1 版（ffmpeg 火花）以后的 concat demuxer 已添加到其中，这在我的 android 应用程序中运行良好。

[http://ffmpeg.org/trac/ffmpeg/wiki/How%20to%20concatenate%20(join,%20merge)%20media%20files](http://ffmpeg.org/trac/ffmpeg/wiki/How%20to%20concatenate%20(join,%20merge)%20media%20files)

# java - 摆动菜单项选择未在内容窗格中设置内容

> ID：10154812
> 
> 赞同：2
> 
> 时间：2012-04-14T15:31:36.023
> 
> 标签：java, swing, jframe, jlabel

我有一个 Swing JFrame，它有一堆菜单项。下面的代码尝试但未能在选择“添加地址”菜单项时设置 JFrame 的内容。

```
 JFrame frame = new JFrame();

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setResizable(false);
    frame.setVisible(true);

    JMenuBar menuBar = new JMenuBar();
    JMenu clientMenu = new JMenu("Client");
    JMenuItem address = new JMenuItem("Add Address");

    clientMenu.add(address);
    menuBar.add(clientMenu);

    address.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {
            setupAddressForm();
        }
    });

    private void setupAddressForm() {
        frame.getContentPane().removeAll();

        JPanel infoPanel = new JPanel();
        JLabel infoLabel = new JLabel();
        infoLabel.setText("<html><B>Please enter the address below</B></html>");
        infoPanel.add(infoLabel, SwingConstants.CENTER);
        frame.getContentPane().add(infoPanel, BorderLayout.NORTH);

        JPanel buttonPanel = new JPanel();
        JButton submitButton = new JButton("Submit Address");
        JButton resetButton = new JButton("Reset");

        submitButton.setToolTipText("Submit");
        resetButton.setToolTipText("Reset");

        buttonPanel.add(submitButton);
        buttonPanel.add(resetButton);

        frame.getContentPane().add(buttonPanel, BorderLayout.SOUTH);

        JPanel fieldPanel = new JPanel();
        fieldPanel.setLayout(new GridLayout(10, 10));

        JLabel houseNumberLabel = new JLabel("House Number",
                SwingConstants.LEFT);
        final JTextField houseNumberField = new JTextField(3);

        JLabel streetNameLabel = new JLabel("Street Name", SwingConstants.LEFT);
        final JTextField streetNameField = new JTextField(10);

        JLabel localityLabel = new JLabel("Locality", SwingConstants.LEFT);
        final JTextField localityField = new JTextField(10);

        JLabel cityLabel = new JLabel("City", SwingConstants.LEFT);
        final JTextField cityField = new JTextField(10);

        JLabel stateLabel = new JLabel("State", SwingConstants.LEFT);
        final JTextField stateField = new JTextField(10);

        JLabel zipCodeLabel = new JLabel("Zip Code", SwingConstants.LEFT);
        final JTextField zipCodeField = new JTextField(10);

        fieldPanel.add(houseNumberLabel);
        fieldPanel.add(houseNumberField);

        fieldPanel.add(streetNameLabel);
        fieldPanel.add(streetNameField);

        fieldPanel.add(localityLabel);
        fieldPanel.add(localityField);

        fieldPanel.add(cityLabel);
        fieldPanel.add(cityField);

        fieldPanel.add(stateLabel);
        fieldPanel.add(stateField);

        fieldPanel.add(zipCodeLabel);
        fieldPanel.add(zipCodeField);

        frame.getContentPane().add(fieldPanel, BorderLayout.CENTER);

        submitButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {

                String houseNumber = houseNumberField.getText();
                String street = streetNameField.getText();
                String locality = localityField.getText();
                String city = cityField.getText();
                String state = stateField.getText();
                String zipCode = zipCodeField.getText();

                Address address = new Address();

                if (!"".equals(houseNumber) && !"".equals(street)
                        && !"".equals(locality) && !"".equals(city)
                        && !"".equals(state) && !"".equals(zipCode)) {
                    address.setHouseNumber(houseNumber);
                    address.setStreetName(street);
                    address.setLocality(locality);
                    address.setState(state);
                    address.setZipCode(zipCode);
                }

            }
        });

        frame.getContentPane().doLayout();
        frame.getContentPane().update(frame.getGraphics());

} 
```

当我选择“添加地址”菜单项时，框架就变成了空白。不是我所期望的。我使用断点进行了调试，发现正在调用设置地址的方法。我不知道为什么它不起作用。如果我在这里做错了什么，有人可以指出吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:33:39.020

为什么要经历所有这些体操？取而代之的是简单地使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)来为您交换视图，而不会造成混乱或大惊小怪。

另请注意，您在方法或构造函数（您没有说）中在 (A) 行创建的 JFrame：

```
JFrame frame = new JFrame(); // (A) 
```

与 (B) 和 (C) 行中使用的 JFrame 不同：

```
 private void setupAddressForm() {
      frame.getContentPane().removeAll(); // (B)

      JPanel infoPanel = new JPanel();
      JLabel infoLabel = new JLabel();
      infoLabel.setText("<html><B>Please enter the address below</B></html>");
      infoPanel.add(infoLabel, SwingConstants.CENTER);
      frame.getContentPane().add(infoPanel, BorderLayout.NORTH); // (C) 
```

这是因为您在 (A) 行声明了 JFrame，因此它仅在该方法或构造函数中可见。

**编辑 1**
另外，这是不对的：

```
 frame.getContentPane().doLayout();
  frame.getContentPane().update(frame.getGraphics()); 
```

因为这不是让新组件显示在 Swing 容器中的方式。相反，我会这样做：

```
 JPanel contentPane = (JPanel) frame.getContentPane();
  contentPane.revalidate();
  contentPane.repaint(); 
```

但同样，我真的什么都不做，而是使用上面提到的 CardLayout。

最后，如果这些建议中的任何一个没有意义，请要求澄清。

# ios - 从 iOS 库导入时出现显着的图像质量损失

> ID：10154814
> 
> 赞同：9
> 
> 时间：2012-04-14T15:31:37.943
> 
> 标签：ios, xcode

我正在使用 iPad 照片库（相机胶卷）导入一些图像，并将它们放在我使用 alloc 方法创建的 UIImageView 中。但是当显示图像时，图像质量损失很大。例如，在库中，有一张河流的图像非常清晰，逐个像素，但是当我导入它时，它至少丢失了一半的像素。这是导入图像的代码：

```
- (IBAction) useCameraRoll: (id)sender
{
    @autoreleasepool {

if ([self.popoverController isPopoverVisible]) {
    [self.popoverController dismissPopoverAnimated:YES];

} else{

    }{
    if ([UIImagePickerController isSourceTypeAvailable:
         UIImagePickerControllerSourceTypeSavedPhotosAlbum])
    {
        @autoreleasepool {

        UIImagePickerController *imagePicker =
        [[UIImagePickerController alloc] init];

        imagePicker.delegate = self;
        imagePicker.sourceType =
        UIImagePickerControllerSourceTypePhotoLibrary;
        imagePicker.mediaTypes = [NSArray arrayWithObjects:
                                  (NSString *) kUTTypeImage,
                                  nil];

        imagePicker.allowsEditing = YES;

        self.popoverController = [[UIPopoverController alloc]
                                  initWithContentViewController:imagePicker];
        }
        popoverController.delegate = self;

        [self.popoverController 
         presentPopoverFromBarButtonItem:sender
         permittedArrowDirections:UIPopoverArrowDirectionUp
         animated:YES];

        newMedia = NO;

    }}
}
}

-(void)imagePickerController:(UIImagePickerController *)picker
didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    [self.popoverController dismissPopoverAnimated:true];
@autoreleasepool {

NSString *mediaType = [info
                       objectForKey:UIImagePickerControllerMediaType];

if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) {
    UIImage *image = [info
                      objectForKey:UIImagePickerControllerEditedImage];

    image1.image = image;
    if (newMedia)
        UIImageWriteToSavedPhotosAlbum(image,
                                       self,  
                                           @selector(image:finishedSavingWithError:contextInfo:),
                                       nil);
}
else if ([mediaType isEqualToString:(NSString *)kUTTypeMovie])
{
    // Code here to support video if enabled
}}
}

-(void)image:(UIImage *)image
finishedSavingWithError:(NSError *)error
 contextInfo:(void *)contextInfo
{
if (error) {
    UIAlertView *alert = [[UIAlertView alloc]
                          initWithTitle: @"Save failed"
                          message: @"Failed to save image"\
                          delegate: nil
                          cancelButtonTitle:@"OK"
                          otherButtonTitles:nil];
    [alert show];
}
}

-(void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
{

} 
```

以及质量差异（图像放大），但即使在小范围内您也可以清楚地看到差异：

iOS 库：

![在此处输入图像描述](../Images/e16b124f4c31d6a7c9fa61a097c4f83d.png)

我的 UIImageView：

![在此处输入图像描述](../Images/d5fb5dd59a944c1f0c593614ecae2ca3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T14:31:12.323

也许你应该使用

```
UIImage *img = [info valueForKey:@"UIImagePickerControllerOriginalImage"]; 
```

获取原始图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:55:36.183

在开发通用应用程序时，我注意到了类似的问题。在 iPod touch 上使用 allowEditing=YES 从相册中挑选图像效果很好，没有质量损失，但在 iPad 上 UIImagePickerControllerEditedImage 仅 320 像素宽，导致质量损失，我认为因为用于编辑的弹出框仅320像素宽！

经过大量搜索后，我遇到了[这段代码](http://cmgresearch.blogspot.co.il/2012/07/cropping-results-from.html)，可以使用字典中的用户裁剪设置再次裁剪原始图像，但我不禁觉得在 iPad 上必须有更好的方法来处理这个问题

# php - 我可以使用照片 url 在 photo_src 表中搜索 photo_id 吗？

> ID：10154818
> 
> 赞同：0
> 
> 时间：2012-04-14T15:31:55.963
> 
> 标签：php, facebook-fql, photo

我正在尝试使用 FQL 来获取个人资料图片的照片 ID。这可以使用新的 photo_src 表吗？

它返回以下错误：“url 不是 photo_src 表的成员”

[即使在（ https://developers.facebook.com/docs/reference/fql/photo_src/](https://developers.facebook.com/docs/reference/fql/photo_src/) ）的文档中可以看到，URL 是成员

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:11:28.970

[在本页](https://developers.facebook.com/docs/reference/fql/photo_src/)参考 facebook 开发者文档

根据以下

![在此处输入图像描述](../Images/0107c08acdfa07a96d03c050a1b9f704.png)

只有标记为的列`indexable`可用于查询表（photo_src）而不是其他列。

也可以参考例子，只有可索引的列可以用来查询表

> 从 photo_src 中选择 src、宽度、高度，其中 photo_id = 10150931418786729

**编辑：**

**技巧：** 这是我使用的技巧，类似于 Tom Waddington 先生在下面的答案中解释的技巧，但有一个小的变化。

**网址：** [https ://fbcdn-sphotos-a.akamaihd.net/hphotos-ak-snc7/s720x720/423961_3099973533075_1076266190_3040344_2138806733_n.jpg](https://fbcdn-sphotos-a.akamaihd.net/hphotos-ak-snc7/s720x720/423961_3099973533075_1076266190_3040344_2138806733_n.jpg)

`1076266190`- 用户 ID (UID)

`3099973533075`- 照片身份证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T02:03:56.727

我认为所有照片网址都包含照片的 Facebook UID。

示例： [http ://a4.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s720x720/562281_10150798057523523_511353522_11470130_1470687243_n.jpg](http://a4.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s720x720/562281_10150798057523523_511353522_11470130_1470687243_n.jpg)

UID 为 10150798057523523。

因此，您可以解析您拥有的 URL 并找到照片 UID。

# type-conversion - 如何在 Mozart OZ 中将记录转换为字符串

> ID：10154822
> 
> 赞同：0
> 
> 时间：2012-04-14T15:32:18.630
> 
> 标签：type-conversion, oz, mozart

例如：

```
local A = aircraft(id:'Avro' size:[2 36] state:state(time:20 status:parked))           
in
  {Browse A}
end 
```

我想将 A 转换为类似浏览窗口的字符串，以便通过管道（序列化）将数据发送到其他程序。

是否存在任何莫扎特原生功能或任何捷径？谢谢你的想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T22:43:22.417

看看库函数`Value.toVirtualString`（[docs](http://www.mozart-oz.org/documentation/base/node3.html)）。如果您不想限制输出`DepthI`，您只需选择一些大整数值。`WidthI`

要确保结果是字符串（不是虚拟字符串），请使用`VirtualString.toString`.

# c# - Contoso mvc3系统，多对多关系

> ID：10154824
> 
> 赞同：1
> 
> 时间：2012-04-14T15:32:24.977
> 
> 标签：c#, .net, asp.net-mvc-3, entity-framework

我一直在关注位于[此处的 Microsoft Contoso MVC3 大学教程](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)

我有一个关于一个领域的问题，在第 6 部分；本教程解释了如何使用复选框创建可以分配给讲师的课程表。特别是从标题“将课程作业添加到讲师编辑页面”开始

似乎过于复杂，有没有更有效的做事方式？插件/内置系统等。如果您想扩展系统以使讲师拥有的不仅仅是分配给他的课程怎么办？代码的重复将是巨大的。

教练控制器

```
 // GET: /Instructor/Edit/5
    public ActionResult Edit(int id)
    {
        Instructor instructor = db.Instructors
            .Include(i => i.OfficeAssignment)
            .Include(i => i.Courses)
            .Where(i => i.InstructorID == id)
            .Single();
        PopulateAssignedCourseData(instructor);
        return View(instructor);

    }

    private void UpdateInstructorCourses(string[] selectedCourses, Instructor instructorToUpdate)
    {
        if (selectedCourses == null)
        {
            instructorToUpdate.Courses = new List<Course>();
            return;
        }

        var selectedCoursesHS = new HashSet<string>(selectedCourses);
        var instructorCourses = new HashSet<int>
            (instructorToUpdate.Courses.Select(c => c.CourseID));
        foreach (var course in db.Courses)
        {
            if (selectedCoursesHS.Contains(course.CourseID.ToString()))
            {
                if (!instructorCourses.Contains(course.CourseID))
                {
                    instructorToUpdate.Courses.Add(course);
                }
            }
            else
            {
                if (instructorCourses.Contains(course.CourseID))
                {
                    instructorToUpdate.Courses.Remove(course);
                }
            }
        }
    }

    private void PopulateAssignedCourseData(Instructor instructor)
    {
        var allCourses = db.Courses;
        var instructorCourses = new HashSet<int>(instructor.Courses.Select(c => c.CourseID));
        var viewModel = new List<AssignedCourseData>();
        foreach (var course in allCourses)
        {
            viewModel.Add(new AssignedCourseData
            {
                CourseID = course.CourseID,
                Title = course.Title,
                Assigned = instructorCourses.Contains(course.CourseID)
            });
        }
        ViewBag.Courses = viewModel;
    } 
```

编辑.cshtml

```
 int cnt = 0;
    List<UniversitySystem.ViewModels.AssignedCourseData> courses = ViewBag.Courses;

    foreach (var course in courses)
    {
        if (cnt++ % 3 == 0)
        {
                        @:  </tr> <tr> 
                    }
                    @: <td> 
                        <input type="checkbox" 
                               name="selectedCourses" 
                               value="@course.CourseID" 
                               @(Html.Raw(course.Assigned ? "checked=\"checked\"" : "")) /> 
                        @course.CourseID @:  @course.Title
                    @:</td>
                }
                @: </tr>
            }
    </table>
</div>
        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
} 
```

ViewModels/AssignedCourseData.cs

```
 public class AssignedCourseData
    {
        public int CourseID { get; set; }
        public string Title { get; set; }
        public bool Assigned { get; set; }
    }
} 
```

大量代码可以有效地创建这个屏幕： ![屏幕](../Images/eba42d299ed1b62e961e2dc0fdc21127.png)

我想您可以概括 InstructorController 中使用的辅助方法，但这不是一项小任务。

处理一对多关系似乎是 CRUD 系统的基本组成部分；我很惊讶我找不到有关该主题的信息。

TLDR：有没有比上面显示的更好的方法来使用 MVC3/Entity 框架将对象关联到其他对象。

编辑 2：这是一个快速 Lightswitch 应用程序的图像 ![在此处输入图像描述](../Images/c83c51a0c52c994cd7cfa9e2bb4c0e7f.png) 候选人可以拥有许多与其相关的技能、残疾和罪行。如果我要实现这个系统的 MVC 版本，我会 x3 上面列出的代码来创建相同的效果。

当然有更有效的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:42:56.903

根据您的评论，您似乎正在寻找 MVC 作为 Lightswitch。如果是这样的话，微软就不会开发 Lightswitch。

Microsoft 提供了许多技术，MVC、Web Pages (WebMatrix)、WebForms、LightSwitch。每个都有自己独特的优势和劣势，您可以选择最适合您要求的技术。

如果您使用 MVC 进行开发，则需要花费更多的精力来编写演示代码。但是，这种额外的努力使您在演示文稿的工作方式、外观和行为方式方面具有出色的灵活性。如果您不想这样做，那么我建议您选择其他技术。

# c++ - 循环依赖问题

> ID：10154834
> 
> 赞同：1
> 
> 时间：2012-04-14T15:34:16.520
> 
> 标签：c++, visual-studio-2010, visual-c++

我在三个头文件之间有一个三向循环依赖关系，每个头文件中都有一个类。这是`Agent2`课程的相关部分：

```
#ifndef BUYINGJEANS1_H
#define BUYINGJEANS1_H
class Agent2{
    public:
    Agent2(){}

    double getAdvertisingFash(int currentTime, int sFash, int brand){
        Agent1 agent1;
        Agent3 agent3;
        double probabilityOfChangingFashion = (exp((-advertisementArray[currentTime+1][brand]*pow(abs(min(fashionArray[brand]+1,4.0)-sFash),D))+(-alphaArray[2][2]*pow(abs(fashionArray[brand]-sFash),AArray[2][2]))) * (exp((-(agent1.alphaArray[2][1])*pow(abs((agent1.fashionArray[brand])-sFash),AArray[2][1]))))*(exp((-(agent3.alphaArray[2][3])*pow(abs((agent3.fashionArray[brand])-sFash),AArray[2][3])))))/getZScoreAdvertisingFash(currentTime,brand);
        return probabilityOfChangingFashion;
    }
#endif 
```

`Agent1`和类中存在等效函数`Agent3`，除了`Agent1`会使用`Agent2`and`Agent3`和`Agent3`会使用`Agent1`and `Agent2`。

我知道前向声明在这里不起作用，因为我显然需要使用类的成员`Agent2`和`Agent3`. 当我在使用此代码的单独 cpp 文件中运行 main 函数时，我收到一个未声明的标识符错误 for `Agent1`and `Agent3`。

任何人都知道我可以如何以最简单的方式解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:37:47.253

将成员函数定义移动到单独的 .cpp 文件中，并在其中包含标头。

像这样的东西：

```
#include "agent2.hpp"

double Agent2::getAdvertisingFash(int currentTime, int sFash, int brand){
    Agent1 agent1;
    Agent3 agent3;
    double probabilityOfChangingFashion = (exp((-advertisementArray[currentTime+1][brand]*pow(abs(min(fashionArray[brand]+1,4.0)-sFash),D))+(-alphaArray[2][2]*pow(abs(fashionArray[brand]-sFash),AArray[2][2]))) * (exp((-(agent1.alphaArray[2][1])*pow(abs((agent1.fashionArray[brand])-sFash),AArray[2][1]))))*(exp((-(agent3.alphaArray[2][3])*pow(abs((agent3.fashionArray[brand])-sFash),AArray[2][3])))))/getZScoreAdvertisingFash(currentTime,brand);
    return probabilityOfChangingFashion;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:38:15.480

您需要将一个或多个函数的主体移动到`.cpp`文件而不是标题中。这样，`Agent1`可以`Agent3`包含`Agent2`标题而不需要`Agent2`标题。

您只需要移动其中一个类的函数的实现即可打破循环依赖关系，但您可能希望这样做以使所有三个类保持一致并避免将来出现类似问题。

在代理 2.H 中：

```
#ifndef BUYINGJEANS1_H
#define BUYINGJEANS1_H
class Agent2{
    public:
    Agent2(){}

    double getAdvertisingFash(int currentTime, int sFash, int brand);
}
#endif 
```

在 Agent2.cpp 中：

```
#include "Agent2.H"

#include "Agent1.H"
#include "Agent3.H"
double Agent2::getAdvertisingFash(int currentTime, int sFash, int brand)
{
    Agent1 agent1;
    Agent3 agent3;
    double probabilityOfChangingFashion = (exp((-advertisementArray[currentTime+1][brand]*pow(abs(min(fashionArray[brand]+1,4.0)-sFash),D))+(-alphaArray[2][2]*pow(abs(fashionArray[brand]-sFash),AArray[2][2]))) * (exp((-(agent1.alphaArray[2][1])*pow(abs((agent1.fashionArray[brand])-sFash),AArray[2][1]))))*(exp((-(agent3.alphaArray[2][3])*pow(abs((agent3.fashionArray[brand])-sFash),AArray[2][3])))))/getZScoreAdvertisingFash(currentTime,brand);
    return probabilityOfChangingFashion;
} 
```

# php - iPhone- 在 POST 中将 JSON 对象发送到 PHP 服务器并从服务器获取响应

> ID：10154837
> 
> 赞同：0
> 
> 时间：2012-04-14T15:34:36.397
> 
> 标签：php, iphone, mysql, json, web-services

我试图从我的 iphone 将 JSON 对象发送到 php 服务器

服务器将对其进行解码并执行一些功能，然后使用 JSON 重播回 iphone。

我已经设置了服务器，但我不确定我需要使用什么方法来连接到 php 服务器（使用 POST 方法）以及 iphone 将如何从服务器获取响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:57:55.243

这是您的代码享受

NSString *urlString = @"你的网址";

```
NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

NSMutableData *body = [NSMutableData data];

NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithString:@"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

// Text parameter1
// NSString *param1 = @"parameter text";
[body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"name\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:param1] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

// Another text parameter
// NSString *param2 = @"Parameter 2 text";
[body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"desc\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:param2] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

// close form
[body appendData:[[NSString stringWithFormat:@"--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
// set request body
[request setHTTPBody:body]; 
```

像上面的代码一样，你可以使用 HTTP post 方法发送多个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:44:00.570

看看这个 POSTing 数据： [iPhone 用 NSURLConnection 发送 POST](https://stackoverflow.com/questions/2071788/iphone-sending-post-with-nsurlconnection)

如何在 Cocoa 中拥有 JSON 对象？您必须以某种方式将您拥有的任何数据转换为 JSON，将其发送到服务器，然后**[解析](https://stackoverflow.com/a/7530402/796103)**答案。

# algorithm - 如何找到修改后的黑白棋/黑白棋游戏的获胜者？

> ID：10154840
> 
> 赞同：2
> 
> 时间：2012-04-14T15:35:05.047
> 
> 标签：algorithm

我在另一个网站上遇到了这个面试问题。

在奥赛罗游戏中，红色或黑色圆盘按照一定的规则放置在 8x8 格子上。玩家选择他们的颜色，并且在网格上拥有最大数量的磁盘的玩家获胜。

给定两个二维数组（一个代表红色，另一个代表黑色）表示磁盘的存在/不存在，以及以下规则：

*   对于长度为 n > 3 的序列，分配 (n-2) 作为该玩家的分数
*   序列可以是垂直的、水平的或对角的
*   一个磁盘不能属于多个序列

例如，对于下面的二维数组，点将是对角元素（包括 [0,0]）和第一行中的元素（不包括 [0,0]）的最大值，或者是对角元素（不包括 [0 ,0]）和水平元素（包括[0,0]）。即最大(4+0, 3+2) = 5

1 1 1 1 0 0
0 1 0 0 0 0
0 0 1 0 0 0
0 0 0 1 0 0
0 0 0 0 1 0
0 0 0 0 0 1

以最高分确定获胜者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T00:17:06.210

我有一个建议，即使您可能会找到一个更简单的建议。

要计算玩家的分数，请分配一个 8X8 2D 结构数组，其中包含以下字段：垂直、水平、对角线 1、对角线 2。

在算法执行结束时，这四个字段将保存序列“到目前为止”的大小 - 例如，如果在该单元格中有一个圆盘，则单元格 (x,y) 的“垂直”字段为 1，并且在 (x,y-1) 处没有圆盘，如果在 (x,y) 和 (x,y-1) 处有圆盘但在 (x,y-2) 处没有圆盘等则为 2。关于 3 相同其他领域。您还需要一个 score 变量来汇总所获得的分数。

现在您应该从 (0,0) 单元格 [(0,0),(0,1)....(0,7),(1,0) 开始，按升序逐行遍历这个数组...]，并填充结构。在每个单元格中，您首先检查原始二维阵列的等效单元格处是否有圆盘。如果没有圆盘，则应保留分数，并将当前单元格结构的所有字段设置为0。如果有圆盘（假设当前单元格为（x，y）），则应分配如下：

```
(x,y)->vertical = (x,y-1)->vertical,
(x,y)->horizontal = (x-1,y)->horizontal,
(x,y)->diagonal1 = (x-1,y-1)->diagonal1,
(x,y)->diagonal2 = (x+1,y-1)->diagonal2. 
```

请注意，在每个点上，您需要的所有值都已计算完毕。如果超出范围（x-1 < 0 等），则值为 0。您还应该为您分配 4 的每个字段增加 2 或为您分配 5 或更多的每个字段增加 1（这将给每个长度 n > 3 的序列 n-2 个点）。

就这样。在遍历所有二维数组后，得分计数器将保存玩家的得分。

复杂度是O(n^2)，一点也不差（实际上在复杂度方面你找不到更好的解决方案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T02:47:21.793

要了解规则，请尝试此链接[www.springfrog.com/games/othello/othello.htm](http://www.springfrog.com/games/othello/othello.htm)

使用的数据结构：

板：int[8][8]；

uncounted_red：2，uncounted_black：-2，空：0；

counted_red：1，counted_black：-1

score_red：int， score_black：int；

* * *

算法：

1.  查找长度 > 3 的连续红色序列

2.  对于找到的每个序列，添加分数长度 - 2

3.  通过在序列中遇到的已经计数的钉子进一步降低分数。

4.  计算完分数后，所有未计数的钉子都已计数。

5.  对黑色重复该过程。

6.  获胜者 = score_red > score_black ？红黑。

* * *

现在问题归结为如何执行第 1 步。

# asp.net - 在 linq-to-sql 中更改表名和列名

> ID：10154842
> 
> 赞同：0
> 
> 时间：2012-04-14T15:35:24.227
> 
> 标签：asp.net, sql-server, linq-to-sql

我正在使用 linq-to-sql 从我的数据库中获取数据。我想更改表的名称并更改 2 列的名称。我知道该怎么做，但问题是我已经针对该表编写了几个查询，如果我更改数据库，查询也需要更改。

有没有办法在不必重做查询和数据上下文的情况下对数据库进行更改？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:30:06.953

至少您需要更新实体和数据库之间的映射（表名、列名）。您的所有查询仍然是相同的。

更新将来自 Visual Studio ORM Designer（*如果您正在使用*）

[或者]

在 Datacontext 中具有属性。

`[Table(Name="UpdatedName")]`和`[Column(Name="UpdatedName")]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:59:32.297

您也可以调用`Stored-Proc`from `LinQ`。在您的存储过程中编写查询以更改`Schema`并最终`Proc`从`LINQ`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T17:12:48.187

如果它是只读查询，您还可以使用旧名称向数据库添加视图。

但是，如果只是几个查询，Visual Studio 会很快告诉您在哪里进行适当的更改（毕竟 Linqs2sql 是强类型的）。我建议您只更改所有查询和数据上下文，因为从长远来看，它会更清楚发生了什么。

# javascript - 如何检测直播是否正在发送任何数据

> ID：10154844
> 
> 赞同：1
> 
> 时间：2012-04-14T15:35:33.120
> 
> 标签：javascript, video-streaming

有没有办法检测直播服务器是否正在发送数据。我有一个网页，其中包含来自使用这些协议的不同来源的视频。

部分视频来自 ustream。

```
<embed flashvars="autoplay=false&amp;brand=embed&amp;cid=7975&amp;v3=1" width="100%" height="377" allowfullscreen="true" allowscriptaccess="always" id="utv344723" name="utv_n_193353" src="http://www.ustream.tv/flash/viewer.swf" type="application/x-shockwave-flash" /> 
```

其他是我加载到 jwplayer 中的 flash 视频流。

```
 <embed
 type='application/x-shockwave-flash'
 id='single2'
 name='single2'     flashvars='file=USen_vbr_450@50104&streamer=rtmp://cp132684.live.edgefcs.net/live/&autostart=true&plugins=false'
 /> 
```

其他是 Flash 视频流，我必须在其中加载自己的播放器。

```
 <embed
 type='application/x-shockwave-flash'
 id='single2'
 name='single2'
 src='http://videosite.org/video/jwplayer/player.swf'     flashvars='file=sltviphone.sdp&streamer=rtmpt://saltandlighttv.streamguys.net:80/live&skin=http://saltandlighttv.org/video/jwplayer/skins/modieus/modieus.swf&autostart=true'
 /> 
```

其他人有不同的流媒体协议。

```
 <embed id="MediaPlayer2" src="mms://www.streaming.com/video_a" width="100%" height="377" autostart="true" align="top" border="0" filename="mms://www.streaming.com/video" animationatstart="true" transparentatstart="true" showcontrols="1"></embed> 
```

有没有办法在不打开播放器的情况下检测视频是否正在流式传输？我会在 javascript 中执行此操作。

# f# - 如何使用 F# 中的类型提供程序连接到 SQL Server Compact Edition 4.0？

> ID：10154849
> 
> 赞同：6
> 
> 时间：2012-04-14T15:36:14.477
> 
> 标签：f#, sql-server-ce, type-providers

我正在尝试从 F# 连接到 SQL Server Compact Edition 数据库，并尝试使用类型提供程序。这是在 Visual Studio 11 Beta 中，所以我意识到可能因此存在问题，但我认为更有可能是我还没有专业知识。

但是，我注意到 Microsoft.FSharp.Data.TypeProviders 中没有特定于 CE 的类型提供程序，而且我不确定常规的 SqlDataConnection 是否可以解决问题，所以这可能就是问题所在。

但是，当我尝试创建连接时，IDE 似乎至少可以识别出我正在尝试访问 CE 数据库。

所以，我有以下代码：

```
type SqlConnection = 
  Microsoft.FSharp.Data.TypeProviders
    .SqlDataConnection<ConnectionString = @"Data Source=C:\\Path\\Database.sdf">
let db = SqlConnection.GetDataContext() 
```

所以它是相当标准的，或多或少直接来自使用类型提供程序项菜单添加新的 LINQ to SQL。

我通过连接字符串获得的工具提示是“未安装提供程序'System.Data.SqlServerCe.3.5'。” 看起来似乎表明没有安装 Sql Server CE 是一个问题，但是我有库，能够使用常规 SqlCEConnection 连接到数据库并运行 SqlCeCommands 等。由于它是 4.0 而不是 3.5，我不确定它是否在寻找错误的提供者。我在 VS 11 beta 中创建了数据库，所以我认为所有版本都应该匹配等等。

所以简而言之，我想知道我是否做错了什么，或者 VS11 beta 类型提供程序库是否还不支持 CE 4.0，或者我需要做些什么来实现它。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T09:42:33.640

这个“在我的机器上工作”（使用 VS 11 beta，实体框架，基于此处的演练， http: [//msdn.microsoft.com/en-us/library/hh361038](http://msdn.microsoft.com/en-us/library/hh361038(v=vs.110).aspx) (v=vs.110).aspx ：

```
open System.Data.Linq
open System.Data.EntityClient
open Microsoft.FSharp.Data.TypeProviders

let connectionString = "metadata=res://*/;provider=System.Data.SqlServerCe.4.0;provider connection string='data source=C:\\Data\\SQLCE\\Test\\nw40.sdf';"

type internal edmx = EdmxFile<"NWModel.edmx", ResolutionFolder = @"C:\Users\erik.COMMENTOR\Documents\Visual Studio 11\Projects\TestSqlCeFSharp">

let internal context = new edmx.nw40Model.nw40Entities(connectionString)

query { for supplier in context.Suppliers do
        select supplier }
|> Seq.iter (fun supplier -> printfn "%s" supplier.Company_Name) 
```

添加了对以下内容的引用：FSharp.Data.TypeProviders、System.Data.Entity、System.Data.Linq

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T16:09:40.527

```
Supported info of 'System.Data.SqlServerCe.4.0' in  Microsoft.FSharp.Data.TypeProviders
1.SqlDataConnection is not
2.DbmlFile is partial
    type dbml = DbmlFile<_>
    use cn = new SqlCeConnection(...)
    use db = new dbml.DbContext(cn)
3.EdmxFile is full
4.SqlEntityConnection is full 
```

# tfs - 如何查询具有太多变更集的工作项

> ID：10154852
> 
> 赞同：6
> 
> 时间：2012-04-14T15:36:37.003
> 
> 标签：tfs, changeset, workitem

这些工作项（和链接的变更集）通常容易出错。所以，优秀的人选进行团队代码审查，应该多加注意。

我已经检查了 Link Query 的[Work Item Query Language 和 Client Object Model](http://msdn.microsoft.com/en-us/library/bb130306.aspx)和[WIQL 语法](http://blogs.msdn.com/b/team_foundation/archive/2010/07/02/wiql-syntax-for-link-query.aspx)，但仍然无法有效地获取这些工作项（带有变更集的数量）。

有没有这样查询的方法（应该是WIQL，这里的SQL语法仅供演示）？

```
SELECT [Source].[System.Id], COUNT(1) AS Changesets FROM WorkItemLinks
WHERE [Source].[System.WorkItemType] = 'Bug'
    AND [System.Links.LinkType] = 'Changeset'
GROUP BY [Source].[System.Id]
HAVING Changesets > 5 
```

或者是否有一种使用 API 的有效方法，不需要读取每个工作项来获取计数？

还是只能通过直接在数据库上执行 SQL 查询来实现（[像这样](http://social.msdn.microsoft.com/Forums/en/tfsreporting/thread/f642f51b-e030-40c9-8c9b-8ecabe0c9787)）？

或者我们可以将默认情况下（来自 VS IDE 或 API）支持的CurrentRelatedLinkCount/ [ExternalLinkCount](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.workitem.externallinkcount.aspx) / [HyperLinkCount](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.workitem.hyperlinkcount.aspx) / [RelatedLinkCount作为查询字段吗？](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.workitem.relatedlinkcount.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-04T12:30:07.063

您可以将 ExternalLinkCount 用于变更集链接。 ![在此处输入图像描述](../Images/641064cf1273d78d47ea1603f678b94a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-15T17:46:31.397

如果您安装了 SQL Server Analysis Services，则可以查询关系。以下是如何在 Excel 中执行此操作：

1.  连接到 Excel 中的 Tfs_Analysis 多维数据集（数据 --> 其他来源 --> 分析服务）
2.  选择工作项变更集字段，
3.  查找版本控制变更集维度，然后选择变更集 ID
4.  查找工作项维度并选择 ID

这将允许您查询工作项和变更集之间的关系。如果您将一个显示为 Row 字段，另一个显示为 Column 字段，然后获取每一行的小计，这将为您提供每个工作项的变更集计数（以及每个变更集的工作项计数）。

但是请注意，在 TFS 中的一个非常大的项目上运行此查询可能会非常昂贵，因此您应该为小范围的变更集和小范围的工作项执行此操作。为此，请注意，要过滤变更集的日期，您需要使用 Date 维度，而要过滤工作项的日期，您需要使用工作项字段之一（创建日期、更改日期等）

您可能可以修改 OLAP 多维数据集，通过从仓库更改其 ETL 流程，为您将这些信息放入事实表中，在这种情况下，您将能够查询变更集计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-28T03:59:22.703

报告会这样做 - 报告生成器支持 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T16:43:17.373

没有你的表模式是很困难的。但我猜你正在尝试这样做：

```
SELECT [Source].[System.Id], COUNT(1) AS Changesets FROM WorkItemLinks
WHERE [Source].[System.WorkItemType] = 'Bug'
    AND [System.Links.LinkType] = 'Changeset'
GROUP BY [Source].[System.Id]
HAVING COUNT(1) > 5 
```

我对吗？

# ruby-on-rails-3 - 带有设计和访问请求和会话的 Rails 单元

> ID：10154853
> 
> 赞同：0
> 
> 时间：2012-04-14T15:36:55.693
> 
> 标签：ruby-on-rails-3, rails-cells

使用 Cells 和 Devise，当尝试访问 Devise :current_#{mapping} （如 current_user）时，我收到未定义错误的请求：

ActionView::Template::Error（未定义的局部变量或方法“请求”#）

我已经包含了 Devise Helpers 方法，但是它们访问了 Cell::Base 中不存在的 Web 上下文请求。我的 Cell 控制器看起来像这样：

```
class ActivityCell < Cell::Base
  include Devise::Controllers::Helpers
  helper_method :current_user

  def display
    puts current_user.id # <-- Error starts here
    ...
  end
end 
```

我正在使用 RubyMine，当我调试情况时，在非 Cells 普通控制器中，self 有请求。在 Cells::Base Controller 中，请求不在身边。

[我在这里](http://snippets.aktagon.com/snippets/502-Rails-Cells-Example)找到了这个片段，它应该显示如何从单元控制器访问请求和其他重要位，但有点不清楚如何简单地让设计在单元控制器中按预期工作。例如 Cells::Base 发出请求以及 Devise 需要的任何其他内容

我认为我的 Cells 版本可能有问题，但我使用的是 3.8.3。（最新）我认为这是因为我也没有可用的“会话”，如第 4 项“控制器应该苗条”下[所示。](http://nicksda.apotomo.de/2010/10/10-points-how-cells-improves-your-rails-architecture/)我无法从 Cell::Base 控制器访问会话。我不知道这是否只能在以前的 Ruby 2.x 中实现，而现在在 3.x 中是不可能的。（文章没有提到版本，但我看到评论是在 2010 年底发布的）

```
class CartCell < Cell::Base
  def display
    @user = session[:user]

    render
end 
```

除了这个问题，我超级挖掘细胞。我将它用于孤立的小部件，这些小部件使用 jQuery AJAX 从它们中提取 JSON 以用于绘图目的。

任何帮助，将不胜感激。我需要知道当前登录的 Devise 用户的详细信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T21:12:29.787

正如您已经指出的那样；-) 只需从 Cell::Rails 派生单元格，一切都会正常工作。

# php - php 在打印引用值时添加反斜杠，但我不希望它这样做

> ID：10154855
> 
> 赞同：0
> 
> 时间：2012-04-14T15:36:58.907
> 
> 标签：php, mysql, magic-quotes

在我的数据库中，有一个类似的值：

```
i haven't done it yet. 
```

ps：在数据库中这里的值是完全一样的，没有反斜杠。

当我打印它时，php 在 ' 单引号之前添加反斜杠。
`get_magic_quotes_gpc`已关闭。我不明白为什么要加上反斜杠。

这是我打印值的 php 代码：

```
$_SESSION['foo'] = $_POST['foo'];
echo $_SESSION['foo']; 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-14T15:40:58.263

尝试这个

```
echo stripslashes($value)); 
```

# ios - ios远程通知未标记为已读

> ID：10154856
> 
> 赞同：3
> 
> 时间：2012-04-14T15:37:07.103
> 
> 标签：ios, ios5, push-notification, apple-push-notifications

好的，所以我编写了一个小应用程序来接收我处理的远程通知，`didReceiveRemoteNotification`并且我还检查了传递给`didFinishLaunch`.

但是，通知在 iOS 5 的通知中心中仍被列为“未读”（它们的左侧有一个小蓝点）。我怎样才能使它在用户单击通知后消失或标记为已读？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T20:39:36.607

我认为 iOS 5.0 中没有办法只删除一个条目。引用[iOS 5.0 的 iOS SDK 发行说明](http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-5_0/_index.html)：

**应用程序的Springboard**
Push 和本地通知出现在 iOS 5 的新通知中心中。通知中心显示被视为“未读”的通知。为了适应没有未读状态的推送和本地通知，请将应用程序的标记计数设置为 0 以从通知中心清除该应用程序的通知。

# java - 使用构造函数传递整数

> ID：10154865
> 
> 赞同：0
> 
> 时间：2012-04-14T15:38:34.367
> 
> 标签：java, android, class, constructor

可以，然后呢

*   创建了新的 Zombie 变量。

    ```
    private Zombie zombieA;
    ```

*   僵尸变量初始化

    ```
    zombieA = new Zombie(1);
    ```

*   在 Zombie 类中调用构造函数：

    ```
    public Zombie(int type) {
    this.type = type;
    x=200;
    y=100;
    dx=1;
    paintA.setColor(Color.RED);} 
    ```

基本上，我希望游戏类创建一个新的僵尸，类型为 1，它将通过开关和案例来确定要创建的僵尸类型（级别 1=10）。问题是当我运行它时，我的应用程序强制关闭，并且出现错误：

```
zombieA = new Zombie(1); 
```

从初始类和错误：

```
public Zombie(int type) { 
```

来自僵尸班。我一遍又一遍地检查它，我只是看不到问题，有人注意到有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:32:56.057

没有堆栈跟踪很难说，但我怀疑问题出在这一行：

```
paintA.setColor(Color.RED); 
```

你确定`paintA`已经正确初始化了吗？在我看来，它是`null`并导致`NullPointerException`您的构造函数中的 a 。如果是这种情况，请务必先实例化它，如下所示：

```
paintA = new ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:11:31.630

您是从工作线程中调用 Zombie 类吗？您需要从 UI 线程执行此操作，这里有一些示例：[Can't create handler inside thread that has not called Looper.prepare()](https://stackoverflow.com/questions/3875184/cant-create-handler-inside-thread-that-has-not-called-looper-prepare)

# macos - 如何在 Mac 上运行脚本文件？

> ID：10154866
> 
> 赞同：1
> 
> 时间：2012-04-14T15:38:34.537
> 
> 标签：macos

我已经搜索了如何在 Mac 上运行脚本文件，但对我没有任何帮助。

每次我尝试`sudo script-name`终端都会响应

> -bash: /Users/macuser/Desktop/tesseract-3.01: 是一个目录

我要运行的文件被调用`start`，它位于`tesseract-3.01`桌面上的目录中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:42:42.657

简单地做

```
/Users/macuser/Desktop/tesseract-3.01/start 
```

或者如果它实际上被称为 start.sh

```
/Users/macuser/Desktop/tesseract-3.01/start.sh 
```

你可能还想做

```
chmod +x /Users/macuser/Desktop/tesseract-3.01/start.sh 
```

在运行脚本之前将脚本更改为可执行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:41:18.030

```
sudo /Users/macuser/Desktop/tesseract-3.01/start 
```

您必须指明脚本名称，但看起来您只是指定了目录。

您也可以`cd`到该目录，然后像这样运行它：

```
cd /Users/macuser/Desktop/tesseract-3.01
sudo ./start 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-14T04:43:10.090

尝试

```
sudo ./Users/macuser/Desktop/tesseract-3.01/start.sh 
```

或者

```
cd /Users/macuser/Desktop/tesseract-3.01 
```

然后

`sudo ./start.sh`

# delphi - Delphi7 和 Delphi XE2 中的 Delphi HID

> ID：10154878
> 
> 赞同：0
> 
> 时间：2012-04-14T15:40:00.910
> 
> 标签：delphi, delphi-xe2, hid

我在 Delphi 7 中做了一个小程序来显示所有连接的 HID 设备的一些细节。我只使用了系统文件，如`SetupAPI`,`Moduleloader`和`HID.pas`. 这很完美。当我采用相同的代码并在 Delphi XE2 或（2010 年）中编译它时，它无法产生所需的输出。

可能这与指针转换有关，但我找不到根本原因。

任何人都可以帮忙。

这是我的代码：

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, 
  Graphics, Controls, Forms, Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Memo1: TMemo;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

Uses 
  SetUpAPI, HID;

{$R *.dfm}

Type
  THIDUSBDeviceInfo = Record   { contains interface level information of each device}
    SymLink            : String;
    BufferSize         : Word;
    Handle             : THandle;
    VID                : DWord;
    PID                : DWord;
    VersionNumber      : Word;
    ManufacturerString : String;
    ProductString      : String;
    SerialNumberString : String;
  end;
  THIDDeviceList = Array of THIDUSBDeviceInfo;

Const
  HIDUSB_COUNTOFINTERRUPTBUFFERS = 64;   // Count of buffers for interrupt data

Procedure ScanForHIDdevices( Var DeviceList : THIDDeviceList;
    TargetVID, TargetPID  : DWord);
Var
  HID_GUIid     : TGUID;
  spdid        : TSPDeviceInterfaceData;
  pSpDidd      : PSPDEVICEINTERFACEDETAILDATAA;
  spddd        : TSPDevInfoData;
  HIDinfo       : HDEVINFO;
  CurIdx       : Integer;
  dwSize       : DWord;
  SymbolicLink : String;
  DevHandle    : THandle;
  HidAttrs     : THIDDAttributes;
  FoundIdx     : Integer;
  Info         : THIDUSBDeviceInfo;

  Function GetHidDeviceInfo( Symlink : PChar) : THIDUSBDeviceInfo;
  Var
    pstr          : pWideChar;
    preparsedData : PHIDPPreparsedData;
    hidCaps       : THIDPCaps;
  Begin
    FillChar(Result, SizeOf( Result), 0);
    Result.SymLink := SymLink+ #0;
    GetMem( pstr, 512);
    DevHandle := CreateFile( Symlink,
                             GENERIC_READ or GENERIC_WRITE,
                             FILE_SHARE_READ or FILE_SHARE_WRITE,
                             nil,
                             OPEN_EXISTING,
                             0,
                             0);
    If DevHandle <> INVALID_HANDLE_VALUE then
    begin
      If HidD_GetAttributes( DevHandle,
                             HidAttrs) then
      begin
        result.VID           := HidAttrs.VendorID;
        result.PID           := HidAttrs.ProductID;
        result.VersionNumber := HidAttrs.VersionNumber;
      end;

      If HidD_GetManufacturerString( DevHandle, pstr, 512) then 
        Result.ManufacturerString := pStr;

      If HidD_GetProductString( DevHandle, pstr, 512) then 
        Result.ProductString := pStr;

      If HidD_GetSerialNumberString( DevHandle, pstr, 512) then 
        Result.SerialNumberString := pStr;

      { Set Input buffer size }
      HidD_SetNumInputBuffers( DevHandle,
                               HIDUSB_COUNTOFINTERRUPTBUFFERS);

      { Get capabilities }
      HidD_GetPreparsedData( DevHandle, preparsedData);
      if (preparsedData) then
      begin
        HidP_GetCaps( preparsedData, hidCaps);
        Result.BufferSize := hidCaps.OutputReportByteLength;
      end
      else 
       Result.BufferSize := 11;

      closeHandle( DevHandle);
    end;
    FreeMem( pStr);
  End;

Begin
  FoundIdx   := 0;
  DeviceList := Nil;
  { Get GUID of hid class }
  HidD_GetHidGuid( HID_GUIid);
  { Get a list of devices belonging to HID class }
  HIDinfo := SetupDiGetClassDevs( @HID_GUIid,
                                  nil,
                                  GetDesktopWindow(),
                                  DIGCF_DEVICEINTERFACE or DIGCF_PRESENT);
  { Go through list of devices }
  If thandle(HIDinfo) <> INVALID_HANDLE_VALUE then
  begin
    CurIdx := 0;
    spdid.cbSize := SizeOf(spdid);
    While SetupDiEnumDeviceInterfaces( HIDinfo,
                                       nil,
                                       HID_GUIid,
                                       curIdx,
                                        spdid) do
    begin
      dwSize := 0;
      { Get device path for Createfile calls }
      SetupDiGetDeviceInterfaceDetail( HIDinfo,
                                       @spdid,
                                       nil,
                                       dwSize,
                                       @dwSize,
                                       nil);
      If dwSize > 0 then
      begin
        GetMem(pSpDidd, dwSize);
        pSpDidd^.cbSize := SizeOf( TSPDEVICEINTERFACEDETAILDATAA);
        spddd.cbSize    := SizeOf(spddd);
        If SetupDiGetDeviceInterfaceDetail( HIDinfo,
                                            @spdid,
                                            pSpDidd,
                                            dwSize,
                                            @dwSize,
                                            @spddd) then
        begin
          SymbolicLink := PChar( @(pSpDidd^.DevicePath));

          { Get information about the device (Vendor and 
            Product IDs, Strings, ...) }
          FillChar(info, SizeOf(Info), 0);
          Info        := GetHidDeviceInfo( @(pSpDidd^.DevicePath));
          Info.Handle := INVALID_HANDLE_VALUE;

          { check if VID/PID match targets }
          If (Info.VID = TargetVID) AND
             (Info.PID = TargetPID) then
          begin
            { Add Devices to result list }
            SetLength(DeviceList, FoundIdx + 1);
            DeviceList[foundIdx] := Info;
            Inc(FoundIdx);
          end
          else  // list all HID devices if no target is specified
            If (TargetVID = 0) AND (TargetPID = 0) then
            begin
              { Add Devices to result list }
              SetLength( DeviceList, FoundIdx + 1);
              DeviceList[FoundIdx] := Info;

              Inc(FoundIdx);
            end;
        end;

        FreeMem( pSpDidd);
      end;
      inc(CurIdx);
    end;
    SetupDiDestroyDeviceInfoList( HIDinfo);
  end;
End;

procedure TForm1.Button1Click(Sender: TObject);
Var
  DeviceList : THIDDeviceList;
  I          : Integer;
begin
  ScanForHIDdevices( DeviceList, 0, 0);
  Memo1.Lines.Clear;
  Memo1.Lines.Add(IntToStr(Length(DeviceList)) + ' device(s) found');
  If Length(DeviceList) > 0 then
    For I := 0 to Length(DeviceList)-1 do
      With DeviceList[I] do
      begin
        Memo1.Lines.Add('Device Number : '   + IntToStr(I));
        Memo1.Lines.Add('Symbolic link : '   + SymLink);
        Memo1.Lines.Add('Handle        : 0x' + IntToHex(Handle, 1));
        Memo1.Lines.Add('Buffer size   : '   + IntToStr(BufferSize));
        Memo1.Lines.Add('VID           : 0x' + IntToHex(VID, 4));
        Memo1.Lines.Add('PID           : 0x' + IntToHex(PID, 4));
        Memo1.Lines.Add('Version       : '   + IntToStr(VersionNumber));
        Memo1.Lines.Add('Manufacturer  : '   + ManufacturerString);
        Memo1.Lines.Add('Product name  : '   + ProductString);
        Memo1.Lines.Add('Serial number : '   + SerialNumberString);
        Memo1.Lines.Add(' ');
      end;
  Memo1.SetFocus;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-08-23T13:11:02.497

在调用以下任何函数之前，您必须加载 DLL 模块：

```
LoadHid();
LoadSetupApi(); 
```

我想我们必须在程序完成后卸载 DLL。然后使用此代码：

```
UnloadHid;
UnloadSetupApi 
```

# php - 使用文件路径的字段值

> ID：10154882
> 
> 赞同：0
> 
> 时间：2012-04-14T15:40:32.080
> 
> 标签：php

我想知道是否有人可以帮助我。

我正在尝试使用以下文件路径加载 xml 文件：

```
/UploadedFiles/username/location/files.xml 
```

一段时间以来，我一直在尝试做的是使用两个表单字段的值，“用户名”和“位置”并将它们合并到文件路径中，但我似乎无法做到这一点。

我只是想知道是否有人可以告诉我如何获取这些值并在文件路径中使用它们。

非常感谢

**修改后**

我认为我可以通过简单地更改文件路径来解决我的问题，因此我的原始帖子，但我担心我缺乏 PHP 知识让我失望，我怀疑我遇到的问题在我的代码中更深层次。

请在下面找到更多详细信息。

下面的脚本显示了我最初是如何保存图像的。

**'上传.php'**

```
<?php
require_once 'Includes/gallery_helper.php'; 
require_once 'ImageUploaderPHP/UploadHandler.class.php'; 
$galleryPath = 'UploadedFiles/'; 

function onFileUploaded($uploadedFile) { 
  global $galleryPath; 

  $packageFields = $uploadedFile->getPackage()->getPackageFields(); 
  $username=$packageFields["username"]; 
  $locationid=$packageFields["locationid"]; 
  $username = preg_replace('/[^a-z0-9_\-\.()\[\]{}]/i', '_', $_POST['username']); 
  $location = preg_replace('/[^a-z0-9_\-\.()\[\]{}]/i', '_', $_POST['locationid']); 
  $dirName = preg_replace('/[^a-z0-9_\-\.()\[\]{}]/i', '_', $_POST['folder']); 

  $absGalleryPath = realpath($galleryPath) . DIRECTORY_SEPARATOR . $username . DIRECTORY_SEPARATOR . $location . DIRECTORY_SEPARATOR; 
  $absThumbnailsPath = $absGalleryPath . 'Thumbnails' . DIRECTORY_SEPARATOR; 

  if (!is_dir($absGalleryPath)) mkdir($absGalleryPath, 0777, true); 
  chmod($absGalleryPath, 0777); 
  if (!is_dir($absGalleryPath . $dirName)) mkdir($absGalleryPath . $dirName, 0777, true); 
  chmod($absGalleryPath . $dirName, 0777); 

  if ($uploadedFile->getPackage()->getPackageIndex() == 0 && $uploadedFile->getIndex() == 0) 
    initGallery($absGalleryPath, $absThumbnailsPath, FALSE); 

  $originalFileName = $uploadedFile->getSourceName(); 
  $files = $uploadedFile->getConvertedFiles(); 
  $sourceFileName = getSafeFileName($absGalleryPath, $originalFileName); 
  $sourceFile = $files[0]; 

  if ($sourceFile) $sourceFile->moveTo($absGalleryPath . $sourceFileName); 
  $thumbnailFileName = getSafeFileName($absThumbnailsPath, $originalFileName); 
  $thumbnailFile = $files[1]; 
  if ($thumbnailFile) $thumbnailFile->moveTo($absThumbnailsPath . $thumbnailFileName); 

  $descriptions = new DOMDocument('1.0', 'utf-8'); 
  $descriptions->load($absGalleryPath . 'files.xml'); 

  $xmlFile = $descriptions->createElement('file'); 
  // <-- please check the following line 
  $xmlFile->setAttribute('name', $_POST['folder'] . '/' . $originalFileName); 
  $xmlFile->setAttribute('source', $sourceFileName); 
  $xmlFile->setAttribute('size', $uploadedFile->getSourceSize()); 
  $xmlFile->setAttribute('originalname', $originalFileName); 
  $xmlFile->setAttribute('thumbnail', $thumbnailFileName); 
  $xmlFile->setAttribute('description', $uploadedFile->getDescription()); 
  $xmlFile->setAttribute('username', $username); 
  $xmlFile->setAttribute('locationid', $locationid); 
  $xmlFile->setAttribute('folder', $dirName); 

  $descriptions->documentElement->appendChild($xmlFile); 
  $descriptions->save($absGalleryPath . 'files.xml'); 
} 

$uh = new UploadHandler(); 
$uh->setFileUploadedCallback('onFileUploaded'); 
$uh->processRequest(); 
?> 
```

此脚本生成以下文件结构：

UploadedFiles（预先存在的文件夹）

*   “用户名”（包含“位置”文件夹的子文件夹）
*   “位置”（包含原始图像的子文件夹、“files.xml”和“缩略图”文件夹）
*   “缩略图”（包含原始图像缩略图的子文件夹）

**注意。**“用户名”和“位置”文件夹名称派生自当前用户和位置值。

然后我开始讨论创建图片库的问题。

下面的代码是我最初的“gallery.php”脚本。我需要更改脚本的顶部 PHP 部分以匹配新的文件夹结构`UploadedFiles/'username'/'location'/Thumbnails`，即`UploadedFiles/'username'/'location'.files.xml`

'画廊.php'

```
<?php 

  $galleryPath = 'UploadedFiles/'; 

  $thumbnailsPath = $galleryPath . 'Thumbnails/'; 

  $absGalleryPath = realpath($galleryPath) . DIRECTORY_SEPARATOR; 

  $descriptions = new DOMDocument('1.0'); 
  $descriptions->load($absGalleryPath . 'files.xml'); 
?>
<head> 
  <title>Gallery</title> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
  <link href="Libraries/fancybox/jquery.fancybox-1.3.1.css" rel="stylesheet" type="text/css" /> 
  <link href="Styles/style.css" rel="stylesheet" type="text/css" /> 
  <!--[if IE]>   
  <link href="Styles/ie.css" rel="stylesheet" type="text/css" /> 
  <![endif]-->
  <script src="Libraries/jquery/jquery-1.4.3.min.js" type="text/javascript"></script> 
  <script src="Libraries/fancybox/jquery.fancybox-1.3.1.pack.js" type="text/javascript"></script> 
  <script type="text/javascript"> 

  $(function() { $('a.fancybox').fancybox(); }); 

  </script> 
  <style type="text/css">
<!--
.style1 {
    font-size: 14px;
    margin-right: 110px;
}
.style4 {font-size: 12px}
-->
  </style>
</head>
<body style="font-family: Calibri; color:  #505050; font-size: 9px; border-bottom-width: thin; margin-top: 5px; margin-left: -476px; margin-right: 1px; margin-bottom: -10px;">
<div align="right" class="style1"> <a href = "imagefolders.php" /> View Uploaded Images In Folder Structure <a/> &larr; View All Uploaded Images </div>
  <form id="gallery" class="page"> 
  <div id="container"> 
    <div id="center"> 
      <div class="aB"> 
        <div class="aB-B"> 
          <?php if ('Uploaded files' != $current['title']) :?>
          <?php endif;?>
          <div class="demo"> 
          <input name="username" type="text" id="username" value="IRHM73" />
          <input name="locationid" type="text" id="locationid" value="1" />
            <div class="inner"> 
              <div class="container"> 
                <div class="gallery"> 
                  <ul class="gallery-image-list"> 
                  <?php for ($i = 0; $i < $descriptions->documentElement->childNodes->length; $i++) : 
                          $xmlFile = $descriptions->documentElement->childNodes->item($i); 
                          $name = htmlentities($xmlFile->getAttribute('originalname'), ENT_COMPAT, 'UTF-8'); 
                          $description = htmlentities($xmlFile->getAttribute('description'), ENT_COMPAT, 'UTF-8'); 
                          $folder = htmlentities($xmlFile->getAttribute('folder'), ENT_COMPAT, 'UTF-8'); 
                          $source = $galleryPath . rawurlencode($xmlFile->getAttribute('source')); 
                          $thumbnail = $thumbnailsPath . rawurlencode($xmlFile->getAttribute('thumbnail')); 
                  ?>
                    <li class="item"> 
                      <a class="fancybox" target="_blank" rel="original" href="<?php echo $source; ?>"><img class="preview" 
                        alt="<?php echo $name; ?>"  src="<?php echo $thumbnail; ?>" /></a></li>
                        <p><span class="style4"><b>Image Description:</b> <?php echo htmlentities($xmlFile->getAttribute('description'));?> <br />
                          <b>Contained in folder:</b> <?php echo htmlentities($xmlFile->getAttribute('folder'));?> </span><br />  
                          <?php endfor; ?>
                          </li>
                        </p>
                  </ul>
                </div> 
              </div> 
            </div> 
          </div> 
        </div> 
      </div> 
    </div> 
    </div> 
        <div class="aB-a">        </div> 
      </div> 
    </div> 
  </div> 
  </form> 
</body> 
</html> 
```

我承认在如何解决这个问题上真的不知所措，我不知道是我的“gallery.php”脚本需要更改还是我的“upload.php”

任何帮助都会非常感激。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:53:09.960

您必须将它们定义为变量并包含在字符串中

```
$username = "user1";
$location = "userlocation1";

$url = "/UploadedFiles/$username/$location/files.xml";

//Next you might want to verify the location

if(is_file($url)) {
   //do your operation....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:44:42.390

好的，假设你有这个值 : `username`, `location`.

然后，（如果我的问题正确）在响应脚本（接收表单操作的脚本）中，试试这个：

```
<?php

     $username = $_GET['username'];
     $location = $_GET['location'];

     $filepath = "/UploadedFiles/$username/$location/files.xml";

?> 
```

* * *

**提示*（2 种连接字符串的方法）*：**

```
$filepath = "/UploadedFiles/$username/$location/files.xml"; 
```

**或者**

```
$filepath = "/UploadedFiles/".$username."/".$location."/files.xml"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:49:20.173

无论您在表单中使用 post 或 get 方法，这都会起作用。只需确保为输入文本 html 元素选择字段名称用户名和位置。

```
$filepath = "/UploadedFiles/{$_REQUEST['username']}/{$_REQUEST['location']}/files.xml" 
```

# c++ - 存储非负浮点值

> ID：10154885
> 
> 赞同：1
> 
> 时间：2012-04-14T15:41:12.140
> 
> 标签：c++, floating-point, unsigned, primitive-types

`float32`有没有一种有效的方法来使用现有的和`float64`格式存储非负浮点值？

`float32`想象一下允许负/正的默认行为：

```
val = bytes.readFloat32(); 
```

如果不需要负值，是否可以允许更大的正值？

```
val = bytes.readFloat32() + 0xFFFFFFFF; 
```

**编辑：**基本上当我知道我只存储正值时，可以稍微修改浮点格式以允许相同数量的位具有更大的范围或精度。

例如。`float32`格式定义为符号**1 位**，指数**8 位**，分数**23 位**

如果我不需要符号位怎么办，我们可以有**8 位**用于指数，**24 位**用于分数，以便为相同的 32 位提供更高的精度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-14T15:47:48.800

浮点数 (`float32`和`float64`) 有一个明确的符号位。浮点数不存在等效的无符号整数。

因此，没有简单的方法将正浮点数的范围加倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T16:00:19.310

不，不是免费的。

您可以使用其他数字表示以多种方式扩展范围/精度。意图并不明确，如果您想要使用另一个数字表示（大小相等）的范围和准确性，性能通常会很差`float`。`double`

只要坚持`float`或`double`除非性能/存储非常重要，并且您可以使用另一种数字表示很好地（或更好！）表示您的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-17T04:35:52.810

硬件中[几乎不支持无符号浮点数，](https://stackoverflow.com/q/512022/995714)因此您不会拥有这种现成的功能，但您仍然可以通过将最低有效位存储在符号位中来获得非常有效的无符号浮点数。通过这种方式，您可以利用可用的浮点硬件支持，而不是编写软件浮点解决方案。为此，您可以

*   每次操作后手动操作

    这样，您需要对 lsb（AKA 符号位）进行一些小的修正，例如 1 个更长的除法步长，或用于加法的 1 位加法器

*   或通过更高精度的数学计算（如果有）

    例如，如果类型是`float`您可以在其中执行操作，则在存储时`double`转换回`float`

这是一个简单的 PoC 实现：

```
#include <cmath>
#include <cfenv>
#include <bit>
#include <type_traits>

// Does the math in double precision when hardware double is available
#define HAS_NATIVE_DOUBLE

class UFloat
{
public:
    UFloat(double d) : UFloat(0.0f)
    {
        if (d < 0)
            throw std::range_error("Value must be non-negative!");
        uint64_t dbits = std::bit_cast<uint64_t>(d);
        bool lsb = dbits & lsbMask;
        dbits &= ~lsbMask; // turn off the lsb
        d = std::bit_cast<double>(dbits);
        value = lsb ? -(float)d : (float)d;
    }

    UFloat(const UFloat &rhs) : UFloat(rhs.value) {}

    // =========== Operators ===========
    UFloat &operator+=(const UFloat &rhs)
    {
#ifdef HAS_NATIVE_DOUBLE
        // Calculate in higher precision then round back
        setValue((double)value + rhs.value);
#else
        // Calculate the least significant bit manually

        bool lhsLsb = std::signbit(value);
        bool rhsLsb = std::signbit(rhs.value);
        // Clear the sign bit to get the higher significant bits
        // then get the sum
        value = std::abs(value);
        value += std::abs(rhs.value);
        if (std::isfinite(value))
        {
            if (lhsLsb ^ rhsLsb) // Only ONE of the 2 least significant bits is 1
            {
                // The sum's lsb is 1, so we'll set its sign bit
                value = -value;
            }
            else if (lhsLsb)
            {
                // BOTH least significant bits are 1s,
                // so we'll add the carry to the next bit
                value = std::nextafter(value, INFINITY);
                // The lsb of the sum is 0, so the sign bit isn't changed
            }
        }
#endif
        return *this;
    }

    UFloat &operator*=(const UFloat &rhs)
    {
#ifdef HAS_NATIVE_DOUBLE
        // Calculate in higher precision then round back
        setValue((double)value * rhs.value);
#else
        // Calculate the least significant bit manually

        bool lhsLsb = std::signbit(value);
        bool rhsLsb = std::signbit(rhs.value);

        // Clear the sign bit to get the higher significant bits
        // then get the product
        float lhsMsbs = std::abs(value);
        float rhsMsbs = std::abs(rhs.value);

        // Suppose we have X.xPm with
        //     X: the high significant bits
        //     x: the least significant one
        // and m: the exponent. Same to Y.yPn
        // X.xPm * Y.yPn = (X + 0.x)*2^m * (Y + 0.y)*2^n
        //               = (X + x/2)*2^m * (Y + y/2)*2^n
        //               = (X*Y + X*y/2 + Y*x/2 + x*y/4)*2^(m + n)
        value = lhsMsbs * rhsMsbs; // X*Y
        if (std::isfinite(value))
        {
            uint32_t rhsMsbsBits = std::bit_cast<uint32_t>(rhsMsb);
            value += rhsMsbs*lhsLsb / 2; // X*y/2

            uint32_t lhsMsbsBits = std::bit_cast<uint32_t>(lhsMsbs);
            value += lhsMsbs*rhsLsb / 2; // Y*x/2

            int lsb = (rhsMsbsBits | lhsMsbsBits) & 1; // the product's lsb
            lsb += lhsLsb & rhsLsb;
            if (lsb & 1)
                value = -value; // set the lsb
            if (lsb > 1)    // carry to the next bit
                value = std::nextafter(value, INFINITY);
        }
#endif

        return *this;
    }

    UFloat &operator/=(const UFloat &rhs)
    {
#ifdef HAS_NATIVE_DOUBLE
        // Calculate in higher precision then round back
        setValue((double)value / rhs.value);
#else
        // Calculate the least significant bit manually
        // Do just one more step of long division,
        // since we only have 1 bit left to divide

        throw std::runtime_error("Not Implemented yet!");
#endif

        return *this;
    }

    double getUnsignedValue() const
    {
        if (!std::signbit(value))
        {
            return value;
        }
        else
        {
            double result = std::abs(value);
            uint64_t doubleValue = std::bit_cast<uint64_t>(result);
            doubleValue |= lsbMask; // turn on the least significant bit
            result = std::bit_cast<double>(doubleValue);
            return result;
        }
    }

private:
    // The unsigned float value, with the least significant bit (lsb)
    // being stored in the sign bit
    float value;

    // the first bit after the normal mantissa bits
    static const uint64_t lsbMask = 1ULL << (DBL_MANT_DIG - FLT_MANT_DIG - 1);

    // =========== Private Constructor ===========
    UFloat(float rhs) : value(rhs)
    {
        std::fesetround(FE_TOWARDZERO); // We'll round the value ourselves
#ifdef HAS_NATIVE_DOUBLE
        static_assert(sizeof(float) < sizeof(double));
#endif
    }

    void setValue(double d)
    {
        // get the bit pattern of the double value
        auto bits = std::bit_cast<std::uint64_t>(d);
        bool lsb = bits & lsbMask;

        // turn off the lsb to avoid rounding when converting to float
        bits &= ~lsbMask;
        d = std::bit_cast<double>(bits);

        value = (float)d;
        if (lsb)
            value = -value;
    }
} 
```

可能需要进行更多调整才能获得正确的 lsb

无论哪种方式，您都需要比正常情况更多的操作，因此这可能仅适用于需要考虑缓存占用的大型阵列。在这种情况下，我建议**仅将其用作存储格式**，就像[FP16](https://en.wikipedia.org/wiki/Half-precision_floating-point_format)在大多数当前架构上的处理方式一样：只有加载/存储指令可以扩展为`float`或`double`转换回。所有算术运算都在`float`或`double`仅完成

所以无符号浮点数应该只存在于内存中，并且会`double`在加载时被解码为完整的。这样您就可以使用本机`double`类型，并且不需要在每个运算符之后进行更正

或者，这可以与 SIMD 一起使用以同时对多个无符号浮点数进行操作

# c# - 从 WPF 动画/情节提要中保存视频

> ID：10154888
> 
> 赞同：3
> 
> 时间：2012-04-14T15:41:36.290
> 
> 标签：c#, wpf

我有一个非常复杂的`Storyboard`东西，在“实时”窗口上运行时效果很好，但是我无法手动为这个故事板设置动画以获取可以保存到单个 PNG 文件中的逐帧动画。所有生成的图像都是第一个动画帧。

我看到[了这个](https://stackoverflow.com/questions/764770/how-to-render-wpf-animation-as-a-video-frame-by-frame)，[这个](https://stackoverflow.com/questions/1462385/is-is-possible-to-record-my-wpf-control-to-a-movie)，[这个](https://stackoverflow.com/questions/1454158/creating-video-from-wpf-silverlight-animation)，最终[这个](http://blogs.msdn.com/b/saveenr/archive/2008/09/22/wpf-xaml-saving-an-animation-as-an-avi-video-file.aspx)。还有[这个 MSDN 示例](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.clockcontroller.aspx)，但他们都在谈论动画单个`DependencyProperty`. 我需要的是能够逐帧通过复杂的`Storyboard`，而不仅仅是一个 DP。

我到处搜索，没有任何运气。我的实验也都失败了。任何帮助表示赞赏。这是一些非功能性代码。

```
 storyboard.Begin(grid, true);
            //storyboard.Pause();
            //var clock = storyboard.CreateClock();
            //clock.Controller.Pause();
            var secs = Enumerable.Range(0, totalFrames).Select(t => (((double)t) / FPS));

            grid.Measure(new Size(480, 340));
            grid.Arrange(new Rect(grid.DesiredSize));

            foreach (var sec in secs)
            {
                //clock.Controller.SeekAlignedToLastTick(TimeSpan.FromSeconds(sec), TimeSeekOrigin.BeginTime);
                storyboard.SeekAlignedToLastTick(TimeSpan.FromSeconds(sec), TimeSeekOrigin.BeginTime);
                grid.InvalidateVisual();
                grid.UpdateLayout();

                var filename = Path.Combine(tempFolder, string.Format("image{0}.png", sec));
                var rtb = new RenderTargetBitmap((int) grid.ActualWidth, (int) grid.ActualHeight, 96, 96, PixelFormats.Pbgra32);
                rtb.Render(grid);

                var png = new PngBitmapEncoder();
                png.Frames.Add(BitmapFrame.Create(rtb));

                using (var stream = new FileStream(filename, FileMode.Create, FileAccess.ReadWrite))
                {
                    png.Save(stream);
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-07-07T05:30:44.910

@wpfwannabe：非常感谢您的洞察力。

我使用了你的代码，它成功了，尽管做了一些小的修改，如下所示：

```
rootStoryBoard.SeekAlignedToLastTick(Program.AnimPlots.canvs, TargetTmspn, System.Windows.Media.Animation.TimeSeekOrigin.BeginTime); 
```

在上面的代码行中：`Program.AnimPlots.canvs`是快照区域，在您的情况下，它是`grid`并且`TargetTmspn`是类型的对象`TimeSpan`。

希望这可以帮助某人:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:39:57.490

这是您可能会发现有用的另一种方法。如果您已经用尽了所有选项来为您的 XAML 故事板逐帧设置动画，那么您可以探索的另一个选项是在代码中创建您的故事板，下面是一个示例：[使用 RenderTransform 在代码隐藏 for 循环中的动画](https://stackoverflow.com/questions/10115657/animation-in-codebehind-for-loop-using-rendertransform/10116770#10116770)

这样做的好处是，您可以对 Storyboard 进行完全的编程控制，以逐个浏览各个关键帧，然后您可以在每一帧之后保存图像。

不久前，我在 jQuery 中做了一些概念上类似的事情。基本上我写了一个保存坐标数据点的画线签名应用程序。然后我可以将数据点重新加载回算法并重现动画。[http://kodekreachor.com/prototypes/](http://kodekreachor.com/prototypes/)

我知道这是一种非常不同的技术，但它的想法是能够从代码中完全控制顺序动画，这应该是要点，希望能给你一些启发。

# php - 在 PHP 中加密字符串

> ID：10154890
> 
> 赞同：3
> 
> 时间：2012-04-14T15:42:02.017
> 
> 标签：php, string, encryption

目前我正在使用

```
$key="pass";
$val="secret";
$encp=mcrypt_encrypt(MCRYPT_DES, $key, $val, MCRYPT_MODE_ECB); 
```

但是当我调用`printf($encp)` 没有显示值时，我使用的是 PHP 5.2.17 版

有没有更好的方法。请帮忙。

编辑：

```
<?PHP

    define('SECURE_KEY','Somekey');

    function encrypt($value){
        $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
        $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
        return mcrypt_encrypt(MCRYPT_RIJNDAEL_256, SECURE_KEY, $value, MCRYPT_MODE_ECB, $iv);
    }

    function decrypt($value){
        $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
        $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
        return trim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, SECURE_KEY, $value, MCRYPT_MODE_ECB, $iv));
    }
    $temp=encrypt("teststring");
    printf($temp);
    ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T15:50:03.197

## 更新（27/09/17）：

由于[mcrypt_encrypt自](http://php.net/manual/en/function.mcrypt-encrypt.php)**PHP 7.1.0**起已弃用。[我已经使用openssl](http://php.net/manual/en/ref.openssl.php)添加了一个简单的加密/解密。

```
function encrypt($string, $key = 'PrivateKey', $secret = 'SecretKey', $method = 'AES-256-CBC') {
    // hash
    $key = hash('sha256', $key);
    // create iv - encrypt method AES-256-CBC expects 16 bytes
    $iv = substr(hash('sha256', $secret), 0, 16);
    // encrypt
    $output = openssl_encrypt($string, $method, $key, 0, $iv);
    // encode
    return base64_encode($output);
}

function decrypt($string, $key = 'PrivateKey', $secret = 'SecretKey', $method = 'AES-256-CBC') {
    // hash
    $key = hash('sha256', $key);
    // create iv - encrypt method AES-256-CBC expects 16 bytes
    $iv = substr(hash('sha256', $secret), 0, 16);
    // decode
    $string = base64_decode($string);
    // decrypt
    return openssl_decrypt($string, $method, $key, 0, $iv);
}

$str = 'Encrypt this text';
echo "Plain: " .$str. "\n";

// encrypt
$encrypted_str = encrypt($str);
echo "Encrypted: " .$encrypted_str. "\n";

// decrypt
$decrypted_str = decrypt($encrypted_str);
echo "Decrypted: " .$decrypted_str. "\n"; 
```

试试这些：**（PHP < 7.1.0）**如果您使用 > PHP 7.1.0，请参见上文。

```
define('SECURE_KEY','Somekey');//Assigned within a config, pref outside of root dir

function encrypt($value){
    $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
    $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
    return mcrypt_encrypt(MCRYPT_RIJNDAEL_256, SECURE_KEY, $value, MCRYPT_MODE_ECB, $iv);
}

function decrypt($value){
    $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB);
    $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);
    return trim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, SECURE_KEY, $value, MCRYPT_MODE_ECB, $iv));
}
//Simple usage
$encryptedString = encrypt('This String Will Be encrypted');
echo decrypt($encryptedString); 
```

从源编辑 - [http://php.net/manual/en/function.mcrypt-encrypt.php](http://php.net/manual/en/function.mcrypt-encrypt.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T20:24:35.113

试试这些 PHP 函数[convert_uuencode](http://www.php.net/manual/en/function.convert-uuencode.php)和[convert_uudecode](http://www.php.net/manual/en/function.convert-uudecode.php)：

```
function encrypt_decrypt ($data, $encrypt) {
    if ($encrypt == true) {
        $output = base64_encode (convert_uuencode ($data));
    } else {
        $output = convert_uudecode (base64_decode ($data));
    }
    return $output;
}

$enc_txt = encrypt_decrypt ("PASSWORD TEXT", true);
echo $enc_txt."\n";
// LTQkJTM0VT0vNEQwQDUkNTg1YGBgCmAK
echo encrypt_decrypt ($enc_txt, false);
// PASSWORD TEXT 
```

这要简单得多，并且不依赖于 PHP 中安装的库

# javascript - 如何制作有背景的标题？

> ID：10154891
> 
> 赞同：1
> 
> 时间：2012-04-14T15:42:19.403
> 
> 标签：javascript, html, css

我想让标题覆盖图像。这很容易，但我希望它有一定的宽度，并且有块中的文本。这是我想要的图像：

![在此处输入图像描述](../Images/30a1b2d5e32399f6695cf544898135d8.png)

如果可能的话，我想在 CSS 中执行此操作，但我可以使用 Javascript。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T15:54:16.107

在这里查看一个活生生的[例子](http://jsfiddle.net/jackdent/zms26/)。试试这个：

**HTML**：

```
<div>
    <span>Hello world</span><br>
    <span>More text here</span>
</div> 
```

​<strong>CSS：

```
div {
    width: 400px;
    height: 400px;
    background-image: url(http://www.hotels.tv/london-hotels/images/destinations/1/w97654_8.jpg);
    background-repeat: no-repeat;
    background-image-width: 100%;

}
div span {
    font-size: 30px;
    position: relative;
    top: 100px;
    background-color: gray;
    color: white;
}
​ 
```

**编辑**

在这个[例子](http://jsfiddle.net/jackdent/zms26/1/)`display: table-cell`中，文本通过使用和`vertical-align: bottom`在父级上对齐到底部。

**编辑 2**

对于透明背景，使用 rgba()，如本[例所示](http://jsfiddle.net/jackdent/zms26/2/)

**编辑 3**

要使文本右对齐，请`text-align: right`在父级上设置，如本[例所示](http://jsfiddle.net/jackdent/zms26/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T15:47:53.567

可能需要进行一些调整才能完全得到您想要的外观，但这是一个起点。

```
<style>
    #image_container {
        position: relative;
        background-image: url(path/to/image) no-repeat;
        width: 500px;
        height: 500px;
    }
    #image_container .title {
        position: absolute;
        top: 300px;
        background: #000;
        background: rgba(0,0,0,0.75);
        color: white;
        font-size: 30px;
        font-weight: bold;
    }
</style>
<div id="image_container">
    <div class="title">
        <p>Some Text</p>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T16:27:56.567

## *[jsFiddle 演示](http://jsfiddle.net/PvZEs/)*

HTML：

```
<div id="background">
    <span>A Movie in the Park:</span>
    <span>Kung Fu Panda</span>
</div> 
```

CSS：

```
#background {
    background: url(http://css-tricks.com/examples/TypeOverImage/images/3754004820_91a5c238a0.jpg) no-repeat;
    width: 400px;
    height: 300px;
}

span {
    position:relative;
    clear:both;
    float:left;
    color:#fff;
    font-size:23px;
    font-weight:bold;
    top:150px;
    margin-top:-2px;
    background-color: #000;
    background-color: rgba(0, 0, 0, 0.7);
    padding: 5px 15px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:54:58.900

这可能会让你开始：http: [//jsfiddle.net/FyL6J/](http://jsfiddle.net/FyL6J/)

没有理由必须使用 jQuery 来完成，但我发现`.position()`它很有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T15:55:50.123

像这样的东西？[http://jsfiddle.net/EcXZZ/](http://jsfiddle.net/EcXZZ/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-14T15:57:13.157

我看到的第一个也是最简单的方法是获取具有所需不透明度的 png 图像，例如标题背景不透明度为 40% 的 1x1 RGB(0,0,0) 像素，并以这种方式设置您的 CSS：

```
<style>
  .image_holder
  {
    position: absolute;
    left: 10px;
    top: 10px;
  }
  .image_holder > img
  {
    position: absolute;
    left: 0;
    top: 0;
  }
  .image_title_overlay
  {
    position: absolute;
    left: 0;
    top: 120px;
    background-image: url('images/black.40%opacity.1x1.png');
    color: 'white';
    padding: 10px 12px;
  }
</style>
<div class="image_holder">
  <img src="image_url.jpg"/>
  <p class="image_title_overlay">A Movie in the Park: <br/>Kung Fu Panda</p>
</div> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-14T16:10:50.317

我会使用 rgba ......基本上是这样的：

```
span {
background-color: rgba(0, 0, 0, 0.4);
padding: 5px 17px;
} 
```

[http://jsfiddle.net/TCtR5/3/](http://jsfiddle.net/TCtR5/3/)

# c - 数组堆栈溢出

> ID：10154892
> 
> 赞同：-1
> 
> 时间：2012-04-14T15:42:40.730
> 
> 标签：c

```
 #include
    int main(void)
    {
        char str[100]="88888888888888";
        char t[20]="";
        gets(t);
        puts(str);
        puts(t);
        return 0;
    }
```

![在此处输入图像描述](../Images/320c87d08b632329f1d84e0ae787a186.png)

第一行

```
555555555555555555555555555555555 
```

被放入。

为什么`str`是`55555555555`？为什么`str`不是`88888888888888888`or `55555555555588888`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T15:45:27.133

您覆盖了`t`缓冲区，并到达了`str`缓冲区，其中输入的其余部分和空终止符已设置。并且`puts`只打印到空终止符。

差不多是这样的：

```
[ t (20)             ][str(100)                                 ]
 55555555555555555555  5555555555555\0 
```

请注意，虽然`t`被声明为`char[20]`，但当您打印它时，您会得到完整的输入（长于 20），因为`puts`在空终止符处停止（再次）。

顺便说一句，这是缓冲区溢出，而不是堆栈溢出，但此代码也可能发生堆栈溢出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:47:50.883

正如 Binyamin 所说，这是由于输入字符串太长而触发的溢出引起的。然而，这有点随机——有时两个内存分配会紧挨着发生，字符串会扩展到相邻的变量，有时可能不会发生。

我建议你为这种溢出设置保护条件。

如果您在`gets` [文档](http://www.cplusplus.com/reference/clibrary/cstdio/gets/)中看到：

> 请注意，gets 的行为与 fgets 将 stdin 作为参数的行为不同：首先，结束换行符不包含在 get 中，而 fgets 包含。其次，gets 不允许您指定要读取的字符数的限制，因此您必须注意 str 指向的数组的大小以避免缓冲区溢出。

在您的情况下，如果您不知道大小 apriory 可能最好使用`fgets`它，因为它更安全（虽然有点慢）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:48:08.337

当您输入一个超过 20 `5`s 的字符串时，它会超出分配给`t`的缓冲区并扩展到分配给的缓冲区`str`。

然后它显示 的内容`str`，即您输入的字符串，从第 21 个字符开始。

最后，它显示 的内容`t`，但由于该字符串不以空字符结尾，它会继续显示内存（分配给 的缓冲区`str`），直到在所有`5`s 之后遇到空字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T16:22:38.273

为了避免这些分配重叠问题，您可以尝试这种替代方法，这样如果我没记错的话，分配会在运行时进行：

```
 #include <iostream>

    int main(void)
    {
      char *str;
      char *t;
      str = new char(100);
      str = (char*)"88888888888888";
      t = new char(20);
      std::cin >> t;
      puts(str);
      puts(t);
      return 0;
    } 
```

# android - Android - 广播接收器适用于模拟器而不是手机

> ID：10154893
> 
> 赞同：2
> 
> 时间：2012-04-14T15:42:41.407
> 
> 标签：android, broadcastreceiver

我编写了一个简单的应用程序，当网络状态发生变化时，atm 只会弹出一条 toast 消息。这在模拟器上完美运行，但我已经在 2 部不同的 android 手机上尝试过，似乎广播接收器永远不会触发这些事件。这是我的广播接收器：

```
public class PhoneStateReceiver extends BroadcastReceiver
{
  @Override
  public void onReceive( Context context, Intent intent )
  {       
      Toast.makeText( context, "Hi", Toast.LENGTH_SHORT ).show();     
  }
} 
```

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
..
    <uses-sdk android:minSdkVersion="8" />

    <application
..
        <receiver android:name=".PhoneStateReceiver" android:enabled="true">
            <intent-filter>
                <action android:name="android.net.conn.CONNECTIVITY_CHANGE"></action>
            </intent-filter>
        </receiver>
..
    </application>
<!-- Needed to check when the network connection changes -->
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
</manifest> 
```

任何人都知道为什么会发生这种情况或我可能做错了什么？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:28:05.260

我在您的代码中找不到任何明显不正确的内容，所以这是尽力而为。

在您的清单中放置块之后

PVS

# javascript - 字符串比较返回 false。jQuery mobile 的奇怪 javascript 行为

> ID：10154898
> 
> 赞同：5
> 
> 时间：2012-04-14T15:43:20.440
> 
> 标签：javascript, jquery-mobile

为了更好地学习，我开始使用 jQuery mobile 创建一个待办事项列表。我正在听来自这样一个菜单按钮的事件：

```
 me.selectedTarget = me.menuNode.find(".ui-btn").first();

        me.menuNode.on("click", ".ui-btn", function (e) {
            var target =  $(e.currentTarget)
                ,targetText = target.text();
            console.debug("Click on'", targetText,"'" );
            if(target === me.selectedTarget) return;

            if(targetText == "View To Do "){
                core.pub("view:todo");
            } else if(targetText == "View Done ") {
                core.pub("view:done");
            } else {
                me.selectedTarget.click();
            }
            me.selectedTarget = target;
        }); 
```

由于某种原因，变量 targetText 在末尾有一个额外的 " " 空格。我有 3 个按钮，但第三个按钮有点特别——反正不相关。

![此代码侦听的按钮。](../Images/adb92de0e4cfb289fa4ec37828ac09d7.png)

我的问题是我总是使用最后一个 else 子句。targetText 永远不会等于“View To Do”或“View Done”。

为什么不是“查看完成”==“查看完成”？~X(

![firebug 调试结果](../Images/3ef1c7642d14d74ef755582e719b5632.png)

![html 标记](../Images/21a292fdb2b327ed7223d2fb371dbcb4.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-14T15:54:34.460

比较失败，因为字符串不相同。所以问题真的是**为什么**它们不一样？显然，其中一个字符串中的空格不是标准空格字符（Unicode 有多个空格），或者其中一个字符串中有一个不可见的字符（Unicode 也有这些）。

所以要找出发生了什么，我会这样做：

```
var index;
for (index = 0; index < targetText.length; ++index) {
    console.log("char " + index + ": " + targetText.charCodeAt(index));
} 
```

...并且与代码中的字符串文字相同（不是重新键入它，而是将其移动到本地然后输出；因为如果重新键入它，您可能会键入普通空格）。比较字符代码的序列，您会发现差异。

# java - 如何从tomcat自动获取线程转储

> ID：10154910
> 
> 赞同：3
> 
> 时间：2012-04-14T15:45:05.953
> 
> 标签：java, linux, multithreading, shell, monitoring

我们在生产 tomcat 服务器上遇到了一些[线程堆积](https://stackoverflow.com/questions/10052868/tomcat-active-threads-pile-up-and-stalls-the-server)的问题，所以我想设置一些 cron 来定期检查线程转储并在出现问题时发送警报电子邮件。为此，我们需要从 shell 脚本中获取文件中的线程转储，但我无法做到这一点。从 shell 我可以`KILL -3 <PID>`定期发出，但问题是转储转到 catalina.out，其中包含 GB 的数据，因为仅拉出线程转储是一个痛苦的过程。一些讨论线程建议使用“jstack”并将输出重定向到文件，但这也不起作用并给出此错误：

```
-bash-3.2# java -version
java version "1.6.0_26"
Java(TM) SE Runtime Environment (build 1.6.0_26-b03)
Java HotSpot(TM) 64-Bit Server VM (build 20.1-b02, mixed mode)
-bash-3.2# uname -a
Linux ip-10-130-225-20 2.6.16.33-xenU #2 SMP Wed Aug 15 17:27:36 SAST 2007 x86_64 x86_64 x86_64 GNU/Linux

-bash-3.2# sudo /usr/java/jdk1.6.0_24/bin/jstack -F 15668
Attaching to process ID 15668, please wait...
Debugger attached successfully.
Server compiler detected.
JVM version is 19.1-b02
Deadlock Detection:

No deadlocks found.

Thread 8183: (state = BLOCKED)
Error occurred during stack walking:
sun.jvm.hotspot.debugger.DebuggerException: sun.jvm.hotspot.debugger.DebuggerException: get_thread_regs failed for a lwp
    at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal$LinuxDebuggerLocalWorkerThread.execute(LinuxDebuggerLocal.java:152)
    at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.getThreadIntegerRegisterSet(LinuxDebuggerLocal.java:466)
    at sun.jvm.hotspot.debugger.linux.LinuxThread.getContext(LinuxThread.java:65)
    at sun.jvm.hotspot.runtime.linux_amd64.LinuxAMD64JavaThreadPDAccess.getCurrentFrameGuess(LinuxAMD64JavaThreadPDAccess.java:92)
    at sun.jvm.hotspot.runtime.JavaThread.getCurrentFrameGuess(JavaThread.java:256)
    at sun.jvm.hotspot.runtime.JavaThread.getLastJavaVFrameDbg(JavaThread.java:218)
    at sun.jvm.hotspot.tools.StackTrace.run(StackTrace.java:76)
    at sun.jvm.hotspot.tools.StackTrace.run(StackTrace.java:45)
    at sun.jvm.hotspot.tools.JStack.run(JStack.java:60)
    at sun.jvm.hotspot.tools.Tool.start(Tool.java:221)
    at sun.jvm.hotspot.tools.JStack.main(JStack.java:86)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.tools.jstack.JStack.runJStackTool(JStack.java:118)
    at sun.tools.jstack.JStack.main(JStack.java:84)
Caused by: sun.jvm.hotspot.debugger.DebuggerException: get_thread_regs failed for a lwp
    at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal.getThreadIntegerRegisterSet0(Native Method) 
```

这个错误似乎与 java 团队一起开放。

任何其他智能地采取和分析线程转储的建议？或者脚本来解析巨大的 catalina.out 并从中获取线程转储？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T12:45:13.120

查看这篇关于[调度线程转储](http://bwithers.wordpress.com/2007/12/29/schedule-your-own-java-thread-dumps/)的文章。我认为这正是你想要做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T17:00:47.743

另一种选择可能是 JMX - ThreadMXBean。这在 SO 问题[如何通过 JMX 创建线程转储？](https://stackoverflow.com/questions/3958938/how-do-i-create-a-thread-dump-via-jmx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T12:37:34.630

我想出的一种快速方法是（错误）使用[javamelody](http://code.google.com/p/javamelody/)。我们用它来监控应用程序的各个方面，它还提供了查看当前线程的可视化和常用方法，所以我编写了一个小的 shell 脚本来每分钟点击“http://IP:PORT/SERVICE/monitoring?part=threadsDump”在文件中转储响应。如果响应包含任何阻塞的线程脚本将每 5 秒进行一次线程转储。这在一定程度上有所帮助，但是当问题恶化和服务器停止时，javamelody 也会停止响应。

# windows - 如何唯一标识计算机上的操作系统？

> ID：10154912
> 
> 赞同：1
> 
> 时间：2012-04-14T15:45:16.027
> 
> 标签：windows, linux, operating-system

目前，我必须唯一标识计算机上的操作系统。

现在我使用磁盘的序列号和分区号，这意味着操作系统安装在磁盘的该分区中。因为我认为磁盘的一个分区上只能安装一个操作系统。因此，这决定了一个独特的操作系统。

或者，有没有更好的方法来表示它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:48:29.693

*Unique*是一个很滑的概念。假设我制作了 VirtualBox 机器映像，并在我的服务器上运行了五个相同的实例。它们都将具有相同的磁盘序列号和相同的分区 ID。它们应该是相同的，还是不同的？也许您可以将网络地址添加到组合中，这可能是鉴别器。但是，如果它们没有联网怎么办？

还有许多其他可能的灰色区域：我可以在 Linux 系统的同一分区上拥有十几个不同的内核，并在启动时启动我选择的任何一个。这些都应该相同还是不同？

早期版本的 Windows 安装在 DOS 安装之上，您在 DOS 中启动，然后在其之上启动 Windows。那是两个不同的操作系统还是只有一个？

# php - php脚本优化

> ID：10154919
> 
> 赞同：-2
> 
> 时间：2012-04-14T15:45:49.410
> 
> 标签：php

我不是 php 大师，需要你的帮助。

我有一个带有选择菜单的 php 表单。菜单由客户表电子邮件形成。我使用了以下代码：

```
for($i = 0; $i < sizeof($customers_table); $i++){
     echo '<option value="'.$customers_table[$i]['id'].'">'.$customers_table[$i]['email'].'</option>';
} 
```

基数比较大，所以形成期权字段需要时间。有什么办法可以优化脚本，让它运行得更快。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:48:05.843

由于大小不变，请存储它：

```
$size = sizeof($customers_table);
for ($i = 0; $i < $size; $i++) {
    echo '<option value="'.$customers_table[$i]['id'].'">'.$customers_table[$i]['email'].'</option>';
} 
```

然后您可以缩短循环条件并减少数组访问：

```
$i = $size = sizeof($customers_table);
while ($i) {
    $table = $customers_table[$size-$i--];
    echo '<option value="'.$table['id'].'">'.$table['email'].'</option>';
} 
```

下一部分是 echo 语句，它可以在输出之前输出而不是连接字符串：

```
$i = $size = sizeof($customers_table);
while ($i) {
    $table = $customers_table[$size-$i--];
    echo '<option value="', $table['id'], '">', $table['email'], '</option>';
} 
```

如果这有所作为，您需要进行度量。花费的最大时间可能是您发送到浏览器的 HTML 数量。但这超出了本片段的范围。

为了提高代码的整体可读性，我建议使用`foreach`：

```
foreach ($customer_table as $row)
{
    echo '<option value="', $table['id'], '">', $table['email'], '</option>';
} 
```

这通常也很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:08:32.120

正如安迪所说，以这种方式优化这个脚本并不是一个好主意。如果你想要显着的时间变化，你必须重新考虑这个问题。

你有一个客户列表，如果有时间问题，我假设有很多。因此，下拉列表对用户来说毫无用处。

还有其他更有效的解决方案：

*   使用某种缓存 > 您的 html 代码将始终相同，因此您只需执行一次循环，当您添加、删除或更新客户时，并将 html 代码存储在脚本或数据库中。因此，每次重新加载页面时，您只需检索 html 代码。
*   不要加载所有[客户](http://jqueryui.com/demos/autocomplete/)

这些解决方案最适合优化，如果您将它们结合起来（缓存和自动完成超过 3 个键入的字符），那么用户体验也会更好。

# node.js - 将 Ember.js 与 Node.js 集成（Express+Tower.js）

> ID：10154921
> 
> 赞同：7
> 
> 时间：2012-04-14T15:46:05.440
> 
> 标签：node.js, express, ember.js, towerjs

[我正在寻找将 Ember.js 与 Node.js+ Express](http://expressjs.com/) + [Tower.js](http://towerjs.org/)集成的解决方案。

我刚开始研究 Tower.js（最后几个小时），看起来该框架提供了一个很好的结构来放置服务器端和客户端代码（类似于 Rails 中的资产文件夹）。

由于一切都在 Javascript 中，我可以放置 Ember 应用程序代码：

1.  完全在客户端，即在第一次请求时发送所有内容。
2.  只提供最初需要的东西，其余的只应要求提供。

在第二种解决方案中，可以在服务器上渲染视图并发送纯 HTML。

还有 Ember 的应用程序逻辑（控制器、模型、状态……）。怎样才能更好的与服务端Javascript（如node.js+Express+Tower.js）集成，从而尽量减少重复代码。在理想情况下，您定义每个模型/控制器/等一次，并在服务器和客户端上使用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-14T23:33:59.283

我们正在将 Ember.js 集成到 Tower.js 的核心中，这是从一开始就计划好的。

*   [https://github.com/viatropos/tower/blob/development/test/cases/support/emberTest.coffee](https://github.com/viatropos/tower/blob/development/test/cases/support/emberTest.coffee)

还没有。但接下来会发生。

Ember 目前在 Node.js 和浏览器中工作，Tower 也是如此。服务器上的控制器将像 Rails 一样使用 Web 套接字添加。客户端上的控制器将像在服务器上一样工作，*并且*与 Ember 一样，具有 Web 套接字支持 - 仍在充实这一点。

# python - Python中的约束线性回归

> ID：10154922
> 
> 赞同：20
> 
> 时间：2012-04-14T15:46:11.253
> 
> 标签：python, numpy, scipy, mathematical-optimization, linear-regression

我有一个[经典的线性](http://en.wikipedia.org/wiki/Linear_regression)回归问题，形式如下：

`y = X b`

其中`y`，*响应向量* `X`是输入变量的*矩阵*`b`，是我正在搜索的拟合参数向量。

Python 提供`b = numpy.linalg.lstsq( X , y )`了解决这种形式的问题。

但是，当我使用它时，我倾向于为`b`.

我想执行相同的拟合，但将值限制`b`在 0 到 255 之间。

看起来`scipy.optimize.fmin_slsqp()`是一个选项，但我发现它对于我感兴趣的问题的大小非常慢（`X`类似于`3375 by 1500`并且希望更大）。

1.  是否有任何其他 Python 选项可用于执行约束最小二乘拟合？
2.  或者是否有用于执行[套索回归](http://en.wikipedia.org/wiki/Least_squares#LASSO_method)或岭回归或其他一些惩罚大`b`系数值的回归方法的 python 例程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-14T15:53:34.163

最近的 scipy 版本包括一个求解器：

[https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.lsq_linear.html#scipy.optimize.lsq_linear](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.lsq_linear.html#scipy.optimize.lsq_linear)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-30T10:55:41.467

你提到你会发现套索回归或岭回归是可以接受的。[scikit-learn](http://scikit-learn.org/)包中提供了这些和许多其他受约束的线性模型。查看[广义线性模型部分](http://scikit-learn.org/dev/modules/classes.html#module-sklearn.linear_model)。

通常约束系数涉及某种正则化参数（C 或 alpha）——一些模型（以 CV 结尾的模型）可以使用交叉验证来自动设置这些参数。您还可以进一步约束模型以仅使用正系数——例如，在 Lasso 模型上有一个选项。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-15T11:21:09.943

[SO 上的 scipy-optimize-leastsq-with-bound-constraints](https://stackoverflow.com/questions/9878558/scipy-optimize-leastsq-with-bound-constraints) 给出了 minimumsq_bounds，这是[scipy leastsq](http://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html#least-square-fitting-leastsq) + 绑定约束，例如 0 <= x_i <= 255。
（Scipy leastsq 包装了 MINPACK，这是广泛使用的 [Levenberg的几种实现之一—— Marquardt 算法](http://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm) 又名阻尼最小二乘。
有多种实现边界的方法；我认为 leastsq_bounds 是最简单的。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-04T00:41:40.223

我最近准备了一些[关于 Python 中的线性回归的教程](https://apmonitor.com/me575/index.php/Main/LinearMultivariateRegression)。这是包含对系数的约束的选项之一（Gekko）。

```
# Constrained Multiple Linear Regression
import numpy as np
nd = 100 # number of data sets
nc = 5   # number of inputs
x = np.random.rand(nd,nc)
y = np.random.rand(nd)

from gekko import GEKKO
m = GEKKO(remote=False); m.options.IMODE=2
c  = m.Array(m.FV,nc+1)
for ci in c:
    ci.STATUS=1
    ci.LOWER = -10
    ci.UPPER =  10
xd = m.Array(m.Param,nc)
for i in range(nc):
    xd[i].value = x[:,i]
yd = m.Param(y); yp = m.Var()
s =  m.sum([c[i]*xd[i] for i in range(nc)])
m.Equation(yp==s+c[-1])
m.Minimize((yd-yp)**2)
m.solve(disp=True)
a = [c[i].value[0] for i in range(nc+1)]
print('Solve time: ' + str(m.options.SOLVETIME))
print('Coefficients: ' + str(a)) 
```

它使用非线性求解器`IPOPT`来解决比`scipy.optimize.minimize`求解器更好的问题。Python 中还有其他约束优化方法以及[是否有适用于 Python 的高质量非线性规划求解器中的讨论？](https://scicomp.stackexchange.com/questions/83/is-there-a-high-quality-nonlinear-programming-solver-for-python).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-20T02:19:32.173

正如@conradlee 所说，您可以在[scikit-learn](https://scikit-learn.org/stable/)包中找到 Lasso 和 Ridge Regression 实现。如果您只想让拟合参数变小或为正，这些回归量可以满足您的目的。

但是，如果您想将任何其他范围作为拟合参数的界限，您可以使用相同的包构建自己的受约束回归器。有关示例，请参见 David Dale[对此问题的回答。](https://stackoverflow.com/questions/50410037/multiple-linear-regression-with-specific-constraint-on-each-coefficients-on-pyth)

# asp.net-mvc - 带有附加字段的远程验证 >> 又一个 POST？

> ID：10154924
> 
> 赞同：1
> 
> 时间：2012-04-14T15:46:23.547
> 
> 标签：asp.net-mvc, jquery

我有一个 ASP.NET MVC3 解决方案。我使用远程验证来检查用户名是否已经存在。

在第一阶段，我使用以下验证属性：

```
[Required, Remote("UserNameAlreadyExists", "User", Error="Already exists!"]
public string UserName { get; set; } 
```

这是运行时的跟踪：

![在此处输入图像描述](../Images/3ddab3dbbeaf823d77e5d0b6646db2d6.png)

然后我意识到我需要传递额外的字段（userID）来验证，因此我这样做：

```
[Required, Remote("UserNameAlreadyExists", "User", AdditionalFields="UserID", Error="Already exists!"]
public string UserName { get; set; } 
```

这是运行时的跟踪：

![在此处输入图像描述](../Images/e482f6e99dc31d86cbadb5e712827d9c.png)

你会看到还有一个 POST ？！

为什么？Tt 在我的情况下是个问题。这让我发疯。

谢谢你的帮助。

* * *

更新

这是我的 Edit.cshtml 的代码

```
@using (Html.BeginForm())
{
    @Html.HiddenFor(m => m.UserID)

    @Html.LabelFor(m => m.UserName)                     
    @Html.TextBoxFor(m => m.UserName)
    ...
    <input type="submit" value="Submit">
} 
```

这是javascript代码

```
 $('form', dialog).submit(function () {
        // Do not submit if the form does
        // not pass client side validation
        if (!$(this).valid()) {
            writeError("Validation failed!");
            return false;
        }

        // On the line below: I retrieve the POST url + serialize all submitted data from my form
        $.post($(this).attr('action'), $(this).serialize(), function (data, status) {
              ...
              ...
        }).error(function (error, status, a, b) {
            alert('Error!');
        });
        // Unbind form submitting
        $('form', dialog).unbind();
        return false;
    }); 
```

当我调试我的代码（一步一步）时，我可以注意到几点：

*   表单被我的 jquery 函数提交并拦截
*   UserAlreadyExists 被触发（为什么？）。在这个函数中（在第二行）我有： var user = _requestServiceClient.GetUserFromUserName(userName); 当踩到这条线时，我突然进入了编辑的后期动作。奇怪的！？稍后，它退回到函数 UserAlreadyExists。还是很奇怪！？

我不知道问题是否出在我的代码中，或者我的 jquery.validate.min.js 版本是否已过时且存在错误或其他问题......

我注意到，如果我不使用任何 AdditionalFields，我就没有任何问题！！

我还注意到，如果我触发 UserAlreadyExists 自愿（通过专注于该领域），我在提交（发布）时没有任何问题！

**因此，当显示 Edit 表单且 UserName 字段未聚焦时，我遇到了问题！然后我提交，问题来了**

谢谢。

# performance - OpenCL 函数 length() 和 fast_length() 有什么区别？

> ID：10154925
> 
> 赞同：1
> 
> 时间：2012-04-14T15:46:25.510
> 
> 标签：performance, opencl, gpgpu

在[此 OpenCL 参考表](http://r00tsecurity.org/db/cheat-sheets/Programming/OpenCL/opencl-quick-reference-card.pdf)（断开的链接）的第三页上，有两个具有相同参数的内置向量长度函数：`length()`和`half_length()`.

**这些功能有什么区别？**我从名字中收集到一个比另一个“更快”但在什么情况下？它是否会为了提高速度而牺牲准确性？如果不是，为什么要使用`length()`over `fast_length()`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T21:09:53.927

根据 OpenCL 规范（1.1 版，第 215 页）：

*   `float length(floatn p)`: 返回向量的长度`p`，即`sqrt(p.x²+p.y²+...)`

*   `float fast_length(floatn p)`：返回向量的长度`p`计算为`half_sqrt(p.x²+p.y²+...)`

所以`fast_length`用`half_sqrt`，而`length`用`sqrt`。正如您所猜测的那样`sqrt`，对准确性有更好的保证，但可能会更慢。更重要的是：

*   最小精度`sqrt`：3ulp（最小精度单位）

*   最小精度`half_sqrt`：8192ulp

    所以`half_sqrt`可以降低大约 11 位的准确度`sqrt`（实际上它可以降低 13 位的准确度，因为没有要求不比`sqrt`严格必要的更好）。由于`float`尾数为`23bit`（加上一个隐式位）`half_sqrt`，因此只能保证大约 10 位的精度（11 位包括隐式 1）。但是，如果硬件具有这样的功能，它可能会更快。在硬件中，指令仅提供少量位（如 10-14）并在指令后使用 Newton-Raphson 迭代以获得必要的精度并不`sqrt`罕见`rsqrt`。在这种情况下，使用`half_sqrt`显然更快。

# c# - MVC3 Razor Code Soup - 模板？

> ID：10154927
> 
> 赞同：1
> 
> 时间：2012-04-14T15:47:10.157
> 
> 标签：c#, asp.net-mvc-3, templates, razor

我正在尝试创建我的导航器以在某些页面上显示突出显示。我有以下内容：

```
<li>
    @if (Request.Url.AbsoluteUri.ToLowerInvariant().Contains("registration"))
    {
        @Html.ActionLink("Request an Invite", "index", "registration", null, new { @class = "active" })
    }
    else
    {
        @Html.ActionLink("Request an Invite", "index", "registration")
    }
</li>
<li>
    @if (Request.Url.AbsoluteUri.ToLowerInvariant().Contains("login"))
    {
        @Html.ActionLink("Login", "index", "login", null, new { @class = "active" })
    }
    else
    {
        @Html.ActionLink("Login", "index", "login")
    }
</li> 
```

我确定有更好的方法可以减少这种汤汁？有人可以帮助初学者吗？

谢谢詹姆斯伍德利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T15:55:28.213

在我看来，为了避免潜在的类似网址出错，您可以使用

```
var contorller = @ViewContext.RouteData.Values["controller"]
var action = @ViewContext.RouteData.Values["action"] 
```

然后为了使您的代码更小，我将使用内联条件

```
@Html.ActionLink("Request an Invite", "index", "registration", null, (controller = "Home" && action == "registration") ? new { @class = "active" } : null) 
```

我希望你能明白

# ruby - Pow、RVM 和 ZSH 不能一起工作

> ID：10154928
> 
> 赞同：9
> 
> 时间：2012-04-14T15:47:10.407
> 
> 标签：ruby, rvm, zsh, rack-pow

我正在尝试让 Octopress (http://octopress.org/) 工作，但我遇到了一些问题。我正在使用 POW (http://pow.cx/)，它似乎没有为我加载正确的 Ruby 版本（使用 RVM）。

它始终使用 RVM 默认的 ruby​​ 版本，而不是 .rvmrc 中指定的版本。我在 RVM 中的默认 Ruby 版本是：ruby-1.9.3-p125。

在我的 .rvmrc 文件中，我有这个：`rvm use 1.9.2` 访问我的网站时，我在浏览器中收到此错误：

```
LoadError: cannot load such file -- bundler/setup
~/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
~/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
~/Sites/Lejnus/lejnus/config.ru:1:in `block in <main>'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/builder.rb:4:in `instance_eval'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/builder.rb:4:in `initialize'
~/Sites/Lejnus/lejnus/config.ru:1:in `new'
~/Sites/Lejnus/lejnus/config.ru:1:in `<main>'
~/Library/Application     Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:50:in `eval'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:50:in `load_config'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:43:in `initialize'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:13:in `new'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:13:in `run'
~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/bin/nack_worker:4:in `<main>' 
```

为什么在我的 .rvmrc 文件中指定 1.9.2 时使用 1.9.3-p125？如果我将 1.9.2 设置为默认值，它当然可以工作......

它不应该为我做这个魔术并使用正确的红宝石版本吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-14T17:20:10.950

好的，看起来 POW 正在远离 RVM。

我需要在我的项目根目录中运行它以使其正常工作： `rvm env . -- --env > .powenv`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T13:27:33.350

我已经通过在项目的根目录添加一个 .powrc 来对问题进行排序，代码如下

```
if [ -f "$rvm_path/scripts/rvm" ] && [ -f ".rvmrc" ]; then
  source "$rvm_path/scripts/rvm"
  source ".rvmrc"
fi 
```

[**编辑添加：**这是在[Pow 文档](http://pow.cx/manual.html#section_2.3.2)中推荐的]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T11:48:08.433

这就是为我解决问题的方法：

`rvm env -- `rvm current` > .powenv`

您还可以创建一个*rvm 挂钩*（[如此处评论](https://gist.github.com/2493622#gistcomment-334136)），以便在更改当前 ruby​​ 环境时自动切换 .powenv：

```
# ~/.rvm/hooks/after_use_update_powrc
对于 `ls ~/.pow/` 中的文件；做
  POW_LINK_TARGET=`readlink ~/.pow/$file`

  如果 [ `pwd` = $POW_LINK_TARGET ]; 然后
    rvm env -- ``rvm current`` > .powenv
  菲
完毕

```

不要忘记使其可执行：

`chmod +x ~/.rvm/hooks/after_use_update_powrc`

# iphone - 仅使用渲染缓冲区（没有帧缓冲区）来绘制屏幕外内容？

> ID：10154931
> 
> 赞同：0
> 
> 时间：2012-04-14T15:47:28.550
> 
> 标签：iphone, opengl-es, textures, framebuffer

我是否必须为我创建的每个渲染缓冲区生成并绑定一个帧缓冲区？或者是否有机会仅创建渲染缓冲区（并将其映射到纹理或以某种方式提交给 sahders）？

我只想渲染到一个通道缓冲区以创建一些掩码以供以后使用。我认为设置一个完整的帧缓冲区将是这项任务的开销。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-14T16:15:16.470

渲染缓冲区只是一个图像。您不能将一个绑定为纹理；如果你想创建一个图像用作纹理，那么你需要创建一个*纹理*。这就是我们有渲染缓冲区和纹理的原因：其中之一是用于您*不*打算从中读取的内容。

帧缓冲区是图像的*集合*。您不能渲染到渲染缓冲区或纹理；您渲染到*framebuffer*，它本身必须有渲染缓冲区和/或附加到它们的纹理。

您可以渲染到默认帧缓冲区或帧缓冲区对象。默认帧缓冲区中的图像不能用作纹理。因此，如果要渲染到纹理，则必须使用帧缓冲区对象。这就是 OpenGL 的工作原理。

“设置完整的帧缓冲区”可能会涉及开销，但如果要渲染到纹理，则必须这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T15:56:23.500

您可以改用模板缓冲区，然后禁用模板测试，直到您准备好屏蔽输出。

**编辑：** 查看 opengl 文档中的以下调用：

```
glClearStencil
glClear(GL_STENCIL_BUFFER_BIT)
glEnable(GL_STENCIL_TEST)
glDisable(GL_STENCIL_TEST)
glStencilFunc
glStencilOp 
```

[http://www.opengl.org/sdk/docs/man/xhtml/glStencilFunc.xml](http://www.opengl.org/sdk/docs/man/xhtml/glStencilFunc.xml)
[http://www.opengl.org/sdk/docs/man/xhtml/glStencilOp.xml](http://www.opengl.org/sdk/docs/man/xhtml/glStencilOp.xml)
[http://developer.nvidia。 com/system/files/akamai/gamedev/docs/stencil.pdf?download=1](http://developer.nvidia.com/system/files/akamai/gamedev/docs/stencil.pdf?download=1)

# php - 将 php 函数而不是文件传递给 jquery $post 方法

> ID：10154932
> 
> 赞同：0
> 
> 时间：2012-04-14T15:47:47.780
> 
> 标签：php, jquery, ajax, json

我昨天开始学习jquery，所以我不太好。

我有一个问题：

作为标题，有一种方法可以将 php 函数而不是文件传递给 jquery $.post 方法吗？

这是我要做的一个例子：

```
function send(str)
{
    $.post
    ( 
        "<?php PHPfunction(); ?>",
        {send:str},  
        function(data)
        {
           $("#output-text").html(data.reply);
        },
           "json"
    );
} 
```

有办法吗？或者我需要总是将文件传递给第一个参数？

只是另一个问题：

如何在 ajax 回复中将超过 1 行从 php 传递到 jquery？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:51:30.413

您需要使用 AJAX 来请求该功能。有关详细信息，请参阅[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)。Google 还可以为您提供大量示例，因为您要问的是一个相当普遍的问题，有很多好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:49:58.553

PHP 在页面完全加载之前在服务器上运行，因此您不能像那样动态调用 PHP 函数。之后，Javascript 在客户端机器上的浏览器中运行。它们是两个独立的环境，代码方面。

你最好调用一个使用该函数的页面，使用 Ajax 或其他东西。

# android - isProviderEnabled(LocationManager.NETWORK_PROVIDER) 返回 false

> ID：10154937
> 
> 赞同：13
> 
> 时间：2012-04-14T15:47:58.007
> 
> 标签：android, locationmanager, android-location

我用`NETWORK_PROVIDER`得到`latitude`和`longitude`的地方。

我已经检查了“位置和安全”中的设置并启用“使用无线网络”。但`"isProviderEnabled(LocationManager.NETWORK_PROVIDER)"`总是返回`false`。

谁能帮我？先感谢您！

这是我的代码：

```
LocationManager locManager=(LocationManager) getSystemService(Context.LOCATION_SERVICE);
boolean isEnableGPS=locManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
boolean isEnableNTW=locManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
Log.d(TAG, isEnableGPS+", "+isEnableNTW); 
```

AndroidMainfest.xml 中的权限

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-13T22:13:34.173

确保在手机设置中启用了基于网络的位置。您可以检测到这种情况并在您确实需要时提示用户启用它。

我相信这是启动此活动的代码行。

```
activity.startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS); 
```

[ACTION_LOCATION_SOURCE_SETTINGS](http://developer.android.com/reference/android/provider/Settings.html#ACTION_LOCATION_SOURCE_SETTINGS)

这篇文章解释它[http://emobiledude.com/fix-waiting-for-location-in-google-maps-after-android-4-2-update/](http://emobiledude.com/fix-waiting-for-location-in-google-maps-after-android-4-2-update/)

![Android 4.0 位置访问设置](../Images/753b0b3002c4cce1a8c6207fc4abc24b.png)

# android - Kindle 的“主页”按钮会触发什么事件？

> ID：10154943
> 
> 赞同：0
> 
> 时间：2012-04-14T15:48:40.707
> 
> 标签：android, kindle-fire

Kindle Fire 在底部有一个栏，其中包括一个“主页”按钮和一个“返回”按钮。

当我单击“返回”按钮时，我的应用程序的“onPause()”事件被调用。

当我单击“主页”按钮时，我的应用程序崩溃了。将显示一个 Android 对话框。它说我的应用程序意外停止。我看到了一个“强制关闭”按钮。

Sooooo 我需要处理什么事件来防止这种情况发生。这只发生在我的应用程序上，而不是我下载的应用程序，所以是的，是我，哈哈。

*编辑*

根据[这个网页](http://terokarvinen.com/2011/lifecycle-code-example-android-oncreate-onpause-onresume)，我在应用程序中添加了事件和祝酒词，只是为了深入了解事情的运作方式。当我单击后退按钮时，我看到由 onPause()、onStop() 和 onDestroy() 方法生成的 toast。当我单击主页按钮时，没有祝酒词，只有崩溃。

**解析度**

Akhil 建议我查看 logcat。我不运行模拟器，因为我的机器似乎不足以进行 Android 开发（或者我对模拟器的期望过高）；启动它需要很长时间。无论如何，在弄清楚如何运行模拟器之后（第一次看logcat，哈）我看到我抛出了一个与序列化相关的异常。我现在要去解决它。感谢 Akhil 朝着正确的方向踢球！

啊，当我单击 Home 时，模拟器*确实*显示了*onPause()* toast，所以现实仍然按预期运行。

**最终的**

该错误与我为使*onSaveInstanceState(Bundle savedInstanceState)*方法工作而添加的序列化有关。基本上，我的应用程序（以及我转换为 android 的旧游戏）不可序列化，因此*onSavedInstanceState()*中的这段代码无法编译：

```
savedInstanceState.putSerializable(GAME, game); 
```

'game' 是无害的，所以我在 Game 的类定义中添加了“implements Serializable”。但是，我忽略了将其添加到 Game 中的私有类中。这就是导致异常的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:07:45.510

由于安全漏洞，无法在 android 中拦截主页按钮。可用的一个选项是覆盖 onStop，当您按下主页按钮并关闭应用程序时调用它：-

```
@Override
    protected void onStop() 
    {
        super.onStop();
        //do whatever you want here
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:18:55.390

当您单击“**返回**”按钮时，您的应用程序的“ `onPause(), onStop(),onDestroy()`”事件将被调用。

当您单击“**主页**”按钮时，您的应用程序的“ `onPause(), onStop()`,”事件将被调用。

（这是一个一般场景，假设）将日志语句放入您的`onPause(), onStop()`并查看您在哪里得到错误。

# php - 使用 2 个文本字段将多个图像上传到数据库

> ID：10154946
> 
> 赞同：0
> 
> 时间：2012-04-14T15:49:08.113
> 
> 标签：php, mysql, html, image, file-upload

好吧，我有一个难题。我希望能够将最多六个图像和 2 个文本字段（标题和描述）上传到数据库中......实际上让我纠正自己，我想将图像的名称存储在数据库中，这样我就可以得到稍后的照片。我知道如何将多张图片上传到一个文件夹，我知道如何将行插入数据库，但我不知道如何将两者结合起来。如果其中一个文件有问题，我将如何将其与图像工作结合起来，取消整个过程？

我的数据库设置只是 id | 标题 | 描述 | 图片1 | 图片2 | 图片3 | 图片4 | 图片5 | img6

到目前为止我写的代码是：

```
if (isset($_POST['formsubmitted'])) { //if form was submitted
$error = array();//Declare An Array to store any error message  

if (empty($_POST['title'])) {//if no name has been supplied 
    $error[] = 'Please enter a title for your post.';//add to array "error"
    $show_errors = 'show';
} else {
    $title = $_POST['title'];//else assign it a variable
}

if (empty($_POST['desc'])) {
    $error[] = 'Please enter a short desc of your post.';//add to array "error"
    $show_errors = 'show';
} else {
    $desc = $_POST['desc'];//else assign it a variable
}

    if (empty($error)){ //if no error, insert into db

$new_post = "INSERT INTO `posts` ( `title`, `desc`) VALUES ( '$title', '$desc')";
    $result = mysql_query($new_post ) or die(mysql_error('error inserting post'));

}

} 
```

那么html是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<?php if (isset($show_errors)) { 
    //show user the errors if form cant be submitted
    echo '<div> <ol>';
        foreach ($error as $key => $values) { echo '    <li>'.$values.'</li>'; }
        echo '</ol></div><br />'; }?>

<br />
<form method="post" id="newpost" action="" enctype="multipart/form-data">
<div><input name="title" type="text" value="" class="title_input"></div>
<div><textarea id="area4" cols="40" rows="5" name="desc" class="desc_texbox"></textarea></div>
<div><input type="file" name="images1"></div>
<div><input type="file" name="images2"></div>
<div><input type="file" name="images3"></div>
<div><input type="file" name="images4"></div>
<div><input type="file" name="images5"></div>
<div><input type="file" name="images6"></div>
<input type="hidden" name="formsubmitted" value="TRUE" />
<input type="submit" id="upload" value="Upload">
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:49:03.723

这绝不是完成，但它应该让你朝着正确的方向前进。请注意，我是根据更改文件字段来重命名的，`<input type="file" name="images[1]" />`以便将它们作为数组处理。

```
<?php

error_reporting(E_ALL);
ini_set('display_errors', true);

$db = new PDO('mysql:dbname=test;host=127.0.0.1', 'user', 'pass');

if (isset($_POST['formsubmitted'])) { //if form was submitted

    $error_array = array();//Declare An Array to store any error message

    // check all images for upload errors
    // you should probably add extra file validation here - check image type etc
    $upload_error = false;
    foreach($_FILES['images']['error'] as $error) {
        if ($error != 0 && $error != 4) {
            $upload_error = true;
        }
    }

    if ($upload_error) {
        $error_array[] = 'One of the image uploads failed!';
    }

    if (empty($_POST['title'])) {//if no name has been supplied
        $error_array[] = 'Please enter a title for your post.';//add to array "error"
    } else {
        $title = $_POST['title'];//else assign it a variable
    }

    if (empty($_POST['desc'])) {
        $error_array[] = 'Please enter a short desc of your post.';//add to array "error"
    } else {
        $desc = $_POST['desc'];//else assign it a variable
    }

    if (empty($error_array)){ //if no error, insert into db

        $new_post = "INSERT INTO `posts` ( `title`, `desc`) VALUES (?, ?)";
        $stmt = $db->prepare($new_post);
        $stmt->execute(array($title, $desc));

        $new_post_id = $db->lastInsertId();

        // now start processing the images
        $image_sql = "INSERT INTO `post_images` (`post_id`, `img_name`) VALUES (?, ?)";
        $stmt = $db->prepare($image_sql);

        for ($i = 1; $i <= 6; $i++) {

            // you need to add some code to vlaidate, move and rename the files

            // add the files to the db
            $file_name = $_FILES['images']['name'][$i];
            $stmt->execute(array($new_post_id, $file_name));

        }

    } else {
        print_r($error_array);
    }

}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:10:49.687

我觉得比较好，先把图片上传到服务器，如果 move_uploaded_file() 函数返回错误，在 $error 数组中添加一个值。这样，只有上传成功，数据才会插入数据库。

# html5-appcache - 强制多个用户删除他们的应用缓存

> ID：10154948
> 
> 赞同：0
> 
> 时间：2012-04-14T15:49:27.997
> 
> 标签：html5-appcache

> **可能重复：**
> [我的 HTML5 应用程序缓存清单正在缓存所有内容](https://stackoverflow.com/questions/9287044/my-html5-application-cache-manifest-is-caching-everything)

我制作了一个可以缓存的 webapp，但是缓存产生了很多问题，所以我需要它们全部清除缓存。

这可以在我的服务器上自动完成吗？

这些选项会起作用吗？

*   更改`<html manifest="cache.appcache">`为`<html>`
*   从服务器中删除`cache.appcache`文件
*   在所有资源之上添加`NETWORK:`标题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T13:34:59.670

根据规范，前两个选项应该可以完成工作。因为当清单无法访问时，浏览器应该删除所有缓存的数据。

[https://stackoverflow.com/a/8817490/1482507](https://stackoverflow.com/a/8817490/1482507)

# c++ - 这个函数怎么可能是一个重载的运算符？

> ID：10154949
> 
> 赞同：0
> 
> 时间：2012-04-14T15:49:34.540
> 
> 标签：c++, operator-overloading, assignment-operator, data-conversion

这是一个程序，用于转换具有包含日期​​的字符串的对象和具有 3 个整数的另一个对象：日期、月份和年份。

```
class date
{
private:
char dt[9];

public: 
//constructors and functions....
};

class dmy
{
private: 
int day,mth,yr;

public:
//constructors..

  operator date()   // This is what my question is about
  {
   char temp[3],str[9]
   itoa(day,str,10)
   strcat(str,"/");
  itoa(mth,temp,10);
  strcat(str,temp)
  strcat(str,"/");
  itoa(yr,temp,10);
  strcat(str,temp);

  return (date(str));
  }

};

int main
{
 date d1;
 dmy d2(17,11,94);

 d1=d2;

 //display d1's and d2's data
 return 0; 
} 
```

我的困惑在于操作员 date() 部分。日期怎么可能是运营商？不应该重载 = 运算符来执行此转换吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T15:54:50.293

这种形式的函数

```
operator T() { /*return an object of type T*/ } 
```

称为用户定义的转换函数，当`T`任何表达式中需要一个类型的对象时，它会被隐式调用。

在您的情况下，用户定义的转换函数被定义为将 type 对象隐式转换为 type`dmy`对象`date`。

```
void f(date dt);

dmy dmyObj; 

date dateObj = dmyObj; //ok. conversion function is invoked implicitly
f(dmyObj); //ok. conversion function is invoked implicitly 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:52:29.117

```
operator date() 
```

是一个**[转换函数](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/cplr385.htm)**，在您的代码`date`中需要一个`dmy`类型而使用一个类型时，将隐式调用这个运算符来创建一个`date`类型并使用它。

# html - 外部 div 的高度不随内部 div 扩展

> ID：10154950
> 
> 赞同：18
> 
> 时间：2012-04-14T15:49:55.547
> 
> 标签：html, css

我有一个 100% 宽度的 bodyMain div。里面是一个带有自动边距的body div 800px（我可以使用'body'作为id吗？）。这里面有两个 div bodyLeft 和 bodyRight 分别为 200px 和 600px 宽。当我将内容添加到内部 div 时，bodyMain 和 body 都不会在 height 上扩展。所有高度都是自动的。

这是代码：http: [//jsfiddle.net/TqxHq/18/](http://jsfiddle.net/TqxHq/18/)

HTML：

```
<body>
    <div id="bodyMain">
      <div id="body">
        <div id="bodyLeft"> left text goes here<br />
        </div>
        <div id="bodyRight">Right text goes here
        </div>
      </div>
    </div>
</body> 
```

CSS：

```
#bodyMain{
    border:1px solid red;
    width:100%;
    height:auto;

}
#body{
    border:1px solid green;
    width:804px;
    height:auto;
    margin:auto;
}
#bodyLeft{
     border:1px solid blue;
    float:left;
    width:200PX;
    height:auto;
}
#bodyRight{
    border:1px solid orange;
    float:right;
    width:600PX;
    height:auto;
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-14T15:52:17.573

您必须添加

```
<div style="clear:both;"></div> 
```

在浮动 div 结束时解决此问题。看 [这里](http://jsfiddle.net/TqxHq/20/)

当浮动元素位于容器框内并且元素不会自动强制容器的高度调整为浮动元素时，就会出现问题。当一个元素浮动时，其父元素不再包含它，因为浮动已从流中移除。您可以使用 2 种方法来修复它：

```
clear:both
clearfix 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-14T15:55:55.170

这是使用浮点数时的常见问题。有几个常见的解决方案：

1.  使用 clear: both 在浮动后添加一个 div

2.  将两个浮点数添加到具有 CSS 属性的容器中`overflow: auto`

3.  使父元素浮动

4.  将 :after CSS 伪元素与 CSS 一起使用：`.clearfix:after {content: "."; display: block; height: 0; clear: both; visibility: hidden;}`

5.  向父元素添加设置高度

[看这篇文章](http://www.positioniseverything.net/easyclearing.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-05T07:28:57.030

简单的解决方案是让外部 div 溢出：隐藏（在样式属性中）。

谢谢

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T16:00:13.723

为避免与预定义的标记名称混淆，请避免使用`body`、`html`或`head`作为 ID 属性值。

我同意 Muhammed Irfan 的想法。不过我不同意他的方法。避免使用内联样式，除了小片段。尤其是在这种情况下，因为很可能会有另一种情况`clear: both`是必要的。所以，添加一个 div，给它一个有意义的类名并应用额外的 CSS。

有关示例，请参[见此小提琴。](http://jsfiddle.net/TqxHq/24/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-14T16:04:54.173

## *[jsFiddle 演示](http://jsfiddle.net/dt5NR/)*

```
*{
    margin:0;
    padding:0;
}

#bodyMain{
    position:relative;
    overflow:hidden; /*added*/
    border:1px solid red;
    /*removed height:auto;*/
    /*removed width:100%;*/
}
#body{
    display:table;/*added*/
    border:1px solid green;
    width:804px;
    margin: 0 auto; /*improved*/
}
#bodyLeft{
    border:1px solid blue;
    float:left;
    width:200px;
    /*removed height:auto;*/
}
#bodyRight{
    border:1px solid orange;
    float:right;
    width:600px;
    /*removed height:auto;*/
} 
```

# php - 使用外键合并两个数据库时的 SQL 问题

> ID：10154953
> 
> 赞同：1
> 
> 时间：2012-04-14T15:50:10.070
> 
> 标签：php, mysql, sql, foreign-keys, merging-data

我在工作区 A 和工作区 B 有一个数据库。在线有这个数据库的副本，它总是从两个工作区更新。此外，每当另一个工作区进行任何更改时，两个工作区都可能需要更新其数据库。

一切都运行良好，但我的问题是：例如有 2 个表`Stock`，`Orders`其中`Orders`有一列是`stock_id`.

如果工作区 A 创建一个具有自动递增“stock_id”=23 的新“Stock X”，并且工作区 B 创建一个具有自动递增“stock_id”=23 的新“Stock Y”，则工作区 B 将添加工作区 A 的“Stock X”并且工作区 B 将添加工作区 B 的“库存 Y”，但每个数据库中的每个都有不同的 id。

当工作区A在stock_id = 23即“Stock X”上下订单时会出现问题，当此查询发送到中央数据库，然后发送到工作区B时，它将插入订单，但stock_id = 23将引用“敦实”。

我真的很感谢一些帮助谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:03:25.337

如果工作区 A 和 B 每个都有不同的 ID 23 条目，那么您唯一的选择是在将记录更新到中央数据库时为每个条目创建一个辅助键。然后，当您更新它们时，可以将该密钥重新复制回工作区数据库，这将允许使用真正唯一的标识符访问它们的项目。

但是，我强烈建议您不要使用此方法！

正确的做法是创建一个用于工作区 1 和 2 的 Web 或桌面应用程序，该应用程序将连接到中央数据库并将其用于所有数据访问。良好的数据库设计通常意味着尽可能少地复制数据。通过在三个不同的数据库中运行多个订单、库存等副本，您正在为将来的数据损坏和/或丢失做好准备——随着数据库的增长，这个问题只会变得越来越难以修复尺寸。在数据库变得更大之前修复结构问题！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T16:35:46.743

编辑：

您的原始设计使用`AUTO INCREMENT`列作为主键。这样做的问题是，正如您所看到的，当您将数据同时进入最终将合并的单独数据库时，您最终会创建重复的键。

一种替代方法是在每个不同的数据库中使用一个序列。不幸的是，序列在 mysql 中本身并不可用（许多其他数据库，如 Oracle、db2 确实有它们——它们允许这种类型的分布式数据库插入而不会发生冲突）。 `AUTO INCREMENT`列不允许您想要的复制类型。

所以，你有两个选择。

1）添加设置 location_id 的主键的额外部分（根据第一个答案）。

2）或者使用您自己的序列手动为您的插入生成您的ID，而不是使用`AUTO INCREMENT`列。

最好将序列实现为存储的过程/函数，当它获得序列中的下一个值时提交自身——这可能最终导致值不被使用。这很好——如果你要等到整个插入提交之前提交一个序列号，这比争用要好。

主要的是，当您进行第一次插入时，您使用存储过程中的序列 #。当您有效地将数据复制到第二个数据库中时，您可以在原始数据库的行中使用生成的序列 #。并且序列将在每个单独的数据库中维护，并具有不同的起点，以防止冲突。

例如，在每个数据库中，您需要两个部分：

1) 一个表，其中包含每个命名序列的下一个可用序列号。（每个从序列中获取主键的表都会得到一个条目）。2) 使用下一个序列号访问和更新该表的函数。

一个示例实现将是：

序列表：

```
CREATE TABLE sequences (
  name varchar(30) NOT NULL,
  value int(10) unsigned,
  PRIMARY KEY (name)
) ENGINE=InnoDB 
```

序列函数：

```
delimiter //
create function get_next_value(p_name varchar(30)) returns int
  deterministic
  sql security invoker
begin
  declare current_val integer;
    UPDATE sequences
    SET value = (@current_val:=value) + 1
    WHERE name = p_name;

  return @current_val;
end //
delimiter ; 
```

主要问题是存储的函数需要是单个语句，以便它完成并因此立即提交（否则，您将锁定它，这将导致您的事务在订单进入时相互堆叠。如果您没有很高的吞吐量，这不是什么大问题。

这个函数不是我写的——我是从这里随意复制的：http: [//www.bigdbahead.com/?](http://www.bigdbahead.com/?p=185) p=185 我会向你推荐，以获取更多详细信息。（如果那个用户在这里找到我，我很乐意让他写一个答案并在这里给他适当的信用）。

现在，对于每个数据库，您使用不同的数字初始化值以避免冲突。因此，对于`orders`位置 A 中的表，您可以使用以下命令对其进行初始化：

```
insert into sequences ('orders', 1); 
```

在位置 B，您将使用以下命令对其进行初始化：

```
insert into sequences ('orders', 1000000); 
```

然后在两个数据库中，在插入`orders`时，你会这样做：

```
insert into orders (order_id, . . .)
select mysql.get_next_value('user_id'), . . . <hardcoded-values> 
```

--

我还没有对这个解决方案进行路试——把它作为我在关于序列的回答中所建议的内容的大纲。您应该跟进上面的博客条目链接，它提供了更多详细信息，特别是关于如何在事务控制下工作，请参阅评论（我从评论中获取了函数的形式，而不是原始函数） ，当然，在负载下测试它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T09:44:18.463

我想到了这个答案，但我仍然很困惑，如果它比上面的其他解决方案更好。工作区 B 中的所有查询都在本地数据库上立即执行，也发送到中央数据库，然后发送到工作区 A，但是工作区 A 上的查询不会立即在本地数据库上执行，它们被发送到中央数据库然后中央数据库将它们发送到工作区 B，当工作区 B 执行这些查询时，它会通知中央，然后通知工作区 A，然后它可以执行存储的查询。因此，工作区 B 可以正常执行其查询，但工作区 A 仅在知道工作区 B 何时执行这些查询时才允许执行其查询，因为在工作区 B 执行 A 的查询之前，它会发送自己的新查询查询，然后执行 A 的查询，所以在 A 被通知 B 执行了它的查询之后，它检查 B 是否发送了它自己的任何新查询并执行它们，然后它执行它自己的查询。这样，所有自动递增的 id 在两个工作区中都是相同的。例子：

工作区 A：

```
 q1= insert into stock (name) values ('A')    not executed

         q2= insert into stock (name) values ('B')    not executed 
```

A的数据库：（空）

工作区 A 将 q1 和 q2 发送到中央，正在等待中央确认 B 已执行这些查询，以便它可以自己执行它们

工作区 B：

```
 q3= insert into stock (name) values ('C')    executed id=1

         q4= insert into stock (name) values ('D')    executed id=2 
```

B 的数据库： (1,'C') , (2,'D')

Workspace B 将 q3 & q4 发送到 central 后，收到 q1 和 q2 的通知，

工作区 B 执行 q1 & q2

```
 q1= insert into stock (name) values ('A')   executed id=3

          q2= insert into stock (name) values ('B')   executed id=4 
```

数据库 B: (1,'C') , (2,'D'), (3,'A') , (4,'B')

工作区 A 被通知 B 已经执行了它的 q1 & q2，但它被告知它必须先执行 q3 & q4 才能执行 q1 & q2

工作区 A：

```
 q3= insert into stock (name) values ('C')    executed id=1

          q4= insert into stock (name) values ('D')    executed id=2

          q1= insert into stock (name) values ('A')    executed id=3

          q2= insert into stock (name) values ('B')    executed id=4 
```

B 的数据库： (1,'C') , (2,'D'), (3,'A') , (4,'B')

# android - 如果android在创建时杀死，避免数据库损坏

> ID：10154954
> 
> 赞同：0
> 
> 时间：2012-04-14T15:50:42.333
> 
> 标签：android, sqlite, lifecycle

并提前感谢！

我想知道如果 android 杀死你的应用程序会发生什么，如果此时你正在创建数据库结构。就我而言，创建数据库需要一段时间，因为要插入很多元素（大约 20/25 秒）。如果用户认为“我要在邮件结束时检查我的邮件”并将我的应用程序置于后台，android 将能够杀死该应用程序（如文档所述）¿如何避免它？此时，datacase 从 AsyncTask 创建以不阻塞用户界面... ¿您如何看待这个（可能的）问题？

再次感谢，问候！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T16:14:27.660

使用 SQLite 事务！它不仅可以加快数据库操作，还可以避免数据库损坏的危险。

# perl - 计数到标量值

> ID：10154955
> 
> 赞同：-1
> 
> 时间：2012-04-14T15:51:07.037
> 
> 标签：perl, for-loop, foreach, counting, scalar

所以我有一个`foreach`循环：

```
foreach (1..10) {
    print "#", $t, "\n";
 } 
```

但我也有一个标量：

```
$number = 5; 
```

我可以像这样从 1 数到标量吗？

```
 foreach (1..$number) {
    print "#", $t, "\n";
 } 
```

当我这样做时，程序什么也不输出。我能做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T15:58:30.760

***脚本：***

```
#!/usr/bin/perl

use strict;
use warnings;

my $number = 5;

foreach (1..$number) {
  print "#$_\n";
} 
```

或者

```
#!/usr/bin/perl

use strict;
use warnings;

my $number = 5;

print "#$_\n" for 1..$number; 
```

***输出：***

```
#1
#2
#3
#4
#5 
```

# java - 使用 ANT 从 jar 库中加载 java premain-class

> ID：10154957
> 
> 赞同：2
> 
> 时间：2012-04-14T15:51:17.690
> 
> 标签：java, class, ant, jar

是否可以从打包在 jar 库中的 jar 库中加载 premain-class？我有以下设置：

我的图书馆的比赛：

```
# jar -tf myLibrary.jar
META-INF/
META-INF/MANIFEST.MF
agent/
agent/myAgent.jar
com/
com/package/
com/package/subpackage/
com/package/subpackage/A.class
com/package/subpackage/B.class
com/package/subpackage/C.class 
```

现在在我的 MANIFEST.MF 中，我想使用类似的东西：

```
Manifest-Version: 1.0
Premain-Class: com.agentpackage.AgentClass
Class-Path: agent/myAgent.jar 
```

但不幸的是，如果我“使用”这个设置，`-javaagent:myLibrary.jar`它会给我以下错误消息：

```
java.lang.ClassNotFoundException: com.agentpackage.AgentClass
FATAL ERROR in native method: processing of -javaagent failed 
```

是否可以在 .jar 文件中访问 premain-class？

myLibrary.jar 的（截断的）ANT 构建文件：

```
<jar destfile="myLibrary.jar" update="true">
    <zipfileset dir="lib" includes="myAgent.jar" prefix="agent" />
    <manifest>
        <attribute name="Class-Path" value="agent/myAgent.jar" />
        <attribute name="Premain-Class" value="com.agentpackage.AgentClass" />      
    </manifest>
</jar> 
```

我知道我可以做到以下几点：

```
<jar destfile="myLibrary.jar" update="true">
    <zipgroupfileset dir="lib" includes="myAgent.jar" />
    <manifest>
        <attribute name="Premain-Class" value="com.agentpackage.AgentClass" />
    </manifest>
</jar> 
```

但随后 myAgent.jar 的内容在 myLibrary.jar 中被夸大了，这不是我想要的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T09:11:50.167

Java 不支持加载嵌套的 jar。

您必须使用膨胀版本或将这两个 jar 放在同一个文件夹中并相应地更新类路径。

# ios - iOS：如何检测抖动运动？

> ID：10154958
> 
> 赞同：24
> 
> 时间：2012-04-14T15:51:28.137
> 
> 标签：ios, shake

我将以下代码添加到我的 appDelegate.m

```
- (void)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event
{
}

- (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event
{
    if (motion == UIEventSubtypeMotionShake )
    {
        // User was shaking the device. Post a notification named "shake".
        [[NSNotificationCenter defaultCenter] postNotificationName:@"shake" object:self];
    }
}

- (void)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event
{   
}

- (void)shakeSuccess
{
    // do something...
} 
```

然后我补充说：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    // INIT THE BACKGROUND PATH STRING

    [self refreshFields];
    [self.window addSubview:navController.view];
    [self.window makeKeyAndVisible];
    ***[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(shakeSuccess) name:@"shake" object:nil];***

    return YES;
} 
```

当我在 iPhone 上启动我的应用程序时，不会调用名为“shakeSuccess”的方法。我应该怎么做才能在我的应用程序中实现这个功能？任何想法？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-14T15:55:29.903

这可能会帮助你......
[https://stackoverflow.com/a/2405692/796103](https://stackoverflow.com/a/2405692/796103)

他说你应该将`UIApplication`'s设置`applicationSupportsShakeToEdit`为 `YES`. 并覆盖 VC 中的 3 个方法：

```
-(BOOL)canBecomeFirstResponder {
    return YES;
}

-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    [self becomeFirstResponder];
}

- (void)viewWillDisappear:(BOOL)animated {
    [self resignFirstResponder];
    [super viewWillDisappear:animated];
} 
```

您的其余代码都很好。( `-motionEnded:withEvent:`)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-04-01T22:46:09.320

你可以做这样的事情......

首先...

**在 App 的 Delegate 中设置 applicationSupportsShakeToEdit 属性：**

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {

    application.applicationSupportsShakeToEdit = YES;

    [window addSubview:viewController.view];
    [window makeKeyAndVisible];
} 
```

第二...

**在视图控制器中添加/覆盖 canBecomeFirstResponder、viewDidAppear: 和 viewWillDisappear: 方法：**

```
-(BOOL)canBecomeFirstResponder {
    return YES;
}

-(void)viewDidAppear:(BOOL)animated {
   [super viewDidAppear:animated];
   [self becomeFirstResponder];
}

- (void)viewWillDisappear:(BOOL)animated {
    [self resignFirstResponder];
    [super viewWillDisappear:animated];
 } 
```

第三...

**将 motionEnded 方法添加到您的视图控制器：**

```
- (void)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event
{
   if (motion == UIEventSubtypeMotionShake)
   {
    // your code
   }
 } 
```

如果第一个答案没有，那应该可以工作，而且这只是快速输入而不是测试:)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-05-21T09:44:49.063

如果您希望能够检测整个应用程序的抖动运动，最好的方法是使用自定义类覆盖您的应用程序的类。

然后在您的自定义应用程序类中实现它

```
@implementation PSApplication

- (void)sendEvent:(UIEvent *)event
{
    if ( event.type == UIEventTypeMotion && event.subtype == UIEventSubtypeMotionShake ) {
        [[NSNotificationCenter defaultCenter] postNotificationName:@"shakeNotification" object:nil];
    }

    [super sendEvent:event];
}

@end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-05T09:15:44.620

我扩展了 UIApplication 类并添加了对 main 的类引用：MyApplication.h

```
@interface MyApplication : UIApplication

@end 
```

我的应用程序.m

```
@implementation MyApplication

- (void) sendEvent:(UIEvent *)event
{
    if( event && (event.subtype==UIEventSubtypeMotionShake))
    {
        AppDelegate *objAppDelegate = (AppDelegate *)[UIApplication sharedApplication].delegate;

        [objAppDelegate doWhatEver];
        [super sendEvent:event];
    }
    else
    {
        [super sendEvent:event];
    }
}

@end 
```

以及 main.m 中的最后一步

```
int main(int argc, char *argv[])
{
return UIApplicationMain(argc, argv, NSStringFromClass([MyApplication class]), NSStringFromClass([AppDelegate class]));
} 
```

这适用于所有情况。

# java - 卡尺@Param 不工作

> ID：10154959
> 
> 赞同：0
> 
> 时间：2012-04-14T15:51:29.260
> 
> 标签：java, microbenchmark, caliper

我正在尝试`@Param`在具有以下形式的命令行参数的字段上使用注释：“-Dmyparamname=val1,val2,val3”，但它不起作用。我正在使用 caliper-0.5-rc1.jar。我的实际用法如下：

```
java -classpath "mylongclasspath" MyBenchmarkClass -Jjit=-client,-server -Dprovider=CGLIB,JAVASSIST,JAVAPROXY 
```

我的基准课程有以下内容：

```
public class MyBenchmarkClass extends SimpleBenchmark {
    @Param
    private String provider;

    ...
} 
```

但是当我运行时，我只能获得 jit 的选项，而不是 -Dprovider：

```
 0% Scenario{vm=java, trial=0, benchmark=M1, jit=-server} 30.40 ns; ?=0.13 ns @ 3 trials
 17% Scenario{vm=java, trial=0, benchmark=M2, jit=-server} 31.42 ns; ?=0.08 ns @ 3 
```

等等，最终用“jit=-client”重复所有的基准测试

我本来希望看到：

```
 0% Scenario{vm=java, trial=0, benchmark=M1, jit=-server provider=CGLIB} ...etc. 
```

我尝试了各种选项：包括命令 arg 中值的引号，在内部将它们作为 List 类型的静态字段提供等。从来没有任何迹象表明它正在尝试迭代提供的“提供者”值。

关于我做错了什么有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T04:42:50.620

看起来 0.5-rc1 构建（Maven Central 中唯一的东西）是问题所在。我从另一个项目中刷了一个初步的 1.0 构建（我不想下载整个项目和 Maven 并构建它）。

# java - 寻找一种翻转比迪（希伯来语）文本的方法，以便在 AndEngine 中正确显示

> ID：10154961
> 
> 赞同：3
> 
> 时间：2012-04-14T15:51:32.503
> 
> 标签：java, android, andengine, bidi

几天来，我一直在网上潜伏，试图寻找一种代码实现（最好是 Java）来翻转 Bidi 文本，以便它可以在不支持 Bidi 文本的平台内正确显示。（如AndEngine）。

最佳解决方案是一种方法，我会向它提供希伯来语文本，它会返回翻转的内容。我可以自己做到这一点，但是一旦混合了英语和希伯来语文本的字符串，它就会变得复杂，而且我认为实现它对我来说会很愚蠢，因为可能已经有更好的实现了。

我发现最接近的是这个 Unicode 算法 -

[http://www.unicode.org/reports/tr9/](http://www.unicode.org/reports/tr9/)

[http://www.unicode.org/Public/PROGRAMS/BidiReferenceJava/](http://www.unicode.org/Public/PROGRAMS/BidiReferenceJava/)

这太复杂了，太大了，并没有完成所有的工作。

Java中还有这个Bidi类

[http://docs.oracle.com/javase/7/docs/api/java/text/Bidi.html](http://docs.oracle.com/javase/7/docs/api/java/text/Bidi.html)

但它只提供了简单的方法来分析 Bidi 文本。

我很确定这是一个常见问题，因为不幸的是许多平台和游戏引擎并不完全支持双向文本。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T11:25:56.090

试试[重症监护室](http://apps.icu-project.org/apiref/icu4j/)

ICU 是一套成熟的、广泛使用的软件应用程序集`C/C++`并`Java libraries`为软件应用程序提供 Unicode 和全球化支持。

ICU 具有广泛的可移植性，并在所有平台和`C/C++`&之间为应用程序提供相同的结果`Java software`。

或者

[GNU FriBidi](http://fribidi.org/) for c++

# c - C 如何正确测量时间？

> ID：10154962
> 
> 赞同：7
> 
> 时间：2012-04-14T15:52:01.413
> 
> 标签：c, performance, algorithm, time, measurement

这是“算法”，但是当我想测量执行时间时，它给了我零。为什么？

```
#define ARRAY_SIZE 10000
...

clock_t start, end;

start = clock();

for( i = 0; i < ARRAY_SIZE; i++) 
{
non_parallel[i] = vec[i] * vec[i];
}
end = clock();
printf( "Number of seconds: %f\n", (end-start)/(double)CLOCKS_PER_SEC ); 
```

那么我应该怎么做才能测量时间呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-14T15:59:40.400

两件事情：

1.  `10000`在现代计算机上并不多。因此，该循环可能会在不到一毫秒的时间内运行 - 小于`clock()`. 因此它将返回零。

2.  如果您不使用`non_parallel`编译器可能会优化整个循环的结果。

最有可能的是，您只需要一个更昂贵的循环。尝试增加到`ARRAY_SIZE`更大的东西。

* * *

**这是在我的机器上进行的具有更大数组大小的测试：**

```
#define ARRAY_SIZE 100000000

int main(){

    clock_t start, end;

    double *non_parallel = (double*)malloc(ARRAY_SIZE * sizeof(double));
    double *vec          = (double*)malloc(ARRAY_SIZE * sizeof(double));

    start = clock();

    for(int i = 0; i < ARRAY_SIZE; i++) 
    {
        non_parallel[i] = vec[i] * vec[i];
    }

    end = clock();
    printf( "Number of seconds: %f\n", (end-start)/(double)CLOCKS_PER_SEC );

    free(non_parallel);
    free(vec);
    return 0;
} 
```

**输出：**

```
Number of seconds: 0.446000 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T15:59:18.047

这是一种实际计时秒数的不可靠方法，因为该`clock()`函数的精度非常低，并且您的循环没有做很多工作。你可以让你的循环做得更多，让它运行得更久，或者使用更好的计时方法。

更高精度的方法是特定于平台的。对于 Windows，请参阅[如何使用 QueryPerformanceCounter？](https://stackoverflow.com/questions/1739259/how-to-use-queryperformancecounter)对于 linux，请参阅[C++ 和 Linux 的高分辨率计时器？](https://stackoverflow.com/questions/538609/high-resolution-timer-with-c-and-linux)

# c++ - r 值引用返回类型语义？

> ID：10154963
> 
> 赞同：9
> 
> 时间：2012-04-14T15:52:07.620
> 
> 标签：c++, c++11, rvalue-reference

像这样的返回类型在 c++11 中是否代表有意义的东西？

```
template <typename R>
R&& grabStuff();

T instance = grabStuff<T>(); 
```

如果没有移动构造函数，我希望`grabStuff`应该抛出编译时错误，因为这似乎不允许返回类型使用复制构造函数`R`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T16:20:00.127

与往常一样，在返回引用时，您必须返回对函数返回后仍然存在的东西的引用。你如何做到这一点取决于你。例子：

```
T global_thing;

T && get() { return std::move(global_thing); }

struct Foo { Foo(T &&); /* ... */ };

int main()
{
    global_thing.reset();
    Foo a(get());
    global_thing.reset();
    Foo b(get());
} 
```

然而，返回右值引用的更典型的例子是`std::move`它本身，它返回对你传递*给*它的东西的引用（因此调用者有责任提供有效的输入）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-15T02:53:39.693

如果函数的返回类型是一个右值引用，那么函数调用的结果就是一个xvalue；如果返回类型是非引用，则函数调用的结果是纯右值。

xvalue 和 prvalue 都是右值，它们之间存在一些细微差别，更像是参考和非参考之间的区别。例如，一个 xvalue 可能有一个不完整的类型，而一个纯右值通常应该有一个完整的类型或 void 类型。当 typeid 应用于类型为多态类类型的 xvalue 时，结果引用动态类型；对于纯右值，结果是指静态类型。

对于您的声明语句`T instance = grabStuff<T>();`，如果 T 是类类型，我认为在这种情况下 xvalue 和 prvalue 没有区别。

初始值设定项是一个右值，因此编译器更喜欢移动构造函数。但是如果没有声明move构造函数，并且声明了一个带有const引用参数的拷贝构造函数，那么就会选择这个拷贝构造函数，并且不会出错。我不知道你为什么希望这是一个错误。如果这是一个错误，那么在从右值复制初始化某个对象时，任何旧代码都会不正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T16:01:41.523

它可能是有意义的，这取决于你想用它做什么，以及你是如何实现这个功能的。

实际上，`std::move`返回类型是`T&&`(rvalue reference) 是有意义的，因为它定义了存在`std::move`于 C++11 库中的目的：

*   [标准::移动](http://en.cppreference.com/w/cpp/utility/move)

# jquery - jQuery如何在多个随机丢弃事件后触发一个函数？

> ID：10154970
> 
> 赞同：-2
> 
> 时间：2012-04-14T15:52:35.437
> 
> 标签：jquery, jquery-ui, event-handling, drag-and-drop

我有一个带有打印按钮的拖放项目，一个按原样打印页面（在用户拖放任何内容之前），另一个我在加载时使用 JavaScript 禁用。在所有可拖动对象被删除后，如何激活第二个按钮？

```
$(document).ready(function() {
    $(".ui-widget-content").draggable({ revert: 'invalid', cursor: 'move', snapTolerance: '0px' }), 
    $("#dropcrown").droppable({ accept: '#crown'});
    $( "#dropneck" ).droppable({ accept: '#neck' });
    $( "#dropback" ).droppable({ accept: '#back' });
    $( "#droptail" ).droppable({ accept: '#tail' });
    $( "#dropwing" ).droppable({ accept: '#wing' });
    $( "#dropeye" ).droppable({ accept: '#eye' });
    $( "#dropbeak" ).droppable({ accept: '#beak' });
    $( "#dropcheek" ).droppable({ accept: '#cheek' });  
    $( "#dropbreast" ).droppable({ accept: '#breast' });
    $( "#dropbelly" ).droppable({ accept: '#belly' });
    $( "#dropfoot" ).droppable({ accept: '#foot' });
     $('#button2', this).attr('disabled', 'disabled');
     $('#button2', this).addClass( "ui-state-disabled" );
                });

            $(document).ready(function() {
        $( "#dropcrown, #dropneck ,#dropback, #droptail, #dropwing, #dropeye, #dropbeak, #dropcheek, #dropbreast, #dropbelly, #dropfoot" ).droppable({tolerance:'touch',
            drop: function( event, ui ) {
                $( this )
                    .addClass( "ui-state-highlight" );
                        var dropped = ui.draggable;
            var droppedOn = $(this);
            $(dropped).detach().css({top: 15,left: 7}).appendTo(droppedOn);
            $('#button', this).attr('disabled', 'disabled');
            $('#button', this).addClass( "ui-state-disabled" );

            }
        });
    });
    $(document).ready(function() {
        if($('#labels').html() == ""){
            $('#button2', this).removeAttr('disabled', 'disabled');
            $('#button2', this).removeClass( "ui-state-disabled" );
  //do something
}
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:00:47.360

jQuery UI`Droppable`有一个[`drop`事件](http://jqueryui.com/demos/droppable/#event-drop)。将它挂在 droppables 上，当您看到事件时，请查看您要从中取出它们的容器。是空的吗？触发您想要触发的代码（例如，启用按钮）。

# java - 引用正则表达式中的先前匹配组

> ID：10154973
> 
> 赞同：5
> 
> 时间：2012-04-14T15:52:45.420
> 
> 标签：java, android, regex

我是 Android 编码的新手，但我有使用 Perl 正则表达式的经验。我需要将 0 个或多个标识符的列表与正则表达式匹配，例如：

```
^\s*((\w\d\d\d)(\s+$2)*)?$ 
```

注意 $2 指的是前一个匹配组 (\w\d\d\d) 对于 android 代码，它看起来像：

```
Pattern.compile("^\\s*((\\w\\d\\d\\d)(\\s+\$2)*)?$") 
```

Eclipse 编译器不编译 \$2，我也试过 \2，它编译但试图匹配文字数字 2。

蛮力解决方案是重复标识符模式：

```
Pattern.compile("^\\s*((\\w\\d\\d\\d)(\\s+(\\w\\d\\d\\d))*)?$") 
```

它可以工作，但有以下缺点： * 在任何重复中都容易产生语法错误 * 随着标识符变得更加复杂，字符串变得大 * 它不优雅 * 如果您需要不引用，则变得更加复杂一场但几场之前的比赛

Java中有没有办法在正则表达式中引用以前匹配的组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:07:05.020

请记住，不仅`$`需要被转义，而且`\`本身也需要被转义！

所以你需要：

```
Pattern.compile("^\\s*((\\w\\d\\d\\d)(\\s+\\$2)*)?$") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T10:56:45.690

我对混乱感到抱歉，我的混乱。正则表达式：

```
Pattern.compile("^\\s*((\\w\\d\\d\\d)(\\s+\\$2)*)?$") 
```

将匹配“A12 A12”之类的内容，因此匹配上一个匹配项。（我只是在 Eclipse 上尝试过，然后用调试器跟踪它）

我想要的是一种为“A12 B35 C36 A011”之类的字符串编写简短正则表达式的方法在perl中，您可以使用变量作为模式的一部分，因此可以在perl中完成：

```
$a='\w\d\d\d';
$mystring =~ /^\s*(($a(\s+$a)*)?$/; 
```

简短而简单。因此我假设在java中它也可以通过连接字符串来完成（我刚刚尝试过它并且它有效）

```
String id="\\w\\d\\d\\d";
Pattern.compile("^\\s*(" + id + "(\\s+" + id + ")*)?$"); 
```

它并不优雅，但它可以完成工作。

# c - 创建检查 x + y 是否会使用按位运算溢出的方法

> ID：10154975
> 
> 赞同：2
> 
> 时间：2012-04-14T15:53:28.480
> 
> 标签：c, methods, overflow, bit-manipulation, addition

我需要使用按位运算在 C 中创建一个方法，该方法检查 x + y 是否会溢出。我最多只能使用以下操作中的 20 个；！~ & ^ | + << >> 请记住，我必须同时测试负数和正数。

我已经尝试了好几次让它工作。我的逻辑合理吗？我要去：如果（x + y）小于x，那么它已经溢出。基于这个逻辑，我写了这个；

```
int addOK(int x, int y)
{
  int sum = x + y;
  int nx = ((~x) + 1);
  int check = (sum + nx)>>31;
  return !check;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T16:09:26.193

这应该有效，但它不仅使用按位运算符，而且适用于有符号的：

```
int addOK(int x, int y)
{
  int check;
  if (greaterThan(0, x^y)) 
    check = 0; 
  else if (greaterThan(x, 0)) 
    check = greaterThan(y, INT_MAX -x);
  else 
    check = greaterThan(INT_MIN -x, y);

  return check;
}

int greaterThan(int first, int second) {
   /* first > second means second - first is less than 0
      shift the sign bit and then compare it to 1 */
   return (second + (~first +1)) >> ((sizeof(int) * 8) -1) & 1;
} 
```

如果这两个数字都是正数就足够了：

```
int addOK(int x, int y) {
 if(x^y < 0)
   return 0;

 return 1;
} 
```

# c++ - 带有继承的c++向量

> ID：10154977
> 
> 赞同：7
> 
> 时间：2012-04-14T15:53:36.200
> 
> 标签：c++, inheritance, vector

参考代码：

```
#include <vector>
#include <iostream>

class Func {
public:
    virtual void call() {
        std::cout<< "Func -> call()" << std::endl;
    }
};

class Foo : public Func {
public:
    void call() {
        std::cout<< "Foo -> call()" << std::endl;
    }
};

class Bar : public Func {
public:
    void call() {
        std::cout<< "Bar -> call()" << std::endl;
    }
};

int main(int argc, char** argv) {
    std::vector<Func> functors;

    functors.push_back( Func() );
    functors.push_back( Foo() );
    functors.push_back( Bar() );

    std::vector<Func>::iterator iter;
    for (iter = functors.begin(); iter != functors.end(); ++iter)
        (*iter).call();
} 
```

运行该代码时，它会在我的计算机上产生以下输出：

```
$ ./test
Func -> call()
Func -> call()
Func -> call() 
```

有什么方法可以确保在这种情况下调用正确的虚函数？我是 C++ 新手，但我最好的猜测是：

```
(*iter).call(); 
```

它被投射到一个`Func`物体上。它是否正确？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-14T15:57:04.220

您应该使用 shared_ptr 或 unique_ptr 来保存多态类型集合的元素。

现在编写代码时， Foo 和 Bar 实例被强制（复制构造）到 Func 类型的实例中以适应向量。（原因是向量通过固定大小的值立即存储其元素以提高性能，但是多态子类的大小在编译时未知，因此它只能存储基类。）

这个更好：

```
int main(int argc, char** argv) {
    vector<shared_ptr<Func>> functors;

    functors.push_back( make_shared<Func>() );
    functors.push_back( make_shared<Foo>() );
    functors.push_back( make_shared<Bar>() );

    for (auto functor : functors)
        functor->call();
} 
```

在上面，引用计数指针用于在向量中隐式共享 Func 的异构子类。（此间接允许通过地址间接存储任意大小的 Func 子类。）

此外，您可能想看看 std::function 和 std::bind，而不是滚动您自己的仿函数类型。

要查看的另一件事是完美的转发和可变模板。

**更新**：对于旧编译器：

```
int main(int argc, char** argv) {
    vector<std::tr1::shared_ptr<Func> > functors;

    functors.push_back( std::tr1::make_shared<Func>() );
    functors.push_back( std::tr1::make_shared<Foo>() );
    functors.push_back( std::tr1::make_shared<Bar>() );

    for (size_t i = 0; i < functors.size(); ++i)
        functors[i]->call();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-14T15:57:21.613

向量仅`Func`按值保存类型，这意味着您的所有时间`Foo`和`Bar`被切片并转换为基本`Func`类型

您需要更改为类似`std::vector< Func* >`并动态分配派生类实例以使多态调度工作

如果您完全确定在此函数返回后不会将此向量传递给其他函数，作为优化，您可能希望在堆栈中分配实例：

```
std::vector< Func* > v;
Bar b;
Foo f;
v.push_back( &b);
v.push_back( &f); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T15:57:19.410

您的 std::vector 正在存储 Func 对象-这意味着当您调用

```
functors.push_back( Foo() );
functors.push_back( Bar() ); 
```

您正在创建对象，`Foo`然后`Bar`在将这些对象复制到`Func`对象时“切片”它们。

如果您想以多态方式使用 Foo 和 Bar，那么更典型的模式是存储某种指针类型的向量（尽管最好**不是**“原始”指针），例如

`std::vector< std::unique_ptr<Func> >`

`std::vector< std::shared_ptr<Func> >`

或者，如果你真的必须......（但前提是你使用的是没有 shared_ptr 或 unique_ptr 的旧编译器）

`std::vector< Func* >`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-14T15:58:00.433

在 C++ 中，多态性仅适用于指针和引用，而向量直接存储对象的实例。当您调用`push_back`的复制构造函数`Func`被调用时，它会构建`Func`存储在向量内的对象。

这称为对象切片，您可以通过 StackOverflow 中的快速搜索了解更多信息。

解决方案是存储指向对象的指针（或者更好的是*智能*指针），这些对象应该分配到其他地方（可能在堆上）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T15:59:49.280

通常，子类的实例可能大于其超类的实例，因此您不应期望子类适合您的向量槽。

并且`push_back`可能会在内部调用一个复制构造函数（`Func`类的，因为你有`vector<Func>`）所以内部向量槽确实`Func`不属于其他一些类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-14T15:59:28.340

你的问题是你有一个向量`Func`，但是方法只能通过引用或指针多态地调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-28T11:28:48.880

有一种非常简单的方法可以在不使用指针的情况下创建向量，方法是创建将继承 A 类和 B 类的子类

```
#include <iostream>
#include <vector>

using namespace std;

struct BASE {
    string name = "Base class ";
};

struct A : BASE {
     string a = " class a ";
};

struct B : BASE {
     string b = " class b ";
};

struct C : A, B{
    //using base name from A or B// yeah is hardcoded
    string name = A::name;
};

int main()
{

    C c;
    c.a = "s";
    c.b = "h";
    vector<C> vec;

    vec.push_back(c);
    c.b = "j";
    vec.push_back(c);

    cout << vec[0].a << endl;
    cout << vec[0].b << endl;
    cout << vec[0].name << endl;

    cout << vec[1].a << endl;
    cout << vec[1].b << endl;
    cout << vec[1].name << endl;

    return 0;
} 
```

# sqlite - 确定 SQLite 3 数据库是否为只读 - 不使用 sqlite3_db_readonly()

> ID：10154978
> 
> 赞同：2
> 
> 时间：2012-04-14T15:54:09.673
> 
> 标签：sqlite

我需要知道我打开的 SQLite 数据库是否是只读的。我必须使用稍微过时的 SQLite 版本，其中还没有 sqlite3_db_readonly()。sqlite3_db_readonly() 的实现使用私有调用，因此无法复制到客户端代码中。除了在打开之前检查文件是否可写之外，还能做什么？

编辑：版本是 3.7.0.1。

编辑 2：我正在使用合并。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T11:33:25.293

您可能已经掌握了`sqlite3`“数据库连接句柄”对象。它在[sqliteInt.h](http://www.sqlite.org/cgi/src/artifact/d9e42f2029d4c526f9ba960bda1980ef17429c30)中定义：

```
struct sqlite3 {
  sqlite3_vfs *pVfs;            /* OS Interface */
  int nDb;                      /* Number of backends currently in use */
  Db *aDb;                      /* All backends */
  int flags;                    /* Miscellaneous flags. See below */
  int openFlags;                /* Flags passed to sqlite3_vfs.xOpen() */
  int errCode;                  /* Most recent error code (SQLITE_*) */
  int errMask;                  /* & result codes with this before returning */ 
```

然后，您可以`openFlags`针对`O_RDWR`.

```
#define O_RDONLY        00000000
#define O_WRONLY        00000001
#define O_RDWR          00000002 
```

当然，这与 newer 不同`sqlite3_db_readonly()`，但在您的上下文中可能就足够了。

**编辑**

跟进您的评论，您可以执行以下操作来“面向未来”您的代码：

*   检查结构是否`sqlite3`在 3.7.0.1 和支持的第一个版本之间变化`sqlite3_db_readonly()`
*   由于在 sqlite3.h 中定义，使用一些宏将结构的正确副本`sqlite3`（或 的正确偏移量`openFlags`）映射到相应的 3.xyz 版本。`SQLITE_VERSION_NUMBER`
*   从支持`sqlite3_db_readonly()`调用它的版本开始。

请注意，如果数据库的文件只能以读取方式打开，则无论是否使用 sqlite3_open_v2 函数，数据库都将以只读方式打开`SQLITE_OPEN_READONLY`。因此，除了上述之外，`openFlags`您还需要单独验证文件是否可以只读方式打开。C API`xAccess`在`sqlite3_vfs`结构中提供函数。我猜无论您的应用程序是否已经锁定了 db 文件，这项工作都有效。有关更多信息，请参见 [http://www.sqlite.org/c3ref/vfs.html](http://www.sqlite.org/c3ref/vfs.html)。

# javascript - 在 MVC3 中使用 Javascript 调用操作方法并返回新视图

> ID：10154980
> 
> 赞同：1
> 
> 时间：2012-04-14T15:54:31.477
> 
> 标签：javascript, jquery, asp.net-mvc-3, actionmethod

我有一个场景，我需要使用 javascript 使用参数调用操作方法并呈现操作方法返回的视图。我已经看到了调用 action 方法并更新部分视图的示例。但是我正在尝试执行操作方法和新视图，可以这样做吗？请帮忙。谢谢

```
function OnRowSelect(e) {
        var form = $(this);
        var taskInstanceUid = e.row.cells[13].innerHTML;
        var so = e.row.cells[12].innerHTML;
        var tabText;
     $.ajax({
            type: 'POST',
            cache: false
        })
         .success(function (result) {
               $.post("OrderInformation", { taskInstanceUid: taskInstanceUid });
       }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:00:50.313

如果你要更新整个视图，你不能直接将用户引导到返回视图的 URL 吗？

```
<script type="text/javascript">
window.location.href = "http://yourdomain.com/controller/action/?parameter1=something";
</script 
```

# optimization - GLSL 着色器中 cos() 和 sin() 函数的速度？

> ID：10154984
> 
> 赞同：18
> 
> 时间：2012-04-14T15:54:38.853
> 
> 标签：optimization, opengl, glsl, shader, jogl

我对*Open GL Shader Language*`sin()`的速度和`cos()`相关信息感兴趣。

 *[GLSL 规范文档](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.40.05.pdf)指出：

> 内置函数基本上分为三类：
> 
> *   ...
> *   ...
> *   它们代表一个操作图形硬件可能会在某个时候加速。三角函数属于这一类。

**编辑：**

正如已经指出的那样，计算单个操作的时钟周期`sin()`并`cos()`不能真正说明整个性能故事。

因此，为了澄清我的问题，我真正感兴趣的是是否值得优化`sin()`并`cos()`呼吁常见案例。

例如，在我的应用程序中，参数为`0`. 那么这样的事情是否有意义：

```
float sina, cosa;

if ( rotation == 0 )
{
   sina = 0;
   cosa = 1;
}
else
{
   sina = sin( rotation );
   cosa = cos( rotation );
} 
```

或者`GLSL`编译器或`sin()`和`cos()`实现会为我处理这样的优化吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-14T19:46:40.750

> 例如，在我的应用程序中，参数为 0 是很常见的。所以这样的事情是否有意义：

不。

你的编译器会做两件事之一。

1.  它将发出一个实际的条件分支。在最好的情况下，如果 0 是一个局部一致的值（这样着色器组通常会一起达到 0 或非零值），那么您*可能会*获得改进的性能。
2.  它将评估条件的*双方*，并且只存储其中正确一方的结果。在这种情况下，你一无所获。

一般来说，使用条件逻辑来围绕这样的小型表演跳舞并不是一个好主意。它需要非常大才有价值，比如 a`discard`或其他东西。

另外，请注意浮点等价不太可能起作用。除非您实际上将包含 0.0 的统一或顶点属性传递给着色器，否则不会。即使在 0 和非零之间进行插值也可能永远不会为任何片段产生精确的 0。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-06T06:23:18.267

这是一个很好的问题。我也想知道这一点。

自 2005 年左右以来，[Google 的链接](http://www.gamedev.net/topic/322422-number-of-gpu-cycles-for-cos-and-sin-functions/)在主流卡`cos`上都是单周期的。`sin`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-14T19:46:08.823

你必须自己测试一下，但我很确定着色器中的分支比`sin`or`cos`计算要昂贵得多。GLSL 编译器在优化着色器方面做得很好，担心这是过早的优化。如果你后来发现，在你的整个程序中，你的着色器是瓶颈，那么你可以担心优化它。

如果您想查看特定平台的着色器的汇编代码，我建议您使用[AMD GPU ShaderAnalyzer](https://gpuopen.com/archive/gpu-shaderanalyzer/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-14T16:28:06.053

不确定这是否回答了您的问题，但很难告诉您一条指令需要多少个时钟/插槽，因为它在很大程度上取决于 GPU。通常是一个循环。但即使不是，编译器也可能重新排列指令执行的顺序以隐藏真正的成本。对 sin/cos 使用纹理查找肯定会更慢，因为它是执行指令。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-19T15:45:02.137

看看你可以在一个着色器中连续获得多少罪孽，与 math.abs、frac 等相比......我认为 gtx 470 每个片段可以处理 200 个罪孽函数，没有问题，帧将比空着色器。它非常快，您可以发送结果。这将是计算效率的一个很好的指标。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-08-14T17:49:23.447

编译器评估两个分支，这使得条件非常昂贵。如果在着色器中同时使用 sin 和 cos，则只能计算 sin(a) 和 cos(a) = sqrt(1.0 - sin(a))，因为 sin(x)*sin(x) + cos(x)* cos(x) 始终为 1.0*

# java - TextView setGravity() 在java中不起作用

> ID：10154992
> 
> 赞同：12
> 
> 时间：2012-04-14T15:55:35.730
> 
> 标签：java, android, android-layout, bug-tracking, gravity

我被困在一个问题上，我不知道是什么原因造成的。我有一个非常简单的布局，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical">
<TextView
    android:id="@+id/my_text_view"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_gravity="NOTE_THIS"
    android:textColor="#FFFFFF"
    android:textSize="22dp"
    android:text="TestText"/>
</LinearLayout> 
```

它包含在另一个布局中。如果我更改 xml 中的重力，我会在布局编辑器和手机上看到相同的结果。如果我想以编程方式应用重力，`myTextView.setGravity(Gravity.CENTER)`它不会改变任何东西。而且我无法在 TextView 上的 Java 中设置 LayoutGravity

出于调试目的，我将尝试将它们包含三次，每个重力都可以正常工作。所以我假设我的布局一切正常，一定有一个错误或其他我想念的东西。有人可以给我一个提示，我也可以尝试什么，或者是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-14T16:01:32.803

设置 TextView 的宽度，`android:layout_width="fill_parent"`然后您可以使用编程方式设置它`myTextView.setGravity(Gravity.CENTER)`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-19T07:34:54.003

您需要设置 LayoutParams 对象而不是 View 本身的重力：

```
TextView tv = new TextView(getApplicationContext());
LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.FILL_PARENT);
lp.gravity = Gravity.CENTER;
tv.setLayoutParams(lp); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T15:59:49.527

当您使用 LinearLayout 作为父级时，layout_gravity 出现在图片中，它对齐控件而不是控件内的内容，因此，使用`android:layout_gravity`use `android:gravity`。

# hadoop - 使用hadoop mapreduce的文件中的互词

> ID：10154993
> 
> 赞同：0
> 
> 时间：2012-04-14T15:55:38.090
> 
> 标签：hadoop, mapreduce, word-count

我一直在尝试执行一些允许我“仅”列出多个文件中存在的单词的代码；到目前为止我所做的是使用 wordcount 示例和感谢 Chris White 我设法编译它。我尝试在这里和那里阅读以使代码正常工作，但我得到的只是一个没有数据的空白页。映射器假设收集每个单词及其对应的位置；减速器应该收集常用词关于可能是什么问题的任何想法？代码是：

```
 package org.myorg;

import java.io.IOException;
import java.util.*;
import java.lang.*;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.conf.*;
import org.apache.hadoop.io.*;
import org.apache.hadoop.mapred.*;
import org.apache.hadoop.util.*;

public class WordCount {

    public static class Map extends MapReduceBase implements Mapper<Text, Text, Text, Text> 
    {

        private final static IntWritable one = new IntWritable(1);
        private Text word = new Text();

          private Text outvalue=new Text();
          private String filename = null;

        public void map(Text key, Text value, OutputCollector<Text, Text> output, Reporter reporter) throws IOException 
        {
        if (filename == null) 
        {
          filename = ((FileSplit) reporter.getInputSplit()).getPath().getName();
        }

        String line = value.toString();
        StringTokenizer tokenizer = new StringTokenizer(line);

        while (tokenizer.hasMoreTokens()) 
        {
          word.set(tokenizer.nextToken());
          outvalue.set(filename);
          output.collect(word, outvalue);
        }

        }
    }

    public static class Reduce extends MapReduceBase implements Reducer<Text, Text, Text, Text> 
    {

        private Text src = new Text();
        public void reduce(Text key, Iterator<Text> values, OutputCollector<Text, Text> output, Reporter reporter) throws IOException 
        {

        int sum = 0;
        //List<Text> list = new ArrayList<Text>(); 

            while (values.hasNext()) // I believe this would have all locations of the same word in different files?
            {

                sum += values.next().get();
                src =values.next().get();

            }
        output.collect(key, src);
            //while(values.hasNext()) 
            //{ 
                //Text value = values.next(); 
                //list.add(new Text(value)); 
                //System.out.println(value.toString());       
            //} 
            //System.out.println(values.toString()); 
            //for(Text value : list) 
            //{ 
                //System.out.println(value.toString()); 
            //} 

        }

    }

    public static void main(String[] args) throws Exception 
    {

    JobConf conf = new JobConf(WordCount.class);
    conf.setJobName("wordcount");
    conf.setInputFormat(KeyValueTextInputFormat.class);
    conf.setOutputKeyClass(Text.class);
    conf.setOutputValueClass(Text.class);
    conf.setMapperClass(Map.class);
    conf.setCombinerClass(Reduce.class);
    conf.setReducerClass(Reduce.class);
    //conf.setInputFormat(TextInputFormat.class);
    conf.setOutputFormat(TextOutputFormat.class);
    FileInputFormat.setInputPaths(conf, new Path(args[0]));
    FileOutputFormat.setOutputPath(conf, new Path(args[1]));
    JobClient.runJob(conf);

    }

} 
```

我错过了什么吗？非常感谢...我的 Hadoop 版本：0.20.203

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T16:09:25.553

首先，您似乎正在使用旧的 Hadoop API (mapred)，建议使用与 0.20.203 兼容的新 Hadoop API (mapreduce)

在新的 API 中，这里有一个可以工作的字数

```
import java.io.IOException;
import java.lang.InterruptedException;
import java.util.StringTokenizer;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.GenericOptionsParser;

public class WordCount {
/**
 * The map class of WordCount.
 */
public static class TokenCounterMapper
    extends Mapper<Object, Text, Text, IntWritable> {

    private final static IntWritable one = new IntWritable(1);
    private Text word = new Text();

    public void map(Object key, Text value, Context context)
        throws IOException, InterruptedException {
        StringTokenizer itr = new StringTokenizer(value.toString());
        while (itr.hasMoreTokens()) {
            word.set(itr.nextToken());
            context.write(word, one);
        }
    }
}
/**
 * The reducer class of WordCount
 */
public static class TokenCounterReducer
    extends Reducer<Text, IntWritable, Text, IntWritable> {
    public void reduce(Text key, Iterable<IntWritable> values, Context context)
        throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable value : values) {
            sum += value.get();
        }
        context.write(key, new IntWritable(sum));
    }
}
/**
 * The main entry point.
 */
public static void main(String[] args) throws Exception {
    Configuration conf = new Configuration();
    String[] otherArgs = new GenericOptionsParser(conf, args).getRemainingArgs();
    Job job = new Job(conf, "Example Hadoop 0.20.1 WordCount");
    job.setJarByClass(WordCount.class);
    job.setMapperClass(TokenCounterMapper.class);
    job.setReducerClass(TokenCounterReducer.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(IntWritable.class);
    FileInputFormat.addInputPath(job, new Path(otherArgs[0]));
    FileOutputFormat.setOutputPath(job, new Path(otherArgs[1]));
    System.exit(job.waitForCompletion(true) ? 0 : 1);
}
} 
```

然后，我们构建这个文件并将结果打包到一个 jar 文件中：

```
mkdir classes
javac -classpath /path/to/hadoop-0.20.203/hadoop-0.20.203-core.jar:/path/to/hadoop-  0.20.203/lib/commons-cli-1.2.jar -d classes WordCount.java && jar -cvf wordcount.jar -C classes/ . 
```

最后，我们以 Hadoop 的独立模式运行 jar 文件

```
echo "hello world bye world" > /tmp/in/0.txt
echo "hello hadoop goodebye hadoop" > /tmp/in/1.txt
hadoop jar wordcount.jar org.packagename.WordCount /tmp/in /tmp/out 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T16:52:46.363

在reducer中，维护一组观察到的值（mapper中发出的文件名），如果你消费完所有值后，这个集合大小为1，那么这个词只在一个文件中使用。

```
public static class Reduce extends MapReduceBase implements Reducer<Text, Text, Text, Text> 
{
    private TreeSet<Text> files = new TreeSet<Text>();

    public void reduce(Text key, Iterator<Text> values, OutputCollector<Text, Text> output, Reporter reporter) throws IOException 
    {
        files.clear();

        for (Text file : values)
        {
            if (!files.contains(value))
            {
                // make a copy of value as hadoop re-uses the object
                files.add(new Text(value));
            }
        }

        if (files.size() == 1) {
            output.collect(key, files.first());
        }

        files.clear();
    }
} 
```