# StackOverflow 问答 000314000-000314999

# c# - 实例化对象时以编程方式使用字符串作为对象名称

> ID：314008
> 
> 赞同：10
> 
> 时间：2008-11-24T12:16:14.810
> 
> 标签：c#, oop

这是一个人为的例子，但可以说我已经声明了对象：

```
CustomObj fooObj;
CustomObj barObj;
CustomObj bazObj; 
```

我有一个字符串数组：

```
string[] stringarray = new string[] {"foo","bar","baz"}; 
```

如何使用字符串数组以编程方式访问和实例化这些对象，使用类似 foreach 的东西进行迭代：

```
foreach (string i in stringarray) {
    `i`Obj = new CustomObj(i);
} 
```

希望我试图表达的想法很清楚。这在 C# 中可能吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-24T12:19:10.640

您需要清楚地了解对象和变量之间的区别。对象本身没有名称。变量名是在编译时决定的。您不能通过执行时间确定的名称访问变量，除非通过反射。

听起来你*真的*只是想要一个`Dictionary<string, CustomObj>`：

```
Dictionary<string, CustomObj> map = new Dictionary<string, CustomObj>();

foreach (string name in stringArray)
{
    map[name] = new CustomObj(name);
} 
```

然后，您可以使用字典的索引器访问对象。

如果您真的想在执行时根据变量名称设置变量的值，则必须使用反射（请参阅[Type.GetField](http://msdn.microsoft.com/en-us/library/system.type.getfield.aspx)）。请注意，这不适用于局部变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T12:19:19.733

你不能。

您可以将它们放入字典中：

```
Dictionary<String, CustomObj> objs = new Dictionary<String, CustomObj>();

foreach (string i in stringarray)
{
    objs[i] = new CustomObj(i);
} 
```

但这已经差不多了。

如果您将对象存储在类的字段中，如下所示：

```
public class SomeClass
{
    private CustomObj fooObj;
    private CustomObj barObj;
    private CustomObj bazObj;
} 
```

然后你可以通过反思来接触他们。让我知道这是否是您想要采取的路线。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T18:36:28.267

您可以使用查找功能：

```
 public static Control FindControl(string controlId, Control container)
    {
        if (container.ID == controlId)
            return container;

        foreach (Control control in container.Controls)
        {
            Control c = FindControl(controlId, control);
            if (c != null)
                return c;
        }
        return null;
    } 
```

然后你会得到你的控制，基于这样的索引： TextBox firstname = (TextBox) FindControl(string.Concat("TextBox", index.ToString()), this); 我希望这有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-21T09:52:36.367

使用 this.Controls.Find(control_name,true)[0]...只要记住转换它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T12:21:02.833

如果变量是类成员变量，则可以使用反射来实现这一点，但对于非常专业的应用程序来说，它的速度非常慢。我认为，如果您详细说明您要做什么，我们可以更好地提供建议。很少有你应该像现在这样访问变量的情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T12:21:13.800

[根据本文](http://frater.wordpress.com/2007/06/24/instantiating-classes-through-reflection-using-c-dynamic-object-creation/)，一个选项是完全动态的路线，您可以在其中指定字符串中的代码块，然后在程序中编译/运行它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T12:23:01.303

另一种不太灵活但更简单的选择是通过[Activator.CreateInstance](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/57bf41ef-bac8-4061-863d-27355be96b17/) - 您要求创建一个新对象 - 它不会分配给动态变量，但需要吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-09T19:11:06.373

@jotte：非常感谢这个功能。我用过它并且有效！除了您需要通过 container.Name 更改 container.ID

然后你只需要使用类似的东西（这个例子是复选框，但任何类型的变量都可以工作）：

字符串测试 = "cbACn" + i.ToString(); CheckBox cbTest = (CheckBox)FindControl(Test, gbACSCAT); if (cbTest != null) { cbTest.Checked = true; }

# c++ - 返回一个迭代器

> ID：314012
> 
> 赞同：2
> 
> 时间：2008-11-24T12:20:05.677
> 
> 标签：c++, stl, iterator

我有一个搜索 STL 容器的函数，然后在找到位置时返回迭代器，但是我收到一些有趣的错误消息，能告诉我我做错了什么吗？

功能：

```
std::vector< CClass >::iterator CClass::SearchFunction( const std::string& strField )
{
...

   return it;

...
} 
```

错误：

```
error C2664: 'std::_Vector_iterator<_Ty,_Alloc>::_Vector_iterator(const std::_Vector_iterator<_Ty,_Alloc> &)' : cannot convert parameter 1 from 'std::_Vector_const_iterator<_Ty,_Alloc> *__w64 ' to 'const std::_Vector_iterator<_Ty,_Alloc> &' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T12:23:26.807

您的搜索函数返回一个 const_iterator。如果您希望调用者能够通过迭代器修改找到的项目，您应该返回相同的类型，即 ie `std::vector< CClass >::const_iterator`，或者将其强制转换为 a 。`std::vector< CClass >::iterator`

编辑：看到你的更新后，问题似乎是你的迭代器（它）的类型与你的函数返回不同。他们应该是一样的。

```
std::vector< CClass >::iterator it; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T12:24:04.903

听起来你把你的 const_iterators 弄混了。请发布更多代码，特别是您如何声明迭代器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:59:52.750

您还应该查看 std::find_if() 函数。这可能是一种更清洁的方法。

# c# - 单元测试假存储库，如何在不先添加实体的情况下测试 GetById 方法？

> ID：314024
> 
> 赞同：3
> 
> 时间：2008-11-24T12:26:44.883
> 
> 标签：c#, unit-testing

我的理解是您必须编写隔离功能的单元测试。因此，给定一个具有此方法的存储库类：

```
Entity GetById(Guid id) 
```

和一个*假实现（使用字典进行存储），如果不先**添加*实体，您将如何编写测试？可以使用一组已知的 guid 进行测试吗？然后在假存储库构造函数中，我可以用几个实体填充字典，其中 guid 遵循某种模式，以便我可以使用我知道将返回实体的 guid 测试 GetById() 方法。

谢谢阅读！

PS。这是我第一次写单元测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T12:32:37.227

是的，你可以在你的测试中使用已知的测试 ID——这就是我要做的。虽然我已经成为[Rhino Mocks](http://en.wikibooks.org/wiki/How_to_Use_Rhino_Mocks/Introduction)的粉丝，它可以让你更直接地测试你希望 mock 对象做什么。

例如，就在您调用存储库之前，您可以这样做：

```
Expect.Call(repository.GetById("someObject")).Return(new RepositoryThing()); 
```

无论如何它对我很有吸引力:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T12:53:37.853

是的，使用可以从假实例查询的固定项目列表的对象/接口的假实现是一种有效的做法。

显然，如果不先添加条目，则只能测试在存储库中找不到 Guid 时返回的内容。

在 C# 中允许它，也可以让存储库的假实现具有将项目添加到存储库的方法。

# windows - Windows 编程：如何将经常访问的文件放入操作系统缓存中？

> ID：314029
> 
> 赞同：0
> 
> 时间：2008-11-24T12:28:45.517
> 
> 标签：windows, caching, file

Windows 编程：如何将经常访问的文件放入操作系统缓存中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:31:19.630

免责声明：我在 Windows 下工作不多

在一般情况下，您不应该弄乱您的操作系统缓存。它应该足够聪明，可以缓存经常访问的数据。如果不是，您应该使用应用程序级缓存。我不知道您使用的是哪种语言，但很可能您的语言有一个很好的缓存框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T13:01:19.617

如果您的文件被频繁访问并且不是太大，它将已经在许多不同的缓存中。您的语言运行时（例如 CRT）缓存、文件系统缓存（或者我假设您对“操作系统缓存”的意思）和您的 HDD 缓存。

如果您的文件很小且访问频繁，但仍未在缓存中，则说明文件不够小或访问频率不够高。您可能能够解决第一个问题，但**不要**尝试解决第二个问题，因为这基本上意味着其他文件的访问频率比您的访问频率高，而且很可能是有原因的。例如，用户宁愿使用其他应用程序而不是您的应用程序。相信我，这是可能的，而且会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T12:33:07.397

如果您在 .net 中并且文件是 dll，请查看[Global Assembly Cache (GAC)](http://en.wikipedia.org/wiki/Global_Assembly_Cache)。

# c# - WindowsForms 设计器和 GenericForm

> ID：314033
> 
> 赞同：2
> 
> 时间：2008-11-24T12:30:47.167
> 
> 标签：c#, .net, winforms, generics

如果您从自己的书面通用形式继承，为什么设计器不工作？

假设我有以下通用形式

```
public class GenericForm<T> : System.Windows.Forms.Form
{
    public T Test
    {
        get;
        set;
    }
} 
```

当我去找设计师时，我得到了错误。

我制定的唯一解决方法是使用编译器指令。

```
#if DESIGN    
    public partial class Form1 : System.Windows.Forms.Form
#else
    public partial class Form1 : GenericForm<string>
#endif

    {
        public Form1()
        {
            InitializeComponent();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:35:12.027

不幸的是，设计师有各种各样的“陷阱”。某处可能对它们进行了很好的总结，但我从来没有充分参与其中以使其成为必要。

但是，我遇到了这个特殊问题，除了应用于用户控件。我想出的解决方案（这又很老套，但以不同的方式）是从通用类派生一个具体类。在你的情况下，你会这样做：

```
public class StringForm : GenericForm<string> 
```

然后，您应该可以`StringForm`在设计器中使用而不会出现任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T05:50:05.823

我相信这是因为设计器试图实例化表单（或 UserControl）以将其托管在设计器中。如果您有通用（或抽象）表单，则设计器无法实例化它。

# iis - 在 Windows Server 2008 上添加 Web 域

> ID：314039
> 
> 赞同：2
> 
> 时间：2008-11-24T12:32:24.950
> 
> 标签：iis, windows-server-2008, ip-address, domain-name

我最近购买了一台 Windows Server 2008 服务器，我们公司将把它用作 Web 服务器。我已经在 IIS 7.0 中设置了网站，我可以通过在网络内的计算机上键入[http://10.1.1.8来访问它。](http://10.1.1.8)

当我尝试通过其他计算机上的网络访问它时，它似乎不起作用，但最重要的是，我如何设置一个网络域，例如（www.example.com）？

非常感谢，奥利弗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T22:46:35.397

假设： - 您有一个固定 IP 地址的互联网连接 - 您的互联网连接通过某种路由器/防火墙 - 提供您的域名的注册商提供 dns 托管

1.  为您的 Web 服务器设置 TCP/IP 设置，为其分配一个固定的内部 IP 地址（即不使用 DHCP）

2.  配置防火墙以将所有 HTTP 流量（请参阅特定路由器/防火墙的文档）路由到步骤 1 中设置的内部 IP 地址。

3.  在您的注册商管理您的域名时，添加两条 dns 记录（一条用于 .yourdomain.com 和 *.yourdomain.com，它们指向为您的 Internet 连接提供的外部固定 IP 地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T13:06:53.523

它有一个私人互联网地址。大概您的公司也有一个真实的，分配的互联网地址空间。如果你想从公司外部访问，你需要给系统一个官方地址空间中的地址。将该地址与网站名称 (www.yourcompany.com) 相关联，一切都会得到妥善处理。

10.xxx 和 192.168.xx 范围内的所有地址都是其他网络无法访问的私有地址。[请参阅此处](http://www.iana.org/assignments/ipv4-address-space/)分配的地址空间，尤其是末尾的注释。

# epson - 如何以编程方式检索墨盒墨水量（Epson StatusMonitor + Mac OS X）？

> ID：314054
> 
> 赞同：1
> 
> 时间：2008-11-24T12:39:31.533
> 
> 标签：epson

我正在寻找一种在 Mac OS X 上查询我的 Epson DX 4050 墨水量的方法。有一些名为 EPSON StatusMonitor 的 UI 可以以图形方式显示墨盒水平，但我想从命令行获取它所以它可以喂机器人。

任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T12:49:33.590

这将是一项事业。要么对 StatusMonitor 应用程序进行逆向工程，以了解它如何查询驱动程序以查找墨水量，要么为其查找一些文档。可能可以深入到 StatusMonitor 应用程序以找出其小部件的内部值（Windows 可以做到这一点，虽然很老套），但整个过程很可能是时间的一个天坑:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-30T16:33:54.763

如果打印机支持 SNMP，您可能很幸运能够使用任何 SNMP 命令行工具进行查询。打印机有标准定义，它们包含用于查询当前和最大墨水量的 API。

下面是我如何使用简单的 unix shell 命令（需要安装 net-snmp）。这不是严格意义上的 Mac，但您应该有所了解。

```
#!/bin/sh

me="${0##*/}"

host="${1:-wp4535}"

base=1.3.6.1.2.1.43.11.1.1

name="WP-4535"

type=$(snmpget -v1 -c public ${host} SNMPv2-MIB::sysDescr.0)

case "$type" in
"SNMPv2-MIB::sysDescr.0 = STRING: EPSON"*)
    type=epson
    ofs=1
;;
*)
    echo "! unknown printer type" 1>&2
    exit 1
;;
esac
echo "# $host $type $name"

# get current ink levels
eval $(snmpwalk -v1 -Ov -OQ -c public ${host} ${base}.6.${ofs} |
perl -ne 'print "c[",++$c,"]=$1\n" if(m!"(\w+) ink!i);')

# get max ink level per cartridge
eval $(snmpwalk -v1 -Ov -OQ -c public ${host} ${base}.8.${ofs} |
perl -ne 'print "max[",++$c,"]=$1\n" if(m!(\d+)!i);')

snmpwalk -v1 -Ov -OQ -c public ${host} ${base}.9.${ofs} |
perl -ne '
    my @c=("","'${c[1]}'","'${c[2]}'","'${c[3]}'","'${c[4]}'");
    my @max=("","'${max[1]}'","'${max[2]}'","'${max[3]}'","'${max[4]}'");
    my $v=$c[++$c];
    printf"# $v=$1 (%.0f)\n",$1/$max[$c]*100 if(m!(\d+)!i);' 
```

# c# - 在 VS2005 (C#) 中更改 ConnectionString

> ID：314055
> 
> 赞同：1
> 
> 时间：2008-11-24T12:40:12.937
> 
> 标签：c#, visual-studio-2005

我知道有[一些类似的问题](https://stackoverflow.com/questions/63546/vs2005-c-programmatically-change-connection-string-contained-in-appconfig)。

但是，问题仍然没有回答！我需要**修改**连接字符串而不是添加新的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T12:47:42.343

这将帮助你！

```
 /// <summary>
        /// Add a connection string to the connection
        /// strings section and store it in the
        /// configuration file. 
        /// </summary>
        /// <param name="csName">The name of the property.</param>
        /// <param name="connectionString">The connectionstring as specified.</param>
        public static void AddConnectionStrings(string csName, string connectionString)
        {

            // Get the configuration file.
            System.Configuration.Configuration config =
                ConfigurationManager.OpenExeConfiguration(
                ConfigurationUserLevel.None);

            // Add the connection string.
            ConnectionStringsSection csSection = config.ConnectionStrings;
            csSection.ConnectionStrings.Add(
                new ConnectionStringSettings(csName,
                    connectionString, "System.Data.SqlClient"));

            // Save the configuration file.
            config.Save(ConfigurationSaveMode.Full);       
        } 
```

对于更新来说，很难找到任何有用的代码来更新连接字符串。无法更新连接字符串，所以我删除了连接字符串，并添加了一个新的。那是不是很奇怪？微软留下了一些未完成的东西......好吧，改变你的app.config也许没有用，但是无论如何我必须做到。所以动态 app.config 或 web.config 文件有点奇怪，因为你不能动态更新它。不，您必须先由配置管理器将其删除。

```
 /// <summary>
        /// First remove the old connectionstring and after that
        /// add a connection string to the connectionstrings
        /// section and store it in the configuration file. 
        /// </summary>
        /// <param name="csName">The name of the property.</param>
        /// <param name="connectionString">The connectionstring as specified.</param>
        public static void UpdateConnectionStrings(string csName, string connectionString)
        {
            // Get the configuration file
            System.Configuration.Configuration config =
                ConfigurationManager.OpenExeConfiguration(
                ConfigurationUserLevel.None);

            // Remove the existing connectionstring.
            config.ConnectionStrings.ConnectionStrings.Remove(csName);
            // Add the connectionstring
            ConnectionStringsSection csSection = config.ConnectionStrings;
            csSection.ConnectionStrings.Add(
                new ConnectionStringSettings(csName, 
                connectionString, "System.Data.SqlClient"));

            // Save the configuration file
            config.Save(ConfigurationSaveMode.Full);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T18:22:44.450

这是一个古老的问题，我只想知道最终为您解决了什么解决方案。如果您还没有解决它，[这个问题](https://stackoverflow.com/questions/786315/)试图回答它。

# java - MVEL 函数中的可选参数

> ID：314058
> 
> 赞同：4
> 
> 时间：2008-11-24T12:44:52.910
> 
> 标签：java, optional-parameters, mvel

有没有办法让 MVEL 2.0 ( [http://mvel.codehaus.org/](http://mvel.codehaus.org/) ) 使用带有可选参数的函数？

我希望能够对此进行评估：

trunc('blahblah',2)

但是也

trunc('blahblah',2,'[...]');

现在我试过了：

def trunc(param1,param2,param3) { ... 实现 ... }

如果我尝试仅使用 3 个参数调用它，则会出现异常。我也试过：

def trunc(param1,param2,param3) { ... impl ... } def trunc(param1,param2) { ... impl ... }

但是第二个似乎完全覆盖了第一个定义。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-13T14:29:56.993

在java中，您可以声明多个具有相同名称但参数不同的方法。这样您就可以（以有限的方式）支持可选参数。例如。：

```
private void method(Object obj1) {
    Object obj2 = new Object("Default");
    method(obj1, obj2);
}

private void method(Object obj1, Object obj2) {
    doStuff(...);
} 
```

可以使用一个或两个参数调用 method() :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-26T14:52:13.347

MVEL 有一个错误，它接受带有可变参数的方法，但只执行带有非可变参数的方法。所以你应该有一个可变参数和非可变参数方法。对可变参数方法进行查找，但只会调用非可变参数。

```
parserContext = new ParserContext();
parserContext.addImport("color", MyImplementation.class.getMethod("color", double[].class)); 
```

在您的实现类中：

```
// This one is used for lookup, but never called.
public static Color color(double... values) {} 

public static Color color(double gray) {}
public static Color color(double red, double green, double blue) {} 
```

如果要对任意对象类型执行此操作，请使用 Object[].class。请记住，这样做会失去类型安全性。

# c# - 直接反序列化到/从 XML Linq

> ID：314062
> 
> 赞同：22
> 
> 时间：2008-11-24T12:50:35.053
> 
> 标签：c#, xml, linq, xml-serialization

有没有办法在不往返 XmlDocument/temp 字符串的情况下对对象进行反序列化/序列化？我正在寻找类似以下的内容：

```
class Program
{
    static void Main(string[] args)
    {
        XDocument doc = new XDocument();
        MyClass c = new MyClass();
        c.SomeValue = "bar";

        doc.Add(c);

        Console.Write(doc.ToString());
        Console.ReadLine();
    }
}

[XmlRoot(ElementName="test")]
public class MyClass
{
    [XmlElement(ElementName = "someValue")]
    public string SomeValue { get; set; }
} 
```

但是，当我这样做时出现错误（不能将非空白字符添加到内容中。）如果我将类包装在元素中，我会看到写入的内容是 <element>ConsoleApplication17.MyClass</element> - 所以错误说得通。

我*确实*有自动反序列化/序列化的扩展方法，但这不是我想要的（这是客户端，但我仍然想要更优化的东西）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-26T18:46:07.487

像[这样](http://msdn.microsoft.com/en-us/library/bb675182.aspx)的东西？

```
 public XDocument Serialize<T>(T source)
    {
        XDocument target = new XDocument();
        XmlSerializer s = new XmlSerializer(typeof(T));
        System.Xml.XmlWriter writer = target.CreateWriter();
        s.Serialize(writer, source);
        writer.Close();
        return target;
    }

    public void Test1()
    {
        MyClass c = new MyClass() { SomeValue = "bar" };
        XDocument doc = Serialize<MyClass>(c);
        Console.WriteLine(doc.ToString());
    } 
```

# asp.net - 从其他网站获取数据

> ID：314068
> 
> 赞同：2
> 
> 时间：2008-11-24T12:53:51.753
> 
> 标签：asp.net, asp.net-ajax, asp.net-3.5

甚至在说出我的问题之前，都会告诉你这是一个非常模糊的问题。但是，如果您有任何类似的想法，请告诉我。

我实际上是在尝试使用 ASP.Net 在本地编写自己的网站。我实际上想尝试模拟一个包含交易和股票详细信息的网站。我想真正从一些人那里获取细节。请让我知道是否可以从其他网站获取数据，或者是否有任何网站可以获取此类详细信息。也请让我知道在设计网站之前和期间我需要记住的所有参数。请让我知道我可以利用的任何此类想法。非常非常感谢你们。感谢您的任何评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T12:58:37.533

是的，您可以使用 ASP.Net 从其他网站获取数据，但一般来说，如果您打算制作一个大型网站，那么从其他网站上抓取数据是“离线”完成的，并且 ASP.Net 应用程序提供了这个缓存爬取的页面。请记住，来自单个 IP（即您的服务器）的大量流量可能会引起系统管理员的注意，除非您事先与该站点达成协议，并且您可能会禁止您的 IP 以冷却它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T12:58:36.037

是的，当然您可以使用**System.Net**类（例如**System.Net.WebClient** ）来获取数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T15:06:06.417

您可以开始研究的一些基础知识是**HttpWebRequest**和**HttpWebResponse类，下面是从**[MSDN](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)获取的一个简单示例

```
 // Create an HttpWebRequest using WebRequest.Create (see .NET docs)!
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);

    // Execute the request and obtain the response
    HttpWebResponse response = (HttpWebResponse)request.GetResponse(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T13:06:45.347

一般来说，我会从数据源提供的网络服务中获取类似的数据。尽管我怀疑您是否可以免费找到这样的服务。

# asp.net - .NET/IIS 友好的内存防病毒扫描

> ID：314070
> 
> 赞同：2
> 
> 时间：2008-11-24T12:57:42.433
> 
> 标签：asp.net, iis, antivirus

我正在寻找一种可以让我即时扫描文件的解决方案。它需要与 IIS（6.0 或 7.0）或 ASP.NET 很好地集成。我花了一些时间试图在 Internet 上找到一些东西，但不幸的是，我发现的只是一个基于 COM 的解决方案，它仍然迫使我将文件保存在磁盘上 ( [http://www.opswat.com/metascan.shtml](http://www.opswat.com/metascan.shtml) ) 更新：解决方案需要在内部托管。

谢谢

帕维尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T13:02:13.157

我们使用[Sophos Anti-Virus Interface](http://www.sophos.com/products/enterprise/email/security-and-control/integration/) (SAVI)，这是一种基于 COM 的进程内解决方案，您可以使用 COM 互操作访问它，它支持内存扫描。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-25T15:28:27.700

您是否尝试过 Metascan REST 服务器或 Metascan 的缓冲区扫描？我很确定您可以将字节数组传递给 Metascan 进行扫描。根据他们的示例代码，它看起来像这样。

字节 [] 缓冲区；... ... metaScanLib.Scan(buff);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T13:00:07.403

[http://housecall.trendmicro.com/](http://housecall.trendmicro.com/)？

# jsp - 没有从struts动作类发送的jsp中获取对象

> ID：314076
> 
> 赞同：1
> 
> 时间：2008-11-24T13:01:41.787
> 
> 标签：jsp, struts

你好有人可以解决这个问题吗

我在动作类中创建对象

```
public CgUsers getUserdetail(){
        CgUsers user = userManager.getUser(id);
        return user;
        } 
```

我正在尝试在 jsp 页面中使用该对象

```
c:forEach items="${Userdetail}" var="user">

               <ul>
                <li><c:out value="${user.getLastName()}"/> </li>

            </c:forEach> 
```

如果我尝试在操作类的执行方法中获取输出，我得到它是正确的，但我没有在 jsp 页面中得到它。

它在浏览器上给出了错误，比如

```
/WEB-INF/pages/search/profile.jsp(15,8) PWC6296: The function getLastName must be used with a prefix when a default namespace is not specified 
```

有人可以提出解决方案吗？那会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T13:07:29.340

使用“${ **u** serdetail}”而不是“${ **U** serdetail}”。

# .net - 从 .Net 部署项目中的文本框中读取值

> ID：314081
> 
> 赞同：1
> 
> 时间：2008-11-24T13:02:36.010
> 
> 标签：.net, installation

我有一个触发 OnAfterInstall 的自定义安装程序类，如何读取用户在之前的安装屏幕中输入的值？值在文本框中输入。

另外，如何在我的自定义安装程序类中强制安装失败并向用户显示有关失败的适当消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T15:41:26.627

一种解决方案是通过隐藏字段将先前文本框中的值从页面传递到页面，然后在引发 OnAfterInstall 时从这些字段中读取。

# ruby-on-rails - 自定义 Rails 身份验证/授权

> ID：314085
> 
> 赞同：2
> 
> 时间：2008-11-24T13:04:13.653
> 
> 标签：ruby-on-rails, authentication, authorization

[我知道以前](https://stackoverflow.com/questions/24298/best-solution-for-authentication-in-ruby-on-rails) [有人](https://stackoverflow.com/questions/13254/open-id-authentication-in-ruby-on-rails) [问](https://stackoverflow.com/questions/38901/strange-rails-authentication-issue)过这类问题，但我的情况略有不同。

在我的 Rails 应用程序中，我必须针对现有存储库验证用户登录，然后控制对给定模块的授权。因此，我不希望我所寻求的解决方案为我的用户生成模型并依赖它。身份验证本身需要定制。

在这种情况下，最好使用什么插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T13:47:44.283

查看[宁静的acl](http://www.railslodge.com/plugins/966-restful-acl)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T05:13:57.063

这是一个[secure_sessions](http://github.com/pliam/secure_sessions/tree/master)，它不对您的模型做任何假设。相反，您在您的环境中提供一个负责身份验证的过程：

```
SecureSessions::Password.validate_proc = proc do |ctrl| 
  # define any proc here which validates username/password etc, and returns a unique ID
  return nil unless User.authenticate(ctrl.params[:login], ctrl.params[:password])
  User.find_by_login(ctrl.params[:login]).id
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T04:20:12.290

我不知道这些是否有帮助，但除了 RESTful ACL 之外，我总是使用这些链接作为参考

[1) http://clearcove.ca/blog/2008/08/recipe-restful-permissions-for-rails/](http://clearcove.ca/blog/2008/08/recipe-restful-permissions-for-rails/)

[2) http://steffenbartsch.com/blog/2008/08/rails-authorization-plugins/](http://steffenbartsch.com/blog/2008/08/rails-authorization-plugins/) - 有一个关于身份验证/授权插件的列表

[http://metautonomo.us/2008/09/30/easy-role-based-authorization/](http://metautonomo.us/2008/09/30/easy-role-based-authorization/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T18:26:04.377

# 权威

我刚刚发布了一个名为[Authority](https://github.com/nathanl/authority)的 gem ，它完全是 ORM 中立的；你可以做任何适用于你的应用程序的 Ruby 逻辑。

例如，最初的用例涉及将单点登录系统描述的角色与 YAML 文件中的权限进行比较。

# visual-studio - 按下 Ctrl 和光标键时让 Visual Studio 理解 CamelCase

> ID：314095
> 
> 赞同：153
> 
> 时间：2008-11-24T13:09:01.147
> 
> 标签：visual-studio, keyboard-shortcuts, customization

**有没有办法可以配置 Visual Studio 2008 来理解 CamelCase？** 具体来说，我希望能够 get`Ctrl + right`或`left`cursor 将我带到变量或类型名称的子部分。

即，如果我的光标位于此行的开头：

```
LongNamedExampleClass longNamed = new LongNamedExampleClass(); 
```

我点击了`Ctrl + right`，我想跳转到`Named`类名中的“”，而不是变量名的开头。如果我再打一次，我想去“ `Example`”。我希望这是有道理的。

我在 Eclipse 中经常使用这种导航功能，并且发现很难忘记如此根深蒂固的东西。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-11-25T10:26:51.397

感谢那些建议 Resharper 的人。这给了我另一个更喜欢它的理由。只是为了具体说明它的位置 - JetBrains 称之为[**CamelHumps**](http://www.jetbrains.com/resharper/features/navigation_search.html#CamelHumps)（可爱），您可以使用菜单将其打开：

> **Resharper -> 选项 -> 环境 -> 编辑器 -> 编辑器行为 -> 使用 CamelHumps**

...在旧版本的 Resharper 中，它是；

> **Resharper -> 选项 -> 编辑器 -> 使用 CamelHumps**

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2015-03-30T22:47:01.153

在 2008 年 11 月 25 日之后偶然发现此页面的任何人（不想为*不再有免费版本*的 ReSharper 或 CodeRush 付费），以下免费扩展程序添加了此功能：**Olle Westman 的****[子词导航](https://marketplace.visualstudio.com/items?itemName=OlleWestman.SubwordNavigation)**

（或者，[VSTricks](https://marketplace.visualstudio.com/items?itemName=CodeMuncher1.VSTricks)扩展在其漂亮的功能列表中包含子词导航。还有一个由 Lauri Vasama 创建的不同[子词导航](https://marketplace.visualstudio.com/items?itemName=vasama.SubwordNavigation)扩展，不要与此答案使用的 Olle Westman 混淆。）

子词导航项目页面状态：

> 在键盘绑定中查找 Edit.Subword 进行设置。

这是我设置它的方式**`Visual Studio 2019`**：

* * *

1.  导航到**工具 > 选项 > 环境 > 键盘**

* * *

2.  在 下**`Use new shortcut in`**，选择**文本编辑器**

* * *

3.  在 下**`Show commands containing`**，键入**Edit.Subword**。这应该会弹出一个带有下面列出的命令的自动完成字段。

* * *

4.  选择您要为其设置快捷键的以下命令之一。选择后，按照其余编号的步骤进行操作。然后回来**`Step 4`**设置另一个。
    *   **Edit.SubwordNext**
        *   向右横穿骆驼箱 [ **`Alt + Right Arrow`**]
    *   **Edit.SubwordPrevious**
        *   向左横穿骆驼箱 [ **`Alt + Left Arrow`**]                                                             
    *   **Edit.SubwordNextExtend**
        *   选择右侧的驼峰式 [ **`Alt + Shift + Right Arrow`**]
    *   **Edit.SubwordPreviousExtend**
        *   选择左侧的驼峰式 [ **`Alt + Shift + Left Arrow`**]                                                              
    *   **Edit.SubwordDeleteNext**
        *   删除右侧的驼峰式 [ **`Alt + Delete`**]
    *   **Edit.SubwordDeletePrevious**
        *   删除左侧的驼峰式 [ **`Alt + Backspace`**]

* * *

> **注意：**将这些子词导航命令分配给这些新快捷键时，请通过将它们设置为不同的键来预先保留您想要保留的任何现有快捷键功能。**它不应与任何默认安装的快捷键冲突。**

* * *

5.  在 下**`Press shortcut keys`**，按**您的快捷键**

* * *

6.  单击**`Assign`**并覆盖现有的快捷方式

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-08-15T12:50:02.223

如果您安装了 ReSharper，您还可以为 CamelHump 配置 Visual Studio 键盘快捷键“Alt-Right”和“Alt-Left”，而不会丢失“ctrl-right”和“ctrl-left”的标准 Visual Studio 行为。

1.  **从工具 -> 选项**打开 Visual Studio**选项**窗口
***   展开**环境**并向下滚动到**键盘***   在*显示包含命令的*框中，键入“hump”。这将显示与 CamelHumps 相关的所有命令。 [![驼峰](https://i.stack.imgur.com/t5Ast.png)](https://i.stack.imgur.com/t5Ast.png)*   *通过从列表中选择命令并在Press shortcut keys*文本框中输入键映射，将命令映射到您希望的键映射，然后单击**Assign**。**

 **注意事项：

*   **为Text Editor**分配映射，而不是**Global**。
*   确保Resharper -> Options -> Editor -> Editor Behavior 中的*Use CamelHumps选项已***关闭**。

详细信息：http: [//davidrcook.wordpress.com/2009/11/05/working-with-camel-case-in-visual-studio/](http://davidrcook.wordpress.com/2009/11/05/working-with-camel-case-in-visual-studio/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-24T13:42:02.500

[它不是 Visual Studio 原生的，但您可以使用CodeRush Express](http://www.devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)免费获得它。（ReSharper 和 CodeRush 需要付费）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T13:26:42.093

Visual Studio 不支持此行为。然而，[DevExpress 的](http://www.devexpress.com/)CodeRush！产品支持这样的导航（使用 Alt-Left 和 Alt-Right），以及大量其他帮助导航的功能。CodeRush！产品还与他们的重构工具捆绑在一起。他们还提供免费的 CodeRush！& Refactor Express 产品，虽然我不确定 Camel Casing 导航是否是 express 产品的一部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-05-31T15:45:22.707

将下面的宏添加到视觉工作室。

[http://visualstudiomacros.blogspot.com/2008/03/getting-ctrl-right-arrow-to-respect.html](http://visualstudiomacros.blogspot.com/2008/03/getting-ctrl-right-arrow-to-respect.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T13:13:29.313

我认为 Visual Studio 内部不支持此功能，因为它似乎在 Windows 环境中使用正常的 Ctrl+Right 和 Ctrl+Left 工作方式。但它可能通过某种扩展或插件来实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-17T18:02:39.977

就像在 Eclipse 中一样，创建这个扩展是为了做到这一点：

[https://marketplace.visualstudio.com/items?itemName=maptz.camelcasenavigation](https://marketplace.visualstudio.com/items?itemName=maptz.camelcasenavigation)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-08T22:18:37.230

对于使用 Visual Studio 2022 的用户。

Ctrl + Alt + 右或左将跳转到子词（驼峰导航）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-12-15T10:36:18.823

对于在 ~1.63 版本中寻找此功能的任何人，键绑定选项现在称为“cursorWordPart”，可以在键盘快捷键中轻松设置:)

# sql-server - 更新而不锁定在事务中

> ID：314098
> 
> 赞同：4
> 
> 时间：2008-11-24T13:10:50.817
> 
> 标签：sql-server

在使用单个活动连接的 SQL Server 中是否可能出现以下情况？

在 READCOMMITED 事务中，我需要更新一个表而不锁定它。例如，每次我执行一条语句时，我都会增加该表中的一个字段。如果事务失败，则不需要回滚此操作。此外，此更新不应阻止尝试更新同一位置的其他并发用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T15:01:36.147

如果不对表加锁，就无法执行更新。这是为了让其他事务的事务隔离级别来控制它们是否可以“看到”更新中所做的更改。您可以更改更新的事务隔离级别，但这只会影响更新会话（您设置它的位置）控制更新是否可以“看到”其他会话中所做的更改......

如果您希望其他 Sql 语句能够看到您在此更新中所做的事情，就好像它没有被锁定一样，您必须将其他 txs 上的事务隔离级别更改为未提交读取。（注意这一点......这种隔离级别可能会导致您的数据库出现许多不一致。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T20:36:54.923

您不能在写入期间不锁定表。

你的意思是你想写入一个表，但是在提交/回滚之前*没有保留独占锁？*

如果是这样，请将您需要的值放入表变量中（不受回滚/提交的影响）并将写入推迟到主事务之后。然后，执行一次更新以从表变量中推送值。

编辑：[SQL 2008 workaround](http://blogs.msdn.com/sqlprogrammability/archive/2008/08/22/how-to-create-an-autonomous-transaction-in-sql-server-2008.aspx)，稍后有其他想法

# visual-studio-2008 - 为什么VS2008调试一页循环后停止？

> ID：314099
> 
> 赞同：0
> 
> 时间：2008-11-24T13:11:40.797
> 
> 标签：visual-studio-2008, iis-7, windows-vista

我真的很感激对以下问题的一些想法。

当我附加到`w3wp.exe`过程中。

*   它开始加载符号。
*   然后调试器在遇到断点之前停止。

如果我重新启动 `w3wp`进程并刷新“附加到进程”，我可以调试但只有一个页面周期。

*   我已经在 Vista 上重新安装了 IIS7。
*   我用 Service Pack 1 更新了 VS2008。

我想知道为什么调试在一页周期后停止。这发生在我所有的项目中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:23:04.560

我知道这是一个相当古老的问题。但是，作为记录，您还需要确保 VS 以管理员权限运行。这也可能导致您遇到的情况。

# c# - 比 .ToArray() 更好的东西来强制枚举 LINQ 输出

> ID：314100
> 
> 赞同：14
> 
> 时间：2008-11-24T13:13:04.087
> 
> 标签：c#, linq, .net-3.5

我正在使用 LINQ to 对象并有一个函数，在某些情况下，我需要在调用之前修改基础集合`Aggregate(...)`，然后在函数返回`Aggregate(...)`. 我当前的代码如下所示：

```
bool collectionModified = false;
if(collectionNeedsModification)
{
    modifyCollection();
    collectionModified = true;
}

var aggregationResult = from a in
                            (from b in collection
                             where b.SatisfysCondition)
                             .Aggregate(aggregationFunction)
                        select a.NeededValue;

if(collectionModified)
    modifyCollection();

return aggregationResult; 
```

但是，如所写，如果我修改集合，我会得到错误的结果，因为我将集合恢复到`aggregationResult`枚举之前的原始状态，并且对 LINQ 结果进行延迟评估。我目前的解决方案是`.ToArray()`在我的 LINQ 查询上使用，如下所示：

```
var aggregationResult = (from a in
                            (from b in collection
                             where b.SatisfysCondition)
                             .Aggregate(aggregationFunction)
                         select a.NeededValue).ToArray(); 
```

结果数组的大小总是很小（< 100 个项目），因此内存/处理时间不是问题。这是处理我的问题的最佳方法，还是有更好的方法来强制评估 LINQ 查询？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T13:29:11.450

只是为了检查我理解你 - 你基本上想遍历所有结果，只是为了迫使任何副作用发生？

副作用通常是一个坏主意，正是因为这种逻辑更难理解。话虽如此，执行此操作并强制进行全面评估的最简单方法可能是遍历它：

```
foreach (var result in aggregationResult)
{
    // Deliberately empty; simply forcing evaluation of the sequence.
} 
```

或者，您可以使用[LastOrDefault()](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.lastordefault.aspx)来避免 ToArray() 中涉及的所有复制。只要结果没有实现（涉及捷径），[Count()就可以了。](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.count.aspx)`IList<T>`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-07-30T13:08:56.757

（注意：在没有编译器的情况下打字，所以代码未经测试）

如果您已经将 Reactive Extensions for .NET 作为依赖项，则可以使用 Run()：

```
aggregationResult.Run(); 
```

但为此添加依赖项可能不值得。

你也可以自己实现 Run 方法作为扩展方法：

```
public static MyLinqExtensions 
{
     public static void Run<T>(this IEnumerable<T> e)
     {
         foreach (var _ in e);
     }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T13:26:30.767

最好避免像上面的 modifyCollection 这样的副作用函数。

更好的方法是创建一个返回修改后的集合（或查询）的函数，让最初的集合保持不变。

```
var modifiedCollection = ModifyCollection(collection, collectionNeedsModification);

var aggregationResult = from a in
                        (from b in modifiedCollection
                         where b.SatisfysCondition)
                         .Aggregate(aggregationFunction)
                    select a.NeededValue; 
```

其中 ModifyCollection 是根据 collectionNeedsModification 布尔参数在参数中返回修改后的集合（或查询）的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T13:18:11.177

如果你总是使用结果，我认为你的方法没有问题（因为你的结果集不大，它不会消耗太多内存。顺便说一下，如果你这样做并且从不使用结果，它会造成性能损失）。所以，是的，这是正确的方法。

# .net - 根命名空间和程序集名称之间的区别

> ID：314101
> 
> 赞同：20
> 
> 时间：2008-11-24T13:13:24.977
> 
> 标签：.net, namespaces, assemblies

两者有什么区别？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-11-24T13:33:29.523

假设您正在谈论 .NET（与 Visual Studio 相关），那么根命名空间就是您在 Visual Studio 项目中创建的每个类都将成为其中的一部分。它也是在项目文件夹中创建类时自动分配的任何子命名空间的基础。

因此，使用 ACMECorp.Bombs 的基本命名空间，您的所有类都将成为 ACMECorp.Bombs 命名空间的一部分，因此 GravityBomb 类的全名为 ACMECorp.Bombs.GravityBomb。在名为 GuidedBombs 的项目文件夹中创建的名为 FlyingBomb 的类的完整类型名称为 ACMECorp.Bombs.GuidedBombs.FlyingBomb。

程序集名称只是您的代码将被编译为可执行文件或库等的编译文件的名称......

我经常看到的一个问题是**您的程序集名称是否应该与根命名空间相同并且也与您的项目名称相同**（再次在 Visual Studio 中）。我曾经的想法是，您应该有一个与程序集名称相同的项目名称，与根名称空间相同，就像 Visual Studio 的默认设置一样。但是，如果您需要进行一些重大的重构和重命名，这可能会让人很头疼，尤其是在您使用源代码控制的情况下（因为您应该开始重命名项目文件夹）。

**我的建议**是您的项目名称只是项目内容的描述性名称。您的程序集名称应包含技术区域和组件描述，或公司名称和技术区域（取决于您的偏好），并且您的根命名空间应符合 Microsoft 命名标准的描述，因此：

> 项目：生物识别设备访问
> 
> 程序集：BiometricFramework.DeviceAccess.dll
> 
> 命名空间：ACME.BiometricFramework.DeviceAccess

**给你一些参考资料：**

[http://blogs.msdn.com/brada/archive/2003/04/19/49992.aspx](http://blogs.msdn.com/brada/archive/2003/04/19/49992.aspx)

[http://msdn.microsoft.com/en-us/library/ms229026.aspx](http://msdn.microsoft.com/en-us/library/ms229026.aspx)

[http://msdn.microsoft.com/en-us/library/ms229048.aspx](http://msdn.microsoft.com/en-us/library/ms229048.aspx)

# java - 我怎样才能使这个java泛型演员？

> ID：314108
> 
> 赞同：9
> 
> 时间：2008-11-24T13:19:11.797
> 
> 标签：java

我怎样才能使这个java泛型演员？

```
public interface IField {

}

class Field implements IField { // package private class

}

public class Form {
  private List<Field> fields;

  public List<IField> getFields() {
    return this.fields;

  }

} 
```

return 语句会引发编译器错误（我知道原因 - 我阅读了泛型教程），但编写这样的代码会非常方便。

如果我将“字段”声明为 List，我将需要在 Form 类的其他方法中对 Field 进行大量强制转换。

我可以强迫那个该死的编译器改变它的规则并编译那个返回语句吗？

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T13:33:19.193

IMO 更好的解决方案是将方法的签名更改为使用有界通配符：

```
public List<? extends IField> getFields() 
```

这将使调用者将列表中“出”的任何内容视为 IField，但不会让调用者将任何内容添加到列表中（没有强制转换或警告），因为他们不知道“真实”类型是什么名单是。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-24T13:22:37.140

碰巧，您可以，因为 Java 泛型只是被嫁接，而不是类型系统的一部分。

你可以做

```
return (List<IField>)(Object)this.fields; 
```

因为所有`List<T>`对象都是相同的底层类型。

请记住，这允许任何人将任何类型的实现`IField`放入您的列表中，因此如果您的集合不是只读的，您可能会遇到困难。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T13:37:13.477

不要这样做。

A`List<Field>`不是`List<IField>`. 您可以尝试强制编译器接受（我认为这是不可能的，但我希望这是不可能的），但这会给您带来麻烦。编译器将允许用户将派生自 IField 的 AnotherField 引入给定的 List 中，从而破坏您的不变量，并破坏泛型提供的类型安全性。稍后使用`List<Field>`will break 因为提取奇怪元素会使隐式强制转换失败，您不会期望它发生。

如果您确实需要返回 a`List<IField>`而不是`List<Field>`，那么我建议您生成一个包含相同元素的新列表。如果您可以修改界面，请选择[Jon Skeets](https://stackoverflow.com/questions/314108/how-can-i-make-this-java-generic-cast#314138)解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-18T08:01:20.690

如果调用者不需要能够修改列表：

```
return Collections.<IField>unmodifiableList(this.fields); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T13:27:20.720

阳光是对的，你可以投射它。

另一个解决方法是仔细检查您是否真的需要 a `List<Field>`，或者您是否可以将内部`fields`变量更改为`List<IField>`.

只要您只在`IField`接口上的列表内容上使用方法，您就应该能够进行简单的交换。

# asp.net - 如何在一个共享主机帐户上托管多个 ASP.NET 网站？

> ID：314109
> 
> 赞同：0
> 
> 时间：2008-11-24T13:20:24.027
> 
> 标签：asp.net

使用 PHP，我可以在本地创建多个 PHP 网站，然后将每个网站上传到我的 PHP 托管服务的自己的子目录中。

但是，使用 ASP.NET，我似乎只能将 ASP.NET 上传到托管服务的根目录。如果我上传到子目录，我会收到错误

```
section registered as allowDefinition='MachineToApplication' beyond application level
<authentication mode="Windows"/> 
```

*   有没有办法解决这个问题，所以我可以在自己的目录中拥有许多 ASP.NET 网站？
*   如果没有，使用 ASP.NET MVC 能否解决这个问题？
*   或者通常不可能将多个 ASP.NET 站点通过 FTP 传输到共享主机提供商？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T13:34:18.663

我不知道您的托管服务，但我便宜的 GoDaddy 服务允许我将子目录指定为 ASP.NET 应用程序。我正在运行 BlogEngine.NET 和 BugTracker.NET，每个都有自己的 Web.config。

您需要联系您的托管服务，使用他们的帮助页面等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T13:34:52.187

在 IIS 中，您可以将子目录和虚拟目录配置为应用程序。大多数 IIS 托管服务提供商应该有某种工具可以让您执行此操作。

在我的托管服务提供商[discountasp.net](http://discountasp.net)（可以说是最受欢迎和最好的 ASP.NET 托管服务提供商之一！）中，当您在“Web 应用程序工具”下登录时，可以在主导航中找到它。

此外，如果您有能力在主域下创建和管理子域，我编写了一个开源工具，可以让您将应用程序映射到子域……例如，不必执行 mydomain.com/app1， mydomain.com/app2 等，我的工具会让你做 app1.mydomain.com、app2.mydomain.com 等。可以在 CodePlex 上找到：http: [//www.codeplex.com/sharedhostingsplittr](http://www.codeplex.com/sharedhostingsplittr)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T13:35:20.797

您需要与您的托管服务提供商交谈，这应该是可能的，但前提是他们允许这样做。我想你需要创建多个虚拟目录。

# localization - 如何将数据库中的文本国际化？

> ID：314110
> 
> 赞同：7
> 
> 时间：2008-11-24T13:21:35.957
> 
> 标签：localization, internationalization

如果您想在全球范围内销售，则必须拥有一个完全国际化的应用程序。在 Java 中，我们使用资源包来解决静态文本代码方面的问题。

但是您如何处理存储在数据库中的文本？从静态定义开始，到用户可修改的对象，以用户输入的数据结束。

假设您有一个由具有不同区域设置的用户使用的数据库 - 您如何处理这个问题？您的国际化程度如何？你在哪里画线？什么解决方法可以阻止用户接收他们不懂的语言的文本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T13:27:20.690

不要将系统生成的文本存储在数据库中。相反，存储一个代码（如消息编号），然后在 GUI 级别将其国际化。确保直接来自数据库的唯一文本是用户自己输入的文本。确保您的数据库设置为接受 unicode 文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T14:19:15.077

首先，要非常清楚这些限制。对于用户创建的内容，如果您想本地化用户输入到您的应用程序中的内容，您正在查看社区翻译（不稳定）、机器翻译（不可靠）或付费人工翻译（昂贵！）。您可能想要求您的用户提供两个版本 - 一个用于您的默认文化（英语？），另一个用于他们的本地化文化，以便您可以为其他用户提供备用翻译？

其次，为一些极其冗长的数据库迁移做好准备……如果您在 Excel 电子表格中有四列文本，那么您突然需要将每个值插入翻译系统，检索本地化 ID，然后将其存储*起来*在您实际导入的表中 - 并且`SELECT *`只会为您提供短语 ID，您需要通过根据翻译表对它们进行本地化来将其解析回字符串。

也就是说 - 您可以本地化由典型项目中的数据库驱动的许多查找表、下拉列表等。其他评论已经提到在数据库中存储引用外部资源文件或电子表格的 StringId 值，但如果您有兴趣将所有本地化文本与数据本身一起保存在数据库中，那么您可能会发现这种方法很有用。

我们使用了一个名为 Phrase 的表，其中包含应用程序中每段文本的 ID 和默认（英文）内容。

您的其他表格最终看起来像这样：

```
CREATE TABLE ProductType (
    Id int primary key,
    NamePhraseId int, -- link to the Phrase containing the name of this product type.
    DescriptionPhraseId int
) 
```

创建第二个表 Culture，其中包含您支持的特定和中性文化。对于奖励积分，将此表实现为自引用树（每个文化记录包含一个可为空的 ParentCultureCode 引用），因此您可以从特定文化（加拿大法语的“fr-CA”）回退到中性文化（“fr”如果不存在区域本地化），到您的不变/默认文化（通常是“en”，因为它被广泛使用）

您的实际翻译位于 LocalizedPhrase 表中，如下所示：

```
CREATE TABLE LocalizedPhrase (
  PhraseId int primary key,
  CultureCode varchar(8) primary key,
  Content nvarchar(255) -- the actual localized content
) 
```

如果您想提供男性/女性特定的本地化，您可以扩展此模型：

```
CREATE TABLE GenderedLocalizedPhrase (
  PhraseId  int primary key,
  CultureCode varchar(8) primary key,
  GenderCode char(1) primary key, -- 'm', 'f' or '?' - links to Gender table
  Content nvarchar(255)
) 
```

您将希望将整个表图形缓存在内存中并相应地修改查询/连接策略 - 缓存 Phrase 类中的本地化并覆盖 Phrase 对象上的 ToString() 方法以检查当前线程文化是一种方法。如果您尝试在查询中执行此操作，则会产生巨大的性能成本，并且每个查询最终都会如下所示：

```
-- assume @MyCulture contains the culture code ('ca-FR') that we are looking for:
SELECT 
    Product.Id, 
    Product.Name, 

    COALESCE(ProductStatusLocalizedPhrase.Content, ProductStatusPhrase.Content) as ProductStatus, 
    COALESCE(ProductTypeLocalizedPhrase.Content, ProductTypePhrase.Content) as ProductType, 
  FROM Product

    INNER JOIN ProductStatus ON Product.StatusId = ProductStatus.Id
    INNER JOIN Phrase as ProductStatusPhrase ON ProductStatus.NamePhraseId = Phrase.Id
    LEFT JOIN LocalizedPhrase as ProductStatusLocalizedPhrase 
      ON ProductStatus.NamePhraseId = ProductStatusLocalizedPhrase.Id and CultureCode = @MyCulture

    INNER JOIN ProductType ON Product.TypeId = ProductType.Id
    INNER JOIN Phrase as ProductTypePhrase ON ProductType.NamePhraseId = Phrase.Id
    LEFT JOIN LocalizedPhrase as ProductTypeLocalizedPhrase 
      ON ProductType.NamePhraseId = ProductTypeLocalizedPhrase.Id and CultureCode = @MyCulture 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T11:57:08.487

我们将数据库中的许多文本更改为“key:default text”，然后在我们的翻译文件中查找“key”。这涵盖了客户在数据库中没有更改的所有文本（例如，所谓的“信用票据”）。当客户确实更改了文本时，他们只需删除密钥，这样他们就总能获得价值。

我们的系统有一些表格，其中包含需要上述配置数据的表格，如果每个客户只需要一种语言，则只包含客户输入的文本的表格不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T13:42:41.750

> 什么解决方法可以阻止用户接收他们不懂的语言的文本？

这只是用户输入数据的问题。因此，如果您想避免其他用户看到他们可能不理解的语言的内容，请将语言环境代码与内容一起存储，并且只向具有相同语言环境/用户选择的语言的任何人显示该内容。

另一方面，用户可能知道几种语言，因此我不会限制他们查看内容，我只会添加一条通知，例如“此内容无法以您选择的语言提供，...”，然后将内容显示在可用的语言。通过这种方式，您可以增加用户获得她可以理解的内容的可能性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-22T01:01:48.790

假设您有一张桌子：

```
create table countries (
  country_id int primary key,
  short_name text not null unique,
  official_name text not null unique,
  iso_code char(2) not null unique
);

insert into countries values (12, 'Algeria', 'The People''s Democratic Republic of Algeria' 'DZ'); 
```

然后创建一个转换表：

```
create table countries_t (
  country_id int not null references countries(country_id),
  short_name text not null,
  official_name text not null,
  locale varchar(5) not null,

  primary key (country_id, locale)
);

insert into countries_t values
(12, 'Algérie', 'la République algérienne démocratique et populaire', 'fr'),
(12, 'Algerien', 'Demokratische Volksrepublik Algerien', 'de-DE'); 
```

创建一个视图以根据[用户](https://dev.mysql.com/doc/refman/5.5/en/user-variables.html)[定义](http://technet.microsoft.com/en-us/library/ms189252%28v=sql.105%29.aspx)的会话变量返回数据。以下是特定于 PostgreSQL 的，但您的数据库可能支持自定义会话变量，否则使用临时表：

```
create view countries_i18n as 
  select 
    a.country_id,
    coalesce(c.short_name, b.short_name, a.short_name) as short_name, --default to countries.name if translation not found
    coalesce(c.official_name, b.official_name, a.official_name) as official_name
    countries.iso_code
  from countries a
  left join countries_t b on b.id = a.id and b.locale = current_setting('my_custom_guc.locale')
  left join countries_t c on c.id = a.id and c.locale = left(current_setting('my_custom_guc.locale'), 2); --fall-back to 2-letter locale 
```

用德语查询德语表：

```
SET my_custom_guc.language_code = 'de-DE';

select country_id, iso_code, short_name, official_name from countries_i18n;

country_id  iso_code  short_name  official_name
-----------------------------------------------
12          DZ        Algerien    Demokratische ... 
```

用加拿大法语查询表（回退到通用法语）：

```
SET my_custom_guc.locale= 'fr-CA';

select country_id, iso_code, short_name, official_name from countries_i18n;

country_id  iso_code  short_name  official_name
-----------------------------------------------
12          DZ        Algérie     la République ... 
```

用西班牙语查询表格（没有翻译，返回英文）：

```
SET my_custom_guc.language_code = 'es';

select country_id, iso_code, short_name, official_name from countries_i18n;

country_id  iso_code  short_name  official_name
-----------------------------------------------
12          DZ        Algeria    The People's D ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T13:32:33.160

静态数据是最简单的，我会创建一个翻译表，所以想象一个 UserStatus 表，它有一个 StatusId、TranslationToken，然后 TranslationTable 有一个令牌、语言和文本。

或者类似地，您可以只返回令牌以供应用程序使用您的资源文件进行处理。

至于用户输入数据，这要复杂得多。您至少需要接受 unicode 字符，然后问题就变成了排序和比较。排序是最大的一项。您可以做的很多事情取决于您的应用程序。因此，如果您的数据库在任何时候都只需要支持一种语言（想象一下，如果您的应用程序分发给您的客户），那么排序规则就是一个有争议的问题，因为您可以在安装时设置它。

但是，如果您必须在单个数据库中支持多种语言，则需要正确处理排序规则。我们发现动态更改排序规则的唯一方法是在查询中设置它，这需要生成动态 sql。这个例子是你将俄语、英语和波兰语都存储在同一张表的一个字段中。

我们从未探索过拉丁语和西里尔语排序规则之外的任何东西，但我想亚洲语言也会如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T13:42:40.127

我们为我们的系统使用 XML 文件。该文件包含与我们模块的特定部分的关键关联。这样我们就可以快速地做XPath 来检索信息。每种语言都有 1 个文件（我们目前支持 2 种语言，但添加语言非常简单，只需复制粘贴文件即可）。这个解决方案并不完美，但有一些优点：

1.  不在数据库中。
2.  可以由编程之外的人编辑。
3.  易于在多个视图中实现（我们有 WinForm 和 WebForm）。

# c# - Infragistics UltraGrid 中的单元格值变化引发了哪个事件？

> ID：314114
> 
> 赞同：5
> 
> 时间：2008-11-24T13:23:50.493
> 
> 标签：c#, vb.net, winforms, infragistics, ultrawingrid

我在 Windows 窗体应用程序中使用 Infragistics UltraGrid。
我需要一个在单元格值更改时引发的事件。
我尝试了很多活动，例如`AfterCellActivate`，`AfterCellUpdate`但找不到合适的活动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T13:54:22.570

AfterCellUpdate 是您想要的，但您可能需要调用：

*   YourGridControl.PerformAction（Infragistics.Win.UltraWinGrid.UltraGridAction.EnterEditMode）
*   YourGridControl.PerformAction（Infragistics.Win.UltraWinGrid.UltraGridAction.ExitEditMode）

实际触发更新，具体取决于您希望何时触发。

我注意到它有时会在何时触发事件时很挑剔，否则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T12:47:13.033

当用户开始在单元格中键入值时，会触发一个 CellChange 事件。如果您需要确切知道何时修改单元格，则此事件很有用，因为 AfterCellUpdate 事件仅在用户退出他/她正在更改的单元格时触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T13:47:31.927

AfterCellUpdate 应该是正确的事件...确保在 EventManager 中启用了该事件！

# documentation - 您的团队使用什么工具来编写用户手册？

> ID：314117
> 
> 赞同：36
> 
> 时间：2008-11-24T13:24:23.487
> 
> 标签：documentation, wiki, markdown, manuals

基本要求是：

*   人类可读/文本格式（便于版本控制）
*   在线（用于协作）
*   轻松格式化（markdown ok，html 太多了）
*   严格的格式（所以作者不会发明新类型的标题、项目符号等）
*   可导出为 PDF、HTML
*   轻松备份和部署（因此我们可以作为只读版本“部署”到客户站点）

我们正在考虑使用某种 wiki 引擎，但它需要使用文件进行存储或对客户有其他“部署”方式，并且易于安装/维护。此外，它必须是免费/便宜的（confluence 太贵了）

有什么建议么？

编辑：我不是在寻找记录代码的工具，我们已经使用 Sandcastle 进行了介绍。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T14:02:28.183

[乳胶](http://en.wikipedia.org/wiki/LaTeX "乳胶")

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T13:50:27.817

尽管它可能无法满足您的所有要求，但[DokuWiki](http://www.dokuwiki.org/dokuwiki)可能值得一看。

与其他 wiki 一样，它具有[简单的语法](http://www.dokuwiki.org/syntax)、版本控制以[跟踪修订](http://www.dokuwiki.org/attic)、生成[目录](http://www.dokuwiki.org/toc)和[全文搜索](http://www.dokuwiki.org/search)功能，这对于帮助系统来说非常方便。

您可能需要评估[功能列表](http://www.dokuwiki.org/features)，看看它是否能满足您的需求。

此外，似乎也有很好[的可用插件集合](http://www.dokuwiki.org/plugins)。虽然我没有使用过 DokuWiki 或其插件，但似乎也有可用于[PDF 导出](http://www.dokuwiki.org/plugins?plugintag=pdf)的插件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T13:52:12.870

对于我们的 API，我们使用[Doxygen](http://www.doxygen.org/)，这很棒。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-06-28T10:18:06.300

[Pandoc](http://johnmacfarlane.net/pandoc/index.html)是用于在各种标记格式之间进行转换的出色工具。我们用 Markdown 编写文档，并使用 Pandoc 转换为其他格式。

从 pandoc 网站：

> 如果您需要将文件从一种标记格式转换为另一种标记格式，pandoc 就是您的瑞士军刀。Pandoc 可以读取 markdown 和（子集）reStructuredText、textile、HTML 和 LaTeX，它可以编写纯文本、markdown、reStructuredText、HTML、LaTeX、ConTeXt、PDF、RTF、DocBook XML、OpenDocument XML、ODT、GNU Texinfo、 MediaWiki 标记、纺织品、groff 手册页、Emacs 组织模式、EPUB 电子书以及 S5 和 Slidy HTML 幻灯片放映。包含的 markdown2pdf 包装脚本也支持 PDF 输出（通过 LaTeX）。

*Pandoc 因开源并以 Haskell 的热度编写而获得加分；）*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-18T08:49:36.390

[关于Asciidoc](http://www.methods.co.nz/asciidoc/)，我不能说足够多的好话。它有一个非常简单的标记语法，可以生成从 pdf 到 roff 的所有内容，可移植实现并且非常容易插入到任何 wiki 中，只需进行一些小的更改。

即使在它的标记状态下，它也非常非常容易阅读。使用它时我唯一需要摆弄的是桌子，但这并不太难。

如果您将文本格式的文件保存在存储库中，则修订跟踪非常简单。

对于代码文档，我使用[doxygen](http://www.doxygen.nl)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-24T13:35:36.973

我们将[帮助和手册](http://www.helpandmanual.com)用于手册和帮助文件。没有html导出，但是提供了html帮助、winhelp、pdf等格式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T13:54:58.073

我们正在使用维基。我推荐[MoinMoin](http://moinmo.in/)因为

*   设置非常简单（即使在笔记本电脑上）
*   备份非常简单（您甚至可以将 wiki 提交到版本控制系统，以便在笔记本电脑之间同步以供离线使用）。
*   不错的语法
*   易于扩展
*   易于搜索

我们没有使用 Word 之类的东西，因为：

*   文档腐烂太快
*   搜索所有文档很痛苦
*   信息位之间的链接是一种痛苦
*   版本之间没有差异
*   让任何 VCS 都崩溃的二进制格式
*   没有深度书签
*   文档变得太大，然后变得笨拙：拆分（不再搜索）或等待很长时间才能加载。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-24T14:04:05.980

您没有提及您正在使用的语言/框架。那里有非常好的文档工具，但其中一些特定于您正在开发的内容。我们是一家 C# 商店，所以我的回答仅适用于您使用 .NET 的情况。

我们使用[Sandcastle](http://www.codeplex.com/Sandcastle)，它不仅是免费的，而且是开源的。虽然人们主要将其严格地视为从 XML 文档生成文档的应用程序，但您可以在 MAML 中提供您自己的内容。它可以针对 CHM 和网站部署，满足我们的需求。还有一些额外的工具可以提供诸如标记收藏夹和主题评级等内容，但我们还没有开始使用它们。

这为我们提供了内部和外部文档。由于我们还使用 Team Foundation Server，因此我们使用 Sharepoint 中团队项目的内置 Wiki，但这更适合项目协作。

**编辑：修复了断开的链接，并且还想提一下我们使用的与 Sandcastle 结合使用的其他工具。[Sandcastle Help File Builder](http://www.codeplex.com/SHFB)和[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)等都是常用工具。第一个是编辑 Sandcastle 项目和 MAML，第二个是提高代码中的注释质量。**

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-28T10:23:19.227

试试[狮身人面像](http://sphinx.pocoo.org/)。所有 python 文档都是使用这个工具制作的[http://docs.python.org/](http://docs.python.org/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T14:17:37.733

对于“手册”，Docbook。这是一种为技术文档设计的 SGML 方言。 [http://www.docbook.org/](http://www.docbook.org/)。它可能不符合您的“简单标记”标准，但如果您为它编写自己的 CSS 样式表，它肯定会在 LaTex 中产生很好的输出（然后可以转换为 PDF）和良好的 HTML 输出。保存在版本控制中的文本文件。所有程序还使用一个库，该库将命令行参数解析与“--help”输出以多种格式（普通、手册页和文档）相结合。对于 API 参考，当然是 doxygen。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-24T14:33:13.427

在我目前的工作中，我们大量生产一次性软件，因此文档经常被放在一边，并在 Word 中完成。

然而，在我的上一份工作中，文档团队似乎不断地对[mad cap software 的产品“Flare”](http://www.madcapsoftware.com/products/flare/overview.aspx)大肆咆哮。它允许您以一种格式编写并发布到多种媒体，因此您的手册也可以是您的在线帮助或网站等...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-24T13:36:45.473

试试[Dikiwiki](http://wiki.developer.mindtouch.com/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-24T13:44:11.233

我们使用 Word。它被放入我们的版本控制中，所以我们有历史记录（每个项目都有一个文档文件夹）。格式可以使用模板进行控制，我们现在已经设置了所有这些模板，因此在布局标准内进行更改很容易。文件可以导出为 PDF。您可以将它们发布为只读文档以与用户共享。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-24T14:02:34.173

我们在[DocToHelp](http://www.doctohelp.com/SuperProducts/DocToHelp/)方面取得了巨大成功。它适用于基于 Microsoft Word 的文档以及其他形式，它甚至为 Visual Studio 提供了一些很棒的集成功能。

最好的部分是一旦您将核心文档库导入 DocToHelp，您可以选择多种导出格式中的任何一种，无论是 WinHelp、HTML 帮助、Java 帮助还是漂亮而精美的可搜索网络帮助。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-24T14:09:45.033

对于我使用 Doxigen 的代码。我更喜欢 linux 版本，我在 Windows 版本中遇到了一些功能问题

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-24T15:16:50.077

我的公司将 MediaWiki 和 TikiWiki 用于大多数文档。我们还有一个人可以将东西编译成 MS Word 和 PDF 格式，以便打印/发送给客户。我建议你避免像瘟疫一样避免 TikiWiki。MediaWiki 很棒，因为它非常易于使用，而且每个人都知道如何使用它——它是事实上的标准 wiki，而且当之无愧，恕我直言。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-18T08:24:14.940

有一段时间我们在使用 DocBook，但是很难扩展更高级和必要的功能（语法突出显示、拆分为多个文件、多语言管理等）。后来，我们决定从头开始编写自己的系统并将其作为开源发布：[链接文本](http://www.invenzzia.org "类型友好")。它使用纯文本文件和 Markdown 作为语法语言，现在我们拥有了我们需要的一切。缺点是目前可能没有 Markdown 解析器可以生成 HTML 输出以外的内容。目前这已经足够了，但我们正在考虑尽快实现 PDF 支持。

此外，我们将 MediaWiki 维护为基于社区的帮助。

# vb6 - 是否可以使用 Netbeans 处理 VB6 项目？

> ID：314128
> 
> 赞同：7
> 
> 时间：2008-11-24T13:27:25.790
> 
> 标签：vb6, netbeans

我必须处理几个 VB6 遗留项目，尽管有一些好的 VB6 插件（例如 CodeSMART），但我越来越讨厌 IDE，尤其是现在我有机会在一个新项目上使用 Java/Netbeans。不幸的是，至少在接下来的几年里它会保持这种状态。

所以我问自己：能否通过插件扩展 Netbeans IDE 以支持 VB6 项目？

这就是我的梦想：

*   更好的代码导航（例如 Ctrl+Click）
*   更好的代码高亮
*   代码折叠
*   简单的重构
*   在层次结构中组织源文件
*   我自己的 VB6 特定警告（“`option explicit`例如缺失”）
*   代码生成器（如在 Java 中用于 getter 和 setter）
*   集成调试（但我认为这几乎是不可能的）
*   代码自动格式化

可以做到吗？有人使用过 Netbeans 和自定义语言吗？最好的开始方式是什么？

编辑：我想自己做这件事，因为我知道这是一个高度专业化的功能请求:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T14:19:25.827

我进行了快速搜索以查看是否有可用的插件来支持 Netbeans 上的 Visual Basic，但找不到任何插件。

正如您所提到的，您愿意为 Netbeans 编写 VB 支持，您可能想看看[Schliemann - 在 NetBeans IDE 6.0 中轻松集成脚本语言](http://www.netbeans.org/community/magazine/html/03/schliemann/)。本文提供有关语言支持如何在 Netbeans 6 中工作的信息以及添加新语言的方法。

您可能还想查看[通用脚本框架](http://wiki.netbeans.org/Gsf)，它用于为 Ruby、HTML、CSS 和 JavaScript 提供支持。与 Project Schliemann 相比的优点是它也允许编译新语言，但缺点是您必须提供词法分析器和解析器来支持新语言。

以下是一些额外的资源，可能会在您的任务中派上用场：

*   [贡献模块](http://www.netbeans.org/community/contribute/modules.html)- 首先，检查以确保没有其他插件可以满足您的需求。
*   [NetBeans 插件快速入门](http://platform.netbeans.org/tutorials/60/nbm-google.html)- 向 IDE 添加功能的介绍。
*   [通用语言框架 (Project Schliemann)](http://wiki.netbeans.org/Schliemann) - 此信息可能已过时，因为它将当前版本的 Netbeans 引用为“未来”版本。
*   [language.netbeans.org](http://languages.netbeans.org/) - 该站点被列为 Project Schliemann 的官方页面。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T15:43:28.510

支持 VB6 的 IDE 存在几个问题，因为它用于编译和调试的独特设置。与 Java 或 C/C++ 不同，VB6 中的所有内容都是专有的，并且在很大程度上只能通过当前 IDE 的插件 api 访问。

作为 VBx 程序员，自从它最初发布以来，维护和使用 VB6 的关键是学习如何在软件在调试模式下运行时进行编码和调试。VB6 的优势仍然在于您可以在运行时动态添加或更改代码并立即测试结果。由于此功能的强大功能，我的大部分时间都花在调试模式上。

这是与其他语言和 IDE 不同的体验和方法。很大程度上是因为 VB 1.0 是第一个拥有它所具有的功能的版本。

并不是说拥有很多这些功能会很好。使用 VB.NET 2008 IDE 后使用 VB6 显示 VB6 的时代真的很快。但是，由于您必须处理那些遗留项目，您只能做工具允许您做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:04:20.427

您目前正在为您的 VB6 项目使用什么 IDE？我的记忆有点模糊，因为那是很久以前的事了，但我记得 Visual Studio 相当不错，尤其是在那个时代。话虽如此，我不知道您在 Eclipse 的 VB6 支持上会取得多大的成功。当然可以，但我真的不认为您会获得比 VS 已经提供给您的功能丰富得多的功能。至少不够丰富以至于值得开发功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T14:38:24.413

我认为你很不走运，但是看看[这个问题](https://stackoverflow.com/questions/226565/alternative-ide-for-vb6)，答案可能会让你的生活更轻松......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-24T13:55:31.613

不是。Netbeans 主要是一个 Java IDE。虽然它支持Java以外的很多语言，但在Java社区中对VB6并没有太大的兴趣。

# svn - 有没有办法在 TortoiseSVN 中“部分”提交文件？

> ID：314132
> 
> 赞同：48
> 
> 时间：2008-11-24T13:30:22.693
> 
> 标签：svn, tortoisesvn

我想使用 TortoiseSVN 提交文件的一部分，有什么方法可以做到吗？

我将举一个例子来说明我为什么要这样做。

我有一个文件，其中包含一些在构建过程中被替换的定义，如下所示：

```
#define SOME_PATH "[SOME_PATH]" 
```

这个 [SOME_PATH] 标记在构建过程中被替换，但是当我编码时，我必须更改它，以便我机器中的实际路径。

所以每次我提交时，我都需要备份一些行，恢复它们，提交然后恢复备份，这有点烦人。

有没有办法告诉 TortoiseSVN “忽略” X、Y 和 Z 行的一些变化？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2014-01-15T23:18:56.117

票数最高的答案已过时。

来自 tortoiseSVN 网站： [http ://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-commit.html](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-commit.html)

> 仅提交部分文件
> 
> 有时您只想提交对文件所做的部分更改。这种情况通常发生在您正在处理某事但需要提交紧急修复程序时，并且该修复程序恰好位于您正在处理的同一文件中。
> 
> 右键单击文件并使用上下文菜单→提交后恢复。这将按原样创建文件的副本。然后您可以编辑该文件，例如在 TortoiseMerge 中并撤消您不想提交的所有更改。保存这些更改后，您可以提交文件。
> 
> 提交完成后，文件的副本会自动恢复，您将拥有所有未提交的修改的文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-24T13:32:20.210

不，Subversion 在文件级别工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T13:33:39.863

不。

最好的方法是检查一些文件，如“build_paths.h.default”，然后在每个构建平台上，将其复制到 build_paths.h，修改它以适应，然后告诉 SVN IGNORE build_paths.h。最后在你的程序中#include "buiild_paths.h"。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-06-27T13:02:15.843

一般来说是的！最新版本的 torroise svn (1.8) 中添加了功能 请参阅[发行说明](http://tortoisesvn.net/tsvn_1.8_releasenotes.html#commitparts) 不幸的是，这是一个手动过程，可能不太适合您的特定用例 - 对于“我正在使用新功能和已经注意到一个错误并只想提交错误修复”的情况。

对于您的情况，我使用在构建过程中使用的模板文件来创建实际使用的文件（此文件仅从模板文件创建，没有其他内容）。我在 svn 中有模板文件，但忽略了实际文件。这意味着我只需要在新结帐后构建一次，然后我的工作副本就可以了——但标签的值没有提交。如果我需要添加新标签，我会在模板文件中添加并重建我的工作副本。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T13:33:16.450

短版：没有。Subversion 是一个全有或全无的系统（就像我所知道的所有源代码控制系统一样）

更长的版本：不，但是如果您使用 NANT 之类的东西来构建，您可以使用 xmlpoke 或类似的东西在构建时重写部分文件。为我们工作:) 我们在构建时重写了大约 6 个 web.config 文件和各种其他应用程序配置文件（好吧，在构建部署包时）......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-03T08:19:23.290

您的问题的解决方案不是让 subversion 为您执行此操作，而是配置您的应用程序，以便将环境特定的详细信息（例如 [SOME_PATH] 值）“外部”存储到签入的代码中。

您是通过标记为被 SVN 忽略的单独文件执行此操作，还是将此信息存储在环境变量中，取决于您的开发语言/操作系统和其他一些因素。

无论您使用哪种解决方案，安排某种默认值可能是明智的，以允许未指定值的情况。

是否应该在构建时或运行时应用细节也可能值得考虑 - 如果您可以安排后者，它会使应用程序的新版本的部署更加容易。

在 Web 应用程序中可以找到一个典型示例，其中需要数据库连接，但实际使用的数据库实例在开发环境和生产环境之间是不同的。在这种情况下，数据库配置是在 Web 服务器上定义的（不在应用程序中，它只是向 Web 服务器询问具有给定名称的数据库连接），开发和生产服务器具有不同的配置。然后可以将**相同**的Web 应用程序部署到两台服务器，并让每个应用程序实例访问适当的数据库。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T13:43:37.410

您还可以定义：

*   一个预提交钩子，它将为您处理回滚，
*   和一个 post-commit 挂钩来恢复您的文件。

哎呀...实际上这不是一个好主意，根据[SVN 手册](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.reposadmin.create.hooks)。

*   所有触发器都在服务器端执行（不是客户端，ClearCase 就是这种情况）
*   Subversion 保留存储库数据的某些位的客户端缓存，如果您以这种方式更改提交事务，这些缓存将变得无法检测到陈旧。这种不一致会导致令人惊讶和意外的行为。而不是修改事务，您应该简单地在 pre-commit 钩子中验证事务，如果它不满足所需的要求，则拒绝提交

一种[可能的方法](http://www.nabble.com/Automatic-replacement-on-commit-ts19374972.html)是在提交后脚本中修改您的文件，然后将该文件作为独立更改提交，然后在另一个提交后脚本中恢复它......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T13:57:49.253

您正在寻找的是各种分布式版本控制系统的功能，例如[darcs](http://darcs.net/)。

# html - 黑莓的 Webapp 开发工具

> ID：314134
> 
> 赞同：2
> 
> 时间：2008-11-24T13:31:40.820
> 
> 标签：html, ide, blackberry, editor, web-applications

我正在为黑莓 webapps 寻找一个好的环境（基于 GUI 的编辑器）。例如，那里有 Eclipse 插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T19:44:39.300

在我看来和经验中，使用基于 GUI 的编辑器进行任何类型的 Web 开发都是一个非常糟糕的主意。了解 HTML 和 CSS，编写自己的 JavaScript。没有一个[所见即所得](http://en.wikipedia.org/wiki/WYSIWYG)的编辑器可以手动生成尽可能好的标记。

当然，工具进来的部分是测试。并了解您平台的特别不一致之处。在这种情况下，请查看：

*   [黑莓浏览器开发](http://na.blackberry.com/eng/developers/browserdev/)

您还需要测试、测试和测试。为此，请使用全系列的[BlackBerry 模拟器](http://na.blackberry.com/eng/developers/resources/simulators.jsp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T20:32:33.150

根据我的经验，似乎许多黑莓默认关闭了 CSS 和 JS，并且 CSS 和 JS 支持的质量（4.6 软件之前）令人震惊。

您被非常基本的 HTML 表单和线性布局所困。视觉编辑器对此无能为力。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-06T19:30:37.470

黑莓应用程序是用 Java 开发的，RIM 在此处提供所需的工具和模拟器：http: [//na.blackberry.com/eng/developers/resources/devtools.jsp](http://na.blackberry.com/eng/developers/resources/devtools.jsp "RIM 开发工具")

# mysql - 如何更改数据库中一列的数据？

> ID：314139
> 
> 赞同：0
> 
> 时间：2008-11-24T13:33:28.227
> 
> 标签：mysql

**更新**：我发现我正在使用旧值从另一个表调用永久链接。如何从 permalinks 表中获取数据并仅更改另一个表中的 permalinks 列？

```
New id=7005     permalink=beef-ground-85%25-lean-meat-15%25-fat-raw
Old  id=7005    permalink=beef-ground-85pct-lean-meat-_15pct-fat-raw 
```

我已经完成了标题中的所有内容，但旧条目在我的 Rails 应用程序的本地开发中不断出现。

我做过的事情的清单。

```
sudo /etc/init.d/mysql restart
rake tmp:cache:clear
rake tmp:clear
clear all browser cookies / cache / sessions 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T16:26:15.757

作为对您的更新的回应......这与其说是评论，不如说是一个真正的答案：这正是存在外键约束的原因。但是，MySQL 的 MyISAM 表类型（默认）不支持它们。

带有 ON UPDATE CASCADE 子句的外键会自动为您修复此问题。

# c++ - 如何在不使用额外模板参数的情况下使用模板模板参数声明/定义类

> ID：314152
> 
> 赞同：3
> 
> 时间：2008-11-24T13:41:58.677
> 
> 标签：c++, templates, metaprogramming

考虑以下模板模板参数的使用...

```
#include <iostream>

template <typename X>
class A
{
    X _t;
public:
    A(X t)
        :_t(t)
    {
    }
    X GetValue()
    {
        return _t;
    }
};

template <typename T, template <typename T> class C >
class B
{
    C<T> _c;
public:
    B(T t)
        :_c(t)
    {
    }
    T GetValue()
    {
        return _c.GetValue();
    }
};

using namespace std;

int main()
{
    B<int, A> b(10);
    cout<<b.GetValue();
    return 0;
} 
```

有没有办法可以删除模板参数 T ？例如，有没有办法使以下工作？

```
//Does not compile
template <template <typename T> class C >
class B
{
    C _c;
public:
    B(T t)
        :_c(t)
    {
    }
    T GetValue()
    {
        return _c.GetValue();
    }
};

int main()
{
    B< A<int> > b(10);
    cout<<b.GetValue();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T13:56:16.637

我假设您在代码中关注 X 和 A。

通常的模式是有

```
template<typename C>
struct B
{
   C c;
}; 
```

然后，有资格替换的内部类：

```
template<typename X>
class A
{
   typedef X type_name;
   X t;
}; 
```

然后您可以使用`C::type_name`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T13:55:40.773

这是不可能的。请注意，这是一个常见的误解：`A<int>`不再是类模板！所以它不适合模板模板参数，但必须使用类型参数接受：

```
template<typename C>
struct B {
    C c;
};

B< A<int> > b; 
```

您使用单独参数的方式没问题。

如果您想接受`A<int>`但又想将其重新绑定到另一个参数，则可以使用此模式，标准分配器也使用此模式：

```
template<typename T>
struct A {
    template<typename U>
    struct rebind {
        typedef A<U> type;
    };
};

template<typename C>
struct B {
    typename C::template rebind<float>::type c;
};

B< A<int> > b; 
```

现在，`B< A<int> >::c`是类型`A<float>`。`typename`before`C::`告诉编译器最后`::type`是类型而不是静态非类型成员。`template`after`C::`告诉编译器这是`rebind<float>`一个模板实例化，而不是一个比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T13:55:28.603

出什么问题了：

```
template <typename C >
struct B
{
    C c;
};

int main()
{
    B< A<int> > b;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T14:11:48.803

您可以嵌套参数。也就是说，参数的值本身可以被参数化。

```
template <typename X>
struct A
{
  X t;
};

template <typename  C>
struct B
{
  C c;
};

int main()
{
  B< A<int> > b;
  return 0;
} 
```

在这个例子中，`b`in的声明`main()`创建了一个`A`using`int`作为参数的特化，然后它创建了一个`B`using`A<int>`作为参数的特化。因此，在 的专业化中`B`，`C`是`A<int>`。

# javascript - Google Maps GeoCoding 始终使用浏览器语言

> ID：314158
> 
> 赞同：2
> 
> 时间：2008-11-24T13:45:07.953
> 
> 标签：javascript, ajax, google-maps, google-api

我正在使用 Google AJAX API 加载器并希望以德语获取所有信息，因此我正在加载这样的地图 API

```
google.load("maps", "2", {language : "de"}); 
```

我试过`deu`, `ger`, `de`,`de_DE`甚至 en都`ja_JPbut`没有成功。

对于那些不明白我的问题的人：http: [//dl.getdropbox.com/u/5910/Jing/2008-11-24_2018.png](http://dl.getdropbox.com/u/5910/Jing/2008-11-24_2018.png)你可以在[http://apps.komola.de/gmaps 试试。 htm](http://apps.komola.de/gmaps.htm)英文浏览器上的英文地址和德文浏览器上的德文地址

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T14:40:54.520

此 API 文档指出了地图本地化的限制[http://code.google.com/apis/maps/documentation/#Localization](http://code.google.com/apis/maps/documentation/#Localization)

该语言似乎只影响界面（按钮等），base_domain 影响它使用的服务。因此 base_domain 强制它使用 google.de 进行地理编码服务。

```
<script src="http://www.google.com/jsapi?key=KEYHERE" type="text/javascript"></script>

<script type="text/javascript">
     google.load("maps", "2",{language: "de",base_domain: 'google.de'});
     ...
</script> 
```

加载器文档提到了 base_domain。 [http://code.google.com/apis/ajax/documentation/#GoogleLoad](http://code.google.com/apis/ajax/documentation/#GoogleLoad)

# html - IE 将左侧边栏置于内容下方

> ID：314164
> 
> 赞同：1
> 
> 时间：2008-11-24T13:49:31.893
> 
> 标签：html, css, positioning

我不熟悉这个网站，但我正在拼命寻求我正在建立的网站的帮助。如果我没有在正确的地方或错误地问我的问题，我很抱歉，所以如果我做错了，请告诉我！

我建立了一个简单的网站，由四个页面（index.html 加上其他三个页面）组成。在 FF 中似乎一切正常，但在 IE 中却不行。我知道有很多类似的问题，但经过数小时的搜索，我找不到解决方案。我在左侧有一个侧边栏，它在 FF 中出现在适当的位置，但在 IE 中出现在内容下方。奇怪的是，它在第​​四页上确实有效，所以我不知道这是我帐户上的 css 还是 html 错误。目前该网站位于[http://www.kids2move.nl/djctapas](http://www.kids2move.nl/djctapas)

我希望有人能看到我做错了什么以及如何解决它。我会定期检查此页面，以便在需要时添加其他信息，例如我的 css 文件或 htmlcode。提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:12:59.973

为什么不把侧边栏 div 放到页面 div 中呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:27:10.927

您目前拥有：

```
<div id=page>
    <div id=content></div>
</div>
<div id=sidebar></div> 
```

我认为：

```
<div id=page>
    <div id=sidebar></div>         
    <div id=content></div>
</div> 
```

在布局方面会更有意义，并且可能会解决您的问题。如果没有，请使用 position: absolute; CSS 中内容 div 的侧边栏 div 和 margin-left。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:36:17.430

我同意; 尝试将侧边栏 div 上移一个级别。

与照片页面的区别是我认为额外条目 div 的副作用。

如果您获得了 firefox 扩展[“Web Developer”](https://addons.mozilla.org/en-US/firefox/addon/60)，您可以使用它来显示您的 div 是如何嵌套的。（信息/显示 div 顺序）

# workflow - 如何使用工作流在 MS Dynamics CRM 中共享记录

> ID：314165
> 
> 赞同：3
> 
> 时间：2008-11-24T13:50:02.750
> 
> 标签：workflow, dynamics-crm, crm, microsoft-dynamics

我想做以下事情：

当销售人员将自定义实体（我们称之为“主要专业知识”）分配给 MS CRM 4.0 中的机会时，系统将与定义为关联“主要专业知识”记录所有者的用户共享机会。

我想通过工作流自动完成，但找不到可以完成的工作流步骤。是的，我在一些论坛上读到这实际上还不可能，只能通过 .NET 程序集。

经验，有人吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T01:02:41.073

试试这个：

[http://crm40sharestep.codeplex.com](http://crm40sharestep.codeplex.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T15:49:59.093

正确，只能通过 .NET 程序集实现。但是，您可以（如果您使用 CRM 4）让工作流将所有者更改为活动的所有者，并使用与先前所有者共享选项来启用旧所有者对您的自定义实体的访问权限？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-01T13:19:48.537

只有通过调用自定义工作流活动才有可能。在自定义工作流活动中，您可以通过配置[PrincipalAccess](http://technet.microsoft.com/en-us/library/cc152817.aspx)对象来调用[GrantAccessRequest 和 GrantAccessResponse 。](http://technet.microsoft.com/en-us/library/bb959430.aspx)

请参阅此“[共享对象](http://technet.microsoft.com/en-us/library/bb955131.aspx)”部分了解详细信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T12:53:29.260

如果您决定使用自定义插件，您的代码可能如下所示：

```
var rights = AccessRights.ReadAccess | AccessRights.WriteAccess;

var principalAccess = new PrincipalAccess
{
    // Gives the principal read write access
    AccessMask = rights,

    // Set the PrincipalAccess Object's Properties
    Principal = sharingTarget.Key
};

// Create the Request Object
var grantAcessRequest = new GrantAccessRequest();
// Set the Request Object's properties
grantAcessRequest.PrincipalAccess = principalAccess;
// Set the Target. In my case it is account record
var entityReference = new EntityReference(localContext.PluginExecutionContext.PrimaryEntityName,
                                          localContext.PluginExecutionContext.PrimaryEntityId);
//throw new InvalidPluginExecutionException("EntityReference");
grantAcessRequest.Target = entityReference;

// Execute the Request
localContext.OrganizationService.Execute(grantAcessRequest); 
```

# silverlight - 在 ControlTemplates (Silverlight) 中访问用户控件

> ID：314171
> 
> 赞同：1
> 
> 时间：2008-11-24T13:53:28.530
> 
> 标签：silverlight

我正在尝试创建一个拉皮条版本的滑块，它在“拇指”部分（意思是：滑块上的移动物体）中有一个用户控件，它对滑块的运动做出反应。基本上，我当前的演示/开发版本只是一个具有 5 个视觉状态的 UserControl，它只是让它分 5 个阶段将笑脸变成愤怒的脸。我想将该用户控件放入拇指中。

我唯一的问题如下：通过在 Expression Blend 中编辑 Slider-control 的模板，我可以将 UserControl 放入拇指没有问题。但是，一旦 UserControl 在 ControlTemplate 中，它就不再对新的用户控件类可见，因此不能使用 VisualStateManager 进行更改。

所以基本上，我的问题有两个：

1.  有没有比编辑它的模板更好的方法来替换滑块控件的拇指？

2.  如果没有，我如何访问我添加到模板中的内容？

感谢您的任何回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:24:09.123

我自己回答。在访问了互联网上的每个页面之后，我终于自己想出了一个解决方案！

我在 ControlTemplate 中向我的控件添加了一个 Loaded 事件处理程序，并且在该事件处理程序中，我为实际类引用了该控件！之后，我可以使用该引用来引用该控件，例如，视觉状态更改就像一个魅力！

我现在有一个跳跃式滑块，手柄部分有一个笑脸，笑脸上的脸会随着滑块的位置而变化！很酷！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-24T10:44:32.547

我从不同的角度工作：您可以覆盖 OnApplyTemplate() 并使用 GetTemplateChild 方法获取您的参考。不知何故感觉更干净

# c++ - 图像处理：需要转换超像素（128x128 像素）坐标的智能解决方案

> ID：314176
> 
> 赞同：1
> 
> 时间：2008-11-24T13:55:07.013
> 
> 标签：c++, visual-c++, image-processing

癌症 CT 图片存储在无符号短数组（一维）中。

我有图片内癌症区域的位置信息，但坐标（x，y）是超像素（128x128 unsigned short）。我的任务是突出这个区域。

我已经通过将超像素坐标转换为可用于无符号短数组的偏移量来解决这个问题。它工作正常，但我想知道是否有更聪明的方法来解决这个问题，因为我的解决方案需要 3 个嵌套的 for 循环。

是否可以“超像素”访问 ushort 数组，所以我可以在超像素中导航 ushort 数组。

我知道这行不通。为了让你知道我在想什么：

```
typedef struct 
{
   unsigned short[128x128]
} 
spix;

spix *spixptr;

unsigned short * bufptr = img->getBuf();

spixptr = bufptr; 
```

**更新1：**

是的，它含糊不清，让我再试一次：

```
[0][1][2] ... [127]| ... [x] |
[1]                |         |
[2]                |         |
.                  |         |
.                  | <-- this is a superpixel
.                  |         |
[127]              |         |
--------------------         |
.                            |
.                            |
.                            |
[y]                          |<--whole picture stored in a ushort* buf = new ushort[x*y]
------------------------------ 
```

`ushorts`我喜欢使用指针一次访问 128x128 ，因此我可以将`memcpy`数据放入 128x128 字段。

**更新 2：**

bitblit 传输提示有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:05:20.207

这很难回答，因为它相当模糊。

如果您的意思是“给定图像的这种定义，我如何访问 (x,y) 处的像素”，那么答案应该不会很令人惊讶：

```
typedef struct
{
    unsigned short data[128 * 128]; // This was broken in the question.
} spix;

void spix_set_pixel(spix *s, unsigned int x, unsigned int y, unsigned short value)
{
  s->data[y * 128 + x] = value;
} 
```

完全不确定这是否回答了您的问题，但听起来……至少是合理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:51:18.897

据我了解，你有：

*   CT 扫描的大图像
*   该图像中的矩形区域是癌症

然后就有点难以理解了。我相信您想要创建某种类，以便您可以有效地访问 128x128 图像块，就好像它们是单个像素一样。

因此，如果图像是 1024x1024 像素，您希望能够以 128x128 像素块的 8x8 网格的形式访问它。现在，如果是这种情况，您需要创建一个代表这些 128x128 块之一的类。这个类应该引用图像，这样您就不会复制图像数据，并且应该包含您想要对那个“超像素”执行的所有操作。

但是，如果您只想从较大的图像中提取特定的 128x128 块，那么您需要的是[位 blit](http://www.catb.org/~esr/jargon/html/B/bitblt.html)算法。[位块传输](http://en.wikipedia.org/wiki/Bit_blit)（通常称为 blit）将允许您将选定的数据位从较大的图像复制到较小的图像。该算法还可以适用于对较大图像中的特定区域执行几乎任何您想要的操作。

如果你只需要一个 blit，那么每个相对现代的图形 API 都应该有 blit 函数。

# html - 从图像生成 HTML-Map

> ID：314181
> 
> 赞同：12
> 
> 时间：2008-11-24T13:56:57.930
> 
> 标签：html, image

有没有一种方法可以自动生成具有非常独特边界的多边形对象（例如地图上的国家）的坐标的 HTML-Map 兼容列表？

示例图片：

[中东欧国家地图 http://www.bankaustria.at/landkarten/CEE_2007_w524.jpg](http://www.bankaustria.at/landkarten/CEE_2007_w524.jpg)

最终输出：

```
<map id ="ceemap" name="ceemap">
    <area shape="poly" coords="149,303,162,301,162,298,171,293,180,299,169,309,159,306,148,306,149,303" href="austria.html" target ="_blank" alt="Austria" />       
    <!-- ... -->
</map> 
```

任何提取类似多边形选择的坐标的工具/脚本都会有所帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-27T13:02:04.780

谢谢你的帮助！

尽管**Jonathans**暗示使用 Sobel 过滤器肯定会起作用，但我选择了**Sparrs**方法，首先将位图转换为矢量图像（通过 Inkscape），然后处理 SVG 文件。在研究了 SVG 规范的一些基础知识之后，很容易从所有其他垃圾中提取 - 对于所需的 HTML 图像映射 - X/Y 坐标并生成合适的代码。

虽然这不是火箭科学，但有人可能会发现这段代码很有用：

```
// input format: M 166,362.27539 C 163.525,360.86029 161.3875,359.43192 161.25,359.10124 C ...
private static void Svg2map(string svg_input)
{
    StringBuilder stringToFile = new StringBuilder();

    // get rid of some spaces and characters
    var workingString = svg_input.Replace("z", "").Replace(" M ", "M").Replace(" C ", "C");
    // split into seperate polygons
    var polygons = workingString.Split('M');
    foreach (var polygon in polygons)
    {
        if (!polygon.Equals(String.Empty))
        {
            // each polygon is a clickable area
            stringToFile.Append("<area shape=\"poly\" coords=\"");
            // split into point information
            var positionInformation = polygon.Split('C');
            foreach (var position in positionInformation)
            {
                var noise = position.Trim().Split(' ');
                // only the first x/y-coordinates after C are relevant
                var point = noise[0].Split(',');
                foreach (var value in point)
                {
                    var valueParts = value.Split('.');
                    // remove part after comma - we don't need this accurancy in HTML
                    stringToFile.Append(valueParts[0]);
                    // comma for seperation - don't worry, we'll clean the last ones within an area out later
                    stringToFile.Append(",");
                }
            }
            stringToFile.AppendLine("\" href=\"targetpage.html\" alt=\"Description\" />");
        }
    }
    // clean obsolete commas - not pretty nor efficient
    stringToFile = stringToFile.Replace(",\"", "\"");

    var fs = new StreamWriter(new FileStream("output.txt", FileMode.Create));
    fs.Write(stringToFile.ToString());
    fs.Close();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-25T03:11:32.070

在 Inkscape 中打开地图。如果是位图，使用 Path -> Trace Bitmap 来追踪边缘。清理矢量数据以仅包含您希望出现在图像地图中的路径。保存文档，我建议保存为 POVRay 文件。现在您有了纯文本格式的顶点列表（以及大量您不关心的标记或元数据）。将其转换为必要的 HTML 语法仍然是一个问题，但不像第一步那么复杂。

值得一提的是，Inkscape 长期以来一直要求包含导出 HTML 图像映射的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T14:05:05.590

我可以为您提供该过程的一个步骤：您将需要使用 Sobel 过滤器（在 Photoshop 等程序中通常称为边缘检测）。

之后，您将需要使用您选择的语言找到一个跟踪库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-22T09:34:50.650

我对 Gerhard Dinhof 的代码做了一些修改和实现。

PHP 函数生成所提供的 svg 坐标的图像映射。您可以指定调整区域大小的因子数和 xy 平移数以将地图与图像对齐。

```
<?php

/**
 * $str SVG coordinates string
 * $factor number that multiply every coordinate (0-1)
 * $x translation on the x-axis
 * $y translation on the y-axis
 */
function svg2imap($str, $factor=1, $x=0, $y=0) {

    $res = "";

    $str = str_replace(array(" M ","M ", " C "," z "," z"),array("M","M","C","",""), $str);

    $polygons = explode("M", $str);

    for($i=0; $i<count($polygons); $i++) {

        if($polygons[$i]!="") {

            $res .= "<area shape=\"poly\" coords=\"";

            $coordinates = explode("C", $polygons[$i]);

            foreach( $coordinates as $position ) {

                $noise = explode(" ", trim($position));
                $point = explode(",", $noise[0]);

                for($j=0; $j<2; $j++) {

                    $val = round( $point[$j]*$factor, 0);

                    if($j==0)
                        $res .= ($val + $x).",";
                    else
                        $res .= ($val + $y).",";
                }
            }
            $res .= "\" href=\"link.html\" alt=\"desc\" />";
        }
    }

    return $res = str_replace(",\"","\"", $res);;
}
?>

<?php

$svg = "M 6247.5037,5935.0511 C 6246.0707,5940.7838 6247.5037,5947.9495 C 6243.2043,5959.4149 z";

highlight_string( svg2imap($svg, $factor=0.33, $x=0, $y=0) );

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-22T11:19:33.467

似乎“Gerhard Dinhof”功能不正确，我在浪费时间。在这里您可以找到用 c# 编写的修改版本，用于将简单的 SVG 文件转换为相关的 html 地图代码。用法：MessageBox.Show(Svg2map("c:\test.svg"))

```
 // Sample file contents:
    // <?xml version="1.0" encoding="UTF-8" ?>
    // <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
    // <svg width="739pt" height="692pt" viewBox="0 0 739 692" version="1.1" xmlns="http://www.w3.org/2000/svg">
    // <path fill="#fefefe" d=" M 0.00 0.00 L 190.18 0.00 C 188.15 2.70 186.03 5.53 185.30 8.90 L 0.00 0.00 Z" />
    // </svg>
    private string Svg2map(string svg_file_path)
    {
        string[] svgLines = File.ReadAllLines(svg_file_path);
        string svg = string.Join("", svgLines).ToLower();

        int temp;
        int w = int.Parse(ExtractData(svg,0,out temp, "<svg", "width").Replace("pt", "").Replace("px", ""));
        int h = int.Parse(ExtractData(svg, 0, out temp, "<svg", "height").Replace("pt", "").Replace("px", ""));

        StringBuilder stringToFile = new StringBuilder();
        stringToFile.AppendLine(string.Format("<img id=\"image1\" src=\"image1.jpg\" border=\"0\" width=\"{0}\" height=\"{1}\" orgwidth=\"{0}\" orgheight=\"{1}\" usemap=\"#map1\" alt=\"\" />", w, h));
        stringToFile.AppendLine("<map name=\"map1\" id=\"map1\">");

        byte dataKey1 = (byte)'a';
        byte dataKey2 = (byte)'a';

        int startIndex = 0;
        int endIndex = 0;
        while (true)
        {
            string color = ExtractData(svg, startIndex, out  endIndex, "<path", "fill");
            string svg_input = ExtractData(svg, startIndex, out endIndex, "<path", "d=");
            if (svg_input == null)
                break;

            startIndex = endIndex;

            /// Start..
            stringToFile.Append(string.Format("<area data-key=\"{0}{1}\" shape=\"poly\" href=\"targetpage.html\" alt=\"Description\" coords=\"", (char)dataKey1, (char)dataKey2));
            dataKey1 += 1;
            if (dataKey1 > (byte)'z')
            {
                dataKey2 += 1;
                dataKey1 = (byte)'a';
            }

            bool bFinished = false;
            while (!bFinished)
            {
                string[] points = new string[0];
                string pattern = "";
                svg_input = svg_input.ToUpper().Trim();
                char code = svg_input[0];
                switch (code)
                {
                    case 'M':
                    case 'L':
                        pattern = svg_input.Substring(0, svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ") + 1) + 1));
                        svg_input = svg_input.Remove(0, pattern.Length);
                        points = pattern.Trim().Substring(1).Trim().Split(' ');
                        break;
                    case 'C':
                        pattern = svg_input.Substring(0, svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ", svg_input.IndexOf(" ") + 1) + 1) + 1) + 1) + 1) + 1));
                        svg_input = svg_input.Remove(0, pattern.Length);
                        points = pattern.Trim().Substring(1).Trim().Split(' ');
                        break;
                    case 'Z':
                        bFinished = true;
                        continue;
                    default:
                        throw new Exception("Invalid pattern");
                }

                int count = points.Length;
                if (count > 4)
                    count = 4;
                for (int i = 0; i < count; i++)
                {
                    var valueParts = points[i].Split('.');
                    // remove part after comma - we don't need this accurancy in HTML
                    stringToFile.Append(valueParts[0]);
                    // comma for seperation - don't worry, we'll clean the last ones within an area out later
                    stringToFile.Append(",");
                }
            }
            stringToFile.AppendLine("\" />");
        }

        // clean obsolete commas - not pretty nor efficient
        stringToFile.AppendLine("</map>");
        stringToFile = stringToFile.Replace(",\"", "\"");

        return stringToFile.ToString();
    }

    private string ExtractData(string data, int startIndex, out int endIndex, string key, string param)
    {
        try
        {
            endIndex = 0;
            int a = data.IndexOf(key, startIndex);
            int a2 = data.IndexOf(key, a + key.Length);
            if (a2 == -1)
                a2 = data.IndexOf(">", a + key.Length);
            int b = data.IndexOf(param, a + key.Length);
            int start = data.IndexOf("\"", b + param.Length) + 1;
            int end = data.IndexOf("\"", start + 1);
            if (b > a2 || start > a2 || end > a2)
                return null;
            int len = end - start;
            endIndex = end;
            string t = data.Substring(start, len);
            return t;
        }
        catch
        {
            endIndex = 0;
            return null;
        }
    } 
```

# winforms - 将 winform 从 XP 转换为 Vista - Properties.Settings

> ID：314184
> 
> 赞同：0
> 
> 时间：2008-11-24T13:58:40.080
> 
> 标签：winforms, windows-vista, windows-xp

我正在将具有许多不同设置文件的应用程序从 XP 升级到 Vista，并更改文件的位置以使用

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

行而不是写入应用程序路径。属性设置中的 mannny 地方使用了一些值。这些值是从其他设置文件中的值分配的。

有人告诉我，微软将放弃对程序文件写入虚拟化的支持，这很好，这就是我升级的原因......

像下面这样的语句会在运行时导致错误，还是需要在 Vista 中以某种方式处理？

```
Properties.Settings.Default.Properties["ConnectionString"].DefaultValue = config.ConnectionString; 
```

我在想它会在运行时分配值并且无法将值存储在程序文件空间中，并且可能会将其写入 VirtualStore？现在这可以工作，但是当虚拟化被删除时，它仍然可以工作吗？

我不确定，不想在没有先问的情况下继续。我可以完全离开。任何帮助或意见将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T14:12:46.900

我们在 XP 和 Vista 上使用 ClickOnce，没有任何问题。当然，对于 ClickOnce，应用程序驻留在用户的文档设置中，这可能与您的情况不同。但是，我认为我的 ClickOnce 经验可能会给您一个部分解决方案。

这是在 Vista 上使用 App.Config（写作）的人提供的[链接。](http://channel9.msdn.com/forums/TechOff/415561-Appconfig-and-VistaUAC/)它说尝试写入 App.Config 不是一个好主意。以下是他提出的两条建议：

*   使用 .settings 文件，它为您提供强类型设置和每个属性的用户/应用范围、保存和属性更改通知

*   在 app.config 中以不同的名称（比如“userSettings”）注册 AppSettings 部分，并为其指定 allowExeDefinition="MachineToRoamingUser"。这允许您保留现有的语法。

# sql - 查询与记录键集引用的每条记录关联的 N 条记录

> ID：314187
> 
> 赞同：1
> 
> 时间：2008-11-24T14:01:20.870
> 
> 标签：sql, mysql

这是我的场景的简化版本：

*   我有一个名为**Project**的表，我通过“id”字段引用该表。
*   我有一个名为**Photo**的表，其中有一个名为“project_id”的字段，我用它来将多张照片与单个项目相关联。Photo 表还有一个自动递增的“id”字段，我用它来进行排序等。

这就是我想要完成的事情：*对于项目 id 值的集合，我希望检索添加到每个项目的最后 5 张照片*——当然，理想情况是在单个查询中。:-)

换句话说，我不想强​​加单个查询限制，而是希望为每个项目指定返回照片数量的限制。

我目前正在将其实现为每个项目一个查询，因此 N 个项目 = N 个查询（一个好的缓存策略肯定会减少伤害，但稍后会出现）。

有人有解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:07:11.997

对于 MySQL 中的“最后 n 个项目”问题，请看这里：[如何在 MySQL 中为每个用户选择最多 3 个项目？](https://stackoverflow.com/questions/271730/how-to-select-maximum-3-items-per-users-in-mysql)（就在最佳答案中）。

当您从那里获取它时，您所缺少的只是与您的`Projects`表的 JOIN，这应该很容易做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:34:05.110

市侩解决方案的轻微改动：

```
SELECT project.*, photo.* 
  FROM photo 
  LEFT JOIN project USING(project_id)
WHERE photo.project_id IN (comma separated list of project ids)
ORDER BY photo_id DESC 
LIMIT project.project_photos_limit 
```

虽然我不确定 LIMIT 是否会让你使用一个字段来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:16:52.740

```
SELECT project.*, photo.* 
  FROM photo 
  LEFT JOIN project USING project_id 
WHERE photo.project_id = '{$id}' 
ORDER BY photo_id DESC 
LIMIT project.project_photos_limit 
```

试试看？（显然是你的字段名）

# vba - 在 Word VBA 中使用对动态创建的控件的引用

> ID：314189
> 
> 赞同：4
> 
> 时间：2008-11-24T14:01:39.543
> 
> 标签：vba, ms-word

我正在 Word 2003 中编写一个表格来收集对单个问题的多个答复。我在按下按钮时有一个宏，它复制了各种输入字段（下拉框、单选按钮等），为新的响应做好了准备。

但是，我需要更改单选按钮的文本，并`OnChange`在组合框上设置事件，但我找不到这样做的正确语法。这两个控件都来自“控件工具箱”工具栏。

我必须复制控件的宏代码如下。

```
Private Sub CommandButton11_Click() 
Set Doc = ActiveDocument
Response = MsgBox("Add another response?", vbYesNo, "Confirm action")
    If Response = vbYes Then
        If Doc.ProtectionType <> wdNoProtection Then
          Doc.Unprotect
        End If

        Selection.MoveRight
        Selection.MoveDown
        Selection.TypeParagraph
        ''# keep the reference to this control and set the OnChange event handler
        Selection.InlineShapes.AddOLEControl ClassType:="Forms.ComboBox.1"
        Selection.MoveRight Unit:=wdCharacter, Count:=1
        Selection.TypeText Text:=vbTab
        Selection.TypeText Text:=vbTab
        ''# keep the reference to this control and set text
        Selection.InlineShapes.AddOLEControl ClassType:="Forms.OptionButton.1"
        Selection.MoveRight Unit:=wdCharacter, Count:=1

        Doc.Protect Type:=wdAllowOnlyFormFields, NoReset:=True
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T21:04:50.907

动态添加事件处理程序有点棘手。

您可以将代码动态添加到 ThisDocument。这是微软描述的方式：http: [//support.microsoft.com/](http://support.microsoft.com/?scid=kb%3Ben-us%3B246299&x=14&y=10) ?scid=kb%3Ben-us%3B246299&x=14&y=10 。但是，当我尝试这个 Word 2007 时崩溃了。

另一种方法是为事件处理添加一个类，并为每个控件创建一个此类的实例。将以下代码放入模块中：

```
Option Explicit

Public objControls() As clsComboBox

Private Sub CommandButton11_Click()
    Dim objShape As InlineShape

    If ActiveDocument.ProtectionType <> wdNoProtection Then
        ActiveDocument.Unprotect
    End If

    Selection.MoveRight
    Selection.MoveDown
    Selection.TypeParagraph
    ' keep the reference to this control and set the OnChange event handler
    Set objShape = Selection.InlineShapes.AddOLEControl(ClassType:="Forms.ComboBox.1")
    With objShape.OLEFormat.Object
        .AddItem "Item 1"
        .AddItem "Item 2"
    End With

    Selection.MoveRight Unit:=wdCharacter, Count:=1
    Selection.TypeText Text:=vbTab
    Selection.TypeText Text:=vbTab
    ' keep the reference to this control and set text
    Set objShape = Selection.InlineShapes.AddOLEControl(ClassType:="Forms.OptionButton.1")
    With objShape.OLEFormat.Object
        .Caption = "My great option"
    End With
    Selection.MoveRight Unit:=wdCharacter, Count:=1

    ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True

    ' we have to execute the creation of the event handlers with a delay
    ' to make it work (seems Word needs some time for object creation)
    Application.OnTime When:=Now + TimeValue("00:00:01"), Name:="prcCreateReference"

End Sub

Public Sub prcCreateReference()
    Dim objShape As InlineShape
    Dim intCount As Integer

    On Error Resume Next
    For Each objShape In ThisDocument.InlineShapes
        intCount = intCount + 1
        ReDim Preserve objControls(1 To intCount)
        If TypeOf objShape.OLEFormat.Object Is ComboBox Then
            Set objControls(intCount) = New clsComboBox
            Set objControls(intCount).ComboBox = objShape.OLEFormat.Object
        ElseIf TypeOf objShape.OLEFormat.Object Is OptionButton Then
            ' add event handlers for option buttons
        End If
    Next
End Sub 
```

这段代码应该进入一个名为 clsComboBox 的类模块：

```
Option Explicit

Private WithEvents mobjComboBox As MSForms.ComboBox

Friend Property Set ComboBox(objComboBox As MSForms.ComboBox)
    Set mobjComboBox = objComboBox
End Property

Private Sub mobjComboBox_Change()
    MsgBox "Selection changed."
End Sub

Private Sub mobjComboBox_Click()
    MsgBox "Clicked."
End Sub 
```

请注意，变量 objControls 必须是 clsComboBox 类型。将此变量声明为 Object 或 Variant 对我不起作用（谁能解释为什么？？？）。

# parsing - 具有自动完成功能的代码编辑器

> ID：314199
> 
> 赞同：5
> 
> 时间：2008-11-24T14:04:14.937
> 
> 标签：parsing, autocomplete

我需要为我自己的简单语言创建一个代码编辑器：

className.MethodName(parameterName = 2, ... )

我已经使用 ANTLR 工具创建了适当的语法和自动生成解析器。现在我想对类、方法、变量和参数名称进行自动完成。这个列表应该是上下文相关的，fe 代表“类”。它应该显示方法和“class.Method（” - 参数。我要解析文本并根据光标所在的节点显示列表。问题是对于像“aaa.bbb（”）这样的不完整代码解析器产生错误而不是语法树。知道如何解决这个问题吗？也许我走错了路，我不应该解析代码来显示自动完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-06T11:47:37.663

您至少需要解析代码的某些部分才能知道要显示的内容。

您要么需要一个解析器，它允许解析直到它发现错误并稍后从那里继续（或者甚至只是忽略它并尝试自行修复它以便能够继续解析 - 但在这里变得非常困难，所以您可以访问最后一个节点并使用您的语法和现有语法树来自动完成它，或者您缓存最新的语法树并使用正则表达式之类的东西来查看何时自动完成并使用缓存来查看要自动完成的内容。

后面的建议可能更简单，但缺点是缓存在您需要完成时可能已过时（即：您可能在文件中创建一个新类，所有基于该类的完成都不会'在文件没有错误之前可用）。

Sidenode：看到您进行解析，您可能对[Parsing Expression Grammars](http://en.wikipedia.org/wiki/Parsing_expression_grammar)感兴趣，但它们并不能完全帮助您解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:20:33.077

Mac 上的 TextMate 或其在其他平台上的克隆怎么样？我刚开始使用它，但它似乎有一个非常开放的插件工具集。

# java - java中通过返回类型重载方法

> ID：314203
> 
> 赞同：2
> 
> 时间：2008-11-24T14:05:09.053
> 
> 标签：java

我可以使用泛型将这两个“getFields”方法合并为一个（第二种方法旨在打包私有访问）还是应该将第二种方法重命名为“getFieldPackagePrivate”之类的丑陋的东西？

```
public interface IField {

}

class Field implements IField { // package private class

}

  public class IForm {

     public List<IField> getFields();

  }

public class Form {
  private List<Field> fields;

  public List<IField> getFields() {
    return this.fields;

  }

  List<Field> getFields() { // package visible
    return this.fields;

  }

} 
```

基本用法是这样的

```
// by interfece - from client code

  IForm form;
  List<IField> list = form.getFields();

// by class - from other classes in the same package
  Form form2;
  List<Field> list2 = forms2.getFields(); 
```

这个想法是为外部世界提供一个干净、保存的接口，并从包可见的实现 clacces 中方便地访问（没有向下转换）。我的字段类有一些我不希望客户端看到但需要从同一包中的其他类调用的方法（例如 setLabel 等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T14:07:23.493

你可以写（根据我对你上一个问题的回答）：

```
public List<? extends IField> getFields() 
```

但是不能通过返回类型重载，也不能在公共方法中公开包私有类型。

编辑：随着问题的改变，答案是简单的“不”。您必须重命名其他方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T14:07:33.540

不，在 Java 中不能有基于返回类型的多态性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:53:58.813

在我做了一些实验之后，我找到了一个基于 Jon Skeet 回答的解决方案

代码看起来像这样。

```
public interface IField {

}

class Field implements IField { // package private class

}

  public class IForm {

     public List<? extends IField> getFields();

  }

public class Form {
  private List<Field> fields;

  List<? extends Field> getFields() { // package visible - please note "extends Field" not "extends IField"
    return this.fields;

  }

} 
```

现在下面的溺爱有效

```
 IForm form;
  List<IField> list = form.getFields();

// by class - from other classes in the same package
  Form form2;
  List<Field> list2 = forms2.getFields(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T12:26:45.003

您可以通过字节码操作来做到这一点，请查看这篇文章： [http ://today.java.net/pub/a/today/2008/07/31/return-type-based-method-overloading.html](http://today.java.net/pub/a/today/2008/07/31/return-type-based-method-overloading.html)

# c# - 在 C# 中检查网络状态

> ID：314213
> 
> 赞同：20
> 
> 时间：2008-11-24T14:09:56.127
> 
> 标签：c#, .net, network-programming

如何检查我是否有开放的网络连接并且可以联系 c# 中的特定 IP 地址？我在 VB.Net 中看到过示例，但它们都使用“我的”结构。谢谢你。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-24T14:43:01.473

如果您只想检查网络是否已启动，请使用：

```
bool networkUp
    = System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable(); 
```

要检查特定接口的状态（或其他信息），请使用：

```
NetworkInterface[] networkCards
    = System.Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces(); 
```

要检查远程计算机的状态，您必须连接到该计算机（请参阅其他答案）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-08-04T12:00:08.650

如果要监视状态的变化，请使用[`System.Net.NetworkInformation.NetworkChange.NetworkAvailabilityChanged`](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkavailabilitychanged.aspx)事件：

```
NetworkChange.NetworkAvailabilityChanged 
    += new NetworkAvailabilityChangedEventHandler(NetworkChange_NetworkAvailabilityChanged);
_isNetworkOnline = NetworkInterface.GetIsNetworkAvailable();

// ...
void NetworkChange_NetworkAvailabilityChanged(object sender, NetworkAvailabilityEventArgs e)
{
    _isNetworkOnline  = e.IsAvailable;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T14:22:35.773

## 第一个建议（IP连接）

您可以尝试使用以下方式连接到 IP 地址：

```
IPEndPoint ipep = new IPEndPoint(Ipaddress.Parse("IP TO CHECK"), YOUR_PORT_INTEGER);
Socket server = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
server.Connect(ipep); 
```

我建议你检查一个“聊天”程序的代码。这些程序会操纵大量 IP 连接，并让您很好地了解如何检查 IP 是否可用。

## 第二个建议（Ping）

您可以尝试ping。这是一个很好的[教程](http://www.codeproject.com/KB/dotnet/CSharpPing.aspx)。您只需要做：

```
Ping netMon = new Ping();
PingResponse response = netMon.PingHost(hostname, 4);
if (response != null)
{
    ProcessResponse(response);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-24T14:34:55.763

如果您对 HTTP 状态代码感兴趣，可以使用以下方法：

```
using System;
using System.Net;

class Program {

    static void Main () {
        HttpWebRequest req = WebRequest.Create(
            "http://www.oberon.ch/") as HttpWebRequest;
        HttpWebResponse rsp;
        try {
            rsp = req.GetResponse() as HttpWebResponse;
        } catch (WebException e) {
            if (e.Response is HttpWebResponse) {
                rsp = e.Response as HttpWebResponse;
            } else {
                rsp = null;
            }
        }
        if (rsp != null) {
            Console.WriteLine(rsp.StatusCode);
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-28T13:22:04.707

您可以使用检查网络状态

```
if(System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
{
  //Do your stuffs when network available

}
else
{
 //Do stuffs when network not available

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T14:14:52.793

好吧，你会尝试连接到特定的 ip，并处理拒绝和超时。

查看 System.Net.Sockets 命名空间中的 TcpClient 类。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-12-21T15:52:46.630

我的想法是有一个静态类/模块来对一个单独的线程进行监控。一个简单的 DNS 解析将确保您的网络是否正常运行。节拍 ping IMO。

```
Imports System.Net

Public Module Network_Monitor

Private InsideWorkNet As Boolean = vbFalse
Private Online_Status As Boolean = vbFalse
Private CurrentWorkIPAddress As New IPHostEntry
Private WithEvents Timer_Online_Check As New Timers.Timer With {.Interval = 5000, .Enabled = True, .AutoReset = True}

Public ReadOnly Property GetOnlineStatus() As String

    Get
        Return Online_Status
    End Get

End Property

Public Sub Initialize()

    Set_Online_Status()
    Timer_Online_Check.Start()

End Sub

Public Sub Set_Online_Status()

    If My.Computer.Network.IsAvailable Then
        Try
            Dim DNSTest As IPHostEntry = Dns.GetHostEntry("google.com")
            If DNSTest.AddressList.Length > 0 Then
                Online_Status = True
            Else : Online_Status = False

            End If

        Catch ex As System.Net.Sockets.SocketException

            Online_Status = False

        End Try
    End If

End Sub

Private Sub Timer_Online_Check_Elaspsed(ByVal sender As Object, ByVal e As Timers.ElapsedEventArgs) Handles Timer_Online_Check.Elapsed
    Set_Online_Status()
End Sub

Public Sub Detect_Work_Network()

    If Online_Status = True Then

        Dim WorkIP As IPHostEntry = New IPHostEntry()

        Try
            WorkIP = Dns.GetHostEntry("serverA.myworkdomain.local")
            If WorkIP.AddressList.Length > 0 Then

                InsideWorkNet = True
                CurrentWorkIPAddress = WorkIP
                'MessageBox.Show(WorkIP.HostName.ToString(), "WorkIP", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If
        Catch ex As Sockets.SocketException

            Try
                WorkIP = Dns.GetHostEntry("serverA.myworkdomain.com")
                If WorkIP.AddressList.Length > 0 Then

                    InsideWorkNet = False
                    CurrentWorkIPAddress = WorkIP
                    ' MessageBox.Show(WorkIP.HostName.ToString(), "WorkIP", MessageBoxButtons.OK, MessageBoxIcon.Information)
                End If
            Catch ey As Sockets.SocketException

            End Try
        End Try
    End If

End Sub

Public Function GetWorkServerName() As String
    If InsideWorkNet = True Then
        Return "serverA.myworkdomain.local"
    Else : Return "serverA.myworkdomain.com"
    End If

End Function

End Module 
```

我还必须确定我是在工作网络内部还是外部。防火墙每一侧的不同服务器供应用程序通信。

# asp.net - iframe 的同步

> ID：314226
> 
> 赞同：1
> 
> 时间：2008-11-24T14:14:40.750
> 
> 标签：asp.net, iframe

我有多个 iframe 显示相同的数据集合（asp.net 缓存中的帮助）。

在修改其中一个帧上的数据后，我希望所有其他帧都反映更新，而不需要对每个帧进行显式回发。

所以问题是：在这种情况下保持 iframe 同步的最简单和最优雅的方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:21:04.247

我还没有看到一个优雅的 iframe 解决方案，但它是对某些问题的务实解决方案。这里有一些想法：

*   将您的更改发布到顶层框架并重建所有框架
*   使用自定义 javascript 在更改时更新必要的框架
*   使用自定义 javascript 在更改时更新顶级框架

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T11:06:35.090

好的，我已经实施了你的第二个建议。但是，在最终的解决方案中，我设法避免使用 iframe，这在任何情况下都要好得多:)

谢谢....

# c# - ASP.NET 内联脚本

> ID：314232
> 
> 赞同：2
> 
> 时间：2008-11-24T14:17:02.087
> 
> 标签：c#, asp.net, scripting, inline

我有一个 DateTime 对象，我需要在自定义网格控件中打印它。我要打印的数据类型是 dd-mm-yyyy 格式的日期。该值可以是填充的，也可以是空白的。如果已填充，它将被解析为 a`DateTime`然后打印为 default `ToString`。

对于每一行，我可以使用

```
<CellTemplate>
    <asp:Literal ID="Literal2" runat="server" Text="<%# Container.Value %>"></asp:Literal>
</CellTemplate> 
```

但这会打印日期的默认长版本。我想要`ToShortDateString()`.

所以我尝试修改为：

```
<CellTemplate>
    <asp:Literal ID="Literal2" runat="server" Text="<%# Convert.ToDateTime(Container.Value).ToShortTimeString()%>"></asp:Literal>
</CellTemplate> 
```

这按预期工作。

现在我有空日期的问题，

```
Convert.ToDateTime() 
```

在空字符串上，它将打印默认的 DateTime。

有没有一种方法可以在我的 aspx 代码中制作一个 If-Statement `Convert.ToDateTime`，如果它不是空字符串，则只执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T14:23:18.877

```
Container.Value.Length > 0 ? Convert.ToDateTime(Container.Value).ToShortTimeString() : "" 
```

您还应该能够传递`Container.Value`给您定义的范围内的任何方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:24:39.840

你可以在你的代码中有一个受保护的方法，它会为你做检查

```
protected static string ConvertDate(object date) {
    if (date == null)
       return string.Empty;
    return Convert.ToDateTime(date).ToShortTimeString();
} 
```

# python - 在 Jython 上开发 Django 有问题吗？

> ID：314234
> 
> 赞同：14
> 
> 时间：2008-11-24T14:17:17.327
> 
> 标签：python, django, jvm, jython

**的背景**

我正在和朋友一起构建一个相当大的 Web 应用程序，我们决定在 Python 上使用 Django 框架。Django 为我们提供了很多我们需要的特性，所以请不要推荐替代框架。

我唯一遇到问题的决定是我们是使用 Python 还是 Jython 来开发我们的应用程序。现在我对 Java 非常熟悉，并且可能会从 JDK 中的库中受益。我知道的 Python 最少，但我利用这个项目作为学习新语言的机会——所以大部分工作将用 Python 编写。

Jython 的吸引力当然在于 JVM。启用 python/django 的 web 主机的数量非常少——而我假设我可以将 jython/django 应用程序放在各种各样的主机上。这不是一个重大的设计决定，但我认为仍然需要做出决定。对于 jvm 的可访问性，我真的更喜欢 jython 而不是 python。

**问题**

与常规 python 相比，Jython 有很多限制吗？在 jython 上运行 django 会导致问题吗？Jython 团队与 Python 一起发布更新的速度有多快？Django 会像在 Jython 上宣传的那样工作（具有非常少的预配置）吗？

**决定**

感谢您的有用评论。我想我要做的是在 Jython 中开发 JVM 支持——但尝试只使用 Python 代码/库。可移植性不是主要问题，所以如果我需要 JDK 中的库（在 python 中不容易获得），我会使用它。只要 Django 得到完全支持，我就很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T14:35:35.857

Django 确实[在 Jython 上工作](http://wiki.python.org/jython/DjangoOnJython)，尽管您需要使用 Jython 的开发版本，因为从技术上讲，Jython 2.5 仍处于测试阶段。但是，Django 1.0 及更高版本应该可以不加修改地工作。

至于您应该使用常规的 Python 实现还是 Jython，我想说这是您更喜欢使用所有 Java 库还是所有 Python 库的问题。在这一点上，您可以期望 Python 标准库中的几乎所有内容都可以与 Jython 一起使用，但是仍然有很多第三方包无法使用，尤其是 C 扩展模块。我个人建议使用常规的 Python，但如果你有大量的 JVM 经验并且想坚持你所知道的，那么我可以尊重这一点。

至于寻找 Python 托管，[这个页面可能会有所帮助](http://wiki.python.org/moin/PythonHosting)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T15:17:55.910

我想说，如果你喜欢 Django，你也会喜欢 Python。不要犯（太常见的）错误，在学习新语言的同时混合过去的语言经验。只有在掌握了 Python 之后，你才会有经验来判断一种混合语言是否比任何一种语言都好。

确实很少有廉价主机提供预装的 Django。但这种情况很可能会改变，因为它是与谷歌应用引擎最相似的环境。（大多数 GAE 项目都可以在 Django 上运行）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T19:10:44.943

我最近开始在业余时间从事一个开源桌面项目。所以这可能不适用。我遇到了同样的问题。我决定我应该尽可能多地用 python（和 Django）编写代码，并针对所有平台 CPython、Jython 和 IronPython。

然后，我决定编写与不同实现上的库（例如，不同的 GUI 库）交互的插件。

为什么？我很早就决定，我的代码的寿命可能不仅取决于 CPython，还取决于虚拟机。对于今天的目的，CPython 是因为速度而要走的路，但谁知道明天呢。如果您的代码足够灵活，您可能不必决定定位一个。

这种方法的缺点是您将需要创建和维护更多代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T14:32:30.870

Django 应该是 jython 兼容的 sinc 版本 1.0。

[本教程](http://wiki.python.org/jython/DjangoOnJython)有点过时，但从那里您可以看到没有特殊问题。

# oop - 您应该始终为哪些 OOP 编码实践腾出时间？

> ID：314241
> 
> 赞同：13
> 
> 时间：2008-11-24T14:18:29.960
> 
> 标签：oop, rad

我倾向于在很短的期限内做很多项目，并且有很多永远不会再次使用的代码，所以总是有压力/诱惑去偷工减料。我一直坚持的一条规则是封装/松耦合，所以我有很多小类，而不是一个大神类。但还有什么我不应该妥协的呢？

**更新**- 感谢您的好评。很多人都建议进行单元测试，但我认为这并不适合我所做的那种 UI 编码。可用性/用户接受度测试似乎很重要。重申一下，我说的是不可能的截止日期项目的编码标准的最低限度。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-24T14:19:46.247

不是 OOP，而是一种对短期和长期都有帮助的做法是 DRY，不要重复自己。不要使用复制/粘贴继承。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T14:21:53.120

不是 OOP 实践，而是常识；-)。

如果你赶时间，必须写一个 hack。总是添加一条带有原因的评论。因此，您可以追溯它并在以后制定一个好的解决方案。

如果你从来没有时间回来，你总是有评论，所以你知道为什么现在选择解决方案。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-24T14:38:58.453

**使用源代码控制**。

无论设置需要多长时间（秒..），它总能让您的生活更轻松！（仍然与 OOP 无关）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-24T15:31:41.593

命名。在压力下，您将编写糟糕的代码，您将没有时间记录甚至评论。尽可能明确地命名变量、方法和类几乎不需要额外的时间，并且在你必须修复它时会让混乱变得可读。从 OOP 的角度来看，对类使用名词和对方法使用动词自然有助于封装和模块化。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-24T14:28:29.270

单元测试 - 帮助你在晚上睡觉:-)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-24T14:34:17.637

这是相当明显的（我希望如此），但至少我总是确保我的公共界面尽可能正确。类的内部总是可以在以后重构。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-24T14:21:42.390

没有具有可变公共变量的公共类（类似结构）。

在不知不觉中，您在整个代码中都引用了这个公共变量，而当您决定该字段是计算字段并且其中必须包含一些逻辑的那一天......重构变得混乱。

如果那一天在您的发布日期之前，它会变得更加混乱。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-24T14:59:03.030

想想在某些时候必须阅读和理解代码的人（甚至可能是你未来的自己）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T14:59:42.220

和其他人一样，没有那么多的 OOP 实践，而是适用于 OOP 的编码实践。

1.  单元测试，单元测试，单元测试。已定义的单元测试习惯于让人们专注于任务，而不是在对象之间漫无目的地“徘徊”。
2.  在编写生产代码之前，定义和记录所有分层信息（命名空间、包、文件夹结构等）。这有助于充实对象关系并暴露与对象关系相关的假设中的缺陷。
3.  在编写生产代码之前定义并记录所有适用的接口。如果由主管或架构师完成，这种做法还可以帮助更多初级开发人员继续完成任务。

可能还有无数其他“应该”，但如果我必须选择我的前三名，那就是名单。

***编辑以回应评论：* 这正是您需要预先做这些事情的原因。所有这些类型的做法使持续维护变得更容易。当您在项目启动时承担更多风险时，您将花费越来越多的时间来维护代码的可能性就越大。诚然，前期成本更高，但建立在坚实的基础上是值得的。您的障碍是缺乏时间（即必须维护其他应用程序）还是来自更高层的决定？我不得不与这两条战线进行斗争才能采用这些做法，而且这种情况并不令人愉快。**

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-24T17:31:42.100

单一责任主体的应用。有效地应用这一原则会产生很多积极的外部性。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-24T18:39:53.617

当然，一切都应该经过单元测试、精心设计、注释、检查到源代码控制并且没有错误。但生活不是这样的。

我的个人排名是这样的：

1.  使用源代码管理并实际编写提交评论。这样一来，如果您想知道“我写这篇文章时到底是怎么想的”，您就有了一点点文档。
2.  编写干净的代码*或*文档。干净、编写良好的代码应该需要很少的文档，因为它的含义可以通过阅读来掌握。黑客有很多不同。写下你为什么这样做，你做了什么，如果你有时间/知识/动机/……做对的话，你想做什么
3.  单元测试。是的，它排在第三位。不是因为它不重要，而是因为如果你没有其他两个至少完成一半，它就没用了。编写单元测试是另一个级别的文档，你的代码应该做什么（等等）。
4.  在添加内容之前进行重构。这听起来像是一个典型的“但我们没有时间”的观点。但与其中许多要点一样，它通常节省的时间多于成本。至少如果你至少有一些经验的话。

我知道已经提到了很多，但由于这是一个相当主观的问题，我想添加我的排名。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-24T15:36:22.737

就像其他人都建议这些建议并非特定于 OOP 一样：

确保您注释您的代码并使用合理命名的变量。如果你不得不回顾你编写的快速而肮脏的代码，你应该能够很容易地理解它。我遵循的一般规则是；如果你删除了所有代码，只剩下注释，你应该仍然能够理解程序流程。

黑客攻击通常很复杂且不直观，所以一些好的评论是必不可少的。

我还建议，如果您通常必须在紧迫的期限内工作，请根据您最常见的任务为自己建立一个代码库。这将允许您在每次有项目时“加入点”而不是重新发明轮子。

问候，

博士后

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-24T17:12:44.837

[在此处插入样板文件非 OOP 特定警告]

*   关注点分离，单元测试，以及如果某件事太复杂，它可能还没有完全正确地概念化的感觉。

*   UML 草图：这已经澄清并节省了很多次浪费的精力。图片很棒不是吗？:)

*   真的在考虑 is-a's 和 has-a's。第一次做到这一点非常重要。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-24T17:16:49.413

无论公司想要多快，我几乎总是尽我所能编写代码。

我发现它不需要更长的时间，而且通常可以节省很多时间，即使在短期内也是如此。

我不记得曾经写过代码并且再也看不到它，我总是通过它来测试和调试它，即使在那些少数通过实践中，例如重构以保持我的代码干燥，文档（对某些人来说）度），关注点分离和凝聚力似乎都可以节省时间。

这包括创建比大多数人更多的小类（每个类一个问题，请），并且经常将初始化数据提取到外部文件（或数组）中并为该数据编写小解析器......有时甚至编写小 GUI 而不是编辑数据手。

编码本身非常快速和容易，调试某人在“压力之下”时写的废话是一直需要的！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-24T18:23:27.877

在我目前的项目将近一年的时间里，我终于建立了一个自动构建，它将任何新的提交推送到测试服务器，伙计，我希望我在第一天就做到了。我早期犯的最大错误就是[变黑](http://www.codinghorror.com/blog/archives/001134.html)了。对于每个功能、增强功能、错误修复等，在我让任何人看到产品之前，我都有一个“只有一个更多”的糟糕案例，并且它实际上螺旋式进入了六个月的周期。如果每一个合理的变化都被自动推出，我会更难隐藏，而且我会在利益相关者的参与方面更加正确。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-24T18:45:14.773

回到你几天/几周前写的代码，花 20 分钟检查你自己的代码。随着时间的推移，您将能够确定您的“即兴”代码是否组织得足够好，可以用于未来的维护工作。当你在那里时，寻找重构和重命名的机会。

我有时会发现我一开始为函数选择的名称并不完全适合最终形式的函数。使用重构工具，您可以在名称被广泛使用之前轻松更改名称。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-25T10:50:39.227

我总是花时间实践的实际 OOP 实践是[单一职责原则](http://davidhayden.com/blog/dave/archive/2005/05/29/1066.aspx)，因为在项目“上线”后，正确重构代码变得非常困难。
通过坚持这个原则，我发现如果我编写的代码无法满足功能或非功能需求，我很容易被重用、替换或重写。当您最终得到具有多种职责的类时，其中一些可能满足要求，一些可能不满足要求，并且整体可能完全不清楚。

这些类的维护压力很大，因为您永远不确定您的“修复”会破坏什么。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-24T14:53:05.070

对于这种特殊情况（截止日期短，并且有很多代码永远不会再次使用），我建议您注意将一些脚本引擎嵌入到您的 OOP 代码中。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-24T18:22:34.167

学习“随用随重构”。主要从“提取方法”的角度来看。当你开始编写一个顺序代码块时，花几秒钟的时间来决定这个块是否可以作为一个可重用的方法独立使用，如果可以，立即创建该方法。我推荐它甚至用于一次性项目（特别是如果您可以稍后返回并将这些方法编译到您的个人工具箱 API 中）。没过多久，你几乎不假思索地做这件事。

希望你已经这样做了，我正在向合唱团布道。

# c# - 如何抑制列表属性的 XML 标记

> ID：314242
> 
> 赞同：10
> 
> 时间：2008-11-24T14:18:41.863
> 
> 标签：c#, xml, xml-serialization

序列化时是否可以避免列出属性标签？

```
//[Serializable()] - removed, unnecessary
public class Foo
{
    protected List<FooBar> fooBars = new List<FooBar>();
    public virtual List<FooBar> FooBars
    {
        get { return fooBars; }
        set { fooBars = value; }
    }
}

// [Serializable()] - removed, unnecessary
public class FooBar
{
    public int MyProperty
    { get; set; }
} 
```

序列化 Foo 给出（注释除外）：

```
<Foo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <FooBars>    <!-- Unwanted tag -->
    <FooBar>
      <MyProperty>7</MyProperty> 
    </FooBar>
    <FooBar>
      <MyProperty>9</MyProperty> 
    </FooBar>
  </FooBars>
</Foo> 
```

想要的输出：

```
<Foo xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <FooBar>
    <MyProperty>7</MyProperty> 
  </FooBar>
  <FooBar>
    <MyProperty>9</MyProperty> 
  </FooBar> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-24T14:48:32.397

添加：

```
[System.Xml.Serialization.XmlElement("FooBar")]
public virtual List<FooBar> FooBars 
{ 
    get { return fooBars; } 
    set { fooBars = value; }
} 
```

结果是

```
<FooMain xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http:/
/www.w3.org/2001/XMLSchema">
  <FooBar>
    <MyProperty>7</MyProperty>
  </FooBar>
  <FooBar>
    <MyProperty>76</MyProperty>
  </FooBar>
  <FooBar>
    <MyProperty>67</MyProperty>
  </FooBar>
</FooMain> 
```

# ms-access - vbscript 将访问查询导出到制表符分隔文件不起作用

> ID：314245
> 
> 赞同：2
> 
> 时间：2008-11-24T14:19:17.527
> 
> 标签：ms-access, vbscript

我有这个代码：

```
db = "C:\Dokumente und Einstellungen\hom\Anwendungsdaten\BayWotch4\Neuer Ordner\baywotch.db5"
TextExportFile = "C:\Dokumente und Einstellungen\hom\Anwendungsdaten\BayWotch4\Neuer Ordner\Exp.txt"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open _
   "Provider = Microsoft.Jet.OLEDB.4.0; " & _
   "Data Source =" & db

strSQL = "SELECT * FROM tblAuction1"

rs.Open strSQL, cn, 3, 3

Set fs = CreateObject("Scripting.FileSystemObject")

Set f = fs.CreateTextFile(TextExportFile, True)

a = rs.GetString

f.WriteLine a

f.Close 
```

这意味着连接到一个访问数据库并生成一个制表符分隔的文本文件。tblAuction1 是数据库中的一个查询，并且肯定存在并且没有以任何方式拼写错误，但我得到一个错误，它无法找到或不存在。当我将其更改为表名 tblAuction 时，我收到一条错误消息，指出 f.WriteLine a 已被错误调用。

编辑：我现在只遇到 f.writeline a 的问题，说提供了不正确的参数。我不再有 tblAuction1 的问题

编辑：用于我的查询的 sql 代码：

```
SELECT tblAuction.article_no, tblAuction.article_name, tblAuction.subtitle, tblAuction.current_bid, tblAuction.start_price, tblAuction.bid_count, tblAuction.quant_total, tblAuction.quant_sold, tblAuction.start, tblAuction.ends, tblAuction.origin_end, tblUser.user_name, tblAuction.best_bidder_id, tblAuction.finished, tblAuction.watch, tblAuction.buyitnow_price, tblAuction.pic_url, tblAuction.private_auction, tblAuction.auction_type, tblAuction.insert_date, tblAuction.update_date, tblAuction.cat_1_id, tblAuction.cat_2_id, tblAuction.article_desc, tblAuction.countrycode, tblAuction.location, tblAuction.condition, tblAuction.revised, tblAuction.paypal_accept, tblAuction.pre_terminated, tblAuction.shipping_to, tblAuction.fee_insertion, tblAuction.fee_final, tblAuction.fee_listing, tblAuction.pic_xxl, tblAuction.pic_diashow, tblAuction.pic_count, tblAuction.item_site_id
FROM tblUser INNER JOIN tblAuction ON tblUser.id = tblAuction.seller_id; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T20:39:59.520

我试图在几个数据库和机器上重现这个，我不能让你的代码失败。

树叶 ：

*   数据库损坏，您能否运行修复并重试？
*   您的数据库中抛出查询的字段，我尝试了几种可能性，但找不到任何会破坏您的代码的东西。要排除其他事情，您可以尝试创建一个新表并查看您的代码是否适用于该表。
*   你的dll有问题，你能在另一台机器上试试吗？

答案（要了解我们如何得出答案，请参阅评论）

您的数据库中存在 writeline 不接受的 unicode 字符，因为您将文本文件创建为 ASCI。这种情况下的字符特别是 ♥♥♥</p>

为了使它工作：

```
Set f = fs.CreateTextFile(TextExportFile, True, True) 
```

附言

这个问题之前在[这里](https://stackoverflow.com/questions/280894/automatically-convert-access-db)使用 transfertext 宏得到了回答， 正如[Remou](https://stackoverflow.com/users/2548/remou)指出的那样，这看起来是一个更干净的解决方案。让它与非默认分隔符一起工作有点痛苦。首先通过右键单击并选择导出来开始导出您要导出的查询。在以下对话框中指定规格并保存。创建宏时，选择您刚刚保存的规范。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T14:31:38.780

我认为您的连接字符串中的空格有问题

试试这个：

```
cn.Provider = "Microsoft.Jet.OLEDB.4.0"
cn.ConnectionString = db
cn.Open 
```

高温高压

更新：也许数据库的访问权限有问题？或者 mdb 已经由另一个用户独占打开（您在设计模式下具有访问权限）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T20:11:09.720

试试这个

```
 cn.Open _
  "Provider=Microsoft.Jet.OLEDB.4.0;" & _
  "Persist Security Info=False;" & _
  "Data Source=" & db 
```

# iphone - 如何从我的 EAGLLayer 中获取图像？

> ID：314254
> 
> 赞同：3
> 
> 时间：2008-11-24T14:21:05.197
> 
> 标签：iphone, opengl-es, eaglview

我正在寻找方法来获取我的 opengl（作为 UIImage）的内容，然后将其保存到文件中。我现在正在尝试 glReadPixels，尽管我不确定我是否在做正确的事情，我应该做什么样的 malloc。我收集到在 OSX 上它是 GL_BGRA 但在 iPhone 上不起作用......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T14:46:58.610

所有 OpenGL|ES 兼容的 GL 实现都必须支持 GL_RGBA 作为 glReadPixels 的参数。

如果您的 OpenGL|Es 支持

```
GL_IMPLEMENTATION_COLOR_READ_FORMAT_OES 
```

扩展名您还可以查询本机格式。glReadPixels 会将此格式理解为 glReadPixels 的参数，并允许您直接获取本机格式的像素数据。这通常比 GL_RGBA 快一点。

查看头文件或通过 glGetString 查询扩展支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-15T15:01:53.520

查找“技术问答 QA1704 OpenGL ES View Snapshot”，其中 Apple 给出了一个可行的示例，包括 Nils 的“更好的方法”来取消翻转图像。它会带你到你的 UIImage，然后从那里跟随 Nils 获取另存为文件的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-26T09:39:00.967

从 OpenGL ES 视图中获取数据：

```
-(UIImage *) snapshot {
    NSInteger myDataLength = backingWidth * backingHeight * 4;
    // allocate array and read pixels into it.
    GLubyte *buffer = (GLubyte *) malloc(myDataLength);
    glReadPixels(0, 0, backingWidth, backingHeight, GL_RGBA, GL_UNSIGNED_BYTE, buffer);
    // gl renders "upside down" so swap top to bottom into new array.
    // there's gotta be a better way, but this works.
    GLubyte *buffer2 = (GLubyte *) malloc(myDataLength);
    for(int y = 0; y <backingHeight; y++)
    {
        for(int x = 0; x <backingWidth * 4; x++)
        {
            buffer2[((backingHeight - 1) - y) * backingWidth * 4 + x] = buffer[y * 4 * backingWidth + x];
        }
    }
    free(buffer);
    // make data provider with data.
    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, buffer2, myDataLength, NULL);
    // prep the ingredients
    int bitsPerComponent = 8;
    int bitsPerPixel = 32;
    int bytesPerRow = 4 * backingWidth;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;
    // make the cgimage
    CGImageRef imageRef = CGImageCreate(backingWidth, backingHeight, bitsPerComponent, bitsPerPixel, bytesPerRow, colorSpaceRef, bitmapInfo, provider, NULL, NO, renderingIntent);
    // then make the uiimage from that
    UIImage *myImage = [UIImage imageWithCGImage:imageRef];
    return myImage;
} 
```

然后保存图像：

```
-(void) saveImage:(UIImage *)image {}
    // Create paths to output images
    NSString  *pngPath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/Test.png"];
    NSString  *jpgPath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/Test.jpg"];

    // Write a UIImage to JPEG with minimum compression (best quality)
    // The value 'image' must be a UIImage object
    // The value '1.0' represents image compression quality as value from 0.0 to 1.0
    [UIImageJPEGRepresentation(image, 1.0) writeToFile:jpgPath atomically:YES];

    // Write image to PNG
    [UIImagePNGRepresentation(image) writeToFile:pngPath atomically:YES];
} 
```

# objective-c - 如何以编程方式创建 Cocoa 窗口？

> ID：314256
> 
> 赞同：71
> 
> 时间：2008-11-24T14:21:22.593
> 
> 标签：objective-c, cocoa, nswindow

我的 Cocoa 应用程序需要一些小的动态生成的窗口。如何在运行时以编程方式创建 Cocoa 窗口？

到目前为止，这是我的非工作尝试。我看不到任何结果。

```
NSRect frame = NSMakeRect(0, 0, 200, 200);
NSUInteger styleMask =    NSBorderlessWindowMask;
NSRect rect = [NSWindow contentRectForFrameRect:frame styleMask:styleMask];

NSWindow * window =  [[NSWindow alloc] initWithContentRect:rect styleMask:styleMask backing: NSBackingStoreRetained    defer:false];
[window setBackgroundColor:[NSColor blueColor]];
[window display]; 
```

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2008-11-24T14:39:58.063

问题是你不想调用`display`，你想调用或者调用`makeKeyAndOrderFront`取决于`orderFront`你是否希望窗口成为关键窗口。您还应该使用`NSBackingStoreBuffered`.

此代码将在屏幕左下方创建无边框蓝色窗口：

```
NSRect frame = NSMakeRect(0, 0, 200, 200);
NSWindow* window  = [[[NSWindow alloc] initWithContentRect:frame
                    styleMask:NSBorderlessWindowMask
                    backing:NSBackingStoreBuffered
                    defer:NO] autorelease];
[window setBackgroundColor:[NSColor blueColor]];
[window makeKeyAndOrderFront:NSApp];

//Don't forget to assign window to a strong/retaining property!
//Under ARC, not doing so will cause it to disappear immediately;
//  without ARC, the window will be leaked. 
```

您可以将发件人设置为适合您的情况`makeKeyAndOrderFront`或`orderFront`任何适合您的情况。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-05-12T01:59:24.187

附带说明，如果您想在没有主笔尖的情况下以编程方式实例化应用程序，请在 main.m 文件中/您可以按如下方式实例化 AppDelegate。然后在您的应用程序 Supporting Files / YourApp.plist *Main nib base file / MainWindow.xib*中删除此条目。然后使用 Jason Coco 的方法在您的 AppDelegates init 方法中附加窗口。

```
#import "AppDelegate.h":

int main(int argc, char *argv[])
{

  NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
  [NSApplication sharedApplication];

  AppDelegate *appDelegate = [[AppDelegate alloc] init];
  [NSApp setDelegate:appDelegate];
  [NSApp run];
  [pool release];
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T14:39:33.617

尝试

```
[window makeKeyAndOrderFront:self]; 
```

代替

```
[window display]; 
```

这就是你的目标吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-12-02T10:43:40.650

将评价最高的答案翻译成现代 swift (5) 会给你类似这样的东西：

```
var mainWindow: NSWindow!

...

mainWindow = NSWindow(
    contentRect: NSMakeRect(0, 0, 200, 200),
    styleMask: [.titled, .resizable, .miniaturizable, .closable],
    backing: .buffered,
    defer: false)
mainWindow.backgroundColor = .blue
mainWindow.makeKeyAndOrderFront(mainWindow) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T14:38:57.860

这是我自己想出的：

```
NSRect frame = NSMakeRect(100, 100, 200, 200);
NSUInteger styleMask =    NSBorderlessWindowMask;
NSRect rect = [NSWindow contentRectForFrameRect:frame styleMask:styleMask];
NSWindow * window =  [[NSWindow alloc] initWithContentRect:rect styleMask:styleMask backing: NSBackingStoreBuffered    defer:false];
[window setBackgroundColor:[NSColor blueColor]];
[window makeKeyAndOrderFront: window]; 
```

这将显示一个蓝色窗口。我希望这是最佳方法。

# java - 如何使用 Java 将文档上传到 SharePoint？

> ID：314258
> 
> 赞同：17
> 
> 时间：2008-11-24T14:21:31.233
> 
> 标签：java, sharepoint, soap, upload

我正在使用 Java 创建一些大文件（数据库导出），我需要将它们放在我们的 SharePoint 服务器上的某个位置。现在，我正在使用 IE 执行此操作，但我也想自动执行此步骤。

我在网上搜索了一些使用 SOAP 的提示，但我还没有真正了解这一切。有人可以为我提供一些示例代码或我需要做的食谱吗？

请注意：SharePoint 服务器要求进行 NT 域身份验证。我什至无法使用 Firefox 登录 :(

**编辑**

*   如何将 IE 中的可怕 URL 转换为 WebDAV 路径？
*   在我用我的代码破坏生产系统之前，有没有可以使用的 WebDAV“资源管理器”？[我从http://www.davexplorer.org/](http://www.davexplorer.org/)尝试了“DAV Explorer 0.91”，但无法连接（可能是因为 NT 域身份验证）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T15:29:35.777

除了[Sacha 的建议](https://stackoverflow.com/questions/314258/how-do-i-upload-a-document-to-sharepoint-with-java/314283#314283)之外，您还可以使用 SharePoint SOAP Web 服务。每个 SharePoint 站点都通过路径公开一堆 Web 服务`http://<Site>/_vti_bin/`。

在您的情况下，您可能需要[Lists Web 服务](http://msdn.microsoft.com/en-us/library/lists.aspx)( `http://<Site>/_vti_bin/Lists.asmx`)。您可以从`http://<Site>/_vti_bin/Lists.asmx?WSDL`. WSS 3.0 SDK 详细介绍了如何使用 Web 服务（您可能希望使用`UpdateListItems`和`AddAttachment`方法）。

话虽如此，假设您可以解决 NTLM 问题，Sacha 的第一个选项（将文档库映射到驱动器）可能是最简单的方法。

如果您使用的是 Windows，您可以简单地导航到文档库的 UNC 路径。例如，如果您的文档库的浏览器 URL 是：

`http://<Site>/Foo/BarDocs/Forms/AllItems.aspx`

您只需在 Windows 资源管理器地址栏中键入相应的 UNC 路径即可：

`\\<Site>\Foo\BarDocs`

然后将文件拖放到此位置。如果您愿意，可以使用 Windows 资源管理器或 SUBST.EXE 命令行实用程序将此位置映射到驱动器号。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-26T14:56:47.480

好的......经过几个小时的工作并通过微软提供的“文档”和所有的提示在网络上随机传播，我设法编写了一些示例代码来浏览 SharePoint 服务器的内容：[导航 SharePoint带有 Axis2 的文件夹](http://blog.pdark.de/2008/11/navigating-sharepoint-folders-with.html)。

下一站：上传东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T09:51:00.587

另一种解决方案是使用**HTTP PUT 方法**将文件直接发送到 Sharepoint。

为此，您可以使用**Apache HTTP 客户端**：

```
<dependency>
    <groupId>org.apache.httpcomponents</groupId>
    <artifactId>httpclient</artifactId>
    <version>4.2.3</version>
</dependency> 
```

要允许 NTLMv2 身份验证，您需要**JCIF**库。

```
<dependency>
   <groupId>jcifs</groupId>
   <artifactId>jcifs</artifactId>
   <version>1.3.17</version>
</dependency> 
```

首先，我们需要编写一个包装器以允许 Apache HTTP 客户端使用 JCIF 来支持 NTLMv2：

```
public final class JCIFSEngine implements NTLMEngine {

    private static final int TYPE_1_FLAGS =
            NtlmFlags.NTLMSSP_NEGOTIATE_56
            | NtlmFlags.NTLMSSP_NEGOTIATE_128
            | NtlmFlags.NTLMSSP_NEGOTIATE_NTLM2
            | NtlmFlags.NTLMSSP_NEGOTIATE_ALWAYS_SIGN
            | NtlmFlags.NTLMSSP_REQUEST_TARGET;

    @Override
    public String generateType1Msg(final String domain, final String workstation)
            throws NTLMEngineException {
        final Type1Message type1Message = new Type1Message(TYPE_1_FLAGS, domain, workstation);
        return Base64.encode(type1Message.toByteArray());
    }

    @Override
    public String generateType3Msg(final String username, final String password,
            final String domain, final String workstation, final String challenge)
            throws NTLMEngineException {
        Type2Message type2Message;
        try {
            type2Message = new Type2Message(Base64.decode(challenge));
        } catch (final IOException exception) {
            throw new NTLMEngineException("Invalid NTLM type 2 message", exception);
        }
        final int type2Flags = type2Message.getFlags();
        final int type3Flags = type2Flags
                & (0xffffffff ^ (NtlmFlags.NTLMSSP_TARGET_TYPE_DOMAIN | NtlmFlags.NTLMSSP_TARGET_TYPE_SERVER));
        final Type3Message type3Message = new Type3Message(type2Message, password, domain,
                username, workstation, type3Flags);
        return Base64.encode(type3Message.toByteArray());
    }
} 
```

[参考](http://hc.apache.org/httpcomponents-client-ga/ntlm.html)

使用身份验证执行 HTTP PUT 的主要代码：

```
 try {

        HttpParams params = new BasicHttpParams();
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
        DefaultHttpClient httpclient = new DefaultHttpClient(params);

        //Register JCIF NTLMv2 to manage ntlm auth.
        httpclient.getAuthSchemes().register("ntlm", new AuthSchemeFactory() {
            @Override
            public AuthScheme newInstance(HttpParams hp) {
                return new NTLMScheme(new JCIFSEngine());
            }
        });

        //Provide login/password
        httpclient.getCredentialsProvider().setCredentials(
                AuthScope.ANY,
                new NTCredentials([LOGIN], [PASSWORD], "", [DOMAIN]));
        //Create HTTP PUT Request       
        HttpPut request = new HttpPut("http://[server]/[site]/[folder]/[fileName]");
        request.setEntity(new FileEntity([File]));            

        return httpclient.execute(request);

    } catch (IOException ex) {
      //...
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T14:30:42.323

我可以想到不同的选择：

*   将文档库映射到文件驱动器，然后像保存文件系统中的任何其他文件一样保存文件。
*   使用 HTTP WebDAV 协议。

...对于 NTLM 身份验证部分：

[http://www.luigidragone.com/networking/ntlm.html](http://www.luigidragone.com/networking/ntlm.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-20T14:49:20.383

我想我的方法可能会对你有所帮助。

最初，我创建了 sharepoint 帐户并按照此链接 ( [http://www.ktskumar.com/2017/01/access-sharepoint-online-using-postman/](http://www.ktskumar.com/2017/01/access-sharepoint-online-using-postman/) ) 中的过程获取 REST API 所需的凭据。一旦我获得了凭据，我所需要的就是以下依赖项和代码：

```
<dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpclient</artifactId>
        <version>4.5</version>
</dependency> 
```

由于我使用了 OAUTH2 身份验证，因此获取访问令牌的代码有助于其他 CRUD 操作。

```
/* OAuth2 authentication to get access token */
public String getSharePointAccessToken() throws ClientProtocolException, IOException
{
    /* Initializing variables */
    String grant_type = RcConstants.GRANT_TYPE;
    String client_id = RcConstants.CLIENT_ID;
    String client_secret = RcConstants.CLIENT_SECRET;
    String resource = RcConstants.RESOURCE;
    String url = RcConstants.OAUTH_URL + RcConstants.URL_PARAMETER + "/tokens/OAuth/2";

    /*
     * NOTE: RcConstants.OAUTH_URL =
     * https://accounts.accesscontrol.windows.net/ RcConstants.URL_PARAMETER
     * = Bearer Realm from
     * (http://www.ktskumar.com/2017/01/access-sharepoint-online-using-
     * postman/) Figure 6.
     */

    /* Building URL */
    HttpClient client = HttpClientBuilder.create().build();
    HttpPost post = new HttpPost(url);
    post.setHeader("Content-Type", "application/x-www-form-urlencoded");

    /* Adding URL Parameters */
    List<NameValuePair> urlParameters = new ArrayList<NameValuePair>();
    urlParameters.add(new BasicNameValuePair("grant_type", grant_type));
    urlParameters.add(new BasicNameValuePair("client_id", client_id));
    urlParameters.add(new BasicNameValuePair("client_secret", client_secret));
    urlParameters.add(new BasicNameValuePair("resource", resource));
    post.setEntity(new UrlEncodedFormEntity(urlParameters));

    /* Executing the post request */
    HttpResponse response = client.execute(post);
    logger.debug("Response Code : " + response.getStatusLine().getStatusCode());

    String json_string = EntityUtils.toString(response.getEntity());
    JSONObject temp1 = new JSONObject(json_string);  
    if (temp1 != null)
    {
        /* Returning access token */
        return temp1.get("access_token").toString();
    }
    return RcConstants.OAUTH_FAIL_MESSAGE;
} 
```

一旦我们获得访问令牌，我们就可以使用以下方法上传：

```
public String putRecordInSharePoint(File file) throws ClientProtocolException, IOException
{
    /* Token variable declaration */
    String token = getSharePointAccessToken();
    /* Null or fail check */
    if (!token.equalsIgnoreCase(RcConstants.OAUTH_FAIL_MESSAGE))
    { 
        /* Upload path and file name declaration */
        String Url_parameter = "Add(url='" + file.getName() + "',overwrite=true)";
        String url = RcConstants.UPLOAD_FOLDER_URL + Url_parameter;
        /*
         * NOTE: RcConstants.UPLOAD_FOLDER_URL =
         * https://<your_domain>.sharepoint.com/_api/web/
         * GetFolderByServerRelativeUrl('/Shared%20Documents/<FolderName>')/
         * Files/
         */

        /* Building URL */
        HttpClient client = HttpClientBuilder.create().build();
        HttpPost post = new HttpPost(url);
        post.setHeader("Authorization", "Bearer " + token);
        post.setHeader("accept", "application/json;odata=verbose");
        /* Declaring File Entity */
        post.setEntity(new FileEntity(file));

        /* Executing the post request */
        HttpResponse response = client.execute(post);
        logger.debug("Response Code : " + response.getStatusLine().getStatusCode());

        if (response.getStatusLine().getStatusCode() == HttpStatus.OK.value()|| response.getStatusLine().getStatusCode() == HttpStatus.ACCEPTED.value())
        {
            /* Returning Success Message */
            return RcConstants.UPLOAD_SUCCESS_MESSAGE;
        }
        else
        {
            /* Returning Failure Message */
            return RcConstants.UPLOAD_FAIL_MESSAGE;
        }
    }
    return token;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-06-07T13:35:58.280

我设法使用集成的 Windows 标识使用此代码将文件下载到共享点，也许它会有所帮助。

```
public class HttpClient {               
    HttpClient() { }

    public static void download(final String source, final File resultingFile) {
        CloseableHttpClient client = WinHttpClients.createSystem();
        HttpGet httpRequest = new HttpGet(source);

        CloseableHttpResponse httpResponse = null;      
        try {
            httpResponse = client.execute(httpRequest);
            HttpEntity entity = httpResponse.getEntity();

            if(httpResponse.getStatusLine() != null && httpResponse.getStatusLine().getStatusCode() != HttpStatus.SC_OK) {
                LOGGER.warn(httpResponse.getStatusLine());
            }else {  
                LOGGER.debug(httpResponse.getStatusLine());
                FileUtils.touch(resultingFile);
                InputStream is = entity.getContent(); 
                File outFile = new File(resultingFile.getAbsolutePath());
                FileOutputStream fos = new FileOutputStream(outFile);

                int inByte;
                while ((inByte = is.read()) != -1) {
                    fos.write(inByte);
                }
                is.close();
                fos.close(); 
                client.close();
            }
        } catch (ClientProtocolException e) {
            LOGGER.warn(e);
        } catch (UnsupportedOperationException e) {
            LOGGER.warn(e);
        } catch (IOException e) {
            LOGGER.warn(e);
        }
    }

    public static void upload(final File source, final String destination) {    
        CloseableHttpClient httpclient = WinHttpClients.createSystem();
        HttpPut httpRequest = new HttpPut(destination);
        httpRequest.setEntity(new FileEntity(new File(source.getPath())));

        CloseableHttpResponse httpResponse = null;
        try {
            httpResponse = httpclient.execute(httpRequest);
            EntityUtils.consume(httpResponse.getEntity());

            if (httpResponse.getStatusLine() != null && httpResponse.getStatusLine().getStatusCode() == HttpStatus.SC_CREATED) {
                LOGGER.debug(httpResponse.getStatusLine());
                LOGGER.info("Upload of " + source.getName() + " via HTTP-Client succeeded.");
            } else if (httpResponse.getStatusLine() != null && httpResponse.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
                LOGGER.debug(httpResponse.getStatusLine());
            }else {
                LOGGER.warn("Uploading " + source.getName() + " failed.");
                LOGGER.warn(httpResponse.getStatusLine().getStatusCode() + ": " + httpResponse.getStatusLine().getReasonPhrase());
            }
        } catch (IOException e) {
            LOGGER.warn(e);
            LOGGER.warn(e.getMessage());
        }       
        return;
    }
} 
```

**WinHttpClients：**

```
 <dependency>
     <groupId>org.apache.httpcomponents</groupId>
     <artifactId>httpclient-win</artifactId>
     <version>4.4</version>
 </dependency> 
```

路径：
org.apache.http.impl.client.WinHttpClients

说明：
CloseableHttpClient 实例的工厂方法配置为默认使用集成 Windows 身份验证。

# actionscript-3 - 如何加快 Flash IDE 项目的编译/发布时间

> ID：314264
> 
> 赞同：9
> 
> 时间：2008-11-24T14:23:23.680
> 
> 标签：actionscript-3, flash, ide

我厌倦了等待 Flash 发布的时间。.NET / VisualStudio 项目的速度要快得多——那只是编译已更改的类吗？

更新：Flash IDE 是否会在您每次发布时重新编码您的所有声音和图像？它不能将它们缓存在某个地方吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-08-23T03:40:00.690

在 Flash CS4 中，禁用警告模式可将代码编译速度提高约 30%（仍然很慢）。严格模式也是，但我不确定到什么程度。

对于库资源，通过将 JPEG 设置为“使用导入的 JPEG 数据”和将 PNG/GIF 设置为“Loosless PNG/GIF”来实现最佳速度。至于声音，我不是 100% 确定，但我认为 ADPCM/单声道到立体声/5kHz/2bit 是最快的。[Embed] 标签也可能有帮助（它不进行任何转换），但它包含相当多的 Flex 代码。

作为提示，在 Flash CS4 中，您可以批量选择库中的资源并应用设置，因此您可以在开发时轻松设置最佳速度设置，然后更改它们以进行部署。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-25T20:30:20.167

在文件 > 发布设置 > Actionscript 3.0 设置中取消选中“警告模式”。这有很大的不同。在最近的一个项目中，我将编译时间从 1 分 20 秒缩短到了 7 秒！是的，我也惊呆了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-22T19:39:16.773

对我来说，事实证明我删除了文本字段上的字符过滤器。这似乎无害，但实际上它必须嵌入它可以嵌入的每一个压裂字形，这导致了一个巨大的 swf 文件，需要永远编译！无论如何，一定要检查一下——我认为很多人很容易忽略这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T15:52:48.757

您可以尝试将应用程序拆分为单独的 .swf 文件，然后从主电影中加载它们。

此外，可能值得查看您的环境。也许您的机器内存不足，您正在使用网络驱动器或您的硬盘已加密。

此外，如果应用程序变得那么大，Flash 真的是正确的技术吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-06T19:14:38.247

Flash IDE 中的编译器很慢。如果库中有很多必须重新导出的图像，我可以理解这种缓慢，但是编译器在仅编译代码时也莫名其妙地慢。

例如，我有一个超级基本的 Away3d 场景，需要 5 秒来编译（没有库资源）。完全相同的代码在不到一秒的时间内在 Flex 中编译。我不知道这两个编译器之间有什么不同，但是在 Flash IDE 中使用大量代码库进行任何项目都是非常痛苦的。随着项目的发展，您将不得不等待越来越长的时间。

如果您正在执行 3D 项目或需要大量代码编译的项目，我建议您在 Flex/Flash Builder 中执行仅 Actionscript 项目。也许 CS5 会有更好的编译器...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-23T09:01:21.700

您可能需要检查您的字符嵌入——如果您不小心点击了嵌入所有字符，它可能会嵌入 1000 个字符，这会显着降低您的发布速度

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T16:19:32.633

这完全取决于您的项目。我知道一些动画师使用 Flash 发布广播内容，通常需要很长时间才能发布。他们没有办法绕过它。否则，如果发布将在网络上查看的 SWF 需要数小时，那么您可能不会以正确的方式处理事情。

此外，一些会立即增加编译 SWF 所需时间的明显罪魁祸首是嵌入式视频和嵌入式声音。IDE 必须压缩输出的项目越多（这也包括图像），编译所需的时间越长。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-11T19:01:25.337

您无法使 Flash IDE 缓存嵌入式媒体（但如果您导入 PNG/GIF 并将压缩设置为库中的无损，则图像不会被重新编码）。但是，如果它是一个网络项目，您无论如何都应该从外部文件加载媒体，因此您不必在用户屏幕上显示任何内容之前预加载所有数据。您可以直接加载（甚至流式传输）媒体文件，也可以将它们嵌入到单独的 SWF 中并从那里加载，但我不推荐后者，因为它会增加不必要的复杂性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-16T15:10:46.823

当编译速度太慢时，我通常会剥离库 - 通过 URLRequest 读取加载图像（png、jpg）和声音。

通常真正减慢编译器速度的是导入 illustrator (ai) 文件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-22T23:25:05.210

如果您甚至愿意更改语言，则可以使用 Haxe。它编译为 SWF，并且编译速度非常快。在您有长达一小时的编译时间时更改为不同的语言可能不值得，但是当您开始下一个大型项目时请考虑一下。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-02T18:49:42.660

在“发布设置”>“Flash”>“as3”中禁用警告

# c# - AppDomains之间如何最好地进行通信？

> ID：314268
> 
> 赞同：39
> 
> 时间：2008-11-24T14:26:07.153
> 
> 标签：c#, .net, remoting, appdomain

我有一个应用程序需要在多个 AppDomain 之间发送大量消息。我知道我可以使用远程处理来实现这一点，但我也注意到存在跨域委托。有没有人看过这种问题？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-24T14:52:00.393

我在使用带有命名管道绑定的 WCF 方面取得了很好的成功。使用命名管道不会产生网络流量并使用二进制编码，因此它应该非常快，而不会牺牲在未来扩展场景中的分发能力。

编辑：请参阅[此处](https://stackoverflow.com/questions/50153/interprocess-communication-for-windows-in-c-net-20)以获取更多详细信息，包括指向实施示例的链接。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T15:27:52.600

跨域委托只允许使用零参数的 void 方法，而且它可能不是你想象的那样。它只是作为一个简单的回调用于从一个应用程序域到另一个应用程序域的通知目的几乎没有用，例如像 InitComplete() 这样的方法或其他方法。

远程处理是唯一的选择，无论您将其称为 WCF 还是其他任何名称、传递可序列化类型或使用 MBRO 类型 (MarshalByRefObjects)。这并不像你想象的那么难。

-Oisin

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-17T12:19:36.623

我刚刚发现您也可以使用 AppDomain.SetData 但这只是从主机域到子域的一种方式。

```
static void RunInChildDomain()
{
     AppDomain childDomain = AppDomain.CreateDomain("friendlyName");
     string parameterValue = "notmii";
     childDomain.SetData("parameter", parameterValue);
     childDomain.DoCallBack(PrintName);
}

static void PrintName()
{
     string Name = Convert.ToString(AppDomain.CurrentDomain.GetData("parameter"));
     Console.WriteLine(Name);
} 
```

您还可以使用 AppDomain.FirstChanceException 事件在子应用程序域和主机应用程序域之间创建异常驱动的通信 :)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-08-01T20:08:03.403

CallContext 允许在 AppDomain 之间传递数据：

```
 CallContext.LogicalSetData("Key", "My value");
   Console.WriteLine("{0} from {1}", CallContext.LogicalGetData("Key"),               
   AppDomain.CurrentDomain.FriendlyName);

   var appDomain = AppDomain.CreateDomain("Worker");
   appDomain.DoCallBack(() => Console.WriteLine("{0} from {1}", 
       CallContext.LogicalGetData("Key"), 
       AppDomain.CurrentDomain.FriendlyName));
   AppDomain.Unload(appDomain);

   CallContext.FreeNamedDataSlot("Key"); 
```

该代码使用 System.Runtime.Remoting.Messaging。我个人没有衡量这个解决方案的性能。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-24T14:30:49.657

这只是一个快速的想法，但我听说即使对于跨域通信**WCF**也是推荐的方法，当然从 .NET 3.0 开始。实际上这是有道理的，因为远程处理只是 WCF 包装的另一种技术。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-06-09T12:36:28.777

我想扩展 xOn 的答案。他建议使用 WCF 或 MarshalByRefObject，但考虑到问题是关于 AppDomain 之间的通信，而不是关于进程之间的通信，我认为 MBRO 方法的实现要简单得多，因此是正确的答案。

当我自己研究这个问题时，我一开始很难理解子 AppDomain 如何与父级通信，直到我意识到你可以将一个 MBRO 对象的句柄传递给子级，然后子级可以打开该句柄到与父级（或任何其他 AppDomain）进行通信。[我在这里](https://stackoverflow.com/questions/37464219/two-way-communication-between-appdomains-inside-of-iis-requests)发布了我自己的问题的解决方案。

后来我了解到，您可以定义一个接口，在一个复杂的类上实现该接口，然后只将一个句柄传递给该接口。这可以大大减少加载子 AppDomain 可能需要的程序集数量。

# java - SQLClientInfoException / Linux

> ID：314275
> 
> 赞同：0
> 
> 时间：2008-11-24T14:28:05.310
> 
> 标签：java, linux

我正在运行一个 java 程序，它建立与 SQL 数据库的数据库连接。它在 Mac OS X 上运行良好，但是当我尝试在 Linux 上运行相同的代码时，我在线程“main”java.lang.NoClassDefFoundError: java/sql/SQLClientInfoException 中得到一个异常。

我正在使用 jdk-1.6.0_02 - 如果我解压缩 src.zip，结果表明其中不包含 SQLClientInfoException.java。

此外，API 文档显示在 java.sql.Connection 中恰好有两种方法使用此异常。但是，如果我查看源代码中的这两种方法，它们似乎都抛出了更一般的 SQLException。

这是我的java版本中的错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T14:43:38.007

SQLClientInfoException 在 Java 1.6 中是新的，应该存在于 src.zip 中。我`jdk1.6.0_03`在 Windows中有一个，`jdk1.6.0_06`在 Linux 中有一个，并且该类都包含在两者中。尝试升级到最新版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T14:52:49.800

确保您实际上运行的是 sun JDK，而不是许多 linux 发行版上作为标准发布的 GCJ 版本。该版本有点过时并且容易出现像这样的奇怪错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:38:17.333

NoClassDefFoundError：“在编译当前执行的类时，搜索到的类定义存在，但无法再找到该定义。” （来自 API 文档）。

该类似乎是标准 jdk 发行版的一部分。您的路径中可能存在错误，或者程序中的某些内容被硬编码为未指向 Linux 上正确位置的路径。

# ms-access - Microsoft Access 为备注字段附加 Querydef

> ID：314277
> 
> 赞同：4
> 
> 时间：2008-11-24T14:28:36.977
> 
> 标签：ms-access

我收到一个 vba 错误 3271；无效的属性值。尝试在 querydef 中附加备注字段时会发生这种情况。关于如何解决这个问题的任何想法？

例子：

```
public sub TestMemoField
    Dim qdf As QueryDef
    Set qdf = CurrentDb.QueryDefs("AppendRecord")
    qdf.Parameters("@SomeBigText").value = string(1000,"A")
    qdf.Execute
end sub 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T15:32:14.633

显然，您的参数不能超过 255 个字符（[http://support.microsoft.com/kb/275116](http://support.microsoft.com/kb/275116)）。

可以使用记录集，或使用：

```
qdf.SQL="INSERT INTO Sometable (SomeField) Values('" & String(1000, "A") & "')" 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-25T02:46:32.743

嗯，你想做什么？为什么要使用参数？为什么不直接在代码中执行 SQL，如下所示：

```
Public Sub TestMemoField
  Dim strSQL As String

  strSQL = "UPDATE MyTable SET MyField='" & String(1000,"A") & "'"
  CurrentDb.Execute strSQL, dbFailOnError
End Sub 
```

我不在保存的查询中使用参数，*除非*我需要从表单上的控件中提取值以用于保存的查询。

现在，如果您的后端不是 Jet，或者如果您保存的查询的实际标准和结构存在某些问题，那么我的回答可能会不好，这使得使用保存的查询而不是简单地使用即时 SQL 很重要。但是您几乎没有提供任何信息（包括省略您正在执行的 querydef 的 SQL），因此很难提供任何有用的答案。

# jdbc - 如何在 jdbc 中设置 sybase 连接的程序名称？

> ID：314280
> 
> 赞同：1
> 
> 时间：2008-11-24T14:29:54.277
> 
> 标签：jdbc, connection, sybase

我可以用 C 做，也可以用 perl 做，但是我看不到如何使用 jdbc 在 sybase 连接上设置程序名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T22:50:03.390

我最终在这里找到了它：[http](http://www.sybase.com/detail?id=1009812) ://www.sybase.com/detail?id=1009812 “APPLICATIONNAME”是一个属性，您可以将属性列表传递给 connect() 函数。

# asp.net - 使用 ASP.NET 和 SQL Server 维护共享托管网站的最佳实践？

> ID：314290
> 
> 赞同：3
> 
> 时间：2008-11-24T14:33:57.327
> 
> 标签：asp.net, visual-studio, shared-hosting

在过去的几年里，我一直在与共享托管服务提供商合作开发 PHP/MySQL 网站。日常流程基本上是：

*   在 Eclipse 中开发，每个文件夹一个网站
*   通过 FileZilla 上传，每个文件夹一个网站
*   使用 PHPMyAdmin 创建和管理您的本地和在线数据库，并将数据从一个数据库传输到另一个数据库
*   为了备份在线数据库，我将数据库表转储到脚本中并在本地复制它们

**我现在想**在共享主机提供商上使用 ASP.NET 和 SQL Server 2008 构建网站，并且正在尝试进入这个新范例，希望你们中的一些人可以根据您的经验给我一些指导，并告诉我我没有做什么最佳：

*   我已经安装了 Visual Web Developer 2008 Express 和完整版的 Visual Studio 2008，它们似乎都是用于开发 ASP.NET 站点的全功能工具。**就共享主机提供商的网站而言，完整版可以做什么，而快递版不能做什么？**
*   我使用 FileZilla 上传我的网站，这似乎工作正常。**您是使用外部 FTP 程序上传网站还是使用上述 IDE 中的“发布”或“FTP 网站”？**
*   我安装了 SQL Server 2008 Management Studio，现在可以向我的在线 SQL Server 数据库发出 SQL 命令（虽然奇怪的是我在左侧列表中看不到我的数据库，但我仍然可以访问它，我认为这是一些权限问题我的提供商 www.domainbox.de，但该提供商告诉我改用他们的在线管理器，它被称为“ASP.NET 企业管理器”，非常简单，但至少有一个“查询框”允许我发送查询到我的数据库。）**这是 ASP.NET 托管程序的“ASP.NET 企业管理器”标准还是有其他更好的东西，例如您可以在网格中编辑数据的地方等？**我假设大多数提供商都可以使用 SQL Server Management Studio 管理在线 SQL Server 数据库，对吗？（我记得 2001 年在共享托管服务提供商处使用 Enterprise Manager 管理在线 SQL Server 2000 数据库，我需要 10 分钟才能看到左侧的数据库，因为它还列出了其他 800 个客户数据库——希望现在已经解决了）。
*   **如何将在线数据库中的数据备份到本地存储？**（目前我必须编写将我的数据输出为其他格式的代码，例如 XML 或 SQL 脚本）
*   在您对本地数据库进行大量结构和数据更改后，您**如何将这些更改和新数据传输到您的在线数据库？**（我必须安装 SSMS 工具 [ [http://www.ssmstoolspack.com]](http://www.ssmstoolspack.com])才能将我的数据转储到一个脚本中，以便我可以将其恢复到我的在线数据库中）。

所以，虽然我已经完成了大部分工作，但我觉得必须有更好的方法来解决这个问题，更好的提供程序，更好的工具等。**希望听到任何使用 ASP 的人的一些“最佳实践”建议。 NET、SQL Server 和共享主机。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T19:50:54.063

在大多数情况下，您现在所做的将适用于 asp.net 网站。

对于您的开发环境，我认为您不会因为使用 Visual Web Developer 2008 express 而受到限制。这是一个微软页面，它比较了 Visual Studio 2008 的每个版本，包括 Visual Web Developer 2008 Express：[Visual Studio 2008 产品比较](http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx)

对于通过网络部署您的网站，我通常会坚持手动部署。您可以在 Visual Studio 中使用一些自动化的东西，但您的部署往往会慢一些。编译您的应用程序后，它将删除目标网站中的每个文件，并从头开始上传所有文件（我认为是未压缩的）。发生这种情况时，您的整个网站都将关闭。当您手动部署时，您可以仅上传更改的文件，或者以压缩格式上传所有内容。

关于 SQL 服务器，许多共享托管服务会让您连接某种本地 SQL 管理工具。但是，以这种方式连接通常会使用大量带宽，因此他们会降低这种方式的允许带宽。这可能是您之前看到的性能问题。如果你能过得去，我会在你的大部分工作中使用他们托管的 SQL 工具，然后使用管理工作室来处理它无法处理的任何事情。

为了备份您的 SQL 服务器，如果您的主机没有办法让您执行自动备份，那么您将不得不自己做一些事情。我将首先检查它们是否允许您至少运行 SQL 备份命令。这将在本地数据库服务器上生成数据库的 .bak 文件。大多数地方都会与您合作，因为许多客户都需要这个。

为了将更改应用到数据库，最好的办法是将所有更改编写到一个 sql 脚本中，然后使用远程 SQL 管理工具运行它。这些并不难编写，并且有一些工具可以帮助您。我个人喜欢使用 Visio。它让我比较两个数据库（本地和远程），然后生成一个脚本以应用于远程数据库的所有更改。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T04:26:39.767

就 VS Express 与 Standard 的功能而言，Standard 仍然是更好的工具。它为您提供更丰富的调试体验、对解决方案/项目依赖项的更广泛支持等。

即使在进行共享托管 b/c 时，这些事情仍然很重要，您绝对需要调试您的应用程序（客户端和服务器端）。您可以使用 Express 充分地做到这一点，但有一些注意事项（不能附加到任意进程，客户端 javascript 调试很痛苦），标准使这更容易。

对于发布/部署——我会推荐“ [Web Depoyment Projects](http://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en) ”——一个可以从 MS 下载的 MSBuild 扩展。这为您提供了很多可自定义的方式来构建和部署您的网站 - 这可以包括将其发送到 FTP 站点。如果您曾经使用过 MSBuild 并且喜欢它 - Web 部署项目是使用 ASP.NET 网站扩展您的构建过程的最简单的钩子。

# java - 如何（简单地）从 java 生成 POST http 请求来进行文件上传

> ID：314300
> 
> 赞同：3
> 
> 时间：2008-11-24T14:37:28.177
> 
> 标签：java, applet, http-headers, network-protocols

我想使用 POST http 事件从 java 应用程序/小程序上传文件。我想避免使用 SE 中不包含的任何库，除非没有其他（可行的）选项。
到目前为止，我只提出了非常简单的解决方案。
- 创建字符串（缓冲区）并用兼容的标头（[http://www.ietf.org/rfc/rfc1867.txt](http://www.ietf.org/rfc/rfc1867.txt)）填充它
- 打开与服务器 URL.openConnection() 的连接并将此文件的内容写入 OutputStream。
我还需要手动将二进制文件转换为 POST 事件。

我希望有一些更好，更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T15:34:40.837

您需要使用`java.net.URL`和`java.net.URLConnection`类。

[http://java.sun.com/docs/books/tutorial/networking/urls/readingWriting.html](http://java.sun.com/docs/books/tutorial/networking/urls/readingWriting.html)有一些很好的例子

这是一些快速而讨厌的代码：

```
public void post(String url) throws Exception {
    URL u = new URL(url);
    URLConnection c = u.openConnection();

    c.setDoOutput(true);
    if (c instanceof HttpURLConnection) {
        ((HttpURLConnection)c).setRequestMethod("POST");
    }

    OutputStreamWriter out = new OutputStreamWriter(
        c.getOutputStream());

    // output your data here

    out.close();

    BufferedReader in = new BufferedReader(
                new InputStreamReader(
                    c.getInputStream()));

    String s = null;
    while ((s = in.readLine()) != null) {
        System.out.println(s);
    }
    in.close();
} 
```

请注意，在将 POST 数据写入连接之前，您可能仍需要 urlencode() 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T16:11:40.717

您需要了解在较新版本的 HTTP 中使用的分块编码。Apache HttpClient 库是一个很好的学习参考实现。

# javascript - 动态绘制 HTML 表格时如何“暂停”页面刷新

> ID：314301
> 
> 赞同：1
> 
> 时间：2008-11-24T14:38:01.887
> 
> 标签：javascript, html

我正在使用 Javascript 动态创建一个大表。我已经意识到添加新行所需的时间随着行数的增加而呈指数增长。

我怀疑页面在每行的每个循环中都会刷新（我还在每个单元格上添加文本类型的输入元素）

有没有办法在我完成整个表格之前停止页面“刷新”？

关于如何做到这一点或绕过它的任何建议？

* * *

我已经尝试了上面的所有建议，但我仍然遇到性能瓶颈。

我尝试逐行分析，并且我注意到 document.getElementById() 是当表非常大时需要花费大量时间执行的行之一。我正在使用 getElementById() 动态访问加载在表格每个单元格上的文本类型的 HTML 输入。

关于我应该使用哪种 DOM 方法而不是 getElementById() 的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T14:43:41.347

您可以创建表格对象而不将其添加到文档树中，添加所有行，然后将表格对象附加到文档树中。

```
var theTable = document.createElement("table");
// ... 
// add all the rows to theTable
// ...
document.body.appendChild(theTable); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T14:43:05.403

也许将您的表格构建为一大串 HTML，然后在完成后将容器 div 的 .innerHTML 设置为该字符串？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T15:05:03.597

您在创建表格时是否尝试过 <tbody> 标记？浏览器可能会对其进行优化，并且在填充表格时不会“刷新”表格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T08:40:16.383

如果每行的单元格大小相同，那么您将能够指定样式`table-layout:fixed`- 这将为您带来最大的性能提升，因为每次添加一行时浏览器都不必重新计算单元格大小

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T13:00:35.253

使用表格 DOM 循环遍历行和单元格以填充它们，而不是使用 document.getElementByID() 来获取每个单独的单元格。

```
E.g.
thisTable = document.getElementByID('mytable');//get the table
oneRow = thisTable.rows[0].cells; //for instance the first row
for (var colCount = 0; colCount <totalCols; colCount ++)
{
   oneCell =oneRow[colCount];
   oneCell.childNodes[0].value = 'test';//if your cell contains an input element
   oneCell.innerHTML = 'test'; // simply write on the cell directly
} 
```

希望对其他人有所帮助...干杯。

# java - 以编程方式将 Oracle BPEL 任务标记为完成

> ID：314305
> 
> 赞同：0
> 
> 时间：2008-11-24T14:38:32.323
> 
> 标签：java, oracle, bpel

我正在使用 Oracle BPEL 流程管理器并将任务分配给一组用户。我尝试使用 Java 类 oracle.bpel.services.workflow.task.ITaskService.updateTaskOutcome() 将其标记为已批准。如果任务分配给单个用户，则此方法有效，但如果任务分配给一组用户，我会收到有关未获取任务的错误消息。

如果我使用 oracle.bpel.services.workflow.task.ITaskService.acquireTask() 获取任务，则在尝试将其标记为已批准时收到错误消息：“该任务已被其他用户获取”。

任何人都可以指出以编程方式更改*分配给组*的 Oracle BPEL 任务状态的示例代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-13T04:33:34.710

使用`updateTaskOutcomes()`方法而不是`updateTaskOutcome()`分配给多个用户时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-28T14:21:28.577

您的第一个问题似乎很明显，您无法批准分配给组的任务而不先获得。否则，该组的哪个成员批准了该任务？

您的第二个问题是您正在与一个用户一起获取任务并尝试与另一个用户一起批准它。

要真正找到问题出在哪里，您可以获取任务，然后转到元数据库并搜索谁获得了任务。我想这会让你更好地了解实际发生的事情。

# sql - 如何加快 SQL 中的连接更新？我的陈述似乎无限期地运行

> ID：314307
> 
> 赞同：2
> 
> 时间：2008-11-24T14:38:53.977
> 
> 标签：sql, oracle, performance

我有两个表：一个源表和一个目标表。目标表将具有源表列的子集。我需要通过基于另一列加入源表来更新目标表中的单个列。更新声明如下：

```
UPDATE target_table tt
SET special_id = ( SELECT source_special_id
                   FROM source_table st
                   WHERE tt.another_id = st.another_id ) 
```

出于某种原因，这个声明似乎无限期地运行。内部选择在自行执行时几乎立即发生。该表大约有 50,000 条记录，并且托管在一台功能强大的机器上（资源不是问题）。

我这样做正确吗？上述任何原因不能及时奏效？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T14:44:32.670

您的初始查询对外部表中的每一行执行一次内部子查询。看看 Oracle 是否更喜欢这个：

```
UPDATE target_table 
SET special_id = st.source_special_id
FROM 
    target_table tt
    INNER JOIN
    source_table st
        WHERE tt.another_id = st.another_id 
```

（在更正发布的查询后编辑）

**添加：** 如果连接语法在 Oracle 上不起作用，如何：

```
UPDATE target_table 
SET special_id = st.source_special_id
FROM 
    target_table tt, source_table st
WHERE tt.another_id = st.another_id 
```

重点是连接这两个表，而不是使用您当前使用的外部查询语法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T15:15:51.657

source_table(another_id) 上是否有索引？如果不是，source_table 将对 target_table 中的每一行进行一次完全扫描。如果 target_table 很大，这将需要一些时间。

source_table 中某些 target_table 行是否可能不匹配？如果是这样，您的更新会将这些行的 special_id 设置为 null。如果您想避免这种情况，请执行以下操作：

```
UPDATE target_table tt
SET special_id = ( SELECT source_special_id
                   FROM source_table st
                   WHERE tt.another_id = st.another_id )
WHERE EXISTS( SELECT NULL
              FROM source_table st
              WHERE tt.another_id = st.another_id ); 
```

**如果**target_table.another_id 被声明为引用 source_table.another_id 的外键（在这种情况下不太可能），这将起作用：

```
UPDATE
  ( SELECT tt.primary_key, tt.special_id, st.source_special_id
    FROM   tatget_table tt
    JOIN   source_table st ON st.another_id = tt.another_id
  )
SET special_id = source_special_id; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T18:26:59.303

你真的确定它正在运行吗？

你有没有寻找阻塞锁？无限期是很长的时间，这通常只能通过停止执行来实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T14:43:41.457

**更新：**好的，现在查询已经修复了——我已经做了很多次了，在超过 50K 行的未索引表上，它在 Oracle 10g 和 9i 中运行良好。所以这里发生了其他事情；是的，您正在调用嵌套循环，但不，它不应该永远运行，即便如此。这些表的主键是什么？您是否有第二个表中的多行与第一个表的同一行匹配？您可能会尝试一遍又一遍地重写整个表格，从而使锁定系统陷入困境。

* * *

*原始回复*

该语句实际上没有意义——您是在告诉它将所有 id 匹配的行更新为相同的 id（意思是，没有发生任何变化！）。

我想真实的陈述看起来有点不同？

还请提供表架构信息（2 个表的主键、任何可用索引等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T14:44:45.073

不确定 Oracle 有什么可用的，但 MS Sql Server 有一个调整顾问，您可以将查询输入它，它会给出添加索引等的建议......我假设 Oracle 有类似的东西。

这将是查明问题的最快方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T15:13:39.867

我不了解 Oracle，但 MSSQLServer 优化器可以为您将子查询转换为联接。

听起来您可能正在对短期或新创建的表进行数据导入。很容易忽略索引这些类型的表。我会确保在 sourcetable.anotherid 上有一个索引**-**或者在 sourcetable.anotherid、sourcetable.specialid 上有一个覆盖索引（顺序很重要，anotherid 应该是第一位的）。

在诸如此类的情况下（查询意外运行超过 1 秒）。最好弄清楚您的环境如何提供查询计划。检查该计划，问题就会变得清晰。

你看，没有“优化的 sql 代码”这样的东西。Sql 代码永远不会执行 - 从代码生成查询计划，然后执行这些计划。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T10:24:50.043

检查表格上的统计信息是否是最新的 -[请参阅此问题](https://stackoverflow.com/questions/120504/optimising-a-select-query-that-runs-slow-on-oracle-which-runs-quickly-on-sql-se#121161)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-17T16:06:33.267

我遇到了同样的问题，并且在 Oracle 11g 中尝试 Codewerks 的答案时出现“SQL 命令未正确结束”。一些谷歌搜索出现了[Oracle`MERGE`语句](http://psoug.org/reference/merge.html)，我将其改编如下：

```
MERGE INTO target_table tt
USING source_table st
ON (tt.another_id = st.another_id)
WHEN MATCHED THEN
  UPDATE SET tt.special_id = st.special_id; 
```

如果您不确定 的所有值`another_id`都会在其中，`source_table`那么您可以使用该`WHEN NOT MATCHED THEN`子句来处理这种情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-23T16:21:17.347

如果您在加入“another_id”时有约束让 Oracle 知道存在 1-1 关系，我认为这可能会很好：

```
UPDATE ( SELECT  tt.rowid tt_rowid, tt.another_id, tt.special_id, st.source_special_id
         FROM    target_table tt, source_table st
         WHERE   tt.another_id = st.other_id
         ORDER BY tt.rowid )                   
SET special_id = source_special_id 
```

`ROWID`当您使用连接更新和可更新视图时，排序依据很重要。

# java - 懒惰地将 JasperReports .jrxml 编译为 .jasper

> ID：314313
> 
> 赞同：2
> 
> 时间：2008-11-24T14:41:11.460
> 
> 标签：java, spring, jasper-reports

我将 Jasper 报告与Spring 框架提供的[JasperReportsMultiFormatView类一起使用。](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/web/servlet/view/jasperreports/JasperReportsMultiFormatView.html)此类负责在创建 Spring 应用程序上下文时将源 .jrxml 文件编译为已编译的 .jasper 格式。

但是，这个编译过程确实会减慢应用程序的启动时间。报告是否可以延迟编译而不是在启动时编译，即报告仅在第一次被请求时编译？

如果这是不可能的，我将欢迎有关如何减少/消除报告编译时间的替代建议。当然，我可以要求编译的报告必须与 .jrxml 文件一起检查到 SVN 中，但这只是时间问题，有人（很可能是我）忘记了。

干杯，唐

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-30T02:27:18.947

我和你一样，从 Jasper Reports 的 Spring 辅助类开始，但很快就放弃了它们，因为它们过于粗粒度和不灵活，这对 Spring 来说是不寻常的。就像他们是事后才添加的。

我对它们的最大问题是，一旦它们被编译，它需要应用服务器反弹才能放入新版本。就我而言，我正在寻求一个解决方案，我可以在磁盘上更改它们并重新编译，就像 JSP 的正常工作方式一样（如果您不关闭此功能，许多生产站点都会这样做）。

或者，我希望能够将 jrxml 文件存储在数据库中或远程运行报告（例如通过 JasperServer Web 服务接口）。Spring 类使实现这些功能几乎不可能。

所以我给你的建议是：自己动手。不过，在此过程中存在一些问题，我将与您分享以最大程度地减少痛苦。其中一些事情在文档中并不明显。

您需要的第一件事是 jasper 报告编译器。这负责将 jrxml 文件编译成 JasperDesign 对象。有几种实现方式，但您想要的是 JRJdtCompiler。您可以在 Spring 应用程序上下文中实例化和注入它。避免使用 beanshell 编译器之类的其他编译器，因为将报告作为大型 beanshell 脚本运行并不是特别快或高效（在我知道更好之前，我发现了这一点很困难）。

您需要包含 JRJdtCompiler 的 jar 文件。我认为完整的 Jasper Reports dist 包括这个 jar。它是一个日食产品。

您可以将 JasperDesign 存储在您喜欢的任何位置（HttpSession、servlet 上下文或其他）。fillReport() 方法是您感兴趣的主要方法。它创建一个 JasperPrint 对象，它是运行报告的一个实例。参数只是作为 Map 传入。

现在要以 HTML、PDF 等格式创建 versino，您需要将其导出。您可以使用 JRHtmlExporter 和 JRPdfExporter 之类的类来执行此操作。它们需要某些参数。棘手的是 HTML 导出器，因为 HTML 显然不包含图像。Jasper 包含一个 ImageServlet 类，该类从会话（JRHtmlExporter 放置它们的位置）中获取这些内容，但是您必须正确配置 HTML 导出器和图像 servlet，并且很难判断哪里出错了。

我不记得它的细节，但在[Jasper Reports Definitive Guide](http://www.jaspersoft.com/documentation5.html)中有一个所有这些的例子，如果你在任何时候都花在这个产品上，我强烈建议你去看看。它相当便宜，50美元。您也可以获得年度订阅，但在我看到它的 18 个多月里，我没有看到任何变化。如果您需要，只需在新版本发布时购买（您可能不会）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T19:02:42.120

报告在第一次运行时编译，在 AbstractJasperReportsView protected final JasperReport loadReport(Resource resource) 方法中放置一个断点来确认这一点。

但是上面的帖子是正确的，如果您想提供任何特定的编译过程，您需要扩展 JasperReportsMultiFormatView。

动态编译的一个很好的例子在这里：http: [//javanetspeed.blogspot.com/2013/01/jasper-ireport-with-java-spring-and.html](http://javanetspeed.blogspot.com/2013/01/jasper-ireport-with-java-spring-and.html)

```
import net.sf.jasperreports.engine.JasperReport;
import org.apache.log4j.Logger;
import org.springframework.web.servlet.view.jasperreports.JasperReportsMultiFormatView;

public class DynamicJasperReportsMultiFormatView extends JasperReportsMultiFormatView {

private static final Logger LOG = Logger.getLogger(DynamicJasperReportsMultiFormatView.class);

/**
 * The JasperReport that is used to render the view.
 */
private JasperReport jasperReport;

/**
 * The last modified time of the jrxml resource file, used to force compilation.
 */
private long jrxmlTimestamp;

@Override
protected void onInit() {
    jasperReport = super.getReport();

    try {
        String url = getUrl();
        if (url != null) {
            jrxmlTimestamp = getApplicationContext().getResource(url).getFile().lastModified();
        }
    } catch (Exception e) {
        e = null;
    }
}

@Override
protected JasperReport getReport() {
    if (this.isDirty()) {
        LOG.info("Forcing recompilation of jasper report as the jrxml has changed");
        this.jasperReport = this.loadReport();
    }
    return this.jasperReport;
}

/**
 * Determines if the jrxml file is dirty by checking its timestamp.
 *
 * @return true to force recompilation because the report xml has changed, false otherwise
 */
private boolean isDirty() {
    long curTimestamp = 0L;
    try {
        String url = getUrl();
        if (url != null) {
            curTimestamp = getApplicationContext().getResource(url).getFile().lastModified();
            if (curTimestamp > jrxmlTimestamp) {
                jrxmlTimestamp = curTimestamp;
                return true;
            }
        }
    } catch (Exception e) {
        e = null;
    }
    return false;
} 
```

}

# sql-server-2005 - 在 SQL Server 表之间高效移动大量数据？

> ID：314314
> 
> 赞同：6
> 
> 时间：2008-11-24T14:41:15.703
> 
> 标签：sql-server-2005

我在 SQL Server 中有一个相当大（数 GB）的数据表，我希望将其移动到同一服务器上另一个数据库中的表中。

表的布局相同。

这样做最有效的方法是什么？

这是一次性操作，因此不需要自动化。

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T14:47:16.080

如果是一次性操作，为什么这么在意*顶级*效率？

```
SELECT * INTO OtherDatabase..NewTable FROM ThisDatabase..OldTable 
```

或者

```
INSERT OtherDatabase..NewTable
SELECT * FROM ThisDatabase..OldTable 
```

……让它通宵运行。我敢说，在同一台服务器上使用 SELECT/INSERT INTO 与您所能获得的最佳效率相差不远。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T14:52:50.813

或者，您可以使用 Microsoft SQL Server Management Studio 中“管理”下的“SQL 导入和导出向导”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T15:08:11.390

我会接受托马拉克的回答。

在执行“选择进入”以停止日志文件爆炸之前，您可能希望暂时将目标数据库置于批量日志恢复模式...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T15:09:56.050

如果是 SQL Server 7 或 2000，请查看数据转换服务 (DTS)。对于 SQL 2005 和 2008，请查看 SQL Server Integration Services (SSIS)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T15:16:54.400

绝对将目标数据库置于批量记录模式。这将最低限度地记录操作并加快速度。

# unit-testing - 为什么我要编写一个假类并对其进行单元测试？

> ID：314317
> 
> 赞同：11
> 
> 时间：2008-11-24T14:42:14.423
> 
> 标签：unit-testing, mocking

我了解需要测试具有逻辑的类（例如，可以计算折扣的类），您可以在其中测试*实际*类。

但我刚刚开始为一个将充当存储库（从数据库获取对象）的项目编写单元测试。我发现自己正在编写一个实现`ISomethingRepository`接口的“假”存储库。它在内部使用一个`Dictionary<Guid, Something>`用于存储。它实现了接口的`Add(Something)`和`GetById(Guid)`方法。

我为什么要写这个？我写的东西在部署时不会被软件实际使用，对吧？我真的看不出这个练习的价值。

我还得到了使用模拟对象的建议，我可以提前设置它来满足某些期望。这对我来说似乎更没有意义：当然测试会成功，我已经模拟/伪造它成功了！而且我仍然不确定实际软件在连接到数据库时是否会正常运行......

*使困惑...*

有人可以指出正确的方向来帮助我理解这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T14:48:19.497

您不是在测试您的模拟对象，而是在与它交互的其他一些类。因此，您可以例如测试控制器是否将保存方法调用转发到您的假存储库。如果你在“测试你的假对象”，那就有问题了

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T14:55:32.680

不要测试模拟类。使用模拟类测试生产类。

*测试支持类*的全部意义在于拥有可以预测其行为的东西。如果您需要测试*测试支持类*以预测其行为，则存在问题。

在您在评论中链接的假数据库文章中，作者需要对他的假数据库进行单元测试，因为它是他的产品（至少在文章的上下文中）。

编辑：更新的条款更加一致。

*   Mock - 通过模拟框架创建
*   假 - 手动创建，实际上可能会起作用。
*   测试支持 - 模拟、伪造、存根和所有其他。不是生产。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T14:47:58.170

模拟/存根对象的目的不是要测试，*而是*要测试您要测试的单元，它是允许您在不需要*其他*类的情况下测试该单元。

基本上，您可以一次测试一个类，而不必测试它们也依赖的所有类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T14:48:54.067

谁在看守望者？

有趣的是，例如，如果模拟实现为极端情况抛出特定异常，因此您知道使用或依赖 IRepositorySomething 的类可以处理现实生活中抛出的异常。您无法使用测试数据库轻松生成其中一些异常。

您不使用单元测试来测试 Mock 对象，而是使用它来测试依赖它的类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T15:22:38.257

您不应该测试模拟类。

您通常做的是：为您正在测试的类与之交互的所有类创建模拟类。

假设您正在测试一个名为**Bicycle**的类，它接收 Wheel、Saddle、HandleBar 等类的构造函数对象。

然后在你想要测试的 Bike 类中测试它的方法**GetWeight**，它可能会遍历每个部分并调用它们的属性/方法 Weight，然后返回总数。

你做什么：

*   你为每个部分（车轮、鞍座等）编写一个模拟类，它只是实现了重量位
*   然后你将那些模拟类传递给自行车
*   在 Bicycle 类上测试**GetWeight**方法

这样，您可以专注于测试 Bicycle 类上的**GetWeight**，以独立于其他类的方式（比如它们尚未实现，不确定等）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T13:18:20.247

[您可以使用工具（如 Rhino 或Typemock](http://www.typemock.com/)）来模拟它，而不是自己编写假类。这比自己编写所有的模拟要容易得多。就像其他人说的那样，没有必要测试假代码，如果你使用该工具，那就没有代码了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-30T22:48:15.050

实际上，我发现我们在存储库实现测试中使用的模拟类有两种用途。

首先是测试使用您提到的“ISomethingRepository”等效实现的服务。但是，我们的存储库实现是由工厂创建的。这意味着我们确实针对“ISomethingRepository”编写测试，而不是直接针对“MockSomethingRepository”。通过针对接口进行测试，我们可以轻松断言我们测试的代码覆盖率覆盖了 100% 的接口。代码审查提供了对新接口成员进行测试的简单验证。即使开发人员针对工厂返回的模拟运行，构建服务器也有不同的配置来测试工厂在夜间构建中返回的具体实现。它在测试覆盖率和本地性能方面提供了两全其美的效果。

第二种用途是我很惊讶没有其他人提到过的用途。我的团队负责中间层。我们的网络开发人员负责网络产品的前端。通过构建模拟存储库实现，不存在在前端工作开始之前等待数据库建模和实现的人为障碍。可以编写基于 mock 构建的视图，以提供最少量的“真实”数据，以满足 Web 开发人员的期望。例如，可以提供数据以包含最小和最大长度的字符串数据，以验证两者都不会破坏它们的实现等。

由于我们使用的工厂与返回哪个“ISomethingRepository”有关，因此我们有本地测试配置、构建测试配置、生产配置等。我们有意确保项目中的任何团队都没有不合理的等待时间，因为另一个团队的实施时间。最大的等待时间仍然由开发团队提供，但是我们能够以比前端开发更快的速度来开发我们的领域对象、存储库和服务。

当然，YMMV。;-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T14:43:59.817

您编写称为 Stub 或 Mock 对象的“假”类，因为您想以简单的方式测试实现而不测试真正的具体类。目的是通过仅测试接口（或抽象类）来简化测试。

在您的示例中，您正在测试具有字典的内容。它可能由数据库真实填充，或者背后有很多逻辑。在您的“假”对象中，您可以通过使所有数据保持不变来简化一切。这样，您只测试接口的行为，而不是具体对象的构建方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-17T07:56:34.250

请查看以下文章以获得对此的一个很好的解释：

[https://web.archive.org/web/20110316193229/http://msdn.microsoft.com/en-us/magazine/cc163358.aspx](https://web.archive.org/web/20110316193229/http://msdn.microsoft.com/en-us/magazine/cc163358.aspx)

基本上，如果你写了一个假对象，结果证明它相当复杂，有时值得对假对象进行单元测试，以确保它按预期工作。

由于存储库可能很复杂，因此为其编写单元测试通常是有意义的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-06T16:53:45.607

通常不需要在数据访问层中运行经典的单元测试。也许您可以使用单元测试框架的功能为您的数据访问类编写集成式单元测试，即集成测试（= 将您的数据访问层代码与数据库集成）。

例如，在 Spring 项目中，您可以使用 Spring Testcontext 在单元测试中启动 Spring 上下文，然后连接到真实数据库并测试查询是否返回正确的结果。您可能需要一个用于单元测试的自己的数据库，或者您可以将它们与开发人员数据库连接起来。

# cocoa - NSTableView - NSButtonCell 数据源类型？

> ID：314318
> 
> 赞同：0
> 
> 时间：2008-11-24T14:42:16.247
> 
> 标签：cocoa, macos

我有一个带有复选框样式单元格的表格，我不知道如何让这些按钮获得它们应该具有的标题。数据源应该是字符串数组吗？字典数组（字符串/布尔值）？NSButtonCells 数组？这些似乎都不起作用=/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T16:37:33.723

NSButtonCell 使用整数值（作为 NSNumbers）作为其数据源：

```
NSMixedState = -1,
NSOffState   = 0,
NSOnState    = 1 
```

当然，这对您的标题没有帮助，您必须单独设置。如果你使用绑定，NSButtonCell 定义了一个`title`绑定，你可以绑定到一个字符串数组。否则，您可以使用 NSTableView 委托方法`- (void)tableView:(NSTableView *)aTableView willDisplayCell:(id)aCell forTableColumn:(NSTableColumn *)aTableColumn row:(NSInteger)rowIndex`为每一行设置标题。

# unix - 什么是 Solaris 等价于 BSD 的“tail -n100”？

> ID：314321
> 
> 赞同：10
> 
> 时间：2008-11-24T14:42:53.437
> 
> 标签：unix, solaris, bsd, tail

我已经查过一千遍了，但我总是忘记它，所以，永远在这里：

Solaris 对`tail`.

我如何做相当于 BSD 的？`tail -n*N*`

我想要的是tail输入的最后N行。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T14:48:20.930

只需删除“n”

```
tail -100 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T14:54:16.660

或者您可以使用：

```
/usr/xpg4/bin/tail 
```

它的行为确实像你想要的（）。`tail -n*N*`

xpg4 = Xopen 可移植性指南第 4 期，包含严格符合多个 POSIX 和其他标准的二进制文件。与前者的区别通常是支持的选项和行为的细节。

根据您的发行版，还有 /usr/xpg6/bin、/usr/openwin/bin（OpenWindows 命令）、/usr/dt/bin（CDE 桌面命令）、/usr/sfw/bin（Solaris 免费软件）和各种其他。

例如，Solaris Express 正在引入 /usr/gnu/bin 来为 Gnu 二进制文件提供自定义扩展和特性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-17T18:06:11.830

`tail -n 10`for 脚本的跨平台变体：

```
sed -e :a -e '$q;N;11,$D;ba' file 
```

这对于 Linux 和 Solaris 也是一样的。

# visual-studio - 摆脱“当前位置没有可用的源代码”。

> ID：314329
> 
> 赞同：40
> 
> 时间：2008-11-24T14:44:03.700
> 
> 标签：visual-studio, debugging, message, debug-symbols, step-into

好吧，这是我自己的错，但我似乎无法自救。

每当我尝试进入一个具有调用 .NET 代码的赋值字段的类时，我都会看到一个对话框，其中包含文本“当前位置没有可用的源代码。”：

![错误信息截图](https://i.stack.imgur.com/3pfTr.png)

例如，进入以下类的构造函数会给我上面的消息：

```
public class Test
{
    private Stack<String> _Dummy = new Stack<String>();
    public Test() { }
} 
```

我认为这是因为在某些时候我摆弄了符号服务器的设置，但无论我现在摆弄什么，我似乎都无法摆脱该消息。

我的愚蠢在哪里忘记了它做了什么？

* * *

[我目前的选择](https://stackoverflow.com/questions/4649093/visual-studio-2010-debugger-steps-over-methods-and-doesnt-stop-at-breakpoints/4649220#4649220)总结：

*   []启用地址级调试
*   [x] 仅启用我的代码（仅限托管）
*   [] 启用 .NET 框架源单步执行
*   []启用源服务器支持
*   符号文件 .pdb 位置 - 空
*   将符号服务器中的符号缓存到此目录：C:\temp（空）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-03-06T13:50:44.140

查看是否意外排除了某些源文件。执行解决方案的属性并查看 Common Properties 下的 Debug Source Files 部分。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-11-20T12:58:48.170

在解决方案资源管理器中，检查*Common Properties*和*Debug Source Files*下的解决方案属性页。如果您看到“不要查找这些源文件：”下列出的程序集，请将其删除，问题应该会消失。

### 打开解决方案属性页

![在 Visual Studio 的解决方案资源管理器中右键单击解决方案的屏幕截图](https://i.stack.imgur.com/vhQsp.png)

### 勾选“不要查找这些源文件”

![Visual Studio 解决方案中解决方案属性页的屏幕截图](https://i.stack.imgur.com/wbgfl.png)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-08-18T09:22:15.893

如果您不想调试 .NET 程序集，避免“当前位置没有可用源”问题的快速解决方法是取消选中“工具 -> 选项 -> 调试”下的“要求源文件与原始版本完全匹配”复选框-> 一般

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-11T19:47:40.500

这是我为解决这个问题所做的。首先，停止调试并在 VS 中打开您的解决方案。接下来，确保您的解决方案配置设置为调试而不是发布。然后简单地进行重建（不是构建，重建）。下次启动调试器时，它应该可以正常工作，并且您不应该收到该错误消息。

希望这可以帮助！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-04-15T18:31:52.177

如果您不希望出现这个烦人的标签，您可以尝试我创建的这个插件：http: [//erwinmayer.com/labs/visual-studio-2010-extension-disable-no-source-available-tab /](http://erwinmayer.com/labs/visual-studio-2010-extension-disable-no-source-available-tab/)

它可以直接在 Visual Studio Gallery 上下载：http: [//visualstudiogallery.msdn.microsoft.com/en-us/fdbb2036-471e-40a7-b20e-31f8fd5578fa](http://visualstudiogallery.msdn.microsoft.com/en-us/fdbb2036-471e-40a7-b20e-31f8fd5578fa)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T14:50:48.243

检查您的项目是否有项目引用，而不是 DLL 引用！如果存在 DLL 引用，则引用的项目将无法识别您的更改，并且您将收到与您类似的错误消息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-08-24T11:21:54.727

这个错误也让我发疯了。我正在使用“AjaxControlToolkit”，并使用“添加引用”将它引用到我的项目中。

我删除了“AjaxControlToolkit”引用并在“添加现有项目”中添加了相同的引用，之后我完全没有问题......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-25T07:36:49.783

我在一个非托管 C++ 程序中遇到了同样的问题：当调试器`main`运行时，它总是显示“没有可用的源代码”，有趣的是，这个文件中的其他函数显示没有问题。在这种情况下，问题是我在堆栈上分配了太多数据。减少它后，调试器开始没有问题地工作。

它在 Visual Studio 2010 中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-27T18:41:40.097

一种也适用于 Visual Studio 速成版（例如，Visual Basic 2005 速成版）的方法是重命名`.suo`文件。它与解决方案文件位于同一文件夹中，`.sln`. 在重命名文件之前退出 Visual Studio。

![突出显示 .suo 文件的 Windows 资源管理器的屏幕截图](https://i.stack.imgur.com/62yPY.png)

该`.suo`文件包含非关键设置，例如窗口位置等。但是，它还包含所有断点，这就是为什么重命名它可能比删除它更好，以防此操作后悔。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-29T14:34:05.043

这就是我解决它的方法。

右键单击您的项目-> 属性-> 编译-> 高级编译选项...

然后从下拉菜单中将“生成调试信息”设置为“完整”。

希望有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-01-05T16:24:11.270

这对我有用：

1.  检查引用的 *.DLL 的属性页上的“启用非托管代码调试”
2.  重新编译引用的 *.DLL
3.  删除并重新将引用的 *.DLL 添加到您的项目中

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-10T00:28:34.497

您是否尝试过构建该页面？我遇到了与 AjaxControlToolkit 类似的问题：Modal Popup Extender。[在我给它 CSS 和ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)控件之前它没有显示。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-16T18:41:57.483

我出于某种原因禁用了`Common Language Runtime Exceptions`VS 2017 中的所有功能。

要解决此问题，请打开`Exception Settings`Debug > Windows > Exception Settings 并在`Exception Settings`窗口中选中 Common Language Runtime Exceptions 复选框

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-14T15:00:51.987

我遇到了同样的问题，它告诉我错误出在 AjaxControlToolkit 上，但问题出在我的 HTML 语法中，尤其是在 div 标记中，我只放置了关闭标记 '' 而没有开始标记

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-11-09T08:48:25.353

由于测试项目和主要项目的框架版本之间存在差异，我遇到了这个问题。升级主项目框架版本时，一定不要忘记升级测试项目。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-13T03:34:12.237

我在 VS 2017 C++ 中遇到了这个问题

**TLDR**：它正在访问超出限制的数据

该程序在调试模式下完成并显示以下消息：`wntdll.pdb not loaded`

修复后[`this answer`](https://stackoverflow.com/a/53434844/453348)开始显示消息：`There is no source code available for the current location`

但是也有一条消息弹出说：`app.exe has triggered a breakpoint`，但是断点不在我的源代码中，而是在VS在调试模式下生成的源代码中，`Right click`在源代码中->`Go to Disassembly`并且断点是`int 3`指令

最后它只是一个堆栈溢出，因为代码访问数据超出了限制，我只是修复了代码并且消息消失了

我猜 VS 没有显示关于访问超出限制的数据的错误，因为我使用的是 Winapi 函数[`GetEnvironmentStrings()`](https://docs.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getenvironmentstrings)并且在网站上说：`Treat this memory as read-only; do not modify it directly`我正在修改它:)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2015-02-12T15:45:03.357

我有同样的问题，我以这种方式解决了它（Visual Studio 2008）：

“Formato de la informationacion de depuracion”到“Base de datos de programa (/Zi)”

![在此处输入图像描述](https://i.stack.imgur.com/EDQK2.png)

# java - 哪个是在 ThreadLocal 实例上强制 GC 的更好方法？

> ID：314332
> 
> 赞同：2
> 
> 时间：2008-11-24T14:45:14.243
> 
> 标签：java

哪个是在 ThreadLocal 实例上强制 GC 的更好方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T14:49:01.490

简单的回答：你不能在 java 中强制 GC。有些人可能会发布技巧，但总而言之，您根本做不到。

嗯，事实上你可以。带出口！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T17:02:30.787

简单而丑陋的答案：

```
System.gc(); 
```

这并不能保证特定对象的垃圾收集，但它会告诉 VM 努力执行一般的垃圾收集。

具体来说，对于 ThreadLocal 变量，变量的包含实例将不会被 GC，直到线程死亡或 ThreadLocal 实例不再可访问。因此，您将需要终止关联的线程，或者您需要丢弃对 ThreadLocal 变量的引用以使`System.gc()`产生任何效果。

但是，您调用它这一事实表明您的代码存在更大的问题。如果您想摆脱一个对象，只需不引用它就足够了。虚拟机将在一段时间后出现并清理您的烂摊子。

重复一遍：干净的代码没有理由显式调用 GC。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T15:37:59.923

您不能强制 GC，并且在许多情况下，当您在容器中运行时，即使调用 System.gc() 也无济于事，因为 JVM 通常使用 -XX:+DisableExplicitGC 进行设置。JVM 将忽略您的显式调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-02T16:15:22.270

jlibs[库有一个很好的垃圾收集实用程序类](http://code.google.com/p/jlibs/wiki/GarbageCollection)。您可以使用[Wea​​kReference](http://download.oracle.com/javase/1,5.0/docs/api/java/lang/ref/WeakReference.html)对象的一个​​小技巧来强制垃圾收集。

[jlibs 中的 RuntimeUtil.gc()](http://jlibs.googlecode.com/svn/trunk/core/src/main/java/jlibs/core/lang/RuntimeUtil.java)：

```
 /**
    * This method guarantees that garbage collection is
    * done unlike <code>{@link System#gc()}</code>
    */
   public static void gc() {
     Object obj = new Object();
     WeakReference ref = new WeakReference<Object>(obj);
     obj = null;
     while(ref.get() != null) {
       System.gc();
     }
   } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-11T02:25:29.980

A`ThreadLocal<Object>`只是一把钥匙。实际值存储在每个`Thread`线程本地的弱哈希映射中，该映射将**弱** `ThreadLocal`映射到**强** `Object`。

假设没有其他人持有对`Object`in a的引用`ThreadLocal`。那么有两种方法可以对 ThreadLocal 值的值进行垃圾回收。首先，有一个简单的方法：

1.  线程完成（内部将其 threadLocals 映射设置为`null`）。
2.  垃圾收集器运行，删除其中的`Thread`'`ThreadLocalMap`和所有无法访问`Object`的 s。

但是如果线程仍在运行，那么这个序列必须在你`Object`被垃圾收集之前发生：

1.  您将丢失对`ThreadLocal`.
2.  垃圾收集器删除`ThreadLocal`.
3.  您在该线程中`set()`有一些其他s，然后从地图中删除过时的条目。所需的数字是不确定的，因为与标准不同，唯一一次删除一些过时的条目，并且仅在 上，而不是。`ThreadLocal``ThreadLocalMap``WeakHashMap``ThreadLocalMap``set()``get()`
4.  垃圾收集器最终删除了`Object`.

为了缓解垃圾收集缓慢的问题，如果该线程不再需要该对象，您可以`ThreadLocal.remove()`从每个调用。`Thread`

# shell - 如何获取除前 20 行之外的文件的最后一行？

> ID：314334
> 
> 赞同：14
> 
> 时间：2008-11-24T14:46:17.487
> 
> 标签：shell, unix, tail, unix-head

假设我有一个包含任意行数的文件，例如 125。我想获取除第一个 n 之外的所有行，例如 20。所以，我想要第 21-125 行。

有没有办法用`tail`/`head`或其他工具来做到这一点？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-24T14:50:03.843

尝试

```
tail -n +21 myfile.txt 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T14:55:02.040

尝试

> `sed -i 1,20d filename`

如果你想删除前 20 行！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T14:53:06.507

也可以使用 awk 电源：

```
awk -- 'NR > 20' /etc/passwd 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T14:53:07.350

我对此感到生疏，但类似于：tail -n +20 文件名

# symbols - 如何生成 PowerBuilder 程序的 Symbols 文件以进行转储分析？

> ID：314336
> 
> 赞同：-1
> 
> 时间：2008-11-24T14:46:48.720
> 
> 标签：symbols, dump, powerbuilder

如何生成 PowerBuilder 程序的 Symbols 文件以进行转储分析？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T16:45:34.143

Are you running into a problem with a compiled PowerBuilder application?

I've never used the Microsoft debugger, however, I have used Dependency Walker and ran my app from within that environment. Usually that helps us if we have missing deployables, etc.

If you need a stack dump, have you thought about running the app from the Run window and adding the /debug option after the name of the app? That creates a call stack log that shows all your commands being called, etc. Probably would get you what you need.

Please advise.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-22T16:06:09.340

您可以安装 Dr. Watson (drwtsn32) 以在/如果您的应用程序死机时自动创建故障转储。

也就是说，转储通常仅在您调用本机 DLL 时才有用。否则，堆栈将只包含各种难以关联回实际源代码行的 PBVM 调用。

# dotnetnuke - DotNetNuke 升级

> ID：314348
> 
> 赞同：3
> 
> 时间：2008-11-24T14:49:34.673
> 
> 标签：dotnetnuke, upgrade, scripting

这周我需要升级我当前版本的 DNN。我目前使用的是 2.1.1。我不想每件事都做两次，所以，我有几个问题。

1.  是否有升级工具或某些脚本可以帮助我进行升级。
2.  我最好安装 4.9 还是 5.0。是生产。
3.  如果我使用 4.9，我能否在它发布时升级到 5.0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T20:51:51.213

我个人强烈不同意 ALassek，您可以升级 DotNetNuke，您只需按照列出的步骤操作，只要您这样做，这没什么大不了的，但是您需要牢记一些关键事项着手进行迁移。

1.  此时不要在生产中使用 5.0。5.0 目前仅处于 RC2 阶段，不建议在生产中使用它，并且可能无法从 RC2 -> Final 升级！

2.  如果您打算尝试从 2.1.1 升级到最新版本 2，然后转到 3，然后转到 3.3.7，然后转到 4.4.1，然后到 4.6.2，然后到 4.9 .0\. 通常你可以做到，但有些网站不能。

有些模块需要更新才能与 DNN 4.x 一起使用，这取决于数量和供应商，这可能是一个简单的过程，或者可能需要为手头的特定功能寻找其他供应商。

至于从 4.9 升级到 5.0 的可能性，是的，一旦 5.0 处于生产就绪状态，这将得到 100% 的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T15:09:15.773

根据我的经验，DotNetNuke 倾向于在不记录它们的情况下发布重大更改（或记录任何内容）。如果不确切知道您在其中安装了什么，就不可能确切地说出您到底*有多*糟糕。但我可以向您保证，过渡可能并不容易，尤其是在您安装了很多模块的情况下。

在 2.1.1 => 4.9 之间，发生了很大的变化，我无法想象有任何自动升级方式。你最好从头开始，看看什么仍然有效。您很可能需要找到您正在使用的任何模块的更新版本，或者替换那些没有保持最新的模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T14:58:00.427

老实说，我不知道。但我看到 DNN 下载页面非常强烈地声明 5.0 版本候选“不推荐用于生产”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T16:01:35.487

在 2x 和 3x 之间有大量的重大变化，这将导致您必须升级或更换几乎所有自定义模块。除此之外，米切尔是 DNN 的人，我会听从他的。

# c# - 检查 Infragistics UltraGrid 中复选框的更改时会引发哪个事件？

> ID：314357
> 
> 赞同：4
> 
> 时间：2008-11-24T14:52:14.310
> 
> 标签：c#, vb.net, winforms, infragistics, ultrawingrid

我在 WinForms 应用程序中使用 Infragistics UltraGrid。
Infragistics UltraGrid 中复选框的“检查更改”会引发哪个事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T14:58:21.253

使用`CellChange`事件来引发`UltraGrid.PerformAction(UltraGridAction.ExitEditMode)`事件。这将触发`AfterCellUpdate`事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T14:58:06.590

复选框的 AfterUpdate 事件是您想要使用的。

但是，如果您无法触发它，请尝试添加它：

```
Private Sub YourGridcontrol_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles YourGridcontrol.MouseDown
    YourGridcontrol.PerformAction(Infragistics.Win.UltraWinGrid.UltraGridAction.EnterEditMode)
End Sub

Private Sub YourGridcontrol_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles YourGridcontrol.MouseUp
    YourGridcontrol.PerformAction(Infragistics.Win.UltraWinGrid.UltraGridAction.ExitEditMode)
End Sub 
```

默认情况下，只是切换复选框似乎不会触发更新。通过使其进入/退出编辑模式，AfterUpdate 应该可以按您的意愿工作。

更新：或者，就像文森特建议的那样，对 CellChange 事件执行 PerformAction 也应该有效。要点是一样的。

# iphone - How to force a screen orientation in specific view controllers?

> ID：314382
> 
> 赞同：16
> 
> 时间：2008-11-24T14:58:47.213
> 
> 标签：iphone, cocoa-touch

My application is pretty simple: it starts up with a view controller that holds a table view (in grouped view layout) with a few options. When the user taps on one of the options, I push another view controller onto my navigation controller.

This second view controller simply displays a UIImageView, and the user can change the screen orientation on this view controller between portrait/landscape modes. This works just fine, and all is happy.

However, if the user taps on the "Back" button on my navigation bar while on the landscape mode, the first controller's layout is all messed up. See below for before/after screenshots:

[![before](https://i.stack.imgur.com/HCftn.jpg)](https://i.stack.imgur.com/HCftn.jpg)
[(source: [pessoal.org](http://pessoal.org/shot1.jpg))]
[![after](https://i.stack.imgur.com/D0qzp.jpg)](https://i.stack.imgur.com/D0qzp.jpg)
[(source: [pessoal.org](http://pessoal.org/shot2.jpg))]

Any clues on how to force the first view controller (second screenshot in this post) to stay within the portrait screen orientation?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T16:01:36.697

There does not appear to be a way to do this using the documented methods.

I have filed a bug for this: rdar://6399924

"There is no way to always restrict a UIViewController to one orientation"

You can see it on open radar (along with a link to sample code to reproduce the problem) here: [http://openradar.appspot.com/radar?id=697](http://openradar.appspot.com/radar?id=697)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T23:35:18.873

Like someone on the open radar suggested, a workaround is to disable "back" button while in non-portrait:

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation{
    // don't let user press "back" button in landscape - otherwise previous view and the rest of the application
    // will also be in landscape which we did not feel like testing yet
    self.navigationController.navigationBarHidden = (UIInterfaceOrientationPortrait != self.interfaceOrientation);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-12T11:08:41.257

There is a solution to do that : it's to use a view controller and adding its view to the window. then in that controller you force landscape in the shouldAutorotate... methode. It works fine, but be sure it's necessary for your project to use that, because it's not very smart  to force the user to turn his iPhone. By the way, here is an example code if you need it.

[http://www.geckogeek.fr/iphone-forcer-le-mode-landscape-ou-portrait-en-cours-dexecution.html](http://www.geckogeek.fr/iphone-forcer-le-mode-landscape-ou-portrait-en-cours-dexecution.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-24T21:43:32.980

I wasn't able to get this to work the way I wanted. You ought to be able to set a particular orientation for a ViewController, but the NavigationController doesn't seem to always do the right thing.

I ennded up re-designing my screens so that they all work in either orientation. That might be extra work, but it "feels" more natural, anyway.

# bash - 使用 gawk 解析 CSV 文件

> ID：314384
> 
> 赞同：14
> 
> 时间：2008-11-24T14:58:57.587
> 
> 标签：bash, csv, awk, gawk

如何使用 gawk 解析 CSV 文件？简单的设置`FS=","`是不够的，因为里面有逗号的引用字段将被视为多个字段。

`FS=","`使用which 不起作用的示例：

文件内容：

```
one,two,"three, four",five
"six, seven",eight,"nine" 
```

gawk 脚本：

```
BEGIN { FS="," }
{
  for (i=1; i<=NF; i++) printf "field #%d: %s\n", i, $(i)
  printf "---------------------------\n"
} 
```

输出不良：

```
field #1: one
field #2: two
field #3: "three
field #4:  four"
field #5: five
---------------------------
field #1: "six
field #2:  seven"
field #3: eight
field #4: "nine"
--------------------------- 
```

所需的输出：

```
field #1: one
field #2: two
field #3: "three, four"
field #4: five
---------------------------
field #1: "six, seven"
field #2: eight
field #3: "nine"
--------------------------- 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-01-13T02:05:36.403

[gawk 第 4 版手册](http://www.gnu.org/software/gawk/manual/html_node/Splitting-By-Content.html)说要使用`FPAT = "([^,]*)|(\"[^\"]+\")"`

`FPAT`定义时，它将禁用并按`FS`内容而不是按分隔符指定字段。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T17:17:00.570

简短的回答是“如果 CSV 包含笨拙的数据，我不会使用 gawk 来解析 CSV”，其中 'awkward' 表示 CSV 字段数据中的逗号之类的东西。

下一个问题是“您将要进行哪些其他处理”，因为这会影响您使用的替代方案。

我可能会使用 Perl 和 Text::CSV 或 Text::CSV_XS 模块来读取和处理数据。请记住，Perl 最初部分是作为`awk`和`sed`杀手编写的——因此，`a2p`和`s2p`程序仍然与 Perl 一起分发，它们将`awk`和`sed`脚本（分别）转换为 Perl。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T17:24:01.413

如果允许，我会使用 Python [csv](https://docs.python.org/3/library/csv.html)模块，特别注意使用的[方言和所需的格式参数](https://docs.python.org/3/library/csv.html#dialects-and-formatting-parameters)，来解析您拥有的 CSV 文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-04T23:35:57.590

您可以使用一个名为 csvquote 的简单包装函数来清理输入并在 awk 完成处理后将其恢复。在开始和结束时通过管道传输您的数据，一切都应该正常：

前：

```
gawk -f mypgoram.awk input.csv 
```

后：

```
csvquote input.csv | gawk -f mypgoram.awk | csvquote -u 
```

有关代码和文档，请参阅[https://github.com/dbro/csvquote](https://github.com/dbro/csvquote)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-27T02:39:08.250

### csv2delim.awk

```
# csv2delim.awk converts comma delimited files with optional quotes to delim separated file
#     delim can be any character, defaults to tab
# assumes no repl characters in text, any delim in line converts to repl
#     repl can be any character, defaults to ~
# changes two consecutive quotes within quotes to '

# usage: gawk -f csv2delim.awk [-v delim=d] [-v repl=`"] input-file > output-file
#       -v delim    delimiter, defaults to tab
#       -v repl     replacement char, defaults to ~

# e.g. gawk -v delim=; -v repl=` -f csv2delim.awk test.csv > test.txt

# abe 2-28-7
# abe 8-8-8 1.0 fixed empty fields, added replacement option
# abe 8-27-8 1.1 used split
# abe 8-27-8 1.2 inline rpl and "" = '
# abe 8-27-8 1.3 revert to 1.0 as it is much faster, split most of the time
# abe 8-29-8 1.4 better message if delim present

BEGIN {
    if (delim == "") delim = "\t"
    if (repl == "") repl = "~"
    print "csv2delim.awk v.m 1.4 run at " strftime() > "/dev/stderr" ###########################################
}

{
    #if ($0 ~ repl) {
    #   print "Replacement character " repl " is on line " FNR ":" lineIn ";" > "/dev/stderr"
    #}
    if ($0 ~ delim) {
        print "Temp delimiter character " delim " is on line " FNR ":" lineIn ";" > "/dev/stderr"
        print "    replaced by " repl > "/dev/stderr"
    }
    gsub(delim, repl)

    $0 = gensub(/([^,])\"\"/, "\\1'", "g")
#   $0 = gensub(/\"\"([^,])/, "'\\1", "g")  # not needed above covers all cases

    out = ""
    #for (i = 1;  i <= length($0);  i++)
    n = length($0)
    for (i = 1;  i <= n;  i++)
        if ((ch = substr($0, i, 1)) == "\"")
            inString = (inString) ? 0 : 1 # toggle inString
        else
            out = out ((ch == "," && ! inString) ? delim : ch)
    print out
}

END {
    print NR " records processed from " FILENAME " at " strftime() > "/dev/stderr"
} 
```

### 测试.csv

```
"first","second","third"
"fir,st","second","third"
"first","sec""ond","third"
" first ",sec   ond,"third"
"first" , "second","th  ird"
"first","sec;ond","third"
"first","second","th;ird"
1,2,3
,2,3
1,2,
,2,
1,,2
1,"2",3
"1",2,"3"
"1",,"3"
1,"",3
"","",""
"","""aiyn","oh"""
"""","""",""""
11,2~2,3 
```

### 测试.bat

```
rem test csv2delim
rem default is: -v delim={tab} -v repl=~
gawk                      -f csv2delim.awk test.csv > test.txt
gawk -v delim=;           -f csv2delim.awk test.csv > testd.txt
gawk -v delim=; -v repl=` -f csv2delim.awk test.csv > testdr.txt
gawk            -v repl=` -f csv2delim.awk test.csv > testr.txt 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T15:15:50.360

我不确定这是否是正确的做事方式。我宁愿处理一个 csv 文件，其中所有值都被引用或没有。顺便说一句，awk 允许正则表达式成为字段分隔符。检查这是否有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-03-19T17:05:54.670

```
{
  ColumnCount = 0
  $0 = $0 ","                           # Assures all fields end with comma
  while($0)                             # Get fields by pattern, not by delimiter
  {
    match($0, / *"[^"]*" *,|[^,]*,/)    # Find a field with its delimiter suffix
    Field = substr($0, RSTART, RLENGTH) # Get the located field with its delimiter
    gsub(/^ *"?|"? *,$/, "", Field)     # Strip delimiter text: comma/space/quote
    Column[++ColumnCount] = Field       # Save field without delimiter in an array
    $0 = substr($0, RLENGTH + 1)        # Remove processed text from the raw data
  }
} 
```

遵循这一模式的模式可以访问 Column[] 中的字段。ColumnCount 指示 Column[] 中找到的元素数。如果不是所有行都包含相同数量的列，则 Column[] 在处理较短的行时在 Column[ColumnCount] 之后包含额外的数据。

此实现速度很慢，但它似乎模拟了先前答案中提到的 gawk >= 4.0.0 中的`FPAT`/功能。`patsplit()`

[参考](http://backreference.org/2010/04/17/csv-parsing-with-awk/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T15:10:41.650

这就是我想出的。任何意见和/或更好的解决方案将不胜感激。

```
BEGIN { FS="," }
{
  for (i=1; i<=NF; i++) {
    f[++n] = $i
    if (substr(f[n],1,1)=="\"") {
      while (substr(f[n], length(f[n]))!="\"" || substr(f[n], length(f[n])-1, 1)=="\\") {
        f[n] = sprintf("%s,%s", f[n], $(++i))
      }
    }
  }
  for (i=1; i<=n; i++) printf "field #%d: %s\n", i, f[i]
  print "----------------------------------\n"
} 
```

基本思想是我遍历字段，任何以引号开头但不以引号结尾的字段都会获得附加到它的下一个字段。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-28T00:22:36.300

Perl 有 Text::CSV_XS 模块，该模块专门用于处理带引号的逗号怪异。
或者尝试 Text::CSV 模块。

`perl -MText::CSV_XS -ne 'BEGIN{$csv=Text::CSV_XS->new()} if($csv->parse($_)){@f=$csv->fields();for $n (0..$#f) {print "field #$n: $f[$n]\n"};print "---\n"}' file.csv`

产生这个输出：

```
field #0: one
field #1: two
field #2: three, four
field #3: five
---
field #0: six, seven
field #1: eight
field #2: nine
--- 
```

这是一个人类可读的版本。
将其另存为 parsecsv，chmod +x，并将其作为“parsecsv file.csv”运行

```
#!/usr/bin/perl
use warnings;
use strict;
use Text::CSV_XS;
my $csv = Text::CSV_XS->new();
open(my $data, '<', $ARGV[0]) or die "Could not open '$ARGV[0]' $!\n";
while (my $line = <$data>) {
    if ($csv->parse($line)) {
        my @f = $csv->fields();
        for my $n (0..$#f) {
            print "field #$n: $f[$n]\n";
        }
        print "---\n";
    }
} 
```

您可能需要在您的机器上指向不同版本的 perl，因为您的默认 perl 版本上可能没有安装 Text::CSV_XS 模块。

```
Can't locate Text/CSV_XS.pm in @INC (@INC contains: /home/gnu/lib/perl5/5.6.1/i686-linux /home/gnu/lib/perl5/5.6.1 /home/gnu/lib/perl5/site_perl/5.6.1/i686-linux /home/gnu/lib/perl5/site_perl/5.6.1 /home/gnu/lib/perl5/site_perl .).
BEGIN failed--compilation aborted. 
```

如果您的 Perl 版本都没有安装 Text::CSV_XS，您需要：
`sudo apt-get install cpanminus`
`sudo cpanm Text::CSV_XS`

# .net - Windows 窗体中的选项卡索引

> ID：314392
> 
> 赞同：10
> 
> 时间：2008-11-24T15:01:54.117
> 
> 标签：.net, visual-studio, winforms

在我当前的应用程序中，我有一个要求用户输入大量数据的表单。大约有 30 个文本框，并且在开发过程中会引入新的文本框或将旧的文本框踢出。

我的客户的一个要求是，它们都可以通过按 Tab 来导航，所以如果我没看错的话，我目前受制于 TabIndex 属性。

一开始我手动设置了这些属性，但这需要我在更改某些内容时重新索引它们。

我已经尝试通过将所有 FormDesigner 生成的控件添加到列表中来解决该问题，并在为该列表中的控件设置 tabindex 时循环遍历该列表。

尽管如此，它还是行不通。我的一些控件仍然无法集中注意力。我还没有真正找到解决方法，但会找到一个。

我现在的问题是，我到底为什么要做这样的事情？有没有更好的方法来处理标签索引，或者这真的会是这样吗？我的意思是，我花了几个小时和那个愚蠢的设计师设置标签索引！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-24T15:06:14.327

当表单设计器打开时，转到 View -> Tab Order 这将允许您以非常简单的方式设置 Tab 键顺序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-24T15:04:38.510

这是您可能想尝试的东西。来自[代码项目](http://www.codeproject.com/KB/dotnet/TabOrderManager.aspx)。这将通过 2 种逻辑方式组织您的标签索引。

![替代文字](https://www.codeproject.com/KB/dotnet/TabOrderManager/TabOrderManager.gif)

# c# - 在 ASP.NET 中，“ASP”代码叫什么？

> ID：314397
> 
> 赞同：3
> 
> 时间：2008-11-24T15:04:33.987
> 
> 标签：c#, asp.net, terminology

我的问题的更多细节：

HTML 和 JavaScript 被称为“客户端代码”。

文件背后的代码中的 C# 和 VB 被称为“服务器端代码”。

那么什么是 inline-asp 和 'runat=server' 代码块呢？

```
<!-- This is called "client-side" -->
<p>Hello World</p>
<script>alert("Hello World");</script> 
```

...

```
// This is called "server-side"
public void Page_Load(object sender, EventArgs e)
{
    Response.Write("Hello World");
} 
```

...

```
<%-- What is this called ??? --%>
<asp:Label ID="MyLabel" runat="server" />
<% Response.Write("Hello World"); %> 
```

我能想到的最好的术语是“Web 表单代码”。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T15:17:56.660

明确地说，微软称它们为嵌入式代码块。

[http://msdn.microsoft.com/en-us/library/ms178135.aspx](http://msdn.microsoft.com/en-us/library/ms178135.aspx)

它们是通过在渲染阶段调用而嵌入到页面生命周期中的代码块。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T15:14:00.957

ASP 页面中以[**代码呈现块**](https://msdn.microsoft.com/en-us/library/k6xeyd4z(v=vs.90).aspx "MSDN：代码渲染块")开头和以*`<%`*结尾的部分称为[**代码声明块**](http://msdn.microsoft.com/en-us/library/2cy7sxha(v=vs.90).aspx "MSDN：代码声明块")。其中的代码是*服务器代码*。*`%>`*[](https://msdn.microsoft.com/en-us/library/k6xeyd4z(v=vs.90).aspx "MSDN：代码渲染块")**`<script>``runat=server`[](http://msdn.microsoft.com/en-us/library/2cy7sxha(v=vs.90).aspx "MSDN：代码声明块")**

 *****开头的部分*`<%@`*是**指令**。开头的代码渲染块*`<%=`*只是方法中调用的`writer.Write()`简写`Page.Render()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T15:50:06.923

在 MSDN 站点的 ASP 部分，它们被称为**“脚本命令”**、**“服务器端脚本命令”**和**“主要脚本命令”**。

下面我包含了 MSDN 站点的摘录和一个参考链接。

***ASP 使用分隔符 <% 和 %> 将脚本命令**括起来。在分隔符中，您可以包含对您正在使用的脚本语言有效的任何命令。*

*由分隔符包围的命令称为**主要脚本命令**，使用主要脚本语言进行处理。您在脚本分隔符中使用的任何命令都必须对主要脚本语言有效。默认情况下，主要脚本语言是 VBScript，但您也可以设置不同的默认语言。*

（[http://msdn.microsoft.com/en-us/library/ms524741.aspx](http://msdn.microsoft.com/en-us/library/ms524741.aspx)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T15:06:04.607

我称它们为“服务器标签”或“服务器端标签”。

不知道这是否正确。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T15:10:34.520

aspx 文件中的代码称为**“标记”。** 这也包括静态 html。如果您想将其缩小到标签内的`<% %>`代码，只需说“代码块”。

`<% %>`标签本身和类似标签被称为“Bee Stings” 。请注意，这仅适用于不同类型的`<% %>`标签，而不是您使用它们创建的代码块。

# c - 如何从 C 中的控制台读取一行？

> ID：314401
> 
> 赞同：121
> 
> 时间：2008-11-24T15:05:08.090
> 
> 标签：c, io, console, stdin

在 C 控制台程序中读取整行的最简单方法是什么输入的文本可能具有可变长度，我们不能对其内容做出任何假设。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-11-24T15:10:55.380

您需要动态内存管理，并使用该`fgets`功能来读取您的行。但是，似乎无法查看它读取了多少个字符。所以你使用 fgetc：

```
char * getline(void) {
    char * line = malloc(100), * linep = line;
    size_t lenmax = 100, len = lenmax;
    int c;

    if(line == NULL)
        return NULL;

    for(;;) {
        c = fgetc(stdin);
        if(c == EOF)
            break;

        if(--len == 0) {
            len = lenmax;
            char * linen = realloc(linep, lenmax *= 2);

            if(linen == NULL) {
                free(linep);
                return NULL;
            }
            line = linen + (line - linep);
            linep = linen;
        }

        if((*line++ = c) == '\n')
            break;
    }
    *line = '\0';
    return linep;
} 
```

**注意**：永远不要使用gets！它不做边界检查并且可能溢出你的缓冲区

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-11-24T15:45:06.573

如果您使用的是 GNU C 库或其他符合 POSIX 的库，则可以使用[`getline()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html)并将其传递`stdin`给文件流。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-11-25T20:48:45.117

读取静态分配行的一个非常简单但不安全的实现：

```
char line[1024];

scanf("%[^\n]", line); 
```

一个更安全的实现，没有缓冲区溢出的可能性，但有可能不读取整行，是：

```
char line[1024];

scanf("%1023[^\n]", line); 
```

不是声明变量的指定长度与格式字符串中指定的长度之间的“差一”。这是一件历史文物。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-24T15:12:21.600

因此，如果您正在寻找命令参数，请查看 Tim 的答案。如果您只想从控制台读取一行：

```
#include <stdio.h>

int main()
{
  char string [256];
  printf ("Insert your full address: ");
  gets (string);
  printf ("Your address is: %s\n",string);
  return 0;
} 
```

**是的，它不安全，你可以做缓冲区溢出，它不检查文件结尾，它不支持编码和许多其他东西。实际上我什至没有想过它是否做了这些事情。我同意我有点搞砸了:) 但是......当我看到“如何从 C 中的控制台读取一行？”这样的问题时，我认为一个人需要一些简单的东西，比如 gets() 而不是 100 行代码像上面一样。实际上，我认为，如果您尝试在现实中编写那 100 行代码，您会犯更多的错误，而不是选择gets ;)**

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-02-29T09:19:21.640

**`getline`可运行的例子**

`getline`[在这个答案](https://stackoverflow.com/a/314525/895245)中提到了，但这是一个例子。

它是[POSIX 7](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getdelim.html)，为我们分配内存，并在循环中很好地重用分配的缓冲区。

指针新手，请阅读：[为什么 getline 的第一个参数是指向指针“char**”而不是“char*”的指针？](https://stackoverflow.com/questions/5744393/why-is-the-first-argument-of-getline-a-pointer-to-pointer-char-instead-of-c)

主程序

```
#define _XOPEN_SOURCE 700
#include <stdio.h>
#include <stdlib.h>

int main(void) {
    char *line = NULL;
    size_t len = 0;
    ssize_t read = 0;
    while (1) {
        puts("enter a line");
        read = getline(&line, &len, stdin);
        if (read == -1)
            break;
        printf("line = %s", line);
        printf("line length = %zu\n", read);
        puts("");
    }
    free(line);
    return 0;
} 
```

编译并运行：

```
gcc -ggdb3 -O0 -std=c99 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

结果：这显示在热：

```
enter a line 
```

然后，如果您键入：

```
asdf 
```

然后按回车，这会显示：

```
line = asdf
line length = 5 
```

其次是另一个：

```
enter a line 
```

或从管道到标准输入：

```
printf 'asdf\nqwer\n' | ./main.out 
```

给出：

```
enter a line
line = asdf
line length = 5

enter a line
line = qwer
line length = 5

enter a line 
```

在 Ubuntu 20.04 上测试。

**glibc 实现**

没有POSIX？也许你想看看[glibc 2.23 的实现](https://sourceware.org/git/?p=glibc.git;a=blob;f=libio/iogetdelim.c;h=50fda58e6832d23391d26d3c64c7b66b11d304c3;hb=ab30899d880f9741a409cbc0d7a28399bdac21bf#l40)。

它解析为`getdelim`，这是一个`getline`带有任意行终止符的简单 POSIX 超集。

每当需要增加时，它会将分配的内存加倍，并且看起来是线程安全的。

它需要一些宏扩展，但你不可能做得更好。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-11-24T15:18:49.433

您可能需要使用逐字符 (getc()) 循环来确保没有缓冲区溢出并且不会截断输入。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-25T21:55:32.363

如建议的那样，您可以使用 getchar() 从控制台读取，直到返回行尾或 EOF，从而构建自己的缓冲区。如果您无法设置合理的最大行大小，则可能会动态增加缓冲区。

您还可以使用 fgets 作为一种安全的方式来获取一行作为 C 空终止字符串：

```
#include <stdio.h>

char line[1024];  /* Generously large value for most situations */

char *eof;

line[0] = '\0'; /* Ensure empty line if no input delivered */
line[sizeof(line)-1] = ~'\0';  /* Ensure no false-null at end of buffer */

eof = fgets(line, sizeof(line), stdin); 
```

如果您已用尽控制台输入或操作由于某种原因失败，则返回 eof == NULL 并且行缓冲区可能未更改（这就是为什么将第一个字符设置为 '\0' 很方便）。

fgets 不会溢出 line[] 并且它将确保在成功返回时最后接受的字符之后有一个空值。

如果到达行尾，则终止 '\0' 之前的字符将是 '\n'。

如果在结尾 '\0' 之前没有终止 '\n' ，则可能是有更多数据或下一个请求将报告文件结尾。你必须做另一个 fgets 来确定哪个是哪个。（在这方面，使用 getchar() 循环更容易。）

在上面的（更新的）示例代码中，如果 line[sizeof(line)-1] == '\0' 在 fgets 成功后，您就知道缓冲区已被完全填满。如果该位置以 '\n' 开头，您就知道您很幸运。否则，stdin 中会出现更多数据或文件结尾。（当缓冲区没有完全填满时，您可能仍然处于文件末尾，并且当前行的末尾也可能没有 '\n'。因为您必须扫描字符串以查找和/或消除字符串结尾之前的任何 '\n'（缓冲区中的第一个 '\0'），我倾向于首先使用 getchar()。）

做你需要做的事情来处理仍然比你作为第一个块读取的数量更多的行。动态增长缓冲区的示例可以使用 getchar 或 fgets。有一些棘手的边缘情况需要注意（比如记住让下一个输入开始存储在缓冲区扩展之前结束前一个输入的 '\0' 的位置）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-07-21T13:51:33.413

> 如何从 C 中的控制台读取一行？

*   构建自己的功能是帮助您实现从控制台读取一行的方法之一

*   我正在使用[动态内存分配](https://en.wikipedia.org/wiki/C_dynamic_memory_allocation)来分配所需的内存量

*   当我们即将耗尽分配的内存时，我们尝试将内存大小加倍

*   在这里，我使用循环使用`getchar()`函数一个一个地扫描字符串的每个字符，直到用户输入`'\n'`或`EOF`字符

*   最后，我们在返回该行之前删除任何额外分配的内存

```
//the function to read lines of variable length

char* scan_line(char *line)
{
    int ch;             // as getchar() returns `int`
    long capacity = 0;  // capacity of the buffer
    long length = 0;    // maintains the length of the string
    char *temp = NULL;  // use additional pointer to perform allocations in order to avoid memory leaks

    while ( ((ch = getchar()) != '\n') && (ch != EOF) )
    {
        if((length + 1) >= capacity)
        {
            // resetting capacity
            if (capacity == 0)
                capacity = 2; // some initial fixed length 
            else
                capacity *= 2; // double the size

            // try reallocating the memory
            if( (temp = realloc(line, capacity * sizeof(char))) == NULL ) //allocating memory
            {
                printf("ERROR: unsuccessful allocation");
                // return line; or you can exit
                exit(1);
            }

            line = temp;
        }

        line[length] = (char) ch; //type casting `int` to `char`
        length++;
    }
    line[length + 1] = '\0'; //inserting null character at the end

    // remove additionally allocated memory
    if( (temp = realloc(line, (length + 1) * sizeof(char))) == NULL )
    {
        printf("ERROR: unsuccessful allocation");
        // return line; or you can exit
        exit(1);
    }

    line = temp;
    return line;
} 
```

*   现在您可以通过这种方式阅读整行：

    ```
     char *line = NULL;
     line = scan_line(line); 
    ```

* * *

这是一个使用该函数的**示例程序：**`scan_line()`

```
#include <stdio.h>
#include <stdlib.h> //for dynamic allocation functions

char* scan_line(char *line)
{
    ..........
}

int main(void)
{
    char *a = NULL;

    a = scan_line(a); //function call to scan the line

    printf("%s\n",a); //printing the scanned line

    free(a); //don't forget to free the malloc'd pointer
} 
```

**样本输入：**

```
Twinkle Twinkle little star.... in the sky! 
```

**样本输出：**

```
Twinkle Twinkle little star.... in the sky! 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T15:49:01.137

我前段时间遇到了同样的问题，这是我的解决方案，希望对您有所帮助。

```
/*
 * Initial size of the read buffer
 */
#define DEFAULT_BUFFER 1024

/*
 * Standard boolean type definition
 */
typedef enum{ false = 0, true = 1 }bool;

/*
 * Flags errors in pointer returning functions
 */
bool has_err = false;

/*
 * Reads the next line of text from file and returns it.
 * The line must be free()d afterwards.
 *
 * This function will segfault on binary data.
 */
char *readLine(FILE *file){
    char *buffer   = NULL;
    char *tmp_buf  = NULL;
    bool line_read = false;
    int  iteration = 0;
    int  offset    = 0;

    if(file == NULL){
        fprintf(stderr, "readLine: NULL file pointer passed!\n");
        has_err = true;

        return NULL;
    }

    while(!line_read){
        if((tmp_buf = malloc(DEFAULT_BUFFER)) == NULL){
            fprintf(stderr, "readLine: Unable to allocate temporary buffer!\n");
            if(buffer != NULL)
                free(buffer);
            has_err = true;

            return NULL;
        }

        if(fgets(tmp_buf, DEFAULT_BUFFER, file) == NULL){
            free(tmp_buf);

            break;
        }

        if(tmp_buf[strlen(tmp_buf) - 1] == '\n') /* we have an end of line */
            line_read = true;

        offset = DEFAULT_BUFFER * (iteration + 1);

        if((buffer = realloc(buffer, offset)) == NULL){
            fprintf(stderr, "readLine: Unable to reallocate buffer!\n");
            free(tmp_buf);
            has_err = true;

            return NULL;
        }

        offset = DEFAULT_BUFFER * iteration - iteration;

        if(memcpy(buffer + offset, tmp_buf, DEFAULT_BUFFER) == NULL){
            fprintf(stderr, "readLine: Cannot copy to buffer\n");
            free(tmp_buf);
            if(buffer != NULL)
                free(buffer);
            has_err = true;

            return NULL;
        }

        free(tmp_buf);
        iteration++;
    }

    return buffer;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-24T03:07:51.050

在 BSD 系统和 Android 上，您还可以使用`fgetln`：

```
#include <stdio.h>

char *
fgetln(FILE *stream, size_t *len); 
```

像这样：

```
size_t line_len;
const char *line = fgetln(stdin, &line_len); 
```

`line`不是空终止的，并且最终包含（`\n`或您的平台正在使用的任何内容）。在流上的下一个 I/O 操作后它变得无效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-05-25T13:13:16.230

像这样的东西：

```
unsigned int getConsoleInput(char **pStrBfr) //pass in pointer to char pointer, returns size of buffer
{
    char * strbfr;
    int c;
    unsigned int i;
    i = 0;
    strbfr = (char*)malloc(sizeof(char));
    if(strbfr==NULL) goto error;
    while( (c = getchar()) != '\n' && c != EOF )
    {
        strbfr[i] = (char)c;
        i++;
        strbfr = (void*)realloc((void*)strbfr,sizeof(char)*(i+1));
        //on realloc error, NULL is returned but original buffer is unchanged
        //NOTE: the buffer WILL NOT be NULL terminated since last
        //chracter came from console
        if(strbfr==NULL) goto error;
    }
    strbfr[i] = '\0';
    *pStrBfr = strbfr; //successfully returns pointer to NULL terminated buffer
    return i + 1; 
    error:
    *pStrBfr = strbfr;
    return i + 1;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-15T07:53:00.610

从控制台读取一行的最好和最简单的方法是使用 getchar() 函数，您可以一次将一个字符存储在一个数组中。

```
{
char message[N];        /* character array for the message, you can always change the character length */
int i = 0;          /* loop counter */

printf( "Enter a message: " );
message[i] = getchar();    /* get the first character */
while( message[i] != '\n' ){
    message[++i] = getchar(); /* gets the next character */
}

printf( "Entered message is:" );
for( i = 0; i < N; i++ )
    printf( "%c", message[i] );

return ( 0 ); 
```

}

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-25T20:28:11.150

这是一个最小的实现，好处是它不会保留'\ n'，但是为了安全起见，你必须给它一个大小来读取：

```
#include <stdio.h>
#include <errno.h>

int sc_gets(char *buf, int n)
{
    int count = 0;
    char c;

    if (__glibc_unlikely(n <= 0))
        return -1;

    while (--n && (c = fgetc(stdin)) != '\n')
        buf[count++] = c;
    buf[count] = '\0';

    return (count != 0 || errno != EAGAIN) ? count : -1;
} 
```

* * *

测试：

```
#define BUFF_SIZE 10

int main (void) {
    char buff[BUFF_SIZE];

    sc_gets(buff, sizeof(buff));
    printf ("%s\n", buff);

    return 0;
} 
```

*注意：您仅限于 INT_MAX 才能找到您的线路返回，这绰绰有余。*

# ruby-on-rails - 在 Ruby on Rails 中，如何在运行时组合多个 Javascript 文件？

> ID：314408
> 
> 赞同：1
> 
> 时间：2008-11-24T15:07:44.450
> 
> 标签：ruby-on-rails

我正在构建一个大量使用 Javascript 的 Facebook 应用程序。为此，我有多个 Javascript 文件。由于在 Facebook 开发中，页面是通过隧道提供的，因此在请求多个 javascript 文件时会增加过多的延迟。是否可以在运行时组合多个 javascript 文件的内容？拥有多个文件使开发变得容易，因此我避免在开发本身时将其组合起来。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-24T15:23:37.553

您可以将`:cache`选项传递给`javascript_include_tag`将文件合并为一个的选项：

```
<%= javascript_include_tag :all, :cache => true %> 
```

请注意，这取决于`ActionController::Base.perform_caching`设置为 true，这是 Rails 生产环境的默认设置。

*   请参阅[http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#M001493](http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#M001493)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-05T18:57:40.227

在位于 的环境的配置文件中`/config/environments`，每个文件都有一个文件，`development.rb`以此类推。

在该文件中，您可以设置`config.assets.debug = false`

这会将文件减少到 1 个 js 文件和 1 个 css 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T15:16:39.640

比在运行时组合更好，看看[Frizione](http://code.google.com/p/frizione/)。它是一个框架，可让您在部署时组合您的 javascript 文件并压缩它们。所以你可以节省周围的一切。它还引入了文档生成和 JSLint 检查，但这只是一个额外的好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-29T08:51:13.433

Jammit 也是一个不错的选择，可以合并 js 和 css 文件。

[http://documentcloud.github.com/jammit/](http://documentcloud.github.com/jammit/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-22T03:42:37.047

我在我的应用程序中使用了[asset_packager](http://github.com/imedo/asset_packager) gem 来执行此操作。

它将合并和最小化您的 javascript（和 CSS）文件以用于生产，并添加一些视图助手，使其非常易于使用。如果原始文件已更改，您可以运行一个 rake 命令来生成打包文件。

# architecture - 设计一个徽章系统，从哪里触发业务逻辑？在代码或存储过程中？或两者？

> ID：314412
> 
> 赞同：25
> 
> 时间：2008-11-24T15:08:21.903
> 
> 标签：architecture

如果您要构建一个与 SO 类似的徽章系统，您是将逻辑/业务层直接放在数据库中（通过存储过程、预定的 sql 作业）还是放在服务器端？

据我所知，您必须：

1.  列出与当前用户操作相关的徽章
2.  检查用户是否已经拥有徽章
3.  为用户插入徽章

**潜在选择**

1.  Web 应用程序中调用存储过程等的业务逻辑。
2.  仅存储过程
3.  每 x 分钟运行一次的 sql server 作业
4.  每 x 分钟运行一次的 Windows 服务

需要这些的组合吗？我认为它会因为一些徽章是基于给定问题的里程碑，也许批处理工作更好？

**更新**

一个您可以修改徽章系统，然后为每个人重新运行整个徽章链接的系统会更好。即说您更改了某些徽章的逻辑，现在您必须将其重新应用于所有问题/答案/投票/等。

**有趣的问题要解决！！**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-24T16:07:07.933

我建议将所有业务逻辑放在业务层中。我推荐这个有几个原因：

*   将业务逻辑保持在一种语言/位置
*   可扩展性 - 您可以对数据进行分区、实现不同的缓存机制等。
*   关注点分离 - 让您的数据库做它最擅长的事情......存储数据，让您的编程语言对这些数据做出决策。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-24T15:57:28.263

我会把它放在业务层，毕竟这是我们正在谈论的业务逻辑。存储过程当然可以用于拉回适当的数据，但我不喜欢仅在数据库中实现决策逻辑。如果没有别的，只是因为在以后重新访问代码时跟踪正在发生的事情变得越来越困难。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-24T17:03:02.913

就个人而言，我会离开数据库来进行数据存储/检索，并将逻辑放在“业务层”中。

随着 StackOverflow 的成功，我也对为我的一个网站实施成就系统非常感兴趣 - 所以我自己一直在考虑这个问题。

我目前正在尝试评估拥有一个轻量级（就处理能力而言）例程的价值，我可以运行该例程以响应特定的用户操作（投票、新答案等），这可以保持大多数徽章- 最新的网站。

这将得到一个更重量级的例程的支持，该例程可以从头开始重新计算每个徽章。这可以从服务（或至少[模拟服务](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)）定期运行，以确保没有遗漏任何内容 - 也可以响应徽章规则的更改。

我想这个问题的很大一部分答案将取决于您获得徽章奖励的数据。StackOverflow 徽章似乎基于*数据*（答案、问题、投票等）和*事件*（编辑、重新标记等）。所以 - 徽章算法可能必须询问某种审计日志或“操作”日志。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-01T18:09:19.120

所以——这是一场经典的 SO 辩论，也是热情的程序员之间的一场辩论。我已经问过一个类似但更通用的问题......

[数据库层的业务逻辑](https://stackoverflow.com/questions/7005404/business-logic-in-database-layer)

为了回答第一部分，我发现我在代码与数据库中看到的关于业务逻辑的最佳解释之一是：

[http://www.codeproject.com/KB/architecture/DudeWheresMyBusinessLogic.aspx](http://www.codeproject.com/KB/architecture/DudeWheresMyBusinessLogic.aspx)

它继续解释为什么业务逻辑更好且可扩展。我也有这种心态......所以要回答你的问题，我不会在数据库或存储过程中保留任何业务逻辑，其中主要原因是 SP 不受版本控制，这很痛苦对它们进行版本控制。更不用说，用于 SP 的 IDE 比用于代码的 IDE 更加原始。而 sql/tsql 和类似的东西并不是用于复杂的代码结构，而是用于数据的基本操作，正如您将在本文中看到的那样，用于一些非常基本的代码结构，因为以前的客户端-服务器架构是有限的。

此页面的一些例外情况：

> 在客户端服务器系统中，有两层，因此至少要实现两层。在早期，服务器被简单地视为远程数据库，而该部门被视为应用程序（客户端）和存储（服务器）。通常，所有业务逻辑都保留在客户端中，并与其他层（例如用户界面）混合在一起。
> 
> 很快就意识到可以通过将大部分业务逻辑移出客户端来减少网络带宽和集中逻辑以减少客户端的不断重新部署需求。由于只有两层，将业务逻辑移动到的唯一地方是服务器。服务器在架构上非常适合客户端服务器系统中的位置，但作为平台的数据库是一个糟糕的选择。数据库是为存储和检索而设计的，它们的可扩展性是围绕这些需求而设计的。数据库存储过程语言专为基本数据转换而设计，以补充 SQL 无法完成的功能。存储过程语言旨在快速执行，而不是复杂的业务逻辑。
> 
> 但这是两个选择中更好的一个，因此将业务逻辑移到了存储过程中。事实上，我会争辩说，出于实用主义的考虑，业务逻辑被硬塞到存储过程中（粉碎，适应）。在两层世界中，它并不完美，而是一种改进。

> 业务层应该包含所有的业务规则。
> 
> 这样的设计具有以下优点： - 所有业务逻辑都存在于一个位置，并且可以很容易地验证、调试和修改。- 可以使用真正的开发语言来实现业务规则。这样的语言比 SQL 和存储过程更灵活，更适合这样的业务规则。- 数据库成为存储层，可以专注于有效检索和存储数据，而不受任何与业务逻辑实现或表示层相关的限制。

所以 - 现在，关于架构，我会这样做，以便在相关问题/答案或其他任何内容更新时，通过调用存储的过程来更新每个用户的徽章。您将其放入问题或答案的业务逻辑中，因为我假设不同类型的项目（当它们被修改时）会有所不同。因为这是一个基于事件的动作，所以动作只会在事件发生时发生。如果您有服务或计划任务，它会一直运行，虽然很少，但当您有很多用户时，它最终会使系统陷入困境。

如果您不想让每个用户的事件触发大量检查和更新，您可以将它们批处理到一个表中，并有一个计划的工作来更新徽章。

为了允许系统根据新的业务逻辑更新整个用户群，您可以将所有操作包含在 Windows 作业或一次性作业中，这将比 tsql、恕我直言，并且更易于维护，和灵活。

但是，有时复制非常少的业务逻辑可能会使您受益，以获得一些性能提升。但正如您在文章中看到的，代码中的业务层更具可扩展性，因此它可能是一个有争议的问题。

希望这是对您有用的信息，以决定您需要什么...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-29T19:35:05.453

我强烈建议将决策留给业务逻辑，而不是存储过程。存储过程用于处理数据（即收集数据、检查特定状态和条件、删除、更新、聚合等）。它不是条件逻辑（决策）的创建场所。

至于事件，胜过数据：功绩系统中的一切都是（或至少可以）基于事件的。

> 数据（答案、问题、投票等）和事件（编辑、重新标记等）

...所有这些都是事件：回答问题、提出问题、投票等。

您可以使用存储过程来获取确定是否已获得徽章所需的数据，但您的代码应实际做出决定，并在适当的情况下分配徽章。这个算法可能会和徽章一样多变。但是，这是我要遵循的一些逻辑：

*   根据所涉及的事件类型对所有徽章进行分类（例如回答问题、提出问题、进行编辑、重新标记、投票等）
*   当特定事件发生时，获取与该事件相关的所有徽章（即可以通过完成触发事件的任务来获得）
*   循环浏览该类别中的每个徽章并运行它的 Badge.VerifyCriteria(UserID) 方法
*   如果用户还没有徽章，请进行徽章分配

VerifyCriteria 方法将是存储过程的可能位置的一个很好的示例，尤其是在您需要更高性能的情况下。这与检查数据库的特定状态或条件一样多，因为它是业务逻辑。一些徽章可能需要一些在数据库语言（例如 SQL）中难以处理的处理，因此 VerifyCriteria 应该是对象上的一个实际方法，它酌情调用存储过程和/或代码。这也使您的业务逻辑对 OO 友好。

如果您想完全重新标记系统中的每个人，我会在后台运行批处理作业，或者如果处理足够轻，只需在下次登录时更新用户，或者下次他们是用户时数据被访问（例如，当有人试图查看他们的个人资料时）。但我仍会将其全部保留在业务逻辑中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T15:18:57.873

我会编写一个存储过程，因为所需的所有信息都驻留在数据库中，因此这是访问该数据的最有效位置。

一个典型的规则可以通过单个 INSERT 语句实现，如下所示：

```
IF eligible for <new badge> THEN
    INSERT INTO user_badges
    SELECT <new_badge>
    WHERE NOT EXISTS (SELECT NULL FROM user_badges
                      WHERE badge = <new_badge>);
END IF; 
```

（我有点简化！）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-04T04:35:51.820

我会将所有业务逻辑集中在一种语言中，在命名空间或包中逻辑分离。例如，需要通过 Web 界面完成的所有工作都将由服务器使用服务公开。

# c# - 为什么使用 GlobalClass？它们是干什么用的？

> ID：314415
> 
> 赞同：0
> 
> 时间：2008-11-24T15:09:26.520
> 
> 标签：c#

为什么使用 GlobalClass？它们是干什么用的？我继承了一些代码（如下所示），据我所知，strUserName 没有理由需要这个。一切为了什么？

```
public static string strUserName
    {
        get { return m_globalVar; }
        set { m_globalVar = value; }
    } 
```

后来用作：

```
GlobalClass.strUserName 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T15:13:43.500

你得到了全局状态的所有错误，没有任何令人讨厌的直接变量访问。

如果你打算这样做，那么你的编码器很好地实现了它。他/她可能（正确地）认为他们以后可以自由地换出一个实现。

通常它被认为是一个坏主意，因为它使整个系统的测试变得困难，因为你拥有的全局变量越多。

我的 2 美分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T15:13:27.387

当你想使用一个类型的**静态**成员时，你可以像`ClassName.MemberName`. 如果您的代码片段与您引用的成员在同一个类中（在此示例中，您在 GlobalClass 成员中编码，并使用 strUserName），您**可以**省略类名。否则，它是必需的，因为编译器不知道您指的是什么类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T15:28:39.400

这是在 ASP.Net 中处理 Context 时常用的方法；但是，实现永​​远不会使用单个变量。因此，如果这是一个网络应用程序，我可以看到这种方法被用来指示当前用户是谁（尽管有更好的方法来做到这一点）。

我使用了一种类似的方法，我有一个 MembershipService.CurrentUser 属性，然后将用户从 SessionState 或 LogicalCallContext 中拉出（如果它是 Web 或客户端应用程序）。

但在这些情况下，它们不是全局的，因为它们的范围很窄（如 http 会话状态）。

我使用像这样的全局变量的一种情况是，如果我有一些静态数据并且从不更改，并且是从数据库加载的（并且没有足够的数据来证明将其存储在缓存中是合理的）。您可以将其存储在静态变量中，这样您就不必返回数据库。

附带说明一下，为什么开发人员使用匈牙利符号来命名属性？即使没有智能感知和我们的 IDE 提供的所有优点，我们也从未在属性上使用匈牙利符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T15:45:16.433

@Jayne，@Josh，很难说 - 但问题中的代码也可能是静态字段的静态访问器 - 与 @Josh 的静态帮助程序示例（您在帮助程序中使用实例或上下文变量）有些不同。

静态 Helper 方法是方便抽象无状态功能块的好方法。然而，在这个例子中，全局变量有可能是有状态的——得墨忒耳定律告诉我们，你应该只使用你拥有的状态或者通过参数给定的状态。

> [http://www.c2.com/cgi/wiki?LawOfDemeter](http://www.c2.com/cgi/wiki?LawOfDemeter)

鉴于规则有时需要打破它们。您应该权衡使用全局状态的风险（主要是创建状态/并发错误的风险）与使用全局变量的必要性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T16:14:01.070

好吧，如果您想让 jvm 中运行的任何其他类都可以使用一条数据，那么全局类就是您要走的路。

只有两个小问题；

一。所示的实现不是线程安全的。任何全局类的 set... 方法都应标记为关键或包装在互斥锁中。即使在上面的简单示例中，考虑如果两个线程同时运行会发生什么： set("Joe") 和 set("Frederick") 可能导致 "Joederick" 或 "Fre" 或其他一些排列。

二。它不能很好地扩展。“全局”是指单个 jvm。像 Jboss 这样更复杂的运行时环境可能会运行多个相互通信的 jvm。因此，全局用户 ID 可能是“Joe”或“Frederick”，具体取决于您的 EJB 调度的 jvm。

# c# - MbUnit 集成测试新手问题

> ID：314423
> 
> 赞同：0
> 
> 时间：2008-11-24T15:11:03.100
> 
> 标签：c#, com, integration, mbunit

我的任务是对一个大型系统进行集成测试。目前，我有一个 COM dll，我正在使用我创建的 UI 进行测试，该 UI 启动了一系列调用 dll 的单元测试。这可行，但我想将其迁移到 MbUnit。当我在 MbUnit 中开始第一个测试时，它似乎挂在“找到 1 个测试”处。我最终不得不关闭 IDE。有人可以指出我正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T22:17:41.070

这就是我们启动 MBUnit 测试应用程序（命令行）的方式：

```
namespace UnitTest
{
  class Program
  {
    static void Main(string[] args_)
    {
      // run unit test
      AutoRunner auto = new AutoRunner();
      auto.Load();
      auto.Run();

      HtmlReport report = new HtmlReport();

      string fileName;
      // generate report results
      fileName = report.Render(auto.Result);

      // launch results in user's browser
      System.Diagnostics.Process.Start(fileName);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T08:00:38.507

尝试使用调试器手动单步执行代码。

# reporting-services - 查看 Word 文档 只读

> ID：314424
> 
> 赞同：4
> 
> 时间：2008-11-24T15:11:05.363
> 
> 标签：reporting-services

我有一个从 DMS 系统读取记录的报告，我认为最好有一个指向它列出的文档的链接，以便用户可以查看实际文档。

但是，当它显示 Word 文档时，它允许您进行更改然后保存它们，这反而会破坏 DMS 系统。

我认为Word中没有参数（/ r）可以做到这一点，所以你们中的任何聪明人有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T15:57:36.750

这是 Word 2007 中命令行开关的[链接](http://office.microsoft.com/en-us/word/HP101640101033.aspx?pid=CH100487461033)。您所描述的似乎没有这样的选项。/r 开关在注册表中重新注册 Word 并关闭。可能最好的方法是[下载 Word Viewer](http://www.microsoft.com/downloads/details.aspx?FamilyID=3657CE88-7CFA-457A-9AEC-F4F827F20CAC&DisplayLang=en)并使用它来打开文档，而不是 Word 本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T16:08:46.900

如果您可以选择编写一个小型 Web 组件，请编写一个获取 ID 并流出文档的组件，然后从报告链接到该服务。Web 服务器将制作文档的本地副本以供阅读。

当然，用户会因为他们的更改进入黑洞而感到沮丧，但听起来这可能是一个更好的问题。

[对于那些使用 Sharepoint 的人来说，有一个更好的答案](https://stackoverflow.com/questions/86033/how-do-i-make-a-microsoft-word-document-read-only-within-a-sharepoint-document "对于那些使用 sharepoint 的人来说，已经有了答案。")

# asp.net - 如何遍历自定义 vb.net 对象的每个属性？

> ID：314426
> 
> 赞同：41
> 
> 时间：2008-11-24T15:11:23.350
> 
> 标签：asp.net, vb.net, properties

如何查看自定义对象中的每个属性？它不是一个集合对象，但是对于非集合对象有这样的东西吗？

```
For Each entry as String in myObject
    ' Do stuff here...
Next 
```

我的对象中有字符串、整数和布尔属性。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-11-24T15:15:16.540

通过使用反射，您可以做到这一点。在 C# 中看起来像这样；

```
PropertyInfo[] propertyInfo = myobject.GetType().GetProperties(); 
```

* * *

添加了 VB.Net 翻译：

```
Dim info() As PropertyInfo = myobject.GetType().GetProperties() 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-11-24T15:22:08.350

您可以使用**System.Reflection**命名空间来查询有关对象类型的信息。

```
For Each p As System.Reflection.PropertyInfo In obj.GetType().GetProperties()
   If p.CanRead Then
       Console.WriteLine("{0}: {1}", p.Name, p.GetValue(obj, Nothing))
   End If
Next 
```

请注意，不建议在代码中使用这种方法代替集合。反射是一种性能密集型的东西，应该明智地使用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-11-17T12:35:31.580

System.Reflection 是“重量级”，我总是先实现更轻的方法..

//C＃

```
if (item is IEnumerable) {
    foreach (object o in item as IEnumerable) {
            //do function
    }
} else {
    foreach (System.Reflection.PropertyInfo p in obj.GetType().GetProperties())      {
        if (p.CanRead) {
            Console.WriteLine("{0}: {1}", p.Name, p.GetValue(obj,  null)); //possible function
        }
    }
} 
```

'VB.Net

```
 If TypeOf item Is IEnumerable Then

    For Each o As Object In TryCast(item, IEnumerable)
               'Do Function
     Next
  Else
    For Each p As System.Reflection.PropertyInfo In obj.GetType().GetProperties()
         If p.CanRead Then
               Console.WriteLine("{0}: {1}", p.Name, p.GetValue(obj, Nothing))  'possible function
          End If
      Next
  End If 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T15:16:49.297

您可以使用反射...使用反射，您可以检查类的每个成员（类型）、属性、方法、构造函数、字段等。

```
using System.Reflection;

Type type = job.GetType();
    foreach ( MemberInfo memInfo in type.GetMembers() )
       if (memInfo is PropertyInfo)
       {
            // Do Something
       } 
```

# .net - Starteam 不会签入添加到项目中的新文件

> ID：314432
> 
> 赞同：1
> 
> 时间：2008-11-24T15:13:57.230
> 
> 标签：.net, version-control, starteam

我正在使用 Visual Studio 2005 和 StarTeam 2008（跨平台客户端和 VS 集成）。在某个时候，我在项目中添加了一个“App.config”。我现在注意到这个文件不会签入。

1.  VS 中的“StarTeam Pending Checkins”窗口报告文件“不在视图中”。选择它进行签入并单击“签入文件”会导致出现一个对话框 - “任何操作...需要完成挂起的重命名/删除”。我单击“是”继续，但没有任何反应。

2.  StarTeam 客户端将此文件报告为“已修改”。如果我从客户端签入，我不会收到“完成挂起的重命名/删除”对话框，并且该文件很快就会显示为“当前”状态。

3.  从 VS 刷新 StarTeam，我仍然将文件视为“不在视图中”。

我试过强制签入。我完全删除了我的工作文件并重新提取了解决方案，希望 StarTeam 状态（“当前”）将适用于 VS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T15:18:28.297

我尝试删除文件以重新开始。

1.  我从 VS 和 StarTeam 客户端的项目中删除了它（也删除了工作文件）。
2.  我可以部分签入... VS 中的“StarTeam Pending Checkins”窗口将状态报告为“本地删除”
3.  我不知道如何完成“待删除”（我假设这是要求）。

StarTeam 客户端中没有该文件的踪迹……而且我找不到任何待处理的重命名/删除信息。我无法进一步强制签入 VS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T16:10:45.447

我不是 StarTeam 的专家，但此行为可能与已由 Windows 进程管理的文件一致，这将阻止 StarTeam 执行其签入操作。

如果签入 StarTeam 必须临时移动文件并重写它，这可能是与 Windows 进程冲突的原因，这将阻止对该文件的任何写入操作。

一个可能的检查是关闭 Visual Studio（以及所有其他非 StarTeam 程序，只是为了确定），然后尝试单独添加此文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:15:33.727

看来我解决了这个...

1.  我有一个具有更好凭据的同事将文件添加到同一个项目中。
2.  他成功登记入住。
3.  我吹走了我的工作文件并从 Visual Studio 中提取了解决方案。
4.  我将内容添加到文件中，查看修改后的状态，然后签入。

普通用户似乎没有删除权限（只是常规删除，而不是永久历史擦除删除）。在某些情况下，挂起的删除周期（是否由 StarTeam 管理？）不会执行，您也无法签入文件。

# wcf - 您如何等待/加入从 Silverlight 调用的 WCF Web 服务？

> ID：314433
> 
> 赞同：0
> 
> 时间：2008-11-24T15:13:57.900
> 
> 标签：wcf, silverlight, web-services

如果您像这样从 Silverlight 调用 Web 服务：

```
MyServiceClient serviceClient = new MyServiceClient();
void MyMethod()
{
  serviceClient.GetDataCompleted += new EventHandler<GetDataCompletedEventArgs>(serviceClient_GetDataCompleted);
  serviceClient.GetDataAsync();

  // HOW DO I WAIT/JOIN HERE ON THE ASYNC CALL, RATHER THAN BEING FORCE TO LEAVE THIS METHOD?

} 
```

我宁愿等待/加入“MyMethod”中的异步服务线程，而不是在调用“GetDataAsync”后离开“MyMethod”，最好的方法是什么？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-08T21:52:01.300

不，你不能这样做。你最终会陷入僵局。GetDataCompleted 由 mainthreed 调用。在 WaitOne 中等待的是同样的三人组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-10T15:20:46.723

I have to ask; why? The point is to provide your user with a fluid experience and waiting on a web service call will not necessarily do that. I suppose you want the full block of content to load before the Silverlight control loads. In that case, I would turn to caching the content rather than forcing the client to wait indefinitely.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T17:32:04.593

为此，您将在您的类（类级别变量）中使用[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent(VS.95).aspx)，然后等待它。

```
void MyMethod()
{
  wait = new ManualResetEvent(false);
  // call your service
  wait.WaitOne();
  // finish working
} 
```

并在您的事件处理程序代码中

```
void serviceClient_GetDataCompleted(...)
{
  // Set values you need from service
  wait.Set();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T13:39:39.167

您还可以使用 lambda 和闭包来获得类似的行为：

```
serviceClient.GetDataCompleted += (s,e) =>
{
  // Your code here
};
serviceClient.GetDataAsync(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-10T15:05:39.400

If you had a base class provide the mechanics of building a WCF channel, it could then be used to build the BeginX / EndX methods for a async call.

```
public class ServiceFooCoordinator : CoordinatorBase<IServiceFoo>
{
    public IAsyncResult BeginMethodFoo ()
    {
        IAsyncResult ar = null;
        IServiceFoo channel = null;
        channel = _factory.GetChannel();

        Begin( channel, () => ar = channel.BeginMethodFoo( null, channel ) );
        return ar;
    }

    public Bar[] EndMethodFoo ( IAsyncResult ar )
    {
        IServiceFoo channel = null;
        channel = _factory.GetChannel();
        return channel.EndMethodFoo( ar );
    }
} 
```

Which can then be used in a method:

```
 ServiceFooCoordinator _coordinator;

 var asyncResult = _coordinator.BeginMethodFoo();
 try
 {
   var result = _coordinator.EndMethodFoo( asyncResult );
 }
 catch ( Exception )
 { } 
```

Which gets you your asynchronous call in a sychronous manner.

# actionscript-3 - AS3 - 如何为加载程序分配名称或标签？

> ID：314437
> 
> 赞同：0
> 
> 时间：2008-11-24T15:15:19.270
> 
> 标签：actionscript-3, tags, loader

我有一个使用 Loader 类加载的图像列表，但我很难为它们分配唯一的名称。我需要唯一的名称，因为我想在一段时间后删除某些图像。有没有办法为加载程序分配一个名称或一些独特的标签，以便我以后可以删除它们？谢谢。

这是我的代码的一部分

```
for (var i = startnum; i < endnum; i++){
    var thumb = panels[i].@THUMB;
    var thumb_loader = new Loader();
    thumb_loader.load(new URLRequest(thumb));
    thumb_loader.contentLoaderInfo.addEventListener(Event.COMPLETE, thumbLoaded);

    thumb_loader.name = i;
    thumb_loader.x = (thumb_width + 20)*i;
} 
```

我试图在另一个函数中使用 getChildByName ..

```
var myLoader:Loader = getChildByName( "1" ) as Loader;
myLoader.unload(); 
```

但它给了我错误 #1009：无法访问空对象引用的属性或方法。

我试图把 thumb_loader 作为全局变量，然后这样做

```
var myLoader:Loader = thumb_loader.getChildByName( "1" ) as Loader; 
```

但它仍然无法正常工作。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T16:38:25.000

ActionScript 3 中的所有显示对象都有一个名称属性。每当您创建一个 Loader 对象时，您都可以为它分配一个名称，如下所示：

```
var myLoader:Loader = new Loader();
myLoader.name = "myUniqueName";
myLoader.load( .... );
addChild( myLoader ); 
```

如果您想通过您给它的名称来引用加载器，请使用 getChildByName() 方法。

```
var myLoader:Loader = getChildByName( "myUniqueName" ) as Loader;
myLoader.unload(); 
```

请注意，只有在您使用 addChild() 将 Loader(s) 添加到显示列表后，getChildByName() 才会起作用。否则，您必须创建一些东西来存储对 Loader 对象的引用，例如一个数组，并通过该数组引用加载程序。例如，在您的循环之外，您可以创建一个名为 loaderArr 的数组。在您的循环中，您将执行以下操作：

```
loadersArr["uniqueName"] = thumb_loader; 
```

然后，您可以通过 loadersArr 数组以您的唯一名称引用您的加载程序。

```
var loaderToUnload:Loader = loadersArr["uniqueName"];
loaderToUnload.unload(); 
```

如果没有看到更多代码，很难理解此代码所在的范围以及可能尝试引用这些加载器的任何其他代码所在的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T15:29:32.987

不确定我 100% 理解你的问题，但是为什么不把它们放在一个对象映射而不是一个列表中，如果你没有它们，为它们生成唯一的名称......

```
var img:Image;
var img_map:Object = new Object();
var last_added:int = 0;
for each (img in yourListOfImages)
{
    img_map["img_"+last_added] = img;
    last_added++;
} 
```

根据您的环境（Flex 或 Flash），您可以使用 UID 生成器而不是我上面简单的唯一名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T15:31:06.227

```
package 
{
    import flash.display.Loader;

    public dynamic class DynamicLoader extends Loader 
    {
        public function DynamicLoader()
        {
            super();
        }
    }
} 
```

我相信 Loader 类是一个密封的类，所以你会想要创建这个类并使用它而不是普通的 Loader 类来给它你想要的任何属性。我还相信，如果不使用此 DynamicLoader 而不是普通的 Loader，Loader 类确实具有可用的 name 属性。

# html - 除了对表单进行分组之外，使用 fieldset HTML 标记是否还有意义？

> ID：314457
> 
> 赞同：26
> 
> 时间：2008-11-24T15:21:50.020
> 
> 标签：html, fieldset, semantics

通常，我在表单中看到过它，但我发现将相关的数据集分组很有帮助（例如，当您在页面上有多个表时，使用每个表或相关表组周围的字段集来定义可见的含义和组名（图例））。这是否滥用了 fieldset 标签，在我的使用中，它不再具有语义意义？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-24T15:31:09.707

我相信这将是滥用。[http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.10](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.10) 声明“FIELDSET 元素允许作者对主题相关的[控件](http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.2.1)和标签进行分组”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T19:22:28.147

名称中的“字段”位`fieldset`指的是`<form>`字段。

使用`fieldset`outside `form`s 对任意数据进行分组显然是语义滥用。

但是，您的 HTML 将通过验证，上帝**不会**杀死小猫。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T15:34:48.013

[fieldset](http://htmlhelp.com/reference/html40/forms/fieldset.html)是关于**表单控制组**的。通过对相关的表单控件进行分组，作者可以将表单分成更小、更易于管理的部分，从而改善用户在使用太多表单控件时可能发生的可用性灾难。

这并不[意味着字段集总是对表单中的字段进行分组](http://drupal.org/node/233928)，即使规范仅在用户与表单交互的上下文中讨论字段集...

因此，“滥用”可能来自 HTML 4 和 XHTML 规范不要求字段集和图例包含在表单元素中的事实。FIELDSET 甚至可以是 BODY 元素的子元素。将字段集放在表单之外是有效的语法。

但是，当您将某些东西描述为不是真正的字段集的字段集时，您只会引起混淆。

最好将 HTML / XHTML 标记视为描述元素的含义而不是其外观。然后你可以使用 CSS 使元素看起来像你想要的任何东西。

如果您出于演示目的对数据进行分组，您可以在这里找到一个[不错的 CSS 替代方案](http://www.webdesign.org/web/html-and-css/tutorials/emulating-the-fieldset-element.11130.html)。

以供参考：

```
.fieldset {
border-right: 1px solid #75736E;
border-bottom: 1px solid #75736E;
border-left: 1px solid #F2F0EE;
border-top: 1px solid #F2F0EE;
padding: 10px 3px 3px 3px;

}

.outer {
border-left: 1px solid #75736E;
border-top: 1px solid #75736E;
border-right: 1px solid #F2F0EE;
border-bottom: 1px solid #F2F0EE;
width: 200px; /* CHANGE THIS FOR BOX SIZE */
} 

.legend {
float: left;
margin-left: 15px;
margin-top: -8px;
padding-left: 5px;
padding-right: 5px;
font-weight: bold;
background: #FFF;
} 

<div class="legend">Lipsum.com Is The Best</div>
<div class="outer">
<div class="fieldset">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. 
Donec congue fermentum metus. Quisque vel ante. 
Cras purus metus, dignissim at, luctus et, sollicitudin eget, urna. 
Maecenas eget lacus. Aenean bibendum risus non erat mattis semper. 
Aliquam placerat nibh eget lacus. Sed blandit eleifend justo. Nam elit. 
Fusce feugiat orci id eros facilisis laoreet. 
Integer vestibulum condimentum purus. 
Proin vehicula congue lacus. Quisque placerat diam nec enim. 
Nunc lorem. Maecenas nec sem sed nulla tristique faucibus.</div></div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T19:15:15.510

如果要对表进行分组，请考虑为每个组使用适当的标题 (h1-h6) 元素。可以使用“[标题](http://www.w3.org/TR/REC-html40/struct/tables.html#h-11.2.2)”元素来描述各个表格。'summary' 属性也可用于每个表。

从规范：

> 每个表格都可能有一个相关的标题（参见 CAPTION 元素），它提供了表格用途的简短描述。为了使用语音或基于盲文的用户代理的人们的利益，也可以提供更长的描述（通过摘要属性）。

并且为了记录，“fieldset”元素不打算在表单之外使用。在表单中，它旨在在概念上对输入字段进行分组 - 例如“个人信息”或“账单地址”等。

这是一篇有趣的文章，讨论了屏幕阅读器用户在导航字段集时听到的内容。[http://www.rnib.org.uk/wacblog/articles/too-much-accessibility/too-much-accessibility-fieldset-legends/](http://www.rnib.org.uk/wacblog/articles/too-much-accessibility/too-much-accessibility-fieldset-legends/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T15:30:41.750

fieldset 标签也可用于屏幕阅读器和其他一些辅助技术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-29T18:23:04.930

我可以看到将内容阻塞到带有图例的字段集中的语义优势。

尽管 W3C 将字段集和图例的使用与表单相关联，但允许在表单标签之外使用为实验开辟了新的界限。可能类似于使用中的定义列表。

我个人不认为 fieldset 中的“字段”特定于表单字段。它只是从它在表单标签中的使用继承关系。字段参考分组。

想象一下去您当地的公园和娱乐场所与您的朋友一起打垒球。有 3 个可用字段。他们的围栏上都有“仅限棒球”的标志

你收拾行装回家了吗？

在表单标签滥用之外标记字段集和图例的使用是狭隘的。

定义中没有提到形式：

> FIELDSET 元素允许作者对主题相关的控件和标签进行分组。分组控件使用户更容易理解他们的目的，同时促进视觉用户代理的选项卡导航和面向语音的用户代理的语音导航。正确使用此元素使文档更易于访问。

我考虑xhtml标签格式控制。div p 块引用等

```
<h1>The Big Book about Everything</h1>
<fieldset>
    <legend>Jokes</legend>
    <h2>30 pages of humorous Jokes</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    <p>Cras nec diam eu lectus condimentum faucibus in et odio.</p>
</fieldset>
<fieldset>
    <legend>Poems</legend>
    <h2>20 pages of well written poems</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    <p>Cras nec diam eu lectus condimentum faucibus in et odio.</p>
</fieldset>
<fieldset>
    <legend>Horror</legend>
    <h2>3 Short and scary stories</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    <p>Cras nec diam eu lectus condimentum faucibus in et odio.</p>
</fieldset>
<fieldset>
    <legend>Mystery</legend>
    <h2>3 Short and mysterious stories</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    <p>Cras nec diam eu lectus condimentum faucibus in et odio.</p>
</fieldset> 
```

# c# - 使用 Transaction Binding=Explicit Unbind 时连接不会关闭；在连接字符串中

> ID：314459
> 
> 赞同：5
> 
> 时间：2008-11-24T15:22:12.500
> 
> 标签：c#, sql-server, transactions, timeout, connection-string

我在[此处](http://weblogs.asp.net/ryangaraygay/archive/2008/04/14/issue-with-system-transactions-sqlconnection-and-timeout.aspx)`Transaction Binding=Explicit Unbind`推荐的连接字符串中使用，因为我也在使用带有超时的 TransactionScope。问题是连接似乎在被处理后并没有关闭，最终连接池中没有更多可用的连接。当我修改 TransactionTimeoutIssueDemo（请参阅链接）并在循环中运行 TransactionScopeTest()（使用显式取消绑定连接字符串）足够多次以用完连接池中的所有可用连接时，我得到了相同的结果。池中连接的默认值为 100，但这可以通过使用设置来更改。即使 SqlConnection 和 TransactionScope 都与`Max Pool Size =10``using`条款。有谁知道如何处理这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T19:10:06.237

连接似乎只保留在池中并且不会被重用以防万一出现异常，就像示例一样。如果您增加超时，连接将被重用。

解决此问题的方法是清除连接池，以防出现如下异常：

```
using (SqlConnection con = new SqlConnection(connectionString))
{
    con.Open();
    try
    {
        Console.WriteLine("Server is {0}", con.ServerVersion);
        Console.WriteLine("Clr is {0}", Environment.Version);
        for (int i = 0; i < 5; i++)
        {
            using (SqlCommand cmd = con.CreateCommand())
            {
                cmd.CommandText = "insert into TXTEST values ( " + i + " )";
                cmd.ExecuteNonQuery();
            }
            Console.WriteLine("Row inserted");
        }
        Thread.Sleep(TimeSpan.FromSeconds(1));
    }
    catch
    {
        SqlConnection.ClearPool(con);
        throw;
    }
} 
```

在大多数情况下，事务将在超时内完成，一切都会很好。当事务**实际**超时时，您清除池以清除不会被重用的脏连接。这当然会影响池中不受此问题影响的其他连接。

这是一个丑陋的解决方法，但它似乎有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-20T01:29:08.147

值得一提的是，这个问题在 .Net 4.0 中得到了修复。

# tfs - 我可以覆盖 DropLocation 目标以避免网络延迟吗？

> ID：314463
> 
> 赞同：0
> 
> 时间：2008-11-24T15:23:42.263
> 
> 标签：tfs, msbuild, tfsbuild

在 Team Build 2008 中，构建的放置位置不再在 .proj 文件中指定，而是存储在数据库中并在 GUI 工具中维护。

GUI 工具只接受网络路径作为放置位置（即\\server\share），不接受本地路径。

我们的构建服务器还托管删除的文件，因此在复制大量文件时，强制文件复制操作通过网络共享似乎会引入很多延迟时间。我想覆盖此功能，以便我可以指定放置位置的本地目录，但我不知道如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-03T22:06:20.577

我没有使用 2008 版本，只有 2005 版本，但您似乎可以手动执行此操作。将 SkipDropBuild 属性设置为 true。然后使用 Team Build 内置的 Copy 命令在 BeforeDropBuild 事件中手动复制所有二进制文件。

像这样的东西：

```
<SourceDir>$(SolutionRoot)\..\Binaries\Release</SourceDir>
<SkipDropBuild>true</SkipDropBuild>
<CreateItem Include="$(SourceDir)\**\*.*">
        <Output TaskParameter="Include" ItemName="BuiltBinaries"/>
</CreateItem>
<Target Name ="BeforeDropBuild">
        <Copy SourceFiles="@(BuiltBinaries)" DestinationFiles="@(BuiltBinaries->'C:\droplocation\%(Filename)%(Extension)')"/>
</Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-07T22:43:44.370

实际的 BuildDropLocation 需要在网络共享上可用。发布测试结果时，客户端和 TFS 应用程序层将使用放置位置。在访问构建结果时，客户端和 TFS 应用程序层机器也需要可以访问它。作为数据仓库步骤的一部分，TFS 应用程序层机器将通过放置位置访问构建结果，以查找要添加到仓库的测试结果文件。

也就是说，假设您的构建服务器是托管您的放置位置共享的*同一*台机器 - 并且始终是同一台机器，那么您可以跳过 TFSBuild.proj 中的放置步骤。一种解决方案可能是[Todd](https://stackoverflow.com/questions/314463/can-i-override-droplocation-target-to-avoid-network-latency/338920#338920)和[Chad](https://stackoverflow.com/questions/314463/can-i-override-droplocation-target-to-avoid-network-latency/352663#352663)概述的方法的组合，例如：

```
<SkipDropBuild>true</SkipDropBuild>
<Target Name ="AfterDropBuild">
        <Exec Command="move $(BinariesRoot)\Release d:\BuildOutput\$(BuildNumber)\Release"/>
</Target> 
```

请注意，您实际上不必对“Release”部分进行硬编码，而是能够从配置属性中获取它 - 但是我没有我的 TeamBuild 目标文件，所以我不能确切地说那是什么所以当我回到我的办公桌并相应地编辑这个答案时，我会查找它。

也就是说，这样做有很多风险。

1.  您必须确保所有文件路径排列正确，否则查看构建日志或使用测试结果填充 TFS 仓库等操作可能会停止工作
2.  您将硬编码构建和放置位置以始终存在于同一台机器上。如果有人试图在另一台机器上构建您的 TFSBuild.proj 文件，那么事情将不会像他们预期的那样工作
3.  如果有人在构建定义中编辑放置位置属性，那么他们必须知道在 TFSBuild.proj 文件中进行相应的编辑

因此，由于这种方法涉及的可维护性问题 - 在绝大多数情况下我不会推荐它。值得做一个测试，看看这实际上节省了多少时间，以确定它在您的情况下是否值得优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-09T13:12:00.230

我找到了一个更简单的解决方案，那就是在 Release 文件夹上*移动文件系统。*由于放置位置实际上位于同一个物理驱动器上，我可以接受。我已将此添加到 TFSBuild.proj 文件中：

```
<Target Name="CoreDropBuild"
        Condition=" '$(SkipDropBuild)'!='true' and '$(IsDesktopBuild)'!='true' "
        DependsOnTargets="$(CoreDropBuildDependsOn)" >
    <Exec Command="move $(BinariesRoot)\Release d:\BuildOutput\$(BuildNumber)\Release"/>
</Target> 
```

# css - 信息路径表单的 CSS 样式

> ID：314464
> 
> 赞同：6
> 
> 时间：2008-11-24T15:24:41.730
> 
> 标签：css, infopath

有没有办法为 Forms Server 2007 呈现的​​ InfoPath 2007 表单设置 CSS 样式？它似乎有点像“黑匣子”，但 Infopath 客户端中的格式化选项非常有限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-16T09:36:13.643

这是与您的问题相关的博文。

[http://www.infopathdev.com/blogs/greg/archive/2005/06/07/Add-a-Custom-Style-Sheet-to-a-View.aspx](http://www.infopathdev.com/blogs/greg/archive/2005/06/07/Add-a-Custom-Style-Sheet-to-a-View.aspx)

# c# - 循环浏览内容页面中的下拉列表 - VS2008

> ID：314465
> 
> 赞同：1
> 
> 时间：2008-11-24T15:25:11.950
> 
> 标签：c#, asp.net

我有一个 MasterPage 和一个 Content Page

我的内容页面有许多控件， - 下拉列表、文本框、单选按钮。

我想遍历所有控件，如果它是上面的控件之一，那么我想获取选定的值、文本等

我知道我可以通过名称直接访问控件，但由于这是我在 asp.net 上的学习经历，我希望能够通过 Controls 集合

我试过了

```
foreach(Controls ctrl in Master.Controls)
{
} 
```

但我无法使用我需要的控件。

编辑:: 我想我拔枪的速度有点太快了，因为我的智能一直对我失败。我在内容页面上的代码中解决了我的问题

```
protected void btnSearch_Click(object sender, EventArgs e)
        {
            foreach (Control ctrl in Master.Controls)
            {
                if (ctrl is HtmlForm)
                {
                    foreach(Control formControl in ctrl.Controls)
                    {
                        if (formControl is ContentPlaceHolder)
                        {
                            foreach (Control placeHolderControl in formControl.Controls)
                            {
                                if (placeHolderControl is DropDownList)
                                {
                                    string test = "AA";
                                }
                            }
                        }
                    }

                }

            }
        } 
```

现在建立一个递归例程

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T15:56:08.970

控件处于层次结构中。页面中唯一的控件通常是一个表单（但并非总是如此）。该表单包含出现在`<form>`标记中的控件。例如，如果表单中有 a `<p runat="server">`，则`<p>`遗嘱将包含出现在其中的所有控件。

例如，

```
<form runat="server">
  <p runat="server">
    <asp:Label runat="server" />
    <asp:TextBox runat="server" />
  </p>
  <p runat="server">
    <asp:Button runat="server" />
  </p>
</form> 
```

将产生以下结构：

```
form
 - p
   - label
   - textbox
 - p
   - button 
```

因此，您必须遍历直接包含控件中的控件。

- 编辑：

此外，要遍历所有控件，您需要递归或迭代地循环到层次结构中

```
// This is the recursive version
public void LoopControl(Control parent) {
    foreach (Control control in parent) {
        // do stuff
        LoopControl(control);
    }
}

// And then
LoopControl(Page); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T15:53:30.970

如果您尝试从母版页访问内容页控件，则需要通过适当的 ContentPlaceHolder（在母版页上）访问这些控件。像这样的东西：

```
foreach (Control c in ContentPlaceHolder1.Controls)
{
    Response.Write(c.ID );
} 
```

# c# - 生成字母表中的字母数组

> ID：314466
> 
> 赞同：101
> 
> 时间：2008-11-24T15:25:46.113
> 
> 标签：c#, alphabet

有没有一种简单的方法可以在 C# 中生成一个包含字母的数组？手动完成并不难，但我想知道是否有内置的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2008-11-24T15:29:27.790

我认为没有内置的方法，但我认为最简单的方法是

```
 char[] alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray(); 
```

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2008-11-24T15:39:08.160

C# 3.0：

```
char[] az = Enumerable.Range('a', 'z' - 'a' + 1).Select(i => (Char)i).ToArray();
foreach (var c in az)
{
    Console.WriteLine(c);
} 
```

是的，即使 Enumerable.Range 的唯一重载接受 int 参数，它也确实有效；-)

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2011-08-11T04:50:28.647

```
for (char letter = 'A'; letter <= 'Z'; letter++)
{
     Debug.WriteLine(letter);
} 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2014-02-14T02:56:17.387

```
char[] alphabet = Enumerable.Range('A', 26).Select(x => (char)x).ToArray(); 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2011-03-11T10:43:18.707

我写这个是为了获得基于 1 的索引的 MS excel 列代码（A、B、C、...、Z、AA、AB、...、ZZ、AAA、AAB、...）。（当然，切换到从零开始只是简单地离开`column--;`开始。）

```
public static String getColumnNameFromIndex(int column)
{
    column--;
    String col = Convert.ToString((char)('A' + (column % 26)));
    while (column >= 26)
    {
        column = (column / 26) -1;
        col = Convert.ToString((char)('A' + (column % 26))) + col;
    }
    return col;
} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-11-24T15:36:08.120

假设你的意思是英文字母......

```
 for ( int i = 0; i < 26; i++ )
    {
        Console.WriteLine( Convert.ToChar( i + 65 ) );
    }
    Console.WriteLine( "Press any key to continue." );
    Console.ReadKey(); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-24T15:35:41.477

您可以根据字符的 ascii 值执行以下操作：

```
char[26] alphabet;

for(int i = 0; i <26; i++)
{
     alphabet[i] = (char)(i+65); //65 is the offset for capital A in the ascaii table
} 
```

[（请参阅此处](http://enteos2.area.trieste.it/russo/IntroInfo2001-2002/CorsoRetiGomezel/ASCII-EBIC_files/ascii_table.jpg)的表格。）您只是从字符的 int 值转换为字符值 - 但是，这只适用于 ascii 字符而不是不同的语言等。

**编辑：** 正如[Mehrdad](https://stackoverflow.com/users/33708/mehrdad)在对类似解决方案的评论中所建议的，最好这样做：

```
alphabet[i] = (char)(i+(int)('A')); 
```

这会将 A 字符转换为它的 int 值，然后基于此递增，因此它不是硬编码的。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-24T16:49:13.387

还要注意，字符串有一个 operator[]，它返回一个 Char，并且是一个`IEnumerable<char>`，所以在大多数情况下，您可以将一个字符串用作 char[]。因此：

```
string alpha = "ABCDEFGHIJKLMNOPQRSTUVQXYZ";
for (int i =0; i < 26; ++i)
{  
     Console.WriteLine(alpha[i]);
}

foreach(char c in alpha)
{  
     Console.WriteLine(c);
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-12-18T11:15:23.873

令人惊讶的是，没有人提出产量解决方案：

```
public static IEnumerable<char> Alphabet()
{
    for (char letter = 'A'; letter <= 'Z'; letter++)
    {
        yield return letter;
    }
} 
```

例子：

```
foreach (var c in Alphabet())
{
    Console.Write(c);
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-09-26T13:06:10.460

```
var alphabets = Enumerable.Range('A', 26).Select((num) => ((char)num).ToString()).ToList(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-19T22:33:22.710

```
char alphaStart = Char.Parse("A");
char alphaEnd = Char.Parse("Z");
for(char i = alphaStart; i <= alphaEnd; i++) {
    string anchorLetter = i.ToString();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-16T11:36:42.537

```
//generate a list of alphabet using csharp
//this recurcive function will return you
//a string with position of passed int
//say if pass 0 will return A ,1-B,2-C,.....,26-AA,27-AB,....,701-ZZ,702-AAA,703-AAB,...

static string CharacterIncrement(int colCount)
{
    int TempCount = 0;
    string returnCharCount = string.Empty;

    if (colCount <= 25)
    {
        TempCount = colCount;
        char CharCount = Convert.ToChar((Convert.ToInt32('A') + TempCount));
        returnCharCount += CharCount;
        return returnCharCount;
    }
    else
    {
        var rev = 0;

        while (colCount >= 26)
        {
            colCount = colCount - 26;
            rev++;
        }

        returnCharCount += CharacterIncrement(rev-1);
        returnCharCount += CharacterIncrement(colCount);
        return returnCharCount;
    }
}

//--------this loop call this function---------//
int i = 0;
while (i <>
    {
        string CharCount = string.Empty;
        CharCount = CharacterIncrement(i);

        i++;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-09-28T20:42:03.687

**在控制台中获取英文字母的 4 种方法：**

```
public void ShowEnglishAlphabet()
{
    var firstLetter = 'a';
    var endLetter = 'z';
    for (var letter = firstLetter; letter <= endLetter; letter++)
    {
        Console.WriteLine($"{letter}-{letter.ToString().ToUpper()}");
    }
}

public void ShowEnglishAlphabetFromUnicodeTableDecNumber()
{
    var firstLetter = 97;
    var endLetter = 122;
    for (var letterNumberUnicodeTable = firstLetter; 
    letterNumberUnicodeTable <= endLetter; letterNumberUnicodeTable++)
    {
        Console.WriteLine($"{(char)letterNumberUnicodeTable}- 
        {((char)letterNumberUnicodeTable).ToString().ToUpper()}");
    }
}

public void ShowEnglishAlphabetUnicodeTableEscapeSequence()
{
    var firstLetter = '\u0061';
    var endLetter = '\u007A';
    for (var letterNumberUnicodeTable = firstLetter; 
    letterNumberUnicodeTable <= endLetter; letterNumberUnicodeTable++)
    {
        Console.WriteLine($"{letterNumberUnicodeTable}- 
        {letterNumberUnicodeTable.ToString().ToUpper()}");
    }
}   

public void ShowEnglishAlphabetUnicodeTableLinq()
{
    var alphabets = Enumerable.Range('a', 26).Select(letter => 
    ((char)letter).ToString()).ToList();
    foreach (var letter in alphabets)
    {
        Console.WriteLine($"{letter}-{letter.ToUpper()}");
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-10-31T14:08:04.537

不幸的是，没有现成的方法。

您可以使用; char[] characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray();

# multithreading - SharePoint 和线程安全

> ID：314467
> 
> 赞同：2
> 
> 时间：2008-11-24T15:25:52.883
> 
> 标签：multithreading, sharepoint, moss, thread-safety

我正在寻找有关 SharePoint 和线程安全的文章、论坛或博客文章？我很确定在使用 SharePoint 对象模型时必须考虑有关线程安全的一些特殊方面。

其实我还没有找到很多关于这方面的信息。

所以我很期待你的回答。

再见，弗洛

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T15:46:49.097

SharePoint OM 中的陷阱比普通的旧线程安全要严重得多。特别注意使用从属性中检索到的对象。在处理对象时，您应该*始终*保留指向对象的指针；例子：

```
var list = web.List["MyList"]
list.Items[0]["Field1"] = "foo"
list.Items[0]["Field2"] = "bar"
list.Items[0].Update() // nothing is updated! 
```

您可能希望 Field1 和 Field2 会在最后的 Update() 调用中更新，但不是。每次使用索引器时，都会返回一个对 SPListItem 的新引用。

正确方法：

```
SPListItem item = list.Items[0]
item["Field1"] = "foo"
item["Field2"] = "bar"
item.Update() // updated! 
```

只是一个开始。也谷歌搜索围绕 IDisposabe/Dispose 模式的陷阱。

-Oisin

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T15:59:42.113

我经常遇到一个问题：在编写自己的列表项接收器时，您需要注意一些事件是异步触发的，例如`ItemAdded()`，这意味着*您的代码*可能同时在多个线程中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:14:10.170

因此，在进行了更多的谷歌搜索和网络搜索和测试之后，似乎在使用 MOSS 对象模型时您不必那么关心线程安全性，因为您总是在使用非静态和唯一实例.

此外，如果在保存更改之前调用 Update() 方法（也调用 Update() 方法）更改并保存了一个对象（例如 SPWeb），即使您首先获得了对象，也会引发异常。

在下面的示例中，该指令`web11.Update()`将抛出一个异常，告诉您通过对象 web12 表示的 SPWeb 已同时更改。

```
SPSite siteCol1 = new SPSite("http://localhost");      

SPWeb web11 = siteCol1.OpenWeb();
SPWeb web12 = siteCol1.OpenWeb();                               

web12.Title = "web12";
web12.Update();

web11.Title = "web11";
web11.Update(); 
```

所以线程安全似乎是由对象模型本身处理的。当然，您必须处理由于竞争条件而可能引发的异常。

# .net - 在 TFS 源代码管理中更改用户名后的工作区问题

> ID：314468
> 
> 赞同：2
> 
> 时间：2008-11-24T15:25:53.257
> 
> 标签：.net, visual-studio-2008, tfs, version-control

出于某种原因，系统管理员在源代码控制系统中将我的用户名从 XxXx 更改为 XxXx1。然后问题开始了。我必须删除所有本地文件并从源代码管理重新下载它们才能打开项目。

在我重新启动计算机后，我无法对我的文件做太多事情。每当我尝试撤消结帐时，都会收到以下消息：

> TF14098：访问被拒绝：用户 DOMAIN\XxXx 需要 $/blablabla 的 UndoOther 权限

所以它仍在尝试使用我的旧用户名。用户名和密码存储在某个地方，因为我在启动 VS2008 时不必输入它。也许通过资源管理器（我想我用它浏览到 tfs 服务器并保存了用户名和密码）。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T05:20:52.447

一个选项是作为项目管理员撤消您的更改，然后在您的新用户名下再次重新签出这些文件（无需获取）。第一部分就像您正在[撤消另一个用户的更改](http://dotnet.org.za/willy/archive/2008/07/23/tfs-undoing-a-checkout-of-another-user.aspx)

要解锁文件，请使用[tf.exe 命令行](http://msdn.microsoft.com/en-us/library/z51z7zy0(VS.80).aspx)

```
tf undo "$/MyProject/VersionX/Utils/file.cs" /WORKSPACE:MaorDev;Domain\User  /server:MyServerName /recursive 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T08:41:53.147

放弃其他一切后，我删除了本地工作区并创建了一个新工作区。现在一切正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T18:28:47.040

您是否检查过以确保 Active Directory 更改已传播到 TFS？在更改用户信息并且 TFS 没有接受更改并对您的用户感到困惑之前，我已经看到了问题。

另请查看以下博客文章。它详细介绍了如何将 TFS 与 Active Directory 中的用户名更改同步

[http://blogs.msdn.com/teams_wit_tools/archive/2007/03/15/handling-display-name-changes-in-team-foundation-server.aspx](http://blogs.msdn.com/teams_wit_tools/archive/2007/03/15/handling-display-name-changes-in-team-foundation-server.aspx)

# vb.net - 表中没有数据时在 Infragistics ULTRAGRID 中显示标题

> ID：314481
> 
> 赞同：3
> 
> 时间：2008-11-24T15:30:42.593
> 
> 标签：vb.net, sql-server-2005, header, infragistics, ultrawingrid

我正在使用 VB.Net 中的 DataSet 从 SQL 表中获取数据。当表格中有数据时，它会在表格中正常显示数据，但是当表格中没有数据时，它只显示UltraGrid的基本视图。

即使表中没有数据，如何将表的列名显示为 UltraGrid 的标题？

* * *

感谢您的回复，但我认为 JD 遇到的问题与我的有点不同 - 在我的应用程序中，数据是从 SQL Server 正确获取的。我的问题是，当表格中没有数据时，我想将表格的列显示为 0 行的网格的标题。这没有发生。

它只显示一个消息框，说明未找到数据，并且 UltraGrid 显示为默认情况下在应用程序中的显示方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T15:32:53.697

这在[此 Infragistics 论坛主题](http://forums.infragistics.com/forums/p/15503/61008.aspx)中进行了讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T14:58:47.103

你知道列的标题是什么，还是根据表中的数据动态的？如果您事先知道，您可以在空数据集中创建具有适当标题的列，并将其分配给网格数据源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T15:16:49.263

当我手动创建数据表并将其分配为网格的数据源时，我注意到了同样的行为。如果数据表为空，则先前在网格上设置的所有列标题信息都将丢失。我对此的解决方案是永远不要给它一个空表，如果我的表中没有行，至少定义所有列。

```
DataTable table = new DataTable("fooTable");
table.Columns.Add("fooCol1", typeof(long));
table.Columns.Add("fooCol2", typeof(string));
table.Columns.Add("fooCol3", typeof(bool));
myUltraGrid.DataSource = table; 
```

通过从不将网格设置为空表，您可以保留标题信息。

# vba - 为 MS Word 添加自定义自动文本

> ID：314487
> 
> 赞同：0
> 
> 时间：2008-11-24T15:32:21.637
> 
> 标签：vba, ms-word

我需要知道如何为 Microsoft Word 添加自定义的动态自动文本条目。我希望能够插入>自动文本>页眉/页脚>“上周五”，并在现场显示上周五的日期并保持更新，就像每次打开文档时插入日期自动文本更新一样。

我有计算上周五日期所需的 VB 代码并将其作为字符串返回，但我无法找到如何将函数的输出绑定到新的自动文本条目。

也可以将自定义条目添加到“插入”>“字段”列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-22T08:38:56.593

这里有另一个线程

[http://www.tech-archive.net/Archive/Word/microsoft.public.word.vba.beginners/2007-02/msg00050.html](http://www.tech-archive.net/Archive/Word/microsoft.public.word.vba.beginners/2007-02/msg00050.html)

这可能为您提供解决方案。

# c++ - 有没有一种简单的方法来对 char* 的数组进行排序？C++

> ID：314492
> 
> 赞同：4
> 
> 时间：2008-11-24T15:33:56.220
> 
> 标签：c++, sorting, in-place, external-sorting

我`char*`在一个文件中有一个数组。我工作的公司将数据存储在平面文件中。有时数据是排序的，但有时不是。我想对文件中的数据进行排序。

现在我可以从头开始编写代码来做到这一点。有没有更简单的方法？

当然，就地排序将是最好的选择。我正在处理大文件并且内存很小。但我会考虑所有选项。

所有字符串的长度相同。

这是一些示例数据：

```
the data is of fixed length
the Data is of fixed length
thIS data is of fixed lengt 
```

这将表示长度为 28 的三个记录。应用程序知道长度。每条记录都以 CRLF ( `\r\n`) 结尾，尽管这对于这种排序无关紧要。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T15:45:24.840

```
template<size_t length> int less(const char* left, const char* right) {
    return memcmp(left, right, length) < 0;
}

std::sort(array, array + array_length, less<buffer_length>); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T15:59:04.330

如果您无法将数据放入 RAM，请使用 GNU 排序程序（外部）：它将对任意大小的文件进行排序，文件越大，创建进程的额外成本就越小。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-24T15:54:47.270

您可以在数组本机数据类型上使用 STL 中的算法，而不仅仅是在 STL 容器上。但是，使用 std::sort 的另一个建议不会像发布的那样起作用，因为 strcmp 返回一个值，当字符串不相同时，所有比较的结果都为 true，而不仅仅是左侧小于右侧手边——这是 std::sort 想要的；左侧返回 true 的二元谓词小于右侧。

这有效：

```
struct string_lt : public std::binary_function<bool, char, char>
{
    bool operator()(const char* lhs, const char* rhs)
    {
        int ret = strcmp(lhs, rhs);
        return ret < 0;
    }
};

int _tmain(int argc, _TCHAR* argv[])
{
    char* strings [] = {"Hello", "World", "Alpha", "Beta", "Omega"};
    size_t numStrings = sizeof(strings)/sizeof(strings[0]);

    std::sort(&strings[0], &strings[numStrings], string_lt());

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T16:09:28.660

`boost::bind`可以做到：

```
// ascending
std::sort(c, c + size,  boost::bind(std::strcmp, _1, _2) < 0); 

// descending
std::sort(c, c + size,  boost::bind(std::strcmp, _1, _2) > 0); 
```

**编辑**：字符串不是以空结尾的：

```
// ascending
std::sort(c, c + array_size,  boost::bind(std::memcmp, _1, _2, size) < 0); 

// descending
std::sort(c, c + array_size,  boost::bind(std::memcmp, _1, _2, size) > 0); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T15:46:42.717

可能最简单的方法是使用旧的 stdlib.h 函数 qsort。这应该有效：

```
qsort( array, num_elements, sizeof( char* ), strcmp ) 
```

请注意，这是标准 C，仅适用于英文文本。

如果您有一个 String 对象列表，那么在 C++ 中可以进行其他操作。

如果您在 Linux 上编写 gtk 或 Qt 应用程序，那么我建议您事先查看这些库。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T15:50:34.160

如果文件很大并且不适合 RAM，您可以使用[bin/bucket](http://en.wikipedia.org/wiki/Bucket_sort)排序将数据拆分为较小的文件，最后将这些片段聚合到一个结果文件中。其他响应向您展示如何对每个单独的存储桶文件进行排序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T17:19:19.893

在 C 中对字符串数组进行排序的规范方法，因此在 C++ 中是一种可用但不一定推荐的方法，它使用以下间接级别`strcmp()`：

```
static int qsort_strcmp(const void *v1, const void *v2)
{
    const char *s1 = *(char * const *)v1;
    const char *s2 = *(char * const *)v2;
    return(strcmp(s1, s2));
}

static void somefunc(void)   // Or omit the parameter altogether in C++
{
    char **array = ...assignment...
    size_t num_in_array = ...number of char pointers in array...
    ...
    qsort(array, num_in_array, sizeof(char *), qsort_strcmp);
    ...more code...
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T13:46:41.477

我想到了几件事：

1.  如果您的数据太大而无法放入内存，您可能只想在内存中建立文件偏移量的索引，然后对文件进行内存映射以访问字符串（取决于您的操作系统）。
2.  就地将需要*大量*内存副本。如果可以，请使用 shell 排序。然后，一旦您知道最终顺序，就可以更容易地在线性时间内就地重新排序字符串。
3.  如果字符串的长度都相同，那么您*真的*需要基数排序。如果您不熟悉基数排序，这里的基本思想是：基于比较的排序（即 what `std::sort`、`qsort`和任何其他通用排序）总是需要 O(N log N) 时间。基数排序一次比较单个数字（从K 长度的字符串开始`str[0]`和结束），并且总体上只需要 O(N) 时间来执行。`str[K-1]`

有关基数排序算法的详细描述，请参阅 Internet，这比我能提供的要好得多。除了我所说的之外，我会避免使用所有其他使用标准图书馆分类设施的解决方案。不幸的是，它们并不是为您设计的特定问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-26T17:58:00.377

您可能想查看 POSIX 上的内存映射文件（请参阅[http://en.wikipedia.org/wiki/Memory-mapped_file](http://en.wikipedia.org/wiki/Memory-mapped_file)）、 mmap() 函数（[http://en.wikipedia.org/wiki/Mmap](http://en.wikipedia.org/wiki/Mmap)）-投诉操作系统。您实际上将获得一个指向表示文件内容的连续内存的指针。

好的一面是操作系统会负责将文件的一部分加载到内存中，并根据需要再次卸载它们。

一个缺点是，如果多个进程可能访问该文件，您将需要解决某种形式的文件锁定以避免损坏。

另一个缺点是这并不能保证良好的性能 - 为此，您需要一个排序算法来尝试避免不断加载和卸载页面（当然，除非您有足够的内存来将整个文件加载到内存中）。

希望这给了你一些想法！

# c# - 如何在主题行中有外文？

> ID：314493
> 
> 赞同：0
> 
> 时间：2008-11-24T15:34:00.840
> 
> 标签：c#, .net, outlook

我有一个 xml Web 服务，我在工作中使用它来发出请求。这个请求是一个 xml 文档，包括诸如收件人、主题、正文等信息（如时事通讯所包含的）。

我有一个 ASP.NET 表单来输入上述信息，以形成 Xml 文档，并且我可以输入外文字符（非拉丁文 - 日文、中文、俄文等）。

如果我单步执行我的代码，则可以正常显示外来字符。xml 的编码为 utf-8，我将字符串加载到我的 xml 文档的属性中，因此我不需要在字符串级别对编码执行任何操作。

由于不相关的技术问题，我使用 webmail，但我的老板有 Outlook 2007 Pro，并且没有收到带有外国文本主题行的电子邮件。但是，如果 xml 是通过内部测试工具手动发布的，而不是 .NET 方法/变量 (OOP) 等方式，它将起作用。所以 .NET 在某处出现了故障。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T16:15:30.240

抱歉，我对您问题中的一些细节感到困惑，哪些地方工作正常，哪些地方工作不正常。

以下是一些可以尝试的想法： 在 Outlook 中，尝试“其他操作”、“编码”。也许您老板的 Outlook 无法识别编码。

在 Outlook 中，转到选项，然后查看“Internet 标头”中的内容。主题应按此处所述进行编码： [how to tell if a string is base64 or not](https://stackoverflow.com/questions/271657/how-to-tell-if-a-string-is-base64-or-not#271705)

如果不是，您的问题出在上游。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:36:48.327

尝试将这些行添加到您的 ASP.NET 站点的 web.config 文件（在 system.web 部分）：

```
<globalization
fileEncoding="iso-8859-1"
requestEncoding="iso-8859-1"
responseEncoding="iso-8859-1"
/> 
```

# asp.net - < ajaxToolkit:TabPanel - 想在不同的选项卡上设置“焦点”

> ID：314494
> 
> 赞同：2
> 
> 时间：2008-11-24T15:34:23.367
> 
> 标签：asp.net, tabpanel

我有一个 < ajaxToolkit:TabPanel 最初在页面加载时，第一个选项卡是“打开”（“专注于”）

我可以做点什么（最好是服务器端），所以我的第二个选项卡将是“默认”选择的选项卡吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T15:46:16.587

在 Page.Load 处理程序中将 TabPanel 的 ActiveTabIndex 设置为 1：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
        TabPanel1.ActiveTabIndex = 1;
} 
```

您也可以在标记中设置它：`<aspToolkit:TabPanel ID="TabPanel1" runat="server" ActiveTabIndex="1">...</aspToolkit:TabPanel>`

# c# - 如何防止/取消 C# 中组合框的值更改？

> ID：314503
> 
> 赞同：25
> 
> 时间：2008-11-24T15:36:34.000
> 
> 标签：c#, winforms, combobox

我在表单顶部有一个组合框，可将可编辑数据加载到下面的字段中。如果用户进行了更改但未保存，并尝试从组合框中选择不同的选项，我想警告他们并让他们有机会取消或保存。

我需要一个带有可取消事件参数的“BeforeValueChange”事件。

关于如何完成的任何建议？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-09-02T23:34:44.827

首次输入时保存 ComboBox 的 SelectedIndex，当您需要取消更改时恢复它的值。

```
cbx_Example.Enter += cbx_Example_Enter;
cbx_Example.SelectionChangeCommitted += cbx_Example_SelectionChangeCommitted;

...

private int prevExampleIndex = 0;
private void cbx_Example_Enter(object sender, EventArgs e)
{
    prevExampleIndex = cbx_Example.SelectedIndex;
}

private void cbx_Example_SelectionChangeCommitted(object sender, EventArgs e)
{
    // some custom flag to determine Edit mode
    if (mode == FormModes.EDIT) 
    {
        cbx_Example.SelectedIndex = prevExampleIndex;
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-20T15:58:03.280

这是最简单的解决方法：-

```
 bool isSelectionHandled = true;

        void CmbBx_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            if (isSelectionHandled)
            {
                MessageBoxResult result = MessageBox.Show("Do you wish to continue selection change?", this.Title, MessageBoxButton.YesNo, MessageBoxImage.Question);
                if (result == MessageBoxResult.No)
                {
                    ComboBox combo = (ComboBox)sender;
                    isSelectionHandled = false;
                    if (e.RemovedItems.Count > 0)
                        combo.SelectedItem = e.RemovedItems[0];
                    return;
                }
            }
            isSelectionHandled = true;
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-24T15:47:32.637

保存事件的当前值`Enter`。在实际逻辑之前实现事件`BeforeValueChange`中的逻辑。如果用户取消，则设置存储的值并且不要在方法（）中继续。`ValueChanged``ValueChanged``return`

如果你要经常使用这个系统，我建议继承 ComboBox 并在`BeforeValuechange`那里实现你的事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T15:46:18.693

验证事件可用于此场景
[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T15:47:01.513

默认情况下，您不会获得适当的事件。如果用户想要取消，您可以缓存先前的值并将其设置回该值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T15:48:17.283

如何使用 Validating / Validated 事件？
如果发生在 LostFocus 而不是 Change 上的事件对您来说很好，那么它运作良好。

不然怎么办

```
public void Combobox_ValueChanged(object sender, EventArgs e) {
    if (!AskUserIfHeIsSureHeWantsToChangeTheValue())
    {
        // Set previous value
        return;
    }

    // perform rest of onChange code
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T15:45:55.387

您可以使用[消息过滤器](http://msdn.microsoft.com/en-us/library/system.windows.forms.imessagefilter.aspx)来拦截点击和按键，这将允许您阻止组合框的正常行为。但我认为您最好在用户进行更改时禁用组合框，并要求他们保存或恢复他们的更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-16T15:02:49.803

您无法真正阻止它，但如果不满足某些要求，您可以将其更改回旧值：

```
private SomeObject = selectedSomeObject=null;

private void cbxTemplates_SelectionChangeCommitted(object sender, EventArgs e)
{
  if (!(sender is ComboBox cb)) return;
  if (!(cb.SelectedItem is SomeObject tem)) return;
  if (MessageBox.Show("You sure?", "??.",
        MessageBoxButtons.OKCancel) != DialogResult.OK)
    cb.SelectedItem = selectedSomeObject;
  else
  {
    selectedSomeObject = tem;
  }
} 
```

# c# - 如何将类标记为已弃用？

> ID：314505
> 
> 赞同：228
> 
> 时间：2008-11-24T15:37:59.457
> 
> 标签：c#, .net, oop, deprecated

> **可能重复：**
> [如何将方法标记为已过时/已弃用？- C＃](https://stackoverflow.com/questions/1759352/how-do-i-mark-a-method-as-obsolete-deprecated-c-sharp)

您如何将课程标记为已弃用？我不想在我的项目中再使用一个类，但不想在 2 周之前删除它。

* * *

## 回答 #1

> 赞同：405
> 
> 时间：2008-11-24T15:38:39.287

您需要使用该`[Obsolete]`属性。

例子：

```
[Obsolete("Not used any more", true)]
public class MyDeprecatedClass
{
    //...
} 
```

参数是可选的。第一个参数用于提供它过时的原因，最后一个参数是在编译时抛出错误而不是警告。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2011-10-12T11:01:41.857

根据 Doak 的回答，但如果您希望代码编译，属性的第二个参数应设置为 false：

```
[Obsolete("Not used any more", false)]
public class MyDeprecatedClass
{
        //...
} 
```

这只会引发警告。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-28T11:14:03.857

不删除类并弃用的原因是当您的代码是已建立的 API 然后被第三方使用时，要遵守一些“礼貌政策”。

如果你弃用而不是删除，你给消费者一个生命周期策略（例如，维护和类的存在直到版本 XX），以便允许他们计划适当的迁移到你的新 API。

* * *

## 回答 #4

> 赞同：-9
> 
> 时间：2008-11-24T15:43:19.540

如果您使用版本控制，我建议您只删除该类。没有理由使用未使用的代码。

如果您稍后决定要使用该类，版本控制将是一个方便的撤销。

# django - 如何在一台服务器上为 Django 设置多个具有不同数据库的帐户？

> ID：314515
> 
> 赞同：4
> 
> 时间：2008-11-24T15:42:32.147
> 
> 标签：django, webserver, fastcgi

安装 Django 有哪些选择，以便多个用户（每个用户都有一个“帐户”）每个人都可以拥有自己的数据库？

语义相当直观。一个帐户可能有多个用户。一个账户有一个唯一的数据库（一个数据库对应一个账户）。图片 WordpressMU。:)

我考虑过这个：

1.  **外部解决方案 - 多路复用到多个服务器/守护程序**

    多个 Django 安装，每个 Django 安装/项目对应一个设置自己的 DATABASE_NAME 的帐户，例如

    文件系统：

    ```
    /bob
      /settings.py (contains DATABASE_NAME="bob")

    /sue
      /settings.py (contains DATABASE_NAME="sue") 
    ```

    然后为每个 bob 和 sue 运行一个 Django 实例。我不喜欢这种方法——它感觉很野蛮，而且闻起来很臭。但我相信它会起作用，并且根据建议，它可能是最干净、最聪明的方法。

    应用程序可以存储在其他地方；django配置唯一需要唯一的是settings.py（即使在那里，只有DATABASE_NAME等需要不同，其余的可以导入）。

    （顺便说一下，我使用的是 lighttpd 和 FastCGI。）

2.  **内部解决方案 - Django 多路复用数据库设置**

    另一方面，我曾想过安装一个 Django，并且

    (a) 为每个数据库表添加一个“prefix_”，对应登录用户的账户；或者

    (b) 根据登录用户的帐户更改数据库。

    我对看到“Django 方式”来做这些特别感兴趣（希望它很简单）。例如，接受请求用户并将 django.conf.SETTINGS['DATABASE_NAME'] 更改为该用户帐户的数据库的中间件。

    这引发了危险信号，即。这是线程安全的吗？即更改 django.conf.SETTINGS 会影响其他进程吗？更改 django.conf.SETTINGS 是否存在固有的危险——数据库连接是否已经设置？重新启动公共 API 的数据库连接部分吗？-- 当我再次查看这个问题时，我将查看 Django 源代码。

    我意识到 2(a) 和 (b) 可能要求用户身份验证以不同于核心的机制存储和访问。

现在，我将使用 webserver 层的外部映射——它是目前最简单和最干净的。但是，我不喜欢为每个帐户运行 FastCGI 守护程序的想法——这似乎不必要地浪费内存，尤其是在有 2000 多个帐户的情况下。但是，我想保持这个讨论的开放性，因为这是一个有趣的问题，而且对于某些情况，解决方案似乎并不理想。

评论应有尽有。干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T17:36:41.137

Django 方式肯定是使用自己的数据库名称（#1）进行单独安装。#2 将涉及相当多的 ORM 黑客攻击，即便如此我也不太确定这是否可能。

但请注意，您不需要为每个用户重新安装所有站点的模型/视图/模板，只需要一个新的 settings.py，其中包含指向公共源文件的所有适当路径。另外，要在 Apache 中运行所有这些安装，请按照我在这里的方式进行：

```
<VirtualHost 1.2.3.4>
        DocumentRoot /www/site1
        ServerName site1.com
        <Location />
                SetHandler python-program
                SetEnv DJANGO_SETTINGS_MODULE site1.settings
                PythonPath "['/www'] + sys.path"
                PythonDebug On
                PythonInterpreter site1
        </Location>
</VirtualHost>

<VirtualHost 1.2.3.4>
        DocumentRoot /www/site2
        ServerName site2.com
        <Location />
                SetHandler python-program
                SetEnv DJANGO_SETTINGS_MODULE site2.settings
                PythonPath "['/www'] + sys.path"
                PythonDebug On
                PythonInterpreter site2
        </Location>
</VirtualHost> 
```

假设你有 /www/site1/settings.py、www/site2/settings.py 等等......

当然，您现在需要有一个人们登录的主站点，然后将您重定向到适当的站点（这里我只是将其命名为“site1.com”、“site2.com”，但您明白了.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:48:31.390

Django ORM 不提供多个数据库支持类，但绝对有可能——您必须编写一个自定义管理器并进行一些其他调整。Eric Florenzano 有一篇很棒的文章，里面有详细的代码示例：

[http://www.eflorenzano.com/blog/post/easy-multi-database-support-django/](http://www.eflorenzano.com/blog/post/easy-multi-database-support-django/)

# visual-studio-2008 - 如何将 Visual Studio 的“发布网站”设置为 1\. 不覆盖 web.config 和 2\. 提升从我的 GAC 引用的 dll 副本

> ID：314524
> 
> 赞同：7
> 
> 时间：2008-11-24T15:44:57.697
> 
> 标签：visual-studio-2008, gac, publish

我开始使用我在开发过程中从 GAC 引用的一个库。当我将它提升到网络服务器时，我希望将 dll 包含在项目 bin 目录中。我还需要我的本地和服务器 web.config 不同。在我开始使用这个库之前，我真的很喜欢使用 VS 的发布网站功能。现在它似乎正在阻碍。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T16:32:32.297

关于 web.config 部署问题：Scott Guthrie 在这里写道：

[**提示/技巧：使用 VS 2005 自动化开发、QA、登台和生产 Web.Config 设置**](http://weblogs.asp.net/scottgu/archive/2007/09/21/tip-trick-automating-dev-qa-staging-and-production-web-config-settings-with-vs-2005.aspx)

您可以轻松地在 Visual Studio 构建环境中自动执行配置过程（并且以在 IDE 以及命令行/自动构建中都可以使用的方式执行此操作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T15:48:23.197

发布工具的当前配置会将 web.config 发送到最终站点，据我所知，没有办法解决这个问题。

Visual Studio 2010 将提供具有目标配置的能力，允许部署过程推出不同的配置。

至于 .dll 参考，我相信让它工作的唯一方法是，如果你在参考上将“复制本地”设置为 true。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-20T14:48:18.680

这并不理想 - splattne 的答案是正确的设置方法 - 但您可以将其从项目文件中移出（“从项目中排除”）并将其保留在您的解决方案中（VS2010 中的“解决方案项目”）。

这是您发布时不会复制的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T15:10:11.037

我发现使用 Visual Studio 2010 发布时，在目标服务器上将生产 Web.Config 设为只读可以正常工作。

希望这可以帮助。

# c++ - Windows GDI：水平/垂直 DPI

> ID：314531
> 
> 赞同：7
> 
> 时间：2008-11-24T15:46:24.403
> 
> 标签：c++, c, windows, gdi

在 Windows 下（通过使用 ::GetDeviceCaps）获取屏幕的 DPI 时，水平值是否始终与垂直值相同？例如：

```
HDC dc = ::GetDC(NULL);
const int xDPI = ::GetDeviceCaps(dc, LOGPIXELSX);
const int yDPI - ::GetDeviceCaps(dc, LOGPIXELSY);
assert(xDPI == yDPI);
::ReleaseDC(NULL, dc); 
```

这些价值观有什么不同吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T17:47:05.610

它可能会有所不同，但这通常仅适用于打印机。可以安全地假设屏幕将始终具有相同的水平和垂直 DPI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:44:58.933

我从未见过它们有什么不同，但在[这个](http://msdn.microsoft.com/en-us/library/aa273854(VS.60).aspx)MSDN 页面上，我看到一条评论表明它们可能是：

```
 int nHorz = dc.GetDeviceCaps(LOGPIXELSX);
   int nVert = dc.GetDeviceCaps(LOGPIXELSY);

   // almost always the same in both directions, but sometimes not! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T17:05:42.293

我从未见过它们不同的情况，但是有两个单独的调用这一事实强烈表明它们有时可能是不同的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-23T18:34:33.260

如果显示器设置为使用与物理屏幕比例不同的屏幕分辨率，例如 16:9 显示器上的 1600x1200 等 4:3 分辨率，它们很容易有所不同。

# java - 标记为“已弃用”的 API 方法何时会真正消失？

> ID：314540
> 
> 赞同：26
> 
> 时间：2008-11-24T15:48:52.260
> 
> 标签：java, date

我正在对我的一位同事刚刚所做的更改进行代码审查，他添加了一堆对 的调用`Date.toMonth()`，`Date.toYear()`以及其他不推荐使用的`Date`方法。所有这些方法在 JDK 1.1 中都已弃用，但他坚持认为可以使用它们，因为它们还没有消失（我们正在使用 JDK 1.5），我说它们现在可能会消失，他应该使用`Calendar`方法。

当这些事情消失时，Sun/Oracle 是否真的说过，或者`@deprecated`只是意味着你失去了风格点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-24T15:59:54.373

关于 API，......没有指定它们将很快被删除。

[J2SE 5.0（自 1.4.2 起）中的不兼容性](http://java.sun.com/j2se/1.5.0/compatibility.html)：

源兼容性

> [...]
> 一般来说，该政策如下，除了下面进一步列出的任何不兼容性：
> 
> 不推荐使用的 API 是仅支持向后兼容的接口。每当使用其中之一时，javac 编译器都会生成一条警告消息，除非使用了 -nowarn 命令行选项。建议修改程序以消除对已弃用 API 的使用，**尽管目前没有计划**从系统中完全删除此类 API（JVMDI 和 JVMPI 除外）。

即使在其[How and When To Deprecate APIs](http://java.sun.com/javase/6/docs/technotes/guides/javadoc/deprecation/deprecation.html)中，也没有提及有关实际*删除*已弃用 API 的政策......

* * *

10 年后更新，新的[JDK9+ **Enhanced Deprecation**](https://docs.oracle.com/javase/9/core/enhanced-deprecation1.htm#JSCOR-GUID-23B13A9E-2727-42DC-B03A-E374B3C4CE96)明确了折旧政策。
有关更多详细信息，请参阅 [Jens Bannmann](https://stackoverflow.com/users/7641/jens-bannmann)的[答案](https://stackoverflow.com/a/50445603/6309)。[Vojtěch Růžička](https://twitter.com/vojtechruzicka)在[对 JEP 277 提出批评](https://blog.jooq.org/2015/12/22/jep-277-enhanced-deprecation-is-nice-but-heres-a-much-better-alternative/)
后，在这篇博文中也对此进行了详细说明。

> JDK 的约定是，一旦 JDK API 被标记为`forRemoval=true`某个 Java 版本，**它将在紧随其后的主要 Java 版本中被删除**。
> 这意味着 - 当某些东西被标记为`forRemoval=true`Java 9 时，它应该在 Java 10 中被完全删除。
> **在使用标记为删除的 API 时请记住这一点。**
> 
> 请注意，此约定仅适用于 JDK 本身，第三方库可以自由选择他们认为合适的任何约定。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T15:49:54.443

他们不会走开。也就是说，它们通常被弃用，因为 a）它们很危险，比如 Thread.stop()，或者 b）有更好的或至少更被接受的方法来做到这一点。通常不推荐使用的方法 javadoc 会给你一个关于更好方法的提示。在您的情况下，日历是推荐的方法。

虽然可以想象它们会在未来的某个时候被删除，但我不会打赌。然而，如果有人分叉 Java，他们可能会是第一件事……

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T16:03:01.997

一个问题是你会看到很多关于使用不推荐使用的方法的编译器警告。如果您还使用弃用来逐步淘汰您自己的代码，编译器警告将迷失在噪音中并失去意义。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-05-21T09:21:33.580

# tl;博士

[从 JDK 17](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Date.html)开始，所有原始`java.util.Date`方法仍然存在，但这些和其他 API 现在可以[显式标记](https://docs.oracle.com/javase/9/core/enhanced-deprecation1.htm)为删除。最近删除了许多其他已弃用的 API。

# 完整答案

在 JDK 9 之前，从未删除过 JDK 中已弃用的 API（请参阅[20 Years Of Java Deprecation](https://www.azul.com/20-years-java-deprecation/)）。该版本作为[增强弃用](https://docs.oracle.com/javase/9/core/enhanced-deprecation1.htm)功能的一部分，引入了该`@Deprecated(forRemoval=true)`标志并将其添加到[数十个先前已弃用的 API](https://docs.oracle.com/javase/9/docs/api/deprecated-list.html#forRemoval)中。

此外，JDK 9 在该语言的历史上第一次**删除**了由于成为模块化障碍而被 JDK 8 弃用的API（ Java SE 9 规范的[完整列表）。](https://cr.openjdk.java.net/%7Eiris/se/11/latestSpec/#APIs-removed)

从那时起，每个 JDK 版本都删除了以前标记为要删除的更多 API，大多数版本还在`forRemoval`以前弃用的 API 中添加了该标志，或者添加了全新的删除弃用项（见下表）。

## 关键要点

1.  Deprecated-for-removal API 很可能很快就会被删除。**请认真对待这一点。**虽然它们可能不会在下一个版本中被删除（例如在 JDK 9 中`Thread.stop()`标记`forRemoval`，但在 JDK 11 之前没有被删除），但它可能会很快发生。
2.  **没有弃用的 API 是安全**的，因为即使是早已弃用的 API 现在也可以很快被删除：一个 JDK 版本设置了`forRemoval`标志，下一个版本删除了 API。例如，被 JDK 10 删除的 API 已被弃用至少 20 年（自 JDK 1.2 起），以至于现在有些人可能会感到惊讶。
3.  如今，随着 Oracle使用 JDK 10[切换到 6 个月的发布周期，](https://adtmag.com/articles/2018/03/21/java-10.aspx)**弃用和删除发生得更快。**

## 值得注意的移除和建议

| 释放 | 已移除 |  已弃用 | 建议移除 |
| --- | --- | --- | --- |
| **JDK** 2018 年 3 月 10 日 | `SecurityManager`和`Runtime`类中的一些 API 
（[完整列表](http://cr.openjdk.java.net/%7Eiris/se/10/latestSpec/#APIs-removed)） | JDK 1.2 | `java.security.acl`包、`finalize()`某些 I/O 类的方法、其他几个以前不推荐使用的 API 
（[完整列表](http://cr.openjdk.java.net/%7Eiris/se/10/latestSpec/#APIs-proposed-for-removal)） |
| **JDK** 2018 年 9 月11 日 | `Thread.destroy()`以及`Thread.stop()`，其他几种方法和`Policy`类 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/11/latestSpec/#APIs-removed)） | JDK 9 和 10 | `java.util.jar.Pack200`API 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/11/latestSpec/#APIs-proposed-for-removal)） |
| **JDK** 2019 年 3 月 12 日 | `finalize()`某些 I/O 类的方法（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/12/latestSpec/#APIs-removed)） | JDK 10 | 没有任何 |
| **JDK** 2019 年 9 月13 日 | `Runtime.traceInstructions()`和`Runtime.traceMethodCalls()` 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/13/latestSpec/#APIs-removed)） | JDK 9 | `javax.security.cert`包，`java.lang.String`与“文本块”预览功能相关的方法和其他一些方法 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/13/latestSpec/#APIs-proposed-for-removal)） |
| **JDK** 2020 年 3 月 14 日 | `java.security.acl`包和`java.util.jar.Pack200`API 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/14/latestSpec/#APIs-removed)） | JDK 10 和 11 | `Thread.resume()`，`Thread.suspend()`以及相关的`ThreadGroup`方法；`ConstantBootstraps()`,`Modifier()`和`ToolProvider()`构造函数 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/14/latestSpec/#APIs-proposed-for-removal)） |
| **JDK** 2020 年 9 月15 日 | `ConstantBootstraps()`和`Modifier()`构造函数 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/15/latestSpec/#APIs-removed)） | JDK 14 | `java.rmi.activation`包 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/15/latestSpec/#APIs-proposed-for-removal)） |
| **JDK** 2021 年 3 月 16 日 | `ToolProvider()`构造函数 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/16/latestSpec/#APIs-removed)） | JDK 14 | 原始包装类的构造函数，例如`Integer`,`Double`或`Boolean`; `ThreadGroup`方法`destroy()`、、`stop()`和`isDaemon()`朋友；`URLDecoder()`构造函数；`finalize()`某些与颜色相关的 AWT 类的方法 
（[完整列表](https://cr.openjdk.java.net/%7Eiris/se/16/latestSpec/#APIs-proposed-for-removal)） |
| **JDK 17** September 2021 | `java.rmi.activation` package, `URLDecoder()` constructor 
([full list](https://cr.openjdk.java.net/%7Eiris/se/17/latestSpec/#APIs-removed)) | JDK 15 & 16 | `java.applet` package, `java.lang.SecurityManager` and related APIs such as `checkAccess()` on `Thread`/`ThreadGroup` 
([full list](https://cr.openjdk.java.net/%7Eiris/se/17/latestSpec/#APIs-proposed-for-removal)) |

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T15:54:31.047

好吧，“还没有”和“永远不会消失”是两个非常不同的东西。这就是弃用的全部意义所在。他们可以随任何未来的版本离开。使用它们是您自担风险的提议。请注意，JDK 的某些未来版本可能会使您的代码处于不可用状态。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-24T21:47:50.897

`Calendar`我有一个更好的建议：你应该切换到[JodaTime](http://joda-time.sourceforge.net/)或[JSR-310](https://jsr-310.dev.java.net/nonav/doc-2008-08-04/index.html)的预发布版本，而不是告诉他使用。可能不推荐使用on 上的某些方法`java.util.Date`，但我认为应该不推荐使用整个类以及`Calendar`. JSR-310 的开发人员似乎同意这一点，尽管我怀疑他们是否会咬紧牙关弃用它。

没有特别的顺序，这里有什么问题`Date`：

*   它的内部表示是自纪元以来的毫秒数；因此，不能表示纪元之前的日期。

*   它所有有用的方法（例如`toString`）首先根据当地时区规范化日期。使用 UTC`Date`实例时，这会*很*烦人；你被迫使用`Calendar`，否则你会犯非常严重的错误。

*   `Calendar`. 它只是臭。可能会赢得有史以来最差 API 的奖项。

*   总是代表一个*即时的*。无法表示特定的日子或特定的年份。无法表示无时区的日期值。

*   几乎没有有用的方法。参见例如 JodaTime 的流畅接口，用于进行日期运算。

*   应该命名为`Datetime`，考虑到它是一个。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T15:52:17.730

如果不推荐使用的方法消失，它们可能会破坏现有代码。

虽然维护一个干净的 API 很重要，但不推荐使用的方法并没有妨碍任何人。当然，现在有更好的方法来做事，所以新方法取代了旧方法。但是摆脱旧的API不会有任何收获（除了更清洁的API）。

将“弃用”视为“过时”的意思，但不一定“在砧板上”。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-24T15:57:42.180

已弃用且应避免使用的功能。尽管它们仍保留在 JDK 中，但不鼓励使用它们，因为有更好的方法可用。这些方法保留在 API 中以支持向后兼容性，但通常应避免使用，因为它们可能会在 API 的未来版本中被删除。

使用已弃用的方法在技术上是可以的，但通常首先弃用它的原因是开发了更好/更快/更清洁的 API。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T15:58:02.087

当涉及影响向后兼容性的更改时，Sun 往往非常偏执，所以我不希望看到这些方法很快消失。

但是不推荐使用的方法**可能**会在未来的任何时候消失，并且通常出于某种原因而被弃用——要么因为它们不可靠，要么因为它们有令人不快的副作用，要么仅仅因为有更好或更优雅的做事方式。该方法的 JavaDoc 通常会详细说明哪种情况是这种情况，以及如今执行相同操作的可接受方式是什么。很多时候，不推荐使用的方法将被替换为调用“正确”方法的实现，所以无论如何你只是添加了一个间接级别。

如果你使用这些方法，你也会有很多编译警告，这可能是足够的理由来避免它们本身......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T16:02:00.407

我确实看到过不推荐使用的函数消失了——从旧版本的 Java 到当前版本（我从 1.1 开始，有些东西在 1.4 中明显不起作用）。

其他语言以不同的方式处理弃用 - 例如，Python 在过去就知道会在发布一两个版本后删除弃用的功能。

# c# - 如何在gridview中格式化数字字符串？

> ID：314549
> 
> 赞同：4
> 
> 时间：2008-11-24T15:53:52.280
> 
> 标签：c#, asp.net, data-binding, gridview

在 C# 中

我在数据库中有一个处理时间编号数据列，格式为“###”或“##”（例如：“813”或“67”）

当我将它绑定到网格视图时，我想以这种格式“0.###”（例如：“0.813”或“0.067”）显示它

我尝试使用 {0:0.000} 和其他格式。但似乎没有一个工作。谁能告诉我如何编写格式字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T16:34:46.817

你真的应该在显示之前将它乘以 .001，然后你可以使用正常的`{0:0.000}`格式字符串。

如果由于某种原因这是不可能的 - 您可以使用`{0:0\\.000}`使用“。”的格式字符串。不是作为小数分隔符，而是作为文字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T15:57:04.660

您需要在该列上禁用 HTML 编码才能使格式字符串生效。

[延伸阅读](http://weblogs.asp.net/rajbk/archive/2005/10/31/429090.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-11T09:10:43.360

这可以使用["," 自定义](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)说明符来完成，它可以用作数字缩放说明符：

> 数字缩放说明符：如果在显式或隐式小数点左侧立即指定一个或多个逗号，则要格式化的数字除以每个逗号的 1000。

在您的示例中，格式字符串`{0:0,.000}`可用于将 813 格式化为`0.813`.

两个逗号将缩放 1,000,000，例如`{0:0,,.0M}`将 1753456 格式化为`1.8M`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-18T15:35:42.210

不错的帖子，真的很有帮助。但最好这样做：

```
try
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        if (((DataRowView)(e.Row.DataItem))["Columnname"].ToString().Equals("Total", StringComparison.OrdinalIgnoreCase))
        {
            e.Row.Font.Bold = true;
            //-----or ant thing you want to do------
        }
    }
}
catch (Exception ex)
{

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T23:21:09.847

你的意思是？

```
GridView.DataSource = .... 

BoundField total = new BoundField();
total.DataField = "Total";
total.HeaderText = "Total Amount";
total.DataFormatString = "{0:C}";
donations.Columns.Add(total);

...... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-24T16:43:25.753

如果由于某种原因在将其绑定到网格之前无法更改值，则可以处理 RowDataBound 事件并在显示之前将数字除以 1000。

```
// Handle the grid's RowDataBound event
MyGridView.RowDataBound += new GridViewRowEventHandler(MyGridView_RowDataBound);

// Set the value to x / 1000 in the RowDataBound event
protected void MyGridView_RowDataBound( object sender, GridViewRowEventArgs e )
{
    if( e.Row.RowType != DataControlRowType.DataRow )
      return;

    // Cast e.Row.DataItem to whatever type you're binding to
    BindingObject bindingObject = (BindingObject)e.Row.DataItem;

    // Set the text of the correct column.  Replace 0 with the position of the correct column
    e.Row.Cells[0].Text = bindingObject.ProcessingTime / 1000M;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T17:19:22.203

所以你在寻找这样的东西吗？

```
String.Format("{0:0.000}", test/1000); 
```

# c++ - 如何在 Visual Studio 中使用 makefile？

> ID：314553
> 
> 赞同：67
> 
> 时间：2008-11-24T15:54:39.300
> 
> 标签：c++, visual-studio, makefile

我听说过很多关于 makefile 以及它们如何简化编译过程的信息。我正在使用VS2008。有人可以推荐一些在线参考资料或书籍，我可以在其中找到更多关于如何处理它们的信息吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-11-25T19:20:17.417

Microsoft 程序维护实用程序 (NMAKE.EXE) 是一种基于描述文件中包含的命令构建项目的工具。

[NMAKE 参考](http://msdn.microsoft.com/en-us/library/dd9y37ha.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-24T16:07:18.633

一个 UNIX 专家可能告诉过你。:)

您可以在 VS 中使用 makefile，但是这样做会绕过 MSVC IDE 中的所有内置功能。Makefile 基本上是构建器的 reinterpret_cast。IMO 最简单的事情就是使用解决方案。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-09-14T07:58:13.290

要回答具体问题...

> 我正在使用VS2008。有人可以推荐一些在线参考资料或书籍，我可以在其中找到更多关于如何处理它们的信息吗？

此链接将通过将 Makefile 与 Visual Studio 进行映射，为您提供一个很好的介绍。

[面向 Visual Studio 开发人员的 Makefile 简介](http://cognitivewaves.wordpress.com/makefiles/)

> 我听说过很多关于 makefile 以及它们如何简化编译过程的信息。

Makefile 功能强大且灵活，但可能不是简化流程的最佳解决方案。考虑 CMake，它很好地抽象了构建过程，这在此链接中进行了解释。

[面向 Visual Studio 开发人员的 CMake](http://cognitivewaves.wordpress.com/cmake-and-visual-studio/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-24T23:23:01.483

在调用 devenv 构建特定项目之前，我实际上使用 makefile 构建所需的任何依赖项，如下所示：

```
debug: coratools_debug
    devenv coralib.vcproj /build debug

coratools_debug: nothing
    cd ../coratools
    nmake debug
    cd $(MAKEDIR) 
```

你也可以使用 msbuild 工具来做同样的事情：

```
debug: coratools_debug
    msbuild coralib.vcxproj /p:Configuration=debug

coratools_debug: nothing
    cd ../coratools
    nmake debug
    cd $(MAKEDIR) 
```

在我看来，这比试图找出过于复杂的 Visual Studio 项目管理方案要容易得多。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-24T15:56:54.460

makefile 的 VS 等价物是“解决方案”（我知道过于简化了）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-06-29T14:32:25.777

总结一个完整的解决方案......

有2个选项：

1.  从 Visual Studio 的开发人员命令提示符中使用 NMAKE

该快捷方式存在于您的开始菜单中。查看 makefile 内部是否有任何“设置”操作。动作显示为冒号前的第一个单词。通常，所有好的 makefile 都有一个“all”操作，因此您可以键入：NMAKE all

2.  为每个二进制文件创建解决方案和项目文件。

大多数设计良好的开源解决方案都提供了一个带有设置操作的 makefile 来为您生成 Visual Studio 项目文件，因此请首先在 Makefile 中查找这些文件。

否则，您需要将每个文件或文件组和文件夹拖放到您在 Visual Studio 中创建的每个新项目中。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T16:22:25.843

Makefile 和构建文件是关于自动化构建的。如果您使用 MSBuild 或 NAnt 之类的脚本，则可以直接从命令行构建项目或解决方案。这反过来使构建自动化成为可能，让它由构建服务器运行。

除了构建您的解决方案之外，构建脚本通常还包括运行单元测试、报告代码覆盖率和复杂性等任务。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T16:03:29.330

如果您询问实际的命令行 makefile，则可以导出 makefile，或者您可以从命令行对解决方案文件调用 MSBuild。你到底想用makefile做什么？

您可以在 SO for MSBuild 上进行搜索以获取更多详细信息。

# c# - 如何使用 SQL Profiler 确认 NHibernate 实际使用事务？

> ID：314554
> 
> 赞同：4
> 
> 时间：2008-11-24T15:54:41.547
> 
> 标签：c#, nhibernate, transactions

我正在使用以下通用代码来保存实体。

```
using (ITransaction tx = session.BeginTransaction())
{
    try
    {
       entity.DateModified = DateTime.Now;
       session.SaveOrUpdate(entity);
       session.Flush();
       tx.Commit();
       return entity;
    }
    catch (Exception)
    {
       tx.Rollback();
       throw;
    }
} 
```

但是，当我观看 SQL Profiler 时，我看不到任何`BEGIN TRANSACTION`被发送到 SQL Server。这是正常的，预期的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T18:16:04.210

我建议显而易见：确保 Profiler 设置为显示交易信息。

在 Trace Properties 对话框 -> Events 选择选项卡中，有一个 Transactions 扩展。打开它并选中相应的框（或者只选中它们）。

另外，仅供参考：我检查了我们使用 NHibernate 的应用程序，是的，在 Profiler 中进行跟踪时，我确实看到了 BEGIN TRANSACTION 和 COMMIT TRANSACTION 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:12:09.207

尝试提交事务，然后刷新会话。

# vb.net - Linqtosql - 连接行

> ID：314555
> 
> 赞同：1
> 
> 时间：2008-11-24T15:54:45.197
> 
> 标签：vb.net, linq-to-sql

在 Linqtosql 中，如何在单个字段中显示多行中的项目。

例如，我有一个用于标记（实体、标记、实体标记）的 3 个表设置，所有这些都通过外键链接。

对于每个实体，我想在一个字段中返回名称，然后在第二个字段中返回所有相关标签。

例如项目1，标签1；标签2; 标记 3 项目 2、标记 4、标记 5....

VB 语句优先。

谢谢杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T17:06:57.483

好的，不确定这是否是最有效的方法，但它有效。

```
Dim dc As New DataContext

Dim query = From i In dc.Items _
            Let tags = (From t In dc.ItemTags _
                        Where t.ItemID = i.ID _
                        Select t.Tag.Name).ToArray _
            Select i.ItemName, Tags = String.Join(" | ", tags) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:59:08.080

有了这个答案，我假设您的表格设置类似于以下内容，名称不是很好，仅用于说明：

AnEntity：Id，名称
ATag：Id，TagName
EntityTag：EntityId（FK 到 AnEntity.Id），TagId（FK 到 ATag.Id）

你可以试试这个：

```
var entityTags = from ent in theEntities
                 from enttags in ent.EntityTags
                 group enttags by enttags.AnEntity into entityGroup
                 select new { TheEntity = entityGroup.Key, TheTags = 
                              from t in entityGroup
                              select t.ATag.TagName }; 
```

我还没有实际测试这个，我会在今天下午试一试，如果需要的话进行编辑。这里发生的是一个 SelectMany。'from ent in dc.AnEntities' 获取所有实体记录，然后下一个'from enttags in ent.EntityTags' 获取每个实体的所有实体标记记录。group by 几乎可以做到这一点，按 AnEntity 对 EntityTag 记录进行分组。把它们放在匿名类型中，你就可以开始了。

**编辑：**
好的，更改了上面的代码，它现在可以工作了。在获得 EntityTag 对象列表之前，现在您获得了 Entiy 对象和该实体的字符串（标签）列表。

# asp.net-mvc - Asp.Net Mvc Route Constraints 能否抛出 404 而不是 InvalidOperationException？

> ID：314558
> 
> 赞同：3
> 
> 时间：2008-11-24T15:56:04.257
> 
> 标签：asp.net-mvc, routing, asp.net-mvc-routing, http-status-code-404

我正在尝试在 Asp.Net MVC 应用程序中使用路由约束。

```
routes.MapRoute(
    "theRoute",
    "MyAction/{page}",
    new { controller = "TheController", action = "MyAction", page = 1 },
    new { page = @"[0-9]" }); 
```

当我输入 ~/MyAction/aString 之类的 url 时，会显示 YSOD 并带有无效操作异常。我该怎么做才能将无效的 url 重定向到 404 页面？

我知道我可以使用控制器操作和 int.TryParse 中的字符串参数来解决问题，但是路由约束是无用的。

如何选择路由约束抛出的异常类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T04:31:38.397

问题是您没有与以字符串结尾的路由匹配的路由。

修改您的路线，类似于：

```
routes.MapRoute(
    "Default",                                              // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
    new { controller = "Home", action = "Index", id = 0 },
    new { id = "[0-9]" }// Parameter defaults
);
routes.MapRoute(
    "Default2",                                              // Route name
    "{controller}/{action2}/{sid}",                           // URL with parameters
    new { controller = "Home", action = "Index2", sid = "" }  // Parameter defaults
); 
```

并修改您的控制器

```
public ActionResult Index(int id)
    {
        ViewData["Title"] = "Home Page";
        ViewData["Message"] = "Welcome to ASP.NET MVC! Your id is: "+ id.ToString();

        return View();
    }

    public ActionResult Index2(string sid)
    {
        ViewData["Title"] = "Home Page 2."+sid.ToString();
        ViewData["Message"] = "Welcome to ASP.NET MVC! \"" + sid.ToString() +"\" is an invalid id";

        return View("index");
    } 
```

现在，当您为 ID 传递一个字符串时，将调用 Index2，您可以做任何您需要做的事情来处理不正确的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-30T14:44:07.273

只提一个更一般的重定向：

您可以在应用程序的 Web.config 中编写：

```
<system.web>
    ...
    ...
    <customErrors mode="On">
        <error 
            statusCode="404" 
            redirect="/Home/MyCustomError" /> 
                                <!--    Is not necessary that the 
                                        view MyCustomError.aspx are inside the 
                                        Home folder, you can put that 
                                        view in the Shared folder.
                                -->
    </customErrors>
    ...
    ...
</system.web> 
```

然后你需要有一个`ActionResult`被叫`MyCustomError`

```
public class HomeController : Controller
{
    ...
    ...

    public ActionResult MyCustomError(string aspxerrorpath) 
                                                    /* the var aspxerrorpath 
                                                     * is that MVC generated by
                                                     * default */
    {
        ViewData["messageError"] = aspxerrorpath;
        return View();
    }
} 
```

然后您可以制作自定义错误页面：

```
<%@ Page Language="C#" 
        MasterPageFile="~/Views/Shared/Site.Master" 
        Inherits="System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo>" %>

<asp:Content ID="errorTitle" ContentPlaceHolderID="TitleContent" runat="server">
    Error
</asp:Content>

<asp:Content ID="errorContent" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Shit happends</h2>
     <p> <%: ViewData["messageError"]%></p>
     <p>aaaaaaaaaaaaaaa!!!!!!!!!!!!!!!!!!!!</p>
</asp:Content> 
```

# sql-server - windows域更改导致sql2005登录失败

> ID：314560
> 
> 赞同：0
> 
> 时间：2008-11-24T15:56:50.323
> 
> 标签：sql-server, windows, dns

我的公司将域从 abc 更改为 xyz，现在我无法通过 Windows 登录或 sql 登录登录到我的本地 sql2005。

两次登录都给了我这个错误：建立与服务器的连接时发生错误。等等等等等等……Sql 服务器不允许远程连接。错误：26 - 定位指定的服务器/实例时出错。

我检查服务器实例是否正在运行。我可以理解windows登录失败，但是sql登录怎么会失败呢？有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T16:23:21.177

这很奇怪，但我找到了解决方案。我在登录屏幕上选择要连接的数据库，然后使用 sql 身份验证。我能够登录。原来我的工作站被重命名了。这就是它找不到服务器实例的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T16:28:08.140

您使用的是什么服务器名称？如果您使用的不是（本地）、localhost 或 . - 那么您可能需要将服务器更改为 NEWDOMAIN\HOSTNAME 或 hostname.newdomain.com。

# java - eclipse 编译器或 javac 中的错误（“无法确定 T 的类型参数”）

> ID：314572
> 
> 赞同：74
> 
> 时间：2008-11-24T15:59:15.110
> 
> 标签：java, eclipse, generics

以下代码

```
public class GenericsTest2 {

    public static void main(String[] args) throws Exception {
        Integer i = readObject(args[0]);
        System.out.println(i);
    }

    public static <T> T readObject(String file) throws Exception {
        return readObject(new ObjectInputStream(new FileInputStream(file)));
        // closing the stream in finally removed to get a small example
    }

    @SuppressWarnings("unchecked")
    public static <T> T readObject(ObjectInputStream stream) throws Exception {
        return (T)stream.readObject();
    }
} 
```

在 Eclipse 中编译，但不能使用 javac 编译（无法确定 T 的类型参数；对于具有上限 T,java.lang.Object 的类型变量 T 不存在唯一的最大实例）。

当我将 readObject(String file) 更改为

```
 @SuppressWarnings("unchecked")
    public static <T> T readObject(String file) throws Exception {
        return (T)readObject(new ObjectInputStream(new FileInputStream(file)));
    } 
```

它在 eclipse 和 javac 中编译。谁是正确的，eclipse编译器还是javac？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-12-02T23:39:59.500

我会说这是[此处](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6302954)和[此处](https://bugs.eclipse.org/bugs/show_bug.cgi?id=98379)报告的 Sun 编译器中的错误，因为如果您将行更改为下面的行，则两者都适用，这似乎正是错误报告中描述的内容。

```
return GenericsTest2.<T>readObject(new ObjectInputStream(new FileInputStream(file))); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-24T16:48:55.213

在这种情况下，我会说您的代码是错误的（而 Sun 编译器是正确的）。您的输入参数中没有任何内容`readObject`可以实际推断 type `T`。在这种情况下，您最好让它返回 Object，并让客户端手动转换结果类型。

这应该有效（尽管我没有测试过）：

```
public static <T> T readObject(String file) throws Exception {
    return GenericsTest2.<T>readObject(new ObjectInputStream(new FileInputStream(file)));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-29T12:45:08.170

Oracle JDK6 u22 应该是正确的，但我也有 JDK6 u24 这个问题

这是 eclipse[错误 98379](https://bugs.eclipse.org/bugs/show_bug.cgi?id=98379)的错误。

这没有得到纠正，但问题已通过解决方法解决，例如 eclipse 错误中的示例（请参阅链接）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-11T11:33:00.570

我在 java 版本“1.6.0_22”中发现了这个问题。当我升级到 java 版本“1.6.0_32”时它消失了，因为它已在更新 25 中修复。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-03T12:51:48.840

如果您可以修改您的方法 readObject 以在调用时透明地工作，您还可以使用以下内容：

```
public static <T> T readObject(String file, Class<T> type) throws Exception {
    return type.cast(readObject(new ObjectInputStream(new FileInputStream(file))));
} 
```

这样，调用者被迫指定结果的类型，编译器知道如何转换结果。

# java - 需要一个 Hibernate 中的主键 @OneToOne 映射示例

> ID：314578
> 
> 赞同：5
> 
> 时间：2008-11-24T16:01:14.247
> 
> 标签：java, hibernate, annotations, one-to-one

有人可以给我一个Hibernate中单向@OneToOne主键映射的例子吗？我尝试了很多组合，到目前为止，我得到的最好的东西是：

```
@Entity
@Table(name = "paper_cheque_stop_metadata")
@org.hibernate.annotations.Entity(mutable = false)
public class PaperChequeStopMetadata implements Serializable, SecurityEventAware {

private static final long serialVersionUID = 1L;

@Id
@JoinColumn(name = "paper_cheque_id")
@OneToOne(cascade = {}, fetch = FetchType.EAGER, optional = false, targetEntity = PaperCheque.class)
private PaperCheque paperCheque;
} 
```

每当 Hibernate 尝试为上述映射自动生成模式时，它都会尝试将主键创建为 blob，而不是 long，这是 PaperCheque 的 id 类型。有人能帮帮我吗 ？如果我不能得到一个确切的解决方案，可以做一些接近的事情，但我会很感激任何回应。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T16:24:06.917

我在实现几个@OneToOne 映射时保存了[这个讨论](http://forum.hibernate.org/viewtopic.php?p=2381079)，我希望它也能对你有用，但我们不会让 Hibernate 为我们创建数据库。

注意 GenericGenerator 注释。

无论如何，我有这个代码工作：

```
@Entity
@Table(name = "message")
public class Message implements java.io.Serializable
{
    @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    @PrimaryKeyJoinColumn(name = "id", referencedColumnName = "message_id")
    public MessageContent getMessageContent()
    {
        return messageContent;
    }
}

@Entity
@Table(name = "message_content")
@GenericGenerator(name = "MessageContent", strategy = "foreign",
    parameters =
    {
      @org.hibernate.annotations.Parameter
      (
        name = "property", value = "message"
      )
    }
)
public class MessageContent implements java.io.Serializable
{
    @Id
    @Column(name = "message_id", unique = true, nullable = false)
    // See http://forum.hibernate.org/viewtopic.php?p=2381079
    @GeneratedValue(generator = "MessageContent")
    public Integer getMessageId()
    {
            return this.messageId;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T16:24:33.437

您的意图是在 PaperChequeStopMetaData 和 PaperCheque 之间建立 1-1 关系？如果是这样，您不能将 PaperCheque 实例定义为 PaperChequeStopMetaData 的 @Id，您必须在 PaperChequeStopMetaData 中定义一个单独的 @Id 列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T17:52:51.480

谢谢你们的回答。我一直在尝试，这就是我的工作：

```
@Entity
@Table(name = "paper_cheque_stop_metadata")
@org.hibernate.annotations.Entity(mutable = false)
public class PaperChequeStopMetadata implements Serializable, SecurityEventAware {

private static final long serialVersionUID = 1L;

@SuppressWarnings("unused")
@Id
@Column(name = "paper_cheque_id")
@AccessType("property")
private long    id;

@OneToOne(cascade = {}, fetch = FetchType.EAGER, optional = false, targetEntity = PaperCheque.class)
@PrimaryKeyJoinColumn(name = "paper_cheque_id")
@JoinColumn(name = "paper_cheque_id", insertable = true)
@NotNull
private PaperCheque paperCheque;

@XmlAttribute(namespace = XMLNS, name = "paper-cheque-id", required = true)
public final long getId() {
    return this.paperCheque.getId();
}

public final void setId(long id) {
    //this.id = id;
    //NOOP, this is essentially a pseudo-property
}
} 
```

无论如何，这是一个令人作呕的黑客，但它让我得到了我想要的一切。paperCheque 属性访问器是正常的（未显示）。我之前遇到过这种单向 OneToOne 映射问题并解决了更糟糕的解决方案，但这次我决定我要弄清楚，所以我一直在破解它。再次感谢两位的回答，非常感谢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-31T13:09:34.060

只是为了将来的观点更新这个问题。

当提出这个问题时，我认为这个问题没有适当的解决方案。但是从 JPA 2.0 开始，您可以使用 @MapsId 来解决这个问题。

参考正确解释：[https ://vladmihalcea.com/the-best-way-to-map-a-onetoone-relationship-with-jpa-and-hibernate/](https://vladmihalcea.com/the-best-way-to-map-a-onetoone-relationship-with-jpa-and-hibernate/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-17T08:12:00.190

你应该远离hibernate的OneToOne映射，这是非常危险的。见[http://opensource.atlassian.com/projects/hibernate/browse/HHH-2128](http://opensource.atlassian.com/projects/hibernate/browse/HHH-2128)

你最好使用多对一映射。

# java - 如何使用线程执行单元测试？

> ID：314580
> 
> 赞同：11
> 
> 时间：2008-11-24T16:02:08.630
> 
> 标签：java, multithreading, unit-testing, junit

**执行摘要：**当在线程中抛出断言错误时，单元测试不会死。这是有道理的，因为不应允许一个线程使另一个线程崩溃。问题是我如何 1) 在第一个辅助线程崩溃时使整个测试失败，或者 2) 在每个线程都完成后循环并确定每个线程的状态（参见下面的代码）。实现后者的一种方法是使用每个线程的状态变量，例如，“boolean[] statuses”并且“statuses[i] == false”意味着线程失败（这可以扩展以捕获更多信息）。但是，这不是我想要的：我希望它在抛出断言错误时像任何其他单元测试一样失败。这甚至可能吗？这是可取的吗？

我觉得无聊，我决定在我的单元测试中产生一堆线程，然后让它们调用一个服务方法，只是为了它。代码大致如下：

```
Thread[] threads = new Thread[MAX_THREADS];
for( int i = 0; i < threads.length; i++ ) {
    threads[i] = new Thread( new Runnable() {
        private final int ID = threadIdSequenceNumber++;
        public void run() {
            try {
                resultRefs[ID] = runTest( Integer.toString( ID ) ); // returns an object
            }
            catch( Throwable t ) { 
                // this code is EVIL - it catches even
                // Errors - don't copy it - more on this below
                final String message = "error testing thread with id => "
                            + ID;
                logger.debug( message, t );
                throw new IllegalStateException( message, t ); 
                // need to wrap throwable in a 
                // run time exception so it will compile
            }
        }
    } );
} 
```

在此之后，我们将遍历线程数组并启动每个线程。之后，我们将等待他们全部完成。最后，我们将对结果引用进行一些检查。

```
for( Thread thread : threads )
    thread.start();

logger.debug( "waiting for threads to finish ..." );
boolean done = false;
while( !done ) {
    done = true;
    for( Thread thread : threads )
        if( thread.isAlive() )
            done = false;
}

for( int i = 0; i < resultRefs.length; i++ ) {
    assertTrue( "you've got the world messed, dawg!",
            myCondition(resultRefs[i]) ); 
```

这就是问题所在。你注意到那个讨厌的 try-catch-throwable 块了吗？我只是将其添加为临时黑客，因此我可以看到发生了什么。在 runTest(String) 中进行了一些断言，例如 assertNotNull(null)，但由于它在不同的线程中，它不会导致单元测试失败！！！！

我的猜测是，我们需要以某种方式遍历线程数组，检查每个线程的状态，如果线程以令人讨厌的方式终止，则手动导致断言错误。提供此信息的方法的名称是什么（死线程的堆栈跟踪）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T16:44:09.403

并发是很难进行单元测试的事情之一。如果您只是想测试每个线程内的代码是否正在执行它应该测试的内容，那么您可能应该只测试与上下文隔离的代码。如果在此示例中线程协作以达到结果，您可能可以在不使用线程的情况下测试该协作。这将通过按顺序执行所有协作部分来完成。如果你想测试竞争条件和这类事情，单元测试不是最好的方法。你会得到有时会失败，有时不会失败的测试。总而言之，我认为您的问题可能是您的单元测试级别太高了。希望这可以帮助

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T16:49:13.200

谷歌测试博客有一篇关于这个主题的优秀文章值得一读：http: [//googletesting.blogspot.com/2008/08/tott-sleeping-synchronization.html](http://googletesting.blogspot.com/2008/08/tott-sleeping-synchronization.html)

它是用 Python 编写的，但我认为这些原则可以直接转移到 Java。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T16:49:48.987

多线程环境中的单元测试很困难......所以需要进行一些调整。单元测试必须是可重复的……确定性的。因此，任何具有多个线程的东西都不符合这个标准。多线程测试也往往很慢。

*   我要么尝试看看我是否可以通过在单个线程上进行测试来解决问题。被测试的逻辑是否真的需要多个线程。
*   如果这不起作用，请使用成员变量方法，当所有线程都完成运行时，您可以在测试结束时检查预期值。

嘿，好像还有一个这样的问题。查看我的帖子以获取 tdd yahoogroup 上更长讨论的链接 [单元测试多线程应用程序？](https://stackoverflow.com/questions/111676/unit-testing-a-multithreaded-application)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T18:25:01.837

您的可运行包装器应该将异常对象传递回您的测试类，然后您可以将它们存储在一个集合中。完成所有测试后，您可以测试该集合。如果它不为空，则遍历每个异常和 .printStackTrace() 然后失败。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T18:32:47.407

实现一个[UncaughtExceptionHandler](http://java.sun.com/javase/6/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)设置一些标志（线程定期检查）并将[其设置在每个 Thread 上](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#setUncaughtExceptionHandler(java.lang.Thread.UncaughtExceptionHandler))。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-24T13:23:09.663

Junit 并发线程测试的另一个流行选项是 Matthieu Carbou 使用自定义 JunitRunner 和简单注释的方法。

[查看完整文档](http://www.junit.org/node/589)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-02T10:47:03.100

通过使用特殊的同步对象，可能会使单元测试失败。看看下面的文章： [Sprinkler - 高级同步对象](http://www.codeproject.com/Articles/628843/Sprinkler-Advanced-synchronization-object#_rating)

我将尝试解释这里的要点。您希望能够将内部线程故障外部化到主线程，在您的情况下是测试。因此，您必须使用内部线程和测试都将用来相互同步的共享对象/锁。请参阅以下测试 - 它创建一个线程，通过调用名为 Sprinkler 的共享对象来模拟抛出的异常。主线程（测试）在 Sprinkler.getInstance().await(CONTEXT, 10000) 上被阻塞，在调用 release 时 - 将空闲并捕获抛出的异常。在 catch 块中，您可以编写未通过测试的断言。

```
 @Test
    public void testAwait_InnerThreadExternalizeException() {

        final int CONTEXT = 1;
        final String EXCEPTION_MESSAGE = "test inner thread exception message";

        // release will occur sometime in the future - simulate exception in the releaser thread
        ExecutorServiceFactory.getCachedThreadPoolExecutor().submit(new Callable<void>() {

            @Override
            public Void call() throws Exception {

                Sprinkler.getInstance().release(CONTEXT, new RuntimeException(EXCEPTION_MESSAGE));

                return null;
            }

        });

        Throwable thrown = null;
        try {
            Sprinkler.getInstance().await(CONTEXT, 10000);
        } catch (Throwable t) {
            // if the releaser thread delivers exception it will be externelized to this thread
            thrown = t;
        }
        Assert.assertTrue(thrown instanceof SprinklerException);
        Assert.assertEquals(EXCEPTION_MESSAGE, thrown.getCause().getMessage());
    } 
```

# database - 具有大量插入的 Web 应用程序的性能

> ID：314581
> 
> 赞同：2
> 
> 时间：2008-11-24T16:02:16.447
> 
> 标签：database, performance, filesystems

对于记录用户在网站上的行为以及所有流量将导致 IO 写入的高流量 Web 应用程序，最佳 IO 策略是什么？是否会写入文件并在一夜之间批量插入数据库？或者只是为每个请求做一个 INSERT（或 INSERT DELAYED）？我知道要正确考虑这个问题，需要更多关于架构的详细信息，但非常感谢朝正确方向轻推。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T16:10:00.423

通过写入数据库，您允许 RDBMS 决定何时应该发生磁盘 IO - 例如，如果您有足够的 RAM，它可能会有效地将所有这些插入缓存在内存中，当负载较轻时将它们写入磁盘，或者其他一些调度机制。

直接写入文件系统将比写入然后写入的数据库更受带宽限制，特别是因为从理论上讲，数据库可以以更有效的大小、连续和“方便”的时间写入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-16T19:54:42.797

我在最近的一个应用程序上做了这个。插入通常很便宜（尤其是如果您将它们放入未索引的料斗表中）。我认为你有几个选择。

1.  如上所述，将数据写入 hopper 表，如果任何应用程序框架支持批量插入，则使用这些，它将加快速度。然后每个 x 请求，合并（通过 SP 调用）到主表中，您可以在其中规范化具有低熵的数据。例如，如果您要存储请求的 HTTP 类型（get/post/etc），这只能是几种类型，最好存储为 Int，并获得改进的 I/O + 查询性能。您的主表也可以像往常一样被索引。

2.  如果这还不够好，那么您可以将请求流式传输到本地文件系统上的文件，然后让带外（即与网络服务器分开的进程）吸收这些文件并将它们 BCP 到数据库中。这将以更多的移动部件为代价，并且可能会在接收请求和它们找到进入数据库的方式之间产生更大的延迟

希望这会有所帮助，王牌

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-17T08:50:51.907

使用 RDBMS 时，最重要的是优化磁盘写入操作。某处必须刷新（）到持久存储（磁盘驱动器）以完成每个非常昂贵且耗时的事务。最小化事务数量和最大化写入的连续页面数量是性能的关键。

如果您要在单个事务中批量发送插入，则会导致磁盘上更有效的写入行为，从而减少刷新操作的数量。

我的建议是将消息排队并定期..说每 15 秒左右开始一个事务...发送所有排队的插入...提交事务。

如果您的数据库支持在单个请求/命令中发送多个日志条目，那么当应用程序和 RDBMS 之间存在一些网络延迟时，通过减少往返次数，这样做会对性能产生显着影响。

一些系统支持批量操作 (BCP)，为批量加载数据提供了一种非常有效的方法，该方法比使用“插入”查询更快。

节省使用索引和选择顺序主键会有所帮助。

在某些情况下，确保多个实例协调写入操作或写入单独的表可以通过减少数据库中的并发管理开销来提高吞吐量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T16:06:16.360

写入文件，然后加载。耦合到文件系统比耦合到数据库更安全。并且数据库比您的文件系统更有可能失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T16:06:43.487

我的直觉是只使用数据库，不惜一切代价避免直接文件系统 IO。如果您需要生成一些文件系统工件，那么我会使用每晚的 cron 作业（或类似的东西）来读取数据库记录并写入文件系统。

另外：仅在您不介意在服务器崩溃或重新启动时丢失一些记录的情况下使用“INSERT DELAYED”，因为某些记录几乎肯定会丢失。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-30T12:28:48.883

您记录的内容是否超过了网络服务器日志中可用的内容？它可能很多，例如参见[Apache 2.0 日志信息](http://httpd.apache.org/docs/2.0/mod/mod_log_config.html)。

如果没有，那么您可以使用缓冲然后批量写入的良好旧技术。您可以在不同的位置进行缓冲：在服务器上的内存中，然后将它们批量插入 db 或每隔 X 次请求和/或每隔 X 秒将它们批量写入文件中。

如果您使用 MySQL，有几种不同的选项/技术可以有效地加载大量数据：[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)、[INSERT DELAYED](http://dev.mysql.com/doc/refman/5.1/en/insert-delayed.html)等等。

很多关于[插入速度](http://dev.mysql.com/doc/refman/5.1/en/insert-speed.html)的细节。

其他一些提示包括：

*   每个时间段将数据拆分为不同的表（即：每天或每周）
*   使用多个数据库连接
*   使用多个数据库服务器
*   拥有良好的硬件（SSD/多核）

根据可用的规模和资源，可以采用不同的方式。因此，如果您提供更多详细信息，我可以提供更具体的建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-24T16:10:17.100

使用文件系统回写的唯一问题是如何扩展日志。

一个实现不佳的记录器将不得不打开整个文件以在其末尾附加一行。我目睹了一个这样的例子，其中人以相反的顺序登录到一个文件，最新的条目首先出现，这需要将整个文件加载到内存中，将 1 行写入新文件，然后写入原始文件后面的内容。

该日志最终超过了 phps 的内存限制，因此成为了整个项目的瓶颈。

但是，如果操作正确，文件系统读取/写入将直接进入系统缓存，并且只会每 10 秒或更长时间刷新到磁盘（取决于 FS/OS 设置），与写入相比，这对性能的影响可以忽略不计到任意内存地址。

哦，是的，无论您使用什么系统，您都需要考虑并发日志附加。如果您使用数据库，高插入负载可能会导致您出现死锁情况，并且在文件上，您需要确保不会有 2 个并发写入相互抵消。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-24T16:10:53.527

插入通常会影响表的（读取/更新）性能。也许您可以对另一个表（或数据库）进行写入并拥有处理这些数据的批处理作业。数据库方法的优点是您可以查询/报告数据，并且所有数据在逻辑上都在关系数据库中，并且可能更易于使用。根据将数据记录到文本文件的方式，您可能会发现更多损坏的可能性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-24T16:25:22.670

有一个更简单的方法来回答这个问题。剖析两种解决方案的性能。

创建一个执行数据库插入的页面，另一个写入文件的页面，以及另一个都不执行的页面。否则，页面应该相同。使用负载测试器（例如 JMeter）点击每个页面，看看性能影响是什么。

如果您不喜欢性能数字，您可以轻松调整每个页面以尝试优化性能或尝试新的解决方案......从使用 MSSQL 支持的 MSMQ 到延迟插入到共享日志再到具有数据库背景的单个文件工人。

这将为您做出此决定提供坚实的基础，而不是依赖他人的猜测。事实证明，所提出的解决方案都不是可行的，或者所有的解决方案都是可行的......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-06T03:56:53.670

如果您不需要等待响应（例如生成的 ID），您可能希望采用使用消息队列或线程管理器的异步策略。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-17T08:00:02.527

你好，来自左边的字段，但没有人问（而且你没有具体说明）你永远不会丢失数据有多重要？

如果速度是问题，把它全部留在内存中，然后分批转储到数据库。

# python - 在 Python 中比较多个字典

> ID：314583
> 
> 赞同：4
> 
> 时间：2008-11-24T16:02:37.037
> 
> 标签：python, data-mining

我是 Python 新手，遇到了一个我无法通过谷歌搜索的问题。我已经使用 wxPython 和 ObjectiveListView 构建了一个 GUI。在它的中心，GUI 有一个列表控件，以 X 行（数据由用户加载）和五列显示数据。

当用户从列表控件中选择多个条目时（按 CTRL 或单击时按 shift），ObjectiveListView 模块给我一个字典列表，字典包含列表控件行中的数据。这正是我想要的，好！

返回的列表如下所示：

```
print MyList
[{'id':1023, 'type':'Purchase', 'date':'23.8.2008', 'sum':'-21,90', 'target':'Apple Store'}, {'id':1024, 'type':'Purchase', 'date':'24.8.2008', 'sum':'-21,90', 'target':'Apple Store'}, {'id':23, 'type':'Purchase', 'date':'2.8.2008', 'sum':'-21,90', 'target':'Apple Store'}] 
```

所有字典都有相同的键，但值会发生变化。'id' 值是唯一的。问题从这里开始。我想获取用户选择的所有项目的通用值。在上面的列表中，它们将是 'sum':'-21,90' 和 'target':'Apple Store'。

我不知道如何正确比较列表中的字典。一个大问题是我事先不知道列表包含多少个字典，因为它是由用户决定的。

我有一个模糊的想法，列表推导将是要走的路，但我只知道如何将两个列表与列表推导进行比较，而不是 n 个列表。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:16:20.100

```
>>> mysets = (set(x.items()) for x in MyList)
>>> reduce(lambda a,b: a.intersection(b), mysets)
set([('sum', '-21,90'), ('type', 'Purchase'), ('target', 'Apple Store')]) 
```

首先，我创建了一个生成器，它将字典列表转换为可迭代的键值对集合序列。您可以在此处使用列表推导，但这种方式不会将您的整个列表转换为另一个列表，如果您不知道它有多大，这很有用。

然后我使用reduce 来应用一个函数来查找每组之间的共同值。它找到集合 1 和集合 2 的交集，它本身就是一个集合，然后是那个集合和集合 3 的交集，等等。mysets 生成器会很高兴地将每个集合按需提供给 reduce 函数，直到它完成。

我相信 reduce 作为 Python 3.0 的内置功能已被弃用，但仍应在 functools 中可用。

您当然可以通过用生成器表达式替换 reduce 中的 mysets 来使其成为单行代码，但这会降低 IMO 的可读性。在实践中，我什至可能会更进一步，并将 lambda 分解为自己的行：

```
>>> mysets = (set(x.items()) for x in MyList)
>>> find_common = lambda a,b: a.intersection(b)
>>> reduce(find_common, mysets)
set([('sum', '-21,90'), ('type', 'Purchase'), ('target', 'Apple Store')]) 
```

如果你需要最终结果是一个字典，只需像这样包装它：

```
>>> dict(reduce(find_common, mysets))
{'sum': '-21,90', 'type': 'Purchase', 'target': 'Apple Store'} 
```

dict 可以接受任何键值对的迭代器，例如最后返回的元组集合。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T17:22:57.657

我的回答与 Matthew Trevor 的回答相同，但有一点不同：

```
>>> mysets = (set(x.items()) for x in MyList)
>>> reduce(set.intersection, mysets)
set([('sum', '-21,90'), ('type', 'Purchase'), ('target', 'Apple Store')]) 
```

这里我使用`set.intersection`而不是创建一个新的 lambda。在我看来，这更具可读性，因为这直观地读作“reduce 正在使用集合交集运算符减少此列表”。这也应该快得多，`set.intersection`内置的 C 函数也是如此。

要完全回答您的问题，您可以使用列表理解提取值：

```
>>> mysets = (set(x.items()) for x in MyList)
>>> result = reduce(set.intersection, mysets)
>>> values = [r[1] for r in result]
>>> values
['-21,90', 'Purchase', 'Apple Store'] 
```

这对我来说最终会成为一条线。但这完全取决于你：

```
>>> [r[1] for r in reduce(set.intersection, (set(x.items()) for x in myList))]
['-21,90', 'Purchase', 'Apple Store'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T16:50:20.467

首先，我们需要一个函数来计算两个字典的交集：

```
def IntersectDicts( d1, d2 ) :
    return dict(filter(lambda (k,v) : k in d2 and d2[k] == v, d1.items())) 
```

然后我们可以使用它来处理任意数量的字典：

```
result = reduce(IntersectDicts, MyList) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T20:49:36.770

由于您只是在寻找公共集，因此您可以将第一个字典中的键与所有其他字典中的键进行比较：

```
common = {}
for k in MyList[0]:
    for i in xrange(1,len(MyList)):
        if MyList[0][k] != MyList[i][k]: continue
        common[k] = MyList[0][k]

>>> common
{'sum': '-21,90', 'type': 'Purchase', 'target': 'Apple Store'} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T16:13:34.957

抱歉，是的，'type':'Purchase' 也是常见值之一。应该已经登录才能编辑问题。

# c++ - 您是否将模块特定功能声明为静态？

> ID：314584
> 
> 赞同：11
> 
> 时间：2008-11-24T16:02:45.133
> 
> 标签：c++, c, static, function

我认为将它们声明为静态是最佳实践，因为它使它们在模块之外不可见。

您对此有何看法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-24T16:15:43.750

对于 C++，比静态更好的方法是将其放在未命名（匿名）的命名空间中。这是防止全局命名空间污染的首选方法。

```
namespace {
void myLocalFunction() {
// stuff
}
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T16:11:30.887

如果它确实是一个仅在该 .c 文件内部的函数，那么是的。它应该有助于避免污染全局命名空间。另外，我认为如果函数是静态的，编译器可以对调用约定进行一些优化，因为它不知道其他源文件需要知道如何调用它。这仅适用于 c，因为正如其他人所指出的，c++ 有命名空间来解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T16:19:23.400

在 C++ 中，您应该使用匿名命名空间，如下所示：

```
// foo.cpp
namespace
{
   class Core { ... };
   void InternalFandango(Core *);
}

void SomeGloballyVisibleFunction()
{
   InternalFandango(&core);
} 
```

优点：这也适用于结构/类声明。
在 C 中，只需将函数标记为“静态”。在 C++ 中也没有反对使用“静态”，但我学会了更喜欢命名空间，因为它是一个适用于所有声明的单一概念。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-24T18:49:14.953

有很多关于实现细节的内容，而不是太多关于概念的内容。

限制变量/函数等的范围确实是一个好习惯。这是面向对象设计的基本概念——您希望将私有作为私有。这样你的界面更干净，代码维护更容易。而且您不会发现有一天更改您认为是私有的破坏编译的东西，因为项目的另一部分中的某个人喜欢您的功能并决定使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-25T02:11:38.353

在 C 语言中，我在文件范围内将所有内容（函数和变量）设为静态，直到我可以证明它们在文件之外是必需的。如果只有那个函数会使用它们并且它们不是太大，我会在一个函数中使它们成为静态的。基本上，如果声明大于函数的其余部分，我可以将声明放在函数之外。当然，还有一个源文件提供的公共服务的标题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T23:44:49.587

同意。因此，静态函数的原型必须放在 .c 文件的顶部，而不是 .h 文件中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T16:18:23.790

我认为 C 和 C++ 有不同的约束`static`：在 C 中你没有命名空间，而 .c 文件是你的模块，因此将所有非公共函数设为静态以防止错误非常重要！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T18:23:02.107

关于在 C++ 中使用“静态”（匿名命名空间不提供），我能想到的唯一可能有用的属性是 GCC 中有一个警告，您可以打开未使用的静态函数（一种死代码形式） . 对于匿名命名空间中未使用的函数，您不会得到它，因此，如果您希望编译器在您停止使用该函数时告诉您这种不太可能发生的情况，请这样做。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-25T02:25:29.853

在 C 代码中，默认情况下将函数设为静态。只为其他模块需要的函数创建非静态函数和 .h 声明。

在 C++ 代码中，将文件本地的那些函数放入匿名命名空间**并**使其成为静态的。至少在 GNU 编译器中，这将产生最好和最小的代码，因为如果所有使用都内联，则不会编写任何函数。如果您打算将其内联，那么将其标记为内联当然比静态更好。

我不知道为什么 g++ 将匿名名称空间中的未调用函数体写入输出，但确实如此。隐藏可见性的功能似乎也出现了；标记为隐藏符号，但仍会在目标文件中产生未使用的代码块。GCC 可能不明白在这些情况下不需要代码。或者我错过了一些东西，总是可能的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-26T17:31:02.100

如果您使用 GCC，那么您应该查看可见性标志（请参阅[http://gcc.gnu.org/wiki/Visibility](http://gcc.gnu.org/wiki/Visibility)以获得完整的讨论）。

它将完全隐藏符号，而不是将它们标记为不可访问。这减少了符号表，并有助于减少链接时间。

不仅如此，它还为更多内联打开了大门，如果这就是你所追求的。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-11-24T16:04:12.277

如果“模块”只是指 CPP 文件，则可以将声明和定义直接放在 CPP 文件中。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-12-09T15:27:46.587

在 C++ 中，您可以像这样声明函数私有：

```
class MyClass
{                           
public:                 
void publiclyAccessibleFunction();            
private:                
    void onlyAccesibleFromWithinTheClass();
int some_member_parameter;          
}; 
```

注意`onlyAccesibleFromWithinTheClass()`功能。

# apache-flex - 使用 Flex 创建的 Air 应用程序 - 如何创建向左/向右的飞出窗口

> ID：314591
> 
> 赞同：0
> 
> 时间：2008-11-24T16:04:17.987
> 
> 标签：apache-flex, flash, actionscript-3, air

我有一个带有主窗口的 Air 应用程序。当用户单击主窗口中的按钮时，我希望从主窗口的一侧飞出一个新窗口。出现的窗口需要根据从主窗体传递的值显示信息。如何使用 Flex Builder 3 实现这一目标？

目标平台：任何版本的 Flash/Flex/Air。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T19:56:21.760

您可能想要使用视图状态。查看有关“创建视图状态”的一周内 Flex 视频教程：

[http://www.adobe.com/devnet/flex/videotraining/](http://www.adobe.com/devnet/flex/videotraining/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T13:13:15.990

你想做的就是 tweenMax 的用途。这是您添加到项目中的 .swc。它将允许您使用 tweenLite（或 tweenMax）命令。

```
import com.greensock.*;
TweenLite.to(mc, 1, {x:65, y:117}); 
```

所以你会说如果你的舞台是 500 像素宽并且你希望盒子从右边进来。将孩子添加到 505，然后将 tween.to 添加到您想要的任何 x 值。是的。就这么简单。其他参数是持续时间和缓动，甚至是 alpha，所以你也可以控制它。他们甚至在网站上有一个 swf，所以你可以玩它和练习。[http://www.greensock.com/tweenmax/](http://www.greensock.com/tweenmax/)

# mysql - 在 MySQL 中实现快速插入大量数据的最佳方法是什么？

> ID：314593
> 
> 赞同：8
> 
> 时间：2008-11-24T16:05:48.590
> 
> 标签：mysql, performance, load-data-infile, insert

我用 C 语言编写了一个程序来解析大型 XML 文件，然后使用插入语句创建文件。其他一些进程会将文件摄取到 MySQL 数据库中。这些数据将用作索引服务，以便用户可以轻松找到文档。

我选择 InnoDB 是因为它具有行级锁定的能力。C 程序将在给定调用上生成 500 到 500 万条插入语句。

尽快将所有这些数据输入数据库的最佳方法是什么？要注意的另一件事是数据库位于单独的服务器上。是否值得将文件移动到该服务器以加快插入速度？

编辑：该表不会真正更新，但行将被删除。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-24T16:13:33.410

*   使用 mysqlimport 工具或 LOAD DATA INFILE 命令。
*   暂时禁用不需要数据完整性的索引

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T16:13:28.013

[我会根据这个链接](http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)至少做这些事情：

1.  将文件移到那里并通过 unix 套接字连接
2.  [生成一个LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)文件，而不是 INSERTS
3.  在加载期间禁用索引

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T16:13:47.483

只要是只写表，具有标准表格式的 MySQL 就非常快；所以第一个问题是你是要更新还是删除。如果没有，请不要使用 innosys - 如果您只是附加，则无需锁定。您可以定期截断或重命名输出文件以处理表大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T16:15:42.143

### 1\. 确保您使用交易。

交易消除了

插入，同步到磁盘

重复阶段，而是在您提交事务时执行所有磁盘 IO。

### 2.确保使用连接压缩

原始文本 + GZip 压缩流 ~= 在某些情况下节省多达 90% 的带宽。

### 3\. 尽可能使用并行插入符号

```
INSERT INTO TableName(Col1,Col2) VALUES (1,1),(1,2),(1,3) 
```

（要发送的文字更少，动作更短）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T16:29:26.937

如果您不能像其他人建议的那样使用 LOAD DATA INFILE，请使用准备好的查询进行插入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T16:51:22.727

真的取决于发动机。如果您使用 InnoDB，请使用事务（您无法避免它们 - 但如果您使用自动提交，每个批次都隐含在其自己的 txn 中），但要确保它们既不太大也不太小。

如果您使用的是 MyISAM，则交易毫无意义。您可以通过禁用和启用索引来获得更好的插入速度，但这仅适用于空表。

如果你从一张空桌子开始，那通常是最好的。

无论哪种方式，加载数据都是赢家。

# c# - 使用 HTTPWebRequest 获取远程页面的标题

> ID：314594
> 
> 赞同：1
> 
> 时间：2008-11-24T16:06:01.057
> 
> 标签：c#, asp.net, http, httpwebrequest

我有一个 Web 服务，它充当网站群和一些分析软件之间的接口。部分分析跟踪需要获取页面标题。我不想将它从网页传递给网络服务，而是`HTTPWebRequest`用来调用页面。

我有代码可以获取整个页面并解析 html 以获取标题标签，但我不想下载整个页面来获取头部信息。

我开始了

```
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("url");  
request.Method = "HEAD"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T16:21:32.273

好主意，但[HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)请求仅返回文档的 HTTP 标头。这不包括标题元素，它是 HTTP 消息正文的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-23T01:15:24.400

尝试这个：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using System.IO;
using System.Text.RegularExpressions;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            string page = @"http://stackoverflow.com/";
            HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(page);
            StreamReader SR = new StreamReader(req.GetResponse().GetResponseStream());

            Char[] buf = new Char[256];
            int count = SR.Read(buf, 0, 256);
            while (count > 0)
            {
                String outputData = new String(buf, 0, count);
                Match match = Regex.Match(outputData, @"<title>([^<]+)", RegexOptions.IgnoreCase);
                if (match.Success)
                {
                    Console.WriteLine(match.Groups[1].Value);
                }
                count = SR.Read(buf, 0, 256);
            }
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-22T19:57:33.117

如果您不想请求整个页面，可以分段请求。http 规范定义了一个名为 Range 的 http 标头。你可以像下面这样使用它：

范围：字节=0-100

您可以查看返回的内容并找到标题。如果它不存在，那么请求 Range: 101-200 等等，直到你得到你需要的。

显然，Web 服务器需要支持范围，所以这可能会被击中或错过。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-24T16:33:30.657

所以我不得不去像......

```
HttpWebRequest req   = (HttpWebRequest)WebRequest.Create(URL);
HttpWebResponse resp = (HttpWebResponse)req.GetResponse();
Stream st            = resp.GetResponseStream();
StreamReader sr      = new StreamReader(st);
string buffer        = sr.ReadToEnd();
int startPos, endPos;
startPos = buffer.IndexOf("&lt;title>",
StringComparison.CurrentCultureIgnoreCase) + 7;
endPos = buffer.IndexOf("&lt;/title>",
StringComparison.CurrentCultureIgnoreCase);
string title = buffer.Substring(startPos, endPos - startPos);
Console.WriteLine("Response code from {0}: {1}", s,
        resp.StatusCode);
Console.WriteLine("Page title: {0}", title);
sr.Close();
st.Close(); 
```

# java - 为什么这个通用接口堆栈不起作用？

> ID：314600
> 
> 赞同：0
> 
> 时间：2008-11-24T16:07:15.093
> 
> 标签：java

我有一堆通用接口和类

```
public interface IElement {
// omited
}

class Element implements IElement {
// omited
}

public interface IElementList<E extends IElement>  extends Iterable {
   public Iterator<E> iterator();
}

class ElementList implements IElementList<Element> {

    public Iterator<Element> iterator() {
       // omited
       }
}

public interface IElementListGroup<E extends IElementList<? extends IElement>> {
    public E getChosenElementList();
}

class ElementListGroup implements IElementListGroup<ElementList> {
    public ElementList getChosenElementList() {
        // omited
    }
} 
```

然后是一个简单的代码

```
ElementListGroup group;

for(Element e : group.getChosenElementList())
{
 // omited
} 
```

并且带有 for 关键字的行会抛出“无法从元素类型对象转换为元素”编译器错误。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:16:39.037

`IElementList`需要实施`Iterable<E>`。否则，接口指定`Iterator iterator()`，而不是`Iterator<E> iterator()`。这使编译器认为您正在迭代`Object`s。

我做了这个改变，它编译得很好（在添加了一些空返回之后）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T16:18:24.400

您的函数返回 ElementList 而不是 Element，并且 ElementList 不是 Element 的可迭代对象

# java - 静态成员需要特殊的同步块吗？

> ID：314607
> 
> 赞同：4
> 
> 时间：2008-11-24T16:09:47.583
> 
> 标签：java, static, synchronization, locking

我有一个看起来像这样的类：

```
public class Test {

private static final Object someObject = new Object();

public void doSomething()
{
    synchronized (someObject) {
        System.out.println(someObject.toString());
    }
}

} 
```

我可以认为对象是同步的，还是因为它是静态成员而存在问题？

**编辑：**请注意，不同的线程可能正在访问 doSomething() 并且在这种情况下**必须**以线程安全的方式访问该对象。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:16:07.913

通过使用静态对象作为监控对象，只有一个使用 Test 类的任何实例的线程可以进入同步块。如果监视器对象不是静态对象，则持有不同 Test 类实例的其他线程可能会进入同步块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T16:27:45.427

这里**someObject**充当**所有**Test 类型对象的锁（监视器）。也就是说，如果在两个单独的 Test 实例上调用 doSomething()，则一个将在另一个完成之前阻塞。这与同步方法不同，同步方法基本上等同于上面的代码，其中**someObject**被替换为**this**。

**将someObject**更改为非静态将导致每个实例锁定。这本质上是*有效 Java*的第 70 项中描述的“私有锁定对象”习语。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T21:12:20.220

像这样获取特定于类的独立于实例的锁的常见模式是使用 Class 对象本身：

```
public class Test {
  public void doSomething() {
    synchronized (Test.class) {
      // something
    }
  }
} 
```

这实际上是同步静态方法所做的。当然，如果您想要多个这样的锁，则需要像示例中那样将它们声明为静态字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-14T16:15:02.177

如果使用不同的类加载器加载测试类会发生什么？

# php - php 包含在 html 文件目录中

> ID：314616
> 
> 赞同：2
> 
> 时间：2008-11-24T16:12:20.387
> 
> 标签：php, path, include, directory

是否所有 php 包含文件都必须位于包含目录中，或者这只是一种组织便利？我可以使用该目录的路径包含来自任何目录的文件吗？包含 php 包含的 html 文件是否必须具有 php 扩展名？如果是这样，我想这意味着我所有的 html 文档都将是 php，如果它们都有我计划“包含”的菜单。让您网站上的每个文件都是 php 文件的可接受协议吗？

谦恭地鞠躬……

ps 有没有关于这个话题的好圣经！？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:16:30.583

你不需要让你的 php 包含任何特定的地方，或者有任何文件扩展名......

调用 include('/path/to/your/file/with/any/extension.extension'); 应将其作为 php 文件包含在内

通常使用带有 php 扩展名的 php 代码调用文件会更安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:27:41.887

如果您将 PHP 放在 .html 文件中并包含（）它，它应该可以工作。但是，如果有人直接从服务器请求 .html 文件，他们可能会看到所有未处理的 PHP 代码，这很危险。因此，如果您这样做，那么要么将这些文件放在一个不可通过 Web 访问的目录中（例如，在文档根目录之上），要么更改您的 Web 服务器配置，以便将 .html 文件视为 PHP。

您应该能够包含（）任何文件，但如果 PHP 中存在 open_basedir 限制（您可能会在大多数网络主机上找到），您可能会遇到访问某些目录的问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T18:41:09.387

您可以包含来自服务器上任何位置的文件（当然取决于文件访问权限和安全限制）。

使用包含目录有助于保持井井有条，但不是必需的。

如果文件包含 PHP 代码，则应将其保存为 .php 文件 - 否则如果直接调用该文件，则代码将无法运行。这会给您留下一个行为不同的文件，具体取决于它的访问方式，这可能不是您想要的，并且可能是安全威胁。

为了解决这个问题，我看到有些人覆盖文件类型，因此服务器将所有 .html 文件视为 PHP 脚本 - 我不推荐这样做，因为它会减慢所有文件的处理速度，即使它们不包含任何 PHP。遵循最小意外原则 - 让您的 HTML 文件为 .html，您的 PHP 文件为 .php - 每个人都会更快乐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T20:40:59.360

詹姆斯·马瑟：

我认为您现在指的是 Apache SSI（请参阅[http://httpd.apache.org/docs/2.2/howto/ssi.html#standard-footer](http://httpd.apache.org/docs/2.2/howto/ssi.html#standard-footer)）

不知道答案，我试过了，这是我的结果

```
Extension  Call method        PHP runs
 .html      browser            no
 .html      Apache #include    no
 .html      PHP include()      yes
 .php       browser            yes
 .php       Apache #include    yes
 .php       PHP include()      yes 
```

（使用 WinXP、Apache 2.2.3、PHP 5.2.26 和 CentOS 5.2、Apache 2.2.3、PHP 5.1.16 进行测试）

所以你的答案是肯定的——如果你想通过 Apache SSI #include 调用 PHP 脚本，脚本必须有一个 .php 扩展名（或其他一些扩展名，即 .php4 .php5 等，它在 Apache 中注册为PHP 脚本），否则它不会运行。

# sharepoint - Sharepoint 列表视图设置

> ID：314617
> 
> 赞同：3
> 
> 时间：2008-11-24T16:12:28.657
> 
> 标签：sharepoint, list, view

我们创建了一个新的列表视图样式，它显示图片库中的缩略图，我们添加了一个超链接列，并使视图样式将超链接 url 映射到锚标记。

目的是当内容管理员想要创建基于图像的超链接列表时，他们只需创建一个图片库，然后添加一个 Web 部件视图，并将样式设置为我们的新定义。

它工作正常——我们已经关闭了许多工具栏、标题、边框等——但底部仍然有一个“排序栏”，允许用户更改列表的顺序。我们想要关闭它的选项 - 但我们找不到关闭它的设置。

有人知道吗？

[替代文字 http://img513.imageshack.us/img513/3674/sortbarrb4.png](http://img513.imageshack.us/img513/3674/sortbarrb4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T03:31:14.353

**更新**

看起来我错了，您将不得不使用 CSS 来隐藏样式栏。它确实感觉很像一种 hack，但事实证明，它是我们出于对开发成本实用性的渴望而使用的一种。

混蛋！

**原来的**

您可以在 12 配置单元 (C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\GLOBAL\XML) 中编辑 vwstyles.xml 文件。这可以精确控制视图的外观。不幸的是，呈现 html 的 xml 非常难看。

我建议您在 xml 中创建自己的 vwstyle 并将视图的样式设置为使用新创建的样式。

# jquery - 如何在 jQuery 的 SELECT 元素中选择特定选项？

> ID：314636
> 
> 赞同：783
> 
> 时间：2008-11-24T16:18:19.923
> 
> 标签：jquery

如果您知道索引、值或文本。如果您没有直接参考的 ID。

[这个](https://stackoverflow.com/questions/149573/check-if-option-is-selected-with-jquery-if-not-select-a-default#149820)、[这个](https://stackoverflow.com/questions/196684/jquery-get-select-option-text#196687)和[这个](https://stackoverflow.com/questions/47824/using-core-jquery-how-do-you-remove-all-the-options-of-a-select-box-then-add-on#47829)都是有用的答案。

示例标记

```
<div class="selDiv">
  <select class="opts">
    <option selected value="DEFAULT">Default</option>
    <option value="SEL1">Selection 1</option>
    <option value="SEL2">Selection 2</option>
  </select>
</div> 
```

* * *

## 回答 #1

> 赞同：1314
> 
> 时间：2011-05-20T06:38:10.747

按值获取中间选项元素的选择器是

```
$('.selDiv option[value="SEL1"]') 
```

对于索引：

```
$('.selDiv option:eq(1)') 
```

对于已知文本：

```
$('.selDiv option:contains("Selection 1")') 
```

**编辑**：如上所述，OP 可能是在更改下拉列表的选定项目之后。在 1.6 及更高版本中，建议使用 prop() 方法：

```
$('.selDiv option:eq(1)').prop('selected', true) 
```

在旧版本中：

```
$('.selDiv option:eq(1)').attr('selected', 'selected') 
```

**EDIT2**：在瑞安的评论之后。“选择 10”上的匹配项可能是不需要的。我发现没有[选择器](http://api.jquery.com/category/selectors/)与全文匹配，但[过滤器](http://api.jquery.com/filter/)有效：

```
 $('.selDiv option')
    .filter(function(i, e) { return $(e).text() == "Selection 1"}) 
```

**EDIT3**：谨慎使用，`$(e).text()`因为它可能包含一个换行符，使比较失败。This happens when the options are implicitly closed (no `</option>`tag):

```
<select ...>
<option value="1">Selection 1
<option value="2">Selection 2
   :
</select> 
```

如果您只是使用`e.text`任何额外的空格，例如尾随换行符，则会被删除，从而使比较更加稳健。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2011-12-01T01:05:37.697

上述方法都没有提供我需要的解决方案，所以我想我会提供对我有用的方法。

```
$('#element option[value="no"]').attr("selected", "selected"); 
```

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2009-12-02T19:49:50.640

你可以只使用`val()`方法：

```
$('select').val('the_value'); 
```

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2013-05-07T14:14:10.760

**按价值计算，使用jQuery 1.7**对我有用的是下面的代码，试试这个：

```
$('#id option[value=theOptionValue]').prop('selected', 'selected').change(); 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2016-09-06T11:50:06.533

有很多方法可以做到这一点，但最干净的方法已经在顶级答案和大量争论中丢失了`val()`。从 jQuery 1.6 开始，一些方法也发生了变化，因此需要更新。

对于以下示例，我将假设变量`$select`是指向所需`<select>`标签的 jQuery 对象，例如通过以下方式：

```
var $select = $('.selDiv .opts'); 
```

## 注 1 - 使用 val() 进行值匹配：

对于值匹配，使用`val()`比使用属性选择器要简单得多：[https ://jsfiddle.net/yz7tu49b/6/](https://jsfiddle.net/yz7tu49b/6/)

```
$select.val("SEL2"); 
```

的 setter 版本是通过将 match 的属性设置为 same`.val()`在`select`标签上实现的，因此在所有现代浏览器上都可以正常工作。`selected``option``value`

## 注 2 - 使用 prop('selected', true)：

如果要直接设置选项的选中状态，可以使用`prop`(not `attr`) 和`boolean`参数（而不是文本 value `selected`）：

例如[https://jsfiddle.net/yz7tu49b/](https://jsfiddle.net/yz7tu49b/)

```
$option.prop('selected', true);  // Will add selected="selected" to the tag 
```

## 注 3 - 允许未知值：

如果您用于`val()`选择一个`<option>`，但 val 不匹配（可能会根据值的来源发生），则选择“无”`$select.val()`并将返回`null`。

因此，对于显示的示例，并且为了稳健起见，您可以使用类似[https://jsfiddle.net/1250Ldqn/](https://jsfiddle.net/1250Ldqn/)的内容：

```
var $select = $('.selDiv .opts');
$select.val("SEL2");
if ($select.val() == null) {
  $select.val("DEFAULT");
} 
```

## 注 4 - 精确文本匹配：

如果你想通过精确的文本匹配，你可以使用`filter`with 函数。例如[https://jsfiddle.net/yz7tu49b/2/](https://jsfiddle.net/yz7tu49b/2/)：

```
var $select = $('.selDiv .opts');
$select.children().filter(function(){
    return this.text == "Selection 2";
}).prop('selected', true); 
```

虽然如果您可能有额外的空白，您可能希望在检查中添加修剪，如

```
 return $.trim(this.text) == "some value to match"; 
```

## 注 5 - 按索引匹配

如果您想按索引匹配，只需索引选择的子项，例如[https://jsfiddle.net/yz7tu49b/3/](https://jsfiddle.net/yz7tu49b/3/)

```
var $select = $('.selDiv .opts');
var index = 2;
$select.children()[index].selected = true; 
```

虽然我现在倾向于避免直接的 DOM 属性而支持 jQuery，但为了未来的代码，这也可以作为[https://jsfiddle.net/yz7tu49b/5/](https://jsfiddle.net/yz7tu49b/5/)完成：

```
var $select = $('.selDiv .opts');
var index = 2;
$select.children().eq(index).prop('selected', true); 
```

## 注 6 - 使用 change() 触发新选择

在上述所有情况下，更改事件都不会触发。这是设计使然，这样您就不会遇到递归更改事件。

要生成更改事件，如果需要，只需添加`.change()`对 jQuery`select`对象的调用。例如，第一个最简单的例子变成了[https://jsfiddle.net/yz7tu49b/7/](https://jsfiddle.net/yz7tu49b/7/)

```
var $select = $('.selDiv .opts');
$select.val("SEL2").change(); 
```

还有很多其他方法可以使用属性选择器来查找元素，例如`[value="SEL2"]`，但您必须记住，与所有其他选项相比，属性选择器相对较慢。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-12-16T18:17:00.113

```
 $(elem).find('option[value="' + value + '"]').attr("selected", "selected"); 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2018-02-17T05:04:54.640

# 确实可以尝试以下方法

> 对于普通选择选项

```
<script>    
    $(document).ready(function() {
    $("#id").val('select value here');
       });
        </script> 
```

> 对于选择 2 选项**触发**选项需要使用

```
<script>    
        $(document).ready(function() {
        $("#id").val('select value here').trigger('change');
           });
            </script> 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2012-02-01T17:34:59.517

您可以命名选择并使用它：

```
$("select[name='theNameYouChose']").find("option[value='theValueYouWantSelected']").attr("selected",true); 
```

它应该选择您想要的选项。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2016-01-05T14:58:54.323

使用**jquery-2.1.4**，我发现以下答案对我有用：

```
$('#MySelectionBox').val(123).change(); 
```

如果您有字符串值，请尝试以下操作：

```
$('#MySelectionBox').val("extra thing").change(); 
```

其他示例对我不起作用，这就是我添加此答案的原因。

我在以下位置找到了原始答案： [https ://forum.jquery.com/topic/how-to-dynamically-select-option-in-dropdown-menu](https://forum.jquery.com/topic/how-to-dynamically-select-option-in-dropdown-menu)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-11-24T16:19:40.717

回答我自己的文档问题。我敢肯定还有其他方法可以实现这一点，但这是可行的，并且此代码已经过测试。

```
<html>
<head>
<script language="Javascript" src="javascript/jquery-1.2.6.min.js"></script>
<script type="text/JavaScript">

$(function() {
    $(".update").bind("click",      // bind the click event to a div
        function() {
            var selectOption = $('.selDiv').children('.opts') ;
            var _this = $(this).next().children(".opts") ;

            $(selectOption).find("option[index='0']").attr("selected","selected");
//          $(selectOption).find("option[value='DEFAULT']").attr("selected","selected");
//          $(selectOption).find("option[text='Default']").attr("selected","selected");

//          $(_this).find("option[value='DEFAULT']").attr("selected","selected");
//          $(_this).find("option[text='Default']").attr("selected","selected");
//          $(_this).find("option[index='0']").attr("selected","selected");

    }); // END Bind
}); // End eventlistener

</script>
</head>
<body>
<div class="update" style="height:50px; color:blue; cursor:pointer;">Update</div>
<div class="selDiv">
        <select class="opts">
            <option selected value="DEFAULT">Default</option>
            <option value="SEL1">Selection 1</option>
            <option value="SEL2">Selection 2</option>
        </select>
    </div>
</body>
</html> 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2017-06-06T05:54:29.273

在选择触发的情况下设置选择值：

```
$('select.opts').val('SEL1').change(); 
```

* * *

从范围设置选项：

```
$('.selDiv option[value="SEL1"]')
    .attr('selected', 'selected')
    .change(); 
```

此代码使用选择器找出带有条件的 select 对象，然后将 selected 属性更改为`attr()`。

* * *

此外，我建议`change()`在将属性设置为 之后添加事件`selected`，这样代码将接近于更改用户的选择。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-10-11T13:47:34.573

当我知道列表的索引时，我会使用它。

```
$("#yourlist :nth(1)").prop("selected","selected").change(); 
```

这允许列表更改，并触发更改事件。":nth(n)" 从索引 0 开始计数

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2017-09-22T18:27:57.103

# 试试这个

*您只需使用选择字段 id 而不是 #id (ie.#select_name)*

*而不是**选项值**使用您选择的选项**值***

```
 <script>
    $(document).ready(function() {
$("#id option[value='option value']").attr('selected',true);
   });
    </script> 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2019-07-09T12:53:04.747

```
 $('#select option[data-id-estado="3"]').prop("selected",true).trigger("change");

// or

    $('#select option[value="myValue"]').prop("selected",true).trigger("change"); 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2013-08-14T08:05:06.320

我会去： -

```
$("select#my-select option") .each(function() { this.selected = (this.text == myVal); }); 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2016-05-30T06:49:20.220

```
/* This will reset your select box with "-- Please Select --"   */ 
    <script>
    $(document).ready(function() {
        $("#gate option[value='']").prop('selected', true);
    });
    </script> 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-03-01T14:11:57.073

如果您将属性发送到函数并需要更新选择选项，则选择 Jquery

```
$('#yourElement option[value="'+yourValue+'"]').attr('selected', 'selected');
$('#editLocationCity').chosen().change();
$('#editLocationCity').trigger('liszt:updated'); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-11-15T07:35:30.963

看起来是正确的`$('select').val('the_value');`解决方案，如果您有数据表行，那么：

```
$row.find('#component').val('All'); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-02-04T02:06:03.803

如果你不想使用 jQuery，你可以使用下面的代码：

```
document.getElementById("mySelect").selectedIndex = "2"; 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2016-10-23T04:12:15.647

谢谢你的问题。希望这段代码对你有用。

```
var val = $("select.opts:visible option:selected ").val(); 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-08-16T02:34:33.240

有一些建议为什么你应该使用`prop`而不是`attr.`肯定使用`prop`，因为我已经测试了这两个并且`attr`会给你奇怪的结果，除了最简单的情况。

我想要一个解决方案，从任意分组的选项中选择自动选择同一页面上的`select`另一个输入。`select`例如，如果您有 2 个下拉菜单 - 一个用于国家/地区，另一个用于大洲。在这种情况下，选择任何国家会自动在另一个大陆下拉列表中选择该国家的大陆。

```
$("#country").on("change", function() {
  //get continent
  var originLocationRegion = $(this).find(":selected").data("origin-region");

  //select continent correctly with prop
  $('#continent option[value="' + originLocationRegion + '"]').prop('selected', true);
});

$("#country2").on("change", function() {
  //get continent
  var originLocationRegion = $(this).find(":selected").data("origin-region");

  //select continent wrongly with attr
  $('#continent2 option[value="' + originLocationRegion + '"]').attr('selected', true);
});
```

```
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div class="container">
  <form>
    <h4 class="text-success">Props to the good stuff ;) </h4>
    <div class="form-row">
      <div class="form-group col-md-6 col-sm-6">
        <label>Conuntries</label>
        <select class="custom-select country" id="country">
          <option disabled selected>Select Country </option>
          <option data-origin-region="Asia" value="Afghanistan">Afghanistan</option>
          <option data-origin-region="Antartica" value="Antartica">Antartica</option>
          <option data-origin-region="Australia" value="Australia">Australia</option>
          <option data-origin-region="Europe" value="Austria">Austria</option>
          <option data-origin-region="Asia" value="Bangladesh">Bangladesh</option>
          <option data-origin-region="South America" value="Brazil">Brazil</option>
          <option data-origin-region="Africa" value="Cameroon">Cameroon</option>
          <option data-origin-region="North America" value="Canada">Canada</option>
          <option data-origin-region="South America" value="Chile">Chile</option>
          <option data-origin-region="Asia" value="China">China</option>
          <option data-origin-region="South America" value="Ecuador">Ecuador</option>
          <option data-origin-region="Australia" value="Fiji">Fiji</option>
          <option data-origin-region="North America" value="Mexico">Mexico</option>
          <option data-origin-region="Australia" value="New Zealand">New Zealand</option>
          <option data-origin-region="Africa" value="Nigeria">Nigeria</option>
          <option data-origin-region="Europe" value="Portugal">Portugal</option>
          <option data-origin-region="Africa" value="Seychelles">Seychelles</option>
          <option data-origin-region="North America" value="United States">United States</option>
          <option data-origin-region="Europe" value="United Kingdom">United Kingdom</option>
        </select>
      </div>
      <div class="form-group col-md-6 col-sm-6">
        <label>Continent</label>
        <select class="custom-select" id="continent">
          <option disabled selected>Select Continent</option>
          <option disabled value="Africa">Africa</option>
          <option disabled value="Antartica">Antartica</option>
          <option disabled value="Asia">Asia</option>
          <option disabled value="Europe">Europe</option>
          <option disabled value="North America">North America</option>
          <option disabled value="Australia">Australia</option>
          <option disabled value="South America">South America</option>
        </select>
      </div>
    </div>
  </form>
  <hr>

  <form>
    <h4 class="text-danger"> Attributing the bad stuff to attr </h4>
    <div class="form-row">
      <div class="form-group col-md-6 col-sm-6">
        <label>Conuntries</label>
        <select class="custom-select country-2" id="country2">
          <option disabled selected>Select Country </option>
          <option data-origin-region="Asia" value="Afghanistan">Afghanistan</option>
          <option data-origin-region="Antartica" value="Antartica">Antartica</option>
          <option data-origin-region="Australia" value="Australia">Australia</option>
          <option data-origin-region="Europe" value="Austria">Austria</option>
          <option data-origin-region="Asia" value="Bangladesh">Bangladesh</option>
          <option data-origin-region="South America" value="Brazil">Brazil</option>
          <option data-origin-region="Africa" value="Cameroon">Cameroon</option>
          <option data-origin-region="North America" value="Canada">Canada</option>
          <option data-origin-region="South America" value="Chile">Chile</option>
          <option data-origin-region="Asia" value="China">China</option>
          <option data-origin-region="South America" value="Ecuador">Ecuador</option>
          <option data-origin-region="Australia" value="Fiji">Fiji</option>
          <option data-origin-region="North America" value="Mexico">Mexico</option>
          <option data-origin-region="Australia" value="New Zealand">New Zealand</option>
          <option data-origin-region="Africa" value="Nigeria">Nigeria</option>
          <option data-origin-region="Europe" value="Portugal">Portugal</option>
          <option data-origin-region="Africa" value="Seychelles">Seychelles</option>
          <option data-origin-region="North America" value="United States">United States</option>
          <option data-origin-region="Europe" value="United Kingdom">United Kingdom</option>
        </select>
      </div>
      <div class="form-group col-md-6 col-sm-6">
        <label>Continent</label>
        <select class="custom-select" id="continent2">
          <option disabled selected>Select Continent</option>
          <option disabled value="Africa">Africa</option>
          <option disabled value="Antartica">Antartica</option>
          <option disabled value="Asia">Asia</option>
          <option disabled value="Europe">Europe</option>
          <option disabled value="North America">North America</option>
          <option disabled value="Australia">Australia</option>
          <option disabled value="South America">South America</option>
        </select>
      </div>
    </div>
  </form>
</div>
```

如代码片段所示，`prop`每次都可以正常工作，但`attr`一旦选择了一次选项，就无法正确选择。

**关键点：**我们通常对属性的属性感兴趣，因此在大多数情况下使用它更`prop`安全`attr`。

# regex - 需要一个正则表达式来排除某些字符串

> ID：314639
> 
> 赞同：8
> 
> 时间：2008-11-24T16:18:35.803
> 
> 标签：regex

我正在尝试获得一个匹配的正则表达式：

```
somefile_1.txt
somefile_2.txt
somefile_{anything}.txt 
```

但不匹配：

```
somefile_16.txt 
```

我试过

```
somefile_[^(16)].txt 
```

没有运气（它甚至包括“16”记录）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T16:21:49.417

一些正则表达式库允许前瞻：

```
somefile(?!16\.txt$).*?\.txt 
```

否则，您仍然可以使用多个字符类：

```
somefile([^1].|1[^6]|.|.{3,})\.txt 
```

或者，为了实现最大的可移植性：

```
somefile([^1].|1[^6]|.|....*)\.txt 
```

`[^(16)]`表示：匹配除大括号、1 和 6 之外的任何字符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T16:36:38.233

已经提到了最好的解决方案：

```
somefile_(?!16\.txt$).*\.txt 
```

这行得通，并且足够贪婪，可以在同一条线上接受任何东西。但是，如果您知道您想要一个有效的文件名，我建议您也限制无效字符：

```
somefile_(?!16)[^?%*:|"<>]*\.txt 
```

如果您正在使用不支持前瞻的正则表达式引擎，您将不得不考虑如何弥补！16。您可以将文件分成两组，一组以 1 开头，后面不跟 6，另一组以其他任何开头：

```
somefile_(1[^6]|[^1]).*\.txt 
```

如果你想允许 somefile_16_stuff.txt 但不允许 somefile_16.txt，上面的这些正则表达式是不够的。您需要以不同的方式设置限制：

```
somefile_(16.|1[^6]|[^1]).*\.txt 
```

将所有这些结合起来，您最终会得到两种可能性，一种会阻止单个实例 (somefile_16.txt)，另一种会阻止所有族 (somefile_16*.txt)。我个人认为你更喜欢第一个：

```
somefile_((16[^?%*:|"<>]|1[^6?%*:|"<>]|[^1?%*:|"<>])[^?%*:|"<>]*|1)\.txt
somefile_((1[^6?%*:|"<>]|[^1?%*:|"<>])[^?%*:|"<>]*|1)\.txt 
```

在没有删除特殊字符的版本中，这样更容易阅读：

```
somefile_((16.|1[^6]|[^1).*|1)\.txt
somefile_((1[^6]|[^1]).*|1)\.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-24T16:37:25.733

要严格遵守您的规范并保持挑剔，您应该使用：

```
^somefile_(?!16\.txt$).*\.txt$ 
```

以便可以匹配 {anything} 的 somefile_1666.txt ;)

但有时使用起来更具可读性......：

```
ls | grep -e 'somefile_.*\.txt' | grep -v -e 'somefile_16\.txt' 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T16:26:52.870

```
somefile_(?!16).*\.txt 
```

(?!16) 表示：断言不可能匹配从该位置开始的正则表达式“16”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-24T16:39:52.577

有时使用两个正则表达式更容易。首先寻找你想要的一切，然后忽略你不想要的一切。我一直在命令行上执行此操作，在该命令行中，我将一个正则表达式传递到另一个忽略我不想要的东西的正则表达式中，该正则表达式获取一个超集。

如果目标是完成工作而不是找到完美的正则表达式，请考虑这种方法。它通常比使用奇异特性的正则表达式更容易编写和理解。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-24T16:42:30.733

不使用前瞻

```
somefile_(|.|[^1].+|10|11|12|13|14|15|17|18|19|.{3,}).txt 
```

像这样阅读：`somefile_`后跟：

1.  没有。
2.  一个字符。
3.  任何一个字符，但`1`后面是任何其他字符。
4.  三个或更多字符。
5.  要么`10`..`19`注意`16`已被遗漏。

最后是`.txt`.

# mod-rewrite - Mod重写恶作剧

> ID：314647
> 
> 赞同：2
> 
> 时间：2008-11-24T16:20:40.403
> 
> 标签：mod-rewrite

我有这个重写规则

```
RewriteEngine On
RewriteBase /location/
RewriteRule ^(.+)/?$ index.php?franchise=$1 
```

假设更改此 URL

```
http://example.com/location/kings-lynn 
```

进这个

```
http://example.com/location/index.php?franchise=kings-lynn 
```

但相反，我得到了这个

```
http://example.com/location/index.php?franchise=index.php 
```

此外，添加栏杆斜线会破坏它。我得到 index.php 页面显示，但没有加载任何样式表或 javascript。

我显然做错了什么，但我不知道尽管在这里花了一整天的 R'ingTFM 和许多在线入门、教程和问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T16:22:59.553

您的问题是您要重定向两次。

`'location/index.php'`匹配正则表达式`^(.+)/?$`

您可能希望使用“如果文件不存在”条件使其不尝试第二次映射。

```
RewriteEngine on
RewriteBase /location/
RewriteCond %{REQUEST_FILENAME} !-f   # ignore existing files
RewriteCond %{REQUEST_FILENAME} !-d   # ignore existing directories
RewriteRule ^(.+)/?$ index.php?franchise=$1  [L,QSA] 
```

此外，还有 [L,QSA] 试图使其成为“最后一个”规则（注意，它的工作原理并不完全明显）并将查询字符串附加到查询中，这样

```
location/foobar/?baz=quux  ==> index.php?franchise=$1&baz=quux 
```

（ 我想 ）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T16:24:04.950

在我看来，重写过滤器好像执行了两次。尝试添加最后一个标志

```
RewriteRule ^(.+)/?$ index.php?franchise=$1 [L] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T16:24:39.037

您的规则自我匹配，因此它将引用自己。

# perl - 编写 Perl CGI 应用程序的最佳方式是什么？

> ID：314654
> 
> 赞同：10
> 
> 时间：2008-11-24T16:23:15.390
> 
> 标签：perl, cgi

我看到的每个 CGI/Perl 示例基本上都是一堆包含 HTML 的打印语句，这似乎不是编写 CGI 应用程序的最佳方式。有一个更好的方法吗？谢谢。

编辑：我决定使用 CGI::Application 和 HTML::Template，并使用以下教程：[http://docs.google.com/View?docid=dd363fg9_77gb4hdh7b](http://docs.google.com/View?docid=dd363fg9_77gb4hdh7b)。谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-24T16:38:20.943

绝对是（您可能正在查看 90 年代的教程）。你会想要选择一个框架。在 Perl 领域，这些是最受欢迎的选择：

*   [CGI::Application](http://search.cpan.org/perldoc?CGI::Application) - 非常轻量级，有很多社区插件
*   [催化剂](http://search.cpan.org/perldoc?Catalyst)- 更重，更多花里胡哨
*   [jifty](http://search.cpan.org/perldoc?Jifty) - 比上面更神奇

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-24T16:45:23.643

这是一个非常非常大的问题。简而言之，更好的方法称为[模型/视图/控制器](http://en.wikipedia.org/wiki/Model-view-controller)（又名 MVC）。使用 MVC，您的应用程序分为三个部分。

模型是您的数据和业务逻辑。它是构成应用程序核心的东西。

视图是向用户展示事物的代码。在 Web 应用程序中，这通常是某种模板系统，但也可以是 PDF 或 Excel 电子表格。基本上，它是输出。

最后，你有控制器。这负责将模型和视图放在一起。它接受用户的请求，获取相关的模型对象，并调用适当的视图。

mpeters 已经提到了几个 Perl 的 MVC 框架。您还需要选择一个模板引擎。最受欢迎的两个是[Template Toolkit](http://www.tt2.org/)和[Mason](http://www.masonhq.com/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-24T18:31:50.543

暂时离开 CGI 与 MVC 框架的问题，您需要的是来自 CPAN 的输出模板模块之一。

模板工具包非常流行（CPAN 上的Template.pm） Text::Template、HTML::Template 和 HTML::Mason 也很流行。

HTML::Mason 不仅仅是一个模板模块，因此对于一个简单的 CGI 应用程序来说可能有点太重了，但是在您决定哪个最适合您的时候值得研究一下。

Text::Template 相当简单，并且在模板中使用 Perl，因此您可以循环数据并在 Perl 中执行显示逻辑。人们认为这既有利也有弊。

HTML::Template 也小而简单。它实现了自己的一组标签，用于 if/then/else 处理、变量设置和循环。就是这样。由于与 Text::Template 完全相反的原因，这被视为有利也有弊。

模板工具包 (TT) 实现了一种非常庞大的、失败的模板语言，其中包括循环和逻辑等等。

我使用了 HTML::Template 之一，发现我想要更多的功能。然后我成功地使用了 Text::Template，但发现它想要玩弄命名空间有点烦人。我开始了解并喜欢 Template Toolkit。对我来说，感觉是对的。你的旅费可能会改变。

当然，仍然有旧的“打印 HTML”方法，有时几个打印语句就足够了。但是您已经想到了将显示与主要逻辑分开的想法。这是一件好事。

这是通往模型/视图/控制器 (MVC) 之路的第一步，在其中您将数据模型和业务逻辑分开（您的代码接受输入，对其进行处理并决定需要输出的内容），您的输入/output（模板或打印语句 - HTML、PDF 等），以及连接两者的代码（CGI、CGI::Application、Catalyst MVC 框架等）。这个想法是改变你的数据结构（在模型中）不应该需要改变你的输出例程（视图）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-24T17:28:31.450

[Perl5 Wiki](http://www.perlfoundation.org/perl5/index.cgi?perl_5_wiki)提供了一个很好的（虽然还不完整）[网络框架](http://www.perlfoundation.org/perl5/index.cgi?web_frameworks)和[模板](http://www.perlfoundation.org/perl5/index.cgi?templates)列表。

“模板” wiki 条目中链接的比较文章值得一读。我还建议阅读有关 PerlMonks 的[推送式模板系统](http://www.perlmonks.org/?node_id=674225)文章。

对于模板，[Template Toolkit](http://search.cpan.org/dist/Template-Toolkit/)是我使用最多的工具包，强烈推荐它。还有一本[O'Reilly 的书](http://www.template-toolkit.org/book.html)，它可能是 Perl 王国（在 Web 框架内部或外部）中最常用的模板系统。

我越来越喜欢的另一种方法是非模板“构建器”解决方案。像[Template::Declare](http://search.cpan.org/dist/Template-Declare/) & [HTML::AsSubs](http://search.cpan.org/dist/HTML-Tree/lib/HTML/AsSubs.pm)这样的模块符合这个要求。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-25T09:56:59.943

我认为在 Framework/Roll-your-own 困境中取得适当平衡的一种解决方案是使用三个关键的 perl 模块：[CGI.pm](http://cpan.uwinnipeg.ca/htdocs/CGI.pm/CGI.pm.html#ABSTRACT)、[Template Toolkit](http://www.tt2.org/)和[DBI](http://cpan.uwinnipeg.ca/htdocs/DBI/DBI/FAQ.html#Basic_Information_amp_Information_So)。使用这三个模块，您可以进行易于编写和维护的优雅 MVC 编程。

这三个模块都非常灵活，模板工具包 (TT) 允许您在需要时以 html、XML 甚至 pdf 格式输出数据。您还可以在 TT 中包含 perl 逻辑，甚至在其中添加您的数据库接口。这使您的 CGI 脚本非常小且易于维护，尤其是当您使用“标准”编译指示时。

它还允许您将 JavaScript 和 AJAXy 内容放入模板本身，从而模拟客户端和服务器之间的分离。

这三个模块是 CPAN 上最受欢迎的模块之一，具有出色的文档和广泛的用户群。此外，使用这些进行开发意味着一旦您对代码进行了原型设计，您就可以快速迁移到 mod_perl，从而快速过渡到 Apache 的嵌入式 perl 环境。

总而言之，一个紧凑而灵活的工具集。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-24T17:34:37.163

您还可以将表示与代码分开，只使用模板系统，而​​无需引入成熟框架的所有开销。 [Template Toolkit](http://www.tt2.org/)可以像[Mason](http://www.masonhq.com/)一样以这种方式单独使用，尽管我倾向于认为它更像是一个伪装成模板系统的框架。

但是，如果您非常热衷于将代码与演示文稿分离，请注意 TT 和 Mason 都允许（甚至鼓励，取决于您阅读的文档）将可执行代码嵌入到模板中。就个人而言，我觉得在你的 HTML 中嵌入代码并不比在你的代码中嵌入 HTML 更好，所以我倾向于选择[HTML::Template](http://search.cpan.org/~samtregar/HTML-Template-2.9/Template.pm)。

# search - “我自言自语”是什么意思？

> ID：314658
> 
> 赞同：0
> 
> 时间：2008-11-24T16:24:03.000
> 
> 标签：search

在网上搜索短语“I cosay”。我在技术论坛中不时遇到这个短语，但在我的一生中，我无法弄清楚它的含义或在使用它的对话环境中它是如何有意义的。

我只是落后于时代了吗？新俚语？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T16:33:19.707

据我从谷歌提取的上下文中可以看出，它是一种机器翻译非常糟糕的“codigo”形式。“digo”或某个变体是“I say”，所以当它根本不应该翻译时，它形成了“I cosay”。粗略翻译它应该是“代码”或“编码”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T16:28:56.173

这是 Psycho 的猪拉丁语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T16:25:21.920

在没有上下文的情况下，我不得不说 cosay 是与 cosine 是 sine 的反义词一样的反义词。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T16:34:18.987

从使用语境来看，它看起来像是协议的俚语——你说 X，我说 X——可能是由非英语母语人士发明的——但这并不涵盖所有的使用语境......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T16:44:02.150

在魁北克（不是法国）的法语中，它的意思是：“我不明白你在说什么，你能再说一遍吗？” 但这是一种非常低级的语言......没有正式的，不应该使用......经常孩子使用那种表达......

# java - 如何在 Spring 应用程序上下文中注入 Jakarta 枚举？

> ID：314664
> 
> 赞同：2
> 
> 时间：2008-11-24T16:24:49.240
> 
> 标签：java, spring, enums

我有一个构造函数采用[Jakarta enums](http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/enums/Enum.html)的类。我试图找到如何通过[Spring](http://www.springframework.org/) XML aplicationContext 轻松注入它。

例如 ：

枚举：

```
public class MyEnum extends org.apache.commons.lang.enums.Enum {
    public static final MyEnum MY_FIRST_VALUE = new MyEnum("MyFirstValue");
    public static final MyEnum MY_SECOND_VALUE = new MyEnum("MySecondValue");

    public static MyEnum getEnum(String name) {
        return (MyEnum) getEnum(MyEnum.class, name);
    }
    [...other standard enum methods]
} 
```

注入的类：

```
public class MyService {
    private final MyEnum status;
    public MyService(MyEnum status) {
        this.status = status;
    }
} 
```

应用程序上下文：

```
<bean id="myService" class="MyService">
    <constructor-arg index="0" value="MyFirstValue" />
</bean> 
```

当然，我有一个`no matching editors or conversion strategy found`错误。Spring 和 Jakarta 枚举之间是否有简单的集成？还是我应该编写自己的 PropertyEditor ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T17:13:47.237

查看`<util:constant>`Spring 中的标签。它将要求您将架构添加到您的 xml 定义中。所以你会得到以下结果：

```
<bean id="myService" class="MyService">
  <constructor-arg index="0">
    <util:constant static-field="MyEnum.MY_FIRST_VALUE"/>
  </constructor-arg>
</bean> 
```

标签的定义和用法（包括 XSD def）可以在[这里](http://static.springframework.org/spring/docs/2.5.x/reference/xsd-config.html#xsd-config-body-schemas-util)找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:40:58.177

我找到了一个解决方案，但它非常冗长（对我来说太过分了）：

```
<bean id="myService" class="MyService">
    <constructor-arg index="0">
        <bean class="MyEnum" factory-method="getEnum">
            <constructor-arg value="MyFirstValue" />
        </bean>
    </constructor-arg>
</bean> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-19T19:13:16.593

我投票赞成 Spencer 的回答，但发现这也可以。在此示例中，您只需在构造函数参数中指定**索引、类型**和**名称。**

```
<bean id="myService" class="MyService">
<constructor-arg index="0" type="com.package.MyEnum" value="MyFirstValue" />
</bean> 
```

我基于收到的错误消息：

> *（提示：为简单参数指定索引/类型/名称参数以避免类型歧义）*

# bash - 如何在脚本本身内重定向整个 shell 脚本的输出？

> ID：314675
> 
> 赞同：247
> 
> 时间：2008-11-24T16:28:21.447
> 
> 标签：bash, shell, sh

是否可以将 Bourne shell 脚本的所有输出重定向到某个地方，但在脚本本身内部使用 shell 命令？

重定向单个命令的输出很容易，但我想要更像这样的东西：

```
#!/bin/sh
if [ ! -t 0 ]; then
    # redirect all of my output to a file here
fi

# rest of script... 
```

含义：如果脚本以非交互方式运行（例如，cron），则将所有内容的输出保存到文件中。如果从 shell 以交互方式运行，让输出像往常一样转到标准输出。

我想为通常由 FreeBSD 定期实用程序运行的脚本执行此操作。这是日常运行的一部分，我通常不关心每天在电子邮件中看到它，所以我没有发送它。但是，如果这个特定脚本中的某些东西失败了，那对我来说很重要，我希望能够捕获并通过电子邮件发送日常工作的这一部分的输出。

更新：Joshua 的回答很准确，但我也想围绕整个脚本保存和恢复 stdout 和 stderr，这样做是这样的：

```
# save stdout and stderr to file 
# descriptors 3 and 4, 
# then redirect them to "foo"
exec 3>&1 4>&2 >foo 2>&1

# ...

# restore stdout and stderr
exec 1>&3 2>&4 
```

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2008-11-24T19:11:28.293

解决更新后的问题。

```
#...part of script without redirection...

{
    #...part of script with redirection...
} > file1 2>file2 # ...and others as appropriate...

#...residue of script without redirection... 
```

大括号 '{ ... }' 提供了一个 I/O 重定向单元。大括号必须出现在命令可能出现的地方——简单地说，在行首或分号之后。（*是的，这可以更精确；如果您想狡辩，请告诉我。*）

您是对的，您可以使用您显示的重定向保留原始 stdout 和 stderr，但是对于以后必须维护脚本的人来说，如果您将重定向代码的范围设置为如上所示，则通常更容易理解发生了什么。

Bash 手册的相关部分是[Grouping Commands](https://www.gnu.org/software/bash/manual/bash.html#Command-Grouping)和[I/O Redirection](https://www.gnu.org/software/bash/manual/bash.html#Redirections)。POSIX shell 规范的相关部分是[Compound Commands](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_09_04)和[I/O Redirection](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07)。Bash 有一些额外的符号，但在其他方面类似于 POSIX shell 规范。

* * *

## 回答 #2

> 赞同：214
> 
> 时间：2008-11-24T16:29:52.957

通常，我们会将其中之一放置在脚本顶部或附近。解析其命令行的脚本将在解析后进行重定向。

将标准输出发送到文件

```
exec > file 
```

与标准错误

```
exec > file                                                                      
exec 2>&1 
```

将 stdout 和 stderr 都附加到文件

```
exec >> file
exec 2>&1 
```

正如[Jonathan Leffler](https://stackoverflow.com/users/15168/jonathan-leffler) [在他的评论中提到的](https://stackoverflow.com/questions/314675/how-do-i-redirect-the-output-of-an-entire-shell-script-within-the-script-itself#comment68457734_314678)：

`exec`有两个独立的工作。第一个是用新程序替换当前正在执行的shell（脚本）。另一个是更改当前 shell 中的 I/O 重定向。这与没有参数不同`exec`。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-11-24T16:44:54.783

您可以使整个脚本成为这样的函数：

```
main_function() {
  do_things_here
} 
```

然后在脚本的末尾有这个：

```
if [ -z $TERM ]; then
  # if not run via terminal, log everything into a log file
  main_function 2>&1 >> /var/log/my_uber_script.log
else
  # run via terminal, only output to screen
  main_function
fi 
```

或者，您可以在每次运行时将所有内容记录到日志文件中，并且仍然通过简单地执行以下操作将其输出到标准输出：

```
# log everything, but also output to stdout
main_function 2>&1 | tee -a /var/log/my_uber_script.log 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-04-15T20:46:25.300

要保存原始标准输出和标准错误，您可以使用：

```
exec [fd number]<&1 
exec [fd number]<&2 
```

例如，以下代码将“walla1”和“walla2”打印到日志文件（`a.txt`），“walla3”打印到stdout，“walla4”打印到stderr。

```
#!/bin/bash

exec 5<&1
exec 6<&2

exec 1> ~/a.txt 2>&1

echo "walla1"
echo "walla2" >&2
echo "walla3" >&5
echo "walla4" >&6 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-27T12:47:37.757

```
[ -t <&0 ] || exec >> test.log 
```

# sql-server-2005 - 为什么我的 SQL Server 2005 备份没有被删除？

> ID：314679
> 
> 赞同：4
> 
> 时间：2008-11-24T16:30:27.310
> 
> 标签：sql-server-2005, backup

我有一个每周在下班时间执行的维护计划。它总是报告成功，但旧的备份不会被删除。我不希望驱动器填满。

数据库服务器信息：SQL Server 标准版 9.00.3042.00

有一个“维护清理任务”设置为

“根据扩展名搜索文件夹并删除文件”

并且“在任务运行时根据文件的年龄删除文件”被选中并设置为 4 周。

我唯一能看到的是，我的每个备份都有自己的子文件夹，而且这不是递归的。我错过了什么吗？

另外：我已经看到了 SP2 之前的问题，但我正在运行 Service Pack 2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T16:51:32.897

如果您在子文件夹中进行备份，则必须指定要删除的确切子文件夹。

例如：

您可以通过选择“为每个数据库制作一个备份文件”之类的选项来进行备份，然后选中“为每个数据库创建子文件夹”复选框。（我使用德语版的 SQL Server，所以我现在自己将所有内容都翻译成英文）

指定的文件夹是**H:\Backup**，因此备份实际上将在文件夹**H:\Backup\DatabaseName**中创建。

如果您希望维护清理任务通过“在任务运行时根据文件的年龄删除文件”删除备份，则必须指定文件夹**H:\Backup\DatabaseName**，而不是**H:\Backup** !!!

这是我在开始使用 SQL Server 2005 时犯的错误 - 我在备份和清理这两个字段中放置了相同的文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:50:38.140

我的理解是你只能包含第一级子文件夹。我假设您已经选中了该复选框。

您的备份是否比仅一层更深？

另一个想法是，您是否有一个单独的维护计划来运行以删除多个数据库的备份？我问这个的原因是因为我可以看到你必须这样做的方式是将它指向一个更高级别的文件夹，这意味着你的“包含第一级子文件夹”不够深。

我的设置方式是维护清理任务是我备份过程的一部分。因此，一旦特定数据库的备份完成，维护清理任务就会在相同的数据库备份文件上运行。这使我可以更具体地了解目录，因此我不会遇到目录结构太深的情况。因为我已经按照我想要的方式设置了标准，所以在我准备好以任何一种方式删除它们之前，项目不会被删除。

蒂姆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T17:13:22.667

确保您的维护计划没有任何相关的错误。您可以在 SQL Server Management Studio 的 SQL Server Agent 区域下查看错误日志。如果在您的维护计划中出现错误，那么它可能在开始删除过时的备份之前就退出了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T17:27:10.190

另一个问题可能是维护计划的“工作流程”。

如果您的计划包含多个任务，则必须用箭头连接任务以定义它们运行的​​顺序。

**可能的问题 #1：**

你忘了用箭头连接它们。我刚刚测试过——作业运行时没有任何错误或警告，但它只执行第一个任务。

**可能的问题 #2：**

您以永远不会运行清理任务的方式定义了工作流。如果用箭头连接两个任务，您可以右键单击箭头并指定第二个任务是始终运行还是仅在第一个任务运行/未成功运行时运行（这会更改箭头的颜色，可能是红色/绿，蓝）。也许备份工作，然后清理永远不会运行，因为它只会在备份失败时运行？

# sql - 哪些标签不在数据库中？

> ID：314682
> 
> 赞同：1
> 
> 时间：2008-11-24T16:30:50.443
> 
> 标签：sql, mysql

给定一组用户指定的标签，我如何使用 1 个 SQL 语句确定哪些标签**不在标签表中？**

假设一个表模式`tags (id, tag)`并且我正在使用 mysql，如果有我不知道的优化。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T17:24:50.770

```
 SELECT  Tag
FROM    UserSpecifiedTags
  LEFT OUTER JOIN AllTags ON UserSpecifiedTags.Tag = AllTags.Tag
WHERE   AllTags.Tag IS NULL 
```

这应该返回你想要的。根据我的经验，执行连接并查找不匹配的行比使用运算符**要**`IN`快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:33:57.677

```
select * from canonical_list_of_tags where tag not in (select tag from used_tags) 
```

至少这适用于 SQL Server 的 T-SQL ......

**编辑：**假设表格`canonical_list_of_tags`填充了“*给定用户指定标签的集合*”的结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T16:54:41.503

```
select
    utt.tagName
from
    userTypedTags utt
    left join tag t on utt.tagName = t.tag
where
    t.ID is null
    and utt.userID = <ID of the User in question> 
```

那是假设你有桌子

```
userTypedTags(userID, tagName) 
```

我添加了一个[相关问题](https://stackoverflow.com/questions/314824/sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-records)

# window - gwt-ext窗口定位

> ID：314683
> 
> 赞同：1
> 
> 时间：2008-11-24T16:30:56.170
> 
> 标签：window, gwt-ext

如何让 gwtext.client.widgets.Window 的实例出现在我的 html 的特定 DIV 中？我尝试了 window.anchorTo(DOM.getElementById("Some_Div"),"left", new int[]{0,0})，认为窗口将自己锚定到我的 html 中的 div id="Some_Div" 。它没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T13:57:57.567

我已经有几个月没有使用 gwt-ext 库了，但如果你还没有使用过，你可能想试试这个。它*应该*将小部件附加到您想要的位置。也就是说，在某些情况下，gwt-ext 小部件的反应方式对于真正了解普通 GWT 小部件的人来说并不直观。

```
RootPanel.get("Some_Div_Id").add( someWidget ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T06:55:42.720

你应该使用

```
window.alignTo(DOM.getElementById("Some_Div"),"tl-tl", new int[]{0,0}); 
```

用于将窗口的左上角定位到 Some_Div 的左上角。

这些是位置参数的有效字符串：

```
Value  Description
-----  -----------------------------
tl     The top left corner (default)
t      The center of the top edge
tr     The top right corner
l      The center of the left edge
c      In the center of the element
r      The center of the right edge
bl     The bottom left corner
b      The center of the bottom edge
br     The bottom right corner 
```

有关详细说明，请参阅 Ext 文档。

# sql - 不同环境下不同数据库名的跨数据库查询？

> ID：314684
> 
> 赞同：1
> 
> 时间：2008-11-24T16:31:08.960
> 
> 标签：sql, sql-server, database, sql-server-2005

您将如何处理不同环境中的跨数据库查询。例如，db1-development 和 db2-development、db1-production 和 db2-production。

如果我想在开发中从 db2 到 db1 进行跨数据库查询，我可以使用完全限定名称 [db1-development].[schema].[table]。但是如何维护不同环境之间的查询和存储过程呢？[db1-development].[schema].[table] 在生产环境中不起作用，因为数据库名称不同。

我可以将搜索和替换视为一种可能的解决方案，但我希望有一种更优雅的方法来解决这个问题。如果有 db 特定的解决方案，我使用的是 SQL Server 2005。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:43:59.527

为什么 dev 和 prod 的数据库名称不同？显然，如果它们相同，那将是最简单的。

如果它是共享的单个表，那么您可以在其上创建一个视图——这只需要您在移动到生产环境时更改该视图。

否则，您需要为对象[创建一个 SYNONYM](http://msdn.microsoft.com/en-us/library/ms177544(SQL.90).aspx)，并确保始终引用它。您仍然需要更改 SYNONYM 创建脚本，但我认为这可以很容易地在构建脚本中完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T16:51:15.037

因此，为开发和生产数据库使用不同的名称是不切实际的。在开发、生产和可选的验收/问答环境中使用相同的数据库名称，使您的 SQL 代码更易于维护。

但是，如果您真的需要，您可以使用视图和动态 SQL 来发挥创意。例如，您将实际的数据检索查询放在视图中，然后像这样选择：

```
declare @environment varchar(10)
set @environment = 'db-dev' -- input parameter, comes from app layer

declare @sql varchar(8000)
set @sql = 'select * from ' + @environment + '.dbo.view'
execute(@sql) 
```

但它远非漂亮...

# sms - 如何将手机号码存储在数据库中？

> ID：314686
> 
> 赞同：23
> 
> 时间：2008-11-24T16:32:10.207
> 
> 标签：sms, phone-number

随着短信和类似事物的时代，将电话号码存储在数据库中的好方法是什么？

在美国，短信是通过电话号码处理的，但在其他国家，我听说他们使用电子邮件地址，所以我想需要一种方法来区分使用手机号码作为地址的国家/地区。

加法：例如，美国人可能使用 432-342-3333 或 1-432-342-3333，而在英国他们可能使用 +44 800 400000 或者他们甚至可能忽略 44。44 和 1 使自动发送短信时的区别。但是，检查每个国家/地区的电话号码可能会很乏味。在这种情况下，您是拆分国家代码还是将其合并为一列并在那里处理？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-24T16:37:13.347

即使您出于以下原因使用数字电话号码，我也会主要使用一个文本字段或一系列文本字段。

1.  电话号码具有很大范围的值，包括可能导致数字列丢失精度的分机号码。
2.  失去电话号码的准确性是相当糟糕的。
3.  没有合乎逻辑的理由要对电话号码执行数学运算（加法/乘法）。

此外，您可能希望指定如何使用这些数据。如果您正在计划一个自动消息服务，您将需要一系列中继代理来进行广播，因此您最好添加一个与信息相关的中继相关的标识符。那么您只需要担心中继代理是否可以理解文本字段中的内容。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-24T16:36:39.853

通常作为文本，您不需要所有花哨的格式，除非您需要它来解析来自不同国家的数字，否则您无法区分。您以后可以随时添加格式。

不是数字！！！前导零可能有问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-24T16:35:04.537

我不知道您是否阅读过这两个问题，但它们可能会对您有所帮助。

*   [数据库中的电话号码列](https://stackoverflow.com/questions/290597/phone-number-columns-in-a-database)
*   [是否有在数据库中存储标准化电话号码的标准？](https://stackoverflow.com/questions/41925/is-there-a-standard-for-storing-normalized-phone-numbers-in-a-database)

存储号码类型（固定电话、手机、传真）和/或可以在其上接收的消息（语音、文本、电子邮件）也许是明智之举。请注意，在美国，也可以通过电子邮件向手机发送短信，但我相信这取决于运营商。

# asp.net-1.1 - Aspx 更改导致重新加载？

> ID：314695
> 
> 赞同：0
> 
> 时间：2008-11-24T16:34:19.923
> 
> 标签：asp.net-1.1

我们这里的设置不太理想，我们配置了我们的网络服务器，以便有一个全局应用程序，然后我们在 WEBROOT/bin 中拥有每个网络应用程序 dll（数百个）

最近我对 .NET 1.1 中的 ASPX 页面进行了更改。我们去检查了它的变化，它抱怨没有加载一个单独且完全未连接的 DLL。我不明白 ASPX 文件更改将如何导致所有 DLL 重新加载。

我删除了有问题的 DLL，问题就消失了。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-24T16:52:54.267

更改 .aspx 页面会导致重新编译同一目录中的所有 .aspx 文件，这就是重新加载 dll 的原因。如果您可以在 IIS 中将内容拆分为单独的应用程序，您的情况会好得多。如果那不可能，我不确定您如何解决这个问题...

# c# - 如何获取从 web 服务请求返回的原始 xml？

> ID：314696
> 
> 赞同：5
> 
> 时间：2008-11-24T16:34:22.527
> 
> 标签：c#, xml, web-services

有谁知道获取从查询 Web 服务返回的原始 xml 的简单方法？

我已经看到了一种通过[Web Services Enhancements](http://devlicio.us/blogs/billy_mccafferty/archive/2006/10/09/Examine-XML-of-Web-Service-Response.aspx)执行此操作的方法，但我不希望添加依赖项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T14:56:11.770

所以，这就是我最终这样做的方式。该场景是用户单击按钮并希望查看 Web 服务返回的原始 XML。这会给你。我最终使用 xslt 来删除生成的命名空间。如果不这样做，您最终会在 XML 中得到一堆烦人的名称空间属性。

```
 // Calling the webservice
        com.fake.exampleWebservice bs = new com.fake.exampleWebservice();
        string[] foo = bs.DummyMethod();

        // Serializing the returned object
        System.Xml.Serialization.XmlSerializer x = new System.Xml.Serialization.XmlSerializer(foo.GetType());
        System.IO.MemoryStream ms = new System.IO.MemoryStream();
        x.Serialize(ms, foo);
        ms.Position = 0;

        // Getting rid of the annoying namespaces - optional
        System.Xml.XPath.XPathDocument doc = new System.Xml.XPath.XPathDocument(ms);
        System.Xml.Xsl.XslCompiledTransform xct = new System.Xml.Xsl.XslCompiledTransform();
        xct.Load(Server.MapPath("RemoveNamespace.xslt"));
        ms = new System.IO.MemoryStream();
        xct.Transform(doc, null, ms);

        // Outputting to client
        byte[] byteArray = ms.ToArray();
        Response.Clear();
        Response.AddHeader("Content-Disposition", "attachment; filename=results.xml");
        Response.AddHeader("Content-Length", byteArray.Length.ToString());
        Response.ContentType = "text/xml";
        Response.BinaryWrite(byteArray);
        Response.End(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T16:48:20.267

你有两个真正的选择。您可以创建一个将插入响应流并检索原始 XML 的 SoapExtension，或者您可以更改您的代理存根以使用 XmlElement 检索原始值以便在代码中访问。

对于 SoapExtension，您想在这里查看：[http ://www.theserverside.net/tt/articles/showarticle.tss?id=SOAPExtensions](http://www.theserverside.net/tt/articles/showarticle.tss?id=SOAPExtensions)

对于 XmlElement 你想看这里：[http ://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.webservices/2006-09/msg00028.html](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.webservices/2006-09/msg00028.html)

# ntfs - 在磁盘上的大小和 NTFS 中的实际大小之间创建差异

> ID：314699
> 
> 赞同：1
> 
> 时间：2008-11-24T16:35:36.923
> 
> 标签：ntfs

我一直在寻找显示大小为 10kb 但磁盘上大小为 10gb 的文件。试图弄清楚这是如何完成的，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T16:41:03.903

您可以在 NTFS 以及任何真实文件系统上制作稀疏文件。:-)

寻找 (10 GB - 10 kB)，写入 10 kB 的数据。在那里，您有一个所谓的 10 GB 文件，实际上只有 10 kB 大。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T18:43:36.727

您可以在 NTFS 文件中创建流。它就像一个单独的文件，但具有相同的文件名。请参阅此处：[备用数据流](http://www.windowsecurity.com/articles/Alternate_Data_Streams.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T16:45:43.237

我不确定你的情况（或者你的问题可能是一个错误），但是当你创建一个 NTFS 稀疏文件时，它会为这些字段显示不同的大小。

当我创建一个 10MB 的稀疏文件并用 1MB 的数据填充它时，windows explorer 将显示：

大小：10MB
磁盘大小：1MB

但在你的情况下，情况恰恰相反。（或错误。）

# php - Flash 媒体服务器/PHP 应用程序

> ID：314700
> 
> 赞同：7
> 
> 时间：2008-11-24T16:36:04.160
> 
> 标签：php, flash, media

我需要帮助来寻找可以帮助我或至少为我指明构建 Flash 媒体服务器/PHP 应用程序的正确方向的资源。我基本上想改进我当前的应用程序，而不是使用 Flash 媒体服务器进行渐进式下载，这样视频不仅可以流式传输，而且最终用户无法下载。

当前应用程序所做的是在主页上显示一个登录表单，然后在登录后，用户可以通过从特定视频类别中选择视频或特定用户上传的视频来浏览网站。所有这些都是用 PHP 完成的。使用 PHP 传递视频 ID 后，视频页面使用渐进式下载显示视频。

我需要知道 PHP 和 flash 媒体服务器是如何协同工作的。是否有任何资源可以找到一个很好的应用程序示例（非常简单），演示如何使用 PHP 和 Flash 媒体服务器动态流式传输视频，以便 PHP 检查登录、视频 ID、视频频道和视频类别Flash 媒体服务器流式传输视频时的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-28T03:28:33.563

真的，PHP 和 FMS 根本不应该讨论。它可以在 FMS 中完成，但更简单的方法是让您的 Flash Player（无论如何您都必须拥有）与 FMS 对话。Flash 到 FMS 的通信有据可查并且非常容易。只需让 PHP 调用包含您需要的任何信息的 Flash 视频播放器。如果您真的担心安全性，让 PHP 进行身份验证并为 Flash 提供某种身份验证令牌可能会更容易。

只是让您知道，仅仅因为您的媒体正在流式传输并不意味着有人无法下载它。有几种工具可以翻录流媒体。它当然*更*安全，但它不是完全证明的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T20:32:29.190

PHP 和 Flash（媒体服务器）的最大问题是代码的不同“流”。PHP 很简单：

> *开始请求，做某事，发送响应。完毕。*

Flashmedia 仅在客户端连接时加载（编译）您的代码，然后仅触发事件。大多数操作不会返回，但需要回调。

> *加载应用程序..等待某事..事件启动：做某事，触发另一个请求以及响应处理程序对象..*等。

我已经建立了一个广泛的聊天服务，使用 FlashMedia 服务器和 PHP 作为前端*和*后端。

前端很简单：只是普通的 PHP/HTML 页面，最终将创建一个`<OBJECT>`-tag 加载一些 Flash 小程序。该 Flash 小程序应使用通过 FlashVars 选项传递给它的信息/凭据或从单独的 URL 加载（生成）的 XML 数据连接到 Flash 媒体服务器。

从那时起，Flash 小程序（客户端）就和 Flashmedia 服务器一样了。对于此示例，您要验证来自 Mediaserver 的凭据。您应该为此使用[AMFPHP](http://www.silexlabs.org/amfphp/)框架。

AMFPHP 是 Macromedia 的“Flash Remoting”系统的替代品，其中 Flash [applet/servlet] 可以通过 HTTP 进行异步通信。

对于 AMFPHP 框架，您编写一个接口类来包装您的凭证验证代码。有一个测试页面可以验证您的包装器的响应。

（AMFPHP 框架还可以生成 AS2 示例代码，以便您了解 Flashmedia 服务器应该如何发送请求和处理响应。）

*   警告：AMFPHP 使用 POST 发送和检索数据。过去，当截断超过 2k 的数据时会出现问题。我现在只将它用于相对短消息。
*   AMFPHP*非常*可靠。例如，您可以使用它来进行外部日志记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T17:11:04.433

您可能想尝试[Red5](http://osflash.org/red5)而不是 Flash Media Server。我过去使用过 Flash Media Server，照顾起来可能会很痛苦。使用 Red5，您至少拥有更大的灵活性，而且它是免费的。如果你沿着 Red5 的道路走下去，你会发现更多的人像这张[Red5 post 的一次性票](http://www.mail-archive.com/red5@osflash.org/msg06392.html)一样定制它。我相信这与您正在寻找的非常接近。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-30T06:26:57.990

我正在做类似的事情。首先，对于认证，可以使用FMS的认证插件。当然，你可以用 PHP 制作你自己的东西。我没有将 PHP 添加到 FMS 的原始 Apache 中，而是决定并行运行 XAMPP，当然使用不同的端口。

要启动和停止编码器，可以使用**FMLEcmd**命令。

我的环境：

1.  Flash 媒体开发服务器 3.5
2.  Flash 媒体实时编码器 3.1
3.  XAMPP（在端口 8080）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T20:39:25.963

> 使用 Flash 媒体服务器，这样视频不仅可以流式传输，而且最终用户无法下载

这真的行不通。它使某些人“更难”，就像不放一个大而巨大的“**在此处下载**”按钮使其“更难”一样，但内容仍在以不同的方式下载到他们的计算机上。下载的任何内容都可以保存到磁盘中。

# wix - 在 WIX 的命令行中指定 InstallPrivileges 是否受到限制或提升的最佳方法是什么？

> ID：314702
> 
> 赞同：2
> 
> 时间：2008-11-24T16:36:31.790
> 
> 标签：wix, uac, limited-user

我想在 WiX 中创建一个 MSI，以便它可以采用命令行参数来指示它是按机器安装还是按用户安装，因此是否引发 UAC 对话框。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T17:06:21.277

[这是来自MSDN](http://msdn.microsoft.com/en-us/library/aa371865(VS.85).aspx)的 per-machine/per-user 的链接。

所以要改变命令行参数的值，你需要这样的东西：

msiexec /i myinstaller.msi ALLUSERS=[1|2]

另外，请查看wix-users的此[链接](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg07066.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T17:34:33.793

UAC 对话框由 SummaryInformation 流中的位控制。不幸的是，这意味着它无法在“运行时”（安装/修复/卸载）进行控制。您必须构建不同的 MSI 文件才能真正更改 UAC 提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:52:36.460

我还不能在 Vista 中进行测试，但是对于每个用户安装的受限用户和每个机器安装的管理员用户，XP 中的工作如下：

msiexec /i myinstaller.msi ALLUSERS="" INSTALLDIR="C:\Documents and Settings[用户名]\Local Settings\Application Data\My COMpany\My Program"

INSTALLDIR 可以是受限用户可以写入的任何内容。以上是谷歌浏览器使用的目录。从以下链接中发现 ALLUSERS 属性实际上可以为空白，与 1 或 2 不同，并且正确设置了 ProgramDir 和桌面位置

[http://blogs.msdn.com/astebner/archive/2007/11/18/6385121.aspx](http://blogs.msdn.com/astebner/archive/2007/11/18/6385121.aspx)

# log4j - 跨平台登录临时目录

> ID：314713
> 
> 赞同：13
> 
> 时间：2008-11-24T16:38:31.940
> 
> 标签：log4j, temporary-files

我有一个应用程序，在 log4j.properties 文件中配置了 log4j 日志记录。目前，此应用程序在 UNIX 上运行并在 /tmp 中创建一个日志文件。此应用程序需要在 Windows 上运行，并且在该平台上我希望它选择正确的临时目录，我相信它是 C:\temp。

如何更改我的 log4j.properties 文件以实现这一点？我需要切换到使用 XML 配置文件吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-24T16:44:42.710

我认为您只会使用`${java.io.tmpdir}`硬编码路径来代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T23:51:59.047

从 Log4J v1.2.14 开始，我可以在 log4j.xml 文件和 log4j.properties 文件中使用它。网上有一些讨论说变量不会在 DOMReader 中解析，但从这个版本的 log4j 开始就可以了。

```
<appender name="rolling_file_appender_ourapp" class="org.apache.log4j.RollingFileAppender">
    <param name="File" value="${user.home}/.mycompany/OurApp.log" />
    <param name="Append" value="false" />
    <param name="MaxFileSize" value="10MB" />
    <param name="MaxBackupIndex" value="3" />
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern" value="%d | %-5p | %c | %m | %t | %x %n" />
    </layout>
</appender> 
```

或者

```
log4j.appender.rfile=org.apache.log4j.FileAppender
log4j.appender.rfile.layout=org.apache.log4j.PatternLayout
log4j.appender.rfile.Append=false
log4j.appender.rfile.layout.ConversionPattern=%d [%p] %c %m%n
log4j.appender.rfile.File=${user.home}/.mycompany/OurApp.log 
```

# automated-tests - 关于集成测试的好书或其他资源？

> ID：314722
> 
> 赞同：11
> 
> 时间：2008-11-24T16:41:10.563
> 
> 标签：automated-tests, integration-testing

关于如何进行单元测试的书籍足够多。

你知道任何关于集成测试的好书（或其他好的资源）吗？

我特别感兴趣的是

*   定义范围（单元测试 < 集成测试 < 自动化功能测试
*   什么是好的和坏的集成测试
*   数据访问
*   服务层
*   配置
*   用于集成测试的 Spring 或其他 DI 容器
*   ...

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T16:49:23.167

**持续集成**作者 Duvall、Matyas 和 Glover 这是 Addison-Wesley 出版的 Martin Fowler 的签名书它可能会给您一些不错的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-24T16:45:26.640

我喜欢“测试驱动开发：示例”（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0321146530)）。

肯特贝克是一位优秀的作家，显然知道他在说什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T15:08:16.470

实际上，还有一个很好 [的主题：敏捷方式：集成测试与功能测试还是两者兼而有之？](https://stackoverflow.com/questions/555899/the-agile-way-integration-testing-vs-functional-testing-or-both)

# c# - ASP.NET GridView 第二个标题行跨越主标题行

> ID：314736
> 
> 赞同：32
> 
> 时间：2008-11-24T16:46:10.770
> 
> 标签：c#, asp.net, gridview

我有一个 ASP.NET GridView，它的列如下所示：

```
| Foo | Bar | Total1 | Total2 | Total3 | 
```

是否可以在看起来像这样的两行上创建标题？

```
|           |  Totals   |    
| Foo | Bar | 1 | 2 | 3 | 
```

每行中的数据将保持不变，因为这只是为了美化标题并减少网格占用的水平空间。

整个 GridView 是可排序的，以防万一。我不打算让添加的“总计”跨越列具有任何排序功能。

**编辑：**

基于下面给出的一篇文章，我创建了一个继承自 GridView 并添加第二个标题行的类。

```
namespace CustomControls
{
    public class TwoHeadedGridView : GridView
    {
        protected Table InnerTable
        {
            get
            {
                if (this.HasControls())
                {
                    return (Table)this.Controls[0];
                }

                return null;
            }
        }

        protected override void OnDataBound(EventArgs e)
        {
            base.OnDataBound(e);
            this.CreateSecondHeader();
        }

        private void CreateSecondHeader()
        {
            GridViewRow row = new GridViewRow(0, -1, DataControlRowType.Header, DataControlRowState.Normal);

            TableCell left = new TableHeaderCell();
            left.ColumnSpan = 3;
            row.Cells.Add(left);

            TableCell totals = new TableHeaderCell();
            totals.ColumnSpan = this.Columns.Count - 3;
            totals.Text = "Totals";
            row.Cells.Add(totals);

            this.InnerTable.Rows.AddAt(0, row);
        }
    }
} 
```

如果您像我一样不熟悉 ASP.NET，我还应该指出您需要：

1）通过在您的网络表单中添加这样的一行来注册您的课程：

```
<%@ Register TagPrefix="foo" NameSpace="CustomControls" Assembly="__code"%> 
```

2) 将之前标记中的 asp:GridView 更改为 foo:TwoHeadedGridView。不要忘记结束标签。

**另一个编辑：**

您也可以在不创建自定义类的情况下执行此操作。

只需为网格的 DataBound 事件添加一个事件处理程序，如下所示：

```
protected void gvOrganisms_DataBound(object sender, EventArgs e)
{
    GridView grid = sender as GridView;

    if (grid != null)
    {
        GridViewRow row = new GridViewRow(0, -1,
            DataControlRowType.Header, DataControlRowState.Normal);

        TableCell left = new TableHeaderCell();
        left.ColumnSpan = 3;
        row.Cells.Add(left);

        TableCell totals = new TableHeaderCell();
        totals.ColumnSpan = grid.Columns.Count - 3;
        totals.Text = "Totals";
        row.Cells.Add(totals);

        Table t = grid.Controls[0] as Table;
        if (t != null)
        {
            t.Rows.AddAt(0, row);
        }
    }
} 
```

自定义控件的优点是您可以在 Web 表单的设计视图中看到额外的标题行。不过，事件处理程序方法要简单一些。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-11-17T16:02:28.937

我采用了接受的答案方法，但将标题添加到现有的 GridView 而不是自定义继承的 GridView。

绑定 GridView 后，我执行以下操作：

```
/*Create header row above generated header row*/

//create row    
GridViewRow row = new GridViewRow(0, -1, DataControlRowType.Header, DataControlRowState.Normal);

//spanned cell that will span the columns I don't want to give the additional header 
TableCell left = new TableHeaderCell();
left.ColumnSpan = 6;
row.Cells.Add(left);

//spanned cell that will span the columns i want to give the additional header
TableCell totals = new TableHeaderCell();
totals.ColumnSpan = myGridView.Columns.Count - 3;
totals.Text = "Additional Header";
row.Cells.Add(totals);

//Add the new row to the gridview as the master header row
//A table is the only Control (index[0]) in a GridView
((Table)myGridView.Controls[0]).Rows.AddAt(0, row);

/*fin*/ 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-24T16:49:54.103

[本文](https://web.archive.org/web/20100201202857/http://blogs.msdn.com/mattdotson/articles/541795.aspx)应该为您指明正确的方向。您可以以编程方式创建行并将其添加到位置 0 的集合中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-21T23:04:45.507

![替代文字](https://imgur.com/BNkEb.png)

对于那些选择在 VB.NET 中使用 RowDataBound 方法的人的注意事项

如果您最终弹出了太多额外的标题行，请添加一个 If 语句，该语句仅在 gridview 的标题行为空时才会继续（意味着它是当前被绑定的行）

```
 If grid.HeaderRow Is Nothing Then 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T16:50:51.730

您必须创建一个扩展 gridview 的类，然后覆盖 CreateRow 方法。

试试[这个](http://msdn.microsoft.com/en-us/magazine/cc163612.aspx)作为起点

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-26T11:48:34.567

添加`t.EnableViewState = false;`行后添加：

```
Dim t As Table = TryCast(grid.Controls(0), Table)
If t IsNot Nothing Then
    t.Rows.AddAt(0, row)
End If

t.EnableViewState = false; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-21T18:06:39.397

请参考[https://stackoverflow.com/a/9333714/1060656](https://stackoverflow.com/a/9333714/1060656)

我创建了这个解决方案示例

要在本地系统中运行，需要创建 2 个文件（一个用于控件，一个用于 aspx），您可以创建一个项目或 2 个项目。

1.  GridViewPlus ==> 控制类
2.  GridViewPlusCustomHeaderRows ==> 一个保存自定义标题类的集合
3.  CustomHeaderEventArgs ==> 创建自定义标题行时的事件参数
4.  aspx 文件 ==> 测试程序

    ```
    public class GridViewPlus : GridView
    {

        public event EventHandler<CustomHeaderEventArgs> CustomHeaderTableCellCreated;

        private GridViewPlusCustomHeaderRows _rows;

        public GridViewPlus() : base ()
        {
            _rows = new GridViewPlusCustomHeaderRows();
        }

        /// <summary>
        /// Allow Custom Headers
        /// </summary>
        public bool ShowCustomHeader { get; set; }

        [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
        [MergableProperty(false)]
        public GridViewPlusCustomHeaderRows CustomHeaderRows
        {
            get {return  _rows; }

        }

        protected virtual void OnCustomHeaderTableCellCreated(CustomHeaderEventArgs e)
        {
            EventHandler<CustomHeaderEventArgs> handler = CustomHeaderTableCellCreated;

            // Event will be null if there are no subscribers
            if (handler != null)
            {
                // Use the () operator to raise the event.
                handler(this, e);
            }

        }

        protected override void OnRowCreated(GridViewRowEventArgs e)
        {
            if (ShowCustomHeader && e.Row.RowType == DataControlRowType.Header) return;
            base.OnRowCreated(e);
        }

        protected override void PrepareControlHierarchy()
        {
            //Do not show the Gridview header if show custom header is ON
            if (ShowCustomHeader) this.ShowHeader = false;

            base.PrepareControlHierarchy();
            //Safety Check
            if (this.Controls.Count == 0)
                return;
            bool controlStyleCreated = this.ControlStyleCreated;
            Table table = (Table)this.Controls[0];

            int j = 0;
            if (CustomHeaderRows ==null )return ;

            foreach (TableRow tr in CustomHeaderRows)
            {
                OnCustomHeaderTableCellCreated(new CustomHeaderEventArgs(tr,j));
                table.Rows.AddAt(j, tr);
                tr.ApplyStyle(this.HeaderStyle);
                j++;
            }

        }
    }

    public class GridViewPlusCustomHeaderRows : System.Collections.CollectionBase
    {
        public GridViewPlusCustomHeaderRows()
        {
        }

        public void Add(TableRow aGridViewCustomRow)
        {
            List.Add(aGridViewCustomRow);
        }

        public void Remove(int index)
        {
            // Check to see if there is a widget at the supplied index.
            if (index > Count - 1 || index < 0)
            // If no widget exists, a messagebox is shown and the operation 
            // is cancelled.
            {
                throw (new Exception("Index not valid"));
            }
            else
            {
                List.RemoveAt(index);
            }
        }

        public TableRow Item(int Index)
        {
            // The appropriate item is retrieved from the List object and
            // explicitly cast to the Widget type, then returned to the 
            // caller.
            return (TableRow)List[Index];
        }

    }

    public class CustomHeaderEventArgs : EventArgs
    {
        public CustomHeaderEventArgs(TableRow tr ,int RowNumber  )
        {
            tRow = tr;
            _rownumber = RowNumber;
        }
        private TableRow tRow;
        private int _rownumber = 0;

        public int RowNumber { get { return _rownumber; } }

        public TableRow HeaderRow
        {
            get { return tRow; }
            set { tRow = value; }
        }

    }

    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Example1();
            GridViewExtension1.CustomHeaderTableCellCreated += new EventHandler<CustomHeaderEventArgs>(GridViewExtension1_CustomHeaderTableCellCreated);
        }

        void GridViewExtension1_CustomHeaderTableCellCreated(object sender, CustomHeaderEventArgs e)
        {
            TableRow tc = (TableRow)e.HeaderRow;

            tc.BackColor = System.Drawing.Color.AliceBlue;
        }

        private void Example1()
        {
            System.Data.DataTable dtSample = new DataTable();
            DataColumn dc1 = new DataColumn("Column1",typeof(string));
            DataColumn dc2 = new DataColumn("Column2",typeof(string));
            DataColumn dc3 = new DataColumn("Column3",typeof(string));
            DataColumn dc4 = new DataColumn("Column4",typeof(string));
           // DataColumn dc5 = new DataColumn("Column5",typeof(string));
            dtSample.Columns.Add(dc1);
            dtSample.Columns.Add(dc2);
            dtSample.Columns.Add(dc3);
            dtSample.Columns.Add(dc4);
           // dtSample.Columns.Add(dc5);
            dtSample.AcceptChanges();

            for (int i = 0; i < 25; i++)
            {
                DataRow dr = dtSample.NewRow();

                for (int j = 0; j < dtSample.Columns.Count; j++)
                {
                    dr[j] = j;
                }
                dtSample.Rows.Add(dr);
            }
            dtSample.AcceptChanges();
            //GridViewExtension1.ShowHeader = false;
            GridViewExtension1.ShowCustomHeader = true;

            /*
             *=======================================================================
             *  |Row 1 Cell 1   |   Row 1 Col 2 (Span=2)        | Row 1 Col 3   |
             *  |               |                               |               |
             *=======================================================================             
             *  |Row 2 Cell 1   |               |               |               |
             *  |               |   Row 2 Col 2 | Row 2 Col 3   |Row 2 Col 4    |
             *=======================================================================
             * 
             * 
             * 
             * 
             * */

            // SO we have to make 2 header row as shown above

            TableRow TR1 = new TableRow();
            TableCell tcR1C1 = new TableCell();
            tcR1C1.Text = "Row 1 Cell 1";
            tcR1C1.ColumnSpan = 1;
            TR1.Cells.Add(tcR1C1);       

            TableCell tcR1C2 = new TableCell();
            tcR1C2.Text = "Row 1 Cell 2";
            tcR1C2.ColumnSpan = 2;
            TR1.Cells.Add(tcR1C2);  

            TableCell tcR1C3 = new TableCell();
            tcR1C3.Text = "Row 1 Cell 3";
            tcR1C3.ColumnSpan = 1;
            TR1.Cells.Add(tcR1C3);

            GridViewExtension1.CustomHeaderRows.Add(TR1);

            TableRow TR2 = new TableRow();
            TableCell tcR2C1 = new TableCell();
            tcR2C1.Text = "Row 2 Cell 1";
            tcR2C1.ColumnSpan = 1;
            TR2.Cells.Add(tcR2C1);

            TableCell tcR2C2 = new TableCell();
            tcR2C2.Text = "Row 2 Cell 2";
            tcR2C2.ColumnSpan = 1;
            TR2.Cells.Add(tcR2C2);

            TableCell tcR2C3 = new TableCell();
            tcR2C3.Text = "Row 2 Cell 3";
            tcR2C3.ColumnSpan = 1;
            TR2.Cells.Add(tcR2C3);

            TableCell tcR2C4 = new TableCell();
            tcR2C4.Text = "Row 2 Cell 4";
            tcR2C4.ColumnSpan = 1;
            TR2.Cells.Add(tcR2C4);

            GridViewExtension1.CustomHeaderRows.Add(TR2);

            GridViewExtension1.DataSource = dtSample;
            GridViewExtension1.DataBind();

        }
    } 
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-12T15:04:42.467

我想做一个类似的任务，但需要标题内的可点击按钮——在这种情况下，上述方法都不起作用，因为事件处理程序没有连接（由于事件的顺序）。最后，我在网格视图的相应模板字段中使用了 headertemplate 标记。html 看起来有点臃肿，但事件保持不变，没有额外的代码。例如

```
<asp:TemplateField >
             <HeaderTemplate>
               <div>
                <div style="text-align: center;padding-bottom: 5px;">
                                                          text
                   </div>
                    <div>
                     <asp:Button ID="Button1" runat="server" Text="Apply to all" ToolTip="Apply to all - Special Bolt On" CssClass="sub_button input_btn_5" OnClick="ApplyButton1_Click" />
                   </div>
                  </div>
                  </HeaderTemplate>
                  <ItemTemplate>.... 
```

# perl - 如何在字符串而不是文件上使用 Template Toolkit？

> ID：314737
> 
> 赞同：4
> 
> 时间：2008-11-24T16:46:23.033
> 
> 标签：perl, template-toolkit

我从数据库中提取了一些字符串，我想在它们上使用 Template Toolkit，但我似乎无法弄清楚如何将字符串用作 TT 输入。有小费吗？

谢谢！

-fREW

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T17:52:30.810

该文档解释说：

> 过程（$模板，\%vars，$output，%options）
> 
> 调用 process() 方法来处理模板。第一个参数将输入模板指示为以下之一： 相对于 INCLUDE_PATH 的文件名，如果已定义；**对包含模板文本的文本字符串的引用**；...

```
 # text reference
       $tt->process(\$text)
           || die $tt->error(), "\n" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T18:03:23.097

从[文档](http://template-toolkit.org/docs/modules/Template.html#method_process)：

```
# text reference
$text = "[% INCLUDE header %]\nHello world!\n[% INCLUDE footer %]";
$tt->process(\$text)
    || die $tt->error(), "\n"; 
```

（看起来我应该在发布之前刷新页面。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T19:50:35.127

您可能会发现[String::TT](http://search.cpan.org/dist/String-TT/lib/String/TT.pm)是一种更好的替代方法。豆荚里的一些预告片......

```
use String::TT qw/tt strip/;

sub foo {
   my $self = shift;
   return tt 'my name is [% self.name %]!';
}

sub bar {
   my @args = @_;
   return strip tt q{
      Args: [% args_a.join(",") %]
   }
} 
```

和...

```
my $scalar = 'scalar';
my @array  = qw/array goes here/;
my %hash   = ( hashes => 'are fun' );

tt '[% scalar %] [% scalar_s %] [% array_a %] [% hash_h %]'; 
```

# linux - 重新附加丢失进程的 X 服务器视图

> ID：314739
> 
> 赞同：4
> 
> 时间：2008-11-24T16:47:16.837
> 
> 标签：linux, qt, session, daemon

我正在运行 Xorg 并且我的 (Qt) 程序会自行守护进程。现在我注销并重新启动 X 服务器。当我再次登录时，我的进程仍然运行良好，但我看不到它。

有没有办法将 X 服务器的新化身附加到旧进程？如果我不重新启动整个服务器，而是注销并再次登录，有没有办法查看旧进程？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-17T15:45:44.243

xpra 应该可以满足您的要求。它还可以启动 tcp 连接（不需要 ssh）。在您的服务器上启动它：

```
xpra start :100 --start-child=xterm --bind-tcp=0.0.0.0:10000 
```

将其连接到您的客户端：

```
xpra attach tcp:SERVERHOST:10000 
```

您也可以使用 mac 或 windows xpra 应用程序来连接它。我在win7和osx10.10.2上试过。下载链接：

windows：[https](https://www.xpra.org/dists/windows/Xpra_Setup.exe) ://www.xpra.org/dists/windows/Xpra_Setup.exe mac：[https ://www.xpra.org/dists/osx/x86/Xpra.dmg](https://www.xpra.org/dists/osx/x86/Xpra.dmg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-26T10:41:46.220

使用[Xpra](http://xpra.org/)之类的东西：它允许您在屏幕外 X11 服务器上运行应用程序，您可以在需要时重新连接到该服务器，也可以从远程机器上运行应用程序。它也支持“无缝”会话，因此窗口看起来就像本地窗口一样。

实际例子：

`xpra start :10 --start-child=/bin/YOURAPP`

然后每当您想重新连接时（比如在 X11 服务器重新启动后）：

`xpra attach :10`

或者从远程机器：

`xpra attach ssh://THESERVERHOSTNAMEORIP/10`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T17:45:52.150

与 X 服务器的连接丢失后，将无法重新连接。

有一个名为 xmove 的 xserver 代理，但它已被弃用，并且不能与现代工具包可能使用的几个较新的 X 扩展一起使用。

您可以尝试在另一个虚拟 X 服务器中运行您的进程，例如 xvnc 或（更好的）NX。NX 是 NoMachine 开发的 X 代理技术。NX 服务器也有免费的实现。如果您在这样的服务器中运行程序，则可以从任意图形环境附加和分离它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T18:03:30.787

这些家伙说这是可能的，我还没有测试过那个功能......

[一探究竟 ！](http://www.starnet.com/)

# visual-studio-2008 - 有没有办法将 VS.NET 中的代码窗口扩展到最大尺寸？

> ID：314740
> 
> 赞同：1
> 
> 时间：2008-11-24T16:48:15.680
> 
> 标签：visual-studio-2008

在 Eclipse 中，您可以双击代码窗口的选项卡并将其展开为全尺寸，例如，如果您将只处理代码一段时间并希望在较小的显示器上获得最大尺寸等。

有没有办法一键展开Visual Studio.NET中的代码窗口（否则我得折叠工具箱、解决方案资源管理器、属性等）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T16:50:06.317

Shift+Alt+Enter 带您进入全屏模式，该模式隐藏了大多数窗格。我仅有的两个是关闭窗口历史记录和我待处理的签到，但在大多数情况下，这运作良好。

# python - Python 2.5.2 和 Solaris 8 (gcc 3.4.2) 构建问题

> ID：314749
> 
> 赞同：3
> 
> 时间：2008-11-24T16:49:58.893
> 
> 标签：python, gcc, build-process, solaris, environment-variables

我正在尝试使用 gcc 3.4.2 在 Solaris 8 上构建 python 2.5.2。我在 ./configure 步骤中看不到任何即时错误，但是，一旦构建，我进入 python shell 执行导入时间错误：

```
Python 2.5.2 (r252:60911, Nov 21 2008, 18:45:42)
[GCC 3.4.2] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
>>> import time
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named time 
```

我究竟做错了什么？从我粗略的谷歌上可以看出，libstdc++.so 可能存在错误，但我找不到任何确切的细节。

任何建议都将受到欢迎。

非常感谢，

铝。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T15:22:16.073

默认情况下 Python 中不构建时间模块，如果您从源代码分发版构建，则需要显式启用所有要编译的模块。

在 python 源代码树中打开 Modules/Setup.dist 并注释掉下面的行：

```
#time 时间模块.c

```

启用时间模块的构建。另请记住，您需要重新编译 Python 才能使其生效。

# eclipse - 是否有用于在 m4 中开发的 eclipse 插件？

> ID：314752
> 
> 赞同：4
> 
> 时间：2008-11-24T16:50:25.053
> 
> 标签：eclipse, eclipse-plugin, macros, m4

谷歌搜索几乎没有出现。

我需要在 m4 中开发一些繁重的东西，我很想在我最喜欢的环境中完成它，其中包含所有的花里胡哨。

几乎每个平台都有用于运行 m4 的软件包，例如[windows](http://gnuwin32.sourceforge.net/packages/m4.htm)。所以我知道至少我可以创建一个默认项目并从 CLI 进行测试。但我宁愿不:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-03T17:08:43.627

I'm not aware of any specific editing support for m4\. However, if you have some time to spare (!) and the BNF for m4, then you could use Xtext ([http://wiki.eclipse.org/Xtext](http://wiki.eclipse.org/Xtext)) to create a syntax-coloring and -completing editor, with an outline view.

**Updated** an answer below suggests that m4 doesn't have a BNF, or is not BNeFfable, and certainly a short search of the literature shows no claims that an m4 BNF is available - and it appears, though not explicitly stated, that the m4 language is inexpressible in this way.

Obviously this negates my suggestion, so I must retract it, unless of course Xtext has been extended to deal with such languages. Consult the Xtext website linked above for FAQs and mailing list links.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T04:53:32.173

你也可以试试 Eclipse 的 colorer（[http://colorer.sourceforge.net/eclipsecolorer/](http://colorer.sourceforge.net/eclipsecolorer/)）——它几乎肯定支持 m4 语法（虽然我没有检查）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-24T03:48:08.657

不幸的是，只是语法着色没有什么帮助——你需要能够解释 m4 的东西，因为除非定义被处理，否则你无法判断它是一个单词还是一个预定义的宏。mc (Midnight Commander) 对 m4 有一些*基本的*突出显示，你可以看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-03T09:16:27.030

如果你熟悉（并且喜欢）vim，你可以试试[Eclim](http://eclim.org/)，然后为 m4 设置语法高亮。

# sql-server - DTS- 调试技巧

> ID：314758
> 
> 赞同：4
> 
> 时间：2008-11-24T16:51:15.830
> 
> 标签：sql-server, debugging, dts

在我正在进行的一个遗留项目中，我们有几个通过 DTS 执行的处理。DTS 并不是我在鼎盛时期经常使用的东西……我在上大学。

更具体地说，这些过程在 ActiveX 代码块中——基本上是用于数据库的 VBScript。真的很难调试。

无论如何，我想知道是否有任何过去或现在有经验的 DTS 专业人员可以提供有关如何处理**调试**、**故障排除**或以其他方式处理**DTS 包开发**的提示。

这个问题被标记为社区 wiki，我希望对所有类型的 DTS 包实现有通用和有针对性的想法和方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T17:52:53.977

我有一个复杂的 DTS 包，它导入了一些数据、运行了一些批处理脚本、制作了一个 CSV 文件并通过 FTP 上传了结果输出。有时 FTP 进程会失败。

我创建了一个“DTS LOG”表，在每一步之后我只是添加了一个 SQL 插入任务并将时间戳和函数名称写入表中。我试图向我展示任何未完成的过程。

虽然这可能不像您需要的那样精细，但至少您会知道执行过程中的问题所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T17:28:29.970

在脚本部分，我使用了 MsgBox 来显示“我到了这里”或“xfer 工作”或任何你想表明发生的事情，但在运行时并不那么明显。

如果您正在测试流程的特定部分，您还可以使用条件语句分支到“结束”。

如果您在使用 DTS 时遇到困难，但同时也在运行 SQL Server 2005 实例，您可能会看到是否无法将 DTS 包升级到 DTSX（SQL Server 集成服务）并在那里重新执行。我知道这不是一个“技巧”，但您在 VS2005 IDE 中工作，可以用 .NET 编写代码，还可以设置断点，这将使“DTS”世界的生活变得更加轻松。

这里也有一些文章：

[http://www.databasejournal.com/article.php/1503191](http://www.databasejournal.com/article.php/1503191)

向下滚动，您将看到“SQL Server 2000 DTS”文章。

# javascript - 如何在 Internet Explorer 7 中禁用 cookie？

> ID：314763
> 
> 赞同：1
> 
> 时间：2008-11-24T16:52:02.163
> 
> 标签：javascript, internet-explorer, cookies

我尝试在 Internet Explorer 7 中禁用 cookie，我更改了 Internet 选项 -> 隐私下的设置，但当我重新加载页面时，这没有任何作用。

我在某处读到您需要重新启动 IE7，而不是先物理删除 Internet 缓存和 cookie 文件，最后重新加载您的页面以禁用 cookie。（我也没有运气，cookie 仍然存在，正如我的脚本仍然反应好像 cookie 已加载所证明的那样。）

嗯，我想我还应该注意，当我访问我创建的页面时，IE 会询问我是否希望启用 ActiveX 组件。我在页面上没有任何 ActiveX 组件，但我认为这意味着我在页面上有 Javascript。

我知道我的脚本可以正常工作，因为当我在其他浏览器（FF3 和 Safari）中禁用 cookie 时，它​​可以正常工作。

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T22:39:42.520

IE 的 cookie 设置控制面板仅适用于 Internet Zone。

要在其他区域禁用 Cookie，请使用 IE8 开发人员工具栏（按 F12）并从菜单中选择“禁用 Cookie”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:09:57.883

[这里](http://www.ardmorewhisky.com/terms/cookies.html)和[这里](http://www.mvps.org/winhelp2002/cookies.htm)的解释有帮助吗？

# java - Java ActiveMQ 客户端无法接收消息

> ID：314765
> 
> 赞同：3
> 
> 时间：2008-11-24T16:54:16.917
> 
> 标签：java, jms, activemq

我正在尝试在 ActiveMQ 上实现性能测试，因此设置了一个基本的生产者和消费者来跨队列发送和接收消息。我创建了一个没有问题的生产者，让它将特定数量的消息写入队列：

```
 for(int i = 0; i < numberOfMessages; i++){
                try{
                    String message = generateText(sizeOfMessage);
                    produceMessage(message);
                }
                catch (Exception e) {
                    logger.error("Caught exception while sending message", e);
                }
            } 
```

这继续完成，没有问题，我已经通过管理网站上的检查确认了这一点，其中有正确数量的待处理消息。

当我尝试从队列中接收消息时会出现问题。使用一个简单的消费者从队列中读取，它将从队列中读取不同数量的消息，但在尝试接收其中一条消息时会停止。我可以看到队列中仍有消息要读取，但客户端不会继续传递其中一条消息。我正在使用一种简单的方法来接收消息：

```
Message message = jmsTemplate.receive(); 
```

它适用于一些消息（大约 20-30 条），但随后就会锁定。有人建议我消息中的某些字符可能是转义字符（我使用的是不同长度的随机字符串，因为这只是一个性能测试，实际上并未发送任何内容）所以我更改了所有消息到同一个字符串，这是 char '2' 的重复，仍然没有运气。我正在使用 Spring 配置来加载访问 ActiveMQ 队列所需的所有组件，并且该队列在我的本地主机上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T17:33:19.210

对此还没有多少意见，但如果有人有同样的问题，我已经找到了解决方案，以供将来参考。activeMQ 的配置限制了发送者和接收者在减慢它们之前使用的内存量，给我的默认值是：

```
<systemUsage>
            <systemUsage>
                <memoryUsage>
                    <memoryUsage limit="20 mb"/>
                </memoryUsage>
                <storeUsage>
                    <storeUsage limit="1 gb" name="foo"/>
                </storeUsage>
                <tempUsage>
                    <tempUsage limit="100 mb"/>
                </tempUsage>
            </systemUsage>
        </systemUsage> 
```

我完全删除了这个配置，现在它是一个梦想。我正在进行性能测试，所以你可能想设置自己的约束，但这绝对是我的问题的原因！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-26T09:47:12.223

这是消息传递的经典问题；如何处理缓慢的消费者。FWIW 更新的 ActiveMQ 版本（例如 5.2）允许您在内存不足时假脱机到磁盘而不是阻塞生产者

# c# - 基于值的休眠类实现

> ID：314769
> 
> 赞同：1
> 
> 时间：2008-11-24T16:54:52.813
> 
> 标签：c#, .net, nhibernate

我正在使用 nHibernate 创建一个博客库，并且我有一个**BlogEntry类，该类具有****User**类型的 CreatedBy 属性（User 是一个抽象类）。User 类的两个具体实现是**RegisteredUser**和**UnknownUser**。如果 CreatedBy 字段中的值为空，我希望 nHibernate 实例化**UnknownUser类。**如果它不为空，我希望它实例化**RegisteredUser**。

nHibernate可以做到这一点吗？如果是，我的映射文件应该是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T19:28:46.450

我真的想通了。[我在这里](http://www.summerofnhibernate.com/screencasts/Summer%20of%20Nhibernate%20Session%2011.wmv)观看了有关在 nHibernate 中建模继承的视频。我需要在我的用户映射文件中创建子类节点并在表中创建一个鉴别器列。

# mysql - 设置 innodb_log_file_size 会使 MySQL 崩溃

> ID：314774
> 
> 赞同：3
> 
> 时间：2008-11-24T16:58:33.133
> 
> 标签：mysql, database, innodb, logfile

所以，我希望能够将最大日志文件大小设置为 64M，但是在`innodb_log_file_size=64M`MySQL 启动后这样做可以正常工作，但似乎没有任何工作正常。

**编辑：**我的意思是完全没有。设置其他 InnoDB 变量不会导致任何问题。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T20:30:57.697

确保 MySQL 完全关闭，并`ib_logfile*`从 MySQL 数据目录中删除（或移动到其他位置）所有文件（`/var/lib/mysql/`通常）。

我已经对其进行了测试并为我工作。这[是此提示的来源](http://mysqldatabaseadministration.blogspot.com/2007/04/innodb-performance-optimization.html)。

InnoDB 在`show table status`评论字段中报告了一些错误。您会在 MySQL 错误日志中发现其他问题（`hostname.err`在 MySQL 数据目录中）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-05T20:51:35.837

我也遇到了这个问题，根据@porneL 的回答，这是我纠正这个问题的具体 bash 步骤：

```
service mysql stop              # Stop MySQL
rm /var/lib/mysql/ib_logfile0   # Delete log file 1
rm /var/lib/mysql/ib_logfile1   # Delete log file 2
vim my.conf                     # Change innodb_log_file_size = 64M
service mysql start             # Start MySQL 
```

[我在MySQL 论坛](http://forums.mysql.com/read.php?22,298678,298782#msg-298782)上找到了这些具体步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-05T21:01:00.820

在更改[**innodb_log_file_size**](http://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html#sysvar_innodb_log_file_size)之前，您必须从其中清除所有剩余的事务数据。您只需将[**innodb_fast_shutdown**](http://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html#sysvar_innodb_fast_shutdown)设置为 0 或 2。

*   innodb_fast_shutdown = 0 ：InnoDB 在关闭之前进行缓慢关闭、完全清除和插入缓冲区合并
*   innodb_fast_shutdown = 2 ：InnoDB 刷新其日志并冷关闭，就好像 MySQL 已经崩溃一样；没有提交的事务丢失，但是崩溃恢复操作使下次启动需要更长的时间。

鉴于此，这就是你处理它的方式

```
mysql -ANe"SET GLOBAL innodb_fast_shutdown = 2"
vi /etc/my.cnf                  # Change innodb_log_file_size = 64M
service mysql stop              # Stop MySQL
rm /var/lib/mysql/ib_logfile0   # Delete log file 1
rm /var/lib/mysql/ib_logfile1   # Delete log file 2
service mysql start             # Start MySQL 
```

# c# - 如何在 C# 中打印出 HttpWebRequest？

> ID：314776
> 
> 赞同：2
> 
> 时间：2008-11-24T16:59:17.470
> 
> 标签：c#, http, https, httpwebrequest, sniffing

我在使用 C# 中的 HttpWebRequest 对象执行 POST 时遇到问题。为了分析问题，我想确切地知道通过网络发送的内容。问题是我也在使用 HTTPS，所以我无法嗅探电线。我需要某种方式将 HttpWebRequest 对象的所有相关信息或类似的东西打印到控制台。感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-24T17:05:22.947

您可以使用[Fiddler](http://www.fiddler2.com/fiddler2/)调试 HTTPS 流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:09:37.900

您能否在代码中设置断点并查看调试器中的 Request 对象并查看 ServerVariables 集合以查看它有什么？或者，您可以对 Request.ServerVariables 中的每个元素执行 Response.Write 循环，并查看存储在网页中的名称/值对（如果需要）。

# ruby-on-rails - 在 Rails 中测试防止伪造的控制器方法

> ID：314777
> 
> 赞同：3
> 
> 时间：2008-11-24T16:59:58.513
> 
> 标签：ruby-on-rails, unit-testing, authenticity-token

我正在尝试测试我的应用程序中的一个方法，但我不知道如何对一个受伪造保护的方法进行单元测试，看看这个：

```
 def index
    @alumnos = Alumno.paginate :per_page => 20, 
      :page => params[:page], :order => :nombre

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @alumnos }
    end
  end 
```

在 index.html.erb 我有这一行：

```
<%= javascript_tag "window._token = '#{form_authenticity_token}'" %> 
```

所以，当我尝试用功能测试对其进行测试时，似乎会话没有导致测试失败的秘密工作，有没有人有测试这种方法的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-01T10:28:25.930

这是一种解决方案（或解决方法）：在您的 controllers/application.rb

```
 if RAILS_ENV =='test'
    protect_from_forgery  :secret => 'write ur secret in config/environment.rb'

  else

protect\_from_forgery

  end 
```

# c# - .net 中的自定义属性和异常

> ID：314779
> 
> 赞同：10
> 
> 时间：2008-11-24T17:00:49.337
> 
> 标签：c#, .net, exception, attributes

在用 C# 编写自定义属性时，我想知道是否有关于属性异常的任何准则或最佳实践。属性是否应该检查给定参数的有效性？或者这是物业用户的任务？

在一个简单的测试中，我没有抛出异常，直到我在具有异常抛出属性的类型上使用 GetCustomAttributes。我只是认为仅在明确要求它们时才从属性中获取异常有点尴尬。

* * *

带有异常的示例属性：

```
[AttributeUsage(AttributeTargets.Interface, AllowMultiple = false, Inherited = false)]
sealed public class MyAttribute : Attribute
{
    public string SomeValue { get; private set; }

    public MyAttribute(string someValue)
    {
        if(string.IsNullOrEmpty(someValue))
        {
            throw new ArgumentNullException("path");
        }

        if(!someOtherCheck(someValue))
        {
            throw MyAttributeException("An other error occured");
        }

        SomeValue = someValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T17:19:31.327

只有在使用反射时才会实际构造属性，所以这是唯一一次*可以*抛出异常。我不记得*曾经*使用过属性并让它抛出异常。属性通常提供数据而不是实际行为 - 我希望*使用*该属性的代码提供任何验证。我知道这不像普通的封装，但在我的经验中它往往是这样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T20:05:41.663

除了少数具有编译器特定含义的例外（例如`[PrincipalPermission]`等），属性不能在不被要求的情况下直接与代码交互。但是，如果您使用 AOP（面向方面​​编程）工具“ [PostSharp](http://www.postsharp.net/) ”，您的方面属性*可以*为您的类添加行为。不简单，但有时它是一个非常有用的技巧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-24T17:53:55.563

我们的项目中有一些相当复杂的属性，因此我们包括输入验证。例如，作为 I18N 和 L10N 工作的一部分，我们有执行资源查找的属性（很像框架中用于本地化设计器中属性的类别和描述字符串的属性）。这些自定义属性必须经过一些验证才能正常工作。

我们没有使用验证的简单属性，因为我们宁愿消费代码失败，指示错误的位置。

因此，总而言之，它实际上取决于属性的复杂性；如果它是用一种数据实例化但希望提供另一种数据（例如在资源查找中），它应该包含验证，否则它可能不应该包含。

# vb.net - 如何使用带有复合键的数据表的查找方法？

> ID：314781
> 
> 赞同：5
> 
> 时间：2008-11-24T17:00:57.590
> 
> 标签：vb.net, datatable

我正在开发一个 Windows 窗体应用程序。如果数据表有复合键，我如何使用数据表的查找方法来查找行？

表结构 Col A、Col B、Col C

Col A 和 Col B 组成复合键。我想找到 Col A 中的值为 6 而 Col B 中的值为 5 的行

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-24T17:12:25.803

当您“设置”数据表的主键时，参数值是一个 DataColumns 数组...

如果您的数据表在变量 dt... 中，

```
dt.PrimaryKey = new DataColumn[] {dt.Columns["ColA"], dt.Columns["ColB"]}; 
```

然后将对象值数组传递给 Find() 方法

```
object[] keyVals = new object[] {6, 5};
DataRow dr = dt.Rows.Find(keyVals); 
```

要不就

```
DataRow dr = dt.Rows.Find(new object[] {6, 5}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T17:15:24.160

有一个重载可用于将两个不同的值传递给 find 方法。 [这是 MSDN 文档](http://msdn.microsoft.com/en-us/library/f6dh4x2h(VS.80).aspx)。

所以你很可能会做类似的事情。

```
DataTable.Rows.Find(6,5) 
```

# batch-file - 使用批处理文件循环遍历 Oracle SQL 脚本

> ID：314783
> 
> 赞同：1
> 
> 时间：2008-11-24T17:02:04.890
> 
> 标签：batch-file, sqlplus, loops

我有两个 SQL 脚本，它们在接受数字参数的循环中被调用。这是我目前正在使用的：

```
for /l %%i in (1, 1, 51) do (
    sqlplus u/p@name @script.sql a%%i.html %%i
    sqlplus u/p@name @script.sql b%%i.html %%i
) 
```

一切正常，但每次通过连接两次似乎是浪费时间和资源。有没有办法我可以简单地登录到 sqlplus，运行 for 循环，然后退出？我尝试了很多替代方法，例如把

```
sqlplus u/p@name 
```

在 for 循环之前，但它会简单地挂在 SQL> 提示符处，而不执行我的两个脚本中的任何一个。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T17:13:56.817

您可以创建一个包含两个 script.sql 语句的 masterscript.sql。我唯一不确定的是它是否会传递你的变量。

MasterScript.sql 将包含：

```
@@script1.sql
@@script2.sql 
```

并且您的任何子脚本都不应该包含出口。

["@" 和 "@@" 之间的区别](http://www.orafaq.com/wiki/SQL*Plus_FAQ#What_is_the_difference_between_.40_and_.40.40.3F)：

[http://www.orafaq.com/wiki/SQL](http://www.orafaq.com/wiki/SQL) *Plus_FAQ#What_is_the_difference_between_.40_and_.40.40.3F

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T13:54:53.033

试试这个

（回声@%query% 用户）
| sqlplus 用户名/密码@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=XX.XX.XX.XX)(Port=152X))(CONNECT_DATA=(SID=ABC)))

# ruby-on-rails - 覆盖 ActiveRecord 对模型和集合的查找的最干净的方法是什么？

> ID：314786
> 
> 赞同：3
> 
> 时间：2008-11-24T17:04:28.473
> 
> 标签：ruby-on-rails, ruby, activerecord, finder

我有覆盖 Ar 的 find 方法的库代码。我还包括所有 Association 类的模块，因此 MyModel.find 和 @parent.my_models.find 都可以工作并应用正确的范围。

我基于 will_paginate 的代码：

```
a = ActiveRecord::Associations
returning([ a::AssociationCollection ]) { |classes|
  # detect http://dev.rubyonrails.org/changeset/9230
  unless a::HasManyThroughAssociation.superclass == a::HasManyAssociation
    classes << a::HasManyThroughAssociation
  end
}.each do |klass|
  klass.send :include, Finder::ClassMethods
  klass.class_eval { alias_method_chain :method_missing, :paginate }
end 
```

我的问题是，我只想覆盖某些模型的查找器。目前我需要扩展所有模型共享的所有关联集合类。我知道我可以通过传递一个模块来扩展每个模型的关联：

```
has_many :things, :extend => SomeCustomMethods 
```

但是我的库基本上是 ActiveRecord 插件，所以我想要一个适用于模型和范围集合的可插入查找器扩展的干净约定，而不影响应用程序中的所有模型。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T05:03:59.377

您想要覆盖`find_every`，这是最终将`find_by_sql`与相应查询一起运行的 AR 方法。覆盖`find`不适用于自定义查找器，而且它更脆弱。

但是要与其他插件兼容，您不能只重载此方法。取而代之的是，在做你想做的事情后给它取别名并调用原始实现：

```
module MyPlugin
  def self.included(base)
    class << base
      alias_method :find_every_without_my_plugin, :find_every
      def find_every(*args)
        # do whatever you need ...
        find_every_without_my_plugin(*args)
      end
    end
  end
end

ActiveRecord::Base.send :include, MyPlugin 
```

这将为所有类启用您的插件。您想如何控制启用哪些模型？也许是标准插件访问器？

```
class User < ActiveRecord::Base
  my_plugin
end 
```

为了支持这一点，您需要将 移动`class << base`到类方法（`base`应该是`self`）。喜欢：

```
module MyPlugin
  def self.included(base)
    class << base
      base.extend ClassMethods
    end
  end

  module ClassMethods
    def my_plugin
      class << self
        alias_method :find_every_without_my_plugin, :find_every
        # ...
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T19:05:31.473

首先，确保你对 Ruby 的[方法调用继承结构](http://mpathirage.com/ruby-method-lookupmethod-name-resolution-algorithm/)了如指掌，否则你最终可能会在黑暗中摸索。

在 ActiveRecord 类中执行此操作的最直接方法是：

```
def self.find(*args)
  super
end 
```

这也适用于关联，因为它们自己使用基础查找器。现在您只需要进行自定义。其复杂性可能相差很大，我不知道您在做什么，所以我无法提供任何建议。

同样动态地定义它本身就是一个练习，但这应该会让你指向正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-15T01:31:02.307

'佩德罗的回答是对的，但有一个小错误。

```
def self.included(base)
  class << base
    base.extend ClassMethods
  end
end 
```

应该

```
def self.included(base)
  base.extend ClassMethods
end 
```

使用 class << base ... end 具有在类方法范围内对 'base' 调用 'extend' 的效果，但 ActiveRecord::Base 中没有方法 'base'，因此会引发错误。单独使用 base.extend 将调用 ActiveRecord::Base 的 'extend' 方法。

# icalendar - 如何：将事件导出到单个 iCalendar 文件中？

> ID：314792
> 
> 赞同：1
> 
> 时间：2008-11-24T17:06:24.163
> 
> 标签：icalendar

我可以将多个日历事件导出到一个 iCalendar 文件中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T17:13:24.710

您只需制作一个包含多个 VEVENT 部分的 iCalendar 文件。例如：

```
BEGIN:VCALENDAR
BEGIN:VEVENT
DESCRIPTION:
DTEND:20071202T220000Z
DTSTAMP:20081124T220920Z
DTSTART:20071202T200000Z
LOCATION:Wherever
STATUS:CONFIRMED
SUMMARY:An event
UID:event-the-first
END:VEVENT
BEGIN:VEVENT
DESCRIPTION:Doing whatever, because for no good reason.
DTEND:20071209T210000Z
DTSTAMP:20081124T220920Z
DTSTART:20071207T190000Z
LOCATION:A specific place
STATUS:CONFIRMED
SUMMARY:Something, somewhere
UID:event-the-second
END:VEVENT
END:VCALENDAR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-03T10:10:13.640

请注意，您需要转义“，”和“;” 在弦上。strlength 也应 < 75 个字符。\r\n 后面应该跟一个空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-24T02:04:48.247

最简单的方法是在 Calendar.app 中创建一个单独的日历，née iCal。我称我为“出口”。将事件更改为该日历中，然后使用导出该日历`File > Export > Export...`。

您将拥有一个名为的文件`{calendar name}.ics`，其中包含给定日历中的所有事件，您可以将其重命名为您喜欢的任何名称。将 .ics 文件导入 iCal 将提示用户选择他们想要导入事件的日历。

导出事件后，只需将它们更改回您的正常日历即可。就个人而言，我保留了我的“导出”日历，因此我不必每次都创建它，但如果你愿意，你可以删除它。

# java - 定义真、假、未设置状态的最佳方法

> ID：314800
> 
> 赞同：27
> 
> 时间：2008-11-24T17:11:18.053
> 
> 标签：java, boolean

如果您需要知道未设置布尔值的位置（例如，如果该未设置的值应该从父值继承），那么 Java 布尔原语（以及其他语言中的等价物）显然是不够的。

实现这一目标的最佳做法是什么？定义一个能够表达所有三种状态的新简单类或使用Java Boolean 类并使用null 表示未设置状态？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-24T17:13:12.153

```
Boolean a = true;
Boolean b = false;
Boolean c = null; 
```

我会用那个。这是最直接的。

另一种方法是使用枚举。也许这样会更好更快，因为不需要拳击：

```
public enum ThreeState {
    TRUE,
    FALSE,
    TRALSE
}; 
```

第一个优点是您的类的用户不需要关心您的三态布尔值。他们仍然可以通过`true`和`false`。如果你不喜欢`null`，因为它在这里很少说明它的含义，你仍然可以`public static final Boolean tralse = null;`在你的课堂上做一个。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-12-29T09:45:53.070

在 Java 8 中，还有**Optional**选项：

```
public static final Optional<Boolean> TRI_TRUE = Optional.of(true);
public static final Optional<Boolean> TRI_FALSE = Optional.of(false);
public static final Optional<Boolean> TRI_UNKNOWN = Optional.empty(); 
```

作为奖励，您将获得所有这些*地图*和*消费*方法。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-24T17:13:21.090

虽然不是 Java 特定的，但我自己在这种情况下的偏好是定义一个 ThreeState 类或枚举并使用它——正如你提到的那样，一个 True、一个 False 和一个未定义（或默认值或未设置，作为您的域特定）术语规定）。感觉比用`null`.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-24T17:16:17.467

@Nullable`Boolean`得到我的投票。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-24T17:17:46.730

使用空值来表示某事物的状态是糟糕的设计。它难以描述且难以维护。如果没有明确设置它，我宁愿拥有一个具有默认状态的 State 对象。例如：

```
if(state == null) {
    doSomething();
} 
```

这并没有告诉我任何关于预期状态的信息。像这样的东西更清楚。

```
if(state.awaitingSet()) {
    doSomething();
} 
```

更不用说可扩展了。当你需要*第四个*状态时会发生什么？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-04T15:47:57.787

我会简单地使用值为 0,1,2 的 int（整数）并在程序中处理。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-24T17:16:45.920

这取决于。在这里你提到如果它必须从父值继承它的值，它将是未设置的。你有某种数据层次结构吗？像这样的东西：

```
Parent a { 
    boolean val = true;
    boolean val2 = false; 
}
Child b {
    boolean val = false;
    //here val2 should be unset!
} 
```

在这种情况下，如果可能的话，我会说简单地不要在 Child 中包含 val2，并且让您的查找逻辑使得如果找不到变量，它会在父母中搜索该值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-07T23:21:16.360

要添加到@voho，Optional 还可以很好地与 lambda 配合使用，从而形成一个可能更清洁的结构：

```
public class Node {
  private Node parent;
  private Optional<Boolean> something = Optional.empty();

  public boolean isSomething() {
    return something.orElseGet(() -> {
      if (parent != null)
        return parent.isSomething();
      return false;
    });
  }

  public void setSomething(boolean v) {
    this.something = Optional.of(v);
  }
} 
```

但是，它显然仍然没有比布尔值和空值检查好多少：

```
public class Node {
  private Node parent;
  private Boolean something;

  public boolean isSomething() {
    if (something != null)
      return something;
    if (parent != null)
      return parent.isSomething();
    return false;
  }

  public void setSomething(boolean v) {
    this.something = v;
  }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-24T18:29:49.797

在父类中将布尔值初始化为 null 并在子类中构建一个方法来检查布尔值是否已设置

在父类

```
private Boolean a = null;

public void setA(Boolean a) {
    this.a = a;
}

public Boolean getA() {
    return a;
} 
```

在儿童班

```
if (a == true)
{
dothis;
}
else if (a == false)
{
dothat;
}
else
{
assert false : "Boolean a has not been set";
} 
```

确保断言已打开。断言仅适用于开发周期和测试周期，不适用于运行时异常。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-11-24T17:15:13.553

java.lang.Boolean 会为您执行此操作。有静态常量 Boolean.TRUE、Boolean.False。

私人布尔 myBoolean;

应该是您所需要的。注意 Boolean.TRUE 将通过等效测试，但不同于“true”（自动装箱为 TRUE）。

# asp.net - 为什么 HttpRuntime.AppDomainAppPath 会返回大小写错误的路径？

> ID：314804
> 
> 赞同：0
> 
> 时间：2008-11-24T17:12:18.533
> 
> 标签：asp.net

我有一个应用程序，其中 HttpRuntime.AppDomainAppPath 返回带有错误大小写的正确路径。

然后我尝试在 String.Replace 中使用它，但由于大小写，它在文件名中找不到路径。

我知道我可以使用 Regex.Replace 但不希望这样做。

即使有问题的文件夹在开发中具有相同的外壳，我也仅在生产机器上遇到此问题。

我刚刚注意到 Server.MapPath 也返回了错误的大小写。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T18:19:18.227

显然，问题源于在 IIS 中使用错误的大小写指定的站点目录。仅仅更改主目录并不能解决问题，因为这些值已经在元数据库中设置，并且显然由于 Windows 不区分大小写，当您在 GUI 中修复元数据库时，它不会修复元数据库。

我最终删除了该站点并再次添加它，因为它尚未使用。我可能已经完全更改了目录名称并同样有效地更改了 GUI 中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-24T17:33:37.260

一些东西：

如果您不关心大小写，请使用 .ToUpper 或 .ToLower，然后替换它。

```
Dim path As String = HttpRuntime.AppDomainAppPath.ToUpper
Dim newpath As String = Replace(path, "fnd", "rplc") 
```

如果这不是一个选项，请尝试更改替换函数中的比较方法。

你没有指定语言，所以我不能举一个具体的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T17:35:24.917

为什么不将两个字符串都标准化为小写 -

```
string newpath = somepath.Replace(s1.ToLower(), s2.ToLower()); 
```

# sql-server - T-SQL：与字符串连接相反 - 如何将字符串拆分为多条记录

> ID：314824
> 
> 赞同：138
> 
> 时间：2008-11-24T17:17:56.463
> 
> 标签：sql-server, sql-server-2005, tsql

> **可能重复：**
> [SQL 中的拆分字符串](https://stackoverflow.com/questions/2647/split-string-in-sql)

我已经看到了一些与SQL[中的字符串连接相关的问题。](https://stackoverflow.com/questions/tagged/concatenation+sql)我想知道您将如何处理相反的问题：将逗号分隔的字符串拆分为数据行：

假设我有桌子：

```
userTypedTags(userID,commaSeparatedTags) 'one entry per user
tags(tagID,name) 
```

并想将数据插入表中

```
userTag(userID,tagID) 'multiple entries per user 
```

灵感来自[哪些标签不在数据库中？](https://stackoverflow.com/questions/314682/which-tags-are-not-in-the-database)问题

**编辑**

感谢您的回答，实际上不止一个应该被接受，但我只能选择一个，[Cade Roux 提出的](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-records#314917)递归解决方案对我来说似乎很干净。它适用于 SQL Server 2005 及更高版本。

对于 SQL Server 的早期版本，可以使用[miies 提供的解决方案。](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-records#314833)对于使用文本数据类型[wcm 答案](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-records#314866)将很有帮助。再次感谢。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-11-24T18:01:53.333

[这里记录](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=50648)了这个问题的多种解决方案，包括这个小宝石：

```
CREATE FUNCTION dbo.Split (@sep char(1), @s varchar(512))
RETURNS table
AS
RETURN (
    WITH Pieces(pn, start, stop) AS (
      SELECT 1, 1, CHARINDEX(@sep, @s)
      UNION ALL
      SELECT pn + 1, stop + 1, CHARINDEX(@sep, @s, stop + 1)
      FROM Pieces
      WHERE stop > 0
    )
    SELECT pn,
      SUBSTRING(@s, start, CASE WHEN stop > 0 THEN stop-start ELSE 512 END) AS s
    FROM Pieces
  ) 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2010-05-14T21:10:33.720

您还可以使用 XML 来实现此效果，[如此处所示](http://www.kodyaz.com/articles/t-sql-convert-split-delimeted-string-as-rows-using-xml.aspx)，这消除了所提供答案的限制，这些答案似乎都以某种方式包含递归。我在这里所做的特殊用途允许最多 32 个字符的分隔符，但可以增加它需要的大小。

```
create FUNCTION [dbo].[Split] (@sep VARCHAR(32), @s VARCHAR(MAX))
RETURNS TABLE
AS
    RETURN
    (
        SELECT r.value('.','VARCHAR(MAX)') as Item
        FROM (SELECT CONVERT(XML, N'<root><r>' + REPLACE(REPLACE(REPLACE(@s,'& ','&amp; '),'<','&lt;'), @sep, '</r><r>') + '</r></root>') as valxml) x
        CROSS APPLY x.valxml.nodes('//root/r') AS RECORDS(r)
    ) 
```

然后您可以使用以下方法调用它：

```
SELECT * FROM dbo.Split(' ', 'I hate bunnies') 
```

返回：

```
-----------
|I        |
|---------|
|hate     |
|---------|
|bunnies  |
----------- 
```

* * *

我应该注意，我实际上并不讨厌兔子……它只是出于某种原因突然出现在我的脑海中。

* * *

以下是我在内联表值函数中使用相同方法所能想到的最接近的东西。不要使用它，它非常低效！在这里仅供参考。

```
CREATE FUNCTION [dbo].[Split] (@sep VARCHAR(32), @s VARCHAR(MAX))
RETURNS TABLE
AS
    RETURN
    (
        SELECT r.value('.','VARCHAR(MAX)') as Item
        FROM (SELECT CONVERT(XML, N'<root><r>' + REPLACE(@s, @sep, '</r><r>') + '</r></root>') as valxml) x
        CROSS APPLY x.valxml.nodes('//root/r') AS RECORDS(r)
    ) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-24T17:22:49.370

我使用此功能（SQL Server 2005 及更高版本）。

```
create function [dbo].[Split]
(
    @string nvarchar(4000),
    @delimiter nvarchar(10)
)
returns @table table
(
    [Value] nvarchar(4000)
)
begin
    declare @nextString nvarchar(4000)
    declare @pos int, @nextPos int

    set @nextString = ''
    set @string = @string + @delimiter

    set @pos = charindex(@delimiter, @string)
    set @nextPos = 1
    while (@pos <> 0)
    begin
        set @nextString = substring(@string, 1, @pos - 1)

        insert into @table
        (
            [Value]
        )
        values
        (
            @nextString
        )

        set @string = substring(@string, @pos + len(@delimiter), len(@string))
        set @nextPos = @pos
        set @pos = charindex(@delimiter, @string)
    end
    return
end 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-07-31T12:18:37.930

对于将字符串拆分为单词的特殊情况，我遇到了 SQL Server 2008 的另一种解决方案。

```
with testTable AS
(
SELECT 1 AS Id, N'how now brown cow' AS txt UNION ALL
SELECT 2, N'she sells sea shells upon the sea shore' UNION ALL
SELECT 3, N'red lorry yellow lorry' UNION ALL
SELECT 4, N'the quick brown fox jumped over the lazy dog'
)

SELECT display_term, COUNT(*) As Cnt
 FROM testTable
CROSS APPLY sys.dm_fts_parser('"' + txt + '"', 1033, 0,0)
GROUP BY display_term
HAVING COUNT(*) > 1
ORDER BY Cnt DESC 
```

退货

```
display_term                   Cnt
------------------------------ -----------
the                            3
brown                          2
lorry                          2
sea                            2 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-10-17T16:49:36.480

[对上述解决方案](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-recor/314917#314917)稍作修改，使其适用于可变长度分隔符。

```
create FUNCTION dbo.fn_Split2 (@sep nvarchar(10), @s nvarchar(4000))
RETURNS table
AS
RETURN (
    WITH Pieces(pn, start, stop) AS (
      SELECT 1, 1, CHARINDEX(@sep, @s)
      UNION ALL
      SELECT pn + 1, stop + (datalength(@sep)/2), CHARINDEX(@sep, @s, stop + (datalength(@sep)/2))
      FROM Pieces
      WHERE stop > 0
    )
    SELECT pn,
      SUBSTRING(@s, start, CASE WHEN stop > 0 THEN stop-start ELSE 4000 END) AS s
    FROM Pieces
  ) 
```

注意：我使用了 datalength()，因为如果有尾随空格，len() 会错误地报告。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-03-24T17:38:29.617

这`Split`是与 2005 年之前的 SQL Server 版本兼容的函数。

```
CREATE FUNCTION dbo.Split(@data nvarchar(4000), @delimiter nvarchar(100))  
RETURNS @result table (Id int identity(1,1), Data nvarchar(4000)) 
AS  
BEGIN 
    DECLARE @pos   INT
    DECLARE @start INT
    DECLARE @len   INT
    DECLARE @end   INT

    SET @len   = LEN('.' + @delimiter + '.') - 2
    SET @end   = LEN(@data) + 1
    SET @start = 1
    SET @pos   = 0

    WHILE (@pos < @end)
    BEGIN
        SET @pos = CHARINDEX(@delimiter, @data, @start)
        IF (@pos = 0) SET @pos = @end

        INSERT @result (data) SELECT SUBSTRING(@data, @start, @pos - @start)
        SET @start = @pos + @len
    END

    RETURN
END 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-07-22T10:37:37.743

使用 CLR，这是一个更简单的替代方案，适用于所有情况，但比公认的答案快 40%：

```
using System;
using System.Collections;
using System.Data.SqlTypes;
using System.Text.RegularExpressions;
using Microsoft.SqlServer.Server;

public class UDF
{
    [SqlFunction(FillRowMethodName="FillRow")]
    public static IEnumerable RegexSplit(SqlString s, SqlString delimiter)
    {
        return Regex.Split(s.Value, delimiter.Value);
    }

    public static void FillRow(object row, out SqlString str)
    {
        str = new SqlString((string) row);
    }
} 
```

当然，它仍然比 PostgreSQL 慢 8 倍`regexp_split_to_table`。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-24T17:53:15.613

```
SELECT substring(commaSeparatedTags,0,charindex(',',commaSeparatedTags)) 
```

会给你第一个标签。您可以通过每次将 substring 和 charindex 组合更深一层来进行类似的操作以获取第二个，依此类推。这是一个立竿见影的解决方案，但它只适用于很少的标签，因为查询的大小增长得非常快并且变得不可读。然后继续讨论函数，如本文其他更复杂的答案所述。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-24T17:35:20.157

这是我前一阵子写的。它假定分隔符是逗号，并且各个值不大于 127 个字符。它可以很容易地修改。

它的好处是不限于 4,000 个字符。

祝你好运！

```
ALTER Function [dbo].[SplitStr] ( 
        @txt text 
) 
Returns @tmp Table 
        ( 
                value varchar(127)
        ) 
as 
BEGIN 
        declare @str varchar(8000) 
                , @Beg int 
                , @last int 
                , @size int 

        set @size=datalength(@txt) 
        set @Beg=1 

        set @str=substring(@txt,@Beg,8000) 
        IF len(@str)<8000 set @Beg=@size 
        ELSE BEGIN 
                set @last=charindex(',', reverse(@str)) 
                set @str=substring(@txt,@Beg,8000-@last) 
                set @Beg=@Beg+8000-@last+1 
        END 

        declare @workingString varchar(25) 
                , @stringindex int 

        while @Beg<=@size Begin 
                WHILE LEN(@str) > 0 BEGIN 
                        SELECT @StringIndex = CHARINDEX(',', @str) 

                        SELECT 
                                @workingString = CASE 
                                        WHEN @StringIndex > 0 THEN SUBSTRING(@str, 1, @StringIndex-1) 
                                        ELSE @str 
                                END 

                        INSERT INTO 
                                @tmp(value)
                        VALUES 
                                (cast(rtrim(ltrim(@workingString)) as varchar(127)))
                        SELECT @str = CASE 
                                WHEN CHARINDEX(',', @str) > 0 THEN SUBSTRING(@str, @StringIndex+1, LEN(@str)) 
                                ELSE '' 
                        END 
                END 
                set @str=substring(@txt,@Beg,8000) 

                if @Beg=@size set @Beg=@Beg+1 
                else IF len(@str)<8000 set @Beg=@size 
                ELSE BEGIN 
                        set @last=charindex(',', reverse(@str)) 
                        set @str=substring(@txt,@Beg,8000-@last) 
                        set @Beg=@Beg+8000-@last+1 

                END 
        END     

        return
END 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-03-15T05:32:02.207

我对“Nathan Wheeler”的答案投了赞成票，因为我发现“Cade Roux”的答案在一定的字符串大小之上不起作用。

几点

-我发现添加 DISTINCT 关键字提高了我的性能。

-Nathan 的答案仅在您的标识符为 5 个字符或更少时才有效，当然您可以调整它...如果您要拆分的项目是**INT**标识符，您可以和我一样在下面：

```
CREATE FUNCTION [dbo].Split
(
    @sep VARCHAR(32), 
    @s VARCHAR(MAX)
)
RETURNS 
    @result TABLE (
        Id INT NULL
    )   
AS
BEGIN
    DECLARE @xml XML
    SET @XML = N'<root><r>' + REPLACE(@s, @sep, '</r><r>') + '</r></root>'

    INSERT INTO @result(Id)
    SELECT DISTINCT r.value('.','int') as Item
    FROM @xml.nodes('//root//r') AS RECORDS(r)

    RETURN
END 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-24T12:43:14.117

我通常使用以下代码执行此操作：

```
create function [dbo].[Split](@string varchar(max), @separator varchar(10))
returns @splited table ( stringPart varchar(max) )
with execute as caller
as
begin
    declare @stringPart varchar(max);
    set @stringPart = '';

    while charindex(@separator, @string) > 0
    begin
        set @stringPart = substring(@string, 0, charindex(@separator, @string));
        insert into @splited (stringPart) values (@stringPart);
        set @string = substring(@string, charindex(@separator, @string) + len(@separator), len(@string) + 1);
    end

    return;
end
go 
```

您可以使用以下查询对其进行测试：

```
declare @example varchar(max);
set @example = 'one;string;to;rule;them;all;;';

select * from [dbo].[Split](@example, ';'); 
```

# date - Crystal Reports 组名错误

> ID：314839
> 
> 赞同：5
> 
> 时间：2008-11-24T17:24:35.657
> 
> 标签：date, crystal-reports

我正在对日期字段进行分组。显示数据时报告的树浏览器将日期显示为记录中日期的前 3 天。报告中的详细信息列出了正确的日期。我已经验证了报告中显示的字段，并且 Group 字段指向同一个数据库表字段。我还设置了格式，以便只使用实际的日期信息，即没有时间信息。组字段名称中显示的日期甚至不存在于表中 - 正在检查的字段或数据库中的任何其他位置 (ORACLE 10)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T04:52:02.353

我面前没有 CR，但是导致这种情况的组有格式。像按周而不是实际日期显示的东西。我被这个咬过无数次了。明天上班的时候我可以说得更具体一些。

**编辑添加**：在插入组对话框中，您需要更改：

“*将打印该部分：每周*”至“*每天*”。

# java - Java 事后调试？

> ID：314843
> 
> 赞同：8
> 
> 时间：2008-11-24T17:26:43.200
> 
> 标签：java, debugging, exception

是否可以在 Java 中进行事后（或异常后）调试会话？解决方法是什么（如果还没有解决方案）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-24T17:52:01.870

您可以将调试器附加到 java 进程并在收到特定异常时设置断点。这是你需要的吗？

来自 [http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/jdb.html](http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/jdb.html)

> 当异常发生时，Java 程序堆栈的任何位置都没有 catch 语句，Java 运行时通常会转储异常跟踪并退出。但是，当在 jdb 下运行时，该异常被视为不可恢复的断点，并且 jdb 会在有问题的指令处停止。如果该类是使用 -g 选项编译的，则可以打印实例和局部变量以确定异常的原因。

可以使用任何 IDE（例如 Eclipse）设置这种类型的断点。使用 Eclipse，您还可以在特定异常类型上设置断点，即使它在正常代码中被捕获。

如果您正在运行多线程服务器之类的东西，并且为客户端提供服务的线程之一抛出未处理的异常，那么您将能够检查调试器并查看发生了什么。我认为这不是用于生产的东西，但在测试时绝对有帮助。

应用程序不必从调试器运行，但可以使用调试选项作为参数启动它：

```
-Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=XXXX 
```

应用程序正常运行，但在遇到断点时会切换到“解释”模式，至少在更现代的 JVM 版本中是这样。所以性能不受影响。

查看[HotSpot VM的全速调试部分](http://java.sun.com/products/hotspot/docs/whitepaper/Java_Hotspot_v1.4.1/Java_HSpot_WP_v1.4.1_1002_1.html)

> 全速调试
> 
> Java HotSpot VM 现在使用全速调试。在以前的 VM 版本中，启用调试时，程序仅使用解释器执行。现在，HotSpot 技术的全部性能优势可用于程序，即使是编译代码。改进的性能允许更容易地调试长时间运行的程序。它还允许测试全速进行。一旦出现异常，调试器就会启动，并且对代码源具有完全可见性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T17:58:37.413

据我所知，您必须等待 Java 7 才能获得官方 API - 请参阅[http://tech.puredanger.com/java7#jsr326](http://tech.puredanger.com/java7#jsr326)。

同时，您可以替换 Exception（替换基类、通过检测注入代码等）来保留您的数据。请注意，尽管 ClassLoader 会定期抛出和捕获 ClassNotFoundException（每个新包都已加载）。您可以通过这种方式进行大量控制，而无需修改基本代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T21:55:30.990

我是 Replay Solutions 的解决方案架构师。它们为 Java 应用程序提供了一个“时间机器”。您可以在应用程序运行时录制它（比方说，在 QA 环境中），然后在您的开发机器上重放录制文件。您不需要访问数据库、配置等。您所需要的只是他们的 ReplayDIRECTOR 解决方案，您可以在 IDE 的友好范围内调试问题。可以重放的问题范围从配置问题、数据库异常到线程问题。看一看：

[http://www.replaysolutions.com](http://www.replaysolutions.com)

# localization - 本地化：所有语言环境都将工作日放在日期之前吗？

> ID：314844
> 
> 赞同：2
> 
> 时间：2008-11-24T17:27:04.247
> 
> 标签：localization, internationalization, date

这是一个简单的（希望是）L10N 问题：

是否所有语言环境都需要这种格式：

*2008 年 11 月 23 日，星期日*

日期前的工作日，还是某些语言环境想要这样的日期之后？

*2008 年 11 月 23 日，星期日*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T17:46:34.800

不要假设。

我可以将 XP 中的设置自定义为： **T. MMMM JJJJ,TTTTT**，即： **2008 年 11 月 24 日，Montag**

是的。这不是默认设置，但我可以在我的区域设置中进行设置！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T17:39:22.397

我无法回答所有语言环境，但在法语中，我们说“dimanche 2008 年 11 月 23 日”，所以对我们来说，答案是肯定的。

现在，我不知道你的目的，但你可能不应该做出这样的猜测......

[编辑] 有趣的是，我发现了一个分析 zh_TW 语言环境如何在 Java 1.4 中设置日期/时间格式的示例。我发现这个语言环境的格式是（反编译后）：

```
"ahh'\u6642'mm'\u5206'ss'\u79D2' z", 
"ahh'\u6642'mm'\u5206'ss'\u79D2'", 
"a hh:mm:ss", 
"a h:mm", 
"yyyy'\u5E74'M'\u6708'd'\u65E5' EEEE", 
"yyyy'\u5E74'M'\u6708'd'\u65E5'", 
"yyyy/M/d", 
"yyyy/M/d", 
"{1} {0}" 
```

而默认情况下，对于美国（在网上找到），是：

```
"h:mm:ss a z", // full time pattern
"h:mm:ss a z", // long time pattern
"h:mm:ss a", // medium time pattern
"h:mm a", // short time pattern
"EEEE, MMMM d, yyyy", // full date pattern
"MMMM d, yyyy", // long date pattern
"MMM d, yyyy", // medium date pattern
"M/d/yy", // short date pattern
"{1} {0}" // date-time pattern 
```

查看完整的日期模式，EEEE（一周中的一天）在台湾的末尾...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-04T08:10:59.390

不，例如，日本人使用年-月-日-工作日的顺序。

# asp.net - 检查 ASP.NET 网站的内存使用情况

> ID：314847
> 
> 赞同：2
> 
> 时间：2008-11-24T17:28:20.563
> 
> 标签：asp.net, iis

我正在使用共享的 ASP.NET 托管，并且我没有对 Web 服务器的远程桌面访问权限。我只能将 ASP.NET 相关文件通过 FTP 传输到服务器。

在这种情况下，如何查看我的 ASP.NET 应用程序消耗了多少内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T17:32:27.683

您能否创建一个页面，列出站点受密码保护的部分中的各种性能计数器？这将是我的建议，同时确保在页面的某处列出机器名称或 IP，以便站点在各种服务器之间移动时，可以在某处注明。另一个想法是写入日志文件或发送带有各种性能计数器的电子邮件，以便您可以查看服务器运行情况的历史记录，但要小心电子邮件，这可能会变成垃圾邮件如果你做得太频繁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T00:23:35.280

Update: Maybe [Process.PeakVirtualMemorySize64](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.peakvirtualmemorysize64.aspx) is more focused on your need. Did not try it myself.

Before update: This link is about what you need.

[http://aspnet.4guysfromrolla.com/articles/041002-1.aspx](http://aspnet.4guysfromrolla.com/articles/041002-1.aspx)

# c# - 使用 System.Data.SQLite 如何使用相对路径在连接字符串中指定数据库文件

> ID：314853
> 
> 赞同：11
> 
> 时间：2008-11-24T17:31:56.280
> 
> 标签：c#, sqlite, connection-string, system.data.sqlite

想要在不同的服务器上部署我的项目，我希望能够使用相对路径指定连接字符串。我似乎无法让它发挥作用，并想知道它是否有一些技巧......？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-28T11:47:45.050

这个怎么样？

```
"Data Source=|DataDirectory|mydb.db;..." 
```

我相信`|DataDirectory|`指向您的应用程序所在的目录。我使用 NHibernate，它适用于以下内容：

```
<add key="hibernate.connection.connection_string"
       value="Data Source=|DataDirectory|mydb.db;Version=3;Compress=False;synchronous=OFF;" > 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T18:18:42.130

## 一条建议

您可以在应用程序中构建绝对路径并将其传递到连接字符串中。

因此，如果您知道数据库文件位于`database`应用程序文件夹的子文件夹中，您可以执行以下操作（C#）：

```
 string relativePath = @"database\myfile.s3db";
    string currentPath;
    string absolutePath;
    string connectionString;

    currentPath = System.Reflection.Assembly.GetExecutingAssembly().Location;
    absolutePath = System.IO.Path.Combine(currentPath,relativePath);

    connectionString = string.Format("DataSource={0}", absolutePath);

    SQLiteConnection cnn = new SQLiteConnection(connectionString); 
```

（有人可能会纠正我如何获取当前路径）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T00:23:05.603

像这样：

String currentPath = System.IO.Path.GetDirectoryName(Application.ExecutablePath);

# apache-flex - 如何在flex textarea中使文本换行

> ID：314858
> 
> 赞同：25
> 
> 时间：2008-11-24T17:33:30.503
> 
> 标签：apache-flex, actionscript-3, textarea

我有一个字符串

```
var s:String = "This is a line \n This is another line.";
this.txtHolder.text = s; //.text has \n, not a new line 
```

我想把它放到一个文本区域，但是换行符被忽略了。我如何确保文本在分配时在我想要的位置中断？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-04T04:33:47.480

在 flex 上，当编码`\n`在`mxml`或任何`xml`定义线时运行良好时，只需使用`&amp;#13;`线实体。

我是说：

```
lazy&amp;#13;fox 
```

给我们

```
lazy<br />
fox 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-05T18:50:35.450

不是 {\n} 而是 {'\n'}

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-09-24T22:56:43.017

@radekg

OP 指的是用 MXML 语法编写的文本字符串：

```
<mx:TextArea text="This is a &#13; new line" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-24T18:23:27.003

尝试

```
"This is a line {\n} This is another line." 
```

或者，使用 htmlText 属性并使用

```
"This is a line <br> This is another line." 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T00:06:25.230

如果您使用的是 htmlText ，它应该可以工作，或者至少**< br \> （“br”之前没有空格）应该可以工作。**

我使用 XML 来填充 TextArea，因为我不完全确定如何在 XML 中使用 HTML（他们提到我应该用 CDATA 标签包装它）但我只是做了一个简单的

```
txt.replace("\\n", "<br/>"); 
```

也许有更好的方法来解决它，但这很好。

编辑：我在“br”之后有一个空格

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T20:26:48.347

我刚刚测试了以下代码：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    creationComplete="onComplete();">
    <mx:Script>
        <![CDATA[
            private function onComplete():void {
                var s:String = "This is a line \n This is another line.";
                this.txtHolder.text = s;
            }
        ]]>
    </mx:Script>
    <mx:TextArea id="txtHolder" />
</mx:WindowedApplication> 
```

并使用 mx:Text

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    creationComplete="onComplete();">
    <mx:Script>
        <![CDATA[
            private function onComplete():void {
                var s:String = "This is a line \n This is another line.";
                this.txtHolder.text = s;
            }
        ]]>
    </mx:Script>
    <mx:Text id="txtHolder" />
</mx:WindowedApplication> 
```

两者都工作得很好。也许您正在使用 mx:TextInput 或 mx:Label？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-24T06:42:44.123

在 Flex 中，如果您尝试将行放在上一行旁边。然后只需将其附加到上一行。

```
var line:String="Hello";
textarea1.text += line; 
```

现在 textarea1 是您要在其中打印此字符串的 textarea 将附加到它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-10T18:05:12.510

我只是这样做如下，

```
protected function addToTextArea(array:Array):void
            {
                textArea.text = "Array Elements are:";
                for(var k:int = 0; k < array.length; k=k+1)
                 {
                    textArea.text = textArea.text +"\n"+ array[k];
                 }
            } 
```

谢谢Tolgahan ALBAYRAK

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-20T16:11:07.823

你应该做：

```
var s:String = "This is a line" + "\n" + "This is another line.";
this.txtHolder.text = s; 
```

就是这样。

# tsql - 如何使用 T-SQL 生成 Mandelbrot？

> ID：314864
> 
> 赞同：9
> 
> 时间：2008-11-24T17:35:00.813
> 
> 标签：tsql, code-golf, fractals

稍微了解一下 T-SQL，并认为一个有趣的练习是用它生成一个 Mandelbrot 集。

原来有人已经有了（最近，它出现了）。我会让其他人将其发布为答案，但我很好奇可以进行哪些优化。

或者，您将如何使代码更具可读性？

我将选择最易读（但相当紧凑）的版本作为接受的答案（太糟糕了，我们还没有代表赏金！）除非有人真的进行了很好的优化。

奖励指向那些教我一些关于 T-SQL 的答案的答案。

-亚当

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-24T17:41:02.923

来自[thedailywtf.com](http://thedailywtf.com/Articles/Stupid-Coding-Tricks-The-TSQL-Madlebrot.aspx)

```
-- AUTHOR: GRAEME JOB
-- CREATED: 12-OCT-2008
-- BECAUSE: SINGLE SQL COMMAND < 50 LINES. JUST BECAUSE.
WITH 
      XGEN(X, IX) AS (              -- X DIM GENERATOR
            SELECT CAST(-2.2 AS FLOAT) AS X, 0 AS IX UNION ALL
            SELECT CAST(X + 0.031 AS FLOAT) AS X, IX + 1 AS IX
            FROM XGEN
            WHERE IX < 100
      ),
      YGEN(Y, IY) AS (              -- Y DIM GENERATOR
            SELECT CAST(-1.5 AS FLOAT) AS Y, 0 AS IY UNION ALL
            SELECT CAST(Y + 0.031 AS FLOAT) AS Y, IY + 1 AS IY
            FROM YGEN
            WHERE IY < 100
      ),
      Z(IX, IY, CX, CY, X, Y, I) AS (           -- Z POINT ITERATOR
            SELECT IX, IY, X, Y, X, Y, 0
            FROM XGEN, YGEN   
            UNION ALL
            SELECT IX, IY, CX, CY, X * X - Y * Y + CX AS X, Y * X * 2 + CY, I + 1
            FROM Z
            WHERE X * X + Y * Y < 16
            AND I < 100
      )
SELECT REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
      REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
      REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
      (X0+X1+X2+X3+X4+X5+X6+X7+X8+X9+X10+X11+X12+X13+X14+X15+X16+X17+X18+X19+
      X20+X21+X22+X23+X24+X25+X26+X27+X28+X29+X30+X31+X32+X33+X34+X35+X36+X37+X38+X39+
      X40+X41+X42+X43+X44+X45+X46+X47+X48+X49+X50+X51+X52+X53+X54+X55+X56+X57+X58+X59+
      X60+X61+X62+X63+X64+X65+X66+X67+X68+X69+X70+X71+X72+X73+X74+X75+X76+X77+X78+X79+
      X80+X81+X82+X83+X84+X85+X86+X87+X88+X89+X90+X91+X92+X93+X94+X95+X96+X97+X98+X99),
      'A',' '),   'B','.'),   'C',','),   'D',','),   'E',','),   'F','-'),   'G','-'),
      'H','-'),   'I','-'),   'J','-'),   'K','+'),   'L','+'),   'M','+'),   'N','+'),
      'O','%'),   'P','%'),   'Q','%'),   'R','%'),   'S','@'),   'T','@'),   'U','@'),
      'V','@'),   'W','#'),   'X','#'),   'Y','#'),   'Z',' ')
FROM (
      SELECT 'X' + CAST(IX AS VARCHAR) AS IX,
      IY,   SUBSTRING('ABCDEFGHIJKLMNOPQRSTUVWXYZ', ISNULL(NULLIF(I, 0), 1), 1) AS I
      FROM Z) ZT
PIVOT (
      MAX(I) FOR IX IN (
      X0,X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14,X15,X16,X17,X18,X19,
      X20,X21,X22,X23,X24,X25,X26,X27,X28,X29,X30,X31,X32,X33,X34,X35,X36,X37,X38,X39,
      X40,X41,X42,X43,X44,X45,X46,X47,X48,X49,X50,X51,X52,X53,X54,X55,X56,X57,X58,X59,
      X60,X61,X62,X63,X64,X65,X66,X67,X68,X69,X70,X71,X72,X73,X74,X75,X76,X77,X78,X79,
      X80,X81,X82,X83,X84,X85,X86,X87,X88,X89,X90,X91,X92,X93,X94,X95,X96,X97,X98,X99)
) AS PZT 
```

[![这是结果](https://i.stack.imgur.com/HDG9g.png)](https://i.stack.imgur.com/HDG9g.png)
[（来源：[thedailywtf.com](http://img.thedailywtf.com/images/200811/madlebrot.png)）]

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-24T18:38:27.457

```
Create PROCEDURE dbo.mandlebrot
@left float,
@right float,
@Top float,
@Bottom float,
@Res float,
@MaxIterations Integer = 500
As
Set NoCount On

Declare @Grid Table (
    X float Not Null, 
    Y float Not Null,
    InSet Bit
   Primary Key (X, Y))

Declare @Xo float, @Yo float, @Abs float
Declare @PtX Float, @PtY Float
Declare @Iteration Integer Set @Iteration = 0
Select @Xo = @Left, @Yo = @Bottom

While @Yo <= @Top Begin
    While @Xo <= @Right Begin
        Select @PtX = @Xo, @PtY = @Yo
        While @Iteration < @MaxIterations 
            And (Square(@PtX) + Square(@PtY)) < 4.0 Begin
            Select @PtX = Square(@PtX) - Square(@PtY) + @Xo,
                   @PtY = 2* @PtX * @PtY + @Yo
            Select @Iteration, @PtX, @PtY
            Set @Iteration = @Iteration + 1
        End
        Insert @Grid(X, Y, InSet) 
        Values(@Xo, @Yo, Case 
            When @Iteration < @MaxIterations
                    Then 1 Else 0 End)
        Set @Xo = @Xo + @res
        Set @Iteration = 0
    End
    Select @Xo = @Left, 
           @Yo = @Yo + @Res
End

Select * From @Grid 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T21:09:51.853

希望这也能教授一些关于 T-SQL 的知识，它以基于集合的方法完成所有操作，这是 TSQL 的优势（即没有 while 循环）或变量：

```
SET NOCOUNT ON;

--populate
;WITH Numbers ([row]) AS
(
   SELECT TOP 100 CAST(ROW_NUMBER() OVER (ORDER BY NEWID()) AS FLOAT) [row]
   FROM sys.columns
)
SELECT A.row AS x, 
   B.row AS y, 
   0 AS iter, 
   A.row AS iterx, 
   B.row AS itery, 
   '.' AS symbol
INTO #GRID
FROM Numbers A, Numbers B
WHERE B.[row] <= 24
GO

-- scale
UPDATE #GRID
SET x = x * 3.0 / 100.0 - 2,
   y = y * 2.0 / 24.0 - 1,
   iterx = x * 3.0 / 100.0 - 2,
   itery = y * 2.0 / 24.0 - 1
GO

--iterate
UPDATE #GRID
SET iterx = iterx*iterx - itery*itery + x,
    itery = 2*iterx*itery + y,
    iter = iter+1
WHERE iterx*iterx+itery*itery <= 2*2
GO 257

UPDATE #GRID SET symbol = CHAR(64+(iter%26)) WHERE NOT iter = 257
GO

--print
WITH concatenated (y, c) AS 
(
   SELECT G2.y,
       (SELECT SUBSTRING(G.symbol, 1, 1) AS [data()] FROM #GRID G WHERE G.y = G2.y FOR XML PATH('')) c
   FROM (SELECT DISTINCT y FROM #GRID) AS G2
)
SELECT REPLACE(c, ' ', '') FROM concatenated ORDER BY y
GO

DROP TABLE #GRID 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-28T13:40:37.813

```
with points (x1,y1,x2,y2,depth) as
(
    select convert(float,-2.40), convert(float,-2.40), convert(float,2.40), convert(float,2.40), 8
    union all select x1,y1,(x1+x2)/2,(y1+y2)/2,depth-1 from points where depth>0
    union all select (x1+x2)/2,y1,x2,(y1+y2)/2,depth-1 from points where depth>0
    union all select x1,(y1+y2)/2,(x1+x2)/2,y2,depth-1 from points where depth>0
    union all select (x1+x2)/2,(y1+y2)/2,x2,y2,depth-1 from points where depth>0
),
mandelbrot(x1,y1,x2,y2,x,y,depth) as
(
    select x1,y1,x2,y2,convert(float,0),convert(float,0),20 from points where depth=0
    union all
    select x1,y1,x2,y2, x*x-y*y+x1, 2*x*y+y1,depth-1 from mandelbrot where depth > 0 and (x*x+y*y<4)
)
select geometry::STGeomFromText('POLYGON((' +
  convert(varchar,x1) + ' ' + convert(varchar,y1) + ',' +
  convert(varchar,x1) + ' ' + convert(varchar,y2) + ',' +
  convert(varchar,x2) + ' ' + convert(varchar,y2) + ',' +
  convert(varchar,x2) + ' ' + convert(varchar,y1) + ',' +
  convert(varchar,x1) + ' ' + convert(varchar,y1) + '))',0)
  from mandelbrot where depth = 0 
```

# mod-rewrite - Mod-rewrite 斜杠问题

> ID：314872
> 
> 赞同：5
> 
> 时间：2008-11-24T17:38:45.610
> 
> 标签：mod-rewrite

关于这个主题似乎没有太多信息，所以我将概述我的具体问题，然后也许我们可以将问题和答案塑造成更普遍的东西。

我有这个重写规则

```
RewriteEngine On
RewriteBase /bookkeepers/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/?$ index.php?franchise=$1 
```

这是更改此 URL

```
http://example.com/location/kings-lynn 
```

进这个

```
http://example.com/location/index.php?franchise=kings-lynn 
```

我遇到的问题是，如果我添加一个斜杠

```
http://example.com/location/kings-lynn/ 
```

然后查询字符串返回为

```
franchise=kings-lynn/ 
```

由于某种原因，我的 CSS 和 Javascript 文件都没有被加载。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T17:48:33.110

正如@Paul Tomblin 所说， .+ 是贪婪的；也就是说，它尽可能地匹配。

`^(.+[^/])/?$`告诉它匹配任何内容，后跟一个不是 / 的字符，然后是可选的 /。这具有不捕获尾随 / 的效果。

您的 CSS 和 Javascript 不起作用的最可能原因是您使用的是相对路径，例如 src="my.js"。当尾部有斜线时，它看起来像一个目录，因此您的浏览器将查找 /location/kings-lynn/my.js。您可以简单地通过使用文件的绝对路径（例如/location/my.js）来解决此问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-24T17:41:15.590

看起来 (.+) 正在被贪婪匹配。在这种情况下，您可以尝试

```
RewriteRule ^(.+[^/])/?$ index.php?franchise=$1 
```

这确保第一组（在括号中）不会以斜线结尾。

# msbuild - Team Build MSBuild 任务不更新主构建日志文件

> ID：314885
> 
> 赞同：2
> 
> 时间：2008-11-24T17:42:49.597
> 
> 标签：msbuild, tfsbuild

我的主 TFSBuild.proj 文件中有一个构建后事件，它使用 MSBuild 任务在成功构建后调用部署任务。它看起来像这样：

```
<ItemGroup>
    <DeploymentTargets Include="..\Sources\Build\SkunkWorks.Build.Deployment.targets">
      <Properties></Properties>
    </DeploymentTargets>
 </ItemGroup>
 <Target Name="AfterBuild">
    <Message Text="Executing Deployment"/>
    <MSBuild Projects="@(DeploymentTargets)" 
       Properties="PickUpLocation='@(DropLocation)'" 
       ContinueOnError="false"/>
 </Target> 
```

这工作正常，部署脚本被调用，正如你所期望的那样。问题是执行 MSBuild 产生的任何错误或消息都不会写入成功构建后放置在放置位置的 BuildLog.txt 或 ErrorsAndWarnings.txt 文件。

有没有一种简单的方法来捕获这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-04T23:13:33.553

您可以通过直接调用目标而不是通过 MSBuild 来解决它吗？

```
<Import Projects="..\Sources\Build\SkunkWorks.Build.Deployment.targets/>

<Target Name=""/>
  <CallTarget Targets="DeploymentTarget1"/>
</Target> 
```

或者，尝试查看构建机器上的 Microsoft.TeamFoundation.Build.targets 文件。他们在那里使用了很多 MSBuild 调用，我看到他们传入了 LogLocation 的属性。但我不知道这是全球团队建设的事情还是只是该文件的内部。

# javascript - 拦截来自网页的每个请求

> ID：314891
> 
> 赞同：5
> 
> 时间：2008-11-24T17:46:33.863
> 
> 标签：javascript

是否可以使用 javascript 拦截从页面发出的每个请求？即点击链接、加载图像、ajax 请求......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T17:52:16.147

一句话，没有。没有地方可以挂钩来获取所有请求。

话虽如此，您可以使用 javascript 在链接上放置事件处理程序，查看图像标签的 src 属性等等。没有“通用”的方法可以连接到所有 AJAX 请求 - 这取决于您使用的库。

还有其他需要考虑的事情，例如 CSS 背景图像、Flash（如果 Flash 文件发出请求怎么办？）。

如果可能的话，您应该使用浏览器本身（例如[Firebug](http://getfirebug.com/)）或代理（例如[Fiddler](http://www.fiddlertool.com/fiddler/)）或数据包嗅探器（例如 Ethereal ... 现在似乎是[WireShark](http://www.wireshark.org/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-04T11:12:57.687

Greg 是对的，没有一个地方可以让您参与所有请求。话虽如此，您重写*所有*请求的最终目标是什么？如果您需要为每个请求添加一个“参数”，然后在服务器端使用它，那么一种方法是使用主机标头。您可以在服务器端修改主机标头（即将用户从 your-site.com 重定向到 your-parameter.your-site.com），之后的所有请求都将包含 *your-parameter"。在在服务器端，您可以使用 url 重写技术将 url 修改为 your-site.com?parameter=your-parameter。

对于重定向，请使用 http 302 响应代码。需要在服务器端设置适当的 url 重写组件（mod_rewrite 用于 apache，ISAPIrewrite 用于 ASP.NET）

需要注意的几点： 1) 由于子域和域共享会话 cookie，用户不会被注销 2) 您需要在 DNS 服务器上设置通配符映射 3) 浏览器缓存不会那么有效 4 ) 您需要分析更改的 url 的“业务影响”

# c++ - 64 位土地中的堆碎片

> ID：314909
> 
> 赞同：14
> 
> 时间：2008-11-24T17:55:56.857
> 
> 标签：c++, 64-bit, heap-fragmentation

过去，当我处理长时间运行的 C++ 守护进程时，我不得不处理堆碎片问题。为了避免耗尽连续的堆空间，需要保留大量分配池等技巧。

这仍然是 64 位地址空间的问题吗？性能对我来说不是问题，所以我宁愿简化我的代码，不再处理缓冲池之类的事情。有没有人有关于这个问题的经验或故事？我使用的是 Linux，但我想许多相同的问题也适用于 Windows。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-03-28T13:27:02.780

> 这仍然是 64 位地址空间的问题吗？

不，这仍然不是问题。

您是正确的，这是 32 位系统上的问题，但它不再是 64 位系统上的问题。

64 位系统上的虚拟地址空间非常大（在今天的 x86_64 处理器上目前为 2^48 字节，随着新的 x86_64 处理器的问世，虚拟地址空间将逐渐增加到 2^64），以至于连续的虚拟地址空间不足由于碎片化几乎是不可能的（除了一些高度人为的极端情况外）。

（这是一个常见的直觉错误，原因是 64 “只有”双 32，这导致人们认为 64 位地址空间大约是 32 位地址空间的两倍。事实上，一个完整的 64 位地址空间是 32 位地址空间的 40 亿倍。）

换句话说，如果您的 32 位守护程序**需要一周**时间才能分段到无法分配 x 字节块的阶段，那么至少需要**一千年**才能将今天的 x86_64 处理器的 48 位地址空间分段，并且将未来计划的完整 64 位地址空间分段需要**8000 万年。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T19:08:01.733

堆碎片在 64 位和 32 位下同样是一个问题。如果您发出大量具有不同生命周期的请求，那么您将获得一个碎片堆。不幸的是，64 位操作系统在这方面并没有真正的帮助，因为它们仍然不能真正洗牌周围的小块空闲内存以形成更大的连续块。

如果要处理堆碎片，仍然必须使用相同的旧技巧。

64 位操作系统在这里可以提供帮助的唯一方法是，如果有一些“足够大”的内存，您永远不会对其进行碎片化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T18:59:45.790

如果您的进程确实需要千兆字节的虚拟地址空间，那么升级到 64 位确实可以立即消除对变通办法的需要。

但值得计算出您希望进程使用多少内存。如果它只是在千兆字节或更少的区域内，那么即使是疯狂的碎片也不会让你用完 32 位地址空间 - 内存泄漏可能是问题所在。

（顺便说一句，Windows 的限制更大，因为它在每个进程中为操作系统保留了不礼貌的地址空间量）。

# wpf - 是否所有 WPF 渲染转换都以双精度运行？

> ID：314910
> 
> 赞同：2
> 
> 时间：2008-11-24T17:56:34.467
> 
> 标签：wpf

WPF 以双精度存储其所有数据。我只想确认所有转换等都以双精度运行。

我正在处理一个非常大的 WPF 画布（40,000,000 x 40,000,000），通过平移和缩放来放大它——在上面放置包含卫星图像的图块。为了缩放和翻译，我使用了一个包含 ScaleTransform 和 TranslateTransform 的 TransformGroup。

放大时，如果您稍微调整 scaletransform，瓷砖似乎会摇晃，就好像它们在画布上的位置略有变化，即使我正在改变的只是 scaletransform。我担心转换不是以双精度完成的，而是被运送到硬件并以单精度完成。

有没有办法控制渲染转换的精度？或者至少确认它使用的是双精度而不是单精度？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-24T11:29:50.200

前段时间，我注意到完全相同的事情：使用极端变换时，渲染的位图会严重失真。我当时做的一些测试让我确信 WPF 确实将转换转发到 GPU，然后它使用单精度处理而不是双精度。

我发现的唯一解决方法是简化转换。例如，与其将图像的大小设置为 100,000 x 100,000 单位和 0.0001 的比例因子，不如将其设置为 1 个单位的大小和 10 的比例因子。翻译也是如此。

根据您的设计，这可能意味着您的布局逻辑将变得更加复杂，因为您必须手动进行一些 WPF 将为您完成的计算。对于允许大范围缩放级别的应用程序（例如从整个地球到单个建筑物的视图），似乎没有其他方法。

# c# - 循环遍历数据表并删除行

> ID：314926
> 
> 赞同：7
> 
> 时间：2008-11-24T18:06:33.527
> 
> 标签：c#, .net, asp.net, sql

我已经从 2 个不同的服务器填充了一个数据表。我可以在长度> 0的地方进行调整，我想要做的是删除没有命中的行。这是我所拥有的摘要

```
DataRow[] dr = payments.dtPayments.Select(myselect);

if (dr.Length > 0)
{
   for (int a = 0; a < dr.Length; a++)
   {
      if (thisOption == true)
         dr[0].Delete();
      else if (otherOption == true)
      {
         dr[0]["Date"] = myDataReader["date"].ToString().Trim();
         dr[0]["Pay"] = payTypeName(myDataReader["ccdsrc"].ToString()
                                                          .Trim());
      }
   }
}
if (dr.Length == 0)
{                        
   if (LastOption == true)
   {
     //DataRow should be removed
   }                        
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-24T18:33:06.127

我不确定我是否完全理解你的问题，但似乎你试图从集合中删除一个条目，而你仍在循环它。（这会导致数组索引错误）

您应该在新集合中保存对要删除的每个条目的引用，然后从旧集合中删除所有新条目：

```
DataRow[] dr = payments.dtPayments.Select(myselect);
List<DataRow> rowsToRemove = new List<DataRow>();

for (int a = 0; a < dr.Length; a++) {
    if(/* You want to delete this row */) {
        rowsToRemove.Add(dr[a]);
    }
}

foreach(var dr in rowsToRemove) {
    payments.dtPayments.Rows.Remove(dr);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T18:40:14.893

如果 dr.Length 为零，则您的选择没有返回任何行。如果您想删除与您的条件不匹配的行，那么我会将其实现为不同类型的查询。也可能是我完全误解了你的问题。您能否更新您的问题以显示您的 SQL 并指出您在代码示例中遇到问题的位置：在循环内部还是在您有评论的循环之后？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T18:38:00.453

您需要在循环外创建一个数据行，然后当您到达要删除的行时，将其分配给您在外部创建的行。并打破循环。然后在循环下方，您可以将其删除。

```
DataRow r = null;
foreach(DataRow row in table.Rows)
{
   if(condition==true)
   {
      r = row;
      break;
   }
}

table.Rows.Remove(r); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T18:14:08.097

你试过这个吗？

payment.dtPayments.Rows.Remove(dr)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-24T19:23:29.970

您可以反向循环遍历集合（for (int i=rows.length-1;x>-1;x--) ）以删除多行，以确保不会出现索引越界错误。

# c++ - glibc 的 '-lmcheck' 选项和多线程

> ID：314931
> 
> 赞同：8
> 
> 时间：2008-11-24T18:11:15.263
> 
> 标签：c++, multithreading, glibc

我们一直在尝试寻找多线程 C++ 应用程序中的一些堆损坏问题。作为一种技术，我们尝试将 -lmcheck 添加到应用程序的库行。这导致应用程序在相对较短的时间内因明显的堆损坏而崩溃。

我们的应用确实同时使用了 malloc/free 和 new/delete（视情况而定）。

我们的一个团队想知道 -lmcheck 是否实际上是线程安全的，并在所有 malloc/free 调用周围放置了一个互斥锁。崩溃消失了。

有谁知道 -lmcheck 是否应该支持多线程？我想知道我们是否只是误解了我们正在尝试使用的工具，从而导致我们自己不必要的担心。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-24T18:22:45.773

不，mcheck 不是线程安全的，不应与多线程应用程序一起使用。这样做会引入额外的问题，因为线程之间没有同步。以下是 Ulrich Drepper（glibc 维护者）几个月前对该主题的回复：

> mcheck 不适用于多线程代码。它不可能做到。使用 mcheck 底层技术无法解决此问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-24T18:32:51.493

在我们花时间愚弄它之前，我应该检查一下。嗯嗯。

这是该报价来源的链接（我相信）：

[http://sourceware.org/bugzilla/show_bug.cgi?id=6547](http://sourceware.org/bugzilla/show_bug.cgi?id=6547)

glibc 文档缺陷：

[http://sourceware.org/bugzilla/show_bug.cgi?id=12751](http://sourceware.org/bugzilla/show_bug.cgi?id=12751)

已打开以帮助避免其他人碰到此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T14:43:15.450

作为替代方案，我强烈推荐 valgrind - 它适用于多线程应用程序 - 尽管它模拟线程，但它本身实际上并不使用线程。

# c# - ASP.NET MVC：如何将列表（来自模型中的类）传递给视图中的转发器？

> ID：314933
> 
> 赞同：5
> 
> 时间：2008-11-24T18:11:21.800
> 
> 标签：c#, asp.net-mvc, model-view-controller

我该怎么做以上？我已经开始使用 MVC，但在传递数据时遇到了问题。

我的具体问题是与我的模型中的对象列表有关，我需要在视图中访问并迭代。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-24T19:18:16.190

假设您的控制器操作看起来像

```
public ActionResult List()
{
    List<string> myList = database.GetListOfStrings();
    (...)
} 
```

现在您想将您的列表传递给视图，例如“List.aspx”。为此，您可以让操作返回 ViewResult（ViewResult 是 ActionResult 的子类）。您可以使用 Controller 的 View 方法返回 ViewResult，如下所示：

```
public ActionResult List()
{
    List<string> myList = database.GetListOfStrings();
    (...)
    return View("List", myList);
} 
```

为了能够在您的视图中以强类型方式访问列表，它必须从 ViewPage 派生，其中 T 是您传入的数据的类型。因此，在当前情况下，我们的视图（在 List.aspx 中。 cs) 会是这样的：

```
public partial class List : ViewPage<string>
{
    (...)
} 
```

以这种方式传递到视图中的数据称为“ViewData”。要访问数据，您必须通过 ViewPage 上的 ViewData.Model 属性。因此，要呈现您将编写的列表的内容（在 List.aspx 中）

```
<ul>
    <% foreach(var s in this.ViewData.Model){ %>
    <li> <%= s %> </li>
    <% } %>
</ul> 
```

这里，this.ViewData.Model 具有您在 ViewPage 中指定类型参数 T 的类型，因此在我们的示例中 this.ViewData.Model 具有 List 类型。

你*可以*使用中继器来渲染这样的东西，但我不推荐它。如果您想使用类似的东西，请查看 CodePlex 上 MvcContrib 项目的 Grid 模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-24T18:53:23.637

快速而肮脏的方法是通过 ViewData 传递它

```
public ActionResult List()
{
    ViewData["MyList"] = new List<string> () {"test1", "test2"};

    return View ();
} 
```

然后你可以在你的视图中访问它

```
<ul>
<% foreach (string item in (List<string>)ViewData["MyList"]) { %>
    <li><%= item %></li>
<% }%>
</ul> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T18:33:39.183

ASP.NET MVC 有几种方法可以将数据传递给您的视图。将模型类传递给视图的主要方法是将其包含在控制器返回的 ViewResult 类中，如下所示：

```
Function List() As ViewResult
    ' pass other information in the viewdata dictionary
    ViewData("Title") = "All Items"
    ' get our item list from the Model classes
    Dim items = Model.ItemRepository.GetAllItems()
    ' return as part of result
    Return View(items)
End Function 
```

然后从您的视图中，您可以访问该列表，如下所示：

```
<% For Each item In ViewData.Model %>
    <%=item.Name%>
<% End If %> 
```

传递数据的另一种方法是通过 ViewData 字典，如上面的控制器函数所示。您可以从您的视图中访问它，例如：

```
<%=ViewData("Title")%> 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-24T18:26:44.140

如果我没记错的话，中继器控件需要页面模型。（页面模型是经典的 ASP.NET 使用的）

但你应该看看这个链接：[http ://haacked.com/archive/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx](http://haacked.com/archive/2008/05/03/code-based-repeater-for-asp.net-mvc.aspx)

# php - PHP -CSV 从 url 读取和上传图像

> ID：314934
> 
> 赞同：0
> 
> 时间：2008-11-24T18:11:41.503
> 
> 标签：php, import

任何人都可以帮我在 PHP 中找到一个代码片段来读取 CSV 文件中的内容，然后插入到一些表中以及从 www 获取一些数据（从 CSV 文件中的图像 url 获取图像）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-24T18:54:56.393

代码看起来像这样。请注意，此代码尚未经过测试或加强安全性。

```
 $handle = fopen("fileUploads.csv", "r");

while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
     $insertSQL = "INSERT INTO myTable values ('$data[0]', '$data[1]')";

```
 //run the sql

  //download the image
  $saveHandle = fopen("image".$data[0] .".jpg", "w+");

  $getImageHandle = fopen($data[1], "r"); // open the image

  $contents = stream_get_contents($getImageHandle); //download it

  fclose($getImageHandle); //close the handle

  fwrite($saveHandle, $contents); //write the contents to disk

  fclose($saveHandle); //close the handle 
```

}

fclose($handle); 
```

`此代码假定您的 csv 看起来像这样。`

 `1、[http://www.foobar.com/images/something.jpg](http://www.foobar.com/images/something.jpg)

# jquery - JSP的tablesorter问题

> ID：314936
> 
> 赞同：6
> 
> 时间：2008-11-24T18:12:44.840
> 
> 标签：jquery, tablesorter

我有一个单页应用程序，其唯一的页面是通过 JSP 创建的。它允许人们查找书目信息。不幸的是，JQuery tablesorter 存在一些问题。

1.  主要是结果页面无法排序，标题图像也不可见，但是如果您将页面保存在本地，那么它就可以排序了。

你可以[在这里查看](http://simtestprv.uab.es/sidon)。

对于那些访问该地方的人，您会看到一个次要问题。编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-14T22:25:27.910

```
$("#result").tablesorter(); 
```

# icalendar - 如何：更新由 iCalendar 文件导入的日历事件？

> ID：314937
> 
> 赞同：6
> 
> 时间：2008-11-24T18:12:54.497
> 
> 标签：icalendar

> **可能重复：**
> [ICalendar 和事件更新在 Outlook 中不起作用](https://stackoverflow.com/questions/45453/icalendar-and-event-updates-not-working-in-outlook)
> [帮助在 Outlook 2007 中使用 iCalendar 文件更新事件](https://stackoverflow.com/questions/275759/help-updating-an-event-in-outlook-2007-with-an-icalendar-file)

如何更新 iCalendar 文件导入的日历事件？

我需要重新导入事件，但我想确保更新现有事件。目前，如果我进行导入，它会添加其他事件，而不是更新我的 Outlook 日历上的现有事件。

```
BEGIN:VCALENDAR
VERSION:1.0        
BEGIN:VEVENT
UID:123@mydomain.com
METHOD:REFRESH
CATEGORIES:MEETING
STATUS:TENTATIVE
DTSTART:20081125T233000Z
DTEND:20081125T233000Z
SUMMARY: Updated Event 2\. Imported From iCalendar File.
DESCRIPTION:This is a test
CLASS:PRIVATE
END:VEVENT       
END:VCALENDAR 
```

我正在尝试使用 METHOD: REFRESH 我也尝试了 METHOD: REQUEST 但它仍然添加了其他事件，而不是更新我的 Outlook 日历上的现有事件。

# algorithm - Excel 使用什么算法重新计算公式？

> ID：314943
> 
> 赞同：2
> 
> 时间：2008-11-24T18:15:25.023
> 
> 标签：algorithm, data-structures, excel-formula

[语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)中表示的公式是否会使用访问者模式等设计模式重新计算？您将如何在代码中重现重新计算过程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-27T00:11:51.883

[Resolver One](http://www.resolversystems.com)是使用 IronPython 开发的电子表格。

它的源代码已作为[Dirigible Spreadsheet](https://github.com/pythonanywhere/dirigible-spreadsheet)发布。[曾经有一篇文章](https://web.archive.org/web/20110805045255/http://pythonology.org/success&story=resolver)描述了它的整体算法：

[![在此处输入图像描述](https://i.stack.imgur.com/Mn4A9.png)](https://i.stack.imgur.com/Mn4A9.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-24T18:37:41.390

正如您所说，一个猜测可能是 Excel 创建了一堆 AST，每个独立的单元格组一个，其中叶子是原始静态数据，节点是公式。

[然后它使用后序](http://en.wikipedia.org/wiki/Tree_traversal#Iterative_traversing)树遍历算法计算每个节点的结果。

您必须考虑叶/节点取消、部分重新计算、ecc。如果我没记错的话，我在某处读到 Excel 可以受益于多核处理器以并行重新计算工作表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T18:42:11.240

> AST 中表示的公式是否会使用访问者模式等设计模式重新计算？

您正在考虑[口译员](http://en.wikipedia.org/wiki/Interpreter_pattern)，而不是访客。虽然使用访问者的 treewalking 可以与口译结合使用，但在这里使用口译员更有意义（因此得名）。这基本上就是friol写的，即后序遍历树，执行每个节点关联的函数。

# ruby-on-rails - Rails 后台任务开销

> ID：314944
> 
> 赞同：8
> 
> 时间：2008-11-24T18:15:36.253
> 
> 标签：ruby-on-rails

有没有人比较过各种后台处理技术的开销？

背景/RB、Starling、Workling MemcacheQ Beanstalk 后台作业 (Bj) 延迟作业 (Dj)

我将在一个切片上实现其中一个，并且想知道它们占用了多少内存，以便我可以将其纳入我的决策。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-24T19:13:03.860

我也对全面比较感兴趣，但我可以说的一件事是 BackgroundRB 被其作者认为已弃用。在 EngineYard，他们特别推荐 BackgroundJob，因为他们遇到了 BackgroundRB 的棘手问题。但是，我对您提到的其他选项一无所知。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T04:51:35.383

它会根据您的 Rails 应用程序本身而有所不同。

这些处理器中的大多数依赖于您的 Rails 对象，它们实际上会将整个 Rails 实例加载到内存中。您的应用程序内存将取决于模型的数量、任何插件的影响以及您所在环境的主要气候条件。

我有一个运行多个 Mongrel 和 BackgroundRB 的 256mb Slice，发现后台进程使用的内存与 Mongrel 实例使用的内存大致相同。

我一直喜欢的一个选择是将您的计划逻辑放在控制器中，并使用 wget 或 Curl 通过 Cron 调用它。您可以利用现有的 Rails 应用程序，并且设置它的开销很小。在上述情况下，我没有使用此选项的唯一原因是要求每 5 秒访问一次队列（Cron 只能每分钟运行一次）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T22:02:04.627

对于低维护，我喜欢后台作业。它在 Rails 进程中或通过 cron 运行，因此没有要监视的守护进程。在我的服务器上，Bj 目前正在使用 35636 RSS（大约一个 Rails 进程值）。

当我听说有人使用 BackgrounDRB 时，我总是很惊讶，因为它基本上是无人维护的。

# makefile - 这个 Makefile 在做什么？

> ID：314945
> 
> 赞同：3
> 
> 时间：2008-11-24T18:15:51.213
> 
> 标签：makefile

我是使用 makefile 的新手，我有一些 makefile。其中一个有这些陈述，我试图理解，但我不能。

### 这个makefile在做什么？

```
# debugging support
ifeq ($(DEBUG), true)
CFLAGS+=-DDEBUG -g
endif 

ifeq ($(DEBUG), gdb)
CFLAGS+=-g
endif

ifeq ($(PROFILING), true)
CFLAGS+=-p
endif

# symbolic names debugging
ifeq ($(DEBUG_NAMES), true)
CFLAGS+=-DDEBUG_NAMES
endif 

# architecture TODO: add others
ifeq ($(ARCH), unix)
CFLAGS+=-DUNIX
endif

# TODO: GC settings
ifeq ($(HEAP), malloc)
CFLAGS+=-DHEAP_MALLOC
endif

ifeq ($(STACK), malloc)
CFLAGS+=-DSTACK_MALLOC
endif

# class loading method
ifeq ($(CLASS), external)
CFLAGS+=-DEXTERNAL_TUK
endif

# monitor allocation
ifeq ($(MONITORS), ondemand)
CFLAGS+=-DON_DEMAND_MONITORS
endif 
```

阿姆里

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T18:21:40.453

本质上，makefile 会根据某些变量的状态进行一系列检查并添加编译器标志。例如：

```
ifeq ($(DEBUG), true)

CFLAGS+=-DDEBUG -g

endif 
```

如果 DEBUG 变量 $(DEBUG) 设置为 true，则定义宏 DEBUG，并将编译器设置为输出调试二进制文件 (-g)。

其他所有语句的模式大致相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-24T18:20:33.827

这将检查环境变量的值并使用编译器的特定选项配置构建过程（我认为）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T20:36:56.920

CFLAGS 是一串参数，在调用它时将传递给 C 编译器。

如果您不知道参数的含义，则需要查看 C 编译器的帮助。例如：

```
man cc
man gcc
cc --help
gcc --help 
```

# asp.net - ASP.NET 友好的图像编辑器

> ID：314958
> 
> 赞同：0
> 
> 时间：2008-11-24T18:20:53.107
> 
> 标签：asp.net, flash, silverlight, image-processing

我正在寻找可以轻松嵌入到 ASP.NET 网站中的图像编辑器。我需要能够绘制矩形、线条并添加一些文本。此外，不得将图像上传到第三方服务器。

我检查了开发 .NET 控件的主要 ISV 的站点，但它们都没有提供独立的图像编辑器来提供我提到的所有功能。它们中的大多数都可以让您旋转、翻转、调整图像大小并设置一些过滤器，仅此而已。几乎有一个编辑器[http://pixlr.com/app/ ）。](http://pixlr.com/app/)不幸的是，所有图像都必须上传到 Pixlr 服务器，从我的角度来看，这是一个交易破坏者。它可以是与 ASP.NET 集成的任何东西（JavaScript、Flash、Silverlight 等）。

谢谢

帕维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-24T18:28:17.617

我认为[AtalaSoft](http://www.atalasoft.com/products/dotimage/thinclient/default.aspx)拥有和编辑器，可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-03T18:55:29.040

```
if (sense == 1) //Rotate 90 to right
    {
        img.RotateFlip(RotateFlipType.Rotate270FlipXY);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-23T03:26:45.340

“图像编辑器”是指照片编辑器还是绘图应用程序？（抱歉，'画线和矩形'的东西让我有点失望）[http://imago.konnektion.com](http://imago.konnektion.com)上有一个基于 Silverlight 的照片编辑器（具有文本添加功能），它可以集成为 ASP.NET 控件或直接通过任何网页上的 HTML 代码，并带有可配置的上传目标地址 - 这和您的想法一样吗？

# sql - 如何隐藏已经被撤销的重复记录（在水晶报表中）？

> ID：314966
> 
> 赞同：2
> 
> 时间：2008-11-24T18:24:34.567
> 
> 标签：sql, reporting-services, crystal-reports, report

[这个问题是我前几天问的一个问题（“需要查找重复记录但排除反向交易”）](https://stackoverflow.com/questions/302022/sql-need-to-find-duplicate-records-but-exclude-reversed-transactions)的后续问题。

我有一个显示客户燃料交易的水晶报表。有时会错误地导入重复的交易。如果/当发现此错误时，管理员将撤消交易，从而留下两个原始副本和一个“负面”交易用于撤消。例子：

```
Date;     Qty;     Value;     Reversal

1/14/08     5       20         N
1/14/08     5       20         N
1/14/08    -5      -20         Y
1/20/08     8       56         N
1/22/08     9       62         N
1/22/08     9       62         N 
```

理想情况下，客户只会看到 SINGLE 交易（或尚未撤销的重复交易）。如果交易被撤销，我们只希望他们看到原始的唯一记录。示例（基于上述数据）：

```
Date;     Qty;     Value;

1/14/08     5       20
1/20/08     8       56
1/22/08     9       62
1/22/08     9       62 
```

我已经有一个***查询***，它将以我刚才描述的方式返回数据，但我需要将它与需要连接到其他表的水晶报表集成。如果我使用已有的 sql，性能会很糟糕，所以我想看看是否可以在 Crystal 的公式中隐藏重复（反向）事务，而不是使用 SQL 命令作为连接到其他表的表。

如果我不清楚，请告诉我。我提前感谢您的智慧！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T23:26:52.430

反转总是排序到底部吗？如果是这样，您可以使用公式检查下一条记录并有条件地隐藏详细信息部分。

因此，在详细信息部分添加一个公式，如果该部分是冲销记录或当前记录与后续冲销记录匹配，则有条件地抑制该部分：

```
( {Reversal} = "Y" ) OR 
( {Date} = Next({Date}) AND {QTY} = Next({QTY}}) * -1 AND 
  {Value} = Next({Value}) * -1 AND Next({Reversal}) = "Y" ) 
```

如果反转始终匹配，您可以将其简化为：

```
( {Reversal} = "Y" ) OR 
( Next({Reversal}) = "Y" ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T10:56:32.553

稍微改变数据模型，以便以某种方式反转和反转记录并标记是否为时已晚？我曾经在这样一个系统上工作过，其中插入的记录带有“C”（当前）标志，如果反转则更新为“O”（原始），并且反转记录被标记为“R”。所有只想查看当前数据的查询都可以添加到 WHERE 子句中：

```
AND rec_type = 'C' 
```

# c++ - #include 标头保护格式？

> ID：314983
> 
> 赞同：20
> 
> 时间：2008-11-24T18:30:38.160
> 
> 标签：c++, header, c-preprocessor

我知道这对项目没有什么影响，但是，假设您对 C++ 代码使用#defined 标头保护，您使用什么格式？例如假设一个名为`foo.hpp`：

```
#ifndef __FOO_HPP__
...

#ifndef INCLUDED_FOO_HPP
...

#ifndef SOME_OTHER_FORMAT 
```

我对大写#defines 的想法很满意，但无法确定这些守卫的格式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-24T18:41:33.940

我总是在包含保护中包含命名空间或相对路径，因为只有标头名称已被证明是危险的。

例如，您有一些大型项目，代码中的某处有这两个文件

```
/myproject/module1/misc.h
/myproject/module2/misc.h 
```

因此，如果您为包含保护使用一致的命名模式，您最终可能会`_MISC_HPP__`在两个文件中都定义（发现这样的错误非常有趣）。

所以我解决了

```
MYPROJECT_MODULE1_MISC_H_
MYPROJECT_MODULE2_MISC_H_ 
```

这些名字比较长，但比起双重定义的痛苦，还是值得的。

另一种选择，如果您不需要编译器/平台独立性，您可能会寻找一些 #pragma once 的东西。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-24T18:32:49.463

我总是用`INCLUDED_FOO_HPP`

我不会使用双下划线，因为以双下划线开头的东西是保留的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-24T18:39:17.063

为了真正避免名称冲突，我使用 GUID：

```
#ifndef GUARD_8D419A5B_4AC2_4C34_B16E_2E5199F262ED 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-24T18:41:05.440

就个人而言，我只使用文件名 FOO_HPP。Google 使用 SRC_ENGINE_FAST_HPP 之类的整个路径。

> 某些名称和函数签名集始终保留给实现：
> 
> *   每个包含双下划线 (_ _) 或以下划线后跟大写字母 (2.11) 的名称都保留给实现以供任何使用。
> *   每个以下划线开头的名称都保留给实现用作全局名称空间中的名称。

( `17.4.3.1.2/1`)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-24T18:40:34.987

我更喜欢这种格式：

```
#ifndef FOO_HPP
#define FOO_HPP

/* ... */

#endif // FOO_HPP 
```

*   一个简单的**#ifndef**而不是**#if !defined(...)**，因为对标头保护使用复杂的条件很少有意义。
*   **_HPP**部分将标识符标记为标头保护。
*   没有前导下划线，因为这样的标识符（以 2 个下划线或 1 个下划线和大写字母开头）是为实现保留的。
*   基本部分只是文件名**FOO**。但是，对于将要重用的库代码，建议在开头添加另一部分。这通常是包含名称空间或“模块”名称，例如**`MYLIB_FOO_HPP`**，它有助于避免命名冲突。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-24T18:34:53.890

我用

```
 #if !defined(FOO_HPP_INCLUDED) 
```

我更喜欢现代`defined`语法，因为它允许 || && 运算符，即使这里没有使用它们。

还

```
 #ifndef __FOO_HPP__ 
```

在技​​术上是非法的，因为前导下划线是保留的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-24T18:39:04.303

如果您使用 Visual Studio 或 Microsoft 编译器，请使用 pragma 方式

```
#pragma once 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-24T18:36:33.340

我总是使用

```
#ifndef FOOBAR_CPP 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-24T19:44:49.210

我也一直使用类似的东西：

```
#ifndef FOO_HPP
#define FOO_HPP 1

...

#endif 
```

正如大多数人所提到的，不要在符号前面加上双下划线，因为这是 C++ 标准保留的，供实现内部使用。

您可能想查看 John Lakos 的优秀书籍“Large Scale C++ Software Design”（[亚马逊链接](http://www.amazon.co.uk/dp/0201633620/)- 为脚本 Kiddy 链接纳粹清理），以了解有关标头包含的一些注意事项。

高温高压

干杯，

抢

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-25T02:18:26.997

当我的时间得到报酬并且还没有公司标准时，我使用：

```
#ifndef path_to_file_h
#define path_to_file_h 
```

小写的原因是更容易复制和粘贴文件名，并用下划线替换斜线。#ifndef 的原因是它与#define 很好地对齐，从而更容易看到符号相同。不过，我喜欢 GUID 的想法，所以我可能会尝试一下。

当我没有为我的时间付费，也没有将我的代码发布到野外时，我只使用`#pragma once`. 与大多数其他可移植性问题不同，稍后添加包含防护与现在一样容易，并且可以由对代码库一无所知的人完成（例如，一年后的我，或者我将代码发送给某个无辜的程序员） ，所以 YAGNI 适用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-24T19:50:49.213

我倾向于使用：

```
#ifndef FILE_DATE_H_ 
```

（将 _H_ 替换为适当的扩展名，如 _HPP_ 等）。日期戳是为了避免与其他方向/库中的其他同名标题发生冲突。

所以最后它看起来像这样：

```
#ifndef SOMEFILE_20082411_H_ 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-12-15T14:13:26.033

我用

```
<FILENAME_IN_ALL_CAPS>_<YYYYMMDD> 
```

或者

```
<FILENAME_IN_ALL_CAPS>_INCLUDED_<YYYYMMDD> 
```

与文件夹层次结构保持同步太烦人了（重构的朋友），GUID 太烦人了，日期后缀就[足够了](http://en.wikipedia.org/wiki/Principle_of_good_enough)。如果我必须在同一天同样命名文件，我会

```
<FILENAME_IN_ALL_CAPS>_<YYYYMMDD>a
<FILENAME_IN_ALL_CAPS>_<YYYYMMDD>b
<FILENAME_IN_ALL_CAPS>_<YYYYMMDD>... 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-29T20:09:12.770

我会选择文件路径 + 升压`_INCLUDED`后缀加上现在广泛支持的`#pragma once`

在很多编辑器中（对我来说它是崇高的），您还可以为此定义一些宏/片段。

这是为您做的一个：

```
<snippet>
    <content><![CDATA[
#ifndef ${1:${TM_FILEPATH/(.*\/(include|src))*([^a-zA-Z0-9_]+)*([a-zA-Z0-9_]+)([.])*([a-zA-Z0-9_]+)*/\U$4_$6/ig}_INCLUDED}
#define $1
#pragma once

$0

#endif // $1
]]></content>
    <tabTrigger>incguard</tabTrigger>
    <description>include guard</description>
</snippet> 
```

所以`yourproject/include/yourlib/yourfile.hpp`

变成`YOURLIB_YOURFILE_HPP_INCLUDED`

一个额外的外部源代码样式检查器工具可以通过这种方式轻松跟踪您的警卫的一致性。

# c - 什么是 C 中寄存器变量使用的好例子？

> ID：314994
> 
> 赞同：38
> 
> 时间：2008-11-24T18:34:20.523
> 
> 标签：c, cpu-registers, kernighan-and-ritchie, kr-c

我正在阅读 K&R 并来到关于寄存器变量的小部分，并且想知道这里的人们是否有一些很好的实践示例。

从 K&R 的第 4.7 节：

> 寄存器声明看起来像
> register int x;
> 注册字符 c;

需要明确的是，我只是希望看到一些很酷的代码示例。我（很确定我）理解主题，所以不需要输入详细的解释（除非你愿意）。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-11-24T18:43:50.800

使用现代编译器时没有很好的寄存器使用示例（阅读：过去 15 年以上，请注意这个答案来自 2008 年），因为它几乎从来没有任何好处，而且可能会做一些坏事。当您使用 register 时，您是在告诉编译器“我知道如何比您更好地优化我的代码”，而这几乎从来没有发生过。使用 register 时可能会发生以下三种情况之一：

*   编译器会忽略它，这很可能。在这种情况下，唯一的危害是您不能在代码中获取变量的地址。
*   编译器尊重您的请求，因此代码运行速度较慢。
*   编译器尊重您的请求，代码运行得更快，这是最不可能的情况。

即使一个编译器在您使用寄存器时生成了更好的代码，也没有理由相信另一个编译器会这样做。如果你有一些关键代码编译器优化得不够好，你最好的选择可能是对那部分使用汇编程序，但当然首先要进行适当的分析以验证生成的代码确实是一个问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-24T18:57:53.033

总的来说，我同意[罗伯特](https://stackoverflow.com/questions/314994/whats-a-good-example-of-register-variable-usage-in-c#315035)的观点，但作为任何好的规则，这个规则也有例外。
如果您在深度嵌入式系统上工作，您可能比编译器更了解如何**在您的特定硬件架构上为您的特定应用程序**优化代码。

但在 99% 的情况下，罗伯茨的解释也适用于嵌入词。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-15T00:19:50.160

我知道这是很久以前的事了，但这里有一个来自 heapsort 的子过程的实现，其中使用寄存器变量使算法更快，至少使用 gcc 4.5.2 来编译代码

```
inline  void max_heapify(int *H, int i){
    char OK = FALSE;
    register int l, r, max, hI;
    while(!OK){
        OK = TRUE;
        l = left(i);
        r = right(i);
        max = i;
        if(l <= H[SIZE] && H[l] > H[i]){
            max = l;
        }
        if(r <= H[SIZE] && H[r] > H[max]){
            max = r;
        }
        if(max != i){
            OK = FALSE;
            hI = H[i];
            H[i] = H[max];
            H[max] = hI;
            i = max;
        }
    }
} 
```

我在属性之前测试了使用和不使用 register 关键字的算法，并执行它以在我的笔记本上对一个包含 50,000,000 个元素的随机数组进行排序，每个版本几次。

寄存器的使用将堆排序时间从 ~135s 降低到 ~125s。

我也只测试了 5,000,000 个元素，但执行的次数更多。

没有寄存器的版本从 11s 开始，但每次执行都会降低时间，直到达到 9,65s 并停止

带有寄存器的版本从 10s 开始，并将时间降低到 8,80s。

我认为这与缓存内存有关。尽管如此，寄存器似乎通过恒定因素使算法更快

由于这些变量在算法中被大量使用，通过确保它们在寄存器上而不是将这项工作留给编译器，在这种情况下会产生更好的结果。然而，它并没有改善那么多时间。

希望thhill对某人有所帮助，问候。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-13T22:03:20.203

另一个常见的情况是在实现低级解释器时。在寄存器中保存一些状态，例如。虚拟机堆栈指针，可以显着减少内存访问并加快您的代码速度。

有关优化的示例，请参见[vmgen — 高效虚拟机解释器的生成器](http://citeseerx.ist.psu.edu/viewdoc/download;jsessionid=0670C579EDB9DE3886F37578FD063D4D?doi=10.1.1.22.6510&rep=rep1&type=pdf)（5.2 堆栈顶部缓存）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-05T12:26:55.480

首先，寄存器变量应该用于频繁使用的变量，例如循环控制变量，以通过最小化访问时间来提高性能。在这种情况下，您只能使用并且只能注册存储说明符，例如 fun (auto int a,auto int b) :error fun (register int a,register int b) :right only this will be run fun (static int a, static int b) :error fun (extern int a,extern int b) :error

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-21T11:58:33.443

嗯，这是一个需要多个答案的问题，因为有多个编码上下文：从高级语言的角度来看，中级和低级（下到汇编），因为 C 语言可以调用汇编例程。

使用汇编而不是 C 的原因是因为在开发过程中遇到的性能问题，所以是的，需要 register 关键字，但在许多情况下它不能按开发人员的预期工作

# sql-server - SQL Server 2005 删除带有约束的列

> ID：314998
> 
> 赞同：60
> 
> 时间：2008-11-24T18:36:30.050
> 
> 标签：sql-server, sql-server-2005

我有一列带有“DEFAULT”约束。我想创建一个删除该列的脚本。

问题是它返回此错误：

```
Msg 5074, Level 16, State 1, Line 1  
The object 'DF__PeriodSce__IsClo__4BCC3ABA' is dependent on column 'IsClosed'. 
Msg 4922, Level 16, State 9, Line 1 
ALTER TABLE DROP COLUMN IsClosed failed because one or more objects access this column. 
```

我找不到删除列及其所有相关约束的简单方法（仅找到查看系统表的大脚本......必须（！！）是一种“好”的方法。）

由于默认约束的名称是随机生成的，我不能按名称删除它。

* * *

**更新**：
约束类型是“DEFAULT”。

我看到了你们提出的解决方案，但我发现它们都非常“肮脏”……你不觉得吗？我不知道它是使用 Oracle 还是 MySQL，但可以执行以下操作：

```
DROP COLUMN xxx CASCADE CONSTRAINTS 
```

它会删除所有相关的约束......或者至少它会自动删除映射到该列的约束（至少检查约束！）

MSSQL中没有类似的东西吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-07-23T13:51:40.593

这是一个脚本，它将删除该列及其默认约束。更换`MYTABLENAME`并`MYCOLUMNNAME`适当。

```
declare @constraint_name sysname, @sql nvarchar(max)

select @constraint_name = name 
from sys.default_constraints 
where parent_object_id = object_id('MYTABLENAME')
AND type = 'D'
AND parent_column_id = (
    select column_id 
    from sys.columns 
    where object_id = object_id('MYTABLENAME')
    and name = 'MYCOLUMNNAME'
    )

set @sql = N'alter table MYTABLENAME drop constraint ' + @constraint_name
exec sp_executesql @sql

alter table MYTABLENAME drop column MYCOLUMNNAME

go 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-12T10:36:38.107

此查询查找给定表的默认约束。它不漂亮，我同意：

```
select 
    col.name, 
    col.column_id, 
    col.default_object_id, 
    OBJECTPROPERTY(col.default_object_id, N'IsDefaultCnst') as is_defcnst, 
    dobj.name as def_name
from sys.columns col 
    left outer join sys.objects dobj 
        on dobj.object_id = col.default_object_id and dobj.type = 'D' 
where col.object_id = object_id(N'dbo.test') 
and dobj.name is not null 
```

[编辑] 根据 Julien N 的评论更新

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-07-24T19:57:54.307

也许它可以帮助更多：

```
declare @tablename nvarchar(200)
declare @colname nvarchar(200)
declare @default sysname, @sql nvarchar(max)

set @tablename = 'your table'
set @colname = 'column to drop'

select @default = name 
from sys.default_constraints 
where parent_object_id = object_id(@tablename)
AND type = 'D'
AND parent_column_id = (
    select column_id 
    from sys.columns 
    where object_id = object_id(@tablename)
    and name = @colname 
    )

set @sql = N'alter table ' + @tablename + ' drop constraint ' + @default
exec sp_executesql @sql

set @sql = N'alter table ' + @tablename + ' drop column ' + @colname
exec sp_executesql @sql 
```

只需设置@tablename 和@colname 变量即可删除列。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-25T13:53:16.860

```
> select CONSTRAINT_NAME from INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE
> WHERE TABLE_NAME = '<tablename>' AND COLUMN_NAME = 'IsClosed' 
```

这不是正确的解决方案，因为它在这里解释：http: [//msdn.microsoft.com/en-us/library/aa175912.aspx](http://msdn.microsoft.com/en-us/library/aa175912.aspx)：

> 不幸的是，列默认约束的名称没有保存在 ANSI COLUMNS 视图中，因此您必须返回系统表才能找到名称

我发现获取 DEFAULT 约束名称的唯一方法是这个请求：

```
select  
    t_obj.name              as TABLE_NAME
    ,c_obj.name             as CONSTRAINT_NAME
    ,col.name               as COLUMN_NAME

from    sysobjects  c_obj
join    sysobjects  t_obj on c_obj.parent_obj = t_obj.id  
join    sysconstraints con on c_obj.id  = con.constid
join    syscolumns  col on t_obj.id = col.id
            and con.colid = col.colid
where
    c_obj.xtype = 'D' 
```

我是唯一一个发现无法轻松删除仅涉及我要删除的列的约束的人吗**？**
我需要执行一个包含 3 个连接的请求才能获得名称......

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-11-07T10:58:02.183

我还认为 SQL Server 的一个缺点是没有可用的级联下降。我通过以与此处描述的其他人相同的方式查询系统表来解决它：

*   INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE 只列出外键、主键和唯一约束。
*   查找默认约束的唯一方法是在 sys.default_constraints 中查找它们。
*   这里还没有提到的是**索引**也会使删除列失败，因此您还需要删除所有使用您的列的索引，然后才能继续删除列。

生成的脚本并不漂亮，但我把它放在一个存储过程中以便能够重用它：

```
CREATE PROCEDURE DropColumnCascading @tablename nvarchar(500), @columnname nvarchar(500)
AS

SELECT CONSTRAINT_NAME, 'C' AS type
INTO #dependencies
FROM INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE WHERE TABLE_NAME = @tablename AND COLUMN_NAME = @columnname

INSERT INTO #dependencies
select d.name, 'C'
from sys.default_constraints d
join sys.columns c ON c.column_id = d.parent_column_id AND c.object_id = d.parent_object_id
join sys.objects o ON o.object_id = d.parent_object_id
WHERE o.name = @tablename AND c.name = @columnname

INSERT INTO #dependencies
SELECT i.name, 'I'
FROM sys.indexes i
JOIN sys.index_columns ic ON ic.index_id = i.index_id and ic.object_id=i.object_id
JOIN sys.columns c ON c.column_id = ic.column_id and c.object_id=i.object_id
JOIN sys.objects o ON o.object_id = i.object_id
where o.name = @tableName AND i.type=2 AND c.name = @columnname AND is_unique_constraint = 0

DECLARE @dep_name nvarchar(500)
DECLARE @type nchar(1)

DECLARE dep_cursor CURSOR
FOR SELECT * FROM #dependencies

OPEN dep_cursor

FETCH NEXT FROM dep_cursor 
INTO @dep_name, @type;

DECLARE @sql nvarchar(max)

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @sql = 
        CASE @type
            WHEN 'C' THEN 'ALTER TABLE [' + @tablename + '] DROP CONSTRAINT [' + @dep_name + ']'
            WHEN 'I' THEN 'DROP INDEX [' + @dep_name + '] ON dbo.[' + @tablename + ']'
        END
    print @sql
    EXEC sp_executesql @sql
    FETCH NEXT FROM dep_cursor 
    INTO @dep_name, @type;
END

DEALLOCATE dep_cursor

DROP TABLE #dependencies

SET @sql = 'ALTER TABLE [' + @tablename + '] DROP COLUMN [' + @columnname + ']'

print @sql
EXEC sp_executesql @sql 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-08-31T01:07:18.810

pvolders 的答案正是我所需要的，但它错过了导致错误的统计数据。这是相同的代码，减去创建存储过程，加上枚举统计信息并删除它们。这是我能想到的最好的方法，所以如果有更好的方法来确定需要删除哪些统计数据，请添加。

```
DECLARE @tablename nvarchar(500), 
        @columnname nvarchar(500)

SELECT  @tablename = 'tblProject',
        @columnname = 'CountyKey'

SELECT CONSTRAINT_NAME, 'C' AS type
INTO #dependencies
FROM INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE WHERE TABLE_NAME = @tablename AND COLUMN_NAME = @columnname

INSERT INTO #dependencies
select d.name, 'C'
from sys.default_constraints d
join sys.columns c ON c.column_id = d.parent_column_id AND c.object_id = d.parent_object_id
join sys.objects o ON o.object_id = d.parent_object_id
WHERE o.name = @tablename AND c.name = @columnname

INSERT INTO #dependencies
SELECT i.name, 'I'
FROM sys.indexes i
JOIN sys.index_columns ic ON ic.index_id = i.index_id and ic.object_id=i.object_id
JOIN sys.columns c ON c.column_id = ic.column_id and c.object_id=i.object_id
JOIN sys.objects o ON o.object_id = i.object_id
where o.name = @tableName AND i.type=2 AND c.name = @columnname AND is_unique_constraint = 0

INSERT INTO #dependencies
SELECT s.NAME, 'S'
FROM sys.stats AS s
INNER JOIN sys.stats_columns AS sc 
    ON s.object_id = sc.object_id AND s.stats_id = sc.stats_id
INNER JOIN sys.columns AS c 
    ON sc.object_id = c.object_id AND c.column_id = sc.column_id
WHERE s.object_id = OBJECT_ID(@tableName)
AND c.NAME = @columnname
AND s.NAME LIKE '_dta_stat%'

DECLARE @dep_name nvarchar(500)
DECLARE @type nchar(1)

DECLARE dep_cursor CURSOR
FOR SELECT * FROM #dependencies

OPEN dep_cursor

FETCH NEXT FROM dep_cursor 
INTO @dep_name, @type;

DECLARE @sql nvarchar(max)

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @sql = 
        CASE @type
            WHEN 'C' THEN 'ALTER TABLE [' + @tablename + '] DROP CONSTRAINT [' + @dep_name + ']'
            WHEN 'I' THEN 'DROP INDEX [' + @dep_name + '] ON dbo.[' + @tablename + ']'
            WHEN 'S' THEN 'DROP STATISTICS [' + @tablename + '].[' + @dep_name + ']'
        END
    print @sql
    EXEC sp_executesql @sql
    FETCH NEXT FROM dep_cursor 
    INTO @dep_name, @type;
END

DEALLOCATE dep_cursor

DROP TABLE #dependencies

SET @sql = 'ALTER TABLE [' + @tablename + '] DROP COLUMN [' + @columnname + ']'

print @sql
EXEC sp_executesql @sql 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-24T18:49:06.407

您可以通过查询 information_schema 系统视图来获取约束名称。

```
select CONSTRAINT_NAME from INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE WHERE TABLE_NAME = '<tablename>' AND COLUMN_NAME = 'IsClosed' 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-07-26T12:50:47.667

只是以 Jeremy Stein 的回答为基础，我为此创建了一个存储过程，并将其设置为可用于删除具有或不具有默认约束的列。它不是真正有效的，因为它查询 sys.columns 两次，但它有效。

```
CREATE PROCEDURE [dbo].[RemoveColumnWithDefaultConstraints] 
    -- Add the parameters for the stored procedure here
    @tableName nvarchar(max), 
    @columnName nvarchar(max)
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    DECLARE @ConstraintName nvarchar(200)
    SELECT @ConstraintName = Name 
    FROM SYS.DEFAULT_CONSTRAINTS 
    WHERE PARENT_OBJECT_ID = OBJECT_ID(@tableName) 
        AND PARENT_COLUMN_ID = (SELECT column_id FROM sys.columns WHERE NAME = (@columnName) 
        AND object_id = OBJECT_ID(@tableName))
    IF @ConstraintName IS NOT NULL
        EXEC('ALTER TABLE ' + @tableName + ' DROP CONSTRAINT ' + @ConstraintName)

    IF EXISTS(SELECT * FROM sys.columns WHERE Name = @columnName  
        AND Object_ID = Object_ID(@tableName))
        EXEC('ALTER TABLE ' + @tableName + ' DROP COLUMN ' + @columnName)       
END
GO 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-07-20T11:55:06.750

查找约束的名称或使用 MSSQL 设计视图并不总是一种选择。我目前想制作一个脚本来删除带有约束的列。使用名称不是一个选项，因为名称是生成的，我想在不同的环境 Dev/Sys/Prod/etc 中使用脚本。然后无法使用该名称，因为每个环境的约束名称会有所不同。我可能不得不查看系统表，但我同意应该有一个更简单的选项可用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-24T19:07:43.263

我相信在删除列之前明确删除约束是一个“更干净”的解决方案。这样，您就不会放弃您可能不知道的约束。如果删除仍然失败，您知道还有其他限制。我喜欢完全控制我的数据库发生的事情。

另外，为 drop 编写脚本明确地保证了脚本，并希望结果可以完全按照您想要的方式重复。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-24T18:41:40.163

随机生成是什么意思？您可以在 management studio 中或通过 sys.tables 视图查找特定列的约束，并查找名称是什么。

然后，您可以更改脚本以在删除列之前删除约束。这是什么类型的约束？如果它是外键约束，请确保这样做不会损害数据库中的数据完整性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-07-19T14:59:58.010

我刚碰到这个。您可以使用 MSSQL 设计视图删除带有约束的列。右键单击要删除的列（有或没有约束），您可以毫无问题地删除它。哈..我看起来已经很愚蠢了。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-12-12T09:29:22.610

只需为表生成脚本。在那里您可以找到所有约束的名称。`*******