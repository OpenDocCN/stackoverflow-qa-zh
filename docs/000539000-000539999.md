# StackOverflow 问答 000539000-000539999

# c# - 防止编辑 DataGridView 中的特定行

> ID：539003
> 
> 赞同：1
> 
> 时间：2009-02-11T21:54:32.820
> 
> 标签：c#, .net-3.5, datagridview

我想阻止用户编辑或删除 datagridview 的前三行。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:11:16.353

解决方案：

```
private void dataGridView3_CellBeginEdit(object sender, DataGridViewCellCancelEventArgs e) {
    if (e.RowIndex < 3) {
        e.Cancel = true;
    }
}

private void dataGridView3_UserDeletingRow(object sender, DataGridViewRowCancelEventArgs e) {
    if (e.Row.Index < 3) {
        e.Cancel = true;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:01:25.707

一种方法是捕获 _CellBeginEdit 事件，检查是否允许对目标行进行任何编辑，如果不允许编辑则取消事件：

> 私人无效dataGridViewIndexesSpecs_CellBeginEdit（对象发送者，DataGridViewCellCancelEventArgs e）{

```
 if (e.RowIndex <= 3)
            e.Cancel = true;

    } 
```

# asp.net-mvc - 如何通过 jQuery ajax 更新 ASP.NET MVC ViewData？

> ID：539011
> 
> 赞同：3
> 
> 时间：2009-02-11T21:56:07.280
> 
> 标签：asp.net-mvc, asp.net-ajax, jquery

我有一个高度依赖于我在 ViewData 中传递的 IList（在 ActionResult“MyEvents”中）的页面。类似的东西：**ViewData["events"] = listOfEvents;** 最后，我只**返回 View();**

在我的视图中，我使用这个 ViewData["events"] 并在其中执行一个 foreach，以便我可以遍历它的内容。

但是，这个 ViewData 必须是动态填充的。因此，当我单击某一天（我使用的是 jQuery DatePicker）时，这一天作为参数发送到“MyEvents”，这一天对于我的 listOfEvents 将非常重要，它将填充我的 ViewData[“events”]。

但是，我得到的结果是包含我的 foreach 的 div 在其中创建了另一个完整的页面！我试图做**$("#myDiv").html(contentFromMyEvents)**这就是发生的事情。

只是为了测试，我也尝试过**$("#myDiv").text(contentFromMyEvents)**并且整个 html 代码及其所有标签和我页面中的所有其他内容都出现在 div 中！这是一页中的一页！！

所以，我认为这种情况正在发生，因为我正在返回“ **return View();** ”，当然它会再次渲染我的整个视图。

那么，我怎样才能只传递 ViewData["events"] 并在我的页面上更新它？

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T04:46:13.597

[查看 jQuery ( http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load) )中的加载函数。使用负载调用您的控制器，然后将结果注入到您的 html 文档中。

```
$("myDiv").load("/Controller/Action"); 
```

您的 ViewData 将在服务器端进行解析。不是返回 View()，而是返回一个指向用户控件的 PartialView()。然后出来的只是一个 HTML 片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:02:02.803

您可以使用部分渲染，也可以让 jquery 从返回值中选择元素。

```
$("#myDiv").empty().append($(contentFromMyEvents).find('#myDiv')); 
```

另外，请记住，如果您有任何日期选择器或链接需要在此处进行事件，您可能必须重新绑定它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T22:25:23.793

[您应该考虑将数据作为JSON](http://json.org)来回传递。

然后使用 jQuery/Javascript 来操作和格式化您认为合适的数据。

请记住，一旦页面在客户端上，客户端的浏览器就不知道 ViewData 是什么。

**编辑：** 操作代码：

```
public ActionResult AjaxGetEvents(int id)
{
    IList<object> events = new List<object>();
    foreach( Event event in SomeMethodToGetEvents(id) )
    {
       events.Add( new { Property1 = event.Property1, Property2 = event.Property2 } );
    }
    return JSON(events);
} 
```

客户端代码：

```
var url = "some url that returns JSON";
jQuery.getJSON( url, function(data){
    jQuery.each( data ){
        jQuery("#someDiv").append( data.Property1 + " " + data.Property2 "<br/>" );
    });
 }); 
```

# sql - 使用多个表中的数据拉取列表的 SQL 语句

> ID：539029
> 
> 赞同：1
> 
> 时间：2009-02-11T22:00:31.683
> 
> 标签：sql

感谢您的回复。这就是问题.... Oildatasetstatusid 的 (5-11) 映射到 labid=4。Labid=4 有多个客户的输入数据，因此无法根据oildatasetstatusid 进行更新。更新必须基于 samplepointid。这就是使用 3 张桌子的原因。

我是 SQL 无知者之一，被要求执行一项超出我理解范围的任务。我们的客户想要更改他们现有的严重性级别，例如从低警告 (severityid=7) 更改为低 (severityid=18)。严重性信息由第 3 方石油实验室输入数据库。我想使用来自三个不同表的信息生成一个列表，然后更改该列表上的严重性映射。我在下面提供了足够的信息吗？有人可以帮忙吗？？？？

```
table: samplepoint
 - samplepointid

table: oildataset
 - oildatasetid
 - oillabid (4=R&G)
 - samplepointid

table: Oildatasetstatus
 - Oildatasetid
 - Oildatasetstatusid (5,6,7,8,9,10,11) needs to be changed to (16,17,18,19,20)
    - 5=16
    - 6=17
    - 7,8,9=18
    - 10=19
    - 11=20 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T22:15:24.253

我不知道您是否还会做其他事情，但是如果您只想替换这些严重性，请执行以下操作：

UPDATE Oildatasetstatus SET Oildatasetstatusid=16 WHERE Oildatasetstatusid=5;

UPDATE Oildatasetstatus SET Oildatasetstatusid=17 WHERE Oildatasetstatusid=6;

UPDATE Oildatasetstatus SET Oildatasetstatusid=18 WHERE Oildatasetstatusid IN (7, 8, 9);

UPDATE Oildatasetstatus SET Oildatasetstatusid=19 WHERE Oildatasetstatusid=10;

UPDATE Oildatasetstatus SET Oildatasetstatusid=11 WHERE Oildatasetstatusid=20;

如果**Oildatasetid**是主键，则应该这样做。

小心并备份数据。

**Oildatasetstatus**和**oildataset**之间有什么联系？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:20:06.830

如果我理解你的任务，这里的声明可能会有所帮助。你没有说你使用的是什么品牌的数据库软件。

多表`UPDATE`语法是非标准 SQL，仅 Microsoft SQL Server 和 MySQL 支持。这是 MS SQL 的示例（未经测试）：

```
UPDATE Oildatasetstatus
SET Oildatasetstatusid = 
  CASE Oildatasetstatusid
    WHEN 5 THEN 16
    WHEN 6 THEN 17
    WHEN 7 THEN 18
    WHEN 8 THEN 18
    WHEN 9 THEN 18
    WHEN 10 THEN 19
    WHEN 11 THEN 20
    ELSE Oildatasetstatusid
  END CASE
FROM Oildatasetstatus
  JOIN Oildataset USING (Oildatasetid)
WHERE Oildataset.Oillabid = 4; 
```

如果您对 SQL 没有信心，*请先*在您的数据副本上运行它，并验证它是否按预期工作！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T22:20:29.123

重复重字节：小心！

一个方便的提示是在您知道它们会影响什么之前不要编写任何 UPDATE 或 DELETE 语句。这相对容易，因为您可以使用相同的 where 子句构建 SELECT 语句。

例如：

```
UPDATE Oildatasetstatus SET Oildatasetstatusid=18 
WHERE Oildatasetstatusid IN (7, 8, 9) 
```

变成：

```
SELECT * FROM Oildatasetstatus 
WHERE Oildatasetstatusid IN (7, 8, 9) 
```

或者您可以使用注释来执行此操作，以便在您想要执行它时轻松地将其转换回更新语句：

```
-- UPDATE Oildatasetstatus SET Oildatasetstatusid=18 
SELECT * FROM
WHERE Oildatasetstatusid IN (7, 8, 9) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T22:24:26.867

> 我想使用来自三个不同表的信息生成一个列表

您发布的模式在 samplepoint 表中没有实际信息，因此它实际上只是来自两个表的信息。基本上我猜你只是想将'oildataset'中的'oillabid'和'samplepointid'值加入'oildatasetstatus'的每一行？

```
SELECT *
FROM oildatasetstatus
JOIN oildataset ON oildataset.oildatasetid=oildatasetstatus.oildatasetid 
```

> 然后更改该列表上的严重性映射。

我猜您的意思是您希望您的查询具有不同的严重性，而不是实际更新您存储的“oildatasetstatus”表？如果是这样，您可以使用 CASE 运算符：

```
SELECT
    oildataset.oildatasetid, oildataset.oillabid, oildataset.samplepointid,
    CASE oildatasetstatus.oildatasetstatusid
        WHEN 5 THEN 16
        WHEN 6 THEN 17
        WHEN 7 THEN 18
        WHEN 8 THEN 18
        WHEN 9 THEN 18
        WHEN 10 THEN 19
        WHEN 11 THEN 20
    END AS newstatus
FROM oildatasetstatus
JOIN oildataset ON oildataset.oildatasetid=oildatasetstatus.oildatasetid 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T22:14:11.090

```
update Oildatasetstatus
set Oildatasetstatusid = 16
where Oildatasetstatusid  = 5 
```

-- 然后为每个其他状态 ID 运行类似的命令

如果你想在之后得到一份报告，你会运行这样的事情：

```
select s.samplepointid
, ods.oildatasetid
, ods.oillabid
, odss.oildatsetstatusid
from samplepoint s
, oildataset ods
, oildatasetstatus odss
where ods.samplepointid = s.samplepointid
and odss.oildatasetid = ods.oildatassetid
order by s.samplepointid 
```

# c# - 如何使用 C# 调整动画 gif 图像的大小？

> ID：539034
> 
> 赞同：6
> 
> 时间：2009-02-11T22:01:29.763
> 
> 标签：c#, image, gif, animated-gif

有没有一种方法可以使用 C# 创建动画 gif 图像的副本？

我想要的是使用用户提供的高度和宽度参数生成给定 gif 图像的副本。我已经尝试了几个小时来完成此操作，但生成的图像并未保留原始动画。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-03T11:32:23.480

花了我一段时间才找到这个，但终于找到了解决方案：

通过 NuGet安装**Magick.NET**，可以在此处找到许可证：
[https ://magick.codeplex.com/license](https://magick.codeplex.com/license)

示例代码：

```
var newWidth = 100;
using (var collection = new MagickImageCollection(new FileInfo(@"C:\test.gif")))
{
    collection.Coalesce();
    foreach (var image in collection)
    {
        image.Resize(newWidth, 0);
    }
    collection.Write(@"c:\resized.gif");
} 
```

根据我的测试，这适用于 alpha 通道和不同的帧速率。似乎很完美！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T22:19:13.760

您需要遍历动画 GIF 中的帧并调整每个帧的大小。

可能还想看看[GifLib](http://www.codeplex.com/GifLib)。

# eclipse - Best practices for Eclipse Feature Integration Testing

> ID：539046
> 
> 赞同：10
> 
> 时间：2009-02-11T22:02:37.623
> 
> 标签：eclipse, osgi, integration-testing, eclipse-pde

I am developing an Eclipse feature consisting of several Eclipse plugins, using Equinox Declarative Services (DS) to wire the plugins together at runtime. I would like to add integration tests to verify the equinox configuration.

In particular, I want to verify that

*   the service components bind together as expected
*   the bundles are activated
*   ~~the plugins share information as expected~~ (see **Edit 2**)

Furthermore, I want to make this integration testing a part of my continuous integration process using an Eclipse PDE headless build (as described [here](http://www.eclipse.org/articles/Article-PDE-Automation/automation.html) and [here](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.test/testframework.html?view=co)).

**My question is**: Can you recommend any frameworks, tools, or practices that will facilitate this type of integration testing within the constraints I've identified?

I've found two leads so far:

*   [Spring Dynamic Modules](http://www.springsource.org/osgi) includes a framework for OSGi integration testing. However, I haven't been able to get a simple Spring DM test to run within Eclipse. It complains that "the platform is already running".
*   [Pax Exam](http://wiki.ops4j.org/display/ops4j/Pax+Exam) (formerly Pax Drone) is another OSGi integration testing framework.

**Edit**: To clarify, each plugin has an OSGi service component configured with a component definition xml file. A mistake in one of these configuration files will not break any plugin dependencies and could easily go unnoticed until runtime. Integration testing is necessary to detect such failure.

**Edit 2**: So far every thing I've seen seems to confirm Uri's assertion (see below) that multi-plugin Eclipse features aren't integration-tested at the feature/product level. I'm willing to go without comprehensive integration tests if I can at least automatically verify that the service components bind together correctly.

My approach (not working yet):

```
 In a JUnit test do
   For each bundle/plugin of interest
      Get the osgi Bundle object with org.eclipse.core.runtime.Platform.getBundle()
      Verify that the Bundle is active with Bundle.getState()
      Verify that the Bundle is using the expected services with Bundle.getServicesInUse()
      Verify that the Bundle has registered the expected services with Bundle.getRegisteredServices() 

```

I'm running my code with an Eclipse Plug-in Test launch configuration, launching my Eclipse product as the "Program to Run". When the tests run, I can verify that the bundles are active but the service components do not get activated and the getServicesInUse and getRegisteredServices methods return null. I loaded a class from each bundle in case it was a lazy-activation issue, but that didn't help. I also verified that all the service components are "immediate" components, so they should be activated as soon as their bundle's are activated. **Why isn't Equinox DS doing its magic?**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T05:27:17.377

我们基于以下几种方法编写了自己的小测试执行框架：a）rcp bundletestcollector（[http://rcpquickstart.com/2008/06/12/running-unit-tests-for-rcp-and-osgi-applications /](http://rcpquickstart.com/2008/06/12/running-unit-tests-for-rcp-and-osgi-applications/) ) 这是由 Pascal Rapidcault 编写的，他是 RCP 的主要成员之一。它从正在运行的 OSGi 环境中的包中收集测试类。

b) knopflerfish 测试框架 ( [http://knopflerfish.org/releases/2.1.1/knopflerfish_osgi_tests_2.1.1.zip](http://knopflerfish.org/releases/2.1.1/knopflerfish_osgi_tests_2.1.1.zip) ) 将测试用例注册为可由测试运行器执行的服务。还有一个 XML 输出，遗憾的是它与 ant junit XML 格式有点不同。

通过这种方式，我们可以在单独的测试包中执行集成测试，也可以执行更接近经典单元测试并以片段形式存在于被测包中的测试（参见[http://rcpquickstart.com/2007/06/20/unit- testing-plug-ins-with-fragments/](http://rcpquickstart.com/2007/06/20/unit-testing-plug-ins-with-fragments/)）。

# c# - Does .NET JIT optimize empty loops away?

> ID：539047
> 
> 赞同：2
> 
> 时间：2009-02-11T22:02:46.810
> 
> 标签：c#, .net, performance, jit

[This article](http://www.javaperformancetuning.com/news/qotm028.shtml) suggests otherwise. But there is still a need to evaluate the loop condition. Does java just employ a specific trick to recognize this case?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:19:05.460

Check out the [follow-up story](http://www.javaperformancetuning.com/news/qotm029.shtml) to the article you quote.

NOTE to people answering: It appears the OP is asking about the .NET JIT, not the Java JIT, since the article referenced suggested that Java did a better job of (or that only Java did) optimizing away empty loops.

EDIT: Googling for more answers, Jon Skeet's name keeps coming up. See, for example, [this thread on C# optimizations](http://bytes.com/groups/net-c/234175-c-optimization). Thus, when he answers, we'll have the authoritative answer! :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T22:28:52.567

Yes it will.

[http://www.javaspecialists.eu/archive/Issue158.html](http://www.javaspecialists.eu/archive/Issue158.html)

At least in Java 5 and 6\. The article you linked to is about an older VM.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:33:21.557

The article is from 2003\. CLI (and java VMs) have advanced a lot since then. In general you have to be very cautious whenever doing micro benchmarks. It is real easy to end up measuring jit performance, compiler efficiency at removing dead code, timing overhead, garbage collection, and so on.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T21:40:16.543

Java 并不总是优化空循环的方式。在这种情况下，计算 4 个 BN 数字需要 2.966 秒。

```
long start = System.nanoTime();
for (int i = Integer.MIN_VALUE; i < Integer.MAX_VALUE; i++);
long time = System.nanoTime() - start;
System.out.printf("Took %.3f seconds to empty loop.%n", time * 1e-9); 
```

印刷

```
Took 2.966 seconds to empty loop. 
```

这是使用 Java 6u11，也许 6u14 会更聪明。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-11T22:17:21.707

In general, try to write your code as simply as you can, so the JVM can make good guesses as to what you're trying to do.

# c++ - 在 Windows 中自动播放安装 CD 时如何显示图标

> ID：539058
> 
> 赞同：0
> 
> 时间：2009-02-11T22:07:06.753
> 
> 标签：c++, cd, autoplay

我有一张安装 CD 来安装我制作的 Visual Studio C++ 应用程序。它包含三个文件：setup.exe、AUTORUN.INF 和 app.msi。当我插入 CD 时，Windows 自动播放弹出窗口会显示一个通用图标。如何为 setup.exe 显示我自己的图标。插入CD后，我也希望驱动器图标使用此图标，我认为它们是相关的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T22:20:01.573

我讨厌自动启动。

在 AUTORUN.INF 中，您可以指定安装程序旁边的驱动器图标：

```
[AutoRun]
open=setup.exe
icon=*youricon*.ico 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T22:21:16.330

在 AUTORUN.INF 的 [autorun] 部分中，添加如下行：

```
icon=filename.ext 
```

我相信该文件可以是图像文件或可执行文件，在这种情况下它将使用第一个图标资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T22:21:43.973

您可以在 autorun.inf 中指定一个图标文件

```
icon=whatever.ico 
```

我认为您还可以通过将程序/dll名称然后是逗号和（我认为）图标编号来指定程序中嵌入的图标。

```
icon=whatever.dll,5 
```

# mercurial - 您使用新的“hg rebase”命令有何经验？

> ID：539062
> 
> 赞同：10
> 
> 时间：2009-02-11T22:08:16.360
> 
> 标签：mercurial

到目前为止，“hg rebase”如何对待你？你有没有发现任何错误或陷阱？在什么情况下它会替代或补充 mq？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-01T00:10:18.023

在简单的情况下，Rebase 非常好（没有或很少的合并冲突），但如果你有很多它们，与常规的合并 + 提交相比，它可能会更麻烦：

Rebase 会更改您的提交并更改历史记录，并且默认情况下会删除您的原始提交。如果它们在糟糕的时刻击中您，这会产生许多影响：

*   没有办法看到你是如何解决冲突的。（即原始提交和变基之间的差异，除非您选择保留它们并在推送之前手动剥离它们）
*   没有办法测试每个重新合并的修订版都可以，在提交之前编译和运行都可以。你变基，你的提交改变。（与上述相同的例外）
*   如果你真的在做分布式的东西并从许多来源共享/拉取，你必须非常小心，不要共享任何你打算变基的提交。
*   此外，如果在上述情况下，您意外地变基然后从某人那里拉出这些 pre-rebase-commits，您会得到一组双重提交，并且需要“hg 剥离”其中一组。（我没有尝试在这里合并。）

问题是变基编辑历史。这就是 SVN 在“更新”上所做的。所以，这绝对是你可以使用的东西，但如果你有很多未完成的提交并且预计会有很多冲突，我建议改为合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T04:08:33.507

相对于 MQ（Mercurial Queues）的最大优势在于，当您将排队的补丁推送到更改的基础层时，您最终会得到 .rej 文件并且必须手动修复补丁。使用 rebase，您将获得一个合并，并启动您的标准合并解决方案工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-25T14:06:14.147

我看到指向重新设置分支的标签存在问题。

> .hgtags@XXXXXXXXXXXX，第 2 行：标签 'XXX' 指代未知节点

似乎标签没有正确转换。

# visual-studio-2008 - 网站项目与 Web 应用程序 - 哪个更好？

> ID：539063
> 
> 赞同：9
> 
> 时间：2009-02-11T22:09:00.040
> 
> 标签：visual-studio-2008, web, web-applications, n2

我刚刚开始使用一个 cms (N2)，它有一个使用 vs2008 中的网站项目模板的模板基本实现。我注意到，在编译它时，它比使用我更习惯的 Web 应用程序项目花费的时间要长得多。

我的问题是：

1.  为什么编译似乎需要更长的时间？
2.  哪个更好用？
3.  我应该将其转换为 Web 应用程序吗？

如果这是重复的，我深表歉意，但我找不到类似的问题。

干杯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T22:20:51.947

主要区别在于**：**

在*Web 应用程序项目*中，所有内容都经过预编译，所有代码隐藏页面都将被编译为 .dll ---- 在*网站项目* 中，项目中没有任何内容是预编译的，编译器将编译所有内容以确保其有效但没有任何已编译的页面被上传。当用户第一次尝试访问该站点时，每个页面都会被编译成自己的 dll。这意味着在*网站项目*中，您可以上传单个代码隐藏文件。

命名空间 - 在*Web 应用程序项目*中，默认情况下会在*网站项目*中创建命名空间，但它们不是。

项目文件 -*网站项目*没有*Web 应用程序项目*所具有的“cproj”文件。

[转换为*Web 应用程序项目*](http://webproject.scottgu.com/CSharp/Migration2/Migration2.aspx)可能比您想象的要困难得多，尤其是如果您严重依赖 appcode 文件夹。

我个人更喜欢*Web 应用程序项目*，我发现它们更易于使用且部署起来不那么烦人。我个人只会在非常小而简单的事情上使用网站项目。

[来自MSDN](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)的额外阅读

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T15:09:37.497

除了 Chris 提供的信息之外，您还应该注意，对于 Web 应用程序项目，配置文件不是开箱即用的：

[http://www.codersbarn.com/post/2008/06/01/ASPNET-Web-Site-versus-Web-Application-Project.aspx](http://www.codersbarn.com/post/2008/06/01/ASPNET-Web-Site-versus-Web-Application-Project.aspx)

这里有一个解决方法：http: [//code.msdn.microsoft.com/WebProfileBuilder](http://code.msdn.microsoft.com/WebProfileBuilder)

基本上，Web 应用程序项目不会像网站项目那样将 Profile 对象自动添加到每个页面，因此我们无法获得对 web.config 文件中定义的配置文件属性的强类型编程访问。

安东尼:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-15T11:57:38.157

我的偏好是在 Web 应用程序上使用网站项目。我主要依靠“在浏览器中查看”在开发过程中执行页面，而不是 f5。我可以在不关闭运行时浏览器的情况下保持浏览器窗口打开并修改代码。通常，如果我需要调试，我会将 IDE 附加到适当的进程。以我的经验，这样做比每次我必须编译或进行更改时都编译并重新启动应用程序更有效。如果应用程序有登录页面，这一点会更加放大。每次按下 F5 时都无需登录——当然有办法进行设置。但偏好不是。

# python - 返回要馈送到 string.format() 的参数元组

> ID：539066
> 
> 赞同：36
> 
> 时间：2009-02-11T22:10:10.287
> 
> 标签：python, string-formatting, tuples

目前，我正在尝试在 Python 中获取一个方法来返回零、一个或两个字符串的列表以插入字符串格式化程序，然后将它们传递给字符串方法。我的代码看起来像这样：

```
class PairEvaluator(HandEvaluator):
  def returnArbitrary(self):
    return ('ace', 'king')

pe = PairEvaluator()
cards = pe.returnArbitrary()
print('Two pair, {0}s and {1}s'.format(cards)) 
```

当我尝试运行此代码时，编译器会给出 IndexError: tuple index out of range。
我应该如何构造我的返回值以将其作为参数传递给`.format()`？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-02-11T22:20:47.640

```
print('Two pair, {0}s and {1}s'.format(*cards)) 
```

你只缺少星星：D

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T10:29:51.203

格式优先于 % 运算符，因为它在 Python 2.6 中的介绍：http: [//docs.python.org/2/library/stdtypes.html#str.format](http://docs.python.org/2/library/stdtypes.html#str.format)

只需使用 * 解压缩元组 - 或使用 ** 解压缩 dict - 而不是修改格式字符串也简单得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T22:20:26.160

这试图使用“卡片”作为单一格式输入来打印，而不是卡片的内容。

尝试类似：

```
print('Two pair, %ss and %ss' % cards) 
```

# sql-server - 如何以编程方式在 SQL Server 中克隆数据库架构？

> ID：539067
> 
> 赞同：2
> 
> 时间：2009-02-11T22:11:03.360
> 
> 标签：sql-server

我想对我的项目进行一些可靠的测试，我想这样做的方式是有一个我可以运行的命令行程序，它将只复制数据库的结构而不是实际数据。然后我可以在那个新数据库上运行我的测试。

想法？

更新：有人说我应该指定一种语言。如果 Sql Server 运行，我认为 TSQL 就是这样，脚本应该运行。此外，它是 SQL Server 2005。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:53:41.557

如果您在 2005 年查看 DMO - 数据库管理对象，您不会说您使用的是哪个版本的 SQL Server，这是一组 COM 库，可让您访问 Enterprise Manager/Management Studio 中的功能。

对于 2008 年，我们有 SMO 类似的功能，但作为 .Net 程序集，MS 有一些[很好的代码示例](http://msdn.microsoft.com/en-us/library/ms162175.aspx)。他们的脚本示例看起来像您需要的那样：-

从他们的网站上取下来，我们有

```
//Connect to the local, default instance of SQL Server. 
{ 
   Server srv = default(Server); 
   srv = new Server(); 
   //Reference the AdventureWorks database. 
   Database db = default(Database); 
   db = srv.Databases("AdventureWorks"); 

   //Define a Scripter object and set the required scripting options. 
   Scripter scrp = default(Scripter); 
   scrp = new Scripter(srv); 
   scrp.Options.ScriptDrops = false; 
   scrp.Options.WithDependencies = true; 

   //Iterate through the tables in database and script each one. Display the script. 
   //Note that the StringCollection type needs the System.Collections.Specialized namespace to be included. 
   Table tb = default(Table); 
   Urn[] smoObjects = new Urn[2]; 
   foreach ( tb in db.Tables) { 
      smoObjects = new Urn[1]; 
      smoObjects(0) = tb.Urn; 
      if (tb.IsSystemObject == false) { 
         StringCollection sc = default(StringCollection); 
         sc = scrp.Script(smoObjects); 
         string st = null; 
         foreach ( st in sc) { 
            Console.WriteLine(st); 
         } 
      } 
   } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T22:18:47.567

您可以使用以下方法 [http://fahadaz.blogspot.com/2008/10/database-scripts-and-contiguous.html](http://fahadaz.blogspot.com/2008/10/database-scripts-and-contiguous.html)但它需要您的数据库创建脚本。

如果你没有这些，你可以使用下面的文章来生成它们 [http://blog.sqlauthority.com/2007/08/21/sql-server-2005-create-script-to-copy-database-schema-和所有对象存储过程函数触发器表视图约束和所有其他数据库对象/](http://blog.sqlauthority.com/2007/08/21/sql-server-2005-create-script-to-copy-database-schema-and-all-the-objects-stored-procedure-functions-triggers-tables-views-constraints-and-all-other-database-objects/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:26:33.333

如果您想要一份完整的副本，其他答案效果很好，但这是您可能会感兴趣的另一种方法。如果您使用的是 LINQ to SQL，您可以创建一个 DBML 文件，然后在您的数据上下文中使用 CreateDatabase() 方法。它不会复制整个模式（省略一些约束、UDF、Procs 等），但在您可能希望对表进行操作并可能对数据库测试进行分区的场景中很有用。

这里有几个步骤：

1.  创建 Windows 窗体应用程序

2.  创建一个名为 Foo 的 DBML 文件（LINQ to SQL 类）

3.  将您感兴趣的表格/对象拖到设计图面上

4.  关闭/保存

5.  在您的应用程序的某个地方，您可以编写如下代码：

    FooDataContext fooData = new FooDataContext(@"连接字符串到新数据库");

    fooData.CreateDatabase();

[这](http://msdn.microsoft.com/en-us/library/bb399420.aspx)是我上面描述的方法的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-13T20:27:40.787

可悲的是，我们发现的最自动化的过程实际上是使用其中一种鼠标控制工具来实际使用 SSMS 来复制数据库。我宁愿做其他事情，但没有一个答案真正符合我们的要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-17T16:45:41.053

可以以编程方式执行您要求的操作。这些是步骤：

1.  测试您的“source_test”数据库是否存在，如果存在，请将其删除。
2.  连接到您的源数据库，
3.  创建源数据库的备份
4.  将源数据库还原到“source_test”数据库，同时重命名实际的数据库文件
5.  执行 SQL Server 实用程序存储过程，`exec sp_msforeachtable 'truncate table ?'`

这将为您的“源”数据库创建一个示意性相同的数据库，名为“source_test”。保留所有触发器、约束、存储过程、SQL Server 帐户以及不是数据表内容或序列号的所有其他数据位。当它们的表被截断时，所有的序列号将被重置为默认值。

我们使用这 5 个步骤来克隆我们自己的 SQL Server 数据库以进行测试和其他用途。这适用于 SQL Server 2000 向前。

要备份数据库，请以以下形式执行 SQL 语句：

```
"Backup database " + kstrDbName + " to disk = '" + strFullyPathedBackupFile + "' With Init"; 
```

“With Init”是一个关键选项，它告诉 SQL Server 覆盖指定的文件（如果存在）。通过查找“备份数据库”的 SQL Server 文档可以找到更多信息。

在 SQL Server 2005 和更新版本上，您可以使用 SMO 恢复数据库，并指定数据库的新名称，以及重命名数据库文件（mdf 和日志文件）。有关如何执行此操作的示例代码，请参阅有关还原功能的 Microsoft SQL Server SMO 文档。

在 SQL Server 2000 上，没有 SMO 支持，因此必须通过执行 SQL 语句手动完成。这采用类似于以下形式的语句：

```
 string strSQL = "Restore database " + strDatabaseName + "from disk = '" + strSourcePathFile + "' with replace, " +
            " Move '" + strDatabaseName + "_Data' to '" + strDestinationPathFile + ".MDF', " +
            " Move '" + strDatabaseName + "_Log' to '" + strDestinationPathFile + ".LOG' " 
```

然后使用 Alter 语句重命名实际的 MDF 和 LOG 文件以匹配新名称。是的，这意味着在 SQL Server 2000 上，您不能拥有源数据库和目标数据库。对不起。可能可以在还原的同时重命名 MDF 和 LOG 文件，但如果是这样，我的团队无法让它工作。我们已经转移到新的 SQL Server 数据库，但我想我会为了这个答案的完整性而提取旧代码。

alter 语句的形式为：

```
 string AlterDbSQL = " Alter database " + strDatabaseName + " MODIFY FILE(NAME = " + Path.GetFileNameWithoutExtension( strDestinationPathFile ) + "_DATA, NEWNAME = " + strDatabaseName + "_Data) " +
                        " Alter database " + strDatabaseName + " MODIFY FILE(NAME = " + Path.GetFileNameWithoutExtension( strDestinationPathFile ) + "_LOG, NEWNAME = " + strDatabaseName + "_LOG) " 
```

一些注意事项：如果您感兴趣的只是创建一个测试数据库，那么您不需要每次都执行第 2 步（连接到源）和第 3 步（创建备份）。只需创建一个备份，还原它，然后截断表，即可为您要测试的当前数据库创建一个“模板”备份。备份该数据库。现在您已经备份了数据库的数据内容清除版本。这将是一个较小的备份，因此复制速度更快，恢复速度也更快。您需要做的就是添加您的测试数据并准备好进行测试。

# c# - C# 循环限制为 50 次传递

> ID：539075
> 
> 赞同：2
> 
> 时间：2009-02-11T22:14:14.270
> 
> 标签：c#, loops

如何将下面的循环限制为 50，以便在到达第 51 项时停止？

```
foreach (ListViewItem lvi in listView.Items)
{

} 
```

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-11T22:30:51.500

轻松使用 Linq

```
foreach (ListViewItem lvi in listView.Items.Take(50)) {

} 
```

从 MSDN 文档：

> Take<(Of <(TSource>)>) 枚举 source 并产生元素，直到产生 count 个元素或 source 不再包含元素。
> 
> 如果 count 小于或等于 0，则不枚举 source 并返回一个空的 IEnumerable<(Of <(T>)>)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-11T22:18:05.137

好吧，foreach 可能不是最好的解决方案，但如果你必须：

```
int ctr = 0;
foreach (ListViewItem lvi in listView.Items) {
    ctr++;
    if (ctr == 50) break;

    // do code here

} 
```

**注意：for 循环通常比使用 foreach 遍历集合要轻。**

最好使用 for 循环：

```
// loop through collection to a max of 50 or the number of items
for(int i = 0; i < listView.Items.Count && i < 50; i++){
    listView.Items[i]; //access the current item

} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-11T22:16:49.273

```
foreach (ListViewItem lvi in listView.Items) {
  // do code here
  if (listView.Items.IndexOf(lvi) == 49)
    break;
} 
```

或者因为它是一个列表视图项

```
foreach (ListViewItem lvi in listView.Items) {
  // do code here
  if (lvi.Index == 49) break;
} 
```

[根据LukeDuff](https://stackoverflow.com/questions/539075/c-loop-limited-to-50-passes/539152#539152)使用 Linq

```
foreach (ListViewItem lvi in listView.Items.Take(50)) {
  // do code here
} 
```

[根据Atomiton](https://stackoverflow.com/questions/539075/c-loop-limited-to-50-passes/539089#539089)使用 For 循环

```
// loop through collection to a max of 50 or the number of items
for(int i = 0; i < listView.Items.Count && i < 50; i++){
    listView.Items[i]; //access the current item

} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-11T22:16:40.037

使用 for 循环。

```
for(int index = 0; index < collection.Count && index < 50; index++)
{
   collection[index];
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-11T22:20:37.563

```
for(int index = 0, limit = Math.Min(50, collection.Count); index < limit; index++)
{
   collection[index];
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T22:18:27.430

如果您仍想使用 foreach 循环，请尝试以下操作：

```
int counter = 0;
foreach (ListViewItem lvi in listView.Items) 
{
  counter++;
  if ( counter == 50 )
  {
   break;
  }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T22:22:08.637

```
for (int i = 0; i < 50 && i < listView.Items.Count; ++i)
{
    ListViewItem item = listView.Items[i];
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-11T22:18:55.790

我会按照查尔斯的建议使用 for 循环，而不是使用带有索引检查的 foreach。当您需要跟踪当前迭代时，使用 for 循环的意图更加明显。

```
for (int i = 0; i < listView.Items.Count && i < 50; ++i)
{
    //do something with listView.Items[i]
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-11T22:19:18.707

```
int i = 50;
foreach(T t in TList)
{
   if(i-- <= 0) break;

   code;

   // or: i--; if(i<=0) break;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-11T22:35:50.990

for 循环将起作用，但您仍然可以像这样设置一个名为 lvi 的 ListViewItem。

```
int maxItems = listViewItems.Count > 50 ? 50 : listViewItems.Count;
for(int counter = 0; counter < maxItems; counter ++)
{ 
    ListViewItem lvi = listView.Items[counter];

    // Rest of your code here will stile work

} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-11T22:37:33.403

使用 LINQ，这可以实现为：

```
foreach (ListViewItem lvi in listView.Items.Take(50))
{
  // do stuff
} 
```

Take(n) 返回前 n 个元素，如果可用的少于 n 个，则返回所有元素。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-11T22:25:26.227

人们已经给出了很多例子，在这个特定的例子中，由于 ListView.Items 是一个索引集合，一个老式的 for 循环可能是最好的。如果它是类似 IEnumerable 的东西，您不能使用 Items[i] 那么您必须像其他示例一样使用外部计数器变量。

# java - 不断更新 GUI 元素的最佳方法

> ID：539076
> 
> 赞同：0
> 
> 时间：2009-02-11T22:14:19.233
> 
> 标签：java, multithreading, user-interface, performance

我有一个具有许多文本字段的 Java GUI，其值是从另一个类中的静态变量填充的。

我很想知道最好的方法是什么，以便在另一个类中更改变量时，更新会立即反映在 GUI 上。

如果有人可以就有效的方法提出建议，将不胜感激。

非常感谢您提前回复

编辑：

额外细节

*   使用摇摆
*   理想情况下，更新将是实时的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:25:44.383

[在我看来，一个明智的选择是按照观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)来实现它。你可以找到很多关于这个主题的[例子](http://www.javaworld.com/javaworld/javaqa/2001-05/04-qa-0525-observer.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:23:56.870

您没有提及您使用的是什么工具包以及您的项目的架构是什么。

也不清楚您希望更新 GUI 元素的速度和频率，因为闪烁器的成本可能太大，使用监听机制的通知成本也可能如此。

如果确定更改相当简单，并且如果我不需要实时性能而只需要向用户提供一些反馈，那么我很高兴运行一个后台线程，该线程偶尔会在必要时进行检查和更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:25:17.163

最简单的方法是首先控制对该静态变量的所有访问。使其私有化，并且只能通过某种单一方法进行修改。其次，让该方法调用`setText()`所有这些文本字段，并将它们设置为新值。

如果可以在 Event Dispatch Thread 之外更改该变量的值，则*必须*使用该方法`SwingUtilities.invokeLater()`设置这些文本字段；组件只能由 EDT 访问。

如果每个文本字段的显示是由多个分散的方法计算的，那么您的变量设置方法只需要调用这些方法（可能`invokeLater()`如上所述包装）。

如果变量修改代码事先不知道哪些文本字段会受到影响，那么您需要允许控制每个文本字段的对象将自己作为侦听器添加到修改代码中。（这是 MVC 设计，通常被认为是好的。）然后修改代码调用其列表中的每个侦听器并让它知道值已更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T00:03:57.503

使用侦听器的观察者/可观察者。这里有一个实例变量：

```
public class StaticVarClass {
    public static interface Listener {
        public void varChanged(Object oldVar, Object newVar);
    }

    private Object var;

    private List<Listener> listeners = new CopyOnWriteArrayList<Listener>();

    public void addListener(Listener l) { listeners.add(l); }
    public void removeListener(Listener l) { listeners.remove(l); }

    protected void fireVarChanged(Object oldVar, Object newVar) {
        for (listener : listeners) listener.varChanged(oldVar, newVar);
    }

    public void setVar(Object newVar) {
        fireVarChanged(var, var = newVar);
    } 
```

当然你也可以使用内置`PropertyChangeListener`机制。

# nhibernate - NHibernate - 将 ID 映射到 DB2 身份

> ID：539078
> 
> 赞同：1
> 
> 时间：2009-02-11T22:14:30.310
> 
> 标签：nhibernate, nhibernate-mapping, db2, ibm-midrange

我对 NHibernate 很陌生，并且正在尝试通过 ISeries 提供程序连接到 DB2 表。该表有一个作为身份自动生成的 BIGINT 主键。我在映射文件中为 id 的生成器属性尝试了几个值，但都没有成功。表 def 如下所示（字段名称已更改）：

```
CREATE TABLE SCHEMA/TABLE (
    PKID BIGINT GENERATED ALWAYS AS IDENTITY (
        START WITH 1 INCREMENT BY 1
        NO MINVALUE NO MAXVALUE
        NO CYCLE NO ORDER
        CACHE 20)
    ,
    SOMESTRING VARCHAR(50) CCSID 37 DEFAULT NULL,
    FIRSTFK BIGINT NOT NULL,
    SECONDFK BIGINT DEFAULT NULL,
    ANOTHERSTRING VARCHAR(100) CCSID 37 DEFAULT NULL,
    CONSTRAINT NISDEV/PK_TABLE PRIMARY KEY (PKID)); 
```

映射文件如下所示：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Project.Domain.Thing, Project" table="TABLE">
    <id name="ID" column="PKID" type="Int64">
      <generator class="**???????**" />
    </id>
    <property name="SomeString" column="SOMESTRING" />
    <property name="FirstFK" column="FIRSTFK"/>
    <property name="SecondFK" column="SECONDFK"/>
    <property name="AnotherString" column="ANOTHERSTRING"/>
  </class>
</hibernate-mapping> 
```

起初，我将生成器类设置为“native”，根据[文档](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#mapping-declaration-id-generator)，它为 DB2 选择“identity”。使用“本机”或“身份”，当我将生成器类更改为各种其他值时，我得到“PKID 列中不允许空值”以及各种其他错误。

我确定文档中缺少一些小东西，但是有什么方法可以让 NHibernate 获取主键的下一个值，它是 DB2 中的 GENERATED IDENTITY 并在我调用时为我处理它节省（）？我是否需要在 NHibernate 可以用来获取下一个值的地方写一个选择？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T16:09:32.970

我想通了，所以如果将来有人在做这种事情并遇到同样的问题，那就是它。

我正在使用[NHibernate FAQ](http://web.archive.org/web/20090805054123/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/04/01/your-first-nhibernate-based-application.aspx)中的教程并将其改编为 ISeries。跟随它到 T，我忽略了跳过实际创建模式的部分。我已经在 ISeries DB2 环境中创建了所有表，所以我不应该为我的测试运行这样做：

```
<NUnit.Framework.SetUp()> _
Public Sub SetupContext()
     Dim schemaExport As New NHibernate.Tool.hbm2ddl.SchemaExport(_configuration)
     schemaExport.Execute(False, True, False, False)
End Sub 
```

特别是因为我为 ID 字段设置了错误的映射文件，生成器类为“已分配”。一旦我查看了我的表定义并意识到 NHibernate 在调用 SchemaExport.Execute() 时覆盖了主键字段 PKID 的 GENERATED IDENTITY 属性，我只需使用正确的属性重新创建表，将生成器类更改为“身份， " 删除了 SchemaExport 调用，现在一切正常。

# c# - 在 ac# 构造函数中强制显式初始化成员

> ID：539079
> 
> 赞同：3
> 
> 时间：2009-02-11T22:14:49.420
> 
> 标签：c#, constructor

*如果每个构造函数都没有初始化给定的成员，有没有办法导致错误？*也许有 const 的东西？

我想要这个，因为我有一堆代码，由于不正确地计算成员值而导致错误。我真正想做的是去掉整个混乱并在重做时遵循编译器的引导（编写使用最终结果的代码，修复使用不存在代码的错误，修复错误等）。这不起作用的一个步骤是成员变量，因为我不必像在局部变量中那样在构造函数中初始化它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:19:26.350

不幸的是，C# 没有提供这样的内置谓词。您可以做的最好的事情是编写一个方法来检查有问题的对象是否为空值或某些预先确定的标志值，并在每个构造函数的末尾和/或在引用该对象的每个方法的顶部调用它时遵守纪律.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:26:54.193

支持。例如：

```
 class Test {
    int notAssigned;
    void method() {
      // Use it, but don't initialize it
      int ix = notAssigned;
    }
  } 
```

产生：

警告 CS0649：字段“ConsoleApplication1.Test.notAssigned”从未分配给，并且始终具有其默认值 0

要将其变为错误，请使用 Project + Properties，Build 选项卡，将警告视为错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T22:54:28.183

我认为没有办法让编译器抱怨未初始化的成员，前提是该成员至少在一种情况下被初始化。但是，如果您对所有值都有明确的默认值，则可以使用默认构造函数来确保所有成员都初始化为其默认值，并从所有重载的构造函数继承默认构造函数。

```
public class Foo
{
   private int val1;
   private List<int> list;

   public Foo()
   {
      //could also be a private constructor if that's appropriate
      //all default initialization
      val1 = 1;
      list = new List<int>();
   }

   public Foo(int nonDefaultValue1) : this()
   {
      //set inputted value
      val1 = nonDefaultValue1;
      //no need to initialize list, done by default constructor
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T23:04:03.340

听起来[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)可以帮助
你当然必须建立你的自定义规则

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T22:37:40.173

提示：在 Visual Studio 中，学习使用 Shift + F12（查找所有参考资料）。找到对那些改变状态的引用非常方便。

# perl - 如何在不重新启动的情况下调试 mod_perl2 模块？

> ID：539087
> 
> 赞同：3
> 
> 时间：2009-02-11T22:17:04.233
> 
> 标签：perl, apache2, perl-module, httpd.conf, mod-perl2

环境：Apache/2.2.11 (Win32) mod_apreq2-20051231/2.6.2-dev mod_perl/2.0.4-dev Perl/v5.10.0

[情况与此讨论列表帖子](http://www.gossamer-threads.com/lists/modperl/modperl/98854)中描述的情况非常相似，除了在 win32 上。

我在 httpd.conf 中有这个：

```
PerlModule Apache2::Reload
PerlInitHandler Apache2::Reload
PerlSetVar ReloadAll Off
PerlSetVar ReloadModules "MyPackage::*" 
```

...以及只有 mod-perl 脚本处理。

我有一个使用 MyPackage 模块的脚本，它正在工作。

我破坏了模块，然后重新加载脚本。这个错误很有帮助，告诉我在哪里破坏了模块。

（如果此时我再次重新加载，它只告诉我“未定义的子例程 &ModPerl::ROOT::ModPerl::Registry...”，因为它第一次无法加载文件。但无论哪种方式如下行为仍然发生。）

我恢复了中断，并触摸了脚本文件，这样它就会重新加载模块，然后重新加载。现在它说：

```
Attempt to reload MyPackage/Foo.pm aborted.
Compilation failed in require at E:/dev/test.pl line 4. 
```

即使我触摸了脚本和模块，我也无法正确地重新加载它，除非重新启动 Web 服务器。

仅破坏脚本本身（而不是模块）可以正常工作：适当的错误并将其改回会导致它在重新加载时再次工作。

在完成这些事情之后，我在测试之前重新启动了 Web 服务器：

1.  我尝试进行跟踪，但它继续出错的行是 ModPerl/RegistryCooker.pm 第 204 行，这只是 eval{} 整个脚本的行。

2.  我尝试在脚本和模块中将“使用警告 FATAL => 'all'”更改为“使用警告”。没有什么不同。

3.  我试过禁用我的自定义 $SIG{__DIE__} 功能。没有什么不同。（好吧，当然，只是在出现错误的地方，但产生的错误是一样的。）

4.  根据开头的讨论链接，发现 MaxRequestsPerChild 一直为 0，我尝试了 ThreadsPerChild 1，但没有区别。我尝试将 MaxRequestsPerChild 设置为 1，这解决了这个问题的奇怪行为，但在每次请求后重新启动 Web 服务器：

    ```
    Child 7072: Process exiting because it reached MaxRequestsPerChild. Signaling the parent to restart a new child process.
    Parent: Received restart signal -- Restarting the server. 
    ```

    这不是一个好的解决方案，因为我有大量代码在第一次点击页面时运行。

5.  同样根据讨论，我将 httpd 作为服务运行，所以我在服务参数窗口中添加了 -X 并点击开始，它仍然试图在整整三分钟后启动（通常在 3 秒内启动。）甚至超时信息。通过任务管理器终止进程并验证我无法从 Web 浏览器访问该页面。从命令行启动 httpd -X。仍然与此问题顶部的行为相同。我还发现运行 httpd -? 时没有列出 -X 很奇怪。也许它在 win32 MPM 上不可用？

6.  在该线程中，大卫指出：

    > 我对此类问题进行故障排除的经验表明，被卸载的包可能删除了存储在重新加载的模块的包空间中的值（可能在 BEGIN 块时间设置），随后的要求没有恢复。

    但这不适用于我的代码。我介绍的“破坏脚本”错误只是在已经存在的行之上添加了一个额外的“我的 $var”行，这样第二个就会抱怨它已经被声明了。

在每次重新加载后（无论是自动，通过 MaxRequestsPerChild，还是像以前一样手动）都没有重新启动 Web 服务器，就没有办法处理 mod_perl2 模块吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T20:25:48.400

将 sub 复制到您从中调用它的脚本中，并将此代码放在副本之前：

```
package MyPackage::Foo;
no warnings 'redefine'; 
```

完成更改后，将 sub 移回实际模块。

# version-control - StarTeam 视图/分支方法

> ID：539110
> 
> 赞同：3
> 
> 时间：2009-02-11T22:21:20.417
> 
> 标签：version-control, starteam

我们正在寻找有关 StarTeam 配置的一些建议。我们有一个项目被两个主要客户使用。我们共享一个共同的代码库，但我们希望能够一次为一个客户进行开发。有谁知道使用 StarTeam 的最佳方法是什么？

我想你会想做这样的事情：

```
->Main branch (1.0)
-->Cust #1 Release (1.1)
-->Cust #2 Release (1.2) 
```

当 1.1 完成后，您可以将此代码合并到 2.0 中。与 1.2 相同。然后您将创建 2.1 或 2.2。

这有意义吗？只是寻找一些适用于我们的场景并且可以轻松与 StarTeam 一起使用的常识配置管理解决方案。

谢谢。

**更新**：我找到了一个 ST[最佳实践指南](http://dn.codegear.com/article/images/31869/StarTeam_Configuration_Best_Practices.pdf)，其中包含有关此问题的有用信息（请参阅第 5 章）。这些建议与 Craig 的 ST 用法一致（见下文）。请注意，本指南于 2003 年 12 月发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T22:31:18.193

你可能不想听到这个，但没有最好的方法。话虽如此，我会告诉你我们做什么。

我们在默认视图中进行几乎所有的开发。当我们即将发布产品的一个版本并开始着手开发下一个版本时，只要发生这种情况，我们就会为要发布的版本制作派生视图。派生视图设置为在更改时分支。

我们继续在默认视图中开发要发布的版本和下一个版本。当需要在要发布的版本中包含错误修复或功能时，有两种可能性：

1.  该文件中唯一改变的是我们希望在要发布的版本和下一个版本中的错误修复或功能。
2.  对文件进行了一些更改，这些更改打算包含在下一个版本中，但不会包含在要发布的版本中。

在 (1) 的情况下，我们进入派生视图，右键单击文件，选择 Advanced->Behavior，然后更改配置，使文件包含我们刚刚所做的更改。在 (2) 的情况下，我们将文件检入默认视图（以便将更改包含在下一个版本中）和派生视图（以便将更改包含在要发布的版本中，并且，当然，只包括这些更改），导致它分支。

**需要明确的是，**我们几乎所有的工作都是在默认视图中完成的。我们很少需要手动分支或更改派生视图中的文件配置，因为在非常接近发布之前我们根本不会创建派生视图。

这与您建议为客户做的事情并不太远，但重要的一点是在默认视图中工作，避免不得不向上或向下批量合并到派生视图中。StarTeam 的视图比较/合并工具并不是那么好。（我们使用的是 2005 年；从那时起它可能有所改进。）

# sharepoint - Moss 2007 Re-Ghost 内容类型

> ID：539113
> 
> 赞同：1
> 
> 时间：2009-02-11T22:21:57.810
> 
> 标签：sharepoint, sharepoint-2007, content-type, moss

比如说我有内容类型 XXX。由于某种原因，它已在列表 A 上取消托管。我们已更改功能中的内容类型并重新部署，但显然列表 A 上的内容类型尚未更新。是否可以重新托管此内容类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T03:28:48.447

你试过[ReGhost](http://www.reghost.net/)吗？我不确定它对您有帮助，但值得一试。这是他们的报价

> [ReGhost] 将定位您在网络上的所有内容数据库，并检查它们是否存在非托管独立页面 - 然后它允许您选择要还原的内容。选择后，它将基本上重置内容，也就是“重新托管”内容 - 使您的迁移能够成功完成。

# python - 使用 Werkzeug 和 Jinja2 的上下文处理器

> ID：539116
> 
> 赞同：4
> 
> 时间：2009-02-11T22:22:39.853
> 
> 标签：python, django, google-app-engine, jinja2, werkzeug

我的应用程序在 App Engine 上运行，并使用[Werkzeug](http://werkzeug.pocoo.org/)和[Jinja2](http://jinja.pocoo.org/2/)实现。我想要一些功能上等同于 Django 自己的上下文处理器的东西：一个可调用的，它接受一个请求并将一些东西添加到模板上下文中。我已经有一个“上下文处理器”，可以在模板上下文中添加一些内容，但是如何让这个*请求*部分工作？我将上下文处理器实现为一个可调用对象，它只返回一个稍后用于更新上下文的字典。

例如，我想添加一些包含在`request.environ`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T23:55:13.297

实现这一点的一种方法是通过使用Werkzeug 中的[线程本地代理的后期绑定](http://werkzeug.pocoo.org/documentation/local)[模板全局变量。](http://jinja.pocoo.org/2/documentation/api#jinja2.Environment.globals)

将请求放入模板全局变量的简单示例：

```
from werkzeug import Local, LocalManager
local = Local()
local_manager = LocalManager([local])

from jinja2 import Environment, FileSystemLoader

# Create a global dict using the local's proxy to the request attribute
global_dict = {'request': local('request')}
jinja2_env = Environment(loader=FileSystemLoader('/'))
jinja2_env.globals.update(global_dict)

def application(environ, start_response):
    """A WSGI Application"""
    # later, bind the actual attribute to the local object
    local.request = request = Request(environ)

    # continue to view handling code
    # ...

application = local_manager.make_middleware(application) 
```

现在在您的任何模板中，当前请求将显示为绑定到变量“request”。当然，这可能是周围的任何其他东西。诀窍是使用本地代理，然后在渲染任何模板之前设置值。

我可能还应该补充一点，像[Glashammer](http://glashammer.org) (Werkzeug+Jinja2) 这样的框架通过使用事件为您简化了这个过程。许多函数可以在 WSGI 调用过程中连接到事件（例如，当创建请求时），它们可以在此时将内容放入模板命名空间中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T21:02:52.687

好吧，使用[Ali 写的内容](https://stackoverflow.com/questions/539116/context-processor-using-werkzeug-and-jinja2/539427#539427)，我找到了特定于 App Engine 的解决方案（因为它的导入缓存）。不幸的是，Ali 的代码不适用于 App Engine，因为设置 Jinja 全局变量的代码只导入一次（使全局变量实际上是静态的）。

我必须编写自己的`render()`函数并在那里更新上下文。为了完整起见，下面是我来的代码：

```
def render(template, **kwargs):
    response_code = kwargs.pop('response_code', 200)
    mimetype = kwargs.pop('mimetype', 'text/html')
    for item in getattr(settings, 'CONTEXT_PROCESSORS', []):
        try:
            processor = import_string(item)
            kwargs.update(processor(local.request))
        except (ImportError, AttributeError), e:
            logging.error(e)
    return Response(jinja_env.get_template(template).render(**kwargs),
        status=response_code, mimetype=mimetype) 
```

这是 App Engine 特定的。在其他环境中，阿里的代码按预期工作（这就是我重新标记我的问题的原因）。

# asp.net - 迁移经典 ASP - Webforms 还是 ASP.NET MVC？

> ID：539123
> 
> 赞同：10
> 
> 时间：2009-02-11T22:24:55.480
> 
> 标签：asp.net, asp.net-mvc, asp-classic

我正在为我的客户端对一个经典的 ASP 应用程序进行一些维护，当我浏览 ASP 时，我想到了以下问题 - 将经典的 ASP 应用程序转换为 ASP.NET MVC 或 ASP 会更容易吗？ NET Web 窗体？

在许多方面，似乎至少 ASP 的 HTML 可能更容易转换为 MVC，而不是撕掉 HTML 块并将它们转换为 ASP.NET 控件、转发器、数据网格等。另外必须添加ViewState 等的处理和逻辑可能会添加工作。

我不认为我的客户会要求这样的升级，所以这只是理论上的。

让我们假设这个 ASP 代码写得很好（当然这并不总是正确的），所以真正的问题是，一个最佳案例设计良好的 ASP 站点会比 WebForms 更好地迁移到 MVC 吗？

（请注意，我对 ASP.NET MVC 很陌生，所以我可能在这里遗漏了一些重要的东西）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T23:34:20.367

这在很大程度上取决于经典的 asp 应用程序的结构。

与 HTML 混合的服务器标签类似于 asp.net mvc，但 MVC 没有那么混乱（或不应该如此）。您可能能够将经典的 asp 演示代码移至 MVC 视图，而不是移至 Web 表单。此外，经典的 ASP 应用程序通常在开发时考虑到 Web 的无状态性。您的经典 asp 中可能没有任何内容与 postabacks 或 viewstate 匹配。Classic ASP 也使用普通的 html 元素，而不是 asp.net webform 控件。在这些方面，它与 MVC 比 webforms 更接近。

如果你不知道 asp.net webforms 或 asp.net mvc 我会说 MVC 是要走的路。

如果您非常了解 webforms 并且对 MVC 了解不多，我会说 webforms 是要走的路。

但是，如果您的客户出于某种原因确实想要重新开发网站，我会说使用 MVC。只要您可以交付，让客户为您的部分体验开发付费总是很好的。

另一方面，当我遇到一个希望我在他们的经典 asp 网站上工作的客户时，我总是感到吃惊。在每种情况下，该网站都是一团糟。更糟糕的是，它们通常充满了巨大的安全漏洞。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T22:36:48.850

我认为在很多情况下，转换为 MVC 可能比 Webforms 更容易。大多数经典的 ASP 应用程序很少展示关注点分离，因此最大的任务可能就是这样，将逻辑分离为数据访问、业务逻辑、业务实体和 UI 组件。在这样做时，将内联 ASP 代码转换为视图、将业务逻辑转换为控制器、将业务实体转换为模型可能会更容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T22:38:41.793

我不认为一个会比另一个更容易转换。

如果您想在代码隐藏中放置一些您可以在 aspx 中访问的关键元素，您可以编写几乎与编写 ASP 相同的 ASP.NET。没有数据绑定，没有网格视图，也没有中继器。视图状态可以帮助您很容易弄清楚，如果您不想使用它，则无需使用它，并且可以在 web.config 中将其关闭并使用页面属性打开。Web 表单也有一个*[AspCompat](http://msdn.microsoft.com/en-us/magazine/cc163544.aspx)*模式，它允许访问 Request 和 Response 对象或 asp，如果需要，这将允许逐页转换。

对于 MVC.net，显示 HTML 的方法非常相似。在我看来，这就是相似之处的结束。您仍然需要将所有逻辑分离到 MVC 模型中。

从 ASP 到 Web.Form 和现在 MVC.Net 我可以告诉你，WebForms 学习起来有点烦人/令人沮丧，90% 的 MS 教程教你最糟糕的习惯 IE（页面上的 SQL 连接，在设计器中拖动数据集）。但是，一旦你超越了这一点，它能够比在 asp 中更快地完成很多事情（例如，分页或通过编辑构建一个简单的数据表），但是我仍然从未见过具有 n 层的大型 webforms 项目我认为易于遵循、实施和使用的设计。

MVC.NET 就像天赐之物。它迫使你的模式和练习进入你的喉咙，它有大多数人都遵守的严格规则。它允许轻松的代码覆盖和关注点分离。在对网络表单感到沮丧多年之后，当我尝试做一些我无法从工具栏上拖下来的事情时，我终于觉得我并没有把事情拼凑在一起。

我个人会尝试使用 webforms，这样当你开始使用 MVC 时，你就会知道它有多好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T22:30:41.330

ASP.NET-MVC 不仅仅是视图代码和 ASP 内联代码之间的明显相似之处。需要考虑所有模型和控制器部分，这与大多数 ASP 的编写方式非常不同。

也就是说，我会说 MVC 将是最好的起点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T22:35:35.937

IMO WebForms 试图根据我的喜好隐藏过多的 html，并且由于将大量 html 转换为 webforms 控件，可能会导致您的项目花费比您想要的更长的时间。

另一方面，MVC 允许您重用其中的一些逻辑，同时使您的应用程序更易于维护，并且使用适当的架构模式，您的应用程序可以比任何 WebForms 项目更快地开发和重构。

我一直说MVC！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T23:47:58.913

无论哪种方式，最好从头开始并只实现逻辑。

很久以前（超过 12 年前）我开始使用 ASP，直到 2006 年我才迁移到 ASP.NET 2.0，即使在今天我也不知道全部，但我确实知道我每天在工作中所做的事情。

在我看来，现在回顾我对 ASP 的了解，我会使用 Web Forms 而不是 MVC，首先，它是一种语言，它现在已经在“市场”中出现了一些年并且在世界范围内非常使用，而 MVC 仍然存在在 Beta 中，因此不适合生产环境（Microsoft 说——即使这个站点是用 MVC 编写的）。

我仍然倾向于混淆 MVC 图，如果我需要对一个 ASP 项目进行快速更改，我想学习的技巧比我想学习的要多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T00:46:42.843

这取决于。ASP.NET MVC 不是灵丹妙药，并且在许多方面在开发人员生产力方面倒退了几步。

如果您的预算紧张并且需要快速完成这项工作，我相信 ASP.Net 是您的最佳选择，因为它拥有丰富的控件，如网格、分页、验证等，您可以直接使用这些控件。使用这些控件无疑会节省大量的开发时间。当您使用 ASP.NET MVC 项目时，所有这些目前在 ASP.NET 中大多数人认为是普通的控件都必须从头开始创建或从 Internet 获取。

另一方面，如果您现在和未来有时间和预算，并且想要拥有坚如磐石的解决方案，并且更容易适合测试驱动的开发，那么 ASP.NET MVC 可能是最佳选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-31T12:35:46.730

毫无疑问，ASP.NET MVC 在风格方面更好。（也就是说，您不必*在*WebForms 应用程序中使用中继器和其他愚蠢的控件，您*可以*像在 MVC 中一样简单地使用内联代码。）

MVC 通常会是一个更容易的移植，给你一个更好的结构和更愉快的体验。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-16T01:02:28.817

Web Forms 更加面向对象，而 MVC 就像 .NET 代码之上的经典 ASP。使用 Web 表单或 MVC 的模型设计应该相同。唯一的区别是 Web 窗体对 UI 具有面向对象的抽象，而 MVC 使用函数和代码片段而不是类来组织 UI 代码。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-11-12T01:22:10.320

ASP.NET MVC 在 UI 的自动化单元测试方面优于 Web 窗体。然而，自动化单元测试通常是不好的做法，对 UI 来说更糟。手动测试是构建高质量应用程序和充分利用开发时间的最佳方式。创建自动化单元测试是浪费时间，并且最终会使用垃圾代码来维护核心代码。许多开发人员喜欢自动化单元测试，因为他们认为它们证明了他们的应用程序可以工作，这是错误的。他们还试图避免使用 UML 设计应用程序，因此他们使用测试驱动开发来使用导致设计不佳的应用程序的代码进行设计。使用 TDD，您正在重构编写不佳的代码，而没有首先考虑使用模型的全局。

所以MVC是没用的。Web Forms 使用更好的面向对象模型，而 MVC 更像旧式经典 ASP 和其他旧式设计模式。这是 2010 年，MVC 已经死了。Web 表单就像 UI 的 ORM。

# hosting - 100mbps 专用服务器与共享主机相同的下载速度！

> ID：539125
> 
> 赞同：0
> 
> 时间：2009-02-11T22:24:59.130
> 
> 标签：hosting, performance, bandwidth, internet-connection, dedicated-hosting

我有来自我正在使用的两个不同主机的两个规格：

(a) 具有全双工 100Mbits 互联网连接的专用服务器（每月 140 美元）

(b) 具有 100Mbits 互联网连接的服务器上的共享主机（每月 7 美元）

我已经测试了从其他服务器下载并让用户依次从我的站点下载的应用程序。我已经一次又一次地测试了这个，下载文件需要同样的时间！但是专用的在最终下载到客户端计算机时要快得多。

首先，我可以使用任何 Linux 命令或工具来正确测试每台服务器的带宽吗？

其次，为什么他们从其他服务器具有相同的下载速度？

请对此有所了解，因为我觉得我一直在无缘无故地浪费钱！

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:28:21.570

首先，您可以使用[iperf](http://sourceforge.net/projects/iperf)来测试您的网络速度。其次，您无需为速度付费，您需要为基本上按照您的需要配置自己的服务器的功能和灵活性付费。使用共享主机，您的站点很可能位于具有一百个其他站点的计算机上，每个站点都在争夺资源。

此外，瓶颈可能不在您端或主机端，而是在您正在获取的内容和您的服务器之间的某个地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:52:22.823

**如果我没看错，您的共享服务器在获取**文件时与专用服务器一样快，但在**提供**文件时要慢得多。

我想说的是，您的共享服务器所在的盒子的“输出”带宽主要由其他客户端的切片使用，而“输入”带宽大部分未使用，因此您几乎可以获得全部性能。

听起来不错，因为提供文件比获取文件更常见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:28:12.053

也许他们正在下载的服务器是瓶颈？你可以有一个专用的千兆管道，但如果你只能从其他服务器获得 10mbps，那将无济于事。

请记住，专用主机的好处是您的性能不会受到机器上其他进程的影响。额外的钱保证你有 100mbit，而不是你会在任何给定时间看到比托管机器更好的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T22:28:46.263

共享主机和专用主机之间的最大区别在于，使用专用主机，您是唯一使用该框的帐户。使用共享主机，可能（并且很可能是）数千个其他网站托管在上面。

如果其中一个网站出现问题并带走了整个盒子，那么您的网站也会出现。在专用盒子上，唯一会出现问题的网站就是您的网站。

使用专用，您可能还拥有该框的完全管理员权限，而共享主机可能没有这些权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T22:28:52.490

好吧，一种可能是共享站点位于主机上，而其他共享站点的负载很少。如果所有共享站点都只是坐在那里获得很少的点击，那么您的站点基本上正在充分利用该框，因此它与专用框没有什么不同。

但是，如果那些其他网站开始获得流量，您的网站就会受到影响。

不确定共享站点是否是全双工的，但这并不总是有影响（不是那里的专家）。

# c# - 如何在自定义控件中包含光标（插入符号）？

> ID：539132
> 
> 赞同：2
> 
> 时间：2009-02-11T22:26:27.643
> 
> 标签：c#, winforms

我被分配在 C# 中使用 Windows 窗体制作自定义网格控件。我不确定的一件事是如何处理显示闪烁的光标（插入符号）以指示单元格编辑的位置以及将显示下一个字符。

有谁知道这是如何使用标准文本框完成的？是否有一个标准的框架结构可以为我做到这一点？

显然我可以设置一个计时器并自己绘制光标，但我想知道是否有更好的选择。请注意，这是一个完全由用户绘制的控件，而不是 UserControl 派生类，并且由于各种原因，子类化现有类不是一种选择。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T22:47:29.387

干得好：

```
using System;
using System.Drawing;
using System.Windows.Forms;
using System.Runtime.InteropServices;

public class MyWidget : Control {
  public MyWidget() {
    this.BackColor = Color.Yellow;
  }
  protected override void OnGotFocus(EventArgs e) {
    CreateCaret(this.Handle, IntPtr.Zero, 2, this.Height - 2);
    SetCaretPos(2, 1);
    ShowCaret(this.Handle);
    base.OnGotFocus(e);
  }
  protected override void OnLostFocus(EventArgs e) {
    DestroyCaret();
    base.OnLostFocus(e);
  }
  [DllImport("user32.dll", SetLastError = true)]
  private static extern bool CreateCaret(IntPtr hWnd, IntPtr hBmp, int w, int h);
  [DllImport("user32.dll", SetLastError = true)]
  private static extern bool SetCaretPos(int x, int y);
  [DllImport("user32.dll", SetLastError = true)]
  private static extern bool ShowCaret(IntPtr hWnd);
  [DllImport("user32.dll", SetLastError = true)]
  private static extern bool DestroyCaret();
} 
```

我很乐意把责任推卸给找出把它放在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T22:33:34.617

有关[Carets 的 MSDN 参考资料在此处](http://msdn.microsoft.com/en-us/library/ms646968(VS.85).aspx)。我最后一次查看（在框架的 2.0 中）插入符号不能作为托管 API 使用：因此您需要使用非托管 API，或者绘制自己的插入符号。

要记住的一件事是，当您实现插入符号时，您不应该在您的控件没有焦点时显示它（用户桌面上一次只有一个控件，即具有输入焦点的控件，应该永远显示输入插入符号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:43:05.433

为什么要重新发明轮子？只需在网格需要编辑时显示一个文本框。

好的，我看到您使用自定义绘图，但是是什么阻止您在其上放置文本框？

如果你想走上一条艰难的道路，微软确实有一些可以提供虚拟文本区域的旧库（或者类似的东西，已经很长时间了）。

# python - 在 Python 中测试目录权限？

> ID：539133
> 
> 赞同：8
> 
> 时间：2009-02-11T22:26:47.113
> 
> 标签：python, windows, permissions, directory

在 Windows 上的 Python 中，有没有办法确定用户是否有权访问目录？我已经看过了，`os.access`但它给出了错误的结果。

```
>>> os.access('C:\haveaccess', os.R_OK)
False
>>> os.access(r'C:\haveaccess', os.R_OK)
True
>>> os.access('C:\donthaveaccess', os.R_OK)
False
>>> os.access(r'C:\donthaveaccess', os.R_OK)
True 
```

难道我做错了什么？有没有更好的方法来检查用户是否有权访问目录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T22:32:04.993

在 Windows 中检查权限可能很复杂（例如，请注意带有 UAC 的 Vista 中的问题！- 请参阅此[相关问题](https://stackoverflow.com/questions/450210/how-to-check-if-a-file-can-be-created-inside-given-directory-on-ms-xp-vista)）。

您是在谈论简单的读取访问，即读取目录的内容吗？测试权限的最可靠方法是尝试访问该目录（例如执行一个`os.listdir`）并捕获异常。

此外，为了正确解释路径，您必须使用原始字符串或转义反斜杠（'\\'），或者使用正斜杠。

（编辑：您可以完全避免使用斜线`os.path.join`——推荐的构建路径的方法）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T23:04:01.500

虽然 os.access 尽最大努力判断路径是否可访问，但它并不声称是完美的。来自 Python 文档：

> 注意：即使 access() 表明 I/O 操作会成功，I/O 操作也可能会失败，特别是对于网络文件系统上的操作，其权限语义可能超出通常的 POSIX 权限位模型。

确定用户是否有权执行任何操作的推荐方法是尝试执行此操作，并捕获发生的任何异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-15T08:23:53.783

实际上 'C:\haveaccess' 与 r'C:\haveaccess' 不同。从 Python 的角度来看，“C:\haveaccess”不是有效路径，因此请改用“C:\\haveaccess”。我认为 os.access 工作得很好。

# php - 为中级程序员学习 PHP 和 Web 编程

> ID：539138
> 
> 赞同：15
> 
> 时间：2009-02-11T22:28:45.220
> 
> 标签：php

对于那些已经熟悉编程的人，我想知道一些关于学习 PHP 的好资源（书籍或网站）。

我一直在寻找的许多教程都是为那些以前从未编程过的人准备的，他们需要很长时间才能学习基本的语言结构。

然而，最佳资源不会假设以前的 Web 开发背景。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-11T22:33:37.750

我使用的是PHP[手册，尤其是 Firefox 中的搜索框。](http://www.php.net/manual/en/)输入一个函数名然后去。如果您还没有，在等待更多答案时可能值得浏览。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T22:47:44.817

这个网站有一些好东西：

> [http://tizag.com](http://tizag.com)

每当我教任何人东西时，我都会告诉他们只用谷歌“php [插入你想做的事情]”，它通常会出现在前几个结果中。

另外一个选项：

> [http://php.net](http://php.net)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T01:33:03.967

如果您已经是一位经验丰富的程序员，那么学习原始 PHP 可能是错误的方法。我建议选择其中一种框架，例如 PHP Cake、Code Ignitor 或 Symfony。这些框架试图强制执行过去六七年来为 PHP 开发人员开发的一组最佳实践。

为此，Symfony 提供了一个很棒的[“24 小时”式教程](http://www.symfony-project.org/jobeet/1_2/Doctrine/en/)，可以让你开始使用他们的框架并运行它，它会偷偷地让你接触到编写 PHP 代码。即使您决定不喜欢 symfony，也会涵盖诸如 MVC、路由、模板、ORM 等概念。其他框架也有类似的教程，但我喜欢 24 小时一小时的课程方法。

对于特定 PHP 核心函数/类的问题，[php.net](http://php.net)是一个很好的资源（尽管一些核心帮助类的文档，如 XMLReader 和反射层次结构可能很稀疏）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T22:35:20.023

使用[http://www.w3schools.com](http://www.w3schools.com)。他们为初级和中级 php 程序员提供了一个很棒的教程。此外，[PHP 手册](http://www.php.net/docs.php)很棒。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-21T18:13:31.463

我肯定最常使用官方网站 php.net 和 O'Reilly 的 PHP Cookbook。

同样，zend 开发区、[http://devzone.zend.com/public/view](http://devzone.zend.com/public/view)和 Manning 的 PHP in Action 书籍都是有用的资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T23:08:25.170

它现在有点老了，但我在[PHP Anthology](http://www.sitepoint.com/books/phpant1/)方面有很好的学习经验。如果您查看它，请记住它是在大约 5 年前发布的。

快速的“网络搜索”显示市场上也有一个[新](https://rads.stackoverflow.com/amzn/click/com/0975841998)的，但我没有这方面的经验。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T23:09:54.467

[一些免费的 PHP5 电子书](http://freeprogrammingebooks.com/free-programming-ebook/php-5/)。

*   实用 PHP 编程
*   PHP 5 对象、模式和实践

听起来不错

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T23:41:33.330

我非常同意@stalepretzel 的观点——w3schools 和 php.net 网站都是非常丰富的资源，既可以帮助您入门，也可以让您继续前进。

对于视频教程（截屏视频），你真的无法击败“在树林里 - 潜入 PHP”——第一个视频在这里：[http ://blog.themeforest.net/screencasts/diving-into-php-video-系列/](http://blog.themeforest.net/screencasts/diving-into-php-video-series/)

方便的花花公子在这里快速参考：http: [//www.addedbytes.com/cheat-sheets/php-cheat-sheet/](http://www.addedbytes.com/cheat-sheets/php-cheat-sheet/)

当/如果您遇到特定问题时，您可以随时回到这里。

*   尼古拉斯

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-09T12:20:33.043

您对 w3schools 有什么看法？我推荐这个网站。这也适合初学者和高级水平。

另外我想参考官方PHP网站和You Tube（搜索与PHP相关的视频）

# xml - “/”的 XML 实体？

> ID：539143
> 
> 赞同：44
> 
> 时间：2009-02-11T22:29:13.363
> 
> 标签：xml, entity, escaping, sequence

所以我正在编写一些 XML 生成代码，发现以下属性值搞砸了 XML 格式：

```
"Jim/Bob" 
```

所以我查看了用作转义序列的 XML 实体，我看到的每个列表都没有包含一个用于正斜杠的列表。我在这里遗漏了一些明显的东西吗？似乎是那种你想逃避的东西……

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-11T22:31:42.607

正斜杠按原样有效，不需要进一步编码。

唯一的保留字符是：

```
>
<
&
% 
```

对于更多 XML 实体 - [http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-12T14:31:41.417

我知道事实证明这不是问题，但我认为除了 bobince 的回答之外，提及**Fraction Slash** HTML 实体`&frasl;`看起来[就像一个正斜杠](http://www.fileformat.info/info/unicode/char/2044/index.htm)会很有帮助。以防万一到达此页面的任何人*确实*需要一个 HTML 实体来表示正斜杠。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-10-12T09:45:07.083

我不认为这个线程中的评论是完全正确的，因为如果您使用模式 (XSD)，您可以毫无问题地定义名称为 Jim、Bob 和 Jim/Bob 的元素。但是当你想定义元素和实体时：

```
<names>
  <Jim>Carrey</Jim>
  <Bob>Jones</Bob>
  <Jim/Bob>Six figured Hillbilly</Jim/Bob>
</names> 
```

问题很明显。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-08-17T11:08:40.377

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-11T22:39:12.027

它没有预定义的实体引用，但您可以使用字符引用：“&#47;”。

但是，您不需要转义 / 以包含在 XML 中。您可能必须将其包含在其他内容中，例如 URI 路径部分。但是，您必须先将其转义为该格式；获取 URI 的应用程序无法知道您是否在 XML 中对其进行了编码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-11T22:34:03.413

我不明白为什么“Jim/Bob”的值需要转义或导致 XML 出现任何问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T22:33:46.160

您可能有一个受约束的属性，如 XML 模式中所定义。

我不知道您所说的 XML 格式是什么意思。

# sql - 如何在 SQL Server 中将字符串数据与表数据进行比较 - 我需要知道列中是否不存在字符串中的值

> ID：539145
> 
> 赞同：0
> 
> 时间：2009-02-11T22:29:58.413
> 
> 标签：sql, sql-server, tsql, sql-server-2008

我有两个表，一个是导入表，另一个是导入表最终将放入的表的 FK 约束。在导入表中，用户可以提供与第二个表中的值相对应的分号分隔值列表。

所以我们正在研究这样的事情：

```
TABLE 1
ID | Column1
1  | A; B; C; D

TABLE 2
ID  | Column2
1   | A
2   | B
3   | D
4   | E 
```

要求是：

表 1 中值不在表 2 中的行（在我们的示例中为 C）应标记为无效，以供用户手动清理。所有值都有效的行由另一个已经工作的脚本处理。

在生产中，我们将处理需要检查的 6 列，并且一次导入至少 100k 行。因此，我想在数据库中完成所有工作，而不是在另一个应用程序中。

顺便说一句，它是 SQL2008。

我被卡住了，任何人都有任何想法。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T23:46:21.740

在我看来，您可以将 ID 和 Column1 值从 Table1 传递给一个 Table-Valued 函数（或内联临时表），该函数将解析 ;-delimited 列表，返回每条记录的单个值。

这里有几个选项：

*   [T-SQL：解析分隔字符串](http://pietschsoft.com/post/2006/02/T-SQL-Parse-a-delimited-string.aspx)
*   [快速 T-Sql 解析分隔字符串](http://codebetter.com/blogs/raymond.lewallen/archive/2005/10/26/133774.aspx)

该函数的结果 ( `ID, value`) 可用于将（不匹配的查询）与表 2 中的值进行比较。

```
SELECT tmp.ID
FROM tmp
LEFT JOIN Table2 ON Table2.id = tmp.ID
WHERE Table2.id is null 
```

然后，比较的`ID`结果将用于标记表 1 中的记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T23:41:46.840

也许将这些复合值插入“表 1”似乎是最方便的解决方案。但是，除非您的用户使用 SQL Server Management Studio 或类似的工具将值直接输入到表中，否则我假设 UI 和数据库之间必须有一个软件层。如果是这样，您现在和从长远来看都可以省去很多麻烦，只需花一点时间来更改您的代码，以便在将分号分隔的输入拆分为离散值，然后再将它们插入数据库。这将导致“表 1”看起来像这样

```
TABLE 1
ID  | Column1
1   | A
1   | B
1   | C
1   | D 
```

然后编写 SQL 来查找那些无效的 ID 就很简单了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T00:07:12.020

如果可能，请尝试在导入时将值放在单独的行中（而不是将其存储为 ; 分隔）。

[这](http://www.sommarskog.se/arrays-in-sql-2005.html)可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T20:53:52.697

对于无效行的 ID，这是一个简单直接的解决方案，尽管由于字符串操作而缺乏性能。

```
select T1.ID
from [TABLE 1] T1
    left join [TABLE 2] T2
        on ('; ' + T1.COLUMN1 + '; ') like ('%; ' + T2.COLUMN2 + '; %')
where T1.COLUMN1 is not null
group by T1.ID
having count(*) < len(T1.COLUMN1) - len(replace(T1.COLUMN1, ';', '')) + 1 
```

有两个假设：

1.  分号分隔的列表不包含重复项
2.  表 2 不包含 COLUMN2 中的重复项。

第二个假设可以很容易地通过使用 ( `select distinct COLUMN2 from [TABLE 2]`) 而不是来修复`[TABLE 2]`。

# asp.net - 如何有条件地更改表示层中的控件属性

> ID：539153
> 
> 赞同：0
> 
> 时间：2009-02-11T22:31:02.657
> 
> 标签：asp.net

我在 ASP.Net 方面不是很有经验，因为我主要使用 PHP。我正在尝试这个，但它不起作用：

```
<asp:TextBox runat="server" ID="txtAnswer" 
  TextMode='<%# IIf(DataBinder.Eval(Container.DataItem, "DoLargeInput"), "MultiLine", "SingleLine" )%>' Text=''></asp:TextBox> 
```

DoLargeInput 是一个布尔值。

为什么这不起作用？

我遇到以下错误：

```
System.InvalidCastException: Conversion from string "MultiLine" to type 'Integer' is not valid. ---> System.FormatException: Input string was not in a correct format.
   at Microsoft.VisualBasic.CompilerServices.Conversions.ParseDouble(String Value, NumberFormatInfo NumberFormat)
   at Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger(String Value)
   --- End of inner exception stack trace ---
   at Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger(String Value)
   at Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger(Object Value)
   at ASP.profile_questions_aspx.__DataBinding__control6(Object sender, EventArgs e)
   at System.Web.UI.Control.OnDataBinding(EventArgs e)
   at System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding)
   at System.Web.UI.Control.DataBind()
   at System.Web.UI.Control.DataBindChildren()
   at System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding)
   at System.Web.UI.Control.DataBind()
   at System.Web.UI.WebControls.Repeater.CreateItem(Int32 itemIndex, ListItemType itemType, Boolean dataBind, Object dataItem)
   at System.Web.UI.WebControls.Repeater.CreateControlHierarchy(Boolean useDataSource)
   at System.Web.UI.WebControls.Repeater.OnDataBinding(EventArgs e)
   at System.Web.UI.WebControls.Repeater.DataBind()
   at profile_questions.LoadObjects() 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T22:39:03.730

尝试：-

```
IIf(DataBinder.Eval(Container.DataItem, "DoLargeInput"), TextBoxMode.MultiLine, TextBoxMode.SingleLine 
```

它将为您适当地转换 TextMode="MultiLine" 的解析。在此绑定代码发生解析结束时，您需要像在代码中一样指定值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T22:45:20.373

转换为 'Integer' 失败是因为 TextMode 属性是 .NET `enum`，它在内部表示为整数。`TextBoxMode.MultiLine`并`TextBoxMode.SingleLine`代表正确的值。

在 MSDN 上，您可以看到该[`TextBox.TextMode`属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.textmode.aspx)具有 type [`TextBoxMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textboxmode.aspx)。

# sql-server-2005 - SQL 2005 中递归查询结果的排序层次结构

> ID：539155
> 
> 赞同：5
> 
> 时间：2009-02-11T22:31:12.170
> 
> 标签：sql-server-2005, recursion, hierarchy, common-table-expression

我有一个包含以下列的“任务”表（TaskOrder 用于在父级范围内对子级进行排序，而不是整个表）：

```
任务 ID
父任务 ID
任务名称
任务顺序

```

我有这个 CTE 查询来返回所有行：

```
with tasks (TaskId, ParentTaskId, [Name]) as
(
    select parentTasks.TaskId,
           parentTasks.ParentTaskId,
           parentTasks.[Name]
    from   Task parentTasks
    where  ParentTaskId is null

    union all

    select childTasks.TaskId,
           childTasks.ParentTaskId,
           childTasks.[Name]
    from   Task childTasks
    join   tasks
    on     childTasks.ParentTaskId = tasks.TaskId
)

select * from tasks 
```

此查询返回您所期望的按级别排序的所有任务。如何更改它以将结果排序为如下的层次顺序？

```
- 任务1
-- 任务 1 子任务 1
-- 任务 1 子任务 2
- 任务 2
- 任务 3

```

谢谢。

**编辑：**答案应该适用于无限数量的级别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:44:55.743

您可以这样做的一种方法是添加一个层次结构列，该列在列表中包含所有以前的 ID：

```
with tasks (TaskId, ParentTaskId, [Name], TaskIdList) as
(
    select parentTasks.TaskId,
           parentTasks.ParentTaskId,
           parentTasks.[Name],
           parentTasks.TaskId
    from   Task parentTasks
    where  ParentTaskId is null

    union all

    select childTasks.TaskId,
           childTasks.ParentTaskId,
           childTasks.[Name],
           tasks.TaskIdList + '.' + childTasks.TaskId
    from   Task childTasks
    join   tasks
    on     childTasks.ParentTaskId = tasks.TaskId
)

select TaskId, ParentTaskId, [Name] from tasks
   order by TaskIdList 
```

请注意，这假定 TaskId 是基于字符串的 ID。如果没有，您应该在连接之前将其转换为 varchar。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T21:42:27.257

[使用Mark 方法](https://stackoverflow.com/questions/539155/ordering-recursive-query-results-in-sql-2005/539211#539211)的变体解决了这个问题，但我没有在每个节点中保留节点路径，因此我可以更轻松地在树周围移动它们。相反，我将我的 'OrderBy' 列从 int 更改为 varchar(3) 左填充零，这样我就可以将它们连接到所有返回的行的主 'OrderBy' 中。

```
with tasks (TaskId, ParentTaskId, OrderBy, [Name], RowOrder) as
(
    select  parentTasks.TaskId,
            parentTasks.ParentTaskId,
            parentTasks.OrderBy,
            parentTasks.[Name],
            cast(parentTasks.OrderBy as varchar(30)) 'RowOrder'
    from    Task parentTasks
    where   ParentTaskId is null

    union all

    select  childTasks.TaskId,
            childTasks.ParentTaskId,
            childTasks.OrderBy,
            childTasks.[Name],
            cast(tasks.RowOrder + childTasks.OrderBy as varchar(30)) 'RowOrder'
    from    Task childTasks
    join    tasks
    on      childTasks.ParentTaskId = tasks.TaskId
)

select * from tasks order by RowOrder 
```

这将返回：

```
TaskId ParentTaskId OrderBy 名称 RowOrder
-------------------------------------------------- -------------------------
1 NULL 001 任务一 001
15 1 001 任务一/任务一 001001
2 NULL 002 任务二 002
7 2 001 任务二/任务一 002001
14 7 001 任务二/任务一/任务一 002001001
8 2 002 任务二 / 任务二 002002
9 8 001 任务二 / 任务二 / 任务一 002002001
10 8 002 任务二 / 任务二 / 任务二 002002002
11 8 003 任务二 / 任务二 / 任务三 002002003
3 NULL 003 任务三 003
4 NULL 004 任务四 004
13 4 001 任务四/任务一 004001
5 NULL 005 任务五 005
6 NULL 006 任务六 006    
17 NULL 007 任务七 007
18 NULL 008 任务八 008
19 NULL 009 任务九 009
21 19 001 任务九 / 任务一 009001
20 NULL 010 任务十 010

```

它不允许无限的层次结构（每个父节点最多 10 个级别/最多 1000 个子节点 - 如果我从 0 开始 OrderBy），但足以满足我的需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T22:50:55.820

您不需要所有工会的东西，我认为这应该可行：

```
select
 TaskId,
 ParentTaskId,
 [Name],
 COALESCE(ParentTaskId, TaskId) as groupField
from
 task
order by
 COALESCE(ParentTaskId, TaskId), ParentTaskId, TaskId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T22:45:47.707

由于您没有指定“ORDER BY”，您如何期望它以任何特定的顺序返回它们（除了希望查询分析器以某种预期的方式工作？）。

如果您希望它按 ParentTaskId，TaskId 顺序，则在第一个 UNION 元素中选择 TaskId 作为 ParentTaskId 和 NULL 作为 TaskId；然后

按 ParentTaskId、TaskId 排序？

# asp.net - 如何知道新生成的密码

> ID：539157
> 
> 赞同：2
> 
> 时间：2009-02-11T22:31:36.850
> 
> 标签：asp.net

试图实现asp.net密码恢复控制。

我想在发送给用户之前捕获新生成的密码并向其添加一些自定义逻辑，然后发送邮件。只有一个事件正在发送邮件事件。

我怎样才能抓住它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T19:37:57.353

您可以处理 SendingMail 事件，使用 ResetPassword 生成一个新密码，然后使用您的新密码以及您想要输入的任何其他内容更新电子邮件正文。

```
protected void PasswordRecovery1_SendingMail(object sender, MailMessageEventArgs e)
{
    // grab the user.
    MembershipUser mu = Membership.GetUser(PasswordRecovery1.UserName);

    if (mu != null)
    {

        // reset the password.
        string newPass = mu.ResetPassword();

        // switch out the body of the email.
        e.Message.Body = string.Format("New Password: {0}\n", newPass);

    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:35:39.650

当调用成员资格提供程序的 CreateUser 方法、ChangePassword 方法或 ResetPassword 方法时，将引发 ValidatingPassword 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:48:45.703

你想实现什么“自定义逻辑”？

如果您想修改已发送的电子邮件，则挂钩到控件上的[SendingMail](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.passwordrecovery.sendingmail.aspx)事件是可行的方法。

> 使用此事件在发送电子邮件之前执行所需的任何特殊处理，例如设置 MailMessage 属性。

这将使您可以访问[MailDefinition](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.passwordrecovery.maildefinition.aspx)对象，该对象使您能够提供不同的正文副本等。MailDefinition 文档也列出了将发生的替换（也可以以声明方式创建）：

```
<asp:PasswordRecovery ID="PasswordRecovery1" Runat="server" 
  SubmitButtonText="Get Password" SubmitButtonType="Link">
  <MailDefinition From="administrator@Contoso.com" 
    Subject="Your new password"
    BodyFileName="PasswordMail.txt" />
</asp:PasswordRecovery> 
```

新密码将在此阶段存储在数据库中，因此您可以在发送电子邮件之前在此事件中修改它 - 您尝试过吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T19:43:30.850

您是否打算将生成的密码存储在某个地方，因为您的问题的措辞表明您希望能够阅读它并用它做一些事情？

# reporting-services - 如何报告 TFS 中存在待定更改的文件？

> ID：539160
> 
> 赞同：2
> 
> 时间：2009-02-11T22:32:21.310
> 
> 标签：reporting-services, tfs

我想创建一个简单的报告，显示当前来自 TFS 2008 服务器的未决更改（签出）的文件。我知道我可以使用 Team Explorer 中的“在源代码管理中查找”选项，但我宁愿生成报告服务报告。理想情况下，我可以显示文件何时签出以及签出的用户，但这不是必须的。

如果默认情况下数据没有推送到 TFS 数据仓库，那么我想在 SQL Server 实例中找到需要查询的关系表。

我花了一些时间在 TFS 数据仓库中挖掘并查看所有我可以得到的罐装 Reporting Services 报告，但一切似乎都针对工作项、与工作项相关的签入等。 ..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T22:35:45.483

如果您正在寻找一些易于读取的数据并且不太担心打印输出，请查看 Atrice 的 TFS sidekick 应用程序。非常有帮助，如果您拥有正确的权限，您将能够看到所有签出的文件。

[http://www.attrice.info/cm/tfs/](http://www.attrice.info/cm/tfs/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T22:06:58.920

我怀疑您正在寻找的信息是否在数据仓库中，即使它可能对您的目的来说还不够新鲜。默认情况下，仓库每小时更新一次。

您可以使用 SSRS 直接针对 TFSVersionControl 数据库进行报告，但我不建议您采用这种方式。该数据库没有记录在案，很有可能它会在下一个版本中更改。如果您的查询没有正确编写，它也可能会对性能产生影响。

更好的解决方案是使用 TFS Web 服务作为 SSRS 数据源。您可以调用一些服务来获取所有已签出的文件。此信息始终是最新的，并且它运行的查询经过高度优化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-26T13:40:05.000

命令行示例（Studio 2008）：

```
"C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\tf.exe" status /recursive /user:* 
```

# .net - 多行文本框中的当前行

> ID：539164
> 
> 赞同：2
> 
> 时间：2009-02-11T22:33:13.167
> 
> 标签：.net, user-controls

我有自己的自定义 TextBox 控件，它继承自 System.Windows.Forms.TextBox。我已经覆盖了 OnKeyDown 方法，因为如果用户按下向上或向下键，我想选择上一个或下一个控件。

```
 Protected Overrides Sub OnKeyDown(ByVal e As System.Windows.Forms.KeyEventArgs)

    MyBase.OnKeyDown(e)

    If e.KeyCode = Keys.Up Then
        If Not Multiline Then
            Me.FindForm().SelectNextControl(Me, False, True, True, True)
        Else
            'TODO: If the current line is the first one, select the previous control
        End If
    ElseIf e.KeyCode = Keys.Down Then
        If Not Multiline Then
            Me.FindForm().SelectNextControl(Me, True, True, True, True)
        Else
            'TODO: If the current line is the last one, select the next control
        End If
    End If

End Sub 
```

在多行文本框中，知道我是在第一行还是最后一行的更好方法是什么？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T22:38:10.547

这很粗糙，但它应该可以完成这项工作。

```
 If Me.Text.IndexOf(Environment.NewLine, 0, Me.SelectionStart) = -1 Then
        'no new lines before
    End If

    If Me.Text.IndexOf(Environment.NewLine, SelectionStart) = -1 Then
        'no new lines after
    End If 
```

# asp.net - 使用 HttpModules 将事件附加到 Session OnStart 和 OnEnd

> ID：539171
> 
> 赞同：4
> 
> 时间：2009-02-11T22:34:41.803
> 
> 标签：asp.net, session, events, httpmodule

有谁知道使用 HttpModule（不接触 Global.asax 文件）将事件添加到 Session 的 OnStart 和 OnEnd 事件的干净方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T22:57:33.887

```
public void Init(HttpApplication app)
{
   var ssm = app.Modules["Session"] as SessionStateModule;
   ssm.Start += Foo;
   ssm.End += Bar;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-19T20:56:07.640

可以通过以下方式模拟会话 OnStart 行为 - 在您的 HttpModule 的请求事件之一中 - 检查**HttpContext.Current.Session.IsNewSession**是否设置为 true。

不过有个坑！如果没有在 Session 对象中设置值，则下一个请求将具有一个正值，即 IsNewSession。因此，一旦您积极检查 IsNewSession，您应该在 Session 对象中设置任何值。

# wpf - WPF Grid Column MaxWidth 未强制执行

> ID：539174
> 
> 赞同：6
> 
> 时间：2009-02-11T22:35:31.880
> 
> 标签：wpf, layout, grid, word-wrap

这个问题源于无法让我的 TextBlock 换行。基本上作为最后的尝试，我在容器网格的列上设置 MaxWidth。我惊讶地发现我的子标签和文本框仍然可以为所欲为（坏孩子，BAD），并且不受我的网格列的 MaxWidth =“200”的限制。

我真正想做的是让我的 TextBlock 填充可用宽度并在必要时换行。到目前为止，在宇宙中每个已知的父级上尝试了许多 Horizo​​ntalAlignment="Stretch" 的变体之后，除了在 TextBlock 上设置显式 MaxWidth="400" 或任何数字外，没有任何效果。这不好，因为我需要 TextBlock 来填充可用宽度，不受某个固定数字的限制。谢谢！

```
<ItemsControl>
   <ItemsControl.ItemsPanel>
       <ItemsPanelTemplate>
           <StackPanel />
       </ItemsPanelTemplate>
   </ItemsControl.ItemsPanel>
   <ItemsControl.ItemTemplate>
       <DataTemplate>
           <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition MaxWidth="200" SharedSizeGroup="A" />
                <ColumnDefinition MaxWidth="200" SharedSizeGroup="B" />
            </Grid.ColumnDefinitions>

            <Label VerticalAlignment="Top" Margin="0 5 0 0" Grid.Column="0" Style="{StaticResource LabelStyle}" Width="Auto" Content="{Binding Value.Summary}" />
            <TextBlock Grid.Column="1" Margin="5,8,5,8" FontWeight="Normal"
                       Background="AliceBlue"
                       Foreground="Black" Text="{Binding Value.Description}" 
                       HorizontalAlignment="Stretch"
                       TextWrapping="Wrap" Height="Auto" />
           </Grid>
       </DataTemplate>
   </ItemsControl.ItemTemplate>
</ItemsControl> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:28:32.720

我试图通过将 Grid 元素之间的所有内容粘贴到 Kaxaml 来复制您的问题，但所有内容都按照您的预期进行包装。（我在您进行绑定的地方插入了常规字符串并删除了 Label 样式）。

可能是问题在树的更高层。

我建议将块粘贴到 Kaxaml 或类似内容中以测试并查看哪个父级破坏了您的 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-26T22:08:24.240

我提供了这个问题的答案，只是它使用的是 ListView 而不是 ItemsControl，但问题可能是一样的。您的 ItemPresenter 周围可能有一个 ScrollViewer，您需要编辑 ItemsControl 模板的副本。

[WPF ListView TextBlock TextWrapping](https://stackoverflow.com/questions/6825693/wpf-listview-textblock-textwrapping/6826449#6826449)

# apache - What is the source of /path/(null) requests?

> ID：539177
> 
> 赞同：2
> 
> 时间：2009-02-11T22:35:45.343
> 
> 标签：apache, internet-explorer-8

We are beginning to see requests in our Apache Logs in the form

> /abc/(null)

These requests all have MSIE 8.0 and Trident 4.0 in the User-Agent field. The requests began to appear when we hadn't deployed any changed code for several weeks.

What is the source of these requests? Is this a bug in MSIE 8?

What is a systematic way to determine if this is a browser bug, javascript library bug or an issue with our code?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T22:45:18.143

It's likely either a buggy browser, buggy plugin, or a bot. There are a *lot* of bots out there crawling websites (badly) and pretending to be browsers.

I wouldn't worry about it unless it's actually causing a problem.

Here's a discussion of the (null) requests and how to block them: [http://www.webmasterworld.com/apache/3837651.htm](http://www.webmasterworld.com/apache/3837651.htm)

# javascript - 传递给 cometd.subscribe() 的参数

> ID：539185
> 
> 赞同：1
> 
> 时间：2009-02-11T22:37:29.537
> 
> 标签：javascript, parameters, comet, cometd, bayeux

希望这不是一个*太*具体/太小的问题，但我想知道是否有人知道 dojo cometd subscribe() 函数的可能参数是什么？

我见过的几个例子表明两个参数

```
cometd.subscribe(channel, call_back); 
```

但是我见过的一些实现包括参数列表的布尔值和可能的对象，并且通读代码表明该函数可以处理 4 个参数。我正在尝试查看代码并查看它们最终的最终结果，但是整理代码需要一段时间 - 我希望这里有人可能知道一些如此晦涩的东西。

在一个稍微连接的线程上 - 有谁知道使用 cometd 的文档是否比在[cometdproject](http://cometdproject.dojotoolkit.org/documentation)找到的可怜的票价更多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:46:12.483

我见过的三个参数版本是 subscribe(channel, callBackRecipient, callBackMethod); 第二个参数是要向其发送消息的对象，第三个参数（如 2-arg 版本中的第二个）是要发送的方法。

也可以使用不同数量的参数调用 call_back 方法。根据[Mortbay 的文档](http://www.mortbay.org/jetty/jetty-6/apidocs/org/mortbay/cometd/BayeuxService.html#subscribe(java.lang.String,%20java.lang.String))，回调方法需要 2、3 或 4 个参数。

`myMethod(Client fromClient,Object data)
myMethod(Client fromClient,Object data,String id)
myMethod(Client fromClient,String channel,Object data,String id)` 

客户和渠道应该是显而易见的。data 是 publish() msg​​ 中的数据，id 是消息的唯一 ID。

# c# - Silverlight 2 中使用 C# 的动态网格

> ID：539198
> 
> 赞同：1
> 
> 时间：2009-02-11T22:41:13.817
> 
> 标签：c#, silverlight-2.0

我需要将 UIElements 插入到运行时才会生成的 Grid 中。更具体地说，在确定需要显示多少元素后，我需要将 UIElements 添加到我创建的 RowDefinitions 中。有没有办法像在 XAML 中一样为 C# 中的对象控制 Grid.Row 和 Grid.Column 和 Grid.RowSpan？如果我要解决这个问题，请告诉我。我不能使用 StackPanel（我正在创建一个动态手风琴面板，它与动画混淆）。

现在发生的事情是我在运行时生成了 RowDefinition 的数量并将 UIElements 添加为子元素。这是行不通的，所有的 UIElements 最终都在第一行中，彼此重叠。

这是我正在尝试的示例：

```
public partial class Page : UserControl
{
    string[] _names = new string[] { "one", "two", "three" };
    public Page()
    {
        InitializeComponent();
        BuildGrid();
    }
    public void BuildGrid()
    {
        LayoutRoot.ShowGridLines = true;
        foreach (string s in _names)
        {
            LayoutRoot.RowDefinitions.Add(new RowDefinition());
            LayoutRoot.Children.Add(new Button());
        }
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T23:14:34.657

除了 Grid 不是真正适合该工作的工具（ListView 将是）之外，您需要告诉 Button 它属于哪一行。

```
public void BuildGrid()
{
    LayoutRoot.ShowGridLines = true;
    int rowIndex = 0;
    foreach (string s in _names)
    {
        LayoutRoot.RowDefinitions.Add(new RowDefinition());
        var btn = new Button()
        LayoutRoot.Children.Add(btn);
        Grid.SetRow(btn, rowIndex);
        rowIndex += 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T23:28:37.807

执行您要查找的操作的最佳方法是遵循以下模式：

页面.xaml：

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <data:DataGrid x:Name="DataGridTest" />
    </Grid>
</UserControl> 
```

页面.xaml.cs：

```
public partial class Page : UserControl
    {
        string[] _names = new string[] { "one", "two", "three" };

        public Page()
        {
            InitializeComponent();
            BuildGrid();
        }

        public void BuildGrid()
        {
            DataGridTest.ItemsSource = _names;
        }
    } 
```

这会根据字符串数组的内容动态构建行。将来更好的方法是使用[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604(VS.95).aspx)，其中 T 实现了[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged(VS.95).aspx)。如果您从集合中删除或添加项目以及 T 的属性发生更改，这将通知 DataGrid 更新其行。

要进一步自定义用于显示内容的 UIElements，您可以使用[DataGridTemplateColumn](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridtemplatecolumn(VS.95).aspx)：

```
<data:DataGridTemplateColumn Header="Symbol">
    <data:DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding PutNameOfPropertyHere}" />
        </DataTemplate>
    </data:DataGridTemplateColumn.CellTemplate>
</data:DataGridTemplateColumn> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:45:37.473

我从未使用过这些东西，但您不应该将 Button 添加到 RowDefinitions 中，而不是 Children 中吗？（只是一个逻辑观察）

# svn - 如何获取存储库中所有 SVN 提交的列表以及谁对哪些文件做了什么？

> ID：539199
> 
> 赞同：35
> 
> 时间：2009-02-11T22:41:32.367
> 
> 标签：svn, version-control, repository

我需要得到一个列表，其中包含每个修改的所有修订和文件，以及由谁修改。

那可能吗？

我需要知道谁对 repo 所做的更改最多，以及哪些更改。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-11T22:49:59.303

在工作副本的根目录中，键入

```
svn log -v 
```

这会给你一切。如果这太多了，请使用`--limit`：

```
svn log -v --limit 100 
```

请参阅[SVN Book](http://svnbook.red-bean.com/)中的[log 命令](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.log.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T22:44:11.220

如果您使用的是[TortoiseSVN](http://tortoisesvn.net/)（在 Windows 上），那么您可以使用“显示日志”功能查看所有提交的列表。

在此对话框中，您还可以打开一些统计信息/图表，例如“每周提交次数”（针对每个用户）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T22:42:30.210

看看 svn log 和 svn blame。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T23:48:29.113

试试[Atlassian 的 FishEye](http://www.atlassian.com/software/fisheye/FishEyeDownloadCenter.jspa)演示。该工具可以为您提供您想要的所有关于您的回购的统计信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-14T04:10:36.393

我编写了一个名为“ [svnplot](http://code.google.com/p/svnplot) ”的工具（我承认它的灵感来自 StatSVN 的输出）。它是用 python 编写的，可以在 Google 代码中找到。[http://code.google.com/p/svnplot](http://code.google.com/p/svnplot)。[您可以在http://thinkingcraftsman.in/projects/svnplot/index.htm](http://thinkingcraftsman.in/projects/svnplot/index.htm)查看示例输出

基本上，它将 Subversion 日志历史转换为“sqlite”数据库，然后查询 sqlite 数据库以生成图形。您可以使用创建的 sqlite 数据库编写自己的查询。

看看它是否适合你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T22:46:22.463

```
svn log --verbose 
```

应该做的伎俩。[http://svnbook.red-bean.com/en/1.0/re15.html](http://svnbook.red-bean.com/en/1.0/re15.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-14T04:24:43.303

还可以查看[StatSVN](http://wiki.statsvn.org/)

> StatSVN 从 Subversion 存储库中检索信息并生成描述项目开发的各种表格和图表，例如代码行的时间表、每个开发人员的贡献等。当前版本的 StatSVN 生成包含表格和图表的 HTML 或 XDOC 文档的静态套件图片。
> 
> StatSVN 是开源软件，根据 LGPL 条款发布

# java-me - 无法通过带有 J2ME 的戴尔 axim pda 上的 COM 端口访问蓝牙设备

> ID：539200
> 
> 赞同：0
> 
> 时间：2009-02-11T22:41:59.057
> 
> 标签：java-me, bluetooth

我正在尝试编写 J2ME 应用程序的一部分，我负责从通过蓝牙连接的 GPS 设备（连接到 Dell Axim X51 PDA）读取 NMEA 数据。

我已经将 gps 设备与 PDA 配对，我可以运行 gps 设备附带的示例程序，它成功地流式传输 NMEA 字符串。

在系统设置中，在 GPS 设置中，我设置了一个 COM 端口 (8) 供程序用来获取 GPS 数据，但是，在提供 GPS 硬件端口的详细信息时，似乎没有匹配的波特率到我必须在示例程序中使用的那个？这有关系吗？波特率实际上是什么意思？

现在，据我了解设置，我现在应该能够通过 COM 8 读取 NMEA 数据了吗？

但是，当我打印出来时：

```
System.getProperty("microedition.commports") 
```

COM8 未出现在返回的列表中，如果我尝试在该端口上打开连接，则会收到以下错误：

```
java.io.IOException: GetCommState() failed; error code=21, (21) The device is not ready. 
```

任何有关成功设置 COM 端口以供读取并实际从中读取的指针都将受到欢迎。我很困惑，不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T11:12:16.070

您设备上的 j2me 实现很有可能根本不支持蓝牙 COM 端口。我建议先确认一下。在其他（最近的）手机上比较系统属性调用的结果可能是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T13:25:17.000

不知道那个特定的设备，但在 J2ME 中打开蓝牙 COM 端口的常用方法是使用[JSR-82 API](http://jcp.org/en/jsr/detail?id=82)。

您将扫描附近的设备，找出您的 GPS（通常在友好名称中包含“GPS”），扫描该设备上的服务（大多数 GPS 仅提供一个），然后打开与该服务的 BTSPP 连接。

# c++ - 在 Windows 中自动播放安装 CD 时，如何为 setup.exe 指定发布者

> ID：539218
> 
> 赞同：3
> 
> 时间：2009-02-11T22:46:53.757
> 
> 标签：c++, visual-studio, cd, autoplay

我有一张安装 CD 来安装我制作的 Visual Studio C++ 应用程序。自动播放弹出窗口显示“未指定发布者”以运行 setup.exe。如何指定发布者？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T22:50:00.207

您需要[使用数字证书对可执行文件进行签名](http://en.wikipedia.org/wiki/Code_signing)。这是为了验证可执行文件未被篡改并且来自发布者。

# asp.net - 从我的 GridView 行中取回对象

> ID：539224
> 
> 赞同：10
> 
> 时间：2009-02-11T22:48:34.470
> 
> 标签：asp.net, gridview

基本上，我想要我的对象回来......

我有一个电子邮件对象。

```
public class Email{
    public string emailAddress;
    public bool primary;
    public int contactPoint;
    public int databasePrimaryKey;

    public Email(){}
} 
```

在我的用户控件中，是电子邮件对象的列表。

```
public List<Email> EmailCollection; 
```

我将它绑定到我的用户控件中的 GridView。

```
if(this.EmailCollection.Count > 0){
    this.GridView1.DataSource = EmailCollection;
    this.GridView1.DataBind();
} 
```

*如果我以后可以从*GridView 中取回一个电子邮件对象，那将是非常棒的。

我该怎么做呢？

我也只将电子邮件对象的一些属性绑定到 GridView，并将它们放入项目模板中。

```
<Columns>

<asp:TemplateField HeaderText="Email Address">
    <ItemTemplate>
        <asp:TextBox ID="TextBox1" runat="server" Text=<%# Eval("EmailAddress") %> Width=250px />
    </ItemTemplate>
</asp:TemplateField>

<asp:TemplateField HeaderText="Primary">
    <ItemTemplate>
        <asp:CheckBox runat="server" Checked=<%# Eval("PrimaryEmail") %> />
    </ItemTemplate>
</asp:TemplateField>

<asp:TemplateField HeaderText="Contact Point">
    <ItemTemplate>
        <CRM:QualDropDown runat="server" Type=ContactPoint InitialValue=<%# Eval("ContactPoint") %> />
    </ItemTemplate>
</asp:TemplateField>

</Columns> 
```

GridView 甚至可以做到这一点吗？我需要滚动自己的东西吗？如果它能为我做这将是非常酷的。

* * *

要详细说明。

我将 List 集合保存到视图状态中。

我最终想要得到的是，控件中的某处是否会有一个保存按钮，当事件触发时，我想从 GridView 中的数据行创建一个电子邮件对象，以与我的原始列表集合进行比较. 然后，如果有变化，那么我会更新数据库中的那一行。我在想，如果我可以将一个 List 集合放入一个 GridView 中，那么也许我可以把它重新拿出来。

也许我为我的 Email 对象创建了一个新的构造函数，它需要一个 DataRow？但是其中有很多复杂性......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T22:57:39.317

就对象操作而言，ASP.NET 数据绑定是一种单向操作。但是，DataSource 属性将在整个响应中包含对您的 EmailCollection 的引用：

```
EmailCollection col = (EmailCollection)this.GridView1.DataSource; 
```

但我有一种感觉，您真正想要的是一个控件，该控件可以根据用户输入操作您的 EmailCollection 并*在下一个请求中*检索它。甚至网络表单也无法伪造这种开箱即用的状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T16:47:05.600

好吧，我最终遍历了我的 List EmailCollection，它被保存到 ViewState 中。

因此，在页面中，单击“保存”按钮，当事件被捕获时，我循环遍历我的列表集合并按索引从 GridView 中获取行。

在 GridViewRow 上，我必须使用 GridView1.Rows[i].Cells[j].FindControl("myControl1") 然后从中获取适当的值，无论是复选框、文本框还是下拉列表。

我确实看到 GridViewRow 对象有一个 DataItem 属性，其中包含我的 Email 对象，但它仅在 RowBound 阶段可用。

不幸的是，如果/当我稍后需要扩展此电子邮件集合时，通过添加或删除列，它将需要几个步骤。

```
protected void SaveButton_OnClick(object sender, EventArgs e){
    for (int i = 0; i < this.EmailCollection.Count; i++)
    {
        Email email = this.EmailCollection[i];
        GridViewRow row = this.GridView1.Rows[i];

        string gv_emailAddress = ((TextBox)row.Cells[0].FindControl("EmailAddress")).Text;
        if (email.EmailAddress != gv_emailAddress)
        {
            email.EmailAddress = gv_emailAddress;
            email.Updated = true;
        }
        ...
    }
} 
```

我仍然愿意接受更有效的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:03:01.393

如果您想保留这样的对象，最容易使用视图状态，尽管您将复制数据，但对于一个小对象应该没问题。

```
ViewState.Add("EmailObj", Email);

EMail email = (Email)ViewState["EmailObj"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T23:07:03.163

只是一个想法，基本上是你自己的，但做起来并不难：

将您用作数据源的列表存储在视图状态或会话中，并在 gridview 中有一个隐藏字段作为与该行匹配的对象的索引或键。

换句话说，gridview 中的每一行“知道”它所基于的列表中的哪个电子邮件对象。

# delphi - 删除表单上某个类的所有组件（Delphi）

> ID：539227
> 
> 赞同：12
> 
> 时间：2009-02-11T22:48:50.833
> 
> 标签：delphi, forms, components

这可能是一个愚蠢的问题，但我的大脑已经足够成熟了，我想我将使用我的一条“生命线”来看看我是否可以从我的堆栈溢出朋友那里获得一些帮助。;)

我需要在我的主窗体上删除所有出现的特定组件类型（其中一些在面板或标签页内，但都在同一个窗体上并由同一个窗体拥有）。这是我现在拥有的：

```
for i := 0 to frmMain.ComponentCount - 1 do  
  begin  
    if frmMain.Components[i] is TMyClass then frmMain.Components[i].Destroy;  
  end; 
```

问题是（我在编译它之前就知道会这样）一旦我销毁组件，表单的组件列表会重新索引，最终会超出范围。

解决这个问题的最佳方法是什么？我考虑过将“找到”的组件添加到一个独立的数组中，然后在这个循环之后通过它来删除它们，我认为这会起作用....但这是最好的方法吗？

TIA

* * *

更新：

你们真棒。谢谢。:)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-11T23:08:45.687

你几乎是对的。你的循环应该看起来像

```
for i := frmMain.ComponentCount - 1 downto 0 do
begin
  if frmMain.Components[i] is TMyClass then
    frmMain.Components[i].Free;
end; 
```

这样，对函数“frmMain.ComponentCount”的调用在开始时就完成了，而不是再次完成。

你也应该像上面那样调用 Free，而不是 Destroy——我现在不记得为什么了。布里

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-11T23:01:36.187

从顶部开始并向后工作。

即：

```
for i := frmMain.ComponentCount - 1 downto 0 do
begin
  if frmMain.Components[i] is TMyClass then frmMain.Components[i].Free;
end; 
```

调用免费而不是销毁。在检查有效参考后免费调用销毁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T12:59:38.590

在您的情况下可能不会发生这种情况，但`if frmMain.Components[i] is TMyClass`检查也将为`TMyClass`. 如果你真的想删除一个特定的类，你可能需要添加一个额外的`ClassName`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T08:26:29.010

带有while循环的相同解决方案：

```
i := 0;
while i < frmMain.ComponentCount do
begin
  if frmMain.Components[i] is TMyClass then
    frmMain.Components[i].Free 
  else
    inc(i);
end; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-12-23T22:33:36.693

对于表单或面板中的 Fine Contrle 可以使用此代码

```
var

 i:Integer;

begin

for i := 0 to Panel1.ControlCount - 1 do

  begin

    if Panel1.Controls[i] is TEdit then
       Tedit(Panel1.Controls[i]).text := '';

  end; 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2010-02-03T22:43:12.637

如果您需要检查和销毁命名的已知组件，请使用

```
If YourComponent <> Nil Then
  YourComponent.Free; 
```

# ide - How to use multiple tabs when tagging to a function in Vim

> ID：539231
> 
> 赞同：13
> 
> 时间：2009-02-11T22:50:07.993
> 
> 标签：ide, editor, vim, ctags

I use ctags with my Vim and I rely heavily on C-] and C-T to tag back and froth between various functions in my project.

But if the function is in a different file, I'd like Vim to automatically open it in a new tab instead of the current tab. If I pop my tag stack using the C-T, I'd like it go back to the original tab where I pressed by C-] instead of changing the file in the current tab. I don't like to have the same file opened in multiple tabs in Vim. This is the normal behavior for most IDEs and I am wondering if there is a way to do this in Vim?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T23:35:35.107

```
nmap <C-Enter> <C-w><C-]><C-w>T 
```

这有帮助吗？你可能会想出类似的东西来回程。

* * *

好吧，我们需要决定想要的行为是什么。我们可以返回原始选项卡（不确定如何，仍在调查），但上面给出的映射下次将打开一个新选项卡。所以一段时间后你会得到很多标签。

或者我们可以这样做`<C-w>C`，这将关闭打开的选项卡并带我们回到原来的选项卡。我个人更喜欢这种工作方式（这样我就不会失去我在文件中的位置）我转到我想要的函数，在那里进行更正，然后返回到我开始的原始文件。让我知道，你想要什么（这不适合评论，所以我把答案放在这里）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T23:19:30.747

这可能会为您指明正确的方向：

[`http://vim.wikia.com/wiki/Open_every_buffer_in_its_own_tabpage`](http://vim.wikia.com/wiki/Open_every_buffer_in_its_own_tabpage)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:04:00.313

So, this is a feature I would like to see as well.

I'm not sure if it's possible.

What I usually do is

:tabnew :tag *some*parts*of*function*

and press tab to use globbing to easily find tag.

Sure, it's not an ideal solution, but it works most of the time.

Unfortunately, with VIM tabbing isn't totally integrated since it's a new feature since 7.0\. Most people I know that use VIM weren't even aware of tabs until I told them, so with that, I have a feeling there is no way to do it right now.

(I would love to be proven wrong)

# .net - 在 .NET 上下文中使用 D 编程语言

> ID：539234
> 
> 赞同：14
> 
> 时间：2009-02-11T22:51:01.080
> 
> 标签：.net, interop, d

我很好奇：有人将 D 与 .NET 语言一起使用吗？这甚至可能吗？什么样的东西在 D 中更容易/更有意义，而在 C++/CLI 中很难做到？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-18T00:32:10.273

将 D 与 .NET 一起使用是非常可能的。原因：

*   .NET 能够使用[dllImport](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute(VS.71).aspx)属性导入非托管 C 库（导出 C 函数的 .dll）。
*   D 能够导出 C 函数。使用[export](http://www.digitalmars.com/d/1.0/attribute.html#ProtectionAttribute)和[extern (C)](http://www.digitalmars.com/d/1.0/attribute.html#linkage)属性

因此，考虑到技术细节，这是完全可能的。

关于 D 比 C++ 更容易的地方，答案相当简单：“一切”。从某种意义上说，D 实际上只是 C++ 的副本，几乎所有事情都做得更简单。当然，这只是一个半故事，但相当真实。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T23:18:04.900

[http://the-free-meme.blogspot.com/](http://the-free-meme.blogspot.com/)是一个致力于在 dot net 上获取 d 的人的博客。

编辑：

[nanu](http://dsource.org/projects/nanu)和[nono](http://dsource.org/projects/nono)是试图让 mono/D 工作的项目，但去年两者在 svn /trunk 中都没有任何变化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-17T19:13:42.400

[您可以通过使用 C 接口](http://www.d-programming-language.org/dll.html)创建 DLL 来调用 D DLL ，然后从 .NET 通过 P/Invoke 调用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-24T20:54:18.373

还有[D for .NET](http://dnet.codeplex.com/)，这是一种将 D 代码直接编译到[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)的方法。

其他答案是正确的，因为与本机实现共享代码也很容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-18T03:56:21.543

I believe D can call .NET assemlies visible via COM: [http://wiki.dlang.org/COM_Programming](http://wiki.dlang.org/COM_Programming).

# windows - VS2008 DBML 设计器和 Windows 7

> ID：539235
> 
> 赞同：3
> 
> 时间：2009-02-11T22:51:28.690
> 
> 标签：windows, visual-studio-2008, windows-7

不确定是否有人注意到这一点，但如果您在 Windows 7 下使用 DBML（尚不确定 EF）运行 Visual Studio 2008，则当您将鼠标悬停在它们上方时，表格将消失。寻找修复，所以我想我会问每个人，因为我已经看到它在评论中被问过，但还不是一个问题。

**编辑**

我已经[向 Microsoft 提交了一个错误](https://connect.microsoft.com/VisualStudio/feedback/details/415654/elements-in-dbml-designer-in-visual-studio-disappear-when-running-in-windows-7)。其他任何想要帮助修复它的人，请将其验证为错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T14:49:20.677

不太可能有可用的已发布修复程序。Windows7 仍然是非 RTM 产品，现有应用程序存在错误。由于问题更可能出现在 Windows 中而不是 Visual Studio，因此修复几乎肯定来自 Windows。

您最好的选择是在 Windows7 发布时升级到下一个版本，并希望它能永久解决该问题。

一个短期的解决方案是禁用 Aero，看看是否有帮助。我发现偶尔会为我修复图形问题。

**编辑**

即使在较新的 Win7 版本上，我也能够确认这种情况存在。这几乎可以肯定是 Windows 与 Visual Studio 中的一个错误。但是，如果您在 Visual Studio 上提交错误，则此错误将得到更快的处理。我在下面包含了错误链接。我将在内部跟进，但如果它是由客户提交的，这可能会更快地引起注意。

[http://connect.microsoft.com/VisualStudio](http://connect.microsoft.com/VisualStudio)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:56:09.547

有一个与Windows 7 RC 上的实体框架 EDMX 实体模型设计器[相关的错误。](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=441804)所以 DBML 设计器仍然坏掉了。

# deployment - 我必须在 Program Files 下构建我的 LabVIEW 仪器驱动程序吗？

> ID：539247
> 
> 赞同：4
> 
> 时间：2009-02-11T22:55:27.793
> 
> 标签：deployment, driver, labview

我正在尝试为我们销售的设备构建一个 LabVIEW 即插即用仪器驱动程序项目。我按照[说明创建了一个项目](http://zone.ni.com/reference/en-XX/help/371361H-01/lvhowto/creating_instproj/)，它使用 LabVIEW 程序创建了项目：

> C:\Program Files\National Instruments\LabVIEW 2011\instr.lib

我想我可以将该文件夹连接到源代码管理并在那里完成所有工作，但是在 Program Files 下工作感觉很奇怪。当我尝试将项目文件夹移到我的常规工作区文件夹中时，它破坏了所有子调色板文件 (*.mnu)。我可以重新创建它们，但是当我们的客户从 LabVIEW 网站安装驱动程序时，我担心它们无法为他们工作。

是否可以移动驱动程序项目，还是必须保留在默认位置？如果我们的一位客户已将 LabVIEW 安装在不同的位置（例如在驱动器 D:）上，驱动程序菜单是否对他们不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T18:46:24.840

对于 SCC 的项目，我不赞成 user.lib。一次使用多个 LabVIEW 版本是个大问题。这是我的日常：

1.  创建仪器库并将所有代码保存在以下划线 ('_') (_foo) 开头的文件夹中
2.  在 '_foo' Mylib.mnu 的父文件夹中创建一个 .mnu 文件，添加您需要的图标。
3.  使用 OpenG 包生成器，我创建了一个安装程序例程，将 mnu 文件和文件夹放在 instr.lib 中
4.  LabVIEW 重新启动后，仪器驱动程序将显示在仪器面板中。

如果将代码保持在与 mnu 文件相同的相对位置，则丢失 VI 没有问题。

吨

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T08:51:45.860

仪器驱动程序始终位于当前 LabVIEW 版本文件夹中的“instr.lib”文件夹中。在 LabVIEW 中为此仪器驱动程序文件夹设置了一个环境路径，因此它将始终指向正确的驱动器以用于安装 LabVIEW。

您应该将文件夹保存在向导使用的位置，以确保在分发给您的客户时，子选板菜单指向正确的位置，并且所有 VI 都正确链接。

我对 user.lib 使用源代码控制，它位于类似的位置并且没有问题。

# visual-studio - 多目标 Visual Studio 项目：一个源代码

> ID：539248
> 
> 赞同：1
> 
> 时间：2009-02-11T22:56:27.463
> 
> 标签：visual-studio, opengl-es, build-system

关于如何建立一个构建系统的任何建议，该系统将针对几个不同的平台/目标编译一个或两个库。

主要项目在 Visual Studio 中。

例如，我有一个库：

```
nav.lib 
```

它通过一些调整在 Windows 和 Linux 上编译。

使用该库的可执行文件 win_nav.lib 目前只能在带有 OpenGL 的 Windows 上编译。

我正在将此代码移植到 iPhone。虽然我知道我无法在 Windows 上编译和链接整个库，但我想尝试使用 OpenGL 包含和 OpenGLES 包含来编译图形代码。（也许我也可以在 Windows 机器上测试我的 opengles 代码？）

我计划根据预处理器标志更改我的图形文件以包含：

```
#ifdef USE_OPEN_GL_FULL
     #include <opengl/gl.h>
#else
     #include <opengles/gl.h>
#endif 
```

那么，你会怎么做呢？

在 Visual Studio 中使用几个不同的脚本或不同的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:40:03.070

这就是“解决方案配置”的用途。默认情况下，Visual Studio 创建发布和调试配置，但您也可以添加自己的自定义配置。每个配置的项目选项都不同，因此只需在需要的配置中设置#define。

当您运行自动构建时，您只需将 /build 参数设置为您要编译的配置的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T03:42:28.570

在 VS 中，您可以使用[配置管理器](http://msdn.microsoft.com/en-us/library/kwybya3w(VS.80).aspx)来定位不同的构建并在代码中使用不同的库。

# c++ - 从 C++ 结构字段中获取单个字段的大小

> ID：539251
> 
> 赞同：5
> 
> 时间：2009-02-11T22:57:07.023
> 
> 标签：c++, struct, field, sizeof

简短的版本是：如何学习 c++ 字段的单个字段的大小（以位为单位）？

为了澄清，我正在谈论的领域的一个例子：

```
struct Test {
    unsigned field1 : 4;  // takes up 4 bits
    unsigned field2 : 8;  // 8 bits
    unsigned field3 : 1;  // 1 bit
    unsigned field4 : 3;  // 3 bits
    unsigned field5 : 16; // 16 more to make it a 32 bit struct

    int normal_member; // normal struct variable member, 4 bytes on my system
};

Test t;
t.field1 = 1;
t.field2 = 5;
// etc. 
```

要获得整个 Test 对象的大小很容易，我们只是说

```
sizeof(Test); // returns 8, for 8 bytes total size 
```

我们可以通过

```
sizeof(((Test*)0)->normal_member); // returns 4 (on my system) 
```

我想知道如何获取单个字段的大小，例如 Test::field4。上面的普通结构成员示例不起作用。有任何想法吗？或者有人知道它不能工作的原因吗？我相当确信 sizeof 不会有帮助，因为它只返回以字节为单位的大小，但如果有人知道否则我会全神贯注。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T23:16:34.077

您可以在运行时计算大小，fwiw，例如：

```
//instantiate
Test t;
//fill all bits in the field
t.field1 = ~0;
//extract to unsigned integer
unsigned int i = t.field1;
... TODO use contents of i to calculate the bit-width of the field ... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T23:08:40.397

您不能获取`sizeof`一个位域并获取位数。

您最好的选择是使用`#define`s 或`enum`s：

```
struct Test {
    enum Sizes {
        sizeof_field1 = 4,
        sizeof_field2 = 8,
        sizeof_field3 = 1,
        sizeof_field4 = 3,
        sizeof_field5 = 16,
    };

    unsigned field1 : sizeof_field1;  // takes up 4 bits
    unsigned field2 : sizeof_field2;  // 8 bits
    unsigned field3 : sizeof_field3;  // 1 bit
    unsigned field4 : sizeof_field4;  // 3 bits
    unsigned field5 : sizeof_field5;  // 16 more to make it a 32 bit struct

    int normal_member; // normal struct variable member, 4 bytes on my system
};

printf("%d\n", Test::sizeof_field1); // prints 4 
```

为了保持一致性，我相信你可以移到`normal_member`顶部并在`Sizes`using中添加一个条目`sizeof(normal_member)`。但是，这会扰乱您的数据顺序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T23:10:48.020

似乎不太可能，因为 sizeof() 以字节为单位，并且您需要位。

[http://en.wikipedia.org/wiki/Sizeof](http://en.wikipedia.org/wiki/Sizeof)

基于位计数答案，您可以使用。

[http://www-graphics.stanford.edu/~seander/bithacks.html](http://www-graphics.stanford.edu/~seander/bithacks.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T00:54:12.360

使用[ChrisW 的想法](https://stackoverflow.com/questions/539251/getting-the-size-of-an-indiviual-field-from-a-c-struct-field/539307#539307)（很好，顺便说一句），您可以创建一个辅助宏：

```
#define SIZEOF_BITFIELD(class,member,out) { \
    class tmp_;                             \
    tmp_.member = ~0;                       \
    unsigned int tmp2_ = tmp_.member;       \
    ++tmp2_;                                \
    out = log2(tmp2_);                      \
}

unsigned int log2(unsigned int x) {
    // Overflow occured.
    if(!x) {
        return sizeof(unsigned int) * CHAR_BIT;
    }

    // Some bit twiddling...  Exploiting the fact that floats use base 2 and store the exponent.  Assumes 32-bit IEEE.
    float f = (float)x;
    return (*(unsigned int *)&f >> 23) - 0x7f;
} 
```

用法：

```
size_t size;
SIZEOF_BITFIELD(Test, field1, size);  // Class of the field, field itself, output variable.

printf("%d\n", size);  // Prints 4. 
```

我尝试使用模板化函数失败了。但是，我不是模板方面的专家，因此仍然*可以*使用干净的方法（例如`sizeof_bitfield(Test::field1)`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T23:06:08.030

这是不可能的

对评论的回答：因为类型只是一个 int，所以没有“位”类型。位域分配语法只是执行按位代码进行读写的简写。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T23:07:14.783

我不认为你能做到。如果你*真的*需要大小，我建议你使用一个`#define`（或者，更好的是，如果可能的话，一个`const`变量——我不确定这是否合法）：

```
#define TEST_FIELD1_SIZE 4
struct Test {
    unsigned field1 : TEST_FIELD1_SIZE;
    ...
} 
```

# c# - 从 C# 中的图像制作视频的工作方式

> ID：539257
> 
> 赞同：19
> 
> 时间：2009-02-11T23:00:08.263
> 
> 标签：c#, video, ffmpeg

有没有人知道从一系列图像文件创建视频的可靠方法？在您因为在发布问题之前不搜索答案而对我进行修改之前，以及在您发出诸如“使用 FFMPEG”之类的简单消息之前，请阅读此消息的其余部分。

我正在尝试从一系列图像（.jpg、.bmp 等）中创建视频，只要得到广泛支持，什么格式并不重要。我的平台是 Windows Server 2008，64 位。如果我可以在我的 C# 程序中制作视频，那就太好了，但我不反对将一系列图像文件写入目录，然后启动外部程序从这些图像制作视频。

唯一的限制是：它必须在我的 Windows Server 2008 系统上运行，并且可以编写脚本。也就是说，没有需要操作员干预的 GUI 程序。

我在 StackOverflow 上发现了许多类似的问题，并尝试了几种解决方案，都有不同程度的挫败感，没有一个能像成功一样成功。

FFMPEG 看起来像一个很棒的程序。也许是，在 Linux 上。我下载的两个 Windows 版本已损坏。鉴于此命令行：

```
 ffmpeg -r 1 -f image2 -i jpeg\*.jpg video.avi 
```

其中一个构建读取图像，然后由于数据执行阻止而崩溃。另一个读取第一个文件，然后吐出一条错误消息，上面写着“找不到适合文件 jpeg/image2.jpg 的编解码器”。有帮助，那个。在任何情况下，FFMPEG 在 Windows 下看起来都像是一个非入门者。

上一篇文章的一个答案是推荐[Splicer](http://www.codeplex.com/splicer)。它看起来很不错的代码。我编译了示例并尝试运行，但收到​​了一些关于未找到文件的神秘错误消息。看起来 COM 类没有注册。我想我需要安装一些东西（也许是 DirectShow，虽然我认为它已经安装了？）。根据需要，我可能很难证明它在服务器上的安装。（“什么？为什么在服务器上需要它？”）

另一个答案建议使用 Code Project 中的[AviFile](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)库。这看起来很简单：一个围绕 Windows AviFile 子系统的包装器。除了包创建的 AVI 文件似乎包含所有帧，但当我在 Windows Media Player 中播放 AVI 时，只显示第一帧。好吧，如果您尝试创建压缩视频，程序会引发异常。

所以，我想知道是否有一种好的、可靠的方法来做我想做的事情：在 Windows 系统上，通过 .NET API 或使用一系列图像创建 AVI 或其他常见视频文件格式外部程序。有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T21:21:07.027

在使用了一段时间并查看了 x264 和 VideoLan 之后，我回到了 Splicer。事实证明，神秘的错误消息是由于我的代码中的错误造成的。

看起来 Splicer 会做我想做的事：以编程方式从一系列图像创建视频。

感谢所有回复的人。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T04:51:24.130

您可以使用 VideoLan，我会推荐它。

我在 C# 应用程序中使用 VideoLan 做这两件事的直接经验：

1.  在我的 C# 应用程序中嵌入 VLC 查看器（VLC veiwer 有 3-4 个 C#“包装器”）。
2.  通过向其发送命令行参数，在单独的进程中使用 vlc.exe。

VideoLan 具有命令行界面这一事实是一件好事。VLC 支持禁用任何视觉元素的命令行选项；所以 VLC GUI 不会弹出，命令行窗口也不会弹出。因此，在 C# 应用程序中，您可以将与视频相关的工作外包给 VLC 客户端。C# 具有可以为您管理 vlc.exe 实例的 Process 类。它最终成为一个非常简洁的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T00:54:18.210

在 Windows 上处理视频（编码和播放）是一个真正的泥潭。.NET 根本不会帮助你——你总是要么成为 PInvoking/COM 互操作的原生 API，要么使用其他人构建的 .NET 包装器来做同样的事情。

无论如何，我不能说我已经使用过它，但一个不错的选择似乎[是作为 videolan 项目一部分的 x264 库](http://www.videolan.org/developers/x264.html)。这为您提供了一个独立的 C 库，您可以 PInvoke 并且您不必担心在您的服务器上安装和 DirectShow 垃圾。据我了解，它将生成可在 Flash 中播放的 H.264 格式视频。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T08:55:13.920

我使用[mplayer](http://www.mplayerhq.hu/)的 mencoder 从 Linux 上的 TGA 文件创建 AVI（使用编解码器 msmpeg4/mp3，默认情况下可使用 Windows Media Player 读取），如下所示：

```
mencoder mf://*.tga -mf fps=25:type=tga \
  -audiofile /tmp/test.mp3 -oac copy \
  -of lavf -ovc lavc \          
  -lavcopts vcodec=msmpeg4v2:mbd=2:mv0:trell:cbp:last_pred=3:vbitrate=3000 \
  -o /tmp/test.avi 
```

我知道 mplayer 确实有 Windows 版本。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-11-29T23:07:21.043

您可以将想要包含在视频中的所有图像复制到剪贴板，然后将其导入 Windows Live Movie Maker（当然是动态的！）并为您编译，而不是仅仅经历所有的麻烦！

所有这些都可以通过代码完成，但是这样，您不必自己创建它。正如您所说的平台是 Windows，并且所有 Windows 组合都安装了 Windows Live Movie Maker，因此对于使用您的应用程序的任何人来说这应该不是问题，除非

a) 他们卸载了 Windows Live Movie Maker

b) 他们正在使用运行 Windows 版本超过 8 或 9 年的计算机...

# text-editor - mac 上最好的免费文本编辑器是什么？FTP？

> ID：539259
> 
> 赞同：0
> 
> 时间：2009-02-11T23:00:26.110
> 
> 标签：text-editor, dreamweaver

我即将杀死dreamweaver...我真的很想找到一些流畅和方便的东西（我沉迷于dreamweaver 中的内部FTP 内容）。

帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T23:11:26.897

它不是免费的，但我认为共识选择是[TextMate](http://macromates.com/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T23:04:33.433

[Smultron](http://www.tuppis.com/smultron/)是开源的，非常好。虽然可能不如 DreamWeaver 功能全面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T23:11:43.930

我使用[TextWrangler](http://www.barebones.com/products/textwrangler/)。它还具有内部 FTP。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T23:14:30.163

我想如果你想尝试像dreamweaver 这样的东西，只有更轻的，试试[Coda](http://www.panic.com/coda)。它有很多 CSS 东西，一个终端，通过 FTP 远程同步。这是一个非常Mac的体验。这些天，当我有机会时，我确实喜欢使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T00:06:45.547

如果您正在寻找一个良好的 GUI 支持的免费 IDE，我建议您使用[TextWrangler 。](http://www.barebones.com/products/textwrangler/)许多程序员喜欢它。我还看到很多人在使用[Smultron](http://www.tuppis.com/smultron/)（尽管我自己从未使用过）。

我也会考虑尝试学习如何使用 vim 或 emacs。我已经学习 vim 几个月了，发现它非常有益。它有一些*非常*强大的功能，几乎可以在任何地方找到（即使我通过 SSH 弹出！）

虽然，我想每个人都会告诉你，[TextMate](http://macromates.com/)被广泛认为是最好的文本编辑器。事实上，这基本上是我购买 Mac 的原因。

您可能还需要考虑以下内容（尽管不是免费的）：

1.  [编辑](http://www.barebones.com/products/bbedit/)
2.  [结尾](http://www.panic.com/coda/)
3.  [浓咖啡](http://macrabbit.com/espresso/)
4.  [SubEtha编辑](http://www.codingmonkeys.de/subethaedit/)

- 编辑 -

您还可以查看 Mozilla 新发布的[Bespin](http://bespin.mozilla.com)。非常实验性但值得一看:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T23:38:34.803

我是真正的 emacs 宗教的追随者。它是免费的，并且有一个在 UI 中本机运行的 mac 版本......

但是话又说回来，我已经花时间克服了学习曲线，并且喝了kool-aid，所以，根据需要加盐...

哦，还有，它对 FTP 的处理很好......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T23:11:25.647

虽然只有试用版是免费的，但 BBEdit 和 TextMate 都是出色的文本编辑器，而且价格合理。

两者都具有全面的语法突出显示并支持多种语言（包括 HTML 和 CSS），并且都支持处理 FTP 站点上的文件。

我更喜欢TextMate，但我倾向于使用BBEdit，因为它具有更好的打印功能，而且我经常发现自己打印硬拷贝以供参考。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T04:14:38.687

如果您是 Emacs 粉丝，请尝试[Aquamacs](http://aquamacs.org/)，一个 Aqua 风格的 Emacs 版本。我使用它是因为我不必学习奇怪的 Emacs 命令来退出或保存 - Aquamacs 使用传统的 Mac 热键来退出/保存/打开/新建。Emacs 热键以及下拉菜单仍可用于更复杂的功能。此外，它还具有完全开发的 Emacs 语法突出显示功能。我不知道您使用的是什么语言，但我从经验中知道它对 Perl 非常有用。

编辑：不了解内部 FTP。Emacs 可能有它。看起来，如果任何文本编辑器都有一个特性，那么 Emacs 应该。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-22T18:27:05.343

文本编辑器有很多可用的选项。

1.  文本牧马人
2.  Emacs
3.  Aquamacs
4.  麦克维姆
5.  文本编辑

他们都是免费的。但我个人更喜欢TextWrangler。它兼容 HTML/PHP 和其他流行的编程语言。

# powershell - 从在自定义运行空间中执行的 PowerShell 启动应用程序，保持应用程序运行，完成脚本？

> ID：539271
> 
> 赞同：3
> 
> 时间：2009-02-11T23:04:03.357
> 
> 标签：powershell

我有一个自定义 PowerShell 运行空间，我从中执行一个脚本（简化）：

```
Pipeline pipeline = myRunSpace.CreatePipeline(@"c:\temp\Myscript.ps1");
Collection<PSObject> results = pipeLine.Invoke(); 
```

在我做的脚本中：

```
# c:\temp\MyScript.ps1
notepad.exe 
```

现在`Invoke()`在记事本关闭时返回。

有没有办法启动应用程序，保持应用程序运行但完成脚本代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T00:13:38.930

在脚本中你可以做

```
[Diagnostics.Process]::Start("notepad.exe") 
```

# coldfusion - JDK 6u14 Garbage First (G1) 垃圾收集器是否适合 JRun？

> ID：539272
> 
> 赞同：1
> 
> 时间：2009-02-11T23:04:10.843
> 
> 标签：coldfusion, jvm, jdk1.6, jrun, g1gc

垃圾优先 (G1) 垃圾收集器 [http://weblogs.java.net/blog/opinali/archive/2009/02/here_comes_jdk.html](http://weblogs.java.net/blog/opinali/archive/2009/02/here_comes_jdk.html)

你认为这个垃圾收集器更适合运行 ColdFusion 8 的 JRun 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T12:58:14.070

我会告诉你，在 ColdFusion 中更新 JVM 是一件轻而易举的事，所以我总是在最新的 JVM 发布一个月后更新它。到目前为止，我对任何版本都没有任何问题，而且 ColdFusion 似乎在每次更新时都变得更快了。

也就是说，您应该始终首先在测试机器上更新 JVM 并运行您的测试以确保没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:02:28.073

[http://blog.alagad.com/2009/06/18/the-g1-garbage-collector/](http://blog.alagad.com/2009/06/18/the-g1-garbage-collector/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T02:22:30.513

G1 在[Java 6 更新 14](http://java.sun.com/javase/6/webnotes/6u14.html#hotspot14.0-G1-6u14)中可用。从技术角度来看，这可能是一个不错的选择，但在此版本中，它有以下奇怪的限制：

> 尽管 G1 可在此版本中使用，但请注意，仅在购买了 Java 支持合同的情况下才允许 G1 的生产使用。通过 Sun 的 Java Platform Standard Edition for Business 程序支持 G1。

InfoQ 猜测这只是 Sun（现在的 Oracle）为了赚钱而进行的短期限制还是长期尝试：Sun[是否仅提供带有付费支持合同的新 G1 垃圾收集器？](http://www.infoq.com/news/2009/06/g1-paid)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2011-06-21T19:22:25.147

这是您正在寻找的解决方案，请阅读垃圾收集器：

[http://training.figleaf.com/curriculum/upload/AdminCF800_Unit05_configuringPerformance.pdf](http://training.figleaf.com/curriculum/upload/AdminCF800_Unit05_configuringPerformance.pdf)

（参见第 5-10 页）

```
<cfscript>
    obj = createObject("java", "java.lang.System");
    obj.gc();
    obj.runFinalization();
</cfscript> 
```

# c# - 用户控件对齐

> ID：539282
> 
> 赞同：0
> 
> 时间：2009-02-11T23:07:22.710
> 
> 标签：c#, asp.net, user-controls

我有一个看起来像这样的 ASP.Net UserControl：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="WebUserControl1.ascx.cs"
    Inherits="WebApplication2.WebUserControl1" %>
    <table>
        <tr>
            <td>
                <asp:Image ID="Image1" runat="server" Width="100" Height="100" ImageUrl="~/Logo.png" />
            </td>
        </tr>
        <tr>
            <td>
                Test
            </td>
        </tr>
    </table> 
```

此外，我有一个 ASP 网络表单：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication2._Default" %>
<%@ Register Tagprefix="uc1" Tagname="uc1" Src=".\WebUserControl1.ascx" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <span>
        <asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder>
    </span>
    </form>
</body>
</html> 
```

当我在运行时添加几个用户控件时，使用：

```
protected void Page_Load(object sender, EventArgs e)
{
    for (int i = 0; i < 5; i++)
    {
        var test = LoadControl(@"~\WebUserControl1.ascx");
        PlaceHolder1.Controls.Add(test);    
    }

} 
```

它们被添加到占位符中，但在另一个下方对齐。我希望它们一个挨一个地放置。这可能吗？如果可以，怎么做？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T23:16:38.757

让你的桌子浮动：对，例如：

```
<table style="float:left">
    ...
</table> 
```

或者更简洁的解决方案：在用户控件的内容周围放置一个 div 并将 div 设置为 float:right:

```
<%@ Control Language="C#" ... %>
<div style="float:right">  
<table>
  ...
</table>
</div> 
```

顺便说一句：如果页面不够宽，无法在一行中显示所有表格，那么使用此解决方案，它们将被换行。

# iphone - iPhone EDGE/3G网口范围？有人知道吗？

> ID：539284
> 
> 赞同：1
> 
> 时间：2009-02-11T23:08:26.420
> 
> 标签：iphone, networking, sockets, asyncsocket

我正在尝试在我的 iPhone 应用程序中访问 61616，并且 SCReachability 代码表明我有一个有效的网络，但我尝试写入 61616 时超时。有谁知道：

A. 如果 iPhone EDGE/3G 网络的端口范围有限或不允许连接到此端口？

B. 我如何明确地检查对该端口的访问。这是我的“网络可达”代码（借用自 Apple 的示例），它检查“foo.bar.com”，但没有显示如何检查“foo.bar.com:61616”。

任何帮助表示赞赏！

```
- (BOOL)isDataSourceAvailable{
static BOOL checkNetwork = YES;
BOOL _isDataSourceAvailable = NO;
if (checkNetwork) { // Since checking the reachability of a host can be expensive, cache the result and perform the reachability check once.
    checkNetwork = NO;

    Boolean success;    
    const char *host_name = "foo.bar.com";

    SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(NULL, host_name);
    SCNetworkReachabilityFlags flags;
    success = SCNetworkReachabilityGetFlags(reachability, &flags);
    _isDataSourceAvailable = success && (flags & kSCNetworkFlagsReachable) && !(flags & kSCNetworkFlagsConnectionRequired);
    CFRelease(reachability);
}
return _isDataSourceAvailable; 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T01:36:49.207

SCNetworkReachability API 只检查地址是否可以路由到。引用文档：

> “可达性”反映了应用程序发送到网络堆栈中的数据包是否可以离开本地计算机。请注意，可达性并不能保证数据包会真正被主机接收。

这与 NAT 或端口限制无关。路由基于地址而不是端口。因此，您（通过 SCNetworkReachability API）所能找到的只是您是否可以（理论上）到达机器的界面。它不会尝试在某个端口上建立连接。

因此，为了确定该服务是否可用，您必须尝试自己进行测试。最好是当 SCNetworkReachability API 告诉您可以建立连接时。只需尝试连接到端口 61616 上的服务器，看看您是否获得连接或超时。正确的超时值和处理在这里至关重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-15T19:40:21.087

这不仅因承运人而异，而且因合同而异。例如，在英国，O2 仅将互联网访问限制为按使用付费客户的网址（大概是端口 80 和 443，但我没有检查），但允许或多或少的免费访问合同。（我希望它对 iPhone PAYG 客户更加开放。）

我认为这样做的实际结果是，您不能假设可以访问世界各地的高端口。

我不确定是否有一种简单的方法可以检查特定端口是否打开，您最好的选择可能是使用“合理”超时。当然，有很多原因可能会导致超时，因此您的错误必须是适当的模糊。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T09:31:10.603

如果您的 iPhone 通过 EDGE/Mobile 连接，它可能位于 NAT 网关后面，因此您无法联系到它。至少 T-Mobile Germany 就是这种情况。iPhone 通过 T-Mobile (172.16.xx) 获得 RFC IP 地址。

我会用连接到本地 WiFi 网络的 iPhone 对其进行测试，并且如果可能的话，通常以 iPhone 联系服务器然后服务器可以与手机通信的方式设计应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T13:50:40.777

您是否尝试从外部机器联系您的 iPhone？

那可能行不通。通常，GPRS/EDGE/UMTS 基础设施会阻止传入连接。否则，移动用户可能会为他没有请求的不需要的流量付费。（想象一下有人在接下来的六周内每秒 ping 你的 iPhone 一次。你会为此付出代价的......）

解决方案是建立从移动设备到远程机器的连接，然后让远程机器将其用于流量。

# .net - 将泛型集合转换为基本类型

> ID：539287
> 
> 赞同：6
> 
> 时间：2009-02-11T23:09:16.120
> 
> 标签：.net, generics, collections

我有一个`IList<DerivedClass>`我想转换的，`ICollection<BaseClass>`但是当我尝试显式转换时，我得到`null`. 是否可以在不创建和填充新集合的情况下做到这一点？

**编辑：** 由于我只想从集合中读取，我切换到使用通用方法：

```
public void PopulateList<BaseClass>(ICollection<T> collection) 
```

然后我可以通过它一个`IList<DerivedClass>`. 是否有缓存此列表的好方法，以便我可以在需要时刷新它。我的第一个倾向是使用：

```
Object cachedCollection;
Type cachedType;
public void PopulateList<BaseClass>(ICollection<T> collection) {
    cachedCollection = collection;
    cachedType = T;

    // other stuff...
}

private void Refresh() {
    PopulateList<cachedType>(cachedCollection as ICollection<cachedType>);
} 
```

有没有人有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T23:22:17.383

最简洁的答案是不。” 您需要使用新的 BaseClass 类型创建一个新集合并填充它。

如果你仔细想想，这是有道理的。如果您可以简单地将您的集合“转换”为 BaseClass，那么您可以将“BaseClass”类型的东西粘贴到其中，从而将一个简单的 BaseClass 对象强制转换为 DerivedClass 集合。这将破坏创建具有类型安全性的集合的目的。

在极端情况下，如果您有两个派生类 Foo 和 Bar，您可以通过将集合类型强制转换回 BaseClass 的集合来强制 Bar 对象进入 Foo 对象的集合。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T23:38:55.923

这称为协方差，虽然目前.net 中的泛型不支持，但它将被添加到 4.0 框架中（以及相反的反方差）。

这个来自 PDC 2008 的优秀视频是 Anders Hejlsberg 提供的关于 C# 期货的会议：

[http://channel9.msdn.com/pdc2008/TL16/](http://channel9.msdn.com/pdc2008/TL16/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T23:25:14.023

我认为这是不可能的，而且确实不应该是：

```
class BaseClass {}
class DerivedClass : BaseClass {}
class OtherClass : BaseClass {}

void test()
{
  List<DerivedClass> list = new List<DerivedClass>();
  slice(list); //you want to do this
}

void slice(IList<BaseClass> list)
{
  //yikes! adding OtherClass to List<DerivedClass>
  list.Add(new OtherClass());
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T23:36:08.270

不支持在派生类和基类的通用容器之间切换。（它确实适用于数组）可以编写一个类型转换器来合理地干净地执行切换，而无需在列表之间手动复制元素。

查看此链接以了解问题/限制和解决方案的描述： [http ://www.25hoursaday.com/weblog/CommentView.aspx?guid=AF7AA888-A227-454C-8687-71FA77186064](http://www.25hoursaday.com/weblog/CommentView.aspx?guid=AF7AA888-A227-454C-8687-71FA77186064)

底部是一个不错的通用版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-22T22:55:55.117

如果 .NET 3.5 是一个选项，您可以使用`Cast<T>`扩展方法获取集合`System.Core.dll`的只读属性：`IEnumerable<T>`

```
using System.Linq;
...
private void Refresh() {
  PopulateList( cachedCollection.Cast<cachedType>( ) );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-10T11:55:47.030

您可以将每个元素转换为新的迭代器：

```
var collectionOfBase = (collectionOfDerived as IEnumerable).Cast<BaseClass>(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-25T13:00:05.710

```
ICollection<DerivedClass> cachedCollection;
Type cachedType;

public void PopulateList<BaseClass>(ICollection<T> collection) {
    cachedCollection = collection;
    cachedType = T;

    // other stuff...
}

private void Refresh() {
    PopulateList<cachedType>(cachedCollection.ToArray());
} 
```

打电话`cachedCollection.ToArray()`对我有用。

# java - 写入性能最佳的嵌入式 SQL 数据库？

> ID：539288
> 
> 赞同：5
> 
> 时间：2009-02-11T23:09:22.220
> 
> 标签：java, database, sqlite, firebird, embedded-database

有没有人对流行的开源嵌入式 SQL DB 的性能进行任何基准测试/评估，尤其是写入性能？我对 sqlite、Firebird Embedded、Derby 和 HSQLDB 进行了一些 1:1 的比较（我错过了其他的？），但没有进行全面的比较......另外，我会对其中任何一个的整体开发人员体验感兴趣（对于 Java 应用程序）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T13:00:53.063

查看[H2 网站](http://www.h2database.com/html/performance.html)上的比较。

我将它用于[我的 Eclipse 插件](http://www.nwiresoftware.com/)，我对它非常满意。嵌入式使用速度极快，非常易于使用（一个 JAR），强大的社区支持，强烈推荐。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T02:10:01.070

[来自 db4o 的](http://hsqldb.org/PolePosition.pdf)这个基准测试可能会有所帮助。它包括 JavaDB（建立在 Derby 之上）、HSQLDB、SqlLite。

似乎 HSQLDB 的表现优于其对应物，尤其是在编写方面。H2作为HSQLDB的继承者，在读写上都比HSQLDB快，具有优化、集群、事务隔离等特性。

# open-source - 将 GPL 应用程序重新命名为 SaaS

> ID：539291
> 
> 赞同：9
> 
> 时间：2009-02-11T23:10:05.480
> 
> 标签：open-source, gpl, saas

只是一个简单的问题，因为我对 GPL 的工作原理有点不确定。假设我正在开发一个托管的软件即服务应用程序，并且我发现了一个免费的 GPL 应用程序，它可以完成我自己编写的 90% 的工作。我可以吗：

A) 从应用程序中获取代码，通过更改名称和/或徽标来重新命名，并且在*不*修改任何一行代码的情况下，将其作为托管服务出售给人们？我是否必须说“我们正在使用`Project X`”之类的内容并带有指向其网站的链接？或者除非我想让他们知道，否则没有人必须知道我正在使用开源应用程序？

B）更改应用程序的结构，添加我自己的东西（例如，原始应用程序没有的额外模块）并且**如果**应用程序只会被托管，则不要将代码合并回主分支，并且不分发给人们？

C) 完全废弃前端并使用另一种技术（例如 Flex）编写我自己的代码，但使用现有代码（可能按照上面的场景 B 进行修改）作为后端？

我可以做这些吗？他们都是？我真的不是 100% 确定，但如果有一个开源应用程序已经完成了我的项目的大部分工作，那么不得不重新发明轮子似乎是一种耻辱；能够接受并添加到它以提供更好的解决方案似乎要容易得多。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T23:12:54.973

IANAL，我也不在网上玩。在进行此类操作之前，请在您的管辖范围内获得合格的法律建议。

A) 是的，不，是的。B) 是的。C) 是的。

现在，至于做所有这些事情是否*道德，好吧，这是一个不同的问题。*我预计如果您不回馈您的更改（这不符合 GPL 的精神），但提供程序的输出（HTML 等）不被视为重新分发，人们可能会感到不安。另一方面，AGPL 确实有这个限制，要完全停止这种事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T23:15:33.983

如果您公开重新分发您的软件，GPL 要求您在 GPL 下交付整个应用程序的源代码。你没有这样做，所以你不必这样做。像谷歌和雅虎这样的公司可以方便地利用这一点。

# macos - 如何确定 OS X 中的文件编码？

> ID：539294
> 
> 赞同：199
> 
> 时间：2009-02-11T23:11:05.383
> 
> 标签：macos, encoding, latex, utf-8

我正在尝试将一些 UTF-8 字符输入到[TextMate](http://en.wikipedia.org/wiki/TextMate)中的 LaTeX 文件中（它说它的默认编码是 UTF-8），但 LaTeX 似乎不理解它们。

运行`cat my_file.tex`在终端中正确显示字符。运行`ls -al`显示了我以前从未见过的东西：文件列表中的“@”：

```
-rw-r--r--@  1 me      users      2021 Feb 11 18:05 my_file.tex 
```

（而且，是的，我`\usepackage[utf8]{inputenc}`在 LaTeX 中使用。）

我找到了`iconv`，但这似乎无法告诉我编码是什么——它只有在我弄清楚后才会转换。

* * *

## 回答 #1

> 赞同：492
> 
> 时间：2010-03-17T09:47:52.400

在命令上使用`-I`(that's a capital i) 选项`file`似乎显示了文件编码。

```
file -I {filename} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-02-25T14:33:12.170

在 Mac OS X 中，`file -I`只要您正在测试的文件包含基本 ASCII 范围之外的字符，命令（大写 i）就会为您提供正确的字符集。

例如，如果您进入终端并使用 vi 创建文件，例如。`vi test.txt` 然后插入一些字符并包含一个重音字符（尝试 ALT-e 后跟 e）然后保存文件。

他们输入`file -I text.txt`，你应该得到这样的结果：

`test.txt: text/plain; charset=utf-8`

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-02-11T23:21:30.677

这`@`意味着该文件具有与其关联的扩展文件属性。`getxattr()`您可以使用该功能查询它们。

没有确定的方法来检测文件的编码。阅读[这个](https://stackoverflow.com/questions/90838/how-can-i-detect-the-encodingcodepage-of-a-text-file)答案，它解释了原因。

有一个命令行工具[enca](http://linux.die.net/man/1/enca)可以尝试猜测编码。你可能想检查一下。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2015-11-11T05:00:01.810

```
vim -c 'execute "silent !echo " . &fileencoding | q' {filename} 
```

在我的 bash 配置中的某处别名为

```
alias vic="vim -c 'execute \"silent \!echo \" . &fileencoding | q'" 
```

所以我只是输入

```
vic {filename} 
```

在我的香草 OSX Yosemite 上，它产生的结果比“file -I”更精确：

```
$ file -I pdfs/udocument0.pdf
pdfs/udocument0.pdf: application/pdf; charset=binary
$ vic pdfs/udocument0.pdf
latin1
$
$ file -I pdfs/t0.pdf
pdfs/t0.pdf: application/pdf; charset=us-ascii
$ vic pdfs/t0.pdf
utf-8 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2011-05-26T22:59:44.937

您还可以使用以下命令从一种文件类型转换为另一种文件类型：

```
iconv -f original_charset -t new_charset originalfile > newfile 
```

例如

```
iconv -f utf-16le -t utf-8 file1.txt > file2.txt 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-11-04T13:51:39.777

只需使用：

```
file -I <filename> 
```

就是这样。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-02-04T05:58:37.477

在 OS X 上使用带有选项（例如）而不是 -I 选项的`file`command并具有省略 mime 类型“text/plain”的额外好处，您可能不关心它。`--mime-encoding``file --mime-encoding some_file.txt`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-11T23:48:11.130

经典的 8 位 LaTeX 可以使用的 UTF8 字符非常有限；它高度依赖于您使用的字体的编码以及该字体可用的字形。

由于您没有给出具体示例，因此很难确切知道问题出在哪里 - 无论您是尝试使用字体没有的字形，还是一开始没有使用正确的字体编码地方。

这是一个最小的示例，展示了如何在 LaTeX 文档中使用几个 UTF8 字符：

```
\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\begin{document}
‘Héllø—thêrè.’
\end{document} 
```

您可能对 [utf8x] 编码有更多的运气，但请注意它不再受支持，并且与 [utf8] 相比有一些特质（据我记得；我已经有一段时间没有看过它了）。但如果它成功了，那对你来说就是最重要的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-12T06:38:08.740

@ 符号表示文件具有[扩展属性](http://arstechnica.com/apple/reviews/2005/04/macosx-10-4.ars/7)。`xattr file`显示它具有`xattr -l file`的属性，也显示属性值（有时可能很大——例如，尝试`xattr /System/Library/Fonts/HelveLTMM`查看资源叉中存在的旧式字体）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-08T09:50:05.137

在终端中键入`file myfile.tex`有时可以使用一系列算法和幻数告诉您文件的编码和类型。它相当有用，但不要依赖它提供具体或可靠的信息。

文件`Localizable.strings`（在本地化的 Mac OS X 应用程序中找到）通常报告为 UTF-16 C 源文件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-18T04:00:16.053

[合成它！](http://www.synalysis.net)允许比较[ICU 库](http://icu-project.org)提供的所有编码中的文本或字节。使用该功能，您通常会立即看到哪个代码页对您的数据有意义。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-04T23:36:27.543

您可以尝试将文件加载到 Firefox 窗口中，然后转到查看 - 字符编码。文件的编码类型旁边应该有一个复选标记。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-06-09T19:58:27.557

我实现了下面的 bash 脚本，它对我有用。

它首先尝试从to`iconv`返回的编码。`file --mime-encoding``utf-8`

如果失败，它会遍历所有编码并显示原始文件和重新编码文件之间的差异。它跳过产生大差异输出的编码（由`MAX_DIFF_LINES`变量或第二个输入参数定义的“大”），因为这些很可能是错误的编码。

如果由于使用此脚本而发生“坏事”，请不要怪我。那里有一个`rm -f`，所以有怪物。我试图通过在带有随机后缀的文件上使用它来防止不利影响，但我没有做出任何承诺。

在达尔文 15.6.0 上测试。

```
#!/bin/bash

if [[ $# -lt 1 ]]
then
  echo "ERROR: need one input argument: file of which the enconding is to be detected."
  exit 3
fi

if [ ! -e "$1" ]
then
  echo "ERROR: cannot find file '$1'"
  exit 3
fi

if [[ $# -ge 2 ]]
then
  MAX_DIFF_LINES=$2
else
  MAX_DIFF_LINES=10
fi

#try the easy way
ENCOD=$(file --mime-encoding $1 | awk '{print $2}')
#check if this enconding is valid
iconv -f $ENCOD -t utf-8 $1 &> /dev/null
if [ $? -eq 0 ]
then
  echo $ENCOD
  exit 0
fi

#hard way, need the user to visually check the difference between the original and re-encoded files
for i in $(iconv -l | awk '{print $1}')
do
  SINK=$1.$i.$RANDOM
  iconv -f $i -t utf-8 $1 2> /dev/null > $SINK
  if [ $? -eq 0 ]
  then
    DIFF=$(diff $1 $SINK)
    if [ ! -z "$DIFF" ] && [ $(echo "$DIFF" | wc -l) -le $MAX_DIFF_LINES ]
    then
      echo "===== $i ====="
      echo "$DIFF"
      echo "Does that make sense [N/y]"
      read $ANSWER
      if [ "$ANSWER" == "y" ] || [ "$ANSWER" == "Y" ]
      then
        echo $i
        exit 0
      fi
    fi
  fi
  #clean up re-encoded file
  rm -f $SINK
done

echo "None of the encondings worked. You're stuck."
exit 3 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-11T23:31:42.823

您使用的是哪种 LaTeX？当我使用 teTeX 时，我必须手动下载[unicode](http://www.ctan.org/tex-archive/macros/latex/contrib/unicode/)包并将其添加到我的 .tex 文件中：

```
% UTF-8 stuff
\usepackage[notipa]{ucs}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc} 
```

[现在，我已经从 TeXlive 2008 包（这里](http://www.tug.org/mactex/)）切换到 XeTeX ，它更加简单：

```
% UTF-8 stuff
\usepackage{fontspec}
\usepackage{xunicode} 
```

至于检测文件的编码，你可以玩`file(1)`（但它相当有限）但就像其他人说的那样，这很困难。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-11T23:38:32.977

检查编码的蛮力方法可能只是在十六进制编辑器或类似工具中检查文件。（或编写程序检查）查看文件中的二进制数据。UTF-8 格式相当容易识别。所有 ASCII 字符都是单字节，其值低于 128 (0x80) 多字节序列遵循[wiki 文章中显示的模式](http://en.wikipedia.org/wiki/Utf-8#Description)

如果您能找到一种更简单的方法来让程序为您验证编码，那显然是一种捷径，但如果一切都失败了，这将起到作用。

# java - 如何在另一个 servlet 的 init() 方法中使用一个 servlet 的输出？

> ID：539298
> 
> 赞同：1
> 
> 时间：2009-02-11T23:12:52.837
> 
> 标签：java, servlets, jakarta-ee

这是我正在尝试做的事情：

```
public void init(ServletConfig config) {
    // ...
    URL url = new URL("http://myhost:port/path/to/otherservlet");
    // ... do stuff with contents of url
} 
```

这很好用，但是 myhost 和 port 是硬编码的，我想避免这种情况。我想

```
URL url = new URL("/path/to/otherservlet"); 
```

但这无效。我也试过

```
config.getServletContext().getResource("/path/to/otherservlet"); 
```

但这仅适用于静态文件。

如何使用获取一个 servlet 的结果来初始化另一个？我不想使用 RequestDispatcher 的 forward() 或 include() 方法—— otherservlet 的结果旨在用于 init() 方法，而不是在响应中发送。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T23:21:30.647

如果可能的话，我认为更好的方法是将另一个 servlet 的代码重构为一个可以直接调用以获得所需输出的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T00:58:19.090

我不会惊讶地发现它无法完成。我认为托比的回答（将代码拆分成一个公共类）是最好的方法，但如果这真的不可能，请尝试将用于本地请求的主机和端口编码为服务器`web.xml`文件中的上下文参数：

```
<context-param>
    <param-name>localhost</param-name>
    <param-value>localhost</param-value>
</context-param>
<context-param>
    <param-name>localport</param-name>
    <param-value>8080</param-value>
</context-param> 
```

并使用 etc 获取值`context.getInitParameter("localhost")`。您也可以尝试动态确定值，但您可能必须等待请求进入，以便您可以使用类似的东西`HttpUtils.getRequestURL(req)`- 我不知道有任何其他方法可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T00:59:02.237

如果您在该 URL 前面加上 servlet 上下文，它可能会起作用。

我同意重构听起来是一个更好的主意。如果它是一个初始化操作，并且两个 servlet 都在同一个上下文中，那么也许可以将参数外部化到文件或数据库中，以便两者都可以获取它们。

我不希望 init 过于广泛。

# asp.net - http handler 接口中 bool IsReusable 的意义

> ID：539302
> 
> 赞同：132
> 
> 时间：2009-02-11T23:14:16.873
> 
> 标签：asp.net, httphandler, ihttphandler

在编写 http 处理程序/模块时，有一个接口成员可以实现称为 - [bool IsReusable](https://docs.microsoft.com/en-us/dotnet/api/system.web.ihttphandler.isreusable)。

这个成员有什么意义？如果我将其设置为 false（或 true），这对 Web 应用程序的其余部分意味着什么？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-02-11T23:21:01.367

处理程序的正常入口点是 ProcessRequest 方法。但是，您可能在类构造函数中有代码，这些代码将一些构建起来很昂贵的实例值放在一起。

如果您将 Reusable 指定为 true，则应用程序可以缓存该实例并在另一个请求中重用它，只需一次又一次地调用其 ProcessRequest 方法，而不必每次都重新构建它。

应用程序将实例化尽可能多的处理当前负载所需的处理程序。

不利的一面是，如果所需的实例数大于当前存在的实例数，则会导致使用更多内存。相反，它们也可以减少明显的内存使用，因为它们的实例值将在 GC 周期中存活并且不需要频繁地重新分配。

另一个需要注意的是，您需要确保在 ProcessRequest 执行结束时，对象状态与您希望另一个请求重用该对象的状态相同。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-02-11T23:34:46.887

继 AnthonyWJones 的回答之后，如果您的 HTTP 处理程序返回`true`，`IsReusable`那么您应该确保它是完全线程安全的。

文档中没有任何内容表明可重用处理程序不能同时重用，尽管当前的 Microsoft 实现似乎只是连续重用它们。但是，至少在理论上，单个处理程序实例可以被多个请求同时重用，因此您不应该依赖任何可能被其他并发线程修改的数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-10T17:21:41.273

如果您没有在该实例中存储任何状态（即：您没有任何字段（也称为“类变量”）），那么您应该可以安全地重用它。

为了安全起见，默认情况下为 false。

# html - HTML表格跨越整个宽度

> ID：539309
> 
> 赞同：31
> 
> 时间：2009-02-11T23:16:42.967
> 
> 标签：html, html-table

考虑：

```
<table border="1" width="100%" ID="Table2">
    <tr>
        <td>100</td>
    </tr>
</table> 
```

这段代码仍然在桌子的两边留下一“英寸”的空间。我试图让表格跨越页面的整个宽度。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-11T23:24:03.153

尝试（在您的 <head> 部分或现有的 CSS 定义中）...

```
<style>
  body {
    margin: 0;
    padding: 0;
  }
</style> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-11T23:19:42.570

您的表格可能会继承一种边距样式。尝试将表格的边距设置为 0：

```
<table border="1" width="100%" ID="Table2" style="margin: 0px;">
  <tr>
    <td>100</td>
  </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-02T16:42:08.723

```
<table border="1" width="100%"> 
```

为我工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-11T23:18:31.667

您需要将主体的边距设置为 0，以便表格拉伸整个宽度。或者，您也可以将表格的边距设置为负数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-11T15:42:17.337

仅供参考：

*html*应该是*table*和 `width: 100%`.

*跨度*应该是`margin: auto;`.

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2020-06-08T17:48:25.357

*以防万一*您使用的是[Bootstrap 4](https://getbootstrap.com/)，您可以将`px-0`（将左/右填充设置为 0）和`mx-0`（将左/右边缘设置为 0）CSS 类添加到*正文*标记，如下所示：

```
<body class="px-0; mx-0">
    <!--your body HTML-->
</body> 
```

# hash - 为多个整数生成哈希和

> ID：539311
> 
> 赞同：5
> 
> 时间：2009-02-11T23:17:11.763
> 
> 标签：hash

我面临着有几个整数的问题，我必须使用它们生成一个。例如。

```
Int 1: 14
Int 2: 4
Int 3: 8
Int 4: 4

Hash Sum: 43 
```

我对值有一些限制，属性可以有的最大值是 30，它们的总和总是 30。属性总是正的。

关键是我想为相似的整数生成相同的哈希和，例如，如果我有整数 14、4、10、2，那么我想生成相同的哈希和，在 43 以上的情况下。但当然如果整数非常不同（4、4、2、20），那么我应该有不同的哈希和。它还需要快速。

理想情况下，我希望哈希和的输出在 0 到 512 之间，并且应该均匀分布。由于我的限制，我可以有大约 5K 种不同的可能性，所以我希望每个桶大约有 10 个。

我确信有很多算法可以做到这一点，但我找不到谷歌搜索这个东西的方法。任何人都可以发布一个算法来做到这一点吗？

**更多信息**

整个事情是这些整数是函数的属性。我想将函数的值存储在表中，但我没有足够的内存来存储所有不同的选项。这就是为什么我想在相似属性之间进行概括。

10, 5, 15 与 5, 10, 15 完全不同的原因是因为如果您在 3d 中想象这个，那么两个点都是完全不同的点

**更多信息 2**

一些答案尝试使用散列来解决问题。但我不认为这有那么复杂。感谢其中一条评论，我意识到这是一个聚类算法问题。如果我们只有 3 个属性并且我们想象 3d 中的问题，我只需要将空间划分为块。

事实上，这可以通过这种类型的规则来解决

```
if (att[0] < 5 && att[1] < 5 && att[2] < 5 && att[3] < 5)
     Block = 21

if ( (5 < att[0] < 10) &&  (5 < att[1] < 10) &&  (5 < att[2] < 10) &&  (5 < att[3] < 10))
     Block = 45 
```

问题是我需要一种快速且通用的方法来生成那些我无法写出所有可能性的 ifs。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T02:47:40.697

**简单的解决方案：**

将整数转换为用逗号分隔的字符串，并使用常见的散列算法（md5、sha 等）对结果字符串进行散列。

**如果你真的想自己动手，我会这样做：**

*   生成大素数 P
*   生成随机数 0 < a[i] < P（对于您拥有的每个维度）

要生成哈希，请计算： sum(a[i] * x[i]) mod P

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T23:28:20.257

给定输入 a、b、c 和 d，每个值的范围为 0 到 30（5 位），以下将产生一个 0 到 255（8 位）范围内的数字。

```
bucket = ((a & 0x18) << 3) | ((b & 0x18) << 1) | ((c & 0x18) >> 1) | ((d & 0x18) >> 3) 
```

一般方法是否合适取决于如何解释问题。3 个最低有效位被丢弃，将 0-7 分组在同一组中，将 8-15 分组在下一组中，依此类推。

```
0-7,0-7,0-7,0-7 -> bucket 0
0-7,0-7,0-7,8-15 -> bucket 1
0-7,0-7,0-7,16-23 -> bucket 2
...
24-30,24-30,24-30,24-30 -> bucket 255 
```

简单测试：

```
for (int a = 0; a <= 30; a++)
    for (int b = 0; b <= 30; b++)
        for (int c = 0; c <= 30; c++)
            for (int d = 0; d <= 30; d++) {
                int bucket = ((a & 0x18) << 3) |
                             ((b & 0x18) << 1) |
                             ((c & 0x18) >> 1) |
                             ((d & 0x18) >> 3);
                printf("%d, %d, %d, %d -> %d\n",
                         a,  b,  c,  d,   bucket);
            } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T00:45:42.457

您想要一个取决于输入顺序的散列函数，并且相似的数字集会在哪里生成相同的散列？也就是说，您希望 50 5 5 10 和 5 5 10 50 生成不同的值，但您希望 52 7 4 12 生成与 50 5 5 10 相同的哈希？做这样的事情的一个简单方法是：

```
long hash = 13;
for (int i = 0; i < array.length; i++) {
    hash = hash * 37 + array[i] / 5;
} 
```

这是不完美的，但应该让您了解实现所需功能的一种方法。它将值 50 - 54 视为相同的值，但会将 49 和 50 视为不同的值。

如果您希望哈希独立于输入的顺序（因此 5 10 20 和 20 10 5 的哈希相同），那么执行此操作的一种方法是在应用哈希之前对整数数组进行升序排序. 另一种方法是替换

```
 hash = hash * 37 + array[i] / 5; 
```

和

```
 hash += array[i] / 5; 
```

**编辑：** 考虑到您对此答案的评论，听起来我上面的尝试可能足以满足您的需求。它不会是理想的，也不会是完美的。如果您需要高性能，则需要进行一些研究和实验。

总而言之，顺序很重要，因此 5 10 20 与 20 10 5 不同。此外，理想情况下，您最好将每个“向量”分别存储在哈希表中，但为了处理空间限制，您希望将一些值组存储在一个表条目中.

一个理想的散列函数将根据您的表大小返回一个均匀分布在可能值中的数字。正确执行此操作取决于表的预期大小以及输入向量值的数量和预期最大值。如果您可以将负值作为“坐标”值，那么这可能会影响您计算哈希的方式。如果在给定输入值范围和选择的散列函数的情况下，最大散列值小于散列表大小，则需要更改散列函数以生成更大的散列值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T15:42:40.100

您可能想尝试使用[向量](http://en.wikipedia.org/wiki/Euclidean_vector)将每个数字集描述为哈希值。

编辑：由于您没有描述为什么您不想运行该函数本身，我猜它运行时间很长。由于您尚未描述参数集的广度。

如果每个值都是预期的，那么数据库中的完整查找表可能会更快。

如果您期望使用相同的参数和很少的整体变化进行重复调用，那么您可以查看[memoizing](http://en.wikipedia.org/wiki/Memoization)，因此只有第一次运行参数集是昂贵的，并且每个额外的请求都很快，内存使用量更少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T23:22:01.643

您需要定义“相似”的含义。散列通常旨在从唯一输入创建唯一结果。

一种方法是标准化您的输入，然后从结果中生成散列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T02:53:08.470

生成相同的哈希和称为冲突，对于哈希来说是一件坏事。它使它变得不那么有用。

如果您希望相似的值提供相同的输出，您可以将输入除以您希望它们计数的接近程度。如果顺序有所不同，请为每个数字使用不同的除数。以下函数执行您描述的操作：

```
int SqueezedSum( int a, int b, int c, int d )
{
    return (a/11) + (b/7) + (c/5) + (d/3);
} 
```

这不是哈希，而是按照您的描述进行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T20:05:58.830

您想研究[几何散列](http://graphics.stanford.edu/courses/cs468-01-winter/papers/wr-ghao-97.pdf)。在你想要的“标准”散列中

1.  一个快捷键
2.  反向电阻
3.  抗碰撞性

使用几何散列，您可以用几乎相反的东西代替数字 3；即接近的初始值给出接近的哈希值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-18T18:46:25.807

查看我的问题的另一种方法是使用多维缩放（MS）。在 MS 中，我们从项目矩阵开始，我们想要将每个项目的位置分配给 N 维空间。以这种方式减少维度的数量。

[http://en.wikipedia.org/wiki/Multidimensional_scaling](http://en.wikipedia.org/wiki/Multidimensional_scaling)

# python - Jython GUI 上的背景图像

> ID：539313
> 
> 赞同：0
> 
> 时间：2009-02-11T23:17:52.747
> 
> 标签：python, jython

我正在尝试在 Jython 中创建一个 GUI。我想导入可以放置按钮和文本字段的背景图像。我已经在适当的位置创建了带有按钮和标签的框架，我只需要知道如何导入背景图像。GUI 在 Jython 中实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T23:29:53.777

看看 Java swing 材料，本质上你只是在 python 语法中使用相同的 api。这可能会有所帮助： http: [//forums.sun.com/thread.jspa?threadID=599393](http://forums.sun.com/thread.jspa?threadID=599393)

# database - Boyce-Codd 范式的良好 KISS 描述是什么？

> ID：539324
> 
> 赞同：23
> 
> 时间：2009-02-11T23:21:52.377
> 
> 标签：database, database-normalization, bcnf

什么是 KISS（保持简单，愚蠢）方式来记住 Boyce-Codd 范式是什么以及如何获取非规范化表和 BCNF？

[维基百科](http://en.wikipedia.org/wiki/Boyce-Codd_normal_form)的信息：对我没有太大帮助。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-12T04:15:30.253

Chris Date 的定义其实挺好的，只要你明白他的意思：

# 每个属性

您的数据必须分解为不依赖于任何其他属性的单独、不同的属性/列/值。你的全名是一个属性。你的生日是一个属性。您的年龄不是一个属性，它取决于当前日期，而不是您的生日。

# 必须代表一个事实

每个属性都是一个事实，而不是事实的集合。更改属性中的一位会改变整个含义。你的生日是事实。你的全名是事实吗？嗯，在某些情况下是这样，因为如果你改变你的姓氏，你的全名就不同了，对吧？但是对于系谱学家来说，你有一个姓氏和一个姓氏，如果你改变你的姓氏，你的姓氏不会改变，所以它们是不同的事实。

# 关于钥匙，

一个属性是特殊的，它是一把钥匙。键是一个属性，对于数据中的所有信息必须是唯一的，并且不得更改。您的全名不是关键，因为它可以更改。您的社会保险号不是关键，因为它们会被重复使用。你的 SSN 加上生日不是关键，即使这个组合永远不能重复使用，因为一个属性不能是两个事实的组合。GUID 是一个键。您增加但从不重复使用的数字是关键。

# 整个钥匙，

单独的密钥必须是足够的 [*和必要的！*] 确定您的价值观；您不能用不同的键表示相同的数据，键列的子集也不能足以识别事实。假设您有一个带有 GUID 键、名称和地址值的地址簿。如果它们代表不同的人并且不是“相同的数据”，则可以使用不同的键出现两次相同的名称。如果会计部门的 Mary Jones 将她的名字改为 Mary Smith，那么销售部门的 Mary Jones 也不会更改她的名字。另一方面，如果 Mary Smith 和 John Smith 有相同的街道地址并且确实是同一个地方，则这是不允许的。您必须使用街道地址和新键创建一个新的键/值对。

您也不能将这个新的单一街道地址的密钥用作地址簿中的值，因为现在相同的街道地址密钥将被表示两次。相反，您必须使用地址簿键和街道地址键的值创建第三个键/值对；您可以通过在这组值中匹配他们的书本键和地址键来找到一个人的街道地址。

# 只有钥匙

除了标识您的值的键之外，必须没有其他任何东西。例如，如果允许您使用“The Taj Mahal”的地址（假设只有一个），则不允许在同一记录中使用城市值，因为如果您知道地址，您也会知道城市。这也将开启在不同城市拥有不止一座泰姬陵的可能性。相反，您必须再次创建具有唯一值的辅助位置键，例如泰姬陵、华盛顿特区的白宫等，以及它们的城市。或者禁止一个城市独有的“地址”。

### 所以帮助我，科德。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-12T00:06:28.853

[以下是第三范式](http://en.wikipedia.org/wiki/Third_normal_form)的维基百科页面的一些有用摘录：

比尔肯特这样定义第三范式：

> 每个非关键属性“必须提供关于关键的事实、完整的关键，而且只有关键”。
> 
> 要求非键属性依赖于“整个键”确保表在 2NF 中；进一步要求非键属性依赖于“只有键”确保表在 3NF 中。

Chris Date 改编 Kent 的助记符来定义 Boyce-Codd 范式：

> “每个属性必须代表一个关于密钥的事实，整个密钥，除了密钥之外什么都没有。” 这里的要求涉及表中的每个属性，而不仅仅是非关键属性。

*当一个表有多个复合候选键，并且一个候选键中的一个属性依赖于另一个候选键的一部分*时，这就会发挥作用。第三范式不会禁止这一点，因为它排除了关键属性。但是 BCNF 也将规则应用于关键属性。

至于如何使一个表满足BCNF，你需要用另一个属性来表示额外的依赖关系，并且可能通过将属性拆分到另一个表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T05:46:36.657

我用谷歌搜索了“boyce codd normal form”，在维基百科之后，这是第二个结果。我的教科书就关系数据库管理系统给出了一个非常简单的定义：

> **每个非平凡 FD 的左侧都必须是超级键。**

- Garcia-Molina、Ullman 和 Widom 的“数据库系统全书”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T16:08:54.063

我读过的最好的非正式答案是，在 BCNF 中，每个功能依赖项中的每个“箭头”都是候选键中的一个“箭头”。我不记得来源了，但可能是 Chris Date 写的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-09T00:22:02.017

基本上 Boyce-Codd 是“第五范式”。对于类型（例如角色、状态、流程状态、位置类型、电话类型等），数据模型中存在“属性实体”可以直观地识别它。属性实体（子子类型）是进一步分类类级别实体的有限值集的列表。所以你可能有电话类型（'mobile'、'desk'、'VOIP'）电子邮件帐户类型（'business'、'personal'、'gaming'）、角色（项目经理、数据建模师、超级模特）等. 另一个形态线索是超类型的存在，（又名大师班、超班、元实体），例如派对（子类型是公司、人等）。

基本上分类学已经疯狂（..no视频不是那么令人兴奋）到原子或叶级；有关更多技术性的解释，请参阅上面的 Bill Karwin 的评论。

Boyce-Codd 级别模型本质上是高度详细的逻辑模型，源自更简单的基于业务的概念模型。**它们通常不会在 PHYSICAL 模型中逐字执行，因为 PDM 对性能（或功能简单性）的优化可能会导致超类型和属性实体在 UI 中作为下拉列表或在幕后逻辑中进行管理在应用程序中，或在数据库约束和方法中强制引用完整性。（即它们可能最终成为 PDM 模式中的查找表，或者它们可能由代码处理而不在数据库中表示）。

那么 - 如果它们最终可能不会出现在 PDM 中，为什么还要这样做呢？出于同样的原因，您在“优化”之前构建了一个良好的 3NF 模型，以便数据库结构反映现实世界，因此比我们继承的典型 kludges 更稳定，并且必须采取英勇的行动才能使我们的业务/客户工作需求变化。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-07-15T21:52:01.927

很多时候，倾听你的直觉是最容易的，这会自然而然地发生。一般来说，如果你遇到了 3NF，你就遇到了 BCNF。这不包括对 ERD 的详细分析或有示例，但根据 Codd 有 13 条规则。我发现最好遵循这些规则，但始终记住没有一种正确的做事方式，因此请松散地遵循它们。因此，关于 RDBMS，以下是规则：

[http://www.87android.com/12-rules-of-relational-database-model-by-codd/](http://www.87android.com/12-rules-of-relational-database-model-by-codd/)

这可能无法直接回答问题，但如果您询问如何获得 BCNF 或一种简单的记忆方法，那么您对规范化的理解还不够好。不过，这无关紧要。关系数据库有多种形式，但做得好的很少。你能做的最好的事情就是知道什么是关系，遵循上面的规则，不要担心规范化的水平。标准化过程消除了数据的重复。通过迁移功能依赖关系，每个级别都更是如此。记住这一点，你会没事的，剩下的就是你的直觉和智力。

# sharepoint - 通过 SharePoint 功能部署内容类型时 CPU 使用率高

> ID：539328
> 
> 赞同：4
> 
> 时间：2009-02-11T23:23:48.003
> 
> 标签：sharepoint

我正在创建一个 SharePoint 功能，该功能将用于将一些内容类型（及其自定义列/字段）部署到一个新的 SharePoint 网站中。

我使用外部工具为内容类型（[Andrew Connell 的自定义 STSADM 命令](http://www.andrewconnell.com/blog/articles/MossStsadmWcmCommands.aspx)）生成 CAML，但是当我将它们放入功能并运行它时，我遇到了问题。

该功能像我预期的那样激活，但是当我尝试查看站点内容类型 (/_settings/mngctypes.aspx) 时，CPU 的使用率高达 100% (w3wp) 并保持在那里。

有没有人看到这个并知道如何解决它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-13T05:48:24.640

我以前见过这种情况，生成的 XML 不包含 XML 命名空间：另请注意，此工具不会创建 100% 正确用于功能的 XML。

坏 XML：

```
<XmlDocument>
<FormTemplates xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
<Display>ListForm</Display>
<Edit>ListForm</Edit>
<New>ListForm</New>
</FormTemplates>
</XmlDocument> 
```

好的 XML：

```
<XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
<FormTemplates xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
<Display>ListForm</Display>
<Edit>ListForm</Edit>
<New>ListForm</New>
</FormTemplates>
</XmlDocument> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T00:44:23.943

自定义列是指自定义字段吗？您要查看哪个内容类型页面？所有网站内容类型的列表，还是您的内容类型的详细信息页面？如果是后者，您的自定义列是否会导致错误？

# windows - 有没有一种简单的方法可以将 Windows 文件对话框上的“打开”按钮的文本更改为“选择”？

> ID：539330
> 
> 赞同：1
> 
> 时间：2009-02-11T23:24:38.533
> 
> 标签：windows, vb.net

我们正在使用文件选择器对话框来允许用户将文档添加到我们的应用程序中。在这种情况下，“开放”这个词没有多大意义。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T23:32:51.557

我将浏览[此处找到的代码](http://www.codeproject.com/KB/dialog/OpenFileDialogEx.aspx)，其中显示了某人如何扩展 OpenFileDialog。诚然，这对你来说太过分了。但我认为里面有代码可以更改按钮标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T23:29:05.073

不是真的没有。

鉴于此对话框的标准化，您的用户极有可能在过去多次使用它来将文件“添加”到应用程序中。他们很可能会非常熟悉这个词的含义，改变它可能会让他们更加困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:33:47.480

该对话框的标准性是它被称为“通用文件对话框”的原因。如果您想为您的应用程序更改它，您必须编写自己的对话框。

话虽如此，有些应用程序可以从 DLL 中提取表单，对其进行修改，然后将其重新插入。然而，这是一种针对每台机器的 hack 和彻头彻尾的糟糕表单。

# .net - 是否有用于在 vb.net 中提取接口的免费 IDE 插件？

> ID：539339
> 
> 赞同：0
> 
> 时间：2009-02-11T23:27:49.040
> 
> 标签：.net, vb.net, visual-studio-2008, plugins

是否有适用于 Visual Studio IDE 的插件，它添加了 C# 中用于从对象中提取接口的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T00:12:42.443

看看[ReSharper](http://www.jetbrains.com/resharper/features/index.html#vb)，它来自 C# 世界，但现在确实支持 VB.Net，您可以将一个类重构为具有许多其他花里胡哨的接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T18:06:05.283

[VB 的重构就是](http://www.devexpress.com/Products/Visual_Studio_Add-in/VBRefactor/)这样做的。它也是免费的。

# iphone - 在 GUI 应用程序中存储和使用状态

> ID：539343
> 
> 赞同：0
> 
> 时间：2009-02-11T23:29:19.397
> 
> 标签：iphone, user-interface

我正在编写一个 iPhone 应用程序，我发现当我添加功能时，可以预见的是，状态的排列会急剧增加。

然后我发现自己不得不在表单的整个位置添加代码：

```
If this and that and not the other then do x and y and set state z 
```

有没有人有系统的方法来处理这个问题的建议？

即使我的应用程序是 iPhone，我认为这适用于许多 GUI 案例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T00:18:57.263

通常，用户界面应用程序总是在等待事件发生。该事件可以是用户的操作（点击、摇晃 iPhone、在虚拟键盘上键入字母），也可以是另一个进程（网络数据包可用、电池耗尽）或时间事件（计时器到期）。每当一个事件发生时（“如果这个”），你查询你的应用程序的当前状态（“......和那个而不是另一个”）然后做一些事情（“做 x 和 y”），这很可能会改变应用程序状态（“设置状态 z”）。这就是您在问题中所描述的。这是一个普遍的模式。

没有单一的系统方法可以使它正确，但是当您要求方法建议时，这里有一些建议：

提示 1：使用尽可能少的真实数据结构和变量来表示内部状态，尽一切可能避免状态重复（直到遇到性能问题）。这使得“做 x 和 y 并设置状态 z”的事情更短，因为状态被隐式设置。简单的例子：而不是拥有（C++ 中的例子）

```
if (namelen < 20) { name.append(c); namelen++; } 
```

采用

```
if (name.size() < 20) { name.append(c); } 
```

第二个示例正确地避免了复制的状态变量“namelen”，从而使动作部分更短。

提示 2：当复合条件（X 和 Y 或 Z）在您的程序中多次出现时，将其抽象为一个过程，因此

```
if ((x && y) || z) { ... } 
```

写

```
bool my_condition() { return (x && y) || z; }
if (my_condition()) { ... } 
```

提示 3：如果您的用户界面有少量明确定义的状态，并且这些状态会影响事件的处理方式，您可以将状态表示为继承自用于处理这些事件的接口的类的单例实例。例如：

```
class UIState {
public:
  virtual void HandleShake() = 0;
}

class MainScreen : public UIState {
public:
  void HandleShake() { ... }
}

class HelpScreen : public UIState {
public:
  void HandleShake() { ... }
} 
```

实例化每个派生类的一个实例，然后有一个指向当前状态对象的指针：

```
UIState *current;
UIState *mainscreen = new MainScreen();
UIState *helpscreen = new HelpScreen();
current = mainscreen; 
```

要处理抖动，请致电：

```
current->HandleShake(); 
```

稍后更改 UI 状态：

```
current = helpscreen; 
```

通过这种方式，您可以将与状态相关的过程收集到类中，并将它们封装和抽象掉。当然，您可以在这些特定于状态的（单例）类中添加各种有趣的东西。

提示 4：一般来说，如果你有 N 个布尔状态变量和 T 个可以触发的不同事件，那么在所有可能条件下的所有可能事件的“矩阵”中有 T * 2**N 个条目。它需要您的架构视图和领域专业知识来正确识别矩阵中最符合逻辑和最自然地封装到对象中的维度和区域，以及如何封装。这就是软件工程的意义所在。但是，如果您尝试在没有适当封装和抽象的情况下进行项目，则无法将其扩展太多。

# asp.net - ASP.Net Web 表单实体级访问控制

> ID：539348
> 
> 赞同：3
> 
> 时间：2009-02-11T23:30:19.877
> 
> 标签：asp.net, security, webforms, authorization

我有一个 ASP.Net Web Forms 应用程序，我在其中使用基于表单的身份验证以及成员资格和角色提供程序，这对于验证和控制对目录和/或文件的访问非常有用。现在我发现自己需要控制对单个实体实例的读取、写入和删除访问，例如能够更新或删除客户的实例。我一直在想一个很好的方法来实现它，但我真的不知道从哪里开始。我阅读[了 ASP.Net MVC 中的 Authorize 属性](http://www.asp.net/learn/mvc/tutorial-17-cs.aspx)并认为有一些类似的东西会很好——装饰方法就像你可以在 ASP.Net MVC 中控制动作一样。不过，我不知道在 Web 表单世界中有什么开箱即用的方法来实现这一点，也不知道有任何框架或其他工具可以帮助我朝着这个方向前进。任何关于现有解决方案和/或如何设计我自己的实现的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T23:42:50.330

最简单的方法是要求用户是相关方法所需角色的成员[`PrincipalPermissionAttribute`](http://msdn.microsoft.com/en-us/library/system.security.permissions.principalpermissionattribute.aspx)。

```
[PrincipalPermission(SecurityAction.Demand, Role="Supervisor")]
[PrincipalPermission(SecurityAction.Demand, Role="Owner")]
public void DeleteSomething() {...} 
```

请注意，这意味着 Supervisor OR Owner 可以`DeleteSomething()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T17:59:56.593

我不认为“PrincipalPermission”是一个好方法。如果，我需要为另一个角色允许 DeleteSomthing() 怎么办？同样，如果我需要删除 DeleteSomthing() 的现有角色？唯一的方法是在代码级别更改属性。这对于大型项目来说根本不可行。

我也在寻找一个不错的解决方案。

# c - 如何从 C/C++ 源代码文件中提取特定函数以进行后续处理

> ID：539351
> 
> 赞同：1
> 
> 时间：2009-02-11T23:31:34.180
> 
> 标签：c, function, code-statistics

我正在寻找一种从某些 C/C++ 源代码中打印出特定函数的简单方法。例如，假设 test.c 在其中定义了几个函数。我希望能够打印出仅与其中一个函数关联的源代码。

编辑：对不起，我应该更清楚我的最终目标。我希望将功能打印到屏幕上，以便我可以`wc`用来获取此特定功能的字数。此外，我希望这成为命令行工具链的一部分，因此手动输入文件和选择文本不是一个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T00:24:07.937

您可以通过[doxygen](http://www.doxygen.nl/index.html)运行您的项目。它将索引您的所有函数（以及类、结构等），并可以使它们以多种[格式](http://www.doxygen.nl/manual/output.html)提供（包括 PDF 和 HTML，两者都易于打印）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T23:56:21.640

我通常从内部使用`print-region`（或最好`print-region-with-faces`）`emacs`。但是，它不是自动的，我必须手动选择区域。

也适用于其他语言。

* * *

以下由于评论中的[汤姆史密斯](https://stackoverflow.com/users/45170/tom-smith)：

```
(defun print-fn (interactive) 
   (save-excursion (mark-defun) 
   (print-region))) 
```

如果您喜欢这个，请点击 Tom 用户页面的链接，看看他是否值得您投票...

* * *

制作这个 CW，所以我不会从人们投票支持汤姆的好想法中受益。干杯。

* * *

**澄清后编辑：**这似乎没有指向 OP 的实际问题。唉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T00:11:41.540

打印出函数的最终目标是什么？

你想这样使用它吗：

```
if (error == Foo())
{
    PrintFunction(foo);
    exit(1);
} 
```

有更简单的方法可以输出错误所在的位置。如果我对您尝试解决的问题有更好的了解，我可能会提供更多帮助。

关于如何实现这样的 PrintFunction() 的想法：

> 1.  有一个包装函数的数据结构，包含：函数行开始、函数行结束，可能还有指向函数的指针。
> 2.  编写一个函数，根据源文件的编号打印出一行。 `__FILE__`给你源文件名。
> 3.  知道函数在代码中的开始和结束位置后，打印函数将是微不足道的。

这有一个烦人的陷阱，即需要更新函数在文件中所在位置的行号。但这也许可以用宏来解决。

# c# - 加载页面时，带有 UpdatePanel 的 UpdateProgress 未显示在用户控件中

> ID：539357
> 
> 赞同：0
> 
> 时间：2009-02-11T23:34:07.543
> 
> 标签：c#, asp.net, ajax, updatepanel

这是 ASP.Net UpdatePanel 的 UpdateProgress 的典型行为吗？我在页面上的用户控件窗口内有一个带有 UpdateProgress 控件的更新面板。

如果我然后让页面在后台进行一些加载并单击用户控制更新面板中的按钮，则 UpdateProgress 根本不会显示。这就像 UpdatePanels 刷新请求甚至在实际页面完成后才注册。值得注意的是，如果后台没有任何事情发生，它会显示出来。

我想要的功能是你所期望的。如果在单击按钮后必须等待任何事情来完成刷新，我想加载程序显示出来。

我知道如果我只是将 jquery ajax 与静态 web 方法一起使用，我可以获得这个功能，但是你不能在用户控件中使用静态 web 方法。我可以将它放在页面中，但它确实不属于那里。在这种情况下，一个成熟的 wcf 也不值得。我试图与 UpdatePanel 妥协，但这些事情似乎总是给我带来一些麻烦。

也许这就是它的工作方式？

**编辑：**所以我会澄清一下我在做什么。

发生的事情是我有一个页面，上面只有一些工具和一张大地图。当页面最初加载时，加载地图需要一些时间。现在，如果在加载时我打开包含有问题的更新面板的工具（用户控件），然后单击此用户控件上的按钮，该按钮应该用新数据刷新更新面板并显示加载标志（在 updateprogress ) 然后 UpdateProgress 加载图像不显示。但是，通过按钮单击运行的代码确实会在页面加载完成后运行（如预期的那样），如果包含用户控件的页面上没有任何内容正在加载，则 UpdateProgress 将显示。

我只想在页面加载时显示加载器。

我认为我的问题是地图加载可能在更新面板中，而我的 UpdateProgress 仅与用户控件更新面板的更新面板相关联。因此，在加载地图时我不会看到加载图标。但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T00:26:57.010

我并没有完全按照您在此处所做的操作，但我假设您已经掌握了用户控件中的内容并验证了如果直接放置在页面中它可以正常工作？

作为旁注，我个人删除了 UpdatePanels 并替换为 jQuery 替代品，因为它可以显着节省性能，而且弄清楚 jQuery 等人的时间效率更高。怪癖而不是 ASP.NET AJAX 怪癖。老实说，我希望我能收回投资于 UpdatePanels/ASP.NET AJAX 的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-28T21:11:54.290

我*相信*在多次阅读您的 OP 后我理解了您的问题。我自己也遇到过这种情况，很难让 UpdateProgress 在 Page_Load 上工作。解决方案？*最初*不要在 Page_Load 上触发服务器端事件。在 UpdatePanel 中添加一个 AJAX 计时器，如下所示：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
  <ContentTemplate>
     <asp:Timer ID="ajxTmr1" runat="server" Interval="1000" OnTick="ajxTmr1_Tick" />
  </ContentTemplate>
</asp:UpdatePanel> 
```

在计时器滴答事件上，根据需要执行您的服务器代码。如果您将更新进度连接到上面的更新面板，那么一切都应该正常工作。

```
<asp:UpdateProgress ID="UpdateProgress1"  runat="server" DisplayAfter="0"  AssociatedUpdatePanelID="UpdatePanel1" Visible="false">
    <%--Panel or whatever goes here--%>
</asp:UpdateProgress> 
```

# c++ - 从 C++ 调用 DLL 中的函数

> ID：539358
> 
> 赞同：40
> 
> 时间：2009-02-11T23:34:11.660
> 
> 标签：c++, visual-studio-2008, dll, dllimport

我在 VS 2008 中有一个解决方案，其中包含 2 个项目。一个是用 C++ 编写的 DLL，另一个是从空白项目创建的简单 C++ 控制台应用程序。我想知道如何从应用程序调用 DLL 中的函数。

假设我从一个空白 C++ 项目开始，并且我想调用一个名为`int IsolatedFunction(int someParam)`

我怎么称呼它？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-12T04:36:58.533

有很多方法可以做到这一点，但我认为最简单的选择之一是在链接时将应用程序链接到 DLL，然后使用*定义文件*来定义要从 DLL 导出的符号。

**警告：**定义文件方法最适合*未修饰*的符号名称。如果要导出修饰符号，那么最好*不要使用*定义文件方法。

这是一个关于如何完成的简单示例。

**第 1 步：**在*export.h*文件中定义函数。

```
int WINAPI IsolatedFunction(const char *title, const char *test); 
```

**第 2 步：**在*export.cpp*文件中定义函数。

```
#include <windows.h>

int WINAPI IsolatedFunction(const char *title, const char *test)
{
    MessageBox(0, title, test, MB_OK);
    return 1;
} 
```

**第 3 步：在***export.def*定义文件中将函数定义为导出。

```
EXPORTS    IsolatedFunction          @1 
```

**第 4 步：**创建一个 DLL 项目并将*export.cpp*和*export.def*文件添加到该项目中。构建这个项目将创建一个*export.dll*和一个*export.lib*文件。

以下两个步骤在链接时链接到 DLL。如果您不想在链接时定义入口点，请忽略接下来的两个步骤并使用**LoadLibrary**和**GetProcAddress**在运行时加载函数入口点。

**第 5 步：**通过将*export.lib*文件添加到项目中来创建一个*测试应用程序项目以使用该 dll。*将*export.dll文件复制到与**测试*控制台可执行文件相同的位置。

 *****第 6 步：**从 Test 应用程序中调用*IsolatedFunction*函数，如下所示。

```
#include "stdafx.h"

// get the function prototype of the imported function
#include "../export/export.h"

int APIENTRY WinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPSTR     lpCmdLine,
                     int       nCmdShow)
{
    // call the imported function found in the dll
    int result = IsolatedFunction("hello", "world");

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-11T23:50:41.653

也可以从dll导出函数，从exe导入，一开始比较棘手，但最后比调用LoadLibrary/GetProcAddress容易得多。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/16ya5xae%28VS.80%29.aspx)。

使用 VS 向导创建项目时，dll 中有一个复选框，可让您导出函数。

然后，在 exe 应用程序中，您只需 #include 来自 dll 的具有正确定义的标头，并将 dll 项目作为依赖项添加到 exe 应用程序。

如果您想进一步调查这一点，请检查其他问题。[使用 dllexport 从 DLL 导出函数](https://stackoverflow.com/questions/538134/exporting-functions-from-a-dll-with-dllexport)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-11T23:52:22.053

您可以使用 LoadLibrary/GetProcAddress 路线（正如 Harper 在他的回答中提到的，这里再次链接到[运行时动态链接 MSDN 示例](http://msdn.microsoft.com/en-us/library/ms686944(VS.85).aspx)），或者您可以将控制台应用程序链接到从 DLL 项目生成的 .lib 并包含 hea .h 文件，其中包含您的函数声明（如[加载时动态链接 MSDN 示例](http://msdn.microsoft.com/en-us/library/ms686923(VS.85).aspx)中所述）

在这两种情况下，您都需要确保您的 DLL 导出您想要正确调用的函数。最简单的方法是在函数声明中使用 __declspec(dllexport)（如创建[简单的动态链接库 MSDN 示例中](http://msdn.microsoft.com/en-us/library/ms682507(VS.85).aspx)所示），尽管您也可以通过 DLL 项目中的相应 .def 文件来实现。

有关 DLL 主题的更多信息，您应该浏览[MSDN About Dynamic-Link Libraries](http://msdn.microsoft.com/en-us/library/ms682592(VS.85).aspx)主题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-10-10T22:04:41.137

以下是所需的 5 个步骤：

1.  声明函数指针
2.  加载库
3.  获取程序地址
4.  将其分配给函数指针
5.  使用函数指针调用函数

[您可以在http://www.softwareandfinance.com/Visual_CPP/DLLDynamicBinding.html](http://www.softwareandfinance.com/Visual_CPP/DLLDynamicBinding.html)找到逐步的 VC++ IDE 屏幕截图

这是代码片段：

```
int main()
{
/***
__declspec(dllimport) bool GetWelcomeMessage(char *buf, int len); // used for static binding
 ***/
    typedef bool (*GW)(char *buf, int len);

    HMODULE hModule = LoadLibrary(TEXT("TestServer.DLL"));
    GW GetWelcomeMessage = (GW) GetProcAddress(hModule, "GetWelcomeMessage");

    char buf[128];
    if(GetWelcomeMessage(buf, 128) == true)
        std::cout << buf;
        return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-11T06:49:46.313

可能有用：[https ://www.codeproject.com/Articles/6299/Step-by-Step-Calling-C-DLLs-from-VC-and-VB-Part-4](https://www.codeproject.com/Articles/6299/Step-by-Step-Calling-C-DLLs-from-VC-and-VB-Part-4)

对于上面带有“GetWelcomeMessage”的示例，如果在调用导入的函数后出现错误，您可能需要在函数名称之前的 typedef 字段中指定“__stdcall”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T23:37:49.250

假设您正在讨论 DLL 的动态运行时加载，您正在寻找 LoadLibrary 和 GetProAddress。[MSDN](http://msdn.microsoft.com/en-us/library/ms686944(VS.85).aspx)上有一个例子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T23:54:06.107

当创建 DLL 时，通常会自动创建一个导入库，您应该使用链接到程序的头文件以及头文件来调用它，但如果没有，您可以手动调用 Windows 函数，如[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175(VS.85).aspx)和[GetProcAddress](http://www.google.co.nz/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms683212(VS.85).aspx&ei=XmWTSf3pLYnYsAPjydy8Cw&usg=AFQjCNHvhHicarLfNxcSbLJXopZ-U3sPQQ&sig2=boXZ-q6L8seK6j21FVmD_A)以使其工作。

# ruby-on-rails - Ruby on Rails 的持久性？

> ID：539372
> 
> 赞同：1
> 
> 时间：2009-02-11T23:38:39.670
> 
> 标签：ruby-on-rails, persistence

有没有办法在 RoR 中的页面加载之间保留数据？我想我正在寻找类似 memcached 的东西，但没有 TCP/IP 的开销。例如，PHP 有[APC](http://us2.php.net/apc)。

理想的解决方案是内存中的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T23:41:11.707

你为什么不把它存储在会话中？会话可以有多个后端，如 memcache 甚至一个数据库。我认为可以在本地部署 memcache，所以没关系。

另一种可能性是使用文件后端并将其存储在 RAM 驱动器上。但也许有一些用于 ruby​​ 的内存库可以让你将这些结果直接存储到 ram 中，但我没有这方面的经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T23:45:41.837

基于 cookie 的会话存储速度很快，不需要服务器端存储或获取，安全，并且是 Rails 的默认设置。只要数据小于 4K，就没有理由不使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T23:41:14.220

多少数据？如果这很小，您可以将其存储在会话数据中（即`session[:my_data] = "foo"`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T23:49:34.213

我不会将 TCP/IP 组件称为“开销”——除非您在其他状态或其他情况下运行 memcached 服务器。Memchached 可以很好地在本地运行，并且 rails 可以很好地使用它。也许 memcached 甚至可以使用套接字文件而不是 IP 和端口，但我还没有研究过这个

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T08:18:31.480

您还可以序列化 ActiveRecord 模型。请参阅[序列化](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002229)方法。

# jquery - jQuery在加载时更改属性

> ID：539374
> 
> 赞同：0
> 
> 时间：2009-02-11T23:39:12.540
> 
> 标签：jquery

我有这个 HTML

```
 <div id="navContainer">
    <ul>
      <li class="selected"><a href="#">Home</a></li>
      <li><a href="#">Services</a></li>
    </ul>
  </div> 
```

而且我想更改选定的 li 旁边的顶部边框（在本例中为“服务”）。我有这个 jQuery，但它不起作用。

```
$(document).ready(function(){
  alert($("#navContainer .selected").next().html()); // This alerts: <a href="#">Services</a>
  $("#navContainer .selected").next().css("border-top-color","#7d7d7d"); // This doesn't do anything
}); 
```

难道我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T23:45:43.380

您是否尝试更改顶部边框或背景颜色？修正你的问题。

你的例子对我有用。这是我的完整测试：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<script type="text/javascript" src="jquery-1.3.1.js"></script>
<script>
$(document).ready(function(){
  alert($("#navContainer .selected").next().html()); // This alerts: <a href="#">Services</a>
  $("#navContainer .selected").next().css("background-color","red");
});
</script>
</head>
<body>
  <div id="navContainer">
    <ul>
      <li class="selected"><a href="#">Home</a></li>
      <li><a href="#">Services</a></li>
    </ul>
  </div>
</body>
</html> 
```

第二个元素的背景颜色变为红色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T23:46:43.393

这对我有用，Services-LI 的背景颜色更改为红色。

如果要更改上边框，请替换

```
.css("background-color", "red"); 
```

和

```
.css("border-top","solid 1px red"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T23:49:15.917

对我来说看起来不错，也许您的 <a> 链接还定义了一个背景颜色，它覆盖了您在 <li> 上设置的背景颜色，这可能就是您看不到任何东西的原因。

[我建议您使用 Firefox 的Firebug](http://getfirebug.com/)扩展来检查 CSS 样式。

# asp.net - 检查线程是否仍在运行

> ID：539415
> 
> 赞同：1
> 
> 时间：2009-02-11T23:51:47.237
> 
> 标签：asp.net, multithreading, caching

在 application_start 期间的 ASP.NET MVC 应用程序中，一个新线程开始启动。该线程将数据加载到缓存中，需要 5 分钟。应用程序需要知道加载正在进行中。这就是为什么我想在应用程序变量中设置一个标志。

我在启动线程时将 Application["LoadingCacheActive"] 设置为 true。当线程完成时，我找不到将此变量设置为 false 的方法。我不想使用 thread.Join，因为 application_start 必须立即完成。在创建的线程内我无法设置变量，因为 HttpContext.Current 不可用。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T00:10:27.050

您可以在 Application 类中使用静态[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx) / [ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)数据成员。创建最初未设置的事件。当您的应用程序需要检查线程是否完成时，它可以调用[WaitOne(0)](http://msdn.microsoft.com/en-us/library/cc189907.aspx)来测试事件的状态。当线程完成时，它可以设置事件。如果您使用的是 ManualResetEvent，则需要在启动新线程之前对其进行重置。

但是，您也可以使用[Thread.ThreadState](http://msdn.microsoft.com/en-us/library/system.threading.thread.threadstate.aspx)，如 MSDN 所述：

> 线程状态只对调试场景感兴趣。您的代码不应该使用线程状态来同步线程的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T00:02:45.867

我不得不做类似的事情。最简单的方法是清除线程最后一行的标志。

编辑：Franci Penov 是对的，您的线程可能会被应用程序池关闭而杀死。但是在这种情况下，这不应该伤害你。

# f# - VS2008中无法添加对F#项目的dll文件引用

> ID：539419
> 
> 赞同：0
> 
> 时间：2009-02-11T23:52:32.007
> 
> 标签：f#

我似乎无法在 F# 中添加对 DLL 文件的引用。这可能是 Visual Studio 的一个错误。我试图通过单击“添加引用”->“浏览”来添加对我的 F# 项目的引用。我找到了我的 DLL，当我尝试添加它时，什么也没发生。窗口甚至没有关闭以确认我的选择。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T00:12:17.547

您是否添加了对托管 DLL 的引用？

无论如何，如果可以，请制作一个小型复制品并将其发送到 fsbugs AT microsoft dot com。

编辑：这是[F# Sept CTP 的已知问题](http://blogs.msdn.com/lukeh/archive/2008/09/17/f-september-2008-ctp-known-issues.aspx)列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T17:08:41.323

添加对 F# 项目的引用对我来说永远不起作用，我需要调试项目，然后我引用在调试文件夹中找到的结果 dll。这通常对我有用。

当我引用该项目时，它总是告诉我没有 dll。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T01:48:17.457

我认为当 DLL 由托管 C++ 生成时存在一些已知问题，但我不知道细节。无论如何，按照 Michael 的建议向 F# 团队发送错误报告是最好的做法。

# python - 使用带有“Windows 凭据”的 Linux 上的 python 连接到 MS SQL Server

> ID：539430
> 
> 赞同：9
> 
> 时间：2009-02-11T23:59:39.103
> 
> 标签：python, sql-server, pyodbc, freetds, unixodbc

有没有办法使用 Windows 域凭据在 Linux 上使用 python 连接到 MS SQL Server 数据库？

我可以使用 Windows Credentials 从我的 Windows 机器上完美连接，但尝试从带有 pyodbs + freetds + unixodbc 的 linux python 上做同样的事情

```
>>import pyodbc
>>conn = pyodbc.connect("DRIVER={FreeTDS};SERVER=servername;UID=username;PWD=password;DATABASE=dbname") 
```

导致此错误：

```
class 'pyodbc.Error'>: ('28000', '[28000] [unixODBC][FreeTDS][SQL Server]Login incorrect. (20014) (SQLDriverConnectW)') 
```

我确定密码写对了，但我尝试了许多不同的用户名组合：

```
DOMAIN\username
DOMAIN\\username 
```

甚至

```
UID=username;DOMAIN=domain 
```

无济于事。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T15:34:02.530

至少截至 2013 年 3 月，这似乎与 FreeTDS 一起开箱即用。我指定了[TDS 协议版本](http://www.freetds.org/userguide/choosingtdsprotocol.htm)以获得良好的衡量标准——不确定这是否会有所不同：

```
connStr = "DRIVER={{FreeTDS}};SERVER={0};PORT=1433;TDS_Version=7.2;UID={1}\\{2};PWD={3}".format(hostname, active_directory_domain, username, password) 
```

Microsoft 的官方 linux 驱动程序似乎也支持集成身份验证：http: [//msdn.microsoft.com/en-us/library/hh568450.aspx](http://msdn.microsoft.com/en-us/library/hh568450.aspx)。我不确定它实际在多少个 Linux 发行版上运行，或者有多少可用的源代码。[他们在下载页面](https://www.microsoft.com/en-us/download/details.aspx?id=28160)上明确提到了 RHEL 5 和 6 以及一些依赖项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-05T01:47:56.197

**正如其中一条评论所指出的，这个答案现在已经过时了。我经常使用 GSSAPI 从 Linux 到 SQL Server 2008 R2 进行身份验证，但主要使用 EasySoft ODBC 管理器和（商业）EasySoft ODBC SQL Server 驱动程序。**

在 2009 年初，我和一位同事设法使用 GSSAPI（Kerberos 凭据）从 Solaris 10 连接到 SQL Server 2005 实例，该实例使用 DBB::Perl 通过与特定版本的 MIT kerberos 库链接的 FreeTDS 构建。诀窍是——这有点难以置信，但我已经通过查看 FreeTDS 源代码验证了它——指定*长度为零的用户名*。如果 user_name 字符串的长度为 0，则 FreeTDS 代码将尝试使用 GSSAPI（如果已编译该支持）。我无法通过 Python 和 pyodbc 做到这一点，因为我想不出一种让 ODBC 传递零长度用户名的方法。

在 perl 代码中.. 有多种机会破坏 wrt 配置文件，例如 .freetds.conf 等。我似乎记得主体必须是大写的，但我的笔记似乎不同意这一点。

```
$serverprincipal = 'MSSQLSvc/foo.bar.yourdomain.com:1433@YOURDOMAIN.COM';
$dbh = DBI->connect("dbi:Sybase:server=THESERVERNAME;kerberos=$serverprincipal", '', '');

```

您必须知道如何使用 setspn 实用程序才能让 SQL Server 服务器使用适当的安全主体名称。

我对 kerberos 方面一无所知，因为我们的环境是由一个彻头彻尾的 Kerberos 专家设置的，并且在运行 SQL Server 的 AD 域和 Kerberos 域之间设置了一些花哨的东西，比如相互信任。我的客户正在运行。

有一些代码[http://code.google.com/p/libsqljdbc-auth/](http://code.google.com/p/libsqljdbc-auth/)执行从 Linux 到 SQL Server 的 GSSAPI 身份验证，但它只是 Java。作者（似乎知道他的东西）也为 jTDS 项目提供了一个类似的补丁，该补丁适用于内置 GSSAPI 的更新版本的 Java。

所以碎片都在那里，试图让它们一起工作只是一个大杂烩。我发现 pyodbc 到 unixODBC 到 FreeTDS odbc 到 TDS 集成很难跟踪/调试。perl 的东西，因为它是 CT-Lib 顶部的一个非常薄的包装器，所以更容易上手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T01:05:14.110

我有一段时间没有这样做了，但我记得整个 unixodbc + FreeTDS + pyodbc 的事情有点棘手。但是，它可以完成，并且一旦设置它并不难。

该网站提供了非常好的说明： http: [//www.pauldeden.com/2008/12/how-to-setup-pyodbc-to-connect-to-mssql.html（Web Archive 上的存档副本）](http://web.archive.org/web/20150214152131/http://www.pauldeden.com/2008/12/how-to-setup-pyodbc-to-connect-to-mssql.html "在 Archive.org：pauldeden.com/2008/12/how-to-setup-pyodbc-to-connect-to-mssql.html")

此外，根据我的经验，pyodbc 在 64 位 Linux 机器上编译/运行时遇到问题。因此，我们最终使用了 ceODBC。ceODBC 不如 pyodbc 稳定（在 python 程序中运行时遇到的意外错误比在 pyodbc 中更多），但在 64 位 Linux 上启动和运行非常容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-29T12:49:35.933

可能为时已晚，无法帮助您-但我遇到了同样的问题。在撰写本文时，最新版本的 pyodbc 允许我使用 Windows 凭据登录。只需将连接字符串中的 UID 字段留空，如下所示：

```
cnxn = pyodbc.connect('DRIVER={SQL Server};SERVER=myserverinstance;DATABASE=mydatabase;UID=;PWD=mypassword') 
```

现在，这是在您登录时使用您现有的 Windows 凭据...不确定如何指定任何 arb Windows 域凭据...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T00:46:42.063

我不相信您将能够以这种方式登录到 Windows 域帐户。您需要直接在 sql 中为这种传递凭据的方式设置用户。

# sql - 如何从 xml 片段创建 xml

> ID：539431
> 
> 赞同：1
> 
> 时间：2009-02-11T23:59:43.457
> 
> 标签：sql, sql-server, xml, tsql

我正在使用 SQL Server 2005，并且我有一个 XML 数据类型列，它将 xml 片段存储在一个大表中，如下所示：

```
row 1 ..... <Order date='2009-02-11' customerID='4' />
row 2...... <OrderItem OrderID='6' ItemID='477' quantity='1' /> 
```

我想使用 T-SQL 创建一个 XML，从这些节点看起来像这样：

```
<Orders>
  <Order data='2009-02-11' customerID='4'>
    <OrderItems>
     <OrderItem OrderID='5' ItemID='477' quantity='1'/>
    </OrderItems>
  </Order>
</Orders> 
```

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T22:46:02.130

这是在 SQL Server 2005/2008 中使用 XML DML 的更直接的方法，尽管它有点笨拙。由于您不能使用 XML 数据类型的 .modify(insert) 方法将 sql:variable 直接插入 XML，因此您必须将 XML 片段转换为字符串，连接它们，然后将它们重新转换为 XML，将第二个片段移入第一个片段并删除第二个片段的残余。实现并不像听起来那么糟糕：

```
DECLARE @xmlfrag1 XML
DECLARE @xmlfrag2 XML
DECLARE @xmlfrag3 XML

SET @xmlfrag1 = '<Orders />'
SET @xmlfrag2 = '<Order date="2009-02-11" customerID="4" />'
SET @xmlfrag3 = '<OrderItem OrderID="5" ItemID="477" quantity="1"/>'

SET @xmlfrag1 = CONVERT(XML, (CONVERT(NVARCHAR(MAX), @xmlfrag1) + CONVERT(NVARCHAR(MAX), @xmlfrag2)))
SET @xmlfrag1.modify('insert /*[2] as first into /*[1]')
SET @xmlfrag1.modify('delete /*[2]')
SET @xmlfrag1.modify('insert <OrderItems /> as first into (/Orders/Order)[1]')
SET @xmlfrag1 = CONVERT(XML, (CONVERT(NVARCHAR(MAX), @xmlfrag1) + CONVERT(NVARCHAR(MAX), @xmlfrag3)))
SET @xmlfrag1.modify('insert /*[2] as first into (/Orders/Order/OrderItems)[1]')
SET @xmlfrag1.modify('delete /*[2]')

SELECT @xmlfrag1 
```

这将返回以下内容，这正是您想要的：

```
<Orders>
  <Order date="2009-02-11" customerID="4">
    <OrderItems>
      <OrderItem OrderID="5" ItemID="477" quantity="1" />
    </OrderItems>
  </Order>
</Orders> 
```

如何获得 XML 片段完全取决于您，但这应该足以让您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T00:01:00.630

创建一个将调用 XmlDocument.LoadXml() 的 UDF。DocumentElement (root) 就是任何其他 XmlNodeList。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T01:36:19.467

纯 T-SQL 解决方案的最大障碍是字符串连接。我创建的这个小 T-SQL 解决方案应该可以解决问题并快速运行。不过，将它封装到 UDF 中可能会很好。

```
CREATE TABLE #Order ( orderId INT PRIMARY KEY,[xmlData] NVARCHAR(512) )
GO 
CREATE TABLE #OrderLines
( orderId INT, orderLine INT,[xmlData] NVARCHAR(512),CONSTRAINT [pk_OrderLines] PRIMARY KEY CLUSTERED (orderId, orderLine) )
GO
INSERT INTO #Order
SELECT 1, '<Order date="2009-02-11" customerID="4">'

INSERT INTO #OrderLines
SELECT 1, 1, '<OrderItem OrderID="1" ItemID="477" quantity="1" />' UNION ALL 
SELECT 1, 2, '<OrderItem OrderID="1" ItemID="478" quantity="1" />'

--
-- Pivot Order lines into one string value
-- 
DECLARE @OrderLines NVARCHAR(MAX)  SET @OrderLines = ''
SELECT @OrderLines = COALESCE(@OrderLines, ' ','') + [xmlData] from #OrderLines 
WHERE orderId = 1

--
-- Join document fragments together into variable.
--
DECLARE @XMLDOC NVARCHAR(MAX)  SET @XMLDOC = ''
SELECT @XMLDOC = COALESCE(@XMLDOC, ' ','') + a.C1 
FROM
(
    SELECT '<Orders>' AS C1 UNION ALL
    SELECT [xmlData] FROM #Order WHERE orderId = 1 UNION ALL
    SELECT '<OrderItems>' UNION ALL
    SELECT @OrderLines UNION ALL
    SELECT '</OrderItems>' UNION ALL
    SELECT '</Order>' UNION ALL
    SELECT '</Orders>'
) a

SELECT @XMLDOC -- OUTPUT RESULT 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-13T20:22:03.783

-- 临时表#t 是你的表。OrderId 字段是必需的，我假设您的表中存在该字段。

```
创建表 #t (OrderId int, f xml)
插入 #t 值 (6,'')
插入 #t 值 (6,'')

选择
 1 作为标签，
 null 作为父母，
 t.OrderId 为 [Order!1!!hide]，
 f.value('(/Order/@date)[1]','varchar(10)') as [Order!1!data],
 f.value('(/Order/@customerID)[1]','int') as [Order!1!customerID],
 null 作为 [OrderItems!2!!hide]，
 null 作为 [OrderItem!3!OrderID]，
 null 作为 [OrderItem!3!ItemID]，
 null 作为 [OrderItem!3!quantity]
从 #t 作为 [t]
在哪里
 f.value('(/Order/@date)[1]','varchar(10)') 不为空——如果可能，使用另一个字段更改条件

联合所有

选择不同的
 2 作为标签，
 1 作为父母，
 t.OrderId 为 [Order!1!!hide]，
 null 作为 [Order!1!data]，
 null 作为 [Order!1!customerID]，
 1 作为 [OrderItems!2!!hide]，
 null 作为 [OrderItem!3!OrderID]，
 null 作为 [OrderItem!3!ItemID]，
 null 作为 [OrderItem!3!quantity]
从 #t 作为 [t]

联合所有

选择
 3 作为标签，
 2 作为父母，
 t.OrderId 为 [Order!1!!hide]，
 null 作为 [Order!1!data]，
 null 作为 [Order!1!customerID]，
 1 作为 [OrderItems!2!!hide]，
 f.value('(/OrderItem/@OrderID)[1]','int') as [OrderItem!3!OrderID],
 f.value('(/OrderItem/@ItemID)[1]','int') as [OrderItem!3!ItemID],
 f.value('(/OrderItem/@quantity)[1]','int') as [OrderItem!3!quantity]
从 #t 作为 [t]
在哪里
 f.value('(/OrderItem/@OrderID)[1]','int') 不为空——如果可能，使用另一个字段更改条件

订购方式
 [订购！1！！隐藏]，
 [OrderItems!2!!隐藏],
 [OrderItem!3!OrderID]

FOR XML EXPLICIT, ROOT('Orders'), TYPE

```

# asp.net - ASP.NET 中的标记

> ID：539433
> 
> 赞同：0
> 
> 时间：2009-02-12T00:00:03.813
> 
> 标签：asp.net

`<%= Something %>`和有什么区别`<%# Something %>`？

还有其他类似的修饰符吗？

### 复制

> [<%# 和 <%= 开始标签有什么区别？](https://stackoverflow.com/questions/100853/what-is-the-difference-between-the-and-opening-tags)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T00:04:20.373

请参阅以下问题：

*   [<%# 和 <%= 开始标签有什么区别？](https://stackoverflow.com/questions/100853/what-is-the-difference-between-the-and-opening-tags)
*   [在 ASP.NET 中，在 .aspx 中内联代码的不同方法是什么？](https://stackoverflow.com/questions/28219/in-asp-net-what-are-the-differant-ways-to-inline-code-in-the-aspx)

# cocoa-touch - 将相同字符的变体添加到 Cocoa 中的视图的最佳方法是什么

> ID：539434
> 
> 赞同：0
> 
> 时间：2009-02-12T00:00:08.370
> 
> 标签：cocoa-touch, oop

我对如何将对象（图像等）添加到应用程序中感到困惑。我将保持我的示例非常基本，以便我可以掌握这一点。假设我想要应用程序中的简单对象。假设他们是这个论坛软件中可用的表情符号。如果你想在视图中添加一堆（比如 4 个而不是 400 个），最好使用 UIImage 来添加它们，还是应该使用各种笑脸图像（快乐、悲伤、疯狂）创建一个“smilieGuy”类以及改变他们情绪的方法（反映情绪的图像）。据我了解，通过该课程，您可以根据课程在您的视图中创建一个快乐的对象、一个悲伤的对象等，然后您可以随时说 changeMood 并将图像更改为您想要的任何心情。

课堂方法真的可行吗？它是更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T00:07:04.670

类方法更可取。

它允许您将接口 ([userFace setHappy]) 与实现 (self.image = [UIImage imageNamed:@"Happy.png"]) 分开。然后，您可以更改逻辑，或创建更多变体，而无需更改任何其他显示代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:26:22.147

我还建议创建一个 Emoticon 类作为 UIImageView 的子类。在类中，您可以加载多个图像并使用它们来设置超类的图像属性。

您可能还想查看 UIImageView 的动画属性以实现 Skype 风格的表情符号。

# c# - 将接口转换为其具体实现对象，反之亦然？

> ID：539436
> 
> 赞同：46
> 
> 时间：2009-02-12T00:01:25.497
> 
> 标签：c#, oop

在 C# 中，当我有一个接口和几个具体实现时，我可以将接口转换为具体类型还是将具体类型转换为接口？

这种情况下的规则是什么？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-12T00:33:05.840

Java 和 C# 中都允许这两个方向。向下转换需要显式转换，如果对象的类型不正确，可能会抛出异常。然而，向上转换不需要显式转换并且总是安全的。

也就是说，假设您有`public interface Animal`两个 this 的实现`interface`，`Cat`并且`Dog`....

```
Animal meowAnimal = new Cat();  // No cast required
Animal barkAnimal = new Dog();  // No cast required

Cat myCat = (Cat) meowAnimal; // Explicit cast needed
Dog myDog = (Dog) barkAnimal; // Explicit cast needed

Dog myPet = (Dog) meowAnimal; // Will compile but throws an Exception 
```

你会想要一个`try`/`catch`围绕显式演员表。在 C# 中，您有有用的`as`关键字：

```
Dog myDog = barkAnimal as Dog;
Dog myPet = meowAnimal as Dog; 
```

不会抛出异常，myDog 将为 nonNull，myPet 将为 null。Java 没有等效的关键字，尽管您始终可以使用`if (meowAnimal instanceof Dog)`测试来保持类型安全。（我猜想“ `as`”关键字会生成执行 if 的字节码，将`is`失败分配为 null。但也许 .NET 有一个字节码指令相当于“ `as`”。）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-12T00:27:09.477

在大多数语言中，您可以双向投射。如果你有一个具体的类，你可以将它转换为接口。如果您有接口，则可以强制转换为具体类。

通常，您只想朝第一个方向前进。原因是当您只有一个指向接口的指针时，您不应该知道具体类是什么。如果您将某些东西作为接口传递，您应该能够从该接口做任何您需要做的事情。如果您发现自己需要使用不在界面上的具体对象的部分，那么您有一个设计问题应该被修复而不是强制转换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T00:09:10.003

如果你在谈论 Java（但其他语言的规则类似），它是这样的：

您可以（向下）将接口转换为具体实现，前提是您转换的引用实际上是对特定具体实现的引用。这意味着

```
Vehicle v=new Car();
(Car)v // this is OK
(Bus)v // this is not 
```

`ClassCastException`该错误在 Java 中表现出来。

您可以自由地将接口的具体实现向上转换为接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T00:06:37.387

考虑到这是合乎逻辑的演员表，两者都是有效的。很多时候，您的接口使用者无法访问具体的类，这是首先拥有接口的一个主要原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-29T19:50:41.493

接口**可以**是整个类，但**如果不是必须的**，最好创建一个接受接口作为参数的构造函数并复制设置，这样您就可以控制发生的事情和需要的内容。

# apache-flex - 如何使用 flex 将图像作为图标动态加载到 TileList 中？

> ID：539458
> 
> 赞同：1
> 
> 时间：2009-02-12T00:09:19.737
> 
> 标签：apache-flex, dynamic, image-gallery, tilelist

好的，所以我创建了一个自定义渲染：

```
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
  horizontalAlign="center"
  verticalAlign="middle"
  width="100"
  height="100">
  <mx:Script>
    <![CDATA[
      [Bindable]
      private var fileLabel:String;

      [Bindable]
      private var fileIcon:Class;

      override public function set data(value:Object):void{
        fileLabel = value.label;
        fileIcon = value.file.url;
      }
    ]]>
  </mx:Script>
  <mx:Image source="{fileIcon}" />
  <mx:Label text="{fileLabel}" />
</mx:VBox> 
```

我想将其用于包含拖放到 TileList 上的图像的照片库。我有那部分，但我似乎无法让图标工作。

给定： value 是 File 类的一种包装器。我想将 mx:Image 源设置为需要为 Class 类型的东西。使用 nativePath 或 url 会给我一个转换错误。我在网上看到了大量使用 XML 和“嵌入（/url/to/img.jpg）”之类的示例。我向您保证，如果您给我其中一个示例（使用静态图像），我会给您投反对票。这不是我在这里寻找的！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T03:17:21.237

这不起作用的原因是`fileIcon`属性的类型是`Class`. `Class`如果您打算像工厂一样使用它，通常只需要一个类型的对象，并用它创建该类的实例。当您使用`[Embed]`元数据时，您是在向编译器指示它应该将指定的资产嵌入到 SWF 中，并生成一个`Class`作为工厂来销售可以表示该资产的对象实例。但是，正如您在发布此问题之前已经发现的那样，问题`[Embed]`在于您需要对引用进行硬编码，它不允许您在运行时提供值（因为编译器需要在编译时逐字嵌入资产-时间）。

幸运的是，`mx:Image.source`它是一个非常灵活的属性，它也接受字符串（尽管大多数文档都演示了将它与嵌入式资产一起使用）。只要 Flex 应用程序能够加载资产，您就可以提供一个字符串类型的 URL 作为`source`.

将类型更改为`fileIcon`字符串，并验证它`value.file.url`实际上是您的应用程序可以加载的图像的 URL。（您可以通过将此 URL 硬编码到`mx:Image`'`source`属性中来进行测试。）

# c++ - 使用 C++ 模板封装简单类型

> ID：539459
> 
> 赞同：2
> 
> 时间：2009-02-12T00:09:47.317
> 
> 标签：c++, templates, types, operator-overloading

我希望为 C++ 中的所有简单类型添加功能。

我想编写一个模板类，它将要封装的类型作为模板参数，然后定义所有运算符，以便封装的类与它封装的简单类型完全一样。

像这样的东西：

```
template <typename _SimpleType_>
class Attribute
{
public:
    Attribute(_SimpleType_ value){ m_value = value; }
    ~Attribute(){}

    // Cast
    operator _SimpleType_() { return(m_value); }

    // Comparisons
    bool operator==(const a& other) const { return a == m_value; }
    etc...

private:
   _SimpleType_ m_value;
}

// Use like:
Attribute<int> i = 20;

while(i)
{
   if((i & 0xF) == 0)
   {
      i >>= 2;
   }

   i--;
}  etc... 
```

问题是我确信必须处理大量细微差别并编写专门的模板运算符；那么是否有任何地方已经完成了这项工作，以便我可以使用它呢？

Boost 太大且太复杂，无法放入我的项目中，但如果那里有这样的类，我可以查看它以获取指针 - 如果有，它的名称是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T00:12:49.820

这很简单，虽然很乏味——你只需要实现标准类型支持的所有运算符，而强制类型转换运算符还不够。

不过我不得不问，你到底为什么要这么做？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T00:44:01.993

这是一个对 T& 进行自动类型转换的示例（使用 GNU C++ 4.3.2 测试）：

```
#include <iostream>

using namespace std;

template <typename T>
class Attribute {
public:
    Attribute(const T &value) { v = value; }
    operator T & () { return v; }
private:
    T v;
};

int main(int argc, char **argv)
{
    Attribute<int> i(0);
    i = 3;
    i++;
    i += 4;
    i = i + 5;
    i <<= 3;
    cout << "i is now " << i << endl;
} 
```

C++ 编译器使用强制运算符“operator T & ()”自动将对“Attribute”的引用转换为对“int”的引用。因此，当 Attribute 类不提供 '++' 运算符或任何东西时，对象会被类型转换为 int &，然后从那里查找运算符。随意尝试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T00:27:03.750

您可以免费获得非可变运算符的实现，只需转换为`_Simple_type_`（并且您将通过转换为 获得分配和递增/递减`_Simple_type_&`）。另一个问题是这是否真的是一个好主意，因为它会在重载时创建转换`T`和`Attribute<T>`导致`Attribute<T>`问题的转换`T`- 但您可以通过使构造函数`Attribute<T>`显式来解决这个问题。

这留下了分配和增量/减量 - 你只需要实现这些。

另一种可能性是使用`boost::operators`- 一个仅标题的库，该库有助于基于代数规则创建运算符重载。例如。你创造`operator+=`，它会为你提供`operator+`。您创建`operator<`并且`operator==`它将为您提供其他关系等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T00:44:01.667

与您的问题无关，但您应该知道诸如`_SimpleType_`（即以下划线和大写字符开头的名称）之类的名称保留给 C++ 编译器和标准库实现者使用 - 您不允许使用它们在您自己的代码中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T00:23:30.997

我不确定是否`boost::ref`是您要查找的内容。

无论如何，最好的办法就是手工写出来——但是如果你打算支持指针和引用语义，这将开始成为一个问题。

您可能还需要做的是将它放在命名空间中并实现自由函数运算符重载并依赖 ADL 来获取它。但是，随着您实现越来越多的运算符，这将变得有点笨拙。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T13:02:54.663

我喜欢这种简单类型的封装形式（*原作者 - Sektor van Skijlen*）：

```
template<typename T>
class explicit_t
{
private:
    T value;

    template<typename V> explicit_t(V t);
public:
    operator T&() {return value;}
    explicit_t(const T& c) : value(c) {}    
}; 
```

还有一个简短的例子：

```
void fun(explicit_t<int> foo) {}

int main()
{
        // fun('a');
        // fun(3u);
        // fun(3.0);
        fun(4);
} 
```

那么我得到什么？不再有不需要的转换。

你可能还想看看更花哨的东西[——typegen](http://msobczak.com/prog/typegen/)。

# security - 用户名是否区分大小写？

> ID：539463
> 
> 赞同：9
> 
> 时间：2009-02-12T00:11:03.943
> 
> 标签：security, user-interface

我正在查看一些将用户名转换为小写的代码，然后再存储它们。我 90% 确定这没问题，但是否有系统实际上要求用户名区分大小写（特别是在健康行业）？

**注意：**我的特定代码不在入口处。我们正在从其他系统中获取用户名。我担心的是取决于那些系统（可能会或可能不会在我们的控制之下）在相同的情况下始终如一地向我们传递用户名（在描述同一用户时）。

另外值得注意的是 - 代码是：

```
userName.toLowerCase(Locale.ENGLISH) 
```

所有用户名都是英文吗？这只是为了匹配数据库中的排序规则吗？请注意，（至少在 java 中）`String.toLowerCase()`被定义为`String.toLowerCase(Locale.getDefault())`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-12T00:14:50.207

unix 登录名区分大小写...

有没有其他系统可以做到这一点？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-12T00:23:20.997

toLowerCase 只有一个理由让它接受一个语言环境：

由于小写字母 i 在每种标准语言中都有一个点，因此字母 I 会转换为带有点的 ai。

但在土耳其语中，还有一个大写字母 İ，上面有一个点。这将转换为一个小写字母 i。

“常规”土耳其首都 I 变成了一个小的 ı - 没有点。

因此，除非您的土耳其用户名都称为 IiI1I1iiII，否则我几乎不会担心这一点。

除了土耳其语之外，所有其他语言都有相同的 toLowerCase 实现。所以你可以选择 Locale.ENGLISH 或 Locale.GERMAN 或其他任何东西..只要确保你不选择土耳其语。

[有关更多详细信息，](http://java.sun.com/javase/6/docs/api/java/lang/String.html#toLowerCase(java.util.Locale))请参阅javadoc

编辑：感谢 utku karatas，我可以/复制将正确的字形粘贴到帖子中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T17:01:31.487

使用区分大小写的用户名/密码是提高安全性的一种简单方法，所以问题是，您对安全性与可用性的关心程度如何。请记住，您解决不区分大小写的方式可能存在一些本地化问题，但如果您不在乎，请不要担心。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T00:20:40.223

使用英语语言环境将用户名小写必然会给您带来问题。我建议使用不变的文化小写。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T16:52:20.997

也可以在 Windows 环境中使用的 Kerberos 存在区分大小写的问题。您可以以某种方式对其进行配置，以确保不会出现区分大小写的问题，但也可以采用其他方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T00:44:32.927

这取决于上下文，但在 SQL 的 Informix 方言中，有“所有者”（基本上等同于标准 SQL 中的模式），以及如何编写所有者名称很重要。

```
SELECT *
    FROM someone.sometable, "someone".sometable,
         SOMEONE.sometable, "SOMEONE".sometable 
```

两个引用的名字肯定是不同的；两个不带引号的名称映射到相同的名称，（取决于数据库模式）可以是其他两个名称中的任何一个。有一些代码可以对（未引用的）名称进行大小写转换。幸运的是，大多数时候您不需要指定名称，并且当您写下不带引号的名称时，一切正常；或者你用引号写名字并且是一致的，这一切都有效。不过，有时像我这样的人必须真正了解细节才能让程序在所有的障碍中都能正常运行。

此外，（正如 Stephen 所指出的）Unix 登录是区分大小写的，并且一直如此。我相信 Windows 登录大多不区分大小写 - 但我没有对此进行试验（有太多方法可以在 Windows 上搞砸而不会给游戏添加那种诡计）。

如果您真的想在 Unix 上混淆某人，请给他们一个数字用户名（例如 123），但给他们一个不同的 UID（例如 234）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T00:13:20.477

如果您的唯一目标是将一个用户与另一个用户区分开来，那么您不希望大小写成为一个因素似乎是合乎逻辑的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T00:14:54.637

我从来没有遇到过对用户名强制区分大小写的系统（我也不想）。

代码很可能在入口处强制它们小写，以防止以后出现区分大小写的问题。

# windows - 对于以前从未使用过颠覆的人来说，最好的颠覆 GUI 是什么？

> ID：539474
> 
> 赞同：5
> 
> 时间：2009-02-12T00:13:54.250
> 
> 标签：windows, svn

我使用 Visual Studio 2005，所以必须集成。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-12T00:15:13.637

Tortoise SVN 和 Ankh 是我在 VS2008 中比较喜欢的。

祝你好运！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-12T00:19:52.597

我真的很喜欢 TortoiseSVN。它与 Windows shell 很好地集成，并保护您免受所有命令行工作的影响。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T00:16:21.170

我认为[Visual SVN](http://www.visualsvn.com/)真的很好......

看看[乌龟](http://tortoisesvn.tigris.org/)也......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T00:16:32.463

[AnkhSvn](http://ankhsvn.open.collab.net/)和[乌龟](http://tortoisesvn.tigris.org/)结合起来曾经为我做这个把戏。

在线查看教程，或者只是去网站阅读维基。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T00:16:47.613

安可太坏了。它对您可以在解决方案资源管理器中执行的操作（例如移动或删除文件）反应不佳

购买 VisualSVN，每座 49 美元，价格便宜。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T01:34:12.263

支持 Mac 上的版本！XCode 对于 SCM 来说很糟糕（就像，我已经崩溃了，应该把这个功能删掉很糟糕）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T00:55:33.447

[Syncro SVN 客户端与](http://www.syncrosvnclient.com)[oXygen](http://www.oxygenxml.com)捆绑在一起，但也可作为独立应用程序使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T14:03:35.347

TortoiseSVN 或 2 个插件可用于 Eclipse IDE：Subclipse 或 Subversive。我更喜欢颠覆性的。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-20T20:42:53.580

由于使用 SVN，您无需在开始编辑文件之前签出文件，因此与 IDE 的“集成”实际上不是必须的。

# javascript - 如何使用 Javascript 或 Flash 获取用户文件的哈希值？

> ID：539488
> 
> 赞同：5
> 
> 时间：2009-02-12T00:19:11.553
> 
> 标签：javascript, flash, md5, sha1, crc

我需要做的是在网页上提供一个文件浏览器框，用户可以在其中从他们的计算机中选择一个文件，并通过 javascript（或必要时的 flash）返回某种哈希值，例如 CRC、MD5 或 SHA1。我宁愿不必将整个文件上传到 Web 服务器，因为我希望在其中使用一些相当大的文件。

基本上，我正在制作一个脚本，将这些值与各种 META 数据相关联，从而无需完全上传即可识别文件。

知道我会怎么做吗？在服务器端做这件事对我来说很容易，但是，正如我所说，会检查一些相当大的文件，我不想占用太多服务器的带宽。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T00:33:01.503

如果用户有 Flash Player 10，您可以使用 Flash 来完成。

这是一个[教程](http://www.gotoandlearn.com/play?id=76)

另外：[在 FP10 中读写本地文件](http://www.mikechambers.com/blog/2008/08/20/reading-and-writing-local-files-in-flash-player-10/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T03:27:05.877

*传统*上，这在 JavaScript 中是不可能的，但如果[W3 文件上传](http://www.w3.org/TR/file-upload/)规范流行起来，它可能会成为可能。

Firefox 3 中提供了一个变体：

```
var content= input.files[0].getAsBinary(); 
```

对于其他浏览器，您将不得不回退到 Flash 和/或服务器端散列。

这是为您提供的 SHA-1 的奖励 JS 实现：

```
function sha_hexdigest(bytes) {
  var digest= sha_bytes(sha_calculate(sha_ints(bytes), bytes.length*8));
  var digits= '0123456789abcdef';
  var hex= '';
  for (var i= 0; i<digest.length; i++) {
    var c= digest.charCodeAt(i);
    hex+= digits.charAt((c>>4)&0xF) + digits.charAt(c&0xF);
  }
  return hex;
}

function sha_ints(bytes) {
  while (bytes.length%4!=0)
    bytes+= '\x00';
  var ints= new Array();
  for (var i= 0; i<bytes.length; i+= 4) {
    ints[ints.length]= (
      (bytes.charCodeAt(i)&0xFF)<<24 | (bytes.charCodeAt(i+1)&0xFF)<<16 |
      (bytes.charCodeAt(i+2)&0xFF)<<8 | (bytes.charCodeAt(i+3)&0xFF)
    ); }
  return ints;
}

function sha_bytes(ints) {
  var bytes= '';
  for (var i= 0; i<ints.length; i++)
    bytes+= String.fromCharCode((ints[i]>>24)&0xFF, (ints[i]>>16)&0xFF, (ints[i]>>8)&0xFF, ints[i]&0xFF)
  return bytes;
}

function sha_calculate(ints, bitn) {
  while (ints.length*32<=bitn) ints[ints.length]= 0;
  ints[ints.length-1]|= 1<<(31-bitn%32)
  while (ints.length%16!=14) ints[ints.length]= 0;
  ints[ints.length]= Math.floor(bitn/0x100000000);
  ints[ints.length]= bitn&0xFFFFFFFF;

  var h0= 1732584193, h1= -271733879, h2= -1732584194, h3= 271733878, h4= -1009589776;
  var a, b, c, d, e, f, k, temp, w= new Array(80);
  for(var inti= 0; inti<ints.length; inti+= 16) {
    a= h0; b= h1; c= h2; d= h3; e= h4;
    for (var i= 0; i<16; i++) w[i]= ints[inti+i];
    for (; i<80; i++) w[i]= sha_rol(w[i-3] ^ w[i-8] ^ w[i-14] ^ w[i-16], 1);

    for(var i= 0; i<80; i++) {
      switch (Math.floor(i/20)) {
        case 0: f= sha_add(1518500249, (b & c) | ((~b) & d)); break;
        case 1: f= sha_add(1859775393, b ^ c ^ d); break;
        case 2: f= sha_add(-1894007588, (b & c) | (b & d) | (c & d)); break;
        case 3: f= sha_add(-899497514, b ^ c ^ d); break;
      }
      temp= sha_add( sha_add(sha_rol(a, 5), w[i]), sha_add(e, f) );
      e= d; d= c; c= b; b= a; a= temp;
      c= sha_rol(c, 30);
    }

    h0= sha_add(h0, a); h1= sha_add(h1, b); h2= sha_add(h2, c); h3= sha_add(h3, d); h4= sha_add(h4, e);
  }
  return new Array(h0, h1, h2, h3, h4);
}

function sha_add(a, b) {
  var lsw= (a&0xFFFF) + (b&0xFFFF);
  var msw= (a>>16) + (b>>16) + (lsw>>16);
  return (msw<<16) | (lsw&0xFFFF);
}

function sha_rol(n, bits) {
  return (n<<bits) | (n>>>(32-bits));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T00:30:45.083

这对于 Javascript 是不可能的，因为无法访问文件系统。我知道这可以用 Silverlight 来完成。也许有flash经验的人可以回答。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-02-12T00:29:26.677

浏览器（即 JavaScript）无法访问本地文件系统，期间。如果可以，那将是一场安全噩梦。

# .net - .net 控件中的 3d 图表

> ID：539499
> 
> 赞同：2
> 
> 时间：2009-02-12T00:24:35.800
> 
> 标签：.net, user-interface, charts

我有一个二维数组，我想显示为 3d 网格。是否有任何开源库可以作为 .net 控件执行此操作？

我想在阴影和线框之间进行选择，能够根据高度着色，并且能够通过鼠标旋转视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T00:34:54.293

codeproject 上有一个控件可以帮助您。

[http://www.codeproject.com/KB/openGL/ntgraph3d_atl.aspx](http://www.codeproject.com/KB/openGL/ntgraph3d_atl.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T20:25:05.877

超级 2d/3d 图形库似乎支持您的所有要求：

*   阴影/线框
*   基于海拔的颜色
*   回转
*   飞涨

看看[这个样本](http://www.softwaresigloxxi.com/example52xyz-surface-databound-datagridview-new.html)。

它不是开源的，但价格便宜（99 欧元）并且免版税（因此没有分发限制）。您还可以获得 299 欧元的完整源代码。

# cocoa-touch - MGTwitterEngine - 状态更新

> ID：539500
> 
> 赞同：0
> 
> 时间：2009-02-12T00:25:27.437
> 
> 标签：cocoa-touch, twitter

我发现在更新状态时，我在 iPhone 上随机出现 EXC_BAD_ACCESS 错误。这非常随机发生。

任何人都知道如何解决这个问题？

```
#import "TwitterViewController.h"

NSString *_testUID = nil;
NSString *sImageName;

@implementation TwitterViewController

//Turns NSLogs into comments
//#define NSLog //

- (void)viewDidLoad {

    self.title = @"Twitter";

    arrayEmotes = [[NSMutableArray alloc] init];
    [arrayEmotes addObject:@"Happy"];
    [arrayEmotes addObject:@"Sad"];
    [arrayEmotes addObject:@"Tongue"];
    [arrayEmotes addObject:@"Drunk"];
    [arrayEmotes addObject:@"Bored"];
    [arrayEmotes addObject:@"Love"];
    [arrayEmotes addObject:@"Sleepy"];
    [arrayEmotes addObject:@"Sick"];
    [arrayEmotes addObject:@"Awake"];
    [arrayEmotes addObject:@"Shocked"];
    [arrayEmotes addObject:@"Angry"];
    [arrayEmotes addObject:@"Laughing"];
    [arrayEmotes addObject:@"Dancing"];
    [arrayEmotes addObject:@"Confused"];

    [activityView startAnimating];
    [currentActivity setText:@"Logging In"];

    NSString *username = [[NSUserDefaults standardUserDefaults] stringForKey:@"username_preference"];
    NSString *password = [[NSUserDefaults standardUserDefaults] stringForKey:@"password_preference"];

    // Make sure you entered your login details before running this code... ;)
    if ([username isEqualToString:@""] || [password isEqualToString:@""]) {
        //Show the UIAlert if no username or password is stored in the settings
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Incorrect username/password stored in the settings." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        [alert release];        
        NSLog(@"You forgot to specify your username/password in settings.bundle!");
    }

    // Create a TwitterEngine and set our login details.
    twitterEngine = [[[MGTwitterEngine alloc] initWithDelegate:self] retain];
    [twitterEngine setUsername:username password:password];

    // Get updates from people the authenticated user follows.
    //[twitterEngine getFollowedTimelineFor:username since:nil startingAtPage:0];
    _testUID = [twitterEngine testService];
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)thePickerView {
    return 1;
}

- (NSInteger)pickerView:(UIPickerView *)thePickerView numberOfRowsInComponent:(NSInteger)component {
    return [arrayEmotes count];
}

- (NSString *)pickerView:(UIPickerView *)thePickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
    return [arrayEmotes objectAtIndex:row];
}

- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
    NSLog(@"Selected Color: %@. Index of selected color: %i", [arrayEmotes objectAtIndex:row], row);
    [btnUpdateMood setEnabled:YES];
}

- (IBAction)updateMood:(id)sender
{   

    NSLog(@"Tried to send status.");

    NSInteger selectedindex = [pickerView selectedRowInComponent:0];
    switch(selectedindex){
        case 0:
            //Happy
            sImageName = @"Happy";
            break;
        case 1:
            //Sad
            sImageName = @"Sad";
            break;
        case 2:
            //Tongue
            sImageName = @"Tounge";
            break;
        case 3:
            //Drunk
            sImageName = @"Drunk";
            break;
        case 4:
            //Bored
            sImageName = @"Bored";
            break;
        case 5:
            //Love
            sImageName = @"Love";
            break;
        case 6:
            //Sleepy
            sImageName = @"Sleepy";
            break;
        case 7:
            //Sick
            sImageName = @"Sick";
            break;
        case 8:
            //Awake
            sImageName = @"Awake";
            break;
        case 9:
            //Shocked
            sImageName = @"Shocked";
            break;
        case 10:
            //Angry
            sImageName = @"Angry";          
            break;
        case 11:
            //Laughing
            sImageName = @"Laughing";           
            break;
        case 12:
            //Dancing
            sImageName = @"Dancing";
            break;
        case 13:
            //Confused
            sImageName = @"Confused";
            break;
        default: break;
    }   

    [twitterEngine sendUpdate:[@"has changed his/her iMood to " stringByAppendingString:sImageName]];

}

// Override to allow orientations other than the default portrait orientation.
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (void)dealloc {
    //Releasing seems to sometimes cause complete errors.
    //[twitterEngine release];
    [super dealloc];
}

#pragma mark MGTwitterEngineDelegate methods

- (void)requestSucceeded:(NSString *)requestIdentifier
{
    [activityView stopAnimating];

    //Some animations
    [UIView beginAnimations:@"redToWhite" context:nil];
    [UIView setAnimationBeginsFromCurrentState:YES];
    [UIView setAnimationDuration:1];
    [UIView setAnimationRepeatCount:0];

    //Change background colour of the activity area over 1 second
    [activityArea setBackgroundColor:[UIColor whiteColor]];
    [currentActivity setText:@"Logged In"];

    [UIView commitAnimations];
    //End of animations

    NSLog(@"Request succeeded (%@)", requestIdentifier);

    if ([requestIdentifier isEqualToString:_testUID])
    {
        NSLog(@"[TWITTER UP]");
    }

}

- (void)requestFailed:(NSString *)requestIdentifier withError:(NSError *)error
{

    currentActivity.text = [NSString stringWithFormat:@"Error: %@ %@", [error localizedDescription], [[error userInfo] objectForKey:NSErrorFailingURLStringKey]];
    NSLog(@"Twitter request failed! (%@) Error: %@ (%@)", 
          requestIdentifier, 
          [error localizedDescription], 
          [[error userInfo] objectForKey:NSErrorFailingURLStringKey]);

}

- (void)statusesReceived:(NSArray *)statuses forRequest:(NSString *)identifier
{
    NSLog(@"Got statuses:\r%@", statuses);
}

- (void)directMessagesReceived:(NSArray *)messages forRequest:(NSString *)identifier
{

    NSLog(@"Got direct messages:\r%@", messages);
}

- (void)userInfoReceived:(NSArray *)userInfo forRequest:(NSString *)identifier
{
    NSLog(@"Got user info:\r%@", userInfo);
}

- (void)miscInfoReceived:(NSArray *)miscInfo forRequest:(NSString *)identifier
{
    NSLog(@"Got misc info:\r%@", miscInfo);
}

- (void)imageReceived:(UIImage *)image forRequest:(NSString *)identifier
{
    NSLog(@"Got an image: %@", image);
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T01:24:39.370

您有一些泄漏（twitterEngine（当 alloc/init 工作正常时您保留它）和 arrayEmotes（永远不会被释放）来命名我立即发现的两个），并且您可能在发送时遇到与 sImageName 相关的另一个问题更新（注意它是如何在 switch 语句之外的范围内定义的 - 我真的不知道这是否肯定会导致问题，这只是我一直试图避免的事情。我可以看到它可能导致 EXC_BAD_ACCESS ）。

无论如何，尝试使用 GDB 来逐步检查您的程序，以找出正在提前发布的对象。很多令人头疼的问题可以简单地用 GDB 解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T00:53:46.727

任何时候你有一个 EXC_BAD_ACCESS 错误，它总是一个保留/释放问题。你的代码也至少有一个漏洞（看看你在哪里创建了 twitterengine）。

我建议您阅读[Cocoa 内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)。他们会帮你找到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-27T04:34:21.020

我也有这个问题，很奇怪；即使我正确地清理了我的 MGTwitterEngine 对象，在我释放对象后它的回调之一仍然会被调用。当回调以某种方式从死机中调用时，这会导致某种访问冲突。

# c# - WCF：单个方法或接受 xml 的通用 ProcessMessage 方法

> ID：539503
> 
> 赞同：3
> 
> 时间：2009-02-12T00:25:48.650
> 
> 标签：c#, xml, wcf, architecture

我的公司正在开发一个应用程序，它通过 TCP 套接字和 xml 消息从另一家公司接收数据。这被传送到单个网关应用程序，然后将其广播到我们组织中不同机器上同一内部应用程序的多个副本。

WCF 被选为处理内部通信（内部双向）的技术。开发人员考虑了两种方法。

1.  WCF 服务为网关应用程序接收到的每条不同消息公开的各个方法。网关应用程序将解析传入的外部消息并调用适当的 WCF 服务方法。传入的 XML 将被转换为 DataContract DTO，并作为参数提供给适当的 WCF 方法。

2.  内部应用程序使用一种方法“ProcessMessage”公开了 WCF 服务，该方法接受 Xml 字符串消息作为参数。内部应用程序将解析然后反序列化接收到的 xml 并相应地处理它。

首席开发人员认为选项二是更好的选择，因为它“更容易”序列化/反序列化 xml。我认为这个论点没有意义，因为 DataContracts 是由 WCF 序列化和反序列化的，并且通过使用 WCF，我们可以更好地键入我们的数据。在选项 2 中，有人可以调用 WCF 服务并传入任何字符串。我相信选项 1 提供了一个更简洁的界面，并使应用程序更易于维护和使用。

这两个选项在某些时候仍需要对原始 xml 字符串进行解析和验证，因此也可能是一个问题，建议在哪里执行此验证。

我想知道目前传递这种信息的想法是什么，以及人们对这两种选择的看法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T09:53:53.850

如果您可以确保客户端**始终**将数据合同的序列化表示形式发送到服务器，则选项 1 是合适的。

但是，如果您需要序列化/反序列化逻辑的一些灵活性并且不与 DataContracts 紧密耦合，那么选项 2 看起来不错。当您想要支持 xml 的替代形式（例如 Atom 表示、自定义格式的原始 xml 等）时特别有用

同样在 ProcessMessage() 方法内的选项 2 中，您可以选择**是否**反序列化传入的 xml 有效负载（基于请求标头或特定于您的应用程序的内容）。

在选项 1 中，WCF 运行时将**始终** 反序列化有效负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T03:21:12.630

我希望我理解正确。我认为让您的网关应用程序处理所有反序列化并让您的内部应用程序公开采用实际 DataContract 对象的 WCF 服务可能是有意义的。

这样，您对基于 TCP 的 XML 的反序列化在网关处更加集中，您的内部应用程序无需担心它，它们只需要公开任何有意义的 WCF 服务，并且可以处理实际对象。

如果您强制内部应用程序进行反序列化，那么如果格式发生变化或其他情况，您最终可能需要进行更多维护。

所以我想我会说选项1（除非我误解了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T10:25:33.697

我最近围绕这个领域提出了几个问题：[XML vs Objects](https://stackoverflow.com/questions/368521/api-design-expose-xml-or-objects)和[XML vs Objects #2](https://stackoverflow.com/questions/375548/api-design-expose-xml-or-objects-2)。你会发现这些问题的答案很有趣。

对于我们的特殊问题，我们决定采用混合方法，界面如下所示：

```
// Just using fields for simplicity and no attributes shown.
interface WCFDataContract
{
    // Header details
    public int id;
    public int version;
    public DateTime writeDateTime;

    public string xmlBlob;

    // Footer details
    public int anotherBitOfInformation;
    public string andSoemMoreInfo;
    public book andABooleanJustInCase;

} 
```

我们使用 xmlBlob 的原因是我们拥有页眉和页脚模式，但不拥有中间的 blob。此外，我们实际上不必处理该 blob，而只需将其传递给另一个库（由另一个部门创建）。另一个库返回给我们更强类型的数据。

祝你好运——我从经验中知道，你的选项 2 可能很诱人，有时很难反驳而不被指责过于纯粹和不够务实；）

# jquery - 在另一个框架的上下文中运行 JQuery

> ID：539504
> 
> 赞同：39
> 
> 时间：2009-02-12T00:25:57.607
> 
> 标签：jquery, html, frames

我正在使用的客户有一个像这样的框架集......

```
<frameset rows="100,*, 0">
  <frame name="theFrame" id="theFrame" src="blah.html" >
  <frame name="theSecondFrame" id="theSecondFrame" src="foo.html" >
  <frame name="importantFrame" id="importantFrame" src="myFrame.html" >
</frameset> 
```

当某个动作发生时，我需要我的框架（当前隐藏的重要框架）主要接管页面并阻止与其他框架的任何交互。我计划使用 jquery block UI 插件来阻止交互。

问题是我实际上无法更改 foo.html 或 blah.html 文件。所以JS代码不能在那里。**我需要做的是在这些框架的上下文中执行我的 jquery 代码**。回顾一下，我需要我的 JQuery 代码存在于 myFrame.html 中，但在其他框架的上下文中执行。我怎样才能做到这一点？希望这是有道理的。

感谢 CDR

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-02-20T15:30:37.590

该`jQuery`函数通常使用 调用`$`，它接受第二个参数 context，即“我应该在 jQuery 对象的哪个 DOM 元素中进行搜索”。大多数情况下，您会忽略此参数，因此上下文默认为当前 HTML 文档。当您的代码在 iframe 中执行时，文档默认为该 iframe 的文档。但是您可以轻松地获取其他框架之一的文档。

例如，将其放入 中`myFrame.html`，这将删除包含在其中的框架中的所有 h1 元素`blah.html`。注意 的第二个参数`$`，它是从重要帧中抓取 blah 帧的表达式：

```
<html>
  <head>
    <script type="text/javascript" src="/javascripts/jquery.js"></script>
    <script type="text/javascript">
      function doIt() {
        $('h1', window.parent.frames[0].document).remove()
      }
    </script>
  </head>
  <body>
    <h1>My Frame</h1>
    <a href="#" onclick="doIt()">Do It</a>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-22T23:27:34.340

就像 pjb3 说的，设置 jQuery 上下文。如果您有嵌套框架，您的代码将如下所示：

```
$('*',window.parent.frames[0].frames[0].document).size(); 
```

或者，更好的是，做一个捷径：

```
targetFrame = window.parent.frames[0].frames[0].document;
$('*',targetFrame).size(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-09T09:28:13.947

在 jQuery >=1.7 的版本中，我们无法以旧方式获取事件

旧版本（<1.7）：

```
var events = $('#form').data('events'); 
```

1.7 及更新版本：

```
var events = $.fn.data($('#form'), 'events'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-14T00:45:26.013

我不确定块插件，但你不能掌握相关的框架并使用“框架树”来操作它，像这样：（来自importantFrame.htm）

```
parent.theFrame.someProperty = someValue; 
```

例如：

```
parent.theFrame.location.href='anotherPage.html'; 
```

根据我一直在阅读的内容，您可能需要在目标页面上使用 Jquery，但您可以尝试以下操作：

```
parent.theFrame.block(); 
```

或者可能：

```
$('#theFrame').block(); 
```

# perl - 如何在 Perl 程序中限制下载？

> ID：539508
> 
> 赞同：2
> 
> 时间：2009-02-12T00:27:10.473
> 
> 标签：perl, download, throttling

是否有任何 Perl 模块可用于下载限制？我想下载某个文件，但将下载速率限制为特定数量的 KB/sec 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T03:00:00.717

看起来 WWW::Curl 和 CURLOPT_MAX_RECV_SPEED_LARGE 选项是你想要的：

```
#!/usr/bin/env perl

use strict;
use warnings;
use feature ':5.10';
use WWW::Curl::Easy;

# Setting the options
my $curl = WWW::Curl::Easy->new;

$curl->setopt(CURLOPT_HEADER,1);
$curl->setopt(CURLOPT_URL, 'http://www.google.com');
$curl->setopt(CURLOPT_MAX_RECV_SPEED_LARGE, 1);

my $response_body;
open my $fh, ">", \$response_body or die; # presumably this can be a real file as well.
$curl->setopt(CURLOPT_WRITEDATA,$fh);

my $ret = $curl->perform;
die 'Error: '. $curl->strerror($ret) if $ret;

my $response_code = $curl->getinfo(CURLINFO_HTTP_CODE);
say "Received response: $response_body"; 
```

在此示例中，我们以每秒一个字节的速度下载 Google。非常慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T01:45:21.767

一种不限于 Perl 也不限于特定协议的技术是使用[涓涓细流](http://monkey.org/~marius/pages/?page=trickle)：

> 涓流是一种便携式轻量级用户空间带宽整形器。它可以在协作模式（与滴流一起）或独立模式下运行。

另请参阅[如何在 C 中限制套接字连接的带宽？](https://stackoverflow.com/questions/235762/how-do-you-throttle-the-bandwidth-of-a-socket-connection-in-c)

将这种技术打包为 Perl 模块（例如，子类 IO::Handle）会很好，但我不知道有一个。

# php - 如何在php中选择mysql数据库？

> ID：539511
> 
> 赞同：0
> 
> 时间：2009-02-12T00:29:04.853
> 
> 标签：php, mysql

我有这个代码：

> ```
>  if(!mysql_connect($host,$user,$passwd)){
>                     die("Hoops, error! ".mysql_error());
>                 } 
> ```

...从这里没有错误。

```
 if(!mysql_select_db($db,$connect)){
                    $create_db = "CREATE DATABASE {$db}";
                    mysql_query($create_db,$connect);
                    mysql_query("USE DATABASE {$db}",$connect);
                } 
```

...“未选择数据库”错误来自此处。我想选择数据库是否存在，如果不存在则创建并选择它。

为什么我的代码不对？

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T00:38:50.260

你在哪里保存 mysql_connect() 返回的值？看不到这里。我假设 $host、$user、$password 和 $db 已提前正确设置。但是您将参数传递给 mysql_select_db 可能未正确设置。

```
$connect = mysql_connect($host,$user,$passwd);
if (!$connect) {
    die('Could not connect: ' . mysql_error());
}
if(!mysql_select_db($db,$connect)) ... 
```

首先检查您是否可以在*没有*CREATE 查询的情况下进行选择。尝试一个简单的 SELECT 查询开始。如果可以连接，请选择数据库，然后执行 SELECT 查询，这是一步。*然后*尝试 CREATE 查询。如果这不起作用，那几乎可以肯定是权限问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T00:31:03.927

您可能需要尝试创建数据库的用户的数据库创建权限。然后你需要对一个有效的连接资源进行操作。$connect 永远不会被分配给连接资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T00:36:53.320

为什么不直接使用**CREATE DATABASE IF NOT EXISTS**语法呢？

像这样的东西...

```
 $con = mysql_connect('localhost');
  $sql = 'CREATE DATABASE IF NOT EXISTS {$db}';
  if (mysql_query($sql, $con)) {
    print("success.\n");
  } else {
    print("Database {$db} creation failed.\n");
  }
  if(!mysql_select_db($db,$connect)){
    print("Database selection failed.\n");
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T00:32:46.340

您应该检查 mysql_query() 的返回值 - 目前，如果这些调用中的任何一个失败，您将不知道它：

```
if(!mysql_select_db($db,$connect)){
    if (!mysql_query("CREATE DATABASE $db", $connect)) {
        die(mysql_error());
    }

    if (!mysql_select_db($db, $connect)) {
        die(mysql_error());
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T00:44:45.643

换行

```
mysql_query($create_db,$connect);
mysql_query("USE DATABASE {$db}",$connect); 
```

到

```
mysql_query($create_db,$connect);
mysql_select_db($db);* 
```

它应该可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T06:41:40.450

你可以试试 w3schools 网站。他们有一个非常简单易学的选择数据库的教程。链接是：[http](http://www.w3schools.com/php/php_mysql_select.asp) ://www.w3schools.com/php/php_mysql_select.asp 希望这有帮助:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T15:26:06.383

我要感谢你们所有人，但是我发现了自己的错误。该脚本在类中，并且其中一个变量未在此类中定义。所以我真的很抱歉。我不知道如何考虑正确的答案，但是在阅读了 Clayton 关于未正确设置参数的答案后，我注意到了我的错误，所以我猜他是赢家；）

# .net - 客户端 - 服务器：如果客户端向服务器宣布他们的存在，然后服务器接管，它仍然是客户端服务器，还是 P2P？

> ID：539513
> 
> 赞同：0
> 
> 时间：2009-02-12T00:30:12.480
> 
> 标签：.net, wcf, architecture, client-server, distributed

问候读者！所以我正在尝试开发一个客户端服务器系统。由于我之前没有设计过客户端服务器系统，所以我想我会发布一个问题，看看这里的专家有什么要说的。

要求：.NET 3.5 WCF 至少 2 台计算机，主机和从机。

用例是一个测试环境，从属设备应主设备的请求运行测试。

问题：我希望从站定位并连接到主站，然后主站控制并启动要运行的测试。从站还进行进度报告：新的测试数据、意外事件等。

我比较困惑的部分是，如果奴隶主动与主人接触，那不就是让他成为主人吗？

这是否意味着我在从属和主控上都需要服务主机，以便它们可以启动活动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T18:11:15.320

我决定在一篇博文中回答这个问题：

[http://dotmad.net/blog/2009/02/the-role-ofclients-and-services-in-wcf](http://dotmad.net/blog/2009/02/the-role-ofclients-and-services-in-wcf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T01:34:22.230

客户端/服务器和主/从不要混淆。Master 控制动作，但 Server 监听连接。

如果您的客户（奴隶）正在发起所有联系，那么您在主服务器上所需要的只是监听这些请求（网络服务等）和一个处理系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:01:16.813

我不知道为什么您的问题被否决了，对我来说似乎没问题:)

如果我是你，我可能会倾向于使用 netMsmqBinding（我喜欢队列！）。master 可以通过将消息放在 MSMQ 队列上来向 slave 发送请求，slave 可以通过 MSMQ 将状态报告发送回 master。这样，两个进程可以独立工作，您不必担心一个进程跟不上另一个进程（除非一个进程完全陷入困境。）

为此，您在两个进程中都需要一个 ServiceHost。master 需要托管一个 netMsmq 服务，slave 也是如此。每个还需要一个客户端绑定来发送消息。

如果您需要更多并行处理，这还允许您扩展从属（或主控）的数量。（所有从站都可以从同一个队列中提取消息）。

只是一个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T03:39:19.373

Check out DuplexContracts which should allow you to know methods that you can call upon your clients. There is also Event Handling in WCF, though it requires a bit more work than normal .NET eventing.

# flash - 是否有用于网络动画的 Flash 的开源替代方案？

> ID：539514
> 
> 赞同：4
> 
> 时间：2009-02-12T00:30:27.207
> 
> 标签：flash, open-source, animation, frameworks

我想做类似的东西[，](http://www.nytimes.com/interactive/2009/02/02/sports/20090202_superbowl_twitter.html)但我想避免专有平台（闪存）。我对开发比较陌生，我愿意学习任何东西。我知道 jQuery 和 MooTools 等一些 javascript 框架能够制作一些动画，但这是否超出了他们的能力范围？你有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T00:44:30.043

看看 John Resig 的[processing.js](http://ejohn.org/blog/processingjs/)。当 jQuery 的主要作者已经完成工作时，无需使用原始 jQuery！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T00:33:25.483

您可以将 FlashDevelop 用于 IDE

[http://osflash.org/flashdevelop](http://osflash.org/flashdevelop)

此外，您可以使用 gnash 作为播放器。

[http://www.gnu.org/software/gnash/](http://www.gnu.org/software/gnash/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T00:35:48.020

更重要的问题是，如果你找到了这样一个平台，任何人都可以使用他们已经安装的软件来玩它吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T01:11:57.917

Java 或 JavaFX 怎么样？我实际上对它了解不多，但它应该是针对 RIA 的，它将它放入 Flash 和 Silverlight 技术类中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T01:21:48.097

我知道[SVG 能够制作动画](http://www.w3.org/TR/SVG/animate.html)，但我不知道这种支持有多广泛或有哪些工具支持它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T00:34:46.757

在 JQuery 中复制您指向的动画将非常困难，但并非不可能。问题是，你准备好迎接挑战了吗？

我不会推荐 Flash 的替代品，除非您正在构建的应用程序是您公司内部的，并且您可以确定每个人都会安装必要的插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T01:16:09.810

签出[处理](http://processing.org)。

还可以查看免费的[Flex](http://www.adobe.com/products/flex/flexdownloads/) SDK，它允许您在没有 Flash IDE 的情况下编写和编译 Actionscript

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T01:17:52.270

您可以使用 Moonlight，它是 Silverlight 的开源克隆。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T13:35:55.657

从 Java 空间：

*   如果您担心采用，[JavaFX](http://www.javafx.org)已经有[100.000.000 次下载。](http://blogs.oracle.com/jonathan/entry/javafx_hits_100_000_000)
*   [处理](http://processing.org)。您仍然需要担心下载大小。恕我直言，处理对于原型来说非常棒，但是您必须做很多工作才能使小程序具有高性能，尤其是在没有动画的情况下。

# database - 船舶管理数据库结构讨论（应该非规范化？）

> ID：539525
> 
> 赞同：1
> 
> 时间：2009-02-12T00:33:30.957
> 
> 标签：database, database-design, normalization, denormalization

我的软件几天前投入生产，现在我想就数据库结构进行一些争论。

软件收集船舶数据，目前每艘船舶有174个详细信息，每个详细信息可以是文本值、长文本值、数字（指定长度，有或没有指定小数位数）、日期、日期随着时间的推移，一个布尔字段，一个包含许多值的菜单，一个数据列表等等。

我用下表解决了这个问题

```
船：
- ID - smallint，自动增量标识
- IMO - int，一个在船舶寿命期间不会改变的数字

ShipDetailType:
- ID - smallint，自动增量标识
- 描述 - nvarchar(200)，字段包含的值的描述
- Position - smallint，字段在数据输入表单中的位置
- ShipDetailGroup_ID - smallint，数据输入表单中字段所属组的键
- 类型 - varchar(4)，字段的类型如上所述

ShipDetailGroup
- ID - smallint，自动增量标识
（剪断……）

ShipMenuPresetValue
- ID - smallint，自动增量标识
- ShipDetailType_ID - smallint，值所属详细信息的键
- Value - nvarchar(100)，菜单类型详细信息中预设的值

ShipTextDetail
- ID - smallint，自动增量标识
- Ship_ID - smallint，详细信息所属船舶的密钥
- ShipDetailType_ID - smallint，值的详细类型的 Key
- 文本 - nvarchar(500)，包含详细信息值的字段
- 修改日期 - 小日期时间
- User_ID - smallint，用户表的键

船舶文本详细历史
（剪断……）
此表与 ShipTextDetail 相同，包含对详细信息的所有更改。

列表详细信息类型的其他表，每个表都包含列表所需的指定字段，...

```

我刚刚阅读了这篇文章：[http](http://thedailywtf.com/Articles/The_Inner-Platform_Effect.aspx) ://thedailywtf.com/Articles/The_Inner-Platform_Effect.aspx和[http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID :10678084117056](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:10678084117056)

文章说这不是处理问题的正确方法。

我的客户在更改详细信息描述并添加更多详细信息时具有详细信息和组的管理 gui。

数据输入表单是通过从 DetailGroups 和 DetailTypes 中读取结构动态构建的，每个详细类型生成一个指定的输入控件。

评论表明解决此问题的另一种方法是从表中动态创建和删除列。

你怎么看？

图表截图： http://img24.imageshack.us/my.php?image= [66604496uk3.png](http://img24.imageshack.us/my.php?image=66604496uk3.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T00:50:09.013

如果出现以下情况，我会[重构](http://www.refactoring.com/)您的代码：

*   您的客户投诉
*   你发现了一些不起作用的东西
*   您发现了一种代码无法处理您知道将来会发生的更改的方法。

您记得编写允许您重构的单元测试，对吧？

*就你那里的结构而言，我以前见过类似的结构。这有点麻烦，但在很多地方都是标准的。要记住的一件事是，虽然可以从数据库中动态添加和删除列，但数据库的内部存储机制并不一定希望您连续添加和删除这些列。但我认为与上述几点相比，这不是很相关，归结为：***它有效吗？**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T03:11:57.987

我以前见过这种方法，一旦数据量增加，它就会出现大量的性能问题。当您需要返回多个项目并在 where 子句中使用多个条件时，您会遇到这种问题。您在 Ship 和 ShipTextDetail 之间来回加入以获得所有选择的列 - 也许您必须这样做 10/20 次？然后你对你的标准做同样的事情可能 2-3 次。现在您有一个包含如此多连接的查询，它运行速度非常慢。接下来，您“预煮”一些数据以提高性能，即将常用数据拖到固定表结构中 - 啊，您已经返回到半规范化模型。

我的建议是——你知道 174 个字段的信息，这些是你的核心属性。您的客户可能会添加到该列表中，并且可能会更改字段的描述，但这仍然是一个非常好的起点。围绕这些创建一个适当的 DataModel，然后构建一个可扩展性机制，就像您已经完成的那样，但仅适用于新字段。元数据——字段的描述，可以驻留在另一个表中，或者可能驻留在资源文件中（对国际化有用吗？），这为现有字段提供了一些灵活性。

我同意乔的观点，如果您的数据库很小，即 <1000 艘船并且您的选择很简单，您可能不会遇到问题。尽管有 174 个属性可供选择，但这似乎不太可能。我认为您应该首先更改一些“显而易见”的字段，即我假设您有 Ship.Name、Ship.Owner、Ship.Weight、Ship.Registration ...

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T01:14:58.503

我做过类似的事情，但是这个特定的实现有几个问题：

1.  您将数字、布尔值、日期等存储为字符串。这可能不太理想。另一种方法是为不同的数据类型实现单独的类（从基类继承），然后将它们存储在为它们的数据类型制作的表中。
2.  您跟踪的属性是否经常更改？每个油轮有不同的设置吗？如果没有，最好制作对象而不是属性包来存储所有数据。然后可以将这些对象持久化到数据库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T18:06:54.343

从性能的角度来看，任何一种方法都可以。可能有多少艘船？所有数据都将适合任何服务器上的 RAM。

# c++ - 消除歧义 operator[] 绑定

> ID：539536
> 
> 赞同：2
> 
> 时间：2009-02-12T00:38:59.557
> 
> 标签：c++

我正在尝试从一个开源项目编译代码，并且遇到了一个问题，即 gcc 声称特定的代码行具有模棱两可的解释。问题涉及模板类和这两种方法：

```
template <class X>
class A {
public:
    X& operator[] (int i) { ... }
    operator const X* () { ... }
}; 
```

当按照以下方式使用时：

```
A<B*> a;
B* b = a[i]; 
```

gcc 抱怨 a[i] 的分辨率不明确。通过将 A 的定义替换为其特定的实例化，问题变得更加清晰：

```
class A_B {
public:
    B*& operator[] (int i) { ... }
    operator B* const * () { ... }
}; 
```

问题是有两种解释 B* b = a[i] 的方法：

```
// First interpretation (array-like behaviour first)
B*& b1 = a[i];
B* b2 = (B*) b1;

// Second interpretation (casting behaviour first)
B* const * b1 = (B* const *) a;
B* b2 = b1[a]; 
```

我的问题是：有没有办法提供一个首选的解释，最好是在没有显式转换的情况下使转换版本不受欢迎，这样我就不必修改试图调用 A[] 的每一行？我意识到解释是合法的模棱两可，但我知道代码的意图是什么，我想以最小的更改将其传达给编译器。

**编辑：**似乎我的示例不会导致有问题的错误，所以我没有正确总结原始代码，也没有正确识别问题。我会尝试先举一个产生问题的例子，对不起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T00:50:26.113

你可以使用大括号：

```
A<B*> a;
B* b = (a[i]); // Now it must evaluate the sub-expression a[i] 
```

注意。您上面的示例编译良好并按预期调用 operator[] 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T00:53:53.780

以下代码使用 g++ 3.x 为我编译。我认为您对问题的分析不正确，但无论如何您可以发布您收到的错误消息。

```
template <class X>
struct A {
    X& operator[] (int i) { static X x; return x; }
    operator const X* () { return 0; }
};

class B {};

int main() {
    A<B*> a;
    B* b = a[0];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T18:03:48.937

您可以`operator [ ]`通过以下方式强制编译器绑定：

```
B* b = a::operator [ ] ( 0 ); 
```

但无论如何，定义转换总是一个坏主意。在求助于转换运算符之前，我会以其他方式搜索它。

# c++ - 如何使用 FILE* 写入内存缓冲区？

> ID：539537
> 
> 赞同：47
> 
> 时间：2009-02-12T00:39:45.047
> 
> 标签：c++, c

有什么方法可以将内存缓冲区创建为 FILE*. 在 TiXml 中，它可以将 xml 打印到 FILE* 但我似乎无法将其打印到内存缓冲区。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-01-18T09:45:43.953

有一种 POSIX 方式将内存用作`FILE`描述符：[`fmemopen`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fmemopen.html)或者[`open_memstream`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/open_memstream.html)，取决于您想要的语义：[Fmemopen 和 open_memstream 之间的区别](https://stackoverflow.com/questions/29849749/difference-between-fmemopen-and-open-memstream)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-12T01:14:07.927

我想正确的答案是凯文。但这里有一个用 FILE *. 请注意，如果缓冲区大小（此处为 100000）太小，则会丢失数据，因为在刷新缓冲区时会写出数据。此外，如果程序调用 fflush() 会丢失数据。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv)
{
    FILE *f = fopen("/dev/null", "w");
    int i;
    int written = 0;
    char *buf = malloc(100000);
    setbuffer(f, buf, 100000);
    for (i = 0; i < 1000; i++)
    {
        written += fprintf(f, "Number %d\n", i);
    }
    for (i = 0; i < written; i++) {
        printf("%c", buf[i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-10-13T07:47:34.163

fmemopen 可以从缓冲区创建文件，这对你有意义吗？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-13T08:35:43.320

我写了一个简单的例子，我将如何创建一个内存文件：

```
#include <unistd.h> 
#include <stdio.h> 

int main(){
  int p[2]; pipe(p); FILE *f = fdopen( p[1], "w" );

  if( !fork() ){
    fprintf( f, "working" );
    return 0;
  }

  fclose(f); close(p[1]);
  char buff[100]; int len;
  while( (len=read(p[0], buff, 100))>0 )
    printf(" from child: '%*s'", len, buff );
  puts("");
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-31T06:36:40.210

**C++`basic_streambuf`继承**

在 C++ 中，你应该尽可能避免`FILE*`。

仅使用 C++ 标准库，就可以创建一个透明地使用文件或内存 IO 的单一接口。

这使用了以下提到的技术：[设置标准流使用的内部缓冲区 (pubsetbuf)](https://stackoverflow.com/questions/1494182/setting-the-internal-buffer-used-by-a-standard-stream-pubsetbuf)

```
#include <cassert>
#include <cstring>
#include <fstream>
#include <iostream>
#include <ostream>
#include <sstream>

/* This can write either to files or memory. */
void write(std::ostream& os) {
    os << "abc";
}    

template <typename char_type>
struct ostreambuf : public std::basic_streambuf<char_type, std::char_traits<char_type> > {
    ostreambuf(char_type* buffer, std::streamsize bufferLength) {
        this->setp(buffer, buffer + bufferLength);
    }
};

int main() {
    /* To memory, in our own externally supplied buffer. */
    {
        char c[3];
        ostreambuf<char> buf(c, sizeof(c));
        std::ostream s(&buf);
        write(s);
        assert(memcmp(c, "abc", sizeof(c)) == 0);
    }

    /* To memory, but in a hidden buffer. */
    {
        std::stringstream s;
        write(s);
        assert(s.str() == "abc");
    }

    /* To file. */
    {
        std::ofstream s("a.tmp");
        write(s);
        s.close();
    }

    /* I think this is implementation defined.
     * pusetbuf calls basic_filebuf::setbuf(). */
    {
        char c[3];
        std::ofstream s;
        s.rdbuf()->pubsetbuf(c, sizeof c);
        write(s);
        s.close();
        //assert(memcmp(c, "abc", sizeof(c)) == 0);
    }
} 
```

不幸的是，似乎不可能交换`FILE*`和`fstream`：[从 std::fstream 获取 FILE*](https://stackoverflow.com/questions/109449/getting-a-file-from-a-stdfstream)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T01:06:46.383

您可以使用文档所述的[TiXMLPrinter的](http://www.grinninglizard.com/tinyxmldocs/classTiXmlPrinter.html)[CStr](http://www.grinninglizard.com/tinyxmldocs/classTiXmlPrinter.html#a14)方法：

> TiXmlPrinter 在您需要时很有用：
> 
> 1.  打印到内存（尤其是在非 STL 模式下）
> 2.  控制格式（行尾等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-18T09:57:02.457

[https://github.com/Snaipe/fmem](https://github.com/Snaipe/fmem)是针对不同平台/版本特定内存流实现的包装器

它按顺序尝试以下实现：

*   开放内存流。
*   fopencookie，具有不断增长的动态缓冲区。
*   funopen，具有不断增长的动态缓冲区。
*   WinAPI 临时内存支持文件。

当没有其他均值可用时，fmem 回退到 tmpfile()

# php - PHP将文件句柄传递给用户，以便文件下载并保存到他们的机器上

> ID：539548
> 
> 赞同：0
> 
> 时间：2009-02-12T00:45:44.470
> 
> 标签：php, file, http-headers, save, filestream

我正在从另一台服务器下载文件。我希望将此文件推送给我的用户，而不是将其保存到我的服务器。

换句话说，将文件句柄传递给他们，这样它就可以通过我的服务器并保存到他们的机器上。我怎样才能做到这一点？到目前为止我有这个：

```
$handle = fopen($_GET['fileURL'], 'r');
$filename = stream_get_contents($handle); 
```

我如何将它推送给用户，也许使用标题？

感谢您的任何帮助和指导。

## 编辑

我有标题：

```
header("Pragma: public"); // required
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false);
header("Content-Type: $ctype");
header("Content-Disposition: attachment; filename=\"".basename($filename)."\";" );
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($filename));
readfile("$filename"); 
```

只是它不会推动标题。我只是在大约 15 秒后得到一个空白页面，看起来像是在下载文件但没有给我。

我希望脚本立即将标头作为流发送给用户。出口（）;

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T00:48:25.663

你可以试试这个

```
$filetype = mime_content_type($filename);
header('Content-type: '.$filetype);
header('Content-Disposition: attachment; filename="'.$filename.'"'); 
```

更新您的编辑：

您是否禁用了错误，因为这听起来像是标头已发送错误？

```
error_reporting(E_ALL | E_STRICT); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T01:04:33.253

使用 readfile() 时不必使用 fopen()；

只需在 readfile() 中包含文件名，如下所示：

```
readfile($_GET['fileUrl']); 
```

尽管这在安全方面非常危险，因为用户可以指定文件服务器上的任何文件。如果您只有几个文件希望有人能够下载，也许您应该将它们存储在一个数组（或数据库，最好）中

这是一个数组示例：

```
$files = array('file1.jpg', 'file2.png', 'file3.pdf');
//assume $_GET['file_id'] == 0, 1 or 2

if (file_exists($files[$_GET['file_id']]))
    readfile($files[$_GET['file_id']]); 
```

# c# - 在安全施法后，我是否必须*总是*检查 null ？

> ID：539549
> 
> 赞同：4
> 
> 时间：2009-02-12T00:46:18.710
> 
> 标签：c#

快速提问；执行安全强制转换后是否总是需要检查空值？我现在这样做，但是在这样的情况下：

```
void button1_Click(object sender, EventArgs e)
{
    Button = sender as Button;
    if (button != null)  // <-- necessary?
    {
        // do stuff with 'button'
    }
} 
```

我只是想知道我是否没有想到什么。出于习惯，我每次都会检查 null，但在这种情况下，我认为如果非 Button 对象连接到应该只用于按钮的处理程序，我会更喜欢崩溃。

编辑：好的，谢谢大家。我只是好奇是否有我遗漏的角度。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T00:48:38.050

如果您想在传入非按钮的情况下崩溃，请执行以下操作：

```
var button = (Button)sender; 
```

请注意，如果传入了 null 对象，它仍然可能为 null。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T00:56:15.473

这将取决于您的代码合同。

如果您确定它不为空，则无需检查。您可以引入断言以仅检查调试模式。我通常只在 an 之后检查 null ，就好像我不检查 is before 一样，否则我相信我的合同，有时我使用断言。

```
var button = sender is Button ? sender as Button 
             : throw new Exception("Not a button"); 
```

如果你想要一个不同于坏演员的异常，你可以尝试这样的事情。同样，正式的代码合同会更好。看看[这个](http://research.microsoft.com/en-us/projects/contracts/)图书馆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T00:48:13.667

是的。除非您想在此按钮上调用某些内容时引发异常:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T00:51:40.993

仅当您想避免可能的`NullRefernceExcetion`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T02:13:54.350

我同意 - 如果连接了非按钮，也许你最好让应用程序崩溃，因为这个处理程序只对按钮有意义。使用普通强制转换甚至可能比“as”强制转换更好，因为您最终会得到 InvalidCastException 而不是 NullReferenceException，这使得问题非常明显。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T09:19:51.207

当您提到“安全演员”时，答案就在问题中。如果这意味着什么，那就意味着演员阵容将会成功。

在这种情况下，最好使用抛出的类型而不是返回 null 的类型（无需手动检查），因为这样您会更快地找到错误的原因。

# java - java swing - 使用不同布局管理器时的布局奇怪

> ID：539567
> 
> 赞同：1
> 
> 时间：2009-02-12T00:53:17.277
> 
> 标签：java, swing, layout

有点奇怪，看看我是否执行以下操作：

```
import javax.swing.*;
public class FunkyButtonLayout {
    public static void main(String[] args) {
        JFrame frame = new JFrame("");
        JPanel j0 = new JPanel();     // j0 gets added to the root pane
        j0.setLayout(null);
        JPanel j1 = new JPanel();     // j1 gets added to j0 
        j1.setLayout(null);
        JButton b1 = new JButton(""); // b1 gets added to j1
        j1.add(b1);
        b1.setBounds(0, 0, 40, 32);   // b1 is big
        j0.add(j1);
        j1.setBounds(0, 0, 32, 32);   // j1 is not so big - b1 gets 'trimmed'
        frame.getContentPane().setLayout(null); // <- seems to be needed :-(
        frame.getContentPane().add(j0);             
        j0.setBounds(10, 10, 32, 32); // end result: a 32x32 button with
        frame.setSize(125, 125);      // a trimmed right border
        frame.setVisible(true);       // in the top-left corner
    }
} 
```

除了使用布局管理器将 j0 定位在根窗格中的能力之外，我几乎得到了我正在寻找的东西。如果我改变

```
 frame.getContentPane().setLayout(null); 
```

线到

```
 frame.getContentPane().setLayout(new java.awt.FlowLayout()); 
```

我看到 j0 在屏幕中间绘制为 1x1 像素:-(

任何想法为什么？请注意，这不仅仅是 FlowLayout 的事情——几乎每个布局管理器都会把它搞砸。

我真的很想拥有“在一侧修剪边框”按钮的净效果——它允许我用看起来像原生的按钮来做工具栏按钮集群的事情（[笼子战士](http://www.otierney.net/cagefighter/)试图摆脱的那种事情）控件 - 由于操作系统级别的皮肤，我看不到另一种方法。所以任何想法都值得赞赏:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T01:15:32.353

如果将布局管理器设置为 null，则必须显式设置容器的首选大小（这就是它显示得如此之小的原因）。

如果您在组件上使用 setBounds，您将覆盖父容器的布局管理器所做的工作。

我将删除对 setBounds 的所有调用和对 setLayout(null) 的所有调用，并尝试在仅使用布局管理器后达到您的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T01:25:38.850

> *...任何想法为什么？*

是的。发生这种情况是因为当您删除布局管理器（通过将其设置为 null ）时，您是在对计算机说“我将完成所有铺设工作”；在使用任何其他 LayoutManager 时将尝试...根据您的需要很好地布局您的组件（基于要放置的对象的属性）

因此，我认为最好尝试创建一个 Border 实例并将其设置到 JButton 中，而不是尝试调整它周围的所有对象。

我会看看我能不能快速想出一些东西。

**编辑：**

哎呀，它不是很快，但它在这里（我搞砸了一个让我烦恼的 1px 线） [替代文本 http://img22.imageshack.us/img22/8933/capturaby8.png](http://img22.imageshack.us/img22/8933/capturaby8.png)

正如我之前所说，将布局设置为 null 并不是最好的方法。更好的是创建自定义边框并将其设置为按钮（或设置空边框）。

这是代码：

```
import javax.swing.*;
import java.awt.*;
import javax.swing.border.*;
import java.awt.geom.*;

/**
 * Sample usage of swing borders.
 * @author <a href="http://stackoverflow.com/users/20654">Oscar Reyes</a>
 */
public class ButtonBorderSample  { 

    public static void main( String [] args )  { 

        // Pretty standard swing code
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );

        JPanel panel  = new JPanel( new FlowLayout( 
                                       FlowLayout.CENTER, 0, 5 ) );

        panel.add( createButton( "F I R S T" ) );
        panel.add( createButton( "S E C O N D" ) );
        panel.add( createButton( "T H I R D " ) );

        frame.add( panel , BorderLayout.NORTH );

        frame.pack();
        frame.setVisible( true );

    }
    /**
     * Utility method to create a button.
     * Creates the button, make it square, and add our custom border.
     */
    private static JButton createButton( String s ) { 
        JButton b = new JButton( s );
        b.setPreferredSize( new Dimension( 100, 100   ) );
        b.setBorder( new NoGapBorder() );
        return b;
    }
}

/**
 * This border implementation. It doesn't have insets and draws only a 
 * few parts of the border 
 * @author <a href="http://stackoverflow.com/users/20654">Oscar Reyes</a>
 */
class NoGapBorder implements Border  {

    private final Insets insets = new Insets( -1, -1 , -1, -1 );

    /** 
     * Defines in Border interface.
     * @return The default insets instace that specifies no gap at all.
     */
    public Insets getBorderInsets(Component c ) {
        return insets;
    }

    /** 
     * Defines in Border interface.
     * @return false always, it is not relevant.
     */
    public boolean isBorderOpaque() { 
        return false;
    }

    /**
     * Paint the border for the button. 
     * This creates the difference between setting the border to null 
     * and using this class. 
     * It only draws a line in the top, a line in the bottom and a 
     * darker line 
     * in the left, to create the desired effect.
     * A much more complicated strtegy could be used here.
     */
    public void paintBorder(Component c, Graphics g, 
                            int x, int y, int width, int height) { 

       Color oldColor = g.getColor();
       int h = height;
       int w = width;

       g.translate(x, y);

        // Color for top and bottom
        g.setColor( c.getBackground().brighter() );

        // draw top line
        g.drawLine(1, 0, w-2, 0);

        // draw bottom line
       g.drawLine(0, h-1, w-1, h-1); 

       // change the color to make it look as a division
       g.setColor( c.getBackground().darker() );

       // draw the left line
       g.drawLine(0, 0, 0, h-2);        

        // set the graphics back to its original state.
       g.translate(-x, -y);
       g.setColor(oldColor);

    }

} 
```

**编辑**

戴夫·卡佩内托写道：

> **Oscar>***不幸的是，一旦你 UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); ，这也是我需要的核心（我希望让它看起来尽可能原生）。*

好吧，我不是想让你的工作，但为了回答你的问题，你认为你的问题与 LayoutManagers 有关，我说那不是问题。

也许我应该停在那里，但我的“程序员”之痒让我继续使用示例。:)

我很高兴你最终解决了你的问题；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T13:06:39.203

有关布局管理器如何工作的真正好解释，请查看我在 Sun 写的一篇旧文章

[http://developer.java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/](http://developer.java.sun.com/developer/onlineTraining/GUI/AWTLayoutMgr/)

它很旧，但很好地讨论了 preferredSize 和布局嵌套。

享受吧——斯科特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T14:46:39.977

嗨 - 感谢大家的帮助。

**Dan >**是您对首选布局的评论让我开始工作 - 添加`j0.setPreferredSize(new java.awt.Dimension(32, 32));`就是让这个工作正常工作所需要的一切。

**奥斯卡 >**不幸的是，一旦你停止工作`UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());`，这也是我需要的核心（我希望让它看起来尽可能原生）。

例如，这是我在 XP 上使用 3 个按钮时的样子：

[替代文字 http://img19.imageshack.us/img19/8595/minems5.png](http://img19.imageshack.us/img19/8595/minems5.png)

...这就是您的 XP 外观：

[替代文字 http://img102.imageshack.us/img102/5412/yoursod4.png](http://img102.imageshack.us/img102/5412/yoursod4.png)

...不幸的是，这不是一回事-抱歉我的要求没有更清楚:-(

FWIW，这是代码（图像是与按钮大小相同的透明图标，垂直线作为图标的一部分）：

```
import java.awt.*;
import javax.swing.*;

public class FunkyButtonLayout {
  public static void main(String[] args) {
    try {
        UIManager.setLookAndFeel(
          UIManager.getSystemLookAndFeelClassName());
    } catch (Exception e) {

    }

    JFrame frame = new JFrame("x");
    Container y = frame.getContentPane();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    y.setLayout(new FlowLayout());

    JPanel uberButton = new JPanel();
    uberButton.setLayout(null);
    uberButton.setSize(98, 32);
    uberButton.setPreferredSize(new Dimension(98, 32));

    JButton record = new JButton(new ImageIcon("img/record.png"));
    record.setBounds(0, 0, 40, 32);
    record.setEnabled(true);
    record.setFocusPainted(false);
    JPanel _record = new JPanel();
    _record.setLayout(null);
    _record.setBounds(0, 0, 33, 32);

    JButton pause = new JButton(new ImageIcon("img/pause.png"));
    pause.setBounds(-4, 0, 44, 32);
    pause.setEnabled(true);
    pause.setFocusPainted(false);
    JPanel _pause = new JPanel();
    _pause.setLayout(null);
    _pause.setBounds(33, 0, 33, 32);

    JButton stop = new JButton(new ImageIcon("img/stop.png"));
    stop.setBounds(-4, 0, 36, 32);
    stop.setEnabled(true);
    stop.setFocusPainted(false);
    JPanel _stop = new JPanel();
    _stop.setLayout(null);
    _stop.setBounds(66, 0, 32, 32); 

    _record.add(record);
    _pause.add(pause);
    _stop.add(stop);

    uberButton.add(_record);
    uberButton.add(_pause);
    uberButton.add(_stop);

    y.add(uberButton);

    frame.pack();

    frame.setVisible(true);

  }
} 
```

**斯科特>**我受过教育 :-) 谢谢

# data-binding - 绑定 IList 不显示 IMyInterface 继承的接口的成员

> ID：539568
> 
> 赞同：14
> 
> 时间：2009-02-12T00:53:18.553
> 
> 标签：data-binding, reflection, interface, multiple-inheritance, typedescriptor

我将 IList 绑定到 GridView。IMyInterface 看起来像

```
public interface IMyInterface: IHasTotalHours, IHasLines
{
    DateTime GoalStartDate { get; set; }
    DateTime GoalEndDate { get; set; }
} 
```

我将一个实例绑定到这样的网格：

```
IList<IMyInterface> instance= GetMyData();

myGrid.DataSource = instance;
myGrid.DataBind(); 
```

当将此绑定到网格时，网格中显示的唯一成员是 IMyInterface 的直接成员：GoalStartDate 和 GoalEndDate。

这是为什么？如何让网格显示它继承的其他接口的成员？

**更新** 继承的接口定义简单的数据属性，如

```
public interface IHasTotalHours
{
    string Description { get; set; }
    int Hours{ get; set; }
}
public interface IHasLines
{
    double TotalLines { get; set; }
    double LinesPerHour { get; set; }
} 
```

有一个实现IMyInterface的类：

```
public class MyClass : IMyInterface
{
    public string Description { get; set; }
    public int Hours { get; set; }
    public double TotalLines { get; set; }
    public double LinesPerHour { get; set; }
    public DateTime GoalStartDate { get; set; }
    public DateTime GoalEndDate { get; set; }

} 
```

这些被转换为 IMyInterface，并在我绑定到 GridView 的列表中返回。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T04:15:52.513

数据绑定控件不使用反射，而是使用 TypeDescriptor 从数据源获取属性。在[TypeDescriptor.GetProperties](http://msdn.microsoft.com/en-us/library/ybh0y4fd.aspx)方法中，您可以阅读以下内容：

> 组件的属性可能与类的属性不同，因为如果组件位于站点，则站点可以添加或删除属性。

显然，默认实现只会从接口返回直接属性，而不是继承的属性。

幸运的是，这种机制是可扩展的，您可以编写一个带有自定义属性信息实现的[TypeConverter类。](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)实现属性逻辑请参考 TypeConverter 文档中的备注。

您的自定义 TypeConverter 类的 GetProperties 实现可以在您的接口及其继承的所有接口上调用 TypeDescriptor.GetProperties(Type)。但也许你甚至可以编写一个通用的 TypeConverter，它可以通过使用反射找到所有继承的属性。

然后使用 TypeConverterAttribute 属性将此自定义 TypeConverter 附加到您的界面。

然后，像魔术一样，数据源会找到所有属性。;-)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-12T04:45:28.730

这是因为接口是一种契约，而与对象交互的唯一方式是通过该特定契约。在进行强制转换之前，其他接口不能被假定并且不能被使用。

因此，当您将 T 的列表绑定到某个东西时，数据网格不知道那些其他接口。并且数据网格不会使用反射来确定可能继承哪些其他类或接口。唯一可用于数据网格的对象属性是由 T 接口公开的属性。

如果您希望数据网格能够访问所有属性，则需要绑定 List。

# flash - Flash：VideoPlayer.load 方法有时会失败......关于为什么以及如何恢复的想法？

> ID：539575
> 
> 赞同：0
> 
> 时间：2009-02-12T00:55:50.890
> 
> 标签：flash, flvplayback

我有一部使用 VideoPlayer 类加载 flv 的电影。它使用加载功能来完成。

这是我正在做的代码示例：

```
_root.createEmptyMovieClip("SlideA", 1);

...

SlideA.loadMovie(urlContainingFunctionForLoadVideo);

...  // SlideA has completely loaded

SlideA.loadVideo(urlToFLV);

function loadVideo(url)
{
     this.attachMovie("VideoPlayer", "my_vp", this.getNextHighestDepth(), {x:0, y:0});
     my_vp.load(url);
} 
```

我正在使用 Flash 8 IDE 导出到 Flash 8 和 ActionScript 2.0。我所看到的是，有时此功能会失败，但只有在先将其他内容加载到 SlideA 时才会失败。加载影片是使用 ActionScript 1.0 的 Flash 6 影片。我看到当加载失败时 VideoPlayer.bytesTotal 未定义并且永远不会改变。该文件可以被缓存或不被缓存，并且会发生这种情况。关于如何处理这个问题的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T05:49:25.300

也许问题是

```
this.getNextHighestDepth() try getNextHighestDepth() or SlideA.getNextHighestDepth()

function loadVideo(url)
{
     this.attachMovie("VideoPlayer", "my_vp", this.getNextHighestDepth(), {x:0, y:0});
     my_vp.load(url);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T18:24:55.360

我发现使用 VideoPlayer 是错误的想法，而是直接使用 NetStream 和 NetConnection。

# c++ - 没有歧义的命名空间规范

> ID：539578
> 
> 赞同：1
> 
> 时间：2009-02-12T00:56:34.863
> 
> 标签：c++, python, namespaces, language-design

为什么有些语言，如 C++ 和 Python，即使不存在歧义，也需要指定对象的命名空间？我知道这有后门，比如`using namespace x`在 C++ 或`from x import *`Python 中。但是，当只有一个可访问的命名空间包含给定的标识符并且不存在歧义时，我无法理解不希望语言“做正确的事情”背后的理由。对我来说，这只是不必要的冗长和违反 DRY，因为你被迫指定编译器已经知道的东西。

例如：

```
import foo  # Contains someFunction().

someFunction()  # imported from foo.  No ambiguity.  Works. 
```

比。

```
import foo  # Contains someFunction()
import bar  # Contains someFunction() also.

# foo.someFunction or bar.someFunction?  Should be an error only because
# ambiguity exists.
someFunction() 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T01:04:47.403

一个原因是为了防止在以后更改代码时（或对于外部模块/库，当其他人更改它时）意外引入冲突。例如，在 Python 中，您可以编写

```
from foo import *
from bar import * 
```

如果您知道这些模块`foo`并且`bar`没有任何具有相同名称的变量，则不会发生冲突。但是，如果在以后的版本中同时包含`foo`并`bar`包含名为 的变量`rofl`怎么办？然后会在你不知情的情况下`bar.rofl`掩盖。`foo.rofl`

我还希望能够查看文件顶部并准确查看正在导入的名称以及它们的来源（当然，我说的是 Python，但同样的推理也适用于 C++） .

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-12T01:10:48.870

Python 认为“显式优于隐式”。（输入`import this`python解释器）

另外，假设我正在阅读某人的代码。也许是你的代码；也许这是我六个月前的代码。我看到对`bar()`. 函数从何而来？我可以在文件中查找 a `def bar()`，但如果我没有找到它，那该怎么办？如果 python 通过导入自动找到第一个可用的 bar()，那么我必须搜索导入的每个文件才能找到它。多么痛苦！如果函数查找通过导入层次结构递归呢？

我宁愿看`zomg.bar()`；这告诉我函数的来源，并确保如果代码更改（除非我更改`zomg`模块），我总是得到相同的函数。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T01:20:32.920

问题是关于抽象和重用：**你真的不知道未来是否会有歧义**。

例如，在一个项目中设置不同的库是很常见的，只是为了发现它们都有自己的字符串类实现，称为“字符串”。然后，您的编译器会抱怨如果库没有封装在单独的名称空间中，则会出现歧义。

然后，通过指定您想在每个特定指令或上下文（阅读：范围）中使用的实现（如标准 std::string 之一）来避开这种歧义是一种令人愉快的乐趣。

**如果你认为它在特定的上下文中很明显**（阅读：在特定的函数中或C++ 中的**.cpp ，python 中的****.py 文件**- 从不在 C++ 头文件中）**你只需要表达自己并说“它应该是显而易见的”，添加“使用命名空间”指令（或导入 *）**。直到编译器抱怨，因为它不是。

如果您在特定范围内使用 using，则根本不会违反 DRY 规则。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T01:06:29.257

有些语言的编译器试图“做正确的事”——我想到了 Algol 和 PL/I。它们不再存在的原因是编译器非常不擅长做正确的事情，但很擅长做错的事情，只要有一半的机会！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T01:10:07.250

该规则追求的理想是使创建可重用组件变得容易 - 如果您重用您的组件，您只是不知道哪些符号将在客户端使用的其他命名空间中定义。因此，该规则迫使您就您尚不了解的进一步定义明确表示您的意图。

然而，C++ 还没有达到这个理想，主要是因为 Koenig 查找。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T01:31:41.410

这真的是正确的吗？

如果我有两种类型 ::bat 和 ::foo::bar 怎么办

我想引用 bat 类型但不小心按了 r 键而不是 t （它们彼此相邻）。

然后编译器在不给我警告的情况下搜索每个命名空间以找到 ::foo::bar 是“正确的事情”吗？

或者，如果我在整个代码库中都使用“bar”作为“::foo::bar”类型的简写怎么办。然后有一天我包含了一个定义 ::bar 数据类型的库。突然之间，以前没有的地方出现了歧义。突然间，“正确的事情”变得错误了。

在这种情况下，编译器要做的正确事情是假设我的意思是我实际编写的类型。如果我写 bar 没有命名空间前缀，它应该假设我指的是全局命名空间中的类型 bar。但如果它在我们假设的场景中这样做，它会改变我的代码引用的类型，甚至不会提醒我。

或者，它可能会给我一个错误，但是来吧，这太荒谬了，因为即使使用当前的语言规则，这里也不应该有歧义，因为其中一种类型隐藏在我没有的命名空间中指定，所以不应该考虑。

另一个问题是编译器可能不知道存在哪些其他类型。在 C++ 中，定义的顺序很重要。

在 C# 中，类型可以在单独的程序集中定义，并在您的代码中引用。编译器如何知道另一个程序集中不存在同名的另一种类型，只是在不同的命名空间中？它如何知道以后不会将一个程序添加到另一个程序集中？

正确的做法是做给程序员带来最少令人讨厌的惊喜的事情。根据不完整的数据来猜测程序员通常是不正确的做法。

大多数语言都为您提供了一些工具来避免必须指定命名空间。

在 c++ 中，您有“使用命名空间 foo”以及 typedef。如果您不想重复命名空间前缀，那就不要。使用该语言提供的工具，因此您不必这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T01:01:40.063

这一切都取决于您对“正确的事情”的定义。如果只有一个匹配项，编译器猜测您的意图是否正确？

双方都有争论。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-12T05:15:26.897

有趣的问题。在 C++ 的情况下，如我所见，如果编译器在发生冲突时立即标记错误，那么这可能导致的唯一问题是：

**所有 C++ 命名空间的自动查找将删除隐藏库代码内部部分名称的能力。**

库代码通常包含不打算对“外部世界”可见的部分（类型、函数、全局变量）。正是因为这个原因，C++ 有未命名的命名空间——以避免“内部部分”堵塞全局命名空间，即使这些库命名空间是使用`using namespace xyz;`.

示例：假设 C++*确实*进行了自动查找，并且 C++ 标准库的特定实现包含一个内部帮助函数`std::helper_func()`. `joe::helper_func()`假设用户 Joe使用不包含的*不同*库实现开发了一个包含函数的应用程序`std::helper_func()`，并使用对 的非限定调用来调用他自己的方法`helper_func()`。现在 Joe 的代码可以在他的环境中正常编译，但是任何其他尝试使用第一个库实现来编译该代码的用户都会遇到编译器错误消息。因此，使 Joe 的代码可移植所需的第一件事是插入适当的`using`声明/指令或使用完全限定的标识符。换句话说，自动查找对可移植代码没有任何好处。

诚然，这似乎不是一个经常出现的问题。但是由于键入显式`using`声明/指令（例如`using namespace std;`）对大多数人来说并不是什么大问题，完全解决了这个问题，并且无论如何都是可移植开发所必需的，因此使用它们（呵呵）似乎是一种明智的做事方式。

**注意：** 正如 Klaim 所指出的，**在任何情况下，您都不会**希望依赖头文件中的自动查找，因为这会立即阻止您的模块与包含冲突名称的任何模块同时使用。（这只是为什么你不在`using namespace xyz;`C++ 中的内部标题的逻辑扩展。）

# linux - 如何递归列出某个位置的所有目录，广度优先？

> ID：539583
> 
> 赞同：34
> 
> 时间：2009-02-12T00:59:54.903
> 
> 标签：linux, bash, shell, ksh

广度优先列表很重要，在这里。此外，限制搜索的深度会很好。

```
$ find . -type d
/foo
/foo/subfoo
/foo/subfoo/subsub
/foo/subfoo/subsub/subsubsub
/bar
/bar/subbar

$ find . -type d -depth
/foo/subfoo/subsub/subsubsub
/foo/subfoo/subsub
/foo/subfoo
/foo
/bar/subbar
/bar

$ < what goes here? >
/foo
/bar
/foo/subfoo
/bar/subbar
/foo/subfoo/subsub
/foo/subfoo/subsub/subsubsub 
```

如果可能的话，我想使用 bash 单线来做到这一点。如果有一个 javascript-shell，我会想象类似的东西

```
bash("find . -type d").sort( function (x) x.findall(/\//g).length; ) 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-12-06T21:08:01.060

该`find`命令支持`-printf`识别大量占位符的选项。

一个这样的占位符是`%d`呈现给定路径的深度，相对于`find`开始的位置。

因此，您可以使用以下简单的单线：

```
find -type d -printf '%d\t%P\n' | sort -r -nk1 | cut -f2- 
```

它非常简单，不依赖于繁重的工具，例如`perl`.

这个怎么运作：

*   它在内部生成文件列表，每个文件都呈现为两个字段的行
*   第一个字段包含深度，用于（反向）数字排序，然后切掉
*   结果是简单的文件列表，每行一个文件，按最深的第一顺序

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-12T01:34:22.730

如果您想使用标准工具执行此操作，则应使用以下管道：

```
find . -type d | perl -lne 'print tr:/::, " $_"' | sort -n | cut -d' ' -f2 
```

那是，

1.  一阶深度查找并打印此处的所有目录
2.  计算每个目录中的斜杠数量并将其添加到路径中
3.  按深度排序（即斜线数）
4.  只提取路径。

要限制找到的深度，请将 -maxdepth 参数添加到 find 命令。

如果您希望以与 find 输出它们的顺序相同的顺序列出目录，请使用“sort -n -s”而不是“sort -n”；“-s”标志使排序稳定（即，保留相等比较的项目之间的输入顺序）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-04-03T08:06:16.837

您可以使用 find 命令， find /path/to/dir -type d 下面是当前目录中目录的示例列表：

```
find . -type d 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-07T16:20:07.467

我的感觉是，这是一个比前面提到的更好的解决方案。它涉及 grep 等以及一个循环，但我发现它工作得很好，特别是对于您希望行缓冲而不是完整的 find 缓冲的情况。

它更耗费资源，因为：

*   很多分叉
*   很多发现
*   当前深度之前的每个目录被 find 命中的次数与文件结构的总深度一样多（如果您实际上有任何数量的 ram，这应该不是问题......）

这很好，因为：

*   它使用 bash 和基本的 gnu 工具
*   它可以随时被打破（就像你看到你正在寻找的东西飞过一样）
*   它按行而不是按查找工作，因此后续命令不必等待查找和排序
*   它基于实际的文件系统分离工作，所以如果你有一个带有斜杠的目录，它不会被列出得比它更深；如果您配置了不同的路径分隔符，您仍然可以。

```
#!/bin/bash
深度=0

同时找到-mindepth $depth -maxdepth $depth | grep '.'
做
    深度=$((深度+1))
完毕
```

你也可以很容易地将它放在一条线上（？）：

```
depth=0; while find -mindepth $depth -maxdepth $depth | grep --color=never '.'; do depth=$((depth + 1)); done 
```

但我更喜欢小脚本而不是打字......

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-12T01:25:42.813

我认为您不能使用内置实用程序来做到这一点，因为在遍历目录层次结构时，您几乎总是需要深度优先搜索，无论是自上而下还是自下而上。这是一个 Python 脚本，可以为您提供广度优先搜索：

```
import os, sys

rootdir = sys.argv[1]
queue = [rootdir]

while queue:
    file = queue.pop(0)
    print(file)
    if os.path.isdir(file):
        queue.extend(os.path.join(file,x) for x in os.listdir(file)) 
```

**编辑：**

1.  使用`os.path`-module 代替`os.stat`-function 和`stat`-module。
2.  使用`list.pop`and`list.extend`代替`del`and`+=`运算符。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T01:26:59.037

我试图找到一种方法来做到这一点，`find`但它似乎没有任何类似的`-breadth`选择。如果不为其编写补丁，请尝试以下 shell 咒语（对于 bash）：

```
LIST="$(find . -mindepth 1 -maxdepth 1 -type d)";
while test -n "$LIST"; do
    for F in $LIST; do
        echo $F;
        test -d "$F" && NLIST="$NLIST $(find $F -maxdepth 1 -mindepth 1 -type d)";
    done;
    LIST=$NLIST;
    NLIST="";
done 
```

我有点偶然发现了这个，所以我不知道它是否一般有效（我只是在你询问的特定目录结构上测试它）

如果要限制深度，请在外部循环中放置一个计数器变量，如下所示（我也在为此添加注释）：

```
# initialize the list of subdirectories being processed
LIST="$(find . -mindepth 1 -maxdepth 1 -type d)";
# initialize the depth counter to 0
let i=0;
# as long as there are more subdirectories to process and we haven't hit the max depth
while test "$i" -lt 2 -a -n "$LIST"; do
    # increment the depth counter
    let i++;
    # for each subdirectory in the current list
    for F in $LIST; do
        # print it
        echo $F;
        # double-check that it is indeed a directory, and if so
        # append its contents to the list for the next level
        test -d "$F" && NLIST="$NLIST $(find $F -maxdepth 1 -mindepth 1 -type d)";
    done;
    # set the current list equal to the next level's list
    LIST=$NLIST;
    # clear the next level's list
    NLIST="";
done 
```

（将 2 替换`-lt 2`为深度）

基本上，这实现了标准的广度优先搜索算法，使用`$LIST`和`$NLIST`作为目录名称的队列。这是后一种方法，作为一种简单的复制和粘贴方法：

```
LIST="$(find . -mindepth 1 -maxdepth 1 -type d)"; let i=0; while test "$i" -lt 2 -a -n "$LIST"; do let i++; for F in $LIST; do echo $F; test -d "$F" && NLIST="$NLIST $(find $F -maxdepth 1 -mindepth 1 -type d)"; done; LIST=$NLIST; NLIST=""; done 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T01:17:06.000

没有应得的排序：find -maxdepth -type d

要获得应得的排序，您必须自己使用这个小 shellscript 进行递归：

```
#!/bin/bash
r () 
{
    let level=$3+1
    if [ $level -gt $4 ]; then return 0; fi
    cd "$1"
    for d in *; do
        if [ -d "$d" ]; then
            echo $2/$d
        fi;
    done
    for d in *; do
        if [ -d "$d" ]; then
            (r "$d" "$2/$d" $level $4)
        fi;
    done
}
r "$1" "$1" 0 "$2" 
```

然后您可以使用参数基目录和深度调用此脚本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T01:42:29.607

这是一种可能的方法，使用查找。我还没有彻底测试它，所以用户要小心......

```
depth=0
output=$(find . -mindepth $depth -maxdepth $depth -type d | sort); 
until [[ ${#output} -eq 0 ]]; do 
  echo "$output"
  let depth=$depth+1
  output=$(find . -mindepth $depth -maxdepth $depth -type d | sort)
done 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-22T16:42:39.957

像这样的东西：

```
find . -type d | 
  perl -lne'push @_, $_;
    print join $/,
      sort { 
        length $a <=> length $b || 
          $a cmp $b 
        } @_ if eof' 
```

# javascript - Javascript 弹出页面使文本在 Internet Explorer 中不可见

> ID：539598
> 
> 赞同：1
> 
> 时间：2009-02-12T01:08:08.347
> 
> 标签：javascript, popup, onclick

我正在做一个项目，在这个项目中我遇到了 Internet Explorer 中一个相当令人沮丧的问题。单击帮助链接时，我在特定页面上有一系列使用 JavaScript 打开的弹出窗口。他们的 JavaScript 是：

```
function openHelpPopUp(url) {
    newwindow=window.open(url,'name','width=620,height=440');
    if (window.focus) {newwindow.focus()}
    return false;
} 
```

使用的 HTML 是：

```
<a href="help.html" onclick="return openHelpPopUp('help.html')" title="More information" class="help-popup-link">Help</a> 
```

现在，弹出窗口在除 Internet Explorer 之外的所有浏览器中都能完美运行。目前的主要优先事项是让它在 IE7 中工作。

发生的情况是，它弹出很好，但文本不可见。如果您单击并将光标拖动到它上面并突出显示它，它就会变得可见。一旦您单击远离突出显示的区域以取消选择它，它就会保持可见。任何未突出显示的区域都将保持不可见。但是，当您刷新弹出窗口时，它有时会在没有任何突出显示的情况下变得可见，有时则不会。

同样奇怪的是，无序列表中的某些文本是可见的，但是当我使用相同的列表包含文本的其余部分时，它在已经可见的位上保持不可见。

你以前遇到过这个或类似的事情吗？你有什么提示或建议吗？我已经没有东西可以尝试了，因此非常感谢您对此提供任何反馈或帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T02:14:38.017

通过为 IE 的每个 P 标签添加一个 100 的 z-index，我现在似乎已经看到了它。奇怪的。我没有在其他地方使用过任何 z-index，HTML 的结构无论如何都应该将 P 放在顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T01:28:29.140

听起来像一个浏览器错误。

如果直接打开 URL 会发生什么？也许它与弹出窗口无关？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T02:58:26.257

> 它弹出很好，但文本不可见。如果您单击并将光标拖动到它上面并突出显示它，它就会变得可见

听起来可能是一个[IE7 变种](http://www.small-software-utilities.com/css/88/ie7-peekaboo-bug-disappearing-text/) [Peekaboo 错误](http://www.positioniseverything.net/explorer/peekaboo.html)，一个与在弹出窗口中打开无关的 IE 渲染问题。您必须向我们展示正在弹出的页面才能确定。

虽然我们在这里：

> 如果 (window.focus) {newwindow.focus()}

可能应该是 'if (newwindow.focus)' 假设目的是避免聚焦被阻塞的 'window.open()=null'。

# mysql - mySQL 数据库效率问题

> ID：539615
> 
> 赞同：0
> 
> 时间：2009-02-12T01:17:17.780
> 
> 标签：mysql, database, innodb

我有一个数据库效率问题。

这是关于我的桌子的一些信息：

- 大约 500-1000 条记录的表 - 每天添加和删除记录。- 通常每天添加和删除的数量大致相同（活动记录的大小保持不变）

现在，我的问题是......当我删除记录时，......我应该（A）删除记录并将其移动到新表吗？

或者，...我 (B) 是否应该只有“活动”列并在不再活动时将记录设置为 0。

我犹豫使用 B 的原因是因为我的网站基于用户能够动态过滤/排序 500-1000 条记录的表（使用 ajax）......所以我需要它尽可能快可能，..（我猜一个有更多记录的表过滤起来会更慢）...我正在使用 mySQL InnoDB。

任何输入都会很棒，谢谢

安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T01:27:40.187

约 1000 条记录是一个非常小的数字。

如果可以在以后删除并重新添加记录，那么拥有一个“活动”指示器可能是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T01:44:57.557

实际上，这不是关于数据库效率的问题，而是关于网络延迟和您通过网络发送的数据量的问题。就 MySQL 而言，1000 行或 100k 行将是闪电般的速度，所以这不是问题。

但是，如果您在这些行中有大量数据，并且您通过 AJAX 将其全部传输到客户端进行过滤，那么网络延迟就是您的瓶颈。如果您每行传输少量字节（例如 20 个）并且您的表的长度保持在 1000 条左右，这不是什么大问题。

另一方面，如果您的表（包含非活动记录）增长到 20k 行，那么现在您传输的是 400k 而不是 20k。您的用户会注意到。如果记录更大，随着表的增长，问题会更加严重。

你真的应该在服务器端进行过滤。让 MySQL 花 2ms 过滤您的表，然后再花一两秒钟通过 Ajax 发送它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T01:25:54.590

这取决于您过滤/排序的内容以及表的索引方式。

第三个并且不常见的选项，您可以采用混合方法，在该方法中停用记录 (B)（可选地使用时间戳）并定期将它们归档到单独的表 (A)（整体或基于时间戳年龄） .

实际上，如果您的表大约有 1000 行，则可能不值得为此大惊小怪（假设其他因素的可伸缩性已知）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T01:26:07.587

如果您需要为将来的目的保留记录，我会设置一个非活动位。

只要您在表上有一个主键，在`SELECT`读取记录时性能应该非常好。

此外，如果您在客户端进行过滤/排序，则只需检索一次记录。

# flash - Flash 安装的唯一标识符

> ID：539616
> 
> 赞同：0
> 
> 时间：2009-02-12T01:17:31.850
> 
> 标签：flash, uniqueidentifier

在 Flash 应用程序中，我想获取 Flash 产品 ID（或任何其他可以唯一标识特定 Flash 安装的标识符）。我在 SDK 中没有找到任何提供此功能的东西？有任何想法吗？

特里。
coatta@acm.org

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T02:39:29.423

一个

> 唯一标识特定 Flash 安装的标识符

会带来隐私风险，也就是“超级 cookie”：就像您无法拒绝或删除的浏览器 cookie。

一些控件（如 Windows Media Player）以前有这些，必须修复。我知道 Flash Player 中没有这样的东西，但如果有*一种*偷偷摸摸的方法来做到这一点，它就不会是一个你可以依赖的刻意的 API。

[您可以在Flash Local Storage](http://www.macromedia.com/support/documentation/en/flashplayer/help/help02.html)中放置一个标识符，这实际上几乎一样好，因为大多数人没有意识到该选项存在，因此很少有人将其关闭。（如果你这样做了，很多网站都会崩溃。即使你删除了存储的值，Flash 仍然会在本地记住你使用 Flash 访问过的所有网站。它不是一个非常注重隐私的插件。）

# sharepoint - sharepoint 内容类型 数据驱动

> ID：539623
> 
> 赞同：1
> 
> 时间：2009-02-12T01:21:22.200
> 
> 标签：sharepoint, sharepoint-2007

我正在为一个共享点项目（MOSS 2007）创建一个新的内容类型。此内容类型（字母模板）需要包含由共享点之外的数据驱动的元数据，例如模板类型（我们在另一个数据库中定义）。如何在 sp 中完成此操作（除了生成 xml 文件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T02:01:23.070

因此，您的信函模板内容类型有许多字段。这些字段的数据是否存储在外部数据库中？听起来像是[业务数据目录](http://msdn.microsoft.com/en-us/library/ms563661.aspx)（MOSS 功能，而不是 WSS）的工作。

另一种可能性是连接到数据库并检索数据的[项目事件接收器。](http://msdn.microsoft.com/en-us/library/dd239284.aspx)这绝对不是处理这种情况的首选方式，但实施起来可能更快。

h,

jt

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T02:16:59.430

您可以尝试将该内容类型导入 SharePoint 中的列表并将该列表用作源。如果数据库中的源经常更改，请设置一个作业以定期将数据拉入列表中。

# c++ - 为什么这个 C++ STL 分配器不分配？

> ID：539628
> 
> 赞同：12
> 
> 时间：2009-02-12T01:25:18.103
> 
> 标签：c++, stl, allocation

我正在尝试编写一个派生自的自定义 STL 分配器`std::allocator`，但不知何故所有调用都`allocate()`转到基类。我已将其缩小到以下代码：

```
template <typename T> class a : public std::allocator<T> {
public:
    T* allocate(size_t n, const void* hint = 0) const {
        cout << "yo!";
        return 0;
    }
};

int main()
{
    vector<int, a<int>> v(1000, 42);
    return 0;
} 
```

我期待“哟！” 打印出来，然后是一些可怕的错误，因为我实际上并没有分配任何东西。相反，该程序运行良好并且什么也不打印。我究竟做错了什么？

我在 gcc 和 VS2008 中得到相同的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T03:01:20.213

您将需要提供重新绑定成员模板和 C++ 标准的分配器要求中列出的其他内容。例如，您需要一个模板复制构造函数，它不仅接受`allocator<T>`而且还接受`allocator<U>`. 例如，一个代码可能会这样做，例如 std::list 可能会这样做

```
template<typename Allocator>
void alloc1chunk(Allocator const& alloc) {
    typename Allocator::template rebind<
        wrapper<typename Allocator::value_type>
      >::other ot(alloc);
    // ...
} 
```

如果不存在正确的重新绑定模板或不存在相应的复制构造函数，则代码将失败。猜测需求是什么，您将毫无用处。迟早您将不得不处理依赖于这些分配器要求的一部分的代码，并且代码将失败，因为您的分配器违反了它们。我建议您在您的标准副本中的一些工作草案中查看它们`20.1.5`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T02:12:29.283

在这种情况下，问题在于我没有覆盖分配器的重新绑定成员。此版本有效（在 VS2008 中）：

```
template <typename T> class a : public std::allocator<T> {
public:
    T* allocate(size_t n, const void* hint = 0) const {
        cout << "yo!";
        return 0;
    }

    template <typename U> struct rebind
    {
        typedef a<U> other;
    };
};

int main() {
    vector<int, a<int>> v(1000, 42);
    return 0;
} 
```

我通过 STL 标头调试发现了这一点。

这是否有效将完全取决于 STL 的实现，所以我认为最终，Klaim 是正确的，不应该以这种方式完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T17:07:45.437

我有两个用于创建自定义分配器的模板；如果在自定义类型上使用，第一个会自动工作：

```
template<>
class std::allocator<MY_TYPE>
{
public:
    typedef size_t      size_type;
    typedef ptrdiff_t   difference_type;
    typedef MY_TYPE*    pointer;
    typedef const MY_TYPE*  const_pointer;
    typedef MY_TYPE&    reference;
    typedef const MY_TYPE&  const_reference;
    typedef MY_TYPE     value_type;

    template <class U>
    struct rebind
    {
        typedef std::allocator<U> other;
    };

    pointer allocate(size_type n, std::allocator<void>::const_pointer hint = 0)
    {
        return reinterpret_cast<pointer>(ALLOC_FUNC(n * sizeof(T)));
    }
    void construct(pointer p, const_reference val)
    {
        ::new(p) T(val);
    }
    void destroy(pointer p)
    {
        p->~T();
    }
    void deallocate(pointer p, size_type n)
    {
        FREE_FUNC(p);
    }
    size_type max_size() const throw()
    {
        // return ~size_type(0); -- Error, fixed according to Constantin's comment
        return std::numeric_limits<size_t>::max()/sizeof(MY_TYPE);
    }
}; 
```

第二个用于当我们想要使用标准分配器为预定义类型使用自己的分配器时，例如 char、wchar_t、std::string 等：

```
 namespace MY_NAMESPACE
    {

    template <class T> class allocator;

    // specialize for void:
    template <>
    class allocator<void>
    {
    public:
        typedef void*       pointer;
        typedef const void* const_pointer;
        // reference to void members are impossible.
        typedef void        value_type;

        template <class U>
        struct rebind
        {
            typedef allocator<U> other;
        };
    };

    template <class T>
    class allocator
    {
    public:
        typedef size_t      size_type;
        typedef ptrdiff_t   difference_type;
        typedef T*      pointer;
        typedef const T*    const_pointer;
        typedef T&      reference;
        typedef const T&    const_reference;
        typedef T       value_type;

        template <class U>
        struct rebind
        {
            typedef allocator<U> other;
        };

        allocator() throw()
        {
        }
        template <class U>
        allocator(const allocator<U>& u) throw()
        {
        }
        ~allocator() throw()
        {
        }

        pointer address(reference r) const
        {
            return &r;
        }
        const_pointer address(const_reference r) const
        {
            return &r;
        }
        size_type max_size() const throw()
        {
            // return ~size_type(0); -- Error, fixed according to Constantin's comment
            return std::numeric_limits<size_t>::max()/sizeof(T);
        }
        pointer allocate(size_type n, allocator<void>::const_pointer hint = 0)
        {
            return reinterpret_cast<pointer>(ALLOC_FUNC(n * sizeof(T)));
        }
        void deallocate(pointer p, size_type n)
        {
            FREE_FUNC(p);
        }

        void construct(pointer p, const_reference val)
        {
            ::new(p) T(val);
        }
        void destroy(pointer p)
        {
            p->~T();
        }
    };

template <class T1, class T2>
inline
bool operator==(const allocator<T1>& a1, const allocator<T2>& a2) throw()
{
    return true;
}

template <class T1, class T2>
inline
bool operator!=(const allocator<T1>& a1, const allocator<T2>& a2) throw()
{
    return false;
}

} 
```

上面的第一个模板，对于您自己定义的类型，不需要任何进一步的处理，而是由标准容器类自动使用。第二个模板在用于标准类型时需要进一步的工作。例如，对于 std::string，在声明该类型的变量时必须使用以下构造（使用 typedef 最简单）：

```
std::basic_string<char>, std::char_traits<char>, MY_NAMESPACE::allocator<char> > 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T01:35:37.017

以下代码按预期打印“yo” - 您看到的是我们的老朋友“未定义行为”。

```
#include <iostream>
#include <vector>
using namespace std;

template <typename T> class a : public std::allocator<T> {
public:
    T* allocate(size_t n, const void* hint = 0) const {
        cout << "yo!";
        return new T[10000];
    }
};

int main()
{
    vector<int, a<int> > v(1000, 42);
    return 0;
} 
```

编辑：我刚刚检查了有关默认分配器的 C++ 标准。没有禁止继承它。事实上，据我所知，该标准的任何部分都没有这样的禁令。

# winapi - 如何获取 COM 单线程单元 (STA) 的窗口句柄？

> ID：539640
> 
> 赞同：1
> 
> 时间：2009-02-12T01:28:33.523
> 
> 标签：winapi, com

CoInitialize(NULL) 通过创建隐藏窗口来创建 STA。如何获取此窗口的 HWND 句柄？

函数 EnumThreadWindows 不起作用，在我尝试的示例中：

```
...

CoInitialize(NULL);

EnumThreadWindows(GetCurrentThreadId(), EnumThreadWndProc, 0);

...

BOOL CALLBACK EnumThreadWndProc(HWND hwnd, LPARAM lParam)
{
   m_hwnd = hwnd;

   return FALSE;
} 
```

没有任何东西进入 EnumThreadWndProc。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:42:05.673

这个隐藏的窗口是Message-Only Window，不可见，没有z-order，不能枚举，不接收广播消息。窗口只是发送消息。

要查找仅消息窗口，请在 FindWindowEx 函数的 hwndParent 参数中指定 HWND_MESSAGE。此外，如果 hwndParent 和 hwndChildAfter 参数都为 NULL，则 FindWindowEx 搜索仅消息窗口以及顶级窗口。

资料来源： [MSDN](http://msdn.microsoft.com/en-us/library/ms632599(VS.85).aspx#message_only)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T06:24:34.647

顺便说一句，我在这里会*非常*小心 - 你***真的***不应该将窗口消息发送到你不拥有的窗口。您的代码很可能在未来版本的 Windows 中中断。

# sharepoint - 以编程方式创建 MOSS 发布页面

> ID：539641
> 
> 赞同：4
> 
> 时间：2009-02-12T01:29:07.283
> 
> 标签：sharepoint, moss

创建 MOSS 发布页面时出现错误（这是一个完全干净的 MOSS 安装，还没有内置站点）。我正在使用我在很多博客上找到的代码，例如：

```
var pubWeb = PublishingWeb.GetPublishingWeb(Site.RootWeb);
SPContentTypeId ctId = new SPContentTypeId(contentTypeId);
var layouts = pubWeb.GetAvailablePageLayouts(ctId);
var layout = layouts[0];

var url = pageTitle.EndsWith(".aspx") ? pageTitle : pageTitle + ".aspx";
var newPage = pubWeb.GetPublishingPages().Add(url, layout); 
```

但是当我进行`pubWeb.GetPublishingPages().Add`方法调用时，出现以下错误：

> FormatException - 索引（从零开始）必须大于或等于零且小于参数列表的大小。

我检查了以下内容：

*   ContentTypeId 有效
*   布局有价值
*   pubWeb.GetPublishingPages().Count == 1

我似乎无法通过 Google 找到任何有用的东西，也无法在 Reflector 中找到任何可以提供帮助的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:19:39.047

我发现了问题所在，我使用的 ContentType 已损坏。由于另一个问题，我正在部署 ContentTypes（[请参阅此问题](https://stackoverflow.com/questions/539328/high-cpu-usage-when-deploying-content-types-via-a-sharepoint-feature)），我正在以编程方式创建 ContentType，但使用 CAML 部署 PageLayout。这导致 AssociatedContentType 不正确，因此当我使用它创建页面时，MOSS 无法确定要使用的 ContentType 并失败了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T02:08:09.030

检查您正在使用的 Web 是否是发布 Web。引用 MSDN 在[GetPublishingWeb](http://msdn.microsoft.com/en-us/library/ms497306.aspx)上的文章：-

> 在使用此方法之前，请检查 IsPublishingWeb 方法以确认此 SPWeb 类实例支持发布行为。如果 SPWeb 不支持发布，则 PublishingWeb 包装器的方法和属性可能会出现意外行为。

```
// Get the PublishingWeb wrapper for the SPWeb that was passed in.
PublishingWeb publishingWeb = null;
if (PublishingWeb.IsPublishingWeb(web))
{
    publishingWeb = PublishingWeb.GetPublishingWeb(web);
}
else
{
    throw new System.ArgumentException("The SPWeb must be a PublishingWeb", "web");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T01:59:59.173

尝试将站点添加到农场，然后使用[社交 msdn 中的以下代码](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/f1f9eddf-ab85-4b73-bc26-857eda23d12f/)：

```
public void FillPublishingWebWithPages 
    (string publishingSiteCollection, int pagesToCreate)
        {
        try
        {
           using ( SPSite site = new SPSite( publishingSiteCollection ) )
          {
             using ( SPWeb web = site.OpenWeb() )
             {
                  PublishingSite pubSite = new PublishingSite( site );
                  PublishingWeb pubWeb = PublishingWeb.GetPublishingWeb( web );
                  SPContentTypeId articleContentTypeID = 
                  new SPContentTypeId( "0x010100C568DB52D9D0A14D9B2FDCC96666E9F"+ 
                      "2007948130EC3DB064584E219954237AF3900242457EFB8B242478" );

        PageLayout[] layouts = pubWeb.GetAvailablePageLayouts( articleContentTypeID );
        PageLayout articlePageLayout = layouts[ 1 ];
        // create a temp name...
        string pageName = DateTime.Now.ToString( "yyyyMMdd-HHmmss" );
        // create the specified number of pages
        for ( int i = 0; i < pagesToCreate; i++ )
        {
              PublishingPage newPage = 
pubWeb.GetPublishingPages().Add( string.Format( "{0}_Gend_Page_{1}.aspx", pageName, i ), articlePageLayout );

          newPage.Title = "Hello";
          newPage.ListItem[ "PublishingContactName" ] = "valuetest";    
          newPage.Update();
          newPage.ListItem.File.CheckIn( "created" );
          newPage.ListItem.File.Publish( "created" );
          newPage.ListItem.File.Approve( "created" );
          pubWeb.Update();
        }

        web.Update();

        }

        }

        }

        catch ( Exception ex )

        {

          throw new Exception( 
          "Error in Page CREATION ----FillPublishingWebWithPages----", ex );

        }

        return;

        } 
```

示例调用：

```
FillPublishingWebWithPages( http://server:12345/sites/test/subsite1/subsite2/Pages/, 5 ); 
```

# asp.net - .NET StreamReader 不会关闭

> ID：539642
> 
> 赞同：2
> 
> 时间：2009-02-12T01:29:17.767
> 
> 标签：asp.net, vb.net, rtf, streamreader

我使用 RTF 文件作为 ASP.NET Web 应用程序的模板。我的 VB.NET 代码使用 StreamReader 读取文件，替换一些字符串，并使用数据库中的数据创建一个新的 Word 文档。我的代码关闭并处理了 StreamReader。但是，当我尝试将修改后的 RTF 文件上传到 Web 服务器时，我收到错误消息“无法打开文件进行写入”。因此很明显，在 ASP.NET 页面运行后很长时间该文件仍处于打开状态。

如何强制 StreamReader 关闭？即使编辑 web.config 文件以强制 Web 应用程序重新启动，也不足以终止对该文件的锁定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T02:08:19.950

考虑使用“使用”成语，也可在 VB.net 中使用

```
using(StreamReader reader = new StreamReader(...)) {

} 
```

即使抛出异常，流也会关闭

考虑像这样关闭所有 IDisposable 实现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T01:40:14.637

即使在关闭/处置之后它仍然挂起，这似乎很奇怪。您是否将 FileStream 与 StreamReader 一起使用？通常，我使用 FileStream 来控制对文件的访问并将其提供给 StreamReader，例如：

```
FileStream fsIn = new FileStream("path",FileMode.Open, FileAccess.Read, FileShare.None);
StreamReader srIn = new StreamReader(fsIn, System.Text.Encoding.Default);

//...do stuff....

srIn.close();
srIn.Dispose();
fsIn.close();
fsIn.Dispose(); 
```

更好的是，如果您将 StreamReader 的使用限制为一种方法，请将 Close/Dispose 粘贴到 finally。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:07:47.603

确保流最终关闭。

```
FileStream fsIn = null;
StreamReader srIn = null; 

try
{
  fsIn = new FileStream("path",FileMode.Open, FileAccess.Read, FileShare.None);
  srIn = new StreamReader(fsIn, System.Text.Encoding.Default);

  //...do stuff....

}
catch (Exception ex)
{
}
finally
{
  srIn.close();
  srIn.Dispose();
  fsIn.close();
  fsIn.Dispose();
} 
```

# iphone - 我们可以发布两个版本的 iphone 应用程序吗？

> ID：539650
> 
> 赞同：2
> 
> 时间：2009-02-12T01:35:23.180
> 
> 标签：iphone, distribution

你好，

我正在为澳大利亚的一位尊贵客户开发应用程序。在澳大利亚境外通过该应用访问内容时，他们存在某些版权问题。

是否可以通过 iTunes Store 获得该应用程序的本地版本和国际版本？国际版只有允许的内容。如果没有，请建议处理此问题的最佳选择。

感谢你在期待

干杯，

阿米特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T01:57:20.087

是的，您可以创建具有不同 SKU 的应用程序的两个版本。最好的方法是使用通配符证书并在应用程序的 plist 文件中使用不同的项目标识符。

使用 iTunes Connect 上的管理面板，您可以将 SKU 的销售限制在不同的地区。

当您支付 99 美元购买开发证书并将应用程序上传到 iTunes 时，这些选项将可用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T04:21:56.713

正如其他人所指出的，可以构建两个版本并使用 iTunes 商店根据买家所在的国家/地区限制分发。

然而，还有另一个问题需要考虑。您说问题是在澳大利亚以外的地方“通过应用程序访问内容”。但是您所在的平台本质上是移动的，并且可能与用户获得您的应用程序时所在的国家不同。如果有人在澳大利亚，合法获取应用程序，然后前往其他国家，会发生什么？他们不再在澳大利亚，但他们拥有假定他们在澳大利亚的应用程序副本。您客户的版权限制是否仍允许他们访问本应仅限于澳大利亚的内容？

如果没有，您的问题与使用应用商店限制完全不同。但这也可能意味着您可以更好地解决不需要多个版本的应用程序的问题。

想一想：iPhone 知道它在哪里。3g 手机可以获得 GPS 准确的位置信息，而旧款手机只要有电话网络连接就可以获得合理的近似值。这给了你纬度/经度坐标。

然后怎样呢？由于您的家乡区域定义非常明确，因此它可能很简单——在地图上围绕澳大利亚画一个矩形，并将“在澳大利亚”定义为在该矩形中（作为整个大陆在这里很方便）。如果您想要更精确的信息，请将经纬度输入反向地理编码 API（有很多——例如，Flickr 有一个）以找出您所在的国家/地区。

瞧，您可以让应用程序在澳大利亚以一种方式运行，在澳大利亚以外以另一种方式运行，您只需要一个应用程序版本即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T01:54:23.087

您可以限制在哪个国家/地区销售哪些应用程序。您可以将您的澳大利亚应用程序限制在澳大利亚并在全球范围内销售另一个应用程序。

# html - 服务器端包含和字符编码

> ID：539661
> 
> 赞同：4
> 
> 时间：2009-02-12T01:39:53.933
> 
> 标签：html, character-encoding, server-side-includes, ssi

我创建了一个[静态网站](http://chaletsdesbouleaux.com/)，其中每个页面都具有以下结构：

1.  常见的东西，如标题、菜单等。
2.  主要内容 div 中的页面特定内容
3.  页脚

在这个网站中，所有常见的内容都在每个页面中重复。为了提高可维护性，我重构了页面以使用服务器端包含（SSI），这样公共内容就不会重复。现在每个页面的结构是

1.  SSI 用于常见的东西，如标题、菜单等。
2.  主要内容 div 中的页面特定内容
3.  页脚的 SSI

在重构的站点中，由于某种原因，法语字符在特定于页面的内容区域中不再正确显示，尽管它们在通过 SSI 包含的内容中显示良好。

包含的标头将字符集指定为：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

如果我在浏览器中打开其中一个主要内容页面，它会告诉我字符编码是 ISO-8859-1。我尝试使用以下行将 .htaccess 文件添加到文件夹中

```
AddDefaultCharset UTF-8
AddCharset UTF-8 .shtml
AddCharset UTF-8 .html 
```

但是那些讨厌的法国口音仍然无法在使用 SSI 的网站版本上正确显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:46:07.083

您将页面提供为 UTF-8，这很好，但至少有一些页面是从实际上未保存为 UTF-8 的文件中拖入的。SSI 只是将原始字节扔进去，它不会尝试重新编码包含，以便它们的字符集与它们被包含到的文件相匹配。

您需要浏览所有 html 并在文本编辑器中包含文件，并确保每个文件都保存为 UTF-8。

正如 John 所提到的，您*可以*通过对所有非 ASCII 字符使用字符引用来避免编码问题，但这是一个巨大的痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-29T22:46:03.540

我遇到了和你一样的问题，终于找到了解决方法。

[UTF8 在我的网站上增加了一行](https://stackoverflow.com/questions/4852390/utf8-makes-an-extra-line-on-my-site)

将所有文件保存为不带 BOM 的 UTF-8 ( [http://en.wikipedia.org/wiki/Byte_order_mark](http://en.wikipedia.org/wiki/Byte_order_mark) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T01:46:00.050

您的 HTML 文档使用 UTF-8 编码，请为您的重音字母尝试以下字符代码：[http ://www.tony-franks.co.uk/UTF-8.htm](http://www.tony-franks.co.uk/UTF-8.htm)

# java - 类型系统的学术符号

> ID：539668
> 
> 赞同：2
> 
> 时间：2009-02-12T01:41:50.823
> 
> 标签：java

我正在尝试了解有关编程语言设计的[学术论文](http://www.cis.upenn.edu/%7Ebcpierce/papers/fj-toplas.pdf)（pdf）。特别是，它描述了称为 Featherweight Java 的轻量级 Java 版本。它具有如下符号的打字规则：

```
x_ : C_, this : C |- e0 : E0         E0 <: C0
class C extends D {...}
if mtype(m,D) = D_->D0, then C_ = D_ and C0 = D0
---------------------------------------------------------------------------
C0 m(C_ x_){ return e0; } OK IN C 
```

无论如何，这是我在文本中复制它的最佳尝试。然而，该论文似乎假设这种符号是熟​​悉的，几乎没有解释它。谁能指出我更好的解释方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T22:21:35.883

这是一个特别复杂的例子，里面有一些不同的事情。

单杠符号通常用于*推理规则*。行上方是前提（通常在一行上用空格分隔），行下方是结论。例如，

```
P0   P1   ...   Pn
------------------
        C 
```

意思是“如果全部成立`P0`，`Pn`那么我们可以得出结论也`C`成立。”

旋转门符号 (⊦) 通常用于*蕴涵关系*。在类型系统中，这通常意味着“如果我们假设左侧的类型，我们可以派生右侧的类型”。冒号通常用于将变量或表达式与类型相关联，因此

```
x_ : C_, this : C ⊦ e0 : E0 
```

意思是“假设`x_`有类型`C_`并且`this`有类型`C`，我们可以推导出`e0`有类型`E0`。”¹

该符号`<:`通常用于子类型关系，但这*应该*在论文中明确定义。

“ `class C extends D`”位似乎是指源程序的语法。即，预期的前提是“`C`被明确声明为扩展`D`”。

如果不涉入纸中，其余部分就很难摸索。我衷心赞同 Norman Ramsey 对[Pierce](http://www.cis.upenn.edu/~bcpierce/tapl/)的推荐，作为对类型理论的一个很好的介绍。

¹ 请注意，“推理”和“蕴含”之间的区别要么是微妙的，要么是不存在的——在哪里使用哪个是惯例、品味和/或细微差别的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T03:31:29.017

Benjamin Pierce 的本科教科书[Types and Programming Languages](http://www.cis.upenn.edu/~bcpierce/tapl/)将教您理解 Featherweight Java 论文中使用的符号所需要知道的一切。（我认为 Pierce 也可能是那篇论文的合著者。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-12T01:59:06.447

看起来像[形式语义](http://en.wikipedia.org/wiki/Formal_semantics_of_programming_languages)，在这种语法情况下可能是[指称语义](http://en.wikipedia.org/wiki/Denotational_semantics)，但有些符号看起来非常神秘。

# iteration - 在 Python 中为 NP-Complete(?) 问题获取对象的所有可能状态

> ID：539676
> 
> 赞同：0
> 
> 时间：2009-02-12T01:45:41.703
> 
> 标签：iteration, python, combinatorics

不确定该示例（也不是实际用例）是否符合 NP-Complete 的条件，但我想知道最 Pythonic 的方式来执行以下操作，假设这是可用的算法。

说你有：

```
class Person:
  def __init__(self):
    self.status='unknown'
  def set(self,value):
    if value:
      self.status='happy'
    else :
      self.status='sad'
  ... blah . Maybe it's got their names or where they live or whatev. 
```

以及一些需要一组人员的操作。（这里的关键值是 Person 是快乐还是悲伤。）

因此，给定 PersonA、PersonB、PersonC、PersonD - 我想最终列出可能的 2**4 个悲伤和快乐人物组合的列表。IE

```
[
[ PersonA.set(true), PersonB.set(true), PersonC.set(true), PersonD.set(true)], 
[ PersonA.set(true), PersonB.set(true), PersonC.set(true), PersonD.set(false)], 
[ PersonA.set(true), PersonB.set(true), PersonC.set(false), PersonD.set(true)], 
[ PersonA.set(true), PersonB.set(true), PersonC.set(false), PersonD.set(false)], 
etc.. 
```

有没有一种很好的 Pythonic 方式来做到这一点？我在考虑列表推导（并修改对象以便您可以调用它并返回两个对象，true 和 false），但我看到的推导格式需要我提前知道 Persons 的数量。我想独立于人数来做到这一点。

编辑：假设我要运行的那个操作是一个更大的问题集的一部分——我们需要测试给定集的所有 Person 值以解决我们的问题。（即我知道这现在看起来不是 NP-complete =））有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T01:53:54.883

我认为这可以做到：

```
l = list()
for i in xrange(2 ** n):
    # create the list of n people
    sublist = [None] * n
    for j in xrange(n):
        sublist[j] = Person()
        sublist[j].set(i & (1 << j))
    l.append(sublist) 
```

请注意，如果您编写`Person`以便其构造函数接受该值，或者该`set`方法返回人本身（但这在 Python 中有点奇怪），您可以使用列表推导。用构造方法：

```
l = [ [Person(i & (1 << j)) for j in xrange(n)] for i in xrange(2 ** n)] 
```

解决方案的运行时间`O(n 2**n)`可以通过查看循环来判断，但这并不是真正的“问题”（即带有是/否答案的问题），因此您不能真正称其为 NP-complete。请参阅[什么是计算机科学中的 NP 完全？](https://stackoverflow.com/questions/210829/what-is-an-np-complete-problem)有关这方面的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T03:06:23.430

您可以使用笛卡尔积来获取人员和状态的所有可能组合。需要 Python 2.6+

```
import itertools
people = [person_a,person_b,person_c]
states = [True,False]
all_people_and_states = itertools.product(people,states) 
```

变量*all_people_and_states*包含一个元组列表 (x,y)，其中 x 是一个人，y 是 True 或 False。它将包含所有可能的人和状态配对。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-14T02:23:09.710

根据你在问题中所说的，你是对的 - 你确实需要`itertools.product`，但不完全是你所说的方式。

```
import itertools
truth_values = itertools.product((True, False), repeat = 4)
people = (person_a, person_b, person_c, person_d)
all_people_and_states = [[person(truth) for person, truth in zip(people, combination)] for combination in truth_values] 
```

这应该更符合您在问题中提到的内容。

# php - 类变量、范围解析运算符和不同版本的 PHP

> ID：539677
> 
> 赞同：0
> 
> 时间：2009-02-12T01:45:47.040
> 
> 标签：php, class-variables

我在 codepad.org 中尝试了以下代码：

```
class test { 
  const TEST = 'testing 123';
  function test () {
    $testing = 'TEST';
    echo self::$testing;
  }
} 
$class = new test; 
```

它返回：

```
1
2 Fatal error: Access to undeclared static property:  test::$testing on line 6 
```

我想知道使用变量引用类常量是否可以在我家运行 php 5.2.9 而 codepad 使用 5.2.5 的服务器上工作。每个 PHP 版本的类变量有哪些变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T01:55:21.743

> 范围解析运算符（也称为 Paamayim Nekudotayim）或更简单的术语是双冒号，是允许访问类的静态、常量和重写成员或方法的标记。

您在函数 test ($testing) 中定义的变量不是静态或常量，因此范围解析运算符不适用。

```
class test { 
  const TEST = 'testing 123';
  function test () {
    $testing = 'TEST';
    echo $testing;
  }
} 

$class = new test; 
```

或者只是访问类外的常量：

```
test::TEST; 
```

如果使用正确，它应该可以在您家中的服务器上运行。关于从 PHP4 到 PHP5 的 OOP 更改，[php 文档](http://au.php.net/manual/en/language.oop5.php)可能有用。虽然只是在我的脑海中，但我会说 PHP5 与类变量相关的主要变化是它们的可见性、静态和常量。所有这些都包含在提供的文档链接中。

# cocoa-touch - 什么会导致 UIView 从层次结构中任意删除？

> ID：539680
> 
> 赞同：1
> 
> 时间：2009-02-12T01:46:08.910
> 
> 标签：cocoa-touch

我有一个 iPhone 应用程序，对于某些用户来说，它有时表现得好像主 UIView 已从视图层次结构中删除。它总是与游戏中的重大事件同时发生。其他以 z 顺序位于其上方的 Core Graphics 绘制的 UIView 仍然存在，但主要的 UIView（OpenGL 视图）似乎消失了，留下了背景（纯色）。

该应用程序不会崩溃（它会继续运行，没有视图），并且对于受影响的用户来说，这似乎非常一致地发生。不幸的是，我无法重现它。

我怀疑是内存问题——这将是最简单的解释——但根据我的阅读，它看起来 didReceiveMemoryWarning 只释放不可见的视图，除此之外，我的应用程序的内存使用量非常小。此外，“重要事件”只会导致 OpenGL 绘图和 SoundEngine 调用——没有视图操作。

有没有人以前见过这样的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T01:51:04.423

是的，事实上我的一个应用程序偶尔会出现这个问题，而且它似乎与内存有关。

通过调试或分析程序流程，我都没有成功跟踪它。我已经证实有问题的视图已被破坏，而不仅仅是以某种方式隐藏。

它很少发生，以至于我没有深入研究它，但我确实认为它是由操作系统中的某些东西引起的，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:48:10.893

如果它与内存相关，您可以轻松地在模拟器中测试低内存以调试此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T15:04:51.230

问题最终是在应用程序的计时器线程中抛出了一个未捕获的 NSException（来自第三方库），它杀死了计时器线程，但没有杀死应用程序的其余部分。好消息是在这种情况下会生成崩溃报告，如果您知道查找/询问它们，可以更容易地跟踪它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-12T01:52:34.123

正如 SDK 文档中明确指出的，当您的应用程序内存不足时，可以收集未使用的视图。当再次需要它时，它会被重新创建。这是为了节省宝贵的 iPhone 资源。最好的办法是保留视图，使其无法被释放。

# delphi - 如何在我的应用程序的 MDI 窗口中显示来自另一个进程的窗口

> ID：539684
> 
> 赞同：1
> 
> 时间：2009-02-12T01:49:10.853
> 
> 标签：delphi

我正在 Delphi 中开发 MDI 应用程序。

我想在我的应用程序的 MDI 子窗口中显示由其他应用程序（我也构建）生成的交互式视图。

当用户在我的应用程序中选择特定视图类型时，它将启动另一个应用程序的实例，该实例将生成一个或多个数据视图，显示在我的应用程序的 MDI 子窗口中。

我希望这很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T02:09:44.377

您可以生成另一个应用程序，获取与该进程关联的窗口句柄，然后将该窗口句柄的父级设置为与 MDI 应用程序中的窗体或面板关联的句柄。

查看以下 Win32 函数...

*   GetParent(hWnd)
*   SetParent（hWndChild，hWndNewParent）

您可能还需要...

*   SetWindowPos（hWnd，hWndInsertAfter，X，Y，cx，cy，uFlags）
*   SetWindowLong(hWnd, nIndex, dwNewLong);
*   GetWindowLong(hWnd, nIndex);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T13:52:39.257

为什么不写一个 ActiveX 控件？它专为此类工作而设计（例如，考虑 Outlook 如何使用 Word 文本编辑器）。此外，通过这条路线，您的应用程序也可以与非 Delphi 应用程序进行交互。您将能够在 MDI 窗口中显示非 Delphi 应用程序，例如 Word 和 Excel，并且您的应用程序将能够在非 Delphi ActiveX 主机（例如 Word）中显示它们的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T09:38:14.597

如果您想模块化您的应用程序，我认为最好使用 dll 来定义表单。

为此，您在 dll 或 dpk 中定义表单类，然后从应用程序加载它。

如果您正在使用 MDI 表单，我建议您使用普通的空 MDI 表单并在取出边框内显示您的 dll 表单，如下所示：

```
DllForm.FormStyle:=fsNormal;
DllForm.BorderStyle:=bsNone;
DllForm.Parent := MDIForm;
DllForm.Align := alClient; 
```

您可以在[此处](http://www.ehow.com/how_2109379_use-forms-dll.html)找到有关从 dll 加载表单的文章。

# oracle - 10g 中的 Oracle 登录协议 (O3LOGON)

> ID：539692
> 
> 赞同：4
> 
> 时间：2009-02-12T01:53:26.070
> 
> 标签：oracle, authentication, protocols

我一直在研究 Oracle 针对 10g 数据库进行身份验证的机制。尽管它的文档比其 9i 版本少，但我仍然设法在各种网站和博客上找到了它的许多详细信息。然而，一件仍然是一个谜。在我提到缺少什么之前，让我用伪代码解释一下对协议的了解：

```
// CLIENT SIDE PSEUDO CODE

user = "SCOTT"
password = "TIGER"
password_hash = oracle_password_hash(user, password)

// 1\. Client provides user name to server
send(user)

// 2\. Server responds with its encrypted AUTH_SESSKEY, 
//    a randomly generated number associated with the current session
encrypted_server_AUTH_SESSKEY = receive_AUTH_SESSKEY() // 32 bytes

decrypted_server_AUTH_SESSKEY = aes_decrypt(
    encrypted_input => encrypted_server_AUTH_SESSKEY,
    decryption_key  => password_hash
)

// 3\. Client generates its own AUTH_SESSKEY for this session
unencrypted_client_AUTH_SESSKEY = generate_random_AUTH_SESSKEY() // 32 bytes

encrypted_client_AUTH_SESSKEY = aes_encrypt(
    unencrypted_input => unencrypted_client_AUTH_SESSKEY,
    encryption_key    => password_hash
)

// 4\. Client combines the two AUTH_SESSKEYs using a known Oracle-specific algorithm
combined_AUTH_SESSKEYs = oracle_combine(decrypted_server_AUTH_SESSKEY, unencrypted_client_AUTH_SESSKEY)

// 5\. Client builds AUTH_PASSWORD
unencrypted_AUTH_PASSWORD = byte[32]
unencrypted_AUTH_PASSWORD[0 .. 16] = ??? // THIS IS THE PROBLEM
unencrypted_AUTH_PASSWORD[16 .. 16 + len(password)] = password
unencrypted_AUTH_PASSWORD[16 + len(password) .. ] = PKCS#7 padding

// 6\. Client encrypts the AUTH_PASSWORD data using the combined AUTH_SESSKEYs as the encryption key
encrypted_AUTH_PASSWORD = aes_encrypt(
    unencrypted_input => unencrypted_AUTH_PASSWORD,
    encryption_key    => combined_AUTH_SESSKEYs
)

// 7\. Client transmits its encrypted AUTH_SESSKEY and AUTH_PASSWORD to server for verification
send(encrypted_client_AUTH_SESSKEY, encrypted_AUTH_PASSWORD) 
```

**Oracle 客户端在步骤 5 中将 AUTH_PASSWORD 值的低 16 个字节放入了什么？**

我发现的几乎所有文档都只关心获取其中包含的纯文本密码，很少注意这些第一个字节。我曾尝试查看 JDBC 驱动程序，但似乎即使是 10g 版本也通过请求服务器恢复为旧方案（这恰好更好理解）来避免这种身份验证方案。一个优秀的[C 程序](http://www.oxid.it/downloads/oracle_tns_aes128_check.txt)演示了 AUTH_PASSWORD 的解密。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T14:00:17.633

我已经确定明文密码之前的 16 个字节是随机生成的（好奇的可以看看 oran10.dll 库导出的 ztvo5pe 函数——你会看到对 ztcen 的两次连续调用，第一次调用填充它在）。

我最初发布这个问题是因为我正在编写一个小程序来连接到 Oracle 数据库而不使用 Oracle 的 JDBC 驱动程序。我发现数据库拒绝了我的 32 字节 AUTH_PASSWORD。我假设它被拒绝了，因为我在前 16 个字节中输入了不正确的值。我错了。这些似乎对用户是否进行身份验证没有任何影响。

相反，事实证明数据库拒绝了我的 AUTH_PASSWORD 因为紧跟在纯文本密码之后的**尾随字节。**我天真地用零填充缓冲区。它应该根据 PKCS #7 规范进行填充。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-22T06:04:04.377

如果密码长度<16，前16个字节是随机数据，那么密码，填充数据是char of (16 – strlen(password))。Oracle 服务器可以接受我的 AUTH_PASSWORD。如果密码长度>= 16，我不知道该怎么做。我用随机数据填充了前 16 个字节，但服务器拒绝了我的数据。我想知道：您确定填充数据符合 PKCS#7 规范吗？

# metrics - 哪些指标可用于确定特定编程语言的专业水平

> ID：539694
> 
> 赞同：6
> 
> 时间：2009-02-12T01:53:52.310
> 
> 标签：metrics

我对用于掌握一个人用特定语言编程的能力的原始（或复合）指标很感兴趣。

*场景：George 会一些编程语言并想学习“foobar”，但他想知道他何时对“foobar”有足够的经验。*

除了 LOC（代码行）指标，我对更广泛的东西非常感兴趣。

我对这个问题的希望是了解工程师如何量化其他人的编程语言经验，以及这是否可以机械地测量。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:15:19.467

在回复前两张海报时，我猜想有*一种*方法可以掌握一个人在特定语言中的编程能力：您可以测试某人对英语、数学、音乐或医学的了解程度，或者美术，那么编程语言有什么特别之处呢？

作为对 OP 的回复，我想测试必须评估：

*   你的编程能力如何
*   您可以如何使用编程语言

因此，指标可能是：

1.  这个人的编程有什么好处（有很多方面的好处，例如无错误、可维护、编写快/便宜、运行快、满足用户要求等）？

2.  该人是否使用相关编程语言的适当/惯用功能来进行良好的编程？

但是，要使测试“机械化”是很困难的：我所知道的大多数考试都是由人工考官评分的。在编程的情况下，可以对部分测试进行机械评分（即“它是否运行？”），但其中一部分（“它是否可以理解和惯用？”）旨在使其他人受益，并更好地由其他人判断程序员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T02:15:43.067

在我看来，你在特定语言方面的专业知识的最佳指标是你在这门语言中的工作效率。

生产力不仅仅是你的工作速度有多快，更重要的是，你创造了多少错误，以及以后需要多少重构/返工。

例如，如果您使用两种您具有相似经验水平的语言，并且（在平行宇宙中）用这两种语言构建相同的系统，我会说您构建系统的语言更快，缺陷/设计缺陷更少，是您更擅长的语言。

抱歉，这对您来说不是一个“硬”指标，而是一种更实用的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T02:01:45.753

我不相信这可以“机械测量”。不过，我已经[考虑](http://pointbeing.net/weblog/2008/08/some-thoughts-on-testing-developers.html)了很多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T02:44:25.947

不挂断...

就连节目的“LOC”也是一个争议很大的话题！（例如，我们是在谈论 cat *.{h,c} | wc -l 或其他一些机制的输出吗？空行呢？评论？评论重要吗？是否记录了好的代码？）

在您意识到 LOC 比较是多么无意义之前，您没有希望意识到其他指标是多么无意义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T02:10:58.260

这是一个相当定性的事情，很少能以任何高精度测量。这就像问“爱因斯坦有多聪明？”。认证是一个（并且是相当彻底的）量化指标，但即使它也远远不能像许多招聘人员发现的那样识别“优秀的程序员”。

你最终想要达到什么目标？在某些情况下，一般的编程能力可能比语言专业知识更重要。

如果您专注于语言，那么使用该语言接受像[Project Euler](http://projecteuler.net/ "欧拉计划")这样的挑战可能是跟踪进度的一种方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T03:11:34.510

他们在用该语言调试复杂问题方面有多熟练。

询问他们过去从事的项目，遇到的困难问题以及如何解决这些问题。向他们询问他们使用过的调试技术——你会惊讶于你所听到的，你甚至可能会学到一些新东西 ;-)

很多地方都有一两个人在他们的领域是超级明星——当其他人无法弄清楚他们的程序出了什么问题时，他们就会去找那个人。我猜这就是你要找的人:-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T03:24:51.717

具有编程语言的设施是不够的。所需的是在特定平台上的特定库套件的上下文中使用编程语言

*   Windows 32 位 Winapi 上的 C++
*   Linux 上 KDE 上的 C++
*   诺基亚 S60 手机上的 Symbian 上的 C++
*   Windows 上 MS .NET 上的 C#
*   Linux 上 Mono 上的 C#

在这种情况下，在目标平台上使用目标语言的能力度量如下：

*   简洁有力地表达常见模式的能力。
*   能够调试常见但微妙的错误，如竞态条件。

可以为程序员开发一套基准练习。一旦有大量样本可用，人们也可以确定能力的钟形曲线。准备这些东西实际上需要数年时间，而且它们很快就会被淘汰。这（以及普遍的紧张）是组织不打扰的原因。

还需要在“工具制造者”和“工具使用者”模式下对人员进行评分。工具制造者是非常不同的人，他们的能力水平要高得多，但他们通常不适合猴子的工作，而你真的需要一个工具用户。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-15T16:37:00.310

约翰

有几种方法可以解决您的问题：

1) 如果您正在面试需要特定语言的特定职位的候选人，那么比较候选人的唯一衡量标准是“这个人用这种语言写作多久了”。它并不完美——它甚至不是很好——但它是现实。除非你想给候选人一个问题、一台计算机和一个编译器来现场测试他们，否则没有其他措施。然后大多数程序员类型在“有人在看着你”的场景中表现不佳。

2）我将您的问题解释为“我什么时候可以称自己精通一种语言？” 为此，我将参考学习非母语的水平：第一级是您需要在字典（书）中查找单词/短语才能说出或理解任何内容；第二级是你可以理解听到的语言（或阅读代码），只需要偶尔在你信任的、现在已经破旧的字典中查找；第三级，您现在只需偶尔查找即可说话（或编写代码）；第四层是你在语言中梦想的地方；最后一级是让母语人士误以为你也是母语人士的地方（在编程中，其他专家会认为你可能帮助开发了语言语法）。

请注意，这无助于确定您的程序员有多好——就像知道英语而不必在字典中查找单词并不能显示“你在写东西方面有多好”一样——这是主观的，没有什么可做的使用特定的语言，因为擅长编程的人擅长你给他们的任何语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-20T05:02:50.030

短语“合理数量的经验”取决于所考虑的语言以及该语言的用途。

度量是测量的结果。史蒂文斯（参见维基百科：测量水平）提出测量使用四种不同的尺度类型：名义（分配标签）、序数（分配排名）、间隔（对测量进行排序）和比率（具有非任意零起点） . LOC 是比率测量值。虽然远非完美，但我认为 LOC 是一个相关的、客观的数字，表明您在语言方面拥有多少经验，并且可以与软件行业的可量化值进行比较。但是，这就引出了一个问题：这些行业价值从何而来？

就个人而言，我会说“乔治”在设计、实施和测试一个项目时会知道他有相当多的经验，如果需要的话，可能是他自己选择在他的个人时间在他的家用电脑上。例如：数据库、业务应用、网页、GUI测试工具等。

从招聘经理的角度来看，我首先会问程序员他/她的语言有多好，但这不是衡量标准。我一直认为，衡量一个人编写程序能力的最好方法是给程序员几个小的编程问题，这些问题是预先考虑好的，并在给定的时间内解决，比如每个 5 分钟。我从不反对在工作面试中对我这样做。有几个指标可用：程序员是否能够解决问题（是或否 - 名义上的）？花了多少时间（分钟数 - 比率）？他们解决问题的方法有多有效（好、公平、差 - 有序）？您不仅可以学习人们编写代码的能力，还可以观察到一些主观的事情，例如他们解决问题时的行为，

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-06T14:03:57.453

尽管如此，我仍然相信有一些很好的指标，比如用于圈复杂度的[McCabe Cyclomatic Metric](http://www.linuxjournal.com/article/8035)，或者每个代码块的有用注释数量，甚至是两次连续测试之间编写的平均代码量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T01:59:01.393

我不知道这样的事情。我不相信关于如何量化经验或“合理”意味着什么的共识。也许我也会学到一些东西，但如果我这样做了，那将是一个很大的惊喜。

[这](https://stackoverflow.com/questions/189064/metrics-object-oriented-programming)可能是相关的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T02:19:33.277

我发现测试调试能力比任何针对我遇到的简单编程问题的测试更准确地衡量编程技能。给定具有已声明（或在某些情况下未声明）不当行为的合理规模的类或函数的来源，被测者能否找到问题？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T02:31:01.907

嗯，他们在工作面试中尝试过。没有衡量标准，但您可以通过提问和测验来评估一个人的能力。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-12T02:50:50.753

WTF/s * LOC，越小越好。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-12T02:58:54.307

没有了; 专业知识只能相对于他人主观判断，或根据具体情况进行测试（有其自身的不准确程度）

了解更多信息，请查看[代码指标的魅力所在](https://stackoverflow.com/questions/195887/what-is-the-fascination-with-code-metrics)

# html - 使用无图像按钮有什么好处？

> ID：539703
> 
> 赞同：14
> 
> 时间：2009-02-12T01:59:26.023
> 
> 标签：html, css, image

关于[这个](https://stackoverflow.com/questions/520640/how-can-i-use-googles-new-imageless-button-how-could-i-reverse-engineer-or-rol/534048#534048)问题“[如何使用谷歌新的无图像按钮？](https://stackoverflow.com/questions/520640/how-can-i-use-googles-new-imageless-button-how-could-i-reverse-engineer-or-rol) ”的回答的讨论已经提示了这个问题。

出于某种原因，谷歌似乎认为无图像是好的，但从引用的评论来看，我看不到它的优势。发送数十行 HTML 是否值得，谁知道要渲染这些无图像按钮需要多少 CSS，而不是简单地加载另一个图像，尤其是当 CSS sprite 等技术可用时？

什么时候会首选这种技术？另一个问题是如何做到这一点，但我想知道为什么**应该**这样做。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T03:15:31.537

1.  本地化（翻译文本比翻译图像更容易）
2.  皮肤/主题（使用单个 CSS 更改外观比重新创建多个图像更容易）
3.  辅助功能（屏幕阅读器可以正常阅读，文本缩放正常）
4.  性能（CSS 是共享的，因此从服务器加载一次）
5.  功能（当您不必更改整个图片时，使用新的 UX 元素（如下拉箭头）更容易扩展按钮）

顺便说一句，“无图像”按钮也可能包含视觉模板内的图像。这种方法与 XAML 对可视化树进行模板化和样式化的方法非常相似。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T02:04:47.493

我认为在这种特定情况下，我只能看到可以以编程方式生成按钮的优势。如果你不知道你的按钮会说什么，这样做可能比使用某种图像库生成器生成它更容易。

*此外，更改一个 CSS 可以让您一次更改所有*按钮的外观。使用图像按钮，您需要更新每个人和每个图像。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T02:05:17.307

这样做不是因为按钮的高度可能不同（例如文本大小）吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T02:06:10.487

1.  页面加载更流畅，因为无需加载任何图像，并且会比其他图像更晚出现

2.  在有人无法阅读/查看图像的情况下，按钮文本也是可读的，但您具有图形外观。*（以传统方式围绕真实*文本构建带有图像的图形按钮与这种方法一样复杂的 HTML）

3.  正如他们在博客中提到的，这些按钮无需创建和存储自定义图像即可换肤。

基本上，您可以获得纯文本按钮相对于自定义图像的所有优势，同时仍然具有漂亮的、可换肤的图形外观。

# regex - 在这个正则表达式上寻找一个 URI 匹配，但它正在使正则表达式测试器崩溃

> ID：539711
> 
> 赞同：1
> 
> 时间：2009-02-12T02:05:50.597
> 
> 标签：regex

我正在尝试使用这个正则表达式，但我在测试它时遇到了麻烦，因为无论出于何种原因，它都会使我使用的仅有的两个正则表达式测试器崩溃。

^([a-zA-Z-]+/?)+$

如果我没记错的话，那应该匹配任何遵循这种格式的 URI：

一些 uri 字符串/一些 uri 字符串/一些 uri 字符串

但是，我不希望它匹配：

some-uri-string/some-uri-string//some-uri-string

注意双斜线。本质上就是category/sub-category/sub-sub-category/page

允许任意数量的子类别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:16:37.107

问题在于，对于不匹配的字符串，您的模式是回溯正则表达式引擎的病态案例（大多数脚本语言中的情况都是如此，例如 Perl、Python 和任何基于 PCRE 的语言）。

更多信息：

*   [http://swtch.com/~rsc/regexp/regexp1.html](http://swtch.com/~rsc/regexp/regexp1.html)
*   [http://www.regular-expressions.info/catastrophic.html](http://www.regular-expressions.info/catastrophic.html)

您可以将其重写为：

```
^([a-zA-Z-]+/)*[a-zA-Z-]+$ 
```

或者您的 RE 实现可能有其他可用的工具来避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T02:11:28.023

查找灾难性回溯...您需要更好地定义它，或者编写一个一次将 URI 字符串切碎的一个...这个是递归的，为什么它会在您身上崩溃...或者，您可以将它从贪婪改为懒惰..我实际上并没有调试这个正则表达式，但这就是我所看到的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:35:54.653

对于[PCRE](http://www.pcre.org/)，您可以使组原子化以避免灾难性的回溯。只需`?>`像这样添加：

```
^(?>[a-zA-Z-]+/?)+$ 
```

请参阅“原子分组和占有量词”下的[PCRE 手册。](http://www.pcre.org/pcre.txt)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T13:38:45.793

使用此测试仪工作 :) 试一试 - [http://ocpsoft.org/tutorials/regular-expressions/java-visual-regex-tester/#!;t=some-uri-string%2Fsome-uri-string% 2Fsome-uri-string&r=%5E(%5Ba-zA-Z-%5D%2B%2F%3F)%2B%24&x=](http://ocpsoft.org/tutorials/regular-expressions/java-visual-regex-tester/#!;t=some-uri-string%2Fsome-uri-string%2Fsome-uri-string&r=%5E(%5Ba-zA-Z-%5D%2B%2F%3F)%2B%24&x=)

# windows - 为什么我不能更改我的区域设置？

> ID：539720
> 
> 赞同：0
> 
> 时间：2009-02-12T02:11:15.810
> 
> 标签：windows, settings, regional

大约 2 小时以来，我一直在尝试寻找有关如何更改高级区域设置的解决方案（用于非 unicode 程序中使用的语言）..因为每次我尝试更改语言时...系统都会给我一个错误提示：安装程序无法安装所选的语言环境。请联系您的系统管理员。

那我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:25:51.453

在我看来，您可能需要成为管理员才能做到这一点。你试过吗？

# jquery - 使用 jQuery 查找给定表中 TR 元素的数量

> ID：539723
> 
> 赞同：4
> 
> 时间：2009-02-12T02:12:42.123
> 
> 标签：jquery

我已经看到了几个关于如何找到孩子等的例子，但由于某种原因，我无法做到这一点......来自 SO 社区的任何帮助？

以下是我目前在代码中的“尝试”——

var trCount = $("#table > tr").size();

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T02:16:17.683

这应该有效：

```
var count = $("#table tr").length; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T03:56:10.377

普通旧 DOM：

```
document.getElementById('table').rows.length; 
```

这将比要求 jQuery 计算选择器并为您返回每个行元素要高效得多。

你不必把你所做的一切都强加到一个 jQuery 形的洞里；有时旧的方法仍然是最好的。创建 jQuery 是为了在 JavaScript 的薄弱领域补充它，而不是完全取代整个语言。

> $("#table tr").size();

嵌套表失败。

> $("#table > tr").size();

tbody 中的 tr 失败（这种情况很常见，因为它们可以自动插入）。

> $("#table > tbody > tr").size();

在 thead/tfoot 中 tr 失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T02:23:30.367

没有后代选择器对我有用，但**不适**用于。
作品：

```
var trCount = $("table tr").size(); 
```

不：

```
var trCount = $("table > tr").size(); 
```

还要确保将声明放在文档中，否则它将不起作用。

```
$(document).ready(function() {
     var trCount = $("table tr").size();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T02:23:45.437

尝试：

```
var trCount = $("table tr").size(); 
```

如果您使用 tbody、thead 等，使用 > 可能不起作用。

此外，# 将选择一个元素，任何元素，id 为 table。只要确定这是你想要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T02:24:10.817

浏览器会自动将 tbody 元素添加到 DOM。

```
var trCount = $("#table > tbody > tr").size(); 
```

发布的`"table tr"`答案不适用于嵌套表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T02:17:06.717

它应该工作，但我相信你想要的是：

```
var trCount = $("table > tr").size(); 
```

如果你使用#table，你是在要求一个`id='table'`我猜是错误的表？

# c - OCI 连接字符串...需要帮助

> ID：539730
> 
> 赞同：0
> 
> 时间：2009-02-12T02:15:31.260
> 
> 标签：c, oracle, oracle-call-interface

有谁知道用于 oracle 10g C API 的函数 OCILogon() 中的 dbname 参数的 OCI 连接字符串？

我知道您可以为服务指定 tnsnames.ora 条目，但它是否能够采用以下内容： oci:connect:myserver.com:1521/myservicename ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-19T14:53:38.903

您可以对 dbname 使用以下格式：

`[//]host[:port][/service name]`

您可以在此处阅读有关主题的更多信息： [OCI Instant Client 的数据库连接字符串](http://download.oracle.com/docs/cd/E11882_01/appdev.112/e10646/oci01int.htm#LNOCI16167)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T02:38:24.637

您可以按如下方式指定 dbname（不带 tnsnames.ora）：

> (DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=MyHost)(PORT=MyPort)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=MyOracleSID)))

# asp.net - 如何在 ASP.Net 应用程序中使用 HTTPS

> ID：539732
> 
> 赞同：48
> 
> 时间：2009-02-12T02:15:43.147
> 
> 标签：asp.net, https

我想在我的 ASP.NET Web 应用程序中使用 HTTPS，但仅限于 Login.aspx 页面。

如何实现？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-01-04T19:04:45.507

1.  首先获取或创建证书

2.  [从http://www.codeproject.com/Articles/7206/Switching-Between-HTTP-and-HTTPS-Automatically-Ver](http://www.codeproject.com/Articles/7206/Switching-Between-HTTP-and-HTTPS-Automatically-Ver)获取 SecureWebPageModule 模块。可以在文章中找到设置说明。

3.  将 secureWebPages 标签添加到 web.config

    ```
    <configuration>
        ...
        <secureWebPages enabled="true">
            ...
        </secureWebPages>
        ...
        <system.web>
            ...
        </system.web>
    </configuration> 
    ```

4.  添加用于 https 协议的文件和目录：

    ```
    <secureWebPages enabled="true">
        <file path="Login.aspx" />
        <file path="Admin/Calendar.aspx" ignore="True" />
        <file path="Members/Users.aspx" />
        <directory path="Admin" />
        <directory path="Members/Secure" />
    </secureWebPages> 
    ```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-12T02:21:19.060

您可以发布自己的证书，也可以购买一份。需要注意的是，购买一个，取决于公司，意味着它已经存储在大多数浏览器的证书存储中。您自己发布的将不会，您的用户将不得不采取额外的步骤来安装您的证书。

你没有说你使用的是什么版本的 IIS，但[这里有一些关于 IIS 6 的详细说明](http://www.instantssl.com/ssl-certificate-support/csr_generation/iis_ssl_certificate_5x.html)

您可以购买相对便宜的证书，或者您可以与大男孩（威瑞信）一起获得扩展验证证书，它将您的地址栏变成 IE，绿色。这也是一个有点严格的验证过程，需要时间。

如果您知道所有将访问您网站的用户，那么安装您自己的网站就没有问题。但是，对于具有匿名用户（您不知道）的开放网站，最好购买一个已经在大多数主要浏览器、证书商店中的网站。

您可以通过 IIS 启用 SSL，并且只需要 login.aspx 页面而不需要其他页面。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-12T02:24:06.650

设置/安装 SSL 后，您希望在登录页面上进行某种重定向到 https://。那么无论用户在验证后被发送到什么页面，它都可以是 http://。

```
Protected Sub Page_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreRender
    If Request.IsSecureConnection = False And _
        Not Request.Url.Host.Contains("localhost") Then

        Response.Redirect(Request.Url.AbsoluteUri.Replace("http://", "https://"))
    End If
End Sub 
```

这可能更容易在母版页或您需要 https 的所有页面上实现。通过检查“localhost”，您将避免在测试环境中出现错误（除非您的测试服务器有另一个名称而不是检查：“mytestservername”）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-09T00:00:49.433

*免责声明 - 我参与了这个项目的开发*

我建议使用[http://nuget.org/packages/SecurePages/](http://nuget.org/packages/SecurePages/)它使您能够保护特定页面或使用正则表达式来定义匹配项。它还将强制所有不匹配正则表达式或直接指定回 HTTP 的页面。

您可以通过 NuGet 安装它：`Install-Package SecurePages`

文档在这里：[https ://github.com/webadvanced/Secure-Page-manager-for-asp.net#secure-pages](https://github.com/webadvanced/Secure-Page-manager-for-asp.net#secure-pages)

简单用法：

```
SecurePagesConfiguration.Urls.AddUrl("/cart"); 
```

或者

```
SecurePagesConfiguration.Urls.AddRegex(@"(.*)account", RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Singleline); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T02:17:09.837

您可以在 IIS 配置中启用 HTTPS，但除非您获得 SSL 证书并将其插入 IIS，否则它不会是“安全的”。确保您已打开端口 443。

# .net - 哪种数据验证方法最适合大型数据集

> ID：539733
> 
> 赞同：1
> 
> 时间：2009-02-12T02:15:50.603
> 
> 标签：.net, database, large-data-volumes

我有一个大型数据库，并希望实现一个允许用户批量更新信息的功能。用户下载一个 excel 文件，进行更改，系统接受该 excel 文件。

1.  用户使用 Web 界面 (ASP.NET) 将数据从数据库下载到 Excel。
2.  用户修改 Excel 文件。仅允许将某些数据作为其他映射修改到数据库中。
3.  一旦用户对他们的更改感到满意，他们就会通过 ASP.NET 界面上传更改后的 Excel 文件。
4.  现在服务器的工作是从 Excel 文件中提取数据（使用 Gembox）并根据数据库验证数据（这是我遇到问题的地方）
5.  验证完成后，验证结果将显示在另一个 ASP.NET 页面上。验证是软的，因此只有在缺少映射到 DB 的索引时**才会发生硬失败。**（缺少数据会导致忽略等）
6.  用户可以决定将要采取的行动是否适当，在接受这些行动时，系统将应用更改。（添加、修改或忽略）

在应用用户所做的更改和/或添加之前，必须验证数据以避免用户出错。（他们无意删除的日期）

对于需要更新以达到超过 65k 的行来说，这并不遥远。

问题是：**解析数据以进行验证并建立更改和添加集的最佳方法是什么？**

如果我将必须验证 excel 数据的所有数据加载到内存中，我可能会不必要地影响已经占用大量内存的应用程序。如果我对 excel 文件中的每个元组进行数据库命中，我将看到超过 65k 的数据库命中。

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:49:10.913

我过去见过的方法是：

1.  将用户的数据批量加载到数据库中的“临时”表中。
2.  通过单个存储过程（执行一系列查询）验证临时表中的数据，标记验证失败的行，需要更新等。
3.  根据需要对标记的行进行操作。

这对于验证缺失的列、有效的键值等非常有效。它对于检查单个字段的格式不太好（不要让 SQL 将字符串分开）。

正如我们所知，有些人对将业务逻辑放在数据库中感到不舒服，但这种方法确实限制了您的应用程序对数据库的访问次数，并且避免了一次将所有数据保存在内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T03:20:40.853

您的问题在数据仓库系统中很常见，其中批量上传和数据清理是（常规）工作的核心部分。我建议你在 ETL（提取变换负载）、临时表周围搜索一下，你会发现很多好东西。

在广泛回答您的问题时，如果您确实“将数据加载到内存中”进行检查，那么您实际上是在自己的代码中重新实现了数据库引擎的一部分。现在，如果这样做更快更聪明，那可能是一件好事。例如，您的 Excel 提取可能只有一小部分有效日期，因此您无需加入表格来检查日期是否在范围内。但是，对于外键等其他数据，让数据库做它擅长的事情。

随着数据量变大，使用临时表/数据库/服务器是一种常见的解决方案。顺便说一句，允许用户在 Excel 中清理数据是一个非常好的主意，允许他们“意外”删除关键数据是一个非常糟糕的主意。您能否锁定单元格/列以防止这种情况发生，和/或在 Excel 中进行一些基本验证。如果一个字段应该被填写并且应该是一个日期，你可以在几行 Excel 中检查它。您的用户会很高兴，因为他们不必在发现问题之前上传。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T02:22:09.433

为了正确回答这个问题，以下信息将很有用

1.  您将如何通知用户失败？
2.  一次验证失败会导致加载 64,999 条记录还是不加载？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T07:06:23.453

首先使用批量上传将文本文件数据存储在临时表中。然后检索它，并使用您制作的界面进行验证。并在验证后将其存储在主表或数据库中

# asp.net - ASP.NET MVC 中的电子邮件 URL

> ID：539735
> 
> 赞同：0
> 
> 时间：2009-02-12T02:16:20.820
> 
> 标签：asp.net, asp.net-mvc, url-routing

如何为要包含在电子邮件中的 MVC 应用程序生成正确的 URL？

这适用于我的注册系统，它与我的控制器/操作分开。基本上，我想发送一封电子邮件验证来触发控制器上的操作。我不想硬编码 URL，我想要 Views 上的 Url 属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:38:51.603

在您的控制器中，UrlHelper 只是称为“Url” - 所以：

```
void Index() {
    string s = this.Url.Action("Index", "Controller");
} 
```

“this”是不必要的，但它会告诉你这个 Url 变量来自哪里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T20:51:29.847

我用了：

```
Html.BuildUrlFromExpression<AccountController>(c=>c.Confirm(Model.confirmedGUID.Value)) 
```

它是 HTMLHelper 的一部分（我认为在 MVC Futures 中），因此您可能必须将 HTMLHelper 的实例传递给您的服务层，不确定。我直接在我的视图中使用它来呈现给电子邮件。这为您提供了绝对 URL，然后我将域 ( [http://www.mysite.com](http://www.mysite.com) ) 存储在配置文件中并将其附加到 URL 之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:41:48.383

如果我正确阅读了问题，则需要在 MVC 代码之外进行控制器/操作。如果是这样，您只需在应用程序配置或类似的地方配置 URL，除非您有权访问控制器类并使用反射来获取名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T10:18:49.757

您可能应该将 URL 作为应用程序配置的一部分。

我知道您可以使用 Web 应用程序上的 Server 属性来做一些事情，但应用程序永远不会知道其 IP 或域名是否可以从外部访问，因为它可能隐藏在代理或负载平衡器后面。

# silverlight - Silverlight - 获取域信息

> ID：539754
> 
> 赞同：3
> 
> 时间：2009-02-12T02:25:00.317
> 
> 标签：silverlight, silverlight-2.0

Silverlight 应用程序如何询问浏览器它从哪个域提供服务？

**更新：** 确保您的班级还没有此*using*语句，请将其添加到班级的顶部。这将帮助您了解您将在网上看到的一些示例。这让我有点困惑。

```
 using System.Windows.Browser; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T02:29:26.343

[HtmlDocument.DocumentUri](http://msdn.microsoft.com/en-us/library/system.windows.browser.htmldocument.documenturi(VS.95).aspx)怎么样？那会给你你需要的。关于浏览器互操作的页面**[在这里](http://msdn.microsoft.com/en-us/magazine/dd148642.aspx)**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T03:21:16.407

正如 jcollum 所说，您访问 HtmlDocument.DocumentUri 属性以获取有关主机的大量信息。要回答您评论中的问题，您可以在 Page.xaml.cs 中执行此操作：

```
using System;
using System.Windows.Browser;
using System.Windows.Controls;

namespace SilverlightApplication1
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();

            string hostName = HtmlPage.Document.DocumentUri.Host;
            int port = HtmlPage.Document.DocumentUri.Port;
        }
    }
} 
```

# java - StringBuffer 如何通过类中没有字段的 void 传递数据？

> ID：539758
> 
> 赞同：1
> 
> 时间：2009-02-12T02:26:06.600
> 
> 标签：java, stringbuffer

给定：类没有字段，每个变量都是本地的。littleString 是通过在 Eclipse 中重构 bigString 创建的：

```
public String bigString()
    {
        StringBuffer bob = new StringBuffer();
        this.littleString(bob);
        return bob.toString();
    }

private void littleString(final StringBuffer bob)
    {
        bob.append("Hello, I'm Bob");
    } 
```

方法 littleString 不应该将 StringBuffer 传回，但实际上是。这里发生了什么样的黑魔法？这打破了我所知道的所有封装规则。我很震惊，言语让我失望。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T02:29:44.360

`littleString`没有将对象传回——它只是使用同一个对象。局部变量`bob`in`bigString()`和参数`bob`in 都`littleString()`引用同一个对象，因此如果您更改其中一个对象，更改将立即出现在另一个对象中，*因为它们都是对同一对象的引用*。

问题是`StringBuffer`s 是可变的并且具有与之关联的内部状态。某些类型的对象（例如`String`s）是不可变的，因此您可以安全地将它们作为方法参数传递，并且您知道它们永远不会被修改。请注意，添加`final`关键字在这里没有帮助——它只是确保`bob`永远不会被分配来引用不同的`StringBuffer`对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T02:31:15.870

它没有传递任何东西。它正在修改您传递引用的 StringBuffer。Java 中的对象不是按值传递的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T02:32:11.530

如果您的意思是为什么要修改字符串缓冲区，那是因为您传递了对字符串缓冲区的引用，这允许您调用修改字符串缓冲区对象的公共方法 append。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T09:56:03.023

上面的答案几乎得到了它，除了没有提到一件小事：java缺少“const-ness”，这意味着你希望一个对象是不可修改的。

“final”很接近，但它仍然不能正常工作。代码片段显示的是如果您将可变对象作为参数传递给其他方法时可能发生的错误。这可以通过使用不可变对象来解决，或者如果为深度 const-ness 添加了某种新关键字。

# asynchronous - 检测阻塞线程

> ID：539761
> 
> 赞同：2
> 
> 时间：2009-02-12T02:26:58.890
> 
> 标签：asynchronous, ccr, blocked-threads

我有一个关于解决异步应用程序故障的理论（我正在使用 CCR），我想知道是否有人可以确认我的逻辑。

如果使用默认线程数（即每个内核一个）的基于 CCR 的多线程应用程序比指定双倍线程的同一应用程序慢 - 这是否意味着线程在代码中的某处被阻塞

怎么想？这是检测线程是否被无意阻塞的快速有效的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T02:47:19.543

“慢”是什么意思？

如果你想自动检测阻塞的线程，也许这些线程应该发送一个心跳，然后由某种监视器观察，但你的选择是有限的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-18T23:11:35.270

I've found that to keep the system fluid with minimal threads, I keep the tasks dealing with I/O as concise as possible. They simply post the data from the I/O into another Port and do no further processing. The data is therefore queued elsewhere for processing in a controlled manner without interfering with the task of grabbing data as fast as possible. This processing might happen in the ExclusiveGroup of an Interleave if there's shared state to think about... and a handy side-effect is that exclusive tasks will never tie up all the threads in a Dispatcher (however, I suspect that there's probably nattier ways of managing this in the CCR API)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:17:22.903

判断线程是否被阻塞的一种廉价方法是在执行任何可能的阻塞操作之前获取当前系统时间，然后在操作之后获取当前系统时间，然后查看已经过去了多少时间。例如，在等待消息到达时，测量线程被阻塞等待消息到达的时间。

除非总是有足够多的消息要处理，否则线程将阻塞等待消息。如果您有更多线程，那么您就有更多潜在的消息*生成器*（取决于您的设计），因此等待接收消息的线程将更有可能准备好一个。

除非您可以保证始终有足够的消息，因此没有线程必须等待，否则只有一个 CPU 线程太少了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T04:09:51.220

如果是这种情况，则意味着您的线程池已用尽（即您有 2 个线程，但您已经异步挂起 4 个 IO 或其他东西） - 如果您的工作受大量 IO 限制，则“每个核心一个线程”的规则不会不是真的适用。

# javascript - Javascript 问题

> ID：539772
> 
> 赞同：0
> 
> 时间：2009-02-12T02:32:17.630
> 
> 标签：javascript

我有一个表，其中的行处于原始状态 (A)。当回发发生时，我使用 JS 函数重新排序 DOM 中的这些行（基于业务规则）。它工作正常，只是在重新排序行时用户体验会下降。

顺序如下： 1\. 显示状态 A 的行 2\. 运行一个重新排序行的 JS 函数 3\. 显示状态 B 的行

我不希望用户看到状态 A。

我正在考虑将 div 设置为不可见，并在 JS 函数运行后将其重置为可见。但这似乎不起作用。

任何解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T02:39:35.413

为什么不在客户端生成整个表。您可以让服务器返回 JSON，然后`document.createElement`按照您希望的顺序使用（或您的框架使用的任何内容）创建表。

# graphics - 图形控制器的 VGA 标准

> ID：539774
> 
> 赞同：1
> 
> 时间：2009-02-12T02:32:54.227
> 
> 标签：graphics, resources, controller, fpga, vga

我正在尝试通过 VGA 连接器为具有 Altera FPGA 的 VGA 显示器创建*通用*图形控制器，但我找不到任何好的**在线**资源来解释显示器使用的标准规范。我找到了所有的[引脚描述](http://www.hardwarebook.info/VGA_(15))和一些描述如何创建特定图形控制器的资源，例如这个[8 色 480x640 控制器](http://faculty.lasierra.edu/~ehwang/public/mypublications/VGA%20Monitor%20Controller.pdf)，但我没有找到任何资源描述实际预期的监视器“协议”。

例如，我在任何地方都没有找到信号不同部分之间的确切时序应该是什么——在[上面](http://faculty.lasierra.edu/~ehwang/public/mypublications/VGA%20Monitor%20Controller.pdf)，给出了以微秒为单位的具体时序，但没有给出原因。是否所有部分都应该按照这些设定的比例，或者在行之间的暂停时间方面是否存在一些任意性等等......如果您考虑在代码中实现它，伪代码会是什么样子（并且能够改变分辨率/颜色深度）？

同样，我正在寻找*通用*控制器的预期“协议”——类似于没有指定监视器类型时操作系统将使用的协议。指向正确方向的指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T02:38:37.897

多年来我没有做过任何较低级别的 VGA 东西，但我用过的一本书可能会有所帮助：[EGA、VGA 和超级 VGA 卡的程序员指南](https://rads.stackoverflow.com/amzn/click/com/0201624907)

> 本书的目录如下：
> 
> 1.  程序员指南简介
> 2.  EGA、VGA 和 Super VGA 功能
> 3.  图形硬件和软件
> 4.  图形系统的类型
> 5.  计算机图形学原理
> 6.  字母数字处理
> 7.  图形处理
> 8.  调色板和颜色寄存器
> 9.  读取 EGA 和 VGA 的状态
> 10.  EGA/VGA 寄存器
> 11.  EGA/VGA BIOS
> 12.  编程示例
> 13.  超级 VGA
> 14.  图形协处理器
> 15.  超级 VGA 代码基础
> 16.  适配器接口
> 17.  8514/A
> 18.  XGA
> 19.  ATI 技术
> 20.  芯片与技术
> 21.  卷云逻辑
> 22.  Video7 Super VGA 芯片组
> 23.  IIT
> 24.  NCR
> 25.  橡木
> 26.  S3 公司
> 27.  Trident Super VGA 芯片组
> 28.  Tseng Labs Super VGA 芯片
> 29.  天堂超级 VGA 芯片
> 30.  威特克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-29T22:41:19.980

This site: [http://server.oersted.dtu.dk/www/sn/31002/?Materials/vga/main.html](http://server.oersted.dtu.dk/www/sn/31002/?Materials/vga/main.html)

Has a pretty good discussion on VGA.

The key to what you're asking is answered with this clip from the site: [http://web.mit.edu/6.111/www/s2004/NEWKIT/vga.shtml](http://web.mit.edu/6.111/www/s2004/NEWKIT/vga.shtml)

"As with RS-232, the standard for VGA video is that there are lots of standards. Every manufacturer seems to list different timings in the manuals for their monitors. The values given in the table above are not particularly critical. On a CRT monitor, the lengths of the front and back porches control the position of the image on the display. If the image appears offset to the right or left, or up or down, try adjusting the front and back porch values for the corresponding direction (or use the image position adjustments on the monitor, which accomplish the same thing)."

The problem is backwards compatability doesn lend itself well to a simple equation to determine these values. There is a modern spreadsheet that will calculate values for monitors that use the most recent standards, but if your playing around with VGA the old analog monitors will let you do tricks that you can't do on an led type display.

Your resolution is limited to how fast the electronics can turn on and off the electron beam, but the horizonal placement is only limited by your clock and what ever phase adjustments are possible on your FPGA.

For instance you can setup 640x480 timing on your sync pulses and instead of clocking data at 25MHz you can use 100 or 200 MHz and simply require a min on time for each pixel. Effectively allowing you to smooth scroll 1/8th of the width of a pixel. You may be able to do simalar tweeking to the distance between scan line although I've never tried it.

# java - 基于动态正则表达式的 XPath 搜索

> ID：539781
> 
> 赞同：2
> 
> 时间：2009-02-12T02:36:09.930
> 
> 标签：java, xml, xslt, xpath, xpath-2.0

我有一个如下所示的 XML：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <Configuration>
        <Destinations>
            <Destination name="DEST1" >
                <From>AMA*</From>
            </Destination>

            <Destination name="DEST2" >
                <From>AMAZON</From>
            </Destination>

                           <Destination name="DEST3" >
                <From>EBAY</From>
            </Destination>

                           <Destination name="DEST4" >
                <From>*</From>
            </Destination>

        </Destinations>
    </Configuration> 
```

我想查询并找出与提供的输入匹配的所有目的地。

如果我指定 EBAY，我希望 xpath 返回节点名称 = DEST3 和 DEST4（它不关心值），但如果我指定 AMAZON，它需要返回 DEST1、DEST2 和 DEST4，因为 DEST1 中的 AMA* 支持通配符.

到目前为止，我的 XPath 看起来像这样：

> /目的地[（从='**' 或 From = '*' ) )]/@name**

 **如果指定了输入，我会动态创建 XPATH 表达式并将传入的值插入**场地**

 **除了 From 之外，我的 XML 中还有其他元素。

感谢是否有人可以就此提供指点。

谢谢，芒卢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T04:30:00.873

**以下 XPath 2.0 表达式表达了所需的选择**：

```
 /*/*/*[From[matches($pPat, replace(., '\*', '.*'))]] 
```

**说明**：

1.  该**`$pPat`**变量包含搜索模式（例如“EBAY”、“AMAZON”等）。

2.  标准 XPath 2.0 函数`matches()`用于将任何`From`元素的值与字符串模式匹配。

3.  任何`From`元素的值都会转换为 XPath 2.0 支持的标准正则表达式。为此，任何出现的`'*'`(转义为`"\*"`不被视为正则`'*'`表达式中使用的特殊字符而是作为普通字符) 都将替换为字符串`".*"`

**测试**：

**我使用了以下 XSLT 2.0 转换**并验证了上述 XPath 2.0 表达式是否按预期选择了元素。要使用它，请将全局参数 $pPat 的值替换为任何所需的值。

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsl:output omit-xml-declaration="yes"/>

    <xsl:param name="pPat" as="xs:string"
     select="'AMAZON'"/>

    <xsl:variable name="vsrchResult" as="element()*"
     select="/*/*/*[From[matches($pPat, replace(., '\*', '.*'))]]"/>

    <xsl:template match="/">
      <xsl:copy-of select="$vsrchResult"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于最初提供的 XML 文档时**：

```
<Configuration>
    <Destinations>
        <Destination name="DEST1" >
            <From>AMA*</From>
        </Destination>
        <Destination name="DEST2" >
            <From>AMAZON</From>
        </Destination>
        <Destination name="DEST3" >
            <From>EBAY</From>
        </Destination>
        <Destination name="DEST4" >
            <From>*</From>
        </Destination>
    </Destinations>
</Configuration> 
```

**产生所需的输出**：

```
<Destination name="DEST1">
            <From>AMA*</From>
        </Destination><Destination name="DEST2">
            <From>AMAZON</From>
        </Destination><Destination name="DEST4">
            <From>*</From>
        </Destination> 
```

# c# - 将集合更新到 db

> ID：539782
> 
> 赞同：2
> 
> 时间：2009-02-12T02:37:37.307
> 
> 标签：c#, sql-server, database, nhibernate

这可能有点天真，但我只想检查我这样做的方式是否正确。我从 UI 收到一组对象。然后我希望根据数据库中的记录检查这些对象。

这就是我正在做的创建更新和删除接收到的对象。

1.  循环接收对象 - 如果 (id == 0 ) 创建新记录。
2.  从数据库中检索现有记录；
3.  循环现有记录 - 在哪里（现有记录 id == 收到的对象 id）更新记录。
4.  如果记录存在于现有记录中但不存在于接收到的对象中 - 删除。

这似乎是最合乎逻辑的方法。我正在使用 NHibernate 并且有点想知道是否有另一种方法我应该研究。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T02:47:23.537

接受我的答案，看看它的价值；我说你的逻辑是可靠的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T10:40:50.423

如果您确实使用 SQL Server 2008（或者可以选择使用它），那么有一个新的“MERGE”语句基本上可以完成所有这些工作。

在这种情况下，您可以将所有数据写入临时表（在内存中或磁盘上），然后使用单个 MERGE 语句将数据更新并插入到目标表中。

以下是关于 SQL Server 2008 的 MERGE 的一些信息帖子：

*   [SQL Server 2008 - 合并的力量](http://www.sqlservercentral.com/articles/Advanced+Querying/3122/)（需要免费注册）
*   [SQL Server 2008 合并](http://blogs.conchango.com/davidportas/archive/2007/11/14/SQL-Server-2008-MERGE.aspx)
*   [使用 SQL Server 2008 的 MERGE 语句](http://www.builderau.com.au/program/sqlserver/soa/Using-SQL-Server-2008-s-MERGE-statement/0,339028455,339283059,00.htm)
*   [SQL Server 2008 合并语句](http://www.sql-server-performance.com/articles/dba/SQL_Server_2008_MERGE_Statement_p1.aspx)
*   [SQL Server 2008 - 合并简介](http://blog.sqlauthority.com/2008/08/28/sql-server-2008-introduction-to-merge-statement-one-statement-for-insert-update-delete/)

# php - PHP 实时更新

> ID：539787
> 
> 赞同：0
> 
> 时间：2009-02-12T02:40:22.337
> 
> 标签：php, live

我想知道是否有一种方法可以使用 php 从搜索中返回值，而无需重新加载整个网页或使用 iframe 或类似的东西。我试过搜索它，但我总是以 AJAX 告终，我想知道是否有一种 PHP 方式来解决它......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T02:44:19.817

我建议您阅读 AJAX 以及它是什么，因为它正是您所描述的。

AJAX 使用 javascript 在浏览器上生成请求，将请求发送到服务器，使用您想要的任何技术（无论是 PHP、.NET 等）生成内容并将其返回到浏览器，而无需“重新加载”页面'。就是这样，这就是你想要的。

我建议您查看[jQuery](http://www.jquery.com)之类的东西，因为它是最流行的 javascript 库。它使执行 AJAX 请求变得轻而易举。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T02:44:10.830

AJAX 是您正在寻找的。这意味着使用 JavaScript（在浏览器上）向服务器（可能正在运行 PHP 或任何其他语言）发起请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T02:46:26.193

PHP是一种服务器端技术，您所描述的主要是客户端问题。

每种技术都将非常接近 Ajax，因此我建议您花一点时间让自己开始使用 Ajax。周围有很多 JavaScript 框架可以让您作为 Ajax 程序员的工作更轻松。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T02:53:38.517

PHP是服务器端的。除非发出网络请求（即用户单击链接，请求页面），否则它不能做任何事情。这就是 AJAX 存在的原因。客户端的 javascript 能够在后台发起 Web 请求并决定如何处理响应。

查看 jQuery。它使 AJAX 变得轻而易举：

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-09T23:36:12.123

是的，我使用 PHP 和 Mysql 做了同样的事情。你可以做的是首先创建一个带有文本框的PHP搜索页面1，并为文本框的onkeyup事件写一些jQuery函数。将文本框的值传递给 PHP 搜索页面 2 并在搜索页面上的另一个空白 DIV 标记中显示其数据 1。如果你能理解这个概念，请告诉我，否则我会为你转发一些链接。事实上，我为此找到了一个 youtube 视频。这不是一项艰巨的任务。

# svn - 协作编辑 LaTeX 文档的提示

> ID：539791
> 
> 赞同：9
> 
> 时间：2009-02-12T02:43:15.513
> 
> 标签：svn, latex, collaboration

我的默认设置是将 tex 源代码放在 subversion 存储库中，并在更改其他人的内容时将注释作为注释插入到源代码中。这一切都感觉不太理想，尤其是当存在颠覆冲突时，它告诉你的只是“这个巨大段落的这两个版本存在冲突”。

我想出了一些技巧，但我确信那里有更好的想法（或我的想法的更好版本）。

要在代码上进行协作，请参阅以下问题：

[您如何与其他编码人员实时协作？](https://stackoverflow.com/questions/510163/how-do-you-collaborate)

（其中一些答案也适用于 LaTeX 文档的协作。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-12T03:13:23.647

*始终*以换行符结束每个句子。*永远不要*重新格式化段落。这些规则不仅可以最大限度地减少虚假冲突，还可以使您的协作编辑的论文更容易修改。

对于作者评论，我使用边缘评论：

```
\long\def\authornote#1{%
        \leavevmode\unskip\raisebox{-3.5pt}{\rlap{$\scriptstyle\diamond$}}%
        \marginpar{\raggedright\hbadness=10000
        \def\baselinestretch{0.8}\tiny
        \it #1\par}}
\newcommand{\simon}[1]{\authornote{SLPJ: #1}}
\newcommand{\norman}[1]{\authornote{NR: #1}}
\newcommand{\john}[1]{\authornote{JD: #1}} 
```

我们将这些放在页边空白处是因为我们经常按照严格的长度限制准备论文，并且我们希望边注不会改变论文的长度。边注然后被关闭

```
\long\def\authornote#1{\relax} 
```

我还发明了这个[`nbibtex`](http://www.cs.tufts.edu/~nr/nbibtex/)工具（现在在 Debian 中！），这样您就可以使用来自您的合著者的不同 .bib 文件，而无需就任意 BibTeX 密钥达成一致。 `nbibtex`像 BibTeX 一样工作，只是它使用来自作者、标题和其他字段的关键词。每个作者的 BibTeX 文件可以不同，但​​如果有论文，`nbibtex`就会找到。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-12T02:45:29.860

为了减轻无用的颠覆冲突问题，您可以在句子末尾采用换行符的约定。（这也使得重新排列或注释掉，或评论*，*句子更容易。）

至于文本源中的相互评论，我发现最好让它们出现在 pdf 文档中，但可以在最终版本中关闭它们。我为此使用了宏“ `kibitz`”。要使用它，请将以下内容放在文档的顶部：

```
\newcount\Comments  % 0 suppresses notes to selves in text
\Comments=1   % TODO: set to 0 for final version

\documentclass{article}   % or whatever your documentclass

% for comments
\usepackage{color}
\definecolor{darkgreen}{rgb}{0,0.5,0}
\definecolor{purple}{rgb}{1,0,1}
% \kibitz{color}{comment} inserts a colored comment in the text
\newcommand{\kibitz}[2]{\ifnum\Comments=1\textcolor{#1}{#2}\fi}
% add yourself here:
\newcommand{\alice}[1]{\kibitz{red}      {[ALC: #1]}}
\newcommand{\bob}[1]  {\kibitz{purple}   {[BOB: #1]}}
\newcommand{\carol}[1]{\kibitz{cyan}     {[CAR: #1]}}
\newcommand{\deb}[1]  {\kibitz{darkgreen}{[DEB: #1]}}
\newcommand{\evan}[1] {\kibitz{blue}     {[EVN: #1]}} 
```

例如，Alice 可以粘贴类似的东西，只要将 long设置为 1 `\alice{Bob must've added the previous sentence which is obviously false.}`，它就会在 pdf 中显示为红色。`Comments`

# perl - 我应该如何在 Perl 中进行整数除法？

> ID：539797
> 
> 赞同：61
> 
> 时间：2009-02-12T02:44:20.783
> 
> 标签：perl, integer-division

**什么是在 Perl 中始终**进行整数除法的好方法？

例如，我想要：

```
real / int = int

int / real = int

int / int = int 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-02-12T02:49:50.413

这个问题至少有两个合理的答案。（我最初只给出了答案 2。）

1.  使用该`int()`函数将浮点计算结果截断为整数（丢弃小数部分），正如 Bryan 在他的自我回答中所建议的：[#539805](https://stackoverflow.com/questions/539797/how-should-i-do-integer-division-in-perl#539805)

2.  使用[`use integer`pragma](http://perldoc.perl.org/integer.html)使 Perl 将计算的输入和结果*都截断为整数。*它的范围在`{ }`块内。

例子：

```
print 3.0/2.1 . "\n";      # => 1.42857142857143
print 5.0/1.5 . "\n";      # => 3.33333333333333

print int(3.0/2.1) . "\n"; # => 1
print int(5.0/1.5) . "\n"; # => 3

{
  use integer;
  print 3.0/2.1 . "\n";    # => 1
  print 5.0/1.5 . "\n";    # => 5 (because 1.5 was truncated to 1)
}
print 3.0/2.1 . "\n";      # => 1.42857142857143 again 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-02-12T02:47:59.933

您可以在 Perl 中转换整数：

```
int(5/1.5) = 3; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-12-14T20:07:15.733

`int(x+.5)`将向最接近的整数舍入*正值。*四舍五入更难。

向零舍入：

`int($x)`

对于以下解决方案，请包含以下语句：

`use POSIX;`

向下舍入：`POSIX::floor($x)`

四舍五入：`POSIX::ceil($x)`

从零舍入：`POSIX::floor($x) - int($x) + POSIX::ceil($x)`

四舍五入到最接近的整数：`POSIX::floor($x+.5)`

请注意，`int($x+.5)`负值严重失败。`int(-2.1+.5)`是`int(-1.6)`，即-1。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-25T09:59:47.023

你可以：

```
use integer; 
```

它由 Michael Ratanapintha 解释或手动使用：

```
$a=3.7;
$b=2.1;

$c=int(int($a)/int($b)); 
```

注意，'int' 不是强制转换。这是将数字转换为整数形式的函数。这是因为 Perl 5 没有单独的整数除法。例外是当您“使用整数”时。那么你将失去真正的分裂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-06T13:29:06.597

希望它有效

整数（9/4）= 2。

谢谢 Manojkumar

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-15T21:35:24.587

整数除法 $x 除以 $y ...

`$z = -1 & $x / $y`

它是如何工作的？

`$x / $y`

返回浮点除法

`&`

执行按位与

`-1`

代表

`&HFFFFFFFF`

对于最大的整数...从哪里来

`$z = -1 & $x / $y`

给出整数除法 ...

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2011-05-05T01:54:29.977

例如 9 / 4 = 2.25

整数（9）/整数（4）= 2

9 / 4 - 余数 / 分母 = 2

9 /4 - 9 % 4 / 4 = 2

# encoding - 解密 MMORPG 协议编码

> ID：539812
> 
> 赞同：20
> 
> 时间：2009-02-12T02:52:43.260
> 
> 标签：encoding, reverse-engineering, encryption

我计划为游戏编写一个自动机器人。

棘手的部分是弄清楚他们如何编码他们的协议......要让机器人四处奔跑很容易，只需让角色运行并记录它在wireshark中所做的事情。但是，解释环境更加困难......如果您空闲，它每秒会收到大约 5 个数据包，因此会有很多垃圾。

我的计划：因为游戏是在 TCP 下运行的，所以我会使用 freecap ( [http://www.freecap.ru/eng](http://www.freecap.ru/eng) ) 来强制游戏连接到我机器上运行的代理。我需要这个代理能够进行数据包注入，或者可能需要一个能够重新发送捕获的数据包的服务器。通过这种方式，我可以重新创建和修改服务器发送的内容，并了解它们的协议编码。

1.  有谁知道我在哪里可以获得允许数据包注入的代理或我可以在哪里执行数据包注入（不是通过硬件，就像无线或任何东西一样！）
2.  我在哪里可以找到重新发送捕获的数据包的服务器/代理（即：重放连接）。
3.  有更好的模式匹配工具或方法吗？可以从多条消息中突出显示模式的东西会很棒。

**或者**，有没有更好的方法在这里破译这个？可能是一个反汇编策略（通过挂钩一个winsock函数并从那里开始反汇编）？我以前没有这样做过，所以我不确定。**或者**，还有其他想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T03:01:15.017

网络流量拦截和协议分析通常是一种不太受欢迎的方法来实现您的目标。对于大多数现代游戏来说，加密是一个严重的因素，并且对于最常见的游戏场景的任何但微不足道的因素的协议分析都存在严重的问题。

您尝试做的大多数现代实现*都依赖于读取和操作正在运行的客户端的内存空间和进程。客户端已经为您完成了所有困难的部分，包括解密流量并将其分类为更易于阅读的数据结构。为了与服务器交互，您可以调用内置于客户端的函数，而不是从头开始制作整个系列的数据包。这种方法的优点是您需要做的工作要少得多来解释数据和产生活动。缺点是网络流量中通常有一些对机器人有用但被客户端丢弃的数据，或者您可能希望将流量发送到客户端无法生成的服务器（在我自己的情况下） -为此制定的层次结构，比“作弊”更进一步

*...我说这已经看到了大多数 MMORPG botting/hacking 社区从[ShowEQ](http://www.showeq.net/)和[Odin's Eye / Excalibur等网络协议分析器到](http://excalibar.sourceforge.net/excalibur.html)[MacroQuest](http://www.macroquest2.com/main.php)和[InnerSpace](http://www.lavishsoft.com/joomla/index.php?option=com_content&view=article&id=2&Itemid=2)等基于内存的应用程序的演变。关于这一点，InnerSpace 为您正在尝试的基于内存/进程的变体提供了一个出色的可扩展框架，如果您放弃网络分析方法，您应该将其作为您项目的基础。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-27T18:50:46.130

正如我过去做过一些游戏机器人（当然是为了好玩，而不是为了盈利或悲伤——写游戏机器人很有趣），我推荐以下内容：

*   如果您可以编码并且没有作弊保护阻止您这样做，我强烈建议您编写注入的 DLL，原因如下：
    1.  您的 DLL 将能够直接访问游戏的内存空间，并且一旦您对数据结构进行逆向工程（通过查看内存或通过代码反汇编），您将可以访问大量数据。这也将允许您绕过游戏可能具有的任何网络加密。直接访问进程内存的缺点是偏移量和数据结构在版本之间会发生变化 - 但是，数据结构不会在稳定的游戏中经常更改，您可以通过搜索代码模式而不是使用固定偏移量来补偿偏移量变化。
    2.  无论哪种方式，您仍然可以使用 API 挂钩来挂钩 WinSock 函数（查看 Microsoft Detours 和优秀但现已商业化的 madCodeHook）。
*   否则，我只能建议您尝试像 WPE Pro 这样的实时/交互式数据包编辑器。

在大多数情况下，最酷的方法（代码逆向工程和直接内存访问）往往效率最低。他们需要大量的技能（理解代码）和时间，无论是最初（遍历所有代码并开发代码以与数据结构交互）和维护（以防游戏正在更新）。（当然，他们有时确实允许做一些官方客户端不可能做的酷事情，但大多数时候这很明显是公然的作弊，很可能会很快吸引GM）。大多数时候，机器人是通过用纯色替换游戏图形/纹理来制作的，并创建简单的“像素”机器人，在屏幕上搜索某些颜色并做出相应的反应（例如点击它们）。

希望这会有所帮助，并记住 - 作弊只有在不会让其他人的游戏变得不那么有趣的情况下才是有趣的；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T02:59:23.697

A) 我玩 MMO，不支持机器人，投反对票... B) 下载 Backtrack v.3，在您的默认网关和主机上运行 arpspoof。有一个应用程序会欺骗远程主机的 SSL 证书 sslmitm（我相信是名称），然后您可以通过主机创建完整连接。然后启动 tcpdump/ethereal/wireshark（选择你的 pcap 毒药）并四处走动做一些随机的事情来找出什么数据包在做什么。那将是你最大的挑战；但是代理中间人攻击自己是要走的路。

C) 我不容忍这种活动，这些信息仅作为免费信息提供。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T05:20:31.973

您可以做出一些合理的假设，这些假设可以极大地简化您的任务。但是，要充分利用它们，您可能需要比听起来更舒服的袖子卷起编程。

首先，可以肯定的是，他们使用的加密属于以下三个类别之一：

*   没有任何
*   俗气
*   比你可能破解的要好得多

中间情况的几率非常低。

接下来，可以肯定的是，数据包在程序边缘附近（就在它们进入时，就在它们出去之前）​​被加密/解密，并且游戏主体以解密的形式处理它们。

最后，他们使用的协议很可能包括

*   带有数据块的 ascii
*   二进制胶

因此，使用设置为混杂模式的卡对未加密的 ascii 进行小数据包嗅探。如果你看到一些，很好，你已经领先了。但是，如果您不放弃整个轻敲线的想法，而是开始跟踪代码，因为它通过断点和调试器单步执行从发送数据返回。图最外层或三层将是标准网络的东西，然后是加密层，除此之外还有大量处理未加密协议的东西。

如果你很热，你应该可以在一个小时内做到这一点，如果你相当熟练、积极和勤奋，你应该可以在一个周末完成，如果你没有希望的话，永远不会。但原则上（而且在实践中无疑更容易）这样做*是可能的。*

一旦你到达看起来像未加密的粘性的东西进来，被混杂，混杂的形式消失的地方，*然后*开始担心它意味着什么。

——马库斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T21:47:14.237

听起来好像没有加密，所以你可以做一个网络方法。

一个很好的起点是查找数据包 ID - 大多数情况下，靠近数据包前面的东西将是数据包类型的 ID。例如移动可以是 1，射击可以是“2”，聊天可以是“4”。

您可以编写自己的代理，在一个端口上侦听您的游戏连接，然后连接到服务器。您可以对您的代理进行按键触发命令，或者您可以让您的代理写出调试信息以帮助您更进一步。

（我已经用 PHP 为在线游戏编写了一个机器人 - 最重要的是。）

# php - 在 PHP 和 Mysql 中实现 hashtable 的步骤

> ID：539816
> 
> 赞同：4
> 
> 时间：2009-02-12T02:56:15.373
> 
> 标签：php, mysql, hashtable

我是编程语言的新手，我正在使用 PHP 和 mysql。我得到了一个在 php 中做哈希表的任务。我需要做的是，存储用户收集的项目，然后显示它。在网上做了一些研究后，我将在实现哈希表时执行以下步骤，如果我错了，请纠正我：

1.  设置表：

    -> 用户表：uid(int[5])、username(varchar[128])、item_id(int[8]、items_id_hash(int[50])

    -> 物品表：item_id(int[5]), item_name(varchar[128]), items_id_hash(int[50])

2.  创建散列函数（如何创建散列函数？自己创建还是从互联网获取？）将键转换为散列值，然后插入到数据库中。例如：散列 item_id = 001 成散列值 = (eg) 12345。然后插入用户表。

3.  显示/搜索。从用户那里检索哈希值，然后将其与项目表进行比较并显示它。

问题：

1.  我的步骤正确吗？
2.  我在哪里可以找到一个好的 php 哈希函数？我可以使用 md5 或 sha1 或盐吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T03:05:43.103

我认为您对哈希表的想法有点[已失效]。哈希表将键分解为相似的列表。例如：基于名称第一个字母的哈希表，因此将有 26 个列表。您的哈希是名称的第一个字母，这样可以更快地搜索。

md5、sha1 用于派生散列值，用于验证数据未被篡改。它们通常有 128 位或 160 位版本。因此，它需要 X 数据并通过散列发送它以得出一个 128 位的字母数字字符串，无论它在哪里完成都应该是相同的。这通常是一个安全问题。

**编辑：**扩展如何派生密钥的问题。

您可以利用数据的模数来创建用于行的键。在示例数据 % X 中，X 是您想要拥有的键的总数。问题是 X 很难找到。如果您有 20 个项目，那么将 X 变为 20 是可行的，并且可以快速搜索，因为每个项目都有自己的行。但是如果你有 1000 个项目，那么做 % 1000 是不可行的。做一些像 X = 75 这样的事情会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T03:11:09.130

你有两个主要问题：

1）您要选择（打开|关闭）哈希表的哈希表范式。

2) Hashtable 可以是一个简单的数组，带有键索引和冲突情况下的数组引用。

3）你必须研究你的哈希密钥生成算法（ $hash = ord($string[$i]) + ($hash << 5) - $hash; 就足够了），但你也可以选择 md5/sha . 如果您知道您的密钥空间，也许您可​​以使用 unix gperf。

这是我的哈希表实现：

```
<?php

/**
        A brief but simple closed hash table class.
        Jorge Niedbalski R. <jnr@niedbalski.org>
**/

class   HashTable       {

        public  $HashTable = array();
        public  $HashTableSize;

        public  function __construct($tablesize) 
        {
                if($tablesize) {
                        $this->HashTableSize = $tablesize;
                } else {
                        print "Unknown file size\n";
                        return -1;
                }
        }

        public  function __destruct() 
        {
                unset($this->HashTable);
        }

        public  function  generate_bucket($string) 
        {
                for($i=0; $i <= strlen($string); $i++) {
                        $hash = ord($string[$i]) + ($hash << 5) - $hash;
                }
                print "".$this->HashTableSize."\n";
                return($hash%$this->HashTableSize);
        }
    public  function  add($string, $associated_array)
        {
                  $bucket = $this->generate_bucket($string);

                  $tmp_array = array();
                  $tmp_array['string'] = $string;
                  $tmp_array['assoc_array'] = $associated_array;                

                  if(!isset($this->HashTable[$bucket])) {
                                $this->HashTable[$bucket] = $tmp_array;
                  } else {
                        if(is_array($this->HashTable[$bucket])) {
                                array_push($this->HashTable[$bucket], $tmp_array);
                        } else {
                                $tmp = $this->HashTable[$bucket];
                                $this->HashTable[$bucket] = array();
                                array_push($this->HashTable[$bucket], $tmp);
                                array_push($this->HashTable[$bucket], $tmp_array);
                        }
                }

        }

        public  function  delete($string, $attrname, $attrvalue) 
        {       
                $bucket = $this->generate_bucket($string);

                if(is_null($this->HashTable[$bucket])) {
                                return -1;
                } else {
                        if(is_array($this->HashTable[$bucket])) {
                                for($x = 0; $x <= sizeof($this->HashTable[$bucket]); $x++) {
                                        if(($this->HashTable[$bucket][$x]['string'] == $string) && ($this->HashTable[$bucket][$x]['.$attrname.'] == $attrvalue)) {
                                                unset($this->HashTable[$bucket][$x]);   
                                        }
                                }
    } else {
                                unset($this->HashTable[$bucket][$x]);
                        }
                }       
                /** everything is OK **/                        
                return 0;
        }

        public  function  search($string) 
        {
                $resultArray = array();

                $bucket = $this->generate_bucket($string);

                if(is_null($this->HashTable[$bucket])) {
                        return -1;
                } else {
                        if(is_array($this->HashTable[$bucket])) {
                                for($x = 0; $x <= sizeof($this->HashTable[$bucket]); $x++) {
                                        if(strcmp($this->HashTable[$bucket][$x]['string'], $string) == 0) {
                                                array_push($resultArray,$this->HashTable[$bucket][$x]);
                                        }
                                 }
                        } else {
                                array_push($resultArray,$this->HashTable[$bucket]);
                        }
                }

                return($resultArray);
        }
}

        $hash = new HashTable(16);

        $arr = array('nombre' => "jorge niedbalski");

        $hash->add("astroza", $arr);
        $hash->add("astrozas", $arr);

        print_r($hash->search("astroza"));

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T03:14:24.910

你的意思是一个哈希值（你存储在一个表中），而不是一个哈希表？

我看不出如何以有用的方式将这些数据存储在哈希表中。（Suroots 回答解释了哈希表）。

要使用 MD5 创建哈希值，请尝试

hash('md5', '要散列的字符串');

有关更多详细信息，请参见[http://au.php.net/function.hash](http://au.php.net/function.hash)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T04:23:47.940

**roa3**

该代码没有使用任何持久数据存储后端，您可以简单地对其进行扩展以添加 mysql 支持。

您必须在关系数据库中使用 one_to_many 关系（桶、条目）来实现这一点。

想想如何扩展这个基类。

祝你好运

# sharepoint - SharePoint 2007 - 如何更改附件回形针图像

> ID：539817
> 
> 赞同：2
> 
> 时间：2009-02-12T02:56:33.283
> 
> 标签：sharepoint

当列表项具有附件时，SharePoint 会自动为该特定行呈现回形针图像，这表明该项目具有附件。有什么办法可以改变渲染的图像？

该站点处于共享托管环境中，因此我不能简单地替换文件系统上的图像。此外，还有属于同一站点的其他列表应该使用默认图像。

有什么方法可以更改为单个列表中带有附件的项目呈现的图像？

**编辑**：以下是呈现的 HTML：

```
 <td class="ms-vb2">
    <img align="absbottom" src="http://devsandbox/_layouts/images/attach.gif" alt="Attachment"/>
</td> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T04:23:50.187

您能够做到这一点的唯一真正方法是使用 jQuery（或其他一些 javascript 库）。您需要在页面上找到要更新的元素并更改 URL

```
$('img[src*=attach.gif]').each(function() { 
  $(this).attr('src', '/path/to/new/image.png');
} 
```

我的 jQuery 可能有点错误，但应该足够接近让你知道该怎么做

**编辑**- 最好的解决方法是通过呈现 JavaScript 的自定义 WebPart。这样它可以很容易地放入您想要的任何页面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T03:10:20.113

我不知道顶部的哪个元素，但我会在其中一个样式表中查找它，并使用 SharePoint 设计器来完成特定列表的替换工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:31:43.820

使用 Firebug 检查要还原的元素。这将告诉您该元素使用的 css 类和其他属性。然后编写自己的类并将其添加到 core.css 文件中，或者如果需要，通过站点设置中的 MasterPages 链接将其添加到站点/站点集的 css 中。

## 编辑

我使用 firebug 在 SharePoint 中查看图像，这是它的呈现方式。

```
<img id="img_1-2_" class="rpo-gif rpo-gif-2" border="0" style="padding: 0px;" alt="Expand/Collapse" src="/_layouts/images/minus.gif"/> 
```

如您所见，它正在使用一个类并将 src 设置为“/_layouts/images/minus.gif”。好吧，您可以在 12Hive 目录中找到该文件，然后将其替换为您选择的具有相同名称的图像。

# c++ - 线程安全队列有问题吗？

> ID：539824
> 
> 赞同：2
> 
> 时间：2009-02-12T03:01:00.090
> 
> 标签：c++, multithreading, concurrency, queue, pthreads

我正在尝试使用 c++ 中的 pthreads 编写线程安全队列。我的程序在 93% 的时间里都能正常工作。另外 7% 的时间它会吐出垃圾，或者似乎睡着了。我想知道我的队列中是否存在上下文切换会破坏它的缺陷？

```
// thread-safe queue
// inspired by http://msmvps.com/blogs/vandooren/archive/2007/01/05/creating-a-thread-safe-producer-consumer-queue-in-c-without-using-locks.aspx
// only works with one producer and one consumer
#include <pthread.h>
#include <exception>

template<class T>
class tsqueue
{
    private:
        volatile int m_ReadIndex, m_WriteIndex;
        volatile T *m_Data;
        volatile bool m_Done;
        const int m_Size;
        pthread_mutex_t m_ReadMutex, m_WriteMutex;
        pthread_cond_t m_ReadCond, m_WriteCond;
    public:
        tsqueue(const int &size);
        ~tsqueue();
        void push(const T &elem);
        T pop();
        void terminate();
        bool isDone() const;
};

template <class T>
tsqueue<T>::tsqueue(const int &size) : m_ReadIndex(0), m_WriteIndex(0), m_Size(size), m_Done(false) {
    m_Data = new T[size];
    pthread_mutex_init(&m_ReadMutex, NULL);
    pthread_mutex_init(&m_WriteMutex, NULL);
    pthread_cond_init(&m_WriteCond, NULL);
    pthread_cond_init(&m_WriteCond, NULL);
}

template <class T>
tsqueue<T>::~tsqueue() {
    delete[] m_Data;
    pthread_mutex_destroy(&m_ReadMutex);
    pthread_mutex_destroy(&m_WriteMutex);
    pthread_cond_destroy(&m_ReadCond);
    pthread_cond_destroy(&m_WriteCond);
}

template <class T>
void tsqueue<T>::push(const T &elem) {
    int next = (m_WriteIndex + 1) % m_Size;
    if(next == m_ReadIndex) {
        pthread_mutex_lock(&m_WriteMutex);
        pthread_cond_wait(&m_WriteCond, &m_WriteMutex);
        pthread_mutex_unlock(&m_WriteMutex);
    }
    m_Data[m_WriteIndex] = elem;
    m_WriteIndex = next;
    pthread_cond_signal(&m_ReadCond);
}

template <class T>
T tsqueue<T>::pop() {
    if(m_ReadIndex == m_WriteIndex) {
        pthread_mutex_lock(&m_ReadMutex);
        pthread_cond_wait(&m_ReadCond, &m_ReadMutex);
        pthread_mutex_unlock(&m_ReadMutex);
        if(m_Done && m_ReadIndex == m_WriteIndex) throw "queue empty and terminated";
    }
    int next = (m_ReadIndex +1) % m_Size;
    T elem = m_Data[m_ReadIndex];
    m_ReadIndex = next;
    pthread_cond_signal(&m_WriteCond);
    return elem;
}

template <class T>
void tsqueue<T>::terminate() {
    m_Done = true;
    pthread_cond_signal(&m_ReadCond);
}

template <class T>
bool tsqueue<T>::isDone() const {
    return (m_Done && m_ReadIndex == m_WriteIndex);
} 
```

这可以像这样使用：

```
// thread 1
while(cin.get(c)) {
    queue1.push(c);
}
queue1.terminate();

// thread 2
while(!queue1.isDone()) {
    try{ c = queue1.pop(); }
    catch(char const* str){break;}
    cout.put(c);
} 
```

如果有人看到这个问题，请说出来:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T03:07:35.813

是的，这里肯定有问题。您对队列成员变量的所有访问都发生在互斥锁*之外。*实际上，我不完全确定您的互斥锁在保护什么，因为它们只是在等待条件变量。

此外，您的读取器和写入器似乎将始终以锁步方式运行，绝不允许队列的大小超过一个元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T03:05:51.030

如果这是您的实际代码，那么一个问题就是您正在初始化`m_WriteCond`两次，而根本没有初始化`m_ReadCond`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T03:14:44.190

你应该把这个类当作一个[监视器](http://en.wikipedia.org/wiki/Monitor_(synchronization))。您应该为每个队列（普通互斥锁）设置一个“监视器锁”。每当您输入一个读取或写入队列中任何字段的方法时，您应该在输入后立即锁定该互斥锁。这可以防止多个线程一次与队列交互。您应该在等待条件之前和离开方法时释放锁，以便其他线程可以进入。完成等待条件后，请确保重新获取锁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T15:33:54.477

If you want anything with decent performance I would strongly suggest dumping your R/W lock and just use a very simple spinlock. Or if you really think you can get the performance you want with R/W lock, i would roll your own based on [this](http://www.bluebytesoftware.com/blog/2009/01/30/ASinglewordReaderwriterSpinLock.aspx) design(single word R/W Spinlock) from Joe Duffy.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T03:11:55.587

似乎问题在于您有一个竞争条件，即线程 2 可以在线程 1 执行任何 cin.get(c) 之前运行。需要确保数据已初始化，并且当您获取信息时，您需要确保在未输入数据的情况下您正在做某事。

也许这是我没有看到完成此操作的其余代码。

# language-agnostic - 元组应该相互子类化吗？

> ID：539833
> 
> 赞同：1
> 
> 时间：2009-02-12T03:07:19.403
> 
> 标签：language-agnostic, inheritance, tuples

给定 OOP 语言中的一组元组类：Pair、Triple 和 Quad，Triple 应该是 Pair 的子类，Quad 是 Triple 的子类吗？

在我看来，问题在于 Triple 是否可以替代为 Pair，Quad 也可以替代 Triple 或 Pair。Triple*是否也是*一对，Quad*是否也是*Triple 和 Pair。

在一种情况下，这样的关系可能对可扩展性很有价值——今天这个东西返回一个 Pair of things，明天我需要它返回一个 Triple 而不破坏现有的调用者，他们只使用三个中的前两个。

另一方面，它们应该是不同的类型吗？我可以看到更强类型检查的好处——你不能将 Triple 传递给需要 Pair 的方法。

我倾向于使用继承，但真的很感谢其他人的意见吗？

PS：如果重要的话，课程（当然）将是通用的。

PPS：在更主观的方面，名称应该是 Tuple2、Tuple3 和 Tuple4 吗？

* * *

编辑：我认为这些更像是松散耦合的组；不是专门用于 x/yx/y/z 坐标之类的东西，尽管它们可能用于此类。这就像需要一个方法的多个返回值的通用解决方案，但形式具有非常简单的语义。

也就是说，我对其他人实际使用元组的所有方式都很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T03:39:29.543

在我看来，您应该制作一个通用的 Tuple 接口（或使用类似于上面提到的 Collection 的东西），并让您的 pair 和 3-tuple 类实现该接口。这样，您可以利用多态性，但也允许一对使用比任意大小的元组更简单的实现。您可能希望让您的 Tuple 接口包含 .x 和 .y 访问器作为前两个元素的简写，并且较大的元组可以根据具有较高索引的项目实现自己的简写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T04:27:05.857

这取决于您需要的语义 -

*   一对对立面在语义上与相似对象的 3 元组不兼容
*   极坐标空间中的一对坐标与欧几里得空间中的三元组坐标在语义上不兼容

如果您的语义是简单的组合，那么泛型类 Tuple<N> 会更有意义

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T05:09:42.073

不同长度的元组是不同的类型。（好吧，无论如何，在许多类型系统中。）在强类型语言中，我认为它们不应该是一个集合。

这是一件好事，因为它确保了更多的安全性。返回元组的地方通常有一些耦合信息，即每个组件是什么的隐含知识。如果你在一个元组中传递的值比预期的多，那就更糟了——这应该是什么意思？它不适合继承。

另一个潜在问题是您是否决定使用重载。如果元组相互继承，则重载解析将在不应该的地方失败。但这可能是反对重载的更好论据。

当然，如果您有特定的用例并发现某些行为会对您有所帮助，那么这些都不重要。

编辑：如果您想了解一般信息，请尝试阅读一些 Haskell 或 ML 系列 (OCaml/F#) 以了解它们是如何使用的，然后形成您自己的决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T05:31:05.377

像大多数与设计相关的问题一样，答案是——视情况而定。

如果您正在寻找传统的 Tuple 设计，Tuple2、Tuple3 等是您的选择。继承的问题在于，首先 Triplet 不是 Pair 的一种。你将如何为它实现 equals 方法？Triplet 是否等于前两项相同的 Pair？如果你有一个 Pairs 的集合，你可以添加三元组，反之亦然？如果在您的域中这很好，您可以使用继承。

无论如何，拥有所有这些实现的接口/抽象类（可能是元组）是值得的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T03:12:45.380

我会选择 0,1,2 或无穷大。例如 null、1 个对象、您的 Pair 类，或者某种集合。

你的 Pair 甚至可以实现一个 Collection 接口。

如果三个或四个项目之间存在特定的关系，它可能应该被命名。

[也许我错过了这个问题，但我想不出一个我想以通用方式专门链接 3 件事的情况]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T07:38:16.787

Gilad Bracha[写了一篇关于 tuples 的博客](http://gbracha.blogspot.com/2007/02/tuples.html)，我觉得读起来很有趣。

他提出的一点（无论是否正确，我还无法判断）是：

> 文字元组最好定义为只读。原因之一是只读元组更具多态性。长元组是短元组的子类型：
> 
> {STU V} <= {ST U} <= {S。T} <= {S}
> 
> [和] 只读元组是协变的：
> 
> T1 <= T2，S1 <= S2 ==> {S1\. T1} <= {S2。T2}

这似乎表明我使用继承的倾向可能是正确的，并且当 amit.dev 说 Triple*不是*Pair 时会与他相矛盾。

# c - 仅使用恒定移位来模拟可变位移？

> ID：539836
> 
> 赞同：12
> 
> 时间：2009-02-12T03:09:56.637
> 
> 标签：c, performance, assembly, bit-manipulation, powerpc

我试图找到一种方法来执行间接左/右移位操作，而无需实际使用变量移位操作或任何分支。

我正在研究的特定 PowerPC 处理器有一个按常数立即移位的怪癖，比如

```
int ShiftByConstant( int x ) { return x << 3 ; } 
```

是快速的、单操作的和超标量的，而一个移位变量，比如

```
int ShiftByVar( int x, int y ) { return x << y ; } 
```

是一个[微编码操作，需要 7-11 个周期才能执行，而管道的整个其余部分都停止了](http://www.cellperformance.com/articles/2006/04/avoiding_microcoded_instructio.html)。

我想做的是找出将[sraw](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.aixassem/doc/alangref/sraw.htm)解码到哪个非微编码整数 PPC 操作，然后单独发出它们。这对自身的延迟没有帮助[`sraw`](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.aixassem/doc/alangref/sraw.htm)——它将用六个操作替换一个操作——但在这六个操作之间，我可以将一些工作双分派给其他执行单元并获得净收益。

我似乎在任何地方都找不到 μops sraw 解码到的任何地方——有谁知道我如何用一系列常量移位和基本整数运算替换变量移位？（for 循环或 switch 或任何带有分支的东西都不起作用，因为分支惩罚甚至比微码惩罚更大，即使对于正确预测的分支也是如此。）

这不需要在汇编中回答；我希望学习算法而不是特定代码，因此 C 或高级语言甚至伪代码的答案将非常有帮助。

**编辑：**我应该添加一些澄清：

1.  我什至一点都不担心便携性
2.  PPC 有条件移动，所以我们可以假设存在一个无分支的内在函数

    ```
    int isel(a, b, c)  { return a >= 0 ? b : c; } 
    ```

    （如果你写出一个做同样事情的三元组，我会明白你的意思）

3.  整数乘法也是微编码的，甚至比`sraw`. :-(
4.  在 Xenon PPC 上，预测分支的延迟为 8 个周期，因此即使是一个也使其与微编码指令一样昂贵。跳转到指针（任何间接分支或函数指针）是有保证的错误预测，24 个周期的停顿。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-10-21T21:35:16.593

Here you go...

I decided to try these out as well since Mike Acton claimed it would be faster than using the CELL/PS3 microcoded shift on his CellPerformance site where [he suggests to avoid the indirect shift](http://cellperformance.beyond3d.com/articles/2006/04/avoiding-microcoded-instructions-on-the-ppu.html). However, in all my tests, using the microcoded version was not only faster than a full generic branch-free replacement for indirect shift, it takes way less memory for the code (1 instruction).

The only reason I did these as templates was to get the right output for both signed (usually arithmetic) and unsigned (logical) shifts.

```
template <typename T> FORCEINLINE T VariableShiftLeft(T nVal, int nShift)
{   // 31-bit shift capability (Rolls over at 32-bits)
    const int bMask1=-(1&nShift);
    const int bMask2=-(1&(nShift>>1));
    const int bMask3=-(1&(nShift>>2));
    const int bMask4=-(1&(nShift>>3));
    const int bMask5=-(1&(nShift>>4));
    nVal=(nVal&bMask1) + nVal;   //nVal=((nVal<<1)&bMask1) | (nVal&(~bMask1));
    nVal=((nVal<<(1<<1))&bMask2) | (nVal&(~bMask2));
    nVal=((nVal<<(1<<2))&bMask3) | (nVal&(~bMask3));
    nVal=((nVal<<(1<<3))&bMask4) | (nVal&(~bMask4));
    nVal=((nVal<<(1<<4))&bMask5) | (nVal&(~bMask5));
    return(nVal);
}
template <typename T> FORCEINLINE T VariableShiftRight(T nVal, int nShift)
{   // 31-bit shift capability (Rolls over at 32-bits)
    const int bMask1=-(1&nShift);
    const int bMask2=-(1&(nShift>>1));
    const int bMask3=-(1&(nShift>>2));
    const int bMask4=-(1&(nShift>>3));
    const int bMask5=-(1&(nShift>>4));
    nVal=((nVal>>1)&bMask1) | (nVal&(~bMask1));
    nVal=((nVal>>(1<<1))&bMask2) | (nVal&(~bMask2));
    nVal=((nVal>>(1<<2))&bMask3) | (nVal&(~bMask3));
    nVal=((nVal>>(1<<3))&bMask4) | (nVal&(~bMask4));
    nVal=((nVal>>(1<<4))&bMask5) | (nVal&(~bMask5));
    return(nVal);
} 
```

**EDIT:** Note on isel() I saw your [isel() code on your website](http://assemblyrequired.crashworks.org/2009/01/04/fcmp-conditional-moves-for-branchless-math/comment-page-1/#comment-5026).

```
// if a >= 0, return x, else y
int isel( int a, int x, int y )
{
    int mask = a >> 31; // arithmetic shift right, splat out the sign bit
    // mask is 0xFFFFFFFF if (a < 0) and 0x00 otherwise.
    return x + ((y - x) & mask);
}; 
```

FWIW, if you rewrite your isel() to do a mask and mask complement, it will be faster on your PowerPC target since the compiler is smart enough to generate an 'andc' opcode. It's the same number of opcodes but there is one fewer result-to-input-register dependency in the opcodes. The two mask operations can also be issued in parallel on a superscalar processor. It can be 2-3 cycles faster if everything is lined up correctly. You just need to change the return to this for the PowerPC versions:

```
return (x & (~mask)) + (y & mask); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-12T03:19:10.577

这个怎么样：

```
if (y & 16) x <<= 16;
if (y & 8) x <<= 8;
if (y & 4) x <<= 4;
if (y & 2) x <<= 2;
if (y & 1) x <<= 1; 
```

如果您有其他代码要执行，则可能需要更长的时间才能执行，但更容易交错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T04:06:23.350

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T03:27:51.087

这个让我头疼。我现在已经放弃了六个想法。他们都利用了这样一个概念，即向自身添加一个东西左移 1，对结果左移 4 做同样的事情，依此类推。如果您保留左移 0、1、2、4、8 和 16 的所有部分结果，那么通过测试移位变量的位 0 到 4，您可以获得初始移位。现在再做一次，移位变量中的每个 1 位一次。坦率地说，你不妨把你的处理器送出去喝咖啡。

我寻求真正帮助的一个地方是 Hank Warren's [*Hacker's Delight*](http://www.hackersdelight.org)（这是这个答案中唯一有用的部分）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T03:33:56.187

这个怎么样：

```
int[] multiplicands = { 1, 2, 4, 8, 16, 32, ... etc ...};

int ShiftByVar( int x, int y )
{
    //return x << y;
    return x * multiplicands[y];
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-25T12:01:51.687

If the shift count can be calculated far in advance then I have two ideas that might work

*   Using self-modifying code

    Just modify the shift amount immediate in the instruction. Alternatively generate code dynamically for the functions with variable shift

*   Group the values with the same shift count together if possible, and do the operation all at once using Duff's device or function pointer to minimize branch misprediction

    ```
    // shift by constant functions
    typedef int (*shiftFunc)(int);    // the shift function
    #define SHL(n) int shl##n(int x) { return x << (n); }
    SHL(1)
    SHL(2)
    SHL(3)
    ...
    shiftFunc shiftLeft[] = { shl1, shl2, shl3... };

    int arr[MAX];       // all the values that need to be shifted with the same amount
    shiftFunc shl = shiftLeft[3]; // when you want to shift by 3
    for (int i = 0; i < MAX; i++)
        arr[i] = shl(arr[i]); 
    ```

    This method might also be done in combination with self-modifying or run-time code generation to remove the need for a function pointer.

    **Edit:** As commented, unfortunately there's no branch prediction on *jump to register* at all, so the only way this could work is generating code as I said above, or using SIMD

* * *

If the range of the values is small, lookup table is another possible solution

```
#define S(x, n) ((x) + 0) << (n), ((x) + 1) << (n), ((x) + 2) << (n), ((x) + 3) << (n), \
                ((x) + 4) << (n), ((x) + 5) << (n), ((x) + 6) << (n), ((x) + 7 << (n)
#define S2(x, n)    S((x + 0)*8, n), S((x + 1)*8, n), S((x + 2)*8, n), S((x + 3)*8, n), \
                    S((x + 4)*8, n), S((x + 5)*8, n), S((x + 6)*8, n), S((x + 7)*8, n)
uint8_t shl[256][8] = {
    { S2(0U, 0), S2(8U, 0), S2(16U, 0), S2(24U, 0) },
    { S2(0U, 1), S2(8U, 1), S2(16U, 1), S2(24U, 1) },
    ...
    { S2(0U, 7), S2(8U, 7), S2(16U, 7), S2(24U, 7) },
} 
```

Now `x << n` is simply `shl[x][n]` with x being an `uint8_t`. The table costs 2KB (8 × 256 B) of memory. However for 16-bit values you'll need a 1MB table (16 × 64 KB), which may still be viable and you can do a 32-bit shift by combining two 16-bit shifts together

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-12T04:27:19.337

There is some good stuff here regarding bit manipulation black magic: [Advanced bit manipulation fu (Christer Ericson's blog)](http://realtimecollisiondetection.net/blog/?p=78)

Don't know if any of it's directly applicable, but if there is a way, likely there are some hints to that way in there somewhere.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-08-24T17:34:43.943

Here's something that is trivially unrollable:

```
int result= value;

int shift_accumulator= value;

for (int i= 0; i<5; ++i)
{
    result += shift_accumulator & (-(k & 1)); // replace with isel if appropriate
    shift_accumulator += shift_accumulator;
    k >>= 1;
} 
```

# wix - WiX 快捷方式会覆盖现有的同名快捷方式

> ID：539845
> 
> 赞同：0
> 
> 时间：2009-02-12T03:12:30.233
> 
> 标签：wix

当 Wix 创建与现有快捷方式同名的快捷方式时，它会覆盖现有快捷方式。有没有办法检测现有的快捷方式并确保新的快捷方式具有唯一的名称？

例如，如果 Wix 在桌面上安装了快捷方式“MyApp”，但用户的桌面上已经有一个名为“MyApp”的快捷方式，我希望 Wix 安装快捷方式“MyApp (2)”（或类似的东西）并保持现有的“MyApp”快捷方式不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T06:52:23.220

您需要自己编程，在这种情况下，Wix 充当 Windows Installer 的管道，而 Windows Installer 没有这种行为。
您可以编写一个自定义操作来检测快捷方式是否退出并提供一个新名称（通过属性），在 wxs 中创建快捷方式但为 name 属性提供 [SHORTCUTNAME]。
如果你写一次，我会很高兴得到它。

# apache-flex - 如何在 Flex 中使用 FTP？

> ID：539855
> 
> 赞同：6
> 
> 时间：2009-02-12T03:15:18.230
> 
> 标签：apache-flex, ftp

我是 Flex 环境的新手，特别是 flex3。我已经学习了1周。我有一个项目，我需要 FTP 来上传和下载 mp3 和图片文件。

最好的入门方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T03:20:05.597

如果你的意思是在 Flex 中创建一个 FTP 客户端，它已经完成了：

[弹性FTP](http://projects.maliboo.pl/FlexFTP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-27T20:31:57.100

我2年前用过这个。它工作得很好，但只缺少一件事，并且无法用于大文件（超过 10 或 50 个月）。

事实上，Flex 中的套接字有一个可以写入的缓冲区，以便发送数据。但是您无法确定已发送了多少缓冲区，也无法确定它是否为空。

因此，使用 flex 无法检索上传或上传完成的进度...... maliboo 在 pl.maliboo.ftp.invokers.UploadInv 类中做了一个近似。他每 300 毫秒发送一次 4096，并认为没问题。

这将永远是真的，因为这是最坏的情况，但是当您以良好的连接速度上传 3Go 时，脚本将永远运行，并且上传完成。

# c# - 有没有人将 ADOMD.NET 与 WPF DataGrid 一起使用？

> ID：539858
> 
> 赞同：0
> 
> 时间：2009-02-12T03:15:31.800
> 
> 标签：c#, wpf, olap, pivot-table, adomd.net

我试图找到一种从 C# 访问商业智能 OLAP 多维数据集的好方法。

我不太关心这是如何完成的，但由于目前我正在尝试使用[codeplex WPF Toolkit](http://www.codeplex.com/wpf)来实现它，如果它与该工具直接相关，我会很高兴，但任何建议都非常受欢迎。

我缺乏 WPF 技能，因此网站上的提示和技巧不足以让我了解如何将 DataGrid 绑定到 OLAP 多维数据集。

我认为我应该使用 ADOMD.NET，但还不确定这是否是要走的路，如果是这样，如何去做，教程和信息链接让我非常困惑。

由于在寻找任何已制作的示例时，我一直在兜圈子，因此我将不胜感激这方面的任何指示。

欢迎提供教程、链接、个人提示或经验。

额外信息：*这是为了替换 Excel 电子表格中当前使用的数据透视表。*

谢谢，

里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:25:45.973

我能找到的最接近的是Mosha Pasumanski 的[这个 xaml 数据透视表](http://www.sqljunkies.com/WebLog/mosha/archive/2006/10/08/xaml_pivottable.aspx)：

[![替代文字](https://i.stack.imgur.com/ah2UL.png)](https://i.stack.imgur.com/ah2UL.png)
[（来源：[mosha.com](http://www.mosha.com/msolap/images/XAML_PivotTable.png)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T10:53:09.443

不幸的是，Mosha 文章链接的代码位于 wpf.netfx3.com 站点中，该站点已被删除。

# artificial-intelligence - 如何创造现实生活中的机器人？

> ID：539859
> 
> 赞同：22
> 
> 时间：2009-02-12T03:16:32.877
> 
> 标签：artificial-intelligence, robotics

甚至在我学习编程之前，我就对机器人的工作方式很着迷。现在我知道如何编写底层编程指令，但我不明白的是机器人如何遵循这些指令。

例如，如果我写了这段代码：

```
object=Robot.ScanSurroundings(300,400);
if (Objects.isEatable(object))
{
   Robot.moveLeftArm(300,400);
   Robot.pickObject(object);
} 
```

CPU 将如何跟踪该程序以使机器人执行向左看、移动手臂等物理动作？它主要是用二进制语言/ASM 完成的吗？

最后，如果我想学习如何创建机器人，我会去哪里？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-12T03:55:35.823

最后，必须将高级命令分解为非常低级的命令。必须将“拿起杯子”翻译成如何移动手臂（关节应该处于什么角度）到实际转动电机的硬件命令。

有些框架试图提供一定数量的这种翻译，包括（但不限于）：

*   [播放器/舞台](http://playerstage.sourceforge.net/)
*   [微软机器人工作室](http://msdn.microsoft.com/en-us/robotics/default.aspx)
*   [卡门](http://carmen.sourceforge.net/)
*   [清晰](http://claraty.jpl.nasa.gov/man/overview/index.php)
*   [乐高头脑风暴](http://mindstorms.lego.com/eng/india_dest/Default.aspx)

然而，由于机器人研究对系统的每一层都感兴趣，因此提供整个翻译堆栈的系统并不多。如果您正在研究机器人技术，有几个系统试图使这更容易（再次，随机样本）：

*   [乐高头脑风暴](http://mindstorms.lego.com/eng/india_dest/Default.aspx)
*   [泰克](http://www.terk.ri.cmu.edu/)
*   [VEX 机器人](http://www.vexrobotics.com/)

如果做不到这一点，[Make](http://makezine.com/)等网站甚至提供了构建机器人项目的指南。挑战是找到一个你感兴趣的项目，然后去城里！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T03:27:25.737

您应该查看[Microsoft Robotics Studio](http://msdn.microsoft.com/en-us/robotics/default.aspx) (MRS)。他们有许多[视频/截屏视频](http://msdn.microsoft.com/en-us/robotics/bb383569.aspx)和[书面教程](http://msdn.microsoft.com/en-us/robotics/aa731536.aspx)。此外，Channel9 有[很多关于机器人主题的视频](http://channel9.msdn.com/tags/Robotics/)、采访等。包括演示，以及对 MRS 开发人员的采访。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T13:11:54.177

在大多数现代机器人中，您将拥有机构的逆运动学模型，在这种情况下是手臂，它将空间坐标转换为手臂关节的位置。这些关节通常由伺服电机移动。为了平稳地移动手臂，您需要一系列中间关节位置来定义您希望手臂遵循的路径。您还必须担心关节的速度，它们共同控制着手臂末端“手”的速度。

当手臂移动时，您的伺服系统将获得有关其实际位置的反馈。简单的伺服系统可以使用基本的 PID 反馈回路来调整电机。更复杂的系统将包括补偿惯性、重力、摩擦等的前馈参数。这些可以变得非常复杂。

当您必须在机器人周围的空间中留出障碍物时，真正的乐趣就开始了。您必须感知障碍物并弄清楚如何避开它并仍然到达目的地。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-12T06:14:04.687

我只需要在其中添加一些关于[Arduino 项目](http://www.arduino.cc/)的内容，因为我没有看到上面提到的内容。

进入基于 Arduino 的机器人项目的门槛非常低。您为硬件编写的“草图”程序非常容易上手，并且类似于 C 语法。如果您不知道电阻器中的晶体管，这些板仍然允许您使用插件硬件和扩展基础计算机板的附加[“屏蔽”做很多事情。](http://www.liquidware.com/shop)

它非常有趣，非常灵活，可以让您的代码与现实世界进行交互。加上它的“开放硬件”非常符合开源软件的路线。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T03:46:21.370

机器人将通过与硬件交互来工作。代码的桥接通常通过不同类型的 I/O 端口完成。例如，它可能只是一根 RS232 电缆（你知道那些旧的 COM1 端口）。硬件部分将由电机（如[伺服电机](http://www.seattlerobotics.org/guide/servos.html)）和传感器（如超声波感知障碍物、激光测距或开关）组成。

您不需要使用汇编程序来做到这一点，有很多语言（如果不是大多数）可以做到这一点，但它需要有关如何与硬件交互的知识。就像写一个驱动程序一样。如果您想自己构建机器人，它至少也需要基本的电子设备。

如果你有兴趣，我建议你看看[这本书](https://rads.stackoverflow.com/amzn/click/com/1893115445)，这是一本很好的入门书。

此外，您可以尝试编写[Basic stamp](http://www.parallax.com/)，按照教程非常容易，它将为您提供如何构建机器人的良好开端。它并不太贵，您很快就会与硬件进行交互。

祝好运并玩得开心点！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T03:53:42.007

如果你在编程方面做得足够好，你可能会发现你甚至不需要机器人来测试你需要编写的大部分最难的代码......（IE，让机器人看到并识别一个总是着迷的场景我...但是在某个时候，我意识到这个问题所需的物理机器人是容易的部分......软件是困难的部分！）......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T03:24:50.640

可能更容易获得更高级的语言来描述机器人的行为和智能，并让低级语言来进行动作（移动手臂、行走、停止）。有很多关于智能代理的 BDI 架构的研究，google 一下。

[你可以在这个站点](http://jason.sf.net)上找到更多关于它的信息，它是一个用 Java 描述代理行为的 DSL。它被称为 Jason 解释器，语言是 AgentSpeak(L)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-09T02:21:58.793

寻找当地的[FIRST](http://www.usfirst.org)机器人团队并自愿担任导师。FIRST 是针对初中生和高中生的机器人竞赛。目标是让孩子们完成构建、编程、测试和运行机器人的所有工作，但您仍然有很多机会深​​入研究并真正学习软件。他们正在使用[LabView](http://www.ni.com/labview/)由 National Instruments 主办，截至 2 月 8 日，今年的区域比赛才刚刚开始。LabView 是一个图形编程环境，它与 NI 硬件接口，让您可以对电机、执行器和传感器进行编程。NI 的东西非常漂亮而且很容易使用，而且它是免费提供给每个团队的，所以你不必自己购买硬件和软件（至少开始使用）。另外，你可以获得额外的奖励帮助新一代工程师起步。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T03:22:42.050

您必须有一个与硬件接口的驱动程序（很可能是带有电机的 STAMP 或 FPGA 等......）。然后你会调用函数 me.moveLeftArm(x,y); 并且驱动程序会知道 moveLeftArm() 意味着将执行器移动 X 秒/毫秒/度。

我相信你可以找到一个进行机器人编程的工具包。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-09T02:04:44.187

如果你想要一个 Java 替代品，我可以推荐这本书[Linux Robotics](https://rads.stackoverflow.com/amzn/click/com/007144484X)。它有很多关于从何处获取套件、部件和传感器的有用信息，以及完整的 Java 源代码清单。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-09T02:53:47.440

我有同样的渴望。我要购买我的第一个[Beagle Board](http://beagleboard.org/)和一些可以使用[I2C](http://en.wikipedia.org/wiki/I%C2%B2C)总线的传感器/伺服器。我将使用事件驱动设计和纤维（如果你愿意的话）的粗略实现，它们是用户空间线程。

基本上我的设计需要一个进程，每组伺服启动一个线程。每个组管理器线程将启动 x # 个原纤维，每个伺服 2 个（可能）。一根原纤维用于控制伺服，另一根原纤维处理来自该伺服的事件（即，物体太重而无法拾取，物体掉落等）。

主要过程的任务是从其他事物中侦听事件，并确保“右手知道左手在做什么”，同时前进和越过障碍。

我需要两年的大部分时间才能使某些工作达到我为之自豪的程度..但我预计会有很多愉快的夜晚来实现这一点。

我很可能会使用微内核，而不是 Linux。

我这样做是为了通过事件驱动的方法来磨练自己，以及我制作自己的 R2 的愿望 :)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-08T20:54:44.313

如果您熟悉 .Net ，请从***Phidets***开始。您可以在[TrossenRobotics.com](http://www.TrossenRobotics.com)上查看零件。

Phidg​​ets 接口套件是一个很好的起点。从那里你可以得到一个伺服控制器并开始构建移动的东西。

Trossen 论坛也是审查其他人项目的好地方。他们也有一个带有代码/项目示例的新数据中心。我不为他们工作......只是一个快乐的客户。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-01-12T06:06:20.970

这里有很多很好的答案。您的幻想代码与您在 MS Robotics Studio 上使用更高级别的语言（例如 C#）的方式相距不远。请记住，即使是简单的事情（例如“向左移动手臂”）也充满了“信息偏差”。

在金属上，机械臂是一组连杆和[可能]电动关节。因此，“向左移动手臂”（或坐标中的任何点）已经是一项非常复杂的计算任务（查找 D&H 表、机械手的正向和反向运动学）。

还有一个概念，即向左移动手臂假设该空间中没有任何东西并且不会发生碰撞。如果环境不受约束，那么您需要实现一个碰撞检测系统，通常基于某种传感器（相机）和机器视觉算法。

总之，与对系统建模以实现所需行为相比，语言和硬件接口通常是微不足道的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-05-03T18:41:05.200

关于最后一个问题“如何创建机器人”，我发现从在[Adafruit][1]、[Hackster.io][2]甚至[glitch][3]等在线社区中寻找相关项目开始，或寻找从零开始构建机器人的人的博客文章，例如[https://burningservos.com](https://burningservos.com)，或为硬件和软件提供文档和教程的产品，例如[http://emanual.robotis.com/ docs/en/platform/openmanipulator_x/overview/](http://emanual.robotis.com/docs/en/platform/openmanipulator_x/overview/)。

# sql-server - 从 SQL Server 检测 DataTable 中的 TimeStamp 列的任何方法（fillSchema ???）

> ID：539864
> 
> 赞同：1
> 
> 时间：2009-02-12T03:17:47.257
> 
> 标签：sql-server, visual-studio, sql-server-2005, ado.net

从“select * from sometable”更新数据表时，我正在迭代数据表中的列以根据 datatable.rowstate 和 DataTable.PrimaryKey 动态创建更新或插入语句。

但是，我似乎在 SQL Server 中找不到任何指示列是否为时间戳的属性，因此必须在更新语句中忽略！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T03:30:26.243

我会说你需要提前知道行类型。除非您编写了一个 SQL 脚本，该脚本对您要复制的表进行了描述并查找时间戳格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T17:51:51.430

尝试使用 SqlDataReader 类的 GetSchemaTable 方法。它将返回每列的元数据。您将感兴趣的特定属性是 DataTypeName 和 isRowVersion。

```
string sql = "SELECT * FROM SomeTable";
using ( SqlConnection cn = new SqlConnection ())
{
   cn.ConnectionString = "Your Connection String";
   cn.Open ();
   using ( SqlCommand cmd = new SqlCommand ( sql, cn ) )
   {
      SqlDataReader dataReader = cmd.ExecuteReader ( CommandBehavior.KeyInfo );
      dataReader.Read ();

      DataTable dt = dataReader.GetSchemaTable ();
      foreach ( DataRow r in dt.Rows )
      {
        Console.WriteLine ( "Column name: {0}\t Data Type: {1}\t IsRowVersion:{2}", r["ColumnName"].ToString (), r["DataTypeName"].ToString (), r["isRowVersion"].ToString() );
      }

    }
 } 
```

# php - 我是否应该始终验证对象是否为 NULL？

> ID：539867
> 
> 赞同：2
> 
> 时间：2009-02-12T03:18:45.647
> 
> 标签：php, oop

我有一个通过工厂构建的对象，其中包含从 url 读取的参数。

从这个对象，我可以得到语言参数

> $language = $my_parameters->getLanguage();

$language 如果未设置，则为 NULL。

$language 也可能无效（ $language->isValid() 返回 false ）。

所以，要构建我的页面，我需要一些参数。

该页面也是通过工厂构建的。然后我知道构建它需要哪些参数。如果它错过了参数，我会根据所询问的页面使用有效的默认值来构建它们。

此时，进入页面工厂，如果a有无效参数，我抛出异常。

我的页面对象包含一个需要语言参数的正文对象。我知道当我构建我的身体对象时我的参数是有效的。

进入我的身体对象，我检索语言

> $language = $my_parameters->getLanguage();

此时，$language ** 必须 ** 有效。所以我再次验证

```
$language = $my_parameters->getLanguage();
if( is_null( $language ) or !$language->isValid() ) {
   throw new Exception( 'Language must be valid.' );
} 
```

如果我需要 4 个参数，我有 4 个*if*来验证对象是否不是 NULL 并且不是无效的。

我这样做是因为该**方法是公开**的，其中 $language 在 body object 中使用。

**并且body对象可能是在工厂之外构建的。**谁知道...

在这种情况下验证是否正确？

最好的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T03:23:16.837

[这是](http://googletesting.blogspot.com/2009/02/to-assert-or-not-to-assert.html)*Google 测试博客最近的一篇博文中[*不*](http://googletesting.blogspot.com/2009/02/to-assert-or-not-to-assert.html)[检查 null的情况。](http://googletesting.blogspot.com/2009/02/to-assert-or-not-to-assert.html)*

 *争论是它妨碍了编写清晰、简单的单元测试，因为你实际上不能伪造无关紧要的部分，因为你的异常/断言会被抛出。

作者 (Miško Hevery) 确实通过说如果它是一个外部 API，它可能仍然值得检查错误情况来限定评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T03:23:10.083

我对您的域知之甚少，但在一般情况下，我喜欢在整个地方断言（非空），因为通常如果我最终在某个地方得到一个空对象，它就是一个错误。

首选通常甚至不能为空的引用类型也是一种好习惯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T03:26:24.163

我来自一所非常古老的 C 编程学校；所以我的事情是那些没有被使用或已经 free()'d 的变量应该始终为 NULL。这只是我的意见。

**编辑：**在此基础上，您应该始终检查变量是否为 NULL，然后再使用它。如果变量为 NULL 并且不应该是，那么您应该记录一个错误。崩溃不应该是一个功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T04:04:50.263

通过将 getLanguage() 拆分为两种方法，您可以让自己的生活变得更简单：

```
function getLanguageIfValid() {
  // this method return a Language object, but only if it can be created
  // correctly and the isValid() method returns TRUE. If the Language object
  // can't be created correctly, then it will return null instead.
}

function getLanguageMustBeValid() {
    // this method will always return an instance of Language, or else
    // an exception will be thrown
    if($return = $this->getLanguageIfValid())
        return $return;
    throw new Exception("Couldn't get Language object");
} 
```

完成此操作后，在可以合理地说可能无法正确创建语言项的地方，您使用第一种方法：

```
// we may or may not be able to get our Language object here
if($language = $my_parameters->getLanguageIfValid())
    do_stuff($language); 
```

如果您确定应该创建语言对象，请使用第二种方法，该方法将为您抛出异常。

```
// we know the Language object is created at this point
$language = $my_parameters->getLanguageMustBeValid();
do_stuff($language); 
```

因此，您的问题的答案是**否定**的——您不必验证对象不为空，只要您可以从我们保证不返回空的函数中获取它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T12:35:17.027

从 ->getLanguage() 抛出你的异常。

对我来说，应该自动抛出异常。您所做的似乎是错误代码检查和异常抛出的混合体。

# c++ - 非公共功能是否应该进行单元测试以及如何进行？

> ID：539877
> 
> 赞同：8
> 
> 时间：2009-02-12T03:22:52.907
> 
> 标签：c++, unit-testing

我正在为我的一些代码编写单元测试，并且遇到了这样一种情况：我有一个对象，其暴露的接口很小，但内部结构复杂，因为每个暴露的方法都运行大量内部函数，包括对对象状态的依赖。这使得外部接口上的方法很难进行单元测试。

我最初的问题是我是否也应该对这些内部函数进行单元测试，因为它们更简单，因此更容易编写测试？我的直觉说是的，这导致了后续问题，如果是这样，我将如何在 C++ 中执行此操作？

我想出的选项是将这些内部函数从私有更改为受保护，并使用友元类或继承来访问这些内部函数。这是最好/唯一的方法吗？这样做会保留一些隐藏内部方法的语义吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-12T03:47:45.920

如果您的对象正在执行高度复杂的操作，这些操作极难通过有限的公共接口进行测试，则可以选择将一些复杂的逻辑分解到封装特定任务的实用程序类中。然后，您可以单独对这些类进行单元测试。将代码组织成易于消化的块总是一个好主意。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-12T03:27:11.913

简短的回答：是的。

至于如何，我几天前在 SO 上获得了一个传递参考：

```
#define private public 
```

在读取相关标头之前评估的单元测试代码中......
同样适用于受保护的。

很酷的主意。

* * *

稍微长一点的答案：测试代码是否*明显不正确*。这基本上意味着任何做一些不平凡的事情的代码。

* * *

考虑到这一点，我想知道。您将无法链接到您在生产构建中使用的同一目标文件。现在，单元测试有点人为的环境，所以也许这不是一个交易破坏者。任何人都可以阐明这个技巧的利弊吗？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-12T03:46:42.163

我个人的感觉是，如果测试公共接口不足以充分测试私有方法，您可能需要进一步分解类。我的理由是：私有方法应该只够支持公共接口的所有用例。

但是我在单元测试方面的经验（不幸的是）很少；如果有人可以提供一个令人信服的例子，其中大量私有代码无法分离出来，我当然愿意重新考虑！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-12T04:01:13.783

有几种可能的方法。假设你的班级是 X：

1.  仅使用 X 的公共接口。您将遇到大量设置问题，并且可能需要一个覆盖工具来确保您的代码被覆盖，但不涉及特殊技巧。
2.  使用“#define private public”或类似的技巧来链接公开给所有人的 Xo 版本。
3.  添加一个公共的“静态 X::unitTest()”方法。这意味着您的代码将链接到您的测试框架。（但是，与我合作的一家公司将其用于软件的远程诊断。）
4.  添加“class TestX”作为 X 的朋友。TestX 不包含在您的生产 dll/exe 中。它只在您的测试程序中定义，但它可以访问 X 的内部。
5.  其他...

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-12T05:14:56.147

我的意见是否定的，一般**不**应该直接测试它们。

从系统的更高角度来看，单元测试是白盒，但从被测类接口（其公共方法及其预期行为）的角度来看，它们应该是**黑盒。**

例如，一个字符串类（不需要传统的 char* 支持）：

*   您应该验证它的 length() 方法是否正常工作。
*   您不必验证它是否将 '\0' 字符放在其内部缓冲区的末尾。这是一个实现细节。

这允许您在以后几乎不接触测试的情况下重构实现
这有助于您通过强制执行类责任来减少耦合
这使您的测试更易于维护

例外情况是您希望更彻底地验证的相当复杂的辅助方法。
但是，这可能暗示这段代码应该是“官方的”，通过将其设为公共静态或使用其公共方法在其自己的类中提取。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-12T03:42:02.737

我会说使用代码覆盖工具来检查这些功能是否已经以某种方式进行了测试。

从理论上讲，如果您的公共 API 通过了所有测试，那么只要涵盖了所有可能的场景，私有函数就可以正常工作。这是主要问题，我认为。

我知道有用于 C/C++ 的工具。[CoverageMeter](http://www.coveragemeter.com/)就是其中之一。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T03:44:21.577

除非您正在制作一个通用库，否则您应该尝试将您构建的内容限制为您将要使用的内容。根据需要扩展。因此，您应该拥有完整的代码覆盖率，并且应该对其进行全部测试。

也许你的代码有点臭？是时候重构了吗？如果你有一个大类在内部做很多事情，也许应该把它分成几个小的类，你可以单独测试它们的接口。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-12T10:15:23.493

我一直认为，如果您使用测试驱动开发，这往往会落到实处。有两种方法可以进行开发，要么从公共接口开始，在每次添加到复杂的私有方法之前编写一个新测试，要么开始将复杂的东西作为公共的，然后重构代码以使方法私有以及您已经编写的使用新公共接口的测试。无论哪种方式，您都应该获得全面覆盖。

当然，我从来没有设法以严格的 tdd 方式编写整个应用程序（甚至是类），如果可能的话，将复杂的东西重构为实用程序类是可行的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-12T03:27:44.207

你总是可以在私有周围使用编译开关：比如

#如果定义（UNIT_TEST）

或者使用代码覆盖工具验证您对公共功能的单元测试是否完全执行了私有功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T03:28:22.847

是的你应该。它被称为白盒测试，这意味着您必须对程序的内部有很多了解才能正确测试它。

我将创建调用私有函数进行测试的公共“存根”。#ifdef 存根，以便您可以在测试完成时将它们编译出来。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T17:41:16.447

您可能会发现编写测试程序很有成效。在测试程序中，创建一个以要测试的类为基础的类。

向您的新类添加方法，以测试在公共接口上不可见的功能。有你的简单测试程序，调用这些方法来验证你关心的功能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-15T16:28:37.583

如果您的类正在执行复杂的内部计算，那么实用程序类甚至外部函数可能是打破计算的最佳选择。但如果对象具有复杂的内部结构，则该对象应具有一致性检查功能。即，如果对象代表一棵专门的树，则该类应该具有检查该树是否仍然正确的方法。诸如树深度之类的附加功能通常对类的用户有用。其中一些函数可以在#ifdef DEBUG 或类似结构中声明，以限制嵌入式应用程序的运行时间空间。从封装的角度来看，使用仅在设置 DEBUG 时编译的内部函数要好得多。你没有打破封装。此外，

# winforms - 是否可以在不使用 ImageList 的情况下将图像添加到树视图节点？

> ID：539885
> 
> 赞同：4
> 
> 时间：2009-02-12T03:26:33.723
> 
> 标签：winforms, treeview, c#-2.0

（使用 WinForms 和 C#。-> .Net 2.0）

我正在根据表中的数据将节点添加到 TreeView。除了出现在节点上的标题外，该数据还包含位图。

我想使用表格中的位图作为 TreeViewNode 上的图标，而不是来自预先存在的 ImageList 的图标。（通常您在图像列表中指定图像的 Key 或 Index 来设置节点的图像。）

这是可能的还是我需要将位图从我的数据添加到 ImageList（在运行时），然后使用该 ImageList 在节点上填充图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T03:41:30.617

我认为你有两个选择。您可以按照您的建议从数据中填充一个`ImageList`，或者您可以自己将图像绘制到控件上（使用 Paint 事件）。

# components - .NET Datamatrix 条码组件？

> ID：539898
> 
> 赞同：2
> 
> 时间：2009-02-12T03:30:34.543
> 
> 标签：components, barcode

任何人都可以推荐一个可以创建和读取数据矩阵条形码的 .NET 组件吗？我将在一个项目中使用条形码，该项目将发送和接收传真封面上的条形码。我在那里找到了一些竞争者，但想知道是否有人有好的经验或建议。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T08:52:24.677

我正在使用 datamatrix.net 它对我来说效果很好。

[http://sourceforge.net/projects/datamatrixnet/](http://sourceforge.net/projects/datamatrixnet/)

[http://datamatrixnet.sourceforge.net/](http://datamatrixnet.sourceforge.net/)

如果您或任何人知道 .net 的其他库，请告诉我。

# python - 自定义 django 小部件 - decompress() arg 未填充

> ID：539899
> 
> 赞同：3
> 
> 时间：2009-02-12T03:30:40.127
> 
> 标签：python, django, forms, widget, field

作为一个练习，我正在尝试为 24 小时制创建一个自定义 django 小部件。小部件将是一个 MultiWidget - 每个字段的选择框。

我正在尝试在线关注文档（有点稀疏）并查看 Pro Django 书籍，但我似乎无法弄清楚。我在正确的轨道上吗？我可以保存表单中的数据，但是当我预填充表单时，表单没有以前的值。

似乎问题在于 decompress() 方法的“值”参数始终为空，所以我没有什么要解释的。

```
from django.forms import widgets

import datetime

class MilitaryTimeWidget(widgets.MultiWidget):
    """
    A widget that displays 24 hours time selection.
    """
    def __init__(self, attrs=None):
        hours = [ (i, "%02d" %(i)) for i in range(0, 24) ]
        minutes = [ (i, "%02d" %(i)) for i in range(0, 60) ]
        _widgets = (
            widgets.Select(attrs=attrs, choices=hours), 
            widgets.Select(attrs=attrs, choices=minutes),
            )
        super(MilitaryTimeWidget, self).__init__(_widgets, attrs)

    def decompress(self, value):
        print "******** %s" %value
        if value:
            return [int(value.hour), int(value.minute)]
        return [None, None]

    def value_from_datadict(self, data, files, name):
        hour = data.get("%s_0" %name, None)
        minute = data.get("%s_1" %name, None)
        if hour and minute:
            hour = int(hour)
            minute = int(minute)
            return datetime.time(hour=hour, minute=minute)
        return None 
```

在我的表单中，我将小部件称为：

```
arrival_time = forms.TimeField(label="Arrival Time", required=False, widget=MilitaryTimeWidget()) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T18:26:20.473

请注意[MultiWidget 文档字符串中的这一行](http://code.djangoproject.com/browser/django/trunk/django/forms/widgets.py#L582)：

> 您可能希望将此类与 MultiValueField 一起使用。

这就是你问题的根源。您也许可以使仅使用单个小部件的方法起作用（Marty 说在*Pro Django*中可以，但我从未尝试过，而且我认为它可能需要更多工作），但在这种情况下，您的小部件不应该t 是 MultiWidget 的子类。

您需要做的（如果您想遵循 MultiWidget/MultiValueField 路径）是：

*   删除你的 value_from_datadict 方法
*   [使用 compress() 方法的定义定义MultiValueField](http://code.djangoproject.com/browser/django/trunk/django/forms/fields.py#L740)的子类，该方法执行您当前在 value_from_datadict() 中执行的任务（将数字列表转换为 datetime.time 对象）
*   将您的小部件设置为自定义表单字段的默认值（使用小部件类属性）
*   要么创建一个自定义模型字段，该字段从其 formfield() 方法返回您的自定义表单字段，要么手动使用您的自定义表单字段作为 ModelForm 中的字段覆盖。

然后一切都会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T10:00:40.563

我无法重现该问题：

```
>>> class MyForm(forms.Form):
...     t = forms.TimeField(widget=MilitaryTimeWidget())
...
>>> print MyForm(data={'t_0': '13', 't_1': '34'})
******** 13:34:00
<tr><th><label for="id_t_0">T:</label></th><td><select name="t_0" id="id_t_0">
<option value="0">00</option>
[...]
<option value="13" selected="selected">13</option>
[...]
<option value="23">23</option>
</select><select name="t_1" id="id_t_1">
<option value="0">00</option>
[...]
<option value="34" selected="selected">34</option>
[...]
<option value="59">59</option>
</select></td></tr> 
```

检查您的 request.POST 是否正确。

作为旁注，您确定此小部件具有良好的可用性吗？四次鼠标点击和分钟组合框的可能滚动......

# date - 谷歌书签导出日期格式？

> ID：539900
> 
> 赞同：15
> 
> 时间：2009-02-12T03:31:06.770
> 
> 标签：date, formatting, export, bookmarks

我一直在努力从谷歌书签生成的导出文件中解析出书签。此文件包含以下日期属性：

ADD_DATE="1231721701079000"

ADD_DATE="1227217588219000"

这些不是标准的 Unix 风格的时间戳。有人可以在这里指出我正确的方向吗？如果您真的想帮助我，我将使用 c# 解析它们。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-09-08T14:45:46.320

Chrome 使用 Windows 时间格式的修改形式（“<a href="http://blogs.msdn.com/b/oldnewthing/archive/2009/03/06/9461176.aspx" rel="noreferrer">Windows epoch”) 的时间戳，包括`Bookmarks`文件和历史文件。Windows 时间格式是自 1601 年 1 月 1 日以来的 100ns-es 数。Chrome 格式是自同一日期以来的微秒数，因此是 1/10。

要将 Chrome 时间戳与 Unix 纪元相互转换，您必须转换为秒并补偿两个基本日期时间 (11644473600) 之间的差异。

以下是 Unix、JavaScript（以毫秒为单位的 Unix）、Windows 和 Chrome 时间戳的转换公式（您可以重新排列 +/× 和 -/÷，但会损失一点精度）：

```
u :  Unix       timestamp    eg: 1378615325
j :  JavaScript timestamp    eg: 1378615325177
c :  Chrome     timestamp    eg: 13902597987770000
w :  Windows    timestamp    eg: 139025979877700000

u =  (j / 1000)
u =  (c - 116444736000000)   / 10000000
u =  (w - 1164447360000000)  / 100000000

j =  (u * 1000)
j =  (c - 116444736000000)   / 10000
j =  (w - 1164447360000000)  / 100000

c =  (u * 10000000)          + 116444736000000
c =  (j * 10000)             + 116444736000000
c =  (w / 10)

w =  (u * 100000000)         + 1164447360000000
w =  (j * 100000)            + 1164447360000000
w =  (c * 10) 
```

请注意，这些数字非常大，因此您需要使用 64 位数字，或者像使用 PHP 的 BC-math 模块一样将它们作为字符串处理。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-11-25T16:35:13.410

在 Javascript 中，代码将如下所示

```
function chromeDtToDate(st_dt) {
   var microseconds = parseInt(st_dt, 10);
   var millis = microseconds / 1000;
   var past = new Date(1601, 0, 1).getTime();
   return new Date(past + millis);
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-12T03:40:31.727

1231721701079000 看起来很像自 1970 年 1 月 1 日以来的时间，以微秒为单位。

```
perl -wle 'print scalar gmtime(1231721701079000/1_000_000)'
Mon Jan 12 00:55:01 2009 
```

我会在已知时间做一些书签并尝试确认。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-10T01:55:36.550

尤里卡！我记得在某个网站上读过 ADD_DATE 的含义，但直到今天，我再也找不到它了。

> [http://MSDN.Microsoft.com/en-us/library/aa753582(v=vs.85).aspx](http://MSDN.Microsoft.com/en-us/library/aa753582%28v=vs.85%29.aspx)

在“出口和进口”标题之前将此解释作为“注释”提供：

> “在整个文件[-]格式定义中，{date} 是一个十进制整数，表示自 1970 年 1 月 1 日午夜以来经过的秒数。”</p>

在此之前，展示了 {date} 的示例：

> <DT><H3 FOLDED ADD_DATE="{date}">{title}</H3> ...</p>

和

> <DT><A HREF="{url}" ADD_DATE="{date}" LAST_VISIT="{date}" LAST_MODIFIED="{date}">{title}</A> …</p>

有一天，我会编写一个 VBA 宏来将这些转换为可识别的日期，*但不是今天！*

如果其他人先写了转换脚本，请分享。谢谢。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-22T04:12:46.943

从最新的 Chrome 版本 73.0.3683.86（官方版本）（64 位）开始：

*   当我导出书签时，我得到了一个像“bookmarks_3_22_19.html”这样的 html 文件。
*   每个项目都有一个包含日期字符串的“add_date”字段。像这样：

```
<a href="https://stackoverflow.com" add_date="1553220774" icon="">Stack Overflow</a> 
```

*   这个时间戳实际上是自 1970 年 1 月 1 日以来的**秒**（而不是微秒）。所以我们可以使用 Javascript 解析它，如下面的代码：

```
function ChromeTimeToDate(timestamp) {
   var seconds = parseInt(timestamp, 10);
   var dt = new Date();
   dt.setTime(seconds * 1000);
   return dt;
} 
```

*   对于上面的示例链接，我们可以调用`ChromeTimeToDate('1553220774')`获取日期。

```
ChromeTimeToDate('1553220774')
12:09:03.263 Fri Mar 22 2019 10:12:54 GMT+0800 (Australian Western Standard Time) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T03:38:18.890

最初看它，看起来如果你砍掉最后 6 位数字，你会使用[在线转换器得到一个合理的 Unix 日期](http://www.onlineconversion.com/unix_time.htm)

1231721701 = 2009 年 1 月 12 日星期一 00:55:01 GMT

1227217588 = 2008 年 11 月 20 日星期四 21:46:28 GMT

额外的 6 位数字可能与格式相关或某种扩展属性。

如果确实如此，则有一些用于[转换 Unix Timestamps](http://codeclimber.net.nz/archive/2007/07/10/Convert-a-Unix-timestamp-to-a-.NET-DateTime.aspx)的示例代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-01T11:27:42.740

在此处查找代码示例：[http ://www.epochconverter.com/#code](http://www.epochconverter.com/#code)

```
// my groovy (java) code finally came out as:

def convertDate(def epoch)

{

    long dv = epoch / 1000; // divide by 1,000 to avoid milliseconds

    String dt = new java.text.SimpleDateFormat("dd/MMM/yyyy HH:mm:ss").format(new java.util.Date (dv));

   // to get epoch date: 

   //long epoch = new java.text.SimpleDateFormat("MM/dd/yyyy HH:mm:ss").parse("01/01/1970 01:00:00").getTime() * 1000;

    return dt;

} // end of def 
```

所以导出为 json 的 Firefox 书签日期给了我：

```
json.lastModified :1366313580447014

convert from epoch date:18/Apr/2013 21:33:00 
```

从 ：

```
println "convert from epoch date:"+convertDate(json.lastModified) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-18T14:40:16.797

```
function ConvertToDateTime(srcChromeBookmarkDate) {
    //Hp --> The base date which google chrome considers while adding bookmarks
    var baseDate = new Date(1601, 0, 1);

    //Hp --> Total number of seconds in a day.
    var totalSecondsPerDay = 86400;

    //Hp --> Read total number of days and seconds from source chrome bookmark date.
    var quotient = Math.floor(srcChromeBookmarkDate / 1000000);
    var totalNoOfDays = Math.floor(quotient / totalSecondsPerDay);
    var totalNoOfSeconds = quotient % totalSecondsPerDay;

    //Hp --> Add total number of days to base google chrome date.
    var targetDate =  new Date(baseDate.setDate(baseDate.getDate() + totalNoOfDays));

    //Hp --> Add total number of seconds to target date.
    return new Date(targetDate.setSeconds(targetDate.getSeconds() + totalNoOfSeconds));
}

var myDate = ConvertToDateTime(13236951113528894);
var alert(myDate);
//Thu Jun 18 2020 10:51:53 GMT+0100 (Irish Standard Time) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-30T21:53:34.647

```
#Python program

import time

d = 1630352263   #for example put here, if (ADD_DATE="1630352263")

print(time.ctime(d))  #Mon Aug 30 22:37:43 2021 - you will see 
```

# asp.net - Flex、ASP.NET 和 SOAP 或 REST Web 服务的最佳身份验证机制？

> ID：539906
> 
> 赞同：2
> 
> 时间：2009-02-12T03:36:21.720
> 
> 标签：asp.net, apache-flex, web-services, authentication, authorization

我正在构建一个用 ASP.NET 和 Flex 编写的基于 Web 的应用程序。我最大的挑战之一是以灵活和可维护的方式实现应用程序的安全性。当涉及不同的技术时，这一挑战变得更加复杂。我将尝试在下面描述我所拥有的。

该网站的布局如下：

*   /mydomain.com/
    *   登录.aspx
    *   Default.aspx *（宿主 flex [.swf] 应用程序）*
    *   /行政/
        *   添加用户.aspx
        *   添加角色.aspx
        *   添加权限.aspx
        *   ETC...
    *   /服务/
        *   安全服务.asmx
        *   地图服务.asmx
        *   照片服务.asmx
        *   ETC...

我目前正在使用表单身份验证来保护网站上的资源。不在 /Services/ 文件夹中的所有页面/资源都需要经过身份验证的用户，如果尚未经过身份验证，它们将被重定向到 Login.aspx。.asmx 页面允许未经身份验证的用户。为了保护这些资源，我在 SOAP 方法中抛出了一个异常。这避免了我所知道的任何 SOAP Web 服务客户端都不支持的 SOAP Web 服务重定向页面。最后，SecurityService.asmx 包含一个 Login 方法，允许 Flex 应用程序登录而无需重定向到 Login.aspx 页面，如果 cookie 因任何原因过期。因为建立的 cookie 与任何请求一起发送到服务器，包括来自 Flex 应用程序的请求，所以这似乎工作得很好。

然而，这仍然是一种保护 Web 服务的糟糕方法。我觉得我正在将表单身份验证用于它不打算用于的东西。具体来说，我担心：

*   当服务与核心网站分离时，此模型将不起作用。这是一个新发现的要求，我相信如果没有更多的修改和技巧，Forms Authentication 将无法正常工作（如果有的话）。
*   Flex 以外的客户可能需要访问服务。其中一些客户端甚至可能无法使用 cookie。如果是这样，该模型立即分崩离析。这不是即时要求，但众所周知，这是长期目标之一。
*   我们最终会（希望早点而不是晚点）转向基于 REST 的架构（相对于 SOAP），因此任何解决方案都需要适用于 SOAP 和 REST。

所以，我的问题是。

**保护基于 ASP.NET、Flex 和 SOAP 或 REST Web 服务构建的应用程序的最佳身份验证和授权机制是什么？**

*注意：我正在积极研究 OAuth；但是，我很难找到完整的例子来学习。此外，我需要能够根据用户拥有的权限过滤给定用户返回的数据，OAuth 似乎从令牌中删除了用户的身份。因此，我不确定 OAuth 如何应用于细粒度的安全模型。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T17:06:49.323

其他人可能不同意，但实际上我认为以您现在的方式处理它并没有什么大问题。这可能是我处理自己的方式，至少一开始是这样。一种或另一种方式，即使是在路上，您可能希望让 Flex 应用程序了解会话的身份验证状态，所以如果这意味着直接检查 ASP.NET 会话令牌，或者您在您设置时设置的其他 cookie设置那个，这似乎是一种很好且可靠的方法。

我确实明白你对服务重定向的意思，但即便如此，使用表单身份验证，它并不是专门处理重定向的服务，而是 ASP.NET 应用程序本身。稍后，如果您需要使用不同的身份验证方案，您可以考虑该方案的具体实现注意事项。除非您通常担心使用表单身份验证，否则可能没有必要仅仅因为 Flex 客户端和 Web 服务而使您的方法复杂化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-08T16:46:04.297

我承认我很少使用 Web 服务，但是需要访问密钥作为soap 标头参数呢？任何可以与soap web 服务通信的客户端应用程序都可能有一个低级别的API 来修改soap 请求，并且使用访问密钥可以（理论上）限制服务的使用。谷歌、亚马逊和其他几家供应商在他们的网络服务中使用这种类型的身份验证，而且看起来效果很好。

[这篇文章](http://msdn.microsoft.com/en-us/library/9z52by6a.aspx)似乎是一个不错的起点……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:49:18.340

我认为最好有独立的身份验证系统——即使用户和后端的身份验证令牌之间存在关系。它们是不同的野兽，具有不同的能力和要求。

对 flex 部分使用基于正常形式的身份验证。那很好。

对于 Web 服务，您可以创建一个登录方法，该方法返回一些身份验证令牌，供后续任务执行。或者向您的 Web 服务添加一些字段（在标题中或作为参数发布）以每次都使用用户名/密码组合进行身份验证。

附注：我不会依赖肥皂异常来处理身份验证问题。但是，如果您通过 WS 请求发送身份验证令牌或用户/通行证，则无需担心重定向。

编辑：回复：评论-理想情况下有。有满足这些需求的产品（Tivoli 访问管理器），但它们很昂贵。

我提出这个建议是因为它减轻了允许访问替代客户端的痛苦，并且只要您正确设计了服务，它就是无状态的。它还使您可以更精细地控制事物服务端的数据级别访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T01:20:27.997

如果您正在使用或可以使用 WCF，CodePlex 上发布的[WCF 安全指南可能会对您有所帮助。](http://www.codeplex.com/WCFSecurityGuide/Release/ProjectReleases.aspx?ReleaseId=15892)

还有[微软的 Web Services Enhancements (WSE) 3.0](http://msdn.microsoft.com/en-us/library/ms977317.aspx)，我相信它实现了一些 WS-* 安全规范。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T01:50:52.230

如果您将服务移动到另一个地方，那么如果两个 Web 应用程序在 web.config 中具有相同的 machineKey，则可以重新使用标准的 ASP.net 身份验证 cookie。

据我所知，FLEX 将尊重 asp.net 身份验证 cookie，因为它将通过浏览器发出 http 请求，浏览器将像普通 http 请求一样传递 http cookie（包括 asp.net 身份验证票）。

您是否尝试过使用普通的 asp.net 身份验证来保护您的网站和服务？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-19T07:39:29.530

请参阅[Web 服务身份验证 - 最佳实践？](https://stackoverflow.com/questions/162376/web-services-authentication-best-practices)

[戴夫·邓金](https://stackoverflow.com/questions/162376/web-services-authentication-best-practices/189585#189585)写道：

> 在各种平台上处理它的最简单方法是使用 HTTP 基本身份验证和 HTTPS 作为传输层。如果您的需求超出了简单的用户名/密码，WS-Security 会很好，但平台之间的支持会有很大差异。每个体面的 SOAP 实现都支持 HTTP 身份验证。

和我[的 .NET 3.5/VS 2008 上 ASP.NET Web 服务的自定义 HTTP 基本身份验证](https://stackoverflow.com/questions/490627/custom-http-basic-authentication-for-asp-net-web-services-on-net-3-5-vs-2008)。

# flash - 使 Flash 电影自动加载

> ID：539907
> 
> 赞同：0
> 
> 时间：2009-02-12T03:36:36.807
> 
> 标签：flash, animation, embed, autoload

我想在我的页面上嵌入一个 Flash 电影，但我需要它从一开始就自动加载，而不仅仅是当我通过页面到达它时。我的意思是，我的页面很长，而闪光灯大约在中间。它播放有声音的动画，我希望它自己启动，而不仅仅是当我向下滚动到它时。这可能吗 ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T03:55:04.140

Flash 电影在加载到浏览器时立即开始播放（默认情况下）。只要确保您的`<object> / <embed>`标签没有将**play**属性设置为**false**并且您的 Flash 电影没有`stop()`on frame1 或阻止它播放的东西...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T04:26:01.930

我遇到过一些电影似乎无法始终自动播放的情况。我将这个快速的 javascript 函数拼凑在一起，我称之为 onload 以确保电影正在运行：

```
function LoadMovie(){
var movie = document.getElementById('flash_nav');
if(typeof movie.PercentLoaded() == "function")  //not every browser supports this so check first
 {
if(movie.PercentLoaded() < 100)
    {
        movie.LoadMovie(0, movie.data);    
    }
  }
 } 
```

# c# - C# 应用程序和非托管 C++ 应用程序之间的进程间通信

> ID：539908
> 
> 赞同：6
> 
> 时间：2009-02-12T03:36:45.340
> 
> 标签：c#, c++, ipc

我有两个 Windows 服务，第一个用 C# 编写，第二个用非托管 C++ 编写，我想知道如何进行双向进程间通信。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T15:37:04.263

如果进程间通信总是要在同一台机器上完成，那么命名管道是可行的方法，因为它们比其他选项更快。

但是，如果这种通信有可能在某个时刻跨越机器边界发生，那么请使用套接字方法。对于 C++，您需要 winsock2.h 头文件。在 C# 中，使用[`System.Net.Sockets`](http://msdn.microsoft.com/en-us/library/system.net.sockets.aspx)命名空间。

自从我完成非托管 C++ 以来已经有一段时间了，但我记得如果你在 C++ 端创建服务器然后[`TcpClient`](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.aspx)在 C# 端使用类，你将不得不编写更少的 C++ 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T03:44:24.227

套接字可能是你最好的选择。

使用套接字，您不必绑定到同一台机器上的两个程序。

此外，它可能是最便携的选项（见鬼，Windows 甚至有 select() 用于套接字）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T03:40:27.810

套接字和命名管道是托管和非托管环境中很好支持的两个选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T03:45:12.837

有很多方法可以做到这一点，但我认为最好的方法是使用 WCF 和 COM+。如果在 COM+ 中托管服务，则可以通过 .NET 服务中的 WCF 以及非托管代码中的 COM 接口访问它。

您可能需要查看 MSDN 文档的以下部分以开始使用：

将 WCF 服务与 COM+ 集成：http: [//msdn.microsoft.com/en-us/library/bb735856.aspx](http://msdn.microsoft.com/en-us/library/bb735856.aspx)

与 COM+ 应用程序集成概述：http: [//msdn.microsoft.com/en-us/library/ms734723.aspx](http://msdn.microsoft.com/en-us/library/ms734723.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T03:46:30.480

我会说套接字*和*消息传递系统。检查我们的[Google Protocol Buffers](http://code.google.com/p/protobuf/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T03:39:53.380

使用 DCOM/RPC 或命名管道 - 其他任何东西要么不安全，要么不安全，要么两者兼而有之。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T16:04:26.163

创建一个单例 COM 对象。维护此 COM 对象中的数据，C++ 和 C# 应用程序都可以读取这些数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-06T16:19:54.337

我会说 redis 将是任何类型的进程间通信的最佳解决方案

# ruby-on-rails - 会话没有通过域

> ID：539918
> 
> 赞同：1
> 
> 时间：2009-02-12T03:40:41.727
> 
> 标签：ruby-on-rails, session

在我的 Rails 应用程序中，当我在 www.site.com 地址登录时，我登录得很好。虽然没有登出，我去网站，[http](http://site.com) ://site.com 我登出，但如果我回去，仍然在 www.site.com 地址登录。

我在我的环境变量中找不到任何设置，关于如何在我的域上的所有域中保持这个会话的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T03:42:55.697

正确设置会话cookie；也就是说，针对 .site.com 和 site.com 而不仅仅是针对 www.site.com。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T02:19:21.400

当您为“site.com”设置会话 cookie 时，它​​将不同于“www.site.com”。您需要将“cookie_domain”指定为“.site.com”，这将设置 cookie 或所有子域。在 PHP 中，您可以使用[ini_set](http://us2.php.net/manual/en/function.ini-set.php)或[session_set_cookie_params](http://us2.php.net/manual/en/function.session-set-cookie-params.php)来设置[session.cookie_domain](http://us2.php.net/manual/en/session.configuration.php#ini.session.cookie-domain)。在 Rails 中，您可以在 enviroment.rb 中添加一个小脚本 - 例如：

`ActionController::Base.session_options[:session_domain] = '.site.com'`

（在这种情况下，您还可以根据生产/测试/开发环境中的域名进行一些切换）或尝试[其他一些配置选项](http://szeryf.wordpress.com/2008/01/21/cookie-handling-in-multi-domain-applications-in-ruby-on-rails/)。

这里比你想知道的[更多](http://www.quarkruby.com/2007/10/21/sessions-and-cookies-in-ruby-on-rails)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T14:28:19.833

您应该将 www.site.com 重定向到 site.com（或相反）。如果你不这样做，谷歌可能会认为这是两个不同的网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T00:07:16.030

在 Rails 2.3 中，这已更改为：

```
config.action_controller.session[:domain] = '.example.com' 
```

或者如果尚未创建会话变量

```
config.action_controller.session = {:domain => '.example.com'} 
```

请参阅[使用子域在 rails 2.3.2 应用程序中丢失会话](https://stackoverflow.com/questions/663893/losing-session-in-rails-2-3-2-app-using-subdomain/978716)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-12T03:43:51.843

因为他们别名 www。到 。; 你不能只是在前面加上www。到.?

# macos - 适用于 Mac OS X 的免费 OpenGL 加速的类似 GNUPlot 的工具？

> ID：539919
> 
> 赞同：4
> 
> 时间：2009-02-12T03:41:12.317
> 
> 标签：macos, opengl, gnuplot

我正在使用 GNUplot 绘制大量我想以 3D 形式可视化的数据 - 例如，使用 pm3d 选项。这是软件中的非常慢的渲染 - 是否有免费软件可以使用 OpenGL 或其他东西来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T03:47:28.510

[ROOT](http://root.cern.ch/)会这样做。

这种野兽是当今核和粒子物理学界使用的主要分析和可视化工具之一。它可以快速移动大量数据，并具有相当复杂的可视化工具集，并支持 OpenGL。您可以在编译的 c++ 代码中、在 cint 解释器中或使用 python 绑定来完成这项工作。

最大的缺点是您可能必须在准备开始之前阅读大量文档。

# php - 清理字符串以放置在 URL 中的最佳方法是什么，例如 SO 上的问题名称？

> ID：539920
> 
> 赞同：6
> 
> 时间：2009-02-12T03:41:14.250
> 
> 标签：php, url, mod-rewrite, slug

我正在寻找一个像 SO 用于问题链接的 URL 字符串。我不打算重写 url (mod_rewrite)。我正在寻找在页面上生成链接。

示例：问题名称是：

```
Is it better to use ob_get_contents() or $text .= ‘test’; 
```

URL最终是：

```
http://stackoverflow.com/questions/292068/is-it-better-to-use-obgetcontents-or-text-test 
```

我感兴趣的部分是：

```
is-it-better-to-use-obgetcontents-or-text-test 
```

所以基本上我希望清除任何不是字母数字的东西，同时仍然保持 URL 可读。我创建了以下内容，但我不确定它是否是最好的方法，或者它是否涵盖了所有可能性：

```
$str = urlencode(
    strtolower(
    str_replace('--', '-', 
    preg_replace(array('/[^a-z0-9 ]/i', '/[^a-z0-9]/i'), array('', '-'), 
    trim($urlPart))))); 
```

所以基本上：

1.  修剪
2.  替换任何非字母数字加上空格
3.  然后用破折号替换所有不是字母数字的
4.  用。。。来代替 -。
5.  `strtolower()`
6.  `urlencode()`- 可能不需要，但只是为了很好的衡量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T08:30:04.430

正如您已经指出的那样，在这种情况下不需要 urlencode()，trim() 也不需要。如果我理解正确，第 4 步是避免连续出现多个破折号，但不会阻止超过两个破折号。另一方面，连接两个单词的破折号（如“大规模”）将被您的解决方案删除，而它们似乎保留在 SO 上。

我不确定这真的是*最好*的方法，但这是我的建议：

```
$str = strtolower( 
  preg_replace( array('/[^a-z0-9\- ]/i', '/[ \-]+/'), array('', '-'), 
  $urlPart ) ); 
```

所以：

1.  删除任何既不是空格、破折号也不是字母数字的字符
2.  用单个破折号替换任何连续数量的空格或破折号
3.  strtolower()

# .net - 用于 Windows 的 SMTP / POP3 / IMAP 邮件服务器

> ID：539937
> 
> 赞同：0
> 
> 时间：2009-02-12T03:46:47.467
> 
> 标签：.net, sql-server, smtp

我正在为 Windows Server 寻找一个相对便宜（或免费）的 POP3 邮件服务器，它可以很好地扩展。与 SQL Server 兼容会很棒。如果它有一个 .net 类库来执行简单的功能，比如创建/删除新帐户、添加别名等，那就太好了。

任何想法将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T03:48:46.790

谷歌搜索出现了这个（它是免费软件）：

[http://www.hmailserver.com/](http://www.hmailserver.com/)

另请参阅其他主题：

[.NET 的 SMTP 和 IMAP 服务器库](https://stackoverflow.com/questions/249047/smtp-and-imap-server-library-for-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T04:04:34.007

此外，还有一个免费的“组合”包。使用免费的 VMWare Server、免费的 Ubuntu 和免费的 Zimbra 网络版。如果您需要，Zimbra 将包括 POP3、IMAP、日历、任务列表和完整的 Web 界面。

一个很棒的小包裹

[www.vmware.com](http://www.vmware.com) [www.ubuntu.com](http://www.ubuntu.com) [www.zimbra.com](http://www.zimbra.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T04:06:10.120

强烈推荐 MailEnable。www.mailenable.com

# c++ - 是否可以在 boost:regex 的前瞻中使用“重复”？

> ID：539939
> 
> 赞同：0
> 
> 时间：2009-02-12T03:47:54.127
> 
> 标签：c++, regex, boost, lookahead

我正在尝试在嵌套在块中的 C++ 代码中提取一些变量，
例如，如果我有

```
 DEL_TYPE_NONE,
            DEL_TYPE_DONE,
    DEL_TYPE_WAIT, 
```

我想匹配
**"DEL_TYPE_NONE"
"DEL_TYPE_DONE"
"DEL_TYPE_WAIT"** 

我做了这样的模式，
**std::string pat("(?<=^[ \\t]?)[A-Z0-9_]+(?=,$)");**

但是当编译器试图阅读我的模式时，我不断收到错误消息。
我不明白，但有问题**吗？在 \\t 之后标记**
如果我摆脱 ? 标记然后它编译并只找到**“DEL_TYPE_WAIT”**
为什么我不能在前瞻中使用重复？请帮帮我，我完全迷路了；（

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T05:39:05.700

我找到了答案。本[手册中](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html)**没有**

> 向后看
> 
> (?<=pattern) 消耗零个字符，仅当模式可以与当前位置之前的字符匹配时**（模式必须是固定长度）。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T03:52:33.210

仅基于 POSIX，我会说您的正则表达式是“DEL_TYPE_([ND]ONE|WAIT)”

这只是基于您上面列出的内容。我会说实际的问题是你双重逃避 t; 你可能应该做 [ \t\s]* 因为可能不只是零或一个制表符/空格。

# .net - .NET 如何使用 IO 线程或 IO 完成端口？

> ID：539940
> 
> 赞同：33
> 
> 时间：2009-02-12T03:48:31.877
> 
> 标签：.net, performance, concurrency

我们有一个 .NET 应用程序，它对各种 Web 服务进行多次并发调用，收集它们的响应，然后对这些响应进行一些计算。为了获得额外的性能，我一直在研究通过使用 IO 完成端口来使用 .NET 的 IO 线程的方法的使用。我已经阅读了几个资源，包括 Joe Duffy 最近的《Windows 上的并发编程》一书，虽然我“了解”了它们的用处，但我对它们在 .NET 中的行为有点不清楚，我正在寻找一个简明的解释。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-12T04:05:22.710

如果您已经在使用异步方法，您可能不必做任何事情。根据您用于调用 Web 服务的技术，最终，它将下拉到 Win32 API 以进行调用以从网络获取字节，为此，它将使用 I/O 完成用于处理异步调用的端口。

I/O 完成端口背后的基本前提是，在等待 I/O 操作时，有一个线程池一直在等待 I/O 操作完成（假设您注册使用 I/O 完成端口）。当您注册的操作完成时，来自 I/O 完成端口线程池的线程用于处理回调。

当然，在调用 I/O 完成端口之后，你的线程可以继续做更多的工作，或者终止，你可以选择。

以下内容应该有助于更多地描述它：

I/O 完成端口：

[http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365198(VS.85).aspx)

内部 I/O 完成端口（WayBack 机器）：

[https://web.archive.org/web/20101101112358/http://doc.sch130.nsc.ru/www.sysinternals.com/ntw2k/info/comport.shtml](https://web.archive.org/web/20101101112358/http://doc.sch130.nsc.ru/www.sysinternals.com/ntw2k/info/comport.shtml)

# sql - 使用从另一列计算的值更新多行

> ID：539942
> 
> 赞同：3
> 
> 时间：2009-02-12T03:49:29.583
> 
> 标签：sql, mysql

我有一个表格，其中一行如下所示：

（**20091231** 48498429，'...'，'...'）

第一部分，id，是一个时间戳，后跟一个随机数。（需要与系统中的其他部分配合使用） 数据已经存在于表中。

我想创建一个列、时间戳，并仅提取日期 (20091231) 并使用时间戳更新所有行。

1.  如何使用 SQL 对所有行执行此操作？（即用某种功能更新它们？）
2.  我应该为该列分配什么样的默认值以确保将来的插入正确提取日期？

**更新**- 请阅读 bobince 在 Jonathan Sampson 回答的第一个问题中关于我们如何得到答案的评论。这是有效的最终查询：

```
UPDATE table SET rdate=substring(convert(rid,char(20)),1,8); 
```

问题是我使用`substring`的是 as`substring( str, 0, 8 )`而它应该是`substring( str, 1, 8 )`. 我想我们都习惯了 0 作为起始位置！[有关子字符串](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_substring "substring @ mysql")的更多信息

相关：[mysql中的多个更新](https://stackoverflow.com/questions/3432/multiple-updates-in-mysql "我的mysql中的多个更新")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T03:53:43.690

```
SELECT SUBSTRING(colDate,0,8) as 'date' 
FROM someTable 
```

还是我弄错了？

```
UPDATE someTable
SET newDateField = SUBSTRING(colDate,0,8) 
```

也可能会起作用。未经测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T03:56:20.940

在您的更新中使用子选择（未经测试，我使用 Firebird 太久了，所以有人在这里检查我）。

```
UPDATE MyTable AS TUpdate
SET MyNewField = (SELECT SUBSTRING(TSub.MyDateColumn,0,8) 
                  FROM MyTable AS TSub 
                  WHERE TSub.MyID = TUpdate.MyID); 
```

至于将来正确提取日期的插入，您将不得不在插入时创建一个触发器以提取该记录的日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:58:36.347

需要使用子选择。

UPDATE someTable set timestamp = (SELECT SUBSTRING(colData, 0, 8) FROM someOriginalTable);

**编辑**lc 让我领先了几秒钟！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T04:22:37.443

```
UPDATE tbl
SET
   newDateField = SUBSTRING(CAST(sourceCol AS varchar), 0, 8) 
```

# .net - WPF：如何从一个停靠的 UserControl 转换到另一个？

> ID：539944
> 
> 赞同：1
> 
> 时间：2009-02-12T03:50:14.993
> 
> 标签：.net, wpf, layout, animation

我有一个带有 DockPanel 的基本 WPF 表单，有一个菜单栏、一个状态栏和一个用户控件。像这样：

```
<DockPanel>
  <Menu DockPanel.Dock="Top">
    ...
  </Menu>
  <StatusBar DockPanel.Dock="Bottom">
    ...
  </StatusBar>
  <UserControls:MyUserControl />
<DockPanel> 
```

**我的问题是：**基于一个事件，我想将 UserControl 转换为第二个用户控件。

它们都在 XAML 中定义没有问题（因为我知道另一个控件是什么），但我无法确定我需要的容器类型，这将允许我使用动画（理想情况下是就像一个消失在左边，另一个从右边出现）。UserControls 应该自动增长以用完所有可用空间。

有任何想法吗？

**编辑：**这是我在一般意义上要做的事情。也许有人可以提出更好的方法。

我有一个包含客户端列表的 ListView/GridView。当用户双击客户端时，我想用显示该客户端详细信息的 UserControl 替换客户端列表（并进一步允许它们交互）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T04:06:58.620

难道你不能把它们都放在那里，但它们的可见性之一设置为折叠，然后在事件触发时，切换两者？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T02:34:29.490

找到了一种方法。我在 UserControl 之前的位置放置了一个网格，然后将两个 UserControls 放在其中。将一个设置为可见，一个设置为折叠。然后在事件触发时，我可以播放我的动画（除其他外）交换可见性。

所以在我的窗口我有

```
<Grid>
    <UserControls:Control1 x:Name="Control1" />
    <UserControls:Control2 x:Name="Control2" />
</Grid> 
```

然后在窗口资源中这个

```
<Storyboard x:Key="ShowControl2">
    <ObjectAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Control1" Storyboard.TargetProperty="(UIElement.Visibility)">
        <DiscreteObjectKeyFrame KeyTime="00:00:00.2000000" Value="{x:Static Visibility.Collapsed}"/>
    </ObjectAnimationUsingKeyFrames>
    <ObjectAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Control2" Storyboard.TargetProperty="(UIElement.Visibility)">
        <DiscreteObjectKeyFrame KeyTime="00:00:00" Value="{x:Static Visibility.Visible}"/>
    </ObjectAnimationUsingKeyFrames>
    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Control1" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)">
        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
    </DoubleAnimationUsingKeyFrames>
    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Control2" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)">
        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
    </DoubleAnimationUsingKeyFrames>
</Storyboard> 
```

然后在我想隐藏控件 1 并显示控件 2 的代码中，我有这个：

```
Storyboard showControl2Animation = (Storyboard)FindResource("ShowControl2");
showControl2Animation .Begin();
control2.Focus(); 
```

# delphi - 如何使用 PostMessage 发送 WM_HOTKEY？

> ID：539945
> 
> 赞同：0
> 
> 时间：2009-02-12T03:50:46.287
> 
> 标签：delphi, hotkeys, postmessage

我想使用全局桌面 HotShortCut 发送 WM_HOTKEY 以被其他应用程序捕获。

预期的键是 CTRL + F10

这是我发现触发 WM_HOTKEY 捕获的唯一方法：

```
procedure TfmMain.ButtonTalkClick(Sender: TObject);
var
  Article: TArticleBase;
  Msg: TMessage;
begin
  Article:= GetSelectedArticle;
  if Article <> nil then
  begin
    Clipboard.AsText:= Article.SelectedText;
    Msg.LParamLo:= MOD_CONTROL;
    Msg.LParamHi:= VK_CONTROL or VK_F10;
    PostMessage(HWND_BROADCAST, WM_HOTKEY, 0, Msg.LParam);
  end;
end; 
```

如果我更改 Msg.LParamLo 或 Msg.LParamHi 的任何值，WM_HOTKEY 不会被其他应用程序触发。但是使用这种方式，在消息 WM_HOTKEY 被 Method 捕获之前：

```
procedure ManageHotKeyMsg(var Msg: TMessage); message WM_HOTKEY; 
```

执行“Windows 执行对话框”（快捷键“Windows 键”+R）

如何正确传递 Msg.LParamLo 和 Msg.LParamHi，以确保我发送 WM_HOTKEY +“CTRL + F10”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T04:18:32.650

使用[PostKeyEx32](http://www.delphitricks.com/source-code/windows/simulate_the_pressing_of_keyboard_keys.html)完成。

```
procedure TfmMain.ButtonTalkClick(Sender: TObject);
var
  Article: TArticleBase;
begin
  Article:= GetSelectedArticle;
  if Article <> nil then
  begin
    Clipboard.AsText:= Article.SelectedText;
    PostKeyEx32(VK_F10, [ssCtrl], False);
  end;
end; 
```

现在我的 Xananews 构建可以语音：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T04:05:22.150

雷蒙德说你做错了：

[http://blogs.msdn.com/oldnewthing/archive/2005/05/30/423202.aspx](http://blogs.msdn.com/oldnewthing/archive/2005/05/30/423202.aspx)

为什么不直接使用某种标准的 IPC 机制与其他应用程序对话？

# php - 关于php和mysql哈希表的问题

> ID：539960
> 
> 赞同：0
> 
> 时间：2009-02-12T04:00:09.277
> 
> 标签：php, mysql, hash, hashtable

我是一个新的 php 和 mysql 程序员。我正在处理大量数据，并且将来它会缓慢增长，因此我正在使用哈希表。我有几个问题：

1.  mysql是否有内置函数的哈希表？如果是，如何使用它？

2.  经过几天对哈希表的研究。我简要地知道什么是哈希表，但我就是不明白如何开始创建一个。我在互联网上看到了很多哈希表代码。他们中的大多数，在第一步中创建了一个哈希表类。这是否意味着，他们将哈希表值存储在临时表中，而不是插入到 mysql 数据库中？

对于问题 3,4 和 5，示例场景：用户可以收集网站中的物品。我想使用哈希表来插入和检索用户收集的项目。

3.  [重要] 可能的mysql数据库结构是什么样的？

    例如，创建项目和用户表

    在 items 表中有：item_id、item_name 和 item_hash_value

    在 users 表中有：user_id、username、item_name、item_hash_value

    我不确定用户表是否正确？

4.  【重要】php和mysql创建hash表的步骤是什么？（如果有任何示例代码会很棒:)）

5.  [重要] 如何从哈希表中插入和检索数据？我说的是 php 和 mysql，所以我希望答案可以是：“你可以使用 mysql 查询，即 SELECT * from blabla ...”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T16:40:29.417

（对不起斜体，下划线可以触发它们，但我找不到在段落中间禁用它的好方法。忽略斜体，我不是故意把它们放在那里）

您无需担心在 MySQL 中使用哈希表。如果您打算在对它们进行操作时在内存中拥有大量项目，则哈希表是一种很好的数据结构，因为它可以比简单的列表更快地找到事物。

但在数据库级别，您无需担心哈希表。弄清楚如何最好地保存和访问记录是 MySQL 的工作，所以只要你给它正确的信息，它就会很高兴。

## 数据库结构

```
items table would be: item_id, item_name
Primary key is item_id

users table would be: user_id, username
Primary key is user_id

user_items table would be: user_id, item_id
Primary key is the combination of user_id and item_id
Index on item_id 
```

每个项目在项目表中都有一个（并且只有一个）条目。每个用户在 users 表中获得一个（并且只有一个）条目。当用户选择一个项目时，它会进入用户项目表。例子：

```
Users:

1 | Bob
2 | Alice
3 | Robert

Items

1 | Headphones
2 | Computer
3 | Beanie Baby 
```

因此，如果 Bob 选择了耳机，而 Robert 选择了计算机和 beanie baby，那么 user_items 表将如下所示：

```
User_items (user_id, item_id)

1 | 1    (This shows Bob (user 1) selected headphones (item 1))
3 | 2    (This shows Robert (user 3) selected a computer (item 2))
3 | 3    (This shows Robert (user 3) selected a beanie baby (item 3)) 
```

由于 users 和 items 表上的 user_id 和 item_id 是主键，MySQL 将让您非常快速地访问它们，就像 hashmap 一样。在 user_items 表中，主键中同时包含 user_id 和 item_id 意味着您不会有重复项，并且您应该能够快速访问（item_id 上的索引不会受到伤害）。

## 示例查询

使用此设置，很容易找到您想知道的内容。这里有些例子：

谁选择了项目 2？

```
SELECT users.user_id, users.user_name FROM users, user_items
WHERE users.user_id = user_items.user_id AND user_items.item_id = 2 
```

罗伯特选择了多少东西？

```
SELECT COUNT(user_items.item_id) FROM user_items, users
WHERE users.user_id = user_items.user_id AND users.user_name = 'Robert' 
```

我想要每个用户的列表以及他们选择的内容，按用户名排序

```
SELECT user.user_name, item.item_name FROM users, items, user_items
WHERE users.user_id = user_items.user_id AND items.item_id = user_items.item_id
ORDER BY user_name, item_name 
```

网上有很多关于 SQL 的指南，比如[W3C 的教程](http://www.w3schools.com/sql/default.asp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T04:16:51.107

1) 哈希表确实存在于 MySQL 中，但用于保持表上键的内部跟踪。2) 哈希表通过散列数据单元来创建许多不同的键，这些键通过这些键分隔数据，从而更容易搜索。哈希表用于查找应该用于显示正确列表以进行搜索的键。

例如，您有 100 个项目，连续搜索 100 个项目需要 10 秒。如果您知道它们可以按项目类型分开并将其分解为 25 件 T 恤、25 件时钟、一排手表和一排鞋子。然后当你需要找到一件 T 恤时，你只需搜索 25 件 T 恤，然后需要 2.5 秒。

3）不确定您的问题是什么意思，MySQL 数据库是一个包含数据库中所有行的二进制文件。4）与＃2一样，您需要决定您想要的密钥是什么。5）＃2你需要知道你的钥匙是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T16:43:48.987

如果您认为哈希表是存储数据的正确方式，您可能希望使用[CouchDB](http://couchdb.apache.org/docs/intro.html)等键值数据库而不是 MySQL。他们向您展示了如何[开始](http://wiki.apache.org/couchdb/Getting_started_with_PHP)使用 PHP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-06T10:20:31.283

> 我是一个新的 php 和 mysql 程序员。我正在处理大量数据，并且将来它会缓慢增长，因此我正在使用哈希表。

查看您的原始目的，改用“memcache”，它是最具可扩展性的解决方案，同时提供代码中的最小更改，您可以随着数据越来越大而扩展 memcache 服务器。

# windows - 以编程方式在用户桌面上创建 Web 快捷方式

> ID：539962
> 
> 赞同：5
> 
> 时间：2009-02-12T04:01:43.203
> 
> 标签：windows, shortcuts

有很多资源可用于以编程`.lnk`方式为桌面上的文件和程序创建类型快捷方式，但我想知道如何创建 Web URL 的快捷方式。

据我所知，Web URL 快捷方式是一个以文本文件结尾的文本文件`.URL`，其中包含类似 ini 的定义，例如：

```
[InternetShortcut]
URL=http://www.google.com/ 
```

但是，仅创建文件是不够的，您似乎还需要更改其元`URL`属性以包含相同的链接。

知道如何创建这些吗？

欢迎任何来自 .Net/Perl/batch 的示例代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T04:17:52.323

您可以为任何 URI 创建 .lnk 快捷方式，包括网址。只需创建快捷方式并将目标设为您的网址而不是文件位置。

有关如何以编程方式执行此操作，请参阅其他问题：

[在目录中创建应用程序快捷方式](https://stackoverflow.com/questions/234231/how-do-you-create-an-application-shortcut-lnk-file-in-c-or-net)

# silverlight - Silverlight - 默认渐变或效果 - 你如何关闭它？

> ID：539977
> 
> 赞同：0
> 
> 时间：2009-02-12T04:09:11.657
> 
> 标签：silverlight, silverlight-2.0, gradient

如果您在 Silverlight 和 WPF 中使用此代码，您会得到稍微不同的结果吗？

```
 <Button Name="SomeButton" Margin="10,15,180,12" Width="200" Height="50"
            VerticalAlignment="Top" Background="Black" Foreground="White">
   </Button> 
```

在 Silverlight 中，您不会获得纯黑色按钮。你会得到一个垂直的白到黑渐变。你如何强制它成为纯色？

作为后续，他们采用类似的方法来抵消 Vista 用浅蓝色悬停效果“装饰”按钮的恼人方式。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T04:10:56.193

这是因为WPF和Silverlight的按钮默认模板不同；在 Blend 中，转到“模板->编辑副本”以编辑按钮模板并吹走渐变。

# wcf - IIS 主机根目录上的 WCF 服务

> ID：539978
> 
> 赞同：2
> 
> 时间：2009-02-12T04:09:30.970
> 
> 标签：wcf, iis, service

如何在域的根目录上设置托管在 IIS 中的 WCF 服务？即[http://www.example.com](http://www.example.com)而不是[http://www.example.com/Service1.svc/](http://www.example.com/Service1.svc/)

我不知道如何摆脱服务文件名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T04:19:06.407

将 Service1.svc 添加到 IIS 中的默认文档名称，并将其移至列表顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T04:45:55.563

那是你真正想要的吗？如果有一天您可能希望从同一个域获得第二个服务，那么您会希望您没有以这种方式公开暴露根目录。

# scrum - Scrum：未完成的产品和冲刺速度

> ID：539980
> 
> 赞同：7
> 
> 时间：2009-02-12T04:10:11.577
> 
> 标签：scrum

假设产品 X 价值 10 个故事点。开发从 Sprint Y 开始，但没有及时完成。在计算 sprint Y 的速度时，您如何处理故事点？

你会：

一种。为 sprint Y 分配 0 故事点，为最终完成的 sprint 分配 10 点；

湾。确定剩余工作的故事点（假设为 3）并将差异分配给 sprint Y（在我们的示例中为 7）；或者

C。还有什么？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-12T04:20:20.257

取决于您是否关心“瞬时”或“平均”速度。就个人而言，我不会让它变得比必要的更复杂，只是将它添加到完成的 sprint 中。通过查看过去 3、6 和 12 个月内每个 sprint 完成的平均点数来计算您的平均速度。希望这些最终会收敛，并且您将对在一个 sprint 中可以完成多少工作有一个很好的了解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T04:38:04.287

为 Sprint Y 分配 0 分，在故事最终完成时分配 10 分。故事要么完成，要么没有完成。没有回旋的余地。您希望避免 50% 完成，否则您的团队可能会半途实施许多故事，而没有一个完全完成。

在一个 sprint 中不完成一个故事并在下一个 sprint 中完成它是完全可以的。但是，您不应该在 sprint 评审期间向产品负责人展示这个故事。

如果您有足够的故事用于给定的 sprint，那么故事是在这个 sprint 还是下一个 sprint 完成都没有关系。事情会平均。

向团队和利益相关者解释速度有助于估计发布时间，而不是衡量团队绩效的标准，这一点也很重要。

应该根据他们产生的最终结果来评判团队，而不是何时产生这些结果。

结合优先考虑的待办事项，您将创建高质量的软件，这意味着您的客户需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T04:41:50.160

这是 sprint 的想法之一，“完整性”是二元的，无论是否完成，随着时间的推移，团队将有更好的估计，这个问题将失去相关性

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T15:45:59.610

但...

下一个问题是你如何计算 Y 之后的 sprint 承诺。如果你过去的天气显示你的平均速度是 20 分。如果你把故事继续下去，那么你就得超过 10 分。但是，如果你认为故事只剩下 3 个点：你

A) 再拿 17 分来填补你估计的 20 分 B) 只多拿 10 分，因为故事最初估计是 10 分

我们试图做 A 时陷入了混乱。其他人怎么想？

[更新]

我发布了一个关于此的问题：

[在 Scrum 中继承故事点时计算 sprint 容量](https://stackoverflow.com/questions/626892/work-out-sprint-capacity-when-carrying-over-story-points-in-scrum)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-23T12:53:39.060

这里的情况并不令人满意，但目前我们估计未完成故事的剩余工作。如果它只有大约 20% 或更少，我们会留下故事和冲刺中的点。如果不止于此，我们会询问 PO 是否应该完成这个故事，如果是，那么我们将其移至新的 sprint。然而，由于几个原因，这并不令人满意。第一个大的或有风险的故事应该在冲刺开始时开始，这样可以避免未完成的情况。其次，我们得到了不准确（但可能更平滑）的速度估计，这在未来不太有用。第三，它并不严格，团队就像一个 2 岁的孩子，显示它有一个轻微的弱点，它想利用它。

最后，随着时间的推移，严格性越来越严格，团队在一定程度上找到了自己的立场，并学习了处理事情的最佳方法。我们的速度已经有了很大的变化——大多数团队对每个 sprint 都有一个关于哪些因素（假期、疾病等）影响每个 sprint 的评论......完全不好:(

# c# - 提取字符串的一部分

> ID：539983
> 
> 赞同：1
> 
> 时间：2009-02-12T04:12:13.740
> 
> 标签：c#

我有一个收藏。coll 有字符串：

```
Location="Theater=2, Name=regal, Area=Area1" 
```

等等。我必须从字符串中提取名称位。例如，在这里我必须提取文本'regal'

我正在努力解决这个问题：

集合.位置.???? （这里要添加什么）

哪种方法最简短、最精确？

[编辑]：如果我必须添加到 GroupBy 子句怎么办

Collection.GroupBy(????);

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T04:26:18.417

扩展保罗的回答：

```
var location = "Theater=2, Name=regal, Area=Area1";

var foo = location
    .Split(',')
    .Select(x => x.Split('='))
    .ToDictionary(x => x[0].Trim(), x => x[1]);

Console.WriteLine(foo["Name"]); 
```

这会将原始字符串填充到字典中以便于参考。同样，没有错误检查或任何东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T04:15:17.180

```
Location.Split(",").Select(x => x.Split("=")[1]) 
```

这是一种极其懒惰、完全没有错误处理的方法：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T04:17:37.690

快速而肮脏的方法是简单的 IndexOf/Substring 提取：

```
string location = "Theater=2, Name=regal, Area=Area1";

int startPos = location.IndexOf("Name=") + 5;
int endPos = location.IndexOf(",", startPos);

string name = location.Substring(startPos, endPos - startPos); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T05:00:58.007

如果正则表达式是一个选项，您可以使用环视构造来提取精确匹配。我在下面使用的示例在 c# 中应该很好用。这样做的好处是，即使在名称部分之前添加了更多逗号分隔的项目，它也会继续工作。

```
 System.Text.RegularExpressions.Match m =
        System.Text.RegularExpressions.Regex.Match(
            "Theater=2, Name=regal, Area=Area", @"(?<=Name=)[a-zA-Z0-9_ ]+(?=,)");
    Console.WriteLine(m.Value); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T04:54:52.000

另一个 LINQ 风格的答案（没有字典的开销）：

```
var name = (from part in location.Split(',')
            let pair = part.Split('=')
            where pair[0].Trim() == "Name"
            select pair[1].Trim()).FirstOrDefault(); 
```

* * *

重新分组（编辑）：

```
 var records = new[] {
        new {Foo = 123, Location="Theater=2, Name=regal, Area=Area1"},
        new {Foo = 123, Location="Name=cineplex, Area=Area1, Theater=1"},
        new {Foo = 123, Location="Theater=2, Area=Area2, Name=regal"},
    };
    var qry = from record in records
              let name = (from part in record.Location.Split(',')
                          let pair = part.Split('=')
                          where pair[0].Trim() == "Name"
                          select pair[1].Trim()).FirstOrDefault()
              group record by name;
    foreach (var grp in qry)
    {
        Console.WriteLine("{0}: {1}", grp.Key, grp.Count());
    } 
```

# emacs - 如何让 Emacs 填充句子而不是段落？

> ID：539984
> 
> 赞同：31
> 
> 时间：2009-02-12T04:13:08.450
> 
> 标签：emacs, latex, fill

我在 StackOverflow 上[看到](https://stackoverflow.com/questions/539791/tips-for-collaboratively-editing-a-latex-document/539848#539848)了至少两个[建议](https://stackoverflow.com/questions/193298/best-practices-in-latex/196724#196724)，在编辑 LaTeX 文档时在句子之间插入换行符。原因是这种做法有助于源代码控制、学习`diff`和协作编辑。

我基本信服，只是我懒，不想多想。

所以我正在寻找一些emacs咒语来为我处理它。可能是次要模式，可能是一组需要设置的变量。

我想我*不*想要的是

*   文本的软换行（比如使用[长线](http://www.emacswiki.org/emacs/LongLines)和`(set long-lines-auto-wrap 't)`）。这是因为我不想对合作者的编辑提出要求，而且*我*有时会使用其他 unix 工具来检查这些文件。

*我想*我想要的是

*   用于`fill-paragraph`在看起来像是标记句子结尾的换行符之间填充。
*   一个可行的解决方案`auto-fill-mode`将是一个奖励。

那是：

> 聊天聊天。
> 一个带有错误包装的新句子
> ，需要修复。
> 喃喃自语

转换为：

> 聊天聊天。
> 一个带有错误包装的新句子，需要修复。
> 喃喃自语

感谢您的意见和建议。

* * *

编辑：[Jouni K. Seppänen](https://stackoverflow.com/questions/539984/how-do-i-get-emacs-to-fill-sentences-but-not-paragraphs/540760#540760)的建议指出了我`LaTeX-fill-break-at-separators`，这表明 emacs 几乎已经知道如何做到这一点。无论如何，我要去阅读一些代码，并会报告。再次感谢。

* * *

同一问题的更通用版本：[编辑摊牌：在句子末尾保持换行符](https://stackoverflow.com/questions/543379/editor-showdown-maintain-newlines-at-the-ends-of-sentences)。谢谢，[德雷夫斯](https://stackoverflow.com/users/4234/dreeves)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-12T22:29:34.007

这[是我使用](http://procrastiblog.com/2007/11/25/style-guidelines-for-people/)的，主要来自[Luca de Alfaro](http://luca.cse.ucsc.edu/Style_guidelines_for_student_co-authors)：

```
(defun fill-sentence ()
  (interactive)
  (save-excursion
    (or (eq (point) (point-max)) (forward-char))
    (forward-sentence -1)
    (indent-relative t)
    (let ((beg (point))
          (ix (string-match "LaTeX" mode-name)))
      (forward-sentence)
      (if (and ix (equal "LaTeX" (substring mode-name ix)))
          (LaTeX-fill-region-as-paragraph beg (point))
        (fill-region-as-paragraph beg (point)))))) 
```

我把它绑定`M-j`到

```
(global-set-key (kbd "M-j") 'fill-sentence) 
```

`"LaTeX"`对[AUCTeX](http://www.gnu.org/software/auctex/)支持的引用。如果您不使用 AUCTeX，则`let`可以简化为

```
(let (beg (point))
  (forward-sentence)
  (fill-region-as-paragraph beg (point))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-02-22T11:20:29.980

我一直想永远这样做，最近我发现[这篇博](http://pleasefindattached.blogspot.com/2011/12/emacsauctex-sentence-fill-greatly.html)文对我来说效果很好。所以这是我几天来一直在使用的（稍微修改过的版本）。

```
(defun auto-fill-by-sentences ()
  (if (looking-back (sentence-end))
      ;; Break at a sentence
      (progn
        (LaTeX-newline)
        t)
    ;; Fall back to the default
    (do-auto-fill)))
(add-hook 'LaTeX-mode-hook (lambda () (setq auto-fill-function 'auto-fill-by-sentences)))

;; Modified from http://pleasefindattached.blogspot.com/2011/12/emacsauctex-sentence-fill-greatly.html
(defadvice LaTeX-fill-region-as-paragraph (around LaTeX-sentence-filling)
  "Start each sentence on a new line."
  (let ((from (ad-get-arg 0))
        (to-marker (set-marker (make-marker) (ad-get-arg 1)))
        tmp-end)
    (while (< from (marker-position to-marker))
      (forward-sentence)
      ;; might have gone beyond to-marker---use whichever is smaller:
      (ad-set-arg 1 (setq tmp-end (min (point) (marker-position to-marker))))
      ad-do-it
      (ad-set-arg 0 (setq from (point)))
      (unless (or (looking-back "^\\s *")
                  (looking-at "\\s *$"))
        (LaTeX-newline)))
    (set-marker to-marker nil)))
(ad-activate 'LaTeX-fill-region-as-paragraph) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T10:35:20.560

如果你在每个句子的末尾放置一个注释标记，Emacs 就知道不要在注释中移动下一行：

```
chat chat chat.%
A new sentence
with goofed up wrapping that needs to be fixed.%
Mumble mumble% 
```

然后 Mq 分别填充每个句子，至少在 AUCTeX 11.85 中。（如果您在 Emacs 中对此进行测试，似乎存在一个错误，如果这是缓冲区中的第一段并且您键入 Mq，您会收到一条错误消息。只需在文本前添加一个换行符即可解决它。）

如果您不想输入注释字符，您可以使用 LaTeX-fill-paragraph 并对其进行修改，以便行尾的句尾标点符号与注释类似。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-29T10:20:36.030

```
(defun wrap-at-sentences ()
  "Fills the current paragraph, but starts each sentence on a new line."
  (interactive)
  (save-excursion
    ;; Select the entire paragraph.
    (mark-paragraph)
    ;; Move to the start of the paragraph.
    (goto-char (region-beginning))
    ;; Record the location of the end of the paragraph.
    (setq end-of-paragraph (region-end))
    ;; Wrap lines with 'hard' newlines (i.e., real line breaks).
    (let ((use-hard-newlines 't))
      ;; Loop over each sentence in the paragraph.
      (while (< (point) end-of-paragraph)
        ;; Determine the region spanned by the sentence.
        (setq start-of-sentence (point))
        (forward-sentence)
        ;; Wrap the sentence with hard newlines.
        (fill-region start-of-sentence (point))
        ;; Delete the whitespace following the period, if any.
        (while (char-equal (char-syntax (preceding-char)) ?\s)
          (delete-char -1))
        ;; Insert a newline before the next sentence.
        (insert "\n")))))

(global-set-key (kbd "M-q") 'wrap-at-sentences) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T14:28:24.447

May not work in all circumstances, but:

```
(defun my-fill-sentence ()
  "Fill sentence separated by punctuation or blank lines."
  (interactive)
  (let (start end)
    (save-excursion
      (re-search-backward "\\(^\\s-*$\\|[.?!]\\)" nil t)
      (skip-syntax-forward "^w")
      (setq start (point-at-bol)))
    (save-excursion
      (re-search-forward "\\(^\\s-*$\\|[.?!]\\)" nil t)
      (setq end (point-at-eol)))
    (save-restriction
      (narrow-to-region start end)
      (fill-paragraph nil)))) 
```

To make it work with `auto-fill-mode`, add `(setq normal-auto-fill-function 'my-fill-sentence)` to your LaTeX mode hook (I think).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-05T10:10:52.640

I wrote the following which loops over a region and inserts newlines. Instead of using `forward-sentence` which didn't work for me, I use `re-search-forward "[.?!][]\"')}]*\\( \\)"`, which finds all sentences followed only by two spaces (the regexp is a modified `sentence-end`). The newline is made using `newline-and-indent`.

```
(defun fill-sentences-in-paragraph ()
  "Put a newline at the end of each sentence in paragraph."
  (interactive)
  (save-excursion
    (mark-paragraph)
    (call-interactively 'fill-sentences-in-region)))

(defun fill-sentences-in-region (start end)
  "Put a newline at the end of each sentence in region."
  (interactive "*r")
  (call-interactively 'unfill-region)
  (save-excursion
    (goto-char start)
    (while (re-search-forward "[.?!][]\"')}]*\\(  \\)" end t)
      (newline-and-indent)))) 
```

To be able to fix improperly formatted text such as the example "chat chat chat...", `fill-sentences-in-region` first calls [`unfill-region`](http://www.emacswiki.org/emacs/UnfillRegion) which gets rid of sentence-breaking whitespace:

```
 (defun unfill-region (beg end)
      "Unfill the region, joining text paragraphs into a
       single logical line.  This is useful, e.g., for use
       with 'visual-line-mode'."
      (interactive "*r")
      (let ((fill-column (point-max)))
        (fill-region beg end))) 
```

I use `visual-line-mode` and replace my default paragraph fill `M-q` to `fill-sentences-in-paragraph` with `(global-set-key "\M-q" 'fill-sentences-in-paragraph)`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T15:43:30.787

如果其他答案*过于*自动，这是一种半自动的方法。如果您要手动重新格式化，这基本上是您会反复执行的操作，但经过浓缩，您可以反复敲击单个键。

```
;; - go to the end of the line,
;; - do ^d to suck the previous line onto this one, 
;; - make sure there's only one space between the now-concatenated
;;   lines, and then 
;; - jump to the end and hit space so that (with auto-fill-mode)
;;   the line nicely rewraps itself:
;;   (turn on auto-fill-mode with M-x auto-fill-mode)
(defalias 'fill-sentence
  (read-kbd-macro "C-e C-d SPC M-x just- one- space RET C-e SPC <backspace>"))

(define-key global-map [f4] 'fill-sentence)  ; or whatever key you like 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T10:37:18.340

我假设你知道 elisp。

您可以采取以下几种方法：

*   钩入`auto-fill-mode`. 那里有很多硬编码的条件，所以它可能不适合你。你可能会玩，`auto-fill-function`看看你是否有你需要的钩子。

*   使一个字符（可能`.`）“电动”，这样当你按下它时，它会插入自己，然后调用一个函数来确定如何填充你所在的行。

*   设置一个`after-change-hook`来调用一个确定如何填充句子的函数。每次更改缓冲区后都会调用此函数，因此请有效地执行此操作。（这个机制被 使用`font-lock`，所以不要太担心它。听起来很慢，但实际上不是——人们打字很慢。）

一旦你在正确的位置上钩了，你只需要实现填充逻辑。`sentence-at-point`(from )的来源`thingatpt`可能具有指导意义。

无论如何，我从未听说过有人这样做……但这绝对是可能的。像 Emacs 中的大多数东西一样，它只是一个简单的编程问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-23T21:42:11.827

我非常喜欢 Chris Conway 的宏，但它仅在您手动换行每个句子后才有效。我是一个懒惰的人，所以我希望 emacs 为我做这件事。今天早上我终于坐下来研究了这个问题。我现在的解决方案是破解内置宏`fill-region-as-paragraph`。

应用以下 hack 后，一个新选项`newline-after-sentence`将设置为 true。标准`M-q`( `fill-paragraph`) 将自动填充并在句子*之间创建换行符。*请注意，仅使用 GNU Emacs 23.3.1 进行测试——使用它需要您自担风险。

完整的宏很长，所以我不会在这里发布。这个想法是添加以下循环`fill-region-as-paragraph`

```
...

;; Insert a line break after each sentence
(while (< (point) to)
  (forward-sentence)
  (if (< (point) to) (fill-newline)))

;; This is the actual filling loop.
(goto-char from)
(let (sentbeg sentend)
  (while (< (point) to)
    (setq sentbeg (point))
    (end-of-line)
    (setq sentend (point))
    (fill-one-line sentbeg sentend justify) ;; original filling loop
    (forward-line)))))

... 
```

[您可以在我的 git 存储库](http://fermi.mycloudnas.com/cgit.cgi/fill/tree/hack.el)中找到完整的宏。一些细节也写在[我的博客](http://fermi.mycloudnas.com/2011/05/fill-hack/)里。如果您不想阅读我蹩脚的英语，您可以简单地使用

```
$ curl http://fermi.mycloudnas.com/cgit.cgi/fill/plain/hack.el >> ~/.emacs 
```

将hack附加到您的`~/.emacs`并尝试一下。欢迎评论和错误报告。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-05T18:08:08.000

另一种方法是保留您的 .tex 文件，并使用类似 latexdiff 的工具（在[此](https://tex.stackexchange.com/questions/65453/track-changes-in-latex)StackExchange帖子中描述）而不是 Unix diff。这会生成一个带有 Word 样式的跟踪更改标记的 .tex 文件，并正确处理空格，因此您不必担心句子的结尾。

# java - 对于大型 Java 数据网格技术，您会推荐什么：Terracotta、GigaSpaces、Coherence 等？

> ID：539985
> 
> 赞同：13
> 
> 时间：2009-02-12T04:13:16.123
> 
> 标签：java, memcached, terracotta, gigaspaces, datagrid

我一直在阅读 Java 平台的所谓“数据网格”解决方案，包括 Terracotta、GigaSpaces 和 Coherence。我想知道是否有人有使用这些工具的实际经验并可以分享他们的经验。我也很想知道人们使用过什么规模的部署：我们是在谈论 2-4 个节点集群，还是您使用过比这更大的东西？

我被 Terracotta 吸引是因为它对 Hibernate 和 Spring 的“直接”支持，我们大量使用了这两者。我也喜欢它如何根据配置装饰字节码并且不需要您针对“网格 API”进行编程的想法。我不知道使用显式 API 方法的工具有什么优势，但如果它们确实存在，我很想听听它们。:)

我还花时间阅读有关 memcached 的信息，但我更感兴趣的是听取有关这三个特定解决方案的反馈。如果有人同时使用这两种方法，我很想知道它们如何与 memcached 进行对比。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T12:54:33.523

您可能还想查看[Hazelcast](http://www.hazelcast.com)。Hazelcast 是队列、主题、映射、集合、列表、锁定和执行器服务的开源事务性、分布式/分区实现。使用起来超级容易；只需将 hazelcast.jar 添加到您的类路径中并开始编码。几乎不需要任何配置。

[Hazelcast](http://www.hazelcast.com)是在 Apache 许可下发布的，并且还提供企业级支持。代码托管在[Google Code](http://code.google.com/p/hazelcast/)上。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-12T06:35:32.240

我们有 50 台服务器运行 Web 服务应用程序，所有这些服务器都使用 bigIP 进行负载平衡。要求是缓存每个用户状态，以便后续状态不会再次执行相同的处理并从先前状态获取数据。这样，webservice 的客户端就不需要维护状态。

我们使用 Terracotta 来缓存状态并且从未遇到任何性能问题。在高峰时间，请求应用程序的数量是每秒 100 个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T08:14:51.223

您选择的库实际上取决于您的应用程序以及您想要实现的目标。

我曾在一家使用 Coherence 为其 Web 应用程序提供可扩展性（和某种冗余）的商店工作。我们发现您必须拥有大约 4-5 个节点才能开始从 Coherence 获得任何好处（2 或 3 个节点可能会降低性能）。我相信 Oracle 的文档说您需要很多（30 多个）节点才能真正从 Coherence 中受益。如果您确实使用 Coherence，请确保正确设置硬件 - 它对延迟非常敏感。

我个人会远离“插入”的东西。它们可能会给你一些开始，但你最终会遇到同步或性能问题，并且无论如何都必须开始编写特定于网格层的代码。基本上，您比库更了解您的应用程序，并且能够确定哪些项目需要缓存，它们需要多长时间，您的应用程序将如何使用等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T04:50:16.800

我对这些技术没有足够的经验，但我认为[Apache Hadoop](http://hadoop.apache.org/)被证明是可扩展且可靠的。雅虎在[10,000 个核心 Linux 集群](http://developer.yahoo.net/blogs/hadoop/2008/02/yahoo-worlds-largest-production-hadoop.html)上运行它。

它基于 Google [MapReduce](http://en.wikipedia.org/wiki/MapReduce)算法。

[这篇](http://www.theserverside.com/tt/knowledgecenter-tc/knowledgecenter-tc.tss?l=MapReduce)文章描述了 MapReduce 以及为什么你应该关心它。********